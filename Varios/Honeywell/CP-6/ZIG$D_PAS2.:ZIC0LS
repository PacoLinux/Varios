
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:1    
        1        1        /*M*     ZIG$D_PAS2    DDL TRANSLATE PASS 2 I-D-S/II  DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$D_PAS2
        9        9        PURPOSE: This subroutins is called by ZIG$D_EXEC to handle all that
       10       10                 couldn't be done in pass 1 (ZIG$D_PSET).
       11       11                 1) Unsatisfied forward references to sets
       12       12                 2) Make sure LOC MODE VIA set records are members of the set
       13       13                 3) Set selection
       14       14                 4) WITHIN ANY AREA [EXCEPT areaname1,...] in record entry
       15       15                 5) LOC MODE DIRECT
       16       16                 6) Make sure that records in TEMPORARY AREAS aren't in
       17       17                    sets that contain records not in TEMPORARY AREAS.
       18       18        */
       19       19        ZIG$D_PAS2: PROC ALTRET;
       20       20
       21       21        %EQU DS5 = 4; /* data segment of dynamic memory */
       22       22    1   DCL I UBIN WORD;
       23       23    1   DCL ANY_LNO UBIN WORD;
       24       24    1   DCL CT1 UBIN (36);
       25       25    1   DCL CT2 UBIN (36);
       26       26    1   DCL CT3 UBIN (36);
       27       27        /*******************
       28       28        * Temporary holder *
       29       29        * for a dbk        *
       30       30        *******************/
       31       31    1   DCL HOLD_DBK UBIN WORD;
       32       32        /*********************
       33       33        * saved DBKEYS       *
       34       34        *********************/
       35       35    1   DCL DBK UBIN WORD;
       36       36    1   DCL DBK_SM_CALC UBIN WORD;
       37       37    1   DCL DBK_SCANSS UBIN WORD;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:2    
       38       38    1   DCL DBK_CALCSS UBIN WORD;
       39       39    1   DCL FIRST_DBK_RFR_CALC UBIN WORD;
       40       40    1   DCL DBK_RFR_CALC UBIN WORD;
       41       41    1   DCL DBK_CALC_CF UBIN WORD;
       42       42    1   DCL DBK_LAST_SM UBIN WORD;
       43       43    1   DCL DBK_SFR UBIN WORD;
       44       44    1   DCL DBK_RFR UBIN WORD;
       45       45    1   DCL DBK_SN UBIN WORD;
       46       46    1   DCL THIS_SC UBIN WORD;
       47       47    1   DCL THIS_SM UBIN WORD;
       48       48    1   DCL THIS_SM_RC UBIN WORD;
       49       49    1   DCL THIS_SN UBIN WORD;
       50       50    1   DCL THIS_SN_SC UBIN WORD;
       51       51    1   DCL THIS_SN_SO UBIN WORD;
       52       52    1   DCL THIS_SN_SO_RC UBIN WORD;
       53       53    1   DCL THIS_RC UBIN WORD;
       54       54    1   DCL THIS_RC_SN UBIN WORD;
       55       55        /****************************
       56       56        * needed for LOC DIRECT     *
       57       57        ****************************/
       58       58    1   DCL FR_NAME CHAR(30);
       59       59    1   DCL QRC_DBK UBIN WORD;
       60       60    1   DCL QRC_NAME CHAR(30);
       61       61        /**************************
       62       62        * needed for THEN THRU    *
       63       63        **************************/
       64       64    1   DCL PREV_THRU_SN UBIN WORD;
       65       65    1   DCL PREV_THRU_SN_SC UBIN WORD;
       66       66    1   DCL DBK_WHER_FR UBIN WORD;
       67       67    1   DCL FIRST_WHERE BIT(1);
       68       68    1   DCL NUM_CTRL_FLDS UBIN WORD;
       69       69        /**************************
       70       70        * for comparing calckeys  *
       71       71        **************************/
       72       72    1   DCL 1 FR ALIGNED,
       73       73    1         2 FTYPE SBIN (36) ALIGNED,
       74       74    1         2 PREC SBIN (36) ALIGNED,
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:3    
       75       75    1         2 SCALE SBIN (36) ALIGNED,
       76       76    1         2 F_SIGN SBIN (36) ALIGNED;
       77       77    1   DCL NUM_EQ_CALCKEYS UBIN WORD;
       78       78    1   DCL FOUND_IT BIT(1);
       79       79        /********************
       80       80        * For adjusting the *
       81       81        * RC-FR sets        *
       82       82        ********************/
       83       83    1   DCL DONE BIT(1);
       84       84    1   DCL FIRST_FR BIT(1);
       85       85    1   DCL FOUND_DIRECT BIT(1);
       86       86    1   DCL FOUND_SYN BIT(1);
       87       87    1   DCL MOVE_MEM UBIN WORD;
       88       88    1   DCL NEXT_MEM UBIN WORD;
       89       89    1   DCL OWNER_RC UBIN WORD;
       90       90    1   DCL PREV_MEM UBIN WORD;
       91       91        /******************************
       92       92        * for temp area rec checking  *
       93       93        ******************************/
       94       94    1   DCL THIS_AC UBIN WORD;
       95       95    1   DCL THIS_RA UBIN WORD;
       96       96    1   DCL THIS_SOSM UBIN WORD;
       97       97    1   DCL THIS_SOSM_NAME CHAR(30);
       98       98        %EQU WARN_SEV = 1;
       99       99        %EQU ERR_SEV = 2;
      100      100    1   DCL FLAG_ERR BIT(1);
      101      101    1   DCL FIRST_TIME BIT(1);
      102      102    1   DCL ZIG$D_DIAG ENTRY(3);
      103      103    1   DCL ADD_SN ENTRY(8);
      104      104    1   DCL MOVE_TO_FIRST_POS ENTRY(4);
      105      105    1   DCL ZIG$FREE ENTRY(2) ALTRET;
      106      106        %INCLUDE ZIG_DIR_STRUCS;
      107      236        %INCLUDE ZIG_DDL_INCL;
      108      498         %DDL_XLATE;
      109      593        %INCLUDE ZIG_GENERAL;
      110      701        %INCLUDE ZIG_TYPE_SUBS;
      111      716        %INCLUDE ZI_SUB4_CAN;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:4    
      112     1373         %UWA;
      113     1708        %INCLUDE ZIG_DBA_INT;
      114     1756        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:5    
      115     1757        /*
      116     1758
      117     1759
      118     1760        */
      119     1761
      120     1762    1       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);
      121     1763    1       CALL FINDPS_6('OA-SC   ');
      122     1764    1       CALL FINDPS_6('OA-SC   ');
      123     1765    1       MOVE_MEM = UWA.DIRECT_REF;
      124     1766    1       PREV_MEM = 0;
      125     1767    2       DO WHILE UWA.DB_STATUS ~= '0502100' AND MOVE_MEM ~= PREV_MEM;
      126     1768    2           MOVE_MEM = UWA.DIRECT_REF;
      127     1769    2           CALL FINDPS_6('OA-SC   ');
      128     1770    2           PREV_MEM = UWA.DIRECT_REF;
      129     1771    2           CALL FINDD_6('SC      ',MOVE_MEM);
      130     1772    2           CALL MODIFYMEM_6('SC      ');
      131     1773    2           CALL FINDD_6('SC      ',PREV_MEM);
      132     1774    2           END;
      133     1775
      134     1776    1       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);
      135     1777    1       CALL FINDPS_6('OA-RC   ');
      136     1778    1       CALL FINDPS_6('OA-RC   ');
      137     1779    1       MOVE_MEM = UWA.DIRECT_REF;
      138     1780    1       PREV_MEM = 0;
      139     1781    2       DO WHILE UWA.DB_STATUS ~= '0502100' AND MOVE_MEM ~= PREV_MEM;
      140     1782    2           MOVE_MEM = UWA.DIRECT_REF;
      141     1783    2           CALL FINDPS_6('OA-RC   ');
      142     1784    2           PREV_MEM = UWA.DIRECT_REF;
      143     1785    2           CALL FINDD_6('RC      ',MOVE_MEM);
      144     1786    2           CALL MODIFYMEM_6('RC      ');
      145     1787    2           CALL FINDD_6('RC      ',PREV_MEM);
      146     1788    2           END;
      147     1789
      148     1790        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:6    
      149     1791        /***********************************************************
      150     1792          Now look through all the SNs for any unsatisfied forward
      151     1793          references to sets.
      152     1794        ***********************************************************/
      153     1795    2       DO I = 0 TO NUMB_SET_SN-1;
      154     1796    2           IF SET$->TABLES.DEFINED(I) = '0'B AND
      155     1797    3              SUBSTR(SET$->TABLES.NAME(I),0,1) ~= '*' THEN DO;
      156     1798    3               DBK = SET$->TABLES.DBK(I);
      157     1799    3               CALL FETCHD_6('SN      ',DBK);
      158     1800    3               CALL INDEX(CT1,' ',SET$->TABLES.NAME(I));
      159     1801    3               CALL SET_FIELDS(1,CT1,SET$->TABLES.NAME(I));
      160     1802    3               LNO = UWA.SN.LNO - 1;
      161     1803    3               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4217);
      162     1804        /*E*  ERROR:  ZIG-4217-C
      163     1805            MESSAGE:  The set name "%U1" is not in the schema dictionary.
      164     1806        */
      165     1807    3               CALL FETCHNS_6('SN-NRWU '); /* NR */
      166     1808    4               DO WHILE (UWA.DB_STATUS ~= '0502100'); /* go thru entire SN-NRWU */
      167     1809    5                   IF UWA.NR.RELTYPE = RELTYPE.LOC THEN DO; /* was used in VIA SET */
      168     1810    5                       CALL ZIG$D_DIAG(LNO,%ERR_SEV,4805);
      169     1811        /*E* ERROR:  ZIG-4805-C
      170     1812           MESSAGE:  The LOCATION MODE clause is invalid because the set
      171     1813                     "%U1" has not been declared.
      172     1814        */
      173     1815    5                       END;
      174     1816    4                   CALL FETCHNS_6('SN-NRWU '); /* NR */
      175     1817    4                   END;
      176     1818    3               END;
      177     1819    2           END;
      178     1820        /**************************************************************
      179     1821         Check to make sure that all record with LOC MODE VIA setname
      180     1822         are indeed members in the name set.
      181     1823        **************************************************************/
      182     1824    2       DO I = 0 TO NUMB_RECORD_SN - 1;
      183     1825         /* if this record is LOC MODE VIA setname but was never declared
      184     1826            as a member of the set... */
      185     1827    3           IF RECORD$->TABLES.DBK_RC(I) ~= 0 THEN DO;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:7    
      186     1828    3               DBK = RECORD$->TABLES.DBK(I);
      187     1829    3               CALL FETCHD_6('SN      ',DBK); /* SN */
      188     1830    3               CALL INDEX(CT1,' ',RECORD$->TABLES.NAME(I));
      189     1831    3               CALL SET_FIELDS(1,CT1,RECORD$->TABLES.NAME(I));
      190     1832    3               LNO = UWA.SN.LNO;
      191     1833    3               DBK = RECORD$->TABLES.DBK_RC(I);
      192     1834    3               CALL FETCHD_6('SN      ',DBK); /* SN */
      193     1835    3               CALL INDEX(CT2,' ',UWA.SN.SENAME);
      194     1836    3               CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);
      195     1837    3               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4962);
      196     1838        /*E* ERROR:  ZIG-4962-C
      197     1839           MESSAGE:  The LOCATION MODE clause is invalid because the "%U1" record
      198     1840                     is not a member of the "%U2" set.
      199     1841        */
      200     1842    3               END;
      201     1843    2           END;
      202     1844        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:8    
      203     1845        /*****************************************************************/
      204     1846        /* Do SET SELECTION and WITHIN ANY AREA [EXCEPT...] clauses.
      205     1847           The following characters signify different types of statements:
      206     1848           10- beginning of SET SELECTION phrase
      207     1849           1 - owner identified by application
      208     1850           2 - owner identified by calckey equal to ...
      209     1851           3 - owner identified by calckey
      210     1852           4 - owner identified by dbkey equal to
      211     1853           5 - owner identified by dbkey
      212     1854           6 - owner identified by member ...
      213     1855           20- beginning of THEN THRU clause
      214     1856           30- beginning of OWNER IDENTIFIED BY in THEN THRU
      215     1857           40- beginning of EQUAL TO phrase
      216     1858           45- end of this MEMBER entry
      217     1859           50- beginning of WITHIN ANY AREA [EXCEPT...] clause
      218     1860           60- EXCEPT areanames
      219     1861           70- LOC MODE DIRECT
      220     1862           75- qualified LOC MODE DIRECT
      221     1863          100- end of all set selection clauses and within clauses
      222     1864        */
      223     1865        /*****************************************************************/
      224     1866    1       DYNMEM$ = PINCRW(DYNMEM_START$,1);
      225     1867    2       DO WHILE (DYNMEM$->WRD1 ~= %ALL_DONE);
      226     1868    3           DO CASE(DYNMEM$->WRD1);
      227     1869    3           CASE(%SET_SEL); /* beginning of set selection clause */
      228     1870    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      229     1871    3               THIS_SC = DYNMEM$->WRD1; /* SC of SET NAME IS setname */
      230     1872    3               CALL FINDD_6('SC      ',THIS_SC); /* SC */
      231     1873    3               CALL FINDOS_6('SN-SE   ');
      232     1874    3               LAST_DEF_SET_DBK = UWA.DIRECT_REF;
      233     1875    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      234     1876    3               THIS_SM = DYNMEM$->WRD1; /* SM of MEMBER IS recordname */
      235     1877    3               CALL FINDD_6('SM      ',THIS_SM); /* SM */
      236     1878    3               CALL FETCHNS_6('SM-SS   '); /* SS */
      237     1879    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      238     1880    3               THIS_SN = DYNMEM$->WRD1; /* SN of SET SELECTION THRU setname */
      239     1881    3               DYNMEM$ = PINCRW(DYNMEM$,1);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:9    
      240     1882    3               LNO = DYNMEM$->WRD1;
      241     1883    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      242     1884    3               CALL FINDD_6('SN      ',THIS_SN); /* SN */
      243     1885    3               CALL FINDNS_6('SN-SE   '); /* SC */
      244     1886    3               THIS_SN_SC = UWA.DIRECT_REF;
      245     1887    3               CALL FINDNS_6('SC-SOSM '); /* SO */
      246     1888    3               THIS_SN_SO = UWA.DIRECT_REF; /* SO of SET SELECTION THRU setname */
      247     1889    3               CALL FETCHOS_6('RC-SOSM '); /* RC */
      248     1890    3               THIS_SN_SO_RC = UWA.DIRECT_REF;
      249     1891        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:10   
      250     1892        /*****************************************************************/
      251     1893    3           CASE(%APPLIC); /* APPLICATION */
      252     1894         /* Don't need to do anything.  The SS already connected to
      253     1895            THIS_SM in pass1 is sufficient.
      254     1896         */
      255     1897    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      256     1898        /*****************************************************************/
      257     1899    3           CASE(%CALC_EQ); /* CALCKEY EQUAL TO dbid/dbparam */
      258     1900         /* - make sure THIS_SN's set owner RC is location mode calc
      259     1901            - find the SM inthe *calc set of THIS_SN's set owner
      260     1902            - modify the existing SS off THIS_SM and create another SS
      261     1903            - for each fieldname given in the CALC_KEY EQUAL TO clause:
      262     1904            -make sure number fields given still not more than number
      263     1905            occuring in LOCATION MODE CALC USING clause of THIS_SN's
      264     1906            set owner record
      265     1907            -add SN(if necessary) and NR
      266     1908            -make one of the SSs current
      267     1909            -go fetch RFR of next calckey named in LOC  MODE CALC clause
      268     1910            and save type defintions
      269     1911            -if name mentioned in EQUAL TO clause is new dbparam then
      270     1912            build a RFR for it
      271     1913            -if name mentioned was a dbid or already existing dbparam then
      272     1914            compare type definitions
      273     1915            -build a SFR and point it to the RFR
      274     1916            - build a SCF and connect it to one of the SSs
      275     1917            -build another SCF and connect it to the other SS
      276     1918            -make sure number of keys given in EQUAL TO clause matches number
      277     1919            given in LOC MODE clause
      278     1920         */
      279     1921    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      280     1922    3               LNO = DYNMEM$->WRD1;
      281     1923    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      282     1924    3               FR_NAME = DYNMEM$->CHAR30;
      283     1925    3               DYNMEM$ = PINCRW(DYNMEM$,8);
      284     1926    3               CALL FETCHNS_6('SN-SE   ');
      285     1927    3               CALL INDEX(CT1,' ',UWA.SN.SENAME);
      286     1928    3               CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:11   
      287     1929    3               FIRST_TIME = '1'B;
      288     1930    3               IF UWA.RC.PSMODE ~= 1 THEN /* CALC */
      289     1931    4               DO;
      290     1932    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);
      291     1933    4                   CALL FETCHOS_6('SN-SE   ');
      292     1934    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);
      293     1935    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
      294     1936    4                   CALL FETCHD_6('SN      ',THIS_SN);
      295     1937    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);
      296     1938    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);
      297     1939    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4834);
      298     1940        /*E* ERROR:  ZIG-4834-C
      299     1941           MESSAGE:  The SET SELECTION clause is invalid because the owner
      300     1942                     record "%U1" of set "%U2" does not have CALC location mode.
      301     1943        */
      302     1944    5                   DO WHILE (DYNMEM$->WRD1 = %CALC_EQ) OR FIRST_TIME;
      303     1945    5                       IF NOT FIRST_TIME THEN
      304     1946    6                       DO;
      305     1947    6                           DYNMEM$ = PINCRW(DYNMEM$,1);
      306     1948    6                           DYNMEM$ = PINCRW(DYNMEM$,1);
      307     1949    6                           DYNMEM$ = PINCRW(DYNMEM$,8);
      308     1950    6                           END;
      309     1951    5                       ELSE
      310     1952    5                           FIRST_TIME = '0'B;
      311     1953    5                       IF DYNMEM$->WRD1 = %QUAL THEN
      312     1954    6                       DO;
      313     1955    6                           DYNMEM$ = PINCRW(DYNMEM$,1);
      314     1956    6                           DYNMEM$ = PINCRW(DYNMEM$,8);
      315     1957    6                           END;
      316     1958    5                       END; /* WHILE */
      317     1959    4                   END; /* IF NOT CALC */
      318     1960    4               ELSE DO;
      319     1961    5                   IF UWA.RC.CALCDUP = 0 THEN DO; /* 0= dups allowed */
      320     1962    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4835);
      321     1963        /*E* ERROR:  ZIG-4835-C
      322     1964           MESSAGE:  The SET SELECTION clause is invalid because the record
      323     1965                     "%U1" may have duplicate calc key values.
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:12   
      324     1966        */
      325     1967    5                       END;
      326     1968    4                   CALL FETCHNS_6('RC-FR   '); /* FR */
      327     1969    5                   DO WHILE (UWA.FR.DERIVED = 0); /* want 1st calc key */
      328     1970    5                       CALL FETCHNS_6('RC-FR   ');
      329     1971    5                       END;
      330     1972    4                   FIRST_DBK_RFR_CALC = UWA.DIRECT_REF;
      331     1973    4                   CALL FINDD_6('RC      ',THIS_SN_SO_RC); /* RC */
      332     1974    4                   CALL FINDPS_6('RC-SOSM '); /* SM in *calc set */
      333     1975    4                   DBK_SM_CALC = UWA.DIRECT_REF;
      334     1976    4                   CALL FCURR_R_6('S-S     '); /* current SS */
      335     1977    4                   DBK_CALCSS = UWA.DIRECT_REF;
      336     1978    4                   UWA.S_S.SOSM_SSH = DBK_SO_CALC;
      337     1979    4                   UWA.S_S.SC_SSH = THIS_SN_SC;
      338     1980    4                   UWA.S_S.STYP = 0; /* calc */
      339     1981    4                   CALL MODIFY_6('S-S     '); /* calcSS */
      340     1982    4                   UWA.S_S.STYP = 4; /* scan */
      341     1983    4                   UWA.S_S.SOSM_SSH = DBK_SM_CALC;
      342     1984    4                   CALL STRE_6('S-S     ');
      343     1985    4                   UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;
      344     1986    4                   DBK_SCANSS = UWA.DIRECT_REF;
      345     1987    4                   FIRST_TIME = '1'B;
      346     1988    4                   NUM_EQ_CALCKEYS = 0;
      347     1989    5                   DO WHILE (DYNMEM$->WRD1 = %CALC_EQ) OR FIRST_TIME;
      348     1990    5                       FLAG_ERR = '0'B;
      349     1991    5                       NUM_EQ_CALCKEYS = NUM_EQ_CALCKEYS + 1;
      350     1992    6                       IF NUM_EQ_CALCKEYS > UWA.RC.SLACK THEN DO;
      351     1993    6                           FLAG_ERR = '1'B;
      352     1994    6                           CALL FETCHD_6('RC      ',THIS_SN_SO_RC);
      353     1995    6                           CALL FETCHOS_6('SN-SE   ');
      354     1996    6                           CALL INDEX(CT1,' ',UWA.SN.SENAME);
      355     1997    6                           CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
      356     1998    6                           CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4906);
      357     1999        /*E* ERROR:  ZIG-4906-C
      358     2000           MESSAGE:  The SET SELECTION clause is invalid because the EQUAL
      359     2001                     TO phrase specifies more fields than does the LOCATION
      360     2002                     clause for record "%U1".
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:13   
      361     2003        */
      362     2004    6                           END;
      363     2005    5                       IF NOT FIRST_TIME THEN
      364     2006    6                       DO;
      365     2007    6                           DYNMEM$ = PINCRW(DYNMEM$,1);
      366     2008    6                           LNO = DYNMEM$->WRD1;
      367     2009    6                           DYNMEM$ = PINCRW(DYNMEM$,1);
      368     2010    6                           FR_NAME = DYNMEM$->CHAR30;
      369     2011    6                           DYNMEM$ = PINCRW(DYNMEM$,8);
      370     2012    6                           END;
      371     2013    5                       ELSE
      372     2014    5                           FIRST_TIME = '0'B;
      373     2015    5                       IF DYNMEM$->WRD1 = %QUAL THEN
      374     2016    6                       DO;
      375     2017    6                           DYNMEM$ = PINCRW(DYNMEM$,1);
      376     2018    6                           QRC_NAME = DYNMEM$->CHAR30;
      377     2019    6                           DYNMEM$ = PINCRW(DYNMEM$,8);
      378     2020    6                           CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR
              2020                                    ,0
      379     2021    6                              ,0);
      380     2022    6                           IF FOUND ~= %FOUNDDEF THEN
      381     2023    7                           DO;
      382     2024    7                               FLAG_ERR = '1'B;
      383     2025    7                               CALL INDEX(CT1,' ',FR_NAME);
      384     2026    7                               CALL SET_FIELDS(1,CT1,FR_NAME);
      385     2027    7                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4809);
              2027                                        /*qualifying RC not DEFed */
      386     2028    7                               END;
      387     2029    6                           CALL FINDNS_6('SN-SE   '); /* RC */
      388     2030    6                           QRC_DBK = UWA.DIRECT_REF;
      389     2031    6                           END;
      390     2032    5                       ELSE
      391     2033    5                           QRC_DBK = 0; /* not qualified */
      392     2034    6                       IF NOT FLAG_ERR THEN DO;
      393     2035    6                           CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.SS,
      394     2036    6                              EXPLCT,QRC_DBK);
      395     2037    6                           IF FOUND = %FOUNDDUP THEN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:14   
      396     2038    7                           DO;
      397     2039    7                               CALL INDEX(CT1,' ',FR_NAME);
      398     2040    7                               CALL SET_FIELDS(1,CT1,FR_NAME);
      399     2041    7                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4801);
              2041                                        /* needs qualifier */
      400     2042        /*E*  ERROR:  ZIG-4801-C
      401     2043            MESSAGE:  The reference to the field "%U1" is ambiguous and
      402     2044                      requires a record name qualifier.
      403     2045        */
      404     2046    7                               END;
      405     2047    7                           ELSE DO;
      406     2048         /* if qualified but not found, then error */
      407     2049    7                               IF QRC_DBK ~= 0 AND FOUND = %NOTFOUND THEN
      408     2050    8                               DO;
      409     2051    8                                   CALL INDEX(CT1,' ',FR_NAME);
      410     2052    8                                   CALL SET_FIELDS(1,CT1,FR_NAME);
      411     2053    8                                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4838);
      412     2054        /*E*  ERROR:  ZIG-4838-C
      413     2055            MESSAGE:  The field "%U1" is not a field of the record specified
      414     2056                      as the qualifier.
      415     2057        */
      416     2058    8                                   END;
      417     2059    8                               ELSE DO;
      418     2060    8                                   DBK_SN = UWA.DIRECT_REF;
      419     2061         /* GO THROUGH RC-FR OF DBK_RC_SO AND FETCH RFR OF NEXT CALCKEY */
      420     2062    8                                   CALL FETCHD_6('FR      ',FIRST_DBK_RFR_CALC);
      421     2063    9                                   DO WHILE (UWA.FR.DERIVED ~= NUM_EQ_CALCKEYS);
      422     2064    9                                       CALL FETCHNS_6('RC-FR   ');
      423     2065    9                                       END;
      424     2066    8                                   DBK_RFR_CALC = UWA.DIRECT_REF;
      425     2067    8                                   FR.FTYPE = UWA.FR.FTYPE;
      426     2068    8                                   FR.PREC = UWA.FR.PREC;
      427     2069    8                                   FR.SCALE = UWA.FR.SCALE;
      428     2070    8                                   FR.F_SIGN = UWA.FR.F_SIGN;
      429     2071    9                                   IF FOUND = %NOTFOUND THEN DO; /* dbparam */
      430     2072         /* connect a RFR for this guy to RC of *DBPARAM */
      431     2073    9                                       CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:15   
      432     2074    9                                       UWA.FR.F_USE = 1;
      433     2075    9                                       UWA.FR.LEVEL = 0;
      434     2076    9                                       CALL FINDD_6('SN      ',DBK_SN); /* SN */
      435     2077    9                                       CALL STRE_6('FR      '); /* RFR */
      436     2078    9                                       UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
      437     2079    9                                       DBK_RFR = UWA.DIRECT_REF;
      438     2080    9                                       CALL CONNECT_6('SN-SE   ');
      439     2081    9                                       END;
      440     2082    9                                   ELSE DO; /* dbid or dbparam already mentioned */
      441     2083    9                                       CALL FINDD_6('SN      ',DBK_SN);
      442     2084    9                                       CALL FETCHNS_6('SN-SE   '); /* RFR */
      443     2085    9                                       DBK_RFR = UWA.DIRECT_REF;
      444     2086    9                                       UWA.FR.REF = 1;
      445     2087    9                                       CALL MODIFY_6( 'FR      ' );
              2087                                                /* This FR will be ref'd by an SFR */
      446     2088         /* if EQUAL TO calckey is same as LOC MODE calckey, then
      447     2089            don't have to check data characteristics */
      448     2090   10                                       IF DBK_RFR ~= DBK_RFR_CALC THEN DO;
      449     2091   10                                           CALL INDEX(CT1,' ',FR_NAME);
      450     2092   10                                           CALL SET_FIELDS(1,CT1,FR_NAME);
      451     2093   11                                           IF UWA.FR.FTYPE ~= FR.FTYPE THEN DO;
      452     2094   11                                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4839);
      453     2095        /*E*  ERROR:  ZIG-4839-C
      454     2096            MESSAGE:  The EQUAL TO field "%U1" does not have the required
      455     2097                      data type.
      456     2098        */
      457     2099   11                                               END;
      458     2100   11                                           ELSE DO;
      459     2101   12                                               IF UWA.FR.PREC ~= FR.PREC THEN DO;
      460     2102   12                                                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4840)
              2102                                                            ;
      461     2103        /*E*  ERROR:  ZIG-4840-C
      462     2104            MESSAGE:  The EQUAL TO field "%U1" does not have the required
      463     2105                      precision.
      464     2106        */
      465     2107   12                                                   END;
      466     2108   12                                               IF UWA.FR.SCALE ~= FR.SCALE THEN DO;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:16   
      467     2109   12                                                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4841)
              2109                                                            ;
      468     2110        /*E*  ERROR:  ZIG-4841-C
      469     2111            MESSAGE:  The EQUAL TO field "%U1" does not have the required
      470     2112                      scale factor.
      471     2113        */
      472     2114   12                                                   END;
      473     2115   12                                               IF UWA.FR.F_SIGN ~= FR.F_SIGN THEN DO;
      474     2116   12                                                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4842)
              2116                                                            ;
      475     2117        /*E*  ERROR:  ZIG-4842-C
      476     2118            MESSAGE:  The EQUAL TO field "%U1" does not have the required
      477     2119                      sign specification.
      478     2120        */
      479     2121   12                                                   END;
      480     2122   11                                               END;
      481     2123   10                                           END;
      482     2124    9                                       END;
      483     2125    8                                   CALL FINDD_6('RC      ',THIS_SN_SO_RC); /* RC */
      484     2126    8                                   UWA.FR.LEVEL = 0;
      485     2127    8                                   UWA.FR.SYN = 1;
      486     2128    8                                   UWA.FR.F_USE = 4;
      487     2129    8                                   UWA.FR.BUFFLOC = DBK_RFR_CALC;
      488     2130    8                                   UWA.FR.FR_FRH = DBK_RFR;
      489     2131    8                                   CALL STRE_6('FR      '); /* SFR */
      490     2132    8                                   UWA.C_F = '0'B;
      491     2133    8                                   UWA.C_F.SYN = 1;
      492     2134    8                                   UWA.C_F.CTRLTYPE = 4; /* calckey */
      493     2135    8                                   CALL FINDD_6('S-S     ',DBK_CALCSS);
      494     2136    8                                   CALL STRE_6('C-F     ');
      495     2137    8                                   CALL CONNECT_6('SSSM-CF ');
      496     2138    8                                   UWA.C_F.CTRLTYPE = 2; /* set selection */
      497     2139    8                                   CALL FINDD_6('S-S     ',DBK_SCANSS);
      498     2140    8                                   CALL STRE_6('C-F     ');
      499     2141    8                                   CALL CONNECT_6('SSSM-CF ');
      500     2142    8                                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 2;
      501     2143    8                                   END;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:17   
      502     2144    7                               END;
      503     2145    6                           END;
      504     2146    5                       END;
      505     2147    5                   IF NUM_EQ_CALCKEYS < UWA.RC.SLACK THEN DO;
      506     2148    5                       CALL FETCHD_6('RC      ',THIS_SN_SO_RC);
      507     2149    5                       CALL FETCHOS_6('SN-SE   ');
      508     2150    5                       CALL INDEX(CT1,' ',UWA.SN.SENAME);
      509     2151    5                       CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
      510     2152    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4837);
      511     2153        /*E*  ERROR:  ZIG-4837-C
      512     2154            MESSAGE:  The set selection clause is invalid because the
      513     2155                      location clause for record "%U1" specifies more calc
      514     2156                      keys than does the EQUAL TO phrase.
      515     2157        */
      516     2158    5                       END;
      517     2159    4                   END;
      518     2160         /* END OF CASE 2 */
      519     2161        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:18   
      520     2162        /*****************************************************************/
      521     2163    3           CASE(%CALC_ONL); /* CALC ONLY */
      522     2164         /* What we need to do here is
      523     2165            1) add an SS to the SMSS set owned by the current SM.
      524     2166            2) add a CF for every calc field in this set's owner record.
      525     2167            This CF is connected to the SS mentioned in 1) and to the
      526     2168            FR of the calc field in the owner record.  The number of calc
      527     2169            fields in the owner rec is determined by the number of CFs in
      528     2170            the SMSSCF set of the SM of the owner record in the *calc set */
      529     2171    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      530     2172    3               LNO = DYNMEM$->WRD1;
      531     2173    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      532     2174    3               IF UWA.RC.PSMODE ~= 1 THEN /* calc */
      533     2175    4               DO;
      534     2176    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);
      535     2177    4                   CALL FETCHOS_6('SN-SE   ');
      536     2178    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);
      537     2179    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
      538     2180    4                   CALL FETCHD_6('SN      ',THIS_SN);
      539     2181    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);
      540     2182    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);
      541     2183    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4834);
      542     2184    4                   END; /* THEN DO */
      543     2185    4               ELSE DO;
      544     2186    5                   IF UWA.RC.CALCDUP = 0 THEN DO; /* 0= DUPS ALLOWED */
      545     2187    5                       CALL FETCHD_6('RC      ',THIS_SN_SO_RC);
      546     2188    5                       CALL FETCHOS_6('SN-SE   ');
      547     2189    5                       CALL INDEX(CT1,' ',UWA.SN.SENAME);
      548     2190    5                       CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
      549     2191    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4835);
      550     2192    5                       END;
      551     2193    4                   CALL FINDPS_6('RC-SOSM '); /* SM in *calc set */
      552     2194    4                   DBK_SM_CALC = UWA.DIRECT_REF;
      553     2195    4                   CALL FCURR_R_6('S-S     ');
      554     2196    4                   CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);
      555     2197    4                   UWA.S_S.SOSM_SSH = DBK_SM_CALC;
      556     2198    4                   UWA.S_S.SC_SSH = THIS_SN_SC;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:19   
      557     2199    4                   UWA.S_S.STYP = 3; /* change from current to member */
      558     2200    4                   CALL MODIFY_6('S-S     ');
      559     2201    4                   UWA.S_S.STYP = 4; /* scan */
      560     2202    4                   CALL STRE_6('S-S     ');
      561     2203    4                   UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;
      562     2204    4                   CALL FINDD_6('SM      ',DBK_SM_CALC);
      563     2205         /* SM in calc set for this owner rec */
      564     2206    4                   CALL FINDNS_6('SMSS-CF '); /* CF of first calc field in owner rec */
      565     2207    4                   DBK_CALC_CF = UWA.DIRECT_REF;
      566     2208    4                   UWA.NR.IMPLCT = IMPLCT;
      567     2209    4                   UWA.NR.RELTYPE = RELTYPE.SS;
      568     2210    4                   UWA.NR.LNO = LNO;
      569     2211    5                   DO WHILE (UWA.DB_STATUS = '0000000');
      570     2212         /* for each calc field in owner rec */
      571     2213    5                       CALL FINDOS_6('FR-CFS  '); /* FR of calc field */
      572     2214    5                       HOLD_DBK = UWA.DIRECT_REF;
      573     2215    5                       UWA.C_F = '0'B;
      574     2216    5                       UWA.C_F.CTRLTYPE = 2; /* set selection */
      575     2217    5                       CALL STRE_6('C-F     ');
      576     2218    5                       UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
      577     2219    5                       CALL CONNECT_6('SSSM-CF ');
      578     2220    5                       CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
      579     2221    5                          'FR      ', 'C-F     ' );
      580     2222         /* add implicit NR */
      581     2223    5                       CALL FINDOS_6('SN-SE   '); /* calc field SN */
      582     2224    5                       CALL STRE_6('NR      ');
      583     2225    5                       CALL FINDD_6('SN      ',LAST_DEF_SET_DBK); /* SN of setname */
      584     2226    5                       CALL FCURR_R_6('NR      ');
      585     2227    5                       CALL CONNECT_6('SN-NRWU ');
      586     2228    5                       UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;
      587     2229    5                       CALL FINDD_6('C-F     ',DBK_CALC_CF);
              2229                                /* go do next calc field */
      588     2230    5                       CALL FINDNS_6('SMSS-CF '); /* CF */
      589     2231    5                       DBK_CALC_CF = UWA.DIRECT_REF;
      590     2232    5                       END; /* WHILE */
      591     2233    4                   END; /* ELSE DO */
      592     2234        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:20   
      593     2235        /*****************************************************************/
      594     2236    3           CASE(%DBK_EQ); /* DBKEY EQUAL TO dbid/dbparam */
      595     2237         /* -change the existing SS to type direct
      596     2238            -add SN (if necessary) and NR
      597     2239            -if this is a dbid then just fetch the RFR,otherwise build RFR
      598     2240            -make sure the type is dbkey
      599     2241            -build CF and connect it to the SS
      600     2242         */
      601     2243    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      602     2244    3               LNO = DYNMEM$->WRD1;
      603     2245    4               IF UWA.RC.PSMODE ~= 0 THEN DO; /* not LOC MODE DIRECT */
      604     2246    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);
      605     2247    4                   CALL FETCHOS_6('SN-SE   ');
      606     2248    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);
      607     2249    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
      608     2250    4                   CALL FETCHD_6('SN      ',THIS_SN);
      609     2251    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);
      610     2252    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);
      611     2253    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4816);
      612     2254        /*E*  ERROR: ZIG-4816-C
      613     2255            MESSAGE: The set selection clause is invalid because the owner
      614     2256                     record "%U1" of set "%U2" does not have LOC MODE DIRECT.
      615     2257        */
      616     2258    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      617     2259    4                   DYNMEM$ = PINCRW(DYNMEM$,8);
      618     2260    5                   IF DYNMEM$->WRD1 = %QUAL THEN DO;
      619     2261    5                       DYNMEM$ = PINCRW(DYNMEM$,1);
      620     2262    5                       DYNMEM$ = PINCRW(DYNMEM$,8);
      621     2263    5                       END;
      622     2264    4                   END;
      623     2265    4               ELSE DO;
      624     2266    4                   CALL FCURR_R_6('S-S     '); /* SS */
      625     2267    4                   CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);
      626     2268    4                   UWA.S_S.SC_SSH = THIS_SN_SC;
      627     2269    4                   UWA.S_S.SOSM_SSH = THIS_SN_SO;
      628     2270    4                   UWA.S_S.STYP = 1; /* DIRECT */
      629     2271    4                   CALL MODIFY_6('S-S     ');
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:21   
      630     2272    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      631     2273    4                   FR_NAME = DYNMEM$->CHAR30;
      632     2274    4                   DYNMEM$ = PINCRW(DYNMEM$,8);
      633     2275    4                   FLAG_ERR = '0'B;
      634     2276    4                   IF DYNMEM$->WRD1 = %QUAL THEN
      635     2277    5                   DO;
      636     2278    5                       DYNMEM$ = PINCRW(DYNMEM$,1);
      637     2279    5                       QRC_NAME = DYNMEM$->CHAR30;
      638     2280    5                       DYNMEM$ = PINCRW(DYNMEM$,8);
      639     2281    5                       CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0
              2281                                )
      640     2282    5                          ;
      641     2283    5                       IF FOUND ~= %FOUNDDEF THEN
      642     2284    6                       DO;
      643     2285    6                           FLAG_ERR = '1'B;
      644     2286    6                           CALL INDEX(CT1,' ',FR_NAME);
      645     2287    6                           CALL SET_FIELDS(1,CT1,FR_NAME);
      646     2288    6                           CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4809);
              2288                                    /*qualifying RC not DEFed */
      647     2289    6                           END;
      648     2290    5                       CALL FINDNS_6('SN-SE   '); /* RC */
      649     2291    5                       QRC_DBK = UWA.DIRECT_REF;
      650     2292    5                       END;
      651     2293    4                   ELSE
      652     2294    4                       QRC_DBK = 0; /* not qualified */
      653     2295    5                   IF NOT FLAG_ERR THEN DO;
      654     2296    5                       CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,
      655     2297    5                          RELTYPE.SS,EXPLCT,QRC_DBK);
      656     2298    5                       IF FOUND = %FOUNDDUP THEN
      657     2299    6                       DO;
      658     2300    6                           CALL FCURR_R_6('NR      ');
      659     2301    6                           CALL ERASE_6('NR      ');
      660     2302    6                           UWA.DA.NUMB_NR = UWA.DA.NUMB_NR - 1;
      661     2303    6                           CALL INDEX(CT1,' ',FR_NAME);
      662     2304    6                           CALL SET_FIELDS(1,CT1,FR_NAME);
      663     2305    6                           CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4801); /* needs qualifier */
      664     2306    6                           END;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:22   
      665     2307    6                       ELSE DO;
      666     2308         /* if qualified but not found then error */
      667     2309    6                           IF QRC_DBK ~= 0 AND FOUND = %NOTFOUND THEN
      668     2310    7                           DO;
      669     2311    7                               CALL INDEX(CT1,' ',FR_NAME);
      670     2312    7                               CALL SET_FIELDS(1,CT1,FR_NAME);
      671     2313    7                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4838);
      672     2314    7                               END;
      673     2315    7                           ELSE DO;
      674     2316    7                               DBK_SN = UWA.DIRECT_REF;
      675     2317    7                               UWA.C_F = '0'B;
      676     2318    7                               UWA.C_F.SYN = 0;
      677     2319    7                               UWA.C_F.CTRLTYPE = 2; /* set selection */
      678     2320         /* if not found, then this is a dbparam and we need
      679     2321            to build a RFR */
      680     2322    7                               FLAG_ERR = '0'B;
      681     2323    8                               IF FOUND = %NOTFOUND THEN DO;
      682     2324    8                                   CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);
              2324                                            /* RC */
      683     2325    8                                   UWA.FR = '0'B;
      684     2326    8                                   UWA.FR.REF = 1;
      685     2327    8                                   UWA.FR.PREC = 35;
      686     2328    8                                   UWA.FR.F_USE = 1;
      687     2329    8                                   CALL FINDD_6('SN      ',DBK_SN);
      688     2330    8                                   CALL STRE_6('FR      '); /* RFR */
      689     2331    8                                   HOLD_DBK = UWA.DIRECT_REF;
      690     2332    8                                   UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
      691     2333    8                                   CALL CONNECT_6('SN-SE   ');
      692     2334    8                                   END;
      693     2335         /* if found, then it is either a dbid or a dbparam
      694     2336            that has already been mentioned previously */
      695     2337    8                               ELSE DO;
      696     2338    8                                   CALL FETCHNS_6('SN-SE   '); /* FR */
      697     2339    8                                   HOLD_DBK = UWA.DIRECT_REF;
      698     2340    9                                   IF UWA.FR.FTYPE ~= 0 THEN DO; /* has to be dbkey */
      699     2341    9                                       FLAG_ERR = '1'B;
      700     2342    9                                       CALL INDEX(CT1,' ',FR_NAME);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:23   
      701     2343    9                                       CALL SET_FIELDS(1,CT1,FR_NAME);
      702     2344    9                                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4815);
      703     2345        /*E*  ERROR:  ZIG-4815-C
      704     2346                     MESSAGE:  The SET SELECTION clause is invalid because the EQUAL TO
      705     2347                               field "%U1" does not have a data type of DATA_BASE_KEY.
      706     2348        */
      707     2349    9                                       END;
      708     2350    8                                   END;
      709     2351         /* the FR we want to connect the CF to is now current */
      710     2352    8                               IF NOT FLAG_ERR THEN DO;
      711     2353    8                                   CALL STRE_6('C-F     ');
      712     2354    8                                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
      713     2355    8                                   CALL CONNECT_6('SSSM-CF ');
      714     2356    8                                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
      715     2357    8                                      'FR      ', 'C-F     ' );
      716     2358    8                                   END; /* THEN DO */
      717     2359    7                               END;
      718     2360    6                           END;
      719     2361    5                       END;
      720     2362    4                   END;
      721     2363         /* END CASE 4 */
      722     2364        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:24   
      723     2365        /*****************************************************************/
      724     2366    3           CASE(%DBK_ONL); /* DBKEY only */
      725     2367         /* -change the existing SS to type direct
      726     2368            -make sure THIS_SN's set owner record is LOC MODE DIRECT
      727     2369            -fetch the SFR of the direct item mentioned in the LOC MODE clause
      728     2370            -if a corresponding RFR exists for this SFR, then just fetch it,
      729     2371            otherwise build a RFR and modify this SFR to reflect this
      730     2372            -build a RCF and connect it to the SS
      731     2373         */
      732     2374    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      733     2375    3               LNO = DYNMEM$->WRD1;
      734     2376    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      735     2377    3               CALL FCURR_R_6('S-S     '); /* SS */
      736     2378    3               CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);
      737     2379    3               UWA.S_S.SC_SSH = THIS_SN_SC;
      738     2380    3               UWA.S_S.SOSM_SSH = THIS_SN_SO;
      739     2381    3               UWA.S_S.STYP = 1; /* DIRECT */
      740     2382    3               CALL MODIFY_6('S-S     ');
      741     2383    4               IF UWA.RC.PSMODE ~= 0 THEN DO; /* DIRECT */
      742     2384    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);
      743     2385    4                   CALL FETCHOS_6('SN-SE   ');
      744     2386    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);
      745     2387    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
      746     2388    4                   CALL FETCHD_6('SN      ',THIS_SN);
      747     2389    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);
      748     2390    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);
      749     2391    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4816);
      750     2392    4                   END;
      751     2393    4               ELSE DO;
      752     2394    4                   CALL FETCHNS_6('RC-FR   '); /* SFR */
      753     2395    5                   DO WHILE (UWA.FR.F_USE ~= 3); /* want SFR of LOC MODE DIRECT item */
      754     2396    5                       CALL FETCHNS_6('RC-FR   ');
      755     2397    5                       END;
      756     2398    4                   CALL FETCHD_6('FR      ',UWA.FR.FR_FRH); /* RFR */
      757     2399    4                   HOLD_DBK = UWA.DIRECT_REF;
      758     2400    4                   CALL FINDOS_6('SN-SE   '); /* SN */
      759     2401         /* add implicit NR */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:25   
      760     2402    4                   UWA.NR.IMPLCT = 1;
      761     2403    4                   UWA.NR.RELTYPE = RELTYPE.SS;
      762     2404    4                   UWA.NR.LNO = LNO;
      763     2405    4                   CALL STRE_6('NR      ');
      764     2406    4                   UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;
      765     2407    4                   CALL FINDD_6('SN      ',LAST_DEF_SET_DBK);
      766     2408    4                   CALL FCURR_R_6('NR      ');
      767     2409    4                   CALL CONNECT_6('SN-NRWU ');
      768     2410    4                   UWA.C_F = '0'B;
      769     2411    4                   UWA.C_F.CTRLTYPE = 2; /* set selection */
      770     2412    4                   CALL STRE_6('C-F     ');
      771     2413    4                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
      772     2414    4                   CALL CONNECT_6('SSSM-CF ');
      773     2415    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
      774     2416    4                      'FR      ', 'C-F     ' );
      775     2417    4                   END; /* ELSE DO */
      776     2418         /* END CASE 5 */
      777     2419        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:26   
      778     2420        /*****************************************************************/
      779     2421    3           CASE(%MEMB); /* MEMBER recname SELECTION */
      780     2422         /* -find the SN of the recordname and generate NR
      781     2423            -find tehhe RC of that SN
      782     2424            -go through RCSOSM of that RC looking for SM that belongs
      783     2425            to SCSOSM of THIS_SN's SC
      784     2426            -when found, put DBK of SM into SS.SOSM_SSH field in SS
      785     2427            -modify the SS
      786     2428         */
      787     2429    3               CALL FETCHD_6('SM      ',THIS_SM); /* SM */
      788     2430    3               UWA.SM.PA_MEMPNT = 1; /* misuse this field to signify MEMBER */
      789     2431    3               CALL MODIFY_6('SM      ');
      790     2432    3               CALL FINDOS_6('RC-SOSM '); /* RC */
      791     2433    3               THIS_SM_RC = UWA.DIRECT_REF;
      792     2434    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      793     2435    3               LNO = DYNMEM$->WRD1;
      794     2436    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      795     2437    3               CALL ADD_SN(%ZIG_RTYPE_RC,DYNMEM$->CHAR30,0,LNO,FOUND,RELTYPE.SS,
      796     2438    3                  EXPLCT,0);
      797     2439    3               DYNMEM$ = PINCRW(DYNMEM$,8);
      798     2440    4               IF FOUND = %NOTFOUND THEN DO;
      799     2441    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4211);
      800     2442    4                   END;
      801     2443    3               CALL FINDNS_6('SN-SE   '); /* RC */
      802     2444    3               IF THIS_SM_RC = UWA.DIRECT_REF THEN
      803     2445    4               DO;
      804     2446    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4830);
      805     2447    4                   END;
      806     2448    3               CALL FINDNS_6('RC-SOSM '); /* SO OR SM */
      807     2449    3               FOUND_IT = '0'B;
      808     2450    4               DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (FOUND_IT = '0'B));
      809     2451    5                   IF UWA.RECORD_NAME = 'SM' THEN DO;
      810     2452    5                       DBK_LAST_SM = UWA.DIRECT_REF;
      811     2453    5                       CALL FINDOS_6('SC-SOSM '); /* SC */
      812     2454    6                       IF UWA.DIRECT_REF = THIS_SN_SC THEN DO;
      813     2455    6                           FOUND_IT = '1'B;
      814     2456    6                           END;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:27   
      815     2457    5                       END;
      816     2458    4                   CALL FINDNS_6('RC-SOSM '); /* SO OR SM */
      817     2459    4                   END;
      818     2460    4               IF ~FOUND_IT THEN DO;
      819     2461    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4990);
      820     2462        /*E*  ERROR:  ZIG-4990-C
      821     2463            MESSAGE:  The record "%U1" is not a member of the set.
      822     2464        */
      823     2465    4                   END;
      824     2466    3               CALL FCURR_R_6('S-S     '); /* SS */
      825     2467    3               CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);
      826     2468    3               UWA.S_S.SOSM_SSH = DBK_LAST_SM;
      827     2469    3               UWA.S_S.SC_SSH = THIS_SN_SC;
      828     2470    3               UWA.S_S.STYP = 3; /* member */
      829     2471    3               CALL MODIFY_6('S-S     ');
      830     2472         /* END CASE 6 */
      831     2473        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:28   
      832     2474        /*****************************************************************/
      833     2475    3           CASE(%THEN_THRU); /* beginning of THEN THRU clause */
      834     2476    3               FIRST_WHERE = '1'B;
      835     2477    3               NUM_CTRL_FLDS = 0;
      836     2478    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      837     2479    3               LNO = DYNMEM$->WRD1;
      838     2480    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      839     2481    3               PREV_THRU_SN = THIS_SN;
      840     2482    3               PREV_THRU_SN_SC = THIS_SN_SC;
      841     2483    3               CALL ADD_SN(%ZIG_RTYPE_SC,DYNMEM$->CHAR30,0,LNO+1,FOUND,
      842     2484    3                  RELTYPE.SS,EXPLCT,0);
      843     2485    3               CALL INDEX(CT1,' ',DYNMEM$->CHAR30);
      844     2486    3               CALL SET_FIELDS(1,CT1,DYNMEM$->CHAR30);
      845     2487    3               DYNMEM$ = PINCRW(DYNMEM$,8);
      846     2488    3               THIS_SN = UWA.DIRECT_REF;
      847     2489    4               IF FOUND ~= %FOUNDDEF THEN DO;
      848     2490    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4217);
      849     2491    4                   END;
      850     2492         /*
      851     2493            Make sure that the owner RC of THIS_SN's SC
      852     2494            is a member of the PREV_THRU_SN's set
      853     2495         */
      854     2496    3               CALL FETCHNS_6('SN-SE   '); /* SC of THIS_SN */
      855     2497    3               THIS_SN_SC = UWA.DIRECT_REF;
      856     2498    3               UWA.SC.ALTOWN = 2; /* Flag SC in THEN THRU chain */
      857     2499    3               CALL MODIFY_6('SC      ');
      858     2500    3               CALL FINDNS_6('SC-SOSM '); /* SO of SC */
      859     2501    3               CALL FINDOS_6('RC-SOSM '); /* RC of SO */
      860     2502    3               THIS_SN_SO_RC = UWA.DIRECT_REF;
      861     2503    3               CALL FETCHNS_6('RC-SOSM '); /* SO or SM */
      862     2504    3               FOUND_IT = '0'B;
      863     2505    4               DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (FOUND_IT = '0'B));
      864     2506    5                   IF UWA.RECORD_NAME = 'SM' THEN DO;
      865     2507    5                       DBK_LAST_SM = UWA.DIRECT_REF;
      866     2508    5                       CALL FINDOS_6('SC-SOSM '); /* SC */
      867     2509    6                       IF UWA.DIRECT_REF = PREV_THRU_SN_SC THEN DO;
      868     2510    6                           FOUND_IT = '1'B;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:29   
      869     2511    6                           IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN
      870     2512    7                           DO;
      871     2513    7                               CALL ZIG$D_DIAG(LNO,%WARN_SEV,4982);
      872     2514        /*E*  ERROR:  ZIG-4982-C
      873     2515            MESSAGE:  The set selection clause is invalid because this record
      874     2516                      is a MANUAL or OPTIONAL member and may not be connected.
      875     2517        */
      876     2518    7                               END;
      877     2519    6                           END;
      878     2520    5                       END;
      879     2521    4                   CALL FETCHNS_6('RC-SOSM '); /* SO or SM */
      880     2522    4                   END;
      881     2523    4               IF ~FOUND_IT THEN DO;
      882     2524    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4986);
      883     2525        /*E*  ERROR:  ZIG-4986-C
      884     2526            MESSAGE:  The set selection clause is invalid because the owner
      885     2527                      record of this set is not a member of the prior set
      886     2528                      causing a break in the continuous path.
      887     2529        */
      888     2530    4                   END;
      889     2531    3               CALL FETCHD_6('SM      ',DBK_LAST_SM); /* SM */
      890     2532    3               IF (UWA.SM.CALCDUP = 0) AND /* DUPS ALLOWED on calc fields*/
      891     2533    3                  (UWA.SM.MEMDUP = 0) AND /* member DUPS not specified */
      892     2534    4                  (UWA.SM.SEQDUP ~= 2) THEN DO; /* not DUPS NOT ALLOWED on keys */
      893     2535    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4922);
      894     2536        /*E*  ERROR:  ZIG-4922-C
      895     2537            MESSAGE:  The specified set OWNER ID fields cannot be matched with
      896     2538                      those of a DUPLICATES NOT phrase.
      897     2539        */
      898     2540    4                   END;
      899     2541    3               CALL FETCHOS_6('SC-SOSM '); /* SC */
      900     2542    3               IF (UWA.SC.SETORD ~= 4) AND
      901     2543    3                  (UWA.SC.SETORD ~= 6) AND /* not INSERTION SORTED */
      902     2544    4                  (UWA.SM.MEMDUP = 0) THEN DO; /* DUPS NOT not specified */
      903     2545    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4922);
      904     2546    4                   END;
      905     2547        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:30   
      906     2548        /*****************************************************************/
      907     2549    3           CASE(%THEN_OWNER); /* WHERE OWNER IDENTIFIED BY dbid */
      908     2550    3               IF NUM_CTRL_FLDS < 100 THEN
      909     2551    3                   NUM_CTRL_FLDS = NUM_CTRL_FLDS + 1;
      910     2552    4               ELSE DO;
      911     2553    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4853);
      912     2554        /*E*  ERROR:  ZIG-4853-C
      913     2555            MESSAGE:  Implementation restriction.  No more than 100 control
      914     2556                      fields may be specified for the selection of one record
      915     2557                      within a set selection path.
      916     2558        */
      917     2559    4                   END;
      918     2560    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      919     2561    3               LNO = DYNMEM$->WRD1;
      920     2562    3               DYNMEM$ = PINCRW(DYNMEM$,1);
      921     2563    3               FR_NAME = DYNMEM$->CHAR30;
      922     2564    3               DYNMEM$ = PINCRW(DYNMEM$,8);
      923     2565    3               IF DYNMEM$->WRD1 = %QUAL THEN
      924     2566    4               DO;
      925     2567    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      926     2568    4                   QRC_NAME = DYNMEM$->CHAR30;
      927     2569    4                   DYNMEM$ = PINCRW(DYNMEM$,8);
      928     2570    4                   CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0)
      929     2571    4                      ;
      930     2572    4                   IF FOUND ~= %FOUNDDEF THEN
      931     2573    5                   DO;
      932     2574    5                       CALL INDEX(CT1,' ',FR_NAME);
      933     2575    5                       CALL SET_FIELDS(1,CT1,FR_NAME);
      934     2576    5                       CALL ZIG$D_DIAG(LNO,%WARN_SEV,4809);
              2576                                /*qualifying RC not DEFed */
      935     2577    5                       END;
      936     2578    4                   CALL FINDNS_6('SN-SE   '); /* RC */
      937     2579    4                   IF UWA.DIRECT_REF ~= THIS_SN_SO_RC THEN
      938     2580    5                   DO;
      939     2581    5                       CALL INDEX(CT1,' ',FR_NAME);
      940     2582    5                       CALL SET_FIELDS(1,CT1,FR_NAME);
      941     2583    5                       CALL ZIG$D_DIAG(LNO,%WARN_SEV,4809);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:31   
      942     2584    5                       END;
      943     2585    4                   QRC_DBK = UWA.DIRECT_REF;
      944     2586    4                   END;
      945     2587    3               ELSE
      946     2588    3                   QRC_DBK = THIS_SN_SO_RC; /* not qualified; must be in RC
      947     2589         that owns set named in THEN THRU clause */
      948     2590    3               CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.SS,
      949     2591    3                  EXPLCT,QRC_DBK);
      950     2592    4               IF (FOUND = %NOTFOUND) THEN DO;
      951     2593    4                   CALL INDEX(CT1,' ',FR_NAME);
      952     2594    4                   CALL SET_FIELDS(1,CT1,FR_NAME);
      953     2595    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4838);
      954     2596    4                   END;
      955     2597    4               IF (FOUND = %FOUNDDUP) THEN DO;
      956     2598    4                   CALL INDEX(CT1,' ',FR_NAME);
      957     2599    4                   CALL SET_FIELDS(1,CT1,FR_NAME);
      958     2600    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4801); /* needs qualifier */
      959     2601    4                   END;
      960     2602    3               CALL FETCHNS_6('SN-SE   '); /* FR */
      961     2603    3               IF UWA.FR.REF ~= 1 THEN
      962     2604    4               DO;
      963     2605    4                   UWA.FR.REF = 1;
      964     2606    4                   CALL MODIFY_6('FR      ');
      965     2607    4                   END;
      966     2608    3               DBK_WHER_FR = UWA.DIRECT_REF;
      967     2609    3               FR.FTYPE = UWA.FR.FTYPE;
      968     2610    3               FR.PREC = UWA.FR.PREC;
      969     2611    3               FR.SCALE = UWA.FR.SCALE;
      970     2612    3               FR.F_SIGN = UWA.FR.F_SIGN;
      971     2613         /* build the ss */
      972     2614    3               CALL FINDD_6('SM      ',THIS_SM); /* SM */
      973     2615    3               UWA.S_S = '0'B;
      974     2616    3               IF FIRST_WHERE THEN
      975     2617    4               DO;
      976     2618    4                   IF THIS_SN_SC = THIS_SC THEN /* this is last thenthru */
      977     2619    4                       UWA.S_S.STYP = 5; /* scanrange */
      978     2620    4                   ELSE
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:32   
      979     2621    4                       UWA.S_S.STYP = 4; /* scan */
      980     2622    4                   UWA.S_S.SC_SSH = THIS_SN_SC;
      981     2623    4                   UWA.S_S.SOSM_SSH = DBK_LAST_SM; /* CHECK THIS!!!! */
      982     2624    4                   CALL STRE_6('S-S     ');
      983     2625    4                   UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;
      984     2626    4                   FIRST_WHERE = '0'B;
      985     2627    4                   END;
      986     2628    3               ELSE
      987     2629    4               DO;
      988     2630    4                   CALL FCURR_R_6('S-S     ');
      989     2631    4                   END;
      990     2632    3               UWA.C_F = '0'B;
      991     2633    3               UWA.C_F.CTRLTYPE = 2; /* set selection */
      992     2634         /* if EQUAL TO specified, need a different FR than the one
      993     2635            we've already gotten above */
      994     2636    4               IF DYNMEM$->WRD1 = %EQUAL_TO THEN DO;
      995     2637    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      996     2638    4                   LNO = DYNMEM$->WRD1;
      997     2639    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      998     2640    4                   FR_NAME = DYNMEM$->CHAR30;
      999     2641    4                   DYNMEM$ = PINCRW(DYNMEM$,8);
     1000     2642    4                   IF DYNMEM$->WRD1 = %QUAL THEN
     1001     2643    5                   DO;
     1002     2644    5                       DYNMEM$ = PINCRW(DYNMEM$,1);
     1003     2645    5                       QRC_NAME = DYNMEM$->CHAR30;
     1004     2646    5                       DYNMEM$ = PINCRW(DYNMEM$,8);
     1005     2647    5                       CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0
              2647                                )
     1006     2648    5                          ;
     1007     2649    5                       IF FOUND ~= %FOUNDDEF THEN
     1008     2650    6                       DO;
     1009     2651    6                           CALL INDEX(CT1,' ',FR_NAME);
     1010     2652    6                           CALL SET_FIELDS(1,CT1,FR_NAME);
     1011     2653    6                           CALL ZIG$D_DIAG(LNO,%ERR_SEV,4809);
              2653                                    /*qualifying RC not DEFed */
     1012     2654    6                           END;
     1013     2655    5                       CALL FINDNS_6('SN-SE   '); /* RC */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:33   
     1014     2656    5                       QRC_DBK = UWA.DIRECT_REF;
     1015     2657    5                       END;
     1016     2658    4                   ELSE
     1017     2659    4                       QRC_DBK = 0; /* not qualified */
     1018     2660    4                   CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.SS,
     1019     2661    4                      EXPLCT,QRC_DBK);
     1020     2662    4                   IF FOUND = %FOUNDDUP THEN
     1021     2663    5                   DO;
     1022     2664    5                       CALL INDEX(CT1,' ',FR_NAME);
     1023     2665    5                       CALL SET_FIELDS(1,CT1,FR_NAME);
     1024     2666    5                       CALL ZIG$D_DIAG(LNO,%ERR_SEV,4801); /*needs qualifier */
     1025     2667    5                       END;
     1026     2668         /* if qualified but not found then error */
     1027     2669    4                   IF QRC_DBK ~= 0 AND FOUND = %NOTFOUND THEN
     1028     2670    5                   DO;
     1029     2671    5                       CALL INDEX(CT1,' ',FR_NAME);
     1030     2672    5                       CALL SET_FIELDS(1,CT1,FR_NAME);
     1031     2673    5                       CALL ZIG$D_DIAG(LNO,%ERR_SEV,4838);
     1032     2674    5                       END;
     1033     2675    4                   DBK_SN = UWA.DIRECT_REF;
     1034     2676         /* if not found, then this is a dbparam and we need
     1035     2677            to build a RFR and a SFR */
     1036     2678    5                   IF FOUND = %NOTFOUND THEN DO;
     1037     2679    5                       CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC); /* RC */
     1038     2680    5                       UWA.FR.SYN = 0;
     1039     2681    5                       UWA.FR.REF = 1;
     1040     2682    5                       UWA.FR.F_USE = 1;
     1041     2683    5                       UWA.FR.LEVEL = 0;
     1042     2684    5                       CALL FINDD_6('SN      ',DBK_SN);
     1043     2685    5                       CALL STRE_6('FR      '); /* RFR */
     1044     2686    5                       UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
     1045     2687    5                       DBK_RFR = UWA.DIRECT_REF;
     1046     2688    5                       CALL CONNECT_6('SN-SE   ');
     1047     2689    5                       CALL FINDD_6('RC      ',THIS_SN_SO_RC); /* RC */
     1048     2690    5                       UWA.FR.SYN = 1;
     1049     2691    5                       UWA.FR.F_USE = 5;
     1050     2692    5                       UWA.FR.FR_FRH = DBK_RFR;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:34   
     1051     2693    5                       UWA.FR.BUFFLOC = DBK_WHER_FR;
     1052     2694    5                       CALL STRE_6('FR      '); /* SFR */
     1053     2695    5                       UWA.C_F.SYN = 1;
     1054     2696    5                       END;
     1055     2697         /* if found, then it is either a dbid or a dbparam
     1056     2698            that has already been mentioned previously. All
     1057     2699            we need do is check the data characteristics against
     1058     2700            the WHER FR */
     1059     2701    5                   ELSE DO;
     1060     2702    5                       CALL FETCHNS_6('SN-SE   '); /* RFR */
     1061     2703    5                       CALL INDEX(CT1,' ',FR_NAME);
     1062     2704    5                       CALL SET_FIELDS(1,CT1,FR_NAME);
     1063     2705    6                       IF FR.FTYPE ~= UWA.FR.FTYPE THEN DO;
     1064     2706    6                           CALL ZIG$D_DIAG(LNO,%ERR_SEV,4839);
     1065     2707    6                           END;
     1066     2708    6                       ELSE DO;
     1067     2709    7                           IF FR.PREC ~= UWA.FR.PREC THEN DO;
     1068     2710    7                               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4840);
     1069     2711    7                               END;
     1070     2712    7                           IF FR.SCALE ~= UWA.FR.SCALE THEN DO;
     1071     2713    7                               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4841);
     1072     2714    7                               END;
     1073     2715    7                           IF FR.F_SIGN ~= UWA.FR.F_SIGN THEN DO;
     1074     2716    7                               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4842);
     1075     2717    7                               END;
     1076     2718    6                           END;
     1077     2719    5                       END;
     1078     2720    4                   END;
     1079     2721         /* the FR we want to connect the CF to is now current */
     1080     2722    3               CALL FCURR_R_6('FR      ');
     1081     2723    3               HOLD_DBK = UWA.DIRECT_REF;
     1082     2724    3               CALL STRE_6('C-F     ');
     1083     2725    3               CALL CONNECT_6('SSSM-CF ');
     1084     2726    3               CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
     1085     2727    3                  'FR      ', 'C-F     ' );
     1086     2728        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:35   
     1087     2729    3               UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
     1088     2730        /*****************************************************************/
     1089     2731    3           CASE(%END_MEM_ENTRY);
     1090     2732         /* What needs to be done here is check that the last THRU
     1091     2733            setname mentioned is the same as the current set being
     1092     2734            defined */
     1093     2735    3               DYNMEM$ = PINCRW(DYNMEM$, 1);
     1094     2736    4               IF THIS_SC ~= THIS_SN_SC THEN DO;
     1095     2737    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4980);
     1096     2738        /*E*  ERROR:  ZIG-4980-C
     1097     2739            MESSAGE:  The set selection is improperly terminated.  Additional
     1098     2740                      specification is required.
     1099     2741        */
     1100     2742    4                   END;
     1101     2743        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:36   
     1102     2744        /*****************************************************************/
     1103     2745    3           CASE(%WITHIN_ANY); /* WITHIN ANY AREA [EXCEPT...] clause */
     1104     2746         /* - get the SN of THIS_RC
     1105     2747            - for each area in the schema:
     1106     2748            - find the areaname and compare it to the names
     1107     2749            in the EXCEPT phrase
     1108     2750            - if this area is an exception area, then just build an
     1109     2751            explicit NR.
     1110     2752            - if this area is not an exception area, build an implicit
     1111     2753            NR and build an RA
     1112     2754            - check validity of areanames given in exception phrase by
     1113     2755            blanking them out when they match the current areaname.  By
     1114     2756            the end of the OA-AC set, all the exception areas should be
     1115     2757            blank.  If not, either they are invalid areas or an
     1116     2758            areaname was given more than once.
     1117     2759         */
     1118     2760    3               DYNMEM$ = PINCRW(DYNMEM$,1);
     1119     2761    3               THIS_RC = DYNMEM$->WRD1;
     1120     2762    3               DYNMEM$ = PINCRW(DYNMEM$,1);
     1121     2763    3               ANY_LNO = DYNMEM$->WRD1;
     1122     2764    3               DYNMEM$ = PINCRW(DYNMEM$,1);
     1123     2765    3               EXC_START$ = DYNMEM$;
     1124     2766    3               CALL FETCHD_6('RC      ',THIS_RC); /* RC */
     1125     2767    3               CALL FINDOS_6('SN-SE   '); /* SN */
     1126     2768    3               THIS_RC_SN = UWA.DIRECT_REF;
     1127     2769    3               CALL FCURR_R_6('OA      '); /* OA */
     1128     2770    3               CALL FINDNS_6('OA-AC   '); /* AC */
     1129     2771    3               UWA.NR = '0'B;
     1130     2772    3               UWA.NR.RELTYPE = 7; /* LOC */
     1131     2773    3               UWA.RA = '0'B;
     1132     2774    4               DO WHILE (UWA.DB_STATUS ~= '0502100');
     1133     2775    4                   UWA.NR.LNO = ANY_LNO;
     1134     2776    4                   UWA.NR.IMPLCT = 1;
     1135     2777    4                   FOUND_IT = '0'B;
     1136     2778    4                   CALL FETCHOS_6('SN-SE   '); /* SN areaname */
     1137     2779    4                   DYNMEM$ = EXC_START$;
     1138     2780    5                   DO WHILE ((DYNMEM$->WRD1 = %EXC_AREA) AND (FOUND_IT = '0'B));
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:37   
     1139     2781    5                       DYNMEM$ = PINCRW(DYNMEM$,1);
     1140     2782    5                       LNO = DYNMEM$->WRD1;
     1141     2783    5                       DYNMEM$ = PINCRW(DYNMEM$,1);
     1142     2784    6                       IF UWA.SN.SENAME = DYNMEM$->CHAR30 THEN DO;
     1143     2785         /* this is an exception area */
     1144     2786    6                           UWA.NR.IMPLCT = 0;
     1145     2787    6                           UWA.NR.LNO = LNO;
     1146     2788    6                           DYNMEM$->CHAR30 = ' ';
     1147     2789    6                           FOUND_IT = '1'B;
     1148     2790    6                           END;
     1149     2791    5                       DYNMEM$ = PINCRW(DYNMEM$,8);
     1150     2792    5                       END;
     1151     2793         /* add the NR */
     1152     2794    4                   CALL STRE_6('NR      ');
     1153     2795    4                   UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;
     1154     2796    4                   CALL FINDD_6('SN      ',THIS_RC_SN);
     1155     2797    4                   CALL FCURR_R_6('NR     ');
     1156     2798    4                   CALL CONNECT_6('SN-NRWU ');
     1157     2799         /* add RA */
     1158     2800    5                   IF UWA.NR.IMPLCT = 1 THEN DO; /* not an exception area */
     1159     2801    5                       CALL STRE_6('RA      ');
     1160     2802    5                       UWA.OA.NUMB_RA = UWA.OA.NUMB_RA + 1;
     1161     2803         /* set AC bit if altkeys or prime keys present in record */
     1162     2804    5                       IF UWA.RC.KEY_PRESENT = 1 OR UWA.RC.PSMODE = 4 THEN
     1163     2805    6                       DO;
     1164     2806    6                           CALL FETCHOS_6('AC-RA   ');
     1165     2807    6                           IF UWA.RC.PSMODE = 4 /* INDEXED */
     1166     2808    7                           THEN DO;
     1167     2809    7                               UWA.AC.PRIME_KEY = 1;
     1168     2810    7                               UWA.AC.PAGE_TYP = 3;
     1169     2811    7                               END;
     1170     2812    6                           ELSE UWA.AC.SEC_KEY = 1;
     1171     2813    6                           CALL MODIFY_6('AC      ');
     1172     2814    6                           IF UWA.RC.PSMODE = 4 THEN /* INDEXED */
     1173     2815    7                           DO;
     1174     2816    7                               CALL FINDNS_6('AC-RA   '); /* RA */
     1175     2817    7                               CALL FINDNS_6('AC-RA   ');
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:38   
     1176     2818         /* should not be another RA */
     1177     2819    7                               IF UWA.DB_STATUS ~= '0502100' THEN
     1178     2820    8                               DO;
     1179     2821    8                                   CALL ZIG$D_DIAG(ANY_LNO,%ERR_SEV,4977);
     1180     2822    8                                   END;
     1181     2823    7                               END;
     1182     2824    6                           END;
     1183     2825    5                       END;
     1184     2826    4                   CALL FINDNS_6('OA-AC   '); /* AC */
     1185     2827    4                   END;
     1186     2828         /* check validity of exception areanames given */
     1187     2829    3               DYNMEM$ = EXC_START$;
     1188     2830    4               DO WHILE (DYNMEM$->WRD1 = %EXC_AREA);
     1189     2831    5                   IF PINCRW(DYNMEM$,2)->CHAR30 ~= ' ' THEN DO;
     1190     2832    5                       CALL ZIG$D_DIAG(ANY_LNO,%ERR_SEV,4156);
     1191     2833    5                       END;
     1192     2834    4                   DYNMEM$ = PINCRW(DYNMEM$,10);
     1193     2835    4                   END;
     1194     2836        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:39   
     1195     2837        /*****************************************************************/
     1196     2838    3           CASE(%DIRECT); /* LOCATION MODE DIRECT clause */
     1197     2839         /* -if this is the first reference to a dbparam,
     1198     2840            then build a RFR
     1199     2841            -if the FR is qualified and has not been DEFed, then error.
     1200     2842            -in any case, add a SFR to the RC of this LOC MODE clause.
     1201     2843         */
     1202     2844    3               DYNMEM$ =PINCRW(DYNMEM$,1);
     1203     2845    3               THIS_RC = DYNMEM$->WRD1;
     1204     2846    3               CALL FINDD_6('RC      ',THIS_RC);
     1205     2847    3               CALL FINDOS_6('SN-SE   '); /* SN */
     1206     2848    3               LAST_DEF_REC_DBK = UWA.DIRECT_REF;
     1207     2849    3               DYNMEM$ = PINCRW(DYNMEM$,1);
     1208     2850    3               LNO = DYNMEM$->WRD1;
     1209     2851    3               DYNMEM$ = PINCRW(DYNMEM$,1);
     1210     2852    3               FR_NAME = DYNMEM$->CHAR30;
     1211     2853    3               DYNMEM$ = PINCRW(DYNMEM$,8);
     1212     2854    3               IF DYNMEM$->WRD1 = %QUAL THEN
     1213     2855    4               DO;
     1214     2856    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1215     2857    4                   QRC_NAME = DYNMEM$->CHAR30;
     1216     2858    4                   DYNMEM$ = PINCRW(DYNMEM$,8);
     1217     2859    4                   CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0)
     1218     2860    4                      ;
     1219     2861    4                   IF FOUND ~= %FOUNDDEF THEN
     1220     2862    5                   DO;
     1221     2863    5                       CALL INDEX(CT1,' ',FR_NAME);
     1222     2864    5                       CALL SET_FIELDS(1,CT1,FR_NAME);
     1223     2865    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4809);
              2865                                /*qualifying RC not DEFed */
     1224     2866    5                       END;
     1225     2867    4                   CALL FINDNS_6('SN-SE   '); /* RC */
     1226     2868    4                   QRC_DBK = UWA.DIRECT_REF;
     1227     2869    4                   END;
     1228     2870    3               ELSE
     1229     2871    3                   QRC_DBK = 0; /* not qualified */
     1230     2872    3               CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:40   
     1231     2873    3                  QRC_DBK);
     1232     2874    3               IF FOUND ~= %FOUNDDEF AND QRC_DBK ~= 0 THEN
     1233     2875    4               DO;
     1234     2876    4                   CALL INDEX(CT1,' ',FR_NAME);
     1235     2877    4                   CALL SET_FIELDS(1,CT1,FR_NAME);
     1236     2878    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4802);
              2878                            /* qualified but never defed */
     1237     2879        /*E* ERROR:  ZIG-4802-C
     1238     2880            MESSAGE:  The LOCATION DIRECT field "%U1" is invalid because it
     1239     2881                      cannot be matched with a field of the record named
     1240     2882                      by the qualifier.
     1241     2883        */
     1242     2884    4                   END;
     1243     2885    3               IF FOUND = %FOUNDDUP THEN
     1244     2886    4               DO;
     1245     2887    4                   CALL INDEX(CT1,' ',FR_NAME);
     1246     2888    4                   CALL SET_FIELDS(1,CT1,FR_NAME);
     1247     2889    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4801); /* needs qualifier */
     1248     2890    4                   END;
     1249     2891    3               IF FOUND = %NOTFOUND AND QRC_DBK = 0 THEN /* 1st ref of dbparam */
     1250     2892    4               DO;
     1251     2893    4                   DBK_SN = UWA.DIRECT_REF;
     1252     2894    4                   CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC); /* RC */
     1253     2895    4                   UWA.FR = '0'B;
     1254     2896    4                   UWA.FR.REF = 1;
     1255     2897    4                   UWA.FR.PREC = 35;
     1256     2898    4                   UWA.FR.F_USE = 1;
     1257     2899    4                   UWA.FR.BEIST = 2; /* Misuse to signify DIRECT dbparam */
     1258     2900    4                   CALL FINDD_6('SN      ',DBK_SN); /* SN */
     1259     2901    4                   CALL STRE_6('FR      '); /* RFR */
     1260     2902    4                   UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
     1261     2903    4                   CALL CONNECT_6('SN-SE   ');
     1262     2904    4                   END;
     1263     2905    3               CALL FCURR_R_6('SN      '); /* SN */
     1264     2906    3               CALL FETCHNS_6('SN-SE   '); /* RFR */
     1265     2907    3               IF UWA.FR.FTYPE ~= 0 THEN /* not type dbkey */
     1266     2908    4               DO;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:41   
     1267     2909    4                   CALL INDEX(CT1,' ',FR_NAME);
     1268     2910    4                   CALL SET_FIELDS(1,CT1,FR_NAME);
     1269     2911    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4803);
     1270     2912        /*E*  ERROR: ZIG-4803-C
     1271     2913            MESSAGE: The LOCATION DIRECT field "%U1" is invalid because it
     1272     2914                     does not have a data type of DATA_BASE_KEY.
     1273     2915        */
     1274     2916    4                   END;
     1275     2917    3               UWA.FR.REF = 1;
     1276     2918    3               CALL MODIFY_6('FR      '); /* RFR */
     1277     2919    3               DBK_RFR = UWA.DIRECT_REF;
     1278     2920    3               CALL FINDD_6('RC      ',THIS_RC); /* LOC MODE RC */
     1279     2921    3               UWA.FR.SYN = 1;
     1280     2922    3               UWA.FR.REF = 0;
     1281     2923    3               UWA.FR.F_USE = 3;
     1282     2924    3               UWA.FR.LEVEL = 0;
     1283     2925    3               UWA.FR.BEIST = 0;
     1284     2926    3               UWA.FR.FR_FRH = DBK_RFR;
     1285     2927    3               CALL STRE_6('FR      '); /* SFR */
     1286     2928    3               END; /* CASE */
     1287     2929    2           END; /* DO WHILE */
     1288     2930        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:42   
     1289     2931        /*
     1290     2932
     1291     2933
     1292     2934
     1293     2935        */
     1294     2936
     1295     2937    1       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);
     1296     2938    1       CALL FINDNS_6('OA-RC   ');
     1297     2939    2       DO WHILE UWA.DB_STATUS ~= '0502100';
     1298     2940    2           IF UWA.DIRECT_REF = DBK_STAR_DBPARAM_RC
     1299     2941    3           THEN DO;
     1300     2942    3               FOUND_DIRECT = '0'B;
     1301     2943    3               CALL FETCHPS_6('RC-FR   ');
     1302     2944    3               MOVE_MEM = UWA.DIRECT_REF;
     1303     2945    3               PREV_MEM = 0;
     1304     2946    3               FIRST_FR = '1'B;
     1305     2947    4               DO WHILE UWA.DB_STATUS ~= '0502100' AND UWA.FR.BEIST ~= 1
     1306     2948    4                  AND MOVE_MEM ~= PREV_MEM;
     1307     2949    4                   IF UWA.FR.BEIST = 2
     1308     2950    5                   THEN DO;
     1309     2951    5                       FOUND_DIRECT = '1'B;
     1310     2952    5                       IF NOT FIRST_FR
     1311     2953    6                       THEN DO;
     1312     2954    6                           MOVE_MEM = UWA.DIRECT_REF;
     1313     2955    6                           CALL FINDPS_6('RC-FR   ');
     1314     2956    6                           PREV_MEM = UWA.DIRECT_REF;
     1315     2957    6                           CALL FINDD_6('FR      ',MOVE_MEM);
     1316     2958    6                           CALL MODIFYMEM_6('FR      ');
     1317     2959    6                           CALL FETCHD_6('FR      ',PREV_MEM);
     1318     2960    6                           END;
     1319     2961    5                       ELSE
     1320     2962    5                           CALL FETCHPS_6('RC-FR   ');
     1321     2963    5                       END;
     1322     2964    4                   ELSE
     1323     2965    4                       CALL FETCHPS_6('RC-FR   ');
     1324     2966    4                   FIRST_FR = '0'B;
     1325     2967    4                   END;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:43   
     1326     2968
     1327     2969    3               IF FOUND_DIRECT
     1328     2970    4               THEN DO;
     1329     2971    4                   IF UWA.FR.BEIST = 1 THEN
     1330     2972    4                       CALL FETCHNS_6('RC-FR   ');
     1331     2973    5                   DO WHILE UWA.FR.BEIST = 0;
     1332     2974    5                       MOVE_MEM = UWA.DIRECT_REF;
     1333     2975    5                       CALL FINDNS_6('RC-FR   ');
     1334     2976    5                       NEXT_MEM = UWA.DIRECT_REF;
     1335     2977    5                       CALL FINDD_6('FR      ',MOVE_MEM);
     1336     2978    5                       CALL MODIFYMEM_6('FR      ');
     1337     2979    5                       CALL FETCHD_6('FR      ',NEXT_MEM);
     1338     2980    5                       END;
     1339     2981    4                   END;
     1340     2982
     1341     2983    3               DONE = '0'B;
     1342     2984    3               CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);
     1343     2985    4               DO WHILE NOT DONE AND UWA.DB_STATUS ~= '0502100';
     1344     2986    4                   CALL FETCHNS_6('RC-FR   ');
     1345     2987    4                   IF UWA.FR.BEIST ~= 0
     1346     2988    5                   THEN DO;
     1347     2989    5                       UWA.FR.BEIST = 0;
     1348     2990    5                       CALL MODIFY_6('FR      ');
     1349     2991    5                       END;
     1350     2992    4                   ELSE
     1351     2993    4                       DONE = '1'B;
     1352     2994    4                   END;
     1353     2995
     1354     2996    3               END;
     1355     2997    3           ELSE DO;
     1356     2998    3               FOUND_SYN = '0'B;
     1357     2999    3               OWNER_RC = UWA.DIRECT_REF;
     1358     3000    3               CALL FETCHPS_6('RC-FR   ');
     1359     3001    3               MOVE_MEM = UWA.DIRECT_REF;
     1360     3002    3               PREV_MEM = 0;
     1361     3003    3               FIRST_FR = '1'B;
     1362     3004    4               DO WHILE UWA.DB_STATUS ~= '0502100' AND UWA.FR.SYN = 1
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:44   
     1363     3005    4                  AND ( UWA.FR.F_USE = 4 OR UWA.FR.F_USE = 5 )
     1364     3006    4                  AND MOVE_MEM ~= PREV_MEM;
     1365     3007    4                   FOUND_SYN = '1'B;
     1366     3008    4                   IF NOT FIRST_FR
     1367     3009    5                   THEN DO;
     1368     3010    5                       MOVE_MEM = UWA.DIRECT_REF;
     1369     3011    5                       CALL FINDPS_6('RC-FR    ');
     1370     3012    5                       PREV_MEM = UWA.DIRECT_REF;
     1371     3013    5                       CALL FINDD_6('FR      ',MOVE_MEM);
     1372     3014    5                       CALL MODIFYMEM_6('FR      ');
     1373     3015    5                       CALL FETCHD_6('FR      ',PREV_MEM);
     1374     3016    5                       END;
     1375     3017    5                   ELSE DO;
     1376     3018    5                       FIRST_FR = '0'B;
     1377     3019    5                       CALL FETCHPS_6('RC-FR   ');
     1378     3020    5                       END;
     1379     3021    4                   END;
     1380     3022
     1381     3023    3               CALL FINDD_6('RC      ',OWNER_RC);
     1382     3024    3               CALL FETCHNS_6('RC-FR   ');
     1383     3025    3               MOVE_MEM = UWA.DIRECT_REF;
     1384     3026    3               PREV_MEM = 0;
     1385     3027    4               DO WHILE UWA.DB_STATUS ~= '0502100' AND UWA.FR.SYN=1
     1386     3028    4                  AND MOVE_MEM ~= PREV_MEM;
     1387     3029    4                   IF UWA.FR.F_USE = 7
     1388     3030    5                   THEN DO;
     1389     3031    5                       FOUND_SYN = '1'B;
     1390     3032    5                       MOVE_MEM = UWA.DIRECT_REF;
     1391     3033    5                       CALL FINDNS_6('RC-FR   ');
     1392     3034    5                       NEXT_MEM = UWA.DIRECT_REF;
     1393     3035    5                       CALL FINDD_6('FR      ',MOVE_MEM);
     1394     3036    5                       CALL MODIFYMEM_6('FR      ');
     1395     3037    5                       CALL FETCHD_6('FR      ',NEXT_MEM);
     1396     3038    5                       END;
     1397     3039    4                   ELSE
     1398     3040    4                       CALL FETCHNS_6('RC-FR   ');
     1399     3041    4                   END;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:45   
     1400     3042
     1401     3043    3               DONE = '0'B;
     1402     3044    3               CALL FINDD_6('RC      ',OWNER_RC);
     1403     3045    3               CALL FETCHNS_6('RC-FR   ');
     1404     3046    4               DO WHILE NOT DONE AND UWA.DB_STATUS ~= '0502100';
     1405     3047    4                   IF UWA.FR.SYN = 1 AND UWA.FR.F_USE = 3
     1406     3048    5                   THEN DO;
     1407     3049    5                       FOUND_SYN = '1'B;
     1408     3050    5                       DONE = '1'B;
     1409     3051    5                       CALL MODIFYMEM_6('FR      ');
     1410     3052    5                       END;
     1411     3053    5                   ELSE DO;
     1412     3054    5                       IF UWA.FR.SYN = 1 AND ( UWA.FR.F_USE = 4 OR UWA.FR.F_USE = 5 )
              3054                                THEN
     1413     3055    5                           DONE = '1'B;
     1414     3056    5                       ELSE
     1415     3057    5                           CALL FETCHNS_6('RC-FR   ');
     1416     3058    5                       END;
     1417     3059    4                   END;
     1418     3060
     1419     3061    3               CALL FINDD_6('RC      ',OWNER_RC);
     1420     3062    3               CALL FETCHNS_6('RC-FR   ');
     1421     3063    3               IF UWA.DB_STATUS ~= '0502100' AND UWA.FR.SYN = 1 AND UWA.FR.F_USE = 2
     1422     3064    4               THEN DO;
     1423     3065    4                   FOUND_SYN = '1'B;
     1424     3066    4                   CALL MODIFYMEM_6('FR      ');
     1425     3067    4                   END;
     1426     3068
     1427     3069    3               IF FOUND_SYN
     1428     3070    4               THEN DO;
     1429     3071    4                   CALL FINDD_6('RC      ',OWNER_RC);
     1430     3072    4                   CALL FETCHNS_6('RC-FR   ');
     1431     3073    5                   DO WHILE UWA.FR.SYN = 0;
     1432     3074    5                       MOVE_MEM = UWA.DIRECT_REF;
     1433     3075    5                       CALL FINDNS_6('RC-FR   ');
     1434     3076    5                       NEXT_MEM = UWA.DIRECT_REF;
     1435     3077    5                       CALL FINDD_6('FR      ',MOVE_MEM);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:46   
     1436     3078    5                       CALL MODIFYMEM_6('FR      ');
     1437     3079    5                       CALL FETCHD_6('FR      ',NEXT_MEM);
     1438     3080    5                       END;
     1439     3081    4                   END;
     1440     3082    3               END;
     1441     3083
     1442     3084    2           CALL FINDNS_6('OA-RC   ');
     1443     3085    2           END;
     1444     3086        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:47   
     1445     3087        /****************************************************************
     1446     3088        * MAKE SURE THAT RECORDS THAT ARE IN TEMPORARY AREAS ARE NOT    *
     1447     3089        * IN ANY SETS THAT CONTAIN RECORDS THAT AREN'T IN TEMP AREAS    *
     1448     3090        ****************************************************************/
     1449     3091    1       CALL FCURR_R_6('OA      '); /* OA */
     1450     3092    1       CALL FETCHNS_6('OA-AC   '); /* AC */
     1451     3093        /* foa all temporary areas... */
     1452     3094    2       DO WHILE (UWA.DB_STATUS ~= '0502100');
     1453     3095    2           THIS_AC = UWA.DIRECT_REF;
     1454     3096    3           IF UWA.AC.PERMTYPE = 1 THEN DO; /* temp area */
     1455     3097    3               CALL FINDNS_6('AC-RA   '); /* RA */
     1456     3098         /* for all records in that temporary area... */
     1457     3099    4               DO WHILE (UWA.DB_STATUS ~= '0502100');
     1458     3100    4                   THIS_RA = UWA.DIRECT_REF;
     1459     3101    4                   CALL FINDOS_6('RC-RA   '); /* RC */
     1460     3102    4                   CALL FINDNS_6('RC-SOSM '); /* SOSM */
     1461     3103         /* for every set that record is in... */
     1462     3104    5                   DO WHILE (UWA.DB_STATUS ~= '0502100');
     1463     3105    5                       THIS_SOSM = UWA.DIRECT_REF;
     1464     3106    5                       THIS_SOSM_NAME = UWA.RECORD_NAME;
     1465     3107    5                       CALL FINDOS_6('SC-SOSM '); /* SC */
     1466     3108    5                       CALL FINDNS_6('SC-SOSM '); /* SOSM */
     1467     3109         /* look through all other records in the set and make
     1468     3110            sure the areas they're in are also temporary */
     1469     3111    6                       DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (THIS_SOSM ~= UWA.
     1470     3112    6                          DIRECT_REF));
     1471     3113    6                           CALL FINDOS_6('RC-SOSM '); /* RC */
     1472     3114    6                           CALL FINDNS_6('RC-RA   '); /* RA */
     1473     3115    7                           DO WHILE (UWA.DB_STATUS ~= '0502100');
     1474     3116    7                               CALL FETCHOS_6('AC-RA   '); /* AC */
     1475     3117    7                               IF UWA.AC.PERMTYPE ~= 1 THEN
     1476     3118    8                               DO;
     1477     3119    8                                   CALL FETCHD_6('AC      ',THIS_AC);
     1478     3120    8                                   CALL FETCHOS_6('SN-SE   ');
     1479     3121    8                                   CALL ZIG$D_DIAG(UWA.SN.LNO,%ERR_SEV,4666);
     1480     3122        /*E*  ERROR:  ZIG-4666-C
     1481     3123            MESSAGE:  Records in temporary areas cannot participate as owners
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:48   
     1482     3124                      or members of sets that contain records that are not in
     1483     3125                      temporary areas.
     1484     3126        */
     1485     3127    8                                   END;
     1486     3128    7                               CALL FINDNS_6('RC-RA   '); /* RA */
     1487     3129    7                               END;
     1488     3130    6                           CALL FINDNS_6('SC-SOSM '); /* SOSM */
     1489     3131    6                           END;
     1490     3132    5                       CALL FINDD_6(THIS_SOSM_NAME,THIS_SOSM); /* last SOSM */
     1491     3133    5                       CALL FINDNS_6('RC-SOSM '); /* next SOSM */
     1492     3134    5                       END;
     1493     3135    4                   CALL FINDD_6('RA      ',THIS_RA); /* last RA */
     1494     3136    4                   CALL FINDNS_6('AC-RA   '); /* next RA */
     1495     3137    4                   END;
     1496     3138    3               END; /* IF */
     1497     3139    2           CALL FINDD_6('AC      ',THIS_AC); /* last AC */
     1498     3140    2           CALL FETCHNS_6('OA-AC   '); /* next AC */
     1499     3141    2           END;
     1500     3142        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:49   
     1501     3143        /********************************
     1502     3144        * Update DA, OA               *
     1503     3145        ********************************/
     1504     3146    1       CALL FCURR_R_6('DA      ');
     1505     3147    1       CALL MODIFY_6('DA      ');
     1506     3148    1       CALL FCURR_R_6('OA      ');
     1507     3149    1       CALL MODIFY_6('OA      ');
     1508     3150    1       RETURN;
     1509     3151    1   END ZIG$D_PAS2;
     1510     3152        %EOD;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:50   
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DDL_INCL.:ZIC0TOU  is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$D_PAS2.

   Procedure ZIG$D_PAS2 requires 3855 words for executable code.
   Procedure ZIG$D_PAS2 requires 92 words of local(AUTO) storage.

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:51   

 Object Unit name= ZIG$D_PAS2                                 File name= ZIG$D_PAS2.:ZIC0TOU
 UTS= SEP 05 '97 11:59:33.28 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none    12     14  ANALS
    1  LblCom even  none    13     15  PURGE
    2  LblCom even  none    19     23  DICTS
    3  LblCom even  none    23     27  DISPS
    4  LblCom even  none    22     26  VALIDS
    5  LblCom even  none    12     14  LOCKS
    6  LblCom even  none    10     12  STRAN
    7  LblCom even  none    12     14  DTRAN
    8  LblCom even  none    16     20  SSTRANS
    9  LblCom even  none    20     24  SSGEN
   10  LblCom even  none     1      1  NUMB_RECORD_SN
   11  LblCom even  none     1      1  NUMB_FIELD_SN
   12  LblCom even  none     1      1  NUMB_SET_SN
   13  LblCom even  none     1      1  RECORD$
   14  LblCom even  none     1      1  FIELD$
   15  LblCom even  none     1      1  SET$
   16  LblCom even  none     1      1  DYNMEM_START$
   17   Data  even  none    13     15  ZIG$D_PAS2
   18  LblCom even  none     1      1  DBK_STAR_DBPARAM_RC
   19  LblCom even  none     1      1  DBK_SO_CALC
   20  LblCom even  none     1      1  LAST_DEF_SET_DBK
   21  LblCom even  none     1      1  LAST_DEF_REC_DBK
   22  LblCom even  none     8     10  FIELD1
   23  LblCom even  none     1      1  NUM_ERROR_MSG
   24  LblCom even  none     1      1  NUM_WARN_MSG
   25  LblCom even  none     1      1  ALLOCATE_END
   26  LblCom even  none     2      2  SUBSCHEMA_KEY
   27  LblCom even  none     1      1  BUFFER$
   28  LblCom even  none     1      1  ERROR_IO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:52   
   29  LblCom even  none     1      1  BUFFER_LEN
   30  LblCom even  none     2      2  UWA_KEY
   31  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   32  LblCom even  none     2      2  RVA_KEY
   33  LblCom even  none     2      2  IA__KEY
   34  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   35  LblCom even  none    32     40  SEARCHR_NB
   36  LblCom even  none    32     40  SEM_COM
   37  LblCom even  none    32     40  DMCL_XLATE
   38  LblCom even  none    32     40  Q2_PERCENT
   39  LblCom even  none   656   1220  UWA
   40  RoData even  UTS     59     73  ZIG$D_PAS2
   41   Proc  even  none  3855   7417  ZIG$D_PAS2
   42  RoData even  none   145    221  ZIG$D_PAS2

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    41      0   yes    yes     yes      Std        0  ZIG$D_PAS2
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:53   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 FINDD_6
 yes     yes           Std       1 FINDPS_6
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHOS_6
         yes           Std       8 ADD_SN
 yes     yes           Std       1 ERASE_6
 yes     yes           Std       1 MODIFYMEM_6
         yes           Std       3 SET_FIELDS
 yes     yes           Std       1 STRE_6
         yes           Std       3 ZIG$D_DIAG
 yes     yes           Std       1 FETCHNS_6
 yes     yes           Std       1 FINDNS_6
 yes     yes           Std       1 FCURR_R_6
 yes     yes           Std       1 FETCHPS_6
 yes     yes           Std       1 CONNECT_6
 yes     yes           Std       1 FINDOS_6
 yes     yes           Std       1 MODIFY_6
         yes           Std       4 MOVE_TO_FIRST_POS
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:54   


        1        1        /*M*     ZIG$D_PAS2    DDL TRANSLATE PASS 2 I-D-S/II  DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$D_PAS2
        9        9        PURPOSE: This subroutins is called by ZIG$D_EXEC to handle all that
       10       10                 couldn't be done in pass 1 (ZIG$D_PSET).
       11       11                 1) Unsatisfied forward references to sets
       12       12                 2) Make sure LOC MODE VIA set records are members of the set
       13       13                 3) Set selection
       14       14                 4) WITHIN ANY AREA [EXCEPT areaname1,...] in record entry
       15       15                 5) LOC MODE DIRECT
       16       16                 6) Make sure that records in TEMPORARY AREAS aren't in
       17       17                    sets that contain records not in TEMPORARY AREAS.
       18       18        */
       19       19        ZIG$D_PAS2: PROC ALTRET;

     19 41 000000   000000 700200 xent  ZIG$D_PAS2   TSX0  ! X66_AUTO_0
        41 000001   000134 000000                    ZERO    92,0

       20       20
       21       21        %EQU DS5 = 4; /* data segment of dynamic memory */
       22       22    1   DCL I UBIN WORD;
       23       23    1   DCL ANY_LNO UBIN WORD;
       24       24    1   DCL CT1 UBIN (36);
       25       25    1   DCL CT2 UBIN (36);
       26       26    1   DCL CT3 UBIN (36);
       27       27        /*******************
       28       28        * Temporary holder *
       29       29        * for a dbk        *
       30       30        *******************/
       31       31    1   DCL HOLD_DBK UBIN WORD;
       32       32        /*********************
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:55   
       33       33        * saved DBKEYS       *
       34       34        *********************/
       35       35    1   DCL DBK UBIN WORD;
       36       36    1   DCL DBK_SM_CALC UBIN WORD;
       37       37    1   DCL DBK_SCANSS UBIN WORD;
       38       38    1   DCL DBK_CALCSS UBIN WORD;
       39       39    1   DCL FIRST_DBK_RFR_CALC UBIN WORD;
       40       40    1   DCL DBK_RFR_CALC UBIN WORD;
       41       41    1   DCL DBK_CALC_CF UBIN WORD;
       42       42    1   DCL DBK_LAST_SM UBIN WORD;
       43       43    1   DCL DBK_SFR UBIN WORD;
       44       44    1   DCL DBK_RFR UBIN WORD;
       45       45    1   DCL DBK_SN UBIN WORD;
       46       46    1   DCL THIS_SC UBIN WORD;
       47       47    1   DCL THIS_SM UBIN WORD;
       48       48    1   DCL THIS_SM_RC UBIN WORD;
       49       49    1   DCL THIS_SN UBIN WORD;
       50       50    1   DCL THIS_SN_SC UBIN WORD;
       51       51    1   DCL THIS_SN_SO UBIN WORD;
       52       52    1   DCL THIS_SN_SO_RC UBIN WORD;
       53       53    1   DCL THIS_RC UBIN WORD;
       54       54    1   DCL THIS_RC_SN UBIN WORD;
       55       55        /****************************
       56       56        * needed for LOC DIRECT     *
       57       57        ****************************/
       58       58    1   DCL FR_NAME CHAR(30);
       59       59    1   DCL QRC_DBK UBIN WORD;
       60       60    1   DCL QRC_NAME CHAR(30);
       61       61        /**************************
       62       62        * needed for THEN THRU    *
       63       63        **************************/
       64       64    1   DCL PREV_THRU_SN UBIN WORD;
       65       65    1   DCL PREV_THRU_SN_SC UBIN WORD;
       66       66    1   DCL DBK_WHER_FR UBIN WORD;
       67       67    1   DCL FIRST_WHERE BIT(1);
       68       68    1   DCL NUM_CTRL_FLDS UBIN WORD;
       69       69        /**************************
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:56   
       70       70        * for comparing calckeys  *
       71       71        **************************/
       72       72    1   DCL 1 FR ALIGNED,
       73       73    1         2 FTYPE SBIN (36) ALIGNED,
       74       74    1         2 PREC SBIN (36) ALIGNED,
       75       75    1         2 SCALE SBIN (36) ALIGNED,
       76       76    1         2 F_SIGN SBIN (36) ALIGNED;
       77       77    1   DCL NUM_EQ_CALCKEYS UBIN WORD;
       78       78    1   DCL FOUND_IT BIT(1);
       79       79        /********************
       80       80        * For adjusting the *
       81       81        * RC-FR sets        *
       82       82        ********************/
       83       83    1   DCL DONE BIT(1);
       84       84    1   DCL FIRST_FR BIT(1);
       85       85    1   DCL FOUND_DIRECT BIT(1);
       86       86    1   DCL FOUND_SYN BIT(1);
       87       87    1   DCL MOVE_MEM UBIN WORD;
       88       88    1   DCL NEXT_MEM UBIN WORD;
       89       89    1   DCL OWNER_RC UBIN WORD;
       90       90    1   DCL PREV_MEM UBIN WORD;
       91       91        /******************************
       92       92        * for temp area rec checking  *
       93       93        ******************************/
       94       94    1   DCL THIS_AC UBIN WORD;
       95       95    1   DCL THIS_RA UBIN WORD;
       96       96    1   DCL THIS_SOSM UBIN WORD;
       97       97    1   DCL THIS_SOSM_NAME CHAR(30);
       98       98        %EQU WARN_SEV = 1;
       99       99        %EQU ERR_SEV = 2;
      100      100    1   DCL FLAG_ERR BIT(1);
      101      101    1   DCL FIRST_TIME BIT(1);
      102      102    1   DCL ZIG$D_DIAG ENTRY(3);
      103      103    1   DCL ADD_SN ENTRY(8);
      104      104    1   DCL MOVE_TO_FIRST_POS ENTRY(4);
      105      105    1   DCL ZIG$FREE ENTRY(2) ALTRET;
      106      106        %INCLUDE ZIG_DIR_STRUCS;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:57   
      107      236        %INCLUDE ZIG_DDL_INCL;
      108      498         %DDL_XLATE;
      109      593        %INCLUDE ZIG_GENERAL;
      110      701        %INCLUDE ZIG_TYPE_SUBS;
      111      716        %INCLUDE ZI_SUB4_CAN;
      112     1373         %UWA;
      113     1708        %INCLUDE ZIG_DBA_INT;
      114     1756        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:58   
      115     1757        /*
      116     1758
      117     1759
      118     1760        */
      119     1761
      120     1762    1       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);

   1762 41 000002   000001 630400 42                 EPPR0   1
        41 000003   000000 631400 42                 EPPR1   0
        41 000004   000000 701000 xent               TSX1    FINDD_6
        41 000005   000000 011000                    NOP     0

      121     1763    1       CALL FINDPS_6('OA-SC   ');

   1763 41 000006   000004 630400 42                 EPPR0   4
        41 000007   000003 631400 42                 EPPR1   3
        41 000010   000000 701000 xent               TSX1    FINDPS_6
        41 000011   000000 011000                    NOP     0

      122     1764    1       CALL FINDPS_6('OA-SC   ');

   1764 41 000012   000004 630400 42                 EPPR0   4
        41 000013   000003 631400 42                 EPPR1   3
        41 000014   000000 701000 xent               TSX1    FINDPS_6
        41 000015   000000 011000                    NOP     0

      123     1765    1       MOVE_MEM = UWA.DIRECT_REF;

   1765 41 000016   000036 235000 39                 LDA     UWA+30
        41 000017   200075 755100                    STA     MOVE_MEM,,AUTO

      124     1766    1       PREV_MEM = 0;

   1766 41 000020   200100 450100                    STZ     PREV_MEM,,AUTO

      125     1767    2       DO WHILE UWA.DB_STATUS ~= '0502100' AND MOVE_MEM ~= PREV_MEM;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:59   
   1767 41 000021   000056 710000 41                 TRA     s:1774

      126     1768    2           MOVE_MEM = UWA.DIRECT_REF;

   1768 41 000022   000036 235000 39                 LDA     UWA+30
        41 000023   200075 755100                    STA     MOVE_MEM,,AUTO

      127     1769    2           CALL FINDPS_6('OA-SC   ');

   1769 41 000024   000004 630400 42                 EPPR0   4
        41 000025   000003 631400 42                 EPPR1   3
        41 000026   000000 701000 xent               TSX1    FINDPS_6
        41 000027   000000 011000                    NOP     0

      128     1770    2           PREV_MEM = UWA.DIRECT_REF;

   1770 41 000030   000036 235000 39                 LDA     UWA+30
        41 000031   200100 755100                    STA     PREV_MEM,,AUTO

      129     1771    2           CALL FINDD_6('SC      ',MOVE_MEM);

   1771 41 000032   200075 630500                    EPPR0   MOVE_MEM,,AUTO
        41 000033   200123 450500                    STP0    LNO+3,,AUTO
        41 000034   000005 236000 42                 LDQ     5
        41 000035   200122 756100                    STQ     LNO+2,,AUTO
        41 000036   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000037   000000 631400 42                 EPPR1   0
        41 000040   000000 701000 xent               TSX1    FINDD_6
        41 000041   000000 011000                    NOP     0

      130     1772    2           CALL MODIFYMEM_6('SC      ');

   1772 41 000042   000005 630400 42                 EPPR0   5
        41 000043   000003 631400 42                 EPPR1   3
        41 000044   000000 701000 xent               TSX1    MODIFYMEM_6
        41 000045   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:60   
      131     1773    2           CALL FINDD_6('SC      ',PREV_MEM);

   1773 41 000046   200100 630500                    EPPR0   PREV_MEM,,AUTO
        41 000047   200123 450500                    STP0    LNO+3,,AUTO
        41 000050   000005 236000 42                 LDQ     5
        41 000051   200122 756100                    STQ     LNO+2,,AUTO
        41 000052   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000053   000000 631400 42                 EPPR1   0
        41 000054   000000 701000 xent               TSX1    FINDD_6
        41 000055   000000 011000                    NOP     0

      132     1774    2           END;

   1774 41 000056   040000 106400                    CMPC    fill='040'O
        41 000057   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 000060   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 000061   000065 600000 41                 TZE     s:1776
        41 000062   200075 236100                    LDQ     MOVE_MEM,,AUTO
        41 000063   200100 116100                    CMPQ    PREV_MEM,,AUTO
        41 000064   000022 601000 41                 TNZ     s:1768

      133     1775
      134     1776    1       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);

   1776 41 000065   000001 630400 42                 EPPR0   1
        41 000066   000000 631400 42                 EPPR1   0
        41 000067   000000 701000 xent               TSX1    FINDD_6
        41 000070   000000 011000                    NOP     0

      135     1777    1       CALL FINDPS_6('OA-RC   ');

   1777 41 000071   000006 630400 42                 EPPR0   6
        41 000072   000003 631400 42                 EPPR1   3
        41 000073   000000 701000 xent               TSX1    FINDPS_6
        41 000074   000000 011000                    NOP     0

      136     1778    1       CALL FINDPS_6('OA-RC   ');
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:61   

   1778 41 000075   000006 630400 42                 EPPR0   6
        41 000076   000003 631400 42                 EPPR1   3
        41 000077   000000 701000 xent               TSX1    FINDPS_6
        41 000100   000000 011000                    NOP     0

      137     1779    1       MOVE_MEM = UWA.DIRECT_REF;

   1779 41 000101   000036 235000 39                 LDA     UWA+30
        41 000102   200075 755100                    STA     MOVE_MEM,,AUTO

      138     1780    1       PREV_MEM = 0;

   1780 41 000103   200100 450100                    STZ     PREV_MEM,,AUTO

      139     1781    2       DO WHILE UWA.DB_STATUS ~= '0502100' AND MOVE_MEM ~= PREV_MEM;

   1781 41 000104   000141 710000 41                 TRA     s:1788

      140     1782    2           MOVE_MEM = UWA.DIRECT_REF;

   1782 41 000105   000036 235000 39                 LDA     UWA+30
        41 000106   200075 755100                    STA     MOVE_MEM,,AUTO

      141     1783    2           CALL FINDPS_6('OA-RC   ');

   1783 41 000107   000006 630400 42                 EPPR0   6
        41 000110   000003 631400 42                 EPPR1   3
        41 000111   000000 701000 xent               TSX1    FINDPS_6
        41 000112   000000 011000                    NOP     0

      142     1784    2           PREV_MEM = UWA.DIRECT_REF;

   1784 41 000113   000036 235000 39                 LDA     UWA+30
        41 000114   200100 755100                    STA     PREV_MEM,,AUTO

      143     1785    2           CALL FINDD_6('RC      ',MOVE_MEM);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:62   

   1785 41 000115   200075 630500                    EPPR0   MOVE_MEM,,AUTO
        41 000116   200123 450500                    STP0    LNO+3,,AUTO
        41 000117   000007 236000 42                 LDQ     7
        41 000120   200122 756100                    STQ     LNO+2,,AUTO
        41 000121   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000122   000000 631400 42                 EPPR1   0
        41 000123   000000 701000 xent               TSX1    FINDD_6
        41 000124   000000 011000                    NOP     0

      144     1786    2           CALL MODIFYMEM_6('RC      ');

   1786 41 000125   000007 630400 42                 EPPR0   7
        41 000126   000003 631400 42                 EPPR1   3
        41 000127   000000 701000 xent               TSX1    MODIFYMEM_6
        41 000130   000000 011000                    NOP     0

      145     1787    2           CALL FINDD_6('RC      ',PREV_MEM);

   1787 41 000131   200100 630500                    EPPR0   PREV_MEM,,AUTO
        41 000132   200123 450500                    STP0    LNO+3,,AUTO
        41 000133   000007 236000 42                 LDQ     7
        41 000134   200122 756100                    STQ     LNO+2,,AUTO
        41 000135   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000136   000000 631400 42                 EPPR1   0
        41 000137   000000 701000 xent               TSX1    FINDD_6
        41 000140   000000 011000                    NOP     0

      146     1788    2           END;

   1788 41 000141   040000 106400                    CMPC    fill='040'O
        41 000142   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 000143   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 000144   000150 600000 41                 TZE     s:1795
        41 000145   200075 236100                    LDQ     MOVE_MEM,,AUTO
        41 000146   200100 116100                    CMPQ    PREV_MEM,,AUTO
        41 000147   000105 601000 41                 TNZ     s:1782
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:63   

      147     1789
      148     1790        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:64   
      149     1791        /***********************************************************
      150     1792          Now look through all the SNs for any unsatisfied forward
      151     1793          references to sets.
      152     1794        ***********************************************************/
      153     1795    2       DO I = 0 TO NUMB_SET_SN-1;

   1795 41 000150   200003 450100                    STZ     I,,AUTO
        41 000151   000300 710000 41                 TRA     s:1819+3

      154     1796    2           IF SET$->TABLES.DEFINED(I) = '0'B AND

   1796 41 000152   200003 236100                    LDQ     I,,AUTO
        41 000153   000011 402007                    MPY     9,DL
        41 000154   000000 470400 15                 LDP0    SET$
        41 000155   000010 234106                    SZN     8,QL,PR0
        41 000156   000275 604000 41                 TMI     s:1819
        41 000157   000000 236106                    LDQ     0,QL,PR0
        41 000160   777000 376003                    ANQ     -512,DU
        41 000161   052000 116003                    CMPQ    21504,DU
        41 000162   000275 600000 41                 TZE     s:1819

      155     1797    3              SUBSTR(SET$->TABLES.NAME(I),0,1) ~= '*' THEN DO;

      156     1798    3               DBK = SET$->TABLES.DBK(I);

   1798 41 000163   200003 236100                    LDQ     I,,AUTO
        41 000164   000011 402007                    MPY     9,DL
        41 000165   000007 236106                    LDQ     7,QL,PR0
        41 000166   777777 376007                    ANQ     -1,DL
        41 000167   200011 756100                    STQ     DBK,,AUTO

      157     1799    3               CALL FETCHD_6('SN      ',DBK);

   1799 41 000170   200011 631500                    EPPR1   DBK,,AUTO
        41 000171   200123 451500                    STP1    LNO+3,,AUTO
        41 000172   000010 236000 42                 LDQ     8
        41 000173   200122 756100                    STQ     LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:65   
        41 000174   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000175   000000 631400 42                 EPPR1   0
        41 000176   000000 701000 xent               TSX1    FETCHD_6
        41 000177   000000 011000                    NOP     0

      158     1800    3               CALL INDEX(CT1,' ',SET$->TABLES.NAME(I));

   1800 41 000200   200003 236100                    LDQ     I,,AUTO
        41 000201   000044 402007                    MPY     36,DL
        41 000202   000000 470400 15                 LDP0    SET$
        41 000203   000000 124506                    SCM     mask='000'O
        41 000204   000000 000036                    ADSC9   0,Q,PR0                  cn=0,n=30
        41 000205   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 000206   200005 000100                    ARG     CT1,,AUTO

      159     1801    3               CALL SET_FIELDS(1,CT1,SET$->TABLES.NAME(I));

   1801 41 000207   200003 236100                    LDQ     I,,AUTO
        41 000210   000011 402003                    MPY     9,DU
        41 000211   000000 036000 15                 ADLQ    SET$
        41 000212   200124 756100                    STQ     LNO+4,,AUTO
        41 000213   200005 631500                    EPPR1   CT1,,AUTO
        41 000214   200123 451500                    STP1    LNO+3,,AUTO
        41 000215   000014 236000 42                 LDQ     12
        41 000216   200122 756100                    STQ     LNO+2,,AUTO
        41 000217   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000220   000012 631400 42                 EPPR1   10
        41 000221   000000 701000 xent               TSX1    SET_FIELDS
        41 000222   000000 011000                    NOP     0

      160     1802    3               LNO = UWA.SN.LNO - 1;

   1802 41 000223   000425 235000 39                 LDA     UWA+277
        41 000224   000001 135007                    SBLA    1,DL
        41 000225   200120 755100                    STA     LNO,,AUTO

      161     1803    3               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4217);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:66   

   1803 41 000226   000017 236000 42                 LDQ     15
        41 000227   200124 756100                    STQ     LNO+4,,AUTO
        41 000230   000020 236000 42                 LDQ     16
        41 000231   200123 756100                    STQ     LNO+3,,AUTO
        41 000232   200120 630500                    EPPR0   LNO,,AUTO
        41 000233   200122 450500                    STP0    LNO+2,,AUTO
        41 000234   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000235   000012 631400 42                 EPPR1   10
        41 000236   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 000237   000000 011000                    NOP     0

      162     1804        /*E*  ERROR:  ZIG-4217-C
      163     1805            MESSAGE:  The set name "%U1" is not in the schema dictionary.
      164     1806        */
      165     1807    3               CALL FETCHNS_6('SN-NRWU '); /* NR */

   1807 41 000240   000021 630400 42                 EPPR0   17
        41 000241   000003 631400 42                 EPPR1   3
        41 000242   000000 701000 xent               TSX1    FETCHNS_6
        41 000243   000000 011000                    NOP     0

      166     1808    4               DO WHILE (UWA.DB_STATUS ~= '0502100'); /* go thru entire SN-NRWU */

   1808 41 000244   040000 106400                    CMPC    fill='040'O
        41 000245   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 000246   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 000247   000275 600000 41                 TZE     s:1819

      167     1809    5                   IF UWA.NR.RELTYPE = RELTYPE.LOC THEN DO; /* was used in VIA SET */

   1809 41 000250   000470 236000 39                 LDQ     UWA+312
        41 000251   000006 116000 17                 CMPQ    RELTYPE+3
        41 000252   000265 601000 41                 TNZ     s:1816

      168     1810    5                       CALL ZIG$D_DIAG(LNO,%ERR_SEV,4805);

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:67   
   1810 41 000253   000023 236000 42                 LDQ     19
        41 000254   200124 756100                    STQ     LNO+4,,AUTO
        41 000255   000020 236000 42                 LDQ     16
        41 000256   200123 756100                    STQ     LNO+3,,AUTO
        41 000257   200120 630500                    EPPR0   LNO,,AUTO
        41 000260   200122 450500                    STP0    LNO+2,,AUTO
        41 000261   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000262   000012 631400 42                 EPPR1   10
        41 000263   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 000264   000000 011000                    NOP     0

      169     1811        /*E* ERROR:  ZIG-4805-C
      170     1812           MESSAGE:  The LOCATION MODE clause is invalid because the set
      171     1813                     "%U1" has not been declared.
      172     1814        */
      173     1815    5                       END;

      174     1816    4                   CALL FETCHNS_6('SN-NRWU '); /* NR */

   1816 41 000265   000021 630400 42                 EPPR0   17
        41 000266   000003 631400 42                 EPPR1   3
        41 000267   000000 701000 xent               TSX1    FETCHNS_6
        41 000270   000000 011000                    NOP     0

      175     1817    4                   END;

   1817 41 000271   040000 106400                    CMPC    fill='040'O
        41 000272   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 000273   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 000274   000250 601000 41                 TNZ     s:1809

      176     1818    3               END;

      177     1819    2           END;

   1819 41 000275   200003 235100                    LDA     I,,AUTO
        41 000276   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:68   
        41 000277   200003 755100                    STA     I,,AUTO
        41 000300   200003 236100                    LDQ     I,,AUTO
        41 000301   000000 116000 12                 CMPQ    NUMB_SET_SN
        41 000302   000152 602000 41                 TNC     s:1796

      178     1820        /**************************************************************
      179     1821         Check to make sure that all record with LOC MODE VIA setname
      180     1822         are indeed members in the name set.
      181     1823        **************************************************************/
      182     1824    2       DO I = 0 TO NUMB_RECORD_SN - 1;

   1824 41 000303   200003 450100                    STZ     I,,AUTO
        41 000304   000423 710000 41                 TRA     s:1843+3

      183     1825         /* if this record is LOC MODE VIA setname but was never declared
      184     1826            as a member of the set... */
      185     1827    3           IF RECORD$->TABLES.DBK_RC(I) ~= 0 THEN DO;

   1827 41 000305   200003 236100                    LDQ     I,,AUTO
        41 000306   000011 402007                    MPY     9,DL
        41 000307   000000 470400 13                 LDP0    RECORD$
        41 000310   000010 720106                    LXL0    8,QL,PR0
        41 000311   000420 600000 41                 TZE     s:1843

      186     1828    3               DBK = RECORD$->TABLES.DBK(I);

   1828 41 000312   000007 236106                    LDQ     7,QL,PR0
        41 000313   777777 376007                    ANQ     -1,DL
        41 000314   200011 756100                    STQ     DBK,,AUTO

      187     1829    3               CALL FETCHD_6('SN      ',DBK); /* SN */

   1829 41 000315   200011 631500                    EPPR1   DBK,,AUTO
        41 000316   200123 451500                    STP1    LNO+3,,AUTO
        41 000317   000010 236000 42                 LDQ     8
        41 000320   200122 756100                    STQ     LNO+2,,AUTO
        41 000321   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:69   
        41 000322   000000 631400 42                 EPPR1   0
        41 000323   000000 701000 xent               TSX1    FETCHD_6
        41 000324   000000 011000                    NOP     0

      188     1830    3               CALL INDEX(CT1,' ',RECORD$->TABLES.NAME(I));

   1830 41 000325   200003 236100                    LDQ     I,,AUTO
        41 000326   000044 402007                    MPY     36,DL
        41 000327   000000 470400 13                 LDP0    RECORD$
        41 000330   000000 124506                    SCM     mask='000'O
        41 000331   000000 000036                    ADSC9   0,Q,PR0                  cn=0,n=30
        41 000332   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 000333   200005 000100                    ARG     CT1,,AUTO

      189     1831    3               CALL SET_FIELDS(1,CT1,RECORD$->TABLES.NAME(I));

   1831 41 000334   200003 236100                    LDQ     I,,AUTO
        41 000335   000011 402003                    MPY     9,DU
        41 000336   000000 036000 13                 ADLQ    RECORD$
        41 000337   200124 756100                    STQ     LNO+4,,AUTO
        41 000340   200005 631500                    EPPR1   CT1,,AUTO
        41 000341   200123 451500                    STP1    LNO+3,,AUTO
        41 000342   000014 236000 42                 LDQ     12
        41 000343   200122 756100                    STQ     LNO+2,,AUTO
        41 000344   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000345   000012 631400 42                 EPPR1   10
        41 000346   000000 701000 xent               TSX1    SET_FIELDS
        41 000347   000000 011000                    NOP     0

      190     1832    3               LNO = UWA.SN.LNO;

   1832 41 000350   000425 235000 39                 LDA     UWA+277
        41 000351   200120 755100                    STA     LNO,,AUTO

      191     1833    3               DBK = RECORD$->TABLES.DBK_RC(I);

   1833 41 000352   200003 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:70   
        41 000353   000011 402007                    MPY     9,DL
        41 000354   000000 470400 13                 LDP0    RECORD$
        41 000355   000010 236106                    LDQ     8,QL,PR0
        41 000356   777777 376007                    ANQ     -1,DL
        41 000357   200011 756100                    STQ     DBK,,AUTO

      192     1834    3               CALL FETCHD_6('SN      ',DBK); /* SN */

   1834 41 000360   200011 631500                    EPPR1   DBK,,AUTO
        41 000361   200123 451500                    STP1    LNO+3,,AUTO
        41 000362   000010 236000 42                 LDQ     8
        41 000363   200122 756100                    STQ     LNO+2,,AUTO
        41 000364   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000365   000000 631400 42                 EPPR1   0
        41 000366   000000 701000 xent               TSX1    FETCHD_6
        41 000367   000000 011000                    NOP     0

      193     1835    3               CALL INDEX(CT2,' ',UWA.SN.SENAME);

   1835 41 000370   000000 124400                    SCM     mask='000'O
        41 000371   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 000372   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 000373   200006 000100                    ARG     CT2,,AUTO

      194     1836    3               CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);

   1836 41 000374   000024 236000 42                 LDQ     20
        41 000375   200124 756100                    STQ     LNO+4,,AUTO
        41 000376   200006 630500                    EPPR0   CT2,,AUTO
        41 000377   200123 450500                    STP0    LNO+3,,AUTO
        41 000400   000020 236000 42                 LDQ     16
        41 000401   200122 756100                    STQ     LNO+2,,AUTO
        41 000402   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000403   000012 631400 42                 EPPR1   10
        41 000404   000000 701000 xent               TSX1    SET_FIELDS
        41 000405   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:71   
      195     1837    3               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4962);

   1837 41 000406   000026 236000 42                 LDQ     22
        41 000407   200124 756100                    STQ     LNO+4,,AUTO
        41 000410   000020 236000 42                 LDQ     16
        41 000411   200123 756100                    STQ     LNO+3,,AUTO
        41 000412   200120 630500                    EPPR0   LNO,,AUTO
        41 000413   200122 450500                    STP0    LNO+2,,AUTO
        41 000414   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000415   000012 631400 42                 EPPR1   10
        41 000416   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 000417   000000 011000                    NOP     0

      196     1838        /*E* ERROR:  ZIG-4962-C
      197     1839           MESSAGE:  The LOCATION MODE clause is invalid because the "%U1" record
      198     1840                     is not a member of the "%U2" set.
      199     1841        */
      200     1842    3               END;

      201     1843    2           END;

   1843 41 000420   200003 235100                    LDA     I,,AUTO
        41 000421   000001 035007                    ADLA    1,DL
        41 000422   200003 755100                    STA     I,,AUTO
        41 000423   200003 236100                    LDQ     I,,AUTO
        41 000424   000000 116000 10                 CMPQ    NUMB_RECORD_SN
        41 000425   000305 602000 41                 TNC     s:1827

      202     1844        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:72   
      203     1845        /*****************************************************************/
      204     1846        /* Do SET SELECTION and WITHIN ANY AREA [EXCEPT...] clauses.
      205     1847           The following characters signify different types of statements:
      206     1848           10- beginning of SET SELECTION phrase
      207     1849           1 - owner identified by application
      208     1850           2 - owner identified by calckey equal to ...
      209     1851           3 - owner identified by calckey
      210     1852           4 - owner identified by dbkey equal to
      211     1853           5 - owner identified by dbkey
      212     1854           6 - owner identified by member ...
      213     1855           20- beginning of THEN THRU clause
      214     1856           30- beginning of OWNER IDENTIFIED BY in THEN THRU
      215     1857           40- beginning of EQUAL TO phrase
      216     1858           45- end of this MEMBER entry
      217     1859           50- beginning of WITHIN ANY AREA [EXCEPT...] clause
      218     1860           60- EXCEPT areanames
      219     1861           70- LOC MODE DIRECT
      220     1862           75- qualified LOC MODE DIRECT
      221     1863          100- end of all set selection clauses and within clauses
      222     1864        */
      223     1865        /*****************************************************************/
      224     1866    1       DYNMEM$ = PINCRW(DYNMEM_START$,1);

   1866 41 000426   000000 236000 16                 LDQ     DYNMEM_START$
        41 000427   000001 036003                    ADLQ    1,DU
        41 000430   200116 756100                    STQ     DYNMEM$,,AUTO

      225     1867    2       DO WHILE (DYNMEM$->WRD1 ~= %ALL_DONE);

   1867 41 000431   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 000432   000000 235100                    LDA     0,,PR0
        41 000433   000144 115007                    CMPA    100,DL
        41 000434   006312 600000 41                 TZE     s:2937

      226     1868    3           DO CASE(DYNMEM$->WRD1);

   1868 41 000435   200116 470500                    LDP0    DYNMEM$,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:73   
        41 000436   000000 235100                    LDA     0,,PR0
        41 000437   000107 115007                    CMPA    71,DL
        41 000440   000442 602005 41                 TNC     s:1868+5,AL
        41 000441   006306 710000 41                 TRA     s:2929
        41 000442   006306 710000 41                 TRA     s:2929
        41 000443   000667 710000 41                 TRA     s:1897
        41 000444   000673 710000 41                 TRA     s:1921
        41 000445   002134 710000 41                 TRA     s:2171
        41 000446   002507 710000 41                 TRA     s:2243
        41 000447   003263 710000 41                 TRA     s:2374
        41 000450   003523 710000 41                 TRA     s:2429
        41 000451   006306 710000 41                 TRA     s:2929
        41 000452   006306 710000 41                 TRA     s:2929
        41 000453   006306 710000 41                 TRA     s:2929
        41 000454   000551 710000 41                 TRA     s:1870
        41 000455   006306 710000 41                 TRA     s:2929
        41 000456   006306 710000 41                 TRA     s:2929
        41 000457   006306 710000 41                 TRA     s:2929
        41 000460   006306 710000 41                 TRA     s:2929
        41 000461   006306 710000 41                 TRA     s:2929
        41 000462   006306 710000 41                 TRA     s:2929
        41 000463   006306 710000 41                 TRA     s:2929
        41 000464   006306 710000 41                 TRA     s:2929
        41 000465   006306 710000 41                 TRA     s:2929
        41 000466   003741 710000 41                 TRA     s:2476
        41 000467   006306 710000 41                 TRA     s:2929
        41 000470   006306 710000 41                 TRA     s:2929
        41 000471   006306 710000 41                 TRA     s:2929
        41 000472   006306 710000 41                 TRA     s:2929
        41 000473   006306 710000 41                 TRA     s:2929
        41 000474   006306 710000 41                 TRA     s:2929
        41 000475   006306 710000 41                 TRA     s:2929
        41 000476   006306 710000 41                 TRA     s:2929
        41 000477   006306 710000 41                 TRA     s:2929
        41 000500   004245 710000 41                 TRA     s:2550
        41 000501   006306 710000 41                 TRA     s:2929
        41 000502   006306 710000 41                 TRA     s:2929
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:74   
        41 000503   006306 710000 41                 TRA     s:2929
        41 000504   006306 710000 41                 TRA     s:2929
        41 000505   006306 710000 41                 TRA     s:2929
        41 000506   006306 710000 41                 TRA     s:2929
        41 000507   006306 710000 41                 TRA     s:2929
        41 000510   006306 710000 41                 TRA     s:2929
        41 000511   006306 710000 41                 TRA     s:2929
        41 000512   006306 710000 41                 TRA     s:2929
        41 000513   006306 710000 41                 TRA     s:2929
        41 000514   006306 710000 41                 TRA     s:2929
        41 000515   006306 710000 41                 TRA     s:2929
        41 000516   006306 710000 41                 TRA     s:2929
        41 000517   005326 710000 41                 TRA     s:2735
        41 000520   006306 710000 41                 TRA     s:2929
        41 000521   006306 710000 41                 TRA     s:2929
        41 000522   006306 710000 41                 TRA     s:2929
        41 000523   006306 710000 41                 TRA     s:2929
        41 000524   005347 710000 41                 TRA     s:2760
        41 000525   006306 710000 41                 TRA     s:2929
        41 000526   006306 710000 41                 TRA     s:2929
        41 000527   006306 710000 41                 TRA     s:2929
        41 000530   006306 710000 41                 TRA     s:2929
        41 000531   006306 710000 41                 TRA     s:2929
        41 000532   006306 710000 41                 TRA     s:2929
        41 000533   006306 710000 41                 TRA     s:2929
        41 000534   006306 710000 41                 TRA     s:2929
        41 000535   006306 710000 41                 TRA     s:2929
        41 000536   006306 710000 41                 TRA     s:2929
        41 000537   006306 710000 41                 TRA     s:2929
        41 000540   006306 710000 41                 TRA     s:2929
        41 000541   006306 710000 41                 TRA     s:2929
        41 000542   006306 710000 41                 TRA     s:2929
        41 000543   006306 710000 41                 TRA     s:2929
        41 000544   006306 710000 41                 TRA     s:2929
        41 000545   006306 710000 41                 TRA     s:2929
        41 000546   006306 710000 41                 TRA     s:2929
        41 000547   006306 710000 41                 TRA     s:2929
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:75   
        41 000550   005663 710000 41                 TRA     s:2844

      227     1869    3           CASE(%SET_SEL); /* beginning of set selection clause */

      228     1870    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1870 41 000551   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 000552   000001 036003                    ADLQ    1,DU
        41 000553   200116 756100                    STQ     DYNMEM$,,AUTO

      229     1871    3               THIS_SC = DYNMEM$->WRD1; /* SC of SET NAME IS setname */

   1871 41 000554   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 000555   000000 235100                    LDA     0,,PR0
        41 000556   200024 755100                    STA     THIS_SC,,AUTO

      230     1872    3               CALL FINDD_6('SC      ',THIS_SC); /* SC */

   1872 41 000557   200024 631500                    EPPR1   THIS_SC,,AUTO
        41 000560   200123 451500                    STP1    LNO+3,,AUTO
        41 000561   000005 236000 42                 LDQ     5
        41 000562   200122 756100                    STQ     LNO+2,,AUTO
        41 000563   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000564   000000 631400 42                 EPPR1   0
        41 000565   000000 701000 xent               TSX1    FINDD_6
        41 000566   000000 011000                    NOP     0

      231     1873    3               CALL FINDOS_6('SN-SE   ');

   1873 41 000567   000027 630400 42                 EPPR0   23
        41 000570   000003 631400 42                 EPPR1   3
        41 000571   000000 701000 xent               TSX1    FINDOS_6
        41 000572   000000 011000                    NOP     0

      232     1874    3               LAST_DEF_SET_DBK = UWA.DIRECT_REF;

   1874 41 000573   000036 235000 39                 LDA     UWA+30
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:76   
        41 000574   000000 755000 20                 STA     LAST_DEF_SET_DBK

      233     1875    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1875 41 000575   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 000576   000001 036003                    ADLQ    1,DU
        41 000577   200116 756100                    STQ     DYNMEM$,,AUTO

      234     1876    3               THIS_SM = DYNMEM$->WRD1; /* SM of MEMBER IS recordname */

   1876 41 000600   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 000601   000000 235100                    LDA     0,,PR0
        41 000602   200025 755100                    STA     THIS_SM,,AUTO

      235     1877    3               CALL FINDD_6('SM      ',THIS_SM); /* SM */

   1877 41 000603   200025 631500                    EPPR1   THIS_SM,,AUTO
        41 000604   200123 451500                    STP1    LNO+3,,AUTO
        41 000605   000030 236000 42                 LDQ     24
        41 000606   200122 756100                    STQ     LNO+2,,AUTO
        41 000607   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000610   000000 631400 42                 EPPR1   0
        41 000611   000000 701000 xent               TSX1    FINDD_6
        41 000612   000000 011000                    NOP     0

      236     1878    3               CALL FETCHNS_6('SM-SS   '); /* SS */

   1878 41 000613   000031 630400 42                 EPPR0   25
        41 000614   000003 631400 42                 EPPR1   3
        41 000615   000000 701000 xent               TSX1    FETCHNS_6
        41 000616   000000 011000                    NOP     0

      237     1879    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1879 41 000617   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 000620   000001 036003                    ADLQ    1,DU
        41 000621   200116 756100                    STQ     DYNMEM$,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:77   

      238     1880    3               THIS_SN = DYNMEM$->WRD1; /* SN of SET SELECTION THRU setname */

   1880 41 000622   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 000623   000000 235100                    LDA     0,,PR0
        41 000624   200027 755100                    STA     THIS_SN,,AUTO

      239     1881    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1881 41 000625   000001 036003                    ADLQ    1,DU
        41 000626   200116 756100                    STQ     DYNMEM$,,AUTO

      240     1882    3               LNO = DYNMEM$->WRD1;

   1882 41 000627   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 000630   000000 235100                    LDA     0,,PR0
        41 000631   200120 755100                    STA     LNO,,AUTO

      241     1883    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1883 41 000632   000001 036003                    ADLQ    1,DU
        41 000633   200116 756100                    STQ     DYNMEM$,,AUTO

      242     1884    3               CALL FINDD_6('SN      ',THIS_SN); /* SN */

   1884 41 000634   200027 630500                    EPPR0   THIS_SN,,AUTO
        41 000635   200123 450500                    STP0    LNO+3,,AUTO
        41 000636   000010 236000 42                 LDQ     8
        41 000637   200122 756100                    STQ     LNO+2,,AUTO
        41 000640   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000641   000000 631400 42                 EPPR1   0
        41 000642   000000 701000 xent               TSX1    FINDD_6
        41 000643   000000 011000                    NOP     0

      243     1885    3               CALL FINDNS_6('SN-SE   '); /* SC */

   1885 41 000644   000027 630400 42                 EPPR0   23
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:78   
        41 000645   000003 631400 42                 EPPR1   3
        41 000646   000000 701000 xent               TSX1    FINDNS_6
        41 000647   000000 011000                    NOP     0

      244     1886    3               THIS_SN_SC = UWA.DIRECT_REF;

   1886 41 000650   000036 235000 39                 LDA     UWA+30
        41 000651   200030 755100                    STA     THIS_SN_SC,,AUTO

      245     1887    3               CALL FINDNS_6('SC-SOSM '); /* SO */

   1887 41 000652   000032 630400 42                 EPPR0   26
        41 000653   000003 631400 42                 EPPR1   3
        41 000654   000000 701000 xent               TSX1    FINDNS_6
        41 000655   000000 011000                    NOP     0

      246     1888    3               THIS_SN_SO = UWA.DIRECT_REF; /* SO of SET SELECTION THRU setname */

   1888 41 000656   000036 235000 39                 LDA     UWA+30
        41 000657   200031 755100                    STA     THIS_SN_SO,,AUTO

      247     1889    3               CALL FETCHOS_6('RC-SOSM '); /* RC */

   1889 41 000660   000033 630400 42                 EPPR0   27
        41 000661   000003 631400 42                 EPPR1   3
        41 000662   000000 701000 xent               TSX1    FETCHOS_6
        41 000663   000000 011000                    NOP     0

      248     1890    3               THIS_SN_SO_RC = UWA.DIRECT_REF;

   1890 41 000664   000036 235000 39                 LDA     UWA+30
        41 000665   200032 755100                    STA     THIS_SN_SO_RC,,AUTO
        41 000666   006306 710000 41                 TRA     s:2929

      249     1891        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:79   
      250     1892        /*****************************************************************/
      251     1893    3           CASE(%APPLIC); /* APPLICATION */

      252     1894         /* Don't need to do anything.  The SS already connected to
      253     1895            THIS_SM in pass1 is sufficient.
      254     1896         */
      255     1897    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1897 41 000667   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 000670   000001 036003                    ADLQ    1,DU
        41 000671   200116 756100                    STQ     DYNMEM$,,AUTO
        41 000672   006306 710000 41                 TRA     s:2929

      256     1898        /*****************************************************************/
      257     1899    3           CASE(%CALC_EQ); /* CALCKEY EQUAL TO dbid/dbparam */

      258     1900         /* - make sure THIS_SN's set owner RC is location mode calc
      259     1901            - find the SM inthe *calc set of THIS_SN's set owner
      260     1902            - modify the existing SS off THIS_SM and create another SS
      261     1903            - for each fieldname given in the CALC_KEY EQUAL TO clause:
      262     1904            -make sure number fields given still not more than number
      263     1905            occuring in LOCATION MODE CALC USING clause of THIS_SN's
      264     1906            set owner record
      265     1907            -add SN(if necessary) and NR
      266     1908            -make one of the SSs current
      267     1909            -go fetch RFR of next calckey named in LOC  MODE CALC clause
      268     1910            and save type defintions
      269     1911            -if name mentioned in EQUAL TO clause is new dbparam then
      270     1912            build a RFR for it
      271     1913            -if name mentioned was a dbid or already existing dbparam then
      272     1914            compare type definitions
      273     1915            -build a SFR and point it to the RFR
      274     1916            - build a SCF and connect it to one of the SSs
      275     1917            -build another SCF and connect it to the other SS
      276     1918            -make sure number of keys given in EQUAL TO clause matches number
      277     1919            given in LOC MODE clause
      278     1920         */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:80   
      279     1921    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1921 41 000673   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 000674   000001 036003                    ADLQ    1,DU
        41 000675   200116 756100                    STQ     DYNMEM$,,AUTO

      280     1922    3               LNO = DYNMEM$->WRD1;

   1922 41 000676   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 000677   000000 235100                    LDA     0,,PR0
        41 000700   200120 755100                    STA     LNO,,AUTO

      281     1923    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   1923 41 000701   000001 036003                    ADLQ    1,DU
        41 000702   200116 756100                    STQ     DYNMEM$,,AUTO

      282     1924    3               FR_NAME = DYNMEM$->CHAR30;

   1924 41 000703   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 000704   040100 100500                    MLR     fill='040'O
        41 000705   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 000706   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30

      283     1925    3               DYNMEM$ = PINCRW(DYNMEM$,8);

   1925 41 000707   000010 036003                    ADLQ    8,DU
        41 000710   200116 756100                    STQ     DYNMEM$,,AUTO

      284     1926    3               CALL FETCHNS_6('SN-SE   ');

   1926 41 000711   000027 630400 42                 EPPR0   23
        41 000712   000003 631400 42                 EPPR1   3
        41 000713   000000 701000 xent               TSX1    FETCHNS_6
        41 000714   000000 011000                    NOP     0

      285     1927    3               CALL INDEX(CT1,' ',UWA.SN.SENAME);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:81   

   1927 41 000715   000000 124400                    SCM     mask='000'O
        41 000716   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 000717   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 000720   200005 000100                    ARG     CT1,,AUTO

      286     1928    3               CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   1928 41 000721   000024 236000 42                 LDQ     20
        41 000722   200124 756100                    STQ     LNO+4,,AUTO
        41 000723   200005 630500                    EPPR0   CT1,,AUTO
        41 000724   200123 450500                    STP0    LNO+3,,AUTO
        41 000725   000014 236000 42                 LDQ     12
        41 000726   200122 756100                    STQ     LNO+2,,AUTO
        41 000727   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000730   000012 631400 42                 EPPR1   10
        41 000731   000000 701000 xent               TSX1    SET_FIELDS
        41 000732   000000 011000                    NOP     0

      287     1929    3               FIRST_TIME = '1'B;

   1929 41 000733   400000 236003                    LDQ     -131072,DU
        41 000734   200115 756100                    STQ     FIRST_TIME,,AUTO

      288     1930    3               IF UWA.RC.PSMODE ~= 1 THEN /* CALC */

   1930 41 000735   000271 235000 39                 LDA     UWA+185
        41 000736   000001 115007                    CMPA    1,DL
        41 000737   001067 600000 41                 TZE     s:1961

      289     1931    4               DO;

      290     1932    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);

   1932 41 000740   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 000741   200123 450500                    STP0    LNO+3,,AUTO
        41 000742   000007 236000 42                 LDQ     7
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:82   
        41 000743   200122 756100                    STQ     LNO+2,,AUTO
        41 000744   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000745   000000 631400 42                 EPPR1   0
        41 000746   000000 701000 xent               TSX1    FETCHD_6
        41 000747   000000 011000                    NOP     0

      291     1933    4                   CALL FETCHOS_6('SN-SE   ');

   1933 41 000750   000027 630400 42                 EPPR0   23
        41 000751   000003 631400 42                 EPPR1   3
        41 000752   000000 701000 xent               TSX1    FETCHOS_6
        41 000753   000000 011000                    NOP     0

      292     1934    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);

   1934 41 000754   000000 124400                    SCM     mask='000'O
        41 000755   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 000756   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 000757   200005 000100                    ARG     CT1,,AUTO

      293     1935    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   1935 41 000760   000024 236000 42                 LDQ     20
        41 000761   200124 756100                    STQ     LNO+4,,AUTO
        41 000762   200005 630500                    EPPR0   CT1,,AUTO
        41 000763   200123 450500                    STP0    LNO+3,,AUTO
        41 000764   000014 236000 42                 LDQ     12
        41 000765   200122 756100                    STQ     LNO+2,,AUTO
        41 000766   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000767   000012 631400 42                 EPPR1   10
        41 000770   000000 701000 xent               TSX1    SET_FIELDS
        41 000771   000000 011000                    NOP     0

      294     1936    4                   CALL FETCHD_6('SN      ',THIS_SN);

   1936 41 000772   200027 630500                    EPPR0   THIS_SN,,AUTO
        41 000773   200123 450500                    STP0    LNO+3,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:83   
        41 000774   000010 236000 42                 LDQ     8
        41 000775   200122 756100                    STQ     LNO+2,,AUTO
        41 000776   200122 630500                    EPPR0   LNO+2,,AUTO
        41 000777   000000 631400 42                 EPPR1   0
        41 001000   000000 701000 xent               TSX1    FETCHD_6
        41 001001   000000 011000                    NOP     0

      295     1937    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);

   1937 41 001002   000000 124400                    SCM     mask='000'O
        41 001003   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 001004   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 001005   200006 000100                    ARG     CT2,,AUTO

      296     1938    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);

   1938 41 001006   000024 236000 42                 LDQ     20
        41 001007   200124 756100                    STQ     LNO+4,,AUTO
        41 001010   200006 630500                    EPPR0   CT2,,AUTO
        41 001011   200123 450500                    STP0    LNO+3,,AUTO
        41 001012   000020 236000 42                 LDQ     16
        41 001013   200122 756100                    STQ     LNO+2,,AUTO
        41 001014   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001015   000012 631400 42                 EPPR1   10
        41 001016   000000 701000 xent               TSX1    SET_FIELDS
        41 001017   000000 011000                    NOP     0

      297     1939    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4834);

   1939 41 001020   200120 235100                    LDA     LNO,,AUTO
        41 001021   000001 135007                    SBLA    1,DL
        41 001022   200122 755100                    STA     LNO+2,,AUTO
        41 001023   000036 237000 42                 LDAQ    30
        41 001024   200124 757100                    STAQ    LNO+4,,AUTO
        41 001025   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001026   200123 450500                    STP0    LNO+3,,AUTO
        41 001027   200123 630500                    EPPR0   LNO+3,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:84   
        41 001030   000012 631400 42                 EPPR1   10
        41 001031   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001032   000000 011000                    NOP     0

      298     1940        /*E* ERROR:  ZIG-4834-C
      299     1941           MESSAGE:  The SET SELECTION clause is invalid because the owner
      300     1942                     record "%U1" of set "%U2" does not have CALC location mode.
      301     1943        */
      302     1944    5                   DO WHILE (DYNMEM$->WRD1 = %CALC_EQ) OR FIRST_TIME;

   1944 41 001033   001060 710000 41                 TRA     s:1958

      303     1945    5                       IF NOT FIRST_TIME THEN

   1945 41 001034   200115 234100                    SZN     FIRST_TIME,,AUTO
        41 001035   001046 604000 41                 TMI     s:1952

      304     1946    6                       DO;

      305     1947    6                           DYNMEM$ = PINCRW(DYNMEM$,1);

   1947 41 001036   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 001037   000001 036003                    ADLQ    1,DU
        41 001040   200116 756100                    STQ     DYNMEM$,,AUTO

      306     1948    6                           DYNMEM$ = PINCRW(DYNMEM$,1);

   1948 41 001041   000001 036003                    ADLQ    1,DU
        41 001042   200116 756100                    STQ     DYNMEM$,,AUTO

      307     1949    6                           DYNMEM$ = PINCRW(DYNMEM$,8);

   1949 41 001043   000010 036003                    ADLQ    8,DU
        41 001044   200116 756100                    STQ     DYNMEM$,,AUTO

      308     1950    6                           END;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:85   
   1950 41 001045   001047 710000 41                 TRA     s:1953

      309     1951    5                       ELSE
      310     1952    5                           FIRST_TIME = '0'B;

   1952 41 001046   200115 450100                    STZ     FIRST_TIME,,AUTO

      311     1953    5                       IF DYNMEM$->WRD1 = %QUAL THEN

   1953 41 001047   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 001050   000000 235100                    LDA     0,,PR0
        41 001051   000113 115007                    CMPA    75,DL
        41 001052   001060 601000 41                 TNZ     s:1958

      312     1954    6                       DO;

      313     1955    6                           DYNMEM$ = PINCRW(DYNMEM$,1);

   1955 41 001053   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 001054   000001 036003                    ADLQ    1,DU
        41 001055   200116 756100                    STQ     DYNMEM$,,AUTO

      314     1956    6                           DYNMEM$ = PINCRW(DYNMEM$,8);

   1956 41 001056   000010 036003                    ADLQ    8,DU
        41 001057   200116 756100                    STQ     DYNMEM$,,AUTO

      315     1957    6                           END;

      316     1958    5                       END; /* WHILE */

   1958 41 001060   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 001061   000000 235100                    LDA     0,,PR0
        41 001062   000002 115007                    CMPA    2,DL
        41 001063   001034 600000 41                 TZE     s:1945
        41 001064   200115 234100                    SZN     FIRST_TIME,,AUTO
        41 001065   001034 604000 41                 TMI     s:1945
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:86   

      317     1959    4                   END; /* IF NOT CALC */

   1959 41 001066   006306 710000 41                 TRA     s:2929

      318     1960    4               ELSE DO;

      319     1961    5                   IF UWA.RC.CALCDUP = 0 THEN DO; /* 0= dups allowed */

   1961 41 001067   000277 235000 39                 LDA     UWA+191
        41 001070   001104 601000 41                 TNZ     s:1968

      320     1962    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4835);

   1962 41 001071   200120 235100                    LDA     LNO,,AUTO
        41 001072   000001 135007                    SBLA    1,DL
        41 001073   200122 755100                    STA     LNO+2,,AUTO
        41 001074   000040 237000 42                 LDAQ    32
        41 001075   200124 757100                    STAQ    LNO+4,,AUTO
        41 001076   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001077   200123 450500                    STP0    LNO+3,,AUTO
        41 001100   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001101   000012 631400 42                 EPPR1   10
        41 001102   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001103   000000 011000                    NOP     0

      321     1963        /*E* ERROR:  ZIG-4835-C
      322     1964           MESSAGE:  The SET SELECTION clause is invalid because the record
      323     1965                     "%U1" may have duplicate calc key values.
      324     1966        */
      325     1967    5                       END;

      326     1968    4                   CALL FETCHNS_6('RC-FR   '); /* FR */

   1968 41 001104   000042 630400 42                 EPPR0   34
        41 001105   000003 631400 42                 EPPR1   3
        41 001106   000000 701000 xent               TSX1    FETCHNS_6
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:87   
        41 001107   000000 011000                    NOP     0

      327     1969    5                   DO WHILE (UWA.FR.DERIVED = 0); /* want 1st calc key */

   1969 41 001110   000347 235000 39                 LDA     UWA+231
        41 001111   001120 601000 41                 TNZ     s:1972

      328     1970    5                       CALL FETCHNS_6('RC-FR   ');

   1970 41 001112   000042 630400 42                 EPPR0   34
        41 001113   000003 631400 42                 EPPR1   3
        41 001114   000000 701000 xent               TSX1    FETCHNS_6
        41 001115   000000 011000                    NOP     0

      329     1971    5                       END;

   1971 41 001116   000347 235000 39                 LDA     UWA+231
        41 001117   001112 600000 41                 TZE     s:1970

      330     1972    4                   FIRST_DBK_RFR_CALC = UWA.DIRECT_REF;

   1972 41 001120   000036 236000 39                 LDQ     UWA+30
        41 001121   200015 756100                    STQ     FIRST_DBK_RFR_CALC,,AUTO

      331     1973    4                   CALL FINDD_6('RC      ',THIS_SN_SO_RC); /* RC */

   1973 41 001122   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 001123   200123 450500                    STP0    LNO+3,,AUTO
        41 001124   000007 236000 42                 LDQ     7
        41 001125   200122 756100                    STQ     LNO+2,,AUTO
        41 001126   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001127   000000 631400 42                 EPPR1   0
        41 001130   000000 701000 xent               TSX1    FINDD_6
        41 001131   000000 011000                    NOP     0

      332     1974    4                   CALL FINDPS_6('RC-SOSM '); /* SM in *calc set */

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:88   
   1974 41 001132   000033 630400 42                 EPPR0   27
        41 001133   000003 631400 42                 EPPR1   3
        41 001134   000000 701000 xent               TSX1    FINDPS_6
        41 001135   000000 011000                    NOP     0

      333     1975    4                   DBK_SM_CALC = UWA.DIRECT_REF;

   1975 41 001136   000036 235000 39                 LDA     UWA+30
        41 001137   200012 755100                    STA     DBK_SM_CALC,,AUTO

      334     1976    4                   CALL FCURR_R_6('S-S     '); /* current SS */

   1976 41 001140   000043 630400 42                 EPPR0   35
        41 001141   000003 631400 42                 EPPR1   3
        41 001142   000000 701000 xent               TSX1    FCURR_R_6
        41 001143   000000 011000                    NOP     0

      335     1977    4                   DBK_CALCSS = UWA.DIRECT_REF;

   1977 41 001144   000036 235000 39                 LDA     UWA+30
        41 001145   200014 755100                    STA     DBK_CALCSS,,AUTO

      336     1978    4                   UWA.S_S.SOSM_SSH = DBK_SO_CALC;

   1978 41 001146   000000 236000 19                 LDQ     DBK_SO_CALC
        41 001147   000376 756000 39                 STQ     UWA+254

      337     1979    4                   UWA.S_S.SC_SSH = THIS_SN_SC;

   1979 41 001150   200030 235100                    LDA     THIS_SN_SC,,AUTO
        41 001151   000375 755000 39                 STA     UWA+253

      338     1980    4                   UWA.S_S.STYP = 0; /* calc */

   1980 41 001152   000374 450000 39                 STZ     UWA+252

      339     1981    4                   CALL MODIFY_6('S-S     '); /* calcSS */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:89   

   1981 41 001153   000043 630400 42                 EPPR0   35
        41 001154   000003 631400 42                 EPPR1   3
        41 001155   000000 701000 xent               TSX1    MODIFY_6
        41 001156   000000 011000                    NOP     0

      340     1982    4                   UWA.S_S.STYP = 4; /* scan */

   1982 41 001157   000004 235007                    LDA     4,DL
        41 001160   000374 755000 39                 STA     UWA+252

      341     1983    4                   UWA.S_S.SOSM_SSH = DBK_SM_CALC;

   1983 41 001161   200012 236100                    LDQ     DBK_SM_CALC,,AUTO
        41 001162   000376 756000 39                 STQ     UWA+254

      342     1984    4                   CALL STRE_6('S-S     ');

   1984 41 001163   000043 630400 42                 EPPR0   35
        41 001164   000003 631400 42                 EPPR1   3
        41 001165   000000 701000 xent               TSX1    STRE_6
        41 001166   000000 011000                    NOP     0

      343     1985    4                   UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;

   1985 41 001167   000223 054000 39                 AOS     UWA+147

      344     1986    4                   DBK_SCANSS = UWA.DIRECT_REF;

   1986 41 001170   000036 235000 39                 LDA     UWA+30
        41 001171   200013 755100                    STA     DBK_SCANSS,,AUTO

      345     1987    4                   FIRST_TIME = '1'B;

   1987 41 001172   400000 236003                    LDQ     -131072,DU
        41 001173   200115 756100                    STQ     FIRST_TIME,,AUTO

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:90   
      346     1988    4                   NUM_EQ_CALCKEYS = 0;

   1988 41 001174   200067 450100                    STZ     NUM_EQ_CALCKEYS,,AUTO

      347     1989    5                   DO WHILE (DYNMEM$->WRD1 = %CALC_EQ) OR FIRST_TIME;

   1989 41 001175   002054 710000 41                 TRA     s:2146

      348     1990    5                       FLAG_ERR = '0'B;

   1990 41 001176   200114 450100                    STZ     FLAG_ERR,,AUTO

      349     1991    5                       NUM_EQ_CALCKEYS = NUM_EQ_CALCKEYS + 1;

   1991 41 001177   200067 235100                    LDA     NUM_EQ_CALCKEYS,,AUTO
        41 001200   000001 035007                    ADLA    1,DL
        41 001201   200067 755100                    STA     NUM_EQ_CALCKEYS,,AUTO

      350     1992    6                       IF NUM_EQ_CALCKEYS > UWA.RC.SLACK THEN DO;

   1992 41 001202   200067 236100                    LDQ     NUM_EQ_CALCKEYS,,AUTO
        41 001203   001206 604000 41                 TMI     s:1993
        41 001204   000307 116000 39                 CMPQ    UWA+199
        41 001205   001255 604400 41                 TMOZ    s:2005

      351     1993    6                           FLAG_ERR = '1'B;

   1993 41 001206   400000 236003                    LDQ     -131072,DU
        41 001207   200114 756100                    STQ     FLAG_ERR,,AUTO

      352     1994    6                           CALL FETCHD_6('RC      ',THIS_SN_SO_RC);

   1994 41 001210   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 001211   200123 450500                    STP0    LNO+3,,AUTO
        41 001212   000007 236000 42                 LDQ     7
        41 001213   200122 756100                    STQ     LNO+2,,AUTO
        41 001214   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:91   
        41 001215   000000 631400 42                 EPPR1   0
        41 001216   000000 701000 xent               TSX1    FETCHD_6
        41 001217   000000 011000                    NOP     0

      353     1995    6                           CALL FETCHOS_6('SN-SE   ');

   1995 41 001220   000027 630400 42                 EPPR0   23
        41 001221   000003 631400 42                 EPPR1   3
        41 001222   000000 701000 xent               TSX1    FETCHOS_6
        41 001223   000000 011000                    NOP     0

      354     1996    6                           CALL INDEX(CT1,' ',UWA.SN.SENAME);

   1996 41 001224   000000 124400                    SCM     mask='000'O
        41 001225   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 001226   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 001227   200005 000100                    ARG     CT1,,AUTO

      355     1997    6                           CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   1997 41 001230   000024 236000 42                 LDQ     20
        41 001231   200124 756100                    STQ     LNO+4,,AUTO
        41 001232   200005 630500                    EPPR0   CT1,,AUTO
        41 001233   200123 450500                    STP0    LNO+3,,AUTO
        41 001234   000014 236000 42                 LDQ     12
        41 001235   200122 756100                    STQ     LNO+2,,AUTO
        41 001236   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001237   000012 631400 42                 EPPR1   10
        41 001240   000000 701000 xent               TSX1    SET_FIELDS
        41 001241   000000 011000                    NOP     0

      356     1998    6                           CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4906);

   1998 41 001242   200120 235100                    LDA     LNO,,AUTO
        41 001243   000001 135007                    SBLA    1,DL
        41 001244   200122 755100                    STA     LNO+2,,AUTO
        41 001245   000046 237000 42                 LDAQ    38
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:92   
        41 001246   200124 757100                    STAQ    LNO+4,,AUTO
        41 001247   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001250   200123 450500                    STP0    LNO+3,,AUTO
        41 001251   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001252   000012 631400 42                 EPPR1   10
        41 001253   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001254   000000 011000                    NOP     0

      357     1999        /*E* ERROR:  ZIG-4906-C
      358     2000           MESSAGE:  The SET SELECTION clause is invalid because the EQUAL
      359     2001                     TO phrase specifies more fields than does the LOCATION
      360     2002                     clause for record "%U1".
      361     2003        */
      362     2004    6                           END;

      363     2005    5                       IF NOT FIRST_TIME THEN

   2005 41 001255   200115 234100                    SZN     FIRST_TIME,,AUTO
        41 001256   001276 604000 41                 TMI     s:2014

      364     2006    6                       DO;

      365     2007    6                           DYNMEM$ = PINCRW(DYNMEM$,1);

   2007 41 001257   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 001260   000001 036003                    ADLQ    1,DU
        41 001261   200116 756100                    STQ     DYNMEM$,,AUTO

      366     2008    6                           LNO = DYNMEM$->WRD1;

   2008 41 001262   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 001263   000000 235100                    LDA     0,,PR0
        41 001264   200120 755100                    STA     LNO,,AUTO

      367     2009    6                           DYNMEM$ = PINCRW(DYNMEM$,1);

   2009 41 001265   000001 036003                    ADLQ    1,DU
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:93   
        41 001266   200116 756100                    STQ     DYNMEM$,,AUTO

      368     2010    6                           FR_NAME = DYNMEM$->CHAR30;

   2010 41 001267   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 001270   040100 100500                    MLR     fill='040'O
        41 001271   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 001272   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30

      369     2011    6                           DYNMEM$ = PINCRW(DYNMEM$,8);

   2011 41 001273   000010 036003                    ADLQ    8,DU
        41 001274   200116 756100                    STQ     DYNMEM$,,AUTO

      370     2012    6                           END;

   2012 41 001275   001277 710000 41                 TRA     s:2015

      371     2013    5                       ELSE
      372     2014    5                           FIRST_TIME = '0'B;

   2014 41 001276   200115 450100                    STZ     FIRST_TIME,,AUTO

      373     2015    5                       IF DYNMEM$->WRD1 = %QUAL THEN

   2015 41 001277   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 001300   000000 235100                    LDA     0,,PR0
        41 001301   000113 115007                    CMPA    75,DL
        41 001302   001401 601000 41                 TNZ     s:2033

      374     2016    6                       DO;

      375     2017    6                           DYNMEM$ = PINCRW(DYNMEM$,1);

   2017 41 001303   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 001304   000001 036003                    ADLQ    1,DU
        41 001305   200116 756100                    STQ     DYNMEM$,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:94   

      376     2018    6                           QRC_NAME = DYNMEM$->CHAR30;

   2018 41 001306   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 001307   040100 100500                    MLR     fill='040'O
        41 001310   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 001311   200046 000036                    ADSC9   QRC_NAME,,AUTO           cn=0,n=30

      377     2019    6                           DYNMEM$ = PINCRW(DYNMEM$,8);

   2019 41 001312   000010 036003                    ADLQ    8,DU
        41 001313   200116 756100                    STQ     DYNMEM$,,AUTO

      378     2020    6                          CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR
              2020                                    ,0

   2020 41 001314   000052 237000 42                 LDAQ    42
        41 001315   200130 757100                    STAQ    LNO+8,,AUTO
        41 001316   000054 237000 42                 LDAQ    44
        41 001317   200126 757100                    STAQ    LNO+6,,AUTO
        41 001320   200120 630500                    EPPR0   LNO,,AUTO
        41 001321   200125 450500                    STP0    LNO+5,,AUTO
        41 001322   000052 236000 42                 LDQ     42
        41 001323   200124 756100                    STQ     LNO+4,,AUTO
        41 001324   200046 631500                    EPPR1   QRC_NAME,,AUTO
        41 001325   200123 451500                    STP1    LNO+3,,AUTO
        41 001326   000056 236000 42                 LDQ     46
        41 001327   200122 756100                    STQ     LNO+2,,AUTO
        41 001330   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001331   000045 631400 42                 EPPR1   37
        41 001332   000000 701000 xent               TSX1    ADD_SN
        41 001333   000000 011000                    NOP     0

      379     2021    6                              ,0);
      380     2022    6                           IF FOUND ~= %FOUNDDEF THEN

   2022 41 001334   000002 235000 17                 LDA     FOUND
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:95   
        41 001335   000002 115007                    CMPA    2,DL
        41 001336   001372 600000 41                 TZE     s:2029

      381     2023    7                           DO;

      382     2024    7                               FLAG_ERR = '1'B;

   2024 41 001337   400000 236003                    LDQ     -131072,DU
        41 001340   200114 756100                    STQ     FLAG_ERR,,AUTO

      383     2025    7                               CALL INDEX(CT1,' ',FR_NAME);

   2025 41 001341   000000 124500                    SCM     mask='000'O
        41 001342   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 001343   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 001344   200005 000100                    ARG     CT1,,AUTO

      384     2026    7                               CALL SET_FIELDS(1,CT1,FR_NAME);

   2026 41 001345   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 001346   200124 450500                    STP0    LNO+4,,AUTO
        41 001347   200005 631500                    EPPR1   CT1,,AUTO
        41 001350   200123 451500                    STP1    LNO+3,,AUTO
        41 001351   000014 236000 42                 LDQ     12
        41 001352   200122 756100                    STQ     LNO+2,,AUTO
        41 001353   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001354   000012 631400 42                 EPPR1   10
        41 001355   000000 701000 xent               TSX1    SET_FIELDS
        41 001356   000000 011000                    NOP     0

      385     2027    7                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4809);
              2027                                        /*qualifying RC not DEFed */

   2027 41 001357   200120 235100                    LDA     LNO,,AUTO
        41 001360   000001 135007                    SBLA    1,DL
        41 001361   200122 755100                    STA     LNO+2,,AUTO
        41 001362   000060 237000 42                 LDAQ    48
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:96   
        41 001363   200124 757100                    STAQ    LNO+4,,AUTO
        41 001364   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001365   200123 450500                    STP0    LNO+3,,AUTO
        41 001366   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001367   000012 631400 42                 EPPR1   10
        41 001370   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001371   000000 011000                    NOP     0

      386     2028    7                               END;

      387     2029    6                           CALL FINDNS_6('SN-SE   '); /* RC */

   2029 41 001372   000027 630400 42                 EPPR0   23
        41 001373   000003 631400 42                 EPPR1   3
        41 001374   000000 701000 xent               TSX1    FINDNS_6
        41 001375   000000 011000                    NOP     0

      388     2030    6                           QRC_DBK = UWA.DIRECT_REF;

   2030 41 001376   000036 235000 39                 LDA     UWA+30
        41 001377   200045 755100                    STA     QRC_DBK,,AUTO

      389     2031    6                           END;

   2031 41 001400   001402 710000 41                 TRA     s:2034

      390     2032    5                       ELSE
      391     2033    5                           QRC_DBK = 0; /* not qualified */

   2033 41 001401   200045 450100                    STZ     QRC_DBK,,AUTO

      392     2034    6                       IF NOT FLAG_ERR THEN DO;

   2034 41 001402   200114 234100                    SZN     FLAG_ERR,,AUTO
        41 001403   002054 604000 41                 TMI     s:2146

      393     2035    6                           CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.SS,
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:97   

   2035 41 001404   200045 630500                    EPPR0   QRC_DBK,,AUTO
        41 001405   200131 450500                    STP0    LNO+9,,AUTO
        41 001406   000063 236000 42                 LDQ     51
        41 001407   200130 756100                    STQ     LNO+8,,AUTO
        41 001410   000064 237000 42                 LDAQ    52
        41 001411   200126 757100                    STAQ    LNO+6,,AUTO
        41 001412   200120 631500                    EPPR1   LNO,,AUTO
        41 001413   200125 451500                    STP1    LNO+5,,AUTO
        41 001414   000052 236000 42                 LDQ     42
        41 001415   200124 756100                    STQ     LNO+4,,AUTO
        41 001416   200035 633500                    EPPR3   FR_NAME,,AUTO
        41 001417   200123 453500                    STP3    LNO+3,,AUTO
        41 001420   000066 236000 42                 LDQ     54
        41 001421   200122 756100                    STQ     LNO+2,,AUTO
        41 001422   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001423   000045 631400 42                 EPPR1   37
        41 001424   000000 701000 xent               TSX1    ADD_SN
        41 001425   000000 011000                    NOP     0

      394     2036    6                              EXPLCT,QRC_DBK);
      395     2037    6                           IF FOUND = %FOUNDDUP THEN

   2037 41 001426   000002 235000 17                 LDA     FOUND
        41 001427   000003 115007                    CMPA    3,DL
        41 001430   001463 601000 41                 TNZ     s:2049

      396     2038    7                           DO;

      397     2039    7                               CALL INDEX(CT1,' ',FR_NAME);

   2039 41 001431   000000 124500                    SCM     mask='000'O
        41 001432   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 001433   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 001434   200005 000100                    ARG     CT1,,AUTO

      398     2040    7                               CALL SET_FIELDS(1,CT1,FR_NAME);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:98   

   2040 41 001435   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 001436   200124 450500                    STP0    LNO+4,,AUTO
        41 001437   200005 631500                    EPPR1   CT1,,AUTO
        41 001440   200123 451500                    STP1    LNO+3,,AUTO
        41 001441   000014 236000 42                 LDQ     12
        41 001442   200122 756100                    STQ     LNO+2,,AUTO
        41 001443   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001444   000012 631400 42                 EPPR1   10
        41 001445   000000 701000 xent               TSX1    SET_FIELDS
        41 001446   000000 011000                    NOP     0

      399     2041    7                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4801);
              2041                                        /* needs qualifier */

   2041 41 001447   200120 235100                    LDA     LNO,,AUTO
        41 001450   000001 135007                    SBLA    1,DL
        41 001451   200122 755100                    STA     LNO+2,,AUTO
        41 001452   000070 237000 42                 LDAQ    56
        41 001453   200124 757100                    STAQ    LNO+4,,AUTO
        41 001454   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001455   200123 450500                    STP0    LNO+3,,AUTO
        41 001456   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001457   000012 631400 42                 EPPR1   10
        41 001460   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001461   000000 011000                    NOP     0

      400     2042        /*E*  ERROR:  ZIG-4801-C
      401     2043            MESSAGE:  The reference to the field "%U1" is ambiguous and
      402     2044                      requires a record name qualifier.
      403     2045        */
      404     2046    7                               END;

   2046 41 001462   002054 710000 41                 TRA     s:2146

      405     2047    7                           ELSE DO;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:99   
      406     2048         /* if qualified but not found, then error */
      407     2049    7                               IF QRC_DBK ~= 0 AND FOUND = %NOTFOUND THEN

   2049 41 001463   200045 236100                    LDQ     QRC_DBK,,AUTO
        41 001464   001521 600000 41                 TZE     s:2060
        41 001465   000000 115003                    CMPA    0,DU
        41 001466   001521 601000 41                 TNZ     s:2060

      408     2050    8                               DO;

      409     2051    8                                   CALL INDEX(CT1,' ',FR_NAME);

   2051 41 001467   000000 124500                    SCM     mask='000'O
        41 001470   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 001471   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 001472   200005 000100                    ARG     CT1,,AUTO

      410     2052    8                                   CALL SET_FIELDS(1,CT1,FR_NAME);

   2052 41 001473   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 001474   200124 450500                    STP0    LNO+4,,AUTO
        41 001475   200005 631500                    EPPR1   CT1,,AUTO
        41 001476   200123 451500                    STP1    LNO+3,,AUTO
        41 001477   000014 236000 42                 LDQ     12
        41 001500   200122 756100                    STQ     LNO+2,,AUTO
        41 001501   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001502   000012 631400 42                 EPPR1   10
        41 001503   000000 701000 xent               TSX1    SET_FIELDS
        41 001504   000000 011000                    NOP     0

      411     2053    8                                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4838);

   2053 41 001505   200120 235100                    LDA     LNO,,AUTO
        41 001506   000001 135007                    SBLA    1,DL
        41 001507   200122 755100                    STA     LNO+2,,AUTO
        41 001510   000074 237000 42                 LDAQ    60
        41 001511   200124 757100                    STAQ    LNO+4,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:100  
        41 001512   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001513   200123 450500                    STP0    LNO+3,,AUTO
        41 001514   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001515   000012 631400 42                 EPPR1   10
        41 001516   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001517   000000 011000                    NOP     0

      412     2054        /*E*  ERROR:  ZIG-4838-C
      413     2055            MESSAGE:  The field "%U1" is not a field of the record specified
      414     2056                      as the qualifier.
      415     2057        */
      416     2058    8                                   END;

   2058 41 001520   002054 710000 41                 TRA     s:2146

      417     2059    8                               ELSE DO;

      418     2060    8                                   DBK_SN = UWA.DIRECT_REF;

   2060 41 001521   000036 235000 39                 LDA     UWA+30
        41 001522   200023 755100                    STA     DBK_SN,,AUTO

      419     2061         /* GO THROUGH RC-FR OF DBK_RC_SO AND FETCH RFR OF NEXT CALCKEY */
      420     2062    8                                   CALL FETCHD_6('FR      ',FIRST_DBK_RFR_CALC);

   2062 41 001523   200015 630500                    EPPR0   FIRST_DBK_RFR_CALC,,AUTO
        41 001524   200123 450500                    STP0    LNO+3,,AUTO
        41 001525   000073 236000 42                 LDQ     59
        41 001526   200122 756100                    STQ     LNO+2,,AUTO
        41 001527   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001530   000000 631400 42                 EPPR1   0
        41 001531   000000 701000 xent               TSX1    FETCHD_6
        41 001532   000000 011000                    NOP     0

      421     2063    9                                   DO WHILE (UWA.FR.DERIVED ~= NUM_EQ_CALCKEYS);

   2063 41 001533   000347 236000 39                 LDQ     UWA+231
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:101  
        41 001534   001537 604000 41                 TMI     s:2064
        41 001535   200067 116100                    CMPQ    NUM_EQ_CALCKEYS,,AUTO
        41 001536   001547 600000 41                 TZE     s:2066

      422     2064    9                                       CALL FETCHNS_6('RC-FR   ');

   2064 41 001537   000042 630400 42                 EPPR0   34
        41 001540   000003 631400 42                 EPPR1   3
        41 001541   000000 701000 xent               TSX1    FETCHNS_6
        41 001542   000000 011000                    NOP     0

      423     2065    9                                       END;

   2065 41 001543   000347 236000 39                 LDQ     UWA+231
        41 001544   001537 604000 41                 TMI     s:2064
        41 001545   200067 116100                    CMPQ    NUM_EQ_CALCKEYS,,AUTO
        41 001546   001537 601000 41                 TNZ     s:2064

      424     2066    8                                   DBK_RFR_CALC = UWA.DIRECT_REF;

   2066 41 001547   000036 235000 39                 LDA     UWA+30
        41 001550   200016 755100                    STA     DBK_RFR_CALC,,AUTO

      425     2067    8                                   FR.FTYPE = UWA.FR.FTYPE;

   2067 41 001551   000334 235000 39                 LDA     UWA+220
        41 001552   200063 755100                    STA     FR,,AUTO

      426     2068    8                                   FR.PREC = UWA.FR.PREC;

   2068 41 001553   000335 235000 39                 LDA     UWA+221
        41 001554   200064 755100                    STA     FR+1,,AUTO

      427     2069    8                                   FR.SCALE = UWA.FR.SCALE;

   2069 41 001555   000336 235000 39                 LDA     UWA+222
        41 001556   200065 755100                    STA     FR+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:102  

      428     2070    8                                   FR.F_SIGN = UWA.FR.F_SIGN;

   2070 41 001557   000337 235000 39                 LDA     UWA+223
        41 001560   200066 755100                    STA     FR+3,,AUTO

      429     2071    9                                   IF FOUND = %NOTFOUND THEN DO; /* dbparam */

   2071 41 001561   000002 235000 17                 LDA     FOUND
        41 001562   001616 601000 41                 TNZ     s:2083

      430     2072         /* connect a RFR for this guy to RC of *DBPARAM */
      431     2073    9                                       CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);

   2073 41 001563   000076 630400 42                 EPPR0   62
        41 001564   000000 631400 42                 EPPR1   0
        41 001565   000000 701000 xent               TSX1    FINDD_6
        41 001566   000000 011000                    NOP     0

      432     2074    9                                       UWA.FR.F_USE = 1;

   2074 41 001567   000001 235007                    LDA     1,DL
        41 001570   000343 755000 39                 STA     UWA+227

      433     2075    9                                       UWA.FR.LEVEL = 0;

   2075 41 001571   000346 450000 39                 STZ     UWA+230

      434     2076    9                                       CALL FINDD_6('SN      ',DBK_SN); /* SN */

   2076 41 001572   200023 630500                    EPPR0   DBK_SN,,AUTO
        41 001573   200123 450500                    STP0    LNO+3,,AUTO
        41 001574   000010 236000 42                 LDQ     8
        41 001575   200122 756100                    STQ     LNO+2,,AUTO
        41 001576   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001577   000000 631400 42                 EPPR1   0
        41 001600   000000 701000 xent               TSX1    FINDD_6
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:103  
        41 001601   000000 011000                    NOP     0

      435     2077    9                                       CALL STRE_6('FR      '); /* RFR */

   2077 41 001602   000073 630400 42                 EPPR0   59
        41 001603   000003 631400 42                 EPPR1   3
        41 001604   000000 701000 xent               TSX1    STRE_6
        41 001605   000000 011000                    NOP     0

      436     2078    9                                       UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   2078 41 001606   000220 054000 39                 AOS     UWA+144

      437     2079    9                                       DBK_RFR = UWA.DIRECT_REF;

   2079 41 001607   000036 235000 39                 LDA     UWA+30
        41 001610   200022 755100                    STA     DBK_RFR,,AUTO

      438     2080    9                                       CALL CONNECT_6('SN-SE   ');

   2080 41 001611   000027 630400 42                 EPPR0   23
        41 001612   000003 631400 42                 EPPR1   3
        41 001613   000000 701000 xent               TSX1    CONNECT_6
        41 001614   000000 011000                    NOP     0

      439     2081    9                                       END;

   2081 41 001615   001754 710000 41                 TRA     s:2125

      440     2082    9                                   ELSE DO; /* dbid or dbparam already mentioned */

      441     2083    9                                       CALL FINDD_6('SN      ',DBK_SN);

   2083 41 001616   200023 630500                    EPPR0   DBK_SN,,AUTO
        41 001617   200123 450500                    STP0    LNO+3,,AUTO
        41 001620   000010 236000 42                 LDQ     8
        41 001621   200122 756100                    STQ     LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:104  
        41 001622   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001623   000000 631400 42                 EPPR1   0
        41 001624   000000 701000 xent               TSX1    FINDD_6
        41 001625   000000 011000                    NOP     0

      442     2084    9                                       CALL FETCHNS_6('SN-SE   '); /* RFR */

   2084 41 001626   000027 630400 42                 EPPR0   23
        41 001627   000003 631400 42                 EPPR1   3
        41 001630   000000 701000 xent               TSX1    FETCHNS_6
        41 001631   000000 011000                    NOP     0

      443     2085    9                                       DBK_RFR = UWA.DIRECT_REF;

   2085 41 001632   000036 235000 39                 LDA     UWA+30
        41 001633   200022 755100                    STA     DBK_RFR,,AUTO

      444     2086    9                                       UWA.FR.REF = 1;

   2086 41 001634   000001 236007                    LDQ     1,DL
        41 001635   000333 756000 39                 STQ     UWA+219

      445     2087    9                                       CALL MODIFY_6( 'FR      ' );
              2087                                                /* This FR will be ref'd by an SFR */

   2087 41 001636   000073 630400 42                 EPPR0   59
        41 001637   000003 631400 42                 EPPR1   3
        41 001640   000000 701000 xent               TSX1    MODIFY_6
        41 001641   000000 011000                    NOP     0

      446     2088         /* if EQUAL TO calckey is same as LOC MODE calckey, then
      447     2089            don't have to check data characteristics */
      448     2090   10                                       IF DBK_RFR ~= DBK_RFR_CALC THEN DO;

   2090 41 001642   200022 236100                    LDQ     DBK_RFR,,AUTO
        41 001643   200016 116100                    CMPQ    DBK_RFR_CALC,,AUTO
        41 001644   001754 600000 41                 TZE     s:2125
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:105  

      449     2091   10                                           CALL INDEX(CT1,' ',FR_NAME);

   2091 41 001645   000000 124500                    SCM     mask='000'O
        41 001646   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 001647   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 001650   200005 000100                    ARG     CT1,,AUTO

      450     2092   10                                           CALL SET_FIELDS(1,CT1,FR_NAME);

   2092 41 001651   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 001652   200124 450500                    STP0    LNO+4,,AUTO
        41 001653   200005 631500                    EPPR1   CT1,,AUTO
        41 001654   200123 451500                    STP1    LNO+3,,AUTO
        41 001655   000014 236000 42                 LDQ     12
        41 001656   200122 756100                    STQ     LNO+2,,AUTO
        41 001657   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001660   000012 631400 42                 EPPR1   10
        41 001661   000000 701000 xent               TSX1    SET_FIELDS
        41 001662   000000 011000                    NOP     0

      451     2093   11                                           IF UWA.FR.FTYPE ~= FR.FTYPE THEN DO;

   2093 41 001663   000334 236000 39                 LDQ     UWA+220
        41 001664   200063 116100                    CMPQ    FR,,AUTO
        41 001665   001702 600000 41                 TZE     s:2101

      452     2094   11                                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4839);

   2094 41 001666   200120 235100                    LDA     LNO,,AUTO
        41 001667   000001 135007                    SBLA    1,DL
        41 001670   200122 755100                    STA     LNO+2,,AUTO
        41 001671   000102 237000 42                 LDAQ    66
        41 001672   200124 757100                    STAQ    LNO+4,,AUTO
        41 001673   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001674   200123 450500                    STP0    LNO+3,,AUTO
        41 001675   200123 630500                    EPPR0   LNO+3,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:106  
        41 001676   000012 631400 42                 EPPR1   10
        41 001677   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001700   000000 011000                    NOP     0

      453     2095        /*E*  ERROR:  ZIG-4839-C
      454     2096            MESSAGE:  The EQUAL TO field "%U1" does not have the required
      455     2097                      data type.
      456     2098        */
      457     2099   11                                               END;

   2099 41 001701   001754 710000 41                 TRA     s:2125

      458     2100   11                                           ELSE DO;

      459     2101   12                                               IF UWA.FR.PREC ~= FR.PREC THEN DO;

   2101 41 001702   000335 236000 39                 LDQ     UWA+221
        41 001703   200064 116100                    CMPQ    FR+1,,AUTO
        41 001704   001720 600000 41                 TZE     s:2108

      460     2102   12                                                  CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4840)
              2102                                                            ;

   2102 41 001705   200120 235100                    LDA     LNO,,AUTO
        41 001706   000001 135007                    SBLA    1,DL
        41 001707   200122 755100                    STA     LNO+2,,AUTO
        41 001710   000104 237000 42                 LDAQ    68
        41 001711   200124 757100                    STAQ    LNO+4,,AUTO
        41 001712   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001713   200123 450500                    STP0    LNO+3,,AUTO
        41 001714   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001715   000012 631400 42                 EPPR1   10
        41 001716   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001717   000000 011000                    NOP     0

      461     2103        /*E*  ERROR:  ZIG-4840-C
      462     2104            MESSAGE:  The EQUAL TO field "%U1" does not have the required
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:107  
      463     2105                      precision.
      464     2106        */
      465     2107   12                                                   END;

      466     2108   12                                               IF UWA.FR.SCALE ~= FR.SCALE THEN DO;

   2108 41 001720   000336 236000 39                 LDQ     UWA+222
        41 001721   200065 116100                    CMPQ    FR+2,,AUTO
        41 001722   001736 600000 41                 TZE     s:2115

      467     2109   12                                                  CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4841)
              2109                                                            ;

   2109 41 001723   200120 235100                    LDA     LNO,,AUTO
        41 001724   000001 135007                    SBLA    1,DL
        41 001725   200122 755100                    STA     LNO+2,,AUTO
        41 001726   000110 237000 42                 LDAQ    72
        41 001727   200124 757100                    STAQ    LNO+4,,AUTO
        41 001730   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001731   200123 450500                    STP0    LNO+3,,AUTO
        41 001732   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001733   000012 631400 42                 EPPR1   10
        41 001734   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001735   000000 011000                    NOP     0

      468     2110        /*E*  ERROR:  ZIG-4841-C
      469     2111            MESSAGE:  The EQUAL TO field "%U1" does not have the required
      470     2112                      scale factor.
      471     2113        */
      472     2114   12                                                   END;

      473     2115   12                                               IF UWA.FR.F_SIGN ~= FR.F_SIGN THEN DO;

   2115 41 001736   000337 236000 39                 LDQ     UWA+223
        41 001737   200066 116100                    CMPQ    FR+3,,AUTO
        41 001740   001754 600000 41                 TZE     s:2125

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:108  
      474     2116   12                                                  CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4842)
              2116                                                            ;

   2116 41 001741   200120 235100                    LDA     LNO,,AUTO
        41 001742   000001 135007                    SBLA    1,DL
        41 001743   200122 755100                    STA     LNO+2,,AUTO
        41 001744   000112 237000 42                 LDAQ    74
        41 001745   200124 757100                    STAQ    LNO+4,,AUTO
        41 001746   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001747   200123 450500                    STP0    LNO+3,,AUTO
        41 001750   200123 630500                    EPPR0   LNO+3,,AUTO
        41 001751   000012 631400 42                 EPPR1   10
        41 001752   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 001753   000000 011000                    NOP     0

      475     2117        /*E*  ERROR:  ZIG-4842-C
      476     2118            MESSAGE:  The EQUAL TO field "%U1" does not have the required
      477     2119                      sign specification.
      478     2120        */
      479     2121   12                                                   END;

      480     2122   11                                               END;

      481     2123   10                                           END;

      482     2124    9                                       END;

      483     2125    8                                   CALL FINDD_6('RC      ',THIS_SN_SO_RC); /* RC */

   2125 41 001754   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 001755   200123 450500                    STP0    LNO+3,,AUTO
        41 001756   000007 236000 42                 LDQ     7
        41 001757   200122 756100                    STQ     LNO+2,,AUTO
        41 001760   200122 630500                    EPPR0   LNO+2,,AUTO
        41 001761   000000 631400 42                 EPPR1   0
        41 001762   000000 701000 xent               TSX1    FINDD_6
        41 001763   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:109  

      484     2126    8                                   UWA.FR.LEVEL = 0;

   2126 41 001764   000346 450000 39                 STZ     UWA+230

      485     2127    8                                   UWA.FR.SYN = 1;

   2127 41 001765   000001 235007                    LDA     1,DL
        41 001766   000332 755000 39                 STA     UWA+218

      486     2128    8                                   UWA.FR.F_USE = 4;

   2128 41 001767   000004 236007                    LDQ     4,DL
        41 001770   000343 756000 39                 STQ     UWA+227

      487     2129    8                                   UWA.FR.BUFFLOC = DBK_RFR_CALC;

   2129 41 001771   200016 235100                    LDA     DBK_RFR_CALC,,AUTO
        41 001772   000351 755000 39                 STA     UWA+233

      488     2130    8                                   UWA.FR.FR_FRH = DBK_RFR;

   2130 41 001773   200022 235100                    LDA     DBK_RFR,,AUTO
        41 001774   000352 755000 39                 STA     UWA+234

      489     2131    8                                   CALL STRE_6('FR      '); /* SFR */

   2131 41 001775   000073 630400 42                 EPPR0   59
        41 001776   000003 631400 42                 EPPR1   3
        41 001777   000000 701000 xent               TSX1    STRE_6
        41 002000   000000 011000                    NOP     0

      490     2132    8                                   UWA.C_F = '0'B;

   2132 41 002001   000000 100400                    MLR     fill='000'O
        41 002002   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 002003   000400 000024 39                 ADSC9   UWA+256                  cn=0,n=20
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:110  

      491     2133    8                                   UWA.C_F.SYN = 1;

   2133 41 002004   000001 235007                    LDA     1,DL
        41 002005   000400 755000 39                 STA     UWA+256

      492     2134    8                                   UWA.C_F.CTRLTYPE = 4; /* calckey */

   2134 41 002006   000004 236007                    LDQ     4,DL
        41 002007   000401 756000 39                 STQ     UWA+257

      493     2135    8                                   CALL FINDD_6('S-S     ',DBK_CALCSS);

   2135 41 002010   200014 630500                    EPPR0   DBK_CALCSS,,AUTO
        41 002011   200123 450500                    STP0    LNO+3,,AUTO
        41 002012   000043 236000 42                 LDQ     35
        41 002013   200122 756100                    STQ     LNO+2,,AUTO
        41 002014   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002015   000000 631400 42                 EPPR1   0
        41 002016   000000 701000 xent               TSX1    FINDD_6
        41 002017   000000 011000                    NOP     0

      494     2136    8                                   CALL STRE_6('C-F     ');

   2136 41 002020   000114 630400 42                 EPPR0   76
        41 002021   000003 631400 42                 EPPR1   3
        41 002022   000000 701000 xent               TSX1    STRE_6
        41 002023   000000 011000                    NOP     0

      495     2137    8                                   CALL CONNECT_6('SSSM-CF ');

   2137 41 002024   000115 630400 42                 EPPR0   77
        41 002025   000003 631400 42                 EPPR1   3
        41 002026   000000 701000 xent               TSX1    CONNECT_6
        41 002027   000000 011000                    NOP     0

      496     2138    8                                   UWA.C_F.CTRLTYPE = 2; /* set selection */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:111  

   2138 41 002030   000002 235007                    LDA     2,DL
        41 002031   000401 755000 39                 STA     UWA+257

      497     2139    8                                   CALL FINDD_6('S-S     ',DBK_SCANSS);

   2139 41 002032   200013 630500                    EPPR0   DBK_SCANSS,,AUTO
        41 002033   200123 450500                    STP0    LNO+3,,AUTO
        41 002034   000043 236000 42                 LDQ     35
        41 002035   200122 756100                    STQ     LNO+2,,AUTO
        41 002036   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002037   000000 631400 42                 EPPR1   0
        41 002040   000000 701000 xent               TSX1    FINDD_6
        41 002041   000000 011000                    NOP     0

      498     2140    8                                   CALL STRE_6('C-F     ');

   2140 41 002042   000114 630400 42                 EPPR0   76
        41 002043   000003 631400 42                 EPPR1   3
        41 002044   000000 701000 xent               TSX1    STRE_6
        41 002045   000000 011000                    NOP     0

      499     2141    8                                   CALL CONNECT_6('SSSM-CF ');

   2141 41 002046   000115 630400 42                 EPPR0   77
        41 002047   000003 631400 42                 EPPR1   3
        41 002050   000000 701000 xent               TSX1    CONNECT_6
        41 002051   000000 011000                    NOP     0

      500     2142    8                                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 2;

   2142 41 002052   000002 236007                    LDQ     2,DL
        41 002053   000224 056000 39                 ASQ     UWA+148

      501     2143    8                                   END;

      502     2144    7                               END;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:112  

      503     2145    6                           END;

      504     2146    5                       END;

   2146 41 002054   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 002055   000000 235100                    LDA     0,,PR0
        41 002056   000002 115007                    CMPA    2,DL
        41 002057   001176 600000 41                 TZE     s:1990
        41 002060   200115 234100                    SZN     FIRST_TIME,,AUTO
        41 002061   001176 604000 41                 TMI     s:1990

      505     2147    5                   IF NUM_EQ_CALCKEYS < UWA.RC.SLACK THEN DO;

   2147 41 002062   200067 236100                    LDQ     NUM_EQ_CALCKEYS,,AUTO
        41 002063   006306 604000 41                 TMI     s:2929
        41 002064   000307 116000 39                 CMPQ    UWA+199
        41 002065   006306 605000 41                 TPL     s:2929

      506     2148    5                       CALL FETCHD_6('RC      ',THIS_SN_SO_RC);

   2148 41 002066   200032 631500                    EPPR1   THIS_SN_SO_RC,,AUTO
        41 002067   200123 451500                    STP1    LNO+3,,AUTO
        41 002070   000007 236000 42                 LDQ     7
        41 002071   200122 756100                    STQ     LNO+2,,AUTO
        41 002072   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002073   000000 631400 42                 EPPR1   0
        41 002074   000000 701000 xent               TSX1    FETCHD_6
        41 002075   000000 011000                    NOP     0

      507     2149    5                       CALL FETCHOS_6('SN-SE   ');

   2149 41 002076   000027 630400 42                 EPPR0   23
        41 002077   000003 631400 42                 EPPR1   3
        41 002100   000000 701000 xent               TSX1    FETCHOS_6
        41 002101   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:113  
      508     2150    5                       CALL INDEX(CT1,' ',UWA.SN.SENAME);

   2150 41 002102   000000 124400                    SCM     mask='000'O
        41 002103   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 002104   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 002105   200005 000100                    ARG     CT1,,AUTO

      509     2151    5                       CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   2151 41 002106   000024 236000 42                 LDQ     20
        41 002107   200124 756100                    STQ     LNO+4,,AUTO
        41 002110   200005 630500                    EPPR0   CT1,,AUTO
        41 002111   200123 450500                    STP0    LNO+3,,AUTO
        41 002112   000014 236000 42                 LDQ     12
        41 002113   200122 756100                    STQ     LNO+2,,AUTO
        41 002114   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002115   000012 631400 42                 EPPR1   10
        41 002116   000000 701000 xent               TSX1    SET_FIELDS
        41 002117   000000 011000                    NOP     0

      510     2152    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4837);

   2152 41 002120   200120 235100                    LDA     LNO,,AUTO
        41 002121   000001 135007                    SBLA    1,DL
        41 002122   200122 755100                    STA     LNO+2,,AUTO
        41 002123   000120 237000 42                 LDAQ    80
        41 002124   200124 757100                    STAQ    LNO+4,,AUTO
        41 002125   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002126   200123 450500                    STP0    LNO+3,,AUTO
        41 002127   200123 630500                    EPPR0   LNO+3,,AUTO
        41 002130   000012 631400 42                 EPPR1   10
        41 002131   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 002132   000000 011000                    NOP     0

      511     2153        /*E*  ERROR:  ZIG-4837-C
      512     2154            MESSAGE:  The set selection clause is invalid because the
      513     2155                      location clause for record "%U1" specifies more calc
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:114  
      514     2156                      keys than does the EQUAL TO phrase.
      515     2157        */
      516     2158    5                       END;

      517     2159    4                   END;

   2159 41 002133   006306 710000 41                 TRA     s:2929

      518     2160         /* END OF CASE 2 */
      519     2161        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:115  
      520     2162        /*****************************************************************/
      521     2163    3           CASE(%CALC_ONL); /* CALC ONLY */

      522     2164         /* What we need to do here is
      523     2165            1) add an SS to the SMSS set owned by the current SM.
      524     2166            2) add a CF for every calc field in this set's owner record.
      525     2167            This CF is connected to the SS mentioned in 1) and to the
      526     2168            FR of the calc field in the owner record.  The number of calc
      527     2169            fields in the owner rec is determined by the number of CFs in
      528     2170            the SMSSCF set of the SM of the owner record in the *calc set */
      529     2171    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2171 41 002134   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 002135   000001 036003                    ADLQ    1,DU
        41 002136   200116 756100                    STQ     DYNMEM$,,AUTO

      530     2172    3               LNO = DYNMEM$->WRD1;

   2172 41 002137   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 002140   000000 235100                    LDA     0,,PR0
        41 002141   200120 755100                    STA     LNO,,AUTO

      531     2173    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2173 41 002142   000001 036003                    ADLQ    1,DU
        41 002143   200116 756100                    STQ     DYNMEM$,,AUTO

      532     2174    3               IF UWA.RC.PSMODE ~= 1 THEN /* calc */

   2174 41 002144   000271 235000 39                 LDA     UWA+185
        41 002145   000001 115007                    CMPA    1,DL
        41 002146   002243 600000 41                 TZE     s:2186

      533     2175    4               DO;

      534     2176    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:116  
   2176 41 002147   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 002150   200123 450500                    STP0    LNO+3,,AUTO
        41 002151   000007 236000 42                 LDQ     7
        41 002152   200122 756100                    STQ     LNO+2,,AUTO
        41 002153   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002154   000000 631400 42                 EPPR1   0
        41 002155   000000 701000 xent               TSX1    FETCHD_6
        41 002156   000000 011000                    NOP     0

      535     2177    4                   CALL FETCHOS_6('SN-SE   ');

   2177 41 002157   000027 630400 42                 EPPR0   23
        41 002160   000003 631400 42                 EPPR1   3
        41 002161   000000 701000 xent               TSX1    FETCHOS_6
        41 002162   000000 011000                    NOP     0

      536     2178    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);

   2178 41 002163   000000 124400                    SCM     mask='000'O
        41 002164   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 002165   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 002166   200005 000100                    ARG     CT1,,AUTO

      537     2179    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   2179 41 002167   000024 236000 42                 LDQ     20
        41 002170   200124 756100                    STQ     LNO+4,,AUTO
        41 002171   200005 630500                    EPPR0   CT1,,AUTO
        41 002172   200123 450500                    STP0    LNO+3,,AUTO
        41 002173   000014 236000 42                 LDQ     12
        41 002174   200122 756100                    STQ     LNO+2,,AUTO
        41 002175   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002176   000012 631400 42                 EPPR1   10
        41 002177   000000 701000 xent               TSX1    SET_FIELDS
        41 002200   000000 011000                    NOP     0

      538     2180    4                   CALL FETCHD_6('SN      ',THIS_SN);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:117  

   2180 41 002201   200027 630500                    EPPR0   THIS_SN,,AUTO
        41 002202   200123 450500                    STP0    LNO+3,,AUTO
        41 002203   000010 236000 42                 LDQ     8
        41 002204   200122 756100                    STQ     LNO+2,,AUTO
        41 002205   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002206   000000 631400 42                 EPPR1   0
        41 002207   000000 701000 xent               TSX1    FETCHD_6
        41 002210   000000 011000                    NOP     0

      539     2181    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);

   2181 41 002211   000000 124400                    SCM     mask='000'O
        41 002212   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 002213   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 002214   200006 000100                    ARG     CT2,,AUTO

      540     2182    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);

   2182 41 002215   000024 236000 42                 LDQ     20
        41 002216   200124 756100                    STQ     LNO+4,,AUTO
        41 002217   200006 630500                    EPPR0   CT2,,AUTO
        41 002220   200123 450500                    STP0    LNO+3,,AUTO
        41 002221   000020 236000 42                 LDQ     16
        41 002222   200122 756100                    STQ     LNO+2,,AUTO
        41 002223   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002224   000012 631400 42                 EPPR1   10
        41 002225   000000 701000 xent               TSX1    SET_FIELDS
        41 002226   000000 011000                    NOP     0

      541     2183    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4834);

   2183 41 002227   200120 235100                    LDA     LNO,,AUTO
        41 002230   000001 135007                    SBLA    1,DL
        41 002231   200122 755100                    STA     LNO+2,,AUTO
        41 002232   000036 237000 42                 LDAQ    30
        41 002233   200124 757100                    STAQ    LNO+4,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:118  
        41 002234   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002235   200123 450500                    STP0    LNO+3,,AUTO
        41 002236   200123 630500                    EPPR0   LNO+3,,AUTO
        41 002237   000012 631400 42                 EPPR1   10
        41 002240   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 002241   000000 011000                    NOP     0

      542     2184    4                   END; /* THEN DO */

   2184 41 002242   006306 710000 41                 TRA     s:2929

      543     2185    4               ELSE DO;

      544     2186    5                   IF UWA.RC.CALCDUP = 0 THEN DO; /* 0= DUPS ALLOWED */

   2186 41 002243   000277 235000 39                 LDA     UWA+191
        41 002244   002312 601000 41                 TNZ     s:2193

      545     2187    5                       CALL FETCHD_6('RC      ',THIS_SN_SO_RC);

   2187 41 002245   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 002246   200123 450500                    STP0    LNO+3,,AUTO
        41 002247   000007 236000 42                 LDQ     7
        41 002250   200122 756100                    STQ     LNO+2,,AUTO
        41 002251   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002252   000000 631400 42                 EPPR1   0
        41 002253   000000 701000 xent               TSX1    FETCHD_6
        41 002254   000000 011000                    NOP     0

      546     2188    5                       CALL FETCHOS_6('SN-SE   ');

   2188 41 002255   000027 630400 42                 EPPR0   23
        41 002256   000003 631400 42                 EPPR1   3
        41 002257   000000 701000 xent               TSX1    FETCHOS_6
        41 002260   000000 011000                    NOP     0

      547     2189    5                       CALL INDEX(CT1,' ',UWA.SN.SENAME);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:119  

   2189 41 002261   000000 124400                    SCM     mask='000'O
        41 002262   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 002263   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 002264   200005 000100                    ARG     CT1,,AUTO

      548     2190    5                       CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   2190 41 002265   000024 236000 42                 LDQ     20
        41 002266   200124 756100                    STQ     LNO+4,,AUTO
        41 002267   200005 630500                    EPPR0   CT1,,AUTO
        41 002270   200123 450500                    STP0    LNO+3,,AUTO
        41 002271   000014 236000 42                 LDQ     12
        41 002272   200122 756100                    STQ     LNO+2,,AUTO
        41 002273   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002274   000012 631400 42                 EPPR1   10
        41 002275   000000 701000 xent               TSX1    SET_FIELDS
        41 002276   000000 011000                    NOP     0

      549     2191    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4835);

   2191 41 002277   200120 235100                    LDA     LNO,,AUTO
        41 002300   000001 135007                    SBLA    1,DL
        41 002301   200122 755100                    STA     LNO+2,,AUTO
        41 002302   000040 237000 42                 LDAQ    32
        41 002303   200124 757100                    STAQ    LNO+4,,AUTO
        41 002304   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002305   200123 450500                    STP0    LNO+3,,AUTO
        41 002306   200123 630500                    EPPR0   LNO+3,,AUTO
        41 002307   000012 631400 42                 EPPR1   10
        41 002310   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 002311   000000 011000                    NOP     0

      550     2192    5                       END;

      551     2193    4                   CALL FINDPS_6('RC-SOSM '); /* SM in *calc set */

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:120  
   2193 41 002312   000033 630400 42                 EPPR0   27
        41 002313   000003 631400 42                 EPPR1   3
        41 002314   000000 701000 xent               TSX1    FINDPS_6
        41 002315   000000 011000                    NOP     0

      552     2194    4                   DBK_SM_CALC = UWA.DIRECT_REF;

   2194 41 002316   000036 235000 39                 LDA     UWA+30
        41 002317   200012 755100                    STA     DBK_SM_CALC,,AUTO

      553     2195    4                   CALL FCURR_R_6('S-S     ');

   2195 41 002320   000043 630400 42                 EPPR0   35
        41 002321   000003 631400 42                 EPPR1   3
        41 002322   000000 701000 xent               TSX1    FCURR_R_6
        41 002323   000000 011000                    NOP     0

      554     2196    4                   CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);

   2196 41 002324   000122 630400 42                 EPPR0   82
        41 002325   000000 631400 42                 EPPR1   0
        41 002326   000000 701000 xent               TSX1    FETCHD_6
        41 002327   000000 011000                    NOP     0

      555     2197    4                   UWA.S_S.SOSM_SSH = DBK_SM_CALC;

   2197 41 002330   200012 235100                    LDA     DBK_SM_CALC,,AUTO
        41 002331   000376 755000 39                 STA     UWA+254

      556     2198    4                   UWA.S_S.SC_SSH = THIS_SN_SC;

   2198 41 002332   200030 236100                    LDQ     THIS_SN_SC,,AUTO
        41 002333   000375 756000 39                 STQ     UWA+253

      557     2199    4                   UWA.S_S.STYP = 3; /* change from current to member */

   2199 41 002334   000003 235007                    LDA     3,DL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:121  
        41 002335   000374 755000 39                 STA     UWA+252

      558     2200    4                   CALL MODIFY_6('S-S     ');

   2200 41 002336   000043 630400 42                 EPPR0   35
        41 002337   000003 631400 42                 EPPR1   3
        41 002340   000000 701000 xent               TSX1    MODIFY_6
        41 002341   000000 011000                    NOP     0

      559     2201    4                   UWA.S_S.STYP = 4; /* scan */

   2201 41 002342   000004 235007                    LDA     4,DL
        41 002343   000374 755000 39                 STA     UWA+252

      560     2202    4                   CALL STRE_6('S-S     ');

   2202 41 002344   000043 630400 42                 EPPR0   35
        41 002345   000003 631400 42                 EPPR1   3
        41 002346   000000 701000 xent               TSX1    STRE_6
        41 002347   000000 011000                    NOP     0

      561     2203    4                   UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;

   2203 41 002350   000223 054000 39                 AOS     UWA+147

      562     2204    4                   CALL FINDD_6('SM      ',DBK_SM_CALC);

   2204 41 002351   200012 630500                    EPPR0   DBK_SM_CALC,,AUTO
        41 002352   200123 450500                    STP0    LNO+3,,AUTO
        41 002353   000030 236000 42                 LDQ     24
        41 002354   200122 756100                    STQ     LNO+2,,AUTO
        41 002355   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002356   000000 631400 42                 EPPR1   0
        41 002357   000000 701000 xent               TSX1    FINDD_6
        41 002360   000000 011000                    NOP     0

      563     2205         /* SM in calc set for this owner rec */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:122  
      564     2206    4                  CALL FINDNS_6('SMSS-CF '); /* CF of first calc field in owner rec */

   2206 41 002361   000117 630400 42                 EPPR0   79
        41 002362   000003 631400 42                 EPPR1   3
        41 002363   000000 701000 xent               TSX1    FINDNS_6
        41 002364   000000 011000                    NOP     0

      565     2207    4                   DBK_CALC_CF = UWA.DIRECT_REF;

   2207 41 002365   000036 235000 39                 LDA     UWA+30
        41 002366   200017 755100                    STA     DBK_CALC_CF,,AUTO

      566     2208    4                   UWA.NR.IMPLCT = IMPLCT;

   2208 41 002367   000000 236000 17                 LDQ     IMPLCT
        41 002370   000467 756000 39                 STQ     UWA+311

      567     2209    4                   UWA.NR.RELTYPE = RELTYPE.SS;

   2209 41 002371   000011 235000 17                 LDA     RELTYPE+6
        41 002372   000470 755000 39                 STA     UWA+312

      568     2210    4                   UWA.NR.LNO = LNO;

   2210 41 002373   200120 235100                    LDA     LNO,,AUTO
        41 002374   000471 755000 39                 STA     UWA+313

      569     2211    5                   DO WHILE (UWA.DB_STATUS = '0000000');

   2211 41 002375   040000 106400                    CMPC    fill='040'O
        41 002376   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 002377   000046 000007 40                 ADSC9   38                       cn=0,n=7
        41 002400   006306 601000 41                 TNZ     s:2929

      570     2212         /* for each calc field in owner rec */
      571     2213    5                       CALL FINDOS_6('FR-CFS  '); /* FR of calc field */

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:123  
   2213 41 002401   000124 630400 42                 EPPR0   84
        41 002402   000003 631400 42                 EPPR1   3
        41 002403   000000 701000 xent               TSX1    FINDOS_6
        41 002404   000000 011000                    NOP     0

      572     2214    5                       HOLD_DBK = UWA.DIRECT_REF;

   2214 41 002405   000036 235000 39                 LDA     UWA+30
        41 002406   200010 755100                    STA     HOLD_DBK,,AUTO

      573     2215    5                       UWA.C_F = '0'B;

   2215 41 002407   000000 100400                    MLR     fill='000'O
        41 002410   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 002411   000400 000024 39                 ADSC9   UWA+256                  cn=0,n=20

      574     2216    5                       UWA.C_F.CTRLTYPE = 2; /* set selection */

   2216 41 002412   000002 236007                    LDQ     2,DL
        41 002413   000401 756000 39                 STQ     UWA+257

      575     2217    5                       CALL STRE_6('C-F     ');

   2217 41 002414   000114 630400 42                 EPPR0   76
        41 002415   000003 631400 42                 EPPR1   3
        41 002416   000000 701000 xent               TSX1    STRE_6
        41 002417   000000 011000                    NOP     0

      576     2218    5                       UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   2218 41 002420   000224 054000 39                 AOS     UWA+148

      577     2219    5                       CALL CONNECT_6('SSSM-CF ');

   2219 41 002421   000115 630400 42                 EPPR0   77
        41 002422   000003 631400 42                 EPPR1   3
        41 002423   000000 701000 xent               TSX1    CONNECT_6
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:124  
        41 002424   000000 011000                    NOP     0

      578     2220    5                       CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   2220 41 002425   000126 237000 42                 LDAQ    86
        41 002426   200124 757100                    STAQ    LNO+4,,AUTO
        41 002427   000124 236000 42                 LDQ     84
        41 002430   200123 756100                    STQ     LNO+3,,AUTO
        41 002431   200010 630500                    EPPR0   HOLD_DBK,,AUTO
        41 002432   200122 450500                    STP0    LNO+2,,AUTO
        41 002433   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002434   000125 631400 42                 EPPR1   85
        41 002435   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        41 002436   000000 011000                    NOP     0

      579     2221    5                          'FR      ', 'C-F     ' );
      580     2222         /* add implicit NR */
      581     2223    5                       CALL FINDOS_6('SN-SE   '); /* calc field SN */

   2223 41 002437   000027 630400 42                 EPPR0   23
        41 002440   000003 631400 42                 EPPR1   3
        41 002441   000000 701000 xent               TSX1    FINDOS_6
        41 002442   000000 011000                    NOP     0

      582     2224    5                       CALL STRE_6('NR      ');

   2224 41 002443   000130 630400 42                 EPPR0   88
        41 002444   000003 631400 42                 EPPR1   3
        41 002445   000000 701000 xent               TSX1    STRE_6
        41 002446   000000 011000                    NOP     0

      583     2225    5                       CALL FINDD_6('SN      ',LAST_DEF_SET_DBK); /* SN of setname */

   2225 41 002447   000131 630400 42                 EPPR0   89
        41 002450   000000 631400 42                 EPPR1   0
        41 002451   000000 701000 xent               TSX1    FINDD_6
        41 002452   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:125  

      584     2226    5                       CALL FCURR_R_6('NR      ');

   2226 41 002453   000130 630400 42                 EPPR0   88
        41 002454   000003 631400 42                 EPPR1   3
        41 002455   000000 701000 xent               TSX1    FCURR_R_6
        41 002456   000000 011000                    NOP     0

      585     2227    5                       CALL CONNECT_6('SN-NRWU ');

   2227 41 002457   000021 630400 42                 EPPR0   17
        41 002460   000003 631400 42                 EPPR1   3
        41 002461   000000 701000 xent               TSX1    CONNECT_6
        41 002462   000000 011000                    NOP     0

      586     2228    5                       UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;

   2228 41 002463   000407 054000 39                 AOS     UWA+263

      587     2229    5                       CALL FINDD_6('C-F     ',DBK_CALC_CF);
              2229                                /* go do next calc field */

   2229 41 002464   200017 630500                    EPPR0   DBK_CALC_CF,,AUTO
        41 002465   200123 450500                    STP0    LNO+3,,AUTO
        41 002466   000114 236000 42                 LDQ     76
        41 002467   200122 756100                    STQ     LNO+2,,AUTO
        41 002470   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002471   000000 631400 42                 EPPR1   0
        41 002472   000000 701000 xent               TSX1    FINDD_6
        41 002473   000000 011000                    NOP     0

      588     2230    5                       CALL FINDNS_6('SMSS-CF '); /* CF */

   2230 41 002474   000117 630400 42                 EPPR0   79
        41 002475   000003 631400 42                 EPPR1   3
        41 002476   000000 701000 xent               TSX1    FINDNS_6
        41 002477   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:126  

      589     2231    5                       DBK_CALC_CF = UWA.DIRECT_REF;

   2231 41 002500   000036 235000 39                 LDA     UWA+30
        41 002501   200017 755100                    STA     DBK_CALC_CF,,AUTO

      590     2232    5                       END; /* WHILE */

   2232 41 002502   040000 106400                    CMPC    fill='040'O
        41 002503   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 002504   000046 000007 40                 ADSC9   38                       cn=0,n=7
        41 002505   002401 600000 41                 TZE     s:2213

      591     2233    4                   END; /* ELSE DO */

   2233 41 002506   006306 710000 41                 TRA     s:2929

      592     2234        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:127  
      593     2235        /*****************************************************************/
      594     2236    3           CASE(%DBK_EQ); /* DBKEY EQUAL TO dbid/dbparam */

      595     2237         /* -change the existing SS to type direct
      596     2238            -add SN (if necessary) and NR
      597     2239            -if this is a dbid then just fetch the RFR,otherwise build RFR
      598     2240            -make sure the type is dbkey
      599     2241            -build CF and connect it to the SS
      600     2242         */
      601     2243    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2243 41 002507   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 002510   000001 036003                    ADLQ    1,DU
        41 002511   200116 756100                    STQ     DYNMEM$,,AUTO

      602     2244    3               LNO = DYNMEM$->WRD1;

   2244 41 002512   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 002513   000000 235100                    LDA     0,,PR0
        41 002514   200120 755100                    STA     LNO,,AUTO

      603     2245    4               IF UWA.RC.PSMODE ~= 0 THEN DO; /* not LOC MODE DIRECT */

   2245 41 002515   000271 235000 39                 LDA     UWA+185
        41 002516   002630 600000 41                 TZE     s:2266

      604     2246    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);

   2246 41 002517   200032 631500                    EPPR1   THIS_SN_SO_RC,,AUTO
        41 002520   200123 451500                    STP1    LNO+3,,AUTO
        41 002521   000007 236000 42                 LDQ     7
        41 002522   200122 756100                    STQ     LNO+2,,AUTO
        41 002523   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002524   000000 631400 42                 EPPR1   0
        41 002525   000000 701000 xent               TSX1    FETCHD_6
        41 002526   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:128  
      605     2247    4                   CALL FETCHOS_6('SN-SE   ');

   2247 41 002527   000027 630400 42                 EPPR0   23
        41 002530   000003 631400 42                 EPPR1   3
        41 002531   000000 701000 xent               TSX1    FETCHOS_6
        41 002532   000000 011000                    NOP     0

      606     2248    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);

   2248 41 002533   000000 124400                    SCM     mask='000'O
        41 002534   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 002535   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 002536   200005 000100                    ARG     CT1,,AUTO

      607     2249    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   2249 41 002537   000024 236000 42                 LDQ     20
        41 002540   200124 756100                    STQ     LNO+4,,AUTO
        41 002541   200005 630500                    EPPR0   CT1,,AUTO
        41 002542   200123 450500                    STP0    LNO+3,,AUTO
        41 002543   000014 236000 42                 LDQ     12
        41 002544   200122 756100                    STQ     LNO+2,,AUTO
        41 002545   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002546   000012 631400 42                 EPPR1   10
        41 002547   000000 701000 xent               TSX1    SET_FIELDS
        41 002550   000000 011000                    NOP     0

      608     2250    4                   CALL FETCHD_6('SN      ',THIS_SN);

   2250 41 002551   200027 630500                    EPPR0   THIS_SN,,AUTO
        41 002552   200123 450500                    STP0    LNO+3,,AUTO
        41 002553   000010 236000 42                 LDQ     8
        41 002554   200122 756100                    STQ     LNO+2,,AUTO
        41 002555   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002556   000000 631400 42                 EPPR1   0
        41 002557   000000 701000 xent               TSX1    FETCHD_6
        41 002560   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:129  

      609     2251    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);

   2251 41 002561   000000 124400                    SCM     mask='000'O
        41 002562   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 002563   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 002564   200006 000100                    ARG     CT2,,AUTO

      610     2252    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);

   2252 41 002565   000024 236000 42                 LDQ     20
        41 002566   200124 756100                    STQ     LNO+4,,AUTO
        41 002567   200006 630500                    EPPR0   CT2,,AUTO
        41 002570   200123 450500                    STP0    LNO+3,,AUTO
        41 002571   000020 236000 42                 LDQ     16
        41 002572   200122 756100                    STQ     LNO+2,,AUTO
        41 002573   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002574   000012 631400 42                 EPPR1   10
        41 002575   000000 701000 xent               TSX1    SET_FIELDS
        41 002576   000000 011000                    NOP     0

      611     2253    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4816);

   2253 41 002577   200120 235100                    LDA     LNO,,AUTO
        41 002600   000001 135007                    SBLA    1,DL
        41 002601   200122 755100                    STA     LNO+2,,AUTO
        41 002602   000134 237000 42                 LDAQ    92
        41 002603   200124 757100                    STAQ    LNO+4,,AUTO
        41 002604   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002605   200123 450500                    STP0    LNO+3,,AUTO
        41 002606   200123 630500                    EPPR0   LNO+3,,AUTO
        41 002607   000012 631400 42                 EPPR1   10
        41 002610   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 002611   000000 011000                    NOP     0

      612     2254        /*E*  ERROR: ZIG-4816-C
      613     2255            MESSAGE: The set selection clause is invalid because the owner
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:130  
      614     2256                     record "%U1" of set "%U2" does not have LOC MODE DIRECT.
      615     2257        */
      616     2258    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   2258 41 002612   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 002613   000001 036003                    ADLQ    1,DU
        41 002614   200116 756100                    STQ     DYNMEM$,,AUTO

      617     2259    4                   DYNMEM$ = PINCRW(DYNMEM$,8);

   2259 41 002615   000010 036003                    ADLQ    8,DU
        41 002616   200116 756100                    STQ     DYNMEM$,,AUTO

      618     2260    5                   IF DYNMEM$->WRD1 = %QUAL THEN DO;

   2260 41 002617   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 002620   000000 235100                    LDA     0,,PR0
        41 002621   000113 115007                    CMPA    75,DL
        41 002622   006306 601000 41                 TNZ     s:2929

      619     2261    5                       DYNMEM$ = PINCRW(DYNMEM$,1);

   2261 41 002623   000001 036003                    ADLQ    1,DU
        41 002624   200116 756100                    STQ     DYNMEM$,,AUTO

      620     2262    5                       DYNMEM$ = PINCRW(DYNMEM$,8);

   2262 41 002625   000010 036003                    ADLQ    8,DU
        41 002626   200116 756100                    STQ     DYNMEM$,,AUTO

      621     2263    5                       END;

      622     2264    4                   END;

   2264 41 002627   006306 710000 41                 TRA     s:2929

      623     2265    4               ELSE DO;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:131  

      624     2266    4                   CALL FCURR_R_6('S-S     '); /* SS */

   2266 41 002630   000043 630400 42                 EPPR0   35
        41 002631   000003 631400 42                 EPPR1   3
        41 002632   000000 701000 xent               TSX1    FCURR_R_6
        41 002633   000000 011000                    NOP     0

      625     2267    4                   CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);

   2267 41 002634   000122 630400 42                 EPPR0   82
        41 002635   000000 631400 42                 EPPR1   0
        41 002636   000000 701000 xent               TSX1    FETCHD_6
        41 002637   000000 011000                    NOP     0

      626     2268    4                   UWA.S_S.SC_SSH = THIS_SN_SC;

   2268 41 002640   200030 235100                    LDA     THIS_SN_SC,,AUTO
        41 002641   000375 755000 39                 STA     UWA+253

      627     2269    4                   UWA.S_S.SOSM_SSH = THIS_SN_SO;

   2269 41 002642   200031 236100                    LDQ     THIS_SN_SO,,AUTO
        41 002643   000376 756000 39                 STQ     UWA+254

      628     2270    4                   UWA.S_S.STYP = 1; /* DIRECT */

   2270 41 002644   000001 235007                    LDA     1,DL
        41 002645   000374 755000 39                 STA     UWA+252

      629     2271    4                   CALL MODIFY_6('S-S     ');

   2271 41 002646   000043 630400 42                 EPPR0   35
        41 002647   000003 631400 42                 EPPR1   3
        41 002650   000000 701000 xent               TSX1    MODIFY_6
        41 002651   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:132  
      630     2272    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   2272 41 002652   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 002653   000001 036003                    ADLQ    1,DU
        41 002654   200116 756100                    STQ     DYNMEM$,,AUTO

      631     2273    4                   FR_NAME = DYNMEM$->CHAR30;

   2273 41 002655   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 002656   040100 100500                    MLR     fill='040'O
        41 002657   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 002660   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30

      632     2274    4                   DYNMEM$ = PINCRW(DYNMEM$,8);

   2274 41 002661   000010 036003                    ADLQ    8,DU
        41 002662   200116 756100                    STQ     DYNMEM$,,AUTO

      633     2275    4                   FLAG_ERR = '0'B;

   2275 41 002663   200114 450100                    STZ     FLAG_ERR,,AUTO

      634     2276    4                   IF DYNMEM$->WRD1 = %QUAL THEN

   2276 41 002664   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 002665   000000 235100                    LDA     0,,PR0
        41 002666   000113 115007                    CMPA    75,DL
        41 002667   002765 601000 41                 TNZ     s:2294

      635     2277    5                   DO;

      636     2278    5                       DYNMEM$ = PINCRW(DYNMEM$,1);

   2278 41 002670   000001 036003                    ADLQ    1,DU
        41 002671   200116 756100                    STQ     DYNMEM$,,AUTO

      637     2279    5                       QRC_NAME = DYNMEM$->CHAR30;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:133  

   2279 41 002672   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 002673   040100 100500                    MLR     fill='040'O
        41 002674   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 002675   200046 000036                    ADSC9   QRC_NAME,,AUTO           cn=0,n=30

      638     2280    5                       DYNMEM$ = PINCRW(DYNMEM$,8);

   2280 41 002676   000010 036003                    ADLQ    8,DU
        41 002677   200116 756100                    STQ     DYNMEM$,,AUTO

      639     2281    5                      CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0
              2281                                )

   2281 41 002700   000052 237000 42                 LDAQ    42
        41 002701   200130 757100                    STAQ    LNO+8,,AUTO
        41 002702   000054 237000 42                 LDAQ    44
        41 002703   200126 757100                    STAQ    LNO+6,,AUTO
        41 002704   200120 630500                    EPPR0   LNO,,AUTO
        41 002705   200125 450500                    STP0    LNO+5,,AUTO
        41 002706   000052 236000 42                 LDQ     42
        41 002707   200124 756100                    STQ     LNO+4,,AUTO
        41 002710   200046 631500                    EPPR1   QRC_NAME,,AUTO
        41 002711   200123 451500                    STP1    LNO+3,,AUTO
        41 002712   000056 236000 42                 LDQ     46
        41 002713   200122 756100                    STQ     LNO+2,,AUTO
        41 002714   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002715   000045 631400 42                 EPPR1   37
        41 002716   000000 701000 xent               TSX1    ADD_SN
        41 002717   000000 011000                    NOP     0

      640     2282    5                          ;
      641     2283    5                       IF FOUND ~= %FOUNDDEF THEN

   2283 41 002720   000002 235000 17                 LDA     FOUND
        41 002721   000002 115007                    CMPA    2,DL
        41 002722   002756 600000 41                 TZE     s:2290
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:134  

      642     2284    6                       DO;

      643     2285    6                           FLAG_ERR = '1'B;

   2285 41 002723   400000 236003                    LDQ     -131072,DU
        41 002724   200114 756100                    STQ     FLAG_ERR,,AUTO

      644     2286    6                           CALL INDEX(CT1,' ',FR_NAME);

   2286 41 002725   000000 124500                    SCM     mask='000'O
        41 002726   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 002727   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 002730   200005 000100                    ARG     CT1,,AUTO

      645     2287    6                           CALL SET_FIELDS(1,CT1,FR_NAME);

   2287 41 002731   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 002732   200124 450500                    STP0    LNO+4,,AUTO
        41 002733   200005 631500                    EPPR1   CT1,,AUTO
        41 002734   200123 451500                    STP1    LNO+3,,AUTO
        41 002735   000014 236000 42                 LDQ     12
        41 002736   200122 756100                    STQ     LNO+2,,AUTO
        41 002737   200122 630500                    EPPR0   LNO+2,,AUTO
        41 002740   000012 631400 42                 EPPR1   10
        41 002741   000000 701000 xent               TSX1    SET_FIELDS
        41 002742   000000 011000                    NOP     0

      646     2288    6                           CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4809);
              2288                                    /*qualifying RC not DEFed */

   2288 41 002743   200120 235100                    LDA     LNO,,AUTO
        41 002744   000001 135007                    SBLA    1,DL
        41 002745   200122 755100                    STA     LNO+2,,AUTO
        41 002746   000060 237000 42                 LDAQ    48
        41 002747   200124 757100                    STAQ    LNO+4,,AUTO
        41 002750   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:135  
        41 002751   200123 450500                    STP0    LNO+3,,AUTO
        41 002752   200123 630500                    EPPR0   LNO+3,,AUTO
        41 002753   000012 631400 42                 EPPR1   10
        41 002754   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 002755   000000 011000                    NOP     0

      647     2289    6                           END;

      648     2290    5                       CALL FINDNS_6('SN-SE   '); /* RC */

   2290 41 002756   000027 630400 42                 EPPR0   23
        41 002757   000003 631400 42                 EPPR1   3
        41 002760   000000 701000 xent               TSX1    FINDNS_6
        41 002761   000000 011000                    NOP     0

      649     2291    5                       QRC_DBK = UWA.DIRECT_REF;

   2291 41 002762   000036 235000 39                 LDA     UWA+30
        41 002763   200045 755100                    STA     QRC_DBK,,AUTO

      650     2292    5                       END;

   2292 41 002764   002766 710000 41                 TRA     s:2295

      651     2293    4                   ELSE
      652     2294    4                       QRC_DBK = 0; /* not qualified */

   2294 41 002765   200045 450100                    STZ     QRC_DBK,,AUTO

      653     2295    5                   IF NOT FLAG_ERR THEN DO;

   2295 41 002766   200114 234100                    SZN     FLAG_ERR,,AUTO
        41 002767   006306 604000 41                 TMI     s:2929

      654     2296    5                       CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,

   2296 41 002770   200045 630500                    EPPR0   QRC_DBK,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:136  
        41 002771   200131 450500                    STP0    LNO+9,,AUTO
        41 002772   000063 236000 42                 LDQ     51
        41 002773   200130 756100                    STQ     LNO+8,,AUTO
        41 002774   000064 237000 42                 LDAQ    52
        41 002775   200126 757100                    STAQ    LNO+6,,AUTO
        41 002776   200120 631500                    EPPR1   LNO,,AUTO
        41 002777   200125 451500                    STP1    LNO+5,,AUTO
        41 003000   000052 236000 42                 LDQ     42
        41 003001   200124 756100                    STQ     LNO+4,,AUTO
        41 003002   200035 633500                    EPPR3   FR_NAME,,AUTO
        41 003003   200123 453500                    STP3    LNO+3,,AUTO
        41 003004   000066 236000 42                 LDQ     54
        41 003005   200122 756100                    STQ     LNO+2,,AUTO
        41 003006   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003007   000045 631400 42                 EPPR1   37
        41 003010   000000 701000 xent               TSX1    ADD_SN
        41 003011   000000 011000                    NOP     0

      655     2297    5                          RELTYPE.SS,EXPLCT,QRC_DBK);
      656     2298    5                       IF FOUND = %FOUNDDUP THEN

   2298 41 003012   000002 235000 17                 LDA     FOUND
        41 003013   000003 115007                    CMPA    3,DL
        41 003014   003061 601000 41                 TNZ     s:2309

      657     2299    6                       DO;

      658     2300    6                           CALL FCURR_R_6('NR      ');

   2300 41 003015   000130 630400 42                 EPPR0   88
        41 003016   000003 631400 42                 EPPR1   3
        41 003017   000000 701000 xent               TSX1    FCURR_R_6
        41 003020   000000 011000                    NOP     0

      659     2301    6                           CALL ERASE_6('NR      ');

   2301 41 003021   000130 630400 42                 EPPR0   88
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:137  
        41 003022   000003 631400 42                 EPPR1   3
        41 003023   000000 701000 xent               TSX1    ERASE_6
        41 003024   000000 011000                    NOP     0

      660     2302    6                           UWA.DA.NUMB_NR = UWA.DA.NUMB_NR - 1;

   2302 41 003025   000001 336007                    LCQ     1,DL
        41 003026   000407 056000 39                 ASQ     UWA+263

      661     2303    6                           CALL INDEX(CT1,' ',FR_NAME);

   2303 41 003027   000000 124500                    SCM     mask='000'O
        41 003030   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 003031   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 003032   200005 000100                    ARG     CT1,,AUTO

      662     2304    6                           CALL SET_FIELDS(1,CT1,FR_NAME);

   2304 41 003033   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 003034   200124 450500                    STP0    LNO+4,,AUTO
        41 003035   200005 631500                    EPPR1   CT1,,AUTO
        41 003036   200123 451500                    STP1    LNO+3,,AUTO
        41 003037   000014 236000 42                 LDQ     12
        41 003040   200122 756100                    STQ     LNO+2,,AUTO
        41 003041   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003042   000012 631400 42                 EPPR1   10
        41 003043   000000 701000 xent               TSX1    SET_FIELDS
        41 003044   000000 011000                    NOP     0

      663     2305    6                           CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4801); /* needs qualifier */

   2305 41 003045   200120 235100                    LDA     LNO,,AUTO
        41 003046   000001 135007                    SBLA    1,DL
        41 003047   200122 755100                    STA     LNO+2,,AUTO
        41 003050   000070 237000 42                 LDAQ    56
        41 003051   200124 757100                    STAQ    LNO+4,,AUTO
        41 003052   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:138  
        41 003053   200123 450500                    STP0    LNO+3,,AUTO
        41 003054   200123 630500                    EPPR0   LNO+3,,AUTO
        41 003055   000012 631400 42                 EPPR1   10
        41 003056   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 003057   000000 011000                    NOP     0

      664     2306    6                           END;

   2306 41 003060   006306 710000 41                 TRA     s:2929

      665     2307    6                       ELSE DO;

      666     2308         /* if qualified but not found then error */
      667     2309    6                           IF QRC_DBK ~= 0 AND FOUND = %NOTFOUND THEN

   2309 41 003061   200045 236100                    LDQ     QRC_DBK,,AUTO
        41 003062   003117 600000 41                 TZE     s:2316
        41 003063   000000 115003                    CMPA    0,DU
        41 003064   003117 601000 41                 TNZ     s:2316

      668     2310    7                           DO;

      669     2311    7                               CALL INDEX(CT1,' ',FR_NAME);

   2311 41 003065   000000 124500                    SCM     mask='000'O
        41 003066   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 003067   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 003070   200005 000100                    ARG     CT1,,AUTO

      670     2312    7                               CALL SET_FIELDS(1,CT1,FR_NAME);

   2312 41 003071   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 003072   200124 450500                    STP0    LNO+4,,AUTO
        41 003073   200005 631500                    EPPR1   CT1,,AUTO
        41 003074   200123 451500                    STP1    LNO+3,,AUTO
        41 003075   000014 236000 42                 LDQ     12
        41 003076   200122 756100                    STQ     LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:139  
        41 003077   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003100   000012 631400 42                 EPPR1   10
        41 003101   000000 701000 xent               TSX1    SET_FIELDS
        41 003102   000000 011000                    NOP     0

      671     2313    7                               CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4838);

   2313 41 003103   200120 235100                    LDA     LNO,,AUTO
        41 003104   000001 135007                    SBLA    1,DL
        41 003105   200122 755100                    STA     LNO+2,,AUTO
        41 003106   000074 237000 42                 LDAQ    60
        41 003107   200124 757100                    STAQ    LNO+4,,AUTO
        41 003110   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003111   200123 450500                    STP0    LNO+3,,AUTO
        41 003112   200123 630500                    EPPR0   LNO+3,,AUTO
        41 003113   000012 631400 42                 EPPR1   10
        41 003114   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 003115   000000 011000                    NOP     0

      672     2314    7                               END;

   2314 41 003116   006306 710000 41                 TRA     s:2929

      673     2315    7                           ELSE DO;

      674     2316    7                               DBK_SN = UWA.DIRECT_REF;

   2316 41 003117   000036 235000 39                 LDA     UWA+30
        41 003120   200023 755100                    STA     DBK_SN,,AUTO

      675     2317    7                               UWA.C_F = '0'B;

   2317 41 003121   000000 100400                    MLR     fill='000'O
        41 003122   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 003123   000400 000024 39                 ADSC9   UWA+256                  cn=0,n=20

      676     2318    7                               UWA.C_F.SYN = 0;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:140  

   2318 41 003124   000400 450000 39                 STZ     UWA+256

      677     2319    7                               UWA.C_F.CTRLTYPE = 2; /* set selection */

   2319 41 003125   000002 235007                    LDA     2,DL
        41 003126   000401 755000 39                 STA     UWA+257

      678     2320         /* if not found, then this is a dbparam and we need
      679     2321            to build a RFR */
      680     2322    7                               FLAG_ERR = '0'B;

   2322 41 003127   200114 450100                    STZ     FLAG_ERR,,AUTO

      681     2323    8                               IF FOUND = %NOTFOUND THEN DO;

   2323 41 003130   000002 235000 17                 LDA     FOUND
        41 003131   003172 601000 41                 TNZ     s:2338

      682     2324    8                                   CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);
              2324                                            /* RC */

   2324 41 003132   000076 630400 42                 EPPR0   62
        41 003133   000000 631400 42                 EPPR1   0
        41 003134   000000 701000 xent               TSX1    FINDD_6
        41 003135   000000 011000                    NOP     0

      683     2325    8                                   UWA.FR = '0'B;

   2325 41 003136   000000 100400                    MLR     fill='000'O
        41 003137   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 003140   000332 000104 39                 ADSC9   UWA+218                  cn=0,n=68

      684     2326    8                                   UWA.FR.REF = 1;

   2326 41 003141   000001 235007                    LDA     1,DL
        41 003142   000333 755000 39                 STA     UWA+219
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:141  

      685     2327    8                                   UWA.FR.PREC = 35;

   2327 41 003143   000043 236007                    LDQ     35,DL
        41 003144   000335 756000 39                 STQ     UWA+221

      686     2328    8                                   UWA.FR.F_USE = 1;

   2328 41 003145   000343 755000 39                 STA     UWA+227

      687     2329    8                                   CALL FINDD_6('SN      ',DBK_SN);

   2329 41 003146   200023 630500                    EPPR0   DBK_SN,,AUTO
        41 003147   200123 450500                    STP0    LNO+3,,AUTO
        41 003150   000010 236000 42                 LDQ     8
        41 003151   200122 756100                    STQ     LNO+2,,AUTO
        41 003152   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003153   000000 631400 42                 EPPR1   0
        41 003154   000000 701000 xent               TSX1    FINDD_6
        41 003155   000000 011000                    NOP     0

      688     2330    8                                   CALL STRE_6('FR      '); /* RFR */

   2330 41 003156   000073 630400 42                 EPPR0   59
        41 003157   000003 631400 42                 EPPR1   3
        41 003160   000000 701000 xent               TSX1    STRE_6
        41 003161   000000 011000                    NOP     0

      689     2331    8                                   HOLD_DBK = UWA.DIRECT_REF;

   2331 41 003162   000036 235000 39                 LDA     UWA+30
        41 003163   200010 755100                    STA     HOLD_DBK,,AUTO

      690     2332    8                                   UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   2332 41 003164   000220 054000 39                 AOS     UWA+144

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:142  
      691     2333    8                                   CALL CONNECT_6('SN-SE   ');

   2333 41 003165   000027 630400 42                 EPPR0   23
        41 003166   000003 631400 42                 EPPR1   3
        41 003167   000000 701000 xent               TSX1    CONNECT_6
        41 003170   000000 011000                    NOP     0

      692     2334    8                                   END;

   2334 41 003171   003235 710000 41                 TRA     s:2352

      693     2335         /* if found, then it is either a dbid or a dbparam
      694     2336            that has already been mentioned previously */
      695     2337    8                               ELSE DO;

      696     2338    8                                   CALL FETCHNS_6('SN-SE   '); /* FR */

   2338 41 003172   000027 630400 42                 EPPR0   23
        41 003173   000003 631400 42                 EPPR1   3
        41 003174   000000 701000 xent               TSX1    FETCHNS_6
        41 003175   000000 011000                    NOP     0

      697     2339    8                                   HOLD_DBK = UWA.DIRECT_REF;

   2339 41 003176   000036 235000 39                 LDA     UWA+30
        41 003177   200010 755100                    STA     HOLD_DBK,,AUTO

      698     2340    9                                   IF UWA.FR.FTYPE ~= 0 THEN DO; /* has to be dbkey */

   2340 41 003200   000334 236000 39                 LDQ     UWA+220
        41 003201   003235 600000 41                 TZE     s:2352

      699     2341    9                                       FLAG_ERR = '1'B;

   2341 41 003202   400000 236003                    LDQ     -131072,DU
        41 003203   200114 756100                    STQ     FLAG_ERR,,AUTO

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:143  
      700     2342    9                                       CALL INDEX(CT1,' ',FR_NAME);

   2342 41 003204   000000 124500                    SCM     mask='000'O
        41 003205   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 003206   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 003207   200005 000100                    ARG     CT1,,AUTO

      701     2343    9                                       CALL SET_FIELDS(1,CT1,FR_NAME);

   2343 41 003210   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 003211   200124 450500                    STP0    LNO+4,,AUTO
        41 003212   200005 631500                    EPPR1   CT1,,AUTO
        41 003213   200123 451500                    STP1    LNO+3,,AUTO
        41 003214   000014 236000 42                 LDQ     12
        41 003215   200122 756100                    STQ     LNO+2,,AUTO
        41 003216   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003217   000012 631400 42                 EPPR1   10
        41 003220   000000 701000 xent               TSX1    SET_FIELDS
        41 003221   000000 011000                    NOP     0

      702     2344    9                                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4815);

   2344 41 003222   200120 235100                    LDA     LNO,,AUTO
        41 003223   000001 135007                    SBLA    1,DL
        41 003224   200122 755100                    STA     LNO+2,,AUTO
        41 003225   000140 237000 42                 LDAQ    96
        41 003226   200124 757100                    STAQ    LNO+4,,AUTO
        41 003227   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003230   200123 450500                    STP0    LNO+3,,AUTO
        41 003231   200123 630500                    EPPR0   LNO+3,,AUTO
        41 003232   000012 631400 42                 EPPR1   10
        41 003233   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 003234   000000 011000                    NOP     0

      703     2345        /*E*  ERROR:  ZIG-4815-C
      704     2346                     MESSAGE:  The SET SELECTION clause is invalid because the EQUAL TO
      705     2347                               field "%U1" does not have a data type of DATA_BASE_KEY.
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:144  
      706     2348        */
      707     2349    9                                       END;

      708     2350    8                                   END;

      709     2351         /* the FR we want to connect the CF to is now current */
      710     2352    8                               IF NOT FLAG_ERR THEN DO;

   2352 41 003235   200114 234100                    SZN     FLAG_ERR,,AUTO
        41 003236   006306 604000 41                 TMI     s:2929

      711     2353    8                                   CALL STRE_6('C-F     ');

   2353 41 003237   000114 630400 42                 EPPR0   76
        41 003240   000003 631400 42                 EPPR1   3
        41 003241   000000 701000 xent               TSX1    STRE_6
        41 003242   000000 011000                    NOP     0

      712     2354    8                                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   2354 41 003243   000224 054000 39                 AOS     UWA+148

      713     2355    8                                   CALL CONNECT_6('SSSM-CF ');

   2355 41 003244   000115 630400 42                 EPPR0   77
        41 003245   000003 631400 42                 EPPR1   3
        41 003246   000000 701000 xent               TSX1    CONNECT_6
        41 003247   000000 011000                    NOP     0

      714     2356    8                                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   2356 41 003250   000126 237000 42                 LDAQ    86
        41 003251   200124 757100                    STAQ    LNO+4,,AUTO
        41 003252   000124 236000 42                 LDQ     84
        41 003253   200123 756100                    STQ     LNO+3,,AUTO
        41 003254   200010 630500                    EPPR0   HOLD_DBK,,AUTO
        41 003255   200122 450500                    STP0    LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:145  
        41 003256   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003257   000125 631400 42                 EPPR1   85
        41 003260   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        41 003261   000000 011000                    NOP     0

      715     2357    8                                      'FR      ', 'C-F     ' );
      716     2358    8                                   END; /* THEN DO */

      717     2359    7                               END;

      718     2360    6                           END;

      719     2361    5                       END;

      720     2362    4                   END;

   2362 41 003262   006306 710000 41                 TRA     s:2929

      721     2363         /* END CASE 4 */
      722     2364        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:146  
      723     2365        /*****************************************************************/
      724     2366    3           CASE(%DBK_ONL); /* DBKEY only */

      725     2367         /* -change the existing SS to type direct
      726     2368            -make sure THIS_SN's set owner record is LOC MODE DIRECT
      727     2369            -fetch the SFR of the direct item mentioned in the LOC MODE clause
      728     2370            -if a corresponding RFR exists for this SFR, then just fetch it,
      729     2371            otherwise build a RFR and modify this SFR to reflect this
      730     2372            -build a RCF and connect it to the SS
      731     2373         */
      732     2374    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2374 41 003263   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 003264   000001 036003                    ADLQ    1,DU
        41 003265   200116 756100                    STQ     DYNMEM$,,AUTO

      733     2375    3               LNO = DYNMEM$->WRD1;

   2375 41 003266   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 003267   000000 235100                    LDA     0,,PR0
        41 003270   200120 755100                    STA     LNO,,AUTO

      734     2376    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2376 41 003271   000001 036003                    ADLQ    1,DU
        41 003272   200116 756100                    STQ     DYNMEM$,,AUTO

      735     2377    3               CALL FCURR_R_6('S-S     '); /* SS */

   2377 41 003273   000043 630400 42                 EPPR0   35
        41 003274   000003 631400 42                 EPPR1   3
        41 003275   000000 701000 xent               TSX1    FCURR_R_6
        41 003276   000000 011000                    NOP     0

      736     2378    3               CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);

   2378 41 003277   000122 630400 42                 EPPR0   82
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:147  
        41 003300   000000 631400 42                 EPPR1   0
        41 003301   000000 701000 xent               TSX1    FETCHD_6
        41 003302   000000 011000                    NOP     0

      737     2379    3               UWA.S_S.SC_SSH = THIS_SN_SC;

   2379 41 003303   200030 235100                    LDA     THIS_SN_SC,,AUTO
        41 003304   000375 755000 39                 STA     UWA+253

      738     2380    3               UWA.S_S.SOSM_SSH = THIS_SN_SO;

   2380 41 003305   200031 236100                    LDQ     THIS_SN_SO,,AUTO
        41 003306   000376 756000 39                 STQ     UWA+254

      739     2381    3               UWA.S_S.STYP = 1; /* DIRECT */

   2381 41 003307   000001 235007                    LDA     1,DL
        41 003310   000374 755000 39                 STA     UWA+252

      740     2382    3               CALL MODIFY_6('S-S     ');

   2382 41 003311   000043 630400 42                 EPPR0   35
        41 003312   000003 631400 42                 EPPR1   3
        41 003313   000000 701000 xent               TSX1    MODIFY_6
        41 003314   000000 011000                    NOP     0

      741     2383    4               IF UWA.RC.PSMODE ~= 0 THEN DO; /* DIRECT */

   2383 41 003315   000271 235000 39                 LDA     UWA+185
        41 003316   003413 600000 41                 TZE     s:2394

      742     2384    4                   CALL FETCHD_6('RC      ',THIS_SN_SO_RC);

   2384 41 003317   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 003320   200123 450500                    STP0    LNO+3,,AUTO
        41 003321   000007 236000 42                 LDQ     7
        41 003322   200122 756100                    STQ     LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:148  
        41 003323   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003324   000000 631400 42                 EPPR1   0
        41 003325   000000 701000 xent               TSX1    FETCHD_6
        41 003326   000000 011000                    NOP     0

      743     2385    4                   CALL FETCHOS_6('SN-SE   ');

   2385 41 003327   000027 630400 42                 EPPR0   23
        41 003330   000003 631400 42                 EPPR1   3
        41 003331   000000 701000 xent               TSX1    FETCHOS_6
        41 003332   000000 011000                    NOP     0

      744     2386    4                   CALL INDEX(CT1,' ',UWA.SN.SENAME);

   2386 41 003333   000000 124400                    SCM     mask='000'O
        41 003334   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 003335   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 003336   200005 000100                    ARG     CT1,,AUTO

      745     2387    4                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   2387 41 003337   000024 236000 42                 LDQ     20
        41 003340   200124 756100                    STQ     LNO+4,,AUTO
        41 003341   200005 630500                    EPPR0   CT1,,AUTO
        41 003342   200123 450500                    STP0    LNO+3,,AUTO
        41 003343   000014 236000 42                 LDQ     12
        41 003344   200122 756100                    STQ     LNO+2,,AUTO
        41 003345   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003346   000012 631400 42                 EPPR1   10
        41 003347   000000 701000 xent               TSX1    SET_FIELDS
        41 003350   000000 011000                    NOP     0

      746     2388    4                   CALL FETCHD_6('SN      ',THIS_SN);

   2388 41 003351   200027 630500                    EPPR0   THIS_SN,,AUTO
        41 003352   200123 450500                    STP0    LNO+3,,AUTO
        41 003353   000010 236000 42                 LDQ     8
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:149  
        41 003354   200122 756100                    STQ     LNO+2,,AUTO
        41 003355   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003356   000000 631400 42                 EPPR1   0
        41 003357   000000 701000 xent               TSX1    FETCHD_6
        41 003360   000000 011000                    NOP     0

      747     2389    4                   CALL INDEX(CT2,' ',UWA.SN.SENAME);

   2389 41 003361   000000 124400                    SCM     mask='000'O
        41 003362   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 003363   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 003364   200006 000100                    ARG     CT2,,AUTO

      748     2390    4                   CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);

   2390 41 003365   000024 236000 42                 LDQ     20
        41 003366   200124 756100                    STQ     LNO+4,,AUTO
        41 003367   200006 630500                    EPPR0   CT2,,AUTO
        41 003370   200123 450500                    STP0    LNO+3,,AUTO
        41 003371   000020 236000 42                 LDQ     16
        41 003372   200122 756100                    STQ     LNO+2,,AUTO
        41 003373   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003374   000012 631400 42                 EPPR1   10
        41 003375   000000 701000 xent               TSX1    SET_FIELDS
        41 003376   000000 011000                    NOP     0

      749     2391    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4816);

   2391 41 003377   200120 235100                    LDA     LNO,,AUTO
        41 003400   000001 135007                    SBLA    1,DL
        41 003401   200122 755100                    STA     LNO+2,,AUTO
        41 003402   000134 237000 42                 LDAQ    92
        41 003403   200124 757100                    STAQ    LNO+4,,AUTO
        41 003404   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003405   200123 450500                    STP0    LNO+3,,AUTO
        41 003406   200123 630500                    EPPR0   LNO+3,,AUTO
        41 003407   000012 631400 42                 EPPR1   10
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:150  
        41 003410   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 003411   000000 011000                    NOP     0

      750     2392    4                   END;

   2392 41 003412   006306 710000 41                 TRA     s:2929

      751     2393    4               ELSE DO;

      752     2394    4                   CALL FETCHNS_6('RC-FR   '); /* SFR */

   2394 41 003413   000042 630400 42                 EPPR0   34
        41 003414   000003 631400 42                 EPPR1   3
        41 003415   000000 701000 xent               TSX1    FETCHNS_6
        41 003416   000000 011000                    NOP     0

      753     2395    5                  DO WHILE (UWA.FR.F_USE ~= 3); /* want SFR of LOC MODE DIRECT item */

   2395 41 003417   000343 235000 39                 LDA     UWA+227
        41 003420   000003 115007                    CMPA    3,DL
        41 003421   003431 600000 41                 TZE     s:2398

      754     2396    5                       CALL FETCHNS_6('RC-FR   ');

   2396 41 003422   000042 630400 42                 EPPR0   34
        41 003423   000003 631400 42                 EPPR1   3
        41 003424   000000 701000 xent               TSX1    FETCHNS_6
        41 003425   000000 011000                    NOP     0

      755     2397    5                       END;

   2397 41 003426   000343 235000 39                 LDA     UWA+227
        41 003427   000003 115007                    CMPA    3,DL
        41 003430   003422 601000 41                 TNZ     s:2396

      756     2398    4                   CALL FETCHD_6('FR      ',UWA.FR.FR_FRH); /* RFR */

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:151  
   2398 41 003431   000142 630400 42                 EPPR0   98
        41 003432   000000 631400 42                 EPPR1   0
        41 003433   000000 701000 xent               TSX1    FETCHD_6
        41 003434   000000 011000                    NOP     0

      757     2399    4                   HOLD_DBK = UWA.DIRECT_REF;

   2399 41 003435   000036 235000 39                 LDA     UWA+30
        41 003436   200010 755100                    STA     HOLD_DBK,,AUTO

      758     2400    4                   CALL FINDOS_6('SN-SE   '); /* SN */

   2400 41 003437   000027 630400 42                 EPPR0   23
        41 003440   000003 631400 42                 EPPR1   3
        41 003441   000000 701000 xent               TSX1    FINDOS_6
        41 003442   000000 011000                    NOP     0

      759     2401         /* add implicit NR */
      760     2402    4                   UWA.NR.IMPLCT = 1;

   2402 41 003443   000001 235007                    LDA     1,DL
        41 003444   000467 755000 39                 STA     UWA+311

      761     2403    4                   UWA.NR.RELTYPE = RELTYPE.SS;

   2403 41 003445   000011 236000 17                 LDQ     RELTYPE+6
        41 003446   000470 756000 39                 STQ     UWA+312

      762     2404    4                   UWA.NR.LNO = LNO;

   2404 41 003447   200120 235100                    LDA     LNO,,AUTO
        41 003450   000471 755000 39                 STA     UWA+313

      763     2405    4                   CALL STRE_6('NR      ');

   2405 41 003451   000130 630400 42                 EPPR0   88
        41 003452   000003 631400 42                 EPPR1   3
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:152  
        41 003453   000000 701000 xent               TSX1    STRE_6
        41 003454   000000 011000                    NOP     0

      764     2406    4                   UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;

   2406 41 003455   000407 054000 39                 AOS     UWA+263

      765     2407    4                   CALL FINDD_6('SN      ',LAST_DEF_SET_DBK);

   2407 41 003456   000131 630400 42                 EPPR0   89
        41 003457   000000 631400 42                 EPPR1   0
        41 003460   000000 701000 xent               TSX1    FINDD_6
        41 003461   000000 011000                    NOP     0

      766     2408    4                   CALL FCURR_R_6('NR      ');

   2408 41 003462   000130 630400 42                 EPPR0   88
        41 003463   000003 631400 42                 EPPR1   3
        41 003464   000000 701000 xent               TSX1    FCURR_R_6
        41 003465   000000 011000                    NOP     0

      767     2409    4                   CALL CONNECT_6('SN-NRWU ');

   2409 41 003466   000021 630400 42                 EPPR0   17
        41 003467   000003 631400 42                 EPPR1   3
        41 003470   000000 701000 xent               TSX1    CONNECT_6
        41 003471   000000 011000                    NOP     0

      768     2410    4                   UWA.C_F = '0'B;

   2410 41 003472   000000 100400                    MLR     fill='000'O
        41 003473   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 003474   000400 000024 39                 ADSC9   UWA+256                  cn=0,n=20

      769     2411    4                   UWA.C_F.CTRLTYPE = 2; /* set selection */

   2411 41 003475   000002 235007                    LDA     2,DL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:153  
        41 003476   000401 755000 39                 STA     UWA+257

      770     2412    4                   CALL STRE_6('C-F     ');

   2412 41 003477   000114 630400 42                 EPPR0   76
        41 003500   000003 631400 42                 EPPR1   3
        41 003501   000000 701000 xent               TSX1    STRE_6
        41 003502   000000 011000                    NOP     0

      771     2413    4                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   2413 41 003503   000224 054000 39                 AOS     UWA+148

      772     2414    4                   CALL CONNECT_6('SSSM-CF ');

   2414 41 003504   000115 630400 42                 EPPR0   77
        41 003505   000003 631400 42                 EPPR1   3
        41 003506   000000 701000 xent               TSX1    CONNECT_6
        41 003507   000000 011000                    NOP     0

      773     2415    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   2415 41 003510   000126 237000 42                 LDAQ    86
        41 003511   200124 757100                    STAQ    LNO+4,,AUTO
        41 003512   000124 236000 42                 LDQ     84
        41 003513   200123 756100                    STQ     LNO+3,,AUTO
        41 003514   200010 630500                    EPPR0   HOLD_DBK,,AUTO
        41 003515   200122 450500                    STP0    LNO+2,,AUTO
        41 003516   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003517   000125 631400 42                 EPPR1   85
        41 003520   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        41 003521   000000 011000                    NOP     0

      774     2416    4                      'FR      ', 'C-F     ' );
      775     2417    4                   END; /* ELSE DO */

   2417 41 003522   006306 710000 41                 TRA     s:2929
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:154  

      776     2418         /* END CASE 5 */
      777     2419        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:155  
      778     2420        /*****************************************************************/
      779     2421    3           CASE(%MEMB); /* MEMBER recname SELECTION */

      780     2422         /* -find the SN of the recordname and generate NR
      781     2423            -find tehhe RC of that SN
      782     2424            -go through RCSOSM of that RC looking for SM that belongs
      783     2425            to SCSOSM of THIS_SN's SC
      784     2426            -when found, put DBK of SM into SS.SOSM_SSH field in SS
      785     2427            -modify the SS
      786     2428         */
      787     2429    3               CALL FETCHD_6('SM      ',THIS_SM); /* SM */

   2429 41 003523   200025 631500                    EPPR1   THIS_SM,,AUTO
        41 003524   200123 451500                    STP1    LNO+3,,AUTO
        41 003525   000030 236000 42                 LDQ     24
        41 003526   200122 756100                    STQ     LNO+2,,AUTO
        41 003527   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003530   000000 631400 42                 EPPR1   0
        41 003531   000000 701000 xent               TSX1    FETCHD_6
        41 003532   000000 011000                    NOP     0

      788     2430    3               UWA.SM.PA_MEMPNT = 1; /* misuse this field to signify MEMBER */

   2430 41 003533   000001 235007                    LDA     1,DL
        41 003534   000373 755000 39                 STA     UWA+251

      789     2431    3               CALL MODIFY_6('SM      ');

   2431 41 003535   000030 630400 42                 EPPR0   24
        41 003536   000003 631400 42                 EPPR1   3
        41 003537   000000 701000 xent               TSX1    MODIFY_6
        41 003540   000000 011000                    NOP     0

      790     2432    3               CALL FINDOS_6('RC-SOSM '); /* RC */

   2432 41 003541   000033 630400 42                 EPPR0   27
        41 003542   000003 631400 42                 EPPR1   3
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:156  
        41 003543   000000 701000 xent               TSX1    FINDOS_6
        41 003544   000000 011000                    NOP     0

      791     2433    3               THIS_SM_RC = UWA.DIRECT_REF;

   2433 41 003545   000036 235000 39                 LDA     UWA+30
        41 003546   200026 755100                    STA     THIS_SM_RC,,AUTO

      792     2434    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2434 41 003547   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 003550   000001 036003                    ADLQ    1,DU
        41 003551   200116 756100                    STQ     DYNMEM$,,AUTO

      793     2435    3               LNO = DYNMEM$->WRD1;

   2435 41 003552   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 003553   000000 235100                    LDA     0,,PR0
        41 003554   200120 755100                    STA     LNO,,AUTO

      794     2436    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2436 41 003555   000001 036003                    ADLQ    1,DU
        41 003556   200116 756100                    STQ     DYNMEM$,,AUTO

      795     2437    3               CALL ADD_SN(%ZIG_RTYPE_RC,DYNMEM$->CHAR30,0,LNO,FOUND,RELTYPE.SS,

   2437 41 003557   000144 237000 42                 LDAQ    100
        41 003560   200130 757100                    STAQ    LNO+8,,AUTO
        41 003561   000064 237000 42                 LDAQ    52
        41 003562   200126 757100                    STAQ    LNO+6,,AUTO
        41 003563   200120 630500                    EPPR0   LNO,,AUTO
        41 003564   200125 450500                    STP0    LNO+5,,AUTO
        41 003565   000052 236000 42                 LDQ     42
        41 003566   200124 756100                    STQ     LNO+4,,AUTO
        41 003567   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 003570   000056 235000 42                 LDA     46
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:157  
        41 003571   200122 757100                    STAQ    LNO+2,,AUTO
        41 003572   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003573   000045 631400 42                 EPPR1   37
        41 003574   000000 701000 xent               TSX1    ADD_SN
        41 003575   000000 011000                    NOP     0

      796     2438    3                  EXPLCT,0);
      797     2439    3               DYNMEM$ = PINCRW(DYNMEM$,8);

   2439 41 003576   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 003577   000010 036003                    ADLQ    8,DU
        41 003600   200116 756100                    STQ     DYNMEM$,,AUTO

      798     2440    4               IF FOUND = %NOTFOUND THEN DO;

   2440 41 003601   000002 235000 17                 LDA     FOUND
        41 003602   003616 601000 41                 TNZ     s:2443

      799     2441    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4211);

   2441 41 003603   200120 235100                    LDA     LNO,,AUTO
        41 003604   000001 135007                    SBLA    1,DL
        41 003605   200122 755100                    STA     LNO+2,,AUTO
        41 003606   000146 237000 42                 LDAQ    102
        41 003607   200124 757100                    STAQ    LNO+4,,AUTO
        41 003610   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003611   200123 450500                    STP0    LNO+3,,AUTO
        41 003612   200123 630500                    EPPR0   LNO+3,,AUTO
        41 003613   000012 631400 42                 EPPR1   10
        41 003614   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 003615   000000 011000                    NOP     0

      800     2442    4                   END;

      801     2443    3               CALL FINDNS_6('SN-SE   '); /* RC */

   2443 41 003616   000027 630400 42                 EPPR0   23
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:158  
        41 003617   000003 631400 42                 EPPR1   3
        41 003620   000000 701000 xent               TSX1    FINDNS_6
        41 003621   000000 011000                    NOP     0

      802     2444    3               IF THIS_SM_RC = UWA.DIRECT_REF THEN

   2444 41 003622   200026 236100                    LDQ     THIS_SM_RC,,AUTO
        41 003623   000036 116000 39                 CMPQ    UWA+30
        41 003624   003640 601000 41                 TNZ     s:2448

      803     2445    4               DO;

      804     2446    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4830);

   2446 41 003625   200120 235100                    LDA     LNO,,AUTO
        41 003626   000001 135007                    SBLA    1,DL
        41 003627   200122 755100                    STA     LNO+2,,AUTO
        41 003630   000152 237000 42                 LDAQ    106
        41 003631   200124 757100                    STAQ    LNO+4,,AUTO
        41 003632   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003633   200123 450500                    STP0    LNO+3,,AUTO
        41 003634   200123 630500                    EPPR0   LNO+3,,AUTO
        41 003635   000012 631400 42                 EPPR1   10
        41 003636   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 003637   000000 011000                    NOP     0

      805     2447    4                   END;

      806     2448    3               CALL FINDNS_6('RC-SOSM '); /* SO OR SM */

   2448 41 003640   000033 630400 42                 EPPR0   27
        41 003641   000003 631400 42                 EPPR1   3
        41 003642   000000 701000 xent               TSX1    FINDNS_6
        41 003643   000000 011000                    NOP     0

      807     2449    3               FOUND_IT = '0'B;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:159  
   2449 41 003644   200070 450100                    STZ     FOUND_IT,,AUTO

      808     2450    4               DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (FOUND_IT = '0'B));

   2450 41 003645   003671 710000 41                 TRA     s:2459

      809     2451    5                   IF UWA.RECORD_NAME = 'SM' THEN DO;

   2451 41 003646   040000 106400                    CMPC    fill='040'O
        41 003647   000023 000036 39                 ADSC9   UWA+19                   cn=0,n=30
        41 003650   000022 000002 40                 ADSC9   18                       cn=0,n=2
        41 003651   003665 601000 41                 TNZ     s:2458

      810     2452    5                       DBK_LAST_SM = UWA.DIRECT_REF;

   2452 41 003652   000036 235000 39                 LDA     UWA+30
        41 003653   200020 755100                    STA     DBK_LAST_SM,,AUTO

      811     2453    5                       CALL FINDOS_6('SC-SOSM '); /* SC */

   2453 41 003654   000032 630400 42                 EPPR0   26
        41 003655   000003 631400 42                 EPPR1   3
        41 003656   000000 701000 xent               TSX1    FINDOS_6
        41 003657   000000 011000                    NOP     0

      812     2454    6                       IF UWA.DIRECT_REF = THIS_SN_SC THEN DO;

   2454 41 003660   000036 236000 39                 LDQ     UWA+30
        41 003661   200030 116100                    CMPQ    THIS_SN_SC,,AUTO
        41 003662   003665 601000 41                 TNZ     s:2458

      813     2455    6                           FOUND_IT = '1'B;

   2455 41 003663   400000 236003                    LDQ     -131072,DU
        41 003664   200070 756100                    STQ     FOUND_IT,,AUTO

      814     2456    6                           END;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:160  

      815     2457    5                       END;

      816     2458    4                   CALL FINDNS_6('RC-SOSM '); /* SO OR SM */

   2458 41 003665   000033 630400 42                 EPPR0   27
        41 003666   000003 631400 42                 EPPR1   3
        41 003667   000000 701000 xent               TSX1    FINDNS_6
        41 003670   000000 011000                    NOP     0

      817     2459    4                   END;

   2459 41 003671   040000 106400                    CMPC    fill='040'O
        41 003672   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 003673   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 003674   003677 600000 41                 TZE     s:2460
        41 003675   200070 234100                    SZN     FOUND_IT,,AUTO
        41 003676   003646 605000 41                 TPL     s:2451

      818     2460    4               IF ~FOUND_IT THEN DO;

   2460 41 003677   200070 236100                    LDQ     FOUND_IT,,AUTO
        41 003700   400000 376003                    ANQ     -131072,DU
        41 003701   400000 676003                    ERQ     -131072,DU
        41 003702   003716 600000 41                 TZE     s:2466

      819     2461    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4990);

   2461 41 003703   200120 235100                    LDA     LNO,,AUTO
        41 003704   000001 135007                    SBLA    1,DL
        41 003705   200122 755100                    STA     LNO+2,,AUTO
        41 003706   000154 237000 42                 LDAQ    108
        41 003707   200124 757100                    STAQ    LNO+4,,AUTO
        41 003710   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003711   200123 450500                    STP0    LNO+3,,AUTO
        41 003712   200123 630500                    EPPR0   LNO+3,,AUTO
        41 003713   000012 631400 42                 EPPR1   10
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:161  
        41 003714   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 003715   000000 011000                    NOP     0

      820     2462        /*E*  ERROR:  ZIG-4990-C
      821     2463            MESSAGE:  The record "%U1" is not a member of the set.
      822     2464        */
      823     2465    4                   END;

      824     2466    3               CALL FCURR_R_6('S-S     '); /* SS */

   2466 41 003716   000043 630400 42                 EPPR0   35
        41 003717   000003 631400 42                 EPPR1   3
        41 003720   000000 701000 xent               TSX1    FCURR_R_6
        41 003721   000000 011000                    NOP     0

      825     2467    3               CALL FETCHD_6('S-S     ',UWA.DIRECT_REF);

   2467 41 003722   000122 630400 42                 EPPR0   82
        41 003723   000000 631400 42                 EPPR1   0
        41 003724   000000 701000 xent               TSX1    FETCHD_6
        41 003725   000000 011000                    NOP     0

      826     2468    3               UWA.S_S.SOSM_SSH = DBK_LAST_SM;

   2468 41 003726   200020 235100                    LDA     DBK_LAST_SM,,AUTO
        41 003727   000376 755000 39                 STA     UWA+254

      827     2469    3               UWA.S_S.SC_SSH = THIS_SN_SC;

   2469 41 003730   200030 236100                    LDQ     THIS_SN_SC,,AUTO
        41 003731   000375 756000 39                 STQ     UWA+253

      828     2470    3               UWA.S_S.STYP = 3; /* member */

   2470 41 003732   000003 235007                    LDA     3,DL
        41 003733   000374 755000 39                 STA     UWA+252

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:162  
      829     2471    3               CALL MODIFY_6('S-S     ');

   2471 41 003734   000043 630400 42                 EPPR0   35
        41 003735   000003 631400 42                 EPPR1   3
        41 003736   000000 701000 xent               TSX1    MODIFY_6
        41 003737   000000 011000                    NOP     0
        41 003740   006306 710000 41                 TRA     s:2929

      830     2472         /* END CASE 6 */
      831     2473        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:163  
      832     2474        /*****************************************************************/
      833     2475    3           CASE(%THEN_THRU); /* beginning of THEN THRU clause */

      834     2476    3               FIRST_WHERE = '1'B;

   2476 41 003741   400000 236003                    LDQ     -131072,DU
        41 003742   200061 756100                    STQ     FIRST_WHERE,,AUTO

      835     2477    3               NUM_CTRL_FLDS = 0;

   2477 41 003743   200062 450100                    STZ     NUM_CTRL_FLDS,,AUTO

      836     2478    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2478 41 003744   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 003745   000001 036003                    ADLQ    1,DU
        41 003746   200116 756100                    STQ     DYNMEM$,,AUTO

      837     2479    3               LNO = DYNMEM$->WRD1;

   2479 41 003747   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 003750   000000 235100                    LDA     0,,PR0
        41 003751   200120 755100                    STA     LNO,,AUTO

      838     2480    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2480 41 003752   000001 036003                    ADLQ    1,DU
        41 003753   200116 756100                    STQ     DYNMEM$,,AUTO

      839     2481    3               PREV_THRU_SN = THIS_SN;

   2481 41 003754   200027 235100                    LDA     THIS_SN,,AUTO
        41 003755   200056 755100                    STA     PREV_THRU_SN,,AUTO

      840     2482    3               PREV_THRU_SN_SC = THIS_SN_SC;

   2482 41 003756   200030 235100                    LDA     THIS_SN_SC,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:164  
        41 003757   200057 755100                    STA     PREV_THRU_SN_SC,,AUTO

      841     2483    3               CALL ADD_SN(%ZIG_RTYPE_SC,DYNMEM$->CHAR30,0,LNO+1,FOUND,

   2483 41 003760   200120 235100                    LDA     LNO,,AUTO
        41 003761   000001 035007                    ADLA    1,DL
        41 003762   200122 755100                    STA     LNO+2,,AUTO
        41 003763   000144 237000 42                 LDAQ    100
        41 003764   200132 757100                    STAQ    LNO+10,,AUTO
        41 003765   000064 237000 42                 LDAQ    52
        41 003766   200130 757100                    STAQ    LNO+8,,AUTO
        41 003767   200122 630500                    EPPR0   LNO+2,,AUTO
        41 003770   200127 450500                    STP0    LNO+7,,AUTO
        41 003771   000052 236000 42                 LDQ     42
        41 003772   200126 756100                    STQ     LNO+6,,AUTO
        41 003773   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 003774   000157 235000 42                 LDA     111
        41 003775   200124 757100                    STAQ    LNO+4,,AUTO
        41 003776   200124 630500                    EPPR0   LNO+4,,AUTO
        41 003777   000045 631400 42                 EPPR1   37
        41 004000   000000 701000 xent               TSX1    ADD_SN
        41 004001   000000 011000                    NOP     0

      842     2484    3                  RELTYPE.SS,EXPLCT,0);
      843     2485    3               CALL INDEX(CT1,' ',DYNMEM$->CHAR30);

   2485 41 004002   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004003   000000 124500                    SCM     mask='000'O
        41 004004   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 004005   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 004006   200005 000100                    ARG     CT1,,AUTO

      844     2486    3               CALL SET_FIELDS(1,CT1,DYNMEM$->CHAR30);

   2486 41 004007   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 004010   200124 756100                    STQ     LNO+4,,AUTO
        41 004011   200005 631500                    EPPR1   CT1,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:165  
        41 004012   200123 451500                    STP1    LNO+3,,AUTO
        41 004013   000014 236000 42                 LDQ     12
        41 004014   200122 756100                    STQ     LNO+2,,AUTO
        41 004015   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004016   000012 631400 42                 EPPR1   10
        41 004017   000000 701000 xent               TSX1    SET_FIELDS
        41 004020   000000 011000                    NOP     0

      845     2487    3               DYNMEM$ = PINCRW(DYNMEM$,8);

   2487 41 004021   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 004022   000010 036003                    ADLQ    8,DU
        41 004023   200116 756100                    STQ     DYNMEM$,,AUTO

      846     2488    3               THIS_SN = UWA.DIRECT_REF;

   2488 41 004024   000036 235000 39                 LDA     UWA+30
        41 004025   200027 755100                    STA     THIS_SN,,AUTO

      847     2489    4               IF FOUND ~= %FOUNDDEF THEN DO;

   2489 41 004026   000002 235000 17                 LDA     FOUND
        41 004027   000002 115007                    CMPA    2,DL
        41 004030   004043 600000 41                 TZE     s:2496

      848     2490    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4217);

   2490 41 004031   000017 236000 42                 LDQ     15
        41 004032   200124 756100                    STQ     LNO+4,,AUTO
        41 004033   000020 236000 42                 LDQ     16
        41 004034   200123 756100                    STQ     LNO+3,,AUTO
        41 004035   200120 630500                    EPPR0   LNO,,AUTO
        41 004036   200122 450500                    STP0    LNO+2,,AUTO
        41 004037   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004040   000012 631400 42                 EPPR1   10
        41 004041   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004042   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:166  

      849     2491    4                   END;

      850     2492         /*
      851     2493            Make sure that the owner RC of THIS_SN's SC
      852     2494            is a member of the PREV_THRU_SN's set
      853     2495         */
      854     2496    3               CALL FETCHNS_6('SN-SE   '); /* SC of THIS_SN */

   2496 41 004043   000027 630400 42                 EPPR0   23
        41 004044   000003 631400 42                 EPPR1   3
        41 004045   000000 701000 xent               TSX1    FETCHNS_6
        41 004046   000000 011000                    NOP     0

      855     2497    3               THIS_SN_SC = UWA.DIRECT_REF;

   2497 41 004047   000036 235000 39                 LDA     UWA+30
        41 004050   200030 755100                    STA     THIS_SN_SC,,AUTO

      856     2498    3               UWA.SC.ALTOWN = 2; /* Flag SC in THEN THRU chain */

   2498 41 004051   000002 236007                    LDQ     2,DL
        41 004052   000316 756000 39                 STQ     UWA+206

      857     2499    3               CALL MODIFY_6('SC      ');

   2499 41 004053   000005 630400 42                 EPPR0   5
        41 004054   000003 631400 42                 EPPR1   3
        41 004055   000000 701000 xent               TSX1    MODIFY_6
        41 004056   000000 011000                    NOP     0

      858     2500    3               CALL FINDNS_6('SC-SOSM '); /* SO of SC */

   2500 41 004057   000032 630400 42                 EPPR0   26
        41 004060   000003 631400 42                 EPPR1   3
        41 004061   000000 701000 xent               TSX1    FINDNS_6
        41 004062   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:167  

      859     2501    3               CALL FINDOS_6('RC-SOSM '); /* RC of SO */

   2501 41 004063   000033 630400 42                 EPPR0   27
        41 004064   000003 631400 42                 EPPR1   3
        41 004065   000000 701000 xent               TSX1    FINDOS_6
        41 004066   000000 011000                    NOP     0

      860     2502    3               THIS_SN_SO_RC = UWA.DIRECT_REF;

   2502 41 004067   000036 235000 39                 LDA     UWA+30
        41 004070   200032 755100                    STA     THIS_SN_SO_RC,,AUTO

      861     2503    3               CALL FETCHNS_6('RC-SOSM '); /* SO or SM */

   2503 41 004071   000033 630400 42                 EPPR0   27
        41 004072   000003 631400 42                 EPPR1   3
        41 004073   000000 701000 xent               TSX1    FETCHNS_6
        41 004074   000000 011000                    NOP     0

      862     2504    3               FOUND_IT = '0'B;

   2504 41 004075   200070 450100                    STZ     FOUND_IT,,AUTO

      863     2505    4               DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (FOUND_IT = '0'B));

   2505 41 004076   004142 710000 41                 TRA     s:2522

      864     2506    5                   IF UWA.RECORD_NAME = 'SM' THEN DO;

   2506 41 004077   040000 106400                    CMPC    fill='040'O
        41 004100   000023 000036 39                 ADSC9   UWA+19                   cn=0,n=30
        41 004101   000022 000002 40                 ADSC9   18                       cn=0,n=2
        41 004102   004136 601000 41                 TNZ     s:2521

      865     2507    5                       DBK_LAST_SM = UWA.DIRECT_REF;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:168  
   2507 41 004103   000036 235000 39                 LDA     UWA+30
        41 004104   200020 755100                    STA     DBK_LAST_SM,,AUTO

      866     2508    5                       CALL FINDOS_6('SC-SOSM '); /* SC */

   2508 41 004105   000032 630400 42                 EPPR0   26
        41 004106   000003 631400 42                 EPPR1   3
        41 004107   000000 701000 xent               TSX1    FINDOS_6
        41 004110   000000 011000                    NOP     0

      867     2509    6                       IF UWA.DIRECT_REF = PREV_THRU_SN_SC THEN DO;

   2509 41 004111   000036 236000 39                 LDQ     UWA+30
        41 004112   200057 116100                    CMPQ    PREV_THRU_SN_SC,,AUTO
        41 004113   004136 601000 41                 TNZ     s:2521

      868     2510    6                           FOUND_IT = '1'B;

   2510 41 004114   400000 236003                    LDQ     -131072,DU
        41 004115   200070 756100                    STQ     FOUND_IT,,AUTO

      869     2511    6                           IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN

   2511 41 004116   000360 235000 39                 LDA     UWA+240
        41 004117   000001 115007                    CMPA    1,DL
        41 004120   004124 600000 41                 TZE     s:2513
        41 004121   000361 235000 39                 LDA     UWA+241
        41 004122   000001 115007                    CMPA    1,DL
        41 004123   004136 601000 41                 TNZ     s:2521

      870     2512    7                           DO;

      871     2513    7                               CALL ZIG$D_DIAG(LNO,%WARN_SEV,4982);

   2513 41 004124   000161 236000 42                 LDQ     113
        41 004125   200124 756100                    STQ     LNO+4,,AUTO
        41 004126   000014 236000 42                 LDQ     12
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:169  
        41 004127   200123 756100                    STQ     LNO+3,,AUTO
        41 004130   200120 630500                    EPPR0   LNO,,AUTO
        41 004131   200122 450500                    STP0    LNO+2,,AUTO
        41 004132   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004133   000012 631400 42                 EPPR1   10
        41 004134   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004135   000000 011000                    NOP     0

      872     2514        /*E*  ERROR:  ZIG-4982-C
      873     2515            MESSAGE:  The set selection clause is invalid because this record
      874     2516                      is a MANUAL or OPTIONAL member and may not be connected.
      875     2517        */
      876     2518    7                               END;

      877     2519    6                           END;

      878     2520    5                       END;

      879     2521    4                   CALL FETCHNS_6('RC-SOSM '); /* SO or SM */

   2521 41 004136   000033 630400 42                 EPPR0   27
        41 004137   000003 631400 42                 EPPR1   3
        41 004140   000000 701000 xent               TSX1    FETCHNS_6
        41 004141   000000 011000                    NOP     0

      880     2522    4                   END;

   2522 41 004142   040000 106400                    CMPC    fill='040'O
        41 004143   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 004144   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 004145   004150 600000 41                 TZE     s:2523
        41 004146   200070 234100                    SZN     FOUND_IT,,AUTO
        41 004147   004077 605000 41                 TPL     s:2506

      881     2523    4               IF ~FOUND_IT THEN DO;

   2523 41 004150   200070 236100                    LDQ     FOUND_IT,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:170  
        41 004151   400000 376003                    ANQ     -131072,DU
        41 004152   400000 676003                    ERQ     -131072,DU
        41 004153   004166 600000 41                 TZE     s:2531

      882     2524    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4986);

   2524 41 004154   000163 236000 42                 LDQ     115
        41 004155   200124 756100                    STQ     LNO+4,,AUTO
        41 004156   000020 236000 42                 LDQ     16
        41 004157   200123 756100                    STQ     LNO+3,,AUTO
        41 004160   200120 630500                    EPPR0   LNO,,AUTO
        41 004161   200122 450500                    STP0    LNO+2,,AUTO
        41 004162   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004163   000012 631400 42                 EPPR1   10
        41 004164   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004165   000000 011000                    NOP     0

      883     2525        /*E*  ERROR:  ZIG-4986-C
      884     2526            MESSAGE:  The set selection clause is invalid because the owner
      885     2527                      record of this set is not a member of the prior set
      886     2528                      causing a break in the continuous path.
      887     2529        */
      888     2530    4                   END;

      889     2531    3               CALL FETCHD_6('SM      ',DBK_LAST_SM); /* SM */

   2531 41 004166   200020 630500                    EPPR0   DBK_LAST_SM,,AUTO
        41 004167   200123 450500                    STP0    LNO+3,,AUTO
        41 004170   000030 236000 42                 LDQ     24
        41 004171   200122 756100                    STQ     LNO+2,,AUTO
        41 004172   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004173   000000 631400 42                 EPPR1   0
        41 004174   000000 701000 xent               TSX1    FETCHD_6
        41 004175   000000 011000                    NOP     0

      890     2532    3               IF (UWA.SM.CALCDUP = 0) AND /* DUPS ALLOWED on calc fields*/

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:171  
   2532 41 004176   000364 235000 39                 LDA     UWA+244
        41 004177   004217 601000 41                 TNZ     s:2541
        41 004200   000362 236000 39                 LDQ     UWA+242
        41 004201   004217 601000 41                 TNZ     s:2541
        41 004202   000363 235000 39                 LDA     UWA+243
        41 004203   000002 115007                    CMPA    2,DL
        41 004204   004217 600000 41                 TZE     s:2541

      891     2533    3                  (UWA.SM.MEMDUP = 0) AND /* member DUPS not specified */
      892     2534    4                  (UWA.SM.SEQDUP ~= 2) THEN DO; /* not DUPS NOT ALLOWED on keys */

      893     2535    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4922);

   2535 41 004205   000165 236000 42                 LDQ     117
        41 004206   200124 756100                    STQ     LNO+4,,AUTO
        41 004207   000020 236000 42                 LDQ     16
        41 004210   200123 756100                    STQ     LNO+3,,AUTO
        41 004211   200120 630500                    EPPR0   LNO,,AUTO
        41 004212   200122 450500                    STP0    LNO+2,,AUTO
        41 004213   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004214   000012 631400 42                 EPPR1   10
        41 004215   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004216   000000 011000                    NOP     0

      894     2536        /*E*  ERROR:  ZIG-4922-C
      895     2537            MESSAGE:  The specified set OWNER ID fields cannot be matched with
      896     2538                      those of a DUPLICATES NOT phrase.
      897     2539        */
      898     2540    4                   END;

      899     2541    3               CALL FETCHOS_6('SC-SOSM '); /* SC */

   2541 41 004217   000032 630400 42                 EPPR0   26
        41 004220   000003 631400 42                 EPPR1   3
        41 004221   000000 701000 xent               TSX1    FETCHOS_6
        41 004222   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:172  
      900     2542    3               IF (UWA.SC.SETORD ~= 4) AND

   2542 41 004223   000312 235000 39                 LDA     UWA+202
        41 004224   000004 115007                    CMPA    4,DL
        41 004225   006306 600000 41                 TZE     s:2929
        41 004226   000006 115007                    CMPA    6,DL
        41 004227   006306 600000 41                 TZE     s:2929
        41 004230   000362 236000 39                 LDQ     UWA+242
        41 004231   006306 601000 41                 TNZ     s:2929

      901     2543    3                  (UWA.SC.SETORD ~= 6) AND /* not INSERTION SORTED */
      902     2544    4                  (UWA.SM.MEMDUP = 0) THEN DO; /* DUPS NOT not specified */

      903     2545    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4922);

   2545 41 004232   000165 236000 42                 LDQ     117
        41 004233   200124 756100                    STQ     LNO+4,,AUTO
        41 004234   000020 236000 42                 LDQ     16
        41 004235   200123 756100                    STQ     LNO+3,,AUTO
        41 004236   200120 630500                    EPPR0   LNO,,AUTO
        41 004237   200122 450500                    STP0    LNO+2,,AUTO
        41 004240   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004241   000012 631400 42                 EPPR1   10
        41 004242   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004243   000000 011000                    NOP     0

      904     2546    4                   END;

   2546 41 004244   006306 710000 41                 TRA     s:2929

      905     2547        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:173  
      906     2548        /*****************************************************************/
      907     2549    3           CASE(%THEN_OWNER); /* WHERE OWNER IDENTIFIED BY dbid */

      908     2550    3               IF NUM_CTRL_FLDS < 100 THEN

   2550 41 004245   200062 236100                    LDQ     NUM_CTRL_FLDS,,AUTO
        41 004246   000144 116007                    CMPQ    100,DL
        41 004247   004253 603000 41                 TRC     s:2553

      909     2551    3                   NUM_CTRL_FLDS = NUM_CTRL_FLDS + 1;

   2551 41 004250   000001 036007                    ADLQ    1,DL
        41 004251   200062 756100                    STQ     NUM_CTRL_FLDS,,AUTO
        41 004252   004265 710000 41                 TRA     s:2560

      910     2552    4               ELSE DO;

      911     2553    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4853);

   2553 41 004253   000167 236000 42                 LDQ     119
        41 004254   200124 756100                    STQ     LNO+4,,AUTO
        41 004255   000020 236000 42                 LDQ     16
        41 004256   200123 756100                    STQ     LNO+3,,AUTO
        41 004257   200120 631500                    EPPR1   LNO,,AUTO
        41 004260   200122 451500                    STP1    LNO+2,,AUTO
        41 004261   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004262   000012 631400 42                 EPPR1   10
        41 004263   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004264   000000 011000                    NOP     0

      912     2554        /*E*  ERROR:  ZIG-4853-C
      913     2555            MESSAGE:  Implementation restriction.  No more than 100 control
      914     2556                      fields may be specified for the selection of one record
      915     2557                      within a set selection path.
      916     2558        */
      917     2559    4                   END;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:174  
      918     2560    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2560 41 004265   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 004266   000001 036003                    ADLQ    1,DU
        41 004267   200116 756100                    STQ     DYNMEM$,,AUTO

      919     2561    3               LNO = DYNMEM$->WRD1;

   2561 41 004270   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004271   000000 235100                    LDA     0,,PR0
        41 004272   200120 755100                    STA     LNO,,AUTO

      920     2562    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2562 41 004273   000001 036003                    ADLQ    1,DU
        41 004274   200116 756100                    STQ     DYNMEM$,,AUTO

      921     2563    3               FR_NAME = DYNMEM$->CHAR30;

   2563 41 004275   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004276   040100 100500                    MLR     fill='040'O
        41 004277   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 004300   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30

      922     2564    3               DYNMEM$ = PINCRW(DYNMEM$,8);

   2564 41 004301   000010 036003                    ADLQ    8,DU
        41 004302   200116 756100                    STQ     DYNMEM$,,AUTO

      923     2565    3               IF DYNMEM$->WRD1 = %QUAL THEN

   2565 41 004303   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004304   000000 235100                    LDA     0,,PR0
        41 004305   000113 115007                    CMPA    75,DL
        41 004306   004434 601000 41                 TNZ     s:2588

      924     2566    4               DO;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:175  

      925     2567    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   2567 41 004307   000001 036003                    ADLQ    1,DU
        41 004310   200116 756100                    STQ     DYNMEM$,,AUTO

      926     2568    4                   QRC_NAME = DYNMEM$->CHAR30;

   2568 41 004311   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004312   040100 100500                    MLR     fill='040'O
        41 004313   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 004314   200046 000036                    ADSC9   QRC_NAME,,AUTO           cn=0,n=30

      927     2569    4                   DYNMEM$ = PINCRW(DYNMEM$,8);

   2569 41 004315   000010 036003                    ADLQ    8,DU
        41 004316   200116 756100                    STQ     DYNMEM$,,AUTO

      928     2570    4                   CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0)

   2570 41 004317   000052 237000 42                 LDAQ    42
        41 004320   200130 757100                    STAQ    LNO+8,,AUTO
        41 004321   000054 237000 42                 LDAQ    44
        41 004322   200126 757100                    STAQ    LNO+6,,AUTO
        41 004323   200120 630500                    EPPR0   LNO,,AUTO
        41 004324   200125 450500                    STP0    LNO+5,,AUTO
        41 004325   000052 236000 42                 LDQ     42
        41 004326   200124 756100                    STQ     LNO+4,,AUTO
        41 004327   200046 631500                    EPPR1   QRC_NAME,,AUTO
        41 004330   200123 451500                    STP1    LNO+3,,AUTO
        41 004331   000056 236000 42                 LDQ     46
        41 004332   200122 756100                    STQ     LNO+2,,AUTO
        41 004333   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004334   000045 631400 42                 EPPR1   37
        41 004335   000000 701000 xent               TSX1    ADD_SN
        41 004336   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:176  
      929     2571    4                      ;
      930     2572    4                   IF FOUND ~= %FOUNDDEF THEN

   2572 41 004337   000002 235000 17                 LDA     FOUND
        41 004340   000002 115007                    CMPA    2,DL
        41 004341   004372 600000 41                 TZE     s:2578

      931     2573    5                   DO;

      932     2574    5                       CALL INDEX(CT1,' ',FR_NAME);

   2574 41 004342   000000 124500                    SCM     mask='000'O
        41 004343   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 004344   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 004345   200005 000100                    ARG     CT1,,AUTO

      933     2575    5                       CALL SET_FIELDS(1,CT1,FR_NAME);

   2575 41 004346   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 004347   200124 450500                    STP0    LNO+4,,AUTO
        41 004350   200005 631500                    EPPR1   CT1,,AUTO
        41 004351   200123 451500                    STP1    LNO+3,,AUTO
        41 004352   000014 236000 42                 LDQ     12
        41 004353   200122 756100                    STQ     LNO+2,,AUTO
        41 004354   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004355   000012 631400 42                 EPPR1   10
        41 004356   000000 701000 xent               TSX1    SET_FIELDS
        41 004357   000000 011000                    NOP     0

      934     2576    5                       CALL ZIG$D_DIAG(LNO,%WARN_SEV,4809);
              2576                                /*qualifying RC not DEFed */

   2576 41 004360   000061 236000 42                 LDQ     49
        41 004361   200124 756100                    STQ     LNO+4,,AUTO
        41 004362   000014 236000 42                 LDQ     12
        41 004363   200123 756100                    STQ     LNO+3,,AUTO
        41 004364   200120 630500                    EPPR0   LNO,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:177  
        41 004365   200122 450500                    STP0    LNO+2,,AUTO
        41 004366   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004367   000012 631400 42                 EPPR1   10
        41 004370   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004371   000000 011000                    NOP     0

      935     2577    5                       END;

      936     2578    4                   CALL FINDNS_6('SN-SE   '); /* RC */

   2578 41 004372   000027 630400 42                 EPPR0   23
        41 004373   000003 631400 42                 EPPR1   3
        41 004374   000000 701000 xent               TSX1    FINDNS_6
        41 004375   000000 011000                    NOP     0

      937     2579    4                   IF UWA.DIRECT_REF ~= THIS_SN_SO_RC THEN

   2579 41 004376   000036 236000 39                 LDQ     UWA+30
        41 004377   200032 116100                    CMPQ    THIS_SN_SO_RC,,AUTO
        41 004400   004431 600000 41                 TZE     s:2585

      938     2580    5                   DO;

      939     2581    5                       CALL INDEX(CT1,' ',FR_NAME);

   2581 41 004401   000000 124500                    SCM     mask='000'O
        41 004402   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 004403   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 004404   200005 000100                    ARG     CT1,,AUTO

      940     2582    5                       CALL SET_FIELDS(1,CT1,FR_NAME);

   2582 41 004405   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 004406   200124 450500                    STP0    LNO+4,,AUTO
        41 004407   200005 631500                    EPPR1   CT1,,AUTO
        41 004410   200123 451500                    STP1    LNO+3,,AUTO
        41 004411   000014 236000 42                 LDQ     12
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:178  
        41 004412   200122 756100                    STQ     LNO+2,,AUTO
        41 004413   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004414   000012 631400 42                 EPPR1   10
        41 004415   000000 701000 xent               TSX1    SET_FIELDS
        41 004416   000000 011000                    NOP     0

      941     2583    5                       CALL ZIG$D_DIAG(LNO,%WARN_SEV,4809);

   2583 41 004417   000061 236000 42                 LDQ     49
        41 004420   200124 756100                    STQ     LNO+4,,AUTO
        41 004421   000014 236000 42                 LDQ     12
        41 004422   200123 756100                    STQ     LNO+3,,AUTO
        41 004423   200120 630500                    EPPR0   LNO,,AUTO
        41 004424   200122 450500                    STP0    LNO+2,,AUTO
        41 004425   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004426   000012 631400 42                 EPPR1   10
        41 004427   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004430   000000 011000                    NOP     0

      942     2584    5                       END;

      943     2585    4                   QRC_DBK = UWA.DIRECT_REF;

   2585 41 004431   000036 235000 39                 LDA     UWA+30
        41 004432   200045 755100                    STA     QRC_DBK,,AUTO

      944     2586    4                   END;

   2586 41 004433   004436 710000 41                 TRA     s:2590

      945     2587    3               ELSE
      946     2588    3                   QRC_DBK = THIS_SN_SO_RC; /* not qualified; must be in RC

   2588 41 004434   200032 235100                    LDA     THIS_SN_SO_RC,,AUTO
        41 004435   200045 755100                    STA     QRC_DBK,,AUTO

      947     2589         that owns set named in THEN THRU clause */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:179  
      948     2590    3               CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.SS,

   2590 41 004436   200045 630500                    EPPR0   QRC_DBK,,AUTO
        41 004437   200131 450500                    STP0    LNO+9,,AUTO
        41 004440   000063 236000 42                 LDQ     51
        41 004441   200130 756100                    STQ     LNO+8,,AUTO
        41 004442   000064 237000 42                 LDAQ    52
        41 004443   200126 757100                    STAQ    LNO+6,,AUTO
        41 004444   200120 631500                    EPPR1   LNO,,AUTO
        41 004445   200125 451500                    STP1    LNO+5,,AUTO
        41 004446   000052 236000 42                 LDQ     42
        41 004447   200124 756100                    STQ     LNO+4,,AUTO
        41 004450   200035 633500                    EPPR3   FR_NAME,,AUTO
        41 004451   200123 453500                    STP3    LNO+3,,AUTO
        41 004452   000066 236000 42                 LDQ     54
        41 004453   200122 756100                    STQ     LNO+2,,AUTO
        41 004454   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004455   000045 631400 42                 EPPR1   37
        41 004456   000000 701000 xent               TSX1    ADD_SN
        41 004457   000000 011000                    NOP     0

      949     2591    3                  EXPLCT,QRC_DBK);
      950     2592    4               IF (FOUND = %NOTFOUND) THEN DO;

   2592 41 004460   000002 235000 17                 LDA     FOUND
        41 004461   004512 601000 41                 TNZ     s:2597

      951     2593    4                   CALL INDEX(CT1,' ',FR_NAME);

   2593 41 004462   000000 124500                    SCM     mask='000'O
        41 004463   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 004464   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 004465   200005 000100                    ARG     CT1,,AUTO

      952     2594    4                   CALL SET_FIELDS(1,CT1,FR_NAME);

   2594 41 004466   200035 630500                    EPPR0   FR_NAME,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:180  
        41 004467   200124 450500                    STP0    LNO+4,,AUTO
        41 004470   200005 631500                    EPPR1   CT1,,AUTO
        41 004471   200123 451500                    STP1    LNO+3,,AUTO
        41 004472   000014 236000 42                 LDQ     12
        41 004473   200122 756100                    STQ     LNO+2,,AUTO
        41 004474   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004475   000012 631400 42                 EPPR1   10
        41 004476   000000 701000 xent               TSX1    SET_FIELDS
        41 004477   000000 011000                    NOP     0

      953     2595    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4838);

   2595 41 004500   000075 236000 42                 LDQ     61
        41 004501   200124 756100                    STQ     LNO+4,,AUTO
        41 004502   000020 236000 42                 LDQ     16
        41 004503   200123 756100                    STQ     LNO+3,,AUTO
        41 004504   200120 630500                    EPPR0   LNO,,AUTO
        41 004505   200122 450500                    STP0    LNO+2,,AUTO
        41 004506   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004507   000012 631400 42                 EPPR1   10
        41 004510   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004511   000000 011000                    NOP     0

      954     2596    4                   END;

      955     2597    4               IF (FOUND = %FOUNDDUP) THEN DO;

   2597 41 004512   000002 235000 17                 LDA     FOUND
        41 004513   000003 115007                    CMPA    3,DL
        41 004514   004545 601000 41                 TNZ     s:2602

      956     2598    4                   CALL INDEX(CT1,' ',FR_NAME);

   2598 41 004515   000000 124500                    SCM     mask='000'O
        41 004516   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 004517   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 004520   200005 000100                    ARG     CT1,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:181  

      957     2599    4                   CALL SET_FIELDS(1,CT1,FR_NAME);

   2599 41 004521   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 004522   200124 450500                    STP0    LNO+4,,AUTO
        41 004523   200005 631500                    EPPR1   CT1,,AUTO
        41 004524   200123 451500                    STP1    LNO+3,,AUTO
        41 004525   000014 236000 42                 LDQ     12
        41 004526   200122 756100                    STQ     LNO+2,,AUTO
        41 004527   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004530   000012 631400 42                 EPPR1   10
        41 004531   000000 701000 xent               TSX1    SET_FIELDS
        41 004532   000000 011000                    NOP     0

      958     2600    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4801); /* needs qualifier */

   2600 41 004533   000071 236000 42                 LDQ     57
        41 004534   200124 756100                    STQ     LNO+4,,AUTO
        41 004535   000020 236000 42                 LDQ     16
        41 004536   200123 756100                    STQ     LNO+3,,AUTO
        41 004537   200120 630500                    EPPR0   LNO,,AUTO
        41 004540   200122 450500                    STP0    LNO+2,,AUTO
        41 004541   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004542   000012 631400 42                 EPPR1   10
        41 004543   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004544   000000 011000                    NOP     0

      959     2601    4                   END;

      960     2602    3               CALL FETCHNS_6('SN-SE   '); /* FR */

   2602 41 004545   000027 630400 42                 EPPR0   23
        41 004546   000003 631400 42                 EPPR1   3
        41 004547   000000 701000 xent               TSX1    FETCHNS_6
        41 004550   000000 011000                    NOP     0

      961     2603    3               IF UWA.FR.REF ~= 1 THEN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:182  

   2603 41 004551   000333 235000 39                 LDA     UWA+219
        41 004552   000001 115007                    CMPA    1,DL
        41 004553   004562 600000 41                 TZE     s:2608

      962     2604    4               DO;

      963     2605    4                   UWA.FR.REF = 1;

   2605 41 004554   000001 236007                    LDQ     1,DL
        41 004555   000333 756000 39                 STQ     UWA+219

      964     2606    4                   CALL MODIFY_6('FR      ');

   2606 41 004556   000073 630400 42                 EPPR0   59
        41 004557   000003 631400 42                 EPPR1   3
        41 004560   000000 701000 xent               TSX1    MODIFY_6
        41 004561   000000 011000                    NOP     0

      965     2607    4                   END;

      966     2608    3               DBK_WHER_FR = UWA.DIRECT_REF;

   2608 41 004562   000036 235000 39                 LDA     UWA+30
        41 004563   200060 755100                    STA     DBK_WHER_FR,,AUTO

      967     2609    3               FR.FTYPE = UWA.FR.FTYPE;

   2609 41 004564   000334 236000 39                 LDQ     UWA+220
        41 004565   200063 756100                    STQ     FR,,AUTO

      968     2610    3               FR.PREC = UWA.FR.PREC;

   2610 41 004566   000335 235000 39                 LDA     UWA+221
        41 004567   200064 755100                    STA     FR+1,,AUTO

      969     2611    3               FR.SCALE = UWA.FR.SCALE;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:183  

   2611 41 004570   000336 235000 39                 LDA     UWA+222
        41 004571   200065 755100                    STA     FR+2,,AUTO

      970     2612    3               FR.F_SIGN = UWA.FR.F_SIGN;

   2612 41 004572   000337 235000 39                 LDA     UWA+223
        41 004573   200066 755100                    STA     FR+3,,AUTO

      971     2613         /* build the ss */
      972     2614    3               CALL FINDD_6('SM      ',THIS_SM); /* SM */

   2614 41 004574   200025 630500                    EPPR0   THIS_SM,,AUTO
        41 004575   200123 450500                    STP0    LNO+3,,AUTO
        41 004576   000030 236000 42                 LDQ     24
        41 004577   200122 756100                    STQ     LNO+2,,AUTO
        41 004600   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004601   000000 631400 42                 EPPR1   0
        41 004602   000000 701000 xent               TSX1    FINDD_6
        41 004603   000000 011000                    NOP     0

      973     2615    3               UWA.S_S = '0'B;

   2615 41 004604   000000 100400                    MLR     fill='000'O
        41 004605   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 004606   000374 000020 39                 ADSC9   UWA+252                  cn=0,n=16

      974     2616    3               IF FIRST_WHERE THEN

   2616 41 004607   200061 234100                    SZN     FIRST_WHERE,,AUTO
        41 004610   004633 605000 41                 TPL     s:2630

      975     2617    4               DO;

      976     2618    4                   IF THIS_SN_SC = THIS_SC THEN /* this is last thenthru */

   2618 41 004611   200030 236100                    LDQ     THIS_SN_SC,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:184  
        41 004612   200024 116100                    CMPQ    THIS_SC,,AUTO
        41 004613   004617 601000 41                 TNZ     s:2621

      977     2619    4                       UWA.S_S.STYP = 5; /* scanrange */

   2619 41 004614   000005 235007                    LDA     5,DL
        41 004615   000374 755000 39                 STA     UWA+252
        41 004616   004621 710000 41                 TRA     s:2622

      978     2620    4                   ELSE
      979     2621    4                       UWA.S_S.STYP = 4; /* scan */

   2621 41 004617   000004 235007                    LDA     4,DL
        41 004620   000374 755000 39                 STA     UWA+252

      980     2622    4                   UWA.S_S.SC_SSH = THIS_SN_SC;

   2622 41 004621   000375 756000 39                 STQ     UWA+253

      981     2623    4                   UWA.S_S.SOSM_SSH = DBK_LAST_SM; /* CHECK THIS!!!! */

   2623 41 004622   200020 235100                    LDA     DBK_LAST_SM,,AUTO
        41 004623   000376 755000 39                 STA     UWA+254

      982     2624    4                   CALL STRE_6('S-S     ');

   2624 41 004624   000043 630400 42                 EPPR0   35
        41 004625   000003 631400 42                 EPPR1   3
        41 004626   000000 701000 xent               TSX1    STRE_6
        41 004627   000000 011000                    NOP     0

      983     2625    4                   UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;

   2625 41 004630   000223 054000 39                 AOS     UWA+147

      984     2626    4                   FIRST_WHERE = '0'B;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:185  
   2626 41 004631   200061 450100                    STZ     FIRST_WHERE,,AUTO

      985     2627    4                   END;

   2627 41 004632   004637 710000 41                 TRA     s:2632

      986     2628    3               ELSE
      987     2629    4               DO;

      988     2630    4                   CALL FCURR_R_6('S-S     ');

   2630 41 004633   000043 630400 42                 EPPR0   35
        41 004634   000003 631400 42                 EPPR1   3
        41 004635   000000 701000 xent               TSX1    FCURR_R_6
        41 004636   000000 011000                    NOP     0

      989     2631    4                   END;

      990     2632    3               UWA.C_F = '0'B;

   2632 41 004637   000000 100400                    MLR     fill='000'O
        41 004640   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 004641   000400 000024 39                 ADSC9   UWA+256                  cn=0,n=20

      991     2633    3               UWA.C_F.CTRLTYPE = 2; /* set selection */

   2633 41 004642   000002 235007                    LDA     2,DL
        41 004643   000401 755000 39                 STA     UWA+257

      992     2634         /* if EQUAL TO specified, need a different FR than the one
      993     2635            we've already gotten above */
      994     2636    4               IF DYNMEM$->WRD1 = %EQUAL_TO THEN DO;

   2636 41 004644   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004645   000000 235100                    LDA     0,,PR0
        41 004646   000050 115007                    CMPA    40,DL
        41 004647   005274 601000 41                 TNZ     s:2722
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:186  

      995     2637    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   2637 41 004650   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 004651   000001 036003                    ADLQ    1,DU
        41 004652   200116 756100                    STQ     DYNMEM$,,AUTO

      996     2638    4                   LNO = DYNMEM$->WRD1;

   2638 41 004653   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004654   000000 235100                    LDA     0,,PR0
        41 004655   200120 755100                    STA     LNO,,AUTO

      997     2639    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   2639 41 004656   000001 036003                    ADLQ    1,DU
        41 004657   200116 756100                    STQ     DYNMEM$,,AUTO

      998     2640    4                   FR_NAME = DYNMEM$->CHAR30;

   2640 41 004660   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004661   040100 100500                    MLR     fill='040'O
        41 004662   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 004663   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30

      999     2641    4                   DYNMEM$ = PINCRW(DYNMEM$,8);

   2641 41 004664   000010 036003                    ADLQ    8,DU
        41 004665   200116 756100                    STQ     DYNMEM$,,AUTO

     1000     2642    4                   IF DYNMEM$->WRD1 = %QUAL THEN

   2642 41 004666   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004667   000000 235100                    LDA     0,,PR0
        41 004670   000113 115007                    CMPA    75,DL
        41 004671   004764 601000 41                 TNZ     s:2659

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:187  
     1001     2643    5                   DO;

     1002     2644    5                       DYNMEM$ = PINCRW(DYNMEM$,1);

   2644 41 004672   000001 036003                    ADLQ    1,DU
        41 004673   200116 756100                    STQ     DYNMEM$,,AUTO

     1003     2645    5                       QRC_NAME = DYNMEM$->CHAR30;

   2645 41 004674   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 004675   040100 100500                    MLR     fill='040'O
        41 004676   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 004677   200046 000036                    ADSC9   QRC_NAME,,AUTO           cn=0,n=30

     1004     2646    5                       DYNMEM$ = PINCRW(DYNMEM$,8);

   2646 41 004700   000010 036003                    ADLQ    8,DU
        41 004701   200116 756100                    STQ     DYNMEM$,,AUTO

     1005     2647    5                      CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0
              2647                                )

   2647 41 004702   000052 237000 42                 LDAQ    42
        41 004703   200130 757100                    STAQ    LNO+8,,AUTO
        41 004704   000054 237000 42                 LDAQ    44
        41 004705   200126 757100                    STAQ    LNO+6,,AUTO
        41 004706   200120 630500                    EPPR0   LNO,,AUTO
        41 004707   200125 450500                    STP0    LNO+5,,AUTO
        41 004710   000052 236000 42                 LDQ     42
        41 004711   200124 756100                    STQ     LNO+4,,AUTO
        41 004712   200046 631500                    EPPR1   QRC_NAME,,AUTO
        41 004713   200123 451500                    STP1    LNO+3,,AUTO
        41 004714   000056 236000 42                 LDQ     46
        41 004715   200122 756100                    STQ     LNO+2,,AUTO
        41 004716   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004717   000045 631400 42                 EPPR1   37
        41 004720   000000 701000 xent               TSX1    ADD_SN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:188  
        41 004721   000000 011000                    NOP     0

     1006     2648    5                          ;
     1007     2649    5                       IF FOUND ~= %FOUNDDEF THEN

   2649 41 004722   000002 235000 17                 LDA     FOUND
        41 004723   000002 115007                    CMPA    2,DL
        41 004724   004755 600000 41                 TZE     s:2655

     1008     2650    6                       DO;

     1009     2651    6                           CALL INDEX(CT1,' ',FR_NAME);

   2651 41 004725   000000 124500                    SCM     mask='000'O
        41 004726   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 004727   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 004730   200005 000100                    ARG     CT1,,AUTO

     1010     2652    6                           CALL SET_FIELDS(1,CT1,FR_NAME);

   2652 41 004731   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 004732   200124 450500                    STP0    LNO+4,,AUTO
        41 004733   200005 631500                    EPPR1   CT1,,AUTO
        41 004734   200123 451500                    STP1    LNO+3,,AUTO
        41 004735   000014 236000 42                 LDQ     12
        41 004736   200122 756100                    STQ     LNO+2,,AUTO
        41 004737   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004740   000012 631400 42                 EPPR1   10
        41 004741   000000 701000 xent               TSX1    SET_FIELDS
        41 004742   000000 011000                    NOP     0

     1011     2653    6                           CALL ZIG$D_DIAG(LNO,%ERR_SEV,4809);
              2653                                    /*qualifying RC not DEFed */

   2653 41 004743   000061 236000 42                 LDQ     49
        41 004744   200124 756100                    STQ     LNO+4,,AUTO
        41 004745   000020 236000 42                 LDQ     16
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:189  
        41 004746   200123 756100                    STQ     LNO+3,,AUTO
        41 004747   200120 630500                    EPPR0   LNO,,AUTO
        41 004750   200122 450500                    STP0    LNO+2,,AUTO
        41 004751   200122 630500                    EPPR0   LNO+2,,AUTO
        41 004752   000012 631400 42                 EPPR1   10
        41 004753   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 004754   000000 011000                    NOP     0

     1012     2654    6                           END;

     1013     2655    5                       CALL FINDNS_6('SN-SE   '); /* RC */

   2655 41 004755   000027 630400 42                 EPPR0   23
        41 004756   000003 631400 42                 EPPR1   3
        41 004757   000000 701000 xent               TSX1    FINDNS_6
        41 004760   000000 011000                    NOP     0

     1014     2656    5                       QRC_DBK = UWA.DIRECT_REF;

   2656 41 004761   000036 235000 39                 LDA     UWA+30
        41 004762   200045 755100                    STA     QRC_DBK,,AUTO

     1015     2657    5                       END;

   2657 41 004763   004765 710000 41                 TRA     s:2660

     1016     2658    4                   ELSE
     1017     2659    4                       QRC_DBK = 0; /* not qualified */

   2659 41 004764   200045 450100                    STZ     QRC_DBK,,AUTO

     1018     2660    4                   CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.SS,

   2660 41 004765   200045 630500                    EPPR0   QRC_DBK,,AUTO
        41 004766   200131 450500                    STP0    LNO+9,,AUTO
        41 004767   000063 236000 42                 LDQ     51
        41 004770   200130 756100                    STQ     LNO+8,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:190  
        41 004771   000064 237000 42                 LDAQ    52
        41 004772   200126 757100                    STAQ    LNO+6,,AUTO
        41 004773   200120 631500                    EPPR1   LNO,,AUTO
        41 004774   200125 451500                    STP1    LNO+5,,AUTO
        41 004775   000052 236000 42                 LDQ     42
        41 004776   200124 756100                    STQ     LNO+4,,AUTO
        41 004777   200035 633500                    EPPR3   FR_NAME,,AUTO
        41 005000   200123 453500                    STP3    LNO+3,,AUTO
        41 005001   000066 236000 42                 LDQ     54
        41 005002   200122 756100                    STQ     LNO+2,,AUTO
        41 005003   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005004   000045 631400 42                 EPPR1   37
        41 005005   000000 701000 xent               TSX1    ADD_SN
        41 005006   000000 011000                    NOP     0

     1019     2661    4                      EXPLCT,QRC_DBK);
     1020     2662    4                   IF FOUND = %FOUNDDUP THEN

   2662 41 005007   000002 235000 17                 LDA     FOUND
        41 005010   000003 115007                    CMPA    3,DL
        41 005011   005042 601000 41                 TNZ     s:2669

     1021     2663    5                   DO;

     1022     2664    5                       CALL INDEX(CT1,' ',FR_NAME);

   2664 41 005012   000000 124500                    SCM     mask='000'O
        41 005013   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 005014   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 005015   200005 000100                    ARG     CT1,,AUTO

     1023     2665    5                       CALL SET_FIELDS(1,CT1,FR_NAME);

   2665 41 005016   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 005017   200124 450500                    STP0    LNO+4,,AUTO
        41 005020   200005 631500                    EPPR1   CT1,,AUTO
        41 005021   200123 451500                    STP1    LNO+3,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:191  
        41 005022   000014 236000 42                 LDQ     12
        41 005023   200122 756100                    STQ     LNO+2,,AUTO
        41 005024   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005025   000012 631400 42                 EPPR1   10
        41 005026   000000 701000 xent               TSX1    SET_FIELDS
        41 005027   000000 011000                    NOP     0

     1024     2666    5                       CALL ZIG$D_DIAG(LNO,%ERR_SEV,4801); /*needs qualifier */

   2666 41 005030   000071 236000 42                 LDQ     57
        41 005031   200124 756100                    STQ     LNO+4,,AUTO
        41 005032   000020 236000 42                 LDQ     16
        41 005033   200123 756100                    STQ     LNO+3,,AUTO
        41 005034   200120 630500                    EPPR0   LNO,,AUTO
        41 005035   200122 450500                    STP0    LNO+2,,AUTO
        41 005036   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005037   000012 631400 42                 EPPR1   10
        41 005040   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005041   000000 011000                    NOP     0

     1025     2667    5                       END;

     1026     2668         /* if qualified but not found then error */
     1027     2669    4                   IF QRC_DBK ~= 0 AND FOUND = %NOTFOUND THEN

   2669 41 005042   200045 235100                    LDA     QRC_DBK,,AUTO
        41 005043   005076 600000 41                 TZE     s:2675
        41 005044   000002 236000 17                 LDQ     FOUND
        41 005045   005076 601000 41                 TNZ     s:2675

     1028     2670    5                   DO;

     1029     2671    5                       CALL INDEX(CT1,' ',FR_NAME);

   2671 41 005046   000000 124500                    SCM     mask='000'O
        41 005047   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 005050   000011 000001 42                 ADSC9   9                        cn=0,n=1
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:192  
        41 005051   200005 000100                    ARG     CT1,,AUTO

     1030     2672    5                       CALL SET_FIELDS(1,CT1,FR_NAME);

   2672 41 005052   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 005053   200124 450500                    STP0    LNO+4,,AUTO
        41 005054   200005 631500                    EPPR1   CT1,,AUTO
        41 005055   200123 451500                    STP1    LNO+3,,AUTO
        41 005056   000014 236000 42                 LDQ     12
        41 005057   200122 756100                    STQ     LNO+2,,AUTO
        41 005060   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005061   000012 631400 42                 EPPR1   10
        41 005062   000000 701000 xent               TSX1    SET_FIELDS
        41 005063   000000 011000                    NOP     0

     1031     2673    5                       CALL ZIG$D_DIAG(LNO,%ERR_SEV,4838);

   2673 41 005064   000075 236000 42                 LDQ     61
        41 005065   200124 756100                    STQ     LNO+4,,AUTO
        41 005066   000020 236000 42                 LDQ     16
        41 005067   200123 756100                    STQ     LNO+3,,AUTO
        41 005070   200120 630500                    EPPR0   LNO,,AUTO
        41 005071   200122 450500                    STP0    LNO+2,,AUTO
        41 005072   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005073   000012 631400 42                 EPPR1   10
        41 005074   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005075   000000 011000                    NOP     0

     1032     2674    5                       END;

     1033     2675    4                   DBK_SN = UWA.DIRECT_REF;

   2675 41 005076   000036 235000 39                 LDA     UWA+30
        41 005077   200023 755100                    STA     DBK_SN,,AUTO

     1034     2676         /* if not found, then this is a dbparam and we need
     1035     2677            to build a RFR and a SFR */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:193  
     1036     2678    5                   IF FOUND = %NOTFOUND THEN DO;

   2678 41 005100   000002 236000 17                 LDQ     FOUND
        41 005101   005165 601000 41                 TNZ     s:2702

     1037     2679    5                       CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC); /* RC */

   2679 41 005102   000076 630400 42                 EPPR0   62
        41 005103   000000 631400 42                 EPPR1   0
        41 005104   000000 701000 xent               TSX1    FINDD_6
        41 005105   000000 011000                    NOP     0

     1038     2680    5                       UWA.FR.SYN = 0;

   2680 41 005106   000332 450000 39                 STZ     UWA+218

     1039     2681    5                       UWA.FR.REF = 1;

   2681 41 005107   000001 235007                    LDA     1,DL
        41 005110   000333 755000 39                 STA     UWA+219

     1040     2682    5                       UWA.FR.F_USE = 1;

   2682 41 005111   000343 755000 39                 STA     UWA+227

     1041     2683    5                       UWA.FR.LEVEL = 0;

   2683 41 005112   000346 450000 39                 STZ     UWA+230

     1042     2684    5                       CALL FINDD_6('SN      ',DBK_SN);

   2684 41 005113   200023 630500                    EPPR0   DBK_SN,,AUTO
        41 005114   200123 450500                    STP0    LNO+3,,AUTO
        41 005115   000010 236000 42                 LDQ     8
        41 005116   200122 756100                    STQ     LNO+2,,AUTO
        41 005117   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005120   000000 631400 42                 EPPR1   0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:194  
        41 005121   000000 701000 xent               TSX1    FINDD_6
        41 005122   000000 011000                    NOP     0

     1043     2685    5                       CALL STRE_6('FR      '); /* RFR */

   2685 41 005123   000073 630400 42                 EPPR0   59
        41 005124   000003 631400 42                 EPPR1   3
        41 005125   000000 701000 xent               TSX1    STRE_6
        41 005126   000000 011000                    NOP     0

     1044     2686    5                       UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   2686 41 005127   000220 054000 39                 AOS     UWA+144

     1045     2687    5                       DBK_RFR = UWA.DIRECT_REF;

   2687 41 005130   000036 235000 39                 LDA     UWA+30
        41 005131   200022 755100                    STA     DBK_RFR,,AUTO

     1046     2688    5                       CALL CONNECT_6('SN-SE   ');

   2688 41 005132   000027 630400 42                 EPPR0   23
        41 005133   000003 631400 42                 EPPR1   3
        41 005134   000000 701000 xent               TSX1    CONNECT_6
        41 005135   000000 011000                    NOP     0

     1047     2689    5                       CALL FINDD_6('RC      ',THIS_SN_SO_RC); /* RC */

   2689 41 005136   200032 630500                    EPPR0   THIS_SN_SO_RC,,AUTO
        41 005137   200123 450500                    STP0    LNO+3,,AUTO
        41 005140   000007 236000 42                 LDQ     7
        41 005141   200122 756100                    STQ     LNO+2,,AUTO
        41 005142   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005143   000000 631400 42                 EPPR1   0
        41 005144   000000 701000 xent               TSX1    FINDD_6
        41 005145   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:195  
     1048     2690    5                       UWA.FR.SYN = 1;

   2690 41 005146   000001 235007                    LDA     1,DL
        41 005147   000332 755000 39                 STA     UWA+218

     1049     2691    5                       UWA.FR.F_USE = 5;

   2691 41 005150   000005 236007                    LDQ     5,DL
        41 005151   000343 756000 39                 STQ     UWA+227

     1050     2692    5                       UWA.FR.FR_FRH = DBK_RFR;

   2692 41 005152   200022 235100                    LDA     DBK_RFR,,AUTO
        41 005153   000352 755000 39                 STA     UWA+234

     1051     2693    5                       UWA.FR.BUFFLOC = DBK_WHER_FR;

   2693 41 005154   200060 235100                    LDA     DBK_WHER_FR,,AUTO
        41 005155   000351 755000 39                 STA     UWA+233

     1052     2694    5                       CALL STRE_6('FR      '); /* SFR */

   2694 41 005156   000073 630400 42                 EPPR0   59
        41 005157   000003 631400 42                 EPPR1   3
        41 005160   000000 701000 xent               TSX1    STRE_6
        41 005161   000000 011000                    NOP     0

     1053     2695    5                       UWA.C_F.SYN = 1;

   2695 41 005162   000001 235007                    LDA     1,DL
        41 005163   000400 755000 39                 STA     UWA+256

     1054     2696    5                       END;

   2696 41 005164   005274 710000 41                 TRA     s:2722

     1055     2697         /* if found, then it is either a dbid or a dbparam
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:196  
     1056     2698            that has already been mentioned previously. All
     1057     2699            we need do is check the data characteristics against
     1058     2700            the WHER FR */
     1059     2701    5                   ELSE DO;

     1060     2702    5                       CALL FETCHNS_6('SN-SE   '); /* RFR */

   2702 41 005165   000027 630400 42                 EPPR0   23
        41 005166   000003 631400 42                 EPPR1   3
        41 005167   000000 701000 xent               TSX1    FETCHNS_6
        41 005170   000000 011000                    NOP     0

     1061     2703    5                       CALL INDEX(CT1,' ',FR_NAME);

   2703 41 005171   000000 124500                    SCM     mask='000'O
        41 005172   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 005173   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 005174   200005 000100                    ARG     CT1,,AUTO

     1062     2704    5                       CALL SET_FIELDS(1,CT1,FR_NAME);

   2704 41 005175   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 005176   200124 450500                    STP0    LNO+4,,AUTO
        41 005177   200005 631500                    EPPR1   CT1,,AUTO
        41 005200   200123 451500                    STP1    LNO+3,,AUTO
        41 005201   000014 236000 42                 LDQ     12
        41 005202   200122 756100                    STQ     LNO+2,,AUTO
        41 005203   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005204   000012 631400 42                 EPPR1   10
        41 005205   000000 701000 xent               TSX1    SET_FIELDS
        41 005206   000000 011000                    NOP     0

     1063     2705    6                       IF FR.FTYPE ~= UWA.FR.FTYPE THEN DO;

   2705 41 005207   200063 236100                    LDQ     FR,,AUTO
        41 005210   000334 116000 39                 CMPQ    UWA+220
        41 005211   005225 600000 41                 TZE     s:2709
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:197  

     1064     2706    6                           CALL ZIG$D_DIAG(LNO,%ERR_SEV,4839);

   2706 41 005212   000103 236000 42                 LDQ     67
        41 005213   200124 756100                    STQ     LNO+4,,AUTO
        41 005214   000020 236000 42                 LDQ     16
        41 005215   200123 756100                    STQ     LNO+3,,AUTO
        41 005216   200120 630500                    EPPR0   LNO,,AUTO
        41 005217   200122 450500                    STP0    LNO+2,,AUTO
        41 005220   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005221   000012 631400 42                 EPPR1   10
        41 005222   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005223   000000 011000                    NOP     0

     1065     2707    6                           END;

   2707 41 005224   005274 710000 41                 TRA     s:2722

     1066     2708    6                       ELSE DO;

     1067     2709    7                           IF FR.PREC ~= UWA.FR.PREC THEN DO;

   2709 41 005225   200064 236100                    LDQ     FR+1,,AUTO
        41 005226   000335 116000 39                 CMPQ    UWA+221
        41 005227   005242 600000 41                 TZE     s:2712

     1068     2710    7                               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4840);

   2710 41 005230   000105 236000 42                 LDQ     69
        41 005231   200124 756100                    STQ     LNO+4,,AUTO
        41 005232   000020 236000 42                 LDQ     16
        41 005233   200123 756100                    STQ     LNO+3,,AUTO
        41 005234   200120 630500                    EPPR0   LNO,,AUTO
        41 005235   200122 450500                    STP0    LNO+2,,AUTO
        41 005236   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005237   000012 631400 42                 EPPR1   10
        41 005240   000000 701000 xent               TSX1    ZIG$D_DIAG
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:198  
        41 005241   000000 011000                    NOP     0

     1069     2711    7                               END;

     1070     2712    7                           IF FR.SCALE ~= UWA.FR.SCALE THEN DO;

   2712 41 005242   200065 236100                    LDQ     FR+2,,AUTO
        41 005243   000336 116000 39                 CMPQ    UWA+222
        41 005244   005257 600000 41                 TZE     s:2715

     1071     2713    7                               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4841);

   2713 41 005245   000111 236000 42                 LDQ     73
        41 005246   200124 756100                    STQ     LNO+4,,AUTO
        41 005247   000020 236000 42                 LDQ     16
        41 005250   200123 756100                    STQ     LNO+3,,AUTO
        41 005251   200120 630500                    EPPR0   LNO,,AUTO
        41 005252   200122 450500                    STP0    LNO+2,,AUTO
        41 005253   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005254   000012 631400 42                 EPPR1   10
        41 005255   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005256   000000 011000                    NOP     0

     1072     2714    7                               END;

     1073     2715    7                           IF FR.F_SIGN ~= UWA.FR.F_SIGN THEN DO;

   2715 41 005257   200066 236100                    LDQ     FR+3,,AUTO
        41 005260   000337 116000 39                 CMPQ    UWA+223
        41 005261   005274 600000 41                 TZE     s:2722

     1074     2716    7                               CALL ZIG$D_DIAG(LNO,%ERR_SEV,4842);

   2716 41 005262   000113 236000 42                 LDQ     75
        41 005263   200124 756100                    STQ     LNO+4,,AUTO
        41 005264   000020 236000 42                 LDQ     16
        41 005265   200123 756100                    STQ     LNO+3,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:199  
        41 005266   200120 630500                    EPPR0   LNO,,AUTO
        41 005267   200122 450500                    STP0    LNO+2,,AUTO
        41 005270   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005271   000012 631400 42                 EPPR1   10
        41 005272   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005273   000000 011000                    NOP     0

     1075     2717    7                               END;

     1076     2718    6                           END;

     1077     2719    5                       END;

     1078     2720    4                   END;

     1079     2721         /* the FR we want to connect the CF to is now current */
     1080     2722    3               CALL FCURR_R_6('FR      ');

   2722 41 005274   000073 630400 42                 EPPR0   59
        41 005275   000003 631400 42                 EPPR1   3
        41 005276   000000 701000 xent               TSX1    FCURR_R_6
        41 005277   000000 011000                    NOP     0

     1081     2723    3               HOLD_DBK = UWA.DIRECT_REF;

   2723 41 005300   000036 235000 39                 LDA     UWA+30
        41 005301   200010 755100                    STA     HOLD_DBK,,AUTO

     1082     2724    3               CALL STRE_6('C-F     ');

   2724 41 005302   000114 630400 42                 EPPR0   76
        41 005303   000003 631400 42                 EPPR1   3
        41 005304   000000 701000 xent               TSX1    STRE_6
        41 005305   000000 011000                    NOP     0

     1083     2725    3               CALL CONNECT_6('SSSM-CF ');

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:200  
   2725 41 005306   000115 630400 42                 EPPR0   77
        41 005307   000003 631400 42                 EPPR1   3
        41 005310   000000 701000 xent               TSX1    CONNECT_6
        41 005311   000000 011000                    NOP     0

     1084     2726    3               CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   2726 41 005312   000126 237000 42                 LDAQ    86
        41 005313   200124 757100                    STAQ    LNO+4,,AUTO
        41 005314   000124 236000 42                 LDQ     84
        41 005315   200123 756100                    STQ     LNO+3,,AUTO
        41 005316   200010 630500                    EPPR0   HOLD_DBK,,AUTO
        41 005317   200122 450500                    STP0    LNO+2,,AUTO
        41 005320   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005321   000125 631400 42                 EPPR1   85
        41 005322   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        41 005323   000000 011000                    NOP     0

     1085     2727    3                  'FR      ', 'C-F     ' );
     1086     2728        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:201  
     1087     2729    3               UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   2729 41 005324   000224 054000 39                 AOS     UWA+148
        41 005325   006306 710000 41                 TRA     s:2929

     1088     2730        /*****************************************************************/
     1089     2731    3           CASE(%END_MEM_ENTRY);

     1090     2732         /* What needs to be done here is check that the last THRU
     1091     2733            setname mentioned is the same as the current set being
     1092     2734            defined */
     1093     2735    3               DYNMEM$ = PINCRW(DYNMEM$, 1);

   2735 41 005326   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 005327   000001 036003                    ADLQ    1,DU
        41 005330   200116 756100                    STQ     DYNMEM$,,AUTO

     1094     2736    4               IF THIS_SC ~= THIS_SN_SC THEN DO;

   2736 41 005331   200024 236100                    LDQ     THIS_SC,,AUTO
        41 005332   200030 116100                    CMPQ    THIS_SN_SC,,AUTO
        41 005333   006306 600000 41                 TZE     s:2929

     1095     2737    4                   CALL ZIG$D_DIAG(LNO,%ERR_SEV,4980);

   2737 41 005334   000171 236000 42                 LDQ     121
        41 005335   200124 756100                    STQ     LNO+4,,AUTO
        41 005336   000020 236000 42                 LDQ     16
        41 005337   200123 756100                    STQ     LNO+3,,AUTO
        41 005340   200120 630500                    EPPR0   LNO,,AUTO
        41 005341   200122 450500                    STP0    LNO+2,,AUTO
        41 005342   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005343   000012 631400 42                 EPPR1   10
        41 005344   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005345   000000 011000                    NOP     0

     1096     2738        /*E*  ERROR:  ZIG-4980-C
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:202  
     1097     2739            MESSAGE:  The set selection is improperly terminated.  Additional
     1098     2740                      specification is required.
     1099     2741        */
     1100     2742    4                   END;

   2742 41 005346   006306 710000 41                 TRA     s:2929

     1101     2743        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:203  
     1102     2744        /*****************************************************************/
     1103     2745    3           CASE(%WITHIN_ANY); /* WITHIN ANY AREA [EXCEPT...] clause */

     1104     2746         /* - get the SN of THIS_RC
     1105     2747            - for each area in the schema:
     1106     2748            - find the areaname and compare it to the names
     1107     2749            in the EXCEPT phrase
     1108     2750            - if this area is an exception area, then just build an
     1109     2751            explicit NR.
     1110     2752            - if this area is not an exception area, build an implicit
     1111     2753            NR and build an RA
     1112     2754            - check validity of areanames given in exception phrase by
     1113     2755            blanking them out when they match the current areaname.  By
     1114     2756            the end of the OA-AC set, all the exception areas should be
     1115     2757            blank.  If not, either they are invalid areas or an
     1116     2758            areaname was given more than once.
     1117     2759         */
     1118     2760    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2760 41 005347   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 005350   000001 036003                    ADLQ    1,DU
        41 005351   200116 756100                    STQ     DYNMEM$,,AUTO

     1119     2761    3               THIS_RC = DYNMEM$->WRD1;

   2761 41 005352   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005353   000000 235100                    LDA     0,,PR0
        41 005354   200033 755100                    STA     THIS_RC,,AUTO

     1120     2762    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2762 41 005355   000001 036003                    ADLQ    1,DU
        41 005356   200116 756100                    STQ     DYNMEM$,,AUTO

     1121     2763    3               ANY_LNO = DYNMEM$->WRD1;

   2763 41 005357   200116 470500                    LDP0    DYNMEM$,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:204  
        41 005360   000000 235100                    LDA     0,,PR0
        41 005361   200004 755100                    STA     ANY_LNO,,AUTO

     1122     2764    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2764 41 005362   000001 036003                    ADLQ    1,DU
        41 005363   200116 756100                    STQ     DYNMEM$,,AUTO

     1123     2765    3               EXC_START$ = DYNMEM$;

   2765 41 005364   200117 756100                    STQ     EXC_START$,,AUTO

     1124     2766    3               CALL FETCHD_6('RC      ',THIS_RC); /* RC */

   2766 41 005365   200033 630500                    EPPR0   THIS_RC,,AUTO
        41 005366   200123 450500                    STP0    LNO+3,,AUTO
        41 005367   000007 236000 42                 LDQ     7
        41 005370   200122 756100                    STQ     LNO+2,,AUTO
        41 005371   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005372   000000 631400 42                 EPPR1   0
        41 005373   000000 701000 xent               TSX1    FETCHD_6
        41 005374   000000 011000                    NOP     0

     1125     2767    3               CALL FINDOS_6('SN-SE   '); /* SN */

   2767 41 005375   000027 630400 42                 EPPR0   23
        41 005376   000003 631400 42                 EPPR1   3
        41 005377   000000 701000 xent               TSX1    FINDOS_6
        41 005400   000000 011000                    NOP     0

     1126     2768    3               THIS_RC_SN = UWA.DIRECT_REF;

   2768 41 005401   000036 235000 39                 LDA     UWA+30
        41 005402   200034 755100                    STA     THIS_RC_SN,,AUTO

     1127     2769    3               CALL FCURR_R_6('OA      '); /* OA */

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:205  
   2769 41 005403   000001 630400 42                 EPPR0   1
        41 005404   000003 631400 42                 EPPR1   3
        41 005405   000000 701000 xent               TSX1    FCURR_R_6
        41 005406   000000 011000                    NOP     0

     1128     2770    3               CALL FINDNS_6('OA-AC   '); /* AC */

   2770 41 005407   000172 630400 42                 EPPR0   122
        41 005410   000003 631400 42                 EPPR1   3
        41 005411   000000 701000 xent               TSX1    FINDNS_6
        41 005412   000000 011000                    NOP     0

     1129     2771    3               UWA.NR = '0'B;

   2771 41 005413   000000 100400                    MLR     fill='000'O
        41 005414   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 005415   000466 000020 39                 ADSC9   UWA+310                  cn=0,n=16

     1130     2772    3               UWA.NR.RELTYPE = 7; /* LOC */

   2772 41 005416   000007 235007                    LDA     7,DL
        41 005417   000470 755000 39                 STA     UWA+312

     1131     2773    3               UWA.RA = '0'B;

   2773 41 005420   000000 100400                    MLR     fill='000'O
        41 005421   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 005422   000326 000020 39                 ADSC9   UWA+214                  cn=0,n=16

     1132     2774    4               DO WHILE (UWA.DB_STATUS ~= '0502100');

   2774 41 005423   040000 106400                    CMPC    fill='040'O
        41 005424   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 005425   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 005426   005626 600000 41                 TZE     s:2829

     1133     2775    4                   UWA.NR.LNO = ANY_LNO;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:206  

   2775 41 005427   200004 235100                    LDA     ANY_LNO,,AUTO
        41 005430   000471 755000 39                 STA     UWA+313

     1134     2776    4                   UWA.NR.IMPLCT = 1;

   2776 41 005431   000001 236007                    LDQ     1,DL
        41 005432   000467 756000 39                 STQ     UWA+311

     1135     2777    4                   FOUND_IT = '0'B;

   2777 41 005433   200070 450100                    STZ     FOUND_IT,,AUTO

     1136     2778    4                   CALL FETCHOS_6('SN-SE   '); /* SN areaname */

   2778 41 005434   000027 630400 42                 EPPR0   23
        41 005435   000003 631400 42                 EPPR1   3
        41 005436   000000 701000 xent               TSX1    FETCHOS_6
        41 005437   000000 011000                    NOP     0

     1137     2779    4                   DYNMEM$ = EXC_START$;

   2779 41 005440   200117 236100                    LDQ     EXC_START$,,AUTO
        41 005441   200116 756100                    STQ     DYNMEM$,,AUTO

     1138     2780    5                   DO WHILE ((DYNMEM$->WRD1 = %EXC_AREA) AND (FOUND_IT = '0'B));

   2780 41 005442   005472 710000 41                 TRA     s:2792

     1139     2781    5                       DYNMEM$ = PINCRW(DYNMEM$,1);

   2781 41 005443   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 005444   000001 036003                    ADLQ    1,DU
        41 005445   200116 756100                    STQ     DYNMEM$,,AUTO

     1140     2782    5                       LNO = DYNMEM$->WRD1;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:207  
   2782 41 005446   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005447   000000 235100                    LDA     0,,PR0
        41 005450   200120 755100                    STA     LNO,,AUTO

     1141     2783    5                       DYNMEM$ = PINCRW(DYNMEM$,1);

   2783 41 005451   000001 036003                    ADLQ    1,DU
        41 005452   200116 756100                    STQ     DYNMEM$,,AUTO

     1142     2784    6                       IF UWA.SN.SENAME = DYNMEM$->CHAR30 THEN DO;

   2784 41 005453   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005454   040100 106400                    CMPC    fill='040'O
        41 005455   000427 000036 39                 ADSC9   UWA+279                  cn=0,n=30
        41 005456   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 005457   005467 601000 41                 TNZ     s:2791

     1143     2785         /* this is an exception area */
     1144     2786    6                           UWA.NR.IMPLCT = 0;

   2786 41 005460   000467 450000 39                 STZ     UWA+311

     1145     2787    6                           UWA.NR.LNO = LNO;

   2787 41 005461   000471 755000 39                 STA     UWA+313

     1146     2788    6                           DYNMEM$->CHAR30 = ' ';

   2788 41 005462   040100 100400                    MLR     fill='040'O
        41 005463   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 005464   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30

     1147     2789    6                           FOUND_IT = '1'B;

   2789 41 005465   400000 236003                    LDQ     -131072,DU
        41 005466   200070 756100                    STQ     FOUND_IT,,AUTO

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:208  
     1148     2790    6                           END;

     1149     2791    5                       DYNMEM$ = PINCRW(DYNMEM$,8);

   2791 41 005467   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 005470   000010 036003                    ADLQ    8,DU
        41 005471   200116 756100                    STQ     DYNMEM$,,AUTO

     1150     2792    5                       END;

   2792 41 005472   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005473   000000 235100                    LDA     0,,PR0
        41 005474   000074 115007                    CMPA    60,DL
        41 005475   005500 601000 41                 TNZ     s:2794
        41 005476   200070 234100                    SZN     FOUND_IT,,AUTO
        41 005477   005443 605000 41                 TPL     s:2781

     1151     2793         /* add the NR */
     1152     2794    4                   CALL STRE_6('NR      ');

   2794 41 005500   000130 630400 42                 EPPR0   88
        41 005501   000003 631400 42                 EPPR1   3
        41 005502   000000 701000 xent               TSX1    STRE_6
        41 005503   000000 011000                    NOP     0

     1153     2795    4                   UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;

   2795 41 005504   000407 054000 39                 AOS     UWA+263

     1154     2796    4                   CALL FINDD_6('SN      ',THIS_RC_SN);

   2796 41 005505   200034 630500                    EPPR0   THIS_RC_SN,,AUTO
        41 005506   200123 450500                    STP0    LNO+3,,AUTO
        41 005507   000010 236000 42                 LDQ     8
        41 005510   200122 756100                    STQ     LNO+2,,AUTO
        41 005511   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005512   000000 631400 42                 EPPR1   0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:209  
        41 005513   000000 701000 xent               TSX1    FINDD_6
        41 005514   000000 011000                    NOP     0

     1155     2797    4                   CALL FCURR_R_6('NR     ');

   2797 41 005515   000130 630400 42                 EPPR0   88
        41 005516   000003 631400 42                 EPPR1   3
        41 005517   000000 701000 xent               TSX1    FCURR_R_6
        41 005520   000000 011000                    NOP     0

     1156     2798    4                   CALL CONNECT_6('SN-NRWU ');

   2798 41 005521   000021 630400 42                 EPPR0   17
        41 005522   000003 631400 42                 EPPR1   3
        41 005523   000000 701000 xent               TSX1    CONNECT_6
        41 005524   000000 011000                    NOP     0

     1157     2799         /* add RA */
     1158     2800    5                   IF UWA.NR.IMPLCT = 1 THEN DO; /* not an exception area */

   2800 41 005525   000467 235000 39                 LDA     UWA+311
        41 005526   000001 115007                    CMPA    1,DL
        41 005527   005616 601000 41                 TNZ     s:2826

     1159     2801    5                       CALL STRE_6('RA      ');

   2801 41 005530   000173 630400 42                 EPPR0   123
        41 005531   000003 631400 42                 EPPR1   3
        41 005532   000000 701000 xent               TSX1    STRE_6
        41 005533   000000 011000                    NOP     0

     1160     2802    5                       UWA.OA.NUMB_RA = UWA.OA.NUMB_RA + 1;

   2802 41 005534   000217 054000 39                 AOS     UWA+143

     1161     2803         /* set AC bit if altkeys or prime keys present in record */
     1162     2804    5                       IF UWA.RC.KEY_PRESENT = 1 OR UWA.RC.PSMODE = 4 THEN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:210  

   2804 41 005535   000301 235000 39                 LDA     UWA+193
        41 005536   000001 115007                    CMPA    1,DL
        41 005537   005543 600000 41                 TZE     s:2806
        41 005540   000271 236000 39                 LDQ     UWA+185
        41 005541   000004 116007                    CMPQ    4,DL
        41 005542   005616 601000 41                 TNZ     s:2826

     1163     2805    6                       DO;

     1164     2806    6                           CALL FETCHOS_6('AC-RA   ');

   2806 41 005543   000174 630400 42                 EPPR0   124
        41 005544   000003 631400 42                 EPPR1   3
        41 005545   000000 701000 xent               TSX1    FETCHOS_6
        41 005546   000000 011000                    NOP     0

     1165     2807    6                           IF UWA.RC.PSMODE = 4 /* INDEXED */

   2807 41 005547   000271 235000 39                 LDA     UWA+185
        41 005550   000004 115007                    CMPA    4,DL
        41 005551   005557 601000 41                 TNZ     s:2812

     1166     2808    7                           THEN DO;

     1167     2809    7                               UWA.AC.PRIME_KEY = 1;

   2809 41 005552   000001 236007                    LDQ     1,DL
        41 005553   000234 756000 39                 STQ     UWA+156

     1168     2810    7                               UWA.AC.PAGE_TYP = 3;

   2810 41 005554   000003 235007                    LDA     3,DL
        41 005555   000237 755000 39                 STA     UWA+159

     1169     2811    7                               END;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:211  
   2811 41 005556   005561 710000 41                 TRA     s:2813

     1170     2812    6                           ELSE UWA.AC.SEC_KEY = 1;

   2812 41 005557   000001 236007                    LDQ     1,DL
        41 005560   000235 756000 39                 STQ     UWA+157

     1171     2813    6                           CALL MODIFY_6('AC      ');

   2813 41 005561   000175 630400 42                 EPPR0   125
        41 005562   000003 631400 42                 EPPR1   3
        41 005563   000000 701000 xent               TSX1    MODIFY_6
        41 005564   000000 011000                    NOP     0

     1172     2814    6                           IF UWA.RC.PSMODE = 4 THEN /* INDEXED */

   2814 41 005565   000271 235000 39                 LDA     UWA+185
        41 005566   000004 115007                    CMPA    4,DL
        41 005567   005616 601000 41                 TNZ     s:2826

     1173     2815    7                           DO;

     1174     2816    7                               CALL FINDNS_6('AC-RA   '); /* RA */

   2816 41 005570   000174 630400 42                 EPPR0   124
        41 005571   000003 631400 42                 EPPR1   3
        41 005572   000000 701000 xent               TSX1    FINDNS_6
        41 005573   000000 011000                    NOP     0

     1175     2817    7                               CALL FINDNS_6('AC-RA   ');

   2817 41 005574   000174 630400 42                 EPPR0   124
        41 005575   000003 631400 42                 EPPR1   3
        41 005576   000000 701000 xent               TSX1    FINDNS_6
        41 005577   000000 011000                    NOP     0

     1176     2818         /* should not be another RA */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:212  
     1177     2819    7                               IF UWA.DB_STATUS ~= '0502100' THEN

   2819 41 005600   040000 106400                    CMPC    fill='040'O
        41 005601   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 005602   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 005603   005616 600000 41                 TZE     s:2826

     1178     2820    8                               DO;

     1179     2821    8                                   CALL ZIG$D_DIAG(ANY_LNO,%ERR_SEV,4977);

   2821 41 005604   000177 236000 42                 LDQ     127
        41 005605   200124 756100                    STQ     LNO+4,,AUTO
        41 005606   000020 236000 42                 LDQ     16
        41 005607   200123 756100                    STQ     LNO+3,,AUTO
        41 005610   200004 630500                    EPPR0   ANY_LNO,,AUTO
        41 005611   200122 450500                    STP0    LNO+2,,AUTO
        41 005612   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005613   000012 631400 42                 EPPR1   10
        41 005614   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005615   000000 011000                    NOP     0

     1180     2822    8                                   END;

     1181     2823    7                               END;

     1182     2824    6                           END;

     1183     2825    5                       END;

     1184     2826    4                   CALL FINDNS_6('OA-AC   '); /* AC */

   2826 41 005616   000172 630400 42                 EPPR0   122
        41 005617   000003 631400 42                 EPPR1   3
        41 005620   000000 701000 xent               TSX1    FINDNS_6
        41 005621   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:213  
     1185     2827    4                   END;

   2827 41 005622   040000 106400                    CMPC    fill='040'O
        41 005623   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 005624   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 005625   005427 601000 41                 TNZ     s:2775

     1186     2828         /* check validity of exception areanames given */
     1187     2829    3               DYNMEM$ = EXC_START$;

   2829 41 005626   200117 236100                    LDQ     EXC_START$,,AUTO
        41 005627   200116 756100                    STQ     DYNMEM$,,AUTO

     1188     2830    4               DO WHILE (DYNMEM$->WRD1 = %EXC_AREA);

   2830 41 005630   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005631   000000 235100                    LDA     0,,PR0
        41 005632   000074 115007                    CMPA    60,DL
        41 005633   006306 601000 41                 TNZ     s:2929

     1189     2831    5                   IF PINCRW(DYNMEM$,2)->CHAR30 ~= ' ' THEN DO;

   2831 41 005634   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005635   040000 106500                    CMPC    fill='040'O
        41 005636   000002 000036                    ADSC9   2,,PR0                   cn=0,n=30
        41 005637   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 005640   005653 600000 41                 TZE     s:2834

     1190     2832    5                       CALL ZIG$D_DIAG(ANY_LNO,%ERR_SEV,4156);

   2832 41 005641   000201 236000 42                 LDQ     129
        41 005642   200124 756100                    STQ     LNO+4,,AUTO
        41 005643   000020 236000 42                 LDQ     16
        41 005644   200123 756100                    STQ     LNO+3,,AUTO
        41 005645   200004 631500                    EPPR1   ANY_LNO,,AUTO
        41 005646   200122 451500                    STP1    LNO+2,,AUTO
        41 005647   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:214  
        41 005650   000012 631400 42                 EPPR1   10
        41 005651   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 005652   000000 011000                    NOP     0

     1191     2833    5                       END;

     1192     2834    4                   DYNMEM$ = PINCRW(DYNMEM$,10);

   2834 41 005653   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 005654   000012 036003                    ADLQ    10,DU
        41 005655   200116 756100                    STQ     DYNMEM$,,AUTO

     1193     2835    4                   END;

   2835 41 005656   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005657   000000 235100                    LDA     0,,PR0
        41 005660   000074 115007                    CMPA    60,DL
        41 005661   005634 600000 41                 TZE     s:2831
        41 005662   006306 710000 41                 TRA     s:2929

     1194     2836        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:215  
     1195     2837        /*****************************************************************/
     1196     2838    3           CASE(%DIRECT); /* LOCATION MODE DIRECT clause */

     1197     2839         /* -if this is the first reference to a dbparam,
     1198     2840            then build a RFR
     1199     2841            -if the FR is qualified and has not been DEFed, then error.
     1200     2842            -in any case, add a SFR to the RC of this LOC MODE clause.
     1201     2843         */
     1202     2844    3               DYNMEM$ =PINCRW(DYNMEM$,1);

   2844 41 005663   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 005664   000001 036003                    ADLQ    1,DU
        41 005665   200116 756100                    STQ     DYNMEM$,,AUTO

     1203     2845    3               THIS_RC = DYNMEM$->WRD1;

   2845 41 005666   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005667   000000 235100                    LDA     0,,PR0
        41 005670   200033 755100                    STA     THIS_RC,,AUTO

     1204     2846    3               CALL FINDD_6('RC      ',THIS_RC);

   2846 41 005671   200033 631500                    EPPR1   THIS_RC,,AUTO
        41 005672   200123 451500                    STP1    LNO+3,,AUTO
        41 005673   000007 236000 42                 LDQ     7
        41 005674   200122 756100                    STQ     LNO+2,,AUTO
        41 005675   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005676   000000 631400 42                 EPPR1   0
        41 005677   000000 701000 xent               TSX1    FINDD_6
        41 005700   000000 011000                    NOP     0

     1205     2847    3               CALL FINDOS_6('SN-SE   '); /* SN */

   2847 41 005701   000027 630400 42                 EPPR0   23
        41 005702   000003 631400 42                 EPPR1   3
        41 005703   000000 701000 xent               TSX1    FINDOS_6
        41 005704   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:216  

     1206     2848    3               LAST_DEF_REC_DBK = UWA.DIRECT_REF;

   2848 41 005705   000036 235000 39                 LDA     UWA+30
        41 005706   000000 755000 21                 STA     LAST_DEF_REC_DBK

     1207     2849    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2849 41 005707   200116 236100                    LDQ     DYNMEM$,,AUTO
        41 005710   000001 036003                    ADLQ    1,DU
        41 005711   200116 756100                    STQ     DYNMEM$,,AUTO

     1208     2850    3               LNO = DYNMEM$->WRD1;

   2850 41 005712   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005713   000000 235100                    LDA     0,,PR0
        41 005714   200120 755100                    STA     LNO,,AUTO

     1209     2851    3               DYNMEM$ = PINCRW(DYNMEM$,1);

   2851 41 005715   000001 036003                    ADLQ    1,DU
        41 005716   200116 756100                    STQ     DYNMEM$,,AUTO

     1210     2852    3               FR_NAME = DYNMEM$->CHAR30;

   2852 41 005717   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005720   040100 100500                    MLR     fill='040'O
        41 005721   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 005722   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30

     1211     2853    3               DYNMEM$ = PINCRW(DYNMEM$,8);

   2853 41 005723   000010 036003                    ADLQ    8,DU
        41 005724   200116 756100                    STQ     DYNMEM$,,AUTO

     1212     2854    3               IF DYNMEM$->WRD1 = %QUAL THEN

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:217  
   2854 41 005725   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005726   000000 235100                    LDA     0,,PR0
        41 005727   000113 115007                    CMPA    75,DL
        41 005730   006024 601000 41                 TNZ     s:2871

     1213     2855    4               DO;

     1214     2856    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   2856 41 005731   000001 036003                    ADLQ    1,DU
        41 005732   200116 756100                    STQ     DYNMEM$,,AUTO

     1215     2857    4                   QRC_NAME = DYNMEM$->CHAR30;

   2857 41 005733   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 005734   040100 100500                    MLR     fill='040'O
        41 005735   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        41 005736   200046 000036                    ADSC9   QRC_NAME,,AUTO           cn=0,n=30

     1216     2858    4                   DYNMEM$ = PINCRW(DYNMEM$,8);

   2858 41 005737   000010 036003                    ADLQ    8,DU
        41 005740   200116 756100                    STQ     DYNMEM$,,AUTO

     1217     2859    4                   CALL ADD_SN(%ZIG_RTYPE_RC,QRC_NAME,0,LNO,FOUND,RELTYPE.NO_NR,0,0)

   2859 41 005741   000052 237000 42                 LDAQ    42
        41 005742   200130 757100                    STAQ    LNO+8,,AUTO
        41 005743   000054 237000 42                 LDAQ    44
        41 005744   200126 757100                    STAQ    LNO+6,,AUTO
        41 005745   200120 630500                    EPPR0   LNO,,AUTO
        41 005746   200125 450500                    STP0    LNO+5,,AUTO
        41 005747   000052 236000 42                 LDQ     42
        41 005750   200124 756100                    STQ     LNO+4,,AUTO
        41 005751   200046 631500                    EPPR1   QRC_NAME,,AUTO
        41 005752   200123 451500                    STP1    LNO+3,,AUTO
        41 005753   000056 236000 42                 LDQ     46
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:218  
        41 005754   200122 756100                    STQ     LNO+2,,AUTO
        41 005755   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005756   000045 631400 42                 EPPR1   37
        41 005757   000000 701000 xent               TSX1    ADD_SN
        41 005760   000000 011000                    NOP     0

     1218     2860    4                      ;
     1219     2861    4                   IF FOUND ~= %FOUNDDEF THEN

   2861 41 005761   000002 235000 17                 LDA     FOUND
        41 005762   000002 115007                    CMPA    2,DL
        41 005763   006015 600000 41                 TZE     s:2867

     1220     2862    5                   DO;

     1221     2863    5                       CALL INDEX(CT1,' ',FR_NAME);

   2863 41 005764   000000 124500                    SCM     mask='000'O
        41 005765   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 005766   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 005767   200005 000100                    ARG     CT1,,AUTO

     1222     2864    5                       CALL SET_FIELDS(1,CT1,FR_NAME);

   2864 41 005770   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 005771   200124 450500                    STP0    LNO+4,,AUTO
        41 005772   200005 631500                    EPPR1   CT1,,AUTO
        41 005773   200123 451500                    STP1    LNO+3,,AUTO
        41 005774   000014 236000 42                 LDQ     12
        41 005775   200122 756100                    STQ     LNO+2,,AUTO
        41 005776   200122 630500                    EPPR0   LNO+2,,AUTO
        41 005777   000012 631400 42                 EPPR1   10
        41 006000   000000 701000 xent               TSX1    SET_FIELDS
        41 006001   000000 011000                    NOP     0

     1223     2865    5                       CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4809);
              2865                                /*qualifying RC not DEFed */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:219  

   2865 41 006002   200120 235100                    LDA     LNO,,AUTO
        41 006003   000001 135007                    SBLA    1,DL
        41 006004   200122 755100                    STA     LNO+2,,AUTO
        41 006005   000060 237000 42                 LDAQ    48
        41 006006   200124 757100                    STAQ    LNO+4,,AUTO
        41 006007   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006010   200123 450500                    STP0    LNO+3,,AUTO
        41 006011   200123 630500                    EPPR0   LNO+3,,AUTO
        41 006012   000012 631400 42                 EPPR1   10
        41 006013   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 006014   000000 011000                    NOP     0

     1224     2866    5                       END;

     1225     2867    4                   CALL FINDNS_6('SN-SE   '); /* RC */

   2867 41 006015   000027 630400 42                 EPPR0   23
        41 006016   000003 631400 42                 EPPR1   3
        41 006017   000000 701000 xent               TSX1    FINDNS_6
        41 006020   000000 011000                    NOP     0

     1226     2868    4                   QRC_DBK = UWA.DIRECT_REF;

   2868 41 006021   000036 235000 39                 LDA     UWA+30
        41 006022   200045 755100                    STA     QRC_DBK,,AUTO

     1227     2869    4                   END;

   2869 41 006023   006025 710000 41                 TRA     s:2872

     1228     2870    3               ELSE
     1229     2871    3                   QRC_DBK = 0; /* not qualified */

   2871 41 006024   200045 450100                    STZ     QRC_DBK,,AUTO

     1230     2872    3               CALL ADD_SN(%ZIG_RTYPE_FR,FR_NAME,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:220  

   2872 41 006025   200045 630500                    EPPR0   QRC_DBK,,AUTO
        41 006026   200131 450500                    STP0    LNO+9,,AUTO
        41 006027   000063 236000 42                 LDQ     51
        41 006030   200130 756100                    STQ     LNO+8,,AUTO
        41 006031   000202 237000 42                 LDAQ    130
        41 006032   200126 757100                    STAQ    LNO+6,,AUTO
        41 006033   200120 631500                    EPPR1   LNO,,AUTO
        41 006034   200125 451500                    STP1    LNO+5,,AUTO
        41 006035   000052 236000 42                 LDQ     42
        41 006036   200124 756100                    STQ     LNO+4,,AUTO
        41 006037   200035 633500                    EPPR3   FR_NAME,,AUTO
        41 006040   200123 453500                    STP3    LNO+3,,AUTO
        41 006041   000066 236000 42                 LDQ     54
        41 006042   200122 756100                    STQ     LNO+2,,AUTO
        41 006043   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006044   000045 631400 42                 EPPR1   37
        41 006045   000000 701000 xent               TSX1    ADD_SN
        41 006046   000000 011000                    NOP     0

     1231     2873    3                  QRC_DBK);
     1232     2874    3               IF FOUND ~= %FOUNDDEF AND QRC_DBK ~= 0 THEN

   2874 41 006047   000002 235000 17                 LDA     FOUND
        41 006050   000002 115007                    CMPA    2,DL
        41 006051   006105 600000 41                 TZE     s:2885
        41 006052   200045 236100                    LDQ     QRC_DBK,,AUTO
        41 006053   006105 600000 41                 TZE     s:2885

     1233     2875    4               DO;

     1234     2876    4                   CALL INDEX(CT1,' ',FR_NAME);

   2876 41 006054   000000 124500                    SCM     mask='000'O
        41 006055   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 006056   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 006057   200005 000100                    ARG     CT1,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:221  

     1235     2877    4                   CALL SET_FIELDS(1,CT1,FR_NAME);

   2877 41 006060   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 006061   200124 450500                    STP0    LNO+4,,AUTO
        41 006062   200005 631500                    EPPR1   CT1,,AUTO
        41 006063   200123 451500                    STP1    LNO+3,,AUTO
        41 006064   000014 236000 42                 LDQ     12
        41 006065   200122 756100                    STQ     LNO+2,,AUTO
        41 006066   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006067   000012 631400 42                 EPPR1   10
        41 006070   000000 701000 xent               TSX1    SET_FIELDS
        41 006071   000000 011000                    NOP     0

     1236     2878    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4802);
              2878                            /* qualified but never defed */

   2878 41 006072   200120 235100                    LDA     LNO,,AUTO
        41 006073   000001 135007                    SBLA    1,DL
        41 006074   200122 755100                    STA     LNO+2,,AUTO
        41 006075   000206 237000 42                 LDAQ    134
        41 006076   200124 757100                    STAQ    LNO+4,,AUTO
        41 006077   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006100   200123 450500                    STP0    LNO+3,,AUTO
        41 006101   200123 630500                    EPPR0   LNO+3,,AUTO
        41 006102   000012 631400 42                 EPPR1   10
        41 006103   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 006104   000000 011000                    NOP     0

     1237     2879        /*E* ERROR:  ZIG-4802-C
     1238     2880            MESSAGE:  The LOCATION DIRECT field "%U1" is invalid because it
     1239     2881                      cannot be matched with a field of the record named
     1240     2882                      by the qualifier.
     1241     2883        */
     1242     2884    4                   END;

     1243     2885    3               IF FOUND = %FOUNDDUP THEN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:222  

   2885 41 006105   000002 235000 17                 LDA     FOUND
        41 006106   000003 115007                    CMPA    3,DL
        41 006107   006141 601000 41                 TNZ     s:2891

     1244     2886    4               DO;

     1245     2887    4                   CALL INDEX(CT1,' ',FR_NAME);

   2887 41 006110   000000 124500                    SCM     mask='000'O
        41 006111   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 006112   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 006113   200005 000100                    ARG     CT1,,AUTO

     1246     2888    4                   CALL SET_FIELDS(1,CT1,FR_NAME);

   2888 41 006114   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 006115   200124 450500                    STP0    LNO+4,,AUTO
        41 006116   200005 631500                    EPPR1   CT1,,AUTO
        41 006117   200123 451500                    STP1    LNO+3,,AUTO
        41 006120   000014 236000 42                 LDQ     12
        41 006121   200122 756100                    STQ     LNO+2,,AUTO
        41 006122   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006123   000012 631400 42                 EPPR1   10
        41 006124   000000 701000 xent               TSX1    SET_FIELDS
        41 006125   000000 011000                    NOP     0

     1247     2889    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4801); /* needs qualifier */

   2889 41 006126   200120 235100                    LDA     LNO,,AUTO
        41 006127   000001 135007                    SBLA    1,DL
        41 006130   200122 755100                    STA     LNO+2,,AUTO
        41 006131   000070 237000 42                 LDAQ    56
        41 006132   200124 757100                    STAQ    LNO+4,,AUTO
        41 006133   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006134   200123 450500                    STP0    LNO+3,,AUTO
        41 006135   200123 630500                    EPPR0   LNO+3,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:223  
        41 006136   000012 631400 42                 EPPR1   10
        41 006137   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 006140   000000 011000                    NOP     0

     1248     2890    4                   END;

     1249     2891    3               IF FOUND = %NOTFOUND AND QRC_DBK = 0 THEN /* 1st ref of dbparam */

   2891 41 006141   000002 235000 17                 LDA     FOUND
        41 006142   006206 601000 41                 TNZ     s:2905
        41 006143   200045 236100                    LDQ     QRC_DBK,,AUTO
        41 006144   006206 601000 41                 TNZ     s:2905

     1250     2892    4               DO;

     1251     2893    4                   DBK_SN = UWA.DIRECT_REF;

   2893 41 006145   000036 235000 39                 LDA     UWA+30
        41 006146   200023 755100                    STA     DBK_SN,,AUTO

     1252     2894    4                   CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC); /* RC */

   2894 41 006147   000076 630400 42                 EPPR0   62
        41 006150   000000 631400 42                 EPPR1   0
        41 006151   000000 701000 xent               TSX1    FINDD_6
        41 006152   000000 011000                    NOP     0

     1253     2895    4                   UWA.FR = '0'B;

   2895 41 006153   000000 100400                    MLR     fill='000'O
        41 006154   000051 000001 42                 ADSC9   41                       cn=0,n=1
        41 006155   000332 000104 39                 ADSC9   UWA+218                  cn=0,n=68

     1254     2896    4                   UWA.FR.REF = 1;

   2896 41 006156   000001 235007                    LDA     1,DL
        41 006157   000333 755000 39                 STA     UWA+219
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:224  

     1255     2897    4                   UWA.FR.PREC = 35;

   2897 41 006160   000043 236007                    LDQ     35,DL
        41 006161   000335 756000 39                 STQ     UWA+221

     1256     2898    4                   UWA.FR.F_USE = 1;

   2898 41 006162   000343 755000 39                 STA     UWA+227

     1257     2899    4                   UWA.FR.BEIST = 2; /* Misuse to signify DIRECT dbparam */

   2899 41 006163   000002 235007                    LDA     2,DL
        41 006164   000350 755000 39                 STA     UWA+232

     1258     2900    4                   CALL FINDD_6('SN      ',DBK_SN); /* SN */

   2900 41 006165   200023 630500                    EPPR0   DBK_SN,,AUTO
        41 006166   200123 450500                    STP0    LNO+3,,AUTO
        41 006167   000010 236000 42                 LDQ     8
        41 006170   200122 756100                    STQ     LNO+2,,AUTO
        41 006171   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006172   000000 631400 42                 EPPR1   0
        41 006173   000000 701000 xent               TSX1    FINDD_6
        41 006174   000000 011000                    NOP     0

     1259     2901    4                   CALL STRE_6('FR      '); /* RFR */

   2901 41 006175   000073 630400 42                 EPPR0   59
        41 006176   000003 631400 42                 EPPR1   3
        41 006177   000000 701000 xent               TSX1    STRE_6
        41 006200   000000 011000                    NOP     0

     1260     2902    4                   UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   2902 41 006201   000220 054000 39                 AOS     UWA+144

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:225  
     1261     2903    4                   CALL CONNECT_6('SN-SE   ');

   2903 41 006202   000027 630400 42                 EPPR0   23
        41 006203   000003 631400 42                 EPPR1   3
        41 006204   000000 701000 xent               TSX1    CONNECT_6
        41 006205   000000 011000                    NOP     0

     1262     2904    4                   END;

     1263     2905    3               CALL FCURR_R_6('SN      '); /* SN */

   2905 41 006206   000010 630400 42                 EPPR0   8
        41 006207   000003 631400 42                 EPPR1   3
        41 006210   000000 701000 xent               TSX1    FCURR_R_6
        41 006211   000000 011000                    NOP     0

     1264     2906    3               CALL FETCHNS_6('SN-SE   '); /* RFR */

   2906 41 006212   000027 630400 42                 EPPR0   23
        41 006213   000003 631400 42                 EPPR1   3
        41 006214   000000 701000 xent               TSX1    FETCHNS_6
        41 006215   000000 011000                    NOP     0

     1265     2907    3               IF UWA.FR.FTYPE ~= 0 THEN /* not type dbkey */

   2907 41 006216   000334 235000 39                 LDA     UWA+220
        41 006217   006251 600000 41                 TZE     s:2917

     1266     2908    4               DO;

     1267     2909    4                   CALL INDEX(CT1,' ',FR_NAME);

   2909 41 006220   000000 124500                    SCM     mask='000'O
        41 006221   200035 000036                    ADSC9   FR_NAME,,AUTO            cn=0,n=30
        41 006222   000011 000001 42                 ADSC9   9                        cn=0,n=1
        41 006223   200005 000100                    ARG     CT1,,AUTO

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:226  
     1268     2910    4                   CALL SET_FIELDS(1,CT1,FR_NAME);

   2910 41 006224   200035 630500                    EPPR0   FR_NAME,,AUTO
        41 006225   200124 450500                    STP0    LNO+4,,AUTO
        41 006226   200005 631500                    EPPR1   CT1,,AUTO
        41 006227   200123 451500                    STP1    LNO+3,,AUTO
        41 006230   000014 236000 42                 LDQ     12
        41 006231   200122 756100                    STQ     LNO+2,,AUTO
        41 006232   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006233   000012 631400 42                 EPPR1   10
        41 006234   000000 701000 xent               TSX1    SET_FIELDS
        41 006235   000000 011000                    NOP     0

     1269     2911    4                   CALL ZIG$D_DIAG(LNO-1,%ERR_SEV,4803);

   2911 41 006236   200120 235100                    LDA     LNO,,AUTO
        41 006237   000001 135007                    SBLA    1,DL
        41 006240   200122 755100                    STA     LNO+2,,AUTO
        41 006241   000210 237000 42                 LDAQ    136
        41 006242   200124 757100                    STAQ    LNO+4,,AUTO
        41 006243   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006244   200123 450500                    STP0    LNO+3,,AUTO
        41 006245   200123 630500                    EPPR0   LNO+3,,AUTO
        41 006246   000012 631400 42                 EPPR1   10
        41 006247   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 006250   000000 011000                    NOP     0

     1270     2912        /*E*  ERROR: ZIG-4803-C
     1271     2913            MESSAGE: The LOCATION DIRECT field "%U1" is invalid because it
     1272     2914                     does not have a data type of DATA_BASE_KEY.
     1273     2915        */
     1274     2916    4                   END;

     1275     2917    3               UWA.FR.REF = 1;

   2917 41 006251   000001 235007                    LDA     1,DL
        41 006252   000333 755000 39                 STA     UWA+219
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:227  

     1276     2918    3               CALL MODIFY_6('FR      '); /* RFR */

   2918 41 006253   000073 630400 42                 EPPR0   59
        41 006254   000003 631400 42                 EPPR1   3
        41 006255   000000 701000 xent               TSX1    MODIFY_6
        41 006256   000000 011000                    NOP     0

     1277     2919    3               DBK_RFR = UWA.DIRECT_REF;

   2919 41 006257   000036 235000 39                 LDA     UWA+30
        41 006260   200022 755100                    STA     DBK_RFR,,AUTO

     1278     2920    3               CALL FINDD_6('RC      ',THIS_RC); /* LOC MODE RC */

   2920 41 006261   200033 630500                    EPPR0   THIS_RC,,AUTO
        41 006262   200123 450500                    STP0    LNO+3,,AUTO
        41 006263   000007 236000 42                 LDQ     7
        41 006264   200122 756100                    STQ     LNO+2,,AUTO
        41 006265   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006266   000000 631400 42                 EPPR1   0
        41 006267   000000 701000 xent               TSX1    FINDD_6
        41 006270   000000 011000                    NOP     0

     1279     2921    3               UWA.FR.SYN = 1;

   2921 41 006271   000001 235007                    LDA     1,DL
        41 006272   000332 755000 39                 STA     UWA+218

     1280     2922    3               UWA.FR.REF = 0;

   2922 41 006273   000333 450000 39                 STZ     UWA+219

     1281     2923    3               UWA.FR.F_USE = 3;

   2923 41 006274   000003 236007                    LDQ     3,DL
        41 006275   000343 756000 39                 STQ     UWA+227
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:228  

     1282     2924    3               UWA.FR.LEVEL = 0;

   2924 41 006276   000346 450000 39                 STZ     UWA+230

     1283     2925    3               UWA.FR.BEIST = 0;

   2925 41 006277   000350 450000 39                 STZ     UWA+232

     1284     2926    3               UWA.FR.FR_FRH = DBK_RFR;

   2926 41 006300   200022 235100                    LDA     DBK_RFR,,AUTO
        41 006301   000352 755000 39                 STA     UWA+234

     1285     2927    3               CALL STRE_6('FR      '); /* SFR */

   2927 41 006302   000073 630400 42                 EPPR0   59
        41 006303   000003 631400 42                 EPPR1   3
        41 006304   000000 701000 xent               TSX1    STRE_6
        41 006305   000000 011000                    NOP     0

     1286     2928    3               END; /* CASE */

     1287     2929    2           END; /* DO WHILE */

   2929 41 006306   200116 470500                    LDP0    DYNMEM$,,AUTO
        41 006307   000000 235100                    LDA     0,,PR0
        41 006310   000144 115007                    CMPA    100,DL
        41 006311   000435 601000 41                 TNZ     s:1868

     1288     2930        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:229  
     1289     2931        /*
     1290     2932
     1291     2933
     1292     2934
     1293     2935        */
     1294     2936
     1295     2937    1       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);

   2937 41 006312   000001 630400 42                 EPPR0   1
        41 006313   000000 631400 42                 EPPR1   0
        41 006314   000000 701000 xent               TSX1    FINDD_6
        41 006315   000000 011000                    NOP     0

     1296     2938    1       CALL FINDNS_6('OA-RC   ');

   2938 41 006316   000006 630400 42                 EPPR0   6
        41 006317   000003 631400 42                 EPPR1   3
        41 006320   000000 701000 xent               TSX1    FINDNS_6
        41 006321   000000 011000                    NOP     0

     1297     2939    2       DO WHILE UWA.DB_STATUS ~= '0502100';

   2939 41 006322   040000 106400                    CMPC    fill='040'O
        41 006323   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 006324   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 006325   007143 600000 41                 TZE     s:3091

     1298     2940    2           IF UWA.DIRECT_REF = DBK_STAR_DBPARAM_RC

   2940 41 006326   000036 236000 39                 LDQ     UWA+30
        41 006327   000000 116000 18                 CMPQ    DBK_STAR_DBPARAM_RC
        41 006330   006540 601000 41                 TNZ     s:2998

     1299     2941    3           THEN DO;

     1300     2942    3               FOUND_DIRECT = '0'B;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:230  
   2942 41 006331   200073 450100                    STZ     FOUND_DIRECT,,AUTO

     1301     2943    3               CALL FETCHPS_6('RC-FR   ');

   2943 41 006332   000042 630400 42                 EPPR0   34
        41 006333   000003 631400 42                 EPPR1   3
        41 006334   000000 701000 xent               TSX1    FETCHPS_6
        41 006335   000000 011000                    NOP     0

     1302     2944    3               MOVE_MEM = UWA.DIRECT_REF;

   2944 41 006336   000036 235000 39                 LDA     UWA+30
        41 006337   200075 755100                    STA     MOVE_MEM,,AUTO

     1303     2945    3               PREV_MEM = 0;

   2945 41 006340   200100 450100                    STZ     PREV_MEM,,AUTO

     1304     2946    3               FIRST_FR = '1'B;

   2946 41 006341   400000 236003                    LDQ     -131072,DU
        41 006342   200072 756100                    STQ     FIRST_FR,,AUTO

     1305     2947    4               DO WHILE UWA.DB_STATUS ~= '0502100' AND UWA.FR.BEIST ~= 1

   2947 41 006343   006422 710000 41                 TRA     s:2967

     1306     2948    4                  AND MOVE_MEM ~= PREV_MEM;
     1307     2949    4                   IF UWA.FR.BEIST = 2

   2949 41 006344   000350 235000 39                 LDA     UWA+232
        41 006345   000002 115007                    CMPA    2,DL
        41 006346   006415 601000 41                 TNZ     s:2965

     1308     2950    5                   THEN DO;

     1309     2951    5                       FOUND_DIRECT = '1'B;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:231  

   2951 41 006347   400000 236003                    LDQ     -131072,DU
        41 006350   200073 756100                    STQ     FOUND_DIRECT,,AUTO

     1310     2952    5                       IF NOT FIRST_FR

   2952 41 006351   200072 234100                    SZN     FIRST_FR,,AUTO
        41 006352   006410 604000 41                 TMI     s:2962

     1311     2953    6                       THEN DO;

     1312     2954    6                           MOVE_MEM = UWA.DIRECT_REF;

   2954 41 006353   000036 235000 39                 LDA     UWA+30
        41 006354   200075 755100                    STA     MOVE_MEM,,AUTO

     1313     2955    6                           CALL FINDPS_6('RC-FR   ');

   2955 41 006355   000042 630400 42                 EPPR0   34
        41 006356   000003 631400 42                 EPPR1   3
        41 006357   000000 701000 xent               TSX1    FINDPS_6
        41 006360   000000 011000                    NOP     0

     1314     2956    6                           PREV_MEM = UWA.DIRECT_REF;

   2956 41 006361   000036 235000 39                 LDA     UWA+30
        41 006362   200100 755100                    STA     PREV_MEM,,AUTO

     1315     2957    6                           CALL FINDD_6('FR      ',MOVE_MEM);

   2957 41 006363   200075 630500                    EPPR0   MOVE_MEM,,AUTO
        41 006364   200123 450500                    STP0    LNO+3,,AUTO
        41 006365   000073 236000 42                 LDQ     59
        41 006366   200122 756100                    STQ     LNO+2,,AUTO
        41 006367   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006370   000000 631400 42                 EPPR1   0
        41 006371   000000 701000 xent               TSX1    FINDD_6
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:232  
        41 006372   000000 011000                    NOP     0

     1316     2958    6                           CALL MODIFYMEM_6('FR      ');

   2958 41 006373   000073 630400 42                 EPPR0   59
        41 006374   000003 631400 42                 EPPR1   3
        41 006375   000000 701000 xent               TSX1    MODIFYMEM_6
        41 006376   000000 011000                    NOP     0

     1317     2959    6                           CALL FETCHD_6('FR      ',PREV_MEM);

   2959 41 006377   200100 630500                    EPPR0   PREV_MEM,,AUTO
        41 006400   200123 450500                    STP0    LNO+3,,AUTO
        41 006401   000073 236000 42                 LDQ     59
        41 006402   200122 756100                    STQ     LNO+2,,AUTO
        41 006403   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006404   000000 631400 42                 EPPR1   0
        41 006405   000000 701000 xent               TSX1    FETCHD_6
        41 006406   000000 011000                    NOP     0

     1318     2960    6                           END;

   2960 41 006407   006421 710000 41                 TRA     s:2966

     1319     2961    5                       ELSE
     1320     2962    5                           CALL FETCHPS_6('RC-FR   ');

   2962 41 006410   000042 630400 42                 EPPR0   34
        41 006411   000003 631400 42                 EPPR1   3
        41 006412   000000 701000 xent               TSX1    FETCHPS_6
        41 006413   000000 011000                    NOP     0

     1321     2963    5                       END;

   2963 41 006414   006421 710000 41                 TRA     s:2966

     1322     2964    4                   ELSE
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:233  
     1323     2965    4                       CALL FETCHPS_6('RC-FR   ');

   2965 41 006415   000042 630400 42                 EPPR0   34
        41 006416   000003 631400 42                 EPPR1   3
        41 006417   000000 701000 xent               TSX1    FETCHPS_6
        41 006420   000000 011000                    NOP     0

     1324     2966    4                   FIRST_FR = '0'B;

   2966 41 006421   200072 450100                    STZ     FIRST_FR,,AUTO

     1325     2967    4                   END;

   2967 41 006422   040000 106400                    CMPC    fill='040'O
        41 006423   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 006424   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 006425   006434 600000 41                 TZE     s:2969
        41 006426   000350 235000 39                 LDA     UWA+232
        41 006427   000001 115007                    CMPA    1,DL
        41 006430   006434 600000 41                 TZE     s:2969
        41 006431   200075 236100                    LDQ     MOVE_MEM,,AUTO
        41 006432   200100 116100                    CMPQ    PREV_MEM,,AUTO
        41 006433   006344 601000 41                 TNZ     s:2949

     1326     2968
     1327     2969    3               IF FOUND_DIRECT

   2969 41 006434   200073 234100                    SZN     FOUND_DIRECT,,AUTO
        41 006435   006505 605000 41                 TPL     s:2983

     1328     2970    4               THEN DO;

     1329     2971    4                   IF UWA.FR.BEIST = 1 THEN

   2971 41 006436   000350 235000 39                 LDA     UWA+232
        41 006437   000001 115007                    CMPA    1,DL
        41 006440   006445 601000 41                 TNZ     s:2973
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:234  

     1330     2972    4                       CALL FETCHNS_6('RC-FR   ');

   2972 41 006441   000042 630400 42                 EPPR0   34
        41 006442   000003 631400 42                 EPPR1   3
        41 006443   000000 701000 xent               TSX1    FETCHNS_6
        41 006444   000000 011000                    NOP     0

     1331     2973    5                   DO WHILE UWA.FR.BEIST = 0;

   2973 41 006445   000350 235000 39                 LDA     UWA+232
        41 006446   006505 601000 41                 TNZ     s:2983

     1332     2974    5                       MOVE_MEM = UWA.DIRECT_REF;

   2974 41 006447   000036 235000 39                 LDA     UWA+30
        41 006450   200075 755100                    STA     MOVE_MEM,,AUTO

     1333     2975    5                       CALL FINDNS_6('RC-FR   ');

   2975 41 006451   000042 630400 42                 EPPR0   34
        41 006452   000003 631400 42                 EPPR1   3
        41 006453   000000 701000 xent               TSX1    FINDNS_6
        41 006454   000000 011000                    NOP     0

     1334     2976    5                       NEXT_MEM = UWA.DIRECT_REF;

   2976 41 006455   000036 235000 39                 LDA     UWA+30
        41 006456   200076 755100                    STA     NEXT_MEM,,AUTO

     1335     2977    5                       CALL FINDD_6('FR      ',MOVE_MEM);

   2977 41 006457   200075 630500                    EPPR0   MOVE_MEM,,AUTO
        41 006460   200123 450500                    STP0    LNO+3,,AUTO
        41 006461   000073 236000 42                 LDQ     59
        41 006462   200122 756100                    STQ     LNO+2,,AUTO
        41 006463   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:235  
        41 006464   000000 631400 42                 EPPR1   0
        41 006465   000000 701000 xent               TSX1    FINDD_6
        41 006466   000000 011000                    NOP     0

     1336     2978    5                       CALL MODIFYMEM_6('FR      ');

   2978 41 006467   000073 630400 42                 EPPR0   59
        41 006470   000003 631400 42                 EPPR1   3
        41 006471   000000 701000 xent               TSX1    MODIFYMEM_6
        41 006472   000000 011000                    NOP     0

     1337     2979    5                       CALL FETCHD_6('FR      ',NEXT_MEM);

   2979 41 006473   200076 630500                    EPPR0   NEXT_MEM,,AUTO
        41 006474   200123 450500                    STP0    LNO+3,,AUTO
        41 006475   000073 236000 42                 LDQ     59
        41 006476   200122 756100                    STQ     LNO+2,,AUTO
        41 006477   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006500   000000 631400 42                 EPPR1   0
        41 006501   000000 701000 xent               TSX1    FETCHD_6
        41 006502   000000 011000                    NOP     0

     1338     2980    5                       END;

   2980 41 006503   000350 235000 39                 LDA     UWA+232
        41 006504   006447 600000 41                 TZE     s:2974

     1339     2981    4                   END;

     1340     2982
     1341     2983    3               DONE = '0'B;

   2983 41 006505   200071 450100                    STZ     DONE,,AUTO

     1342     2984    3               CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);

   2984 41 006506   000076 630400 42                 EPPR0   62
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:236  
        41 006507   000000 631400 42                 EPPR1   0
        41 006510   000000 701000 xent               TSX1    FINDD_6
        41 006511   000000 011000                    NOP     0

     1343     2985    4               DO WHILE NOT DONE AND UWA.DB_STATUS ~= '0502100';

   2985 41 006512   006531 710000 41                 TRA     s:2994

     1344     2986    4                   CALL FETCHNS_6('RC-FR   ');

   2986 41 006513   000042 630400 42                 EPPR0   34
        41 006514   000003 631400 42                 EPPR1   3
        41 006515   000000 701000 xent               TSX1    FETCHNS_6
        41 006516   000000 011000                    NOP     0

     1345     2987    4                   IF UWA.FR.BEIST ~= 0

   2987 41 006517   000350 235000 39                 LDA     UWA+232
        41 006520   006527 600000 41                 TZE     s:2993

     1346     2988    5                   THEN DO;

     1347     2989    5                       UWA.FR.BEIST = 0;

   2989 41 006521   000350 450000 39                 STZ     UWA+232

     1348     2990    5                       CALL MODIFY_6('FR      ');

   2990 41 006522   000073 630400 42                 EPPR0   59
        41 006523   000003 631400 42                 EPPR1   3
        41 006524   000000 701000 xent               TSX1    MODIFY_6
        41 006525   000000 011000                    NOP     0

     1349     2991    5                       END;

   2991 41 006526   006531 710000 41                 TRA     s:2994

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:237  
     1350     2992    4                   ELSE
     1351     2993    4                       DONE = '1'B;

   2993 41 006527   400000 236003                    LDQ     -131072,DU
        41 006530   200071 756100                    STQ     DONE,,AUTO

     1352     2994    4                   END;

   2994 41 006531   200071 234100                    SZN     DONE,,AUTO
        41 006532   006537 604000 41                 TMI     s:2996
        41 006533   040000 106400                    CMPC    fill='040'O
        41 006534   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 006535   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 006536   006513 601000 41                 TNZ     s:2986

     1353     2995
     1354     2996    3               END;

   2996 41 006537   007133 710000 41                 TRA     s:3084

     1355     2997    3           ELSE DO;

     1356     2998    3               FOUND_SYN = '0'B;

   2998 41 006540   200074 450100                    STZ     FOUND_SYN,,AUTO

     1357     2999    3               OWNER_RC = UWA.DIRECT_REF;

   2999 41 006541   200077 756100                    STQ     OWNER_RC,,AUTO

     1358     3000    3               CALL FETCHPS_6('RC-FR   ');

   3000 41 006542   000042 630400 42                 EPPR0   34
        41 006543   000003 631400 42                 EPPR1   3
        41 006544   000000 701000 xent               TSX1    FETCHPS_6
        41 006545   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:238  
     1359     3001    3               MOVE_MEM = UWA.DIRECT_REF;

   3001 41 006546   000036 235000 39                 LDA     UWA+30
        41 006547   200075 755100                    STA     MOVE_MEM,,AUTO

     1360     3002    3               PREV_MEM = 0;

   3002 41 006550   200100 450100                    STZ     PREV_MEM,,AUTO

     1361     3003    3               FIRST_FR = '1'B;

   3003 41 006551   400000 236003                    LDQ     -131072,DU
        41 006552   200072 756100                    STQ     FIRST_FR,,AUTO

     1362     3004    4               DO WHILE UWA.DB_STATUS ~= '0502100' AND UWA.FR.SYN = 1

   3004 41 006553   006622 710000 41                 TRA     s:3021

     1363     3005    4                  AND ( UWA.FR.F_USE = 4 OR UWA.FR.F_USE = 5 )
     1364     3006    4                  AND MOVE_MEM ~= PREV_MEM;
     1365     3007    4                   FOUND_SYN = '1'B;

   3007 41 006554   400000 236003                    LDQ     -131072,DU
        41 006555   200074 756100                    STQ     FOUND_SYN,,AUTO

     1366     3008    4                   IF NOT FIRST_FR

   3008 41 006556   200072 234100                    SZN     FIRST_FR,,AUTO
        41 006557   006615 604000 41                 TMI     s:3018

     1367     3009    5                   THEN DO;

     1368     3010    5                       MOVE_MEM = UWA.DIRECT_REF;

   3010 41 006560   000036 235000 39                 LDA     UWA+30
        41 006561   200075 755100                    STA     MOVE_MEM,,AUTO

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:239  
     1369     3011    5                       CALL FINDPS_6('RC-FR    ');

   3011 41 006562   000212 630400 42                 EPPR0   138
        41 006563   000003 631400 42                 EPPR1   3
        41 006564   000000 701000 xent               TSX1    FINDPS_6
        41 006565   000000 011000                    NOP     0

     1370     3012    5                       PREV_MEM = UWA.DIRECT_REF;

   3012 41 006566   000036 235000 39                 LDA     UWA+30
        41 006567   200100 755100                    STA     PREV_MEM,,AUTO

     1371     3013    5                       CALL FINDD_6('FR      ',MOVE_MEM);

   3013 41 006570   200075 630500                    EPPR0   MOVE_MEM,,AUTO
        41 006571   200123 450500                    STP0    LNO+3,,AUTO
        41 006572   000073 236000 42                 LDQ     59
        41 006573   200122 756100                    STQ     LNO+2,,AUTO
        41 006574   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006575   000000 631400 42                 EPPR1   0
        41 006576   000000 701000 xent               TSX1    FINDD_6
        41 006577   000000 011000                    NOP     0

     1372     3014    5                       CALL MODIFYMEM_6('FR      ');

   3014 41 006600   000073 630400 42                 EPPR0   59
        41 006601   000003 631400 42                 EPPR1   3
        41 006602   000000 701000 xent               TSX1    MODIFYMEM_6
        41 006603   000000 011000                    NOP     0

     1373     3015    5                       CALL FETCHD_6('FR      ',PREV_MEM);

   3015 41 006604   200100 630500                    EPPR0   PREV_MEM,,AUTO
        41 006605   200123 450500                    STP0    LNO+3,,AUTO
        41 006606   000073 236000 42                 LDQ     59
        41 006607   200122 756100                    STQ     LNO+2,,AUTO
        41 006610   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:240  
        41 006611   000000 631400 42                 EPPR1   0
        41 006612   000000 701000 xent               TSX1    FETCHD_6
        41 006613   000000 011000                    NOP     0

     1374     3016    5                       END;

   3016 41 006614   006622 710000 41                 TRA     s:3021

     1375     3017    5                   ELSE DO;

     1376     3018    5                       FIRST_FR = '0'B;

   3018 41 006615   200072 450100                    STZ     FIRST_FR,,AUTO

     1377     3019    5                       CALL FETCHPS_6('RC-FR   ');

   3019 41 006616   000042 630400 42                 EPPR0   34
        41 006617   000003 631400 42                 EPPR1   3
        41 006620   000000 701000 xent               TSX1    FETCHPS_6
        41 006621   000000 011000                    NOP     0

     1378     3020    5                       END;

     1379     3021    4                   END;

   3021 41 006622   040000 106400                    CMPC    fill='040'O
        41 006623   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 006624   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 006625   006641 600000 41                 TZE     s:3023
        41 006626   000332 235000 39                 LDA     UWA+218
        41 006627   000001 115007                    CMPA    1,DL
        41 006630   006641 601000 41                 TNZ     s:3023
        41 006631   000343 236000 39                 LDQ     UWA+227
        41 006632   000004 116007                    CMPQ    4,DL
        41 006633   006636 600000 41                 TZE     s:3021+12
        41 006634   000005 116007                    CMPQ    5,DL
        41 006635   006641 601000 41                 TNZ     s:3023
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:241  
        41 006636   200075 236100                    LDQ     MOVE_MEM,,AUTO
        41 006637   200100 116100                    CMPQ    PREV_MEM,,AUTO
        41 006640   006554 601000 41                 TNZ     s:3007

     1380     3022
     1381     3023    3               CALL FINDD_6('RC      ',OWNER_RC);

   3023 41 006641   200077 630500                    EPPR0   OWNER_RC,,AUTO
        41 006642   200123 450500                    STP0    LNO+3,,AUTO
        41 006643   000007 236000 42                 LDQ     7
        41 006644   200122 756100                    STQ     LNO+2,,AUTO
        41 006645   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006646   000000 631400 42                 EPPR1   0
        41 006647   000000 701000 xent               TSX1    FINDD_6
        41 006650   000000 011000                    NOP     0

     1382     3024    3               CALL FETCHNS_6('RC-FR   ');

   3024 41 006651   000042 630400 42                 EPPR0   34
        41 006652   000003 631400 42                 EPPR1   3
        41 006653   000000 701000 xent               TSX1    FETCHNS_6
        41 006654   000000 011000                    NOP     0

     1383     3025    3               MOVE_MEM = UWA.DIRECT_REF;

   3025 41 006655   000036 235000 39                 LDA     UWA+30
        41 006656   200075 755100                    STA     MOVE_MEM,,AUTO

     1384     3026    3               PREV_MEM = 0;

   3026 41 006657   200100 450100                    STZ     PREV_MEM,,AUTO

     1385     3027    4               DO WHILE UWA.DB_STATUS ~= '0502100' AND UWA.FR.SYN=1

   3027 41 006660   006727 710000 41                 TRA     s:3041

     1386     3028    4                  AND MOVE_MEM ~= PREV_MEM;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:242  
     1387     3029    4                   IF UWA.FR.F_USE = 7

   3029 41 006661   000343 235000 39                 LDA     UWA+227
        41 006662   000007 115007                    CMPA    7,DL
        41 006663   006723 601000 41                 TNZ     s:3040

     1388     3030    5                   THEN DO;

     1389     3031    5                       FOUND_SYN = '1'B;

   3031 41 006664   400000 236003                    LDQ     -131072,DU
        41 006665   200074 756100                    STQ     FOUND_SYN,,AUTO

     1390     3032    5                       MOVE_MEM = UWA.DIRECT_REF;

   3032 41 006666   000036 235000 39                 LDA     UWA+30
        41 006667   200075 755100                    STA     MOVE_MEM,,AUTO

     1391     3033    5                       CALL FINDNS_6('RC-FR   ');

   3033 41 006670   000042 630400 42                 EPPR0   34
        41 006671   000003 631400 42                 EPPR1   3
        41 006672   000000 701000 xent               TSX1    FINDNS_6
        41 006673   000000 011000                    NOP     0

     1392     3034    5                       NEXT_MEM = UWA.DIRECT_REF;

   3034 41 006674   000036 235000 39                 LDA     UWA+30
        41 006675   200076 755100                    STA     NEXT_MEM,,AUTO

     1393     3035    5                       CALL FINDD_6('FR      ',MOVE_MEM);

   3035 41 006676   200075 630500                    EPPR0   MOVE_MEM,,AUTO
        41 006677   200123 450500                    STP0    LNO+3,,AUTO
        41 006700   000073 236000 42                 LDQ     59
        41 006701   200122 756100                    STQ     LNO+2,,AUTO
        41 006702   200122 630500                    EPPR0   LNO+2,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:243  
        41 006703   000000 631400 42                 EPPR1   0
        41 006704   000000 701000 xent               TSX1    FINDD_6
        41 006705   000000 011000                    NOP     0

     1394     3036    5                       CALL MODIFYMEM_6('FR      ');

   3036 41 006706   000073 630400 42                 EPPR0   59
        41 006707   000003 631400 42                 EPPR1   3
        41 006710   000000 701000 xent               TSX1    MODIFYMEM_6
        41 006711   000000 011000                    NOP     0

     1395     3037    5                       CALL FETCHD_6('FR      ',NEXT_MEM);

   3037 41 006712   200076 630500                    EPPR0   NEXT_MEM,,AUTO
        41 006713   200123 450500                    STP0    LNO+3,,AUTO
        41 006714   000073 236000 42                 LDQ     59
        41 006715   200122 756100                    STQ     LNO+2,,AUTO
        41 006716   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006717   000000 631400 42                 EPPR1   0
        41 006720   000000 701000 xent               TSX1    FETCHD_6
        41 006721   000000 011000                    NOP     0

     1396     3038    5                       END;

   3038 41 006722   006727 710000 41                 TRA     s:3041

     1397     3039    4                   ELSE
     1398     3040    4                       CALL FETCHNS_6('RC-FR   ');

   3040 41 006723   000042 630400 42                 EPPR0   34
        41 006724   000003 631400 42                 EPPR1   3
        41 006725   000000 701000 xent               TSX1    FETCHNS_6
        41 006726   000000 011000                    NOP     0

     1399     3041    4                   END;

   3041 41 006727   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:244  
        41 006730   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 006731   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 006732   006741 600000 41                 TZE     s:3043
        41 006733   000332 235000 39                 LDA     UWA+218
        41 006734   000001 115007                    CMPA    1,DL
        41 006735   006741 601000 41                 TNZ     s:3043
        41 006736   200075 236100                    LDQ     MOVE_MEM,,AUTO
        41 006737   200100 116100                    CMPQ    PREV_MEM,,AUTO
        41 006740   006661 601000 41                 TNZ     s:3029

     1400     3042
     1401     3043    3               DONE = '0'B;

   3043 41 006741   200071 450100                    STZ     DONE,,AUTO

     1402     3044    3               CALL FINDD_6('RC      ',OWNER_RC);

   3044 41 006742   200077 630500                    EPPR0   OWNER_RC,,AUTO
        41 006743   200123 450500                    STP0    LNO+3,,AUTO
        41 006744   000007 236000 42                 LDQ     7
        41 006745   200122 756100                    STQ     LNO+2,,AUTO
        41 006746   200122 630500                    EPPR0   LNO+2,,AUTO
        41 006747   000000 631400 42                 EPPR1   0
        41 006750   000000 701000 xent               TSX1    FINDD_6
        41 006751   000000 011000                    NOP     0

     1403     3045    3               CALL FETCHNS_6('RC-FR   ');

   3045 41 006752   000042 630400 42                 EPPR0   34
        41 006753   000003 631400 42                 EPPR1   3
        41 006754   000000 701000 xent               TSX1    FETCHNS_6
        41 006755   000000 011000                    NOP     0

     1404     3046    4               DO WHILE NOT DONE AND UWA.DB_STATUS ~= '0502100';

   3046 41 006756   007013 710000 41                 TRA     s:3059

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:245  
     1405     3047    4                   IF UWA.FR.SYN = 1 AND UWA.FR.F_USE = 3

   3047 41 006757   000332 235000 39                 LDA     UWA+218
        41 006760   000001 115007                    CMPA    1,DL
        41 006761   006775 601000 41                 TNZ     s:3054
        41 006762   000343 236000 39                 LDQ     UWA+227
        41 006763   000003 116007                    CMPQ    3,DL
        41 006764   006775 601000 41                 TNZ     s:3054

     1406     3048    5                   THEN DO;

     1407     3049    5                       FOUND_SYN = '1'B;

   3049 41 006765   400000 236003                    LDQ     -131072,DU
        41 006766   200074 756100                    STQ     FOUND_SYN,,AUTO

     1408     3050    5                       DONE = '1'B;

   3050 41 006767   200071 756100                    STQ     DONE,,AUTO

     1409     3051    5                       CALL MODIFYMEM_6('FR      ');

   3051 41 006770   000073 630400 42                 EPPR0   59
        41 006771   000003 631400 42                 EPPR1   3
        41 006772   000000 701000 xent               TSX1    MODIFYMEM_6
        41 006773   000000 011000                    NOP     0

     1410     3052    5                       END;

   3052 41 006774   007013 710000 41                 TRA     s:3059

     1411     3053    5                   ELSE DO;

     1412     3054    5                       IF UWA.FR.SYN = 1 AND ( UWA.FR.F_USE = 4 OR UWA.FR.F_USE = 5 )
              3054                                THEN

   3054 41 006775   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:246  
        41 006776   007007 601000 41                 TNZ     s:3057
        41 006777   000343 236000 39                 LDQ     UWA+227
        41 007000   000004 116007                    CMPQ    4,DL
        41 007001   007004 600000 41                 TZE     s:3055
        41 007002   000005 116007                    CMPQ    5,DL
        41 007003   007007 601000 41                 TNZ     s:3057

     1413     3055    5                           DONE = '1'B;

   3055 41 007004   400000 236003                    LDQ     -131072,DU
        41 007005   200071 756100                    STQ     DONE,,AUTO
        41 007006   007013 710000 41                 TRA     s:3059

     1414     3056    5                       ELSE
     1415     3057    5                           CALL FETCHNS_6('RC-FR   ');

   3057 41 007007   000042 630400 42                 EPPR0   34
        41 007010   000003 631400 42                 EPPR1   3
        41 007011   000000 701000 xent               TSX1    FETCHNS_6
        41 007012   000000 011000                    NOP     0

     1416     3058    5                       END;

     1417     3059    4                   END;

   3059 41 007013   200071 234100                    SZN     DONE,,AUTO
        41 007014   007021 604000 41                 TMI     s:3061
        41 007015   040000 106400                    CMPC    fill='040'O
        41 007016   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007017   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007020   006757 601000 41                 TNZ     s:3047

     1418     3060
     1419     3061    3               CALL FINDD_6('RC      ',OWNER_RC);

   3061 41 007021   200077 630500                    EPPR0   OWNER_RC,,AUTO
        41 007022   200123 450500                    STP0    LNO+3,,AUTO
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:247  
        41 007023   000007 236000 42                 LDQ     7
        41 007024   200122 756100                    STQ     LNO+2,,AUTO
        41 007025   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007026   000000 631400 42                 EPPR1   0
        41 007027   000000 701000 xent               TSX1    FINDD_6
        41 007030   000000 011000                    NOP     0

     1420     3062    3               CALL FETCHNS_6('RC-FR   ');

   3062 41 007031   000042 630400 42                 EPPR0   34
        41 007032   000003 631400 42                 EPPR1   3
        41 007033   000000 701000 xent               TSX1    FETCHNS_6
        41 007034   000000 011000                    NOP     0

     1421     3063    3               IF UWA.DB_STATUS ~= '0502100' AND UWA.FR.SYN = 1 AND UWA.FR.F_USE = 2

   3063 41 007035   040000 106400                    CMPC    fill='040'O
        41 007036   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007037   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007040   007055 600000 41                 TZE     s:3069
        41 007041   000332 235000 39                 LDA     UWA+218
        41 007042   000001 115007                    CMPA    1,DL
        41 007043   007055 601000 41                 TNZ     s:3069
        41 007044   000343 236000 39                 LDQ     UWA+227
        41 007045   000002 116007                    CMPQ    2,DL
        41 007046   007055 601000 41                 TNZ     s:3069

     1422     3064    4               THEN DO;

     1423     3065    4                   FOUND_SYN = '1'B;

   3065 41 007047   400000 236003                    LDQ     -131072,DU
        41 007050   200074 756100                    STQ     FOUND_SYN,,AUTO

     1424     3066    4                   CALL MODIFYMEM_6('FR      ');

   3066 41 007051   000073 630400 42                 EPPR0   59
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:248  
        41 007052   000003 631400 42                 EPPR1   3
        41 007053   000000 701000 xent               TSX1    MODIFYMEM_6
        41 007054   000000 011000                    NOP     0

     1425     3067    4                   END;

     1426     3068
     1427     3069    3               IF FOUND_SYN

   3069 41 007055   200074 234100                    SZN     FOUND_SYN,,AUTO
        41 007056   007133 605000 41                 TPL     s:3084

     1428     3070    4               THEN DO;

     1429     3071    4                   CALL FINDD_6('RC      ',OWNER_RC);

   3071 41 007057   200077 630500                    EPPR0   OWNER_RC,,AUTO
        41 007060   200123 450500                    STP0    LNO+3,,AUTO
        41 007061   000007 236000 42                 LDQ     7
        41 007062   200122 756100                    STQ     LNO+2,,AUTO
        41 007063   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007064   000000 631400 42                 EPPR1   0
        41 007065   000000 701000 xent               TSX1    FINDD_6
        41 007066   000000 011000                    NOP     0

     1430     3072    4                   CALL FETCHNS_6('RC-FR   ');

   3072 41 007067   000042 630400 42                 EPPR0   34
        41 007070   000003 631400 42                 EPPR1   3
        41 007071   000000 701000 xent               TSX1    FETCHNS_6
        41 007072   000000 011000                    NOP     0

     1431     3073    5                   DO WHILE UWA.FR.SYN = 0;

   3073 41 007073   000332 235000 39                 LDA     UWA+218
        41 007074   007133 601000 41                 TNZ     s:3084

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:249  
     1432     3074    5                       MOVE_MEM = UWA.DIRECT_REF;

   3074 41 007075   000036 235000 39                 LDA     UWA+30
        41 007076   200075 755100                    STA     MOVE_MEM,,AUTO

     1433     3075    5                       CALL FINDNS_6('RC-FR   ');

   3075 41 007077   000042 630400 42                 EPPR0   34
        41 007100   000003 631400 42                 EPPR1   3
        41 007101   000000 701000 xent               TSX1    FINDNS_6
        41 007102   000000 011000                    NOP     0

     1434     3076    5                       NEXT_MEM = UWA.DIRECT_REF;

   3076 41 007103   000036 235000 39                 LDA     UWA+30
        41 007104   200076 755100                    STA     NEXT_MEM,,AUTO

     1435     3077    5                       CALL FINDD_6('FR      ',MOVE_MEM);

   3077 41 007105   200075 630500                    EPPR0   MOVE_MEM,,AUTO
        41 007106   200123 450500                    STP0    LNO+3,,AUTO
        41 007107   000073 236000 42                 LDQ     59
        41 007110   200122 756100                    STQ     LNO+2,,AUTO
        41 007111   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007112   000000 631400 42                 EPPR1   0
        41 007113   000000 701000 xent               TSX1    FINDD_6
        41 007114   000000 011000                    NOP     0

     1436     3078    5                       CALL MODIFYMEM_6('FR      ');

   3078 41 007115   000073 630400 42                 EPPR0   59
        41 007116   000003 631400 42                 EPPR1   3
        41 007117   000000 701000 xent               TSX1    MODIFYMEM_6
        41 007120   000000 011000                    NOP     0

     1437     3079    5                       CALL FETCHD_6('FR      ',NEXT_MEM);

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:250  
   3079 41 007121   200076 630500                    EPPR0   NEXT_MEM,,AUTO
        41 007122   200123 450500                    STP0    LNO+3,,AUTO
        41 007123   000073 236000 42                 LDQ     59
        41 007124   200122 756100                    STQ     LNO+2,,AUTO
        41 007125   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007126   000000 631400 42                 EPPR1   0
        41 007127   000000 701000 xent               TSX1    FETCHD_6
        41 007130   000000 011000                    NOP     0

     1438     3080    5                       END;

   3080 41 007131   000332 235000 39                 LDA     UWA+218
        41 007132   007075 600000 41                 TZE     s:3074

     1439     3081    4                   END;

     1440     3082    3               END;

     1441     3083
     1442     3084    2           CALL FINDNS_6('OA-RC   ');

   3084 41 007133   000006 630400 42                 EPPR0   6
        41 007134   000003 631400 42                 EPPR1   3
        41 007135   000000 701000 xent               TSX1    FINDNS_6
        41 007136   000000 011000                    NOP     0

     1443     3085    2           END;

   3085 41 007137   040000 106400                    CMPC    fill='040'O
        41 007140   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007141   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007142   006326 601000 41                 TNZ     s:2940

     1444     3086        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:251  
     1445     3087        /****************************************************************
     1446     3088        * MAKE SURE THAT RECORDS THAT ARE IN TEMPORARY AREAS ARE NOT    *
     1447     3089        * IN ANY SETS THAT CONTAIN RECORDS THAT AREN'T IN TEMP AREAS    *
     1448     3090        ****************************************************************/
     1449     3091    1       CALL FCURR_R_6('OA      '); /* OA */

   3091 41 007143   000001 630400 42                 EPPR0   1
        41 007144   000003 631400 42                 EPPR1   3
        41 007145   000000 701000 xent               TSX1    FCURR_R_6
        41 007146   000000 011000                    NOP     0

     1450     3092    1       CALL FETCHNS_6('OA-AC   '); /* AC */

   3092 41 007147   000172 630400 42                 EPPR0   122
        41 007150   000003 631400 42                 EPPR1   3
        41 007151   000000 701000 xent               TSX1    FETCHNS_6
        41 007152   000000 011000                    NOP     0

     1451     3093        /* foa all temporary areas... */
     1452     3094    2       DO WHILE (UWA.DB_STATUS ~= '0502100');

   3094 41 007153   040000 106400                    CMPC    fill='040'O
        41 007154   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007155   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007156   007376 600000 41                 TZE     s:3146

     1453     3095    2           THIS_AC = UWA.DIRECT_REF;

   3095 41 007157   000036 235000 39                 LDA     UWA+30
        41 007160   200101 755100                    STA     THIS_AC,,AUTO

     1454     3096    3           IF UWA.AC.PERMTYPE = 1 THEN DO; /* temp area */

   3096 41 007161   000236 236000 39                 LDQ     UWA+158
        41 007162   000001 116007                    CMPQ    1,DL
        41 007163   007356 601000 41                 TNZ     s:3139

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:252  
     1455     3097    3               CALL FINDNS_6('AC-RA   '); /* RA */

   3097 41 007164   000174 630400 42                 EPPR0   124
        41 007165   000003 631400 42                 EPPR1   3
        41 007166   000000 701000 xent               TSX1    FINDNS_6
        41 007167   000000 011000                    NOP     0

     1456     3098         /* for all records in that temporary area... */
     1457     3099    4               DO WHILE (UWA.DB_STATUS ~= '0502100');

   3099 41 007170   040000 106400                    CMPC    fill='040'O
        41 007171   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007172   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007173   007356 600000 41                 TZE     s:3139

     1458     3100    4                   THIS_RA = UWA.DIRECT_REF;

   3100 41 007174   000036 235000 39                 LDA     UWA+30
        41 007175   200102 755100                    STA     THIS_RA,,AUTO

     1459     3101    4                   CALL FINDOS_6('RC-RA   '); /* RC */

   3101 41 007176   000213 630400 42                 EPPR0   139
        41 007177   000003 631400 42                 EPPR1   3
        41 007200   000000 701000 xent               TSX1    FINDOS_6
        41 007201   000000 011000                    NOP     0

     1460     3102    4                   CALL FINDNS_6('RC-SOSM '); /* SOSM */

   3102 41 007202   000033 630400 42                 EPPR0   27
        41 007203   000003 631400 42                 EPPR1   3
        41 007204   000000 701000 xent               TSX1    FINDNS_6
        41 007205   000000 011000                    NOP     0

     1461     3103         /* for every set that record is in... */
     1462     3104    5                   DO WHILE (UWA.DB_STATUS ~= '0502100');

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:253  
   3104 41 007206   040000 106400                    CMPC    fill='040'O
        41 007207   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007210   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007211   007336 600000 41                 TZE     s:3135

     1463     3105    5                       THIS_SOSM = UWA.DIRECT_REF;

   3105 41 007212   000036 235000 39                 LDA     UWA+30
        41 007213   200103 755100                    STA     THIS_SOSM,,AUTO

     1464     3106    5                       THIS_SOSM_NAME = UWA.RECORD_NAME;

   3106 41 007214   040100 100400                    MLR     fill='040'O
        41 007215   000023 000036 39                 ADSC9   UWA+19                   cn=0,n=30
        41 007216   200104 000036                    ADSC9   THIS_SOSM_NAME,,AUTO     cn=0,n=30

     1465     3107    5                       CALL FINDOS_6('SC-SOSM '); /* SC */

   3107 41 007217   000032 630400 42                 EPPR0   26
        41 007220   000003 631400 42                 EPPR1   3
        41 007221   000000 701000 xent               TSX1    FINDOS_6
        41 007222   000000 011000                    NOP     0

     1466     3108    5                       CALL FINDNS_6('SC-SOSM '); /* SOSM */

   3108 41 007223   000032 630400 42                 EPPR0   26
        41 007224   000003 631400 42                 EPPR1   3
        41 007225   000000 701000 xent               TSX1    FINDNS_6
        41 007226   000000 011000                    NOP     0

     1467     3109         /* look through all other records in the set and make
     1468     3110            sure the areas they're in are also temporary */
     1469     3111    6                       DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (THIS_SOSM ~= UWA.

   3111 41 007227   007307 710000 41                 TRA     s:3131

     1470     3112    6                          DIRECT_REF));
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:254  
     1471     3113    6                           CALL FINDOS_6('RC-SOSM '); /* RC */

   3113 41 007230   000033 630400 42                 EPPR0   27
        41 007231   000003 631400 42                 EPPR1   3
        41 007232   000000 701000 xent               TSX1    FINDOS_6
        41 007233   000000 011000                    NOP     0

     1472     3114    6                           CALL FINDNS_6('RC-RA   '); /* RA */

   3114 41 007234   000213 630400 42                 EPPR0   139
        41 007235   000003 631400 42                 EPPR1   3
        41 007236   000000 701000 xent               TSX1    FINDNS_6
        41 007237   000000 011000                    NOP     0

     1473     3115    7                           DO WHILE (UWA.DB_STATUS ~= '0502100');

   3115 41 007240   040000 106400                    CMPC    fill='040'O
        41 007241   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007242   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007243   007303 600000 41                 TZE     s:3130

     1474     3116    7                               CALL FETCHOS_6('AC-RA   '); /* AC */

   3116 41 007244   000174 630400 42                 EPPR0   124
        41 007245   000003 631400 42                 EPPR1   3
        41 007246   000000 701000 xent               TSX1    FETCHOS_6
        41 007247   000000 011000                    NOP     0

     1475     3117    7                               IF UWA.AC.PERMTYPE ~= 1 THEN

   3117 41 007250   000236 235000 39                 LDA     UWA+158
        41 007251   000001 115007                    CMPA    1,DL
        41 007252   007273 600000 41                 TZE     s:3128

     1476     3118    8                               DO;

     1477     3119    8                                   CALL FETCHD_6('AC      ',THIS_AC);
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:255  

   3119 41 007253   200101 630500                    EPPR0   THIS_AC,,AUTO
        41 007254   200123 450500                    STP0    LNO+3,,AUTO
        41 007255   000175 236000 42                 LDQ     125
        41 007256   200122 756100                    STQ     LNO+2,,AUTO
        41 007257   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007260   000000 631400 42                 EPPR1   0
        41 007261   000000 701000 xent               TSX1    FETCHD_6
        41 007262   000000 011000                    NOP     0

     1478     3120    8                                   CALL FETCHOS_6('SN-SE   ');

   3120 41 007263   000027 630400 42                 EPPR0   23
        41 007264   000003 631400 42                 EPPR1   3
        41 007265   000000 701000 xent               TSX1    FETCHOS_6
        41 007266   000000 011000                    NOP     0

     1479     3121    8                                   CALL ZIG$D_DIAG(UWA.SN.LNO,%ERR_SEV,4666);

   3121 41 007267   000215 630400 42                 EPPR0   141
        41 007270   000012 631400 42                 EPPR1   10
        41 007271   000000 701000 xent               TSX1    ZIG$D_DIAG
        41 007272   000000 011000                    NOP     0

     1480     3122        /*E*  ERROR:  ZIG-4666-C
     1481     3123            MESSAGE:  Records in temporary areas cannot participate as owners
     1482     3124                      or members of sets that contain records that are not in
     1483     3125                      temporary areas.
     1484     3126        */
     1485     3127    8                                   END;

     1486     3128    7                               CALL FINDNS_6('RC-RA   '); /* RA */

   3128 41 007273   000213 630400 42                 EPPR0   139
        41 007274   000003 631400 42                 EPPR1   3
        41 007275   000000 701000 xent               TSX1    FINDNS_6
        41 007276   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:256  

     1487     3129    7                               END;

   3129 41 007277   040000 106400                    CMPC    fill='040'O
        41 007300   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007301   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007302   007244 601000 41                 TNZ     s:3116

     1488     3130    6                           CALL FINDNS_6('SC-SOSM '); /* SOSM */

   3130 41 007303   000032 630400 42                 EPPR0   26
        41 007304   000003 631400 42                 EPPR1   3
        41 007305   000000 701000 xent               TSX1    FINDNS_6
        41 007306   000000 011000                    NOP     0

     1489     3131    6                           END;

   3131 41 007307   040000 106400                    CMPC    fill='040'O
        41 007310   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007311   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007312   007316 600000 41                 TZE     s:3132
        41 007313   200103 236100                    LDQ     THIS_SOSM,,AUTO
        41 007314   000036 116000 39                 CMPQ    UWA+30
        41 007315   007230 601000 41                 TNZ     s:3113

     1490     3132    5                       CALL FINDD_6(THIS_SOSM_NAME,THIS_SOSM); /* last SOSM */

   3132 41 007316   200103 630500                    EPPR0   THIS_SOSM,,AUTO
        41 007317   200123 450500                    STP0    LNO+3,,AUTO
        41 007320   200104 631500                    EPPR1   THIS_SOSM_NAME,,AUTO
        41 007321   200122 451500                    STP1    LNO+2,,AUTO
        41 007322   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007323   000000 631400 42                 EPPR1   0
        41 007324   000000 701000 xent               TSX1    FINDD_6
        41 007325   000000 011000                    NOP     0

     1491     3133    5                       CALL FINDNS_6('RC-SOSM '); /* next SOSM */
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:257  

   3133 41 007326   000033 630400 42                 EPPR0   27
        41 007327   000003 631400 42                 EPPR1   3
        41 007330   000000 701000 xent               TSX1    FINDNS_6
        41 007331   000000 011000                    NOP     0

     1492     3134    5                       END;

   3134 41 007332   040000 106400                    CMPC    fill='040'O
        41 007333   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007334   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007335   007212 601000 41                 TNZ     s:3105

     1493     3135    4                   CALL FINDD_6('RA      ',THIS_RA); /* last RA */

   3135 41 007336   200102 630500                    EPPR0   THIS_RA,,AUTO
        41 007337   200123 450500                    STP0    LNO+3,,AUTO
        41 007340   000173 236000 42                 LDQ     123
        41 007341   200122 756100                    STQ     LNO+2,,AUTO
        41 007342   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007343   000000 631400 42                 EPPR1   0
        41 007344   000000 701000 xent               TSX1    FINDD_6
        41 007345   000000 011000                    NOP     0

     1494     3136    4                   CALL FINDNS_6('AC-RA   '); /* next RA */

   3136 41 007346   000174 630400 42                 EPPR0   124
        41 007347   000003 631400 42                 EPPR1   3
        41 007350   000000 701000 xent               TSX1    FINDNS_6
        41 007351   000000 011000                    NOP     0

     1495     3137    4                   END;

   3137 41 007352   040000 106400                    CMPC    fill='040'O
        41 007353   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007354   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007355   007174 601000 41                 TNZ     s:3100
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:258  

     1496     3138    3               END; /* IF */

     1497     3139    2           CALL FINDD_6('AC      ',THIS_AC); /* last AC */

   3139 41 007356   200101 630500                    EPPR0   THIS_AC,,AUTO
        41 007357   200123 450500                    STP0    LNO+3,,AUTO
        41 007360   000175 236000 42                 LDQ     125
        41 007361   200122 756100                    STQ     LNO+2,,AUTO
        41 007362   200122 630500                    EPPR0   LNO+2,,AUTO
        41 007363   000000 631400 42                 EPPR1   0
        41 007364   000000 701000 xent               TSX1    FINDD_6
        41 007365   000000 011000                    NOP     0

     1498     3140    2           CALL FETCHNS_6('OA-AC   '); /* next AC */

   3140 41 007366   000172 630400 42                 EPPR0   122
        41 007367   000003 631400 42                 EPPR1   3
        41 007370   000000 701000 xent               TSX1    FETCHNS_6
        41 007371   000000 011000                    NOP     0

     1499     3141    2           END;

   3141 41 007372   040000 106400                    CMPC    fill='040'O
        41 007373   000001 000007 39                 ADSC9   UWA+1                    cn=0,n=7
        41 007374   000006 000007 40                 ADSC9   6                        cn=0,n=7
        41 007375   007157 601000 41                 TNZ     s:3095

     1500     3142        %EJECT;
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:259  
     1501     3143        /********************************
     1502     3144        * Update DA, OA               *
     1503     3145        ********************************/
     1504     3146    1       CALL FCURR_R_6('DA      ');

   3146 41 007376   000220 630400 42                 EPPR0   144
        41 007377   000003 631400 42                 EPPR1   3
        41 007400   000000 701000 xent               TSX1    FCURR_R_6
        41 007401   000000 011000                    NOP     0

     1505     3147    1       CALL MODIFY_6('DA      ');

   3147 41 007402   000220 630400 42                 EPPR0   144
        41 007403   000003 631400 42                 EPPR1   3
        41 007404   000000 701000 xent               TSX1    MODIFY_6
        41 007405   000000 011000                    NOP     0

     1506     3148    1       CALL FCURR_R_6('OA      ');

   3148 41 007406   000001 630400 42                 EPPR0   1
        41 007407   000003 631400 42                 EPPR1   3
        41 007410   000000 701000 xent               TSX1    FCURR_R_6
        41 007411   000000 011000                    NOP     0

     1507     3149    1       CALL MODIFY_6('OA      ');

   3149 41 007412   000001 630400 42                 EPPR0   1
        41 007413   000003 631400 42                 EPPR1   3
        41 007414   000000 701000 xent               TSX1    MODIFY_6
        41 007415   000000 011000                    NOP     0

     1508     3150    1       RETURN;

   3150 41 007416   000000 702200 xent               TSX2  ! X66_ARET

ANALS
 Sect OctLoc
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:260  
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
   3     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
   3     024*  ****** ******   ****** ******   ****** ******                    ............

VALIDS
 Sect OctLoc
   4     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
   5     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
   6     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
   7     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
 Sect OctLoc
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:261  
   9     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

IMPLCT
 Sect OctLoc
  17     000   000000 000001                                                    ....

EXPLCT
 Sect OctLoc
  17     001   000000 000000                                                    ....

RELTYPE
 Sect OctLoc
  17     003   000000 000003   000000 000004   000000 000006   000000 000007    ................
  17     007   000000 000010   000000 000011   000000 000013   000000 000021    ................
  17     013   000000 000022   000000 000143                                    .......c

FIELD1
 Sect OctLoc
  22     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  30     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  32     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  33     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  35     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  35     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  35     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:262  
  35     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  36     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  36     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  36     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  36     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  36     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  36     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  36     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  36     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  37     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  37     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  37     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  37     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  37     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  37     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  37     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  37     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  38     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  38     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  38     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  38     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  38     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  38     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  38     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  38     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:263  
  39     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  39     004   040040 040040   040040 040040   040040 040040   040040 040040
  39     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  39     014   040040 040040   040040 040040   040040 040040   040040 040040
  39     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  39     024   040040 040040   040040 040040   040040 040040   040040 040040
  39     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  39     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  39     040   040040 040040   040040 040040   040040 040040   040040 040040
  39     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  39     050   040040 040040   040040 040040   040040 040040   040040 040040
  39     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  39     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  39     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  39     070   040040 040040   040040 040040   040040 040040   040040 040040
  39     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  39     104   040040 040040   040040 040040   040040 040040   040040 040040
  39     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  39     130   040040 040040   040040 040040   040040 040040   040040 040040
  39     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  39     140   040040 040040   040040 040040   040040 040040   040040 040040
  39     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  39     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     154   040040 040040   040040 040040   040040 040040   040040 040040
  39     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  39     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  39     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  39     174   040040 040040   040040 040040   040040 040040   040040 040040
  39     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  39     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  39     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  39     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  39     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  39     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:264  
  39     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  39     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  39     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  39     430   040040 040040   040040 040040   040040 040040   040040 040040
  39     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  39     440   040040 040040   040040 040040   040040 040040   040040 040040
  39     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  39     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  39     460   040040 040040   040040 040040   040040 040040   040040 040040
  39     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  39     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  39     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  39     504   040040 040040   040040 040040   040040 040040   040040 040040
  39     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  39     524   040040 040040   040040 040040   040040 040040   040040 040040
  39     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  39     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  39     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  39     614   040040 040040   040040 040040   040040 040040   040040 040040
  39     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  39     624   040040 040040   040040 040040   040040 040040   040040 040040
  39     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  39     664   040040 040040   040040 040040   040040 040040   040040 040040
  39     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  39     700   040040 040040   040040 040040   040040 040040   040040 040040
  39     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  39     714   040040 040040   040040 040040   040040 040040   040040 040040
  39     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  39     724   040040 040040   040040 040040   040040 040040   040040 040040
  39     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  39     744   040040 040040   040040 040040   040040 040040   040040 040040
  39     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  39    1000   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:265  
  39    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  39    1040   040040 040040   040040 040040   040040 040040   040040 040040
  39    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  39    1064   040040 040040   040040 040040   040040 040040   040040 040040
  39    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  39    1120   040040 040040   040040 040040   040040 040040   040040 040040
  39    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  39    1140   040040 040040   040040 040040   040040 040040   040040 040040
  39    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  39    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  39    1154   040040 040040   040040 040040   040040 040040   040040 040040
  39    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  39    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  39    1170   040040 040040   040040 040040   040040 040040   040040 040040
  39    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  39    1204   040040 040040   040040 040040   040040 040040   040040 040040
  39    1214*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
  40     000   117101 040040   040040 040040   117101 055123   103040 040040    OA      OA-SC
  40     004   123103 040040   040040 040040   060065 060062   061060 060040    SC      0502100
  40     010   117101 055122   103040 040040   122103 040040   040040 040040    OA-RC   RC
  40     014   123116 040040   040040 040040   123116 055116   122127 125040    SN      SN-NRWU
  40     020   123116 055123   105040 040040   123115 040040   040040 040040    SN-SE   SM
  40     024   123115 055123   123040 040040   123103 055123   117123 115040    SM-SS   SC-SOSM
  40     030   122103 055123   117123 115040   122103 055106   122040 040040    RC-SOSM RC-FR
  40     034   123055 123040   040040 040040   106122 040040   040040 040040    S-S     FR
  40     040   103055 106040   040040 040040   123123 123115   055103 106040    C-F     SSSM-CF
  40     044   123115 123123   055103 106040   060060 060060   060060 060040    SMSS-CF 0000000
  40     050   106122 055103   106123 040040   116122 040040   040040 040040    FR-CFS  NR
  40     054   117101 055101   103040 040040   122101 040040   040040 040040    OA-AC   RA
  40     060   101103 055122   101040 040040   101103 040040   040040 040040    AC-RA   AC
  40     064   122103 055106   122040 040040   040040 040040   122103 055122    RC-FR       RC-R
  40     070   101040 040040   104101 040040   040040 040040                    A   DA

(unnamed)
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:266  
 Sect OctLoc
  42     000   000002 000000   000000 006000   000063 006000   000001 000000    .........3......
  42     004   000002 006000   000004 006000   000010 006000   000012 006000    ................
  42     010   000014 006000   040040 040040   000003 000000   000000 000001    ....    ........
  42     014   000013 006000   000000 000002   000000 010171   000016 006000    ...........y....
  42     020   000015 006000   000016 006000   000000 011305   000022 006000    ................
  42     024   000427 006000   000000 011542   000025 006000   000020 006000    ................
  42     030   000022 006000   000024 006000   000026 006000   000030 006000    ................
  42     034   000000 011342   000000 011343   000015 006000   000034 006000    ................
  42     040   000015 006000   000035 006000   000032 006000   000034 006000    ................
  42     044   000000 011452   000010 000000   000015 006000   000044 006000    .............$..
  42     050   000000 000050   000000 000000   000051 006000   000051 006000    ...(.....)...)..
  42     054   000002 006000   000014 006000   000050 006000   000000 011311    .........(......
  42     060   000015 006000   000057 006000   000000 000062   000001 006000    ...../.....2....
  42     064   000002 006000   000011 006000   000062 006000   000000 011301    .........2......
  42     070   000015 006000   000067 006000   000000 011346   000036 006000    .....7..........
  42     074   000015 006000   000072 006000   000012 006000   000000 006000    .....:..........
  42     100   000000 011347   000000 011350   000015 006000   000100 006000    .............@..
  42     104   000015 006000   000101 006000   000000 011351   000000 011352    .....A..........
  42     110   000015 006000   000106 006000   000015 006000   000107 006000    .....F.......G..
  42     114   000040 006000   000042 006000   000000 011345   000044 006000    . ...".......$..
  42     120   000015 006000   000116 006000   000034 006000   000036 006000    .....N..........
  42     124   000050 006000   000004 000000   000036 006000   000040 006000    .(........... ..
  42     130   000052 006000   000014 006000   000000 006000   000000 011320    .*..............
  42     134   000015 006000   000133 006000   000000 011317   000000 010163    .....[.........s
  42     140   000015 006000   000136 006000   000036 006000   000352 006000    .....^..........
  42     144   000001 006000   000051 006000   000015 006000   000137 006000    .....)......._..
  42     150   000000 011336   000000 011576   000015 006000   000150 006000    .............h..
  42     154   000015 006000   000151 006000   000000 000036   000156 006000    .....i.......n..
  42     160   000000 011566   000160 006000   000000 011572   000162 006000    .....p.......r..
  42     164   000000 011472   000164 006000   000000 011365   000166 006000    .....t.......v..
  42     170   000000 011564   000170 006000   000054 006000   000056 006000    .....x...,......
  42     174   000060 006000   000062 006000   000000 011561   000176 006000    .0...2.......~..
  42     200   000000 010074   000200 006000   000002 006000   000006 006000    ...<............
  42     204   000000 011302   000000 011303   000015 006000   000204 006000    ................
  42     210   000015 006000   000205 006000   000064 006000   000067 006000    .........4...7..
  42     214   000000 011072   000425 006000   000015 006000   000214 006000    ...:............
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:267  
  42     220   000071 006000                                                    .9..
     1509     3151    1   END ZIG$D_PAS2;
     1510     3152        %EOD;

PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:268  
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DDL_INCL.:ZIC0TOU  is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$D_PAS2.

   Procedure ZIG$D_PAS2 requires 3855 words for executable code.
   Procedure ZIG$D_PAS2 requires 92 words of local(AUTO) storage.
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:269  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:270  
          MINI XREF LISTING

ADD_SN
       103**DCL-ENT  2020--CALL     2035--CALL     2281--CALL     2296--CALL     2437--CALL     2483--CALL
      2570--CALL     2590--CALL     2647--CALL     2660--CALL     2859--CALL     2872--CALL
ANY_LNO
        23**DCL      2763<<ASSIGN   2775>>ASSIGN   2821<>CALL     2832<>CALL
CHAR30
       548**DCL      1924>>ASSIGN   2010>>ASSIGN   2018>>ASSIGN   2273>>ASSIGN   2279>>ASSIGN   2437<>CALL
      2483<>CALL     2485>>CALLBLT  2486<>CALL     2563>>ASSIGN   2568>>ASSIGN   2640>>ASSIGN   2645>>ASSIGN
      2784>>IF       2788<<ASSIGN   2831>>IF       2852>>ASSIGN   2857>>ASSIGN
CONNECT_6
      1728**DCL-ENT  2080--CALL     2137--CALL     2141--CALL     2219--CALL     2227--CALL     2333--CALL
      2355--CALL     2409--CALL     2414--CALL     2688--CALL     2725--CALL     2798--CALL     2903--CALL
CT1
        24**DCL      1800<<CALLBLT  1801<>CALL     1830<<CALLBLT  1831<>CALL     1927<<CALLBLT  1928<>CALL
      1934<<CALLBLT  1935<>CALL     1996<<CALLBLT  1997<>CALL     2025<<CALLBLT  2026<>CALL     2039<<CALLBLT
      2040<>CALL     2051<<CALLBLT  2052<>CALL     2091<<CALLBLT  2092<>CALL     2150<<CALLBLT  2151<>CALL
      2178<<CALLBLT  2179<>CALL     2189<<CALLBLT  2190<>CALL     2248<<CALLBLT  2249<>CALL     2286<<CALLBLT
      2287<>CALL     2303<<CALLBLT  2304<>CALL     2311<<CALLBLT  2312<>CALL     2342<<CALLBLT  2343<>CALL
      2386<<CALLBLT  2387<>CALL     2485<<CALLBLT  2486<>CALL     2574<<CALLBLT  2575<>CALL     2581<<CALLBLT
      2582<>CALL     2593<<CALLBLT  2594<>CALL     2598<<CALLBLT  2599<>CALL     2651<<CALLBLT  2652<>CALL
      2664<<CALLBLT  2665<>CALL     2671<<CALLBLT  2672<>CALL     2703<<CALLBLT  2704<>CALL     2863<<CALLBLT
      2864<>CALL     2876<<CALLBLT  2877<>CALL     2887<<CALLBLT  2888<>CALL     2909<<CALLBLT  2910<>CALL
CT2
        25**DCL      1835<<CALLBLT  1836<>CALL     1937<<CALLBLT  1938<>CALL     2181<<CALLBLT  2182<>CALL
      2251<<CALLBLT  2252<>CALL     2389<<CALLBLT  2390<>CALL
DBK
        35**DCL      1798<<ASSIGN   1799<>CALL     1828<<ASSIGN   1829<>CALL     1833<<ASSIGN   1834<>CALL
DBK_CALCSS
        38**DCL      1977<<ASSIGN   2135<>CALL
DBK_CALC_CF
        41**DCL      2207<<ASSIGN   2229<>CALL     2231<<ASSIGN
DBK_LAST_SM
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:271  
        42**DCL      2452<<ASSIGN   2468>>ASSIGN   2507<<ASSIGN   2531<>CALL     2623>>ASSIGN
DBK_RFR
        44**DCL      2079<<ASSIGN   2085<<ASSIGN   2090>>IF       2130>>ASSIGN   2687<<ASSIGN   2692>>ASSIGN
      2919<<ASSIGN   2926>>ASSIGN
DBK_RFR_CALC
        40**DCL      2066<<ASSIGN   2090>>IF       2129>>ASSIGN
DBK_SCANSS
        37**DCL      1986<<ASSIGN   2139<>CALL
DBK_SM_CALC
        36**DCL      1975<<ASSIGN   1983>>ASSIGN   2194<<ASSIGN   2197>>ASSIGN   2204<>CALL
DBK_SN
        45**DCL      2060<<ASSIGN   2076<>CALL     2083<>CALL     2316<<ASSIGN   2329<>CALL     2675<<ASSIGN
      2684<>CALL     2893<<ASSIGN   2900<>CALL
DBK_SO_CALC
       583**DCL      1978>>ASSIGN
DBK_STAR_DBPARAM_RC
       582**DCL      2073<>CALL     2324<>CALL     2679<>CALL     2894<>CALL     2940>>IF       2984<>CALL
DBK_WHER_FR
        66**DCL      2608<<ASSIGN   2693>>ASSIGN
DONE
        83**DCL      2983<<ASSIGN   2985>>DOWHILE  2993<<ASSIGN   3043<<ASSIGN   3046>>DOWHILE  3050<<ASSIGN
      3055<<ASSIGN
DYNMEM$
       544**DCL       549--IMP-PTR  1866<<ASSIGN   1867>>DOWHILE  1868>>DOCASE   1870<<ASSIGN   1870>>ASSIGN
      1871>>ASSIGN   1875<<ASSIGN   1875>>ASSIGN   1876>>ASSIGN   1879<<ASSIGN   1879>>ASSIGN   1880>>ASSIGN
      1881<<ASSIGN   1881>>ASSIGN   1882>>ASSIGN   1883<<ASSIGN   1883>>ASSIGN   1897<<ASSIGN   1897>>ASSIGN
      1921<<ASSIGN   1921>>ASSIGN   1922>>ASSIGN   1923<<ASSIGN   1923>>ASSIGN   1924>>ASSIGN   1925<<ASSIGN
      1925>>ASSIGN   1944>>DOWHILE  1947<<ASSIGN   1947>>ASSIGN   1948<<ASSIGN   1948>>ASSIGN   1949<<ASSIGN
      1949>>ASSIGN   1953>>IF       1955<<ASSIGN   1955>>ASSIGN   1956<<ASSIGN   1956>>ASSIGN   1989>>DOWHILE
      2007<<ASSIGN   2007>>ASSIGN   2008>>ASSIGN   2009<<ASSIGN   2009>>ASSIGN   2010>>ASSIGN   2011<<ASSIGN
      2011>>ASSIGN   2015>>IF       2017<<ASSIGN   2017>>ASSIGN   2018>>ASSIGN   2019<<ASSIGN   2019>>ASSIGN
      2171<<ASSIGN   2171>>ASSIGN   2172>>ASSIGN   2173<<ASSIGN   2173>>ASSIGN   2243<<ASSIGN   2243>>ASSIGN
      2244>>ASSIGN   2258<<ASSIGN   2258>>ASSIGN   2259<<ASSIGN   2259>>ASSIGN   2260>>IF       2261<<ASSIGN
      2261>>ASSIGN   2262<<ASSIGN   2262>>ASSIGN   2272<<ASSIGN   2272>>ASSIGN   2273>>ASSIGN   2274<<ASSIGN
      2274>>ASSIGN   2276>>IF       2278<<ASSIGN   2278>>ASSIGN   2279>>ASSIGN   2280<<ASSIGN   2280>>ASSIGN
      2374<<ASSIGN   2374>>ASSIGN   2375>>ASSIGN   2376<<ASSIGN   2376>>ASSIGN   2434<<ASSIGN   2434>>ASSIGN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:272  
      2435>>ASSIGN   2436<<ASSIGN   2436>>ASSIGN   2437>>CALL     2439<<ASSIGN   2439>>ASSIGN   2478<<ASSIGN
      2478>>ASSIGN   2479>>ASSIGN   2480<<ASSIGN   2480>>ASSIGN   2483>>CALL     2485>>CALLBLT  2486>>CALL
      2487<<ASSIGN   2487>>ASSIGN   2560<<ASSIGN   2560>>ASSIGN   2561>>ASSIGN   2562<<ASSIGN   2562>>ASSIGN
      2563>>ASSIGN   2564<<ASSIGN   2564>>ASSIGN   2565>>IF       2567<<ASSIGN   2567>>ASSIGN   2568>>ASSIGN
      2569<<ASSIGN   2569>>ASSIGN   2636>>IF       2637<<ASSIGN   2637>>ASSIGN   2638>>ASSIGN   2639<<ASSIGN
      2639>>ASSIGN   2640>>ASSIGN   2641<<ASSIGN   2641>>ASSIGN   2642>>IF       2644<<ASSIGN   2644>>ASSIGN
      2645>>ASSIGN   2646<<ASSIGN   2646>>ASSIGN   2735<<ASSIGN   2735>>ASSIGN   2760<<ASSIGN   2760>>ASSIGN
      2761>>ASSIGN   2762<<ASSIGN   2762>>ASSIGN   2763>>ASSIGN   2764<<ASSIGN   2764>>ASSIGN   2765>>ASSIGN
      2779<<ASSIGN   2780>>DOWHILE  2781<<ASSIGN   2781>>ASSIGN   2782>>ASSIGN   2783<<ASSIGN   2783>>ASSIGN
      2784>>IF       2788>>ASSIGN   2791<<ASSIGN   2791>>ASSIGN   2829<<ASSIGN   2830>>DOWHILE  2831>>IF
      2834<<ASSIGN   2834>>ASSIGN   2844<<ASSIGN   2844>>ASSIGN   2845>>ASSIGN   2849<<ASSIGN   2849>>ASSIGN
      2850>>ASSIGN   2851<<ASSIGN   2851>>ASSIGN   2852>>ASSIGN   2853<<ASSIGN   2853>>ASSIGN   2854>>IF
      2856<<ASSIGN   2856>>ASSIGN   2857>>ASSIGN   2858<<ASSIGN   2858>>ASSIGN
DYNMEM_START$
       545**DCL      1866>>ASSIGN
ERASE_6
      1717**DCL-ENT  2301--CALL
EXC_START$
       546**DCL      2765<<ASSIGN   2779>>ASSIGN   2829>>ASSIGN
EXPLCT
       558**DCL      2035<>CALL     2296<>CALL     2437<>CALL     2483<>CALL     2590<>CALL     2660<>CALL
      2872<>CALL
FCURR_R_6
      1720**DCL-ENT  1976--CALL     2195--CALL     2226--CALL     2266--CALL     2300--CALL     2377--CALL
      2408--CALL     2466--CALL     2630--CALL     2722--CALL     2769--CALL     2797--CALL     2905--CALL
      3091--CALL     3146--CALL     3148--CALL
FETCHD_6
      1718**DCL-ENT  1799--CALL     1829--CALL     1834--CALL     1932--CALL     1936--CALL     1994--CALL
      2062--CALL     2148--CALL     2176--CALL     2180--CALL     2187--CALL     2196--CALL     2246--CALL
      2250--CALL     2267--CALL     2378--CALL     2384--CALL     2388--CALL     2398--CALL     2429--CALL
      2467--CALL     2531--CALL     2766--CALL     2959--CALL     2979--CALL     3015--CALL     3037--CALL
      3079--CALL     3119--CALL
FETCHNS_6
      1723**DCL-ENT  1807--CALL     1816--CALL     1878--CALL     1926--CALL     1968--CALL     1970--CALL
      2064--CALL     2084--CALL     2338--CALL     2394--CALL     2396--CALL     2496--CALL     2503--CALL
      2521--CALL     2602--CALL     2702--CALL     2906--CALL     2972--CALL     2986--CALL     3024--CALL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:273  
      3040--CALL     3045--CALL     3057--CALL     3062--CALL     3072--CALL     3092--CALL     3140--CALL
FETCHOS_6
      1727**DCL-ENT  1889--CALL     1933--CALL     1995--CALL     2149--CALL     2177--CALL     2188--CALL
      2247--CALL     2385--CALL     2541--CALL     2778--CALL     2806--CALL     3116--CALL     3120--CALL
FETCHPS_6
      1725**DCL-ENT  2943--CALL     2962--CALL     2965--CALL     3000--CALL     3019--CALL
FINDD_6
      1719**DCL-ENT  1762--CALL     1771--CALL     1773--CALL     1776--CALL     1785--CALL     1787--CALL
      1872--CALL     1877--CALL     1884--CALL     1973--CALL     2073--CALL     2076--CALL     2083--CALL
      2125--CALL     2135--CALL     2139--CALL     2204--CALL     2225--CALL     2229--CALL     2324--CALL
      2329--CALL     2407--CALL     2614--CALL     2679--CALL     2684--CALL     2689--CALL     2796--CALL
      2846--CALL     2894--CALL     2900--CALL     2920--CALL     2937--CALL     2957--CALL     2977--CALL
      2984--CALL     3013--CALL     3023--CALL     3035--CALL     3044--CALL     3061--CALL     3071--CALL
      3077--CALL     3132--CALL     3135--CALL     3139--CALL
FINDNS_6
      1722**DCL-ENT  1885--CALL     1887--CALL     2029--CALL     2206--CALL     2230--CALL     2290--CALL
      2443--CALL     2448--CALL     2458--CALL     2500--CALL     2578--CALL     2655--CALL     2770--CALL
      2816--CALL     2817--CALL     2826--CALL     2867--CALL     2938--CALL     2975--CALL     3033--CALL
      3075--CALL     3084--CALL     3097--CALL     3102--CALL     3108--CALL     3114--CALL     3128--CALL
      3130--CALL     3133--CALL     3136--CALL
FINDOS_6
      1726**DCL-ENT  1873--CALL     2213--CALL     2223--CALL     2400--CALL     2432--CALL     2453--CALL
      2501--CALL     2508--CALL     2767--CALL     2847--CALL     3101--CALL     3107--CALL     3113--CALL
FINDPS_6
      1724**DCL-ENT  1763--CALL     1764--CALL     1769--CALL     1777--CALL     1778--CALL     1783--CALL
      1974--CALL     2193--CALL     2955--CALL     3011--CALL
FIRST_DBK_RFR_CALC
        39**DCL      1972<<ASSIGN   2062<>CALL
FIRST_FR
        84**DCL      2946<<ASSIGN   2952>>IF       2966<<ASSIGN   3003<<ASSIGN   3008>>IF       3018<<ASSIGN
FIRST_TIME
       101**DCL      1929<<ASSIGN   1944>>DOWHILE  1945>>IF       1952<<ASSIGN   1987<<ASSIGN   1989>>DOWHILE
      2005>>IF       2014<<ASSIGN
FIRST_WHERE
        67**DCL      2476<<ASSIGN   2616>>IF       2626<<ASSIGN
FLAG_ERR
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:274  
       100**DCL      1990<<ASSIGN   1993<<ASSIGN   2024<<ASSIGN   2034>>IF       2275<<ASSIGN   2285<<ASSIGN
      2295>>IF       2322<<ASSIGN   2341<<ASSIGN   2352>>IF
FOUND
       559**DCL      2020<>CALL     2022>>IF       2035<>CALL     2037>>IF       2049>>IF       2071>>IF
      2281<>CALL     2283>>IF       2296<>CALL     2298>>IF       2309>>IF       2323>>IF       2437<>CALL
      2440>>IF       2483<>CALL     2489>>IF       2570<>CALL     2572>>IF       2590<>CALL     2592>>IF
      2597>>IF       2647<>CALL     2649>>IF       2660<>CALL     2662>>IF       2669>>IF       2678>>IF
      2859<>CALL     2861>>IF       2872<>CALL     2874>>IF       2885>>IF       2891>>IF
FOUND_DIRECT
        85**DCL      2942<<ASSIGN   2951<<ASSIGN   2969>>IF
FOUND_IT
        78**DCL      2449<<ASSIGN   2450>>DOWHILE  2455<<ASSIGN   2460>>IF       2504<<ASSIGN   2505>>DOWHILE
      2510<<ASSIGN   2523>>IF       2777<<ASSIGN   2780>>DOWHILE  2789<<ASSIGN
FOUND_SYN
        86**DCL      2998<<ASSIGN   3007<<ASSIGN   3031<<ASSIGN   3049<<ASSIGN   3065<<ASSIGN   3069>>IF
FR.FTYPE
        73**DCL      2067<<ASSIGN   2093>>IF       2609<<ASSIGN   2705>>IF
FR.F_SIGN
        76**DCL      2070<<ASSIGN   2115>>IF       2612<<ASSIGN   2715>>IF
FR.PREC
        74**DCL      2068<<ASSIGN   2101>>IF       2610<<ASSIGN   2709>>IF
FR.SCALE
        75**DCL      2069<<ASSIGN   2108>>IF       2611<<ASSIGN   2712>>IF
FR_NAME
        58**DCL      1924<<ASSIGN   2010<<ASSIGN   2025>>CALLBLT  2026<>CALL     2035<>CALL     2039>>CALLBLT
      2040<>CALL     2051>>CALLBLT  2052<>CALL     2091>>CALLBLT  2092<>CALL     2273<<ASSIGN   2286>>CALLBLT
      2287<>CALL     2296<>CALL     2303>>CALLBLT  2304<>CALL     2311>>CALLBLT  2312<>CALL     2342>>CALLBLT
      2343<>CALL     2563<<ASSIGN   2574>>CALLBLT  2575<>CALL     2581>>CALLBLT  2582<>CALL     2590<>CALL
      2593>>CALLBLT  2594<>CALL     2598>>CALLBLT  2599<>CALL     2640<<ASSIGN   2651>>CALLBLT  2652<>CALL
      2660<>CALL     2664>>CALLBLT  2665<>CALL     2671>>CALLBLT  2672<>CALL     2703>>CALLBLT  2704<>CALL
      2852<<ASSIGN   2863>>CALLBLT  2864<>CALL     2872<>CALL     2876>>CALLBLT  2877<>CALL     2887>>CALLBLT
      2888<>CALL     2909>>CALLBLT  2910<>CALL
HOLD_DBK
        31**DCL      2214<<ASSIGN   2220<>CALL     2331<<ASSIGN   2339<<ASSIGN   2356<>CALL     2399<<ASSIGN
      2415<>CALL     2723<<ASSIGN   2726<>CALL
I
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:275  
        22**DCL      1795<<DOINDEX  1796>>IF       1796>>IF       1798>>ASSIGN   1800>>CALLBLT  1801>>CALL
      1824<<DOINDEX  1827>>IF       1828>>ASSIGN   1830>>CALLBLT  1831>>CALL     1833>>ASSIGN
IMPLCT
       557**DCL      2208>>ASSIGN
LAST_DEF_REC_DBK
       585**DCL      2848<<ASSIGN
LAST_DEF_SET_DBK
       584**DCL      1874<<ASSIGN   2225<>CALL     2407<>CALL
LNO
       556**DCL      1802<<ASSIGN   1803<>CALL     1810<>CALL     1832<<ASSIGN   1837<>CALL     1882<<ASSIGN
      1922<<ASSIGN   1939>>CALL     1962>>CALL     1998>>CALL     2008<<ASSIGN   2020<>CALL     2027>>CALL
      2035<>CALL     2041>>CALL     2053>>CALL     2094>>CALL     2102>>CALL     2109>>CALL     2116>>CALL
      2152>>CALL     2172<<ASSIGN   2183>>CALL     2191>>CALL     2210>>ASSIGN   2244<<ASSIGN   2253>>CALL
      2281<>CALL     2288>>CALL     2296<>CALL     2305>>CALL     2313>>CALL     2344>>CALL     2375<<ASSIGN
      2391>>CALL     2404>>ASSIGN   2435<<ASSIGN   2437<>CALL     2441>>CALL     2446>>CALL     2461>>CALL
      2479<<ASSIGN   2483>>CALL     2490<>CALL     2513<>CALL     2524<>CALL     2535<>CALL     2545<>CALL
      2553<>CALL     2561<<ASSIGN   2570<>CALL     2576<>CALL     2583<>CALL     2590<>CALL     2595<>CALL
      2600<>CALL     2638<<ASSIGN   2647<>CALL     2653<>CALL     2660<>CALL     2666<>CALL     2673<>CALL
      2706<>CALL     2710<>CALL     2713<>CALL     2716<>CALL     2737<>CALL     2782<<ASSIGN   2787>>ASSIGN
      2850<<ASSIGN   2859<>CALL     2865>>CALL     2872<>CALL     2878>>CALL     2889>>CALL     2911>>CALL
MODIFYMEM_6
      1734**DCL-ENT  1772--CALL     1786--CALL     2958--CALL     2978--CALL     3014--CALL     3036--CALL
      3051--CALL     3066--CALL     3078--CALL
MODIFY_6
      1721**DCL-ENT  1981--CALL     2087--CALL     2200--CALL     2271--CALL     2382--CALL     2431--CALL
      2471--CALL     2499--CALL     2606--CALL     2813--CALL     2918--CALL     2990--CALL     3147--CALL
      3149--CALL
MOVE_MEM
        87**DCL      1765<<ASSIGN   1767>>DOWHILE  1768<<ASSIGN   1771<>CALL     1779<<ASSIGN   1781>>DOWHILE
      1782<<ASSIGN   1785<>CALL     2944<<ASSIGN   2947>>DOWHILE  2954<<ASSIGN   2957<>CALL     2974<<ASSIGN
      2977<>CALL     3001<<ASSIGN   3004>>DOWHILE  3010<<ASSIGN   3013<>CALL     3025<<ASSIGN   3027>>DOWHILE
      3032<<ASSIGN   3035<>CALL     3074<<ASSIGN   3077<>CALL
MOVE_TO_FIRST_POS
       104**DCL-ENT  2220--CALL     2356--CALL     2415--CALL     2726--CALL
NEXT_MEM
        88**DCL      2976<<ASSIGN   2979<>CALL     3034<<ASSIGN   3037<>CALL     3076<<ASSIGN   3079<>CALL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:276  
NUMB_RECORD_SN
       508**DCL      1824>>DOINDEX
NUMB_SET_SN
       510**DCL      1795>>DOINDEX
NUM_CTRL_FLDS
        68**DCL      2477<<ASSIGN   2550>>IF       2551<<ASSIGN   2551>>ASSIGN
NUM_EQ_CALCKEYS
        77**DCL      1988<<ASSIGN   1991<<ASSIGN   1991>>ASSIGN   1992>>IF       2063>>DOWHILE  2147>>IF
OWNER_RC
        89**DCL      2999<<ASSIGN   3023<>CALL     3044<>CALL     3061<>CALL     3071<>CALL
PREV_MEM
        90**DCL      1766<<ASSIGN   1767>>DOWHILE  1770<<ASSIGN   1773<>CALL     1780<<ASSIGN   1781>>DOWHILE
      1784<<ASSIGN   1787<>CALL     2945<<ASSIGN   2947>>DOWHILE  2956<<ASSIGN   2959<>CALL     3002<<ASSIGN
      3004>>DOWHILE  3012<<ASSIGN   3015<>CALL     3026<<ASSIGN   3027>>DOWHILE
PREV_THRU_SN
        64**DCL      2481<<ASSIGN
PREV_THRU_SN_SC
        65**DCL      2482<<ASSIGN   2509>>IF
QRC_DBK
        59**DCL      2030<<ASSIGN   2033<<ASSIGN   2035<>CALL     2049>>IF       2291<<ASSIGN   2294<<ASSIGN
      2296<>CALL     2309>>IF       2585<<ASSIGN   2588<<ASSIGN   2590<>CALL     2656<<ASSIGN   2659<<ASSIGN
      2660<>CALL     2669>>IF       2868<<ASSIGN   2871<<ASSIGN   2872<>CALL     2874>>IF       2891>>IF
QRC_NAME
        60**DCL      2018<<ASSIGN   2020<>CALL     2279<<ASSIGN   2281<>CALL     2568<<ASSIGN   2570<>CALL
      2645<<ASSIGN   2647<>CALL     2857<<ASSIGN   2859<>CALL
RECORD$
       511**DCL      1827>>IF       1828>>ASSIGN   1830>>CALLBLT  1831>>CALL     1833>>ASSIGN
RELTYPE.LOC
       568**DCL      1809>>IF       2872<>CALL
RELTYPE.NO_NR
       574**DCL      2020<>CALL     2281<>CALL     2570<>CALL     2647<>CALL     2859<>CALL
RELTYPE.SS
       571**DCL      2035<>CALL     2209>>ASSIGN   2296<>CALL     2403>>ASSIGN   2437<>CALL     2483<>CALL
      2590<>CALL     2660<>CALL
SET$
       513**DCL      1796>>IF       1796>>IF       1798>>ASSIGN   1800>>CALLBLT  1801>>CALL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:277  
SET_FIELDS
       609**DCL-ENT  1801--CALL     1831--CALL     1836--CALL     1928--CALL     1935--CALL     1938--CALL
      1997--CALL     2026--CALL     2040--CALL     2052--CALL     2092--CALL     2151--CALL     2179--CALL
      2182--CALL     2190--CALL     2249--CALL     2252--CALL     2287--CALL     2304--CALL     2312--CALL
      2343--CALL     2387--CALL     2390--CALL     2486--CALL     2575--CALL     2582--CALL     2594--CALL
      2599--CALL     2652--CALL     2665--CALL     2672--CALL     2704--CALL     2864--CALL     2877--CALL
      2888--CALL     2910--CALL
STRE_6
      1715**DCL-ENT  1984--CALL     2077--CALL     2131--CALL     2136--CALL     2140--CALL     2202--CALL
      2217--CALL     2224--CALL     2330--CALL     2353--CALL     2405--CALL     2412--CALL     2624--CALL
      2685--CALL     2694--CALL     2724--CALL     2794--CALL     2801--CALL     2901--CALL     2927--CALL
SUBSCHEMA_KEY
       641**DCL       642--REDEF
TABLES.DBK
       516**DCL      1798>>ASSIGN   1828>>ASSIGN
TABLES.DBK_RC
       519**DCL      1827>>IF       1833>>ASSIGN
TABLES.DEFINED
       517**DCL      1796>>IF
TABLES.NAME
       515**DCL      1796>>IF       1800>>CALLBLT  1801<>CALL     1830>>CALLBLT  1831<>CALL
THIS_AC
        94**DCL      3095<<ASSIGN   3119<>CALL     3139<>CALL
THIS_RA
        95**DCL      3100<<ASSIGN   3135<>CALL
THIS_RC
        53**DCL      2761<<ASSIGN   2766<>CALL     2845<<ASSIGN   2846<>CALL     2920<>CALL
THIS_RC_SN
        54**DCL      2768<<ASSIGN   2796<>CALL
THIS_SC
        46**DCL      1871<<ASSIGN   1872<>CALL     2618>>IF       2736>>IF
THIS_SM
        47**DCL      1876<<ASSIGN   1877<>CALL     2429<>CALL     2614<>CALL
THIS_SM_RC
        48**DCL      2433<<ASSIGN   2444>>IF
THIS_SN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:278  
        49**DCL      1880<<ASSIGN   1884<>CALL     1936<>CALL     2180<>CALL     2250<>CALL     2388<>CALL
      2481>>ASSIGN   2488<<ASSIGN
THIS_SN_SC
        50**DCL      1886<<ASSIGN   1979>>ASSIGN   2198>>ASSIGN   2268>>ASSIGN   2379>>ASSIGN   2454>>IF
      2469>>ASSIGN   2482>>ASSIGN   2497<<ASSIGN   2618>>IF       2622>>ASSIGN   2736>>IF
THIS_SN_SO
        51**DCL      1888<<ASSIGN   2269>>ASSIGN   2380>>ASSIGN
THIS_SN_SO_RC
        52**DCL      1890<<ASSIGN   1932<>CALL     1973<>CALL     1994<>CALL     2125<>CALL     2148<>CALL
      2176<>CALL     2187<>CALL     2246<>CALL     2384<>CALL     2502<<ASSIGN   2579>>IF       2588>>ASSIGN
      2689<>CALL
THIS_SOSM
        96**DCL      3105<<ASSIGN   3111>>DOWHILE  3132<>CALL
THIS_SOSM_NAME
        97**DCL      3106<<ASSIGN   3132<>CALL
UWA.AC.CALC_NEXT
      1484**DCL      1485--REDEF
UWA.AC.CALC_PRIOR
      1493**DCL      1494--REDEF
UWA.AC.DEFAULTS
      1445**DCL      1446--REDEF
UWA.AC.FILE_CODE
      1450**DCL      1451--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      1447**DCL      1448--REDEF
UWA.AC.PAGE_TYP
      1462**DCL      2810<<ASSIGN
UWA.AC.PERMTYPE
      1461**DCL      3096>>IF       3117>>IF
UWA.AC.PRIME_KEY
      1459**DCL      2809<<ASSIGN
UWA.AC.SEC_KEY
      1460**DCL      2812<<ASSIGN
UWA.C_F
      1578**DCL      2132<<ASSIGN   2215<<ASSIGN   2317<<ASSIGN   2410<<ASSIGN   2632<<ASSIGN
UWA.C_F.CTRLTYPE
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:279  
      1580**DCL      2134<<ASSIGN   2138<<ASSIGN   2216<<ASSIGN   2319<<ASSIGN   2411<<ASSIGN   2633<<ASSIGN
UWA.C_F.SYN
      1579**DCL      2133<<ASSIGN   2318<<ASSIGN   2695<<ASSIGN
UWA.DA.NUMB_NR
      1586**DCL      2228<<ASSIGN   2228>>ASSIGN   2302<<ASSIGN   2302>>ASSIGN   2406<<ASSIGN   2406>>ASSIGN
      2795<<ASSIGN   2795>>ASSIGN
UWA.DB_STATUS
      1376**DCL      1767>>DOWHILE  1781>>DOWHILE  1808>>DOWHILE  2211>>DOWHILE  2450>>DOWHILE  2505>>DOWHILE
      2774>>DOWHILE  2819>>IF       2939>>DOWHILE  2947>>DOWHILE  2985>>DOWHILE  3004>>DOWHILE  3027>>DOWHILE
      3046>>DOWHILE  3063>>IF       3094>>DOWHILE  3099>>DOWHILE  3104>>DOWHILE  3111>>DOWHILE  3115>>DOWHILE
UWA.DIRECT_REF
      1385**DCL      1765>>ASSIGN   1768>>ASSIGN   1770>>ASSIGN   1779>>ASSIGN   1782>>ASSIGN   1784>>ASSIGN
      1874>>ASSIGN   1886>>ASSIGN   1888>>ASSIGN   1890>>ASSIGN   1972>>ASSIGN   1975>>ASSIGN   1977>>ASSIGN
      1986>>ASSIGN   2030>>ASSIGN   2060>>ASSIGN   2066>>ASSIGN   2079>>ASSIGN   2085>>ASSIGN   2194>>ASSIGN
      2196<>CALL     2207>>ASSIGN   2214>>ASSIGN   2231>>ASSIGN   2267<>CALL     2291>>ASSIGN   2316>>ASSIGN
      2331>>ASSIGN   2339>>ASSIGN   2378<>CALL     2399>>ASSIGN   2433>>ASSIGN   2444>>IF       2452>>ASSIGN
      2454>>IF       2467<>CALL     2488>>ASSIGN   2497>>ASSIGN   2502>>ASSIGN   2507>>ASSIGN   2509>>IF
      2579>>IF       2585>>ASSIGN   2608>>ASSIGN   2656>>ASSIGN   2675>>ASSIGN   2687>>ASSIGN   2723>>ASSIGN
      2768>>ASSIGN   2848>>ASSIGN   2868>>ASSIGN   2893>>ASSIGN   2919>>ASSIGN   2940>>IF       2944>>ASSIGN
      2954>>ASSIGN   2956>>ASSIGN   2974>>ASSIGN   2976>>ASSIGN   2999>>ASSIGN   3001>>ASSIGN   3010>>ASSIGN
      3012>>ASSIGN   3025>>ASSIGN   3032>>ASSIGN   3034>>ASSIGN   3074>>ASSIGN   3076>>ASSIGN   3095>>ASSIGN
      3100>>ASSIGN   3105>>ASSIGN   3111>>DOWHILE
UWA.FR
      1538**DCL      2325<<ASSIGN   2895<<ASSIGN
UWA.FR.BEIST
      1553**DCL      2899<<ASSIGN   2925<<ASSIGN   2947>>DOWHILE  2949>>IF       2971>>IF       2973>>DOWHILE
      2987>>IF       2989<<ASSIGN
UWA.FR.BUFFLOC
      1554**DCL      2129<<ASSIGN   2693<<ASSIGN
UWA.FR.DERIVED
      1552**DCL      1969>>DOWHILE  2063>>DOWHILE
UWA.FR.FR_FRH
      1555**DCL      2130<<ASSIGN   2398<>CALL     2692<<ASSIGN   2926<<ASSIGN
UWA.FR.FTYPE
      1541**DCL      2067>>ASSIGN   2093>>IF       2340>>IF       2609>>ASSIGN   2705>>IF       2907>>IF
UWA.FR.F_SIGN
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:280  
      1544**DCL      2070>>ASSIGN   2115>>IF       2612>>ASSIGN   2715>>IF
UWA.FR.F_USE
      1548**DCL      2074<<ASSIGN   2128<<ASSIGN   2328<<ASSIGN   2395>>DOWHILE  2682<<ASSIGN   2691<<ASSIGN
      2898<<ASSIGN   2923<<ASSIGN   3004>>DOWHILE  3004>>DOWHILE  3029>>IF       3047>>IF       3054>>IF
      3054>>IF       3063>>IF
UWA.FR.LEVEL
      1551**DCL      2075<<ASSIGN   2126<<ASSIGN   2683<<ASSIGN   2924<<ASSIGN
UWA.FR.PREC
      1542**DCL      2068>>ASSIGN   2101>>IF       2327<<ASSIGN   2610>>ASSIGN   2709>>IF       2897<<ASSIGN
UWA.FR.REF
      1540**DCL      2086<<ASSIGN   2326<<ASSIGN   2603>>IF       2605<<ASSIGN   2681<<ASSIGN   2896<<ASSIGN
      2917<<ASSIGN   2922<<ASSIGN
UWA.FR.SCALE
      1543**DCL      2069>>ASSIGN   2108>>IF       2611>>ASSIGN   2712>>IF
UWA.FR.SYN
      1539**DCL      2127<<ASSIGN   2680<<ASSIGN   2690<<ASSIGN   2921<<ASSIGN   3004>>DOWHILE  3027>>DOWHILE
      3047>>IF       3054>>IF       3063>>IF       3073>>DOWHILE
UWA.NR
      1610**DCL      2771<<ASSIGN
UWA.NR.IMPLCT
      1612**DCL      2208<<ASSIGN   2402<<ASSIGN   2776<<ASSIGN   2786<<ASSIGN   2800>>IF
UWA.NR.LNO
      1614**DCL      2210<<ASSIGN   2404<<ASSIGN   2775<<ASSIGN   2787<<ASSIGN
UWA.NR.RELTYPE
      1613**DCL      1809>>IF       2209<<ASSIGN   2403<<ASSIGN   2772<<ASSIGN
UWA.OA.NUMB_CF
      1439**DCL      2142<<ASSIGN   2142>>ASSIGN   2218<<ASSIGN   2218>>ASSIGN   2354<<ASSIGN   2354>>ASSIGN
      2413<<ASSIGN   2413>>ASSIGN   2729<<ASSIGN   2729>>ASSIGN
UWA.OA.NUMB_FR
      1435**DCL      2078<<ASSIGN   2078>>ASSIGN   2332<<ASSIGN   2332>>ASSIGN   2686<<ASSIGN   2686>>ASSIGN
      2902<<ASSIGN   2902>>ASSIGN
UWA.OA.NUMB_RA
      1434**DCL      2802<<ASSIGN   2802>>ASSIGN
UWA.OA.NUMB_SS
      1438**DCL      1985<<ASSIGN   1985>>ASSIGN   2203<<ASSIGN   2203>>ASSIGN   2625<<ASSIGN   2625>>ASSIGN
UWA.RA
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:281  
      1533**DCL      2773<<ASSIGN
UWA.RC.CALCDUP
      1510**DCL      1961>>IF       2186>>IF
UWA.RC.KEY_PRESENT
      1512**DCL      2804>>IF
UWA.RC.PSMODE
      1504**DCL      1930>>IF       2174>>IF       2245>>IF       2383>>IF       2804>>IF       2807>>IF
      2814>>IF
UWA.RC.SLACK
      1518**DCL      1992>>IF       2147>>IF
UWA.RECORD_NAME
      1382**DCL      2451>>IF       2506>>IF       3106>>ASSIGN
UWA.SC.ALTOWN
      1526**DCL      2498<<ASSIGN
UWA.SC.SETORD
      1522**DCL      2542>>IF       2542>>IF
UWA.SF.DBKEY_OA
      1394**DCL      1762<>CALL     1776<>CALL     2937<>CALL
UWA.SM.CALCDUP
      1565**DCL      2532>>IF
UWA.SM.INSTYPE
      1561**DCL      2511>>IF
UWA.SM.MEMDUP
      1563**DCL      2532>>IF       2542>>IF
UWA.SM.PA_MEMPNT
      1572**DCL      2430<<ASSIGN
UWA.SM.RETTYPE
      1562**DCL      2511>>IF
UWA.SM.SEQDUP
      1564**DCL      2532>>IF
UWA.SN.LNO
      1601**DCL      1802>>ASSIGN   1832>>ASSIGN   3121<>CALL
UWA.SN.SENAME
      1603**DCL      1835>>CALLBLT  1836<>CALL     1927>>CALLBLT  1928<>CALL     1934>>CALLBLT  1935<>CALL
      1937>>CALLBLT  1938<>CALL     1996>>CALLBLT  1997<>CALL     2150>>CALLBLT  2151<>CALL     2178>>CALLBLT
      2179<>CALL     2181>>CALLBLT  2182<>CALL     2189>>CALLBLT  2190<>CALL     2248>>CALLBLT  2249<>CALL
PL6.E3A0      #001=ZIG$D_PAS2 File=ZIG$D_PAS2.:ZIC0TSI                           FRI 09/05/97 11:59 Page:282  
      2251>>CALLBLT  2252<>CALL     2386>>CALLBLT  2387<>CALL     2389>>CALLBLT  2390<>CALL     2784>>IF
UWA.S_S
      1573**DCL      2615<<ASSIGN
UWA.S_S.SC_SSH
      1575**DCL      1979<<ASSIGN   2198<<ASSIGN   2268<<ASSIGN   2379<<ASSIGN   2469<<ASSIGN   2622<<ASSIGN
UWA.S_S.SOSM_SSH
      1576**DCL      1978<<ASSIGN   1983<<ASSIGN   2197<<ASSIGN   2269<<ASSIGN   2380<<ASSIGN   2468<<ASSIGN
      2623<<ASSIGN
UWA.S_S.STYP
      1574**DCL      1980<<ASSIGN   1982<<ASSIGN   2199<<ASSIGN   2201<<ASSIGN   2270<<ASSIGN   2381<<ASSIGN
      2470<<ASSIGN   2619<<ASSIGN   2621<<ASSIGN
WRD1
       547**DCL      1867>>DOWHILE  1868>>DOCASE   1871>>ASSIGN   1876>>ASSIGN   1880>>ASSIGN   1882>>ASSIGN
      1922>>ASSIGN   1944>>DOWHILE  1953>>IF       1989>>DOWHILE  2008>>ASSIGN   2015>>IF       2172>>ASSIGN
      2244>>ASSIGN   2260>>IF       2276>>IF       2375>>ASSIGN   2435>>ASSIGN   2479>>ASSIGN   2561>>ASSIGN
      2565>>IF       2636>>IF       2638>>ASSIGN   2642>>IF       2761>>ASSIGN   2763>>ASSIGN   2780>>DOWHILE
      2782>>ASSIGN   2830>>DOWHILE  2845>>ASSIGN   2850>>ASSIGN   2854>>IF
ZIG$D_DIAG
       102**DCL-ENT  1803--CALL     1810--CALL     1837--CALL     1939--CALL     1962--CALL     1998--CALL
      2027--CALL     2041--CALL     2053--CALL     2094--CALL     2102--CALL     2109--CALL     2116--CALL
      2152--CALL     2183--CALL     2191--CALL     2253--CALL     2288--CALL     2305--CALL     2313--CALL
      2344--CALL     2391--CALL     2441--CALL     2446--CALL     2461--CALL     2490--CALL     2513--CALL
      2524--CALL     2535--CALL     2545--CALL     2553--CALL     2576--CALL     2583--CALL     2595--CALL
      2600--CALL     2653--CALL     2666--CALL     2673--CALL     2706--CALL     2710--CALL     2713--CALL
      2716--CALL     2737--CALL     2821--CALL     2832--CALL     2865--CALL     2878--CALL     2889--CALL
      2911--CALL     3121--CALL

PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:283  
     1511        1        /*T***********************************************************/
     1512        2        /*T*                                                         */
     1513        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1514        4        /*T*                                                         */
     1515        5        /*T***********************************************************/
     1516        6        /*P*
     1517        7        NAME:    MOVE_TO_FIRST_POS
     1518        8        PURPOSE: This routine is called after a new synonomous FR has been
     1519        9                 stored.  The way SCHEMA40 is written causes new FRs to be
     1520       10                 automatically added to the end of the RC-FR chain.  This
     1521       11                 causes an order problem since all synonomous FRs must come
     1522       12                 before any real FRs in the chain.  (If not, parts of DBACS
     1523       13                 die and schemas built in another order are not compatible
     1524       14                 with schemas built in earlier releases of DBACS.)
     1525       15        */
     1526       16        MOVE_TO_FIRST_POS: PROC ( OWNER, SET_TYPE, OWN_TYPE, MEM_TYPE );
     1527       17
     1528       18    1   DCL OWNER UBIN WORD;
     1529       19    1   DCL SET_TYPE CHAR(8);
     1530       20    1   DCL OWN_TYPE CHAR(8);
     1531       21    1   DCL MEM_TYPE CHAR(8);
     1532       22    1   DCL MOVE_MEM UBIN WORD;
     1533       23    1   DCL NEW_MEM UBIN WORD;
     1534       24    1   DCL NEXT_MEM UBIN WORD;
     1535       25        %INCLUDE ZI_SUB4_CAN;
     1536      682         %UWA;
     1537     1017        %INCLUDE ZIG_DBA_INT;
     1538     1065
     1539     1066    1       CALL FCURR_R_6( MEM_TYPE );
     1540     1067    1       NEW_MEM = UWA.DIRECT_REF;
     1541     1068    1       CALL FINDD_6( OWN_TYPE, OWNER );
     1542     1069    1       CALL FETCHNS_6( SET_TYPE );
     1543     1070    1       NEXT_MEM = 0;
     1544     1071
     1545     1072    2       DO WHILE ( UWA.DB_STATUS ~= '0502100' ) AND ( NEXT_MEM ~= NEW_MEM ) ;
     1546     1073    2           MOVE_MEM = UWA.DIRECT_REF;
     1547     1074    2           CALL FINDNS_6( SET_TYPE );
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:284  
     1548     1075    2           NEXT_MEM = UWA.DIRECT_REF;
     1549     1076    2           CALL FINDD_6( MEM_TYPE, MOVE_MEM );
     1550     1077    2           CALL MODIFYMEM_6( MEM_TYPE );
     1551     1078    2           CALL FETCHD_6( MEM_TYPE, NEXT_MEM );
     1552     1079    2           END;
     1553     1080
     1554     1081    1   END MOVE_TO_FIRST_POS;

PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:285  
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure MOVE_TO_FIRST_POS.

   Procedure MOVE_TO_FIRST_POS requires 57 words for executable code.
   Procedure MOVE_TO_FIRST_POS requires 12 words of local(AUTO) storage.

    No errors detected in file ZIG$D_PAS2.:ZIC0TSI    .

PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:286  

 Object Unit name= MOVE_TO_FIRST_POS                          File name= ZIG$D_PAS2.:ZIC0TOU
 UTS= SEP 05 '97 12:00:51.44 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none   656   1220  UWA
    1  RoData even  UTS      2      2  MOVE_TO_FIRST_POS
    2   Proc  even  none    57     71  MOVE_TO_FIRST_POS
    3  RoData even  none     2      2  MOVE_TO_FIRST_POS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        4  MOVE_TO_FIRST_POS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FCURR_R_6
 yes     yes           Std       2 FINDD_6
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHNS_6
 yes     yes           Std       1 FINDNS_6
 yes     yes           Std       1 MODIFYMEM_6
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:287  


     1511        1        /*T***********************************************************/
     1512        2        /*T*                                                         */
     1513        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1514        4        /*T*                                                         */
     1515        5        /*T***********************************************************/
     1516        6        /*P*
     1517        7        NAME:    MOVE_TO_FIRST_POS
     1518        8        PURPOSE: This routine is called after a new synonomous FR has been
     1519        9                 stored.  The way SCHEMA40 is written causes new FRs to be
     1520       10                 automatically added to the end of the RC-FR chain.  This
     1521       11                 causes an order problem since all synonomous FRs must come
     1522       12                 before any real FRs in the chain.  (If not, parts of DBACS
     1523       13                 die and schemas built in another order are not compatible
     1524       14                 with schemas built in earlier releases of DBACS.)
     1525       15        */
     1526       16        MOVE_TO_FIRST_POS: PROC ( OWNER, SET_TYPE, OWN_TYPE, MEM_TYPE );

     16  2 000000   000000 700200 xent  MOVE_TO_FIR* TSX0  ! X66_AUTO_4
         2 000001   000014 000004                    ZERO    12,4

     1527       17
     1528       18    1   DCL OWNER UBIN WORD;
     1529       19    1   DCL SET_TYPE CHAR(8);
     1530       20    1   DCL OWN_TYPE CHAR(8);
     1531       21    1   DCL MEM_TYPE CHAR(8);
     1532       22    1   DCL MOVE_MEM UBIN WORD;
     1533       23    1   DCL NEW_MEM UBIN WORD;
     1534       24    1   DCL NEXT_MEM UBIN WORD;
     1535       25        %INCLUDE ZI_SUB4_CAN;
     1536      682         %UWA;
     1537     1017        %INCLUDE ZIG_DBA_INT;
     1538     1065
     1539     1066    1       CALL FCURR_R_6( MEM_TYPE );

   1066  2 000002   200006 630500                    EPPR0   @MEM_TYPE,,AUTO
         2 000003   000000 631400 3                  EPPR1   0
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:288  
         2 000004   000000 701000 xent               TSX1    FCURR_R_6
         2 000005   000000 011000                    NOP     0

     1540     1067    1       NEW_MEM = UWA.DIRECT_REF;

   1067  2 000006   000036 235000 0                  LDA     UWA+30
         2 000007   200010 755100                    STA     NEW_MEM,,AUTO

     1541     1068    1       CALL FINDD_6( OWN_TYPE, OWNER );

   1068  2 000010   200003 236100                    LDQ     @OWNER,,AUTO
         2 000011   200005 235100                    LDA     @OWN_TYPE,,AUTO
         2 000012   200012 757100                    STAQ    NEXT_MEM+1,,AUTO
         2 000013   200012 630500                    EPPR0   NEXT_MEM+1,,AUTO
         2 000014   000001 631400 3                  EPPR1   1
         2 000015   000000 701000 xent               TSX1    FINDD_6
         2 000016   000000 011000                    NOP     0

     1542     1069    1       CALL FETCHNS_6( SET_TYPE );

   1069  2 000017   200004 630500                    EPPR0   @SET_TYPE,,AUTO
         2 000020   000000 631400 3                  EPPR1   0
         2 000021   000000 701000 xent               TSX1    FETCHNS_6
         2 000022   000000 011000                    NOP     0

     1543     1070    1       NEXT_MEM = 0;

   1070  2 000023   200011 450100                    STZ     NEXT_MEM,,AUTO

     1544     1071
     1545     1072    2       DO WHILE ( UWA.DB_STATUS ~= '0502100' ) AND ( NEXT_MEM ~= NEW_MEM ) ;

   1072  2 000024   000061 710000 2                  TRA     s:1079

     1546     1073    2           MOVE_MEM = UWA.DIRECT_REF;

   1073  2 000025   000036 235000 0                  LDA     UWA+30
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:289  
         2 000026   200007 755100                    STA     MOVE_MEM,,AUTO

     1547     1074    2           CALL FINDNS_6( SET_TYPE );

   1074  2 000027   200004 630500                    EPPR0   @SET_TYPE,,AUTO
         2 000030   000000 631400 3                  EPPR1   0
         2 000031   000000 701000 xent               TSX1    FINDNS_6
         2 000032   000000 011000                    NOP     0

     1548     1075    2           NEXT_MEM = UWA.DIRECT_REF;

   1075  2 000033   000036 235000 0                  LDA     UWA+30
         2 000034   200011 755100                    STA     NEXT_MEM,,AUTO

     1549     1076    2           CALL FINDD_6( MEM_TYPE, MOVE_MEM );

   1076  2 000035   200007 630500                    EPPR0   MOVE_MEM,,AUTO
         2 000036   200013 450500                    STP0    NEXT_MEM+2,,AUTO
         2 000037   200006 236100                    LDQ     @MEM_TYPE,,AUTO
         2 000040   200012 756100                    STQ     NEXT_MEM+1,,AUTO
         2 000041   200012 630500                    EPPR0   NEXT_MEM+1,,AUTO
         2 000042   000001 631400 3                  EPPR1   1
         2 000043   000000 701000 xent               TSX1    FINDD_6
         2 000044   000000 011000                    NOP     0

     1550     1077    2           CALL MODIFYMEM_6( MEM_TYPE );

   1077  2 000045   200006 630500                    EPPR0   @MEM_TYPE,,AUTO
         2 000046   000000 631400 3                  EPPR1   0
         2 000047   000000 701000 xent               TSX1    MODIFYMEM_6
         2 000050   000000 011000                    NOP     0

     1551     1078    2           CALL FETCHD_6( MEM_TYPE, NEXT_MEM );

   1078  2 000051   200011 630500                    EPPR0   NEXT_MEM,,AUTO
         2 000052   200013 450500                    STP0    NEXT_MEM+2,,AUTO
         2 000053   200006 236100                    LDQ     @MEM_TYPE,,AUTO
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:290  
         2 000054   200012 756100                    STQ     NEXT_MEM+1,,AUTO
         2 000055   200012 630500                    EPPR0   NEXT_MEM+1,,AUTO
         2 000056   000001 631400 3                  EPPR1   1
         2 000057   000000 701000 xent               TSX1    FETCHD_6
         2 000060   000000 011000                    NOP     0

     1552     1079    2           END;

   1079  2 000061   040000 106400                    CMPC    fill='040'O
         2 000062   000001 000007 0                  ADSC9   UWA+1                    cn=0,n=7
         2 000063   000000 000007 1                  ADSC9   0                        cn=0,n=7
         2 000064   000070 600000 2                  TZE     s:1081
         2 000065   200011 236100                    LDQ     NEXT_MEM,,AUTO
         2 000066   200010 116100                    CMPQ    NEW_MEM,,AUTO
         2 000067   000025 601000 2                  TNZ     s:1073

     1553     1080
     1554     1081    1   END MOVE_TO_FIRST_POS;

   1081  2 000070   000000 702200 xent               TSX2  ! X66_ARET

UWA
 Sect OctLoc
   0     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
   0     004   040040 040040   040040 040040   040040 040040   040040 040040
   0     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
   0     014   040040 040040   040040 040040   040040 040040   040040 040040
   0     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
   0     024   040040 040040   040040 040040   040040 040040   040040 040040
   0     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
   0     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
   0     040   040040 040040   040040 040040   040040 040040   040040 040040
   0     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
   0     050   040040 040040   040040 040040   040040 040040   040040 040040
   0     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
   0     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
   0     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:291  
   0     070   040040 040040   040040 040040   040040 040040   040040 040040
   0     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
   0     104   040040 040040   040040 040040   040040 040040   040040 040040
   0     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
   0     130   040040 040040   040040 040040   040040 040040   040040 040040
   0     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
   0     140   040040 040040   040040 040040   040040 040040   040040 040040
   0     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
   0     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     154   040040 040040   040040 040040   040040 040040   040040 040040
   0     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
   0     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
   0     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
   0     174   040040 040040   040040 040040   040040 040040   040040 040040
   0     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
   0     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
   0     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
   0     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
   0     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
   0     430   040040 040040   040040 040040   040040 040040   040040 040040
   0     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
   0     440   040040 040040   040040 040040   040040 040040   040040 040040
   0     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
   0     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
   0     460   040040 040040   040040 040040   040040 040040   040040 040040
   0     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
   0     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:292  
   0     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
   0     504   040040 040040   040040 040040   040040 040040   040040 040040
   0     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
   0     524   040040 040040   040040 040040   040040 040040   040040 040040
   0     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
   0     614   040040 040040   040040 040040   040040 040040   040040 040040
   0     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
   0     624   040040 040040   040040 040040   040040 040040   040040 040040
   0     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0     664   040040 040040   040040 040040   040040 040040   040040 040040
   0     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0     700   040040 040040   040040 040040   040040 040040   040040 040040
   0     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0     714   040040 040040   040040 040040   040040 040040   040040 040040
   0     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
   0     724   040040 040040   040040 040040   040040 040040   040040 040040
   0     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0     744   040040 040040   040040 040040   040040 040040   040040 040040
   0     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1000   040040 040040   040040 040040   040040 040040   040040 040040
   0    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1040   040040 040040   040040 040040   040040 040040   040040 040040
   0    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1064   040040 040040   040040 040040   040040 040040   040040 040040
   0    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1120   040040 040040   040040 040040   040040 040040   040040 040040
   0    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0    1140   040040 040040   040040 040040   040040 040040   040040 040040
   0    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
   0    1154   040040 040040   040040 040040   040040 040040   040040 040040
   0    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
   0    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
   0    1170   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:293  
   0    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   0    1204   040040 040040   040040 040040   040040 040040   040040 040040
   0    1214*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
   1     000   060065 060062   061060 060040                                    0502100

(unnamed)
 Sect OctLoc
   3     000   000001 000000   000002 000000                                    ........

PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:294  
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure MOVE_TO_FIRST_POS.

   Procedure MOVE_TO_FIRST_POS requires 57 words for executable code.
   Procedure MOVE_TO_FIRST_POS requires 12 words of local(AUTO) storage.

    No errors detected in file ZIG$D_PAS2.:ZIC0TSI    .
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:295  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:296  
          MINI XREF LISTING

FCURR_R_6
      1029**DCL-ENT  1066--CALL
FETCHD_6
      1027**DCL-ENT  1078--CALL
FETCHNS_6
      1032**DCL-ENT  1069--CALL
FINDD_6
      1028**DCL-ENT  1068--CALL     1076--CALL
FINDNS_6
      1031**DCL-ENT  1074--CALL
MEM_TYPE
        21**DCL        16--PROC     1066<>CALL     1076<>CALL     1077<>CALL     1078<>CALL
MODIFYMEM_6
      1043**DCL-ENT  1077--CALL
MOVE_MEM
        22**DCL      1073<<ASSIGN   1076<>CALL
NEW_MEM
        23**DCL      1067<<ASSIGN   1072>>DOWHILE
NEXT_MEM
        24**DCL      1070<<ASSIGN   1072>>DOWHILE  1075<<ASSIGN   1078<>CALL
OWNER
        18**DCL        16--PROC     1068<>CALL
OWN_TYPE
        20**DCL        16--PROC     1068<>CALL
SET_TYPE
        19**DCL        16--PROC     1069<>CALL     1074<>CALL
UWA.AC.CALC_NEXT
       793**DCL       794--REDEF
UWA.AC.CALC_PRIOR
       802**DCL       803--REDEF
UWA.AC.DEFAULTS
       754**DCL       755--REDEF
PL6.E3A0      #002=MOVE_TO_FIRST_POS File=ZIG$D_PAS2.:ZIC0TSI                    FRI 09/05/97 12:00 Page:297  
UWA.AC.FILE_CODE
       759**DCL       760--REDEF
UWA.AC.FLAG1.ERROR_TYPE
       756**DCL       757--REDEF
UWA.DB_STATUS
       685**DCL      1072>>DOWHILE
UWA.DIRECT_REF
       694**DCL      1067>>ASSIGN   1073>>ASSIGN   1075>>ASSIGN
