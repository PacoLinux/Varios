$COM*T***********************************************************************
$COM*T*                                                                     *
$COM*T*                Copyright (c) Bull HN Information Systems Inc., 1989 *
$COM*T*                                                                     *
$COM*T***********************************************************************
)TERM INPUT 4
 
 
 
;'        Function: GENBITS '
 
 
    " R_C GENBITS S;A;B;SS;Q
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]  $COM   $TPSSCREEN $DMD $GO0
[3]   S_' '$NE$TPS($-($R S)+1 0#0$MAXYC)$TAKS_-2 -2$DRPS $DMD $GO('P'=ORIENT)/o $DMD S_$TPSS
[4]  o:A_$OR/S $DMD B_$OR$RD1S $DMD SS_$R S
[5]   R_(Q_(-1+SS)$MIN-1+(A$I 1),B$I 1)$-,$MIN0.5#V2S 0 0
[6]   R_0$MAX(1$MAX(($MAX/A#$I $R A),$MAX/B#$I $R B)$-Q),R
[7]   S_,(1 16#$MAXR[1 2]%1 16)$TAKQ$DRPS
[8]   S_'0123456789ABCDEF'[$QIO+2$DCD$TPS((($R S)%4),4)$R S]
[9]   R_'0123456789ABCDEF'[,$QIO+16 16$ECD-1+$QAV$I C],,'3(ZI3),2(P<+>M<$->ZI4)' $QFMT 1 5$R WIDS[$QAV$I C],R
[10]  XMOUT ',',R
[11]  XMOUT S
[12]  R_''
    "
 
$COM  $QAV      9     9
$COM  $QFMT     9
$COM  $QIO      8     9
$COM  A         0     4_    5     6     6
$COM  B         0     4_    5     6     6
$COM  C         0     9     9
$COM  ORIENT    3
$COM  Q         0     5_    6     7
$COM  R         0_    5_    6_    6     7]    9_    9    10    12_
$COM  S         0     3_    3     3_    3     3_    3     4     4     4
$COM            7_    7     8_    8     8    11
$COM  SS        0     4_    5
$COM  V2S       5
$COM  WIDS      9]
$COM  XMOUT    10    11
$COM  YC        3
$COM  o         3     4:
0
 
 
;'        Function: DRAW    '
 
 
    " Z_DRAW P;$QIO;A;B;C;LN;EXV;D;l;r;t;f;FF;L;I;S
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_0 $DMD Z_''
[3]   $GO(0,J1,J2)['DRAW: ' CHECK P],0
[4]  J1:P_0,(1,$R P)$R P
[5]  J2:A_D2$MINP
[6]   A_(S_$R SCREEN)$DCD$TPS0$MAX$REVA
[7]   SCREEN_,SCREEN $DMD SCREEN[A]_lpchar $DMD SCREEN_S$R SCREEN
[8]  $COM
    "
(1 2$R -1 900)$QSM 'DRAW    '
 
$COM  $QIO      0     2_
$COM  A         0     5_    6_    6     7
$COM  B         0
$COM  C         0
$COM  CHECK     3
$COM  D         0
$COM  D2        5
$COM  EXV       0
$COM  FF        0
$COM  I         0
$COM  J1        3     4:
$COM  J2        3     5:
$COM  L         0
$COM  LN        0
$COM  P         0     3     4_    4     4     5
$COM  S         0     6_    7
$COM  SCREEN    6     7_    7     7]_   7_    7
$COM  Z         0_    2_
$COM  f         0
$COM  l         0
$COM  lpchar    7
$COM  r         0
$COM  t         0
0
 
 
;'        Function: CLEAR   '
 
 
    " CLEAR;Q;Z;LN;P;w;s;MX;I;$QIO;r;l;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_0 $DMD $GO(0=$QNC 'SCREEN')/DUN $DMD $GO(2$NE$R $R SCREEN)/DUN
[3]   $RV1(' '$OR.$NE,SCREEN)/SCREEN
[4]  DUN:
[5]   SCREEN_($REV2+$MAX$RD1vp)$R ' '
[6]   charsize_1 1 $DMD $XEC(0=$QNC 'lpchar')/'lpchar_''*'''
[7]   $GO(0=$QNC 'vp')/Svp
[8]   $GO((2&.=$R vp)&(2=$R $R vp)&(&/,<$RD1vp)&(0&.$LE,vp)&501&.>-2$TAK,vp)/0
[9]   'Illegal virtual page set to defaults'
[10] Svp:vp_2 2$R 10 3 70 33
    "
 
$COM  $QIO        0     2_
$COM  $QNC        2     6     7
$COM  DUN         2     2     4:
$COM  I           0
$COM  J           0
$COM  LN          0
$COM  MX          0
$COM  P           0
$COM  Q           0
$COM  SCREEN      2     3     3     5_
$COM  Svp         7    10:
$COM  Z           0
$COM  charsize    6_
$COM  l           0
$COM  r           0
$COM  s           0
$COM  vp          5     8     8     8     8     8    10_
$COM  w           0
0
 
 
;'        Function: PUT     '
 
 
    " PV_A PUT B;$QIO;PV;LN;p;b;C;D;I
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_0
[3]   LN_$I ((' '$NE1$TAK0$R B)$OR2<$R $R B)
[4]   'PUT: RIGHT ARG MUST BE TEXT VECTOR OR MATRIX' $QERS 970#LN
[5]   LN_$I (2>-1$TAK$R A)$OR(2<$R $R A)$OR(5<-1$TAK$R A)$OR0$NE1$TAK0$R A
[6]   'PUT: LEFT ARG MUST BE 2 ELEMENT VECTOR OR 2 COLUMN MATRIX' $QERS 971#LN
[7]   B_(-2$TAK1 1,$R B)$R B $DMD A_((1$TAK$R A),3$MAX-1$TAK$R A)$TAKA_(-2$TAK1,$R A)$R A
[8]   LN_$I (($R A)[0]$NE($R B)[0])&(1$NE1$TAK$R A)&1$NE1$TAK$R B
[9]   'PUT: NUMBER OF POINTS IN LEFT ARG $NE ROWS IN RIGHT ARG' $QERS 972#LN
[10]  $XEC((1=1$TAK$R A)&1$NE1$TAK$R B)/'A_(1$TAK $R   B)$RD1 A'
[11]  $XEC((1=1$TAK$R B)&1$NE1$TAK$R A)/'B_(1$TAK $R   A)$RD1 B'
[12]  $GO(0=C_1$TAK$R b_(D_A[;2]$NE0)$RD1B)/L $DMD p_D$RD1A $DMD I_0 $DMD A_(~D)$RD1A $DMD B_(~D)$RD1B
[13] L0:p[I;]LPUT($-(' '=$REVD)$I 0)$DRPD_b[I;] $DMD $GO(C>I_I+1)/L0
[14] L:LN_SCREEN GETLINE A[0;1]
[15]  LN_LN,,(B[0;]$NE' ')$RD1$QAV[A[0;0]+$I -1$TAK$R B],[0.2]B[0;]
[16]  SCREEN_SCREEN PUTLINE LN
[17]  B_1 0$DRPB $DMD $GO(0$NE1$TAK$R A_1 0$DRPA)/L
[18]  R_''
    "
(1 2$R -1 900)$QSM 'PUT     '
 
$COM  $QAV      15]
$COM  $QERS      4     6     9
$COM  $QIO       0     2_
$COM  A          0     5     5     5     5     7_    7     7     7_    7
$COM             7     8     8    10    11    12]   12    12_   12    14]
$COM            15]   17_   17
$COM  B          0     3     3     7_    7     7     8     8    10    11
$COM            12    12_   12    15]   15    15]   17_   17
$COM  C          0    12_   13
$COM  D          0    12_   12    12    12    13    13_
$COM  GETLINE   14
$COM  I          0    12_   13    13    13_   13
$COM  L         12    14:   17
$COM  LN         0     3_    4     5_    6     8_    9    14_   15_   15
$COM            16
$COM  LPUT      13
$COM  L0        13:   13
$COM  PUTLINE   16
$COM  PV         0_    0
$COM  R         18_
$COM  SCREEN    14    16_   16
$COM  b          0    12_   13]
$COM  p          0    12_   13]
0
 
 
;'        Function: D2      '
 
 
    " R_D2 Z;Q;DUPL;ALT;RAT;M;$QIO;P;QQ
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]  $COM P .. PEN UP/DOWN
[4]   P_(1$TAK$R Z)$R 0 $DMD $GO(3$NE-1$TAK$R Z)/NOP $DMD P_Z[;1] $DMD Z_0 1$DRPZ
[5]  $COM Q .. DISPLACEMENT TO NEXT POINT
[6]  NOP:Q_Z$--1 0$DRPZ[$QIO;],[$QIO]Z
[7]   Q_(~QQ)+Q#QQ_QQ,[1.5]QQ_0=P
[8]  $COM DUPL .. REPLICATION VECTOR FOR POINTS
[9]   DUPL_1$REV1,1$DRP$MAX/|Q
[10] $COM ALT .. AMT OF LESSER INCREASING X OR Y
[11]  ALT_($MIN/|Q)%$MAX/|Q
[12] $COM RAT .. INCREASE/PT
[13]  RAT_((($GE/|Q)$MAXALT),[1.2]($LE/|Q)$MAXALT)##Q
[14] $COM M   .. MULTIPLIERS FOR INCREASES
[15]  M_M,[1.2]M_-1+(,M)/,+\M_DUPL$SC.$GE$I 1+$MAX/DUPL
[16] $COM RESULT ..
[17]  R_$MIN(DUPL$RD1Z)+(DUPL$RD11$RV1RAT)#M
    "
 
$COM  $QIO    0     2_    6     6
$COM  ALT     0    11_   13    13
$COM  DUPL    0     9_   15    15    17    17
$COM  M       0    15_   15    15_   15    15_   17
$COM  NOP     4     6:
$COM  P       0     4_    4_    7
$COM  Q       0     6_    7_    7     9    11    11    13    13    13
$COM  QQ      0     7     7_    7     7_
$COM  R       0_   17_
$COM  RAT     0    13_   17
$COM  Z       0     4     4     4]    4_    4     6     6]    6    17
0
 
 
;'        Function: LPUT    '
 
 
    " A LPUT B;$QIO;FONT;LI;LL;L;M;MM;S;R;Y
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1 $DMD A_A,($-0$MAX5$-$R ,A)$TAK1 1 1 1 0 $COMS$DLTLPUT_-1 900,[1]FER,[1.5]79 73
[3]   $GO(83051$E $QFNUMS)/LP $DMD 'APLANAR$_ID.X,IN' $QFOPEN 83051
[4]  LP:L_1$DRP(LL,1$TAK$R LI)$-0,LL_($QAV[385]=LI[;1])/$I 1$TAK$R LI_$QFREAD 83051,A[3]
[5]   B_0$MAX-33+$QAV$I B $DMD B_1+B#B$LE$R LL
[6]   M_$MAX/MM_0$MAXL[B]$-2
[7]   S_($R S)$R 3 -9 $QCVT,S_LI[LL[B]+1;]
[8]   LI_($R LI)$R 3 -9 $QCVT,LI_LI[(,MM$SC.$GE$I M)/,LL[B]$SC.+1+$I M;]
[9]   LI[;3]_$MINA[2]+Y#R_A[4]%$MAX/Y_($MAX/Y)$-Y_LI[;3]
[10]  LI[;2]_$MINA[1]+(MM/+\R#0,-1$DRPS[;3]$-S[;2])+R#LI[;2]$-MM/S[;2]
[11]  DRAW(2 2$R 1 1 500 500)CLIP LI THRU A[5]ABOUT 2$TAKA $DMD $GO0
[12] FER:L_'PUT: CANNOT FIND FONT ',(73=1$TAK$QERN)/'FILE'
[13]  L $QERS 974+73=1$TAK$QERN
    "
(1 2$R -1 900)$QSM 'LPUT    '
 
$COM  $QAV      4]    5
$COM  $QCVT     7     8
$COM  $QERN    12    13
$COM  $QERS    13
$COM  $QFNUMS   3
$COM  $QFOPEN   3
$COM  $QFREAD   4
$COM  $QIO      0     2_
$COM  A         0     2_    2     2     4]    9]    9]   10]   11]   11
$COM  ABOUT    11
$COM  B         0     5_    5     5_    5     5     6     7     8
$COM  CLIP     11
$COM  DRAW     11
$COM  FER      12:
$COM  FONT      0
$COM  L         0     4_    6]   12_   13
$COM  LI        0     4     4]    4_    7]    8_    8     8_    8]    9]_
$COM            9]   10]_  10]   11
$COM  LL        0     4     4_    5     7]    8]
$COM  LP        3     4:
$COM  M         0     6_    8     8
$COM  MM        0     6_    8    10    10
$COM  R         0     9_   10    10
$COM  S         0     7_    7     7_   10]   10]   10]
$COM  THRU     11
$COM  Y         0     9     9_    9     9_
0
 
 
;'        Function: TH      '
 
 
    " R_L TH Z;$QIO;G;F;M;P;Q;QQ;S;SS;T;V;W;Y
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   $GO((0$E $R R_Z)$OR1$GEL)/0 $DMD W_L+$MAXL%4 $DMD G_$MIN($I W)$-W%2
[4]  $COM P  .. PEN UP/DOWN
[5]   P_(1$TAK$R Z)$TAK1 $DMD $GO(3$NE-1$TAK$R Z)/go
[6]   P_Z[;1] $DMD Z_0 1$DRPZ
[7]  $COM Q  .. displacements     QQ .. slope = infinity
[8]  go:Q_(0=1$DRPP)$RD1(1 0$DRPZ)$--1 0$DRPZ
[9]   QQ_0=Q[;2]
[10] $COM S  .. slopes
[11]  S_%/QQ$REVQ
[12]  Y_(T_1,(1+(0=1$REVT)#0=T_1$DRP-1$DRPP),1)$RD1Z
[13] $COM S  .. slopes rounded to -1, 0 or +1
[14]  QQ_QQ$ORV_10<|S $DMD SS_$R S_(#S)#(~V)&0.1<|S
[15]  Q_$R V_,G$SC.%1+S$NE0 $DMD M_(SS#$MAX(L$-W)%2)$REVQ$TAK(SS#L)$R 1
[16]  V_(Q$R 1$-QQ$ORS<0)$REV$MAX($-(Q$R S)#(Q$R (S<0)#-0.5)+V),[1.5]V
[17]  R_(2$RD1V)+((Q_2#Q),2)$R Y $DMD M_2/M
[18]  V_M#Q$R T/P $DMD V_V+(Q$R 1 0)#~M $DMD F_M$OR0$NE2/(Q%2)$R S
[19]  R_(P,Z),[1]F$RD1V,R
[20] $COM
    "
 
$COM  $QIO   0     2_
$COM  F      0    18_   19
$COM  G      0     3_   15
$COM  L      0     3     3     3    15    15
$COM  M      0    15_   17_   17    18    18    18
$COM  P      0     5_    6_    8    12    18    19
$COM  Q      0     8_    9]   11    15_   15    16    16    16    17_   17
$COM        18    18    18
$COM  QQ     0     9_   11    14_   14    16
$COM  R      0_    3_   17_   19_   19
$COM  S      0    11_   14    14_   14    14    15    16    16    16    18
$COM  SS     0    14_   15    15
$COM  T      0    12_   12    12_   18
$COM  V      0    14_   14    15_   16_   16    16    17    18_   18_   18
$COM        19
$COM  W      0     3_    3     3    15
$COM  Y      0    12_   17
$COM  Z      0     3     5     5     6]    6_    6     8     8    12    19
$COM  go     5     8:
0
 
 
;'        Function: ALLCHARS'
 
 
    " ALLCHARS;A;B;C;D;E;F
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   A_'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'
[3]   A_A,'$LTK$RTK$"-<$LE=$GE>$NE$OR&+$-#%{}$GO_()[].,:;/\$DMD$@$DCD$CAP'
[4]   A_A,'$Q0$Q1$Q2$Q3$Q4$Q5$Q6$Q7$Q8$Q9$QQ'
[5]   B_$R A_A,'$MIN$E$_"$DLT$I$SC''$Q|$ECD$O*?$R$MAX~$DRP$CUP$W$DSC$TAK$ENC'
[6]  $COM
[7]   F_1
[8]  lp:$QPGE $DMD DOIT A[F] $DMD $GO(B$GEF_F+1)/lp
    "
 
$COM  $QPGE   8
$COM  A       0     2_    3_    3     4_    4     5_    5     8]
$COM  B       0     5_    8
$COM  C       0
$COM  D       0
$COM  DOIT    8
$COM  E       0
$COM  F       0     7_    8     8_    8
$COM  lp      8:    8
0
 
 
;'        Function: XMOUT   '
 
 
    " XMOUT R
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]  l:$Q1_(80$MIN$R R)$TAKR
[3]   $GO(0$NE$R R_80$DRPR)/l
    "
 
$COM  R    0     2     2     3_    3
$COM  l    2:    3
0
 
 
'  **** Creating package: GENFONT'
GENFONT_$QPACK n_9 8$R  'GENBITS DRAW    CLEAR   PUT     D2      LPUT    TH      ALLCHARSXMOUT   ' $DMD (~$QEX n)$RD1 n
$XEC')TERM INPUT ',$FMT $QTT $DMD (~$QEX 'n')/'n'
)TERM INPUT 4
 
 
 
;'        FUNCTION: CHECK         '
 
 
    " R_M CHECK P
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]  $COM SHOWS: EMPTY, RANK 1, AND/OR RANK 2
[3]   R_((0$OR.=$R P),(1 2=$R $R P)&(-1$TAK$R P)$E 2 3)/$I 3 $DMD $GO (0<$R R)/0
[4]   (M,' ARGUMENT MUST BE PICTURE OR STROKE.')$QERS 902
    "
 
$COM  $QERS   4
$COM  M       0     4
$COM  P       0     3     3     3
$COM  R       0_    3_    3
0
 
 
;'        FUNCTION: CHECKFF       '
 
 
    " R_FID CHECKFF F;T;MYNAME
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QFCLOSE(1$E $QFNUMS)/1 $DMD ((err,3$R ero),[1.5]79 73 76 77)$QSM MYNAME_'CHECKFF'
[3]   (FID,',IN,ALL')$QFOPEN 1
[4]   DIGSNAME_10$TAK$QFREAD 1($QAV[,1+512 512$ECDF])0 3
[5]   R_1 $DMD $GO 0
[6]  err:ERROR ' ** Can''t find Font Number: ',$FMT F $DMD $GO R_0
[7]  ero:ERROR ' ** Can''t find font file: ',FID $DMD $GO R_0
    "
 
$COM  $Q          6_    7_
$COM  $QAV        4]
$COM  $QFCLOSE    2
$COM  $QFNUMS     2
$COM  $QFOPEN     3
$COM  $QFREAD     4
$COM  $QSM        2
$COM  DIGSNAME    4_
$COM  ERRMSG      6_    7_
$COM  F           0     4
$COM  FID         0     3
$COM  MYNAME      0     2_
$COM  R           0_    5_    6_    7_
$COM  T           0
$COM  ero         2     7:
$COM  err         2     6:
0
 
 
;'        FUNCTION: COPYRIGHT     '
 
 
    " COPYRIGHT T;O;f;N;I;J;$QIO;V
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   O_$R T_'$COM*T*  COPYRIGHT, (C) ',T,', ',$FMT1$TAK$QTS
[4]   f_$QNL 3
[5]   I_0 $DMD J_1$TAK$R f
[6]  L:$GO (0$E $R V_$QCR f[I_I+1;])/LX
[7]   $GO ('$COM*T* '&.=5$TAKV[1+$QIO;])/1+$QLC $DMD V_(1 0,(-1+1$TAK$R V)$R 1)$XP1V
[8]   $GO (O<-1$TAK$R V)/1+$QLC $DMD V_((1$TAK$R V),O)$TAKV
[9]   V[1+$QIO;]_(-1$TAK$R V)$TAKT
[10]  $QFX V
[11] LX:$GO (J$NEI)/L $DMD $GO (2=$QNC 'N')/Lp
[12]  N_$QNL 2 $COM FOR PACKAGES
[13] LL:$XEC'$XEC(I_~0$E $R f_$QPNAMES ',V,')/''$QPDEF ',(V_N[1;]),''''
[14]  I/'PACKAGE: ',N[1;] $DMD I_0 $DMD $GO (0<J_1$TAK$R f)/L $DMD $GO LN
[15] Lp:$XECN[1;],'_$QPACK f $DMD V_$QEX f'
[16] LN:$GO (0$NE1$TAK$R N_1 0$DRPN)/LL
    "
 
$COM  $QCR   6
$COM  $QFX  10
$COM  $QIO   0     2_    7     9
$COM  $QLC   7     8
$COM  $QNC  11
$COM  $QNL   4    12
$COM  $QTS   3
$COM  I      0     5_    6_    6    11    14    14_
$COM  J      0     5_   11    14_
$COM  L      6:   11    14
$COM  LL    13:   16
$COM  LN    14    16:
$COM  LX     6    11:
$COM  Lp    11    15:
$COM  N      0    12_   13]   14]   15]   16_   16
$COM  O      0     3_    8     8
$COM  T      0     3_    3     9
$COM  V      0     6_    7]    7_    7     7     8     8_    8     8     9]_
$COM         9    10    13    13_
$COM  f      0     4_    5     6]   14
0
 
 
;'        FUNCTION: DEFAULTS      '
 
 
    " R_DOFIELDS IN
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   S[S[;1] $I IN[;1];7]_IN[;2]
[3]   R_S[(S[;6]=0)/$I 1$TAK$R S;1 7]
    "
 
$COM  PROCESS$_INPUT   2
$COM  SCREEN           2]    2]    2
0
 
 
;'        FUNCTION: DISPLAY$_SCREEN'
 
 
    " R_DISPLAY$_SCREEN S;GENBITS;DRAW;CLEAR;PUT;D2;LPUT;TH;ALLCHARS;XMOUT;LIMS;QUAD;WIDS;charsize;lpchar;FontFile;FontNum;DIGEN;CPI;THICK;prop;ORIENT;QMSfid;FONTNAME;FONTNUMBER;APL;D;YC;pch;vp;win;ERRMSG;FONT;DIGSNAME;IN
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QPDEF GENFONT
[3]   $XEC')SET $Q1 UC05,ORG=FORM,WLEN=18'
[4]   S $QBFLD 1
[5]  in:((S[;6]$NE2)/S[;1])$QBSFLD 1
[6]   $GO (1$NE$TAKR_PROCESS$_INPUT DOFIELDS $Q1)/error
[7]   $GO (1$NE$TAKR_INITGEN)/error
[8]   FINISH$_SCREEN
[9]   ' ***  Generating Fonts  ***' $DMD FONTINFO
[10]  D_1 $DMD $GO ('D'=DIGEN)/d
[11] gen:$XEC')SET $Q1 ',QMSfid,',FUN=C' $DMD D_0
[12] d:$GO APL/ga
[13]  D XMITFONT THICK
[14]  $GO 0
[15] ga:D XMITAPL THICK
[16]  $GO 0
[17] error:$GO in
    "
 
$COM  $QBFLD           4
$COM  $QBSFLD          5
$COM  $QPDEF           2
$COM  ALLCHARS         0
$COM  APL              0    12
$COM  CLEAR            0
$COM  CPI              0
$COM  D                0    10_   11_   13    15
$COM  DEFAULTS         2
$COM  DIGEN            0    10
$COM  DIGSNAME         0
$COM  DRAW             0
$COM  D2               0
$COM  ERRMSG           0
$COM  FINISH$_SCREEN   8
$COM  FONT             0
$COM  FONTINFO         9
$COM  FONTNAME         0
$COM  FONTNUMBER       0
$COM  FontFile         0
$COM  FontNum          0
$COM  GENBITS          0
$COM  GENFONT          2
$COM  INITGEN          7
$COM  LIMS             0
$COM  LPUT             0
$COM  ORIENT           0
$COM  PROCESS$_INPUT   6
$COM  PUT              0
$COM  QMSfid           0    11
$COM  QUAD             0
$COM  R                0_    6_    7_
$COM  S                0     4     5]    5]
$COM  TH               0
$COM  THICK            0    13    15
$COM  WIDS             0
$COM  XMITAPL         15
$COM  XMITFONT        13
$COM  XMOUT            0
$COM  YC               0
$COM  charsize         0
$COM  d               10    12:
$COM  error            6     7    17:
$COM  ga              12    15:
$COM  gen             11:
$COM  in               6:   17
$COM  lpchar           0
$COM  pch              0
$COM  prop             0
$COM  vp               0
$COM  win              0
0
 
 
;'        FUNCTION: DOLIST        '
 
 
    " DOLIST;$QIO;N;T;V;n;I;J;s;F;$QPW
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1 $DMD $QPW_300 $DMD N_$QNL 2 $DMD s_3 1$R ' '
[3]   (1 2$R ER,35)$QSM 'DOLIST' $COM SIDETRACK ON DEFN ERR
[4]   V_$XEC')TERM OUTPUT 4'
[5]   ')TERM INPUT 4' $DMD F_''
[6]  L:$GO (2$NE$R $R n_$QPNAMES$XEC'V_',T_N[1;])/X
[7]   (F_(3=$QPNC V)$RD1n)$QPDEF V $DMD I_0 $DMD J_1$TAK$R F
[8]  LL:$GO (J<I_I+1)/X $DMD s $DMD V_$XEC'"',F[I;],'[$Q]"'
[9]   ';''        Function: ',F[I;],'''' $DMD ' ' $DMD ' '
[10]  (~($I ($R V)+$R n)$E ($I $R n)+n_((~$NE\''''=V)&V$E '$E$O$I$R')/$I $R V)\V
[11]  (0$NE$R ($QSSS(V;'$QERS')),$QSSS(V;'CHECK '))/'(1 2$R -1 900)$QSM ','''',F[I;],''''
[12]  $QPW_73 $DMD V_' ',[$QIO]'$COM',' ',' ',XREF F[I;] $DMD $QPW_300 $DMD V
[13]  $QVFC '0' $DMD $GO LL
[14] ER:'''**** ',F[I;],' NOT INCLUDED''' $DMD F_(I$NE$I J)$RD1F
[15]  I_I$-1 $DMD $GO LL
[16] X:$GO (0$E $R F)/xx $DMD I_$QEX F $DMD s
[17]  '''  **** Creating package: ',T,''''
[18]  T,'_$QPACK n_',($FMT$R F),'$R  ''',(,F),''' $DMD (~$QEX n)$RD1 n'
[19] xx:F_'' $DMD $GO (0$NE1$TAK$R N_1 0$DRPN)/L
[20]  '$XEC'')TERM INPUT '',$FMT $QTT $DMD (~$QEX ''n'')/''n'''
[21]  V_$XEC')TERM ',$FMT$QTT
    "
(1 2$R14 35)$QSM'DOLIST        '
 
$COM  $QEX      16
$COM  $QIO       0     2_   12
$COM  $QNL       2
$COM  $QPDEF     7
$COM  $QPNAMES   6
$COM  $QPNC      7
$COM  $QPW       0     2_   12_   12_
$COM  $QSM       3
$COM  $QSSS     11    11
$COM  $QTT      21
$COM  $QVFC     13
$COM  ER         3    14:
$COM  F          0     5_    7_    7     8]    9]   11]   12]   14]   14_
$COM            14    16    16    18    18    19_
$COM  I          0     7_    8_    8     8     9    11    12    14    14
$COM            15_   15    16_
$COM  J          0     7_    8    14
$COM  L          6:   19
$COM  LL         8:   13    15
$COM  N          0     2_    6]   19_   19
$COM  T          0     6_   17    18
$COM  V          0     4_    7     7     8_   10    10    10    10    10
$COM            11    11    12_   12    21_
$COM  X          6     8    16:
$COM  XREF      12
$COM  n          0     6_    7    10    10    10_
$COM  s          0     2_    8    16
$COM  xx        16    19:
0
 
 
;'        FUNCTION: FINISH$_SCREEN '
 
 
    " FINISH$_SCREEN
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $XEC')SET $Q1 ME' $DMD $XEC')!T SC'
    "
 
$COM
0
 
 
;'        FUNCTION: FONTCONTROL   '
 
 
    " FONTCONTROL;D;FONT;LIMS;CPI;YC;pch;vp;win;DRAW;CLEAR;PUT;D2;LPUT;TH;ALLCHARS;GENBITS;XMOUT;FONTNUMBER;FONTNAME;ORIENT;WIDS;THICK;prop
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   FONT_256$R $ENC0 3$R 0 $DMD $QPDEF GENFONT $DMD D_1
[3]   $QQ_'Font Number?      ' $DMD FONT_LOADFONT FONTNUMBER_$XEC$QQ $DMD ' '
[4]  p0:$QQ_'   Proportional?  ' $DMD $GO ((prop_-1+'NY'$I 1$TAKNB$QQ)$E 0 1)/p1
[5]   'Enter Yes OR No' $DMD $GO p0
[6]  p1:$QQ_'Chars/inch?       ' $DMD CPI_$XEC$QQ $COM CHARS/INCH
[7]   $GO (CPI$E 5+$I 12)/t0 $DMD 'MAX CHAR/INCH=18, MIN CHAR/INCH=6' $DMD $GO p1
[8]  t0:$QQ_'Stroke thickness? ' $DMD THICK_$XEC$QQ
[9]   $GO (THICK$E 1+$I 8)/p2 $DMD 'MAX THICKNESS=9,MIN THICKNESS=2' $DMD $GO t0
[10] p2:pch_$MAX300%CPI $DMD pch_$MINpch#30 50 36%30
[11]  WIDS_$MIN0$MAXWIDS#pch[3]%80
[12]  $GO prop/p3 $DMD WIDS[]_pch[1]$-0$NECPI|300
[13] p3:win_$MIN(2 2$R 1 1.01 1 1.06)#0 1$DRPLIMS
[14]  vp_2 2$R 0 0,pch[1],$MAX(win[2;2]$-win[1;2])#pch[3]%80
[15]  YC_$MAX$-pch[3]$-pch[2]+win[1;2]#pch[3]%80
[16] g0:$QQ_'Display/Generate? ' $DMD $GO ('DG'=1$TAKNB$QQ)/c0,g1
[17]  'Display bit pattern' $DMD 'Generate QMS font' $DMD ' ' $DMD $GO g0
[18] g1:$QQ_'Output fid?       ' $DMD $XEC')SET $Q1 ',$QQ,',FUN=C' $DMD D_0
[19] g2:$QQ_'FONT NAME?        ' $DMD $GO (4$GE$R FONTNAME_NB$QQ)/g3
[20]  'Font name maximum is 4 chars.' $DMD $GO g2
[21] g3:FONTNAME_4$TAKFONTNAME
[22] g4:$QQ_'ORIENTATION?      ' $DMD $GO ((ORIENT_1$TAKNB$QQ)$E 'PL')/c0
[23]  'Enter Portrait or Landscape' $DMD $GO g4
[24] c0:$QQ_'APL font?         ' $DMD $GO ('YN'=1$TAKNB$QQ)/c1,c2 $DMD 'ENTER YES OR NO' $DMD $GO g2
[25] c1:D XMITAPL THICK
[26]  $GO 0
[27] c2:D XMITFONT THICK
[28]  $GO 0
    "
 
$COM  $QPDEF        2
$COM  ALLCHARS      0
$COM  CLEAR         0
$COM  CPI           0     6_    7    10    12
$COM  D             0     2_   18_   25    27
$COM  DRAW          0
$COM  D2            0
$COM  FONT          0     2_    3_
$COM  FONTNAME      0    19_   21_   21
$COM  FONTNUMBER    0     3_
$COM  GENBITS       0
$COM  GENFONT       2
$COM  LIMS          0    13
$COM  LOADFONT      3
$COM  LPUT          0
$COM  NB            4    16    19    22    24
$COM  ORIENT        0    22_
$COM  PUT           0
$COM  TH            0
$COM  THICK         0     8_    9    25    27
$COM  WIDS          0    11_   11    12]_
$COM  XMITAPL      25
$COM  XMITFONT     27
$COM  XMOUT         0
$COM  YC            0    15_
$COM  c0           16    22    24:
$COM  c1           24    25:
$COM  c2           24    27:
$COM  g0           16:   17
$COM  g1           16    18:
$COM  g2           19:   20    24
$COM  g3           19    21:
$COM  g4           22:   23
$COM  pch           0    10_   10_   10    11]   12]   14]   14]   15]   15]
$COM               15]
$COM  prop          0     4_   12
$COM  p0            4:    5
$COM  p1            4     6:    7
$COM  p2            9    10:
$COM  p3           12    13:
$COM  t0            7     8:    9
$COM  vp            0    14_
$COM  win           0    13_   14]   14]   15]
0
 
 
;'        FUNCTION: FONTINFO      '
 
 
    " FONTINFO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   'DIGS Font File: ',FontFile,', DIGS Font Number: ',($FMTFontNum),', DIGS Name: ',DIGSNAME
[3]   ($FMTCPI),' Characters/Inch, ',($FMTTHICK),' strokes thick, ',((0=prop)/'Non'),'Proportional'
[4]   (,(2 9$R 'Portrait Landscape')[1+'L'=ORIENT;]),' orientation, QMSNAME=''',FONTNAME,''', QMS number=',$FMTFONTNUMBER
    "
 
$COM  CPI          3
$COM  DIGSNAME     2
$COM  FONTNAME     4
$COM  FONTNUMBER   4
$COM  FontFile     2
$COM  FontNum      2
$COM  ORIENT       4
$COM  THICK        3
$COM  prop         3
0
 
 
;'        FUNCTION: FUNCLIST      '
 
 
'FUNCLIST       *** NOT LISTED ***'
0
 
 
;'        FUNCTION: INITGEN       '
 
 
    " R_INITGEN;QUIET;FONTNAME
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   QUIET_0
[3]   $GO (0$NE$R FONT_FontFile LOADFONT FontNum)/gf
[4]   $GO R_0 3 5
[5]  gf:pch_$MAX300%CPI $DMD pch_$MINpch#30 50 36%30
[6]   WIDS_$MIN0$MAXWIDS#pch[3]%80
[7]   $GO prop/np
[8]   WIDS[]_pch[1]$-0$NECPI|300
[9]  np:win_(2 2$R 1 1.01 1 1.06)#0 1$DRPLIMS
[10]  vp_2 2$R 0 0,pch[1],$MAX(win[2;2]$-win[1;2])#pch[3]%80
[11]  YC_$MAX$-pch[3]$-pch[2]+win[1;2]#pch[3]%80
[12]  DIGSNAME_FONTNAME
[13]  R_1 $DMD $GO 0
    "
 
$COM  CPI        5     8
$COM  DIGSNAME  12_
$COM  FONT       3_
$COM  FONTNAME   0    12
$COM  FontFile   3
$COM  FontNum    3
$COM  LIMS       9
$COM  LOADFONT   3
$COM  QUIET      0     2_
$COM  R          0_    4_   13_
$COM  WIDS       6_    6     8]_
$COM  YC        11_
$COM  gf         3     5:
$COM  np         7     9:
$COM  pch        5_    5_    5     6]    8]   10]   10]   11]   11]   11]
$COM  prop       7
$COM  vp        10_
$COM  win        9_   10]   10]   11]
0
 
 
;'        FUNCTION: LIM           '
 
 
    " R_LIM R
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_($MIN$RD1R),[$QIO$-0.1]$MAX$RD1R
    "
 
$COM  $QIO   2
$COM  R      0_    0     2_    2     2
0
 
 
;'        FUNCTION: LOADFONT      '
 
 
    " R_FID LOADFONT F;MYNAME;CH;REC;KC
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (2 2$R nf bf,[1.5]79 73)$QSM MYNAME_'LOADFONT'
[3]   ' ' $DMD $QFCLOSE(1$E $QFNUMS)/1 $DMD $GO (2=$QNC 'FID')/OK
[4]   FID_'XG$FONT.:LIBRARY'
[5]  OK:(FID,',IN,ALL')$QFOPEN 1
[6]   CH_$QFREAD 1($QAV[,1+512 512$ECDF])0 3 $DMD $GO LDR
[7]  nf:R_'' $DMD ERROR ' ** Font not found!' $DMD $GO 0
[8]  bf:ERROR ' ** Font file not found!' $DMD $GO 0,R_''
[9]  LDR:R_256$R 0 $DMD (1 2$R DONE,79)$QSM MYNAME $DMD LIMS_1 3$R 0
[10]  WIDS_3 -9 $QCVT -256$TAKCH $DMD 'Font Name: ',FONTNAME_F_10$TAKCH
[11]  CH_$QFREAD 1 F 0 3
[12] lp:REC_3 -9 $QCVT $QFREAD 1 '' 0 3
[13]  $GO (F$OR.$NE10$TAKKC_$QFRKEY 1 2)/DONE
[14]  R[$QAV$I CH_-1$TAKKC]_$ENCREC_MF REC $DMD $QQ_(~QUIET)/CH
[15]  LIMS_LIM LIMS,[$QIO]REC
[16]  $GO lp
[17] DONE:' '
[18] $COM  QUAD_$TAKFONT[$QAV$I '$Q']
    "
 
$COM  $Q          7_    8_
$COM  $QAV        6]   14
$COM  $QCVT      10    12
$COM  $QFCLOSE    3
$COM  $QFNUMS     3
$COM  $QFOPEN     5
$COM  $QFREAD     6    11    12
$COM  $QFRKEY    13
$COM  $QIO       15
$COM  $QNC        3
$COM  $QSM        2     9
$COM  CH          0     6_   10    10    11_   14_   14
$COM  DONE        9    13    17:
$COM  ERRMSG      7_    8_
$COM  F           0     6    10_   11    13
$COM  FID         0     4_    5
$COM  FONTNAME   10_
$COM  KC          0    13_   14
$COM  LDR         6     9:
$COM  LIM        15
$COM  LIMS        9_   15_   15
$COM  MF         14
$COM  MYNAME      0     2_    9
$COM  OK          3     5:
$COM  QUIET      14
$COM  R           0_    7_    8_    9_   14]_
$COM  REC         0    12_   14_   14    15
$COM  WIDS       10_
$COM  bf          2     8:
$COM  lp         12:   16
$COM  nf          2     7:
0
 
 
;'        FUNCTION: MF            '
 
 
    " R_MF R;I;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_((($R R)%2),2)$R R_0$DRPR
[3]   R_(J/-1$REVI),(J_~I_R[;1]=-256)$RD1R
    "
 
$COM  I      0     3     3_
$COM  J      0     3     3_
$COM  R      0_    0     2_    2     2_    2     3_    3]    3
0
 
 
;'        FUNCTION: NB            '
 
 
    " R_NB R;I
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_(-1+I$I 0)$DRP(1$-($REVI_R=' ')$I 0)$DRPR
    "
 
$COM  I    0     2     2_
$COM  R    0_    0     2_    2     2
0
 
 
;'        FUNCTION: ONENUM        '
 
 
    " R_ONENUM R;T
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO ((1=$R T)&1=$R R_($QVI R)/T_$QFI R)/0
[3]   R_''
    "
 
$COM  $QFI   2
$COM  $QVI   2
$COM  R      0_    0     2_    2     2     3_
$COM  T      0     2     2_
0
 
 
;'        FUNCTION: PROCESS$_INPUT '
 
 
    " R_PROCESS$_INPUT IN;I;J;T;C;F
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=I_1$TAK$R IN)/0 $DMD J_1
[3]  lp:F_$TAKIN[J;2] $DMD C_IN[J;1]
[4]   $GO (C=3 5 7 10 12 14 16 18 21 23 25)/ff fn dg cpi st pl apl p qf fnm qn
[5]   ERROR '*** System error: unknown input field'
[6]   $GO elp
[7]  ff:FontFile_F $DMD $GO elp
[8]  fn:$GO (1=$R FontNum_ONENUM F)/elp
[9]   ERROR ' ** Illegal font number' $DMD $GO R_0 C
[10] dg:$GO ('DGN'=DIGEN_F)/elp elp xit
[11]  ERROR ' ** Display bit pattern/Generate QMS font file'
[12]  $GO R_0 C
[13] cpi:$GO (1$NE$R CPI_ONENUM F)/cperr $DMD $GO (CPI$E 5+$I 12)/elp
[14] cperr:ERROR ' ** Max char/inch=18, min char/inch=6' $DMD $GO R_0 C
[15] st:$GO (1$NE$R THICK_ONENUM F)/sterr $DMD $GO (THICK$E 1+$I 8)/elp
[16] sterr:ERROR ' ** Max thickness=9, min thickness=2' $DMD $GO R_0 C
[17] p:$GO ((prop_-1+'NY'$I $TAKF)$E 0 1)/elp
[18]  ERROR ' ** Enter Y or N for Proportional' $DMD $GO R_0 C
[19] pl:$GO ((ORIENT_1$TAKF)$E 'PL')/elp
[20]  ERROR ' ** Enter P or L for Portrait or Landscape' $DMD $GO R_0 C
[21] qf:QMSfid_F $DMD $GO elp
[22] fnm:FONTNAME_F $DMD $GO elp
[23] qn:$GO ((FONTNUMBER$LE99999)&(FONTNUMBER$GE0)&1=$R FONTNUMBER_ONENUM F)/elp
[24]  ERROR ' ** Illegal QMS font number' $DMD $GO R_0 C
[25] apl:$GO ((APL_-1+'NY'$I $TAKF)$E 0 1)/elp
[26]  ERROR ' ** Enter Y or N for APL font' $DMD $GO R_0 C
[27] elp:$GO (I$GEJ_J+1)/lp
[28] xit:$GO(0=$TAK R_FontFile CHECKFF FontNum)/0
[29]  $GO('N'$NE DIGEN)/0
[30] nmf:ERROR ' ** Font name is: ',DIGSNAME $DMD $GO R_0 2
    "
 
$COM  $Q            5_    9_   11_   14_   16_   18_   20_   24_   26_
$COM  APL          25_
$COM  C             0     3_    4     9    12    14    16    18    20    24
$COM               26
$COM  CHECKFF      28
$COM  CPI          13_   13
$COM  DIGEN        10_
$COM  ERRMSG        5_    9_   11_   14_   16_   18_   20_   24_   26_
$COM  F             0     3_    7     8    10    13    15    17    19    21
$COM               22    23    25
$COM  FONTNAME     22_
$COM  FONTNUMBER   23    23    23_
$COM  FontFile      7_   28
$COM  FontNum       8_   28
$COM  I             0     2_   27
$COM  IN            0     2     3]    3]
$COM  J             0     2_    3     3    27_   27
$COM  ONENUM        8    13    15    23
$COM  ORIENT       19_
$COM  QMSfid       21_
$COM  R             0_    9_   12_   14_   16_   18_   20_   24_   26_   28_
$COM  T             0
$COM  THICK        15_   15
$COM  apl           4    25:
$COM  cperr        13    14:
$COM  cpi           4    13:
$COM  dg            4    10:
$COM  elp           6     7     8    10    13    15    17    19    21    22
$COM               23    25    27:
$COM  ff            4     7:
$COM  fn            4     8:
$COM  fnm           4    22:
$COM  lp            3:   27
$COM  p             4    17:
$COM  pl            4    19:
$COM  prop         17_
$COM  qf            4    21:
$COM  qn            4    23:
$COM  st            4    15:
$COM  sterr        15    16:
0
 
 
;'        FUNCTION: V2S           '
 
 
    " PS_V2S PV;$QIO;K;D
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_0
[3]   $GO (J0,J1,J2)['V2S: ' CHECK PV],0
[4]  J0:PS_$I 0 $DMD $GO 0
[5]  J1:PV_(1,$R PV)$R PV
[6]  J2:K_-2+-1$TAK$R PS_PV
[7]   D_($-$RD1vp)%$-$RD1win
[8]   PS[;K]_vp[0;0]+D[0]#PV[;K]$-win[0;0]
[9]   PS[;1+K]_vp[0;1]+D[1]#PV[;1+K]$-win[0;1]
    "
 
$COM  $QIO     0     2_
$COM  CHECK    3
$COM  D        0     7_    8]    9]
$COM  J0       3     4:
$COM  J1       3     5:
$COM  J2       3     6:
$COM  K        0     6_    8     8     9     9
$COM  PS       0_    4_    6_    8]_   9]_
$COM  PV       0     3     5_    5     5     6     8]    9]
$COM  vp       7     8]    9]
$COM  win      7     8]    9]
0
 
 
;'        FUNCTION: XMITAPL       '
 
 
    " D XMITAPL L;SCREEN;A;B;T;X
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   B_$R A_APLASCII $DMD F_$QBTRANS 1 0
[3]  $COM  $QPDEF GENFONT
[4]   F_0 $DMD X_32 $DMD $GO D/lp
[5]   XMOUT '$TAKF$TAK$-'
[6]   XMOUT '$TAKDF',(,'ZI5' $QFMT FONTNUMBER),ORIENT,'0',FONTNAME,,'ZI3,<T>' $QFMT pch[2]
[7]   CLEAR $DMD ' ' GENBITS SCREEN $DMD T_$QEX 'SCREEN'
[8]  lp:$GO (B<F_F+1)/x
[9]   CLEAR $DMD DRAW L TH$MINV2S$TAKFONT[$QAV$I T_A[F]] $DMD $GO D/d $DMD $QQ_T
[10]  (2$TBRX_X+1)GENBITS SCREEN $DMD T_$QEX 'SCREEN' $DMD $GO lp
[11] x:' ' $DMD $GO D/0
[12]  XMOUT '$TAKG$TAK$-'
[13]  XMOUT '$TAKO$TAK$-'
[14]  $GO 0
[15] d:T $DMD $RV1SCREEN $DMD T_$QEX 'SCREEN' $DMD $GO lp
    "
 
$COM  $QAV          9
$COM  $QBTRANS      2
$COM  $QEX          7    10    15
$COM  $QFMT         6     6
$COM  A             0     2_    9]
$COM  APLASCII      2
$COM  B             0     2_    8
$COM  CLEAR         7     9
$COM  D             0     4     9    11
$COM  DRAW          9
$COM  F             2_    4_    8_    8     9
$COM  FONT          9]
$COM  FONTNAME      6
$COM  FONTNUMBER    6
$COM  GENBITS       7    10
$COM  L             0     9
$COM  ORIENT        6
$COM  SCREEN        0     7    10    15
$COM  T             0     7_    9_    9    10_   15    15_
$COM  TH            9
$COM  V2S           9
$COM  X             0     4_   10_   10
$COM  XMOUT         5     6    12    13
$COM  d             9    15:
$COM  lp            4     8:   10    15
$COM  pch           6]
$COM  x             8    11:
0
 
 
;'        FUNCTION: XMITFONT      '
 
 
    " D XMITFONT L;SCREEN;A;B;T;X
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]  $COM  $QPDEF LP
[3]   B_((B>31)&B<128)/B_(~0$E $"2$TAK$"$R $"FONT)/$I $R FONT
[4]   $GO D/lp
[5]   XMOUT '$TAKF$TAK$-'
[6]   XMOUT '$TAKDF',(,'ZI5' $QFMT FONTNUMBER),ORIENT,'0',FONTNAME,,'ZI3,<T>' $QFMT pch[2]
[7]   CLEAR $DMD ' ' GENBITS SCREEN $DMD T_$QEX 'SCREEN'
[8]  lp:T_1$TAKB
[9]   CLEAR $DMD DRAW 0$MAXL TH$MINV2S$TAKFONT[T] $DMD $GO D/d $DMD $QQ_$QAV[T]
[10]  ($QAV[T])GENBITS SCREEN $DMD T_$QEX 'SCREEN'
[11] x:$GO (0$NE$R B_1$DRPB)/lp $DMD ' ' $DMD $GO D/0
[12]  XMOUT '$TAKG$TAK$-'
[13]  XMOUT '$TAKO$TAK$-'
[14]  $GO 0
[15] d:$QAV[T] $DMD $TPSSCREEN $DMD T_$QEX 'SCREEN' $DMD $GO x
    "
 
$COM  $QAV          9]   10]   15]
$COM  $QEX          7    10    15
$COM  $QFMT         6     6
$COM  A             0
$COM  B             0     3_    3     3     3_    8    11_   11
$COM  CLEAR         7     9
$COM  D             0     4     9    11
$COM  DRAW          9
$COM  FONT          3     3     9]
$COM  FONTNAME      6
$COM  FONTNUMBER    6
$COM  GENBITS       7    10
$COM  L             0     9
$COM  ORIENT        6
$COM  SCREEN        0     7    10    15
$COM  T             0     7_    8_    9     9    10    10_   15    15_
$COM  TH            9
$COM  V2S           9
$COM  X             0
$COM  XMOUT         5     6    12    13
$COM  d             9    15:
$COM  lp            4     8:   11
$COM  pch           6]
$COM  x            11:   15
0
 
 
;'        FUNCTION: XREF          '
 
 
    " R_XREF F;$QIO;A;B;C;D;E;G;H;I;J;K
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   $GO (0$E $R R_(''$R -1$TAK$QAV),$QCR F_(' '$NEF)/F)$DRPLF
[4]   '<',F,'> IS ',(B/'LOCKED.'),(~B_3=$QNC F)/'NOT A FUNCTION.'
[5]   R_0 0$R '' $DMD $GO 0
[6]  LF:E_1$DRPR[1;]
[7]   E_(1$-(' '=$REVE)$I 0)$DRPE
[8]   I_$REV(-1+E$I ';')$TAKE
[9]   E[($I $R F)+($R I)$-($R F)+(' '$E I)#I$I ' ']_' '
[10]  B_$NE\R$E ''''
[11]  B_B$NOR$OR\B<R$E '$COM'
[12]  H_' $QABCDEFGHIJKLMNOPQRSTUVWXYZ$DLT$_abcdefghijklmnopqrstuvwxyz$UDL-0123456789'
[13]  R_E,(1$DRP$R R)$DRP((,B)/,R),' '
[14]  I_R$E 1$DRPH
[15]  R_(I$OR(-1$REVI)$OR(R$E '[',-1$TAK$QAV)$ORC$OR-1$REVC_R$E ']')/R
[16]  I_R$E 1$DRPH
[17]  G_(0,-1$DRPR[G]$E 1$DRP-11$DRPH)/G_(I$NE-1$REVI)/$I $R R
[18]  D_+\(R$E '[')$-R$E ']'
[19]  K_R[($R R)$MIN1++/$OR\$REV<\(B$SC.<$I $R R)&(D[B_(R[G]='[')/G]$-1)$SC.=D]
[20]  A_((R$E -1$TAK$QAV)/$I $R R)+.<(1,($R G),1)$R G
[21]  A_2$REV':]_ '[':[_'$I R[G],[1.5](G$E B)\K],4 0$FMTA
[22]  R_-1$DRP(I$OR0,-1$DRPI)/R
[23]  K_(~B_R$E 1$DRPH)/$I $R R
[24]  I_-1+$MAX/K_(K,1+$R R)$-0,K
[25]  $GO (0$E $R R_(($R K),I)$R (,K$SC.>$I I)\B/R)/0
[26]  B_$I 1$TAK$R R_(R[;1]$E -11$DRPH)/[1]R
[27]  J_$R I_$I I
[28] LS:B_B[$GU68$DCD-1+$TPSH$I R[B;($-J$MIN8)$TAKI]]
[29]  $GO (0$NEJ_$R I_-8$DRPI)/LS
[30]  R_R[B;] $DMD A_A[B;]
[31]  K_$MAX/0,E_(1$DRPB,1+$R C)$-B_C/$I $R C_$OR/R$NE' ',[1]-1 0$DRPR
[32] $COM MAKE RESULT PRINT PRETTY
[33]  H_(31$R 0),481$R 1
[34]  H[$QAV$I '$_$Q$DLT$UDL']_2 2 4 4
[35] LT:G_K$MIN$MIN($QPW$-1+D_$MAX/0,+/H[$QAV$I R])%6
[36]  B_$MAXE%G
[37]  R_(($I +/B)$E +\-1$DRP1,B)$XP1C$RD1R
[38]  I_B/G$MINE
[39]  I[(+\B)]_(G#0=K)+K_G|E
[40]  K_$MAX/0,I
[41]  A_,(($I K#$R I)$E (,(K$-I)$SC.<$I K)/,(K#-1+$I $R I)$SC.+$REV$I K)$XP1A
[42]  A_A[(6#K#-1+$I $R I)$SC.+$I K#6]
[43]  I_D$-+/-1+I_H[$QAV$I R]
[44]  D_($R R)[1] $DMD H_($R A)[2]
[45]  G_I+(-1+$I K[1])#-1$TAKK_$R R_(D,H+$MAX/I)$TAKR
[46]  R_,R
[47]  R[,G$SC.+$I H]_,A
[48]  R_K$R R
    "
 
$COM  $QAV   3    15    20    34    35    43
$COM  $QCR   3
$COM  $QIO   0     2_
$COM  $QNC   4
$COM  $QPW  35
$COM  A      0    20_   21_   21    30_   30]   41_   41    42_   42]   44
$COM        47
$COM  B      0     4     4_   10_   11_   11    11    13    19    19_   21
$COM        23_   25    26_   28_   28]   28    30    30    31    31_   36_
$COM        37    37    38    39
$COM  C      0    15    15_   31    31    31_   37
$COM  D      0    18_   19]   19    35_   43    44_   45
$COM  E      0     6_    7_    7     7     8     8     9]_  13    31_   36
$COM        38    39
$COM  F      0     3_    3     3     4     4     9     9
$COM  G      0    17_   17    17_   19    19    20    20    21    21    35_
$COM        36    38    39    39    45_   47
$COM  H      0    12_   14    16    17    23    26    28    33_   34]_  35]
$COM        43]   44_   45    47
$COM  I      0     8_    9     9     9    14_   15    15    16_   17    17
$COM        22    22    24_   25    25    27_   27    28    29_   29    38_
$COM        39]_  40    41    41    41    42    43_   43_   45    45
$COM  J      0    27_   28    29_
$COM  K      0    19_   21    23_   24_   24    24    25    25    31_   35
$COM        39    39_   40_   41    41    41    41    41    42    42    45]
$COM        45_   48
$COM  LF     3     6:
$COM  LS    28:   29
$COM  LT    35:
$COM  R      0_    3_    5_    6]   10    11    13_   13    13    14    15_
$COM        15    15    15    16    17]   17    18    18    19]   19    19
$COM        19]   20    20    21]   22_   22    23    23    24    25_   25
$COM        26_   26]   26    28]   30_   30]   31    31    35    37_   37
$COM        43    44    45_   45    46_   46    47]_  48_   48
0
 
 
"FUNCLIST;X;$QIO;I;J;n;V;$QPW;s
[1] $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
 $QIO_1$DMD$QPW_300$DMDJ_1$TAK$R X_$QNL 3$DMDI_0$DMDs_3 1$R ' '
 (1 2$R E,35)$QSM 'FUNCLIST'$COM  SIDETRACK ON DEFN ERROR
 V_$XEC')TERM OUTPUT 4'$DMD')TERM INPUT 4'
 L:$GO (J<I_I+1)/xx$DMDs$DMD';''        FUNCTION: ',X[I;],''''$DMD' '$DMD' '
 V_$XEC'"',X[I;],'[$Q]"'
 (~($I ($R V)+$R n)$E ($I $R n)+n_((~$NE\''''=V)&V$E '$E$O$I$R$GO')/$I $R V)\V
 (0$NE1$TAK$R N)/'(',($FMT$R N),'$R',($FMT,N_$QSM X[I;]),')$QSM''',X[I;],''''
 $QPW_73$DMDV_' ',[$QIO]'$COM',' ',' ',XREF X[I;]$DMD$QPW_300$DMDV
 $QVFC '0'$DMD$GO L
 E:'''',X[I;],' *** NOT LISTED ***'''$DMD$QVFC '0'$DMD$GO L
 xx:s
 V_((1$TAK$R V)$TAK'"'),V_($QCR 'FUNCLIST')
 V_(,(((' '$NEV)$MAX.#$I -1$TAK$R V)$SC.$GE$I -1$TAK$R V),1)/,V,$QAV[14]
 (~($I ($R V)+$R n)$E ($I $R n)+n_((~$NE\''''=V)&V$E '$E$O$I$R$GO')/$I $R V)\V
 '"'$DMDs
 '$XEC '')TERM INPUT '',$FMT $QTT'$DMDV_$XEC')TERM OUTPUT ',$FMT$QTT
 '$QLX_''GO'''$DMD'$QPW_80'$DMD')SET INPUT ME'
"
 
 
;'        Function: ERROR '
    " ERROR MSG;I;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO(0$NE $R $QSSS ($QUNSET 1) ',ORG=FORM')/efld
[3]   MSG $DMD $GO 0
[4]  efld:$Q1_26 MSG
[5]   $GO 0
    "
 
APLASCII_'$")<$LE=>]$OR&$NE%,+./0123456789([;#:\-@$DCD$CAP$MIN$E$_"$DLT$I$SC''$Q|$ECD$O*?$R$MAX~$DRP$CUP$W$DSC$TAK$ENC_$LTK$GO$GE$-$DMDABCDEFGHIJKLMNOPQRSTUVWXYZ{$RTK}$'
 
SCREEN_1 7$R        1  1 25 15 64 2 'Input File Info'
SCREEN_SCREEN,[1]   2  3  1 15  0 2 'DIGS Font File:'
SCREEN_SCREEN,[1]   3  3 21 19  0 0 'XG$FONT.:LIBRARY'
SCREEN_SCREEN,[1]   4  3 44 12  0 2 'DIGS Font $NE:'
SCREEN_SCREEN,[1]   5  3 57  5  0 0 (,'1')
SCREEN_SCREEN,[1]   6  4  1 17  0 2 'Display/Generate:'
SCREEN_SCREEN,[1]   7  4 21  1  0 0 (,'G')
SCREEN_SCREEN,[1]   8  6 25 17 64 2 '''Character''istics'
SCREEN_SCREEN,[1]   9  8  1 16  0 2 'Characters/Inch:'
SCREEN_SCREEN,[1]  10  8 21  2  0 0 '10'
SCREEN_SCREEN,[1]  11  8 42 17  0 2 'Stroke Thickness:'
SCREEN_SCREEN,[1]  12  8 60  1  0 0 (,'4')
SCREEN_SCREEN,[1]  13  9  1 19  0 2 'Portrait/Landscape:'
SCREEN_SCREEN,[1]  14  9 21  1  0 0 (,'P')
SCREEN_SCREEN,[1]  15  9 42  9  0 2 'APL Font:'
SCREEN_SCREEN,[1]  16  9 60  1  0 0 (,'N')
SCREEN_SCREEN,[1]  17 10  1 19  0 2 'Proportional (Y/N):'
SCREEN_SCREEN,[1]  18 10 21  1  0 0 (,'N')
SCREEN_SCREEN,[1]  19 12 25 16 64 2 'Output File Info'
SCREEN_SCREEN,[1]  20 14  1 14  0 2 'QMS Font File:'
SCREEN_SCREEN,[1]  21 14 21 19  0 0 '*QMSFONT'
SCREEN_SCREEN,[1]  22 14 44 14  0 2 'QMS Font Name:'
SCREEN_SCREEN,[1]  23 14 60  4  0 0 'test'
SCREEN_SCREEN,[1]  24 15  1 16  0 2 'QMS Font Number:'
SCREEN_SCREEN,[1]  25 15 21  5  0 0 (,'1')
SCREEN_SCREEN,[1]  26 17  1 70  0 2 '                '
QUIET_0
$QPS_-1 -1 0 2
$QLX_'DISPLAY$_SCREEN SCREEN $DMD $XEC'')END'''
$XEC ')TERM INPUT ',$FMT $QTT
$QPW_80
)SET INPUT ME
