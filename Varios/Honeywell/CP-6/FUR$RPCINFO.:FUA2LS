VERSION A02

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:1    
        1        1        /*M* FUR$RPCINFO - stream PMAP server. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3 */
        8        8        /*P*  NAME: FUR$RPCINFO
        9        9              Purpose:
       10       10                    The stream socket version of the port mapper.
       11       11        */
       12       12        /*F*  NAME: FUR$RPCINFO
       13       13              Purpose:
       14       14                    The stream socket version of the port mapper.  Required for the XPS.
       15       15        */
       16       16        /*D*  NAME: FUR$RPCINFO
       17       17              Algorithm:
       18       18                    Hook up with the portmapper socket.  Keep reading from the socket,
       19       19                    for each chunk of data, verify that it's correct, process the
       20       20                    portmapper command (see also FUP$PMAP), and send the appropriate
       21       21                    reply.  Keep reading...
       22       22        */
       23       23
       24       24        FUR$RPCINFO: PROC MAIN;
       25       25        %INCLUDE CP_6;
       26      106            %F$DCB;
       27      163        %INCLUDE CP_6_SUBS;
       28      703        %INCLUDE B$JIT;
       29      993    1   DCL B$JIT$ PTR SYMREF READONLY;
       30      994        %INCLUDE FU_NFSSUBS_C;
       31     1089        %INCLUDE FU_NFS_M;
       32     1604        %INCLUDE FUU_EQU_E;
       33     1629        %INCLUDE XSL_SOCKET_M;
       34     2377
       35     2378            %XSL_SOCKINIT( MAXSOCK=1, NWSOCKS=0, STCLASS=CONSTANT SYMDEF);
       36     2501            %M$DCB( DCBN=M$DS, ASN=FILE, NAME='nfsd:', ACCT=':SYS', FUN=UPDATE,
       37     2502                    SHARE=ALL, ACS=DS5, ORG=RANDOM);
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:2    
       38     2576    1   DCL B$DS5 CONSTANT SYMDEF BIT(36) INIT('000000006010'O);
       39     2577    1   DCL B$DS5$ REDEF B$DS5 PTR;
       40     2578            %FU$NFSDS( NAME=DS, STCLASS="BASED(B$DS5$)");
       41     2608
       42     2609            %FPT_REW( DCB=M$DS, STCLASS=CONSTANT SYMDEF);
       43     2624
       44     2625            %FU$RQSCTX( NAME=RQSCTX, STCLASS=STATIC);
       45     2714
       46     2715
       47     2716    1   DCL FU_PMAPSOCKET SBIN STATIC SYMDEF INIT(-1);
       48     2717    1   DCL FU_PROGNAME(0:2) UBIN CONSTANT SYMDEF INIT(%(PROG_NFS+PROG_SPREAD),
       49     2718    1     %(PROG_MOUNT+PROG_SPREAD), %(PROG_PMAP+PROG_SPREAD));
       50     2719    1   DCL FU_PROGVERS(0:2) UBIN CONSTANT SYMDEF
       51     2720    1     INIT(%VERS_NFS,%VERS_MOUNT,%VERS_PMAP);
       52     2721    1   DCL MAXPROC(0:2) UBIN CONSTANT INIT(17,5,5);
       53     2722        /*%NFSPROC_STATFS, %MNTPROC_EXPORT, %PMAPPROC_CALLIT);*/
       54     2723    1   DCL FU_PORTNUM(0:2) UBIN STATIC SYMDEF INIT(%PORT_NFS,0,%PORT_PMAP);
       55     2724
       56     2725    1   DCL I UBIN;
       57     2726    1   DCL J UBIN;
       58     2727
       59     2728        %EJECT;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:3    
       60     2729        /* EntRefs */
       61     2730
       62     2731    1   DCL XSL$ACCEPT_SRVR ENTRY(3) ALTRET;
       63     2732    1   DCL XSL$CLOSE ENTRY(2) ALTRET;
       64     2733    1   DCL XSL$HTONL ENTRY(2);
       65     2734    1   DCL XSL$READ ENTRY(4) ALTRET;
       66     2735    1   DCL XSL$SOCKINIT ENTRY(1) ALTRET;
       67     2736    1   DCL XSL$WRITE ENTRY(4) ALTRET;
       68     2737
       69     2738        /* Based items */
       70     2739
       71     2740    1   DCL CHAR_ARRAY(0:0) CHAR(1) BASED;
       72     2741    1   DCL B$UBIN UBIN BASED ALIGNED;
       73     2742    1   DCL HIBIT BIT(1) UNAL BASED;
       74     2743    1   DCL HIHALF UBIN(18) UNAL BASED;
       75     2744    1   DCL MAP$ PTR;
       76     2745    1   DCL 1 MAP BASED( MAP$) ALIGNED,
       77     2746    1         2 PROG# UBIN,
       78     2747    1         2 VERS# UBIN,
       79     2748    1         2 PROT# UBIN,
       80     2749    1         2 PORT# UBIN;
       81     2750
       82     2751        %EJECT;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:4    
       83     2752    1      CALL XSL$SOCKINIT( XSL_SOCKINIT);
       84     2753    1      CALL M$REW( FPT_REW);
       85     2754    1      FU_PORTNUM( 1) = DS.MOUNTPORT;
       86     2755    1   NEXT_SSN: ;
       87     2756    1      RQSCTX.LEN = 8;
       88     2757    1      CALL XSL$ACCEPT_SRVR( FU_PMAPSOCKET, RQSCTX.FROMADDR, RQSCTX.LEN)
       89     2758    2      WHENALTRETURN DO;
       90     2759    2         RETURN;
       91     2760    2         END;
       92     2761
       93     2762    1   NEXT_RQS: ;
       94     2763    1      J = 0;
       95     2764    2      DO UNTIL RQSCTX.LEN ~= 0;
       96     2765    2         CALL XSL$READ( I, FU_PMAPSOCKET, ADDR( RQSCTX.LEN)-> CHAR_ARRAY(3), 1);
       97     2766    3         IF I <= 0 THEN DO;                /* Session over - wait for another    */
       98     2767    3   SSN_DONE:CALL XSL$CLOSE( I, FU_PMAPSOCKET);
       99     2768    3            GOTO NEXT_SSN;
      100     2769    3            END;
      101     2770    2         IF J = 0 AND RQSCTX.LEN = 128 THEN RQSCTX.LEN = 0;
      102     2771    2         J = 1;
      103     2772    2         END;
      104     2773
      105     2774    1      I = 0;
      106     2775    2      DO UNTIL I = RQSCTX.LEN;
      107     2776    2         CALL XSL$READ( J, FU_PMAPSOCKET, ADDR( RQSCTX.CALLHDR)-> CHAR_ARRAY(I),
      108     2777    2           RQSCTX.LEN - I);
      109     2778    2         IF J <= 0 THEN GOTO SSN_DONE;
      110     2779    2         I = I + J;
      111     2780    2         END;
      112     2781
      113     2782    1      RQSCTX.PROC# = 0;     /* Make sure program can tell replies from calls     */
      114     2783    1      IF RQSCTX.CALLHDR.TYPE ~= %TYPE_CALL THEN CALL M$XXX; /* I give up         */
      115     2784    1      RQSCTX.CALLHDR.TYPE = %TYPE_REPLY;
      116     2785    2      IF RQSCTX.CALLHDR.RPCVERS ~= %VERS_RPC THEN DO;
      117     2786    2         RQSCTX.REPLYHDR.REJECT_STAT = %RPC_MISMATCH;
      118     2787    2         RQSCTX.REPLYHDR.VERS_LOW = %VERS_RPC;
      119     2788    2         RQSCTX.REPLYHDR.VERS_HIGH = %VERS_RPC;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:5    
      120     2789    2         RQSCTX.LEN = 24;
      121     2790    2   DENY: RQSCTX.REPLYHDR.REPLY_STAT = %MSG_DENIED;
      122     2791    2   REPLY:ADDR( RQSCTX.LEN)-> HIBIT = '1'B;
      123     2792    2         CALL XSL$WRITE( I, FU_PMAPSOCKET, RQSCTX.LEN, 4);
      124     2793    2         ADDR( RQSCTX.LEN)-> HIHALF = 0;
      125     2794    2         CALL XSL$WRITE( I, FU_PMAPSOCKET, RQSCTX.REPLYHDR, RQSCTX.LEN);
      126     2795    2         GOTO NEXT_RQS;
      127     2796    2         END;
      128     2797
      129     2798    2      DO CASE( RQSCTX.CALLHDR.AUTH_CRED.FLAVOR);
      130     2799    2       CASE( %AUTH_SHORT);
      131     2800    2         RQSCTX.REPLYHDR.AUTH_STAT = %AUTH_BADCRED;
      132     2801    2   AUTH_ERROR:
      133     2802    2         RQSCTX.REPLYHDR.REJECT_STAT = %AUTH_ERROR;
      134     2803    2         RQSCTX.LEN = 20;
      135     2804    2         GOTO DENY;
      136     2805
      137     2806    2       CASE( %AUTH_NULL);
      138     2807                                           /* Ensure that both auth's are all zero    */
      139     2808    2         IF RQSCTX.CALLHDR.AUTH_CRED THEN GOTO TOO_WEAK;
      140     2809    2         RQSCTX.BODY$ = ADDR( RQSCTX.CALLHDR.AUTH_VERF);
      141     2810
      142     2811
      143     2812    2       CASE( %AUTH_UNIX);                  /* unix credential                    */
      144     2813    2         RQSCTX.BODY$ = PINCRC( ADDR(RQSCTX.CALLHDR.AUTH_UNIX.STAMP),
      145     2814    2           RQSCTX.CALLHDR.AUTH_UNIX.LEN);
      146     2815    2         IF RQSCTX.BODY$ -> B$UBIN ~= %AUTH_NULL /* Check AUTH_VERF for validity */
      147     2816    2           OR PINCRW( RQSCTX.BODY$, 1) -> B$UBIN ~= 0 THEN GOTO TOO_WEAK;
      148     2817    2         RQSCTX.BODY$ = PINCRW(RQSCTX.BODY$,2);
      149     2818
      150     2819                                                /* rebuild AUTH_CRED in null form     */
      151     2820    2         RQSCTX.CALLHDR.AUTH_CRED.LEN = 0;
      152     2821    2         RQSCTX.CALLHDR.AUTH_CRED.FLAVOR = %AUTH_NULL;
      153     2822
      154     2823    2       CASE( ELSE);
      155     2824    2   TOO_WEAK:
      156     2825    2         RQSCTX.REPLYHDR.AUTH_STAT = %AUTH_TOOWEAK;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:6    
      157     2826    2         GOTO AUTH_ERROR;
      158     2827    2       END;                                /* do case                            */
      159     2828
      160     2829    2      IF RQSCTX.CALLHDR.PROG# ~= FU_PROGNAME( 2) THEN DO;
      161     2830    2         RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %PROG_UNAVAIL;
      162     2831    2         RQSCTX.LEN = 24;
      163     2832    2         END;
      164     2833    2      ELSE IF RQSCTX.CALLHDR.VERS# ~= FU_PROGVERS( 2) THEN DO;
      165     2834    2            RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %PROG_MISMATCH;
      166     2835    2            RQSCTX.REPLYHDR.NA_RESULTS( 0) = %VERS_PMAP;
      167     2836    2            RQSCTX.REPLYHDR.NA_RESULTS( 1) = %VERS_PMAP;
      168     2837    2            RQSCTX.LEN = 32;
      169     2838    2            END;
      170     2839    2         ELSE IF RQSCTX.CALLHDR.PROC# > MAXPROC( 2) THEN DO;
      171     2840    2               RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %PROC_UNAVAIL;
      172     2841    2               RQSCTX.LEN = 24;
      173     2842    2               END;
      174     2843    2            ELSE DO;
      175     2844    2               RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %SUCCESS;
      176     2845    2               RQSCTX.PROC# = RQSCTX.CALLHDR.PROC#;
      177     2846    2               IF RQSCTX.PROC# = 0
      178     2847    2               THEN RQSCTX.LEN = 24;
      179     2848    2               ELSE RQSCTX.LEN = RQSCTX.LEN - POFFC( RQSCTX.BODY$, ADDR( RQSCTX.CALLHDR
              2848                        ));
      180     2849    2               END;
      181     2850    1      RQSCTX.REPLYHDR.AUTH_VERF_FLAVOR = %AUTH_NULL;
      182     2851    1      RQSCTX.REPLYHDR.AUTH_VERF_LEN = 0;
      183     2852    1      RQSCTX.REPLYHDR.REPLY_STAT = %MSG_ACCEPTED;
      184     2853    1      IF I ~= %SUCCESS OR RQSCTX.PROC# = 0 THEN GOTO REPLY;
      185     2854
      186     2855    2      DO CASE( RQSCTX.PROC#);
      187     2856
      188     2857    2       CASE( %PMAPPROC_GETPORT);
      189     2858    2         IF RQSCTX.LEN < 12 THEN GOTO BAD;
      190     2859    2         MAP$ = RQSCTX.BODY$;
      191     2860    3         DO I = 0 TO 2;
      192     2861    3            IF MAP.PROG# = FU_PROGNAME( I)
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:7    
      193     2862    3              AND MAP.VERS# = FU_PROGVERS( I)
      194     2863    4              AND MAP.PROT# = %IPPROTO_UDP THEN DO;
      195     2864    4               CALL XSL$HTONL( RQSCTX.REPLYHDR.NA_RESULT0, FU_PORTNUM( I));
      196     2865    4               GOTO OK;
      197     2866    4               END;
      198     2867    3            END;
      199     2868    2         GOTO BAD;
      200     2869
      201     2870    2       CASE( %PMAPPROC_DUMP);
      202     2871    3         DO I = 0 TO 2;
      203     2872    3            MAP$ = ADDR( RQSCTX.REPLYHDR.NA_RESULTS( I*5+1));
      204     2873    3            RQSCTX.REPLYHDR.NA_RESULTS( I*5) = 1;
      205     2874    3            MAP.PROG# = FU_PROGNAME( I);
      206     2875    3            MAP.VERS# = FU_PROGVERS( I);
      207     2876    3            CALL XSL$HTONL( MAP.PORT#, FU_PORTNUM( I));
      208     2877    3            MAP.PROT# = %IPPROTO_UDP;
      209     2878    3            END;
      210     2879    2         RQSCTX.REPLYHDR.NA_RESULTS( I*5) = 0; /* Terminate the list             */
      211     2880    2         RQSCTX.LEN = 24+64;
      212     2881    2         GOTO OK2;
      213     2882
      214     2883    2       CASE( ELSE);
      215     2884    2   BAD:  RQSCTX.REPLYHDR.NA_RESULT0 = 0; /* Boolean false - we dont do SET/UNSET */
      216     2885    2   OK:   RQSCTX.LEN = 24+4;
      217     2886    2   OK2:  RQSCTX.REPLYHDR.AUTH_VERF_FLAVOR = %AUTH_NULL;
      218     2887    2         RQSCTX.REPLYHDR.AUTH_VERF_LEN = 0;
      219     2888    2         RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %SUCCESS;
      220     2889    2         GOTO REPLY;
      221     2890
      222     2891
      223     2892    2       END;
      224     2893
      225     2894    1   END FUR$RPCINFO;

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:8    
--  Include file information  --

   XSL_SOCKET_M.:LIBRARY  is referenced.
   FUU_EQU_E.:FUA2TOU  is referenced.
   FU_NFS_M.:FUA2TOU  is referenced.
   FU_NFSSUBS_C.:FUA2TOU  is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FUR$RPCINFO.

   Procedure FUR$RPCINFO requires 294 words for executable code.
   Procedure FUR$RPCINFO requires 12 words of local(AUTO) storage.

    No errors detected in file FUR$RPCINFO.:FUA2TSI    .

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:9    

 Object Unit name= FUR$RPCINFO                                File name= FUR$RPCINFO.:FUA2TOU
 UTS= NOV 21 '97 11:35:23.56 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     23     27  FUR$RPCINFO
    2   DCB   even  none    98    142  M$DS
    3   Data  even  none  2075   4033  FUR$RPCINFO
    4   Proc  even  none   294    446  FUR$RPCINFO
    5  RoData even  none    14     16  FUR$RPCINFO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Main       0  FUR$RPCINFO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  XSL_SOCKINIT                       1      6  B$DS5
    1     10  FPT_REW                            3   4027  FU_PMAPSOCKET
    1     16  FU_PROGNAME                        1     21  FU_PROGVERS
    3   4030  FU_PORTNUM
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:10   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XSL$SOCKINIT
 yes     yes           Std       3 XSL$ACCEPT_SRVR
 yes     yes           Std       4 XSL$READ
 yes     yes           Std       4 XSL$WRITE
         yes           Std       2 XSL$HTONL
 yes     yes           Std       2 XSL$CLOSE
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    B$JIT$                                M$DS
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:11   


        1        1        /*M* FUR$RPCINFO - stream PMAP server. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3 */
        8        8        /*P*  NAME: FUR$RPCINFO
        9        9              Purpose:
       10       10                    The stream socket version of the port mapper.
       11       11        */
       12       12        /*F*  NAME: FUR$RPCINFO
       13       13              Purpose:
       14       14                    The stream socket version of the port mapper.  Required for the XPS.
       15       15        */
       16       16        /*D*  NAME: FUR$RPCINFO
       17       17              Algorithm:
       18       18                    Hook up with the portmapper socket.  Keep reading from the socket,
       19       19                    for each chunk of data, verify that it's correct, process the
       20       20                    portmapper command (see also FUP$PMAP), and send the appropriate
       21       21                    reply.  Keep reading...
       22       22        */
       23       23
       24       24        FUR$RPCINFO: PROC MAIN;

     24  4 000000   000000 700200 xent  FUR$RPCINFO  TSX0  ! X66_MAUTO
         4 000001   000014 000000                    ZERO    12,0

       25       25        %INCLUDE CP_6;
       26      106            %F$DCB;
       27      163        %INCLUDE CP_6_SUBS;
       28      703        %INCLUDE B$JIT;
       29      993    1   DCL B$JIT$ PTR SYMREF READONLY;
       30      994        %INCLUDE FU_NFSSUBS_C;
       31     1089        %INCLUDE FU_NFS_M;
       32     1604        %INCLUDE FUU_EQU_E;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:12   
       33     1629        %INCLUDE XSL_SOCKET_M;
       34     2377
       35     2378            %XSL_SOCKINIT( MAXSOCK=1, NWSOCKS=0, STCLASS=CONSTANT SYMDEF);
       36     2501            %M$DCB( DCBN=M$DS, ASN=FILE, NAME='nfsd:', ACCT=':SYS', FUN=UPDATE,
       37     2502                    SHARE=ALL, ACS=DS5, ORG=RANDOM);
       38     2576    1   DCL B$DS5 CONSTANT SYMDEF BIT(36) INIT('000000006010'O);
       39     2577    1   DCL B$DS5$ REDEF B$DS5 PTR;
       40     2578            %FU$NFSDS( NAME=DS, STCLASS="BASED(B$DS5$)");
       41     2608
       42     2609            %FPT_REW( DCB=M$DS, STCLASS=CONSTANT SYMDEF);
       43     2624
       44     2625            %FU$RQSCTX( NAME=RQSCTX, STCLASS=STATIC);
       45     2714
       46     2715
       47     2716    1   DCL FU_PMAPSOCKET SBIN STATIC SYMDEF INIT(-1);
       48     2717    1   DCL FU_PROGNAME(0:2) UBIN CONSTANT SYMDEF INIT(%(PROG_NFS+PROG_SPREAD),
       49     2718    1     %(PROG_MOUNT+PROG_SPREAD), %(PROG_PMAP+PROG_SPREAD));
       50     2719    1   DCL FU_PROGVERS(0:2) UBIN CONSTANT SYMDEF
       51     2720    1     INIT(%VERS_NFS,%VERS_MOUNT,%VERS_PMAP);
       52     2721    1   DCL MAXPROC(0:2) UBIN CONSTANT INIT(17,5,5);
       53     2722        /*%NFSPROC_STATFS, %MNTPROC_EXPORT, %PMAPPROC_CALLIT);*/
       54     2723    1   DCL FU_PORTNUM(0:2) UBIN STATIC SYMDEF INIT(%PORT_NFS,0,%PORT_PMAP);
       55     2724
       56     2725    1   DCL I UBIN;
       57     2726    1   DCL J UBIN;
       58     2727
       59     2728        %EJECT;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:13   
       60     2729        /* EntRefs */
       61     2730
       62     2731    1   DCL XSL$ACCEPT_SRVR ENTRY(3) ALTRET;
       63     2732    1   DCL XSL$CLOSE ENTRY(2) ALTRET;
       64     2733    1   DCL XSL$HTONL ENTRY(2);
       65     2734    1   DCL XSL$READ ENTRY(4) ALTRET;
       66     2735    1   DCL XSL$SOCKINIT ENTRY(1) ALTRET;
       67     2736    1   DCL XSL$WRITE ENTRY(4) ALTRET;
       68     2737
       69     2738        /* Based items */
       70     2739
       71     2740    1   DCL CHAR_ARRAY(0:0) CHAR(1) BASED;
       72     2741    1   DCL B$UBIN UBIN BASED ALIGNED;
       73     2742    1   DCL HIBIT BIT(1) UNAL BASED;
       74     2743    1   DCL HIHALF UBIN(18) UNAL BASED;
       75     2744    1   DCL MAP$ PTR;
       76     2745    1   DCL 1 MAP BASED( MAP$) ALIGNED,
       77     2746    1         2 PROG# UBIN,
       78     2747    1         2 VERS# UBIN,
       79     2748    1         2 PROT# UBIN,
       80     2749    1         2 PORT# UBIN;
       81     2750
       82     2751        %EJECT;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:14   
       83     2752    1      CALL XSL$SOCKINIT( XSL_SOCKINIT);

   2752  4 000002   000000 630400 5                  EPPR0   0
         4 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000004   000000 701000 xent               TSX1    XSL$SOCKINIT
         4 000005   000000 011000                    NOP     0

       84     2753    1      CALL M$REW( FPT_REW);

   2753  4 000006   000010 630400 1                  EPPR0   FPT_REW
         4 000007   040006 713400                    CLIMB   16390
         4 000010   400000 401760                    pmme    nvectors=1

       85     2754    1      FU_PORTNUM( 1) = DS.MOUNTPORT;

   2754  4 000011   000006 470400 1                  LDP0    B$DS5
         4 000012   000000 235100                    LDA     0,,PR0
         4 000013   004031 755000 3                  STA     FU_PORTNUM+1

   2754  4 000014                       NEXT_SSN     null
       86     2755    1   NEXT_SSN: ;
       87     2756    1      RQSCTX.LEN = 8;

   2756  4 000014   000010 235007                    LDA     8,DL
         4 000015   000002 755000 3                  STA     RQSCTX+2

       88     2757    1      CALL XSL$ACCEPT_SRVR( FU_PMAPSOCKET, RQSCTX.FROMADDR, RQSCTX.LEN)

   2757  4 000016   000001 630400 5                  EPPR0   1
         4 000017   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000020   000000 701000 xent               TSX1    XSL$ACCEPT_SRVR
         4 000021   000023 702000 4                  TSX2    s:2759
         4 000022   000024 710000 4                  TRA     NEXT_RQS

       89     2758    2      WHENALTRETURN DO;

       90     2759    2         RETURN;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:15   

   2759  4 000023   000000 702200 xent               TSX2  ! X66_MARET

   2756  4 000024                       NEXT_RQS     null
       91     2760    2         END;
       92     2761
       93     2762    1   NEXT_RQS: ;
       94     2763    1      J = 0;

   2763  4 000024   200004 450100                    STZ     J,,AUTO

       95     2764    2      DO UNTIL RQSCTX.LEN ~= 0;

       96     2765    2         CALL XSL$READ( I, FU_PMAPSOCKET, ADDR( RQSCTX.LEN)-> CHAR_ARRAY(3), 1);

   2765  4 000025   000004 237000 5                  LDAQ    4
         4 000026   200010 757100                    STAQ    MAP$+3,,AUTO
         4 000027   000001 236000 5                  LDQ     1
         4 000030   200007 756100                    STQ     MAP$+2,,AUTO
         4 000031   200003 630500                    EPPR0   I,,AUTO
         4 000032   200006 450500                    STP0    MAP$+1,,AUTO
         4 000033   200006 630500                    EPPR0   MAP$+1,,AUTO
         4 000034   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000035   000000 701000 xent               TSX1    XSL$READ
         4 000036   000000 011000                    NOP     0

       97     2766    3         IF I <= 0 THEN DO;                /* Session over - wait for another    */

   2766  4 000037   200003 235100                    LDA     I,,AUTO
         4 000040   000052 601000 4                  TNZ     s:2770

       98     2767    3   SSN_DONE:CALL XSL$CLOSE( I, FU_PMAPSOCKET);

   2767  4 000041   000001 236000 5     SSN_DONE     LDQ     1
         4 000042   200007 756100                    STQ     MAP$+2,,AUTO
         4 000043   200003 630500                    EPPR0   I,,AUTO
         4 000044   200006 450500                    STP0    MAP$+1,,AUTO
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:16   
         4 000045   200006 630500                    EPPR0   MAP$+1,,AUTO
         4 000046   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000047   000000 701000 xent               TSX1    XSL$CLOSE
         4 000050   000000 011000                    NOP     0

       99     2768    3            GOTO NEXT_SSN;

   2768  4 000051   000014 710000 4                  TRA     NEXT_SSN

      100     2769    3            END;
      101     2770    2         IF J = 0 AND RQSCTX.LEN = 128 THEN RQSCTX.LEN = 0;

   2770  4 000052   200004 236100                    LDQ     J,,AUTO
         4 000053   000060 601000 4                  TNZ     s:2771
         4 000054   000002 235000 3                  LDA     RQSCTX+2
         4 000055   000200 115007                    CMPA    128,DL
         4 000056   000060 601000 4                  TNZ     s:2771

   2770  4 000057   000002 450000 3                  STZ     RQSCTX+2

      102     2771    2         J = 1;

   2771  4 000060   000001 235007                    LDA     1,DL
         4 000061   200004 755100                    STA     J,,AUTO

      103     2772    2         END;

   2772  4 000062   000002 236000 3                  LDQ     RQSCTX+2
         4 000063   000025 600000 4                  TZE     s:2765

      104     2773
      105     2774    1      I = 0;

   2774  4 000064   200003 450100                    STZ     I,,AUTO

      106     2775    2      DO UNTIL I = RQSCTX.LEN;

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:17   
      107     2776    2         CALL XSL$READ( J, FU_PMAPSOCKET, ADDR( RQSCTX.CALLHDR)-> CHAR_ARRAY(I),

   2776  4 000065   000002 236000 3                  LDQ     RQSCTX+2
         4 000066   200003 136100                    SBLQ    I,,AUTO
         4 000067   200006 756100                    STQ     MAP$+1,,AUTO
         4 000070   200006 630500                    EPPR0   MAP$+1,,AUTO
         4 000071   200013 450500                    STP0    MAP$+6,,AUTO
         4 000072   200003 236100                    LDQ     I,,AUTO
         4 000073   000020 736000                    QLS     16
         4 000074   000006 036000 5                  ADLQ    6
         4 000075   200012 756100                    STQ     MAP$+5,,AUTO
         4 000076   000001 236000 5                  LDQ     1
         4 000077   200011 756100                    STQ     MAP$+4,,AUTO
         4 000100   200004 631500                    EPPR1   J,,AUTO
         4 000101   200010 451500                    STP1    MAP$+3,,AUTO
         4 000102   200010 630500                    EPPR0   MAP$+3,,AUTO
         4 000103   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000104   000000 701000 xent               TSX1    XSL$READ
         4 000105   000000 011000                    NOP     0

      108     2777    2           RQSCTX.LEN - I);
      109     2778    2         IF J <= 0 THEN GOTO SSN_DONE;

   2778  4 000106   200004 235100                    LDA     J,,AUTO
         4 000107   000041 600000 4                  TZE     SSN_DONE

      110     2779    2         I = I + J;

   2779  4 000110   200003 236100                    LDQ     I,,AUTO
         4 000111   200004 036100                    ADLQ    J,,AUTO
         4 000112   200003 756100                    STQ     I,,AUTO

      111     2780    2         END;

   2780  4 000113   000002 116000 3                  CMPQ    RQSCTX+2
         4 000114   000065 601000 4                  TNZ     s:2776

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:18   
      112     2781
      113     2782    1      RQSCTX.PROC# = 0;     /* Make sure program can tell replies from calls     */

   2782  4 000115   000005 450000 3                  STZ     RQSCTX+5

      114     2783    1      IF RQSCTX.CALLHDR.TYPE ~= %TYPE_CALL THEN CALL M$XXX; /* I give up         */

   2783  4 000116   000014 235000 3                  LDA     RQSCTX+12
         4 000117   000122 600000 4                  TZE     s:2784

   2783  4 000120   000003 713400                    CLIMB   3
         4 000121   000000 401760                    pmme    nvectors=0

      115     2784    1      RQSCTX.CALLHDR.TYPE = %TYPE_REPLY;

   2784  4 000122   000001 235007                    LDA     1,DL
         4 000123   000014 755000 3                  STA     RQSCTX+12

      116     2785    2      IF RQSCTX.CALLHDR.RPCVERS ~= %VERS_RPC THEN DO;

   2785  4 000124   000015 236000 3                  LDQ     RQSCTX+13
         4 000125   000002 116007                    CMPQ    2,DL
         4 000126   000170 600000 4                  TZE     s:2798

      117     2786    2         RQSCTX.REPLYHDR.REJECT_STAT = %RPC_MISMATCH;

   2786  4 000127   000016 450000 3                  STZ     RQSCTX+14

      118     2787    2         RQSCTX.REPLYHDR.VERS_LOW = %VERS_RPC;

   2787  4 000130   000002 235007                    LDA     2,DL
         4 000131   000017 755000 3                  STA     RQSCTX+15

      119     2788    2         RQSCTX.REPLYHDR.VERS_HIGH = %VERS_RPC;

   2788  4 000132   000020 755000 3                  STA     RQSCTX+16

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:19   
      120     2789    2         RQSCTX.LEN = 24;

   2789  4 000133   000030 235007                    LDA     24,DL
         4 000134   000002 755000 3                  STA     RQSCTX+2

      121     2790    2   DENY: RQSCTX.REPLYHDR.REPLY_STAT = %MSG_DENIED;

   2790  4 000135   000001 235007       DENY         LDA     1,DL
         4 000136   000015 755000 3                  STA     RQSCTX+13

      122     2791    2   REPLY:ADDR( RQSCTX.LEN)-> HIBIT = '1'B;

   2791  4 000137   400000 236003       REPLY        LDQ     -131072,DU
         4 000140   000002 256000 3                  ORSQ    RQSCTX+2

      123     2792    2         CALL XSL$WRITE( I, FU_PMAPSOCKET, RQSCTX.LEN, 4);

   2792  4 000141   000010 237000 5                  LDAQ    8
         4 000142   200010 757100                    STAQ    MAP$+3,,AUTO
         4 000143   000001 236000 5                  LDQ     1
         4 000144   200007 756100                    STQ     MAP$+2,,AUTO
         4 000145   200003 630500                    EPPR0   I,,AUTO
         4 000146   200006 450500                    STP0    MAP$+1,,AUTO
         4 000147   200006 630500                    EPPR0   MAP$+1,,AUTO
         4 000150   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000151   000000 701000 xent               TSX1    XSL$WRITE
         4 000152   000000 011000                    NOP     0

      124     2793    2         ADDR( RQSCTX.LEN)-> HIHALF = 0;

   2793  4 000153   000000 220003                    LDX0    0,DU
         4 000154   000002 740000 3                  STX0    RQSCTX+2

      125     2794    2         CALL XSL$WRITE( I, FU_PMAPSOCKET, RQSCTX.REPLYHDR, RQSCTX.LEN);

   2794  4 000155   000006 237000 5                  LDAQ    6
         4 000156   200010 757100                    STAQ    MAP$+3,,AUTO
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:20   
         4 000157   000001 236000 5                  LDQ     1
         4 000160   200007 756100                    STQ     MAP$+2,,AUTO
         4 000161   200003 630500                    EPPR0   I,,AUTO
         4 000162   200006 450500                    STP0    MAP$+1,,AUTO
         4 000163   200006 630500                    EPPR0   MAP$+1,,AUTO
         4 000164   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000165   000000 701000 xent               TSX1    XSL$WRITE
         4 000166   000000 011000                    NOP     0

      126     2795    2         GOTO NEXT_RQS;

   2795  4 000167   000024 710000 4                  TRA     NEXT_RQS

      127     2796    2         END;
      128     2797
      129     2798    2      DO CASE( RQSCTX.CALLHDR.AUTH_CRED.FLAVOR);

   2798  4 000170   000021 235000 3                  LDA     RQSCTX+17
         4 000171   000003 115007                    CMPA    3,DL
         4 000172   000174 602005 4                  TNC     s:2798+4,AL
         4 000173   000233 710000 4                  TRA     TOO_WEAK
         4 000174   000206 710000 4                  TRA     s:2808
         4 000175   000215 710000 4                  TRA     s:2813
         4 000176   000177 710000 4                  TRA     s:2800

      130     2799    2       CASE( %AUTH_SHORT);

      131     2800    2         RQSCTX.REPLYHDR.AUTH_STAT = %AUTH_BADCRED;

   2800  4 000177   000001 235007                    LDA     1,DL
         4 000200   000017 755000 3                  STA     RQSCTX+15

      132     2801    2   AUTH_ERROR:
      133     2802    2         RQSCTX.REPLYHDR.REJECT_STAT = %AUTH_ERROR;

   2802  4 000201   000001 235007       AUTH_ERROR   LDA     1,DL
         4 000202   000016 755000 3                  STA     RQSCTX+14
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:21   

      134     2803    2         RQSCTX.LEN = 20;

   2803  4 000203   000024 236007                    LDQ     20,DL
         4 000204   000002 756000 3                  STQ     RQSCTX+2

      135     2804    2         GOTO DENY;

   2804  4 000205   000135 710000 4                  TRA     DENY

      136     2805
      137     2806    2       CASE( %AUTH_NULL);

      138     2807                                           /* Ensure that both auth's are all zero    */
      139     2808    2         IF RQSCTX.CALLHDR.AUTH_CRED THEN GOTO TOO_WEAK;

   2808  4 000206   000000 106400                    CMPC    fill='000'O
         4 000207   000021 000020 3                  ADSC9   RQSCTX+17                cn=0,n=16
         4 000210   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         4 000211   000233 601000 4                  TNZ     TOO_WEAK

      140     2809    2         RQSCTX.BODY$ = ADDR( RQSCTX.CALLHDR.AUTH_VERF);

   2809  4 000212   000012 236000 5                  LDQ     10
         4 000213   000003 756000 3                  STQ     RQSCTX+3
         4 000214   000236 710000 4                  TRA     s:2829

      141     2810
      142     2811
      143     2812    2       CASE( %AUTH_UNIX);                  /* unix credential                    */

      144     2813    2         RQSCTX.BODY$ = PINCRC( ADDR(RQSCTX.CALLHDR.AUTH_UNIX.STAMP),

   2813  4 000215   000022 236000 3                  LDQ     RQSCTX+18
         4 000216   000020 736000                    QLS     16
         4 000217   000013 036000 5                  ADLQ    11
         4 000220   000003 756000 3                  STQ     RQSCTX+3
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:22   

      145     2814    2           RQSCTX.CALLHDR.AUTH_UNIX.LEN);
      146     2815    2         IF RQSCTX.BODY$ -> B$UBIN ~= %AUTH_NULL /* Check AUTH_VERF for validity */

   2815  4 000221   000003 470400 3                  LDP0    RQSCTX+3
         4 000222   000000 235100                    LDA     0,,PR0
         4 000223   000233 601000 4                  TNZ     TOO_WEAK
         4 000224   000001 235100                    LDA     1,,PR0
         4 000225   000233 601000 4                  TNZ     TOO_WEAK

      147     2816    2           OR PINCRW( RQSCTX.BODY$, 1) -> B$UBIN ~= 0 THEN GOTO TOO_WEAK;
      148     2817    2         RQSCTX.BODY$ = PINCRW(RQSCTX.BODY$,2);

   2817  4 000226   000002 036003                    ADLQ    2,DU
         4 000227   000003 756000 3                  STQ     RQSCTX+3

      149     2818
      150     2819                                                /* rebuild AUTH_CRED in null form     */
      151     2820    2         RQSCTX.CALLHDR.AUTH_CRED.LEN = 0;

   2820  4 000230   000022 450000 3                  STZ     RQSCTX+18

      152     2821    2         RQSCTX.CALLHDR.AUTH_CRED.FLAVOR = %AUTH_NULL;

   2821  4 000231   000021 450000 3                  STZ     RQSCTX+17
         4 000232   000236 710000 4                  TRA     s:2829

      153     2822
      154     2823    2       CASE( ELSE);

      155     2824    2   TOO_WEAK:
      156     2825    2         RQSCTX.REPLYHDR.AUTH_STAT = %AUTH_TOOWEAK;

   2825  4 000233   000005 235007       TOO_WEAK     LDA     5,DL
         4 000234   000017 755000 3                  STA     RQSCTX+15

      157     2826    2         GOTO AUTH_ERROR;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:23   

   2826  4 000235   000201 710000 4                  TRA     AUTH_ERROR

      158     2827    2       END;                                /* do case                            */

      159     2828
      160     2829    2      IF RQSCTX.CALLHDR.PROG# ~= FU_PROGNAME( 2) THEN DO;

   2829  4 000236   000016 236000 3                  LDQ     RQSCTX+14
         4 000237   000020 116000 1                  CMPQ    FU_PROGNAME+2
         4 000240   000246 600000 4                  TZE     s:2833

      161     2830    2         RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %PROG_UNAVAIL;

   2830  4 000241   000001 235007                    LDA     1,DL
         4 000242   000020 755000 3                  STA     RQSCTX+16

      162     2831    2         RQSCTX.LEN = 24;

   2831  4 000243   000030 235007                    LDA     24,DL
         4 000244   000002 755000 3                  STA     RQSCTX+2

      163     2832    2         END;

   2832  4 000245   000311 710000 4                  TRA     s:2850

      164     2833    2      ELSE IF RQSCTX.CALLHDR.VERS# ~= FU_PROGVERS( 2) THEN DO;

   2833  4 000246   000017 236000 3                  LDQ     RQSCTX+15
         4 000247   000023 116000 1                  CMPQ    FU_PROGVERS+2
         4 000250   000260 600000 4                  TZE     s:2839

      165     2834    2            RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %PROG_MISMATCH;

   2834  4 000251   000002 235007                    LDA     2,DL
         4 000252   000020 755000 3                  STA     RQSCTX+16

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:24   
      166     2835    2            RQSCTX.REPLYHDR.NA_RESULTS( 0) = %VERS_PMAP;

   2835  4 000253   000021 755000 3                  STA     RQSCTX+17

      167     2836    2            RQSCTX.REPLYHDR.NA_RESULTS( 1) = %VERS_PMAP;

   2836  4 000254   000022 755000 3                  STA     RQSCTX+18

      168     2837    2            RQSCTX.LEN = 32;

   2837  4 000255   000040 235007                    LDA     32,DL
         4 000256   000002 755000 3                  STA     RQSCTX+2

      169     2838    2            END;

   2838  4 000257   000311 710000 4                  TRA     s:2850

      170     2839    2         ELSE IF RQSCTX.CALLHDR.PROC# > MAXPROC( 2) THEN DO;

   2839  4 000260   000026 236000 1                  LDQ     MAXPROC+2
         4 000261   000020 116000 3                  CMPQ    RQSCTX+16
         4 000262   000270 603000 4                  TRC     s:2844

      171     2840    2               RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %PROC_UNAVAIL;

   2840  4 000263   000003 235007                    LDA     3,DL
         4 000264   000020 755000 3                  STA     RQSCTX+16

      172     2841    2               RQSCTX.LEN = 24;

   2841  4 000265   000030 235007                    LDA     24,DL
         4 000266   000002 755000 3                  STA     RQSCTX+2

      173     2842    2               END;

   2842  4 000267   000311 710000 4                  TRA     s:2850

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:25   
      174     2843    2            ELSE DO;

      175     2844    2               RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %SUCCESS;

   2844  4 000270   000020 450000 3                  STZ     RQSCTX+16

      176     2845    2               RQSCTX.PROC# = RQSCTX.CALLHDR.PROC#;

   2845  4 000271   000020 235000 3                  LDA     RQSCTX+16
         4 000272   000005 755000 3                  STA     RQSCTX+5

      177     2846    2               IF RQSCTX.PROC# = 0

   2846  4 000273   000277 601000 4                  TNZ     s:2848

      178     2847    2               THEN RQSCTX.LEN = 24;

   2847  4 000274   000030 235007                    LDA     24,DL
         4 000275   000002 755000 3                  STA     RQSCTX+2
         4 000276   000311 710000 4                  TRA     s:2850

      179     2848    2              ELSE RQSCTX.LEN = RQSCTX.LEN - POFFC( RQSCTX.BODY$, ADDR( RQSCTX.CALLHDR
              2848                        ));

   2848  4 000277   000006 236000 5                  LDQ     6
         4 000300   000020 772000                    QRL     16
         4 000301   200006 756100                    STQ     MAP$+1,,AUTO
         4 000302   000003 236000 3                  LDQ     RQSCTX+3
         4 000303   000020 772000                    QRL     16
         4 000304   200006 136100                    SBLQ    MAP$+1,,AUTO
         4 000305   200007 756100                    STQ     MAP$+2,,AUTO
         4 000306   000002 236000 3                  LDQ     RQSCTX+2
         4 000307   200007 136100                    SBLQ    MAP$+2,,AUTO
         4 000310   000002 756000 3                  STQ     RQSCTX+2

      180     2849    2               END;

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:26   
      181     2850    1      RQSCTX.REPLYHDR.AUTH_VERF_FLAVOR = %AUTH_NULL;

   2850  4 000311   000016 450000 3                  STZ     RQSCTX+14

      182     2851    1      RQSCTX.REPLYHDR.AUTH_VERF_LEN = 0;

   2851  4 000312   000017 450000 3                  STZ     RQSCTX+15

      183     2852    1      RQSCTX.REPLYHDR.REPLY_STAT = %MSG_ACCEPTED;

   2852  4 000313   000015 450000 3                  STZ     RQSCTX+13

      184     2853    1      IF I ~= %SUCCESS OR RQSCTX.PROC# = 0 THEN GOTO REPLY;

   2853  4 000314   200003 235100                    LDA     I,,AUTO
         4 000315   000137 601000 4                  TNZ     REPLY
         4 000316   000005 236000 3                  LDQ     RQSCTX+5
         4 000317   000137 600000 4                  TZE     REPLY

      185     2854
      186     2855    2      DO CASE( RQSCTX.PROC#);

   2855  4 000320   000005 116007                    CMPQ    5,DL
         4 000321   000323 602006 4                  TNC     s:2855+3,QL
         4 000322   000437 710000 4                  TRA     BAD
         4 000323   000437 710000 4                  TRA     BAD
         4 000324   000437 710000 4                  TRA     BAD
         4 000325   000437 710000 4                  TRA     BAD
         4 000326   000330 710000 4                  TRA     s:2858
         4 000327   000370 710000 4                  TRA     s:2871

      187     2856
      188     2857    2       CASE( %PMAPPROC_GETPORT);

      189     2858    2         IF RQSCTX.LEN < 12 THEN GOTO BAD;

   2858  4 000330   000002 235000 3                  LDA     RQSCTX+2
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:27   
         4 000331   000014 115007                    CMPA    12,DL
         4 000332   000437 602000 4                  TNC     BAD

      190     2859    2         MAP$ = RQSCTX.BODY$;

   2859  4 000333   000003 236000 3                  LDQ     RQSCTX+3
         4 000334   200005 756100                    STQ     MAP$,,AUTO

      191     2860    3         DO I = 0 TO 2;

   2860  4 000335   200003 450100                    STZ     I,,AUTO

      192     2861    3            IF MAP.PROG# = FU_PROGNAME( I)

   2861  4 000336   200005 470500                    LDP0    MAP$,,AUTO
         4 000337   200003 720100                    LXL0    I,,AUTO
         4 000340   000000 236100                    LDQ     0,,PR0
         4 000341   000016 116010 1                  CMPQ    FU_PROGNAME,X0
         4 000342   000362 601000 4                  TNZ     s:2867
         4 000343   000001 236100                    LDQ     1,,PR0
         4 000344   000021 116010 1                  CMPQ    FU_PROGVERS,X0
         4 000345   000362 601000 4                  TNZ     s:2867
         4 000346   000002 235100                    LDA     2,,PR0
         4 000347   000021 115007                    CMPA    17,DL
         4 000350   000362 601000 4                  TNZ     s:2867

      193     2862    3              AND MAP.VERS# = FU_PROGVERS( I)
      194     2863    4              AND MAP.PROT# = %IPPROTO_UDP THEN DO;

      195     2864    4               CALL XSL$HTONL( RQSCTX.REPLYHDR.NA_RESULT0, FU_PORTNUM( I));

   2864  4 000351   004030 631410 3                  EPPR1   FU_PORTNUM,X0
         4 000352   200007 451500                    STP1    MAP$+2,,AUTO
         4 000353   000014 236000 5                  LDQ     12
         4 000354   200006 756100                    STQ     MAP$+1,,AUTO
         4 000355   200006 630500                    EPPR0   MAP$+1,,AUTO
         4 000356   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:28   
         4 000357   000000 701000 xent               TSX1    XSL$HTONL
         4 000360   000000 011000                    NOP     0

      196     2865    4               GOTO OK;

   2865  4 000361   000440 710000 4                  TRA     OK

      197     2866    4               END;
      198     2867    3            END;

   2867  4 000362   200003 235100                    LDA     I,,AUTO
         4 000363   000001 035007                    ADLA    1,DL
         4 000364   200003 755100                    STA     I,,AUTO
         4 000365   000003 115007                    CMPA    3,DL
         4 000366   000336 602000 4                  TNC     s:2861

      199     2868    2         GOTO BAD;

   2868  4 000367   000437 710000 4                  TRA     BAD

      200     2869
      201     2870    2       CASE( %PMAPPROC_DUMP);

      202     2871    3         DO I = 0 TO 2;

   2871  4 000370   200003 450100                    STZ     I,,AUTO

      203     2872    3            MAP$ = ADDR( RQSCTX.REPLYHDR.NA_RESULTS( I*5+1));

   2872  4 000371   200003 236100                    LDQ     I,,AUTO
         4 000372   000005 402003                    MPY     5,DU
         4 000373   000015 036000 5                  ADLQ    13
         4 000374   200005 756100                    STQ     MAP$,,AUTO

      204     2873    3            RQSCTX.REPLYHDR.NA_RESULTS( I*5) = 1;

   2873  4 000375   200003 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:29   
         4 000376   000005 402007                    MPY     5,DL
         4 000377   000001 235007                    LDA     1,DL
         4 000400   000021 755006 3                  STA     RQSCTX+17,QL

      205     2874    3            MAP.PROG# = FU_PROGNAME( I);

   2874  4 000401   200003 720100                    LXL0    I,,AUTO
         4 000402   200005 470500                    LDP0    MAP$,,AUTO
         4 000403   000016 235010 1                  LDA     FU_PROGNAME,X0
         4 000404   000000 755100                    STA     0,,PR0

      206     2875    3            MAP.VERS# = FU_PROGVERS( I);

   2875  4 000405   200003 720100                    LXL0    I,,AUTO
         4 000406   000021 235010 1                  LDA     FU_PROGVERS,X0
         4 000407   000001 755100                    STA     1,,PR0

      207     2876    3            CALL XSL$HTONL( MAP.PORT#, FU_PORTNUM( I));

   2876  4 000410   200003 720100                    LXL0    I,,AUTO
         4 000411   004030 631410 3                  EPPR1   FU_PORTNUM,X0
         4 000412   200007 451500                    STP1    MAP$+2,,AUTO
         4 000413   200005 236100                    LDQ     MAP$,,AUTO
         4 000414   000003 036003                    ADLQ    3,DU
         4 000415   200006 756100                    STQ     MAP$+1,,AUTO
         4 000416   200006 630500                    EPPR0   MAP$+1,,AUTO
         4 000417   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000420   000000 701000 xent               TSX1    XSL$HTONL
         4 000421   000000 011000                    NOP     0

      208     2877    3            MAP.PROT# = %IPPROTO_UDP;

   2877  4 000422   000021 235007                    LDA     17,DL
         4 000423   200005 470500                    LDP0    MAP$,,AUTO
         4 000424   000002 755100                    STA     2,,PR0

      209     2878    3            END;
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:30   

   2878  4 000425   200003 236100                    LDQ     I,,AUTO
         4 000426   000001 036007                    ADLQ    1,DL
         4 000427   200003 756100                    STQ     I,,AUTO
         4 000430   000003 116007                    CMPQ    3,DL
         4 000431   000371 602000 4                  TNC     s:2872

      210     2879    2         RQSCTX.REPLYHDR.NA_RESULTS( I*5) = 0; /* Terminate the list             */

   2879  4 000432   000005 402007                    MPY     5,DL
         4 000433   000021 450006 3                  STZ     RQSCTX+17,QL

      211     2880    2         RQSCTX.LEN = 24+64;

   2880  4 000434   000130 235007                    LDA     88,DL
         4 000435   000002 755000 3                  STA     RQSCTX+2

      212     2881    2         GOTO OK2;

   2881  4 000436   000442 710000 4                  TRA     OK2

      213     2882
      214     2883    2       CASE( ELSE);

      215     2884    2   BAD:  RQSCTX.REPLYHDR.NA_RESULT0 = 0; /* Boolean false - we dont do SET/UNSET */

   2884  4 000437   000021 450000 3     BAD          STZ     RQSCTX+17

      216     2885    2   OK:   RQSCTX.LEN = 24+4;

   2885  4 000440   000034 235007       OK           LDA     28,DL
         4 000441   000002 755000 3                  STA     RQSCTX+2

      217     2886    2   OK2:  RQSCTX.REPLYHDR.AUTH_VERF_FLAVOR = %AUTH_NULL;

   2886  4 000442   000016 450000 3     OK2          STZ     RQSCTX+14

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:31   
      218     2887    2         RQSCTX.REPLYHDR.AUTH_VERF_LEN = 0;

   2887  4 000443   000017 450000 3                  STZ     RQSCTX+15

      219     2888    2         RQSCTX.REPLYHDR.NA_ACCEPT_STAT = %SUCCESS;

   2888  4 000444   000020 450000 3                  STZ     RQSCTX+16

      220     2889    2         GOTO REPLY;

   2889  4 000445   000137 710000 4                  TRA     REPLY
      221     2890
      222     2891
      223     2892    2       END;
      224     2893
      225     2894    1   END FUR$RPCINFO;

PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:32   
--  Include file information  --

   XSL_SOCKET_M.:LIBRARY  is referenced.
   FUU_EQU_E.:FUA2TOU  is referenced.
   FU_NFS_M.:FUA2TOU  is referenced.
   FU_NFSSUBS_C.:FUA2TOU  is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FUR$RPCINFO.
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:33   

 **** Variables and constants ****

  ****  Section 001 RoData FUR$RPCINFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/b BIT         r     1 B$DS5                      6-0-0/w PTR         r     1 B$DS5$
    10-0-0/d STRC(216)   r     1 FPT_REW
    16-0-0/w UBIN        r     1 FU_PROGNAME(0:2)
    21-0-0/w UBIN        r     1 FU_PROGVERS(0:2)
    24-0-0/w UBIN        r     1 MAXPROC(0:2)
     0-0-0/w STRC(216)   r     1 XSL_SOCKINIT

  ****  Section 003  Data  FUR$RPCINFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  4027-0-0/w SBIN        r     1 FU_PMAPSOCKET
  4030-0-0/w UBIN        r     1 FU_PORTNUM(0:2)
     0-0-0/w STRC(74556) r     1 RQSCTX

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 I                          4-0-0/w UBIN        r     1 J
     5-0-0/w PTR         r     1 MAP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:34   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 B$UBIN
     0-0-0/c CHAR        r     1 CHAR_ARRAY(0:0)
     0-0-0/w STRC(4716)  r     1 DS                         0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/b BIT         r     1 HIBIT                      0-0-0/b UBIN(18)    r     1 HIHALF
     0-0-0/d ASTR(3528)  r     1 M$DS                       0-0-0/w STRC(144)   r     1 MAP


   Procedure FUR$RPCINFO requires 294 words for executable code.
   Procedure FUR$RPCINFO requires 12 words of local(AUTO) storage.

    No errors detected in file FUR$RPCINFO.:FUA2TSI    .
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:35   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:36   
          MINI XREF LISTING

AUTH_ERROR
      2802**LABEL    2826--GOTO
B$DS5
      2576**DCL      2577--REDEF
B$DS5$
      2577**DCL      2592--IMP-PTR  2754>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       811**DCL       811--REDEF
B$JIT.ERR.MID
       718**DCL       718--REDEF
B$JIT.JRESPEAK
       879**DCL       880--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       988**DCL       988--REDEF     989--REDEF
B$JIT.PNR
       892**DCL       892--REDEF
B$JIT.TSLINE
       986**DCL       987--REDEF
B$JIT$
       993**DCL       712--IMP-PTR
B$UBIN
      2741**DCL      2815>>IF       2815>>IF
BAD
      2884**LABEL    2858--GOTO     2868--GOTO
CHAR_ARRAY
      2740**DCL      2765<>CALL     2776<>CALL
DENY
      2790**LABEL    2804--GOTO
DS.MOUNTPORT
      2596**DCL      2754>>ASSIGN
F$DCB.ACTPOS
       139**DCL       139--REDEF
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:37   
F$DCB.ARS#
       113**DCL       113--REDEF
F$DCB.ATTR
       132**DCL       133--REDEF
F$DCB.BORROW
       147**DCL       147--REDEF     147--REDEF     147--REDEF
F$DCB.DCBNAME.L
       161**DCL       161--IMP-SIZ
F$DCB.EOMCHAR#
       117**DCL       117--REDEF
F$DCB.FLDID
       142**DCL       142--REDEF
F$DCB.FORM$
       136**DCL       136--REDEF
F$DCB.FSECT
       152**DCL       152--REDEF
F$DCB.FSN#
       129**DCL       129--REDEF     129--REDEF     130--REDEF
F$DCB.HEADER$
       135**DCL       135--REDEF
F$DCB.IXTNSIZE#
       133**DCL       133--REDEF
F$DCB.LASTSTA$
       122**DCL       122--REDEF
F$DCB.LVL
       148**DCL       148--REDEF
F$DCB.NAME#.C
       123**DCL       123--REDEF
F$DCB.NOEOF
       145**DCL       145--REDEF
F$DCB.NRECS#
       134**DCL       134--REDEF
F$DCB.NRECX
       153**DCL       153--REDEF
F$DCB.OHDR
       145**DCL       145--REDEF
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:38   
F$DCB.ORG#
       128**DCL       128--REDEF
F$DCB.PRECNO
       151**DCL       151--REDEF
F$DCB.RCSZ
       157**DCL       157--REDEF
F$DCB.RES#
       124**DCL       124--REDEF
F$DCB.SETX
       136**DCL       136--REDEF
F$DCB.TAB$
       136**DCL       136--REDEF
F$DCB.TDA
       150**DCL       151--REDEF
F$DCB.WSN#
       124**DCL       124--REDEF
FPT_REW
      2620**DCL      2753<>CALL
FPT_REW.V
      2620**DCL      2620--DCLINIT
FU_PMAPSOCKET
      2716**DCL      2757<>CALL     2765<>CALL     2767<>CALL     2776<>CALL     2792<>CALL     2794<>CALL
FU_PORTNUM
      2723**DCL      2754<<ASSIGN   2864<>CALL     2876<>CALL
FU_PROGNAME
      2717**DCL      2829>>IF       2861>>IF       2874>>ASSIGN
FU_PROGVERS
      2719**DCL      2833>>IF       2861>>IF       2875>>ASSIGN
HIBIT
      2742**DCL      2791<<ASSIGN
HIHALF
      2743**DCL      2793<<ASSIGN
I
      2725**DCL      2765<>CALL     2766>>IF       2767<>CALL     2774<<ASSIGN   2775>>DOUNTIL  2776>>CALL
      2776>>CALL     2779<<ASSIGN   2779>>ASSIGN   2792<>CALL     2794<>CALL     2853>>IF       2860<<DOINDEX
      2861>>IF       2861>>IF       2864>>CALL     2871<<DOINDEX  2872>>ASSIGN   2873>>ASSIGN   2874>>ASSIGN
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:39   
      2875>>ASSIGN   2876>>CALL     2879>>ASSIGN
J
      2726**DCL      2763<<ASSIGN   2770>>IF       2771<<ASSIGN   2776<>CALL     2778>>IF       2779>>ASSIGN
M$DS.ACTPOS
      2544**DCL      2544--REDEF
M$DS.ARS#
      2503**DCL      2503--REDEF
M$DS.ATTR#
      2533**DCL      2533--REDEF    2535--REDEF
M$DS.BORROW
      2555**DCL      2555--REDEF    2555--REDEF    2555--REDEF
M$DS.DCBNAME.L
      2574**DCL      2574--IMP-SIZ
M$DS.EOMCHAR#
      2510**DCL      2511--REDEF
M$DS.FLDID
      2547**DCL      2548--REDEF
M$DS.FORM$
      2539**DCL      2539--REDEF
M$DS.FSECT
      2562**DCL      2562--REDEF
M$DS.FSN#
      2529**DCL      2529--REDEF    2529--REDEF    2530--REDEF
M$DS.HEADER$
      2538**DCL      2539--REDEF
M$DS.IXTNSIZE#
      2535**DCL      2536--REDEF
M$DS.LASTSTA$
      2519**DCL      2519--REDEF
M$DS.LVL
      2556**DCL      2556--REDEF
M$DS.NAME#.C
      2519**DCL      2520--REDEF
M$DS.NOEOF
      2551**DCL      2551--REDEF
M$DS.NRECS#
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:40   
      2536**DCL      2536--REDEF
M$DS.NRECX
      2563**DCL      2563--REDEF
M$DS.OHDR
      2552**DCL      2552--REDEF
M$DS.ORG#
      2527**DCL      2528--REDEF
M$DS.PRECNO
      2560**DCL      2560--REDEF
M$DS.RCSZ
      2568**DCL      2568--REDEF
M$DS.RES#
      2521**DCL      2521--REDEF
M$DS.SETX
      2540**DCL      2540--REDEF
M$DS.TAB$
      2539**DCL      2539--REDEF
M$DS.TDA
      2559**DCL      2560--REDEF
M$DS.WSN#
      2521**DCL      2522--REDEF
M$REW
        37**DCL-ENT  2753--CALL
M$XXX
        46**DCL-ENT  2783--CALL
MAP.PORT#
      2749**DCL      2876<>CALL
MAP.PROG#
      2746**DCL      2861>>IF       2874<<ASSIGN
MAP.PROT#
      2748**DCL      2861>>IF       2877<<ASSIGN
MAP.VERS#
      2747**DCL      2861>>IF       2875<<ASSIGN
MAP$
      2744**DCL      2745--IMP-PTR  2859<<ASSIGN   2861>>IF       2861>>IF       2861>>IF       2872<<ASSIGN
      2874>>ASSIGN   2875>>ASSIGN   2876>>CALL     2877>>ASSIGN
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:41   
MAXPROC
      2721**DCL      2839>>IF
NEXT_RQS
      2756**LABEL    2795--GOTO
NEXT_SSN
      2754**LABEL    2768--GOTO
OK
      2885**LABEL    2865--GOTO
OK2
      2886**LABEL    2881--GOTO
REPLY
      2791**LABEL    2853--GOTO     2889--GOTO
RQSCTX.BODY$
      2643**DCL      2809<<ASSIGN   2813<<ASSIGN   2815>>IF       2815>>IF       2817<<ASSIGN   2817>>ASSIGN
      2848>>ASSIGN   2859>>ASSIGN
RQSCTX.CALLHDR
      2700**DCL      2705--REDEF    2776--CALL     2848--ASSIGN
RQSCTX.CALLHDR.AUTH_CRED
      2702**DCL      2704--REDEF    2808>>IF
RQSCTX.CALLHDR.AUTH_CRED.FLAVOR
      2702**DCL      2798>>DOCASE   2821<<ASSIGN
RQSCTX.CALLHDR.AUTH_CRED.LEN
      2702**DCL      2820<<ASSIGN
RQSCTX.CALLHDR.AUTH_UNIX.LEN
      2704**DCL      2813>>ASSIGN
RQSCTX.CALLHDR.AUTH_UNIX.STAMP
      2704**DCL      2813--ASSIGN
RQSCTX.CALLHDR.AUTH_VERF
      2705**DCL      2809--ASSIGN
RQSCTX.CALLHDR.PROC#
      2701**DCL      2839>>IF       2845>>ASSIGN
RQSCTX.CALLHDR.PROG#
      2701**DCL      2829>>IF
RQSCTX.CALLHDR.RPCVERS
      2701**DCL      2785>>IF
RQSCTX.CALLHDR.TYPE
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:42   
      2700**DCL      2783>>IF       2784<<ASSIGN
RQSCTX.CALLHDR.VERS#
      2701**DCL      2833>>IF
RQSCTX.CALLHDR.XID
      2700**DCL      2700--REDEF
RQSCTX.FROMADDR
      2665**DCL      2757<>CALL
RQSCTX.LEN
      2643**DCL      2756<<ASSIGN   2757<>CALL     2764>>DOUNTIL  2765--CALL     2770>>IF       2770<<ASSIGN
      2775>>DOUNTIL  2776>>CALL     2789<<ASSIGN   2791--ASSIGN   2792<>CALL     2793--ASSIGN   2794<>CALL
      2803<<ASSIGN   2831<<ASSIGN   2837<<ASSIGN   2841<<ASSIGN   2847<<ASSIGN   2848<<ASSIGN   2848>>ASSIGN
      2858>>IF       2880<<ASSIGN   2885<<ASSIGN
RQSCTX.PROC#
      2644**DCL      2782<<ASSIGN   2845<<ASSIGN   2846>>IF       2853>>IF       2855>>DOCASE
RQSCTX.REPLYHDR
      2705**DCL      2794<>CALL
RQSCTX.REPLYHDR.AUTH_STAT
      2707**DCL      2800<<ASSIGN   2825<<ASSIGN
RQSCTX.REPLYHDR.AUTH_VERF_FLAVOR
      2707**DCL      2850<<ASSIGN   2886<<ASSIGN
RQSCTX.REPLYHDR.AUTH_VERF_HID
      2709**DCL      2709--REDEF    2709--REDEF
RQSCTX.REPLYHDR.AUTH_VERF_LEN
      2708**DCL      2851<<ASSIGN   2887<<ASSIGN
RQSCTX.REPLYHDR.NA_ACCEPT_STAT
      2708**DCL      2830<<ASSIGN   2834<<ASSIGN   2840<<ASSIGN   2844<<ASSIGN   2888<<ASSIGN
RQSCTX.REPLYHDR.NA_RESULT0
      2709**DCL      2864<>CALL     2884<<ASSIGN
RQSCTX.REPLYHDR.NA_RESULTS
      2709**DCL      2835<<ASSIGN   2836<<ASSIGN   2872--ASSIGN   2873<<ASSIGN   2879<<ASSIGN
RQSCTX.REPLYHDR.PVERS_HIGH
      2711**DCL      2711--REDEF
RQSCTX.REPLYHDR.PVERS_LOW
      2710**DCL      2710--REDEF    2711--REDEF
RQSCTX.REPLYHDR.REJECT_STAT
      2706**DCL      2706--REDEF    2707--REDEF    2786<<ASSIGN   2802<<ASSIGN
PL6.E3A0      #001=FUR$RPCINFO File=FUR$RPCINFO.:FUA2TSI                         FRI 11/21/97 11:35 Page:43   
RQSCTX.REPLYHDR.REPLY_STAT
      2706**DCL      2790<<ASSIGN   2852<<ASSIGN
RQSCTX.REPLYHDR.VERS_HIGH
      2708**DCL      2708--REDEF    2708--REDEF    2788<<ASSIGN
RQSCTX.REPLYHDR.VERS_LOW
      2707**DCL      2707--REDEF    2708--REDEF    2787<<ASSIGN
SSN_DONE
      2767**LABEL    2778--GOTO
TOO_WEAK
      2825**LABEL    2808--GOTO     2816--GOTO
XSL$ACCEPT_SRVR
      2731**DCL-ENT  2757--CALL
XSL$CLOSE
      2732**DCL-ENT  2767--CALL
XSL$HTONL
      2733**DCL-ENT  2864--CALL     2876--CALL
XSL$READ
      2734**DCL-ENT  2765--CALL     2776--CALL
XSL$SOCKINIT
      2735**DCL-ENT  2752--CALL
XSL$WRITE
      2736**DCL-ENT  2792--CALL     2794--CALL
XSL_SOCKINIT
      2395**DCL      2752<>CALL
