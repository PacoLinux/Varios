VERSION A02

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:1    
        1        1        /*M*    TCM$ALEX2       Part 2 of ALEX routines for NETSEND         */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        TCM$ALEX_CONNECT: PROC(SITEIN, PAR, STATUS, BAILOUT) ALTRET;
        8        8        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        9        9    1   DCL TBUF CHAR(1) STATIC;
       10       10    1   DCL PAR UBIN;
       11       11    1   DCL SITEIN CHAR(8);
       12       12    1   dcl 1 STATUS aligned,
       13       13    1         2 HOST_SHUT bit(1);
       14       14    1   DCL TCM_G_PARITY UBIN STATIC SYMDEF;
       15       15    1   dcl BAILOUT REMEMBER;
       16       16    1   dcl TCM_ALEX_BAILOUT remember static symdef;
       17       17    1   dcl TCM_ALEX_BAILOUT_ENABLED redef TCM_ALEX_BAILOUT bit(72);
       18       18        %INCLUDE CP_6;
       19       99                                                /* Based */
       20      100                                                /**/
       21      101        %F$DCB;
       22      158        %MACRO WRITEUO;
       23      159             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
       24      160                END;
       25      161        %MEND;
       26      162        %INCLUDE B$JIT;
       27      452    1   DCL B$JIT$ PTR SYMREF;
       28      453        %B$TCB;
       29      456        %B$NWIO;
       30      541        %B$CGAUCRD;
       31      604    1   DCL F$CG DCB;
       32      605    1   DCL M$SI DCB;
       33      606    1   DCL F$USER DCB;
       34      607    1   DCL F$UO DCB;
       35      608    1   DCL F$CG$ PTR STATIC SYMDEF;
       36      609    1   DCL F$USER$ PTR STATIC;
       37      610    1   DCL 1 SLOG STATIC,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:2    
       38      611    1         2 LEN UBIN (9) UNAL,
       39      612    1         2 TEXT (0:23) CHAR (1) UNAL;
       40      613    1   dcl TCM_USING_PAD bit(1) static symdef init('0'B);
       41      614    1   DCL TCM_COMMAND BIT(1) STATIC SYMDEF INIT('0'B);
       42      615    1   DCL TCM_EXEC BIT(1) STATIC SYMDEF INIT('0'B);
       43      616    1   DCL TCM_INT BIT(1) STATIC SYMDEF INIT('0'B);
       44      617    1   DCL TCM_LOCAL BIT(1) STATIC SYMDEF INIT('0'B);
       45      618    1   DCL TCM_NEEDREAD BIT(1) STATIC SYMDEF INIT('0'B);
       46      619    1   DCL TCM_LOCALMODE BIT(1) STATIC SYMDEF INIT('0'B);
       47      620    1   dcl TCM_CONNECTED bit(1) static symdef init('0'B);
       48      621    1   DCL TCM_MODEMBUF CHAR(1280) STATIC SYMDEF;
       49      622    1   DCL TCM_MBLEN UBIN STATIC SYMDEF;
       50      623    1   DCL RETRY UBIN STATIC;
       51      624    1   DCL CMDI UBIN STATIC;
       52      625    1   DCL TCM_TIMEOUT UBIN STATIC SYMDEF INIT(0);
       53      626    1   DCL I UBIN STATIC;
       54      627    1   DCL CR CHAR(1) STATIC INIT(BINASC(13));
       55      628    1   DCL LF CHAR(1) STATIC INIT(BINASC(10));
       56      629    1   DCL TCM_SITE CHAR(8) STATIC SYMDEF;
       57      630    1   DCL PHONE CHAR(11) STATIC;
       58      631    1   DCL PNR sbin;
       59      632    1   DCL TCM_PHONE(0:3) CHAR(11) SYMREF;
       60      633        %EQU PHONE300 = %CHARTEXT( 'TCM_PHONE');
       61      634    1   DCL PHONE1200 (0:2) CHAR (11) STATIC;
       62      635    1   DCL LOGON CHAR(31) STATIC;
       63      636    1   DCL 1 LA(0:30) REDEF LOGON,
       64      637    1         2 * BIT(1) UNAL,
       65      638    1         2 P BIT(1) UNAL,
       66      639    1         2 U UBIN(7) UNAL;
       67      640    1   DCL FLAG UBIN STATIC;
       68      641    1   DCL TCM_EPTBLI(0:3) BIT(32) UNAL STATIC SYMDEF INIT('69969669'X,'96696996'X,
               641            '96696996'X,'69969669'X);
       69      642    1   DCL EPTBL(0:127) REDEF TCM_EPTBLI BIT(1) UNAL;
       70      643    1   DCL TCM_OPTBLI(0:3) BIT(32) UNAL STATIC SYMDEF INIT('96696996'X,'69969669'X,
               643            '69969669'X,'96696996'X);
       71      644    1   DCL OPTBL(0:127) REDEF TCM_OPTBLI BIT(1) UNAL;
       72      645    1   DCL EIGHT_VAL UBIN(9) STATIC UNAL;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:3    
       73      646    1   DCL EIGHT_TBL(0:4) UBIN(9) STATIC UNAL INIT(184,56,184,184,56);
       74      647    1   DCL PAREN_VAL UBIN(9) STATIC UNAL;
       75      648    1   DCL PAREN_TBL(0:4) UBIN(9) STATIC UNAL INIT(40,168,40,168,40);
       76      649    1   DCL TCM_STRIPPAR(0:511) UBIN(9) UNAL STATIC SYMDEF;
       77      650    1   DCL TCM_OUTREC CHAR(332) STATIC SYMDEF;
       78      651    1   DCL 1 WARNMES STATIC,
       79      652    1         2 * UBIN(9) UNAL INIT(13),
       80      653    1         2 * UBIN(9) UNAL INIT(7),
       81      654    1         2 * CHAR(0) INIT(
               654             'WARNING, 5 minutes without IO have passed, ALEX will LOG you off in 1 minute.'
               654                  ),
       82      655    1         2 * UBIN(9) UNAL INIT(7),
       83      656    1         2 * UBIN(9) UNAL INIT(13);
       84      657    1   DCL 1 OFFMES STATIC,
       85      658    1         2 * UBIN(9) UNAL INIT(13),
       86      659    1         2 * UBIN(9) UNAL INIT(7),
       87      660    1         2 * CHAR(0) INIT('6 minutes without IO have passed, ALEX logged you off'),
       88      661    1         2 * UBIN(9) UNAL INIT(7),
       89      662    1         2 * UBIN(9) UNAL INIT(13);
       90      663                                                /**/
       91      664                                                /* Fpts */
       92      665                                                /**/
       93      666
       94      667
       95      668
       96      669        %FPT_OPEN (FPTN=OPENCG, STCLASS=CONSTANT,
       97      670                  SCRUB=YES,
       98      671                  DCB=F$CG,
       99      672                  AU=YES,
      100      673                  NAME=CG_NAME,
      101      674                  ACCT=CG_ACCT,
      102      675                  ACCESS=ACC,
      103      676                  ACSVEH=ACV,
      104      677                  ASN=COMGROUP,
      105      678                  SETSTA=OPENSTA,
      106      679                  FUN=CREATE,
      107      680                  IXTNSIZE=200,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:4    
      108      681                  SHARE=ALL,
      109      682                  CTG=YES,
      110      683                  EXIST=OLDFILE);
      111      792
      112      793        %VLP_SETSTA (FPTN=OPENSTA, STCLASS=CONSTANT,
      113      794                  MYSTATION='ALEX');
      114      822
      115      823        %VLP_NAME (FPTN=CG_NAME, STCLASS=CONSTANT,
      116      824                  NAME='ALEXCG');
      117      851
      118      852        %VLP_ACCT (FPTN=CG_ACCT, STCLASS=CONSTANT,
      119      853                  ACCT=':SYSTAC');
      120      866
      121      867        %VLP_ATTR (FPTN=ACC);
      122      881        %VLP_ACCESS (EXEC=YES, ACCT='?', LAST=";");
      123      898
      124      899        %VLP_ATTR (FPTN=ACV);
      125      913        %VLP_ACSVEH (READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
      126      914                     REATTR=YES, AU=YES, TCTL=YES, VEHICLE='ALEX');
      127      931        %VLP_ACSVEH (READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
      128      932                     REATTR=YES, AU=YES, TCTL=YES, VEHICLE='MULSEND');
      129      949        %VLP_ACSVEH (READ=YES, DELR=YES, WNEW=YES, UPD=YES, AURD=YES, VEHICLE='WATSON', LAST
               949            =";");
      130      966
      131      967
      132      968        %FPT_OPEN (FPTN=DELCG, STCLASS=CONSTANT,
      133      969                  SCRUB=YES,
      134      970                  DCB=F$CG,
      135      971                  ASN=FILE,
      136      972                  NAME=CG_NAME,
      137      973                  ACCT=CG_ACCT,
      138      974                  FUN=IN,
      139      975                  SHARE=ALL,
      140      976                  DELETE=YES);
      141     1085
      142     1086        %FPT_OPEN (FPTN=OPENUSER,
      143     1087                  DVFC='@',
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:5    
      144     1088                  DCB=F$USER,
      145     1089                  ORG=TERMINAL,
      146     1090                  FUN=UPDATE,
      147     1091                  ASN=DEVICE);
      148     1200
      149     1201
      150     1202        %FPT_FWCG (FPTN=TCM_DELETEMES, STCLASS="CONSTANT SYMDEF",
      151     1203             DCB=F$CG,
      152     1204             CRITERIA=VLP_CGMA,
      153     1205             DELETE=YES,
      154     1206             SCA=VLP_SCGMA);
      155     1225
      156     1226        %VLP_CGMA (STCLASS=CONSTANT,ORIGIN='?',DEST='?');
      157     1253        %VLP_SCGMA (STCLASS=CONSTANT, ORIGIN=YES,DEST=YES);
      158     1270
      159     1271        %FPT_WRITE (FPTN=TCM_WRITECG, DCB=F$CG, STATION=WRITE_STATION,TRANS=YES,STCLASS=
              1271            "STATIC SYMDEF");
      160     1302    1   DCL TCM_WRITECGBUF CHAR(256) STATIC SYMDEF;
      161     1303
      162     1304        %FPT_WRITE(FPTN=TCM_WRITEUSER, DCB=F$USER,TRANS=YES,BUF=TCM_WRITEUSERBUF,
      163     1305             STCLASS="STATIC SYMDEF");
      164     1336    1   DCL TCM_WRITEUSERBUF CHAR(256) STATIC SYMDEF;
      165     1337    1   DCL CMDBUF CHAR(256) STATIC;
      166     1338    1   DCL CMDBUFLEN UBIN STATIC;
      167     1339
      168     1340
      169     1341        %VLP_STATION (FPTN=WRITE_STATION, STCLASS=STATIC, STATION='MODEM');
      170     1368
      171     1369        %VLP_STATION (FPTN=CMDSTATION, STCLASS=STATIC, STATION='MODEM',
      172     1370                  EOFNONE=YES);
      173     1397
      174     1398        %FPT_TRMISC(FPTN=INHIBIT_OPERATOR_MESSAGES,
      175     1399                    STCLASS=CONSTANT,
      176     1400                    DCB=F$CG,
      177     1401                    STATION=WRITE_STATION,
      178     1402                    ANNOUNCE=NO,
      179     1403                    BROADCAST=NO,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:6    
      180     1404                    SEND=NO);
      181     1425
      182     1426        %FPT_READ (FPTN=TCM_READCMD, STCLASS="CONSTANT SYMDEF",
      183     1427                  DCB=F$CG,
      184     1428                  STATION=CMDSTATION,
      185     1429                  TRANS=YES,
      186     1430                  WAIT=YES,
      187     1431                  BUF=TCM_READCGBUF);
      188     1470
      189     1471
      190     1472        %FPT_READ (FPTN=TCM_READCG, STCLASS="STATIC SYMDEF",
      191     1473                  STATION=CGSTATION,
      192     1474                  TRANS=YES,
      193     1475                  WAIT=NO,
      194     1476                  EVENT=1,
      195     1477                  DCB=F$CG,
      196     1478                  BUF=TCM_READCGBUF);
      197     1517        %FPT_READ (FPTN=READAU, STCLASS=CONSTANT,
      198     1518                  DCB=F$CG,
      199     1519                  WAIT=NO,
      200     1520                  EVENT=1,
      201     1521                  STATION=AUSTATION,
      202     1522                  BUF=TCM_READCGBUF);
      203     1561        %VLP_STATION (FPTN=AUSTATION); /*N* ADD MSGTYP='*?' */
      204     1588        %VLP_STATION (FPTN=CGSTATION, STATION='MODEM');
      205     1615    1   DCL TCM_READCGBUF CHAR(256) STATIC SYMDEF;
      206     1616        %FPT_READ (FPTN=TCM_READCGBIG, STCLASS=CONSTANT,
      207     1617                  DCB=F$CG,
      208     1618                  BUF=BIGTBUF);
      209     1657    1   DCL BIGTBUF CHAR(256) STATIC;
      210     1658    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      211     1659    1   DCL TCM_BLEN UBIN STATIC SYMDEF;
      212     1660
      213     1661        %FPT_CLOSE (FPTN=CLOSELO, STCLASS=CONSTANT,
      214     1662                  DCB=F$UO);
      215     1704
      216     1705        %FPT_CLOSE (FPTN=CLOSECG, STCLASS=CONSTANT, DCB=F$CG, DISP=SAVE);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:7    
      217     1747
      218     1748        %FPT_ACTIVATE (FPTN=TCM_TURNON, STCLASS="CONSTANT SYMDEF",
      219     1749                  TRANS=YES,
      220     1750                  ABTREAD='1'B,
      221     1751                  DCB=F$CG,
      222     1752                  FLUSH=YES,
      223     1753                  STATION=WRITE_STATION);
      224     1776
      225     1777
      226     1778        %FPT_ACTIVATE (FPTN=TCM_TURNOFF, STCLASS="CONSTANT SYMDEF",
      227     1779                  DCB=F$CG,
      228     1780                  DISCONNECT=NO,
      229     1781                  STATION=WRITE_STATION,
      230     1782                  FLUSH=YES);
      231     1805
      232     1806        %FPT_CGCTL (STCLASS=CONSTANT,
      233     1807                  DCB=F$CG,
      234     1808                  CGCP=VLP_CGCP);
      235     1831
      236     1832        %VLP_CGCP (STCLASS=CONSTANT,
      237     1833                  MAXPG=25,
      238     1834                  CONMSG=YES,
      239     1835                  TERMCONAU=NO,
      240     1836                  DCBCONAU=NO,
      241     1837                  TERMCONNAU=NO,
      242     1838                  DCBCONNAU=NO,
      243     1839                  AUDCONDCB=DEACTIVATE,
      244     1840                  AUDCONTERM=DISCONNECT,
      245     1841                  DCBCONLGL=YES,
      246     1842                  TERMCONLGL=YES);
      247     1885
      248     1886        %FPT_CGINFO (FPTN=GET_INFO, STCLASS=CONSTANT,
      249     1887                     DCB=F$CG, STATS=VLR_CGSTATS);
      250     1907
      251     1908        %VLR_CGSTATS (STCLASS=STATIC);
      252     1932
      253     1933        %FPT_EVENT (FPTN=FPT_EVENT, STCLASS=CONSTANT,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:8    
      254     1934                  UENTRY=TCM$ALEX_EVNT);
      255     1948        %FPT_XCON (UENTRY=TCM$ALEX_XCON, PXCON=TCM_XCON$);
      256     1962    1   DCL TCM_XCON$ EPTR STATIC SYMDEF INIT( ENTADDR( NIL));
      257     1963        /*
      258     1964
      259     1965        %FPT_LDEV (fptn=ldevlo, stclass=constant,
      260     1966                  STREAMNAME='LP01');
      261     1967
      262     1968        */
      263     1969        %FPT_WAIT (FPTN=TCM_NORM, UNITS=2, STCLASS="STATIC SYMDEF");
      264     1983        %FPT_WAIT (FPTN=TCM_WAIT1, UNITS=1, STCLASS="STATIC SYMDEF");
      265     1997        %FPT_WAIT (FPTN=TCM_TAKE5, UNITS=5, STCLASS="STATIC SYMDEF");
      266     2011
      267     2012        /*
      268     2013        %FPT_XCON (FPTN=FPT_XCON,STCLASS=CONSTANT,
      269     2014                  UENTRY=VSX$XCON);
      270     2015        */
      271     2016        %FPT_READ (FPTN=READSI, DCB=M$SI,BUF=SIBUF);
      272     2055        %FPT_WRITE (FPTN=TCM_WRITEUO, DCB=F$UO,BUF=TCM_UOBUF,STCLASS="STATIC SYMDEF");
      273     2086    1   DCL SIBUF CHAR(256) STATIC;
      274     2087    1   DCL TCM_UOBUF CHAR(256) STATIC SYMDEF;
      275     2088        %FPT_READ (FPTN=READUSER,DCB=F$USER,BUF=TCM_READUSERBUF,TRANS=YES);
      276     2127    1   DCL TCM_READUSERBUF CHAR(256) STATIC SYMDEF;
      277     2128
      278     2129        %FPT_PROMPT (FPTN=PROMPTUSER,DCB=M$UC, VFC=YES, PROMPT=PCHAR);
      279     2157        %FPT_PROMPT (FPTN=PROMPTCG,DCB=F$CG, VFC=YES, PROMPT=PCHAR,STATION=WRITE_STATION);
      280     2185    1   DCL PCHAR CHAR(1) CONSTANT INIT('@');
      281     2186    1   DCL LCLPROMPT CHAR(0) STATIC INIT('Local:');
      282     2187                                                /**/
      283     2188        %FPT_EOM (FPTN=EOMCG,DCB=F$CG,STATION=WRITE_STATION,TIMEOUT=1,UTYPE=SEC);
      284     2218                                                /* External routines */
      285     2219        %FPT_TRMATTR (STCLASS=CONSTANT,TRMATTR=VLP_TRMATTR);
      286     2244        %VLP_TRMATTR (STCLASS=STATIC);
      287     2282        %FPT_TRMATTR(FPTN=PARITY,TRMATTR=CHECK_PARITY,DCB=F$CG);
      288     2307        %VLP_TRMATTR(FPTN=CHECK_PARITY,STCLASS=STATIC);
      289     2345
      290     2346    1   DCL REMOTE_PROGRAM CHAR(0) CONSTANT INIT(%CONCAT(BITASC('015'O),'REMOTE.DBKPL6',
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:9    
              2346            BITASC('015'O)));
      291     2347    1   DCL TCM$ALEX_EVNT ENTRY ASYNC;
      292     2348    1   dcl TCM$ALEX_DISCONNECT ENTRY ALTRET;
      293     2349    1   DCL KOZINN ENTRY(1) ALTRET;
      294     2350    1   DCL TCM$ALEX_XCON ENTRY ASYNC;
      295     2351    1   dcl TCM$ALEX_OK entry altret;
      296     2352    1   dcl INTRO entry;
      297     2353    1   DCL TCM$ALEX_HANGUP ENTRY ALTRET;
      298     2354    1   DCL TCM$ALEX_GOLOCAL ENTRY ALTRET;
      299     2355                                                /* Start here */
      300     2356                                                /**/
      301     2357    1        STATUS = '0'B;
      302     2358    1        if addr(BAILOUT) = addr(NIL)
      303     2359    1        then TCM_ALEX_BAILOUT_ENABLED = '0'B;
      304     2360    1        else TCM_ALEX_BAILOUT = BAILOUT;
      305     2361    1        TCM_OUTREC=' ';
      306     2362    1        TCM_SITE=SITEIN;
      307     2363    2        DO I=0 TO 3;
      308     2364    3             DO TCM_BLEN=I*128 TO (I+1)*128;
      309     2365    3                  TCM_STRIPPAR(TCM_BLEN)=MOD(TCM_BLEN,128);
      310     2366    3                END;
      311     2367    2           END;
      312     2368        /* Get users parity */
      313     2369    1        EIGHT_VAL=EIGHT_TBL(PAR);
      314     2370    1        TCM_G_PARITY = PAR;
      315     2371    1        PAREN_VAL=PAREN_TBL(PAR);
      316     2372    1        TCM_USING_PAD = '0'B;
      317     2373    1        TCM_CONNECTED = '0'B;
      318     2374    1        CALL M$EVENT(FPT_EVENT);
      319     2375    1        F$CG$=DCBADDR(DCBNUM(F$CG));
      320     2376    1        F$USER$=DCBADDR(DCBNUM(F$USER));
      321     2377        /********************************************************************
      322     2378         **  Tymnet phone numbers updated 05/16/88.  Periodically, it      **
      323     2379         **  would be a good idea to phone into tymnet from a terminal,    **
      324     2380         **  sign on with the id "information", and query the dial-up      **
      325     2381         **  numbers database to ensure that the numbers listed here are   **
      326     2382         **  still current.                                                **
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:10   
      327     2383         ********************************************************************/
      328     2384    1        SLOG.LEN    = 1;
      329     2385    1        SLOG.TEXT(0) = '!';
      330     2386    1        PNR = -1;
      331     2387    1        CALL M$OPEN(OPENUSER);
      332     2388    1   LOOP_THROUGH_NUMBERS:
      333     2389    1        PNR = PNR + 1;
      334     2390    1        if PNR >= lengthc(%PHONE300)/lengthc(%PHONE300(0)) then
      335     2391    2        do;
      336     2392    2             TCM_UOBUF='No more numbers left to try, I give up';
      337     2393                  %WRITEUO;
      338     2397    2             call insert(TCM_OUTREC,0,16,TCM_SITE,'FAILED');
      339     2398    2             if F$CG$ -> F$DCB.FCD# = '1'B
      340     2399    2             then CALL M$CLOSE(CLOSECG);
      341     2400    2             if TCM_ALEX_BAILOUT_ENABLED
      342     2401    2             then unwind to TCM_ALEX_BAILOUT;
      343     2402    2             else altreturn;
      344     2403    2           end;
      345     2404    1        if F$CG$ -> F$DCB.FCD# = '1'B
      346     2405    1        then goto DIAL_NEXT_NUMBER;
      347     2406    1        CALL M$OPEN (OPENCG) ALTRET(BADOPEN);
      348     2407    2        DO WHILE ('0'B);
      349     2408    2   BADOPEN:
      350     2409    2             CALL M$OPEN (DELCG) ALTRET(CANT_CONTINUE); /* Delete bad comgroup */
      351     2410    2             CALL M$OPEN (OPENCG) ALTRET(CANT_CONTINUE); /* Try again */
      352     2411    3             DO WHILE ('0'B);
      353     2412    3   CANT_CONTINUE:
      354     2413    3                  TCM_UOBUF = 'Trouble accessing ALEXCG';
      355     2414                       %WRITEUO;
      356     2418    3                  CALL M$CLOSE (CLOSECG);
      357     2419    3                  if TCM_ALEX_BAILOUT_ENABLED
      358     2420    3                  then unwind to TCM_ALEX_BAILOUT;
      359     2421    3                  else altreturn;
      360     2422    3                END;
      361     2423    2           END;
      362     2424    1        TCM_INT = '0'B;
      363     2425    2        CALL M$FWCG(TCM_DELETEMES) WHENALTRETURN DO;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:11   
      364     2426    2           END;
      365     2427    1        CALL M$CGCTL (FPT_CGCTL);
      366     2428        /* Wait for logon message from device */
      367     2429    1        CALL M$DEACTIVATE(TCM_TURNOFF);    /* Flush anything pending */
      368     2430    1        TCM_MBLEN=0;
      369     2431    1        TCM_COMMAND='1'B;
      370     2432    1        CALL M$READ (READAU);
      371     2433    1        I = 0;
      372     2434    2        do until VLR_CGSTATS.NUMTERMS > 0  or  I = 15;
      373     2435    2             I = I + 1;
      374     2436    2             call M$WAIT(TCM_WAIT1);
      375     2437    2             call M$CGINFO(GET_INFO);
      376     2438    2           end;
      377     2439    2        if VLR_CGSTATS.NUMTERMS > 0 then do;
      378     2440                                                /* For now, assume logon */
      379     2441    2             TCM_CONNECTED = '1'B;
      380     2442    2             CALL M$ACTIVATE(TCM_TURNON);
      381     2443    2             CALL M$WAIT(TCM_WAIT1);
      382     2444    2             CALL M$DEACTIVATE(TCM_TURNOFF); /* Abrt pending read */
      383     2445    2             CALL M$WAIT(TCM_WAIT1);
      384     2446    2             CALL M$ACTIVATE(TCM_TURNON);  /* Now its ready */
      385     2447    2           END;
      386     2448    2        ELSE DO;
      387     2449    2             TCM_UOBUF='Modem device did not connect';
      388     2450                  %WRITEUO;
      389     2454    2             TCM_CONNECTED = '0'B;
      390     2455    2             call TCM$ALEX_DISCONNECT;
      391     2456    2             if TCM_ALEX_BAILOUT_ENABLED
      392     2457    2             then unwind to TCM_ALEX_BAILOUT;
      393     2458    2             else altreturn;
      394     2459    2           END;
      395     2460        /*   Call intro; */
      396     2461    1        CALL M$PROMPT(PROMPTCG);
      397     2462    1        CALL M$EOM(EOMCG);
      398     2463    1        call M$TRMISC(INHIBIT_OPERATOR_MESSAGES);
      399     2464                                                /* Reset modem */
      400     2465    1        CALL M$XCON(FPT_XCON);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:12   
      401     2466    1        CALL CONCAT(TCM_WRITECGBUF,'ATZ',CR);
      402     2467    1        TCM_BLEN=4;
      403     2468    2        CALL TCM$ALEX_OK WHENALTRETURN DO;
      404     2469    2             TCM_UOBUF='Modem does not respond';
      405     2470                  %WRITEUO;
      406     2474    2             CALL TCM$ALEX_HANGUP;
      407     2475    2             CALL M$CLOSE(CLOSECG);
      408     2476    2             if TCM_ALEX_BAILOUT_ENABLED
      409     2477    2             then unwind to TCM_ALEX_BAILOUT;
      410     2478    2             else altreturn;
      411     2479    2           END;
      412     2480    1   MODEMREADY:;
      413     2481    1        CALL M$PROMPT(PROMPTUSER);
      414     2482    1        TCM_LOCALMODE='1'B;
      415     2483    1        SIBUF=' ';
      416     2484        /* Convert logon string to correct parity */
      417     2485    2        DO I=0 TO 31;
      418     2486    3             DO CASE(VLP_TRMATTR.PARITY#);
      419     2487    3               CASE(0,2);                  /* None, even */
      420     2488    3                  LA.P(I)=EPTBL(LA.U(I));
      421     2489    3               CASE(1);                    /* Odd */
      422     2490    3                  LA.P(I)=OPTBL(LA.U(I));
      423     2491    3               CASE(3);                    /* One */
      424     2492    3                  LA.P(I)='1'B;
      425     2493    3               CASE(4);                    /* Zero */
      426     2494    3                  LA.P(I)='0'B;
      427     2495    3               CASE(ELSE);
      428     2496    3               END;                        /* Do case */
      429     2497    2           END;                            /* Do i */
      430     2498    1        TCM_COMMAND='1'B;
      431     2499    1   DIAL_NEXT_NUMBER:
      432     2500    1        PHONE = %PHONE300(PNR);
      433     2501    1        CALL CONCAT (TCM_UOBUF,'Dialing ',PHONE);
      434     2502             %WRITEUO;
      435     2506
      436     2507    1        CALL M$WAIT(TCM_WAIT1);            /* Let atz take effect */
      437     2508    2        IF SLOG.LEN=1 AND SLOG.TEXT(0)='#' THEN DO;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:13   
      438     2509    2             CALL CONCAT(TCM_WRITECGBUF,'ATDT',PHONE,',;C1',CR);
      439     2510    2           END;
      440     2511    1        ELSE CALL CONCAT(TCM_WRITECGBUF,'ATDT',PHONE,CR);
      441     2512    1        CALL INDEX(TCM_BLEN,CR,TCM_WRITECGBUF);
      442     2513    1        TCM_BLEN=TCM_BLEN+1;
      443     2514    1        TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);
      444     2515    1        CALL M$WRITE(TCM_WRITECG);
      445     2516    2        IF SLOG.LEN=1 AND SLOG.TEXT(0)='#' THEN DO;
      446     2517    2             CALL M$WAIT(TCM_TAKE5);
      447     2518    2             CALL M$WAIT(TCM_TAKE5);
      448     2519    2             CALL M$WAIT(TCM_TAKE5);       /* Wait for pickup and logon please */
      449     2520    2             CALL CONCAT(TCM_WRITECGBUF,'ATO',CR);
      450     2521    2             TCM_LOCALMODE='0'B;
      451     2522    2             TCM_BLEN=4;
      452     2523    2             TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);
      453     2524    2             CALL M$WRITE(TCM_WRITECG);    /* Go online */
      454     2525    2           END;
      455     2526        /* Wait for connect message */
      456     2527    1        RETRY=0;
      457     2528    1        TCM_MBLEN=0;
      458     2529    2   RED: DO WHILE(RETRY<10);
      459     2530    2             TCM_INT='0'B;
      460     2531    2             CALL M$READ(TCM_READCG);      /* Look for response*/
      461     2532    2             CALL M$WAIT(TCM_TAKE5);
      462     2533    3             IF TCM_INT THEN DO;
      463     2534    3                  CALL INDEX(I,'NO CARRIER',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN))
      464     2535    4                  whenreturn do;
      465     2536    4                       TCM_UOBUF='No carrier received';
      466     2537                            %WRITEUO;
      467     2541    4                       CALL INSERT(TCM_OUTREC,0,16,TCM_SITE,'NCAR');
      468     2542    4                       goto LOOP_THROUGH_NUMBERS;
      469     2543    4                     END;
      470     2544    3                  call index(I,'MODEM',substr(TCM_MODEMBUF,0,TCM_MBLEN))
      471     2545    4                  whenreturn do;
      472     2546    4                       TCM_UOBUF='Modem reported strange status; resetting.';
      473     2547                            %WRITEUO;
      474     2551    4                       call M$CLOSE(CLOSECG);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:14   
      475     2552    4                       call M$WAIT(TCM_TAKE5);
      476     2553    4                       goto LOOP_THROUGH_NUMBERS;
      477     2554    4                     end;
      478     2555    3                  CALL INDEX(I,'CONNECT',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN))
      479     2556    4                  whenreturn do;
      480     2557    4                       exit RED;
      481     2558    4                     end;
      482     2559    3                END;
      483     2560    2             RETRY=RETRY+1;
      484     2561    2           END;
      485     2562    2        IF RETRY=10 THEN DO;
      486     2563    2             TCM_UOBUF='No response; resetting.';
      487     2564                  %WRITEUO;
      488     2568    2             call M$CLOSE(CLOSECG);
      489     2569    2             call M$WAIT(TCM_TAKE5);
      490     2570    2             goto LOOP_THROUGH_NUMBERS;
      491     2571    2           END;
      492     2572    1        TCM_LOCALMODE='0'B;                /* Modem now in online mode */
      493     2573    1        TCM_MBLEN = 0;
      494     2574    2        IF SLOG.LEN>0 THEN DO;
      495     2575    2             TCM_BLEN=1;
      496     2576    2             TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);
      497     2577    3             DO I=0 TO SLOG.LEN-1;
      498     2578    4                  DO SELECT(SLOG.TEXT(I));
      499     2579    4                       SELECT('"');
      500     2580    4                       TCM_WRITECGBUF=CR;
      501     2581    4                       SELECT('%');
      502     2582    4                       CALL M$WAIT(TCM_WAIT1);
      503     2583    4                       GOTO NOWRITE;
      504     2584    4                       SELECT('&');
      505     2585    4                       GOTO EIGHTS;
      506     2586    4                       SELECT('#');
      507     2587    4                       GOTO NOEIGHTS;
      508     2588    4                       SELECT('!');
      509     2589    4                       TCM_UOBUF='Connection established.';
      510     2590                            %WRITEUO;
      511     2594    4                       GOTO CONPRO;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:15   
      512     2595    4                       SELECT(ELSE);
      513     2596    4                  TCM_WRITECGBUF=SLOG.TEXT(I);
      514     2597    4                     END;                  /* Do select */
      515     2598    3             CALL M$WRITE(TCM_WRITECG);
      516     2599    3   NOWRITE:     END;                       /* Do i */
      517     2600    2           END;                            /* If FLAG>0 */
      518     2601        /* Now type 5 8'S, 1 sec pause between each*/
      519     2602    1   EIGHTS:
      520     2603    1        TCM_UOBUF='Typing 8s';
      521     2604             %WRITEUO;
      522     2608    1        RETRY=0;
      523     2609    1        TCM_MBLEN=0;
      524     2610    2   OKP: DO WHILE(RETRY<8);
      525     2611    2             TCM_BLEN=1;
      526     2612    2             TCM_WRITECG.BUF_=VECTOR(ADDR(EIGHT_VAL)->BUFC);
      527     2613    2             CALL M$WRITE(TCM_WRITECG);
      528     2614    2             TCM_INT='0'B;
      529     2615    2             CALL M$READ(TCM_READCG);      /* Look for response*/
      530     2616    2             CALL M$WAIT(TCM_NORM);
      531     2617    3             IF TCM_INT THEN DO;
      532     2618    3                  CALL INDEX(I,'parenthesis',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN));
      533     2619    3                  IF I<TCM_MBLEN THEN EXIT OKP;
      534     2620    3                  CALL INDEX(I,'PLEASE',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN));
      535     2621    3                  IF I<TCM_MBLEN THEN GOTO LOGN;
      536     2622    3                END;
      537     2623    2             RETRY=RETRY+1;
      538     2624    2           END;
      539     2625    2        IF RETRY=8 THEN DO;
      540     2626    2             TCM_UOBUF='No response to 8s';
      541     2627                  %WRITEUO;
      542     2631    2             CALL INSERT(TCM_OUTREC,0,16,TCM_SITE,'NR8');
      543     2632    2             call TCM$ALEX_DISCONNECT;
      544     2633    2             if TCM_ALEX_BAILOUT_ENABLED
      545     2634    2             then unwind to TCM_ALEX_BAILOUT;
      546     2635    2             else altreturn;
      547     2636    2           END;
      548     2637        /* Type '(' alone */
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:16   
      549     2638    1        TCM_BLEN=1;
      550     2639    1        TCM_WRITECG.BUF_=VECTOR(ADDR(PAREN_VAL)->BUFC);
      551     2640    1        CALL M$WRITE (TCM_WRITECG);
      552     2641    1   NOEIGHTS:
      553     2642    1        CALL M$WAIT(TCM_NORM);
      554     2643        /* Now type logon */
      555     2644    1   LOGN: CALL CONCAT(TCM_WRITECGBUF,LOGON,CR);
      556     2645    1        CALL INDEX(TCM_BLEN,CR,TCM_WRITECGBUF);
      557     2646    1        TCM_BLEN=TCM_BLEN+1;
      558     2647    1        TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);
      559     2648    1        CALL M$WRITE(TCM_WRITECG);
      560     2649    1   CONPRO:
      561     2650    1        TCM_COMMAND='0'B;
      562     2651        /*        Call M$READ (TCM_READCG); */
      563     2652    1        TCM_NEEDREAD='1'B;
      564     2653    1        TCM_LOCAL='0'B;
      565     2654    1        TCM_LOCALMODE='0'B;
      566     2655    1        TCM_EXEC='1'B;
      567     2656    1        CHECK_PARITY.PARITY# = 0;          /* Set to no parity  */
      568     2657    1        CALL M$STRMATTR(PARITY);
      569     2658    1        RETURN;
      570     2659    1   END TCM$ALEX_CONNECT;
      571     2660        %EOD;

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:17   
--  Include file information  --

   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_CONNECT.

   Procedure TCM$ALEX_CONNECT requires 719 words for executable code.
   Procedure TCM$ALEX_CONNECT requires 10 words of local(AUTO) storage.

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:18   

 Object Unit name= TCM$ALEX_CONNECT                           File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:15:33.96 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none  1432   2630  TCM$ALEX_CONNECT
    1   DCB   even  none     0      0  M$UC
    2   DCB   even  none     0      0  F$CG
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  F$USER
    5   DCB   even  none     0      0  F$UO
    6  RoData even  UTS    559   1057  TCM$ALEX_CONNECT
    7   Proc  even  none   719   1317  TCM$ALEX_CONNECT
    8  RoData even  none    14     16  TCM$ALEX_CONNECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes    yes     yes      Std        4  TCM$ALEX_CONNECT
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:19   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      1  TCM_G_PARITY                       0      2  TCM_ALEX_BAILOUT
    0      4  F$CG$                              0     15  TCM_USING_PAD
    0     16  TCM_COMMAND                        0     17  TCM_EXEC
    0     20  TCM_INT                            0     21  TCM_LOCAL
    0     22  TCM_NEEDREAD                       0     23  TCM_LOCALMODE
    0     24  TCM_CONNECTED                      0     25  TCM_MODEMBUF
    0    525  TCM_MBLEN                          0    530  TCM_TIMEOUT
    0    534  TCM_SITE                           0    563  TCM_EPTBLI
    0    567  TCM_OPTBLI                         0    601  TCM_STRIPPAR
    0   1001  TCM_OUTREC                         6    204  TCM_DELETEMES
    0   1276  TCM_WRITECG                        0   1312  TCM_WRITECGBUF
    0   1412  TCM_WRITEUSER                      0   1426  TCM_WRITEUSERBUF
    6    306  TCM_READCMD                        0   1650  TCM_READCG
    0   1706  TCM_READCGBUF                      0   2106  TCM_BLEN
    6    454  TCM_TURNON                         6    474  TCM_TURNOFF
    0   2140  TCM_XCON$                          0   2142  TCM_NORM
    0   2150  TCM_WAIT1                          0   2156  TCM_TAKE5
    0   2202  TCM_WRITEUO                        0   2316  TCM_UOBUF
    0   2434  TCM_READUSERBUF
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:20   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 TCM$ALEX_EVNT
         yes          Async      0 TCM$ALEX_XCON
 yes     yes           Std       0 TCM$ALEX_OK
 yes     yes           Std       0 TCM$ALEX_HANGUP
 yes     yes           Std       0 TCM$ALEX_DISCONNECT
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_AALT
                       nStd      0 X66_INDEX
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$JIT$                                F$CG
     M$SI                                  F$USER                                F$UO
     TCM_PHONE                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:21   


        1        1        /*M*    TCM$ALEX2       Part 2 of ALEX routines for NETSEND         */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        TCM$ALEX_CONNECT: PROC(SITEIN, PAR, STATUS, BAILOUT) ALTRET;

      7  7 000000   000000 700200 xent  TCM$ALEX_CO* TSX0  ! X66_AUTO_4
         7 000001   000012 000004                    ZERO    10,4

        8        8        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        9        9    1   DCL TBUF CHAR(1) STATIC;
       10       10    1   DCL PAR UBIN;
       11       11    1   DCL SITEIN CHAR(8);
       12       12    1   dcl 1 STATUS aligned,
       13       13    1         2 HOST_SHUT bit(1);
       14       14    1   DCL TCM_G_PARITY UBIN STATIC SYMDEF;
       15       15    1   dcl BAILOUT REMEMBER;
       16       16    1   dcl TCM_ALEX_BAILOUT remember static symdef;
       17       17    1   dcl TCM_ALEX_BAILOUT_ENABLED redef TCM_ALEX_BAILOUT bit(72);
       18       18        %INCLUDE CP_6;
       19       99                                                /* Based */
       20      100                                                /**/
       21      101        %F$DCB;
       22      158        %MACRO WRITEUO;
       23      159             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
       24      160                END;
       25      161        %MEND;
       26      162        %INCLUDE B$JIT;
       27      452    1   DCL B$JIT$ PTR SYMREF;
       28      453        %B$TCB;
       29      456        %B$NWIO;
       30      541        %B$CGAUCRD;
       31      604    1   DCL F$CG DCB;
       32      605    1   DCL M$SI DCB;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:22   
       33      606    1   DCL F$USER DCB;
       34      607    1   DCL F$UO DCB;
       35      608    1   DCL F$CG$ PTR STATIC SYMDEF;
       36      609    1   DCL F$USER$ PTR STATIC;
       37      610    1   DCL 1 SLOG STATIC,
       38      611    1         2 LEN UBIN (9) UNAL,
       39      612    1         2 TEXT (0:23) CHAR (1) UNAL;
       40      613    1   dcl TCM_USING_PAD bit(1) static symdef init('0'B);
       41      614    1   DCL TCM_COMMAND BIT(1) STATIC SYMDEF INIT('0'B);
       42      615    1   DCL TCM_EXEC BIT(1) STATIC SYMDEF INIT('0'B);
       43      616    1   DCL TCM_INT BIT(1) STATIC SYMDEF INIT('0'B);
       44      617    1   DCL TCM_LOCAL BIT(1) STATIC SYMDEF INIT('0'B);
       45      618    1   DCL TCM_NEEDREAD BIT(1) STATIC SYMDEF INIT('0'B);
       46      619    1   DCL TCM_LOCALMODE BIT(1) STATIC SYMDEF INIT('0'B);
       47      620    1   dcl TCM_CONNECTED bit(1) static symdef init('0'B);
       48      621    1   DCL TCM_MODEMBUF CHAR(1280) STATIC SYMDEF;
       49      622    1   DCL TCM_MBLEN UBIN STATIC SYMDEF;
       50      623    1   DCL RETRY UBIN STATIC;
       51      624    1   DCL CMDI UBIN STATIC;
       52      625    1   DCL TCM_TIMEOUT UBIN STATIC SYMDEF INIT(0);
       53      626    1   DCL I UBIN STATIC;
       54      627    1   DCL CR CHAR(1) STATIC INIT(BINASC(13));
       55      628    1   DCL LF CHAR(1) STATIC INIT(BINASC(10));
       56      629    1   DCL TCM_SITE CHAR(8) STATIC SYMDEF;
       57      630    1   DCL PHONE CHAR(11) STATIC;
       58      631    1   DCL PNR sbin;
       59      632    1   DCL TCM_PHONE(0:3) CHAR(11) SYMREF;
       60      633        %EQU PHONE300 = %CHARTEXT( 'TCM_PHONE');
       61      634    1   DCL PHONE1200 (0:2) CHAR (11) STATIC;
       62      635    1   DCL LOGON CHAR(31) STATIC;
       63      636    1   DCL 1 LA(0:30) REDEF LOGON,
       64      637    1         2 * BIT(1) UNAL,
       65      638    1         2 P BIT(1) UNAL,
       66      639    1         2 U UBIN(7) UNAL;
       67      640    1   DCL FLAG UBIN STATIC;
       68      641    1   DCL TCM_EPTBLI(0:3) BIT(32) UNAL STATIC SYMDEF INIT('69969669'X,'96696996'X,
               641            '96696996'X,'69969669'X);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:23   
       69      642    1   DCL EPTBL(0:127) REDEF TCM_EPTBLI BIT(1) UNAL;
       70      643    1   DCL TCM_OPTBLI(0:3) BIT(32) UNAL STATIC SYMDEF INIT('96696996'X,'69969669'X,
               643            '69969669'X,'96696996'X);
       71      644    1   DCL OPTBL(0:127) REDEF TCM_OPTBLI BIT(1) UNAL;
       72      645    1   DCL EIGHT_VAL UBIN(9) STATIC UNAL;
       73      646    1   DCL EIGHT_TBL(0:4) UBIN(9) STATIC UNAL INIT(184,56,184,184,56);
       74      647    1   DCL PAREN_VAL UBIN(9) STATIC UNAL;
       75      648    1   DCL PAREN_TBL(0:4) UBIN(9) STATIC UNAL INIT(40,168,40,168,40);
       76      649    1   DCL TCM_STRIPPAR(0:511) UBIN(9) UNAL STATIC SYMDEF;
       77      650    1   DCL TCM_OUTREC CHAR(332) STATIC SYMDEF;
       78      651    1   DCL 1 WARNMES STATIC,
       79      652    1         2 * UBIN(9) UNAL INIT(13),
       80      653    1         2 * UBIN(9) UNAL INIT(7),
       81      654    1         2 * CHAR(0) INIT(
               654            'WARNING, 5 minutes without IO have passed, ALEX will LOG you off in 1 minute.'
               654                  ),
       82      655    1         2 * UBIN(9) UNAL INIT(7),
       83      656    1         2 * UBIN(9) UNAL INIT(13);
       84      657    1   DCL 1 OFFMES STATIC,
       85      658    1         2 * UBIN(9) UNAL INIT(13),
       86      659    1         2 * UBIN(9) UNAL INIT(7),
       87      660    1         2 * CHAR(0) INIT('6 minutes without IO have passed, ALEX logged you off'),
       88      661    1         2 * UBIN(9) UNAL INIT(7),
       89      662    1         2 * UBIN(9) UNAL INIT(13);
       90      663                                                /**/
       91      664                                                /* Fpts */
       92      665                                                /**/
       93      666
       94      667
       95      668
       96      669        %FPT_OPEN (FPTN=OPENCG, STCLASS=CONSTANT,
       97      670                  SCRUB=YES,
       98      671                  DCB=F$CG,
       99      672                  AU=YES,
      100      673                  NAME=CG_NAME,
      101      674                  ACCT=CG_ACCT,
      102      675                  ACCESS=ACC,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:24   
      103      676                  ACSVEH=ACV,
      104      677                  ASN=COMGROUP,
      105      678                  SETSTA=OPENSTA,
      106      679                  FUN=CREATE,
      107      680                  IXTNSIZE=200,
      108      681                  SHARE=ALL,
      109      682                  CTG=YES,
      110      683                  EXIST=OLDFILE);
      111      792
      112      793        %VLP_SETSTA (FPTN=OPENSTA, STCLASS=CONSTANT,
      113      794                  MYSTATION='ALEX');
      114      822
      115      823        %VLP_NAME (FPTN=CG_NAME, STCLASS=CONSTANT,
      116      824                  NAME='ALEXCG');
      117      851
      118      852        %VLP_ACCT (FPTN=CG_ACCT, STCLASS=CONSTANT,
      119      853                  ACCT=':SYSTAC');
      120      866
      121      867        %VLP_ATTR (FPTN=ACC);
      122      881        %VLP_ACCESS (EXEC=YES, ACCT='?', LAST=";");
      123      898
      124      899        %VLP_ATTR (FPTN=ACV);
      125      913        %VLP_ACSVEH (READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
      126      914                     REATTR=YES, AU=YES, TCTL=YES, VEHICLE='ALEX');
      127      931        %VLP_ACSVEH (READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
      128      932                     REATTR=YES, AU=YES, TCTL=YES, VEHICLE='MULSEND');
      129      949       %VLP_ACSVEH (READ=YES, DELR=YES, WNEW=YES, UPD=YES, AURD=YES, VEHICLE='WATSON', LAST
               949            =";");
      130      966
      131      967
      132      968        %FPT_OPEN (FPTN=DELCG, STCLASS=CONSTANT,
      133      969                  SCRUB=YES,
      134      970                  DCB=F$CG,
      135      971                  ASN=FILE,
      136      972                  NAME=CG_NAME,
      137      973                  ACCT=CG_ACCT,
      138      974                  FUN=IN,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:25   
      139      975                  SHARE=ALL,
      140      976                  DELETE=YES);
      141     1085
      142     1086        %FPT_OPEN (FPTN=OPENUSER,
      143     1087                  DVFC='@',
      144     1088                  DCB=F$USER,
      145     1089                  ORG=TERMINAL,
      146     1090                  FUN=UPDATE,
      147     1091                  ASN=DEVICE);
      148     1200
      149     1201
      150     1202        %FPT_FWCG (FPTN=TCM_DELETEMES, STCLASS="CONSTANT SYMDEF",
      151     1203             DCB=F$CG,
      152     1204             CRITERIA=VLP_CGMA,
      153     1205             DELETE=YES,
      154     1206             SCA=VLP_SCGMA);
      155     1225
      156     1226        %VLP_CGMA (STCLASS=CONSTANT,ORIGIN='?',DEST='?');
      157     1253        %VLP_SCGMA (STCLASS=CONSTANT, ORIGIN=YES,DEST=YES);
      158     1270
      159     1271        %FPT_WRITE (FPTN=TCM_WRITECG, DCB=F$CG, STATION=WRITE_STATION,TRANS=YES,STCLASS=
              1271            "STATIC SYMDEF");
      160     1302    1   DCL TCM_WRITECGBUF CHAR(256) STATIC SYMDEF;
      161     1303
      162     1304        %FPT_WRITE(FPTN=TCM_WRITEUSER, DCB=F$USER,TRANS=YES,BUF=TCM_WRITEUSERBUF,
      163     1305             STCLASS="STATIC SYMDEF");
      164     1336    1   DCL TCM_WRITEUSERBUF CHAR(256) STATIC SYMDEF;
      165     1337    1   DCL CMDBUF CHAR(256) STATIC;
      166     1338    1   DCL CMDBUFLEN UBIN STATIC;
      167     1339
      168     1340
      169     1341        %VLP_STATION (FPTN=WRITE_STATION, STCLASS=STATIC, STATION='MODEM');
      170     1368
      171     1369        %VLP_STATION (FPTN=CMDSTATION, STCLASS=STATIC, STATION='MODEM',
      172     1370                  EOFNONE=YES);
      173     1397
      174     1398        %FPT_TRMISC(FPTN=INHIBIT_OPERATOR_MESSAGES,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:26   
      175     1399                    STCLASS=CONSTANT,
      176     1400                    DCB=F$CG,
      177     1401                    STATION=WRITE_STATION,
      178     1402                    ANNOUNCE=NO,
      179     1403                    BROADCAST=NO,
      180     1404                    SEND=NO);
      181     1425
      182     1426        %FPT_READ (FPTN=TCM_READCMD, STCLASS="CONSTANT SYMDEF",
      183     1427                  DCB=F$CG,
      184     1428                  STATION=CMDSTATION,
      185     1429                  TRANS=YES,
      186     1430                  WAIT=YES,
      187     1431                  BUF=TCM_READCGBUF);
      188     1470
      189     1471
      190     1472        %FPT_READ (FPTN=TCM_READCG, STCLASS="STATIC SYMDEF",
      191     1473                  STATION=CGSTATION,
      192     1474                  TRANS=YES,
      193     1475                  WAIT=NO,
      194     1476                  EVENT=1,
      195     1477                  DCB=F$CG,
      196     1478                  BUF=TCM_READCGBUF);
      197     1517        %FPT_READ (FPTN=READAU, STCLASS=CONSTANT,
      198     1518                  DCB=F$CG,
      199     1519                  WAIT=NO,
      200     1520                  EVENT=1,
      201     1521                  STATION=AUSTATION,
      202     1522                  BUF=TCM_READCGBUF);
      203     1561        %VLP_STATION (FPTN=AUSTATION); /*N* ADD MSGTYP='*?' */
      204     1588        %VLP_STATION (FPTN=CGSTATION, STATION='MODEM');
      205     1615    1   DCL TCM_READCGBUF CHAR(256) STATIC SYMDEF;
      206     1616        %FPT_READ (FPTN=TCM_READCGBIG, STCLASS=CONSTANT,
      207     1617                  DCB=F$CG,
      208     1618                  BUF=BIGTBUF);
      209     1657    1   DCL BIGTBUF CHAR(256) STATIC;
      210     1658    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      211     1659    1   DCL TCM_BLEN UBIN STATIC SYMDEF;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:27   
      212     1660
      213     1661        %FPT_CLOSE (FPTN=CLOSELO, STCLASS=CONSTANT,
      214     1662                  DCB=F$UO);
      215     1704
      216     1705        %FPT_CLOSE (FPTN=CLOSECG, STCLASS=CONSTANT, DCB=F$CG, DISP=SAVE);
      217     1747
      218     1748        %FPT_ACTIVATE (FPTN=TCM_TURNON, STCLASS="CONSTANT SYMDEF",
      219     1749                  TRANS=YES,
      220     1750                  ABTREAD='1'B,
      221     1751                  DCB=F$CG,
      222     1752                  FLUSH=YES,
      223     1753                  STATION=WRITE_STATION);
      224     1776
      225     1777
      226     1778        %FPT_ACTIVATE (FPTN=TCM_TURNOFF, STCLASS="CONSTANT SYMDEF",
      227     1779                  DCB=F$CG,
      228     1780                  DISCONNECT=NO,
      229     1781                  STATION=WRITE_STATION,
      230     1782                  FLUSH=YES);
      231     1805
      232     1806        %FPT_CGCTL (STCLASS=CONSTANT,
      233     1807                  DCB=F$CG,
      234     1808                  CGCP=VLP_CGCP);
      235     1831
      236     1832        %VLP_CGCP (STCLASS=CONSTANT,
      237     1833                  MAXPG=25,
      238     1834                  CONMSG=YES,
      239     1835                  TERMCONAU=NO,
      240     1836                  DCBCONAU=NO,
      241     1837                  TERMCONNAU=NO,
      242     1838                  DCBCONNAU=NO,
      243     1839                  AUDCONDCB=DEACTIVATE,
      244     1840                  AUDCONTERM=DISCONNECT,
      245     1841                  DCBCONLGL=YES,
      246     1842                  TERMCONLGL=YES);
      247     1885
      248     1886        %FPT_CGINFO (FPTN=GET_INFO, STCLASS=CONSTANT,
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:28   
      249     1887                     DCB=F$CG, STATS=VLR_CGSTATS);
      250     1907
      251     1908        %VLR_CGSTATS (STCLASS=STATIC);
      252     1932
      253     1933        %FPT_EVENT (FPTN=FPT_EVENT, STCLASS=CONSTANT,
      254     1934                  UENTRY=TCM$ALEX_EVNT);
      255     1948        %FPT_XCON (UENTRY=TCM$ALEX_XCON, PXCON=TCM_XCON$);
      256     1962    1   DCL TCM_XCON$ EPTR STATIC SYMDEF INIT( ENTADDR( NIL));
      257     1963        /*
      258     1964
      259     1965        %FPT_LDEV (fptn=ldevlo, stclass=constant,
      260     1966                  STREAMNAME='LP01');
      261     1967
      262     1968        */
      263     1969        %FPT_WAIT (FPTN=TCM_NORM, UNITS=2, STCLASS="STATIC SYMDEF");
      264     1983        %FPT_WAIT (FPTN=TCM_WAIT1, UNITS=1, STCLASS="STATIC SYMDEF");
      265     1997        %FPT_WAIT (FPTN=TCM_TAKE5, UNITS=5, STCLASS="STATIC SYMDEF");
      266     2011
      267     2012        /*
      268     2013        %FPT_XCON (FPTN=FPT_XCON,STCLASS=CONSTANT,
      269     2014                  UENTRY=VSX$XCON);
      270     2015        */
      271     2016        %FPT_READ (FPTN=READSI, DCB=M$SI,BUF=SIBUF);
      272     2055        %FPT_WRITE (FPTN=TCM_WRITEUO, DCB=F$UO,BUF=TCM_UOBUF,STCLASS="STATIC SYMDEF");
      273     2086    1   DCL SIBUF CHAR(256) STATIC;
      274     2087    1   DCL TCM_UOBUF CHAR(256) STATIC SYMDEF;
      275     2088        %FPT_READ (FPTN=READUSER,DCB=F$USER,BUF=TCM_READUSERBUF,TRANS=YES);
      276     2127    1   DCL TCM_READUSERBUF CHAR(256) STATIC SYMDEF;
      277     2128
      278     2129        %FPT_PROMPT (FPTN=PROMPTUSER,DCB=M$UC, VFC=YES, PROMPT=PCHAR);
      279     2157        %FPT_PROMPT (FPTN=PROMPTCG,DCB=F$CG, VFC=YES, PROMPT=PCHAR,STATION=WRITE_STATION);
      280     2185    1   DCL PCHAR CHAR(1) CONSTANT INIT('@');
      281     2186    1   DCL LCLPROMPT CHAR(0) STATIC INIT('Local:');
      282     2187                                                /**/
      283     2188        %FPT_EOM (FPTN=EOMCG,DCB=F$CG,STATION=WRITE_STATION,TIMEOUT=1,UTYPE=SEC);
      284     2218                                                /* External routines */
      285     2219        %FPT_TRMATTR (STCLASS=CONSTANT,TRMATTR=VLP_TRMATTR);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:29   
      286     2244        %VLP_TRMATTR (STCLASS=STATIC);
      287     2282        %FPT_TRMATTR(FPTN=PARITY,TRMATTR=CHECK_PARITY,DCB=F$CG);
      288     2307        %VLP_TRMATTR(FPTN=CHECK_PARITY,STCLASS=STATIC);
      289     2345
      290     2346    1   DCL REMOTE_PROGRAM CHAR(0) CONSTANT INIT(%CONCAT(BITASC('015'O),'REMOTE.DBKPL6',
              2346            BITASC('015'O)));
      291     2347    1   DCL TCM$ALEX_EVNT ENTRY ASYNC;
      292     2348    1   dcl TCM$ALEX_DISCONNECT ENTRY ALTRET;
      293     2349    1   DCL KOZINN ENTRY(1) ALTRET;
      294     2350    1   DCL TCM$ALEX_XCON ENTRY ASYNC;
      295     2351    1   dcl TCM$ALEX_OK entry altret;
      296     2352    1   dcl INTRO entry;
      297     2353    1   DCL TCM$ALEX_HANGUP ENTRY ALTRET;
      298     2354    1   DCL TCM$ALEX_GOLOCAL ENTRY ALTRET;
      299     2355                                                /* Start here */
      300     2356                                                /**/
      301     2357    1        STATUS = '0'B;

   2357  7 000002   200005 470500                    LDP0    @STATUS,,AUTO
         7 000003   000000 450100                    STZ     0,,PR0

      302     2358    1        if addr(BAILOUT) = addr(NIL)

   2358  7 000004   200006 236100                    LDQ     @BAILOUT,,AUTO
         7 000005   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000006   000013 601000 7                  TNZ     s:2360

      303     2359    1        then TCM_ALEX_BAILOUT_ENABLED = '0'B;

   2359  7 000007   000000 235003                    LDA     0,DU
         7 000010   000000 236003                    LDQ     0,DU
         7 000011   000002 757000 0                  STAQ    TCM_ALEX_BAILOUT
         7 000012   000016 710000 7                  TRA     s:2361

      304     2360    1        else TCM_ALEX_BAILOUT = BAILOUT;

   2360  7 000013   200006 471500                    LDP1    @BAILOUT,,AUTO
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:30   
         7 000014   100000 237100                    LDAQ    0,,PR1
         7 000015   000002 757000 0                  STAQ    TCM_ALEX_BAILOUT

      305     2361    1        TCM_OUTREC=' ';

   2361  7 000016   040000 100400                    MLR     fill='040'O
         7 000017   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 000020   001001 000514 0                  ADSC9   TCM_OUTREC               cn=0,n=332

      306     2362    1        TCM_SITE=SITEIN;

   2362  7 000021   200003 471500                    LDP1    @SITEIN,,AUTO
         7 000022   040000 100500                    MLR     fill='040'O
         7 000023   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         7 000024   000534 000010 0                  ADSC9   TCM_SITE                 cn=0,n=8

      307     2363    2        DO I=0 TO 3;

   2363  7 000025   000531 450000 0                  STZ     I

      308     2364    3             DO TCM_BLEN=I*128 TO (I+1)*128;

   2364  7 000026   000531 235000 0                  LDA     I
         7 000027   000007 735000                    ALS     7
         7 000030   002106 755000 0                  STA     TCM_BLEN
         7 000031   000044 710000 7                  TRA     s:2366+3

      309     2365    3                  TCM_STRIPPAR(TCM_BLEN)=MOD(TCM_BLEN,128);

   2365  7 000032   002106 236000 0                  LDQ     TCM_BLEN
         7 000033   000177 376007                    ANQ     127,DL
         7 000034   200010 756100                    STQ     PNR+1,,AUTO
         7 000035   002106 235000 0                  LDA     TCM_BLEN
         7 000036   000005 101500                    MRL     fill='000'O
         7 000037   200010 000004                    ADSC9   PNR+1,,AUTO              cn=0,n=4
         7 000040   000601 000001 0                  ADSC9   TCM_STRIPPAR,A           cn=0,n=1

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:31   
      310     2366    3                END;

   2366  7 000041   002106 235000 0                  LDA     TCM_BLEN
         7 000042   000001 035007                    ADLA    1,DL
         7 000043   002106 755000 0                  STA     TCM_BLEN
         7 000044   000531 236000 0                  LDQ     I
         7 000045   000007 736000                    QLS     7
         7 000046   000200 036007                    ADLQ    128,DL
         7 000047   002106 116000 0                  CMPQ    TCM_BLEN
         7 000050   000032 603000 7                  TRC     s:2365

      311     2367    2           END;

   2367  7 000051   000531 235000 0                  LDA     I
         7 000052   000001 035007                    ADLA    1,DL
         7 000053   000531 755000 0                  STA     I
         7 000054   000004 115007                    CMPA    4,DL
         7 000055   000026 602000 7                  TNC     s:2364

      312     2368        /* Get users parity */
      313     2369    1        EIGHT_VAL=EIGHT_TBL(PAR);

   2369  7 000056   200004 470500                    LDP0    @PAR,,AUTO
         7 000057   000000 235100                    LDA     0,,PR0
         7 000060   000000 100405                    MLR     fill='000'O
         7 000061   000574 000001 0                  ADSC9   EIGHT_TBL,A              cn=0,n=1
         7 000062   000573 000001 0                  ADSC9   EIGHT_VAL                cn=0,n=1

      314     2370    1        TCM_G_PARITY = PAR;

   2370  7 000063   000000 235100                    LDA     0,,PR0
         7 000064   000001 755000 0                  STA     TCM_G_PARITY

      315     2371    1        PAREN_VAL=PAREN_TBL(PAR);

   2371  7 000065   000000 235100                    LDA     0,,PR0
         7 000066   000000 100405                    MLR     fill='000'O
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:32   
         7 000067   000577 000001 0                  ADSC9   PAREN_TBL,A              cn=0,n=1
         7 000070   000576 000001 0                  ADSC9   PAREN_VAL                cn=0,n=1

      316     2372    1        TCM_USING_PAD = '0'B;

   2372  7 000071   000015 450000 0                  STZ     TCM_USING_PAD

      317     2373    1        TCM_CONNECTED = '0'B;

   2373  7 000072   000024 450000 0                  STZ     TCM_CONNECTED

      318     2374    1        CALL M$EVENT(FPT_EVENT);

   2374  7 000073   000706 630400 6                  EPPR0   FPT_EVENT
         7 000074   010001 713400                    CLIMB   4097
         7 000075   400000 401760                    pmme    nvectors=1

      319     2375    1        F$CG$=DCBADDR(DCBNUM(F$CG));

   2375  7 000076   000000 236007 xsym               LDQ     F$CG,DL
         7 000077   000000 470400 8                  LDP0    0
         7 000100   000000 471500                    LDP1    0,,PR0
         7 000101   100000 236106                    LDQ     0,QL,PR1
         7 000102   000004 756000 0                  STQ     F$CG$

      320     2376    1        F$USER$=DCBADDR(DCBNUM(F$USER));

   2376  7 000103   000000 236007 xsym               LDQ     F$USER,DL
         7 000104   100000 236106                    LDQ     0,QL,PR1
         7 000105   000005 756000 0                  STQ     F$USER$

      321     2377        /********************************************************************
      322     2378         **  Tymnet phone numbers updated 05/16/88.  Periodically, it      **
      323     2379         **  would be a good idea to phone into tymnet from a terminal,    **
      324     2380         **  sign on with the id "information", and query the dial-up      **
      325     2381         **  numbers database to ensure that the numbers listed here are   **
      326     2382         **  still current.                                                **
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:33   
      327     2383         ********************************************************************/
      328     2384    1        SLOG.LEN    = 1;

   2384  7 000106   001000 236003                    LDQ     512,DU
         7 000107   000006 552040 0                  STBQ    SLOG,'40'O

      329     2385    1        SLOG.TEXT(0) = '!';

   2385  7 000110   000041 236003                    LDQ     33,DU
         7 000111   000006 552020 0                  STBQ    SLOG,'20'O

      330     2386    1        PNR = -1;

   2386  7 000112   000001 335007                    LCA     1,DL
         7 000113   200007 755100                    STA     PNR,,AUTO

      331     2387    1        CALL M$OPEN(OPENUSER);

   2387  7 000114   001204 630400 0                  EPPR0   OPENUSER
         7 000115   050000 713400                    CLIMB   open
         7 000116   410400 401760                    pmme    nvectors=18

      332     2388    1   LOOP_THROUGH_NUMBERS:
      333     2389    1        PNR = PNR + 1;

   2389  7 000117   200007 054100       LOOP_THROUG* AOS     PNR,,AUTO

      334     2390    1        if PNR >= lengthc(%PHONE300)/lengthc(%PHONE300(0)) then

   2390  7 000120   200007 235100                    LDA     PNR,,AUTO
         7 000121   000004 115007                    CMPA    4,DL
         7 000122   000157 604000 7                  TMI     s:2404

      335     2391    2        do;

      336     2392    2             TCM_UOBUF='No more numbers left to try, I give up';

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:34   
   2392  7 000123   040000 100400                    MLR     fill='040'O
         7 000124   000730 000046 6                  ADSC9   FPT_TRMATTR+12           cn=0,n=38
         7 000125   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      337     2393                  %WRITEUO;

   2394  7 000126   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 000127   440001 713400                    CLIMB   alt,write
         7 000130   401400 401760                    pmme    nvectors=4
         7 000131   000133 702000 7                  TSX2    s:2397
         7 000132   000133 710000 7                  TRA     s:2397

      338     2397    2             call insert(TCM_OUTREC,0,16,TCM_SITE,'FAILED');

   2397  7 000133   000534 237000 0                  LDAQ    TCM_SITE
         7 000134   001001 755000 0                  STA     TCM_OUTREC
         7 000135   001002 756000 0                  STQ     TCM_OUTREC+1
         7 000136   040000 100400                    MLR     fill='040'O
         7 000137   000742 000006 6                  ADSC9   FPT_TRMATTR+22           cn=0,n=6
         7 000140   001003 000010 0                  ADSC9   TCM_OUTREC+2             cn=0,n=8

      339     2398    2             if F$CG$ -> F$DCB.FCD# = '1'B

   2398  7 000141   000004 470400 0                  LDP0    F$CG$
         7 000142   000031 236100                    LDQ     25,,PR0
         7 000143   020000 316007                    CANQ    8192,DL
         7 000144   000150 600000 7                  TZE     s:2400

      340     2399    2             then CALL M$CLOSE(CLOSECG);

   2399  7 000145   000416 630400 6                  EPPR0   CLOSECG
         7 000146   050001 713400                    CLIMB   close
         7 000147   406000 401760                    pmme    nvectors=13

      341     2400    2             if TCM_ALEX_BAILOUT_ENABLED

   2400  7 000150   000002 237000 0                  LDAQ    TCM_ALEX_BAILOUT
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:35   
         7 000151   000002 117000 8                  CMPAQ   2
         7 000152   000156 600000 7                  TZE     s:2402

      342     2401    2             then unwind to TCM_ALEX_BAILOUT;

   2401  7 000153   000002 237200 0                  LDAQ  ! TCM_ALEX_BAILOUT
         7 000154   000000 700200 xent               TSX0  ! X66_AUNWIND
         7 000155   000000 000200                    ZERO    0,128

      343     2402    2             else altreturn;

   2402  7 000156   000000 702200 xent               TSX2  ! X66_AALT

      344     2403    2           end;
      345     2404    1        if F$CG$ -> F$DCB.FCD# = '1'B

   2404  7 000157   000004 470400 0                  LDP0    F$CG$
         7 000160   000031 236100                    LDQ     25,,PR0
         7 000161   020000 316007                    CANQ    8192,DL
         7 000162   000514 601000 7                  TNZ     DIAL_NEXT_NUMBER

      346     2405    1        then goto DIAL_NEXT_NUMBER;
      347     2406    1        CALL M$OPEN (OPENCG) ALTRET(BADOPEN);

   2406  7 000163   000000 630400 6                  EPPR0   OPENCG
         7 000164   450000 713400                    CLIMB   alt,open
         7 000165   410400 401760                    pmme    nvectors=18
         7 000166   000170 702000 7                  TSX2    BADOPEN

      348     2407    2        DO WHILE ('0'B);

   2407  7 000167   000223 710000 7                  TRA     s:2424

      349     2408    2   BADOPEN:
      350     2409    2             CALL M$OPEN (DELCG) ALTRET(CANT_CONTINUE); /* Delete bad comgroup */

   2409  7 000170   000112 630400 6     BADOPEN      EPPR0   DELCG
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:36   
         7 000171   450000 713400                    CLIMB   alt,open
         7 000172   410400 401760                    pmme    nvectors=18
         7 000173   000201 702000 7                  TSX2    CANT_CONTINUE

      351     2410    2             CALL M$OPEN (OPENCG) ALTRET(CANT_CONTINUE); /* Try again */

   2410  7 000174   000000 630400 6                  EPPR0   OPENCG
         7 000175   450000 713400                    CLIMB   alt,open
         7 000176   410400 401760                    pmme    nvectors=18
         7 000177   000201 702000 7                  TSX2    CANT_CONTINUE

      352     2411    3             DO WHILE ('0'B);

   2411  7 000200   000223 710000 7                  TRA     s:2424

      353     2412    3   CANT_CONTINUE:
      354     2413    3                  TCM_UOBUF = 'Trouble accessing ALEXCG';

   2413  7 000201   040000 100400       CANT_CONTIN* MLR     fill='040'O
         7 000202   000744 000030 6                  ADSC9   FPT_TRMATTR+24           cn=0,n=24
         7 000203   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      355     2414                       %WRITEUO;

   2415  7 000204   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 000205   440001 713400                    CLIMB   alt,write
         7 000206   401400 401760                    pmme    nvectors=4
         7 000207   000211 702000 7                  TSX2    s:2418
         7 000210   000211 710000 7                  TRA     s:2418

      356     2418    3                  CALL M$CLOSE (CLOSECG);

   2418  7 000211   000416 630400 6                  EPPR0   CLOSECG
         7 000212   050001 713400                    CLIMB   close
         7 000213   406000 401760                    pmme    nvectors=13

      357     2419    3                  if TCM_ALEX_BAILOUT_ENABLED
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:37   

   2419  7 000214   000002 237000 0                  LDAQ    TCM_ALEX_BAILOUT
         7 000215   000002 117000 8                  CMPAQ   2
         7 000216   000222 600000 7                  TZE     s:2421

      358     2420    3                  then unwind to TCM_ALEX_BAILOUT;

   2420  7 000217   000002 237200 0                  LDAQ  ! TCM_ALEX_BAILOUT
         7 000220   000000 700200 xent               TSX0  ! X66_AUNWIND
         7 000221   000000 000200                    ZERO    0,128

      359     2421    3                  else altreturn;

   2421  7 000222   000000 702200 xent               TSX2  ! X66_AALT

      360     2422    3                END;

      361     2423    2           END;

      362     2424    1        TCM_INT = '0'B;

   2424  7 000223   000020 450000 0                  STZ     TCM_INT

      363     2425    2        CALL M$FWCG(TCM_DELETEMES) WHENALTRETURN DO;

   2425  7 000224   000204 630400 6                  EPPR0   TCM_DELETEMES
         7 000225   500005 713400                    CLIMB   alt,+32773
         7 000226   406400 401760                    pmme    nvectors=14
         7 000227   000231 702000 7                  TSX2    s:2427
         7 000230   000231 710000 7                  TRA     s:2427

      364     2426    2           END;

      365     2427    1        CALL M$CGCTL (FPT_CGCTL);

   2427  7 000231   000514 630400 6                  EPPR0   FPT_CGCTL
         7 000232   100003 713400                    CLIMB   32771
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:38   
         7 000233   411400 401760                    pmme    nvectors=20

      366     2428        /* Wait for logon message from device */
      367     2429    1        CALL M$DEACTIVATE(TCM_TURNOFF);    /* Flush anything pending */

   2429  7 000234   000474 630400 6                  EPPR0   TCM_TURNOFF
         7 000235   100001 713400                    CLIMB   32769
         7 000236   401400 401760                    pmme    nvectors=4

      368     2430    1        TCM_MBLEN=0;

   2430  7 000237   000525 450000 0                  STZ     TCM_MBLEN

      369     2431    1        TCM_COMMAND='1'B;

   2431  7 000240   400000 236003                    LDQ     -131072,DU
         7 000241   000016 756000 0                  STQ     TCM_COMMAND

      370     2432    1        CALL M$READ (READAU);

   2432  7 000242   000324 630400 6                  EPPR0   READAU
         7 000243   040000 713400                    CLIMB   read
         7 000244   401400 401760                    pmme    nvectors=4

      371     2433    1        I = 0;

   2433  7 000245   000531 450000 0                  STZ     I

      372     2434    2        do until VLR_CGSTATS.NUMTERMS > 0  or  I = 15;

      373     2435    2             I = I + 1;

   2435  7 000246   000531 235000 0                  LDA     I
         7 000247   000001 035007                    ADLA    1,DL
         7 000250   000531 755000 0                  STA     I

      374     2436    2             call M$WAIT(TCM_WAIT1);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:39   

   2436  7 000251   002150 630400 0                  EPPR0   TCM_WAIT1
         7 000252   020006 713400                    CLIMB   8198
         7 000253   400400 401760                    pmme    nvectors=2

      375     2437    2             call M$CGINFO(GET_INFO);

   2437  7 000254   000624 630400 6                  EPPR0   GET_INFO
         7 000255   100004 713400                    CLIMB   32772
         7 000256   411400 401760                    pmme    nvectors=20

      376     2438    2           end;

   2438  7 000257   002117 235000 0                  LDA     VLR_CGSTATS+7
         7 000260   000264 605400 7                  TPNZ    s:2439
         7 000261   000531 236000 0                  LDQ     I
         7 000262   000017 116007                    CMPQ    15,DL
         7 000263   000246 601000 7                  TNZ     s:2435

      377     2439    2        if VLR_CGSTATS.NUMTERMS > 0 then do;

   2439  7 000264   000000 115003                    CMPA    0,DU
         7 000265   000310 604400 7                  TMOZ    s:2449

      378     2440                                                /* For now, assume logon */
      379     2441    2             TCM_CONNECTED = '1'B;

   2441  7 000266   400000 236003                    LDQ     -131072,DU
         7 000267   000024 756000 0                  STQ     TCM_CONNECTED

      380     2442    2             CALL M$ACTIVATE(TCM_TURNON);

   2442  7 000270   000454 630400 6                  EPPR0   TCM_TURNON
         7 000271   100000 713400                    CLIMB   32768
         7 000272   401400 401760                    pmme    nvectors=4

      381     2443    2             CALL M$WAIT(TCM_WAIT1);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:40   

   2443  7 000273   002150 630400 0                  EPPR0   TCM_WAIT1
         7 000274   020006 713400                    CLIMB   8198
         7 000275   400400 401760                    pmme    nvectors=2

      382     2444    2             CALL M$DEACTIVATE(TCM_TURNOFF); /* Abrt pending read */

   2444  7 000276   000474 630400 6                  EPPR0   TCM_TURNOFF
         7 000277   100001 713400                    CLIMB   32769
         7 000300   401400 401760                    pmme    nvectors=4

      383     2445    2             CALL M$WAIT(TCM_WAIT1);

   2445  7 000301   002150 630400 0                  EPPR0   TCM_WAIT1
         7 000302   020006 713400                    CLIMB   8198
         7 000303   400400 401760                    pmme    nvectors=2

      384     2446    2             CALL M$ACTIVATE(TCM_TURNON);  /* Now its ready */

   2446  7 000304   000454 630400 6                  EPPR0   TCM_TURNON
         7 000305   100000 713400                    CLIMB   32768
         7 000306   401400 401760                    pmme    nvectors=4

      385     2447    2           END;

   2447  7 000307   000333 710000 7                  TRA     s:2461

      386     2448    2        ELSE DO;

      387     2449    2             TCM_UOBUF='Modem device did not connect';

   2449  7 000310   040000 100400                    MLR     fill='040'O
         7 000311   000752 000034 6                  ADSC9   FPT_TRMATTR+30           cn=0,n=28
         7 000312   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      388     2450                  %WRITEUO;

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:41   
   2451  7 000313   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 000314   440001 713400                    CLIMB   alt,write
         7 000315   401400 401760                    pmme    nvectors=4
         7 000316   000320 702000 7                  TSX2    s:2454
         7 000317   000320 710000 7                  TRA     s:2454

      389     2454    2             TCM_CONNECTED = '0'B;

   2454  7 000320   000024 450000 0                  STZ     TCM_CONNECTED

      390     2455    2             call TCM$ALEX_DISCONNECT;

   2455  7 000321   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000322   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         7 000323   000000 011000                    NOP     0

      391     2456    2             if TCM_ALEX_BAILOUT_ENABLED

   2456  7 000324   000002 237000 0                  LDAQ    TCM_ALEX_BAILOUT
         7 000325   000002 117000 8                  CMPAQ   2
         7 000326   000332 600000 7                  TZE     s:2458

      392     2457    2             then unwind to TCM_ALEX_BAILOUT;

   2457  7 000327   000002 237200 0                  LDAQ  ! TCM_ALEX_BAILOUT
         7 000330   000000 700200 xent               TSX0  ! X66_AUNWIND
         7 000331   000000 000200                    ZERO    0,128

      393     2458    2             else altreturn;

   2458  7 000332   000000 702200 xent               TSX2  ! X66_AALT

      394     2459    2           END;
      395     2460        /*   Call intro; */
      396     2461    1        CALL M$PROMPT(PROMPTCG);

   2461  7 000333   002546 630400 0                  EPPR0   PROMPTCG
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:42   
         7 000334   160002 713400                    CLIMB   57346
         7 000335   401000 401760                    pmme    nvectors=3

      397     2462    1        CALL M$EOM(EOMCG);

   2462  7 000336   002562 630400 0                  EPPR0   EOMCG
         7 000337   160003 713400                    CLIMB   57347
         7 000340   401000 401760                    pmme    nvectors=3

      398     2463    1        call M$TRMISC(INHIBIT_OPERATOR_MESSAGES);

   2463  7 000341   000300 630400 6                  EPPR0   INHIBIT_OPERATOR_MESSAGES
         7 000342   160020 713400                    CLIMB   57360
         7 000343   400400 401760                    pmme    nvectors=2

      399     2464                                                /* Reset modem */
      400     2465    1        CALL M$XCON(FPT_XCON);

   2465  7 000344   002132 630400 0                  EPPR0   FPT_XCON
         7 000345   010003 713400                    CLIMB   4099
         7 000346   400400 401760                    pmme    nvectors=2

      401     2466    1        CALL CONCAT(TCM_WRITECGBUF,'ATZ',CR);

   2466  7 000347   000761 236000 6                  LDQ     FPT_TRMATTR+37
         7 000350   000004 376000 8                  ANQ     4
         7 000351   000040 276007                    ORQ     32,DL
         7 000352   001312 756000 0                  STQ     TCM_WRITECGBUF
         7 000353   040000 100400                    MLR     fill='040'O
         7 000354   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000355   001312 600375 0                  ADSC9   TCM_WRITECGBUF           cn=3,n=253

      402     2467    1        TCM_BLEN=4;

   2467  7 000356   000004 235007                    LDA     4,DL
         7 000357   002106 755000 0                  STA     TCM_BLEN

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:43   
      403     2468    2        CALL TCM$ALEX_OK WHENALTRETURN DO;

   2468  7 000360   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000361   000000 701000 xent               TSX1    TCM$ALEX_OK
         7 000362   000364 702000 7                  TSX2    s:2469
         7 000363   000411 710000 7                  TRA     MODEMREADY

      404     2469    2             TCM_UOBUF='Modem does not respond';

   2469  7 000364   040000 100400                    MLR     fill='040'O
         7 000365   000762 000026 6                  ADSC9   FPT_TRMATTR+38           cn=0,n=22
         7 000366   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      405     2470                  %WRITEUO;

   2471  7 000367   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 000370   440001 713400                    CLIMB   alt,write
         7 000371   401400 401760                    pmme    nvectors=4
         7 000372   000374 702000 7                  TSX2    s:2474
         7 000373   000374 710000 7                  TRA     s:2474

      406     2474    2             CALL TCM$ALEX_HANGUP;

   2474  7 000374   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000375   000000 701000 xent               TSX1    TCM$ALEX_HANGUP
         7 000376   000000 011000                    NOP     0

      407     2475    2             CALL M$CLOSE(CLOSECG);

   2475  7 000377   000416 630400 6                  EPPR0   CLOSECG
         7 000400   050001 713400                    CLIMB   close
         7 000401   406000 401760                    pmme    nvectors=13

      408     2476    2             if TCM_ALEX_BAILOUT_ENABLED

   2476  7 000402   000002 237000 0                  LDAQ    TCM_ALEX_BAILOUT
         7 000403   000002 117000 8                  CMPAQ   2
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:44   
         7 000404   000410 600000 7                  TZE     s:2478

      409     2477    2             then unwind to TCM_ALEX_BAILOUT;

   2477  7 000405   000002 237200 0                  LDAQ  ! TCM_ALEX_BAILOUT
         7 000406   000000 700200 xent               TSX0  ! X66_AUNWIND
         7 000407   000000 000200                    ZERO    0,128

      410     2478    2             else altreturn;

   2478  7 000410   000000 702200 xent               TSX2  ! X66_AALT

   2467  7 000411                       MODEMREADY   null
      411     2479    2           END;
      412     2480    1   MODEMREADY:;
      413     2481    1        CALL M$PROMPT(PROMPTUSER);

   2481  7 000411   002534 630400 0                  EPPR0   PROMPTUSER
         7 000412   160002 713400                    CLIMB   57346
         7 000413   401000 401760                    pmme    nvectors=3

      414     2482    1        TCM_LOCALMODE='1'B;

   2482  7 000414   400000 236003                    LDQ     -131072,DU
         7 000415   000023 756000 0                  STQ     TCM_LOCALMODE

      415     2483    1        SIBUF=' ';

   2483  7 000416   040000 100400                    MLR     fill='040'O
         7 000417   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 000420   002216 000400 0                  ADSC9   SIBUF                    cn=0,n=256

      416     2484        /* Convert logon string to correct parity */
      417     2485    2        DO I=0 TO 31;

   2485  7 000421   000531 450000 0                  STZ     I

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:45   
      418     2486    3             DO CASE(VLP_TRMATTR.PARITY#);

   2486  7 000422   002575 236000 0                  LDQ     VLP_TRMATTR+1
         7 000423   000033 772000                    QRL     27
         7 000424   000007 376007                    ANQ     7,DL
         7 000425   000005 116007                    CMPQ    5,DL
         7 000426   000430 602006 7                  TNC     s:2486+6,QL
         7 000427   000505 710000 7                  TRA     s:2497
         7 000430   000435 710000 7                  TRA     s:2488
         7 000431   000453 710000 7                  TRA     s:2490
         7 000432   000435 710000 7                  TRA     s:2488
         7 000433   000471 710000 7                  TRA     s:2492
         7 000434   000477 710000 7                  TRA     s:2494

      419     2487    3               CASE(0,2);                  /* None, even */

      420     2488    3                  LA.P(I)=EPTBL(LA.U(I));

   2488  7 000435   000531 236000 0                  LDQ     I
         7 000436   000011 402007                    MPY     9,DL
         7 000437   003100 061406                    CSR     bolr='003'O
         7 000440   000552 020007 0                  BDSC    LOGON,Q                  by=0,bit=2,n=7
         7 000441   200010 000044                    BDSC    PNR+1,,AUTO              by=0,bit=0,n=36
         7 000442   200010 236100                    LDQ     PNR+1,,AUTO
         7 000443   200011 756100                    STQ     PNR+2,,AUTO
         7 000444   000531 236000 0                  LDQ     I
         7 000445   000011 402007                    MPY     9,DL
         7 000446   200011 235100                    LDA     PNR+2,,AUTO
         7 000447   003006 060405                    CSL     bolr='003'O
         7 000450   000563 000001 0                  BDSC    TCM_EPTBLI,A             by=0,bit=0,n=1
         7 000451   000552 010001 0                  BDSC    LOGON,Q                  by=0,bit=1,n=1
         7 000452   000505 710000 7                  TRA     s:2497

      421     2489    3               CASE(1);                    /* Odd */

      422     2490    3                  LA.P(I)=OPTBL(LA.U(I));

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:46   
   2490  7 000453   000531 236000 0                  LDQ     I
         7 000454   000011 402007                    MPY     9,DL
         7 000455   003100 061406                    CSR     bolr='003'O
         7 000456   000552 020007 0                  BDSC    LOGON,Q                  by=0,bit=2,n=7
         7 000457   200010 000044                    BDSC    PNR+1,,AUTO              by=0,bit=0,n=36
         7 000460   200010 236100                    LDQ     PNR+1,,AUTO
         7 000461   200011 756100                    STQ     PNR+2,,AUTO
         7 000462   000531 236000 0                  LDQ     I
         7 000463   000011 402007                    MPY     9,DL
         7 000464   200011 235100                    LDA     PNR+2,,AUTO
         7 000465   003006 060405                    CSL     bolr='003'O
         7 000466   000567 000001 0                  BDSC    TCM_OPTBLI,A             by=0,bit=0,n=1
         7 000467   000552 010001 0                  BDSC    LOGON,Q                  by=0,bit=1,n=1
         7 000470   000505 710000 7                  TRA     s:2497

      423     2491    3               CASE(3);                    /* One */

      424     2492    3                  LA.P(I)='1'B;

   2492  7 000471   000531 236000 0                  LDQ     I
         7 000472   000011 402007                    MPY     9,DL
         7 000473   003006 060400                    CSL     bolr='003'O
         7 000474   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         7 000475   000552 010001 0                  BDSC    LOGON,Q                  by=0,bit=1,n=1
         7 000476   000505 710000 7                  TRA     s:2497

      425     2493    3               CASE(4);                    /* Zero */

      426     2494    3                  LA.P(I)='0'B;

   2494  7 000477   000531 236000 0                  LDQ     I
         7 000500   000011 402007                    MPY     9,DL
         7 000501   003006 060400                    CSL     bolr='003'O
         7 000502   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         7 000503   000552 010001 0                  BDSC    LOGON,Q                  by=0,bit=1,n=1
         7 000504   000505 710000 7                  TRA     s:2497

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:47   
      427     2495    3               CASE(ELSE);

      428     2496    3               END;                        /* Do case */

      429     2497    2           END;                            /* Do i */

   2497  7 000505   000531 235000 0                  LDA     I
         7 000506   000001 035007                    ADLA    1,DL
         7 000507   000531 755000 0                  STA     I
         7 000510   000040 115007                    CMPA    32,DL
         7 000511   000422 602000 7                  TNC     s:2486

      430     2498    1        TCM_COMMAND='1'B;

   2498  7 000512   400000 236003                    LDQ     -131072,DU
         7 000513   000016 756000 0                  STQ     TCM_COMMAND

      431     2499    1   DIAL_NEXT_NUMBER:
      432     2500    1        PHONE = %PHONE300(PNR);

   2500  7 000514   200007 236100       DIAL_NEXT_N* LDQ     PNR,,AUTO
         7 000515   000013 402007                    MPY     11,DL
         7 000516   040000 100406                    MLR     fill='040'O
         7 000517   000000 000013 xsym               ADSC9   TCM_PHONE,Q              cn=0,n=11
         7 000520   000536 000013 0                  ADSC9   PHONE                    cn=0,n=11

      433     2501    1        CALL CONCAT (TCM_UOBUF,'Dialing ',PHONE);

   2501  7 000521   000770 237000 6                  LDAQ    FPT_TRMATTR+44
         7 000522   002316 757000 0                  STAQ    TCM_UOBUF
         7 000523   040000 100400                    MLR     fill='040'O
         7 000524   000536 000013 0                  ADSC9   PHONE                    cn=0,n=11
         7 000525   002320 000370 0                  ADSC9   TCM_UOBUF+2              cn=0,n=248

      434     2502             %WRITEUO;

   2503  7 000526   002202 630400 0                  EPPR0   TCM_WRITEUO
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:48   
         7 000527   440001 713400                    CLIMB   alt,write
         7 000530   401400 401760                    pmme    nvectors=4
         7 000531   000533 702000 7                  TSX2    s:2507
         7 000532   000533 710000 7                  TRA     s:2507

      435     2506
      436     2507    1        CALL M$WAIT(TCM_WAIT1);            /* Let atz take effect */

   2507  7 000533   002150 630400 0                  EPPR0   TCM_WAIT1
         7 000534   020006 713400                    CLIMB   8198
         7 000535   400400 401760                    pmme    nvectors=2

      437     2508    2        IF SLOG.LEN=1 AND SLOG.TEXT(0)='#' THEN DO;

   2508  7 000536   000006 236000 0                  LDQ     SLOG
         7 000537   777000 376003                    ANQ     -512,DU
         7 000540   001000 116003                    CMPQ    512,DU
         7 000541   000562 601000 7                  TNZ     s:2511
         7 000542   000006 236000 0                  LDQ     SLOG
         7 000543   000777 376003                    ANQ     511,DU
         7 000544   000043 116003                    CMPQ    35,DU
         7 000545   000562 601000 7                  TNZ     s:2511

      438     2509    2             CALL CONCAT(TCM_WRITECGBUF,'ATDT',PHONE,',;C1',CR);

   2509  7 000546   000772 236000 6                  LDQ     FPT_TRMATTR+46
         7 000547   001312 756000 0                  STQ     TCM_WRITECGBUF
         7 000550   040000 100400                    MLR     fill='040'O
         7 000551   000536 000013 0                  ADSC9   PHONE                    cn=0,n=11
         7 000552   001313 000013 0                  ADSC9   TCM_WRITECGBUF+1         cn=0,n=11
         7 000553   040000 100400                    MLR     fill='040'O
         7 000554   000773 000004 6                  ADSC9   FPT_TRMATTR+47           cn=0,n=4
         7 000555   001315 600004 0                  ADSC9   TCM_WRITECGBUF+3         cn=3,n=4
         7 000556   040000 100400                    MLR     fill='040'O
         7 000557   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000560   001316 600355 0                  ADSC9   TCM_WRITECGBUF+4         cn=3,n=237

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:49   
      439     2510    2           END;

   2510  7 000561   000572 710000 7                  TRA     s:2512

      440     2511    1        ELSE CALL CONCAT(TCM_WRITECGBUF,'ATDT',PHONE,CR);

   2511  7 000562   000772 236000 6                  LDQ     FPT_TRMATTR+46
         7 000563   001312 756000 0                  STQ     TCM_WRITECGBUF
         7 000564   040000 100400                    MLR     fill='040'O
         7 000565   000536 000013 0                  ADSC9   PHONE                    cn=0,n=11
         7 000566   001313 000013 0                  ADSC9   TCM_WRITECGBUF+1         cn=0,n=11
         7 000567   040000 100400                    MLR     fill='040'O
         7 000570   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000571   001315 600361 0                  ADSC9   TCM_WRITECGBUF+3         cn=3,n=241

      441     2512    1        CALL INDEX(TCM_BLEN,CR,TCM_WRITECGBUF);

   2512  7 000572   000000 124400                    SCM     mask='000'O
         7 000573   001312 000400 0                  ADSC9   TCM_WRITECGBUF           cn=0,n=256
         7 000574   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000575   002106 000000 0                  ARG     TCM_BLEN

      442     2513    1        TCM_BLEN=TCM_BLEN+1;

   2513  7 000576   002106 235000 0                  LDA     TCM_BLEN
         7 000577   000001 035007                    ADLA    1,DL
         7 000600   002106 755000 0                  STA     TCM_BLEN

      443     2514    1        TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);

   2514  7 000601   000020 735000                    ALS     16
         7 000602   000140 135007                    SBLA    96,DL
         7 000603   000005 236000 8                  LDQ     5
         7 000604   001302 757000 0                  STAQ    TCM_WRITECG+4

      444     2515    1        CALL M$WRITE(TCM_WRITECG);

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:50   
   2515  7 000605   001276 630400 0                  EPPR0   TCM_WRITECG
         7 000606   040001 713400                    CLIMB   write
         7 000607   401400 401760                    pmme    nvectors=4

      445     2516    2        IF SLOG.LEN=1 AND SLOG.TEXT(0)='#' THEN DO;

   2516  7 000610   000006 236000 0                  LDQ     SLOG
         7 000611   777000 376003                    ANQ     -512,DU
         7 000612   001000 116003                    CMPQ    512,DU
         7 000613   000652 601000 7                  TNZ     s:2527
         7 000614   000006 236000 0                  LDQ     SLOG
         7 000615   000777 376003                    ANQ     511,DU
         7 000616   000043 116003                    CMPQ    35,DU
         7 000617   000652 601000 7                  TNZ     s:2527

      446     2517    2             CALL M$WAIT(TCM_TAKE5);

   2517  7 000620   002156 630400 0                  EPPR0   TCM_TAKE5
         7 000621   020006 713400                    CLIMB   8198
         7 000622   400400 401760                    pmme    nvectors=2

      447     2518    2             CALL M$WAIT(TCM_TAKE5);

   2518  7 000623   002156 630400 0                  EPPR0   TCM_TAKE5
         7 000624   020006 713400                    CLIMB   8198
         7 000625   400400 401760                    pmme    nvectors=2

      448     2519    2             CALL M$WAIT(TCM_TAKE5);       /* Wait for pickup and logon please */

   2519  7 000626   002156 630400 0                  EPPR0   TCM_TAKE5
         7 000627   020006 713400                    CLIMB   8198
         7 000630   400400 401760                    pmme    nvectors=2

      449     2520    2             CALL CONCAT(TCM_WRITECGBUF,'ATO',CR);

   2520  7 000631   000774 236000 6                  LDQ     FPT_TRMATTR+48
         7 000632   000004 376000 8                  ANQ     4
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:51   
         7 000633   000040 276007                    ORQ     32,DL
         7 000634   001312 756000 0                  STQ     TCM_WRITECGBUF
         7 000635   040000 100400                    MLR     fill='040'O
         7 000636   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000637   001312 600375 0                  ADSC9   TCM_WRITECGBUF           cn=3,n=253

      450     2521    2             TCM_LOCALMODE='0'B;

   2521  7 000640   000023 450000 0                  STZ     TCM_LOCALMODE

      451     2522    2             TCM_BLEN=4;

   2522  7 000641   000004 235007                    LDA     4,DL
         7 000642   002106 755000 0                  STA     TCM_BLEN

      452     2523    2             TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);

   2523  7 000643   000020 735000                    ALS     16
         7 000644   000140 135007                    SBLA    96,DL
         7 000645   000005 236000 8                  LDQ     5
         7 000646   001302 757000 0                  STAQ    TCM_WRITECG+4

      453     2524    2             CALL M$WRITE(TCM_WRITECG);    /* Go online */

   2524  7 000647   001276 630400 0                  EPPR0   TCM_WRITECG
         7 000650   040001 713400                    CLIMB   write
         7 000651   401400 401760                    pmme    nvectors=4

      454     2525    2           END;

      455     2526        /* Wait for connect message */
      456     2527    1        RETRY=0;

   2527  7 000652   000526 450000 0                  STZ     RETRY

      457     2528    1        TCM_MBLEN=0;

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:52   
   2528  7 000653   000525 450000 0                  STZ     TCM_MBLEN

      458     2529    2   RED: DO WHILE(RETRY<10);

   2529  7 000654   000526 235000 0     RED          LDA     RETRY
         7 000655   000012 115007                    CMPA    10,DL
         7 000656   000764 603000 7                  TRC     s:2562

      459     2530    2             TCM_INT='0'B;

   2530  7 000657   000020 450000 0                  STZ     TCM_INT

      460     2531    2             CALL M$READ(TCM_READCG);      /* Look for response*/

   2531  7 000660   001650 630400 0                  EPPR0   TCM_READCG
         7 000661   040000 713400                    CLIMB   read
         7 000662   401400 401760                    pmme    nvectors=4

      461     2532    2             CALL M$WAIT(TCM_TAKE5);

   2532  7 000663   002156 630400 0                  EPPR0   TCM_TAKE5
         7 000664   020006 713400                    CLIMB   8198
         7 000665   400400 401760                    pmme    nvectors=2

      462     2533    3             IF TCM_INT THEN DO;

   2533  7 000666   000020 234000 0                  SZN     TCM_INT
         7 000667   000757 605000 7                  TPL     s:2560

      463     2534    3                  CALL INDEX(I,'NO CARRIER',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN))

   2534  7 000670   000531 631400 0                  EPPR1   I
         7 000671   000775 633400 6                  EPPR3   FPT_TRMATTR+49
         7 000672   000012 223003                    LDX3    10,DU
         7 000673   000025 630400 0                  EPPR0   TCM_MODEMBUF
         7 000674   000525 720000 0                  LXL0    TCM_MBLEN
         7 000675   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:53   
         7 000676   000000 701000 xent               TSX1    X66_INDEX
         7 000677   000717 710000 7                  TRA     s:2544

      464     2535    4                  whenreturn do;

      465     2536    4                       TCM_UOBUF='No carrier received';

   2536  7 000700   040000 100400                    MLR     fill='040'O
         7 000701   001000 000023 6                  ADSC9   FPT_TRMATTR+52           cn=0,n=19
         7 000702   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      466     2537                            %WRITEUO;

   2538  7 000703   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 000704   440001 713400                    CLIMB   alt,write
         7 000705   401400 401760                    pmme    nvectors=4
         7 000706   000710 702000 7                  TSX2    s:2541
         7 000707   000710 710000 7                  TRA     s:2541

      467     2541    4                       CALL INSERT(TCM_OUTREC,0,16,TCM_SITE,'NCAR');

   2541  7 000710   000534 237000 0                  LDAQ    TCM_SITE
         7 000711   001001 755000 0                  STA     TCM_OUTREC
         7 000712   001002 756000 0                  STQ     TCM_OUTREC+1
         7 000713   040000 100400                    MLR     fill='040'O
         7 000714   001005 000004 6                  ADSC9   FPT_TRMATTR+57           cn=0,n=4
         7 000715   001003 000010 0                  ADSC9   TCM_OUTREC+2             cn=0,n=8

      468     2542    4                       goto LOOP_THROUGH_NUMBERS;

   2542  7 000716   000117 710000 7                  TRA     LOOP_THROUGH_NUMBERS

      469     2543    4                     END;
      470     2544    3                  call index(I,'MODEM',substr(TCM_MODEMBUF,0,TCM_MBLEN))

   2544  7 000717   000531 631400 0                  EPPR1   I
         7 000720   001006 633400 6                  EPPR3   FPT_TRMATTR+58
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:54   
         7 000721   000005 223003                    LDX3    5,DU
         7 000722   000025 630400 0                  EPPR0   TCM_MODEMBUF
         7 000723   000525 720000 0                  LXL0    TCM_MBLEN
         7 000724   000000 236003                    LDQ     0,DU
         7 000725   000000 701000 xent               TSX1    X66_INDEX
         7 000726   000746 710000 7                  TRA     s:2555

      471     2545    4                  whenreturn do;

      472     2546    4                       TCM_UOBUF='Modem reported strange status; resetting.';

   2546  7 000727   040000 100400                    MLR     fill='040'O
         7 000730   001010 000051 6                  ADSC9   FPT_TRMATTR+60           cn=0,n=41
         7 000731   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      473     2547                            %WRITEUO;

   2548  7 000732   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 000733   440001 713400                    CLIMB   alt,write
         7 000734   401400 401760                    pmme    nvectors=4
         7 000735   000737 702000 7                  TSX2    s:2551
         7 000736   000737 710000 7                  TRA     s:2551

      474     2551    4                       call M$CLOSE(CLOSECG);

   2551  7 000737   000416 630400 6                  EPPR0   CLOSECG
         7 000740   050001 713400                    CLIMB   close
         7 000741   406000 401760                    pmme    nvectors=13

      475     2552    4                       call M$WAIT(TCM_TAKE5);

   2552  7 000742   002156 630400 0                  EPPR0   TCM_TAKE5
         7 000743   020006 713400                    CLIMB   8198
         7 000744   400400 401760                    pmme    nvectors=2

      476     2553    4                       goto LOOP_THROUGH_NUMBERS;

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:55   
   2553  7 000745   000117 710000 7                  TRA     LOOP_THROUGH_NUMBERS

      477     2554    4                     end;
      478     2555    3                  CALL INDEX(I,'CONNECT',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN))

   2555  7 000746   000531 631400 0                  EPPR1   I
         7 000747   001023 633400 6                  EPPR3   FPT_TRMATTR+71
         7 000750   000007 223003                    LDX3    7,DU
         7 000751   000025 630400 0                  EPPR0   TCM_MODEMBUF
         7 000752   000525 720000 0                  LXL0    TCM_MBLEN
         7 000753   000000 236003                    LDQ     0,DU
         7 000754   000000 701000 xent               TSX1    X66_INDEX
         7 000755   000757 710000 7                  TRA     s:2560

      479     2556    4                  whenreturn do;

      480     2557    4                       exit RED;

   2557  7 000756   000764 710000 7                  TRA     s:2562

      481     2558    4                     end;
      482     2559    3                END;

      483     2560    2             RETRY=RETRY+1;

   2560  7 000757   000526 235000 0                  LDA     RETRY
         7 000760   000001 035007                    ADLA    1,DL
         7 000761   000526 755000 0                  STA     RETRY

      484     2561    2           END;

   2561  7 000762   000012 115007                    CMPA    10,DL
         7 000763   000657 602000 7                  TNC     s:2530

      485     2562    2        IF RETRY=10 THEN DO;

   2562  7 000764   000526 235000 0                  LDA     RETRY
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:56   
         7 000765   000012 115007                    CMPA    10,DL
         7 000766   001006 601000 7                  TNZ     s:2572

      486     2563    2             TCM_UOBUF='No response; resetting.';

   2563  7 000767   040000 100400                    MLR     fill='040'O
         7 000770   001025 000027 6                  ADSC9   FPT_TRMATTR+73           cn=0,n=23
         7 000771   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      487     2564                  %WRITEUO;

   2565  7 000772   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 000773   440001 713400                    CLIMB   alt,write
         7 000774   401400 401760                    pmme    nvectors=4
         7 000775   000777 702000 7                  TSX2    s:2568
         7 000776   000777 710000 7                  TRA     s:2568

      488     2568    2             call M$CLOSE(CLOSECG);

   2568  7 000777   000416 630400 6                  EPPR0   CLOSECG
         7 001000   050001 713400                    CLIMB   close
         7 001001   406000 401760                    pmme    nvectors=13

      489     2569    2             call M$WAIT(TCM_TAKE5);

   2569  7 001002   002156 630400 0                  EPPR0   TCM_TAKE5
         7 001003   020006 713400                    CLIMB   8198
         7 001004   400400 401760                    pmme    nvectors=2

      490     2570    2             goto LOOP_THROUGH_NUMBERS;

   2570  7 001005   000117 710000 7                  TRA     LOOP_THROUGH_NUMBERS

      491     2571    2           END;
      492     2572    1        TCM_LOCALMODE='0'B;                /* Modem now in online mode */

   2572  7 001006   000023 450000 0                  STZ     TCM_LOCALMODE
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:57   

      493     2573    1        TCM_MBLEN = 0;

   2573  7 001007   000525 450000 0                  STZ     TCM_MBLEN

      494     2574    2        IF SLOG.LEN>0 THEN DO;

   2574  7 001010   000006 236000 0                  LDQ     SLOG
         7 001011   777000 316003                    CANQ    -512,DU
         7 001012   001116 600000 7                  TZE     EIGHTS

      495     2575    2             TCM_BLEN=1;

   2575  7 001013   000001 235007                    LDA     1,DL
         7 001014   002106 755000 0                  STA     TCM_BLEN

      496     2576    2             TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);

   2576  7 001015   000020 735000                    ALS     16
         7 001016   000140 135007                    SBLA    96,DL
         7 001017   000005 236000 8                  LDQ     5
         7 001020   001302 757000 0                  STAQ    TCM_WRITECG+4

      497     2577    3             DO I=0 TO SLOG.LEN-1;

   2577  7 001021   000531 450000 0                  STZ     I
         7 001022   001111 710000 7                  TRA     NOWRITE+3

      498     2578    4                  DO SELECT(SLOG.TEXT(I));

   2578  7 001023   000531 235000 0                  LDA     I
         7 001024   040000 106405                    CMPC    fill='040'O
         7 001025   000006 200001 0                  ADSC9   SLOG,A                   cn=1,n=1
         7 001026   000006 000001 8                  ADSC9   6                        cn=0,n=1
         7 001027   001036 602000 7                  TNC     s:2578+11
         7 001030   001061 600000 7                  TZE     s:2582
         7 001031   040000 106405                    CMPC    fill='040'O
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:58   
         7 001032   000006 200001 0                  ADSC9   SLOG,A                   cn=1,n=1
         7 001033   000007 000001 8                  ADSC9   7                        cn=0,n=1
         7 001034   001100 601000 7                  TNZ     s:2596
         7 001035   001065 710000 7                  TRA     s:2585
         7 001036   040000 106405                    CMPC    fill='040'O
         7 001037   000006 200001 0                  ADSC9   SLOG,A                   cn=1,n=1
         7 001040   000010 000001 8                  ADSC9   8                        cn=0,n=1
         7 001041   001050 602000 7                  TNC     s:2578+21
         7 001042   001055 600000 7                  TZE     s:2580
         7 001043   040000 106405                    CMPC    fill='040'O
         7 001044   000006 200001 0                  ADSC9   SLOG,A                   cn=1,n=1
         7 001045   000011 000001 8                  ADSC9   9                        cn=0,n=1
         7 001046   001100 601000 7                  TNZ     s:2596
         7 001047   001066 710000 7                  TRA     s:2587
         7 001050   040000 106405                    CMPC    fill='040'O
         7 001051   000006 200001 0                  ADSC9   SLOG,A                   cn=1,n=1
         7 001052   000012 000001 8                  ADSC9   10                       cn=0,n=1
         7 001053   001100 601000 7                  TNZ     s:2596
         7 001054   001067 710000 7                  TRA     s:2589

      499     2579    4                       SELECT('"');

      500     2580    4                       TCM_WRITECGBUF=CR;

   2580  7 001055   040000 100400                    MLR     fill='040'O
         7 001056   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 001057   001312 000400 0                  ADSC9   TCM_WRITECGBUF           cn=0,n=256
         7 001060   001103 710000 7                  TRA     s:2598

      501     2581    4                       SELECT('%');

      502     2582    4                       CALL M$WAIT(TCM_WAIT1);

   2582  7 001061   002150 630400 0                  EPPR0   TCM_WAIT1
         7 001062   020006 713400                    CLIMB   8198
         7 001063   400400 401760                    pmme    nvectors=2

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:59   
      503     2583    4                       GOTO NOWRITE;

   2583  7 001064   001106 710000 7                  TRA     NOWRITE

      504     2584    4                       SELECT('&');

      505     2585    4                       GOTO EIGHTS;

   2585  7 001065   001116 710000 7                  TRA     EIGHTS

      506     2586    4                       SELECT('#');

      507     2587    4                       GOTO NOEIGHTS;

   2587  7 001066   001254 710000 7                  TRA     NOEIGHTS

      508     2588    4                       SELECT('!');

      509     2589    4                       TCM_UOBUF='Connection established.';

   2589  7 001067   040000 100400                    MLR     fill='040'O
         7 001070   001033 000027 6                  ADSC9   FPT_TRMATTR+79           cn=0,n=23
         7 001071   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      510     2590                            %WRITEUO;

   2591  7 001072   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 001073   440001 713400                    CLIMB   alt,write
         7 001074   401400 401760                    pmme    nvectors=4
         7 001075   001077 702000 7                  TSX2    s:2594
         7 001076   001077 710000 7                  TRA     s:2594

      511     2594    4                       GOTO CONPRO;

   2594  7 001077   001303 710000 7                  TRA     CONPRO

      512     2595    4                       SELECT(ELSE);
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:60   

      513     2596    4                  TCM_WRITECGBUF=SLOG.TEXT(I);

   2596  7 001100   040000 100405                    MLR     fill='040'O
         7 001101   000006 200001 0                  ADSC9   SLOG,A                   cn=1,n=1
         7 001102   001312 000400 0                  ADSC9   TCM_WRITECGBUF           cn=0,n=256

      514     2597    4                     END;                  /* Do select */

      515     2598    3             CALL M$WRITE(TCM_WRITECG);

   2598  7 001103   001276 630400 0                  EPPR0   TCM_WRITECG
         7 001104   040001 713400                    CLIMB   write
         7 001105   401400 401760                    pmme    nvectors=4

      516     2599    3   NOWRITE:     END;                       /* Do i */

   2599  7 001106   000531 235000 0     NOWRITE      LDA     I
         7 001107   000001 035007                    ADLA    1,DL
         7 001110   000531 755000 0                  STA     I
         7 001111   000006 236000 0                  LDQ     SLOG
         7 001112   000033 772000                    QRL     27
         7 001113   000531 116000 0                  CMPQ    I
         7 001114   001116 600000 7                  TZE     EIGHTS
         7 001115   001023 603000 7                  TRC     s:2578

      517     2600    2           END;                            /* If FLAG>0 */

      518     2601        /* Now type 5 8'S, 1 sec pause between each*/
      519     2602    1   EIGHTS:
      520     2603    1        TCM_UOBUF='Typing 8s';

   2603  7 001116   040000 100400       EIGHTS       MLR     fill='040'O
         7 001117   001041 000011 6                  ADSC9   FPT_TRMATTR+85           cn=0,n=9
         7 001120   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      521     2604             %WRITEUO;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:61   

   2605  7 001121   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 001122   440001 713400                    CLIMB   alt,write
         7 001123   401400 401760                    pmme    nvectors=4
         7 001124   001126 702000 7                  TSX2    s:2608
         7 001125   001126 710000 7                  TRA     s:2608

      522     2608    1        RETRY=0;

   2608  7 001126   000526 450000 0                  STZ     RETRY

      523     2609    1        TCM_MBLEN=0;

   2609  7 001127   000525 450000 0                  STZ     TCM_MBLEN

      524     2610    2   OKP: DO WHILE(RETRY<8);

   2610  7 001130   000526 235000 0     OKP          LDA     RETRY
         7 001131   000010 115007                    CMPA    8,DL
         7 001132   001207 603000 7                  TRC     s:2625

      525     2611    2             TCM_BLEN=1;

   2611  7 001133   000001 235007                    LDA     1,DL
         7 001134   002106 755000 0                  STA     TCM_BLEN

      526     2612    2             TCM_WRITECG.BUF_=VECTOR(ADDR(EIGHT_VAL)->BUFC);

   2612  7 001135   000020 735000                    ALS     16
         7 001136   000140 135007                    SBLA    96,DL
         7 001137   000013 236000 8                  LDQ     11
         7 001140   001302 757000 0                  STAQ    TCM_WRITECG+4

      527     2613    2             CALL M$WRITE(TCM_WRITECG);

   2613  7 001141   001276 630400 0                  EPPR0   TCM_WRITECG
         7 001142   040001 713400                    CLIMB   write
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:62   
         7 001143   401400 401760                    pmme    nvectors=4

      528     2614    2             TCM_INT='0'B;

   2614  7 001144   000020 450000 0                  STZ     TCM_INT

      529     2615    2             CALL M$READ(TCM_READCG);      /* Look for response*/

   2615  7 001145   001650 630400 0                  EPPR0   TCM_READCG
         7 001146   040000 713400                    CLIMB   read
         7 001147   401400 401760                    pmme    nvectors=4

      530     2616    2             CALL M$WAIT(TCM_NORM);

   2616  7 001150   002142 630400 0                  EPPR0   TCM_NORM
         7 001151   020006 713400                    CLIMB   8198
         7 001152   400400 401760                    pmme    nvectors=2

      531     2617    3             IF TCM_INT THEN DO;

   2617  7 001153   000020 234000 0                  SZN     TCM_INT
         7 001154   001202 605000 7                  TPL     s:2623

      532     2618    3                  CALL INDEX(I,'parenthesis',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN));

   2618  7 001155   000531 631400 0                  EPPR1   I
         7 001156   001044 633400 6                  EPPR3   FPT_TRMATTR+88
         7 001157   000013 223003                    LDX3    11,DU
         7 001160   000025 630400 0                  EPPR0   TCM_MODEMBUF
         7 001161   000525 720000 0                  LXL0    TCM_MBLEN
         7 001162   000000 236003                    LDQ     0,DU
         7 001163   000000 701000 xent               TSX1    X66_INDEX
         7 001164   000000 011000                    NOP     0

      533     2619    3                  IF I<TCM_MBLEN THEN EXIT OKP;

   2619  7 001165   000531 236000 0                  LDQ     I
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:63   
         7 001166   000525 116000 0                  CMPQ    TCM_MBLEN
         7 001167   001207 602000 7                  TNC     s:2625

      534     2620    3                  CALL INDEX(I,'PLEASE',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN));

   2620  7 001170   000531 631400 0                  EPPR1   I
         7 001171   001047 633400 6                  EPPR3   FPT_TRMATTR+91
         7 001172   000006 223003                    LDX3    6,DU
         7 001173   000025 630400 0                  EPPR0   TCM_MODEMBUF
         7 001174   000000 236003                    LDQ     0,DU
         7 001175   000000 701000 xent               TSX1    X66_INDEX
         7 001176   000000 011000                    NOP     0

      535     2621    3                  IF I<TCM_MBLEN THEN GOTO LOGN;

   2621  7 001177   000531 236000 0                  LDQ     I
         7 001200   000525 116000 0                  CMPQ    TCM_MBLEN
         7 001201   001257 602000 7                  TNC     LOGN

      536     2622    3                END;

      537     2623    2             RETRY=RETRY+1;

   2623  7 001202   000526 235000 0                  LDA     RETRY
         7 001203   000001 035007                    ADLA    1,DL
         7 001204   000526 755000 0                  STA     RETRY

      538     2624    2           END;

   2624  7 001205   000010 115007                    CMPA    8,DL
         7 001206   001133 602000 7                  TNC     s:2611

      539     2625    2        IF RETRY=8 THEN DO;

   2625  7 001207   000526 235000 0                  LDA     RETRY
         7 001210   000010 115007                    CMPA    8,DL
         7 001211   001242 601000 7                  TNZ     s:2638
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:64   

      540     2626    2             TCM_UOBUF='No response to 8s';

   2626  7 001212   040000 100400                    MLR     fill='040'O
         7 001213   001051 000021 6                  ADSC9   FPT_TRMATTR+93           cn=0,n=17
         7 001214   002316 000400 0                  ADSC9   TCM_UOBUF                cn=0,n=256

      541     2627                  %WRITEUO;

   2628  7 001215   002202 630400 0                  EPPR0   TCM_WRITEUO
         7 001216   440001 713400                    CLIMB   alt,write
         7 001217   401400 401760                    pmme    nvectors=4
         7 001220   001222 702000 7                  TSX2    s:2631
         7 001221   001222 710000 7                  TRA     s:2631

      542     2631    2             CALL INSERT(TCM_OUTREC,0,16,TCM_SITE,'NR8');

   2631  7 001222   000534 237000 0                  LDAQ    TCM_SITE
         7 001223   001001 755000 0                  STA     TCM_OUTREC
         7 001224   001002 756000 0                  STQ     TCM_OUTREC+1
         7 001225   040000 100400                    MLR     fill='040'O
         7 001226   001056 000003 6                  ADSC9   FPT_TRMATTR+98           cn=0,n=3
         7 001227   001003 000010 0                  ADSC9   TCM_OUTREC+2             cn=0,n=8

      543     2632    2             call TCM$ALEX_DISCONNECT;

   2632  7 001230   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 001231   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         7 001232   000000 011000                    NOP     0

      544     2633    2             if TCM_ALEX_BAILOUT_ENABLED

   2633  7 001233   000002 237000 0                  LDAQ    TCM_ALEX_BAILOUT
         7 001234   000002 117000 8                  CMPAQ   2
         7 001235   001241 600000 7                  TZE     s:2635

      545     2634    2             then unwind to TCM_ALEX_BAILOUT;
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:65   

   2634  7 001236   000002 237200 0                  LDAQ  ! TCM_ALEX_BAILOUT
         7 001237   000000 700200 xent               TSX0  ! X66_AUNWIND
         7 001240   000000 000200                    ZERO    0,128

      546     2635    2             else altreturn;

   2635  7 001241   000000 702200 xent               TSX2  ! X66_AALT

      547     2636    2           END;
      548     2637        /* Type '(' alone */
      549     2638    1        TCM_BLEN=1;

   2638  7 001242   000001 236007                    LDQ     1,DL
         7 001243   002106 756000 0                  STQ     TCM_BLEN

      550     2639    1        TCM_WRITECG.BUF_=VECTOR(ADDR(PAREN_VAL)->BUFC);

   2639  7 001244   002106 235000 0                  LDA     TCM_BLEN
         7 001245   000020 735000                    ALS     16
         7 001246   000140 135007                    SBLA    96,DL
         7 001247   000014 236000 8                  LDQ     12
         7 001250   001302 757000 0                  STAQ    TCM_WRITECG+4

      551     2640    1        CALL M$WRITE (TCM_WRITECG);

   2640  7 001251   001276 630400 0                  EPPR0   TCM_WRITECG
         7 001252   040001 713400                    CLIMB   write
         7 001253   401400 401760                    pmme    nvectors=4

      552     2641    1   NOEIGHTS:
      553     2642    1        CALL M$WAIT(TCM_NORM);

   2642  7 001254   002142 630400 0     NOEIGHTS     EPPR0   TCM_NORM
         7 001255   020006 713400                    CLIMB   8198
         7 001256   400400 401760                    pmme    nvectors=2

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:66   
      554     2643        /* Now type logon */
      555     2644    1   LOGN: CALL CONCAT(TCM_WRITECGBUF,LOGON,CR);

   2644  7 001257   040000 100400       LOGN         MLR     fill='040'O
         7 001260   000552 000037 0                  ADSC9   LOGON                    cn=0,n=31
         7 001261   001312 000037 0                  ADSC9   TCM_WRITECGBUF           cn=0,n=31
         7 001262   040000 100400                    MLR     fill='040'O
         7 001263   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 001264   001321 600341 0                  ADSC9   TCM_WRITECGBUF+7         cn=3,n=225

      556     2645    1        CALL INDEX(TCM_BLEN,CR,TCM_WRITECGBUF);

   2645  7 001265   000000 124400                    SCM     mask='000'O
         7 001266   001312 000400 0                  ADSC9   TCM_WRITECGBUF           cn=0,n=256
         7 001267   000532 000001 0                  ADSC9   CR                       cn=0,n=1
         7 001270   002106 000000 0                  ARG     TCM_BLEN

      557     2646    1        TCM_BLEN=TCM_BLEN+1;

   2646  7 001271   002106 235000 0                  LDA     TCM_BLEN
         7 001272   000001 035007                    ADLA    1,DL
         7 001273   002106 755000 0                  STA     TCM_BLEN

      558     2647    1        TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);

   2647  7 001274   000020 735000                    ALS     16
         7 001275   000140 135007                    SBLA    96,DL
         7 001276   000005 236000 8                  LDQ     5
         7 001277   001302 757000 0                  STAQ    TCM_WRITECG+4

      559     2648    1        CALL M$WRITE(TCM_WRITECG);

   2648  7 001300   001276 630400 0                  EPPR0   TCM_WRITECG
         7 001301   040001 713400                    CLIMB   write
         7 001302   401400 401760                    pmme    nvectors=4

      560     2649    1   CONPRO:
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:67   
      561     2650    1        TCM_COMMAND='0'B;

   2650  7 001303   000016 450000 0     CONPRO       STZ     TCM_COMMAND

      562     2651        /*        Call M$READ (TCM_READCG); */
      563     2652    1        TCM_NEEDREAD='1'B;

   2652  7 001304   400000 236003                    LDQ     -131072,DU
         7 001305   000022 756000 0                  STQ     TCM_NEEDREAD

      564     2653    1        TCM_LOCAL='0'B;

   2653  7 001306   000021 450000 0                  STZ     TCM_LOCAL

      565     2654    1        TCM_LOCALMODE='0'B;

   2654  7 001307   000023 450000 0                  STZ     TCM_LOCALMODE

      566     2655    1        TCM_EXEC='1'B;

   2655  7 001310   000017 756000 0                  STQ     TCM_EXEC

      567     2656    1        CHECK_PARITY.PARITY# = 0;          /* Set to no parity  */

   2656  7 001311   000015 236000 8                  LDQ     13
         7 001312   002617 356000 0                  ANSQ    CHECK_PARITY+1

      568     2657    1        CALL M$STRMATTR(PARITY);

   2657  7 001313   002606 630400 0                  EPPR0   PARITY
         7 001314   160006 713400                    CLIMB   57350
         7 001315   401000 401760                    pmme    nvectors=3

      569     2658    1        RETURN;

   2658  7 001316   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:68   
SLOG
 Sect OctLoc
   0     006   ****** ******   ****** ******   ****** ******   ****** ******    ................

TCM_USING_PAD
 Sect OctLoc
   0     015   0***** ******                                                    ....

TCM_COMMAND
 Sect OctLoc
   0     016   0***** ******                                                    ....

TCM_EXEC
 Sect OctLoc
   0     017   0***** ******                                                    ....

TCM_INT
 Sect OctLoc
   0     020   0***** ******                                                    ....

TCM_LOCAL
 Sect OctLoc
   0     021   0***** ******                                                    ....

TCM_NEEDREAD
 Sect OctLoc
   0     022   0***** ******                                                    ....

TCM_LOCALMODE
 Sect OctLoc
   0     023   0***** ******                                                    ....

TCM_CONNECTED
 Sect OctLoc
   0     024   0***** ******                                                    ....

TCM_MODEMBUF
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:69   
 Sect OctLoc
   0     025   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
   0     527   ****** ******   000000 000000                                    ........

CR
 Sect OctLoc
   0     532   015*** ******                                                    ....

(unnamed)
 Sect OctLoc
   0     533   012*** ******                                                    ....

(unnamed)
 Sect OctLoc
   0     541   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOGON
 Sect OctLoc
   0     552   ****** ******   ****** ******   ****** ******   ****** ******    ................

TCM_EPTBLI
 Sect OctLoc
   0     563   323132 263231   315132 313226   322646 263231   322632 2*****    .Z...Z..........

TCM_OPTBLI
 Sect OctLoc
   0     567   454645 514546   462645 464551   455131 514546   455145 4*****    .........Y...e..

EIGHT_TBL
 Sect OctLoc
   0     574   270070 270270   070*** ******                                    .8..8...

PAREN_TBL
 Sect OctLoc
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:70   
   0     577   050250 050250   050*** ******                                    (.(.(...

TCM_STRIPPAR
 Sect OctLoc
   0     601   ****** ******   ****** ******   ****** ******   ****** ******    ................

TCM_OUTREC
 Sect OctLoc
   0    1001   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
   0    1124   015007 127101   122116 111116   107054 040065   040155 151156    ..WARNING, 5 min
   0    1130   165164 145163   040167 151164   150157 165164   040111 117040    utes without IO
   0    1134   150141 166145   040160 141163   163145 144054   040101 114105    have passed, ALE
   0    1140   130040 167151   154154 040114   117107 040171   157165 040157    X will LOG you o
   0    1144   146146 040151   156040 061040   155151 156165   164145 056007    ff in 1 minute..
   0    1150   015*** ******   015007 066040   155151 156165   164145 163040    ......6 minutes
   0    1154   167151 164150   157165 164040   111117 040150   141166 145040    without IO have
   0    1160   160141 163163   145144 054040   101114 105130   040154 157147    passed, ALEX log
   0    1164   147145 144040   171157 165040   157146 146007   015*** ******    ged you off.....

ACC
 Sect OctLoc
   0    1170   000000 000003   002000 077040   040040 040040   040040 ******    ......?       ..

ACV
 Sect OctLoc
   0    1174   000000 000007   764500 004101   114105 130764   500007 115125    .......ALEX...MU
   0    1200   114123 105116   104740 200006   127101 124123   117116 ******    LSEND...WATSON..

OPENUSER
 Sect OctLoc
   0    1204   000025 777640   001250 006000   000000 177640   000000 006014    ................
   0    1210   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    1250*  000000 000042   000000 001003   252525 010000   000040 252520    ..."......... ..
   0    1254   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:71   
   0    1260   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    1264   251000 622000   000000 000000   000000 100000   111250 000000    ..........@.I...
   0    1270   040040 040040   000000 000000   000000 000000   000000 000000        ............
   0    1274   000000 000000   ****** ******                                    ........

TCM_WRITECG
 Sect OctLoc
   0    1276   000003 777640   001306 006000   000000 177640   000000 006014    ................
   0    1302   000000 177640   000000 006014   000007 777640   001627 006000    ................
   0    1306   000000 400400   000000 000000   000000 000000   020000 000000    ................

TCM_WRITECGBUF
 Sect OctLoc
   0    1312   ****** ******   ****** ******   ****** ******   ****** ******    ................

TCM_WRITEUSER
 Sect OctLoc
   0    1412   000003 777640   001422 006000   000000 177640   000000 006014    ................
   0    1416   000077 777640   001426 006000   000000 177640   000000 006014    .?..............
   0    1422   000000 400400   000000 000000   000000 000000   020000 000000    ................

TCM_WRITEUSERBUF
 Sect OctLoc
   0    1426   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
   0    1526   ****** ******   ****** ******   ****** ******   ****** ******    ................

WRITE_STATION
 Sect OctLoc
   0    1627   115117 104105   115040 040040   040040 040040   040040 040040    MODEM
   0    1633   001000 000000   000000 000000   000000 000000   000000 000000    ................

CMDSTATION
 Sect OctLoc
   0    1637   115117 104105   115040 040040   040040 040040   040040 040040    MODEM
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:72   
   0    1643   041000 000000   000000 000000   000000 000000   000000 000000    !...............

TCM_READCG
 Sect OctLoc
   0    1650   000005 777640   001660 006000   000000 177640   000000 006014    ................
   0    1654   000077 777640   001706 006000   000007 777640   001676 006000    .?..............
   0    1660   000000 000000   000000 000001   000000 000000   020000 000000    ................
   0    1664   000000 000000   000000 000000                                    ........

AUSTATION
 Sect OctLoc
   0    1666   040040 040040   040040 040040   040040 040040   040040 040040
   0    1672   001000 000000   000000 000000   000000 000000   000000 000000    ................

CGSTATION
 Sect OctLoc
   0    1676   115117 104105   115040 040040   040040 040040   040040 040040    MODEM
   0    1702   001000 000000   000000 000000   000000 000000   000000 000000    ................

TCM_READCGBUF
 Sect OctLoc
   0    1706   ****** ******   ****** ******   ****** ******   ****** ******    ................

BIGTBUF
 Sect OctLoc
   0    2006   ****** ******   ****** ******   ****** ******   ****** ******    ................

VLR_CGSTATS
 Sect OctLoc
   0    2110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    2130*  000000 000000   000000 000000                                    ........

FPT_XCON
 Sect OctLoc
   0    2132   000001 777640   002136 006000   000000 777640   002140 006000    .....^.......`..
   0    2136   000000 000000   000000 000000                                    ........

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:73   
TCM_XCON$
 Sect OctLoc
   0    2140   000000 000000                                                    ....

TCM_NORM
 Sect OctLoc
   0    2142   000001 777640   002146 006000   000000 177640   000000 006014    .....f..........
   0    2146   000000 000002   000000 000001                                    ........

TCM_WAIT1
 Sect OctLoc
   0    2150   000001 777640   002154 006000   000000 177640   000000 006014    .....l..........
   0    2154   000000 000001   000000 000001                                    ........

TCM_TAKE5
 Sect OctLoc
   0    2156   000001 777640   002162 006000   000000 177640   000000 006014    .....r..........
   0    2162   000000 000005   000000 000001                                    ........

READSI
 Sect OctLoc
   0    2164   000005 777640   002174 006000   000000 177640   000000 006014    .....|..........
   0    2170   000077 777640   002216 006000   000000 177640   000000 006014    .?..............
   0    2174   000000 400000   000000 000000   000000 000000   000000 000000    ................
   0    2200   000000 000000   000000 000000                                    ........

TCM_WRITEUO
 Sect OctLoc
   0    2202   000003 777640   002212 006000   000000 177640   000000 006014    ................
   0    2206   000077 777640   002316 006000   000000 177640   000000 006014    .?..............
   0    2212   000000 400400   000000 000000   000000 000000   000000 000000    ................

SIBUF
 Sect OctLoc
   0    2216   ****** ******   ****** ******   ****** ******   ****** ******    ................

TCM_UOBUF
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:74   
 Sect OctLoc
   0    2316   ****** ******   ****** ******   ****** ******   ****** ******    ................

READUSER
 Sect OctLoc
   0    2416   000005 777640   002426 006000   000000 177640   000000 006014    ................
   0    2422   000077 777640   002434 006000   000000 177640   000000 006014    .?..............
   0    2426   000000 400000   000000 000000   000000 000000   020000 000000    ................
   0    2432   000000 000000   000000 000000                                    ........

TCM_READUSERBUF
 Sect OctLoc
   0    2434   ****** ******   ****** ******   ****** ******   ****** ******    ................

PROMPTUSER
 Sect OctLoc
   0    2534   000003 777640   002542 006000   000000 177640   000000 006014    ................
   0    2540   000000 177640   000712 006000   000000 000000   000000 000000    ................
   0    2544   100000 000000   000000 000000                                    @.......

PROMPTCG
 Sect OctLoc
   0    2546   000003 777640   002554 006000   000007 777640   001627 006000    ................
   0    2552   000000 177640   000712 006000   000000 000000   000000 000000    ................
   0    2556   100000 000000   000000 000000                                    @.......

(unnamed)
 Sect OctLoc
   0    2560   114157 143141   154072 ******                                    Local:..

EOMCG
 Sect OctLoc
   0    2562   000003 777640   002570 006000   000007 777640   001627 006000    ................
   0    2566   000000 177640   000000 006014   000000 000000   000000 000000    ................
   0    2572   001001 000000   000000 000000                                    ........

VLP_TRMATTR
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:75   
 Sect OctLoc
   0    2574   125125 125125   127125 125377   377377 377137   040040 040040    UUUUWUU...._
   0    2600   040040 040040   040040 040040   040040 040040   377377 177377                ....
   0    2604   377377 377377   377377 377377                                    ........

PARITY
 Sect OctLoc
   0    2606   000001 777640   002614 006000   000000 177640   000000 006014    ................
   0    2612   000011 777640   002616 006000   000000 000000   000000 000000    ................

CHECK_PARITY
 Sect OctLoc
   0    2616   125125 125125   127125 125377   377377 377137   040040 040040    UUUUWUU...._
   0    2622   040040 040040   040040 040040   040040 040040   377377 177377                ....
   0    2626   377377 377377   377377 377377                                    ........

OPENCG
 Sect OctLoc
   6     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
   6     004   000013 777640   000072 006000   000001 577640   000106 006000    .....:.......F..
   6     010   000000 177640   000000 006014   000003 777640   001170 006000    .............x..
   6     014   000007 777640   001174 006000   000000 177640   000000 006014    .....|..........
   6     020   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     024   000001 777640   000110 006000   000000 177640   000000 006014    .....H..........
   6     030   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     044*  000000 400512   000000 003004   252525 000000   000040 252520    ............. ..
   6     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   6     054   000000 000000   000000 000310   000000 000000   000000 000000    ................
   6     060   251000 622000   000000 000000   000000 000000   111310 000000    ............I...
   6     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
   6     070   000000 000000   ****** ******                                    ........

OPENSTA
 Sect OctLoc
   6     072   101114 105130   040040 040040   040040 040040   040040 040040    ALEX
   6     076   040040 040040   040040 040040   000000 000000   040040 040040            ....
   6     102   040040 040040   040040 040040   040040 040040   000000 000000                ....
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:76   

CG_NAME
 Sect OctLoc
   6     106   006101 114105   130103 107***                                    .ALEXCG.

CG_ACCT
 Sect OctLoc
   6     110   072123 131123   124101 103040                                    :SYSTAC

DELCG
 Sect OctLoc
   6     112   000025 777640   000156 006000   000000 177640   000000 006014    .....n..........
   6     116   000000 177640   000000 006014   000001 577640   000106 006000    .............F..
   6     122   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     136*  000001 777640   000110 006000   000000 177640   000000 006014    .....H..........
   6     142   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     156*  000000 440052   000000 002001   252525 000000   000040 252520    ...*......... ..
   6     162   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   6     166   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     172   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   6     176   040040 040040   000000 000000   000000 000000   000000 000000        ............
   6     202   000000 000000   ****** ******                                    ........

TCM_DELETEMES
 Sect OctLoc
   6     204   000015 777640   000240 006000   000017 777640   000256 006000    ................
   6     210   000000 177640   000000 006014   000001 777640   000276 006000    ................
   6     214   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     240*  000000 000000   420000 000000   000000 000000   000000 000000    ................
   6     244   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     254*  000000 000000   000000 000000                                    ........

VLP_CGMA
 Sect OctLoc
   6     256   000000 000000   000000 000000   077040 040040   040040 040040    ........?
   6     262   077040 040040   040040 040040   000000 000000   000000 000000    ?       ........
   6     266   000000 000000   077040 040040   040040 040040   000000 000000    ....?       ....
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:77   
   6     272   000000 000000   000000 000000   000000 000000   000000 000000    ................

VLP_SCGMA
 Sect OctLoc
   6     276   300000 000000   000000 000000                                    ........

INHIBIT_OPERATOR_MESSAGES
 Sect OctLoc
   6     300   000001 777640   000304 006000   000007 777640   001627 006000    ................
   6     304   000000 000000   000000 000000                                    ........

TCM_READCMD
 Sect OctLoc
   6     306   000005 777640   000316 006000   000000 177640   000000 006014    ................
   6     312   000077 777640   001706 006000   000007 777640   001637 006000    .?..............
   6     316   000000 400000   000000 000000   000000 000000   020000 000000    ................
   6     322   000000 000000   000000 000000                                    ........

READAU
 Sect OctLoc
   6     324   000005 777640   000334 006000   000000 177640   000000 006014    ................
   6     330   000077 777640   001706 006000   000007 777640   001666 006000    .?..............
   6     334   000000 000000   000000 000001   000000 000000   000000 000000    ................
   6     340   000000 000000   000000 000000                                    ........

TCM_READCGBIG
 Sect OctLoc
   6     342   000005 777640   000352 006000   000000 177640   000000 006014    ................
   6     346   000077 777640   002006 006000   000000 177640   000000 006014    .?..............
   6     352   000000 400000   000000 000000   000000 000000   000000 000000    ................
   6     356   000000 000000   000000 000000                                    ........

CLOSELO
 Sect OctLoc
   6     360   000003 777640   000412 006000   000000 177640   000000 006014    ................
   6     364   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     410*  000000 177640   000000 006014   000000 000000   000000 000040    ...............
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:78   
   6     414   000220 000000   000000 000000                                    ........

CLOSECG
 Sect OctLoc
   6     416   000003 777640   000450 006000   000000 177640   000000 006014    ................
   6     422   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     446*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   6     452   000220 000000   000000 000000                                    ........

TCM_TURNON
 Sect OctLoc
   6     454   000007 777640   000464 006000   000007 777640   001627 006000    ................
   6     460   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     464   000000 000020   400000 000000   200000 000000   000000 000000    ................
   6     470   040040 040040   000000 000000   000000 000000   000000 000000        ............

TCM_TURNOFF
 Sect OctLoc
   6     474   000007 777640   000504 006000   000007 777640   001627 006000    ................
   6     500   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     504   000000 000000   000000 000000   200000 000000   000000 000000    ................
   6     510   040040 040040   000000 000000   000000 000000   000000 000000        ............

FPT_CGCTL
 Sect OctLoc
   6     514   000013 777640   000564 006000   000000 177640   000000 006014    ................
   6     520   000000 177640   000000 006014   000023 777640   000600 006000    ................
   6     524   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     564*  000000 000022   000000 000000   000000 0000**   000000 000000    ................
   6     570   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     574   000000 000000   000000 000000   000000 000000   ****** ******    ................

VLP_CGCP
 Sect OctLoc
   6     600   040040 040040   040040 040040   040040 040040   040040 040040
   6     604   000002 001001   000046 113177   000031 400721   000000 002000    .....&K.........
   6     610   000024 062000   600036 000214   000000 000000   000012 000024    ..2.............
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:79   
   6     614   000002 ******   000000 000000   000000 000000   000000 000000    ................
   6     620   000000 000000   000000 000000   000000 000000   000000 000000    ................

GET_INFO
 Sect OctLoc
   6     624   000011 777640   000674 006000   000000 177640   000000 006014    ................
   6     630   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     634   000000 177640   000000 006014   000021 777640   002110 006000    .............H..
   6     640   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     674*  000000 000011   000000 000000   000000 000000   000000 000000    ................
   6     700   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     704   000000 000000   ****** ******                                    ........

FPT_EVENT
 Sect OctLoc
   6     706   000001 777640   000710 006000   000000 000000   000000 000000    ................

PCHAR
 Sect OctLoc
   6     712   100*** ******                                                    @...

FPT_TRMATTR
 Sect OctLoc
   6     714   000001 777640   000722 006000   000000 177640   000000 006014    ................
   6     720   000011 777640   002574 006000   000000 000000   000000 000000    ................

(unnamed)
 Sect OctLoc
   6     724   015122 105115   117124 105056   104102 113120   114066 015***    .REMOTE.DBKPL6..
   6     730   116157 040155   157162 145040   156165 155142   145162 163040    No more numbers
   6     734   154145 146164   040164 157040   164162 171054   040111 040147    left to try, I g
   6     740   151166 145040   165160 040040   106101 111114   105104 040040    ive up  FAILED
   6     744   124162 157165   142154 145040   141143 143145   163163 151156    Trouble accessin
   6     750   147040 101114   105130 103107   115157 144145   155040 144145    g ALEXCGModem de
   6     754   166151 143145   040144 151144   040156 157164   040143 157156    vice did not con
   6     760   156145 143164   101124 132040   115157 144145   155040 144157    nectATZ Modem do
   6     764   145163 040156   157164 040162   145163 160157   156144 040040    es not respond
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:80   
   6     770   104151 141154   151156 147040   101124 104124   054073 103061    Dialing ATDT,;C1
   6     774   101124 117040   116117 040103   101122 122111   105122 040040    ATO NO CARRIER
   6    1000   116157 040143   141162 162151   145162 040162   145143 145151    No carrier recei
   6    1004   166145 144040   116103 101122   115117 104105   115040 040040    ved NCARMODEM
   6    1010   115157 144145   155040 162145   160157 162164   145144 040163    Modem reported s
   6    1014   164162 141156   147145 040163   164141 164165   163073 040162    trange status; r
   6    1020   145163 145164   164151 156147   056040 040040   103117 116116    esetting.   CONN
   6    1024   105103 124040   116157 040162   145163 160157   156163 145073    ECT No response;
   6    1030   040162 145163   145164 164151   156147 056040   103157 156156     resetting. Conn
   6    1034   145143 164151   157156 040145   163164 141142   154151 163150    ection establish
   6    1040   145144 056040   124171 160151   156147 040070   163040 040040    ed. Typing 8s
   6    1044   160141 162145   156164 150145   163151 163040   120114 105101    parenthesis PLEA
   6    1050   123105 040040   116157 040162   145163 160157   156163 145040    SE  No response
   6    1054   164157 040070   163040 040040   116122 070040                    to 8s   NR8

(unnamed)
 Sect OctLoc
   8     000   000000 006003   000000 000000   000000 000000   000000 000000    ................
   8     004   777777 777000   001312 006000   045040 040040   046040 040040    ........%   &
   8     010   042040 040040   043040 040040   041040 040040   000573 006000    "   #   !   ....
   8     014   000576 006000   770777 777777                                    ........
      570     2659    1   END TCM$ALEX_CONNECT;
      571     2660        %EOD;

PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:81   
--  Include file information  --

   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_CONNECT.
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:82   

 **** Variables and constants ****

  ****  Section 000  Data  TCM$ALEX_CONNECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1170-0-0/w STRC(126)   r     1 ACC                     1174-0-0/w STRC(270)   r     1 ACV
  1666-0-0/w STRC(288)   r     1 AUSTATION               2006-0-0/c CHAR(256)   r     1 BIGTBUF
  1676-0-0/w STRC(288)   r     1 CGSTATION               2616-0-0/d STRC(360)   r     1 CHECK_PARITY
  1637-0-0/w STRC(288)   r     1 CMDSTATION               532-0-0/c CHAR        r     1 CR
   574-0-0/b UBIN(9)     r     1 EIGHT_TBL(0:4)
   573-0-0/b UBIN(9)     r     1 EIGHT_VAL               2562-0-0/d STRC(360)   r     1 EOMCG
   563-0-0/b BIT         r     1 EPTBL(0:127)               4-0-0/w PTR         r     1 F$CG$
     5-0-0/w PTR         r     1 F$USER$                 2132-0-0/d STRC(216)   r     1 FPT_XCON
   531-0-0/w UBIN        r     1 I                        552-0-0/c STRC(9)     r     1 LA(0:30)
   552-0-0/c CHAR(31)    r     1 LOGON                   1204-0-0/d STRC(2088)  r     1 OPENUSER
   567-0-0/b BIT         r     1 OPTBL(0:127)
   577-0-0/b UBIN(9)     r     1 PAREN_TBL(0:4)
   576-0-0/b UBIN(9)     r     1 PAREN_VAL               2606-0-0/d STRC(288)   r     1 PARITY
   536-0-0/c CHAR(11)    r     1 PHONE                   2546-0-0/d STRC(360)   r     1 PROMPTCG
  2534-0-0/d STRC(360)   r     1 PROMPTUSER              2164-0-0/d STRC(504)   r     1 READSI
  2416-0-0/d STRC(504)   r     1 READUSER                 526-0-0/w UBIN        r     1 RETRY
  2216-0-0/c CHAR(256)   r     1 SIBUF                      6-0-0/c STRC(225)   r     1 SLOG
     2-0-0/d REMB        r     1 TCM_ALEX_BAILOUT
     2-0-0/d BIT (72)    r     1 TCM_ALEX_BAILOUT_ENABLED
  2106-0-0/w UBIN        r     1 TCM_BLEN                  16-0-0/b BIT         r     1 TCM_COMMAND
    24-0-0/b BIT         r     1 TCM_CONNECTED
   563-0-0/b BIT (32)    r     1 TCM_EPTBLI(0:3)
    17-0-0/b BIT         r     1 TCM_EXEC                   1-0-0/w UBIN        r     1 TCM_G_PARITY
    20-0-0/b BIT         r     1 TCM_INT                   21-0-0/b BIT         r     1 TCM_LOCAL
    23-0-0/b BIT         r     1 TCM_LOCALMODE            525-0-0/w UBIN        r     1 TCM_MBLEN
    25-0-0/c CHAR(1280)  r     1 TCM_MODEMBUF              22-0-0/b BIT         r     1 TCM_NEEDREAD
  2142-0-0/d STRC(216)   r     1 TCM_NORM
   567-0-0/b BIT (32)    r     1 TCM_OPTBLI(0:3)
  1001-0-0/c CHAR(332)   r     1 TCM_OUTREC              1650-0-0/d STRC(504)   r     1 TCM_READCG
  1706-0-0/c CHAR(256)   r     1 TCM_READCGBUF           2434-0-0/c CHAR(256)   r     1 TCM_READUSERBUF
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:83   
   534-0-0/c CHAR(8)     r     1 TCM_SITE
   601-0-0/b UBIN(9)     r     1 TCM_STRIPPAR(0:511)
  2156-0-0/d STRC(216)   r     1 TCM_TAKE5               2316-0-0/c CHAR(256)   r     1 TCM_UOBUF
    15-0-0/b BIT         r     1 TCM_USING_PAD           2150-0-0/d STRC(216)   r     1 TCM_WAIT1
  1276-0-0/d STRC(432)   r     1 TCM_WRITECG             1312-0-0/c CHAR(256)   r     1 TCM_WRITECGBUF
  2202-0-0/d STRC(432)   r     1 TCM_WRITEUO             1412-0-0/d STRC(432)   r     1 TCM_WRITEUSER
  1426-0-0/c CHAR(256)   r     1 TCM_WRITEUSERBUF        2140-0-0/w EPTR        r     1 TCM_XCON$
  2574-0-0/d STRC(360)   r     1 VLP_TRMATTR             2110-0-0/d STRC(648)   r     1 VLR_CGSTATS
  1627-0-0/w STRC(288)   r     1 WRITE_STATION

  ****  Section 006 RoData TCM$ALEX_CONNECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   110-0-0/c STRC(72)    r     1 CG_ACCT                  106-0-0/c STRC(63)    r     1 CG_NAME
   416-0-0/d STRC(1080)  r     1 CLOSECG                  360-0-0/d STRC(1080)  r     1 CLOSELO
   112-0-0/d STRC(2088)  r     1 DELCG                    514-0-0/d STRC(1872)  r     1 FPT_CGCTL
   706-0-0/d STRC(144)   r     1 FPT_EVENT                714-0-0/d STRC(288)   r     1 FPT_TRMATTR
   624-0-0/d STRC(1800)  r     1 GET_INFO
   300-0-0/d STRC(216)   r     1 INHIBIT_OPERATOR_MESSAGES
     0-0-0/d STRC(2088)  r     1 OPENCG                    72-0-0/w STRC(432)   r     1 OPENSTA
   712-0-0/c CHAR        r     1 PCHAR                    324-0-0/d STRC(504)   r     1 READAU
   204-0-0/d STRC(1512)  r     1 TCM_DELETEMES            342-0-0/d STRC(504)   r     1 TCM_READCGBIG
   306-0-0/d STRC(504)   r     1 TCM_READCMD              474-0-0/d STRC(576)   r     1 TCM_TURNOFF
   454-0-0/d STRC(576)   r     1 TCM_TURNON               600-0-0/d STRC(720)   r     1 VLP_CGCP
   256-0-0/w STRC(576)   r     1 VLP_CGMA                 276-0-0/d STRC(72)    r     1 VLP_SCGMA

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @BAILOUT                   4-0-0/w PTR         r     1 @PAR
     3-0-0/w PTR         r     1 @SITEIN                    5-0-0/w PTR         r     1 @STATUS
    *0-0-0/d REMB        r     1 BAILOUT                   *0-0-0/w UBIN        r     1 PAR
     7-0-0/w SBIN        r     1 PNR                       *0-0-0/c CHAR(8)     r     1 SITEIN
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:84   
    *0-0-0/w STRC        r     1 STATUS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$
     0-0-0/c CHAR(11)    r     1 TCM_PHONE(0:3)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 BUFC                       0-0-0N  NULL        r     1 F$CG
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 F$UO
     0-0-0N  NULL        r     1 F$USER                     0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC


   Procedure TCM$ALEX_CONNECT requires 719 words for executable code.
   Procedure TCM$ALEX_CONNECT requires 10 words of local(AUTO) storage.
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:85   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:86   
          MINI XREF LISTING

ACC
       878**DCL       750--DCLINIT
ACC.Q
       879**DCL       878--DCLINIT
ACV
       910**DCL       751--DCLINIT
ACV.Q
       911**DCL       910--DCLINIT
AUSTATION
      1573**DCL      1542--DCLINIT
AUSTATION.MSGIDXT
      1583**DCL      1586--REDEF
B$CGAUCRD.CGAUCI.ATTR
       580**DCL       580--REDEF
B$CGAUCRD.STATION
       558**DCL       558--REDEF
B$JIT.CPFLAGS1.SLEAZE
       270**DCL       270--REDEF
B$JIT.ERR.MID
       177**DCL       177--REDEF
B$JIT.JRESPEAK
       338**DCL       339--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       447**DCL       447--REDEF     448--REDEF
B$JIT.PNR
       351**DCL       351--REDEF
B$JIT.TSLINE
       445**DCL       446--REDEF
B$JIT$
       452**DCL       171--IMP-PTR
B$NWIO.CGPARM.MSGIDXT
       490**DCL       493--REDEF
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:87   
B$NWIO.CODE
       459**DCL       459--REDEF     460--REDEF     460--REDEF
B$NWIO.ERR.ERR#
       461**DCL       461--REDEF
B$NWIO.EVID
       460**DCL       460--REDEF     460--REDEF
BADOPEN
      2409**LABEL    2406--CALLALT
BAILOUT
        15**DCL         7--PROC     2358--IF       2360>>ASSIGN
BIGTBUF
      1657**DCL      1637--DCLINIT  1638--DCLINIT
BUFC
      1658**DCL      2514--ASSIGN   2523--ASSIGN   2576--ASSIGN   2612--ASSIGN   2639--ASSIGN   2647--ASSIGN
CANT_CONTINUE
      2413**LABEL    2409--CALLALT  2410--CALLALT
CGSTATION
      1600**DCL      1498--DCLINIT
CGSTATION.MSGIDXT
      1610**DCL      1613--REDEF
CG_ACCT
       864**DCL       753--DCLINIT  1046--DCLINIT
CG_NAME
       849**DCL       749--DCLINIT  1042--DCLINIT
CHECK_PARITY
      2324**DCL      2303--DCLINIT
CHECK_PARITY.PARITY#
      2332**DCL      2656<<ASSIGN
CLOSECG
      1728**DCL      2399<>CALL     2418<>CALL     2475<>CALL     2551<>CALL     2568<>CALL
CLOSECG.SN_
      1728**DCL      1728--REDEF
CLOSECG.UTL_
      1729**DCL      1729--REDEF
CLOSECG.V
      1733**DCL      1728--DCLINIT
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:88   
CLOSECG.V.EXPIRE#
      1743**DCL      1743--REDEF
CLOSECG.V.TYPE#
      1741**DCL      1741--REDEF
CLOSECG.V.XTNSIZE#
      1738**DCL      1738--REDEF    1740--REDEF
CLOSELO.SN_
      1685**DCL      1685--REDEF
CLOSELO.UTL_
      1686**DCL      1686--REDEF
CLOSELO.V
      1690**DCL      1685--DCLINIT
CLOSELO.V.EXPIRE#
      1700**DCL      1700--REDEF
CLOSELO.V.TYPE#
      1698**DCL      1698--REDEF
CLOSELO.V.XTNSIZE#
      1695**DCL      1695--REDEF    1697--REDEF
CMDSTATION
      1382**DCL      1451--DCLINIT
CMDSTATION.MSGIDXT
      1392**DCL      1395--REDEF
CONPRO
      2650**LABEL    2594--GOTO
CR
       627**DCL      2466>>CALLBLT  2509>>CALLBLT  2511>>CALLBLT  2512>>CALLBLT  2520>>CALLBLT  2580>>ASSIGN
      2644>>CALLBLT  2645>>CALLBLT
DELCG
      1041**DCL      2409<>CALL
DELCG.ACSVEH_
      1043**DCL      1044--REDEF
DELCG.ALTKEYS_
      1049**DCL      1050--REDEF    1050--REDEF
DELCG.HDR_
      1048**DCL      1049--REDEF
DELCG.TAB_
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:89   
      1047**DCL      1048--REDEF
DELCG.UHL_
      1041**DCL      1042--REDEF    1042--REDEF
DELCG.V
      1050**DCL      1041--DCLINIT
DELCG.V.FSN#
      1081**DCL      1081--REDEF    1081--REDEF
DELCG.WSN_
      1047**DCL      1047--REDEF
DIAL_NEXT_NUMBER
      2500**LABEL    2405--GOTO
EIGHTS
      2603**LABEL    2585--GOTO
EIGHT_TBL
       646**DCL      2369>>ASSIGN
EIGHT_VAL
       645**DCL      2369<<ASSIGN   2612--ASSIGN
EOMCG
      2206**DCL      2462<>CALL
EOMCG.V
      2214**DCL      2208--DCLINIT
EPTBL
       642**DCL      2488>>ASSIGN
F$CG
       604**DCL      2375--ASSIGN
F$CG$
       608**DCL      2375<<ASSIGN   2398>>IF       2404>>IF
F$DCB.ACTPOS
       134**DCL       134--REDEF
F$DCB.ARS#
       108**DCL       108--REDEF
F$DCB.ATTR
       127**DCL       128--REDEF
F$DCB.BORROW
       142**DCL       142--REDEF     142--REDEF     142--REDEF
F$DCB.DCBNAME.L
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:90   
       156**DCL       156--IMP-SIZ
F$DCB.EOMCHAR#
       112**DCL       112--REDEF
F$DCB.FCD#
       121**DCL      2398>>IF       2404>>IF
F$DCB.FLDID
       137**DCL       137--REDEF
F$DCB.FORM$
       131**DCL       131--REDEF
F$DCB.FSECT
       147**DCL       147--REDEF
F$DCB.FSN#
       124**DCL       124--REDEF     124--REDEF     125--REDEF
F$DCB.HEADER$
       130**DCL       130--REDEF
F$DCB.IXTNSIZE#
       128**DCL       128--REDEF
F$DCB.LASTSTA$
       117**DCL       117--REDEF
F$DCB.LVL
       143**DCL       143--REDEF
F$DCB.NAME#.C
       118**DCL       118--REDEF
F$DCB.NOEOF
       140**DCL       140--REDEF
F$DCB.NRECS#
       129**DCL       129--REDEF
F$DCB.NRECX
       148**DCL       148--REDEF
F$DCB.OHDR
       140**DCL       140--REDEF
F$DCB.ORG#
       123**DCL       123--REDEF
F$DCB.PRECNO
       146**DCL       146--REDEF
F$DCB.RCSZ
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:91   
       152**DCL       152--REDEF
F$DCB.RES#
       119**DCL       119--REDEF
F$DCB.SETX
       131**DCL       131--REDEF
F$DCB.TAB$
       131**DCL       131--REDEF
F$DCB.TDA
       145**DCL       146--REDEF
F$DCB.WSN#
       119**DCL       119--REDEF
F$USER
       606**DCL      2376--ASSIGN
F$USER$
       609**DCL      2376<<ASSIGN
FPT_CGCTL
      1819**DCL      2427<>CALL
FPT_CGCTL.V
      1824**DCL      1819--DCLINIT
FPT_EVENT
      1945**DCL      2374<>CALL
FPT_EVENT.V
      1945**DCL      1945--DCLINIT
FPT_TRMATTR.V
      2242**DCL      2236--DCLINIT
FPT_XCON
      1959**DCL      2465<>CALL
FPT_XCON.V
      1960**DCL      1959--DCLINIT
GET_INFO
      1898**DCL      2437<>CALL
GET_INFO.V
      1903**DCL      1898--DCLINIT
I
       626**DCL      2363<<DOINDEX  2364>>DOINDEX  2364>>DOINDEX  2433<<ASSIGN   2434>>DOUNTIL  2435<<ASSIGN
      2435>>ASSIGN   2485<<DOINDEX  2488>>ASSIGN   2488>>ASSIGN   2490>>ASSIGN   2490>>ASSIGN   2492>>ASSIGN
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:92   
      2494>>ASSIGN   2534<<CALLBLT  2544<<CALLBLT  2555<<CALLBLT  2577<<DOINDEX  2578>>DOSELCT  2596>>ASSIGN
      2618<<CALLBLT  2619>>IF       2620<<CALLBLT  2621>>IF
INHIBIT_OPERATOR_MESSAGES
      1418**DCL      2463<>CALL
INHIBIT_OPERATOR_MESSAGES.V
      1422**DCL      1420--DCLINIT
LA.P
       638**DCL      2488<<ASSIGN   2490<<ASSIGN   2492<<ASSIGN   2494<<ASSIGN
LA.U
       639**DCL      2488>>ASSIGN   2490>>ASSIGN
LOGN
      2644**LABEL    2621--GOTO
LOGON
       635**DCL       636--REDEF    2644>>CALLBLT
LOOP_THROUGH_NUMBERS
      2389**LABEL    2542--GOTO     2553--GOTO     2570--GOTO
M$ACTIVATE
        47**DCL-ENT  2442--CALL     2446--CALL
M$CGCTL
        48**DCL-ENT  2427--CALL
M$CGINFO
        48**DCL-ENT  2437--CALL
M$CLOSE
        27**DCL-ENT  2399--CALL     2418--CALL     2475--CALL     2551--CALL     2568--CALL
M$DEACTIVATE
        47**DCL-ENT  2429--CALL     2444--CALL
M$EOM
        52**DCL-ENT  2462--CALL
M$EVENT
        82**DCL-ENT  2374--CALL
M$FWCG
        48**DCL-ENT  2425--CALL
M$OPEN
        27**DCL-ENT  2387--CALL     2406--CALL     2409--CALL     2410--CALL
M$PROMPT
        51**DCL-ENT  2461--CALL     2481--CALL
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:93   
M$READ
        28**DCL-ENT  2432--CALL     2531--CALL     2615--CALL
M$STRMATTR
        53**DCL-ENT  2657--CALL
M$TRMISC
        56**DCL-ENT  2463--CALL
M$WAIT
        85**DCL-ENT  2436--CALL     2443--CALL     2445--CALL     2507--CALL     2517--CALL     2518--CALL
      2519--CALL     2532--CALL     2552--CALL     2569--CALL     2582--CALL     2616--CALL     2642--CALL
M$WRITE
        28**DCL-ENT  2394--CALL     2415--CALL     2451--CALL     2471--CALL     2503--CALL     2515--CALL
      2524--CALL     2538--CALL     2548--CALL     2565--CALL     2591--CALL     2598--CALL     2605--CALL
      2613--CALL     2628--CALL     2640--CALL     2648--CALL
M$XCON
        82**DCL-ENT  2465--CALL
NOEIGHTS
      2642**LABEL    2587--GOTO
NOWRITE
      2599**LABEL    2583--GOTO
OKP
      2610**LABEL    2619--EXIT
OPENCG
       748**DCL      2406<>CALL     2410<>CALL
OPENCG.ACSVEH_
       750**DCL       751--REDEF
OPENCG.ALTKEYS_
       756**DCL       757--REDEF     757--REDEF
OPENCG.HDR_
       755**DCL       756--REDEF
OPENCG.TAB_
       754**DCL       755--REDEF
OPENCG.UHL_
       748**DCL       749--REDEF     749--REDEF
OPENCG.V
       757**DCL       748--DCLINIT
OPENCG.V.FSN#
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:94   
       788**DCL       788--REDEF     788--REDEF
OPENCG.WSN_
       754**DCL       754--REDEF
OPENSTA
       806**DCL       749--DCLINIT
OPENUSER
      1156**DCL      2387<>CALL
OPENUSER.ACSVEH_
      1158**DCL      1159--REDEF
OPENUSER.ALTKEYS_
      1164**DCL      1165--REDEF    1165--REDEF
OPENUSER.HDR_
      1163**DCL      1164--REDEF
OPENUSER.TAB_
      1162**DCL      1163--REDEF
OPENUSER.UHL_
      1156**DCL      1157--REDEF    1157--REDEF
OPENUSER.V
      1165**DCL      1156--DCLINIT
OPENUSER.V.FSN#
      1196**DCL      1196--REDEF    1196--REDEF
OPENUSER.WSN_
      1162**DCL      1162--REDEF
OPTBL
       644**DCL      2490>>ASSIGN
PAR
        10**DCL         7--PROC     2369>>ASSIGN   2370>>ASSIGN   2371>>ASSIGN
PAREN_TBL
       648**DCL      2371>>ASSIGN
PAREN_VAL
       647**DCL      2371<<ASSIGN   2639--ASSIGN
PARITY
      2297**DCL      2657<>CALL
PARITY.V
      2305**DCL      2299--DCLINIT
PCHAR
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:95   
      2185**DCL      2151--DCLINIT  2179--DCLINIT
PHONE
       630**DCL      2500<<ASSIGN   2501>>CALLBLT  2509>>CALLBLT  2511>>CALLBLT
PNR
       631**DCL      2386<<ASSIGN   2389<<ASSIGN   2389>>ASSIGN   2390>>IF       2500>>ASSIGN
PROMPTCG
      2173**DCL      2461<>CALL
PROMPTCG.V
      2181**DCL      2175--DCLINIT
PROMPTUSER
      2145**DCL      2481<>CALL
PROMPTUSER.V
      2153**DCL      2147--DCLINIT
READAU
      1539**DCL      2432<>CALL
READAU.STATION_
      1542**DCL      1543--REDEF
READAU.V
      1543**DCL      1539--DCLINIT
READAU.V.DVBYTE.REREAD#
      1554**DCL      1554--REDEF
READAU.V.INDX#
      1552**DCL      1552--REDEF
READSI.STATION_
      2036**DCL      2037--REDEF
READSI.V
      2037**DCL      2033--DCLINIT
READSI.V.DVBYTE.REREAD#
      2048**DCL      2048--REDEF
READSI.V.INDX#
      2046**DCL      2046--REDEF
READUSER.STATION_
      2108**DCL      2109--REDEF
READUSER.V
      2109**DCL      2105--DCLINIT
READUSER.V.DVBYTE.REREAD#
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:96   
      2120**DCL      2120--REDEF
READUSER.V.INDX#
      2118**DCL      2118--REDEF
RED
      2529**LABEL    2557--EXIT
RETRY
       623**DCL      2527<<ASSIGN   2529>>DOWHILE  2560<<ASSIGN   2560>>ASSIGN   2562>>IF       2608<<ASSIGN
      2610>>DOWHILE  2623<<ASSIGN   2623>>ASSIGN   2625>>IF
SIBUF
      2086**DCL      2035--DCLINIT  2036--DCLINIT  2483<<ASSIGN
SITEIN
        11**DCL         7--PROC     2362>>ASSIGN
SLOG.LEN
       611**DCL      2384<<ASSIGN   2508>>IF       2516>>IF       2574>>IF       2577>>DOINDEX
SLOG.TEXT
       612**DCL      2385<<ASSIGN   2508>>IF       2516>>IF       2578>>DOSELCT  2596>>ASSIGN
STATUS
        12**DCL         7--PROC     2357<<ASSIGN
TCM$ALEX_DISCONNECT
      2348**DCL-ENT  2455--CALL     2632--CALL
TCM$ALEX_EVNT
      2347**DCL-ENT  1945--DCLINIT
TCM$ALEX_HANGUP
      2353**DCL-ENT  2474--CALL
TCM$ALEX_OK
      2351**DCL-ENT  2468--CALL
TCM$ALEX_XCON
      2350**DCL-ENT  1960--DCLINIT
TCM_ALEX_BAILOUT
        16**DCL        17--REDEF    2360<<ASSIGN   2401>>UNWIND   2420>>UNWIND   2457>>UNWIND   2477>>UNWIND
      2634>>UNWIND
TCM_ALEX_BAILOUT_ENABLED
        17**DCL      2359<<ASSIGN   2400>>IF       2419>>IF       2456>>IF       2476>>IF       2633>>IF
TCM_BLEN
      1659**DCL      1658--IMP-SIZ  2364<<DOINDEX  2365>>ASSIGN   2365>>ASSIGN   2467<<ASSIGN   2512<<CALLBLT
      2513<<ASSIGN   2513>>ASSIGN   2514>>ASSIGN   2522<<ASSIGN   2523>>ASSIGN   2575<<ASSIGN   2576>>ASSIGN
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:97   
      2611<<ASSIGN   2612>>ASSIGN   2638<<ASSIGN   2639>>ASSIGN   2645<<CALLBLT  2646<<ASSIGN   2646>>ASSIGN
      2647>>ASSIGN
TCM_COMMAND
       614**DCL      2431<<ASSIGN   2498<<ASSIGN   2650<<ASSIGN
TCM_CONNECTED
       620**DCL      2373<<ASSIGN   2441<<ASSIGN   2454<<ASSIGN
TCM_DELETEMES
      1217**DCL      2425<>CALL
TCM_DELETEMES.V
      1220**DCL      1217--DCLINIT
TCM_EPTBLI
       641**DCL       642--REDEF
TCM_EXEC
       615**DCL      2655<<ASSIGN
TCM_G_PARITY
        14**DCL      2370<<ASSIGN
TCM_INT
       616**DCL      2424<<ASSIGN   2530<<ASSIGN   2533>>IF       2614<<ASSIGN   2617>>IF
TCM_LOCAL
       617**DCL      2653<<ASSIGN
TCM_LOCALMODE
       619**DCL      2482<<ASSIGN   2521<<ASSIGN   2572<<ASSIGN   2654<<ASSIGN
TCM_MBLEN
       622**DCL      2430<<ASSIGN   2528<<ASSIGN   2534>>CALLBLT  2544>>CALLBLT  2555>>CALLBLT  2573<<ASSIGN
      2609<<ASSIGN   2618>>CALLBLT  2619>>IF       2620>>CALLBLT  2621>>IF
TCM_MODEMBUF
       621**DCL      2534>>CALLBLT  2544>>CALLBLT  2555>>CALLBLT  2618>>CALLBLT  2620>>CALLBLT
TCM_NEEDREAD
       618**DCL      2652<<ASSIGN
TCM_NORM
      1980**DCL      2616<>CALL     2642<>CALL
TCM_NORM.V
      1981**DCL      1980--DCLINIT
TCM_OPTBLI
       643**DCL       644--REDEF
TCM_OUTREC
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:98   
       650**DCL      2361<<ASSIGN   2397<<CALLBLT  2541<<CALLBLT  2631<<CALLBLT
TCM_PHONE
       632**DCL      2390--IF       2390--IF       2500>>ASSIGN
TCM_READCG
      1495**DCL      2531<>CALL     2615<>CALL
TCM_READCG.STATION_
      1498**DCL      1499--REDEF
TCM_READCG.V
      1499**DCL      1495--DCLINIT
TCM_READCG.V.DVBYTE.REREAD#
      1510**DCL      1510--REDEF
TCM_READCG.V.INDX#
      1508**DCL      1508--REDEF
TCM_READCGBIG.STATION_
      1638**DCL      1639--REDEF
TCM_READCGBIG.V
      1639**DCL      1635--DCLINIT
TCM_READCGBIG.V.DVBYTE.REREAD#
      1650**DCL      1650--REDEF
TCM_READCGBIG.V.INDX#
      1648**DCL      1648--REDEF
TCM_READCGBUF
      1615**DCL      1450--DCLINIT  1451--DCLINIT  1497--DCLINIT  1498--DCLINIT  1541--DCLINIT  1542--DCLINIT
TCM_READCMD.STATION_
      1451**DCL      1452--REDEF
TCM_READCMD.V
      1452**DCL      1448--DCLINIT
TCM_READCMD.V.DVBYTE.REREAD#
      1463**DCL      1463--REDEF
TCM_READCMD.V.INDX#
      1461**DCL      1461--REDEF
TCM_READUSERBUF
      2127**DCL      2107--DCLINIT  2108--DCLINIT
TCM_SITE
       629**DCL      2362<<ASSIGN   2397>>CALLBLT  2541>>CALLBLT  2631>>CALLBLT
TCM_STRIPPAR
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:99   
       649**DCL      2365<<ASSIGN
TCM_TAKE5
      2008**DCL      2517<>CALL     2518<>CALL     2519<>CALL     2532<>CALL     2552<>CALL     2569<>CALL
TCM_TAKE5.V
      2009**DCL      2008--DCLINIT
TCM_TURNOFF
      1793**DCL      2429<>CALL     2444<>CALL
TCM_TURNOFF.V
      1794**DCL      1793--DCLINIT
TCM_TURNOFF.V.DVBYTE.REREAD#
      1796**DCL      1796--REDEF
TCM_TURNON
      1764**DCL      2442<>CALL     2446<>CALL
TCM_TURNON.V
      1765**DCL      1764--DCLINIT
TCM_TURNON.V.DVBYTE.REREAD#
      1767**DCL      1767--REDEF
TCM_UOBUF
      2087**DCL      2073--DCLINIT  2074--DCLINIT  2392<<ASSIGN   2413<<ASSIGN   2449<<ASSIGN   2469<<ASSIGN
      2501<<CALLBLT  2536<<ASSIGN   2546<<ASSIGN   2563<<ASSIGN   2589<<ASSIGN   2603<<ASSIGN   2626<<ASSIGN
TCM_USING_PAD
       613**DCL      2372<<ASSIGN
TCM_WAIT1
      1994**DCL      2436<>CALL     2443<>CALL     2445<>CALL     2507<>CALL     2582<>CALL
TCM_WAIT1.V
      1995**DCL      1994--DCLINIT
TCM_WRITECG
      1288**DCL      2515<>CALL     2524<>CALL     2598<>CALL     2613<>CALL     2640<>CALL     2648<>CALL
TCM_WRITECG.BUF_
      1288**DCL      2514<<ASSIGN   2523<<ASSIGN   2576<<ASSIGN   2612<<ASSIGN   2639<<ASSIGN   2647<<ASSIGN
TCM_WRITECG.STATION_
      1290**DCL      1290--REDEF
TCM_WRITECG.V
      1291**DCL      1288--DCLINIT
TCM_WRITECG.V.DVBYTE.VFC#
      1297**DCL      1297--REDEF
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:100  
TCM_WRITECGBUF
      1302**DCL      2466<<CALLBLT  2509<<CALLBLT  2511<<CALLBLT  2512>>CALLBLT  2514--ASSIGN   2520<<CALLBLT
      2523--ASSIGN   2576--ASSIGN   2580<<ASSIGN   2596<<ASSIGN   2644<<CALLBLT  2645>>CALLBLT  2647--ASSIGN
TCM_WRITEUO
      2072**DCL      2394<>CALL     2415<>CALL     2451<>CALL     2471<>CALL     2503<>CALL     2538<>CALL
      2548<>CALL     2565<>CALL     2591<>CALL     2605<>CALL     2628<>CALL
TCM_WRITEUO.STATION_
      2074**DCL      2074--REDEF
TCM_WRITEUO.V
      2075**DCL      2072--DCLINIT
TCM_WRITEUO.V.DVBYTE.VFC#
      2081**DCL      2081--REDEF
TCM_WRITEUSER.STATION_
      1324**DCL      1324--REDEF
TCM_WRITEUSER.V
      1325**DCL      1322--DCLINIT
TCM_WRITEUSER.V.DVBYTE.VFC#
      1331**DCL      1331--REDEF
TCM_WRITEUSERBUF
      1336**DCL      1323--DCLINIT  1324--DCLINIT
TCM_XCON$
      1962**DCL      1959--DCLINIT
VLP_CGCP
      1854**DCL      1820--DCLINIT
VLP_CGCP.DVBYTE.REREAD#
      1868**DCL      1869--REDEF
VLP_CGMA
      1238**DCL      1217--DCLINIT
VLP_CGMA.MSGIDXT
      1247**DCL      1250--REDEF
VLP_SCGMA
      1264**DCL      1218--DCLINIT
VLP_TRMATTR
      2261**DCL      2240--DCLINIT
VLP_TRMATTR.PARITY#
      2269**DCL      2486>>DOCASE
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:101  
VLR_CGSTATS
      1920**DCL      1900--DCLINIT
VLR_CGSTATS.NUMTERMS
      1926**DCL      2434>>DOUNTIL  2439>>IF
WRITE_STATION
      1353**DCL      1290--DCLINIT  1420--DCLINIT  1764--DCLINIT  1793--DCLINIT  2177--DCLINIT  2210--DCLINIT
WRITE_STATION.MSGIDXT
      1363**DCL      1366--REDEF
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:102  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:103  
              MINI UREF LISTING

B$TCB     454**DCL
CMDBUF    1337**DCL
CMDBUFLEN    1338**DCL
CMDI     624**DCL
F$UO     607**DCL
FLAG     640**DCL
INTRO    2352**DCL-ENT
KOZINN    2349**DCL-ENT
LCLPROMPT    2186**DCL
LF     628**DCL
M$ACCT      44**DCL-ENT
M$ALIB      40**DCL-ENT
M$ASUSER      42**DCL-ENT
M$ATTACH      49**DCL-ENT
M$BADPP      67**DCL-ENT
M$CHECK      29**DCL-ENT
M$CHGUNIT      87**DCL-ENT
M$CLRSTK      85**DCL-ENT
M$CMDVAR      96**DCL-ENT
M$CONFIG      57**DCL-ENT
M$CORRES      32**DCL-ENT
M$CPEXIT      41**DCL-ENT
M$CVM      65**DCL-ENT
M$CVOL      30**DCL-ENT
M$DCLFLD      57**DCL-ENT
M$DELREC      29**DCL-ENT
M$DEQ      94**DCL-ENT
M$DETACH      49**DCL-ENT
M$DEVICE      31**DCL-ENT
M$DISPLAY      94**DCL-ENT
M$DISPRES      34**DCL-ENT
M$DLIB      40**DCL-ENT
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:104  
M$DRIBBLE      57**DCL-ENT
M$DRTN      85**DCL-ENT
M$DSUSER      42**DCL-ENT
M$ENQ      93**DCL-ENT
M$ERASE      58**DCL-ENT
M$ERR      39**DCL-ENT
M$ERRMSG      90**DCL-ENT
M$EXHUME      91**DCL-ENT
M$EXIT      39**DCL-ENT
M$EXTEND      31**DCL-ENT
M$FDP      63**DCL-ENT
M$FDS      62**DCL-ENT
M$FEBOOT      55**DCL-ENT
M$FECTL      56**DCL-ENT
M$FEDUMP      55**DCL-ENT
M$FID      90**DCL-ENT
M$FINDPROC      44**DCL-ENT
M$FSUSER      42**DCL-ENT
M$FVP      64**DCL-ENT
M$GBPL      68**DCL-ENT
M$GDDL      64**DCL-ENT
M$GDP      63**DCL-ENT
M$GDS      62**DCL-ENT
M$GETDCB      33**DCL-ENT
M$GETMOUSE      73**DCL-ENT
M$GETPM      74**DCL-ENT
M$GJOB      92**DCL-ENT
M$GLINEATTR      52**DCL-ENT
M$GOODPP      67**DCL-ENT
M$GPLATEN      60**DCL-ENT
M$GPROMPT      59**DCL-ENT
M$GTRMATTR      53**DCL-ENT
M$GTRMCTL      51**DCL-ENT
M$GTRMTAB      54**DCL-ENT
M$GVP      63**DCL-ENT
M$HELP      90**DCL-ENT
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:105  
M$INT      82**DCL-ENT
M$INTRTN      43**DCL-ENT
M$IOQ      78**DCL-ENT
M$JOBSTATS      92**DCL-ENT
M$KEYIN      32**DCL-ENT
M$LDEV      27**DCL-ENT
M$LDTRC      40**DCL-ENT
M$LIMIT      33**DCL-ENT
M$LINES      32**DCL-ENT
M$LINK      39**DCL-ENT
M$MADMUCK      35**DCL-ENT
M$MAKUSER      66**DCL-ENT
M$MBS      34**DCL-ENT
M$MDFFLD      58**DCL-ENT
M$MERC      83**DCL-ENT
M$MERCS      84**DCL-ENT
M$MIRROR      78**DCL-ENT
M$MONINFO      95**DCL-ENT
M$MPL      68**DCL-ENT
M$NODEINFO      59**DCL-ENT
M$NXTUSR      93**DCL-ENT
M$OCMSG      91**DCL-ENT
M$OLAY      39**DCL-ENT
M$PAS      68**DCL-ENT
M$PATHCON      91**DCL-ENT
M$PDS      62**DCL-ENT
M$PFIL      29**DCL-ENT
M$PLATEN      53**DCL-ENT
M$PRECORD      31**DCL-ENT
M$PROCNAME      44**DCL-ENT
M$PROFILE      55**DCL-ENT
M$RACST      35**DCL-ENT
M$RDSYSLOG      76**DCL-ENT
M$RELDCB      33**DCL-ENT
M$RELRES      34**DCL-ENT
M$RELSTARF      36**DCL-ENT
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:106  
M$REM      36**DCL-ENT
M$RENV      83**DCL-ENT
M$REQUIRE      35**DCL-ENT
M$RETRY      84**DCL-ENT
M$RETRYS      84**DCL-ENT
M$REW      30**DCL-ENT
M$RLSFLD      58**DCL-ENT
M$RPRIV      86**DCL-ENT
M$RSPP      65**DCL-ENT
M$RSWITCH      87**DCL-ENT
M$RUE      93**DCL-ENT
M$SAD      66**DCL-ENT
M$SAVE      42**DCL-ENT
M$SCON      43**DCL-ENT
M$SCREECH      41**DCL-ENT
M$SENV      83**DCL-ENT
M$SETFMA      27**DCL-ENT
M$SETFP      56**DCL-ENT
M$SI     605**DCL
M$SINPUT      54**DCL-ENT
M$SLCFLD      59**DCL-ENT
M$SMOUSE      73**DCL-ENT
M$SMPRT      65**DCL-ENT
M$SPRIV      86**DCL-ENT
M$SSC      66**DCL-ENT
M$SSWITCH      86**DCL-ENT
M$STATE      95**DCL-ENT
M$STD      67**DCL-ENT
M$STIMER      81**DCL-ENT
M$STLPP      64**DCL-ENT
M$STRAP      81**DCL-ENT
M$STRMCTL      51**DCL-ENT
M$STRMTAB      54**DCL-ENT
M$SYMBIO      92**DCL-ENT
M$SYSCON      78**DCL-ENT
M$SYSID      96**DCL-ENT
PL6.E3A0      #001=TCM$ALEX_CONNECT File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:15 Page:107  
M$TDCLOSE      77**DCL-ENT
M$TDIO      77**DCL-ENT
M$TDOPEN      76**DCL-ENT
M$TDREQCPU      77**DCL-ENT
M$TEMPWROC      71**DCL-ENT
M$TIME      94**DCL-ENT
M$TRAP      81**DCL-ENT
M$TRMPRG      52**DCL-ENT
M$TRTN      85**DCL-ENT
M$TRUNC      28**DCL-ENT
M$TTIMER      81**DCL-ENT
M$UC      51**DCL
M$UMPL      68**DCL-ENT
M$UNFID      90**DCL-ENT
M$UNLATCH      47**DCL-ENT
M$UNSHARE      44**DCL-ENT
M$USRFIELD      87**DCL-ENT
M$VIRTUAL      62**DCL-ENT
M$WEOF      30**DCL-ENT
M$WRSYSLOG      76**DCL-ENT
M$XCONRTN      43**DCL-ENT
M$XEQTIME      95**DCL-ENT
M$XFLUSH      36**DCL-ENT
M$XMOUSE      73**DCL-ENT
M$XXX      39**DCL-ENT
M$YC      41**DCL-ENT
MODEMREADY    2467**LABEL
OFFMES     657**DCL
PHONE1200     634**DCL
REMOTE_PROGRAM    2346**DCL
TBUF       9**DCL
TCM$ALEX_CONNECT       7**PROC
TCM$ALEX_GOLOCAL    2354**DCL-ENT
TCM_TIMEOUT     625**DCL
WARNMES     651**DCL

PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:108  
      572        1        /*T***********************************************************/
      573        2        /*T*                                                         */
      574        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      575        4        /*T*                                                         */
      576        5        /*T***********************************************************/
      577        6        TCM$ALEX_GOLOCAL: PROC ALTRET;
      578        7        %INCLUDE CP_6;
      579       88        %FPT_WRITE (FPTN=TCM_WRITECG,STCLASS=SYMREF);
      580      119        %FPT_READ (FPTN=TCM_READCG,STCLASS=SYMREF);
      581      158    1   DCL TCM_BLEN UBIN SYMREF;
      582      159    1   DCL TCM_MBLEN UBIN SYMREF;
      583      160        %FPT_WAIT (FPTN=TCM_NORM,STCLASS=SYMREF);
      584      174    1   DCL TCM_LOCAL BIT(1) SYMREF;
      585      175    1   DCL TCM_LOCALMODE BIT(1) SYMREF;
      586      176    1   DCL RETRY UBIN STATIC;
      587      177    1   DCL TCM_COMMAND BIT(1) SYMREF;
      588      178    1   DCL TCM_INT BIT(1) SYMREF;
      589      179    1   DCL CR CHAR(1) STATIC INIT(BINASC(13));
      590      180    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      591      181        %FPT_WAIT (FPTN=TCM_TAKE5,STCLASS=SYMREF);
      592      195    1   DCL I UBIN STATIC;
      593      196    1   DCL TCM_MODEMBUF CHAR(1280) SYMREF;
      594      197    1   DCL TCM_UOBUF CHAR(256) SYMREF;
      595      198    1   DCL TCM_WRITECGBUF CHAR(256) SYMREF;
      596      199        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      597      230        %MACRO WRITEUO;
      598      231             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
      599      232                END;
      600      233        %MEND;
      601      234             %FPT_ACTIVATE(FPTN=TCM_TURNON, STCLASS=SYMREF);
      602      257             %FPT_ACTIVATE(FPTN=TCM_TURNOFF, STCLASS=SYMREF);
      603      280    1   DCL TCM$ALEX_OK ENTRY ALTRET;
      604      281        /* Put modem in local mode */
      605      282    1        TCM_WRITECGBUF='+++';
      606      283    1        TCM_BLEN=3;
      607      284    1        RETRY=0;
      608      285    1        TCM_MBLEN=0;
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:109  
      609      286    1        TCM_COMMAND='1'B;
      610      287    1        CALL M$DEACTIVATE(TCM_TURNOFF);    /* Flush pending */
      611      288    1        CALL M$ACTIVATE(TCM_TURNON);
      612      289    1        CALL M$WAIT(TCM_NORM);
      613      290    2        CALL TCM$ALEX_OK WHENALTRETURN DO;
      614      291    2             CALL CONCAT(TCM_WRITECGBUF,'AT',CR);
      615      292    2             TCM_BLEN=3;
      616      293    3             CALL TCM$ALEX_OK WHENALTRETURN DO;
      617      294    3                  TCM_UOBUF='Modem will not go into local mode.';
      618      295                       %WRITEUO;
      619      299    3                  TCM_LOCAL='0'B;
      620      300    3                  TCM_COMMAND='0'B;
      621      301    3                  ALTRETURN;
      622      302    3                END;
      623      303    2           END;
      624      304    1        TCM_COMMAND='0'B;
      625      305    1        RETURN;
      626      306    1   END TCM$ALEX_GOLOCAL;
      627      307        %EOD;

PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:110  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_GOLOCAL.

   Procedure TCM$ALEX_GOLOCAL requires 48 words for executable code.
   Procedure TCM$ALEX_GOLOCAL requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:111  

 Object Unit name= TCM$ALEX_GOLOCAL                           File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:18:34.64 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     3      3  TCM$ALEX_GOLOCAL
    2  RoData even  UTS     11     13  TCM$ALEX_GOLOCAL
    3   Proc  even  none    48     60  TCM$ALEX_GOLOCAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        0  TCM$ALEX_GOLOCAL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 TCM$ALEX_OK
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:112  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TCM_BLEN                              TCM_MBLEN
     TCM_NORM                              TCM_LOCAL                             TCM_COMMAND
     TCM_UOBUF                             TCM_WRITECGBUF                        TCM_WRITEUO
     TCM_TURNON                            TCM_TURNOFF                           B_VECTNIL
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:113  


      572        1        /*T***********************************************************/
      573        2        /*T*                                                         */
      574        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      575        4        /*T*                                                         */
      576        5        /*T***********************************************************/
      577        6        TCM$ALEX_GOLOCAL: PROC ALTRET;

      6  3 000000   000000 700200 xent  TCM$ALEX_GO* TSX0  ! X66_AUTO_0
         3 000001   000004 000000                    ZERO    4,0

      578        7        %INCLUDE CP_6;
      579       88        %FPT_WRITE (FPTN=TCM_WRITECG,STCLASS=SYMREF);
      580      119        %FPT_READ (FPTN=TCM_READCG,STCLASS=SYMREF);
      581      158    1   DCL TCM_BLEN UBIN SYMREF;
      582      159    1   DCL TCM_MBLEN UBIN SYMREF;
      583      160        %FPT_WAIT (FPTN=TCM_NORM,STCLASS=SYMREF);
      584      174    1   DCL TCM_LOCAL BIT(1) SYMREF;
      585      175    1   DCL TCM_LOCALMODE BIT(1) SYMREF;
      586      176    1   DCL RETRY UBIN STATIC;
      587      177    1   DCL TCM_COMMAND BIT(1) SYMREF;
      588      178    1   DCL TCM_INT BIT(1) SYMREF;
      589      179    1   DCL CR CHAR(1) STATIC INIT(BINASC(13));
      590      180    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      591      181        %FPT_WAIT (FPTN=TCM_TAKE5,STCLASS=SYMREF);
      592      195    1   DCL I UBIN STATIC;
      593      196    1   DCL TCM_MODEMBUF CHAR(1280) SYMREF;
      594      197    1   DCL TCM_UOBUF CHAR(256) SYMREF;
      595      198    1   DCL TCM_WRITECGBUF CHAR(256) SYMREF;
      596      199        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      597      230        %MACRO WRITEUO;
      598      231             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
      599      232                END;
      600      233        %MEND;
      601      234             %FPT_ACTIVATE(FPTN=TCM_TURNON, STCLASS=SYMREF);
      602      257             %FPT_ACTIVATE(FPTN=TCM_TURNOFF, STCLASS=SYMREF);
      603      280    1   DCL TCM$ALEX_OK ENTRY ALTRET;
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:114  
      604      281        /* Put modem in local mode */
      605      282    1        TCM_WRITECGBUF='+++';

    282  3 000002   040000 100400                    MLR     fill='040'O
         3 000003   000000 000003 2                  ADSC9   0                        cn=0,n=3
         3 000004   000000 000400 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=256

      606      283    1        TCM_BLEN=3;

    283  3 000005   000003 235007                    LDA     3,DL
         3 000006   000000 755000 xsym               STA     TCM_BLEN

      607      284    1        RETRY=0;

    284  3 000007   000000 450000 1                  STZ     RETRY

      608      285    1        TCM_MBLEN=0;

    285  3 000010   000000 450000 xsym               STZ     TCM_MBLEN

      609      286    1        TCM_COMMAND='1'B;

    286  3 000011   400000 236003                    LDQ     -131072,DU
         3 000012   000000 756000 xsym               STQ     TCM_COMMAND

      610      287    1        CALL M$DEACTIVATE(TCM_TURNOFF);    /* Flush pending */

    287  3 000013   000000 630400 xsym               EPPR0   TCM_TURNOFF
         3 000014   100001 713400                    CLIMB   32769
         3 000015   401400 401760                    pmme    nvectors=4

      611      288    1        CALL M$ACTIVATE(TCM_TURNON);

    288  3 000016   000000 630400 xsym               EPPR0   TCM_TURNON
         3 000017   100000 713400                    CLIMB   32768
         3 000020   401400 401760                    pmme    nvectors=4

PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:115  
      612      289    1        CALL M$WAIT(TCM_NORM);

    289  3 000021   000000 630400 xsym               EPPR0   TCM_NORM
         3 000022   020006 713400                    CLIMB   8198
         3 000023   400400 401760                    pmme    nvectors=2

      613      290    2        CALL TCM$ALEX_OK WHENALTRETURN DO;

    290  3 000024   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000025   000000 701000 xent               TSX1    TCM$ALEX_OK
         3 000026   000030 702000 3                  TSX2    s:291
         3 000027   000056 710000 3                  TRA     s:304

      614      291    2             CALL CONCAT(TCM_WRITECGBUF,'AT',CR);

    291  3 000030   000001 220000 2                  LDX0    1
         3 000031   000000 740000 xsym               STX0    TCM_WRITECGBUF
         3 000032   040000 100400                    MLR     fill='040'O
         3 000033   000001 000001 1                  ADSC9   CR                       cn=0,n=1
         3 000034   000000 400376 xsym               ADSC9   TCM_WRITECGBUF           cn=2,n=254

      615      292    2             TCM_BLEN=3;

    292  3 000035   000003 235007                    LDA     3,DL
         3 000036   000000 755000 xsym               STA     TCM_BLEN

      616      293    3             CALL TCM$ALEX_OK WHENALTRETURN DO;

    293  3 000037   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000040   000000 701000 xent               TSX1    TCM$ALEX_OK
         3 000041   000043 702000 3                  TSX2    s:294
         3 000042   000056 710000 3                  TRA     s:304

      617      294    3                  TCM_UOBUF='Modem will not go into local mode.';

    294  3 000043   040000 100400                    MLR     fill='040'O
         3 000044   000002 000042 2                  ADSC9   2                        cn=0,n=34
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:116  
         3 000045   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

      618      295                       %WRITEUO;

    296  3 000046   000000 630400 xsym               EPPR0   TCM_WRITEUO
         3 000047   440001 713400                    CLIMB   alt,write
         3 000050   401400 401760                    pmme    nvectors=4
         3 000051   000053 702000 3                  TSX2    s:299
         3 000052   000053 710000 3                  TRA     s:299

      619      299    3                  TCM_LOCAL='0'B;

    299  3 000053   000000 450000 xsym               STZ     TCM_LOCAL

      620      300    3                  TCM_COMMAND='0'B;

    300  3 000054   000000 450000 xsym               STZ     TCM_COMMAND

      621      301    3                  ALTRETURN;

    301  3 000055   000000 702200 xent               TSX2  ! X66_AALT

      622      302    3                END;
      623      303    2           END;

      624      304    1        TCM_COMMAND='0'B;

    304  3 000056   000000 450000 xsym               STZ     TCM_COMMAND

      625      305    1        RETURN;

    305  3 000057   000000 702200 xent               TSX2  ! X66_ARET

CR
 Sect OctLoc
   1     001   015*** ******                                                    ....

PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:117  
(unnamed)
 Sect OctLoc
   2     000   053053 053040   101124 040040   115157 144145   155040 167151    +++ AT  Modem wi
   2     004   154154 040156   157164 040147   157040 151156   164157 040154    ll not go into l
   2     010   157143 141154   040155 157144   145056 040040                    ocal mode.
      626      306    1   END TCM$ALEX_GOLOCAL;
      627      307        %EOD;

PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:118  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_GOLOCAL.
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:119  

 **** Variables and constants ****

  ****  Section 001  Data  TCM$ALEX_GOLOCAL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR        r     1 CR                         0-0-0/w UBIN        r     1 RETRY

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 TCM_BLEN                   0-0-0/b BIT         r     1 TCM_COMMAND
     0-0-0/b BIT         r     1 TCM_LOCAL                  0-0-0/w UBIN        r     1 TCM_MBLEN
     0-0-0/d STRC(216)   r     1 TCM_NORM                   0-0-0/d STRC(576)   r     1 TCM_TURNOFF
     0-0-0/d STRC(576)   r     1 TCM_TURNON                 0-0-0/c CHAR(256)   r     1 TCM_UOBUF
     0-0-0/c CHAR(256)   r     1 TCM_WRITECGBUF             0-0-0/d STRC(432)   r     1 TCM_WRITEUO


   Procedure TCM$ALEX_GOLOCAL requires 48 words for executable code.
   Procedure TCM$ALEX_GOLOCAL requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:120  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:121  
          MINI XREF LISTING

CR
       179**DCL       291>>CALLBLT
M$ACTIVATE
        36**DCL-ENT   288--CALL
M$DEACTIVATE
        36**DCL-ENT   287--CALL
M$WAIT
        74**DCL-ENT   289--CALL
M$WRITE
        17**DCL-ENT   296--CALL
RETRY
       176**DCL       284<<ASSIGN
TCM$ALEX_OK
       280**DCL-ENT   290--CALL      293--CALL
TCM_BLEN
       158**DCL       180--IMP-SIZ   283<<ASSIGN    292<<ASSIGN
TCM_COMMAND
       177**DCL       286<<ASSIGN    300<<ASSIGN    304<<ASSIGN
TCM_LOCAL
       174**DCL       299<<ASSIGN
TCM_MBLEN
       159**DCL       285<<ASSIGN
TCM_NORM
       171**DCL       289<>CALL
TCM_READCG.STATION_
       139**DCL       140--REDEF
TCM_READCG.V.DVBYTE.REREAD#
       151**DCL       151--REDEF
TCM_READCG.V.INDX#
       149**DCL       149--REDEF
TCM_TURNOFF
       268**DCL       287<>CALL
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:122  
TCM_TURNOFF.V.DVBYTE.REREAD#
       271**DCL       271--REDEF
TCM_TURNON
       245**DCL       288<>CALL
TCM_TURNON.V.DVBYTE.REREAD#
       248**DCL       248--REDEF
TCM_UOBUF
       197**DCL       294<<ASSIGN
TCM_WRITECG.STATION_
       107**DCL       107--REDEF
TCM_WRITECG.V.DVBYTE.VFC#
       114**DCL       114--REDEF
TCM_WRITECGBUF
       198**DCL       282<<ASSIGN    291<<CALLBLT
TCM_WRITEUO
       216**DCL       296<>CALL
TCM_WRITEUO.STATION_
       218**DCL       218--REDEF
TCM_WRITEUO.V.DVBYTE.VFC#
       225**DCL       225--REDEF
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:123  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:124  
              MINI UREF LISTING

BUFC     180**DCL
I     195**DCL
M$ACCT      33**DCL-ENT
M$ALIB      29**DCL-ENT
M$ASUSER      31**DCL-ENT
M$ATTACH      38**DCL-ENT
M$BADPP      56**DCL-ENT
M$CGCTL      37**DCL-ENT
M$CGINFO      37**DCL-ENT
M$CHECK      18**DCL-ENT
M$CHGUNIT      76**DCL-ENT
M$CLOSE      16**DCL-ENT
M$CLRSTK      74**DCL-ENT
M$CMDVAR      85**DCL-ENT
M$CONFIG      46**DCL-ENT
M$CORRES      21**DCL-ENT
M$CPEXIT      30**DCL-ENT
M$CVM      54**DCL-ENT
M$CVOL      19**DCL-ENT
M$DCLFLD      46**DCL-ENT
M$DELREC      18**DCL-ENT
M$DEQ      83**DCL-ENT
M$DETACH      38**DCL-ENT
M$DEVICE      20**DCL-ENT
M$DISPLAY      83**DCL-ENT
M$DISPRES      23**DCL-ENT
M$DLIB      29**DCL-ENT
M$DRIBBLE      46**DCL-ENT
M$DRTN      74**DCL-ENT
M$DSUSER      31**DCL-ENT
M$ENQ      82**DCL-ENT
M$EOM      41**DCL-ENT
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:125  
M$ERASE      47**DCL-ENT
M$ERR      28**DCL-ENT
M$ERRMSG      79**DCL-ENT
M$EVENT      71**DCL-ENT
M$EXHUME      80**DCL-ENT
M$EXIT      28**DCL-ENT
M$EXTEND      20**DCL-ENT
M$FDP      52**DCL-ENT
M$FDS      51**DCL-ENT
M$FEBOOT      44**DCL-ENT
M$FECTL      45**DCL-ENT
M$FEDUMP      44**DCL-ENT
M$FID      79**DCL-ENT
M$FINDPROC      33**DCL-ENT
M$FSUSER      31**DCL-ENT
M$FVP      53**DCL-ENT
M$FWCG      37**DCL-ENT
M$GBPL      57**DCL-ENT
M$GDDL      53**DCL-ENT
M$GDP      52**DCL-ENT
M$GDS      51**DCL-ENT
M$GETDCB      22**DCL-ENT
M$GETMOUSE      62**DCL-ENT
M$GETPM      63**DCL-ENT
M$GJOB      81**DCL-ENT
M$GLINEATTR      41**DCL-ENT
M$GOODPP      56**DCL-ENT
M$GPLATEN      49**DCL-ENT
M$GPROMPT      48**DCL-ENT
M$GTRMATTR      42**DCL-ENT
M$GTRMCTL      40**DCL-ENT
M$GTRMTAB      43**DCL-ENT
M$GVP      52**DCL-ENT
M$HELP      79**DCL-ENT
M$INT      71**DCL-ENT
M$INTRTN      32**DCL-ENT
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:126  
M$IOQ      67**DCL-ENT
M$JOBSTATS      81**DCL-ENT
M$KEYIN      21**DCL-ENT
M$LDEV      16**DCL-ENT
M$LDTRC      29**DCL-ENT
M$LIMIT      22**DCL-ENT
M$LINES      21**DCL-ENT
M$LINK      28**DCL-ENT
M$MADMUCK      24**DCL-ENT
M$MAKUSER      55**DCL-ENT
M$MBS      23**DCL-ENT
M$MDFFLD      47**DCL-ENT
M$MERC      72**DCL-ENT
M$MERCS      73**DCL-ENT
M$MIRROR      67**DCL-ENT
M$MONINFO      84**DCL-ENT
M$MPL      57**DCL-ENT
M$NODEINFO      48**DCL-ENT
M$NXTUSR      82**DCL-ENT
M$OCMSG      80**DCL-ENT
M$OLAY      28**DCL-ENT
M$OPEN      16**DCL-ENT
M$PAS      57**DCL-ENT
M$PATHCON      80**DCL-ENT
M$PDS      51**DCL-ENT
M$PFIL      18**DCL-ENT
M$PLATEN      42**DCL-ENT
M$PRECORD      20**DCL-ENT
M$PROCNAME      33**DCL-ENT
M$PROFILE      44**DCL-ENT
M$PROMPT      40**DCL-ENT
M$RACST      24**DCL-ENT
M$RDSYSLOG      65**DCL-ENT
M$READ      17**DCL-ENT
M$RELDCB      22**DCL-ENT
M$RELRES      23**DCL-ENT
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:127  
M$RELSTARF      25**DCL-ENT
M$REM      25**DCL-ENT
M$RENV      72**DCL-ENT
M$REQUIRE      24**DCL-ENT
M$RETRY      73**DCL-ENT
M$RETRYS      73**DCL-ENT
M$REW      19**DCL-ENT
M$RLSFLD      47**DCL-ENT
M$RPRIV      75**DCL-ENT
M$RSPP      54**DCL-ENT
M$RSWITCH      76**DCL-ENT
M$RUE      82**DCL-ENT
M$SAD      55**DCL-ENT
M$SAVE      31**DCL-ENT
M$SCON      32**DCL-ENT
M$SCREECH      30**DCL-ENT
M$SENV      72**DCL-ENT
M$SETFMA      16**DCL-ENT
M$SETFP      45**DCL-ENT
M$SINPUT      43**DCL-ENT
M$SLCFLD      48**DCL-ENT
M$SMOUSE      62**DCL-ENT
M$SMPRT      54**DCL-ENT
M$SPRIV      75**DCL-ENT
M$SSC      55**DCL-ENT
M$SSWITCH      75**DCL-ENT
M$STATE      84**DCL-ENT
M$STD      56**DCL-ENT
M$STIMER      70**DCL-ENT
M$STLPP      53**DCL-ENT
M$STRAP      70**DCL-ENT
M$STRMATTR      42**DCL-ENT
M$STRMCTL      40**DCL-ENT
M$STRMTAB      43**DCL-ENT
M$SYMBIO      81**DCL-ENT
M$SYSCON      67**DCL-ENT
PL6.E3A0      #002=TCM$ALEX_GOLOCAL File=TCM$ALEX2.:TCA2TSI                      SUN 11/16/97 14:18 Page:128  
M$SYSID      85**DCL-ENT
M$TDCLOSE      66**DCL-ENT
M$TDIO      66**DCL-ENT
M$TDOPEN      65**DCL-ENT
M$TDREQCPU      66**DCL-ENT
M$TEMPWROC      60**DCL-ENT
M$TIME      83**DCL-ENT
M$TRAP      70**DCL-ENT
M$TRMISC      45**DCL-ENT
M$TRMPRG      41**DCL-ENT
M$TRTN      74**DCL-ENT
M$TRUNC      17**DCL-ENT
M$TTIMER      70**DCL-ENT
M$UC      40**DCL
M$UMPL      57**DCL-ENT
M$UNFID      79**DCL-ENT
M$UNLATCH      36**DCL-ENT
M$UNSHARE      33**DCL-ENT
M$USRFIELD      76**DCL-ENT
M$VIRTUAL      51**DCL-ENT
M$WEOF      19**DCL-ENT
M$WRSYSLOG      65**DCL-ENT
M$XCON      71**DCL-ENT
M$XCONRTN      32**DCL-ENT
M$XEQTIME      84**DCL-ENT
M$XFLUSH      25**DCL-ENT
M$XMOUSE      62**DCL-ENT
M$XXX      28**DCL-ENT
M$YC      30**DCL-ENT
TCM$ALEX_GOLOCAL       6**PROC
TCM_INT     178**DCL
TCM_LOCALMODE     175**DCL
TCM_MODEMBUF     196**DCL
TCM_TAKE5     192**DCL

PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:129  
      628        1        /*T***********************************************************/
      629        2        /*T*                                                         */
      630        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      631        4        /*T*                                                         */
      632        5        /*T***********************************************************/
      633        6        TCM$ALEX_HANGUP: PROC ALTRET;
      634        7    1   DCL TCM_UOBUF CHAR(256) SYMREF;
      635        8    1   DCL TCM_LOCALMODE BIT(1) SYMREF;
      636        9    1   DCL TCM_COMMAND BIT(1) SYMREF;
      637       10    1   DCL TCM_BLEN UBIN SYMREF;
      638       11    1   DCL TCM_WRITECGBUF CHAR(256) SYMREF;
      639       12    1   DCL CR CHAR(1) STATIC INIT(BINASC(13));
      640       13    1   DCL TCM$ALEX_OK ENTRY ALTRET;
      641       14        %INCLUDE CP_6;
      642       95        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      643      126        %MACRO WRITEUO;
      644      127             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
      645      128                END;
      646      129        %MEND;
      647      130    1   DCL TCM$ALEX_GOLOCAL ENTRY ALTRET;
      648      131    1        TCM_UOBUF='Attempting hangup';
      649      132             %WRITEUO;
      650      136    1        IF not TCM_LOCALMODE THEN CALL TCM$ALEX_GOLOCAL;
      651      137    1        TCM_COMMAND='1'B;
      652      138    1        TCM_BLEN=5;
      653      139    1        CALL CONCAT(TCM_WRITECGBUF,'ATH0',CR);
      654      140    2        CALL TCM$ALEX_OK WHENALTRETURN DO;
      655      141    2             TCM_UOBUF='Modem did not hang up.';
      656      142    2             CALL M$WRITE (TCM_WRITEUO);
      657      143    2             ALTRETURN;
      658      144    2           END;
      659      145    1        TCM_UOBUF='Phone hung up';
      660      146             %WRITEUO;
      661      150    1        RETURN;
      662      151    1   END TCM$ALEX_HANGUP;
      663      152        %EOD;

PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:130  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_HANGUP.

   Procedure TCM$ALEX_HANGUP requires 44 words for executable code.
   Procedure TCM$ALEX_HANGUP requires 4 words of local(AUTO) storage.

PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:131  

 Object Unit name= TCM$ALEX_HANGUP                            File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:18:55.92 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     1      1  TCM$ALEX_HANGUP
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS     16     20  TCM$ALEX_HANGUP
    3   Proc  even  none    44     54  TCM$ALEX_HANGUP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        0  TCM$ALEX_HANGUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 TCM$ALEX_OK
 yes     yes           Std       0 TCM$ALEX_GOLOCAL
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:132  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     TCM_UOBUF                             TCM_LOCALMODE                         TCM_COMMAND
     TCM_BLEN                              TCM_WRITECGBUF                        M$UC
     TCM_WRITEUO                           B_VECTNIL
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:133  


      628        1        /*T***********************************************************/
      629        2        /*T*                                                         */
      630        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      631        4        /*T*                                                         */
      632        5        /*T***********************************************************/
      633        6        TCM$ALEX_HANGUP: PROC ALTRET;

      6  3 000000   000000 700200 xent  TCM$ALEX_HA* TSX0  ! X66_AUTO_0
         3 000001   000004 000000                    ZERO    4,0

      634        7    1   DCL TCM_UOBUF CHAR(256) SYMREF;
      635        8    1   DCL TCM_LOCALMODE BIT(1) SYMREF;
      636        9    1   DCL TCM_COMMAND BIT(1) SYMREF;
      637       10    1   DCL TCM_BLEN UBIN SYMREF;
      638       11    1   DCL TCM_WRITECGBUF CHAR(256) SYMREF;
      639       12    1   DCL CR CHAR(1) STATIC INIT(BINASC(13));
      640       13    1   DCL TCM$ALEX_OK ENTRY ALTRET;
      641       14        %INCLUDE CP_6;
      642       95        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      643      126        %MACRO WRITEUO;
      644      127             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
      645      128                END;
      646      129        %MEND;
      647      130    1   DCL TCM$ALEX_GOLOCAL ENTRY ALTRET;
      648      131    1        TCM_UOBUF='Attempting hangup';

    131  3 000002   040000 100400                    MLR     fill='040'O
         3 000003   000000 000021 2                  ADSC9   0                        cn=0,n=17
         3 000004   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

      649      132             %WRITEUO;

    133  3 000005   000000 630400 xsym               EPPR0   TCM_WRITEUO
         3 000006   440001 713400                    CLIMB   alt,write
         3 000007   401400 401760                    pmme    nvectors=4
         3 000010   000012 702000 3                  TSX2    s:136
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:134  
         3 000011   000012 710000 3                  TRA     s:136

      650      136    1        IF not TCM_LOCALMODE THEN CALL TCM$ALEX_GOLOCAL;

    136  3 000012   000000 234000 xsym               SZN     TCM_LOCALMODE
         3 000013   000017 604000 3                  TMI     s:137

    136  3 000014   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000015   000000 701000 xent               TSX1    TCM$ALEX_GOLOCAL
         3 000016   000000 011000                    NOP     0

      651      137    1        TCM_COMMAND='1'B;

    137  3 000017   400000 236003                    LDQ     -131072,DU
         3 000020   000000 756000 xsym               STQ     TCM_COMMAND

      652      138    1        TCM_BLEN=5;

    138  3 000021   000005 235007                    LDA     5,DL
         3 000022   000000 755000 xsym               STA     TCM_BLEN

      653      139    1        CALL CONCAT(TCM_WRITECGBUF,'ATH0',CR);

    139  3 000023   000005 236000 2                  LDQ     5
         3 000024   000000 756000 xsym               STQ     TCM_WRITECGBUF
         3 000025   040000 100400                    MLR     fill='040'O
         3 000026   000000 000001 0                  ADSC9   CR                       cn=0,n=1
         3 000027   000001 000374 xsym               ADSC9   TCM_WRITECGBUF+1         cn=0,n=252

      654      140    2        CALL TCM$ALEX_OK WHENALTRETURN DO;

    140  3 000030   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000031   000000 701000 xent               TSX1    TCM$ALEX_OK
         3 000032   000034 702000 3                  TSX2    s:141
         3 000033   000043 710000 3                  TRA     s:145

      655      141    2             TCM_UOBUF='Modem did not hang up.';
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:135  

    141  3 000034   040000 100400                    MLR     fill='040'O
         3 000035   000006 000026 2                  ADSC9   6                        cn=0,n=22
         3 000036   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

      656      142    2             CALL M$WRITE (TCM_WRITEUO);

    142  3 000037   000000 630400 xsym               EPPR0   TCM_WRITEUO
         3 000040   040001 713400                    CLIMB   write
         3 000041   401400 401760                    pmme    nvectors=4

      657      143    2             ALTRETURN;

    143  3 000042   000000 702200 xent               TSX2  ! X66_AALT

      658      144    2           END;
      659      145    1        TCM_UOBUF='Phone hung up';

    145  3 000043   040000 100400                    MLR     fill='040'O
         3 000044   000014 000015 2                  ADSC9   12                       cn=0,n=13
         3 000045   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

      660      146             %WRITEUO;

    147  3 000046   000000 630400 xsym               EPPR0   TCM_WRITEUO
         3 000047   440001 713400                    CLIMB   alt,write
         3 000050   401400 401760                    pmme    nvectors=4
         3 000051   000053 702000 3                  TSX2    s:150
         3 000052   000053 710000 3                  TRA     s:150

      661      150    1        RETURN;

    150  3 000053   000000 702200 xent               TSX2  ! X66_ARET

CR
 Sect OctLoc
   0     000   015*** ******                                                    ....
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:136  

(unnamed)
 Sect OctLoc
   2     000   101164 164145   155160 164151   156147 040150   141156 147165    Attempting hangu
   2     004   160040 040040   101124 110060   115157 144145   155040 144151    p   ATH0Modem di
   2     010   144040 156157   164040 150141   156147 040165   160056 040040    d not hang up.
   2     014   120150 157156   145040 150165   156147 040165   160040 040040    Phone hung up
      662      151    1   END TCM$ALEX_HANGUP;
      663      152        %EOD;

PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:137  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_HANGUP.
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:138  

 **** Variables and constants ****

  ****  Section 000  Data  TCM$ALEX_HANGUP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 CR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 TCM_BLEN                   0-0-0/b BIT         r     1 TCM_COMMAND
     0-0-0/b BIT         r     1 TCM_LOCALMODE              0-0-0/c CHAR(256)   r     1 TCM_UOBUF
     0-0-0/c CHAR(256)   r     1 TCM_WRITECGBUF             0-0-0/d STRC(432)   r     1 TCM_WRITEUO


   Procedure TCM$ALEX_HANGUP requires 44 words for executable code.
   Procedure TCM$ALEX_HANGUP requires 4 words of local(AUTO) storage.
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:139  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:140  
          MINI XREF LISTING

CR
        12**DCL       139>>CALLBLT
M$WRITE
        24**DCL-ENT   133--CALL      142--CALL      147--CALL
TCM$ALEX_GOLOCAL
       130**DCL-ENT   136--CALL
TCM$ALEX_OK
        13**DCL-ENT   140--CALL
TCM_BLEN
        10**DCL       138<<ASSIGN
TCM_COMMAND
         9**DCL       137<<ASSIGN
TCM_LOCALMODE
         8**DCL       136>>IF
TCM_UOBUF
         7**DCL       131<<ASSIGN    141<<ASSIGN    145<<ASSIGN
TCM_WRITECGBUF
        11**DCL       139<<CALLBLT
TCM_WRITEUO
       112**DCL       133<>CALL      142<>CALL      147<>CALL
TCM_WRITEUO.STATION_
       114**DCL       114--REDEF
TCM_WRITEUO.V.DVBYTE.VFC#
       121**DCL       121--REDEF
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:141  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:142  
              MINI UREF LISTING

M$ACCT      40**DCL-ENT
M$ACTIVATE      43**DCL-ENT
M$ALIB      36**DCL-ENT
M$ASUSER      38**DCL-ENT
M$ATTACH      45**DCL-ENT
M$BADPP      63**DCL-ENT
M$CGCTL      44**DCL-ENT
M$CGINFO      44**DCL-ENT
M$CHECK      25**DCL-ENT
M$CHGUNIT      83**DCL-ENT
M$CLOSE      23**DCL-ENT
M$CLRSTK      81**DCL-ENT
M$CMDVAR      92**DCL-ENT
M$CONFIG      53**DCL-ENT
M$CORRES      28**DCL-ENT
M$CPEXIT      37**DCL-ENT
M$CVM      61**DCL-ENT
M$CVOL      26**DCL-ENT
M$DCLFLD      53**DCL-ENT
M$DEACTIVATE      43**DCL-ENT
M$DELREC      25**DCL-ENT
M$DEQ      90**DCL-ENT
M$DETACH      45**DCL-ENT
M$DEVICE      27**DCL-ENT
M$DISPLAY      90**DCL-ENT
M$DISPRES      30**DCL-ENT
M$DLIB      36**DCL-ENT
M$DRIBBLE      53**DCL-ENT
M$DRTN      81**DCL-ENT
M$DSUSER      38**DCL-ENT
M$ENQ      89**DCL-ENT
M$EOM      48**DCL-ENT
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:143  
M$ERASE      54**DCL-ENT
M$ERR      35**DCL-ENT
M$ERRMSG      86**DCL-ENT
M$EVENT      78**DCL-ENT
M$EXHUME      87**DCL-ENT
M$EXIT      35**DCL-ENT
M$EXTEND      27**DCL-ENT
M$FDP      59**DCL-ENT
M$FDS      58**DCL-ENT
M$FEBOOT      51**DCL-ENT
M$FECTL      52**DCL-ENT
M$FEDUMP      51**DCL-ENT
M$FID      86**DCL-ENT
M$FINDPROC      40**DCL-ENT
M$FSUSER      38**DCL-ENT
M$FVP      60**DCL-ENT
M$FWCG      44**DCL-ENT
M$GBPL      64**DCL-ENT
M$GDDL      60**DCL-ENT
M$GDP      59**DCL-ENT
M$GDS      58**DCL-ENT
M$GETDCB      29**DCL-ENT
M$GETMOUSE      69**DCL-ENT
M$GETPM      70**DCL-ENT
M$GJOB      88**DCL-ENT
M$GLINEATTR      48**DCL-ENT
M$GOODPP      63**DCL-ENT
M$GPLATEN      56**DCL-ENT
M$GPROMPT      55**DCL-ENT
M$GTRMATTR      49**DCL-ENT
M$GTRMCTL      47**DCL-ENT
M$GTRMTAB      50**DCL-ENT
M$GVP      59**DCL-ENT
M$HELP      86**DCL-ENT
M$INT      78**DCL-ENT
M$INTRTN      39**DCL-ENT
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:144  
M$IOQ      74**DCL-ENT
M$JOBSTATS      88**DCL-ENT
M$KEYIN      28**DCL-ENT
M$LDEV      23**DCL-ENT
M$LDTRC      36**DCL-ENT
M$LIMIT      29**DCL-ENT
M$LINES      28**DCL-ENT
M$LINK      35**DCL-ENT
M$MADMUCK      31**DCL-ENT
M$MAKUSER      62**DCL-ENT
M$MBS      30**DCL-ENT
M$MDFFLD      54**DCL-ENT
M$MERC      79**DCL-ENT
M$MERCS      80**DCL-ENT
M$MIRROR      74**DCL-ENT
M$MONINFO      91**DCL-ENT
M$MPL      64**DCL-ENT
M$NODEINFO      55**DCL-ENT
M$NXTUSR      89**DCL-ENT
M$OCMSG      87**DCL-ENT
M$OLAY      35**DCL-ENT
M$OPEN      23**DCL-ENT
M$PAS      64**DCL-ENT
M$PATHCON      87**DCL-ENT
M$PDS      58**DCL-ENT
M$PFIL      25**DCL-ENT
M$PLATEN      49**DCL-ENT
M$PRECORD      27**DCL-ENT
M$PROCNAME      40**DCL-ENT
M$PROFILE      51**DCL-ENT
M$PROMPT      47**DCL-ENT
M$RACST      31**DCL-ENT
M$RDSYSLOG      72**DCL-ENT
M$READ      24**DCL-ENT
M$RELDCB      29**DCL-ENT
M$RELRES      30**DCL-ENT
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:145  
M$RELSTARF      32**DCL-ENT
M$REM      32**DCL-ENT
M$RENV      79**DCL-ENT
M$REQUIRE      31**DCL-ENT
M$RETRY      80**DCL-ENT
M$RETRYS      80**DCL-ENT
M$REW      26**DCL-ENT
M$RLSFLD      54**DCL-ENT
M$RPRIV      82**DCL-ENT
M$RSPP      61**DCL-ENT
M$RSWITCH      83**DCL-ENT
M$RUE      89**DCL-ENT
M$SAD      62**DCL-ENT
M$SAVE      38**DCL-ENT
M$SCON      39**DCL-ENT
M$SCREECH      37**DCL-ENT
M$SENV      79**DCL-ENT
M$SETFMA      23**DCL-ENT
M$SETFP      52**DCL-ENT
M$SINPUT      50**DCL-ENT
M$SLCFLD      55**DCL-ENT
M$SMOUSE      69**DCL-ENT
M$SMPRT      61**DCL-ENT
M$SPRIV      82**DCL-ENT
M$SSC      62**DCL-ENT
M$SSWITCH      82**DCL-ENT
M$STATE      91**DCL-ENT
M$STD      63**DCL-ENT
M$STIMER      77**DCL-ENT
M$STLPP      60**DCL-ENT
M$STRAP      77**DCL-ENT
M$STRMATTR      49**DCL-ENT
M$STRMCTL      47**DCL-ENT
M$STRMTAB      50**DCL-ENT
M$SYMBIO      88**DCL-ENT
M$SYSCON      74**DCL-ENT
PL6.E3A0      #003=TCM$ALEX_HANGUP File=TCM$ALEX2.:TCA2TSI                       SUN 11/16/97 14:18 Page:146  
M$SYSID      92**DCL-ENT
M$TDCLOSE      73**DCL-ENT
M$TDIO      73**DCL-ENT
M$TDOPEN      72**DCL-ENT
M$TDREQCPU      73**DCL-ENT
M$TEMPWROC      67**DCL-ENT
M$TIME      90**DCL-ENT
M$TRAP      77**DCL-ENT
M$TRMISC      52**DCL-ENT
M$TRMPRG      48**DCL-ENT
M$TRTN      81**DCL-ENT
M$TRUNC      24**DCL-ENT
M$TTIMER      77**DCL-ENT
M$UC      47**DCL
M$UMPL      64**DCL-ENT
M$UNFID      86**DCL-ENT
M$UNLATCH      43**DCL-ENT
M$UNSHARE      40**DCL-ENT
M$USRFIELD      83**DCL-ENT
M$VIRTUAL      58**DCL-ENT
M$WAIT      81**DCL-ENT
M$WEOF      26**DCL-ENT
M$WRSYSLOG      72**DCL-ENT
M$XCON      78**DCL-ENT
M$XCONRTN      39**DCL-ENT
M$XEQTIME      91**DCL-ENT
M$XFLUSH      32**DCL-ENT
M$XMOUSE      69**DCL-ENT
M$XXX      35**DCL-ENT
M$YC      37**DCL-ENT
TCM$ALEX_HANGUP       6**PROC

PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:147  
      664        1        /*T***********************************************************/
      665        2        /*T*                                                         */
      666        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      667        4        /*T*                                                         */
      668        5        /*T***********************************************************/
      669        6        TCM$ALEX_OK: PROC ALTRET;
      670        7    1   DCL TCM_MBLEN UBIN SYMREF;
      671        8    1   DCL I UBIN;
      672        9    1   DCL RETRY UBIN STATIC;
      673       10        %INCLUDE CP_6;
      674       91        %FPT_WRITE(FPTN=TCM_WRITECG,STCLASS=SYMREF);
      675      122        %FPT_READ(FPTN=TCM_READCG,STCLASS=SYMREF);
      676      161        %FPT_WAIT(FPTN=TCM_TAKE5,STCLASS=SYMREF);
      677      175        %FPT_WAIT(FPTN=TCM_WAIT1,STCLASS=STATIC,UNITS=1);
      678      189    1   DCL TCM_INT BIT(1) SYMREF;
      679      190    1   DCL TCM_WRITECGBUF CHAR(256) SYMREF;
      680      191    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      681      192    1   DCL TCM_BLEN UBIN SYMREF;
      682      193    1   DCL TCM_MODEMBUF CHAR(1280) SYMREF;
      683      194        /*  Wait for the entity at the other end to stop sending, so we can
      684      195            speak to the modem in peace.                                    */
      685      196    2        do until(not TCM_INT);
      686      197    2             TCM_INT = '0'B;
      687      198    2             call M$READ (TCM_READCG);
      688      199    3             do inhibit;
      689      200    3                  if not TCM_INT
      690      201    3                  then call M$WAIT (TCM_WAIT1);
      691      202    3                end;
      692      203    2           end;
      693      204        /*  Send command to modem, and await an "OK" response.  Try up
      694      205            to four times.                                                 */
      695      206    1        RETRY=0;
      696      207    1        TCM_MBLEN=0;
      697      208    2   OKT: DO WHILE(RETRY<4);
      698      209    2             TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);
      699      210    2             CALL M$WRITE(TCM_WRITECG);
      700      211    2             TCM_INT='0'B;
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:148  
      701      212    2             CALL M$READ(TCM_READCG);      /* Look for ok */
      702      213    3             do inhibit;
      703      214    3                  if not TCM_INT
      704      215    3                  then call M$WAIT(TCM_TAKE5);
      705      216    3                end;
      706      217    3             IF TCM_INT THEN DO;
      707      218    3                  CALL INDEX(I,'OK',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN));
      708      219    3                  IF I<TCM_MBLEN THEN EXIT OKT;
      709      220    3                END;
      710      221    2             RETRY=RETRY+1;
      711      222    2           END;
      712      223    1        IF RETRY=4 THEN ALTRETURN;
      713      224    1        ELSE RETURN;
      714      225    1   END TCM$ALEX_OK;
      715      226        %EOD;

PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:149  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_OK.

   Procedure TCM$ALEX_OK requires 57 words for executable code.
   Procedure TCM$ALEX_OK requires 4 words of local(AUTO) storage.

PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:150  

 Object Unit name= TCM$ALEX_OK                                File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:19:14.76 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     8     10  TCM$ALEX_OK
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS      1      1  TCM$ALEX_OK
    3   Proc  even  none    57     71  TCM$ALEX_OK
    4  RoData even  none     1      1  TCM$ALEX_OK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        0  TCM$ALEX_OK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:151  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     TCM_MBLEN                             M$UC                                  TCM_WRITECG
     TCM_READCG                            TCM_TAKE5                             TCM_INT
     TCM_WRITECGBUF                        TCM_BLEN                              TCM_MODEMBUF

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:152  


      664        1        /*T***********************************************************/
      665        2        /*T*                                                         */
      666        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      667        4        /*T*                                                         */
      668        5        /*T***********************************************************/
      669        6        TCM$ALEX_OK: PROC ALTRET;

      6  3 000000   000000 700200 xent  TCM$ALEX_OK  TSX0  ! X66_AUTO_0
         3 000001   000004 000000                    ZERO    4,0

      670        7    1   DCL TCM_MBLEN UBIN SYMREF;
      671        8    1   DCL I UBIN;
      672        9    1   DCL RETRY UBIN STATIC;
      673       10        %INCLUDE CP_6;
      674       91        %FPT_WRITE(FPTN=TCM_WRITECG,STCLASS=SYMREF);
      675      122        %FPT_READ(FPTN=TCM_READCG,STCLASS=SYMREF);
      676      161        %FPT_WAIT(FPTN=TCM_TAKE5,STCLASS=SYMREF);
      677      175        %FPT_WAIT(FPTN=TCM_WAIT1,STCLASS=STATIC,UNITS=1);
      678      189    1   DCL TCM_INT BIT(1) SYMREF;
      679      190    1   DCL TCM_WRITECGBUF CHAR(256) SYMREF;
      680      191    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      681      192    1   DCL TCM_BLEN UBIN SYMREF;
      682      193    1   DCL TCM_MODEMBUF CHAR(1280) SYMREF;
      683      194        /*  Wait for the entity at the other end to stop sending, so we can
      684      195            speak to the modem in peace.                                    */
      685      196    2        do until(not TCM_INT);

      686      197    2             TCM_INT = '0'B;

    197  3 000002   000000 450000 xsym               STZ     TCM_INT

      687      198    2             call M$READ (TCM_READCG);

    198  3 000003   000000 630400 xsym               EPPR0   TCM_READCG
         3 000004   040000 713400                    CLIMB   read
         3 000005   401400 401760                    pmme    nvectors=4
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:153  

      688      199    3             do inhibit;

      689      200    3                  if not TCM_INT

    200  3 000006   000000 234200 xsym               SZN   ! TCM_INT
         3 000007   000013 604200 3                  TMI   ! s:203

      690      201    3                  then call M$WAIT (TCM_WAIT1);

    201  3 000010   000002 630600 0                  EPPR0 ! TCM_WAIT1
         3 000011   020006 713600                    CLIMB ! 8198
         3 000012   400400 401760                    pmme    nvectors=2

      691      202    3                end;

      692      203    2           end;

    203  3 000013   000000 234000 xsym               SZN     TCM_INT
         3 000014   000002 604000 3                  TMI     s:197

      693      204        /*  Send command to modem, and await an "OK" response.  Try up
      694      205            to four times.                                                 */
      695      206    1        RETRY=0;

    206  3 000015   000000 450000 0                  STZ     RETRY

      696      207    1        TCM_MBLEN=0;

    207  3 000016   000000 450000 xsym               STZ     TCM_MBLEN

      697      208    2   OKT: DO WHILE(RETRY<4);

    208  3 000017   000000 235000 0     OKT          LDA     RETRY
         3 000020   000004 115007                    CMPA    4,DL
         3 000021   000064 603000 3                  TRC     s:223

PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:154  
      698      209    2             TCM_WRITECG.BUF_=VECTOR(ADDR(TCM_WRITECGBUF)->BUFC);

    209  3 000022   000000 235000 xsym               LDA     TCM_BLEN
         3 000023   000020 735000                    ALS     16
         3 000024   000140 135007                    SBLA    96,DL
         3 000025   000000 236000 4                  LDQ     0
         3 000026   000004 757000 xsym               STAQ    TCM_WRITECG+4

      699      210    2             CALL M$WRITE(TCM_WRITECG);

    210  3 000027   000000 630400 xsym               EPPR0   TCM_WRITECG
         3 000030   040001 713400                    CLIMB   write
         3 000031   401400 401760                    pmme    nvectors=4

      700      211    2             TCM_INT='0'B;

    211  3 000032   000000 450000 xsym               STZ     TCM_INT

      701      212    2             CALL M$READ(TCM_READCG);      /* Look for ok */

    212  3 000033   000000 630400 xsym               EPPR0   TCM_READCG
         3 000034   040000 713400                    CLIMB   read
         3 000035   401400 401760                    pmme    nvectors=4

      702      213    3             do inhibit;

      703      214    3                  if not TCM_INT

    214  3 000036   000000 234200 xsym               SZN   ! TCM_INT
         3 000037   000043 604200 3                  TMI   ! s:217

      704      215    3                  then call M$WAIT(TCM_TAKE5);

    215  3 000040   000000 630600 xsym               EPPR0 ! TCM_TAKE5
         3 000041   020006 713600                    CLIMB ! 8198
         3 000042   400400 401760                    pmme    nvectors=2

PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:155  
      705      216    3                end;

      706      217    3             IF TCM_INT THEN DO;

    217  3 000043   000000 234000 xsym               SZN     TCM_INT
         3 000044   000057 605000 3                  TPL     s:221

      707      218    3                  CALL INDEX(I,'OK',SUBSTR(TCM_MODEMBUF,0,TCM_MBLEN));

    218  3 000045   000000 720000 xsym               LXL0    TCM_MBLEN
         3 000046   000000 120440                    SCD
         3 000047   000000 000010 xsym               ADSC9   TCM_MODEMBUF             cn=0,n=*X0
         3 000050   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 000051   200003 000100                    ARG     I,,AUTO
         3 000052   000054 607000 3                  TTF     s:219
         3 000053   200003 054100                    AOS     I,,AUTO

      708      219    3                  IF I<TCM_MBLEN THEN EXIT OKT;

    219  3 000054   200003 236100                    LDQ     I,,AUTO
         3 000055   000000 116000 xsym               CMPQ    TCM_MBLEN
         3 000056   000064 602000 3                  TNC     s:223

      709      220    3                END;

      710      221    2             RETRY=RETRY+1;

    221  3 000057   000000 235000 0                  LDA     RETRY
         3 000060   000001 035007                    ADLA    1,DL
         3 000061   000000 755000 0                  STA     RETRY

      711      222    2           END;

    222  3 000062   000004 115007                    CMPA    4,DL
         3 000063   000022 602000 3                  TNC     s:209

      712      223    1        IF RETRY=4 THEN ALTRETURN;
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:156  

    223  3 000064   000000 235000 0                  LDA     RETRY
         3 000065   000004 115007                    CMPA    4,DL
         3 000066   000070 601000 3                  TNZ     s:224

    223  3 000067   000000 702200 xent               TSX2  ! X66_AALT

      713      224    1        ELSE RETURN;

    224  3 000070   000000 702200 xent               TSX2  ! X66_ARET

TCM_WAIT1
 Sect OctLoc
   0     002   000001 777640   000006 006000   000000 177640   000000 006014    ................
   0     006   000000 000001   000000 000001                                    ........

(unnamed)
 Sect OctLoc
   2     000   117113 040040                                                    OK

(unnamed)
 Sect OctLoc
   4     000   000000 006000                                                    ....
      714      225    1   END TCM$ALEX_OK;
      715      226        %EOD;

PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:157  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_OK.
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:158  

 **** Variables and constants ****

  ****  Section 000  Data  TCM$ALEX_OK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 RETRY                      2-0-0/d STRC(216)   r     1 TCM_WAIT1

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 I

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 TCM_BLEN                   0-0-0/b BIT         r     1 TCM_INT
     0-0-0/w UBIN        r     1 TCM_MBLEN                  0-0-0/c CHAR(1280)  r     1 TCM_MODEMBUF
     0-0-0/d STRC(504)   r     1 TCM_READCG                 0-0-0/d STRC(216)   r     1 TCM_TAKE5
     0-0-0/d STRC(432)   r     1 TCM_WRITECG                0-0-0/c CHAR(256)   r     1 TCM_WRITECGBUF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 BUFC


   Procedure TCM$ALEX_OK requires 57 words for executable code.
   Procedure TCM$ALEX_OK requires 4 words of local(AUTO) storage.
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:159  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:160  
          MINI XREF LISTING

BUFC
       191**DCL       209--ASSIGN
I
         8**DCL       218<<CALLBLT   219>>IF
M$READ
        20**DCL-ENT   198--CALL      212--CALL
M$WAIT
        77**DCL-ENT   201--CALL      215--CALL
M$WRITE
        20**DCL-ENT   210--CALL
OKT
       208**LABEL     219--EXIT
RETRY
         9**DCL       206<<ASSIGN    208>>DOWHILE   221<<ASSIGN    221>>ASSIGN    223>>IF
TCM_BLEN
       192**DCL       191--IMP-SIZ   209>>ASSIGN
TCM_INT
       189**DCL       196>>DOUNTIL   197<<ASSIGN    200>>IF        211<<ASSIGN    214>>IF        217>>IF
TCM_MBLEN
         7**DCL       207<<ASSIGN    218>>CALLBLT   219>>IF
TCM_MODEMBUF
       193**DCL       218>>CALLBLT
TCM_READCG
       139**DCL       198<>CALL      212<>CALL
TCM_READCG.STATION_
       142**DCL       143--REDEF
TCM_READCG.V.DVBYTE.REREAD#
       154**DCL       154--REDEF
TCM_READCG.V.INDX#
       152**DCL       152--REDEF
TCM_TAKE5
       172**DCL       215<>CALL
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:161  
TCM_WAIT1
       186**DCL       201<>CALL
TCM_WAIT1.V
       187**DCL       186--DCLINIT
TCM_WRITECG
       108**DCL       210<>CALL
TCM_WRITECG.BUF_
       108**DCL       209<<ASSIGN
TCM_WRITECG.STATION_
       110**DCL       110--REDEF
TCM_WRITECG.V.DVBYTE.VFC#
       117**DCL       117--REDEF
TCM_WRITECGBUF
       190**DCL       209--ASSIGN
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:162  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:163  
              MINI UREF LISTING

M$ACCT      36**DCL-ENT
M$ACTIVATE      39**DCL-ENT
M$ALIB      32**DCL-ENT
M$ASUSER      34**DCL-ENT
M$ATTACH      41**DCL-ENT
M$BADPP      59**DCL-ENT
M$CGCTL      40**DCL-ENT
M$CGINFO      40**DCL-ENT
M$CHECK      21**DCL-ENT
M$CHGUNIT      79**DCL-ENT
M$CLOSE      19**DCL-ENT
M$CLRSTK      77**DCL-ENT
M$CMDVAR      88**DCL-ENT
M$CONFIG      49**DCL-ENT
M$CORRES      24**DCL-ENT
M$CPEXIT      33**DCL-ENT
M$CVM      57**DCL-ENT
M$CVOL      22**DCL-ENT
M$DCLFLD      49**DCL-ENT
M$DEACTIVATE      39**DCL-ENT
M$DELREC      21**DCL-ENT
M$DEQ      86**DCL-ENT
M$DETACH      41**DCL-ENT
M$DEVICE      23**DCL-ENT
M$DISPLAY      86**DCL-ENT
M$DISPRES      26**DCL-ENT
M$DLIB      32**DCL-ENT
M$DRIBBLE      49**DCL-ENT
M$DRTN      77**DCL-ENT
M$DSUSER      34**DCL-ENT
M$ENQ      85**DCL-ENT
M$EOM      44**DCL-ENT
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:164  
M$ERASE      50**DCL-ENT
M$ERR      31**DCL-ENT
M$ERRMSG      82**DCL-ENT
M$EVENT      74**DCL-ENT
M$EXHUME      83**DCL-ENT
M$EXIT      31**DCL-ENT
M$EXTEND      23**DCL-ENT
M$FDP      55**DCL-ENT
M$FDS      54**DCL-ENT
M$FEBOOT      47**DCL-ENT
M$FECTL      48**DCL-ENT
M$FEDUMP      47**DCL-ENT
M$FID      82**DCL-ENT
M$FINDPROC      36**DCL-ENT
M$FSUSER      34**DCL-ENT
M$FVP      56**DCL-ENT
M$FWCG      40**DCL-ENT
M$GBPL      60**DCL-ENT
M$GDDL      56**DCL-ENT
M$GDP      55**DCL-ENT
M$GDS      54**DCL-ENT
M$GETDCB      25**DCL-ENT
M$GETMOUSE      65**DCL-ENT
M$GETPM      66**DCL-ENT
M$GJOB      84**DCL-ENT
M$GLINEATTR      44**DCL-ENT
M$GOODPP      59**DCL-ENT
M$GPLATEN      52**DCL-ENT
M$GPROMPT      51**DCL-ENT
M$GTRMATTR      45**DCL-ENT
M$GTRMCTL      43**DCL-ENT
M$GTRMTAB      46**DCL-ENT
M$GVP      55**DCL-ENT
M$HELP      82**DCL-ENT
M$INT      74**DCL-ENT
M$INTRTN      35**DCL-ENT
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:165  
M$IOQ      70**DCL-ENT
M$JOBSTATS      84**DCL-ENT
M$KEYIN      24**DCL-ENT
M$LDEV      19**DCL-ENT
M$LDTRC      32**DCL-ENT
M$LIMIT      25**DCL-ENT
M$LINES      24**DCL-ENT
M$LINK      31**DCL-ENT
M$MADMUCK      27**DCL-ENT
M$MAKUSER      58**DCL-ENT
M$MBS      26**DCL-ENT
M$MDFFLD      50**DCL-ENT
M$MERC      75**DCL-ENT
M$MERCS      76**DCL-ENT
M$MIRROR      70**DCL-ENT
M$MONINFO      87**DCL-ENT
M$MPL      60**DCL-ENT
M$NODEINFO      51**DCL-ENT
M$NXTUSR      85**DCL-ENT
M$OCMSG      83**DCL-ENT
M$OLAY      31**DCL-ENT
M$OPEN      19**DCL-ENT
M$PAS      60**DCL-ENT
M$PATHCON      83**DCL-ENT
M$PDS      54**DCL-ENT
M$PFIL      21**DCL-ENT
M$PLATEN      45**DCL-ENT
M$PRECORD      23**DCL-ENT
M$PROCNAME      36**DCL-ENT
M$PROFILE      47**DCL-ENT
M$PROMPT      43**DCL-ENT
M$RACST      27**DCL-ENT
M$RDSYSLOG      68**DCL-ENT
M$RELDCB      25**DCL-ENT
M$RELRES      26**DCL-ENT
M$RELSTARF      28**DCL-ENT
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:166  
M$REM      28**DCL-ENT
M$RENV      75**DCL-ENT
M$REQUIRE      27**DCL-ENT
M$RETRY      76**DCL-ENT
M$RETRYS      76**DCL-ENT
M$REW      22**DCL-ENT
M$RLSFLD      50**DCL-ENT
M$RPRIV      78**DCL-ENT
M$RSPP      57**DCL-ENT
M$RSWITCH      79**DCL-ENT
M$RUE      85**DCL-ENT
M$SAD      58**DCL-ENT
M$SAVE      34**DCL-ENT
M$SCON      35**DCL-ENT
M$SCREECH      33**DCL-ENT
M$SENV      75**DCL-ENT
M$SETFMA      19**DCL-ENT
M$SETFP      48**DCL-ENT
M$SINPUT      46**DCL-ENT
M$SLCFLD      51**DCL-ENT
M$SMOUSE      65**DCL-ENT
M$SMPRT      57**DCL-ENT
M$SPRIV      78**DCL-ENT
M$SSC      58**DCL-ENT
M$SSWITCH      78**DCL-ENT
M$STATE      87**DCL-ENT
M$STD      59**DCL-ENT
M$STIMER      73**DCL-ENT
M$STLPP      56**DCL-ENT
M$STRAP      73**DCL-ENT
M$STRMATTR      45**DCL-ENT
M$STRMCTL      43**DCL-ENT
M$STRMTAB      46**DCL-ENT
M$SYMBIO      84**DCL-ENT
M$SYSCON      70**DCL-ENT
M$SYSID      88**DCL-ENT
PL6.E3A0      #004=TCM$ALEX_OK File=TCM$ALEX2.:TCA2TSI                           SUN 11/16/97 14:19 Page:167  
M$TDCLOSE      69**DCL-ENT
M$TDIO      69**DCL-ENT
M$TDOPEN      68**DCL-ENT
M$TDREQCPU      69**DCL-ENT
M$TEMPWROC      63**DCL-ENT
M$TIME      86**DCL-ENT
M$TRAP      73**DCL-ENT
M$TRMISC      48**DCL-ENT
M$TRMPRG      44**DCL-ENT
M$TRTN      77**DCL-ENT
M$TRUNC      20**DCL-ENT
M$TTIMER      73**DCL-ENT
M$UC      43**DCL
M$UMPL      60**DCL-ENT
M$UNFID      82**DCL-ENT
M$UNLATCH      39**DCL-ENT
M$UNSHARE      36**DCL-ENT
M$USRFIELD      79**DCL-ENT
M$VIRTUAL      54**DCL-ENT
M$WEOF      22**DCL-ENT
M$WRSYSLOG      68**DCL-ENT
M$XCON      74**DCL-ENT
M$XCONRTN      35**DCL-ENT
M$XEQTIME      87**DCL-ENT
M$XFLUSH      28**DCL-ENT
M$XMOUSE      65**DCL-ENT
M$XXX      31**DCL-ENT
M$YC      33**DCL-ENT
TCM$ALEX_OK       6**PROC

PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:168  
      716        1        /*T***********************************************************/
      717        2        /*T*                                                         */
      718        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      719        4        /*T*                                                         */
      720        5        /*T***********************************************************/
      721        6        TCM$ALEX_EVNT: PROC ASYNC;
      722        7    1   DCL TCM_DEBUG UBIN STATIC SYMDEF INIT(0);
      723        8        %INCLUDE CP_6;
      724       89    1   DCL TCM_BLEN UBIN STATIC;
      725       90    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      726       91    1   DCL TCM_READCGBUF CHAR(256) SYMREF;
      727       92    1   DCL TCM_WRITEUSERBUF CHAR(256) SYMREF;
      728       93    1   DCL TCM_INT BIT(1) ALIGNED SYMREF;
      729       94    1   DCL TCM_NEEDREAD BIT(1) ALIGNED SYMREF;
      730       95    1   DCL TCM_COMMAND BIT(1) ALIGNED SYMREF;
      731       96    1   DCL TCM_EXEC BIT(1) ALIGNED SYMREF;
      732       97    1   DCL TCM_MODEMBUF CHAR(1280) SYMREF;
      733       98    1   DCL TCM_MBLEN UBIN SYMREF;
      734       99    1   DCL TCM_TIMEOUT UBIN SYMREF;
      735      100    1   DCL I UBIN STATIC;
      736      101        %FPT_READ (FPTN=TCM_READCG,STCLASS=SYMREF);
      737      140        %FPT_READ (FPTN=TCM_READCMD,STCLASS=SYMREF);
      738      179        %FPT_WRITE(FPTN=TCM_WRITEUSER,STCLASS=SYMREF);
      739      210        %F$DCB;
      740      267    1   DCL F$CG DCB;
      741      268    1   DCL F$CG$ PTR SYMREF;
      742      269    1   DCL TCM_STRIPPAR CHAR(512) SYMREF;
      743      270    1        IF TCM_MBLEN>SIZEC(TCM_MODEMBUF)-SIZEC(TCM_READCGBUF)-1 THEN TCM_MBLEN=0;
      744      271    1   RLOOP:
      745      272    1        TCM_BLEN=F$CG$->F$DCB.ARS#;
      746      273    2        IF TCM_BLEN>0 THEN DO;
      747      274    2             TCM_TIMEOUT=0;
      748      275    2             TCM_WRITEUSER.BUF_=VECTOR(ADDR(TCM_WRITEUSERBUF)->BUFC);
      749      276    2             IF ~TCM_EXEC THEN CALL XLATE(TCM_WRITEUSERBUF,TCM_STRIPPAR,SUBSTR(
               276                      TCM_READCGBUF,0,TCM_BLEN));
      750      277    2             ELSE TCM_WRITEUSERBUF=TCM_READCGBUF;
      751      278    3             IF ~TCM_COMMAND AND ~TCM_EXEC THEN DO;
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:169  
      752      279    4                  CALL M$WRITE(TCM_WRITEUSER) WHENALTRETURN DO;
      753      280    4                     END;
      754      281    3                  TCM_NEEDREAD='1'B;
      755      282    3                END;
      756      283    3             ELSE DO;
      757      284    4                  IF TCM_DEBUG~=0 THEN DO;
      758      285    5                       CALL M$WRITE(TCM_WRITEUSER) WHENALTRETURN DO;
      759      286    5                          END;
      760      287    4                     END;
      761      288    3                  substr(TCM_MODEMBUF,TCM_MBLEN) = substr(TCM_WRITEUSERBUF,0,TCM_BLEN);
      762      289    3                  TCM_MBLEN=TCM_MBLEN+TCM_BLEN;
      763      290    3                  TCM_INT='1'B;
      764      291    3                  IF TCM_MBLEN>SIZEC(TCM_MODEMBUF)-SIZEC(TCM_READCGBUF)-1 THEN RETURN;
      765      292    3                  CALL M$READ (TCM_READCMD)
      766      293    4                  WHENRETURN DO;
      767      294    4                       GOTO RLOOP;
      768      295    4                     END;
      769      296    4                  WHENALTRETURN DO;
      770      297    4                       TCM_BLEN=F$CG$->F$DCB.ARS#;
      771      298    5                       IF TCM_BLEN=0 THEN DO; /*All done */
      772      299    5                            IF TCM_EXEC THEN TCM_NEEDREAD='1'B;
      773      300    5                            RETURN;
      774      301    5                          END;
      775      302    4                       ELSE GOTO RLOOP;  /*N* GET SMARTER HERE */
      776      303    4                     END;
      777      304    3                END;
      778      305    2           END;
      779      306    1        ELSE IF ~TCM_COMMAND OR TCM_EXEC THEN TCM_NEEDREAD='1'B;
      780      307    1        RETURN;
      781      308    1   END TCM$ALEX_EVNT;
      782      309        %EOD;

PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:170  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_EVNT.

   Procedure TCM$ALEX_EVNT requires 91 words for executable code.
   Procedure TCM$ALEX_EVNT requires 4 words of local(AUTO) storage.

PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:171  

 Object Unit name= TCM$ALEX_EVNT                              File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:19:37.20 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     3      3  TCM$ALEX_EVNT
    1   DCB   even  none     0      0  M$UC
    2   DCB   even  none     0      0  F$CG
    3   Proc  even  none    91    133  TCM$ALEX_EVNT
    4  RoData even  none     1      1  TCM$ALEX_EVNT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes     Async       0  TCM$ALEX_EVNT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  TCM_DEBUG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:172  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TCM_READCGBUF                         TCM_WRITEUSERBUF
     TCM_INT                               TCM_NEEDREAD                          TCM_COMMAND
     TCM_EXEC                              TCM_MODEMBUF                          TCM_MBLEN
     TCM_TIMEOUT                           TCM_READCMD                           TCM_WRITEUSER
     F$CG                                  F$CG$                                 TCM_STRIPPAR

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:173  


      716        1        /*T***********************************************************/
      717        2        /*T*                                                         */
      718        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      719        4        /*T*                                                         */
      720        5        /*T***********************************************************/
      721        6        TCM$ALEX_EVNT: PROC ASYNC;

      6  3 000000   000000 700200 xent  TCM$ALEX_EV* TSX0  ! X66_AAUTO
         3 000001   000004 000000                    ZERO    4,0

      722        7    1   DCL TCM_DEBUG UBIN STATIC SYMDEF INIT(0);
      723        8        %INCLUDE CP_6;
      724       89    1   DCL TCM_BLEN UBIN STATIC;
      725       90    1   DCL BUFC CHAR(TCM_BLEN) BASED;
      726       91    1   DCL TCM_READCGBUF CHAR(256) SYMREF;
      727       92    1   DCL TCM_WRITEUSERBUF CHAR(256) SYMREF;
      728       93    1   DCL TCM_INT BIT(1) ALIGNED SYMREF;
      729       94    1   DCL TCM_NEEDREAD BIT(1) ALIGNED SYMREF;
      730       95    1   DCL TCM_COMMAND BIT(1) ALIGNED SYMREF;
      731       96    1   DCL TCM_EXEC BIT(1) ALIGNED SYMREF;
      732       97    1   DCL TCM_MODEMBUF CHAR(1280) SYMREF;
      733       98    1   DCL TCM_MBLEN UBIN SYMREF;
      734       99    1   DCL TCM_TIMEOUT UBIN SYMREF;
      735      100    1   DCL I UBIN STATIC;
      736      101        %FPT_READ (FPTN=TCM_READCG,STCLASS=SYMREF);
      737      140        %FPT_READ (FPTN=TCM_READCMD,STCLASS=SYMREF);
      738      179        %FPT_WRITE(FPTN=TCM_WRITEUSER,STCLASS=SYMREF);
      739      210        %F$DCB;
      740      267    1   DCL F$CG DCB;
      741      268    1   DCL F$CG$ PTR SYMREF;
      742      269    1   DCL TCM_STRIPPAR CHAR(512) SYMREF;
      743      270    1        IF TCM_MBLEN>SIZEC(TCM_MODEMBUF)-SIZEC(TCM_READCGBUF)-1 THEN TCM_MBLEN=0;

    270  3 000002   000000 235000 xsym               LDA     TCM_MBLEN
         3 000003   002000 115007                    CMPA    1024,DL
         3 000004   000006 602000 3                  TNC     RLOOP
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:174  

    270  3 000005   000000 450000 xsym               STZ     TCM_MBLEN

      744      271    1   RLOOP:
      745      272    1        TCM_BLEN=F$CG$->F$DCB.ARS#;

    272  3 000006   000000 470400 xsym  RLOOP        LDP0    F$CG$
         3 000007   000000 235100                    LDA     0,,PR0
         3 000010   000001 755000 0                  STA     TCM_BLEN

      746      273    2        IF TCM_BLEN>0 THEN DO;

    273  3 000011   000122 600000 3                  TZE     s:306

      747      274    2             TCM_TIMEOUT=0;

    274  3 000012   000000 450000 xsym               STZ     TCM_TIMEOUT

      748      275    2             TCM_WRITEUSER.BUF_=VECTOR(ADDR(TCM_WRITEUSERBUF)->BUFC);

    275  3 000013   000020 735000                    ALS     16
         3 000014   000140 135007                    SBLA    96,DL
         3 000015   000000 236000 4                  LDQ     0
         3 000016   000004 757000 xsym               STAQ    TCM_WRITEUSER+4

      749      276    2             IF ~TCM_EXEC THEN CALL XLATE(TCM_WRITEUSERBUF,TCM_STRIPPAR,SUBSTR(
               276                      TCM_READCGBUF,0,TCM_BLEN));

    276  3 000017   000000 236000 xsym               LDQ     TCM_EXEC
         3 000020   400000 376003                    ANQ     -131072,DU
         3 000021   400000 676003                    ERQ     -131072,DU
         3 000022   000031 600000 3                  TZE     s:277

    276  3 000023   000001 720000 0                  LXL0    TCM_BLEN
         3 000024   040000 160440                    MVT     fill='040'O
         3 000025   000000 000010 xsym               ADSC9   TCM_READCGBUF            cn=0,n=*X0
         3 000026   000000 000400 xsym               ADSC9   TCM_WRITEUSERBUF         cn=0,n=256
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:175  
         3 000027   000000 000000 xsym               ARG     TCM_STRIPPAR
         3 000030   000034 710000 3                  TRA     s:278

      750      277    2             ELSE TCM_WRITEUSERBUF=TCM_READCGBUF;

    277  3 000031   040000 100400                    MLR     fill='040'O
         3 000032   000000 000400 xsym               ADSC9   TCM_READCGBUF            cn=0,n=256
         3 000033   000000 000400 xsym               ADSC9   TCM_WRITEUSERBUF         cn=0,n=256

      751      278    3             IF ~TCM_COMMAND AND ~TCM_EXEC THEN DO;

    278  3 000034   000000 236000 xsym               LDQ     TCM_COMMAND
         3 000035   400000 376003                    ANQ     -131072,DU
         3 000036   400000 676003                    ERQ     -131072,DU
         3 000037   000054 600000 3                  TZE     s:284
         3 000040   000000 236000 xsym               LDQ     TCM_EXEC
         3 000041   400000 376003                    ANQ     -131072,DU
         3 000042   400000 676003                    ERQ     -131072,DU
         3 000043   000054 600000 3                  TZE     s:284

      752      279    4                  CALL M$WRITE(TCM_WRITEUSER) WHENALTRETURN DO;

    279  3 000044   000000 630400 xsym               EPPR0   TCM_WRITEUSER
         3 000045   440001 713400                    CLIMB   alt,write
         3 000046   401400 401760                    pmme    nvectors=4
         3 000047   000051 702000 3                  TSX2    s:281
         3 000050   000051 710000 3                  TRA     s:281

      753      280    4                     END;

      754      281    3                  TCM_NEEDREAD='1'B;

    281  3 000051   400000 236003                    LDQ     -131072,DU
         3 000052   000000 756000 xsym               STQ     TCM_NEEDREAD

      755      282    3                END;

PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:176  
    282  3 000053   000132 710000 3                  TRA     s:307

      756      283    3             ELSE DO;

      757      284    4                  IF TCM_DEBUG~=0 THEN DO;

    284  3 000054   000000 236000 0                  LDQ     TCM_DEBUG
         3 000055   000063 600000 3                  TZE     s:288

      758      285    5                       CALL M$WRITE(TCM_WRITEUSER) WHENALTRETURN DO;

    285  3 000056   000000 630400 xsym               EPPR0   TCM_WRITEUSER
         3 000057   440001 713400                    CLIMB   alt,write
         3 000060   401400 401760                    pmme    nvectors=4
         3 000061   000063 702000 3                  TSX2    s:288
         3 000062   000063 710000 3                  TRA     s:288

      759      286    5                          END;

      760      287    4                     END;

      761      288    3                 substr(TCM_MODEMBUF,TCM_MBLEN) = substr(TCM_WRITEUSERBUF,0,TCM_BLEN);

    288  3 000063   000000 720000 xsym               LXL0    TCM_MBLEN
         3 000064   775377 620010                    EAX0    -1281,X0
         3 000065   777777 660003                    ERX0    -1,DU
         3 000066   000001 721000 0                  LXL1    TCM_BLEN
         3 000067   000000 235000 xsym               LDA     TCM_MBLEN
         3 000070   040045 100440                    MLR     fill='040'O
         3 000071   000000 000011 xsym               ADSC9   TCM_WRITEUSERBUF         cn=0,n=*X1
         3 000072   000000 000010 xsym               ADSC9   TCM_MODEMBUF,A           cn=0,n=*X0

      762      289    3                  TCM_MBLEN=TCM_MBLEN+TCM_BLEN;

    289  3 000073   000000 236000 xsym               LDQ     TCM_MBLEN
         3 000074   000001 036000 0                  ADLQ    TCM_BLEN
         3 000075   000000 756000 xsym               STQ     TCM_MBLEN
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:177  

      763      290    3                  TCM_INT='1'B;

    290  3 000076   400000 236003                    LDQ     -131072,DU
         3 000077   000000 756000 xsym               STQ     TCM_INT

      764      291    3                  IF TCM_MBLEN>SIZEC(TCM_MODEMBUF)-SIZEC(TCM_READCGBUF)-1 THEN RETURN;

    291  3 000100   000000 235000 xsym               LDA     TCM_MBLEN
         3 000101   002000 115007                    CMPA    1024,DL
         3 000102   000104 602000 3                  TNC     s:292

    291  3 000103   000000 702200 xent               TSX2  ! X66_AARET

      765      292    3                  CALL M$READ (TCM_READCMD)

    292  3 000104   000000 630400 xsym               EPPR0   TCM_READCMD
         3 000105   440000 713400                    CLIMB   alt,read
         3 000106   401400 401760                    pmme    nvectors=4
         3 000107   000111 702000 3                  TSX2    s:297

      766      293    4                  WHENRETURN DO;

      767      294    4                       GOTO RLOOP;

    294  3 000110   000006 710000 3                  TRA     RLOOP

      768      295    4                     END;
      769      296    4                  WHENALTRETURN DO;

      770      297    4                       TCM_BLEN=F$CG$->F$DCB.ARS#;

    297  3 000111   000000 470400 xsym               LDP0    F$CG$
         3 000112   000000 235100                    LDA     0,,PR0
         3 000113   000001 755000 0                  STA     TCM_BLEN

      771      298    5                       IF TCM_BLEN=0 THEN DO; /*All done */
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:178  

    298  3 000114   000006 601000 3                  TNZ     RLOOP

      772      299    5                            IF TCM_EXEC THEN TCM_NEEDREAD='1'B;

    299  3 000115   000000 234000 xsym               SZN     TCM_EXEC
         3 000116   000121 605000 3                  TPL     s:300

    299  3 000117   400000 236003                    LDQ     -131072,DU
         3 000120   000000 756000 xsym               STQ     TCM_NEEDREAD

      773      300    5                            RETURN;

    300  3 000121   000000 702200 xent               TSX2  ! X66_AARET

      774      301    5                          END;
      775      302    4                       ELSE GOTO RLOOP;  /*N* GET SMARTER HERE */
      776      303    4                     END;
      777      304    3                END;
      778      305    2           END;
      779      306    1        ELSE IF ~TCM_COMMAND OR TCM_EXEC THEN TCM_NEEDREAD='1'B;

    306  3 000122   000000 236000 xsym               LDQ     TCM_COMMAND
         3 000123   400000 376003                    ANQ     -131072,DU
         3 000124   400000 676003                    ERQ     -131072,DU
         3 000125   000130 601000 3                  TNZ     s:306+6
         3 000126   000000 234000 xsym               SZN     TCM_EXEC
         3 000127   000132 605000 3                  TPL     s:307

    306  3 000130   400000 236003                    LDQ     -131072,DU
         3 000131   000000 756000 xsym               STQ     TCM_NEEDREAD

      780      307    1        RETURN;

    307  3 000132   000000 702200 xent               TSX2  ! X66_AARET

TCM_DEBUG
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:179  
 Sect OctLoc
   0     000   000000 000000                                                    ....

(unnamed)
 Sect OctLoc
   4     000   000000 006000                                                    ....
      781      308    1   END TCM$ALEX_EVNT;
      782      309        %EOD;

PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:180  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_EVNT.
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:181  

 **** Variables and constants ****

  ****  Section 000  Data  TCM$ALEX_EVNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w UBIN        r     1 TCM_BLEN                   0-0-0/w UBIN        r     1 TCM_DEBUG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 F$CG$                      0-0-0/w BIT         r     1 TCM_COMMAND
     0-0-0/w BIT         r     1 TCM_EXEC                   0-0-0/w BIT         r     1 TCM_INT
     0-0-0/w UBIN        r     1 TCM_MBLEN                  0-0-0/c CHAR(1280)  r     1 TCM_MODEMBUF
     0-0-0/w BIT         r     1 TCM_NEEDREAD               0-0-0/c CHAR(256)   r     1 TCM_READCGBUF
     0-0-0/d STRC(504)   r     1 TCM_READCMD                0-0-0/c CHAR(512)   r     1 TCM_STRIPPAR
     0-0-0/w UBIN        r     1 TCM_TIMEOUT                0-0-0/d STRC(432)   r     1 TCM_WRITEUSER
     0-0-0/c CHAR(256)   r     1 TCM_WRITEUSERBUF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 BUFC                       0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure TCM$ALEX_EVNT requires 91 words for executable code.
   Procedure TCM$ALEX_EVNT requires 4 words of local(AUTO) storage.
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:182  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:183  
          MINI XREF LISTING

BUFC
        90**DCL       275--ASSIGN
F$CG$
       268**DCL       272>>ASSIGN    297>>ASSIGN
F$DCB.ACTPOS
       243**DCL       243--REDEF
F$DCB.ARS#
       217**DCL       217--REDEF     272>>ASSIGN    297>>ASSIGN
F$DCB.ATTR
       236**DCL       237--REDEF
F$DCB.BORROW
       251**DCL       251--REDEF     251--REDEF     251--REDEF
F$DCB.DCBNAME.L
       265**DCL       265--IMP-SIZ
F$DCB.EOMCHAR#
       221**DCL       221--REDEF
F$DCB.FLDID
       246**DCL       246--REDEF
F$DCB.FORM$
       240**DCL       240--REDEF
F$DCB.FSECT
       256**DCL       256--REDEF
F$DCB.FSN#
       233**DCL       233--REDEF     233--REDEF     234--REDEF
F$DCB.HEADER$
       239**DCL       239--REDEF
F$DCB.IXTNSIZE#
       237**DCL       237--REDEF
F$DCB.LASTSTA$
       226**DCL       226--REDEF
F$DCB.LVL
       252**DCL       252--REDEF
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:184  
F$DCB.NAME#.C
       227**DCL       227--REDEF
F$DCB.NOEOF
       249**DCL       249--REDEF
F$DCB.NRECS#
       238**DCL       238--REDEF
F$DCB.NRECX
       257**DCL       257--REDEF
F$DCB.OHDR
       249**DCL       249--REDEF
F$DCB.ORG#
       232**DCL       232--REDEF
F$DCB.PRECNO
       255**DCL       255--REDEF
F$DCB.RCSZ
       261**DCL       261--REDEF
F$DCB.RES#
       228**DCL       228--REDEF
F$DCB.SETX
       240**DCL       240--REDEF
F$DCB.TAB$
       240**DCL       240--REDEF
F$DCB.TDA
       254**DCL       255--REDEF
F$DCB.WSN#
       228**DCL       228--REDEF
M$READ
        18**DCL-ENT   292--CALL
M$WRITE
        18**DCL-ENT   279--CALL      285--CALL
RLOOP
       272**LABEL     294--GOTO      302--GOTO
TCM_BLEN
        89**DCL        90--IMP-SIZ   272<<ASSIGN    273>>IF        275>>ASSIGN    276>>CALLBLT   288>>ASSIGN
       289>>ASSIGN    297<<ASSIGN    298>>IF
TCM_COMMAND
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:185  
        95**DCL       278>>IF        306>>IF
TCM_DEBUG
         7**DCL       284>>IF
TCM_EXEC
        96**DCL       276>>IF        278>>IF        299>>IF        306>>IF
TCM_INT
        93**DCL       290<<ASSIGN
TCM_MBLEN
        98**DCL       270>>IF        270<<ASSIGN    288>>ASSIGN    289<<ASSIGN    289>>ASSIGN    291>>IF
TCM_MODEMBUF
        97**DCL       270--IF        288<<ASSIGN    291--IF
TCM_NEEDREAD
        94**DCL       281<<ASSIGN    299<<ASSIGN    306<<ASSIGN
TCM_READCG.STATION_
       121**DCL       122--REDEF
TCM_READCG.V.DVBYTE.REREAD#
       133**DCL       133--REDEF
TCM_READCG.V.INDX#
       131**DCL       131--REDEF
TCM_READCGBUF
        91**DCL       270--IF        276>>CALLBLT   277>>ASSIGN    291--IF
TCM_READCMD
       157**DCL       292<>CALL
TCM_READCMD.STATION_
       160**DCL       161--REDEF
TCM_READCMD.V.DVBYTE.REREAD#
       172**DCL       172--REDEF
TCM_READCMD.V.INDX#
       170**DCL       170--REDEF
TCM_STRIPPAR
       269**DCL       276>>CALLBLT
TCM_TIMEOUT
        99**DCL       274<<ASSIGN
TCM_WRITEUSER
       196**DCL       279<>CALL      285<>CALL
TCM_WRITEUSER.BUF_
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:186  
       196**DCL       275<<ASSIGN
TCM_WRITEUSER.STATION_
       198**DCL       198--REDEF
TCM_WRITEUSER.V.DVBYTE.VFC#
       205**DCL       205--REDEF
TCM_WRITEUSERBUF
        92**DCL       275--ASSIGN    276<<CALLBLT   277<<ASSIGN    288>>ASSIGN
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:187  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:188  
              MINI UREF LISTING

F$CG     267**DCL
I     100**DCL
M$ACCT      34**DCL-ENT
M$ACTIVATE      37**DCL-ENT
M$ALIB      30**DCL-ENT
M$ASUSER      32**DCL-ENT
M$ATTACH      39**DCL-ENT
M$BADPP      57**DCL-ENT
M$CGCTL      38**DCL-ENT
M$CGINFO      38**DCL-ENT
M$CHECK      19**DCL-ENT
M$CHGUNIT      77**DCL-ENT
M$CLOSE      17**DCL-ENT
M$CLRSTK      75**DCL-ENT
M$CMDVAR      86**DCL-ENT
M$CONFIG      47**DCL-ENT
M$CORRES      22**DCL-ENT
M$CPEXIT      31**DCL-ENT
M$CVM      55**DCL-ENT
M$CVOL      20**DCL-ENT
M$DCLFLD      47**DCL-ENT
M$DEACTIVATE      37**DCL-ENT
M$DELREC      19**DCL-ENT
M$DEQ      84**DCL-ENT
M$DETACH      39**DCL-ENT
M$DEVICE      21**DCL-ENT
M$DISPLAY      84**DCL-ENT
M$DISPRES      24**DCL-ENT
M$DLIB      30**DCL-ENT
M$DRIBBLE      47**DCL-ENT
M$DRTN      75**DCL-ENT
M$DSUSER      32**DCL-ENT
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:189  
M$ENQ      83**DCL-ENT
M$EOM      42**DCL-ENT
M$ERASE      48**DCL-ENT
M$ERR      29**DCL-ENT
M$ERRMSG      80**DCL-ENT
M$EVENT      72**DCL-ENT
M$EXHUME      81**DCL-ENT
M$EXIT      29**DCL-ENT
M$EXTEND      21**DCL-ENT
M$FDP      53**DCL-ENT
M$FDS      52**DCL-ENT
M$FEBOOT      45**DCL-ENT
M$FECTL      46**DCL-ENT
M$FEDUMP      45**DCL-ENT
M$FID      80**DCL-ENT
M$FINDPROC      34**DCL-ENT
M$FSUSER      32**DCL-ENT
M$FVP      54**DCL-ENT
M$FWCG      38**DCL-ENT
M$GBPL      58**DCL-ENT
M$GDDL      54**DCL-ENT
M$GDP      53**DCL-ENT
M$GDS      52**DCL-ENT
M$GETDCB      23**DCL-ENT
M$GETMOUSE      63**DCL-ENT
M$GETPM      64**DCL-ENT
M$GJOB      82**DCL-ENT
M$GLINEATTR      42**DCL-ENT
M$GOODPP      57**DCL-ENT
M$GPLATEN      50**DCL-ENT
M$GPROMPT      49**DCL-ENT
M$GTRMATTR      43**DCL-ENT
M$GTRMCTL      41**DCL-ENT
M$GTRMTAB      44**DCL-ENT
M$GVP      53**DCL-ENT
M$HELP      80**DCL-ENT
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:190  
M$INT      72**DCL-ENT
M$INTRTN      33**DCL-ENT
M$IOQ      68**DCL-ENT
M$JOBSTATS      82**DCL-ENT
M$KEYIN      22**DCL-ENT
M$LDEV      17**DCL-ENT
M$LDTRC      30**DCL-ENT
M$LIMIT      23**DCL-ENT
M$LINES      22**DCL-ENT
M$LINK      29**DCL-ENT
M$MADMUCK      25**DCL-ENT
M$MAKUSER      56**DCL-ENT
M$MBS      24**DCL-ENT
M$MDFFLD      48**DCL-ENT
M$MERC      73**DCL-ENT
M$MERCS      74**DCL-ENT
M$MIRROR      68**DCL-ENT
M$MONINFO      85**DCL-ENT
M$MPL      58**DCL-ENT
M$NODEINFO      49**DCL-ENT
M$NXTUSR      83**DCL-ENT
M$OCMSG      81**DCL-ENT
M$OLAY      29**DCL-ENT
M$OPEN      17**DCL-ENT
M$PAS      58**DCL-ENT
M$PATHCON      81**DCL-ENT
M$PDS      52**DCL-ENT
M$PFIL      19**DCL-ENT
M$PLATEN      43**DCL-ENT
M$PRECORD      21**DCL-ENT
M$PROCNAME      34**DCL-ENT
M$PROFILE      45**DCL-ENT
M$PROMPT      41**DCL-ENT
M$RACST      25**DCL-ENT
M$RDSYSLOG      66**DCL-ENT
M$RELDCB      23**DCL-ENT
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:191  
M$RELRES      24**DCL-ENT
M$RELSTARF      26**DCL-ENT
M$REM      26**DCL-ENT
M$RENV      73**DCL-ENT
M$REQUIRE      25**DCL-ENT
M$RETRY      74**DCL-ENT
M$RETRYS      74**DCL-ENT
M$REW      20**DCL-ENT
M$RLSFLD      48**DCL-ENT
M$RPRIV      76**DCL-ENT
M$RSPP      55**DCL-ENT
M$RSWITCH      77**DCL-ENT
M$RUE      83**DCL-ENT
M$SAD      56**DCL-ENT
M$SAVE      32**DCL-ENT
M$SCON      33**DCL-ENT
M$SCREECH      31**DCL-ENT
M$SENV      73**DCL-ENT
M$SETFMA      17**DCL-ENT
M$SETFP      46**DCL-ENT
M$SINPUT      44**DCL-ENT
M$SLCFLD      49**DCL-ENT
M$SMOUSE      63**DCL-ENT
M$SMPRT      55**DCL-ENT
M$SPRIV      76**DCL-ENT
M$SSC      56**DCL-ENT
M$SSWITCH      76**DCL-ENT
M$STATE      85**DCL-ENT
M$STD      57**DCL-ENT
M$STIMER      71**DCL-ENT
M$STLPP      54**DCL-ENT
M$STRAP      71**DCL-ENT
M$STRMATTR      43**DCL-ENT
M$STRMCTL      41**DCL-ENT
M$STRMTAB      44**DCL-ENT
M$SYMBIO      82**DCL-ENT
PL6.E3A0      #005=TCM$ALEX_EVNT File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:19 Page:192  
M$SYSCON      68**DCL-ENT
M$SYSID      86**DCL-ENT
M$TDCLOSE      67**DCL-ENT
M$TDIO      67**DCL-ENT
M$TDOPEN      66**DCL-ENT
M$TDREQCPU      67**DCL-ENT
M$TEMPWROC      61**DCL-ENT
M$TIME      84**DCL-ENT
M$TRAP      71**DCL-ENT
M$TRMISC      46**DCL-ENT
M$TRMPRG      42**DCL-ENT
M$TRTN      75**DCL-ENT
M$TRUNC      18**DCL-ENT
M$TTIMER      71**DCL-ENT
M$UC      41**DCL
M$UMPL      58**DCL-ENT
M$UNFID      80**DCL-ENT
M$UNLATCH      37**DCL-ENT
M$UNSHARE      34**DCL-ENT
M$USRFIELD      77**DCL-ENT
M$VIRTUAL      52**DCL-ENT
M$WAIT      75**DCL-ENT
M$WEOF      20**DCL-ENT
M$WRSYSLOG      66**DCL-ENT
M$XCON      72**DCL-ENT
M$XCONRTN      33**DCL-ENT
M$XEQTIME      85**DCL-ENT
M$XFLUSH      26**DCL-ENT
M$XMOUSE      63**DCL-ENT
M$XXX      29**DCL-ENT
M$YC      31**DCL-ENT
TCM$ALEX_EVNT       6**PROC

PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:193  
      783        1        /*T***********************************************************/
      784        2        /*T*                                                         */
      785        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      786        4        /*T*                                                         */
      787        5        /*T***********************************************************/
      788        6        TCM$ALEX_INT: PROC ASYNC;
      789        7        %MACRO WRITEUO;
      790        8             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
      791        9                END;
      792       10        %MEND;
      793       11    1   DCL TCM_UOBUF CHAR(256) SYMREF;
      794       12        %INCLUDE CP_6;
      795       93        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      796      124    1   DCL TCM_LOCAL BIT(1) SYMREF;
      797      125    1        TCM_LOCAL='1'B;
      798      126    1        TCM_UOBUF='Switching to LOCAL mode';
      799      127             %WRITEUO;
      800      131    1        RETURN;
      801      132    1   END TCM$ALEX_INT;
      802      133        %EOD;

PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:194  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_INT.

   Procedure TCM$ALEX_INT requires 13 words for executable code.
   Procedure TCM$ALEX_INT requires 4 words of local(AUTO) storage.

PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:195  

 Object Unit name= TCM$ALEX_INT                               File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:20:08.04 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      6      6  TCM$ALEX_INT
    2   Proc  even  none    13     15  TCM$ALEX_INT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes     Async       0  TCM$ALEX_INT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     TCM_UOBUF                             M$UC                                  TCM_WRITEUO
     TCM_LOCAL
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:196  


      783        1        /*T***********************************************************/
      784        2        /*T*                                                         */
      785        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      786        4        /*T*                                                         */
      787        5        /*T***********************************************************/
      788        6        TCM$ALEX_INT: PROC ASYNC;

      6  2 000000   000000 700200 xent  TCM$ALEX_INT TSX0  ! X66_AAUTO
         2 000001   000004 000000                    ZERO    4,0

      789        7        %MACRO WRITEUO;
      790        8             CALL M$WRITE(TCM_WRITEUO) WHENALTRETURN DO;
      791        9                END;
      792       10        %MEND;
      793       11    1   DCL TCM_UOBUF CHAR(256) SYMREF;
      794       12        %INCLUDE CP_6;
      795       93        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      796      124    1   DCL TCM_LOCAL BIT(1) SYMREF;
      797      125    1        TCM_LOCAL='1'B;

    125  2 000002   400000 236003                    LDQ     -131072,DU
         2 000003   000000 756000 xsym               STQ     TCM_LOCAL

      798      126    1        TCM_UOBUF='Switching to LOCAL mode';

    126  2 000004   040000 100400                    MLR     fill='040'O
         2 000005   000000 000027 1                  ADSC9   0                        cn=0,n=23
         2 000006   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

      799      127             %WRITEUO;

    128  2 000007   000000 630400 xsym               EPPR0   TCM_WRITEUO
         2 000010   440001 713400                    CLIMB   alt,write
         2 000011   401400 401760                    pmme    nvectors=4
         2 000012   000014 702000 2                  TSX2    s:131
         2 000013   000014 710000 2                  TRA     s:131
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:197  

      800      131    1        RETURN;

    131  2 000014   000000 702200 xent               TSX2  ! X66_AARET

(unnamed)
 Sect OctLoc
   1     000   123167 151164   143150 151156   147040 164157   040114 117103    Switching to LOC
   1     004   101114 040155   157144 145040                                    AL mode
      801      132    1   END TCM$ALEX_INT;
      802      133        %EOD;

PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:198  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_INT.
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:199  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 TCM_LOCAL                  0-0-0/c CHAR(256)   r     1 TCM_UOBUF
     0-0-0/d STRC(432)   r     1 TCM_WRITEUO


   Procedure TCM$ALEX_INT requires 13 words for executable code.
   Procedure TCM$ALEX_INT requires 4 words of local(AUTO) storage.
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:200  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:201  
          MINI XREF LISTING

M$WRITE
        22**DCL-ENT   128--CALL
TCM_LOCAL
       124**DCL       125<<ASSIGN
TCM_UOBUF
        11**DCL       126<<ASSIGN
TCM_WRITEUO
       110**DCL       128<>CALL
TCM_WRITEUO.STATION_
       112**DCL       112--REDEF
TCM_WRITEUO.V.DVBYTE.VFC#
       119**DCL       119--REDEF
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:202  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:203  
              MINI UREF LISTING

M$ACCT      38**DCL-ENT
M$ACTIVATE      41**DCL-ENT
M$ALIB      34**DCL-ENT
M$ASUSER      36**DCL-ENT
M$ATTACH      43**DCL-ENT
M$BADPP      61**DCL-ENT
M$CGCTL      42**DCL-ENT
M$CGINFO      42**DCL-ENT
M$CHECK      23**DCL-ENT
M$CHGUNIT      81**DCL-ENT
M$CLOSE      21**DCL-ENT
M$CLRSTK      79**DCL-ENT
M$CMDVAR      90**DCL-ENT
M$CONFIG      51**DCL-ENT
M$CORRES      26**DCL-ENT
M$CPEXIT      35**DCL-ENT
M$CVM      59**DCL-ENT
M$CVOL      24**DCL-ENT
M$DCLFLD      51**DCL-ENT
M$DEACTIVATE      41**DCL-ENT
M$DELREC      23**DCL-ENT
M$DEQ      88**DCL-ENT
M$DETACH      43**DCL-ENT
M$DEVICE      25**DCL-ENT
M$DISPLAY      88**DCL-ENT
M$DISPRES      28**DCL-ENT
M$DLIB      34**DCL-ENT
M$DRIBBLE      51**DCL-ENT
M$DRTN      79**DCL-ENT
M$DSUSER      36**DCL-ENT
M$ENQ      87**DCL-ENT
M$EOM      46**DCL-ENT
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:204  
M$ERASE      52**DCL-ENT
M$ERR      33**DCL-ENT
M$ERRMSG      84**DCL-ENT
M$EVENT      76**DCL-ENT
M$EXHUME      85**DCL-ENT
M$EXIT      33**DCL-ENT
M$EXTEND      25**DCL-ENT
M$FDP      57**DCL-ENT
M$FDS      56**DCL-ENT
M$FEBOOT      49**DCL-ENT
M$FECTL      50**DCL-ENT
M$FEDUMP      49**DCL-ENT
M$FID      84**DCL-ENT
M$FINDPROC      38**DCL-ENT
M$FSUSER      36**DCL-ENT
M$FVP      58**DCL-ENT
M$FWCG      42**DCL-ENT
M$GBPL      62**DCL-ENT
M$GDDL      58**DCL-ENT
M$GDP      57**DCL-ENT
M$GDS      56**DCL-ENT
M$GETDCB      27**DCL-ENT
M$GETMOUSE      67**DCL-ENT
M$GETPM      68**DCL-ENT
M$GJOB      86**DCL-ENT
M$GLINEATTR      46**DCL-ENT
M$GOODPP      61**DCL-ENT
M$GPLATEN      54**DCL-ENT
M$GPROMPT      53**DCL-ENT
M$GTRMATTR      47**DCL-ENT
M$GTRMCTL      45**DCL-ENT
M$GTRMTAB      48**DCL-ENT
M$GVP      57**DCL-ENT
M$HELP      84**DCL-ENT
M$INT      76**DCL-ENT
M$INTRTN      37**DCL-ENT
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:205  
M$IOQ      72**DCL-ENT
M$JOBSTATS      86**DCL-ENT
M$KEYIN      26**DCL-ENT
M$LDEV      21**DCL-ENT
M$LDTRC      34**DCL-ENT
M$LIMIT      27**DCL-ENT
M$LINES      26**DCL-ENT
M$LINK      33**DCL-ENT
M$MADMUCK      29**DCL-ENT
M$MAKUSER      60**DCL-ENT
M$MBS      28**DCL-ENT
M$MDFFLD      52**DCL-ENT
M$MERC      77**DCL-ENT
M$MERCS      78**DCL-ENT
M$MIRROR      72**DCL-ENT
M$MONINFO      89**DCL-ENT
M$MPL      62**DCL-ENT
M$NODEINFO      53**DCL-ENT
M$NXTUSR      87**DCL-ENT
M$OCMSG      85**DCL-ENT
M$OLAY      33**DCL-ENT
M$OPEN      21**DCL-ENT
M$PAS      62**DCL-ENT
M$PATHCON      85**DCL-ENT
M$PDS      56**DCL-ENT
M$PFIL      23**DCL-ENT
M$PLATEN      47**DCL-ENT
M$PRECORD      25**DCL-ENT
M$PROCNAME      38**DCL-ENT
M$PROFILE      49**DCL-ENT
M$PROMPT      45**DCL-ENT
M$RACST      29**DCL-ENT
M$RDSYSLOG      70**DCL-ENT
M$READ      22**DCL-ENT
M$RELDCB      27**DCL-ENT
M$RELRES      28**DCL-ENT
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:206  
M$RELSTARF      30**DCL-ENT
M$REM      30**DCL-ENT
M$RENV      77**DCL-ENT
M$REQUIRE      29**DCL-ENT
M$RETRY      78**DCL-ENT
M$RETRYS      78**DCL-ENT
M$REW      24**DCL-ENT
M$RLSFLD      52**DCL-ENT
M$RPRIV      80**DCL-ENT
M$RSPP      59**DCL-ENT
M$RSWITCH      81**DCL-ENT
M$RUE      87**DCL-ENT
M$SAD      60**DCL-ENT
M$SAVE      36**DCL-ENT
M$SCON      37**DCL-ENT
M$SCREECH      35**DCL-ENT
M$SENV      77**DCL-ENT
M$SETFMA      21**DCL-ENT
M$SETFP      50**DCL-ENT
M$SINPUT      48**DCL-ENT
M$SLCFLD      53**DCL-ENT
M$SMOUSE      67**DCL-ENT
M$SMPRT      59**DCL-ENT
M$SPRIV      80**DCL-ENT
M$SSC      60**DCL-ENT
M$SSWITCH      80**DCL-ENT
M$STATE      89**DCL-ENT
M$STD      61**DCL-ENT
M$STIMER      75**DCL-ENT
M$STLPP      58**DCL-ENT
M$STRAP      75**DCL-ENT
M$STRMATTR      47**DCL-ENT
M$STRMCTL      45**DCL-ENT
M$STRMTAB      48**DCL-ENT
M$SYMBIO      86**DCL-ENT
M$SYSCON      72**DCL-ENT
PL6.E3A0      #006=TCM$ALEX_INT File=TCM$ALEX2.:TCA2TSI                          SUN 11/16/97 14:20 Page:207  
M$SYSID      90**DCL-ENT
M$TDCLOSE      71**DCL-ENT
M$TDIO      71**DCL-ENT
M$TDOPEN      70**DCL-ENT
M$TDREQCPU      71**DCL-ENT
M$TEMPWROC      65**DCL-ENT
M$TIME      88**DCL-ENT
M$TRAP      75**DCL-ENT
M$TRMISC      50**DCL-ENT
M$TRMPRG      46**DCL-ENT
M$TRTN      79**DCL-ENT
M$TRUNC      22**DCL-ENT
M$TTIMER      75**DCL-ENT
M$UC      45**DCL
M$UMPL      62**DCL-ENT
M$UNFID      84**DCL-ENT
M$UNLATCH      41**DCL-ENT
M$UNSHARE      38**DCL-ENT
M$USRFIELD      81**DCL-ENT
M$VIRTUAL      56**DCL-ENT
M$WAIT      79**DCL-ENT
M$WEOF      24**DCL-ENT
M$WRSYSLOG      70**DCL-ENT
M$XCON      76**DCL-ENT
M$XCONRTN      37**DCL-ENT
M$XEQTIME      89**DCL-ENT
M$XFLUSH      30**DCL-ENT
M$XMOUSE      67**DCL-ENT
M$XXX      33**DCL-ENT
M$YC      35**DCL-ENT
TCM$ALEX_INT       6**PROC

PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:208  
      803        1        /*T***********************************************************/
      804        2        /*T*                                                         */
      805        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      806        4        /*T*                                                         */
      807        5        /*T***********************************************************/
      808        6        TCM$ALEX_XCON: PROC ASYNC;
      809        7        %include B_ERRORS_C;
      810     1134        %include CP_6;
      811     1215        %B$TCB (STCLASS="BASED(B$TCB$)");
      812     1218        %B$XCON;
      813     1228    1   dcl M$DO dcb;
      814     1229    1   dcl ERRMSG_BUF  char(120) static;
      815     1230        %FPT_ERRMSG( FPTN=REPORT_XCON, BUF=ERRMSG_BUF, OUTDCB1=M$DO, SOURCE=TRAP, RESULTS=
              1230            VLR_ERRMSG);
      816     1257        %VLR_ERRMSG;
      817     1279    1   dcl B$TCB$ ptr symref readonly;
      818     1280    1   dcl TCM_CONNECTED bit(1) symref;
      819     1281    1   dcl DISCONNECT_OCCURRED bit(1);
      820     1282    1   dcl TCM_ALEX_BAILOUT remember symref;
      821     1283    1   dcl TCM_ALEX_BAILOUT_ENABLED redef TCM_ALEX_BAILOUT bit(72);
      822     1284    1   dcl TCM$ALEX_DISCONNECT entry altret;
      823     1285    2        call M$ERRMSG (REPORT_XCON) whenaltreturn do; end;
      824     1286    2        if B$TCB.STK$->B$XCON.ERR.ERR# = %E$LDSC /* disconnect */ then do;
      825     1287    2             TCM_CONNECTED = '0'B;
      826     1288    2             DISCONNECT_OCCURRED = '1'B;
      827     1289    2           end;
      828     1290    1        else DISCONNECT_OCCURRED = '0'B;
      829     1291    1        call TCM$ALEX_DISCONNECT;
      830     1292    1        if TCM_ALEX_BAILOUT_ENABLED and DISCONNECT_OCCURRED
      831     1293    1        then unwind to TCM_ALEX_BAILOUT;
      832     1294    1        call M$EXIT;
      833     1295    1   END TCM$ALEX_XCON;
      834     1296        %EOD;

PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:209  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIBRARY  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_XCON.

   Procedure TCM$ALEX_XCON requires 32 words for executable code.
   Procedure TCM$ALEX_XCON requires 4 words of local(AUTO) storage.

PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:210  

 Object Unit name= TCM$ALEX_XCON                              File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:20:22.40 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DO
    2   Data  even  none    60     74  TCM$ALEX_XCON
    3   Proc  even  none    32     40  TCM$ALEX_XCON
    4  RoData even  none     2      2  TCM$ALEX_XCON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes     Async       0  TCM$ALEX_XCON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 TCM$ALEX_DISCONNECT
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AAUNWIND
                       nStd      0 X66_AARET
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:211  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DO                             r    B$TCB$
     TCM_CONNECTED                         TCM_ALEX_BAILOUT                      B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:212  


      803        1        /*T***********************************************************/
      804        2        /*T*                                                         */
      805        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      806        4        /*T*                                                         */
      807        5        /*T***********************************************************/
      808        6        TCM$ALEX_XCON: PROC ASYNC;

      6  3 000000   000000 700200 xent  TCM$ALEX_XC* TSX0  ! X66_AAUTO
         3 000001   000004 000000                    ZERO    4,0

      809        7        %include B_ERRORS_C;
      810     1134        %include CP_6;
      811     1215        %B$TCB (STCLASS="BASED(B$TCB$)");
      812     1218        %B$XCON;
      813     1228    1   dcl M$DO dcb;
      814     1229    1   dcl ERRMSG_BUF  char(120) static;
      815     1230        %FPT_ERRMSG( FPTN=REPORT_XCON, BUF=ERRMSG_BUF, OUTDCB1=M$DO, SOURCE=TRAP, RESULTS=
              1230            VLR_ERRMSG);
      816     1257        %VLR_ERRMSG;
      817     1279    1   dcl B$TCB$ ptr symref readonly;
      818     1280    1   dcl TCM_CONNECTED bit(1) symref;
      819     1281    1   dcl DISCONNECT_OCCURRED bit(1);
      820     1282    1   dcl TCM_ALEX_BAILOUT remember symref;
      821     1283    1   dcl TCM_ALEX_BAILOUT_ENABLED redef TCM_ALEX_BAILOUT bit(72);
      822     1284    1   dcl TCM$ALEX_DISCONNECT entry altret;
      823     1285    2        call M$ERRMSG (REPORT_XCON) whenaltreturn do; end;

   1285  3 000002   000036 630400 2                  EPPR0   REPORT_XCON
         3 000003   420000 713400                    CLIMB   alt,+8192
         3 000004   405000 401760                    pmme    nvectors=11
         3 000005   000007 702000 3                  TSX2    s:1286
         3 000006   000007 710000 3                  TRA     s:1286

      824     1286    2        if B$TCB.STK$->B$XCON.ERR.ERR# = %E$LDSC /* disconnect */ then do;

   1286  3 000007   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:213  
         3 000010   000001 471500                    LDP1    1,,PR0
         3 000011   100102 236100                    LDQ     66,,PR1
         3 000012   377770 376007                    ANQ     131064,DL
         3 000013   000140 116007                    CMPQ    96,DL
         3 000014   000021 601000 3                  TNZ     s:1290

      825     1287    2             TCM_CONNECTED = '0'B;

   1287  3 000015   000000 450000 xsym               STZ     TCM_CONNECTED

      826     1288    2             DISCONNECT_OCCURRED = '1'B;

   1288  3 000016   400000 236003                    LDQ     -131072,DU
         3 000017   200003 756100                    STQ     DISCONNECT_OCCURRED,,AUTO

      827     1289    2           end;

   1289  3 000020   000022 710000 3                  TRA     s:1291

      828     1290    1        else DISCONNECT_OCCURRED = '0'B;

   1290  3 000021   200003 450100                    STZ     DISCONNECT_OCCURRED,,AUTO

      829     1291    1        call TCM$ALEX_DISCONNECT;

   1291  3 000022   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000023   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         3 000024   000000 011000                    NOP     0

      830     1292    1        if TCM_ALEX_BAILOUT_ENABLED and DISCONNECT_OCCURRED

   1292  3 000025   000000 237000 xsym               LDAQ    TCM_ALEX_BAILOUT
         3 000026   000000 117000 4                  CMPAQ   0
         3 000027   000035 600000 3                  TZE     s:1294
         3 000030   200003 234100                    SZN     DISCONNECT_OCCURRED,,AUTO
         3 000031   000035 605000 3                  TPL     s:1294

PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:214  
      831     1293    1        then unwind to TCM_ALEX_BAILOUT;

   1293  3 000032   000000 237200 xsym               LDAQ  ! TCM_ALEX_BAILOUT
         3 000033   000000 700200 xent               TSX0  ! X66_AAUNWIND
         3 000034   000000 000200                    ZERO    0,128

      832     1294    1        call M$EXIT;

   1294  3 000035   000001 713400                    CLIMB   exit
         3 000036   000000 401760                    pmme    nvectors=0

      833     1295    1   END TCM$ALEX_XCON;

   1295  3 000037   000000 702200 xent               TSX2  ! X66_AARET

ERRMSG_BUF
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

REPORT_XCON
 Sect OctLoc
   2     036   000003 777640   000064 006000   000000 177640   000000 006014    .....4..........
   2     042   000035 777640   000000 006000   000000 177640   000000 006014    ................
   2     046   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     056*  000000 177640   000000 006014   000003 777640   000070 006000    .............8..
   2     062   000000 177640   000000 006014   000000 000000   000000 000000    ................
   2     066   375000 070001   040000 000000                                    ..8. ...

VLR_ERRMSG
 Sect OctLoc
   2     070   00000* ***000   000000 000000   000000 000000   ****** ******    ................

(unnamed)
 Sect OctLoc
   4     000   000000 000000   000000 000000                                    ........
      834     1296        %EOD;

PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:215  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIBRARY  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_XCON.
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:216  

 **** Variables and constants ****

  ****  Section 002  Data  TCM$ALEX_XCON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(120)   r     1 ERRMSG_BUF                36-0-0/d STRC(936)   r     1 REPORT_XCON
    70-0-0/d STRC(144)   r     1 VLR_ERRMSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 DISCONNECT_OCCURRED

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d REMB        r     1 TCM_ALEX_BAILOUT
     0-0-0/d BIT (72)    r     1 TCM_ALEX_BAILOUT_ENABLED
     0-0-0/b BIT         r     1 TCM_CONNECTED

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(2448)  r     1 B$XCON
     0-0-0N  NULL        r     1 M$DO


   Procedure TCM$ALEX_XCON requires 32 words for executable code.
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:217  
   Procedure TCM$ALEX_XCON requires 4 words of local(AUTO) storage.
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:218  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:219  
          MINI XREF LISTING

B$TCB.STK$
      1216**DCL      1286>>IF
B$TCB$
      1279**DCL      1216--IMP-PTR  1286>>IF
B$XCON.ERR.ERR#
      1225**DCL      1225--REDEF    1286>>IF
B$XCON.LIMIT.MEM
      1223**DCL      1223--REDEF
DISCONNECT_OCCURRED
      1281**DCL      1288<<ASSIGN   1290<<ASSIGN   1292>>IF
ERRMSG_BUF
      1229**DCL      1242--DCLINIT
M$ERRMSG
      1206**DCL-ENT  1285--CALL
M$EXIT
      1155**DCL-ENT  1294--CALL
REPORT_XCON
      1241**DCL      1285<>CALL
REPORT_XCON.V
      1245**DCL      1241--DCLINIT
TCM$ALEX_DISCONNECT
      1284**DCL-ENT  1291--CALL
TCM_ALEX_BAILOUT
      1282**DCL      1283--REDEF    1293>>UNWIND
TCM_ALEX_BAILOUT_ENABLED
      1283**DCL      1292>>IF
TCM_CONNECTED
      1280**DCL      1287<<ASSIGN
VLR_ERRMSG
      1268**DCL      1245--DCLINIT
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:220  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:221  
              MINI UREF LISTING

M$ACCT    1160**DCL-ENT
M$ACTIVATE    1163**DCL-ENT
M$ALIB    1156**DCL-ENT
M$ASUSER    1158**DCL-ENT
M$ATTACH    1165**DCL-ENT
M$BADPP    1183**DCL-ENT
M$CGCTL    1164**DCL-ENT
M$CGINFO    1164**DCL-ENT
M$CHECK    1145**DCL-ENT
M$CHGUNIT    1203**DCL-ENT
M$CLOSE    1143**DCL-ENT
M$CLRSTK    1201**DCL-ENT
M$CMDVAR    1212**DCL-ENT
M$CONFIG    1173**DCL-ENT
M$CORRES    1148**DCL-ENT
M$CPEXIT    1157**DCL-ENT
M$CVM    1181**DCL-ENT
M$CVOL    1146**DCL-ENT
M$DCLFLD    1173**DCL-ENT
M$DEACTIVATE    1163**DCL-ENT
M$DELREC    1145**DCL-ENT
M$DEQ    1210**DCL-ENT
M$DETACH    1165**DCL-ENT
M$DEVICE    1147**DCL-ENT
M$DISPLAY    1210**DCL-ENT
M$DISPRES    1150**DCL-ENT
M$DLIB    1156**DCL-ENT
M$DO    1228**DCL
M$DRIBBLE    1173**DCL-ENT
M$DRTN    1201**DCL-ENT
M$DSUSER    1158**DCL-ENT
M$ENQ    1209**DCL-ENT
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:222  
M$EOM    1168**DCL-ENT
M$ERASE    1174**DCL-ENT
M$ERR    1155**DCL-ENT
M$EVENT    1198**DCL-ENT
M$EXHUME    1207**DCL-ENT
M$EXTEND    1147**DCL-ENT
M$FDP    1179**DCL-ENT
M$FDS    1178**DCL-ENT
M$FEBOOT    1171**DCL-ENT
M$FECTL    1172**DCL-ENT
M$FEDUMP    1171**DCL-ENT
M$FID    1206**DCL-ENT
M$FINDPROC    1160**DCL-ENT
M$FSUSER    1158**DCL-ENT
M$FVP    1180**DCL-ENT
M$FWCG    1164**DCL-ENT
M$GBPL    1184**DCL-ENT
M$GDDL    1180**DCL-ENT
M$GDP    1179**DCL-ENT
M$GDS    1178**DCL-ENT
M$GETDCB    1149**DCL-ENT
M$GETMOUSE    1189**DCL-ENT
M$GETPM    1190**DCL-ENT
M$GJOB    1208**DCL-ENT
M$GLINEATTR    1168**DCL-ENT
M$GOODPP    1183**DCL-ENT
M$GPLATEN    1176**DCL-ENT
M$GPROMPT    1175**DCL-ENT
M$GTRMATTR    1169**DCL-ENT
M$GTRMCTL    1167**DCL-ENT
M$GTRMTAB    1170**DCL-ENT
M$GVP    1179**DCL-ENT
M$HELP    1206**DCL-ENT
M$INT    1198**DCL-ENT
M$INTRTN    1159**DCL-ENT
M$IOQ    1194**DCL-ENT
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:223  
M$JOBSTATS    1208**DCL-ENT
M$KEYIN    1148**DCL-ENT
M$LDEV    1143**DCL-ENT
M$LDTRC    1156**DCL-ENT
M$LIMIT    1149**DCL-ENT
M$LINES    1148**DCL-ENT
M$LINK    1155**DCL-ENT
M$MADMUCK    1151**DCL-ENT
M$MAKUSER    1182**DCL-ENT
M$MBS    1150**DCL-ENT
M$MDFFLD    1174**DCL-ENT
M$MERC    1199**DCL-ENT
M$MERCS    1200**DCL-ENT
M$MIRROR    1194**DCL-ENT
M$MONINFO    1211**DCL-ENT
M$MPL    1184**DCL-ENT
M$NODEINFO    1175**DCL-ENT
M$NXTUSR    1209**DCL-ENT
M$OCMSG    1207**DCL-ENT
M$OLAY    1155**DCL-ENT
M$OPEN    1143**DCL-ENT
M$PAS    1184**DCL-ENT
M$PATHCON    1207**DCL-ENT
M$PDS    1178**DCL-ENT
M$PFIL    1145**DCL-ENT
M$PLATEN    1169**DCL-ENT
M$PRECORD    1147**DCL-ENT
M$PROCNAME    1160**DCL-ENT
M$PROFILE    1171**DCL-ENT
M$PROMPT    1167**DCL-ENT
M$RACST    1151**DCL-ENT
M$RDSYSLOG    1192**DCL-ENT
M$READ    1144**DCL-ENT
M$RELDCB    1149**DCL-ENT
M$RELRES    1150**DCL-ENT
M$RELSTARF    1152**DCL-ENT
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:224  
M$REM    1152**DCL-ENT
M$RENV    1199**DCL-ENT
M$REQUIRE    1151**DCL-ENT
M$RETRY    1200**DCL-ENT
M$RETRYS    1200**DCL-ENT
M$REW    1146**DCL-ENT
M$RLSFLD    1174**DCL-ENT
M$RPRIV    1202**DCL-ENT
M$RSPP    1181**DCL-ENT
M$RSWITCH    1203**DCL-ENT
M$RUE    1209**DCL-ENT
M$SAD    1182**DCL-ENT
M$SAVE    1158**DCL-ENT
M$SCON    1159**DCL-ENT
M$SCREECH    1157**DCL-ENT
M$SENV    1199**DCL-ENT
M$SETFMA    1143**DCL-ENT
M$SETFP    1172**DCL-ENT
M$SINPUT    1170**DCL-ENT
M$SLCFLD    1175**DCL-ENT
M$SMOUSE    1189**DCL-ENT
M$SMPRT    1181**DCL-ENT
M$SPRIV    1202**DCL-ENT
M$SSC    1182**DCL-ENT
M$SSWITCH    1202**DCL-ENT
M$STATE    1211**DCL-ENT
M$STD    1183**DCL-ENT
M$STIMER    1197**DCL-ENT
M$STLPP    1180**DCL-ENT
M$STRAP    1197**DCL-ENT
M$STRMATTR    1169**DCL-ENT
M$STRMCTL    1167**DCL-ENT
M$STRMTAB    1170**DCL-ENT
M$SYMBIO    1208**DCL-ENT
M$SYSCON    1194**DCL-ENT
M$SYSID    1212**DCL-ENT
PL6.E3A0      #007=TCM$ALEX_XCON File=TCM$ALEX2.:TCA2TSI                         SUN 11/16/97 14:20 Page:225  
M$TDCLOSE    1193**DCL-ENT
M$TDIO    1193**DCL-ENT
M$TDOPEN    1192**DCL-ENT
M$TDREQCPU    1193**DCL-ENT
M$TEMPWROC    1187**DCL-ENT
M$TIME    1210**DCL-ENT
M$TRAP    1197**DCL-ENT
M$TRMISC    1172**DCL-ENT
M$TRMPRG    1168**DCL-ENT
M$TRTN    1201**DCL-ENT
M$TRUNC    1144**DCL-ENT
M$TTIMER    1197**DCL-ENT
M$UC    1167**DCL
M$UMPL    1184**DCL-ENT
M$UNFID    1206**DCL-ENT
M$UNLATCH    1163**DCL-ENT
M$UNSHARE    1160**DCL-ENT
M$USRFIELD    1203**DCL-ENT
M$VIRTUAL    1178**DCL-ENT
M$WAIT    1201**DCL-ENT
M$WEOF    1146**DCL-ENT
M$WRITE    1144**DCL-ENT
M$WRSYSLOG    1192**DCL-ENT
M$XCON    1198**DCL-ENT
M$XCONRTN    1159**DCL-ENT
M$XEQTIME    1211**DCL-ENT
M$XFLUSH    1152**DCL-ENT
M$XMOUSE    1189**DCL-ENT
M$XXX    1155**DCL-ENT
M$YC    1157**DCL-ENT
TCM$ALEX_XCON       6**PROC

PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:226  
      835        1        /*T***********************************************************/
      836        2        /*T*                                                         */
      837        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      838        4        /*T*                                                         */
      839        5        /*T***********************************************************/
      840        6        TCM$ALEX_DISCONNECT: PROC altret;
      841        7        %INCLUDE CP_6;
      842       88        %F$DCB;
      843      145    1   dcl TCM_EXEC bit(1) symref;
      844      146        %MACRO WRITEUO;
      845      147             call M$WRITE(TCM_WRITEUO) whenaltreturn do; end;
      846      148        %MEND;
      847      149        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      848      180    1   dcl TCM_UOBUF  char(256) symref;
      849      181    1   dcl TCM_USING_PAD bit(1) symref;
      850      182    1   dcl TCM_BLEN ubin symref;
      851      183    1   dcl TCM_SITE char(8) symref;
      852      184    1   dcl TCM_OUTREC char(332) symref;
      853      185    1   dcl TCM_WRITECGBUF char(256) symref;
      854      186    1   dcl TCM_CONNECTED bit(1) symref;
      855      187    1   dcl F$CG dcb;
      856      188        %FPT_WAIT (FPTN=WAIT5,UNITS=5);
      857      202        %FPT_CLOSE (FPTN=CLOSE_CG, DCB=F$CG, DISP=SAVE);
      858      244        %FPT_XCON (FPTN=RESTORE_EXIT_CONTROL, UENTRY=NIL);
      859      258    1   DCL TCM_XCON$ EPTR SYMREF;
      860      259        %FPT_ACTIVATE (FPTN=TCM_TURNON, DCB=F$CG, STATION=WRITE_STATION);
      861      282        %FPT_ACTIVATE (FPTN=DISCONNECT, DCB=F$CG, STATION=WRITE_STATION,
      862      283                       FLUSH=YES, DISCONNECT=YES);
      863      306        %VLP_STATION (FPTN=WRITE_STATION, STATION='MODEM');
      864      333        %FPT_FWCG (FPTN=TCM_DELETEMES, STCLASS=SYMREF);
      865      352    1   dcl TCM$ALEX_HANGUP entry altret;
      866      353    1        TCM_EXEC = '0'B;
      867      354    1        if dcbaddr(dcbnum(F$CG))->F$DCB.FCD# = '1'B then
      868      355    1   SHUTDOWN:
      869      356    2        do;
      870      357    2             if TCM_CONNECTED then
      871      358    2   HANGITUP:
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:227  
      872      359    3             do;
      873      360    3                  TCM_CONNECTED = '0'B;    /*  Don't re-enter this code. */
      874      361    4                  if not TCM_USING_PAD then do;
      875      362    4                       call TCM$ALEX_HANGUP
      876      363    5                       whenreturn do; exit HANGITUP; end;
      877      364    4                     end;
      878      365    3                  if TCM_USING_PAD
      879      366    3                  then TCM_UOBUF = 'Dropping DTR to disconnect PAD circuit.';
      880      367    3                  else TCM_UOBUF = 'Dropping DTR to disconnect modem.';
      881      368                       %WRITEUO;
      882      371    4                  call M$FWCG (TCM_DELETEMES) whenaltreturn do; end;
      883      372    3                  call M$DEACTIVATE(DISCONNECT);
      884      373    3                  TCM_UOBUF = 'Disconnected.';
      885      374                       %WRITEUO;
      886      377    3                end HANGITUP;
      887      378    3             call M$CLOSE(CLOSE_CG) whenaltreturn do; end;
      888      379    2           end SHUTDOWN;
      889      380    2        IF TCM_XCON$ ~= ENTADDR( NIL) THEN DO;
      890      381    2             RESTORE_EXIT_CONTROL.V.UENTRY# = TCM_XCON$;
      891      382    2             CALL M$XCON( RESTORE_EXIT_CONTROL);
      892      383    2           END;
      893      384    1        return;
      894      385    1   END TCM$ALEX_DISCONNECT;
      895      386        %EOD;

PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:228  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_DISCONNECT.

   Procedure TCM$ALEX_DISCONNECT requires 62 words for executable code.
   Procedure TCM$ALEX_DISCONNECT requires 4 words of local(AUTO) storage.

PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:229  

 Object Unit name= TCM$ALEX_DISCONNECT                        File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:20:47.72 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  F$CG
    2   Data  even  none    82    122  TCM$ALEX_DISCONNECT
    3  RoData even  UTS     23     27  TCM$ALEX_DISCONNECT
    4   Proc  even  none    62     76  TCM$ALEX_DISCONNECT
    5  RoData even  none     1      1  TCM$ALEX_DISCONNECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        0  TCM$ALEX_DISCONNECT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 TCM$ALEX_HANGUP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:230  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TCM_EXEC                              TCM_WRITEUO
     TCM_UOBUF                             TCM_USING_PAD                         TCM_CONNECTED
     F$CG                                  TCM_XCON$                             TCM_DELETEMES
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:231  


      835        1        /*T***********************************************************/
      836        2        /*T*                                                         */
      837        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      838        4        /*T*                                                         */
      839        5        /*T***********************************************************/
      840        6        TCM$ALEX_DISCONNECT: PROC altret;

      6  4 000000   000000 700200 xent  TCM$ALEX_DI* TSX0  ! X66_AUTO_0
         4 000001   000004 000000                    ZERO    4,0

      841        7        %INCLUDE CP_6;
      842       88        %F$DCB;
      843      145    1   dcl TCM_EXEC bit(1) symref;
      844      146        %MACRO WRITEUO;
      845      147             call M$WRITE(TCM_WRITEUO) whenaltreturn do; end;
      846      148        %MEND;
      847      149        %FPT_WRITE(FPTN=TCM_WRITEUO,STCLASS=SYMREF);
      848      180    1   dcl TCM_UOBUF  char(256) symref;
      849      181    1   dcl TCM_USING_PAD bit(1) symref;
      850      182    1   dcl TCM_BLEN ubin symref;
      851      183    1   dcl TCM_SITE char(8) symref;
      852      184    1   dcl TCM_OUTREC char(332) symref;
      853      185    1   dcl TCM_WRITECGBUF char(256) symref;
      854      186    1   dcl TCM_CONNECTED bit(1) symref;
      855      187    1   dcl F$CG dcb;
      856      188        %FPT_WAIT (FPTN=WAIT5,UNITS=5);
      857      202        %FPT_CLOSE (FPTN=CLOSE_CG, DCB=F$CG, DISP=SAVE);
      858      244        %FPT_XCON (FPTN=RESTORE_EXIT_CONTROL, UENTRY=NIL);
      859      258    1   DCL TCM_XCON$ EPTR SYMREF;
      860      259        %FPT_ACTIVATE (FPTN=TCM_TURNON, DCB=F$CG, STATION=WRITE_STATION);
      861      282        %FPT_ACTIVATE (FPTN=DISCONNECT, DCB=F$CG, STATION=WRITE_STATION,
      862      283                       FLUSH=YES, DISCONNECT=YES);
      863      306        %VLP_STATION (FPTN=WRITE_STATION, STATION='MODEM');
      864      333        %FPT_FWCG (FPTN=TCM_DELETEMES, STCLASS=SYMREF);
      865      352    1   dcl TCM$ALEX_HANGUP entry altret;
      866      353    1        TCM_EXEC = '0'B;
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:232  

    353  4 000002   000000 450000 xsym               STZ     TCM_EXEC

      867      354    1        if dcbaddr(dcbnum(F$CG))->F$DCB.FCD# = '1'B then

    354  4 000003   000000 236007 xsym               LDQ     F$CG,DL
         4 000004   000000 470400 5                  LDP0    0
         4 000005   000000 471500                    LDP1    0,,PR0
         4 000006   100000 473506                    LDP3    0,QL,PR1
         4 000007   300031 236100                    LDQ     25,,PR3
         4 000010   020000 316007                    CANQ    8192,DL
         4 000011   000066 600000 4                  TZE     s:380

      868      355    1   SHUTDOWN:
      869      356    2        do;

    356  4 000012                       SHUTDOWN     null
      870      357    2             if TCM_CONNECTED then

    357  4 000012   000000 234000 xsym               SZN     TCM_CONNECTED
         4 000013   000061 605000 4                  TPL     s:378

      871      358    2   HANGITUP:
      872      359    3             do;

    359  4 000014                       HANGITUP     null
      873      360    3                  TCM_CONNECTED = '0'B;    /*  Don't re-enter this code. */

    360  4 000014   000000 450000 xsym               STZ     TCM_CONNECTED

      874      361    4                  if not TCM_USING_PAD then do;

    361  4 000015   000000 234000 xsym               SZN     TCM_USING_PAD
         4 000016   000023 604000 4                  TMI     s:365

      875      362    4                       call TCM$ALEX_HANGUP

PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:233  
    362  4 000017   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000020   000000 701000 xent               TSX1    TCM$ALEX_HANGUP
         4 000021   000023 702000 4                  TSX2    s:365

      876      363    5                       whenreturn do; exit HANGITUP; end;

    363  4 000022   000061 710000 4                  TRA     s:378

      877      364    4                     end;

      878      365    3                  if TCM_USING_PAD

    365  4 000023   000000 234000 xsym               SZN     TCM_USING_PAD
         4 000024   000031 605000 4                  TPL     s:367

      879      366    3                  then TCM_UOBUF = 'Dropping DTR to disconnect PAD circuit.';

    366  4 000025   040000 100400                    MLR     fill='040'O
         4 000026   000000 000047 3                  ADSC9   0                        cn=0,n=39
         4 000027   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256
         4 000030   000034 710000 4                  TRA     s:369

      880      367    3                  else TCM_UOBUF = 'Dropping DTR to disconnect modem.';

    367  4 000031   040000 100400                    MLR     fill='040'O
         4 000032   000012 000041 3                  ADSC9   10                       cn=0,n=33
         4 000033   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

      881      368                       %WRITEUO;

    369  4 000034   000000 630400 xsym               EPPR0   TCM_WRITEUO
         4 000035   440001 713400                    CLIMB   alt,write
         4 000036   401400 401760                    pmme    nvectors=4
         4 000037   000041 702000 4                  TSX2    s:371
         4 000040   000041 710000 4                  TRA     s:371

      882      371    4                  call M$FWCG (TCM_DELETEMES) whenaltreturn do; end;
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:234  

    371  4 000041   000000 630400 xsym               EPPR0   TCM_DELETEMES
         4 000042   500005 713400                    CLIMB   alt,+32773
         4 000043   406400 401760                    pmme    nvectors=14
         4 000044   000046 702000 4                  TSX2    s:372
         4 000045   000046 710000 4                  TRA     s:372

      883      372    3                  call M$DEACTIVATE(DISCONNECT);

    372  4 000046   000072 630400 2                  EPPR0   DISCONNECT
         4 000047   100001 713400                    CLIMB   32769
         4 000050   401400 401760                    pmme    nvectors=4

      884      373    3                  TCM_UOBUF = 'Disconnected.';

    373  4 000051   040000 100400                    MLR     fill='040'O
         4 000052   000023 000015 3                  ADSC9   19                       cn=0,n=13
         4 000053   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

      885      374                       %WRITEUO;

    375  4 000054   000000 630400 xsym               EPPR0   TCM_WRITEUO
         4 000055   440001 713400                    CLIMB   alt,write
         4 000056   401400 401760                    pmme    nvectors=4
         4 000057   000061 702000 4                  TSX2    s:378
         4 000060   000061 710000 4                  TRA     s:378

      886      377    3                end HANGITUP;

      887      378    3             call M$CLOSE(CLOSE_CG) whenaltreturn do; end;

    378  4 000061   000006 630400 2                  EPPR0   CLOSE_CG
         4 000062   450001 713400                    CLIMB   alt,close
         4 000063   406000 401760                    pmme    nvectors=13
         4 000064   000066 702000 4                  TSX2    s:380
         4 000065   000066 710000 4                  TRA     s:380

PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:235  
      888      379    2           end SHUTDOWN;

      889      380    2        IF TCM_XCON$ ~= ENTADDR( NIL) THEN DO;

    380  4 000066   000000 236000 xsym               LDQ     TCM_XCON$
         4 000067   000002 116000 xsym               CMPQ    B_VECTNIL+2
         4 000070   000075 600000 4                  TZE     s:384

      890      381    2             RESTORE_EXIT_CONTROL.V.UENTRY# = TCM_XCON$;

    381  4 000071   000050 756000 2                  STQ     RESTORE_EXIT_CONTROL+4

      891      382    2             CALL M$XCON( RESTORE_EXIT_CONTROL);

    382  4 000072   000044 630400 2                  EPPR0   RESTORE_EXIT_CONTROL
         4 000073   010003 713400                    CLIMB   4099
         4 000074   400400 401760                    pmme    nvectors=2

      892      383    2           END;

      893      384    1        return;

    384  4 000075   000000 702200 xent               TSX2  ! X66_ARET

WAIT5
 Sect OctLoc
   2     000   000001 777640   000004 006000   000000 177640   000000 006014    ................
   2     004   000000 000005   000000 000001                                    ........

CLOSE_CG
 Sect OctLoc
   2     006   000003 777640   000040 006000   000000 177640   000000 006014    ..... ..........
   2     012   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     036*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   2     042   000220 000000   000000 000000                                    ........

RESTORE_EXIT_CONTROL
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:236  
 Sect OctLoc
   2     044   000001 777640   000050 006000   000000 177640   000000 006014    .....(..........
   2     050   000000 000000   000000 000000                                    ........

TCM_TURNON
 Sect OctLoc
   2     052   000007 777640   000062 006000   000007 777640   000112 006000    .....2.......J..
   2     056   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     062   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     066   040040 040040   000000 000000   000000 000000   000000 000000        ............

DISCONNECT
 Sect OctLoc
   2     072   000007 777640   000102 006000   000007 777640   000112 006000    .....B.......J..
   2     076   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     102   000000 000000   000000 000000   600000 000000   000000 000000    ................
   2     106   040040 040040   000000 000000   000000 000000   000000 000000        ............

WRITE_STATION
 Sect OctLoc
   2     112   115117 104105   115040 040040   040040 040040   040040 040040    MODEM
   2     116   001000 000000   000000 000000   000000 000000   000000 000000    ................

(unnamed)
 Sect OctLoc
   3     000   104162 157160   160151 156147   040104 124122   040164 157040    Dropping DTR to
   3     004   144151 163143   157156 156145   143164 040120   101104 040143    disconnect PAD c
   3     010   151162 143165   151164 056040   104162 157160   160151 156147    ircuit. Dropping
   3     014   040104 124122   040164 157040   144151 163143   157156 156145     DTR to disconne
   3     020   143164 040155   157144 145155   056040 040040   104151 163143    ct modem.   Disc
   3     024   157156 156145   143164 145144   056040 040040                    onnected.

(unnamed)
 Sect OctLoc
   5     000   000000 006003                                                    ....
      894      385    1   END TCM$ALEX_DISCONNECT;
      895      386        %EOD;
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:237  

PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:238  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_DISCONNECT.
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:239  

 **** Variables and constants ****

  ****  Section 002  Data  TCM$ALEX_DISCONNECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/d STRC(1080)  r     1 CLOSE_CG                  72-0-0/d STRC(576)   r     1 DISCONNECT
    44-0-0/d STRC(216)   r     1 RESTORE_EXIT_CONTROL      52-0-0/d STRC(576)   r     1 TCM_TURNON
     0-0-0/d STRC(216)   r     1 WAIT5                    112-0-0/w STRC(288)   r     1 WRITE_STATION

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 TCM_CONNECTED              0-0-0/d STRC(1512)  r     1 TCM_DELETEMES
     0-0-0/b BIT         r     1 TCM_EXEC                   0-0-0/c CHAR(256)   r     1 TCM_UOBUF
     0-0-0/b BIT         r     1 TCM_USING_PAD              0-0-0/d STRC(432)   r     1 TCM_WRITEUO
     0-0-0/w EPTR        r     1 TCM_XCON$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 F$CG                       0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure TCM$ALEX_DISCONNECT requires 62 words for executable code.
   Procedure TCM$ALEX_DISCONNECT requires 4 words of local(AUTO) storage.
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:240  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:241  
          MINI XREF LISTING

CLOSE_CG
       225**DCL       378<>CALL
CLOSE_CG.SN_
       225**DCL       225--REDEF
CLOSE_CG.UTL_
       226**DCL       226--REDEF
CLOSE_CG.V
       230**DCL       225--DCLINIT
CLOSE_CG.V.EXPIRE#
       240**DCL       240--REDEF
CLOSE_CG.V.TYPE#
       238**DCL       238--REDEF
CLOSE_CG.V.XTNSIZE#
       235**DCL       235--REDEF     237--REDEF
DISCONNECT
       294**DCL       372<>CALL
DISCONNECT.V
       295**DCL       294--DCLINIT
DISCONNECT.V.DVBYTE.REREAD#
       297**DCL       297--REDEF
F$CG
       187**DCL       354--IF
F$DCB.ACTPOS
       121**DCL       121--REDEF
F$DCB.ARS#
        95**DCL        95--REDEF
F$DCB.ATTR
       114**DCL       115--REDEF
F$DCB.BORROW
       129**DCL       129--REDEF     129--REDEF     129--REDEF
F$DCB.DCBNAME.L
       143**DCL       143--IMP-SIZ
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:242  
F$DCB.EOMCHAR#
        99**DCL        99--REDEF
F$DCB.FCD#
       108**DCL       354>>IF
F$DCB.FLDID
       124**DCL       124--REDEF
F$DCB.FORM$
       118**DCL       118--REDEF
F$DCB.FSECT
       134**DCL       134--REDEF
F$DCB.FSN#
       111**DCL       111--REDEF     111--REDEF     112--REDEF
F$DCB.HEADER$
       117**DCL       117--REDEF
F$DCB.IXTNSIZE#
       115**DCL       115--REDEF
F$DCB.LASTSTA$
       104**DCL       104--REDEF
F$DCB.LVL
       130**DCL       130--REDEF
F$DCB.NAME#.C
       105**DCL       105--REDEF
F$DCB.NOEOF
       127**DCL       127--REDEF
F$DCB.NRECS#
       116**DCL       116--REDEF
F$DCB.NRECX
       135**DCL       135--REDEF
F$DCB.OHDR
       127**DCL       127--REDEF
F$DCB.ORG#
       110**DCL       110--REDEF
F$DCB.PRECNO
       133**DCL       133--REDEF
F$DCB.RCSZ
       139**DCL       139--REDEF
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:243  
F$DCB.RES#
       106**DCL       106--REDEF
F$DCB.SETX
       118**DCL       118--REDEF
F$DCB.TAB$
       118**DCL       118--REDEF
F$DCB.TDA
       132**DCL       133--REDEF
F$DCB.WSN#
       106**DCL       106--REDEF
HANGITUP
       359**LABEL     363--EXIT
M$CLOSE
        16**DCL-ENT   378--CALL
M$DEACTIVATE
        36**DCL-ENT   372--CALL
M$FWCG
        37**DCL-ENT   371--CALL
M$WRITE
        17**DCL-ENT   369--CALL      375--CALL
M$XCON
        71**DCL-ENT   382--CALL
RESTORE_EXIT_CONTROL
       255**DCL       382<>CALL
RESTORE_EXIT_CONTROL.V
       256**DCL       255--DCLINIT
RESTORE_EXIT_CONTROL.V.UENTRY#
       256**DCL       381<<ASSIGN
TCM$ALEX_HANGUP
       352**DCL-ENT   362--CALL
TCM_CONNECTED
       186**DCL       357>>IF        360<<ASSIGN
TCM_DELETEMES
       344**DCL       371<>CALL
TCM_EXEC
       145**DCL       353<<ASSIGN
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:244  
TCM_TURNON.V
       271**DCL       270--DCLINIT
TCM_TURNON.V.DVBYTE.REREAD#
       273**DCL       273--REDEF
TCM_UOBUF
       180**DCL       366<<ASSIGN    367<<ASSIGN    373<<ASSIGN
TCM_USING_PAD
       181**DCL       361>>IF        365>>IF
TCM_WRITEUO
       166**DCL       369<>CALL      375<>CALL
TCM_WRITEUO.STATION_
       168**DCL       168--REDEF
TCM_WRITEUO.V.DVBYTE.VFC#
       175**DCL       175--REDEF
TCM_XCON$
       258**DCL       380>>IF        381>>ASSIGN
WAIT5.V
       200**DCL       199--DCLINIT
WRITE_STATION
       318**DCL       270--DCLINIT   294--DCLINIT
WRITE_STATION.MSGIDXT
       328**DCL       331--REDEF
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:245  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:246  
              MINI UREF LISTING

M$ACCT      33**DCL-ENT
M$ACTIVATE      36**DCL-ENT
M$ALIB      29**DCL-ENT
M$ASUSER      31**DCL-ENT
M$ATTACH      38**DCL-ENT
M$BADPP      56**DCL-ENT
M$CGCTL      37**DCL-ENT
M$CGINFO      37**DCL-ENT
M$CHECK      18**DCL-ENT
M$CHGUNIT      76**DCL-ENT
M$CLRSTK      74**DCL-ENT
M$CMDVAR      85**DCL-ENT
M$CONFIG      46**DCL-ENT
M$CORRES      21**DCL-ENT
M$CPEXIT      30**DCL-ENT
M$CVM      54**DCL-ENT
M$CVOL      19**DCL-ENT
M$DCLFLD      46**DCL-ENT
M$DELREC      18**DCL-ENT
M$DEQ      83**DCL-ENT
M$DETACH      38**DCL-ENT
M$DEVICE      20**DCL-ENT
M$DISPLAY      83**DCL-ENT
M$DISPRES      23**DCL-ENT
M$DLIB      29**DCL-ENT
M$DRIBBLE      46**DCL-ENT
M$DRTN      74**DCL-ENT
M$DSUSER      31**DCL-ENT
M$ENQ      82**DCL-ENT
M$EOM      41**DCL-ENT
M$ERASE      47**DCL-ENT
M$ERR      28**DCL-ENT
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:247  
M$ERRMSG      79**DCL-ENT
M$EVENT      71**DCL-ENT
M$EXHUME      80**DCL-ENT
M$EXIT      28**DCL-ENT
M$EXTEND      20**DCL-ENT
M$FDP      52**DCL-ENT
M$FDS      51**DCL-ENT
M$FEBOOT      44**DCL-ENT
M$FECTL      45**DCL-ENT
M$FEDUMP      44**DCL-ENT
M$FID      79**DCL-ENT
M$FINDPROC      33**DCL-ENT
M$FSUSER      31**DCL-ENT
M$FVP      53**DCL-ENT
M$GBPL      57**DCL-ENT
M$GDDL      53**DCL-ENT
M$GDP      52**DCL-ENT
M$GDS      51**DCL-ENT
M$GETDCB      22**DCL-ENT
M$GETMOUSE      62**DCL-ENT
M$GETPM      63**DCL-ENT
M$GJOB      81**DCL-ENT
M$GLINEATTR      41**DCL-ENT
M$GOODPP      56**DCL-ENT
M$GPLATEN      49**DCL-ENT
M$GPROMPT      48**DCL-ENT
M$GTRMATTR      42**DCL-ENT
M$GTRMCTL      40**DCL-ENT
M$GTRMTAB      43**DCL-ENT
M$GVP      52**DCL-ENT
M$HELP      79**DCL-ENT
M$INT      71**DCL-ENT
M$INTRTN      32**DCL-ENT
M$IOQ      67**DCL-ENT
M$JOBSTATS      81**DCL-ENT
M$KEYIN      21**DCL-ENT
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:248  
M$LDEV      16**DCL-ENT
M$LDTRC      29**DCL-ENT
M$LIMIT      22**DCL-ENT
M$LINES      21**DCL-ENT
M$LINK      28**DCL-ENT
M$MADMUCK      24**DCL-ENT
M$MAKUSER      55**DCL-ENT
M$MBS      23**DCL-ENT
M$MDFFLD      47**DCL-ENT
M$MERC      72**DCL-ENT
M$MERCS      73**DCL-ENT
M$MIRROR      67**DCL-ENT
M$MONINFO      84**DCL-ENT
M$MPL      57**DCL-ENT
M$NODEINFO      48**DCL-ENT
M$NXTUSR      82**DCL-ENT
M$OCMSG      80**DCL-ENT
M$OLAY      28**DCL-ENT
M$OPEN      16**DCL-ENT
M$PAS      57**DCL-ENT
M$PATHCON      80**DCL-ENT
M$PDS      51**DCL-ENT
M$PFIL      18**DCL-ENT
M$PLATEN      42**DCL-ENT
M$PRECORD      20**DCL-ENT
M$PROCNAME      33**DCL-ENT
M$PROFILE      44**DCL-ENT
M$PROMPT      40**DCL-ENT
M$RACST      24**DCL-ENT
M$RDSYSLOG      65**DCL-ENT
M$READ      17**DCL-ENT
M$RELDCB      22**DCL-ENT
M$RELRES      23**DCL-ENT
M$RELSTARF      25**DCL-ENT
M$REM      25**DCL-ENT
M$RENV      72**DCL-ENT
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:249  
M$REQUIRE      24**DCL-ENT
M$RETRY      73**DCL-ENT
M$RETRYS      73**DCL-ENT
M$REW      19**DCL-ENT
M$RLSFLD      47**DCL-ENT
M$RPRIV      75**DCL-ENT
M$RSPP      54**DCL-ENT
M$RSWITCH      76**DCL-ENT
M$RUE      82**DCL-ENT
M$SAD      55**DCL-ENT
M$SAVE      31**DCL-ENT
M$SCON      32**DCL-ENT
M$SCREECH      30**DCL-ENT
M$SENV      72**DCL-ENT
M$SETFMA      16**DCL-ENT
M$SETFP      45**DCL-ENT
M$SINPUT      43**DCL-ENT
M$SLCFLD      48**DCL-ENT
M$SMOUSE      62**DCL-ENT
M$SMPRT      54**DCL-ENT
M$SPRIV      75**DCL-ENT
M$SSC      55**DCL-ENT
M$SSWITCH      75**DCL-ENT
M$STATE      84**DCL-ENT
M$STD      56**DCL-ENT
M$STIMER      70**DCL-ENT
M$STLPP      53**DCL-ENT
M$STRAP      70**DCL-ENT
M$STRMATTR      42**DCL-ENT
M$STRMCTL      40**DCL-ENT
M$STRMTAB      43**DCL-ENT
M$SYMBIO      81**DCL-ENT
M$SYSCON      67**DCL-ENT
M$SYSID      85**DCL-ENT
M$TDCLOSE      66**DCL-ENT
M$TDIO      66**DCL-ENT
PL6.E3A0      #008=TCM$ALEX_DISCONNECT File=TCM$ALEX2.:TCA2TSI                   SUN 11/16/97 14:20 Page:250  
M$TDOPEN      65**DCL-ENT
M$TDREQCPU      66**DCL-ENT
M$TEMPWROC      60**DCL-ENT
M$TIME      83**DCL-ENT
M$TRAP      70**DCL-ENT
M$TRMISC      45**DCL-ENT
M$TRMPRG      41**DCL-ENT
M$TRTN      74**DCL-ENT
M$TRUNC      17**DCL-ENT
M$TTIMER      70**DCL-ENT
M$UC      40**DCL
M$UMPL      57**DCL-ENT
M$UNFID      79**DCL-ENT
M$UNLATCH      36**DCL-ENT
M$UNSHARE      33**DCL-ENT
M$USRFIELD      76**DCL-ENT
M$VIRTUAL      51**DCL-ENT
M$WAIT      74**DCL-ENT
M$WEOF      19**DCL-ENT
M$WRSYSLOG      65**DCL-ENT
M$XCONRTN      32**DCL-ENT
M$XEQTIME      84**DCL-ENT
M$XFLUSH      25**DCL-ENT
M$XMOUSE      62**DCL-ENT
M$XXX      28**DCL-ENT
M$YC      30**DCL-ENT
SHUTDOWN     356**LABEL
TCM$ALEX_DISCONNECT       6**PROC
TCM_BLEN     182**DCL
TCM_OUTREC     184**DCL
TCM_SITE     183**DCL
TCM_WRITECGBUF     185**DCL

PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:251  
      896        1        /*T***********************************************************/
      897        2        /*T*                                                         */
      898        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      899        4        /*T*                                                         */
      900        5        /*T***********************************************************/
      901        6        TCM$ALEX_DRAIN: PROC (COUNT);
      902        7    1   dcl COUNT ubin;
      903        8        %include CP_6;
      904       89    1   dcl F$CG dcb;
      905       90        %FPT_CGINFO (FPTN=GET_INFO, STCLASS=CONSTANT, DCB=F$CG, STATS=VLR_CGSTATS);
      906      110        %VLR_CGSTATS (STCLASS=STATIC);
      907      134
      908      135    1        CALL M$CGINFO(GET_INFO);
      909      136
      910      137    1        COUNT = minimum(VLR_CGSTATS.NUMTERMS,1) * VLR_CGSTATS.CCMS;
      911      138
      912      139    1        return;
      913      140
      914      141    1   end TCM$ALEX_DRAIN;
      915      142        %EOD;

PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:252  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_DRAIN.

   Procedure TCM$ALEX_DRAIN requires 14 words for executable code.
   Procedure TCM$ALEX_DRAIN requires 4 words of local(AUTO) storage.

PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:253  

 Object Unit name= TCM$ALEX_DRAIN                             File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:21:21.68 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  F$CG
    2  RoData even  UTS     50     62  TCM$ALEX_DRAIN
    3   Data  even  none    18     22  TCM$ALEX_DRAIN
    4   Proc  even  none    14     16  TCM$ALEX_DRAIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  TCM$ALEX_DRAIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  F$CG
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:254  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:255  


      896        1        /*T***********************************************************/
      897        2        /*T*                                                         */
      898        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      899        4        /*T*                                                         */
      900        5        /*T***********************************************************/
      901        6        TCM$ALEX_DRAIN: PROC (COUNT);

      6  4 000000   000000 700200 xent  TCM$ALEX_DR* TSX0  ! X66_AUTO_1
         4 000001   000004 000001                    ZERO    4,1

      902        7    1   dcl COUNT ubin;
      903        8        %include CP_6;
      904       89    1   dcl F$CG dcb;
      905       90        %FPT_CGINFO (FPTN=GET_INFO, STCLASS=CONSTANT, DCB=F$CG, STATS=VLR_CGSTATS);
      906      110        %VLR_CGSTATS (STCLASS=STATIC);
      907      134
      908      135    1        CALL M$CGINFO(GET_INFO);

    135  4 000002   000000 630400 2                  EPPR0   GET_INFO
         4 000003   100004 713400                    CLIMB   32772
         4 000004   411400 401760                    pmme    nvectors=20

      909      136
      910      137    1        COUNT = minimum(VLR_CGSTATS.NUMTERMS,1) * VLR_CGSTATS.CCMS;

    137  4 000005   000001 236007                    LDQ     1,DL
         4 000006   000011 604000 4                  TMI     s:137+4
         4 000007   000007 116000 3                  CMPQ    VLR_CGSTATS+7
         4 000010   000012 604400 4                  TMOZ    s:137+5
         4 000011   000007 236000 3                  LDQ     VLR_CGSTATS+7
         4 000012   000005 402000 3                  MPY     VLR_CGSTATS+5
         4 000013   200003 470500                    LDP0    @COUNT,,AUTO
         4 000014   000000 756100                    STQ     0,,PR0

      911      138
      912      139    1        return;
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:256  

    139  4 000015   000000 702200 xent               TSX2  ! X66_ARET

GET_INFO
 Sect OctLoc
   2     000   000011 777640   000050 006000   000000 177640   000000 006014    .....(..........
   2     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     010   000000 177640   000000 006014   000021 777640   000000 006000    ................
   2     014   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     050*  000000 000011   000000 000000   000000 000000   000000 000000    ................
   2     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     060   000000 000000   ****** ******                                    ........

VLR_CGSTATS
 Sect OctLoc
   3     000   000000 000000   000000 000000   000000 000000   000000 000000    ................
   3     020*  000000 000000   000000 000000                                    ........
      913      140
      914      141    1   end TCM$ALEX_DRAIN;
      915      142        %EOD;

PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:257  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_DRAIN.
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:258  

 **** Variables and constants ****

  ****  Section 002 RoData TCM$ALEX_DRAIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1800)  r     1 GET_INFO

  ****  Section 003  Data  TCM$ALEX_DRAIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(648)   r     1 VLR_CGSTATS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @COUNT                    *0-0-0/w UBIN        r     1 COUNT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 F$CG


   Procedure TCM$ALEX_DRAIN requires 14 words for executable code.
   Procedure TCM$ALEX_DRAIN requires 4 words of local(AUTO) storage.
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:259  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:260  
          MINI XREF LISTING

COUNT
         7**DCL         6--PROC      137<<ASSIGN
GET_INFO
       101**DCL       135<>CALL
GET_INFO.V
       106**DCL       101--DCLINIT
M$CGINFO
        38**DCL-ENT   135--CALL
VLR_CGSTATS
       122**DCL       103--DCLINIT
VLR_CGSTATS.CCMS
       127**DCL       137>>ASSIGN
VLR_CGSTATS.NUMTERMS
       128**DCL       137>>ASSIGN
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:261  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:262  
              MINI UREF LISTING

F$CG      89**DCL
M$ACCT      34**DCL-ENT
M$ACTIVATE      37**DCL-ENT
M$ALIB      30**DCL-ENT
M$ASUSER      32**DCL-ENT
M$ATTACH      39**DCL-ENT
M$BADPP      57**DCL-ENT
M$CGCTL      38**DCL-ENT
M$CHECK      19**DCL-ENT
M$CHGUNIT      77**DCL-ENT
M$CLOSE      17**DCL-ENT
M$CLRSTK      75**DCL-ENT
M$CMDVAR      86**DCL-ENT
M$CONFIG      47**DCL-ENT
M$CORRES      22**DCL-ENT
M$CPEXIT      31**DCL-ENT
M$CVM      55**DCL-ENT
M$CVOL      20**DCL-ENT
M$DCLFLD      47**DCL-ENT
M$DEACTIVATE      37**DCL-ENT
M$DELREC      19**DCL-ENT
M$DEQ      84**DCL-ENT
M$DETACH      39**DCL-ENT
M$DEVICE      21**DCL-ENT
M$DISPLAY      84**DCL-ENT
M$DISPRES      24**DCL-ENT
M$DLIB      30**DCL-ENT
M$DRIBBLE      47**DCL-ENT
M$DRTN      75**DCL-ENT
M$DSUSER      32**DCL-ENT
M$ENQ      83**DCL-ENT
M$EOM      42**DCL-ENT
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:263  
M$ERASE      48**DCL-ENT
M$ERR      29**DCL-ENT
M$ERRMSG      80**DCL-ENT
M$EVENT      72**DCL-ENT
M$EXHUME      81**DCL-ENT
M$EXIT      29**DCL-ENT
M$EXTEND      21**DCL-ENT
M$FDP      53**DCL-ENT
M$FDS      52**DCL-ENT
M$FEBOOT      45**DCL-ENT
M$FECTL      46**DCL-ENT
M$FEDUMP      45**DCL-ENT
M$FID      80**DCL-ENT
M$FINDPROC      34**DCL-ENT
M$FSUSER      32**DCL-ENT
M$FVP      54**DCL-ENT
M$FWCG      38**DCL-ENT
M$GBPL      58**DCL-ENT
M$GDDL      54**DCL-ENT
M$GDP      53**DCL-ENT
M$GDS      52**DCL-ENT
M$GETDCB      23**DCL-ENT
M$GETMOUSE      63**DCL-ENT
M$GETPM      64**DCL-ENT
M$GJOB      82**DCL-ENT
M$GLINEATTR      42**DCL-ENT
M$GOODPP      57**DCL-ENT
M$GPLATEN      50**DCL-ENT
M$GPROMPT      49**DCL-ENT
M$GTRMATTR      43**DCL-ENT
M$GTRMCTL      41**DCL-ENT
M$GTRMTAB      44**DCL-ENT
M$GVP      53**DCL-ENT
M$HELP      80**DCL-ENT
M$INT      72**DCL-ENT
M$INTRTN      33**DCL-ENT
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:264  
M$IOQ      68**DCL-ENT
M$JOBSTATS      82**DCL-ENT
M$KEYIN      22**DCL-ENT
M$LDEV      17**DCL-ENT
M$LDTRC      30**DCL-ENT
M$LIMIT      23**DCL-ENT
M$LINES      22**DCL-ENT
M$LINK      29**DCL-ENT
M$MADMUCK      25**DCL-ENT
M$MAKUSER      56**DCL-ENT
M$MBS      24**DCL-ENT
M$MDFFLD      48**DCL-ENT
M$MERC      73**DCL-ENT
M$MERCS      74**DCL-ENT
M$MIRROR      68**DCL-ENT
M$MONINFO      85**DCL-ENT
M$MPL      58**DCL-ENT
M$NODEINFO      49**DCL-ENT
M$NXTUSR      83**DCL-ENT
M$OCMSG      81**DCL-ENT
M$OLAY      29**DCL-ENT
M$OPEN      17**DCL-ENT
M$PAS      58**DCL-ENT
M$PATHCON      81**DCL-ENT
M$PDS      52**DCL-ENT
M$PFIL      19**DCL-ENT
M$PLATEN      43**DCL-ENT
M$PRECORD      21**DCL-ENT
M$PROCNAME      34**DCL-ENT
M$PROFILE      45**DCL-ENT
M$PROMPT      41**DCL-ENT
M$RACST      25**DCL-ENT
M$RDSYSLOG      66**DCL-ENT
M$READ      18**DCL-ENT
M$RELDCB      23**DCL-ENT
M$RELRES      24**DCL-ENT
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:265  
M$RELSTARF      26**DCL-ENT
M$REM      26**DCL-ENT
M$RENV      73**DCL-ENT
M$REQUIRE      25**DCL-ENT
M$RETRY      74**DCL-ENT
M$RETRYS      74**DCL-ENT
M$REW      20**DCL-ENT
M$RLSFLD      48**DCL-ENT
M$RPRIV      76**DCL-ENT
M$RSPP      55**DCL-ENT
M$RSWITCH      77**DCL-ENT
M$RUE      83**DCL-ENT
M$SAD      56**DCL-ENT
M$SAVE      32**DCL-ENT
M$SCON      33**DCL-ENT
M$SCREECH      31**DCL-ENT
M$SENV      73**DCL-ENT
M$SETFMA      17**DCL-ENT
M$SETFP      46**DCL-ENT
M$SINPUT      44**DCL-ENT
M$SLCFLD      49**DCL-ENT
M$SMOUSE      63**DCL-ENT
M$SMPRT      55**DCL-ENT
M$SPRIV      76**DCL-ENT
M$SSC      56**DCL-ENT
M$SSWITCH      76**DCL-ENT
M$STATE      85**DCL-ENT
M$STD      57**DCL-ENT
M$STIMER      71**DCL-ENT
M$STLPP      54**DCL-ENT
M$STRAP      71**DCL-ENT
M$STRMATTR      43**DCL-ENT
M$STRMCTL      41**DCL-ENT
M$STRMTAB      44**DCL-ENT
M$SYMBIO      82**DCL-ENT
M$SYSCON      68**DCL-ENT
PL6.E3A0      #009=TCM$ALEX_DRAIN File=TCM$ALEX2.:TCA2TSI                        SUN 11/16/97 14:21 Page:266  
M$SYSID      86**DCL-ENT
M$TDCLOSE      67**DCL-ENT
M$TDIO      67**DCL-ENT
M$TDOPEN      66**DCL-ENT
M$TDREQCPU      67**DCL-ENT
M$TEMPWROC      61**DCL-ENT
M$TIME      84**DCL-ENT
M$TRAP      71**DCL-ENT
M$TRMISC      46**DCL-ENT
M$TRMPRG      42**DCL-ENT
M$TRTN      75**DCL-ENT
M$TRUNC      18**DCL-ENT
M$TTIMER      71**DCL-ENT
M$UC      41**DCL
M$UMPL      58**DCL-ENT
M$UNFID      80**DCL-ENT
M$UNLATCH      37**DCL-ENT
M$UNSHARE      34**DCL-ENT
M$USRFIELD      77**DCL-ENT
M$VIRTUAL      52**DCL-ENT
M$WAIT      75**DCL-ENT
M$WEOF      20**DCL-ENT
M$WRITE      18**DCL-ENT
M$WRSYSLOG      66**DCL-ENT
M$XCON      72**DCL-ENT
M$XCONRTN      33**DCL-ENT
M$XEQTIME      85**DCL-ENT
M$XFLUSH      26**DCL-ENT
M$XMOUSE      63**DCL-ENT
M$XXX      29**DCL-ENT
M$YC      31**DCL-ENT
TCM$ALEX_DRAIN       6**PROC

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:267  
      916        1        /*T***********************************************************/
      917        2        /*T*                                                         */
      918        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      919        4        /*T*                                                         */
      920        5        /*T***********************************************************/
      921        6        TCM$ALEX_PAD_CONNECT: proc(ADDRESS, PAR, STATUS, BAILOUT) altret;
      922        7        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
      923        8    1   dcl TBUF char(1) static;
      924        9    1   dcl PAR    ubin;
      925       10    1   dcl ADDRESS   char(32);
      926       11    1   dcl 1  STATUS   aligned,
      927       12    1         2 HOST_SHUT bit(1);
      928       13    1   dcl TCM_G_PARITY ubin symref;
      929       14    1   dcl BAILOUT remember;
      930       15    1   dcl TCM_ALEX_BAILOUT remember symref;
      931       16    1   dcl TCM_ALEX_BAILOUT_ENABLED redef TCM_ALEX_BAILOUT bit(72);
      932       17        %include CP_6;
      933       98                                                /* Based */
      934       99
      935      100        %F$DCB;
      936      157        %MACRO WRITEUO;
      937      158             call M$WRITE(TCM_WRITEUO) whenaltreturn do; end;
      938      159        %MEND;
      939      160        %include B$JIT;
      940      450    1   dcl B$JIT$ ptr symref;
      941      451        %B$TCB;
      942      454        %B$NWIO;
      943      539        %B$CGAUCRD;
      944      602    1   dcl F$CG dcb;
      945      603    1   dcl M$SI dcb;
      946      604    1   dcl F$USER dcb;
      947      605    1   dcl F$UO   dcb;
      948      606    1   dcl F$CG$  ptr symref;
      949      607    1   dcl F$USER$ ptr static;
      950      608    1   dcl 1 SLOG static,
      951      609    1         2 LEN ubin(9) caligned,
      952      610    1         2 TEXT(0:23) char(1) caligned;
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:268  
      953      611    1   dcl TCM_USING_PAD bit(1) SYMREF;
      954      612    1   dcl TCM_COMMAND   bit(1) symref;
      955      613    1   dcl TCM_EXEC      bit(1) symref;
      956      614    1   dcl TCM_INT       bit(1) symref;
      957      615    1   dcl TCM_LOCAL     bit(1) symref;
      958      616    1   dcl TCM_NEEDREAD  bit(1) symref;
      959      617    1   dcl TCM_LOCALMODE bit(1) symref;
      960      618    1   dcl TCM_CONNECTED bit(1) symref;
      961      619    1   dcl TCM_MODEMBUF  char(1280) symref;
      962      620    1   dcl TCM_MBLEN     ubin symref;
      963      621    1   dcl RETRY     ubin static;
      964      622    1   dcl TEMP      ubin static;
      965      623    1   dcl ACTUAL_PAD_SPEED ubin static init(12); /* Use 2400 baud */
      966      624    1   dcl BREAK_PAD_SPEED ubin static init(0); /* Try 50 baud   */
      967      625    1   dcl CMDI             ubin static;
      968      626    1   dcl TCM_TIMEOUT          ubin symref;
      969      627    1   dcl I                ubin static;
      970      628    1   dcl CR               char(1) static init(binasc(13));
      971      629    1   dcl LF               char(1) static init(binasc(10));
      972      630    1   dcl FLAG             ubin static;
      973      631    1   dcl TCM_EPTBLI(0:3)      bit(32) unal symref;
      974      632    1   dcl EPTBL(0:127)     redef TCM_EPTBLI bit(1) unal;
      975      633    1   dcl TCM_OPTBLI(0:3)      bit(32) unal symref;
      976      634    1   dcl OPTBL(0:127)     redef TCM_OPTBLI bit(1) unal;
      977      635    1   dcl EIGHT_VAL        ubin(9) static unal;
      978      636    1   dcl EIGHT_TBL(0:4)   ubin(9) static unal init(184,56,184,184,56);
      979      637    1   dcl PAREN_VAL        ubin(9) static unal;
      980      638    1   dcl PAREN_TBL(0:4)   ubin(9) static unal init(40,168,40,168,40);
      981      639    1   dcl TCM_STRIPPAR(0:511)  ubin(9) unal symref;
      982      640    1   dcl TCM_OUTREC           char(332) symref;
      983      641    1   dcl 1 WARNMES        static,
      984      642    1         2 *            ubin(9) unal init(13),
      985      643    1         2 *            ubin(9) unal init(07),
      986      644    1         2 *            char(0) init('WARNING, 5 minutes without IO '),
      987      645    1         2 *            char(0) init('have passed, ALEX will LOG you'),
      988      646    1         2 *            char(0) init(' off in 1 minute.'),
      989      647    1         2 *            ubin(9) unal init(07),
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:269  
      990      648    1         2 *            ubin(9) unal init(13);
      991      649    1   dcl 1 OFFMES         static,
      992      650    1         2 *            ubin(9) unal init(13),
      993      651    1         2 *            ubin(9) unal init(07),
      994      652    1         2 *            char(0) init('6 minutes without IO have pass'),
      995      653    1         2 *            char(0) init('ed, ALEX has logged you off'),
      996      654    1         2 *            ubin(9) unal init(07),
      997      655    1         2 *            ubin(9) unal init(13);
      998      656
      999      657                                                /* Fpts */
     1000      658
     1001      659        %FPT_OPEN( FPTN=OPENCG, STCLASS=CONSTANT,
     1002      660                   SCRUB=YES,
     1003      661                   DCB=F$CG,
     1004      662                   AU=YES,
     1005      663                   NAME=CG_NAME,
     1006      664                   ACCT=CG_ACCT,
     1007      665                   ACCESS=ACC,
     1008      666                   ACSVEH=ACV,
     1009      667                   ASN=COMGROUP,
     1010      668                   SETSTA=OPENSTA,
     1011      669                   FUN=CREATE,
     1012      670                   IXTNSIZE=200,
     1013      671                   SHARE=ALL,
     1014      672                   CTG=YES,
     1015      673                   EXIST=OLDFILE);
     1016      782
     1017      783        %VLP_SETSTA(  FPTN=OPENSTA,  STCLASS=CONSTANT,
     1018      784                      MYSTATION='ALEX');
     1019      812
     1020      813        %VLP_NAME(    FPTN=CG_NAME,  STCLASS=CONSTANT,
     1021      814                      NAME='PADCG');
     1022      841
     1023      842        %VLP_ACCT(    FPTN=CG_ACCT, STCLASS=CONSTANT,
     1024      843                      ACCT=':SYS');
     1025      856
     1026      857        %VLP_ATTR(    FPTN=ACC);
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:270  
     1027      871        %VLP_ACCESS(  READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
     1028      872                      REATTR=YES, AU=YES, TCTL=YES, ACCT='BJF?');
     1029      889        %VLP_ACCESS(  EXEC=YES, ACCT='?', LAST=";");
     1030      906
     1031      907        %VLP_ATTR(    FPTN=ACV);
     1032      921        %VLP_ACSVEH(  READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
     1033      922                      REATTR=YES, AU=YES, TCTL=YES, VEHICLE='MULSEND',LAST=";");
     1034      939
     1035      940        %FPT_OPEN(    FPTN=DELCG, STCLASS=CONSTANT,
     1036      941                      SCRUB=YES,
     1037      942                      DCB=F$CG,
     1038      943                      ASN=FILE,
     1039      944                      NAME=CG_NAME,
     1040      945                      ACCT=CG_ACCT,
     1041      946                      FUN=IN,
     1042      947                      SHARE=ALL,
     1043      948                      DELETE=YES);
     1044     1057
     1045     1058        %FPT_OPEN(    FPTN=OPENUSER,
     1046     1059                      DVFC='@',
     1047     1060                      DCB=F$USER,
     1048     1061                      ORG=TERMINAL,
     1049     1062                      FUN=UPDATE,
     1050     1063                      ASN=DEVICE);
     1051     1172
     1052     1173        %FPT_FWCG(    FPTN=TCM_DELETEMES,   STCLASS="SYMREF",
     1053     1174                      DCB=F$CG,
     1054     1175                      CRITERIA=VLP_CGMA,
     1055     1176                      DELETE=YES,
     1056     1177                      SCA=VLP_SCGMA);
     1057     1196
     1058     1197        %VLP_CGMA(                      STCLASS=CONSTANT,
     1059     1198                      ORIGIN='?',
     1060     1199                      DEST='?');
     1061     1226
     1062     1227        %VLP_SCGMA(                     STCLASS=CONSTANT,
     1063     1228                      ORIGIN=YES,
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:271  
     1064     1229                      DEST=YES);
     1065     1246
     1066     1247        %FPT_WRITE(   FPTN=TCM_WRITECG,     STCLASS=SYMREF,
     1067     1248                      DCB=F$CG,
     1068     1249                      STATION=WRITE_STATION,
     1069     1250                      TRANS=YES);
     1070     1281
     1071     1282    1   dcl TCM_WRITECGBUF         char(256) symref;
     1072     1283
     1073     1284        %FPT_WRITE(   FPTN=TCM_WRITEUSER,   STCLASS="SYMREF",
     1074     1285                      DCB=F$USER,
     1075     1286                      TRANS=YES,
     1076     1287                      BUF=TCM_WRITEUSERBUF);
     1077     1318
     1078     1319    1   dcl  TCM_WRITEUSERBUF      char(256) symref;
     1079     1320    1   dcl  CMDBUF            char(256) static;
     1080     1321    1   dcl  CMDBUFLEN         ubin      static;
     1081     1322
     1082     1323        %VLP_STATION( FPTN=WRITE_STATION,  STCLASS=STATIC,
     1083     1324                      STATION='MODEM');
     1084     1351
     1085     1352        %VLP_STATION( FPTN=CMDSTATION,     STCLASS=STATIC,
     1086     1353                      STATION='MODEM',
     1087     1354                      EOFNONE=YES);
     1088     1381
     1089     1382        %FPT_TRMISC(  FPTN=INHIBIT_OPERATOR_MESSAGES,
     1090     1383                      STCLASS=CONSTANT,
     1091     1384                      DCB=F$CG,
     1092     1385                      STATION=WRITE_STATION,
     1093     1386                      ANNOUNCE=NO,
     1094     1387                      SEND=NO);
     1095     1408
     1096     1409        %FPT_TRMATTR( FPTN=CURRENT_TRMATTR,
     1097     1410                      STCLASS=CONSTANT,
     1098     1411                      DCB=F$CG,
     1099     1412                      STATION=WRITE_STATION,
     1100     1413                      TRMATTR=SAVED_TRMATTR);
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:272  
     1101     1438
     1102     1439        %VLP_TRMATTR( FPTN=SAVED_TRMATTR);
     1103     1477
     1104     1478        %FPT_TRMATTR( FPTN=SET_LOW_SPEED,
     1105     1479                      STCLASS=CONSTANT,
     1106     1480                      DCB=F$CG,
     1107     1481                      STATION=WRITE_STATION,
     1108     1482                      TRMATTR=LOW_SPEED);
     1109     1507
     1110     1508        %VLP_TRMATTR( FPTN=LOW_SPEED,         STCLASS=STATIC,
     1111     1509                      PARITY=NONE);
     1112     1547
     1113     1548        %FPT_READ(    FPTN=TCM_READCMD,           STCLASS="SYMREF",
     1114     1549                      DCB=F$CG,
     1115     1550                      STATION=CMDSTATION,
     1116     1551                      TRANS=YES,
     1117     1552                      WAIT=YES,
     1118     1553                      BUF=TCM_READCGBUF);
     1119     1592
     1120     1593        %FPT_READ(    FPTN=TCM_READCG,            STCLASS="SYMREF",
     1121     1594                      STATION=CGSTATION,
     1122     1595                      TRANS=YES,
     1123     1596                      WAIT=NO,
     1124     1597                      EVENT=1,
     1125     1598                      DCB=F$CG,
     1126     1599                      BUF=TCM_READCGBUF);
     1127     1638
     1128     1639        %FPT_READ(    FPTN=TCM_READCGNONTRANS,    STCLASS=CONSTANT,
     1129     1640                      STATION=CGSTATION,
     1130     1641                      TRANS=NO,
     1131     1642                      WAIT=NO,
     1132     1643                      EVENT=1,
     1133     1644                      DCB=F$CG,
     1134     1645                      BUF=TCM_READCGBUF);
     1135     1684
     1136     1685        %FPT_READ(    FPTN=READAU,            STCLASS=CONSTANT,
     1137     1686                      DCB=F$CG,
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:273  
     1138     1687                      WAIT=NO,
     1139     1688                      EVENT=1,
     1140     1689                      STATION=AUSTATION,
     1141     1690                      BUF=TCM_READCGBUF);
     1142     1729
     1143     1730        %VLP_STATION( FPTN=AUSTATION);  /*N* ADD MSGTYP='*?'  */
     1144     1757
     1145     1758        %VLP_STATION( FPTN=CGSTATION, STATION='MODEM');
     1146     1785    1   dcl TCM_READCGBUF                char(256) symref;
     1147     1786
     1148     1787        %FPT_READ(    FPTN=TCM_READCGBIG,         STCLASS=CONSTANT,
     1149     1788                      DCB=F$CG,
     1150     1789                      BUF=BIGTBUF);
     1151     1828    1   dcl BIGTBUF                  char(256) static;
     1152     1829    1   dcl BUFC                     char(TCM_BLEN) based;
     1153     1830    1   dcl TCM_BLEN                     ubin      symref;
     1154     1831
     1155     1832        %FPT_CLOSE(   FPTN=CLOSELO,           STCLASS=CONSTANT,
     1156     1833                      DCB=F$UO);
     1157     1875
     1158     1876        %FPT_ACTIVATE(FPTN=TCM_TURNON,            STCLASS="SYMREF",
     1159     1877                      TRANS=YES,
     1160     1878                      ABTREAD='1'B,
     1161     1879                      DCB=F$CG,
     1162     1880                      FLUSH=YES,
     1163     1881                      STATION=WRITE_STATION);
     1164     1904
     1165     1905        %FPT_ACTIVATE(FPTN=TCM_TURNOFF,           STCLASS="SYMREF",
     1166     1906                      DCB=F$CG,
     1167     1907                      DISCONNECT=NO,
     1168     1908                      STATION=WRITE_STATION,
     1169     1909                      FLUSH=YES);
     1170     1932
     1171     1933        %FPT_CGCTL(                           STCLASS=CONSTANT,
     1172     1934                      DCB=F$CG,
     1173     1935                      CGCP=VLP_CGCP);
     1174     1958
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:274  
     1175     1959        %VLP_CGCP(                            STCLASS=CONSTANT,
     1176     1960                      MAXPG=25,
     1177     1961                      CONMSG=YES,
     1178     1962                      TERMCONAU=NO,
     1179     1963                      DCBCONAU=NO,
     1180     1964                      TERMCONNAU=NO,
     1181     1965                      DCBCONNAU=NO,
     1182     1966                      AUDCONDCB=DEACTIVATE,
     1183     1967                      AUDCONTERM=DISCONNECT,
     1184     1968                      DCBCONLGL=YES,
     1185     1969                      TERMCONLGL=YES);
     1186     2012
     1187     2013        %FPT_CGINFO(  FPTN=GET_INFO,          STCLASS=CONSTANT,
     1188     2014                      DCB=F$CG,
     1189     2015                      STATS=VLR_CGSTATS);
     1190     2035
     1191     2036        %VLR_CGSTATS( STCLASS=STATIC);
     1192     2060
     1193     2061        %FPT_EVENT(   FPTN=FPT_EVENT,         STCLASS=CONSTANT,
     1194     2062                      UENTRY=TCM$ALEX_EVNT);
     1195     2076
     1196     2077        %FPT_XCON(    UENTRY=TCM$ALEX_XCON, PXCON=TCM_XCON$);
     1197     2091    1   DCL TCM_XCON$ EPTR SYMREF;
     1198     2092
     1199     2093        %FPT_WAIT(    FPTN=TCM_NORM,    UNITS=2,  STCLASS="SYMREF");
     1200     2107        %FPT_WAIT(    FPTN=TCM_WAIT1,   UNITS=1,  STCLASS="SYMREF");
     1201     2121        %FPT_WAIT(    FPTN=TCM_TAKE5,   UNITS=5,  STCLASS="SYMREF");
     1202     2135        %FPT_WAIT(    FPTN=TAKE15,  UNITS=15, STCLASS="CONSTANT");
     1203     2149
     1204     2150        %FPT_READ(    FPTN=READSI,   DCB=M$SI,   BUF=SIBUF);
     1205     2189        %FPT_WRITE(   FPTN=TCM_WRITEUO,  DCB=F$UO,   BUF=TCM_UOBUF, STCLASS=SYMREF);
     1206     2220
     1207     2221    1   dcl  SIBUF                   char(256) static;
     1208     2222    1   dcl  TCM_UOBUF                   char(256) symref;
     1209     2223
     1210     2224        %FPT_READ(    FPTN=READUSER, DCB=F$USER, BUF=TCM_READUSERBUF, TRANS=YES);
     1211     2263
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:275  
     1212     2264    1   dcl  TCM_READUSERBUF             char(256) symref;
     1213     2265
     1214     2266        %FPT_PROMPT(  FPTN=PROMPTUSER,        STCLASS=CONSTANT,
     1215     2267                      DCB=M$UC,
     1216     2268                      VFC=YES,
     1217     2269                      PROMPT=PCHAR);
     1218     2297
     1219     2298        %FPT_PROMPT(  FPTN=PROMPTCG,          STCLASS=CONSTANT,
     1220     2299                      DCB=F$CG,
     1221     2300                      VFC=YES,
     1222     2301                      PROMPT=PCHAR,
     1223     2302                      STATION=WRITE_STATION);
     1224     2330
     1225     2331    1   dcl PCHAR                    char(1) constant init('@');
     1226     2332    1   dcl LCLPROMPT                char(0) static init('Local:');
     1227     2333
     1228     2334        %FPT_EOM(     FPTN=EOMCG,             STCLASS=STATIC,
     1229     2335                      DCB=F$CG,
     1230     2336                      STATION=WRITE_STATION,
     1231     2337                      TIMEOUT=1,
     1232     2338                      UTYPE=SEC);
     1233     2368
     1234     2369        %FPT_EOM(     FPTN=EOMUSER,           STCLASS=CONSTANT,
     1235     2370                      DCB=M$UC,
     1236     2371                      TIMEOUT=50,
     1237     2372                      UTYPE=MIL10);
     1238     2402
     1239     2403        %FPT_TRMATTR( FPTN=SET_FLOW_CONTROL,  STCLASS=CONSTANT,
     1240     2404                      TRMATTR=DC1DC3,
     1241     2405                      DCB=F$CG,
     1242     2406                      STATION=WRITE_STATION);
     1243     2431
     1244     2432        %VLP_TRMATTR( FPTN=DC1DC3,            STCLASS=CONSTANT,
     1245     2433                      DVCFLWCTRALG=DC1DC3);
     1246     2471
     1247     2472    1   dcl  REMOVE_PROGRAM          char(0) constant
     1248     2473    1        init(%CONCAT(BITASC('015'O),'REMOTE.DBKPL6',BITASC('015'O)));
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:276  
     1249     2474
     1250     2475    1   dcl  PAD_PROMPT              char(2) constant
     1251     2476    1        init(%concat(binasc(10),'*'));
     1252     2477
     1253     2478    1   dcl  TCM$ALEX_EVNT              entry async;
     1254     2479    1   dcl  TCM$ALEX_DISCONNECT         entry altret;
     1255     2480    1   dcl  KOZINN                  entry(1) altret;
     1256     2481    1   dcl  TCM$ALEX_XCON               entry async;
     1257     2482    1   dcl  TCM$ALEX_OK                      entry altret;
     1258     2483    1   dcl  INTRO                   entry;
     1259     2484                                                /* Start here */
     1260     2485
     1261     2486    1        STATUS = '0'B;
     1262     2487    1        if addr(BAILOUT) = addr(NIL)
     1263     2488    1        then TCM_ALEX_BAILOUT_ENABLED = '0'B;
     1264     2489    1        else TCM_ALEX_BAILOUT = BAILOUT;
     1265     2490
     1266     2491    1        TCM_OUTREC = ' ';
     1267     2492    2        DO I=0 TO 3;
     1268     2493    3             DO TCM_BLEN=I*128 TO (I+1)*128;
     1269     2494    3                  TCM_STRIPPAR(TCM_BLEN)=MOD(TCM_BLEN,128);
     1270     2495    3                END;
     1271     2496    2           END;
     1272     2497        /* Get users parity */
     1273     2498    1        EIGHT_VAL=EIGHT_TBL(PAR);
     1274     2499    1        TCM_G_PARITY = PAR;
     1275     2500    1        PAREN_VAL=PAREN_TBL(PAR);
     1276     2501    1        TCM_USING_PAD = '1'B;
     1277     2502    1        TCM_CONNECTED = '0'B;
     1278     2503    1        CALL M$EVENT(FPT_EVENT);
     1279     2504    1        call M$OPEN(OPENUSER);
     1280     2505                                                /* Delete current comgroup  */
     1281     2506        /*   Call M$OPEN(DELCG) whenaltreturn do; end; */
     1282     2507    1        CALL M$OPEN (OPENCG) ALTRET(BADOPEN);
     1283     2508    2        DO WHILE ('0'B);
     1284     2509    2   BADOPEN:
     1285     2510    2             CALL M$OPEN (DELCG) ALTRET(CANT_CONTINUE); /* Delete bad comgroup */
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:277  
     1286     2511    2             CALL M$OPEN (OPENCG) ALTRET(CANT_CONTINUE); /* Try again */
     1287     2512    3             DO WHILE ('0'B);
     1288     2513    3   CANT_CONTINUE:
     1289     2514    3                  call TCM$ALEX_DISCONNECT;
     1290     2515    3                  altreturn;
     1291     2516    3                END;
     1292     2517    2           END;
     1293     2518    1        TCM_INT = '0'B;
     1294     2519    1        F$CG$ = dcbaddr(dcbnum(F$CG));
     1295     2520    1        F$USER$ = dcbaddr(dcbnum(F$USER));
     1296     2521    2        call M$FWCG(TCM_DELETEMES) whenaltreturn do; end;
     1297     2522    1        CALL M$CGCTL (FPT_CGCTL);
     1298     2523        /* Wait for logon message from device */
     1299     2524    1        CALL M$DEACTIVATE(TCM_TURNOFF);    /* Flush anything pending */
     1300     2525    1        TCM_MBLEN=0;
     1301     2526    1        TCM_COMMAND='1'B;
     1302     2527    1        CALL M$READ (READAU);
     1303     2528    1        I = 0;
     1304     2529    2        do until VLR_CGSTATS.NUMTERMS > 0  or  I = 15;
     1305     2530    2             I = I + 1;
     1306     2531    2             call M$WAIT(TCM_WAIT1);
     1307     2532    2             call M$CGINFO(GET_INFO);
     1308     2533    2           end;
     1309     2534    2        if VLR_CGSTATS.NUMTERMS > 0 then do;
     1310     2535                                                /* For now, assume logon */
     1311     2536    2             TCM_CONNECTED = '1'B;
     1312     2537    2             CALL M$ACTIVATE(TCM_TURNON);
     1313     2538    2             CALL M$WAIT(TCM_WAIT1);
     1314     2539    2             CALL M$DEACTIVATE(TCM_TURNOFF); /* Abrt pending read */
     1315     2540    2             CALL M$WAIT(TCM_WAIT1);
     1316     2541    2             CALL M$ACTIVATE(TCM_TURNON);  /* Now its ready */
     1317     2542    2           END;
     1318     2543    2        ELSE DO;
     1319     2544    2             TCM_UOBUF='PAD did not connect';
     1320     2545                  %WRITEUO;
     1321     2548    2             call TCM$ALEX_DISCONNECT;
     1322     2549    2             altreturn;
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:278  
     1323     2550    2           END;
     1324     2551        /*   Call intro; */
     1325     2552    1        CALL M$PROMPT(PROMPTCG);
     1326     2553    1        CALL M$EOM(EOMCG);
     1327     2554    1        call M$STRMATTR(SET_FLOW_CONTROL);
     1328     2555    1        call M$TRMISC(INHIBIT_OPERATOR_MESSAGES);
     1329     2556                                                /* Reset modem */
     1330     2557    1        CALL M$XCON(FPT_XCON);
     1331     2558        /*  Perform modem autobaud/autoparity; wait for a prompt */
     1332     2559    1        TCM_WRITECG.BUF_ = vector(substr(TCM_WRITECGBUF,,1));
     1333     2560    1        I = 3;
     1334     2561    1        call M$GTRMATTR( CURRENT_TRMATTR );
     1335     2562    1        SAVED_TRMATTR.SPEED# = ACTUAL_PAD_SPEED;
     1336     2563    1        LOW_SPEED.SPEED#     = BREAK_PAD_SPEED;
     1337     2564    1   AUTOBAUD:
     1338     2565    2        do until I = 0;
     1339     2566    2             call M$STRMATTR( SET_LOW_SPEED );
     1340     2567    2             TCM_WRITECGBUF = binasc(0);   /* Send a slow null; looks like a  */
     1341     2568    2             call M$WRITE (TCM_WRITECG);   /* break to a high speed device    */
     1342     2569    2             call M$WAIT(TCM_WAIT1);
     1343     2570    2             call M$STRMATTR( CURRENT_TRMATTR );
     1344     2571    2             call M$WAIT(TCM_WAIT1);
     1345     2572    2             TCM_WRITECGBUF = CR;
     1346     2573    2             call M$WRITE(TCM_WRITECG);
     1347     2574    2             call M$WAIT(TCM_WAIT1);
     1348     2575    2             TCM_WRITECGBUF = '.';
     1349     2576    2             call M$WRITE( TCM_WRITECG );
     1350     2577    2             call M$WAIT(TCM_WAIT1);
     1351     2578    2             TCM_WRITECGBUF = CR;
     1352     2579    2             call M$WRITE( TCM_WRITECG );
     1353     2580        /*  Wait for pad prompt      */
     1354     2581    2             RETRY = 0;
     1355     2582    2             TCM_INT = '0'B;
     1356     2583    2             TCM_MBLEN = 0;
     1357     2584    3             do while( RETRY<5 );
     1358     2585    4                  do inhibit;
     1359     2586    5                       call M$READ(TCM_READCG) whenaltreturn do; end;
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:279  
     1360     2587    4                       if not TCM_INT
     1361     2588    4                       then call M$WAIT(TCM_WAIT1);
     1362     2589    4                     end;
     1363     2590    4                  if TCM_INT then do;
     1364     2591    4                       call index(TEMP, PAD_PROMPT, substr(TCM_MODEMBUF,,TCM_MBLEN))
     1365     2592    5                       whenreturn do;
     1366     2593    5                            exit AUTOBAUD;
     1367     2594    5                          end;
     1368     2595    4                       if TCM_MBLEN = 1 and substr(TCM_MODEMBUF,,1) = '*'
     1369     2596    4                       then exit AUTOBAUD;
     1370     2597    4                     end;
     1371     2598    3                  RETRY = RETRY + 1;
     1372     2599    3                end;
     1373     2600    2             I = I - 1;
     1374     2601    2           end;
     1375     2602    2        if I = 0 then do;
     1376     2603    2             TCM_UOBUF = 'PAD dis not respond to autobaud sequence';
     1377     2604                  %WRITEUO;
     1378     2607    2             call TCM$ALEX_DISCONNECT;
     1379     2608    2             altreturn;
     1380     2609    2           end;
     1381     2610    1        call concat(TCM_WRITECGBUF,'SET5:1,6:5,12:1,20:0,105:2',CR);
     1382     2611    1        call index(TCM_BLEN,' ',TCM_WRITECGBUF);
     1383     2612    1        TCM_WRITECG.BUF_  = vector(substr(TCM_WRITECGBUF,,TCM_BLEN));
     1384     2613    1        call M$WRITE(TCM_WRITECG);
     1385     2614    1        call concat(TCM_UOBUF,'Calling ',ADDRESS);
     1386     2615             %WRITEUO;
     1387     2618    1        call concat(TCM_WRITECGBUF,'C R-',ADDRESS);
     1388     2619    1        call index(TCM_BLEN,'  ',TCM_WRITECGBUF);
     1389     2620    1        substr(TCM_WRITECGBUF,TCM_BLEN,1) = CR;
     1390     2621    1        TCM_BLEN = TCM_BLEN + 1;
     1391     2622    1        TCM_WRITECG.BUF_ = vector(substr(TCM_WRITECGBUF,,TCM_BLEN));
     1392     2623    1        call M$WRITE(TCM_WRITECG);
     1393     2624        /* Wait for connect message */
     1394     2625    1        RETRY = 0;
     1395     2626    1        TCM_MBLEN = 0;
     1396     2627    2   RED: do while(RETRY<60);
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:280  
     1397     2628    2             TCM_INT = '0'B;
     1398     2629    2             call M$READ(TCM_READCGNONTRANS); /*  Look for response  */
     1399     2630    3             do inhibit;
     1400     2631    3                  if not TCM_INT
     1401     2632    3                  then call M$WAIT(TCM_WAIT1);
     1402     2633    3                end;
     1403     2634    3             if TCM_INT then do;
     1404     2635    3                  call index(I,'clr',substr(TCM_MODEMBUF,,TCM_MBLEN));
     1405     2636    3                  if I >= TCM_MBLEN
     1406     2637    3                  then call index(I,'reset',substr(TCM_MODEMBUF,,TCM_MBLEN));
     1407     2638    3                  if I >= TCM_MBLEN
     1408     2639    3                  then call index(I,'engaged',substr(TCM_MODEMBUF,,TCM_MBLEN));
     1409     2640    3                  if I >= TCM_MBLEN
     1410     2641    3                  then call index(I,'err',substr(TCM_MODEMBUF,,TCM_MBLEN));
     1411     2642    4                  if I < TCM_MBLEN then do;
     1412     2643    4                       call concat(TCM_UOBUF, 'Circuit connection failed: ',
     1413     2644    4                         substr(TCM_MODEMBUF,,TCM_MBLEN));
     1414     2645                            %WRITEUO;
     1415     2648    4                       if substr(TCM_MODEMBUF,I,7) = 'clr occ' or
     1416     2649    4                         substr(TCM_MODEMBUF,I,7) = 'clr nc ' or
     1417     2650    4                         substr(TCM_MODEMBUF,I,7) = 'clr der' or
     1418     2651    4                         substr(TCM_MODEMBUF,I,7) = 'clr na ' or
     1419     2652    4                         substr(TCM_MODEMBUF,I,7) = 'clr np '
     1420     2653    4                       then STATUS.HOST_SHUT = '1'B;
     1421     2654    4                       call TCM$ALEX_DISCONNECT;
     1422     2655    4                       altreturn;
     1423     2656    4                     end;
     1424     2657    4                  else do;
     1425     2658    4                       call index(I,'com',substr(TCM_MODEMBUF,,TCM_MBLEN));
     1426     2659    5                       do inhibit;
     1427     2660    5                            if I<TCM_MBLEN then exit RED;
     1428     2661    5                            TCM_MBLEN = 0; /*  ? try this */
     1429     2662    5                          end;
     1430     2663    4                     end;
     1431     2664    3                end;
     1432     2665    2             RETRY = RETRY + 1;
     1433     2666    2           end;
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:281  
     1434     2667
     1435     2668    2        if RETRY = 60 then do;
     1436     2669    2             TCM_UOBUF = 'PAD did not connect circuit.';
     1437     2670                  %WRITEUO;
     1438     2673    2             call TCM$ALEX_DISCONNECT;
     1439     2674    2             altreturn;
     1440     2675    2           end;
     1441     2676
     1442     2677    1        TCM_MBLEN = 0;
     1443     2678    1        TCM_LOCALMODE = '0'B;
     1444     2679    1        TCM_NEEDREAD = '1'B;
     1445     2680    1        return;
     1446     2681    1   end TCM$ALEX_PAD_CONNECT;

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:282  
--  Include file information  --

   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_PAD_CONNECT.

   Procedure TCM$ALEX_PAD_CONNECT requires 469 words for executable code.
   Procedure TCM$ALEX_PAD_CONNECT requires 10 words of local(AUTO) storage.

    No errors detected in file TCM$ALEX2.:TCA2TSI    .

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:283  

 Object Unit name= TCM$ALEX_PAD_CONNECT                       File name= TCM$ALEX2.:TCA2TOU
 UTS= NOV 16 '97 14:21:36.04 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   440    670  TCM$ALEX_PAD_CONNECT
    1   DCB   even  none     0      0  M$UC
    2   DCB   even  none     0      0  F$CG
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  F$USER
    5   DCB   even  none     0      0  F$UO
    6  RoData even  UTS    488    750  TCM$ALEX_PAD_CONNECT
    7   Proc  even  none   469    725  TCM$ALEX_PAD_CONNECT
    8  RoData even  none     6      6  TCM$ALEX_PAD_CONNECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes    yes     yes      Std        4  TCM$ALEX_PAD_CONNECT
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:284  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 TCM$ALEX_EVNT
         yes          Async      0 TCM$ALEX_XCON
 yes     yes           Std       0 TCM$ALEX_DISCONNECT
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_INDEX
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     TCM_G_PARITY                          TCM_ALEX_BAILOUT                      M$UC
     B$JIT$                                F$CG                                  M$SI
     F$USER                                F$UO                                  F$CG$
     TCM_USING_PAD                         TCM_COMMAND                           TCM_INT
     TCM_NEEDREAD                          TCM_LOCALMODE                         TCM_CONNECTED
     TCM_MODEMBUF                          TCM_MBLEN                             TCM_EPTBLI
     TCM_OPTBLI                            TCM_STRIPPAR                          TCM_OUTREC
     TCM_DELETEMES                         TCM_WRITECG                           TCM_WRITECGBUF
     TCM_READCG                            TCM_READCGBUF                         TCM_BLEN
     TCM_TURNON                            TCM_TURNOFF                           TCM_XCON$
     TCM_WAIT1                             TCM_WRITEUO                           TCM_UOBUF
     TCM_READUSERBUF                       B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:285  


      916        1        /*T***********************************************************/
      917        2        /*T*                                                         */
      918        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      919        4        /*T*                                                         */
      920        5        /*T***********************************************************/
      921        6        TCM$ALEX_PAD_CONNECT: proc(ADDRESS, PAR, STATUS, BAILOUT) altret;

      6  7 000000   000000 700200 xent  TCM$ALEX_PA* TSX0  ! X66_AUTO_4
         7 000001   000012 000004                    ZERO    10,4

      922        7        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
      923        8    1   dcl TBUF char(1) static;
      924        9    1   dcl PAR    ubin;
      925       10    1   dcl ADDRESS   char(32);
      926       11    1   dcl 1  STATUS   aligned,
      927       12    1         2 HOST_SHUT bit(1);
      928       13    1   dcl TCM_G_PARITY ubin symref;
      929       14    1   dcl BAILOUT remember;
      930       15    1   dcl TCM_ALEX_BAILOUT remember symref;
      931       16    1   dcl TCM_ALEX_BAILOUT_ENABLED redef TCM_ALEX_BAILOUT bit(72);
      932       17        %include CP_6;
      933       98                                                /* Based */
      934       99
      935      100        %F$DCB;
      936      157        %MACRO WRITEUO;
      937      158             call M$WRITE(TCM_WRITEUO) whenaltreturn do; end;
      938      159        %MEND;
      939      160        %include B$JIT;
      940      450    1   dcl B$JIT$ ptr symref;
      941      451        %B$TCB;
      942      454        %B$NWIO;
      943      539        %B$CGAUCRD;
      944      602    1   dcl F$CG dcb;
      945      603    1   dcl M$SI dcb;
      946      604    1   dcl F$USER dcb;
      947      605    1   dcl F$UO   dcb;
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:286  
      948      606    1   dcl F$CG$  ptr symref;
      949      607    1   dcl F$USER$ ptr static;
      950      608    1   dcl 1 SLOG static,
      951      609    1         2 LEN ubin(9) caligned,
      952      610    1         2 TEXT(0:23) char(1) caligned;
      953      611    1   dcl TCM_USING_PAD bit(1) SYMREF;
      954      612    1   dcl TCM_COMMAND   bit(1) symref;
      955      613    1   dcl TCM_EXEC      bit(1) symref;
      956      614    1   dcl TCM_INT       bit(1) symref;
      957      615    1   dcl TCM_LOCAL     bit(1) symref;
      958      616    1   dcl TCM_NEEDREAD  bit(1) symref;
      959      617    1   dcl TCM_LOCALMODE bit(1) symref;
      960      618    1   dcl TCM_CONNECTED bit(1) symref;
      961      619    1   dcl TCM_MODEMBUF  char(1280) symref;
      962      620    1   dcl TCM_MBLEN     ubin symref;
      963      621    1   dcl RETRY     ubin static;
      964      622    1   dcl TEMP      ubin static;
      965      623    1   dcl ACTUAL_PAD_SPEED ubin static init(12); /* Use 2400 baud */
      966      624    1   dcl BREAK_PAD_SPEED ubin static init(0); /* Try 50 baud   */
      967      625    1   dcl CMDI             ubin static;
      968      626    1   dcl TCM_TIMEOUT          ubin symref;
      969      627    1   dcl I                ubin static;
      970      628    1   dcl CR               char(1) static init(binasc(13));
      971      629    1   dcl LF               char(1) static init(binasc(10));
      972      630    1   dcl FLAG             ubin static;
      973      631    1   dcl TCM_EPTBLI(0:3)      bit(32) unal symref;
      974      632    1   dcl EPTBL(0:127)     redef TCM_EPTBLI bit(1) unal;
      975      633    1   dcl TCM_OPTBLI(0:3)      bit(32) unal symref;
      976      634    1   dcl OPTBL(0:127)     redef TCM_OPTBLI bit(1) unal;
      977      635    1   dcl EIGHT_VAL        ubin(9) static unal;
      978      636    1   dcl EIGHT_TBL(0:4)   ubin(9) static unal init(184,56,184,184,56);
      979      637    1   dcl PAREN_VAL        ubin(9) static unal;
      980      638    1   dcl PAREN_TBL(0:4)   ubin(9) static unal init(40,168,40,168,40);
      981      639    1   dcl TCM_STRIPPAR(0:511)  ubin(9) unal symref;
      982      640    1   dcl TCM_OUTREC           char(332) symref;
      983      641    1   dcl 1 WARNMES        static,
      984      642    1         2 *            ubin(9) unal init(13),
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:287  
      985      643    1         2 *            ubin(9) unal init(07),
      986      644    1         2 *            char(0) init('WARNING, 5 minutes without IO '),
      987      645    1         2 *            char(0) init('have passed, ALEX will LOG you'),
      988      646    1         2 *            char(0) init(' off in 1 minute.'),
      989      647    1         2 *            ubin(9) unal init(07),
      990      648    1         2 *            ubin(9) unal init(13);
      991      649    1   dcl 1 OFFMES         static,
      992      650    1         2 *            ubin(9) unal init(13),
      993      651    1         2 *            ubin(9) unal init(07),
      994      652    1         2 *            char(0) init('6 minutes without IO have pass'),
      995      653    1         2 *            char(0) init('ed, ALEX has logged you off'),
      996      654    1         2 *            ubin(9) unal init(07),
      997      655    1         2 *            ubin(9) unal init(13);
      998      656
      999      657                                                /* Fpts */
     1000      658
     1001      659        %FPT_OPEN( FPTN=OPENCG, STCLASS=CONSTANT,
     1002      660                   SCRUB=YES,
     1003      661                   DCB=F$CG,
     1004      662                   AU=YES,
     1005      663                   NAME=CG_NAME,
     1006      664                   ACCT=CG_ACCT,
     1007      665                   ACCESS=ACC,
     1008      666                   ACSVEH=ACV,
     1009      667                   ASN=COMGROUP,
     1010      668                   SETSTA=OPENSTA,
     1011      669                   FUN=CREATE,
     1012      670                   IXTNSIZE=200,
     1013      671                   SHARE=ALL,
     1014      672                   CTG=YES,
     1015      673                   EXIST=OLDFILE);
     1016      782
     1017      783        %VLP_SETSTA(  FPTN=OPENSTA,  STCLASS=CONSTANT,
     1018      784                      MYSTATION='ALEX');
     1019      812
     1020      813        %VLP_NAME(    FPTN=CG_NAME,  STCLASS=CONSTANT,
     1021      814                      NAME='PADCG');
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:288  
     1022      841
     1023      842        %VLP_ACCT(    FPTN=CG_ACCT, STCLASS=CONSTANT,
     1024      843                      ACCT=':SYS');
     1025      856
     1026      857        %VLP_ATTR(    FPTN=ACC);
     1027      871        %VLP_ACCESS(  READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
     1028      872                      REATTR=YES, AU=YES, TCTL=YES, ACCT='BJF?');
     1029      889        %VLP_ACCESS(  EXEC=YES, ACCT='?', LAST=";");
     1030      906
     1031      907        %VLP_ATTR(    FPTN=ACV);
     1032      921        %VLP_ACSVEH(  READ=YES, DELR=YES, WNEW=YES, UPD=YES, DELF=YES,
     1033      922                      REATTR=YES, AU=YES, TCTL=YES, VEHICLE='MULSEND',LAST=";");
     1034      939
     1035      940        %FPT_OPEN(    FPTN=DELCG, STCLASS=CONSTANT,
     1036      941                      SCRUB=YES,
     1037      942                      DCB=F$CG,
     1038      943                      ASN=FILE,
     1039      944                      NAME=CG_NAME,
     1040      945                      ACCT=CG_ACCT,
     1041      946                      FUN=IN,
     1042      947                      SHARE=ALL,
     1043      948                      DELETE=YES);
     1044     1057
     1045     1058        %FPT_OPEN(    FPTN=OPENUSER,
     1046     1059                      DVFC='@',
     1047     1060                      DCB=F$USER,
     1048     1061                      ORG=TERMINAL,
     1049     1062                      FUN=UPDATE,
     1050     1063                      ASN=DEVICE);
     1051     1172
     1052     1173        %FPT_FWCG(    FPTN=TCM_DELETEMES,   STCLASS="SYMREF",
     1053     1174                      DCB=F$CG,
     1054     1175                      CRITERIA=VLP_CGMA,
     1055     1176                      DELETE=YES,
     1056     1177                      SCA=VLP_SCGMA);
     1057     1196
     1058     1197        %VLP_CGMA(                      STCLASS=CONSTANT,
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:289  
     1059     1198                      ORIGIN='?',
     1060     1199                      DEST='?');
     1061     1226
     1062     1227        %VLP_SCGMA(                     STCLASS=CONSTANT,
     1063     1228                      ORIGIN=YES,
     1064     1229                      DEST=YES);
     1065     1246
     1066     1247        %FPT_WRITE(   FPTN=TCM_WRITECG,     STCLASS=SYMREF,
     1067     1248                      DCB=F$CG,
     1068     1249                      STATION=WRITE_STATION,
     1069     1250                      TRANS=YES);
     1070     1281
     1071     1282    1   dcl TCM_WRITECGBUF         char(256) symref;
     1072     1283
     1073     1284        %FPT_WRITE(   FPTN=TCM_WRITEUSER,   STCLASS="SYMREF",
     1074     1285                      DCB=F$USER,
     1075     1286                      TRANS=YES,
     1076     1287                      BUF=TCM_WRITEUSERBUF);
     1077     1318
     1078     1319    1   dcl  TCM_WRITEUSERBUF      char(256) symref;
     1079     1320    1   dcl  CMDBUF            char(256) static;
     1080     1321    1   dcl  CMDBUFLEN         ubin      static;
     1081     1322
     1082     1323        %VLP_STATION( FPTN=WRITE_STATION,  STCLASS=STATIC,
     1083     1324                      STATION='MODEM');
     1084     1351
     1085     1352        %VLP_STATION( FPTN=CMDSTATION,     STCLASS=STATIC,
     1086     1353                      STATION='MODEM',
     1087     1354                      EOFNONE=YES);
     1088     1381
     1089     1382        %FPT_TRMISC(  FPTN=INHIBIT_OPERATOR_MESSAGES,
     1090     1383                      STCLASS=CONSTANT,
     1091     1384                      DCB=F$CG,
     1092     1385                      STATION=WRITE_STATION,
     1093     1386                      ANNOUNCE=NO,
     1094     1387                      SEND=NO);
     1095     1408
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:290  
     1096     1409        %FPT_TRMATTR( FPTN=CURRENT_TRMATTR,
     1097     1410                      STCLASS=CONSTANT,
     1098     1411                      DCB=F$CG,
     1099     1412                      STATION=WRITE_STATION,
     1100     1413                      TRMATTR=SAVED_TRMATTR);
     1101     1438
     1102     1439        %VLP_TRMATTR( FPTN=SAVED_TRMATTR);
     1103     1477
     1104     1478        %FPT_TRMATTR( FPTN=SET_LOW_SPEED,
     1105     1479                      STCLASS=CONSTANT,
     1106     1480                      DCB=F$CG,
     1107     1481                      STATION=WRITE_STATION,
     1108     1482                      TRMATTR=LOW_SPEED);
     1109     1507
     1110     1508        %VLP_TRMATTR( FPTN=LOW_SPEED,         STCLASS=STATIC,
     1111     1509                      PARITY=NONE);
     1112     1547
     1113     1548        %FPT_READ(    FPTN=TCM_READCMD,           STCLASS="SYMREF",
     1114     1549                      DCB=F$CG,
     1115     1550                      STATION=CMDSTATION,
     1116     1551                      TRANS=YES,
     1117     1552                      WAIT=YES,
     1118     1553                      BUF=TCM_READCGBUF);
     1119     1592
     1120     1593        %FPT_READ(    FPTN=TCM_READCG,            STCLASS="SYMREF",
     1121     1594                      STATION=CGSTATION,
     1122     1595                      TRANS=YES,
     1123     1596                      WAIT=NO,
     1124     1597                      EVENT=1,
     1125     1598                      DCB=F$CG,
     1126     1599                      BUF=TCM_READCGBUF);
     1127     1638
     1128     1639        %FPT_READ(    FPTN=TCM_READCGNONTRANS,    STCLASS=CONSTANT,
     1129     1640                      STATION=CGSTATION,
     1130     1641                      TRANS=NO,
     1131     1642                      WAIT=NO,
     1132     1643                      EVENT=1,
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:291  
     1133     1644                      DCB=F$CG,
     1134     1645                      BUF=TCM_READCGBUF);
     1135     1684
     1136     1685        %FPT_READ(    FPTN=READAU,            STCLASS=CONSTANT,
     1137     1686                      DCB=F$CG,
     1138     1687                      WAIT=NO,
     1139     1688                      EVENT=1,
     1140     1689                      STATION=AUSTATION,
     1141     1690                      BUF=TCM_READCGBUF);
     1142     1729
     1143     1730        %VLP_STATION( FPTN=AUSTATION);  /*N* ADD MSGTYP='*?'  */
     1144     1757
     1145     1758        %VLP_STATION( FPTN=CGSTATION, STATION='MODEM');
     1146     1785    1   dcl TCM_READCGBUF                char(256) symref;
     1147     1786
     1148     1787        %FPT_READ(    FPTN=TCM_READCGBIG,         STCLASS=CONSTANT,
     1149     1788                      DCB=F$CG,
     1150     1789                      BUF=BIGTBUF);
     1151     1828    1   dcl BIGTBUF                  char(256) static;
     1152     1829    1   dcl BUFC                     char(TCM_BLEN) based;
     1153     1830    1   dcl TCM_BLEN                     ubin      symref;
     1154     1831
     1155     1832        %FPT_CLOSE(   FPTN=CLOSELO,           STCLASS=CONSTANT,
     1156     1833                      DCB=F$UO);
     1157     1875
     1158     1876        %FPT_ACTIVATE(FPTN=TCM_TURNON,            STCLASS="SYMREF",
     1159     1877                      TRANS=YES,
     1160     1878                      ABTREAD='1'B,
     1161     1879                      DCB=F$CG,
     1162     1880                      FLUSH=YES,
     1163     1881                      STATION=WRITE_STATION);
     1164     1904
     1165     1905        %FPT_ACTIVATE(FPTN=TCM_TURNOFF,           STCLASS="SYMREF",
     1166     1906                      DCB=F$CG,
     1167     1907                      DISCONNECT=NO,
     1168     1908                      STATION=WRITE_STATION,
     1169     1909                      FLUSH=YES);
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:292  
     1170     1932
     1171     1933        %FPT_CGCTL(                           STCLASS=CONSTANT,
     1172     1934                      DCB=F$CG,
     1173     1935                      CGCP=VLP_CGCP);
     1174     1958
     1175     1959        %VLP_CGCP(                            STCLASS=CONSTANT,
     1176     1960                      MAXPG=25,
     1177     1961                      CONMSG=YES,
     1178     1962                      TERMCONAU=NO,
     1179     1963                      DCBCONAU=NO,
     1180     1964                      TERMCONNAU=NO,
     1181     1965                      DCBCONNAU=NO,
     1182     1966                      AUDCONDCB=DEACTIVATE,
     1183     1967                      AUDCONTERM=DISCONNECT,
     1184     1968                      DCBCONLGL=YES,
     1185     1969                      TERMCONLGL=YES);
     1186     2012
     1187     2013        %FPT_CGINFO(  FPTN=GET_INFO,          STCLASS=CONSTANT,
     1188     2014                      DCB=F$CG,
     1189     2015                      STATS=VLR_CGSTATS);
     1190     2035
     1191     2036        %VLR_CGSTATS( STCLASS=STATIC);
     1192     2060
     1193     2061        %FPT_EVENT(   FPTN=FPT_EVENT,         STCLASS=CONSTANT,
     1194     2062                      UENTRY=TCM$ALEX_EVNT);
     1195     2076
     1196     2077        %FPT_XCON(    UENTRY=TCM$ALEX_XCON, PXCON=TCM_XCON$);
     1197     2091    1   DCL TCM_XCON$ EPTR SYMREF;
     1198     2092
     1199     2093        %FPT_WAIT(    FPTN=TCM_NORM,    UNITS=2,  STCLASS="SYMREF");
     1200     2107        %FPT_WAIT(    FPTN=TCM_WAIT1,   UNITS=1,  STCLASS="SYMREF");
     1201     2121        %FPT_WAIT(    FPTN=TCM_TAKE5,   UNITS=5,  STCLASS="SYMREF");
     1202     2135        %FPT_WAIT(    FPTN=TAKE15,  UNITS=15, STCLASS="CONSTANT");
     1203     2149
     1204     2150        %FPT_READ(    FPTN=READSI,   DCB=M$SI,   BUF=SIBUF);
     1205     2189        %FPT_WRITE(   FPTN=TCM_WRITEUO,  DCB=F$UO,   BUF=TCM_UOBUF, STCLASS=SYMREF);
     1206     2220
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:293  
     1207     2221    1   dcl  SIBUF                   char(256) static;
     1208     2222    1   dcl  TCM_UOBUF                   char(256) symref;
     1209     2223
     1210     2224        %FPT_READ(    FPTN=READUSER, DCB=F$USER, BUF=TCM_READUSERBUF, TRANS=YES);
     1211     2263
     1212     2264    1   dcl  TCM_READUSERBUF             char(256) symref;
     1213     2265
     1214     2266        %FPT_PROMPT(  FPTN=PROMPTUSER,        STCLASS=CONSTANT,
     1215     2267                      DCB=M$UC,
     1216     2268                      VFC=YES,
     1217     2269                      PROMPT=PCHAR);
     1218     2297
     1219     2298        %FPT_PROMPT(  FPTN=PROMPTCG,          STCLASS=CONSTANT,
     1220     2299                      DCB=F$CG,
     1221     2300                      VFC=YES,
     1222     2301                      PROMPT=PCHAR,
     1223     2302                      STATION=WRITE_STATION);
     1224     2330
     1225     2331    1   dcl PCHAR                    char(1) constant init('@');
     1226     2332    1   dcl LCLPROMPT                char(0) static init('Local:');
     1227     2333
     1228     2334        %FPT_EOM(     FPTN=EOMCG,             STCLASS=STATIC,
     1229     2335                      DCB=F$CG,
     1230     2336                      STATION=WRITE_STATION,
     1231     2337                      TIMEOUT=1,
     1232     2338                      UTYPE=SEC);
     1233     2368
     1234     2369        %FPT_EOM(     FPTN=EOMUSER,           STCLASS=CONSTANT,
     1235     2370                      DCB=M$UC,
     1236     2371                      TIMEOUT=50,
     1237     2372                      UTYPE=MIL10);
     1238     2402
     1239     2403        %FPT_TRMATTR( FPTN=SET_FLOW_CONTROL,  STCLASS=CONSTANT,
     1240     2404                      TRMATTR=DC1DC3,
     1241     2405                      DCB=F$CG,
     1242     2406                      STATION=WRITE_STATION);
     1243     2431
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:294  
     1244     2432        %VLP_TRMATTR( FPTN=DC1DC3,            STCLASS=CONSTANT,
     1245     2433                      DVCFLWCTRALG=DC1DC3);
     1246     2471
     1247     2472    1   dcl  REMOVE_PROGRAM          char(0) constant
     1248     2473    1        init(%CONCAT(BITASC('015'O),'REMOTE.DBKPL6',BITASC('015'O)));
     1249     2474
     1250     2475    1   dcl  PAD_PROMPT              char(2) constant
     1251     2476    1        init(%concat(binasc(10),'*'));
     1252     2477
     1253     2478    1   dcl  TCM$ALEX_EVNT              entry async;
     1254     2479    1   dcl  TCM$ALEX_DISCONNECT         entry altret;
     1255     2480    1   dcl  KOZINN                  entry(1) altret;
     1256     2481    1   dcl  TCM$ALEX_XCON               entry async;
     1257     2482    1   dcl  TCM$ALEX_OK                      entry altret;
     1258     2483    1   dcl  INTRO                   entry;
     1259     2484                                                /* Start here */
     1260     2485
     1261     2486    1        STATUS = '0'B;

   2486  7 000002   200005 470500                    LDP0    @STATUS,,AUTO
         7 000003   000000 450100                    STZ     0,,PR0

     1262     2487    1        if addr(BAILOUT) = addr(NIL)

   2487  7 000004   200006 236100                    LDQ     @BAILOUT,,AUTO
         7 000005   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000006   000013 601000 7                  TNZ     s:2489

     1263     2488    1        then TCM_ALEX_BAILOUT_ENABLED = '0'B;

   2488  7 000007   000000 235003                    LDA     0,DU
         7 000010   000000 236003                    LDQ     0,DU
         7 000011   000000 757000 xsym               STAQ    TCM_ALEX_BAILOUT
         7 000012   000016 710000 7                  TRA     s:2491

     1264     2489    1        else TCM_ALEX_BAILOUT = BAILOUT;

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:295  
   2489  7 000013   200006 471500                    LDP1    @BAILOUT,,AUTO
         7 000014   100000 237100                    LDAQ    0,,PR1
         7 000015   000000 757000 xsym               STAQ    TCM_ALEX_BAILOUT

     1265     2490
     1266     2491    1        TCM_OUTREC = ' ';

   2491  7 000016   040000 100400                    MLR     fill='040'O
         7 000017   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 000020   000000 000514 xsym               ADSC9   TCM_OUTREC               cn=0,n=332

     1267     2492    2        DO I=0 TO 3;

   2492  7 000021   000016 450000 0                  STZ     I

     1268     2493    3             DO TCM_BLEN=I*128 TO (I+1)*128;

   2493  7 000022   000016 235000 0                  LDA     I
         7 000023   000007 735000                    ALS     7
         7 000024   000000 755000 xsym               STA     TCM_BLEN
         7 000025   000037 710000 7                  TRA     s:2495+2

     1269     2494    3                  TCM_STRIPPAR(TCM_BLEN)=MOD(TCM_BLEN,128);

   2494  7 000026   000000 236000 xsym               LDQ     TCM_BLEN
         7 000027   000177 376007                    ANQ     127,DL
         7 000030   200010 756100                    STQ     @BAILOUT+2,,AUTO
         7 000031   000000 235000 xsym               LDA     TCM_BLEN
         7 000032   000005 101500                    MRL     fill='000'O
         7 000033   200010 000004                    ADSC9   @BAILOUT+2,,AUTO         cn=0,n=4
         7 000034   000000 000001 xsym               ADSC9   TCM_STRIPPAR,A           cn=0,n=1

     1270     2495    3                END;

   2495  7 000035   000001 035007                    ADLA    1,DL
         7 000036   000000 755000 xsym               STA     TCM_BLEN
         7 000037   000016 236000 0                  LDQ     I
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:296  
         7 000040   000007 736000                    QLS     7
         7 000041   000200 036007                    ADLQ    128,DL
         7 000042   000000 116000 xsym               CMPQ    TCM_BLEN
         7 000043   000026 603000 7                  TRC     s:2494

     1271     2496    2           END;

   2496  7 000044   000016 235000 0                  LDA     I
         7 000045   000001 035007                    ADLA    1,DL
         7 000046   000016 755000 0                  STA     I
         7 000047   000004 115007                    CMPA    4,DL
         7 000050   000022 602000 7                  TNC     s:2493

     1272     2497        /* Get users parity */
     1273     2498    1        EIGHT_VAL=EIGHT_TBL(PAR);

   2498  7 000051   200004 470500                    LDP0    @PAR,,AUTO
         7 000052   000000 235100                    LDA     0,,PR0
         7 000053   000000 100405                    MLR     fill='000'O
         7 000054   000023 000001 0                  ADSC9   EIGHT_TBL,A              cn=0,n=1
         7 000055   000022 000001 0                  ADSC9   EIGHT_VAL                cn=0,n=1

     1274     2499    1        TCM_G_PARITY = PAR;

   2499  7 000056   000000 755000 xsym               STA     TCM_G_PARITY

     1275     2500    1        PAREN_VAL=PAREN_TBL(PAR);

   2500  7 000057   000000 235100                    LDA     0,,PR0
         7 000060   000000 100405                    MLR     fill='000'O
         7 000061   000026 000001 0                  ADSC9   PAREN_TBL,A              cn=0,n=1
         7 000062   000025 000001 0                  ADSC9   PAREN_VAL                cn=0,n=1

     1276     2501    1        TCM_USING_PAD = '1'B;

   2501  7 000063   400000 236003                    LDQ     -131072,DU
         7 000064   000000 756000 xsym               STQ     TCM_USING_PAD
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:297  

     1277     2502    1        TCM_CONNECTED = '0'B;

   2502  7 000065   000000 450000 xsym               STZ     TCM_CONNECTED

     1278     2503    1        CALL M$EVENT(FPT_EVENT);

   2503  7 000066   000556 630400 6                  EPPR0   FPT_EVENT
         7 000067   010001 713400                    CLIMB   4097
         7 000070   400000 401760                    pmme    nvectors=1

     1279     2504    1        call M$OPEN(OPENUSER);

   2504  7 000071   000110 630400 0                  EPPR0   OPENUSER
         7 000072   050000 713400                    CLIMB   open
         7 000073   410400 401760                    pmme    nvectors=18

     1280     2505                                                /* Delete current comgroup  */
     1281     2506        /*   Call M$OPEN(DELCG) whenaltreturn do; end; */
     1282     2507    1        CALL M$OPEN (OPENCG) ALTRET(BADOPEN);

   2507  7 000074   000000 630400 6                  EPPR0   OPENCG
         7 000075   450000 713400                    CLIMB   alt,open
         7 000076   410400 401760                    pmme    nvectors=18
         7 000077   000101 702000 7                  TSX2    BADOPEN

     1283     2508    2        DO WHILE ('0'B);

   2508  7 000100   000116 710000 7                  TRA     s:2518

     1284     2509    2   BADOPEN:
     1285     2510    2             CALL M$OPEN (DELCG) ALTRET(CANT_CONTINUE); /* Delete bad comgroup */

   2510  7 000101   000112 630400 6     BADOPEN      EPPR0   DELCG
         7 000102   450000 713400                    CLIMB   alt,open
         7 000103   410400 401760                    pmme    nvectors=18
         7 000104   000112 702000 7                  TSX2    CANT_CONTINUE
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:298  

     1286     2511    2             CALL M$OPEN (OPENCG) ALTRET(CANT_CONTINUE); /* Try again */

   2511  7 000105   000000 630400 6                  EPPR0   OPENCG
         7 000106   450000 713400                    CLIMB   alt,open
         7 000107   410400 401760                    pmme    nvectors=18
         7 000110   000112 702000 7                  TSX2    CANT_CONTINUE

     1287     2512    3             DO WHILE ('0'B);

   2512  7 000111   000116 710000 7                  TRA     s:2518

     1288     2513    3   CANT_CONTINUE:
     1289     2514    3                  call TCM$ALEX_DISCONNECT;

   2514  7 000112   000002 631400 xsym  CANT_CONTIN* EPPR1   B_VECTNIL+2
         7 000113   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         7 000114   000000 011000                    NOP     0

     1290     2515    3                  altreturn;

   2515  7 000115   000000 702200 xent               TSX2  ! X66_AALT

     1291     2516    3                END;

     1292     2517    2           END;

     1293     2518    1        TCM_INT = '0'B;

   2518  7 000116   000000 450000 xsym               STZ     TCM_INT

     1294     2519    1        F$CG$ = dcbaddr(dcbnum(F$CG));

   2519  7 000117   000000 236007 xsym               LDQ     F$CG,DL
         7 000120   000000 470400 8                  LDP0    0
         7 000121   000000 471500                    LDP1    0,,PR0
         7 000122   100000 236106                    LDQ     0,QL,PR1
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:299  
         7 000123   000000 756000 xsym               STQ     F$CG$

     1295     2520    1        F$USER$ = dcbaddr(dcbnum(F$USER));

   2520  7 000124   000000 236007 xsym               LDQ     F$USER,DL
         7 000125   100000 236106                    LDQ     0,QL,PR1
         7 000126   000001 756000 0                  STQ     F$USER$

     1296     2521    2        call M$FWCG(TCM_DELETEMES) whenaltreturn do; end;

   2521  7 000127   000000 630400 xsym               EPPR0   TCM_DELETEMES
         7 000130   500005 713400                    CLIMB   alt,+32773
         7 000131   406400 401760                    pmme    nvectors=14
         7 000132   000134 702000 7                  TSX2    s:2522
         7 000133   000134 710000 7                  TRA     s:2522

     1297     2522    1        CALL M$CGCTL (FPT_CGCTL);

   2522  7 000134   000364 630400 6                  EPPR0   FPT_CGCTL
         7 000135   100003 713400                    CLIMB   32771
         7 000136   411400 401760                    pmme    nvectors=20

     1298     2523        /* Wait for logon message from device */
     1299     2524    1        CALL M$DEACTIVATE(TCM_TURNOFF);    /* Flush anything pending */

   2524  7 000137   000000 630400 xsym               EPPR0   TCM_TURNOFF
         7 000140   100001 713400                    CLIMB   32769
         7 000141   401400 401760                    pmme    nvectors=4

     1300     2525    1        TCM_MBLEN=0;

   2525  7 000142   000000 450000 xsym               STZ     TCM_MBLEN

     1301     2526    1        TCM_COMMAND='1'B;

   2526  7 000143   400000 236003                    LDQ     -131072,DU
         7 000144   000000 756000 xsym               STQ     TCM_COMMAND
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:300  

     1302     2527    1        CALL M$READ (READAU);

   2527  7 000145   000272 630400 6                  EPPR0   READAU
         7 000146   040000 713400                    CLIMB   read
         7 000147   401400 401760                    pmme    nvectors=4

     1303     2528    1        I = 0;

   2528  7 000150   000016 450000 0                  STZ     I

     1304     2529    2        do until VLR_CGSTATS.NUMTERMS > 0  or  I = 15;

     1305     2530    2             I = I + 1;

   2530  7 000151   000016 235000 0                  LDA     I
         7 000152   000001 035007                    ADLA    1,DL
         7 000153   000016 755000 0                  STA     I

     1306     2531    2             call M$WAIT(TCM_WAIT1);

   2531  7 000154   000000 630400 xsym               EPPR0   TCM_WAIT1
         7 000155   020006 713400                    CLIMB   8198
         7 000156   400400 401760                    pmme    nvectors=2

     1307     2532    2             call M$CGINFO(GET_INFO);

   2532  7 000157   000474 630400 6                  EPPR0   GET_INFO
         7 000160   100004 713400                    CLIMB   32772
         7 000161   411400 401760                    pmme    nvectors=20

     1308     2533    2           end;

   2533  7 000162   000477 235000 0                  LDA     VLR_CGSTATS+7
         7 000163   000167 605400 7                  TPNZ    s:2534
         7 000164   000016 236000 0                  LDQ     I
         7 000165   000017 116007                    CMPQ    15,DL
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:301  
         7 000166   000151 601000 7                  TNZ     s:2530

     1309     2534    2        if VLR_CGSTATS.NUMTERMS > 0 then do;

   2534  7 000167   000000 115003                    CMPA    0,DU
         7 000170   000213 604400 7                  TMOZ    s:2544

     1310     2535                                                /* For now, assume logon */
     1311     2536    2             TCM_CONNECTED = '1'B;

   2536  7 000171   400000 236003                    LDQ     -131072,DU
         7 000172   000000 756000 xsym               STQ     TCM_CONNECTED

     1312     2537    2             CALL M$ACTIVATE(TCM_TURNON);

   2537  7 000173   000000 630400 xsym               EPPR0   TCM_TURNON
         7 000174   100000 713400                    CLIMB   32768
         7 000175   401400 401760                    pmme    nvectors=4

     1313     2538    2             CALL M$WAIT(TCM_WAIT1);

   2538  7 000176   000000 630400 xsym               EPPR0   TCM_WAIT1
         7 000177   020006 713400                    CLIMB   8198
         7 000200   400400 401760                    pmme    nvectors=2

     1314     2539    2             CALL M$DEACTIVATE(TCM_TURNOFF); /* Abrt pending read */

   2539  7 000201   000000 630400 xsym               EPPR0   TCM_TURNOFF
         7 000202   100001 713400                    CLIMB   32769
         7 000203   401400 401760                    pmme    nvectors=4

     1315     2540    2             CALL M$WAIT(TCM_WAIT1);

   2540  7 000204   000000 630400 xsym               EPPR0   TCM_WAIT1
         7 000205   020006 713400                    CLIMB   8198
         7 000206   400400 401760                    pmme    nvectors=2

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:302  
     1316     2541    2             CALL M$ACTIVATE(TCM_TURNON);  /* Now its ready */

   2541  7 000207   000000 630400 xsym               EPPR0   TCM_TURNON
         7 000210   100000 713400                    CLIMB   32768
         7 000211   401400 401760                    pmme    nvectors=4

     1317     2542    2           END;

   2542  7 000212   000227 710000 7                  TRA     s:2552

     1318     2543    2        ELSE DO;

     1319     2544    2             TCM_UOBUF='PAD did not connect';

   2544  7 000213   040000 100400                    MLR     fill='040'O
         7 000214   000657 000023 6                  ADSC9   PAD_PROMPT+1             cn=0,n=19
         7 000215   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

     1320     2545                  %WRITEUO;

   2546  7 000216   000000 630400 xsym               EPPR0   TCM_WRITEUO
         7 000217   440001 713400                    CLIMB   alt,write
         7 000220   401400 401760                    pmme    nvectors=4
         7 000221   000223 702000 7                  TSX2    s:2548
         7 000222   000223 710000 7                  TRA     s:2548

     1321     2548    2             call TCM$ALEX_DISCONNECT;

   2548  7 000223   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000224   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         7 000225   000000 011000                    NOP     0

     1322     2549    2             altreturn;

   2549  7 000226   000000 702200 xent               TSX2  ! X66_AALT

     1323     2550    2           END;
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:303  
     1324     2551        /*   Call intro; */
     1325     2552    1        CALL M$PROMPT(PROMPTCG);

   2552  7 000227   000602 630400 6                  EPPR0   PROMPTCG
         7 000230   160002 713400                    CLIMB   57346
         7 000231   401000 401760                    pmme    nvectors=3

     1326     2553    1        CALL M$EOM(EOMCG);

   2553  7 000232   000656 630400 0                  EPPR0   EOMCG
         7 000233   160003 713400                    CLIMB   57347
         7 000234   401000 401760                    pmme    nvectors=3

     1327     2554    1        call M$STRMATTR(SET_FLOW_CONTROL);

   2554  7 000235   000630 630400 6                  EPPR0   SET_FLOW_CONTROL
         7 000236   160006 713400                    CLIMB   57350
         7 000237   401000 401760                    pmme    nvectors=3

     1328     2555    1        call M$TRMISC(INHIBIT_OPERATOR_MESSAGES);

   2555  7 000240   000226 630400 6                  EPPR0   INHIBIT_OPERATOR_MESSAGES
         7 000241   160020 713400                    CLIMB   57360
         7 000242   400400 401760                    pmme    nvectors=2

     1329     2556                                                /* Reset modem */
     1330     2557    1        CALL M$XCON(FPT_XCON);

   2557  7 000243   000512 630400 0                  EPPR0   FPT_XCON
         7 000244   010003 713400                    CLIMB   4099
         7 000245   400400 401760                    pmme    nvectors=2

     1331     2558        /*  Perform modem autobaud/autoparity; wait for a prompt */
     1332     2559    1        TCM_WRITECG.BUF_ = vector(substr(TCM_WRITECGBUF,,1));

   2559  7 000246   000002 237000 8                  LDAQ    2
         7 000247   000004 757000 xsym               STAQ    TCM_WRITECG+4
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:304  

     1333     2560    1        I = 3;

   2560  7 000250   000003 235007                    LDA     3,DL
         7 000251   000016 755000 0                  STA     I

     1334     2561    1        call M$GTRMATTR( CURRENT_TRMATTR );

   2561  7 000252   000234 630400 6                  EPPR0   CURRENT_TRMATTR
         7 000253   160007 713400                    CLIMB   57351
         7 000254   401000 401760                    pmme    nvectors=3

     1335     2562    1        SAVED_TRMATTR.SPEED# = ACTUAL_PAD_SPEED;

   2562  7 000255   000013 236000 0                  LDQ     ACTUAL_PAD_SPEED
         7 000256   000011 736000                    QLS     9
         7 000257   000326 676000 0                  ERQ     SAVED_TRMATTR+2
         7 000260   377000 376007                    ANQ     130560,DL
         7 000261   000326 656000 0                  ERSQ    SAVED_TRMATTR+2

     1336     2563    1        LOW_SPEED.SPEED#     = BREAK_PAD_SPEED;

   2563  7 000262   000014 236000 0                  LDQ     BREAK_PAD_SPEED
         7 000263   000011 736000                    QLS     9
         7 000264   000340 676000 0                  ERQ     LOW_SPEED+2
         7 000265   377000 376007                    ANQ     130560,DL
         7 000266   000340 656000 0                  ERSQ    LOW_SPEED+2

     1337     2564    1   AUTOBAUD:
     1338     2565    2        do until I = 0;

   2565  7 000267                       AUTOBAUD     null
     1339     2566    2             call M$STRMATTR( SET_LOW_SPEED );

   2566  7 000267   000244 630400 6                  EPPR0   SET_LOW_SPEED
         7 000270   160006 713400                    CLIMB   57350
         7 000271   401000 401760                    pmme    nvectors=3
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:305  

     1340     2567    2             TCM_WRITECGBUF = binasc(0);   /* Send a slow null; looks like a  */

   2567  7 000272   040000 100400                    MLR     fill='040'O
         7 000273   000004 000001 8                  ADSC9   4                        cn=0,n=1
         7 000274   000000 000400 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=256

     1341     2568    2             call M$WRITE (TCM_WRITECG);   /* break to a high speed device    */

   2568  7 000275   000000 630400 xsym               EPPR0   TCM_WRITECG
         7 000276   040001 713400                    CLIMB   write
         7 000277   401400 401760                    pmme    nvectors=4

     1342     2569    2             call M$WAIT(TCM_WAIT1);

   2569  7 000300   000000 630400 xsym               EPPR0   TCM_WAIT1
         7 000301   020006 713400                    CLIMB   8198
         7 000302   400400 401760                    pmme    nvectors=2

     1343     2570    2             call M$STRMATTR( CURRENT_TRMATTR );

   2570  7 000303   000234 630400 6                  EPPR0   CURRENT_TRMATTR
         7 000304   160006 713400                    CLIMB   57350
         7 000305   401000 401760                    pmme    nvectors=3

     1344     2571    2             call M$WAIT(TCM_WAIT1);

   2571  7 000306   000000 630400 xsym               EPPR0   TCM_WAIT1
         7 000307   020006 713400                    CLIMB   8198
         7 000310   400400 401760                    pmme    nvectors=2

     1345     2572    2             TCM_WRITECGBUF = CR;

   2572  7 000311   040000 100400                    MLR     fill='040'O
         7 000312   000017 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000313   000000 000400 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=256

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:306  
     1346     2573    2             call M$WRITE(TCM_WRITECG);

   2573  7 000314   000000 630400 xsym               EPPR0   TCM_WRITECG
         7 000315   040001 713400                    CLIMB   write
         7 000316   401400 401760                    pmme    nvectors=4

     1347     2574    2             call M$WAIT(TCM_WAIT1);

   2574  7 000317   000000 630400 xsym               EPPR0   TCM_WAIT1
         7 000320   020006 713400                    CLIMB   8198
         7 000321   400400 401760                    pmme    nvectors=2

     1348     2575    2             TCM_WRITECGBUF = '.';

   2575  7 000322   040000 100400                    MLR     fill='040'O
         7 000323   000005 000001 8                  ADSC9   5                        cn=0,n=1
         7 000324   000000 000400 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=256

     1349     2576    2             call M$WRITE( TCM_WRITECG );

   2576  7 000325   000000 630400 xsym               EPPR0   TCM_WRITECG
         7 000326   040001 713400                    CLIMB   write
         7 000327   401400 401760                    pmme    nvectors=4

     1350     2577    2             call M$WAIT(TCM_WAIT1);

   2577  7 000330   000000 630400 xsym               EPPR0   TCM_WAIT1
         7 000331   020006 713400                    CLIMB   8198
         7 000332   400400 401760                    pmme    nvectors=2

     1351     2578    2             TCM_WRITECGBUF = CR;

   2578  7 000333   040000 100400                    MLR     fill='040'O
         7 000334   000017 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000335   000000 000400 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=256

     1352     2579    2             call M$WRITE( TCM_WRITECG );
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:307  

   2579  7 000336   000000 630400 xsym               EPPR0   TCM_WRITECG
         7 000337   040001 713400                    CLIMB   write
         7 000340   401400 401760                    pmme    nvectors=4

     1353     2580        /*  Wait for pad prompt      */
     1354     2581    2             RETRY = 0;

   2581  7 000341   000011 450000 0                  STZ     RETRY

     1355     2582    2             TCM_INT = '0'B;

   2582  7 000342   000000 450000 xsym               STZ     TCM_INT

     1356     2583    2             TCM_MBLEN = 0;

   2583  7 000343   000000 450000 xsym               STZ     TCM_MBLEN

     1357     2584    3             do while( RETRY<5 );

   2584  7 000344   000011 235000 0                  LDA     RETRY
         7 000345   000005 115007                    CMPA    5,DL
         7 000346   000410 603000 7                  TRC     s:2600

     1358     2585    4                  do inhibit;

     1359     2586    5                       call M$READ(TCM_READCG) whenaltreturn do; end;

   2586  7 000347   000000 630600 xsym               EPPR0 ! TCM_READCG
         7 000350   440000 713600                    CLIMB ! alt,read
         7 000351   401400 401760                    pmme    nvectors=4
         7 000352   000354 702200 7                  TSX2  ! s:2587
         7 000353   000354 710200 7                  TRA   ! s:2587

     1360     2587    4                       if not TCM_INT

   2587  7 000354   000000 234200 xsym               SZN   ! TCM_INT
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:308  
         7 000355   000361 604200 7                  TMI   ! s:2590

     1361     2588    4                       then call M$WAIT(TCM_WAIT1);

   2588  7 000356   000000 630600 xsym               EPPR0 ! TCM_WAIT1
         7 000357   020006 713600                    CLIMB ! 8198
         7 000360   400400 401760                    pmme    nvectors=2

     1362     2589    4                     end;

     1363     2590    4                  if TCM_INT then do;

   2590  7 000361   000000 234000 xsym               SZN     TCM_INT
         7 000362   000403 605000 7                  TPL     s:2598

     1364     2591    4                       call index(TEMP, PAD_PROMPT, substr(TCM_MODEMBUF,,TCM_MBLEN))

   2591  7 000363   000000 720000 xsym               LXL0    TCM_MBLEN
         7 000364   000000 120440                    SCD
         7 000365   000000 000010 xsym               ADSC9   TCM_MODEMBUF             cn=0,n=*X0
         7 000366   000656 000002 6                  ADSC9   PAD_PROMPT               cn=0,n=2
         7 000367   000012 000000 0                  ARG     TEMP
         7 000370   000373 607000 7                  TTF     s:2593
         7 000371   000012 054000 0                  AOS     TEMP
         7 000372   000374 710000 7                  TRA     s:2595

     1365     2592    5                       whenreturn do;

     1366     2593    5                            exit AUTOBAUD;

   2593  7 000373   000414 710000 7                  TRA     s:2602

     1367     2594    5                          end;
     1368     2595    4                       if TCM_MBLEN = 1 and substr(TCM_MODEMBUF,,1) = '*'

   2595  7 000374   000000 235000 xsym               LDA     TCM_MBLEN
         7 000375   000001 115007                    CMPA    1,DL
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:309  
         7 000376   000403 601000 7                  TNZ     s:2598
         7 000377   000000 236000 xsym               LDQ     TCM_MODEMBUF
         7 000400   777000 376003                    ANQ     -512,DU
         7 000401   052000 116003                    CMPQ    21504,DU
         7 000402   000414 600000 7                  TZE     s:2602

     1369     2596    4                       then exit AUTOBAUD;
     1370     2597    4                     end;

     1371     2598    3                  RETRY = RETRY + 1;

   2598  7 000403   000011 235000 0                  LDA     RETRY
         7 000404   000001 035007                    ADLA    1,DL
         7 000405   000011 755000 0                  STA     RETRY

     1372     2599    3                end;

   2599  7 000406   000005 115007                    CMPA    5,DL
         7 000407   000347 602000 7                  TNC     s:2586

     1373     2600    2             I = I - 1;

   2600  7 000410   000016 236000 0                  LDQ     I
         7 000411   000001 136007                    SBLQ    1,DL
         7 000412   000016 756000 0                  STQ     I

     1374     2601    2           end;

   2601  7 000413   000267 601000 7                  TNZ     AUTOBAUD

     1375     2602    2        if I = 0 then do;

   2602  7 000414   000016 235000 0                  LDA     I
         7 000415   000432 601000 7                  TNZ     s:2610

     1376     2603    2             TCM_UOBUF = 'PAD dis not respond to autobaud sequence';

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:310  
   2603  7 000416   040000 100400                    MLR     fill='040'O
         7 000417   000664 000050 6                  ADSC9   PAD_PROMPT+6             cn=0,n=40
         7 000420   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

     1377     2604                  %WRITEUO;

   2605  7 000421   000000 630400 xsym               EPPR0   TCM_WRITEUO
         7 000422   440001 713400                    CLIMB   alt,write
         7 000423   401400 401760                    pmme    nvectors=4
         7 000424   000426 702000 7                  TSX2    s:2607
         7 000425   000426 710000 7                  TRA     s:2607

     1378     2607    2             call TCM$ALEX_DISCONNECT;

   2607  7 000426   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000427   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         7 000430   000000 011000                    NOP     0

     1379     2608    2             altreturn;

   2608  7 000431   000000 702200 xent               TSX2  ! X66_AALT

     1380     2609    2           end;
     1381     2610    1        call concat(TCM_WRITECGBUF,'SET5:1,6:5,12:1,20:0,105:2',CR);

   2610  7 000432   040000 100400                    MLR     fill='040'O
         7 000433   000676 000032 6                  ADSC9   PAD_PROMPT+16            cn=0,n=26
         7 000434   000000 000032 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=26
         7 000435   040000 100400                    MLR     fill='040'O
         7 000436   000017 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000437   000006 400346 xsym               ADSC9   TCM_WRITECGBUF+6         cn=2,n=230

     1382     2611    1        call index(TCM_BLEN,' ',TCM_WRITECGBUF);

   2611  7 000440   000000 124400                    SCM     mask='000'O
         7 000441   000000 000400 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=256
         7 000442   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:311  
         7 000443   000000 000000 xsym               ARG     TCM_BLEN

     1383     2612    1        TCM_WRITECG.BUF_  = vector(substr(TCM_WRITECGBUF,,TCM_BLEN));

   2612  7 000444   000000 235000 xsym               LDA     TCM_BLEN
         7 000445   000020 735000                    ALS     16
         7 000446   000140 135007                    SBLA    96,DL
         7 000447   000003 236000 8                  LDQ     3
         7 000450   000004 757000 xsym               STAQ    TCM_WRITECG+4

     1384     2613    1        call M$WRITE(TCM_WRITECG);

   2613  7 000451   000000 630400 xsym               EPPR0   TCM_WRITECG
         7 000452   040001 713400                    CLIMB   write
         7 000453   401400 401760                    pmme    nvectors=4

     1385     2614    1        call concat(TCM_UOBUF,'Calling ',ADDRESS);

   2614  7 000454   040000 100400                    MLR     fill='040'O
         7 000455   000705 000010 6                  ADSC9   PAD_PROMPT+23            cn=0,n=8
         7 000456   000000 000010 xsym               ADSC9   TCM_UOBUF                cn=0,n=8
         7 000457   200003 470500                    LDP0    @ADDRESS,,AUTO
         7 000460   040000 100500                    MLR     fill='040'O
         7 000461   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
         7 000462   000002 000370 xsym               ADSC9   TCM_UOBUF+2              cn=0,n=248

     1386     2615             %WRITEUO;

   2616  7 000463   000000 630400 xsym               EPPR0   TCM_WRITEUO
         7 000464   440001 713400                    CLIMB   alt,write
         7 000465   401400 401760                    pmme    nvectors=4
         7 000466   000470 702000 7                  TSX2    s:2618
         7 000467   000470 710000 7                  TRA     s:2618

     1387     2618    1        call concat(TCM_WRITECGBUF,'C R-',ADDRESS);

   2618  7 000470   000707 236000 6                  LDQ     PAD_PROMPT+25
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:312  
         7 000471   000000 756000 xsym               STQ     TCM_WRITECGBUF
         7 000472   200003 470500                    LDP0    @ADDRESS,,AUTO
         7 000473   040000 100500                    MLR     fill='040'O
         7 000474   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
         7 000475   000001 000374 xsym               ADSC9   TCM_WRITECGBUF+1         cn=0,n=252

     1388     2619    1        call index(TCM_BLEN,'  ',TCM_WRITECGBUF);

   2619  7 000476   000000 120400                    SCD
         7 000477   000000 000400 xsym               ADSC9   TCM_WRITECGBUF           cn=0,n=256
         7 000500   000710 000002 6                  ADSC9   PAD_PROMPT+26            cn=0,n=2
         7 000501   000000 000000 xsym               ARG     TCM_BLEN
         7 000502   000504 607000 7                  TTF     s:2620
         7 000503   000000 054000 xsym               AOS     TCM_BLEN

     1389     2620    1        substr(TCM_WRITECGBUF,TCM_BLEN,1) = CR;

   2620  7 000504   000000 235000 xsym               LDA     TCM_BLEN
         7 000505   040005 100400                    MLR     fill='040'O
         7 000506   000017 000001 0                  ADSC9   CR                       cn=0,n=1
         7 000507   000000 000001 xsym               ADSC9   TCM_WRITECGBUF,A         cn=0,n=1

     1390     2621    1        TCM_BLEN = TCM_BLEN + 1;

   2621  7 000510   000001 035007                    ADLA    1,DL
         7 000511   000000 755000 xsym               STA     TCM_BLEN

     1391     2622    1        TCM_WRITECG.BUF_ = vector(substr(TCM_WRITECGBUF,,TCM_BLEN));

   2622  7 000512   000020 735000                    ALS     16
         7 000513   000140 135007                    SBLA    96,DL
         7 000514   000003 236000 8                  LDQ     3
         7 000515   000004 757000 xsym               STAQ    TCM_WRITECG+4

     1392     2623    1        call M$WRITE(TCM_WRITECG);

   2623  7 000516   000000 630400 xsym               EPPR0   TCM_WRITECG
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:313  
         7 000517   040001 713400                    CLIMB   write
         7 000520   401400 401760                    pmme    nvectors=4

     1393     2624        /* Wait for connect message */
     1394     2625    1        RETRY = 0;

   2625  7 000521   000011 450000 0                  STZ     RETRY

     1395     2626    1        TCM_MBLEN = 0;

   2626  7 000522   000000 450000 xsym               STZ     TCM_MBLEN

     1396     2627    2   RED: do while(RETRY<60);

   2627  7 000523   000011 235000 0     RED          LDA     RETRY
         7 000524   000074 115007                    CMPA    60,DL
         7 000525   000701 603000 7                  TRC     s:2668

     1397     2628    2             TCM_INT = '0'B;

   2628  7 000526   000000 450000 xsym               STZ     TCM_INT

     1398     2629    2             call M$READ(TCM_READCGNONTRANS); /*  Look for response  */

   2629  7 000527   000254 630400 6                  EPPR0   TCM_READCGNONTRANS
         7 000530   040000 713400                    CLIMB   read
         7 000531   401400 401760                    pmme    nvectors=4

     1399     2630    3             do inhibit;

     1400     2631    3                  if not TCM_INT

   2631  7 000532   000000 234200 xsym               SZN   ! TCM_INT
         7 000533   000537 604200 7                  TMI   ! s:2634

     1401     2632    3                  then call M$WAIT(TCM_WAIT1);

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:314  
   2632  7 000534   000000 630600 xsym               EPPR0 ! TCM_WAIT1
         7 000535   020006 713600                    CLIMB ! 8198
         7 000536   400400 401760                    pmme    nvectors=2

     1402     2633    3                end;

     1403     2634    3             if TCM_INT then do;

   2634  7 000537   000000 234000 xsym               SZN     TCM_INT
         7 000540   000674 605000 7                  TPL     s:2665

     1404     2635    3                  call index(I,'clr',substr(TCM_MODEMBUF,,TCM_MBLEN));

   2635  7 000541   000016 631400 0                  EPPR1   I
         7 000542   000711 633400 6                  EPPR3   PAD_PROMPT+27
         7 000543   000003 223003                    LDX3    3,DU
         7 000544   000000 630400 xsym               EPPR0   TCM_MODEMBUF
         7 000545   000000 720000 xsym               LXL0    TCM_MBLEN
         7 000546   000000 236003                    LDQ     0,DU
         7 000547   000000 701000 xent               TSX1    X66_INDEX
         7 000550   000000 011000                    NOP     0

     1405     2636    3                  if I >= TCM_MBLEN

   2636  7 000551   000016 236000 0                  LDQ     I
         7 000552   000000 116000 xsym               CMPQ    TCM_MBLEN
         7 000553   000563 602000 7                  TNC     s:2638

     1406     2637    3                  then call index(I,'reset',substr(TCM_MODEMBUF,,TCM_MBLEN));

   2637  7 000554   000016 631400 0                  EPPR1   I
         7 000555   000712 633400 6                  EPPR3   PAD_PROMPT+28
         7 000556   000005 223003                    LDX3    5,DU
         7 000557   000000 630400 xsym               EPPR0   TCM_MODEMBUF
         7 000560   000000 236003                    LDQ     0,DU
         7 000561   000000 701000 xent               TSX1    X66_INDEX
         7 000562   000000 011000                    NOP     0
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:315  

     1407     2638    3                  if I >= TCM_MBLEN

   2638  7 000563   000016 236000 0                  LDQ     I
         7 000564   000000 116000 xsym               CMPQ    TCM_MBLEN
         7 000565   000575 602000 7                  TNC     s:2640

     1408     2639    3                  then call index(I,'engaged',substr(TCM_MODEMBUF,,TCM_MBLEN));

   2639  7 000566   000016 631400 0                  EPPR1   I
         7 000567   000714 633400 6                  EPPR3   PAD_PROMPT+30
         7 000570   000007 223003                    LDX3    7,DU
         7 000571   000000 630400 xsym               EPPR0   TCM_MODEMBUF
         7 000572   000000 236003                    LDQ     0,DU
         7 000573   000000 701000 xent               TSX1    X66_INDEX
         7 000574   000000 011000                    NOP     0

     1409     2640    3                  if I >= TCM_MBLEN

   2640  7 000575   000016 236000 0                  LDQ     I
         7 000576   000000 116000 xsym               CMPQ    TCM_MBLEN
         7 000577   000607 602000 7                  TNC     s:2642

     1410     2641    3                  then call index(I,'err',substr(TCM_MODEMBUF,,TCM_MBLEN));

   2641  7 000600   000016 631400 0                  EPPR1   I
         7 000601   000716 633400 6                  EPPR3   PAD_PROMPT+32
         7 000602   000003 223003                    LDX3    3,DU
         7 000603   000000 630400 xsym               EPPR0   TCM_MODEMBUF
         7 000604   000000 236003                    LDQ     0,DU
         7 000605   000000 701000 xent               TSX1    X66_INDEX
         7 000606   000000 011000                    NOP     0

     1411     2642    4                  if I < TCM_MBLEN then do;

   2642  7 000607   000016 236000 0                  LDQ     I
         7 000610   000000 116000 xsym               CMPQ    TCM_MBLEN
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:316  
         7 000611   000661 603000 7                  TRC     s:2658

     1412     2643    4                       call concat(TCM_UOBUF, 'Circuit connection failed: ',

   2643  7 000612   040000 100400                    MLR     fill='040'O
         7 000613   000717 000033 6                  ADSC9   PAD_PROMPT+33            cn=0,n=27
         7 000614   000000 000033 xsym               ADSC9   TCM_UOBUF                cn=0,n=27
         7 000615   040000 100440                    MLR     fill='040'O
         7 000616   000000 000010 xsym               ADSC9   TCM_MODEMBUF             cn=0,n=*X0
         7 000617   000006 600345 xsym               ADSC9   TCM_UOBUF+6              cn=3,n=229

     1413     2644    4                         substr(TCM_MODEMBUF,,TCM_MBLEN));
     1414     2645                            %WRITEUO;

   2646  7 000620   000000 630400 xsym               EPPR0   TCM_WRITEUO
         7 000621   440001 713400                    CLIMB   alt,write
         7 000622   401400 401760                    pmme    nvectors=4
         7 000623   000625 702000 7                  TSX2    s:2648
         7 000624   000625 710000 7                  TRA     s:2648

     1415     2648    4                       if substr(TCM_MODEMBUF,I,7) = 'clr occ' or

   2648  7 000625   000016 235000 0                  LDA     I
         7 000626   040000 106405                    CMPC    fill='040'O
         7 000627   000000 000007 xsym               ADSC9   TCM_MODEMBUF,A           cn=0,n=7
         7 000630   000726 000007 6                  ADSC9   PAD_PROMPT+40            cn=0,n=7
         7 000631   000652 600000 7                  TZE     s:2653
         7 000632   040000 106405                    CMPC    fill='040'O
         7 000633   000000 000007 xsym               ADSC9   TCM_MODEMBUF,A           cn=0,n=7
         7 000634   000730 000007 6                  ADSC9   PAD_PROMPT+42            cn=0,n=7
         7 000635   000652 600000 7                  TZE     s:2653
         7 000636   040000 106405                    CMPC    fill='040'O
         7 000637   000000 000007 xsym               ADSC9   TCM_MODEMBUF,A           cn=0,n=7
         7 000640   000732 000007 6                  ADSC9   PAD_PROMPT+44            cn=0,n=7
         7 000641   000652 600000 7                  TZE     s:2653
         7 000642   040000 106405                    CMPC    fill='040'O
         7 000643   000000 000007 xsym               ADSC9   TCM_MODEMBUF,A           cn=0,n=7
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:317  
         7 000644   000734 000007 6                  ADSC9   PAD_PROMPT+46            cn=0,n=7
         7 000645   000652 600000 7                  TZE     s:2653
         7 000646   040000 106405                    CMPC    fill='040'O
         7 000647   000000 000007 xsym               ADSC9   TCM_MODEMBUF,A           cn=0,n=7
         7 000650   000736 000007 6                  ADSC9   PAD_PROMPT+48            cn=0,n=7
         7 000651   000655 601000 7                  TNZ     s:2654

     1416     2649    4                         substr(TCM_MODEMBUF,I,7) = 'clr nc ' or
     1417     2650    4                         substr(TCM_MODEMBUF,I,7) = 'clr der' or
     1418     2651    4                         substr(TCM_MODEMBUF,I,7) = 'clr na ' or
     1419     2652    4                         substr(TCM_MODEMBUF,I,7) = 'clr np '
     1420     2653    4                       then STATUS.HOST_SHUT = '1'B;

   2653  7 000652   400000 236003                    LDQ     -131072,DU
         7 000653   200005 470500                    LDP0    @STATUS,,AUTO
         7 000654   000000 756100                    STQ     0,,PR0

     1421     2654    4                       call TCM$ALEX_DISCONNECT;

   2654  7 000655   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000656   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         7 000657   000000 011000                    NOP     0

     1422     2655    4                       altreturn;

   2655  7 000660   000000 702200 xent               TSX2  ! X66_AALT

     1423     2656    4                     end;
     1424     2657    4                  else do;

     1425     2658    4                       call index(I,'com',substr(TCM_MODEMBUF,,TCM_MBLEN));

   2658  7 000661   000016 631400 0                  EPPR1   I
         7 000662   000740 633400 6                  EPPR3   PAD_PROMPT+50
         7 000663   000003 223003                    LDX3    3,DU
         7 000664   000000 630400 xsym               EPPR0   TCM_MODEMBUF
         7 000665   000000 236003                    LDQ     0,DU
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:318  
         7 000666   000000 701000 xent               TSX1    X66_INDEX
         7 000667   000000 011000                    NOP     0

     1426     2659    5                       do inhibit;

     1427     2660    5                            if I<TCM_MBLEN then exit RED;

   2660  7 000670   000016 236200 0                  LDQ   ! I
         7 000671   000000 116200 xsym               CMPQ  ! TCM_MBLEN
         7 000672   000701 602200 7                  TNC   ! s:2668

     1428     2661    5                            TCM_MBLEN = 0; /*  ? try this */

   2661  7 000673   000000 450200 xsym               STZ   ! TCM_MBLEN

     1429     2662    5                          end;

     1430     2663    4                     end;

     1431     2664    3                end;

     1432     2665    2             RETRY = RETRY + 1;

   2665  7 000674   000011 235000 0                  LDA     RETRY
         7 000675   000001 035007                    ADLA    1,DL
         7 000676   000011 755000 0                  STA     RETRY

     1433     2666    2           end;

   2666  7 000677   000074 115007                    CMPA    60,DL
         7 000700   000526 602000 7                  TNC     s:2628

     1434     2667
     1435     2668    2        if RETRY = 60 then do;

   2668  7 000701   000011 235000 0                  LDA     RETRY
         7 000702   000074 115007                    CMPA    60,DL
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:319  
         7 000703   000720 601000 7                  TNZ     s:2677

     1436     2669    2             TCM_UOBUF = 'PAD did not connect circuit.';

   2669  7 000704   040000 100400                    MLR     fill='040'O
         7 000705   000741 000034 6                  ADSC9   PAD_PROMPT+51            cn=0,n=28
         7 000706   000000 000400 xsym               ADSC9   TCM_UOBUF                cn=0,n=256

     1437     2670                  %WRITEUO;

   2671  7 000707   000000 630400 xsym               EPPR0   TCM_WRITEUO
         7 000710   440001 713400                    CLIMB   alt,write
         7 000711   401400 401760                    pmme    nvectors=4
         7 000712   000714 702000 7                  TSX2    s:2673
         7 000713   000714 710000 7                  TRA     s:2673

     1438     2673    2             call TCM$ALEX_DISCONNECT;

   2673  7 000714   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000715   000000 701000 xent               TSX1    TCM$ALEX_DISCONNECT
         7 000716   000000 011000                    NOP     0

     1439     2674    2             altreturn;

   2674  7 000717   000000 702200 xent               TSX2  ! X66_AALT

     1440     2675    2           end;
     1441     2676
     1442     2677    1        TCM_MBLEN = 0;

   2677  7 000720   000000 450000 xsym               STZ     TCM_MBLEN

     1443     2678    1        TCM_LOCALMODE = '0'B;

   2678  7 000721   000000 450000 xsym               STZ     TCM_LOCALMODE

     1444     2679    1        TCM_NEEDREAD = '1'B;
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:320  

   2679  7 000722   400000 236003                    LDQ     -131072,DU
         7 000723   000000 756000 xsym               STQ     TCM_NEEDREAD

     1445     2680    1        return;

   2680  7 000724   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     002   ****** ******   ****** ******   ****** ******   ****** ******    ................

ACTUAL_PAD_SPEED
 Sect OctLoc
   0     013   000000 000014                                                    ....

BREAK_PAD_SPEED
 Sect OctLoc
   0     014   000000 000000                                                    ....

CR
 Sect OctLoc
   0     017   015*** ******                                                    ....

(unnamed)
 Sect OctLoc
   0     020   012*** ******   ****** ******                                    ........

EIGHT_TBL
 Sect OctLoc
   0     023   270070 270270   070*** ******                                    .8..8...

PAREN_TBL
 Sect OctLoc
   0     026   050250 050250   050*** ******                                    (.(.(...

(unnamed)
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:321  
 Sect OctLoc
   0     030   015007 127101   122116 111116   107054 040065   040155 151156    ..WARNING, 5 min
   0     034   165164 145163   040167 151164   150157 165164   040111 117040    utes without IO
   0     040   150141 166145   040160 141163   163145 144054   040101 114105    have passed, ALE
   0     044   130040 167151   154154 040114   117107 040171   157165 040157    X will LOG you o
   0     050   146146 040151   156040 061040   155151 156165   164145 056007    ff in 1 minute..
   0     054   015*** ******   015007 066040   155151 156165   164145 163040    ......6 minutes
   0     060   167151 164150   157165 164040   111117 040150   141166 145040    without IO have
   0     064   160141 163163   145144 054040   101114 105130   040150 141163    passed, ALEX has
   0     070   040154 157147   147145 144040   171157 165040   157146 146007     logged you off.
   0     074   015*** ******                                                    ....

ACC
 Sect OctLoc
   0     075   000000 000005   764500 102112   106077 040040   040040 002000    ......BJF?    ..
   0     101   077040 040040   040040 040040                                    ?

ACV
 Sect OctLoc
   0     103   000000 000003   764500 007115   125114 123105   116104 ******    .......MULSEND..

OPENUSER
 Sect OctLoc
   0     110   000025 777640   000154 006000   000000 177640   000000 006014    .....l..........
   0     114   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0     154*  000000 000042   000000 001003   252525 010000   000040 252520    ..."......... ..
   0     160   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   0     164   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     170   251000 622000   000000 000000   000000 100000   111250 000000    ..........@.I...
   0     174   040040 040040   000000 000000   000000 000000   000000 000000        ............
   0     200   000000 000000   ****** ******                                    ........

(unnamed)
 Sect OctLoc
   0     202   ****** ******   ****** ******   ****** ******   ****** ******    ................

WRITE_STATION
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:322  
 Sect OctLoc
   0     303   115117 104105   115040 040040   040040 040040   040040 040040    MODEM
   0     307   001000 000000   000000 000000   000000 000000   000000 000000    ................

(unnamed)
 Sect OctLoc
   0     313   115117 104105   115040 040040   040040 040040   040040 040040    MODEM
   0     317   041000 000000   000000 000000   000000 000000   000000 000000    !...............
   0     323   ****** ******                                                    ....

SAVED_TRMATTR
 Sect OctLoc
   0     324   125125 125125   127125 125377   377377 377137   040040 040040    UUUUWUU...._
   0     330   040040 040040   040040 040040   040040 040040   377377 177377                ....
   0     334   377377 377377   377377 377377                                    ........

LOW_SPEED
 Sect OctLoc
   0     336   125125 125125   120125 125377   377377 377137   040040 040040    UUUUPUU...._
   0     342   040040 040040   040040 040040   040040 040040   377377 177377                ....
   0     346   377377 377377   377377 377377                                    ........

AUSTATION
 Sect OctLoc
   0     350   040040 040040   040040 040040   040040 040040   040040 040040
   0     354   001000 000000   000000 000000   000000 000000   000000 000000    ................

CGSTATION
 Sect OctLoc
   0     360   115117 104105   115040 040040   040040 040040   040040 040040    MODEM
   0     364   001000 000000   000000 000000   000000 000000   000000 000000    ................

BIGTBUF
 Sect OctLoc
   0     370   ****** ******   ****** ******   ****** ******   ****** ******    ................

VLR_CGSTATS
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:323  
 Sect OctLoc
   0     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     510*  000000 000000   000000 000000                                    ........

FPT_XCON
 Sect OctLoc
   0     512   000001 777640   000516 006000   000000 777640   000000 006000    ................
   0     516   000000 000000   000000 000000                                    ........

READSI
 Sect OctLoc
   0     520   000005 777640   000530 006000   000000 177640   000000 006014    ................
   0     524   000077 777640   000536 006000   000000 177640   000000 006014    .?..............
   0     530   000000 400000   000000 000000   000000 000000   000000 000000    ................
   0     534   000000 000000   000000 000000                                    ........

SIBUF
 Sect OctLoc
   0     536   ****** ******   ****** ******   ****** ******   ****** ******    ................

READUSER
 Sect OctLoc
   0     636   000005 777640   000646 006000   000000 177640   000000 006014    ................
   0     642   000077 777640   000000 006000   000000 177640   000000 006014    .?..............
   0     646   000000 400000   000000 000000   000000 000000   020000 000000    ................
   0     652   000000 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   0     654   114157 143141   154072 ******                                    Local:..

EOMCG
 Sect OctLoc
   0     656   000003 777640   000664 006000   000007 777640   000303 006000    ................
   0     662   000000 177640   000000 006014   000000 000000   000000 000000    ................
   0     666   001001 000000   000000 000000                                    ........

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:324  
OPENCG
 Sect OctLoc
   6     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
   6     004   000013 777640   000072 006000   000001 377640   000106 006000    .....:.......F..
   6     010   000000 177640   000000 006014   000005 777640   000075 006000    .............=..
   6     014   000003 777640   000103 006000   000000 177640   000000 006014    .....C..........
   6     020   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     024   000001 777640   000110 006000   000000 177640   000000 006014    .....H..........
   6     030   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     044*  000000 400512   000000 003004   252525 000000   000040 252520    ............. ..
   6     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   6     054   000000 000000   000000 000310   000000 000000   000000 000000    ................
   6     060   251000 622000   000000 000000   000000 000000   111310 000000    ............I...
   6     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
   6     070   000000 000000   ****** ******                                    ........

OPENSTA
 Sect OctLoc
   6     072   101114 105130   040040 040040   040040 040040   040040 040040    ALEX
   6     076   040040 040040   040040 040040   000000 000000   040040 040040            ....
   6     102   040040 040040   040040 040040   040040 040040   000000 000000                ....

CG_NAME
 Sect OctLoc
   6     106   005120 101104   103107 ******                                    .PADCG..

CG_ACCT
 Sect OctLoc
   6     110   072123 131123   040040 040040                                    :SYS

DELCG
 Sect OctLoc
   6     112   000025 777640   000156 006000   000000 177640   000000 006014    .....n..........
   6     116   000000 177640   000000 006014   000001 377640   000106 006000    .............F..
   6     122   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     136*  000001 777640   000110 006000   000000 177640   000000 006014    .....H..........
   6     142   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:325  
   6     156*  000000 440052   000000 002001   252525 000000   000040 252520    ...*......... ..
   6     162   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   6     166   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     172   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   6     176   040040 040040   000000 000000   000000 000000   000000 000000        ............
   6     202   000000 000000   ****** ******                                    ........

(unnamed)
 Sect OctLoc
   6     204   000000 000000   000000 000000   077040 040040   040040 040040    ........?
   6     210   077040 040040   040040 040040   000000 000000   000000 000000    ?       ........
   6     214   000000 000000   077040 040040   040040 040040   000000 000000    ....?       ....
   6     220   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     224   300000 000000   000000 000000                                    ........

INHIBIT_OPERATOR_MESSAGES
 Sect OctLoc
   6     226   000001 777640   000232 006000   000007 777640   000303 006000    ................
   6     232   000000 000000   040000 000000                                    .... ...

CURRENT_TRMATTR
 Sect OctLoc
   6     234   000001 777640   000242 006000   000007 777640   000303 006000    ................
   6     240   000011 777640   000324 006000   000000 000000   000000 000000    ................

SET_LOW_SPEED
 Sect OctLoc
   6     244   000001 777640   000252 006000   000007 777640   000303 006000    ................
   6     250   000011 777640   000336 006000   000000 000000   000000 000000    ................

TCM_READCGNONTRANS
 Sect OctLoc
   6     254   000005 777640   000264 006000   000000 177640   000000 006014    ................
   6     260   000077 777640   000000 006000   000007 777640   000360 006000    .?..............
   6     264   000000 000000   000000 000001   000000 000000   000000 000000    ................
   6     270   000000 000000   000000 000000                                    ........

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:326  
READAU
 Sect OctLoc
   6     272   000005 777640   000302 006000   000000 177640   000000 006014    ................
   6     276   000077 777640   000000 006000   000007 777640   000350 006000    .?..............
   6     302   000000 000000   000000 000001   000000 000000   000000 000000    ................
   6     306   000000 000000   000000 000000                                    ........

TCM_READCGBIG
 Sect OctLoc
   6     310   000005 777640   000320 006000   000000 177640   000000 006014    ................
   6     314   000077 777640   000370 006000   000000 177640   000000 006014    .?..............
   6     320   000000 400000   000000 000000   000000 000000   000000 000000    ................
   6     324   000000 000000   000000 000000                                    ........

CLOSELO
 Sect OctLoc
   6     326   000003 777640   000360 006000   000000 177640   000000 006014    ................
   6     332   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     356*  000000 177640   000000 006014   000000 000000   000000 000040    ...............
   6     362   000220 000000   000000 000000                                    ........

FPT_CGCTL
 Sect OctLoc
   6     364   000013 777640   000434 006000   000000 177640   000000 006014    ................
   6     370   000000 177640   000000 006014   000023 777640   000450 006000    ................
   6     374   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     434*  000000 000022   000000 000000   000000 0000**   000000 000000    ................
   6     440   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     444   000000 000000   000000 000000   000000 000000   ****** ******    ................

VLP_CGCP
 Sect OctLoc
   6     450   040040 040040   040040 040040   040040 040040   040040 040040
   6     454   000002 001001   000046 113177   000031 400721   000000 002000    .....&K.........
   6     460   000024 062000   600036 000214   000000 000000   000012 000024    ..2.............
   6     464   000002 ******   000000 000000   000000 000000   000000 000000    ................
   6     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:327  

GET_INFO
 Sect OctLoc
   6     474   000011 777640   000544 006000   000000 177640   000000 006014    ................
   6     500   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     504   000000 177640   000000 006014   000021 777640   000470 006000    ................
   6     510   000000 177640   000000 006014   000000 177640   000000 006014    ................
   6     544*  000000 000011   000000 000000   000000 000000   000000 000000    ................
   6     550   000000 000000   000000 000000   000000 000000   000000 000000    ................
   6     554   000000 000000   ****** ******                                    ........

FPT_EVENT
 Sect OctLoc
   6     556   000001 777640   000560 006000   000000 000000   000000 000000    ................

TAKE15
 Sect OctLoc
   6     562   000001 777640   000566 006000   000000 177640   000000 006014    ................
   6     566   000000 000017   000000 000001                                    ........

PROMPTUSER
 Sect OctLoc
   6     570   000003 777640   000576 006000   000000 177640   000000 006014    ................
   6     574   000000 177640   000614 006000   000000 000000   000000 000000    ................
   6     600   100000 000000   000000 000000                                    @.......

PROMPTCG
 Sect OctLoc
   6     602   000003 777640   000610 006000   000007 777640   000303 006000    ................
   6     606   000000 177640   000614 006000   000000 000000   000000 000000    ................
   6     612   100000 000000   000000 000000                                    @.......

PCHAR
 Sect OctLoc
   6     614   100*** ******                                                    @...

EOMUSER
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:328  
 Sect OctLoc
   6     616   000003 777640   000624 006000   000000 177640   000000 006014    ................
   6     622   000000 177640   000000 006014   000000 000000   000000 000000    ................
   6     626   000062 000000   000000 000000                                    .2......

SET_FLOW_CONTROL
 Sect OctLoc
   6     630   000001 777640   000636 006000   000007 777640   000303 006000    ................
   6     634   000011 777640   000640 006000   000000 000000   000000 000000    ................

DC1DC3
 Sect OctLoc
   6     640   125125 125125   127125 125377   377377 377133   040040 040040    UUUUWUU....[
   6     644   040040 040040   040040 040040   040040 040040   377377 177377                ....
   6     650   377377 377377   377377 377377                                    ........

(unnamed)
 Sect OctLoc
   6     652   015122 105115   117124 105056   104102 113120   114066 015***    .REMOTE.DBKPL6..

PAD_PROMPT
 Sect OctLoc
   6     656   012052 ******                                                    .*..

(unnamed)
 Sect OctLoc
   6     657   120101 104040   144151 144040   156157 164040   143157 156156    PAD did not conn
   6     663   145143 164040   120101 104040   144151 163040   156157 164040    ect PAD dis not
   6     667   162145 163160   157156 144040   164157 040141   165164 157142    respond to autob
   6     673   141165 144040   163145 161165   145156 143145   123105 124065    aud sequenceSET5
   6     677   072061 054066   072065 054061   062072 061054   062060 072060    :1,6:5,12:1,20:0
   6     703   054061 060065   072062 040040   103141 154154   151156 147040    ,105:2  Calling
   6     707   103040 122055   040040 040040   143154 162040   162145 163145    C R-    clr rese
   6     713   164040 040040   145156 147141   147145 144040   145162 162040    t   engaged err
   6     717   103151 162143   165151 164040   143157 156156   145143 164151    Circuit connecti
   6     723   157156 040146   141151 154145   144072 040040   143154 162040    on failed:  clr
   6     727   157143 143040   143154 162040   156143 040040   143154 162040    occ clr nc  clr
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:329  
   6     733   144145 162040   143154 162040   156141 040040   143154 162040    der clr na  clr
   6     737   156160 040040   143157 155040   120101 104040   144151 144040    np  com PAD did
   6     743   156157 164040   143157 156156   145143 164040   143151 162143    not connect circ
   6     747   165151 164056                                                    uit.

(unnamed)
 Sect OctLoc
   8     000   000000 006003   000000 000000   000000 177640   000000 006000    ................
   8     004   000040 040040   056040 040040                                    .   .
     1446     2681    1   end TCM$ALEX_PAD_CONNECT;

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:330  
--  Include file information  --

   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$ALEX_PAD_CONNECT.
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:331  

 **** Variables and constants ****

  ****  Section 000  Data  TCM$ALEX_PAD_CONNECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    75-0-0/w STRC(216)   r     1 ACC                       13-0-0/w UBIN        r     1 ACTUAL_PAD_SPEED
   103-0-0/w STRC(126)   r     1 ACV                      350-0-0/w STRC(288)   r     1 AUSTATION
   370-0-0/c CHAR(256)   r     1 BIGTBUF                   14-0-0/w UBIN        r     1 BREAK_PAD_SPEED
   360-0-0/w STRC(288)   r     1 CGSTATION                 17-0-0/c CHAR        r     1 CR
    23-0-0/b UBIN(9)     r     1 EIGHT_TBL(0:4)
    22-0-0/b UBIN(9)     r     1 EIGHT_VAL                656-0-0/d STRC(360)   r     1 EOMCG
     1-0-0/w PTR         r     1 F$USER$                  512-0-0/d STRC(216)   r     1 FPT_XCON
    16-0-0/w UBIN        r     1 I                        336-0-0/d STRC(360)   r     1 LOW_SPEED
   110-0-0/d STRC(2088)  r     1 OPENUSER
    26-0-0/b UBIN(9)     r     1 PAREN_TBL(0:4)
    25-0-0/b UBIN(9)     r     1 PAREN_VAL                520-0-0/d STRC(504)   r     1 READSI
   636-0-0/d STRC(504)   r     1 READUSER                  11-0-0/w UBIN        r     1 RETRY
   324-0-0/d STRC(360)   r     1 SAVED_TRMATTR            536-0-0/c CHAR(256)   r     1 SIBUF
    12-0-0/w UBIN        r     1 TEMP                     470-0-0/d STRC(648)   r     1 VLR_CGSTATS
   303-0-0/w STRC(288)   r     1 WRITE_STATION

  ****  Section 006 RoData TCM$ALEX_PAD_CONNECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   110-0-0/c STRC(72)    r     1 CG_ACCT                  106-0-0/c STRC(54)    r     1 CG_NAME
   326-0-0/d STRC(1080)  r     1 CLOSELO                  234-0-0/d STRC(288)   r     1 CURRENT_TRMATTR
   640-0-0/d STRC(360)   r     1 DC1DC3                   112-0-0/d STRC(2088)  r     1 DELCG
   616-0-0/d STRC(360)   r     1 EOMUSER                  364-0-0/d STRC(1872)  r     1 FPT_CGCTL
   556-0-0/d STRC(144)   r     1 FPT_EVENT                474-0-0/d STRC(1800)  r     1 GET_INFO
   226-0-0/d STRC(216)   r     1 INHIBIT_OPERATOR_MESSAGES
     0-0-0/d STRC(2088)  r     1 OPENCG                    72-0-0/w STRC(432)   r     1 OPENSTA
   656-0-0/c CHAR(2)     r     1 PAD_PROMPT               614-0-0/c CHAR        r     1 PCHAR
   602-0-0/d STRC(360)   r     1 PROMPTCG                 570-0-0/d STRC(360)   r     1 PROMPTUSER
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:332  
   272-0-0/d STRC(504)   r     1 READAU                   630-0-0/d STRC(288)   r     1 SET_FLOW_CONTROL
   244-0-0/d STRC(288)   r     1 SET_LOW_SPEED            562-0-0/d STRC(216)   r     1 TAKE15
   310-0-0/d STRC(504)   r     1 TCM_READCGBIG            254-0-0/d STRC(504)   r     1 TCM_READCGNONTRANS
   450-0-0/d STRC(720)   r     1 VLP_CGCP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ADDRESS                   6-0-0/w PTR         r     1 @BAILOUT
     4-0-0/w PTR         r     1 @PAR                       5-0-0/w PTR         r     1 @STATUS
    *0-0-0/c CHAR(32)    r     1 ADDRESS                   *0-0-0/d REMB        r     1 BAILOUT
    *0-0-0/w UBIN        r     1 PAR                       *0-0-0/w STRC        r     1 STATUS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 F$CG$
     0-0-0/d REMB        r     1 TCM_ALEX_BAILOUT
     0-0-0/d BIT (72)    r     1 TCM_ALEX_BAILOUT_ENABLED
     0-0-0/w UBIN        r     1 TCM_BLEN                   0-0-0/b BIT         r     1 TCM_COMMAND
     0-0-0/b BIT         r     1 TCM_CONNECTED              0-0-0/d STRC(1512)  r     1 TCM_DELETEMES
     0-0-0/w UBIN        r     1 TCM_G_PARITY               0-0-0/b BIT         r     1 TCM_INT
     0-0-0/b BIT         r     1 TCM_LOCALMODE              0-0-0/w UBIN        r     1 TCM_MBLEN
     0-0-0/c CHAR(1280)  r     1 TCM_MODEMBUF               0-0-0/b BIT         r     1 TCM_NEEDREAD
     0-0-0/c CHAR(332)   r     1 TCM_OUTREC                 0-0-0/d STRC(504)   r     1 TCM_READCG
     0-0-0/c CHAR(256)   r     1 TCM_READCGBUF              0-0-0/c CHAR(256)   r     1 TCM_READUSERBUF
     0-0-0/b UBIN(9)     r     1 TCM_STRIPPAR(0:511)
     0-0-0/d STRC(576)   r     1 TCM_TURNOFF                0-0-0/d STRC(576)   r     1 TCM_TURNON
     0-0-0/c CHAR(256)   r     1 TCM_UOBUF                  0-0-0/b BIT         r     1 TCM_USING_PAD
     0-0-0/d STRC(216)   r     1 TCM_WAIT1                  0-0-0/d STRC(432)   r     1 TCM_WRITECG
     0-0-0/c CHAR(256)   r     1 TCM_WRITECGBUF             0-0-0/d STRC(432)   r     1 TCM_WRITEUO
     0-0-0/w EPTR        r     1 TCM_XCON$

PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:333  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 F$CG                       0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 F$UO                       0-0-0N  NULL        r     1 F$USER
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC


   Procedure TCM$ALEX_PAD_CONNECT requires 469 words for executable code.
   Procedure TCM$ALEX_PAD_CONNECT requires 10 words of local(AUTO) storage.

    No errors detected in file TCM$ALEX2.:TCA2TSI    .
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:334  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:335  
          MINI XREF LISTING

ACC
       868**DCL       740--DCLINIT
ACC.Q
       869**DCL       868--DCLINIT
ACTUAL_PAD_SPEED
       623**DCL      2562>>ASSIGN
ACV
       918**DCL       741--DCLINIT
ACV.Q
       919**DCL       918--DCLINIT
ADDRESS
        10**DCL         6--PROC     2614>>CALLBLT  2618>>CALLBLT
AUSTATION
      1742**DCL      1710--DCLINIT
AUSTATION.MSGIDXT
      1752**DCL      1755--REDEF
AUTOBAUD
      2565**LABEL    2593--EXIT     2596--EXIT
B$CGAUCRD.CGAUCI.ATTR
       578**DCL       578--REDEF
B$CGAUCRD.STATION
       556**DCL       556--REDEF
B$JIT.CPFLAGS1.SLEAZE
       268**DCL       268--REDEF
B$JIT.ERR.MID
       175**DCL       175--REDEF
B$JIT.JRESPEAK
       336**DCL       337--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       445**DCL       445--REDEF     446--REDEF
B$JIT.PNR
       349**DCL       349--REDEF
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:336  
B$JIT.TSLINE
       443**DCL       444--REDEF
B$JIT$
       450**DCL       169--IMP-PTR
B$NWIO.CGPARM.MSGIDXT
       488**DCL       491--REDEF
B$NWIO.CODE
       457**DCL       457--REDEF     458--REDEF     458--REDEF
B$NWIO.ERR.ERR#
       459**DCL       459--REDEF
B$NWIO.EVID
       458**DCL       458--REDEF     458--REDEF
BADOPEN
      2510**LABEL    2507--CALLALT
BAILOUT
        14**DCL         6--PROC     2487--IF       2489>>ASSIGN
BIGTBUF
      1828**DCL      1808--DCLINIT  1809--DCLINIT
BREAK_PAD_SPEED
       624**DCL      2563>>ASSIGN
CANT_CONTINUE
      2514**LABEL    2510--CALLALT  2511--CALLALT
CGSTATION
      1770**DCL      1665--DCLINIT
CGSTATION.MSGIDXT
      1780**DCL      1783--REDEF
CG_ACCT
       854**DCL       743--DCLINIT  1018--DCLINIT
CG_NAME
       839**DCL       739--DCLINIT  1014--DCLINIT
CLOSELO.SN_
      1856**DCL      1856--REDEF
CLOSELO.UTL_
      1857**DCL      1857--REDEF
CLOSELO.V
      1861**DCL      1856--DCLINIT
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:337  
CLOSELO.V.EXPIRE#
      1871**DCL      1871--REDEF
CLOSELO.V.TYPE#
      1869**DCL      1869--REDEF
CLOSELO.V.XTNSIZE#
      1866**DCL      1866--REDEF    1868--REDEF
CMDSTATION.MSGIDXT
      1376**DCL      1379--REDEF
CR
       628**DCL      2572>>ASSIGN   2578>>ASSIGN   2610>>CALLBLT  2620>>ASSIGN
CURRENT_TRMATTR
      1428**DCL      2561<>CALL     2570<>CALL
CURRENT_TRMATTR.V
      1436**DCL      1430--DCLINIT
DC1DC3
      2450**DCL      2427--DCLINIT
DELCG
      1013**DCL      2510<>CALL
DELCG.ACSVEH_
      1015**DCL      1016--REDEF
DELCG.ALTKEYS_
      1021**DCL      1022--REDEF    1022--REDEF
DELCG.HDR_
      1020**DCL      1021--REDEF
DELCG.TAB_
      1019**DCL      1020--REDEF
DELCG.UHL_
      1013**DCL      1014--REDEF    1014--REDEF
DELCG.V
      1022**DCL      1013--DCLINIT
DELCG.V.FSN#
      1053**DCL      1053--REDEF    1053--REDEF
DELCG.WSN_
      1019**DCL      1019--REDEF
EIGHT_TBL
       636**DCL      2498>>ASSIGN
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:338  
EIGHT_VAL
       635**DCL      2498<<ASSIGN
EOMCG
      2356**DCL      2553<>CALL
EOMCG.V
      2364**DCL      2358--DCLINIT
EOMUSER.V
      2398**DCL      2392--DCLINIT
F$CG
       602**DCL      2519--ASSIGN
F$CG$
       606**DCL      2519<<ASSIGN
F$DCB.ACTPOS
       133**DCL       133--REDEF
F$DCB.ARS#
       107**DCL       107--REDEF
F$DCB.ATTR
       126**DCL       127--REDEF
F$DCB.BORROW
       141**DCL       141--REDEF     141--REDEF     141--REDEF
F$DCB.DCBNAME.L
       155**DCL       155--IMP-SIZ
F$DCB.EOMCHAR#
       111**DCL       111--REDEF
F$DCB.FLDID
       136**DCL       136--REDEF
F$DCB.FORM$
       130**DCL       130--REDEF
F$DCB.FSECT
       146**DCL       146--REDEF
F$DCB.FSN#
       123**DCL       123--REDEF     123--REDEF     124--REDEF
F$DCB.HEADER$
       129**DCL       129--REDEF
F$DCB.IXTNSIZE#
       127**DCL       127--REDEF
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:339  
F$DCB.LASTSTA$
       116**DCL       116--REDEF
F$DCB.LVL
       142**DCL       142--REDEF
F$DCB.NAME#.C
       117**DCL       117--REDEF
F$DCB.NOEOF
       139**DCL       139--REDEF
F$DCB.NRECS#
       128**DCL       128--REDEF
F$DCB.NRECX
       147**DCL       147--REDEF
F$DCB.OHDR
       139**DCL       139--REDEF
F$DCB.ORG#
       122**DCL       122--REDEF
F$DCB.PRECNO
       145**DCL       145--REDEF
F$DCB.RCSZ
       151**DCL       151--REDEF
F$DCB.RES#
       118**DCL       118--REDEF
F$DCB.SETX
       130**DCL       130--REDEF
F$DCB.TAB$
       130**DCL       130--REDEF
F$DCB.TDA
       144**DCL       145--REDEF
F$DCB.WSN#
       118**DCL       118--REDEF
F$USER
       604**DCL      2520--ASSIGN
F$USER$
       607**DCL      2520<<ASSIGN
FPT_CGCTL
      1946**DCL      2522<>CALL
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:340  
FPT_CGCTL.V
      1951**DCL      1946--DCLINIT
FPT_EVENT
      2073**DCL      2503<>CALL
FPT_EVENT.V
      2073**DCL      2073--DCLINIT
FPT_XCON
      2088**DCL      2557<>CALL
FPT_XCON.V
      2089**DCL      2088--DCLINIT
GET_INFO
      2026**DCL      2532<>CALL
GET_INFO.V
      2031**DCL      2026--DCLINIT
I
       627**DCL      2492<<DOINDEX  2493>>DOINDEX  2493>>DOINDEX  2528<<ASSIGN   2529>>DOUNTIL  2530<<ASSIGN
      2530>>ASSIGN   2560<<ASSIGN   2565>>DOUNTIL  2600<<ASSIGN   2600>>ASSIGN   2602>>IF       2635<<CALLBLT
      2636>>IF       2637<<CALLBLT  2638>>IF       2639<<CALLBLT  2640>>IF       2641<<CALLBLT  2642>>IF
      2648>>IF       2648>>IF       2648>>IF       2648>>IF       2648>>IF       2658<<CALLBLT  2660>>IF
INHIBIT_OPERATOR_MESSAGES
      1401**DCL      2555<>CALL
INHIBIT_OPERATOR_MESSAGES.V
      1405**DCL      1403--DCLINIT
LOW_SPEED
      1526**DCL      1503--DCLINIT
LOW_SPEED.SPEED#
      1540**DCL      2563<<ASSIGN
M$ACTIVATE
        46**DCL-ENT  2537--CALL     2541--CALL
M$CGCTL
        47**DCL-ENT  2522--CALL
M$CGINFO
        47**DCL-ENT  2532--CALL
M$DEACTIVATE
        46**DCL-ENT  2524--CALL     2539--CALL
M$EOM
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:341  
        51**DCL-ENT  2553--CALL
M$EVENT
        81**DCL-ENT  2503--CALL
M$FWCG
        47**DCL-ENT  2521--CALL
M$GTRMATTR
        52**DCL-ENT  2561--CALL
M$OPEN
        26**DCL-ENT  2504--CALL     2507--CALL     2510--CALL     2511--CALL
M$PROMPT
        50**DCL-ENT  2552--CALL
M$READ
        27**DCL-ENT  2527--CALL     2586--CALL     2629--CALL
M$STRMATTR
        52**DCL-ENT  2554--CALL     2566--CALL     2570--CALL
M$TRMISC
        55**DCL-ENT  2555--CALL
M$WAIT
        84**DCL-ENT  2531--CALL     2538--CALL     2540--CALL     2569--CALL     2571--CALL     2574--CALL
      2577--CALL     2588--CALL     2632--CALL
M$WRITE
        27**DCL-ENT  2546--CALL     2568--CALL     2573--CALL     2576--CALL     2579--CALL     2605--CALL
      2613--CALL     2616--CALL     2623--CALL     2646--CALL     2671--CALL
M$XCON
        81**DCL-ENT  2557--CALL
OPENCG
       738**DCL      2507<>CALL     2511<>CALL
OPENCG.ACSVEH_
       740**DCL       741--REDEF
OPENCG.ALTKEYS_
       746**DCL       747--REDEF     747--REDEF
OPENCG.HDR_
       745**DCL       746--REDEF
OPENCG.TAB_
       744**DCL       745--REDEF
OPENCG.UHL_
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:342  
       738**DCL       739--REDEF     739--REDEF
OPENCG.V
       747**DCL       738--DCLINIT
OPENCG.V.FSN#
       778**DCL       778--REDEF     778--REDEF
OPENCG.WSN_
       744**DCL       744--REDEF
OPENSTA
       796**DCL       739--DCLINIT
OPENUSER
      1128**DCL      2504<>CALL
OPENUSER.ACSVEH_
      1130**DCL      1131--REDEF
OPENUSER.ALTKEYS_
      1136**DCL      1137--REDEF    1137--REDEF
OPENUSER.HDR_
      1135**DCL      1136--REDEF
OPENUSER.TAB_
      1134**DCL      1135--REDEF
OPENUSER.UHL_
      1128**DCL      1129--REDEF    1129--REDEF
OPENUSER.V
      1137**DCL      1128--DCLINIT
OPENUSER.V.FSN#
      1168**DCL      1168--REDEF    1168--REDEF
OPENUSER.WSN_
      1134**DCL      1134--REDEF
PAD_PROMPT
      2475**DCL      2591>>CALLBLT
PAR
         9**DCL         6--PROC     2498>>ASSIGN   2499>>ASSIGN   2500>>ASSIGN
PAREN_TBL
       638**DCL      2500>>ASSIGN
PAREN_VAL
       637**DCL      2500<<ASSIGN
PCHAR
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:343  
      2331**DCL      2291--DCLINIT  2324--DCLINIT
PROMPTCG
      2318**DCL      2552<>CALL
PROMPTCG.V
      2326**DCL      2320--DCLINIT
PROMPTUSER.V
      2293**DCL      2287--DCLINIT
READAU
      1707**DCL      2527<>CALL
READAU.STATION_
      1710**DCL      1711--REDEF
READAU.V
      1711**DCL      1707--DCLINIT
READAU.V.DVBYTE.REREAD#
      1722**DCL      1722--REDEF
READAU.V.INDX#
      1720**DCL      1720--REDEF
READSI.STATION_
      2170**DCL      2171--REDEF
READSI.V
      2171**DCL      2167--DCLINIT
READSI.V.DVBYTE.REREAD#
      2182**DCL      2182--REDEF
READSI.V.INDX#
      2180**DCL      2180--REDEF
READUSER.STATION_
      2244**DCL      2245--REDEF
READUSER.V
      2245**DCL      2241--DCLINIT
READUSER.V.DVBYTE.REREAD#
      2256**DCL      2256--REDEF
READUSER.V.INDX#
      2254**DCL      2254--REDEF
RED
      2627**LABEL    2660--EXIT
RETRY
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:344  
       621**DCL      2581<<ASSIGN   2584>>DOWHILE  2598<<ASSIGN   2598>>ASSIGN   2625<<ASSIGN   2627>>DOWHILE
      2665<<ASSIGN   2665>>ASSIGN   2668>>IF
SAVED_TRMATTR
      1456**DCL      1434--DCLINIT
SAVED_TRMATTR.SPEED#
      1470**DCL      2562<<ASSIGN
SET_FLOW_CONTROL
      2421**DCL      2554<>CALL
SET_FLOW_CONTROL.V
      2429**DCL      2423--DCLINIT
SET_LOW_SPEED
      1497**DCL      2566<>CALL
SET_LOW_SPEED.V
      1505**DCL      1499--DCLINIT
SIBUF
      2221**DCL      2169--DCLINIT  2170--DCLINIT
STATUS
        11**DCL         6--PROC     2486<<ASSIGN
STATUS.HOST_SHUT
        12**DCL      2653<<ASSIGN
TAKE15.V
      2147**DCL      2146--DCLINIT
TCM$ALEX_DISCONNECT
      2479**DCL-ENT  2514--CALL     2548--CALL     2607--CALL     2654--CALL     2673--CALL
TCM$ALEX_EVNT
      2478**DCL-ENT  2073--DCLINIT
TCM$ALEX_XCON
      2481**DCL-ENT  2089--DCLINIT
TCM_ALEX_BAILOUT
        15**DCL        16--REDEF    2489<<ASSIGN
TCM_ALEX_BAILOUT_ENABLED
        16**DCL      2488<<ASSIGN
TCM_BLEN
      1830**DCL      1829--IMP-SIZ  2493<<DOINDEX  2494>>ASSIGN   2494>>ASSIGN   2611<<CALLBLT  2612>>ASSIGN
      2619<<CALLBLT  2620>>ASSIGN   2621<<ASSIGN   2621>>ASSIGN   2622>>ASSIGN
TCM_COMMAND
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:345  
       612**DCL      2526<<ASSIGN
TCM_CONNECTED
       618**DCL      2502<<ASSIGN   2536<<ASSIGN
TCM_DELETEMES
      1188**DCL      2521<>CALL
TCM_EPTBLI
       631**DCL       632--REDEF
TCM_G_PARITY
        13**DCL      2499<<ASSIGN
TCM_INT
       614**DCL      2518<<ASSIGN   2582<<ASSIGN   2587>>IF       2590>>IF       2628<<ASSIGN   2631>>IF
      2634>>IF
TCM_LOCALMODE
       617**DCL      2678<<ASSIGN
TCM_MBLEN
       620**DCL      2525<<ASSIGN   2583<<ASSIGN   2591>>CALLBLT  2595>>IF       2626<<ASSIGN   2635>>CALLBLT
      2636>>IF       2637>>CALLBLT  2638>>IF       2639>>CALLBLT  2640>>IF       2641>>CALLBLT  2642>>IF
      2643>>CALLBLT  2658>>CALLBLT  2660>>IF       2661<<ASSIGN   2677<<ASSIGN
TCM_MODEMBUF
       619**DCL      2591>>CALLBLT  2595>>IF       2635>>CALLBLT  2637>>CALLBLT  2639>>CALLBLT  2641>>CALLBLT
      2643>>CALLBLT  2648>>IF       2648>>IF       2648>>IF       2648>>IF       2648>>IF       2658>>CALLBLT
TCM_NEEDREAD
       616**DCL      2679<<ASSIGN
TCM_OPTBLI
       633**DCL       634--REDEF
TCM_OUTREC
       640**DCL      2491<<ASSIGN
TCM_READCG
      1616**DCL      2586<>CALL
TCM_READCG.STATION_
      1619**DCL      1620--REDEF
TCM_READCG.V.DVBYTE.REREAD#
      1631**DCL      1631--REDEF
TCM_READCG.V.INDX#
      1629**DCL      1629--REDEF
TCM_READCGBIG.STATION_
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:346  
      1809**DCL      1810--REDEF
TCM_READCGBIG.V
      1810**DCL      1806--DCLINIT
TCM_READCGBIG.V.DVBYTE.REREAD#
      1821**DCL      1821--REDEF
TCM_READCGBIG.V.INDX#
      1819**DCL      1819--REDEF
TCM_READCGBUF
      1785**DCL      1664--DCLINIT  1665--DCLINIT  1709--DCLINIT  1710--DCLINIT
TCM_READCGNONTRANS
      1662**DCL      2629<>CALL
TCM_READCGNONTRANS.STATION_
      1665**DCL      1666--REDEF
TCM_READCGNONTRANS.V
      1666**DCL      1662--DCLINIT
TCM_READCGNONTRANS.V.DVBYTE.REREAD#
      1677**DCL      1677--REDEF
TCM_READCGNONTRANS.V.INDX#
      1675**DCL      1675--REDEF
TCM_READCMD.STATION_
      1573**DCL      1574--REDEF
TCM_READCMD.V.DVBYTE.REREAD#
      1585**DCL      1585--REDEF
TCM_READCMD.V.INDX#
      1583**DCL      1583--REDEF
TCM_READUSERBUF
      2264**DCL      2243--DCLINIT  2244--DCLINIT
TCM_STRIPPAR
       639**DCL      2494<<ASSIGN
TCM_TURNOFF
      1920**DCL      2524<>CALL     2539<>CALL
TCM_TURNOFF.V.DVBYTE.REREAD#
      1923**DCL      1923--REDEF
TCM_TURNON
      1892**DCL      2537<>CALL     2541<>CALL
TCM_TURNON.V.DVBYTE.REREAD#
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:347  
      1895**DCL      1895--REDEF
TCM_UOBUF
      2222**DCL      2544<<ASSIGN   2603<<ASSIGN   2614<<CALLBLT  2643<<CALLBLT  2669<<ASSIGN
TCM_USING_PAD
       611**DCL      2501<<ASSIGN
TCM_WAIT1
      2118**DCL      2531<>CALL     2538<>CALL     2540<>CALL     2569<>CALL     2571<>CALL     2574<>CALL
      2577<>CALL     2588<>CALL     2632<>CALL
TCM_WRITECG
      1267**DCL      2568<>CALL     2573<>CALL     2576<>CALL     2579<>CALL     2613<>CALL     2623<>CALL
TCM_WRITECG.BUF_
      1267**DCL      2559<<ASSIGN   2612<<ASSIGN   2622<<ASSIGN
TCM_WRITECG.STATION_
      1269**DCL      1269--REDEF
TCM_WRITECG.V.DVBYTE.VFC#
      1276**DCL      1276--REDEF
TCM_WRITECGBUF
      1282**DCL      2559--ASSIGN   2567<<ASSIGN   2572<<ASSIGN   2575<<ASSIGN   2578<<ASSIGN   2610<<CALLBLT
      2611>>CALLBLT  2612--ASSIGN   2618<<CALLBLT  2619>>CALLBLT  2620<<ASSIGN   2622--ASSIGN
TCM_WRITEUO
      2206**DCL      2546<>CALL     2605<>CALL     2616<>CALL     2646<>CALL     2671<>CALL
TCM_WRITEUO.STATION_
      2208**DCL      2208--REDEF
TCM_WRITEUO.V.DVBYTE.VFC#
      2215**DCL      2215--REDEF
TCM_WRITEUSER.STATION_
      1306**DCL      1306--REDEF
TCM_WRITEUSER.V.DVBYTE.VFC#
      1313**DCL      1313--REDEF
TCM_XCON$
      2091**DCL      2088--DCLINIT
TEMP
       622**DCL      2591<<CALLBLT
VLP_CGCP
      1981**DCL      1947--DCLINIT
VLP_CGCP.DVBYTE.REREAD#
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:348  
      1995**DCL      1996--REDEF
VLP_CGMA.MSGIDXT
      1220**DCL      1223--REDEF
VLR_CGSTATS
      2048**DCL      2028--DCLINIT
VLR_CGSTATS.NUMTERMS
      2054**DCL      2529>>DOUNTIL  2534>>IF
WRITE_STATION
      1336**DCL      1403--DCLINIT  1432--DCLINIT  1501--DCLINIT  2322--DCLINIT  2360--DCLINIT  2425--DCLINIT
WRITE_STATION.MSGIDXT
      1346**DCL      1349--REDEF
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:349  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:350  
              MINI UREF LISTING

B$TCB     452**DCL
BUFC    1829**DCL
CMDBUF    1320**DCL
CMDBUFLEN    1321**DCL
CMDI     625**DCL
EPTBL     632**DCL
F$UO     605**DCL
FLAG     630**DCL
INTRO    2483**DCL-ENT
KOZINN    2480**DCL-ENT
LCLPROMPT    2332**DCL
LF     629**DCL
M$ACCT      43**DCL-ENT
M$ALIB      39**DCL-ENT
M$ASUSER      41**DCL-ENT
M$ATTACH      48**DCL-ENT
M$BADPP      66**DCL-ENT
M$CHECK      28**DCL-ENT
M$CHGUNIT      86**DCL-ENT
M$CLOSE      26**DCL-ENT
M$CLRSTK      84**DCL-ENT
M$CMDVAR      95**DCL-ENT
M$CONFIG      56**DCL-ENT
M$CORRES      31**DCL-ENT
M$CPEXIT      40**DCL-ENT
M$CVM      64**DCL-ENT
M$CVOL      29**DCL-ENT
M$DCLFLD      56**DCL-ENT
M$DELREC      28**DCL-ENT
M$DEQ      93**DCL-ENT
M$DETACH      48**DCL-ENT
M$DEVICE      30**DCL-ENT
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:351  
M$DISPLAY      93**DCL-ENT
M$DISPRES      33**DCL-ENT
M$DLIB      39**DCL-ENT
M$DRIBBLE      56**DCL-ENT
M$DRTN      84**DCL-ENT
M$DSUSER      41**DCL-ENT
M$ENQ      92**DCL-ENT
M$ERASE      57**DCL-ENT
M$ERR      38**DCL-ENT
M$ERRMSG      89**DCL-ENT
M$EXHUME      90**DCL-ENT
M$EXIT      38**DCL-ENT
M$EXTEND      30**DCL-ENT
M$FDP      62**DCL-ENT
M$FDS      61**DCL-ENT
M$FEBOOT      54**DCL-ENT
M$FECTL      55**DCL-ENT
M$FEDUMP      54**DCL-ENT
M$FID      89**DCL-ENT
M$FINDPROC      43**DCL-ENT
M$FSUSER      41**DCL-ENT
M$FVP      63**DCL-ENT
M$GBPL      67**DCL-ENT
M$GDDL      63**DCL-ENT
M$GDP      62**DCL-ENT
M$GDS      61**DCL-ENT
M$GETDCB      32**DCL-ENT
M$GETMOUSE      72**DCL-ENT
M$GETPM      73**DCL-ENT
M$GJOB      91**DCL-ENT
M$GLINEATTR      51**DCL-ENT
M$GOODPP      66**DCL-ENT
M$GPLATEN      59**DCL-ENT
M$GPROMPT      58**DCL-ENT
M$GTRMCTL      50**DCL-ENT
M$GTRMTAB      53**DCL-ENT
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:352  
M$GVP      62**DCL-ENT
M$HELP      89**DCL-ENT
M$INT      81**DCL-ENT
M$INTRTN      42**DCL-ENT
M$IOQ      77**DCL-ENT
M$JOBSTATS      91**DCL-ENT
M$KEYIN      31**DCL-ENT
M$LDEV      26**DCL-ENT
M$LDTRC      39**DCL-ENT
M$LIMIT      32**DCL-ENT
M$LINES      31**DCL-ENT
M$LINK      38**DCL-ENT
M$MADMUCK      34**DCL-ENT
M$MAKUSER      65**DCL-ENT
M$MBS      33**DCL-ENT
M$MDFFLD      57**DCL-ENT
M$MERC      82**DCL-ENT
M$MERCS      83**DCL-ENT
M$MIRROR      77**DCL-ENT
M$MONINFO      94**DCL-ENT
M$MPL      67**DCL-ENT
M$NODEINFO      58**DCL-ENT
M$NXTUSR      92**DCL-ENT
M$OCMSG      90**DCL-ENT
M$OLAY      38**DCL-ENT
M$PAS      67**DCL-ENT
M$PATHCON      90**DCL-ENT
M$PDS      61**DCL-ENT
M$PFIL      28**DCL-ENT
M$PLATEN      52**DCL-ENT
M$PRECORD      30**DCL-ENT
M$PROCNAME      43**DCL-ENT
M$PROFILE      54**DCL-ENT
M$RACST      34**DCL-ENT
M$RDSYSLOG      75**DCL-ENT
M$RELDCB      32**DCL-ENT
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:353  
M$RELRES      33**DCL-ENT
M$RELSTARF      35**DCL-ENT
M$REM      35**DCL-ENT
M$RENV      82**DCL-ENT
M$REQUIRE      34**DCL-ENT
M$RETRY      83**DCL-ENT
M$RETRYS      83**DCL-ENT
M$REW      29**DCL-ENT
M$RLSFLD      57**DCL-ENT
M$RPRIV      85**DCL-ENT
M$RSPP      64**DCL-ENT
M$RSWITCH      86**DCL-ENT
M$RUE      92**DCL-ENT
M$SAD      65**DCL-ENT
M$SAVE      41**DCL-ENT
M$SCON      42**DCL-ENT
M$SCREECH      40**DCL-ENT
M$SENV      82**DCL-ENT
M$SETFMA      26**DCL-ENT
M$SETFP      55**DCL-ENT
M$SI     603**DCL
M$SINPUT      53**DCL-ENT
M$SLCFLD      58**DCL-ENT
M$SMOUSE      72**DCL-ENT
M$SMPRT      64**DCL-ENT
M$SPRIV      85**DCL-ENT
M$SSC      65**DCL-ENT
M$SSWITCH      85**DCL-ENT
M$STATE      94**DCL-ENT
M$STD      66**DCL-ENT
M$STIMER      80**DCL-ENT
M$STLPP      63**DCL-ENT
M$STRAP      80**DCL-ENT
M$STRMCTL      50**DCL-ENT
M$STRMTAB      53**DCL-ENT
M$SYMBIO      91**DCL-ENT
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:354  
M$SYSCON      77**DCL-ENT
M$SYSID      95**DCL-ENT
M$TDCLOSE      76**DCL-ENT
M$TDIO      76**DCL-ENT
M$TDOPEN      75**DCL-ENT
M$TDREQCPU      76**DCL-ENT
M$TEMPWROC      70**DCL-ENT
M$TIME      93**DCL-ENT
M$TRAP      80**DCL-ENT
M$TRMPRG      51**DCL-ENT
M$TRTN      84**DCL-ENT
M$TRUNC      27**DCL-ENT
M$TTIMER      80**DCL-ENT
M$UC      50**DCL
M$UMPL      67**DCL-ENT
M$UNFID      89**DCL-ENT
M$UNLATCH      46**DCL-ENT
M$UNSHARE      43**DCL-ENT
M$USRFIELD      86**DCL-ENT
M$VIRTUAL      61**DCL-ENT
M$WEOF      29**DCL-ENT
M$WRSYSLOG      75**DCL-ENT
M$XCONRTN      42**DCL-ENT
M$XEQTIME      94**DCL-ENT
M$XFLUSH      35**DCL-ENT
M$XMOUSE      72**DCL-ENT
M$XXX      38**DCL-ENT
M$YC      40**DCL-ENT
OFFMES     649**DCL
OPTBL     634**DCL
REMOVE_PROGRAM    2472**DCL
SLOG     608**DCL
TBUF       8**DCL
TCM$ALEX_OK    2482**DCL-ENT
TCM$ALEX_PAD_CONNECT       6**PROC
TCM_EXEC     613**DCL
PL6.E3A0      #010=TCM$ALEX_PAD_CONNECT File=TCM$ALEX2.:TCA2TSI                  SUN 11/16/97 14:21 Page:355  
TCM_LOCAL     615**DCL
TCM_NORM    2104**DCL
TCM_TAKE5    2132**DCL
TCM_TIMEOUT     626**DCL
TCM_WRITEUSERBUF    1319**DCL
VLP_SCGMA    1240**DCL
WARNMES     641**DCL
