VERSION E05

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:1    
        1        1        /*M* KQQ$QUEUE QUEUE-specific routines for COMGROUP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KQQ$QUEUE
       10       10             PURPOSE:      To provide routines specific to the comgroup QUEUE
       11       11             DESCRIPTION:  Contains various routines
       12       12        */
       13       13        /**/
       14       14        KQQ$DEQUEUE: PROC (KQ$CG,PARM$) ALTRET;
       15       15        /**/
       16       16
       17       17
       18       18
       19       19        /**/
       20       20        /* INCLUDES */
       21       21        /**/
       22       22        %INCLUDE KQ_SUBS_C;
       23      322        %INCLUDE KQ_MAC_C;
       24     2872        %INCLUDE HF_LOCK_C;
       25     2886        %INCLUDE KQ_DATA_R;
       26     3718        %INCLUDE NK$LDCT;
       27     3820        %INCLUDE NK_SUBS;
       28     3845        %INCLUDE CP_6_SUBS;
       29     4385        %INCLUDE KC$CP6V_C;
       30     4505        %INCLUDE KC_CP6;
       31     5065
       32     5066
       33     5067
       34     5068        /**/
       35     5069        /* PARAMETERS */
       36     5070        /**/
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:2    
       37     5071        %KQ_CG   (FPTN=KQ$CG,STCLASS="");
       38     5810    1   DCL PARM$ PTR;
       39     5811
       40     5812
       41     5813
       42     5814        /**/
       43     5815        /* BASED STRUCTURES */
       44     5816        /**/
       45     5817    1   DCL B$$PTR PTR BASED ALIGNED;
       46     5818        %KQ_STA  (FPTN=KQ$STA ,STCLASS="BASED(STA$)");
       47     6157        %KQ_RBLK (FPTN=KQ$RBLK,STCLASS="BASED(RBLK$)");
       48     6343        %KQ_THDR (FPTN=KQ$THDR,STCLASS=BASED);
       49     6381        %KQ_QTN  (FPTN=KQ$QTN ,STCLASS="BASED(QTN$)");
       50     6854    1   DCL B$$KEY1 CHAR(KEY1L) BASED ALIGNED;
       51     6855
       52     6856
       53     6857
       54     6858        /**/
       55     6859        /* AUTO */
       56     6860        /**/
       57     6861    1   DCL STA$ PTR;
       58     6862    1   DCL RBLK$ PTR;
       59     6863    1   DCL MBLK$ PTR;
       60     6864    1   DCL P$ PTR;
       61     6865    1   DCL I UBIN;
       62     6866    1   DCL KEY1L REDEF I UBIN;
       63     6867    1   DCL QTN$ PTR;
       64     6868    1   DCL PP$ PTR;
       65     6869
       66     6870
       67     6871
       68     6872        /**/
       69     6873        /* REFS */
       70     6874        /**/
       71     6875    1   DCL KQL$QDELAYM   ENTRY(2) ALTRET;
       72     6876    1   DCL KQL$QDFIND    ENTRY(2) ALTRET;
       73     6877    1   DCL KQL$QXFDUN    ENTRY(1) ALTRET;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:3    
       74     6878    1   DCL KQL$RCVRDLY   ENTRY(2) ALTRET;
       75     6879    1   DCL KQM$RELRBLK   ENTRY(2) ALTRET;
       76     6880    1   DCL KQR$GETQUEUE  ENTRY(1) ALTRET;
       77     6881    1   DCL KQR$GETRBLK   ENTRY(1) ALTRET;
       78     6882    1   DCL KQW$XMITQR    ENTRY(1) ALTRET;
       79     6883    1   DCL SC_CGCANZ     ENTRY    CONV(2,0);
       80     6884
       81     6885
       82     6886
       83     6887        /**/
       84     6888        /* SUBS */
       85     6889        /**/
       86     6890        %SUB KQ$QTREE="KQ$CG.QUEUE.QTREE$->KQ$THDR";
       87     6891        %SUB KQ$TTREE="KQ$CG.TTREE";
       88     6892        %SUB KQ$STREE="KQ$CG.STREE";
       89     6893        %SUB KQ$QUEUE="KQ$CG.QUEUE";
       90     6894        %EJECT;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:4    
       91     6895        /**/
       92     6896        /*F* NAME:         KQQ$DEQUEUE
       93     6897             PURPOSE:      To remove a read from the queue.
       94     6898             DESCRIPTION:  RBLK$ is passed as PARM$.
       95     6899                           Calls DEQUEUE and returns.
       96     6900
       97     6901         KQQ$DEQUEUE: ENTRY (KQ$CG,PARM$) ALTRET;    !!Doesn't ALTRET!! */
       98     6902        /**/
       99     6903    1         RBLK$=PARM$;
      100     6904    1         CALL DEQUEUE;
      101     6905    1   RTN:  ;
      102     6906    1         RETURN;
      103     6907        /**/
      104     6908        /*F* NAME:        KQQ$DQEOFTIME
      105     6909             PURPOSE:     To remove a read from the EOFTIME list
      106     6910             DESCRIPTION: RBLK$ is passed as PARM$.
      107     6911                          Calls DQEOFTIME and returns.
      108     6912        */
      109     6913    1   KQQ$DQEOFTIME: ENTRY (KQ$CG,PARM$) ALTRET; /* !!Doesn't ALTRET!! */
      110     6914        /**/
      111     6915    1         RBLK$=PARM$;
      112     6916    1         CALL DQEOFTIME;
      113     6917    1         RETURN;
      114     6918        /**/
      115     6919        /*F* NAME:         KQQ$RECOVER
      116     6920             PURPOSE:      To clean up the anonymous QUEUE when a crashed
      117     6921                           comgroup is being reopened.
      118     6922             INPUT:        KQT$RECOVER has been called
      119     6923                           clock is disabled
      120     6924             DESCRIPTION:  - zaps LOCKCNT in each queue node
      121     6925                           - zaps the queue read flags
      122     6926                           - zaps the '*GORGO' station's Q-node listhead
      123     6927                           - zaps the QUEUE read lists
      124     6928                           - fixes up the DELAY$ list
      125     6929        */
      126     6930    1   KQQ$RECOVER: ENTRY (KQ$CG) ALTRET; /* !!Doesn't ALTRET!! */
      127     6931        /**/
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:5    
      128     6932    1         QTN$=KQ$CG.QUEUE.PLHD$;
      129     6933    2           DO WHILE (QTN$ ~= ADDR(NIL));
      130     6934    2           QTN$->KQ$QTN.LOCKCNT=0;
      131     6935    2           QTN$=QTN$->KQ$QTN.PLINK$;
      132     6936    2           END;
      133     6937        /**/
      134     6938    2         IF KQ$CG.GORGOSTA$~=ADDR(NIL) THEN DO;
      135     6939    2           KQ$CG.GORGOSTA$->KQ$STA.ACTHD$=ADDR(NIL);
      136     6940    2           KQ$CG.GORGOSTA$->KQ$STA.AIP='0'B;
      137     6941    2           END;
      138     6942    1         KQ$QUEUE.GACT='0'B;
      139     6943    1         KQ$QUEUE.RQMEM='0'B;
      140     6944    1         KQ$QUEUE.RQGC='0'B;
      141     6945    1         KQ$QUEUE.BUSY='0'B;
      142     6946    1         KQ$QUEUE.RUSR#=0;
      143     6947    1         KQ$QUEUE.WCRL$=ADDR(NIL);
      144     6948    1         QTN$=KQ$QTREE.HEAD$;
      145     6949    2           DO WHILE (QTN$ ~= ADDR(NIL));
      146     6950    2           QTN$->KQ$QTN.READS$=ADDR(NIL);
      147     6951    2           QTN$=QTN$->KQ$QTN.STA.BTN.FLINK$;
      148     6952    2           END;
      149     6953        /**/ /* Flush DELAY$ list */
      150     6954    1         CALL KQL$RCVRDLY (KQ$QUEUE.DELAY$,KQ$QUEUE.DELAYDQ$);
      151     6955              %LOCK (G=KQ$QTREE.GATE);
      152     6958    1         P$=ADDR(KQ$CG);
      153     6959    1         CALL KQW$XMITQR (P$);
      154     6960              %UNLOCK (G=KQ$QTREE.GATE);
      155     6963        /**/
      156     6964    1         RETURN;
      157     6965        /**/
      158     6966        /*F* NAME:         KQQ$RECOVER2
      159     6967             PURPOSE:      To clean up the anonymous QUEUE when a crashed
      160     6968                           comgroup is being reopened.
      161     6969             INPUT:        KQR$RECOVER/KQP$RECOVER has been called for
      162     6970                           each station
      163     6971             DESCRIPTION:  Does the following:
      164     6972
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:6    
      165     6973                           - ensures CNACT=0 in each Q-tree node; SNAPs if
      166     6974                             not
      167     6975        */
      168     6976    1   KQQ$RECOVER2: ENTRY (KQ$CG) ALTRET; /* !!Doesn't ALTRET!! */
      169     6977        /**/
      170     6978    1         I=0;
      171     6979    1         QTN$=KQ$CG.QUEUE.PLHD$;
      172     6980    2           DO WHILE (QTN$ ~= ADDR(NIL));
      173     6981    2           IF QTN$->KQ$QTN.CNACT-QTN$->KQ$QTN.CRASHACT ~= 0 THEN
      174     6982    3             DO;
      175     6983    3             I=I+1;
      176     6984    3             P$=QTN$;
      177     6985    3             END;
      178     6986    2           ELSE
      179     6987    3             DO;
      180     6988    3             QTN$->KQ$QTN.CNACT=0;
      181     6989    3             QTN$->KQ$QTN.CRASHACT=0;
      182     6990    3             END;
      183     6991    2           QTN$=QTN$->KQ$QTN.PLINK$;
      184     6992    2           END;
      185     6993    1         IF I ~= 0 THEN
      186     6994    2           DO;
      187     6995    2           CALL SC_CGCANZ;
      188     6996        /*S* SCREECH_CODE: KQQ-S$CGCANZ
      189     6997             TYPE:         SNAP
      190     6998             MESSAGE:      The comgroup queue has active messages after recovery
      191     6999             REMARKS:      This SNAP occurs when a comgroup is being opened
      192     7000                           after having been closed by RECOVER.  It is caused
      193     7001                           by CNACT in some Q-tree node being > 0 after all
      194     7002                           cleanup has been performed.
      195     7003                           This implies something was lost during the crash.
      196     7004                           CNACT is zeroed in all the nodes and the open
      197     7005                           continues. */
      198     7006    2           QTN$=KQ$CG.QUEUE.PLHD$;
      199     7007    3             DO WHILE (QTN$ ~= ADDR(NIL));
      200     7008    3             QTN$->KQ$QTN.CNACT=0;
      201     7009    3             QTN$->KQ$QTN.CRASHACT=0;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:7    
      202     7010    3             QTN$=QTN$->KQ$QTN.PLINK$;
      203     7011    3             END;
      204     7012    2           END;
      205     7013        /**/
      206     7014    1         RETURN;
      207     7015        %EJECT;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:8    
      208     7016        /**/
      209     7017        /*F* NAME:         KQQ$ACT
      210     7018             PURPOSE:      To satisfy reads from a particular Q-tree node
      211     7019             DESCRIPTION:  When an UNLATCH of a message read from a Q-tree
      212     7020                           node causes CNACT to become 1 less than MXACT,
      213     7021                           we must try to give away the messages waiting
      214     7022                           in that node because it is now OK to do so and
      215     7023                           there may be reads waiting for them.  Called
      216     7024                           with the queue locked.  PARM$ points to the node.
      217     7025
      218     7026                           Also called when MXACT is increased by the AU.
      219     7027
      220     7028                           Guarantees to satisfy all possible reads.
      221     7029
      222     7030                           Always unlocks the queue before returning.
      223     7031        */
      224     7032    1   KQQ$ACT: ENTRY (KQ$CG,PARM$) ALTRET;
      225     7033        /**/
      226     7034    1         QTN$=PARM$;
      227     7035    1         IF KQ$CG.RCVR
      228     7036    1         OR QTN$->KQ$QTN.ACTWAIT
      229     7037    1         OR QTN$->KQ$QTN.MLH.COUNT = 0 THEN GOTO ACT10;
      230     7038    1         IF QTN$->KQ$QTN.READS$ = ADDR(NIL) THEN
      231     7039    2           DO;
      232     7040    2           RBLK$=KQ$CG.QUEUE.WCRL$;
      233     7041    3             DO WHILE (RBLK$ ~= ADDR(NIL));
      234     7042    3             KEY1L=RBLK$->KQ$RBLK.KEY1L;
      235     7043    3             IF ADDR(RBLK$->KQ$RBLK.KEY1)->B$$KEY1 = ADDR(QTN$->KQ$QTN.STA.BTN.KEY)->
              7043                      B$$KEY1 THEN
      236     7044    3              GOTO ACT0;
      237     7045    3             RBLK$=RBLK$->KQ$RBLK.QRLNK$;
      238     7046    3             END;
      239     7047    2           GOTO ACT10;
      240     7048    2           END;
      241     7049    1   ACT0: ;
      242     7050        /**/
      243     7051    1         QTN$->KQ$QTN.ACTWAIT='1'B;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:9    
      244     7052    1         QTN$->KQ$QTN.LOCKCNT=QTN$->KQ$QTN.LOCKCNT+1;
      245     7053    1         STA$=KQ$CG.GORGOSTA$;
      246     7054              %LOCK (G=STA$->KQ$STA.GATE);
      247     7057    1         QTN$->KQ$QTN.ACTLNK$=STA$->KQ$STA.ACTHD$;
      248     7058    1         STA$->KQ$STA.ACTHD$=QTN$;
      249     7059    1         IF STA$->KQ$STA.AIP THEN GOTO ACT6;
      250     7060    1         STA$->KQ$STA.AIP='1'B;
      251     7061              %UNLOCK (G=STA$->KQ$STA.GATE);
      252     7064    1   ACT1: ;
      253     7065    1         QTN$=STA$->KQ$STA.ACTHD$;
      254     7066    1         IF QTN$ = ADDR(NIL) THEN
      255     7067    2           DO;
      256     7068    2           STA$->KQ$STA.RBLK$=ADDR(NIL);
      257     7069    2           CALL KQM$RELRBLK (KQ$CG,RBLK$);
      258     7070    2   ACT2:   ;
      259     7071                %LOCK (G=STA$->KQ$STA.GATE);
      260     7074    2           STA$->KQ$STA.AIP='0'B;
      261     7075    2   ACT6:   ;
      262     7076                %UNLOCK (G=STA$->KQ$STA.GATE);
      263     7079    2   ACT10:  ;
      264     7080                %UNLOCK (G=KQ$QTREE.GATE);
      265     7083    2           RETURN;
      266     7084    2           END;
      267     7085    1         STA$->KQ$STA.ACTHD$=QTN$->KQ$QTN.ACTLNK$;
      268     7086              %UNLOCK (G=KQ$QTREE.GATE);
      269     7089    1         CALL KQR$GETRBLK (STA$->KQ$STA) ALTRET(ACT60);
      270     7090    1         RBLK$=STA$->KQ$STA.RBLK$;
      271     7091    1         RBLK$->KQ$RBLK.LATCH='1'B;
      272     7092    1         RBLK$->KQ$RBLK.KEY1L=0;
      273     7093    1         RBLK$->KQ$RBLK.KEY2L=0;
      274     7094    1         CALL KQR$GETQUEUE (STA$->KQ$STA);
      275     7095    1   ACT20:;
      276     7096    1         IF QTN$->KQ$QTN.MXACT > QTN$->KQ$QTN.CNACT THEN
      277     7097    2           DO;
      278     7098    2           RBLK$->KQ$RBLK=KQ_IRBLK;
      279     7099    2           MBLK$=QTN$;
      280     7100    2           CALL KQL$QDFIND (STA$->KQ$STA,MBLK$) ALTRET(ACT40);
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:10   
      281     7101    2           END;
      282     7102    1         QTN$->KQ$QTN.LOCKCNT=QTN$->KQ$QTN.LOCKCNT-1;
      283     7103    1         QTN$->KQ$QTN.ACTWAIT='0'B;
      284     7104    1         CALL KQL$QXFDUN (STA$->KQ$STA);
      285     7105              %LOCK (G=KQ$QTREE.GATE);
      286     7108    1         GOTO ACT1;
      287     7109    1   ACT40:;
      288     7110    1         CALL KQL$QDELAYM (KQ$CG,MBLK$);
      289     7111    1         GOTO ACT20;
      290     7112    1   ACT60:;
      291     7113              %LOCK (G=KQ$QTREE.GATE);
      292     7116    1         QTN$->KQ$QTN.ACTWAIT='0'B;
      293     7117    1         QTN$->KQ$QTN.LOCKCNT=QTN$->KQ$QTN.LOCKCNT-1;
      294     7118    1         GOTO ACT2;
      295     7119        %EJECT;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:11   
      296     7120        /**/
      297     7121        /*********************************************************************************
      298     7122        *                                                                                *
      299     7123        *   SSS   U   U  BBBB   RRRR    OOO   U   U  TTTTT   III   N   N  EEEEE   SSS    *
      300     7124        *  S   S  U   U  B   B  R   R  O O O  U   U    T      I    N   N  E      S   S   *
      301     7125        *  S      U   U  B   B  R   R  O O O  U   U    T      I    NN  N  E      S       *
      302     7126        *   SSS   U   U  BBBB   RRRR   O  OO  U   U    T      I    N N N  EEEE    SSS    *
      303     7127        *      S  U   U  B   B  R R    O   O  U   U    T      I    N  NN  E          S   *
      304     7128        *  S   S  U   U  B   B  R  R   O   O  U   U    T      I    N   N  E      S   S   *
      305     7129        *   SSS    UUU   BBBB   R   R   OOO    UUU     T     III   N   N  EEEEE   SSS    *
      306     7130        *                                                                                *
      307     7131        *********************************************************************************/
      308     7132
      309     7133        /****************************************************************
      310     7134        *****************************************************************/
      311     7135        /*D* NAME:         DEQUEUE
      312     7136             PURPOSE:      To remove an RBLK from the QUEUE.
      313     7137             DESCRIPTION: RBLK$ is found on the appropriate queue (if there)
      314     7138                          and is removed. Note that it may not be there since
      315     7139                          KQ$RBLK.STA$ is also not ADDR(NIL) if EOFTIME was
      316     7140                          specified for this read.
      317     7141        */
      318     7142    1   DEQUEUE: PROC ALTRET;
      319     7143    2         IF RBLK$->KQ$RBLK.STA$ ~= ADDR(NIL) THEN
      320     7144    3           DO;
      321     7145                %LOCK (G=KQ$QTREE.GATE);
      322     7148                                /* KQC$CTL can jerk it out from under us */
      323     7149    3           IF RBLK$->KQ$RBLK.STA$ ~= ADDR(NIL) THEN
      324     7150    4             DO;
      325     7151    4             IF RBLK$->KQ$RBLK.QTN$ = ADDR(NIL) THEN
      326     7152    4              P$=ADDR(KQ$CG.QUEUE.WCRL$);
      327     7153    4             ELSE P$=ADDR(RBLK$->KQ$RBLK.QTN$->KQ$QTN.READS$);
      328     7154    4             PP$=P$->B$$PTR;
      329     7155    5               DO WHILE(PP$~=ADDR(NIL));
      330     7156    5               IF PP$ = RBLK$ THEN
      331     7157    6                 DO;
      332     7158    6                 P$->B$$PTR=RBLK$->KQ$RBLK.QRLNK$;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:12   
      333     7159    6                 RBLK$->KQ$RBLK.QRLNK$=ADDR(NIL);
      334     7160    6                 GOTO DUN;
      335     7161    6                 END;
      336     7162    5               P$=ADDR(PP$->KQ$RBLK.QRLNK$);
      337     7163    5               PP$=P$->B$$PTR;
      338     7164    5               END;
      339     7165    4             END;
      340     7166    3   DUN:    ;
      341     7167                %UNLOCK (G=KQ$QTREE.GATE);
      342     7170    3           END;
      343     7171    2         RETURN;
      344     7172    2   END DEQUEUE;
      345     7173        /**/
      346     7174        /**/
      347     7175        /*D* NAME:        DQEOFTIME
      348     7176             PURPOSE:     To remove an RBLK from the KQ$CG.EOFTIMEHD$ list
      349     7177             DESCRIPTION: The passed RBLK is found on the KQ$CG.EOFTIMEHD$ list
      350     7178                          and is removed. If this causes KQ$CG.EOFTIMEHD$ to
      351     7179                          become ADDR(NIL) then KQ$CG.EOFTIME is set to 0.
      352     7180        */
      353     7181    1   DQEOFTIME: PROC;
      354     7182              %LOCK(G=KQ$STREE.GATE);
      355     7185    2         IF RBLK$->KQ$RBLK.EOFTIME=0 THEN GOTO XIT;
      356     7186    2         P$=ADDR(KQ$CG.EOFTIMEHD$);
      357     7187    3           DO FOREVER;
      358     7188    3           IF P$->B$$PTR=ADDR(NIL) THEN
      359     7189    4             DO;
      360     7190    4             CALL SC_CGCANZ;
      361     7191    4             GOTO XIT;
      362     7192    4             END;
      363     7193    3           IF P$->B$$PTR=RBLK$ THEN
      364     7194    4             DO;
      365     7195    4             P$->B$$PTR=RBLK$->KQ$RBLK.EOFTIMELNK$;
      366     7196    4             RBLK$->KQ$RBLK.EOFTIME=0;
      367     7197    4             IF KQ$CG.EOFTIMEHD$=ADDR(NIL) THEN
      368     7198    4              KQ$CG.EOFTIME=0;
      369     7199    4   XIT:      ;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:13   
      370     7200                  %UNLOCK(G=KQ$STREE.GATE);
      371     7203    4             RETURN;
      372     7204    4             END;
      373     7205    3           P$=ADDR(P$->B$$PTR->KQ$RBLK.EOFTIMELNK$);
      374     7206    3           END;
      375     7207    2   END DQEOFTIME;
      376     7208    1   END KQQ$DEQUEUE;

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:14   
--  Include file information  --

   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KQQ$DEQUEUE.

   Procedure KQQ$DEQUEUE requires 458 words for executable code.
   Procedure KQQ$DEQUEUE requires 16 words of local(AUTO) storage.

    No errors detected in file KQQ$QUEUE.:E05TSI    .

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:15   

 Object Unit name= KQQ$DEQUEUE                                File name= KQQ$QUEUE.:E05TOU
 UTS= JUL 30 '97 01:34:49.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   458    712  KQQ$DEQUEUE
    1  RoData even  none     9     11  KQQ$DEQUEUE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  KQQ$DEQUEUE
     0     10          yes     yes      Std        2  KQQ$DQEOFTIME
     0     20          yes     yes      Std        1  KQQ$RECOVER
     0    137          yes     yes      Std        1  KQQ$RECOVER2
     0    213          yes     yes      Std        2  KQQ$ACT
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:16   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       1 KQR$GETRBLK
 yes     yes           Std       1 KQL$QXFDUN
 yes     yes           Std       2 KQL$QDELAYM
 yes     yes           Std       2 KQL$RCVRDLY
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 KQW$XMITQR
 yes     yes           Std       2 KQM$RELRBLK
 yes     yes           Std       1 KQR$GETQUEUE
 yes     yes           Std       2 KQL$QDFIND
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_CGCANZ                             KQ_IRBLK                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:17   


        1        1        /*M* KQQ$QUEUE QUEUE-specific routines for COMGROUP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KQQ$QUEUE
       10       10             PURPOSE:      To provide routines specific to the comgroup QUEUE
       11       11             DESCRIPTION:  Contains various routines
       12       12        */
       13       13        /**/
       14       14        KQQ$DEQUEUE: PROC (KQ$CG,PARM$) ALTRET;

     14  0 000000   000000 700200 xent  KQQ$DEQUEUE  TSX0  ! X66_AUTO_2
         0 000001   000020 000002                    ZERO    16,2

       15       15        /**/
       16       16
       17       17
       18       18
       19       19        /**/
       20       20        /* INCLUDES */
       21       21        /**/
       22       22        %INCLUDE KQ_SUBS_C;
       23      322        %INCLUDE KQ_MAC_C;
       24     2872        %INCLUDE HF_LOCK_C;
       25     2886        %INCLUDE KQ_DATA_R;
       26     3718        %INCLUDE NK$LDCT;
       27     3820        %INCLUDE NK_SUBS;
       28     3845        %INCLUDE CP_6_SUBS;
       29     4385        %INCLUDE KC$CP6V_C;
       30     4505        %INCLUDE KC_CP6;
       31     5065
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:18   
       32     5066
       33     5067
       34     5068        /**/
       35     5069        /* PARAMETERS */
       36     5070        /**/
       37     5071        %KQ_CG   (FPTN=KQ$CG,STCLASS="");
       38     5810    1   DCL PARM$ PTR;
       39     5811
       40     5812
       41     5813
       42     5814        /**/
       43     5815        /* BASED STRUCTURES */
       44     5816        /**/
       45     5817    1   DCL B$$PTR PTR BASED ALIGNED;
       46     5818        %KQ_STA  (FPTN=KQ$STA ,STCLASS="BASED(STA$)");
       47     6157        %KQ_RBLK (FPTN=KQ$RBLK,STCLASS="BASED(RBLK$)");
       48     6343        %KQ_THDR (FPTN=KQ$THDR,STCLASS=BASED);
       49     6381        %KQ_QTN  (FPTN=KQ$QTN ,STCLASS="BASED(QTN$)");
       50     6854    1   DCL B$$KEY1 CHAR(KEY1L) BASED ALIGNED;
       51     6855
       52     6856
       53     6857
       54     6858        /**/
       55     6859        /* AUTO */
       56     6860        /**/
       57     6861    1   DCL STA$ PTR;
       58     6862    1   DCL RBLK$ PTR;
       59     6863    1   DCL MBLK$ PTR;
       60     6864    1   DCL P$ PTR;
       61     6865    1   DCL I UBIN;
       62     6866    1   DCL KEY1L REDEF I UBIN;
       63     6867    1   DCL QTN$ PTR;
       64     6868    1   DCL PP$ PTR;
       65     6869
       66     6870
       67     6871
       68     6872        /**/
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:19   
       69     6873        /* REFS */
       70     6874        /**/
       71     6875    1   DCL KQL$QDELAYM   ENTRY(2) ALTRET;
       72     6876    1   DCL KQL$QDFIND    ENTRY(2) ALTRET;
       73     6877    1   DCL KQL$QXFDUN    ENTRY(1) ALTRET;
       74     6878    1   DCL KQL$RCVRDLY   ENTRY(2) ALTRET;
       75     6879    1   DCL KQM$RELRBLK   ENTRY(2) ALTRET;
       76     6880    1   DCL KQR$GETQUEUE  ENTRY(1) ALTRET;
       77     6881    1   DCL KQR$GETRBLK   ENTRY(1) ALTRET;
       78     6882    1   DCL KQW$XMITQR    ENTRY(1) ALTRET;
       79     6883    1   DCL SC_CGCANZ     ENTRY    CONV(2,0);
       80     6884
       81     6885
       82     6886
       83     6887        /**/
       84     6888        /* SUBS */
       85     6889        /**/
       86     6890        %SUB KQ$QTREE="KQ$CG.QUEUE.QTREE$->KQ$THDR";
       87     6891        %SUB KQ$TTREE="KQ$CG.TTREE";
       88     6892        %SUB KQ$STREE="KQ$CG.STREE";
       89     6893        %SUB KQ$QUEUE="KQ$CG.QUEUE";
       90     6894        %EJECT;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:20   
       91     6895        /**/
       92     6896        /*F* NAME:         KQQ$DEQUEUE
       93     6897             PURPOSE:      To remove a read from the queue.
       94     6898             DESCRIPTION:  RBLK$ is passed as PARM$.
       95     6899                           Calls DEQUEUE and returns.
       96     6900
       97     6901         KQQ$DEQUEUE: ENTRY (KQ$CG,PARM$) ALTRET;    !!Doesn't ALTRET!! */
       98     6902        /**/
       99     6903    1         RBLK$=PARM$;

   6903  0 000002   200004 470500                    LDP0    @PARM$,,AUTO
         0 000003   000000 236100                    LDQ     0,,PR0
         0 000004   200006 756100                    STQ     RBLK$,,AUTO

      100     6904    1         CALL DEQUEUE;

   6904  0 000005   000542 701000 0                  TSX1    DEQUEUE
         0 000006   000000 011000                    NOP     0

   6903  0 000007                       RTN          null
      101     6905    1   RTN:  ;
      102     6906    1         RETURN;

   6906  0 000007   000000 702200 xent               TSX2  ! X66_ARET

      103     6907        /**/
      104     6908        /*F* NAME:        KQQ$DQEOFTIME
      105     6909             PURPOSE:     To remove a read from the EOFTIME list
      106     6910             DESCRIPTION: RBLK$ is passed as PARM$.
      107     6911                          Calls DQEOFTIME and returns.
      108     6912        */
      109     6913    1   KQQ$DQEOFTIME: ENTRY (KQ$CG,PARM$) ALTRET; /* !!Doesn't ALTRET!! */

   6913  0 000010   000000 700200 xent  KQQ$DQEOFTI* TSX0  ! X66_AUTO_2
         0 000011   000020 000002                    ZERO    16,2

      110     6914        /**/
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:21   
      111     6915    1         RBLK$=PARM$;

   6915  0 000012   200004 470500                    LDP0    @PARM$,,AUTO
         0 000013   000000 236100                    LDQ     0,,PR0
         0 000014   200006 756100                    STQ     RBLK$,,AUTO

      112     6916    1         CALL DQEOFTIME;

   6916  0 000015   000633 701000 0                  TSX1    DQEOFTIME
         0 000016   000000 011000                    NOP     0

      113     6917    1         RETURN;

   6917  0 000017   000000 702200 xent               TSX2  ! X66_ARET

      114     6918        /**/
      115     6919        /*F* NAME:         KQQ$RECOVER
      116     6920             PURPOSE:      To clean up the anonymous QUEUE when a crashed
      117     6921                           comgroup is being reopened.
      118     6922             INPUT:        KQT$RECOVER has been called
      119     6923                           clock is disabled
      120     6924             DESCRIPTION:  - zaps LOCKCNT in each queue node
      121     6925                           - zaps the queue read flags
      122     6926                           - zaps the '*GORGO' station's Q-node listhead
      123     6927                           - zaps the QUEUE read lists
      124     6928                           - fixes up the DELAY$ list
      125     6929        */
      126     6930    1   KQQ$RECOVER: ENTRY (KQ$CG) ALTRET; /* !!Doesn't ALTRET!! */

   6930  0 000020   000000 700200 xent  KQQ$RECOVER  TSX0  ! X66_AUTO_2
         0 000021   000020 000002                    ZERO    16,2

      127     6931        /**/
      128     6932    1         QTN$=KQ$CG.QUEUE.PLHD$;

   6932  0 000022   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000023   000061 236100                    LDQ     49,,PR0
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:22   
         0 000024   200012 756100                    STQ     QTN$,,AUTO

      129     6933    2           DO WHILE (QTN$ ~= ADDR(NIL));

   6933  0 000025   000033 710000 0                  TRA     s:6936

      130     6934    2           QTN$->KQ$QTN.LOCKCNT=0;

   6934  0 000026   200012 470500                    LDP0    QTN$,,AUTO
         0 000027   000000 236000 1                  LDQ     0
         0 000030   000050 356100                    ANSQ    40,,PR0

      131     6935    2           QTN$=QTN$->KQ$QTN.PLINK$;

   6935  0 000031   000047 236100                    LDQ     39,,PR0
         0 000032   200012 756100                    STQ     QTN$,,AUTO

      132     6936    2           END;

   6936  0 000033   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000034   000026 601000 0                  TNZ     s:6934

      133     6937        /**/
      134     6938    2         IF KQ$CG.GORGOSTA$~=ADDR(NIL) THEN DO;

   6938  0 000035   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000036   000207 236100                    LDQ     135,,PR0
         0 000037   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000040   000047 600000 0                  TZE     s:6942

      135     6939    2           KQ$CG.GORGOSTA$->KQ$STA.ACTHD$=ADDR(NIL);

   6939  0 000041   000207 471500                    LDP1    135,,PR0
         0 000042   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000043   100014 756100                    STQ     12,,PR1

      136     6940    2           KQ$CG.GORGOSTA$->KQ$STA.AIP='0'B;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:23   

   6940  0 000044   000207 471500                    LDP1    135,,PR0
         0 000045   000001 236000 1                  LDQ     1
         0 000046   100020 356100                    ANSQ    16,,PR1

      137     6941    2           END;

      138     6942    1         KQ$QUEUE.GACT='0'B;

   6942  0 000047   000002 236000 1                  LDQ     2
         0 000050   000063 356100                    ANSQ    51,,PR0

      139     6943    1         KQ$QUEUE.RQMEM='0'B;

   6943  0 000051   000003 236000 1                  LDQ     3
         0 000052   000063 356100                    ANSQ    51,,PR0

      140     6944    1         KQ$QUEUE.RQGC='0'B;

   6944  0 000053   000004 236000 1                  LDQ     4
         0 000054   000063 356100                    ANSQ    51,,PR0

      141     6945    1         KQ$QUEUE.BUSY='0'B;

   6945  0 000055   000005 236000 1                  LDQ     5
         0 000056   000063 356100                    ANSQ    51,,PR0

      142     6946    1         KQ$QUEUE.RUSR#=0;

   6946  0 000057   000000 236003                    LDQ     0,DU
         0 000060   000063 552140                    STBQ    51,'40'O,PR0

      143     6947    1         KQ$QUEUE.WCRL$=ADDR(NIL);

   6947  0 000061   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000062   000060 756100                    STQ     48,,PR0

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:24   
      144     6948    1         QTN$=KQ$QTREE.HEAD$;

   6948  0 000063   000057 471500                    LDP1    47,,PR0
         0 000064   100004 236100                    LDQ     4,,PR1
         0 000065   200012 756100                    STQ     QTN$,,AUTO

      145     6949    2           DO WHILE (QTN$ ~= ADDR(NIL));

   6949  0 000066   000074 710000 0                  TRA     s:6952

      146     6950    2           QTN$->KQ$QTN.READS$=ADDR(NIL);

   6950  0 000067   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000070   200012 470500                    LDP0    QTN$,,AUTO
         0 000071   000046 756100                    STQ     38,,PR0

      147     6951    2           QTN$=QTN$->KQ$QTN.STA.BTN.FLINK$;

   6951  0 000072   000004 236100                    LDQ     4,,PR0
         0 000073   200012 756100                    STQ     QTN$,,AUTO

      148     6952    2           END;

   6952  0 000074   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000075   000067 601000 0                  TNZ     s:6950

      149     6953        /**/ /* Flush DELAY$ list */
      150     6954    1         CALL KQL$RCVRDLY (KQ$QUEUE.DELAY$,KQ$QUEUE.DELAYDQ$);

   6954  0 000076   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000077   000064 036003                    ADLQ    52,DU
         0 000100   200017 756100                    STQ     PP$+4,,AUTO
         0 000101   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000102   000062 036003                    ADLQ    50,DU
         0 000103   200016 756100                    STQ     PP$+3,,AUTO
         0 000104   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000105   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:25   
         0 000106   000000 701000 xent               TSX1    KQL$RCVRDLY
         0 000107   000000 011000                    NOP     0

      151     6955              %LOCK (G=KQ$QTREE.GATE);

   6956  0 000110   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000111   000057 471500                    LDP1    47,,PR0
         0 000112   200016 451500                    STP1    PP$+3,,AUTO
         0 000113   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000114   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000115   000000 701000 xent               TSX1    HFC$LOCK
         0 000116   000000 011000                    NOP     0

      152     6958    1         P$=ADDR(KQ$CG);

   6958  0 000117   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000120   200010 756100                    STQ     P$,,AUTO

      153     6959    1         CALL KQW$XMITQR (P$);

   6959  0 000121   200010 630500                    EPPR0   P$,,AUTO
         0 000122   200016 450500                    STP0    PP$+3,,AUTO
         0 000123   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000124   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000125   000000 701000 xent               TSX1    KQW$XMITQR
         0 000126   000000 011000                    NOP     0

      154     6960              %UNLOCK (G=KQ$QTREE.GATE);

   6961  0 000127   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000130   000057 471500                    LDP1    47,,PR0
         0 000131   200016 451500                    STP1    PP$+3,,AUTO
         0 000132   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000133   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000134   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000135   000000 011000                    NOP     0

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:26   
      155     6963        /**/
      156     6964    1         RETURN;

   6964  0 000136   000000 702200 xent               TSX2  ! X66_ARET

      157     6965        /**/
      158     6966        /*F* NAME:         KQQ$RECOVER2
      159     6967             PURPOSE:      To clean up the anonymous QUEUE when a crashed
      160     6968                           comgroup is being reopened.
      161     6969             INPUT:        KQR$RECOVER/KQP$RECOVER has been called for
      162     6970                           each station
      163     6971             DESCRIPTION:  Does the following:
      164     6972
      165     6973                           - ensures CNACT=0 in each Q-tree node; SNAPs if
      166     6974                             not
      167     6975        */
      168     6976    1   KQQ$RECOVER2: ENTRY (KQ$CG) ALTRET; /* !!Doesn't ALTRET!! */

   6976  0 000137   000000 700200 xent  KQQ$RECOVER2 TSX0  ! X66_AUTO_2
         0 000140   000020 000002                    ZERO    16,2

      169     6977        /**/
      170     6978    1         I=0;

   6978  0 000141   200011 450100                    STZ     I,,AUTO

      171     6979    1         QTN$=KQ$CG.QUEUE.PLHD$;

   6979  0 000142   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000143   000061 236100                    LDQ     49,,PR0
         0 000144   200012 756100                    STQ     QTN$,,AUTO

      172     6980    2           DO WHILE (QTN$ ~= ADDR(NIL));

   6980  0 000145   000170 710000 0                  TRA     s:6992

      173     6981    2           IF QTN$->KQ$QTN.CNACT-QTN$->KQ$QTN.CRASHACT ~= 0 THEN
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:27   

   6981  0 000146   200012 470500                    LDP0    QTN$,,AUTO
         0 000147   000050 236100                    LDQ     40,,PR0
         0 000150   777777 376007                    ANQ     -1,DL
         0 000151   200016 756100                    STQ     PP$+3,,AUTO
         0 000152   000044 236100                    LDQ     36,,PR0
         0 000153   200016 136100                    SBLQ    PP$+3,,AUTO
         0 000154   000163 600000 0                  TZE     s:6988

      174     6982    3             DO;

      175     6983    3             I=I+1;

   6983  0 000155   200011 235100                    LDA     I,,AUTO
         0 000156   000001 035007                    ADLA    1,DL
         0 000157   200011 755100                    STA     I,,AUTO

      176     6984    3             P$=QTN$;

   6984  0 000160   200012 236100                    LDQ     QTN$,,AUTO
         0 000161   200010 756100                    STQ     P$,,AUTO

      177     6985    3             END;

   6985  0 000162   000166 710000 0                  TRA     s:6991

      178     6986    2           ELSE
      179     6987    3             DO;

      180     6988    3             QTN$->KQ$QTN.CNACT=0;

   6988  0 000163   000044 450100                    STZ     36,,PR0

      181     6989    3             QTN$->KQ$QTN.CRASHACT=0;

   6989  0 000164   000000 220003                    LDX0    0,DU
         0 000165   000050 440100                    SXL0    40,,PR0
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:28   

      182     6990    3             END;

      183     6991    2           QTN$=QTN$->KQ$QTN.PLINK$;

   6991  0 000166   000047 236100                    LDQ     39,,PR0
         0 000167   200012 756100                    STQ     QTN$,,AUTO

      184     6992    2           END;

   6992  0 000170   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000171   000146 601000 0                  TNZ     s:6981

      185     6993    1         IF I ~= 0 THEN

   6993  0 000172   200011 235100                    LDA     I,,AUTO
         0 000173   000212 600000 0                  TZE     s:7014

      186     6994    2           DO;

      187     6995    2           CALL SC_CGCANZ;

   6995  0 000174   000000 713400 xsym               CLIMB   SC_CGCANZ
         0 000175   000000 600000 xsid               climb   nvectors=         0

      188     6996        /*S* SCREECH_CODE: KQQ-S$CGCANZ
      189     6997             TYPE:         SNAP
      190     6998             MESSAGE:      The comgroup queue has active messages after recovery
      191     6999             REMARKS:      This SNAP occurs when a comgroup is being opened
      192     7000                           after having been closed by RECOVER.  It is caused
      193     7001                           by CNACT in some Q-tree node being > 0 after all
      194     7002                           cleanup has been performed.
      195     7003                           This implies something was lost during the crash.
      196     7004                           CNACT is zeroed in all the nodes and the open
      197     7005                           continues. */
      198     7006    2           QTN$=KQ$CG.QUEUE.PLHD$;

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:29   
   7006  0 000176   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000177   000061 236100                    LDQ     49,,PR0
         0 000200   200012 756100                    STQ     QTN$,,AUTO

      199     7007    3             DO WHILE (QTN$ ~= ADDR(NIL));

   7007  0 000201   000210 710000 0                  TRA     s:7011

      200     7008    3             QTN$->KQ$QTN.CNACT=0;

   7008  0 000202   200012 470500                    LDP0    QTN$,,AUTO
         0 000203   000044 450100                    STZ     36,,PR0

      201     7009    3             QTN$->KQ$QTN.CRASHACT=0;

   7009  0 000204   000000 220003                    LDX0    0,DU
         0 000205   000050 440100                    SXL0    40,,PR0

      202     7010    3             QTN$=QTN$->KQ$QTN.PLINK$;

   7010  0 000206   000047 236100                    LDQ     39,,PR0
         0 000207   200012 756100                    STQ     QTN$,,AUTO

      203     7011    3             END;

   7011  0 000210   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000211   000202 601000 0                  TNZ     s:7008

      204     7012    2           END;

      205     7013        /**/
      206     7014    1         RETURN;

   7014  0 000212   000000 702200 xent               TSX2  ! X66_ARET

      207     7015        %EJECT;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:30   
      208     7016        /**/
      209     7017        /*F* NAME:         KQQ$ACT
      210     7018             PURPOSE:      To satisfy reads from a particular Q-tree node
      211     7019             DESCRIPTION:  When an UNLATCH of a message read from a Q-tree
      212     7020                           node causes CNACT to become 1 less than MXACT,
      213     7021                           we must try to give away the messages waiting
      214     7022                           in that node because it is now OK to do so and
      215     7023                           there may be reads waiting for them.  Called
      216     7024                           with the queue locked.  PARM$ points to the node.
      217     7025
      218     7026                           Also called when MXACT is increased by the AU.
      219     7027
      220     7028                           Guarantees to satisfy all possible reads.
      221     7029
      222     7030                           Always unlocks the queue before returning.
      223     7031        */
      224     7032    1   KQQ$ACT: ENTRY (KQ$CG,PARM$) ALTRET;

   7032  0 000213   000000 700200 xent  KQQ$ACT      TSX0  ! X66_AUTO_2
         0 000214   000020 000002                    ZERO    16,2

      225     7033        /**/
      226     7034    1         QTN$=PARM$;

   7034  0 000215   200004 470500                    LDP0    @PARM$,,AUTO
         0 000216   000000 236100                    LDQ     0,,PR0
         0 000217   200012 756100                    STQ     QTN$,,AUTO

      227     7035    1         IF KQ$CG.RCVR

   7035  0 000220   200003 471500                    LDP1    @KQ$CG,,AUTO
         0 000221   100105 236100                    LDQ     69,,PR1
         0 000222   000010 316007                    CANQ    8,DL
         0 000223   000367 601000 0                  TNZ     ACT10
         0 000224   200012 473500                    LDP3    QTN$,,AUTO
         0 000225   300050 236100                    LDQ     40,,PR3
         0 000226   200000 316003                    CANQ    65536,DU
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:31   
         0 000227   000367 601000 0                  TNZ     ACT10
         0 000230   300062 235100                    LDA     50,,PR3
         0 000231   000367 600000 0                  TZE     ACT10

      228     7036    1         OR QTN$->KQ$QTN.ACTWAIT
      229     7037    1         OR QTN$->KQ$QTN.MLH.COUNT = 0 THEN GOTO ACT10;
      230     7038    1         IF QTN$->KQ$QTN.READS$ = ADDR(NIL) THEN

   7038  0 000232   300046 236100                    LDQ     38,,PR3
         0 000233   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000234   000261 601000 0                  TNZ     ACT0

      231     7039    2           DO;

      232     7040    2           RBLK$=KQ$CG.QUEUE.WCRL$;

   7040  0 000235   100060 236100                    LDQ     48,,PR1
         0 000236   200006 756100                    STQ     RBLK$,,AUTO

      233     7041    3             DO WHILE (RBLK$ ~= ADDR(NIL));

   7041  0 000237   000256 710000 0                  TRA     s:7046

      234     7042    3             KEY1L=RBLK$->KQ$RBLK.KEY1L;

   7042  0 000240   200006 470500                    LDP0    RBLK$,,AUTO
         0 000241   000001 236100                    LDQ     1,,PR0
         0 000242   000004 772000                    QRL     4
         0 000243   000017 376007                    ANQ     15,DL
         0 000244   200011 756100                    STQ     I,,AUTO

      235     7043    3             IF ADDR(RBLK$->KQ$RBLK.KEY1)->B$$KEY1 = ADDR(QTN$->KQ$QTN.STA.BTN.KEY)->
              7043                      B$$KEY1 THEN

   7043  0 000245   000000 620006                    EAX0    0,QL
         0 000246   200012 471500                    LDP1    QTN$,,AUTO
         0 000247   200011 721100                    LXL1    I,,AUTO
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:32   
         0 000250   040140 106540                    CMPC    fill='040'O
         0 000251   000002 000010                    ADSC9   2,,PR0                   cn=0,n=*X0
         0 000252   100005 000011                    ADSC9   5,,PR1                   cn=0,n=*X1
         0 000253   000261 600000 0                  TZE     ACT0

      236     7044    3              GOTO ACT0;
      237     7045    3             RBLK$=RBLK$->KQ$RBLK.QRLNK$;

   7045  0 000254   000020 236100                    LDQ     16,,PR0
         0 000255   200006 756100                    STQ     RBLK$,,AUTO

      238     7046    3             END;

   7046  0 000256   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000257   000240 601000 0                  TNZ     s:7042

      239     7047    2           GOTO ACT10;

   7047  0 000260   000367 710000 0                  TRA     ACT10

   7043  0 000261                       ACT0         null
      240     7048    2           END;
      241     7049    1   ACT0: ;
      242     7050        /**/
      243     7051    1         QTN$->KQ$QTN.ACTWAIT='1'B;

   7051  0 000261   200012 470500                    LDP0    QTN$,,AUTO
         0 000262   200000 236003                    LDQ     65536,DU
         0 000263   000050 256100                    ORSQ    40,,PR0

      244     7052    1         QTN$->KQ$QTN.LOCKCNT=QTN$->KQ$QTN.LOCKCNT+1;

   7052  0 000264   000050 236100                    LDQ     40,,PR0
         0 000265   000033 772000                    QRL     27
         0 000266   000177 376007                    ANQ     127,DL
         0 000267   000001 036007                    ADLQ    1,DL
         0 000270   000033 736000                    QLS     27
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:33   
         0 000271   000050 676100                    ERQ     40,,PR0
         0 000272   177000 376003                    ANQ     65024,DU
         0 000273   000050 656100                    ERSQ    40,,PR0

      245     7053    1         STA$=KQ$CG.GORGOSTA$;

   7053  0 000274   200003 471500                    LDP1    @KQ$CG,,AUTO
         0 000275   100207 236100                    LDQ     135,,PR1
         0 000276   200005 756100                    STQ     STA$,,AUTO

      246     7054              %LOCK (G=STA$->KQ$STA.GATE);

   7055  0 000277   000016 036003                    ADLQ    14,DU
         0 000300   200016 756100                    STQ     PP$+3,,AUTO
         0 000301   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000302   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000303   000000 701000 xent               TSX1    HFC$LOCK
         0 000304   000000 011000                    NOP     0

      247     7057    1         QTN$->KQ$QTN.ACTLNK$=STA$->KQ$STA.ACTHD$;

   7057  0 000305   200005 470500                    LDP0    STA$,,AUTO
         0 000306   000014 236100                    LDQ     12,,PR0
         0 000307   200012 471500                    LDP1    QTN$,,AUTO
         0 000310   100054 756100                    STQ     44,,PR1

      248     7058    1         STA$->KQ$STA.ACTHD$=QTN$;

   7058  0 000311   200012 236100                    LDQ     QTN$,,AUTO
         0 000312   000014 756100                    STQ     12,,PR0

      249     7059    1         IF STA$->KQ$STA.AIP THEN GOTO ACT6;

   7059  0 000313   000020 236100                    LDQ     16,,PR0
         0 000314   002000 316003                    CANQ    1024,DU
         0 000315   000360 601000 0                  TNZ     ACT6

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:34   
      250     7060    1         STA$->KQ$STA.AIP='1'B;

   7060  0 000316   002000 236003                    LDQ     1024,DU
         0 000317   000020 256100                    ORSQ    16,,PR0

      251     7061              %UNLOCK (G=STA$->KQ$STA.GATE);

   7062  0 000320   200005 236100                    LDQ     STA$,,AUTO
         0 000321   000016 036003                    ADLQ    14,DU
         0 000322   200016 756100                    STQ     PP$+3,,AUTO
         0 000323   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000325   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000326   000000 011000                    NOP     0

   7060  0 000327                       ACT1         null
      252     7064    1   ACT1: ;
      253     7065    1         QTN$=STA$->KQ$STA.ACTHD$;

   7065  0 000327   200005 470500                    LDP0    STA$,,AUTO
         0 000330   000014 236100                    LDQ     12,,PR0
         0 000331   200012 756100                    STQ     QTN$,,AUTO

      254     7066    1         IF QTN$ = ADDR(NIL) THEN

   7066  0 000332   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000333   000377 601000 0                  TNZ     s:7085

      255     7067    2           DO;

      256     7068    2           STA$->KQ$STA.RBLK$=ADDR(NIL);

   7068  0 000334   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000335   000011 756100                    STQ     9,,PR0

      257     7069    2           CALL KQM$RELRBLK (KQ$CG,RBLK$);

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:35   
   7069  0 000336   200006 631500                    EPPR1   RBLK$,,AUTO
         0 000337   200017 451500                    STP1    PP$+4,,AUTO
         0 000340   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000341   200016 756100                    STQ     PP$+3,,AUTO
         0 000342   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000343   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000344   000000 701000 xent               TSX1    KQM$RELRBLK
         0 000345   000000 011000                    NOP     0

   7068  0 000346                       ACT2         null
      258     7070    2   ACT2:   ;
      259     7071                %LOCK (G=STA$->KQ$STA.GATE);

   7072  0 000346   200005 236100                    LDQ     STA$,,AUTO
         0 000347   000016 036003                    ADLQ    14,DU
         0 000350   200016 756100                    STQ     PP$+3,,AUTO
         0 000351   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000352   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000353   000000 701000 xent               TSX1    HFC$LOCK
         0 000354   000000 011000                    NOP     0

      260     7074    2           STA$->KQ$STA.AIP='0'B;

   7074  0 000355   200005 470500                    LDP0    STA$,,AUTO
         0 000356   000001 236000 1                  LDQ     1
         0 000357   000020 356100                    ANSQ    16,,PR0

   7074  0 000360                       ACT6         null
      261     7075    2   ACT6:   ;
      262     7076                %UNLOCK (G=STA$->KQ$STA.GATE);

   7077  0 000360   200005 236100                    LDQ     STA$,,AUTO
         0 000361   000016 036003                    ADLQ    14,DU
         0 000362   200016 756100                    STQ     PP$+3,,AUTO
         0 000363   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000364   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000365   000000 701000 xent               TSX1    HFC$UNLOCK
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:36   
         0 000366   000000 011000                    NOP     0

   7074  0 000367                       ACT10        null
      263     7079    2   ACT10:  ;
      264     7080                %UNLOCK (G=KQ$QTREE.GATE);

   7081  0 000367   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000370   000057 471500                    LDP1    47,,PR0
         0 000371   200016 451500                    STP1    PP$+3,,AUTO
         0 000372   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000373   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000374   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000375   000000 011000                    NOP     0

      265     7083    2           RETURN;

   7083  0 000376   000000 702200 xent               TSX2  ! X66_ARET

      266     7084    2           END;
      267     7085    1         STA$->KQ$STA.ACTHD$=QTN$->KQ$QTN.ACTLNK$;

   7085  0 000377   200012 471500                    LDP1    QTN$,,AUTO
         0 000400   100054 236100                    LDQ     44,,PR1
         0 000401   000014 756100                    STQ     12,,PR0

      268     7086              %UNLOCK (G=KQ$QTREE.GATE);

   7087  0 000402   200003 473500                    LDP3    @KQ$CG,,AUTO
         0 000403   300057 474500                    LDP4    47,,PR3
         0 000404   200016 454500                    STP4    PP$+3,,AUTO
         0 000405   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000406   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000407   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000410   000000 011000                    NOP     0

      269     7089    1         CALL KQR$GETRBLK (STA$->KQ$STA) ALTRET(ACT60);

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:37   
   7089  0 000411   200005 630500                    EPPR0   STA$,,AUTO
         0 000412   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000413   000000 701000 xent               TSX1    KQR$GETRBLK
         0 000414   000517 702000 0                  TSX2    ACT60

      270     7090    1         RBLK$=STA$->KQ$STA.RBLK$;

   7090  0 000415   200005 470500                    LDP0    STA$,,AUTO
         0 000416   000011 236100                    LDQ     9,,PR0
         0 000417   200006 756100                    STQ     RBLK$,,AUTO

      271     7091    1         RBLK$->KQ$RBLK.LATCH='1'B;

   7091  0 000420   200006 471500                    LDP1    RBLK$,,AUTO
         0 000421   400000 236007                    LDQ     -131072,DL
         0 000422   100001 256100                    ORSQ    1,,PR1

      272     7092    1         RBLK$->KQ$RBLK.KEY1L=0;

   7092  0 000423   200006 471500                    LDP1    RBLK$,,AUTO
         0 000424   000006 236000 1                  LDQ     6
         0 000425   100001 356100                    ANSQ    1,,PR1

      273     7093    1         RBLK$->KQ$RBLK.KEY2L=0;

   7093  0 000426   200006 471500                    LDP1    RBLK$,,AUTO
         0 000427   000007 236000 1                  LDQ     7
         0 000430   100001 356100                    ANSQ    1,,PR1

      274     7094    1         CALL KQR$GETQUEUE (STA$->KQ$STA);

   7094  0 000431   200005 630500                    EPPR0   STA$,,AUTO
         0 000432   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000433   000000 701000 xent               TSX1    KQR$GETQUEUE
         0 000434   000000 011000                    NOP     0

   7093  0 000435                       ACT20        null
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:38   
      275     7095    1   ACT20:;
      276     7096    1         IF QTN$->KQ$QTN.MXACT > QTN$->KQ$QTN.CNACT THEN

   7096  0 000435   200012 470500                    LDP0    QTN$,,AUTO
         0 000436   000045 236100                    LDQ     37,,PR0
         0 000437   000044 116100                    CMPQ    36,,PR0
         0 000440   000457 604400 0                  TMOZ    s:7102

      277     7097    2           DO;

      278     7098    2           RBLK$->KQ$RBLK=KQ_IRBLK;

   7098  0 000441   200006 471500                    LDP1    RBLK$,,AUTO
         0 000442   000100 100400                    MLR     fill='000'O
         0 000443   000000 000110 xsym               ADSC9   KQ_IRBLK                 cn=0,n=72
         0 000444   100000 000110                    ADSC9   0,,PR1                   cn=0,n=72

      279     7099    2           MBLK$=QTN$;

   7099  0 000445   200012 236100                    LDQ     QTN$,,AUTO
         0 000446   200007 756100                    STQ     MBLK$,,AUTO

      280     7100    2           CALL KQL$QDFIND (STA$->KQ$STA,MBLK$) ALTRET(ACT40);

   7100  0 000447   200007 631500                    EPPR1   MBLK$,,AUTO
         0 000450   200017 451500                    STP1    PP$+4,,AUTO
         0 000451   200005 236100                    LDQ     STA$,,AUTO
         0 000452   200016 756100                    STQ     PP$+3,,AUTO
         0 000453   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000454   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000455   000000 701000 xent               TSX1    KQL$QDFIND
         0 000456   000506 702000 0                  TSX2    ACT40

      281     7101    2           END;

      282     7102    1         QTN$->KQ$QTN.LOCKCNT=QTN$->KQ$QTN.LOCKCNT-1;

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:39   
   7102  0 000457   200012 470500                    LDP0    QTN$,,AUTO
         0 000460   000050 236100                    LDQ     40,,PR0
         0 000461   000033 772000                    QRL     27
         0 000462   000177 376007                    ANQ     127,DL
         0 000463   000001 136007                    SBLQ    1,DL
         0 000464   000033 736000                    QLS     27
         0 000465   000050 676100                    ERQ     40,,PR0
         0 000466   177000 376003                    ANQ     65024,DU
         0 000467   000050 656100                    ERSQ    40,,PR0

      283     7103    1         QTN$->KQ$QTN.ACTWAIT='0'B;

   7103  0 000470   000010 236000 1                  LDQ     8
         0 000471   000050 356100                    ANSQ    40,,PR0

      284     7104    1         CALL KQL$QXFDUN (STA$->KQ$STA);

   7104  0 000472   200005 630500                    EPPR0   STA$,,AUTO
         0 000473   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000474   000000 701000 xent               TSX1    KQL$QXFDUN
         0 000475   000000 011000                    NOP     0

      285     7105              %LOCK (G=KQ$QTREE.GATE);

   7106  0 000476   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000477   000057 471500                    LDP1    47,,PR0
         0 000500   200016 451500                    STP1    PP$+3,,AUTO
         0 000501   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000503   000000 701000 xent               TSX1    HFC$LOCK
         0 000504   000000 011000                    NOP     0

      286     7108    1         GOTO ACT1;

   7108  0 000505   000327 710000 0                  TRA     ACT1

   7103  0 000506                       ACT40        null
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:40   
      287     7109    1   ACT40:;
      288     7110    1         CALL KQL$QDELAYM (KQ$CG,MBLK$);

   7110  0 000506   200007 630500                    EPPR0   MBLK$,,AUTO
         0 000507   200017 450500                    STP0    PP$+4,,AUTO
         0 000510   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000511   200016 756100                    STQ     PP$+3,,AUTO
         0 000512   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000514   000000 701000 xent               TSX1    KQL$QDELAYM
         0 000515   000000 011000                    NOP     0

      289     7111    1         GOTO ACT20;

   7111  0 000516   000435 710000 0                  TRA     ACT20

   7103  0 000517                       ACT60        null
      290     7112    1   ACT60:;
      291     7113              %LOCK (G=KQ$QTREE.GATE);

   7114  0 000517   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000520   000057 471500                    LDP1    47,,PR0
         0 000521   200016 451500                    STP1    PP$+3,,AUTO
         0 000522   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000523   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000524   000000 701000 xent               TSX1    HFC$LOCK
         0 000525   000000 011000                    NOP     0

      292     7116    1         QTN$->KQ$QTN.ACTWAIT='0'B;

   7116  0 000526   200012 470500                    LDP0    QTN$,,AUTO
         0 000527   000010 236000 1                  LDQ     8
         0 000530   000050 356100                    ANSQ    40,,PR0

      293     7117    1         QTN$->KQ$QTN.LOCKCNT=QTN$->KQ$QTN.LOCKCNT-1;

   7117  0 000531   000050 236100                    LDQ     40,,PR0
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:41   
         0 000532   000033 772000                    QRL     27
         0 000533   000177 376007                    ANQ     127,DL
         0 000534   000001 136007                    SBLQ    1,DL
         0 000535   000033 736000                    QLS     27
         0 000536   000050 676100                    ERQ     40,,PR0
         0 000537   177000 376003                    ANQ     65024,DU
         0 000540   000050 656100                    ERSQ    40,,PR0

      294     7118    1         GOTO ACT2;

   7118  0 000541   000346 710000 0                  TRA     ACT2

      295     7119        %EJECT;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:42   
      296     7120        /**/
      297     7121        /*********************************************************************************
      298     7122        *                                                                                *
      299     7123        *   SSS   U   U  BBBB   RRRR    OOO   U   U  TTTTT   III   N   N  EEEEE   SSS    *
      300     7124        *  S   S  U   U  B   B  R   R  O O O  U   U    T      I    N   N  E      S   S   *
      301     7125        *  S      U   U  B   B  R   R  O O O  U   U    T      I    NN  N  E      S       *
      302     7126        *   SSS   U   U  BBBB   RRRR   O  OO  U   U    T      I    N N N  EEEE    SSS    *
      303     7127        *      S  U   U  B   B  R R    O   O  U   U    T      I    N  NN  E          S   *
      304     7128        *  S   S  U   U  B   B  R  R   O   O  U   U    T      I    N   N  E      S   S   *
      305     7129        *   SSS    UUU   BBBB   R   R   OOO    UUU     T     III   N   N  EEEEE   SSS    *
      306     7130        *                                                                                *
      307     7131        *********************************************************************************/
      308     7132
      309     7133        /****************************************************************
      310     7134        *****************************************************************/
      311     7135        /*D* NAME:         DEQUEUE
      312     7136             PURPOSE:      To remove an RBLK from the QUEUE.
      313     7137             DESCRIPTION: RBLK$ is found on the appropriate queue (if there)
      314     7138                          and is removed. Note that it may not be there since
      315     7139                          KQ$RBLK.STA$ is also not ADDR(NIL) if EOFTIME was
      316     7140                          specified for this read.
      317     7141        */
      318     7142    1   DEQUEUE: PROC ALTRET;

   7142  0 000542   200014 741300       DEQUEUE      STX1  ! PP$+1,,AUTO

      319     7143    2         IF RBLK$->KQ$RBLK.STA$ ~= ADDR(NIL) THEN

   7143  0 000543   200006 470500                    LDP0    RBLK$,,AUTO
         0 000544   000012 236100                    LDQ     10,,PR0
         0 000545   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000546   000631 600000 0                  TZE     s:7171

      320     7144    3           DO;

      321     7145                %LOCK (G=KQ$QTREE.GATE);

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:43   
   7146  0 000547   200003 471500                    LDP1    @KQ$CG,,AUTO
         0 000550   100057 473500                    LDP3    47,,PR1
         0 000551   200016 453500                    STP3    PP$+3,,AUTO
         0 000552   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000553   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000554   000000 701000 xent               TSX1    HFC$LOCK
         0 000555   000000 011000                    NOP     0

      322     7148                                /* KQC$CTL can jerk it out from under us */
      323     7149    3           IF RBLK$->KQ$RBLK.STA$ ~= ADDR(NIL) THEN

   7149  0 000556   200006 470500                    LDP0    RBLK$,,AUTO
         0 000557   000012 236100                    LDQ     10,,PR0
         0 000560   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000561   000622 600000 0                  TZE     DUN

      324     7150    4             DO;

      325     7151    4             IF RBLK$->KQ$RBLK.QTN$ = ADDR(NIL) THEN

   7151  0 000562   000021 236100                    LDQ     17,,PR0
         0 000563   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000564   000571 601000 0                  TNZ     s:7153

      326     7152    4              P$=ADDR(KQ$CG.QUEUE.WCRL$);

   7152  0 000565   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000566   000060 036003                    ADLQ    48,DU
         0 000567   200010 756100                    STQ     P$,,AUTO
         0 000570   000574 710000 0                  TRA     s:7154

      327     7153    4             ELSE P$=ADDR(RBLK$->KQ$RBLK.QTN$->KQ$QTN.READS$);

   7153  0 000571   000021 471500                    LDP1    17,,PR0
         0 000572   100046 633500                    EPPR3   38,,PR1
         0 000573   200010 453500                    STP3    P$,,AUTO

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:44   
      328     7154    4             PP$=P$->B$$PTR;

   7154  0 000574   200010 471500                    LDP1    P$,,AUTO
         0 000575   100000 236100                    LDQ     0,,PR1
         0 000576   200013 756100                    STQ     PP$,,AUTO

      329     7155    5               DO WHILE(PP$~=ADDR(NIL));

   7155  0 000577   000620 710000 0                  TRA     s:7164

      330     7156    5               IF PP$ = RBLK$ THEN

   7156  0 000600   200013 236100                    LDQ     PP$,,AUTO
         0 000601   200006 116100                    CMPQ    RBLK$,,AUTO
         0 000602   000613 601000 0                  TNZ     s:7162

      331     7157    6                 DO;

      332     7158    6                 P$->B$$PTR=RBLK$->KQ$RBLK.QRLNK$;

   7158  0 000603   200006 470500                    LDP0    RBLK$,,AUTO
         0 000604   000020 236100                    LDQ     16,,PR0
         0 000605   200010 471500                    LDP1    P$,,AUTO
         0 000606   100000 756100                    STQ     0,,PR1

      333     7159    6                 RBLK$->KQ$RBLK.QRLNK$=ADDR(NIL);

   7159  0 000607   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000610   200006 470500                    LDP0    RBLK$,,AUTO
         0 000611   000020 756100                    STQ     16,,PR0

      334     7160    6                 GOTO DUN;

   7160  0 000612   000622 710000 0                  TRA     DUN

      335     7161    6                 END;
      336     7162    5               P$=ADDR(PP$->KQ$RBLK.QRLNK$);
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:45   

   7162  0 000613   000020 036003                    ADLQ    16,DU
         0 000614   200010 756100                    STQ     P$,,AUTO

      337     7163    5               PP$=P$->B$$PTR;

   7163  0 000615   200010 470500                    LDP0    P$,,AUTO
         0 000616   000000 236100                    LDQ     0,,PR0
         0 000617   200013 756100                    STQ     PP$,,AUTO

      338     7164    5               END;

   7164  0 000620   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000621   000600 601000 0                  TNZ     s:7156

      339     7165    4             END;

   7162  0 000622                       DUN          null
      340     7166    3   DUN:    ;
      341     7167                %UNLOCK (G=KQ$QTREE.GATE);

   7168  0 000622   200003 470500                    LDP0    @KQ$CG,,AUTO
         0 000623   000057 471500                    LDP1    47,,PR0
         0 000624   200016 451500                    STP1    PP$+3,,AUTO
         0 000625   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000626   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000627   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000630   000000 011000                    NOP     0

      342     7170    3           END;

      343     7171    2         RETURN;

   7171  0 000631   200014 221300                    LDX1  ! PP$+1,,AUTO
         0 000632   000001 702211                    TSX2  ! 1,X1

      344     7172    2   END DEQUEUE;
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:46   
      345     7173        /**/
      346     7174        /**/
      347     7175        /*D* NAME:        DQEOFTIME
      348     7176             PURPOSE:     To remove an RBLK from the KQ$CG.EOFTIMEHD$ list
      349     7177             DESCRIPTION: The passed RBLK is found on the KQ$CG.EOFTIMEHD$ list
      350     7178                          and is removed. If this causes KQ$CG.EOFTIMEHD$ to
      351     7179                          become ADDR(NIL) then KQ$CG.EOFTIME is set to 0.
      352     7180        */
      353     7181    1   DQEOFTIME: PROC;

   7181  0 000633   200014 741300       DQEOFTIME    STX1  ! PP$+1,,AUTO

      354     7182              %LOCK(G=KQ$STREE.GATE);

   7183  0 000634   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000635   000075 036003                    ADLQ    61,DU
         0 000636   200016 756100                    STQ     PP$+3,,AUTO
         0 000637   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000640   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000641   000000 701000 xent               TSX1    HFC$LOCK
         0 000642   000000 011000                    NOP     0

      355     7185    2         IF RBLK$->KQ$RBLK.EOFTIME=0 THEN GOTO XIT;

   7185  0 000643   200006 470500                    LDP0    RBLK$,,AUTO
         0 000644   000017 720100                    LXL0    15,,PR0
         0 000645   000675 600000 0                  TZE     XIT

      356     7186    2         P$=ADDR(KQ$CG.EOFTIMEHD$);

   7186  0 000646   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000647   000027 036003                    ADLQ    23,DU
         0 000650   200010 756100                    STQ     P$,,AUTO

      357     7187    3           DO FOREVER;

      358     7188    3           IF P$->B$$PTR=ADDR(NIL) THEN
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:47   

   7188  0 000651   200010 470500                    LDP0    P$,,AUTO
         0 000652   000000 236100                    LDQ     0,,PR0
         0 000653   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000654   000660 601000 0                  TNZ     s:7193

      359     7189    4             DO;

      360     7190    4             CALL SC_CGCANZ;

   7190  0 000655   000000 713400 xsym               CLIMB   SC_CGCANZ
         0 000656   000000 600000 xsid               climb   nvectors=         0

      361     7191    4             GOTO XIT;

   7191  0 000657   000675 710000 0                  TRA     XIT

      362     7192    4             END;
      363     7193    3           IF P$->B$$PTR=RBLK$ THEN

   7193  0 000660   200006 116100                    CMPQ    RBLK$,,AUTO
         0 000661   000706 601000 0                  TNZ     s:7205

      364     7194    4             DO;

      365     7195    4             P$->B$$PTR=RBLK$->KQ$RBLK.EOFTIMELNK$;

   7195  0 000662   200006 471500                    LDP1    RBLK$,,AUTO
         0 000663   100010 236100                    LDQ     8,,PR1
         0 000664   000000 756100                    STQ     0,,PR0

      366     7196    4             RBLK$->KQ$RBLK.EOFTIME=0;

   7196  0 000665   000000 220003                    LDX0    0,DU
         0 000666   200006 470500                    LDP0    RBLK$,,AUTO
         0 000667   000017 440100                    SXL0    15,,PR0

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:48   
      367     7197    4             IF KQ$CG.EOFTIMEHD$=ADDR(NIL) THEN

   7197  0 000670   200003 471500                    LDP1    @KQ$CG,,AUTO
         0 000671   100027 236100                    LDQ     23,,PR1
         0 000672   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000673   000675 601000 0                  TNZ     XIT

      368     7198    4              KQ$CG.EOFTIME=0;

   7198  0 000674   100030 740100                    STX0    24,,PR1

   7197  0 000675                       XIT          null
      369     7199    4   XIT:      ;
      370     7200                  %UNLOCK(G=KQ$STREE.GATE);

   7201  0 000675   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000676   000075 036003                    ADLQ    61,DU
         0 000677   200016 756100                    STQ     PP$+3,,AUTO
         0 000700   200016 630500                    EPPR0   PP$+3,,AUTO
         0 000701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000702   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000703   000000 011000                    NOP     0

      371     7203    4             RETURN;

   7203  0 000704   200014 221300                    LDX1  ! PP$+1,,AUTO
         0 000705   000001 702211                    TSX2  ! 1,X1

      372     7204    4             END;
      373     7205    3           P$=ADDR(P$->B$$PTR->KQ$RBLK.EOFTIMELNK$);

   7205  0 000706   000000 471500                    LDP1    0,,PR0
         0 000707   100010 633500                    EPPR3   8,,PR1
         0 000710   200010 453500                    STP3    P$,,AUTO

      374     7206    3           END;

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:49   
   7206  0 000711   000651 710000 0                  TRA     s:7188

(unnamed)
 Sect OctLoc
   1     000   600777 777777   775777 777777   777737 777777   777757 777777    ................
   1     004   777767 777777   777177 777777   777777 777417   777777 777760    ................
   1     010   577777 777777                                                    ....
      375     7207    2   END DQEOFTIME;
      376     7208    1   END KQQ$DEQUEUE;

PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:50   
--  Include file information  --

   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KQQ$DEQUEUE.
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:51   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @KQ$CG                     4-0-0/w PTR         r     1 @PARM$
    11-0-0/w UBIN        r     1 I                         11-0-0/w UBIN        r     1 KEY1L
    *0-0-0/d STRC(6516)  r     1 KQ$CG                      7-0-0/w PTR         r     1 MBLK$
    10-0-0/w PTR         r     1 P$                        *0-0-0/w PTR         r     1 PARM$
    13-0-0/w PTR         r     1 PP$                       12-0-0/w PTR         r     1 QTN$
     6-0-0/w PTR         r     1 RBLK$                      5-0-0/w PTR         r     1 STA$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(648)   r     1 KQ_IRBLK

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ACHR        r     1 B$$KEY1                    0-0-0/w PTR         r     1 B$$PTR
     0-0-0/d STRC(1908)  r     1 KQ$QTN                     0-0-0/d STRC(648)   r     1 KQ$RBLK
     0-0-0/d STRC(1296)  r     1 KQ$STA                     0-0-0/w STRC(216)   r     1 KQ$THDR


   Procedure KQQ$DEQUEUE requires 458 words for executable code.
   Procedure KQQ$DEQUEUE requires 16 words of local(AUTO) storage.

    No errors detected in file KQQ$QUEUE.:E05TSI    .
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:52   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:53   
          MINI XREF LISTING

ACT0
      7043**LABEL    7044--GOTO
ACT1
      7060**LABEL    7108--GOTO
ACT10
      7074**LABEL    7037--GOTO     7047--GOTO
ACT2
      7068**LABEL    7118--GOTO
ACT20
      7093**LABEL    7111--GOTO
ACT40
      7103**LABEL    7100--CALLALT
ACT6
      7074**LABEL    7059--GOTO
ACT60
      7103**LABEL    7089--CALLALT
B$$KEY1
      6854**DCL      7043>>IF       7043>>IF
B$$PTR
      5817**DCL      7154>>ASSIGN   7158<<ASSIGN   7163>>ASSIGN   7188>>IF       7193>>IF       7195<<ASSIGN
      7205>>ASSIGN
DEQUEUE
      7142**PROC     6904--CALL
DQEOFTIME
      7181**PROC     6916--CALL
DUN IN PROCEDURE DEQUEUE
      7162**LABEL    7160--GOTO
HFC$LOCK
      2885**DCL-ENT  6956--CALL     7055--CALL     7072--CALL     7106--CALL     7114--CALL     7146--CALL
      7183--CALL
HFC$UNLOCK
      2885**DCL-ENT  6961--CALL     7062--CALL     7077--CALL     7081--CALL     7087--CALL     7168--CALL
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:54   
      7201--CALL
I
      6865**DCL      6866--REDEF    6978<<ASSIGN   6983<<ASSIGN   6983>>ASSIGN   6993>>IF
KEY1L
      6866**DCL      6854--IMP-SIZ  7042<<ASSIGN   7043>>IF       7043>>IF
KQ$CG
      5086**DCL        14--PROC     6913--ENTRY    6930--ENTRY    6958--ASSIGN   6976--ENTRY    7032--ENTRY
      7069<>CALL     7110<>CALL
KQ$CG.AUCTL.DVBYTE.REREAD
      5529**DCL      5530--REDEF
KQ$CG.EOFTIME
      5207**DCL      7198<<ASSIGN
KQ$CG.EOFTIMEHD$
      5203**DCL      7186--ASSIGN   7197>>IF
KQ$CG.GORGOSTA$
      5585**DCL      6938>>IF       6939>>ASSIGN   6940>>ASSIGN   7053>>ASSIGN
KQ$CG.QUEUE.BUSY
      5331**DCL      6945<<ASSIGN
KQ$CG.QUEUE.DELAY$
      5323**DCL      6954<>CALL
KQ$CG.QUEUE.DELAYDQ$
      5349**DCL      6954<>CALL
KQ$CG.QUEUE.GACT
      5339**DCL      6942<<ASSIGN
KQ$CG.QUEUE.PLHD$
      5319**DCL      6932>>ASSIGN   6979>>ASSIGN   7006>>ASSIGN
KQ$CG.QUEUE.QTREE$
      5308**DCL      6948>>ASSIGN   6956>>CALL     6961>>CALL     7081>>CALL     7087>>CALL     7106>>CALL
      7114>>CALL     7146>>CALL     7168>>CALL
KQ$CG.QUEUE.RQGC
      5343**DCL      6944<<ASSIGN
KQ$CG.QUEUE.RQMEM
      5341**DCL      6943<<ASSIGN
KQ$CG.QUEUE.RUSR#
      5328**DCL      6946<<ASSIGN
KQ$CG.QUEUE.WCRL$
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:55   
      5311**DCL      6947<<ASSIGN   7040>>ASSIGN   7152--ASSIGN
KQ$CG.RCVR
      5460**DCL      7035>>IF
KQ$CG.STREE.GATE
      5420**DCL      7183<>CALL     7201<>CALL
KQ$QTN.ACTLNK$
      6780**DCL      7057<<ASSIGN   7085>>ASSIGN
KQ$QTN.ACTWAIT
      6753**DCL      7035>>IF       7051<<ASSIGN   7103<<ASSIGN   7116<<ASSIGN
KQ$QTN.CNACT
      6737**DCL      6981>>IF       6988<<ASSIGN   7008<<ASSIGN   7096>>IF
KQ$QTN.CRASHACT
      6772**DCL      6981>>IF       6989<<ASSIGN   7009<<ASSIGN
KQ$QTN.LOCKCNT
      6756**DCL      6934<<ASSIGN   7052<<ASSIGN   7052>>ASSIGN   7102<<ASSIGN   7102>>ASSIGN   7117<<ASSIGN
      7117>>ASSIGN
KQ$QTN.MLH.COUNT
      6843**DCL      7035>>IF
KQ$QTN.MXACT
      6740**DCL      6742--REDEF    7096>>IF
KQ$QTN.PLINK$
      6749**DCL      6935>>ASSIGN   6991>>ASSIGN   7010>>ASSIGN
KQ$QTN.READS$
      6743**DCL      6950<<ASSIGN   7038>>IF       7153--ASSIGN
KQ$QTN.STA.ACTTYC
      6462**DCL      6466--REDEF
KQ$QTN.STA.BTN.FLINK$
      6444**DCL      6951>>ASSIGN
KQ$QTN.STA.BTN.KEY
      6446**DCL      7043--IF
KQ$QTN.STA.DCBLNK$
      6469**DCL      6472--REDEF    6476--REDEF
KQ$QTN.STA.EVCNT
      6555**DCL      6558--REDEF
KQ$QTN.STA.EVNT
      6521**DCL      6525--REDEF    6528--REDEF
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:56   
KQ$QTN.STA.OPNBLKED
      6582**DCL      6585--REDEF
KQ$QTN.STA.OPNREJ
      6588**DCL      6590--REDEF
KQ$QTN.STA.SUCCREAD
      6511**DCL      6515--REDEF
KQ$QTN.STA.TCOUNT
      6640**DCL      6646--REDEF
KQ$QTN.STA.VGOT$
      6625**DCL      6629--REDEF    6633--REDEF
KQ$RBLK
      6170**DCL      7098<<ASSIGN
KQ$RBLK.BUF$
      6292**DCL      6294--REDEF
KQ$RBLK.CNACTD
      6206**DCL      6215--REDEF
KQ$RBLK.DBLKX
      6312**DCL      6316--REDEF
KQ$RBLK.EOFNONE
      6184**DCL      6187--REDEF
KQ$RBLK.EOFTIME
      6316**DCL      7185>>IF       7196<<ASSIGN
KQ$RBLK.EOFTIMELNK$
      6249**DCL      7195>>ASSIGN   7205--ASSIGN
KQ$RBLK.FROMQ
      6190**DCL      6193--REDEF
KQ$RBLK.KEY1
      6232**DCL      7043--IF
KQ$RBLK.KEY1L
      6227**DCL      7042>>ASSIGN   7092<<ASSIGN
KQ$RBLK.KEY1R
      6231**DCL      6232--REDEF
KQ$RBLK.KEY2L
      6229**DCL      7093<<ASSIGN
KQ$RBLK.KEY2R
      6236**DCL      6237--REDEF
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:57   
KQ$RBLK.LATCH
      6179**DCL      6181--REDEF    7091<<ASSIGN
KQ$RBLK.LWRITES$
      6323**DCL      6327--REDEF
KQ$RBLK.QRLNK$
      6327**DCL      7045>>ASSIGN   7158>>ASSIGN   7159<<ASSIGN   7162--ASSIGN
KQ$RBLK.QTN$
      6330**DCL      7151>>IF       7153>>ASSIGN
KQ$RBLK.STA$
      6258**DCL      7143>>IF       7149>>IF
KQ$STA
      5832**DCL      7089<>CALL     7094<>CALL     7100<>CALL     7104<>CALL
KQ$STA.ACTHD$
      5894**DCL      6939<<ASSIGN   7057>>ASSIGN   7058<<ASSIGN   7065>>ASSIGN   7085<<ASSIGN
KQ$STA.ACTTYC
      5884**DCL      5888--REDEF
KQ$STA.AIP
      5947**DCL      6940<<ASSIGN   7059>>IF       7060<<ASSIGN   7074<<ASSIGN
KQ$STA.DCBLNK$
      5891**DCL      5894--REDEF    5898--REDEF
KQ$STA.EVCNT
      5977**DCL      5980--REDEF
KQ$STA.EVNT
      5943**DCL      5947--REDEF    5950--REDEF
KQ$STA.GATE
      5910**DCL      7055<>CALL     7062<>CALL     7072<>CALL     7077<>CALL
KQ$STA.OPNBLKED
      6004**DCL      6007--REDEF
KQ$STA.OPNREJ
      6010**DCL      6012--REDEF
KQ$STA.RBLK$
      5875**DCL      7068<<ASSIGN   7090>>ASSIGN
KQ$STA.SUCCREAD
      5933**DCL      5937--REDEF
KQ$STA.TCOUNT
      6062**DCL      6068--REDEF
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:58   
KQ$STA.VGOT$
      6047**DCL      6051--REDEF    6055--REDEF
KQ$THDR.GATE
      6361**DCL      6956<>CALL     6961<>CALL     7081<>CALL     7087<>CALL     7106<>CALL     7114<>CALL
      7146<>CALL     7168<>CALL
KQ$THDR.HEAD$
      6369**DCL      6948>>ASSIGN
KQL$QDELAYM
      6875**DCL-ENT  7110--CALL
KQL$QDFIND
      6876**DCL-ENT  7100--CALL
KQL$QXFDUN
      6877**DCL-ENT  7104--CALL
KQL$RCVRDLY
      6878**DCL-ENT  6954--CALL
KQM$RELRBLK
      6879**DCL-ENT  7069--CALL
KQR$GETQUEUE
      6880**DCL-ENT  7094--CALL
KQR$GETRBLK
      6881**DCL-ENT  7089--CALL
KQW$XMITQR
      6882**DCL-ENT  6959--CALL
KQ_IMBLK.DVE.EOMCHAR
      3560**DCL      3562--REDEF
KQ_IMBLK.KEY1
      3486**DCL      3488--REDEF
KQ_IMBLK.KEY2
      3495**DCL      3513--REDEF
KQ_IMBLK.LNK$
      3460**DCL      3462--REDEF    3468--REDEF    3472--REDEF
KQ_IMBLK.TYC
      3609**DCL      3611--REDEF
KQ_IMBLK.XSP.MREQ$
      3515**DCL      3519--REDEF
KQ_IRBLK
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:59   
      2942**DCL      7098>>ASSIGN
KQ_IRBLK.BUF$
      3064**DCL      3066--REDEF
KQ_IRBLK.CNACTD
      2978**DCL      2987--REDEF
KQ_IRBLK.DBLKX
      3084**DCL      3088--REDEF
KQ_IRBLK.EOFNONE
      2956**DCL      2959--REDEF
KQ_IRBLK.FROMQ
      2962**DCL      2965--REDEF
KQ_IRBLK.KEY1R
      3003**DCL      3004--REDEF
KQ_IRBLK.KEY2R
      3008**DCL      3009--REDEF
KQ_IRBLK.LATCH
      2951**DCL      2953--REDEF
KQ_IRBLK.LWRITES$
      3095**DCL      3099--REDEF
KQ_IRBLKT.CNACTD
      3164**DCL      3173--REDEF
KQ_IRBLKT.DBLK$
      3227**DCL      3231--REDEF    3234--REDEF
KQ_IRBLKT.EOFNONE
      3142**DCL      3145--REDEF
KQ_IRBLKT.FROMQ
      3148**DCL      3151--REDEF
KQ_IRBLKT.KEY1R
      3189**DCL      3190--REDEF
KQ_IRBLKT.KEY2R
      3194**DCL      3195--REDEF
KQ_IRBLKT.LATCH
      3137**DCL      3139--REDEF
MBLK$
      6863**DCL      7099<<ASSIGN   7100<>CALL     7110<>CALL
P$
PL6.E3A0      #001=KQQ$DEQUEUE File=KQQ$QUEUE.:E05TSI                            WED 07/30/97 01:34 Page:60   
      6864**DCL      6958<<ASSIGN   6959<>CALL     6984<<ASSIGN   7152<<ASSIGN   7153<<ASSIGN   7154>>ASSIGN
      7158>>ASSIGN   7162<<ASSIGN   7163>>ASSIGN   7186<<ASSIGN   7188>>IF       7193>>IF       7195>>ASSIGN
      7205<<ASSIGN   7205>>ASSIGN
PARM$
      5810**DCL        14--PROC     6903>>ASSIGN   6913--ENTRY    6915>>ASSIGN   7032--ENTRY    7034>>ASSIGN
PP$
      6868**DCL      7154<<ASSIGN   7155>>DOWHILE  7156>>IF       7162>>ASSIGN   7163<<ASSIGN
QTN$
      6867**DCL      6394--IMP-PTR  6932<<ASSIGN   6933>>DOWHILE  6934>>ASSIGN   6935<<ASSIGN   6935>>ASSIGN
      6948<<ASSIGN   6949>>DOWHILE  6950>>ASSIGN   6951<<ASSIGN   6951>>ASSIGN   6979<<ASSIGN   6980>>DOWHILE
      6981>>IF       6981>>IF       6984>>ASSIGN   6988>>ASSIGN   6989>>ASSIGN   6991<<ASSIGN   6991>>ASSIGN
      7006<<ASSIGN   7007>>DOWHILE  7008>>ASSIGN   7009>>ASSIGN   7010<<ASSIGN   7010>>ASSIGN   7034<<ASSIGN
      7035>>IF       7035>>IF       7038>>IF       7043>>IF       7051>>ASSIGN   7052>>ASSIGN   7052>>ASSIGN
      7057>>ASSIGN   7058>>ASSIGN   7065<<ASSIGN   7066>>IF       7085>>ASSIGN   7096>>IF       7096>>IF
      7099>>ASSIGN   7102>>ASSIGN   7102>>ASSIGN   7103>>ASSIGN   7116>>ASSIGN   7117>>ASSIGN   7117>>ASSIGN
RBLK$
      6862**DCL      6170--IMP-PTR  6903<<ASSIGN   6915<<ASSIGN   7040<<ASSIGN   7041>>DOWHILE  7042>>ASSIGN
      7043>>IF       7045<<ASSIGN   7045>>ASSIGN   7069<>CALL     7090<<ASSIGN   7091>>ASSIGN   7092>>ASSIGN
      7093>>ASSIGN   7098>>ASSIGN   7143>>IF       7149>>IF       7151>>IF       7153>>ASSIGN   7156>>IF
      7158>>ASSIGN   7159>>ASSIGN   7185>>IF       7193>>IF       7195>>ASSIGN   7196>>ASSIGN
SC_CGCANZ
      6883**DCL-ENT  6995--CALL     7190--CALL
STA$
      6861**DCL      5832--IMP-PTR  7053<<ASSIGN   7055>>CALL     7057>>ASSIGN   7058>>ASSIGN   7059>>IF
      7060>>ASSIGN   7062>>CALL     7065>>ASSIGN   7068>>ASSIGN   7072>>CALL     7074>>ASSIGN   7077>>CALL
      7085>>ASSIGN   7089>>CALL     7090>>ASSIGN   7094>>CALL     7100>>CALL     7104>>CALL
XIT IN PROCEDURE DQEOFTIME
      7197**LABEL    7185--GOTO     7191--GOTO
