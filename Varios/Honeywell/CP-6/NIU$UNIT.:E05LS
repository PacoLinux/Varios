VERSION E05

PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:1    
        1        1        /*M* NIU$UNIT - Unit Record Handler for New IO System */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        /*D*    ENTRY:      NIU$DEVSCHED
        9        9
       10       10                CALL:       CALL NIU$DEVSCHED(DCT,NEWSTATE);
       11       11
       12       12                ENVIRONMENT: Monitor linkage segment.
       13       13
       14       14                DESCRIPTION:   SQH.GATE is locked and the devices state is
       15       15                               changed to NEWSTATE.
       16       16
       17       17                               If the device's state is IDLE and
       18       18                               there are requests pending on the device, it
       19       19                               is placed on the assign queue for the
       20       20                               subsystem and the devices state is changed
       21       21                               to requested.  Control then passes to
       22       22                               NIU$SCANAQ.
       23       23                                                                           */
       24       24
       25       25        NIU$DEVSCHED: PROC (PAR, NEWSTATE);
       26       26        /*
       27       27              Includes
       28       28        */
       29       29        %INCLUDE                HF_LOCK_C ;
       30       43        %INCLUDE                NI_DATA_C ;
       31      156        %INCLUDE                NI_DATA_R ;
       32      593        %INCLUDE                NI_MACROS_C ;
       33      860        %INCLUDE                PM$NI ;
       34      884        /*
       35      885              Parameters
       36      886        */
       37      887    1   DCL 1 NEWSTATE        UBIN PARAM ;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:2    
       38      888    1   DCL 1 PAR             SBIN PARAM ;
       39      889        /*
       40      890              Entries
       41      891        */
       42      892    1   DCL 1 NIS$DRIVER        ENTRY(1) ;
       43      893    1   DCL 1 PMN$COLLECT       ENTRY(3) ;
       44      894        /*
       45      895              Auto
       46      896        */
       47      897    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
       48      898    1   DCL 1 DQH$              PTR ALIGNED AUTO ;
       49      899    1   DCL 1 REQ$              PTR ALIGNED AUTO ;
       50      900    1   DCL 1 SQH$              PTR ALIGNED AUTO ;
       51      901    1   DCL 1 SVDCT$            PTR ALIGNED AUTO ;
       52      902        /*
       53      903              Based
       54      904        */
       55      905        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
       56      953        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
       57      976        %N$REQ                  ( NAME=REQ, STCLASS="BASED(REQ$)" ) ;
       58     1034        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)" ) ;
       59     1047        %EJECT;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:3    
       60     1048    1           DCT$ = ADDR(PAR);
       61     1049    1           SQH$ = DCT.SQH$;
       62     1050                %LOCK(G#=SQH.GATE);
       63     1053    1           DCT.STATE = NEWSTATE;
       64     1054    1           GOTO SCHED ;
       65     1055        /*D*    ENTRY:      NIU$REQSCHED
       66     1056
       67     1057                CALL:       CALL NIU$REQSCHED(N$REQ);
       68     1058
       69     1059                ENVIRONMENT: Monitor linkage segment
       70     1060
       71     1061                INPUT:      N$REQ - IOQ packet
       72     1062
       73     1063                DESCRIPTION:   NIU$REQSCHED enqueues the request on the
       74     1064                               devices scheduler queue and then goes to the
       75     1065                               common code at SCHED.
       76     1066                                                                           */
       77     1067    1   NIU$REQSCHED: ENTRY(PAR);
       78     1068    1           REQ$ = ADDR(PAR);
       79     1069    1           DCT$ = REQ.DCT$;
       80     1070    1           SQH$ = DCT.SQH$;
       81     1071                %LOCK(G#=SQH.GATE);
       82     1074
       83     1075    1           IF DCT.SQ$ = ADDR(NIL)
       84     1076    1           THEN
       85     1077    2           DO;
       86     1078    2              REQ.FL$ = REQ$;
       87     1079    2              DCT.SQ$ = REQ$;
       88     1080    2              END;
       89     1081    1           ELSE
       90     1082    2           DO;
       91     1083                   %ENQUEUE(P#=REQ,Q#=DCT.SQ$);
       92     1086    2              END;
       93     1087    1           IF DCT.PM.MODE = %BUSY THEN CALL PMN$COLLECT(DCT.PM,%PM_QUED);
       94     1088    1           GOTO SCHED;
       95     1089        %EJECT;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:4    
       96     1090    1   SCHED:
       97     1091    1           IF DCT.STATE = %IDLE AND DCT.SQ$ ~= ADDR(NIL)
       98     1092    1           THEN
       99     1093    2           DO;
      100     1094                   %ENQUEUE(P#=DCT,Q#=SQH.AQ$);
      101     1097    2              DCT.STATE = %REQUESTED;
      102     1098    2              CALL PMN$COLLECT(DCT.PM,%PM_WAIT);
      103     1099    2              END;
      104     1100    1           GOTO SCANAQ;
      105     1101        %EJECT;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:5    
      106     1102        /*D*    ENTRY:      NIU$SCANAQ
      107     1103
      108     1104                CALL:       CALL NIU$SCANAQ(SQH);
      109     1105
      110     1106                DESCRIPTION:      NIU$SCANAQ scans the subsystem assign queue
      111     1107                                  to find any requests that can be started.
      112     1108                                                                           */
      113     1109    1   NIU$SCANAQ: ENTRY(PAR);
      114     1110    1           SQH$ = ADDR(PAR);
      115     1111                %LOCK(G#=SQH.GATE);
      116     1114    1   SCANAQ:
      117     1115    1           SVDCT$ = ADDR(NIL);
      118     1116    2           DO WHILE(SQH.AQ$ ~= ADDR(NIL));
      119     1117                   %DEQUEUE(P#=DCT$,Q#=SQH.AQ$);
      120     1124    2              REQ$ = DCT.SQ$->REQ.FL$;
      121     1125    2              IF REQ.DQH$ = ADDR(NIL)
      122     1126    2              THEN                         /* REGULAR REQUEST */
      123     1127    3              DO;
      124     1128    3                 DQH$ = DCT.DQH$;
      125     1129    3                 IF DQH.STATE ~= %IDLE OR DQH.CHANSTATE
      126     1130    3                 THEN
      127     1131    4                 DO;
      128     1132                         %ENQUEUE(P#=DCT,Q#=SVDCT$);
      129     1135    4                    END;
      130     1136    3                 ELSE
      131     1137    4                 DO;
      132     1138                         %DEQUEUE(P#=REQ$,Q#=DCT.SQ$);
      133     1145    4                    DQH.IO$ = REQ$;
      134     1146    4                    DCT.DQH$ = DQH$;
      135     1147    4                    DCT.STATE = %BUSY;
      136     1148    4                    IF DCT.SQ$ = ADDR(NIL)
      137     1149    4                    THEN CALL PMN$COLLECT(DCT.PM,%PM_BUSY);
      138     1150    4                    ELSE CALL PMN$COLLECT(DCT.PM,%PM_QUED);
      139     1151    4                    CALL NIS$DRIVER(DQH);
      140     1152    4                    END;
      141     1153    3                 END;
      142     1154    2              ELSE                         /* SPECIAL REQUEST */
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:6    
      143     1155    3              DO;
      144     1156    3                 DQH$ = REQ.DQH$;
      145     1157    3                 IF DQH.STATE ~= %IDLE OR
      146     1158    3                   (REQ.IOFLG.STOPMPC AND NOT DQH.MPC$->DCT.DFLG.MPCSTOP)
      147     1159    3                 THEN
      148     1160    4                 DO;
      149     1161                         %ENQUEUE(P#=DCT,Q#=SVDCT$);
      150     1164    4                    END;
      151     1165    3                 ELSE
      152     1166    4                 DO;
      153     1167                         %DEQUEUE(P#=REQ$,Q#=DCT.SQ$);
      154     1174    4                    DQH.IO$ = REQ$;
      155     1175    4                    DCT.DQH$ = DQH$;
      156     1176    4                    IF REQ.IOFLG.SUSP THEN DQH.MPC$->DCT.DFLG.MPCSUSPENDED = '1'B;
      157     1177    4                    DCT.STATE = %BUSY;
      158     1178    4                    CALL PMN$COLLECT(DCT.PM,%PM_BUSY);
      159     1179    4                    CALL NIS$DRIVER(DQH);
      160     1180    4                    END;
      161     1181    3                 END;                      /* SPECIAL REQUEST */
      162     1182    2              END;                         /* DO WHILE */
      163     1183    1           SQH.AQ$ = SVDCT$;
      164     1184                %UNLOCK(G#=SQH.GATE);
      165     1187    1           RETURN;
      166     1188    1   END NIU$DEVSCHED ;
      167     1189        %EOD;

PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:7    
--  Include file information  --

   PM$NI.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure NIU$DEVSCHED.

   Procedure NIU$DEVSCHED requires 250 words for executable code.
   Procedure NIU$DEVSCHED requires 12 words of local(AUTO) storage.

PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:8    

 Object Unit name= NIU$DEVSCHED                               File name= NIU$UNIT.:E05TOU
 UTS= JUL 30 '97 03:38:30.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   250    372  NIU$DEVSCHED
    1  RoData even  none     3      3  NIU$DEVSCHED

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  NIU$DEVSCHED
     0     20                  yes      Std        1  NIU$REQSCHED
     0    133                  yes      Std        1  NIU$SCANAQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
         yes           Std       3 PMN$COLLECT
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       2 NIM$DEQUEUE
         yes           Std       1 NIS$DRIVER
         yes           Std       2 NIM$ENQUEUE
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:9    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               N$FQ$                                 NI$FQ$
     NI$IBUF$                              NI$RP$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:10   


        1        1        /*M* NIU$UNIT - Unit Record Handler for New IO System */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        /*D*    ENTRY:      NIU$DEVSCHED
        9        9
       10       10                CALL:       CALL NIU$DEVSCHED(DCT,NEWSTATE);
       11       11
       12       12                ENVIRONMENT: Monitor linkage segment.
       13       13
       14       14                DESCRIPTION:   SQH.GATE is locked and the devices state is
       15       15                               changed to NEWSTATE.
       16       16
       17       17                               If the device's state is IDLE and
       18       18                               there are requests pending on the device, it
       19       19                               is placed on the assign queue for the
       20       20                               subsystem and the devices state is changed
       21       21                               to requested.  Control then passes to
       22       22                               NIU$SCANAQ.
       23       23                                                                           */
       24       24
       25       25        NIU$DEVSCHED: PROC (PAR, NEWSTATE);

     25  0 000000   000000 700200 xent  NIU$DEVSCHED TSX0  ! X66_AUTO_2
         0 000001   000014 000002                    ZERO    12,2

       26       26        /*
       27       27              Includes
       28       28        */
       29       29        %INCLUDE                HF_LOCK_C ;
       30       43        %INCLUDE                NI_DATA_C ;
       31      156        %INCLUDE                NI_DATA_R ;
       32      593        %INCLUDE                NI_MACROS_C ;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:11   
       33      860        %INCLUDE                PM$NI ;
       34      884        /*
       35      885              Parameters
       36      886        */
       37      887    1   DCL 1 NEWSTATE        UBIN PARAM ;
       38      888    1   DCL 1 PAR             SBIN PARAM ;
       39      889        /*
       40      890              Entries
       41      891        */
       42      892    1   DCL 1 NIS$DRIVER        ENTRY(1) ;
       43      893    1   DCL 1 PMN$COLLECT       ENTRY(3) ;
       44      894        /*
       45      895              Auto
       46      896        */
       47      897    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
       48      898    1   DCL 1 DQH$              PTR ALIGNED AUTO ;
       49      899    1   DCL 1 REQ$              PTR ALIGNED AUTO ;
       50      900    1   DCL 1 SQH$              PTR ALIGNED AUTO ;
       51      901    1   DCL 1 SVDCT$            PTR ALIGNED AUTO ;
       52      902        /*
       53      903              Based
       54      904        */
       55      905        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
       56      953        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
       57      976        %N$REQ                  ( NAME=REQ, STCLASS="BASED(REQ$)" ) ;
       58     1034        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)" ) ;
       59     1047        %EJECT;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:12   
       60     1048    1           DCT$ = ADDR(PAR);

   1048  0 000002   200003 236100                    LDQ     @PAR,,AUTO
         0 000003   200005 756100                    STQ     DCT$,,AUTO

       61     1049    1           SQH$ = DCT.SQH$;

   1049  0 000004   200005 470500                    LDP0    DCT$,,AUTO
         0 000005   000022 236100                    LDQ     18,,PR0
         0 000006   200010 756100                    STQ     SQH$,,AUTO

       62     1050                %LOCK(G#=SQH.GATE);

   1051  0 000007   200010 630500                    EPPR0   SQH$,,AUTO
         0 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000011   000000 701000 xent               TSX1    HFC$LOCK
         0 000012   000000 011000                    NOP     0

       63     1053    1           DCT.STATE = NEWSTATE;

   1053  0 000013   200004 470500                    LDP0    @NEWSTATE,,AUTO
         0 000014   200005 471500                    LDP1    DCT$,,AUTO
         0 000015   000000 236100                    LDQ     0,,PR0
         0 000016   100007 752101                    STCQ    7,'01'O,PR1

       64     1054    1           GOTO SCHED ;

   1054  0 000017   000077 710000 0                  TRA     SCHED

       65     1055        /*D*    ENTRY:      NIU$REQSCHED
       66     1056
       67     1057                CALL:       CALL NIU$REQSCHED(N$REQ);
       68     1058
       69     1059                ENVIRONMENT: Monitor linkage segment
       70     1060
       71     1061                INPUT:      N$REQ - IOQ packet
       72     1062
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:13   
       73     1063                DESCRIPTION:   NIU$REQSCHED enqueues the request on the
       74     1064                               devices scheduler queue and then goes to the
       75     1065                               common code at SCHED.
       76     1066                                                                           */
       77     1067    1   NIU$REQSCHED: ENTRY(PAR);

   1067  0 000020   000000 700200 xent  NIU$REQSCHED TSX0  ! X66_AUTO_2
         0 000021   000014 000002                    ZERO    12,2

       78     1068    1           REQ$ = ADDR(PAR);

   1068  0 000022   200003 236100                    LDQ     @PAR,,AUTO
         0 000023   200007 756100                    STQ     REQ$,,AUTO

       79     1069    1           DCT$ = REQ.DCT$;

   1069  0 000024   200007 470500                    LDP0    REQ$,,AUTO
         0 000025   000002 236100                    LDQ     2,,PR0
         0 000026   200005 756100                    STQ     DCT$,,AUTO

       80     1070    1           SQH$ = DCT.SQH$;

   1070  0 000027   200005 471500                    LDP1    DCT$,,AUTO
         0 000030   100022 236100                    LDQ     18,,PR1
         0 000031   200010 756100                    STQ     SQH$,,AUTO

       81     1071                %LOCK(G#=SQH.GATE);

   1072  0 000032   200010 630500                    EPPR0   SQH$,,AUTO
         0 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000034   000000 701000 xent               TSX1    HFC$LOCK
         0 000035   000000 011000                    NOP     0

       82     1074
       83     1075    1           IF DCT.SQ$ = ADDR(NIL)

   1075  0 000036   200005 470500                    LDP0    DCT$,,AUTO
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:14   
         0 000037   000001 236100                    LDQ     1,,PR0
         0 000040   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000041   000051 601000 0                  TNZ     s:1084

       84     1076    1           THEN
       85     1077    2           DO;

       86     1078    2              REQ.FL$ = REQ$;

   1078  0 000042   200007 236100                    LDQ     REQ$,,AUTO
         0 000043   200007 471500                    LDP1    REQ$,,AUTO
         0 000044   100000 756100                    STQ     0,,PR1

       87     1079    2              DCT.SQ$ = REQ$;

   1079  0 000045   200007 236100                    LDQ     REQ$,,AUTO
         0 000046   200005 470500                    LDP0    DCT$,,AUTO
         0 000047   000001 756100                    STQ     1,,PR0

       88     1080    2              END;

   1080  0 000050   000061 710000 0                  TRA     s:1087

       89     1081    1           ELSE
       90     1082    2           DO;

       91     1083                   %ENQUEUE(P#=REQ,Q#=DCT.SQ$);

   1084  0 000051   200005 236100                    LDQ     DCT$,,AUTO
         0 000052   000001 036003                    ADLQ    1,DU
         0 000053   200007 235100                    LDA     REQ$,,AUTO
         0 000054   200012 757100                    STAQ    SVDCT$+1,,AUTO
         0 000055   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000056   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000057   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000060   000000 011000                    NOP     0

PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:15   
       92     1086    2              END;

       93     1087    1           IF DCT.PM.MODE = %BUSY THEN CALL PMN$COLLECT(DCT.PM,%PM_QUED);

   1087  0 000061   200005 470500                    LDP0    DCT$,,AUTO
         0 000062   000010 235100                    LDA     8,,PR0
         0 000063   000005 115007                    CMPA    5,DL
         0 000064   000076 601000 0                  TNZ     s:1088

   1087  0 000065   000000 236000 1                  LDQ     0
         0 000066   200013 756100                    STQ     SVDCT$+2,,AUTO
         0 000067   200005 236100                    LDQ     DCT$,,AUTO
         0 000070   000010 036003                    ADLQ    8,DU
         0 000071   200012 756100                    STQ     SVDCT$+1,,AUTO
         0 000072   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000073   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000074   000000 701000 xent               TSX1    PMN$COLLECT
         0 000075   000000 011000                    NOP     0

       94     1088    1           GOTO SCHED;

   1088  0 000076   000077 710000 0                  TRA     SCHED

       95     1089        %EJECT;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:16   
       96     1090    1   SCHED:
       97     1091    1           IF DCT.STATE = %IDLE AND DCT.SQ$ ~= ADDR(NIL)

   1091  0 000077   200005 470500       SCHED        LDP0    DCT$,,AUTO
         0 000100   000007 236100                    LDQ     7,,PR0
         0 000101   000077 316007                    CANQ    63,DL
         0 000102   000132 601000 0                  TNZ     s:1100
         0 000103   000001 236100                    LDQ     1,,PR0
         0 000104   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000105   000132 600000 0                  TZE     s:1100

       98     1092    1           THEN
       99     1093    2           DO;

      100     1094                   %ENQUEUE(P#=DCT,Q#=SQH.AQ$);

   1095  0 000106   200010 236100                    LDQ     SQH$,,AUTO
         0 000107   000003 036003                    ADLQ    3,DU
         0 000110   200005 235100                    LDA     DCT$,,AUTO
         0 000111   200012 757100                    STAQ    SVDCT$+1,,AUTO
         0 000112   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000114   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000115   000000 011000                    NOP     0

      101     1097    2              DCT.STATE = %REQUESTED;

   1097  0 000116   200005 470500                    LDP0    DCT$,,AUTO
         0 000117   000001 236007                    LDQ     1,DL
         0 000120   000007 752101                    STCQ    7,'01'O,PR0

      102     1098    2              CALL PMN$COLLECT(DCT.PM,%PM_WAIT);

   1098  0 000121   000001 236000 1                  LDQ     1
         0 000122   200013 756100                    STQ     SVDCT$+2,,AUTO
         0 000123   200005 236100                    LDQ     DCT$,,AUTO
         0 000124   000010 036003                    ADLQ    8,DU
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:17   
         0 000125   200012 756100                    STQ     SVDCT$+1,,AUTO
         0 000126   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000127   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000130   000000 701000 xent               TSX1    PMN$COLLECT
         0 000131   000000 011000                    NOP     0

      103     1099    2              END;

      104     1100    1           GOTO SCANAQ;

   1100  0 000132   000143 710000 0                  TRA     SCANAQ

      105     1101        %EJECT;
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:18   
      106     1102        /*D*    ENTRY:      NIU$SCANAQ
      107     1103
      108     1104                CALL:       CALL NIU$SCANAQ(SQH);
      109     1105
      110     1106                DESCRIPTION:      NIU$SCANAQ scans the subsystem assign queue
      111     1107                                  to find any requests that can be started.
      112     1108                                                                           */
      113     1109    1   NIU$SCANAQ: ENTRY(PAR);

   1109  0 000133   000000 700200 xent  NIU$SCANAQ   TSX0  ! X66_AUTO_2
         0 000134   000014 000002                    ZERO    12,2

      114     1110    1           SQH$ = ADDR(PAR);

   1110  0 000135   200003 236100                    LDQ     @PAR,,AUTO
         0 000136   200010 756100                    STQ     SQH$,,AUTO

      115     1111                %LOCK(G#=SQH.GATE);

   1112  0 000137   200010 630500                    EPPR0   SQH$,,AUTO
         0 000140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000141   000000 701000 xent               TSX1    HFC$LOCK
         0 000142   000000 011000                    NOP     0

      116     1114    1   SCANAQ:
      117     1115    1           SVDCT$ = ADDR(NIL);

   1115  0 000143   000001 236000 xsym  SCANAQ       LDQ     B_VECTNIL+1
         0 000144   200011 756100                    STQ     SVDCT$,,AUTO

      118     1116    2           DO WHILE(SQH.AQ$ ~= ADDR(NIL));

   1116  0 000145   000357 710000 0                  TRA     s:1182

      119     1117                   %DEQUEUE(P#=DCT$,Q#=SQH.AQ$);

   1121  0 000146   200010 236100                    LDQ     SQH$,,AUTO
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:19   
         0 000147   000003 036003                    ADLQ    3,DU
         0 000150   200013 756100                    STQ     SVDCT$+2,,AUTO
         0 000151   200005 630500                    EPPR0   DCT$,,AUTO
         0 000152   200012 450500                    STP0    SVDCT$+1,,AUTO
         0 000153   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000155   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000156   000000 011000                    NOP     0

      120     1124    2              REQ$ = DCT.SQ$->REQ.FL$;

   1124  0 000157   200005 470500                    LDP0    DCT$,,AUTO
         0 000160   000001 471500                    LDP1    1,,PR0
         0 000161   100000 236100                    LDQ     0,,PR1
         0 000162   200007 756100                    STQ     REQ$,,AUTO

      121     1125    2              IF REQ.DQH$ = ADDR(NIL)

   1125  0 000163   200007 471500                    LDP1    REQ$,,AUTO
         0 000164   100020 236100                    LDQ     16,,PR1
         0 000165   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000166   000265 601000 0                  TNZ     s:1156

      122     1126    2              THEN                         /* REGULAR REQUEST */
      123     1127    3              DO;

      124     1128    3                 DQH$ = DCT.DQH$;

   1128  0 000167   000023 236100                    LDQ     19,,PR0
         0 000170   200006 756100                    STQ     DQH$,,AUTO

      125     1129    3                 IF DQH.STATE ~= %IDLE OR DQH.CHANSTATE

   1129  0 000171   200006 473500                    LDP3    DQH$,,AUTO
         0 000172   300001 236100                    LDQ     1,,PR3
         0 000173   000077 316007                    CANQ    63,DL
         0 000174   000200 601000 0                  TNZ     s:1133
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:20   
         0 000175   300020 236100                    LDQ     16,,PR3
         0 000176   740000 316003                    CANQ    -16384,DU
         0 000177   000211 600000 0                  TZE     s:1142

      126     1130    3                 THEN
      127     1131    4                 DO;

      128     1132                         %ENQUEUE(P#=DCT,Q#=SVDCT$);

   1133  0 000200   200011 634500                    EPPR4   SVDCT$,,AUTO
         0 000201   200013 454500                    STP4    SVDCT$+2,,AUTO
         0 000202   200005 236100                    LDQ     DCT$,,AUTO
         0 000203   200012 756100                    STQ     SVDCT$+1,,AUTO
         0 000204   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000205   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000206   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000207   000000 011000                    NOP     0

      129     1135    4                    END;

   1135  0 000210   000357 710000 0                  TRA     s:1182

      130     1136    3                 ELSE
      131     1137    4                 DO;

      132     1138                         %DEQUEUE(P#=REQ$,Q#=DCT.SQ$);

   1142  0 000211   200005 236100                    LDQ     DCT$,,AUTO
         0 000212   000001 036003                    ADLQ    1,DU
         0 000213   200013 756100                    STQ     SVDCT$+2,,AUTO
         0 000214   200007 634500                    EPPR4   REQ$,,AUTO
         0 000215   200012 454500                    STP4    SVDCT$+1,,AUTO
         0 000216   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000217   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000220   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000221   000000 011000                    NOP     0

PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:21   
      133     1145    4                    DQH.IO$ = REQ$;

   1145  0 000222   200007 236100                    LDQ     REQ$,,AUTO
         0 000223   200006 470500                    LDP0    DQH$,,AUTO
         0 000224   000014 756100                    STQ     12,,PR0

      134     1146    4                    DCT.DQH$ = DQH$;

   1146  0 000225   200006 236100                    LDQ     DQH$,,AUTO
         0 000226   200005 471500                    LDP1    DCT$,,AUTO
         0 000227   100023 756100                    STQ     19,,PR1

      135     1147    4                    DCT.STATE = %BUSY;

   1147  0 000230   000005 236007                    LDQ     5,DL
         0 000231   100007 752101                    STCQ    7,'01'O,PR1

      136     1148    4                    IF DCT.SQ$ = ADDR(NIL)

   1148  0 000232   100001 236100                    LDQ     1,,PR1
         0 000233   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000234   000247 601000 0                  TNZ     s:1150

      137     1149    4                    THEN CALL PMN$COLLECT(DCT.PM,%PM_BUSY);

   1149  0 000235   000002 236000 1                  LDQ     2
         0 000236   200013 756100                    STQ     SVDCT$+2,,AUTO
         0 000237   200005 236100                    LDQ     DCT$,,AUTO
         0 000240   000010 036003                    ADLQ    8,DU
         0 000241   200012 756100                    STQ     SVDCT$+1,,AUTO
         0 000242   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000243   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000244   000000 701000 xent               TSX1    PMN$COLLECT
         0 000245   000000 011000                    NOP     0
         0 000246   000260 710000 0                  TRA     s:1151

      138     1150    4                    ELSE CALL PMN$COLLECT(DCT.PM,%PM_QUED);
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:22   

   1150  0 000247   000000 236000 1                  LDQ     0
         0 000250   200013 756100                    STQ     SVDCT$+2,,AUTO
         0 000251   200005 236100                    LDQ     DCT$,,AUTO
         0 000252   000010 036003                    ADLQ    8,DU
         0 000253   200012 756100                    STQ     SVDCT$+1,,AUTO
         0 000254   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000255   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000256   000000 701000 xent               TSX1    PMN$COLLECT
         0 000257   000000 011000                    NOP     0

      139     1151    4                    CALL NIS$DRIVER(DQH);

   1151  0 000260   200006 630500                    EPPR0   DQH$,,AUTO
         0 000261   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000262   000000 701000 xent               TSX1    NIS$DRIVER
         0 000263   000000 011000                    NOP     0

      140     1152    4                    END;

      141     1153    3                 END;

   1153  0 000264   000357 710000 0                  TRA     s:1182

      142     1154    2              ELSE                         /* SPECIAL REQUEST */
      143     1155    3              DO;

      144     1156    3                 DQH$ = REQ.DQH$;

   1156  0 000265   200006 756100                    STQ     DQH$,,AUTO

      145     1157    3                 IF DQH.STATE ~= %IDLE OR

   1157  0 000266   200006 473500                    LDP3    DQH$,,AUTO
         0 000267   300001 236100                    LDQ     1,,PR3
         0 000270   000077 316007                    CANQ    63,DL
         0 000271   000301 601000 0                  TNZ     s:1162
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:23   
         0 000272   100004 236100                    LDQ     4,,PR1
         0 000273   001000 316007                    CANQ    512,DL
         0 000274   000312 600000 0                  TZE     s:1171
         0 000275   300015 474500                    LDP4    13,,PR3
         0 000276   400006 236100                    LDQ     6,,PR4
         0 000277   001000 316007                    CANQ    512,DL
         0 000300   000312 601000 0                  TNZ     s:1171

      146     1158    3                   (REQ.IOFLG.STOPMPC AND NOT DQH.MPC$->DCT.DFLG.MPCSTOP)
      147     1159    3                 THEN
      148     1160    4                 DO;

      149     1161                         %ENQUEUE(P#=DCT,Q#=SVDCT$);

   1162  0 000301   200011 634500                    EPPR4   SVDCT$,,AUTO
         0 000302   200013 454500                    STP4    SVDCT$+2,,AUTO
         0 000303   200005 236100                    LDQ     DCT$,,AUTO
         0 000304   200012 756100                    STQ     SVDCT$+1,,AUTO
         0 000305   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000306   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000307   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000310   000000 011000                    NOP     0

      150     1164    4                    END;

   1164  0 000311   000357 710000 0                  TRA     s:1182

      151     1165    3                 ELSE
      152     1166    4                 DO;

      153     1167                         %DEQUEUE(P#=REQ$,Q#=DCT.SQ$);

   1171  0 000312   200005 236100                    LDQ     DCT$,,AUTO
         0 000313   000001 036003                    ADLQ    1,DU
         0 000314   200013 756100                    STQ     SVDCT$+2,,AUTO
         0 000315   200007 634500                    EPPR4   REQ$,,AUTO
         0 000316   200012 454500                    STP4    SVDCT$+1,,AUTO
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:24   
         0 000317   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000320   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000321   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000322   000000 011000                    NOP     0

      154     1174    4                    DQH.IO$ = REQ$;

   1174  0 000323   200007 236100                    LDQ     REQ$,,AUTO
         0 000324   200006 470500                    LDP0    DQH$,,AUTO
         0 000325   000014 756100                    STQ     12,,PR0

      155     1175    4                    DCT.DQH$ = DQH$;

   1175  0 000326   200006 236100                    LDQ     DQH$,,AUTO
         0 000327   200005 471500                    LDP1    DCT$,,AUTO
         0 000330   100023 756100                    STQ     19,,PR1

      156     1176    4                    IF REQ.IOFLG.SUSP THEN DQH.MPC$->DCT.DFLG.MPCSUSPENDED = '1'B;

   1176  0 000331   200007 473500                    LDP3    REQ$,,AUTO
         0 000332   300004 236100                    LDQ     4,,PR3
         0 000333   004000 316007                    CANQ    2048,DL
         0 000334   000340 600000 0                  TZE     s:1177

   1176  0 000335   000015 474500                    LDP4    13,,PR0
         0 000336   002000 236007                    LDQ     1024,DL
         0 000337   400006 256100                    ORSQ    6,,PR4

      157     1177    4                    DCT.STATE = %BUSY;

   1177  0 000340   000005 236007                    LDQ     5,DL
         0 000341   100007 752101                    STCQ    7,'01'O,PR1

      158     1178    4                    CALL PMN$COLLECT(DCT.PM,%PM_BUSY);

   1178  0 000342   000002 236000 1                  LDQ     2
         0 000343   200013 756100                    STQ     SVDCT$+2,,AUTO
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:25   
         0 000344   200005 236100                    LDQ     DCT$,,AUTO
         0 000345   000010 036003                    ADLQ    8,DU
         0 000346   200012 756100                    STQ     SVDCT$+1,,AUTO
         0 000347   200012 630500                    EPPR0   SVDCT$+1,,AUTO
         0 000350   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000351   000000 701000 xent               TSX1    PMN$COLLECT
         0 000352   000000 011000                    NOP     0

      159     1179    4                    CALL NIS$DRIVER(DQH);

   1179  0 000353   200006 630500                    EPPR0   DQH$,,AUTO
         0 000354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000355   000000 701000 xent               TSX1    NIS$DRIVER
         0 000356   000000 011000                    NOP     0

      160     1180    4                    END;

      161     1181    3                 END;                      /* SPECIAL REQUEST */

      162     1182    2              END;                         /* DO WHILE */

   1182  0 000357   200010 470500                    LDP0    SQH$,,AUTO
         0 000360   000003 236100                    LDQ     3,,PR0
         0 000361   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000362   000146 601000 0                  TNZ     s:1121

      163     1183    1           SQH.AQ$ = SVDCT$;

   1183  0 000363   200011 236100                    LDQ     SVDCT$,,AUTO
         0 000364   000003 756100                    STQ     3,,PR0

      164     1184                %UNLOCK(G#=SQH.GATE);

   1185  0 000365   200010 630500                    EPPR0   SQH$,,AUTO
         0 000366   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000367   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000370   000000 011000                    NOP     0
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:26   

      165     1187    1           RETURN;

   1187  0 000371   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000005 006000   000003 006000   000004 006000                    ............
      166     1188    1   END NIU$DEVSCHED ;
      167     1189        %EOD;

PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:27   
--  Include file information  --

   PM$NI.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure NIU$DEVSCHED.
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:28   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @NEWSTATE                  3-0-0/w PTR         r     1 @PAR
     5-0-0/w PTR         r     1 DCT$                       6-0-0/w PTR         r     1 DQH$
    *0-0-0/w UBIN        r     1 NEWSTATE                  *0-0-0/w SBIN        r     1 PAR
     7-0-0/w PTR         r     1 REQ$                      10-0-0/w PTR         r     1 SQH$
    11-0-0/w PTR         r     1 SVDCT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 N$DCT$$                    0-0-0/w PTR         r     1 N$FQ$
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
     0-0-0/w PTR         r     1 NI$RP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w STRC(648)   r     1 DQH
     0-0-0/d STRC(1080)  r     1 REQ                        0-0-0/w STRC(252)   r     1 SQH


   Procedure NIU$DEVSCHED requires 250 words for executable code.
   Procedure NIU$DEVSCHED requires 12 words of local(AUTO) storage.
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:29   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:30   
          MINI XREF LISTING

DCT
       914**DCL      1095<>CALL     1133<>CALL     1162<>CALL
DCT.DFLG.MPCSTOP
       919**DCL      1157>>IF
DCT.DFLG.MPCSUSPENDED
       919**DCL      1176<<ASSIGN
DCT.DP
       934**DCL       941--REDEF     944--REDEF     945--REDEF     947--REDEF     947--REDEF     948--REDEF
       949--REDEF     949--REDEF
DCT.DQH$
       930**DCL      1128>>ASSIGN   1146<<ASSIGN   1175<<ASSIGN
DCT.MPC.IOCHANX
       942**DCL       942--REDEF
DCT.PM
       925**DCL      1087<>CALL     1098<>CALL     1149<>CALL     1150<>CALL     1178<>CALL
DCT.PM.MODE
       925**DCL      1087>>IF
DCT.SQ$
       914**DCL      1075>>IF       1079<<ASSIGN   1084<>CALL     1091>>IF       1124>>ASSIGN   1142<>CALL
      1148>>IF       1171<>CALL
DCT.SQH$
       929**DCL      1049>>ASSIGN   1070>>ASSIGN
DCT.STATE
       924**DCL      1053<<ASSIGN   1091>>IF       1097<<ASSIGN   1147<<ASSIGN   1177<<ASSIGN
DCT$
       897**DCL       914--IMP-PTR  1048<<ASSIGN   1049>>ASSIGN   1053>>ASSIGN   1069<<ASSIGN   1070>>ASSIGN
      1075>>IF       1079>>ASSIGN   1084>>CALL     1087>>IF       1087>>CALL     1091>>IF       1091>>IF
      1095>>CALL     1097>>ASSIGN   1098>>CALL     1121<>CALL     1124>>ASSIGN   1128>>ASSIGN   1133>>CALL
      1142>>CALL     1146>>ASSIGN   1147>>ASSIGN   1148>>IF       1149>>CALL     1150>>CALL     1162>>CALL
      1171>>CALL     1175>>ASSIGN   1177>>ASSIGN   1178>>CALL
DQH
       962**DCL      1151<>CALL     1179<>CALL
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:31   
DQH.CHANSTATE
       970**DCL      1129>>IF
DQH.IO$
       969**DCL      1145<<ASSIGN   1174<<ASSIGN
DQH.IOCHANX
       964**DCL       965--REDEF
DQH.MBX$
       973**DCL       974--REDEF
DQH.MPC$
       969**DCL      1157>>IF       1176>>ASSIGN
DQH.STATE
       966**DCL      1129>>IF       1157>>IF
DQH$
       898**DCL       962--IMP-PTR  1128<<ASSIGN   1129>>IF       1129>>IF       1145>>ASSIGN   1146>>ASSIGN
      1151>>CALL     1156<<ASSIGN   1157>>IF       1157>>IF       1174>>ASSIGN   1175>>ASSIGN   1176>>ASSIGN
      1179>>CALL
HFC$LOCK
        42**DCL-ENT  1051--CALL     1072--CALL     1112--CALL
HFC$UNLOCK
        42**DCL-ENT  1185--CALL
N$DCT$$
       454**DCL       588--IMP-PTR
N$FQ$
       454**DCL       589--IMP-PTR
N$REQ_INIT.BUFADDR
       473**DCL       474--REDEF     474--REDEF
N$REQ_INIT.DLA.DRELADDR
       465**DCL       465--REDEF
N$REQ_INIT.DVE.EOMCHAR
       502**DCL       503--REDEF
N$REQ_INIT.EAINFO
       496**DCL       496--REDEF
N$REQ_INIT.EAINFOX
       496**DCL       497--REDEF
N$REQ_INIT.EVNTINFO
       497**DCL       497--REDEF
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:32   
N$REQ_INIT.STATUS
       478**DCL       484--REDEF
NEWSTATE
       887**DCL        25--PROC     1053>>ASSIGN
NI$FQ$
       514**DCL       590--IMP-PTR
NI$IBUF$
       514**DCL       590--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
       524**DCL       525--REDEF     525--REDEF
NI$IMXMBX_INIT.SIZE
       526**DCL       526--REDEF
NI$REQ_INIT.DCW
       548**DCL       551--REDEF
NI$REQ_INIT.DCW.TALLY
       549**DCL       549--REDEF
NI$REQ_INIT.IDCW.EXTA
       551**DCL       551--REDEF
NI$REQ_INIT.PCW
       553**DCL       557--REDEF
NI$REQ_INIT.SEEK
       558**DCL       559--REDEF     560--REDEF
NI$RP$
       562**DCL       592--IMP-PTR
NIM$DEQUEUE
       617**DCL-ENT  1121--CALL     1142--CALL     1171--CALL
NIM$ENQUEUE
       618**DCL-ENT  1084--CALL     1095--CALL     1133--CALL     1162--CALL
NIS$DRIVER
       892**DCL-ENT  1151--CALL     1179--CALL
NI_MBX_INIT.DCW.CONTROL.AE
       584**DCL       584--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
       580**DCL       580--REDEF
PAR
       888**DCL        25--PROC     1048--ASSIGN   1067--ENTRY    1068--ASSIGN   1109--ENTRY    1110--ASSIGN
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:33   
PMN$COLLECT
       893**DCL-ENT  1087--CALL     1098--CALL     1149--CALL     1150--CALL     1178--CALL
REQ
       985**DCL      1084<>CALL
REQ.BUFADDR
       994**DCL       995--REDEF     995--REDEF
REQ.DCT$
       986**DCL      1069>>ASSIGN
REQ.DLA.DRELADDR
       986**DCL       986--REDEF
REQ.DQH$
      1007**DCL      1125>>IF       1156>>ASSIGN
REQ.DVE.EOMCHAR
      1023**DCL      1024--REDEF
REQ.EAINFO
      1017**DCL      1017--REDEF
REQ.EAINFOX
      1017**DCL      1018--REDEF
REQ.EVNTINFO
      1018**DCL      1018--REDEF
REQ.FL$
       985**DCL      1078<<ASSIGN   1124>>ASSIGN
REQ.IOFLG.STOPMPC
       991**DCL      1157>>IF
REQ.IOFLG.SUSP
       990**DCL      1176>>IF
REQ.STATUS
       999**DCL      1005--REDEF
REQ$
       899**DCL       985--IMP-PTR  1068<<ASSIGN   1069>>ASSIGN   1078>>ASSIGN   1078>>ASSIGN   1079>>ASSIGN
      1084>>CALL     1124<<ASSIGN   1125>>IF       1142<>CALL     1145>>ASSIGN   1156>>ASSIGN   1157>>IF
      1171<>CALL     1174>>ASSIGN   1176>>IF
SCANAQ
      1115**LABEL    1100--GOTO
SCHED
      1091**LABEL    1054--GOTO     1088--GOTO
PL6.E3A0      #001=NIU$DEVSCHED File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:38 Page:34   
SQH.AQ$
      1044**DCL      1095<>CALL     1116>>DOWHILE  1121<>CALL     1183<<ASSIGN
SQH.DOOR
      1043**DCL      1043--REDEF
SQH.GATE
      1043**DCL      1051<>CALL     1072<>CALL     1112<>CALL     1185<>CALL
SQH$
       900**DCL      1043--IMP-PTR  1049<<ASSIGN   1051>>CALL     1070<<ASSIGN   1072>>CALL     1095>>CALL
      1110<<ASSIGN   1112>>CALL     1116>>DOWHILE  1121>>CALL     1183>>ASSIGN   1185>>CALL
SVDCT$
       901**DCL      1115<<ASSIGN   1133<>CALL     1162<>CALL     1183>>ASSIGN

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:35   
      168        1        /*T***********************************************************/
      169        2        /*T*                                                         */
      170        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      171        4        /*T*                                                         */
      172        5        /*T***********************************************************/
      173        6        NIU$SYMBLOCK: PROC(N$REQ,IDCW) ALTRET;
      174        7        /*
      175        8              Includes
      176        9        */
      177       10        %INCLUDE                CP_6_SUBS ;
      178      550        %INCLUDE                FM$GRAN ;
      179      619        %INCLUDE                HF_DATA_R ;
      180      662        %INCLUDE                NI_DATA_C ;
      181      775        %INCLUDE                NI_DATA_R ;
      182     1212        %INCLUDE                NI_MACROS_C ;
      183     1479        %INCLUDE                N_FC_C ;
      184     1516        %INCLUDE                NK_VFC_C ;
      185     1590        /*
      186     1591              Parameters
      187     1592        */
      188     1593    1   DCL 1 IDCW              ALIGNED PARAM,
      189     1594    1         2 DC1             UBIN(6) UNAL,
      190     1595    1         2 RTN             UBIN(6) UNAL,
      191     1596    1         2 DC2             UBIN(6) UNAL,
      192     1597    1         2 DC3             UBIN(6) UNAL,
      193     1598    1         2 CC              UBIN(6) UNAL,
      194     1599    1         2 DC4             UBIN(6) UNAL ;
      195     1600        %N$REQ                  ( NAME=N$REQ, STCLASS=PARAM ) ;
      196     1658        /*
      197     1659              Entries
      198     1660        */
      199     1661    1   DCL 1 NKF$VFU           ENTRY(3) ;
      200     1662        /*
      201     1663              Auto
      202     1664        */
      203     1665    1   DCL 1 IOS$              PTR ALIGNED AUTO ;
      204     1666    1   DCL 1 CHAR$             PTR ALIGNED AUTO ;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:36   
      205     1667    1   DCL 1 CHARX             UBIN WORD ALIGNED AUTO ;
      206     1668    1   DCL 1 CW$               PTR ALIGNED AUTO ;
      207     1669    1   DCL 1 DC                UBIN(6) ALIGNED AUTO ;
      208     1670    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
      209     1671        %DCW                    ( NAME=DCW, STCLASS=AUTO ) ;
      210     1701    1   DCL 1 DVT$              PTR ALIGNED AUTO ;
      211     1702    1   DCL 1 FILL$             PTR ALIGNED AUTO ;
      212     1703    1   DCL 1 I                 SBIN ALIGNED AUTO ;
      213     1704    1   DCL 1 ICP               UBIN ALIGNED AUTO ;
      214     1705    1   DCL 1 J                 SBIN ALIGNED AUTO ;
      215     1706    1   DCL 1 NFILL             SBIN ALIGNED AUTO ;
      216     1707    1   DCL 1 RCN               SBIN ALIGNED AUTO ;
      217     1708    1   DCL 1 REC$              PTR ALIGNED AUTO ;
      218     1709    1   DCL 1 TEMP$             PTR ALIGNED AUTO ;
      219     1710    1   DCL 1 TEMPBUF           CHAR(128) ALIGNED AUTO ;
      220     1711    1   DCL 1 TEMPFILL          SBIN ALIGNED AUTO ;
      221     1712        /*
      222     1713              Based
      223     1714        */
      224     1715    1   DCL 1 CTRL              BASED(N$REQ.BUF$) ALIGNED,
      225     1716    1         2 FREC            SBIN(12) UNAL,  /* FIRST RECORD                       */
      226     1717    1         2 LREC            SBIN(12) UNAL,  /* LAST RECORD                        */
      227     1718    1         2 CWX             SBIN(12) UNAL,  /* INDEX OF FIRST CONTROL WORD        */
      228     1719    1         2 NAVX            UBIN(18) UNAL,  /* NAVX PRESERVED FROM FM$GRAN        */
      229     1720    1         2 DC              UBIN(6) UNAL,   /* DEVICE COMMAND FOR CURRENT RECORD  */
      230     1721    1         2 *               BIT(2),
      231     1722    1         2 AVAIL           UBIN(10) UNAL;  /* AVAIL PRESERVED FROM FM$GRAN       */
      232     1723        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
      233     1771    1   DCL FILL                CHAR(NFILL) BASED ;
      234     1772        %FM$CON;
      235     1776        %FM$GRAN                ( BASED="BASED(N$REQ.BUF$)");
      236     1780    1   DCL GRAN(0:0) BIT(36) ALIGNED BASED(N$REQ.BUF$);
      237     1781        %NI$DVT                 ( NAME=NI$DVT, STCLASS="BASED(DVT$)" ) ;
      238     1788        %NI$REQ                 ( NAME=NI$REQ, STCLASS="BASED(IOS$)" ) ;
      239     1813    1   DCL 1 TEMP              CHAR(TEMPFILL) BASED ;
      240     1814    1   DCL 1 VFCCHAR           CHAR(1) BASED(REC$) ;
      241     1815        /*
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:37   
      242     1816              Constants
      243     1817        */
      244     1818    1   DCL ZFILL SBIN CONSTANT INIT(0);
      245     1819    1   DCL BFILL CHAR(4) CONSTANT INIT(' ');
      246     1820    1   DCL DFILL BIT(36) CONSTANT INIT('177177177177'O);
      247     1821    1   DCL PRINT_IDCW BIT(36) CONSTANT ALIGNED INIT('000100700600'O);
      248     1822        %EQU SYMB_GRAN = 1024;
      249     1823        %EJECT;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:38   
      250     1824    1           CTRL.CWX=FM$GRAN.NAVX+FM$GRAN.AVAIL;
      251     1825    1           CTRL.FREC=-1;
      252     1826    1           CTRL.LREC=-1;
      253     1827                /* DCW LIST (PRESENTLY FM$CON FORMAT) IS BUILT IN REVERSE ORDER;
      254     1828                   MUST BE RE-ORDERED */
      255     1829    2           DO I=1 TO (%SYMB_GRAN-CTRL.CWX)/2;
      256     1830    2              DCW=GRAN(CTRL.CWX-1+I);
      257     1831    2              GRAN(CTRL.CWX-1+I)=GRAN(%SYMB_GRAN-I);
      258     1832    2              GRAN(%SYMB_GRAN-I)=DCW;
      259     1833    2              END;
      260     1834        %EJECT;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:39   
      261     1835    1   NIU$CONTSYMB: ENTRY(N$REQ,IDCW) ALTRET;
      262     1836    1           IOS$=N$REQ.IOS$;
      263     1837    1           DCT$=N$DCT$(N$REQ.DLA.DCTX);
      264     1838    1           DVT$ = DCT.DVT$;
      265     1839    1           TEMP$ = ADDR(TEMPBUF);
      266     1840    1           IF N$REQ.ARCT=0 THEN N$REQ.ARCT=1;
      267     1841    1           RCN=N$REQ.ARCT-1;
      268     1842    1           IF RCN<CTRL.FREC THEN ALTRETURN;
      269     1843    2           IF RCN>CTRL.LREC THEN DO;
      270     1844    2              IF RCN+CTRL.CWX>%SYMB_GRAN-1 THEN ALTRETURN;
      271     1845    2              CTRL.FREC=RCN;
      272     1846    2              IF CTRL.CWX+RCN+63>%SYMB_GRAN THEN
      273     1847    2                 CTRL.LREC=%SYMB_GRAN-1-CTRL.CWX;
      274     1848    2              ELSE CTRL.LREC=RCN+62;
      275     1849    2              I=RCN;
      276     1850    2              CALL GETDC ALTRET(ALT);
      277     1851    2              CTRL.DC=DC;
      278     1852    2              GRAN(I+CTRL.CWX)=DCW;
      279     1853    3              DO WHILE(I<CTRL.LREC);
      280     1854    3                 I=I+1;
      281     1855    3                 CALL GETDC ALTRET(NEW_DC);
      282     1856    3                 IF DC~=CTRL.DC THEN GOTO NEW_DC;
      283     1857    3                 GRAN(I+CTRL.CWX)=DCW;
      284     1858    3                 END;
      285     1859    2              I=I+1;
      286     1860    2   NEW_DC:    ;
      287     1861    2              CTRL.LREC=I-1;
      288     1862    2              END;
      289     1863    1           NI$REQ.IDCW(0)=PRINT_IDCW;
      290     1864    1           NI$REQ.IDCW.DC(0)=CTRL.DC;
      291     1865    1           NI$REQ.IDCW.RCNT(0)=CTRL.LREC-RCN+1;
      292     1866    2           IF HW_IMX THEN DO;
      293     1867    2              NI$REQ.IDCW.DATA.BASE(0)=%IMX_BUF_BASE;
      294     1868    2              NI$REQ.DCW(1)=%TDCWM1;
      295     1869    2              NI$REQ.DCW.T.DCWLIST.BASE(1)=%IMX_BUF_BASE;
      296     1870    2              NI$REQ.DCW.FWA(1)=RCN+CTRL.CWX+N$REQ.BUFVIRT.BYT/4;
      297     1871    2              END;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:40   
      298     1872    2           ELSE DO;
      299     1873    2              NI$REQ.DCW(1)=%TDCWM4;
      300     1874    2              NI$REQ.DCW.FWA(1)=N$REQ.BUFREAL.ADR+RCN+CTRL.CWX;
      301     1875    2              END;
      302     1876    1           IF N$REQ.STATUS.MAJOR=0 AND NOT N$REQ.STATUS.IOM THEN
      303     1877    1              N$REQ.ERRCT=0;
      304     1878    1           N$REQ.TIMOUT=10+NI$REQ.IDCW.RCNT(0)/2;
      305     1879    1           N$REQ.IOFLG.LPW23='1'B;
      306     1880    1           N$REQ.LPWX.BASE=N$REQ.BUFVIRT.BASE;
      307     1881    1           N$REQ.LPWX.BOUND = %SYMB_GRAN +1; /* Kludge for IMX_C bug */
      308     1882    2           IF NOT HW_IMX THEN DO;
      309     1883    2              NI$REQ.PCW='0000007'O;
      310     1884    2              NI$REQ.PCW.FLAGS='600'O;
      311     1885    2              END;
      312     1886    1           IF HW_IOP THEN
      313     1887    1              NI$REQ.IOP_PTAW=BINBIT(N$REQ.PTP,27)|%IOP_PTA1_INIT; /* PHYSADDR */
      314     1888    1           ELSE IF NOT HW_IMX THEN
      315     1889    1                 NI$REQ.PCW.PTP=N$REQ.PTP;
      316     1890    1           RETURN;
      317     1891    1   ALT:
      318     1892    1           ALTRETURN;
      319     1893        %EJECT;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:41   
      320     1894    1   GETDC:  PROC ALTRET;
      321     1895    2   TOP:
      322     1896    2           CW$=ADDR(GRAN(CTRL.CWX+I));
      323     1897    2           REC$=ADDR(GRAN(CW$->FM$CON.GX));
      324     1898    3           DO CASE(NI$DVT.TYPE);
      325     1899    3            CASE(%DV_LP);
      326     1900    3              ICP=0;
      327     1901    4              IF CW$->FM$CON.CTL & %DVBYTE_BP# THEN DO;
      328     1902    5                 IF VFCCHAR=%VFC_VFU OR VFCCHAR=%VFC_LCHN THEN DO;
      329     1903    5                    IF VFCCHAR = %VFC_VFU
      330     1904    5                    THEN CHARX = 1;
      331     1905    5                    ELSE CHARX = 2;
      332     1906    6                    IF I = RCN THEN DO CASE(CHARX);
      333     1907    6                     CASE(1);              /* %VFC_VFU */
      334     1908    6                       CALL NKF$VFU(PINCRC(REC$,1)->VFCCHAR,TEMP$->VFCCHAR,J);
      335     1909    6                       NFILL = DCT.LP.VFCL * 4;
      336     1910    6                       TEMPFILL = J * 4;
      337     1911    7                       IF TEMP$->TEMP = DCT.LP.VFC$->FILL THEN DO;
      338     1912    7                          IF RCN = %SYMB_GRAN-1 - CTRL.CWX
      339     1913    7                          THEN ALTRETURN;
      340     1914    8                          ELSE DO;
      341     1915    8                             RCN = RCN + 1;
      342     1916    8                             I = RCN;
      343     1917    8                             N$REQ.ARCT = N$REQ.ARCT + 1;
      344     1918    8                             GOTO TOP;
      345     1919    8                             END;          /* ELSE */
      346     1920    7                          END;             /* IF TEMP = VFC$->FILL */
      347     1921    7                       ELSE DO;
      348     1922    7                          DCT.LP.VFCL = J;
      349     1923    7                          NFILL = TEMPFILL;
      350     1924    7                          DCT.LP.VFC$->FILL = TEMP$->TEMP;
      351     1925    7                          REC$->FILL = DCT.LP.VFC$->FILL;
      352     1926    7                          CW$->FM$CON.GACTB = NFILL;
      353     1927    7                          FILL$ = ADDR(ZFILL);
      354     1928    7                          DC = IDCW.DC3;
      355     1929    7                          END;             /* ELSE */
      356     1930    6                     CASE(2);              /* %VFC_LCHN */
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:42   
      357     1931    6                       NFILL = 60 * 4;     /* CHAIN IMAGE = 60 WORDS */
      358     1932    7                       IF PINCRC(REC$,1)->FILL = DCT.LP.CHAIN$->FILL THEN DO;
      359     1933    7                          IF RCN = %SYMB_GRAN-1 - CTRL.CWX
      360     1934    7                          THEN ALTRETURN;
      361     1935    8                          ELSE DO;
      362     1936    8                             RCN = RCN + 1;
      363     1937    8                             I = RCN;
      364     1938    8                             N$REQ.ARCT = N$REQ.ARCT + 1;
      365     1939    8                             GOTO TOP;
      366     1940    8                             END;          /* ELSE */
      367     1941    7                          END;             /* IF FILL = FILL */
      368     1942    7                       ELSE DO;
      369     1943    7                          DCT.LP.CHAIN$->FILL = PINCRC(REC$,1)->FILL;
      370     1944    7                          REC$->FILL = DCT.LP.CHAIN$->FILL;
      371     1945    7                          CW$->FM$CON.GACTB = NFILL;
      372     1946    7                          FILL$ = ADDR(ZFILL);
      373     1947    7                          DC = IDCW.DC4;
      374     1948    7                          END;             /* ELSE */
      375     1949    6                     END;                  /* DO CASE(CHARX) */
      376     1950    5                    ELSE ALTRETURN;
      377     1951    5                    END;
      378     1952    5                 ELSE DO;
      379     1953    5                    DC = IDCW.DC2;
      380     1954    5                    FILL$=ADDR(DFILL);
      381     1955    5                    END;
      382     1956    4                 END;
      383     1957    4              ELSE DO;
      384     1958    4                 DC = IDCW.DC1;
      385     1959    4                 FILL$=ADDR(BFILL);
      386     1960    4                 END;
      387     1961    3            CASE(%DV_CP);
      388     1962    4              IF CW$->FM$CON.CTL & %DVBYTE_BIN# THEN DO;
      389     1963    4                 DC = IDCW.DC2;
      390     1964    4                 FILL$=ADDR(ZFILL);
      391     1965    4                 END;
      392     1966    4              ELSE DO;
      393     1967    4                 DC = IDCW.DC1;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:43   
      394     1968    4                 FILL$=ADDR(BFILL);
      395     1969    4                 END;
      396     1970    3              ICP=0;
      397     1971    3            END;
      398     1972                                                /* CONVERT FM$CON TO DCW */
      399     1973    2           DCW=%IOTDDCW;
      400     1974    2           DCW.FWA=CW$->FM$CON.GX;
      401     1975    2           DCW.TALLY=(CW$->FM$CON.GACTB+3)/4;
      402     1976    2           IF DCW.TALLY>64 THEN DCW.TALLY=64;
      403     1977    2           DCW.ICP=ICP;
      404     1978    2           NFILL=3-MOD(CW$->FM$CON.GACTB-1,4);
      405     1979    3           IF NFILL>0 THEN DO;
      406     1980    3              CHAR$=PINCRC(REC$,CW$->FM$CON.GACTB);
      407     1981    3              CHAR$->FILL=FILL$->FILL;
      408     1982    3              END;
      409     1983    2           RETURN;
      410     1984    2   END GETDC;
      411     1985    1   END NIU$SYMBLOCK;
      412     1986        %EOD;

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:44   
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FM$GRAN.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure NIU$SYMBLOCK.

   Procedure NIU$SYMBLOCK requires 524 words for executable code.
   Procedure NIU$SYMBLOCK requires 60 words of local(AUTO) storage.

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:45   

 Object Unit name= NIU$SYMBLOCK                               File name= NIU$UNIT.:E05TOU
 UTS= JUL 30 '97 03:39:03.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      8     10  NIU$SYMBLOCK
    1   Proc  even  none   524   1014  NIU$SYMBLOCK
    2  RoData even  none     6      6  NIU$SYMBLOCK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  NIU$SYMBLOCK
     1     65          yes     yes      Std        2  NIU$CONTSYMB

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 NKF$VFU
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:46   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     HW_IOP                                HW_IMX                                N$DCT$$
     N$FQ$                                 NI$FQ$                                NI$IBUF$
     NI$RP$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:47   


      168        1        /*T***********************************************************/
      169        2        /*T*                                                         */
      170        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      171        4        /*T*                                                         */
      172        5        /*T***********************************************************/
      173        6        NIU$SYMBLOCK: PROC(N$REQ,IDCW) ALTRET;

      6  1 000000   000000 700200 xent  NIU$SYMBLOCK TSX0  ! X66_AUTO_2
         1 000001   000074 000002                    ZERO    60,2

      174        7        /*
      175        8              Includes
      176        9        */
      177       10        %INCLUDE                CP_6_SUBS ;
      178      550        %INCLUDE                FM$GRAN ;
      179      619        %INCLUDE                HF_DATA_R ;
      180      662        %INCLUDE                NI_DATA_C ;
      181      775        %INCLUDE                NI_DATA_R ;
      182     1212        %INCLUDE                NI_MACROS_C ;
      183     1479        %INCLUDE                N_FC_C ;
      184     1516        %INCLUDE                NK_VFC_C ;
      185     1590        /*
      186     1591              Parameters
      187     1592        */
      188     1593    1   DCL 1 IDCW              ALIGNED PARAM,
      189     1594    1         2 DC1             UBIN(6) UNAL,
      190     1595    1         2 RTN             UBIN(6) UNAL,
      191     1596    1         2 DC2             UBIN(6) UNAL,
      192     1597    1         2 DC3             UBIN(6) UNAL,
      193     1598    1         2 CC              UBIN(6) UNAL,
      194     1599    1         2 DC4             UBIN(6) UNAL ;
      195     1600        %N$REQ                  ( NAME=N$REQ, STCLASS=PARAM ) ;
      196     1658        /*
      197     1659              Entries
      198     1660        */
      199     1661    1   DCL 1 NKF$VFU           ENTRY(3) ;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:48   
      200     1662        /*
      201     1663              Auto
      202     1664        */
      203     1665    1   DCL 1 IOS$              PTR ALIGNED AUTO ;
      204     1666    1   DCL 1 CHAR$             PTR ALIGNED AUTO ;
      205     1667    1   DCL 1 CHARX             UBIN WORD ALIGNED AUTO ;
      206     1668    1   DCL 1 CW$               PTR ALIGNED AUTO ;
      207     1669    1   DCL 1 DC                UBIN(6) ALIGNED AUTO ;
      208     1670    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
      209     1671        %DCW                    ( NAME=DCW, STCLASS=AUTO ) ;
      210     1701    1   DCL 1 DVT$              PTR ALIGNED AUTO ;
      211     1702    1   DCL 1 FILL$             PTR ALIGNED AUTO ;
      212     1703    1   DCL 1 I                 SBIN ALIGNED AUTO ;
      213     1704    1   DCL 1 ICP               UBIN ALIGNED AUTO ;
      214     1705    1   DCL 1 J                 SBIN ALIGNED AUTO ;
      215     1706    1   DCL 1 NFILL             SBIN ALIGNED AUTO ;
      216     1707    1   DCL 1 RCN               SBIN ALIGNED AUTO ;
      217     1708    1   DCL 1 REC$              PTR ALIGNED AUTO ;
      218     1709    1   DCL 1 TEMP$             PTR ALIGNED AUTO ;
      219     1710    1   DCL 1 TEMPBUF           CHAR(128) ALIGNED AUTO ;
      220     1711    1   DCL 1 TEMPFILL          SBIN ALIGNED AUTO ;
      221     1712        /*
      222     1713              Based
      223     1714        */
      224     1715    1   DCL 1 CTRL              BASED(N$REQ.BUF$) ALIGNED,
      225     1716    1         2 FREC            SBIN(12) UNAL,  /* FIRST RECORD                       */
      226     1717    1         2 LREC            SBIN(12) UNAL,  /* LAST RECORD                        */
      227     1718    1         2 CWX             SBIN(12) UNAL,  /* INDEX OF FIRST CONTROL WORD        */
      228     1719    1         2 NAVX            UBIN(18) UNAL,  /* NAVX PRESERVED FROM FM$GRAN        */
      229     1720    1         2 DC              UBIN(6) UNAL,   /* DEVICE COMMAND FOR CURRENT RECORD  */
      230     1721    1         2 *               BIT(2),
      231     1722    1         2 AVAIL           UBIN(10) UNAL;  /* AVAIL PRESERVED FROM FM$GRAN       */
      232     1723        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
      233     1771    1   DCL FILL                CHAR(NFILL) BASED ;
      234     1772        %FM$CON;
      235     1776        %FM$GRAN                ( BASED="BASED(N$REQ.BUF$)");
      236     1780    1   DCL GRAN(0:0) BIT(36) ALIGNED BASED(N$REQ.BUF$);
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:49   
      237     1781        %NI$DVT                 ( NAME=NI$DVT, STCLASS="BASED(DVT$)" ) ;
      238     1788        %NI$REQ                 ( NAME=NI$REQ, STCLASS="BASED(IOS$)" ) ;
      239     1813    1   DCL 1 TEMP              CHAR(TEMPFILL) BASED ;
      240     1814    1   DCL 1 VFCCHAR           CHAR(1) BASED(REC$) ;
      241     1815        /*
      242     1816              Constants
      243     1817        */
      244     1818    1   DCL ZFILL SBIN CONSTANT INIT(0);
      245     1819    1   DCL BFILL CHAR(4) CONSTANT INIT(' ');
      246     1820    1   DCL DFILL BIT(36) CONSTANT INIT('177177177177'O);
      247     1821    1   DCL PRINT_IDCW BIT(36) CONSTANT ALIGNED INIT('000100700600'O);
      248     1822        %EQU SYMB_GRAN = 1024;
      249     1823        %EJECT;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:50   
      250     1824    1           CTRL.CWX=FM$GRAN.NAVX+FM$GRAN.AVAIL;

   1824  1 000002   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000003   000005 471500                    LDP1    5,,PR0
         1 000004   100001 236100                    LDQ     1,,PR1
         1 000005   001777 376007                    ANQ     1023,DL
         1 000006   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000007   100001 236100                    LDQ     1,,PR1
         1 000010   000022 772000                    QRL     18
         1 000011   200070 036100                    ADLQ    TEMPFILL+3,,AUTO
         1 000012   100000 752103                    STCQ    0,'03'O,PR1

      251     1825    1           CTRL.FREC=-1;

   1825  1 000013   000005 471500                    LDP1    5,,PR0
         1 000014   777700 236003                    LDQ     -64,DU
         1 000015   100000 752160                    STCQ    0,'60'O,PR1

      252     1826    1           CTRL.LREC=-1;

   1826  1 000016   000005 471500                    LDP1    5,,PR0
         1 000017   000000 236000 2                  LDQ     0
         1 000020   100000 752114                    STCQ    0,'14'O,PR1

      253     1827                /* DCW LIST (PRESENTLY FM$CON FORMAT) IS BUILT IN REVERSE ORDER;
      254     1828                   MUST BE RE-ORDERED */
      255     1829    2           DO I=1 TO (%SYMB_GRAN-CTRL.CWX)/2;

   1829  1 000021   000001 235007                    LDA     1,DL
         1 000022   200016 755100                    STA     I,,AUTO
         1 000023   000053 710000 1                  TRA     s:1833+1

      256     1830    2              DCW=GRAN(CTRL.CWX-1+I);

   1830  1 000024   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000025   000005 471500                    LDP1    5,,PR0
         1 000026   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:51   
         1 000027   000030 736000                    QLS     24
         1 000030   000030 732000                    QRS     24
         1 000031   200016 036100                    ADLQ    I,,AUTO
         1 000032   177777 236106                    LDQ     -1,QL,PR1
         1 000033   200013 756100                    STQ     DCW,,AUTO

      257     1831    2              GRAN(CTRL.CWX-1+I)=GRAN(%SYMB_GRAN-I);

   1831  1 000034   100000 236100                    LDQ     0,,PR1
         1 000035   000030 736000                    QLS     24
         1 000036   000030 732000                    QRS     24
         1 000037   200016 036100                    ADLQ    I,,AUTO
         1 000040   200016 720100                    LXL0    I,,AUTO
         1 000041   777777 620010                    EAX0    -1,X0
         1 000042   777777 660003                    ERX0    -1,DU
         1 000043   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000044   102000 236110                    LDQ     1024,X0,PR1
         1 000045   200070 721100                    LXL1    TEMPFILL+3,,AUTO
         1 000046   177777 756111                    STQ     -1,X1,PR1

      258     1832    2              GRAN(%SYMB_GRAN-I)=DCW;

   1832  1 000047   000005 471500                    LDP1    5,,PR0
         1 000050   200013 236100                    LDQ     DCW,,AUTO
         1 000051   102000 756110                    STQ     1024,X0,PR1

      259     1833    2              END;

   1833  1 000052   200016 054100                    AOS     I,,AUTO
         1 000053   000005 471500                    LDP1    5,,PR0
         1 000054   100000 236100                    LDQ     0,,PR1
         1 000055   000030 736000                    QLS     24
         1 000056   000030 732000                    QRS     24
         1 000057   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000060   002001 036007                    ADLQ    1025,DL
         1 000061   000002 506007                    DIV     2,DL
         1 000062   200016 116100                    CMPQ    I,,AUTO
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:52   
         1 000063   000024 605000 1                  TPL     s:1830
         1 000064   000067 710000 1                  TRA     s:1836

      260     1834        %EJECT;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:53   
      261     1835    1   NIU$CONTSYMB: ENTRY(N$REQ,IDCW) ALTRET;

   1835  1 000065   000000 700200 xent  NIU$CONTSYMB TSX0  ! X66_AUTO_2
         1 000066   000074 000002                    ZERO    60,2

      262     1836    1           IOS$=N$REQ.IOS$;

   1836  1 000067   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000070   000012 236100                    LDQ     10,,PR0
         1 000071   200005 756100                    STQ     IOS$,,AUTO

      263     1837    1           DCT$=N$DCT$(N$REQ.DLA.DCTX);

   1837  1 000072   000001 236100                    LDQ     1,,PR0
         1 000073   000025 772000                    QRL     21
         1 000074   000000 471400 xsym               LDP1    N$DCT$$
         1 000075   100000 236106                    LDQ     0,QL,PR1
         1 000076   200012 756100                    STQ     DCT$,,AUTO

      264     1838    1           DVT$ = DCT.DVT$;

   1838  1 000077   200012 473500                    LDP3    DCT$,,AUTO
         1 000100   300024 236100                    LDQ     20,,PR3
         1 000101   200014 756100                    STQ     DVT$,,AUTO

      265     1839    1           TEMP$ = ADDR(TEMPBUF);

   1839  1 000102   200025 634500                    EPPR4   TEMPBUF,,AUTO
         1 000103   200024 454500                    STP4    TEMP$,,AUTO

      266     1840    1           IF N$REQ.ARCT=0 THEN N$REQ.ARCT=1;

   1840  1 000104   000030 220100                    LDX0    24,,PR0
         1 000105   000110 601000 1                  TNZ     s:1841

   1840  1 000106   000001 221003                    LDX1    1,DU
         1 000107   000030 741100                    STX1    24,,PR0
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:54   

      267     1841    1           RCN=N$REQ.ARCT-1;

   1841  1 000110   000030 236100                    LDQ     24,,PR0
         1 000111   000022 732000                    QRS     18
         1 000112   000001 136007                    SBLQ    1,DL
         1 000113   200022 756100                    STQ     RCN,,AUTO

      268     1842    1           IF RCN<CTRL.FREC THEN ALTRETURN;

   1842  1 000114   000005 475500                    LDP5    5,,PR0
         1 000115   500000 236100                    LDQ     0,,PR5
         1 000116   000030 732000                    QRS     24
         1 000117   200022 116100                    CMPQ    RCN,,AUTO
         1 000120   000122 604400 1                  TMOZ    s:1843

   1842  1 000121   000000 702200 xent               TSX2  ! X66_AALT

      269     1843    2           IF RCN>CTRL.LREC THEN DO;

   1843  1 000122   500000 236100                    LDQ     0,,PR5
         1 000123   000014 736000                    QLS     12
         1 000124   000030 732000                    QRS     24
         1 000125   200022 116100                    CMPQ    RCN,,AUTO
         1 000126   000257 605000 1                  TPL     s:1863

      270     1844    2              IF RCN+CTRL.CWX>%SYMB_GRAN-1 THEN ALTRETURN;

   1844  1 000127   500000 236100                    LDQ     0,,PR5
         1 000130   000030 736000                    QLS     24
         1 000131   000030 732000                    QRS     24
         1 000132   200022 036100                    ADLQ    RCN,,AUTO
         1 000133   001777 116007                    CMPQ    1023,DL
         1 000134   000136 604400 1                  TMOZ    s:1845

   1844  1 000135   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:55   
      271     1845    2              CTRL.FREC=RCN;

   1845  1 000136   200022 236100                    LDQ     RCN,,AUTO
         1 000137   000030 736000                    QLS     24
         1 000140   500000 752160                    STCQ    0,'60'O,PR5

      272     1846    2              IF CTRL.CWX+RCN+63>%SYMB_GRAN THEN

   1846  1 000141   000005 471500                    LDP1    5,,PR0
         1 000142   100000 236100                    LDQ     0,,PR1
         1 000143   000030 736000                    QLS     24
         1 000144   000030 732000                    QRS     24
         1 000145   200022 036100                    ADLQ    RCN,,AUTO
         1 000146   001701 116007                    CMPQ    961,DL
         1 000147   000160 604400 1                  TMOZ    s:1848

      273     1847    2                 CTRL.LREC=%SYMB_GRAN-1-CTRL.CWX;

   1847  1 000150   100000 236100                    LDQ     0,,PR1
         1 000151   000030 736000                    QLS     24
         1 000152   000030 732000                    QRS     24
         1 000153   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000154   002000 036007                    ADLQ    1024,DL
         1 000155   000014 736000                    QLS     12
         1 000156   100000 752114                    STCQ    0,'14'O,PR1
         1 000157   000164 710000 1                  TRA     s:1849

      274     1848    2              ELSE CTRL.LREC=RCN+62;

   1848  1 000160   200022 236100                    LDQ     RCN,,AUTO
         1 000161   000076 036007                    ADLQ    62,DL
         1 000162   000014 736000                    QLS     12
         1 000163   100000 752114                    STCQ    0,'14'O,PR1

      275     1849    2              I=RCN;

   1849  1 000164   200022 235100                    LDA     RCN,,AUTO
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:56   
         1 000165   200016 755100                    STA     I,,AUTO

      276     1850    2              CALL GETDC ALTRET(ALT);

   1850  1 000166   000414 701000 1                  TSX1    GETDC
         1 000167   000413 702000 1                  TSX2    ALT

      277     1851    2              CTRL.DC=DC;

   1851  1 000170   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000171   000005 471500                    LDP1    5,,PR0
         1 000172   200011 236100                    LDQ     DC,,AUTO
         1 000173   000022 772000                    QRL     18
         1 000174   100001 752104                    STCQ    1,'04'O,PR1

      278     1852    2              GRAN(I+CTRL.CWX)=DCW;

   1852  1 000175   000005 471500                    LDP1    5,,PR0
         1 000176   100000 236100                    LDQ     0,,PR1
         1 000177   000030 736000                    QLS     24
         1 000200   000030 732000                    QRS     24
         1 000201   200016 036100                    ADLQ    I,,AUTO
         1 000202   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000203   200013 236100                    LDQ     DCW,,AUTO
         1 000204   200070 720100                    LXL0    TEMPFILL+3,,AUTO
         1 000205   100000 756110                    STQ     0,X0,PR1

      279     1853    3              DO WHILE(I<CTRL.LREC);

   1853  1 000206   000005 471500                    LDP1    5,,PR0
         1 000207   100000 236100                    LDQ     0,,PR1
         1 000210   000014 736000                    QLS     12
         1 000211   000030 732000                    QRS     24
         1 000212   200016 116100                    CMPQ    I,,AUTO
         1 000213   000250 604400 1                  TMOZ    s:1859

      280     1854    3                 I=I+1;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:57   

   1854  1 000214   200016 054100                    AOS     I,,AUTO

      281     1855    3                 CALL GETDC ALTRET(NEW_DC);

   1855  1 000215   000414 701000 1                  TSX1    GETDC
         1 000216   000251 702000 1                  TSX2    NEW_DC

      282     1856    3                 IF DC~=CTRL.DC THEN GOTO NEW_DC;

   1856  1 000217   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000220   000005 471500                    LDP1    5,,PR0
         1 000221   100001 236100                    LDQ     1,,PR1
         1 000222   000014 772000                    QRL     12
         1 000223   000077 376007                    ANQ     63,DL
         1 000224   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000225   200011 236100                    LDQ     DC,,AUTO
         1 000226   000036 772000                    QRL     30
         1 000227   200070 116100                    CMPQ    TEMPFILL+3,,AUTO
         1 000230   000251 601000 1                  TNZ     NEW_DC

      283     1857    3                 GRAN(I+CTRL.CWX)=DCW;

   1857  1 000231   000005 471500                    LDP1    5,,PR0
         1 000232   100000 236100                    LDQ     0,,PR1
         1 000233   000030 736000                    QLS     24
         1 000234   000030 732000                    QRS     24
         1 000235   200016 036100                    ADLQ    I,,AUTO
         1 000236   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000237   200013 236100                    LDQ     DCW,,AUTO
         1 000240   200070 720100                    LXL0    TEMPFILL+3,,AUTO
         1 000241   100000 756110                    STQ     0,X0,PR1

      284     1858    3                 END;

   1858  1 000242   000005 471500                    LDP1    5,,PR0
         1 000243   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:58   
         1 000244   000014 736000                    QLS     12
         1 000245   000030 732000                    QRS     24
         1 000246   200016 116100                    CMPQ    I,,AUTO
         1 000247   000214 605400 1                  TPNZ    s:1854

      285     1859    2              I=I+1;

   1859  1 000250   200016 054100                    AOS     I,,AUTO

   1859  1 000251                       NEW_DC       null
      286     1860    2   NEW_DC:    ;
      287     1861    2              CTRL.LREC=I-1;

   1861  1 000251   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000252   000005 471500                    LDP1    5,,PR0
         1 000253   200016 236100                    LDQ     I,,AUTO
         1 000254   000001 136007                    SBLQ    1,DL
         1 000255   000014 736000                    QLS     12
         1 000256   100000 752114                    STCQ    0,'14'O,PR1

      288     1862    2              END;

      289     1863    1           NI$REQ.IDCW(0)=PRINT_IDCW;

   1863  1 000257   000003 236000 0                  LDQ     PRINT_IDCW
         1 000260   200005 471500                    LDP1    IOS$,,AUTO
         1 000261   100002 756100                    STQ     2,,PR1

      290     1864    1           NI$REQ.IDCW.DC(0)=CTRL.DC;

   1864  1 000262   000005 473500                    LDP3    5,,PR0
         1 000263   300001 236100                    LDQ     1,,PR3
         1 000264   000022 736000                    QLS     18
         1 000265   100002 752140                    STCQ    2,'40'O,PR1

      291     1865    1           NI$REQ.IDCW.RCNT(0)=CTRL.LREC-RCN+1;

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:59   
   1865  1 000266   000005 473500                    LDP3    5,,PR0
         1 000267   300000 236100                    LDQ     0,,PR3
         1 000270   000014 736000                    QLS     12
         1 000271   000030 732000                    QRS     24
         1 000272   200022 136100                    SBLQ    RCN,,AUTO
         1 000273   000001 036007                    ADLQ    1,DL
         1 000274   100002 752101                    STCQ    2,'01'O,PR1

      292     1866    2           IF HW_IMX THEN DO;

   1866  1 000275   000000 234000 xsym               SZN     HW_IMX
         1 000276   000322 605000 1                  TPL     s:1873

      293     1867    2              NI$REQ.IDCW.DATA.BASE(0)=%IMX_BUF_BASE;

   1867  1 000277   000030 236003                    LDQ     24,DU
         1 000300   100002 256100                    ORSQ    2,,PR1

      294     1868    2              NI$REQ.DCW(1)=%TDCWM1;

   1868  1 000301   000004 236000 0                  LDQ     PRINT_IDCW+1
         1 000302   100003 756100                    STQ     3,,PR1

      295     1869    2              NI$REQ.DCW.T.DCWLIST.BASE(1)=%IMX_BUF_BASE;

   1869  1 000303   000300 236007                    LDQ     192,DL
         1 000304   100003 256100                    ORSQ    3,,PR1

      296     1870    2              NI$REQ.DCW.FWA(1)=RCN+CTRL.CWX+N$REQ.BUFVIRT.BYT/4;

   1870  1 000305   000005 473500                    LDP3    5,,PR0
         1 000306   300000 236100                    LDQ     0,,PR3
         1 000307   000030 736000                    QLS     24
         1 000310   000030 732000                    QRS     24
         1 000311   200022 036100                    ADLQ    RCN,,AUTO
         1 000312   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000313   000006 236100                    LDQ     6,,PR0
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:60   
         1 000314   000007 376007                    ANQ     7,DL
         1 000315   000002 772000                    QRL     2
         1 000316   200070 036100                    ADLQ    TEMPFILL+3,,AUTO
         1 000317   000000 620006                    EAX0    0,QL
         1 000320   100003 740100                    STX0    3,,PR1

      297     1871    2              END;

   1871  1 000321   000342 710000 1                  TRA     s:1876

      298     1872    2           ELSE DO;

      299     1873    2              NI$REQ.DCW(1)=%TDCWM4;

   1873  1 000322   000005 236000 0                  LDQ     PRINT_IDCW+2
         1 000323   100003 756100                    STQ     3,,PR1

      300     1874    2              NI$REQ.DCW.FWA(1)=N$REQ.BUFREAL.ADR+RCN+CTRL.CWX;

   1874  1 000324   000006 236100                    LDQ     6,,PR0
         1 000325   000002 772000                    QRL     2
         1 000326   777777 376007                    ANQ     -1,DL
         1 000327   200022 036100                    ADLQ    RCN,,AUTO
         1 000330   000005 473500                    LDP3    5,,PR0
         1 000331   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000332   300000 236100                    LDQ     0,,PR3
         1 000333   000030 736000                    QLS     24
         1 000334   000030 732000                    QRS     24
         1 000335   200071 756100                    STQ     TEMPFILL+4,,AUTO
         1 000336   200070 236100                    LDQ     TEMPFILL+3,,AUTO
         1 000337   200071 036100                    ADLQ    TEMPFILL+4,,AUTO
         1 000340   000000 620006                    EAX0    0,QL
         1 000341   100003 740100                    STX0    3,,PR1

      301     1875    2              END;

      302     1876    1           IF N$REQ.STATUS.MAJOR=0 AND NOT N$REQ.STATUS.IOM THEN
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:61   

   1876  1 000342   000014 236100                    LDQ     12,,PR0
         1 000343   170000 316003                    CANQ    61440,DU
         1 000344   000351 601000 1                  TNZ     s:1878
         1 000345   770000 316007                    CANQ    -4096,DL
         1 000346   000351 601000 1                  TNZ     s:1878

      303     1877    1              N$REQ.ERRCT=0;

   1877  1 000347   000000 236003                    LDQ     0,DU
         1 000350   000003 552140                    STBQ    3,'40'O,PR0

      304     1878    1           N$REQ.TIMOUT=10+NI$REQ.IDCW.RCNT(0)/2;

   1878  1 000351   100002 236100                    LDQ     2,,PR1
         1 000352   000077 376007                    ANQ     63,DL
         1 000353   000001 772000                    QRL     1
         1 000354   000012 036007                    ADLQ    10,DL
         1 000355   000022 736000                    QLS     18
         1 000356   000003 552120                    STBQ    3,'20'O,PR0

      305     1879    1           N$REQ.IOFLG.LPW23='1'B;

   1879  1 000357   020000 236007                    LDQ     8192,DL
         1 000360   000004 256100                    ORSQ    4,,PR0

      306     1880    1           N$REQ.LPWX.BASE=N$REQ.BUFVIRT.BASE;

   1880  1 000361   000006 236100                    LDQ     6,,PR0
         1 000362   000003 732000                    QRS     3
         1 000363   000000 620006                    EAX0    0,QL
         1 000364   000011 740100                    STX0    9,,PR0

      307     1881    1           N$REQ.LPWX.BOUND = %SYMB_GRAN +1; /* Kludge for IMX_C bug */

   1881  1 000365   002001 221003                    LDX1    1025,DU
         1 000366   000011 441100                    SXL1    9,,PR0
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:62   

      308     1882    2           IF NOT HW_IMX THEN DO;

   1882  1 000367   000000 234000 xsym               SZN     HW_IMX
         1 000370   000376 604000 1                  TMI     s:1886

      309     1883    2              NI$REQ.PCW='0000007'O;

   1883  1 000371   003100 060400                    CSL     bolr='003'O
         1 000372   000006 000025 0                  BDSC    PRINT_IDCW+3             by=0,bit=0,n=21
         1 000373   100012 000110                    BDSC    10,,PR1                  by=0,bit=0,n=72

      310     1884    2              NI$REQ.PCW.FLAGS='600'O;

   1884  1 000374   000600 236007                    LDQ     384,DL
         1 000375   100013 552104                    STBQ    11,'04'O,PR1

      311     1885    2              END;

      312     1886    1           IF HW_IOP THEN

   1886  1 000376   000000 234000 xsym               SZN     HW_IOP
         1 000377   000405 605000 1                  TPL     s:1888

      313     1887    1              NI$REQ.IOP_PTAW=BINBIT(N$REQ.PTP,27)|%IOP_PTA1_INIT; /* PHYSADDR */

   1887  1 000400   000007 236100                    LDQ     7,,PR0
         1 000401   000011 736000                    QLS     9
         1 000402   000007 276000 0                  ORQ     PRINT_IDCW+4
         1 000403   100001 756100                    STQ     1,,PR1
         1 000404   000412 710000 1                  TRA     s:1890

      314     1888    1           ELSE IF NOT HW_IMX THEN

   1888  1 000405   000000 234000 xsym               SZN     HW_IMX
         1 000406   000412 604000 1                  TMI     s:1890

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:63   
      315     1889    1                 NI$REQ.PCW.PTP=N$REQ.PTP;

   1889  1 000407   000007 236100                    LDQ     7,,PR0
         1 000410   000011 736000                    QLS     9
         1 000411   100013 552130                    STBQ    11,'30'O,PR1

      316     1890    1           RETURN;

   1890  1 000412   000000 702200 xent               TSX2  ! X66_ARET

      317     1891    1   ALT:
      318     1892    1           ALTRETURN;

   1892  1 000413   000000 702200 xent  ALT          TSX2  ! X66_AALT

      319     1893        %EJECT;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:64   
      320     1894    1   GETDC:  PROC ALTRET;

   1894  1 000414   200066 741300       GETDC        STX1  ! TEMPFILL+1,,AUTO

      321     1895    2   TOP:
      322     1896    2           CW$=ADDR(GRAN(CTRL.CWX+I));

   1896  1 000415   200003 470500       TOP          LDP0    @N$REQ,,AUTO
         1 000416   000005 471500                    LDP1    5,,PR0
         1 000417   100000 236100                    LDQ     0,,PR1
         1 000420   000030 736000                    QLS     24
         1 000421   000030 732000                    QRS     24
         1 000422   200016 036100                    ADLQ    I,,AUTO
         1 000423   100000 633506                    EPPR3   0,QL,PR1
         1 000424   200010 453500                    STP3    CW$,,AUTO

      323     1897    2           REC$=ADDR(GRAN(CW$->FM$CON.GX));

   1897  1 000425   300000 236100                    LDQ     0,,PR3
         1 000426   000014 772000                    QRL     12
         1 000427   001777 376007                    ANQ     1023,DL
         1 000430   100000 634506                    EPPR4   0,QL,PR1
         1 000431   200023 454500                    STP4    REC$,,AUTO

      324     1898    3           DO CASE(NI$DVT.TYPE);

   1898  1 000432   200014 475500                    LDP5    DVT$,,AUTO
         1 000433   500053 236100                    LDQ     43,,PR5
         1 000434   000033 772000                    QRL     27
         1 000435   000004 116007                    CMPQ    4,DL
         1 000436   000440 602006 1                  TNC     s:1898+6,QL
         1 000437   000736 710000 1                  TRA     s:1973
         1 000440   000736 710000 1                  TRA     s:1973
         1 000441   000736 710000 1                  TRA     s:1973
         1 000442   000710 710000 1                  TRA     s:1962
         1 000443   000444 710000 1                  TRA     s:1900

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:65   
      325     1899    3            CASE(%DV_LP);

      326     1900    3              ICP=0;

   1900  1 000444   200017 450100                    STZ     ICP,,AUTO

      327     1901    4              IF CW$->FM$CON.CTL & %DVBYTE_BP# THEN DO;

   1901  1 000445   300000 236100                    LDQ     0,,PR3
         1 000446   000004 736000                    QLS     4
         1 000447   776000 376003                    ANQ     -1024,DU
         1 000450   200000 376003                    ANQ     65536,DU
         1 000451   000700 600000 1                  TZE     s:1958

      328     1902    5                 IF VFCCHAR=%VFC_VFU OR VFCCHAR=%VFC_LCHN THEN DO;

   1902  1 000452   040000 106500                    CMPC    fill='040'O
         1 000453   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         1 000454   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000455   000462 600000 1                  TZE     s:1903
         1 000456   040000 106500                    CMPC    fill='040'O
         1 000457   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         1 000460   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000461   000667 601000 1                  TNZ     s:1953

      329     1903    5                    IF VFCCHAR = %VFC_VFU

   1903  1 000462   040000 106500                    CMPC    fill='040'O
         1 000463   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         1 000464   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000465   000471 601000 1                  TNZ     s:1905

      330     1904    5                    THEN CHARX = 1;

   1904  1 000466   000001 235007                    LDA     1,DL
         1 000467   200007 755100                    STA     CHARX,,AUTO
         1 000470   000473 710000 1                  TRA     s:1906
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:66   

      331     1905    5                    ELSE CHARX = 2;

   1905  1 000471   000002 235007                    LDA     2,DL
         1 000472   200007 755100                    STA     CHARX,,AUTO

      332     1906    6                    IF I = RCN THEN DO CASE(CHARX);

   1906  1 000473   200016 236100                    LDQ     I,,AUTO
         1 000474   200022 116100                    CMPQ    RCN,,AUTO
         1 000475   000665 601000 1                  TNZ     s:1950

   1906  1 000476   000003 115007                    CMPA    3,DL
         1 000477   000501 602005 1                  TNC     s:1906+6,AL
         1 000500   000736 710000 1                  TRA     s:1973
         1 000501   000664 710000 1                  TRA     s:1949
         1 000502   000504 710000 1                  TRA     s:1908
         1 000503   000612 710000 1                  TRA     s:1931

      333     1907    6                     CASE(1);              /* %VFC_VFU */

      334     1908    6                       CALL NKF$VFU(PINCRC(REC$,1)->VFCCHAR,TEMP$->VFCCHAR,J);

   1908  1 000504   200020 636500                    EPPR6   J,,AUTO
         1 000505   200072 456500                    STP6    TEMPFILL+5,,AUTO
         1 000506   200024 236100                    LDQ     TEMP$,,AUTO
         1 000507   200071 756100                    STQ     TEMPFILL+4,,AUTO
         1 000510   200023 236100                    LDQ     REC$,,AUTO
         1 000511   200000 036007                    ADLQ    65536,DL
         1 000512   200070 756100                    STQ     TEMPFILL+3,,AUTO
         1 000513   200070 630500                    EPPR0   TEMPFILL+3,,AUTO
         1 000514   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000515   000000 701000 xent               TSX1    NKF$VFU
         1 000516   000000 011000                    NOP     0

      335     1909    6                       NFILL = DCT.LP.VFCL * 4;

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:67   
   1909  1 000517   200012 470500                    LDP0    DCT$,,AUTO
         1 000520   000031 235100                    LDA     25,,PR0
         1 000521   000002 735000                    ALS     2
         1 000522   200021 755100                    STA     NFILL,,AUTO

      336     1910    6                       TEMPFILL = J * 4;

   1910  1 000523   200020 236100                    LDQ     J,,AUTO
         1 000524   000002 736000                    QLS     2
         1 000525   200065 756100                    STQ     TEMPFILL,,AUTO

      337     1911    7                       IF TEMP$->TEMP = DCT.LP.VFC$->FILL THEN DO;

   1911  1 000526   000030 471500                    LDP1    24,,PR0
         1 000527   200024 473500                    LDP3    TEMP$,,AUTO
         1 000530   000000 620006                    EAX0    0,QL
         1 000531   000000 621005                    EAX1    0,AL
         1 000532   040140 106540                    CMPC    fill='040'O
         1 000533   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000534   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 000535   000560 601000 1                  TNZ     s:1922

      338     1912    7                          IF RCN = %SYMB_GRAN-1 - CTRL.CWX

   1912  1 000536   200003 474500                    LDP4    @N$REQ,,AUTO
         1 000537   400005 475500                    LDP5    5,,PR4
         1 000540   500000 236100                    LDQ     0,,PR5
         1 000541   000030 736000                    QLS     24
         1 000542   000030 732000                    QRS     24
         1 000543   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000544   002000 036007                    ADLQ    1024,DL
         1 000545   200022 116100                    CMPQ    RCN,,AUTO
         1 000546   000551 601000 1                  TNZ     s:1915

      339     1913    7                          THEN ALTRETURN;

   1913  1 000547   200066 221300                    LDX1  ! TEMPFILL+1,,AUTO
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:68   
         1 000550   000000 702211                    TSX2  ! 0,X1

      340     1914    8                          ELSE DO;

      341     1915    8                             RCN = RCN + 1;

   1915  1 000551   200022 054100                    AOS     RCN,,AUTO

      342     1916    8                             I = RCN;

   1916  1 000552   200022 235100                    LDA     RCN,,AUTO
         1 000553   200016 755100                    STA     I,,AUTO

      343     1917    8                             N$REQ.ARCT = N$REQ.ARCT + 1;

   1917  1 000554   400030 220100                    LDX0    24,,PR4
         1 000555   000001 621010                    EAX1    1,X0
         1 000556   400030 741100                    STX1    24,,PR4

      344     1918    8                             GOTO TOP;

   1918  1 000557   000415 710000 1                  TRA     TOP

      345     1919    8                             END;          /* ELSE */
      346     1920    7                          END;             /* IF TEMP = VFC$->FILL */
      347     1921    7                       ELSE DO;

      348     1922    7                          DCT.LP.VFCL = J;

   1922  1 000560   200020 235100                    LDA     J,,AUTO
         1 000561   000031 755100                    STA     25,,PR0

      349     1923    7                          NFILL = TEMPFILL;

   1923  1 000562   200065 236100                    LDQ     TEMPFILL,,AUTO
         1 000563   200021 756100                    STQ     NFILL,,AUTO

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:69   
      350     1924    7                          DCT.LP.VFC$->FILL = TEMP$->TEMP;

   1924  1 000564   000000 620006                    EAX0    0,QL
         1 000565   200021 721100                    LXL1    NFILL,,AUTO
         1 000566   040140 100540                    MLR     fill='040'O
         1 000567   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000570   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      351     1925    7                          REC$->FILL = DCT.LP.VFC$->FILL;

   1925  1 000571   000030 471500                    LDP1    24,,PR0
         1 000572   200023 474500                    LDP4    REC$,,AUTO
         1 000573   040140 100540                    MLR     fill='040'O
         1 000574   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 000575   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1

      352     1926    7                          CW$->FM$CON.GACTB = NFILL;

   1926  1 000576   200010 471500                    LDP1    CW$,,AUTO
         1 000577   200021 236100                    LDQ     NFILL,,AUTO
         1 000600   100000 752103                    STCQ    0,'03'O,PR1

      353     1927    7                          FILL$ = ADDR(ZFILL);

   1927  1 000601   000003 236000 2                  LDQ     3
         1 000602   200015 756100                    STQ     FILL$,,AUTO

      354     1928    7                          DC = IDCW.DC3;

   1928  1 000603   200004 475500                    LDP5    @IDCW,,AUTO
         1 000604   500000 236100                    LDQ     0,,PR5
         1 000605   000014 772000                    QRL     12
         1 000606   000077 376007                    ANQ     63,DL
         1 000607   000036 736000                    QLS     30
         1 000610   200011 756100                    STQ     DC,,AUTO

      355     1929    7                          END;             /* ELSE */
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:70   

   1929  1 000611   000736 710000 1                  TRA     s:1973

      356     1930    6                     CASE(2);              /* %VFC_LCHN */

      357     1931    6                       NFILL = 60 * 4;     /* CHAIN IMAGE = 60 WORDS */

   1931  1 000612   000360 235007                    LDA     240,DL
         1 000613   200021 755100                    STA     NFILL,,AUTO

      358     1932    7                       IF PINCRC(REC$,1)->FILL = DCT.LP.CHAIN$->FILL THEN DO;

   1932  1 000614   200012 476500                    LDP6    DCT$,,AUTO
         1 000615   600032 477500                    LDP7    26,,PR6
         1 000616   000000 620005                    EAX0    0,AL
         1 000617   200021 721100                    LXL1    NFILL,,AUTO
         1 000620   040140 106540                    CMPC    fill='040'O
         1 000621   400000 200010                    ADSC9   0,,PR4                   cn=1,n=*X0
         1 000622   700000 000011                    ADSC9   0,,PR7                   cn=0,n=*X1
         1 000623   000644 601000 1                  TNZ     s:1943

      359     1933    7                          IF RCN = %SYMB_GRAN-1 - CTRL.CWX

   1933  1 000624   100000 236100                    LDQ     0,,PR1
         1 000625   000030 736000                    QLS     24
         1 000626   000030 732000                    QRS     24
         1 000627   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000630   002000 036007                    ADLQ    1024,DL
         1 000631   200022 116100                    CMPQ    RCN,,AUTO
         1 000632   000635 601000 1                  TNZ     s:1936

      360     1934    7                          THEN ALTRETURN;

   1934  1 000633   200066 221300                    LDX1  ! TEMPFILL+1,,AUTO
         1 000634   000000 702211                    TSX2  ! 0,X1

      361     1935    8                          ELSE DO;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:71   

      362     1936    8                             RCN = RCN + 1;

   1936  1 000635   200022 054100                    AOS     RCN,,AUTO

      363     1937    8                             I = RCN;

   1937  1 000636   200022 235100                    LDA     RCN,,AUTO
         1 000637   200016 755100                    STA     I,,AUTO

      364     1938    8                             N$REQ.ARCT = N$REQ.ARCT + 1;

   1938  1 000640   000030 220100                    LDX0    24,,PR0
         1 000641   000001 622010                    EAX2    1,X0
         1 000642   000030 742100                    STX2    24,,PR0

      365     1939    8                             GOTO TOP;

   1939  1 000643   000415 710000 1                  TRA     TOP

      366     1940    8                             END;          /* ELSE */
      367     1941    7                          END;             /* IF FILL = FILL */
      368     1942    7                       ELSE DO;

      369     1943    7                          DCT.LP.CHAIN$->FILL = PINCRC(REC$,1)->FILL;

   1943  1 000644   040140 100540                    MLR     fill='040'O
         1 000645   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         1 000646   700000 000011                    ADSC9   0,,PR7                   cn=0,n=*X1

      370     1944    7                          REC$->FILL = DCT.LP.CHAIN$->FILL;

   1944  1 000647   600032 471500                    LDP1    26,,PR6
         1 000650   040140 100540                    MLR     fill='040'O
         1 000651   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 000652   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:72   
      371     1945    7                          CW$->FM$CON.GACTB = NFILL;

   1945  1 000653   200021 236100                    LDQ     NFILL,,AUTO
         1 000654   300000 752103                    STCQ    0,'03'O,PR3

      372     1946    7                          FILL$ = ADDR(ZFILL);

   1946  1 000655   000003 236000 2                  LDQ     3
         1 000656   200015 756100                    STQ     FILL$,,AUTO

      373     1947    7                          DC = IDCW.DC4;

   1947  1 000657   200004 471500                    LDP1    @IDCW,,AUTO
         1 000660   100000 236100                    LDQ     0,,PR1
         1 000661   000077 376007                    ANQ     63,DL
         1 000662   000036 736000                    QLS     30
         1 000663   200011 756100                    STQ     DC,,AUTO

      374     1948    7                          END;             /* ELSE */

      375     1949    6                     END;                  /* DO CASE(CHARX) */

   1949  1 000664   000736 710000 1                  TRA     s:1973

      376     1950    5                    ELSE ALTRETURN;

   1950  1 000665   200066 221300                    LDX1  ! TEMPFILL+1,,AUTO
         1 000666   000000 702211                    TSX2  ! 0,X1

      377     1951    5                    END;
      378     1952    5                 ELSE DO;

      379     1953    5                    DC = IDCW.DC2;

   1953  1 000667   200004 476500                    LDP6    @IDCW,,AUTO
         1 000670   600000 236100                    LDQ     0,,PR6
         1 000671   000022 772000                    QRL     18
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:73   
         1 000672   000077 376007                    ANQ     63,DL
         1 000673   000036 736000                    QLS     30
         1 000674   200011 756100                    STQ     DC,,AUTO

      380     1954    5                    FILL$=ADDR(DFILL);

   1954  1 000675   000004 236000 2                  LDQ     4
         1 000676   200015 756100                    STQ     FILL$,,AUTO

      381     1955    5                    END;

      382     1956    4                 END;

   1956  1 000677   000736 710000 1                  TRA     s:1973

      383     1957    4              ELSE DO;

      384     1958    4                 DC = IDCW.DC1;

   1958  1 000700   200004 476500                    LDP6    @IDCW,,AUTO
         1 000701   600000 236100                    LDQ     0,,PR6
         1 000702   000036 772000                    QRL     30
         1 000703   000036 736000                    QLS     30
         1 000704   200011 756100                    STQ     DC,,AUTO

      385     1959    4                 FILL$=ADDR(BFILL);

   1959  1 000705   000005 236000 2                  LDQ     5
         1 000706   200015 756100                    STQ     FILL$,,AUTO

      386     1960    4                 END;

   1960  1 000707   000736 710000 1                  TRA     s:1973

      387     1961    3            CASE(%DV_CP);

      388     1962    4              IF CW$->FM$CON.CTL & %DVBYTE_BIN# THEN DO;
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:74   

   1962  1 000710   300000 236100                    LDQ     0,,PR3
         1 000711   000004 736000                    QLS     4
         1 000712   776000 376003                    ANQ     -1024,DU
         1 000713   040000 376003                    ANQ     16384,DU
         1 000714   000726 600000 1                  TZE     s:1967

      389     1963    4                 DC = IDCW.DC2;

   1963  1 000715   200004 476500                    LDP6    @IDCW,,AUTO
         1 000716   600000 236100                    LDQ     0,,PR6
         1 000717   000022 772000                    QRL     18
         1 000720   000077 376007                    ANQ     63,DL
         1 000721   000036 736000                    QLS     30
         1 000722   200011 756100                    STQ     DC,,AUTO

      390     1964    4                 FILL$=ADDR(ZFILL);

   1964  1 000723   000003 236000 2                  LDQ     3
         1 000724   200015 756100                    STQ     FILL$,,AUTO

      391     1965    4                 END;

   1965  1 000725   000735 710000 1                  TRA     s:1970

      392     1966    4              ELSE DO;

      393     1967    4                 DC = IDCW.DC1;

   1967  1 000726   200004 476500                    LDP6    @IDCW,,AUTO
         1 000727   600000 236100                    LDQ     0,,PR6
         1 000730   000036 772000                    QRL     30
         1 000731   000036 736000                    QLS     30
         1 000732   200011 756100                    STQ     DC,,AUTO

      394     1968    4                 FILL$=ADDR(BFILL);

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:75   
   1968  1 000733   000005 236000 2                  LDQ     5
         1 000734   200015 756100                    STQ     FILL$,,AUTO

      395     1969    4                 END;

      396     1970    3              ICP=0;

   1970  1 000735   200017 450100                    STZ     ICP,,AUTO

      397     1971    3            END;

      398     1972                                                /* CONVERT FM$CON TO DCW */
      399     1973    2           DCW=%IOTDDCW;

   1973  1 000736   000002 236000 xsym               LDQ     B_VECTNIL+2
         1 000737   200013 756100                    STQ     DCW,,AUTO

      400     1974    2           DCW.FWA=CW$->FM$CON.GX;

   1974  1 000740   200010 470500                    LDP0    CW$,,AUTO
         1 000741   000000 236100                    LDQ     0,,PR0
         1 000742   000014 772000                    QRL     12
         1 000743   001777 376007                    ANQ     1023,DL
         1 000744   000000 620006                    EAX0    0,QL
         1 000745   200013 740100                    STX0    DCW,,AUTO

      401     1975    2           DCW.TALLY=(CW$->FM$CON.GACTB+3)/4;

   1975  1 000746   000000 236100                    LDQ     0,,PR0
         1 000747   007777 376007                    ANQ     4095,DL
         1 000750   000003 036007                    ADLQ    3,DL
         1 000751   000002 772000                    QRL     2
         1 000752   200013 752103                    STCQ    DCW,'03'O,AUTO

      402     1976    2           IF DCW.TALLY>64 THEN DCW.TALLY=64;

   1976  1 000753   200013 236100                    LDQ     DCW,,AUTO
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:76   
         1 000754   007777 376007                    ANQ     4095,DL
         1 000755   000101 116007                    CMPQ    65,DL
         1 000756   000761 602000 1                  TNC     s:1977

   1976  1 000757   000100 236007                    LDQ     64,DL
         1 000760   200013 752103                    STCQ    DCW,'03'O,AUTO

      403     1977    2           DCW.ICP=ICP;

   1977  1 000761   200017 236100                    LDQ     ICP,,AUTO
         1 000762   000017 736000                    QLS     15
         1 000763   200013 676100                    ERQ     DCW,,AUTO
         1 000764   700000 376007                    ANQ     -32768,DL
         1 000765   200013 656100                    ERSQ    DCW,,AUTO

      404     1978    2           NFILL=3-MOD(CW$->FM$CON.GACTB-1,4);

   1978  1 000766   000000 236100                    LDQ     0,,PR0
         1 000767   007777 376007                    ANQ     4095,DL
         1 000770   000001 136007                    SBLQ    1,DL
         1 000771   000004 506007                    DIV     4,DL
         1 000772   000027 675000 xsym               ERA     B_VECTNIL+23
         1 000773   000004 035007                    ADLA    4,DL
         1 000774   200021 755100                    STA     NFILL,,AUTO

      405     1979    3           IF NFILL>0 THEN DO;

   1979  1 000775   001012 604400 1                  TMOZ    s:1983

      406     1980    3              CHAR$=PINCRC(REC$,CW$->FM$CON.GACTB);

   1980  1 000776   000000 236100                    LDQ     0,,PR0
         1 000777   007777 376007                    ANQ     4095,DL
         1 001000   000020 736000                    QLS     16
         1 001001   200023 036100                    ADLQ    REC$,,AUTO
         1 001002   200006 756100                    STQ     CHAR$,,AUTO

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:77   
      407     1981    3              CHAR$->FILL=FILL$->FILL;

   1981  1 001003   200015 471500                    LDP1    FILL$,,AUTO
         1 001004   000000 621005                    EAX1    0,AL
         1 001005   200006 473500                    LDP3    CHAR$,,AUTO
         1 001006   200021 722100                    LXL2    NFILL,,AUTO
         1 001007   040140 100540                    MLR     fill='040'O
         1 001010   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 001011   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

      408     1982    3              END;

      409     1983    2           RETURN;

   1983  1 001012   200066 221300                    LDX1  ! TEMPFILL+1,,AUTO
         1 001013   000001 702211                    TSX2  ! 1,X1

ZFILL
 Sect OctLoc
   0     000   000000 000000                                                    ....

BFILL
 Sect OctLoc
   0     001   040040 040040

DFILL
 Sect OctLoc
   0     002   177177 177177                                                    ....

PRINT_IDCW
 Sect OctLoc
   0     003   000100 700600                                                    .@..

(unnamed)
 Sect OctLoc
   0     004   000000 020000   000000 020005   000000 700000   000000 000100    ...............@

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:78   
(unnamed)
 Sect OctLoc
   2     000   000077 770000   033040 040040   034040 040040   000000 006000    .?...   .   ....
   2     004   000002 006000   000001 006000                                    ........
      410     1984    2   END GETDC;
      411     1985    1   END NIU$SYMBLOCK;
      412     1986        %EOD;

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:79   
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FM$GRAN.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure NIU$SYMBLOCK.
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:80   

 **** Variables and constants ****

  ****  Section 000 RoData NIU$SYMBLOCK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR(4)     r     1 BFILL                      2-0-0/b BIT         r     1 DFILL
     3-0-0/w BIT         r     1 PRINT_IDCW                 0-0-0/w SBIN        r     1 ZFILL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @IDCW                      3-0-0/w PTR         r     1 @N$REQ
     6-0-0/w PTR         r     1 CHAR$                      7-0-0/w UBIN        r     1 CHARX
    10-0-0/w PTR         r     1 CW$                       11-0-0/w UBIN(6)     r     1 DC
    12-0-0/w PTR         r     1 DCT$                      13-0-0/w STRC        r     1 DCW
    14-0-0/w PTR         r     1 DVT$                      15-0-0/w PTR         r     1 FILL$
    16-0-0/w SBIN        r     1 I                         17-0-0/w UBIN        r     1 ICP
    *0-0-0/w STRC        r     1 IDCW                       5-0-0/w PTR         r     1 IOS$
    20-0-0/w SBIN        r     1 J                         *0-0-0/d STRC(1080)  r     1 N$REQ
    21-0-0/w SBIN        r     1 NFILL                     22-0-0/w SBIN        r     1 RCN
    23-0-0/w PTR         r     1 REC$                      24-0-0/w PTR         r     1 TEMP$
    25-0-0/w CHAR(128)   r     1 TEMPBUF                   65-0-0/w SBIN        r     1 TEMPFILL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 HW_IMX                     0-0-0/w BIT         r     1 HW_IOP
     0-0-0/w PTR         r     1 N$DCT$$                    0-0-0/w PTR         r     1 N$FQ$
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
     0-0-0/w PTR         r     1 NI$RP$

PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:81   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 CTRL                       0-0-0/w STRC(1332)  r     1 DCT
     0-0-0/c ACHR        r     1 FILL                       0-0-0/w STRC        r     1 FM$CON
     0-0-0/w STRC(180)   r     1 FM$GRAN                    0-0-0/w BIT         r     1 GRAN(0:0)
     0-0-0/w PTR         r     1 N$DCT$(0:0)                0-0-0/w STRC(2844)  r     1 NI$DVT
     0-0-0/d STRC(504)   r     1 NI$REQ                     0-0-0/c ACHR        r     1 TEMP
     0-0-0/c CHAR        r     1 VFCCHAR


   Procedure NIU$SYMBLOCK requires 524 words for executable code.
   Procedure NIU$SYMBLOCK requires 60 words of local(AUTO) storage.
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:82   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:83   
          MINI XREF LISTING

ALT
      1892**LABEL    1850--CALLALT
BFILL
      1819**DCL      1959--ASSIGN   1968--ASSIGN
CHAR$
      1666**DCL      1980<<ASSIGN   1981>>ASSIGN
CHARX
      1667**DCL      1904<<ASSIGN   1905<<ASSIGN   1906>>DOCASE
CTRL.CWX
      1718**DCL      1824<<ASSIGN   1829>>DOINDEX  1830>>ASSIGN   1831>>ASSIGN   1844>>IF       1846>>IF
      1847>>ASSIGN   1852>>ASSIGN   1857>>ASSIGN   1870>>ASSIGN   1874>>ASSIGN   1896>>ASSIGN   1912>>IF
      1933>>IF
CTRL.DC
      1720**DCL      1851<<ASSIGN   1856>>IF       1864>>ASSIGN
CTRL.FREC
      1716**DCL      1825<<ASSIGN   1842>>IF       1845<<ASSIGN
CTRL.LREC
      1717**DCL      1826<<ASSIGN   1843>>IF       1847<<ASSIGN   1848<<ASSIGN   1853>>DOWHILE  1861<<ASSIGN
      1865>>ASSIGN
CW$
      1668**DCL      1896<<ASSIGN   1897>>ASSIGN   1901>>IF       1926>>ASSIGN   1945>>ASSIGN   1962>>IF
      1974>>ASSIGN   1975>>ASSIGN   1978>>ASSIGN   1980>>ASSIGN
DC
      1669**DCL      1851>>ASSIGN   1856>>IF       1928<<ASSIGN   1947<<ASSIGN   1953<<ASSIGN   1958<<ASSIGN
      1963<<ASSIGN   1967<<ASSIGN
DCT.DP
      1752**DCL      1759--REDEF    1762--REDEF    1763--REDEF    1765--REDEF    1765--REDEF    1766--REDEF
      1767--REDEF    1767--REDEF
DCT.DVT$
      1748**DCL      1838>>ASSIGN
DCT.LP.CHAIN$
      1762**DCL      1932>>IF       1943>>ASSIGN   1944>>ASSIGN
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:84   
DCT.LP.VFC$
      1762**DCL      1911>>IF       1924>>ASSIGN   1925>>ASSIGN
DCT.LP.VFCL
      1762**DCL      1909>>ASSIGN   1922<<ASSIGN
DCT.MPC.IOCHANX
      1760**DCL      1760--REDEF
DCT$
      1670**DCL      1732--IMP-PTR  1837<<ASSIGN   1838>>ASSIGN   1909>>ASSIGN   1911>>IF       1922>>ASSIGN
      1924>>ASSIGN   1925>>ASSIGN   1932>>IF       1943>>ASSIGN   1944>>ASSIGN
DCW
      1676**DCL      1830<<ASSIGN   1832>>ASSIGN   1852>>ASSIGN   1857>>ASSIGN   1973<<ASSIGN
DCW.FWA
      1680**DCL      1974<<ASSIGN
DCW.ICP
      1681**DCL      1977<<ASSIGN
DCW.TALLY
      1683**DCL      1684--REDEF    1975<<ASSIGN   1976>>IF       1976<<ASSIGN
DFILL
      1820**DCL      1954--ASSIGN
DVT$
      1701**DCL      1782--IMP-PTR  1838<<ASSIGN   1898>>DOCASE
FILL
      1771**DCL      1911>>IF       1924<<ASSIGN   1925<<ASSIGN   1925>>ASSIGN   1932>>IF       1932>>IF
      1943<<ASSIGN   1943>>ASSIGN   1944<<ASSIGN   1944>>ASSIGN   1981<<ASSIGN   1981>>ASSIGN
FILL$
      1702**DCL      1927<<ASSIGN   1946<<ASSIGN   1954<<ASSIGN   1959<<ASSIGN   1964<<ASSIGN   1968<<ASSIGN
      1981>>ASSIGN
FM$CON.CTL
      1773**DCL      1901>>IF       1962>>IF
FM$CON.GACTB
      1773**DCL      1926<<ASSIGN   1945<<ASSIGN   1975>>ASSIGN   1978>>ASSIGN   1980>>ASSIGN
FM$CON.GX
      1773**DCL      1897>>ASSIGN   1974>>ASSIGN
FM$GRAN.AVAIL
      1778**DCL      1824>>ASSIGN
FM$GRAN.NAVX
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:85   
      1777**DCL      1824>>ASSIGN
GETDC
      1894**PROC     1850--CALL     1855--CALL
GRAN
      1780**DCL      1830>>ASSIGN   1831<<ASSIGN   1831>>ASSIGN   1832<<ASSIGN   1852<<ASSIGN   1857<<ASSIGN
      1896--ASSIGN   1897--ASSIGN
HW_IMX
       661**DCL      1866>>IF       1882>>IF       1888>>IF
HW_IOP
       658**DCL      1886>>IF
I
      1703**DCL      1829<<DOINDEX  1830>>ASSIGN   1831>>ASSIGN   1831>>ASSIGN   1832>>ASSIGN   1849<<ASSIGN
      1852>>ASSIGN   1853>>DOWHILE  1854<<ASSIGN   1854>>ASSIGN   1857>>ASSIGN   1859<<ASSIGN   1859>>ASSIGN
      1861>>ASSIGN   1896>>ASSIGN   1906>>IF       1916<<ASSIGN   1937<<ASSIGN
ICP
      1704**DCL      1900<<ASSIGN   1970<<ASSIGN   1977>>ASSIGN
IDCW
      1593**DCL         6--PROC     1835--ENTRY
IDCW.DC1
      1594**DCL      1958>>ASSIGN   1967>>ASSIGN
IDCW.DC2
      1596**DCL      1953>>ASSIGN   1963>>ASSIGN
IDCW.DC3
      1597**DCL      1928>>ASSIGN
IDCW.DC4
      1599**DCL      1947>>ASSIGN
IOS$
      1665**DCL      1797--IMP-PTR  1836<<ASSIGN   1863>>ASSIGN   1864>>ASSIGN   1865>>ASSIGN   1867>>ASSIGN
      1868>>ASSIGN   1869>>ASSIGN   1870>>ASSIGN   1873>>ASSIGN   1874>>ASSIGN   1878>>ASSIGN   1883>>ASSIGN
      1884>>ASSIGN   1887>>ASSIGN   1889>>ASSIGN
J
      1705**DCL      1908<>CALL     1910>>ASSIGN   1922>>ASSIGN
N$DCT$
      1207**DCL      1837>>ASSIGN
N$DCT$$
      1073**DCL      1207--IMP-PTR  1837>>ASSIGN
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:86   
N$FQ$
      1073**DCL      1208--IMP-PTR
N$REQ
      1609**DCL         6--PROC     1835--ENTRY
N$REQ.ARCT
      1644**DCL      1840>>IF       1840<<ASSIGN   1841>>ASSIGN   1917<<ASSIGN   1917>>ASSIGN   1938<<ASSIGN
      1938>>ASSIGN
N$REQ.BUF$
      1618**DCL      1715--IMP-PTR  1777--IMP-PTR  1780--IMP-PTR  1824>>ASSIGN   1824>>ASSIGN   1824>>ASSIGN
      1825>>ASSIGN   1826>>ASSIGN   1829>>DOINDEX  1830>>ASSIGN   1830>>ASSIGN   1831>>ASSIGN   1831>>ASSIGN
      1831>>ASSIGN   1832>>ASSIGN   1842>>IF       1843>>IF       1844>>IF       1845>>ASSIGN   1846>>IF
      1847>>ASSIGN   1847>>ASSIGN   1848>>ASSIGN   1851>>ASSIGN   1852>>ASSIGN   1852>>ASSIGN   1853>>DOWHILE
      1856>>IF       1857>>ASSIGN   1857>>ASSIGN   1861>>ASSIGN   1864>>ASSIGN   1865>>ASSIGN   1870>>ASSIGN
      1874>>ASSIGN   1896>>ASSIGN   1896>>ASSIGN   1897>>ASSIGN   1912>>IF       1933>>IF
N$REQ.BUFADDR
      1618**DCL      1619--REDEF    1619--REDEF
N$REQ.BUFREAL.ADR
      1619**DCL      1874>>ASSIGN
N$REQ.BUFVIRT.BASE
      1619**DCL      1880>>ASSIGN
N$REQ.BUFVIRT.BYT
      1619**DCL      1870>>ASSIGN
N$REQ.DLA.DCTX
      1609**DCL      1837>>ASSIGN
N$REQ.DLA.DRELADDR
      1610**DCL      1610--REDEF
N$REQ.DVE.EOMCHAR
      1647**DCL      1648--REDEF
N$REQ.EAINFO
      1641**DCL      1641--REDEF
N$REQ.EAINFOX
      1641**DCL      1642--REDEF
N$REQ.ERRCT
      1611**DCL      1877<<ASSIGN
N$REQ.EVNTINFO
      1642**DCL      1642--REDEF
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:87   
N$REQ.IOFLG.LPW23
      1613**DCL      1879<<ASSIGN
N$REQ.IOS$
      1622**DCL      1836>>ASSIGN
N$REQ.LPWX.BASE
      1621**DCL      1880<<ASSIGN
N$REQ.LPWX.BOUND
      1621**DCL      1881<<ASSIGN
N$REQ.PTP
      1620**DCL      1887>>ASSIGN   1889>>ASSIGN
N$REQ.STATUS
      1623**DCL      1629--REDEF
N$REQ.STATUS.IOM
      1626**DCL      1876>>IF
N$REQ.STATUS.MAJOR
      1623**DCL      1876>>IF
N$REQ.TIMOUT
      1611**DCL      1878<<ASSIGN
N$REQ_INIT.BUFADDR
      1092**DCL      1093--REDEF    1093--REDEF
N$REQ_INIT.DLA.DRELADDR
      1084**DCL      1084--REDEF
N$REQ_INIT.DVE.EOMCHAR
      1121**DCL      1122--REDEF
N$REQ_INIT.EAINFO
      1115**DCL      1115--REDEF
N$REQ_INIT.EAINFOX
      1115**DCL      1116--REDEF
N$REQ_INIT.EVNTINFO
      1116**DCL      1116--REDEF
N$REQ_INIT.STATUS
      1097**DCL      1103--REDEF
NEW_DC
      1859**LABEL    1855--CALLALT  1856--GOTO
NFILL
      1706**DCL      1771--IMP-SIZ  1909<<ASSIGN   1911>>IF       1923<<ASSIGN   1924>>ASSIGN   1925>>ASSIGN
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:88   
      1925>>ASSIGN   1926>>ASSIGN   1931<<ASSIGN   1932>>IF       1932>>IF       1943>>ASSIGN   1943>>ASSIGN
      1944>>ASSIGN   1944>>ASSIGN   1945>>ASSIGN   1978<<ASSIGN   1979>>IF       1981>>ASSIGN   1981>>ASSIGN
NI$DVT.MPC
      1784**DCL      1785--REDEF
NI$DVT.TYPE
      1782**DCL      1898>>DOCASE
NI$FQ$
      1133**DCL      1209--IMP-PTR
NI$IBUF$
      1133**DCL      1209--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
      1143**DCL      1144--REDEF    1144--REDEF
NI$IMXMBX_INIT.SIZE
      1145**DCL      1145--REDEF
NI$REQ.DCW
      1799**DCL      1802--REDEF    1868<<ASSIGN   1873<<ASSIGN
NI$REQ.DCW.FWA
      1799**DCL      1870<<ASSIGN   1874<<ASSIGN
NI$REQ.DCW.T.DCWLIST.BASE
      1801**DCL      1869<<ASSIGN
NI$REQ.DCW.TALLY
      1800**DCL      1800--REDEF
NI$REQ.IDCW
      1802**DCL      1863<<ASSIGN
NI$REQ.IDCW.DATA.BASE
      1802**DCL      1867<<ASSIGN
NI$REQ.IDCW.DC
      1802**DCL      1864<<ASSIGN
NI$REQ.IDCW.EXTA
      1802**DCL      1802--REDEF
NI$REQ.IDCW.RCNT
      1803**DCL      1865<<ASSIGN   1878>>ASSIGN
NI$REQ.IOP_PTAW
      1797**DCL      1887<<ASSIGN
NI$REQ.PCW
      1804**DCL      1808--REDEF    1883<<ASSIGN
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:89   
NI$REQ.PCW.FLAGS
      1808**DCL      1884<<ASSIGN
NI$REQ.PCW.PTP
      1808**DCL      1889<<ASSIGN
NI$REQ.SEEK
      1809**DCL      1810--REDEF    1811--REDEF
NI$REQ_INIT.DCW
      1167**DCL      1170--REDEF
NI$REQ_INIT.DCW.TALLY
      1168**DCL      1168--REDEF
NI$REQ_INIT.IDCW.EXTA
      1170**DCL      1170--REDEF
NI$REQ_INIT.PCW
      1172**DCL      1176--REDEF
NI$REQ_INIT.SEEK
      1177**DCL      1178--REDEF    1179--REDEF
NI$RP$
      1181**DCL      1211--IMP-PTR
NI_MBX_INIT.DCW.CONTROL.AE
      1203**DCL      1203--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
      1199**DCL      1199--REDEF
NKF$VFU
      1661**DCL-ENT  1908--CALL
PRINT_IDCW
      1821**DCL      1863>>ASSIGN
RCN
      1707**DCL      1841<<ASSIGN   1842>>IF       1843>>IF       1844>>IF       1845>>ASSIGN   1846>>IF
      1848>>ASSIGN   1849>>ASSIGN   1865>>ASSIGN   1870>>ASSIGN   1874>>ASSIGN   1906>>IF       1912>>IF
      1915<<ASSIGN   1915>>ASSIGN   1916>>ASSIGN   1933>>IF       1936<<ASSIGN   1936>>ASSIGN   1937>>ASSIGN
REC$
      1708**DCL      1814--IMP-PTR  1897<<ASSIGN   1902>>IF       1902>>IF       1903>>IF       1908>>CALL
      1925>>ASSIGN   1932>>IF       1943>>ASSIGN   1944>>ASSIGN   1980>>ASSIGN
TEMP
      1813**DCL      1911>>IF       1924>>ASSIGN
TEMP$
PL6.E3A0      #002=NIU$SYMBLOCK File=NIU$UNIT.:E05TSI                            WED 07/30/97 03:39 Page:90   
      1709**DCL      1839<<ASSIGN   1908>>CALL     1911>>IF       1924>>ASSIGN
TEMPBUF
      1710**DCL      1839--ASSIGN
TEMPFILL
      1711**DCL      1813--IMP-SIZ  1910<<ASSIGN   1911>>IF       1923>>ASSIGN   1924>>ASSIGN
TOP IN PROCEDURE GETDC
      1896**LABEL    1918--GOTO     1939--GOTO
VFCCHAR
      1814**DCL      1902>>IF       1902>>IF       1903>>IF       1908<>CALL     1908<>CALL
ZFILL
      1818**DCL      1927--ASSIGN   1946--ASSIGN   1964--ASSIGN

PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:91   
      413        1        /*T***********************************************************/
      414        2        /*T*                                                         */
      415        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      416        4        /*T*                                                         */
      417        5        /*T***********************************************************/
      418        6        NIU$FIXARCT: PROC(N$REQ,RETRY) ALTRET;
      419        7        /**/
      420        8        %INCLUDE NI$TABLES;
      421      224        %INCLUDE N$REQ;
      422      298        %N$REQ (STCLASS="");
      423      356    1   DCL RETRY UBIN(1) UNAL;
      424      357        /**/
      425      358    1   DCL NIU$CONTSYMB ENTRY(2) ALTRET;
      426      359        /**/
      427      360        %INCLUDE N_FC_C;
      428      397        %INCLUDE NK_VFC_C;
      429      471        %NK$VFC (NAME=VFC,STCLASS="BASED(REC$)");
      430      489    1   DCL REC$ PTR;
      431      490    1   DCL IOS$ PTR;
      432      491    1   DCL GRAN$ PTR;
      433      492        %NI$REQ (STCLASS="BASED(IOS$)");
      434      517        %NI$DCT;
      435      565        %NI$DVT;
      436      572    1   DCL IDCW BIT(36);
      437      573    1   DCL 1 CTRL BASED(GRAN$) ALIGNED,
      438      574    1         2 FREC SBIN(12) UNAL,             /* FIRST RECORD                       */
      439      575    1         2 LREC SBIN(12) UNAL,             /* LAST RECORD                        */
      440      576    1         2 CWX SBIN(12) UNAL,              /* INDEX OF FIRST CONTROL WORD        */
      441      577    1         2 NAVX UBIN(18) UNAL,             /* NAVX PRESERVED FROM FM$GRAN        */
      442      578    1         2 DC UBIN(6) UNAL,                /* DEVICE COMMAND FOR CURRENT RECORD  */
      443      579    1         2 * BIT(2),
      444      580    1         2 AVAIL UBIN(10) UNAL;            /* AVAIL PRESERVED FROM FM$GRAN       */
      445      581    1   DCL 1 DCW(0:0) ALIGNED BASED(GRAN$),
      446      582    1         2 FWA UBIN(18) UNAL,
      447      583    1         2 ICP UBIN(3) UNAL,
      448      584    1         2 TYPE UBIN(3) UNAL,
      449      585    1         2 TALLY UBIN(12) UNAL;
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:92   
      450      586    1   DCL I SBIN;
      451      587    1   DCL RCR SBIN;
      452      588        %EJECT;
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:93   
      453      589    1           IF N$REQ.IOS$=ADDR(NIL) THEN ALTRETURN;
      454      590    1           IOS$=N$REQ.IOS$;
      455      591    1           IF N$REQ.FC~=%N_SYMB OR N$REQ.EAINFOX~=0 THEN ALTRETURN;
      456      592    1           IF N$REQ.STATUS.RCR = NI$REQ.IDCW.RCNT(0) OR N$REQ.STATUS.NCP = 7 THEN
               592                    RETURN;
      457      593    1           GRAN$=N$REQ.BUF$;
      458      594    1           RCR=N$REQ.STATUS.RCR+RETRY;
      459      595    1           I=N$REQ.ARCT+NI$REQ.IDCW.RCNT(0)-RCR;
      460      596    1           N$REQ.ARCT=I;
      461      597    1           IDCW = N$REQ.DCT$->NI$DCT.DVT$->NI$DVT.IDCW(%N_SYMB);
      462      598    1           CALL NIU$CONTSYMB(N$REQ,IDCW) ALTRET(ALT);
      463      599    1           RETURN;
      464      600    1   ALT:    ALTRETURN;
      465      601    1   END NIU$FIXARCT;
      466      602        %EOD;

PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:94   
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
      No diagnostics issued in procedure NIU$FIXARCT.

   Procedure NIU$FIXARCT requires 59 words for executable code.
   Procedure NIU$FIXARCT requires 14 words of local(AUTO) storage.

PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:95   

 Object Unit name= NIU$FIXARCT                                File name= NIU$UNIT.:E05TOU
 UTS= JUL 30 '97 03:39:57.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    59     73  NIU$FIXARCT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  NIU$FIXARCT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 NIU$CONTSYMB
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:96   


      413        1        /*T***********************************************************/
      414        2        /*T*                                                         */
      415        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      416        4        /*T*                                                         */
      417        5        /*T***********************************************************/
      418        6        NIU$FIXARCT: PROC(N$REQ,RETRY) ALTRET;

      6  0 000000   000000 700200 xent  NIU$FIXARCT  TSX0  ! X66_AUTO_2
         0 000001   000016 000002                    ZERO    14,2

      419        7        /**/
      420        8        %INCLUDE NI$TABLES;
      421      224        %INCLUDE N$REQ;
      422      298        %N$REQ (STCLASS="");
      423      356    1   DCL RETRY UBIN(1) UNAL;
      424      357        /**/
      425      358    1   DCL NIU$CONTSYMB ENTRY(2) ALTRET;
      426      359        /**/
      427      360        %INCLUDE N_FC_C;
      428      397        %INCLUDE NK_VFC_C;
      429      471        %NK$VFC (NAME=VFC,STCLASS="BASED(REC$)");
      430      489    1   DCL REC$ PTR;
      431      490    1   DCL IOS$ PTR;
      432      491    1   DCL GRAN$ PTR;
      433      492        %NI$REQ (STCLASS="BASED(IOS$)");
      434      517        %NI$DCT;
      435      565        %NI$DVT;
      436      572    1   DCL IDCW BIT(36);
      437      573    1   DCL 1 CTRL BASED(GRAN$) ALIGNED,
      438      574    1         2 FREC SBIN(12) UNAL,             /* FIRST RECORD                       */
      439      575    1         2 LREC SBIN(12) UNAL,             /* LAST RECORD                        */
      440      576    1         2 CWX SBIN(12) UNAL,              /* INDEX OF FIRST CONTROL WORD        */
      441      577    1         2 NAVX UBIN(18) UNAL,             /* NAVX PRESERVED FROM FM$GRAN        */
      442      578    1         2 DC UBIN(6) UNAL,                /* DEVICE COMMAND FOR CURRENT RECORD  */
      443      579    1         2 * BIT(2),
      444      580    1         2 AVAIL UBIN(10) UNAL;            /* AVAIL PRESERVED FROM FM$GRAN       */
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:97   
      445      581    1   DCL 1 DCW(0:0) ALIGNED BASED(GRAN$),
      446      582    1         2 FWA UBIN(18) UNAL,
      447      583    1         2 ICP UBIN(3) UNAL,
      448      584    1         2 TYPE UBIN(3) UNAL,
      449      585    1         2 TALLY UBIN(12) UNAL;
      450      586    1   DCL I SBIN;
      451      587    1   DCL RCR SBIN;
      452      588        %EJECT;
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:98   
      453      589    1           IF N$REQ.IOS$=ADDR(NIL) THEN ALTRETURN;

    589  0 000002   200003 470500                    LDP0    @N$REQ,,AUTO
         0 000003   000012 236100                    LDQ     10,,PR0
         0 000004   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000005   000007 601000 0                  TNZ     s:590

    589  0 000006   000000 702200 xent               TSX2  ! X66_AALT

      454      590    1           IOS$=N$REQ.IOS$;

    590  0 000007   200006 756100                    STQ     IOS$,,AUTO

      455      591    1           IF N$REQ.FC~=%N_SYMB OR N$REQ.EAINFOX~=0 THEN ALTRETURN;

    591  0 000010   000003 236100                    LDQ     3,,PR0
         0 000011   000777 376007                    ANQ     511,DL
         0 000012   000032 116007                    CMPQ    26,DL
         0 000013   000016 601000 0                  TNZ     s:591+6
         0 000014   000025 235100                    LDA     21,,PR0
         0 000015   000017 600000 0                  TZE     s:592

    591  0 000016   000000 702200 xent               TSX2  ! X66_AALT

      456      592    1           IF N$REQ.STATUS.RCR = NI$REQ.IDCW.RCNT(0) OR N$REQ.STATUS.NCP = 7 THEN
               592                    RETURN;

    592  0 000017   200006 471500                    LDP1    IOS$,,AUTO
         0 000020   000014 236100                    LDQ     12,,PR0
         0 000021   100002 676100                    ERQ     2,,PR1
         0 000022   000077 376007                    ANQ     63,DL
         0 000023   000030 600000 0                  TZE     s:592+9
         0 000024   000015 236100                    LDQ     13,,PR0
         0 000025   700000 376007                    ANQ     -32768,DL
         0 000026   700000 116007                    CMPQ    -32768,DL
         0 000027   000031 601000 0                  TNZ     s:593

PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:99   
    592  0 000030   000000 702200 xent               TSX2  ! X66_ARET

      457      593    1           GRAN$=N$REQ.BUF$;

    593  0 000031   000005 236100                    LDQ     5,,PR0
         0 000032   200007 756100                    STQ     GRAN$,,AUTO

      458      594    1           RCR=N$REQ.STATUS.RCR+RETRY;

    594  0 000033   200004 473500                    LDP3    @RETRY,,AUTO
         0 000034   003100 061500                    CSR     bolr='003'O
         0 000035   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
         0 000036   200014 000044                    BDSC    RCR+2,,AUTO              by=0,bit=0,n=36
         0 000037   000014 236100                    LDQ     12,,PR0
         0 000040   000077 376007                    ANQ     63,DL
         0 000041   200014 036100                    ADLQ    RCR+2,,AUTO
         0 000042   200012 756100                    STQ     RCR,,AUTO

      459      595    1           I=N$REQ.ARCT+NI$REQ.IDCW.RCNT(0)-RCR;

    595  0 000043   100002 236100                    LDQ     2,,PR1
         0 000044   000077 376007                    ANQ     63,DL
         0 000045   200014 756100                    STQ     RCR+2,,AUTO
         0 000046   000030 236100                    LDQ     24,,PR0
         0 000047   000022 732000                    QRS     18
         0 000050   200014 036100                    ADLQ    RCR+2,,AUTO
         0 000051   200012 136100                    SBLQ    RCR,,AUTO
         0 000052   200011 756100                    STQ     I,,AUTO

      460      596    1           N$REQ.ARCT=I;

    596  0 000053   000000 620006                    EAX0    0,QL
         0 000054   000030 740100                    STX0    24,,PR0

      461      597    1           IDCW = N$REQ.DCT$->NI$DCT.DVT$->NI$DVT.IDCW(%N_SYMB);

    597  0 000055   000002 474500                    LDP4    2,,PR0
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:100  
         0 000056   400024 475500                    LDP5    20,,PR4
         0 000057   500114 236100                    LDQ     76,,PR5
         0 000060   200010 756100                    STQ     IDCW,,AUTO

      462      598    1           CALL NIU$CONTSYMB(N$REQ,IDCW) ALTRET(ALT);

    598  0 000061   200010 634500                    EPPR4   IDCW,,AUTO
         0 000062   200015 454500                    STP4    RCR+3,,AUTO
         0 000063   200003 236100                    LDQ     @N$REQ,,AUTO
         0 000064   200014 756100                    STQ     RCR+2,,AUTO
         0 000065   200014 630500                    EPPR0   RCR+2,,AUTO
         0 000066   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000067   000000 701000 xent               TSX1    NIU$CONTSYMB
         0 000070   000072 702000 0                  TSX2    ALT

      463      599    1           RETURN;

    599  0 000071   000000 702200 xent               TSX2  ! X66_ARET

      464      600    1   ALT:    ALTRETURN;

    600  0 000072   000000 702200 xent  ALT          TSX2  ! X66_AALT
      465      601    1   END NIU$FIXARCT;
      466      602        %EOD;

PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:101  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
      No diagnostics issued in procedure NIU$FIXARCT.
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:102  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @N$REQ                     4-0-0/w PTR         r     1 @RETRY
     7-0-0/w PTR         r     1 GRAN$                     11-0-0/w SBIN        r     1 I
    10-0-0/b BIT         r     1 IDCW                       6-0-0/w PTR         r     1 IOS$
    *0-0-0/d STRC(1080)  r     1 N$REQ                     12-0-0/w SBIN        r     1 RCR
     5-0-0/w PTR         r     1 REC$                      *0-0-0/b UBIN        r     1 RETRY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 NI$DCT                     0-0-0/w STRC(2844)  r     1 NI$DVT
     0-0-0/d STRC(504)   r     1 NI$REQ


   Procedure NIU$FIXARCT requires 59 words for executable code.
   Procedure NIU$FIXARCT requires 14 words of local(AUTO) storage.
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:103  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:104  
          MINI XREF LISTING

ALT
       600**LABEL     598--CALLALT
GRAN$
       491**DCL       573--IMP-PTR   581--IMP-PTR   593<<ASSIGN
I
       586**DCL       595<<ASSIGN    596>>ASSIGN
IDCW
       572**DCL       597<<ASSIGN    598<>CALL
IOS$
       490**DCL       501--IMP-PTR   590<<ASSIGN    592>>IF        595>>ASSIGN
N$REQ
       307**DCL         6--PROC      598<>CALL
N$REQ.ARCT
       342**DCL       595>>ASSIGN    596<<ASSIGN
N$REQ.BUF$
       316**DCL       593>>ASSIGN
N$REQ.BUFADDR
       316**DCL       317--REDEF     317--REDEF
N$REQ.DCT$
       308**DCL       597>>ASSIGN
N$REQ.DLA.DRELADDR
       308**DCL       308--REDEF
N$REQ.DVE.EOMCHAR
       345**DCL       346--REDEF
N$REQ.EAINFO
       339**DCL       339--REDEF
N$REQ.EAINFOX
       339**DCL       340--REDEF     591>>IF
N$REQ.EVNTINFO
       340**DCL       340--REDEF
N$REQ.FC
       310**DCL       591>>IF
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:105  
N$REQ.IOS$
       320**DCL       589>>IF        590>>ASSIGN
N$REQ.STATUS
       321**DCL       327--REDEF
N$REQ.STATUS.NCP
       325**DCL       592>>IF
N$REQ.STATUS.RCR
       325**DCL       592>>IF        594>>ASSIGN
NI$DCT.DP
       546**DCL       553--REDEF     556--REDEF     557--REDEF     559--REDEF     559--REDEF     560--REDEF
       561--REDEF     561--REDEF
NI$DCT.DVT$
       542**DCL       597>>ASSIGN
NI$DCT.MPC.IOCHANX
       554**DCL       554--REDEF
NI$DVT.IDCW
       569**DCL       597>>ASSIGN
NI$DVT.MPC
       568**DCL       569--REDEF
NI$REQ.DCW
       503**DCL       506--REDEF
NI$REQ.DCW.TALLY
       504**DCL       504--REDEF
NI$REQ.IDCW.EXTA
       506**DCL       506--REDEF
NI$REQ.IDCW.RCNT
       507**DCL       592>>IF        595>>ASSIGN
NI$REQ.PCW
       508**DCL       512--REDEF
NI$REQ.SEEK
       513**DCL       514--REDEF     515--REDEF
NIU$CONTSYMB
       358**DCL-ENT   598--CALL
RCR
       587**DCL       594<<ASSIGN    595>>ASSIGN
REC$
PL6.E3A0      #003=NIU$FIXARCT File=NIU$UNIT.:E05TSI                             WED 07/30/97 03:39 Page:106  
       489**DCL       482--IMP-PTR
RETRY
       356**DCL         6--PROC      594>>ASSIGN

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:107  
      467        1        /*M* NIU$CRPEXTST - ROUTINE TO GET READER/PUNCH EXTENDED STATUS */
      468        2        /*T***********************************************************/
      469        3        /*T*                                                         */
      470        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      471        5        /*T*                                                         */
      472        6        /*T***********************************************************/
      473        7        NIU$CRPEXTSTEA: PROC (REQ, NEWSTATE) ALTRET;
      474        8        /**/
      475        9        %INCLUDE N$REQ;
      476       83        %N$REQ (NAME=REQ,STCLASS="");
      477      141    1   DCL NEWSTATE UBIN WORD;
      478      142        /**/
      479      143        /* INCLUDES */
      480      144        %INCLUDE NI$TABLES;
      481      360        %INCLUDE NI_DATA_C;
      482      473        %INCLUDE HF_LOCK_C;
      483      487        %INCLUDE HF_DATA_R;
      484      530        %INCLUDE B_MLSMAC_C;
      485     1472        %INCLUDE S_WSPTD_R;
      486     1488        %INCLUDE B_STRINGS_C;
      487     1617        %INCLUDE NI$ERRLOG;
      488     1683        /**/
      489     1684        /* ENTRY DCLS */
      490     1685    1   DCL NIQ$GETS ENTRY(1) ALTRET;
      491     1686    1   DCL NIQ$RELS ENTRY(1) ALTRET;
      492     1687    1   DCL HFC$ASSOCCLR ENTRY(3);
      493     1688        /**/
      494     1689        %NI$REQ (NAME=IOS,STCLASS="BASED(IOS$)");
      495     1714        %NI$IOERR;
      496     1768        %N$REQ;
      497     1826    1   DCL IOS$ PTR;
      498     1827    1   DCL EXT$ PTR;
      499     1828    1   DCL 1 EXTBASE BASED(EXT$),
      500     1829    1         2 PTR$ PTR,
      501     1830    1         2 IOWD BIT(36),
      502     1831    1         2 IOWORD REDEF IOWD,
      503     1832    1           3 CWF BIT(16) UNAL,
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:108  
      504     1833    1           3 CONTAD REDEF CWF,
      505     1834    1             4 * BIT(8) UNAL,
      506     1835    1             4 STS BIT(8) UNAL,
      507     1836    1           3 * BIT(20) UNAL,
      508     1837    1         2 DATAWD1 BIT(36),
      509     1838    1         2 DATAWD2 BIT(36),
      510     1839    1         2 EXTST,
      511     1840    1           3 PSR BIT(8) UNAL,
      512     1841    1           3 PER BIT(8) UNAL,
      513     1842    1           3 MR BIT(8) UNAL,
      514     1843    1           3 RSR BIT(8) UNAL,
      515     1844    1           3 DS1 BIT(8) UNAL,
      516     1845    1           3 DS2 BIT(8) UNAL,
      517     1846    1           3 ENR BIT(8) UNAL,
      518     1847    1           3 IFR BIT(8) UNAL,
      519     1848    1           3 DCR BIT(8) UNAL,
      520     1849    1           3 CWF BIT(16) UNAL;
      521     1850        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
      522     2665    1   DCL B$LS$ PTR SYMREF;
      523     2666    1   DCL B$MISC$ PTR SYMREF;
      524     2667    1   DCL F_DCBLOCK SBIN SYMREF;
      525     2668        %EQU EXTST_SIZE = 10;                   /* SIZE IN BYTES OF EXTST BUF */
      526     2669        %EQU XA_WSPTD_MOD1024 = 16;
      527     2670        %EQU XA_256KBYTES = 262144;
      528     2671    1   DCL DATA(0:0) BIT(36) ALIGNED BASED;
      529     2672    1   DCL DATA$ PTR;
      530     2673    1   DCL 1 DATAPTR REDEF DATA$,
      531     2674    1         2 WA UBIN(18) UNAL,
      532     2675    1         2 * UBIN(18) UNAL;
      533     2676    1   DCL IOWD$ PTR;
      534     2677    1   DCL 1 IOWDPTR REDEF IOWD$,
      535     2678    1         2 WA UBIN(18) UNAL,
      536     2679    1         2 * UBIN(18) UNAL;
      537     2680    1   DCL J SBIN;
      538     2681    1   DCL 1 EXTST BASED ALIGNED,
      539     2682    1         2 PSR BIT(8) UNAL,
      540     2683    1         2 PER BIT(8) UNAL,
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:109  
      541     2684    1         2 MR BIT(8) UNAL,
      542     2685    1         2 RSR BIT(8) UNAL,
      543     2686    1         2 DS1 BIT(8) UNAL,
      544     2687    1         2 DS2 BIT(8) UNAL,
      545     2688    1         2 ENR BIT(8) UNAL,
      546     2689    1         2 IFR BIT(8) UNAL,
      547     2690    1         2 DCR BIT(8) UNAL,
      548     2691    1         2 CWF BIT(16) UNAL;
      549     2692        %EJECT;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:110  
      550     2693        %EJECT;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:111  
      551     2694    1           IOS$ = REQ.IOS$;
      552     2695    1           EXT$ = IOS.FL$;
      553     2696    1           EXTBASE.PTR$ = ADDR(NIL);
      554     2697    1           DATA$ = ADDR(EXTBASE.DATAWD1);
      555     2698    1           IOWD$ = ADDR(EXTBASE.IOWD);
      556     2699    2           DO CASE(REQ.EAINFO);
      557     2700    2            CASE(0);                       /* CWF - NEXT: PSR */
      558     2701    2              EXTBASE.EXTST.CWF = EXTBASE.IOWORD.CWF;
      559     2702    2              IOS.IDCW(0) = '310000724000'O; /* EXECUTE DLI COMMAND */
      560     2703    2              IF HW_IMX THEN
      561     2704    2                 IOS.IDCW.DATA.BASE(0)=%IMX_IOS_BASE;
      562     2705    2              IOS.DCW(1) = '000000000001'O;
      563     2706    2              IOS.DCW.FWA(1) = DATAPTR.WA;
      564     2707    2              DATA$->DATA(0) = '342062060000'O; /* READ PSR DATA */
      565     2708    2              IOS.IDCW(2) = '220000724000'O; /* READ MPC MEMORY */
      566     2709    2              IF HW_IMX THEN
      567     2710    2                 IOS.IDCW.DATA.BASE(2)=%IMX_IOS_BASE;
      568     2711    2              IOS.DCW(3) = '000000000001'O; /* IOTD DATA + 1 */
      569     2712    2              IOS.DCW.FWA(3) = DATAPTR.WA + 1;
      570     2713    2              DATA$->DATA(1) = '001264000040'O; /* MPC MEMORY ADDRESS */
      571     2714    2              IOS.IDCW(4) = '060000704000'O; /* INIT DATA TRANSFER */
      572     2715    2              IF HW_IMX THEN
      573     2716    2                 IOS.IDCW.DATA.BASE(4)=%IMX_IOS_BASE;
      574     2717    2              IOS.DCW(5) = '000000000001'O;
      575     2718    2              IOS.DCW.FWA(5) = IOWDPTR.WA;
      576     2719    2              REQ.EAINFO = REQ.EAINFO + 1;
      577     2720    2            CASE(1);                       /* PSR - NEXT: PER */
      578     2721    2              EXTBASE.EXTST.PSR = EXTBASE.IOWORD.CONTAD.STS;
      579     2722    2              DATA$->DATA(0) = '342062064000'O;
      580     2723    2              REQ.EAINFO = REQ.EAINFO + 1;
      581     2724    2            CASE(2);                       /* PER - NEXT: MR */
      582     2725    2              EXTBASE.EXTST.PER = EXTBASE.IOWORD.CONTAD.STS;
      583     2726    2              DATA$->DATA(0) = '342062000000'O;
      584     2727    2              REQ.EAINFO = REQ.EAINFO + 1;
      585     2728    2            CASE(3);                       /* MR - NEXT: RSR */
      586     2729    2              EXTBASE.EXTST.MR = EXTBASE.IOWORD.CONTAD.STS;
      587     2730    2              DATA$->DATA(0) = '342062020000'O;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:112  
      588     2731    2              REQ.EAINFO = REQ.EAINFO + 1;
      589     2732    2            CASE(4);                       /* RSR - NEXT: DS1 */
      590     2733    2              EXTBASE.EXTST.RSR = EXTBASE.IOWORD.CONTAD.STS;
      591     2734    2              DATA$->DATA(0) = '342062024000'O;
      592     2735    2              REQ.EAINFO = REQ.EAINFO + 1;
      593     2736    2            CASE(5);                       /* DS1 - NEXT: DS2 */
      594     2737    2              EXTBASE.EXTST.DS1 = EXTBASE.IOWORD.CONTAD.STS;
      595     2738    2              DATA$->DATA(0) = '342062030000'O;
      596     2739    2              REQ.EAINFO = REQ.EAINFO + 1;
      597     2740    2            CASE(6);                       /* DS2 - NEXT: ENR */
      598     2741    2              EXTBASE.EXTST.DS2 = EXTBASE.IOWORD.CONTAD.STS;
      599     2742    2              DATA$->DATA(0) = '342062034000'O;
      600     2743    2              REQ.EAINFO = REQ.EAINFO + 1;
      601     2744    2            CASE(7);                       /* ENR - NEXT: IFR */
      602     2745    2              EXTBASE.EXTST.ENR = EXTBASE.IOWORD.CONTAD.STS;
      603     2746    2              DATA$->DATA(0) = '342062014000'O;
      604     2747    2              REQ.EAINFO = REQ.EAINFO + 1;
      605     2748    2            CASE(8);                       /* IFR - NEXT: DCR */
      606     2749    2              EXTBASE.EXTST.IFR = EXTBASE.IOWORD.CONTAD.STS;
      607     2750    2              DATA$->DATA(0) = '342062001000'O;
      608     2751    2              REQ.EAINFO = REQ.EAINFO + 1;
      609     2752    2            CASE(9);                       /* DCR - ALL DONE NOW */
      610     2753    2              EXTBASE.EXTST.DCR = EXTBASE.IOWORD.CONTAD.STS;
      611     2754    2              NEWSTATE = REQ.POSTER;
      612     2755                   %LOCK (G#=F_DCBLOCK);
      613     2758    2              B$LS$->B$MLNK.MISC = B$LS$->B$MLNK.IOEND;
      614     2759    2              B$LS$->B$MLNK.MISC.BOUND = REQ.BUFSIZE - 1;
      615     2760    2              J = HW_PTB_UNITS/HW_IOPTP_UNITS;
      616     2761    2              S_WSPTD.BLKNO(%IOENDWSQ) = REQ.PTP/J;
      617     2762    2              B$LS$->B$MLNK.MISC.BASE = REQ.BUFADDR + MOD(REQ.PTP,J)*HW_IOPTP_UNITS*
              2762                       4096;
      618     2763    2              CALL HFC$ASSOCCLR(%IOENDWSQ,0,16384); /*MAX Dense PT*/
      619     2764    2              B$MISC$->EXTST = EXTBASE.EXTST;
      620     2765                   %UNLOCK (G#=F_DCBLOCK);
      621     2768    2              ALTRETURN;
      622     2769    2            END;                           /* DO CASE REQ.EAINFO */
      623     2770    1           RETURN;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:113  
      624     2771    1   NIU$CRPEXTST: ENTRY(REQ) ALTRET;
      625     2772    1           IF REQ.BUFSIZE < %EXTST_SIZE    /* BUFFER TO SMALL */
      626     2773    1           THEN ALTRETURN;
      627     2774    1           IOS$ = REQ.IOS$;
      628     2775    1           CALL NIQ$GETS(EXT$) ALTRET(SKIP_EXTST);
      629     2776    1           EXTBASE.PTR$ = ADDR(NIL);
      630     2777    1           IOS.FL$ = EXT$;
      631     2778    1           REQ.TIMOUT = 5;
      632     2779    1           IF NOT HW_IMX THEN
      633     2780    1              IOS.PCW = '0000007'O;
      634     2781    1           DATA$ = ADDR(EXTBASE.DATAWD1);
      635     2782    1           IOWD$ = ADDR(EXTBASE.IOWD);
      636     2783    1           REQ.EAINFO = 0;                 /* SET UP TO READ CWF */
      637     2784    1           IOS.IDCW(0) = '220000724000'O;  /* READ MPC MEMORY */
      638     2785    1           IF HW_IMX THEN
      639     2786    1              IOS.IDCW.DATA.BASE(0)=%IMX_IOS_BASE;
      640     2787    1           IOS.DCW(1) = '000000000001'O;   /* IOTD DATA */
      641     2788    1           IOS.DCW.FWA(1) = DATAPTR.WA;
      642     2789    1           DATA$->DATA(0) = '001270000040'O; /* ADDR OF CWF IN MPC MEMORY */
      643     2790    1           IOS.IDCW(2) = '060000704000'O;  /* INIT DATA TRANSFER */
      644     2791    1           IF HW_IMX THEN
      645     2792    1              IOS.IDCW.DATA.BASE(2)=%IMX_IOS_BASE;
      646     2793    1           IOS.DCW(3) = '000000000001'O;
      647     2794    1           IOS.DCW.FWA(3) = IOWDPTR.WA;
      648     2795    1           RETURN;
      649     2796    1   SKIP_EXTST:
      650     2797    1           ALTRETURN;
      651     2798    1   END NIU$CRPEXTSTEA ;

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:114  
--  Include file information  --

   NI$ERRLOG.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
      No diagnostics issued in procedure NIU$CRPEXTSTEA.

   Procedure NIU$CRPEXTSTEA requires 297 words for executable code.
   Procedure NIU$CRPEXTSTEA requires 12 words of local(AUTO) storage.

    No errors detected in file NIU$UNIT.:E05TSI    .

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:115  

 Object Unit name= NIU$CRPEXTSTEA                             File name= NIU$UNIT.:E05TOU
 UTS= JUL 30 '97 03:40:15.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     15     17  NIU$CRPEXTSTEA
    1   Proc  even  none   297    451  NIU$CRPEXTSTEA
    2  RoData even  none     9     11  NIU$CRPEXTSTEA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  NIU$CRPEXTSTEA
     1    351          yes     yes      Std        1  NIU$CRPEXTST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
         yes           Std       3 HFC$ASSOCCLR
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       1 NIQ$GETS
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:116  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     HW_PTB_UNITS                          HW_IOPTP_UNITS                        HW_IMX
     S_WSPTD                               B$LS$                                 B$MISC$
     F_DCBLOCK                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:117  


      467        1        /*M* NIU$CRPEXTST - ROUTINE TO GET READER/PUNCH EXTENDED STATUS */
      468        2        /*T***********************************************************/
      469        3        /*T*                                                         */
      470        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      471        5        /*T*                                                         */
      472        6        /*T***********************************************************/
      473        7        NIU$CRPEXTSTEA: PROC (REQ, NEWSTATE) ALTRET;

      7  1 000000   000000 700200 xent  NIU$CRPEXTS* TSX0  ! X66_AUTO_2
         1 000001   000014 000002                    ZERO    12,2

      474        8        /**/
      475        9        %INCLUDE N$REQ;
      476       83        %N$REQ (NAME=REQ,STCLASS="");
      477      141    1   DCL NEWSTATE UBIN WORD;
      478      142        /**/
      479      143        /* INCLUDES */
      480      144        %INCLUDE NI$TABLES;
      481      360        %INCLUDE NI_DATA_C;
      482      473        %INCLUDE HF_LOCK_C;
      483      487        %INCLUDE HF_DATA_R;
      484      530        %INCLUDE B_MLSMAC_C;
      485     1472        %INCLUDE S_WSPTD_R;
      486     1488        %INCLUDE B_STRINGS_C;
      487     1617        %INCLUDE NI$ERRLOG;
      488     1683        /**/
      489     1684        /* ENTRY DCLS */
      490     1685    1   DCL NIQ$GETS ENTRY(1) ALTRET;
      491     1686    1   DCL NIQ$RELS ENTRY(1) ALTRET;
      492     1687    1   DCL HFC$ASSOCCLR ENTRY(3);
      493     1688        /**/
      494     1689        %NI$REQ (NAME=IOS,STCLASS="BASED(IOS$)");
      495     1714        %NI$IOERR;
      496     1768        %N$REQ;
      497     1826    1   DCL IOS$ PTR;
      498     1827    1   DCL EXT$ PTR;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:118  
      499     1828    1   DCL 1 EXTBASE BASED(EXT$),
      500     1829    1         2 PTR$ PTR,
      501     1830    1         2 IOWD BIT(36),
      502     1831    1         2 IOWORD REDEF IOWD,
      503     1832    1           3 CWF BIT(16) UNAL,
      504     1833    1           3 CONTAD REDEF CWF,
      505     1834    1             4 * BIT(8) UNAL,
      506     1835    1             4 STS BIT(8) UNAL,
      507     1836    1           3 * BIT(20) UNAL,
      508     1837    1         2 DATAWD1 BIT(36),
      509     1838    1         2 DATAWD2 BIT(36),
      510     1839    1         2 EXTST,
      511     1840    1           3 PSR BIT(8) UNAL,
      512     1841    1           3 PER BIT(8) UNAL,
      513     1842    1           3 MR BIT(8) UNAL,
      514     1843    1           3 RSR BIT(8) UNAL,
      515     1844    1           3 DS1 BIT(8) UNAL,
      516     1845    1           3 DS2 BIT(8) UNAL,
      517     1846    1           3 ENR BIT(8) UNAL,
      518     1847    1           3 IFR BIT(8) UNAL,
      519     1848    1           3 DCR BIT(8) UNAL,
      520     1849    1           3 CWF BIT(16) UNAL;
      521     1850        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
      522     2665    1   DCL B$LS$ PTR SYMREF;
      523     2666    1   DCL B$MISC$ PTR SYMREF;
      524     2667    1   DCL F_DCBLOCK SBIN SYMREF;
      525     2668        %EQU EXTST_SIZE = 10;                   /* SIZE IN BYTES OF EXTST BUF */
      526     2669        %EQU XA_WSPTD_MOD1024 = 16;
      527     2670        %EQU XA_256KBYTES = 262144;
      528     2671    1   DCL DATA(0:0) BIT(36) ALIGNED BASED;
      529     2672    1   DCL DATA$ PTR;
      530     2673    1   DCL 1 DATAPTR REDEF DATA$,
      531     2674    1         2 WA UBIN(18) UNAL,
      532     2675    1         2 * UBIN(18) UNAL;
      533     2676    1   DCL IOWD$ PTR;
      534     2677    1   DCL 1 IOWDPTR REDEF IOWD$,
      535     2678    1         2 WA UBIN(18) UNAL,
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:119  
      536     2679    1         2 * UBIN(18) UNAL;
      537     2680    1   DCL J SBIN;
      538     2681    1   DCL 1 EXTST BASED ALIGNED,
      539     2682    1         2 PSR BIT(8) UNAL,
      540     2683    1         2 PER BIT(8) UNAL,
      541     2684    1         2 MR BIT(8) UNAL,
      542     2685    1         2 RSR BIT(8) UNAL,
      543     2686    1         2 DS1 BIT(8) UNAL,
      544     2687    1         2 DS2 BIT(8) UNAL,
      545     2688    1         2 ENR BIT(8) UNAL,
      546     2689    1         2 IFR BIT(8) UNAL,
      547     2690    1         2 DCR BIT(8) UNAL,
      548     2691    1         2 CWF BIT(16) UNAL;
      549     2692        %EJECT;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:120  
      550     2693        %EJECT;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:121  
      551     2694    1           IOS$ = REQ.IOS$;

   2694  1 000002   200003 470500                    LDP0    @REQ,,AUTO
         1 000003   000012 236100                    LDQ     10,,PR0
         1 000004   200005 756100                    STQ     IOS$,,AUTO

      552     2695    1           EXT$ = IOS.FL$;

   2695  1 000005   200005 471500                    LDP1    IOS$,,AUTO
         1 000006   100000 236100                    LDQ     0,,PR1
         1 000007   200006 756100                    STQ     EXT$,,AUTO

      553     2696    1           EXTBASE.PTR$ = ADDR(NIL);

   2696  1 000010   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000011   200006 473500                    LDP3    EXT$,,AUTO
         1 000012   300000 756100                    STQ     0,,PR3

      554     2697    1           DATA$ = ADDR(EXTBASE.DATAWD1);

   2697  1 000013   200006 236100                    LDQ     EXT$,,AUTO
         1 000014   000002 036003                    ADLQ    2,DU
         1 000015   200007 756100                    STQ     DATA$,,AUTO

      555     2698    1           IOWD$ = ADDR(EXTBASE.IOWD);

   2698  1 000016   200006 236100                    LDQ     EXT$,,AUTO
         1 000017   000001 036003                    ADLQ    1,DU
         1 000020   200010 756100                    STQ     IOWD$,,AUTO

      556     2699    2           DO CASE(REQ.EAINFO);

   2699  1 000021   000024 235100                    LDA     20,,PR0
         1 000022   000012 115007                    CMPA    10,DL
         1 000023   000025 602005 1                  TNC     s:2699+4,AL
         1 000024   000350 710000 1                  TRA     s:2770
         1 000025   000037 710000 1                  TRA     s:2701
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:122  
         1 000026   000116 710000 1                  TRA     s:2721
         1 000027   000133 710000 1                  TRA     s:2725
         1 000030   000147 710000 1                  TRA     s:2729
         1 000031   000164 710000 1                  TRA     s:2733
         1 000032   000201 710000 1                  TRA     s:2737
         1 000033   000214 710000 1                  TRA     s:2741
         1 000034   000231 710000 1                  TRA     s:2745
         1 000035   000246 710000 1                  TRA     s:2749
         1 000036   000263 710000 1                  TRA     s:2753

      557     2700    2            CASE(0);                       /* CWF - NEXT: PSR */

      558     2701    2              EXTBASE.EXTST.CWF = EXTBASE.IOWORD.CWF;

   2701  1 000037   200006 473500                    LDP3    EXT$,,AUTO
         1 000040   300001 236100                    LDQ     1,,PR3
         1 000041   300006 676100                    ERQ     6,,PR3
         1 000042   777774 376003                    ANQ     -4,DU
         1 000043   300006 656100                    ERSQ    6,,PR3

      559     2702    2              IOS.IDCW(0) = '310000724000'O; /* EXECUTE DLI COMMAND */

   2702  1 000044   000000 236000 0                  LDQ     0
         1 000045   100002 756100                    STQ     2,,PR1

      560     2703    2              IF HW_IMX THEN

   2703  1 000046   000000 234000 xsym               SZN     HW_IMX
         1 000047   000053 605000 1                  TPL     s:2705

      561     2704    2                 IOS.IDCW.DATA.BASE(0)=%IMX_IOS_BASE;

   2704  1 000050   000000 376000 2                  ANQ     0
         1 000051   000020 276003                    ORQ     16,DU
         1 000052   100002 756100                    STQ     2,,PR1

      562     2705    2              IOS.DCW(1) = '000000000001'O;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:123  

   2705  1 000053   000003 236000 xsym               LDQ     B_VECTNIL+3
         1 000054   100003 756100                    STQ     3,,PR1

      563     2706    2              IOS.DCW.FWA(1) = DATAPTR.WA;

   2706  1 000055   200007 220100                    LDX0    DATA$,,AUTO
         1 000056   100003 740100                    STX0    3,,PR1

      564     2707    2              DATA$->DATA(0) = '342062060000'O; /* READ PSR DATA */

   2707  1 000057   000001 236000 0                  LDQ     1
         1 000060   200007 473500                    LDP3    DATA$,,AUTO
         1 000061   300000 756100                    STQ     0,,PR3

      565     2708    2              IOS.IDCW(2) = '220000724000'O; /* READ MPC MEMORY */

   2708  1 000062   000002 236000 0                  LDQ     2
         1 000063   100004 756100                    STQ     4,,PR1

      566     2709    2              IF HW_IMX THEN

   2709  1 000064   000000 234000 xsym               SZN     HW_IMX
         1 000065   000071 605000 1                  TPL     s:2711

      567     2710    2                 IOS.IDCW.DATA.BASE(2)=%IMX_IOS_BASE;

   2710  1 000066   000000 376000 2                  ANQ     0
         1 000067   000020 276003                    ORQ     16,DU
         1 000070   100004 756100                    STQ     4,,PR1

      568     2711    2              IOS.DCW(3) = '000000000001'O; /* IOTD DATA + 1 */

   2711  1 000071   000003 236000 xsym               LDQ     B_VECTNIL+3
         1 000072   100005 756100                    STQ     5,,PR1

      569     2712    2              IOS.DCW.FWA(3) = DATAPTR.WA + 1;
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:124  

   2712  1 000073   000001 621010                    EAX1    1,X0
         1 000074   100005 741100                    STX1    5,,PR1

      570     2713    2              DATA$->DATA(1) = '001264000040'O; /* MPC MEMORY ADDRESS */

   2713  1 000075   000003 236000 0                  LDQ     3
         1 000076   300001 756100                    STQ     1,,PR3

      571     2714    2              IOS.IDCW(4) = '060000704000'O; /* INIT DATA TRANSFER */

   2714  1 000077   000004 236000 0                  LDQ     4
         1 000100   100006 756100                    STQ     6,,PR1

      572     2715    2              IF HW_IMX THEN

   2715  1 000101   000000 234000 xsym               SZN     HW_IMX
         1 000102   000106 605000 1                  TPL     s:2717

      573     2716    2                 IOS.IDCW.DATA.BASE(4)=%IMX_IOS_BASE;

   2716  1 000103   000000 376000 2                  ANQ     0
         1 000104   000020 276003                    ORQ     16,DU
         1 000105   100006 756100                    STQ     6,,PR1

      574     2717    2              IOS.DCW(5) = '000000000001'O;

   2717  1 000106   000003 236000 xsym               LDQ     B_VECTNIL+3
         1 000107   100007 756100                    STQ     7,,PR1

      575     2718    2              IOS.DCW.FWA(5) = IOWDPTR.WA;

   2718  1 000110   200010 222100                    LDX2    IOWD$,,AUTO
         1 000111   100007 742100                    STX2    7,,PR1

      576     2719    2              REQ.EAINFO = REQ.EAINFO + 1;

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:125  
   2719  1 000112   000024 235100                    LDA     20,,PR0
         1 000113   000001 035007                    ADLA    1,DL
         1 000114   000024 755100                    STA     20,,PR0
         1 000115   000350 710000 1                  TRA     s:2770

      577     2720    2            CASE(1);                       /* PSR - NEXT: PER */

      578     2721    2              EXTBASE.EXTST.PSR = EXTBASE.IOWORD.CONTAD.STS;

   2721  1 000116   200006 473500                    LDP3    EXT$,,AUTO
         1 000117   300001 236100                    LDQ     1,,PR3
         1 000120   000010 736000                    QLS     8
         1 000121   300004 676100                    ERQ     4,,PR3
         1 000122   776000 376003                    ANQ     -1024,DU
         1 000123   300004 656100                    ERSQ    4,,PR3

      579     2722    2              DATA$->DATA(0) = '342062064000'O;

   2722  1 000124   000005 236000 0                  LDQ     5
         1 000125   200007 473500                    LDP3    DATA$,,AUTO
         1 000126   300000 756100                    STQ     0,,PR3

      580     2723    2              REQ.EAINFO = REQ.EAINFO + 1;

   2723  1 000127   000024 235100                    LDA     20,,PR0
         1 000130   000001 035007                    ADLA    1,DL
         1 000131   000024 755100                    STA     20,,PR0
         1 000132   000350 710000 1                  TRA     s:2770

      581     2724    2            CASE(2);                       /* PER - NEXT: MR */

      582     2725    2              EXTBASE.EXTST.PER = EXTBASE.IOWORD.CONTAD.STS;

   2725  1 000133   200006 473500                    LDP3    EXT$,,AUTO
         1 000134   300001 236100                    LDQ     1,,PR3
         1 000135   300004 676100                    ERQ     4,,PR3
         1 000136   001774 376003                    ANQ     1020,DU
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:126  
         1 000137   300004 656100                    ERSQ    4,,PR3

      583     2726    2              DATA$->DATA(0) = '342062000000'O;

   2726  1 000140   000006 236000 0                  LDQ     6
         1 000141   200007 473500                    LDP3    DATA$,,AUTO
         1 000142   300000 756100                    STQ     0,,PR3

      584     2727    2              REQ.EAINFO = REQ.EAINFO + 1;

   2727  1 000143   000024 235100                    LDA     20,,PR0
         1 000144   000001 035007                    ADLA    1,DL
         1 000145   000024 755100                    STA     20,,PR0
         1 000146   000350 710000 1                  TRA     s:2770

      585     2728    2            CASE(3);                       /* MR - NEXT: RSR */

      586     2729    2              EXTBASE.EXTST.MR = EXTBASE.IOWORD.CONTAD.STS;

   2729  1 000147   200006 473500                    LDP3    EXT$,,AUTO
         1 000150   300001 236100                    LDQ     1,,PR3
         1 000151   000010 772000                    QRL     8
         1 000152   300004 676100                    ERQ     4,,PR3
         1 000153   000001 376000 2                  ANQ     1
         1 000154   300004 656100                    ERSQ    4,,PR3

      587     2730    2              DATA$->DATA(0) = '342062020000'O;

   2730  1 000155   000007 236000 0                  LDQ     7
         1 000156   200007 473500                    LDP3    DATA$,,AUTO
         1 000157   300000 756100                    STQ     0,,PR3

      588     2731    2              REQ.EAINFO = REQ.EAINFO + 1;

   2731  1 000160   000024 235100                    LDA     20,,PR0
         1 000161   000001 035007                    ADLA    1,DL
         1 000162   000024 755100                    STA     20,,PR0
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:127  
         1 000163   000350 710000 1                  TRA     s:2770

      589     2732    2            CASE(4);                       /* RSR - NEXT: DS1 */

      590     2733    2              EXTBASE.EXTST.RSR = EXTBASE.IOWORD.CONTAD.STS;

   2733  1 000164   200006 473500                    LDP3    EXT$,,AUTO
         1 000165   300001 236100                    LDQ     1,,PR3
         1 000166   000020 772000                    QRL     16
         1 000167   300004 676100                    ERQ     4,,PR3
         1 000170   007760 376007                    ANQ     4080,DL
         1 000171   300004 656100                    ERSQ    4,,PR3

      591     2734    2              DATA$->DATA(0) = '342062024000'O;

   2734  1 000172   000010 236000 0                  LDQ     8
         1 000173   200007 473500                    LDP3    DATA$,,AUTO
         1 000174   300000 756100                    STQ     0,,PR3

      592     2735    2              REQ.EAINFO = REQ.EAINFO + 1;

   2735  1 000175   000024 235100                    LDA     20,,PR0
         1 000176   000001 035007                    ADLA    1,DL
         1 000177   000024 755100                    STA     20,,PR0
         1 000200   000350 710000 1                  TRA     s:2770

      593     2736    2            CASE(5);                       /* DS1 - NEXT: DS2 */

      594     2737    2              EXTBASE.EXTST.DS1 = EXTBASE.IOWORD.CONTAD.STS;

   2737  1 000201   200006 473500                    LDP3    EXT$,,AUTO
         1 000202   003100 060500                    CSL     bolr='003'O
         1 000203   300001 100010                    BDSC    1,,PR3                   by=0,bit=8,n=8
         1 000204   300004 650010                    BDSC    4,,PR3                   by=3,bit=5,n=8

      595     2738    2              DATA$->DATA(0) = '342062030000'O;

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:128  
   2738  1 000205   000011 236000 0                  LDQ     9
         1 000206   200007 473500                    LDP3    DATA$,,AUTO
         1 000207   300000 756100                    STQ     0,,PR3

      596     2739    2              REQ.EAINFO = REQ.EAINFO + 1;

   2739  1 000210   000024 235100                    LDA     20,,PR0
         1 000211   000001 035007                    ADLA    1,DL
         1 000212   000024 755100                    STA     20,,PR0
         1 000213   000350 710000 1                  TRA     s:2770

      597     2740    2            CASE(6);                       /* DS2 - NEXT: ENR */

      598     2741    2              EXTBASE.EXTST.DS2 = EXTBASE.IOWORD.CONTAD.STS;

   2741  1 000214   200006 473500                    LDP3    EXT$,,AUTO
         1 000215   300001 236100                    LDQ     1,,PR3
         1 000216   000004 736000                    QLS     4
         1 000217   300005 676100                    ERQ     5,,PR3
         1 000220   037700 376003                    ANQ     16320,DU
         1 000221   300005 656100                    ERSQ    5,,PR3

      599     2742    2              DATA$->DATA(0) = '342062034000'O;

   2742  1 000222   000012 236000 0                  LDQ     10
         1 000223   200007 473500                    LDP3    DATA$,,AUTO
         1 000224   300000 756100                    STQ     0,,PR3

      600     2743    2              REQ.EAINFO = REQ.EAINFO + 1;

   2743  1 000225   000024 235100                    LDA     20,,PR0
         1 000226   000001 035007                    ADLA    1,DL
         1 000227   000024 755100                    STA     20,,PR0
         1 000230   000350 710000 1                  TRA     s:2770

      601     2744    2            CASE(7);                       /* ENR - NEXT: IFR */

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:129  
      602     2745    2              EXTBASE.EXTST.ENR = EXTBASE.IOWORD.CONTAD.STS;

   2745  1 000231   200006 473500                    LDP3    EXT$,,AUTO
         1 000232   300001 236100                    LDQ     1,,PR3
         1 000233   000004 772000                    QRL     4
         1 000234   300005 676100                    ERQ     5,,PR3
         1 000235   000002 376000 2                  ANQ     2
         1 000236   300005 656100                    ERSQ    5,,PR3

      603     2746    2              DATA$->DATA(0) = '342062014000'O;

   2746  1 000237   000013 236000 0                  LDQ     11
         1 000240   200007 473500                    LDP3    DATA$,,AUTO
         1 000241   300000 756100                    STQ     0,,PR3

      604     2747    2              REQ.EAINFO = REQ.EAINFO + 1;

   2747  1 000242   000024 235100                    LDA     20,,PR0
         1 000243   000001 035007                    ADLA    1,DL
         1 000244   000024 755100                    STA     20,,PR0
         1 000245   000350 710000 1                  TRA     s:2770

      605     2748    2            CASE(8);                       /* IFR - NEXT: DCR */

      606     2749    2              EXTBASE.EXTST.IFR = EXTBASE.IOWORD.CONTAD.STS;

   2749  1 000246   200006 473500                    LDP3    EXT$,,AUTO
         1 000247   300001 236100                    LDQ     1,,PR3
         1 000250   000014 772000                    QRL     12
         1 000251   300005 676100                    ERQ     5,,PR3
         1 000252   177400 376007                    ANQ     65280,DL
         1 000253   300005 656100                    ERSQ    5,,PR3

      607     2750    2              DATA$->DATA(0) = '342062001000'O;

   2750  1 000254   000014 236000 0                  LDQ     12
         1 000255   200007 473500                    LDP3    DATA$,,AUTO
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:130  
         1 000256   300000 756100                    STQ     0,,PR3

      608     2751    2              REQ.EAINFO = REQ.EAINFO + 1;

   2751  1 000257   000024 235100                    LDA     20,,PR0
         1 000260   000001 035007                    ADLA    1,DL
         1 000261   000024 755100                    STA     20,,PR0
         1 000262   000350 710000 1                  TRA     s:2770

      609     2752    2            CASE(9);                       /* DCR - ALL DONE NOW */

      610     2753    2              EXTBASE.EXTST.DCR = EXTBASE.IOWORD.CONTAD.STS;

   2753  1 000263   200006 473500                    LDP3    EXT$,,AUTO
         1 000264   300001 236100                    LDQ     1,,PR3
         1 000265   000024 772000                    QRL     20
         1 000266   300005 676100                    ERQ     5,,PR3
         1 000267   000377 376007                    ANQ     255,DL
         1 000270   300005 656100                    ERSQ    5,,PR3

      611     2754    2              NEWSTATE = REQ.POSTER;

   2754  1 000271   200004 473500                    LDP3    @NEWSTATE,,AUTO
         1 000272   000010 236100                    LDQ     8,,PR0
         1 000273   000777 376007                    ANQ     511,DL
         1 000274   300000 756100                    STQ     0,,PR3

      612     2755                   %LOCK (G#=F_DCBLOCK);

   2756  1 000275   000003 630400 2                  EPPR0   3
         1 000276   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000277   000000 701000 xent               TSX1    HFC$LOCK
         1 000300   000000 011000                    NOP     0

      613     2758    2              B$LS$->B$MLNK.MISC = B$LS$->B$MLNK.IOEND;

   2758  1 000301   000000 470400 xsym               LDP0    B$LS$
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:131  
         1 000302   000244 237100                    LDAQ    164,,PR0
         1 000303   000130 757100                    STAQ    88,,PR0

      614     2759    2              B$LS$->B$MLNK.MISC.BOUND = REQ.BUFSIZE - 1;

   2759  1 000304   200003 471500                    LDP1    @REQ,,AUTO
         1 000305   100004 236100                    LDQ     4,,PR1
         1 000306   000020 772000                    QRL     16
         1 000307   000001 136007                    SBLQ    1,DL
         1 000310   000020 736000                    QLS     16
         1 000311   000130 676100                    ERQ     88,,PR0
         1 000312   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000313   000130 656100                    ERSQ    88,,PR0

      615     2760    2              J = HW_PTB_UNITS/HW_IOPTP_UNITS;

   2760  1 000314   000000 236000 xsym               LDQ     HW_PTB_UNITS
         1 000315   000000 506000 xsym               DIV     HW_IOPTP_UNITS
         1 000316   200011 756100                    STQ     J,,AUTO

      616     2761    2              S_WSPTD.BLKNO(%IOENDWSQ) = REQ.PTP/J;

   2761  1 000317   100007 236100                    LDQ     7,,PR1
         1 000320   200011 506100                    DIV     J,,AUTO
         1 000321   000000 620006                    EAX0    0,QL
         1 000322   000007 740000 xsym               STX0    S_WSPTD+7

      617     2762    2              B$LS$->B$MLNK.MISC.BASE = REQ.BUFADDR + MOD(REQ.PTP,J)*HW_IOPTP_UNITS*
              2762                       4096;

   2762  1 000323   100007 236100                    LDQ     7,,PR1
         1 000324   200011 506100                    DIV     J,,AUTO
         1 000325   000044 733000                    LRS     36
         1 000326   000000 402000 xsym               MPY     HW_IOPTP_UNITS
         1 000327   000014 736000                    QLS     12
         1 000330   100006 036100                    ADLQ    6,,PR1
         1 000331   000131 756100                    STQ     89,,PR0
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:132  

      618     2763    2              CALL HFC$ASSOCCLR(%IOENDWSQ,0,16384); /*MAX Dense PT*/

   2763  1 000332   000005 630400 2                  EPPR0   5
         1 000333   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000334   000000 701000 xent               TSX1    HFC$ASSOCCLR
         1 000335   000000 011000                    NOP     0

      619     2764    2              B$MISC$->EXTST = EXTBASE.EXTST;

   2764  1 000336   200006 470500                    LDP0    EXT$,,AUTO
         1 000337   000000 471400 xsym               LDP1    B$MISC$
         1 000340   003100 060500                    CSL     bolr='003'O
         1 000341   000004 000130                    BDSC    4,,PR0                   by=0,bit=0,n=88
         1 000342   100000 000130                    BDSC    0,,PR1                   by=0,bit=0,n=88

      620     2765                   %UNLOCK (G#=F_DCBLOCK);

   2766  1 000343   000003 630400 2                  EPPR0   3
         1 000344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000345   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000346   000000 011000                    NOP     0

      621     2768    2              ALTRETURN;

   2768  1 000347   000000 702200 xent               TSX2  ! X66_AALT

      622     2769    2            END;                           /* DO CASE REQ.EAINFO */

      623     2770    1           RETURN;

   2770  1 000350   000000 702200 xent               TSX2  ! X66_ARET

      624     2771    1   NIU$CRPEXTST: ENTRY(REQ) ALTRET;

   2771  1 000351   000000 700200 xent  NIU$CRPEXTST TSX0  ! X66_AUTO_2
         1 000352   000014 000002                    ZERO    12,2
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:133  

      625     2772    1           IF REQ.BUFSIZE < %EXTST_SIZE    /* BUFFER TO SMALL */

   2772  1 000353   200003 470500                    LDP0    @REQ,,AUTO
         1 000354   000004 236100                    LDQ     4,,PR0
         1 000355   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000356   000010 116000 2                  CMPQ    8
         1 000357   000361 603000 1                  TRC     s:2774

      626     2773    1           THEN ALTRETURN;

   2773  1 000360   000000 702200 xent               TSX2  ! X66_AALT

      627     2774    1           IOS$ = REQ.IOS$;

   2774  1 000361   000012 236100                    LDQ     10,,PR0
         1 000362   200005 756100                    STQ     IOS$,,AUTO

      628     2775    1           CALL NIQ$GETS(EXT$) ALTRET(SKIP_EXTST);

   2775  1 000363   200006 631500                    EPPR1   EXT$,,AUTO
         1 000364   200012 451500                    STP1    J+1,,AUTO
         1 000365   200012 630500                    EPPR0   J+1,,AUTO
         1 000366   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000367   000000 701000 xent               TSX1    NIQ$GETS
         1 000370   000450 702000 1                  TSX2    SKIP_EXTST

      629     2776    1           EXTBASE.PTR$ = ADDR(NIL);

   2776  1 000371   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000372   200006 470500                    LDP0    EXT$,,AUTO
         1 000373   000000 756100                    STQ     0,,PR0

      630     2777    1           IOS.FL$ = EXT$;

   2777  1 000374   200006 236100                    LDQ     EXT$,,AUTO
         1 000375   200005 470500                    LDP0    IOS$,,AUTO
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:134  
         1 000376   000000 756100                    STQ     0,,PR0

      631     2778    1           REQ.TIMOUT = 5;

   2778  1 000377   200003 471500                    LDP1    @REQ,,AUTO
         1 000400   000005 236003                    LDQ     5,DU
         1 000401   100003 552120                    STBQ    3,'20'O,PR1

      632     2779    1           IF NOT HW_IMX THEN

   2779  1 000402   000000 234000 xsym               SZN     HW_IMX
         1 000403   000407 604000 1                  TMI     s:2781

      633     2780    1              IOS.PCW = '0000007'O;

   2780  1 000404   003100 060400                    CSL     bolr='003'O
         1 000405   000015 000025 0                  BDSC    13                       by=0,bit=0,n=21
         1 000406   000012 000110                    BDSC    10,,PR0                  by=0,bit=0,n=72

      634     2781    1           DATA$ = ADDR(EXTBASE.DATAWD1);

   2781  1 000407   200006 236100                    LDQ     EXT$,,AUTO
         1 000410   000002 036003                    ADLQ    2,DU
         1 000411   200007 756100                    STQ     DATA$,,AUTO

      635     2782    1           IOWD$ = ADDR(EXTBASE.IOWD);

   2782  1 000412   200006 236100                    LDQ     EXT$,,AUTO
         1 000413   000001 036003                    ADLQ    1,DU
         1 000414   200010 756100                    STQ     IOWD$,,AUTO

      636     2783    1           REQ.EAINFO = 0;                 /* SET UP TO READ CWF */

   2783  1 000415   100024 450100                    STZ     20,,PR1

      637     2784    1           IOS.IDCW(0) = '220000724000'O;  /* READ MPC MEMORY */

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:135  
   2784  1 000416   000002 236000 0                  LDQ     2
         1 000417   000002 756100                    STQ     2,,PR0

      638     2785    1           IF HW_IMX THEN

   2785  1 000420   000000 234000 xsym               SZN     HW_IMX
         1 000421   000425 605000 1                  TPL     s:2787

      639     2786    1              IOS.IDCW.DATA.BASE(0)=%IMX_IOS_BASE;

   2786  1 000422   000000 376000 2                  ANQ     0
         1 000423   000020 276003                    ORQ     16,DU
         1 000424   000002 756100                    STQ     2,,PR0

      640     2787    1           IOS.DCW(1) = '000000000001'O;   /* IOTD DATA */

   2787  1 000425   000003 236000 xsym               LDQ     B_VECTNIL+3
         1 000426   000003 756100                    STQ     3,,PR0

      641     2788    1           IOS.DCW.FWA(1) = DATAPTR.WA;

   2788  1 000427   200007 220100                    LDX0    DATA$,,AUTO
         1 000430   000003 740100                    STX0    3,,PR0

      642     2789    1           DATA$->DATA(0) = '001270000040'O; /* ADDR OF CWF IN MPC MEMORY */

   2789  1 000431   000016 236000 0                  LDQ     14
         1 000432   200007 473500                    LDP3    DATA$,,AUTO
         1 000433   300000 756100                    STQ     0,,PR3

      643     2790    1           IOS.IDCW(2) = '060000704000'O;  /* INIT DATA TRANSFER */

   2790  1 000434   000004 236000 0                  LDQ     4
         1 000435   000004 756100                    STQ     4,,PR0

      644     2791    1           IF HW_IMX THEN

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:136  
   2791  1 000436   000000 234000 xsym               SZN     HW_IMX
         1 000437   000443 605000 1                  TPL     s:2793

      645     2792    1              IOS.IDCW.DATA.BASE(2)=%IMX_IOS_BASE;

   2792  1 000440   000000 376000 2                  ANQ     0
         1 000441   000020 276003                    ORQ     16,DU
         1 000442   000004 756100                    STQ     4,,PR0

      646     2793    1           IOS.DCW(3) = '000000000001'O;

   2793  1 000443   000003 236000 xsym               LDQ     B_VECTNIL+3
         1 000444   000005 756100                    STQ     5,,PR0

      647     2794    1           IOS.DCW.FWA(3) = IOWDPTR.WA;

   2794  1 000445   200010 221100                    LDX1    IOWD$,,AUTO
         1 000446   000005 741100                    STX1    5,,PR0

      648     2795    1           RETURN;

   2795  1 000447   000000 702200 xent               TSX2  ! X66_ARET

      649     2796    1   SKIP_EXTST:
      650     2797    1           ALTRETURN;

   2797  1 000450   000000 702200 xent  SKIP_EXTST   TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
   0     000   310000 724000   342062 060000   220000 724000   001264 000040    .....20........
   0     004   060000 704000   342062 064000   342062 000000   342062 020000    0....24..2...2..
   0     010   342062 024000   342062 030000   342062 034000   342062 014000    .2...2...2...2..
   0     014   342062 001000   000000 700000   001270 000040                    .2.........

(unnamed)
 Sect OctLoc
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:137  
   2     000   777747 777777   000003 770000   000077 600000   000000 006000    .........?......
   2     004   000000 040000   000011 006000   000002 006000   000004 006000    .. .............
   2     010   000002 400000                                                    ....
      651     2798    1   END NIU$CRPEXTSTEA ;

PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:138  
--  Include file information  --

   NI$ERRLOG.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
      No diagnostics issued in procedure NIU$CRPEXTSTEA.
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:139  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @NEWSTATE                  3-0-0/w PTR         r     1 @REQ
     7-0-0/w PTR         r     1 DATA$                      7-0-0/w STRC        r     1 DATAPTR
     6-0-0/w PTR         r     1 EXT$                       5-0-0/w PTR         r     1 IOS$
    10-0-0/w PTR         r     1 IOWD$                     10-0-0/w STRC        r     1 IOWDPTR
    11-0-0/w SBIN        r     1 J                         *0-0-0/w UBIN        r     1 NEWSTATE
    *0-0-0/d STRC(1080)  r     1 REQ

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$LS$                      0-0-0/w PTR         r     1 B$MISC$
     0-0-0/w SBIN        r     1 F_DCBLOCK                  0-0-0/w BIT         r     1 HW_IMX
     0-0-0/w SBIN        r     1 HW_IOPTP_UNITS             0-0-0/w SBIN        r     1 HW_PTB_UNITS
     0-0-0/w STRC        r     1 S_WSPTD(0:28)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(10368) r     1 B$MLNK                     0-0-0/w BIT         r     1 DATA(0:0)
     0-0-0/w STRC(232)   r     1 EXTBASE                    0-0-0/w STRC(88)    r     1 EXTST
     0-0-0/d STRC(504)   r     1 IOS


   Procedure NIU$CRPEXTSTEA requires 297 words for executable code.
   Procedure NIU$CRPEXTSTEA requires 12 words of local(AUTO) storage.
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:140  

    No errors detected in file NIU$UNIT.:E05TSI    .
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:141  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:142  
          MINI XREF LISTING

B$LS$
      2665**DCL      2758>>ASSIGN   2758>>ASSIGN   2759>>ASSIGN   2762>>ASSIGN
B$MISC$
      2666**DCL      2764>>ASSIGN
B$MLNK.IOEND
      2390**DCL      2758>>ASSIGN
B$MLNK.MISC
      2162**DCL      2758<<ASSIGN
B$MLNK.MISC.BASE
      2167**DCL      2762<<ASSIGN
B$MLNK.MISC.BOUND
      2163**DCL      2759<<ASSIGN
DATA
      2671**DCL      2707<<ASSIGN   2713<<ASSIGN   2722<<ASSIGN   2726<<ASSIGN   2730<<ASSIGN   2734<<ASSIGN
      2738<<ASSIGN   2742<<ASSIGN   2746<<ASSIGN   2750<<ASSIGN   2789<<ASSIGN
DATA$
      2672**DCL      2673--REDEF    2697<<ASSIGN   2707>>ASSIGN   2713>>ASSIGN   2722>>ASSIGN   2726>>ASSIGN
      2730>>ASSIGN   2734>>ASSIGN   2738>>ASSIGN   2742>>ASSIGN   2746>>ASSIGN   2750>>ASSIGN   2781<<ASSIGN
      2789>>ASSIGN
DATAPTR.WA
      2674**DCL      2706>>ASSIGN   2712>>ASSIGN   2788>>ASSIGN
EXT$
      1827**DCL      1828--IMP-PTR  2695<<ASSIGN   2696>>ASSIGN   2697>>ASSIGN   2698>>ASSIGN   2701>>ASSIGN
      2701>>ASSIGN   2721>>ASSIGN   2721>>ASSIGN   2725>>ASSIGN   2725>>ASSIGN   2729>>ASSIGN   2729>>ASSIGN
      2733>>ASSIGN   2733>>ASSIGN   2737>>ASSIGN   2737>>ASSIGN   2741>>ASSIGN   2741>>ASSIGN   2745>>ASSIGN
      2745>>ASSIGN   2749>>ASSIGN   2749>>ASSIGN   2753>>ASSIGN   2753>>ASSIGN   2764>>ASSIGN   2775<>CALL
      2776>>ASSIGN   2777>>ASSIGN   2781>>ASSIGN   2782>>ASSIGN
EXTBASE.DATAWD1
      1837**DCL      2697--ASSIGN   2781--ASSIGN
EXTBASE.EXTST
      1839**DCL      2764>>ASSIGN
EXTBASE.EXTST.CWF
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:143  
      1849**DCL      2701<<ASSIGN
EXTBASE.EXTST.DCR
      1848**DCL      2753<<ASSIGN
EXTBASE.EXTST.DS1
      1844**DCL      2737<<ASSIGN
EXTBASE.EXTST.DS2
      1845**DCL      2741<<ASSIGN
EXTBASE.EXTST.ENR
      1846**DCL      2745<<ASSIGN
EXTBASE.EXTST.IFR
      1847**DCL      2749<<ASSIGN
EXTBASE.EXTST.MR
      1842**DCL      2729<<ASSIGN
EXTBASE.EXTST.PER
      1841**DCL      2725<<ASSIGN
EXTBASE.EXTST.PSR
      1840**DCL      2721<<ASSIGN
EXTBASE.EXTST.RSR
      1843**DCL      2733<<ASSIGN
EXTBASE.IOWD
      1830**DCL      1831--REDEF    2698--ASSIGN   2782--ASSIGN
EXTBASE.IOWORD.CONTAD.STS
      1835**DCL      2721>>ASSIGN   2725>>ASSIGN   2729>>ASSIGN   2733>>ASSIGN   2737>>ASSIGN   2741>>ASSIGN
      2745>>ASSIGN   2749>>ASSIGN   2753>>ASSIGN
EXTBASE.IOWORD.CWF
      1832**DCL      1833--REDEF    2701>>ASSIGN
EXTBASE.PTR$
      1829**DCL      2696<<ASSIGN   2776<<ASSIGN
EXTST
      2681**DCL      2764<<ASSIGN
F_DCBLOCK
      2667**DCL      2756<>CALL     2766<>CALL
HFC$ASSOCCLR
      1687**DCL-ENT  2763--CALL
HFC$LOCK
       486**DCL-ENT  2756--CALL
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:144  
HFC$UNLOCK
       486**DCL-ENT  2766--CALL
HW_IMX
       529**DCL      2703>>IF       2709>>IF       2715>>IF       2779>>IF       2785>>IF       2791>>IF
HW_IOPTP_UNITS
       524**DCL      2760>>ASSIGN   2762>>ASSIGN
HW_PTB_UNITS
       524**DCL      2760>>ASSIGN
IOS.DCW
      1700**DCL      1703--REDEF    2705<<ASSIGN   2711<<ASSIGN   2717<<ASSIGN   2787<<ASSIGN   2793<<ASSIGN
IOS.DCW.FWA
      1700**DCL      2706<<ASSIGN   2712<<ASSIGN   2718<<ASSIGN   2788<<ASSIGN   2794<<ASSIGN
IOS.DCW.TALLY
      1701**DCL      1701--REDEF
IOS.FL$
      1698**DCL      2695>>ASSIGN   2777<<ASSIGN
IOS.IDCW
      1703**DCL      2702<<ASSIGN   2708<<ASSIGN   2714<<ASSIGN   2784<<ASSIGN   2790<<ASSIGN
IOS.IDCW.DATA.BASE
      1703**DCL      2704<<ASSIGN   2710<<ASSIGN   2716<<ASSIGN   2786<<ASSIGN   2792<<ASSIGN
IOS.IDCW.EXTA
      1703**DCL      1703--REDEF
IOS.PCW
      1705**DCL      1709--REDEF    2780<<ASSIGN
IOS.SEEK
      1710**DCL      1711--REDEF    1712--REDEF
IOS$
      1826**DCL      1698--IMP-PTR  2694<<ASSIGN   2695>>ASSIGN   2702>>ASSIGN   2704>>ASSIGN   2705>>ASSIGN
      2706>>ASSIGN   2708>>ASSIGN   2710>>ASSIGN   2711>>ASSIGN   2712>>ASSIGN   2714>>ASSIGN   2716>>ASSIGN
      2717>>ASSIGN   2718>>ASSIGN   2774<<ASSIGN   2777>>ASSIGN   2780>>ASSIGN   2784>>ASSIGN   2786>>ASSIGN
      2787>>ASSIGN   2788>>ASSIGN   2790>>ASSIGN   2792>>ASSIGN   2793>>ASSIGN   2794>>ASSIGN
IOWD$
      2676**DCL      2677--REDEF    2698<<ASSIGN   2782<<ASSIGN
IOWDPTR.WA
      2678**DCL      2718>>ASSIGN   2794>>ASSIGN
J
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:145  
      2680**DCL      2760<<ASSIGN   2761>>ASSIGN   2762>>ASSIGN
N$REQ.BUFADDR
      1786**DCL      1787--REDEF    1787--REDEF
N$REQ.DLA.DRELADDR
      1778**DCL      1778--REDEF
N$REQ.DVE.EOMCHAR
      1815**DCL      1816--REDEF
N$REQ.EAINFO
      1809**DCL      1809--REDEF
N$REQ.EAINFOX
      1809**DCL      1810--REDEF
N$REQ.EVNTINFO
      1810**DCL      1810--REDEF
N$REQ.STATUS
      1791**DCL      1797--REDEF
NEWSTATE
       141**DCL         7--PROC     2754<<ASSIGN
NI$IOERR.EXTST
      1742**DCL      1744--REDEF
NIQ$GETS
      1685**DCL-ENT  2775--CALL
REQ
        92**DCL         7--PROC     2771--ENTRY
REQ.BUFADDR
       101**DCL       102--REDEF     102--REDEF    2762>>ASSIGN
REQ.BUFSIZE
        95**DCL      2759>>ASSIGN   2772>>IF
REQ.DLA.DRELADDR
        93**DCL        93--REDEF
REQ.DVE.EOMCHAR
       130**DCL       131--REDEF
REQ.EAINFO
       124**DCL       124--REDEF    2699>>DOCASE   2719<<ASSIGN   2719>>ASSIGN   2723<<ASSIGN   2723>>ASSIGN
      2727<<ASSIGN   2727>>ASSIGN   2731<<ASSIGN   2731>>ASSIGN   2735<<ASSIGN   2735>>ASSIGN   2739<<ASSIGN
      2739>>ASSIGN   2743<<ASSIGN   2743>>ASSIGN   2747<<ASSIGN   2747>>ASSIGN   2751<<ASSIGN   2751>>ASSIGN
      2783<<ASSIGN
PL6.E3A0      #004=NIU$CRPEXTSTEA File=NIU$UNIT.:E05TSI                          WED 07/30/97 03:40 Page:146  
REQ.EAINFOX
       124**DCL       125--REDEF
REQ.EVNTINFO
       125**DCL       125--REDEF
REQ.IOS$
       105**DCL      2694>>ASSIGN   2774>>ASSIGN
REQ.POSTER
       104**DCL      2754>>ASSIGN
REQ.PTP
       103**DCL      2761>>ASSIGN   2762>>ASSIGN
REQ.STATUS
       106**DCL       112--REDEF
REQ.TIMOUT
        94**DCL      2778<<ASSIGN
SKIP_EXTST
      2797**LABEL    2775--CALLALT
S_WSPTD.BLKNO
      1480**DCL      2761<<ASSIGN
