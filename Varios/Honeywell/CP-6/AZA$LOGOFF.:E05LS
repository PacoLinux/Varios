VERSION E05

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:1    
        1        1        /*M* AZA$LOGOFF  External procedure used to perform accounting                */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8        /*F* NAME: AZA$LOGOFF
        9        9             PURPOSE: To perform accounting for CP_6
       10       10             DESCRIPTION: AZA$LOGOFF performs accounting in several forms for
       11       11             CP_6. It performs proprietary accounting, step accounting, budget
       12       12             accounting, job end accounting, and RECOVERY job end accounting.
       13       13
       14       14             The AZA$LOGOFF module is LINKed into the following CP-6 processors:
       15       15                  GHOST1
       16       16                  IBEX
       17       17                  TPCP
       18       18
       19       19             REFERENCE: Specification File Section 17.3, Document 344
       20       20        */
       21       21        AZA$LOGOFF: PROC(LOGOFF_PARAM) ALTRET;
       22       22        /***********************************
       23       23         ****       INCLUDES
       24       24         ***********************************/
       25       25        %INCLUDE AR_TBLS_C;
       26      430        %INCLUDE AS_SUPER_C;
       27      865        %INCLUDE AZ_MACRO_C;
       28     3452        %INCLUDE AZ_PERR_C;
       29     3466        %INCLUDE AZ_SUBS_C;
       30     3535 S      %INCLUDE B$JIT_C;
       31     3536        %INCLUDE B_ERRORS_C;
       32     4663        %INCLUDE CP_6;
       33     4744        %INCLUDE CP_6_SUBS;
       34     5284        %INCLUDE B_MICROPS_C;
       35     5456        %INCLUDE XSJ_MAC_C;
       36     5535        %INCLUDE XSJ_SUBS_C;
       37     5562        %INCLUDE ES_SUBS_E;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:2    
       38     5588        %INCLUDE EL_SUBS_C;
       39     5672        %INCLUDE XUD_UTS_M;
       40     5754        %XUD$UTS_ENTRIES;
       41     5786        /***********************************
       42     5787         ****       SUBS
       43     5788         ***********************************/
       44     5789        %SUB F_STARS    = 0/* F_STARS */;
       45     5790        %SUB F_ACCTLG   = 1/* F_ACCTLG */;
       46     5791        %SUB F_RATES    = 2/* F_RATES */;
       47     5792        %SUB F_USERS    = 3/* F_USERS */;
       48     5793        %SUB F_JOBSTATS = 4/* F_JOBSTATS */;
       49     5794        /***********************************
       50     5795         ****       PARAMETERS
       51     5796         ***********************************/
       52     5797        %LOGOFF$PARAM(NAME = LOGOFF_PARAM,STCLASS = );
       53     5838        /***********************************
       54     5839         ****       BASED DATA
       55     5840         ***********************************/
       56     5841        %B$JIT0(STCLASS="BASED(JIT$)");
       57     5930        %U$JIT1;
       58     6004        %M$JIT2;
       59     6014        %F$JIT3;
       60     6019        %S$JIT4;
       61     6025        %J$JIT5;
       62     6113        %A$JIT6;
       63     6123        %B$TCB;
       64     6126        %B$ALT;
       65     6134        %F$DCB;
       66     6191        %ACCT_KEY(NAME = ACCT$KEY,STCLASS="BASED(IN_KEY$)");
       67     6251        %JSP(STCLASS="BASED(REC$)");
       68     6801        %JSP(NAME = JSP1,STCLASS="BASED(REC1$)");
       69     7351        %AZ_LCP6_JSP(NAME=FEPJSP,STCLASS="BASED(REC1$)");
       70     7829        %FPT_NODEINFO(STCLASS="BASED(REC$)");
       71     7841        %VLR_NODEINFO(STCLASS=BASED);
       72     7856    1   DCL 1 TEXT$C BASED,
       73     7857    1         2 LEN UBIN BYTE UNAL,
       74     7858    1         2 STRING CHAR(TEXT$C.LEN);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:3    
       75     7859        /***********************************
       76     7860         ****       CONSTANT DATA
       77     7861         ***********************************/
       78     7862        %FPT_RESCTL(FPTN    = FPT_RESCTLC,
       79     7863                    RELALL  = YES,
       80     7864                    STCLASS = CONSTANT);
       81     7881        %FPT_ENQ(FPTN = FPT_ENQC,
       82     7882                WAIT  = YES,
       83     7883                WAIT_TIME = -1,
       84     7884                SHARE = NONE,
       85     7885                STCLASS = CONSTANT);
       86     7903        %FPT_DEQ(FPTN = FPT_DEQC,
       87     7904                RELRES  = YES,
       88     7905                CANCEL  = NO,
       89     7906                STCLASS = CONSTANT);
       90     7923        %FPT_TIME(FPTN = FPT_TIMEC,STCLASS = CONSTANT,
       91     7924                  SOURCE = UTS,
       92     7925                  DEST   = EXT);
       93     7944        %FPT_OPEN(FPTN = FPT_OPENC,
       94     7945                SCRUB  = YES,
       95     7946                ASN    = FILE,
       96     7947                EXIST  = OLDFILE,
       97     7948                CTG    = YES,
       98     7949                STCLASS= CONSTANT);
       99     8058        %FPT_PRECORD(FPTN = FPT_PRECORDC,
      100     8059                KEYS      = YES,
      101     8060                KEYR      = NO,
      102     8061                STCLASS   = CONSTANT);
      103     8082        %FPT_READ(FPTN = FPT_READC,
      104     8083                STCLASS= CONSTANT);
      105     8122        %FPT_WRITE(FPTN = FPT_WRITEC,
      106     8123                STCLASS = CONSTANT);
      107     8154        %FPT_DELREC(FPTN = FPT_DELRECC,STCLASS = CONSTANT,
      108     8155                    KEY = LOW_KEY,
      109     8156                    LKEY= HIGH_KEY);
      110     8175        %VLP_NAME(FPTN = LOW_KEY,STCLASS = CONSTANT,
      111     8176                  NAME = 'a');
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:4    
      112     8203        %VLP_NAME(FPTN = HIGH_KEY,STCLASS = CONSTANT,
      113     8204                  NAME = 'b');
      114     8231        %FPT_CLOSE(FPTN = FPT_CLOSEC,
      115     8232                STCLASS = CONSTANT);
      116     8274        %VLP_NAME(FPTN = SACCUM_KEY,
      117     8275                NAME   = 'AZ_ACCUM',
      118     8276                STCLASS= CONSTANT);
      119     8303        %VLP_NAME(FPTN = STARS_NAME,STCLASS = CONSTANT,
      120     8304                NAME = '*S');
      121     8331        %FPT_WRSYSLOG(FPTN=WR_SECLOG_CONST,
      122     8332                      STCLASS=CONSTANT,
      123     8333                      TYPE=EL_SYS_EXIT,
      124     8334                      FILENUM=EL_SEC);
      125     8349        %FPT_NODEINFO(FPTN = FPT_NODEINFOC,
      126     8350                STCLASS = CONSTANT);
      127     8362        %G$JIT_E;                               /* Get EQUs for Fep RNSTs             */
      128     8424    1   DCL 1 RNSTCVT(0:8) CONSTANT ALIGNED,
      129     8425    1         2 FEP BIT(18) INIT (
      130     8426    1      %CONCAT('0'B,SUBBIT(G_RS_XKEY#,0,8),'0'B,SUBBIT(G_RS_XKEY#,8)),
      131     8427    1      %CONCAT('0'B,SUBBIT(G_RS_DSC#,0,8),'0'B,SUBBIT(G_RS_DSC#,8)),
      132     8428    1      %CONCAT('0'B,SUBBIT(G_RS_OFF#,0,8),'0'B,SUBBIT(G_RS_OFF#,8)),
      133     8429    1      %CONCAT('0'B,SUBBIT(G_RS_LIMX#,0,8),'0'B,SUBBIT(G_RS_LIMX#,8)),
      134     8430    1      %CONCAT('0'B,SUBBIT(G_RS_EKEY#,0,8),'0'B,SUBBIT(G_RS_EKEY#,8)),
      135     8431    1      %CONCAT('0'B,SUBBIT(G_RS_SSP#,0,8),'0'B,SUBBIT(G_RS_SSP#,8)),
      136     8432    1      %CONCAT('0'B,SUBBIT(G_RS_ABRT#,0,8),'0'B,SUBBIT(G_RS_ABRT#,8)),
      137     8433    1      %CONCAT('0'B,SUBBIT(G_RS_XXX#,0,8),'0'B,SUBBIT(G_RS_XXX#,8)),
      138     8434    1      %CONCAT('0'B,SUBBIT(G_RS_ERR#,0,8),'0'B,SUBBIT(G_RS_ERR#,8))),
      139     8435    1         2 HOST BIT(18) INIT (
      140     8436    1      %RS_XKEY#,
      141     8437    1      %RS_DROP#,
      142     8438    1      %RS_OFF#,
      143     8439    1      %RS_LIMX#,
      144     8440    1      %RS_EKEY#,
      145     8441    1      %RS_SSP#,
      146     8442    1      %RS_ABRT#,
      147     8443    1      %RS_XXX#,
      148     8444    1      %RS_ERR#);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:5    
      149     8445        /***********************************
      150     8446         ****       'GLOBAL' AUTO DATA
      151     8447         ***********************************/
      152     8448    1   DCL REC(0:1023) SBIN;                   /* SPACE FOR CURRENT JSP RECORD       */
      153     8449    1   DCL REC1(0:1023) SBIN;                  /* Space to read *S records into      */
      154     8450    1   DCL REC$ PTR;                           /* PTR TO REC                         */
      155     8451    1   DCL REC1$ PTR;                          /* Pointer to REC1                    */
      156     8452    1   DCL RECLEN SBIN;                        /* Current length in bytes of JSP     */
      157     8453    1   DCL JIT$ PTR;                           /* POINTER TO THE USER'S JIT          */
      158     8454    1   DCL DCB1$ PTR;                          /* PTR TO DCB 1                       */
      159     8455    1   DCL 1 SACCUM,                           /* Used to accumulate proprietary     */
      160     8456    1         2 PCHG(0:32) SBIN,                /* charges for the entire job         */
      161     8457    1         2 SUNIT(0:3) SBIN;
      162     8458    1   DCL PACCUM(0:32) SBIN;                  /* Used to accumulate proprietary     */
      163     8459                                                /* charges for this step              */
      164     8460    1   DCL 1 IN_KEY,
      165     8461    1         2 LEN UBIN BYTE UNAL,
      166     8462    1         2 KEY CHAR(35);
      167     8463    1   DCL IN_KEY$ PTR;                        /* Pointer to IN_KEY                  */
      168     8464    1   DCL LAST_STEP SBIN WORD;
      169     8465    1   DCL TEMP SBIN;                          /* Temporary value                    */
      170     8466    1   DCL PROCNUM UBIN;                  /* To hold proprietary accounting proc num */
      171     8467    1   DCL ASN_SAVE UBIN;                      /* ASN for error reporting            */
      172     8468    1   DCL DCB#_SAVE UBIN;                     /* DCB number for error reporting     */
      173     8469        %FPT_RESCTL(FPTN = FPT_RESCTL,STCLASS = AUTO);
      174     8486        %VLP_PSEUDO(FPTN = VLP_PSEUDO,N=0,STCLASS=AUTO);
      175     8502        %FPT_ENQ(FPTN = FPT_ENQ,STCLASS = AUTO);
      176     8520        %FPT_DEQ(FPTN = FPT_DEQ,STCLASS = AUTO);
      177     8537        %FPT_TIME(FPTN = FPT_TIME,STCLASS = AUTO);
      178     8556        %FPT_OPEN(FPTN = FPT_OPEN,STCLASS = AUTO);
      179     8665        %FPT_PRECORD(FPTN = FPT_PRECORD,STCLASS = AUTO);
      180     8686        %FPT_READ(FPTN = FPT_READ,STCLASS = AUTO);
      181     8725        %FPT_WRITE(FPTN = FPT_WRITE,STCLASS = AUTO);
      182     8756        %FPT_DELREC(FPTN = FPT_DELREC,STCLASS = AUTO);
      183     8775        %FPT_CLOSE(FPTN = FPT_CLOSE,STCLASS = AUTO);
      184     8817        %FPT_ACCT(FPTN = FPT_ACCT,STCLASS = AUTO);
      185     8833        %VLP_NAME(FPTN = NAME_SAVE,LEN = 31,STCLASS = AUTO);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:6    
      186     8860        %VLP_ACCT(FPTN = ACCT_SAVE,STCLASS = AUTO);
      187     8873        %VLP_SN(FPTN = SN_SAVE,N = 1,STCLASS = AUTO);
      188     8886        %ACCT_KEY(NAME = ACCT_KEY_SAVE,STCLASS = AUTO);
      189     8946        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
      190     8947                      STCLASS=AUTO);
      191     8962        /***********************************
      192     8963         ****       SYMREFs
      193     8964         ***********************************/
      194     8965    1   DCL B$JIT$ PTR SYMREF;
      195     8966    1   DCL B$TCB$ PTR SYMREF;
      196     8967        /***********************************
      197     8968         ****       ENTREFs
      198     8969         ***********************************/
      199     8970    1   DCL AZB$FAD ENTRY(2);
      200     8971    1   DCL AZA$FLTTODEC ENTRY(2) ALTRET;
      201     8972    1   DCL AZB$FDV ENTRY(2);
      202     8973    1   DCL AZB$FMP ENTRY(2);
      203     8974    1   DCL AZB$FLOAT ENTRY(2);
      204     8975    1   DCL AZB$MTH3D2B ENTRY(7);
      205     8976    1   DCL AZB$FSB ENTRY(2);
      206     8977    1   DCL XSJ$OPEN ENTRY(1) ALTRET;
      207     8978    1   DCL XSJ$WRITE ENTRY(1) ALTRET;
      208     8979        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:7    
      209     8980        /***********************************
      210     8981         **** Code starts here
      211     8982         ***********************************/
      212     8983    1      CALL INITIALIZE;
      213     8984    1      IF LOGOFF_PARAM.CODE=%AZ$STEP
      214     8985    1        AND B$JIT.SSLEV = %AZ_NONE#
      215     8986    1        AND ((B$JIT.CPFLAGS1 & (%CP_STEPACCT# | %CP_STARPROC#))='0'B)
      216     8987    1      THEN GOTO BUDGET;                    /* Budget check only                  */
      217     8988
      218     8989
      219     8990    1      IF LOGOFF_PARAM.CODE~=%AZ$STATUS
      220     8991    1        AND ((B$JIT.CPFLAGS1 & (%CP_STEPACCT# | %CP_STARPROC#))~='0'B
      221     8992    1        OR B$JIT.SSLEV~=%AZ_NONE#)
      222     8993    2      THEN DO;                             /* Handle all PROC and STEP records   */
      223     8994                                                /* in the *S file                     */
      224     8995    2           CALL OPEN_FILE(F_STARS) ALTRET(ALT1);
      225     8996    2           ACCT$KEY = '001141'O;           /* LEN=1 and KEY='a'                  */
      226     8997    2           FPT_PRECORD.V.N# = 0;
      227     8998    2           CALL M$PRECORD(FPT_PRECORD) ALTRET(IGNORE);
      228     8999    2   IGNORE: FPT_READ.V.KEYR# = '1'B;
      229     9000    2           FPT_READ.V.KEYS# = '0'B;
      230     9001    2           FPT_READ.BUF_ = VECTOR(REC1);
      231     9002    2           REC1='0'B;
      232     9003    2           CALL M$READ(FPT_READ) ALTRET(ALT1);
      233     9004    2           LAST_STEP = 0;                  /* An impossible step number          */
      234     9005    3           DO WHILE(ACCT$KEY.L>0 AND ACCT$KEY.ACCT#='a'
      235     9006    3             AND ACCT$KEY.PROC#~=511);
      236     9007    3                CALL OPEN_FILE(F_STARS) ALTRET(ALT1);
      237     9008    3                FPT_PRECORD.V.N# = 1;
      238     9009    3                CALL M$PRECORD(FPT_PRECORD) ALTRET(IGNORE2);
      239     9010    3   IGNORE2:     FPT_READ.V.KEYR# = '1'B;
      240     9011    3                FPT_READ.V.KEYS# = '0'B;
      241     9012    3                FPT_READ.BUF_ = VECTOR(REC1);
      242     9013    3                PROCNUM = ACCT$KEY.PROC#;
      243     9014    3                CALL FILL_REC ALTRET(BAD_FILL);
      244     9015                                                /* With the last read record and all  */
      245     9016                                                /* the rest of its STEP and PROC#     */
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:8    
      246     9017    3                IF JSP.STEP~=LAST_STEP
      247     9018    4                THEN DO;                   /* Must clear out PACCUM              */
      248     9019    4                     PACCUM = '0'B;
      249     9020    4                     LAST_STEP = JSP.STEP;
      250     9021    4                     END;
      251     9022    3                CALL CHARGE_PRINT;
      252     9023    3                IF (B$JIT.CPFLAGS1&(%CP_STEPACCT#|%CP_STARPROC#))~='0'B
      253     9024    3                THEN CALL SEND_REC;
      254     9025    3                ACCT$KEY = ACCT_KEY_SAVE;
      255     9026                                                /* To continue via the next PRECORD   */
      256     9027    3                END;
      257     9028    2           CALL OPEN_FILE(F_STARS) ALTRET(ALT1);
      258     9029    2           CALL M$DELREC(FPT_DELREC) ALTRET(ALT1);
      259     9030                                                /* Delete all proc and step records   */
      260     9031    2           END;
      261     9032    1   BAD_FILL:
      262     9033    2      DO WHILE('0'B);
      263     9034    2   ALT1:   CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      264     9035    2           RETURN;
      265     9036    2           END;
      266     9037
      267     9038        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:9    
      268     9039    1      IF LOGOFF_PARAM.CODE~=%AZ$STEP
      269     9040    2      THEN DO;
      270     9041    2           CALL FILL_REC(LOGOFF_PARAM.CODE) ALTRET(ALT2);
      271     9042    2           CALL CHARGE_PRINT;
      272     9043    2           IF LOGOFF_PARAM.CODE=%AZ$JOBEND OR LOGOFF_PARAM.CODE=%AZ$RECOVERY
      273     9044    3           THEN DO;
      274     9045                     /* The value of ES_LOGSYSEXIT will be checked by the
      275     9046                        WRSYSLOG pmme to see if we really want to log this.
      276     9047                        If not, it just returns. It's too painful to check
      277     9048                        here.                                            */
      278     9049    3                WR_SECLOG=WR_SECLOG_CONST;
      279     9050    3                WR_SECLOG.V_=VECTOR(WR_SECLOG.V);
      280     9051    3                WR_SECLOG.ENTRY_=VECTOR(B$JIT);
      281     9052    3                CALL M$WRSYSLOG(WR_SECLOG);
      282     9053    3                CALL UP_USERS;             /* Update the :USERS file with        */
      283     9054                                                /* total charge information           */
      284     9055    3                IF B$JIT.MODE=%M_BATCH#
      285     9056    3                THEN CALL WR_JOBSTATS;
      286     9057                                                /* Put out the :JOBSTATS record       */
      287     9058    3                END;
      288     9059    2           IF LOGOFF_PARAM.CODE~=%AZ$STATUS
      289     9060    2           THEN CALL SEND_REC;             /* Send the record through AZI$INST   */
      290     9061                                                /* and then to :ACCTLG                */
      291     9062    2   ALT2:   END;
      292     9063
      293     9064        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:10   
      294     9065    1   BUDGET: IF LOGOFF_PARAM.CODE=%AZ$STEP
      295     9066    1        AND B$JIT.BUDLIM~=0
      296     9067    1        AND LOGOFF_PARAM.ERR<%AZ$BUDLIM
      297     9068    2      THEN DO;                             /* Perform BUDGET accounting          */
      298     9069    2           CALL FILL_REC(%AZ$BUDGET) ALTRET(ALT3);
      299     9070                                                /* Fill the JSP record as for STATUS  */
      300     9071    2           CALL CHARGE_PRINT;              /* Calculate charges but don't        */
      301     9072                                                /* output any statistics              */
      302     9073    2           LOGOFF_PARAM.ACCUM_CHG = JSP.CHG ;
      303     9074    2           IF B$JIT.BUDLIM - JSP.CHG < 0
      304     9075    2           THEN CALL POST_ERR(%AZ$BUDLIM,,%E$AZ_BUDLIM);
      305     9076        /*E* ERROR: AZA-E$AZ_BUDLIM
      306     9077             MESSAGE: Your budget has been exceeded
      307     9078        */
      308     9079    2   ALT3:   END;
      309     9080        /***********************************
      310     9081         **** Output PGRANS record if necessary
      311     9082         ***********************************/
      312     9083    1      IF (LOGOFF_PARAM.CODE=%AZ$JOBEND OR LOGOFF_PARAM.CODE=%AZ$RECOVERY)
      313     9084    1        AND B$JIT.GAC~='0'B
      314     9085    1      THEN CALL OUT_PGRANS;
      315     9086        /***********************************
      316     9087         **** Write out SACCUM record
      317     9088         ***********************************/
      318     9089    1      IF LOGOFF_PARAM.CODE=%AZ$STEP AND SACCUM~='0'B
      319     9090    2      THEN DO;
      320     9091    2           CALL OPEN_FILE(F_STARS) ALTRET(ALTL);
      321     9092    2           FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;
      322     9093    2           FPT_WRITE.BUF_ = VECTOR(SACCUM);
      323     9094    2           FPT_WRITE.KEY_ = VECTOR(SACCUM_KEY);
      324     9095    2           CALL M$WRITE(FPT_WRITE) ALTRET(ALTL);
      325     9096    2           END;
      326     9097    2      DO WHILE('0'B);
      327     9098    2   ALTL:   CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      328     9099    2           END;
      329     9100        /***********************************
      330     9101         **** Miscellaneous
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:11   
      331     9102         ***********************************/
      332     9103    1      IF LOGOFF_PARAM.CODE~=%AZ$STATUS
      333     9104    1      THEN B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 & ~%CP_STARPROC#;
      334     9105        /***********************************
      335     9106         **** Return or altreturn with correct error in LOGOFF_PARAM.ERR
      336     9107         ***********************************/
      337     9108    1      IF DCB1$->F$DCB.FCD#
      338     9109    1      THEN CALL M$CLOSE(FPT_CLOSE) ALTRET(CLS_ALT);
      339     9110                                                /* Clean up any open file             */
      340     9111    2      DO WHILE('0'B);
      341     9112    2   CLS_ALT: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      342     9113    2           END;
      343     9114    1      IF LOGOFF_PARAM.CODE=%AZ$RECOVERY
      344     9115    2      THEN DO;
      345     9116    2           FPT_OPEN = FPT_OPENC;
      346     9117    2           FPT_OPEN.V_ = VECTOR(FPT_OPEN.V);
      347     9118    2           FPT_OPEN.V.DCB# = LOGOFF_PARAM.DCB1;
      348     9119    2           FPT_OPEN.NAME_ = VECTOR(STARS_NAME);
      349     9120    2           FPT_OPEN.V.DELETE# = %YES#;
      350     9121    2           CALL M$OPEN(FPT_OPEN) ALTRET(IG1); /* Delete the *S file              */
      351     9122    2   IG1:    END;
      352     9123    1      IF LOGOFF_PARAM.ERR=0
      353     9124    1      THEN RETURN;
      354     9125    1      ELSE IF DCB#_SAVE~=0
      355     9126    2           THEN DO;                        /* Restore error info to errored DCB  */
      356     9127    2                B$JIT.USRDCB = DCB#_SAVE;
      357     9128    2                IF DCBADDR(DCB#_SAVE) -> F$DCB.FCD#
      358     9129    3                THEN DO;
      359     9130    3                     FPT_CLOSE.V.DCB# = DCB#_SAVE;
      360     9131    3                     CALL M$CLOSE(FPT_CLOSE) ALTRET(SET_ALT);
      361     9132    3                     END;
      362     9133    2                FPT_OPEN = FPT_OPENC;
      363     9134    2                FPT_OPEN.V_ = VECTOR(FPT_OPEN.V);
      364     9135    2                FPT_OPEN.V.DCB# = DCB#_SAVE;
      365     9136    2                FPT_OPEN.V.SETDCB# = %YES#;
      366     9137    2                FPT_OPEN.NAME_ = VECTOR(NAME_SAVE);
      367     9138    2                FPT_OPEN.ACCT_ = VECTOR(ACCT_SAVE);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:12   
      368     9139    2                FPT_OPEN.SN_ = VECTOR(SN_SAVE);
      369     9140    2                FPT_OPEN.V.ASN# = ASN_SAVE;
      370     9141    2                CALL M$OPEN(FPT_OPEN) ALTRET(SET_ALT);
      371     9142    3                DO WHILE('0'B);
      372     9143    3   SET_ALT:          CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      373     9144    3                     END;
      374     9145    2                END;
      375     9146    1      ALTRETURN;
      376     9147        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:13   
      377     9148        /*P* NAME: AZA$FEPACCTNG
      378     9149             PURPOSE: To perform accounting for LCP6
      379     9150             DESCRIPTION: LOGOFF_PARAM contains a pointer to an LCP6 JSP record,
      380     9151             which is converted to Host JSP form and accounted in the usual way.
      381     9152             :USERS is then updated with the charges.
      382     9153        */
      383     9154
      384     9155    1   AZA$FEPACCTNG: ENTRY (LOGOFF_PARAM) ALTRET;
      385     9156
      386     9157    1      JIT$ = ADDR(REC1);
      387     9158    1      REC1 = '0'B;
      388     9159    1      REC1$ = LOGOFF_PARAM.JIT$;
      389     9160    1      B$JIT.BILL = FEPJSP.BILL;
      390     9161    1      REC$ = ADDR(REC);
      391     9162    1      FPT_NODEINFO = FPT_NODEINFOC;
      392     9163    1      VBASE(FPT_NODEINFO.V_) = ADDR(FPT_NODEINFO.V);
      393     9164    1      FPT_NODEINFO.V.NODENUM# = FEPJSP.FEP#;
      394     9165    1      FPT_NODEINFO.NODEINFO_ = VECTOR(ADDR(REC(SIZEW(JSP)))->VLR_NODEINFO);
      395     9166    2      CALL M$NODEINFO (FPT_NODEINFO) WHENRETURN DO;
      396     9167    2           END;
      397     9168    1      JSP = '0'B;
      398     9169    1      JSP.WOO = ADDR(REC(SIZEW(JSP)))->VLR_NODEINFO.NODENAME#;
      399     9170    1      JSP.ACCN = FEPJSP.ACCN;
      400     9171    1      JSP.UNAME = FEPJSP.UNAME;
      401     9172    1      JSP.PROCNAME = FEPJSP.PROCNAME;
      402     9173    1      JSP.TYPE = FEPJSP.TYPE;
      403     9174    1      JSP.SYSID = FEPJSP.SYSID;
      404     9175    1      JSP.START = FEPJSP.START;
      405     9176    1      JSP.STEP = FEPJSP.STEP;
      406     9177    1      JSP.MODE = FEPJSP.MODE+4;
      407     9178    1      JSP.STEPCC = FEPJSP.STEPCC;
      408     9179    1      IF FEPJSP.TYPE=%AZ$PROC OR FEPJSP.TYPE=%AZ$STEP
      409     9180    1      THEN JSP.JSUNITS = FEPJSP.STEPUNIT;
      410     9181    1      ELSE JSP.JSUNITS = FEPJSP.JSUNIT;
      411     9182    1      JSP.SUBMIT = FEPJSP.START;
      412     9183    1      JSP.CUR_UTS = FEPJSP.STOP;
      413     9184    1      JSP.CONNECT = FEPJSP.STOP-FEPJSP.START;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:14   
      414     9185    1      JSP.ELAPSED = JSP.CONNECT;
      415     9186    1      JSP.ATITLE = ' ';
      416     9187    1      JSP.UEXEC = FEPJSP.TUEXT;
      417     9188    1      JSP.USTIME = FEPJSP.TUSVT;
      418     9189    1      JSP.UMEMTIM = FEPJSP.UMEMTIM;
      419     9190    1      JSP.PEXEC = FEPJSP.PROC_EXTIME;
      420     9191    1      JSP.PSTIME = FEPJSP.PROC_SVTIME;
      421     9192    1      JSP.PMEMTIM = FEPJSP.PROC_MEMTIME;
      422     9193    1      JSP.PMMES = FEPJSP.MCLS;
      423     9194    1      JSP.PKCO = FEPJSP.PEAK_MEM;
      424     9195    1      JSP.RESPEAK = FEPJSP.PEAK_MEM;
      425     9196    1      JSP.TINTER = FEPJSP.READS_UC + FEPJSP.WRITES_UC;
      426     9197    1      JSP.UFTPS = BINBIT(FEPJSP.PEAK_LVLS,16);
      427     9198    1      JSP.XLIMFLG = FEPJSP.XLIMFLG;
      428     9199    1      JSP.ORACCESS = FEPJSP.READS_HOST + FEPJSP.WRITES_HOST;
      429     9200    2      DO TEMP = 0 TO 8;
      430     9201    2           IF FEPJSP.FRS&RNSTCVT.FEP(TEMP)
      431     9202    2           THEN JSP.RNST = JSP.RNST|RNSTCVT.HOST(TEMP);
      432     9203    2           END;
      433     9204    1      TEMP = %AZ_NONE#;
      434     9205    1      IF LOGOFF_PARAM.DCB_LL~=0 THEN TEMP = %AZ_ALL#;
      435     9206    1      B$JIT.SSLEV = TEMP;
      436     9207    1      B$JIT.JSLEV = TEMP;
      437     9208    1      B$JIT.PSLEV = TEMP;
      438     9209    1      PACCUM = '0'B;
      439     9210    1      CALL INITIALIZE_FEP;
      440     9211    1      CALL CHARGE_PRINT;
      441     9212    1      CALL UP_USERS;
      442     9213    1      LOGOFF_PARAM.ACCUM_CHG = JSP.CHG;
      443     9214    1      RETURN;
      444     9215        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:15   
      445     9216    1   INITIALIZE: PROC;
      446     9217        /*I* NAME: INITIALIZE
      447     9218             PURPOSE: To perform initialization for LOGOFF
      448     9219        */
      449     9220    2      IF LOGOFF_PARAM.CODE=%AZ$RECOVERY
      450     9221    2      THEN JIT$ = LOGOFF_PARAM.JIT$;
      451     9222    2      ELSE JIT$ = B$JIT$;
      452     9223    2      IF LOGOFF_PARAM.CODE=%AZ$JOBEND
      453     9224    3      THEN DO;
      454     9225    3           B$JIT.REMLO = 1;
      455     9226    3           FPT_RESCTL = FPT_RESCTLC;
      456     9227    3           FPT_RESCTL.V_ = VECTOR(FPT_RESCTL.V);
      457     9228    3           FPT_RESCTL.V.RELALL# = %YES#;
      458     9229    3           VLP_PSEUDO = '0'B;
      459     9230    3           VLP_PSEUDO.MEMORY# = B$JIT.RESCORE;
      460     9231    3           CALL M$RELRES(FPT_RESCTL) ALTRET(OK_ALT);
      461     9232    3   OK_ALT: FPT_RESCTL.PSEUDO_ = VECTOR(VLP_PSEUDO);
      462     9233    3           CALL M$LIMIT(FPT_RESCTL) ALTRET(RELALT);
      463     9234    4           DO WHILE('0'B);
      464     9235    4   RELALT:      CALL POST_ERR(%AZ$LOGOFFERR);
      465     9236    4                END;
      466     9237    3           END;
      467     9238    2   INITIALIZE_FEP: ENTRY;
      468     9239    2      IN_KEY$ = ADDR(IN_KEY);
      469     9240    2      DCB1$ = DCBADDR(LOGOFF_PARAM.DCB1);
      470     9241    2      REC$ = ADDR(REC);
      471     9242    2      REC1$ = ADDR(REC1);
      472     9243    2      LOGOFF_PARAM.ERR = 0;
      473     9244    2      DCB#_SAVE = 0;
      474     9245    2      FPT_ACCT.V_ = VECTOR(FPT_ACCT.V);
      475     9246    2      FPT_ACCT.BUF_ = VECTOR(REC);
      476     9247    2      FPT_ACCT.LEN_ = VECTOR(RECLEN);
      477     9248    2      FPT_ACCT.PNAME_ = VECTOR(NIL);
      478     9249    2      FPT_ACCT.JIT_ = VECTOR(B$JIT);
      479     9250    2      FPT_ACCT.V.UTS# = LOGOFF_PARAM.UTS;
      480     9251    2      FPT_ACCT.V.STAROUT# = '0'B;
      481     9252    2      FPT_PRECORD = FPT_PRECORDC;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:16   
      482     9253    2      FPT_PRECORD.V_ = VECTOR(FPT_PRECORD.V);
      483     9254    2      FPT_PRECORD.V.DCB# = LOGOFF_PARAM.DCB1;
      484     9255    2      FPT_PRECORD.KEY_ = VECTOR(IN_KEY);
      485     9256    2      FPT_READ = FPT_READC;
      486     9257    2      FPT_READ.V_ = VECTOR(FPT_READ.V);
      487     9258    2      FPT_READ.KEY_ = VECTOR(IN_KEY);
      488     9259    2      FPT_READ.V.DCB# = LOGOFF_PARAM.DCB1;
      489     9260    2      FPT_WRITE = FPT_WRITEC;
      490     9261    2      FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);
      491     9262    2      FPT_DELREC = FPT_DELRECC;
      492     9263    2      FPT_DELREC.V_ = VECTOR(FPT_DELREC.V);
      493     9264    2      FPT_DELREC.V.DCB# = LOGOFF_PARAM.DCB1;
      494     9265    2      FPT_CLOSE = FPT_CLOSEC;
      495     9266    2      FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
      496     9267    2      FPT_CLOSE.V.DCB# = LOGOFF_PARAM.DCB1;
      497     9268    2      FPT_ENQ = FPT_ENQC;
      498     9269    2      FPT_ENQ.V_ = VECTOR(FPT_ENQ.V);
      499     9270    2      FPT_ENQ.V.DCB# = LOGOFF_PARAM.DCB1;
      500     9271    2      FPT_ENQ.RNAME_ = VECTOR(IN_KEY);
      501     9272    2      FPT_DEQ = FPT_DEQC;
      502     9273    2      FPT_DEQ.V_ = VECTOR(FPT_DEQ.V);
      503     9274    2      FPT_DEQ.V.DCB# = LOGOFF_PARAM.DCB1;
      504     9275    2      FPT_DEQ.RNAME_ = VECTOR(IN_KEY);
      505     9276    2      FPT_TIME = FPT_TIMEC;
      506     9277    2      FPT_TIME.V_ = VECTOR(FPT_TIME.V);
      507     9278    2      IF JIT$=ADDR(REC1) THEN GOTO S_NONE;
      508     9279    2      CALL OPEN_FILE(F_STARS) ALTRET(S_ALT);
      509     9280    2      IN_KEY = SACCUM_KEY;
      510     9281    2      FPT_READ.BUF_ = VECTOR(SACCUM);
      511     9282    2      FPT_READ.V.KEYS# = %YES#;
      512     9283    2      CALL M$READ(FPT_READ) ALTRET(S_ALT);
      513     9284    3      DO WHILE('0'B);
      514     9285    3   S_ALT:  ;
      515     9286    3           IF B$JIT$->B$JIT.ERR.CODE~=%E$NOKEY AND
      516     9287    3             B$JIT$->B$JIT.ERR.CODE~=%E$NOFILE
      517     9288    3           THEN CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      518     9289    3   S_NONE: SACCUM = '0'B;                  /* Start with empty SACCUM tbl        */
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:17   
      519     9290    3           END;
      520     9291    2   END INITIALIZE;
      521     9292        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:18   
      522     9293    1   SEND_REC: PROC;
      523     9294        /*I* NAME:        SEND_REC
      524     9295             PURPOSE:     To write the JSP record to :ACCTLG and *S
      525     9296             CALL:        CALL SEND_REC
      526     9297             DESCRIPTION: SEND_REC writes the JSP record to :ACCTLG and then
      527     9298                          checks to see if it should also be written to *S
      528     9299                          which it does if this is not RECOVERY and
      529     9300                          B$JIT.CPFLAGS1 & %CP_STARSACC# is set.
      530     9301        */
      531     9302    2   DCL REC$ORD CHAR(RECLEN) BASED(REC$);   /* The JSP record                     */
      532     9303        %STARSACC$KEY (NAME=STARS_KEY,STCLASS=AUTO);
      533     9340    2      CALL OPEN_FILE(F_ACCTLG) ALTRET(ALT1);
      534     9341    2      FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;
      535     9342    2      FPT_WRITE.BUF_ = VECTOR(REC$ORD);
      536     9343    2      CALL M$WRITE(FPT_WRITE) ALTRET(ALT1);
      537     9344    2      IF (B$JIT.CPFLAGS1 & %CP_STARSACC#) AND LOGOFF_PARAM.CODE~=%AZ$RECOVERY
      538     9345    3      THEN DO;                             /* Write JSP record to *S also        */
      539     9346    3           CALL OPEN_FILE(F_STARS) ALTRET(ALT1);
      540     9347    3           FPT_WRITE.KEY_ = VECTOR(STARS_KEY);
      541     9348    3           STARS_KEY.LEN = LENGTHC(STARS_KEY)-1;
      542     9349    3           STARS_KEY.ACCT = 'b';
      543     9350    3           IF JSP.TYPE=%AZ$JOBEND
      544     9351    4           THEN DO;
      545     9352    4                STARS_KEY.STEP = 0;
      546     9353    4                STARS_KEY.NUM = 0;
      547     9354    4                END;
      548     9355    4           ELSE DO;
      549     9356    4                STARS_KEY.STEP = JSP.STEP;
      550     9357    4                IF JSP.TYPE=%AZ$STEP
      551     9358    4                THEN STARS_KEY.NUM = 510;
      552     9359    4                ELSE STARS_KEY.NUM = PROCNUM;
      553     9360    4                END;
      554     9361    3           CALL M$WRITE(FPT_WRITE) ALTRET(ALT1);
      555     9362    3           END;
      556     9363    3      DO WHILE('0'B);
      557     9364    3   ALT1:   CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      558     9365    3           END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:19   
      559     9366    2      RETURN;
      560     9367    2   END SEND_REC;
      561     9368        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:20   
      562     9369    1   OPEN_FILE: PROC(FILNUM) ALTRET;
      563     9370        /*I* NAME: OPEN_FILE
      564     9371             PURPOSE: To open the specified file on DCB LOGOFF_PARAM.DCB1. If the
      565     9372             DCB is already opened, it is checked for filename and closed and reopened
      566     9373             only if its the wrong file.
      567     9374        */
      568     9375    2   DCL FILNUM SBIN;
      569     9376    2   DCL 1 OPN_TBL(0:4) CONSTANT,
      570     9377    2         2 NAME,
      571     9378    2           3 L UBIN BYTE UNAL INIT(2,7,6,6,9),
      572     9379    2           3 C CHAR(31) INIT('*S',':ACCTLG',':RATES',':USERS',':JOBSTATS'),
      573     9380    2         2 ACCT CHAR(8) INIT(' ',':SYS',':SYS',':SYS',':SYS'),
      574     9381    2         2 FUN UBIN BYTE UNAL INIT(%CREATE#,%CREATE#,%IN#,%UPDATE#,%UPDATE#),
      575     9382    2         2 ORG UBIN BYTE UNAL INIT(%KEYED#,%CONSEC#,%KEYED#,%KEYED#,%KEYED#),
      576     9383    2         2 SHR UBIN BYTE UNAL INIT(%NONE#,%ALL#,%ALL#,%ALL#,%ALL#),
      577     9384    2         2 ACS UBIN BYTE UNAL INIT(%DIRECT#,%JRNL#,%DIRECT#,%DIRECT#,%DIRECT#);
      578     9385        %XSJ_PARAM(FPTN = XSJ_PARAMC,STCLASS = CONSTANT,
      579     9386                MODE = %UPDATE#);
      580     9403        %XSJ_PARAM(FPTN = XSJ_PARAM,STCLASS = AUTO);
      581     9420    2      IF DCB1$->F$DCB.FCD#
      582     9421    2      THEN IF ADDR(DCB1$->F$DCB.NAME#)->TEXT$C =
      583     9422    2             ADDR(OPN_TBL.NAME(FILNUM))->TEXT$C
      584     9423    2           THEN RETURN;                    /* Desired file is already open       */
      585     9424    2           ELSE CALL M$CLOSE(FPT_CLOSE) ALTRET(CLS_ALT);
      586     9425                                                /* Close the wrong file               */
      587     9426    3      DO WHILE('0'B);
      588     9427    3   CLS_ALT: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      589     9428    3           END;
      590     9429        /***********************************
      591     9430         ****       OPEN THE DESIRED FILE
      592     9431         ***********************************/
      593     9432    2      IF FILNUM=F_JOBSTATS
      594     9433    3      THEN DO;
      595     9434    3           XSJ_PARAM = XSJ_PARAMC;
      596     9435    3           XSJ_PARAM.DCB# = LOGOFF_PARAM.DCB1;
      597     9436    3           CALL XSJ$OPEN(XSJ_PARAM) ALTRET(OOPS);
      598     9437    3           END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:21   
      599     9438    3      ELSE DO;
      600     9439    3           FPT_OPEN = FPT_OPENC;
      601     9440    3           FPT_OPEN.V_ = VECTOR(FPT_OPEN.V);
      602     9441    3           FPT_OPEN.V.DCB# = LOGOFF_PARAM.DCB1;
      603     9442    3           FPT_OPEN.NAME_ = VECTOR(OPN_TBL.NAME(FILNUM));
      604     9443    3           IF OPN_TBL.ACCT(FILNUM)=' '
      605     9444    3           THEN FPT_OPEN.ACCT_ = VECTOR(B$JIT.FACCN);
      606     9445    3           ELSE FPT_OPEN.ACCT_ = VECTOR(OPN_TBL.ACCT(FILNUM));
      607     9446    3           FPT_OPEN.V.FUN# = OPN_TBL.FUN(FILNUM);
      608     9447    3           FPT_OPEN.V.ORG# = OPN_TBL.ORG(FILNUM);
      609     9448    3           FPT_OPEN.V.SHARE# = OPN_TBL.SHR(FILNUM);
      610     9449    3           FPT_OPEN.V.ACS# = OPN_TBL.ACS(FILNUM);
      611     9450    3           CALL M$OPEN(FPT_OPEN) ALTRET(OOPS);
      612     9451    3           END;
      613     9452    2      RETURN;
      614     9453    2   OOPS: ALTRETURN;
      615     9454    2   END OPEN_FILE;
      616     9455        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:22   
      617     9456    1   CHARGE_PRINT: PROC;
      618     9457        /*I* NAME: CHARGE_PRINT
      619     9458             PURPOSE: To charge the user and/or output statistics about this JSP record
      620     9459        */
      621     9460    2   DCL STATSLEV SBIN;                      /* Level of statistics reporting      */
      622     9461                                                /* to perform. Choices are:           */
      623     9462                                                /* AZ_ALL#, AZ_SUMMARY#, or           */
      624     9463                                                /* AZ_NONE#                           */
      625     9464    2   DCL F0 BIT(72) ALIGNED CONSTANT INIT('300000000000000000000000'O);
      626     9465                                                /* floating point decimal 0           */
      627     9466    2   DCL F1 BIT(72) ALIGNED CONSTANT INIT('300000000000000000001000'O);
      628     9467                                                /* floating point decimal 1           */
      629     9468    2   DCL FRM_TEMPLATE CHAR(0) CONSTANT INIT
      630     9469    2           ('                 @               @       /form +   @       /mnt');
      631     9470    2   DCL FRM_TEMPLATE_BLIND CHAR(0) CONSTANT INIT
      632     9471    2           ('                 @               forms         +   mounts');
      633     9472    2   DCL DASH_LINE CHAR(72) CONSTANT INIT(
      634     9473    2     '------------------------------------------------------------------------');
      635     9474    2   DCL SUM_TEMPLATE CHAR(0) CONSTANT INIT(
      636     9475    2           'CON=          EX=             SRV=             PMME=        CHG=');
      637     9476    2   DCL BL_16 CHAR(16) CONSTANT INIT(' ');
      638     9477    2   DCL T SBIN;                             /* Temporary value                    */
      639     9478    2   DCL I SBIN;                             /* counter                            */
      640     9479    2   DCL PSTEP BIT(1) ALIGNED;               /* If set, this is a processor step   */
      641     9480    2   DCL FORM_START BIT(1) ALIGNED;
      642     9481    2   DCL CHR6 CHAR(6);
      643     9482    2   DCL CHR7 CHAR(7);
      644     9483    2   DCL CHR8 CHAR(8);
      645     9484    2   DCL CHR9 CHAR(9);
      646     9485    2   DCL CHR10 CHAR(10);
      647     9486    2   DCL CHR11 CHAR(11);
      648     9487    2   DCL CHG1 SBIN;
      649     9488    2   DCL CHG2 SBIN;
      650     9489    2   DCL T1 SBIN;
      651     9490    2   DCL MNTS SBIN;
      652     9491    2   DCL MOPS_5_2_STR(0:5) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS5,%ENF00,
      653     9492    2                                              %INSB7,%MVC2);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:23   
      654     9493    2   DCL MOPS_4_2_STR(0:5) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS4,%ENF00,
      655     9494    2                                              %INSB7,%MVC2);
      656     9495    2   DCL MOPS_5_0_STR(0:4) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS4,%ENF00,%MVC1);
      657     9496    2   DCL MOPS_6_0_STR(0:4) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS5,%ENF00,%MVC1);
      658     9497    2   DCL MOP_2_4_STR(0:3) BIT(9) CONSTANT INIT(%MVZB2,%SES10,%INSB7,%MVC4);
      659     9498    2   DCL MOP_3_4_STR(0:3) BIT(9) CONSTANT INIT(%MVZB3,%SES10,%INSB7,%MVC4);
      660     9499    2   DCL MOP_4_2_STR(0:3) BIT(9) CONSTANT INIT(%MVZB4,%SES10,%INSB7,%MVC2);
      661     9500    2   DCL MOP_5_2_STR(0:3) BIT(9) CONSTANT INIT(%MVZB5,%SES10,%INSB7,%MVC2);
      662     9501    2   DCL MOP_7_2_STR(0:3) BIT(9) CONSTANT INIT(%MVZB7,%SES10,%INSB7,%MVC2);
      663     9502    2   DCL MOP_2_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB1,%MVC1);
      664     9503    2   DCL MOP_3_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB2,%MVC1);
      665     9504    2   DCL MOP_4_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB3,%MVC1);
      666     9505    2   DCL MOP_6_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB5,%MVC1);
      667     9506    2   DCL MOP_6_4_STR (0:3) BIT(9) CALIGNED CONSTANT INIT (%MVZB6,%SES10,%INSB7,%MVC4);
      668     9507    2   DCL MOP_7_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB6,%MVC1);
      669     9508    2   DCL MOP_8_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB7,%MVC1);
      670     9509    2   DCL ZERO CHAR(10) CONSTANT INIT('0000000000');
      671     9510        %B$RATE_TBL(FPTN = RT,STCLASS = AUTO);
      672     9625        %B$RATE_TBL(FPTN = RT_DFLT,STCLASS = CONSTANT);
      673     9740        %B$RATE_TBL(FPTN = PRT,STCLASS = AUTO);
      674     9855        %B$PROC_TBL(FPTN = PRC_SCH_TBL,STCLASS = AUTO);
      675     9882        %B$PROC_TBL(FPTN = PRC_SCH_DFLT,STCLASS = CONSTANT);
      676     9909        %B$FORM_TBL(FPTN = FORM_TBL,STCLASS = AUTO);
      677     9930        %B$FORM_TBL(FPTN = FORM_DFLT,STCLASS = CONSTANT);
      678     9951        %FORM(NAME = FRM,STCLASS="BASED(FRM$)");
      679     9997    2   DCL NO_DFLT UBIN;
      680     9998    2   DCL RATES_OPN BIT(1) ALIGNED;
      681     9999    2   DCL FRM$ PTR;
      682    10000        %FPT_OPEN(FPTN = FPT_OPEN_LLC,STCLASS = CONSTANT,
      683    10001                SCRUB = YES,
      684    10002                REASSIGN = YES,
      685    10003                SETDCB = YES);
      686    10112        %FPT_OPEN(FPTN = FPT_OPEN_LL,STCLASS = AUTO);
      687    10221    2   DCL OUT_BUF CHAR(72);                   /* output buffer                      */
      688    10222        /***********************************
      689    10223         ****       OB - OUT_BUF redefed for CHG recs
      690    10224         ***********************************/
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:24   
      691    10225    2   DCL 1 OB REDEF OUT_BUF,
      692    10226    2         2 SCLR,
      693    10227    2           3 NAME CHAR(25),
      694    10228    2           3 JSUNIT REDEF NAME,
      695    10229    2             4 * CHAR(7),
      696    10230    2             4 Q1 CHAR(1),
      697    10231    2             4 JSNAME CHAR(16),
      698    10232    2             4 Q2 CHAR(1),
      699    10233    2           3 SCLR CHAR(8),
      700    10234    2         2 DEC2 REDEF SCLR,
      701    10235    2           3 * CHAR(23),
      702    10236    2           3 DEC2 CHAR(10),
      703    10237    2         2 TIM REDEF SCLR,
      704    10238    2           3 * CHAR(22),
      705    10239    2           3 TIM CHAR(11),
      706    10240    2         2 TIM1 REDEF SCLR,
      707    10241    2           3 * CHAR(21),
      708    10242    2           3 HRS CHAR(3),
      709    10243    2           3 * CHAR(9),
      710    10244    2         2 BL_AT CHAR(2),
      711    10245    2         2 PER_UNIT CHAR(8),
      712    10246    2         2 UNITS CHAR(10),
      713    10247    2         2 O_PAREN CHAR(1),
      714    10248    2         2 PCHG CHAR(8),
      715    10249    2         2 C_PAREN CHAR(1),
      716    10250    2         2 CHG CHAR(9);
      717    10251        /***********************************
      718    10252         ****       OBF - OUT_BUF redefed for FORM recs
      719    10253         ***********************************/
      720    10254    2   DCL 1 OBF REDEF OUT_BUF,
      721    10255    2         2 * CHAR(2),
      722    10256    2         2 NAME CHAR(12),
      723    10257    2         2 * CHAR(1),
      724    10258    2         2 DD CHAR(2),
      725    10259    2         2 * CHAR(1),
      726    10260    2         2 WSN CHAR(8),
      727    10261    2         2 FRMS CHAR(6),
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:25   
      728    10262    2         2 * CHAR(2),
      729    10263    2         2 PER_FORM CHAR(7),
      730    10264    2         2 * CHAR(7),
      731    10265    2         2 MNTS CHAR(2),
      732    10266    2         2 * CHAR(2),
      733    10267    2         2 PER_MNT CHAR(7),
      734    10268    2         2 * CHAR(4),
      735    10269    2         2 CHG CHAR(9);
      736    10270        /***********************************
      737    10271         ****       OBT - OUT_BUF redefed for TOTAL rec
      738    10272         ***********************************/
      739    10273    2   DCL 1 OBT REDEF OUT_BUF,
      740    10274    2         2 * CHAR(14),
      741    10275    2         2 TCHG CHAR(9),
      742    10276    2         2 * CHAR(49);
      743    10277        /***********************************
      744    10278         ****       OBS - OUT_BUF redefed for SUMMARY rec
      745    10279         ***********************************/
      746    10280    2   DCL 1 OBS REDEF OUT_BUF,
      747    10281    2         2 * CHAR(4),
      748    10282    2         2 CON,
      749    10283    2           3 * CHAR(1),
      750    10284    2           3 TIM CHAR(8),
      751    10285    2         2 CON1 REDEF CON,
      752    10286    2           3 HRS CHAR(3),
      753    10287    2           3 * CHAR(6),
      754    10288    2         2 * CHAR(4),
      755    10289    2         2 EXEC,
      756    10290    2           3 * CHAR(1),
      757    10291    2           3 TIME CHAR(11),
      758    10292    2         2 EXEC1 REDEF EXEC,
      759    10293    2           3 HRS CHAR(3),
      760    10294    2           3 * CHAR(9),
      761    10295    2         2 * CHAR(5),
      762    10296    2         2 SERV,
      763    10297    2           3 * CHAR(1),
      764    10298    2           3 TIME CHAR(11),
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:26   
      765    10299    2         2 SERV1 REDEF SERV,
      766    10300    2           3 HRS CHAR(3),
      767    10301    2           3 * CHAR(9),
      768    10302    2         2 * CHAR(6),
      769    10303    2         2 PMMES CHAR(7),
      770    10304    2         2 * CHAR(5),
      771    10305    2         2 CHG CHAR(8);
      772    10306        /***********************************
      773    10307         ****       OBH - OUT_BUF redefed for HEADER rec
      774    10308         ***********************************/
      775    10309    2   DCL 1 OBH REDEF OUT_BUF,
      776    10310    2         2 TIME CHAR(8),
      777    10311    2         2 * CHAR(1),
      778    10312    2         2 DATE CHAR(10),
      779    10313    2         2 * CHAR(1),
      780    10314    2         2 ACCT_NAME CHAR(21),
      781    10315    2         2 * CHAR(1),
      782    10316    2         2 AT CHAR(1),
      783    10317    2         2 WSN CHAR(8),
      784    10318    2         2 * CHAR(12),
      785    10319    2         2 SYSID_TXT CHAR(3),
      786    10320    2         2 SYSID CHAR(6);
      787    10321        /***********************************
      788    10322         ****       OBNC - OUT_BUF redefed for NO CHARGE recs
      789    10323         ***********************************/
      790    10324    2   DCL 1 OBNC REDEF OUT_BUF,
      791    10325    2         2 PRT1 CHAR(33),
      792    10326    2         2 TIM REDEF PRT1,
      793    10327    2           3 * CHAR(14),
      794    10328    2           3 TIM CHAR(8),
      795    10329    2           3 * CHAR(1),
      796    10330    2           3 DATE CHAR(10),
      797    10331    2         2 TIM1 REDEF PRT1,
      798    10332    2           3 * CHAR(19),
      799    10333    2           3 * CHAR(3),
      800    10334    2           3 TIM CHAR(11),
      801    10335    2         2 TIM2 REDEF PRT1,
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:27   
      802    10336    2           3 * CHAR(21),
      803    10337    2           3 HRS CHAR(3),
      804    10338    2           3 * CHAR(9),
      805    10339    2         2 NUM1 REDEF PRT1,
      806    10340    2           3 * CHAR(26),
      807    10341    2           3 NUM CHAR(7),
      808    10342    2         2 * CHAR(6),
      809    10343    2         2 PRT2 CHAR(33),
      810    10344    2         2 NUM2 REDEF PRT2,
      811    10345    2           3 * CHAR(26),
      812    10346    2           3 NUM CHAR(7),
      813    10347    2         2 OCT REDEF PRT2,
      814    10348    2           3 * CHAR(29),
      815    10349    2           3 NUM(0:2) CHAR(1),
      816    10350    2           3 * CHAR(1);
      817    10351        /***********************************
      818    10352         ****       OBP - OUT_BUF redefed for PSEUDO recs
      819    10353         ***********************************/
      820    10354    2   DCL 1 OBP REDEF OUT_BUF,
      821    10355    2         2 * CHAR(7),
      822    10356    2         2 SUDO(0:4),
      823    10357    2           3 * CHAR(2),
      824    10358    2           3 NAME CHAR(8),
      825    10359    2           3 EQ CHAR(1),
      826    10360    2           3 NUM CHAR(2);
      827    10361        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:28   
      828    10362        /***********************************
      829    10363         ****       open :RATES
      830    10364         ***********************************/
      831    10365    2      CALL OPEN_FILE(F_RATES) ALTRET(NO_RATES);
      832    10366    2      RATES_OPN = %YES#;
      833    10367    3      DO WHILE('0'B);
      834    10368    3   NO_RATES: RATES_OPN = %NO#;             /* OK to run without :RATES file      */
      835    10369    3           IF B$JIT$->B$JIT.ERR.CODE~=%E$NOFILE
      836    10370    3           THEN CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
      837    10371    3           END;
      838    10372        /***********************************
      839    10373         ****       get RT
      840    10374         ***********************************/
      841    10375    2      IF RATES_OPN
      842    10376    3      THEN DO;
      843    10377    3           FPT_READ.V.KEYS# = %YES#;
      844    10378    3           FPT_READ.V.KEYR# = %NO#;
      845    10379    3           IN_KEY.LEN = 10;
      846    10380    3           CALL CONCAT(IN_KEY.KEY,'SCHE',B$JIT.BILL);
      847    10381    3           NO_DFLT = 1;
      848    10382    3           FPT_READ.BUF_ = VECTOR(PRC_SCH_TBL);
      849    10383    3           CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);
      850    10384    4           DO WHILE('0'B);
      851    10385    4   NO_SCHE:     PRC_SCH_TBL = PRC_SCH_DFLT;
      852    10386    4                CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NOSCHED);
      853    10387        /*E* ERROR: AZA-E$AZ_NOSCHED
      854    10388           MESSAGE: No default SCHEDULE record in :RATES.:SYS
      855    10389        */
      856    10390    4                END;
      857    10391    3           CALL CONCAT(IN_KEY.KEY,'RATE',PRC_SCH_TBL.RTABLE#);
      858    10392    3           NO_DFLT = 2;
      859    10393    3           FPT_READ.BUF_ = VECTOR(RT);
      860    10394    3           CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);
      861    10395    3           JSP.RATETBLE = IN_KEY;
      862    10396    3           END;
      863    10397    3      ELSE DO;
      864    10398    4           DO WHILE('0'B);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:29   
      865    10399    4   NO_RATE:     CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NORATE);
      866    10400        /*E* ERROR: AZA-E$AZ_NORATE
      867    10401           MESSAGE: No default RATE record in :RATES.:SYS
      868    10402        */
      869    10403    4                END;
      870    10404    3           RT = RT_DFLT;
      871    10405    3           END;
      872    10406        /***********************************
      873    10407         ****       get PRT if needed
      874    10408         ***********************************/
      875    10409    2      IF JSP.TYPE=%AZ$PROC
      876    10410    3      THEN DO;
      877    10411    3           PSTEP = %YES#;
      878    10412    3           IF RATES_OPN
      879    10413    4           THEN DO;
      880    10414    4                FPT_READ.BUF_ = VECTOR(PRC_SCH_TBL);
      881    10415    4                FPT_READ.V.KEYS# = %YES#;
      882    10416    4                FPT_READ.V.KEYR# = %NO#;
      883    10417    4                CALL CONCAT(IN_KEY.KEY,'PROC',JSP.PROCNAME.C);
      884    10418    4                IN_KEY.LEN = 4+JSP.PROCNAME.L;
      885    10419    4                NO_DFLT = 3;
      886    10420    4                CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);
      887    10421    5                DO WHILE('0'B);
      888    10422    5   NO_PROC:          CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NOPROC);
      889    10423        /*E* ERROR: AZA-E$AZ_NOPROC
      890    10424           MESSAGE: No default PROCESSOR record in :RATES.:SYS
      891    10425        */
      892    10426    5                     PRC_SCH_TBL = PRC_SCH_DFLT;
      893    10427    5                     END;
      894    10428    4                IN_KEY.LEN = 10;
      895    10429    4                CALL CONCAT(IN_KEY.KEY,'RATE',PRC_SCH_TBL.RTABLE#);
      896    10430    4                FPT_READ.BUF_ = VECTOR(PRT);
      897    10431    4                NO_DFLT = 4;
      898    10432    4                CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);
      899    10433    4                JSP.PRATETBLE = IN_KEY;
      900    10434    4                END;
      901    10435    4           ELSE DO;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:30   
      902    10436    5                DO WHILE('0'B);
      903    10437    5   NO_RATE1:         CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NORATE);
      904    10438    5                     END;
      905    10439    4                PRT = RT_DFLT;
      906    10440    4                END;
      907    10441    3           END;
      908    10442    2      ELSE
      909    10443    2           PSTEP = %NO#;
      910    10444        /***********************************
      911    10445         ****       set up STATSLEV
      912    10446         ***********************************/
      913    10447    3      DO CASE(JSP.TYPE);
      914    10448    3       CASE(%AZ$STEP);
      915    10449    3         STATSLEV = B$JIT.SSLEV;
      916    10450    3       CASE(%AZ$PROC);
      917    10451    3         STATSLEV = B$JIT.PSLEV;
      918    10452    3       CASE(%AZ$STATUS,%AZ$JOBEND);
      919    10453    3         STATSLEV = B$JIT.JSLEV;
      920    10454    3       CASE(ELSE);
      921    10455    3         STATSLEV = %AZ_NONE#;
      922    10456    3         END;
      923    10457        /***********************************
      924    10458         ****       set up FPT_WRITE
      925    10459         ***********************************/
      926    10460    2      IF STATSLEV ~= %AZ_NONE#
      927    10461    3      THEN DO;
      928    10462    3           FPT_WRITE.KEY_ = VECTOR(NIL);
      929    10463    3           FPT_WRITE.BUF_ = VECTOR(OUT_BUF);
      930    10464    3           FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB_LL;
      931    10465        /***********************************
      932    10466         ****       OPEN SETDCB the M$LL DCB if not already open
      933    10467         ***********************************/
      934    10468    3           IF NOT DCBADDR(LOGOFF_PARAM.DCB_LL)->F$DCB.FCD#
      935    10469    4           THEN DO;
      936    10470    4                FPT_OPEN_LL = FPT_OPEN_LLC;
      937    10471    4                FPT_OPEN_LL.V_ = VECTOR(FPT_OPEN_LL.V);
      938    10472    4                FPT_OPEN_LL.V.DCB# = LOGOFF_PARAM.DCB_LL;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:31   
      939    10473    4                CALL M$OPEN(FPT_OPEN_LL) ALTRET(OPNLL_ALT);
      940    10474    5                DO WHILE('0'B);
      941    10475    5   OPNLL_ALT:        CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);
      942    10476    5                     END;
      943    10477    4                END;
      944    10478    3           END;
      945    10479        /***********************************
      946    10480         ****       put out non-chargable info if needed
      947    10481         ***********************************/
      948    10482    2      IF STATSLEV=%AZ_ALL#
      949    10483    2      THEN CALL NO_CHG;
      950    10484        /***********************************
      951    10485         ****       put out chargable info
      952    10486         ***********************************/
      953    10487    2      FPT_TIME.TIME_ = VECTOR(OB.TIM.TIM); /* Set up for this section            */
      954    10488    2      CALL CHG(32,JSP.PEXEC+JSP.UEXEC+JSP.PSTIME+JSP.USTIME,F0,F0,BL_16);
      955    10489    2      CALL CHG(5,JSP.PEXEC,RT.PEXEC#,PRT.PEXEC#,BL_16);
      956    10490    2      CALL CHG(6,JSP.UEXEC,RT.UEXEC#,PRT.UEXEC#,BL_16);
      957    10491    2      CALL CHG(7,JSP.PSTIME,RT.PSTIME#,PRT.PSTIME#,BL_16);
      958    10492    2      CALL CHG(8,JSP.USTIME,RT.USTIME#,PRT.USTIME#,BL_16);
      959    10493    2      CALL CHG(4,JSP.CONNECT,RT.CONNECT#,PRT.CONNECT#,BL_16);
      960    10494    2      CALL CHG(3,JSP.TINTER,RT.TINTER#,PRT.TINTER#,BL_16);
      961    10495    2      IF JSP.TYPE~=%AZ$PROC
      962    10496    3      THEN DO;                             /* Don't charge for steps if %AZ$PROC */
      963    10497    3           IF JSP.TYPE=%AZ$STEP
      964    10498    3           THEN T = 1;
      965    10499    3           ELSE T = JSP.STEP;
      966    10500    3           CALL CHG(0,T,RT.JSTEPS#,PRT.JSTEPS#,BL_16);
      967    10501    3           END;
      968    10502    2      CALL CHG(1,JSP.PMMES,RT.PMMES#,PRT.PMMES#,BL_16);
      969    10503    2      CALL CHG(9,JSP.PMEMTIM,RT.PMEM#,PRT.PMEM#,BL_16);
      970    10504    2      CALL CHG(10,JSP.UMEMTIM,RT.UMEM#,PRT.UMEM#,BL_16);
      971    10505    2      IF JSP.CODE=%AZ$JSP
      972    10506    2      THEN CALL CHG(11,JSP.UFTPS,RT.TPACK#,PRT.TPACK#,BL_16);
      973    10507    2      ELSE CALL CHG(2,JSP.UFTPS,RT.FEPINT#,PRT.FEPINT#,BL_16);
      974    10508    2      CALL CHG(12,JSP.MTTIM_CPU,RT.TCPU#,PRT.TCPU#,BL_16);
      975    10509    2      CALL CHG(13,JSP.MTTIM_CLK,RT.TCLOCK#,PRT.TCLOCK#,BL_16);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:32   
      976    10510    2      CALL CHG(14,JSP.DPTIM_CPU,RT.FCPU#,PRT.FCPU#,BL_16);
      977    10511    2      CALL CHG(15,JSP.DPTIM_CLK,RT.FCLOCK#,PRT.FCLOCK#,BL_16);
      978    10512    2      CALL CHG(16,JSP.ORTIM_CPU,RT.OCPU#,PRT.OCPU#,BL_16);
      979    10513    2      CALL CHG(17,JSP.ORTIM_CLK,RT.OCLOCK#,PRT.OCLOCK#,BL_16);
      980    10514    2      CALL CHG(18,JSP.MTACCESS,RT.TACCESS#,PRT.TACCESS#,BL_16);
      981    10515    2      CALL CHG(19,JSP.DPACCESS,RT.FACCESS#,PRT.FACCESS#,BL_16);
      982    10516    2      CALL CHG(20,JSP.ORACCESS,RT.OACCESS#,PRT.OACCESS#,BL_16);
      983    10517    2      CALL CHG(21,JSP.MTMOUNT,RT.TMOUNT#,PRT.TMOUNT#,BL_16);
      984    10518    2      CALL CHG(22,JSP.DPMOUNT,RT.FMOUNT#,PRT.FMOUNT#,BL_16);
      985    10519    2      CALL CHG(23,JSP.ORMOUNT,RT.OMOUNT#,PRT.OMOUNT#,BL_16);
      986    10520    2      IF JSP.TYPE=%AZ$PROC
      987    10521    3      THEN DO I=0 TO 3;
      988    10522    3           T = JSP.JSUNITS(I);
      989    10523    3           CALL CHG(24+I,T,F0,PRT.SUNIT.RATE#(I),PRT.SUNIT.NAME#(I));
      990    10524    3           END;
      991    10525    2      ELSE IF JSP.TYPE=%AZ$STEP
      992    10526    3           THEN DO I=0 TO 3;
      993    10527    3                T = JSP.JSUNITS(I);
      994    10528    3                CALL CHG(24+I,T,RT.SUNIT.RATE#(I),F0,RT.SUNIT.NAME#(I));
      995    10529    3                END;
      996    10530    3           ELSE DO;
      997    10531    4                DO I=0 TO 3;
      998    10532    4                     CALL CHG(24+I,0,F0,F0,BL_16);
      999    10533    4                     END;
     1000    10534    4                DO I=0 TO 3;
     1001    10535    4                     T = JSP.JSUNITS(I);
     1002    10536    4                     CALL CHG(28+I,T,RT.JUNIT.RATE#(I),F0,RT.JUNIT.NAME#(I));
     1003    10537    4                     END;
     1004    10538    3                END;
     1005    10539        /***********************************
     1006    10540         ****       charge for FORM usage
     1007    10541         ***********************************/
     1008    10542    2      IN_KEY = '020'O;                     /* To cause the test for correct      */
     1009    10543                                                /* FORMNAME to fail first time        */
     1010    10544                                                /* and set IN_KEY.LEN to 16           */
     1011    10545    2      FORM_START = %YES#;
     1012    10546    2      FRM$ = PINCRW(REC$,JSP.FORMX);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:33   
     1013    10547    2      FPT_READ.BUF_ = VECTOR(FORM_TBL);
     1014    10548    2      FPT_READ.V.KEYS# = %YES#;
     1015    10549    2      FPT_READ.V.KEYR# = %NO#;
     1016    10550    2      NO_DFLT = 5;
     1017    10551    3      DO I=0 TO JSP.FORM_CNT-1;
     1018    10552    3           IF RATES_OPN
     1019    10553    4           THEN DO;
     1020    10554    4                CALL CONCAT(IN_KEY.KEY,'FORM',FRM.S1.FORMNAME(I));
     1021    10555    4                CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);
     1022    10556    4                FRM.RATETBLE(I) = IN_KEY;
     1023    10557    4                END;
     1024    10558    4           ELSE DO;
     1025    10559    5                DO WHILE('0'B);
     1026    10560    5   NO_FORM:          CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NOFORM);
     1027    10561        /*E* ERROR: AZA-E$AZ_NOFORM
     1028    10562           MESSAGE: No default FORM record in :RATES.:SYS
     1029    10563        */
     1030    10564    5                     END;
     1031    10565    4                FORM_TBL = FORM_DFLT;
     1032    10566    4                END;
     1033    10567    3           MNTS = FRM.MOUNTS(I);
     1034    10568    3           CALL AZB$MTH3D2B(CHG1,F1,RT.CMULT#,FORM_TBL.FMOUNT#,MNTS,1,'0'B);
     1035    10569    3           CALL AZB$MTH3D2B(CHG2,F1,RT.CMULT#,FORM_TBL.FORM#,FRM.FORMS(I),1,'0'B);
     1036    10570    3           JSP.CHG = JSP.CHG + CHG1 + CHG2;
     1037    10571    3           IF STATSLEV=%AZ_ALL#
     1038    10572    4           THEN DO;
     1039    10573    4                IF FORM_START
     1040    10574    5                THEN DO;
     1041    10575    5                     FORM_START = %NO#;
     1042    10576    5                     OUT_BUF = 'FORMS USED';
     1043    10577    5                     IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1044    10578    5                     THEN                  /* Don't print if BREAK hit           */
     1045    10579    5                          CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1046    10580    5                     END;
     1047    10581    4                IF B$JIT.BLINDACCTNG
     1048    10582    4                THEN OUT_BUF = FRM_TEMPLATE_BLIND;
     1049    10583    4                ELSE OUT_BUF = FRM_TEMPLATE;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:34   
     1050    10584    4                OBF.NAME = FRM.S1.FORMNAME(I);
     1051    10585    4                OBF.DD = FRM.S1.DD(I);
     1052    10586    4                OBF.WSN = FRM.S1.WSN(I);
     1053    10587    4                CALL BINXCHAR(OBF.FRMS,FRM.FORMS(I));
     1054    10588    4                CALL EDITXCHAR(OBF.FRMS,,,MOPS_5_0_STR,OBF.FRMS);
     1055    10589    4                CALL BINCHAR(OBF.MNTS,MNTS);
     1056    10590    4                CALL EDITCHAR(OBF.MNTS,,,MOP_2_0_STR,OBF.MNTS);
     1057    10591    4                IF NOT B$JIT.BLINDACCTNG
     1058    10592    5                THEN DO;                   /* Tell the user about charge details */
     1059    10593    5                     CALL AZB$MTH3D2B(T1,F1,RT.CMULT#,FORM_TBL.FORM#,1,1,'0'B);
     1060    10594    5                     CALL BINCHAR(CHR6,T1);
     1061    10595    5                     CALL EDITCHAR(OBF.PER_FORM,,,MOP_2_4_STR,CHR6);
     1062    10596    5                     CALL AZB$MTH3D2B(T1,F1,RT.CMULT#,FORM_TBL.FMOUNT#,1,1,'0'B);
     1063    10597    5                     CALL BINCHAR(CHR6,T1);
     1064    10598    5                     CALL EDITCHAR(OBF.PER_MNT,,,MOP_2_4_STR,CHR6);
     1065    10599    5                     T1 = (CHG1+CHG2+50)/100;
     1066    10600    5                     IF T1~=0
     1067    10601    6                     THEN DO;
     1068    10602    6                          CALL BINXCHAR(CHR8,T1);
     1069    10603    6                          CALL EDITXCHAR(OBF.CHG,,,MOPS_5_2_STR,CHR8);
     1070    10604    6                          END;
     1071    10605    5                     END;
     1072    10606    4                IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1073    10607    4                THEN                       /* Don't print if BREAK hit           */
     1074    10608    4                     CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1075    10609    4                END;
     1076    10610    3           END;
     1077    10611        /***********************************
     1078    10612         ****       finish the AZ_ALL# page or put out the AZ_SUMMARY# line
     1079    10613         ****       or do nothing
     1080    10614         ***********************************/
     1081    10615    3      DO CASE(STATSLEV);
     1082    10616    3       CASE(%AZ_ALL#);
     1083    10617    3         OUT_BUF = DASH_LINE;
     1084    10618    3         IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1085    10619    3         THEN                              /* Don't print if BREAK hit           */
     1086    10620    3              CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:35   
     1087    10621    3         OUT_BUF = 'TOTAL CHARGE =';
     1088    10622    3         CALL BINXCHAR(CHR8,(JSP.PCHG+JSP.CHG+50)/100);
     1089    10623    3         CALL EDITXCHAR(OBT.TCHG,,,MOPS_5_2_STR,CHR8);
     1090    10624    3         IF NOT B$JIT.BLINDACCTNG
     1091    10625    4         THEN DO;
     1092    10626    4              IF JSP.PCHG~=0
     1093    10627    5              THEN DO;
     1094    10628    5                   OB.O_PAREN = '(';
     1095    10629    5                   OB.C_PAREN = ')';
     1096    10630    5                   CALL BINCHAR(CHR7,(JSP.PCHG+50)/100);
     1097    10631    5                   CALL EDITCHAR(OB.PCHG,,,MOP_5_2_STR,CHR7);
     1098    10632    5                   END;
     1099    10633    4              IF JSP.CHG~=0
     1100    10634    5              THEN DO;
     1101    10635    5                   CALL BINXCHAR(CHR8,(JSP.CHG+50)/100);
     1102    10636    5                   CALL EDITXCHAR(OB.CHG,,,MOPS_5_2_STR,CHR8);
     1103    10637    5                   END;
     1104    10638    4              END;
     1105    10639    3         IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1106    10640    3         THEN                              /* Don't print if BREAK hit           */
     1107    10641    3              CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1108    10642    3       CASE(%AZ_SUMMARY#);
     1109    10643    3         OUT_BUF = SUM_TEMPLATE;
     1110    10644    3         FPT_TIME.TSTAMP_ = VECTOR(JSP.CONNECT);
     1111    10645    3         FPT_TIME.TIME_ = VECTOR(OBS.CON.TIM);
     1112    10646    3         CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
     1113    10647    3         T = JSP.CONNECT/360000;
     1114    10648    3         CALL BINCHAR(OBS.CON1.HRS,T);
     1115    10649    3         FPT_TIME.TSTAMP_ = VECTOR(T1);
     1116    10650    3         T1 = JSP.PEXEC + JSP.UEXEC;
     1117    10651    3         FPT_TIME.TIME_ = VECTOR(OBS.EXEC.TIME);
     1118    10652    3         CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
     1119    10653    3         T = T1/360000;
     1120    10654    3         CALL BINCHAR(OBS.EXEC1.HRS,T);
     1121    10655    3         T1 = JSP.PSTIME + JSP.USTIME;
     1122    10656    3         FPT_TIME.TIME_ = VECTOR(OBS.SERV.TIME);
     1123    10657    3         CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:36   
     1124    10658    3         T = T1/360000;
     1125    10659    3         CALL BINCHAR(OBS.SERV1.HRS,T);
     1126    10660    3         CALL BINCHAR(OBS.PMMES,JSP.PMMES);
     1127    10661    3         CALL EDITCHAR(OBS.PMMES,,,MOP_7_0_STR,OBS.PMMES);
     1128    10662    3         CALL BINXCHAR(CHR7,(JSP.PCHG+JSP.CHG+50)/100);
     1129    10663    3         CALL EDITXCHAR(OBS.CHG,,,MOPS_4_2_STR,CHR7);
     1130    10664    3         IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1131    10665    3         THEN                              /* Don't print if BREAK hit           */
     1132    10666    3              CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1133    10667    3         END;                              /* END CASE                           */
     1134    10668    3      DO WHILE('0'B);
     1135    10669    3   WR_ALT: CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);
     1136    10670    3           END;
     1137    10671        /***********************************
     1138    10672         ****       Add PCHG and CHG into CHG
     1139    10673         ***********************************/
     1140    10674    2      JSP.CHG = JSP.CHG + JSP.PCHG;
     1141    10675    2      RETURN;
     1142    10676        /***********************************
     1143    10677         ****       general ALTRETURN handling
     1144    10678         ***********************************/
     1145    10679    2   DFLT_RTRY:
     1146    10680    2      IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY
     1147    10681    2      THEN IF SUBSTR(IN_KEY.KEY,4)~='0'
     1148    10682    3           THEN DO;
     1149    10683    3                CALL CONCAT(IN_KEY.KEY,SUBSTR(IN_KEY.KEY,0,4),'0');
     1150    10684    3                IF NO_DFLT=3
     1151    10685    3                THEN IN_KEY.LEN = 5;       /* PROC record is only var-len key    */
     1152    10686    3                CALL M$RETRY ALTRET(DFLT_RTRY);
     1153    10687                                                /* Retry the read with default key    */
     1154    10688    3                END;
     1155    10689    3           ELSE DO CASE(NO_DFLT);
     1156    10690    3            CASE(1);
     1157    10691    3              GOTO NO_SCHE;
     1158    10692    3            CASE(2);
     1159    10693    3              GOTO NO_RATE;
     1160    10694    3            CASE(3);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:37   
     1161    10695    3              GOTO NO_PROC;
     1162    10696    3            CASE(4);
     1163    10697    3              GOTO NO_RATE1;
     1164    10698    3            CASE(5);
     1165    10699    3              GOTO NO_FORM;
     1166    10700    3              END;
     1167    10701    2   ALTL:
     1168    10702    2      CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
     1169    10703    2      RETURN;
     1170    10704        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:38   
     1171    10705    2   NO_CHG: PROC;
     1172    10706        /*I* NAME: NO_CHG
     1173    10707             CALL: CALL NO_CHG;
     1174    10708             PURPOSE: To put out the un-chargable information on a AZ_ALL# call
     1175    10709        */
     1176    10710        %SUDO(NAME = SUDO,STCLASS="BASED(SUDO$)");
     1177    10741    3   DCL SUDO$ PTR;
     1178    10742    3   DCL TEMP$ PTR;
     1179    10743    3   DCL TEMP1$ PTR;
     1180    10744    3   DCL T SBIN;                             /* Temporary value                    */
     1181    10745    3   DCL I SBIN;
     1182    10746    3   DCL LIM$TEXT CHAR(5) BASED;
     1183    10747    3   DCL PROC_LIT CHAR(32) CONSTANT INIT('PROCESSOR');
     1184    10748    3   DCL PROC1_LIT CHAR(32) CONSTANT INIT('PROCESSOR(1st)');
     1185    10749    3   DCL JOBNAME_LIT CHAR(32) CONSTANT INIT('JOBNAME');
     1186    10750    3   DCL TOF_VFC CHAR(1) CONSTANT INIT('p'); /* TOF then space 0 after             */
     1187    10751    3   DCL 1 RNST_TBL(0:9) CONSTANT ALIGNED,   /* Run status table                   */
     1188    10752    3         2 LEN UBIN BYTE UNAL INIT
     1189    10753    3           (6,5,5,21,18,21,19,14,19,9),
     1190    10754    3         2 TEXT CHAR(23) UNAL INIT
     1191    10755    3           ('NORMAL','ERROR','ABORT','ABORTED BY PROC.(SSP)',
     1192    10756    3           'ABORTED BY MONITOR','ERROR KEY_IN OR !QUIT','MONITOR ABORT KEYIN',
     1193    10757    3           'LIMIT EXCEEDED','ABORTED BY OPERATOR','CANCELLED'),
     1194    10758    3         2 MASK BIT(9) UNAL INIT
     1195    10759    3           (%RS_EXIT#,%RS_ERR#,%RS_XXX#,%RS_SSP#,%RS_ABRT#,%RS_EKEY#,%RS_OFF#,
     1196    10760    3           %RS_LIMX#,%RS_XKEY#,%RS_CAN#);
     1197    10761    3   DCL 1 XLIM_TBL(0:8) CONSTANT ALIGNED,   /* limit exceeded table               */
     1198    10762    3         2 LEN UBIN BYTE UNAL INIT
     1199    10763    3            (4,5,4,5,5,2,2,6,2),
     1200    10764    3         2 HDR CHAR(6) UNAL INIT
     1201    10765    3            ('TIME','STACK','TAPE','TDISK','PDISK','DO','LO','MEMORY','PO'),
     1202    10766    3         2 MASK BIT(9) UNAL INIT
     1203    10767    3            (%XL_TIME#,%XL_STACK#,%XL_TAPE#,%XL_TDISC#,%XL_PDISC#,%XL_DO#,
     1204    10768    3             %XL_LO#,%XL_MEM#,%XL_PO#);
     1205    10769    3      SUDO$ = PINCRW(REC$,JSP.SUDOX);
     1206    10770        /***********************************
     1207    10771         ****       get to top of form
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:39   
     1208    10772         ***********************************/
     1209    10773    3      FPT_WRITE.BUF_ = VECTOR(TOF_VFC);
     1210    10774    3      FPT_WRITE.V.DVBYTE.VFC# = %YES#;
     1211    10775    3      CALL M$WRITE(FPT_WRITE) ALTRET(TOFALT);
     1212    10776    3   TOFALT: FPT_WRITE.V.DVBYTE.VFC# = %NO#;
     1213    10777    3      FPT_WRITE.BUF_ = VECTOR(OUT_BUF);
     1214    10778        /***********************************
     1215    10779         ****       put out the header record
     1216    10780         ***********************************/
     1217    10781    3      OUT_BUF = ' ';
     1218    10782    3      FPT_TIME.DATE_ = VECTOR(OBH.DATE);
     1219    10783    3      FPT_TIME.TSTAMP_ = VECTOR(JSP.CUR_UTS);
     1220    10784    3      FPT_TIME.TIME_ = VECTOR(OBH.TIME);
     1221    10785    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
     1222    10786    3      I = 8;
     1223    10787    4      DO WHILE(SUBSTR(JSP.ACCT,I-1,1)=' ');
     1224    10788    4           I = I-1;
     1225    10789    4           END;
     1226    10790    3      CALL CONCAT(OBH.ACCT_NAME,SUBSTR(JSP.ACCT,0,I),',',JSP.USERNAME);
     1227    10791    3      OBH.AT = '@';
     1228    10792    3      OBH.WSN = JSP.WOO;
     1229    10793    3      OBH.SYSID_TXT = 'ID=';
     1230    10794    3      CALL BINCHAR(OBH.SYSID,JSP.SYSID);
     1231    10795    3      CALL EDITCHAR(OBH.SYSID,,,MOP_6_0_STR,OBH.SYSID);
     1232    10796    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1233    10797    3      THEN                                 /* Don't print if BREAK hit           */
     1234    10798    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1235    10799        /***********************************
     1236    10800         ****       put out the JOBNAME record
     1237    10801         ***********************************/
     1238    10802    3      IF JSP.JOBNAME.L~=0
     1239    10803    4      THEN DO;
     1240    10804    4           CALL CONCAT(OUT_BUF,SUBSTR(JOBNAME_LIT,0,32-JSP.JOBNAME.L),' ',
     1241    10805    4             JSP.JOBNAME.C);
     1242    10806    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1243    10807    4           THEN                            /* Don't print if BREAK hit           */
     1244    10808    4                CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:40   
     1245    10809    4           END;
     1246    10810        /***********************************
     1247    10811         ****       put out the first record
     1248    10812         ***********************************/
     1249    10813    3      OUT_BUF = 'SUBMITTED';
     1250    10814    3      FPT_TIME.TSTAMP_ = VECTOR(JSP.SUBMIT);
     1251    10815    3      FPT_TIME.DATE_ = VECTOR(OBNC.TIM.DATE);
     1252    10816    3      FPT_TIME.TIME_ = VECTOR(OBNC.TIM.TIM);
     1253    10817    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
     1254    10818    3      IF JSP.MODE=%M_BATCH#
     1255    10819    4      THEN DO;
     1256    10820    4           OBNC.PRT2 = 'PRIORITY';
     1257    10821    4           CALL BINCHAR(OBNC.NUM2.NUM,JSP.PRIO);
     1258    10822    4           CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);
     1259    10823    4           END;
     1260    10824    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1261    10825    3      THEN                                 /* Don't print if BREAK hit           */
     1262    10826    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1263    10827        /***********************************
     1264    10828         ****       put out the second record
     1265    10829         ***********************************/
     1266    10830    3      IF JSP.MODE=%M_BATCH#
     1267    10831    4      THEN DO;
     1268    10832    4           IF JSP.HOLD_UTS=0
     1269    10833    4           THEN OUT_BUF = ' ';
     1270    10834    5           ELSE DO;
     1271    10835    5                OUT_BUF = 'HOLD';
     1272    10836    5                FPT_TIME.TSTAMP_ = VECTOR(JSP.HOLD_UTS);
     1273    10837    5                CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
     1274    10838    5                END;
     1275    10839    4           OBNC.PRT2 = 'PARTITION';
     1276    10840    4           CALL BINCHAR(OBNC.NUM2.NUM,JSP.PART#);
     1277    10841    4           CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);
     1278    10842    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1279    10843    4           THEN                            /* Don't print if BREAK hit           */
     1280    10844    4                CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1281    10845    4           END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:41   
     1282    10846        /***********************************
     1283    10847         ****       put out the third record
     1284    10848         ***********************************/
     1285    10849    3      OUT_BUF = 'STARTED';
     1286    10850    3      FPT_TIME.TSTAMP_ =  VECTOR(JSP.START);
     1287    10851    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
     1288    10852    3      OBNC.PRT2 = 'STEP';
     1289    10853    3      CALL BINCHAR(OBNC.NUM2.NUM,JSP.STEP);
     1290    10854    3      CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);
     1291    10855    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1292    10856    3      THEN                                 /* Don't print if BREAK hit           */
     1293    10857    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1294    10858        /***********************************
     1295    10859         ****       put out the fourth record
     1296    10860         ***********************************/
     1297    10861    3      OUT_BUF = 'ELAPSED';
     1298    10862    3      FPT_TIME.TIME_ = VECTOR(OBNC.TIM1.TIM);
     1299    10863    3      FPT_TIME.DATE_ = VECTOR(NIL);
     1300    10864    3      FPT_TIME.TSTAMP_ = VECTOR(JSP.ELAPSED);
     1301    10865    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
     1302    10866    3      T = JSP.ELAPSED/360000;
     1303    10867    3      CALL BINCHAR(OBNC.TIM2.HRS,T);
     1304    10868    3      CALL STRIP_TIME(ADDR(OBNC.TIM2.HRS),5);
     1305    10869    3      IF JSP.TYPE=%AZ$PROC
     1306    10870    3      THEN CALL CONCAT(OBNC.PRT2,SUBSTR(PROC_LIT,0,32-JSP.PROCNAME.L),
     1307    10871    3             ' ',JSP.PROCNAME.C);
     1308    10872    3      ELSE IF JSP.TYPE=%AZ$STEP
     1309    10873    3           THEN CALL CONCAT(OBNC.PRT2,SUBSTR(PROC1_LIT,0,32-JSP.PROCNAME.L),
     1310    10874    3                  ' ',JSP.PROCNAME.C);
     1311    10875    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1312    10876    3      THEN                                 /* Don't print if BREAK hit           */
     1313    10877    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1314    10878        /***********************************
     1315    10879         ****       put out the fifth record
     1316    10880         ***********************************/
     1317    10881    3      OUT_BUF = 'PERMANENT DISK USED';
     1318    10882    3      CALL BINXCHAR(OBNC.NUM1.NUM,JSP.PRDPUSED);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:42   
     1319    10883    3      CALL EDITXCHAR(OBNC.NUM1.NUM,,,MOPS_6_0_STR,OBNC.NUM1.NUM);
     1320    10884    3      OBNC.PRT2 = 'STEP CONDITION CODE';
     1321    10885    3      CALL BINCHAR(OBNC.NUM2.NUM,JSP.STEPCC);
     1322    10886    3      CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);
     1323    10887    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1324    10888    3      THEN                                 /* Don't print if BREAK hit           */
     1325    10889    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1326    10890        /***********************************
     1327    10891         ****       put out the sixth record
     1328    10892         ***********************************/
     1329    10893    3      IF JSP.TYPE=%AZ$PROC
     1330    10894    3      THEN OUT_BUF = ' ';
     1331    10895    4      ELSE DO;
     1332    10896    4           OUT_BUF = 'PEAK TEMPORARY DISK';
     1333    10897    4           CALL BINCHAR(OBNC.NUM1.NUM,JSP.TMDPPK);
     1334    10898    4           CALL EDITCHAR(OBNC.NUM1.NUM,,,MOP_7_0_STR,OBNC.NUM1.NUM);
     1335    10899    4           END;
     1336    10900    4      DO I = 0 TO SIZEC(RNST_TBL)/SIZEC(RNST_TBL(0))-1;
     1337    10901    4           IF (JSP.RNST & RNST_TBL.MASK(I)) = JSP.RNST
     1338    10902    5           THEN DO;
     1339    10903    5                CALL CONCAT(OBNC.PRT2,'END STATUS: ',SUBSTR(RNST_TBL.TEXT(I),
     1340    10904    5                  0,RNST_TBL.LEN(I)));
     1341    10905    5                I = SIZEC(RNST_TBL)/SIZEC(RNST_TBL(0))-1;
     1342    10906    5                END;
     1343    10907    4           END;
     1344    10908    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1345    10909    3      THEN                                 /* Don't print if BREAK hit           */
     1346    10910    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1347    10911        /***********************************
     1348    10912         ****       put out the seventh record
     1349    10913         ***********************************/
     1350    10914    3      IF JSP.TYPE=%AZ$PROC
     1351    10915    3      THEN OUT_BUF = ' ';
     1352    10916    4      ELSE DO;
     1353    10917    4           OUT_BUF = 'PEAK MEMORY';
     1354    10918    4           CALL BINCHAR(OBNC.NUM1.NUM,JSP.PKCO);
     1355    10919    4           CALL EDITCHAR(OBNC.NUM1.NUM,,,MOP_7_0_STR,OBNC.NUM1.NUM);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:43   
     1356    10920    4           END;
     1357    10921    3      IF JSP.RNST & %RS_LIMX#
     1358    10922    4      THEN DO;
     1359    10923    4           OBNC.PRT2 = 'LIMIT EXCEEDED: ';
     1360    10924    4           TEMP$ = PINCRC(ADDR(OBNC.PRT2),SIZEC('LIMIT EXCEEDED: '));
     1361    10925    4           TEMP1$ = TEMP$;
     1362    10926    5           DO I=0 TO SIZEC(XLIM_TBL)/SIZEC(XLIM_TBL(0))-1;
     1363    10927    5                IF JSP.XLIMFLG & XLIM_TBL.MASK(I)
     1364    10928    6                THEN DO;
     1365    10929    6                     IF TEMP$ ~= TEMP1$
     1366    10930    7                     THEN DO;              /* Insert a comma if not first one    */
     1367    10931    7                          CALL CONCAT(TEMP$->LIM$TEXT,',');
     1368    10932    7                          TEMP$ = PINCRC(TEMP$,1);
     1369    10933    7                          END;
     1370    10934    6                     CALL INSERT(TEMP$->LIM$TEXT,0,XLIM_TBL.LEN(I),
     1371    10935    6                       XLIM_TBL.HDR(I));
     1372    10936    6                     TEMP$ = PINCRC(TEMP$,XLIM_TBL.LEN(I));
     1373    10937    6                     END;
     1374    10938    5                END;
     1375    10939    4           END;
     1376    10940    3      IF NOT ((B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#) OR OUT_BUF=' ')
     1377    10941    3      THEN                                 /* Don't print if BREAK hit           */
     1378    10942    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1379    10943        /***********************************
     1380    10944         ****       put out the eighth record
     1381    10945         ***********************************/
     1382    10946    3      IF JSP.TYPE~=%AZ$PROC
     1383    10947    4      THEN DO;
     1384    10948    4           OUT_BUF = 'RESOURCE MEMORY REQUIRED';
     1385    10949    4           CALL BINCHAR(OBNC.NUM1.NUM,JSP.RESPEAK);
     1386    10950    4           CALL EDITCHAR(OBNC.NUM1.NUM,,,MOP_7_0_STR,OBNC.NUM1.NUM);
     1387    10951    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1388    10952    4           THEN CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1389    10953                                                /* Don't print if BREAK hit           */
     1390    10954    4           END;
     1391    10955        /***********************************
     1392    10956         ****       put out the pseudo-resource record(s)
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:44   
     1393    10957         ***********************************/
     1394    10958    3      IF JSP.SUDOX>0
     1395    10959    4      THEN DO;
     1396    10960    4           OUT_BUF = 'PSEUDOS';
     1397    10961    4           IF JSP.SUDO_CNT>5
     1398    10962    4           THEN I = 5;
     1399    10963    4           ELSE I = JSP.SUDO_CNT;
     1400    10964    5           DO WHILE(I>0);
     1401    10965    5                I = I - 1;
     1402    10966    5                OBP.SUDO.NAME(I) = SUDO.NAM(I);
     1403    10967    5                OBP.SUDO.EQ(I) = '=';
     1404    10968    5                CALL BINCHAR(OBP.SUDO.NUM(I),SUDO.MAX(I));
     1405    10969    5                CALL EDITCHAR(OBP.SUDO.NUM(I),,,MOP_2_0_STR,OBP.SUDO.NUM(I));
     1406    10970    5                END;
     1407    10971    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1408    10972    4           THEN                            /* Don't print if BREAK hit           */
     1409    10973    4                CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1410    10974    4           IF JSP.SUDO_CNT>5
     1411    10975    5           THEN DO;
     1412    10976    5                I = JSP.SUDO_CNT;
     1413    10977    5                OUT_BUF = ' ';
     1414    10978    6                DO WHILE(I>5);
     1415    10979    6                     I = I - 1;
     1416    10980    6                     OBP.SUDO.NAME(I) = SUDO.NAM(I+5);
     1417    10981    6                     OBP.SUDO.EQ(I) = '=';
     1418    10982    6                     CALL BINCHAR(OBP.SUDO.NUM(I),SUDO.MAX(I+5));
     1419    10983    6                     CALL EDITCHAR(OBP.SUDO.NUM(I),,,MOP_2_0_STR,
     1420    10984    6                       OBP.SUDO.NUM(I));
     1421    10985    6                     END;
     1422    10986    5                IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1423    10987    5                THEN                       /* Don't print if BREAK hit           */
     1424    10988    5                     CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
     1425    10989    5                END;
     1426    10990    4           END;
     1427    10991    4      DO WHILE('0'B);
     1428    10992    4   WR_ALT: CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);
     1429    10993    4           END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:45   
     1430    10994    3      FPT_TIME.DATE_ = VECTOR(NIL);
     1431    10995    3      RETURN;
     1432    10996    3   END NO_CHG;
     1433    10997        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:46   
     1434    10998    2   CHG: PROC(IDX,CNT,RATE,PRATE,JSNAME);
     1435    10999        /*I* NAME: CHG
     1436    11000             CALL: CALL CHG(IDX,CNT,RATE,PRATE,JSNAME);
     1437    11001                where: IDX is a unique index into ITBL for this chargable item
     1438    11002                       CNT is the number of items to charge for
     1439    11003                       RATE is a decimal number...rate per unit
     1440    11004                       PRATE is a decimal number...rate per unit from a processor tbl
     1441    11005                       JSNAME is a character string...name of this job or step unit
     1442    11006             PURPOSE: To generate a line of output for this chargable item and output
     1443    11007             it. Also to accumulate processor charges for later (or current) use
     1444    11008        */
     1445    11009    3   DCL IDX SBIN;
     1446    11010    3   DCL CNT SBIN;
     1447    11011    3   DCL CHG_VAL SBIN;
     1448    11012    3   DCL RATE BIT(72) ALIGNED;
     1449    11013    3   DCL PRATE BIT(72) ALIGNED;
     1450    11014    3   DCL JSNAME CHAR(16);
     1451    11015    3   DCL 1 ITBL(0:32) CONSTANT,              /* ITBL is a table containing         */
     1452    11016                                                /* necessary  information about       */
     1453    11017                                                /* the chargable item indexed by      */
     1454    11018                                                /* IDX                                */
     1455    11019    3         2 NAME CHAR(21) INIT(             /* NAME is the name of this item      */
     1456    11020    3           'JOB STEPS',
     1457    11021    3           'PMMES ISSUED',
     1458    11022    3           'FEP INTERRUPT LEVELS',
     1459    11023    3           'TERMINAL INTERACTIONS',
     1460    11024    3           'CONNECT TIME',
     1461    11025    3           '  PROC EXEC TIME',
     1462    11026    3           '  USER EXEC TIME',
     1463    11027    3           '  PROC SERVICE TIME',
     1464    11028    3           '  USER SERVICE TIME',
     1465    11029    3           'PROC MEMORY USED',
     1466    11030    3           'USER MEMORY USED',
     1467    11031    3           'TEMP DISK USED',
     1468    11032    3           'RESOURCE TAPE(CPU)',
     1469    11033    3           'RESOURCE TAPE(CLOCK)',
     1470    11034    3           'RESOURCE DISK(CPU)',
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:47   
     1471    11035    3           'RESOURCE DISK(CLOCK)',
     1472    11036    3           'RESOURCE OTHER(CPU)',
     1473    11037    3           'RESOURCE OTHER(CLOCK)',
     1474    11038    3           'TAPE ACCESSES',
     1475    11039    3           'DISK ACCESSES',
     1476    11040    3           'OTHER ACCESSES',
     1477    11041    3           'TAPE MOUNTS',
     1478    11042    3           'DISK MOUNTS',
     1479    11043    3           'OTHER MOUNTS',
     1480    11044    3           'SUNIT1',
     1481    11045    3           'SUNIT2',
     1482    11046    3           'SUNIT3',
     1483    11047    3           'SUNIT4',
     1484    11048    3           'JUNIT1',
     1485    11049    3           'JUNIT2',
     1486    11050    3           'JUNIT3',
     1487    11051    3           'JUNIT4',
     1488    11052    3           'CPU TIME USED'),
     1489    11053    3         2 DIV SBIN INIT(                  /* Amount by which to divide to       */
     1490    11054                                                /* get into correct units             */
     1491    11055    3           1, 1, 1, 1,6000,
     1492    11056    3           6000,6000,6000,6000,6000,
     1493    11057    3           6000,6000,6000,6000,6000,
     1494    11058    3           6000,6000,6000, 1, 1,
     1495    11059    3           1, 1, 1, 1, 1,
     1496    11060    3           1, 1, 1, 1, 1,
     1497    11061    3           1, 1,6000),
     1498    11062    3         2 FLT BIT(1) UNAL INIT(           /* Floating point indicator.          */
     1499    11063                                                /*   '0'B - Binary                    */
     1500    11064                                                /*   '1'B - Floating point            */
     1501    11065    3           '0'B*5,
     1502    11066    3           '0'B*5,
     1503    11067    3           '0'B,'1'B,'0'B*3,
     1504    11068    3           '0'B*5,
     1505    11069    3           '0'B*5,
     1506    11070    3           '0'B*5,
     1507    11071    3           '0'B*3),
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:48   
     1508    11072    3         2 DISPLAY UBIN BYTE UNAL INIT(    /* Display code.                      */
     1509    11073                                                /* 0= 0 places past dec pt            */
     1510    11074                                                /* 2= 2 places past dec pt            */
     1511    11075                                                /* 3= Special case for SUNITS         */
     1512    11076                                                /*    (actually displayed as if 0)    */
     1513    11077                                                /* 4= Special case for floating point */
     1514    11078                                                /* CNT values. (Actually displayed as */
     1515    11079                                                /* if 2)                              */
     1516    11080                                                /* 5= as a time (12:25:15.11)         */
     1517    11081    3           0,0,0,0,5,
     1518    11082    3           5,5,5,5,2,
     1519    11083    3           2,4,2,2,2,
     1520    11084    3           2,2,2,0,0,
     1521    11085    3           0,0,0,0,3,
     1522    11086    3           3,3,3,0,0,
     1523    11087    3           0,0,5),
     1524    11088    3         2 UNITS CHAR(8) INIT(             /* UNITS contains a string            */
     1525    11089                                                /* describing the units of this       */
     1526    11090                                                /* item                               */
     1527    11091    3           '/step   ','/pmme   ','/level  ','/tinter ','/min    ',
     1528    11092    3           '/min    ','/min    ','/min    ','/min    ','/pg-min ',
     1529    11093    3           '/pg-min ','/pg-min ','/res-min','/res-min','/res-min',
     1530    11094    3           '/res-min','/res-min','/res-min','/access ','/access ',
     1531    11095    3           '/access ','/mount  ','/mount  ','/mount  ','/unit   ',
     1532    11096    3           '/unit   ','/unit   ','/unit   ','/unit   ','/unit   ',
     1533    11097    3           '/unit   ','/unit   ','        ');
     1534    11098    3   DCL BL CHAR(4) CONSTANT INIT('    ');
     1535    11099    3   DCL TEMP1 UBIN;
     1536    11100    3   DCL DIGITS SBIN;
     1537    11101    3   DCL HRS SBIN;
     1538    11102    3   DCL FCNT SBIN;
     1539    11103    3   DCL FDIV SBIN;
     1540    11104    3   DCL 1 DECFLT,
     1541    11105    3         2 SIGN CHAR(1) UNAL,
     1542    11106    3         2 DIGITS CHAR(10) UNAL,
     1543    11107    3         2 DIGIT_ARY(0:9) REDEF DIGITS CHAR(1) UNAL,
     1544    11108    3         2 * BIT(1) UNAL,
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:49   
     1545    11109    3         2 EXP SBIN(8) UNAL;
     1546    11110        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:50   
     1547    11111    3      IF CNT>0
     1548    11112    3        OR ((JSP.TYPE=%AZ$JOBEND OR JSP.TYPE=%AZ$RECOVERY OR
     1549    11113    3        JSP.TYPE=%AZ$STATUS OR JSP.TYPE=%AZ$BUDGET)
     1550    11114    3        AND (SACCUM.PCHG(IDX)>0 OR (IDX>23
     1551    11115    3        AND IDX<28 AND SACCUM.SUNIT(IDX-24)>0)))
     1552    11116    3        OR (JSP.TYPE=%AZ$STEP AND PACCUM(IDX)>0)
     1553    11117    3      THEN ;                               /* Something to do ...                */
     1554    11118    3      ELSE RETURN;                         /* Nothing to do ...                  */
     1555    11119    3      OUT_BUF = ' ';                       /* Blank out the buffer               */
     1556    11120    3      IF JSP.TYPE=%AZ$PROC
     1557    11121    4      THEN DO;
     1558    11122    4           CHG2 = 0;
     1559    11123    4           IF PRT.PERCENT# AND (IDX<24 OR IDX>27)
     1560    11124                                                /* Percent not allowed for step units */
     1561    11125                                                /* for a proprietary record           */
     1562    11126    4           THEN CALL AZB$MTH3D2B(CHG1,RT.CMULT#,RATE,PRATE,CNT,
     1563    11127    4                  ITBL.DIV(IDX),ITBL.FLT(IDX));
     1564    11128    4           ELSE CALL AZB$MTH3D2B(CHG1,RT.CMULT#,PRATE,F1,CNT,
     1565    11129    4                  ITBL.DIV(IDX),ITBL.FLT(IDX));
     1566    11130    4           PACCUM(IDX) = PACCUM(IDX) + CHG1;
     1567    11131    4           SACCUM.PCHG(IDX) = SACCUM.PCHG(IDX) + CHG1;
     1568    11132    4           END;
     1569    11133    3      ELSE IF JSP.TYPE=%AZ$STEP
     1570    11134    4           THEN DO;
     1571    11135    4                CHG1 = PACCUM(IDX);
     1572    11136    4                CALL AZB$MTH3D2B(CHG2,RT.CMULT#,RATE,F1,CNT,ITBL.DIV(IDX),ITBL.FLT(IDX)
             11136                         );
     1573    11137    4                IF IDX>23 AND IDX<28
     1574    11138    4                THEN SACCUM.SUNIT(IDX-24) = SACCUM.SUNIT(IDX-24) + CHG2;
     1575    11139    4                END;
     1576    11140    4           ELSE DO;                   /* %AZ$STATUS, %AZ$JOBEND or %AZ$RECOVERY  */
     1577    11141    4                CHG1 = SACCUM.PCHG(IDX);
     1578    11142    4                IF IDX<24 OR IDX>27
     1579    11143    4                THEN CALL AZB$MTH3D2B(CHG2,RT.CMULT#,RATE,F1,CNT,
     1580    11144    4                       ITBL.DIV(IDX),ITBL.FLT(IDX));
     1581    11145    5                ELSE DO;
     1582    11146    5                     CHG2 = SACCUM.SUNIT(IDX-24);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:51   
     1583    11147    5                     JSP.SUNIT_CHG(IDX-24) = CHG2;
     1584    11148    5                     END;
     1585    11149    4                END;
     1586    11150    3      JSP.PCHG = JSP.PCHG + CHG1;
     1587    11151    3      JSP.CHG = JSP.CHG + CHG2;
     1588    11152    3      IF STATSLEV=%AZ_ALL#
     1589    11153    4      THEN DO;                             /* Write record since desired         */
     1590    11154    4           OB.SCLR.NAME = ITBL.NAME(IDX);
     1591    11155    4           IF JSNAME~=' '
     1592    11156    5           THEN DO;
     1593    11157    5                OB.SCLR.JSUNIT.Q1 = '''';
     1594    11158    5                OB.SCLR.JSUNIT.JSNAME = JSNAME;
     1595    11159    5                OB.SCLR.JSUNIT.Q2 = '''';
     1596    11160    5                END;
     1597    11161    5           DO CASE(ITBL.DISPLAY(IDX));
     1598    11162    5            CASE(0);
     1599    11163    5              CALL BINCHAR(CHR8,CNT/ITBL.DIV(IDX));
     1600    11164    5              CALL EDITCHAR(OB.SCLR.SCLR,,,MOP_8_0_STR,CHR8);
     1601    11165    5            CASE(2);
     1602    11166    5              CALL BINCHAR(CHR9,CNT*100/ITBL.DIV(IDX));
     1603    11167    5              CALL EDITCHAR(OB.DEC2.DEC2,,,MOP_7_2_STR,CHR9);
     1604    11168    5            CASE(3/* SUNIT special case */);
     1605    11169    5              IF JSP.TYPE=%AZ$STEP OR JSP.TYPE=%AZ$PROC
     1606    11170    6              THEN DO;
     1607    11171    6                   CALL BINCHAR(CHR8,CNT/ITBL.DIV(IDX));
     1608    11172    6                   CALL EDITCHAR(OB.SCLR.SCLR,,,MOP_8_0_STR,CHR8);
     1609    11173    6                   END;
     1610    11174    5            CASE(4/* FLOATING POINT special case */);
     1611    11175    5              FCNT = CNT;
     1612    11176    5              CALL AZB$FLOAT(100,TEMP1);
     1613    11177    5              CALL AZB$FMP(FCNT,TEMP1);
     1614    11178    5              CALL AZB$FLOAT(ITBL.DIV(IDX),FDIV);
     1615    11179    5              CALL AZB$FDV(FCNT,FDIV);
     1616    11180    5              CALL AZA$FLTTODEC(FCNT,DECFLT);
     1617    11181    5              TEMP1 = 0;
     1618    11182    6              DO WHILE(DECFLT.DIGIT_ARY(TEMP1)='0');
     1619    11183    6                   TEMP1 = TEMP1+1;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:52   
     1620    11184    6                   END;
     1621    11185    5              DIGITS = 10+DECFLT.EXP-TEMP1;
     1622    11186    5              IF DIGITS > 12
     1623    11187    5              THEN OB.DEC2.DEC2 = '**********'; /* Value too large to disp       */
     1624    11188    6              ELSE DO;
     1625    11189    6                   IF DIGITS > 9
     1626    11190    6                   THEN CALL CONCAT (OB.DEC2.DEC2,SUBSTR(BL,0,12-DIGITS),SUBSTR(DECFLT.
             11190                            DIGITS,TEMP1));
     1627    11191    7                   ELSE DO;
     1628    11192    7                        CALL CONCAT (CHR9,SUBSTR(ZERO,0,9-DIGITS),SUBSTR(DECFLT.DIGITS,
             11192                                 TEMP1),ZERO);
     1629    11193    7                        CALL EDITCHAR(OB.DEC2.DEC2,,,MOP_7_2_STR,CHR9);
     1630    11194    7                        END;
     1631    11195    6                   END;
     1632    11196    5            CASE(5/* Time display */);
     1633    11197    5              FPT_TIME.TSTAMP_ = VECTOR(CNT);
     1634    11198    5              CALL M$TIME(FPT_TIME) ALTRET(WRITE_ALT);
     1635    11199    5              HRS = CNT/360000;
     1636    11200    5              CALL BINCHAR(OB.TIM1.HRS,HRS);
     1637    11201    5              CALL STRIP_TIME(ADDR(OB.TIM1.HRS),5);
     1638    11202    5              END;                         /* End case                           */
     1639    11203    4           IF NOT B$JIT.BLINDACCTNG
     1640    11204    5           THEN DO;                        /* Tell the user about charge details */
     1641    11205        /***********************************
     1642    11206         ****       Report chg-per-unit for all cases but SUNITs at JOBEND and Tot. CPU
     1643    11207         ***********************************/
     1644    11208    5                IF (IDX<24 OR IDX>27 OR JSP.TYPE=%AZ$STEP OR JSP.TYPE=%AZ$PROC)
     1645    11209    5                  AND IDX~=32
     1646    11210    6                THEN DO;
     1647    11211    6                     IF JSP.TYPE=%AZ$PROC
     1648    11212    6                     THEN IF PRT.PERCENT#
     1649    11213    6                          THEN CALL AZB$MTH3D2B(T1,RT.CMULT#,RATE,PRATE,1,1,'0'B);
     1650    11214    6                          ELSE CALL AZB$MTH3D2B(T1,RT.CMULT#,PRATE,F1,1,1,'0'B);
     1651    11215    6                     ELSE CALL AZB$MTH3D2B(T1,RT.CMULT#,RATE,F1,1,1,'0'B);
     1652    11216    6                     OB.BL_AT = ' @';
     1653    11217    6                     CALL BINCHAR(CHR10,T1);
     1654    11218                                           /* #23005...change handling of
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:53   
     1655    11219                                                unit price  (JLJ)       */
     1656    11220    6                     CALL EDITCHAR (CHR11,,,MOP_6_4_STR,CHR10);
     1657    11221    6                     OB.PER_UNIT = SUBSTR(CHR11,1,8);
     1658    11222    6                     IF SUBSTR(CHR11,0,1) ~= ' '
     1659    11223    6                     THEN
     1660    11224    6                          OB.PER_UNIT = SUBSTR(CHR11,0,8);
     1661    11225    6                     IF SUBSTR(CHR11,0,3) = '   '
     1662    11226    6                     THEN
     1663    11227    6                          OB.PER_UNIT = SUBSTR(CHR11,3,8);
     1664    11228    6                     OB.UNITS = ITBL.UNITS(IDX);
     1665    11229    6                     END;
     1666    11230    5                CHG_VAL = (CHG1+50)/100;
     1667    11231    5                IF CHG_VAL~=0
     1668    11232    6                THEN DO;                   /* something for the proc field       */
     1669    11233    6                     CALL BINCHAR(CHR7,CHG_VAL);
     1670    11234    6                     CALL EDITCHAR(OB.PCHG,,,MOP_5_2_STR,CHR7);
     1671    11235    6                     OB.O_PAREN = '(';
     1672    11236    6                     OB.C_PAREN = ')';
     1673    11237    6                     END;
     1674    11238    5                CHG_VAL = (CHG2+50)/100;
     1675    11239    5                IF CHG_VAL~=0
     1676    11240    6                THEN DO;
     1677    11241    6                     CALL BINXCHAR(CHR8,CHG_VAL);
     1678    11242    6                     CALL EDITXCHAR(OB.CHG,,,MOPS_5_2_STR,CHR8);
     1679    11243    6                     END;
     1680    11244    5                END;
     1681    11245    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
     1682    11246    4           THEN                            /* Don't print if BREAK hit           */
     1683    11247    4                CALL M$WRITE(FPT_WRITE) ALTRET(WRITE_ALT);
     1684    11248    5           DO WHILE('0'B);
     1685    11249    5   WRITE_ALT:   CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);
     1686    11250    5                END;
     1687    11251    4           END;
     1688    11252    3   END CHG;
     1689    11253        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:54   
     1690    11254    2   STRIP_TIME: PROC(TIME$,MAX);
     1691    11255        /*I* NAME: STRIP_TIME
     1692    11256             PURPOSE: To strip leading zeroes and colons from a TIME field
     1693    11257             CALL: CALL STRIP_TIME(TIME$,MAX);
     1694    11258                       where TIME$ is a pointer to a TIME text field to strip
     1695    11259                         and MAX is the maximum number of characters to strip
     1696    11260             DESCRIPTION: This procedure strips leading zeroes and colons from
     1697    11261             the character string pointed to by TIME$ for a maximum of MAX
     1698    11262             characters. The zeroes and colons are replaced by blanks.
     1699    11263        */
     1700    11264    3   DCL TIME$ PTR;
     1701    11265    3   DCL MAX SBIN;
     1702    11266    3   DCL CHR$ARY(0:0) CHAR(1) BASED(TIME$);
     1703    11267    3   DCL I SBIN;
     1704    11268    3      I = 0;
     1705    11269    4      DO WHILE(I<MAX AND (CHR$ARY(I)='0' OR CHR$ARY(I)=':'));
     1706    11270    4           CHR$ARY(I) = ' ';
     1707    11271    4           I = I+1;
     1708    11272    4           END;
     1709    11273    3   END STRIP_TIME;
     1710    11274    2   END CHARGE_PRINT;
     1711    11275        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:55   
     1712    11276    1   FILL_REC: PROC(CODE) ALTRET;
     1713    11277        /*I* NAME: FILL_REC
     1714    11278             PURPOSE: To fill a JSP record of the specified CODE and return it
     1715    11279             CALL: CALL FILL_REC(CODE) ALTRET(LABEL);
     1716    11280                    where CODE is optional. If present means to get a JSP record
     1717    11281                               of the specified code. Possible codes if specified
     1718    11282                               are %AZ$JOBEND, %AZ$RECOVERY, %AZ$STATUS or %AZ$BUDGET.
     1719    11283                               If not specified, the code is to come from an already
     1720    11284                               read record.
     1721    11285
     1722    11286             DESCRIPTION: This procedure returns a JSP record of the specified
     1723    11287                          CODE or ALTRETURNs trying. The record is complete upon
     1724    11288                          return except for charge fields and :RATES record key
     1725    11289                          fields.
     1726    11290
     1727    11291                          If no CODE is specified, it is assumed that
     1728    11292                          REC1 contains a PSTART or SSTART record from *S and
     1729    11293                          the key of this record is in ACCT$KEY. All subsequent
     1730    11294                          processor or step records for that step and proc number
     1731    11295                          are read in and used to create a composite JSP record
     1732    11296                          which is then returned.
     1733    11297        */
     1734    11298    2   DCL CODE SBIN;
     1735    11299    2   DCL CUR_STEP SBIN;
     1736    11300    2   DCL CUR_PROC SBIN;
     1737    11301    2   DCL LAST_TYPE SBIN;
     1738    11302    2   DCL SUDO$ PTR;
     1739    11303    2   DCL SUDO1$ PTR;
     1740    11304    2   DCL RES$ PTR;
     1741    11305    2   DCL RES1$ PTR;
     1742    11306    2   DCL FORM$ PTR;
     1743    11307    2   DCL FORM1$ PTR;
     1744    11308        %SUDO(NAME = SUDO,STCLASS="BASED(SUDO$)");
     1745    11339        %SUDO(NAME = SUDO1,STCLASS="BASED(SUDO1$)");
     1746    11370        %RES(NAME = RES ,STCLASS="BASED(RES$)");
     1747    11427        %RES(NAME = RES1,STCLASS="BASED(RES1$)");
     1748    11484        %FORM(NAME = FORM ,STCLASS="BASED(FORM$)");
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:56   
     1749    11530        %FORM(NAME = FORM1,STCLASS="BASED(FORM1$)");
     1750    11576    2      IF ADDR(CODE)~=ADDR(NIL)
     1751    11577    3      THEN DO;
     1752    11578    4           DO CASE(CODE);
     1753    11579    4            CASE(%AZ$STATUS,%AZ$JOBEND,%AZ$BUDGET);
     1754    11580    4              FPT_ACCT.V.TYP# = %JOBEND#;
     1755    11581    4            CASE(%AZ$RECOVERY);
     1756    11582    4              FPT_ACCT.V.TYP# = %RCVRY#;
     1757    11583    4              END;
     1758    11584    3           CALL M$ACCT(FPT_ACCT) ALTRET(POST_IT);
     1759    11585    3           JSP.TYPE = CODE;                /* For CODE=%AZ$STATUS case           */
     1760    11586    3           CALL XUD$UTS_DIFF (JSP.ELAPSED, JSP.CUR_UTS, JSP.START);
     1761    11587    3           IF JSP.MODE = %M_INT#
     1762    11588    3           THEN JSP.CONNECT = JSP.ELAPSED;
     1763    11589    3           RETURN;
     1764    11590    3           END;
     1765    11591        /**/
     1766    11592        /* If we get here, we must form a composite record from several in *S        */
     1767    11593        /**/
     1768    11594    2      IF ACCT$KEY.TYPE#~=%PSTART# AND ACCT$KEY.TYPE#~=%SSTART#
     1769    11595    3      THEN DO;                             /* Must start with an xSTART record   */
     1770    11596    3           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_MALSTARS);
     1771    11597    3           ALTRETURN;
     1772    11598    3           END;
     1773    11599        /*E* ERROR: AZA-E$AZ_MALSTARS
     1774    11600             MESSAGE: The *S accounting records are malformed or unbalanced
     1775    11601        */
     1776    11602
     1777    11603    2      JSP = '0'B;                          /* Clear it out for a new record      */
     1778    11604    2      RECLEN = SIZEC(JSP);
     1779    11605    2      JSP.CODE = JSP1.CODE;
     1780    11606    2      JSP.ACCT = JSP1.ACCT;
     1781    11607    2      JSP.USERNAME = JSP1.USERNAME;
     1782    11608    2      JSP.JOBNAME = JSP1.JOBNAME;
     1783    11609    2      JSP.WOO = JSP1.WOO;
     1784    11610    2      JSP.ATITLE = JSP1.ATITLE;
     1785    11611    2      JSP.SUBMIT = JSP1.SUBMIT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:57   
     1786    11612    2      JSP.START = JSP1.START;
     1787    11613    2      JSP.HOLD_UTS = JSP1.HOLD_UTS;
     1788    11614    2      JSP.PRIO = JSP1.PRIO;
     1789    11615    2      JSP.PART# = JSP1.PART#;
     1790    11616    2      JSP.PART_MASK = JSP1.PART_MASK;
     1791    11617    2      JSP.MODE = JSP1.MODE;
     1792    11618    2      JSP.TYPE = JSP1.TYPE;
     1793    11619    2      JSP.SYSID = JSP1.SYSID;
     1794    11620    2      JSP.PROCNAME = JSP1.PROCNAME;
     1795    11621    2      JSP.STEP = JSP1.STEP;
     1796    11622    2      JSP.JORG = JSP1.JORG;
     1797    11623    2      JSP.FLG = JSP1.FLG;
     1798    11624    2      JSP.TSLINE = JSP1.TSLINE;
     1799    11625    2      CUR_STEP = ACCT$KEY.STEP#;
     1800    11626    2      CUR_PROC = ACCT$KEY.PROC#;
     1801    11627    2      LAST_TYPE = ACCT$KEY.TYPE#;
     1802    11628    2      ACCT_KEY_SAVE = ACCT$KEY;
     1803    11629
     1804    11630    3      DO WHILE(ACCT$KEY.ACCT#='a' AND ACCT$KEY.STEP#=CUR_STEP
     1805    11631    3        AND ACCT$KEY.PROC#=CUR_PROC);
     1806    11632    3           LAST_TYPE = ACCT$KEY.TYPE#;
     1807    11633
     1808    11634    4           DO CASE(LAST_TYPE);
     1809    11635    4            CASE(%PSTART#,%SSTART#);
     1810    11636    4              CALL SUB_EM ALTRET(ALT);
     1811    11637
     1812    11638    4            CASE(%PSTOP#,%SSTOP#);
     1813    11639    4              CALL ADD_EM ALTRET(ALT);
     1814    11640    4              END;
     1815    11641
     1816    11642    3           CALL M$READ(FPT_READ)
     1817    11643    4           WHENALTRETURN DO;
     1818    11644    4                ACCT_KEY_SAVE = ACCT$KEY;
     1819    11645
     1820    11646    4                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF
     1821    11647    4                THEN GOTO CHECK_STOP;
     1822    11648
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:58   
     1823    11649    4   POST_IT:     ;
     1824    11650    4                CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
     1825    11651    4   ALT:         ;
     1826    11652    4                ALTRETURN;
     1827    11653    4                END;
     1828    11654
     1829    11655    3           ACCT_KEY_SAVE = ACCT$KEY;
     1830    11656    3           END/*do while 'a' */;
     1831    11657
     1832    11658    2   CHECK_STOP: ;
     1833    11659    2      IF LAST_TYPE~=%PSTOP# AND LAST_TYPE~=%SSTOP#
     1834    11660    3      THEN DO;                             /* Didn't end on an xSTOP record      */
     1835    11661    3           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_MALSTARS);
     1836    11662    3           ALTRETURN;
     1837    11663    3           END;
     1838    11664
     1839    11665    2      CALL XUD$UTS_DIFF (JSP.ELAPSED, JSP.CUR_UTS, JSP.START);
     1840    11666    2      RETURN;
     1841    11667        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:59   
     1842    11668    2   ADD_EM: PROC ALTRET;
     1843    11669        /*I* NAME: ADD_EM
     1844    11670             PURPOSE: To add entries from JSP1 into JSP on a PSTOP or SSTOP record
     1845    11671             CALL: CALL ADD_EM ALTRET(LABEL);
     1846    11672             DESCRIPTION: This procedure simply takes the entries from JSP1 and
     1847    11673             adds them to the corresponding values in JSP. If an overflow of REC
     1848    11674             occurs, the procedure will ALTRETURN.
     1849    11675        */
     1850    11676    3   DCL I SBIN WORD;
     1851    11677    3      JSP.CUR_UTS = JSP1.CUR_UTS;
     1852    11678    3      JSP.STEPCC = JSP1.STEPCC;
     1853    11679    3      JSP.RNST = JSP1.RNST;
     1854    11680    3      JSP.XLIMFLG = JSP1.XLIMFLG;
     1855    11681    3      JSP.PRDPUSED = JSP.PRDPUSED + JSP1.PRDPUSED;
     1856    11682    3      CALL AZB$FAD(JSP.UFTPS,JSP1.UFTPS);
     1857    11683    3      JSP.PMEMTIM = JSP.PMEMTIM + JSP1.PMEMTIM;
     1858    11684    3      JSP.UMEMTIM = JSP.UMEMTIM + JSP1.UMEMTIM;
     1859    11685    3      JSP.MTTIM_CLK = JSP.MTTIM_CLK + JSP1.MTTIM_CLK;
     1860    11686    3      JSP.DPTIM_CLK = JSP.DPTIM_CLK + JSP1.DPTIM_CLK;
     1861    11687    3      JSP.ORTIM_CLK = JSP.ORTIM_CLK + JSP1.ORTIM_CLK;
     1862    11688    3      JSP.MTTIM_CPU = JSP.MTTIM_CPU + JSP1.MTTIM_CPU;
     1863    11689    3      JSP.DPTIM_CPU = JSP.DPTIM_CPU + JSP1.DPTIM_CPU;
     1864    11690    3      JSP.ORTIM_CPU = JSP.ORTIM_CPU + JSP1.ORTIM_CPU;
     1865    11691    3      JSP.MTACCESS = JSP.MTACCESS + JSP1.MTACCESS;
     1866    11692    3      JSP.DPACCESS = JSP.DPACCESS + JSP1.DPACCESS;
     1867    11693    3      JSP.ORACCESS = JSP.ORACCESS + JSP1.ORACCESS;
     1868    11694    3      JSP.MTMOUNT = JSP.MTMOUNT + JSP1.MTMOUNT;
     1869    11695    3      JSP.DPMOUNT = JSP.DPMOUNT + JSP1.DPMOUNT;
     1870    11696    3      JSP.ORMOUNT = JSP.ORMOUNT + JSP1.ORMOUNT;
     1871    11697    3      JSP.TINTER = JSP.TINTER + JSP1.TINTER;
     1872    11698    3      JSP.PMMES = JSP.PMMES + JSP1.PMMES;
     1873    11699    3      JSP.PEXEC = JSP.PEXEC + JSP1.PEXEC;
     1874    11700    3      JSP.UEXEC = JSP.UEXEC + JSP1.UEXEC;
     1875    11701    3      JSP.PSTIME = JSP.PSTIME + JSP1.PSTIME;
     1876    11702    3      JSP.USTIME = JSP.USTIME + JSP1.USTIME;
     1877    11703    4      DO I=0 TO 3;
     1878    11704    4           JSP.JSUNITS(I) = JSP.JSUNITS(I) + JSP1.JSUNITS(I);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:60   
     1879    11705    4           END;
     1880    11706    3      IF JSP.TYPE=%AZ$STEP
     1881    11707    4      THEN DO;
     1882    11708    4           JSP.PKCO = JSP1.PKCO;
     1883    11709    4           JSP.TMDPPK = JSP1.TMDPPK;
     1884    11710    4           JSP.RESPEAK = JSP1.RESPEAK;
     1885    11711    4           END;
     1886    11712    3      IF JSP.MODE = %M_INT#
     1887    11713    3      THEN JSP.CONNECT = JSP.CONNECT + JSP1.CUR_UTS;
     1888    11714    3      IF JSP1.SUDO_CNT>0 THEN CALL SUDOS(1) ALTRET(ALT);
     1889    11715    3      IF JSP1.RES_CNT>0 THEN CALL RESOURCES(1) ALTRET(ALT);
     1890    11716    3      IF JSP1.FORM_CNT>0 THEN CALL FORMS(1) ALTRET(ALT);
     1891    11717    3      RETURN;
     1892    11718    3   ALT: ALTRETURN;
     1893    11719    3   END ADD_EM;
     1894    11720        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:61   
     1895    11721    2   SUB_EM: PROC ALTRET;
     1896    11722        /*I* NAME: SUB_EM
     1897    11723             PURPOSE: To sub entries in JSP1 from JSP on a PSTART or SSTART record
     1898    11724             CALL: CALL SUB_EM ALTRET(LABEL);
     1899    11725             DESCRIPTION: This procedure simply takes the entries from JSP1 and
     1900    11726             subtracts them from the corresponding values in JSP. If an overflow of
     1901    11727             REC occurs, the procedure will ALTRETURN.
     1902    11728        */
     1903    11729    3   DCL I SBIN WORD;
     1904    11730    3      JSP.PRDPUSED = JSP.PRDPUSED - JSP1.PRDPUSED;
     1905    11731    3      CALL AZB$FSB(JSP.UFTPS,JSP1.UFTPS);
     1906    11732    3      JSP.PMEMTIM = JSP.PMEMTIM - JSP1.PMEMTIM;
     1907    11733    3      JSP.UMEMTIM = JSP.UMEMTIM - JSP1.UMEMTIM;
     1908    11734    3      JSP.MTTIM_CLK = JSP.MTTIM_CLK - JSP1.MTTIM_CLK;
     1909    11735    3      JSP.DPTIM_CLK = JSP.DPTIM_CLK - JSP1.DPTIM_CLK;
     1910    11736    3      JSP.ORTIM_CLK = JSP.ORTIM_CLK - JSP1.ORTIM_CLK;
     1911    11737    3      JSP.MTTIM_CPU = JSP.MTTIM_CPU - JSP1.MTTIM_CPU;
     1912    11738    3      JSP.DPTIM_CPU = JSP.DPTIM_CPU - JSP1.DPTIM_CPU;
     1913    11739    3      JSP.ORTIM_CPU = JSP.ORTIM_CPU - JSP1.ORTIM_CPU;
     1914    11740    3      JSP.MTACCESS = JSP.MTACCESS - JSP1.MTACCESS;
     1915    11741    3      JSP.DPACCESS = JSP.DPACCESS - JSP1.DPACCESS;
     1916    11742    3      JSP.ORACCESS = JSP.ORACCESS - JSP1.ORACCESS;
     1917    11743    3      JSP.MTMOUNT = JSP.MTMOUNT - JSP1.MTMOUNT;
     1918    11744    3      JSP.DPMOUNT = JSP.DPMOUNT - JSP1.DPMOUNT;
     1919    11745    3      JSP.ORMOUNT = JSP.ORMOUNT - JSP1.ORMOUNT;
     1920    11746    3      JSP.TINTER = JSP.TINTER - JSP1.TINTER;
     1921    11747    3      JSP.PMMES = JSP.PMMES - JSP1.PMMES;
     1922    11748    3      JSP.PEXEC = JSP.PEXEC - JSP1.PEXEC;
     1923    11749    3      JSP.UEXEC = JSP.UEXEC - JSP1.UEXEC;
     1924    11750    3      JSP.PSTIME = JSP.PSTIME - JSP1.PSTIME;
     1925    11751    3      JSP.USTIME = JSP.USTIME - JSP1.USTIME;
     1926    11752    4      DO I=0 TO 3;
     1927    11753    4           JSP.JSUNITS(I) = JSP.JSUNITS(I) - JSP1.JSUNITS(I);
     1928    11754    4           END;
     1929    11755    3      IF JSP.MODE = %M_INT#
     1930    11756    3      THEN JSP.CONNECT = JSP.CONNECT - JSP1.CUR_UTS;
     1931    11757    3      IF JSP1.SUDO_CNT>0 THEN CALL SUDOS(-1) ALTRET(ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:62   
     1932    11758    3      IF JSP1.RES_CNT>0 THEN CALL RESOURCES(-1) ALTRET(ALT);
     1933    11759    3      IF JSP1.FORM_CNT>0 THEN CALL FORMS(-1) ALTRET(ALT);
     1934    11760    3      RETURN;
     1935    11761    3   ALT: ALTRETURN;
     1936    11762    3   END SUB_EM;
     1937    11763        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:63   
     1938    11764    2   MOVE: PROC(FROM,TOO,LEN) ALTRET;
     1939    11765        /*I* NAME: MOVE
     1940    11766             PURPOSE: To move the variable length portions of JSP around in REC
     1941    11767             CALL: CALL MOVE(FROM,TOO,LEN) ALTRET(LABEL);
     1942    11768                    where FROM is the word index into REC of the area to move
     1943    11769                          TOO is the word index into REC to move the area to
     1944    11770                          LEN is the length in words of the area to move
     1945    11771             DESCRIPTION: This procedure moves LEN words in REC from word index
     1946    11772             FROM to word index TOO. If the move would result in data being moved out
     1947    11773             of REC, the procedure does not move any data and ALTRETURNs.
     1948    11774        */
     1949    11775    3   DCL FROM SBIN;
     1950    11776    3   DCL TOO SBIN;
     1951    11777    3   DCL LEN SBIN;
     1952    11778    3   DCL I SBIN;
     1953    11779    3      IF TOO+LEN>1024 OR TOO<0
     1954    11780    3      THEN ALTRETURN;
     1955    11781    3      IF FROM<TOO
     1956    11782    4      THEN DO I=1 TO LEN;
     1957    11783    4           REC(TOO+LEN-I) = REC(FROM+LEN-I);
     1958    11784    4           END;
     1959    11785    4      ELSE DO I=0 TO LEN-1;
     1960    11786    4           REC(TOO+I) = REC(FROM+I);
     1961    11787    4           END;
     1962    11788    3      RETURN;
     1963    11789    3   END MOVE;
     1964    11790        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:64   
     1965    11791    2   SUDOS: PROC(MULT) ALTRET;
     1966    11792        /*I* NAME: SUDOS
     1967    11793             PURPOSE: To add or subtract the pseudo resource info in JSP1 to JSP
     1968    11794             CALL: CALL SUDOS(MULT) ALTRET(LABEL);
     1969    11795                    where MULT is 1 or -1 and determines whether the info is to
     1970    11796                    be added or subtracted from JSP
     1971    11797             DESCRIPTION: This procedure adds or subtracts the pseudo resource
     1972    11798             information in JSP1 from that in JSP. If JSP needs to be expanded to
     1973    11799             accomodate this, expansion is attempted. If the expansion fails (not
     1974    11800             enough room in REC), the procedure ALTRETURNs.
     1975    11801             If an un-used pseudo resource is found, it is removed from JSP
     1976    11802             thereby reducing the size of JSP.
     1977    11803        */
     1978    11804    3   DCL MULT SBIN WORD;
     1979    11805    3   DCL I SBIN;
     1980    11806    3   DCL J SBIN;
     1981    11807    3   DCL FROM SBIN;
     1982    11808    3   DCL FOUND BIT(1) ALIGNED;
     1983    11809    3      SUDO$ = PINCRW(REC$,JSP.SUDOX);
     1984    11810    3      SUDO1$ = PINCRW(REC1$,JSP1.SUDOX);
     1985    11811    4      DO J=0 TO JSP1.SUDO_CNT-1;
     1986    11812    4           I = 0;
     1987    11813    4           FOUND = '0'B;
     1988    11814    5           DO WHILE(NOT FOUND AND I<JSP.SUDO_CNT);
     1989    11815    5                IF SUDO1.NAM(J) = SUDO.NAM(I)
     1990    11816    5                THEN FOUND = '1'B;
     1991    11817    5                ELSE I = I+1;
     1992    11818    5                END;
     1993    11819    4           IF NOT FOUND
     1994    11820    5           THEN DO;                        /* Must add this entry                */
     1995    11821    5                IF JSP.RES_CNT>0 OR JSP.FORM_CNT>0
     1996    11822    6                THEN DO;                   /* Must make room by moving down      */
     1997    11823    6                     IF JSP.RES_CNT>0
     1998    11824    6                     THEN FROM = JSP.RESX;
     1999    11825    6                     ELSE FROM = JSP.FORMX;
     2000    11826    6                     CALL MOVE(FROM,FROM+SIZEW(SUDO(0)),RECLEN/4-FROM+1)
     2001    11827    6                       ALTRET(SZ_ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:65   
     2002    11828    6                     IF JSP.RES_CNT>0
     2003    11829    6                     THEN JSP.RESX = JSP.RESX+SIZEW(SUDO(0));
     2004    11830    6                     IF JSP.FORM_CNT>0
     2005    11831    6                     THEN JSP.FORMX = JSP.FORMX + SIZEW(SUDO(0));
     2006    11832    6                     END;
     2007    11833    5                IF JSP.SUDO_CNT=0
     2008    11834    6                THEN DO;
     2009    11835    6                     JSP.SUDOX = SIZEW(JSP);
     2010    11836    6                     SUDO$ = PINCRW(REC$,JSP.SUDOX);
     2011    11837    6                     END;
     2012    11838    5                JSP.SUDO_CNT = JSP.SUDO_CNT+1;
     2013    11839    5                RECLEN = RECLEN + SIZEC(SUDO(0));
     2014    11840    5                IF RECLEN>4096
     2015    11841    6                THEN DO;
     2016    11842    6   SZ_ALT:           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_LD);
     2017    11843        /*E*  ERROR: AZA-E$AZ_LD
     2018    11844            MESSAGE: Too much accounting information to fit in JSP record
     2019    11845        */
     2020    11846    6                     ALTRETURN;
     2021    11847    6                     END;
     2022    11848    5                SUDO(I) = '0'B;            /* Clear it out first                 */
     2023    11849    5                END;
     2024    11850    4           SUDO.NAM(I) = SUDO1.NAM(J);
     2025    11851    4           IF SUDO1.MAX(J)>SUDO.MAX(I)
     2026    11852    4           THEN SUDO.MAX(I) = SUDO1.MAX(J);
     2027    11853    4           SUDO.CPU(I) = SUDO.CPU(I) + MULT*SUDO1.CPU(J);
     2028    11854    4           SUDO.CLOCK(I) = SUDO.CLOCK(I) + MULT*SUDO1.CLOCK(J);
     2029    11855    4           IF SUDO.CLOCK(I)=0
     2030    11856    5           THEN DO;                        /* Remove any un-used SUDO entry      */
     2031    11857    5                FROM = JSP.SUDOX + (I+1)*SIZEW(SUDO(0));
     2032    11858    5                CALL MOVE(FROM,FROM-SIZEW(SUDO(0)),RECLEN/4-FROM+1);
     2033    11859    5                RECLEN = RECLEN-SIZEC(SUDO(0));
     2034    11860    5                JSP.SUDO_CNT = JSP.SUDO_CNT-1;
     2035    11861    5                JSP.RESX = JSP.RESX-SIZEW(SUDO(0));
     2036    11862    5                JSP.FORMX = JSP.FORMX-SIZEW(SUDO(0));
     2037    11863    5                END;
     2038    11864    4           END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:66   
     2039    11865    3      RETURN;
     2040    11866    3   END SUDOS;
     2041    11867        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:67   
     2042    11868    2   RESOURCES: PROC(MULT) ALTRET;
     2043    11869        /*I* NAME: RESOURCES
     2044    11870             PURPOSE: To add or subtract the resource info in JSP1 to JSP
     2045    11871             CALL: CALL RESOURCES(MULT) ALTRET(LABEL);
     2046    11872                       where MULT is either 1 or -1 and determines whether the info
     2047    11873                             in JSP1 is to be added or subtracted from that in JSP
     2048    11874             DESCRIPTION: This procedure adds or subtracts the resource information
     2049    11875             found in the JSP1 record from that found in the JSP record. If REC
     2050    11876             overflows during the process, the procedure will ALTRETURN.
     2051    11877             If an un-used resource is found, it is removed from JSP thereby
     2052    11878             reducing the size of JSP.
     2053    11879        */
     2054    11880    3   DCL MULT SBIN WORD;
     2055    11881    3   DCL I SBIN WORD;
     2056    11882    3   DCL J SBIN WORD;
     2057    11883    3   DCL FROM SBIN WORD;
     2058    11884    3   DCL FOUND BIT(1) ALIGNED;
     2059    11885    3      RES$ = PINCRW(REC$,JSP.RESX);
     2060    11886    3      RES1$ = PINCRW(REC1$,JSP1.RESX);
     2061    11887    4      DO J=0 TO JSP1.RES_CNT-1;
     2062    11888    4           I = 0;
     2063    11889    4           FOUND = '0'B;
     2064    11890    5           DO WHILE(NOT FOUND AND I<JSP.RES_CNT);
     2065    11891    5                IF RES.TYPE(I)=RES1.TYPE(J) AND RES.LOGNAME(I)=RES1.LOGNAME(J)
     2066    11892    5                  AND RES.WSN(I)=RES1.WSN(J)
     2067    11893    5                  AND RES.ATTR.MTWO(I)=RES1.ATTR.MTWO(J)
     2068    11894    5                THEN FOUND = '1'B;
     2069    11895    5                ELSE I = I+1;
     2070    11896    5                END;
     2071    11897    4           IF NOT FOUND
     2072    11898    5           THEN DO;                        /* Must add this entry                */
     2073    11899    5                IF JSP.FORM_CNT>0
     2074    11900    6                THEN DO;
     2075    11901    6                     CALL MOVE(JSP.FORMX,JSP.FORMX+SIZEW(RES(0)),
     2076    11902    6                       RECLEN/4-JSP.FORMX+1) ALTRET(SZ_ALT);
     2077    11903    6                     JSP.FORMX = JSP.FORMX+SIZEW(RES(0));
     2078    11904    6                     END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:68   
     2079    11905    5                IF JSP.RES_CNT=0
     2080    11906    6                THEN DO;                   /* Must initialize for RES section    */
     2081    11907    6                     JSP.RESX = SIZEW(JSP)+JSP.SUDO_CNT*SIZEW(SUDO(0));
     2082    11908    6                     RES$ = PINCRW(REC$,JSP.RESX);
     2083    11909    6                     END;
     2084    11910    5                JSP.RES_CNT = JSP.RES_CNT+1;
     2085    11911    5                RECLEN = RECLEN + SIZEC(RES(0));
     2086    11912    5                IF RECLEN>4096
     2087    11913    6                THEN DO;
     2088    11914    6   SZ_ALT:           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_LD);
     2089    11915    6                     ALTRETURN;
     2090    11916    6                     END;
     2091    11917    5                RES(I) = '0'B;             /* Clear it out first                 */
     2092    11918    5                RES.TYPE(I) = RES1.TYPE(J);
     2093    11919    5                RES.WSN(I) = RES1.WSN(J);
     2094    11920    5                RES.LOGNAME(I) = RES1.LOGNAME(J);
     2095    11921    5                END;
     2096    11922    4           RES.PHYSNAME(I) = RES1.PHYSNAME(J);
     2097    11923    4           RES.ATTR(I) = RES1.ATTR(J);
     2098    11924    4           RES.CLOCK(I) = RES.CLOCK(I) + MULT*RES1.CLOCK(J);
     2099    11925    4           RES.CPU(I) = RES.CPU(I) + MULT*RES1.CPU(J);
     2100    11926    4           IF RES.CLOCK(I)=0
     2101    11927    5           THEN DO;                        /* Remove any un-used RES entry       */
     2102    11928    5                FROM = JSP.RESX + (I+1)*SIZEW(RES(0));
     2103    11929    5                CALL MOVE(FROM,FROM-SIZEW(RES(0)),RECLEN/4-FROM+1);
     2104    11930    5                RECLEN = RECLEN-SIZEC(RES(0));
     2105    11931    5                JSP.RES_CNT = JSP.RES_CNT-1;
     2106    11932    5                JSP.FORMX = JSP.FORMX-SIZEW(RES(0));
     2107    11933    5                END;
     2108    11934    4           END;
     2109    11935    3      RETURN;
     2110    11936    3   END RESOURCES;
     2111    11937        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:69   
     2112    11938    2   FORMS: PROC(MULT) ALTRET;
     2113    11939        /*I* NAME: FORMS
     2114    11940             PURPOSE: To add or subtract the forms info in JSP1 to JSP
     2115    11941             CALL: CALL FORMS(MULT) ALTRET(LABEL);
     2116    11942                       where MULT is either 1 or -1 and determines whether the info
     2117    11943                             in JSP1 is to be added or subtracted from that in JSP
     2118    11944             DESCRIPTION: This procedure adds or subtracts the forms information
     2119    11945             found in the JSP1 record from that found in the JSP record. If REC
     2120    11946             overflows during the process, the procedure will ALTRETURN.
     2121    11947             If an un-used form is found, it is removed from JSP thereby
     2122    11948             reducing the size of JSP.
     2123    11949        */
     2124    11950    3   DCL MULT SBIN WORD;
     2125    11951    3   DCL I SBIN WORD;
     2126    11952    3   DCL J SBIN WORD;
     2127    11953    3   DCL FROM SBIN WORD;
     2128    11954    3   DCL FOUND BIT(1) ALIGNED;
     2129    11955    3      FORM$ = PINCRW(REC$,JSP.FORMX);
     2130    11956    3      FORM1$ = PINCRW(REC1$,JSP1.FORMX);
     2131    11957    4      DO J=0 TO JSP1.FORM_CNT-1;
     2132    11958    4           I = 0;
     2133    11959    4           FOUND = '0'B;
     2134    11960    5           DO WHILE(NOT FOUND AND I<JSP.FORM_CNT);
     2135    11961    5                IF FORM.S1(I)=FORM1.S1(J)
     2136    11962    5                THEN FOUND = '1'B;
     2137    11963    5                ELSE I = I+1;
     2138    11964    5                END;
     2139    11965    4           IF NOT FOUND
     2140    11966    5           THEN DO;                        /* Must add this entry                */
     2141    11967    5                IF JSP.FORM_CNT=0
     2142    11968    6                THEN DO;                   /* Must initialize for FORM section   */
     2143    11969    6                     JSP.FORMX = SIZEW(JSP)+JSP.SUDO_CNT*SIZEW(SUDO(0))
     2144    11970    6                       +JSP.RES_CNT*SIZEW(RES(0));
     2145    11971    6                     FORM$ = PINCRW(REC$,JSP.FORMX);
     2146    11972    6                     END;
     2147    11973    5                JSP.FORM_CNT = JSP.FORM_CNT+1;
     2148    11974    5                RECLEN = RECLEN + SIZEC(FORM(0));
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:70   
     2149    11975    5                IF RECLEN>4096
     2150    11976    6                THEN DO;
     2151    11977    6   SZ_ALT:           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_LD);
     2152    11978    6                     ALTRETURN;
     2153    11979    6                     END;
     2154    11980    5                FORM(I) = '0'B;            /* Clear it out first                 */
     2155    11981    5                FORM.S1(I) = FORM1.S1(J);
     2156    11982    5                END;
     2157    11983    4           FORM.FORMS(I) = FORM.FORMS(I) + MULT*FORM1.FORMS(J);
     2158    11984    4           FORM.MOUNTS(I) = FORM.MOUNTS(I) + MULT*FORM1.MOUNTS(J);
     2159    11985    4           IF FORM.FORMS(I)=0 AND FORM.MOUNTS(I)=0
     2160    11986    5           THEN DO;                        /* Remove any un-used FORM entry      */
     2161    11987    5                FROM = JSP.FORMX + (I+1)*SIZEW(FORM(0));
     2162    11988    5                CALL MOVE(FROM,FROM-SIZEW(FORM(0)),RECLEN/4-FROM+1);
     2163    11989    5                RECLEN = RECLEN-SIZEC(FORM(0));
     2164    11990    5                JSP.FORM_CNT = JSP.FORM_CNT-1;
     2165    11991    5                END;
     2166    11992    4           END;
     2167    11993    3      RETURN;
     2168    11994    3   END FORMS;
     2169    11995    2   END FILL_REC;
     2170    11996        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:71   
     2171    11997    1   UP_USERS: PROC;
     2172    11998        /*I* NAME: UP_USERS
     2173    11999             PURPOSE: To update :USERS file with charge information for this job
     2174    12000        */
     2175    12001        %AS_USERS(STR_NAME = AS_USERS,STCLASS = AUTO);
     2176    12179    2   DCL FIRST BIT(1) ALIGNED;
     2177    12180    2      FPT_READ.V.KEYS# = %YES#;
     2178    12181    2      FPT_READ.BUF_ = VECTOR(AS_USERS);
     2179    12182    2      IN_KEY.LEN = 20;
     2180    12183    2      CALL CONCAT(IN_KEY.KEY,JSP.ACCN,JSP.UNAME);
     2181    12184    3      DO WHILE(SUBSTR(IN_KEY.KEY,IN_KEY.LEN-1,1)=' ');
     2182    12185    3           IN_KEY.LEN = IN_KEY.LEN-1;
     2183    12186    3           END;
     2184    12187    2      CALL OPEN_FILE(F_USERS) ALTRET(ALTL1);
     2185    12188    2      FIRST = '1'B;
     2186    12189    3      DO WHILE(IN_KEY.LEN>8);              /* MACCT DEFAULT = 'NONE'             */
     2187    12190    3           CALL M$ENQ(FPT_ENQ) ALTRET(ALTL1);
     2188    12191    3           CALL M$READ(FPT_READ) ALTRET(ALTL);
     2189    12192    3           IF FIRST
     2190    12193    4           THEN DO;
     2191    12194    4                IF AS_USERS.BUDGET.ICHARGES
     2192    12195    4                THEN AS_USERS.BUDGET.ACCUM = AS_USERS.BUDGET.ACCUM+JSP.CHG;
     2193    12196    4                AS_USERS.LAST_LOGON_TIME = BINBIT (B$JIT.LOGONTIME,36);
     2194    12197    4                FIRST = '0'B;
     2195    12198    4                END;
     2196    12199    3           ELSE AS_USERS.BUDGET.PACCUM = AS_USERS.BUDGET.PACCUM+JSP.CHG;
     2197    12200    3           FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;
     2198    12201    3           FPT_WRITE.KEY_ = VECTOR(IN_KEY);
     2199    12202    3           FPT_WRITE.BUF_ = VECTOR(AS_USERS);
     2200    12203    3           CALL M$WRITE(FPT_WRITE) ALTRET(ALTL);
     2201    12204    3           CALL M$DEQ(FPT_DEQ) ALTRET(ALTL1);
     2202    12205    3           IF AS_USERS.BUDGET.PCHARGES
     2203    12206    3           THEN IN_KEY = AS_USERS.BUDGET.MACCT;
     2204    12207    3           ELSE IN_KEY.LEN = 0;
     2205    12208    3           END;
     2206    12209    3      DO WHILE('0'B);
     2207    12210    3   ALTL:   CALL M$DEQ(FPT_DEQ) ALTRET(ALTL1);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:72   
     2208    12211    3           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$NOKEY
     2209    12212    3           THEN
     2210    12213    3   ALTL1:       CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
     2211    12214    3           END;
     2212    12215    2      RETURN;
     2213    12216    2   END UP_USERS;
     2214    12217        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:73   
     2215    12218    1   WR_JOBSTATS: PROC;
     2216    12219        %XSJ_PARAM(FPTN = XSJ_PARAMC,STCLASS = CONSTANT,
     2217    12220                TYPE = %TYP_INFO#);
     2218    12237        %XSJ_PARAM(FPTN = XSJ_PARAM,STCLASS = AUTO);
     2219    12254        %XSJ_JOBINFO(FPTN = XSJ_JOBINFO,STCLASS = AUTO);
     2220    12269    2      CALL OPEN_FILE(F_JOBSTATS) ALTRET(NO_JOBSTATS);
     2221    12270    2      XSJ_PARAM = XSJ_PARAMC;
     2222    12271    2      XSJ_PARAM.DCB# = LOGOFF_PARAM.DCB1;
     2223    12272    2      XSJ_PARAM.SYSID# = JSP.SYSID;
     2224    12273    2      XSJ_PARAM.BUF_ = VECTOR(XSJ_JOBINFO);
     2225    12274    2      XSJ_JOBINFO.FRS# = JSP.RNST;
     2226    12275    2      XSJ_JOBINFO.OFF_TIME# = JSP.CUR_UTS;
     2227    12276    2      XSJ_JOBINFO.XLIMFLG# = JSP.XLIMFLG;
     2228    12277    2      XSJ_JOBINFO.STEPCC# = JSP.STEPCC;
     2229    12278    2      XSJ_JOBINFO.ACCT# = JSP.ACCT;
     2230    12279    2      IF LOGOFF_PARAM.CODE=%AZ$RECOVERY
     2231    12280    2      THEN XSJ_JOBINFO.STATUS# = %FIN_RECOVER#;
     2232    12281    2      ELSE IF JSP.RNST=%RS_EXIT#
     2233    12282    2           THEN XSJ_JOBINFO.STATUS# = %FIN_COMPLETED#;
     2234    12283    2           ELSE XSJ_JOBINFO.STATUS# = %FIN_ABNORMAL#;
     2235    12284    2      CALL XSJ$WRITE(XSJ_PARAM) ALTRET(NO_JOBSTATS);
     2236    12285    3      DO WHILE('0'B);
     2237    12286    3   NO_JOBSTATS: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
     2238    12287    3           END;
     2239    12288    2      RETURN;
     2240    12289    2   END WR_JOBSTATS;
     2241    12290        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:74   
     2242    12291    1   OUT_PGRANS: PROC;
     2243    12292        /*I* NAME: OUT_PGRANS
     2244    12293             PURPOSE: To put out a PGRANS record to :ACCTLG
     2245    12294        */
     2246    12295        %PGRANS(NAME = PGRANS,STCLASS = AUTO);
     2247    12361    2      PGRANS = '0'B;
     2248    12362    2      PGRANS.CODE = %AZ$PGRANS;
     2249    12363    2      PGRANS.CREATOR.ACCT = B$JIT.ACCN;
     2250    12364    2      PGRANS.CREATOR.UNAME = B$JIT.UNAME;
     2251    12365    2      PGRANS.FMACCT = B$JIT.ACCN;
     2252    12366    2      PGRANS.PSN = B$JIT.HPSN;
     2253    12367    2      PGRANS.ONLINE = B$JIT.GAC;
     2254    12368    2      CALL OPEN_FILE(F_ACCTLG) ALTRET(WRITE_ALT);
     2255    12369    2      FPT_WRITE.BUF_ = VECTOR(PGRANS);
     2256    12370    2      FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;
     2257    12371    2      CALL M$WRITE(FPT_WRITE) ALTRET(WRITE_ALT);
     2258    12372    3      DO WHILE('0'B);
     2259    12373    3   WRITE_ALT: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);
     2260    12374    3           END;
     2261    12375    2      RETURN;
     2262    12376    2   END OUT_PGRANS;
     2263    12377        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:75   
     2264    12378    1   POST_ERR: PROC(ERR,DCB#,ERR1);
     2265    12379        /*I* NAME: POST_ERR
     2266    12380             PURPOSE: To handle recording of error conditions
     2267    12381             DESCRIPTION: If ERR is greater than LOGOFF_PARAM.ERR, it is placed
     2268    12382             into LOGOFF_PARAM.ERR and if ERR1 is specified, it is used as
     2269    12383             B$JIT$->B$JIT.USRERR.CODE otheewise the causing monitor error is
     2270    12384             placed into B$JIT$->B$JIT.USRERR. If a DCB# is passed, the number
     2271    12385             along with other pertinent information is preserved for subsequent
     2272    12386             use by the calling program.
     2273    12387        */
     2274    12388    2   DCL ERR SBIN;
     2275    12389    2   DCL DCB# UBIN HALF ALIGNED;
     2276    12390    2   DCL ERR1 SBIN;
     2277    12391    2   DCL DCB$ PTR;
     2278    12392    2      IF ERR>LOGOFF_PARAM.ERR
     2279    12393    3      THEN DO;
     2280    12394    3           LOGOFF_PARAM.ERR = ERR;
     2281    12395    3           IF ADDR(ERR1)~=ADDR(NIL)
     2282    12396    4           THEN DO;
     2283    12397    4                B$JIT.USRERR = '013201000000'O;
     2284    12398    4                B$JIT.USRERR.CODE = ERR1;
     2285    12399    4                END;
     2286    12400    3           ELSE B$JIT.USRERR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     2287    12401    3           IF ADDR(DCB#) ~= ADDR(NIL)
     2288    12402    4           THEN DO;
     2289    12403    4                DCB#_SAVE = DCB#;
     2290    12404    4                DCB$ = DCBADDR(DCB#);
     2291    12405    4                ASN_SAVE =DCB$ -> F$DCB.ASN#;
     2292    12406    4                NAME_SAVE = DCB$ -> F$DCB.NAME#;
     2293    12407    4                ACCT_SAVE.ACCT# = DCB$ -> F$DCB.ACCT#;
     2294    12408    4                SN_SAVE.NUM# = 1;
     2295    12409    4                SN_SAVE.SN#(0) = DCB$ -> F$DCB.PSN#;
     2296    12410    4                END;
     2297    12411    3           END;
     2298    12412    2      RETURN;
     2299    12413    2   END POST_ERR;
     2300    12414    1   END AZA$LOGOFF;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:76   
     2301    12415        %EOD;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:77   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   AZ_PERR_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AR_TBLS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure AZA$LOGOFF.

   Procedure AZA$LOGOFF requires 4889 words for executable code.
   Procedure AZA$LOGOFF requires 2930 words of local(AUTO) storage.

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:78   

 Object Unit name= AZA$LOGOFF                                 File name= AZA$LOGOFF.:E05TOU
 UTS= JUL 29 '97 11:02:24.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS   1071   2057  AZA$LOGOFF
    2   Proc  even  none  4889  11431  AZA$LOGOFF
    3  RoData even  none   102    146  AZA$LOGOFF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  AZA$LOGOFF
     2    577          yes     yes      Std        1  AZA$FEPACCTNG
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:79   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XSJ$OPEN
         yes           Std       7 AZB$MTH3D2B
         yes           Std       2 AZB$FLOAT
 yes     yes           Std       2 AZA$FLTTODEC
         yes           Std       2 AZB$FMP
         yes           Std       2 AZB$FDV
 yes     yes           Std       3 XUD$UTS_DIFF
         yes           Std       2 AZB$FAD
         yes           Std       2 AZB$FSB
 yes     yes           Std       1 XSJ$WRITE
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$JIT$                                B$TCB$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:80   


        1        1        /*M* AZA$LOGOFF  External procedure used to perform accounting                */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8        /*F* NAME: AZA$LOGOFF
        9        9             PURPOSE: To perform accounting for CP_6
       10       10             DESCRIPTION: AZA$LOGOFF performs accounting in several forms for
       11       11             CP_6. It performs proprietary accounting, step accounting, budget
       12       12             accounting, job end accounting, and RECOVERY job end accounting.
       13       13
       14       14             The AZA$LOGOFF module is LINKed into the following CP-6 processors:
       15       15                  GHOST1
       16       16                  IBEX
       17       17                  TPCP
       18       18
       19       19             REFERENCE: Specification File Section 17.3, Document 344
       20       20        */
       21       21        AZA$LOGOFF: PROC(LOGOFF_PARAM) ALTRET;

     21  2 000000   000000 700200 xent  AZA$LOGOFF   TSX0  ! X66_AUTO_1
         2 000001   005562 000001                    ZERO    2930,1

       22       22        /***********************************
       23       23         ****       INCLUDES
       24       24         ***********************************/
       25       25        %INCLUDE AR_TBLS_C;
       26      430        %INCLUDE AS_SUPER_C;
       27      865        %INCLUDE AZ_MACRO_C;
       28     3452        %INCLUDE AZ_PERR_C;
       29     3466        %INCLUDE AZ_SUBS_C;
       30     3535 S      %INCLUDE B$JIT_C;
       31     3536        %INCLUDE B_ERRORS_C;
       32     4663        %INCLUDE CP_6;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:81   
       33     4744        %INCLUDE CP_6_SUBS;
       34     5284        %INCLUDE B_MICROPS_C;
       35     5456        %INCLUDE XSJ_MAC_C;
       36     5535        %INCLUDE XSJ_SUBS_C;
       37     5562        %INCLUDE ES_SUBS_E;
       38     5588        %INCLUDE EL_SUBS_C;
       39     5672        %INCLUDE XUD_UTS_M;
       40     5754        %XUD$UTS_ENTRIES;
       41     5786        /***********************************
       42     5787         ****       SUBS
       43     5788         ***********************************/
       44     5789        %SUB F_STARS    = 0/* F_STARS */;
       45     5790        %SUB F_ACCTLG   = 1/* F_ACCTLG */;
       46     5791        %SUB F_RATES    = 2/* F_RATES */;
       47     5792        %SUB F_USERS    = 3/* F_USERS */;
       48     5793        %SUB F_JOBSTATS = 4/* F_JOBSTATS */;
       49     5794        /***********************************
       50     5795         ****       PARAMETERS
       51     5796         ***********************************/
       52     5797        %LOGOFF$PARAM(NAME = LOGOFF_PARAM,STCLASS = );
       53     5838        /***********************************
       54     5839         ****       BASED DATA
       55     5840         ***********************************/
       56     5841        %B$JIT0(STCLASS="BASED(JIT$)");
       57     5930        %U$JIT1;
       58     6004        %M$JIT2;
       59     6014        %F$JIT3;
       60     6019        %S$JIT4;
       61     6025        %J$JIT5;
       62     6113        %A$JIT6;
       63     6123        %B$TCB;
       64     6126        %B$ALT;
       65     6134        %F$DCB;
       66     6191        %ACCT_KEY(NAME = ACCT$KEY,STCLASS="BASED(IN_KEY$)");
       67     6251        %JSP(STCLASS="BASED(REC$)");
       68     6801        %JSP(NAME = JSP1,STCLASS="BASED(REC1$)");
       69     7351        %AZ_LCP6_JSP(NAME=FEPJSP,STCLASS="BASED(REC1$)");
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:82   
       70     7829        %FPT_NODEINFO(STCLASS="BASED(REC$)");
       71     7841        %VLR_NODEINFO(STCLASS=BASED);
       72     7856    1   DCL 1 TEXT$C BASED,
       73     7857    1         2 LEN UBIN BYTE UNAL,
       74     7858    1         2 STRING CHAR(TEXT$C.LEN);
       75     7859        /***********************************
       76     7860         ****       CONSTANT DATA
       77     7861         ***********************************/
       78     7862        %FPT_RESCTL(FPTN    = FPT_RESCTLC,
       79     7863                    RELALL  = YES,
       80     7864                    STCLASS = CONSTANT);
       81     7881        %FPT_ENQ(FPTN = FPT_ENQC,
       82     7882                WAIT  = YES,
       83     7883                WAIT_TIME = -1,
       84     7884                SHARE = NONE,
       85     7885                STCLASS = CONSTANT);
       86     7903        %FPT_DEQ(FPTN = FPT_DEQC,
       87     7904                RELRES  = YES,
       88     7905                CANCEL  = NO,
       89     7906                STCLASS = CONSTANT);
       90     7923        %FPT_TIME(FPTN = FPT_TIMEC,STCLASS = CONSTANT,
       91     7924                  SOURCE = UTS,
       92     7925                  DEST   = EXT);
       93     7944        %FPT_OPEN(FPTN = FPT_OPENC,
       94     7945                SCRUB  = YES,
       95     7946                ASN    = FILE,
       96     7947                EXIST  = OLDFILE,
       97     7948                CTG    = YES,
       98     7949                STCLASS= CONSTANT);
       99     8058        %FPT_PRECORD(FPTN = FPT_PRECORDC,
      100     8059                KEYS      = YES,
      101     8060                KEYR      = NO,
      102     8061                STCLASS   = CONSTANT);
      103     8082        %FPT_READ(FPTN = FPT_READC,
      104     8083                STCLASS= CONSTANT);
      105     8122        %FPT_WRITE(FPTN = FPT_WRITEC,
      106     8123                STCLASS = CONSTANT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:83   
      107     8154        %FPT_DELREC(FPTN = FPT_DELRECC,STCLASS = CONSTANT,
      108     8155                    KEY = LOW_KEY,
      109     8156                    LKEY= HIGH_KEY);
      110     8175        %VLP_NAME(FPTN = LOW_KEY,STCLASS = CONSTANT,
      111     8176                  NAME = 'a');
      112     8203        %VLP_NAME(FPTN = HIGH_KEY,STCLASS = CONSTANT,
      113     8204                  NAME = 'b');
      114     8231        %FPT_CLOSE(FPTN = FPT_CLOSEC,
      115     8232                STCLASS = CONSTANT);
      116     8274        %VLP_NAME(FPTN = SACCUM_KEY,
      117     8275                NAME   = 'AZ_ACCUM',
      118     8276                STCLASS= CONSTANT);
      119     8303        %VLP_NAME(FPTN = STARS_NAME,STCLASS = CONSTANT,
      120     8304                NAME = '*S');
      121     8331        %FPT_WRSYSLOG(FPTN=WR_SECLOG_CONST,
      122     8332                      STCLASS=CONSTANT,
      123     8333                      TYPE=EL_SYS_EXIT,
      124     8334                      FILENUM=EL_SEC);
      125     8349        %FPT_NODEINFO(FPTN = FPT_NODEINFOC,
      126     8350                STCLASS = CONSTANT);
      127     8362        %G$JIT_E;                               /* Get EQUs for Fep RNSTs             */
      128     8424    1   DCL 1 RNSTCVT(0:8) CONSTANT ALIGNED,
      129     8425    1         2 FEP BIT(18) INIT (
      130     8426    1      %CONCAT('0'B,SUBBIT(G_RS_XKEY#,0,8),'0'B,SUBBIT(G_RS_XKEY#,8)),
      131     8427    1      %CONCAT('0'B,SUBBIT(G_RS_DSC#,0,8),'0'B,SUBBIT(G_RS_DSC#,8)),
      132     8428    1      %CONCAT('0'B,SUBBIT(G_RS_OFF#,0,8),'0'B,SUBBIT(G_RS_OFF#,8)),
      133     8429    1      %CONCAT('0'B,SUBBIT(G_RS_LIMX#,0,8),'0'B,SUBBIT(G_RS_LIMX#,8)),
      134     8430    1      %CONCAT('0'B,SUBBIT(G_RS_EKEY#,0,8),'0'B,SUBBIT(G_RS_EKEY#,8)),
      135     8431    1      %CONCAT('0'B,SUBBIT(G_RS_SSP#,0,8),'0'B,SUBBIT(G_RS_SSP#,8)),
      136     8432    1      %CONCAT('0'B,SUBBIT(G_RS_ABRT#,0,8),'0'B,SUBBIT(G_RS_ABRT#,8)),
      137     8433    1      %CONCAT('0'B,SUBBIT(G_RS_XXX#,0,8),'0'B,SUBBIT(G_RS_XXX#,8)),
      138     8434    1      %CONCAT('0'B,SUBBIT(G_RS_ERR#,0,8),'0'B,SUBBIT(G_RS_ERR#,8))),
      139     8435    1         2 HOST BIT(18) INIT (
      140     8436    1      %RS_XKEY#,
      141     8437    1      %RS_DROP#,
      142     8438    1      %RS_OFF#,
      143     8439    1      %RS_LIMX#,
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:84   
      144     8440    1      %RS_EKEY#,
      145     8441    1      %RS_SSP#,
      146     8442    1      %RS_ABRT#,
      147     8443    1      %RS_XXX#,
      148     8444    1      %RS_ERR#);
      149     8445        /***********************************
      150     8446         ****       'GLOBAL' AUTO DATA
      151     8447         ***********************************/
      152     8448    1   DCL REC(0:1023) SBIN;                   /* SPACE FOR CURRENT JSP RECORD       */
      153     8449    1   DCL REC1(0:1023) SBIN;                  /* Space to read *S records into      */
      154     8450    1   DCL REC$ PTR;                           /* PTR TO REC                         */
      155     8451    1   DCL REC1$ PTR;                          /* Pointer to REC1                    */
      156     8452    1   DCL RECLEN SBIN;                        /* Current length in bytes of JSP     */
      157     8453    1   DCL JIT$ PTR;                           /* POINTER TO THE USER'S JIT          */
      158     8454    1   DCL DCB1$ PTR;                          /* PTR TO DCB 1                       */
      159     8455    1   DCL 1 SACCUM,                           /* Used to accumulate proprietary     */
      160     8456    1         2 PCHG(0:32) SBIN,                /* charges for the entire job         */
      161     8457    1         2 SUNIT(0:3) SBIN;
      162     8458    1   DCL PACCUM(0:32) SBIN;                  /* Used to accumulate proprietary     */
      163     8459                                                /* charges for this step              */
      164     8460    1   DCL 1 IN_KEY,
      165     8461    1         2 LEN UBIN BYTE UNAL,
      166     8462    1         2 KEY CHAR(35);
      167     8463    1   DCL IN_KEY$ PTR;                        /* Pointer to IN_KEY                  */
      168     8464    1   DCL LAST_STEP SBIN WORD;
      169     8465    1   DCL TEMP SBIN;                          /* Temporary value                    */
      170     8466    1   DCL PROCNUM UBIN;                  /* To hold proprietary accounting proc num */
      171     8467    1   DCL ASN_SAVE UBIN;                      /* ASN for error reporting            */
      172     8468    1   DCL DCB#_SAVE UBIN;                     /* DCB number for error reporting     */
      173     8469        %FPT_RESCTL(FPTN = FPT_RESCTL,STCLASS = AUTO);
      174     8486        %VLP_PSEUDO(FPTN = VLP_PSEUDO,N=0,STCLASS=AUTO);
      175     8502        %FPT_ENQ(FPTN = FPT_ENQ,STCLASS = AUTO);
      176     8520        %FPT_DEQ(FPTN = FPT_DEQ,STCLASS = AUTO);
      177     8537        %FPT_TIME(FPTN = FPT_TIME,STCLASS = AUTO);
      178     8556        %FPT_OPEN(FPTN = FPT_OPEN,STCLASS = AUTO);
      179     8665        %FPT_PRECORD(FPTN = FPT_PRECORD,STCLASS = AUTO);
      180     8686        %FPT_READ(FPTN = FPT_READ,STCLASS = AUTO);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:85   
      181     8725        %FPT_WRITE(FPTN = FPT_WRITE,STCLASS = AUTO);
      182     8756        %FPT_DELREC(FPTN = FPT_DELREC,STCLASS = AUTO);
      183     8775        %FPT_CLOSE(FPTN = FPT_CLOSE,STCLASS = AUTO);
      184     8817        %FPT_ACCT(FPTN = FPT_ACCT,STCLASS = AUTO);
      185     8833        %VLP_NAME(FPTN = NAME_SAVE,LEN = 31,STCLASS = AUTO);
      186     8860        %VLP_ACCT(FPTN = ACCT_SAVE,STCLASS = AUTO);
      187     8873        %VLP_SN(FPTN = SN_SAVE,N = 1,STCLASS = AUTO);
      188     8886        %ACCT_KEY(NAME = ACCT_KEY_SAVE,STCLASS = AUTO);
      189     8946        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
      190     8947                      STCLASS=AUTO);
      191     8962        /***********************************
      192     8963         ****       SYMREFs
      193     8964         ***********************************/
      194     8965    1   DCL B$JIT$ PTR SYMREF;
      195     8966    1   DCL B$TCB$ PTR SYMREF;
      196     8967        /***********************************
      197     8968         ****       ENTREFs
      198     8969         ***********************************/
      199     8970    1   DCL AZB$FAD ENTRY(2);
      200     8971    1   DCL AZA$FLTTODEC ENTRY(2) ALTRET;
      201     8972    1   DCL AZB$FDV ENTRY(2);
      202     8973    1   DCL AZB$FMP ENTRY(2);
      203     8974    1   DCL AZB$FLOAT ENTRY(2);
      204     8975    1   DCL AZB$MTH3D2B ENTRY(7);
      205     8976    1   DCL AZB$FSB ENTRY(2);
      206     8977    1   DCL XSJ$OPEN ENTRY(1) ALTRET;
      207     8978    1   DCL XSJ$WRITE ENTRY(1) ALTRET;
      208     8979        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:86   
      209     8980        /***********************************
      210     8981         **** Code starts here
      211     8982         ***********************************/
      212     8983    1      CALL INITIALIZE;

   8983  2 000002   001066 701000 2                  TSX1    INITIALIZE
         2 000003   000000 011000                    NOP     0

      213     8984    1      IF LOGOFF_PARAM.CODE=%AZ$STEP

   8984  2 000004   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000005   000000 235100                    LDA     0,,PR0
         2 000006   000004 115007                    CMPA    4,DL
         2 000007   000021 601000 2                  TNZ     s:8990
         2 000010   204007 471500                    LDP1    JIT$,,AUTO
         2 000011   100151 236100                    LDQ     105,,PR1
         2 000012   007000 376003                    ANQ     3584,DU
         2 000013   003000 116003                    CMPQ    1536,DU
         2 000014   000021 601000 2                  TNZ     s:8990
         2 000015   001754 236000 1                  LDQ     XSJ_PARAMC+8
         2 000016   000017 276000 xsym               ORQ     B_VECTNIL+15
         2 000017   100143 376100                    ANQ     99,,PR1
         2 000020   000276 600000 2                  TZE     ALT2

      214     8985    1        AND B$JIT.SSLEV = %AZ_NONE#
      215     8986    1        AND ((B$JIT.CPFLAGS1 & (%CP_STEPACCT# | %CP_STARPROC#))='0'B)
      216     8987    1      THEN GOTO BUDGET;                    /* Budget check only                  */
      217     8988
      218     8989
      219     8990    1      IF LOGOFF_PARAM.CODE~=%AZ$STATUS

   8990  2 000021   000003 115007                    CMPA    3,DL
         2 000022   000206 600000 2                  TZE     BAD_FILL
         2 000023   001754 236000 1                  LDQ     XSJ_PARAMC+8
         2 000024   000017 276000 xsym               ORQ     B_VECTNIL+15
         2 000025   204007 471500                    LDP1    JIT$,,AUTO
         2 000026   100143 376100                    ANQ     99,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:87   
         2 000027   000034 601000 2                  TNZ     s:8995
         2 000030   100151 236100                    LDQ     105,,PR1
         2 000031   007000 376003                    ANQ     3584,DU
         2 000032   003000 116003                    CMPQ    1536,DU
         2 000033   000206 600000 2                  TZE     BAD_FILL

      220     8991    1        AND ((B$JIT.CPFLAGS1 & (%CP_STEPACCT# | %CP_STARPROC#))~='0'B
      221     8992    1        OR B$JIT.SSLEV~=%AZ_NONE#)
      222     8993    2      THEN DO;                             /* Handle all PROC and STEP records   */

      223     8994                                                /* in the *S file                     */
      224     8995    2           CALL OPEN_FILE(F_STARS) ALTRET(ALT1);

   8995  2 000034   000000 236000 3                  LDQ     0
         2 000035   205511 756100                    STQ     FIRST+2,,AUTO
         2 000036   001552 701000 2                  TSX1    OPEN_FILE
         2 000037   000207 702000 2                  TSX2    ALT1

      225     8996    2           ACCT$KEY = '001141'O;           /* LEN=1 and KEY='a'                  */

   8996  2 000040   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 000041   000100 100400                    MLR     fill='000'O
         2 000042   000001 000002 3                  ADSC9   1                        cn=0,n=2
         2 000043   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10

      226     8997    2           FPT_PRECORD.V.N# = 0;

   8997  2 000044   204327 450100                    STZ     FPT_PRECORD+7,,AUTO

      227     8998    2           CALL M$PRECORD(FPT_PRECORD) ALTRET(IGNORE);

   8998  2 000045   204320 630500                    EPPR0   FPT_PRECORD,,AUTO
         2 000046   440003 713400                    CLIMB   alt,+16387
         2 000047   401000 401760                    pmme    nvectors=3
         2 000050   000051 702000 2                  TSX2    IGNORE

      228     8999    2   IGNORE: FPT_READ.V.KEYR# = '1'B;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:88   

   8999  2 000051   100000 236007       IGNORE       LDQ     32768,DL
         2 000052   204342 256100                    ORSQ    FPT_READ+8,,AUTO

      229     9000    2           FPT_READ.V.KEYS# = '0'B;

   9000  2 000053   000002 236000 3                  LDQ     2
         2 000054   204342 356100                    ANSQ    FPT_READ+8,,AUTO

      230     9001    2           FPT_READ.BUF_ = VECTOR(REC1);

   9001  2 000055   000003 235000 3                  LDA     3
         2 000056   205530 452500                    STP2    DCB$+2,,AUTO
         2 000057   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000060   002004 036003                    ADLQ    1028,DU
         2 000061   204336 757100                    STAQ    FPT_READ+4,,AUTO

      231     9002    2           REC1='0'B;

   9002  2 000062   010000 220003                    LDX0    4096,DU
         2 000063   000140 100400                    MLR     fill='000'O
         2 000064   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000065   202004 000010                    ADSC9   REC1,,AUTO               cn=0,n=*X0

      232     9003    2           CALL M$READ(FPT_READ) ALTRET(ALT1);

   9003  2 000066   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 000067   440000 713400                    CLIMB   alt,read
         2 000070   401400 401760                    pmme    nvectors=4
         2 000071   000207 702000 2                  TSX2    ALT1

      233     9004    2           LAST_STEP = 0;                  /* An impossible step number          */

   9004  2 000072   204131 450100                    STZ     LAST_STEP,,AUTO

      234     9005    3           DO WHILE(ACCT$KEY.L>0 AND ACCT$KEY.ACCT#='a'

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:89   
   9005  2 000073   000155 710000 2                  TRA     s:9027

      235     9006    3             AND ACCT$KEY.PROC#~=511);
      236     9007    3                CALL OPEN_FILE(F_STARS) ALTRET(ALT1);

   9007  2 000074   000000 236000 3                  LDQ     0
         2 000075   205511 756100                    STQ     FIRST+2,,AUTO
         2 000076   001552 701000 2                  TSX1    OPEN_FILE
         2 000077   000207 702000 2                  TSX2    ALT1

      237     9008    3                FPT_PRECORD.V.N# = 1;

   9008  2 000100   000001 235007                    LDA     1,DL
         2 000101   204327 755100                    STA     FPT_PRECORD+7,,AUTO

      238     9009    3                CALL M$PRECORD(FPT_PRECORD) ALTRET(IGNORE2);

   9009  2 000102   204320 630500                    EPPR0   FPT_PRECORD,,AUTO
         2 000103   440003 713400                    CLIMB   alt,+16387
         2 000104   401000 401760                    pmme    nvectors=3
         2 000105   000106 702000 2                  TSX2    IGNORE2

      239     9010    3   IGNORE2:     FPT_READ.V.KEYR# = '1'B;

   9010  2 000106   100000 236007       IGNORE2      LDQ     32768,DL
         2 000107   204342 256100                    ORSQ    FPT_READ+8,,AUTO

      240     9011    3                FPT_READ.V.KEYS# = '0'B;

   9011  2 000110   000002 236000 3                  LDQ     2
         2 000111   204342 356100                    ANSQ    FPT_READ+8,,AUTO

      241     9012    3                FPT_READ.BUF_ = VECTOR(REC1);

   9012  2 000112   000003 235000 3                  LDA     3
         2 000113   205530 452500                    STP2    DCB$+2,,AUTO
         2 000114   205530 236100                    LDQ     DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:90   
         2 000115   002004 036003                    ADLQ    1028,DU
         2 000116   204336 757100                    STAQ    FPT_READ+4,,AUTO

      242     9013    3                PROCNUM = ACCT$KEY.PROC#;

   9013  2 000117   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 000120   000100 101500                    MRL     fill='000'O
         2 000121   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         2 000122   204133 000004                    ADSC9   PROCNUM,,AUTO            cn=0,n=4

      243     9014    3                CALL FILL_REC ALTRET(BAD_FILL);

   9014  2 000123   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000124   204503 756100                    STQ     WR_SECLOG+9,,AUTO
         2 000125   006655 701000 2                  TSX1    FILL_REC
         2 000126   000206 702000 2                  TSX2    BAD_FILL

      244     9015                                                /* With the last read record and all  */
      245     9016                                                /* the rest of its STEP and PROC#     */
      246     9017    3                IF JSP.STEP~=LAST_STEP

   9017  2 000127   204004 470500                    LDP0    REC$,,AUTO
         2 000130   000056 236100                    LDQ     46,,PR0
         2 000131   000022 732000                    QRS     18
         2 000132   204131 116100                    CMPQ    LAST_STEP,,AUTO
         2 000133   000140 600000 2                  TZE     s:9022

      247     9018    4                THEN DO;                   /* Must clear out PACCUM              */

      248     9019    4                     PACCUM = '0'B;

   9019  2 000134   000100 100400                    MLR     fill='000'O
         2 000135   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000136   204056 000204                    ADSC9   PACCUM,,AUTO             cn=0,n=132

      249     9020    4                     LAST_STEP = JSP.STEP;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:91   
   9020  2 000137   204131 756100                    STQ     LAST_STEP,,AUTO

      250     9021    4                     END;

      251     9022    3                CALL CHARGE_PRINT;

   9022  2 000140   001737 701000 2                  TSX1    CHARGE_PRINT
         2 000141   000000 011000                    NOP     0

      252     9023    3                IF (B$JIT.CPFLAGS1&(%CP_STEPACCT#|%CP_STARPROC#))~='0'B

   9023  2 000142   001754 236000 1                  LDQ     XSJ_PARAMC+8
         2 000143   000017 276000 xsym               ORQ     B_VECTNIL+15
         2 000144   204007 470500                    LDP0    JIT$,,AUTO
         2 000145   000143 376100                    ANQ     99,,PR0
         2 000146   000151 600000 2                  TZE     s:9025

      253     9024    3                THEN CALL SEND_REC;

   9024  2 000147   001436 701000 2                  TSX1    SEND_REC
         2 000150   000000 011000                    NOP     0

      254     9025    3                ACCT$KEY = ACCT_KEY_SAVE;

   9025  2 000151   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 000152   000100 100500                    MLR     fill='000'O
         2 000153   204466 000012                    ADSC9   ACCT_KEY_SAVE,,AUTO      cn=0,n=10
         2 000154   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10

      255     9026                                                /* To continue via the next PRECORD   */
      256     9027    3                END;

   9027  2 000155   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 000156   000100 101500                    MRL     fill='000'O
         2 000157   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000160   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 000161   205530 236100                    LDQ     DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:92   
         2 000162   000000 116003                    CMPQ    0,DU
         2 000163   000176 600000 2                  TZE     s:9028
         2 000164   040000 106500                    CMPC    fill='040'O
         2 000165   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 000166   000004 000001 3                  ADSC9   4                        cn=0,n=1
         2 000167   000176 601000 2                  TNZ     s:9028
         2 000170   000100 101500                    MRL     fill='000'O
         2 000171   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         2 000172   205531 000004                    ADSC9   DCB$+3,,AUTO             cn=0,n=4
         2 000173   205531 236100                    LDQ     DCB$+3,,AUTO
         2 000174   000777 116007                    CMPQ    511,DL
         2 000175   000074 601000 2                  TNZ     s:9007

      257     9028    2           CALL OPEN_FILE(F_STARS) ALTRET(ALT1);

   9028  2 000176   000000 236000 3                  LDQ     0
         2 000177   205511 756100                    STQ     FIRST+2,,AUTO
         2 000200   001552 701000 2                  TSX1    OPEN_FILE
         2 000201   000207 702000 2                  TSX2    ALT1

      258     9029    2           CALL M$DELREC(FPT_DELREC) ALTRET(ALT1);

   9029  2 000202   204364 630500                    EPPR0   FPT_DELREC,,AUTO
         2 000203   440002 713400                    CLIMB   alt,+16386
         2 000204   401400 401760                    pmme    nvectors=4
         2 000205   000207 702000 2                  TSX2    ALT1

      259     9030                                                /* Delete all proc and step records   */
      260     9031    2           END;

      261     9032    1   BAD_FILL:
      262     9033    2      DO WHILE('0'B);

   9033  2 000206   000221 710000 2     BAD_FILL     TRA     s:9039

      263     9034    2   ALT1:   CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:93   
   9034  2 000207   000001 236000 xsym  ALT1         LDQ     B_VECTNIL+1
         2 000210   205525 756100                    STQ     @DCB#+1,,AUTO
         2 000211   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 000212   000002 036003                    ADLQ    2,DU
         2 000213   205524 756100                    STQ     @ERR+1,,AUTO
         2 000214   000005 236000 3                  LDQ     5
         2 000215   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 000216   011343 701000 2                  TSX1    POST_ERR
         2 000217   000000 011000                    NOP     0

      264     9035    2           RETURN;

   9035  2 000220   000000 702200 xent               TSX2  ! X66_ARET

      265     9036    2           END;

      266     9037
      267     9038        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:94   
      268     9039    1      IF LOGOFF_PARAM.CODE~=%AZ$STEP

   9039  2 000221   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000222   000000 235100                    LDA     0,,PR0
         2 000223   000004 115007                    CMPA    4,DL
         2 000224   000276 600000 2                  TZE     ALT2

      269     9040    2      THEN DO;

      270     9041    2           CALL FILL_REC(LOGOFF_PARAM.CODE) ALTRET(ALT2);

   9041  2 000225   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 000226   204503 756100                    STQ     WR_SECLOG+9,,AUTO
         2 000227   006655 701000 2                  TSX1    FILL_REC
         2 000230   000276 702000 2                  TSX2    ALT2

      271     9042    2           CALL CHARGE_PRINT;

   9042  2 000231   001737 701000 2                  TSX1    CHARGE_PRINT
         2 000232   000000 011000                    NOP     0

      272     9043    2           IF LOGOFF_PARAM.CODE=%AZ$JOBEND OR LOGOFF_PARAM.CODE=%AZ$RECOVERY

   9043  2 000233   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000234   000000 235100                    LDA     0,,PR0
         2 000235   000002 115007                    CMPA    2,DL
         2 000236   000241 600000 2                  TZE     s:9049
         2 000237   000001 115007                    CMPA    1,DL
         2 000240   000270 601000 2                  TNZ     s:9059

      273     9044    3           THEN DO;

      274     9045                     /* The value of ES_LOGSYSEXIT will be checked by the
      275     9046                        WRSYSLOG pmme to see if we really want to log this.
      276     9047                        If not, it just returns. It's too painful to check
      277     9048                        here.                                            */
      278     9049    3                WR_SECLOG=WR_SECLOG_CONST;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:95   

   9049  2 000241   000100 100400                    MLR     fill='000'O
         2 000242   000274 000040 1                  ADSC9   WR_SECLOG_CONST          cn=0,n=32
         2 000243   204472 000040                    ADSC9   WR_SECLOG,,AUTO          cn=0,n=32

      279     9050    3                WR_SECLOG.V_=VECTOR(WR_SECLOG.V);

   9050  2 000244   000006 235000 3                  LDA     6
         2 000245   205530 452500                    STP2    DCB$+2,,AUTO
         2 000246   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000247   004476 036003                    ADLQ    2366,DU
         2 000250   204472 757100                    STAQ    WR_SECLOG,,AUTO

      280     9051    3                WR_SECLOG.ENTRY_=VECTOR(B$JIT);

   9051  2 000251   000007 235000 3                  LDA     7
         2 000252   204007 236100                    LDQ     JIT$,,AUTO
         2 000253   204474 757100                    STAQ    WR_SECLOG+2,,AUTO

      281     9052    3                CALL M$WRSYSLOG(WR_SECLOG);

   9052  2 000254   204472 630500                    EPPR0   WR_SECLOG,,AUTO
         2 000255   070001 713400                    CLIMB   28673
         2 000256   400400 401760                    pmme    nvectors=2

      282     9053    3                CALL UP_USERS;             /* Update the :USERS file with        */

   9053  2 000257   010771 701000 2                  TSX1    UP_USERS
         2 000260   000000 011000                    NOP     0

      283     9054                                                /* total charge information           */
      284     9055    3                IF B$JIT.MODE=%M_BATCH#

   9055  2 000261   204007 470500                    LDP0    JIT$,,AUTO
         2 000262   000000 236100                    LDQ     0,,PR0
         2 000263   740000 376003                    ANQ     -16384,DU
         2 000264   040000 116003                    CMPQ    16384,DU
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:96   
         2 000265   000270 601000 2                  TNZ     s:9059

      285     9056    3                THEN CALL WR_JOBSTATS;

   9056  2 000266   011160 701000 2                  TSX1    WR_JOBSTATS
         2 000267   000000 011000                    NOP     0

      286     9057                                                /* Put out the :JOBSTATS record       */
      287     9058    3                END;

      288     9059    2           IF LOGOFF_PARAM.CODE~=%AZ$STATUS

   9059  2 000270   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000271   000000 235100                    LDA     0,,PR0
         2 000272   000003 115007                    CMPA    3,DL
         2 000273   000276 600000 2                  TZE     ALT2

      289     9060    2           THEN CALL SEND_REC;             /* Send the record through AZI$INST   */

   9060  2 000274   001436 701000 2                  TSX1    SEND_REC
         2 000275   000000 011000                    NOP     0

      290     9061                                                /* and then to :ACCTLG                */
      291     9062    2   ALT2:   END;

   9062  2 000276                       ALT2         null
      292     9063
      293     9064        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:97   
      294     9065    1   BUDGET: IF LOGOFF_PARAM.CODE=%AZ$STEP

   9065  2 000276   200003 470500       BUDGET       LDP0    @LOGOFF_PARAM,,AUTO
         2 000277   000000 235100                    LDA     0,,PR0
         2 000300   000004 115007                    CMPA    4,DL
         2 000301   000335 601000 2                  TNZ     ALT3
         2 000302   204007 471500                    LDP1    JIT$,,AUTO
         2 000303   100147 235100                    LDA     103,,PR1
         2 000304   000335 600000 2                  TZE     ALT3
         2 000305   000001 235100                    LDA     1,,PR0
         2 000306   000002 115007                    CMPA    2,DL
         2 000307   000335 605000 2                  TPL     ALT3

      295     9066    1        AND B$JIT.BUDLIM~=0
      296     9067    1        AND LOGOFF_PARAM.ERR<%AZ$BUDLIM
      297     9068    2      THEN DO;                             /* Perform BUDGET accounting          */

      298     9069    2           CALL FILL_REC(%AZ$BUDGET) ALTRET(ALT3);

   9069  2 000310   000010 236000 3                  LDQ     8
         2 000311   204503 756100                    STQ     WR_SECLOG+9,,AUTO
         2 000312   006655 701000 2                  TSX1    FILL_REC
         2 000313   000335 702000 2                  TSX2    ALT3

      299     9070                                                /* Fill the JSP record as for STATUS  */
      300     9071    2           CALL CHARGE_PRINT;              /* Calculate charges but don't        */

   9071  2 000314   001737 701000 2                  TSX1    CHARGE_PRINT
         2 000315   000000 011000                    NOP     0

      301     9072                                                /* output any statistics              */
      302     9073    2           LOGOFF_PARAM.ACCUM_CHG = JSP.CHG ;

   9073  2 000316   204004 470500                    LDP0    REC$,,AUTO
         2 000317   000065 235100                    LDA     53,,PR0
         2 000320   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 000321   100005 755100                    STA     5,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:98   

      303     9074    2           IF B$JIT.BUDLIM - JSP.CHG < 0

   9074  2 000322   204007 473500                    LDP3    JIT$,,AUTO
         2 000323   300147 236100                    LDQ     103,,PR3
         2 000324   000065 136100                    SBLQ    53,,PR0
         2 000325   000335 605000 2                  TPL     ALT3

      304     9075    2           THEN CALL POST_ERR(%AZ$BUDLIM,,%E$AZ_BUDLIM);

   9075  2 000326   000011 236000 3                  LDQ     9
         2 000327   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000330   205524 757100                    STAQ    @ERR+1,,AUTO
         2 000331   000012 236000 3                  LDQ     10
         2 000332   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 000333   011343 701000 2                  TSX1    POST_ERR
         2 000334   000000 011000                    NOP     0

      305     9076        /*E* ERROR: AZA-E$AZ_BUDLIM
      306     9077             MESSAGE: Your budget has been exceeded
      307     9078        */
      308     9079    2   ALT3:   END;

   9079  2 000335                       ALT3         null
      309     9080        /***********************************
      310     9081         **** Output PGRANS record if necessary
      311     9082         ***********************************/
      312     9083    1      IF (LOGOFF_PARAM.CODE=%AZ$JOBEND OR LOGOFF_PARAM.CODE=%AZ$RECOVERY)

   9083  2 000335   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000336   000000 235100                    LDA     0,,PR0
         2 000337   000002 115007                    CMPA    2,DL
         2 000340   000343 600000 2                  TZE     ALT3+6
         2 000341   000001 115007                    CMPA    1,DL
         2 000342   000352 601000 2                  TNZ     s:9089
         2 000343   204007 471500                    LDP1    JIT$,,AUTO
         2 000344   000000 106500                    CMPC    fill='000'O
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:99   
         2 000345   100243 000014                    ADSC9   163,,PR1                 cn=0,n=12
         2 000346   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         2 000347   000352 600000 2                  TZE     s:9089

      313     9084    1        AND B$JIT.GAC~='0'B
      314     9085    1      THEN CALL OUT_PGRANS;

   9085  2 000350   011261 701000 2                  TSX1    OUT_PGRANS
         2 000351   000000 011000                    NOP     0

      315     9086        /***********************************
      316     9087         **** Write out SACCUM record
      317     9088         ***********************************/
      318     9089    1      IF LOGOFF_PARAM.CODE=%AZ$STEP AND SACCUM~='0'B

   9089  2 000352   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000353   000000 235100                    LDA     0,,PR0
         2 000354   000004 115007                    CMPA    4,DL
         2 000355   000404 601000 2                  TNZ     s:9097
         2 000356   000000 106500                    CMPC    fill='000'O
         2 000357   204011 000224                    ADSC9   SACCUM,,AUTO             cn=0,n=148
         2 000360   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         2 000361   000404 600000 2                  TZE     s:9097

      319     9090    2      THEN DO;

      320     9091    2           CALL OPEN_FILE(F_STARS) ALTRET(ALTL);

   9091  2 000362   000000 236000 3                  LDQ     0
         2 000363   205511 756100                    STQ     FIRST+2,,AUTO
         2 000364   001552 701000 2                  TSX1    OPEN_FILE
         2 000365   000405 702000 2                  TSX2    ALTL

      321     9092    2           FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;

   9092  2 000366   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000367   000002 220100                    LDX0    2,,PR0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:100  
         2 000370   204360 740100                    STX0    FPT_WRITE+8,,AUTO

      322     9093    2           FPT_WRITE.BUF_ = VECTOR(SACCUM);

   9093  2 000371   000013 235000 3                  LDA     11
         2 000372   205530 452500                    STP2    DCB$+2,,AUTO
         2 000373   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000374   004011 036003                    ADLQ    2057,DU
         2 000375   204354 757100                    STAQ    FPT_WRITE+4,,AUTO

      323     9094    2           FPT_WRITE.KEY_ = VECTOR(SACCUM_KEY);

   9094  2 000376   000014 237000 3                  LDAQ    12
         2 000377   204352 757100                    STAQ    FPT_WRITE+2,,AUTO

      324     9095    2           CALL M$WRITE(FPT_WRITE) ALTRET(ALTL);

   9095  2 000400   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 000401   440001 713400                    CLIMB   alt,write
         2 000402   401400 401760                    pmme    nvectors=4
         2 000403   000405 702000 2                  TSX2    ALTL

      325     9096    2           END;

      326     9097    2      DO WHILE('0'B);

   9097  2 000404   000416 710000 2                  TRA     s:9103

      327     9098    2   ALTL:   CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

   9098  2 000405   000001 236000 xsym  ALTL         LDQ     B_VECTNIL+1
         2 000406   205525 756100                    STQ     @DCB#+1,,AUTO
         2 000407   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 000410   000002 036003                    ADLQ    2,DU
         2 000411   205524 756100                    STQ     @ERR+1,,AUTO
         2 000412   000005 236000 3                  LDQ     5
         2 000413   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:101  
         2 000414   011343 701000 2                  TSX1    POST_ERR
         2 000415   000000 011000                    NOP     0

      328     9099    2           END;

      329     9100        /***********************************
      330     9101         **** Miscellaneous
      331     9102         ***********************************/
      332     9103    1      IF LOGOFF_PARAM.CODE~=%AZ$STATUS

   9103  2 000416   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000417   000000 235100                    LDA     0,,PR0
         2 000420   000003 115007                    CMPA    3,DL
         2 000421   000427 600000 2                  TZE     s:9108

      333     9104    1      THEN B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 & ~%CP_STARPROC#;

   9104  2 000422   000017 236000 xsym               LDQ     B_VECTNIL+15
         2 000423   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 000424   204007 471500                    LDP1    JIT$,,AUTO
         2 000425   100143 376100                    ANQ     99,,PR1
         2 000426   100143 756100                    STQ     99,,PR1

      334     9105        /***********************************
      335     9106         **** Return or altreturn with correct error in LOGOFF_PARAM.ERR
      336     9107         ***********************************/
      337     9108    1      IF DCB1$->F$DCB.FCD#

   9108  2 000427   204010 471500                    LDP1    DCB1$,,AUTO
         2 000430   100031 236100                    LDQ     25,,PR1
         2 000431   020000 316007                    CANQ    8192,DL
         2 000432   000437 600000 2                  TZE     s:9111

      338     9109    1      THEN CALL M$CLOSE(FPT_CLOSE) ALTRET(CLS_ALT);

   9109  2 000433   204376 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 000434   450001 713400                    CLIMB   alt,close
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:102  
         2 000435   406000 401760                    pmme    nvectors=13
         2 000436   000440 702000 2                  TSX2    CLS_ALT

      339     9110                                                /* Clean up any open file             */
      340     9111    2      DO WHILE('0'B);

   9111  2 000437   000451 710000 2                  TRA     s:9114

      341     9112    2   CLS_ALT: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

   9112  2 000440   000001 236000 xsym  CLS_ALT      LDQ     B_VECTNIL+1
         2 000441   205525 756100                    STQ     @DCB#+1,,AUTO
         2 000442   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 000443   000002 036003                    ADLQ    2,DU
         2 000444   205524 756100                    STQ     @ERR+1,,AUTO
         2 000445   000005 236000 3                  LDQ     5
         2 000446   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 000447   011343 701000 2                  TSX1    POST_ERR
         2 000450   000000 011000                    NOP     0

      342     9113    2           END;

      343     9114    1      IF LOGOFF_PARAM.CODE=%AZ$RECOVERY

   9114  2 000451   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000452   000000 235100                    LDA     0,,PR0
         2 000453   000001 115007                    CMPA    1,DL
         2 000454   000477 601000 2                  TNZ     IG1

      344     9115    2      THEN DO;

      345     9116    2           FPT_OPEN = FPT_OPENC;

   9116  2 000455   000100 100400                    MLR     fill='000'O
         2 000456   000060 000350 1                  ADSC9   FPT_OPENC                cn=0,n=232
         2 000457   204226 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:103  
      346     9117    2           FPT_OPEN.V_ = VECTOR(FPT_OPEN.V);

   9117  2 000460   000016 235000 3                  LDA     14
         2 000461   205530 452500                    STP2    DCB$+2,,AUTO
         2 000462   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000463   004272 036003                    ADLQ    2234,DU
         2 000464   204226 757100                    STAQ    FPT_OPEN,,AUTO

      347     9118    2           FPT_OPEN.V.DCB# = LOGOFF_PARAM.DCB1;

   9118  2 000465   000002 220100                    LDX0    2,,PR0
         2 000466   204272 740100                    STX0    FPT_OPEN+36,,AUTO

      348     9119    2           FPT_OPEN.NAME_ = VECTOR(STARS_NAME);

   9119  2 000467   000020 237000 3                  LDAQ    16
         2 000470   204234 757100                    STAQ    FPT_OPEN+6,,AUTO

      349     9120    2           FPT_OPEN.V.DELETE# = %YES#;

   9120  2 000471   040000 236007                    LDQ     16384,DL
         2 000472   204272 256100                    ORSQ    FPT_OPEN+36,,AUTO

      350     9121    2           CALL M$OPEN(FPT_OPEN) ALTRET(IG1); /* Delete the *S file              */

   9121  2 000473   204226 630500                    EPPR0   FPT_OPEN,,AUTO
         2 000474   450000 713400                    CLIMB   alt,open
         2 000475   410400 401760                    pmme    nvectors=18
         2 000476   000477 702000 2                  TSX2    IG1

      351     9122    2   IG1:    END;

   9122  2 000477                       IG1          null
      352     9123    1      IF LOGOFF_PARAM.ERR=0

   9123  2 000477   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 000500   000001 235100                    LDA     1,,PR0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:104  
         2 000501   000503 601000 2                  TNZ     s:9125

      353     9124    1      THEN RETURN;

   9124  2 000502   000000 702200 xent               TSX2  ! X66_ARET

      354     9125    1      ELSE IF DCB#_SAVE~=0

   9125  2 000503   204135 236100                    LDQ     DCB#_SAVE,,AUTO
         2 000504   000576 600000 2                  TZE     s:9146

      355     9126    2           THEN DO;                        /* Restore error info to errored DCB  */

      356     9127    2                B$JIT.USRDCB = DCB#_SAVE;

   9127  2 000505   204007 471500                    LDP1    JIT$,,AUTO
         2 000506   100153 552104                    STBQ    107,'04'O,PR1

      357     9128    2                IF DCBADDR(DCB#_SAVE) -> F$DCB.FCD#

   9128  2 000507   000017 473400 3                  LDP3    15
         2 000510   300000 474500                    LDP4    0,,PR3
         2 000511   400000 475506                    LDP5    0,QL,PR4
         2 000512   500031 236100                    LDQ     25,,PR5
         2 000513   020000 316007                    CANQ    8192,DL
         2 000514   000523 600000 2                  TZE     s:9133

      358     9129    3                THEN DO;

      359     9130    3                     FPT_CLOSE.V.DCB# = DCB#_SAVE;

   9130  2 000515   204135 720100                    LXL0    DCB#_SAVE,,AUTO
         2 000516   204430 740100                    STX0    FPT_CLOSE+26,,AUTO

      360     9131    3                     CALL M$CLOSE(FPT_CLOSE) ALTRET(SET_ALT);

   9131  2 000517   204376 630500                    EPPR0   FPT_CLOSE,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:105  
         2 000520   450001 713400                    CLIMB   alt,close
         2 000521   406000 401760                    pmme    nvectors=13
         2 000522   000565 702000 2                  TSX2    SET_ALT

      361     9132    3                     END;

      362     9133    2                FPT_OPEN = FPT_OPENC;

   9133  2 000523   000100 100400                    MLR     fill='000'O
         2 000524   000060 000350 1                  ADSC9   FPT_OPENC                cn=0,n=232
         2 000525   204226 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

      363     9134    2                FPT_OPEN.V_ = VECTOR(FPT_OPEN.V);

   9134  2 000526   000016 235000 3                  LDA     14
         2 000527   205530 452500                    STP2    DCB$+2,,AUTO
         2 000530   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000531   004272 036003                    ADLQ    2234,DU
         2 000532   204226 757100                    STAQ    FPT_OPEN,,AUTO

      364     9135    2                FPT_OPEN.V.DCB# = DCB#_SAVE;

   9135  2 000533   204135 720100                    LXL0    DCB#_SAVE,,AUTO
         2 000534   204272 740100                    STX0    FPT_OPEN+36,,AUTO

      365     9136    2                FPT_OPEN.V.SETDCB# = %YES#;

   9136  2 000535   100000 236007                    LDQ     32768,DL
         2 000536   204272 256100                    ORSQ    FPT_OPEN+36,,AUTO

      366     9137    2                FPT_OPEN.NAME_ = VECTOR(NAME_SAVE);

   9137  2 000537   000022 235000 3                  LDA     18
         2 000540   205530 452500                    STP2    DCB$+2,,AUTO
         2 000541   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000542   004450 036003                    ADLQ    2344,DU
         2 000543   204234 757100                    STAQ    FPT_OPEN+6,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:106  

      367     9138    2                FPT_OPEN.ACCT_ = VECTOR(ACCT_SAVE);

   9138  2 000544   000023 235000 3                  LDA     19
         2 000545   205530 452500                    STP2    DCB$+2,,AUTO
         2 000546   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000547   004460 036003                    ADLQ    2352,DU
         2 000550   204252 757100                    STAQ    FPT_OPEN+20,,AUTO

      368     9139    2                FPT_OPEN.SN_ = VECTOR(SN_SAVE);

   9139  2 000551   000006 235000 3                  LDA     6
         2 000552   205530 452500                    STP2    DCB$+2,,AUTO
         2 000553   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000554   004462 036003                    ADLQ    2354,DU
         2 000555   204230 757100                    STAQ    FPT_OPEN+2,,AUTO

      369     9140    2                FPT_OPEN.V.ASN# = ASN_SAVE;

   9140  2 000556   204134 236100                    LDQ     ASN_SAVE,,AUTO
         2 000557   204273 552104                    STBQ    FPT_OPEN+37,'04'O,AUTO

      370     9141    2                CALL M$OPEN(FPT_OPEN) ALTRET(SET_ALT);

   9141  2 000560   204226 630500                    EPPR0   FPT_OPEN,,AUTO
         2 000561   450000 713400                    CLIMB   alt,open
         2 000562   410400 401760                    pmme    nvectors=18
         2 000563   000565 702000 2                  TSX2    SET_ALT

      371     9142    3                DO WHILE('0'B);

   9142  2 000564   000576 710000 2                  TRA     s:9146

      372     9143    3   SET_ALT:          CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

   9143  2 000565   000001 236000 xsym  SET_ALT      LDQ     B_VECTNIL+1
         2 000566   205525 756100                    STQ     @DCB#+1,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:107  
         2 000567   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 000570   000002 036003                    ADLQ    2,DU
         2 000571   205524 756100                    STQ     @ERR+1,,AUTO
         2 000572   000005 236000 3                  LDQ     5
         2 000573   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 000574   011343 701000 2                  TSX1    POST_ERR
         2 000575   000000 011000                    NOP     0

      373     9144    3                     END;

      374     9145    2                END;

      375     9146    1      ALTRETURN;

   9146  2 000576   000000 702200 xent               TSX2  ! X66_AALT

      376     9147        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:108  
      377     9148        /*P* NAME: AZA$FEPACCTNG
      378     9149             PURPOSE: To perform accounting for LCP6
      379     9150             DESCRIPTION: LOGOFF_PARAM contains a pointer to an LCP6 JSP record,
      380     9151             which is converted to Host JSP form and accounted in the usual way.
      381     9152             :USERS is then updated with the charges.
      382     9153        */
      383     9154
      384     9155    1   AZA$FEPACCTNG: ENTRY (LOGOFF_PARAM) ALTRET;

   9155  2 000577   000000 700200 xent  AZA$FEPACCT* TSX0  ! X66_AUTO_1
         2 000600   005562 000001                    ZERO    2930,1

      385     9156
      386     9157    1      JIT$ = ADDR(REC1);

   9157  2 000601   202004 630500                    EPPR0   REC1,,AUTO
         2 000602   204007 450500                    STP0    JIT$,,AUTO

      387     9158    1      REC1 = '0'B;

   9158  2 000603   010000 220003                    LDX0    4096,DU
         2 000604   000140 100400                    MLR     fill='000'O
         2 000605   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000606   202004 000010                    ADSC9   REC1,,AUTO               cn=0,n=*X0

      388     9159    1      REC1$ = LOGOFF_PARAM.JIT$;

   9159  2 000607   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 000610   100004 236100                    LDQ     4,,PR1
         2 000611   204005 756100                    STQ     REC1$,,AUTO

      389     9160    1      B$JIT.BILL = FEPJSP.BILL;

   9160  2 000612   204005 473500                    LDP3    REC1$,,AUTO
         2 000613   040100 100500                    MLR     fill='040'O
         2 000614   300052 400006                    ADSC9   42,,PR3                  cn=2,n=6
         2 000615   000151 400006                    ADSC9   105,,PR0                 cn=2,n=6
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:109  

      390     9161    1      REC$ = ADDR(REC);

   9161  2 000616   200004 634500                    EPPR4   REC,,AUTO
         2 000617   204004 454500                    STP4    REC$,,AUTO

      391     9162    1      FPT_NODEINFO = FPT_NODEINFOC;

   9162  2 000620   000100 100400                    MLR     fill='000'O
         2 000621   000304 000040 1                  ADSC9   FPT_NODEINFOC            cn=0,n=32
         2 000622   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32

      392     9163    1      VBASE(FPT_NODEINFO.V_) = ADDR(FPT_NODEINFO.V);

   9163  2 000623   204004 236100                    LDQ     REC$,,AUTO
         2 000624   000004 036003                    ADLQ    4,DU
         2 000625   400001 756100                    STQ     1,,PR4

      393     9164    1      FPT_NODEINFO.V.NODENUM# = FEPJSP.FEP#;

   9164  2 000626   300032 236100                    LDQ     26,,PR3
         2 000627   000033 736000                    QLS     27
         2 000630   400006 552140                    STBQ    6,'40'O,PR4

      394     9165    1      FPT_NODEINFO.NODEINFO_ = VECTOR(ADDR(REC(SIZEW(JSP)))->VLR_NODEINFO);

   9165  2 000631   000024 235000 3                  LDA     20
         2 000632   205530 452500                    STP2    DCB$+2,,AUTO
         2 000633   205530 236100                    LDQ     DCB$+2,,AUTO
         2 000634   000145 036003                    ADLQ    101,DU
         2 000635   400002 757100                    STAQ    2,,PR4

      395     9166    2      CALL M$NODEINFO (FPT_NODEINFO) WHENRETURN DO;

   9166  2 000636   400000 630500                    EPPR0   0,,PR4
         2 000637   560031 713400                    CLIMB   alt,+57369
         2 000640   400400 401760                    pmme    nvectors=2
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:110  
         2 000641   000642 702000 2                  TSX2    s:9168

      396     9167    2           END;

      397     9168    1      JSP = '0'B;

   9168  2 000642   204004 470500                    LDP0    REC$,,AUTO
         2 000643   000100 100400                    MLR     fill='000'O
         2 000644   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000645   000000 000604                    ADSC9   0,,PR0                   cn=0,n=388

      398     9169    1      JSP.WOO = ADDR(REC(SIZEW(JSP)))->VLR_NODEINFO.NODENAME#;

   9169  2 000646   040100 100500                    MLR     fill='040'O
         2 000647   200145 000010                    ADSC9   REC+97,,AUTO             cn=0,n=8
         2 000650   000016 000010                    ADSC9   14,,PR0                  cn=0,n=8

      399     9170    1      JSP.ACCN = FEPJSP.ACCN;

   9170  2 000651   204005 471500                    LDP1    REC1$,,AUTO
         2 000652   040100 100500                    MLR     fill='040'O
         2 000653   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         2 000654   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

      400     9171    1      JSP.UNAME = FEPJSP.UNAME;

   9171  2 000655   040100 100500                    MLR     fill='040'O
         2 000656   100004 000014                    ADSC9   4,,PR1                   cn=0,n=12
         2 000657   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12

      401     9172    1      JSP.PROCNAME = FEPJSP.PROCNAME;

   9172  2 000660   000100 100500                    MLR     fill='000'O
         2 000661   100007 000040                    ADSC9   7,,PR1                   cn=0,n=32
         2 000662   000037 000040                    ADSC9   31,,PR0                  cn=0,n=32

      402     9173    1      JSP.TYPE = FEPJSP.TYPE;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:111  

   9173  2 000663   100000 236100                    LDQ     0,,PR1
         2 000664   000036 552120                    STBQ    30,'20'O,PR0

      403     9174    1      JSP.SYSID = FEPJSP.SYSID;

   9174  2 000665   100001 720100                    LXL0    1,,PR1
         2 000666   000036 440100                    SXL0    30,,PR0

      404     9175    1      JSP.START = FEPJSP.START;

   9175  2 000667   100017 235100                    LDA     15,,PR1
         2 000670   000031 755100                    STA     25,,PR0

      405     9176    1      JSP.STEP = FEPJSP.STEP;

   9176  2 000671   100054 236100                    LDQ     44,,PR1
         2 000672   000024 772000                    QRL     20
         2 000673   000000 621006                    EAX1    0,QL
         2 000674   000056 741100                    STX1    46,,PR0

      406     9177    1      JSP.MODE = FEPJSP.MODE+4;

   9177  2 000675   100001 236100                    LDQ     1,,PR1
         2 000676   000033 772000                    QRL     27
         2 000677   000004 036007                    ADLQ    4,DL
         2 000700   000033 736000                    QLS     27
         2 000701   000036 552140                    STBQ    30,'40'O,PR0

      407     9178    1      JSP.STEPCC = FEPJSP.STEPCC;

   9178  2 000702   100036 236100                    LDQ     30,,PR1
         2 000703   000022 736000                    QLS     18
         2 000704   000057 552140                    STBQ    47,'40'O,PR0

      408     9179    1      IF FEPJSP.TYPE=%AZ$PROC OR FEPJSP.TYPE=%AZ$STEP

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:112  
   9179  2 000705   100000 236100                    LDQ     0,,PR1
         2 000706   000777 376003                    ANQ     511,DU
         2 000707   000005 116003                    CMPQ    5,DU
         2 000710   000713 600000 2                  TZE     s:9180
         2 000711   000004 116003                    CMPQ    4,DU
         2 000712   000717 601000 2                  TNZ     s:9181

      409     9180    1      THEN JSP.JSUNITS = FEPJSP.STEPUNIT;

   9180  2 000713   000100 100500                    MLR     fill='000'O
         2 000714   100033 000010                    ADSC9   27,,PR1                  cn=0,n=8
         2 000715   000115 000010                    ADSC9   77,,PR0                  cn=0,n=8
         2 000716   000722 710000 2                  TRA     s:9182

      410     9181    1      ELSE JSP.JSUNITS = FEPJSP.JSUNIT;

   9181  2 000717   000100 100500                    MLR     fill='000'O
         2 000720   100033 000010                    ADSC9   27,,PR1                  cn=0,n=8
         2 000721   000115 000010                    ADSC9   77,,PR0                  cn=0,n=8

      411     9182    1      JSP.SUBMIT = FEPJSP.START;

   9182  2 000722   100017 235100                    LDA     15,,PR1
         2 000723   000030 755100                    STA     24,,PR0

      412     9183    1      JSP.CUR_UTS = FEPJSP.STOP;

   9183  2 000724   100020 235100                    LDA     16,,PR1
         2 000725   000034 755100                    STA     28,,PR0

      413     9184    1      JSP.CONNECT = FEPJSP.STOP-FEPJSP.START;

   9184  2 000726   100020 236100                    LDQ     16,,PR1
         2 000727   100017 136100                    SBLQ    15,,PR1
         2 000730   000100 756100                    STQ     64,,PR0

      414     9185    1      JSP.ELAPSED = JSP.CONNECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:113  

   9185  2 000731   000032 756100                    STQ     26,,PR0

      415     9186    1      JSP.ATITLE = ' ';

   9186  2 000732   040100 100400                    MLR     fill='040'O
         2 000733   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000734   000020 000040                    ADSC9   16,,PR0                  cn=0,n=32

      416     9187    1      JSP.UEXEC = FEPJSP.TUEXT;

   9187  2 000735   100021 235100                    LDA     17,,PR1
         2 000736   000112 755100                    STA     74,,PR0

      417     9188    1      JSP.USTIME = FEPJSP.TUSVT;

   9188  2 000737   100022 235100                    LDA     18,,PR1
         2 000740   000114 755100                    STA     76,,PR0

      418     9189    1      JSP.UMEMTIM = FEPJSP.UMEMTIM;

   9189  2 000741   100023 235100                    LDA     19,,PR1
         2 000742   000071 755100                    STA     57,,PR0

      419     9190    1      JSP.PEXEC = FEPJSP.PROC_EXTIME;

   9190  2 000743   100024 235100                    LDA     20,,PR1
         2 000744   000111 755100                    STA     73,,PR0

      420     9191    1      JSP.PSTIME = FEPJSP.PROC_SVTIME;

   9191  2 000745   100025 235100                    LDA     21,,PR1
         2 000746   000113 755100                    STA     75,,PR0

      421     9192    1      JSP.PMEMTIM = FEPJSP.PROC_MEMTIME;

   9192  2 000747   100026 235100                    LDA     22,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:114  
         2 000750   000070 755100                    STA     56,,PR0

      422     9193    1      JSP.PMMES = FEPJSP.MCLS;

   9193  2 000751   100032 236100                    LDQ     26,,PR1
         2 000752   000022 772000                    QRL     18
         2 000753   000110 756100                    STQ     72,,PR0

      423     9194    1      JSP.PKCO = FEPJSP.PEAK_MEM;

   9194  2 000754   100031 220100                    LDX0    25,,PR1
         2 000755   000055 440100                    SXL0    45,,PR0

      424     9195    1      JSP.RESPEAK = FEPJSP.PEAK_MEM;

   9195  2 000756   100031 222100                    LDX2    25,,PR1
         2 000757   000055 742100                    STX2    45,,PR0

      425     9196    1      JSP.TINTER = FEPJSP.READS_UC + FEPJSP.WRITES_UC;

   9196  2 000760   100041 236100                    LDQ     33,,PR1
         2 000761   100042 036100                    ADLQ    34,,PR1
         2 000762   000107 756100                    STQ     71,,PR0

      426     9197    1      JSP.UFTPS = BINBIT(FEPJSP.PEAK_LVLS,16);

   9197  2 000763   100031 236100                    LDQ     25,,PR1
         2 000764   777777 376007                    ANQ     -1,DL
         2 000765   000024 736000                    QLS     20
         2 000766   000067 756100                    STQ     55,,PR0

      427     9198    1      JSP.XLIMFLG = FEPJSP.XLIMFLG;

   9198  2 000767   100036 236100                    LDQ     30,,PR1
         2 000770   000011 736000                    QLS     9
         2 000771   000057 552110                    STBQ    47,'10'O,PR0

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:115  
      428     9199    1      JSP.ORACCESS = FEPJSP.READS_HOST + FEPJSP.WRITES_HOST;

   9199  2 000772   100037 236100                    LDQ     31,,PR1
         2 000773   100040 036100                    ADLQ    32,,PR1
         2 000774   000103 756100                    STQ     67,,PR0

      429     9200    2      DO TEMP = 0 TO 8;

   9200  2 000775   204132 450100                    STZ     TEMP,,AUTO

      430     9201    2           IF FEPJSP.FRS&RNSTCVT.FEP(TEMP)

   9201  2 000776   204005 470500                    LDP0    REC1$,,AUTO
         2 000777   000036 220100                    LDX0    30,,PR0
         2 001000   204132 721100                    LXL1    TEMP,,AUTO
         2 001001   000314 360011 1                  ANX0    RNSTCVT,X1
         2 001002   001015 600000 2                  TZE     s:9203

      431     9202    2           THEN JSP.RNST = JSP.RNST|RNSTCVT.HOST(TEMP);

   9202  2 001003   000314 236011 1                  LDQ     RNSTCVT,X1
         2 001004   000022 736000                    QLS     18
         2 001005   205530 756100                    STQ     DCB$+2,,AUTO
         2 001006   204004 471500                    LDP1    REC$,,AUTO
         2 001007   100057 236100                    LDQ     47,,PR1
         2 001010   000011 736000                    QLS     9
         2 001011   777000 376003                    ANQ     -512,DU
         2 001012   205530 276100                    ORQ     DCB$+2,,AUTO
         2 001013   000011 772000                    QRL     9
         2 001014   100057 552120                    STBQ    47,'20'O,PR1

      432     9203    2           END;

   9203  2 001015   204132 054100                    AOS     TEMP,,AUTO
         2 001016   204132 235100                    LDA     TEMP,,AUTO
         2 001017   000010 115007                    CMPA    8,DL
         2 001020   000776 604400 2                  TMOZ    s:9201
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:116  

      433     9204    1      TEMP = %AZ_NONE#;

   9204  2 001021   000003 236007                    LDQ     3,DL
         2 001022   204132 756100                    STQ     TEMP,,AUTO

      434     9205    1      IF LOGOFF_PARAM.DCB_LL~=0 THEN TEMP = %AZ_ALL#;

   9205  2 001023   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 001024   100002 720100                    LXL0    2,,PR1
         2 001025   001030 600000 2                  TZE     s:9206

   9205  2 001026   000001 235007                    LDA     1,DL
         2 001027   204132 755100                    STA     TEMP,,AUTO

      435     9206    1      B$JIT.SSLEV = TEMP;

   9206  2 001030   204007 473500                    LDP3    JIT$,,AUTO
         2 001031   204132 236100                    LDQ     TEMP,,AUTO
         2 001032   000033 736000                    QLS     27
         2 001033   300151 676100                    ERQ     105,,PR3
         2 001034   007000 376003                    ANQ     3584,DU
         2 001035   300151 656100                    ERSQ    105,,PR3

      436     9207    1      B$JIT.JSLEV = TEMP;

   9207  2 001036   204132 236100                    LDQ     TEMP,,AUTO
         2 001037   000041 736000                    QLS     33
         2 001040   300151 676100                    ERQ     105,,PR3
         2 001041   700000 376003                    ANQ     -32768,DU
         2 001042   300151 656100                    ERSQ    105,,PR3

      437     9208    1      B$JIT.PSLEV = TEMP;

   9208  2 001043   204132 236100                    LDQ     TEMP,,AUTO
         2 001044   000036 736000                    QLS     30
         2 001045   300151 676100                    ERQ     105,,PR3
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:117  
         2 001046   070000 376003                    ANQ     28672,DU
         2 001047   300151 656100                    ERSQ    105,,PR3

      438     9209    1      PACCUM = '0'B;

   9209  2 001050   000100 100400                    MLR     fill='000'O
         2 001051   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001052   204056 000204                    ADSC9   PACCUM,,AUTO             cn=0,n=132

      439     9210    1      CALL INITIALIZE_FEP;

   9210  2 001053   001152 701000 2                  TSX1    INITIALIZE_FEP
         2 001054   000000 011000                    NOP     0

      440     9211    1      CALL CHARGE_PRINT;

   9211  2 001055   001737 701000 2                  TSX1    CHARGE_PRINT
         2 001056   000000 011000                    NOP     0

      441     9212    1      CALL UP_USERS;

   9212  2 001057   010771 701000 2                  TSX1    UP_USERS
         2 001060   000000 011000                    NOP     0

      442     9213    1      LOGOFF_PARAM.ACCUM_CHG = JSP.CHG;

   9213  2 001061   204004 470500                    LDP0    REC$,,AUTO
         2 001062   000065 235100                    LDA     53,,PR0
         2 001063   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 001064   100005 755100                    STA     5,,PR1

      443     9214    1      RETURN;

   9214  2 001065   000000 702200 xent               TSX2  ! X66_ARET

      444     9215        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:118  
      445     9216    1   INITIALIZE: PROC;

   9216  2 001066   204502 741300       INITIALIZE   STX1  ! WR_SECLOG+8,,AUTO

      446     9217        /*I* NAME: INITIALIZE
      447     9218             PURPOSE: To perform initialization for LOGOFF
      448     9219        */
      449     9220    2      IF LOGOFF_PARAM.CODE=%AZ$RECOVERY

   9220  2 001067   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 001070   000000 235100                    LDA     0,,PR0
         2 001071   000001 115007                    CMPA    1,DL
         2 001072   001076 601000 2                  TNZ     s:9222

      450     9221    2      THEN JIT$ = LOGOFF_PARAM.JIT$;

   9221  2 001073   000004 236100                    LDQ     4,,PR0
         2 001074   204007 756100                    STQ     JIT$,,AUTO
         2 001075   001100 710000 2                  TRA     s:9223

      451     9222    2      ELSE JIT$ = B$JIT$;

   9222  2 001076   000000 236000 xsym               LDQ     B$JIT$
         2 001077   204007 756100                    STQ     JIT$,,AUTO

      452     9223    2      IF LOGOFF_PARAM.CODE=%AZ$JOBEND

   9223  2 001100   000002 115007                    CMPA    2,DL
         2 001101   001151 601000 2                  TNZ     s:9237

      453     9224    3      THEN DO;

      454     9225    3           B$JIT.REMLO = 1;

   9225  2 001102   000001 235007                    LDA     1,DL
         2 001103   204007 471500                    LDP1    JIT$,,AUTO
         2 001104   100361 755100                    STA     241,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:119  

      455     9226    3           FPT_RESCTL = FPT_RESCTLC;

   9226  2 001105   000100 100400                    MLR     fill='000'O
         2 001106   000000 000110 1                  ADSC9   FPT_RESCTLC              cn=0,n=72
         2 001107   204136 000110                    ADSC9   FPT_RESCTL,,AUTO         cn=0,n=72

      456     9227    3           FPT_RESCTL.V_ = VECTOR(FPT_RESCTL.V);

   9227  2 001110   000024 235000 3                  LDA     20
         2 001111   205530 452500                    STP2    DCB$+2,,AUTO
         2 001112   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001113   004152 036003                    ADLQ    2154,DU
         2 001114   204136 757100                    STAQ    FPT_RESCTL,,AUTO

      457     9228    3           FPT_RESCTL.V.RELALL# = %YES#;

   9228  2 001115   400000 236003                    LDQ     -131072,DU
         2 001116   204153 256100                    ORSQ    FPT_RESCTL+13,,AUTO

      458     9229    3           VLP_PSEUDO = '0'B;

   9229  2 001117   000100 100400                    MLR     fill='000'O
         2 001120   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001121   204160 000034                    ADSC9   VLP_PSEUDO,,AUTO         cn=0,n=28

      459     9230    3           VLP_PSEUDO.MEMORY# = B$JIT.RESCORE;

   9230  2 001122   100336 720100                    LXL0    222,,PR1
         2 001123   204162 740100                    STX0    VLP_PSEUDO+2,,AUTO

      460     9231    3           CALL M$RELRES(FPT_RESCTL) ALTRET(OK_ALT);

   9231  2 001124   204136 630500                    EPPR0   FPT_RESCTL,,AUTO
         2 001125   550003 713400                    CLIMB   alt,+53251
         2 001126   402400 401760                    pmme    nvectors=6
         2 001127   001130 702000 2                  TSX2    OK_ALT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:120  

      461     9232    3   OK_ALT: FPT_RESCTL.PSEUDO_ = VECTOR(VLP_PSEUDO);

   9232  2 001130   000022 235000 3     OK_ALT       LDA     18
         2 001131   205530 452500                    STP2    DCB$+2,,AUTO
         2 001132   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001133   004160 036003                    ADLQ    2160,DU
         2 001134   204140 757100                    STAQ    FPT_RESCTL+2,,AUTO

      462     9233    3           CALL M$LIMIT(FPT_RESCTL) ALTRET(RELALT);

   9233  2 001135   204136 630500                    EPPR0   FPT_RESCTL,,AUTO
         2 001136   550000 713400                    CLIMB   alt,+53248
         2 001137   402400 401760                    pmme    nvectors=6
         2 001140   001142 702000 2                  TSX2    RELALT

      463     9234    4           DO WHILE('0'B);

   9234  2 001141   001151 710000 2                  TRA     s:9237

      464     9235    4   RELALT:      CALL POST_ERR(%AZ$LOGOFFERR);

   9235  2 001142   000001 236000 xsym  RELALT       LDQ     B_VECTNIL+1
         2 001143   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001144   205524 757100                    STAQ    @ERR+1,,AUTO
         2 001145   000005 236000 3                  LDQ     5
         2 001146   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 001147   011343 701000 2                  TSX1    POST_ERR
         2 001150   000000 011000                    NOP     0

      465     9236    4                END;

      466     9237    3           END;

   9237  2 001151   001153 710000 2                  TRA     s:9239

      467     9238    2   INITIALIZE_FEP: ENTRY;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:121  

   9238  2 001152   204502 741300       INITIALIZE_* STX1  ! WR_SECLOG+8,,AUTO

      468     9239    2      IN_KEY$ = ADDR(IN_KEY);

   9239  2 001153   204117 630500                    EPPR0   IN_KEY,,AUTO
         2 001154   204130 450500                    STP0    IN_KEY$,,AUTO

      469     9240    2      DCB1$ = DCBADDR(LOGOFF_PARAM.DCB1);

   9240  2 001155   000017 471400 3                  LDP1    15
         2 001156   100000 473500                    LDP3    0,,PR1
         2 001157   200003 474500                    LDP4    @LOGOFF_PARAM,,AUTO
         2 001160   400002 220100                    LDX0    2,,PR4
         2 001161   300000 236110                    LDQ     0,X0,PR3
         2 001162   204010 756100                    STQ     DCB1$,,AUTO

      470     9241    2      REC$ = ADDR(REC);

   9241  2 001163   200004 635500                    EPPR5   REC,,AUTO
         2 001164   204004 455500                    STP5    REC$,,AUTO

      471     9242    2      REC1$ = ADDR(REC1);

   9242  2 001165   202004 636500                    EPPR6   REC1,,AUTO
         2 001166   204005 456500                    STP6    REC1$,,AUTO

      472     9243    2      LOGOFF_PARAM.ERR = 0;

   9243  2 001167   400001 450100                    STZ     1,,PR4

      473     9244    2      DCB#_SAVE = 0;

   9244  2 001170   204135 450100                    STZ     DCB#_SAVE,,AUTO

      474     9245    2      FPT_ACCT.V_ = VECTOR(FPT_ACCT.V);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:122  
   9245  2 001171   000023 235000 3                  LDA     19
         2 001172   205530 452500                    STP2    DCB$+2,,AUTO
         2 001173   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001174   004446 036003                    ADLQ    2342,DU
         2 001175   204434 757100                    STAQ    FPT_ACCT,,AUTO

      475     9246    2      FPT_ACCT.BUF_ = VECTOR(REC);

   9246  2 001176   000003 235000 3                  LDA     3
         2 001177   205530 452500                    STP2    DCB$+2,,AUTO
         2 001200   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001201   000004 036003                    ADLQ    4,DU
         2 001202   204436 757100                    STAQ    FPT_ACCT+2,,AUTO

      476     9247    2      FPT_ACCT.LEN_ = VECTOR(RECLEN);

   9247  2 001203   777640 235007                    LDA     -96,DL
         2 001204   205530 452500                    STP2    DCB$+2,,AUTO
         2 001205   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001206   004006 036003                    ADLQ    2054,DU
         2 001207   204440 757100                    STAQ    FPT_ACCT+4,,AUTO

      477     9248    2      FPT_ACCT.PNAME_ = VECTOR(NIL);

   9248  2 001210   000026 237000 3                  LDAQ    22
         2 001211   204442 757100                    STAQ    FPT_ACCT+6,,AUTO

      478     9249    2      FPT_ACCT.JIT_ = VECTOR(B$JIT);

   9249  2 001212   000007 235000 3                  LDA     7
         2 001213   204007 236100                    LDQ     JIT$,,AUTO
         2 001214   204444 757100                    STAQ    FPT_ACCT+8,,AUTO

      479     9250    2      FPT_ACCT.V.UTS# = LOGOFF_PARAM.UTS;

   9250  2 001215   400003 235100                    LDA     3,,PR4
         2 001216   204446 755100                    STA     FPT_ACCT+10,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:123  

      480     9251    2      FPT_ACCT.V.STAROUT# = '0'B;

   9251  2 001217   000025 236000 3                  LDQ     21
         2 001220   204447 356100                    ANSQ    FPT_ACCT+11,,AUTO

      481     9252    2      FPT_PRECORD = FPT_PRECORDC;

   9252  2 001221   000100 100400                    MLR     fill='000'O
         2 001222   000152 000050 1                  ADSC9   FPT_PRECORDC             cn=0,n=40
         2 001223   204320 000050                    ADSC9   FPT_PRECORD,,AUTO        cn=0,n=40

      482     9253    2      FPT_PRECORD.V_ = VECTOR(FPT_PRECORD.V);

   9253  2 001224   000006 235000 3                  LDA     6
         2 001225   205530 452500                    STP2    DCB$+2,,AUTO
         2 001226   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001227   004326 036003                    ADLQ    2262,DU
         2 001230   204320 757100                    STAQ    FPT_PRECORD,,AUTO

      483     9254    2      FPT_PRECORD.V.DCB# = LOGOFF_PARAM.DCB1;

   9254  2 001231   400002 220100                    LDX0    2,,PR4
         2 001232   204326 740100                    STX0    FPT_PRECORD+6,,AUTO

      484     9255    2      FPT_PRECORD.KEY_ = VECTOR(IN_KEY);

   9255  2 001233   000030 235000 3                  LDA     24
         2 001234   205530 452500                    STP2    DCB$+2,,AUTO
         2 001235   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001236   004117 036003                    ADLQ    2127,DU
         2 001237   204322 757100                    STAQ    FPT_PRECORD+2,,AUTO

      485     9256    2      FPT_READ = FPT_READC;

   9256  2 001240   000100 100400                    MLR     fill='000'O
         2 001241   000164 000070 1                  ADSC9   FPT_READC                cn=0,n=56
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:124  
         2 001242   204332 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

      486     9257    2      FPT_READ.V_ = VECTOR(FPT_READ.V);

   9257  2 001243   000024 235000 3                  LDA     20
         2 001244   205530 452500                    STP2    DCB$+2,,AUTO
         2 001245   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001246   004342 036003                    ADLQ    2274,DU
         2 001247   204332 757100                    STAQ    FPT_READ,,AUTO

      487     9258    2      FPT_READ.KEY_ = VECTOR(IN_KEY);

   9258  2 001250   000030 235000 3                  LDA     24
         2 001251   205530 452500                    STP2    DCB$+2,,AUTO
         2 001252   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001253   004117 036003                    ADLQ    2127,DU
         2 001254   204334 757100                    STAQ    FPT_READ+2,,AUTO

      488     9259    2      FPT_READ.V.DCB# = LOGOFF_PARAM.DCB1;

   9259  2 001255   400002 221100                    LDX1    2,,PR4
         2 001256   204342 741100                    STX1    FPT_READ+8,,AUTO

      489     9260    2      FPT_WRITE = FPT_WRITEC;

   9260  2 001257   000100 100400                    MLR     fill='000'O
         2 001260   000202 000060 1                  ADSC9   FPT_WRITEC               cn=0,n=48
         2 001261   204350 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

      490     9261    2      FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);

   9261  2 001262   000006 235000 3                  LDA     6
         2 001263   205530 452500                    STP2    DCB$+2,,AUTO
         2 001264   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001265   004360 036003                    ADLQ    2288,DU
         2 001266   204350 757100                    STAQ    FPT_WRITE,,AUTO

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:125  
      491     9262    2      FPT_DELREC = FPT_DELRECC;

   9262  2 001267   000100 100400                    MLR     fill='000'O
         2 001270   000216 000050 1                  ADSC9   FPT_DELRECC              cn=0,n=40
         2 001271   204364 000050                    ADSC9   FPT_DELREC,,AUTO         cn=0,n=40

      492     9263    2      FPT_DELREC.V_ = VECTOR(FPT_DELREC.V);

   9263  2 001272   000023 235000 3                  LDA     19
         2 001273   205530 452500                    STP2    DCB$+2,,AUTO
         2 001274   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001275   004374 036003                    ADLQ    2300,DU
         2 001276   204364 757100                    STAQ    FPT_DELREC,,AUTO

      493     9264    2      FPT_DELREC.V.DCB# = LOGOFF_PARAM.DCB1;

   9264  2 001277   400002 222100                    LDX2    2,,PR4
         2 001300   204374 742100                    STX2    FPT_DELREC+8,,AUTO

      494     9265    2      FPT_CLOSE = FPT_CLOSEC;

   9265  2 001301   000100 100400                    MLR     fill='000'O
         2 001302   000232 000170 1                  ADSC9   FPT_CLOSEC               cn=0,n=120
         2 001303   204376 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      495     9266    2      FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

   9266  2 001304   000006 235000 3                  LDA     6
         2 001305   205530 452500                    STP2    DCB$+2,,AUTO
         2 001306   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001307   004430 036003                    ADLQ    2328,DU
         2 001310   204376 757100                    STAQ    FPT_CLOSE,,AUTO

      496     9267    2      FPT_CLOSE.V.DCB# = LOGOFF_PARAM.DCB1;

   9267  2 001311   400002 223100                    LDX3    2,,PR4
         2 001312   204430 743100                    STX3    FPT_CLOSE+26,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:126  

      497     9268    2      FPT_ENQ = FPT_ENQC;

   9268  2 001313   000100 100400                    MLR     fill='000'O
         2 001314   000022 000050 1                  ADSC9   FPT_ENQC                 cn=0,n=40
         2 001315   204170 000050                    ADSC9   FPT_ENQ,,AUTO            cn=0,n=40

      498     9269    2      FPT_ENQ.V_ = VECTOR(FPT_ENQ.V);

   9269  2 001316   000006 235000 3                  LDA     6
         2 001317   205530 452500                    STP2    DCB$+2,,AUTO
         2 001320   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001321   004176 036003                    ADLQ    2174,DU
         2 001322   204170 757100                    STAQ    FPT_ENQ,,AUTO

      499     9270    2      FPT_ENQ.V.DCB# = LOGOFF_PARAM.DCB1;

   9270  2 001323   400002 224100                    LDX4    2,,PR4
         2 001324   204176 744100                    STX4    FPT_ENQ+6,,AUTO

      500     9271    2      FPT_ENQ.RNAME_ = VECTOR(IN_KEY);

   9271  2 001325   000030 235000 3                  LDA     24
         2 001326   205530 452500                    STP2    DCB$+2,,AUTO
         2 001327   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001330   004117 036003                    ADLQ    2127,DU
         2 001331   204172 757100                    STAQ    FPT_ENQ+2,,AUTO

      501     9272    2      FPT_DEQ = FPT_DEQC;

   9272  2 001332   000100 100400                    MLR     fill='000'O
         2 001333   000034 000040 1                  ADSC9   FPT_DEQC                 cn=0,n=32
         2 001334   204202 000040                    ADSC9   FPT_DEQ,,AUTO            cn=0,n=32

      502     9273    2      FPT_DEQ.V_ = VECTOR(FPT_DEQ.V);

   9273  2 001335   000023 235000 3                  LDA     19
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:127  
         2 001336   205530 452500                    STP2    DCB$+2,,AUTO
         2 001337   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001340   004210 036003                    ADLQ    2184,DU
         2 001341   204202 757100                    STAQ    FPT_DEQ,,AUTO

      503     9274    2      FPT_DEQ.V.DCB# = LOGOFF_PARAM.DCB1;

   9274  2 001342   400002 225100                    LDX5    2,,PR4
         2 001343   204210 745100                    STX5    FPT_DEQ+6,,AUTO

      504     9275    2      FPT_DEQ.RNAME_ = VECTOR(IN_KEY);

   9275  2 001344   000030 235000 3                  LDA     24
         2 001345   205530 452500                    STP2    DCB$+2,,AUTO
         2 001346   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001347   004117 036003                    ADLQ    2127,DU
         2 001350   204204 757100                    STAQ    FPT_DEQ+2,,AUTO

      505     9276    2      FPT_TIME = FPT_TIMEC;

   9276  2 001351   000100 100400                    MLR     fill='000'O
         2 001352   000044 000060 1                  ADSC9   FPT_TIMEC                cn=0,n=48
         2 001353   204212 000060                    ADSC9   FPT_TIME,,AUTO           cn=0,n=48

      506     9277    2      FPT_TIME.V_ = VECTOR(FPT_TIME.V);

   9277  2 001354   000023 235000 3                  LDA     19
         2 001355   205530 452500                    STP2    DCB$+2,,AUTO
         2 001356   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001357   004224 036003                    ADLQ    2196,DU
         2 001360   204212 757100                    STAQ    FPT_TIME,,AUTO

      507     9278    2      IF JIT$=ADDR(REC1) THEN GOTO S_NONE;

   9278  2 001361   205530 452500                    STP2    DCB$+2,,AUTO
         2 001362   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001363   002004 036003                    ADLQ    1028,DU
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:128  
         2 001364   204007 116100                    CMPQ    JIT$,,AUTO
         2 001365   001431 600000 2                  TZE     S_NONE

      508     9279    2      CALL OPEN_FILE(F_STARS) ALTRET(S_ALT);

   9279  2 001366   000000 236000 3                  LDQ     0
         2 001367   205511 756100                    STQ     FIRST+2,,AUTO
         2 001370   001552 701000 2                  TSX1    OPEN_FILE
         2 001371   001411 702000 2                  TSX2    S_ALT

      509     9280    2      IN_KEY = SACCUM_KEY;

   9280  2 001372   000100 100400                    MLR     fill='000'O
         2 001373   000270 000011 1                  ADSC9   SACCUM_KEY               cn=0,n=9
         2 001374   204117 000044                    ADSC9   IN_KEY,,AUTO             cn=0,n=36

      510     9281    2      FPT_READ.BUF_ = VECTOR(SACCUM);

   9281  2 001375   000013 235000 3                  LDA     11
         2 001376   205530 452500                    STP2    DCB$+2,,AUTO
         2 001377   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001400   004011 036003                    ADLQ    2057,DU
         2 001401   204336 757100                    STAQ    FPT_READ+4,,AUTO

      511     9282    2      FPT_READ.V.KEYS# = %YES#;

   9282  2 001402   200000 236007                    LDQ     65536,DL
         2 001403   204342 256100                    ORSQ    FPT_READ+8,,AUTO

      512     9283    2      CALL M$READ(FPT_READ) ALTRET(S_ALT);

   9283  2 001404   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 001405   440000 713400                    CLIMB   alt,read
         2 001406   401400 401760                    pmme    nvectors=4
         2 001407   001411 702000 2                  TSX2    S_ALT

      513     9284    3      DO WHILE('0'B);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:129  

   9284  2 001410   001434 710000 2                  TRA     s:9291

   9283  2 001411                       S_ALT        null
      514     9285    3   S_ALT:  ;
      515     9286    3           IF B$JIT$->B$JIT.ERR.CODE~=%E$NOKEY AND

   9286  2 001411   000000 470400 xsym               LDP0    B$JIT$
         2 001412   000012 236100                    LDQ     10,,PR0
         2 001413   377770 376007                    ANQ     131064,DL
         2 001414   001020 116007                    CMPQ    528,DL
         2 001415   001431 600000 2                  TZE     S_NONE
         2 001416   001610 116007                    CMPQ    904,DL
         2 001417   001431 600000 2                  TZE     S_NONE

      516     9287    3             B$JIT$->B$JIT.ERR.CODE~=%E$NOFILE
      517     9288    3           THEN CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

   9288  2 001420   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001421   205525 756100                    STQ     @DCB#+1,,AUTO
         2 001422   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 001423   000002 036003                    ADLQ    2,DU
         2 001424   205524 756100                    STQ     @ERR+1,,AUTO
         2 001425   000005 236000 3                  LDQ     5
         2 001426   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 001427   011343 701000 2                  TSX1    POST_ERR
         2 001430   000000 011000                    NOP     0

      518     9289    3   S_NONE: SACCUM = '0'B;                  /* Start with empty SACCUM tbl        */

   9289  2 001431   000100 100400       S_NONE       MLR     fill='000'O
         2 001432   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001433   204011 000224                    ADSC9   SACCUM,,AUTO             cn=0,n=148

      519     9290    3           END;

      520     9291    2   END INITIALIZE;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:130  

   9291  2 001434   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 001435   000001 702211                    TSX2  ! 1,X1

      521     9292        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:131  
      522     9293    1   SEND_REC: PROC;

   9293  2 001436   204502 741300       SEND_REC     STX1  ! WR_SECLOG+8,,AUTO

      523     9294        /*I* NAME:        SEND_REC
      524     9295             PURPOSE:     To write the JSP record to :ACCTLG and *S
      525     9296             CALL:        CALL SEND_REC
      526     9297             DESCRIPTION: SEND_REC writes the JSP record to :ACCTLG and then
      527     9298                          checks to see if it should also be written to *S
      528     9299                          which it does if this is not RECOVERY and
      529     9300                          B$JIT.CPFLAGS1 & %CP_STARSACC# is set.
      530     9301        */
      531     9302    2   DCL REC$ORD CHAR(RECLEN) BASED(REC$);   /* The JSP record                     */
      532     9303        %STARSACC$KEY (NAME=STARS_KEY,STCLASS=AUTO);
      533     9340    2      CALL OPEN_FILE(F_ACCTLG) ALTRET(ALT1);

   9340  2 001437   000011 236000 3                  LDQ     9
         2 001440   205511 756100                    STQ     FIRST+2,,AUTO
         2 001441   001552 701000 2                  TSX1    OPEN_FILE
         2 001442   001537 702000 2                  TSX2    ALT1

      534     9341    2      FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;

   9341  2 001443   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 001444   000002 220100                    LDX0    2,,PR0
         2 001445   204360 740100                    STX0    FPT_WRITE+8,,AUTO

      535     9342    2      FPT_WRITE.BUF_ = VECTOR(REC$ORD);

   9342  2 001446   204006 235100                    LDA     RECLEN,,AUTO
         2 001447   000020 735000                    ALS     16
         2 001450   000140 135007                    SBLA    96,DL
         2 001451   204004 236100                    LDQ     REC$,,AUTO
         2 001452   204354 757100                    STAQ    FPT_WRITE+4,,AUTO

      536     9343    2      CALL M$WRITE(FPT_WRITE) ALTRET(ALT1);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:132  
   9343  2 001453   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 001454   440001 713400                    CLIMB   alt,write
         2 001455   401400 401760                    pmme    nvectors=4
         2 001456   001537 702000 2                  TSX2    ALT1

      537     9344    2      IF (B$JIT.CPFLAGS1 & %CP_STARSACC#) AND LOGOFF_PARAM.CODE~=%AZ$RECOVERY

   9344  2 001457   204007 470500                    LDP0    JIT$,,AUTO
         2 001460   000143 236100                    LDQ     99,,PR0
         2 001461   001755 376000 1                  ANQ     XSJ_PARAMC+9
         2 001462   001536 600000 2                  TZE     s:9363
         2 001463   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 001464   100000 235100                    LDA     0,,PR1
         2 001465   000001 115007                    CMPA    1,DL
         2 001466   001536 600000 2                  TZE     s:9363

      538     9345    3      THEN DO;                             /* Write JSP record to *S also        */

      539     9346    3           CALL OPEN_FILE(F_STARS) ALTRET(ALT1);

   9346  2 001467   000000 236000 3                  LDQ     0
         2 001470   205511 756100                    STQ     FIRST+2,,AUTO
         2 001471   001552 701000 2                  TSX1    OPEN_FILE
         2 001472   001537 702000 2                  TSX2    ALT1

      540     9347    3           FPT_WRITE.KEY_ = VECTOR(STARS_KEY);

   9347  2 001473   000031 235000 3                  LDA     25
         2 001474   205530 452500                    STP2    DCB$+2,,AUTO
         2 001475   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001476   004503 036003                    ADLQ    2371,DU
         2 001477   204352 757100                    STAQ    FPT_WRITE+2,,AUTO

      541     9348    3           STARS_KEY.LEN = LENGTHC(STARS_KEY)-1;

   9348  2 001500   004000 236003                    LDQ     2048,DU
         2 001501   204503 552140                    STBQ    STARS_KEY,'40'O,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:133  

      542     9349    3           STARS_KEY.ACCT = 'b';

   9349  2 001502   000142 236003                    LDQ     98,DU
         2 001503   204503 552120                    STBQ    STARS_KEY,'20'O,AUTO

      543     9350    3           IF JSP.TYPE=%AZ$JOBEND

   9350  2 001504   204004 470500                    LDP0    REC$,,AUTO
         2 001505   000036 236100                    LDQ     30,,PR0
         2 001506   000777 376003                    ANQ     511,DU
         2 001507   000002 116003                    CMPQ    2,DU
         2 001510   001516 601000 2                  TNZ     s:9356

      544     9351    4           THEN DO;

      545     9352    4                STARS_KEY.STEP = 0;

   9352  2 001511   000000 220003                    LDX0    0,DU
         2 001512   204503 440100                    SXL0    STARS_KEY,,AUTO

      546     9353    4                STARS_KEY.NUM = 0;

   9353  2 001513   000000 236003                    LDQ     0,DU
         2 001514   204504 552140                    STBQ    PGRANS+1,'40'O,AUTO

      547     9354    4                END;

   9354  2 001515   001532 710000 2                  TRA     s:9361

      548     9355    4           ELSE DO;

      549     9356    4                STARS_KEY.STEP = JSP.STEP;

   9356  2 001516   000056 220100                    LDX0    46,,PR0
         2 001517   204503 440100                    SXL0    STARS_KEY,,AUTO

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:134  
      550     9357    4                IF JSP.TYPE=%AZ$STEP

   9357  2 001520   000036 236100                    LDQ     30,,PR0
         2 001521   000777 376003                    ANQ     511,DU
         2 001522   000004 116003                    CMPQ    4,DU
         2 001523   001527 601000 2                  TNZ     s:9359

      551     9358    4                THEN STARS_KEY.NUM = 510;

   9358  2 001524   776000 236003                    LDQ     -1024,DU
         2 001525   204504 552140                    STBQ    PGRANS+1,'40'O,AUTO
         2 001526   001532 710000 2                  TRA     s:9361

      552     9359    4                ELSE STARS_KEY.NUM = PROCNUM;

   9359  2 001527   204133 236100                    LDQ     PROCNUM,,AUTO
         2 001530   000033 736000                    QLS     27
         2 001531   204504 552140                    STBQ    PGRANS+1,'40'O,AUTO

      553     9360    4                END;

      554     9361    3           CALL M$WRITE(FPT_WRITE) ALTRET(ALT1);

   9361  2 001532   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 001533   440001 713400                    CLIMB   alt,write
         2 001534   401400 401760                    pmme    nvectors=4
         2 001535   001537 702000 2                  TSX2    ALT1

      555     9362    3           END;

      556     9363    3      DO WHILE('0'B);

   9363  2 001536   001550 710000 2                  TRA     s:9366

      557     9364    3   ALT1:   CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

   9364  2 001537   000001 236000 xsym  ALT1         LDQ     B_VECTNIL+1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:135  
         2 001540   205525 756100                    STQ     @DCB#+1,,AUTO
         2 001541   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 001542   000002 036003                    ADLQ    2,DU
         2 001543   205524 756100                    STQ     @ERR+1,,AUTO
         2 001544   000005 236000 3                  LDQ     5
         2 001545   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 001546   011343 701000 2                  TSX1    POST_ERR
         2 001547   000000 011000                    NOP     0

      558     9365    3           END;

      559     9366    2      RETURN;

   9366  2 001550   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 001551   000001 702211                    TSX2  ! 1,X1

      560     9367    2   END SEND_REC;
      561     9368        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:136  
      562     9369    1   OPEN_FILE: PROC(FILNUM) ALTRET;

   9369  2 001552   205510 741300       OPEN_FILE    STX1  ! FIRST+1,,AUTO

      563     9370        /*I* NAME: OPEN_FILE
      564     9371             PURPOSE: To open the specified file on DCB LOGOFF_PARAM.DCB1. If the
      565     9372             DCB is already opened, it is checked for filename and closed and reopened
      566     9373             only if its the wrong file.
      567     9374        */
      568     9375    2   DCL FILNUM SBIN;
      569     9376    2   DCL 1 OPN_TBL(0:4) CONSTANT,
      570     9377    2         2 NAME,
      571     9378    2           3 L UBIN BYTE UNAL INIT(2,7,6,6,9),
      572     9379    2           3 C CHAR(31) INIT('*S',':ACCTLG',':RATES',':USERS',':JOBSTATS'),
      573     9380    2         2 ACCT CHAR(8) INIT(' ',':SYS',':SYS',':SYS',':SYS'),
      574     9381    2         2 FUN UBIN BYTE UNAL INIT(%CREATE#,%CREATE#,%IN#,%UPDATE#,%UPDATE#),
      575     9382    2         2 ORG UBIN BYTE UNAL INIT(%KEYED#,%CONSEC#,%KEYED#,%KEYED#,%KEYED#),
      576     9383    2         2 SHR UBIN BYTE UNAL INIT(%NONE#,%ALL#,%ALL#,%ALL#,%ALL#),
      577     9384    2         2 ACS UBIN BYTE UNAL INIT(%DIRECT#,%JRNL#,%DIRECT#,%DIRECT#,%DIRECT#);
      578     9385        %XSJ_PARAM(FPTN = XSJ_PARAMC,STCLASS = CONSTANT,
      579     9386                MODE = %UPDATE#);
      580     9403        %XSJ_PARAM(FPTN = XSJ_PARAM,STCLASS = AUTO);
      581     9420    2      IF DCB1$->F$DCB.FCD#

   9420  2 001553   204010 470500                    LDP0    DCB1$,,AUTO
         2 001554   000031 236100                    LDQ     25,,PR0
         2 001555   020000 316007                    CANQ    8192,DL
         2 001556   001604 600000 2                  TZE     s:9426

      582     9421    2      THEN IF ADDR(DCB1$->F$DCB.NAME#)->TEXT$C =

   9421  2 001557   000010 236100                    LDQ     8,,PR0
         2 001560   000033 772000                    QRL     27
         2 001561   000001 620006                    EAX0    1,QL
         2 001562   205511 471500                    LDP1    @FILNUM,,AUTO
         2 001563   100000 236100                    LDQ     0,,PR1
         2 001564   000013 402007                    MPY     11,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:137  
         2 001565   205530 756100                    STQ     DCB$+2,,AUTO
         2 001566   000325 236006 1                  LDQ     OPN_TBL,QL
         2 001567   000033 772000                    QRL     27
         2 001570   000001 622006                    EAX2    1,QL
         2 001571   205530 235100                    LDA     DCB$+2,,AUTO
         2 001572   000002 735000                    ALS     2
         2 001573   000045 106540                    CMPC    fill='000'O
         2 001574   000010 000010                    ADSC9   8,,PR0                   cn=0,n=*X0
         2 001575   000325 000012 1                  ADSC9   OPN_TBL,A                cn=0,n=*X2
         2 001576   001600 601000 2                  TNZ     s:9424

      583     9422    2             ADDR(OPN_TBL.NAME(FILNUM))->TEXT$C
      584     9423    2           THEN RETURN;                    /* Desired file is already open       */

   9423  2 001577   000001 702211                    TSX2  ! 1,X1

      585     9424    2           ELSE CALL M$CLOSE(FPT_CLOSE) ALTRET(CLS_ALT);

   9424  2 001600   204376 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001601   450001 713400                    CLIMB   alt,close
         2 001602   406000 401760                    pmme    nvectors=13
         2 001603   001605 702000 2                  TSX2    CLS_ALT

      586     9425                                                /* Close the wrong file               */
      587     9426    3      DO WHILE('0'B);

   9426  2 001604   001616 710000 2                  TRA     s:9432

      588     9427    3   CLS_ALT: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

   9427  2 001605   000001 236000 xsym  CLS_ALT      LDQ     B_VECTNIL+1
         2 001606   205525 756100                    STQ     @DCB#+1,,AUTO
         2 001607   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 001610   000002 036003                    ADLQ    2,DU
         2 001611   205524 756100                    STQ     @ERR+1,,AUTO
         2 001612   000005 236000 3                  LDQ     5
         2 001613   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:138  
         2 001614   011343 701000 2                  TSX1    POST_ERR
         2 001615   000000 011000                    NOP     0

      589     9428    3           END;

      590     9429        /***********************************
      591     9430         ****       OPEN THE DESIRED FILE
      592     9431         ***********************************/
      593     9432    2      IF FILNUM=F_JOBSTATS

   9432  2 001616   205511 470500                    LDP0    @FILNUM,,AUTO
         2 001617   000000 235100                    LDA     0,,PR0
         2 001620   000004 115007                    CMPA    4,DL
         2 001621   001637 601000 2                  TNZ     s:9439

      594     9433    3      THEN DO;

      595     9434    3           XSJ_PARAM = XSJ_PARAMC;

   9434  2 001622   000100 100400                    MLR     fill='000'O
         2 001623   000414 000040 1                  ADSC9   XSJ_PARAMC               cn=0,n=32
         2 001624   205512 000040                    ADSC9   XSJ_PARAM,,AUTO          cn=0,n=32

      596     9435    3           XSJ_PARAM.DCB# = LOGOFF_PARAM.DCB1;

   9435  2 001625   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 001626   100002 220100                    LDX0    2,,PR1
         2 001627   205517 740100                    STX0    XSJ_PARAM+5,,AUTO

      597     9436    3           CALL XSJ$OPEN(XSJ_PARAM) ALTRET(OOPS);

   9436  2 001630   205512 633500                    EPPR3   XSJ_PARAM,,AUTO
         2 001631   205530 453500                    STP3    DCB$+2,,AUTO
         2 001632   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 001633   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001634   000000 701000 xent               TSX1    XSJ$OPEN
         2 001635   001735 702000 2                  TSX2    OOPS
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:139  

      598     9437    3           END;

   9437  2 001636   001733 710000 2                  TRA     s:9452

      599     9438    3      ELSE DO;

      600     9439    3           FPT_OPEN = FPT_OPENC;

   9439  2 001637   000100 100400                    MLR     fill='000'O
         2 001640   000060 000350 1                  ADSC9   FPT_OPENC                cn=0,n=232
         2 001641   204226 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

      601     9440    3           FPT_OPEN.V_ = VECTOR(FPT_OPEN.V);

   9440  2 001642   000016 235000 3                  LDA     14
         2 001643   205530 452500                    STP2    DCB$+2,,AUTO
         2 001644   205530 236100                    LDQ     DCB$+2,,AUTO
         2 001645   004272 036003                    ADLQ    2234,DU
         2 001646   204226 757100                    STAQ    FPT_OPEN,,AUTO

      602     9441    3           FPT_OPEN.V.DCB# = LOGOFF_PARAM.DCB1;

   9441  2 001647   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 001650   100002 220100                    LDX0    2,,PR1
         2 001651   204272 740100                    STX0    FPT_OPEN+36,,AUTO

      603     9442    3           FPT_OPEN.NAME_ = VECTOR(OPN_TBL.NAME(FILNUM));

   9442  2 001652   000000 236100                    LDQ     0,,PR0
         2 001653   000013 402007                    MPY     11,DL
         2 001654   000022 235000 3                  LDA     18
         2 001655   000022 736000                    QLS     18
         2 001656   000032 036000 3                  ADLQ    26
         2 001657   204234 757100                    STAQ    FPT_OPEN+6,,AUTO

      604     9443    3           IF OPN_TBL.ACCT(FILNUM)=' '
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:140  

   9443  2 001660   000000 236100                    LDQ     0,,PR0
         2 001661   000013 402007                    MPY     11,DL
         2 001662   000002 736000                    QLS     2
         2 001663   040000 106406                    CMPC    fill='040'O
         2 001664   000335 000010 1                  ADSC9   OPN_TBL+8,Q              cn=0,n=8
         2 001665   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001666   001674 601000 2                  TNZ     s:9445

      605     9444    3           THEN FPT_OPEN.ACCT_ = VECTOR(B$JIT.FACCN);

   9444  2 001667   000023 235000 3                  LDA     19
         2 001670   204007 236100                    LDQ     JIT$,,AUTO
         2 001671   000006 036003                    ADLQ    6,DU
         2 001672   204252 757100                    STAQ    FPT_OPEN+20,,AUTO
         2 001673   001702 710000 2                  TRA     s:9446

      606     9445    3           ELSE FPT_OPEN.ACCT_ = VECTOR(OPN_TBL.ACCT(FILNUM));

   9445  2 001674   000000 236100                    LDQ     0,,PR0
         2 001675   000013 402007                    MPY     11,DL
         2 001676   000023 235000 3                  LDA     19
         2 001677   000022 736000                    QLS     18
         2 001700   000033 036000 3                  ADLQ    27
         2 001701   204252 757100                    STAQ    FPT_OPEN+20,,AUTO

      607     9446    3           FPT_OPEN.V.FUN# = OPN_TBL.FUN(FILNUM);

   9446  2 001702   000000 236100                    LDQ     0,,PR0
         2 001703   000013 402007                    MPY     11,DL
         2 001704   000337 236006 1                  LDQ     OPN_TBL+10,QL
         2 001705   000022 772000                    QRL     18
         2 001706   204273 552110                    STBQ    FPT_OPEN+37,'10'O,AUTO

      608     9447    3           FPT_OPEN.V.ORG# = OPN_TBL.ORG(FILNUM);

   9447  2 001707   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:141  
         2 001710   000013 402007                    MPY     11,DL
         2 001711   000337 236006 1                  LDQ     OPN_TBL+10,QL
         2 001712   000011 772000                    QRL     9
         2 001713   204274 552110                    STBQ    FPT_OPEN+38,'10'O,AUTO

      609     9448    3           FPT_OPEN.V.SHARE# = OPN_TBL.SHR(FILNUM);

   9448  2 001714   000000 236100                    LDQ     0,,PR0
         2 001715   000013 402007                    MPY     11,DL
         2 001716   000337 236006 1                  LDQ     OPN_TBL+10,QL
         2 001717   000006 772000                    QRL     6
         2 001720   204272 676100                    ERQ     FPT_OPEN+36,,AUTO
         2 001721   000030 376007                    ANQ     24,DL
         2 001722   204272 656100                    ERSQ    FPT_OPEN+36,,AUTO

      610     9449    3           FPT_OPEN.V.ACS# = OPN_TBL.ACS(FILNUM);

   9449  2 001723   000000 236100                    LDQ     0,,PR0
         2 001724   000013 402007                    MPY     11,DL
         2 001725   000337 236006 1                  LDQ     OPN_TBL+10,QL
         2 001726   204274 552104                    STBQ    FPT_OPEN+38,'04'O,AUTO

      611     9450    3           CALL M$OPEN(FPT_OPEN) ALTRET(OOPS);

   9450  2 001727   204226 630500                    EPPR0   FPT_OPEN,,AUTO
         2 001730   450000 713400                    CLIMB   alt,open
         2 001731   410400 401760                    pmme    nvectors=18
         2 001732   001735 702000 2                  TSX2    OOPS

      612     9451    3           END;

      613     9452    2      RETURN;

   9452  2 001733   205510 221300                    LDX1  ! FIRST+1,,AUTO
         2 001734   000001 702211                    TSX2  ! 1,X1

      614     9453    2   OOPS: ALTRETURN;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:142  

   9453  2 001735   205510 221300       OOPS         LDX1  ! FIRST+1,,AUTO
         2 001736   000000 702211                    TSX2  ! 0,X1

      615     9454    2   END OPEN_FILE;
      616     9455        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:143  
      617     9456    1   CHARGE_PRINT: PROC;

   9456  2 001737   204502 741300       CHARGE_PRINT STX1  ! WR_SECLOG+8,,AUTO

      618     9457        /*I* NAME: CHARGE_PRINT
      619     9458             PURPOSE: To charge the user and/or output statistics about this JSP record
      620     9459        */
      621     9460    2   DCL STATSLEV SBIN;                      /* Level of statistics reporting      */
      622     9461                                                /* to perform. Choices are:           */
      623     9462                                                /* AZ_ALL#, AZ_SUMMARY#, or           */
      624     9463                                                /* AZ_NONE#                           */
      625     9464    2   DCL F0 BIT(72) ALIGNED CONSTANT INIT('300000000000000000000000'O);
      626     9465                                                /* floating point decimal 0           */
      627     9466    2   DCL F1 BIT(72) ALIGNED CONSTANT INIT('300000000000000000001000'O);
      628     9467                                                /* floating point decimal 1           */
      629     9468    2   DCL FRM_TEMPLATE CHAR(0) CONSTANT INIT
      630     9469    2           ('                 @               @       /form +   @       /mnt');
      631     9470    2   DCL FRM_TEMPLATE_BLIND CHAR(0) CONSTANT INIT
      632     9471    2           ('                 @               forms         +   mounts');
      633     9472    2   DCL DASH_LINE CHAR(72) CONSTANT INIT(
      634     9473    2     '------------------------------------------------------------------------');
      635     9474    2   DCL SUM_TEMPLATE CHAR(0) CONSTANT INIT(
      636     9475    2           'CON=          EX=             SRV=             PMME=        CHG=');
      637     9476    2   DCL BL_16 CHAR(16) CONSTANT INIT(' ');
      638     9477    2   DCL T SBIN;                             /* Temporary value                    */
      639     9478    2   DCL I SBIN;                             /* counter                            */
      640     9479    2   DCL PSTEP BIT(1) ALIGNED;               /* If set, this is a processor step   */
      641     9480    2   DCL FORM_START BIT(1) ALIGNED;
      642     9481    2   DCL CHR6 CHAR(6);
      643     9482    2   DCL CHR7 CHAR(7);
      644     9483    2   DCL CHR8 CHAR(8);
      645     9484    2   DCL CHR9 CHAR(9);
      646     9485    2   DCL CHR10 CHAR(10);
      647     9486    2   DCL CHR11 CHAR(11);
      648     9487    2   DCL CHG1 SBIN;
      649     9488    2   DCL CHG2 SBIN;
      650     9489    2   DCL T1 SBIN;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:144  
      651     9490    2   DCL MNTS SBIN;
      652     9491    2   DCL MOPS_5_2_STR(0:5) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS5,%ENF00,
      653     9492    2                                              %INSB7,%MVC2);
      654     9493    2   DCL MOPS_4_2_STR(0:5) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS4,%ENF00,
      655     9494    2                                              %INSB7,%MVC2);
      656     9495    2   DCL MOPS_5_0_STR(0:4) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS4,%ENF00,%MVC1);
      657     9496    2   DCL MOPS_6_0_STR(0:4) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS5,%ENF00,%MVC1);
      658     9497    2   DCL MOP_2_4_STR(0:3) BIT(9) CONSTANT INIT(%MVZB2,%SES10,%INSB7,%MVC4);
      659     9498    2   DCL MOP_3_4_STR(0:3) BIT(9) CONSTANT INIT(%MVZB3,%SES10,%INSB7,%MVC4);
      660     9499    2   DCL MOP_4_2_STR(0:3) BIT(9) CONSTANT INIT(%MVZB4,%SES10,%INSB7,%MVC2);
      661     9500    2   DCL MOP_5_2_STR(0:3) BIT(9) CONSTANT INIT(%MVZB5,%SES10,%INSB7,%MVC2);
      662     9501    2   DCL MOP_7_2_STR(0:3) BIT(9) CONSTANT INIT(%MVZB7,%SES10,%INSB7,%MVC2);
      663     9502    2   DCL MOP_2_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB1,%MVC1);
      664     9503    2   DCL MOP_3_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB2,%MVC1);
      665     9504    2   DCL MOP_4_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB3,%MVC1);
      666     9505    2   DCL MOP_6_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB5,%MVC1);
      667     9506    2   DCL MOP_6_4_STR (0:3) BIT(9) CALIGNED CONSTANT INIT (%MVZB6,%SES10,%INSB7,%MVC4);
      668     9507    2   DCL MOP_7_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB6,%MVC1);
      669     9508    2   DCL MOP_8_0_STR(0:1) BIT(9) CONSTANT INIT(%MVZB7,%MVC1);
      670     9509    2   DCL ZERO CHAR(10) CONSTANT INIT('0000000000');
      671     9510        %B$RATE_TBL(FPTN = RT,STCLASS = AUTO);
      672     9625        %B$RATE_TBL(FPTN = RT_DFLT,STCLASS = CONSTANT);
      673     9740        %B$RATE_TBL(FPTN = PRT,STCLASS = AUTO);
      674     9855        %B$PROC_TBL(FPTN = PRC_SCH_TBL,STCLASS = AUTO);
      675     9882        %B$PROC_TBL(FPTN = PRC_SCH_DFLT,STCLASS = CONSTANT);
      676     9909        %B$FORM_TBL(FPTN = FORM_TBL,STCLASS = AUTO);
      677     9930        %B$FORM_TBL(FPTN = FORM_DFLT,STCLASS = CONSTANT);
      678     9951        %FORM(NAME = FRM,STCLASS="BASED(FRM$)");
      679     9997    2   DCL NO_DFLT UBIN;
      680     9998    2   DCL RATES_OPN BIT(1) ALIGNED;
      681     9999    2   DCL FRM$ PTR;
      682    10000        %FPT_OPEN(FPTN = FPT_OPEN_LLC,STCLASS = CONSTANT,
      683    10001                SCRUB = YES,
      684    10002                REASSIGN = YES,
      685    10003                SETDCB = YES);
      686    10112        %FPT_OPEN(FPTN = FPT_OPEN_LL,STCLASS = AUTO);
      687    10221    2   DCL OUT_BUF CHAR(72);                   /* output buffer                      */
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:145  
      688    10222        /***********************************
      689    10223         ****       OB - OUT_BUF redefed for CHG recs
      690    10224         ***********************************/
      691    10225    2   DCL 1 OB REDEF OUT_BUF,
      692    10226    2         2 SCLR,
      693    10227    2           3 NAME CHAR(25),
      694    10228    2           3 JSUNIT REDEF NAME,
      695    10229    2             4 * CHAR(7),
      696    10230    2             4 Q1 CHAR(1),
      697    10231    2             4 JSNAME CHAR(16),
      698    10232    2             4 Q2 CHAR(1),
      699    10233    2           3 SCLR CHAR(8),
      700    10234    2         2 DEC2 REDEF SCLR,
      701    10235    2           3 * CHAR(23),
      702    10236    2           3 DEC2 CHAR(10),
      703    10237    2         2 TIM REDEF SCLR,
      704    10238    2           3 * CHAR(22),
      705    10239    2           3 TIM CHAR(11),
      706    10240    2         2 TIM1 REDEF SCLR,
      707    10241    2           3 * CHAR(21),
      708    10242    2           3 HRS CHAR(3),
      709    10243    2           3 * CHAR(9),
      710    10244    2         2 BL_AT CHAR(2),
      711    10245    2         2 PER_UNIT CHAR(8),
      712    10246    2         2 UNITS CHAR(10),
      713    10247    2         2 O_PAREN CHAR(1),
      714    10248    2         2 PCHG CHAR(8),
      715    10249    2         2 C_PAREN CHAR(1),
      716    10250    2         2 CHG CHAR(9);
      717    10251        /***********************************
      718    10252         ****       OBF - OUT_BUF redefed for FORM recs
      719    10253         ***********************************/
      720    10254    2   DCL 1 OBF REDEF OUT_BUF,
      721    10255    2         2 * CHAR(2),
      722    10256    2         2 NAME CHAR(12),
      723    10257    2         2 * CHAR(1),
      724    10258    2         2 DD CHAR(2),
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:146  
      725    10259    2         2 * CHAR(1),
      726    10260    2         2 WSN CHAR(8),
      727    10261    2         2 FRMS CHAR(6),
      728    10262    2         2 * CHAR(2),
      729    10263    2         2 PER_FORM CHAR(7),
      730    10264    2         2 * CHAR(7),
      731    10265    2         2 MNTS CHAR(2),
      732    10266    2         2 * CHAR(2),
      733    10267    2         2 PER_MNT CHAR(7),
      734    10268    2         2 * CHAR(4),
      735    10269    2         2 CHG CHAR(9);
      736    10270        /***********************************
      737    10271         ****       OBT - OUT_BUF redefed for TOTAL rec
      738    10272         ***********************************/
      739    10273    2   DCL 1 OBT REDEF OUT_BUF,
      740    10274    2         2 * CHAR(14),
      741    10275    2         2 TCHG CHAR(9),
      742    10276    2         2 * CHAR(49);
      743    10277        /***********************************
      744    10278         ****       OBS - OUT_BUF redefed for SUMMARY rec
      745    10279         ***********************************/
      746    10280    2   DCL 1 OBS REDEF OUT_BUF,
      747    10281    2         2 * CHAR(4),
      748    10282    2         2 CON,
      749    10283    2           3 * CHAR(1),
      750    10284    2           3 TIM CHAR(8),
      751    10285    2         2 CON1 REDEF CON,
      752    10286    2           3 HRS CHAR(3),
      753    10287    2           3 * CHAR(6),
      754    10288    2         2 * CHAR(4),
      755    10289    2         2 EXEC,
      756    10290    2           3 * CHAR(1),
      757    10291    2           3 TIME CHAR(11),
      758    10292    2         2 EXEC1 REDEF EXEC,
      759    10293    2           3 HRS CHAR(3),
      760    10294    2           3 * CHAR(9),
      761    10295    2         2 * CHAR(5),
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:147  
      762    10296    2         2 SERV,
      763    10297    2           3 * CHAR(1),
      764    10298    2           3 TIME CHAR(11),
      765    10299    2         2 SERV1 REDEF SERV,
      766    10300    2           3 HRS CHAR(3),
      767    10301    2           3 * CHAR(9),
      768    10302    2         2 * CHAR(6),
      769    10303    2         2 PMMES CHAR(7),
      770    10304    2         2 * CHAR(5),
      771    10305    2         2 CHG CHAR(8);
      772    10306        /***********************************
      773    10307         ****       OBH - OUT_BUF redefed for HEADER rec
      774    10308         ***********************************/
      775    10309    2   DCL 1 OBH REDEF OUT_BUF,
      776    10310    2         2 TIME CHAR(8),
      777    10311    2         2 * CHAR(1),
      778    10312    2         2 DATE CHAR(10),
      779    10313    2         2 * CHAR(1),
      780    10314    2         2 ACCT_NAME CHAR(21),
      781    10315    2         2 * CHAR(1),
      782    10316    2         2 AT CHAR(1),
      783    10317    2         2 WSN CHAR(8),
      784    10318    2         2 * CHAR(12),
      785    10319    2         2 SYSID_TXT CHAR(3),
      786    10320    2         2 SYSID CHAR(6);
      787    10321        /***********************************
      788    10322         ****       OBNC - OUT_BUF redefed for NO CHARGE recs
      789    10323         ***********************************/
      790    10324    2   DCL 1 OBNC REDEF OUT_BUF,
      791    10325    2         2 PRT1 CHAR(33),
      792    10326    2         2 TIM REDEF PRT1,
      793    10327    2           3 * CHAR(14),
      794    10328    2           3 TIM CHAR(8),
      795    10329    2           3 * CHAR(1),
      796    10330    2           3 DATE CHAR(10),
      797    10331    2         2 TIM1 REDEF PRT1,
      798    10332    2           3 * CHAR(19),
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:148  
      799    10333    2           3 * CHAR(3),
      800    10334    2           3 TIM CHAR(11),
      801    10335    2         2 TIM2 REDEF PRT1,
      802    10336    2           3 * CHAR(21),
      803    10337    2           3 HRS CHAR(3),
      804    10338    2           3 * CHAR(9),
      805    10339    2         2 NUM1 REDEF PRT1,
      806    10340    2           3 * CHAR(26),
      807    10341    2           3 NUM CHAR(7),
      808    10342    2         2 * CHAR(6),
      809    10343    2         2 PRT2 CHAR(33),
      810    10344    2         2 NUM2 REDEF PRT2,
      811    10345    2           3 * CHAR(26),
      812    10346    2           3 NUM CHAR(7),
      813    10347    2         2 OCT REDEF PRT2,
      814    10348    2           3 * CHAR(29),
      815    10349    2           3 NUM(0:2) CHAR(1),
      816    10350    2           3 * CHAR(1);
      817    10351        /***********************************
      818    10352         ****       OBP - OUT_BUF redefed for PSEUDO recs
      819    10353         ***********************************/
      820    10354    2   DCL 1 OBP REDEF OUT_BUF,
      821    10355    2         2 * CHAR(7),
      822    10356    2         2 SUDO(0:4),
      823    10357    2           3 * CHAR(2),
      824    10358    2           3 NAME CHAR(8),
      825    10359    2           3 EQ CHAR(1),
      826    10360    2           3 NUM CHAR(2);
      827    10361        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:149  
      828    10362        /***********************************
      829    10363         ****       open :RATES
      830    10364         ***********************************/
      831    10365    2      CALL OPEN_FILE(F_RATES) ALTRET(NO_RATES);

  10365  2 001740   000012 236000 3                  LDQ     10
         2 001741   205511 756100                    STQ     @FILNUM,,AUTO
         2 001742   001552 701000 2                  TSX1    OPEN_FILE
         2 001743   001747 702000 2                  TSX2    NO_RATES

      832    10366    2      RATES_OPN = %YES#;

  10366  2 001744   400000 236003                    LDQ     -131072,DU
         2 001745   205073 756100                    STQ     RATES_OPN,,AUTO

      833    10367    3      DO WHILE('0'B);

  10367  2 001746   001766 710000 2                  TRA     s:10375

      834    10368    3   NO_RATES: RATES_OPN = %NO#;             /* OK to run without :RATES file      */

  10368  2 001747   205073 450100       NO_RATES     STZ     RATES_OPN,,AUTO

      835    10369    3           IF B$JIT$->B$JIT.ERR.CODE~=%E$NOFILE

  10369  2 001750   000000 470400 xsym               LDP0    B$JIT$
         2 001751   000012 236100                    LDQ     10,,PR0
         2 001752   377770 376007                    ANQ     131064,DL
         2 001753   001610 116007                    CMPQ    904,DL
         2 001754   001766 600000 2                  TZE     s:10375

      836    10370    3           THEN CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

  10370  2 001755   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001756   205525 756100                    STQ     @DCB#+1,,AUTO
         2 001757   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 001760   000002 036003                    ADLQ    2,DU
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:150  
         2 001761   205524 756100                    STQ     @ERR+1,,AUTO
         2 001762   000005 236000 3                  LDQ     5
         2 001763   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 001764   011343 701000 2                  TSX1    POST_ERR
         2 001765   000000 011000                    NOP     0

      837    10371    3           END;

      838    10372        /***********************************
      839    10373         ****       get RT
      840    10374         ***********************************/
      841    10375    2      IF RATES_OPN

  10375  2 001766   205073 234100                    SZN     RATES_OPN,,AUTO
         2 001767   002061 605000 2                  TPL     s:10398

      842    10376    3      THEN DO;

      843    10377    3           FPT_READ.V.KEYS# = %YES#;

  10377  2 001770   200000 236007                    LDQ     65536,DL
         2 001771   204342 256100                    ORSQ    FPT_READ+8,,AUTO

      844    10378    3           FPT_READ.V.KEYR# = %NO#;

  10378  2 001772   000034 236000 3                  LDQ     28
         2 001773   204342 356100                    ANSQ    FPT_READ+8,,AUTO

      845    10379    3           IN_KEY.LEN = 10;

  10379  2 001774   012000 236003                    LDQ     5120,DU
         2 001775   204117 552140                    STBQ    IN_KEY,'40'O,AUTO

      846    10380    3           CALL CONCAT(IN_KEY.KEY,'SCHE',B$JIT.BILL);

  10380  2 001776   040100 100400                    MLR     fill='040'O
         2 001777   001756 000004 1                  ADSC9   XSJ_PARAMC+10            cn=0,n=4
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:151  
         2 002000   204117 200004                    ADSC9   IN_KEY,,AUTO             cn=1,n=4
         2 002001   204007 470500                    LDP0    JIT$,,AUTO
         2 002002   040100 100500                    MLR     fill='040'O
         2 002003   000151 400006                    ADSC9   105,,PR0                 cn=2,n=6
         2 002004   204120 200037                    ADSC9   IN_KEY+1,,AUTO           cn=1,n=31

      847    10381    3           NO_DFLT = 1;

  10381  2 002005   000001 235007                    LDA     1,DL
         2 002006   205072 755100                    STA     NO_DFLT,,AUTO

      848    10382    3           FPT_READ.BUF_ = VECTOR(PRC_SCH_TBL);

  10382  2 002007   000035 235000 3                  LDA     29
         2 002010   205530 452500                    STP2    DCB$+2,,AUTO
         2 002011   205530 236100                    LDQ     DCB$+2,,AUTO
         2 002012   005044 036003                    ADLQ    2596,DU
         2 002013   204336 757100                    STAQ    FPT_READ+4,,AUTO

      849    10383    3           CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);

  10383  2 002014   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 002015   440000 713400                    CLIMB   alt,read
         2 002016   401400 401760                    pmme    nvectors=4
         2 002017   004135 702000 2                  TSX2    DFLT_RTRY

      850    10384    4           DO WHILE('0'B);

  10384  2 002020   002033 710000 2                  TRA     s:10391

      851    10385    4   NO_SCHE:     PRC_SCH_TBL = PRC_SCH_DFLT;

  10385  2 002021   000100 100400       NO_SCHE      MLR     fill='000'O
         2 002022   000730 000070 1                  ADSC9   PRC_SCH_DFLT             cn=0,n=56
         2 002023   205044 000070                    ADSC9   PRC_SCH_TBL,,AUTO        cn=0,n=56

      852    10386    4                CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NOSCHED);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:152  

  10386  2 002024   000005 236000 3                  LDQ     5
         2 002025   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002026   205524 757100                    STAQ    @ERR+1,,AUTO
         2 002027   000005 236000 3                  LDQ     5
         2 002030   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 002031   011343 701000 2                  TSX1    POST_ERR
         2 002032   000000 011000                    NOP     0

      853    10387        /*E* ERROR: AZA-E$AZ_NOSCHED
      854    10388           MESSAGE: No default SCHEDULE record in :RATES.:SYS
      855    10389        */
      856    10390    4                END;

      857    10391    3           CALL CONCAT(IN_KEY.KEY,'RATE',PRC_SCH_TBL.RTABLE#);

  10391  2 002033   040100 100400                    MLR     fill='040'O
         2 002034   001757 000004 1                  ADSC9   XSJ_PARAMC+11            cn=0,n=4
         2 002035   204117 200004                    ADSC9   IN_KEY,,AUTO             cn=1,n=4
         2 002036   040100 100500                    MLR     fill='040'O
         2 002037   205044 000006                    ADSC9   PRC_SCH_TBL,,AUTO        cn=0,n=6
         2 002040   204120 200037                    ADSC9   IN_KEY+1,,AUTO           cn=1,n=31

      858    10392    3           NO_DFLT = 2;

  10392  2 002041   000002 235007                    LDA     2,DL
         2 002042   205072 755100                    STA     NO_DFLT,,AUTO

      859    10393    3           FPT_READ.BUF_ = VECTOR(RT);

  10393  2 002043   000036 235000 3                  LDA     30
         2 002044   205530 452500                    STP2    DCB$+2,,AUTO
         2 002045   205530 236100                    LDQ     DCB$+2,,AUTO
         2 002046   004534 036003                    ADLQ    2396,DU
         2 002047   204336 757100                    STAQ    FPT_READ+4,,AUTO

      860    10394    3           CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:153  

  10394  2 002050   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 002051   440000 713400                    CLIMB   alt,read
         2 002052   401400 401760                    pmme    nvectors=4
         2 002053   004135 702000 2                  TSX2    DFLT_RTRY

      861    10395    3           JSP.RATETBLE = IN_KEY;

  10395  2 002054   204004 470500                    LDP0    REC$,,AUTO
         2 002055   000100 100500                    MLR     fill='000'O
         2 002056   204117 000013                    ADSC9   IN_KEY,,AUTO             cn=0,n=11
         2 002057   000047 000013                    ADSC9   39,,PR0                  cn=0,n=11

      862    10396    3           END;

  10396  2 002060   002074 710000 2                  TRA     s:10409

      863    10397    3      ELSE DO;

      864    10398    4           DO WHILE('0'B);

  10398  2 002061   002071 710000 2                  TRA     s:10404

      865    10399    4   NO_RATE:     CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NORATE);

  10399  2 002062   000037 236000 3     NO_RATE      LDQ     31
         2 002063   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002064   205524 757100                    STAQ    @ERR+1,,AUTO
         2 002065   000005 236000 3                  LDQ     5
         2 002066   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 002067   011343 701000 2                  TSX1    POST_ERR
         2 002070   000000 011000                    NOP     0

      866    10400        /*E* ERROR: AZA-E$AZ_NORATE
      867    10401           MESSAGE: No default RATE record in :RATES.:SYS
      868    10402        */
      869    10403    4                END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:154  

      870    10404    3           RT = RT_DFLT;

  10404  2 002071   000100 100400                    MLR     fill='000'O
         2 002072   000564 000614 1                  ADSC9   RT_DFLT                  cn=0,n=396
         2 002073   204534 000614                    ADSC9   RT,,AUTO                 cn=0,n=396

      871    10405    3           END;

      872    10406        /***********************************
      873    10407         ****       get PRT if needed
      874    10408         ***********************************/
      875    10409    2      IF JSP.TYPE=%AZ$PROC

  10409  2 002074   204004 470500                    LDP0    REC$,,AUTO
         2 002075   000036 236100                    LDQ     30,,PR0
         2 002076   000777 376003                    ANQ     511,DU
         2 002077   000005 116003                    CMPQ    5,DU
         2 002100   002217 601000 2                  TNZ     s:10443

      876    10410    3      THEN DO;

      877    10411    3           PSTEP = %YES#;

  10411  2 002101   400000 236003                    LDQ     -131072,DU
         2 002102   204506 756100                    STQ     PSTEP,,AUTO

      878    10412    3           IF RATES_OPN

  10412  2 002103   205073 234100                    SZN     RATES_OPN,,AUTO
         2 002104   002203 605000 2                  TPL     s:10436

      879    10413    4           THEN DO;

      880    10414    4                FPT_READ.BUF_ = VECTOR(PRC_SCH_TBL);

  10414  2 002105   000035 235000 3                  LDA     29
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:155  
         2 002106   205530 452500                    STP2    DCB$+2,,AUTO
         2 002107   205530 236100                    LDQ     DCB$+2,,AUTO
         2 002110   005044 036003                    ADLQ    2596,DU
         2 002111   204336 757100                    STAQ    FPT_READ+4,,AUTO

      881    10415    4                FPT_READ.V.KEYS# = %YES#;

  10415  2 002112   200000 236007                    LDQ     65536,DL
         2 002113   204342 256100                    ORSQ    FPT_READ+8,,AUTO

      882    10416    4                FPT_READ.V.KEYR# = %NO#;

  10416  2 002114   000034 236000 3                  LDQ     28
         2 002115   204342 356100                    ANSQ    FPT_READ+8,,AUTO

      883    10417    4                CALL CONCAT(IN_KEY.KEY,'PROC',JSP.PROCNAME.C);

  10417  2 002116   040100 100400                    MLR     fill='040'O
         2 002117   001760 000004 1                  ADSC9   XSJ_PARAMC+12            cn=0,n=4
         2 002120   204117 200004                    ADSC9   IN_KEY,,AUTO             cn=1,n=4
         2 002121   040100 100500                    MLR     fill='040'O
         2 002122   000037 200037                    ADSC9   31,,PR0                  cn=1,n=31
         2 002123   204120 200037                    ADSC9   IN_KEY+1,,AUTO           cn=1,n=31

      884    10418    4                IN_KEY.LEN = 4+JSP.PROCNAME.L;

  10418  2 002124   204004 470500                    LDP0    REC$,,AUTO
         2 002125   000037 236100                    LDQ     31,,PR0
         2 002126   000033 772000                    QRL     27
         2 002127   000004 036007                    ADLQ    4,DL
         2 002130   000033 736000                    QLS     27
         2 002131   204117 552140                    STBQ    IN_KEY,'40'O,AUTO

      885    10419    4                NO_DFLT = 3;

  10419  2 002132   000003 235007                    LDA     3,DL
         2 002133   205072 755100                    STA     NO_DFLT,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:156  

      886    10420    4                CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);

  10420  2 002134   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 002135   440000 713400                    CLIMB   alt,read
         2 002136   401400 401760                    pmme    nvectors=4
         2 002137   004135 702000 2                  TSX2    DFLT_RTRY

      887    10421    5                DO WHILE('0'B);

  10421  2 002140   002153 710000 2                  TRA     s:10428

      888    10422    5   NO_PROC:          CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NOPROC);

  10422  2 002141   000040 236000 3     NO_PROC      LDQ     32
         2 002142   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002143   205524 757100                    STAQ    @ERR+1,,AUTO
         2 002144   000005 236000 3                  LDQ     5
         2 002145   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 002146   011343 701000 2                  TSX1    POST_ERR
         2 002147   000000 011000                    NOP     0

      889    10423        /*E* ERROR: AZA-E$AZ_NOPROC
      890    10424           MESSAGE: No default PROCESSOR record in :RATES.:SYS
      891    10425        */
      892    10426    5                     PRC_SCH_TBL = PRC_SCH_DFLT;

  10426  2 002150   000100 100400                    MLR     fill='000'O
         2 002151   000730 000070 1                  ADSC9   PRC_SCH_DFLT             cn=0,n=56
         2 002152   205044 000070                    ADSC9   PRC_SCH_TBL,,AUTO        cn=0,n=56

      893    10427    5                     END;

      894    10428    4                IN_KEY.LEN = 10;

  10428  2 002153   012000 236003                    LDQ     5120,DU
         2 002154   204117 552140                    STBQ    IN_KEY,'40'O,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:157  

      895    10429    4                CALL CONCAT(IN_KEY.KEY,'RATE',PRC_SCH_TBL.RTABLE#);

  10429  2 002155   040100 100400                    MLR     fill='040'O
         2 002156   001757 000004 1                  ADSC9   XSJ_PARAMC+11            cn=0,n=4
         2 002157   204117 200004                    ADSC9   IN_KEY,,AUTO             cn=1,n=4
         2 002160   040100 100500                    MLR     fill='040'O
         2 002161   205044 000006                    ADSC9   PRC_SCH_TBL,,AUTO        cn=0,n=6
         2 002162   204120 200037                    ADSC9   IN_KEY+1,,AUTO           cn=1,n=31

      896    10430    4                FPT_READ.BUF_ = VECTOR(PRT);

  10430  2 002163   000036 235000 3                  LDA     30
         2 002164   205530 452500                    STP2    DCB$+2,,AUTO
         2 002165   205530 236100                    LDQ     DCB$+2,,AUTO
         2 002166   004700 036003                    ADLQ    2496,DU
         2 002167   204336 757100                    STAQ    FPT_READ+4,,AUTO

      897    10431    4                NO_DFLT = 4;

  10431  2 002170   000004 235007                    LDA     4,DL
         2 002171   205072 755100                    STA     NO_DFLT,,AUTO

      898    10432    4                CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);

  10432  2 002172   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 002173   440000 713400                    CLIMB   alt,read
         2 002174   401400 401760                    pmme    nvectors=4
         2 002175   004135 702000 2                  TSX2    DFLT_RTRY

      899    10433    4                JSP.PRATETBLE = IN_KEY;

  10433  2 002176   204004 470500                    LDP0    REC$,,AUTO
         2 002177   000100 100500                    MLR     fill='000'O
         2 002200   204117 000013                    ADSC9   IN_KEY,,AUTO             cn=0,n=11
         2 002201   000051 600013                    ADSC9   41,,PR0                  cn=3,n=11

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:158  
      900    10434    4                END;

  10434  2 002202   002220 710000 2                  TRA     s:10447

      901    10435    4           ELSE DO;

      902    10436    5                DO WHILE('0'B);

  10436  2 002203   002213 710000 2                  TRA     s:10439

      903    10437    5   NO_RATE1:         CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NORATE);

  10437  2 002204   000037 236000 3     NO_RATE1     LDQ     31
         2 002205   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002206   205524 757100                    STAQ    @ERR+1,,AUTO
         2 002207   000005 236000 3                  LDQ     5
         2 002210   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 002211   011343 701000 2                  TSX1    POST_ERR
         2 002212   000000 011000                    NOP     0

      904    10438    5                     END;

      905    10439    4                PRT = RT_DFLT;

  10439  2 002213   000100 100400                    MLR     fill='000'O
         2 002214   000564 000614 1                  ADSC9   RT_DFLT                  cn=0,n=396
         2 002215   204700 000614                    ADSC9   PRT,,AUTO                cn=0,n=396

      906    10440    4                END;

      907    10441    3           END;

  10441  2 002216   002220 710000 2                  TRA     s:10447

      908    10442    2      ELSE
      909    10443    2           PSTEP = %NO#;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:159  
  10443  2 002217   204506 450100                    STZ     PSTEP,,AUTO

      910    10444        /***********************************
      911    10445         ****       set up STATSLEV
      912    10446         ***********************************/
      913    10447    3      DO CASE(JSP.TYPE);

  10447  2 002220   204004 470500                    LDP0    REC$,,AUTO
         2 002221   000036 220100                    LDX0    30,,PR0
         2 002222   000777 360003                    ANX0    511,DU
         2 002223   000006 100003                    CMPX0   6,DU
         2 002224   002226 602010 2                  TNC     s:10447+6,X0
         2 002225   002255 710000 2                  TRA     s:10455
         2 002226   002255 710000 2                  TRA     s:10455
         2 002227   002255 710000 2                  TRA     s:10455
         2 002230   002250 710000 2                  TRA     s:10453
         2 002231   002250 710000 2                  TRA     s:10453
         2 002232   002234 710000 2                  TRA     s:10449
         2 002233   002242 710000 2                  TRA     s:10451

      914    10448    3       CASE(%AZ$STEP);

      915    10449    3         STATSLEV = B$JIT.SSLEV;

  10449  2 002234   204007 471500                    LDP1    JIT$,,AUTO
         2 002235   100151 236100                    LDQ     105,,PR1
         2 002236   000033 772000                    QRL     27
         2 002237   000007 376007                    ANQ     7,DL
         2 002240   204503 756100                    STQ     STATSLEV,,AUTO
         2 002241   002257 710000 2                  TRA     s:10460

      916    10450    3       CASE(%AZ$PROC);

      917    10451    3         STATSLEV = B$JIT.PSLEV;

  10451  2 002242   204007 471500                    LDP1    JIT$,,AUTO
         2 002243   100151 236100                    LDQ     105,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:160  
         2 002244   000036 772000                    QRL     30
         2 002245   000007 376007                    ANQ     7,DL
         2 002246   204503 756100                    STQ     STATSLEV,,AUTO
         2 002247   002257 710000 2                  TRA     s:10460

      918    10452    3       CASE(%AZ$STATUS,%AZ$JOBEND);

      919    10453    3         STATSLEV = B$JIT.JSLEV;

  10453  2 002250   204007 471500                    LDP1    JIT$,,AUTO
         2 002251   100151 236100                    LDQ     105,,PR1
         2 002252   000041 772000                    QRL     33
         2 002253   204503 756100                    STQ     STATSLEV,,AUTO
         2 002254   002257 710000 2                  TRA     s:10460

      920    10454    3       CASE(ELSE);

      921    10455    3         STATSLEV = %AZ_NONE#;

  10455  2 002255   000003 235007                    LDA     3,DL
         2 002256   204503 755100                    STA     STATSLEV,,AUTO

      922    10456    3         END;

      923    10457        /***********************************
      924    10458         ****       set up FPT_WRITE
      925    10459         ***********************************/
      926    10460    2      IF STATSLEV ~= %AZ_NONE#

  10460  2 002257   204503 235100                    LDA     STATSLEV,,AUTO
         2 002260   000003 115007                    CMPA    3,DL
         2 002261   002333 600000 2                  TZE     s:10482

      927    10461    3      THEN DO;

      928    10462    3           FPT_WRITE.KEY_ = VECTOR(NIL);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:161  
  10462  2 002262   000026 237000 3                  LDAQ    22
         2 002263   204352 757100                    STAQ    FPT_WRITE+2,,AUTO

      929    10463    3           FPT_WRITE.BUF_ = VECTOR(OUT_BUF);

  10463  2 002264   000041 235000 3                  LDA     33
         2 002265   205530 452500                    STP2    DCB$+2,,AUTO
         2 002266   205530 236100                    LDQ     DCB$+2,,AUTO
         2 002267   005170 036003                    ADLQ    2680,DU
         2 002270   204354 757100                    STAQ    FPT_WRITE+4,,AUTO

      930    10464    3           FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB_LL;

  10464  2 002271   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 002272   100002 720100                    LXL0    2,,PR1
         2 002273   204360 740100                    STX0    FPT_WRITE+8,,AUTO

      931    10465        /***********************************
      932    10466         ****       OPEN SETDCB the M$LL DCB if not already open
      933    10467         ***********************************/
      934    10468    3           IF NOT DCBADDR(LOGOFF_PARAM.DCB_LL)->F$DCB.FCD#

  10468  2 002274   000017 473400 3                  LDP3    15
         2 002275   300000 474500                    LDP4    0,,PR3
         2 002276   100002 721100                    LXL1    2,,PR1
         2 002277   400000 475511                    LDP5    0,X1,PR4
         2 002300   500031 236100                    LDQ     25,,PR5
         2 002301   020000 316007                    CANQ    8192,DL
         2 002302   002333 601000 2                  TNZ     s:10482

      935    10469    4           THEN DO;

      936    10470    4                FPT_OPEN_LL = FPT_OPEN_LLC;

  10470  2 002303   000100 100400                    MLR     fill='000'O
         2 002304   000756 000350 1                  ADSC9   FPT_OPEN_LLC             cn=0,n=232
         2 002305   205076 000350                    ADSC9   FPT_OPEN_LL,,AUTO        cn=0,n=232
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:162  

      937    10471    4                FPT_OPEN_LL.V_ = VECTOR(FPT_OPEN_LL.V);

  10471  2 002306   000016 235000 3                  LDA     14
         2 002307   205530 452500                    STP2    DCB$+2,,AUTO
         2 002310   205530 236100                    LDQ     DCB$+2,,AUTO
         2 002311   005142 036003                    ADLQ    2658,DU
         2 002312   205076 757100                    STAQ    FPT_OPEN_LL,,AUTO

      938    10472    4                FPT_OPEN_LL.V.DCB# = LOGOFF_PARAM.DCB_LL;

  10472  2 002313   100002 721100                    LXL1    2,,PR1
         2 002314   205142 741100                    STX1    FPT_OPEN_LL+36,,AUTO

      939    10473    4                CALL M$OPEN(FPT_OPEN_LL) ALTRET(OPNLL_ALT);

  10473  2 002315   205076 630500                    EPPR0   FPT_OPEN_LL,,AUTO
         2 002316   450000 713400                    CLIMB   alt,open
         2 002317   410400 401760                    pmme    nvectors=18
         2 002320   002322 702000 2                  TSX2    OPNLL_ALT

      940    10474    5                DO WHILE('0'B);

  10474  2 002321   002333 710000 2                  TRA     s:10482

      941    10475    5   OPNLL_ALT:        CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);

  10475  2 002322   000001 236000 xsym  OPNLL_ALT    LDQ     B_VECTNIL+1
         2 002323   205525 756100                    STQ     @DCB#+1,,AUTO
         2 002324   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 002325   000042 036000 3                  ADLQ    34
         2 002326   205524 756100                    STQ     @ERR+1,,AUTO
         2 002327   000011 236000 3                  LDQ     9
         2 002330   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 002331   011343 701000 2                  TSX1    POST_ERR
         2 002332   000000 011000                    NOP     0

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:163  
      942    10476    5                     END;

      943    10477    4                END;

      944    10478    3           END;

      945    10479        /***********************************
      946    10480         ****       put out non-chargable info if needed
      947    10481         ***********************************/
      948    10482    2      IF STATSLEV=%AZ_ALL#

  10482  2 002333   204503 235100                    LDA     STATSLEV,,AUTO
         2 002334   000001 115007                    CMPA    1,DL
         2 002335   002340 601000 2                  TNZ     s:10487

      949    10483    2      THEN CALL NO_CHG;

  10483  2 002336   004217 701000 2                  TSX1    NO_CHG
         2 002337   000000 011000                    NOP     0

      950    10484        /***********************************
      951    10485         ****       put out chargable info
      952    10486         ***********************************/
      953    10487    2      FPT_TIME.TIME_ = VECTOR(OB.TIM.TIM); /* Set up for this section            */

  10487  2 002340   000043 235000 3                  LDA     35
         2 002341   205530 452500                    STP2    DCB$+2,,AUTO
         2 002342   205530 236100                    LDQ     DCB$+2,,AUTO
         2 002343   000044 036000 3                  ADLQ    36
         2 002344   204216 757100                    STAQ    FPT_TIME+4,,AUTO

      954    10488    2      CALL CHG(32,JSP.PEXEC+JSP.UEXEC+JSP.PSTIME+JSP.USTIME,F0,F0,BL_16);

  10488  2 002345   204004 470500                    LDP0    REC$,,AUTO
         2 002346   000111 236100                    LDQ     73,,PR0
         2 002347   000112 036100                    ADLQ    74,,PR0
         2 002350   000113 036100                    ADLQ    75,,PR0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:164  
         2 002351   000114 036100                    ADLQ    76,,PR0
         2 002352   205540 756100                    STQ     DCB$+10,,AUTO
         2 002353   000046 237000 3                  LDAQ    38
         2 002354   205216 757100                    STAQ    @RATE+1,,AUTO
         2 002355   000046 236000 3                  LDQ     38
         2 002356   205215 756100                    STQ     @CNT+1,,AUTO
         2 002357   205540 631500                    EPPR1   DCB$+10,,AUTO
         2 002360   205214 451500                    STP1    @IDX+1,,AUTO
         2 002361   000050 236000 3                  LDQ     40
         2 002362   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002363   005512 701000 2                  TSX1    CHG
         2 002364   000000 011000                    NOP     0

      955    10489    2      CALL CHG(5,JSP.PEXEC,RT.PEXEC#,PRT.PEXEC#,BL_16);

  10489  2 002365   000047 236000 3                  LDQ     39
         2 002366   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002367   205007 630500                    EPPR0   PRT+71,,AUTO
         2 002370   205216 450500                    STP0    @RATE+1,,AUTO
         2 002371   204643 631500                    EPPR1   RT+71,,AUTO
         2 002372   205215 451500                    STP1    @CNT+1,,AUTO
         2 002373   204004 236100                    LDQ     REC$,,AUTO
         2 002374   000111 036003                    ADLQ    73,DU
         2 002375   205214 756100                    STQ     @IDX+1,,AUTO
         2 002376   000040 236000 3                  LDQ     32
         2 002377   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002400   005512 701000 2                  TSX1    CHG
         2 002401   000000 011000                    NOP     0

      956    10490    2      CALL CHG(6,JSP.UEXEC,RT.UEXEC#,PRT.UEXEC#,BL_16);

  10490  2 002402   000047 236000 3                  LDQ     39
         2 002403   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002404   205013 630500                    EPPR0   PRT+75,,AUTO
         2 002405   205216 450500                    STP0    @RATE+1,,AUTO
         2 002406   204647 631500                    EPPR1   RT+75,,AUTO
         2 002407   205215 451500                    STP1    @CNT+1,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:165  
         2 002410   204004 236100                    LDQ     REC$,,AUTO
         2 002411   000112 036003                    ADLQ    74,DU
         2 002412   205214 756100                    STQ     @IDX+1,,AUTO
         2 002413   000010 236000 3                  LDQ     8
         2 002414   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002415   005512 701000 2                  TSX1    CHG
         2 002416   000000 011000                    NOP     0

      957    10491    2      CALL CHG(7,JSP.PSTIME,RT.PSTIME#,PRT.PSTIME#,BL_16);

  10491  2 002417   000047 236000 3                  LDQ     39
         2 002420   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002421   205011 630500                    EPPR0   PRT+73,,AUTO
         2 002422   205216 450500                    STP0    @RATE+1,,AUTO
         2 002423   204645 631500                    EPPR1   RT+73,,AUTO
         2 002424   205215 451500                    STP1    @CNT+1,,AUTO
         2 002425   204004 236100                    LDQ     REC$,,AUTO
         2 002426   000113 036003                    ADLQ    75,DU
         2 002427   205214 756100                    STQ     @IDX+1,,AUTO
         2 002430   000051 236000 3                  LDQ     41
         2 002431   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002432   005512 701000 2                  TSX1    CHG
         2 002433   000000 011000                    NOP     0

      958    10492    2      CALL CHG(8,JSP.USTIME,RT.USTIME#,PRT.USTIME#,BL_16);

  10492  2 002434   000047 236000 3                  LDQ     39
         2 002435   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002436   205015 630500                    EPPR0   PRT+77,,AUTO
         2 002437   205216 450500                    STP0    @RATE+1,,AUTO
         2 002440   204651 631500                    EPPR1   RT+77,,AUTO
         2 002441   205215 451500                    STP1    @CNT+1,,AUTO
         2 002442   204004 236100                    LDQ     REC$,,AUTO
         2 002443   000114 036003                    ADLQ    76,DU
         2 002444   205214 756100                    STQ     @IDX+1,,AUTO
         2 002445   000052 236000 3                  LDQ     42
         2 002446   205213 756100                    STQ     OUT_BUF+19,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:166  
         2 002447   005512 701000 2                  TSX1    CHG
         2 002450   000000 011000                    NOP     0

      959    10493    2      CALL CHG(4,JSP.CONNECT,RT.CONNECT#,PRT.CONNECT#,BL_16);

  10493  2 002451   000047 236000 3                  LDQ     39
         2 002452   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002453   205037 630500                    EPPR0   PRT+95,,AUTO
         2 002454   205216 450500                    STP0    @RATE+1,,AUTO
         2 002455   204673 631500                    EPPR1   RT+95,,AUTO
         2 002456   205215 451500                    STP1    @CNT+1,,AUTO
         2 002457   204004 236100                    LDQ     REC$,,AUTO
         2 002460   000100 036003                    ADLQ    64,DU
         2 002461   205214 756100                    STQ     @IDX+1,,AUTO
         2 002462   000037 236000 3                  LDQ     31
         2 002463   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002464   005512 701000 2                  TSX1    CHG
         2 002465   000000 011000                    NOP     0

      960    10494    2      CALL CHG(3,JSP.TINTER,RT.TINTER#,PRT.TINTER#,BL_16);

  10494  2 002466   000047 236000 3                  LDQ     39
         2 002467   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002470   204765 630500                    EPPR0   PRT+53,,AUTO
         2 002471   205216 450500                    STP0    @RATE+1,,AUTO
         2 002472   204621 631500                    EPPR1   RT+53,,AUTO
         2 002473   205215 451500                    STP1    @CNT+1,,AUTO
         2 002474   204004 236100                    LDQ     REC$,,AUTO
         2 002475   000107 036003                    ADLQ    71,DU
         2 002476   205214 756100                    STQ     @IDX+1,,AUTO
         2 002477   000005 236000 3                  LDQ     5
         2 002500   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002501   005512 701000 2                  TSX1    CHG
         2 002502   000000 011000                    NOP     0

      961    10495    2      IF JSP.TYPE~=%AZ$PROC

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:167  
  10495  2 002503   204004 470500                    LDP0    REC$,,AUTO
         2 002504   000036 236100                    LDQ     30,,PR0
         2 002505   000777 376003                    ANQ     511,DU
         2 002506   000005 116003                    CMPQ    5,DU
         2 002507   002534 600000 2                  TZE     s:10502

      962    10496    3      THEN DO;                             /* Don't charge for steps if %AZ$PROC */

      963    10497    3           IF JSP.TYPE=%AZ$STEP

  10497  2 002510   000004 116003                    CMPQ    4,DU
         2 002511   002515 601000 2                  TNZ     s:10499

      964    10498    3           THEN T = 1;

  10498  2 002512   000001 235007                    LDA     1,DL
         2 002513   204504 755100                    STA     T,,AUTO
         2 002514   002520 710000 2                  TRA     s:10500

      965    10499    3           ELSE T = JSP.STEP;

  10499  2 002515   000056 236100                    LDQ     46,,PR0
         2 002516   000022 732000                    QRS     18
         2 002517   204504 756100                    STQ     T,,AUTO

      966    10500    3           CALL CHG(0,T,RT.JSTEPS#,PRT.JSTEPS#,BL_16);

  10500  2 002520   000047 236000 3                  LDQ     39
         2 002521   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002522   204763 631500                    EPPR1   PRT+51,,AUTO
         2 002523   205216 451500                    STP1    @RATE+1,,AUTO
         2 002524   204617 633500                    EPPR3   RT+51,,AUTO
         2 002525   205215 453500                    STP3    @CNT+1,,AUTO
         2 002526   204504 634500                    EPPR4   T,,AUTO
         2 002527   205214 454500                    STP4    @IDX+1,,AUTO
         2 002530   000000 236000 3                  LDQ     0
         2 002531   205213 756100                    STQ     OUT_BUF+19,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:168  
         2 002532   005512 701000 2                  TSX1    CHG
         2 002533   000000 011000                    NOP     0

      967    10501    3           END;

      968    10502    2      CALL CHG(1,JSP.PMMES,RT.PMMES#,PRT.PMMES#,BL_16);

  10502  2 002534   000047 236000 3                  LDQ     39
         2 002535   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002536   204777 630500                    EPPR0   PRT+63,,AUTO
         2 002537   205216 450500                    STP0    @RATE+1,,AUTO
         2 002540   204633 631500                    EPPR1   RT+63,,AUTO
         2 002541   205215 451500                    STP1    @CNT+1,,AUTO
         2 002542   204004 236100                    LDQ     REC$,,AUTO
         2 002543   000110 036003                    ADLQ    72,DU
         2 002544   205214 756100                    STQ     @IDX+1,,AUTO
         2 002545   000011 236000 3                  LDQ     9
         2 002546   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002547   005512 701000 2                  TSX1    CHG
         2 002550   000000 011000                    NOP     0

      969    10503    2      CALL CHG(9,JSP.PMEMTIM,RT.PMEM#,PRT.PMEM#,BL_16);

  10503  2 002551   000047 236000 3                  LDQ     39
         2 002552   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002553   205033 630500                    EPPR0   PRT+91,,AUTO
         2 002554   205216 450500                    STP0    @RATE+1,,AUTO
         2 002555   204667 631500                    EPPR1   RT+91,,AUTO
         2 002556   205215 451500                    STP1    @CNT+1,,AUTO
         2 002557   204004 236100                    LDQ     REC$,,AUTO
         2 002560   000070 036003                    ADLQ    56,DU
         2 002561   205214 756100                    STQ     @IDX+1,,AUTO
         2 002562   000053 236000 3                  LDQ     43
         2 002563   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002564   005512 701000 2                  TSX1    CHG
         2 002565   000000 011000                    NOP     0

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:169  
      970    10504    2      CALL CHG(10,JSP.UMEMTIM,RT.UMEM#,PRT.UMEM#,BL_16);

  10504  2 002566   000047 236000 3                  LDQ     39
         2 002567   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002570   205035 630500                    EPPR0   PRT+93,,AUTO
         2 002571   205216 450500                    STP0    @RATE+1,,AUTO
         2 002572   204671 631500                    EPPR1   RT+93,,AUTO
         2 002573   205215 451500                    STP1    @CNT+1,,AUTO
         2 002574   204004 236100                    LDQ     REC$,,AUTO
         2 002575   000071 036003                    ADLQ    57,DU
         2 002576   205214 756100                    STQ     @IDX+1,,AUTO
         2 002577   000054 236000 3                  LDQ     44
         2 002600   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002601   005512 701000 2                  TSX1    CHG
         2 002602   000000 011000                    NOP     0

      971    10505    2      IF JSP.CODE=%AZ$JSP

  10505  2 002603   204004 470500                    LDP0    REC$,,AUTO
         2 002604   000000 236100                    LDQ     0,,PR0
         2 002605   777000 376003                    ANQ     -512,DU
         2 002606   001000 116003                    CMPQ    512,DU
         2 002607   002626 601000 2                  TNZ     s:10507

      972    10506    2      THEN CALL CHG(11,JSP.UFTPS,RT.TPACK#,PRT.TPACK#,BL_16);

  10506  2 002610   000047 236000 3                  LDQ     39
         2 002611   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002612   205041 631500                    EPPR1   PRT+97,,AUTO
         2 002613   205216 451500                    STP1    @RATE+1,,AUTO
         2 002614   204675 633500                    EPPR3   RT+97,,AUTO
         2 002615   205215 453500                    STP3    @CNT+1,,AUTO
         2 002616   204004 236100                    LDQ     REC$,,AUTO
         2 002617   000067 036003                    ADLQ    55,DU
         2 002620   205214 756100                    STQ     @IDX+1,,AUTO
         2 002621   000055 236000 3                  LDQ     45
         2 002622   205213 756100                    STQ     OUT_BUF+19,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:170  
         2 002623   005512 701000 2                  TSX1    CHG
         2 002624   000000 011000                    NOP     0
         2 002625   002643 710000 2                  TRA     s:10508

      973    10507    2      ELSE CALL CHG(2,JSP.UFTPS,RT.FEPINT#,PRT.FEPINT#,BL_16);

  10507  2 002626   000047 236000 3                  LDQ     39
         2 002627   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002630   204767 631500                    EPPR1   PRT+55,,AUTO
         2 002631   205216 451500                    STP1    @RATE+1,,AUTO
         2 002632   204623 633500                    EPPR3   RT+55,,AUTO
         2 002633   205215 453500                    STP3    @CNT+1,,AUTO
         2 002634   204004 236100                    LDQ     REC$,,AUTO
         2 002635   000067 036003                    ADLQ    55,DU
         2 002636   205214 756100                    STQ     @IDX+1,,AUTO
         2 002637   000012 236000 3                  LDQ     10
         2 002640   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002641   005512 701000 2                  TSX1    CHG
         2 002642   000000 011000                    NOP     0

      974    10508    2      CALL CHG(12,JSP.MTTIM_CPU,RT.TCPU#,PRT.TCPU#,BL_16);

  10508  2 002643   000047 236000 3                  LDQ     39
         2 002644   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002645   205021 630500                    EPPR0   PRT+81,,AUTO
         2 002646   205216 450500                    STP0    @RATE+1,,AUTO
         2 002647   204655 631500                    EPPR1   RT+81,,AUTO
         2 002650   205215 451500                    STP1    @CNT+1,,AUTO
         2 002651   204004 236100                    LDQ     REC$,,AUTO
         2 002652   000075 036003                    ADLQ    61,DU
         2 002653   205214 756100                    STQ     @IDX+1,,AUTO
         2 002654   000057 236000 3                  LDQ     47
         2 002655   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002656   005512 701000 2                  TSX1    CHG
         2 002657   000000 011000                    NOP     0

      975    10509    2      CALL CHG(13,JSP.MTTIM_CLK,RT.TCLOCK#,PRT.TCLOCK#,BL_16);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:171  

  10509  2 002660   000047 236000 3                  LDQ     39
         2 002661   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002662   205027 630500                    EPPR0   PRT+87,,AUTO
         2 002663   205216 450500                    STP0    @RATE+1,,AUTO
         2 002664   204663 631500                    EPPR1   RT+87,,AUTO
         2 002665   205215 451500                    STP1    @CNT+1,,AUTO
         2 002666   204004 236100                    LDQ     REC$,,AUTO
         2 002667   000072 036003                    ADLQ    58,DU
         2 002670   205214 756100                    STQ     @IDX+1,,AUTO
         2 002671   000061 236000 3                  LDQ     49
         2 002672   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002673   005512 701000 2                  TSX1    CHG
         2 002674   000000 011000                    NOP     0

      976    10510    2      CALL CHG(14,JSP.DPTIM_CPU,RT.FCPU#,PRT.FCPU#,BL_16);

  10510  2 002675   000047 236000 3                  LDQ     39
         2 002676   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002677   205017 630500                    EPPR0   PRT+79,,AUTO
         2 002700   205216 450500                    STP0    @RATE+1,,AUTO
         2 002701   204653 631500                    EPPR1   RT+79,,AUTO
         2 002702   205215 451500                    STP1    @CNT+1,,AUTO
         2 002703   204004 236100                    LDQ     REC$,,AUTO
         2 002704   000076 036003                    ADLQ    62,DU
         2 002705   205214 756100                    STQ     @IDX+1,,AUTO
         2 002706   000063 236000 3                  LDQ     51
         2 002707   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002710   005512 701000 2                  TSX1    CHG
         2 002711   000000 011000                    NOP     0

      977    10511    2      CALL CHG(15,JSP.DPTIM_CLK,RT.FCLOCK#,PRT.FCLOCK#,BL_16);

  10511  2 002712   000047 236000 3                  LDQ     39
         2 002713   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002714   205025 630500                    EPPR0   PRT+85,,AUTO
         2 002715   205216 450500                    STP0    @RATE+1,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:172  
         2 002716   204661 631500                    EPPR1   RT+85,,AUTO
         2 002717   205215 451500                    STP1    @CNT+1,,AUTO
         2 002720   204004 236100                    LDQ     REC$,,AUTO
         2 002721   000073 036003                    ADLQ    59,DU
         2 002722   205214 756100                    STQ     @IDX+1,,AUTO
         2 002723   000065 236000 3                  LDQ     53
         2 002724   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002725   005512 701000 2                  TSX1    CHG
         2 002726   000000 011000                    NOP     0

      978    10512    2      CALL CHG(16,JSP.ORTIM_CPU,RT.OCPU#,PRT.OCPU#,BL_16);

  10512  2 002727   000047 236000 3                  LDQ     39
         2 002730   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002731   205023 630500                    EPPR0   PRT+83,,AUTO
         2 002732   205216 450500                    STP0    @RATE+1,,AUTO
         2 002733   204657 631500                    EPPR1   RT+83,,AUTO
         2 002734   205215 451500                    STP1    @CNT+1,,AUTO
         2 002735   204004 236100                    LDQ     REC$,,AUTO
         2 002736   000077 036003                    ADLQ    63,DU
         2 002737   205214 756100                    STQ     @IDX+1,,AUTO
         2 002740   000067 236000 3                  LDQ     55
         2 002741   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002742   005512 701000 2                  TSX1    CHG
         2 002743   000000 011000                    NOP     0

      979    10513    2      CALL CHG(17,JSP.ORTIM_CLK,RT.OCLOCK#,PRT.OCLOCK#,BL_16);

  10513  2 002744   000047 236000 3                  LDQ     39
         2 002745   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002746   205031 630500                    EPPR0   PRT+89,,AUTO
         2 002747   205216 450500                    STP0    @RATE+1,,AUTO
         2 002750   204665 631500                    EPPR1   RT+89,,AUTO
         2 002751   205215 451500                    STP1    @CNT+1,,AUTO
         2 002752   204004 236100                    LDQ     REC$,,AUTO
         2 002753   000074 036003                    ADLQ    60,DU
         2 002754   205214 756100                    STQ     @IDX+1,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:173  
         2 002755   000071 236000 3                  LDQ     57
         2 002756   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002757   005512 701000 2                  TSX1    CHG
         2 002760   000000 011000                    NOP     0

      980    10514    2      CALL CHG(18,JSP.MTACCESS,RT.TACCESS#,PRT.TACCESS#,BL_16);

  10514  2 002761   000047 236000 3                  LDQ     39
         2 002762   205217 756100                    STQ     @PRATE+1,,AUTO
         2 002763   205003 630500                    EPPR0   PRT+67,,AUTO
         2 002764   205216 450500                    STP0    @RATE+1,,AUTO
         2 002765   204637 631500                    EPPR1   RT+67,,AUTO
         2 002766   205215 451500                    STP1    @CNT+1,,AUTO
         2 002767   204004 236100                    LDQ     REC$,,AUTO
         2 002770   000101 036003                    ADLQ    65,DU
         2 002771   205214 756100                    STQ     @IDX+1,,AUTO
         2 002772   000073 236000 3                  LDQ     59
         2 002773   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 002774   005512 701000 2                  TSX1    CHG
         2 002775   000000 011000                    NOP     0

      981    10515    2      CALL CHG(19,JSP.DPACCESS,RT.FACCESS#,PRT.FACCESS#,BL_16);

  10515  2 002776   000047 236000 3                  LDQ     39
         2 002777   205217 756100                    STQ     @PRATE+1,,AUTO
         2 003000   205001 630500                    EPPR0   PRT+65,,AUTO
         2 003001   205216 450500                    STP0    @RATE+1,,AUTO
         2 003002   204635 631500                    EPPR1   RT+65,,AUTO
         2 003003   205215 451500                    STP1    @CNT+1,,AUTO
         2 003004   204004 236100                    LDQ     REC$,,AUTO
         2 003005   000102 036003                    ADLQ    66,DU
         2 003006   205214 756100                    STQ     @IDX+1,,AUTO
         2 003007   000075 236000 3                  LDQ     61
         2 003010   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 003011   005512 701000 2                  TSX1    CHG
         2 003012   000000 011000                    NOP     0

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:174  
      982    10516    2      CALL CHG(20,JSP.ORACCESS,RT.OACCESS#,PRT.OACCESS#,BL_16);

  10516  2 003013   000047 236000 3                  LDQ     39
         2 003014   205217 756100                    STQ     @PRATE+1,,AUTO
         2 003015   205005 630500                    EPPR0   PRT+69,,AUTO
         2 003016   205216 450500                    STP0    @RATE+1,,AUTO
         2 003017   204641 631500                    EPPR1   RT+69,,AUTO
         2 003020   205215 451500                    STP1    @CNT+1,,AUTO
         2 003021   204004 236100                    LDQ     REC$,,AUTO
         2 003022   000103 036003                    ADLQ    67,DU
         2 003023   205214 756100                    STQ     @IDX+1,,AUTO
         2 003024   000077 236000 3                  LDQ     63
         2 003025   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 003026   005512 701000 2                  TSX1    CHG
         2 003027   000000 011000                    NOP     0

      983    10517    2      CALL CHG(21,JSP.MTMOUNT,RT.TMOUNT#,PRT.TMOUNT#,BL_16);

  10517  2 003030   000047 236000 3                  LDQ     39
         2 003031   205217 756100                    STQ     @PRATE+1,,AUTO
         2 003032   204773 630500                    EPPR0   PRT+59,,AUTO
         2 003033   205216 450500                    STP0    @RATE+1,,AUTO
         2 003034   204627 631500                    EPPR1   RT+59,,AUTO
         2 003035   205215 451500                    STP1    @CNT+1,,AUTO
         2 003036   204004 236100                    LDQ     REC$,,AUTO
         2 003037   000104 036003                    ADLQ    68,DU
         2 003040   205214 756100                    STQ     @IDX+1,,AUTO
         2 003041   000101 236000 3                  LDQ     65
         2 003042   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 003043   005512 701000 2                  TSX1    CHG
         2 003044   000000 011000                    NOP     0

      984    10518    2      CALL CHG(22,JSP.DPMOUNT,RT.FMOUNT#,PRT.FMOUNT#,BL_16);

  10518  2 003045   000047 236000 3                  LDQ     39
         2 003046   205217 756100                    STQ     @PRATE+1,,AUTO
         2 003047   204771 630500                    EPPR0   PRT+57,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:175  
         2 003050   205216 450500                    STP0    @RATE+1,,AUTO
         2 003051   204625 631500                    EPPR1   RT+57,,AUTO
         2 003052   205215 451500                    STP1    @CNT+1,,AUTO
         2 003053   204004 236100                    LDQ     REC$,,AUTO
         2 003054   000105 036003                    ADLQ    69,DU
         2 003055   205214 756100                    STQ     @IDX+1,,AUTO
         2 003056   000103 236000 3                  LDQ     67
         2 003057   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 003060   005512 701000 2                  TSX1    CHG
         2 003061   000000 011000                    NOP     0

      985    10519    2      CALL CHG(23,JSP.ORMOUNT,RT.OMOUNT#,PRT.OMOUNT#,BL_16);

  10519  2 003062   000047 236000 3                  LDQ     39
         2 003063   205217 756100                    STQ     @PRATE+1,,AUTO
         2 003064   204775 630500                    EPPR0   PRT+61,,AUTO
         2 003065   205216 450500                    STP0    @RATE+1,,AUTO
         2 003066   204631 631500                    EPPR1   RT+61,,AUTO
         2 003067   205215 451500                    STP1    @CNT+1,,AUTO
         2 003070   204004 236100                    LDQ     REC$,,AUTO
         2 003071   000106 036003                    ADLQ    70,DU
         2 003072   205214 756100                    STQ     @IDX+1,,AUTO
         2 003073   000105 236000 3                  LDQ     69
         2 003074   205213 756100                    STQ     OUT_BUF+19,,AUTO
         2 003075   005512 701000 2                  TSX1    CHG
         2 003076   000000 011000                    NOP     0

      986    10520    2      IF JSP.TYPE=%AZ$PROC

  10520  2 003077   204004 470500                    LDP0    REC$,,AUTO
         2 003100   000036 236100                    LDQ     30,,PR0
         2 003101   000777 376003                    ANQ     511,DU
         2 003102   000005 116003                    CMPQ    5,DU
         2 003103   003144 601000 2                  TNZ     s:10525

      987    10521    3      THEN DO I=0 TO 3;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:176  
  10521  2 003104   204505 450100                    STZ     I,,AUTO

      988    10522    3           T = JSP.JSUNITS(I);

  10522  2 003105   204505 235100                    LDA     I,,AUTO
         2 003106   000001 735000                    ALS     1
         2 003107   204004 470500                    LDP0    REC$,,AUTO
         2 003110   000100 100505                    MLR     fill='000'O
         2 003111   000115 000002                    ADSC9   77,A,PR0                 cn=0,n=2
         2 003112   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 003113   205530 236100                    LDQ     DCB$+2,,AUTO
         2 003114   000022 732000                    QRS     18
         2 003115   204504 756100                    STQ     T,,AUTO

      989    10523    3           CALL CHG(24+I,T,F0,PRT.SUNIT.RATE#(I),PRT.SUNIT.NAME#(I));

  10523  2 003116   204505 235100                    LDA     I,,AUTO
         2 003117   000030 035007                    ADLA    24,DL
         2 003120   205541 755100                    STA     DCB$+11,,AUTO
         2 003121   204505 236100                    LDQ     I,,AUTO
         2 003122   000006 402007                    MPY     6,DL
         2 003123   204731 631506                    EPPR1   PRT+25,QL,AUTO
         2 003124   205217 451500                    STP1    @PRATE+1,,AUTO
         2 003125   204735 633506                    EPPR3   PRT+29,QL,AUTO
         2 003126   205216 453500                    STP3    @RATE+1,,AUTO
         2 003127   000046 236000 3                  LDQ     38
         2 003130   205215 756100                    STQ     @CNT+1,,AUTO
         2 003131   204504 634500                    EPPR4   T,,AUTO
         2 003132   205214 454500                    STP4    @IDX+1,,AUTO
         2 003133   205541 635500                    EPPR5   DCB$+11,,AUTO
         2 003134   205213 455500                    STP5    OUT_BUF+19,,AUTO
         2 003135   005512 701000 2                  TSX1    CHG
         2 003136   000000 011000                    NOP     0

      990    10524    3           END;

  10524  2 003137   204505 054100                    AOS     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:177  
         2 003140   204505 235100                    LDA     I,,AUTO
         2 003141   000003 115007                    CMPA    3,DL
         2 003142   003105 604400 2                  TMOZ    s:10522
         2 003143   003271 710000 2                  TRA     s:10542

      991    10525    2      ELSE IF JSP.TYPE=%AZ$STEP

  10525  2 003144   000004 116003                    CMPQ    4,DU
         2 003145   003210 601000 2                  TNZ     s:10531

      992    10526    3           THEN DO I=0 TO 3;

  10526  2 003146   204505 450100                    STZ     I,,AUTO

      993    10527    3                T = JSP.JSUNITS(I);

  10527  2 003147   204505 235100                    LDA     I,,AUTO
         2 003150   000001 735000                    ALS     1
         2 003151   204004 470500                    LDP0    REC$,,AUTO
         2 003152   000100 100505                    MLR     fill='000'O
         2 003153   000115 000002                    ADSC9   77,A,PR0                 cn=0,n=2
         2 003154   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 003155   205530 236100                    LDQ     DCB$+2,,AUTO
         2 003156   000022 732000                    QRS     18
         2 003157   204504 756100                    STQ     T,,AUTO

      994    10528    3                CALL CHG(24+I,T,RT.SUNIT.RATE#(I),F0,RT.SUNIT.NAME#(I));

  10528  2 003160   204505 235100                    LDA     I,,AUTO
         2 003161   000030 035007                    ADLA    24,DL
         2 003162   205542 755100                    STA     DCB$+12,,AUTO
         2 003163   204505 236100                    LDQ     I,,AUTO
         2 003164   000006 402007                    MPY     6,DL
         2 003165   204565 631506                    EPPR1   RT+25,QL,AUTO
         2 003166   205217 451500                    STP1    @PRATE+1,,AUTO
         2 003167   000046 236000 3                  LDQ     38
         2 003170   205216 756100                    STQ     @RATE+1,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:178  
         2 003171   204505 236100                    LDQ     I,,AUTO
         2 003172   000006 402007                    MPY     6,DL
         2 003173   204571 633506                    EPPR3   RT+29,QL,AUTO
         2 003174   205215 453500                    STP3    @CNT+1,,AUTO
         2 003175   204504 634500                    EPPR4   T,,AUTO
         2 003176   205214 454500                    STP4    @IDX+1,,AUTO
         2 003177   205542 635500                    EPPR5   DCB$+12,,AUTO
         2 003200   205213 455500                    STP5    OUT_BUF+19,,AUTO
         2 003201   005512 701000 2                  TSX1    CHG
         2 003202   000000 011000                    NOP     0

      995    10529    3                END;

  10529  2 003203   204505 054100                    AOS     I,,AUTO
         2 003204   204505 235100                    LDA     I,,AUTO
         2 003205   000003 115007                    CMPA    3,DL
         2 003206   003147 604400 2                  TMOZ    s:10527
         2 003207   003271 710000 2                  TRA     s:10542

      996    10530    3           ELSE DO;

      997    10531    4                DO I=0 TO 3;

  10531  2 003210   204505 450100                    STZ     I,,AUTO

      998    10532    4                     CALL CHG(24+I,0,F0,F0,BL_16);

  10532  2 003211   204505 235100                    LDA     I,,AUTO
         2 003212   000030 035007                    ADLA    24,DL
         2 003213   205543 755100                    STA     DCB$+13,,AUTO
         2 003214   000046 237000 3                  LDAQ    38
         2 003215   205216 757100                    STAQ    @RATE+1,,AUTO
         2 003216   000106 237000 3                  LDAQ    70
         2 003217   205214 757100                    STAQ    @IDX+1,,AUTO
         2 003220   205543 630500                    EPPR0   DCB$+13,,AUTO
         2 003221   205213 450500                    STP0    OUT_BUF+19,,AUTO
         2 003222   005512 701000 2                  TSX1    CHG
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:179  
         2 003223   000000 011000                    NOP     0

      999    10533    4                     END;

  10533  2 003224   204505 054100                    AOS     I,,AUTO
         2 003225   204505 235100                    LDA     I,,AUTO
         2 003226   000003 115007                    CMPA    3,DL
         2 003227   003211 604400 2                  TMOZ    s:10532

     1000    10534    4                DO I=0 TO 3;

  10534  2 003230   204505 450100                    STZ     I,,AUTO

     1001    10535    4                     T = JSP.JSUNITS(I);

  10535  2 003231   204505 235100                    LDA     I,,AUTO
         2 003232   000001 735000                    ALS     1
         2 003233   204004 470500                    LDP0    REC$,,AUTO
         2 003234   000100 100505                    MLR     fill='000'O
         2 003235   000115 000002                    ADSC9   77,A,PR0                 cn=0,n=2
         2 003236   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 003237   205530 236100                    LDQ     DCB$+2,,AUTO
         2 003240   000022 732000                    QRS     18
         2 003241   204504 756100                    STQ     T,,AUTO

     1002    10536    4                     CALL CHG(28+I,T,RT.JUNIT.RATE#(I),F0,RT.JUNIT.NAME#(I));

  10536  2 003242   204505 235100                    LDA     I,,AUTO
         2 003243   000034 035007                    ADLA    28,DL
         2 003244   205544 755100                    STA     DCB$+14,,AUTO
         2 003245   204505 236100                    LDQ     I,,AUTO
         2 003246   000006 402007                    MPY     6,DL
         2 003247   204535 631506                    EPPR1   RT+1,QL,AUTO
         2 003250   205217 451500                    STP1    @PRATE+1,,AUTO
         2 003251   000046 236000 3                  LDQ     38
         2 003252   205216 756100                    STQ     @RATE+1,,AUTO
         2 003253   204505 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:180  
         2 003254   000006 402007                    MPY     6,DL
         2 003255   204541 633506                    EPPR3   RT+5,QL,AUTO
         2 003256   205215 453500                    STP3    @CNT+1,,AUTO
         2 003257   204504 634500                    EPPR4   T,,AUTO
         2 003260   205214 454500                    STP4    @IDX+1,,AUTO
         2 003261   205544 635500                    EPPR5   DCB$+14,,AUTO
         2 003262   205213 455500                    STP5    OUT_BUF+19,,AUTO
         2 003263   005512 701000 2                  TSX1    CHG
         2 003264   000000 011000                    NOP     0

     1003    10537    4                     END;

  10537  2 003265   204505 054100                    AOS     I,,AUTO
         2 003266   204505 235100                    LDA     I,,AUTO
         2 003267   000003 115007                    CMPA    3,DL
         2 003270   003231 604400 2                  TMOZ    s:10535

     1004    10538    3                END;

     1005    10539        /***********************************
     1006    10540         ****       charge for FORM usage
     1007    10541         ***********************************/
     1008    10542    2      IN_KEY = '020'O;                     /* To cause the test for correct      */

  10542  2 003271   000100 100400                    MLR     fill='000'O
         2 003272   000110 000001 3                  ADSC9   72                       cn=0,n=1
         2 003273   204117 000044                    ADSC9   IN_KEY,,AUTO             cn=0,n=36

     1009    10543                                                /* FORMNAME to fail first time        */
     1010    10544                                                /* and set IN_KEY.LEN to 16           */
     1011    10545    2      FORM_START = %YES#;

  10545  2 003274   400000 236003                    LDQ     -131072,DU
         2 003275   204507 756100                    STQ     FORM_START,,AUTO

     1012    10546    2      FRM$ = PINCRW(REC$,JSP.FORMX);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:181  
  10546  2 003276   204004 470500                    LDP0    REC$,,AUTO
         2 003277   000137 236100                    LDQ     95,,PR0
         2 003300   000022 736000                    QLS     18
         2 003301   204004 036100                    ADLQ    REC$,,AUTO
         2 003302   205074 756100                    STQ     FRM$,,AUTO

     1013    10547    2      FPT_READ.BUF_ = VECTOR(FORM_TBL);

  10547  2 003303   000022 235000 3                  LDA     18
         2 003304   205530 452500                    STP2    DCB$+2,,AUTO
         2 003305   205530 236100                    LDQ     DCB$+2,,AUTO
         2 003306   005062 036003                    ADLQ    2610,DU
         2 003307   204336 757100                    STAQ    FPT_READ+4,,AUTO

     1014    10548    2      FPT_READ.V.KEYS# = %YES#;

  10548  2 003310   200000 236007                    LDQ     65536,DL
         2 003311   204342 256100                    ORSQ    FPT_READ+8,,AUTO

     1015    10549    2      FPT_READ.V.KEYR# = %NO#;

  10549  2 003312   000034 236000 3                  LDQ     28
         2 003313   204342 356100                    ANSQ    FPT_READ+8,,AUTO

     1016    10550    2      NO_DFLT = 5;

  10550  2 003314   000005 235007                    LDA     5,DL
         2 003315   205072 755100                    STA     NO_DFLT,,AUTO

     1017    10551    3      DO I=0 TO JSP.FORM_CNT-1;

  10551  2 003316   204505 450100                    STZ     I,,AUTO
         2 003317   003637 710000 2                  TRA     s:10610+1

     1018    10552    3           IF RATES_OPN

  10552  2 003320   205073 234100                    SZN     RATES_OPN,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:182  
         2 003321   003346 605000 2                  TPL     s:10559

     1019    10553    4           THEN DO;

     1020    10554    4                CALL CONCAT(IN_KEY.KEY,'FORM',FRM.S1.FORMNAME(I));

  10554  2 003322   040100 100400                    MLR     fill='040'O
         2 003323   001761 000004 1                  ADSC9   XSJ_PARAMC+13            cn=0,n=4
         2 003324   204117 200004                    ADSC9   IN_KEY,,AUTO             cn=1,n=4
         2 003325   204505 236100                    LDQ     I,,AUTO
         2 003326   000064 402007                    MPY     52,DL
         2 003327   205074 470500                    LDP0    FRM$,,AUTO
         2 003330   040100 100506                    MLR     fill='040'O
         2 003331   000002 000014                    ADSC9   2,Q,PR0                  cn=0,n=12
         2 003332   204120 200037                    ADSC9   IN_KEY+1,,AUTO           cn=1,n=31

     1021    10555    4                CALL M$READ(FPT_READ) ALTRET(DFLT_RTRY);

  10555  2 003333   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 003334   440000 713400                    CLIMB   alt,read
         2 003335   401400 401760                    pmme    nvectors=4
         2 003336   004135 702000 2                  TSX2    DFLT_RTRY

     1022    10556    4                FRM.RATETBLE(I) = IN_KEY;

  10556  2 003337   204505 236100                    LDQ     I,,AUTO
         2 003340   000064 402007                    MPY     52,DL
         2 003341   205074 470500                    LDP0    FRM$,,AUTO
         2 003342   000106 100500                    MLR     fill='000'O
         2 003343   204117 000021                    ADSC9   IN_KEY,,AUTO             cn=0,n=17
         2 003344   000010 000021                    ADSC9   8,Q,PR0                  cn=0,n=17

     1023    10557    4                END;

  10557  2 003345   003361 710000 2                  TRA     s:10567

     1024    10558    4           ELSE DO;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:183  

     1025    10559    5                DO WHILE('0'B);

  10559  2 003346   003356 710000 2                  TRA     s:10565

     1026    10560    5   NO_FORM:          CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_NOFORM);

  10560  2 003347   000010 236000 3     NO_FORM      LDQ     8
         2 003350   000001 235000 xsym               LDA     B_VECTNIL+1
         2 003351   205524 757100                    STAQ    @ERR+1,,AUTO
         2 003352   000005 236000 3                  LDQ     5
         2 003353   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 003354   011343 701000 2                  TSX1    POST_ERR
         2 003355   000000 011000                    NOP     0

     1027    10561        /*E* ERROR: AZA-E$AZ_NOFORM
     1028    10562           MESSAGE: No default FORM record in :RATES.:SYS
     1029    10563        */
     1030    10564    5                     END;

     1031    10565    4                FORM_TBL = FORM_DFLT;

  10565  2 003356   000100 100400                    MLR     fill='000'O
         2 003357   000746 000040 1                  ADSC9   FORM_DFLT                cn=0,n=32
         2 003360   205062 000040                    ADSC9   FORM_TBL,,AUTO           cn=0,n=32

     1032    10566    4                END;

     1033    10567    3           MNTS = FRM.MOUNTS(I);

  10567  2 003361   204505 236100                    LDQ     I,,AUTO
         2 003362   000015 402007                    MPY     13,DL
         2 003363   205074 470500                    LDP0    FRM$,,AUTO
         2 003364   000001 235106                    LDA     1,QL,PR0
         2 003365   204532 755100                    STA     MNTS,,AUTO

     1034    10568    3           CALL AZB$MTH3D2B(CHG1,F1,RT.CMULT#,FORM_TBL.FMOUNT#,MNTS,1,'0'B);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:184  

  10568  2 003366   000000 236000 3                  LDQ     0
         2 003367   205536 756100                    STQ     DCB$+8,,AUTO
         2 003370   000011 236000 3                  LDQ     9
         2 003371   205535 756100                    STQ     DCB$+7,,AUTO
         2 003372   204532 631500                    EPPR1   MNTS,,AUTO
         2 003373   205534 451500                    STP1    DCB$+6,,AUTO
         2 003374   205064 633500                    EPPR3   FORM_TBL+2,,AUTO
         2 003375   205533 453500                    STP3    DCB$+5,,AUTO
         2 003376   204615 634500                    EPPR4   RT+49,,AUTO
         2 003377   205532 454500                    STP4    DCB$+4,,AUTO
         2 003400   000111 236000 3                  LDQ     73
         2 003401   205531 756100                    STQ     DCB$+3,,AUTO
         2 003402   204527 635500                    EPPR5   CHG1,,AUTO
         2 003403   205530 455500                    STP5    DCB$+2,,AUTO
         2 003404   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 003405   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 003406   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 003407   000000 011000                    NOP     0

     1035    10569    3           CALL AZB$MTH3D2B(CHG2,F1,RT.CMULT#,FORM_TBL.FORM#,FRM.FORMS(I),1,'0'B);

  10569  2 003410   000000 236000 3                  LDQ     0
         2 003411   205536 756100                    STQ     DCB$+8,,AUTO
         2 003412   000011 236000 3                  LDQ     9
         2 003413   205535 756100                    STQ     DCB$+7,,AUTO
         2 003414   204505 236100                    LDQ     I,,AUTO
         2 003415   000015 402003                    MPY     13,DU
         2 003416   205074 036100                    ADLQ    FRM$,,AUTO
         2 003417   205534 756100                    STQ     DCB$+6,,AUTO
         2 003420   205062 630500                    EPPR0   FORM_TBL,,AUTO
         2 003421   205533 450500                    STP0    DCB$+5,,AUTO
         2 003422   204615 631500                    EPPR1   RT+49,,AUTO
         2 003423   205532 451500                    STP1    DCB$+4,,AUTO
         2 003424   000111 236000 3                  LDQ     73
         2 003425   205531 756100                    STQ     DCB$+3,,AUTO
         2 003426   204530 633500                    EPPR3   CHG2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:185  
         2 003427   205530 453500                    STP3    DCB$+2,,AUTO
         2 003430   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 003431   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 003432   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 003433   000000 011000                    NOP     0

     1036    10570    3           JSP.CHG = JSP.CHG + CHG1 + CHG2;

  10570  2 003434   204004 470500                    LDP0    REC$,,AUTO
         2 003435   000065 236100                    LDQ     53,,PR0
         2 003436   204527 036100                    ADLQ    CHG1,,AUTO
         2 003437   204530 036100                    ADLQ    CHG2,,AUTO
         2 003440   000065 756100                    STQ     53,,PR0

     1037    10571    3           IF STATSLEV=%AZ_ALL#

  10571  2 003441   204503 235100                    LDA     STATSLEV,,AUTO
         2 003442   000001 115007                    CMPA    1,DL
         2 003443   003636 601000 2                  TNZ     s:10610

     1038    10572    4           THEN DO;

     1039    10573    4                IF FORM_START

  10573  2 003444   204507 234100                    SZN     FORM_START,,AUTO
         2 003445   003462 605000 2                  TPL     s:10581

     1040    10574    5                THEN DO;

     1041    10575    5                     FORM_START = %NO#;

  10575  2 003446   204507 450100                    STZ     FORM_START,,AUTO

     1042    10576    5                     OUT_BUF = 'FORMS USED';

  10576  2 003447   040100 100400                    MLR     fill='040'O
         2 003450   001762 000012 1                  ADSC9   XSJ_PARAMC+14            cn=0,n=10
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:186  
         2 003451   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1043    10577    5                     IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10577  2 003452   000000 471400 xsym               LDP1    B$JIT$
         2 003453   100143 236100                    LDQ     99,,PR1
         2 003454   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 003455   003462 601000 2                  TNZ     s:10581

     1044    10578    5                     THEN                  /* Don't print if BREAK hit           */
     1045    10579    5                          CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10579  2 003456   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 003457   440001 713400                    CLIMB   alt,write
         2 003460   401400 401760                    pmme    nvectors=4
         2 003461   004116 702000 2                  TSX2    WR_ALT

     1046    10580    5                     END;

     1047    10581    4                IF B$JIT.BLINDACCTNG

  10581  2 003462   204007 470500                    LDP0    JIT$,,AUTO
         2 003463   000153 236100                    LDQ     107,,PR0
         2 003464   400000 316007                    CANQ    -131072,DL
         2 003465   003472 600000 2                  TZE     s:10583

     1048    10582    4                THEN OUT_BUF = FRM_TEMPLATE_BLIND;

  10582  2 003466   040100 100400                    MLR     fill='040'O
         2 003467   000450 000071 1                  ADSC9   FRM_TEMPLATE_BLIND       cn=0,n=57
         2 003470   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72
         2 003471   003475 710000 2                  TRA     s:10584

     1049    10583    4                ELSE OUT_BUF = FRM_TEMPLATE;

  10583  2 003472   040100 100400                    MLR     fill='040'O
         2 003473   000430 000077 1                  ADSC9   FRM_TEMPLATE             cn=0,n=63
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:187  
         2 003474   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1050    10584    4                OBF.NAME = FRM.S1.FORMNAME(I);

  10584  2 003475   204505 236100                    LDQ     I,,AUTO
         2 003476   000064 402007                    MPY     52,DL
         2 003477   205074 471500                    LDP1    FRM$,,AUTO
         2 003500   040100 100506                    MLR     fill='040'O
         2 003501   100002 000014                    ADSC9   2,Q,PR1                  cn=0,n=12
         2 003502   205170 400014                    ADSC9   OUT_BUF,,AUTO            cn=2,n=12

     1051    10585    4                OBF.DD = FRM.S1.DD(I);

  10585  2 003503   040100 100506                    MLR     fill='040'O
         2 003504   100005 000002                    ADSC9   5,Q,PR1                  cn=0,n=2
         2 003505   205173 600002                    ADSC9   OUT_BUF+3,,AUTO          cn=3,n=2

     1052    10586    4                OBF.WSN = FRM.S1.WSN(I);

  10586  2 003506   040100 100506                    MLR     fill='040'O
         2 003507   100005 400010                    ADSC9   5,Q,PR1                  cn=2,n=8
         2 003510   205174 400010                    ADSC9   OUT_BUF+4,,AUTO          cn=2,n=8

     1053    10587    4                CALL BINXCHAR(OBF.FRMS,FRM.FORMS(I));

  10587  2 003511   000100 301506                    BTD
         2 003512   100000 000004                    NDSC9   0,Q,PR1                  cn=0,s=lsgnf,sf=0,n=4
         2 003513   205176 410006                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=lsgns,sf=0,n=6

     1054    10588    4                CALL EDITXCHAR(OBF.FRMS,,,MOPS_5_0_STR,OBF.FRMS);

  10588  2 003514   100000 024500                    MVNE
         2 003515   205176 410006                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=lsgns,sf=0,n=6
         2 003516   000541 000005 1                  ADSC9   MOPS_5_0_STR             cn=0,n=5
         2 003517   205176 400006                    ADSC9   OUT_BUF+6,,AUTO          cn=2,n=6

     1055    10589    4                CALL BINCHAR(OBF.MNTS,MNTS);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:188  

  10589  2 003520   000100 301500                    BTD
         2 003521   204532 000004                    NDSC9   MNTS,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         2 003522   205204 030002                    NDSC9   OUT_BUF+12,,AUTO         cn=0,s=nosgn,sf=0,n=2

     1056    10590    4                CALL EDITCHAR(OBF.MNTS,,,MOP_2_0_STR,OBF.MNTS);

  10590  2 003523   100000 024500                    MVNE
         2 003524   205204 030002                    NDSC9   OUT_BUF+12,,AUTO         cn=0,s=nosgn,sf=0,n=2
         2 003525   000552 000002 1                  ADSC9   MOP_2_0_STR              cn=0,n=2
         2 003526   205204 000002                    ADSC9   OUT_BUF+12,,AUTO         cn=0,n=2

     1057    10591    4                IF NOT B$JIT.BLINDACCTNG

  10591  2 003527   000153 236100                    LDQ     107,,PR0
         2 003530   400000 316007                    CANQ    -131072,DL
         2 003531   003626 601000 2                  TNZ     s:10606

     1058    10592    5                THEN DO;                   /* Tell the user about charge details */

     1059    10593    5                     CALL AZB$MTH3D2B(T1,F1,RT.CMULT#,FORM_TBL.FORM#,1,1,'0'B);

  10593  2 003532   000000 236000 3                  LDQ     0
         2 003533   205536 756100                    STQ     DCB$+8,,AUTO
         2 003534   000112 237000 3                  LDAQ    74
         2 003535   205534 757100                    STAQ    DCB$+6,,AUTO
         2 003536   205062 633500                    EPPR3   FORM_TBL,,AUTO
         2 003537   205533 453500                    STP3    DCB$+5,,AUTO
         2 003540   204615 634500                    EPPR4   RT+49,,AUTO
         2 003541   205532 454500                    STP4    DCB$+4,,AUTO
         2 003542   000111 236000 3                  LDQ     73
         2 003543   205531 756100                    STQ     DCB$+3,,AUTO
         2 003544   204531 635500                    EPPR5   T1,,AUTO
         2 003545   205530 455500                    STP5    DCB$+2,,AUTO
         2 003546   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 003547   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 003550   000000 701000 xent               TSX1    AZB$MTH3D2B
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:189  
         2 003551   000000 011000                    NOP     0

     1060    10594    5                     CALL BINCHAR(CHR6,T1);

  10594  2 003552   000100 301500                    BTD
         2 003553   204531 000004                    NDSC9   T1,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
         2 003554   204510 030006                    NDSC9   CHR6,,AUTO               cn=0,s=nosgn,sf=0,n=6

     1061    10595    5                     CALL EDITCHAR(OBF.PER_FORM,,,MOP_2_4_STR,CHR6);

  10595  2 003555   100000 024500                    MVNE
         2 003556   204510 030006                    NDSC9   CHR6,,AUTO               cn=0,s=nosgn,sf=0,n=6
         2 003557   000545 000004 1                  ADSC9   MOP_2_4_STR              cn=0,n=4
         2 003560   205200 400007                    ADSC9   OUT_BUF+8,,AUTO          cn=2,n=7

     1062    10596    5                     CALL AZB$MTH3D2B(T1,F1,RT.CMULT#,FORM_TBL.FMOUNT#,1,1,'0'B);

  10596  2 003561   000000 236000 3                  LDQ     0
         2 003562   205536 756100                    STQ     DCB$+8,,AUTO
         2 003563   000112 237000 3                  LDAQ    74
         2 003564   205534 757100                    STAQ    DCB$+6,,AUTO
         2 003565   205064 630500                    EPPR0   FORM_TBL+2,,AUTO
         2 003566   205533 450500                    STP0    DCB$+5,,AUTO
         2 003567   204615 631500                    EPPR1   RT+49,,AUTO
         2 003570   205532 451500                    STP1    DCB$+4,,AUTO
         2 003571   000111 236000 3                  LDQ     73
         2 003572   205531 756100                    STQ     DCB$+3,,AUTO
         2 003573   204531 633500                    EPPR3   T1,,AUTO
         2 003574   205530 453500                    STP3    DCB$+2,,AUTO
         2 003575   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 003576   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 003577   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 003600   000000 011000                    NOP     0

     1063    10597    5                     CALL BINCHAR(CHR6,T1);

  10597  2 003601   000100 301500                    BTD
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:190  
         2 003602   204531 000004                    NDSC9   T1,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
         2 003603   204510 030006                    NDSC9   CHR6,,AUTO               cn=0,s=nosgn,sf=0,n=6

     1064    10598    5                     CALL EDITCHAR(OBF.PER_MNT,,,MOP_2_4_STR,CHR6);

  10598  2 003604   100000 024500                    MVNE
         2 003605   204510 030006                    NDSC9   CHR6,,AUTO               cn=0,s=nosgn,sf=0,n=6
         2 003606   000545 000004 1                  ADSC9   MOP_2_4_STR              cn=0,n=4
         2 003607   205205 000007                    ADSC9   OUT_BUF+13,,AUTO         cn=0,n=7

     1065    10599    5                     T1 = (CHG1+CHG2+50)/100;

  10599  2 003610   204527 236100                    LDQ     CHG1,,AUTO
         2 003611   204530 036100                    ADLQ    CHG2,,AUTO
         2 003612   000062 036007                    ADLQ    50,DL
         2 003613   000144 506007                    DIV     100,DL
         2 003614   204531 756100                    STQ     T1,,AUTO

     1066    10600    5                     IF T1~=0

  10600  2 003615   000000 116003                    CMPQ    0,DU
         2 003616   003626 600000 2                  TZE     s:10606

     1067    10601    6                     THEN DO;

     1068    10602    6                          CALL BINXCHAR(CHR8,T1);

  10602  2 003617   000100 301500                    BTD
         2 003620   204531 000004                    NDSC9   T1,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
         2 003621   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8

     1069    10603    6                          CALL EDITXCHAR(OBF.CHG,,,MOPS_5_2_STR,CHR8);

  10603  2 003622   100000 024500                    MVNE
         2 003623   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8
         2 003624   000535 000006 1                  ADSC9   MOPS_5_2_STR             cn=0,n=6
         2 003625   205207 600011                    ADSC9   OUT_BUF+15,,AUTO         cn=3,n=9
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:191  

     1070    10604    6                          END;

     1071    10605    5                     END;

     1072    10606    4                IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10606  2 003626   000000 470400 xsym               LDP0    B$JIT$
         2 003627   000143 236100                    LDQ     99,,PR0
         2 003630   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 003631   003636 601000 2                  TNZ     s:10610

     1073    10607    4                THEN                       /* Don't print if BREAK hit           */
     1074    10608    4                     CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10608  2 003632   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 003633   440001 713400                    CLIMB   alt,write
         2 003634   401400 401760                    pmme    nvectors=4
         2 003635   004116 702000 2                  TSX2    WR_ALT

     1075    10609    4                END;

     1076    10610    3           END;

  10610  2 003636   204505 054100                    AOS     I,,AUTO
         2 003637   204004 470500                    LDP0    REC$,,AUTO
         2 003640   204505 236100                    LDQ     I,,AUTO
         2 003641   000140 116100                    CMPQ    96,,PR0
         2 003642   003320 604000 2                  TMI     s:10552

     1077    10611        /***********************************
     1078    10612         ****       finish the AZ_ALL# page or put out the AZ_SUMMARY# line
     1079    10613         ****       or do nothing
     1080    10614         ***********************************/
     1081    10615    3      DO CASE(STATSLEV);

  10615  2 003643   204503 235100                    LDA     STATSLEV,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:192  
         2 003644   000003 115007                    CMPA    3,DL
         2 003645   003647 602005 2                  TNC     s:10615+4,AL
         2 003646   004115 710000 2                  TRA     s:10668
         2 003647   004115 710000 2                  TRA     s:10668
         2 003650   003652 710000 2                  TRA     s:10617
         2 003651   003760 710000 2                  TRA     s:10643

     1082    10616    3       CASE(%AZ_ALL#);

     1083    10617    3         OUT_BUF = DASH_LINE;

  10617  2 003652   040100 100400                    MLR     fill='040'O
         2 003653   000467 000110 1                  ADSC9   DASH_LINE                cn=0,n=72
         2 003654   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1084    10618    3         IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10618  2 003655   000000 471400 xsym               LDP1    B$JIT$
         2 003656   100143 236100                    LDQ     99,,PR1
         2 003657   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 003660   003665 601000 2                  TNZ     s:10621

     1085    10619    3         THEN                              /* Don't print if BREAK hit           */
     1086    10620    3              CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10620  2 003661   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 003662   440001 713400                    CLIMB   alt,write
         2 003663   401400 401760                    pmme    nvectors=4
         2 003664   004116 702000 2                  TSX2    WR_ALT

     1087    10621    3         OUT_BUF = 'TOTAL CHARGE =';

  10621  2 003665   040100 100400                    MLR     fill='040'O
         2 003666   001765 000016 1                  ADSC9   XSJ_PARAMC+17            cn=0,n=14
         2 003667   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1088    10622    3         CALL BINXCHAR(CHR8,(JSP.PCHG+JSP.CHG+50)/100);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:193  

  10622  2 003670   204004 470500                    LDP0    REC$,,AUTO
         2 003671   000066 236100                    LDQ     54,,PR0
         2 003672   000065 036100                    ADLQ    53,,PR0
         2 003673   000062 036007                    ADLQ    50,DL
         2 003674   000144 506007                    DIV     100,DL
         2 003675   205530 756100                    STQ     DCB$+2,,AUTO
         2 003676   000100 301500                    BTD
         2 003677   205530 000004                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 003700   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8

     1089    10623    3         CALL EDITXCHAR(OBT.TCHG,,,MOPS_5_2_STR,CHR8);

  10623  2 003701   100000 024500                    MVNE
         2 003702   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8
         2 003703   000535 000006 1                  ADSC9   MOPS_5_2_STR             cn=0,n=6
         2 003704   205173 400011                    ADSC9   OUT_BUF+3,,AUTO          cn=2,n=9

     1090    10624    3         IF NOT B$JIT.BLINDACCTNG

  10624  2 003705   204007 471500                    LDP1    JIT$,,AUTO
         2 003706   100153 236100                    LDQ     107,,PR1
         2 003707   400000 316007                    CANQ    -131072,DL
         2 003710   003747 601000 2                  TNZ     s:10639

     1091    10625    4         THEN DO;

     1092    10626    4              IF JSP.PCHG~=0

  10626  2 003711   000066 235100                    LDA     54,,PR0
         2 003712   003732 600000 2                  TZE     s:10633

     1093    10627    5              THEN DO;

     1094    10628    5                   OB.O_PAREN = '(';

  10628  2 003713   000050 236003                    LDQ     40,DU
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:194  
         2 003714   205205 552120                    STBQ    OUT_BUF+13,'20'O,AUTO

     1095    10629    5                   OB.C_PAREN = ')';

  10629  2 003715   051000 236007                    LDQ     20992,DL
         2 003716   205207 552110                    STBQ    OUT_BUF+15,'10'O,AUTO

     1096    10630    5                   CALL BINCHAR(CHR7,(JSP.PCHG+50)/100);

  10630  2 003717   000066 236100                    LDQ     54,,PR0
         2 003720   000062 036007                    ADLQ    50,DL
         2 003721   000144 506007                    DIV     100,DL
         2 003722   205530 756100                    STQ     DCB$+2,,AUTO
         2 003723   000100 301500                    BTD
         2 003724   205530 000004                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 003725   204512 030007                    NDSC9   CHR7,,AUTO               cn=0,s=nosgn,sf=0,n=7

     1097    10631    5                   CALL EDITCHAR(OB.PCHG,,,MOP_5_2_STR,CHR7);

  10631  2 003726   100000 024500                    MVNE
         2 003727   204512 030007                    NDSC9   CHR7,,AUTO               cn=0,s=nosgn,sf=0,n=7
         2 003730   000550 000004 1                  ADSC9   MOP_5_2_STR              cn=0,n=4
         2 003731   205205 400010                    ADSC9   OUT_BUF+13,,AUTO         cn=2,n=8

     1098    10632    5                   END;

     1099    10633    4              IF JSP.CHG~=0

  10633  2 003732   000065 235100                    LDA     53,,PR0
         2 003733   003747 600000 2                  TZE     s:10639

     1100    10634    5              THEN DO;

     1101    10635    5                   CALL BINXCHAR(CHR8,(JSP.CHG+50)/100);

  10635  2 003734   000065 236100                    LDQ     53,,PR0
         2 003735   000062 036007                    ADLQ    50,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:195  
         2 003736   000144 506007                    DIV     100,DL
         2 003737   205530 756100                    STQ     DCB$+2,,AUTO
         2 003740   000100 301500                    BTD
         2 003741   205530 000004                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 003742   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8

     1102    10636    5                   CALL EDITXCHAR(OB.CHG,,,MOPS_5_2_STR,CHR8);

  10636  2 003743   100000 024500                    MVNE
         2 003744   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8
         2 003745   000535 000006 1                  ADSC9   MOPS_5_2_STR             cn=0,n=6
         2 003746   205207 600011                    ADSC9   OUT_BUF+15,,AUTO         cn=3,n=9

     1103    10637    5                   END;

     1104    10638    4              END;

     1105    10639    3         IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10639  2 003747   000000 473400 xsym               LDP3    B$JIT$
         2 003750   300143 236100                    LDQ     99,,PR3
         2 003751   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 003752   004115 601000 2                  TNZ     s:10668

     1106    10640    3         THEN                              /* Don't print if BREAK hit           */
     1107    10641    3              CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10641  2 003753   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 003754   440001 713400                    CLIMB   alt,write
         2 003755   401400 401760                    pmme    nvectors=4
         2 003756   004116 702000 2                  TSX2    WR_ALT
         2 003757   004115 710000 2                  TRA     s:10668

     1108    10642    3       CASE(%AZ_SUMMARY#);

     1109    10643    3         OUT_BUF = SUM_TEMPLATE;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:196  
  10643  2 003760   040100 100400                    MLR     fill='040'O
         2 003761   000511 000100 1                  ADSC9   SUM_TEMPLATE             cn=0,n=64
         2 003762   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1110    10644    3         FPT_TIME.TSTAMP_ = VECTOR(JSP.CONNECT);

  10644  2 003763   777640 235007                    LDA     -96,DL
         2 003764   204004 236100                    LDQ     REC$,,AUTO
         2 003765   000100 036003                    ADLQ    64,DU
         2 003766   204222 757100                    STAQ    FPT_TIME+8,,AUTO

     1111    10645    3         FPT_TIME.TIME_ = VECTOR(OBS.CON.TIM);

  10645  2 003767   000023 235000 3                  LDA     19
         2 003770   205530 452500                    STP2    DCB$+2,,AUTO
         2 003771   205530 236100                    LDQ     DCB$+2,,AUTO
         2 003772   000114 036000 3                  ADLQ    76
         2 003773   204216 757100                    STAQ    FPT_TIME+4,,AUTO

     1112    10646    3         CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);

  10646  2 003774   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 003775   420004 713400                    CLIMB   alt,+8196
         2 003776   402000 401760                    pmme    nvectors=5
         2 003777   004116 702000 2                  TSX2    WR_ALT

     1113    10647    3         T = JSP.CONNECT/360000;

  10647  2 004000   204004 470500                    LDP0    REC$,,AUTO
         2 004001   000100 236100                    LDQ     64,,PR0
         2 004002   000115 506000 3                  DIV     77
         2 004003   204504 756100                    STQ     T,,AUTO

     1114    10648    3         CALL BINCHAR(OBS.CON1.HRS,T);

  10648  2 004004   000100 301500                    BTD
         2 004005   204504 000004                    NDSC9   T,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:197  
         2 004006   205171 030003                    NDSC9   OUT_BUF+1,,AUTO          cn=0,s=nosgn,sf=0,n=3

     1115    10649    3         FPT_TIME.TSTAMP_ = VECTOR(T1);

  10649  2 004007   777640 235007                    LDA     -96,DL
         2 004010   205530 452500                    STP2    DCB$+2,,AUTO
         2 004011   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004012   004531 036003                    ADLQ    2393,DU
         2 004013   204222 757100                    STAQ    FPT_TIME+8,,AUTO

     1116    10650    3         T1 = JSP.PEXEC + JSP.UEXEC;

  10650  2 004014   000111 236100                    LDQ     73,,PR0
         2 004015   000112 036100                    ADLQ    74,,PR0
         2 004016   204531 756100                    STQ     T1,,AUTO

     1117    10651    3         FPT_TIME.TIME_ = VECTOR(OBS.EXEC.TIME);

  10651  2 004017   000043 235000 3                  LDA     35
         2 004020   205530 452500                    STP2    DCB$+2,,AUTO
         2 004021   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004022   000116 036000 3                  ADLQ    78
         2 004023   204216 757100                    STAQ    FPT_TIME+4,,AUTO

     1118    10652    3         CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);

  10652  2 004024   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 004025   420004 713400                    CLIMB   alt,+8196
         2 004026   402000 401760                    pmme    nvectors=5
         2 004027   004116 702000 2                  TSX2    WR_ALT

     1119    10653    3         T = T1/360000;

  10653  2 004030   204531 236100                    LDQ     T1,,AUTO
         2 004031   000115 506000 3                  DIV     77
         2 004032   204504 756100                    STQ     T,,AUTO

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:198  
     1120    10654    3         CALL BINCHAR(OBS.EXEC1.HRS,T);

  10654  2 004033   000100 301500                    BTD
         2 004034   204504 000004                    NDSC9   T,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 004035   205174 230003                    NDSC9   OUT_BUF+4,,AUTO          cn=1,s=nosgn,sf=0,n=3

     1121    10655    3         T1 = JSP.PSTIME + JSP.USTIME;

  10655  2 004036   204004 470500                    LDP0    REC$,,AUTO
         2 004037   000113 236100                    LDQ     75,,PR0
         2 004040   000114 036100                    ADLQ    76,,PR0
         2 004041   204531 756100                    STQ     T1,,AUTO

     1122    10656    3         FPT_TIME.TIME_ = VECTOR(OBS.SERV.TIME);

  10656  2 004042   000043 235000 3                  LDA     35
         2 004043   205530 452500                    STP2    DCB$+2,,AUTO
         2 004044   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004045   000117 036000 3                  ADLQ    79
         2 004046   204216 757100                    STAQ    FPT_TIME+4,,AUTO

     1123    10657    3         CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);

  10657  2 004047   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 004050   420004 713400                    CLIMB   alt,+8196
         2 004051   402000 401760                    pmme    nvectors=5
         2 004052   004116 702000 2                  TSX2    WR_ALT

     1124    10658    3         T = T1/360000;

  10658  2 004053   204531 236100                    LDQ     T1,,AUTO
         2 004054   000115 506000 3                  DIV     77
         2 004055   204504 756100                    STQ     T,,AUTO

     1125    10659    3         CALL BINCHAR(OBS.SERV1.HRS,T);

  10659  2 004056   000100 301500                    BTD
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:199  
         2 004057   204504 000004                    NDSC9   T,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 004060   205200 430003                    NDSC9   OUT_BUF+8,,AUTO          cn=2,s=nosgn,sf=0,n=3

     1126    10660    3         CALL BINCHAR(OBS.PMMES,JSP.PMMES);

  10660  2 004061   204004 470500                    LDP0    REC$,,AUTO
         2 004062   000100 301500                    BTD
         2 004063   000110 000004                    NDSC9   72,,PR0                  cn=0,s=lsgnf,sf=0,n=4
         2 004064   205205 030007                    NDSC9   OUT_BUF+13,,AUTO         cn=0,s=nosgn,sf=0,n=7

     1127    10661    3         CALL EDITCHAR(OBS.PMMES,,,MOP_7_0_STR,OBS.PMMES);

  10661  2 004065   100000 024500                    MVNE
         2 004066   205205 030007                    NDSC9   OUT_BUF+13,,AUTO         cn=0,s=nosgn,sf=0,n=7
         2 004067   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 004070   205205 000007                    ADSC9   OUT_BUF+13,,AUTO         cn=0,n=7

     1128    10662    3         CALL BINXCHAR(CHR7,(JSP.PCHG+JSP.CHG+50)/100);

  10662  2 004071   000066 236100                    LDQ     54,,PR0
         2 004072   000065 036100                    ADLQ    53,,PR0
         2 004073   000062 036007                    ADLQ    50,DL
         2 004074   000144 506007                    DIV     100,DL
         2 004075   205530 756100                    STQ     DCB$+2,,AUTO
         2 004076   000100 301500                    BTD
         2 004077   205530 000004                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 004100   204512 010007                    NDSC9   CHR7,,AUTO               cn=0,s=lsgns,sf=0,n=7

     1129    10663    3         CALL EDITXCHAR(OBS.CHG,,,MOPS_4_2_STR,CHR7);

  10663  2 004101   100000 024500                    MVNE
         2 004102   204512 010007                    NDSC9   CHR7,,AUTO               cn=0,s=lsgns,sf=0,n=7
         2 004103   000537 000006 1                  ADSC9   MOPS_4_2_STR             cn=0,n=6
         2 004104   205210 000010                    ADSC9   OUT_BUF+16,,AUTO         cn=0,n=8

     1130    10664    3         IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:200  
  10664  2 004105   000000 471400 xsym               LDP1    B$JIT$
         2 004106   100143 236100                    LDQ     99,,PR1
         2 004107   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 004110   004115 601000 2                  TNZ     s:10668

     1131    10665    3         THEN                              /* Don't print if BREAK hit           */
     1132    10666    3              CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10666  2 004111   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004112   440001 713400                    CLIMB   alt,write
         2 004113   401400 401760                    pmme    nvectors=4
         2 004114   004116 702000 2                  TSX2    WR_ALT

     1133    10667    3         END;                              /* END CASE                           */

     1134    10668    3      DO WHILE('0'B);

  10668  2 004115   004127 710000 2                  TRA     s:10674

     1135    10669    3   WR_ALT: CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);

  10669  2 004116   000001 236000 xsym  WR_ALT       LDQ     B_VECTNIL+1
         2 004117   205525 756100                    STQ     @DCB#+1,,AUTO
         2 004120   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 004121   000042 036000 3                  ADLQ    34
         2 004122   205524 756100                    STQ     @ERR+1,,AUTO
         2 004123   000011 236000 3                  LDQ     9
         2 004124   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 004125   011343 701000 2                  TSX1    POST_ERR
         2 004126   000000 011000                    NOP     0

     1136    10670    3           END;

     1137    10671        /***********************************
     1138    10672         ****       Add PCHG and CHG into CHG
     1139    10673         ***********************************/
     1140    10674    2      JSP.CHG = JSP.CHG + JSP.PCHG;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:201  

  10674  2 004127   204004 470500                    LDP0    REC$,,AUTO
         2 004130   000065 236100                    LDQ     53,,PR0
         2 004131   000066 036100                    ADLQ    54,,PR0
         2 004132   000065 756100                    STQ     53,,PR0

     1141    10675    2      RETURN;

  10675  2 004133   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 004134   000001 702211                    TSX2  ! 1,X1

     1142    10676        /***********************************
     1143    10677         ****       general ALTRETURN handling
     1144    10678         ***********************************/
     1145    10679    2   DFLT_RTRY:
     1146    10680    2      IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY

  10680  2 004135   000000 470400 xsym  DFLT_RTRY    LDP0    B$JIT$
         2 004136   000012 236100                    LDQ     10,,PR0
         2 004137   377770 376007                    ANQ     131064,DL
         2 004140   001020 116007                    CMPQ    528,DL
         2 004141   004204 601000 2                  TNZ     ALTL

     1147    10681    2      THEN IF SUBSTR(IN_KEY.KEY,4)~='0'

  10681  2 004142   040000 106500                    CMPC    fill='040'O
         2 004143   204120 200037                    ADSC9   IN_KEY+1,,AUTO           cn=1,n=31
         2 004144   000120 000001 3                  ADSC9   80                       cn=0,n=1
         2 004145   004165 600000 2                  TZE     s:10689

     1148    10682    3           THEN DO;

     1149    10683    3                CALL CONCAT(IN_KEY.KEY,SUBSTR(IN_KEY.KEY,0,4),'0');

  10683  2 004146   040100 100500                    MLR     fill='040'O
         2 004147   204117 200004                    ADSC9   IN_KEY,,AUTO             cn=1,n=4
         2 004150   204117 200004                    ADSC9   IN_KEY,,AUTO             cn=1,n=4
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:202  
         2 004151   040100 100400                    MLR     fill='040'O
         2 004152   000120 000001 3                  ADSC9   80                       cn=0,n=1
         2 004153   204120 200037                    ADSC9   IN_KEY+1,,AUTO           cn=1,n=31

     1150    10684    3                IF NO_DFLT=3

  10684  2 004154   205072 235100                    LDA     NO_DFLT,,AUTO
         2 004155   000003 115007                    CMPA    3,DL
         2 004156   004161 601000 2                  TNZ     s:10686

     1151    10685    3                THEN IN_KEY.LEN = 5;       /* PROC record is only var-len key    */

  10685  2 004157   005000 236003                    LDQ     2560,DU
         2 004160   204117 552140                    STBQ    IN_KEY,'40'O,AUTO

     1152    10686    3                CALL M$RETRY ALTRET(DFLT_RTRY);

  10686  2 004161   410010 713400                    CLIMB   alt,+4104
         2 004162   000000 401760                    pmme    nvectors=0
         2 004163   004135 702000 2                  TSX2    DFLT_RTRY

     1153    10687                                                /* Retry the read with default key    */
     1154    10688    3                END;

  10688  2 004164   004204 710000 2                  TRA     ALTL

     1155    10689    3           ELSE DO CASE(NO_DFLT);

  10689  2 004165   205072 235100                    LDA     NO_DFLT,,AUTO
         2 004166   000006 115007                    CMPA    6,DL
         2 004167   004171 602005 2                  TNC     s:10689+4,AL
         2 004170   004204 710000 2                  TRA     ALTL
         2 004171   004204 710000 2                  TRA     ALTL
         2 004172   004177 710000 2                  TRA     s:10691
         2 004173   004200 710000 2                  TRA     s:10693
         2 004174   004201 710000 2                  TRA     s:10695
         2 004175   004202 710000 2                  TRA     s:10697
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:203  
         2 004176   004203 710000 2                  TRA     s:10699

     1156    10690    3            CASE(1);

     1157    10691    3              GOTO NO_SCHE;

  10691  2 004177   002021 710000 2                  TRA     NO_SCHE

     1158    10692    3            CASE(2);

     1159    10693    3              GOTO NO_RATE;

  10693  2 004200   002062 710000 2                  TRA     NO_RATE

     1160    10694    3            CASE(3);

     1161    10695    3              GOTO NO_PROC;

  10695  2 004201   002141 710000 2                  TRA     NO_PROC

     1162    10696    3            CASE(4);

     1163    10697    3              GOTO NO_RATE1;

  10697  2 004202   002204 710000 2                  TRA     NO_RATE1

     1164    10698    3            CASE(5);

     1165    10699    3              GOTO NO_FORM;

  10699  2 004203   003347 710000 2                  TRA     NO_FORM

     1166    10700    3              END;

     1167    10701    2   ALTL:
     1168    10702    2      CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:204  
  10702  2 004204   000001 236000 xsym  ALTL         LDQ     B_VECTNIL+1
         2 004205   205525 756100                    STQ     @DCB#+1,,AUTO
         2 004206   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 004207   000002 036003                    ADLQ    2,DU
         2 004210   205524 756100                    STQ     @ERR+1,,AUTO
         2 004211   000005 236000 3                  LDQ     5
         2 004212   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 004213   011343 701000 2                  TSX1    POST_ERR
         2 004214   000000 011000                    NOP     0

     1169    10703    2      RETURN;

  10703  2 004215   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 004216   000001 702211                    TSX2  ! 1,X1

     1170    10704        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:205  
     1171    10705    2   NO_CHG: PROC;

  10705  2 004217   205212 741300       NO_CHG       STX1  ! OUT_BUF+18,,AUTO

     1172    10706        /*I* NAME: NO_CHG
     1173    10707             CALL: CALL NO_CHG;
     1174    10708             PURPOSE: To put out the un-chargable information on a AZ_ALL# call
     1175    10709        */
     1176    10710        %SUDO(NAME = SUDO,STCLASS="BASED(SUDO$)");
     1177    10741    3   DCL SUDO$ PTR;
     1178    10742    3   DCL TEMP$ PTR;
     1179    10743    3   DCL TEMP1$ PTR;
     1180    10744    3   DCL T SBIN;                             /* Temporary value                    */
     1181    10745    3   DCL I SBIN;
     1182    10746    3   DCL LIM$TEXT CHAR(5) BASED;
     1183    10747    3   DCL PROC_LIT CHAR(32) CONSTANT INIT('PROCESSOR');
     1184    10748    3   DCL PROC1_LIT CHAR(32) CONSTANT INIT('PROCESSOR(1st)');
     1185    10749    3   DCL JOBNAME_LIT CHAR(32) CONSTANT INIT('JOBNAME');
     1186    10750    3   DCL TOF_VFC CHAR(1) CONSTANT INIT('p'); /* TOF then space 0 after             */
     1187    10751    3   DCL 1 RNST_TBL(0:9) CONSTANT ALIGNED,   /* Run status table                   */
     1188    10752    3         2 LEN UBIN BYTE UNAL INIT
     1189    10753    3           (6,5,5,21,18,21,19,14,19,9),
     1190    10754    3         2 TEXT CHAR(23) UNAL INIT
     1191    10755    3           ('NORMAL','ERROR','ABORT','ABORTED BY PROC.(SSP)',
     1192    10756    3           'ABORTED BY MONITOR','ERROR KEY_IN OR !QUIT','MONITOR ABORT KEYIN',
     1193    10757    3           'LIMIT EXCEEDED','ABORTED BY OPERATOR','CANCELLED'),
     1194    10758    3         2 MASK BIT(9) UNAL INIT
     1195    10759    3           (%RS_EXIT#,%RS_ERR#,%RS_XXX#,%RS_SSP#,%RS_ABRT#,%RS_EKEY#,%RS_OFF#,
     1196    10760    3           %RS_LIMX#,%RS_XKEY#,%RS_CAN#);
     1197    10761    3   DCL 1 XLIM_TBL(0:8) CONSTANT ALIGNED,   /* limit exceeded table               */
     1198    10762    3         2 LEN UBIN BYTE UNAL INIT
     1199    10763    3            (4,5,4,5,5,2,2,6,2),
     1200    10764    3         2 HDR CHAR(6) UNAL INIT
     1201    10765    3            ('TIME','STACK','TAPE','TDISK','PDISK','DO','LO','MEMORY','PO'),
     1202    10766    3         2 MASK BIT(9) UNAL INIT
     1203    10767    3            (%XL_TIME#,%XL_STACK#,%XL_TAPE#,%XL_TDISC#,%XL_PDISC#,%XL_DO#,
     1204    10768    3             %XL_LO#,%XL_MEM#,%XL_PO#);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:206  
     1205    10769    3      SUDO$ = PINCRW(REC$,JSP.SUDOX);

  10769  2 004220   204004 470500                    LDP0    REC$,,AUTO
         2 004221   000133 236100                    LDQ     91,,PR0
         2 004222   000022 736000                    QLS     18
         2 004223   204004 036100                    ADLQ    REC$,,AUTO
         2 004224   205213 756100                    STQ     SUDO$,,AUTO

     1206    10770        /***********************************
     1207    10771         ****       get to top of form
     1208    10772         ***********************************/
     1209    10773    3      FPT_WRITE.BUF_ = VECTOR(TOF_VFC);

  10773  2 004225   000122 237000 3                  LDAQ    82
         2 004226   204354 757100                    STAQ    FPT_WRITE+4,,AUTO

     1210    10774    3      FPT_WRITE.V.DVBYTE.VFC# = %YES#;

  10774  2 004227   100000 236003                    LDQ     32768,DU
         2 004230   204363 256100                    ORSQ    FPT_WRITE+11,,AUTO

     1211    10775    3      CALL M$WRITE(FPT_WRITE) ALTRET(TOFALT);

  10775  2 004231   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004232   440001 713400                    CLIMB   alt,write
         2 004233   401400 401760                    pmme    nvectors=4
         2 004234   004235 702000 2                  TSX2    TOFALT

     1212    10776    3   TOFALT: FPT_WRITE.V.DVBYTE.VFC# = %NO#;

  10776  2 004235   000121 236000 3     TOFALT       LDQ     81
         2 004236   204363 356100                    ANSQ    FPT_WRITE+11,,AUTO

     1213    10777    3      FPT_WRITE.BUF_ = VECTOR(OUT_BUF);

  10777  2 004237   000041 235000 3                  LDA     33
         2 004240   205530 452500                    STP2    DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:207  
         2 004241   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004242   005170 036003                    ADLQ    2680,DU
         2 004243   204354 757100                    STAQ    FPT_WRITE+4,,AUTO

     1214    10778        /***********************************
     1215    10779         ****       put out the header record
     1216    10780         ***********************************/
     1217    10781    3      OUT_BUF = ' ';

  10781  2 004244   040100 100400                    MLR     fill='040'O
         2 004245   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004246   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1218    10782    3      FPT_TIME.DATE_ = VECTOR(OBH.DATE);

  10782  2 004247   000124 235000 3                  LDA     84
         2 004250   205530 452500                    STP2    DCB$+2,,AUTO
         2 004251   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004252   000125 036000 3                  ADLQ    85
         2 004253   204214 757100                    STAQ    FPT_TIME+2,,AUTO

     1219    10783    3      FPT_TIME.TSTAMP_ = VECTOR(JSP.CUR_UTS);

  10783  2 004254   777640 235007                    LDA     -96,DL
         2 004255   204004 236100                    LDQ     REC$,,AUTO
         2 004256   000034 036003                    ADLQ    28,DU
         2 004257   204222 757100                    STAQ    FPT_TIME+8,,AUTO

     1220    10784    3      FPT_TIME.TIME_ = VECTOR(OBH.TIME);

  10784  2 004260   000023 235000 3                  LDA     19
         2 004261   205530 452500                    STP2    DCB$+2,,AUTO
         2 004262   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004263   005170 036003                    ADLQ    2680,DU
         2 004264   204216 757100                    STAQ    FPT_TIME+4,,AUTO

     1221    10785    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:208  

  10785  2 004265   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 004266   420004 713400                    CLIMB   alt,+8196
         2 004267   402000 401760                    pmme    nvectors=5
         2 004270   005475 702000 2                  TSX2    WR_ALT

     1222    10786    3      I = 8;

  10786  2 004271   000010 235007                    LDA     8,DL
         2 004272   205217 755100                    STA     I,,AUTO

     1223    10787    4      DO WHILE(SUBSTR(JSP.ACCT,I-1,1)=' ');

  10787  2 004273   004276 710000 2                  TRA     s:10789

     1224    10788    4           I = I-1;

  10788  2 004274   000001 336007                    LCQ     1,DL
         2 004275   205217 056100                    ASQ     I,,AUTO

     1225    10789    4           END;

  10789  2 004276   204004 470500                    LDP0    REC$,,AUTO
         2 004277   205217 235100                    LDA     I,,AUTO
         2 004300   040000 106505                    CMPC    fill='040'O
         2 004301   000000 600001                    ADSC9   0,A,PR0                  cn=3,n=1
         2 004302   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004303   004274 600000 2                  TZE     s:10788

     1226    10790    3      CALL CONCAT(OBH.ACCT_NAME,SUBSTR(JSP.ACCT,0,I),',',JSP.USERNAME);

  10790  2 004304   000000 620005                    EAX0    0,AL
         2 004305   040100 100540                    MLR     fill='040'O
         2 004306   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
         2 004307   205175 000025                    ADSC9   OUT_BUF+5,,AUTO          cn=0,n=21
         2 004310   205217 236100                    LDQ     I,,AUTO
         2 004311   000025 116007                    CMPQ    21,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:209  
         2 004312   004327 605000 2                  TPL     s:10791
         2 004313   777752 620006                    EAX0    -22,QL
         2 004314   777777 660003                    ERX0    -1,DU
         2 004315   040146 100400                    MLR     fill='040'O
         2 004316   000126 000001 3                  ADSC9   86                       cn=0,n=1
         2 004317   205175 000010                    ADSC9   OUT_BUF+5,Q,AUTO         cn=0,n=*X0
         2 004320   000024 116007                    CMPQ    20,DL
         2 004321   004327 605000 2                  TPL     s:10791
         2 004322   777753 621006                    EAX1    -21,QL
         2 004323   777777 661003                    ERX1    -1,DU
         2 004324   040146 100500                    MLR     fill='040'O
         2 004325   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 004326   205175 200011                    ADSC9   OUT_BUF+5,Q,AUTO         cn=1,n=*X1

     1227    10791    3      OBH.AT = '@';

  10791  2 004327   100000 236007                    LDQ     32768,DL
         2 004330   205202 552110                    STBQ    OUT_BUF+10,'10'O,AUTO

     1228    10792    3      OBH.WSN = JSP.WOO;

  10792  2 004331   040100 100500                    MLR     fill='040'O
         2 004332   000016 000010                    ADSC9   14,,PR0                  cn=0,n=8
         2 004333   205202 600010                    ADSC9   OUT_BUF+10,,AUTO         cn=3,n=8

     1229    10793    3      OBH.SYSID_TXT = 'ID=';

  10793  2 004334   040100 100400                    MLR     fill='040'O
         2 004335   001771 000003 1                  ADSC9   XSJ_PARAMC+21            cn=0,n=3
         2 004336   205207 600003                    ADSC9   OUT_BUF+15,,AUTO         cn=3,n=3

     1230    10794    3      CALL BINCHAR(OBH.SYSID,JSP.SYSID);

  10794  2 004337   000036 236100                    LDQ     30,,PR0
         2 004340   777777 376007                    ANQ     -1,DL
         2 004341   000000 235003                    LDA     0,DU
         2 004342   205530 757100                    STAQ    DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:210  
         2 004343   000100 301500                    BTD
         2 004344   205530 000010                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 004345   205210 430006                    NDSC9   OUT_BUF+16,,AUTO         cn=2,s=nosgn,sf=0,n=6

     1231    10795    3      CALL EDITCHAR(OBH.SYSID,,,MOP_6_0_STR,OBH.SYSID);

  10795  2 004346   100000 024500                    MVNE
         2 004347   205210 430006                    NDSC9   OUT_BUF+16,,AUTO         cn=2,s=nosgn,sf=0,n=6
         2 004350   000555 000002 1                  ADSC9   MOP_6_0_STR              cn=0,n=2
         2 004351   205210 400006                    ADSC9   OUT_BUF+16,,AUTO         cn=2,n=6

     1232    10796    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10796  2 004352   000000 471400 xsym               LDP1    B$JIT$
         2 004353   100143 236100                    LDQ     99,,PR1
         2 004354   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 004355   004362 601000 2                  TNZ     s:10802

     1233    10797    3      THEN                                 /* Don't print if BREAK hit           */
     1234    10798    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10798  2 004356   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004357   440001 713400                    CLIMB   alt,write
         2 004360   401400 401760                    pmme    nvectors=4
         2 004361   005475 702000 2                  TSX2    WR_ALT

     1235    10799        /***********************************
     1236    10800         ****       put out the JOBNAME record
     1237    10801         ***********************************/
     1238    10802    3      IF JSP.JOBNAME.L~=0

  10802  2 004362   204004 470500                    LDP0    REC$,,AUTO
         2 004363   000006 236100                    LDQ     6,,PR0
         2 004364   777000 316003                    CANQ    -512,DU
         2 004365   004432 600000 2                  TZE     s:10813

     1239    10803    4      THEN DO;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:211  

     1240    10804    4           CALL CONCAT(OUT_BUF,SUBSTR(JOBNAME_LIT,0,32-JSP.JOBNAME.L),' ',

  10804  2 004366   000006 236100                    LDQ     6,,PR0
         2 004367   000033 772000                    QRL     27
         2 004370   777737 620006                    EAX0    -33,QL
         2 004371   777777 660003                    ERX0    -1,DU
         2 004372   040100 100440                    MLR     fill='040'O
         2 004373   001070 000010 1                  ADSC9   JOBNAME_LIT              cn=0,n=*X0
         2 004374   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72
         2 004375   000000 636010                    EAQ     0,X0
         2 004376   000022 772000                    QRL     18
         2 004377   000110 116007                    CMPQ    72,DL
         2 004400   004422 603000 2                  TRC     s:10806
         2 004401   205530 740100                    STX0    DCB$+2,,AUTO
         2 004402   777667 620010                    EAX0    -73,X0
         2 004403   777777 660003                    ERX0    -1,DU
         2 004404   205530 235100                    LDA     DCB$+2,,AUTO
         2 004405   000022 771000                    ARL     18
         2 004406   040145 100400                    MLR     fill='040'O
         2 004407   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004410   205170 000010                    ADSC9   OUT_BUF,A,AUTO           cn=0,n=*X0
         2 004411   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004412   000022 772000                    QRL     18
         2 004413   000107 116007                    CMPQ    71,DL
         2 004414   004422 603000 2                  TRC     s:10806
         2 004415   777670 620006                    EAX0    -72,QL
         2 004416   777777 660003                    ERX0    -1,DU
         2 004417   040146 100500                    MLR     fill='040'O
         2 004420   000006 200037                    ADSC9   6,,PR0                   cn=1,n=31
         2 004421   205170 200010                    ADSC9   OUT_BUF,Q,AUTO           cn=1,n=*X0

     1241    10805    4             JSP.JOBNAME.C);
     1242    10806    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10806  2 004422   000000 471400 xsym               LDP1    B$JIT$
         2 004423   100143 236100                    LDQ     99,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:212  
         2 004424   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 004425   004432 601000 2                  TNZ     s:10813

     1243    10807    4           THEN                            /* Don't print if BREAK hit           */
     1244    10808    4                CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10808  2 004426   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004427   440001 713400                    CLIMB   alt,write
         2 004430   401400 401760                    pmme    nvectors=4
         2 004431   005475 702000 2                  TSX2    WR_ALT

     1245    10809    4           END;

     1246    10810        /***********************************
     1247    10811         ****       put out the first record
     1248    10812         ***********************************/
     1249    10813    3      OUT_BUF = 'SUBMITTED';

  10813  2 004432   040100 100400                    MLR     fill='040'O
         2 004433   001772 000011 1                  ADSC9   XSJ_PARAMC+22            cn=0,n=9
         2 004434   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1250    10814    3      FPT_TIME.TSTAMP_ = VECTOR(JSP.SUBMIT);

  10814  2 004435   777640 235007                    LDA     -96,DL
         2 004436   204004 236100                    LDQ     REC$,,AUTO
         2 004437   000030 036003                    ADLQ    24,DU
         2 004440   204222 757100                    STAQ    FPT_TIME+8,,AUTO

     1251    10815    3      FPT_TIME.DATE_ = VECTOR(OBNC.TIM.DATE);

  10815  2 004441   000124 235000 3                  LDA     84
         2 004442   205530 452500                    STP2    DCB$+2,,AUTO
         2 004443   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004444   000127 036000 3                  ADLQ    87
         2 004445   204214 757100                    STAQ    FPT_TIME+2,,AUTO

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:213  
     1252    10816    3      FPT_TIME.TIME_ = VECTOR(OBNC.TIM.TIM);

  10816  2 004446   000023 235000 3                  LDA     19
         2 004447   205530 452500                    STP2    DCB$+2,,AUTO
         2 004450   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004451   000130 036000 3                  ADLQ    88
         2 004452   204216 757100                    STAQ    FPT_TIME+4,,AUTO

     1253    10817    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);

  10817  2 004453   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 004454   420004 713400                    CLIMB   alt,+8196
         2 004455   402000 401760                    pmme    nvectors=5
         2 004456   005475 702000 2                  TSX2    WR_ALT

     1254    10818    3      IF JSP.MODE=%M_BATCH#

  10818  2 004457   204004 470500                    LDP0    REC$,,AUTO
         2 004460   000036 236100                    LDQ     30,,PR0
         2 004461   777000 376003                    ANQ     -512,DU
         2 004462   001000 116003                    CMPQ    512,DU
         2 004463   004502 601000 2                  TNZ     s:10824

     1255    10819    4      THEN DO;

     1256    10820    4           OBNC.PRT2 = 'PRIORITY';

  10820  2 004464   040100 100400                    MLR     fill='040'O
         2 004465   001775 000010 1                  ADSC9   XSJ_PARAMC+25            cn=0,n=8
         2 004466   205201 600041                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=33

     1257    10821    4           CALL BINCHAR(OBNC.NUM2.NUM,JSP.PRIO);

  10821  2 004467   000035 236100                    LDQ     29,,PR0
         2 004470   000033 772000                    QRL     27
         2 004471   000000 235003                    LDA     0,DU
         2 004472   205530 757100                    STAQ    DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:214  
         2 004473   000100 301500                    BTD
         2 004474   205530 000010                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 004475   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7

     1258    10822    4           CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);

  10822  2 004476   100000 024500                    MVNE
         2 004477   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7
         2 004500   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 004501   205210 200007                    ADSC9   OUT_BUF+16,,AUTO         cn=1,n=7

     1259    10823    4           END;

     1260    10824    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10824  2 004502   000000 471400 xsym               LDP1    B$JIT$
         2 004503   100143 236100                    LDQ     99,,PR1
         2 004504   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 004505   004512 601000 2                  TNZ     s:10830

     1261    10825    3      THEN                                 /* Don't print if BREAK hit           */
     1262    10826    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10826  2 004506   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004507   440001 713400                    CLIMB   alt,write
         2 004510   401400 401760                    pmme    nvectors=4
         2 004511   005475 702000 2                  TSX2    WR_ALT

     1263    10827        /***********************************
     1264    10828         ****       put out the second record
     1265    10829         ***********************************/
     1266    10830    3      IF JSP.MODE=%M_BATCH#

  10830  2 004512   204004 470500                    LDP0    REC$,,AUTO
         2 004513   000036 236100                    LDQ     30,,PR0
         2 004514   777000 376003                    ANQ     -512,DU
         2 004515   001000 116003                    CMPQ    512,DU
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:215  
         2 004516   004570 601000 2                  TNZ     s:10849

     1267    10831    4      THEN DO;

     1268    10832    4           IF JSP.HOLD_UTS=0

  10832  2 004517   000033 235100                    LDA     27,,PR0
         2 004520   004525 601000 2                  TNZ     s:10835

     1269    10833    4           THEN OUT_BUF = ' ';

  10833  2 004521   040100 100400                    MLR     fill='040'O
         2 004522   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004523   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72
         2 004524   004540 710000 2                  TRA     s:10839

     1270    10834    5           ELSE DO;

     1271    10835    5                OUT_BUF = 'HOLD';

  10835  2 004525   040100 100400                    MLR     fill='040'O
         2 004526   001777 000004 1                  ADSC9   XSJ_PARAMC+27            cn=0,n=4
         2 004527   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1272    10836    5                FPT_TIME.TSTAMP_ = VECTOR(JSP.HOLD_UTS);

  10836  2 004530   777640 235007                    LDA     -96,DL
         2 004531   204004 236100                    LDQ     REC$,,AUTO
         2 004532   000033 036003                    ADLQ    27,DU
         2 004533   204222 757100                    STAQ    FPT_TIME+8,,AUTO

     1273    10837    5                CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);

  10837  2 004534   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 004535   420004 713400                    CLIMB   alt,+8196
         2 004536   402000 401760                    pmme    nvectors=5
         2 004537   005475 702000 2                  TSX2    WR_ALT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:216  

     1274    10838    5                END;

     1275    10839    4           OBNC.PRT2 = 'PARTITION';

  10839  2 004540   040100 100400                    MLR     fill='040'O
         2 004541   002000 000011 1                  ADSC9   XSJ_PARAMC+28            cn=0,n=9
         2 004542   205201 600041                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=33

     1276    10840    4           CALL BINCHAR(OBNC.NUM2.NUM,JSP.PART#);

  10840  2 004543   204004 470500                    LDP0    REC$,,AUTO
         2 004544   000035 236100                    LDQ     29,,PR0
         2 004545   000022 772000                    QRL     18
         2 004546   000777 376007                    ANQ     511,DL
         2 004547   000000 235003                    LDA     0,DU
         2 004550   205530 757100                    STAQ    DCB$+2,,AUTO
         2 004551   000100 301500                    BTD
         2 004552   205530 000010                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 004553   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7

     1277    10841    4           CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);

  10841  2 004554   100000 024500                    MVNE
         2 004555   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7
         2 004556   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 004557   205210 200007                    ADSC9   OUT_BUF+16,,AUTO         cn=1,n=7

     1278    10842    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10842  2 004560   000000 471400 xsym               LDP1    B$JIT$
         2 004561   100143 236100                    LDQ     99,,PR1
         2 004562   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 004563   004570 601000 2                  TNZ     s:10849

     1279    10843    4           THEN                            /* Don't print if BREAK hit           */
     1280    10844    4                CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:217  

  10844  2 004564   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004565   440001 713400                    CLIMB   alt,write
         2 004566   401400 401760                    pmme    nvectors=4
         2 004567   005475 702000 2                  TSX2    WR_ALT

     1281    10845    4           END;

     1282    10846        /***********************************
     1283    10847         ****       put out the third record
     1284    10848         ***********************************/
     1285    10849    3      OUT_BUF = 'STARTED';

  10849  2 004570   040100 100400                    MLR     fill='040'O
         2 004571   002003 000007 1                  ADSC9   XSJ_PARAMC+31            cn=0,n=7
         2 004572   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1286    10850    3      FPT_TIME.TSTAMP_ =  VECTOR(JSP.START);

  10850  2 004573   777640 235007                    LDA     -96,DL
         2 004574   204004 236100                    LDQ     REC$,,AUTO
         2 004575   000031 036003                    ADLQ    25,DU
         2 004576   204222 757100                    STAQ    FPT_TIME+8,,AUTO

     1287    10851    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);

  10851  2 004577   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 004600   420004 713400                    CLIMB   alt,+8196
         2 004601   402000 401760                    pmme    nvectors=5
         2 004602   005475 702000 2                  TSX2    WR_ALT

     1288    10852    3      OBNC.PRT2 = 'STEP';

  10852  2 004603   040100 100400                    MLR     fill='040'O
         2 004604   002005 000004 1                  ADSC9   XSJ_PARAMC+33            cn=0,n=4
         2 004605   205201 600041                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=33

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:218  
     1289    10853    3      CALL BINCHAR(OBNC.NUM2.NUM,JSP.STEP);

  10853  2 004606   204004 470500                    LDP0    REC$,,AUTO
         2 004607   000100 301500                    BTD
         2 004610   000056 000002                    NDSC9   46,,PR0                  cn=0,s=lsgnf,sf=0,n=2
         2 004611   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7

     1290    10854    3      CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);

  10854  2 004612   100000 024500                    MVNE
         2 004613   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7
         2 004614   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 004615   205210 200007                    ADSC9   OUT_BUF+16,,AUTO         cn=1,n=7

     1291    10855    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10855  2 004616   000000 471400 xsym               LDP1    B$JIT$
         2 004617   100143 236100                    LDQ     99,,PR1
         2 004620   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 004621   004626 601000 2                  TNZ     s:10861

     1292    10856    3      THEN                                 /* Don't print if BREAK hit           */
     1293    10857    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10857  2 004622   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004623   440001 713400                    CLIMB   alt,write
         2 004624   401400 401760                    pmme    nvectors=4
         2 004625   005475 702000 2                  TSX2    WR_ALT

     1294    10858        /***********************************
     1295    10859         ****       put out the fourth record
     1296    10860         ***********************************/
     1297    10861    3      OUT_BUF = 'ELAPSED';

  10861  2 004626   040100 100400                    MLR     fill='040'O
         2 004627   002006 000007 1                  ADSC9   XSJ_PARAMC+34            cn=0,n=7
         2 004630   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:219  

     1298    10862    3      FPT_TIME.TIME_ = VECTOR(OBNC.TIM1.TIM);

  10862  2 004631   000043 235000 3                  LDA     35
         2 004632   205530 452500                    STP2    DCB$+2,,AUTO
         2 004633   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004634   000044 036000 3                  ADLQ    36
         2 004635   204216 757100                    STAQ    FPT_TIME+4,,AUTO

     1299    10863    3      FPT_TIME.DATE_ = VECTOR(NIL);

  10863  2 004636   000026 237000 3                  LDAQ    22
         2 004637   204214 757100                    STAQ    FPT_TIME+2,,AUTO

     1300    10864    3      FPT_TIME.TSTAMP_ = VECTOR(JSP.ELAPSED);

  10864  2 004640   777640 235007                    LDA     -96,DL
         2 004641   204004 236100                    LDQ     REC$,,AUTO
         2 004642   000032 036003                    ADLQ    26,DU
         2 004643   204222 757100                    STAQ    FPT_TIME+8,,AUTO

     1301    10865    3      CALL M$TIME(FPT_TIME) ALTRET(WR_ALT);

  10865  2 004644   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 004645   420004 713400                    CLIMB   alt,+8196
         2 004646   402000 401760                    pmme    nvectors=5
         2 004647   005475 702000 2                  TSX2    WR_ALT

     1302    10866    3      T = JSP.ELAPSED/360000;

  10866  2 004650   204004 470500                    LDP0    REC$,,AUTO
         2 004651   000032 236100                    LDQ     26,,PR0
         2 004652   000001 772000                    QRL     1
         2 004653   537440 506007                    DIV     -82144,DL
         2 004654   205216 756100                    STQ     T,,AUTO

     1303    10867    3      CALL BINCHAR(OBNC.TIM2.HRS,T);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:220  

  10867  2 004655   000100 301500                    BTD
         2 004656   205216 000004                    NDSC9   T,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 004657   205175 230003                    NDSC9   OUT_BUF+5,,AUTO          cn=1,s=nosgn,sf=0,n=3

     1304    10868    3      CALL STRIP_TIME(ADDR(OBNC.TIM2.HRS),5);

  10868  2 004660   205530 452500                    STP2    DCB$+2,,AUTO
         2 004661   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004662   000131 036000 3                  ADLQ    89
         2 004663   205545 756100                    STQ     DCB$+15,,AUTO
         2 004664   000040 236000 3                  LDQ     32
         2 004665   205234 756100                    STQ     @TIME$+1,,AUTO
         2 004666   205545 631500                    EPPR1   DCB$+15,,AUTO
         2 004667   205233 451500                    STP1    DECFLT+5,,AUTO
         2 004670   006623 701000 2                  TSX1    STRIP_TIME
         2 004671   000000 011000                    NOP     0

     1305    10869    3      IF JSP.TYPE=%AZ$PROC

  10869  2 004672   204004 470500                    LDP0    REC$,,AUTO
         2 004673   000036 236100                    LDQ     30,,PR0
         2 004674   000777 376003                    ANQ     511,DU
         2 004675   000005 116003                    CMPQ    5,DU
         2 004676   004734 601000 2                  TNZ     s:10872

     1306    10870    3      THEN CALL CONCAT(OBNC.PRT2,SUBSTR(PROC_LIT,0,32-JSP.PROCNAME.L),

  10870  2 004677   000037 236100                    LDQ     31,,PR0
         2 004700   000033 772000                    QRL     27
         2 004701   777737 620006                    EAX0    -33,QL
         2 004702   777777 660003                    ERX0    -1,DU
         2 004703   040100 100440                    MLR     fill='040'O
         2 004704   001050 000010 1                  ADSC9   PROC_LIT                 cn=0,n=*X0
         2 004705   205201 600041                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=33
         2 004706   000000 636010                    EAQ     0,X0
         2 004707   000022 772000                    QRL     18
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:221  
         2 004710   000041 116007                    CMPQ    33,DL
         2 004711   004733 603000 2                  TRC     s:10870+28
         2 004712   205530 740100                    STX0    DCB$+2,,AUTO
         2 004713   777736 620010                    EAX0    -34,X0
         2 004714   777777 660003                    ERX0    -1,DU
         2 004715   205530 235100                    LDA     DCB$+2,,AUTO
         2 004716   000022 771000                    ARL     18
         2 004717   040145 100400                    MLR     fill='040'O
         2 004720   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004721   205201 600010                    ADSC9   OUT_BUF+9,A,AUTO         cn=3,n=*X0
         2 004722   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004723   000022 772000                    QRL     18
         2 004724   000040 116007                    CMPQ    32,DL
         2 004725   004733 603000 2                  TRC     s:10870+28
         2 004726   777737 620006                    EAX0    -33,QL
         2 004727   777777 660003                    ERX0    -1,DU
         2 004730   040146 100500                    MLR     fill='040'O
         2 004731   000037 200037                    ADSC9   31,,PR0                  cn=1,n=31
         2 004732   205202 000010                    ADSC9   OUT_BUF+10,Q,AUTO        cn=0,n=*X0
         2 004733   004772 710000 2                  TRA     s:10875

     1307    10871    3             ' ',JSP.PROCNAME.C);
     1308    10872    3      ELSE IF JSP.TYPE=%AZ$STEP

  10872  2 004734   000004 116003                    CMPQ    4,DU
         2 004735   004772 601000 2                  TNZ     s:10875

     1309    10873    3           THEN CALL CONCAT(OBNC.PRT2,SUBSTR(PROC1_LIT,0,32-JSP.PROCNAME.L),

  10873  2 004736   000037 236100                    LDQ     31,,PR0
         2 004737   000033 772000                    QRL     27
         2 004740   777737 620006                    EAX0    -33,QL
         2 004741   777777 660003                    ERX0    -1,DU
         2 004742   040100 100440                    MLR     fill='040'O
         2 004743   001060 000010 1                  ADSC9   PROC1_LIT                cn=0,n=*X0
         2 004744   205201 600041                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=33
         2 004745   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:222  
         2 004746   000022 772000                    QRL     18
         2 004747   000041 116007                    CMPQ    33,DL
         2 004750   004772 603000 2                  TRC     s:10875
         2 004751   205530 740100                    STX0    DCB$+2,,AUTO
         2 004752   777736 620010                    EAX0    -34,X0
         2 004753   777777 660003                    ERX0    -1,DU
         2 004754   205530 235100                    LDA     DCB$+2,,AUTO
         2 004755   000022 771000                    ARL     18
         2 004756   040145 100400                    MLR     fill='040'O
         2 004757   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004760   205201 600010                    ADSC9   OUT_BUF+9,A,AUTO         cn=3,n=*X0
         2 004761   205530 236100                    LDQ     DCB$+2,,AUTO
         2 004762   000022 772000                    QRL     18
         2 004763   000040 116007                    CMPQ    32,DL
         2 004764   004772 603000 2                  TRC     s:10875
         2 004765   777737 620006                    EAX0    -33,QL
         2 004766   777777 660003                    ERX0    -1,DU
         2 004767   040146 100500                    MLR     fill='040'O
         2 004770   000037 200037                    ADSC9   31,,PR0                  cn=1,n=31
         2 004771   205202 000010                    ADSC9   OUT_BUF+10,Q,AUTO        cn=0,n=*X0

     1310    10874    3                  ' ',JSP.PROCNAME.C);
     1311    10875    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10875  2 004772   000000 471400 xsym               LDP1    B$JIT$
         2 004773   100143 236100                    LDQ     99,,PR1
         2 004774   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 004775   005002 601000 2                  TNZ     s:10881

     1312    10876    3      THEN                                 /* Don't print if BREAK hit           */
     1313    10877    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10877  2 004776   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 004777   440001 713400                    CLIMB   alt,write
         2 005000   401400 401760                    pmme    nvectors=4
         2 005001   005475 702000 2                  TSX2    WR_ALT

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:223  
     1314    10878        /***********************************
     1315    10879         ****       put out the fifth record
     1316    10880         ***********************************/
     1317    10881    3      OUT_BUF = 'PERMANENT DISK USED';

  10881  2 005002   040100 100400                    MLR     fill='040'O
         2 005003   002010 000023 1                  ADSC9   XSJ_PARAMC+36            cn=0,n=19
         2 005004   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1318    10882    3      CALL BINXCHAR(OBNC.NUM1.NUM,JSP.PRDPUSED);

  10882  2 005005   204004 470500                    LDP0    REC$,,AUTO
         2 005006   000100 301500                    BTD
         2 005007   000064 000004                    NDSC9   52,,PR0                  cn=0,s=lsgnf,sf=0,n=4
         2 005010   205176 410007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=lsgns,sf=0,n=7

     1319    10883    3      CALL EDITXCHAR(OBNC.NUM1.NUM,,,MOPS_6_0_STR,OBNC.NUM1.NUM);

  10883  2 005011   100000 024500                    MVNE
         2 005012   205176 410007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=lsgns,sf=0,n=7
         2 005013   000543 000005 1                  ADSC9   MOPS_6_0_STR             cn=0,n=5
         2 005014   205176 400007                    ADSC9   OUT_BUF+6,,AUTO          cn=2,n=7

     1320    10884    3      OBNC.PRT2 = 'STEP CONDITION CODE';

  10884  2 005015   040100 100400                    MLR     fill='040'O
         2 005016   002015 000023 1                  ADSC9   XSJ_PARAMC+41            cn=0,n=19
         2 005017   205201 600041                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=33

     1321    10885    3      CALL BINCHAR(OBNC.NUM2.NUM,JSP.STEPCC);

  10885  2 005020   000057 236100                    LDQ     47,,PR0
         2 005021   000033 772000                    QRL     27
         2 005022   000000 235003                    LDA     0,DU
         2 005023   205530 757100                    STAQ    DCB$+2,,AUTO
         2 005024   000100 301500                    BTD
         2 005025   205530 000010                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:224  
         2 005026   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7

     1322    10886    3      CALL EDITCHAR(OBNC.NUM2.NUM,,,MOP_7_0_STR,OBNC.NUM2.NUM);

  10886  2 005027   100000 024500                    MVNE
         2 005030   205210 230007                    NDSC9   OUT_BUF+16,,AUTO         cn=1,s=nosgn,sf=0,n=7
         2 005031   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 005032   205210 200007                    ADSC9   OUT_BUF+16,,AUTO         cn=1,n=7

     1323    10887    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10887  2 005033   000000 471400 xsym               LDP1    B$JIT$
         2 005034   100143 236100                    LDQ     99,,PR1
         2 005035   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 005036   005043 601000 2                  TNZ     s:10893

     1324    10888    3      THEN                                 /* Don't print if BREAK hit           */
     1325    10889    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10889  2 005037   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 005040   440001 713400                    CLIMB   alt,write
         2 005041   401400 401760                    pmme    nvectors=4
         2 005042   005475 702000 2                  TSX2    WR_ALT

     1326    10890        /***********************************
     1327    10891         ****       put out the sixth record
     1328    10892         ***********************************/
     1329    10893    3      IF JSP.TYPE=%AZ$PROC

  10893  2 005043   204004 470500                    LDP0    REC$,,AUTO
         2 005044   000036 236100                    LDQ     30,,PR0
         2 005045   000777 376003                    ANQ     511,DU
         2 005046   000005 116003                    CMPQ    5,DU
         2 005047   005054 601000 2                  TNZ     s:10896

     1330    10894    3      THEN OUT_BUF = ' ';

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:225  
  10894  2 005050   040100 100400                    MLR     fill='040'O
         2 005051   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005052   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72
         2 005053   005066 710000 2                  TRA     s:10900

     1331    10895    4      ELSE DO;

     1332    10896    4           OUT_BUF = 'PEAK TEMPORARY DISK';

  10896  2 005054   040100 100400                    MLR     fill='040'O
         2 005055   002022 000023 1                  ADSC9   XSJ_PARAMC+46            cn=0,n=19
         2 005056   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1333    10897    4           CALL BINCHAR(OBNC.NUM1.NUM,JSP.TMDPPK);

  10897  2 005057   000100 301500                    BTD
         2 005060   000063 000004                    NDSC9   51,,PR0                  cn=0,s=lsgnf,sf=0,n=4
         2 005061   205176 430007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=nosgn,sf=0,n=7

     1334    10898    4           CALL EDITCHAR(OBNC.NUM1.NUM,,,MOP_7_0_STR,OBNC.NUM1.NUM);

  10898  2 005062   100000 024500                    MVNE
         2 005063   205176 430007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=nosgn,sf=0,n=7
         2 005064   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 005065   205176 400007                    ADSC9   OUT_BUF+6,,AUTO          cn=2,n=7

     1335    10899    4           END;

     1336    10900    4      DO I = 0 TO SIZEC(RNST_TBL)/SIZEC(RNST_TBL(0))-1;

  10900  2 005066   205217 450100                    STZ     I,,AUTO
         2 005067   005127 710000 2                  TRA     s:10907+1

     1337    10901    4           IF (JSP.RNST & RNST_TBL.MASK(I)) = JSP.RNST

  10901  2 005070   205217 236100                    LDQ     I,,AUTO
         2 005071   000007 402007                    MPY     7,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:226  
         2 005072   001107 236006 1                  LDQ     RNST_TBL+6,QL
         2 005073   777000 376003                    ANQ     -512,DU
         2 005074   205530 756100                    STQ     DCB$+2,,AUTO
         2 005075   204004 470500                    LDP0    REC$,,AUTO
         2 005076   000057 236100                    LDQ     47,,PR0
         2 005077   000011 736000                    QLS     9
         2 005100   777000 376003                    ANQ     -512,DU
         2 005101   205530 376100                    ANQ     DCB$+2,,AUTO
         2 005102   205531 756100                    STQ     DCB$+3,,AUTO
         2 005103   000100 106500                    CMPC    fill='000'O
         2 005104   205531 000004                    ADSC9   DCB$+3,,AUTO             cn=0,n=4
         2 005105   000057 200001                    ADSC9   47,,PR0                  cn=1,n=1
         2 005106   005126 601000 2                  TNZ     s:10907

     1338    10902    5           THEN DO;

     1339    10903    5                CALL CONCAT(OBNC.PRT2,'END STATUS: ',SUBSTR(RNST_TBL.TEXT(I),

  10903  2 005107   205217 236100                    LDQ     I,,AUTO
         2 005110   000007 402007                    MPY     7,DL
         2 005111   001101 236006 1                  LDQ     RNST_TBL,QL
         2 005112   000033 772000                    QRL     27
         2 005113   040100 100400                    MLR     fill='040'O
         2 005114   002027 000014 1                  ADSC9   XSJ_PARAMC+51            cn=0,n=12
         2 005115   205201 600014                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=12
         2 005116   000000 620006                    EAX0    0,QL
         2 005117   205217 236100                    LDQ     I,,AUTO
         2 005120   000034 402007                    MPY     28,DL
         2 005121   040100 100446                    MLR     fill='040'O
         2 005122   001101 200010 1                  ADSC9   RNST_TBL,Q               cn=1,n=*X0
         2 005123   205204 600025                    ADSC9   OUT_BUF+12,,AUTO         cn=3,n=21

     1340    10904    5                  0,RNST_TBL.LEN(I)));
     1341    10905    5                I = SIZEC(RNST_TBL)/SIZEC(RNST_TBL(0))-1;

  10905  2 005124   000011 235007                    LDA     9,DL
         2 005125   205217 755100                    STA     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:227  

     1342    10906    5                END;

     1343    10907    4           END;

  10907  2 005126   205217 054100                    AOS     I,,AUTO
         2 005127   205217 235100                    LDA     I,,AUTO
         2 005130   000011 115007                    CMPA    9,DL
         2 005131   005070 604400 2                  TMOZ    s:10901

     1344    10908    3      IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10908  2 005132   000000 470400 xsym               LDP0    B$JIT$
         2 005133   000143 236100                    LDQ     99,,PR0
         2 005134   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 005135   005142 601000 2                  TNZ     s:10914

     1345    10909    3      THEN                                 /* Don't print if BREAK hit           */
     1346    10910    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10910  2 005136   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 005137   440001 713400                    CLIMB   alt,write
         2 005140   401400 401760                    pmme    nvectors=4
         2 005141   005475 702000 2                  TSX2    WR_ALT

     1347    10911        /***********************************
     1348    10912         ****       put out the seventh record
     1349    10913         ***********************************/
     1350    10914    3      IF JSP.TYPE=%AZ$PROC

  10914  2 005142   204004 470500                    LDP0    REC$,,AUTO
         2 005143   000036 236100                    LDQ     30,,PR0
         2 005144   000777 376003                    ANQ     511,DU
         2 005145   000005 116003                    CMPQ    5,DU
         2 005146   005153 601000 2                  TNZ     s:10917

     1351    10915    3      THEN OUT_BUF = ' ';
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:228  

  10915  2 005147   040100 100400                    MLR     fill='040'O
         2 005150   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005151   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72
         2 005152   005165 710000 2                  TRA     s:10921

     1352    10916    4      ELSE DO;

     1353    10917    4           OUT_BUF = 'PEAK MEMORY';

  10917  2 005153   040100 100400                    MLR     fill='040'O
         2 005154   002032 000013 1                  ADSC9   XSJ_PARAMC+54            cn=0,n=11
         2 005155   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1354    10918    4           CALL BINCHAR(OBNC.NUM1.NUM,JSP.PKCO);

  10918  2 005156   000100 301500                    BTD
         2 005157   000055 400002                    NDSC9   45,,PR0                  cn=2,s=lsgnf,sf=0,n=2
         2 005160   205176 430007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=nosgn,sf=0,n=7

     1355    10919    4           CALL EDITCHAR(OBNC.NUM1.NUM,,,MOP_7_0_STR,OBNC.NUM1.NUM);

  10919  2 005161   100000 024500                    MVNE
         2 005162   205176 430007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=nosgn,sf=0,n=7
         2 005163   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 005164   205176 400007                    ADSC9   OUT_BUF+6,,AUTO          cn=2,n=7

     1356    10920    4           END;

     1357    10921    3      IF JSP.RNST & %RS_LIMX#

  10921  2 005165   000057 236100                    LDQ     47,,PR0
         2 005166   000011 736000                    QLS     9
         2 005167   777000 376003                    ANQ     -512,DU
         2 005170   100000 376003                    ANQ     32768,DU
         2 005171   005254 600000 2                  TZE     s:10940

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:229  
     1358    10922    4      THEN DO;

     1359    10923    4           OBNC.PRT2 = 'LIMIT EXCEEDED: ';

  10923  2 005172   040100 100400                    MLR     fill='040'O
         2 005173   002035 000020 1                  ADSC9   XSJ_PARAMC+57            cn=0,n=16
         2 005174   205201 600041                    ADSC9   OUT_BUF+9,,AUTO          cn=3,n=33

     1360    10924    4           TEMP$ = PINCRC(ADDR(OBNC.PRT2),SIZEC('LIMIT EXCEEDED: '));

  10924  2 005175   205530 452500                    STP2    DCB$+2,,AUTO
         2 005176   205530 236100                    LDQ     DCB$+2,,AUTO
         2 005177   000132 036000 3                  ADLQ    90
         2 005200   205214 756100                    STQ     TEMP$,,AUTO

     1361    10925    4           TEMP1$ = TEMP$;

  10925  2 005201   205215 756100                    STQ     TEMP1$,,AUTO

     1362    10926    5           DO I=0 TO SIZEC(XLIM_TBL)/SIZEC(XLIM_TBL(0))-1;

  10926  2 005202   205217 450100                    STZ     I,,AUTO
         2 005203   005251 710000 2                  TRA     s:10938+1

     1363    10927    5                IF JSP.XLIMFLG & XLIM_TBL.MASK(I)

  10927  2 005204   205217 235100                    LDA     I,,AUTO
         2 005205   000001 735000                    ALS     1
         2 005206   001210 236005 1                  LDQ     XLIM_TBL+1,AL
         2 005207   000033 736000                    QLS     27
         2 005210   205530 756100                    STQ     DCB$+2,,AUTO
         2 005211   204004 470500                    LDP0    REC$,,AUTO
         2 005212   000057 236100                    LDQ     47,,PR0
         2 005213   000022 736000                    QLS     18
         2 005214   777000 376003                    ANQ     -512,DU
         2 005215   205530 376100                    ANQ     DCB$+2,,AUTO
         2 005216   005250 600000 2                  TZE     s:10938
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:230  

     1364    10928    6                THEN DO;

     1365    10929    6                     IF TEMP$ ~= TEMP1$

  10929  2 005217   205214 236100                    LDQ     TEMP$,,AUTO
         2 005220   205215 116100                    CMPQ    TEMP1$,,AUTO
         2 005221   005230 600000 2                  TZE     s:10934

     1366    10930    7                     THEN DO;              /* Insert a comma if not first one    */

     1367    10931    7                          CALL CONCAT(TEMP$->LIM$TEXT,',');

  10931  2 005222   205214 471500                    LDP1    TEMP$,,AUTO
         2 005223   040100 100400                    MLR     fill='040'O
         2 005224   000126 000001 3                  ADSC9   86                       cn=0,n=1
         2 005225   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5

     1368    10932    7                          TEMP$ = PINCRC(TEMP$,1);

  10932  2 005226   200000 036007                    ADLQ    65536,DL
         2 005227   205214 756100                    STQ     TEMP$,,AUTO

     1369    10933    7                          END;

     1370    10934    6                     CALL INSERT(TEMP$->LIM$TEXT,0,XLIM_TBL.LEN(I),

  10934  2 005230   001207 236005 1                  LDQ     XLIM_TBL,AL
         2 005231   000033 772000                    QRL     27
         2 005232   205217 235100                    LDA     I,,AUTO
         2 005233   000003 735000                    ALS     3
         2 005234   205214 471500                    LDP1    TEMP$,,AUTO
         2 005235   000000 620006                    EAX0    0,QL
         2 005236   040140 100405                    MLR     fill='040'O
         2 005237   001207 200006 1                  ADSC9   XLIM_TBL,A               cn=1,n=6
         2 005240   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:231  
     1371    10935    6                       XLIM_TBL.HDR(I));
     1372    10936    6                     TEMP$ = PINCRC(TEMP$,XLIM_TBL.LEN(I));

  10936  2 005241   205217 236100                    LDQ     I,,AUTO
         2 005242   000001 736000                    QLS     1
         2 005243   001207 236006 1                  LDQ     XLIM_TBL,QL
         2 005244   000033 772000                    QRL     27
         2 005245   000020 736000                    QLS     16
         2 005246   205214 036100                    ADLQ    TEMP$,,AUTO
         2 005247   205214 756100                    STQ     TEMP$,,AUTO

     1373    10937    6                     END;

     1374    10938    5                END;

  10938  2 005250   205217 054100                    AOS     I,,AUTO
         2 005251   205217 235100                    LDA     I,,AUTO
         2 005252   000010 115007                    CMPA    8,DL
         2 005253   005204 604400 2                  TMOZ    s:10927

     1375    10939    4           END;

     1376    10940    3      IF NOT ((B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#) OR OUT_BUF=' ')

  10940  2 005254   000000 471400 xsym               LDP1    B$JIT$
         2 005255   100143 236100                    LDQ     99,,PR1
         2 005256   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 005257   005270 601000 2                  TNZ     s:10946
         2 005260   040000 106500                    CMPC    fill='040'O
         2 005261   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72
         2 005262   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005263   005270 600000 2                  TZE     s:10946

     1377    10941    3      THEN                                 /* Don't print if BREAK hit           */
     1378    10942    3           CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10942  2 005264   204350 630500                    EPPR0   FPT_WRITE,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:232  
         2 005265   440001 713400                    CLIMB   alt,write
         2 005266   401400 401760                    pmme    nvectors=4
         2 005267   005475 702000 2                  TSX2    WR_ALT

     1379    10943        /***********************************
     1380    10944         ****       put out the eighth record
     1381    10945         ***********************************/
     1382    10946    3      IF JSP.TYPE~=%AZ$PROC

  10946  2 005270   204004 470500                    LDP0    REC$,,AUTO
         2 005271   000036 236100                    LDQ     30,,PR0
         2 005272   000777 376003                    ANQ     511,DU
         2 005273   000005 116003                    CMPQ    5,DU
         2 005274   005317 600000 2                  TZE     s:10958

     1383    10947    4      THEN DO;

     1384    10948    4           OUT_BUF = 'RESOURCE MEMORY REQUIRED';

  10948  2 005275   040100 100400                    MLR     fill='040'O
         2 005276   002041 000030 1                  ADSC9   XSJ_PARAMC+61            cn=0,n=24
         2 005277   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1385    10949    4           CALL BINCHAR(OBNC.NUM1.NUM,JSP.RESPEAK);

  10949  2 005300   000100 301500                    BTD
         2 005301   000055 000002                    NDSC9   45,,PR0                  cn=0,s=lsgnf,sf=0,n=2
         2 005302   205176 430007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=nosgn,sf=0,n=7

     1386    10950    4           CALL EDITCHAR(OBNC.NUM1.NUM,,,MOP_7_0_STR,OBNC.NUM1.NUM);

  10950  2 005303   100000 024500                    MVNE
         2 005304   205176 430007                    NDSC9   OUT_BUF+6,,AUTO          cn=2,s=nosgn,sf=0,n=7
         2 005305   000557 000002 1                  ADSC9   MOP_7_0_STR              cn=0,n=2
         2 005306   205176 400007                    ADSC9   OUT_BUF+6,,AUTO          cn=2,n=7

     1387    10951    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:233  

  10951  2 005307   000000 471400 xsym               LDP1    B$JIT$
         2 005310   100143 236100                    LDQ     99,,PR1
         2 005311   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 005312   005317 601000 2                  TNZ     s:10958

     1388    10952    4           THEN CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10952  2 005313   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 005314   440001 713400                    CLIMB   alt,write
         2 005315   401400 401760                    pmme    nvectors=4
         2 005316   005475 702000 2                  TSX2    WR_ALT

     1389    10953                                                /* Don't print if BREAK hit           */
     1390    10954    4           END;

     1391    10955        /***********************************
     1392    10956         ****       put out the pseudo-resource record(s)
     1393    10957         ***********************************/
     1394    10958    3      IF JSP.SUDOX>0

  10958  2 005317   204004 470500                    LDP0    REC$,,AUTO
         2 005320   000133 235100                    LDA     91,,PR0
         2 005321   005474 604400 2                  TMOZ    s:10991

     1395    10959    4      THEN DO;

     1396    10960    4           OUT_BUF = 'PSEUDOS';

  10960  2 005322   040100 100400                    MLR     fill='040'O
         2 005323   002047 000007 1                  ADSC9   XSJ_PARAMC+67            cn=0,n=7
         2 005324   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1397    10961    4           IF JSP.SUDO_CNT>5

  10961  2 005325   000134 235100                    LDA     92,,PR0
         2 005326   000005 115007                    CMPA    5,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:234  
         2 005327   005333 604400 2                  TMOZ    s:10963

     1398    10962    4           THEN I = 5;

  10962  2 005330   000005 236007                    LDQ     5,DL
         2 005331   205217 756100                    STQ     I,,AUTO
         2 005332   005334 710000 2                  TRA     s:10964

     1399    10963    4           ELSE I = JSP.SUDO_CNT;

  10963  2 005333   205217 755100                    STA     I,,AUTO

     1400    10964    5           DO WHILE(I>0);

  10964  2 005334   205217 236100                    LDQ     I,,AUTO
         2 005335   005400 604400 2                  TMOZ    s:10971

     1401    10965    5                I = I - 1;

  10965  2 005336   000001 336007                    LCQ     1,DL
         2 005337   205217 056100                    ASQ     I,,AUTO

     1402    10966    5                OBP.SUDO.NAME(I) = SUDO.NAM(I);

  10966  2 005340   205217 236100                    LDQ     I,,AUTO
         2 005341   000024 402007                    MPY     20,DL
         2 005342   205530 756100                    STQ     DCB$+2,,AUTO
         2 005343   205217 236100                    LDQ     I,,AUTO
         2 005344   000015 402007                    MPY     13,DL
         2 005345   205213 470500                    LDP0    SUDO$,,AUTO
         2 005346   205530 235100                    LDA     DCB$+2,,AUTO
         2 005347   040106 100505                    MLR     fill='040'O
         2 005350   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
         2 005351   205172 200010                    ADSC9   OUT_BUF+2,Q,AUTO         cn=1,n=8

     1403    10967    5                OBP.SUDO.EQ(I) = '=';

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:235  
  10967  2 005352   040106 100400                    MLR     fill='040'O
         2 005353   000133 000001 3                  ADSC9   91                       cn=0,n=1
         2 005354   205174 200001                    ADSC9   OUT_BUF+4,Q,AUTO         cn=1,n=1

     1404    10968    5                CALL BINCHAR(OBP.SUDO.NUM(I),SUDO.MAX(I));

  10968  2 005355   205530 756100                    STQ     DCB$+2,,AUTO
         2 005356   205217 236100                    LDQ     I,,AUTO
         2 005357   000005 402007                    MPY     5,DL
         2 005360   000002 236106                    LDQ     2,QL,PR0
         2 005361   000033 772000                    QRL     27
         2 005362   000000 235003                    LDA     0,DU
         2 005363   205532 757100                    STAQ    DCB$+4,,AUTO
         2 005364   205530 235100                    LDA     DCB$+2,,AUTO
         2 005365   000105 301500                    BTD
         2 005366   205532 000010                    NDSC9   DCB$+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 005367   205174 430002                    NDSC9   OUT_BUF+4,A,AUTO         cn=2,s=nosgn,sf=0,n=2

     1405    10969    5                CALL EDITCHAR(OBP.SUDO.NUM(I),,,MOP_2_0_STR,OBP.SUDO.NUM(I));

  10969  2 005370   205217 236100                    LDQ     I,,AUTO
         2 005371   000015 402007                    MPY     13,DL
         2 005372   106000 024506                    MVNE
         2 005373   205174 430002                    NDSC9   OUT_BUF+4,Q,AUTO         cn=2,s=nosgn,sf=0,n=2
         2 005374   000552 000002 1                  ADSC9   MOP_2_0_STR              cn=0,n=2
         2 005375   205174 400002                    ADSC9   OUT_BUF+4,Q,AUTO         cn=2,n=2

     1406    10970    5                END;

  10970  2 005376   205217 235100                    LDA     I,,AUTO
         2 005377   005336 605400 2                  TPNZ    s:10965

     1407    10971    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10971  2 005400   000000 470400 xsym               LDP0    B$JIT$
         2 005401   000143 236100                    LDQ     99,,PR0
         2 005402   000006 376000 xsym               ANQ     B_VECTNIL+6
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:236  
         2 005403   005410 601000 2                  TNZ     s:10974

     1408    10972    4           THEN                            /* Don't print if BREAK hit           */
     1409    10973    4                CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10973  2 005404   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 005405   440001 713400                    CLIMB   alt,write
         2 005406   401400 401760                    pmme    nvectors=4
         2 005407   005475 702000 2                  TSX2    WR_ALT

     1410    10974    4           IF JSP.SUDO_CNT>5

  10974  2 005410   204004 470500                    LDP0    REC$,,AUTO
         2 005411   000134 235100                    LDA     92,,PR0
         2 005412   000005 115007                    CMPA    5,DL
         2 005413   005474 604400 2                  TMOZ    s:10991

     1411    10975    5           THEN DO;

     1412    10976    5                I = JSP.SUDO_CNT;

  10976  2 005414   205217 755100                    STA     I,,AUTO

     1413    10977    5                OUT_BUF = ' ';

  10977  2 005415   040100 100400                    MLR     fill='040'O
         2 005416   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005417   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1414    10978    6                DO WHILE(I>5);

  10978  2 005420   005464 604400 2                  TMOZ    s:10986

     1415    10979    6                     I = I - 1;

  10979  2 005421   000001 336007                    LCQ     1,DL
         2 005422   205217 056100                    ASQ     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:237  

     1416    10980    6                     OBP.SUDO.NAME(I) = SUDO.NAM(I+5);

  10980  2 005423   205217 236100                    LDQ     I,,AUTO
         2 005424   000024 402007                    MPY     20,DL
         2 005425   205530 756100                    STQ     DCB$+2,,AUTO
         2 005426   205217 236100                    LDQ     I,,AUTO
         2 005427   000015 402007                    MPY     13,DL
         2 005430   205213 470500                    LDP0    SUDO$,,AUTO
         2 005431   205530 235100                    LDA     DCB$+2,,AUTO
         2 005432   040106 100505                    MLR     fill='040'O
         2 005433   000031 000010                    ADSC9   25,A,PR0                 cn=0,n=8
         2 005434   205172 200010                    ADSC9   OUT_BUF+2,Q,AUTO         cn=1,n=8

     1417    10981    6                     OBP.SUDO.EQ(I) = '=';

  10981  2 005435   040106 100400                    MLR     fill='040'O
         2 005436   000133 000001 3                  ADSC9   91                       cn=0,n=1
         2 005437   205174 200001                    ADSC9   OUT_BUF+4,Q,AUTO         cn=1,n=1

     1418    10982    6                     CALL BINCHAR(OBP.SUDO.NUM(I),SUDO.MAX(I+5));

  10982  2 005440   205530 756100                    STQ     DCB$+2,,AUTO
         2 005441   205217 236100                    LDQ     I,,AUTO
         2 005442   000005 402007                    MPY     5,DL
         2 005443   000033 236106                    LDQ     27,QL,PR0
         2 005444   000033 772000                    QRL     27
         2 005445   000000 235003                    LDA     0,DU
         2 005446   205532 757100                    STAQ    DCB$+4,,AUTO
         2 005447   205530 235100                    LDA     DCB$+2,,AUTO
         2 005450   000105 301500                    BTD
         2 005451   205532 000010                    NDSC9   DCB$+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 005452   205174 430002                    NDSC9   OUT_BUF+4,A,AUTO         cn=2,s=nosgn,sf=0,n=2

     1419    10983    6                     CALL EDITCHAR(OBP.SUDO.NUM(I),,,MOP_2_0_STR,

  10983  2 005453   205217 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:238  
         2 005454   000015 402007                    MPY     13,DL
         2 005455   106000 024506                    MVNE
         2 005456   205174 430002                    NDSC9   OUT_BUF+4,Q,AUTO         cn=2,s=nosgn,sf=0,n=2
         2 005457   000552 000002 1                  ADSC9   MOP_2_0_STR              cn=0,n=2
         2 005460   205174 400002                    ADSC9   OUT_BUF+4,Q,AUTO         cn=2,n=2

     1420    10984    6                       OBP.SUDO.NUM(I));
     1421    10985    6                     END;

  10985  2 005461   205217 235100                    LDA     I,,AUTO
         2 005462   000005 115007                    CMPA    5,DL
         2 005463   005421 605400 2                  TPNZ    s:10979

     1422    10986    5                IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  10986  2 005464   000000 470400 xsym               LDP0    B$JIT$
         2 005465   000143 236100                    LDQ     99,,PR0
         2 005466   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 005467   005474 601000 2                  TNZ     s:10991

     1423    10987    5                THEN                       /* Don't print if BREAK hit           */
     1424    10988    5                     CALL M$WRITE(FPT_WRITE) ALTRET(WR_ALT);

  10988  2 005470   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 005471   440001 713400                    CLIMB   alt,write
         2 005472   401400 401760                    pmme    nvectors=4
         2 005473   005475 702000 2                  TSX2    WR_ALT

     1425    10989    5                END;

     1426    10990    4           END;

     1427    10991    4      DO WHILE('0'B);

  10991  2 005474   005506 710000 2                  TRA     s:10994

     1428    10992    4   WR_ALT: CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:239  

  10992  2 005475   000001 236000 xsym  WR_ALT       LDQ     B_VECTNIL+1
         2 005476   205525 756100                    STQ     @DCB#+1,,AUTO
         2 005477   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 005500   000042 036000 3                  ADLQ    34
         2 005501   205524 756100                    STQ     @ERR+1,,AUTO
         2 005502   000011 236000 3                  LDQ     9
         2 005503   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 005504   011343 701000 2                  TSX1    POST_ERR
         2 005505   000000 011000                    NOP     0

     1429    10993    4           END;

     1430    10994    3      FPT_TIME.DATE_ = VECTOR(NIL);

  10994  2 005506   000026 237000 3                  LDAQ    22
         2 005507   204214 757100                    STAQ    FPT_TIME+2,,AUTO

     1431    10995    3      RETURN;

  10995  2 005510   205212 221300                    LDX1  ! OUT_BUF+18,,AUTO
         2 005511   000001 702211                    TSX2  ! 1,X1

     1432    10996    3   END NO_CHG;
     1433    10997        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:240  
     1434    10998    2   CHG: PROC(IDX,CNT,RATE,PRATE,JSNAME);

  10998  2 005512   205212 741300       CHG          STX1  ! OUT_BUF+18,,AUTO

     1435    10999        /*I* NAME: CHG
     1436    11000             CALL: CALL CHG(IDX,CNT,RATE,PRATE,JSNAME);
     1437    11001                where: IDX is a unique index into ITBL for this chargable item
     1438    11002                       CNT is the number of items to charge for
     1439    11003                       RATE is a decimal number...rate per unit
     1440    11004                       PRATE is a decimal number...rate per unit from a processor tbl
     1441    11005                       JSNAME is a character string...name of this job or step unit
     1442    11006             PURPOSE: To generate a line of output for this chargable item and output
     1443    11007             it. Also to accumulate processor charges for later (or current) use
     1444    11008        */
     1445    11009    3   DCL IDX SBIN;
     1446    11010    3   DCL CNT SBIN;
     1447    11011    3   DCL CHG_VAL SBIN;
     1448    11012    3   DCL RATE BIT(72) ALIGNED;
     1449    11013    3   DCL PRATE BIT(72) ALIGNED;
     1450    11014    3   DCL JSNAME CHAR(16);
     1451    11015    3   DCL 1 ITBL(0:32) CONSTANT,              /* ITBL is a table containing         */
     1452    11016                                                /* necessary  information about       */
     1453    11017                                                /* the chargable item indexed by      */
     1454    11018                                                /* IDX                                */
     1455    11019    3         2 NAME CHAR(21) INIT(             /* NAME is the name of this item      */
     1456    11020    3           'JOB STEPS',
     1457    11021    3           'PMMES ISSUED',
     1458    11022    3           'FEP INTERRUPT LEVELS',
     1459    11023    3           'TERMINAL INTERACTIONS',
     1460    11024    3           'CONNECT TIME',
     1461    11025    3           '  PROC EXEC TIME',
     1462    11026    3           '  USER EXEC TIME',
     1463    11027    3           '  PROC SERVICE TIME',
     1464    11028    3           '  USER SERVICE TIME',
     1465    11029    3           'PROC MEMORY USED',
     1466    11030    3           'USER MEMORY USED',
     1467    11031    3           'TEMP DISK USED',
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:241  
     1468    11032    3           'RESOURCE TAPE(CPU)',
     1469    11033    3           'RESOURCE TAPE(CLOCK)',
     1470    11034    3           'RESOURCE DISK(CPU)',
     1471    11035    3           'RESOURCE DISK(CLOCK)',
     1472    11036    3           'RESOURCE OTHER(CPU)',
     1473    11037    3           'RESOURCE OTHER(CLOCK)',
     1474    11038    3           'TAPE ACCESSES',
     1475    11039    3           'DISK ACCESSES',
     1476    11040    3           'OTHER ACCESSES',
     1477    11041    3           'TAPE MOUNTS',
     1478    11042    3           'DISK MOUNTS',
     1479    11043    3           'OTHER MOUNTS',
     1480    11044    3           'SUNIT1',
     1481    11045    3           'SUNIT2',
     1482    11046    3           'SUNIT3',
     1483    11047    3           'SUNIT4',
     1484    11048    3           'JUNIT1',
     1485    11049    3           'JUNIT2',
     1486    11050    3           'JUNIT3',
     1487    11051    3           'JUNIT4',
     1488    11052    3           'CPU TIME USED'),
     1489    11053    3         2 DIV SBIN INIT(                  /* Amount by which to divide to       */
     1490    11054                                                /* get into correct units             */
     1491    11055    3           1, 1, 1, 1,6000,
     1492    11056    3           6000,6000,6000,6000,6000,
     1493    11057    3           6000,6000,6000,6000,6000,
     1494    11058    3           6000,6000,6000, 1, 1,
     1495    11059    3           1, 1, 1, 1, 1,
     1496    11060    3           1, 1, 1, 1, 1,
     1497    11061    3           1, 1,6000),
     1498    11062    3         2 FLT BIT(1) UNAL INIT(           /* Floating point indicator.          */
     1499    11063                                                /*   '0'B - Binary                    */
     1500    11064                                                /*   '1'B - Floating point            */
     1501    11065    3           '0'B*5,
     1502    11066    3           '0'B*5,
     1503    11067    3           '0'B,'1'B,'0'B*3,
     1504    11068    3           '0'B*5,
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:242  
     1505    11069    3           '0'B*5,
     1506    11070    3           '0'B*5,
     1507    11071    3           '0'B*3),
     1508    11072    3         2 DISPLAY UBIN BYTE UNAL INIT(    /* Display code.                      */
     1509    11073                                                /* 0= 0 places past dec pt            */
     1510    11074                                                /* 2= 2 places past dec pt            */
     1511    11075                                                /* 3= Special case for SUNITS         */
     1512    11076                                                /*    (actually displayed as if 0)    */
     1513    11077                                                /* 4= Special case for floating point */
     1514    11078                                                /* CNT values. (Actually displayed as */
     1515    11079                                                /* if 2)                              */
     1516    11080                                                /* 5= as a time (12:25:15.11)         */
     1517    11081    3           0,0,0,0,5,
     1518    11082    3           5,5,5,5,2,
     1519    11083    3           2,4,2,2,2,
     1520    11084    3           2,2,2,0,0,
     1521    11085    3           0,0,0,0,3,
     1522    11086    3           3,3,3,0,0,
     1523    11087    3           0,0,5),
     1524    11088    3         2 UNITS CHAR(8) INIT(             /* UNITS contains a string            */
     1525    11089                                                /* describing the units of this       */
     1526    11090                                                /* item                               */
     1527    11091    3           '/step   ','/pmme   ','/level  ','/tinter ','/min    ',
     1528    11092    3           '/min    ','/min    ','/min    ','/min    ','/pg-min ',
     1529    11093    3           '/pg-min ','/pg-min ','/res-min','/res-min','/res-min',
     1530    11094    3           '/res-min','/res-min','/res-min','/access ','/access ',
     1531    11095    3           '/access ','/mount  ','/mount  ','/mount  ','/unit   ',
     1532    11096    3           '/unit   ','/unit   ','/unit   ','/unit   ','/unit   ',
     1533    11097    3           '/unit   ','/unit   ','        ');
     1534    11098    3   DCL BL CHAR(4) CONSTANT INIT('    ');
     1535    11099    3   DCL TEMP1 UBIN;
     1536    11100    3   DCL DIGITS SBIN;
     1537    11101    3   DCL HRS SBIN;
     1538    11102    3   DCL FCNT SBIN;
     1539    11103    3   DCL FDIV SBIN;
     1540    11104    3   DCL 1 DECFLT,
     1541    11105    3         2 SIGN CHAR(1) UNAL,
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:243  
     1542    11106    3         2 DIGITS CHAR(10) UNAL,
     1543    11107    3         2 DIGIT_ARY(0:9) REDEF DIGITS CHAR(1) UNAL,
     1544    11108    3         2 * BIT(1) UNAL,
     1545    11109    3         2 EXP SBIN(8) UNAL;
     1546    11110        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:244  
     1547    11111    3      IF CNT>0

  11111  2 005513   205214 470500                    LDP0    @CNT,,AUTO
         2 005514   000000 235100                    LDA     0,,PR0
         2 005515   005553 605400 2                  TPNZ    s:11119
         2 005516   204004 471500                    LDP1    REC$,,AUTO
         2 005517   100036 236100                    LDQ     30,,PR1
         2 005520   000777 376003                    ANQ     511,DU
         2 005521   000002 116003                    CMPQ    2,DU
         2 005522   005531 600000 2                  TZE     s:11111+14
         2 005523   000001 116003                    CMPQ    1,DU
         2 005524   005531 600000 2                  TZE     s:11111+14
         2 005525   000003 116003                    CMPQ    3,DU
         2 005526   005531 600000 2                  TZE     s:11111+14
         2 005527   000006 116003                    CMPQ    6,DU
         2 005530   005544 601000 2                  TNZ     s:11111+25
         2 005531   205213 473500                    LDP3    @IDX,,AUTO
         2 005532   300000 235100                    LDA     0,,PR3
         2 005533   204011 235105                    LDA     SACCUM,AL,AUTO
         2 005534   005553 605400 2                  TPNZ    s:11119
         2 005535   300000 235100                    LDA     0,,PR3
         2 005536   000027 115007                    CMPA    23,DL
         2 005537   005544 604400 2                  TMOZ    s:11111+25
         2 005540   000034 115007                    CMPA    28,DL
         2 005541   005544 605000 2                  TPL     s:11111+25
         2 005542   204022 235105                    LDA     SACCUM+9,AL,AUTO
         2 005543   005553 605400 2                  TPNZ    s:11119
         2 005544   000004 116003                    CMPQ    4,DU
         2 005545   005552 601000 2                  TNZ     s:11118
         2 005546   205213 473500                    LDP3    @IDX,,AUTO
         2 005547   300000 235100                    LDA     0,,PR3
         2 005550   204056 235105                    LDA     PACCUM,AL,AUTO
         2 005551   005553 605400 2                  TPNZ    s:11119

     1548    11112    3        OR ((JSP.TYPE=%AZ$JOBEND OR JSP.TYPE=%AZ$RECOVERY OR
     1549    11113    3        JSP.TYPE=%AZ$STATUS OR JSP.TYPE=%AZ$BUDGET)
     1550    11114    3        AND (SACCUM.PCHG(IDX)>0 OR (IDX>23
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:245  
     1551    11115    3        AND IDX<28 AND SACCUM.SUNIT(IDX-24)>0)))
     1552    11116    3        OR (JSP.TYPE=%AZ$STEP AND PACCUM(IDX)>0)
     1553    11117    3      THEN ;                               /* Something to do ...                */
     1554    11118    3      ELSE RETURN;                         /* Nothing to do ...                  */

  11118  2 005552   000001 702211                    TSX2  ! 1,X1

     1555    11119    3      OUT_BUF = ' ';                       /* Blank out the buffer               */

  11119  2 005553   040100 100400                    MLR     fill='040'O
         2 005554   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005555   205170 000110                    ADSC9   OUT_BUF,,AUTO            cn=0,n=72

     1556    11120    3      IF JSP.TYPE=%AZ$PROC

  11120  2 005556   204004 471500                    LDP1    REC$,,AUTO
         2 005557   100036 236100                    LDQ     30,,PR1
         2 005560   000777 376003                    ANQ     511,DU
         2 005561   000005 116003                    CMPQ    5,DU
         2 005562   005664 601000 2                  TNZ     s:11133

     1557    11121    4      THEN DO;

     1558    11122    4           CHG2 = 0;

  11122  2 005563   204530 450100                    STZ     CHG2,,AUTO

     1559    11123    4           IF PRT.PERCENT# AND (IDX<24 OR IDX>27)

  11123  2 005564   204700 234100                    SZN     PRT,,AUTO
         2 005565   005623 605000 2                  TPL     s:11128
         2 005566   205213 473500                    LDP3    @IDX,,AUTO
         2 005567   300000 235100                    LDA     0,,PR3
         2 005570   000030 115007                    CMPA    24,DL
         2 005571   005574 604000 2                  TMI     s:11126
         2 005572   000033 115007                    CMPA    27,DL
         2 005573   005623 604400 2                  TMOZ    s:11128
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:246  

     1560    11124                                                /* Percent not allowed for step units */
     1561    11125                                                /* for a proprietary record           */
     1562    11126    4           THEN CALL AZB$MTH3D2B(CHG1,RT.CMULT#,RATE,PRATE,CNT,

  11126  2 005574   300000 236100                    LDQ     0,,PR3
         2 005575   000005 402007                    MPY     5,DL
         2 005576   205537 756100                    STQ     DCB$+9,,AUTO
         2 005577   000023 736000                    QLS     19
         2 005600   000134 036000 3                  ADLQ    92
         2 005601   205536 756100                    STQ     DCB$+8,,AUTO
         2 005602   205537 236100                    LDQ     DCB$+9,,AUTO
         2 005603   000023 736000                    QLS     19
         2 005604   000135 036000 3                  ADLQ    93
         2 005605   205214 235100                    LDA     @CNT,,AUTO
         2 005606   205534 757100                    STAQ    DCB$+6,,AUTO
         2 005607   205216 236100                    LDQ     @PRATE,,AUTO
         2 005610   205215 235100                    LDA     @RATE,,AUTO
         2 005611   205532 757100                    STAQ    DCB$+4,,AUTO
         2 005612   204615 634500                    EPPR4   RT+49,,AUTO
         2 005613   205531 454500                    STP4    DCB$+3,,AUTO
         2 005614   204527 635500                    EPPR5   CHG1,,AUTO
         2 005615   205530 455500                    STP5    DCB$+2,,AUTO
         2 005616   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 005617   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 005620   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 005621   000000 011000                    NOP     0
         2 005622   005652 710000 2                  TRA     s:11130

     1563    11127    4                  ITBL.DIV(IDX),ITBL.FLT(IDX));
     1564    11128    4           ELSE CALL AZB$MTH3D2B(CHG1,RT.CMULT#,PRATE,F1,CNT,

  11128  2 005623   205213 473500                    LDP3    @IDX,,AUTO
         2 005624   300000 236100                    LDQ     0,,PR3
         2 005625   000005 402007                    MPY     5,DL
         2 005626   205537 756100                    STQ     DCB$+9,,AUTO
         2 005627   000023 736000                    QLS     19
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:247  
         2 005630   000134 036000 3                  ADLQ    92
         2 005631   205536 756100                    STQ     DCB$+8,,AUTO
         2 005632   205537 236100                    LDQ     DCB$+9,,AUTO
         2 005633   000023 736000                    QLS     19
         2 005634   000135 036000 3                  ADLQ    93
         2 005635   205214 235100                    LDA     @CNT,,AUTO
         2 005636   205534 757100                    STAQ    DCB$+6,,AUTO
         2 005637   000111 236000 3                  LDQ     73
         2 005640   205216 235100                    LDA     @PRATE,,AUTO
         2 005641   205532 757100                    STAQ    DCB$+4,,AUTO
         2 005642   204615 634500                    EPPR4   RT+49,,AUTO
         2 005643   205531 454500                    STP4    DCB$+3,,AUTO
         2 005644   204527 635500                    EPPR5   CHG1,,AUTO
         2 005645   205530 455500                    STP5    DCB$+2,,AUTO
         2 005646   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 005647   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 005650   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 005651   000000 011000                    NOP     0

     1565    11129    4                  ITBL.DIV(IDX),ITBL.FLT(IDX));
     1566    11130    4           PACCUM(IDX) = PACCUM(IDX) + CHG1;

  11130  2 005652   205213 470500                    LDP0    @IDX,,AUTO
         2 005653   000000 235100                    LDA     0,,PR0
         2 005654   204056 236105                    LDQ     PACCUM,AL,AUTO
         2 005655   204527 036100                    ADLQ    CHG1,,AUTO
         2 005656   204056 756105                    STQ     PACCUM,AL,AUTO

     1567    11131    4           SACCUM.PCHG(IDX) = SACCUM.PCHG(IDX) + CHG1;

  11131  2 005657   000000 235100                    LDA     0,,PR0
         2 005660   204011 236105                    LDQ     SACCUM,AL,AUTO
         2 005661   204527 036100                    ADLQ    CHG1,,AUTO
         2 005662   204011 756105                    STQ     SACCUM,AL,AUTO

     1568    11132    4           END;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:248  
  11132  2 005663   005777 710000 2                  TRA     s:11150

     1569    11133    3      ELSE IF JSP.TYPE=%AZ$STEP

  11133  2 005664   000004 116003                    CMPQ    4,DU
         2 005665   005732 601000 2                  TNZ     s:11141

     1570    11134    4           THEN DO;

     1571    11135    4                CHG1 = PACCUM(IDX);

  11135  2 005666   205213 473500                    LDP3    @IDX,,AUTO
         2 005667   300000 235100                    LDA     0,,PR3
         2 005670   204056 235105                    LDA     PACCUM,AL,AUTO
         2 005671   204527 755100                    STA     CHG1,,AUTO

     1572    11136    4               CALL AZB$MTH3D2B(CHG2,RT.CMULT#,RATE,F1,CNT,ITBL.DIV(IDX),ITBL.FLT(IDX)
             11136                         );

  11136  2 005672   300000 236100                    LDQ     0,,PR3
         2 005673   000005 402007                    MPY     5,DL
         2 005674   205537 756100                    STQ     DCB$+9,,AUTO
         2 005675   000023 736000                    QLS     19
         2 005676   000134 036000 3                  ADLQ    92
         2 005677   205536 756100                    STQ     DCB$+8,,AUTO
         2 005700   205537 236100                    LDQ     DCB$+9,,AUTO
         2 005701   000023 736000                    QLS     19
         2 005702   000135 036000 3                  ADLQ    93
         2 005703   205214 235100                    LDA     @CNT,,AUTO
         2 005704   205534 757100                    STAQ    DCB$+6,,AUTO
         2 005705   000111 236000 3                  LDQ     73
         2 005706   205215 235100                    LDA     @RATE,,AUTO
         2 005707   205532 757100                    STAQ    DCB$+4,,AUTO
         2 005710   204615 634500                    EPPR4   RT+49,,AUTO
         2 005711   205531 454500                    STP4    DCB$+3,,AUTO
         2 005712   204530 635500                    EPPR5   CHG2,,AUTO
         2 005713   205530 455500                    STP5    DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:249  
         2 005714   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 005715   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 005716   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 005717   000000 011000                    NOP     0

     1573    11137    4                IF IDX>23 AND IDX<28

  11137  2 005720   205213 470500                    LDP0    @IDX,,AUTO
         2 005721   000000 235100                    LDA     0,,PR0
         2 005722   000027 115007                    CMPA    23,DL
         2 005723   005777 604400 2                  TMOZ    s:11150
         2 005724   000034 115007                    CMPA    28,DL
         2 005725   005777 605000 2                  TPL     s:11150

     1574    11138    4                THEN SACCUM.SUNIT(IDX-24) = SACCUM.SUNIT(IDX-24) + CHG2;

  11138  2 005726   204022 236105                    LDQ     SACCUM+9,AL,AUTO
         2 005727   204530 036100                    ADLQ    CHG2,,AUTO
         2 005730   204022 756105                    STQ     SACCUM+9,AL,AUTO

     1575    11139    4                END;

  11139  2 005731   005777 710000 2                  TRA     s:11150

     1576    11140    4           ELSE DO;                   /* %AZ$STATUS, %AZ$JOBEND or %AZ$RECOVERY  */

     1577    11141    4                CHG1 = SACCUM.PCHG(IDX);

  11141  2 005732   205213 473500                    LDP3    @IDX,,AUTO
         2 005733   300000 235100                    LDA     0,,PR3
         2 005734   204011 235105                    LDA     SACCUM,AL,AUTO
         2 005735   204527 755100                    STA     CHG1,,AUTO

     1578    11142    4                IF IDX<24 OR IDX>27

  11142  2 005736   300000 235100                    LDA     0,,PR3
         2 005737   000030 115007                    CMPA    24,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:250  
         2 005740   005743 604000 2                  TMI     s:11143
         2 005741   000033 115007                    CMPA    27,DL
         2 005742   005772 604400 2                  TMOZ    s:11146

     1579    11143    4                THEN CALL AZB$MTH3D2B(CHG2,RT.CMULT#,RATE,F1,CNT,

  11143  2 005743   300000 236100                    LDQ     0,,PR3
         2 005744   000005 402007                    MPY     5,DL
         2 005745   205537 756100                    STQ     DCB$+9,,AUTO
         2 005746   000023 736000                    QLS     19
         2 005747   000134 036000 3                  ADLQ    92
         2 005750   205536 756100                    STQ     DCB$+8,,AUTO
         2 005751   205537 236100                    LDQ     DCB$+9,,AUTO
         2 005752   000023 736000                    QLS     19
         2 005753   000135 036000 3                  ADLQ    93
         2 005754   205214 235100                    LDA     @CNT,,AUTO
         2 005755   205534 757100                    STAQ    DCB$+6,,AUTO
         2 005756   000111 236000 3                  LDQ     73
         2 005757   205215 235100                    LDA     @RATE,,AUTO
         2 005760   205532 757100                    STAQ    DCB$+4,,AUTO
         2 005761   204615 634500                    EPPR4   RT+49,,AUTO
         2 005762   205531 454500                    STP4    DCB$+3,,AUTO
         2 005763   204530 635500                    EPPR5   CHG2,,AUTO
         2 005764   205530 455500                    STP5    DCB$+2,,AUTO
         2 005765   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 005766   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 005767   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 005770   000000 011000                    NOP     0
         2 005771   005777 710000 2                  TRA     s:11150

     1580    11144    4                       ITBL.DIV(IDX),ITBL.FLT(IDX));
     1581    11145    5                ELSE DO;

     1582    11146    5                     CHG2 = SACCUM.SUNIT(IDX-24);

  11146  2 005772   204022 235105                    LDA     SACCUM+9,AL,AUTO
         2 005773   204530 755100                    STA     CHG2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:251  

     1583    11147    5                     JSP.SUNIT_CHG(IDX-24) = CHG2;

  11147  2 005774   300000 235100                    LDA     0,,PR3
         2 005775   204530 236100                    LDQ     CHG2,,AUTO
         2 005776   100067 756105                    STQ     55,AL,PR1

     1584    11148    5                     END;

     1585    11149    4                END;

     1586    11150    3      JSP.PCHG = JSP.PCHG + CHG1;

  11150  2 005777   204004 470500                    LDP0    REC$,,AUTO
         2 006000   000066 236100                    LDQ     54,,PR0
         2 006001   204527 036100                    ADLQ    CHG1,,AUTO
         2 006002   000066 756100                    STQ     54,,PR0

     1587    11151    3      JSP.CHG = JSP.CHG + CHG2;

  11151  2 006003   000065 236100                    LDQ     53,,PR0
         2 006004   204530 036100                    ADLQ    CHG2,,AUTO
         2 006005   000065 756100                    STQ     53,,PR0

     1588    11152    3      IF STATSLEV=%AZ_ALL#

  11152  2 006006   204503 235100                    LDA     STATSLEV,,AUTO
         2 006007   000001 115007                    CMPA    1,DL
         2 006010   006621 601000 2                  TNZ     s:11252

     1589    11153    4      THEN DO;                             /* Write record since desired         */

     1590    11154    4           OB.SCLR.NAME = ITBL.NAME(IDX);

  11154  2 006011   205213 471500                    LDP1    @IDX,,AUTO
         2 006012   100000 236100                    LDQ     0,,PR1
         2 006013   000005 402007                    MPY     5,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:252  
         2 006014   000003 736000                    QLS     3
         2 006015   040100 100406                    MLR     fill='040'O
         2 006016   001231 000025 1                  ADSC9   ITBL,Q                   cn=0,n=21
         2 006017   205170 000031                    ADSC9   OUT_BUF,,AUTO            cn=0,n=25

     1591    11155    4           IF JSNAME~=' '

  11155  2 006020   205217 473500                    LDP3    @JSNAME,,AUTO
         2 006021   040000 106500                    CMPC    fill='040'O
         2 006022   300000 000020                    ADSC9   0,,PR3                   cn=0,n=16
         2 006023   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006024   006034 600000 2                  TZE     s:11161

     1592    11156    5           THEN DO;

     1593    11157    5                OB.SCLR.JSUNIT.Q1 = '''';

  11157  2 006025   000047 236007                    LDQ     39,DL
         2 006026   205171 552104                    STBQ    OUT_BUF+1,'04'O,AUTO

     1594    11158    5                OB.SCLR.JSUNIT.JSNAME = JSNAME;

  11158  2 006027   040100 100500                    MLR     fill='040'O
         2 006030   300000 000020                    ADSC9   0,,PR3                   cn=0,n=16
         2 006031   205172 000020                    ADSC9   OUT_BUF+2,,AUTO          cn=0,n=16

     1595    11159    5                OB.SCLR.JSUNIT.Q2 = '''';

  11159  2 006032   047000 236003                    LDQ     19968,DU
         2 006033   205176 552140                    STBQ    OUT_BUF+6,'40'O,AUTO

     1596    11160    5                END;

     1597    11161    5           DO CASE(ITBL.DISPLAY(IDX));

  11161  2 006034   100000 236100                    LDQ     0,,PR1
         2 006035   000005 402007                    MPY     5,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:253  
         2 006036   000001 736000                    QLS     1
         2 006037   001240 236006 1                  LDQ     ITBL+7,QL
         2 006040   000032 772000                    QRL     26
         2 006041   000777 376007                    ANQ     511,DL
         2 006042   000006 116007                    CMPQ    6,DL
         2 006043   006045 602006 2                  TNC     s:11161+9,QL
         2 006044   006366 710000 2                  TRA     s:11203
         2 006045   006053 710000 2                  TRA     s:11163
         2 006046   006366 710000 2                  TRA     s:11203
         2 006047   006073 710000 2                  TRA     s:11166
         2 006050   006114 710000 2                  TRA     s:11169
         2 006051   006142 710000 2                  TRA     s:11175
         2 006052   006336 710000 2                  TRA     s:11197

     1598    11162    5            CASE(0);

     1599    11163    5              CALL BINCHAR(CHR8,CNT/ITBL.DIV(IDX));

  11163  2 006053   100000 236100                    LDQ     0,,PR1
         2 006054   000005 402007                    MPY     5,DL
         2 006055   000001 736000                    QLS     1
         2 006056   000000 620006                    EAX0    0,QL
         2 006057   205214 474500                    LDP4    @CNT,,AUTO
         2 006060   400000 236100                    LDQ     0,,PR4
         2 006061   001237 506010 1                  DIV     ITBL+6,X0
         2 006062   205530 756100                    STQ     DCB$+2,,AUTO
         2 006063   000100 301500                    BTD
         2 006064   205530 000004                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 006065   204514 030010                    NDSC9   CHR8,,AUTO               cn=0,s=nosgn,sf=0,n=8

     1600    11164    5              CALL EDITCHAR(OB.SCLR.SCLR,,,MOP_8_0_STR,CHR8);

  11164  2 006066   100000 024500                    MVNE
         2 006067   204514 030010                    NDSC9   CHR8,,AUTO               cn=0,s=nosgn,sf=0,n=8
         2 006070   000560 000002 1                  ADSC9   MOP_8_0_STR              cn=0,n=2
         2 006071   205176 200010                    ADSC9   OUT_BUF+6,,AUTO          cn=1,n=8
         2 006072   006366 710000 2                  TRA     s:11203
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:254  

     1601    11165    5            CASE(2);

     1602    11166    5              CALL BINCHAR(CHR9,CNT*100/ITBL.DIV(IDX));

  11166  2 006073   100000 236100                    LDQ     0,,PR1
         2 006074   000005 402007                    MPY     5,DL
         2 006075   000001 736000                    QLS     1
         2 006076   000000 620006                    EAX0    0,QL
         2 006077   205214 474500                    LDP4    @CNT,,AUTO
         2 006100   400000 236100                    LDQ     0,,PR4
         2 006101   000144 402007                    MPY     100,DL
         2 006102   001237 506010 1                  DIV     ITBL+6,X0
         2 006103   205530 756100                    STQ     DCB$+2,,AUTO
         2 006104   000100 301500                    BTD
         2 006105   205530 000004                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 006106   204516 030011                    NDSC9   CHR9,,AUTO               cn=0,s=nosgn,sf=0,n=9

     1603    11167    5              CALL EDITCHAR(OB.DEC2.DEC2,,,MOP_7_2_STR,CHR9);

  11167  2 006107   100000 024500                    MVNE
         2 006110   204516 030011                    NDSC9   CHR9,,AUTO               cn=0,s=nosgn,sf=0,n=9
         2 006111   000551 000004 1                  ADSC9   MOP_7_2_STR              cn=0,n=4
         2 006112   205175 600012                    ADSC9   OUT_BUF+5,,AUTO          cn=3,n=10
         2 006113   006366 710000 2                  TRA     s:11203

     1604    11168    5            CASE(3/* SUNIT special case */);

     1605    11169    5              IF JSP.TYPE=%AZ$STEP OR JSP.TYPE=%AZ$PROC

  11169  2 006114   000036 236100                    LDQ     30,,PR0
         2 006115   000777 376003                    ANQ     511,DU
         2 006116   000004 116003                    CMPQ    4,DU
         2 006117   006122 600000 2                  TZE     s:11171
         2 006120   000005 116003                    CMPQ    5,DU
         2 006121   006366 601000 2                  TNZ     s:11203

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:255  
     1606    11170    6              THEN DO;

     1607    11171    6                   CALL BINCHAR(CHR8,CNT/ITBL.DIV(IDX));

  11171  2 006122   100000 236100                    LDQ     0,,PR1
         2 006123   000005 402007                    MPY     5,DL
         2 006124   000001 736000                    QLS     1
         2 006125   000000 620006                    EAX0    0,QL
         2 006126   205214 474500                    LDP4    @CNT,,AUTO
         2 006127   400000 236100                    LDQ     0,,PR4
         2 006130   001237 506010 1                  DIV     ITBL+6,X0
         2 006131   205530 756100                    STQ     DCB$+2,,AUTO
         2 006132   000100 301500                    BTD
         2 006133   205530 000004                    NDSC9   DCB$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 006134   204514 030010                    NDSC9   CHR8,,AUTO               cn=0,s=nosgn,sf=0,n=8

     1608    11172    6                   CALL EDITCHAR(OB.SCLR.SCLR,,,MOP_8_0_STR,CHR8);

  11172  2 006135   100000 024500                    MVNE
         2 006136   204514 030010                    NDSC9   CHR8,,AUTO               cn=0,s=nosgn,sf=0,n=8
         2 006137   000560 000002 1                  ADSC9   MOP_8_0_STR              cn=0,n=2
         2 006140   205176 200010                    ADSC9   OUT_BUF+6,,AUTO          cn=1,n=8

     1609    11173    6                   END;

  11173  2 006141   006366 710000 2                  TRA     s:11203

     1610    11174    5            CASE(4/* FLOATING POINT special case */);

     1611    11175    5              FCNT = CNT;

  11175  2 006142   205214 474500                    LDP4    @CNT,,AUTO
         2 006143   400000 235100                    LDA     0,,PR4
         2 006144   205224 755100                    STA     FCNT,,AUTO

     1612    11176    5              CALL AZB$FLOAT(100,TEMP1);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:256  
  11176  2 006145   205221 635500                    EPPR5   TEMP1,,AUTO
         2 006146   205531 455500                    STP5    DCB$+3,,AUTO
         2 006147   000137 236000 3                  LDQ     95
         2 006150   205530 756100                    STQ     DCB$+2,,AUTO
         2 006151   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006152   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 006153   000000 701000 xent               TSX1    AZB$FLOAT
         2 006154   000000 011000                    NOP     0

     1613    11177    5              CALL AZB$FMP(FCNT,TEMP1);

  11177  2 006155   205221 630500                    EPPR0   TEMP1,,AUTO
         2 006156   205531 450500                    STP0    DCB$+3,,AUTO
         2 006157   205224 631500                    EPPR1   FCNT,,AUTO
         2 006160   205530 451500                    STP1    DCB$+2,,AUTO
         2 006161   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006162   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 006163   000000 701000 xent               TSX1    AZB$FMP
         2 006164   000000 011000                    NOP     0

     1614    11178    5              CALL AZB$FLOAT(ITBL.DIV(IDX),FDIV);

  11178  2 006165   205213 470500                    LDP0    @IDX,,AUTO
         2 006166   000000 236100                    LDQ     0,,PR0
         2 006167   000005 402007                    MPY     5,DL
         2 006170   205225 631500                    EPPR1   FDIV,,AUTO
         2 006171   205531 451500                    STP1    DCB$+3,,AUTO
         2 006172   000023 736000                    QLS     19
         2 006173   000135 036000 3                  ADLQ    93
         2 006174   205530 756100                    STQ     DCB$+2,,AUTO
         2 006175   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006176   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 006177   000000 701000 xent               TSX1    AZB$FLOAT
         2 006200   000000 011000                    NOP     0

     1615    11179    5              CALL AZB$FDV(FCNT,FDIV);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:257  
  11179  2 006201   205225 630500                    EPPR0   FDIV,,AUTO
         2 006202   205531 450500                    STP0    DCB$+3,,AUTO
         2 006203   205224 631500                    EPPR1   FCNT,,AUTO
         2 006204   205530 451500                    STP1    DCB$+2,,AUTO
         2 006205   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006206   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 006207   000000 701000 xent               TSX1    AZB$FDV
         2 006210   000000 011000                    NOP     0

     1616    11180    5              CALL AZA$FLTTODEC(FCNT,DECFLT);

  11180  2 006211   205226 630500                    EPPR0   DECFLT,,AUTO
         2 006212   205531 450500                    STP0    DCB$+3,,AUTO
         2 006213   205224 631500                    EPPR1   FCNT,,AUTO
         2 006214   205530 451500                    STP1    DCB$+2,,AUTO
         2 006215   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006216   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 006217   000000 701000 xent               TSX1    AZA$FLTTODEC
         2 006220   000000 011000                    NOP     0

     1617    11181    5              TEMP1 = 0;

  11181  2 006221   205221 450100                    STZ     TEMP1,,AUTO

     1618    11182    6              DO WHILE(DECFLT.DIGIT_ARY(TEMP1)='0');

  11182  2 006222   205221 235100                    LDA     TEMP1,,AUTO
         2 006223   040000 106505                    CMPC    fill='040'O
         2 006224   205226 200001                    ADSC9   DECFLT,A,AUTO            cn=1,n=1
         2 006225   000120 000001 3                  ADSC9   80                       cn=0,n=1
         2 006226   006236 601000 2                  TNZ     s:11185

     1619    11183    6                   TEMP1 = TEMP1+1;

  11183  2 006227   205221 235100                    LDA     TEMP1,,AUTO
         2 006230   000001 035007                    ADLA    1,DL
         2 006231   205221 755100                    STA     TEMP1,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:258  

     1620    11184    6                   END;

  11184  2 006232   040000 106505                    CMPC    fill='040'O
         2 006233   205226 200001                    ADSC9   DECFLT,A,AUTO            cn=1,n=1
         2 006234   000120 000001 3                  ADSC9   80                       cn=0,n=1
         2 006235   006227 600000 2                  TZE     s:11183

     1621    11185    5              DIGITS = 10+DECFLT.EXP-TEMP1;

  11185  2 006236   205230 236100                    LDQ     DECFLT+2,,AUTO
         2 006237   000034 736000                    QLS     28
         2 006240   000034 732000                    QRS     28
         2 006241   205221 136100                    SBLQ    TEMP1,,AUTO
         2 006242   000012 036007                    ADLQ    10,DL
         2 006243   205222 756100                    STQ     DIGITS,,AUTO

     1622    11186    5              IF DIGITS > 12

  11186  2 006244   000014 116007                    CMPQ    12,DL
         2 006245   006252 604400 2                  TMOZ    s:11189

     1623    11187    5              THEN OB.DEC2.DEC2 = '**********'; /* Value too large to disp       */

  11187  2 006246   040100 100400                    MLR     fill='040'O
         2 006247   002051 000012 1                  ADSC9   XSJ_PARAMC+69            cn=0,n=10
         2 006250   205175 600012                    ADSC9   OUT_BUF+5,,AUTO          cn=3,n=10
         2 006251   006366 710000 2                  TRA     s:11203

     1624    11188    6              ELSE DO;

     1625    11189    6                   IF DIGITS > 9

  11189  2 006252   000011 116007                    CMPQ    9,DL
         2 006253   006274 604400 2                  TMOZ    s:11192

     1626    11190    6                  THEN CALL CONCAT (OB.DEC2.DEC2,SUBSTR(BL,0,12-DIGITS),SUBSTR(DECFLT.
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:259  
             11190                            DIGITS,TEMP1));

  11190  2 006254   777763 620006                    EAX0    -13,QL
         2 006255   777777 660003                    ERX0    -1,DU
         2 006256   040100 100440                    MLR     fill='040'O
         2 006257   001743 000010 1                  ADSC9   BL                       cn=0,n=*X0
         2 006260   205175 600012                    ADSC9   OUT_BUF+5,,AUTO          cn=3,n=10
         2 006261   000002 116007                    CMPQ    2,DL
         2 006262   006273 604400 2                  TMOZ    s:11190+15
         2 006263   777765 621005                    EAX1    -11,AL
         2 006264   777777 661003                    ERX1    -1,DU
         2 006265   777776 622006                    EAX2    -2,QL
         2 006266   205222 335100                    LCA     DIGITS,,AUTO
         2 006267   205221 236100                    LDQ     TEMP1,,AUTO
         2 006270   040145 100546                    MLR     fill='040'O
         2 006271   205226 200011                    ADSC9   DECFLT,Q,AUTO            cn=1,n=*X1
         2 006272   205200 600012                    ADSC9   OUT_BUF+8,A,AUTO         cn=3,n=*X2
         2 006273   006366 710000 2                  TRA     s:11203

     1627    11191    7                   ELSE DO;

     1628    11192    7                       CALL CONCAT (CHR9,SUBSTR(ZERO,0,9-DIGITS),SUBSTR(DECFLT.DIGITS,
             11192                                 TEMP1),ZERO);

  11192  2 006274   777766 620006                    EAX0    -10,QL
         2 006275   777777 660003                    ERX0    -1,DU
         2 006276   040100 100440                    MLR     fill='040'O
         2 006277   000561 000010 1                  ADSC9   ZERO                     cn=0,n=*X0
         2 006300   204516 000011                    ADSC9   CHR9,,AUTO               cn=0,n=9
         2 006301   000000 116003                    CMPQ    0,DU
         2 006302   006331 604400 2                  TMOZ    s:11193
         2 006303   777765 621005                    EAX1    -11,AL
         2 006304   777777 661003                    ERX1    -1,DU
         2 006305   205222 335100                    LCA     DIGITS,,AUTO
         2 006306   205221 236100                    LDQ     TEMP1,,AUTO
         2 006307   205222 722100                    LXL2    DIGITS,,AUTO
         2 006310   040145 100546                    MLR     fill='040'O
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:260  
         2 006311   205226 200011                    ADSC9   DECFLT,Q,AUTO            cn=1,n=*X1
         2 006312   204520 200012                    ADSC9   I+1,A,AUTO               cn=1,n=*X2
         2 006313   205222 236100                    LDQ     DIGITS,,AUTO
         2 006314   205221 036100                    ADLQ    TEMP1,,AUTO
         2 006315   000012 116007                    CMPQ    10,DL
         2 006316   006331 604400 2                  TMOZ    s:11193
         2 006317   205530 756100                    STQ     DCB$+2,,AUTO
         2 006320   205222 236100                    LDQ     DIGITS,,AUTO
         2 006321   205221 036100                    ADLQ    TEMP1,,AUTO
         2 006322   205530 723100                    LXL3    DCB$+2,,AUTO
         2 006323   777766 624013                    EAX4    -10,X3
         2 006324   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 006325   000001 036007                    ADLQ    1,DL
         2 006326   040146 100400                    MLR     fill='040'O
         2 006327   000561 000012 1                  ADSC9   ZERO                     cn=0,n=10
         2 006330   204522 600014                    ADSC9   @MULT+1,Q,AUTO           cn=3,n=*X4

     1629    11193    7                        CALL EDITCHAR(OB.DEC2.DEC2,,,MOP_7_2_STR,CHR9);

  11193  2 006331   100000 024500                    MVNE
         2 006332   204516 030011                    NDSC9   CHR9,,AUTO               cn=0,s=nosgn,sf=0,n=9
         2 006333   000551 000004 1                  ADSC9   MOP_7_2_STR              cn=0,n=4
         2 006334   205175 600012                    ADSC9   OUT_BUF+5,,AUTO          cn=3,n=10

     1630    11194    7                        END;

     1631    11195    6                   END;

  11195  2 006335   006366 710000 2                  TRA     s:11203

     1632    11196    5            CASE(5/* Time display */);

     1633    11197    5              FPT_TIME.TSTAMP_ = VECTOR(CNT);

  11197  2 006336   777640 235007                    LDA     -96,DL
         2 006337   205214 236100                    LDQ     @CNT,,AUTO
         2 006340   204222 757100                    STAQ    FPT_TIME+8,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:261  

     1634    11198    5              CALL M$TIME(FPT_TIME) ALTRET(WRITE_ALT);

  11198  2 006341   204212 630500                    EPPR0   FPT_TIME,,AUTO
         2 006342   420004 713400                    CLIMB   alt,+8196
         2 006343   402000 401760                    pmme    nvectors=5
         2 006344   006610 702000 2                  TSX2    WRITE_ALT

     1635    11199    5              HRS = CNT/360000;

  11199  2 006345   205214 470500                    LDP0    @CNT,,AUTO
         2 006346   000000 236100                    LDQ     0,,PR0
         2 006347   000115 506000 3                  DIV     77
         2 006350   205223 756100                    STQ     HRS,,AUTO

     1636    11200    5              CALL BINCHAR(OB.TIM1.HRS,HRS);

  11200  2 006351   000100 301500                    BTD
         2 006352   205223 000004                    NDSC9   HRS,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 006353   205175 230003                    NDSC9   OUT_BUF+5,,AUTO          cn=1,s=nosgn,sf=0,n=3

     1637    11201    5              CALL STRIP_TIME(ADDR(OB.TIM1.HRS),5);

  11201  2 006354   205530 452500                    STP2    DCB$+2,,AUTO
         2 006355   205530 236100                    LDQ     DCB$+2,,AUTO
         2 006356   000131 036000 3                  ADLQ    89
         2 006357   205546 756100                    STQ     DCB$+16,,AUTO
         2 006360   000040 236000 3                  LDQ     32
         2 006361   205234 756100                    STQ     @TIME$+1,,AUTO
         2 006362   205546 631500                    EPPR1   DCB$+16,,AUTO
         2 006363   205233 451500                    STP1    DECFLT+5,,AUTO
         2 006364   006623 701000 2                  TSX1    STRIP_TIME
         2 006365   000000 011000                    NOP     0

     1638    11202    5              END;                         /* End case                           */

     1639    11203    4           IF NOT B$JIT.BLINDACCTNG
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:262  

  11203  2 006366   204007 470500                    LDP0    JIT$,,AUTO
         2 006367   000153 236100                    LDQ     107,,PR0
         2 006370   400000 316007                    CANQ    -131072,DL
         2 006371   006577 601000 2                  TNZ     s:11245

     1640    11204    5           THEN DO;                        /* Tell the user about charge details */

     1641    11205        /***********************************
     1642    11206         ****       Report chg-per-unit for all cases but SUNITs at JOBEND and Tot. CPU
     1643    11207         ***********************************/
     1644    11208    5                IF (IDX<24 OR IDX>27 OR JSP.TYPE=%AZ$STEP OR JSP.TYPE=%AZ$PROC)

  11208  2 006372   205213 471500                    LDP1    @IDX,,AUTO
         2 006373   100000 235100                    LDA     0,,PR1
         2 006374   000030 115007                    CMPA    24,DL
         2 006375   006407 604000 2                  TMI     s:11208+13
         2 006376   000033 115007                    CMPA    27,DL
         2 006377   006407 605400 2                  TPNZ    s:11208+13
         2 006400   204004 473500                    LDP3    REC$,,AUTO
         2 006401   300036 236100                    LDQ     30,,PR3
         2 006402   000777 376003                    ANQ     511,DU
         2 006403   000004 116003                    CMPQ    4,DU
         2 006404   006407 600000 2                  TZE     s:11208+13
         2 006405   000005 116003                    CMPQ    5,DU
         2 006406   006541 601000 2                  TNZ     s:11230
         2 006407   000040 115007                    CMPA    32,DL
         2 006410   006541 600000 2                  TZE     s:11230

     1645    11209    5                  AND IDX~=32
     1646    11210    6                THEN DO;

     1647    11211    6                     IF JSP.TYPE=%AZ$PROC

  11211  2 006411   204004 473500                    LDP3    REC$,,AUTO
         2 006412   300036 236100                    LDQ     30,,PR3
         2 006413   000777 376003                    ANQ     511,DU
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:263  
         2 006414   000005 116003                    CMPQ    5,DU
         2 006415   006460 601000 2                  TNZ     s:11215

     1648    11212    6                     THEN IF PRT.PERCENT#

  11212  2 006416   204700 234100                    SZN     PRT,,AUTO
         2 006417   006440 605000 2                  TPL     s:11214

     1649    11213    6                          THEN CALL AZB$MTH3D2B(T1,RT.CMULT#,RATE,PRATE,1,1,'0'B);

  11213  2 006420   000000 236000 3                  LDQ     0
         2 006421   205536 756100                    STQ     DCB$+8,,AUTO
         2 006422   000112 237000 3                  LDAQ    74
         2 006423   205534 757100                    STAQ    DCB$+6,,AUTO
         2 006424   205216 236100                    LDQ     @PRATE,,AUTO
         2 006425   205215 235100                    LDA     @RATE,,AUTO
         2 006426   205532 757100                    STAQ    DCB$+4,,AUTO
         2 006427   204615 634500                    EPPR4   RT+49,,AUTO
         2 006430   205531 454500                    STP4    DCB$+3,,AUTO
         2 006431   204531 635500                    EPPR5   T1,,AUTO
         2 006432   205530 455500                    STP5    DCB$+2,,AUTO
         2 006433   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006434   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 006435   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 006436   000000 011000                    NOP     0
         2 006437   006477 710000 2                  TRA     s:11216

     1650    11214    6                          ELSE CALL AZB$MTH3D2B(T1,RT.CMULT#,PRATE,F1,1,1,'0'B);

  11214  2 006440   000000 236000 3                  LDQ     0
         2 006441   205536 756100                    STQ     DCB$+8,,AUTO
         2 006442   000112 237000 3                  LDAQ    74
         2 006443   205534 757100                    STAQ    DCB$+6,,AUTO
         2 006444   000111 236000 3                  LDQ     73
         2 006445   205216 235100                    LDA     @PRATE,,AUTO
         2 006446   205532 757100                    STAQ    DCB$+4,,AUTO
         2 006447   204615 634500                    EPPR4   RT+49,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:264  
         2 006450   205531 454500                    STP4    DCB$+3,,AUTO
         2 006451   204531 635500                    EPPR5   T1,,AUTO
         2 006452   205530 455500                    STP5    DCB$+2,,AUTO
         2 006453   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006454   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 006455   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 006456   000000 011000                    NOP     0
         2 006457   006477 710000 2                  TRA     s:11216

     1651    11215    6                     ELSE CALL AZB$MTH3D2B(T1,RT.CMULT#,RATE,F1,1,1,'0'B);

  11215  2 006460   000000 236000 3                  LDQ     0
         2 006461   205536 756100                    STQ     DCB$+8,,AUTO
         2 006462   000112 237000 3                  LDAQ    74
         2 006463   205534 757100                    STAQ    DCB$+6,,AUTO
         2 006464   000111 236000 3                  LDQ     73
         2 006465   205215 235100                    LDA     @RATE,,AUTO
         2 006466   205532 757100                    STAQ    DCB$+4,,AUTO
         2 006467   204615 634500                    EPPR4   RT+49,,AUTO
         2 006470   205531 454500                    STP4    DCB$+3,,AUTO
         2 006471   204531 635500                    EPPR5   T1,,AUTO
         2 006472   205530 455500                    STP5    DCB$+2,,AUTO
         2 006473   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006474   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 006475   000000 701000 xent               TSX1    AZB$MTH3D2B
         2 006476   000000 011000                    NOP     0

     1652    11216    6                     OB.BL_AT = ' @';

  11216  2 006477   002054 236000 1                  LDQ     XSJ_PARAMC+72
         2 006500   000011 772000                    QRL     9
         2 006501   205200 552130                    STBQ    OUT_BUF+8,'30'O,AUTO

     1653    11217    6                     CALL BINCHAR(CHR10,T1);

  11217  2 006502   000100 301500                    BTD
         2 006503   204531 000004                    NDSC9   T1,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:265  
         2 006504   204521 030012                    NDSC9   CHR10,,AUTO              cn=0,s=nosgn,sf=0,n=10

     1654    11218                                           /* #23005...change handling of
     1655    11219                                                unit price  (JLJ)       */
     1656    11220    6                     CALL EDITCHAR (CHR11,,,MOP_6_4_STR,CHR10);

  11220  2 006505   100000 024500                    MVNE
         2 006506   204521 030012                    NDSC9   CHR10,,AUTO              cn=0,s=nosgn,sf=0,n=10
         2 006507   000556 000004 1                  ADSC9   MOP_6_4_STR              cn=0,n=4
         2 006510   204524 000013                    ADSC9   CHR11,,AUTO              cn=0,n=11

     1657    11221    6                     OB.PER_UNIT = SUBSTR(CHR11,1,8);

  11221  2 006511   040100 100500                    MLR     fill='040'O
         2 006512   204524 200010                    ADSC9   CHR11,,AUTO              cn=1,n=8
         2 006513   205200 600010                    ADSC9   OUT_BUF+8,,AUTO          cn=3,n=8

     1658    11222    6                     IF SUBSTR(CHR11,0,1) ~= ' '

  11222  2 006514   204524 236100                    LDQ     CHR11,,AUTO
         2 006515   777000 376003                    ANQ     -512,DU
         2 006516   040000 116003                    CMPQ    16384,DU
         2 006517   006523 600000 2                  TZE     s:11225

     1659    11223    6                     THEN
     1660    11224    6                          OB.PER_UNIT = SUBSTR(CHR11,0,8);

  11224  2 006520   040100 100500                    MLR     fill='040'O
         2 006521   204524 000010                    ADSC9   CHR11,,AUTO              cn=0,n=8
         2 006522   205200 600010                    ADSC9   OUT_BUF+8,,AUTO          cn=3,n=8

     1661    11225    6                     IF SUBSTR(CHR11,0,3) = '   '

  11225  2 006523   204524 236100                    LDQ     CHR11,,AUTO
         2 006524   002055 676000 1                  ERQ     XSJ_PARAMC+73
         2 006525   000140 376000 3                  ANQ     96
         2 006526   006532 601000 2                  TNZ     s:11228
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:266  

     1662    11226    6                     THEN
     1663    11227    6                          OB.PER_UNIT = SUBSTR(CHR11,3,8);

  11227  2 006527   040100 100500                    MLR     fill='040'O
         2 006530   204524 600010                    ADSC9   CHR11,,AUTO              cn=3,n=8
         2 006531   205200 600010                    ADSC9   OUT_BUF+8,,AUTO          cn=3,n=8

     1664    11228    6                     OB.UNITS = ITBL.UNITS(IDX);

  11228  2 006532   205213 470500                    LDP0    @IDX,,AUTO
         2 006533   000000 236100                    LDQ     0,,PR0
         2 006534   000005 402007                    MPY     5,DL
         2 006535   000003 736000                    QLS     3
         2 006536   040100 100406                    MLR     fill='040'O
         2 006537   001240 400010 1                  ADSC9   ITBL+7,Q                 cn=2,n=8
         2 006540   205202 600012                    ADSC9   OUT_BUF+10,,AUTO         cn=3,n=10

     1665    11229    6                     END;

     1666    11230    5                CHG_VAL = (CHG1+50)/100;

  11230  2 006541   204527 236100                    LDQ     CHG1,,AUTO
         2 006542   000062 036007                    ADLQ    50,DL
         2 006543   000144 506007                    DIV     100,DL
         2 006544   205220 756100                    STQ     CHG_VAL,,AUTO

     1667    11231    5                IF CHG_VAL~=0

  11231  2 006545   000000 116003                    CMPQ    0,DU
         2 006546   006562 600000 2                  TZE     s:11238

     1668    11232    6                THEN DO;                   /* something for the proc field       */

     1669    11233    6                     CALL BINCHAR(CHR7,CHG_VAL);

  11233  2 006547   000100 301500                    BTD
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:267  
         2 006550   205220 000004                    NDSC9   CHG_VAL,,AUTO            cn=0,s=lsgnf,sf=0,n=4
         2 006551   204512 030007                    NDSC9   CHR7,,AUTO               cn=0,s=nosgn,sf=0,n=7

     1670    11234    6                     CALL EDITCHAR(OB.PCHG,,,MOP_5_2_STR,CHR7);

  11234  2 006552   100000 024500                    MVNE
         2 006553   204512 030007                    NDSC9   CHR7,,AUTO               cn=0,s=nosgn,sf=0,n=7
         2 006554   000550 000004 1                  ADSC9   MOP_5_2_STR              cn=0,n=4
         2 006555   205205 400010                    ADSC9   OUT_BUF+13,,AUTO         cn=2,n=8

     1671    11235    6                     OB.O_PAREN = '(';

  11235  2 006556   000050 236003                    LDQ     40,DU
         2 006557   205205 552120                    STBQ    OUT_BUF+13,'20'O,AUTO

     1672    11236    6                     OB.C_PAREN = ')';

  11236  2 006560   051000 236007                    LDQ     20992,DL
         2 006561   205207 552110                    STBQ    OUT_BUF+15,'10'O,AUTO

     1673    11237    6                     END;

     1674    11238    5                CHG_VAL = (CHG2+50)/100;

  11238  2 006562   204530 236100                    LDQ     CHG2,,AUTO
         2 006563   000062 036007                    ADLQ    50,DL
         2 006564   000144 506007                    DIV     100,DL
         2 006565   205220 756100                    STQ     CHG_VAL,,AUTO

     1675    11239    5                IF CHG_VAL~=0

  11239  2 006566   000000 116003                    CMPQ    0,DU
         2 006567   006577 600000 2                  TZE     s:11245

     1676    11240    6                THEN DO;

     1677    11241    6                     CALL BINXCHAR(CHR8,CHG_VAL);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:268  

  11241  2 006570   000100 301500                    BTD
         2 006571   205220 000004                    NDSC9   CHG_VAL,,AUTO            cn=0,s=lsgnf,sf=0,n=4
         2 006572   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8

     1678    11242    6                     CALL EDITXCHAR(OB.CHG,,,MOPS_5_2_STR,CHR8);

  11242  2 006573   100000 024500                    MVNE
         2 006574   204514 010010                    NDSC9   CHR8,,AUTO               cn=0,s=lsgns,sf=0,n=8
         2 006575   000535 000006 1                  ADSC9   MOPS_5_2_STR             cn=0,n=6
         2 006576   205207 600011                    ADSC9   OUT_BUF+15,,AUTO         cn=3,n=9

     1679    11243    6                     END;

     1680    11244    5                END;

     1681    11245    4           IF NOT (B$JIT$->B$JIT.CPFLAGS1 & %CP_BRK#)

  11245  2 006577   000000 470400 xsym               LDP0    B$JIT$
         2 006600   000143 236100                    LDQ     99,,PR0
         2 006601   000006 376000 xsym               ANQ     B_VECTNIL+6
         2 006602   006607 601000 2                  TNZ     s:11248

     1682    11246    4           THEN                            /* Don't print if BREAK hit           */
     1683    11247    4                CALL M$WRITE(FPT_WRITE) ALTRET(WRITE_ALT);

  11247  2 006603   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 006604   440001 713400                    CLIMB   alt,write
         2 006605   401400 401760                    pmme    nvectors=4
         2 006606   006610 702000 2                  TSX2    WRITE_ALT

     1684    11248    5           DO WHILE('0'B);

  11248  2 006607   006621 710000 2                  TRA     s:11252

     1685    11249    5   WRITE_ALT:   CALL POST_ERR(%AZ$STATSERR,LOGOFF_PARAM.DCB_LL);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:269  
  11249  2 006610   000001 236000 xsym  WRITE_ALT    LDQ     B_VECTNIL+1
         2 006611   205525 756100                    STQ     @DCB#+1,,AUTO
         2 006612   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 006613   000042 036000 3                  ADLQ    34
         2 006614   205524 756100                    STQ     @ERR+1,,AUTO
         2 006615   000011 236000 3                  LDQ     9
         2 006616   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 006617   011343 701000 2                  TSX1    POST_ERR
         2 006620   000000 011000                    NOP     0

     1686    11250    5                END;

     1687    11251    4           END;

     1688    11252    3   END CHG;

  11252  2 006621   205212 221300                    LDX1  ! OUT_BUF+18,,AUTO
         2 006622   000001 702211                    TSX2  ! 1,X1

     1689    11253        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:270  
     1690    11254    2   STRIP_TIME: PROC(TIME$,MAX);

  11254  2 006623   205232 741300       STRIP_TIME   STX1  ! DECFLT+4,,AUTO

     1691    11255        /*I* NAME: STRIP_TIME
     1692    11256             PURPOSE: To strip leading zeroes and colons from a TIME field
     1693    11257             CALL: CALL STRIP_TIME(TIME$,MAX);
     1694    11258                       where TIME$ is a pointer to a TIME text field to strip
     1695    11259                         and MAX is the maximum number of characters to strip
     1696    11260             DESCRIPTION: This procedure strips leading zeroes and colons from
     1697    11261             the character string pointed to by TIME$ for a maximum of MAX
     1698    11262             characters. The zeroes and colons are replaced by blanks.
     1699    11263        */
     1700    11264    3   DCL TIME$ PTR;
     1701    11265    3   DCL MAX SBIN;
     1702    11266    3   DCL CHR$ARY(0:0) CHAR(1) BASED(TIME$);
     1703    11267    3   DCL I SBIN;
     1704    11268    3      I = 0;

  11268  2 006624   205235 450100                    STZ     I,,AUTO

     1705    11269    4      DO WHILE(I<MAX AND (CHR$ARY(I)='0' OR CHR$ARY(I)=':'));

  11269  2 006625   006635 710000 2                  TRA     s:11272

     1706    11270    4           CHR$ARY(I) = ' ';

  11270  2 006626   205233 470500                    LDP0    @TIME$,,AUTO
         2 006627   000000 471500                    LDP1    0,,PR0
         2 006630   205235 235100                    LDA     I,,AUTO
         2 006631   040105 100400                    MLR     fill='040'O
         2 006632   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006633   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

     1707    11271    4           I = I+1;

  11271  2 006634   205235 054100                    AOS     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:271  

     1708    11272    4           END;

  11272  2 006635   205234 470500                    LDP0    @MAX,,AUTO
         2 006636   205235 236100                    LDQ     I,,AUTO
         2 006637   000000 116100                    CMPQ    0,,PR0
         2 006640   006653 605000 2                  TPL     s:11273
         2 006641   205233 471500                    LDP1    @TIME$,,AUTO
         2 006642   100000 473500                    LDP3    0,,PR1
         2 006643   040000 106506                    CMPC    fill='040'O
         2 006644   300000 000001                    ADSC9   0,Q,PR3                  cn=0,n=1
         2 006645   000120 000001 3                  ADSC9   80                       cn=0,n=1
         2 006646   006626 600000 2                  TZE     s:11270
         2 006647   040000 106506                    CMPC    fill='040'O
         2 006650   300000 000001                    ADSC9   0,Q,PR3                  cn=0,n=1
         2 006651   000141 000001 3                  ADSC9   97                       cn=0,n=1
         2 006652   006626 600000 2                  TZE     s:11270

     1709    11273    3   END STRIP_TIME;

  11273  2 006653   205232 221300                    LDX1  ! DECFLT+4,,AUTO
         2 006654   000001 702211                    TSX2  ! 1,X1

     1710    11274    2   END CHARGE_PRINT;
     1711    11275        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:272  
     1712    11276    1   FILL_REC: PROC(CODE) ALTRET;

  11276  2 006655   204502 741300       FILL_REC     STX1  ! WR_SECLOG+8,,AUTO

     1713    11277        /*I* NAME: FILL_REC
     1714    11278             PURPOSE: To fill a JSP record of the specified CODE and return it
     1715    11279             CALL: CALL FILL_REC(CODE) ALTRET(LABEL);
     1716    11280                    where CODE is optional. If present means to get a JSP record
     1717    11281                               of the specified code. Possible codes if specified
     1718    11282                               are %AZ$JOBEND, %AZ$RECOVERY, %AZ$STATUS or %AZ$BUDGET.
     1719    11283                               If not specified, the code is to come from an already
     1720    11284                               read record.
     1721    11285
     1722    11286             DESCRIPTION: This procedure returns a JSP record of the specified
     1723    11287                          CODE or ALTRETURNs trying. The record is complete upon
     1724    11288                          return except for charge fields and :RATES record key
     1725    11289                          fields.
     1726    11290
     1727    11291                          If no CODE is specified, it is assumed that
     1728    11292                          REC1 contains a PSTART or SSTART record from *S and
     1729    11293                          the key of this record is in ACCT$KEY. All subsequent
     1730    11294                          processor or step records for that step and proc number
     1731    11295                          are read in and used to create a composite JSP record
     1732    11296                          which is then returned.
     1733    11297        */
     1734    11298    2   DCL CODE SBIN;
     1735    11299    2   DCL CUR_STEP SBIN;
     1736    11300    2   DCL CUR_PROC SBIN;
     1737    11301    2   DCL LAST_TYPE SBIN;
     1738    11302    2   DCL SUDO$ PTR;
     1739    11303    2   DCL SUDO1$ PTR;
     1740    11304    2   DCL RES$ PTR;
     1741    11305    2   DCL RES1$ PTR;
     1742    11306    2   DCL FORM$ PTR;
     1743    11307    2   DCL FORM1$ PTR;
     1744    11308        %SUDO(NAME = SUDO,STCLASS="BASED(SUDO$)");
     1745    11339        %SUDO(NAME = SUDO1,STCLASS="BASED(SUDO1$)");
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:273  
     1746    11370        %RES(NAME = RES ,STCLASS="BASED(RES$)");
     1747    11427        %RES(NAME = RES1,STCLASS="BASED(RES1$)");
     1748    11484        %FORM(NAME = FORM ,STCLASS="BASED(FORM$)");
     1749    11530        %FORM(NAME = FORM1,STCLASS="BASED(FORM1$)");
     1750    11576    2      IF ADDR(CODE)~=ADDR(NIL)

  11576  2 006656   204503 236100                    LDQ     @CODE,,AUTO
         2 006657   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006660   006741 600000 2                  TZE     s:11594

     1751    11577    3      THEN DO;

     1752    11578    4           DO CASE(CODE);

  11578  2 006661   204503 470500                    LDP0    @CODE,,AUTO
         2 006662   000000 235100                    LDA     0,,PR0
         2 006663   000007 115007                    CMPA    7,DL
         2 006664   006666 602005 2                  TNC     s:11578+5,AL
         2 006665   006702 710000 2                  TRA     s:11584
         2 006666   006702 710000 2                  TRA     s:11584
         2 006667   006700 710000 2                  TRA     s:11582
         2 006670   006675 710000 2                  TRA     s:11580
         2 006671   006675 710000 2                  TRA     s:11580
         2 006672   006702 710000 2                  TRA     s:11584
         2 006673   006702 710000 2                  TRA     s:11584
         2 006674   006675 710000 2                  TRA     s:11580

     1753    11579    4            CASE(%AZ$STATUS,%AZ$JOBEND,%AZ$BUDGET);

     1754    11580    4              FPT_ACCT.V.TYP# = %JOBEND#;

  11580  2 006675   005000 236003                    LDQ     2560,DU
         2 006676   204447 552140                    STBQ    FPT_ACCT+11,'40'O,AUTO
         2 006677   006702 710000 2                  TRA     s:11584

     1755    11581    4            CASE(%AZ$RECOVERY);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:274  
     1756    11582    4              FPT_ACCT.V.TYP# = %RCVRY#;

  11582  2 006700   006000 236003                    LDQ     3072,DU
         2 006701   204447 552140                    STBQ    FPT_ACCT+11,'40'O,AUTO

     1757    11583    4              END;

     1758    11584    3           CALL M$ACCT(FPT_ACCT) ALTRET(POST_IT);

  11584  2 006702   204434 630500                    EPPR0   FPT_ACCT,,AUTO
         2 006703   400026 713400                    CLIMB   alt,+22
         2 006704   402000 401760                    pmme    nvectors=5
         2 006705   007137 702000 2                  TSX2    POST_IT

     1759    11585    3           JSP.TYPE = CODE;                /* For CODE=%AZ$STATUS case           */

  11585  2 006706   204004 470500                    LDP0    REC$,,AUTO
         2 006707   204503 471500                    LDP1    @CODE,,AUTO
         2 006710   100000 236100                    LDQ     0,,PR1
         2 006711   000022 736000                    QLS     18
         2 006712   000036 552120                    STBQ    30,'20'O,PR0

     1760    11586    3           CALL XUD$UTS_DIFF (JSP.ELAPSED, JSP.CUR_UTS, JSP.START);

  11586  2 006713   204004 236100                    LDQ     REC$,,AUTO
         2 006714   000031 036003                    ADLQ    25,DU
         2 006715   205532 756100                    STQ     DCB$+4,,AUTO
         2 006716   204004 236100                    LDQ     REC$,,AUTO
         2 006717   000034 036003                    ADLQ    28,DU
         2 006720   205531 756100                    STQ     DCB$+3,,AUTO
         2 006721   204004 236100                    LDQ     REC$,,AUTO
         2 006722   000032 036003                    ADLQ    26,DU
         2 006723   205530 756100                    STQ     DCB$+2,,AUTO
         2 006724   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 006725   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 006726   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 006727   000000 011000                    NOP     0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:275  

     1761    11587    3           IF JSP.MODE = %M_INT#

  11587  2 006730   204004 470500                    LDP0    REC$,,AUTO
         2 006731   000036 236100                    LDQ     30,,PR0
         2 006732   777000 376003                    ANQ     -512,DU
         2 006733   003000 116003                    CMPQ    1536,DU
         2 006734   006737 601000 2                  TNZ     s:11589

     1762    11588    3           THEN JSP.CONNECT = JSP.ELAPSED;

  11588  2 006735   000032 235100                    LDA     26,,PR0
         2 006736   000100 755100                    STA     64,,PR0

     1763    11589    3           RETURN;

  11589  2 006737   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 006740   000001 702211                    TSX2  ! 1,X1

     1764    11590    3           END;
     1765    11591        /**/
     1766    11592        /* If we get here, we must form a composite record from several in *S        */
     1767    11593        /**/
     1768    11594    2      IF ACCT$KEY.TYPE#~=%PSTART# AND ACCT$KEY.TYPE#~=%SSTART#

  11594  2 006741   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 006742   000100 101500                    MRL     fill='000'O
         2 006743   000002 200001                    ADSC9   2,,PR0                   cn=1,n=1
         2 006744   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 006745   205530 236100                    LDQ     DCB$+2,,AUTO
         2 006746   000001 116007                    CMPQ    1,DL
         2 006747   006767 600000 2                  TZE     s:11603
         2 006750   000100 101500                    MRL     fill='000'O
         2 006751   000002 200001                    ADSC9   2,,PR0                   cn=1,n=1
         2 006752   205531 000004                    ADSC9   DCB$+3,,AUTO             cn=0,n=4
         2 006753   205531 236100                    LDQ     DCB$+3,,AUTO
         2 006754   000003 116007                    CMPQ    3,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:276  
         2 006755   006767 600000 2                  TZE     s:11603

     1769    11595    3      THEN DO;                             /* Must start with an xSTART record   */

     1770    11596    3           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_MALSTARS);

  11596  2 006756   000012 236000 3                  LDQ     10
         2 006757   000001 235000 xsym               LDA     B_VECTNIL+1
         2 006760   205524 757100                    STAQ    @ERR+1,,AUTO
         2 006761   000005 236000 3                  LDQ     5
         2 006762   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 006763   011343 701000 2                  TSX1    POST_ERR
         2 006764   000000 011000                    NOP     0

     1771    11597    3           ALTRETURN;

  11597  2 006765   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 006766   000000 702211                    TSX2  ! 0,X1

     1772    11598    3           END;
     1773    11599        /*E* ERROR: AZA-E$AZ_MALSTARS
     1774    11600             MESSAGE: The *S accounting records are malformed or unbalanced
     1775    11601        */
     1776    11602
     1777    11603    2      JSP = '0'B;                          /* Clear it out for a new record      */

  11603  2 006767   204004 471500                    LDP1    REC$,,AUTO
         2 006770   000100 100400                    MLR     fill='000'O
         2 006771   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 006772   100000 000604                    ADSC9   0,,PR1                   cn=0,n=388

     1778    11604    2      RECLEN = SIZEC(JSP);

  11604  2 006773   000604 235007                    LDA     388,DL
         2 006774   204006 755100                    STA     RECLEN,,AUTO

     1779    11605    2      JSP.CODE = JSP1.CODE;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:277  

  11605  2 006775   204005 473500                    LDP3    REC1$,,AUTO
         2 006776   300000 236100                    LDQ     0,,PR3
         2 006777   000033 772000                    QRL     27
         2 007000   000033 736000                    QLS     27
         2 007001   100000 756100                    STQ     0,,PR1

     1780    11606    2      JSP.ACCT = JSP1.ACCT;

  11606  2 007002   040100 100500                    MLR     fill='040'O
         2 007003   300001 000010                    ADSC9   1,,PR3                   cn=0,n=8
         2 007004   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

     1781    11607    2      JSP.USERNAME = JSP1.USERNAME;

  11607  2 007005   040100 100500                    MLR     fill='040'O
         2 007006   300003 000014                    ADSC9   3,,PR3                   cn=0,n=12
         2 007007   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12

     1782    11608    2      JSP.JOBNAME = JSP1.JOBNAME;

  11608  2 007010   000100 100500                    MLR     fill='000'O
         2 007011   300006 000040                    ADSC9   6,,PR3                   cn=0,n=32
         2 007012   100006 000040                    ADSC9   6,,PR1                   cn=0,n=32

     1783    11609    2      JSP.WOO = JSP1.WOO;

  11609  2 007013   040100 100500                    MLR     fill='040'O
         2 007014   300016 000010                    ADSC9   14,,PR3                  cn=0,n=8
         2 007015   100016 000010                    ADSC9   14,,PR1                  cn=0,n=8

     1784    11610    2      JSP.ATITLE = JSP1.ATITLE;

  11610  2 007016   040100 100500                    MLR     fill='040'O
         2 007017   300020 000040                    ADSC9   16,,PR3                  cn=0,n=32
         2 007020   100020 000040                    ADSC9   16,,PR1                  cn=0,n=32

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:278  
     1785    11611    2      JSP.SUBMIT = JSP1.SUBMIT;

  11611  2 007021   300030 235100                    LDA     24,,PR3
         2 007022   100030 755100                    STA     24,,PR1

     1786    11612    2      JSP.START = JSP1.START;

  11612  2 007023   300031 235100                    LDA     25,,PR3
         2 007024   100031 755100                    STA     25,,PR1

     1787    11613    2      JSP.HOLD_UTS = JSP1.HOLD_UTS;

  11613  2 007025   300033 235100                    LDA     27,,PR3
         2 007026   100033 755100                    STA     27,,PR1

     1788    11614    2      JSP.PRIO = JSP1.PRIO;

  11614  2 007027   300035 236100                    LDQ     29,,PR3
         2 007030   100035 552140                    STBQ    29,'40'O,PR1

     1789    11615    2      JSP.PART# = JSP1.PART#;

  11615  2 007031   300035 236100                    LDQ     29,,PR3
         2 007032   100035 552120                    STBQ    29,'20'O,PR1

     1790    11616    2      JSP.PART_MASK = JSP1.PART_MASK;

  11616  2 007033   300035 236100                    LDQ     29,,PR3
         2 007034   100035 676100                    ERQ     29,,PR1
         2 007035   777774 376007                    ANQ     -4,DL
         2 007036   100035 656100                    ERSQ    29,,PR1

     1791    11617    2      JSP.MODE = JSP1.MODE;

  11617  2 007037   300036 236100                    LDQ     30,,PR3
         2 007040   100036 552140                    STBQ    30,'40'O,PR1

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:279  
     1792    11618    2      JSP.TYPE = JSP1.TYPE;

  11618  2 007041   300036 236100                    LDQ     30,,PR3
         2 007042   100036 552120                    STBQ    30,'20'O,PR1

     1793    11619    2      JSP.SYSID = JSP1.SYSID;

  11619  2 007043   300036 720100                    LXL0    30,,PR3
         2 007044   100036 440100                    SXL0    30,,PR1

     1794    11620    2      JSP.PROCNAME = JSP1.PROCNAME;

  11620  2 007045   000100 100500                    MLR     fill='000'O
         2 007046   300037 000040                    ADSC9   31,,PR3                  cn=0,n=32
         2 007047   100037 000040                    ADSC9   31,,PR1                  cn=0,n=32

     1795    11621    2      JSP.STEP = JSP1.STEP;

  11621  2 007050   300056 221100                    LDX1    46,,PR3
         2 007051   100056 741100                    STX1    46,,PR1

     1796    11622    2      JSP.JORG = JSP1.JORG;

  11622  2 007052   300056 722100                    LXL2    46,,PR3
         2 007053   100056 442100                    SXL2    46,,PR1

     1797    11623    2      JSP.FLG = JSP1.FLG;

  11623  2 007054   300057 236100                    LDQ     47,,PR3
         2 007055   100057 552104                    STBQ    47,'04'O,PR1

     1798    11624    2      JSP.TSLINE = JSP1.TSLINE;

  11624  2 007056   000100 100500                    MLR     fill='000'O
         2 007057   300060 000014                    ADSC9   48,,PR3                  cn=0,n=12
         2 007060   100060 000014                    ADSC9   48,,PR1                  cn=0,n=12

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:280  
     1799    11625    2      CUR_STEP = ACCT$KEY.STEP#;

  11625  2 007061   000100 101500                    MRL     fill='000'O
         2 007062   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         2 007063   204504 000004                    ADSC9   CUR_STEP,,AUTO           cn=0,n=4

     1800    11626    2      CUR_PROC = ACCT$KEY.PROC#;

  11626  2 007064   000100 101500                    MRL     fill='000'O
         2 007065   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         2 007066   204505 000004                    ADSC9   CUR_PROC,,AUTO           cn=0,n=4

     1801    11627    2      LAST_TYPE = ACCT$KEY.TYPE#;

  11627  2 007067   000100 101500                    MRL     fill='000'O
         2 007070   000002 200001                    ADSC9   2,,PR0                   cn=1,n=1
         2 007071   204506 000004                    ADSC9   LAST_TYPE,,AUTO          cn=0,n=4

     1802    11628    2      ACCT_KEY_SAVE = ACCT$KEY;

  11628  2 007072   000100 100500                    MLR     fill='000'O
         2 007073   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10
         2 007074   204466 000012                    ADSC9   ACCT_KEY_SAVE,,AUTO      cn=0,n=10

     1803    11629
     1804    11630    3      DO WHILE(ACCT$KEY.ACCT#='a' AND ACCT$KEY.STEP#=CUR_STEP

  11630  2 007075   007156 710000 2                  TRA     s:11656

     1805    11631    3        AND ACCT$KEY.PROC#=CUR_PROC);
     1806    11632    3           LAST_TYPE = ACCT$KEY.TYPE#;

  11632  2 007076   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 007077   000100 101500                    MRL     fill='000'O
         2 007100   000002 200001                    ADSC9   2,,PR0                   cn=1,n=1
         2 007101   204506 000004                    ADSC9   LAST_TYPE,,AUTO          cn=0,n=4

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:281  
     1807    11633
     1808    11634    4           DO CASE(LAST_TYPE);

  11634  2 007102   204506 235100                    LDA     LAST_TYPE,,AUTO
         2 007103   000005 115007                    CMPA    5,DL
         2 007104   007106 602005 2                  TNC     s:11634+4,AL
         2 007105   007120 710000 2                  TRA     s:11642
         2 007106   007120 710000 2                  TRA     s:11642
         2 007107   007113 710000 2                  TRA     s:11636
         2 007110   007116 710000 2                  TRA     s:11639
         2 007111   007113 710000 2                  TRA     s:11636
         2 007112   007116 710000 2                  TRA     s:11639

     1809    11635    4            CASE(%PSTART#,%SSTART#);

     1810    11636    4              CALL SUB_EM ALTRET(ALT);

  11636  2 007113   007463 701000 2                  TSX1    SUB_EM
         2 007114   007150 702000 2                  TSX2    ALT
         2 007115   007120 710000 2                  TRA     s:11642

     1811    11637
     1812    11638    4            CASE(%PSTOP#,%SSTOP#);

     1813    11639    4              CALL ADD_EM ALTRET(ALT);

  11639  2 007116   007233 701000 2                  TSX1    ADD_EM
         2 007117   007150 702000 2                  TSX2    ALT

     1814    11640    4              END;

     1815    11641
     1816    11642    3           CALL M$READ(FPT_READ)

  11642  2 007120   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 007121   440000 713400                    CLIMB   alt,read
         2 007122   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:282  
         2 007123   007125 702000 2                  TSX2    s:11644
         2 007124   007152 710000 2                  TRA     s:11655

     1817    11643    4           WHENALTRETURN DO;

     1818    11644    4                ACCT_KEY_SAVE = ACCT$KEY;

  11644  2 007125   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 007126   000100 100500                    MLR     fill='000'O
         2 007127   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10
         2 007130   204466 000012                    ADSC9   ACCT_KEY_SAVE,,AUTO      cn=0,n=10

     1819    11645
     1820    11646    4                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF

  11646  2 007131   000000 471400 xsym               LDP1    B$TCB$
         2 007132   100000 473500                    LDP3    0,,PR1
         2 007133   300102 236100                    LDQ     66,,PR3
         2 007134   377770 376007                    ANQ     131064,DL
         2 007135   000060 116007                    CMPQ    48,DL
         2 007136   007176 600000 2                  TZE     CHECK_STOP

  11646  2 007137                       POST_IT      null
     1821    11647    4                THEN GOTO CHECK_STOP;
     1822    11648
     1823    11649    4   POST_IT:     ;
     1824    11650    4                CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

  11650  2 007137   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007140   205525 756100                    STQ     @DCB#+1,,AUTO
         2 007141   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 007142   000002 036003                    ADLQ    2,DU
         2 007143   205524 756100                    STQ     @ERR+1,,AUTO
         2 007144   000005 236000 3                  LDQ     5
         2 007145   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 007146   011343 701000 2                  TSX1    POST_ERR
         2 007147   000000 011000                    NOP     0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:283  

  11646  2 007150                       ALT          null
     1825    11651    4   ALT:         ;
     1826    11652    4                ALTRETURN;

  11652  2 007150   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 007151   000000 702211                    TSX2  ! 0,X1

     1827    11653    4                END;
     1828    11654
     1829    11655    3           ACCT_KEY_SAVE = ACCT$KEY;

  11655  2 007152   204130 470500                    LDP0    IN_KEY$,,AUTO
         2 007153   000100 100500                    MLR     fill='000'O
         2 007154   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10
         2 007155   204466 000012                    ADSC9   ACCT_KEY_SAVE,,AUTO      cn=0,n=10

     1830    11656    3           END/*do while 'a' */;

  11656  2 007156   040000 106500                    CMPC    fill='040'O
         2 007157   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 007160   000004 000001 3                  ADSC9   4                        cn=0,n=1
         2 007161   007176 601000 2                  TNZ     CHECK_STOP
         2 007162   000100 101500                    MRL     fill='000'O
         2 007163   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         2 007164   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 007165   205530 236100                    LDQ     DCB$+2,,AUTO
         2 007166   204504 116100                    CMPQ    CUR_STEP,,AUTO
         2 007167   007176 601000 2                  TNZ     CHECK_STOP
         2 007170   000100 101500                    MRL     fill='000'O
         2 007171   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         2 007172   205531 000004                    ADSC9   DCB$+3,,AUTO             cn=0,n=4
         2 007173   205531 236100                    LDQ     DCB$+3,,AUTO
         2 007174   204505 116100                    CMPQ    CUR_PROC,,AUTO
         2 007175   007076 600000 2                  TZE     s:11632

  11644  2 007176                       CHECK_STOP   null
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:284  
     1831    11657
     1832    11658    2   CHECK_STOP: ;
     1833    11659    2      IF LAST_TYPE~=%PSTOP# AND LAST_TYPE~=%SSTOP#

  11659  2 007176   204506 235100                    LDA     LAST_TYPE,,AUTO
         2 007177   000002 115007                    CMPA    2,DL
         2 007200   007214 600000 2                  TZE     s:11665
         2 007201   000004 115007                    CMPA    4,DL
         2 007202   007214 600000 2                  TZE     s:11665

     1834    11660    3      THEN DO;                             /* Didn't end on an xSTOP record      */

     1835    11661    3           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_MALSTARS);

  11661  2 007203   000012 236000 3                  LDQ     10
         2 007204   000001 235000 xsym               LDA     B_VECTNIL+1
         2 007205   205524 757100                    STAQ    @ERR+1,,AUTO
         2 007206   000005 236000 3                  LDQ     5
         2 007207   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 007210   011343 701000 2                  TSX1    POST_ERR
         2 007211   000000 011000                    NOP     0

     1836    11662    3           ALTRETURN;

  11662  2 007212   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 007213   000000 702211                    TSX2  ! 0,X1

     1837    11663    3           END;
     1838    11664
     1839    11665    2      CALL XUD$UTS_DIFF (JSP.ELAPSED, JSP.CUR_UTS, JSP.START);

  11665  2 007214   204004 236100                    LDQ     REC$,,AUTO
         2 007215   000031 036003                    ADLQ    25,DU
         2 007216   205532 756100                    STQ     DCB$+4,,AUTO
         2 007217   204004 236100                    LDQ     REC$,,AUTO
         2 007220   000034 036003                    ADLQ    28,DU
         2 007221   205531 756100                    STQ     DCB$+3,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:285  
         2 007222   204004 236100                    LDQ     REC$,,AUTO
         2 007223   000032 036003                    ADLQ    26,DU
         2 007224   205530 756100                    STQ     DCB$+2,,AUTO
         2 007225   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 007226   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 007227   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 007230   000000 011000                    NOP     0

     1840    11666    2      RETURN;

  11666  2 007231   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 007232   000001 702211                    TSX2  ! 1,X1

     1841    11667        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:286  
     1842    11668    2   ADD_EM: PROC ALTRET;

  11668  2 007233   204516 741300       ADD_EM       STX1  ! CHR9,,AUTO

     1843    11669        /*I* NAME: ADD_EM
     1844    11670             PURPOSE: To add entries from JSP1 into JSP on a PSTOP or SSTOP record
     1845    11671             CALL: CALL ADD_EM ALTRET(LABEL);
     1846    11672             DESCRIPTION: This procedure simply takes the entries from JSP1 and
     1847    11673             adds them to the corresponding values in JSP. If an overflow of REC
     1848    11674             occurs, the procedure will ALTRETURN.
     1849    11675        */
     1850    11676    3   DCL I SBIN WORD;
     1851    11677    3      JSP.CUR_UTS = JSP1.CUR_UTS;

  11677  2 007234   204005 470500                    LDP0    REC1$,,AUTO
         2 007235   204004 471500                    LDP1    REC$,,AUTO
         2 007236   000034 235100                    LDA     28,,PR0
         2 007237   100034 755100                    STA     28,,PR1

     1852    11678    3      JSP.STEPCC = JSP1.STEPCC;

  11678  2 007240   000057 236100                    LDQ     47,,PR0
         2 007241   100057 552140                    STBQ    47,'40'O,PR1

     1853    11679    3      JSP.RNST = JSP1.RNST;

  11679  2 007242   000057 236100                    LDQ     47,,PR0
         2 007243   100057 552120                    STBQ    47,'20'O,PR1

     1854    11680    3      JSP.XLIMFLG = JSP1.XLIMFLG;

  11680  2 007244   000057 236100                    LDQ     47,,PR0
         2 007245   100057 552110                    STBQ    47,'10'O,PR1

     1855    11681    3      JSP.PRDPUSED = JSP.PRDPUSED + JSP1.PRDPUSED;

  11681  2 007246   100064 236100                    LDQ     52,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:287  
         2 007247   000064 036100                    ADLQ    52,,PR0
         2 007250   100064 756100                    STQ     52,,PR1

     1856    11682    3      CALL AZB$FAD(JSP.UFTPS,JSP1.UFTPS);

  11682  2 007251   204005 236100                    LDQ     REC1$,,AUTO
         2 007252   000067 036003                    ADLQ    55,DU
         2 007253   205531 756100                    STQ     DCB$+3,,AUTO
         2 007254   204004 236100                    LDQ     REC$,,AUTO
         2 007255   000067 036003                    ADLQ    55,DU
         2 007256   205530 756100                    STQ     DCB$+2,,AUTO
         2 007257   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 007260   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 007261   000000 701000 xent               TSX1    AZB$FAD
         2 007262   000000 011000                    NOP     0

     1857    11683    3      JSP.PMEMTIM = JSP.PMEMTIM + JSP1.PMEMTIM;

  11683  2 007263   204004 470500                    LDP0    REC$,,AUTO
         2 007264   204005 471500                    LDP1    REC1$,,AUTO
         2 007265   000070 236100                    LDQ     56,,PR0
         2 007266   100070 036100                    ADLQ    56,,PR1
         2 007267   000070 756100                    STQ     56,,PR0

     1858    11684    3      JSP.UMEMTIM = JSP.UMEMTIM + JSP1.UMEMTIM;

  11684  2 007270   000071 236100                    LDQ     57,,PR0
         2 007271   100071 036100                    ADLQ    57,,PR1
         2 007272   000071 756100                    STQ     57,,PR0

     1859    11685    3      JSP.MTTIM_CLK = JSP.MTTIM_CLK + JSP1.MTTIM_CLK;

  11685  2 007273   000072 236100                    LDQ     58,,PR0
         2 007274   100072 036100                    ADLQ    58,,PR1
         2 007275   000072 756100                    STQ     58,,PR0

     1860    11686    3      JSP.DPTIM_CLK = JSP.DPTIM_CLK + JSP1.DPTIM_CLK;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:288  

  11686  2 007276   000073 236100                    LDQ     59,,PR0
         2 007277   100073 036100                    ADLQ    59,,PR1
         2 007300   000073 756100                    STQ     59,,PR0

     1861    11687    3      JSP.ORTIM_CLK = JSP.ORTIM_CLK + JSP1.ORTIM_CLK;

  11687  2 007301   000074 236100                    LDQ     60,,PR0
         2 007302   100074 036100                    ADLQ    60,,PR1
         2 007303   000074 756100                    STQ     60,,PR0

     1862    11688    3      JSP.MTTIM_CPU = JSP.MTTIM_CPU + JSP1.MTTIM_CPU;

  11688  2 007304   000075 236100                    LDQ     61,,PR0
         2 007305   100075 036100                    ADLQ    61,,PR1
         2 007306   000075 756100                    STQ     61,,PR0

     1863    11689    3      JSP.DPTIM_CPU = JSP.DPTIM_CPU + JSP1.DPTIM_CPU;

  11689  2 007307   000076 236100                    LDQ     62,,PR0
         2 007310   100076 036100                    ADLQ    62,,PR1
         2 007311   000076 756100                    STQ     62,,PR0

     1864    11690    3      JSP.ORTIM_CPU = JSP.ORTIM_CPU + JSP1.ORTIM_CPU;

  11690  2 007312   000077 236100                    LDQ     63,,PR0
         2 007313   100077 036100                    ADLQ    63,,PR1
         2 007314   000077 756100                    STQ     63,,PR0

     1865    11691    3      JSP.MTACCESS = JSP.MTACCESS + JSP1.MTACCESS;

  11691  2 007315   000101 236100                    LDQ     65,,PR0
         2 007316   100101 036100                    ADLQ    65,,PR1
         2 007317   000101 756100                    STQ     65,,PR0

     1866    11692    3      JSP.DPACCESS = JSP.DPACCESS + JSP1.DPACCESS;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:289  
  11692  2 007320   000102 236100                    LDQ     66,,PR0
         2 007321   100102 036100                    ADLQ    66,,PR1
         2 007322   000102 756100                    STQ     66,,PR0

     1867    11693    3      JSP.ORACCESS = JSP.ORACCESS + JSP1.ORACCESS;

  11693  2 007323   000103 236100                    LDQ     67,,PR0
         2 007324   100103 036100                    ADLQ    67,,PR1
         2 007325   000103 756100                    STQ     67,,PR0

     1868    11694    3      JSP.MTMOUNT = JSP.MTMOUNT + JSP1.MTMOUNT;

  11694  2 007326   000104 236100                    LDQ     68,,PR0
         2 007327   100104 036100                    ADLQ    68,,PR1
         2 007330   000104 756100                    STQ     68,,PR0

     1869    11695    3      JSP.DPMOUNT = JSP.DPMOUNT + JSP1.DPMOUNT;

  11695  2 007331   000105 236100                    LDQ     69,,PR0
         2 007332   100105 036100                    ADLQ    69,,PR1
         2 007333   000105 756100                    STQ     69,,PR0

     1870    11696    3      JSP.ORMOUNT = JSP.ORMOUNT + JSP1.ORMOUNT;

  11696  2 007334   000106 236100                    LDQ     70,,PR0
         2 007335   100106 036100                    ADLQ    70,,PR1
         2 007336   000106 756100                    STQ     70,,PR0

     1871    11697    3      JSP.TINTER = JSP.TINTER + JSP1.TINTER;

  11697  2 007337   000107 236100                    LDQ     71,,PR0
         2 007340   100107 036100                    ADLQ    71,,PR1
         2 007341   000107 756100                    STQ     71,,PR0

     1872    11698    3      JSP.PMMES = JSP.PMMES + JSP1.PMMES;

  11698  2 007342   000110 236100                    LDQ     72,,PR0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:290  
         2 007343   100110 036100                    ADLQ    72,,PR1
         2 007344   000110 756100                    STQ     72,,PR0

     1873    11699    3      JSP.PEXEC = JSP.PEXEC + JSP1.PEXEC;

  11699  2 007345   000111 236100                    LDQ     73,,PR0
         2 007346   100111 036100                    ADLQ    73,,PR1
         2 007347   000111 756100                    STQ     73,,PR0

     1874    11700    3      JSP.UEXEC = JSP.UEXEC + JSP1.UEXEC;

  11700  2 007350   000112 236100                    LDQ     74,,PR0
         2 007351   100112 036100                    ADLQ    74,,PR1
         2 007352   000112 756100                    STQ     74,,PR0

     1875    11701    3      JSP.PSTIME = JSP.PSTIME + JSP1.PSTIME;

  11701  2 007353   000113 236100                    LDQ     75,,PR0
         2 007354   100113 036100                    ADLQ    75,,PR1
         2 007355   000113 756100                    STQ     75,,PR0

     1876    11702    3      JSP.USTIME = JSP.USTIME + JSP1.USTIME;

  11702  2 007356   000114 236100                    LDQ     76,,PR0
         2 007357   100114 036100                    ADLQ    76,,PR1
         2 007360   000114 756100                    STQ     76,,PR0

     1877    11703    4      DO I=0 TO 3;

  11703  2 007361   204517 450100                    STZ     I,,AUTO

     1878    11704    4           JSP.JSUNITS(I) = JSP.JSUNITS(I) + JSP1.JSUNITS(I);

  11704  2 007362   204517 235100                    LDA     I,,AUTO
         2 007363   000001 735000                    ALS     1
         2 007364   204005 470500                    LDP0    REC1$,,AUTO
         2 007365   000100 100505                    MLR     fill='000'O
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:291  
         2 007366   000115 000002                    ADSC9   77,A,PR0                 cn=0,n=2
         2 007367   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 007370   205530 236100                    LDQ     DCB$+2,,AUTO
         2 007371   000022 732000                    QRS     18
         2 007372   205531 756100                    STQ     DCB$+3,,AUTO
         2 007373   204004 471500                    LDP1    REC$,,AUTO
         2 007374   000100 100505                    MLR     fill='000'O
         2 007375   100115 000002                    ADSC9   77,A,PR1                 cn=0,n=2
         2 007376   205532 000004                    ADSC9   DCB$+4,,AUTO             cn=0,n=4
         2 007377   205532 236100                    LDQ     DCB$+4,,AUTO
         2 007400   000022 732000                    QRS     18
         2 007401   205531 036100                    ADLQ    DCB$+3,,AUTO
         2 007402   205533 756100                    STQ     DCB$+5,,AUTO
         2 007403   000105 101500                    MRL     fill='000'O
         2 007404   205533 000004                    ADSC9   DCB$+5,,AUTO             cn=0,n=4
         2 007405   100115 000002                    ADSC9   77,A,PR1                 cn=0,n=2

     1879    11705    4           END;

  11705  2 007406   204517 054100                    AOS     I,,AUTO
         2 007407   204517 235100                    LDA     I,,AUTO
         2 007410   000003 115007                    CMPA    3,DL
         2 007411   007362 604400 2                  TMOZ    s:11704

     1880    11706    3      IF JSP.TYPE=%AZ$STEP

  11706  2 007412   100036 236100                    LDQ     30,,PR1
         2 007413   000777 376003                    ANQ     511,DU
         2 007414   000004 116003                    CMPQ    4,DU
         2 007415   007424 601000 2                  TNZ     s:11712

     1881    11707    4      THEN DO;

     1882    11708    4           JSP.PKCO = JSP1.PKCO;

  11708  2 007416   000055 720100                    LXL0    45,,PR0
         2 007417   100055 440100                    SXL0    45,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:292  

     1883    11709    4           JSP.TMDPPK = JSP1.TMDPPK;

  11709  2 007420   000063 235100                    LDA     51,,PR0
         2 007421   100063 755100                    STA     51,,PR1

     1884    11710    4           JSP.RESPEAK = JSP1.RESPEAK;

  11710  2 007422   000055 221100                    LDX1    45,,PR0
         2 007423   100055 741100                    STX1    45,,PR1

     1885    11711    4           END;

     1886    11712    3      IF JSP.MODE = %M_INT#

  11712  2 007424   100036 236100                    LDQ     30,,PR1
         2 007425   777000 376003                    ANQ     -512,DU
         2 007426   003000 116003                    CMPQ    1536,DU
         2 007427   007433 601000 2                  TNZ     s:11714

     1887    11713    3      THEN JSP.CONNECT = JSP.CONNECT + JSP1.CUR_UTS;

  11713  2 007430   100100 236100                    LDQ     64,,PR1
         2 007431   000034 036100                    ADLQ    28,,PR0
         2 007432   100100 756100                    STQ     64,,PR1

     1888    11714    3      IF JSP1.SUDO_CNT>0 THEN CALL SUDOS(1) ALTRET(ALT);

  11714  2 007433   000134 235100                    LDA     92,,PR0
         2 007434   007441 604400 2                  TMOZ    s:11715

  11714  2 007435   000011 236000 3                  LDQ     9
         2 007436   204521 756100                    STQ     CHR10,,AUTO
         2 007437   007757 701000 2                  TSX1    SUDOS
         2 007440   007461 702000 2                  TSX2    ALT

     1889    11715    3      IF JSP1.RES_CNT>0 THEN CALL RESOURCES(1) ALTRET(ALT);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:293  

  11715  2 007441   204005 470500                    LDP0    REC1$,,AUTO
         2 007442   000136 235100                    LDA     94,,PR0
         2 007443   007450 604400 2                  TMOZ    s:11716

  11715  2 007444   000011 236000 3                  LDQ     9
         2 007445   204521 756100                    STQ     CHR10,,AUTO
         2 007446   010246 701000 2                  TSX1    RESOURCES
         2 007447   007461 702000 2                  TSX2    ALT

     1890    11716    3      IF JSP1.FORM_CNT>0 THEN CALL FORMS(1) ALTRET(ALT);

  11716  2 007450   204005 470500                    LDP0    REC1$,,AUTO
         2 007451   000140 235100                    LDA     96,,PR0
         2 007452   007457 604400 2                  TMOZ    s:11717

  11716  2 007453   000011 236000 3                  LDQ     9
         2 007454   204521 756100                    STQ     CHR10,,AUTO
         2 007455   010554 701000 2                  TSX1    FORMS
         2 007456   007461 702000 2                  TSX2    ALT

     1891    11717    3      RETURN;

  11717  2 007457   204516 221300                    LDX1  ! CHR9,,AUTO
         2 007460   000001 702211                    TSX2  ! 1,X1

     1892    11718    3   ALT: ALTRETURN;

  11718  2 007461   204516 221300       ALT          LDX1  ! CHR9,,AUTO
         2 007462   000000 702211                    TSX2  ! 0,X1

     1893    11719    3   END ADD_EM;
     1894    11720        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:294  
     1895    11721    2   SUB_EM: PROC ALTRET;

  11721  2 007463   204516 741300       SUB_EM       STX1  ! CHR9,,AUTO

     1896    11722        /*I* NAME: SUB_EM
     1897    11723             PURPOSE: To sub entries in JSP1 from JSP on a PSTART or SSTART record
     1898    11724             CALL: CALL SUB_EM ALTRET(LABEL);
     1899    11725             DESCRIPTION: This procedure simply takes the entries from JSP1 and
     1900    11726             subtracts them from the corresponding values in JSP. If an overflow of
     1901    11727             REC occurs, the procedure will ALTRETURN.
     1902    11728        */
     1903    11729    3   DCL I SBIN WORD;
     1904    11730    3      JSP.PRDPUSED = JSP.PRDPUSED - JSP1.PRDPUSED;

  11730  2 007464   204005 470500                    LDP0    REC1$,,AUTO
         2 007465   204004 471500                    LDP1    REC$,,AUTO
         2 007466   100064 236100                    LDQ     52,,PR1
         2 007467   000064 136100                    SBLQ    52,,PR0
         2 007470   100064 756100                    STQ     52,,PR1

     1905    11731    3      CALL AZB$FSB(JSP.UFTPS,JSP1.UFTPS);

  11731  2 007471   204005 236100                    LDQ     REC1$,,AUTO
         2 007472   000067 036003                    ADLQ    55,DU
         2 007473   205531 756100                    STQ     DCB$+3,,AUTO
         2 007474   204004 236100                    LDQ     REC$,,AUTO
         2 007475   000067 036003                    ADLQ    55,DU
         2 007476   205530 756100                    STQ     DCB$+2,,AUTO
         2 007477   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 007500   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 007501   000000 701000 xent               TSX1    AZB$FSB
         2 007502   000000 011000                    NOP     0

     1906    11732    3      JSP.PMEMTIM = JSP.PMEMTIM - JSP1.PMEMTIM;

  11732  2 007503   204005 470500                    LDP0    REC1$,,AUTO
         2 007504   204004 471500                    LDP1    REC$,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:295  
         2 007505   100070 236100                    LDQ     56,,PR1
         2 007506   000070 136100                    SBLQ    56,,PR0
         2 007507   100070 756100                    STQ     56,,PR1

     1907    11733    3      JSP.UMEMTIM = JSP.UMEMTIM - JSP1.UMEMTIM;

  11733  2 007510   100071 236100                    LDQ     57,,PR1
         2 007511   000071 136100                    SBLQ    57,,PR0
         2 007512   100071 756100                    STQ     57,,PR1

     1908    11734    3      JSP.MTTIM_CLK = JSP.MTTIM_CLK - JSP1.MTTIM_CLK;

  11734  2 007513   100072 236100                    LDQ     58,,PR1
         2 007514   000072 136100                    SBLQ    58,,PR0
         2 007515   100072 756100                    STQ     58,,PR1

     1909    11735    3      JSP.DPTIM_CLK = JSP.DPTIM_CLK - JSP1.DPTIM_CLK;

  11735  2 007516   100073 236100                    LDQ     59,,PR1
         2 007517   000073 136100                    SBLQ    59,,PR0
         2 007520   100073 756100                    STQ     59,,PR1

     1910    11736    3      JSP.ORTIM_CLK = JSP.ORTIM_CLK - JSP1.ORTIM_CLK;

  11736  2 007521   100074 236100                    LDQ     60,,PR1
         2 007522   000074 136100                    SBLQ    60,,PR0
         2 007523   100074 756100                    STQ     60,,PR1

     1911    11737    3      JSP.MTTIM_CPU = JSP.MTTIM_CPU - JSP1.MTTIM_CPU;

  11737  2 007524   100075 236100                    LDQ     61,,PR1
         2 007525   000075 136100                    SBLQ    61,,PR0
         2 007526   100075 756100                    STQ     61,,PR1

     1912    11738    3      JSP.DPTIM_CPU = JSP.DPTIM_CPU - JSP1.DPTIM_CPU;

  11738  2 007527   100076 236100                    LDQ     62,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:296  
         2 007530   000076 136100                    SBLQ    62,,PR0
         2 007531   100076 756100                    STQ     62,,PR1

     1913    11739    3      JSP.ORTIM_CPU = JSP.ORTIM_CPU - JSP1.ORTIM_CPU;

  11739  2 007532   100077 236100                    LDQ     63,,PR1
         2 007533   000077 136100                    SBLQ    63,,PR0
         2 007534   100077 756100                    STQ     63,,PR1

     1914    11740    3      JSP.MTACCESS = JSP.MTACCESS - JSP1.MTACCESS;

  11740  2 007535   100101 236100                    LDQ     65,,PR1
         2 007536   000101 136100                    SBLQ    65,,PR0
         2 007537   100101 756100                    STQ     65,,PR1

     1915    11741    3      JSP.DPACCESS = JSP.DPACCESS - JSP1.DPACCESS;

  11741  2 007540   100102 236100                    LDQ     66,,PR1
         2 007541   000102 136100                    SBLQ    66,,PR0
         2 007542   100102 756100                    STQ     66,,PR1

     1916    11742    3      JSP.ORACCESS = JSP.ORACCESS - JSP1.ORACCESS;

  11742  2 007543   100103 236100                    LDQ     67,,PR1
         2 007544   000103 136100                    SBLQ    67,,PR0
         2 007545   100103 756100                    STQ     67,,PR1

     1917    11743    3      JSP.MTMOUNT = JSP.MTMOUNT - JSP1.MTMOUNT;

  11743  2 007546   100104 236100                    LDQ     68,,PR1
         2 007547   000104 136100                    SBLQ    68,,PR0
         2 007550   100104 756100                    STQ     68,,PR1

     1918    11744    3      JSP.DPMOUNT = JSP.DPMOUNT - JSP1.DPMOUNT;

  11744  2 007551   100105 236100                    LDQ     69,,PR1
         2 007552   000105 136100                    SBLQ    69,,PR0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:297  
         2 007553   100105 756100                    STQ     69,,PR1

     1919    11745    3      JSP.ORMOUNT = JSP.ORMOUNT - JSP1.ORMOUNT;

  11745  2 007554   100106 236100                    LDQ     70,,PR1
         2 007555   000106 136100                    SBLQ    70,,PR0
         2 007556   100106 756100                    STQ     70,,PR1

     1920    11746    3      JSP.TINTER = JSP.TINTER - JSP1.TINTER;

  11746  2 007557   100107 236100                    LDQ     71,,PR1
         2 007560   000107 136100                    SBLQ    71,,PR0
         2 007561   100107 756100                    STQ     71,,PR1

     1921    11747    3      JSP.PMMES = JSP.PMMES - JSP1.PMMES;

  11747  2 007562   100110 236100                    LDQ     72,,PR1
         2 007563   000110 136100                    SBLQ    72,,PR0
         2 007564   100110 756100                    STQ     72,,PR1

     1922    11748    3      JSP.PEXEC = JSP.PEXEC - JSP1.PEXEC;

  11748  2 007565   100111 236100                    LDQ     73,,PR1
         2 007566   000111 136100                    SBLQ    73,,PR0
         2 007567   100111 756100                    STQ     73,,PR1

     1923    11749    3      JSP.UEXEC = JSP.UEXEC - JSP1.UEXEC;

  11749  2 007570   100112 236100                    LDQ     74,,PR1
         2 007571   000112 136100                    SBLQ    74,,PR0
         2 007572   100112 756100                    STQ     74,,PR1

     1924    11750    3      JSP.PSTIME = JSP.PSTIME - JSP1.PSTIME;

  11750  2 007573   100113 236100                    LDQ     75,,PR1
         2 007574   000113 136100                    SBLQ    75,,PR0
         2 007575   100113 756100                    STQ     75,,PR1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:298  

     1925    11751    3      JSP.USTIME = JSP.USTIME - JSP1.USTIME;

  11751  2 007576   100114 236100                    LDQ     76,,PR1
         2 007577   000114 136100                    SBLQ    76,,PR0
         2 007600   100114 756100                    STQ     76,,PR1

     1926    11752    4      DO I=0 TO 3;

  11752  2 007601   204517 450100                    STZ     I,,AUTO

     1927    11753    4           JSP.JSUNITS(I) = JSP.JSUNITS(I) - JSP1.JSUNITS(I);

  11753  2 007602   204517 235100                    LDA     I,,AUTO
         2 007603   000001 735000                    ALS     1
         2 007604   204005 470500                    LDP0    REC1$,,AUTO
         2 007605   000100 100505                    MLR     fill='000'O
         2 007606   000115 000002                    ADSC9   77,A,PR0                 cn=0,n=2
         2 007607   205530 000004                    ADSC9   DCB$+2,,AUTO             cn=0,n=4
         2 007610   205530 236100                    LDQ     DCB$+2,,AUTO
         2 007611   000022 732000                    QRS     18
         2 007612   205531 756100                    STQ     DCB$+3,,AUTO
         2 007613   204004 471500                    LDP1    REC$,,AUTO
         2 007614   000100 100505                    MLR     fill='000'O
         2 007615   100115 000002                    ADSC9   77,A,PR1                 cn=0,n=2
         2 007616   205532 000004                    ADSC9   DCB$+4,,AUTO             cn=0,n=4
         2 007617   205532 236100                    LDQ     DCB$+4,,AUTO
         2 007620   000022 732000                    QRS     18
         2 007621   205531 136100                    SBLQ    DCB$+3,,AUTO
         2 007622   205533 756100                    STQ     DCB$+5,,AUTO
         2 007623   000105 101500                    MRL     fill='000'O
         2 007624   205533 000004                    ADSC9   DCB$+5,,AUTO             cn=0,n=4
         2 007625   100115 000002                    ADSC9   77,A,PR1                 cn=0,n=2

     1928    11754    4           END;

  11754  2 007626   204517 054100                    AOS     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:299  
         2 007627   204517 235100                    LDA     I,,AUTO
         2 007630   000003 115007                    CMPA    3,DL
         2 007631   007602 604400 2                  TMOZ    s:11753

     1929    11755    3      IF JSP.MODE = %M_INT#

  11755  2 007632   100036 236100                    LDQ     30,,PR1
         2 007633   777000 376003                    ANQ     -512,DU
         2 007634   003000 116003                    CMPQ    1536,DU
         2 007635   007641 601000 2                  TNZ     s:11757

     1930    11756    3      THEN JSP.CONNECT = JSP.CONNECT - JSP1.CUR_UTS;

  11756  2 007636   100100 236100                    LDQ     64,,PR1
         2 007637   000034 136100                    SBLQ    28,,PR0
         2 007640   100100 756100                    STQ     64,,PR1

     1931    11757    3      IF JSP1.SUDO_CNT>0 THEN CALL SUDOS(-1) ALTRET(ALT);

  11757  2 007641   000134 235100                    LDA     92,,PR0
         2 007642   007647 604400 2                  TMOZ    s:11758

  11757  2 007643   000142 236000 3                  LDQ     98
         2 007644   204521 756100                    STQ     CHR10,,AUTO
         2 007645   007757 701000 2                  TSX1    SUDOS
         2 007646   007667 702000 2                  TSX2    ALT

     1932    11758    3      IF JSP1.RES_CNT>0 THEN CALL RESOURCES(-1) ALTRET(ALT);

  11758  2 007647   204005 470500                    LDP0    REC1$,,AUTO
         2 007650   000136 235100                    LDA     94,,PR0
         2 007651   007656 604400 2                  TMOZ    s:11759

  11758  2 007652   000142 236000 3                  LDQ     98
         2 007653   204521 756100                    STQ     CHR10,,AUTO
         2 007654   010246 701000 2                  TSX1    RESOURCES
         2 007655   007667 702000 2                  TSX2    ALT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:300  

     1933    11759    3      IF JSP1.FORM_CNT>0 THEN CALL FORMS(-1) ALTRET(ALT);

  11759  2 007656   204005 470500                    LDP0    REC1$,,AUTO
         2 007657   000140 235100                    LDA     96,,PR0
         2 007660   007665 604400 2                  TMOZ    s:11760

  11759  2 007661   000142 236000 3                  LDQ     98
         2 007662   204521 756100                    STQ     CHR10,,AUTO
         2 007663   010554 701000 2                  TSX1    FORMS
         2 007664   007667 702000 2                  TSX2    ALT

     1934    11760    3      RETURN;

  11760  2 007665   204516 221300                    LDX1  ! CHR9,,AUTO
         2 007666   000001 702211                    TSX2  ! 1,X1

     1935    11761    3   ALT: ALTRETURN;

  11761  2 007667   204516 221300       ALT          LDX1  ! CHR9,,AUTO
         2 007670   000000 702211                    TSX2  ! 0,X1

     1936    11762    3   END SUB_EM;
     1937    11763        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:301  
     1938    11764    2   MOVE: PROC(FROM,TOO,LEN) ALTRET;

  11764  2 007671   204526 741300       MOVE         STX1  ! FOUND+1,,AUTO

     1939    11765        /*I* NAME: MOVE
     1940    11766             PURPOSE: To move the variable length portions of JSP around in REC
     1941    11767             CALL: CALL MOVE(FROM,TOO,LEN) ALTRET(LABEL);
     1942    11768                    where FROM is the word index into REC of the area to move
     1943    11769                          TOO is the word index into REC to move the area to
     1944    11770                          LEN is the length in words of the area to move
     1945    11771             DESCRIPTION: This procedure moves LEN words in REC from word index
     1946    11772             FROM to word index TOO. If the move would result in data being moved out
     1947    11773             of REC, the procedure does not move any data and ALTRETURNs.
     1948    11774        */
     1949    11775    3   DCL FROM SBIN;
     1950    11776    3   DCL TOO SBIN;
     1951    11777    3   DCL LEN SBIN;
     1952    11778    3   DCL I SBIN;
     1953    11779    3      IF TOO+LEN>1024 OR TOO<0

  11779  2 007672   204530 470500                    LDP0    @TOO,,AUTO
         2 007673   204531 471500                    LDP1    @LEN,,AUTO
         2 007674   000000 236100                    LDQ     0,,PR0
         2 007675   100000 036100                    ADLQ    0,,PR1
         2 007676   002000 116007                    CMPQ    1024,DL
         2 007677   007702 605400 2                  TPNZ    s:11780
         2 007700   000000 235100                    LDA     0,,PR0
         2 007701   007703 605000 2                  TPL     s:11781

     1954    11780    3      THEN ALTRETURN;

  11780  2 007702   000000 702211                    TSX2  ! 0,X1

     1955    11781    3      IF FROM<TOO

  11781  2 007703   204527 473500                    LDP3    @FROM,,AUTO
         2 007704   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:302  
         2 007705   000000 116100                    CMPQ    0,,PR0
         2 007706   007734 605000 2                  TPL     s:11785

     1956    11782    4      THEN DO I=1 TO LEN;

  11782  2 007707   000001 235007                    LDA     1,DL
         2 007710   204532 755100                    STA     I,,AUTO
         2 007711   007730 710000 2                  TRA     s:11784+1

     1957    11783    4           REC(TOO+LEN-I) = REC(FROM+LEN-I);

  11783  2 007712   204530 470500                    LDP0    @TOO,,AUTO
         2 007713   204531 471500                    LDP1    @LEN,,AUTO
         2 007714   000000 236100                    LDQ     0,,PR0
         2 007715   100000 036100                    ADLQ    0,,PR1
         2 007716   204532 136100                    SBLQ    I,,AUTO
         2 007717   204527 473500                    LDP3    @FROM,,AUTO
         2 007720   205530 756100                    STQ     DCB$+2,,AUTO
         2 007721   300000 236100                    LDQ     0,,PR3
         2 007722   100000 036100                    ADLQ    0,,PR1
         2 007723   204532 136100                    SBLQ    I,,AUTO
         2 007724   205530 720100                    LXL0    DCB$+2,,AUTO
         2 007725   200004 235106                    LDA     REC,QL,AUTO
         2 007726   200004 755110                    STA     REC,X0,AUTO

     1958    11784    4           END;

  11784  2 007727   204532 054100                    AOS     I,,AUTO
         2 007730   204532 236100                    LDQ     I,,AUTO
         2 007731   100000 116100                    CMPQ    0,,PR1
         2 007732   007712 604400 2                  TMOZ    s:11783
         2 007733   007755 710000 2                  TRA     s:11788

     1959    11785    4      ELSE DO I=0 TO LEN-1;

  11785  2 007734   204532 450100                    STZ     I,,AUTO
         2 007735   007751 710000 2                  TRA     s:11787+1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:303  

     1960    11786    4           REC(TOO+I) = REC(FROM+I);

  11786  2 007736   204530 470500                    LDP0    @TOO,,AUTO
         2 007737   000000 236100                    LDQ     0,,PR0
         2 007740   204532 036100                    ADLQ    I,,AUTO
         2 007741   204527 471500                    LDP1    @FROM,,AUTO
         2 007742   205530 756100                    STQ     DCB$+2,,AUTO
         2 007743   100000 236100                    LDQ     0,,PR1
         2 007744   204532 036100                    ADLQ    I,,AUTO
         2 007745   205530 720100                    LXL0    DCB$+2,,AUTO
         2 007746   200004 235106                    LDA     REC,QL,AUTO
         2 007747   200004 755110                    STA     REC,X0,AUTO

     1961    11787    4           END;

  11787  2 007750   204532 054100                    AOS     I,,AUTO
         2 007751   204531 471500                    LDP1    @LEN,,AUTO
         2 007752   204532 236100                    LDQ     I,,AUTO
         2 007753   100000 116100                    CMPQ    0,,PR1
         2 007754   007736 604000 2                  TMI     s:11786

     1962    11788    3      RETURN;

  11788  2 007755   204526 221300                    LDX1  ! FOUND+1,,AUTO
         2 007756   000001 702211                    TSX2  ! 1,X1

     1963    11789    3   END MOVE;
     1964    11790        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:304  
     1965    11791    2   SUDOS: PROC(MULT) ALTRET;

  11791  2 007757   204520 741300       SUDOS        STX1  ! I+1,,AUTO

     1966    11792        /*I* NAME: SUDOS
     1967    11793             PURPOSE: To add or subtract the pseudo resource info in JSP1 to JSP
     1968    11794             CALL: CALL SUDOS(MULT) ALTRET(LABEL);
     1969    11795                    where MULT is 1 or -1 and determines whether the info is to
     1970    11796                    be added or subtracted from JSP
     1971    11797             DESCRIPTION: This procedure adds or subtracts the pseudo resource
     1972    11798             information in JSP1 from that in JSP. If JSP needs to be expanded to
     1973    11799             accomodate this, expansion is attempted. If the expansion fails (not
     1974    11800             enough room in REC), the procedure ALTRETURNs.
     1975    11801             If an un-used pseudo resource is found, it is removed from JSP
     1976    11802             thereby reducing the size of JSP.
     1977    11803        */
     1978    11804    3   DCL MULT SBIN WORD;
     1979    11805    3   DCL I SBIN;
     1980    11806    3   DCL J SBIN;
     1981    11807    3   DCL FROM SBIN;
     1982    11808    3   DCL FOUND BIT(1) ALIGNED;
     1983    11809    3      SUDO$ = PINCRW(REC$,JSP.SUDOX);

  11809  2 007760   204004 470500                    LDP0    REC$,,AUTO
         2 007761   000133 236100                    LDQ     91,,PR0
         2 007762   000022 736000                    QLS     18
         2 007763   204004 036100                    ADLQ    REC$,,AUTO
         2 007764   204507 756100                    STQ     SUDO$,,AUTO

     1984    11810    3      SUDO1$ = PINCRW(REC1$,JSP1.SUDOX);

  11810  2 007765   204005 471500                    LDP1    REC1$,,AUTO
         2 007766   100133 236100                    LDQ     91,,PR1
         2 007767   000022 736000                    QLS     18
         2 007770   204005 036100                    ADLQ    REC1$,,AUTO
         2 007771   204510 756100                    STQ     SUDO1$,,AUTO

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:305  
     1985    11811    4      DO J=0 TO JSP1.SUDO_CNT-1;

  11811  2 007772   204523 450100                    STZ     J,,AUTO
         2 007773   010240 710000 2                  TRA     s:11864+1

     1986    11812    4           I = 0;

  11812  2 007774   204522 450100                    STZ     I,,AUTO

     1987    11813    4           FOUND = '0'B;

  11813  2 007775   204525 450100                    STZ     FOUND,,AUTO

     1988    11814    5           DO WHILE(NOT FOUND AND I<JSP.SUDO_CNT);

  11814  2 007776   010017 710000 2                  TRA     s:11818

     1989    11815    5                IF SUDO1.NAM(J) = SUDO.NAM(I)

  11815  2 007777   204523 236100                    LDQ     J,,AUTO
         2 010000   000024 402007                    MPY     20,DL
         2 010001   205530 756100                    STQ     DCB$+2,,AUTO
         2 010002   204522 236100                    LDQ     I,,AUTO
         2 010003   000024 402007                    MPY     20,DL
         2 010004   204510 470500                    LDP0    SUDO1$,,AUTO
         2 010005   205530 235100                    LDA     DCB$+2,,AUTO
         2 010006   204507 471500                    LDP1    SUDO$,,AUTO
         2 010007   040106 106505                    CMPC    fill='040'O
         2 010010   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
         2 010011   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=8
         2 010012   010016 601000 2                  TNZ     s:11817

     1990    11816    5                THEN FOUND = '1'B;

  11816  2 010013   400000 236003                    LDQ     -131072,DU
         2 010014   204525 756100                    STQ     FOUND,,AUTO
         2 010015   010017 710000 2                  TRA     s:11818
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:306  

     1991    11817    5                ELSE I = I+1;

  11817  2 010016   204522 054100                    AOS     I,,AUTO

     1992    11818    5                END;

  11818  2 010017   204525 234100                    SZN     FOUND,,AUTO
         2 010020   010025 604000 2                  TMI     s:11819
         2 010021   204004 470500                    LDP0    REC$,,AUTO
         2 010022   204522 236100                    LDQ     I,,AUTO
         2 010023   000134 116100                    CMPQ    92,,PR0
         2 010024   007777 604000 2                  TMI     s:11815

     1993    11819    4           IF NOT FOUND

  11819  2 010025   204525 234100                    SZN     FOUND,,AUTO
         2 010026   010130 604000 2                  TMI     s:11850

     1994    11820    5           THEN DO;                        /* Must add this entry                */

     1995    11821    5                IF JSP.RES_CNT>0 OR JSP.FORM_CNT>0

  11821  2 010027   204004 470500                    LDP0    REC$,,AUTO
         2 010030   000136 235100                    LDA     94,,PR0
         2 010031   010034 605400 2                  TPNZ    s:11823
         2 010032   000140 235100                    LDA     96,,PR0
         2 010033   010074 604400 2                  TMOZ    s:11833

     1996    11822    6                THEN DO;                   /* Must make room by moving down      */

     1997    11823    6                     IF JSP.RES_CNT>0

  11823  2 010034   000136 235100                    LDA     94,,PR0
         2 010035   010041 604400 2                  TMOZ    s:11825

     1998    11824    6                     THEN FROM = JSP.RESX;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:307  

  11824  2 010036   000135 235100                    LDA     93,,PR0
         2 010037   204524 755100                    STA     FROM,,AUTO
         2 010040   010043 710000 2                  TRA     s:11826

     1999    11825    6                     ELSE FROM = JSP.FORMX;

  11825  2 010041   000137 235100                    LDA     95,,PR0
         2 010042   204524 755100                    STA     FROM,,AUTO

     2000    11826    6                     CALL MOVE(FROM,FROM+SIZEW(SUDO(0)),RECLEN/4-FROM+1)

  11826  2 010043   204006 236100                    LDQ     RECLEN,,AUTO
         2 010044   000004 506007                    DIV     4,DL
         2 010045   204524 136100                    SBLQ    FROM,,AUTO
         2 010046   204524 235100                    LDA     FROM,,AUTO
         2 010047   000005 035007                    ADLA    5,DL
         2 010050   205547 755100                    STA     DCB$+17,,AUTO
         2 010051   000001 036007                    ADLQ    1,DL
         2 010052   205550 756100                    STQ     DCB$+18,,AUTO
         2 010053   205550 631500                    EPPR1   DCB$+18,,AUTO
         2 010054   204531 451500                    STP1    @LEN,,AUTO
         2 010055   205547 633500                    EPPR3   DCB$+17,,AUTO
         2 010056   204530 453500                    STP3    @TOO,,AUTO
         2 010057   204524 634500                    EPPR4   FROM,,AUTO
         2 010060   204527 454500                    STP4    @FROM,,AUTO
         2 010061   007671 701000 2                  TSX1    MOVE
         2 010062   010111 702000 2                  TSX2    SZ_ALT

     2001    11827    6                       ALTRET(SZ_ALT);
     2002    11828    6                     IF JSP.RES_CNT>0

  11828  2 010063   204004 470500                    LDP0    REC$,,AUTO
         2 010064   000136 235100                    LDA     94,,PR0
         2 010065   010070 604400 2                  TMOZ    s:11830

     2003    11829    6                     THEN JSP.RESX = JSP.RESX+SIZEW(SUDO(0));
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:308  

  11829  2 010066   000005 236007                    LDQ     5,DL
         2 010067   000135 056100                    ASQ     93,,PR0

     2004    11830    6                     IF JSP.FORM_CNT>0

  11830  2 010070   000140 235100                    LDA     96,,PR0
         2 010071   010074 604400 2                  TMOZ    s:11833

     2005    11831    6                     THEN JSP.FORMX = JSP.FORMX + SIZEW(SUDO(0));

  11831  2 010072   000005 236007                    LDQ     5,DL
         2 010073   000137 056100                    ASQ     95,,PR0

     2006    11832    6                     END;

     2007    11833    5                IF JSP.SUDO_CNT=0

  11833  2 010074   000134 235100                    LDA     92,,PR0
         2 010075   010103 601000 2                  TNZ     s:11838

     2008    11834    6                THEN DO;

     2009    11835    6                     JSP.SUDOX = SIZEW(JSP);

  11835  2 010076   000141 236007                    LDQ     97,DL
         2 010077   000133 756100                    STQ     91,,PR0

     2010    11836    6                     SUDO$ = PINCRW(REC$,JSP.SUDOX);

  11836  2 010100   000022 736000                    QLS     18
         2 010101   204004 036100                    ADLQ    REC$,,AUTO
         2 010102   204507 756100                    STQ     SUDO$,,AUTO

     2011    11837    6                     END;

     2012    11838    5                JSP.SUDO_CNT = JSP.SUDO_CNT+1;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:309  

  11838  2 010103   000134 054100                    AOS     92,,PR0

     2013    11839    5                RECLEN = RECLEN + SIZEC(SUDO(0));

  11839  2 010104   000024 236007                    LDQ     20,DL
         2 010105   204006 056100                    ASQ     RECLEN,,AUTO

     2014    11840    5                IF RECLEN>4096

  11840  2 010106   204006 235100                    LDA     RECLEN,,AUTO
         2 010107   010000 115007                    CMPA    4096,DL
         2 010110   010122 604400 2                  TMOZ    s:11848

     2015    11841    6                THEN DO;

     2016    11842    6   SZ_ALT:           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_LD);

  11842  2 010111   000051 236000 3     SZ_ALT       LDQ     41
         2 010112   000001 235000 xsym               LDA     B_VECTNIL+1
         2 010113   205524 757100                    STAQ    @ERR+1,,AUTO
         2 010114   000005 236000 3                  LDQ     5
         2 010115   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 010116   011343 701000 2                  TSX1    POST_ERR
         2 010117   000000 011000                    NOP     0

     2017    11843        /*E*  ERROR: AZA-E$AZ_LD
     2018    11844            MESSAGE: Too much accounting information to fit in JSP record
     2019    11845        */
     2020    11846    6                     ALTRETURN;

  11846  2 010120   204520 221300                    LDX1  ! I+1,,AUTO
         2 010121   000000 702211                    TSX2  ! 0,X1

     2021    11847    6                     END;
     2022    11848    5                SUDO(I) = '0'B;            /* Clear it out first                 */

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:310  
  11848  2 010122   204522 236100                    LDQ     I,,AUTO
         2 010123   000024 402007                    MPY     20,DL
         2 010124   204507 471500                    LDP1    SUDO$,,AUTO
         2 010125   000106 100400                    MLR     fill='000'O
         2 010126   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 010127   100000 000024                    ADSC9   0,Q,PR1                  cn=0,n=20

     2023    11849    5                END;

     2024    11850    4           SUDO.NAM(I) = SUDO1.NAM(J);

  11850  2 010130   204522 236100                    LDQ     I,,AUTO
         2 010131   000005 402007                    MPY     5,DL
         2 010132   000000 620006                    EAX0    0,QL
         2 010133   204523 236100                    LDQ     J,,AUTO
         2 010134   000024 402007                    MPY     20,DL
         2 010135   000000 635010                    EAA     0,X0
         2 010136   000020 731000                    ARS     16
         2 010137   204510 470500                    LDP0    SUDO1$,,AUTO
         2 010140   204507 471500                    LDP1    SUDO$,,AUTO
         2 010141   040105 100506                    MLR     fill='040'O
         2 010142   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         2 010143   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8

     2025    11851    4           IF SUDO1.MAX(J)>SUDO.MAX(I)

  11851  2 010144   204523 236100                    LDQ     J,,AUTO
         2 010145   000005 402007                    MPY     5,DL
         2 010146   000002 236106                    LDQ     2,QL,PR0
         2 010147   000033 772000                    QRL     27
         2 010150   205530 756100                    STQ     DCB$+2,,AUTO
         2 010151   100002 236110                    LDQ     2,X0,PR1
         2 010152   000033 772000                    QRL     27
         2 010153   205530 116100                    CMPQ    DCB$+2,,AUTO
         2 010154   010163 605000 2                  TPL     s:11853

     2026    11852    4           THEN SUDO.MAX(I) = SUDO1.MAX(J);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:311  

  11852  2 010155   204523 236100                    LDQ     J,,AUTO
         2 010156   000005 402007                    MPY     5,DL
         2 010157   000002 236106                    LDQ     2,QL,PR0
         2 010160   100002 676110                    ERQ     2,X0,PR1
         2 010161   777000 376003                    ANQ     -512,DU
         2 010162   100002 656110                    ERSQ    2,X0,PR1

     2027    11853    4           SUDO.CPU(I) = SUDO.CPU(I) + MULT*SUDO1.CPU(J);

  11853  2 010163   204521 473500                    LDP3    @MULT,,AUTO
         2 010164   204523 236100                    LDQ     J,,AUTO
         2 010165   000005 402007                    MPY     5,DL
         2 010166   000003 236106                    LDQ     3,QL,PR0
         2 010167   300000 402100                    MPY     0,,PR3
         2 010170   100003 036110                    ADLQ    3,X0,PR1
         2 010171   100003 756110                    STQ     3,X0,PR1

     2028    11854    4           SUDO.CLOCK(I) = SUDO.CLOCK(I) + MULT*SUDO1.CLOCK(J);

  11854  2 010172   204523 236100                    LDQ     J,,AUTO
         2 010173   000005 402007                    MPY     5,DL
         2 010174   000004 236106                    LDQ     4,QL,PR0
         2 010175   300000 402100                    MPY     0,,PR3
         2 010176   100004 036110                    ADLQ    4,X0,PR1
         2 010177   100004 756110                    STQ     4,X0,PR1

     2029    11855    4           IF SUDO.CLOCK(I)=0

  11855  2 010200   010237 601000 2                  TNZ     s:11864

     2030    11856    5           THEN DO;                        /* Remove any un-used SUDO entry      */

     2031    11857    5                FROM = JSP.SUDOX + (I+1)*SIZEW(SUDO(0));

  11857  2 010201   204004 474500                    LDP4    REC$,,AUTO
         2 010202   204522 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:312  
         2 010203   000005 402007                    MPY     5,DL
         2 010204   400133 036100                    ADLQ    91,,PR4
         2 010205   000005 036007                    ADLQ    5,DL
         2 010206   204524 756100                    STQ     FROM,,AUTO

     2032    11858    5                CALL MOVE(FROM,FROM-SIZEW(SUDO(0)),RECLEN/4-FROM+1);

  11858  2 010207   204006 236100                    LDQ     RECLEN,,AUTO
         2 010210   000004 506007                    DIV     4,DL
         2 010211   204524 136100                    SBLQ    FROM,,AUTO
         2 010212   204524 235100                    LDA     FROM,,AUTO
         2 010213   000005 135007                    SBLA    5,DL
         2 010214   205551 755100                    STA     DCB$+19,,AUTO
         2 010215   000001 036007                    ADLQ    1,DL
         2 010216   205552 756100                    STQ     DCB$+20,,AUTO
         2 010217   205552 635500                    EPPR5   DCB$+20,,AUTO
         2 010220   204531 455500                    STP5    @LEN,,AUTO
         2 010221   205551 636500                    EPPR6   DCB$+19,,AUTO
         2 010222   204530 456500                    STP6    @TOO,,AUTO
         2 010223   204524 637500                    EPPR7   FROM,,AUTO
         2 010224   204527 457500                    STP7    @FROM,,AUTO
         2 010225   007671 701000 2                  TSX1    MOVE
         2 010226   000000 011000                    NOP     0

     2033    11859    5                RECLEN = RECLEN-SIZEC(SUDO(0));

  11859  2 010227   000024 336007                    LCQ     20,DL
         2 010230   204006 056100                    ASQ     RECLEN,,AUTO

     2034    11860    5                JSP.SUDO_CNT = JSP.SUDO_CNT-1;

  11860  2 010231   204004 470500                    LDP0    REC$,,AUTO
         2 010232   000001 336007                    LCQ     1,DL
         2 010233   000134 056100                    ASQ     92,,PR0

     2035    11861    5                JSP.RESX = JSP.RESX-SIZEW(SUDO(0));

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:313  
  11861  2 010234   000005 336007                    LCQ     5,DL
         2 010235   000135 056100                    ASQ     93,,PR0

     2036    11862    5                JSP.FORMX = JSP.FORMX-SIZEW(SUDO(0));

  11862  2 010236   000137 056100                    ASQ     95,,PR0

     2037    11863    5                END;

     2038    11864    4           END;

  11864  2 010237   204523 054100                    AOS     J,,AUTO
         2 010240   204005 470500                    LDP0    REC1$,,AUTO
         2 010241   204523 236100                    LDQ     J,,AUTO
         2 010242   000134 116100                    CMPQ    92,,PR0
         2 010243   007774 604000 2                  TMI     s:11812

     2039    11865    3      RETURN;

  11865  2 010244   204520 221300                    LDX1  ! I+1,,AUTO
         2 010245   000001 702211                    TSX2  ! 1,X1

     2040    11866    3   END SUDOS;
     2041    11867        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:314  
     2042    11868    2   RESOURCES: PROC(MULT) ALTRET;

  11868  2 010246   204520 741300       RESOURCES    STX1  ! I+1,,AUTO

     2043    11869        /*I* NAME: RESOURCES
     2044    11870             PURPOSE: To add or subtract the resource info in JSP1 to JSP
     2045    11871             CALL: CALL RESOURCES(MULT) ALTRET(LABEL);
     2046    11872                       where MULT is either 1 or -1 and determines whether the info
     2047    11873                             in JSP1 is to be added or subtracted from that in JSP
     2048    11874             DESCRIPTION: This procedure adds or subtracts the resource information
     2049    11875             found in the JSP1 record from that found in the JSP record. If REC
     2050    11876             overflows during the process, the procedure will ALTRETURN.
     2051    11877             If an un-used resource is found, it is removed from JSP thereby
     2052    11878             reducing the size of JSP.
     2053    11879        */
     2054    11880    3   DCL MULT SBIN WORD;
     2055    11881    3   DCL I SBIN WORD;
     2056    11882    3   DCL J SBIN WORD;
     2057    11883    3   DCL FROM SBIN WORD;
     2058    11884    3   DCL FOUND BIT(1) ALIGNED;
     2059    11885    3      RES$ = PINCRW(REC$,JSP.RESX);

  11885  2 010247   204004 470500                    LDP0    REC$,,AUTO
         2 010250   000135 236100                    LDQ     93,,PR0
         2 010251   000022 736000                    QLS     18
         2 010252   204004 036100                    ADLQ    REC$,,AUTO
         2 010253   204511 756100                    STQ     RES$,,AUTO

     2060    11886    3      RES1$ = PINCRW(REC1$,JSP1.RESX);

  11886  2 010254   204005 471500                    LDP1    REC1$,,AUTO
         2 010255   100135 236100                    LDQ     93,,PR1
         2 010256   000022 736000                    QLS     18
         2 010257   204005 036100                    ADLQ    REC1$,,AUTO
         2 010260   204512 756100                    STQ     RES1$,,AUTO

     2061    11887    4      DO J=0 TO JSP1.RES_CNT-1;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:315  

  11887  2 010261   204523 450100                    STZ     J,,AUTO
         2 010262   010546 710000 2                  TRA     s:11934+1

     2062    11888    4           I = 0;

  11888  2 010263   204522 450100                    STZ     I,,AUTO

     2063    11889    4           FOUND = '0'B;

  11889  2 010264   204525 450100                    STZ     FOUND,,AUTO

     2064    11890    5           DO WHILE(NOT FOUND AND I<JSP.RES_CNT);

  11890  2 010265   010331 710000 2                  TRA     s:11896

     2065    11891    5                IF RES.TYPE(I)=RES1.TYPE(J) AND RES.LOGNAME(I)=RES1.LOGNAME(J)

  11891  2 010266   204523 236100                    LDQ     J,,AUTO
         2 010267   000011 402007                    MPY     9,DL
         2 010270   204512 470500                    LDP0    RES1$,,AUTO
         2 010271   000000 620006                    EAX0    0,QL
         2 010272   204522 236100                    LDQ     I,,AUTO
         2 010273   000011 402007                    MPY     9,DL
         2 010274   204511 471500                    LDP1    RES$,,AUTO
         2 010275   100000 236106                    LDQ     0,QL,PR1
         2 010276   000000 116110                    CMPQ    0,X0,PR0
         2 010277   010330 601000 2                  TNZ     s:11895
         2 010300   204522 236100                    LDQ     I,,AUTO
         2 010301   000011 402007                    MPY     9,DL
         2 010302   100005 236106                    LDQ     5,QL,PR1
         2 010303   000005 116110                    CMPQ    5,X0,PR0
         2 010304   010330 601000 2                  TNZ     s:11895
         2 010305   204522 236100                    LDQ     I,,AUTO
         2 010306   000044 402007                    MPY     36,DL
         2 010307   205530 756100                    STQ     DCB$+2,,AUTO
         2 010310   204523 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:316  
         2 010311   000044 402007                    MPY     36,DL
         2 010312   205530 235100                    LDA     DCB$+2,,AUTO
         2 010313   040106 106505                    CMPC    fill='040'O
         2 010314   100003 000010                    ADSC9   3,A,PR1                  cn=0,n=8
         2 010315   000003 000010                    ADSC9   3,Q,PR0                  cn=0,n=8
         2 010316   010330 601000 2                  TNZ     s:11895
         2 010317   204522 236100                    LDQ     I,,AUTO
         2 010320   000011 402007                    MPY     9,DL
         2 010321   100010 236106                    LDQ     8,QL,PR1
         2 010322   000010 676110                    ERQ     8,X0,PR0
         2 010323   777777 376007                    ANQ     -1,DL
         2 010324   010330 601000 2                  TNZ     s:11895

     2066    11892    5                  AND RES.WSN(I)=RES1.WSN(J)
     2067    11893    5                  AND RES.ATTR.MTWO(I)=RES1.ATTR.MTWO(J)
     2068    11894    5                THEN FOUND = '1'B;

  11894  2 010325   400000 236003                    LDQ     -131072,DU
         2 010326   204525 756100                    STQ     FOUND,,AUTO
         2 010327   010331 710000 2                  TRA     s:11896

     2069    11895    5                ELSE I = I+1;

  11895  2 010330   204522 054100                    AOS     I,,AUTO

     2070    11896    5                END;

  11896  2 010331   204525 234100                    SZN     FOUND,,AUTO
         2 010332   010337 604000 2                  TMI     s:11897
         2 010333   204004 470500                    LDP0    REC$,,AUTO
         2 010334   204522 236100                    LDQ     I,,AUTO
         2 010335   000136 116100                    CMPQ    94,,PR0
         2 010336   010266 604000 2                  TMI     s:11891

     2071    11897    4           IF NOT FOUND

  11897  2 010337   204525 234100                    SZN     FOUND,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:317  
         2 010340   010451 604000 2                  TMI     s:11922

     2072    11898    5           THEN DO;                        /* Must add this entry                */

     2073    11899    5                IF JSP.FORM_CNT>0

  11899  2 010341   204004 470500                    LDP0    REC$,,AUTO
         2 010342   000140 235100                    LDA     96,,PR0
         2 010343   010370 604400 2                  TMOZ    s:11905

     2074    11900    6                THEN DO;

     2075    11901    6                     CALL MOVE(JSP.FORMX,JSP.FORMX+SIZEW(RES(0)),

  11901  2 010344   204006 236100                    LDQ     RECLEN,,AUTO
         2 010345   000004 506007                    DIV     4,DL
         2 010346   000137 136100                    SBLQ    95,,PR0
         2 010347   000137 235100                    LDA     95,,PR0
         2 010350   000011 035007                    ADLA    9,DL
         2 010351   205553 755100                    STA     DCB$+21,,AUTO
         2 010352   000001 036007                    ADLQ    1,DL
         2 010353   205554 756100                    STQ     DCB$+22,,AUTO
         2 010354   205554 631500                    EPPR1   DCB$+22,,AUTO
         2 010355   204531 451500                    STP1    @LEN,,AUTO
         2 010356   205553 633500                    EPPR3   DCB$+21,,AUTO
         2 010357   204530 453500                    STP3    @TOO,,AUTO
         2 010360   204004 236100                    LDQ     REC$,,AUTO
         2 010361   000137 036003                    ADLQ    95,DU
         2 010362   204527 756100                    STQ     @FROM,,AUTO
         2 010363   007671 701000 2                  TSX1    MOVE
         2 010364   010407 702000 2                  TSX2    SZ_ALT

     2076    11902    6                       RECLEN/4-JSP.FORMX+1) ALTRET(SZ_ALT);
     2077    11903    6                     JSP.FORMX = JSP.FORMX+SIZEW(RES(0));

  11903  2 010365   204004 470500                    LDP0    REC$,,AUTO
         2 010366   000011 236007                    LDQ     9,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:318  
         2 010367   000137 056100                    ASQ     95,,PR0

     2078    11904    6                     END;

     2079    11905    5                IF JSP.RES_CNT=0

  11905  2 010370   000136 235100                    LDA     94,,PR0
         2 010371   010401 601000 2                  TNZ     s:11910

     2080    11906    6                THEN DO;                   /* Must initialize for RES section    */

     2081    11907    6                     JSP.RESX = SIZEW(JSP)+JSP.SUDO_CNT*SIZEW(SUDO(0));

  11907  2 010372   000134 236100                    LDQ     92,,PR0
         2 010373   000005 402007                    MPY     5,DL
         2 010374   000141 036007                    ADLQ    97,DL
         2 010375   000135 756100                    STQ     93,,PR0

     2082    11908    6                     RES$ = PINCRW(REC$,JSP.RESX);

  11908  2 010376   000022 736000                    QLS     18
         2 010377   204004 036100                    ADLQ    REC$,,AUTO
         2 010400   204511 756100                    STQ     RES$,,AUTO

     2083    11909    6                     END;

     2084    11910    5                JSP.RES_CNT = JSP.RES_CNT+1;

  11910  2 010401   000136 054100                    AOS     94,,PR0

     2085    11911    5                RECLEN = RECLEN + SIZEC(RES(0));

  11911  2 010402   000044 236007                    LDQ     36,DL
         2 010403   204006 056100                    ASQ     RECLEN,,AUTO

     2086    11912    5                IF RECLEN>4096

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:319  
  11912  2 010404   204006 235100                    LDA     RECLEN,,AUTO
         2 010405   010000 115007                    CMPA    4096,DL
         2 010406   010420 604400 2                  TMOZ    s:11917

     2087    11913    6                THEN DO;

     2088    11914    6   SZ_ALT:           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_LD);

  11914  2 010407   000051 236000 3     SZ_ALT       LDQ     41
         2 010410   000001 235000 xsym               LDA     B_VECTNIL+1
         2 010411   205524 757100                    STAQ    @ERR+1,,AUTO
         2 010412   000005 236000 3                  LDQ     5
         2 010413   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 010414   011343 701000 2                  TSX1    POST_ERR
         2 010415   000000 011000                    NOP     0

     2089    11915    6                     ALTRETURN;

  11915  2 010416   204520 221300                    LDX1  ! I+1,,AUTO
         2 010417   000000 702211                    TSX2  ! 0,X1

     2090    11916    6                     END;
     2091    11917    5                RES(I) = '0'B;             /* Clear it out first                 */

  11917  2 010420   204522 236100                    LDQ     I,,AUTO
         2 010421   000044 402007                    MPY     36,DL
         2 010422   204511 471500                    LDP1    RES$,,AUTO
         2 010423   000106 100400                    MLR     fill='000'O
         2 010424   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 010425   100000 000044                    ADSC9   0,Q,PR1                  cn=0,n=36

     2092    11918    5                RES.TYPE(I) = RES1.TYPE(J);

  11918  2 010426   204522 236100                    LDQ     I,,AUTO
         2 010427   000011 402007                    MPY     9,DL
         2 010430   000000 620006                    EAX0    0,QL
         2 010431   204523 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:320  
         2 010432   000011 402007                    MPY     9,DL
         2 010433   204512 473500                    LDP3    RES1$,,AUTO
         2 010434   300000 235106                    LDA     0,QL,PR3
         2 010435   100000 755110                    STA     0,X0,PR1

     2093    11919    5                RES.WSN(I) = RES1.WSN(J);

  11919  2 010436   204523 236100                    LDQ     J,,AUTO
         2 010437   000044 402007                    MPY     36,DL
         2 010440   000000 635010                    EAA     0,X0
         2 010441   000020 731000                    ARS     16
         2 010442   040105 100506                    MLR     fill='040'O
         2 010443   300003 000010                    ADSC9   3,Q,PR3                  cn=0,n=8
         2 010444   100003 000010                    ADSC9   3,A,PR1                  cn=0,n=8

     2094    11920    5                RES.LOGNAME(I) = RES1.LOGNAME(J);

  11920  2 010445   204523 236100                    LDQ     J,,AUTO
         2 010446   000011 402007                    MPY     9,DL
         2 010447   300005 236106                    LDQ     5,QL,PR3
         2 010450   100005 756110                    STQ     5,X0,PR1

     2095    11921    5                END;

     2096    11922    4           RES.PHYSNAME(I) = RES1.PHYSNAME(J);

  11922  2 010451   204522 236100                    LDQ     I,,AUTO
         2 010452   000011 402007                    MPY     9,DL
         2 010453   000000 620006                    EAX0    0,QL
         2 010454   204523 236100                    LDQ     J,,AUTO
         2 010455   000044 402007                    MPY     36,DL
         2 010456   000000 635010                    EAA     0,X0
         2 010457   000020 731000                    ARS     16
         2 010460   204512 470500                    LDP0    RES1$,,AUTO
         2 010461   204511 471500                    LDP1    RES$,,AUTO
         2 010462   040105 100506                    MLR     fill='040'O
         2 010463   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:321  
         2 010464   100006 000010                    ADSC9   6,A,PR1                  cn=0,n=8

     2097    11923    4           RES.ATTR(I) = RES1.ATTR(J);

  11923  2 010465   204523 236100                    LDQ     J,,AUTO
         2 010466   000011 402007                    MPY     9,DL
         2 010467   000010 236106                    LDQ     8,QL,PR0
         2 010470   100010 756110                    STQ     8,X0,PR1

     2098    11924    4           RES.CLOCK(I) = RES.CLOCK(I) + MULT*RES1.CLOCK(J);

  11924  2 010471   204521 473500                    LDP3    @MULT,,AUTO
         2 010472   204523 236100                    LDQ     J,,AUTO
         2 010473   000011 402007                    MPY     9,DL
         2 010474   000001 236106                    LDQ     1,QL,PR0
         2 010475   300000 402100                    MPY     0,,PR3
         2 010476   100001 036110                    ADLQ    1,X0,PR1
         2 010477   100001 756110                    STQ     1,X0,PR1

     2099    11925    4           RES.CPU(I) = RES.CPU(I) + MULT*RES1.CPU(J);

  11925  2 010500   204523 236100                    LDQ     J,,AUTO
         2 010501   000011 402007                    MPY     9,DL
         2 010502   000002 236106                    LDQ     2,QL,PR0
         2 010503   300000 402100                    MPY     0,,PR3
         2 010504   100002 036110                    ADLQ    2,X0,PR1
         2 010505   100002 756110                    STQ     2,X0,PR1

     2100    11926    4           IF RES.CLOCK(I)=0

  11926  2 010506   100001 235110                    LDA     1,X0,PR1
         2 010507   010545 601000 2                  TNZ     s:11934

     2101    11927    5           THEN DO;                        /* Remove any un-used RES entry       */

     2102    11928    5                FROM = JSP.RESX + (I+1)*SIZEW(RES(0));

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:322  
  11928  2 010510   204004 474500                    LDP4    REC$,,AUTO
         2 010511   204522 236100                    LDQ     I,,AUTO
         2 010512   000011 402007                    MPY     9,DL
         2 010513   400135 036100                    ADLQ    93,,PR4
         2 010514   000011 036007                    ADLQ    9,DL
         2 010515   204524 756100                    STQ     FROM,,AUTO

     2103    11929    5                CALL MOVE(FROM,FROM-SIZEW(RES(0)),RECLEN/4-FROM+1);

  11929  2 010516   204006 236100                    LDQ     RECLEN,,AUTO
         2 010517   000004 506007                    DIV     4,DL
         2 010520   204524 136100                    SBLQ    FROM,,AUTO
         2 010521   204524 235100                    LDA     FROM,,AUTO
         2 010522   000011 135007                    SBLA    9,DL
         2 010523   205555 755100                    STA     DCB$+23,,AUTO
         2 010524   000001 036007                    ADLQ    1,DL
         2 010525   205556 756100                    STQ     DCB$+24,,AUTO
         2 010526   205556 635500                    EPPR5   DCB$+24,,AUTO
         2 010527   204531 455500                    STP5    @LEN,,AUTO
         2 010530   205555 636500                    EPPR6   DCB$+23,,AUTO
         2 010531   204530 456500                    STP6    @TOO,,AUTO
         2 010532   204524 637500                    EPPR7   FROM,,AUTO
         2 010533   204527 457500                    STP7    @FROM,,AUTO
         2 010534   007671 701000 2                  TSX1    MOVE
         2 010535   000000 011000                    NOP     0

     2104    11930    5                RECLEN = RECLEN-SIZEC(RES(0));

  11930  2 010536   000044 336007                    LCQ     36,DL
         2 010537   204006 056100                    ASQ     RECLEN,,AUTO

     2105    11931    5                JSP.RES_CNT = JSP.RES_CNT-1;

  11931  2 010540   204004 470500                    LDP0    REC$,,AUTO
         2 010541   000001 336007                    LCQ     1,DL
         2 010542   000136 056100                    ASQ     94,,PR0

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:323  
     2106    11932    5                JSP.FORMX = JSP.FORMX-SIZEW(RES(0));

  11932  2 010543   000011 336007                    LCQ     9,DL
         2 010544   000137 056100                    ASQ     95,,PR0

     2107    11933    5                END;

     2108    11934    4           END;

  11934  2 010545   204523 054100                    AOS     J,,AUTO
         2 010546   204005 470500                    LDP0    REC1$,,AUTO
         2 010547   204523 236100                    LDQ     J,,AUTO
         2 010550   000136 116100                    CMPQ    94,,PR0
         2 010551   010263 604000 2                  TMI     s:11888

     2109    11935    3      RETURN;

  11935  2 010552   204520 221300                    LDX1  ! I+1,,AUTO
         2 010553   000001 702211                    TSX2  ! 1,X1

     2110    11936    3   END RESOURCES;
     2111    11937        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:324  
     2112    11938    2   FORMS: PROC(MULT) ALTRET;

  11938  2 010554   204520 741300       FORMS        STX1  ! I+1,,AUTO

     2113    11939        /*I* NAME: FORMS
     2114    11940             PURPOSE: To add or subtract the forms info in JSP1 to JSP
     2115    11941             CALL: CALL FORMS(MULT) ALTRET(LABEL);
     2116    11942                       where MULT is either 1 or -1 and determines whether the info
     2117    11943                             in JSP1 is to be added or subtracted from that in JSP
     2118    11944             DESCRIPTION: This procedure adds or subtracts the forms information
     2119    11945             found in the JSP1 record from that found in the JSP record. If REC
     2120    11946             overflows during the process, the procedure will ALTRETURN.
     2121    11947             If an un-used form is found, it is removed from JSP thereby
     2122    11948             reducing the size of JSP.
     2123    11949        */
     2124    11950    3   DCL MULT SBIN WORD;
     2125    11951    3   DCL I SBIN WORD;
     2126    11952    3   DCL J SBIN WORD;
     2127    11953    3   DCL FROM SBIN WORD;
     2128    11954    3   DCL FOUND BIT(1) ALIGNED;
     2129    11955    3      FORM$ = PINCRW(REC$,JSP.FORMX);

  11955  2 010555   204004 470500                    LDP0    REC$,,AUTO
         2 010556   000137 236100                    LDQ     95,,PR0
         2 010557   000022 736000                    QLS     18
         2 010560   204004 036100                    ADLQ    REC$,,AUTO
         2 010561   204513 756100                    STQ     FORM$,,AUTO

     2130    11956    3      FORM1$ = PINCRW(REC1$,JSP1.FORMX);

  11956  2 010562   204005 471500                    LDP1    REC1$,,AUTO
         2 010563   100137 236100                    LDQ     95,,PR1
         2 010564   000022 736000                    QLS     18
         2 010565   204005 036100                    ADLQ    REC1$,,AUTO
         2 010566   204514 756100                    STQ     FORM1$,,AUTO

     2131    11957    4      DO J=0 TO JSP1.FORM_CNT-1;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:325  

  11957  2 010567   204523 450100                    STZ     J,,AUTO
         2 010570   010763 710000 2                  TRA     s:11992+1

     2132    11958    4           I = 0;

  11958  2 010571   204522 450100                    STZ     I,,AUTO

     2133    11959    4           FOUND = '0'B;

  11959  2 010572   204525 450100                    STZ     FOUND,,AUTO

     2134    11960    5           DO WHILE(NOT FOUND AND I<JSP.FORM_CNT);

  11960  2 010573   010614 710000 2                  TRA     s:11964

     2135    11961    5                IF FORM.S1(I)=FORM1.S1(J)

  11961  2 010574   204522 236100                    LDQ     I,,AUTO
         2 010575   000064 402007                    MPY     52,DL
         2 010576   205530 756100                    STQ     DCB$+2,,AUTO
         2 010577   204523 236100                    LDQ     J,,AUTO
         2 010600   000064 402007                    MPY     52,DL
         2 010601   204513 470500                    LDP0    FORM$,,AUTO
         2 010602   205530 235100                    LDA     DCB$+2,,AUTO
         2 010603   204514 471500                    LDP1    FORM1$,,AUTO
         2 010604   000106 106505                    CMPC    fill='000'O
         2 010605   000002 000026                    ADSC9   2,A,PR0                  cn=0,n=22
         2 010606   100002 000026                    ADSC9   2,Q,PR1                  cn=0,n=22
         2 010607   010613 601000 2                  TNZ     s:11963

     2136    11962    5                THEN FOUND = '1'B;

  11962  2 010610   400000 236003                    LDQ     -131072,DU
         2 010611   204525 756100                    STQ     FOUND,,AUTO
         2 010612   010614 710000 2                  TRA     s:11964

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:326  
     2137    11963    5                ELSE I = I+1;

  11963  2 010613   204522 054100                    AOS     I,,AUTO

     2138    11964    5                END;

  11964  2 010614   204525 234100                    SZN     FOUND,,AUTO
         2 010615   010622 604000 2                  TMI     s:11965
         2 010616   204004 470500                    LDP0    REC$,,AUTO
         2 010617   204522 236100                    LDQ     I,,AUTO
         2 010620   000140 116100                    CMPQ    96,,PR0
         2 010621   010574 604000 2                  TMI     s:11961

     2139    11965    4           IF NOT FOUND

  11965  2 010622   204525 234100                    SZN     FOUND,,AUTO
         2 010623   010701 604000 2                  TMI     s:11983

     2140    11966    5           THEN DO;                        /* Must add this entry                */

     2141    11967    5                IF JSP.FORM_CNT=0

  11967  2 010624   204004 470500                    LDP0    REC$,,AUTO
         2 010625   000140 235100                    LDA     96,,PR0
         2 010626   010642 601000 2                  TNZ     s:11973

     2142    11968    6                THEN DO;                   /* Must initialize for FORM section   */

     2143    11969    6                     JSP.FORMX = SIZEW(JSP)+JSP.SUDO_CNT*SIZEW(SUDO(0))

  11969  2 010627   000136 236100                    LDQ     94,,PR0
         2 010630   000011 402007                    MPY     9,DL
         2 010631   205530 756100                    STQ     DCB$+2,,AUTO
         2 010632   000134 236100                    LDQ     92,,PR0
         2 010633   000005 402007                    MPY     5,DL
         2 010634   205530 036100                    ADLQ    DCB$+2,,AUTO
         2 010635   000141 036007                    ADLQ    97,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:327  
         2 010636   000137 756100                    STQ     95,,PR0

     2144    11970    6                       +JSP.RES_CNT*SIZEW(RES(0));
     2145    11971    6                     FORM$ = PINCRW(REC$,JSP.FORMX);

  11971  2 010637   000022 736000                    QLS     18
         2 010640   204004 036100                    ADLQ    REC$,,AUTO
         2 010641   204513 756100                    STQ     FORM$,,AUTO

     2146    11972    6                     END;

     2147    11973    5                JSP.FORM_CNT = JSP.FORM_CNT+1;

  11973  2 010642   000140 054100                    AOS     96,,PR0

     2148    11974    5                RECLEN = RECLEN + SIZEC(FORM(0));

  11974  2 010643   000064 236007                    LDQ     52,DL
         2 010644   204006 056100                    ASQ     RECLEN,,AUTO

     2149    11975    5                IF RECLEN>4096

  11975  2 010645   204006 235100                    LDA     RECLEN,,AUTO
         2 010646   010000 115007                    CMPA    4096,DL
         2 010647   010661 604400 2                  TMOZ    s:11980

     2150    11976    6                THEN DO;

     2151    11977    6   SZ_ALT:           CALL POST_ERR(%AZ$LOGOFFERR,,%E$AZ_LD);

  11977  2 010650   000051 236000 3     SZ_ALT       LDQ     41
         2 010651   000001 235000 xsym               LDA     B_VECTNIL+1
         2 010652   205524 757100                    STAQ    @ERR+1,,AUTO
         2 010653   000005 236000 3                  LDQ     5
         2 010654   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 010655   011343 701000 2                  TSX1    POST_ERR
         2 010656   000000 011000                    NOP     0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:328  

     2152    11978    6                     ALTRETURN;

  11978  2 010657   204520 221300                    LDX1  ! I+1,,AUTO
         2 010660   000000 702211                    TSX2  ! 0,X1

     2153    11979    6                     END;
     2154    11980    5                FORM(I) = '0'B;            /* Clear it out first                 */

  11980  2 010661   204522 236100                    LDQ     I,,AUTO
         2 010662   000064 402007                    MPY     52,DL
         2 010663   204513 471500                    LDP1    FORM$,,AUTO
         2 010664   000106 100400                    MLR     fill='000'O
         2 010665   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 010666   100000 000061                    ADSC9   0,Q,PR1                  cn=0,n=49

     2155    11981    5                FORM.S1(I) = FORM1.S1(J);

  11981  2 010667   204523 236100                    LDQ     J,,AUTO
         2 010670   000064 402007                    MPY     52,DL
         2 010671   205530 756100                    STQ     DCB$+2,,AUTO
         2 010672   204522 236100                    LDQ     I,,AUTO
         2 010673   000064 402007                    MPY     52,DL
         2 010674   204514 473500                    LDP3    FORM1$,,AUTO
         2 010675   205530 235100                    LDA     DCB$+2,,AUTO
         2 010676   000106 100505                    MLR     fill='000'O
         2 010677   300002 000026                    ADSC9   2,A,PR3                  cn=0,n=22
         2 010700   100002 000026                    ADSC9   2,Q,PR1                  cn=0,n=22

     2156    11982    5                END;

     2157    11983    4           FORM.FORMS(I) = FORM.FORMS(I) + MULT*FORM1.FORMS(J);

  11983  2 010701   204522 236100                    LDQ     I,,AUTO
         2 010702   000015 402007                    MPY     13,DL
         2 010703   204521 470500                    LDP0    @MULT,,AUTO
         2 010704   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:329  
         2 010705   204523 236100                    LDQ     J,,AUTO
         2 010706   000015 402007                    MPY     13,DL
         2 010707   204514 471500                    LDP1    FORM1$,,AUTO
         2 010710   100000 236106                    LDQ     0,QL,PR1
         2 010711   000000 402100                    MPY     0,,PR0
         2 010712   204513 473500                    LDP3    FORM$,,AUTO
         2 010713   300000 036110                    ADLQ    0,X0,PR3
         2 010714   300000 756110                    STQ     0,X0,PR3

     2158    11984    4           FORM.MOUNTS(I) = FORM.MOUNTS(I) + MULT*FORM1.MOUNTS(J);

  11984  2 010715   204523 236100                    LDQ     J,,AUTO
         2 010716   000015 402007                    MPY     13,DL
         2 010717   100001 236106                    LDQ     1,QL,PR1
         2 010720   000000 402100                    MPY     0,,PR0
         2 010721   300001 036110                    ADLQ    1,X0,PR3
         2 010722   300001 756110                    STQ     1,X0,PR3

     2159    11985    4           IF FORM.FORMS(I)=0 AND FORM.MOUNTS(I)=0

  11985  2 010723   300000 235110                    LDA     0,X0,PR3
         2 010724   010762 601000 2                  TNZ     s:11992
         2 010725   000000 116003                    CMPQ    0,DU
         2 010726   010762 601000 2                  TNZ     s:11992

     2160    11986    5           THEN DO;                        /* Remove any un-used FORM entry      */

     2161    11987    5                FROM = JSP.FORMX + (I+1)*SIZEW(FORM(0));

  11987  2 010727   204004 474500                    LDP4    REC$,,AUTO
         2 010730   204522 236100                    LDQ     I,,AUTO
         2 010731   000015 402007                    MPY     13,DL
         2 010732   400137 036100                    ADLQ    95,,PR4
         2 010733   000015 036007                    ADLQ    13,DL
         2 010734   204524 756100                    STQ     FROM,,AUTO

     2162    11988    5                CALL MOVE(FROM,FROM-SIZEW(FORM(0)),RECLEN/4-FROM+1);
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:330  

  11988  2 010735   204006 236100                    LDQ     RECLEN,,AUTO
         2 010736   000004 506007                    DIV     4,DL
         2 010737   204524 136100                    SBLQ    FROM,,AUTO
         2 010740   204524 235100                    LDA     FROM,,AUTO
         2 010741   000015 135007                    SBLA    13,DL
         2 010742   205557 755100                    STA     DCB$+25,,AUTO
         2 010743   000001 036007                    ADLQ    1,DL
         2 010744   205560 756100                    STQ     DCB$+26,,AUTO
         2 010745   205560 635500                    EPPR5   DCB$+26,,AUTO
         2 010746   204531 455500                    STP5    @LEN,,AUTO
         2 010747   205557 636500                    EPPR6   DCB$+25,,AUTO
         2 010750   204530 456500                    STP6    @TOO,,AUTO
         2 010751   204524 637500                    EPPR7   FROM,,AUTO
         2 010752   204527 457500                    STP7    @FROM,,AUTO
         2 010753   007671 701000 2                  TSX1    MOVE
         2 010754   000000 011000                    NOP     0

     2163    11989    5                RECLEN = RECLEN-SIZEC(FORM(0));

  11989  2 010755   000064 336007                    LCQ     52,DL
         2 010756   204006 056100                    ASQ     RECLEN,,AUTO

     2164    11990    5                JSP.FORM_CNT = JSP.FORM_CNT-1;

  11990  2 010757   204004 470500                    LDP0    REC$,,AUTO
         2 010760   000001 336007                    LCQ     1,DL
         2 010761   000140 056100                    ASQ     96,,PR0

     2165    11991    5                END;

     2166    11992    4           END;

  11992  2 010762   204523 054100                    AOS     J,,AUTO
         2 010763   204005 470500                    LDP0    REC1$,,AUTO
         2 010764   204523 236100                    LDQ     J,,AUTO
         2 010765   000140 116100                    CMPQ    96,,PR0
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:331  
         2 010766   010571 604000 2                  TMI     s:11958

     2167    11993    3      RETURN;

  11993  2 010767   204520 221300                    LDX1  ! I+1,,AUTO
         2 010770   000001 702211                    TSX2  ! 1,X1

     2168    11994    3   END FORMS;
     2169    11995    2   END FILL_REC;
     2170    11996        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:332  
     2171    11997    1   UP_USERS: PROC;

  11997  2 010771   204502 741300       UP_USERS     STX1  ! WR_SECLOG+8,,AUTO

     2172    11998        /*I* NAME: UP_USERS
     2173    11999             PURPOSE: To update :USERS file with charge information for this job
     2174    12000        */
     2175    12001        %AS_USERS(STR_NAME = AS_USERS,STCLASS = AUTO);
     2176    12179    2   DCL FIRST BIT(1) ALIGNED;
     2177    12180    2      FPT_READ.V.KEYS# = %YES#;

  12180  2 010772   200000 236007                    LDQ     65536,DL
         2 010773   204342 256100                    ORSQ    FPT_READ+8,,AUTO

     2178    12181    2      FPT_READ.BUF_ = VECTOR(AS_USERS);

  12181  2 010774   000143 235000 3                  LDA     99
         2 010775   205530 452500                    STP2    DCB$+2,,AUTO
         2 010776   205530 236100                    LDQ     DCB$+2,,AUTO
         2 010777   004503 036003                    ADLQ    2371,DU
         2 011000   204336 757100                    STAQ    FPT_READ+4,,AUTO

     2179    12182    2      IN_KEY.LEN = 20;

  12182  2 011001   024000 236003                    LDQ     10240,DU
         2 011002   204117 552140                    STBQ    IN_KEY,'40'O,AUTO

     2180    12183    2      CALL CONCAT(IN_KEY.KEY,JSP.ACCN,JSP.UNAME);

  12183  2 011003   204004 470500                    LDP0    REC$,,AUTO
         2 011004   040100 100500                    MLR     fill='040'O
         2 011005   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 011006   204117 200010                    ADSC9   IN_KEY,,AUTO             cn=1,n=8
         2 011007   040100 100500                    MLR     fill='040'O
         2 011010   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 011011   204121 200033                    ADSC9   IN_KEY+2,,AUTO           cn=1,n=27

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:333  
     2181    12184    3      DO WHILE(SUBSTR(IN_KEY.KEY,IN_KEY.LEN-1,1)=' ');

  12184  2 011012   011016 710000 2                  TRA     s:12186

     2182    12185    3           IN_KEY.LEN = IN_KEY.LEN-1;

  12185  2 011013   204117 236100                    LDQ     IN_KEY,,AUTO
         2 011014   777000 036003                    ADLQ    -512,DU
         2 011015   204117 552140                    STBQ    IN_KEY,'40'O,AUTO

     2183    12186    3           END;

  12186  2 011016   204117 236100                    LDQ     IN_KEY,,AUTO
         2 011017   000033 772000                    QRL     27
         2 011020   040000 106506                    CMPC    fill='040'O
         2 011021   204117 000001                    ADSC9   IN_KEY,Q,AUTO            cn=0,n=1
         2 011022   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011023   011013 600000 2                  TZE     s:12185

     2184    12187    2      CALL OPEN_FILE(F_USERS) ALTRET(ALTL1);

  12187  2 011024   000005 236000 3                  LDQ     5
         2 011025   205511 756100                    STQ     @FILNUM,,AUTO
         2 011026   001552 701000 2                  TSX1    OPEN_FILE
         2 011027   011145 702000 2                  TSX2    ALTL1

     2185    12188    2      FIRST = '1'B;

  12188  2 011030   400000 236003                    LDQ     -131072,DU
         2 011031   205507 756100                    STQ     FIRST,,AUTO

     2186    12189    3      DO WHILE(IN_KEY.LEN>8);              /* MACCT DEFAULT = 'NONE'             */

  12189  2 011032   204117 236100                    LDQ     IN_KEY,,AUTO
         2 011033   777000 376003                    ANQ     -512,DU
         2 011034   011000 116003                    CMPQ    4608,DU
         2 011035   011132 602000 2                  TNC     s:12209
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:334  

     2187    12190    3           CALL M$ENQ(FPT_ENQ) ALTRET(ALTL1);

  12190  2 011036   204170 630500                    EPPR0   FPT_ENQ,,AUTO
         2 011037   420002 713400                    CLIMB   alt,+8194
         2 011040   401000 401760                    pmme    nvectors=3
         2 011041   011145 702000 2                  TSX2    ALTL1

     2188    12191    3           CALL M$READ(FPT_READ) ALTRET(ALTL);

  12191  2 011042   204332 630500                    EPPR0   FPT_READ,,AUTO
         2 011043   440000 713400                    CLIMB   alt,read
         2 011044   401400 401760                    pmme    nvectors=4
         2 011045   011133 702000 2                  TSX2    ALTL

     2189    12192    3           IF FIRST

  12192  2 011046   205507 234100                    SZN     FIRST,,AUTO
         2 011047   011064 605000 2                  TPL     s:12199

     2190    12193    4           THEN DO;

     2191    12194    4                IF AS_USERS.BUDGET.ICHARGES

  12194  2 011050   204522 236100                    LDQ     I,,AUTO
         2 011051   000040 316003                    CANQ    32,DU
         2 011052   011057 600000 2                  TZE     s:12196

     2192    12195    4                THEN AS_USERS.BUDGET.ACCUM = AS_USERS.BUDGET.ACCUM+JSP.CHG;

  12195  2 011053   204004 470500                    LDP0    REC$,,AUTO
         2 011054   204512 236100                    LDQ     RES1$,,AUTO
         2 011055   000065 036100                    ADLQ    53,,PR0
         2 011056   204512 756100                    STQ     RES1$,,AUTO

     2193    12196    4                AS_USERS.LAST_LOGON_TIME = BINBIT (B$JIT.LOGONTIME,36);

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:335  
  12196  2 011057   204007 470500                    LDP0    JIT$,,AUTO
         2 011060   000150 236100                    LDQ     104,,PR0
         2 011061   205465 756100                    STQ     I+152,,AUTO

     2194    12197    4                FIRST = '0'B;

  12197  2 011062   205507 450100                    STZ     FIRST,,AUTO

     2195    12198    4                END;

  12198  2 011063   011070 710000 2                  TRA     s:12200

     2196    12199    3           ELSE AS_USERS.BUDGET.PACCUM = AS_USERS.BUDGET.PACCUM+JSP.CHG;

  12199  2 011064   204004 470500                    LDP0    REC$,,AUTO
         2 011065   204514 236100                    LDQ     FORM1$,,AUTO
         2 011066   000065 036100                    ADLQ    53,,PR0
         2 011067   204514 756100                    STQ     FORM1$,,AUTO

     2197    12200    3           FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;

  12200  2 011070   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 011071   000002 220100                    LDX0    2,,PR0
         2 011072   204360 740100                    STX0    FPT_WRITE+8,,AUTO

     2198    12201    3           FPT_WRITE.KEY_ = VECTOR(IN_KEY);

  12201  2 011073   000030 235000 3                  LDA     24
         2 011074   205530 452500                    STP2    DCB$+2,,AUTO
         2 011075   205530 236100                    LDQ     DCB$+2,,AUTO
         2 011076   004117 036003                    ADLQ    2127,DU
         2 011077   204352 757100                    STAQ    FPT_WRITE+2,,AUTO

     2199    12202    3           FPT_WRITE.BUF_ = VECTOR(AS_USERS);

  12202  2 011100   000143 235000 3                  LDA     99
         2 011101   205530 452500                    STP2    DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:336  
         2 011102   205530 236100                    LDQ     DCB$+2,,AUTO
         2 011103   004503 036003                    ADLQ    2371,DU
         2 011104   204354 757100                    STAQ    FPT_WRITE+4,,AUTO

     2200    12203    3           CALL M$WRITE(FPT_WRITE) ALTRET(ALTL);

  12203  2 011105   204350 630500                    EPPR0   FPT_WRITE,,AUTO
         2 011106   440001 713400                    CLIMB   alt,write
         2 011107   401400 401760                    pmme    nvectors=4
         2 011110   011133 702000 2                  TSX2    ALTL

     2201    12204    3           CALL M$DEQ(FPT_DEQ) ALTRET(ALTL1);

  12204  2 011111   204202 630500                    EPPR0   FPT_DEQ,,AUTO
         2 011112   420003 713400                    CLIMB   alt,+8195
         2 011113   401000 401760                    pmme    nvectors=3
         2 011114   011145 702000 2                  TSX2    ALTL1

     2202    12205    3           IF AS_USERS.BUDGET.PCHARGES

  12205  2 011115   204522 236100                    LDQ     I,,AUTO
         2 011116   000100 316003                    CANQ    64,DU
         2 011117   011124 600000 2                  TZE     s:12207

     2203    12206    3           THEN IN_KEY = AS_USERS.BUDGET.MACCT;

  12206  2 011120   000100 100500                    MLR     fill='000'O
         2 011121   204515 000025                    ADSC9   XSJ_JOBINFO+1,,AUTO      cn=0,n=21
         2 011122   204117 000044                    ADSC9   IN_KEY,,AUTO             cn=0,n=36
         2 011123   011126 710000 2                  TRA     s:12208

     2204    12207    3           ELSE IN_KEY.LEN = 0;

  12207  2 011124   000000 236003                    LDQ     0,DU
         2 011125   204117 552140                    STBQ    IN_KEY,'40'O,AUTO

     2205    12208    3           END;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:337  

  12208  2 011126   204117 236100                    LDQ     IN_KEY,,AUTO
         2 011127   777000 376003                    ANQ     -512,DU
         2 011130   011000 116003                    CMPQ    4608,DU
         2 011131   011036 603000 2                  TRC     s:12190

     2206    12209    3      DO WHILE('0'B);

  12209  2 011132   011156 710000 2                  TRA     s:12215

     2207    12210    3   ALTL:   CALL M$DEQ(FPT_DEQ) ALTRET(ALTL1);

  12210  2 011133   204202 630500       ALTL         EPPR0   FPT_DEQ,,AUTO
         2 011134   420003 713400                    CLIMB   alt,+8195
         2 011135   401000 401760                    pmme    nvectors=3
         2 011136   011145 702000 2                  TSX2    ALTL1

     2208    12211    3           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$NOKEY

  12211  2 011137   000000 470400 xsym               LDP0    B$TCB$
         2 011140   000000 471500                    LDP1    0,,PR0
         2 011141   100102 236100                    LDQ     66,,PR1
         2 011142   377770 376007                    ANQ     131064,DL
         2 011143   001020 116007                    CMPQ    528,DL
         2 011144   011156 600000 2                  TZE     s:12215

     2209    12212    3           THEN
     2210    12213    3   ALTL1:       CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

  12213  2 011145   000001 236000 xsym  ALTL1        LDQ     B_VECTNIL+1
         2 011146   205525 756100                    STQ     @DCB#+1,,AUTO
         2 011147   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 011150   000002 036003                    ADLQ    2,DU
         2 011151   205524 756100                    STQ     @ERR+1,,AUTO
         2 011152   000005 236000 3                  LDQ     5
         2 011153   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 011154   011343 701000 2                  TSX1    POST_ERR
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:338  
         2 011155   000000 011000                    NOP     0

     2211    12214    3           END;

     2212    12215    2      RETURN;

  12215  2 011156   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 011157   000001 702211                    TSX2  ! 1,X1

     2213    12216    2   END UP_USERS;
     2214    12217        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:339  
     2215    12218    1   WR_JOBSTATS: PROC;

  12218  2 011160   204502 741300       WR_JOBSTATS  STX1  ! WR_SECLOG+8,,AUTO

     2216    12219        %XSJ_PARAM(FPTN = XSJ_PARAMC,STCLASS = CONSTANT,
     2217    12220                TYPE = %TYP_INFO#);
     2218    12237        %XSJ_PARAM(FPTN = XSJ_PARAM,STCLASS = AUTO);
     2219    12254        %XSJ_JOBINFO(FPTN = XSJ_JOBINFO,STCLASS = AUTO);
     2220    12269    2      CALL OPEN_FILE(F_JOBSTATS) ALTRET(NO_JOBSTATS);

  12269  2 011161   000037 236000 3                  LDQ     31
         2 011162   205511 756100                    STQ     @FILNUM,,AUTO
         2 011163   001552 701000 2                  TSX1    OPEN_FILE
         2 011164   011246 702000 2                  TSX2    NO_JOBSTATS

     2221    12270    2      XSJ_PARAM = XSJ_PARAMC;

  12270  2 011165   000100 100400                    MLR     fill='000'O
         2 011166   001744 000040 1                  ADSC9   XSJ_PARAMC               cn=0,n=32
         2 011167   204504 000040                    ADSC9   XSJ_PARAM,,AUTO          cn=0,n=32

     2222    12271    2      XSJ_PARAM.DCB# = LOGOFF_PARAM.DCB1;

  12271  2 011170   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 011171   000002 220100                    LDX0    2,,PR0
         2 011172   204511 740100                    STX0    RES$,,AUTO

     2223    12272    2      XSJ_PARAM.SYSID# = JSP.SYSID;

  12272  2 011173   204004 471500                    LDP1    REC$,,AUTO
         2 011174   100036 721100                    LXL1    30,,PR1
         2 011175   204510 441100                    SXL1    SUDO1$,,AUTO

     2224    12273    2      XSJ_PARAM.BUF_ = VECTOR(XSJ_JOBINFO);

  12273  2 011176   000144 235000 3                  LDA     100
         2 011177   205530 452500                    STP2    DCB$+2,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:340  
         2 011200   205530 236100                    LDQ     DCB$+2,,AUTO
         2 011201   004514 036003                    ADLQ    2380,DU
         2 011202   204504 757100                    STAQ    XSJ_PARAM,,AUTO

     2225    12274    2      XSJ_JOBINFO.FRS# = JSP.RNST;

  12274  2 011203   100057 236100                    LDQ     47,,PR1
         2 011204   000011 736000                    QLS     9
         2 011205   204514 552140                    STBQ    XSJ_JOBINFO,'40'O,AUTO

     2226    12275    2      XSJ_JOBINFO.OFF_TIME# = JSP.CUR_UTS;

  12275  2 011206   100034 235100                    LDA     28,,PR1
         2 011207   204516 755100                    STA     CHR9,,AUTO

     2227    12276    2      XSJ_JOBINFO.XLIMFLG# = JSP.XLIMFLG;

  12276  2 011210   100057 236100                    LDQ     47,,PR1
         2 011211   000011 736000                    QLS     9
         2 011212   204514 552120                    STBQ    XSJ_JOBINFO,'20'O,AUTO

     2228    12277    2      XSJ_JOBINFO.STEPCC# = JSP.STEPCC;

  12277  2 011213   100057 236100                    LDQ     47,,PR1
         2 011214   000022 772000                    QRL     18
         2 011215   204514 552110                    STBQ    XSJ_JOBINFO,'10'O,AUTO

     2229    12278    2      XSJ_JOBINFO.ACCT# = JSP.ACCT;

  12278  2 011216   040100 100500                    MLR     fill='040'O
         2 011217   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         2 011220   204517 000010                    ADSC9   I,,AUTO                  cn=0,n=8

     2230    12279    2      IF LOGOFF_PARAM.CODE=%AZ$RECOVERY

  12279  2 011221   000000 235100                    LDA     0,,PR0
         2 011222   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:341  
         2 011223   011227 601000 2                  TNZ     s:12281

     2231    12280    2      THEN XSJ_JOBINFO.STATUS# = %FIN_RECOVER#;

  12280  2 011224   000071 236007                    LDQ     57,DL
         2 011225   204514 552104                    STBQ    XSJ_JOBINFO,'04'O,AUTO
         2 011226   011237 710000 2                  TRA     s:12284

     2232    12281    2      ELSE IF JSP.RNST=%RS_EXIT#

  12281  2 011227   100057 236100                    LDQ     47,,PR1
         2 011230   000777 316003                    CANQ    511,DU
         2 011231   011235 601000 2                  TNZ     s:12283

     2233    12282    2           THEN XSJ_JOBINFO.STATUS# = %FIN_COMPLETED#;

  12282  2 011232   000073 236007                    LDQ     59,DL
         2 011233   204514 552104                    STBQ    XSJ_JOBINFO,'04'O,AUTO
         2 011234   011237 710000 2                  TRA     s:12284

     2234    12283    2           ELSE XSJ_JOBINFO.STATUS# = %FIN_ABNORMAL#;

  12283  2 011235   000072 236007                    LDQ     58,DL
         2 011236   204514 552104                    STBQ    XSJ_JOBINFO,'04'O,AUTO

     2235    12284    2      CALL XSJ$WRITE(XSJ_PARAM) ALTRET(NO_JOBSTATS);

  12284  2 011237   204504 633500                    EPPR3   XSJ_PARAM,,AUTO
         2 011240   205530 453500                    STP3    DCB$+2,,AUTO
         2 011241   205530 630500                    EPPR0   DCB$+2,,AUTO
         2 011242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011243   000000 701000 xent               TSX1    XSJ$WRITE
         2 011244   011246 702000 2                  TSX2    NO_JOBSTATS

     2236    12285    3      DO WHILE('0'B);

  12285  2 011245   011257 710000 2                  TRA     s:12288
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:342  

     2237    12286    3   NO_JOBSTATS: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

  12286  2 011246   000001 236000 xsym  NO_JOBSTATS  LDQ     B_VECTNIL+1
         2 011247   205525 756100                    STQ     @DCB#+1,,AUTO
         2 011250   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 011251   000002 036003                    ADLQ    2,DU
         2 011252   205524 756100                    STQ     @ERR+1,,AUTO
         2 011253   000005 236000 3                  LDQ     5
         2 011254   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 011255   011343 701000 2                  TSX1    POST_ERR
         2 011256   000000 011000                    NOP     0

     2238    12287    3           END;

     2239    12288    2      RETURN;

  12288  2 011257   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 011260   000001 702211                    TSX2  ! 1,X1

     2240    12289    2   END WR_JOBSTATS;
     2241    12290        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:343  
     2242    12291    1   OUT_PGRANS: PROC;

  12291  2 011261   204502 741300       OUT_PGRANS   STX1  ! WR_SECLOG+8,,AUTO

     2243    12292        /*I* NAME: OUT_PGRANS
     2244    12293             PURPOSE: To put out a PGRANS record to :ACCTLG
     2245    12294        */
     2246    12295        %PGRANS(NAME = PGRANS,STCLASS = AUTO);
     2247    12361    2      PGRANS = '0'B;

  12361  2 011262   000100 100400                    MLR     fill='000'O
         2 011263   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 011264   204503 000100                    ADSC9   PGRANS,,AUTO             cn=0,n=64

     2248    12362    2      PGRANS.CODE = %AZ$PGRANS;

  12362  2 011265   002000 236003                    LDQ     1024,DU
         2 011266   204503 552140                    STBQ    PGRANS,'40'O,AUTO

     2249    12363    2      PGRANS.CREATOR.ACCT = B$JIT.ACCN;

  12363  2 011267   204007 470500                    LDP0    JIT$,,AUTO
         2 011270   040100 100500                    MLR     fill='040'O
         2 011271   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 011272   204504 000010                    ADSC9   XSJ_PARAM,,AUTO          cn=0,n=8

     2250    12364    2      PGRANS.CREATOR.UNAME = B$JIT.UNAME;

  12364  2 011273   040100 100500                    MLR     fill='040'O
         2 011274   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 011275   204506 000014                    ADSC9   LAST_TYPE,,AUTO          cn=0,n=12

     2251    12365    2      PGRANS.FMACCT = B$JIT.ACCN;

  12365  2 011276   040100 100500                    MLR     fill='040'O
         2 011277   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 011300   204511 000010                    ADSC9   RES$,,AUTO               cn=0,n=8
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:344  

     2252    12366    2      PGRANS.PSN = B$JIT.HPSN;

  12366  2 011301   040100 100500                    MLR     fill='040'O
         2 011302   000234 000006                    ADSC9   156,,PR0                 cn=0,n=6
         2 011303   204513 000006                    ADSC9   FORM$,,AUTO              cn=0,n=6

     2253    12367    2      PGRANS.ONLINE = B$JIT.GAC;

  12367  2 011304   000100 100500                    MLR     fill='000'O
         2 011305   000243 000014                    ADSC9   163,,PR0                 cn=0,n=12
         2 011306   204520 000014                    ADSC9   I+1,,AUTO                cn=0,n=12

     2254    12368    2      CALL OPEN_FILE(F_ACCTLG) ALTRET(WRITE_ALT);

  12368  2 011307   000011 236000 3                  LDQ     9
         2 011310   205511 756100                    STQ     @FILNUM,,AUTO
         2 011311   001552 701000 2                  TSX1    OPEN_FILE
         2 011312   011330 702000 2                  TSX2    WRITE_ALT

     2255    12369    2      FPT_WRITE.BUF_ = VECTOR(PGRANS);

  12369  2 011313   000145 235000 3                  LDA     101
         2 011314   205530 452500                    STP2    DCB$+2,,AUTO
         2 011315   205530 236100                    LDQ     DCB$+2,,AUTO
         2 011316   004503 036003                    ADLQ    2371,DU
         2 011317   204354 757100                    STAQ    FPT_WRITE+4,,AUTO

     2256    12370    2      FPT_WRITE.V.DCB# = LOGOFF_PARAM.DCB1;

  12370  2 011320   200003 470500                    LDP0    @LOGOFF_PARAM,,AUTO
         2 011321   000002 220100                    LDX0    2,,PR0
         2 011322   204360 740100                    STX0    FPT_WRITE+8,,AUTO

     2257    12371    2      CALL M$WRITE(FPT_WRITE) ALTRET(WRITE_ALT);

  12371  2 011323   204350 630500                    EPPR0   FPT_WRITE,,AUTO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:345  
         2 011324   440001 713400                    CLIMB   alt,write
         2 011325   401400 401760                    pmme    nvectors=4
         2 011326   011330 702000 2                  TSX2    WRITE_ALT

     2258    12372    3      DO WHILE('0'B);

  12372  2 011327   011341 710000 2                  TRA     s:12375

     2259    12373    3   WRITE_ALT: CALL POST_ERR(%AZ$LOGOFFERR,LOGOFF_PARAM.DCB1);

  12373  2 011330   000001 236000 xsym  WRITE_ALT    LDQ     B_VECTNIL+1
         2 011331   205525 756100                    STQ     @DCB#+1,,AUTO
         2 011332   200003 236100                    LDQ     @LOGOFF_PARAM,,AUTO
         2 011333   000002 036003                    ADLQ    2,DU
         2 011334   205524 756100                    STQ     @ERR+1,,AUTO
         2 011335   000005 236000 3                  LDQ     5
         2 011336   205523 756100                    STQ     XSJ_PARAM+9,,AUTO
         2 011337   011343 701000 2                  TSX1    POST_ERR
         2 011340   000000 011000                    NOP     0

     2260    12374    3           END;

     2261    12375    2      RETURN;

  12375  2 011341   204502 221300                    LDX1  ! WR_SECLOG+8,,AUTO
         2 011342   000001 702211                    TSX2  ! 1,X1

     2262    12376    2   END OUT_PGRANS;
     2263    12377        %EJECT;
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:346  
     2264    12378    1   POST_ERR: PROC(ERR,DCB#,ERR1);

  12378  2 011343   205522 741300       POST_ERR     STX1  ! XSJ_PARAM+8,,AUTO

     2265    12379        /*I* NAME: POST_ERR
     2266    12380             PURPOSE: To handle recording of error conditions
     2267    12381             DESCRIPTION: If ERR is greater than LOGOFF_PARAM.ERR, it is placed
     2268    12382             into LOGOFF_PARAM.ERR and if ERR1 is specified, it is used as
     2269    12383             B$JIT$->B$JIT.USRERR.CODE otheewise the causing monitor error is
     2270    12384             placed into B$JIT$->B$JIT.USRERR. If a DCB# is passed, the number
     2271    12385             along with other pertinent information is preserved for subsequent
     2272    12386             use by the calling program.
     2273    12387        */
     2274    12388    2   DCL ERR SBIN;
     2275    12389    2   DCL DCB# UBIN HALF ALIGNED;
     2276    12390    2   DCL ERR1 SBIN;
     2277    12391    2   DCL DCB$ PTR;
     2278    12392    2      IF ERR>LOGOFF_PARAM.ERR

  12392  2 011344   205523 470500                    LDP0    @ERR,,AUTO
         2 011345   200003 471500                    LDP1    @LOGOFF_PARAM,,AUTO
         2 011346   000000 236100                    LDQ     0,,PR0
         2 011347   100001 116100                    CMPQ    1,,PR1
         2 011350   011427 604400 2                  TMOZ    s:12412

     2279    12393    3      THEN DO;

     2280    12394    3           LOGOFF_PARAM.ERR = ERR;

  12394  2 011351   100001 756100                    STQ     1,,PR1

     2281    12395    3           IF ADDR(ERR1)~=ADDR(NIL)

  12395  2 011352   205525 236100                    LDQ     @ERR1,,AUTO
         2 011353   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 011354   011367 600000 2                  TZE     s:12400

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:347  
     2282    12396    4           THEN DO;

     2283    12397    4                B$JIT.USRERR = '013201000000'O;

  12397  2 011355   002056 236000 1                  LDQ     XSJ_PARAMC+74
         2 011356   204007 473500                    LDP3    JIT$,,AUTO
         2 011357   300144 756100                    STQ     100,,PR3

     2284    12398    4                B$JIT.USRERR.CODE = ERR1;

  12398  2 011360   205525 474500                    LDP4    @ERR1,,AUTO
         2 011361   400000 236100                    LDQ     0,,PR4
         2 011362   000003 736000                    QLS     3
         2 011363   300144 676100                    ERQ     100,,PR3
         2 011364   377770 376007                    ANQ     131064,DL
         2 011365   300144 656100                    ERSQ    100,,PR3

     2285    12399    4                END;

  12399  2 011366   011374 710000 2                  TRA     s:12401

     2286    12400    3           ELSE B$JIT.USRERR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  12400  2 011367   000000 473400 xsym               LDP3    B$TCB$
         2 011370   300000 474500                    LDP4    0,,PR3
         2 011371   400102 236100                    LDQ     66,,PR4
         2 011372   204007 475500                    LDP5    JIT$,,AUTO
         2 011373   500144 756100                    STQ     100,,PR5

     2287    12401    3           IF ADDR(DCB#) ~= ADDR(NIL)

  12401  2 011374   205524 236100                    LDQ     @DCB#,,AUTO
         2 011375   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 011376   011427 600000 2                  TZE     s:12412

     2288    12402    4           THEN DO;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:348  
     2289    12403    4                DCB#_SAVE = DCB#;

  12403  2 011377   205524 473500                    LDP3    @DCB#,,AUTO
         2 011400   300000 236100                    LDQ     0,,PR3
         2 011401   000022 772000                    QRL     18
         2 011402   204135 756100                    STQ     DCB#_SAVE,,AUTO

     2290    12404    4                DCB$ = DCBADDR(DCB#);

  12404  2 011403   000017 474400 3                  LDP4    15
         2 011404   400000 475500                    LDP5    0,,PR4
         2 011405   300000 220100                    LDX0    0,,PR3
         2 011406   500000 236110                    LDQ     0,X0,PR5
         2 011407   205526 756100                    STQ     DCB$,,AUTO

     2291    12405    4                ASN_SAVE =DCB$ -> F$DCB.ASN#;

  12405  2 011410   205526 476500                    LDP6    DCB$,,AUTO
         2 011411   600032 236100                    LDQ     26,,PR6
         2 011412   000011 772000                    QRL     9
         2 011413   000777 376007                    ANQ     511,DL
         2 011414   204134 756100                    STQ     ASN_SAVE,,AUTO

     2292    12406    4                NAME_SAVE = DCB$ -> F$DCB.NAME#;

  12406  2 011415   000100 100500                    MLR     fill='000'O
         2 011416   600010 000040                    ADSC9   8,,PR6                   cn=0,n=32
         2 011417   204450 000040                    ADSC9   NAME_SAVE,,AUTO          cn=0,n=32

     2293    12407    4                ACCT_SAVE.ACCT# = DCB$ -> F$DCB.ACCT#;

  12407  2 011420   600020 237100                    LDAQ    16,,PR6
         2 011421   204460 757100                    STAQ    ACCT_SAVE,,AUTO

     2294    12408    4                SN_SAVE.NUM# = 1;

  12408  2 011422   000001 235007                    LDA     1,DL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:349  
         2 011423   204462 755100                    STA     SN_SAVE,,AUTO

     2295    12409    4                SN_SAVE.SN#(0) = DCB$ -> F$DCB.PSN#;

  12409  2 011424   040100 100500                    MLR     fill='040'O
         2 011425   600024 000006                    ADSC9   20,,PR6                  cn=0,n=6
         2 011426   204463 000006                    ADSC9   SN_SAVE+1,,AUTO          cn=0,n=6

     2296    12410    4                END;

     2297    12411    3           END;

     2298    12412    2      RETURN;

  12412  2 011427   205522 221300                    LDX1  ! XSJ_PARAM+8,,AUTO
         2 011430   000001 702211                    TSX2  ! 1,X1
     2299    12413    2   END POST_ERR;
     2300    12414    1   END AZA$LOGOFF;
     2301    12415        %EOD;

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:350  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   AZ_PERR_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AR_TBLS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure AZA$LOGOFF.
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:351  

 **** Variables and constants ****

  ****  Section 001 RoData AZA$LOGOFF

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1743-0-0/c CHAR(4)     r     1 BL                       531-0-0/c CHAR(16)    r     1 BL_16
   467-0-0/c CHAR(72)    r     1 DASH_LINE                424-0-0/w BIT (72)    r     1 F0
   426-0-0/w BIT (72)    r     1 F1                       746-0-0/d STRC(288)   r     1 FORM_DFLT
   232-0-0/d STRC(1080)  r     1 FPT_CLOSEC               216-0-0/d STRC(360)   r     1 FPT_DELRECC
    34-0-0/d STRC(288)   r     1 FPT_DEQC                  22-0-0/d STRC(360)   r     1 FPT_ENQC
   304-0-0/d STRC(288)   r     1 FPT_NODEINFOC             60-0-0/d STRC(2088)  r     1 FPT_OPENC
   756-0-0/d STRC(2088)  r     1 FPT_OPEN_LLC             152-0-0/d STRC(360)   r     1 FPT_PRECORDC
   164-0-0/d STRC(504)   r     1 FPT_READC                  0-0-0/d STRC(648)   r     1 FPT_RESCTLC
    44-0-0/d STRC(432)   r     1 FPT_TIMEC                202-0-0/d STRC(432)   r     1 FPT_WRITEC
   430-0-0/c CHAR(63)    r     1 FRM_TEMPLATE             450-0-0/c CHAR(57)    r     1 FRM_TEMPLATE_BLIND
   231-0-0/c STRC(18)    r     1 HIGH_KEY                1231-0-0/w STRC(342)   r     1 ITBL(0:32)
  1070-0-0/c CHAR(32)    r     1 JOBNAME_LIT              230-0-0/c STRC(18)    r     1 LOW_KEY
   537-0-0/b BIT (9)     r     1 MOPS_4_2_STR(0:5)
   541-0-0/b BIT (9)     r     1 MOPS_5_0_STR(0:4)
   535-0-0/b BIT (9)     r     1 MOPS_5_2_STR(0:5)
   543-0-0/b BIT (9)     r     1 MOPS_6_0_STR(0:4)
   552-0-0/b BIT (9)     r     1 MOP_2_0_STR(0:1)
   545-0-0/b BIT (9)     r     1 MOP_2_4_STR(0:3)
   550-0-0/b BIT (9)     r     1 MOP_5_2_STR(0:3)
   555-0-0/b BIT (9)     r     1 MOP_6_0_STR(0:1)
   556-0-0/c BIT (9)     r     1 MOP_6_4_STR(0:3)
   557-0-0/b BIT (9)     r     1 MOP_7_0_STR(0:1)
   551-0-0/b BIT (9)     r     1 MOP_7_2_STR(0:3)
   560-0-0/b BIT (9)     r     1 MOP_8_0_STR(0:1)
   325-0-0/c STRC(396)   r     1 OPN_TBL(0:4)
   730-0-0/d STRC(504)   r     1 PRC_SCH_DFLT            1060-0-0/c CHAR(32)    r     1 PROC1_LIT
  1050-0-0/c CHAR(32)    r     1 PROC_LIT
   314-0-0/w STRC        r     1 RNSTCVT(0:8)
  1101-0-0/w STRC(225)   r     1 RNST_TBL(0:9)
   564-0-0/d STRC(3564)  r     1 RT_DFLT                  270-0-0/c STRC(81)    r     1 SACCUM_KEY
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:352  
   273-0-0/c STRC(27)    r     1 STARS_NAME               511-0-0/c CHAR(64)    r     1 SUM_TEMPLATE
  1100-0-0/c CHAR        r     1 TOF_VFC                  274-0-0/d STRC(288)   r     1 WR_SECLOG_CONST
  1207-0-0/w STRC(72)    r     1 XLIM_TBL(0:8)
   414-0-0/d STRC(288)   r     1 XSJ_PARAMC              1744-0-0/d STRC(288)   r     1 XSJ_PARAMC
   561-0-0/c CHAR(10)    r     1 ZERO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  5214-0-0/w PTR         r     1 @CNT                    4503-0-0/w PTR         r     1 @CODE
  5524-0-0/w PTR         r     1 @DCB#                   5523-0-0/w PTR         r     1 @ERR
  5525-0-0/w PTR         r     1 @ERR1                   5511-0-0/w PTR         r     1 @FILNUM
  4527-0-0/w PTR         r     1 @FROM                   5213-0-0/w PTR         r     1 @IDX
  5217-0-0/w PTR         r     1 @JSNAME                 4531-0-0/w PTR         r     1 @LEN
     3-0-0/w PTR         r     1 @LOGOFF_PARAM           5234-0-0/w PTR         r     1 @MAX
  4521-0-0/w PTR         r     1 @MULT                   4521-0-0/w PTR         r     1 @MULT
  4521-0-0/w PTR         r     1 @MULT                   5216-0-0/w PTR         r     1 @PRATE
  5215-0-0/w PTR         r     1 @RATE                   5233-0-0/w PTR         r     1 @TIME$
  4530-0-0/w PTR         r     1 @TOO                    4466-0-0/c STRC(90)    r     1 ACCT_KEY_SAVE
  4460-0-0/c STRC(72)    r     1 ACCT_SAVE               4134-0-0/w UBIN        r     1 ASN_SAVE
  4503-0-0/w STRC(18576) r     1 AS_USERS                4527-0-0/w SBIN        r     1 CHG1
  4530-0-0/w SBIN        r     1 CHG2                    5220-0-0/w SBIN        r     1 CHG_VAL
  4521-0-0/c CHAR(10)    r     1 CHR10                   4524-0-0/c CHAR(11)    r     1 CHR11
  4510-0-0/c CHAR(6)     r     1 CHR6                    4512-0-0/c CHAR(7)     r     1 CHR7
  4514-0-0/c CHAR(8)     r     1 CHR8                    4516-0-0/c CHAR(9)     r     1 CHR9
    *0-0-0/w SBIN        r     1 CNT                       *0-0-0/w SBIN        r     1 CODE
  4505-0-0/w SBIN        r     1 CUR_PROC                4504-0-0/w SBIN        r     1 CUR_STEP
    *0-0-0/w UBIN(18)    r     1 DCB#                    4135-0-0/w UBIN        r     1 DCB#_SAVE
  5526-0-0/w PTR         r     1 DCB$                    4010-0-0/w PTR         r     1 DCB1$
  5226-0-0/c STRC(108)   r     1 DECFLT                  5222-0-0/w SBIN        r     1 DIGITS
    *0-0-0/w SBIN        r     1 ERR                       *0-0-0/w SBIN        r     1 ERR1
  5224-0-0/w SBIN        r     1 FCNT                    5225-0-0/w SBIN        r     1 FDIV
    *0-0-0/w SBIN        r     1 FILNUM                  5507-0-0/w BIT         r     1 FIRST
  4513-0-0/w PTR         r     1 FORM$                   4514-0-0/w PTR         r     1 FORM1$
  4507-0-0/w BIT         r     1 FORM_START              5062-0-0/d STRC(288)   r     1 FORM_TBL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:353  
  4525-0-0/w BIT         r     1 FOUND                   4525-0-0/w BIT         r     1 FOUND
  4525-0-0/w BIT         r     1 FOUND                   4434-0-0/d STRC(432)   r     1 FPT_ACCT
  4376-0-0/d STRC(1080)  r     1 FPT_CLOSE               4364-0-0/d STRC(360)   r     1 FPT_DELREC
  4202-0-0/d STRC(288)   r     1 FPT_DEQ                 4170-0-0/d STRC(360)   r     1 FPT_ENQ
  4226-0-0/d STRC(2088)  r     1 FPT_OPEN                5076-0-0/d STRC(2088)  r     1 FPT_OPEN_LL
  4320-0-0/d STRC(360)   r     1 FPT_PRECORD             4332-0-0/d STRC(504)   r     1 FPT_READ
  4136-0-0/d STRC(648)   r     1 FPT_RESCTL              4212-0-0/d STRC(432)   r     1 FPT_TIME
  4350-0-0/d STRC(432)   r     1 FPT_WRITE               5074-0-0/w PTR         r     1 FRM$
    *0-0-0/w SBIN        r     1 FROM                    4524-0-0/w SBIN        r     1 FROM
  4524-0-0/w SBIN        r     1 FROM                    4524-0-0/w SBIN        r     1 FROM
  5223-0-0/w SBIN        r     1 HRS                     4505-0-0/w SBIN        r     1 I
  5217-0-0/w SBIN        r     1 I                       5235-0-0/w SBIN        r     1 I
  4517-0-0/w SBIN        r     1 I                       4517-0-0/w SBIN        r     1 I
  4532-0-0/w SBIN        r     1 I                       4522-0-0/w SBIN        r     1 I
  4522-0-0/w SBIN        r     1 I                       4522-0-0/w SBIN        r     1 I
    *0-0-0/w SBIN        r     1 IDX                     4117-0-0/c STRC(324)   r     1 IN_KEY
  4130-0-0/w PTR         r     1 IN_KEY$                 4523-0-0/w SBIN        r     1 J
  4523-0-0/w SBIN        r     1 J                       4523-0-0/w SBIN        r     1 J
  4007-0-0/w PTR         r     1 JIT$                      *0-0-0/c CHAR(16)    r     1 JSNAME
  4131-0-0/w SBIN        r     1 LAST_STEP               4506-0-0/w SBIN        r     1 LAST_TYPE
    *0-0-0/w SBIN        r     1 LEN                       *0-0-0/w STRC(216)   r     1 LOGOFF_PARAM
    *0-0-0/w SBIN        r     1 MAX                     4532-0-0/w SBIN        r     1 MNTS
    *0-0-0/w SBIN        r     1 MULT                      *0-0-0/w SBIN        r     1 MULT
    *0-0-0/w SBIN        r     1 MULT                    4450-0-0/c STRC(288)   r     1 NAME_SAVE
  5072-0-0/w UBIN        r     1 NO_DFLT                 5170-0-0/c STRC(648)   r     1 OB
  5170-0-0/c STRC(648)   r     1 OBF                     5170-0-0/c STRC(648)   r     1 OBH
  5170-0-0/c STRC(648)   r     1 OBNC                    5170-0-0/c STRC(648)   r     1 OBP
  5170-0-0/c STRC(648)   r     1 OBS                     5170-0-0/c STRC(648)   r     1 OBT
  5170-0-0/c CHAR(72)    r     1 OUT_BUF                 4056-0-0/w SBIN        r     1 PACCUM(0:32)
  4503-0-0/w STRC(576)   r     1 PGRANS                    *0-0-0/w BIT (72)    r     1 PRATE
  5044-0-0/d STRC(504)   r     1 PRC_SCH_TBL             4133-0-0/w UBIN        r     1 PROCNUM
  4700-0-0/d STRC(3564)  r     1 PRT                     4506-0-0/w BIT         r     1 PSTEP
    *0-0-0/w BIT (72)    r     1 RATE                    5073-0-0/w BIT         r     1 RATES_OPN
     4-0-0/w SBIN        r     1 REC(0:1023)             4004-0-0/w PTR         r     1 REC$
  2004-0-0/w SBIN        r     1 REC1(0:1023)            4005-0-0/w PTR         r     1 REC1$
  4006-0-0/w SBIN        r     1 RECLEN                  4511-0-0/w PTR         r     1 RES$
  4512-0-0/w PTR         r     1 RES1$                   4534-0-0/d STRC(3564)  r     1 RT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:354  
  4011-0-0/w STRC(1332)  r     1 SACCUM                  4462-0-0/d STRC(90)    r     1 SN_SAVE
  4503-0-0/c STRC(45)    r     1 STARS_KEY               4503-0-0/w SBIN        r     1 STATSLEV
  5213-0-0/w PTR         r     1 SUDO$                   4507-0-0/w PTR         r     1 SUDO$
  4510-0-0/w PTR         r     1 SUDO1$                  4504-0-0/w SBIN        r     1 T
  5216-0-0/w SBIN        r     1 T                       4531-0-0/w SBIN        r     1 T1
  4132-0-0/w SBIN        r     1 TEMP                    5214-0-0/w PTR         r     1 TEMP$
  5221-0-0/w UBIN        r     1 TEMP1                   5215-0-0/w PTR         r     1 TEMP1$
    *0-0-0/w PTR         r     1 TIME$                     *0-0-0/w SBIN        r     1 TOO
  4160-0-0/d STRC(252)   r     1 VLP_PSEUDO              4472-0-0/d STRC(288)   r     1 WR_SECLOG
  4514-0-0/w STRC(180)   r     1 XSJ_JOBINFO             5512-0-0/d STRC(288)   r     1 XSJ_PARAM
  4504-0-0/d STRC(288)   r     1 XSJ_PARAM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(90)    r     1 ACCT$KEY                   0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c CHAR        r     1 CHR$ARY(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(1800)  r     1 FEPJSP
     0-0-0/w STRC(441)   r     1 FORM(0:0)                  0-0-0/w STRC(441)   r     1 FORM1(0:0)
     0-0-0/d STRC(288)   r     1 FPT_NODEINFO               0-0-0/w STRC(441)   r     1 FRM(0:0)
     0-0-0/w STRC(3492)  r     1 JSP                        0-0-0/w STRC(3492)  r     1 JSP1
     0-0-0/c CHAR(5)     r     1 LIM$TEXT                   0-0-0/c ACHR        r     1 REC$ORD
     0-0-0/w STRC(324)   r     1 RES(0:0)                   0-0-0/w STRC(324)   r     1 RES1(0:0)
     0-0-0/w STRC(180)   r     1 SUDO(0:0)                  0-0-0/w STRC(180)   r     1 SUDO(0:0)
     0-0-0/w STRC(180)   r     1 SUDO1(0:0)                 0-0-0/c ASTR(9)     r     1 TEXT$C
     0-0-0/d STRC(216)   r     1 VLR_NODEINFO

PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:355  

   Procedure AZA$LOGOFF requires 4889 words for executable code.
   Procedure AZA$LOGOFF requires 2930 words of local(AUTO) storage.
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:356  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:357  
          MINI XREF LISTING

ACCT$KEY
      6205**DCL      8996<<ASSIGN   9025<<ASSIGN  11628>>ASSIGN  11644>>ASSIGN  11655>>ASSIGN
ACCT$KEY.ACCT#
      6208**DCL      9005>>DOWHILE 11630>>DOWHILE
ACCT$KEY.AREC_TYPE
      6207**DCL      6208--REDEF
ACCT$KEY.L
      6206**DCL      9005>>DOWHILE
ACCT$KEY.PROC#
      6222**DCL      9005>>DOWHILE  9013>>ASSIGN  11626>>ASSIGN  11630>>DOWHILE
ACCT$KEY.STEP#
      6216**DCL     11625>>ASSIGN  11630>>DOWHILE
ACCT$KEY.TYPE#
      6236**DCL     11594>>IF      11594>>IF      11627>>ASSIGN  11632>>ASSIGN
ACCT_KEY_SAVE
      8900**DCL      9025>>ASSIGN  11628<<ASSIGN  11644<<ASSIGN  11655<<ASSIGN
ACCT_KEY_SAVE.AREC_TYPE
      8902**DCL      8903--REDEF
ACCT_SAVE
      8871**DCL      9138--ASSIGN
ACCT_SAVE.ACCT#
      8871**DCL     12407<<ASSIGN
ADD_EM IN PROCEDURE FILL_REC
     11668**PROC    11639--CALL
ALT IN PROCEDURE ADD_EM
     11718**LABEL   11714--CALLALT 11715--CALLALT 11716--CALLALT
ALT IN PROCEDURE FILL_REC
     11646**LABEL   11636--CALLALT 11639--CALLALT
ALT IN PROCEDURE SUB_EM
     11761**LABEL   11757--CALLALT 11758--CALLALT 11759--CALLALT
ALT1
      9034**LABEL    8995--CALLALT  9003--CALLALT  9007--CALLALT  9028--CALLALT  9029--CALLALT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:358  
ALT1 IN PROCEDURE SEND_REC
      9364**LABEL    9340--CALLALT  9343--CALLALT  9346--CALLALT  9361--CALLALT
ALT2
      9062**LABEL    9041--CALLALT
ALT3
      9079**LABEL    9069--CALLALT
ALTL
      9098**LABEL    9091--CALLALT  9095--CALLALT
ALTL IN PROCEDURE UP_USERS
     12210**LABEL   12191--CALLALT 12203--CALLALT
ALTL1 IN PROCEDURE UP_USERS
     12213**LABEL   12187--CALLALT 12190--CALLALT 12204--CALLALT 12210--CALLALT
ASN_SAVE
      8467**DCL      9140>>ASSIGN  12405<<ASSIGN
AS_USERS IN PROCEDURE UP_USERS
     12014**DCL     12181--ASSIGN  12202--ASSIGN
AS_USERS.BANNER_PERM IN PROCEDURE UP_USERS
     12129**DCL     12130--REDEF
AS_USERS.BUDGET.ACCUM IN PROCEDURE UP_USERS
     12024**DCL     12195<<ASSIGN  12195>>ASSIGN
AS_USERS.BUDGET.ICHARGES IN PROCEDURE UP_USERS
     12044**DCL     12194>>IF
AS_USERS.BUDGET.MACCT IN PROCEDURE UP_USERS
     12034**DCL     12038--REDEF   12206>>ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS IN PROCEDURE UP_USERS
     12047**DCL     12050--REDEF
AS_USERS.BUDGET.PACCUM IN PROCEDURE UP_USERS
     12030**DCL     12032--REDEF   12199<<ASSIGN  12199>>ASSIGN
AS_USERS.BUDGET.PCHARGES IN PROCEDURE UP_USERS
     12043**DCL     12205>>IF
AS_USERS.BUDGET.PMAXC IN PROCEDURE UP_USERS
     12025**DCL     12027--REDEF
AS_USERS.LAST_LOGON_TIME IN PROCEDURE UP_USERS
     12154**DCL     12196<<ASSIGN
AS_USERS.SETUP_CHRA.TXT IN PROCEDURE UP_USERS
     12145**DCL     12146--REDEF   12147--REDEF
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:359  
AZA$FLTTODEC
      8971**DCL-ENT 11180--CALL
AZB$FAD
      8970**DCL-ENT 11682--CALL
AZB$FDV
      8972**DCL-ENT 11179--CALL
AZB$FLOAT
      8974**DCL-ENT 11176--CALL    11178--CALL
AZB$FMP
      8973**DCL-ENT 11177--CALL
AZB$FSB
      8976**DCL-ENT 11731--CALL
AZB$MTH3D2B
      8975**DCL-ENT 10568--CALL    10569--CALL    10593--CALL    10596--CALL    11126--CALL    11128--CALL
     11136--CALL    11143--CALL    11213--CALL    11214--CALL    11215--CALL
B$ALT.CODE
      6128**DCL      6128--REDEF    6129--REDEF    6129--REDEF
B$ALT.ERR
      6129**DCL     12400>>ASSIGN
B$ALT.ERR.CODE
      6130**DCL     11646>>IF      12211>>IF
B$ALT.ERR.ERR#
      6130**DCL      6130--REDEF
B$ALT.EVID
      6129**DCL      6129--REDEF    6129--REDEF
B$JIT
      5842**DCL      9051--ASSIGN   9249--ASSIGN
B$JIT.ACCN
      5847**DCL     12363>>ASSIGN  12365>>ASSIGN
B$JIT.BILL
      5995**DCL      9160<<ASSIGN  10380>>CALLBLT
B$JIT.BLINDACCTNG
      5995**DCL     10581>>IF      10591>>IF      10624>>IF      11203>>IF
B$JIT.BUDLIM
      5984**DCL      9065>>IF       9074>>IF
B$JIT.CPFLAGS1
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:360  
      5936**DCL      8984>>IF       8990>>IF       9023>>IF       9104<<ASSIGN   9104>>ASSIGN   9344>>IF
     10577>>IF      10606>>IF      10618>>IF      10639>>IF      10664>>IF      10796>>IF      10806>>IF
     10824>>IF      10842>>IF      10855>>IF      10875>>IF      10887>>IF      10908>>IF      10940>>IF
     10951>>IF      10971>>IF      10986>>IF      11245>>IF
B$JIT.CPFLAGS1.SLEAZE
      5941**DCL      5941--REDEF
B$JIT.ERR.CODE
      5848**DCL      9286>>IF       9286>>IF      10369>>IF      10680>>IF
B$JIT.ERR.MID
      5848**DCL      5848--REDEF
B$JIT.FACCN
      5847**DCL      9444--ASSIGN
B$JIT.GAC
      6016**DCL      9083>>IF      12367>>ASSIGN
B$JIT.HPSN
      6015**DCL     12366>>ASSIGN
B$JIT.JRESPEAK
      6009**DCL      6010--REDEF
B$JIT.JSLEV
      5984**DCL      9207<<ASSIGN  10453>>ASSIGN
B$JIT.LOGONTIME
      5984**DCL     12196>>ASSIGN
B$JIT.MODE
      5842**DCL      9055>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6118**DCL      6118--REDEF    6119--REDEF
B$JIT.PNR
      6022**DCL      6022--REDEF
B$JIT.PSLEV
      5984**DCL      9208<<ASSIGN  10451>>ASSIGN
B$JIT.REMLO
      6120**DCL      9225<<ASSIGN
B$JIT.RESCORE
      6116**DCL      9230>>ASSIGN
B$JIT.SSLEV
      5984**DCL      8984>>IF       8990>>IF       9206<<ASSIGN  10449>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:361  
B$JIT.TSLINE
      6116**DCL      6117--REDEF
B$JIT.UNAME
      5847**DCL     12364>>ASSIGN
B$JIT.USRDCB
      5996**DCL      9127<<ASSIGN
B$JIT.USRERR
      5983**DCL     12397<<ASSIGN  12400<<ASSIGN
B$JIT.USRERR.CODE
      5983**DCL     12398<<ASSIGN
B$JIT$
      8965**DCL      9222>>ASSIGN   9286>>IF       9286>>IF      10369>>IF      10577>>IF      10606>>IF
     10618>>IF      10639>>IF      10664>>IF      10680>>IF      10796>>IF      10806>>IF      10824>>IF
     10842>>IF      10855>>IF      10875>>IF      10887>>IF      10908>>IF      10940>>IF      10951>>IF
     10971>>IF      10986>>IF      11245>>IF
B$TCB.ALT$
      6124**DCL     11646>>IF      12211>>IF      12400>>ASSIGN
B$TCB$
      8966**DCL     11646>>IF      12211>>IF      12400>>ASSIGN
BAD_FILL
      9033**LABEL    9014--CALLALT
BL IN PROCEDURE CHG
     11098**DCL     11190>>CALLBLT
BL_16 IN PROCEDURE CHARGE_PRINT
      9476**DCL     10488<>CALL    10489<>CALL    10490<>CALL    10491<>CALL    10492<>CALL    10493<>CALL
     10494<>CALL    10500<>CALL    10502<>CALL    10503<>CALL    10504<>CALL    10506<>CALL    10507<>CALL
     10508<>CALL    10509<>CALL    10510<>CALL    10511<>CALL    10512<>CALL    10513<>CALL    10514<>CALL
     10515<>CALL    10516<>CALL    10517<>CALL    10518<>CALL    10519<>CALL    10532<>CALL
BUDGET
      9065**LABEL    8987--GOTO
CHARGE_PRINT
      9456**PROC     9022--CALL     9042--CALL     9071--CALL     9211--CALL
CHECK_STOP IN PROCEDURE FILL_REC
     11644**LABEL   11647--GOTO
CHG IN PROCEDURE CHARGE_PRINT
     10998**PROC    10488--CALL    10489--CALL    10490--CALL    10491--CALL    10492--CALL    10493--CALL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:362  
     10494--CALL    10500--CALL    10502--CALL    10503--CALL    10504--CALL    10506--CALL    10507--CALL
     10508--CALL    10509--CALL    10510--CALL    10511--CALL    10512--CALL    10513--CALL    10514--CALL
     10515--CALL    10516--CALL    10517--CALL    10518--CALL    10519--CALL    10523--CALL    10528--CALL
     10532--CALL    10536--CALL
CHG1 IN PROCEDURE CHARGE_PRINT
      9487**DCL     10568<>CALL    10570>>ASSIGN  10599>>ASSIGN  11126<>CALL    11128<>CALL    11130>>ASSIGN
     11131>>ASSIGN  11135<<ASSIGN  11141<<ASSIGN  11150>>ASSIGN  11230>>ASSIGN
CHG2 IN PROCEDURE CHARGE_PRINT
      9488**DCL     10569<>CALL    10570>>ASSIGN  10599>>ASSIGN  11122<<ASSIGN  11136<>CALL    11138>>ASSIGN
     11143<>CALL    11146<<ASSIGN  11147>>ASSIGN  11151>>ASSIGN  11238>>ASSIGN
CHG_VAL IN PROCEDURE CHG
     11011**DCL     11230<<ASSIGN  11231>>IF      11233>>CALLBLT 11238<<ASSIGN  11239>>IF      11241>>CALLBLT
CHR$ARY IN PROCEDURE STRIP_TIME
     11266**DCL     11269>>DOWHILE 11269>>DOWHILE 11270<<ASSIGN
CHR10 IN PROCEDURE CHARGE_PRINT
      9485**DCL     11217<<CALLBLT 11220>>CALLBLT
CHR11 IN PROCEDURE CHARGE_PRINT
      9486**DCL     11220<<CALLBLT 11221>>ASSIGN  11222>>IF      11224>>ASSIGN  11225>>IF      11227>>ASSIGN
CHR6 IN PROCEDURE CHARGE_PRINT
      9481**DCL     10594<<CALLBLT 10595>>CALLBLT 10597<<CALLBLT 10598>>CALLBLT
CHR7 IN PROCEDURE CHARGE_PRINT
      9482**DCL     10630<<CALLBLT 10631>>CALLBLT 10662<<CALLBLT 10663>>CALLBLT 11233<<CALLBLT 11234>>CALLBLT
CHR8 IN PROCEDURE CHARGE_PRINT
      9483**DCL     10602<<CALLBLT 10603>>CALLBLT 10622<<CALLBLT 10623>>CALLBLT 10635<<CALLBLT 10636>>CALLBLT
     11163<<CALLBLT 11164>>CALLBLT 11171<<CALLBLT 11172>>CALLBLT 11241<<CALLBLT 11242>>CALLBLT
CHR9 IN PROCEDURE CHARGE_PRINT
      9484**DCL     11166<<CALLBLT 11167>>CALLBLT 11192<<CALLBLT 11193>>CALLBLT
CLS_ALT
      9112**LABEL    9109--CALLALT
CLS_ALT IN PROCEDURE OPEN_FILE
      9427**LABEL    9424--CALLALT
CNT IN PROCEDURE CHG
     11010**DCL     10998--PROC    11111>>IF      11126<>CALL    11128<>CALL    11136<>CALL    11143<>CALL
     11163>>CALLBLT 11166>>CALLBLT 11171>>CALLBLT 11175>>ASSIGN  11197--ASSIGN  11199>>ASSIGN
CODE IN PROCEDURE FILL_REC
     11298**DCL     11276--PROC    11576--IF      11578>>DOCASE  11585>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:363  
CUR_PROC IN PROCEDURE FILL_REC
     11300**DCL     11626<<ASSIGN  11630>>DOWHILE
CUR_STEP IN PROCEDURE FILL_REC
     11299**DCL     11625<<ASSIGN  11630>>DOWHILE
DASH_LINE IN PROCEDURE CHARGE_PRINT
      9472**DCL     10617>>ASSIGN
DCB# IN PROCEDURE POST_ERR
     12389**DCL     12378--PROC    12401--IF      12403>>ASSIGN  12404--ASSIGN
DCB#_SAVE
      8468**DCL      9125>>IF       9127>>ASSIGN   9128--IF       9130>>ASSIGN   9135>>ASSIGN   9244<<ASSIGN
     12403<<ASSIGN
DCB$ IN PROCEDURE POST_ERR
     12391**DCL     12404<<ASSIGN  12405>>ASSIGN  12406>>ASSIGN  12407>>ASSIGN  12409>>ASSIGN
DCB1$
      8454**DCL      9108>>IF       9240<<ASSIGN   9420>>IF       9421>>IF       9421>>IF
DECFLT IN PROCEDURE CHG
     11104**DCL     11180<>CALL
DECFLT.DIGITS IN PROCEDURE CHG
     11106**DCL     11107--REDEF   11190>>CALLBLT 11192>>CALLBLT
DECFLT.DIGIT_ARY IN PROCEDURE CHG
     11107**DCL     11182>>DOWHILE
DECFLT.EXP IN PROCEDURE CHG
     11109**DCL     11185>>ASSIGN
DFLT_RTRY IN PROCEDURE CHARGE_PRINT
     10680**LABEL   10383--CALLALT 10394--CALLALT 10420--CALLALT 10432--CALLALT 10555--CALLALT 10686--CALLALT
DIGITS IN PROCEDURE CHG
     11100**DCL     11185<<ASSIGN  11186>>IF      11189>>IF      11190>>CALLBLT 11192>>CALLBLT
ERR IN PROCEDURE POST_ERR
     12388**DCL     12378--PROC    12392>>IF      12394>>ASSIGN
ERR1 IN PROCEDURE POST_ERR
     12390**DCL     12378--PROC    12395--IF      12398>>ASSIGN
F$DCB.ACCT#
      6151**DCL     12407>>ASSIGN
F$DCB.ACTPOS
      6167**DCL      6167--REDEF
F$DCB.ARS#
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:364  
      6141**DCL      6141--REDEF
F$DCB.ASN#
      6156**DCL     12405>>ASSIGN
F$DCB.ATTR
      6160**DCL      6161--REDEF
F$DCB.BORROW
      6175**DCL      6175--REDEF    6175--REDEF    6175--REDEF
F$DCB.DCBNAME.L
      6189**DCL      6189--IMP-SIZ
F$DCB.EOMCHAR#
      6145**DCL      6145--REDEF
F$DCB.FCD#
      6154**DCL      9108>>IF       9128>>IF       9420>>IF      10468>>IF
F$DCB.FLDID
      6170**DCL      6170--REDEF
F$DCB.FORM$
      6164**DCL      6164--REDEF
F$DCB.FSECT
      6180**DCL      6180--REDEF
F$DCB.FSN#
      6157**DCL      6157--REDEF    6157--REDEF    6158--REDEF
F$DCB.HEADER$
      6163**DCL      6163--REDEF
F$DCB.IXTNSIZE#
      6161**DCL      6161--REDEF
F$DCB.LASTSTA$
      6150**DCL      6150--REDEF
F$DCB.LVL
      6176**DCL      6176--REDEF
F$DCB.NAME#
      6151**DCL      9421--IF       9421--IF      12406>>ASSIGN
F$DCB.NAME#.C
      6151**DCL      6151--REDEF
F$DCB.NOEOF
      6173**DCL      6173--REDEF
F$DCB.NRECS#
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:365  
      6162**DCL      6162--REDEF
F$DCB.NRECX
      6181**DCL      6181--REDEF
F$DCB.OHDR
      6173**DCL      6173--REDEF
F$DCB.ORG#
      6156**DCL      6156--REDEF
F$DCB.PRECNO
      6179**DCL      6179--REDEF
F$DCB.PSN#
      6151**DCL     12409>>ASSIGN
F$DCB.RCSZ
      6185**DCL      6185--REDEF
F$DCB.RES#
      6152**DCL      6152--REDEF
F$DCB.SETX
      6164**DCL      6164--REDEF
F$DCB.TAB$
      6164**DCL      6164--REDEF
F$DCB.TDA
      6178**DCL      6179--REDEF
F$DCB.WSN#
      6152**DCL      6152--REDEF
F0 IN PROCEDURE CHARGE_PRINT
      9464**DCL     10488<>CALL    10488<>CALL    10523<>CALL    10528<>CALL    10532<>CALL    10532<>CALL
     10536<>CALL
F1 IN PROCEDURE CHARGE_PRINT
      9466**DCL     10568<>CALL    10569<>CALL    10593<>CALL    10596<>CALL    11128<>CALL    11136<>CALL
     11143<>CALL    11214<>CALL    11215<>CALL
FCNT IN PROCEDURE CHG
     11102**DCL     11175<<ASSIGN  11177<>CALL    11179<>CALL    11180<>CALL
FDIV IN PROCEDURE CHG
     11103**DCL     11178<>CALL    11179<>CALL
FEPJSP.ACCN
      7653**DCL      9170>>ASSIGN
FEPJSP.BILL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:366  
      7689**DCL      9160>>ASSIGN
FEPJSP.FEP#
      7663**DCL      9164>>ASSIGN
FEPJSP.FRS
      7674**DCL      9201>>IF
FEPJSP.JSUNIT
      7663**DCL      7664--REDEF    9181>>ASSIGN
FEPJSP.MCLS
      7662**DCL      7662--REDEF    9193>>ASSIGN
FEPJSP.MODE
      7651**DCL      9177>>ASSIGN
FEPJSP.PEAK_LVLS
      7661**DCL      9197>>ASSIGN
FEPJSP.PEAK_MEM
      7661**DCL      9194>>ASSIGN   9195>>ASSIGN
FEPJSP.PROCNAME
      7653**DCL      9172>>ASSIGN
FEPJSP.PROC_EXTIME
      7659**DCL      9190>>ASSIGN
FEPJSP.PROC_MEMTIME
      7660**DCL      9192>>ASSIGN
FEPJSP.PROC_SVTIME
      7659**DCL      9191>>ASSIGN
FEPJSP.READS_HOST
      7686**DCL      9199>>ASSIGN
FEPJSP.READS_UC
      7687**DCL      9196>>ASSIGN
FEPJSP.START
      7654**DCL      9175>>ASSIGN   9182>>ASSIGN   9184>>ASSIGN
FEPJSP.STEP
      7689**DCL      9176>>ASSIGN
FEPJSP.STEPCC
      7682**DCL      9178>>ASSIGN
FEPJSP.STEPUNIT
      7664**DCL      9180>>ASSIGN
FEPJSP.STOP
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:367  
      7655**DCL      9183>>ASSIGN   9184>>ASSIGN
FEPJSP.SYSID
      7652**DCL      9174>>ASSIGN
FEPJSP.TUEXT
      7656**DCL      9187>>ASSIGN
FEPJSP.TUSVT
      7657**DCL      9188>>ASSIGN
FEPJSP.TYPE
      7650**DCL      9173>>ASSIGN   9179>>IF       9179>>IF
FEPJSP.UMEMTIM
      7658**DCL      9189>>ASSIGN
FEPJSP.UNAME
      7653**DCL      9171>>ASSIGN
FEPJSP.USER_EXTIME
      7655**DCL      7656--REDEF
FEPJSP.USER_MEMTIME
      7658**DCL      7658--REDEF
FEPJSP.USER_SVTIME
      7657**DCL      7657--REDEF
FEPJSP.WRITES_HOST
      7687**DCL      9199>>ASSIGN
FEPJSP.WRITES_UC
      7688**DCL      9196>>ASSIGN
FEPJSP.XLIMFLG
      7682**DCL      9198>>ASSIGN
FILL_REC
     11276**PROC     9014--CALL     9041--CALL     9069--CALL
FILNUM IN PROCEDURE OPEN_FILE
      9375**DCL      9369--PROC     9421>>IF       9421>>IF       9432>>IF       9442>>ASSIGN   9443>>IF
      9445>>ASSIGN   9446>>ASSIGN   9447>>ASSIGN   9448>>ASSIGN   9449>>ASSIGN
FIRST IN PROCEDURE UP_USERS
     12179**DCL     12188<<ASSIGN  12192>>IF      12197<<ASSIGN
FORM IN PROCEDURE FILL_REC
     11490**DCL     11974--ASSIGN  11980<<ASSIGN  11987--ASSIGN  11988--CALL    11989--ASSIGN
FORM.FORMS IN PROCEDURE FILL_REC
     11491**DCL     11983<<ASSIGN  11983>>ASSIGN  11985>>IF
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:368  
FORM.MOUNTS IN PROCEDURE FILL_REC
     11496**DCL     11984<<ASSIGN  11984>>ASSIGN  11985>>IF
FORM.S1 IN PROCEDURE FILL_REC
     11504**DCL     11961>>IF      11981<<ASSIGN
FORM$ IN PROCEDURE FILL_REC
     11306**DCL     11490--IMP-PTR 11955<<ASSIGN  11961>>IF      11971<<ASSIGN  11980>>ASSIGN  11981>>ASSIGN
     11983>>ASSIGN  11983>>ASSIGN  11984>>ASSIGN  11984>>ASSIGN  11985>>IF      11985>>IF
FORM1.FORMS IN PROCEDURE FILL_REC
     11537**DCL     11983>>ASSIGN
FORM1.MOUNTS IN PROCEDURE FILL_REC
     11542**DCL     11984>>ASSIGN
FORM1.S1 IN PROCEDURE FILL_REC
     11550**DCL     11961>>IF      11981>>ASSIGN
FORM1$ IN PROCEDURE FILL_REC
     11307**DCL     11536--IMP-PTR 11956<<ASSIGN  11961>>IF      11981>>ASSIGN  11983>>ASSIGN  11984>>ASSIGN
FORMS IN PROCEDURE FILL_REC
     11938**PROC    11716--CALL    11759--CALL
FORM_DFLT IN PROCEDURE CHARGE_PRINT
      9943**DCL     10565>>ASSIGN
FORM_START IN PROCEDURE CHARGE_PRINT
      9480**DCL     10545<<ASSIGN  10573>>IF      10575<<ASSIGN
FORM_TBL IN PROCEDURE CHARGE_PRINT
      9922**DCL     10547--ASSIGN  10565<<ASSIGN
FORM_TBL.FMOUNT# IN PROCEDURE CHARGE_PRINT
      9925**DCL     10568<>CALL    10596<>CALL
FORM_TBL.FORM# IN PROCEDURE CHARGE_PRINT
      9923**DCL     10569<>CALL    10593<>CALL
FOUND IN PROCEDURE FORMS
     11954**DCL     11959<<ASSIGN  11960>>DOWHILE 11962<<ASSIGN  11965>>IF
FOUND IN PROCEDURE RESOURCES
     11884**DCL     11889<<ASSIGN  11890>>DOWHILE 11894<<ASSIGN  11897>>IF
FOUND IN PROCEDURE SUDOS
     11808**DCL     11813<<ASSIGN  11814>>DOWHILE 11816<<ASSIGN  11819>>IF
FPT_ACCT
      8828**DCL     11584<>CALL
FPT_ACCT.BUF_
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:369  
      8828**DCL      9246<<ASSIGN
FPT_ACCT.JIT_
      8829**DCL      9249<<ASSIGN
FPT_ACCT.LEN_
      8828**DCL      9247<<ASSIGN
FPT_ACCT.PNAME_
      8829**DCL      9248<<ASSIGN
FPT_ACCT.V
      8830**DCL      9245--ASSIGN
FPT_ACCT.V.STAROUT#
      8830**DCL      9251<<ASSIGN
FPT_ACCT.V.TYP#
      8830**DCL     11580<<ASSIGN  11582<<ASSIGN
FPT_ACCT.V.UTS#
      8830**DCL      9250<<ASSIGN
FPT_ACCT.V_
      8828**DCL      9245<<ASSIGN
FPT_CLOSE
      8798**DCL      9109<>CALL     9131<>CALL     9265<<ASSIGN   9424<>CALL
FPT_CLOSE.SN_
      8798**DCL      8798--REDEF
FPT_CLOSE.UTL_
      8799**DCL      8799--REDEF
FPT_CLOSE.V
      8803**DCL      9266--ASSIGN
FPT_CLOSE.V.DCB#
      8804**DCL      9130<<ASSIGN   9267<<ASSIGN
FPT_CLOSE.V.EXPIRE#
      8813**DCL      8813--REDEF
FPT_CLOSE.V.TYPE#
      8811**DCL      8811--REDEF
FPT_CLOSE.V.XTNSIZE#
      8808**DCL      8808--REDEF    8810--REDEF
FPT_CLOSE.V_
      8798**DCL      9266<<ASSIGN
FPT_CLOSEC
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:370  
      8255**DCL      9265>>ASSIGN
FPT_CLOSEC.SN_
      8255**DCL      8255--REDEF
FPT_CLOSEC.UTL_
      8256**DCL      8256--REDEF
FPT_CLOSEC.V
      8260**DCL      8255--DCLINIT
FPT_CLOSEC.V.EXPIRE#
      8270**DCL      8270--REDEF
FPT_CLOSEC.V.TYPE#
      8268**DCL      8268--REDEF
FPT_CLOSEC.V.XTNSIZE#
      8265**DCL      8265--REDEF    8267--REDEF
FPT_DELREC
      8767**DCL      9029<>CALL     9262<<ASSIGN
FPT_DELREC.V
      8770**DCL      9263--ASSIGN
FPT_DELREC.V.DCB#
      8771**DCL      9264<<ASSIGN
FPT_DELREC.V_
      8767**DCL      9263<<ASSIGN
FPT_DELRECC
      8167**DCL      9262>>ASSIGN
FPT_DELRECC.V
      8170**DCL      8167--DCLINIT
FPT_DEQ
      8531**DCL      9272<<ASSIGN  12204<>CALL    12210<>CALL
FPT_DEQ.RNAME_
      8531**DCL      9275<<ASSIGN
FPT_DEQ.V
      8532**DCL      9273--ASSIGN
FPT_DEQ.V.DCB#
      8532**DCL      9274<<ASSIGN
FPT_DEQ.V_
      8531**DCL      9273<<ASSIGN
FPT_DEQC
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:371  
      7917**DCL      9272>>ASSIGN
FPT_DEQC.V
      7918**DCL      7917--DCLINIT
FPT_ENQ
      8513**DCL      9268<<ASSIGN  12190<>CALL
FPT_ENQ.RNAME_
      8513**DCL      9271<<ASSIGN
FPT_ENQ.V
      8514**DCL      9269--ASSIGN
FPT_ENQ.V.DCB#
      8514**DCL      9270<<ASSIGN
FPT_ENQ.V_
      8513**DCL      9269<<ASSIGN
FPT_ENQC
      7896**DCL      9268>>ASSIGN
FPT_ENQC.V
      7897**DCL      7896--DCLINIT
FPT_NODEINFO
      7838**DCL      9162<<ASSIGN   9166<>CALL
FPT_NODEINFO.NODEINFO_
      7838**DCL      9165<<ASSIGN
FPT_NODEINFO.V
      7838**DCL      9163--ASSIGN
FPT_NODEINFO.V.NODENUM#
      7839**DCL      9164<<ASSIGN
FPT_NODEINFO.V_
      7838**DCL      9163<<ASSIGN
FPT_NODEINFOC
      8359**DCL      9162>>ASSIGN
FPT_NODEINFOC.V
      8359**DCL      8359--DCLINIT
FPT_OPEN
      8621**DCL      9116<<ASSIGN   9121<>CALL     9133<<ASSIGN   9141<>CALL     9439<<ASSIGN   9450<>CALL
FPT_OPEN.ACCT_
      8625**DCL      9138<<ASSIGN   9444<<ASSIGN   9445<<ASSIGN
FPT_OPEN.ACSVEH_
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:372  
      8623**DCL      8624--REDEF
FPT_OPEN.ALTKEYS_
      8629**DCL      8630--REDEF    8630--REDEF
FPT_OPEN.HDR_
      8628**DCL      8629--REDEF
FPT_OPEN.NAME_
      8622**DCL      9119<<ASSIGN   9137<<ASSIGN   9442<<ASSIGN
FPT_OPEN.SN_
      8621**DCL      9139<<ASSIGN
FPT_OPEN.TAB_
      8627**DCL      8628--REDEF
FPT_OPEN.UHL_
      8621**DCL      8622--REDEF    8622--REDEF
FPT_OPEN.V
      8630**DCL      9117--ASSIGN   9134--ASSIGN   9440--ASSIGN
FPT_OPEN.V.ACS#
      8641**DCL      9449<<ASSIGN
FPT_OPEN.V.ASN#
      8640**DCL      9140<<ASSIGN
FPT_OPEN.V.DCB#
      8630**DCL      9118<<ASSIGN   9135<<ASSIGN   9441<<ASSIGN
FPT_OPEN.V.DELETE#
      8632**DCL      9120<<ASSIGN
FPT_OPEN.V.FSN#
      8661**DCL      8661--REDEF    8661--REDEF
FPT_OPEN.V.FUN#
      8640**DCL      9446<<ASSIGN
FPT_OPEN.V.ORG#
      8641**DCL      9447<<ASSIGN
FPT_OPEN.V.SETDCB#
      8631**DCL      9136<<ASSIGN
FPT_OPEN.V.SHARE#
      8635**DCL      9448<<ASSIGN
FPT_OPEN.V_
      8621**DCL      9117<<ASSIGN   9134<<ASSIGN   9440<<ASSIGN
FPT_OPEN.WSN_
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:373  
      8627**DCL      8627--REDEF
FPT_OPENC
      8014**DCL      9116>>ASSIGN   9133>>ASSIGN   9439>>ASSIGN
FPT_OPENC.ACSVEH_
      8016**DCL      8017--REDEF
FPT_OPENC.ALTKEYS_
      8022**DCL      8023--REDEF    8023--REDEF
FPT_OPENC.HDR_
      8021**DCL      8022--REDEF
FPT_OPENC.TAB_
      8020**DCL      8021--REDEF
FPT_OPENC.UHL_
      8014**DCL      8015--REDEF    8015--REDEF
FPT_OPENC.V
      8023**DCL      8014--DCLINIT
FPT_OPENC.V.FSN#
      8054**DCL      8054--REDEF    8054--REDEF
FPT_OPENC.WSN_
      8020**DCL      8020--REDEF
FPT_OPEN_LL IN PROCEDURE CHARGE_PRINT
     10177**DCL     10470<<ASSIGN  10473<>CALL
FPT_OPEN_LL.ACSVEH_ IN PROCEDURE CHARGE_PRINT
     10179**DCL     10180--REDEF
FPT_OPEN_LL.ALTKEYS_ IN PROCEDURE CHARGE_PRINT
     10185**DCL     10186--REDEF   10186--REDEF
FPT_OPEN_LL.HDR_ IN PROCEDURE CHARGE_PRINT
     10184**DCL     10185--REDEF
FPT_OPEN_LL.TAB_ IN PROCEDURE CHARGE_PRINT
     10183**DCL     10184--REDEF
FPT_OPEN_LL.UHL_ IN PROCEDURE CHARGE_PRINT
     10177**DCL     10178--REDEF   10178--REDEF
FPT_OPEN_LL.V IN PROCEDURE CHARGE_PRINT
     10186**DCL     10471--ASSIGN
FPT_OPEN_LL.V.DCB# IN PROCEDURE CHARGE_PRINT
     10186**DCL     10472<<ASSIGN
FPT_OPEN_LL.V.FSN# IN PROCEDURE CHARGE_PRINT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:374  
     10217**DCL     10217--REDEF   10217--REDEF
FPT_OPEN_LL.V_ IN PROCEDURE CHARGE_PRINT
     10177**DCL     10471<<ASSIGN
FPT_OPEN_LL.WSN_ IN PROCEDURE CHARGE_PRINT
     10183**DCL     10183--REDEF
FPT_OPEN_LLC IN PROCEDURE CHARGE_PRINT
     10068**DCL     10470>>ASSIGN
FPT_OPEN_LLC.ACSVEH_ IN PROCEDURE CHARGE_PRINT
     10070**DCL     10071--REDEF
FPT_OPEN_LLC.ALTKEYS_ IN PROCEDURE CHARGE_PRINT
     10076**DCL     10077--REDEF   10077--REDEF
FPT_OPEN_LLC.HDR_ IN PROCEDURE CHARGE_PRINT
     10075**DCL     10076--REDEF
FPT_OPEN_LLC.TAB_ IN PROCEDURE CHARGE_PRINT
     10074**DCL     10075--REDEF
FPT_OPEN_LLC.UHL_ IN PROCEDURE CHARGE_PRINT
     10068**DCL     10069--REDEF   10069--REDEF
FPT_OPEN_LLC.V IN PROCEDURE CHARGE_PRINT
     10077**DCL     10068--DCLINIT
FPT_OPEN_LLC.V.FSN# IN PROCEDURE CHARGE_PRINT
     10108**DCL     10108--REDEF   10108--REDEF
FPT_OPEN_LLC.WSN_ IN PROCEDURE CHARGE_PRINT
     10074**DCL     10074--REDEF
FPT_PRECORD
      8676**DCL      8998<>CALL     9009<>CALL     9252<<ASSIGN
FPT_PRECORD.KEY_
      8676**DCL      9255<<ASSIGN
FPT_PRECORD.V
      8678**DCL      9253--ASSIGN
FPT_PRECORD.V.DCB#
      8678**DCL      9254<<ASSIGN
FPT_PRECORD.V.N#
      8682**DCL      8997<<ASSIGN   9008<<ASSIGN
FPT_PRECORD.V_
      8676**DCL      9253<<ASSIGN
FPT_PRECORDC
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:375  
      8072**DCL      9252>>ASSIGN
FPT_PRECORDC.V
      8074**DCL      8072--DCLINIT
FPT_READ
      8703**DCL      9003<>CALL     9256<<ASSIGN   9283<>CALL    10383<>CALL    10394<>CALL    10420<>CALL
     10432<>CALL    10555<>CALL    11642<>CALL    12191<>CALL
FPT_READ.BUF_
      8705**DCL      9001<<ASSIGN   9012<<ASSIGN   9281<<ASSIGN  10382<<ASSIGN  10393<<ASSIGN  10414<<ASSIGN
     10430<<ASSIGN  10547<<ASSIGN  12181<<ASSIGN
FPT_READ.KEY_
      8703**DCL      9258<<ASSIGN
FPT_READ.STATION_
      8706**DCL      8707--REDEF
FPT_READ.V
      8707**DCL      9257--ASSIGN
FPT_READ.V.DCB#
      8707**DCL      9259<<ASSIGN
FPT_READ.V.DVBYTE.REREAD#
      8718**DCL      8718--REDEF
FPT_READ.V.INDX#
      8716**DCL      8716--REDEF
FPT_READ.V.KEYR#
      8708**DCL      8999<<ASSIGN   9010<<ASSIGN  10378<<ASSIGN  10416<<ASSIGN  10549<<ASSIGN
FPT_READ.V.KEYS#
      8708**DCL      9000<<ASSIGN   9011<<ASSIGN   9282<<ASSIGN  10377<<ASSIGN  10415<<ASSIGN  10548<<ASSIGN
     12180<<ASSIGN
FPT_READ.V_
      8703**DCL      9257<<ASSIGN
FPT_READC
      8100**DCL      9256>>ASSIGN
FPT_READC.STATION_
      8103**DCL      8104--REDEF
FPT_READC.V
      8104**DCL      8100--DCLINIT
FPT_READC.V.DVBYTE.REREAD#
      8115**DCL      8115--REDEF
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:376  
FPT_READC.V.INDX#
      8113**DCL      8113--REDEF
FPT_RESCTL
      8480**DCL      9226<<ASSIGN   9231<>CALL     9233<>CALL
FPT_RESCTL.PSEUDO_
      8480**DCL      9232<<ASSIGN
FPT_RESCTL.V
      8482**DCL      9227--ASSIGN
FPT_RESCTL.V.RELALL#
      8482**DCL      9228<<ASSIGN
FPT_RESCTL.V_
      8480**DCL      9227<<ASSIGN
FPT_RESCTLC
      7875**DCL      9226>>ASSIGN
FPT_RESCTLC.V
      7877**DCL      7875--DCLINIT
FPT_TIME
      8548**DCL      9276<<ASSIGN  10646<>CALL    10652<>CALL    10657<>CALL    10785<>CALL    10817<>CALL
     10837<>CALL    10851<>CALL    10865<>CALL    11198<>CALL
FPT_TIME.DATE_
      8548**DCL     10782<<ASSIGN  10815<<ASSIGN  10863<<ASSIGN  10994<<ASSIGN
FPT_TIME.TIME_
      8550**DCL     10487<<ASSIGN  10645<<ASSIGN  10651<<ASSIGN  10656<<ASSIGN  10784<<ASSIGN  10816<<ASSIGN
     10862<<ASSIGN
FPT_TIME.TSTAMP_
      8551**DCL     10644<<ASSIGN  10649<<ASSIGN  10783<<ASSIGN  10814<<ASSIGN  10836<<ASSIGN  10850<<ASSIGN
     10864<<ASSIGN  11197<<ASSIGN
FPT_TIME.V
      8552**DCL      9277--ASSIGN
FPT_TIME.V_
      8548**DCL      9277<<ASSIGN
FPT_TIMEC
      7936**DCL      9276>>ASSIGN
FPT_TIMEC.V
      7940**DCL      7936--DCLINIT
FPT_WRITE
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:377  
      8742**DCL      9095<>CALL     9260<<ASSIGN   9343<>CALL     9361<>CALL    10579<>CALL    10608<>CALL
     10620<>CALL    10641<>CALL    10666<>CALL    10775<>CALL    10798<>CALL    10808<>CALL    10826<>CALL
     10844<>CALL    10857<>CALL    10877<>CALL    10889<>CALL    10910<>CALL    10942<>CALL    10952<>CALL
     10973<>CALL    10988<>CALL    11247<>CALL    12203<>CALL    12371<>CALL
FPT_WRITE.BUF_
      8742**DCL      9093<<ASSIGN   9342<<ASSIGN  10463<<ASSIGN  10773<<ASSIGN  10777<<ASSIGN  12202<<ASSIGN
     12369<<ASSIGN
FPT_WRITE.KEY_
      8742**DCL      9094<<ASSIGN   9347<<ASSIGN  10462<<ASSIGN  12201<<ASSIGN
FPT_WRITE.STATION_
      8744**DCL      8744--REDEF
FPT_WRITE.V
      8745**DCL      9261--ASSIGN
FPT_WRITE.V.DCB#
      8745**DCL      9092<<ASSIGN   9341<<ASSIGN  10464<<ASSIGN  12200<<ASSIGN  12370<<ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
      8751**DCL      8751--REDEF   10774<<ASSIGN  10776<<ASSIGN
FPT_WRITE.V_
      8742**DCL      9261<<ASSIGN
FPT_WRITEC
      8140**DCL      9260>>ASSIGN
FPT_WRITEC.STATION_
      8142**DCL      8142--REDEF
FPT_WRITEC.V
      8143**DCL      8140--DCLINIT
FPT_WRITEC.V.DVBYTE.VFC#
      8149**DCL      8149--REDEF
FRM.FORMS IN PROCEDURE CHARGE_PRINT
      9958**DCL     10569<>CALL    10587>>CALLBLT
FRM.MOUNTS IN PROCEDURE CHARGE_PRINT
      9963**DCL     10567>>ASSIGN
FRM.RATETBLE IN PROCEDURE CHARGE_PRINT
      9986**DCL     10556<<ASSIGN
FRM.S1.DD IN PROCEDURE CHARGE_PRINT
      9976**DCL     10585>>ASSIGN
FRM.S1.FORMNAME IN PROCEDURE CHARGE_PRINT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:378  
      9972**DCL     10554>>CALLBLT 10584>>ASSIGN
FRM.S1.WSN IN PROCEDURE CHARGE_PRINT
      9980**DCL     10586>>ASSIGN
FRM$ IN PROCEDURE CHARGE_PRINT
      9999**DCL      9957--IMP-PTR 10546<<ASSIGN  10554>>CALLBLT 10556>>ASSIGN  10567>>ASSIGN  10569>>CALL
     10584>>ASSIGN  10585>>ASSIGN  10586>>ASSIGN  10587>>CALLBLT
FRM_TEMPLATE IN PROCEDURE CHARGE_PRINT
      9468**DCL     10583>>ASSIGN
FRM_TEMPLATE_BLIND IN PROCEDURE CHARGE_PRINT
      9470**DCL     10582>>ASSIGN
FROM IN PROCEDURE FORMS
     11953**DCL     11987<<ASSIGN  11988<>CALL    11988>>CALL    11988>>CALL
FROM IN PROCEDURE MOVE
     11775**DCL     11764--PROC    11781>>IF      11783>>ASSIGN  11786>>ASSIGN
FROM IN PROCEDURE RESOURCES
     11883**DCL     11928<<ASSIGN  11929<>CALL    11929>>CALL    11929>>CALL
FROM IN PROCEDURE SUDOS
     11807**DCL     11824<<ASSIGN  11825<<ASSIGN  11826<>CALL    11826>>CALL    11826>>CALL    11857<<ASSIGN
     11858<>CALL    11858>>CALL    11858>>CALL
HIGH_KEY
      8229**DCL      8169--DCLINIT  8170--DCLINIT
HRS IN PROCEDURE CHG
     11101**DCL     11199<<ASSIGN  11200>>CALLBLT
I IN PROCEDURE ADD_EM
     11676**DCL     11703<<DOINDEX 11704>>ASSIGN  11704>>ASSIGN  11704>>ASSIGN
I IN PROCEDURE CHARGE_PRINT
      9478**DCL     10521<<DOINDEX 10522>>ASSIGN  10523>>CALL    10523>>CALL    10523>>CALL    10526<<DOINDEX
     10527>>ASSIGN  10528>>CALL    10528>>CALL    10528>>CALL    10531<<DOINDEX 10532>>CALL    10534<<DOINDEX
     10535>>ASSIGN  10536>>CALL    10536>>CALL    10536>>CALL    10551<<DOINDEX 10554>>CALLBLT 10556>>ASSIGN
     10567>>ASSIGN  10569>>CALL    10584>>ASSIGN  10585>>ASSIGN  10586>>ASSIGN  10587>>CALLBLT
I IN PROCEDURE FORMS
     11951**DCL     11958<<ASSIGN  11960>>DOWHILE 11961>>IF      11963<<ASSIGN  11963>>ASSIGN  11980>>ASSIGN
     11981>>ASSIGN  11983>>ASSIGN  11983>>ASSIGN  11984>>ASSIGN  11984>>ASSIGN  11985>>IF      11985>>IF
     11987>>ASSIGN
I IN PROCEDURE MOVE
     11778**DCL     11782<<DOINDEX 11783>>ASSIGN  11783>>ASSIGN  11785<<DOINDEX 11786>>ASSIGN  11786>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:379  
I IN PROCEDURE NO_CHG
     10745**DCL     10786<<ASSIGN  10787>>DOWHILE 10788<<ASSIGN  10788>>ASSIGN  10790>>CALLBLT 10900<<DOINDEX
     10901>>IF      10903>>CALLBLT 10903>>CALLBLT 10905<<ASSIGN  10926<<DOINDEX 10927>>IF      10934>>CALLBLT
     10934>>CALLBLT 10936>>ASSIGN  10962<<ASSIGN  10963<<ASSIGN  10964>>DOWHILE 10965<<ASSIGN  10965>>ASSIGN
     10966>>ASSIGN  10966>>ASSIGN  10967>>ASSIGN  10968>>CALLBLT 10968>>CALLBLT 10969>>CALLBLT 10969>>CALLBLT
     10976<<ASSIGN  10978>>DOWHILE 10979<<ASSIGN  10979>>ASSIGN  10980>>ASSIGN  10980>>ASSIGN  10981>>ASSIGN
     10982>>CALLBLT 10982>>CALLBLT 10983>>CALLBLT 10983>>CALLBLT
I IN PROCEDURE RESOURCES
     11881**DCL     11888<<ASSIGN  11890>>DOWHILE 11891>>IF      11891>>IF      11891>>IF      11891>>IF
     11895<<ASSIGN  11895>>ASSIGN  11917>>ASSIGN  11918>>ASSIGN  11919>>ASSIGN  11920>>ASSIGN  11922>>ASSIGN
     11923>>ASSIGN  11924>>ASSIGN  11924>>ASSIGN  11925>>ASSIGN  11925>>ASSIGN  11926>>IF      11928>>ASSIGN
I IN PROCEDURE STRIP_TIME
     11267**DCL     11268<<ASSIGN  11269>>DOWHILE 11269>>DOWHILE 11269>>DOWHILE 11270>>ASSIGN  11271<<ASSIGN
     11271>>ASSIGN
I IN PROCEDURE SUB_EM
     11729**DCL     11752<<DOINDEX 11753>>ASSIGN  11753>>ASSIGN  11753>>ASSIGN
I IN PROCEDURE SUDOS
     11805**DCL     11812<<ASSIGN  11814>>DOWHILE 11815>>IF      11817<<ASSIGN  11817>>ASSIGN  11848>>ASSIGN
     11850>>ASSIGN  11851>>IF      11852>>ASSIGN  11853>>ASSIGN  11853>>ASSIGN  11854>>ASSIGN  11854>>ASSIGN
     11855>>IF      11857>>ASSIGN
IDX IN PROCEDURE CHG
     11009**DCL     10998--PROC    11111>>IF      11111>>IF      11111>>IF      11111>>IF      11111>>IF
     11123>>IF      11123>>IF      11126>>CALL    11126>>CALL    11128>>CALL    11128>>CALL    11130>>ASSIGN
     11130>>ASSIGN  11131>>ASSIGN  11131>>ASSIGN  11135>>ASSIGN  11136>>CALL    11136>>CALL    11137>>IF
     11137>>IF      11138>>ASSIGN  11138>>ASSIGN  11141>>ASSIGN  11142>>IF      11142>>IF      11143>>CALL
     11143>>CALL    11146>>ASSIGN  11147>>ASSIGN  11154>>ASSIGN  11161>>DOCASE  11163>>CALLBLT 11166>>CALLBLT
     11171>>CALLBLT 11178>>CALL    11208>>IF      11208>>IF      11208>>IF      11228>>ASSIGN
IG1
      9122**LABEL    9121--CALLALT
IGNORE
      8999**LABEL    8998--CALLALT
IGNORE2
      9010**LABEL    9009--CALLALT
INITIALIZE
      9216**PROC     8983--CALL
INITIALIZE_FEP IN PROCEDURE INITIALIZE
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:380  
      9238**ENTRY    9210--CALL
IN_KEY
      8460**DCL      9239--ASSIGN   9255--ASSIGN   9258--ASSIGN   9271--ASSIGN   9275--ASSIGN   9280<<ASSIGN
     10395>>ASSIGN  10433>>ASSIGN  10542<<ASSIGN  10556>>ASSIGN  12201--ASSIGN  12206<<ASSIGN
IN_KEY.KEY
      8462**DCL     10380<<CALLBLT 10391<<CALLBLT 10417<<CALLBLT 10429<<CALLBLT 10554<<CALLBLT 10681>>IF
     10683<<CALLBLT 10683>>CALLBLT 12183<<CALLBLT 12184>>DOWHILE
IN_KEY.LEN
      8461**DCL     10379<<ASSIGN  10418<<ASSIGN  10428<<ASSIGN  10685<<ASSIGN  12182<<ASSIGN  12184>>DOWHILE
     12185<<ASSIGN  12185>>ASSIGN  12189>>DOWHILE 12207<<ASSIGN
IN_KEY$
      8463**DCL      6205--IMP-PTR  8996>>ASSIGN   9005>>DOWHILE  9005>>DOWHILE  9005>>DOWHILE  9013>>ASSIGN
      9025>>ASSIGN   9239<<ASSIGN  11594>>IF      11594>>IF      11625>>ASSIGN  11626>>ASSIGN  11627>>ASSIGN
     11628>>ASSIGN  11630>>DOWHILE 11630>>DOWHILE 11630>>DOWHILE 11632>>ASSIGN  11644>>ASSIGN  11655>>ASSIGN
ITBL.DISPLAY IN PROCEDURE CHG
     11072**DCL     11161>>DOCASE
ITBL.DIV IN PROCEDURE CHG
     11053**DCL     11126<>CALL    11128<>CALL    11136<>CALL    11143<>CALL    11163>>CALLBLT 11166>>CALLBLT
     11171>>CALLBLT 11178<>CALL
ITBL.FLT IN PROCEDURE CHG
     11062**DCL     11126<>CALL    11128<>CALL    11136<>CALL    11143<>CALL
ITBL.NAME IN PROCEDURE CHG
     11019**DCL     11154>>ASSIGN
ITBL.UNITS IN PROCEDURE CHG
     11088**DCL     11228>>ASSIGN
J IN PROCEDURE FORMS
     11952**DCL     11957<<DOINDEX 11961>>IF      11981>>ASSIGN  11983>>ASSIGN  11984>>ASSIGN
J IN PROCEDURE RESOURCES
     11882**DCL     11887<<DOINDEX 11891>>IF      11891>>IF      11891>>IF      11891>>IF      11918>>ASSIGN
     11919>>ASSIGN  11920>>ASSIGN  11922>>ASSIGN  11923>>ASSIGN  11924>>ASSIGN  11925>>ASSIGN
J IN PROCEDURE SUDOS
     11806**DCL     11811<<DOINDEX 11815>>IF      11850>>ASSIGN  11851>>IF      11852>>ASSIGN  11853>>ASSIGN
     11854>>ASSIGN
JIT$
      8453**DCL      5842--IMP-PTR  8984>>IF       8984>>IF       8990>>IF       8990>>IF       9023>>IF
      9051>>ASSIGN   9055>>IF       9065>>IF       9074>>IF       9083>>IF       9104>>ASSIGN   9104>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:381  
      9127>>ASSIGN   9157<<ASSIGN   9160>>ASSIGN   9206>>ASSIGN   9207>>ASSIGN   9208>>ASSIGN   9221<<ASSIGN
      9222<<ASSIGN   9225>>ASSIGN   9230>>ASSIGN   9249>>ASSIGN   9278>>IF       9344>>IF       9444>>ASSIGN
     10380>>CALLBLT 10449>>ASSIGN  10451>>ASSIGN  10453>>ASSIGN  10581>>IF      10591>>IF      10624>>IF
     11203>>IF      12196>>ASSIGN  12363>>ASSIGN  12364>>ASSIGN  12365>>ASSIGN  12366>>ASSIGN  12367>>ASSIGN
     12397>>ASSIGN  12398>>ASSIGN  12400>>ASSIGN
JOBNAME_LIT IN PROCEDURE NO_CHG
     10749**DCL     10804>>CALLBLT
JSNAME IN PROCEDURE CHG
     11014**DCL     10998--PROC    11155>>IF      11158>>ASSIGN
JSP
      6265**DCL      9165--ASSIGN   9168<<ASSIGN   9169--ASSIGN  11603<<ASSIGN  11604--ASSIGN  11835--ASSIGN
     11907--ASSIGN  11969--ASSIGN
JSP.ACCESS_FORM
      6696**DCL      6697--REDEF
JSP.ACCESS_PACKS
      6689**DCL      6690--REDEF
JSP.ACCESS_TAPE
      6682**DCL      6683--REDEF
JSP.ACCN
      6271**DCL      6272--REDEF    9170<<ASSIGN  12183>>CALLBLT
JSP.ACCT
      6272**DCL     10787>>DOWHILE 10790>>CALLBLT 11606<<ASSIGN  12278>>ASSIGN
JSP.ATITLE
      6295**DCL      9186<<ASSIGN  11610<<ASSIGN
JSP.CHG
      6611**DCL      9073>>ASSIGN   9074>>IF       9213>>ASSIGN  10570<<ASSIGN  10570>>ASSIGN  10622>>CALLBLT
     10633>>IF      10635>>CALLBLT 10662>>CALLBLT 10674<<ASSIGN  10674>>ASSIGN  11151<<ASSIGN  11151>>ASSIGN
     12195>>ASSIGN  12199>>ASSIGN
JSP.CODE
      6266**DCL     10505>>IF      11605<<ASSIGN
JSP.CONNECT
      6676**DCL      9184<<ASSIGN   9185>>ASSIGN  10493<>CALL    10644--ASSIGN  10647>>ASSIGN  11588<<ASSIGN
     11713<<ASSIGN  11713>>ASSIGN  11756<<ASSIGN  11756>>ASSIGN
JSP.CUR_UTS
      6327**DCL      9183<<ASSIGN  10783--ASSIGN  11586<>CALL    11665<>CALL    11677<<ASSIGN  12275>>ASSIGN
JSP.DPACCESS
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:382  
      6690**DCL     10515<>CALL    11692<<ASSIGN  11692>>ASSIGN  11741<<ASSIGN  11741>>ASSIGN
JSP.DPMOUNT
      6708**DCL     10518<>CALL    11695<<ASSIGN  11695>>ASSIGN  11744<<ASSIGN  11744>>ASSIGN
JSP.DPTIM_CLK
      6646**DCL     10511<>CALL    11686<<ASSIGN  11686>>ASSIGN  11735<<ASSIGN  11735>>ASSIGN
JSP.DPTIM_CPU
      6664**DCL     10510<>CALL    11689<<ASSIGN  11689>>ASSIGN  11738<<ASSIGN  11738>>ASSIGN
JSP.ELAPSED
      6314**DCL      9185<<ASSIGN  10864--ASSIGN  10866>>ASSIGN  11586<>CALL    11588>>ASSIGN  11665<>CALL
JSP.FLG
      6481**DCL     11623<<ASSIGN
JSP.FORMX
      6788**DCL     10546>>ASSIGN  11825>>ASSIGN  11831<<ASSIGN  11831>>ASSIGN  11862<<ASSIGN  11862>>ASSIGN
     11901<>CALL    11901>>CALL    11901>>CALL    11903<<ASSIGN  11903>>ASSIGN  11932<<ASSIGN  11932>>ASSIGN
     11955>>ASSIGN  11969<<ASSIGN  11971>>ASSIGN  11987>>ASSIGN
JSP.FORM_CNT
      6794**DCL     10551>>DOINDEX 11821>>IF      11830>>IF      11899>>IF      11960>>DOWHILE 11967>>IF
     11973<<ASSIGN  11973>>ASSIGN  11990<<ASSIGN  11990>>ASSIGN
JSP.HOLD_UTS
      6321**DCL     10832>>IF      10836--ASSIGN  11613<<ASSIGN
JSP.JOBNAME
      6285**DCL     11608<<ASSIGN
JSP.JOBNAME.C
      6290**DCL     10804>>CALLBLT
JSP.JOBNAME.L
      6289**DCL     10802>>IF      10804>>CALLBLT
JSP.JORG
      6460**DCL     11622<<ASSIGN
JSP.JSPEAK
      6441**DCL      6442--REDEF
JSP.JSUNITS
      6747**DCL      9180<<ASSIGN   9181<<ASSIGN  10522>>ASSIGN  10527>>ASSIGN  10535>>ASSIGN  11704<<ASSIGN
     11704>>ASSIGN  11753<<ASSIGN  11753>>ASSIGN
JSP.MODE
      6354**DCL      9177<<ASSIGN  10818>>IF      10830>>IF      11587>>IF      11617<<ASSIGN  11712>>IF
     11755>>IF
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:383  
JSP.MTACCESS
      6683**DCL     10514<>CALL    11691<<ASSIGN  11691>>ASSIGN  11740<<ASSIGN  11740>>ASSIGN
JSP.MTMOUNT
      6703**DCL     10517<>CALL    11694<<ASSIGN  11694>>ASSIGN  11743<<ASSIGN  11743>>ASSIGN
JSP.MTTIM_CLK
      6640**DCL     10509<>CALL    11685<<ASSIGN  11685>>ASSIGN  11734<<ASSIGN  11734>>ASSIGN
JSP.MTTIM_CPU
      6658**DCL     10508<>CALL    11688<<ASSIGN  11688>>ASSIGN  11737<<ASSIGN  11737>>ASSIGN
JSP.ORACCESS
      6697**DCL      9199<<ASSIGN  10516<>CALL    11693<<ASSIGN  11693>>ASSIGN  11742<<ASSIGN  11742>>ASSIGN
JSP.ORIGINATOR_PORT.FROM_CR
      6554**DCL      6568--REDEF    6580--REDEF
JSP.ORMOUNT
      6713**DCL     10519<>CALL    11696<<ASSIGN  11696>>ASSIGN  11745<<ASSIGN  11745>>ASSIGN
JSP.ORTIM_CLK
      6652**DCL     10513<>CALL    11687<<ASSIGN  11687>>ASSIGN  11736<<ASSIGN  11736>>ASSIGN
JSP.ORTIM_CPU
      6670**DCL     10512<>CALL    11690<<ASSIGN  11690>>ASSIGN  11739<<ASSIGN  11739>>ASSIGN
JSP.PART#
      6341**DCL     10840>>CALLBLT 11615<<ASSIGN
JSP.PART_MASK
      6347**DCL     11616<<ASSIGN
JSP.PCHG
      6617**DCL     10622>>CALLBLT 10626>>IF      10630>>CALLBLT 10662>>CALLBLT 10674>>ASSIGN  11150<<ASSIGN
     11150>>ASSIGN
JSP.PEXEC
      6727**DCL      9190<<ASSIGN  10488>>CALL    10489<>CALL    10650>>ASSIGN  11699<<ASSIGN  11699>>ASSIGN
     11748<<ASSIGN  11748>>ASSIGN
JSP.PKCO
      6442**DCL      9194<<ASSIGN  10918>>CALLBLT 11708<<ASSIGN
JSP.PMEMTIM
      6630**DCL      9192<<ASSIGN  10503<>CALL    11683<<ASSIGN  11683>>ASSIGN  11732<<ASSIGN  11732>>ASSIGN
JSP.PMMES
      6722**DCL      9193<<ASSIGN  10502<>CALL    10660>>CALLBLT 11698<<ASSIGN  11698>>ASSIGN  11747<<ASSIGN
     11747>>ASSIGN
JSP.PRATETBLE
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:384  
      6402**DCL     10433<<ASSIGN
JSP.PRDPUSED
      6604**DCL     10882>>CALLBLT 11681<<ASSIGN  11681>>ASSIGN  11730<<ASSIGN  11730>>ASSIGN
JSP.PRIO
      6335**DCL     10821>>CALLBLT 11614<<ASSIGN
JSP.PROCNAME
      6385**DCL      9172<<ASSIGN  11620<<ASSIGN
JSP.PROCNAME.C
      6392**DCL     10417>>CALLBLT 10870>>CALLBLT 10873>>CALLBLT
JSP.PROCNAME.L
      6391**DCL     10418>>ASSIGN  10870>>CALLBLT 10873>>CALLBLT
JSP.PSTIME
      6737**DCL      9191<<ASSIGN  10488>>CALL    10491<>CALL    10655>>ASSIGN  11701<<ASSIGN  11701>>ASSIGN
     11750<<ASSIGN  11750>>ASSIGN
JSP.RATETBLE
      6393**DCL     10395<<ASSIGN
JSP.RESPEAK
      6433**DCL      9195<<ASSIGN  10949>>CALLBLT 11710<<ASSIGN
JSP.RESX
      6777**DCL     11824>>ASSIGN  11829<<ASSIGN  11829>>ASSIGN  11861<<ASSIGN  11861>>ASSIGN  11885>>ASSIGN
     11907<<ASSIGN  11908>>ASSIGN  11928>>ASSIGN
JSP.RES_CNT
      6783**DCL     11821>>IF      11823>>IF      11828>>IF      11890>>DOWHILE 11905>>IF      11910<<ASSIGN
     11910>>ASSIGN  11931<<ASSIGN  11931>>ASSIGN  11969>>ASSIGN
JSP.RNST
      6469**DCL      9202<<ASSIGN   9202>>ASSIGN  10901>>IF      10901>>IF      10921>>IF      11679<<ASSIGN
     12274>>ASSIGN  12281>>IF
JSP.START
      6306**DCL      9175<<ASSIGN  10850--ASSIGN  11586<>CALL    11612<<ASSIGN  11665<>CALL
JSP.STEP
      6453**DCL      9017>>IF       9020>>ASSIGN   9176<<ASSIGN   9356>>ASSIGN  10499>>ASSIGN  10853>>CALLBLT
     11621<<ASSIGN
JSP.STEPCC
      6463**DCL      9178<<ASSIGN  10885>>CALLBLT 11678<<ASSIGN  12277>>ASSIGN
JSP.SUBMIT
      6300**DCL      9182<<ASSIGN  10814--ASSIGN  11611<<ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:385  
JSP.SUDOX
      6766**DCL     10769>>ASSIGN  10958>>IF      11809>>ASSIGN  11835<<ASSIGN  11836>>ASSIGN  11857>>ASSIGN
JSP.SUDO_CNT
      6772**DCL     10961>>IF      10963>>ASSIGN  10974>>IF      10976>>ASSIGN  11814>>DOWHILE 11833>>IF
     11838<<ASSIGN  11838>>ASSIGN  11860<<ASSIGN  11860>>ASSIGN  11907>>ASSIGN  11969>>ASSIGN
JSP.SUNIT_CHG
      6754**DCL     11147<<ASSIGN
JSP.SYSID
      6381**DCL      9174<<ASSIGN  10794>>CALLBLT 11619<<ASSIGN  12272>>ASSIGN
JSP.TINTER
      6718**DCL      9196<<ASSIGN  10494<>CALL    11697<<ASSIGN  11697>>ASSIGN  11746<<ASSIGN  11746>>ASSIGN
JSP.TMDPPK
      6593**DCL     10897>>CALLBLT 11709<<ASSIGN
JSP.TSLINE
      6510**DCL      6548--REDEF   11624<<ASSIGN
JSP.TYPE
      6359**DCL      9173<<ASSIGN   9350>>IF       9357>>IF      10409>>IF      10447>>DOCASE  10495>>IF
     10497>>IF      10520>>IF      10525>>IF      10869>>IF      10872>>IF      10893>>IF      10914>>IF
     10946>>IF      11111>>IF      11111>>IF      11111>>IF      11111>>IF      11111>>IF      11120>>IF
     11133>>IF      11169>>IF      11169>>IF      11208>>IF      11208>>IF      11211>>IF      11585<<ASSIGN
     11618<<ASSIGN  11706>>IF
JSP.UEXEC
      6732**DCL      9187<<ASSIGN  10488>>CALL    10490<>CALL    10650>>ASSIGN  11700<<ASSIGN  11700>>ASSIGN
     11749<<ASSIGN  11749>>ASSIGN
JSP.UFTPS
      6623**DCL      9197<<ASSIGN  10506<>CALL    10507<>CALL    11682<>CALL    11731<>CALL
JSP.UMEMTIM
      6635**DCL      9189<<ASSIGN  10504<>CALL    11684<<ASSIGN  11684>>ASSIGN  11733<<ASSIGN  11733>>ASSIGN
JSP.UNAME
      6278**DCL      6279--REDEF    9171<<ASSIGN  12183>>CALLBLT
JSP.USERNAME
      6279**DCL     10790>>CALLBLT 11607<<ASSIGN
JSP.USTIME
      6742**DCL      9188<<ASSIGN  10488>>CALL    10492<>CALL    10655>>ASSIGN  11702<<ASSIGN  11702>>ASSIGN
     11751<<ASSIGN  11751>>ASSIGN
JSP.WOO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:386  
      6291**DCL      9169<<ASSIGN  10792>>ASSIGN  11609<<ASSIGN
JSP.XLIMFLG
      6475**DCL      9198<<ASSIGN  10927>>IF      11680<<ASSIGN  12276>>ASSIGN
JSP1.ACCESS_FORM
      7246**DCL      7247--REDEF
JSP1.ACCESS_PACKS
      7239**DCL      7240--REDEF
JSP1.ACCESS_TAPE
      7232**DCL      7233--REDEF
JSP1.ACCN
      6821**DCL      6822--REDEF
JSP1.ACCT
      6822**DCL     11606>>ASSIGN
JSP1.ATITLE
      6845**DCL     11610>>ASSIGN
JSP1.CODE
      6816**DCL     11605>>ASSIGN
JSP1.CUR_UTS
      6877**DCL     11677>>ASSIGN  11713>>ASSIGN  11756>>ASSIGN
JSP1.DPACCESS
      7240**DCL     11692>>ASSIGN  11741>>ASSIGN
JSP1.DPMOUNT
      7258**DCL     11695>>ASSIGN  11744>>ASSIGN
JSP1.DPTIM_CLK
      7196**DCL     11686>>ASSIGN  11735>>ASSIGN
JSP1.DPTIM_CPU
      7214**DCL     11689>>ASSIGN  11738>>ASSIGN
JSP1.FLG
      7031**DCL     11623>>ASSIGN
JSP1.FORMX
      7338**DCL     11956>>ASSIGN
JSP1.FORM_CNT
      7344**DCL     11716>>IF      11759>>IF      11957>>DOINDEX
JSP1.HOLD_UTS
      6871**DCL     11613>>ASSIGN
JSP1.JOBNAME
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:387  
      6835**DCL     11608>>ASSIGN
JSP1.JORG
      7010**DCL     11622>>ASSIGN
JSP1.JSPEAK
      6991**DCL      6992--REDEF
JSP1.JSUNITS
      7297**DCL     11704>>ASSIGN  11753>>ASSIGN
JSP1.MODE
      6904**DCL     11617>>ASSIGN
JSP1.MTACCESS
      7233**DCL     11691>>ASSIGN  11740>>ASSIGN
JSP1.MTMOUNT
      7253**DCL     11694>>ASSIGN  11743>>ASSIGN
JSP1.MTTIM_CLK
      7190**DCL     11685>>ASSIGN  11734>>ASSIGN
JSP1.MTTIM_CPU
      7208**DCL     11688>>ASSIGN  11737>>ASSIGN
JSP1.ORACCESS
      7247**DCL     11693>>ASSIGN  11742>>ASSIGN
JSP1.ORIGINATOR_PORT.FROM_CR
      7104**DCL      7118--REDEF    7130--REDEF
JSP1.ORMOUNT
      7263**DCL     11696>>ASSIGN  11745>>ASSIGN
JSP1.ORTIM_CLK
      7202**DCL     11687>>ASSIGN  11736>>ASSIGN
JSP1.ORTIM_CPU
      7220**DCL     11690>>ASSIGN  11739>>ASSIGN
JSP1.PART#
      6891**DCL     11615>>ASSIGN
JSP1.PART_MASK
      6897**DCL     11616>>ASSIGN
JSP1.PEXEC
      7277**DCL     11699>>ASSIGN  11748>>ASSIGN
JSP1.PKCO
      6992**DCL     11708>>ASSIGN
JSP1.PMEMTIM
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:388  
      7180**DCL     11683>>ASSIGN  11732>>ASSIGN
JSP1.PMMES
      7272**DCL     11698>>ASSIGN  11747>>ASSIGN
JSP1.PRDPUSED
      7154**DCL     11681>>ASSIGN  11730>>ASSIGN
JSP1.PRIO
      6885**DCL     11614>>ASSIGN
JSP1.PROCNAME
      6935**DCL     11620>>ASSIGN
JSP1.PSTIME
      7287**DCL     11701>>ASSIGN  11750>>ASSIGN
JSP1.RESPEAK
      6983**DCL     11710>>ASSIGN
JSP1.RESX
      7327**DCL     11886>>ASSIGN
JSP1.RES_CNT
      7333**DCL     11715>>IF      11758>>IF      11887>>DOINDEX
JSP1.RNST
      7019**DCL     11679>>ASSIGN
JSP1.START
      6856**DCL     11612>>ASSIGN
JSP1.STEP
      7003**DCL     11621>>ASSIGN
JSP1.STEPCC
      7013**DCL     11678>>ASSIGN
JSP1.SUBMIT
      6850**DCL     11611>>ASSIGN
JSP1.SUDOX
      7316**DCL     11810>>ASSIGN
JSP1.SUDO_CNT
      7322**DCL     11714>>IF      11757>>IF      11811>>DOINDEX
JSP1.SYSID
      6931**DCL     11619>>ASSIGN
JSP1.TINTER
      7268**DCL     11697>>ASSIGN  11746>>ASSIGN
JSP1.TMDPPK
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:389  
      7143**DCL     11709>>ASSIGN
JSP1.TSLINE
      7060**DCL      7098--REDEF   11624>>ASSIGN
JSP1.TYPE
      6909**DCL     11618>>ASSIGN
JSP1.UEXEC
      7282**DCL     11700>>ASSIGN  11749>>ASSIGN
JSP1.UFTPS
      7173**DCL     11682<>CALL    11731<>CALL
JSP1.UMEMTIM
      7185**DCL     11684>>ASSIGN  11733>>ASSIGN
JSP1.UNAME
      6828**DCL      6829--REDEF
JSP1.USERNAME
      6829**DCL     11607>>ASSIGN
JSP1.USTIME
      7292**DCL     11702>>ASSIGN  11751>>ASSIGN
JSP1.WOO
      6841**DCL     11609>>ASSIGN
JSP1.XLIMFLG
      7025**DCL     11680>>ASSIGN
LAST_STEP
      8464**DCL      9004<<ASSIGN   9017>>IF       9020<<ASSIGN
LAST_TYPE IN PROCEDURE FILL_REC
     11301**DCL     11627<<ASSIGN  11632<<ASSIGN  11634>>DOCASE  11659>>IF      11659>>IF
LEN IN PROCEDURE MOVE
     11777**DCL     11764--PROC    11779>>IF      11782>>DOINDEX 11783>>ASSIGN  11783>>ASSIGN  11785>>DOINDEX
LIM$TEXT IN PROCEDURE NO_CHG
     10746**DCL     10931<<CALLBLT 10934<<CALLBLT
LOGOFF_PARAM
      5802**DCL        21--PROC     9155--ENTRY
LOGOFF_PARAM.ACCUM_CHG
      5832**DCL      9073<<ASSIGN   9213<<ASSIGN
LOGOFF_PARAM.CODE
      5803**DCL      8984>>IF       8990>>IF       9039>>IF       9041<>CALL     9043>>IF       9043>>IF
      9059>>IF       9065>>IF       9083>>IF       9083>>IF       9089>>IF       9103>>IF       9114>>IF
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:390  
      9220>>IF       9223>>IF       9344>>IF      12279>>IF
LOGOFF_PARAM.DCB1
      5814**DCL      9034<>CALL     9092>>ASSIGN   9098<>CALL     9112<>CALL     9118>>ASSIGN   9143<>CALL
      9240--ASSIGN   9254>>ASSIGN   9259>>ASSIGN   9264>>ASSIGN   9267>>ASSIGN   9270>>ASSIGN   9274>>ASSIGN
      9288<>CALL     9341>>ASSIGN   9364<>CALL     9427<>CALL     9435>>ASSIGN   9441>>ASSIGN  10370<>CALL
     10702<>CALL    11650<>CALL    12200>>ASSIGN  12213<>CALL    12271>>ASSIGN  12286<>CALL    12370>>ASSIGN
     12373<>CALL
LOGOFF_PARAM.DCB_LL
      5818**DCL      9205>>IF      10464>>ASSIGN  10468--IF      10472>>ASSIGN  10475<>CALL    10669<>CALL
     10992<>CALL    11249<>CALL
LOGOFF_PARAM.ERR
      5808**DCL      9065>>IF       9123>>IF       9243<<ASSIGN  12392>>IF      12394<<ASSIGN
LOGOFF_PARAM.JIT$
      5828**DCL      9159>>ASSIGN   9221>>ASSIGN
LOGOFF_PARAM.UTS
      5823**DCL      9250>>ASSIGN
LOW_KEY
      8201**DCL      8167--DCLINIT  8168--DCLINIT
M$ACCT
      4689**DCL-ENT 11584--CALL
M$CLOSE
      4672**DCL-ENT  9109--CALL     9131--CALL     9424--CALL
M$DELREC
      4674**DCL-ENT  9029--CALL
M$DEQ
      4739**DCL-ENT 12204--CALL    12210--CALL
M$ENQ
      4738**DCL-ENT 12190--CALL
M$LIMIT
      4678**DCL-ENT  9233--CALL
M$NODEINFO
      4704**DCL-ENT  9166--CALL
M$OPEN
      4672**DCL-ENT  9121--CALL     9141--CALL     9450--CALL    10473--CALL
M$PRECORD
      4676**DCL-ENT  8998--CALL     9009--CALL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:391  
M$READ
      4673**DCL-ENT  9003--CALL     9283--CALL    10383--CALL    10394--CALL    10420--CALL    10432--CALL
     10555--CALL    11642--CALL    12191--CALL
M$RELRES
      4679**DCL-ENT  9231--CALL
M$RETRY
      4729**DCL-ENT 10686--CALL
M$TIME
      4739**DCL-ENT 10646--CALL    10652--CALL    10657--CALL    10785--CALL    10817--CALL    10837--CALL
     10851--CALL    10865--CALL    11198--CALL
M$WRITE
      4673**DCL-ENT  9095--CALL     9343--CALL     9361--CALL    10579--CALL    10608--CALL    10620--CALL
     10641--CALL    10666--CALL    10775--CALL    10798--CALL    10808--CALL    10826--CALL    10844--CALL
     10857--CALL    10877--CALL    10889--CALL    10910--CALL    10942--CALL    10952--CALL    10973--CALL
     10988--CALL    11247--CALL    12203--CALL    12371--CALL
M$WRSYSLOG
      4721**DCL-ENT  9052--CALL
MAX IN PROCEDURE STRIP_TIME
     11265**DCL     11254--PROC    11269>>DOWHILE
MNTS IN PROCEDURE CHARGE_PRINT
      9490**DCL     10567<<ASSIGN  10568<>CALL    10589>>CALLBLT
MOPS_4_2_STR IN PROCEDURE CHARGE_PRINT
      9493**DCL     10663>>CALLBLT
MOPS_5_0_STR IN PROCEDURE CHARGE_PRINT
      9495**DCL     10588>>CALLBLT
MOPS_5_2_STR IN PROCEDURE CHARGE_PRINT
      9491**DCL     10603>>CALLBLT 10623>>CALLBLT 10636>>CALLBLT 11242>>CALLBLT
MOPS_6_0_STR IN PROCEDURE CHARGE_PRINT
      9496**DCL     10883>>CALLBLT
MOP_2_0_STR IN PROCEDURE CHARGE_PRINT
      9502**DCL     10590>>CALLBLT 10969>>CALLBLT 10983>>CALLBLT
MOP_2_4_STR IN PROCEDURE CHARGE_PRINT
      9497**DCL     10595>>CALLBLT 10598>>CALLBLT
MOP_5_2_STR IN PROCEDURE CHARGE_PRINT
      9500**DCL     10631>>CALLBLT 11234>>CALLBLT
MOP_6_0_STR IN PROCEDURE CHARGE_PRINT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:392  
      9505**DCL     10795>>CALLBLT
MOP_6_4_STR IN PROCEDURE CHARGE_PRINT
      9506**DCL     11220>>CALLBLT
MOP_7_0_STR IN PROCEDURE CHARGE_PRINT
      9507**DCL     10661>>CALLBLT 10822>>CALLBLT 10841>>CALLBLT 10854>>CALLBLT 10886>>CALLBLT 10898>>CALLBLT
     10919>>CALLBLT 10950>>CALLBLT
MOP_7_2_STR IN PROCEDURE CHARGE_PRINT
      9501**DCL     11167>>CALLBLT 11193>>CALLBLT
MOP_8_0_STR IN PROCEDURE CHARGE_PRINT
      9508**DCL     11164>>CALLBLT 11172>>CALLBLT
MOVE IN PROCEDURE FILL_REC
     11764**PROC    11826--CALL    11858--CALL    11901--CALL    11929--CALL    11988--CALL
MULT IN PROCEDURE FORMS
     11950**DCL     11938--PROC    11983>>ASSIGN  11984>>ASSIGN
MULT IN PROCEDURE RESOURCES
     11880**DCL     11868--PROC    11924>>ASSIGN  11925>>ASSIGN
MULT IN PROCEDURE SUDOS
     11804**DCL     11791--PROC    11853>>ASSIGN  11854>>ASSIGN
NAME_SAVE
      8858**DCL      9137--ASSIGN  12406<<ASSIGN
NO_CHG IN PROCEDURE CHARGE_PRINT
     10705**PROC    10483--CALL
NO_DFLT IN PROCEDURE CHARGE_PRINT
      9997**DCL     10381<<ASSIGN  10392<<ASSIGN  10419<<ASSIGN  10431<<ASSIGN  10550<<ASSIGN  10684>>IF
     10689>>DOCASE
NO_FORM IN PROCEDURE CHARGE_PRINT
     10560**LABEL   10699--GOTO
NO_JOBSTATS IN PROCEDURE WR_JOBSTATS
     12286**LABEL   12269--CALLALT 12284--CALLALT
NO_PROC IN PROCEDURE CHARGE_PRINT
     10422**LABEL   10695--GOTO
NO_RATE IN PROCEDURE CHARGE_PRINT
     10399**LABEL   10693--GOTO
NO_RATE1 IN PROCEDURE CHARGE_PRINT
     10437**LABEL   10697--GOTO
NO_RATES IN PROCEDURE CHARGE_PRINT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:393  
     10368**LABEL   10365--CALLALT
NO_SCHE IN PROCEDURE CHARGE_PRINT
     10385**LABEL   10691--GOTO
OB.BL_AT IN PROCEDURE CHARGE_PRINT
     10244**DCL     11216<<ASSIGN
OB.CHG IN PROCEDURE CHARGE_PRINT
     10250**DCL     10636<<CALLBLT 11242<<CALLBLT
OB.C_PAREN IN PROCEDURE CHARGE_PRINT
     10249**DCL     10629<<ASSIGN  11236<<ASSIGN
OB.DEC2.DEC2 IN PROCEDURE CHARGE_PRINT
     10236**DCL     11167<<CALLBLT 11187<<ASSIGN  11190<<CALLBLT 11193<<CALLBLT
OB.O_PAREN IN PROCEDURE CHARGE_PRINT
     10247**DCL     10628<<ASSIGN  11235<<ASSIGN
OB.PCHG IN PROCEDURE CHARGE_PRINT
     10248**DCL     10631<<CALLBLT 11234<<CALLBLT
OB.PER_UNIT IN PROCEDURE CHARGE_PRINT
     10245**DCL     11221<<ASSIGN  11224<<ASSIGN  11227<<ASSIGN
OB.SCLR IN PROCEDURE CHARGE_PRINT
     10226**DCL     10234--REDEF   10237--REDEF   10240--REDEF
OB.SCLR.JSUNIT.JSNAME IN PROCEDURE CHARGE_PRINT
     10231**DCL     11158<<ASSIGN
OB.SCLR.JSUNIT.Q1 IN PROCEDURE CHARGE_PRINT
     10230**DCL     11157<<ASSIGN
OB.SCLR.JSUNIT.Q2 IN PROCEDURE CHARGE_PRINT
     10232**DCL     11159<<ASSIGN
OB.SCLR.NAME IN PROCEDURE CHARGE_PRINT
     10227**DCL     10228--REDEF   11154<<ASSIGN
OB.SCLR.SCLR IN PROCEDURE CHARGE_PRINT
     10233**DCL     11164<<CALLBLT 11172<<CALLBLT
OB.TIM.TIM IN PROCEDURE CHARGE_PRINT
     10239**DCL     10487--ASSIGN
OB.TIM1.HRS IN PROCEDURE CHARGE_PRINT
     10242**DCL     11200<<CALLBLT 11201--CALL
OB.UNITS IN PROCEDURE CHARGE_PRINT
     10246**DCL     11228<<ASSIGN
OBF.CHG IN PROCEDURE CHARGE_PRINT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:394  
     10269**DCL     10603<<CALLBLT
OBF.DD IN PROCEDURE CHARGE_PRINT
     10258**DCL     10585<<ASSIGN
OBF.FRMS IN PROCEDURE CHARGE_PRINT
     10261**DCL     10587<<CALLBLT 10588<<CALLBLT 10588>>CALLBLT
OBF.MNTS IN PROCEDURE CHARGE_PRINT
     10265**DCL     10589<<CALLBLT 10590<<CALLBLT 10590>>CALLBLT
OBF.NAME IN PROCEDURE CHARGE_PRINT
     10256**DCL     10584<<ASSIGN
OBF.PER_FORM IN PROCEDURE CHARGE_PRINT
     10263**DCL     10595<<CALLBLT
OBF.PER_MNT IN PROCEDURE CHARGE_PRINT
     10267**DCL     10598<<CALLBLT
OBF.WSN IN PROCEDURE CHARGE_PRINT
     10260**DCL     10586<<ASSIGN
OBH.ACCT_NAME IN PROCEDURE CHARGE_PRINT
     10314**DCL     10790<<CALLBLT
OBH.AT IN PROCEDURE CHARGE_PRINT
     10316**DCL     10791<<ASSIGN
OBH.DATE IN PROCEDURE CHARGE_PRINT
     10312**DCL     10782--ASSIGN
OBH.SYSID IN PROCEDURE CHARGE_PRINT
     10320**DCL     10794<<CALLBLT 10795<<CALLBLT 10795>>CALLBLT
OBH.SYSID_TXT IN PROCEDURE CHARGE_PRINT
     10319**DCL     10793<<ASSIGN
OBH.TIME IN PROCEDURE CHARGE_PRINT
     10310**DCL     10784--ASSIGN
OBH.WSN IN PROCEDURE CHARGE_PRINT
     10317**DCL     10792<<ASSIGN
OBNC.NUM1.NUM IN PROCEDURE CHARGE_PRINT
     10341**DCL     10882<<CALLBLT 10883<<CALLBLT 10883>>CALLBLT 10897<<CALLBLT 10898<<CALLBLT 10898>>CALLBLT
     10918<<CALLBLT 10919<<CALLBLT 10919>>CALLBLT 10949<<CALLBLT 10950<<CALLBLT 10950>>CALLBLT
OBNC.NUM2.NUM IN PROCEDURE CHARGE_PRINT
     10346**DCL     10821<<CALLBLT 10822<<CALLBLT 10822>>CALLBLT 10840<<CALLBLT 10841<<CALLBLT 10841>>CALLBLT
     10853<<CALLBLT 10854<<CALLBLT 10854>>CALLBLT 10885<<CALLBLT 10886<<CALLBLT 10886>>CALLBLT
OBNC.PRT1 IN PROCEDURE CHARGE_PRINT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:395  
     10325**DCL     10326--REDEF   10331--REDEF   10335--REDEF   10339--REDEF
OBNC.PRT2 IN PROCEDURE CHARGE_PRINT
     10343**DCL     10344--REDEF   10347--REDEF   10820<<ASSIGN  10839<<ASSIGN  10852<<ASSIGN  10870<<CALLBLT
     10873<<CALLBLT 10884<<ASSIGN  10903<<CALLBLT 10923<<ASSIGN  10924--ASSIGN
OBNC.TIM.DATE IN PROCEDURE CHARGE_PRINT
     10330**DCL     10815--ASSIGN
OBNC.TIM.TIM IN PROCEDURE CHARGE_PRINT
     10328**DCL     10816--ASSIGN
OBNC.TIM1.TIM IN PROCEDURE CHARGE_PRINT
     10334**DCL     10862--ASSIGN
OBNC.TIM2.HRS IN PROCEDURE CHARGE_PRINT
     10337**DCL     10867<<CALLBLT 10868--CALL
OBP.SUDO.EQ IN PROCEDURE CHARGE_PRINT
     10359**DCL     10967<<ASSIGN  10981<<ASSIGN
OBP.SUDO.NAME IN PROCEDURE CHARGE_PRINT
     10358**DCL     10966<<ASSIGN  10980<<ASSIGN
OBP.SUDO.NUM IN PROCEDURE CHARGE_PRINT
     10360**DCL     10968<<CALLBLT 10969<<CALLBLT 10969>>CALLBLT 10982<<CALLBLT 10983<<CALLBLT 10983>>CALLBLT
OBS.CHG IN PROCEDURE CHARGE_PRINT
     10305**DCL     10663<<CALLBLT
OBS.CON IN PROCEDURE CHARGE_PRINT
     10282**DCL     10285--REDEF
OBS.CON.TIM IN PROCEDURE CHARGE_PRINT
     10284**DCL     10645--ASSIGN
OBS.CON1.HRS IN PROCEDURE CHARGE_PRINT
     10286**DCL     10648<<CALLBLT
OBS.EXEC IN PROCEDURE CHARGE_PRINT
     10289**DCL     10292--REDEF
OBS.EXEC.TIME IN PROCEDURE CHARGE_PRINT
     10291**DCL     10651--ASSIGN
OBS.EXEC1.HRS IN PROCEDURE CHARGE_PRINT
     10293**DCL     10654<<CALLBLT
OBS.PMMES IN PROCEDURE CHARGE_PRINT
     10303**DCL     10660<<CALLBLT 10661<<CALLBLT 10661>>CALLBLT
OBS.SERV IN PROCEDURE CHARGE_PRINT
     10296**DCL     10299--REDEF
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:396  
OBS.SERV.TIME IN PROCEDURE CHARGE_PRINT
     10298**DCL     10656--ASSIGN
OBS.SERV1.HRS IN PROCEDURE CHARGE_PRINT
     10300**DCL     10659<<CALLBLT
OBT.TCHG IN PROCEDURE CHARGE_PRINT
     10275**DCL     10623<<CALLBLT
OK_ALT IN PROCEDURE INITIALIZE
      9232**LABEL    9231--CALLALT
OOPS IN PROCEDURE OPEN_FILE
      9453**LABEL    9436--CALLALT  9450--CALLALT
OPEN_FILE
      9369**PROC     8995--CALL     9007--CALL     9028--CALL     9091--CALL     9279--CALL     9340--CALL
      9346--CALL    10365--CALL    12187--CALL    12269--CALL    12368--CALL
OPNLL_ALT IN PROCEDURE CHARGE_PRINT
     10475**LABEL   10473--CALLALT
OPN_TBL.ACCT IN PROCEDURE OPEN_FILE
      9380**DCL      9443>>IF       9445--ASSIGN
OPN_TBL.ACS IN PROCEDURE OPEN_FILE
      9384**DCL      9449>>ASSIGN
OPN_TBL.FUN IN PROCEDURE OPEN_FILE
      9381**DCL      9446>>ASSIGN
OPN_TBL.NAME IN PROCEDURE OPEN_FILE
      9377**DCL      9421--IF       9421--IF       9442--ASSIGN
OPN_TBL.ORG IN PROCEDURE OPEN_FILE
      9382**DCL      9447>>ASSIGN
OPN_TBL.SHR IN PROCEDURE OPEN_FILE
      9383**DCL      9448>>ASSIGN
OUT_BUF IN PROCEDURE CHARGE_PRINT
     10221**DCL     10225--REDEF   10254--REDEF   10273--REDEF   10280--REDEF   10309--REDEF   10324--REDEF
     10354--REDEF   10463--ASSIGN  10576<<ASSIGN  10582<<ASSIGN  10583<<ASSIGN  10617<<ASSIGN  10621<<ASSIGN
     10643<<ASSIGN  10777--ASSIGN  10781<<ASSIGN  10804<<CALLBLT 10813<<ASSIGN  10833<<ASSIGN  10835<<ASSIGN
     10849<<ASSIGN  10861<<ASSIGN  10881<<ASSIGN  10894<<ASSIGN  10896<<ASSIGN  10915<<ASSIGN  10917<<ASSIGN
     10940>>IF      10948<<ASSIGN  10960<<ASSIGN  10977<<ASSIGN  11119<<ASSIGN
OUT_PGRANS
     12291**PROC     9085--CALL
PACCUM
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:397  
      8458**DCL      9019<<ASSIGN   9209<<ASSIGN  11111>>IF      11130<<ASSIGN  11130>>ASSIGN  11135>>ASSIGN
PGRANS IN PROCEDURE OUT_PGRANS
     12301**DCL     12361<<ASSIGN  12369--ASSIGN
PGRANS.CODE IN PROCEDURE OUT_PGRANS
     12302**DCL     12362<<ASSIGN
PGRANS.CREATOR.ACCT IN PROCEDURE OUT_PGRANS
     12319**DCL     12363<<ASSIGN
PGRANS.CREATOR.UNAME IN PROCEDURE OUT_PGRANS
     12323**DCL     12364<<ASSIGN
PGRANS.FMACCT IN PROCEDURE OUT_PGRANS
     12327**DCL     12365<<ASSIGN
PGRANS.ONLINE IN PROCEDURE OUT_PGRANS
     12355**DCL     12367<<ASSIGN
PGRANS.PSN IN PROCEDURE OUT_PGRANS
     12332**DCL     12366<<ASSIGN
POST_ERR
     12378**PROC     9034--CALL     9075--CALL     9098--CALL     9112--CALL     9143--CALL     9235--CALL
      9288--CALL     9364--CALL     9427--CALL    10370--CALL    10386--CALL    10399--CALL    10422--CALL
     10437--CALL    10475--CALL    10560--CALL    10669--CALL    10702--CALL    10992--CALL    11249--CALL
     11596--CALL    11650--CALL    11661--CALL    11842--CALL    11914--CALL    11977--CALL    12213--CALL
     12286--CALL    12373--CALL
POST_IT IN PROCEDURE FILL_REC
     11646**LABEL   11584--CALLALT
PRATE IN PROCEDURE CHG
     11013**DCL     10998--PROC    11126<>CALL    11128<>CALL    11213<>CALL    11214<>CALL
PRC_SCH_DFLT IN PROCEDURE CHARGE_PRINT
      9895**DCL     10385>>ASSIGN  10426>>ASSIGN
PRC_SCH_TBL IN PROCEDURE CHARGE_PRINT
      9868**DCL     10382--ASSIGN  10385<<ASSIGN  10414--ASSIGN  10426<<ASSIGN
PRC_SCH_TBL.RTABLE# IN PROCEDURE CHARGE_PRINT
      9869**DCL     10391>>CALLBLT 10429>>CALLBLT
PROC1_LIT IN PROCEDURE NO_CHG
     10748**DCL     10873>>CALLBLT
PROCNUM
      8466**DCL      9013<<ASSIGN   9359>>ASSIGN
PROC_LIT IN PROCEDURE NO_CHG
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:398  
     10747**DCL     10870>>CALLBLT
PRT IN PROCEDURE CHARGE_PRINT
      9753**DCL     10430--ASSIGN  10439<<ASSIGN
PRT.CONNECT# IN PROCEDURE CHARGE_PRINT
      9850**DCL     10493<>CALL
PRT.FACCESS# IN PROCEDURE CHARGE_PRINT
      9814**DCL     10515<>CALL
PRT.FCLOCK# IN PROCEDURE CHARGE_PRINT
      9837**DCL     10511<>CALL
PRT.FCPU# IN PROCEDURE CHARGE_PRINT
      9830**DCL     10510<>CALL
PRT.FEPINT# IN PROCEDURE CHARGE_PRINT
      9803**DCL     10507<>CALL
PRT.FMOUNT# IN PROCEDURE CHARGE_PRINT
      9806**DCL     10518<>CALL
PRT.JSTEPS# IN PROCEDURE CHARGE_PRINT
      9799**DCL     10500<>CALL
PRT.OACCESS# IN PROCEDURE CHARGE_PRINT
      9818**DCL     10516<>CALL
PRT.OCLOCK# IN PROCEDURE CHARGE_PRINT
      9843**DCL     10513<>CALL
PRT.OCPU# IN PROCEDURE CHARGE_PRINT
      9834**DCL     10512<>CALL
PRT.OMOUNT# IN PROCEDURE CHARGE_PRINT
      9810**DCL     10519<>CALL
PRT.PERCENT# IN PROCEDURE CHARGE_PRINT
      9754**DCL     11123>>IF      11212>>IF
PRT.PEXEC# IN PROCEDURE CHARGE_PRINT
      9820**DCL     10489<>CALL
PRT.PMEM# IN PROCEDURE CHARGE_PRINT
      9846**DCL     10503<>CALL
PRT.PMMES# IN PROCEDURE CHARGE_PRINT
      9812**DCL     10502<>CALL
PRT.PSTIME# IN PROCEDURE CHARGE_PRINT
      9822**DCL     10491<>CALL
PRT.SUNIT.NAME# IN PROCEDURE CHARGE_PRINT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:399  
      9782**DCL     10523<>CALL
PRT.SUNIT.RATE# IN PROCEDURE CHARGE_PRINT
      9789**DCL     10523<>CALL
PRT.TACCESS# IN PROCEDURE CHARGE_PRINT
      9816**DCL     10514<>CALL
PRT.TCLOCK# IN PROCEDURE CHARGE_PRINT
      9840**DCL     10509<>CALL
PRT.TCPU# IN PROCEDURE CHARGE_PRINT
      9832**DCL     10508<>CALL
PRT.TINTER# IN PROCEDURE CHARGE_PRINT
      9801**DCL     10494<>CALL
PRT.TMOUNT# IN PROCEDURE CHARGE_PRINT
      9808**DCL     10517<>CALL
PRT.TPACK# IN PROCEDURE CHARGE_PRINT
      9852**DCL     10506<>CALL
PRT.UEXEC# IN PROCEDURE CHARGE_PRINT
      9825**DCL     10490<>CALL
PRT.UMEM# IN PROCEDURE CHARGE_PRINT
      9848**DCL     10504<>CALL
PRT.USTIME# IN PROCEDURE CHARGE_PRINT
      9827**DCL     10492<>CALL
PSTEP IN PROCEDURE CHARGE_PRINT
      9479**DCL     10411<<ASSIGN  10443<<ASSIGN
RATE IN PROCEDURE CHG
     11012**DCL     10998--PROC    11126<>CALL    11136<>CALL    11143<>CALL    11213<>CALL    11215<>CALL
RATES_OPN IN PROCEDURE CHARGE_PRINT
      9998**DCL     10366<<ASSIGN  10368<<ASSIGN  10375>>IF      10412>>IF      10552>>IF
REC
      8448**DCL      9161--ASSIGN   9165--ASSIGN   9169--ASSIGN   9241--ASSIGN   9246--ASSIGN  11783<<ASSIGN
     11783>>ASSIGN  11786<<ASSIGN  11786>>ASSIGN
REC$
      8450**DCL      6265--IMP-PTR  7838--IMP-PTR  9017>>IF       9020>>ASSIGN   9073>>ASSIGN   9074>>IF
      9161<<ASSIGN   9162>>ASSIGN   9163>>ASSIGN   9163>>ASSIGN   9164>>ASSIGN   9165>>ASSIGN   9166>>CALL
      9168>>ASSIGN   9169>>ASSIGN   9170>>ASSIGN   9171>>ASSIGN   9172>>ASSIGN   9173>>ASSIGN   9174>>ASSIGN
      9175>>ASSIGN   9176>>ASSIGN   9177>>ASSIGN   9178>>ASSIGN   9180>>ASSIGN   9181>>ASSIGN   9182>>ASSIGN
      9183>>ASSIGN   9184>>ASSIGN   9185>>ASSIGN   9185>>ASSIGN   9186>>ASSIGN   9187>>ASSIGN   9188>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:400  
      9189>>ASSIGN   9190>>ASSIGN   9191>>ASSIGN   9192>>ASSIGN   9193>>ASSIGN   9194>>ASSIGN   9195>>ASSIGN
      9196>>ASSIGN   9197>>ASSIGN   9198>>ASSIGN   9199>>ASSIGN   9202>>ASSIGN   9202>>ASSIGN   9213>>ASSIGN
      9241<<ASSIGN   9302--IMP-PTR  9342>>ASSIGN   9350>>IF       9356>>ASSIGN   9357>>IF      10395>>ASSIGN
     10409>>IF      10417>>CALLBLT 10418>>ASSIGN  10433>>ASSIGN  10447>>DOCASE  10488>>CALL    10488>>CALL
     10488>>CALL    10488>>CALL    10489>>CALL    10490>>CALL    10491>>CALL    10492>>CALL    10493>>CALL
     10494>>CALL    10495>>IF      10497>>IF      10499>>ASSIGN  10502>>CALL    10503>>CALL    10504>>CALL
     10505>>IF      10506>>CALL    10507>>CALL    10508>>CALL    10509>>CALL    10510>>CALL    10511>>CALL
     10512>>CALL    10513>>CALL    10514>>CALL    10515>>CALL    10516>>CALL    10517>>CALL    10518>>CALL
     10519>>CALL    10520>>IF      10522>>ASSIGN  10525>>IF      10527>>ASSIGN  10535>>ASSIGN  10546>>ASSIGN
     10546>>ASSIGN  10551>>DOINDEX 10570>>ASSIGN  10570>>ASSIGN  10622>>CALLBLT 10622>>CALLBLT 10626>>IF
     10630>>CALLBLT 10633>>IF      10635>>CALLBLT 10644>>ASSIGN  10647>>ASSIGN  10650>>ASSIGN  10650>>ASSIGN
     10655>>ASSIGN  10655>>ASSIGN  10660>>CALLBLT 10662>>CALLBLT 10662>>CALLBLT 10674>>ASSIGN  10674>>ASSIGN
     10674>>ASSIGN  10769>>ASSIGN  10769>>ASSIGN  10783>>ASSIGN  10787>>DOWHILE 10790>>CALLBLT 10790>>CALLBLT
     10792>>ASSIGN  10794>>CALLBLT 10802>>IF      10804>>CALLBLT 10804>>CALLBLT 10814>>ASSIGN  10818>>IF
     10821>>CALLBLT 10830>>IF      10832>>IF      10836>>ASSIGN  10840>>CALLBLT 10850>>ASSIGN  10853>>CALLBLT
     10864>>ASSIGN  10866>>ASSIGN  10869>>IF      10870>>CALLBLT 10870>>CALLBLT 10872>>IF      10873>>CALLBLT
     10873>>CALLBLT 10882>>CALLBLT 10885>>CALLBLT 10893>>IF      10897>>CALLBLT 10901>>IF      10901>>IF
     10914>>IF      10918>>CALLBLT 10921>>IF      10927>>IF      10946>>IF      10949>>CALLBLT 10958>>IF
     10961>>IF      10963>>ASSIGN  10974>>IF      10976>>ASSIGN  11111>>IF      11111>>IF      11111>>IF
     11111>>IF      11111>>IF      11120>>IF      11133>>IF      11147>>ASSIGN  11150>>ASSIGN  11150>>ASSIGN
     11151>>ASSIGN  11151>>ASSIGN  11169>>IF      11169>>IF      11208>>IF      11208>>IF      11211>>IF
     11585>>ASSIGN  11586>>CALL    11586>>CALL    11586>>CALL    11587>>IF      11588>>ASSIGN  11588>>ASSIGN
     11603>>ASSIGN  11605>>ASSIGN  11606>>ASSIGN  11607>>ASSIGN  11608>>ASSIGN  11609>>ASSIGN  11610>>ASSIGN
     11611>>ASSIGN  11612>>ASSIGN  11613>>ASSIGN  11614>>ASSIGN  11615>>ASSIGN  11616>>ASSIGN  11617>>ASSIGN
     11618>>ASSIGN  11619>>ASSIGN  11620>>ASSIGN  11621>>ASSIGN  11622>>ASSIGN  11623>>ASSIGN  11624>>ASSIGN
     11665>>CALL    11665>>CALL    11665>>CALL    11677>>ASSIGN  11678>>ASSIGN  11679>>ASSIGN  11680>>ASSIGN
     11681>>ASSIGN  11681>>ASSIGN  11682>>CALL    11683>>ASSIGN  11683>>ASSIGN  11684>>ASSIGN  11684>>ASSIGN
     11685>>ASSIGN  11685>>ASSIGN  11686>>ASSIGN  11686>>ASSIGN  11687>>ASSIGN  11687>>ASSIGN  11688>>ASSIGN
     11688>>ASSIGN  11689>>ASSIGN  11689>>ASSIGN  11690>>ASSIGN  11690>>ASSIGN  11691>>ASSIGN  11691>>ASSIGN
     11692>>ASSIGN  11692>>ASSIGN  11693>>ASSIGN  11693>>ASSIGN  11694>>ASSIGN  11694>>ASSIGN  11695>>ASSIGN
     11695>>ASSIGN  11696>>ASSIGN  11696>>ASSIGN  11697>>ASSIGN  11697>>ASSIGN  11698>>ASSIGN  11698>>ASSIGN
     11699>>ASSIGN  11699>>ASSIGN  11700>>ASSIGN  11700>>ASSIGN  11701>>ASSIGN  11701>>ASSIGN  11702>>ASSIGN
     11702>>ASSIGN  11704>>ASSIGN  11704>>ASSIGN  11706>>IF      11708>>ASSIGN  11709>>ASSIGN  11710>>ASSIGN
     11712>>IF      11713>>ASSIGN  11713>>ASSIGN  11730>>ASSIGN  11730>>ASSIGN  11731>>CALL    11732>>ASSIGN
     11732>>ASSIGN  11733>>ASSIGN  11733>>ASSIGN  11734>>ASSIGN  11734>>ASSIGN  11735>>ASSIGN  11735>>ASSIGN
     11736>>ASSIGN  11736>>ASSIGN  11737>>ASSIGN  11737>>ASSIGN  11738>>ASSIGN  11738>>ASSIGN  11739>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:401  
     11739>>ASSIGN  11740>>ASSIGN  11740>>ASSIGN  11741>>ASSIGN  11741>>ASSIGN  11742>>ASSIGN  11742>>ASSIGN
     11743>>ASSIGN  11743>>ASSIGN  11744>>ASSIGN  11744>>ASSIGN  11745>>ASSIGN  11745>>ASSIGN  11746>>ASSIGN
     11746>>ASSIGN  11747>>ASSIGN  11747>>ASSIGN  11748>>ASSIGN  11748>>ASSIGN  11749>>ASSIGN  11749>>ASSIGN
     11750>>ASSIGN  11750>>ASSIGN  11751>>ASSIGN  11751>>ASSIGN  11753>>ASSIGN  11753>>ASSIGN  11755>>IF
     11756>>ASSIGN  11756>>ASSIGN  11809>>ASSIGN  11809>>ASSIGN  11814>>DOWHILE 11821>>IF      11821>>IF
     11823>>IF      11824>>ASSIGN  11825>>ASSIGN  11828>>IF      11829>>ASSIGN  11829>>ASSIGN  11830>>IF
     11831>>ASSIGN  11831>>ASSIGN  11833>>IF      11835>>ASSIGN  11836>>ASSIGN  11836>>ASSIGN  11838>>ASSIGN
     11838>>ASSIGN  11857>>ASSIGN  11860>>ASSIGN  11860>>ASSIGN  11861>>ASSIGN  11861>>ASSIGN  11862>>ASSIGN
     11862>>ASSIGN  11885>>ASSIGN  11885>>ASSIGN  11890>>DOWHILE 11899>>IF      11901>>CALL    11901>>CALL
     11901>>CALL    11903>>ASSIGN  11903>>ASSIGN  11905>>IF      11907>>ASSIGN  11907>>ASSIGN  11908>>ASSIGN
     11908>>ASSIGN  11910>>ASSIGN  11910>>ASSIGN  11928>>ASSIGN  11931>>ASSIGN  11931>>ASSIGN  11932>>ASSIGN
     11932>>ASSIGN  11955>>ASSIGN  11955>>ASSIGN  11960>>DOWHILE 11967>>IF      11969>>ASSIGN  11969>>ASSIGN
     11969>>ASSIGN  11971>>ASSIGN  11971>>ASSIGN  11973>>ASSIGN  11973>>ASSIGN  11987>>ASSIGN  11990>>ASSIGN
     11990>>ASSIGN  12183>>CALLBLT 12183>>CALLBLT 12195>>ASSIGN  12199>>ASSIGN  12272>>ASSIGN  12274>>ASSIGN
     12275>>ASSIGN  12276>>ASSIGN  12277>>ASSIGN  12278>>ASSIGN  12281>>IF
REC$ORD IN PROCEDURE SEND_REC
      9302**DCL      9342--ASSIGN
REC1
      8449**DCL      9001--ASSIGN   9002<<ASSIGN   9012--ASSIGN   9157--ASSIGN   9158<<ASSIGN   9242--ASSIGN
      9278--IF
REC1$
      8451**DCL      6815--IMP-PTR  7645--IMP-PTR  9159<<ASSIGN   9160>>ASSIGN   9164>>ASSIGN   9170>>ASSIGN
      9171>>ASSIGN   9172>>ASSIGN   9173>>ASSIGN   9174>>ASSIGN   9175>>ASSIGN   9176>>ASSIGN   9177>>ASSIGN
      9178>>ASSIGN   9179>>IF       9179>>IF       9180>>ASSIGN   9181>>ASSIGN   9182>>ASSIGN   9183>>ASSIGN
      9184>>ASSIGN   9184>>ASSIGN   9187>>ASSIGN   9188>>ASSIGN   9189>>ASSIGN   9190>>ASSIGN   9191>>ASSIGN
      9192>>ASSIGN   9193>>ASSIGN   9194>>ASSIGN   9195>>ASSIGN   9196>>ASSIGN   9196>>ASSIGN   9197>>ASSIGN
      9198>>ASSIGN   9199>>ASSIGN   9199>>ASSIGN   9201>>IF       9242<<ASSIGN  11605>>ASSIGN  11606>>ASSIGN
     11607>>ASSIGN  11608>>ASSIGN  11609>>ASSIGN  11610>>ASSIGN  11611>>ASSIGN  11612>>ASSIGN  11613>>ASSIGN
     11614>>ASSIGN  11615>>ASSIGN  11616>>ASSIGN  11617>>ASSIGN  11618>>ASSIGN  11619>>ASSIGN  11620>>ASSIGN
     11621>>ASSIGN  11622>>ASSIGN  11623>>ASSIGN  11624>>ASSIGN  11677>>ASSIGN  11678>>ASSIGN  11679>>ASSIGN
     11680>>ASSIGN  11681>>ASSIGN  11682>>CALL    11683>>ASSIGN  11684>>ASSIGN  11685>>ASSIGN  11686>>ASSIGN
     11687>>ASSIGN  11688>>ASSIGN  11689>>ASSIGN  11690>>ASSIGN  11691>>ASSIGN  11692>>ASSIGN  11693>>ASSIGN
     11694>>ASSIGN  11695>>ASSIGN  11696>>ASSIGN  11697>>ASSIGN  11698>>ASSIGN  11699>>ASSIGN  11700>>ASSIGN
     11701>>ASSIGN  11702>>ASSIGN  11704>>ASSIGN  11708>>ASSIGN  11709>>ASSIGN  11710>>ASSIGN  11713>>ASSIGN
     11714>>IF      11715>>IF      11716>>IF      11730>>ASSIGN  11731>>CALL    11732>>ASSIGN  11733>>ASSIGN
     11734>>ASSIGN  11735>>ASSIGN  11736>>ASSIGN  11737>>ASSIGN  11738>>ASSIGN  11739>>ASSIGN  11740>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:402  
     11741>>ASSIGN  11742>>ASSIGN  11743>>ASSIGN  11744>>ASSIGN  11745>>ASSIGN  11746>>ASSIGN  11747>>ASSIGN
     11748>>ASSIGN  11749>>ASSIGN  11750>>ASSIGN  11751>>ASSIGN  11753>>ASSIGN  11756>>ASSIGN  11757>>IF
     11758>>IF      11759>>IF      11810>>ASSIGN  11810>>ASSIGN  11811>>DOINDEX 11886>>ASSIGN  11886>>ASSIGN
     11887>>DOINDEX 11956>>ASSIGN  11956>>ASSIGN  11957>>DOINDEX
RECLEN
      8452**DCL      9247--ASSIGN   9302--IMP-SIZ  9342>>ASSIGN  11604<<ASSIGN  11826>>CALL    11839<<ASSIGN
     11839>>ASSIGN  11840>>IF      11858>>CALL    11859<<ASSIGN  11859>>ASSIGN  11901>>CALL    11911<<ASSIGN
     11911>>ASSIGN  11912>>IF      11929>>CALL    11930<<ASSIGN  11930>>ASSIGN  11974<<ASSIGN  11974>>ASSIGN
     11975>>IF      11988>>CALL    11989<<ASSIGN  11989>>ASSIGN
RELALT IN PROCEDURE INITIALIZE
      9235**LABEL    9233--CALLALT
RES IN PROCEDURE FILL_REC
     11376**DCL     11901--CALL    11903--ASSIGN  11911--ASSIGN  11917<<ASSIGN  11928--ASSIGN  11929--CALL
     11930--ASSIGN  11932--ASSIGN  11969--ASSIGN
RES.ATTR IN PROCEDURE FILL_REC
     11413**DCL     11923<<ASSIGN
RES.ATTR.MTWO IN PROCEDURE FILL_REC
     11420**DCL     11891>>IF
RES.CLOCK IN PROCEDURE FILL_REC
     11387**DCL     11924<<ASSIGN  11924>>ASSIGN  11926>>IF
RES.CPU IN PROCEDURE FILL_REC
     11393**DCL     11925<<ASSIGN  11925>>ASSIGN
RES.LOGNAME IN PROCEDURE FILL_REC
     11404**DCL     11891>>IF      11920<<ASSIGN
RES.PHYSNAME IN PROCEDURE FILL_REC
     11408**DCL     11922<<ASSIGN
RES.TYPE IN PROCEDURE FILL_REC
     11377**DCL     11891>>IF      11918<<ASSIGN
RES.WSN IN PROCEDURE FILL_REC
     11399**DCL     11891>>IF      11919<<ASSIGN
RES$ IN PROCEDURE FILL_REC
     11304**DCL     11376--IMP-PTR 11885<<ASSIGN  11891>>IF      11891>>IF      11891>>IF      11891>>IF
     11908<<ASSIGN  11917>>ASSIGN  11918>>ASSIGN  11919>>ASSIGN  11920>>ASSIGN  11922>>ASSIGN  11923>>ASSIGN
     11924>>ASSIGN  11924>>ASSIGN  11925>>ASSIGN  11925>>ASSIGN  11926>>IF
RES1.ATTR IN PROCEDURE FILL_REC
     11470**DCL     11923>>ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:403  
RES1.ATTR.MTWO IN PROCEDURE FILL_REC
     11477**DCL     11891>>IF
RES1.CLOCK IN PROCEDURE FILL_REC
     11444**DCL     11924>>ASSIGN
RES1.CPU IN PROCEDURE FILL_REC
     11450**DCL     11925>>ASSIGN
RES1.LOGNAME IN PROCEDURE FILL_REC
     11461**DCL     11891>>IF      11920>>ASSIGN
RES1.PHYSNAME IN PROCEDURE FILL_REC
     11465**DCL     11922>>ASSIGN
RES1.TYPE IN PROCEDURE FILL_REC
     11434**DCL     11891>>IF      11918>>ASSIGN
RES1.WSN IN PROCEDURE FILL_REC
     11456**DCL     11891>>IF      11919>>ASSIGN
RES1$ IN PROCEDURE FILL_REC
     11305**DCL     11433--IMP-PTR 11886<<ASSIGN  11891>>IF      11891>>IF      11891>>IF      11891>>IF
     11918>>ASSIGN  11919>>ASSIGN  11920>>ASSIGN  11922>>ASSIGN  11923>>ASSIGN  11924>>ASSIGN  11925>>ASSIGN
RESOURCES IN PROCEDURE FILL_REC
     11868**PROC    11715--CALL    11758--CALL
RNSTCVT.FEP
      8425**DCL      9201>>IF
RNSTCVT.HOST
      8435**DCL      9202>>ASSIGN
RNST_TBL IN PROCEDURE NO_CHG
     10751**DCL     10900--DOINDEX 10900--DOINDEX 10905--ASSIGN  10905--ASSIGN
RNST_TBL.LEN IN PROCEDURE NO_CHG
     10752**DCL     10903>>CALLBLT
RNST_TBL.MASK IN PROCEDURE NO_CHG
     10758**DCL     10901>>IF
RNST_TBL.TEXT IN PROCEDURE NO_CHG
     10754**DCL     10903>>CALLBLT
RT IN PROCEDURE CHARGE_PRINT
      9523**DCL     10393--ASSIGN  10404<<ASSIGN
RT.CMULT# IN PROCEDURE CHARGE_PRINT
      9565**DCL     10568<>CALL    10569<>CALL    10593<>CALL    10596<>CALL    11126<>CALL    11128<>CALL
     11136<>CALL    11143<>CALL    11213<>CALL    11214<>CALL    11215<>CALL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:404  
RT.CONNECT# IN PROCEDURE CHARGE_PRINT
      9620**DCL     10493<>CALL
RT.FACCESS# IN PROCEDURE CHARGE_PRINT
      9584**DCL     10515<>CALL
RT.FCLOCK# IN PROCEDURE CHARGE_PRINT
      9607**DCL     10511<>CALL
RT.FCPU# IN PROCEDURE CHARGE_PRINT
      9600**DCL     10510<>CALL
RT.FEPINT# IN PROCEDURE CHARGE_PRINT
      9573**DCL     10507<>CALL
RT.FMOUNT# IN PROCEDURE CHARGE_PRINT
      9576**DCL     10518<>CALL
RT.JSTEPS# IN PROCEDURE CHARGE_PRINT
      9569**DCL     10500<>CALL
RT.JUNIT.NAME# IN PROCEDURE CHARGE_PRINT
      9535**DCL     10536<>CALL
RT.JUNIT.RATE# IN PROCEDURE CHARGE_PRINT
      9542**DCL     10536<>CALL
RT.OACCESS# IN PROCEDURE CHARGE_PRINT
      9588**DCL     10516<>CALL
RT.OCLOCK# IN PROCEDURE CHARGE_PRINT
      9613**DCL     10513<>CALL
RT.OCPU# IN PROCEDURE CHARGE_PRINT
      9604**DCL     10512<>CALL
RT.OMOUNT# IN PROCEDURE CHARGE_PRINT
      9580**DCL     10519<>CALL
RT.PEXEC# IN PROCEDURE CHARGE_PRINT
      9590**DCL     10489<>CALL
RT.PMEM# IN PROCEDURE CHARGE_PRINT
      9616**DCL     10503<>CALL
RT.PMMES# IN PROCEDURE CHARGE_PRINT
      9582**DCL     10502<>CALL
RT.PSTIME# IN PROCEDURE CHARGE_PRINT
      9592**DCL     10491<>CALL
RT.SUNIT.NAME# IN PROCEDURE CHARGE_PRINT
      9552**DCL     10528<>CALL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:405  
RT.SUNIT.RATE# IN PROCEDURE CHARGE_PRINT
      9559**DCL     10528<>CALL
RT.TACCESS# IN PROCEDURE CHARGE_PRINT
      9586**DCL     10514<>CALL
RT.TCLOCK# IN PROCEDURE CHARGE_PRINT
      9610**DCL     10509<>CALL
RT.TCPU# IN PROCEDURE CHARGE_PRINT
      9602**DCL     10508<>CALL
RT.TINTER# IN PROCEDURE CHARGE_PRINT
      9571**DCL     10494<>CALL
RT.TMOUNT# IN PROCEDURE CHARGE_PRINT
      9578**DCL     10517<>CALL
RT.TPACK# IN PROCEDURE CHARGE_PRINT
      9622**DCL     10506<>CALL
RT.UEXEC# IN PROCEDURE CHARGE_PRINT
      9595**DCL     10490<>CALL
RT.UMEM# IN PROCEDURE CHARGE_PRINT
      9618**DCL     10504<>CALL
RT.USTIME# IN PROCEDURE CHARGE_PRINT
      9597**DCL     10492<>CALL
RT_DFLT IN PROCEDURE CHARGE_PRINT
      9638**DCL     10404>>ASSIGN  10439>>ASSIGN
SACCUM
      8455**DCL      9089>>IF       9093--ASSIGN   9281--ASSIGN   9289<<ASSIGN
SACCUM.PCHG
      8456**DCL     11111>>IF      11131<<ASSIGN  11131>>ASSIGN  11141>>ASSIGN
SACCUM.SUNIT
      8457**DCL     11111>>IF      11138<<ASSIGN  11138>>ASSIGN  11146>>ASSIGN
SACCUM_KEY
      8301**DCL      9094--ASSIGN   9280>>ASSIGN
SEND_REC
      9293**PROC     9024--CALL     9060--CALL
SET_ALT
      9143**LABEL    9131--CALLALT  9141--CALLALT
SN_SAVE
      8884**DCL      9139--ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:406  
SN_SAVE.NUM#
      8884**DCL     12408<<ASSIGN
SN_SAVE.SN#
      8884**DCL     12409<<ASSIGN
STARS_KEY IN PROCEDURE SEND_REC
      9309**DCL      9347--ASSIGN   9348--ASSIGN
STARS_KEY.ACCT IN PROCEDURE SEND_REC
      9312**DCL      9349<<ASSIGN
STARS_KEY.AREC_TYPE IN PROCEDURE SEND_REC
      9311**DCL      9312--REDEF
STARS_KEY.LEN IN PROCEDURE SEND_REC
      9310**DCL      9348<<ASSIGN
STARS_KEY.NUM IN PROCEDURE SEND_REC
      9326**DCL      9353<<ASSIGN   9358<<ASSIGN   9359<<ASSIGN
STARS_KEY.STEP IN PROCEDURE SEND_REC
      9320**DCL      9352<<ASSIGN   9356<<ASSIGN
STARS_NAME
      8329**DCL      9119--ASSIGN
STATSLEV IN PROCEDURE CHARGE_PRINT
      9460**DCL     10449<<ASSIGN  10451<<ASSIGN  10453<<ASSIGN  10455<<ASSIGN  10460>>IF      10482>>IF
     10571>>IF      10615>>DOCASE  11152>>IF
STRIP_TIME IN PROCEDURE CHARGE_PRINT
     11254**PROC    10868--CALL    11201--CALL
SUB_EM IN PROCEDURE FILL_REC
     11721**PROC    11636--CALL
SUDO IN PROCEDURE FILL_REC
     11314**DCL     11826--CALL    11829--ASSIGN  11831--ASSIGN  11839--ASSIGN  11848<<ASSIGN  11857--ASSIGN
     11858--CALL    11859--ASSIGN  11861--ASSIGN  11862--ASSIGN  11907--ASSIGN  11969--ASSIGN
SUDO.CLOCK IN PROCEDURE FILL_REC
     11331**DCL     11854<<ASSIGN  11854>>ASSIGN  11855>>IF
SUDO.CPU IN PROCEDURE FILL_REC
     11325**DCL     11853<<ASSIGN  11853>>ASSIGN
SUDO.MAX IN PROCEDURE FILL_REC
     11319**DCL     11851>>IF      11852<<ASSIGN
SUDO.NAM IN PROCEDURE FILL_REC
     11315**DCL     11815>>IF      11850<<ASSIGN
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:407  
SUDO.MAX IN PROCEDURE NO_CHG
     10721**DCL     10968>>CALLBLT 10982>>CALLBLT
SUDO.NAM IN PROCEDURE NO_CHG
     10717**DCL     10966>>ASSIGN  10980>>ASSIGN
SUDO$ IN PROCEDURE FILL_REC
     11302**DCL     11314--IMP-PTR 11809<<ASSIGN  11815>>IF      11836<<ASSIGN  11848>>ASSIGN  11850>>ASSIGN
     11851>>IF      11852>>ASSIGN  11853>>ASSIGN  11853>>ASSIGN  11854>>ASSIGN  11854>>ASSIGN  11855>>IF
SUDO$ IN PROCEDURE NO_CHG
     10741**DCL     10716--IMP-PTR 10769<<ASSIGN  10966>>ASSIGN  10968>>CALLBLT 10980>>ASSIGN  10982>>CALLBLT
SUDO1.CLOCK IN PROCEDURE FILL_REC
     11362**DCL     11854>>ASSIGN
SUDO1.CPU IN PROCEDURE FILL_REC
     11356**DCL     11853>>ASSIGN
SUDO1.MAX IN PROCEDURE FILL_REC
     11350**DCL     11851>>IF      11852>>ASSIGN
SUDO1.NAM IN PROCEDURE FILL_REC
     11346**DCL     11815>>IF      11850>>ASSIGN
SUDO1$ IN PROCEDURE FILL_REC
     11303**DCL     11345--IMP-PTR 11810<<ASSIGN  11815>>IF      11850>>ASSIGN  11851>>IF      11852>>ASSIGN
     11853>>ASSIGN  11854>>ASSIGN
SUDOS IN PROCEDURE FILL_REC
     11791**PROC    11714--CALL    11757--CALL
SUM_TEMPLATE IN PROCEDURE CHARGE_PRINT
      9474**DCL     10643>>ASSIGN
SZ_ALT IN PROCEDURE RESOURCES
     11914**LABEL   11901--CALLALT
SZ_ALT IN PROCEDURE SUDOS
     11842**LABEL   11826--CALLALT
S_ALT IN PROCEDURE INITIALIZE
      9283**LABEL    9279--CALLALT  9283--CALLALT
S_NONE IN PROCEDURE INITIALIZE
      9289**LABEL    9278--GOTO
T IN PROCEDURE CHARGE_PRINT
      9477**DCL     10498<<ASSIGN  10499<<ASSIGN  10500<>CALL    10522<<ASSIGN  10523<>CALL    10527<<ASSIGN
     10528<>CALL    10535<<ASSIGN  10536<>CALL    10647<<ASSIGN  10648>>CALLBLT 10653<<ASSIGN  10654>>CALLBLT
     10658<<ASSIGN  10659>>CALLBLT
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:408  
T IN PROCEDURE NO_CHG
     10744**DCL     10866<<ASSIGN  10867>>CALLBLT
T1 IN PROCEDURE CHARGE_PRINT
      9489**DCL     10593<>CALL    10594>>CALLBLT 10596<>CALL    10597>>CALLBLT 10599<<ASSIGN  10600>>IF
     10602>>CALLBLT 10649--ASSIGN  10650<<ASSIGN  10653>>ASSIGN  10655<<ASSIGN  10658>>ASSIGN  11213<>CALL
     11214<>CALL    11215<>CALL    11217>>CALLBLT
TEMP
      8465**DCL      9200<<DOINDEX  9201>>IF       9202>>ASSIGN   9204<<ASSIGN   9205<<ASSIGN   9206>>ASSIGN
      9207>>ASSIGN   9208>>ASSIGN
TEMP$ IN PROCEDURE NO_CHG
     10742**DCL     10924<<ASSIGN  10925>>ASSIGN  10929>>IF      10931>>CALLBLT 10932<<ASSIGN  10932>>ASSIGN
     10934>>CALLBLT 10936<<ASSIGN  10936>>ASSIGN
TEMP1 IN PROCEDURE CHG
     11099**DCL     11176<>CALL    11177<>CALL    11181<<ASSIGN  11182>>DOWHILE 11183<<ASSIGN  11183>>ASSIGN
     11185>>ASSIGN  11190>>CALLBLT 11192>>CALLBLT
TEMP1$ IN PROCEDURE NO_CHG
     10743**DCL     10925<<ASSIGN  10929>>IF
TEXT$C
      7856**DCL      9421>>IF       9421>>IF
TEXT$C.LEN
      7857**DCL      7858--IMP-SIZ  9421>>IF       9421>>IF
TIME$ IN PROCEDURE STRIP_TIME
     11264**DCL     11254--PROC    11266--IMP-PTR 11269>>DOWHILE 11269>>DOWHILE 11270>>ASSIGN
TOFALT IN PROCEDURE NO_CHG
     10776**LABEL   10775--CALLALT
TOF_VFC IN PROCEDURE NO_CHG
     10750**DCL     10773--ASSIGN
TOO IN PROCEDURE MOVE
     11776**DCL     11764--PROC    11779>>IF      11779>>IF      11781>>IF      11783>>ASSIGN  11786>>ASSIGN
UP_USERS
     11997**PROC     9053--CALL     9212--CALL
VLP_PSEUDO
      8497**DCL      9229<<ASSIGN   9232--ASSIGN
VLP_PSEUDO.MEMORY#
      8497**DCL      9230<<ASSIGN
VLR_NODEINFO
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:409  
      7850**DCL      9165--ASSIGN
VLR_NODEINFO.NODENAME#
      7850**DCL      9169>>ASSIGN
WRITE_ALT IN PROCEDURE CHG
     11249**LABEL   11198--CALLALT 11247--CALLALT
WRITE_ALT IN PROCEDURE OUT_PGRANS
     12373**LABEL   12368--CALLALT 12371--CALLALT
WR_ALT IN PROCEDURE CHARGE_PRINT
     10669**LABEL   10579--CALLALT 10608--CALLALT 10620--CALLALT 10641--CALLALT 10646--CALLALT 10652--CALLALT
     10657--CALLALT 10666--CALLALT
WR_ALT IN PROCEDURE NO_CHG
     10992**LABEL   10785--CALLALT 10798--CALLALT 10808--CALLALT 10817--CALLALT 10826--CALLALT 10837--CALLALT
     10844--CALLALT 10851--CALLALT 10857--CALLALT 10865--CALLALT 10877--CALLALT 10889--CALLALT 10910--CALLALT
     10942--CALLALT 10952--CALLALT 10973--CALLALT 10988--CALLALT
WR_JOBSTATS
     12218**PROC     9056--CALL
WR_SECLOG
      8958**DCL      9049<<ASSIGN   9052<>CALL
WR_SECLOG.ENTRY_
      8958**DCL      9051<<ASSIGN
WR_SECLOG.V
      8958**DCL      9050--ASSIGN
WR_SECLOG.V_
      8958**DCL      9050<<ASSIGN
WR_SECLOG_CONST
      8345**DCL      9049>>ASSIGN
WR_SECLOG_CONST.V
      8345**DCL      8345--DCLINIT
XLIM_TBL IN PROCEDURE NO_CHG
     10761**DCL     10926--DOINDEX 10926--DOINDEX
XLIM_TBL.HDR IN PROCEDURE NO_CHG
     10764**DCL     10934>>CALLBLT
XLIM_TBL.LEN IN PROCEDURE NO_CHG
     10762**DCL     10934>>CALLBLT 10936>>ASSIGN
XLIM_TBL.MASK IN PROCEDURE NO_CHG
     10766**DCL     10927>>IF
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:410  
XSJ$OPEN
      8977**DCL-ENT  9436--CALL
XSJ$WRITE
      8978**DCL-ENT 12284--CALL
XSJ_JOBINFO IN PROCEDURE WR_JOBSTATS
     12265**DCL     12273--ASSIGN
XSJ_JOBINFO.ACCT# IN PROCEDURE WR_JOBSTATS
     12267**DCL     12278<<ASSIGN
XSJ_JOBINFO.FRS# IN PROCEDURE WR_JOBSTATS
     12265**DCL     12274<<ASSIGN
XSJ_JOBINFO.OFF_TIME# IN PROCEDURE WR_JOBSTATS
     12266**DCL     12275<<ASSIGN
XSJ_JOBINFO.STATUS# IN PROCEDURE WR_JOBSTATS
     12266**DCL     12280<<ASSIGN  12282<<ASSIGN  12283<<ASSIGN
XSJ_JOBINFO.STEPCC# IN PROCEDURE WR_JOBSTATS
     12265**DCL     12277<<ASSIGN
XSJ_JOBINFO.XLIMFLG# IN PROCEDURE WR_JOBSTATS
     12265**DCL     12276<<ASSIGN
XSJ_PARAM IN PROCEDURE OPEN_FILE
      9414**DCL      9434<<ASSIGN   9436<>CALL
XSJ_PARAM.DCB# IN PROCEDURE OPEN_FILE
      9417**DCL      9435<<ASSIGN
XSJ_PARAM IN PROCEDURE WR_JOBSTATS
     12248**DCL     12270<<ASSIGN  12284<>CALL
XSJ_PARAM.BUF_ IN PROCEDURE WR_JOBSTATS
     12248**DCL     12273<<ASSIGN
XSJ_PARAM.DCB# IN PROCEDURE WR_JOBSTATS
     12251**DCL     12271<<ASSIGN
XSJ_PARAM.SYSID# IN PROCEDURE WR_JOBSTATS
     12251**DCL     12272<<ASSIGN
XSJ_PARAMC IN PROCEDURE OPEN_FILE
      9397**DCL      9434>>ASSIGN
XSJ_PARAMC IN PROCEDURE WR_JOBSTATS
     12231**DCL     12270>>ASSIGN
XUD$UTS_DIFF
      5755**DCL-ENT 11586--CALL    11665--CALL
PL6.E3A0      #001=AZA$LOGOFF File=AZA$LOGOFF.:E05TSI                            TUE 07/29/97 11:02 Page:411  
ZERO IN PROCEDURE CHARGE_PRINT
      9509**DCL     11192>>CALLBLT 11192>>CALLBLT

PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:412  
     2302        1        /*T***********************************************************/
     2303        2        /*T*                                                         */
     2304        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2305        4        /*T*                                                         */
     2306        5        /*T***********************************************************/
     2307        6        AZA$FLTTODEC: PROC(FLT,DEC) ALTRET;
     2308        7        /*D* NAME:        AZA$FLTTODEC
     2309        8             PURPOSE:     To convert a 1-word REAL value to a 3-word DECIMAL value
     2310        9             CALL:        CALL AZA$FLTTODEC(FLT,DEC) ALTRET(LBL);
     2311       10                             where: FLT is a 1-word REAL value
     2312       11                                    DEC is a 3-word DECIMAL value
     2313       12             DESCRIPTION: FLT is converted from a 1-word REAL floating point value
     2314       13                          into a 3-word unpacked DECIMAL floating point value. This
     2315       14                          value is stored into DEC. If something is wrong with
     2316       15                          FLT, this procedure will ALTRET.
     2317       16        */
     2318       17    1   DCL FLT BIT(36) ALIGNED;
     2319       18    1   DCL 1 DEC,
     2320       19    1         2 SIGN CHAR(1) UNAL,
     2321       20    1         2 DIGITS CHAR(10) UNAL,
     2322       21    1         2 ZERO BIT(1) UNAL,
     2323       22    1         2 EXP SBIN(8) UNAL;
     2324       23    1   DCL 1 CHAR11,
     2325       24    1         2 SIGN CHAR(1) UNAL,
     2326       25    1         2 DIGITS CHAR(10) UNAL;
     2327       26    1   DCL DIGITS SBIN;
     2328       27    1   DCL POWER SBIN;
     2329       28    1   DCL ZERO CHAR(10) CONSTANT INIT('0000000000');
     2330       29    1   DCL XPN_7RTOLS ENTRY(5) ALTRET;
     2331       30        %EJECT;
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:413  
     2332       31    1      CALL XPN_7RTOLS(FLT,CHAR11,10,DIGITS,POWER) ALTRET(JUSTALT);
     2333       32    1      DEC.SIGN = CHAR11.SIGN;
     2334       33    1      CALL CONCAT(DEC.DIGITS,
     2335       34    1        SUBSTR(ZERO,0,10-DIGITS),
     2336       35    1        SUBSTR(CHAR11.DIGITS,0,DIGITS));
     2337       36    1      DEC.ZERO = '0'B;
     2338       37    1      DEC.EXP = POWER;
     2339       38    1      RETURN;
     2340       39    1   JUSTALT: ALTRETURN;
     2341       40    1   END AZA$FLTTODEC;

PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:414  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure AZA$FLTTODEC.

   Procedure AZA$FLTTODEC requires 43 words for executable code.
   Procedure AZA$FLTTODEC requires 16 words of local(AUTO) storage.

    No errors detected in file AZA$LOGOFF.:E05TSI    .

PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:415  

 Object Unit name= AZA$FLTTODEC                               File name= AZA$LOGOFF.:E05TOU
 UTS= JUL 29 '97 11:04:18.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      3      3  AZA$FLTTODEC
    1   Proc  even  none    43     53  AZA$FLTTODEC
    2  RoData even  none     1      1  AZA$FLTTODEC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  AZA$FLTTODEC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       5 XPN_7RTOLS
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:416  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:417  


     2302        1        /*T***********************************************************/
     2303        2        /*T*                                                         */
     2304        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2305        4        /*T*                                                         */
     2306        5        /*T***********************************************************/
     2307        6        AZA$FLTTODEC: PROC(FLT,DEC) ALTRET;

      6  1 000000   000000 700200 xent  AZA$FLTTODEC TSX0  ! X66_AUTO_2
         1 000001   000020 000002                    ZERO    16,2

     2308        7        /*D* NAME:        AZA$FLTTODEC
     2309        8             PURPOSE:     To convert a 1-word REAL value to a 3-word DECIMAL value
     2310        9             CALL:        CALL AZA$FLTTODEC(FLT,DEC) ALTRET(LBL);
     2311       10                             where: FLT is a 1-word REAL value
     2312       11                                    DEC is a 3-word DECIMAL value
     2313       12             DESCRIPTION: FLT is converted from a 1-word REAL floating point value
     2314       13                          into a 3-word unpacked DECIMAL floating point value. This
     2315       14                          value is stored into DEC. If something is wrong with
     2316       15                          FLT, this procedure will ALTRET.
     2317       16        */
     2318       17    1   DCL FLT BIT(36) ALIGNED;
     2319       18    1   DCL 1 DEC,
     2320       19    1         2 SIGN CHAR(1) UNAL,
     2321       20    1         2 DIGITS CHAR(10) UNAL,
     2322       21    1         2 ZERO BIT(1) UNAL,
     2323       22    1         2 EXP SBIN(8) UNAL;
     2324       23    1   DCL 1 CHAR11,
     2325       24    1         2 SIGN CHAR(1) UNAL,
     2326       25    1         2 DIGITS CHAR(10) UNAL;
     2327       26    1   DCL DIGITS SBIN;
     2328       27    1   DCL POWER SBIN;
     2329       28    1   DCL ZERO CHAR(10) CONSTANT INIT('0000000000');
     2330       29    1   DCL XPN_7RTOLS ENTRY(5) ALTRET;
     2331       30        %EJECT;
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:418  
     2332       31    1      CALL XPN_7RTOLS(FLT,CHAR11,10,DIGITS,POWER) ALTRET(JUSTALT);

     31  1 000002   200011 630500                    EPPR0   POWER,,AUTO
         1 000003   200016 450500                    STP0    POWER+5,,AUTO
         1 000004   200010 631500                    EPPR1   DIGITS,,AUTO
         1 000005   200015 451500                    STP1    POWER+4,,AUTO
         1 000006   000000 236000 2                  LDQ     0
         1 000007   200014 756100                    STQ     POWER+3,,AUTO
         1 000010   200005 633500                    EPPR3   CHAR11,,AUTO
         1 000011   200013 453500                    STP3    POWER+2,,AUTO
         1 000012   200003 236100                    LDQ     @FLT,,AUTO
         1 000013   200012 756100                    STQ     POWER+1,,AUTO
         1 000014   200012 630500                    EPPR0   POWER+1,,AUTO
         1 000015   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000016   000000 701000 xent               TSX1    XPN_7RTOLS
         1 000017   000052 702000 1                  TSX2    JUSTALT

     2333       32    1      DEC.SIGN = CHAR11.SIGN;

     32  1 000020   200004 470500                    LDP0    @DEC,,AUTO
         1 000021   040100 100500                    MLR     fill='040'O
         1 000022   200005 000001                    ADSC9   CHAR11,,AUTO             cn=0,n=1
         1 000023   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     2334       33    1      CALL CONCAT(DEC.DIGITS,

     33  1 000024   200010 720100                    LXL0    DIGITS,,AUTO
         1 000025   777765 620010                    EAX0    -11,X0
         1 000026   777777 660003                    ERX0    -1,DU
         1 000027   040100 100440                    MLR     fill='040'O
         1 000030   000000 000010 0                  ADSC9   ZERO                     cn=0,n=*X0
         1 000031   000000 200012                    ADSC9   0,,PR0                   cn=1,n=10
         1 000032   200010 236100                    LDQ     DIGITS,,AUTO
         1 000033   000000 116003                    CMPQ    0,DU
         1 000034   000043 604400 1                  TMOZ    s:36
         1 000035   200010 335100                    LCA     DIGITS,,AUTO
         1 000036   000000 620006                    EAX0    0,QL
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:419  
         1 000037   200010 721100                    LXL1    DIGITS,,AUTO
         1 000040   040145 100540                    MLR     fill='040'O
         1 000041   200005 200010                    ADSC9   CHAR11,,AUTO             cn=1,n=*X0
         1 000042   000002 600011                    ADSC9   2,A,PR0                  cn=3,n=*X1

     2335       34    1        SUBSTR(ZERO,0,10-DIGITS),
     2336       35    1        SUBSTR(CHAR11.DIGITS,0,DIGITS));
     2337       36    1      DEC.ZERO = '0'B;

     36  1 000043   003100 060400                    CSL     bolr='003'O
         1 000044   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 000045   000002 600001                    BDSC    2,,PR0                   by=3,bit=0,n=1

     2338       37    1      DEC.EXP = POWER;

     37  1 000046   003100 061500                    CSR     bolr='003'O
         1 000047   200011 000044                    BDSC    POWER,,AUTO              by=0,bit=0,n=36
         1 000050   000002 610010                    BDSC    2,,PR0                   by=3,bit=1,n=8

     2339       38    1      RETURN;

     38  1 000051   000000 702200 xent               TSX2  ! X66_ARET

     2340       39    1   JUSTALT: ALTRETURN;

     39  1 000052   000000 702200 xent  JUSTALT      TSX2  ! X66_AALT
     2341       40    1   END AZA$FLTTODEC;

PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:420  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure AZA$FLTTODEC.
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:421  

 **** Variables and constants ****

  ****  Section 000 RoData AZA$FLTTODEC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)    r     1 ZERO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DEC                       3-0-0/w PTR         r     1 @FLT
     5-0-0/c STRC(99)    r     1 CHAR11                    *0-0-0/c STRC(108)   r     1 DEC
    10-0-0/w SBIN        r     1 DIGITS                    *0-0-0/w BIT         r     1 FLT
    11-0-0/w SBIN        r     1 POWER


   Procedure AZA$FLTTODEC requires 43 words for executable code.
   Procedure AZA$FLTTODEC requires 16 words of local(AUTO) storage.

    No errors detected in file AZA$LOGOFF.:E05TSI    .
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:422  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=AZA$FLTTODEC File=AZA$LOGOFF.:E05TSI                          TUE 07/29/97 11:04 Page:423  
          MINI XREF LISTING

CHAR11
        23**DCL        31<>CALL
CHAR11.DIGITS
        25**DCL        33>>CALLBLT
CHAR11.SIGN
        24**DCL        32>>ASSIGN
DEC
        18**DCL         6--PROC
DEC.DIGITS
        20**DCL        33<<CALLBLT
DEC.EXP
        22**DCL        37<<ASSIGN
DEC.SIGN
        19**DCL        32<<ASSIGN
DEC.ZERO
        21**DCL        36<<ASSIGN
DIGITS
        26**DCL        31<>CALL       33>>CALLBLT    33>>CALLBLT
FLT
        17**DCL         6--PROC       31<>CALL
JUSTALT
        39**LABEL      31--CALLALT
POWER
        27**DCL        31<>CALL       37>>ASSIGN
XPN_7RTOLS
        29**DCL-ENT    31--CALL
ZERO
        28**DCL        33>>CALLBLT
