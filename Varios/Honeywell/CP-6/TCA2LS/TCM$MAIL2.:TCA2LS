VERSION A02

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:1    
        1        1        /*M*    TCM$MAIL2   SMTP Mail Receiver, part 2                      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        TCM$WRITE_AUDIT_LOG: PROC( PARM1, PARM2);
        9        9        %INCLUDE CP_6;
       10       90            %FPT_CLOSE( FPTN=CLOSE_AUDIT, DCB=F$AUDIT,DISP=SAVE, STCLASS=CONSTANT);
       11      132            %VLP_NAME( FPTN=AUDIT_NAME, NAME=':AUDITLOG', STCLASS=CONSTANT);
       12      159            %VLP_ACCT( FPTN=TCM_ACCOUNT, STCLASS=SYMREF);
       13      172            %FPT_OPEN( FPTN=OPEN_AUDIT, DCB=F$AUDIT, FUN=CREATE, EXIST=OLDFILE,
       14      173                       ACS=DIRECT, ASN=FILE, ORG=KEYED, SHARE=ALL, NAME=AUDIT_NAME,
       15      174                       ACCT=TCM_ACCOUNT, DISP=NAMED, STCLASS=CONSTANT);
       16      283            %FPT_TIME( FPTN=GET_AUDIT_KEY, SOURCE=CLOCK, DEST=UTS, TSTAMP=AUDIT_UTS,
       17      284                       STCLASS=CONSTANT);
       18      303            %FPT_TIME( FPTN=GET_AUDIT_KEY2, SOURCE=CLOCK, DEST=UTS, TSTAMP=AUDIT_UTS2,
       19      304                       STCLASS=CONSTANT);
       20      323            %FPT_TIME( FPTN=GET_AUDIT_TIME, SOURCE=UTS, DEST=LOCAL, TSTAMP=AUDIT_UTS,
       21      324                       DATE=AUDIT_BUF.DATE, TIME=AUDIT_BUF.TIME, STCLASS=CONSTANT);
       22      343            %FPT_TIME( FPTN=GET_AUDIT_TIME2, SOURCE=UTS, DEST=LOCAL, TSTAMP=AUDIT_UTS2,
       23      344                       DATE=AUDIT_BUF.DATE, TIME=AUDIT_BUF.TIME, STCLASS=CONSTANT);
       24      363            %FPT_WRITE( FPTN=WRITE_AUDIT, DCB=F$AUDIT, BUF=AUDIT_BUF, KEY=AUDIT_KEY);
       25      394            %FPT_WRITE( FPTN=WRITE_AUDIT2, DCB=F$AUDIT, BUF=AUDIT_BUF, KEY=AUDIT_KEY2);
       26      425            %FPT_TRAP( STCLASS=CONSTANT,
       27      426                       ARITHMETIC=TCM$ABORT,
       28      427                           DIVIDE_CHECK=TRAP, OVERFLOW=TRAP,
       29      428                       PROGRAMMED=TCM$ABORT,
       30      429                           MME=TRAP, DERAIL=TRAP, FAULT_TAG=TRAP,
       31      430                       PMME=TCM$ABORT,
       32      431                       ERRORS=TCM$ABORT,
       33      432                           MEMORY=TRAP, LOCKUP=TRAP, IPR=TRAP, MISSING_PAGE=TRAP,
       34      433                           MISSING_SEG=TRAP, COMMAND=TRAP, SECURITY_1=TRAP,
       35      434                           SECURITY_2=TRAP, HARDWARE=ABORT);
       36      457            %FPT_XCON( UENTRY=TCM$ABORT);
       37      471
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:2    
       38      472    1       DCL TCM$ABORT ENTRY ASYNC;
       39      473
       40      474    1       DCL 1 AUDIT_BUF STATIC,
       41      475    1            2 DATE CHAR(8) INIT( 'MM/DD/YY'),
       42      476    1            2 * CHAR(1) INIT( ' '),
       43      477    1            2 TIME CHAR(11) INIT( 'HH:MM:SS.DD'),
       44      478    1            2 * CHAR(1) INIT( ' '),
       45      479    1            2 PROG CHAR(7) INIT( '1234567'),
       46      480    1            2 * CHAR(1) INIT( ' '),
       47      481    1            2 COUNT CHAR(3) INIT( ' '),
       48      482    1            2 STATUS REDEF COUNT CHAR(3),
       49      483    1            2 * CHAR(1) INIT( ' '),
       50      484    1            2 TEXT CHAR(7) INIT( ' '),
       51      485    1            2 HOST_NAME CHAR(64) INIT( ' ');
       52      486    1       DCL 1 AUDIT_KEY STATIC,
       53      487    1            2 * UBIN(9) CALIGNED INIT( 4),
       54      488    1            2 TIME UBIN CALIGNED INIT( 0);
       55      489    1       DCL 1 AUDIT_KEY2 STATIC,
       56      490    1            2 * UBIN(9) CALIGNED INIT( 4),
       57      491    1            2 TIME UBIN CALIGNED INIT( 0);
       58      492    1       DCL AUDIT_UTS UBIN STATIC INIT( 0);
       59      493    1       DCL AUDIT_UTS2 UBIN STATIC INIT( 0);
       60      494    1       DCL F$AUDIT DCB;
       61      495    1       DCL 1 HOST_NAME BASED( PARM2$),
       62      496    1            2 L UBIN(9) CALIGNED,
       63      497    1            2 T CHAR( HOST_NAME.L);
       64      498    1       DCL I UBIN;
       65      499    1       DCL TCM_PROGNAME CHAR(7) SYMREF;
       66      500    1       DCL 1 STATUS BASED( PARM1$) ALIGNED,
       67      501    1            2 MSGCNT SBIN,
       68      502    1            2 TEXT CHAR(7);
       69      503    1       DCL PARM1 SBIN;
       70      504    1       DCL PARM1$ PTR;
       71      505    1       DCL PARM2 SBIN;
       72      506    1       DCL PARM2$ PTR;
       73      507    1       DCL TXT CHAR( PARM1) BASED CALIGNED;
       74      508
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:3    
       75      509    1       PARM1$ = ADDR( PARM1);
       76      510    1       PARM2$ = ADDR( PARM2);
       77      511    1       CALL M$OPEN( OPEN_AUDIT)
       78      512    2       WHENALTRETURN DO;
       79      513    2           RETURN;
       80      514    2           END;
       81      515    1       AUDIT_BUF.HOST_NAME = ' ';
       82      516    1       AUDIT_BUF.COUNT = ' ';
       83      517    1       AUDIT_BUF.TEXT = ' ';
       84      518    1       IF ADDR( HOST_NAME) ~= ADDR( NIL) THEN
       85      519                /** PUT SENDING SITE NAME IN BUFFER   */
       86      520    1           AUDIT_BUF.HOST_NAME = HOST_NAME.T;
       87      521    2       IF ADDR( STATUS) = ADDR( NIL) THEN DO;
       88      522                /** WRITE START MESSAGE TO LOG FILE **/
       89      523    2           CALL M$TIME( GET_AUDIT_KEY);
       90      524    2           CALL M$TIME( GET_AUDIT_TIME);
       91      525    2           AUDIT_BUF.PROG = TCM_PROGNAME;
       92      526    2           AUDIT_KEY.TIME = AUDIT_UTS;
       93      527    2           CALL M$WRITE( WRITE_AUDIT)
       94      528    3           WHENALTRETURN DO;
       95      529    3               /*NOTHING*/;
       96      530    3               END;
       97      531    2           END;
       98      532    2       ELSE DO;
       99      533                /** WRITE COMPLETION RECORD TO LOG FILE **/
      100      534    3           IF STATUS.MSGCNT >= 0 THEN DO;
      101      535    3               CALL BINCHAR( AUDIT_BUF.COUNT, STATUS.MSGCNT);
      102      536    3               IF SUBSTR( TCM_PROGNAME, 3, 4) = 'MAIL' THEN
      103      537    3                   AUDIT_BUF.TEXT = 'rcv''d.';
      104      538    3               ELSE
      105      539    3                   AUDIT_BUF.TEXT = 'sent.';
      106      540    3               END;
      107      541    3           ELSE DO;
      108      542    3               AUDIT_BUF.COUNT = ' ';
      109      543    3               AUDIT_BUF.TEXT = STATUS.TEXT;
      110      544    3               END;
      111      545    2           CALL INDEX( I, ' ', AUDIT_BUF.HOST_NAME);
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:4    
      112      546    2           WRITE_AUDIT.BUF_.BOUND = POFFC( ADDR( AUDIT_BUF.HOST_NAME),
      113      547    2                   ADDR( AUDIT_BUF)) + I - 1;
      114      548    2           CALL M$WRITE( WRITE_AUDIT)
      115      549    3           WHENALTRETURN DO;
      116      550    3               /*NOTHING*/;
      117      551    3               END;
      118      552    2           END;
      119      553    1       CALL M$CLOSE( CLOSE_AUDIT)
      120      554    2       WHENALTRETURN DO;
      121      555    2           /*NOTHING*/;
      122      556    2           END;
      123      557    1       RETURN;
      124      558        %EJECT;
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:5    
      125      559    1   TCM$WRITE_AUDIT_ON: ENTRY( PARM1, PARM2);
      126      560
      127      561    1       AUDIT_BUF.STATUS = 'on ';
      128      562    1       GOTO COMMON;
      129      563
      130      564    1   TCM$WRITE_AUDIT_OFF: ENTRY( PARM1, PARM2);
      131      565
      132      566    1       AUDIT_BUF.STATUS = 'off';
      133      567    1       FPT_XCON.V.UENTRY# = ENTADDR( NIL);
      134      568    1   COMMON:
      135      569    1       AUDIT_BUF.PROG = TCM_PROGNAME;
      136      570    1       AUDIT_BUF.TEXT = ' ';
      137      571    1       AUDIT_BUF.HOST_NAME = ' ';
      138      572    1       CALL M$XCON( FPT_XCON);
      139      573    1       CALL M$TRAP( FPT_TRAP);
      140      574    1       CALL M$TIME( GET_AUDIT_KEY2);
      141      575    1       CALL M$TIME( GET_AUDIT_TIME2);
      142      576    1       AUDIT_KEY2.TIME = AUDIT_UTS2;
      143      577    1       I = POFFC( ADDR( AUDIT_BUF.TEXT), ADDR( AUDIT_BUF)) - 1;
      144      578    1       PARM2$ = ADDR( PARM2);
      145      579    2       IF PARM2$ ~= ADDR( NIL) THEN DO;
      146      580    2           ADDR( AUDIT_BUF.TEXT)->TXT = PARM2$->TXT;
      147      581    2           I = I + PARM1 + 1;
      148      582    2           END;
      149      583    1       CALL M$OPEN( OPEN_AUDIT)
      150      584    2       WHENALTRETURN DO;
      151      585    2           RETURN;
      152      586    2           END;
      153      587    1       WRITE_AUDIT2.BUF_.BOUND = I - 1;
      154      588    1       CALL M$WRITE( WRITE_AUDIT2)
      155      589    2       WHENALTRETURN DO;
      156      590    2           /*NOTHING*/;
      157      591    2           END;
      158      592    1       CALL M$CLOSE( CLOSE_AUDIT)
      159      593    2       WHENALTRETURN DO;
      160      594    2           /*NOTHING*/;
      161      595    2           END;
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:6    
      162      596    1       RETURN;
      163      597
      164      598    1   END TCM$WRITE_AUDIT_LOG;

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:7    
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$WRITE_AUDIT_LOG.

   Procedure TCM$WRITE_AUDIT_LOG requires 184 words for executable code.
   Procedure TCM$WRITE_AUDIT_LOG requires 10 words of local(AUTO) storage.

    No errors detected in file TCM$MAIL2.:TCA2TSI    .

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:8    

 Object Unit name= TCM$WRITE_AUDIT_LOG                        File name= TCM$MAIL2.:TCA2TOU
 UTS= NOV 16 '97 14:17:49.80 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    157    235  TCM$WRITE_AUDIT_LOG
    2   Data  even  none    62     76  TCM$WRITE_AUDIT_LOG
    3   DCB   even  none     0      0  F$AUDIT
    4   Proc  even  none   184    270  TCM$WRITE_AUDIT_LOG
    5  RoData even  none     4      4  TCM$WRITE_AUDIT_LOG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        2  TCM$WRITE_AUDIT_LOG
     4    146                  yes      Std        2  TCM$WRITE_AUDIT_ON
     4    154                  yes      Std        2  TCM$WRITE_AUDIT_OFF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 TCM$ABORT
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:9    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TCM_ACCOUNT                           F$AUDIT
     TCM_PROGNAME                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:10   


        1        1        /*M*    TCM$MAIL2   SMTP Mail Receiver, part 2                      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        TCM$WRITE_AUDIT_LOG: PROC( PARM1, PARM2);

      8  4 000000   000000 700200 xent  TCM$WRITE_A* TSX0  ! X66_AUTO_2
         4 000001   000012 000002                    ZERO    10,2

        9        9        %INCLUDE CP_6;
       10       90            %FPT_CLOSE( FPTN=CLOSE_AUDIT, DCB=F$AUDIT,DISP=SAVE, STCLASS=CONSTANT);
       11      132            %VLP_NAME( FPTN=AUDIT_NAME, NAME=':AUDITLOG', STCLASS=CONSTANT);
       12      159            %VLP_ACCT( FPTN=TCM_ACCOUNT, STCLASS=SYMREF);
       13      172            %FPT_OPEN( FPTN=OPEN_AUDIT, DCB=F$AUDIT, FUN=CREATE, EXIST=OLDFILE,
       14      173                       ACS=DIRECT, ASN=FILE, ORG=KEYED, SHARE=ALL, NAME=AUDIT_NAME,
       15      174                       ACCT=TCM_ACCOUNT, DISP=NAMED, STCLASS=CONSTANT);
       16      283            %FPT_TIME( FPTN=GET_AUDIT_KEY, SOURCE=CLOCK, DEST=UTS, TSTAMP=AUDIT_UTS,
       17      284                       STCLASS=CONSTANT);
       18      303            %FPT_TIME( FPTN=GET_AUDIT_KEY2, SOURCE=CLOCK, DEST=UTS, TSTAMP=AUDIT_UTS2,
       19      304                       STCLASS=CONSTANT);
       20      323            %FPT_TIME( FPTN=GET_AUDIT_TIME, SOURCE=UTS, DEST=LOCAL, TSTAMP=AUDIT_UTS,
       21      324                       DATE=AUDIT_BUF.DATE, TIME=AUDIT_BUF.TIME, STCLASS=CONSTANT);
       22      343            %FPT_TIME( FPTN=GET_AUDIT_TIME2, SOURCE=UTS, DEST=LOCAL, TSTAMP=AUDIT_UTS2,
       23      344                       DATE=AUDIT_BUF.DATE, TIME=AUDIT_BUF.TIME, STCLASS=CONSTANT);
       24      363            %FPT_WRITE( FPTN=WRITE_AUDIT, DCB=F$AUDIT, BUF=AUDIT_BUF, KEY=AUDIT_KEY);
       25      394            %FPT_WRITE( FPTN=WRITE_AUDIT2, DCB=F$AUDIT, BUF=AUDIT_BUF, KEY=AUDIT_KEY2);
       26      425            %FPT_TRAP( STCLASS=CONSTANT,
       27      426                       ARITHMETIC=TCM$ABORT,
       28      427                           DIVIDE_CHECK=TRAP, OVERFLOW=TRAP,
       29      428                       PROGRAMMED=TCM$ABORT,
       30      429                           MME=TRAP, DERAIL=TRAP, FAULT_TAG=TRAP,
       31      430                       PMME=TCM$ABORT,
       32      431                       ERRORS=TCM$ABORT,
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:11   
       33      432                           MEMORY=TRAP, LOCKUP=TRAP, IPR=TRAP, MISSING_PAGE=TRAP,
       34      433                           MISSING_SEG=TRAP, COMMAND=TRAP, SECURITY_1=TRAP,
       35      434                           SECURITY_2=TRAP, HARDWARE=ABORT);
       36      457            %FPT_XCON( UENTRY=TCM$ABORT);
       37      471
       38      472    1       DCL TCM$ABORT ENTRY ASYNC;
       39      473
       40      474    1       DCL 1 AUDIT_BUF STATIC,
       41      475    1            2 DATE CHAR(8) INIT( 'MM/DD/YY'),
       42      476    1            2 * CHAR(1) INIT( ' '),
       43      477    1            2 TIME CHAR(11) INIT( 'HH:MM:SS.DD'),
       44      478    1            2 * CHAR(1) INIT( ' '),
       45      479    1            2 PROG CHAR(7) INIT( '1234567'),
       46      480    1            2 * CHAR(1) INIT( ' '),
       47      481    1            2 COUNT CHAR(3) INIT( ' '),
       48      482    1            2 STATUS REDEF COUNT CHAR(3),
       49      483    1            2 * CHAR(1) INIT( ' '),
       50      484    1            2 TEXT CHAR(7) INIT( ' '),
       51      485    1            2 HOST_NAME CHAR(64) INIT( ' ');
       52      486    1       DCL 1 AUDIT_KEY STATIC,
       53      487    1            2 * UBIN(9) CALIGNED INIT( 4),
       54      488    1            2 TIME UBIN CALIGNED INIT( 0);
       55      489    1       DCL 1 AUDIT_KEY2 STATIC,
       56      490    1            2 * UBIN(9) CALIGNED INIT( 4),
       57      491    1            2 TIME UBIN CALIGNED INIT( 0);
       58      492    1       DCL AUDIT_UTS UBIN STATIC INIT( 0);
       59      493    1       DCL AUDIT_UTS2 UBIN STATIC INIT( 0);
       60      494    1       DCL F$AUDIT DCB;
       61      495    1       DCL 1 HOST_NAME BASED( PARM2$),
       62      496    1            2 L UBIN(9) CALIGNED,
       63      497    1            2 T CHAR( HOST_NAME.L);
       64      498    1       DCL I UBIN;
       65      499    1       DCL TCM_PROGNAME CHAR(7) SYMREF;
       66      500    1       DCL 1 STATUS BASED( PARM1$) ALIGNED,
       67      501    1            2 MSGCNT SBIN,
       68      502    1            2 TEXT CHAR(7);
       69      503    1       DCL PARM1 SBIN;
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:12   
       70      504    1       DCL PARM1$ PTR;
       71      505    1       DCL PARM2 SBIN;
       72      506    1       DCL PARM2$ PTR;
       73      507    1       DCL TXT CHAR( PARM1) BASED CALIGNED;
       74      508
       75      509    1       PARM1$ = ADDR( PARM1);

    509  4 000002   200003 236100                    LDQ     @PARM1,,AUTO
         4 000003   200006 756100                    STQ     PARM1$,,AUTO

       76      510    1       PARM2$ = ADDR( PARM2);

    510  4 000004   200004 236100                    LDQ     @PARM2,,AUTO
         4 000005   200007 756100                    STQ     PARM2$,,AUTO

       77      511    1       CALL M$OPEN( OPEN_AUDIT)

    511  4 000006   000042 630400 1                  EPPR0   OPEN_AUDIT
         4 000007   450000 713400                    CLIMB   alt,open
         4 000010   410400 401760                    pmme    nvectors=18
         4 000011   000013 702000 4                  TSX2    s:513
         4 000012   000014 710000 4                  TRA     s:515

       78      512    2       WHENALTRETURN DO;

       79      513    2           RETURN;

    513  4 000013   000000 702200 xent               TSX2  ! X66_ARET

       80      514    2           END;
       81      515    1       AUDIT_BUF.HOST_NAME = ' ';

    515  4 000014   040000 100400                    MLR     fill='040'O
         4 000015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000016   000050 000100 2                  ADSC9   AUDIT_BUF+10             cn=0,n=64

       82      516    1       AUDIT_BUF.COUNT = ' ';
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:13   

    516  4 000017   000000 236000 5                  LDQ     0
         4 000020   000045 552034 2                  STBQ    AUDIT_BUF+7,'34'O

       83      517    1       AUDIT_BUF.TEXT = ' ';

    517  4 000021   040000 100400                    MLR     fill='040'O
         4 000022   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000023   000046 200007 2                  ADSC9   AUDIT_BUF+8              cn=1,n=7

       84      518    1       IF ADDR( HOST_NAME) ~= ADDR( NIL) THEN

    518  4 000024   200007 236100                    LDQ     PARM2$,,AUTO
         4 000025   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000026   000037 600000 4                  TZE     s:521

       85      519                /** PUT SENDING SITE NAME IN BUFFER   */
       86      520    1           AUDIT_BUF.HOST_NAME = HOST_NAME.T;

    520  4 000027   200007 470500                    LDP0    PARM2$,,AUTO
         4 000030   000100 101500                    MRL     fill='000'O
         4 000031   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000032   200010 000002                    ADSC9   PARM2$+1,,AUTO           cn=0,n=2
         4 000033   200010 220100                    LDX0    PARM2$+1,,AUTO
         4 000034   040000 100540                    MLR     fill='040'O
         4 000035   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         4 000036   000050 000100 2                  ADSC9   AUDIT_BUF+10             cn=0,n=64

       87      521    2       IF ADDR( STATUS) = ADDR( NIL) THEN DO;

    521  4 000037   200006 236100                    LDQ     PARM1$,,AUTO
         4 000040   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000041   000064 601000 4                  TNZ     s:534

       88      522                /** WRITE START MESSAGE TO LOG FILE **/
       89      523    2           CALL M$TIME( GET_AUDIT_KEY);

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:14   
    523  4 000042   000134 630400 1                  EPPR0   GET_AUDIT_KEY
         4 000043   020004 713400                    CLIMB   8196
         4 000044   402000 401760                    pmme    nvectors=5

       90      524    2           CALL M$TIME( GET_AUDIT_TIME);

    524  4 000045   000164 630400 1                  EPPR0   GET_AUDIT_TIME
         4 000046   020004 713400                    CLIMB   8196
         4 000047   402000 401760                    pmme    nvectors=5

       91      525    2           AUDIT_BUF.PROG = TCM_PROGNAME;

    525  4 000050   040000 100400                    MLR     fill='040'O
         4 000051   000000 000007 xsym               ADSC9   TCM_PROGNAME             cn=0,n=7
         4 000052   000043 200007 2                  ADSC9   AUDIT_BUF+5              cn=1,n=7

       92      526    2           AUDIT_KEY.TIME = AUDIT_UTS;

    526  4 000053   000000 100400                    MLR     fill='000'O
         4 000054   000074 000004 2                  ADSC9   AUDIT_UTS                cn=0,n=4
         4 000055   000070 200004 2                  ADSC9   AUDIT_KEY                cn=1,n=4

       93      527    2           CALL M$WRITE( WRITE_AUDIT)

    527  4 000056   000000 630400 2                  EPPR0   WRITE_AUDIT
         4 000057   440001 713400                    CLIMB   alt,write
         4 000060   401400 401760                    pmme    nvectors=4
         4 000061   000063 702000 4                  TSX2    s:531
         4 000062   000063 710000 4                  TRA     s:531

       94      528    3           WHENALTRETURN DO;

       95      529    3               /*NOTHING*/;
       96      530    3               END;

       97      531    2           END;

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:15   
    531  4 000063   000140 710000 4                  TRA     s:553

       98      532    2       ELSE DO;

       99      533                /** WRITE COMPLETION RECORD TO LOG FILE **/
      100      534    3           IF STATUS.MSGCNT >= 0 THEN DO;

    534  4 000064   200006 470500                    LDP0    PARM1$,,AUTO
         4 000065   000000 235100                    LDA     0,,PR0
         4 000066   000106 604000 4                  TMI     s:542

      101      535    3               CALL BINCHAR( AUDIT_BUF.COUNT, STATUS.MSGCNT);

    535  4 000067   000000 301500                    BTD
         4 000070   000000 000004                    NDSC9   0,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         4 000071   000045 230003 2                  NDSC9   AUDIT_BUF+7              cn=1,s=nosgn,sf=0,n=3

      102      536    3               IF SUBSTR( TCM_PROGNAME, 3, 4) = 'MAIL' THEN

    536  4 000072   040000 106400                    CMPC    fill='040'O
         4 000073   000000 600004 xsym               ADSC9   TCM_PROGNAME             cn=3,n=4
         4 000074   000226 000004 1                  ADSC9   FPT_TRAP+10              cn=0,n=4
         4 000075   000102 601000 4                  TNZ     s:539

      103      537    3                   AUDIT_BUF.TEXT = 'rcv''d.';

    537  4 000076   040000 100400                    MLR     fill='040'O
         4 000077   000227 000006 1                  ADSC9   FPT_TRAP+11              cn=0,n=6
         4 000100   000046 200007 2                  ADSC9   AUDIT_BUF+8              cn=1,n=7
         4 000101   000113 710000 4                  TRA     s:545

      104      538    3               ELSE
      105      539    3                   AUDIT_BUF.TEXT = 'sent.';

    539  4 000102   040000 100400                    MLR     fill='040'O
         4 000103   000231 000005 1                  ADSC9   FPT_TRAP+13              cn=0,n=5
         4 000104   000046 200007 2                  ADSC9   AUDIT_BUF+8              cn=1,n=7
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:16   

      106      540    3               END;

    540  4 000105   000113 710000 4                  TRA     s:545

      107      541    3           ELSE DO;

      108      542    3               AUDIT_BUF.COUNT = ' ';

    542  4 000106   000000 236000 5                  LDQ     0
         4 000107   000045 552034 2                  STBQ    AUDIT_BUF+7,'34'O

      109      543    3               AUDIT_BUF.TEXT = STATUS.TEXT;

    543  4 000110   040000 100500                    MLR     fill='040'O
         4 000111   000001 000007                    ADSC9   1,,PR0                   cn=0,n=7
         4 000112   000046 200007 2                  ADSC9   AUDIT_BUF+8              cn=1,n=7

      110      544    3               END;

      111      545    2           CALL INDEX( I, ' ', AUDIT_BUF.HOST_NAME);

    545  4 000113   000000 124400                    SCM     mask='000'O
         4 000114   000050 000100 2                  ADSC9   AUDIT_BUF+10             cn=0,n=64
         4 000115   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000116   200005 000100                    ARG     I,,AUTO

      112      546    2           WRITE_AUDIT.BUF_.BOUND = POFFC( ADDR( AUDIT_BUF.HOST_NAME),

    546  4 000117   000001 236000 5                  LDQ     1
         4 000120   000020 772000                    QRL     16
         4 000121   200010 756100                    STQ     PARM2$+1,,AUTO
         4 000122   000002 236000 5                  LDQ     2
         4 000123   000020 772000                    QRL     16
         4 000124   200010 136100                    SBLQ    PARM2$+1,,AUTO
         4 000125   200005 036100                    ADLQ    I,,AUTO
         4 000126   000001 136007                    SBLQ    1,DL
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:17   
         4 000127   000020 736000                    QLS     16
         4 000130   000004 676000 2                  ERQ     WRITE_AUDIT+4
         4 000131   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000132   000004 656000 2                  ERSQ    WRITE_AUDIT+4

      113      547    2                   ADDR( AUDIT_BUF)) + I - 1;
      114      548    2           CALL M$WRITE( WRITE_AUDIT)

    548  4 000133   000000 630400 2                  EPPR0   WRITE_AUDIT
         4 000134   440001 713400                    CLIMB   alt,write
         4 000135   401400 401760                    pmme    nvectors=4
         4 000136   000140 702000 4                  TSX2    s:553
         4 000137   000140 710000 4                  TRA     s:553

      115      549    3           WHENALTRETURN DO;

      116      550    3               /*NOTHING*/;
      117      551    3               END;

      118      552    2           END;

      119      553    1       CALL M$CLOSE( CLOSE_AUDIT)

    553  4 000140   000000 630400 1                  EPPR0   CLOSE_AUDIT
         4 000141   450001 713400                    CLIMB   alt,close
         4 000142   406000 401760                    pmme    nvectors=13
         4 000143   000145 702000 4                  TSX2    s:557
         4 000144   000145 710000 4                  TRA     s:557

      120      554    2       WHENALTRETURN DO;

      121      555    2           /*NOTHING*/;
      122      556    2           END;

      123      557    1       RETURN;

    557  4 000145   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:18   

      124      558        %EJECT;
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:19   
      125      559    1   TCM$WRITE_AUDIT_ON: ENTRY( PARM1, PARM2);

    559  4 000146   000000 700200 xent  TCM$WRITE_A* TSX0  ! X66_AUTO_2
         4 000147   000012 000002                    ZERO    10,2

      126      560
      127      561    1       AUDIT_BUF.STATUS = 'on ';

    561  4 000150   000233 236000 1                  LDQ     FPT_TRAP+15
         4 000151   000011 772000                    QRL     9
         4 000152   000045 552034 2                  STBQ    AUDIT_BUF+7,'34'O

      128      562    1       GOTO COMMON;

    562  4 000153   000163 710000 4                  TRA     COMMON

      129      563
      130      564    1   TCM$WRITE_AUDIT_OFF: ENTRY( PARM1, PARM2);

    564  4 000154   000000 700200 xent  TCM$WRITE_A* TSX0  ! X66_AUTO_2
         4 000155   000012 000002                    ZERO    10,2

      131      565
      132      566    1       AUDIT_BUF.STATUS = 'off';

    566  4 000156   000234 236000 1                  LDQ     FPT_TRAP+16
         4 000157   000011 772000                    QRL     9
         4 000160   000045 552034 2                  STBQ    AUDIT_BUF+7,'34'O

      133      567    1       FPT_XCON.V.UENTRY# = ENTADDR( NIL);

    567  4 000161   000002 236000 xsym               LDQ     B_VECTNIL+2
         4 000162   000034 756000 2                  STQ     FPT_XCON+4

      134      568    1   COMMON:
      135      569    1       AUDIT_BUF.PROG = TCM_PROGNAME;

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:20   
    569  4 000163   040000 100400       COMMON       MLR     fill='040'O
         4 000164   000000 000007 xsym               ADSC9   TCM_PROGNAME             cn=0,n=7
         4 000165   000043 200007 2                  ADSC9   AUDIT_BUF+5              cn=1,n=7

      136      570    1       AUDIT_BUF.TEXT = ' ';

    570  4 000166   040000 100400                    MLR     fill='040'O
         4 000167   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000170   000046 200007 2                  ADSC9   AUDIT_BUF+8              cn=1,n=7

      137      571    1       AUDIT_BUF.HOST_NAME = ' ';

    571  4 000171   040000 100400                    MLR     fill='040'O
         4 000172   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000173   000050 000100 2                  ADSC9   AUDIT_BUF+10             cn=0,n=64

      138      572    1       CALL M$XCON( FPT_XCON);

    572  4 000174   000030 630400 2                  EPPR0   FPT_XCON
         4 000175   010003 713400                    CLIMB   4099
         4 000176   400400 401760                    pmme    nvectors=2

      139      573    1       CALL M$TRAP( FPT_TRAP);

    573  4 000177   000214 630400 1                  EPPR0   FPT_TRAP
         4 000200   010004 713400                    CLIMB   4100
         4 000201   400400 401760                    pmme    nvectors=2

      140      574    1       CALL M$TIME( GET_AUDIT_KEY2);

    574  4 000202   000150 630400 1                  EPPR0   GET_AUDIT_KEY2
         4 000203   020004 713400                    CLIMB   8196
         4 000204   402000 401760                    pmme    nvectors=5

      141      575    1       CALL M$TIME( GET_AUDIT_TIME2);

    575  4 000205   000200 630400 1                  EPPR0   GET_AUDIT_TIME2
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:21   
         4 000206   020004 713400                    CLIMB   8196
         4 000207   402000 401760                    pmme    nvectors=5

      142      576    1       AUDIT_KEY2.TIME = AUDIT_UTS2;

    576  4 000210   000000 100400                    MLR     fill='000'O
         4 000211   000075 000004 2                  ADSC9   AUDIT_UTS2               cn=0,n=4
         4 000212   000072 200004 2                  ADSC9   AUDIT_KEY2               cn=1,n=4

      143      577    1       I = POFFC( ADDR( AUDIT_BUF.TEXT), ADDR( AUDIT_BUF)) - 1;

    577  4 000213   000001 236000 5                  LDQ     1
         4 000214   000020 772000                    QRL     16
         4 000215   200010 756100                    STQ     PARM2$+1,,AUTO
         4 000216   000003 236000 5                  LDQ     3
         4 000217   000020 772000                    QRL     16
         4 000220   200010 136100                    SBLQ    PARM2$+1,,AUTO
         4 000221   000001 136007                    SBLQ    1,DL
         4 000222   200005 756100                    STQ     I,,AUTO

      144      578    1       PARM2$ = ADDR( PARM2);

    578  4 000223   200004 236100                    LDQ     @PARM2,,AUTO
         4 000224   200007 756100                    STQ     PARM2$,,AUTO

      145      579    2       IF PARM2$ ~= ADDR( NIL) THEN DO;

    579  4 000225   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000226   000241 600000 4                  TZE     s:583

      146      580    2           ADDR( AUDIT_BUF.TEXT)->TXT = PARM2$->TXT;

    580  4 000227   200003 470500                    LDP0    @PARM1,,AUTO
         4 000230   000000 720100                    LXL0    0,,PR0
         4 000231   200007 471500                    LDP1    PARM2$,,AUTO
         4 000232   040040 100540                    MLR     fill='040'O
         4 000233   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:22   
         4 000234   000046 200010 2                  ADSC9   AUDIT_BUF+8              cn=1,n=*X0

      147      581    2           I = I + PARM1 + 1;

    581  4 000235   200005 236100                    LDQ     I,,AUTO
         4 000236   000000 036100                    ADLQ    0,,PR0
         4 000237   000001 036007                    ADLQ    1,DL
         4 000240   200005 756100                    STQ     I,,AUTO

      148      582    2           END;

      149      583    1       CALL M$OPEN( OPEN_AUDIT)

    583  4 000241   000042 630400 1                  EPPR0   OPEN_AUDIT
         4 000242   450000 713400                    CLIMB   alt,open
         4 000243   410400 401760                    pmme    nvectors=18
         4 000244   000246 702000 4                  TSX2    s:585
         4 000245   000247 710000 4                  TRA     s:587

      150      584    2       WHENALTRETURN DO;

      151      585    2           RETURN;

    585  4 000246   000000 702200 xent               TSX2  ! X66_ARET

      152      586    2           END;
      153      587    1       WRITE_AUDIT2.BUF_.BOUND = I - 1;

    587  4 000247   200005 236100                    LDQ     I,,AUTO
         4 000250   000001 136007                    SBLQ    1,DL
         4 000251   000020 736000                    QLS     16
         4 000252   000020 676000 2                  ERQ     WRITE_AUDIT2+4
         4 000253   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000254   000020 656000 2                  ERSQ    WRITE_AUDIT2+4

      154      588    1       CALL M$WRITE( WRITE_AUDIT2)

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:23   
    588  4 000255   000014 630400 2                  EPPR0   WRITE_AUDIT2
         4 000256   440001 713400                    CLIMB   alt,write
         4 000257   401400 401760                    pmme    nvectors=4
         4 000260   000262 702000 4                  TSX2    s:592
         4 000261   000262 710000 4                  TRA     s:592

      155      589    2       WHENALTRETURN DO;

      156      590    2           /*NOTHING*/;
      157      591    2           END;

      158      592    1       CALL M$CLOSE( CLOSE_AUDIT)

    592  4 000262   000000 630400 1                  EPPR0   CLOSE_AUDIT
         4 000263   450001 713400                    CLIMB   alt,close
         4 000264   406000 401760                    pmme    nvectors=13
         4 000265   000267 702000 4                  TSX2    s:596
         4 000266   000267 710000 4                  TRA     s:596

      159      593    2       WHENALTRETURN DO;

      160      594    2           /*NOTHING*/;
      161      595    2           END;

      162      596    1       RETURN;

    596  4 000267   000000 702200 xent               TSX2  ! X66_ARET

CLOSE_AUDIT
 Sect OctLoc
   1     000   000003 777640   000032 006000   000000 177640   000000 006014    ................
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     030*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     034   000220 000000   000000 000000                                    ........

AUDIT_NAME
 Sect OctLoc
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:24   
   1     036   011072 101125   104111 124114   117107 ******                    .:AUDITLOG..

OPEN_AUDIT
 Sect OctLoc
   1     042   000025 777640   000106 006000   000000 177640   000000 006014    .....F..........
   1     046   000000 177640   000000 006014   000002 377640   000036 006000    ................
   1     052   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     066*  000001 777640   000000 006000   000000 177640   000000 006014    ................
   1     072   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     106*  000000 000452   000000 003001   252525 002002   000040 252520    ............. ..
   1     112   000040 040040   000000 000002   000000 777777   000000 000000    .   ............
   1     116   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     122   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     126   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     132   000000 000000   ****** ******                                    ........

GET_AUDIT_KEY
 Sect OctLoc
   1     134   000001 777640   000146 006000   000000 177640   000000 006014    .....f..........
   1     140   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     144   000000 777640   000074 006000   000004 000000   ****** ******    .....<..........

GET_AUDIT_KEY2
 Sect OctLoc
   1     150   000001 777640   000162 006000   000000 177640   000000 006014    .....r..........
   1     154   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     160   000000 777640   000075 006000   000004 000000   ****** ******    .....=..........

GET_AUDIT_TIME
 Sect OctLoc
   1     164   000001 777640   000176 006000   000001 777640   000036 006000    .....~..........
   1     170   000002 577640   000040 206000   000000 177640   000000 006014    ..... ..........
   1     174   000000 777640   000074 006000   004003 000000   ****** ******    .....<..........

GET_AUDIT_TIME2
 Sect OctLoc
   1     200   000001 777640   000212 006000   000001 777640   000036 006000    ................
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:25   
   1     204   000002 577640   000040 206000   000000 177640   000000 006014    ..... ..........
   1     210   000000 777640   000075 006000   004003 000000   ****** ******    .....=..........

FPT_TRAP
 Sect OctLoc
   1     214   000005 777640   000220 006000   000000 177640   000000 006014    ................
   1     220   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     224   525062 525243   000000 000000                                    .2......

(unnamed)
 Sect OctLoc
   1     226   115101 111114   162143 166047   144056 040040   163145 156164    MAILrcv'd.  sent
   1     232   056040 040040   157156 040040   157146 146040                    .   on  off

WRITE_AUDIT
 Sect OctLoc
   2     000   000003 777640   000010 006000   000001 177640   000070 006000    .............8..
   2     004   000031 777640   000036 006000   000000 177640   000000 006014    ................
   2     010   000000 400400   000000 000000   000000 000000   000000 000000    ................

WRITE_AUDIT2
 Sect OctLoc
   2     014   000003 777640   000024 006000   000001 177640   000072 006000    .............:..
   2     020   000031 777640   000036 006000   000000 177640   000000 006014    ................
   2     024   000000 400400   000000 000000   000000 000000   000000 000000    ................

FPT_XCON
 Sect OctLoc
   2     030   000001 777640   000034 006000   000000 177640   000000 006014    ................
   2     034   000000 000000   000000 000000                                    ........

AUDIT_BUF
 Sect OctLoc
   2     036   115115 057104   104057 131131   040110 110072   115115 072123    MM/DD/YY HH:MM:S
   2     042   123056 104104   040061 062063   064065 066067   040040 040040    S.DD 1234567
   2     046   040040 040040   040040 040040   040040 040040   040040 040040
   2     066*  040040 040040   040040 040040
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:26   

AUDIT_KEY
 Sect OctLoc
   2     070   004000 000000   000*** ******                                    ........

AUDIT_KEY2
 Sect OctLoc
   2     072   004000 000000   000*** ******                                    ........

AUDIT_UTS
 Sect OctLoc
   2     074   000000 000000                                                    ....

AUDIT_UTS2
 Sect OctLoc
   2     075   000000 000000                                                    ....

(unnamed)
 Sect OctLoc
   5     000   000040 040040   000036 006000   000050 006000   000046 206000    .   .....(...&..
      163      597
      164      598    1   END TCM$WRITE_AUDIT_LOG;

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:27   
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCM$WRITE_AUDIT_LOG.
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:28   

 **** Variables and constants ****

  ****  Section 001 RoData TCM$WRITE_AUDIT_LOG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/c STRC(90)    r     1 AUDIT_NAME                 0-0-0/d STRC(1080)  r     1 CLOSE_AUDIT
   214-0-0/d STRC(360)   r     1 FPT_TRAP                 134-0-0/d STRC(432)   r     1 GET_AUDIT_KEY
   150-0-0/d STRC(432)   r     1 GET_AUDIT_KEY2           164-0-0/d STRC(432)   r     1 GET_AUDIT_TIME
   200-0-0/d STRC(432)   r     1 GET_AUDIT_TIME2           42-0-0/d STRC(2088)  r     1 OPEN_AUDIT

  ****  Section 002  Data  TCM$WRITE_AUDIT_LOG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/c STRC(936)   r     1 AUDIT_BUF                 70-0-0/c STRC(45)    r     1 AUDIT_KEY
    72-0-0/c STRC(45)    r     1 AUDIT_KEY2                74-0-0/w UBIN        r     1 AUDIT_UTS
    75-0-0/w UBIN        r     1 AUDIT_UTS2                30-0-0/d STRC(216)   r     1 FPT_XCON
     0-0-0/d STRC(432)   r     1 WRITE_AUDIT               14-0-0/d STRC(432)   r     1 WRITE_AUDIT2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM1                     4-0-0/w PTR         r     1 @PARM2
     5-0-0/w UBIN        r     1 I                         *0-0-0/w SBIN        r     1 PARM1
     6-0-0/w PTR         r     1 PARM1$                    *0-0-0/w SBIN        r     1 PARM2
     7-0-0/w PTR         r     1 PARM2$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:29   
     0-0-0/c STRC(72)    r     1 TCM_ACCOUNT                0-0-0/c CHAR(7)     r     1 TCM_PROGNAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 F$AUDIT                    0-0-0/c ASTR(9)     r     1 HOST_NAME
     0-0-0/w STRC(99)    r     1 STATUS                     0-0-0/c ACHR        r     1 TXT


   Procedure TCM$WRITE_AUDIT_LOG requires 184 words for executable code.
   Procedure TCM$WRITE_AUDIT_LOG requires 10 words of local(AUTO) storage.

    No errors detected in file TCM$MAIL2.:TCA2TSI    .
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:30   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:31   
          MINI XREF LISTING

AUDIT_BUF
       474**DCL       381--DCLINIT   382--DCLINIT   412--DCLINIT   413--DCLINIT   546--ASSIGN    577--ASSIGN
AUDIT_BUF.COUNT
       481**DCL       482--REDEF     516<<ASSIGN    535<<CALLBLT   542<<ASSIGN
AUDIT_BUF.DATE
       475**DCL       335--DCLINIT   336--DCLINIT   355--DCLINIT   356--DCLINIT
AUDIT_BUF.HOST_NAME
       485**DCL       515<<ASSIGN    520<<ASSIGN    545>>CALLBLT   546--ASSIGN    571<<ASSIGN
AUDIT_BUF.PROG
       479**DCL       525<<ASSIGN    569<<ASSIGN
AUDIT_BUF.STATUS
       482**DCL       561<<ASSIGN    566<<ASSIGN
AUDIT_BUF.TEXT
       484**DCL       517<<ASSIGN    537<<ASSIGN    539<<ASSIGN    543<<ASSIGN    570<<ASSIGN    577--ASSIGN
       580--ASSIGN
AUDIT_BUF.TIME
       477**DCL       337--DCLINIT   338--DCLINIT   357--DCLINIT   358--DCLINIT
AUDIT_KEY
       486**DCL       380--DCLINIT
AUDIT_KEY.TIME
       488**DCL       526<<ASSIGN
AUDIT_KEY2
       489**DCL       411--DCLINIT
AUDIT_KEY2.TIME
       491**DCL       576<<ASSIGN
AUDIT_NAME
       157**DCL       240--DCLINIT
AUDIT_UTS
       492**DCL       299--DCLINIT   339--DCLINIT   526>>ASSIGN
AUDIT_UTS2
       493**DCL       319--DCLINIT   359--DCLINIT   576>>ASSIGN
CLOSE_AUDIT
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:32   
       113**DCL       553<>CALL      592<>CALL
CLOSE_AUDIT.SN_
       113**DCL       113--REDEF
CLOSE_AUDIT.UTL_
       114**DCL       114--REDEF
CLOSE_AUDIT.V
       118**DCL       113--DCLINIT
CLOSE_AUDIT.V.EXPIRE#
       128**DCL       128--REDEF
CLOSE_AUDIT.V.TYPE#
       126**DCL       126--REDEF
CLOSE_AUDIT.V.XTNSIZE#
       123**DCL       123--REDEF     125--REDEF
COMMON
       569**LABEL     562--GOTO
FPT_TRAP
       445**DCL       573<>CALL
FPT_TRAP.V
       445**DCL       445--DCLINIT
FPT_XCON
       468**DCL       572<>CALL
FPT_XCON.V
       469**DCL       468--DCLINIT
FPT_XCON.V.UENTRY#
       469**DCL       567<<ASSIGN
GET_AUDIT_KEY
       295**DCL       523<>CALL
GET_AUDIT_KEY.V
       299**DCL       295--DCLINIT
GET_AUDIT_KEY2
       315**DCL       574<>CALL
GET_AUDIT_KEY2.V
       319**DCL       315--DCLINIT
GET_AUDIT_TIME
       335**DCL       524<>CALL
GET_AUDIT_TIME.V
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:33   
       339**DCL       335--DCLINIT
GET_AUDIT_TIME2
       355**DCL       575<>CALL
GET_AUDIT_TIME2.V
       359**DCL       355--DCLINIT
HOST_NAME
       495**DCL       518--IF
HOST_NAME.L
       496**DCL       497--IMP-SIZ   520>>ASSIGN
HOST_NAME.T
       497**DCL       520>>ASSIGN
I
       498**DCL       545<<CALLBLT   546>>ASSIGN    577<<ASSIGN    581<<ASSIGN    581>>ASSIGN    587>>ASSIGN
M$CLOSE
        18**DCL-ENT   553--CALL      592--CALL
M$OPEN
        18**DCL-ENT   511--CALL      583--CALL
M$TIME
        85**DCL-ENT   523--CALL      524--CALL      574--CALL      575--CALL
M$TRAP
        72**DCL-ENT   573--CALL
M$WRITE
        19**DCL-ENT   527--CALL      548--CALL      588--CALL
M$XCON
        73**DCL-ENT   572--CALL
OPEN_AUDIT
       239**DCL       511<>CALL      583<>CALL
OPEN_AUDIT.ACSVEH_
       241**DCL       242--REDEF
OPEN_AUDIT.ALTKEYS_
       247**DCL       248--REDEF     248--REDEF
OPEN_AUDIT.HDR_
       246**DCL       247--REDEF
OPEN_AUDIT.TAB_
       245**DCL       246--REDEF
OPEN_AUDIT.UHL_
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:34   
       239**DCL       240--REDEF     240--REDEF
OPEN_AUDIT.V
       248**DCL       239--DCLINIT
OPEN_AUDIT.V.FSN#
       279**DCL       279--REDEF     279--REDEF
OPEN_AUDIT.WSN_
       245**DCL       245--REDEF
PARM1
       503**DCL         8--PROC      507--IMP-SIZ   509--ASSIGN    559--ENTRY     564--ENTRY     580>>ASSIGN
       580>>ASSIGN    581>>ASSIGN
PARM1$
       504**DCL       500--IMP-PTR   509<<ASSIGN    521>>IF        534>>IF        535>>CALLBLT   543>>ASSIGN
PARM2
       505**DCL         8--PROC      510--ASSIGN    559--ENTRY     564--ENTRY     578--ASSIGN
PARM2$
       506**DCL       495--IMP-PTR   510<<ASSIGN    518>>IF        520>>ASSIGN    520>>ASSIGN    578<<ASSIGN
       579>>IF        580>>ASSIGN
STATUS
       500**DCL       521--IF
STATUS.MSGCNT
       501**DCL       534>>IF        535>>CALLBLT
STATUS.TEXT
       502**DCL       543>>ASSIGN
TCM$ABORT
       472**DCL-ENT   446--DCLINIT   446--DCLINIT   447--DCLINIT   447--DCLINIT   469--DCLINIT
TCM_ACCOUNT
       170**DCL       244--DCLINIT
TCM_PROGNAME
       499**DCL       525>>ASSIGN    536>>IF        569>>ASSIGN
TXT
       507**DCL       580<<ASSIGN    580>>ASSIGN
WRITE_AUDIT
       380**DCL       527<>CALL      548<>CALL
WRITE_AUDIT.BUF_.BOUND
       380**DCL       546<<ASSIGN
WRITE_AUDIT.STATION_
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:35   
       382**DCL       382--REDEF
WRITE_AUDIT.V
       383**DCL       380--DCLINIT
WRITE_AUDIT.V.DVBYTE.VFC#
       389**DCL       389--REDEF
WRITE_AUDIT2
       411**DCL       588<>CALL
WRITE_AUDIT2.BUF_.BOUND
       411**DCL       587<<ASSIGN
WRITE_AUDIT2.STATION_
       413**DCL       413--REDEF
WRITE_AUDIT2.V
       414**DCL       411--DCLINIT
WRITE_AUDIT2.V.DVBYTE.VFC#
       420**DCL       420--REDEF
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:36   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:37   
              MINI UREF LISTING

F$AUDIT     494**DCL
M$ACCT      35**DCL-ENT
M$ACTIVATE      38**DCL-ENT
M$ALIB      31**DCL-ENT
M$ASUSER      33**DCL-ENT
M$ATTACH      40**DCL-ENT
M$BADPP      58**DCL-ENT
M$CGCTL      39**DCL-ENT
M$CGINFO      39**DCL-ENT
M$CHECK      20**DCL-ENT
M$CHGUNIT      78**DCL-ENT
M$CLRSTK      76**DCL-ENT
M$CMDVAR      87**DCL-ENT
M$CONFIG      48**DCL-ENT
M$CORRES      23**DCL-ENT
M$CPEXIT      32**DCL-ENT
M$CVM      56**DCL-ENT
M$CVOL      21**DCL-ENT
M$DCLFLD      48**DCL-ENT
M$DEACTIVATE      38**DCL-ENT
M$DELREC      20**DCL-ENT
M$DEQ      85**DCL-ENT
M$DETACH      40**DCL-ENT
M$DEVICE      22**DCL-ENT
M$DISPLAY      85**DCL-ENT
M$DISPRES      25**DCL-ENT
M$DLIB      31**DCL-ENT
M$DRIBBLE      48**DCL-ENT
M$DRTN      76**DCL-ENT
M$DSUSER      33**DCL-ENT
M$ENQ      84**DCL-ENT
M$EOM      43**DCL-ENT
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:38   
M$ERASE      49**DCL-ENT
M$ERR      30**DCL-ENT
M$ERRMSG      81**DCL-ENT
M$EVENT      73**DCL-ENT
M$EXHUME      82**DCL-ENT
M$EXIT      30**DCL-ENT
M$EXTEND      22**DCL-ENT
M$FDP      54**DCL-ENT
M$FDS      53**DCL-ENT
M$FEBOOT      46**DCL-ENT
M$FECTL      47**DCL-ENT
M$FEDUMP      46**DCL-ENT
M$FID      81**DCL-ENT
M$FINDPROC      35**DCL-ENT
M$FSUSER      33**DCL-ENT
M$FVP      55**DCL-ENT
M$FWCG      39**DCL-ENT
M$GBPL      59**DCL-ENT
M$GDDL      55**DCL-ENT
M$GDP      54**DCL-ENT
M$GDS      53**DCL-ENT
M$GETDCB      24**DCL-ENT
M$GETMOUSE      64**DCL-ENT
M$GETPM      65**DCL-ENT
M$GJOB      83**DCL-ENT
M$GLINEATTR      43**DCL-ENT
M$GOODPP      58**DCL-ENT
M$GPLATEN      51**DCL-ENT
M$GPROMPT      50**DCL-ENT
M$GTRMATTR      44**DCL-ENT
M$GTRMCTL      42**DCL-ENT
M$GTRMTAB      45**DCL-ENT
M$GVP      54**DCL-ENT
M$HELP      81**DCL-ENT
M$INT      73**DCL-ENT
M$INTRTN      34**DCL-ENT
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:39   
M$IOQ      69**DCL-ENT
M$JOBSTATS      83**DCL-ENT
M$KEYIN      23**DCL-ENT
M$LDEV      18**DCL-ENT
M$LDTRC      31**DCL-ENT
M$LIMIT      24**DCL-ENT
M$LINES      23**DCL-ENT
M$LINK      30**DCL-ENT
M$MADMUCK      26**DCL-ENT
M$MAKUSER      57**DCL-ENT
M$MBS      25**DCL-ENT
M$MDFFLD      49**DCL-ENT
M$MERC      74**DCL-ENT
M$MERCS      75**DCL-ENT
M$MIRROR      69**DCL-ENT
M$MONINFO      86**DCL-ENT
M$MPL      59**DCL-ENT
M$NODEINFO      50**DCL-ENT
M$NXTUSR      84**DCL-ENT
M$OCMSG      82**DCL-ENT
M$OLAY      30**DCL-ENT
M$PAS      59**DCL-ENT
M$PATHCON      82**DCL-ENT
M$PDS      53**DCL-ENT
M$PFIL      20**DCL-ENT
M$PLATEN      44**DCL-ENT
M$PRECORD      22**DCL-ENT
M$PROCNAME      35**DCL-ENT
M$PROFILE      46**DCL-ENT
M$PROMPT      42**DCL-ENT
M$RACST      26**DCL-ENT
M$RDSYSLOG      67**DCL-ENT
M$READ      19**DCL-ENT
M$RELDCB      24**DCL-ENT
M$RELRES      25**DCL-ENT
M$RELSTARF      27**DCL-ENT
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:40   
M$REM      27**DCL-ENT
M$RENV      74**DCL-ENT
M$REQUIRE      26**DCL-ENT
M$RETRY      75**DCL-ENT
M$RETRYS      75**DCL-ENT
M$REW      21**DCL-ENT
M$RLSFLD      49**DCL-ENT
M$RPRIV      77**DCL-ENT
M$RSPP      56**DCL-ENT
M$RSWITCH      78**DCL-ENT
M$RUE      84**DCL-ENT
M$SAD      57**DCL-ENT
M$SAVE      33**DCL-ENT
M$SCON      34**DCL-ENT
M$SCREECH      32**DCL-ENT
M$SENV      74**DCL-ENT
M$SETFMA      18**DCL-ENT
M$SETFP      47**DCL-ENT
M$SINPUT      45**DCL-ENT
M$SLCFLD      50**DCL-ENT
M$SMOUSE      64**DCL-ENT
M$SMPRT      56**DCL-ENT
M$SPRIV      77**DCL-ENT
M$SSC      57**DCL-ENT
M$SSWITCH      77**DCL-ENT
M$STATE      86**DCL-ENT
M$STD      58**DCL-ENT
M$STIMER      72**DCL-ENT
M$STLPP      55**DCL-ENT
M$STRAP      72**DCL-ENT
M$STRMATTR      44**DCL-ENT
M$STRMCTL      42**DCL-ENT
M$STRMTAB      45**DCL-ENT
M$SYMBIO      83**DCL-ENT
M$SYSCON      69**DCL-ENT
M$SYSID      87**DCL-ENT
PL6.E3A0      #001=TCM$WRITE_AUDIT_LOG File=TCM$MAIL2.:TCA2TSI                   SUN 11/16/97 14:17 Page:41   
M$TDCLOSE      68**DCL-ENT
M$TDIO      68**DCL-ENT
M$TDOPEN      67**DCL-ENT
M$TDREQCPU      68**DCL-ENT
M$TEMPWROC      62**DCL-ENT
M$TRMISC      47**DCL-ENT
M$TRMPRG      43**DCL-ENT
M$TRTN      76**DCL-ENT
M$TRUNC      19**DCL-ENT
M$TTIMER      72**DCL-ENT
M$UC      42**DCL
M$UMPL      59**DCL-ENT
M$UNFID      81**DCL-ENT
M$UNLATCH      38**DCL-ENT
M$UNSHARE      35**DCL-ENT
M$USRFIELD      78**DCL-ENT
M$VIRTUAL      53**DCL-ENT
M$WAIT      76**DCL-ENT
M$WEOF      21**DCL-ENT
M$WRSYSLOG      67**DCL-ENT
M$XCONRTN      34**DCL-ENT
M$XEQTIME      86**DCL-ENT
M$XFLUSH      27**DCL-ENT
M$XMOUSE      64**DCL-ENT
M$XXX      30**DCL-ENT
M$YC      32**DCL-ENT
TCM$WRITE_AUDIT_LOG       8**PROC
TCM$WRITE_AUDIT_OFF     564**ENTRY
TCM$WRITE_AUDIT_ON     559**ENTRY
