VERSION A02

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:1    
        1        1        /*M* TCI$INETD - inetd (internet daemon (ghost)). */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F* NAME: TCI$INETD
        8        8             DESCRIPTION: inetd performs for CP-6 the same service it does in unix.
        9        9              From a script file (etc:inetd_conf) it does listens on service ports, and
       10       10              when an incoming connection happens, starts or restarts a ghost job to
       11       11              service the connection.
       12       12        */
       13       13
       14       14
       15       15
       16       16
       17       17
       18       18        TCI$INETD: PROC MAIN;
       19       19        %INCLUDE CP_6;
       20      100            %F$DCB;
       21      157        %INCLUDE B_ERRORS_C;
       22     1284        %INCLUDE B$TABLES_C;
       23     1392            %B$XL_UPPER;
       24     1396        %INCLUDE B$JIT;
       25     1686    1       DCL B$JIT$ PTR SYMREF READONLY;
       26     1687        %B$ALT;
       27     1695        %B$TCB;
       28     1698    1       DCL B$TCB$ PTR SYMREF READONLY;
       29     1699            %M$DCB( DCBN=M$SI, ASN=FILE, NAME='etc:inetd_conf', ACCT=':SYS');
       30     1773            %M$DCB( DCBN=M$DS, ASN=FILE, NAME='inetd:', ACCT=':SYS', FUN=CREATE,
       31     1774                    CTG=YES, EXIST=OLDFILE, SHARE=ALL, ACS=DS8, ORG=RANDOM);
       32     1848    1       DCL BDS8B CONSTANT UBIN INIT(%(11+6*512));
       33     1849    1       DCL B$DS8$ REDEF BDS8B PTR;
       34     1850    1       DCL 1 ZAPDS BASED(B$DS8$) ALIGNED,2 * CHAR(1),2 * CHAR(S_BLK.WORK.DSZ.B);
       35     1851    1       DCL M$DO DCB;
       36     1852    1       DCL M$LM DCB;
       37     1853    1       DCL M$UI DCB;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:2    
       38     1854            %FPT_READ( DCB=M$SI, BUF=S_BLK.BUF, STCLASS=CONSTANT);
       39     1893            %FPT_EXTEND( DCB=M$DS, SIZ=1, STCLASS=CONSTANT);
       40     1907    1       DCL 1 FPT_STATE DALIGNED CONSTANT,
       41     1908    1          2 V_ VECTOR INIT( VECTOR( S_BLK.ARRAY)),
       42     1909    1          2 BUF_ VECTOR INIT( VECTOR( S_BLK.ARRAY));
       43     1910            %FPT_PRIV( FPTN=SYS_PRIV, STCLASS=CONSTANT, PRIV=%PR_MSYS#);
       44     1925            %FPT_PRIV( FPTN=FMSEC_PRIV, STCLASS=CONSTANT, PRIV=%PR_FMSEC#);
       45     1940            %FPT_GJOB( STCLASS=CONSTANT, NAME=S_BLK.WORK.NAME, ACCT=S_BLK.WORK.ACCT,
       46     1941                       PASS=S_BLK.WORK.PSWD, CCBUF=S_BLK.BUF, RESULTS=S_BLK.WORK.SYSID);
       47     1958            %FPT_CLOSE( FPTN=CLOSE_SI, DCB=M$SI, STCLASS=CONSTANT);
       48     2000            %FPT_CLOSE( FPTN=CLOSE_DO, DCB=M$DO, DISP=SAVE, STCLASS=CONSTANT);
       49     2042            %FPT_LDEV( FPTN=PRINT_IT, STREAMNAME='LP01', STCLASS=CONSTANT);
       50     2067            %FPT_KEYIN;
       51     2086            %FPT_WAIT( UNITS=5);
       52     2100            %FPT_TIME( TIME=S_BLK.TSTAMP.TIME, DATE=S_BLK.TSTAMP.DATE, DEST=LOCAL);
       53     2119            %FPT_WRITE( DCB=M$DO, BUF=S_BLK.BUF);
       54     2150            %FPT_ERRMSG( OUTDCB1=M$DO, BUF=S_BLK.BUF, CODE=P_PCB.ERROR,
       55     2151              SOURCE=ALTRET, INCLCODE=NO, FLAGLEV=3);
       56     2178            %FPT_GDS( RESULTS=S_BLK.WORK.ACCT, SEGSIZE=1024);
       57     2194            %FPT_LDTRC( TEXTC=NO);
       58     2212
       59     2213        %INCLUDE SS_SCHED_C;
       60     2446
       61     2447        %INCLUDE XSL_SOCKET_E;
       62     2705        %INCLUDE XSL_SOCKET_M;
       63     3466            %XSL$HOSTENT;
       64     3526            %XSL$PROTOENT;
       65     3569            %XSL$SERVENT;
       66     3620            %XSL_SOCKINIT( FPTN=TCI_SOCKINIT, MAXSOCK=36, NWSOCKS=0, STCLASS=
              3620                "CONSTANT SYMDEF");
       67     3743        %INCLUDE XSL_PERR_C;
       68     3798        %INCLUDE XSL_INTERNAL_M;
       69     4049            %XSL$INETD( FPTN=INETD, STCLASS="BASED(INETD$)");
       70     4129            %XSL$INETD( FPTN=INETD_INIT, STCLASS=CONSTANT);
       71     4209    1       DCL 1 DS BASED(CTX$) ALIGNED,
       72     4210            %XSL$INETD_DS( FPTN="PTRS(0:127)", LVL=2, LAST=",");
       73     4236    1           2 CTX DALIGNED,
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:3    
       74     4237    1               3 BUF CHAR(256),
       75     4238    1               3 ACCT CHAR(8),
       76     4239    1               3 NAME(0:12) CHAR(1),
       77     4240    1               3 CONNECTS SBIN(27) CALIGNED,
       78     4241    1               3 PSWD CHAR(8),
       79     4242    1               3 SYSID UBIN HALF UNAL,
       80     4243    1               3 INETD# SBIN HALF UNAL,
       81     4244    1               3 SOCKET# SBIN,
       82     4245    1               3 SERVICE CHAR(16),
       83     4246    1               3 HOST CHAR(16),
       84     4247    1               3 TYPE SBIN,
       85     4248                    %XSL$SOCKADDR_IN( FPTN=LISTEN, LVL=3);
       86     4312            %XSL$SOCKHD( STCLASS="BASED(XSL_SOCK$$)");
       87     4345    1       DCL XSL_SOCK$$ PTR SYMREF;
       88     4346    1       DCL XSL_SN CHAR(6) SYMREF;
       89     4347            %XSL$SOCKINFO;
       90     4491
       91     4492        %INCLUDE TCI_NODES_E;
       92     4531        %INCLUDE XU_FORMAT_C;
       93     4693    1       DCL X$WRITE ENTRY(22);
       94     4694            %F_FDS( NAME=FDS, DCB=M$DO, BUF=S_BLK.BUF);
       95     4807            %MACRO F(T='.',LAST(YES=";")=",");
       96     4808            2 * CHAR(0) INIT(T)LAST
       97     4809            %MEND;
       98     4810    1       DCL 1 STT_FMT CONSTANT,
       99     4811            %LIST;
      100     4812            %F(T='%18N[INETD is not running - last status follows:%/%]');
              4813    1       2 * CHAR(0) INIT(T)LAST
      101     4815            %TCI_FMTSTRING;
              4816            %F(T="'%128='");
              4817    1       2 * CHAR(0) INIT(T)LAST
              4819            %F(T="'%.1C'"); /* subroutine to display XSL$INETDs */
              4820    1       2 * CHAR(0) INIT(T)LAST
              4822              %F(T="'%18N:1=('");
              4823    1       2 * CHAR(0) INIT(T)LAST
              4825                %F(T="'%.1#:2+P%/-%7.18D'"); /* sysid */
              4826    1       2 * CHAR(0) INIT(T)LAST
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:4    
              4828                %F(T="'%1S%6.9D'"); /* state */
              4829    1       2 * CHAR(0) INIT(T)LAST
              4831                %F(T="'%2S%18N.1=%8.18D   '"); /* save flink, display ldctx */
              4832    1       2 * CHAR(0) INIT(T)LAST
              4834                %F(T="'%6A%9D'"); /* rname, errno */
              4835    1       2 * CHAR(0) INIT(T)LAST
              4837                %F(T="'  %10S%@16N.2=%3(%.9D.%)%.9D,%.2#KD'"); /* peer address */
              4838    1       2 * CHAR(0) INIT(T)LAST
              4840                %F(T="'%1#)'");
              4841    1       2 * CHAR(0) INIT(T)LAST
              4843              %F(T="'%C'");
              4844    1       2 * CHAR(0) INIT(T)LAST
              4846            %F(T="'Service         Host            Connects  Command%/'");
              4847    1       2 * CHAR(0) INIT(T)LAST
              4849            %F(T="'   Sysid State   Ldctx   Rname     Errno  Client Address%/'");
              4850    1       2 * CHAR(0) INIT(T)LAST
              4852            %F(T="'-------------------------------------------------%/'");
              4853    1       2 * CHAR(0) INIT(T)LAST
              4855            %F(T="'%^%.#:74+P%.16A'");
              4856    1       2 * CHAR(0) INIT(T)LAST
              4858              %F(T="'%.16A'");
              4859    1       2 * CHAR(0) INIT(T)LAST
              4861              %F(T="'%.#:69+.1P%8.27D  '");
              4862    1       2 * CHAR(0) INIT(T)LAST
              4864              %F(T="'%.#P%.256>A'");
              4865    1       2 * CHAR(0) INIT(T)LAST
              4867              %F(T="'%.#:72+P%1.18N[%/   ... waiting for network connect'");
              4868    1       2 * CHAR(0) INIT(T)LAST
              4870                %F(T="'%2?%2S%/   ***%..J'");
              4871    1       2 * CHAR(0) INIT(T)LAST
              4873                %F(T="'%3?%/   *** service suspended%1C'");
              4874    1       2 * CHAR(0) INIT(T)LAST
              4876                %F(T="'%?%1C'");
              4877    1       2 * CHAR(0) INIT(T)LAST
              4879                %F(T="'%]'");
              4880    1       2 * CHAR(0) INIT(T)LAST
              4882              %F(T="'%#:88+=%.#P%9N[%1Q%]%/'",LAST=YES);
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:5    
              4883    1       2 * CHAR(0) INIT(T)LAST
      102     4886            %PLIST;
      103     4887
      104     4888
      105     4889        %INCLUDE XU_MACRO_C;
      106     7995        %INCLUDE XU_SUBS_C;
      107     8087            %P_PCB( STCLASS=STATIC, W=S_BLK.WORK, WSZ="SIZEW(S_BLK.WORK)", T=S_BLK.BUF,
      108     8088                    N#="SIZEC(S_BLK.BUF)", R=TCI_CMD);
      109     8287            %PARSE$OUT( NAME=P$OUT, STCLASS="BASED(P_PCB.OUT$)");
      110     8332            %PARSE$SYM( NAME=P$SYM, STCLASS=BASED);
      111     8370
      112     8371    1       DCL X$PARSE ENTRY(1) ALTRET;
      113     8372    1       DCL XSL$QACCEPT_INETD ENTRY(3) ALTRET;
      114     8373    1       DCL XSL$QBIND ENTRY(4) ALTRET;
      115     8374    1       DCL XSL$QCLOSE ENTRY(2) ALTRET;
      116     8375    1       DCL XSL$GETPROTOBYNAME ENTRY(2) ALTRET;
      117     8376    1       DCL XSL$GETHOSTBYNAME ENTRY(2) ALTRET;
      118     8377    1       DCL XSL$GETSERVBYNAME ENTRY(3) ALTRET;
      119     8378    1       DCL XSL$QLISTEN ENTRY(3) ALTRET;
      120     8379    1       DCL XSL$QSELECT ENTRY(6) ALTRET;
      121     8380    1       DCL XSL$QSETSOCKOPT ENTRY(6) ALTRET;
      122     8381    1       DCL XSL$QSOCKET ENTRY(4) ALTRET;
      123     8382    1       DCL XSL$SOCKINIT ENTRY(1) ALTRET;
      124     8383    1       DCL XSL$HTONL ENTRY(2);
      125     8384
      126     8385    1       DCL XSL_ERRNO SBIN SYMREF;
      127     8386
      128     8387    1       DCL TCI_CMD UBIN SYMREF;
      129     8388
      130     8389    1       DCL 1 S_BLK STATIC DALIGNED,
      131     8390    1           2 BUF CHAR(256),
      132     8391    1           2 ARRAY(0:63) REDEF BUF UBIN,
      133     8392    1             2 TSTAMP REDEF BUF,
      134     8393    1               3 LEAD CHAR(7),
      135     8394    1               3 DATE CHAR(9),
      136     8395    1               3 TIME CHAR(11),
      137     8396    1               3 T REDEF TIME,
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:6    
      138     8397    1                 4 TIME CHAR(5),
      139     8398    1                 4 TRAIL CHAR(6),
      140     8399    1               3 * CHAR(229),
      141     8400    1           2 WORK,
      142     8401    1               3 ACCT CHAR(8) INIT(%CONCAT('      ',BINASC(6),BINASC(11))),
      143     8402    1               3 DSCR_ REDEF ACCT DSCR DALIGNED,
      144     8403    1               3 DSZ REDEF ACCT,
      145     8404    1                   4 B UBIN(20) UNAL, 4 * BIT(52),
      146     8405    1               3 NAME CHAR(16),
      147     8406    1               3 PSWD CHAR(8),
      148     8407    1               3 SYSID UBIN HALF DALIGNED, /* Second word is socket# */
      149     8408    1               3 * CHAR(472);
      150     8409    1       DCL SELECT_MASK(0:35) STATIC BIT(1) INIT('0'B*0);
      151     8410
      152     8411    1       DCL CTX$ PTR;
      153     8412    1       DCL 1 CTX# REDEF CTX$, 2 OFFSET UBIN HALF UNAL, 2 * BIT(18);
      154     8413    1       DCL INETD$ PTR;
      155     8414    1       DCL 1 INETD# REDEF INETD$, 2 OFFSET UBIN HALF UNAL, 2 * BIT(18);
      156     8415    1       DCL MAXCTX$ PTR;
      157     8416    1       DCL SRVR_COUNT SBIN STATIC INIT(-1);
      158     8417    1       DCL SERV$ PTR;
      159     8418    1       DCL PROTO$ PTR;
      160     8419    1       DCL P$OUT$ PTR;
      161     8420    1       DCL MAXINETD$ PTR;
      162     8421    1       DCL I SBIN;
      163     8422    1       DCL SELECT_RESULT(0:35) BIT(1);
      164     8423    1       DCL B$UBIN UBIN BASED;
      165     8424    1       DCL B$PTR PTR BASED;
      166     8425    1       DCL WAIT_MASK(0:35) STATIC BIT(1) INIT('0'B*0);
      167     8426    1       DCL WAIT_NETS STATIC CHAR(64) INIT(' ');
      168     8427    1       DCL WAIT_NETSZ STATIC SBIN INIT(0);
      169     8428    1       DCL WAIT_SN CHAR(6);
      170     8429    1       DCL RB CHAR(1) STATIC INIT(')');
      171     8430    1       DCL LB CHAR(1) STATIC INIT('(');
      172     8431
      173     8432        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:7    
      174     8433    2       CALL M$SPRIV( FMSEC_PRIV) WHENALTRETURN DO; END;
      175     8434    1       FPT_LDTRC.NAME_ = VECTOR( DCBADDR( DCBNUM( M$LM))->F$DCB.NAME#);
      176     8435    1       FPT_LDTRC.ACCT_ = VECTOR( DCBADDR( DCBNUM( M$LM))->F$DCB.ACCT#);
      177     8436    1       FPT_LDTRC.CMD_ = VECTOR( B$JIT.CCBUF);
      178     8437    2       CALL INDEX1R(I, LB, B$JIT.CCBUF) WHENRETURN DO; GOTO SYNTXERR; END;
      179     8438    2       CALL INDEX1R(I, RB, B$JIT.CCBUF) WHENRETURN DO;
      180     8439    2   SYNTXERR:;
      181     8440    2          CALL CONCAT(S_BLK.BUF, 'Syntax error in command.');
      182     8441    2          FPT_WRITE.BUF_.BOUND = 24;
      183     8442    2          CALL M$WRITE(FPT_WRITE);
      184     8443    2          CALL M$EXIT;
      185     8444    2       END;
      186     8445
      187     8446    1       CALL XLATE( S_BLK.BUF, B$XL_UPPER, DCBADDR( DCBNUM( M$SI))->F$DCB.NAME#.C);
      188     8447
      189     8448    2       IF S_BLK.BUF = 'RESTART' OR S_BLK.BUF = 'PRINT' THEN DO;
      190     8449    2           CALL M$SPRIV( SYS_PRIV) ALTRET(MONERR);
      191     8450    2           CALL M$REW( FPT_EXTEND) ALTRET(MONERR);
      192     8451    2           S_BLK.ARRAY( 4) = B$DS8$->DS.PTRS.SYSID( 0);
      193     8452    2           B$DS8$->DS.PTRS.SYSID( 0) = ASCBIN('R')-ASCBIN(SUBSTR(S_BLK.BUF,0,1));
      194     8453    2           S_BLK.ARRAY( 0) = S_BLK.ARRAY( 4);
      195     8454    2           CALL M$STATE( FPT_STATE);
      196     8455    3           IF S_BLK.ARRAY( 0) ~= %SS_SNULL THEN DO; /* Still ok - Restart it */
      197     8456    3               S_BLK.ARRAY( 0) = S_BLK.ARRAY( 4)*262144 + %SS_WU*512;
      198     8457    3               CALL M$RUE( FPT_STATE) ALTRET(MONERR);
      199     8458    3               END;
      200     8459    2           RETURN;
      201     8460    2           END;
      202     8461
      203     8462    2       IF S_BLK.BUF = 'STATUS' THEN DO;
      204     8463    2           CALL M$REW( FPT_EXTEND) ALTRET(MONERR);
      205     8464    2           IF NOT B$JIT.PRIV.JOB.FMSEC THEN CALL M$RPRIV( FMSEC_PRIV);
      206     8465    2           S_BLK.ARRAY( 0) = B$DS8$->DS.PTRS.SYSID( 0);
      207     8466    2           CALL M$STATE(FPT_STATE);
      208     8467    2           IF S_BLK.ARRAY( 0) = %SS_SNULL THEN B$DS8$->DS.PTRS.SYSID( 0) = 0;
      209     8468    2   FMTIT:  S_BLK.WORK.DSCR_ = PTRDSCR(B$DS8$);
      210     8469    2           CALL X$WRITE( FDS, VECTOR( STT_FMT), VECTOR( ZAPDS));
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:8    
      211     8470    2           IF SRVR_COUNT<0 THEN RETURN;
      212     8471    2           CALL M$LDTRC( FPT_LDTRC) ALTRET( MONABRT);
      213     8472    2           END;
      214     8473
      215     8474    2       IF B$JIT.MODE ~= %M_GHOST# THEN DO;
      216     8475    2           IF NOT B$JIT.PRIV.JOB.FMSEC THEN CALL M$RPRIV( FMSEC_PRIV);
      217     8476    2           CALL M$GDS( FPT_GDS) ALTRET( MONERR);
      218     8477    2           END;
      219     8478    2       ELSE DO;
      220     8479    2           CALL M$REW( FPT_EXTEND) ALTRET( MONERR);
      221     8480    2           SRVR_COUNT = 0;
      222     8481    2           END;
      223     8482    1       S_BLK.WORK.DSCR_ = PTRDSCR(B$DS8$);
      224     8483    1       ZAPDS = '0'B;
      225     8484    1       B$DS8$->DS.PTRS.SYSID( 0) = B$JIT.SYSID;
      226     8485    1       CTX$ = B$DS8$;
      227     8486    1       MAXCTX$ = PINCRW( B$DS8$, DBOUND( S_BLK.WORK.DSCR_) / 4 + 1 - SIZEW( DS));
      228     8487    1       MAXINETD$ = PINCRW( MAXCTX$, SIZEW( DS) - SIZEW( INETD));
      229     8488    1       CALL TSTAMP;
      230     8489    1       CALL XSL$SOCKINIT( TCI_SOCKINIT) ALTRET( MONERR);
      231     8490
      232     8491        /* First read all the config information. */
      233     8492    2       DO WHILE '1'B;
      234     8493    2           S_BLK.BUF = ' ';
      235     8494    3           CALL M$READ( FPT_READ) WHENALTRETURN DO;
      236     8495    3               IF DCBADDR( DCBNUM( M$SI)) -> F$DCB.TYC.EOF# THEN
      237     8496    3                   GOTO DONE_READING;
      238     8497    3               GOTO MONERR;
      239     8498    3               END;
      240     8499    2           P_PCB.NCHARS = MAXIMUM( DCBADDR( DCBNUM( M$SI)) -> F$DCB.ARS#, 1);
      241     8500    2           FPT_WRITE.BUF_.BOUND = P_PCB.NCHARS-1;
      242     8501    3           CALL X$PARSE( P_PCB) WHENALTRETURN DO;
      243     8502    3               CALL M$WRITE( FPT_WRITE);
      244     8503    3               GOTO PARSE_ERROR;
      245     8504    3               END;
      246     8505
      247     8506    2           DS.CTX = '0'B;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:9    
      248     8507    2           DS.CTX.LISTEN.SA_FAMILY = %XSL_AF_INET;
      249     8508    2           DS.CTX.TYPE = %XSL_SOCK_STREAM;
      250     8509    3           DO I=0 TO P$OUT.NSUBLKS-1;
      251     8510    4               DO CASE( P$OUT.SUBLK$( I) -> P$OUT.CODE);
      252     8511    4                CASE( %TCI_SERVICE);
      253     8512    4                   SERV$ = P$OUT.SUBLK$( I)-> P$OUT.SUBLK$( 0);
      254     8513    4                   DS.CTX.SERVICE = SERV$ -> P$SYM.TEXT;
      255     8514    4                CASE( %TCI_HOST);
      256     8515    4                   CALL CONCAT( DS.CTX.HOST,
      257     8516    4                     P$OUT.SUBLK$( I)-> P$OUT.SUBLK$( 0)-> P$SYM.TEXT, BINASC( 0));
      258     8517    4                   CALL XSL$GETHOSTBYNAME( P$OUT$, DS.CTX.HOST) ALTRET( BAD_HOST);
      259     8518    4                   DS.CTX.LISTEN.S_ADDR = P$OUT$->XSL$HOSTENT.H_ADDR_LIST$->B$PTR->
              8518                            B$UBIN;
      260     8519    4                CASE( %TCI_PROTOCOL);
      261     8520    4                   PROTO$ = P$OUT.SUBLK$( I) -> P$OUT.SUBLK$( 0) -> P$SYM.TEXTC$;
      262     8521    4                CASE( %TCI_TYPE);
      263     8522    4                   DS.CTX.TYPE = P$OUT.SUBLK$( I) -> P$OUT.SUBLK$( 0) -> P$OUT.CODE;
      264     8523    4                CASE( %TCI_USERID);
      265     8524    4                   P$OUT$ = P$OUT.SUBLK$( I);
      266     8525    4                   DS.CTX.ACCT = P$OUT$ -> P$OUT.SUBLK$( 0) -> P$SYM.TEXT;
      267     8526    4                   DS.CTX.NAME = P$OUT$ -> P$OUT.SUBLK$( 1) -> P$SYM.TEXTC$ -> DS;
      268     8527    4                   DS.CTX.PSWD = ' ';
      269     8528    4                   IF P$OUT$ -> P$OUT.NSUBLKS = 2 THEN EXIT;
      270     8529    4                   SUBSTR( S_BLK.BUF, P$OUT$ -> P$OUT.SUBLK$( 2) -> P$SYM.CPOS,
      271     8530    4                     P$OUT$ -> P$OUT.SUBLK$( 2) -> P$SYM.COUNT) = 'xxxxxxxx';
      272     8531    4                   DS.CTX.PSWD = P$OUT$ -> P$OUT.SUBLK$( 2) -> P$SYM.TEXT;
      273     8532    4                CASE( %TCI_PROGRAM, %TCI_CCBUF);
      274     8533    4                   IF P$OUT.SUBLK$( I) -> P$OUT.SUBLK$( 0) -> P$SYM.CODE = 0
      275     8534    4                   THEN DS.CTX.BUF =
      276     8535    4                     SUBSTR( S_BLK.BUF, P$OUT.SUBLK$( I) -> P$OUT.CPOS);
      277     8536    4                END;
      278     8537    3               END;
      279     8538
      280     8539    2           CALL M$WRITE( FPT_WRITE); /* Print after scratching out passwords */
      281     8540    2           IF I=0 THEN GOTO NEXT_LINE; /* That'd be a comment */
      282     8541    3           IF SERV$=ADDR( NIL) THEN DO;
      283     8542    3               XSL_ERRNO = %E$NOENT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:10   
      284     8543    3               GOTO BAD_SERVICE;
      285     8544    3               END;
      286     8545    3           IF SERV$ -> P$SYM.NDTYPE = %DEC# THEN DO;
      287     8546    3               CALL CHARBIN( DS.CTX.LISTEN.S_PORT, SERV$->P$SYM.TEXT);
      288     8547    3               CALL XSL$HTONL( DS.CTX.LISTEN.S_PORT, DS.CTX.LISTEN.S_PORT);
      289     8548    3               END;
      290     8549    3           ELSE DO;
      291     8550    3               CALL XSL$GETSERVBYNAME( SERV$, SERV$->P$SYM.COUNT, PROTO$->DS)
      292     8551    3                 ALTRET( BAD_SERVICE);
      293     8552    3               DS.CTX.LISTEN.S_PORT = SERV$ -> XSL$SERVENT.S_PORT;
      294     8553    3               END;
      295     8554    2           IF SRVR_COUNT < 0 THEN GOTO NEXT_LINE;
      296     8555    2           CALL OPEN_CTX ALTRET (BAD_SERVICE);
      297     8556
      298     8557    2   NEXT_CTX: ;
      299     8558    2           CTX$ = PINCRW( CTX$, SIZEW( DS.CTX));
      300     8559    3           IF CTX$ > MAXCTX$ THEN DO;
      301     8560    3               CALL M$EXTEND( FPT_EXTEND);
      302     8561    3               MAXCTX$ = PINCRW( MAXCTX$, 1024);
      303     8562    3               MAXINETD$ = PINCRW( MAXINETD$, 1024);
      304     8563    3               END;
      305     8564    2           SRVR_COUNT = SRVR_COUNT + 1;
      306     8565    2   NEXT_LINE: ;
      307     8566    3           DO WHILE '0'B;
      308     8567    3   BAD_HOST: ;
      309     8568    3   BAD_SERVICE: ;
      310     8569    3               P_PCB.ERROR = '302314'O | BINBIT( XSL_ERRNO,33);
      311     8570    3               IF XSL_ERRNO>0 THEN
      312     8571    3   PARSE_ERROR:    FPT_ERRMSG.V.SOURCE# = 0;
      313     8572    3   MONERR:;
      314     8573    3               CALL M$ERRMSG( FPT_ERRMSG);
      315     8574    4               IF FPT_ERRMSG.V.SOURCE# = 0 THEN DO;
      316     8575    4                   DS.CTX.SYSID = 2;
      317     8576    4                   DS.CTX.SOCKET# = BITBIN(P_PCB.ERROR);
      318     8577    4                   GOTO NEXT_CTX;
      319     8578    4                   END;
      320     8579    3               FPT_ERRMSG.V.SOURCE# = 2;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:11   
      321     8580    3               IF NOT DCBADDR( DCBNUM( M$SI))-> F$DCB.FCD# THEN GOTO DONE_READING;
      322     8581    3               END;
      323     8582    2           END;
      324     8583        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:12   
      325     8584    1   DONE_READING:;
      326     8585    1       CALL M$CLOSE( CLOSE_SI);
      327     8586    1       MAXCTX$ = CTX$;
      328     8587    1       IF SRVR_COUNT < 0 THEN CALL M$EXIT;
      329     8588    2       CALL M$SPRIV( SYS_PRIV) WHENALTRETURN DO;
      330     8589    2   MONABRT: CALL M$ERRMSG( FPT_ERRMSG);
      331     8590    2           CALL M$XXX;
      332     8591    2           END;
      333     8592        /* Set up DS.PTRS(0) for GET_INETD */
      334     8593    1       B$DS8$ -> DS.PTRS.OFFSET( 0) = CTX#.OFFSET +SIZEW( DS.PTRS) -SIZEW( INETD);
      335     8594
      336     8595    1   DO_SELECT:;
      337     8596    2       IF NOT SELECT_MASK AND NOT WAIT_MASK THEN DO; /* Nothing to do, give up */
      338     8597    2           CALL TSTAMP;
      339     8598    2           S_BLK.BUF = 'INETD abort - no services to service.';
      340     8599    2   INETD_QUIT:;
      341     8600    2           FPT_WRITE.BUF_.BOUND = 37;
      342     8601    2           CALL M$WRITE( FPT_WRITE);
      343     8602    2           FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;
      344     8603    3           CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;
      345     8604    2           SRVR_COUNT = -1;
      346     8605    2           GOTO FMTIT;
      347     8606    2           END;
      348     8607    1       IF SELECT_RESULT THEN I = 0; /* Poll if waiting for a server to start */
      349     8608    1       ELSE IF WAIT_MASK THEN I = 5;
      350     8609    1       ELSE I = 60;
      351     8610    1       SELECT_RESULT = SELECT_MASK;
      352     8611    1       CALL XSL$QSELECT( I, SRVR_COUNT, SELECT_RESULT, , , I);
      353     8612    1       IF B$DS8$ -> DS.PTRS.SYSID( 0) > 10 AND /* are we still in charge? */
      354     8613    2         B$DS8$ -> DS.PTRS.SYSID( 0) ~= B$JIT.SYSID THEN DO;
      355     8614    2           CALL TSTAMP;
      356     8615    2           S_BLK.BUF = 'INETD abort - another INETD has assumed control.';
      357     8616    2           GOTO INETD_QUIT;
      358     8617    2           END;
      359     8618    1       IF B$DS8$ -> DS.PTRS.SYSID( 0) <= 10 AND NOT SELECT_RESULT
      360     8619    2       THEN IF B$DS8$ -> DS.PTRS.SYSID( 0) = 2 /* 'R'-'P' */ THEN DO;
      361     8620    2           B$DS8$ -> DS.PTRS.SYSID( 0) = B$JIT.SYSID;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:13   
      362     8621    2           S_BLK.WORK.DSCR_ = PTRDSCR( B$DS8$);
      363     8622    2           CALL X$WRITE( FDS, VECTOR( STT_FMT), VECTOR( ZAPDS));
      364     8623    2           CALL M$CLOSE( CLOSE_DO);
      365     8624    2           CALL M$LDEV( PRINT_IT);
      366     8625    2           END;
      367     8626    1       ELSE GOTO FMTIT;
      368     8627    1       IF I<=0 AND SELECT_RESULT THEN
      369     8628    1           IF XSL_ERRNO<0 THEN GOTO FMTIT;
      370     8629    1           ELSE GOTO DO_SELECT;
      371     8630    1       CTX$ = B$DS8$;
      372     8631    1       INETD$ = B$DS8$;
      373     8632    2       DO UNTIL CTX$ = MAXCTX$;
      374     8633    2           INETD#.OFFSET = DS.CTX.INETD#;
      375     8634    3           IF DS.CTX.SYSID=0 AND SELECT_RESULT( DS.CTX.SOCKET#) THEN DO WHILE '1'B;
      376     8635    3               IF INETD#.OFFSET = 0 THEN CALL GET_INETD ALTRET( WAIT_A_BIT);
      377     8636    4               IF INETD.FPT_RUE.SYSID = 0 THEN DO; /* Need to start a server */
      378     8637    4                   PINCRW( ADDR( S_BLK), - SIZEW( DS.PTRS)) -> DS.CTX = DS.CTX;
      379     8638    5                   CALL M$GJOB( FPT_GJOB) WHENALTRETURN DO;
      380     8639    5                       P_PCB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      381     8640    5   ERRMSG_KILL: ;
      382     8641    5                       CALL TSTAMP;
      383     8642    5                       FPT_ERRMSG.V.SOURCE# = 0;
      384     8643    5                       CALL M$ERRMSG( FPT_ERRMSG);
      385     8644    5                       FPT_ERRMSG.V.SOURCE# = 2;
      386     8645    6                       IF P_PCB.ERROR.CODE = %E$NGHUSR THEN DO;
      387     8646    6                           CALL CONCAT( S_BLK.BUF,
      388     8647    6                             'Failed to start a ghost user for ', DS.CTX.SERVICE);
      389     8648    6                           FPT_WRITE.BUF_.BOUND = 44;
      390     8649    6                           CALL M$WRITE( FPT_WRITE);
      391     8650    6                           FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;
      392     8651    7                           CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;
      393     8652    6                           SELECT_MASK( DS.CTX.SOCKET#) = '0'B;
      394     8653    6                           CALL XSL$QCLOSE( I, DS.CTX.SOCKET#);
      395     8654    6                           DS.CTX.SYSID = 0;
      396     8655    6                           CALL OPEN_CTX ALTRET (KILL_SERVICE);
      397     8656    6                           GOTO WAIT_A_BIT;
      398     8657    6                           END;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:14   
      399     8658    5                       GOTO KILL_SERVICE;
      400     8659    5                       END;
      401     8660    4                   INETD.FPT_RUE.SYSID = S_BLK.WORK.SYSID;
      402     8661    4                   B$DS8$ -> DS.PTRS.SYSID( ( INETD#.OFFSET - B$DS8$ ->
      403     8662    4                     DS.PTRS.OFFSET( 0) ) / SIZEW( INETD) ) = S_BLK.WORK.SYSID;
      404     8663    4                   END;
      405     8664
      406     8665    4               IF INETD.FPT_RUE.STATE = 0 THEN DO; /* Waiting for accept_srvr */
      407     8666    4                   S_BLK.ARRAY( 0) = INETD.FPT_RUE.SYSID;
      408     8667    4                   CALL M$STATE( FPT_STATE);
      409     8668    4                   IF S_BLK.ARRAY( 0) ~= %SS_SNULL THEN GOTO WAIT_A_BIT;
      410     8669    4                   DS.CTX.CONNECTS = DS.CTX.CONNECTS + 1;
      411     8670    4                   CALL TSTAMP;
      412     8671    4   KILL_SERVICE: ;
      413     8672    4                   CALL CONCAT( S_BLK.BUF,
      414     8673    4                     'Server failed to connect - suspending service for ',
      415     8674    4                     DS.CTX.SERVICE);
      416     8675    4                   FPT_WRITE.BUF_.BOUND = 61;
      417     8676    4                   CALL M$WRITE( FPT_WRITE);
      418     8677    4                   FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;
      419     8678    5                   CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;
      420     8679    4                   SELECT_MASK( DS.CTX.SOCKET#) = '0'B;
      421     8680    4                   CALL XSL$QCLOSE( I, DS.CTX.SOCKET#);
      422     8681    4                   DS.CTX.SYSID = 3;
      423     8682    4                   GOTO WAIT_A_BIT;
      424     8683    4                   END;
      425     8684    4               IF INETD.FPT_RUE.STATE = 1 THEN DO; /* Server awaits our accept */
      426     8685    4                   DS.CTX.CONNECTS = DS.CTX.CONNECTS + 1;
      427     8686    4                   CALL XSL$QACCEPT_INETD( I, DS.CTX.SOCKET#, INETD)
      428     8687    5                   WHENRETURN DO;
      429     8688    5                   GOTO WAIT_A_BIT;
      430     8689    5                   END;
      431     8690    4                   END;
      432     8691    4               IF INETD.ERRNO ~= 0 THEN DO;
      433     8692    4                   IF INETD.ERRNO < 0 THEN
      434     8693    4                       P_PCB.ERROR = BINBIT( INETD.ERRNO,36);
      435     8694    4                   ELSE P_PCB.ERROR = '302314'O | BINBIT( INETD.ERRNO,33);
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:15   
      436     8695    4                   GOTO ERRMSG_KILL;
      437     8696    4                   END;
      438     8697    3               INETD#.OFFSET = INETD.INETD#; /* Next in chain */
      439     8698    3               END;
      440     8699    3           ELSE IF DS.CTX.SYSID=1 THEN DO; /* waiting, actually */
      441     8700    3               CALL XSL$QBIND( I, DS.CTX.SOCKET#, DS.CTX.LISTEN, 8)
      442     8701    4               WHENRETURN DO;
      443     8702    4                   CALL XSL$QLISTEN( I, DS.CTX.SOCKET#, 1) ALTRET( KILL_SERVICE);
      444     8703    4                   DS.CTX.SYSID = 0;
      445     8704    4                   WAIT_MASK( DS.CTX.SOCKET#) = '0'B;
      446     8705    4                   SELECT_MASK( DS.CTX.SOCKET#) = '1'B;
      447     8706    4                   WAIT_SN = DCBADDR( XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)->
      448     8707    4                     XSL$SOCKINFO.DCB#)-> F$DCB.PSN#;
      449     8708    4                   CALL INDEX( I, WAIT_SN, WAIT_NETS);
      450     8709    4                   IF I>=WAIT_NETSZ THEN EXIT;
      451     8710    4                   CALL TSTAMP;
      452     8711    4                   SUBSTR( WAIT_NETS, I) = SUBSTR( WAIT_NETS, I+8);
      453     8712    4                   WAIT_NETSZ = WAIT_NETSZ-8;
      454     8713    4                   CALL CONCAT( S_BLK.BUF, 'Connect received from ', WAIT_SN);
      455     8714    4                   FPT_WRITE.BUF_.BOUND = 27;
      456     8715    4                   CALL M$WRITE( FPT_WRITE);
      457     8716    4                   FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;
      458     8717    4                   CALL M$KEYIN( FPT_KEYIN);
      459     8718    4                   END;
      460     8719    3               END;
      461     8720    2   WAIT_A_BIT: ;
      462     8721    2           CTX$ = PINCRW( CTX$, SIZEW( DS.CTX));
      463     8722    2           END;
      464     8723    1       GOTO DO_SELECT;
      465     8724        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:16   
      466     8725    1   TSTAMP: PROC;
      467     8726    2           S_BLK.BUF = ' -*-*-';
      468     8727    2           CALL M$TIME( FPT_TIME);
      469     8728    2           S_BLK.TSTAMP.T.TRAIL = ' -*-*-';
      470     8729    2           FPT_WRITE.BUF_.BOUND = 26;
      471     8730    2           CALL M$WRITE( FPT_WRITE);
      472     8731    2   END TSTAMP;
      473     8732        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:17   
      474     8733    1   OPEN_CTX: PROC ALTRET;
      475     8734    2       WAIT_SN = XSL_SN;
      476     8735    2       XSL_SN = 'xxxxxx';
      477     8736    2       CALL XSL$QSOCKET( DS.CTX.SOCKET#, %XSL_AF_INET, DS.CTX.TYPE, %XSL_AF_INET)
      478     8737    2         ALTRET (NO_SOCKET);
      479     8738    2       XSL_SN = WAIT_SN;
      480     8739    2       CALL XSL$QSETSOCKOPT( I, DS.CTX.SOCKET#, %XSL_SOL_SOCKET,
      481     8740    2         %XSL_SO_REUSEADDR, 262144, 2) ALTRET (NO_SETSOCKOPT);
      482     8741    2       XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)-> XSL$SOCKINFO.SOCKNAME = DS.CTX.LISTEN;
      483     8742    3       CALL XSL$QBIND( I, DS.CTX.SOCKET#, DS.CTX.LISTEN, 8) WHENRETURN DO;
      484     8743    3           CALL XSL$QLISTEN( I, DS.CTX.SOCKET#, 1) ALTRET (NO_LISTEN);
      485     8744    3           SELECT_MASK( DS.CTX.SOCKET#) = '1'B;
      486     8745    3           END;
      487     8746    3       WHENALTRETURN DO;
      488     8747    3           IF XSL_ERRNO > 0 THEN GOTO NO_BIND;
      489     8748    3           WAIT_SN = DCBADDR( XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)->
      490     8749    3             XSL$SOCKINFO.DCB#)-> F$DCB.PSN#;
      491     8750    3           CALL INDEX( I, WAIT_SN, WAIT_NETS);
      492     8751    3           SUBSTR( WAIT_NETS, WAIT_NETSZ, 8) = WAIT_SN;
      493     8752    3           IF WAIT_NETSZ<SIZEC( WAIT_NETS)-8 THEN WAIT_NETSZ = WAIT_NETSZ+8;
      494     8753    3           CALL CONCAT( S_BLK.BUF, 'Waiting for connect from ', WAIT_SN);
      495     8754    3           FPT_WRITE.BUF_.BOUND = 30;
      496     8755    3           CALL M$WRITE( FPT_WRITE);
      497     8756    3           DS.CTX.SYSID = 1;
      498     8757    3           WAIT_MASK( DS.CTX.SOCKET#) = '1'B;
      499     8758    3           IF I<WAIT_NETSZ THEN EXIT;
      500     8759    3           FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;
      501     8760    4           CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;
      502     8761    3           END;
      503     8762    2       RETURN;
      504     8763
      505     8764    2   NO_BIND:;
      506     8765    2   NO_LISTEN:;
      507     8766    2   NO_SETSOCKOPT:;
      508     8767    2       I = XSL_ERRNO;
      509     8768    2       IF I >= 0 THEN CALL XSL$QCLOSE( DS.CTX.ACCT, DS.CTX.SOCKET#);
      510     8769    2       XSL_ERRNO = I;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:18   
      511     8770    2   NO_SOCKET:;
      512     8771    2       ALTRETURN;
      513     8772    2   END OPEN_CTX;
      514     8773        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:19   
      515     8774    1   GET_INETD: PROC ALTRET;
      516     8775
      517     8776    2       I = 1;
      518     8777    3   FIND_ONE: DO WHILE '1'B;
      519     8778    3           IF I = SIZEW( DS.PTRS) - 1 THEN ALTRETURN; /* Won't fit in the PTRS */
      520     8779    4           IF B$DS8$ -> DS.PTRS.OFFSET( I) = 0 THEN DO;
      521     8780    4               B$DS8$ -> DS.PTRS.OFFSET( I) =
      522     8781    4                 B$DS8$ -> DS.PTRS.OFFSET( I-1) + SIZEW( INETD);
      523     8782    4               INETD#.OFFSET = B$DS8$ -> DS.PTRS.OFFSET( I);
      524     8783    5               IF INETD$ > MAXINETD$ THEN DO;
      525     8784    5                   CALL M$EXTEND( FPT_EXTEND);
      526     8785    5                   MAXINETD$ = PINCRW( MAXINETD$, 1024);
      527     8786    5                   END;
      528     8787    4               GOTO NEW_ENTRY;
      529     8788    4               END;
      530     8789
      531     8790    3           INETD#.OFFSET = B$DS8$ -> DS.PTRS.OFFSET( I);
      532     8791    4           IF INETD.FPT_RUE.STATE ~= 1 THEN DO;
      533     8792    4              S_BLK.ARRAY( 0) = INETD.FPT_RUE.SYSID;
      534     8793    4              CALL M$STATE( FPT_STATE);
      535     8794    4              IF S_BLK.ARRAY( 0) = %SS_SNULL THEN EXIT FIND_ONE;
      536     8795    4              END;
      537     8796    3           I = I + 1;
      538     8797    3           END FIND_ONE;
      539     8798    2       B$DS8$ -> DS.PTRS.SYSID( I) = 0;
      540     8799    2       I = INETD.CTX#; /* Remove from the chain off CTX */
      541     8800    2       IF PINCRW( B$DS8$, I) -> DS.CTX.INETD# = INETD#.OFFSET
      542     8801    2       THEN PINCRW( B$DS8$, I) -> DS.CTX.INETD# = INETD.INETD#;
      543     8802    3       ELSE DO;
      544     8803    3           I = PINCRW( B$DS8$, I) -> DS.CTX.INETD#;
      545     8804    4           DO WHILE '1'B;
      546     8805    4               IF PINCRW( B$DS8$, I) -> INETD.INETD# = INETD#.OFFSET THEN EXIT;
      547     8806    4               I = PINCRW( B$DS8$, I) -> INETD.INETD#;
      548     8807    4               END;
      549     8808    3           PINCRW( B$DS8$, I) -> INETD.INETD# = INETD.INETD#;
      550     8809    3           END;
      551     8810
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:20   
      552     8811    2   NEW_ENTRY: ;
      553     8812    2       INETD = INETD_INIT;
      554     8813    2       INETD.INETD# = DS.CTX.INETD#;
      555     8814    2       INETD.CTX# = CTX#.OFFSET;
      556     8815    2       INETD.FPT_RUE.EVENT = %SS_WU;
      557     8816    2       VBASE( INETD.FPT_RUE.V_) = ADDR( INETD.FPT_RUE.SYSID);
      558     8817    2       DS.CTX.INETD# = INETD#.OFFSET;
      559     8818    2       INETD.NAME = XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)-> XSL$SOCKINFO.SOCKNAME;
      560     8819    2       INETD.SERNUM = XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)-> XSL$SOCKINFO.SERNUM;
      561     8820    2   END GET_INETD;
      562     8821
      563     8822    1       END TCI$INETD;

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:21   
--  Include file information  --

   XU_SUBS_C.:LIBRARY  is referenced.
   XU_MACRO_C.:LIBRARY  is referenced.
   XU_FORMAT_C.:LIBRARY  is referenced.
   TCI_NODES_E.:TCA2TOU  is referenced.
   XSL_INTERNAL_M.:TCA2TOU  is referenced.
   XSL_PERR_C.:TCA2TOU  is referenced.
   XSL_SOCKET_M.:TCA2TOU  is referenced.
   XSL_SOCKET_E.:TCA2TOU  is referenced.
   SS_SCHED_C.:LIBRARY  is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIBRARY  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCI$INETD.

   Procedure TCI$INETD requires 1211 words for executable code.
   Procedure TCI$INETD requires 22 words of local(AUTO) storage.

    No errors detected in file TCI$INETD.:TCA2TSI    .

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:22   

 Object Unit name= TCI$INETD                                  File name= TCI$INETD.:TCA2TOU
 UTS= NOV 16 '97 14:14:39.64 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none    98    142  M$SI
    2   DCB   even  none    98    142  M$DS
    3  RoData even  UTS    344    530  TCI$INETD
    4   DCB   even  none     0      0  M$DO
    5   DCB   even  none     0      0  M$LM
    6   DCB   even  none     0      0  M$UI
    7   Data  even  none   350    536  TCI$INETD
    8   Proc  even  none  1211   2273  TCI$INETD
    9  RoData even  none    25     31  TCI$INETD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes            yes      Main       0  TCI$INETD

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    3    176  TCI_SOCKINIT
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:23   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       3 XSL$GETSERVBYNAME
 yes     yes           Std       3 XSL$QACCEPT_INETD
         yes           Std      22 X$WRITE
 yes     yes           Std       2 XSL$QCLOSE
 yes     yes           Std       6 XSL$QSELECT
         yes           Std       2 XSL$HTONL
 yes     yes           Std       4 XSL$QBIND
 yes     yes           Std       1 XSL$SOCKINIT
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       3 XSL$QLISTEN
 yes     yes           Std       2 XSL$GETHOSTBYNAME
 yes     yes           Std       4 XSL$QSOCKET
 yes     yes           Std       6 XSL$QSETSOCKOPT
                       nStd      0 X66_MAUTO
                       nStd      0 X66_MARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_INDEX

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    B$XL_UPPER$                      r    B$JIT$
r    B$TCB$                                M$SI                                  M$DS
     M$DO                                  M$LM                                  M$UI
     XSL_SOCK$$                            XSL_SN                                XSL_ERRNO
     TCI_CMD                               B_VECTNIL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:24   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:25   


        1        1        /*M* TCI$INETD - inetd (internet daemon (ghost)). */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F* NAME: TCI$INETD
        8        8             DESCRIPTION: inetd performs for CP-6 the same service it does in unix.
        9        9              From a script file (etc:inetd_conf) it does listens on service ports, and
       10       10              when an incoming connection happens, starts or restarts a ghost job to
       11       11              service the connection.
       12       12        */
       13       13
       14       14
       15       15
       16       16
       17       17
       18       18        TCI$INETD: PROC MAIN;

     18  8 000000   000000 700200 xent  TCI$INETD    TSX0  ! X66_MAUTO
         8 000001   000026 000000                    ZERO    22,0

       19       19        %INCLUDE CP_6;
       20      100            %F$DCB;
       21      157        %INCLUDE B_ERRORS_C;
       22     1284        %INCLUDE B$TABLES_C;
       23     1392            %B$XL_UPPER;
       24     1396        %INCLUDE B$JIT;
       25     1686    1       DCL B$JIT$ PTR SYMREF READONLY;
       26     1687        %B$ALT;
       27     1695        %B$TCB;
       28     1698    1       DCL B$TCB$ PTR SYMREF READONLY;
       29     1699            %M$DCB( DCBN=M$SI, ASN=FILE, NAME='etc:inetd_conf', ACCT=':SYS');
       30     1773            %M$DCB( DCBN=M$DS, ASN=FILE, NAME='inetd:', ACCT=':SYS', FUN=CREATE,
       31     1774                    CTG=YES, EXIST=OLDFILE, SHARE=ALL, ACS=DS8, ORG=RANDOM);
       32     1848    1       DCL BDS8B CONSTANT UBIN INIT(%(11+6*512));
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:26   
       33     1849    1       DCL B$DS8$ REDEF BDS8B PTR;
       34     1850    1       DCL 1 ZAPDS BASED(B$DS8$) ALIGNED,2 * CHAR(1),2 * CHAR(S_BLK.WORK.DSZ.B);
       35     1851    1       DCL M$DO DCB;
       36     1852    1       DCL M$LM DCB;
       37     1853    1       DCL M$UI DCB;
       38     1854            %FPT_READ( DCB=M$SI, BUF=S_BLK.BUF, STCLASS=CONSTANT);
       39     1893            %FPT_EXTEND( DCB=M$DS, SIZ=1, STCLASS=CONSTANT);
       40     1907    1       DCL 1 FPT_STATE DALIGNED CONSTANT,
       41     1908    1          2 V_ VECTOR INIT( VECTOR( S_BLK.ARRAY)),
       42     1909    1          2 BUF_ VECTOR INIT( VECTOR( S_BLK.ARRAY));
       43     1910            %FPT_PRIV( FPTN=SYS_PRIV, STCLASS=CONSTANT, PRIV=%PR_MSYS#);
       44     1925            %FPT_PRIV( FPTN=FMSEC_PRIV, STCLASS=CONSTANT, PRIV=%PR_FMSEC#);
       45     1940            %FPT_GJOB( STCLASS=CONSTANT, NAME=S_BLK.WORK.NAME, ACCT=S_BLK.WORK.ACCT,
       46     1941                       PASS=S_BLK.WORK.PSWD, CCBUF=S_BLK.BUF, RESULTS=S_BLK.WORK.SYSID);
       47     1958            %FPT_CLOSE( FPTN=CLOSE_SI, DCB=M$SI, STCLASS=CONSTANT);
       48     2000            %FPT_CLOSE( FPTN=CLOSE_DO, DCB=M$DO, DISP=SAVE, STCLASS=CONSTANT);
       49     2042            %FPT_LDEV( FPTN=PRINT_IT, STREAMNAME='LP01', STCLASS=CONSTANT);
       50     2067            %FPT_KEYIN;
       51     2086            %FPT_WAIT( UNITS=5);
       52     2100            %FPT_TIME( TIME=S_BLK.TSTAMP.TIME, DATE=S_BLK.TSTAMP.DATE, DEST=LOCAL);
       53     2119            %FPT_WRITE( DCB=M$DO, BUF=S_BLK.BUF);
       54     2150            %FPT_ERRMSG( OUTDCB1=M$DO, BUF=S_BLK.BUF, CODE=P_PCB.ERROR,
       55     2151              SOURCE=ALTRET, INCLCODE=NO, FLAGLEV=3);
       56     2178            %FPT_GDS( RESULTS=S_BLK.WORK.ACCT, SEGSIZE=1024);
       57     2194            %FPT_LDTRC( TEXTC=NO);
       58     2212
       59     2213        %INCLUDE SS_SCHED_C;
       60     2446
       61     2447        %INCLUDE XSL_SOCKET_E;
       62     2705        %INCLUDE XSL_SOCKET_M;
       63     3466            %XSL$HOSTENT;
       64     3526            %XSL$PROTOENT;
       65     3569            %XSL$SERVENT;
       66     3620            %XSL_SOCKINIT( FPTN=TCI_SOCKINIT, MAXSOCK=36, NWSOCKS=0, STCLASS=
              3620                "CONSTANT SYMDEF");
       67     3743        %INCLUDE XSL_PERR_C;
       68     3798        %INCLUDE XSL_INTERNAL_M;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:27   
       69     4049            %XSL$INETD( FPTN=INETD, STCLASS="BASED(INETD$)");
       70     4129            %XSL$INETD( FPTN=INETD_INIT, STCLASS=CONSTANT);
       71     4209    1       DCL 1 DS BASED(CTX$) ALIGNED,
       72     4210            %XSL$INETD_DS( FPTN="PTRS(0:127)", LVL=2, LAST=",");
       73     4236    1           2 CTX DALIGNED,
       74     4237    1               3 BUF CHAR(256),
       75     4238    1               3 ACCT CHAR(8),
       76     4239    1               3 NAME(0:12) CHAR(1),
       77     4240    1               3 CONNECTS SBIN(27) CALIGNED,
       78     4241    1               3 PSWD CHAR(8),
       79     4242    1               3 SYSID UBIN HALF UNAL,
       80     4243    1               3 INETD# SBIN HALF UNAL,
       81     4244    1               3 SOCKET# SBIN,
       82     4245    1               3 SERVICE CHAR(16),
       83     4246    1               3 HOST CHAR(16),
       84     4247    1               3 TYPE SBIN,
       85     4248                    %XSL$SOCKADDR_IN( FPTN=LISTEN, LVL=3);
       86     4312            %XSL$SOCKHD( STCLASS="BASED(XSL_SOCK$$)");
       87     4345    1       DCL XSL_SOCK$$ PTR SYMREF;
       88     4346    1       DCL XSL_SN CHAR(6) SYMREF;
       89     4347            %XSL$SOCKINFO;
       90     4491
       91     4492        %INCLUDE TCI_NODES_E;
       92     4531        %INCLUDE XU_FORMAT_C;
       93     4693    1       DCL X$WRITE ENTRY(22);
       94     4694            %F_FDS( NAME=FDS, DCB=M$DO, BUF=S_BLK.BUF);
       95     4807            %MACRO F(T='.',LAST(YES=";")=",");
       96     4808            2 * CHAR(0) INIT(T)LAST
       97     4809            %MEND;
       98     4810    1       DCL 1 STT_FMT CONSTANT,
       99     4811            %LIST;
      100     4812            %F(T='%18N[INETD is not running - last status follows:%/%]');
              4813    1       2 * CHAR(0) INIT(T)LAST
      101     4815            %TCI_FMTSTRING;
              4816            %F(T="'%128='");
              4817    1       2 * CHAR(0) INIT(T)LAST
              4819            %F(T="'%.1C'"); /* subroutine to display XSL$INETDs */
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:28   
              4820    1       2 * CHAR(0) INIT(T)LAST
              4822              %F(T="'%18N:1=('");
              4823    1       2 * CHAR(0) INIT(T)LAST
              4825                %F(T="'%.1#:2+P%/-%7.18D'"); /* sysid */
              4826    1       2 * CHAR(0) INIT(T)LAST
              4828                %F(T="'%1S%6.9D'"); /* state */
              4829    1       2 * CHAR(0) INIT(T)LAST
              4831                %F(T="'%2S%18N.1=%8.18D   '"); /* save flink, display ldctx */
              4832    1       2 * CHAR(0) INIT(T)LAST
              4834                %F(T="'%6A%9D'"); /* rname, errno */
              4835    1       2 * CHAR(0) INIT(T)LAST
              4837                %F(T="'  %10S%@16N.2=%3(%.9D.%)%.9D,%.2#KD'"); /* peer address */
              4838    1       2 * CHAR(0) INIT(T)LAST
              4840                %F(T="'%1#)'");
              4841    1       2 * CHAR(0) INIT(T)LAST
              4843              %F(T="'%C'");
              4844    1       2 * CHAR(0) INIT(T)LAST
              4846            %F(T="'Service         Host            Connects  Command%/'");
              4847    1       2 * CHAR(0) INIT(T)LAST
              4849            %F(T="'   Sysid State   Ldctx   Rname     Errno  Client Address%/'");
              4850    1       2 * CHAR(0) INIT(T)LAST
              4852            %F(T="'-------------------------------------------------%/'");
              4853    1       2 * CHAR(0) INIT(T)LAST
              4855            %F(T="'%^%.#:74+P%.16A'");
              4856    1       2 * CHAR(0) INIT(T)LAST
              4858              %F(T="'%.16A'");
              4859    1       2 * CHAR(0) INIT(T)LAST
              4861              %F(T="'%.#:69+.1P%8.27D  '");
              4862    1       2 * CHAR(0) INIT(T)LAST
              4864              %F(T="'%.#P%.256>A'");
              4865    1       2 * CHAR(0) INIT(T)LAST
              4867              %F(T="'%.#:72+P%1.18N[%/   ... waiting for network connect'");
              4868    1       2 * CHAR(0) INIT(T)LAST
              4870                %F(T="'%2?%2S%/   ***%..J'");
              4871    1       2 * CHAR(0) INIT(T)LAST
              4873                %F(T="'%3?%/   *** service suspended%1C'");
              4874    1       2 * CHAR(0) INIT(T)LAST
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:29   
              4876                %F(T="'%?%1C'");
              4877    1       2 * CHAR(0) INIT(T)LAST
              4879                %F(T="'%]'");
              4880    1       2 * CHAR(0) INIT(T)LAST
              4882              %F(T="'%#:88+=%.#P%9N[%1Q%]%/'",LAST=YES);
              4883    1       2 * CHAR(0) INIT(T)LAST
      102     4886            %PLIST;
      103     4887
      104     4888
      105     4889        %INCLUDE XU_MACRO_C;
      106     7995        %INCLUDE XU_SUBS_C;
      107     8087            %P_PCB( STCLASS=STATIC, W=S_BLK.WORK, WSZ="SIZEW(S_BLK.WORK)", T=S_BLK.BUF,
      108     8088                    N#="SIZEC(S_BLK.BUF)", R=TCI_CMD);
      109     8287            %PARSE$OUT( NAME=P$OUT, STCLASS="BASED(P_PCB.OUT$)");
      110     8332            %PARSE$SYM( NAME=P$SYM, STCLASS=BASED);
      111     8370
      112     8371    1       DCL X$PARSE ENTRY(1) ALTRET;
      113     8372    1       DCL XSL$QACCEPT_INETD ENTRY(3) ALTRET;
      114     8373    1       DCL XSL$QBIND ENTRY(4) ALTRET;
      115     8374    1       DCL XSL$QCLOSE ENTRY(2) ALTRET;
      116     8375    1       DCL XSL$GETPROTOBYNAME ENTRY(2) ALTRET;
      117     8376    1       DCL XSL$GETHOSTBYNAME ENTRY(2) ALTRET;
      118     8377    1       DCL XSL$GETSERVBYNAME ENTRY(3) ALTRET;
      119     8378    1       DCL XSL$QLISTEN ENTRY(3) ALTRET;
      120     8379    1       DCL XSL$QSELECT ENTRY(6) ALTRET;
      121     8380    1       DCL XSL$QSETSOCKOPT ENTRY(6) ALTRET;
      122     8381    1       DCL XSL$QSOCKET ENTRY(4) ALTRET;
      123     8382    1       DCL XSL$SOCKINIT ENTRY(1) ALTRET;
      124     8383    1       DCL XSL$HTONL ENTRY(2);
      125     8384
      126     8385    1       DCL XSL_ERRNO SBIN SYMREF;
      127     8386
      128     8387    1       DCL TCI_CMD UBIN SYMREF;
      129     8388
      130     8389    1       DCL 1 S_BLK STATIC DALIGNED,
      131     8390    1           2 BUF CHAR(256),
      132     8391    1           2 ARRAY(0:63) REDEF BUF UBIN,
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:30   
      133     8392    1             2 TSTAMP REDEF BUF,
      134     8393    1               3 LEAD CHAR(7),
      135     8394    1               3 DATE CHAR(9),
      136     8395    1               3 TIME CHAR(11),
      137     8396    1               3 T REDEF TIME,
      138     8397    1                 4 TIME CHAR(5),
      139     8398    1                 4 TRAIL CHAR(6),
      140     8399    1               3 * CHAR(229),
      141     8400    1           2 WORK,
      142     8401    1               3 ACCT CHAR(8) INIT(%CONCAT('      ',BINASC(6),BINASC(11))),
      143     8402    1               3 DSCR_ REDEF ACCT DSCR DALIGNED,
      144     8403    1               3 DSZ REDEF ACCT,
      145     8404    1                   4 B UBIN(20) UNAL, 4 * BIT(52),
      146     8405    1               3 NAME CHAR(16),
      147     8406    1               3 PSWD CHAR(8),
      148     8407    1               3 SYSID UBIN HALF DALIGNED, /* Second word is socket# */
      149     8408    1               3 * CHAR(472);
      150     8409    1       DCL SELECT_MASK(0:35) STATIC BIT(1) INIT('0'B*0);
      151     8410
      152     8411    1       DCL CTX$ PTR;
      153     8412    1       DCL 1 CTX# REDEF CTX$, 2 OFFSET UBIN HALF UNAL, 2 * BIT(18);
      154     8413    1       DCL INETD$ PTR;
      155     8414    1       DCL 1 INETD# REDEF INETD$, 2 OFFSET UBIN HALF UNAL, 2 * BIT(18);
      156     8415    1       DCL MAXCTX$ PTR;
      157     8416    1       DCL SRVR_COUNT SBIN STATIC INIT(-1);
      158     8417    1       DCL SERV$ PTR;
      159     8418    1       DCL PROTO$ PTR;
      160     8419    1       DCL P$OUT$ PTR;
      161     8420    1       DCL MAXINETD$ PTR;
      162     8421    1       DCL I SBIN;
      163     8422    1       DCL SELECT_RESULT(0:35) BIT(1);
      164     8423    1       DCL B$UBIN UBIN BASED;
      165     8424    1       DCL B$PTR PTR BASED;
      166     8425    1       DCL WAIT_MASK(0:35) STATIC BIT(1) INIT('0'B*0);
      167     8426    1       DCL WAIT_NETS STATIC CHAR(64) INIT(' ');
      168     8427    1       DCL WAIT_NETSZ STATIC SBIN INIT(0);
      169     8428    1       DCL WAIT_SN CHAR(6);
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:31   
      170     8429    1       DCL RB CHAR(1) STATIC INIT(')');
      171     8430    1       DCL LB CHAR(1) STATIC INIT('(');
      172     8431
      173     8432        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:32   
      174     8433    2       CALL M$SPRIV( FMSEC_PRIV) WHENALTRETURN DO; END;

   8433  8 000002   000034 630400 3                  EPPR0   FMSEC_PRIV
         8 000003   420012 713400                    CLIMB   alt,+8202
         8 000004   400000 401760                    pmme    nvectors=1
         8 000005   000007 702000 8                  TSX2    s:8434
         8 000006   000007 710000 8                  TRA     s:8434

      175     8434    1       FPT_LDTRC.NAME_ = VECTOR( DCBADDR( DCBNUM( M$LM))->F$DCB.NAME#);

   8434  8 000007   000000 236007 xsym               LDQ     M$LM,DL
         8 000010   000000 470400 9                  LDP0    0
         8 000011   000000 471500                    LDP1    0,,PR0
         8 000012   100000 473506                    LDP3    0,QL,PR1
         8 000013   000001 235000 9                  LDA     1
         8 000014   200020 453500                    STP3    WAIT_SN+4,,AUTO
         8 000015   200020 236100                    LDQ     WAIT_SN+4,,AUTO
         8 000016   000010 036003                    ADLQ    8,DU
         8 000017   000114 757000 7                  STAQ    FPT_LDTRC

      176     8435    1       FPT_LDTRC.ACCT_ = VECTOR( DCBADDR( DCBNUM( M$LM))->F$DCB.ACCT#);

   8435  8 000020   000000 236007 xsym               LDQ     M$LM,DL
         8 000021   100000 473506                    LDP3    0,QL,PR1
         8 000022   000002 235000 9                  LDA     2
         8 000023   200020 453500                    STP3    WAIT_SN+4,,AUTO
         8 000024   200020 236100                    LDQ     WAIT_SN+4,,AUTO
         8 000025   000020 036003                    ADLQ    16,DU
         8 000026   000116 757000 7                  STAQ    FPT_LDTRC+2

      177     8436    1       FPT_LDTRC.CMD_ = VECTOR( B$JIT.CCBUF);

   8436  8 000027   000003 235000 9                  LDA     3
         8 000030   000000 236000 xsym               LDQ     B$JIT$
         8 000031   000033 036003                    ADLQ    27,DU
         8 000032   000124 757000 7                  STAQ    FPT_LDTRC+8

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:33   
      178     8437    2       CALL INDEX1R(I, LB, B$JIT.CCBUF) WHENRETURN DO; GOTO SYNTXERR; END;

   8437  8 000033   000000 473400 xsym               LDP3    B$JIT$
         8 000034   000000 125500                    SCMR    mask='000'O
         8 000035   300033 000400                    ADSC9   27,,PR3                  cn=0,n=256
         8 000036   000535 000001 7                  ADSC9   LB                       cn=0,n=1
         8 000037   200012 000100                    ARG     I,,AUTO
         8 000040   000044 606400 8                  TTN     s:8438
         8 000041   000377 236007                    LDQ     255,DL
         8 000042   200012 156100                    SSQ     I,,AUTO

   8437  8 000043   000054 710000 8                  TRA     SYNTXERR

      179     8438    2       CALL INDEX1R(I, RB, B$JIT.CCBUF) WHENRETURN DO;

   8438  8 000044   000000 470400 xsym               LDP0    B$JIT$
         8 000045   000000 125500                    SCMR    mask='000'O
         8 000046   000033 000400                    ADSC9   27,,PR0                  cn=0,n=256
         8 000047   000534 000001 7                  ADSC9   RB                       cn=0,n=1
         8 000050   200012 000100                    ARG     I,,AUTO
         8 000051   000070 606400 8                  TTN     s:8446
         8 000052   000377 236007                    LDQ     255,DL
         8 000053   200012 156100                    SSQ     I,,AUTO

   8436  8 000054                       SYNTXERR     null
      180     8439    2   SYNTXERR:;
      181     8440    2          CALL CONCAT(S_BLK.BUF, 'Syntax error in command.');

   8440  8 000054   040000 100400                    MLR     fill='040'O
         8 000055   000417 000030 3                  ADSC9   STT_FMT+125              cn=0,n=24
         8 000056   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256

      182     8441    2          FPT_WRITE.BUF_.BOUND = 24;

   8441  8 000057   000044 236000 7                  LDQ     FPT_WRITE+4
         8 000060   177777 376007                    ANQ     65535,DL
         8 000061   000006 276003                    ORQ     6,DU
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:34   
         8 000062   000044 756000 7                  STQ     FPT_WRITE+4

      183     8442    2          CALL M$WRITE(FPT_WRITE);

   8442  8 000063   000040 630400 7                  EPPR0   FPT_WRITE
         8 000064   040001 713400                    CLIMB   write
         8 000065   401400 401760                    pmme    nvectors=4

      184     8443    2          CALL M$EXIT;

   8443  8 000066   000001 713400                    CLIMB   exit
         8 000067   000000 401760                    pmme    nvectors=0

      185     8444    2       END;

      186     8445
      187     8446    1       CALL XLATE( S_BLK.BUF, B$XL_UPPER, DCBADDR( DCBNUM( M$SI))->F$DCB.NAME#.C);

   8446  8 000070   000000 236007 xsym               LDQ     M$SI,DL
         8 000071   000000 470400 9                  LDP0    0
         8 000072   000000 471500                    LDP1    0,,PR0
         8 000073   100000 473506                    LDP3    0,QL,PR1
         8 000074   000000 474400 xsym               LDP4    B$XL_UPPER$
         8 000075   040000 160500                    MVT     fill='040'O
         8 000076   300010 200037                    ADSC9   8,,PR3                   cn=1,n=31
         8 000077   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256
         8 000100   400000 000100                    ARG     0,,PR4

      188     8447
      189     8448    2       IF S_BLK.BUF = 'RESTART' OR S_BLK.BUF = 'PRINT' THEN DO;

   8448  8 000101   040000 106400                    CMPC    fill='040'O
         8 000102   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256
         8 000103   000425 000007 3                  ADSC9   STT_FMT+131              cn=0,n=7
         8 000104   000111 600000 8                  TZE     s:8449
         8 000105   040000 106400                    CMPC    fill='040'O
         8 000106   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:35   
         8 000107   000427 000005 3                  ADSC9   STT_FMT+133              cn=0,n=5
         8 000110   000153 601000 8                  TNZ     s:8462

      190     8449    2           CALL M$SPRIV( SYS_PRIV) ALTRET(MONERR);

   8449  8 000111   000030 630400 3                  EPPR0   SYS_PRIV
         8 000112   420012 713400                    CLIMB   alt,+8202
         8 000113   400000 401760                    pmme    nvectors=1
         8 000114   000716 702000 8                  TSX2    MONERR

      191     8450    2           CALL M$REW( FPT_EXTEND) ALTRET(MONERR);

   8450  8 000115   000020 630400 3                  EPPR0   FPT_EXTEND
         8 000116   440006 713400                    CLIMB   alt,+16390
         8 000117   400000 401760                    pmme    nvectors=1
         8 000120   000716 702000 8                  TSX2    MONERR

      192     8451    2           S_BLK.ARRAY( 4) = B$DS8$->DS.PTRS.SYSID( 0);

   8451  8 000121   000000 470400 3                  LDP0    BDS8B
         8 000122   000000 236100                    LDQ     0,,PR0
         8 000123   000022 772000                    QRL     18
         8 000124   000214 756000 7                  STQ     S_BLK+4

      193     8452    2           B$DS8$->DS.PTRS.SYSID( 0) = ASCBIN('R')-ASCBIN(SUBSTR(S_BLK.BUF,0,1));

   8452  8 000125   000210 236000 7                  LDQ     S_BLK
         8 000126   000033 772000                    QRL     27
         8 000127   777655 620006                    EAX0    -83,QL
         8 000130   777777 660003                    ERX0    -1,DU
         8 000131   000000 740100                    STX0    0,,PR0

      194     8453    2           S_BLK.ARRAY( 0) = S_BLK.ARRAY( 4);

   8453  8 000132   000214 235000 7                  LDA     S_BLK+4
         8 000133   000210 755000 7                  STA     S_BLK

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:36   
      195     8454    2           CALL M$STATE( FPT_STATE);

   8454  8 000134   000024 630400 3                  EPPR0   FPT_STATE
         8 000135   020010 713400                    CLIMB   8200
         8 000136   400400 401760                    pmme    nvectors=2

      196     8455    3           IF S_BLK.ARRAY( 0) ~= %SS_SNULL THEN DO; /* Still ok - Restart it */

   8455  8 000137   000210 235000 7                  LDA     S_BLK
         8 000140   000030 115007                    CMPA    24,DL
         8 000141   000152 600000 8                  TZE     s:8459

      197     8456    3               S_BLK.ARRAY( 0) = S_BLK.ARRAY( 4)*262144 + %SS_WU*512;

   8456  8 000142   000214 236000 7                  LDQ     S_BLK+4
         8 000143   000022 736000                    QLS     18
         8 000144   027000 036007                    ADLQ    11776,DL
         8 000145   000210 756000 7                  STQ     S_BLK

      198     8457    3               CALL M$RUE( FPT_STATE) ALTRET(MONERR);

   8457  8 000146   000024 630400 3                  EPPR0   FPT_STATE
         8 000147   420020 713400                    CLIMB   alt,+8208
         8 000150   400000 401760                    pmme    nvectors=1
         8 000151   000716 702000 8                  TSX2    MONERR

      199     8458    3               END;

      200     8459    2           RETURN;

   8459  8 000152   000000 702200 xent               TSX2  ! X66_MARET

      201     8460    2           END;
      202     8461
      203     8462    2       IF S_BLK.BUF = 'STATUS' THEN DO;

   8462  8 000153   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:37   
         8 000154   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256
         8 000155   000431 000006 3                  ADSC9   STT_FMT+135              cn=0,n=6
         8 000156   000240 601000 8                  TNZ     s:8474

      204     8463    2           CALL M$REW( FPT_EXTEND) ALTRET(MONERR);

   8463  8 000157   000020 630400 3                  EPPR0   FPT_EXTEND
         8 000160   440006 713400                    CLIMB   alt,+16390
         8 000161   400000 401760                    pmme    nvectors=1
         8 000162   000716 702000 8                  TSX2    MONERR

      205     8464    2           IF NOT B$JIT.PRIV.JOB.FMSEC THEN CALL M$RPRIV( FMSEC_PRIV);

   8464  8 000163   000000 470400 xsym               LDP0    B$JIT$
         8 000164   000015 236100                    LDQ     13,,PR0
         8 000165   100000 316003                    CANQ    32768,DU
         8 000166   000172 601000 8                  TNZ     s:8465

   8464  8 000167   000034 630400 3                  EPPR0   FMSEC_PRIV
         8 000170   020013 713400                    CLIMB   8203
         8 000171   400000 401760                    pmme    nvectors=1

      206     8465    2           S_BLK.ARRAY( 0) = B$DS8$->DS.PTRS.SYSID( 0);

   8465  8 000172   000000 470400 3                  LDP0    BDS8B
         8 000173   000000 236100                    LDQ     0,,PR0
         8 000174   000022 772000                    QRL     18
         8 000175   000210 756000 7                  STQ     S_BLK

      207     8466    2           CALL M$STATE(FPT_STATE);

   8466  8 000176   000024 630400 3                  EPPR0   FPT_STATE
         8 000177   020010 713400                    CLIMB   8200
         8 000200   400400 401760                    pmme    nvectors=2

      208     8467    2           IF S_BLK.ARRAY( 0) = %SS_SNULL THEN B$DS8$->DS.PTRS.SYSID( 0) = 0;

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:38   
   8467  8 000201   000210 235000 7                  LDA     S_BLK
         8 000202   000030 115007                    CMPA    24,DL
         8 000203   000207 601000 8                  TNZ     FMTIT

   8467  8 000204   000000 220003                    LDX0    0,DU
         8 000205   000000 470400 3                  LDP0    BDS8B
         8 000206   000000 740100                    STX0    0,,PR0

      209     8468    2   FMTIT:  S_BLK.WORK.DSCR_ = PTRDSCR(B$DS8$);

   8468  8 000207   000000 470400 3     FMTIT        LDP0    BDS8B
         8 000210   000310 050400 7                  STD0    S_BLK+64

      210     8469    2           CALL X$WRITE( FDS, VECTOR( STT_FMT), VECTOR( ZAPDS));

   8469  8 000211   000310 236000 7                  LDQ     S_BLK+64
         8 000212   000020 772000                    QRL     16
         8 000213   000001 620006                    EAX0    1,QL
         8 000214   000000 635010                    EAA     0,X0
         8 000215   000002 771000                    ARL     2
         8 000216   000140 135007                    SBLA    96,DL
         8 000217   000000 236000 3                  LDQ     BDS8B
         8 000220   200020 757100                    STAQ    WAIT_SN+4,,AUTO
         8 000221   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 000222   200024 450500                    STP0    WAIT_SN+8,,AUTO
         8 000223   000006 237000 9                  LDAQ    6
         8 000224   200022 757100                    STAQ    WAIT_SN+6,,AUTO
         8 000225   200022 630500                    EPPR0   WAIT_SN+6,,AUTO
         8 000226   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 000227   000000 701000 xent               TSX1    X$WRITE
         8 000230   000000 011000                    NOP     0

      211     8470    2           IF SRVR_COUNT<0 THEN RETURN;

   8470  8 000231   000511 235000 7                  LDA     SRVR_COUNT
         8 000232   000234 605000 8                  TPL     s:8471

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:39   
   8470  8 000233   000000 702200 xent               TSX2  ! X66_MARET

      212     8471    2           CALL M$LDTRC( FPT_LDTRC) ALTRET( MONABRT);

   8471  8 000234   000114 630400 7                  EPPR0   FPT_LDTRC
         8 000235   400006 713400                    CLIMB   alt,+6
         8 000236   403000 401760                    pmme    nvectors=7
         8 000237   000763 702000 8                  TSX2    MONABRT

      213     8472    2           END;

      214     8473
      215     8474    2       IF B$JIT.MODE ~= %M_GHOST# THEN DO;

   8474  8 000240   000000 470400 xsym               LDP0    B$JIT$
         8 000241   000000 236100                    LDQ     0,,PR0
         8 000242   740000 376003                    ANQ     -16384,DU
         8 000243   100000 116003                    CMPQ    32768,DU
         8 000244   000260 600000 8                  TZE     s:8479

      216     8475    2           IF NOT B$JIT.PRIV.JOB.FMSEC THEN CALL M$RPRIV( FMSEC_PRIV);

   8475  8 000245   000015 236100                    LDQ     13,,PR0
         8 000246   100000 316003                    CANQ    32768,DU
         8 000247   000253 601000 8                  TNZ     s:8476

   8475  8 000250   000034 630400 3                  EPPR0   FMSEC_PRIV
         8 000251   020013 713400                    CLIMB   8203
         8 000252   400000 401760                    pmme    nvectors=1

      217     8476    2           CALL M$GDS( FPT_GDS) ALTRET( MONERR);

   8476  8 000253   000106 630400 7                  EPPR0   FPT_GDS
         8 000254   430001 713400                    CLIMB   alt,gds
         8 000255   400400 401760                    pmme    nvectors=2
         8 000256   000716 702000 8                  TSX2    MONERR

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:40   
      218     8477    2           END;

   8477  8 000257   000265 710000 8                  TRA     s:8482

      219     8478    2       ELSE DO;

      220     8479    2           CALL M$REW( FPT_EXTEND) ALTRET( MONERR);

   8479  8 000260   000020 630400 3                  EPPR0   FPT_EXTEND
         8 000261   440006 713400                    CLIMB   alt,+16390
         8 000262   400000 401760                    pmme    nvectors=1
         8 000263   000716 702000 8                  TSX2    MONERR

      221     8480    2           SRVR_COUNT = 0;

   8480  8 000264   000511 450000 7                  STZ     SRVR_COUNT

      222     8481    2           END;

      223     8482    1       S_BLK.WORK.DSCR_ = PTRDSCR(B$DS8$);

   8482  8 000265   000000 470400 3                  LDP0    BDS8B
         8 000266   000310 050400 7                  STD0    S_BLK+64

      224     8483    1       ZAPDS = '0'B;

   8483  8 000267   000310 236000 7                  LDQ     S_BLK+64
         8 000270   000020 772000                    QRL     16
         8 000271   000001 620006                    EAX0    1,QL
         8 000272   000000 470400 3                  LDP0    BDS8B
         8 000273   000140 100400                    MLR     fill='000'O
         8 000274   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         8 000275   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      225     8484    1       B$DS8$->DS.PTRS.SYSID( 0) = B$JIT.SYSID;

   8484  8 000276   000000 471400 xsym               LDP1    B$JIT$
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:41   
         8 000277   100000 720100                    LXL0    0,,PR1
         8 000300   000000 740100                    STX0    0,,PR0

      226     8485    1       CTX$ = B$DS8$;

   8485  8 000301   000000 236000 3                  LDQ     BDS8B
         8 000302   200003 756100                    STQ     CTX$,,AUTO

      227     8486    1       MAXCTX$ = PINCRW( B$DS8$, DBOUND( S_BLK.WORK.DSCR_) / 4 + 1 - SIZEW( DS));

   8486  8 000303   000310 236000 7                  LDQ     S_BLK+64
         8 000304   000020 772000                    QRL     16
         8 000305   000002 772000                    QRL     2
         8 000306   000022 736000                    QLS     18
         8 000307   000327 136003                    SBLQ    215,DU
         8 000310   000000 036000 3                  ADLQ    BDS8B
         8 000311   200005 756100                    STQ     MAXCTX$,,AUTO

      228     8487    1       MAXINETD$ = PINCRW( MAXCTX$, SIZEW( DS) - SIZEW( INETD));

   8487  8 000312   000312 036003                    ADLQ    202,DU
         8 000313   200011 756100                    STQ     MAXINETD$,,AUTO

      229     8488    1       CALL TSTAMP;

   8488  8 000314   001627 701000 8                  TSX1    TSTAMP
         8 000315   000000 011000                    NOP     0

      230     8489    1       CALL XSL$SOCKINIT( TCI_SOCKINIT) ALTRET( MONERR);

   8489  8 000316   000010 630400 9                  EPPR0   8
         8 000317   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000320   000000 701000 xent               TSX1    XSL$SOCKINIT
         8 000321   000716 702000 8                  TSX2    MONERR

      231     8490
      232     8491        /* First read all the config information. */
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:42   
      233     8492    2       DO WHILE '1'B;

      234     8493    2           S_BLK.BUF = ' ';

   8493  8 000322   040000 100400                    MLR     fill='040'O
         8 000323   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 000324   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256

      235     8494    3           CALL M$READ( FPT_READ) WHENALTRETURN DO;

   8494  8 000325   000002 630400 3                  EPPR0   FPT_READ
         8 000326   440000 713400                    CLIMB   alt,read
         8 000327   401400 401760                    pmme    nvectors=4
         8 000330   000332 702000 8                  TSX2    s:8495
         8 000331   000342 710000 8                  TRA     s:8499

      236     8495    3               IF DCBADDR( DCBNUM( M$SI)) -> F$DCB.TYC.EOF# THEN

   8495  8 000332   000000 236007 xsym               LDQ     M$SI,DL
         8 000333   000000 470400 9                  LDP0    0
         8 000334   000000 471500                    LDP1    0,,PR0
         8 000335   100000 473506                    LDP3    0,QL,PR1
         8 000336   300002 236100                    LDQ     2,,PR3
         8 000337   004000 316003                    CANQ    2048,DU
         8 000340   000745 601000 8                  TNZ     DONE_READING

      237     8496    3                   GOTO DONE_READING;
      238     8497    3               GOTO MONERR;

   8497  8 000341   000716 710000 8                  TRA     MONERR

      239     8498    3               END;
      240     8499    2           P_PCB.NCHARS = MAXIMUM( DCBADDR( DCBNUM( M$SI)) -> F$DCB.ARS#, 1);

   8499  8 000342   000000 236007 xsym               LDQ     M$SI,DL
         8 000343   000000 470400 9                  LDP0    0
         8 000344   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:43   
         8 000345   100000 473506                    LDP3    0,QL,PR1
         8 000346   000001 236007                    LDQ     1,DL
         8 000347   000353 604000 8                  TMI     s:8499+9
         8 000350   300000 116100                    CMPQ    0,,PR3
         8 000351   000353 605000 8                  TPL     s:8499+9
         8 000352   300000 236100                    LDQ     0,,PR3
         8 000353   000203 756000 7                  STQ     P_PCB+9

      241     8500    2           FPT_WRITE.BUF_.BOUND = P_PCB.NCHARS-1;

   8500  8 000354   000001 136007                    SBLQ    1,DL
         8 000355   000020 736000                    QLS     16
         8 000356   000044 676000 7                  ERQ     FPT_WRITE+4
         8 000357   000034 376000 xsym               ANQ     B_VECTNIL+28
         8 000360   000044 656000 7                  ERSQ    FPT_WRITE+4

      242     8501    3           CALL X$PARSE( P_PCB) WHENALTRETURN DO;

   8501  8 000361   000011 630400 9                  EPPR0   9
         8 000362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000363   000000 701000 xent               TSX1    X$PARSE
         8 000364   000366 702000 8                  TSX2    s:8502
         8 000365   000372 710000 8                  TRA     s:8506

      243     8502    3               CALL M$WRITE( FPT_WRITE);

   8502  8 000366   000040 630400 7                  EPPR0   FPT_WRITE
         8 000367   040001 713400                    CLIMB   write
         8 000370   401400 401760                    pmme    nvectors=4

      244     8503    3               GOTO PARSE_ERROR;

   8503  8 000371   000714 710000 8                  TRA     PARSE_ERROR

      245     8504    3               END;
      246     8505
      247     8506    2           DS.CTX = '0'B;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:44   

   8506  8 000372   200003 470500                    LDP0    CTX$,,AUTO
         8 000373   000100 100400                    MLR     fill='000'O
         8 000374   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         8 000375   000200 000540                    ADSC9   128,,PR0                 cn=0,n=352

      248     8507    2           DS.CTX.LISTEN.SA_FAMILY = %XSL_AF_INET;

   8507  8 000376   000002 235007                    LDA     2,DL
         8 000377   000323 755100                    STA     211,,PR0

      249     8508    2           DS.CTX.TYPE = %XSL_SOCK_STREAM;

   8508  8 000400   000001 236007                    LDQ     1,DL
         8 000401   000322 756100                    STQ     210,,PR0

      250     8509    3           DO I=0 TO P$OUT.NSUBLKS-1;

   8509  8 000402   200012 450100                    STZ     I,,AUTO
         8 000403   000573 710000 8                  TRA     s:8537+1

      251     8510    4               DO CASE( P$OUT.SUBLK$( I) -> P$OUT.CODE);

   8510  8 000404   000175 470400 7                  LDP0    P_PCB+3
         8 000405   200012 720100                    LXL0    I,,AUTO
         8 000406   000003 471510                    LDP1    3,X0,PR0
         8 000407   100000 721100                    LXL1    0,,PR1
         8 000410   000007 101003                    CMPX1   7,DU
         8 000411   000413 602011 8                  TNC     s:8510+7,X1
         8 000412   000572 710000 8                  TRA     s:8537
         8 000413   000422 710000 8                  TRA     s:8512
         8 000414   000500 710000 8                  TRA     s:8522
         8 000415   000474 710000 8                  TRA     s:8520
         8 000416   000506 710000 8                  TRA     s:8524
         8 000417   000554 710000 8                  TRA     s:8533
         8 000420   000554 710000 8                  TRA     s:8533
         8 000421   000435 710000 8                  TRA     s:8515
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:45   

      252     8511    4                CASE( %TCI_SERVICE);

      253     8512    4                   SERV$ = P$OUT.SUBLK$( I)-> P$OUT.SUBLK$( 0);

   8512  8 000422   100003 236100                    LDQ     3,,PR1
         8 000423   200006 756100                    STQ     SERV$,,AUTO

      254     8513    4                   DS.CTX.SERVICE = SERV$ -> P$SYM.TEXT;

   8513  8 000424   200006 471500                    LDP1    SERV$,,AUTO
         8 000425   100004 236100                    LDQ     4,,PR1
         8 000426   000033 772000                    QRL     27
         8 000427   000000 621006                    EAX1    0,QL
         8 000430   200003 473500                    LDP3    CTX$,,AUTO
         8 000431   040100 100540                    MLR     fill='040'O
         8 000432   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         8 000433   300312 000020                    ADSC9   202,,PR3                 cn=0,n=16
         8 000434   000572 710000 8                  TRA     s:8537

      255     8514    4                CASE( %TCI_HOST);

      256     8515    4                   CALL CONCAT( DS.CTX.HOST,

   8515  8 000435   100003 473500                    LDP3    3,,PR1
         8 000436   300004 236100                    LDQ     4,,PR3
         8 000437   000033 772000                    QRL     27
         8 000440   000000 622006                    EAX2    0,QL
         8 000441   200003 474500                    LDP4    CTX$,,AUTO
         8 000442   040100 100540                    MLR     fill='040'O
         8 000443   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         8 000444   400316 000020                    ADSC9   206,,PR4                 cn=0,n=16
         8 000445   000020 116007                    CMPQ    16,DL
         8 000446   000454 603000 8                  TRC     s:8517
         8 000447   777757 621006                    EAX1    -17,QL
         8 000450   777777 661003                    ERX1    -1,DU
         8 000451   040146 100400                    MLR     fill='040'O
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:46   
         8 000452   000012 000001 9                  ADSC9   10                       cn=0,n=1
         8 000453   400316 000011                    ADSC9   206,Q,PR4                cn=0,n=*X1

      257     8516    4                     P$OUT.SUBLK$( I)-> P$OUT.SUBLK$( 0)-> P$SYM.TEXT, BINASC( 0));
      258     8517    4                   CALL XSL$GETHOSTBYNAME( P$OUT$, DS.CTX.HOST) ALTRET( BAD_HOST);

   8517  8 000454   200003 236100                    LDQ     CTX$,,AUTO
         8 000455   000316 036003                    ADLQ    206,DU
         8 000456   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 000457   200010 630500                    EPPR0   P$OUT$,,AUTO
         8 000460   200020 450500                    STP0    WAIT_SN+4,,AUTO
         8 000461   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 000462   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000463   000000 701000 xent               TSX1    XSL$GETHOSTBYNAME
         8 000464   000706 702000 8                  TSX2    BAD_HOST

      259     8518    4                   DS.CTX.LISTEN.S_ADDR = P$OUT$->XSL$HOSTENT.H_ADDR_LIST$->B$PTR->
              8518                            B$UBIN;

   8518  8 000465   200010 470500                    LDP0    P$OUT$,,AUTO
         8 000466   000004 471500                    LDP1    4,,PR0
         8 000467   100000 473500                    LDP3    0,,PR1
         8 000470   200003 474500                    LDP4    CTX$,,AUTO
         8 000471   300000 235100                    LDA     0,,PR3
         8 000472   400325 755100                    STA     213,,PR4
         8 000473   000572 710000 8                  TRA     s:8537

      260     8519    4                CASE( %TCI_PROTOCOL);

      261     8520    4                   PROTO$ = P$OUT.SUBLK$( I) -> P$OUT.SUBLK$( 0) -> P$SYM.TEXTC$;

   8520  8 000474   100003 473500                    LDP3    3,,PR1
         8 000475   300003 236100                    LDQ     3,,PR3
         8 000476   200007 756100                    STQ     PROTO$,,AUTO
         8 000477   000572 710000 8                  TRA     s:8537

      262     8521    4                CASE( %TCI_TYPE);
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:47   

      263     8522    4                   DS.CTX.TYPE = P$OUT.SUBLK$( I) -> P$OUT.SUBLK$( 0) -> P$OUT.CODE;

   8522  8 000500   100003 473500                    LDP3    3,,PR1
         8 000501   300000 236100                    LDQ     0,,PR3
         8 000502   777777 376007                    ANQ     -1,DL
         8 000503   200003 474500                    LDP4    CTX$,,AUTO
         8 000504   400322 756100                    STQ     210,,PR4
         8 000505   000572 710000 8                  TRA     s:8537

      264     8523    4                CASE( %TCI_USERID);

      265     8524    4                   P$OUT$ = P$OUT.SUBLK$( I);

   8524  8 000506   000003 236110                    LDQ     3,X0,PR0
         8 000507   200010 756100                    STQ     P$OUT$,,AUTO

      266     8525    4                   DS.CTX.ACCT = P$OUT$ -> P$OUT.SUBLK$( 0) -> P$SYM.TEXT;

   8525  8 000510   200010 471500                    LDP1    P$OUT$,,AUTO
         8 000511   100003 473500                    LDP3    3,,PR1
         8 000512   300004 236100                    LDQ     4,,PR3
         8 000513   000033 772000                    QRL     27
         8 000514   000000 621006                    EAX1    0,QL
         8 000515   200003 474500                    LDP4    CTX$,,AUTO
         8 000516   040100 100540                    MLR     fill='040'O
         8 000517   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         8 000520   400300 000010                    ADSC9   192,,PR4                 cn=0,n=8

      267     8526    4                   DS.CTX.NAME = P$OUT$ -> P$OUT.SUBLK$( 1) -> P$SYM.TEXTC$ -> DS;

   8526  8 000521   100004 473500                    LDP3    4,,PR1
         8 000522   300003 475500                    LDP5    3,,PR3
         8 000523   000100 100500                    MLR     fill='000'O
         8 000524   500000 000015                    ADSC9   0,,PR5                   cn=0,n=13
         8 000525   400302 000015                    ADSC9   194,,PR4                 cn=0,n=13

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:48   
      268     8527    4                   DS.CTX.PSWD = ' ';

   8527  8 000526   000035 235000 xsym               LDA     B_VECTNIL+29
         8 000527   000035 236000 xsym               LDQ     B_VECTNIL+29
         8 000530   400306 757100                    STAQ    198,,PR4

      269     8528    4                   IF P$OUT$ -> P$OUT.NSUBLKS = 2 THEN EXIT;

   8528  8 000531   100001 221100                    LDX1    1,,PR1
         8 000532   000002 101003                    CMPX1   2,DU
         8 000533   000572 600000 8                  TZE     s:8537

      270     8529    4                   SUBSTR( S_BLK.BUF, P$OUT$ -> P$OUT.SUBLK$( 2) -> P$SYM.CPOS,

   8529  8 000534   100005 473500                    LDP3    5,,PR1
         8 000535   300002 235100                    LDA     2,,PR3
         8 000536   300004 236100                    LDQ     4,,PR3
         8 000537   000033 772000                    QRL     27
         8 000540   000000 622006                    EAX2    0,QL
         8 000541   040045 100400                    MLR     fill='040'O
         8 000542   000433 000010 3                  ADSC9   STT_FMT+137              cn=0,n=8
         8 000543   000210 000012 7                  ADSC9   S_BLK,A                  cn=0,n=*X2

      271     8530    4                     P$OUT$ -> P$OUT.SUBLK$( 2) -> P$SYM.COUNT) = 'xxxxxxxx';
      272     8531    4                   DS.CTX.PSWD = P$OUT$ -> P$OUT.SUBLK$( 2) -> P$SYM.TEXT;

   8531  8 000544   100005 470500                    LDP0    5,,PR1
         8 000545   000004 236100                    LDQ     4,,PR0
         8 000546   000033 772000                    QRL     27
         8 000547   000000 621006                    EAX1    0,QL
         8 000550   040100 100540                    MLR     fill='040'O
         8 000551   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         8 000552   400306 000010                    ADSC9   198,,PR4                 cn=0,n=8
         8 000553   000572 710000 8                  TRA     s:8537

      273     8532    4                CASE( %TCI_PROGRAM, %TCI_CCBUF);

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:49   
      274     8533    4                   IF P$OUT.SUBLK$( I) -> P$OUT.SUBLK$( 0) -> P$SYM.CODE = 0

   8533  8 000554   100003 473500                    LDP3    3,,PR1
         8 000555   300000 722100                    LXL2    0,,PR3
         8 000556   000572 601000 8                  TNZ     s:8537

      275     8534    4                   THEN DS.CTX.BUF =

   8534  8 000557   100002 235100                    LDA     2,,PR1
         8 000560   200020 755100                    STA     WAIT_SN+4,,AUTO
         8 000561   100002 235100                    LDA     2,,PR1
         8 000562   000027 675000 xsym               ERA     B_VECTNIL+23
         8 000563   000401 035007                    ADLA    257,DL
         8 000564   000000 621005                    EAX1    0,AL
         8 000565   200020 235100                    LDA     WAIT_SN+4,,AUTO
         8 000566   200003 471500                    LDP1    CTX$,,AUTO
         8 000567   040100 100445                    MLR     fill='040'O
         8 000570   000210 000011 7                  ADSC9   S_BLK,A                  cn=0,n=*X1
         8 000571   100200 000400                    ADSC9   128,,PR1                 cn=0,n=256

      276     8535    4                     SUBSTR( S_BLK.BUF, P$OUT.SUBLK$( I) -> P$OUT.CPOS);
      277     8536    4                END;

      278     8537    3               END;

   8537  8 000572   200012 054100                    AOS     I,,AUTO
         8 000573   000175 470400 7                  LDP0    P_PCB+3
         8 000574   000001 236100                    LDQ     1,,PR0
         8 000575   000022 772000                    QRL     18
         8 000576   200012 116100                    CMPQ    I,,AUTO
         8 000577   000404 605400 8                  TPNZ    s:8510

      279     8538
      280     8539    2           CALL M$WRITE( FPT_WRITE); /* Print after scratching out passwords */

   8539  8 000600   000040 630400 7                  EPPR0   FPT_WRITE
         8 000601   040001 713400                    CLIMB   write
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:50   
         8 000602   401400 401760                    pmme    nvectors=4

      281     8540    2           IF I=0 THEN GOTO NEXT_LINE; /* That'd be a comment */

   8540  8 000603   200012 235100                    LDA     I,,AUTO
         8 000604   000705 600000 8                  TZE     NEXT_LINE

      282     8541    3           IF SERV$=ADDR( NIL) THEN DO;

   8541  8 000605   200006 236100                    LDQ     SERV$,,AUTO
         8 000606   000001 116000 xsym               CMPQ    B_VECTNIL+1
         8 000607   000613 601000 8                  TNZ     s:8545

      283     8542    3               XSL_ERRNO = %E$NOENT;

   8542  8 000610   000002 235007                    LDA     2,DL
         8 000611   000000 755000 xsym               STA     XSL_ERRNO

      284     8543    3               GOTO BAD_SERVICE;

   8543  8 000612   000706 710000 8                  TRA     BAD_HOST

      285     8544    3               END;
      286     8545    3           IF SERV$ -> P$SYM.NDTYPE = %DEC# THEN DO;

   8545  8 000613   200006 470500                    LDP0    SERV$,,AUTO
         8 000614   000000 236100                    LDQ     0,,PR0
         8 000615   000077 376003                    ANQ     63,DU
         8 000616   000022 116003                    CMPQ    18,DU
         8 000617   000642 601000 8                  TNZ     s:8550

      287     8546    3               CALL CHARBIN( DS.CTX.LISTEN.S_PORT, SERV$->P$SYM.TEXT);

   8546  8 000620   000004 236100                    LDQ     4,,PR0
         8 000621   000033 772000                    QRL     27
         8 000622   000000 620006                    EAX0    0,QL
         8 000623   000100 305540                    DTB
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:51   
         8 000624   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         8 000625   200020 000010                    NDSC9   WAIT_SN+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         8 000626   200003 471500                    LDP1    CTX$,,AUTO
         8 000627   200021 236100                    LDQ     WAIT_SN+5,,AUTO
         8 000630   100324 756100                    STQ     212,,PR1

      288     8547    3               CALL XSL$HTONL( DS.CTX.LISTEN.S_PORT, DS.CTX.LISTEN.S_PORT);

   8547  8 000631   200003 236100                    LDQ     CTX$,,AUTO
         8 000632   000324 036003                    ADLQ    212,DU
         8 000633   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 000634   200020 756100                    STQ     WAIT_SN+4,,AUTO
         8 000635   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 000636   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000637   000000 701000 xent               TSX1    XSL$HTONL
         8 000640   000000 011000                    NOP     0

      289     8548    3               END;

   8548  8 000641   000661 710000 8                  TRA     s:8554

      290     8549    3           ELSE DO;

      291     8550    3               CALL XSL$GETSERVBYNAME( SERV$, SERV$->P$SYM.COUNT, PROTO$->DS)

   8550  8 000642   200007 236100                    LDQ     PROTO$,,AUTO
         8 000643   200022 756100                    STQ     WAIT_SN+6,,AUTO
         8 000644   200006 236100                    LDQ     SERV$,,AUTO
         8 000645   000004 036003                    ADLQ    4,DU
         8 000646   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 000647   200006 631500                    EPPR1   SERV$,,AUTO
         8 000650   200020 451500                    STP1    WAIT_SN+4,,AUTO
         8 000651   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 000652   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 000653   000000 701000 xent               TSX1    XSL$GETSERVBYNAME
         8 000654   000706 702000 8                  TSX2    BAD_HOST

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:52   
      292     8551    3                 ALTRET( BAD_SERVICE);
      293     8552    3               DS.CTX.LISTEN.S_PORT = SERV$ -> XSL$SERVENT.S_PORT;

   8552  8 000655   200006 470500                    LDP0    SERV$,,AUTO
         8 000656   000002 235100                    LDA     2,,PR0
         8 000657   200003 471500                    LDP1    CTX$,,AUTO
         8 000660   100324 755100                    STA     212,,PR1

      294     8553    3               END;

      295     8554    2           IF SRVR_COUNT < 0 THEN GOTO NEXT_LINE;

   8554  8 000661   000511 235000 7                  LDA     SRVR_COUNT
         8 000662   000705 604000 8                  TMI     NEXT_LINE

      296     8555    2           CALL OPEN_CTX ALTRET (BAD_SERVICE);

   8555  8 000663   001652 701000 8                  TSX1    OPEN_CTX
         8 000664   000706 702000 8                  TSX2    BAD_HOST

   8554  8 000665                       NEXT_CTX     null
      297     8556
      298     8557    2   NEXT_CTX: ;
      299     8558    2           CTX$ = PINCRW( CTX$, SIZEW( DS.CTX));

   8558  8 000665   200003 236100                    LDQ     CTX$,,AUTO
         8 000666   000130 036003                    ADLQ    88,DU
         8 000667   200003 756100                    STQ     CTX$,,AUTO

      300     8559    3           IF CTX$ > MAXCTX$ THEN DO;

   8559  8 000670   200005 116100                    CMPQ    MAXCTX$,,AUTO
         8 000671   000704 602000 8                  TNC     s:8564
         8 000672   000704 600000 8                  TZE     s:8564

      301     8560    3               CALL M$EXTEND( FPT_EXTEND);

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:53   
   8560  8 000673   000020 630400 3                  EPPR0   FPT_EXTEND
         8 000674   040005 713400                    CLIMB   16389
         8 000675   400000 401760                    pmme    nvectors=1

      302     8561    3               MAXCTX$ = PINCRW( MAXCTX$, 1024);

   8561  8 000676   200005 236100                    LDQ     MAXCTX$,,AUTO
         8 000677   002000 036003                    ADLQ    1024,DU
         8 000700   200005 756100                    STQ     MAXCTX$,,AUTO

      303     8562    3               MAXINETD$ = PINCRW( MAXINETD$, 1024);

   8562  8 000701   200011 236100                    LDQ     MAXINETD$,,AUTO
         8 000702   002000 036003                    ADLQ    1024,DU
         8 000703   200011 756100                    STQ     MAXINETD$,,AUTO

      304     8563    3               END;

      305     8564    2           SRVR_COUNT = SRVR_COUNT + 1;

   8564  8 000704   000511 054000 7                  AOS     SRVR_COUNT

   8564  8 000705                       NEXT_LINE    null
      306     8565    2   NEXT_LINE: ;
      307     8566    3           DO WHILE '0'B;

   8566  8 000705   000322 710000 8                  TRA     s:8493

   8559  8 000706                       BAD_HOST     null
   8566  8 000706                       BAD_SERVICE  null
      308     8567    3   BAD_HOST: ;
      309     8568    3   BAD_SERVICE: ;
      310     8569    3               P_PCB.ERROR = '302314'O | BINBIT( XSL_ERRNO,33);

   8569  8 000706   000000 236000 xsym               LDQ     XSL_ERRNO
         8 000707   000003 736000                    QLS     3
         8 000710   302314 276003                    ORQ     99532,DU
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:54   
         8 000711   000200 756000 7                  STQ     P_PCB+6

      311     8570    3               IF XSL_ERRNO>0 THEN

   8570  8 000712   000000 235000 xsym               LDA     XSL_ERRNO
         8 000713   000716 604400 8                  TMOZ    MONERR

      312     8571    3   PARSE_ERROR:    FPT_ERRMSG.V.SOURCE# = 0;

   8571  8 000714   000013 236000 9     PARSE_ERROR  LDQ     11
         8 000715   000104 356000 7                  ANSQ    FPT_ERRMSG+24

   8570  8 000716                       MONERR       null
      313     8572    3   MONERR:;
      314     8573    3               CALL M$ERRMSG( FPT_ERRMSG);

   8573  8 000716   000054 630400 7                  EPPR0   FPT_ERRMSG
         8 000717   020000 713400                    CLIMB   8192
         8 000720   405000 401760                    pmme    nvectors=11

      315     8574    4               IF FPT_ERRMSG.V.SOURCE# = 0 THEN DO;

   8574  8 000721   000104 236000 7                  LDQ     FPT_ERRMSG+24
         8 000722   340000 316007                    CANQ    114688,DL
         8 000723   000732 601000 8                  TNZ     s:8579

      316     8575    4                   DS.CTX.SYSID = 2;

   8575  8 000724   000002 220003                    LDX0    2,DU
         8 000725   200003 470500                    LDP0    CTX$,,AUTO
         8 000726   000310 740100                    STX0    200,,PR0

      317     8576    4                   DS.CTX.SOCKET# = BITBIN(P_PCB.ERROR);

   8576  8 000727   000200 235000 7                  LDA     P_PCB+6
         8 000730   000311 755100                    STA     201,,PR0

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:55   
      318     8577    4                   GOTO NEXT_CTX;

   8577  8 000731   000665 710000 8                  TRA     NEXT_CTX

      319     8578    4                   END;
      320     8579    3               FPT_ERRMSG.V.SOURCE# = 2;

   8579  8 000732   000013 376000 9                  ANQ     11
         8 000733   100000 276007                    ORQ     32768,DL
         8 000734   000104 756000 7                  STQ     FPT_ERRMSG+24

      321     8580    3               IF NOT DCBADDR( DCBNUM( M$SI))-> F$DCB.FCD# THEN GOTO DONE_READING;

   8580  8 000735   000000 236007 xsym               LDQ     M$SI,DL
         8 000736   000000 470400 9                  LDP0    0
         8 000737   000000 471500                    LDP1    0,,PR0
         8 000740   100000 473506                    LDP3    0,QL,PR1
         8 000741   300031 236100                    LDQ     25,,PR3
         8 000742   020000 316007                    CANQ    8192,DL
         8 000743   000745 600000 8                  TZE     DONE_READING

      322     8581    3               END;

      323     8582    2           END;

   8582  8 000744   000322 710000 8                  TRA     s:8493

   8579  8 000745                       DONE_READING null
      324     8583        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:56   
      325     8584    1   DONE_READING:;
      326     8585    1       CALL M$CLOSE( CLOSE_SI);

   8585  8 000745   000056 630400 3                  EPPR0   CLOSE_SI
         8 000746   050001 713400                    CLIMB   close
         8 000747   406000 401760                    pmme    nvectors=13

      327     8586    1       MAXCTX$ = CTX$;

   8586  8 000750   200003 236100                    LDQ     CTX$,,AUTO
         8 000751   200005 756100                    STQ     MAXCTX$,,AUTO

      328     8587    1       IF SRVR_COUNT < 0 THEN CALL M$EXIT;

   8587  8 000752   000511 235000 7                  LDA     SRVR_COUNT
         8 000753   000756 605000 8                  TPL     s:8588

   8587  8 000754   000001 713400                    CLIMB   exit
         8 000755   000000 401760                    pmme    nvectors=0

      329     8588    2       CALL M$SPRIV( SYS_PRIV) WHENALTRETURN DO;

   8588  8 000756   000030 630400 3                  EPPR0   SYS_PRIV
         8 000757   420012 713400                    CLIMB   alt,+8202
         8 000760   400000 401760                    pmme    nvectors=1
         8 000761   000763 702000 8                  TSX2    MONABRT
         8 000762   000770 710000 8                  TRA     s:8593

      330     8589    2   MONABRT: CALL M$ERRMSG( FPT_ERRMSG);

   8589  8 000763   000054 630400 7     MONABRT      EPPR0   FPT_ERRMSG
         8 000764   020000 713400                    CLIMB   8192
         8 000765   405000 401760                    pmme    nvectors=11

      331     8590    2           CALL M$XXX;

   8590  8 000766   000003 713400                    CLIMB   3
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:57   
         8 000767   000000 401760                    pmme    nvectors=0

      332     8591    2           END;

      333     8592        /* Set up DS.PTRS(0) for GET_INETD */
      334     8593    1       B$DS8$ -> DS.PTRS.OFFSET( 0) = CTX#.OFFSET +SIZEW( DS.PTRS) -SIZEW( INETD);

   8593  8 000770   200003 220100                    LDX0    CTX$,,AUTO
         8 000771   000162 621010                    EAX1    114,X0
         8 000772   000000 470400 3                  LDP0    BDS8B
         8 000773   000000 441100                    SXL1    0,,PR0

   8593  8 000774                       DO_SELECT    null
      335     8594
      336     8595    1   DO_SELECT:;
      337     8596    2       IF NOT SELECT_MASK AND NOT WAIT_MASK THEN DO; /* Nothing to do, give up */

   8596  8 000774   000510 235000 7                  LDA     SELECT_MASK
         8 000775   001026 601000 8                  TNZ     s:8607
         8 000776   000512 236000 7                  LDQ     WAIT_MASK
         8 000777   001026 601000 8                  TNZ     s:8607

      338     8597    2           CALL TSTAMP;

   8597  8 001000   001627 701000 8                  TSX1    TSTAMP
         8 001001   000000 011000                    NOP     0

      339     8598    2           S_BLK.BUF = 'INETD abort - no services to service.';

   8598  8 001002   040000 100400                    MLR     fill='040'O
         8 001003   000435 000045 3                  ADSC9   STT_FMT+139              cn=0,n=37
         8 001004   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256

   8598  8 001005                       INETD_QUIT   null
      340     8599    2   INETD_QUIT:;
      341     8600    2           FPT_WRITE.BUF_.BOUND = 37;

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:58   
   8600  8 001005   000044 236000 7                  LDQ     FPT_WRITE+4
         8 001006   177777 376007                    ANQ     65535,DL
         8 001007   000014 276000 9                  ORQ     12
         8 001010   000044 756000 7                  STQ     FPT_WRITE+4

      342     8601    2           CALL M$WRITE( FPT_WRITE);

   8601  8 001011   000040 630400 7                  EPPR0   FPT_WRITE
         8 001012   040001 713400                    CLIMB   write
         8 001013   401400 401760                    pmme    nvectors=4

      343     8602    2           FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;

   8602  8 001014   000044 237000 7                  LDAQ    FPT_WRITE+4
         8 001015   000002 757000 7                  STAQ    FPT_KEYIN+2

      344     8603    3           CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;

   8603  8 001016   000000 630400 7                  EPPR0   FPT_KEYIN
         8 001017   520000 713400                    CLIMB   alt,+40960
         8 001020   401400 401760                    pmme    nvectors=4
         8 001021   001023 702000 8                  TSX2    s:8604
         8 001022   001023 710000 8                  TRA     s:8604

      345     8604    2           SRVR_COUNT = -1;

   8604  8 001023   000001 335007                    LCA     1,DL
         8 001024   000511 755000 7                  STA     SRVR_COUNT

      346     8605    2           GOTO FMTIT;

   8605  8 001025   000207 710000 8                  TRA     FMTIT

      347     8606    2           END;
      348     8607    1       IF SELECT_RESULT THEN I = 0; /* Poll if waiting for a server to start */

   8607  8 001026   200013 236100                    LDQ     SELECT_RESULT,,AUTO
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:59   
         8 001027   001032 600000 8                  TZE     s:8608

   8607  8 001030   200012 450100                    STZ     I,,AUTO
         8 001031   001041 710000 8                  TRA     s:8610

      349     8608    1       ELSE IF WAIT_MASK THEN I = 5;

   8608  8 001032   000512 235000 7                  LDA     WAIT_MASK
         8 001033   001037 600000 8                  TZE     s:8609

   8608  8 001034   000005 235007                    LDA     5,DL
         8 001035   200012 755100                    STA     I,,AUTO
         8 001036   001041 710000 8                  TRA     s:8610

      350     8609    1       ELSE I = 60;

   8609  8 001037   000074 235007                    LDA     60,DL
         8 001040   200012 755100                    STA     I,,AUTO

      351     8610    1       SELECT_RESULT = SELECT_MASK;

   8610  8 001041   000510 236000 7                  LDQ     SELECT_MASK
         8 001042   200013 756100                    STQ     SELECT_RESULT,,AUTO

      352     8611    1       CALL XSL$QSELECT( I, SRVR_COUNT, SELECT_RESULT, , , I);

   8611  8 001043   200012 630500                    EPPR0   I,,AUTO
         8 001044   200025 450500                    STP0    WAIT_SN+9,,AUTO
         8 001045   000001 236000 xsym               LDQ     B_VECTNIL+1
         8 001046   200024 756100                    STQ     WAIT_SN+8,,AUTO
         8 001047   200023 756100                    STQ     WAIT_SN+7,,AUTO
         8 001050   200013 631500                    EPPR1   SELECT_RESULT,,AUTO
         8 001051   200022 451500                    STP1    WAIT_SN+6,,AUTO
         8 001052   000015 236000 9                  LDQ     13
         8 001053   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001054   200012 633500                    EPPR3   I,,AUTO
         8 001055   200020 453500                    STP3    WAIT_SN+4,,AUTO
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:60   
         8 001056   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001057   000024 631400 xsym               EPPR1   B_VECTNIL+20
         8 001060   000000 701000 xent               TSX1    XSL$QSELECT
         8 001061   000000 011000                    NOP     0

      353     8612    1       IF B$DS8$ -> DS.PTRS.SYSID( 0) > 10 AND /* are we still in charge? */

   8612  8 001062   000000 470400 3                  LDP0    BDS8B
         8 001063   000000 220100                    LDX0    0,,PR0
         8 001064   000013 100003                    CMPX0   11,DU
         8 001065   001100 602000 8                  TNC     s:8618
         8 001066   000000 471400 xsym               LDP1    B$JIT$
         8 001067   100000 721100                    LXL1    0,,PR1
         8 001070   000000 101100                    CMPX1   0,,PR0
         8 001071   001100 600000 8                  TZE     s:8618

      354     8613    2         B$DS8$ -> DS.PTRS.SYSID( 0) ~= B$JIT.SYSID THEN DO;

      355     8614    2           CALL TSTAMP;

   8614  8 001072   001627 701000 8                  TSX1    TSTAMP
         8 001073   000000 011000                    NOP     0

      356     8615    2           S_BLK.BUF = 'INETD abort - another INETD has assumed control.';

   8615  8 001074   040000 100400                    MLR     fill='040'O
         8 001075   000447 000060 3                  ADSC9   STT_FMT+149              cn=0,n=48
         8 001076   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256

      357     8616    2           GOTO INETD_QUIT;

   8616  8 001077   001005 710000 8                  TRA     INETD_QUIT

      358     8617    2           END;
      359     8618    1       IF B$DS8$ -> DS.PTRS.SYSID( 0) <= 10 AND NOT SELECT_RESULT

   8618  8 001100   000013 100003                    CMPX0   11,DU
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:61   
         8 001101   001141 603000 8                  TRC     s:8627
         8 001102   200013 235100                    LDA     SELECT_RESULT,,AUTO
         8 001103   001141 601000 8                  TNZ     s:8627

      360     8619    2       THEN IF B$DS8$ -> DS.PTRS.SYSID( 0) = 2 /* 'R'-'P' */ THEN DO;

   8619  8 001104   000002 100003                    CMPX0   2,DU
         8 001105   000207 601000 8                  TNZ     FMTIT

      361     8620    2           B$DS8$ -> DS.PTRS.SYSID( 0) = B$JIT.SYSID;

   8620  8 001106   000000 471400 xsym               LDP1    B$JIT$
         8 001107   100000 721100                    LXL1    0,,PR1
         8 001110   000000 741100                    STX1    0,,PR0

      362     8621    2           S_BLK.WORK.DSCR_ = PTRDSCR( B$DS8$);

   8621  8 001111   000310 050400 7                  STD0    S_BLK+64

      363     8622    2           CALL X$WRITE( FDS, VECTOR( STT_FMT), VECTOR( ZAPDS));

   8622  8 001112   000310 236000 7                  LDQ     S_BLK+64
         8 001113   000020 772000                    QRL     16
         8 001114   000001 620006                    EAX0    1,QL
         8 001115   000000 635010                    EAA     0,X0
         8 001116   000002 771000                    ARL     2
         8 001117   000140 135007                    SBLA    96,DL
         8 001120   000000 236000 3                  LDQ     BDS8B
         8 001121   200020 757100                    STAQ    WAIT_SN+4,,AUTO
         8 001122   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001123   200024 450500                    STP0    WAIT_SN+8,,AUTO
         8 001124   000006 237000 9                  LDAQ    6
         8 001125   200022 757100                    STAQ    WAIT_SN+6,,AUTO
         8 001126   200022 630500                    EPPR0   WAIT_SN+6,,AUTO
         8 001127   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001130   000000 701000 xent               TSX1    X$WRITE
         8 001131   000000 011000                    NOP     0
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:62   

      364     8623    2           CALL M$CLOSE( CLOSE_DO);

   8623  8 001132   000114 630400 3                  EPPR0   CLOSE_DO
         8 001133   050001 713400                    CLIMB   close
         8 001134   406000 401760                    pmme    nvectors=13

      365     8624    2           CALL M$LDEV( PRINT_IT);

   8624  8 001135   000152 630400 3                  EPPR0   PRINT_IT
         8 001136   060004 713400                    CLIMB   24580
         8 001137   403000 401760                    pmme    nvectors=7

      366     8625    2           END;

   8625  8 001140   001141 710000 8                  TRA     s:8627

      367     8626    1       ELSE GOTO FMTIT;
      368     8627    1       IF I<=0 AND SELECT_RESULT THEN

   8627  8 001141   200012 235100                    LDA     I,,AUTO
         8 001142   001150 605400 8                  TPNZ    s:8630
         8 001143   200013 236100                    LDQ     SELECT_RESULT,,AUTO
         8 001144   001150 600000 8                  TZE     s:8630

      369     8628    1           IF XSL_ERRNO<0 THEN GOTO FMTIT;

   8628  8 001145   000000 235000 xsym               LDA     XSL_ERRNO
         8 001146   000207 604000 8                  TMI     FMTIT

      370     8629    1           ELSE GOTO DO_SELECT;

   8629  8 001147   000774 710000 8                  TRA     DO_SELECT

      371     8630    1       CTX$ = B$DS8$;

   8630  8 001150   000000 236000 3                  LDQ     BDS8B
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:63   
         8 001151   200003 756100                    STQ     CTX$,,AUTO

      372     8631    1       INETD$ = B$DS8$;

   8631  8 001152   200004 756100                    STQ     INETD$,,AUTO

      373     8632    2       DO UNTIL CTX$ = MAXCTX$;

      374     8633    2           INETD#.OFFSET = DS.CTX.INETD#;

   8633  8 001153   200003 470500                    LDP0    CTX$,,AUTO
         8 001154   000310 720100                    LXL0    200,,PR0
         8 001155   200004 740100                    STX0    INETD$,,AUTO

      375     8634    3           IF DS.CTX.SYSID=0 AND SELECT_RESULT( DS.CTX.SOCKET#) THEN DO WHILE '1'B;

   8634  8 001156   000310 221100                    LDX1    200,,PR0
         8 001157   001462 601000 8                  TNZ     s:8699
         8 001160   000311 235100                    LDA     201,,PR0
         8 001161   001163 605000 8                  TPL     s:8634+5
         8 001162   000044 035003                    ADLA    36,DU
         8 001163   000000 066505                    CMPB    filb='0'B
         8 001164   200013 000001                    BDSC    SELECT_RESULT,A,AUTO     by=0,bit=0,n=1
         8 001165   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         8 001166   001462 600000 8                  TZE     s:8699

      376     8635    3               IF INETD#.OFFSET = 0 THEN CALL GET_INETD ALTRET( WAIT_A_BIT);

   8635  8 001167   200004 220100                    LDX0    INETD$,,AUTO
         8 001170   001173 601000 8                  TNZ     s:8636

   8635  8 001171   002107 701000 8                  TSX1    GET_INETD
         8 001172   001621 702000 8                  TSX2    WAIT_A_BIT

      377     8636    4               IF INETD.FPT_RUE.SYSID = 0 THEN DO; /* Need to start a server */

   8636  8 001173   200004 470500                    LDP0    INETD$,,AUTO
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:64   
         8 001174   000002 220100                    LDX0    2,,PR0
         8 001175   001324 601000 8                  TNZ     s:8665

      378     8637    4                   PINCRW( ADDR( S_BLK), - SIZEW( DS.PTRS)) -> DS.CTX = DS.CTX;

   8637  8 001176   200003 471500                    LDP1    CTX$,,AUTO
         8 001177   000000 100500                    MLR     fill='000'O
         8 001200   100200 000540                    ADSC9   128,,PR1                 cn=0,n=352
         8 001201   000210 000540 7                  ADSC9   S_BLK                    cn=0,n=352

      379     8638    5                   CALL M$GJOB( FPT_GJOB) WHENALTRETURN DO;

   8638  8 001202   000040 630400 3                  EPPR0   FPT_GJOB
         8 001203   420022 713400                    CLIMB   alt,+8210
         8 001204   402400 401760                    pmme    nvectors=6
         8 001205   001207 702000 8                  TSX2    s:8639
         8 001206   001306 710000 8                  TRA     s:8660

      380     8639    5                       P_PCB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   8639  8 001207   000000 470400 xsym               LDP0    B$TCB$
         8 001210   000000 471500                    LDP1    0,,PR0
         8 001211   100102 236100                    LDQ     66,,PR1
         8 001212   000200 756000 7                  STQ     P_PCB+6

   8639  8 001213                       ERRMSG_KILL  null
      381     8640    5   ERRMSG_KILL: ;
      382     8641    5                       CALL TSTAMP;

   8641  8 001213   001627 701000 8                  TSX1    TSTAMP
         8 001214   000000 011000                    NOP     0

      383     8642    5                       FPT_ERRMSG.V.SOURCE# = 0;

   8642  8 001215   000013 236000 9                  LDQ     11
         8 001216   000104 356000 7                  ANSQ    FPT_ERRMSG+24

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:65   
      384     8643    5                       CALL M$ERRMSG( FPT_ERRMSG);

   8643  8 001217   000054 630400 7                  EPPR0   FPT_ERRMSG
         8 001220   020000 713400                    CLIMB   8192
         8 001221   405000 401760                    pmme    nvectors=11

      385     8644    5                       FPT_ERRMSG.V.SOURCE# = 2;

   8644  8 001222   000104 236000 7                  LDQ     FPT_ERRMSG+24
         8 001223   000013 376000 9                  ANQ     11
         8 001224   100000 276007                    ORQ     32768,DL
         8 001225   000104 756000 7                  STQ     FPT_ERRMSG+24

      386     8645    6                       IF P_PCB.ERROR.CODE = %E$NGHUSR THEN DO;

   8645  8 001226   000200 236000 7                  LDQ     P_PCB+6
         8 001227   377770 376007                    ANQ     131064,DL
         8 001230   021460 116007                    CMPQ    9008,DL
         8 001231   001305 601000 8                  TNZ     s:8658

      387     8646    6                           CALL CONCAT( S_BLK.BUF,

   8646  8 001232   040000 100400                    MLR     fill='040'O
         8 001233   000463 000041 3                  ADSC9   STT_FMT+161              cn=0,n=33
         8 001234   000210 000041 7                  ADSC9   S_BLK                    cn=0,n=33
         8 001235   200003 470500                    LDP0    CTX$,,AUTO
         8 001236   040000 100500                    MLR     fill='040'O
         8 001237   000312 000020                    ADSC9   202,,PR0                 cn=0,n=16
         8 001240   000220 200337 7                  ADSC9   S_BLK+8                  cn=1,n=223

      388     8647    6                             'Failed to start a ghost user for ', DS.CTX.SERVICE);
      389     8648    6                           FPT_WRITE.BUF_.BOUND = 44;

   8648  8 001241   000044 236000 7                  LDQ     FPT_WRITE+4
         8 001242   177777 376007                    ANQ     65535,DL
         8 001243   000013 276003                    ORQ     11,DU
         8 001244   000044 756000 7                  STQ     FPT_WRITE+4
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:66   

      390     8649    6                           CALL M$WRITE( FPT_WRITE);

   8649  8 001245   000040 630400 7                  EPPR0   FPT_WRITE
         8 001246   040001 713400                    CLIMB   write
         8 001247   401400 401760                    pmme    nvectors=4

      391     8650    6                           FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;

   8650  8 001250   000044 237000 7                  LDAQ    FPT_WRITE+4
         8 001251   000002 757000 7                  STAQ    FPT_KEYIN+2

      392     8651    7                           CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;

   8651  8 001252   000000 630400 7                  EPPR0   FPT_KEYIN
         8 001253   520000 713400                    CLIMB   alt,+40960
         8 001254   401400 401760                    pmme    nvectors=4
         8 001255   001257 702000 8                  TSX2    s:8652
         8 001256   001257 710000 8                  TRA     s:8652

      393     8652    6                           SELECT_MASK( DS.CTX.SOCKET#) = '0'B;

   8652  8 001257   200003 470500                    LDP0    CTX$,,AUTO
         8 001260   000311 235100                    LDA     201,,PR0
         8 001261   001263 605000 8                  TPL     s:8652+4
         8 001262   000044 035003                    ADLA    36,DU
         8 001263   003005 060400                    CSL     bolr='003'O
         8 001264   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         8 001265   000510 000001 7                  BDSC    SELECT_MASK,A            by=0,bit=0,n=1

      394     8653    6                           CALL XSL$QCLOSE( I, DS.CTX.SOCKET#);

   8653  8 001266   200003 236100                    LDQ     CTX$,,AUTO
         8 001267   000311 036003                    ADLQ    201,DU
         8 001270   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001271   200012 631500                    EPPR1   I,,AUTO
         8 001272   200020 451500                    STP1    WAIT_SN+4,,AUTO
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:67   
         8 001273   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001274   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001275   000000 701000 xent               TSX1    XSL$QCLOSE
         8 001276   000000 011000                    NOP     0

      395     8654    6                           DS.CTX.SYSID = 0;

   8654  8 001277   000000 220003                    LDX0    0,DU
         8 001300   200003 470500                    LDP0    CTX$,,AUTO
         8 001301   000310 740100                    STX0    200,,PR0

      396     8655    6                           CALL OPEN_CTX ALTRET (KILL_SERVICE);

   8655  8 001302   001652 701000 8                  TSX1    OPEN_CTX
         8 001303   001346 702000 8                  TSX2    KILL_SERVICE

      397     8656    6                           GOTO WAIT_A_BIT;

   8656  8 001304   001621 710000 8                  TRA     WAIT_A_BIT

      398     8657    6                           END;
      399     8658    5                       GOTO KILL_SERVICE;

   8658  8 001305   001346 710000 8                  TRA     KILL_SERVICE

      400     8659    5                       END;
      401     8660    4                   INETD.FPT_RUE.SYSID = S_BLK.WORK.SYSID;

   8660  8 001306   000320 220000 7                  LDX0    S_BLK+72
         8 001307   200004 470500                    LDP0    INETD$,,AUTO
         8 001310   000002 740100                    STX0    2,,PR0

      402     8661    4                   B$DS8$ -> DS.PTRS.SYSID( ( INETD#.OFFSET - B$DS8$ ->

   8661  8 001311   000000 471400 3                  LDP1    BDS8B
         8 001312   100000 236100                    LDQ     0,,PR1
         8 001313   000022 736000                    QLS     18
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:68   
         8 001314   000022 732000                    QRS     18
         8 001315   200020 756100                    STQ     WAIT_SN+4,,AUTO
         8 001316   200004 236100                    LDQ     INETD$,,AUTO
         8 001317   000022 772000                    QRL     18
         8 001320   200020 136100                    SBLQ    WAIT_SN+4,,AUTO
         8 001321   000016 506007                    DIV     14,DL
         8 001322   000320 220000 7                  LDX0    S_BLK+72
         8 001323   100000 740106                    STX0    0,QL,PR1

      403     8662    4                     DS.PTRS.OFFSET( 0) ) / SIZEW( INETD) ) = S_BLK.WORK.SYSID;
      404     8663    4                   END;

      405     8664
      406     8665    4               IF INETD.FPT_RUE.STATE = 0 THEN DO; /* Waiting for accept_srvr */

   8665  8 001324   000002 236100                    LDQ     2,,PR0
         8 001325   000777 316007                    CANQ    511,DL
         8 001326   001417 601000 8                  TNZ     s:8684

      407     8666    4                   S_BLK.ARRAY( 0) = INETD.FPT_RUE.SYSID;

   8666  8 001327   000002 236100                    LDQ     2,,PR0
         8 001330   000022 772000                    QRL     18
         8 001331   000210 756000 7                  STQ     S_BLK

      408     8667    4                   CALL M$STATE( FPT_STATE);

   8667  8 001332   000024 630400 3                  EPPR0   FPT_STATE
         8 001333   020010 713400                    CLIMB   8200
         8 001334   400400 401760                    pmme    nvectors=2

      409     8668    4                   IF S_BLK.ARRAY( 0) ~= %SS_SNULL THEN GOTO WAIT_A_BIT;

   8668  8 001335   000210 235000 7                  LDA     S_BLK
         8 001336   000030 115007                    CMPA    24,DL
         8 001337   001621 601000 8                  TNZ     WAIT_A_BIT

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:69   
      410     8669    4                   DS.CTX.CONNECTS = DS.CTX.CONNECTS + 1;

   8669  8 001340   200003 470500                    LDP0    CTX$,,AUTO
         8 001341   000305 236100                    LDQ     197,,PR0
         8 001342   000001 036007                    ADLQ    1,DL
         8 001343   000305 552134                    STBQ    197,'34'O,PR0

      411     8670    4                   CALL TSTAMP;

   8670  8 001344   001627 701000 8                  TSX1    TSTAMP
         8 001345   000000 011000                    NOP     0

   8669  8 001346                       KILL_SERVICE null
      412     8671    4   KILL_SERVICE: ;
      413     8672    4                   CALL CONCAT( S_BLK.BUF,

   8672  8 001346   040000 100400                    MLR     fill='040'O
         8 001347   000474 000062 3                  ADSC9   STT_FMT+170              cn=0,n=50
         8 001350   000210 000062 7                  ADSC9   S_BLK                    cn=0,n=50
         8 001351   200003 470500                    LDP0    CTX$,,AUTO
         8 001352   040000 100500                    MLR     fill='040'O
         8 001353   000312 000020                    ADSC9   202,,PR0                 cn=0,n=16
         8 001354   000224 400316 7                  ADSC9   S_BLK+12                 cn=2,n=206

      414     8673    4                     'Server failed to connect - suspending service for ',
      415     8674    4                     DS.CTX.SERVICE);
      416     8675    4                   FPT_WRITE.BUF_.BOUND = 61;

   8675  8 001355   000044 236000 7                  LDQ     FPT_WRITE+4
         8 001356   177777 376007                    ANQ     65535,DL
         8 001357   000016 276000 9                  ORQ     14
         8 001360   000044 756000 7                  STQ     FPT_WRITE+4

      417     8676    4                   CALL M$WRITE( FPT_WRITE);

   8676  8 001361   000040 630400 7                  EPPR0   FPT_WRITE
         8 001362   040001 713400                    CLIMB   write
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:70   
         8 001363   401400 401760                    pmme    nvectors=4

      418     8677    4                   FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;

   8677  8 001364   000044 237000 7                  LDAQ    FPT_WRITE+4
         8 001365   000002 757000 7                  STAQ    FPT_KEYIN+2

      419     8678    5                   CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;

   8678  8 001366   000000 630400 7                  EPPR0   FPT_KEYIN
         8 001367   520000 713400                    CLIMB   alt,+40960
         8 001370   401400 401760                    pmme    nvectors=4
         8 001371   001373 702000 8                  TSX2    s:8679
         8 001372   001373 710000 8                  TRA     s:8679

      420     8679    4                   SELECT_MASK( DS.CTX.SOCKET#) = '0'B;

   8679  8 001373   200003 470500                    LDP0    CTX$,,AUTO
         8 001374   000311 235100                    LDA     201,,PR0
         8 001375   001377 605000 8                  TPL     s:8679+4
         8 001376   000044 035003                    ADLA    36,DU
         8 001377   003005 060400                    CSL     bolr='003'O
         8 001400   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         8 001401   000510 000001 7                  BDSC    SELECT_MASK,A            by=0,bit=0,n=1

      421     8680    4                   CALL XSL$QCLOSE( I, DS.CTX.SOCKET#);

   8680  8 001402   200003 236100                    LDQ     CTX$,,AUTO
         8 001403   000311 036003                    ADLQ    201,DU
         8 001404   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001405   200012 631500                    EPPR1   I,,AUTO
         8 001406   200020 451500                    STP1    WAIT_SN+4,,AUTO
         8 001407   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001410   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001411   000000 701000 xent               TSX1    XSL$QCLOSE
         8 001412   000000 011000                    NOP     0

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:71   
      422     8681    4                   DS.CTX.SYSID = 3;

   8681  8 001413   000003 220003                    LDX0    3,DU
         8 001414   200003 470500                    LDP0    CTX$,,AUTO
         8 001415   000310 740100                    STX0    200,,PR0

      423     8682    4                   GOTO WAIT_A_BIT;

   8682  8 001416   001621 710000 8                  TRA     WAIT_A_BIT

      424     8683    4                   END;
      425     8684    4               IF INETD.FPT_RUE.STATE = 1 THEN DO; /* Server awaits our accept */

   8684  8 001417   000002 236100                    LDQ     2,,PR0
         8 001420   000777 376007                    ANQ     511,DL
         8 001421   000001 116007                    CMPQ    1,DL
         8 001422   001443 601000 8                  TNZ     s:8691

      426     8685    4                   DS.CTX.CONNECTS = DS.CTX.CONNECTS + 1;

   8685  8 001423   200003 471500                    LDP1    CTX$,,AUTO
         8 001424   100305 236100                    LDQ     197,,PR1
         8 001425   000001 036007                    ADLQ    1,DL
         8 001426   100305 552134                    STBQ    197,'34'O,PR1

      427     8686    4                   CALL XSL$QACCEPT_INETD( I, DS.CTX.SOCKET#, INETD)

   8686  8 001427   200004 236100                    LDQ     INETD$,,AUTO
         8 001430   200022 756100                    STQ     WAIT_SN+6,,AUTO
         8 001431   200003 236100                    LDQ     CTX$,,AUTO
         8 001432   000311 036003                    ADLQ    201,DU
         8 001433   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001434   200012 633500                    EPPR3   I,,AUTO
         8 001435   200020 453500                    STP3    WAIT_SN+4,,AUTO
         8 001436   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001437   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001440   000000 701000 xent               TSX1    XSL$QACCEPT_INETD
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:72   
         8 001441   001443 702000 8                  TSX2    s:8691

      428     8687    5                   WHENRETURN DO;

      429     8688    5                   GOTO WAIT_A_BIT;

   8688  8 001442   001621 710000 8                  TRA     WAIT_A_BIT

      430     8689    5                   END;
      431     8690    4                   END;

      432     8691    4               IF INETD.ERRNO ~= 0 THEN DO;

   8691  8 001443   200004 470500                    LDP0    INETD$,,AUTO
         8 001444   000006 235100                    LDA     6,,PR0
         8 001445   001457 600000 8                  TZE     s:8697

      433     8692    4                   IF INETD.ERRNO < 0 THEN

   8692  8 001446   001452 605000 8                  TPL     s:8694

      434     8693    4                       P_PCB.ERROR = BINBIT( INETD.ERRNO,36);

   8693  8 001447   000006 236100                    LDQ     6,,PR0
         8 001450   000200 756000 7                  STQ     P_PCB+6
         8 001451   001456 710000 8                  TRA     s:8695

      435     8694    4                   ELSE P_PCB.ERROR = '302314'O | BINBIT( INETD.ERRNO,33);

   8694  8 001452   000006 236100                    LDQ     6,,PR0
         8 001453   000003 736000                    QLS     3
         8 001454   302314 276003                    ORQ     99532,DU
         8 001455   000200 756000 7                  STQ     P_PCB+6

      436     8695    4                   GOTO ERRMSG_KILL;

   8695  8 001456   001213 710000 8                  TRA     ERRMSG_KILL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:73   

      437     8696    4                   END;
      438     8697    3               INETD#.OFFSET = INETD.INETD#; /* Next in chain */

   8697  8 001457   000003 720100                    LXL0    3,,PR0
         8 001460   200004 740100                    STX0    INETD$,,AUTO

      439     8698    3               END;

   8698  8 001461   001167 710000 8                  TRA     s:8635

      440     8699    3           ELSE IF DS.CTX.SYSID=1 THEN DO; /* waiting, actually */

   8699  8 001462   000001 101003                    CMPX1   1,DU
         8 001463   001621 601000 8                  TNZ     WAIT_A_BIT

      441     8700    3               CALL XSL$QBIND( I, DS.CTX.SOCKET#, DS.CTX.LISTEN, 8)

   8700  8 001464   000017 236000 9                  LDQ     15
         8 001465   200023 756100                    STQ     WAIT_SN+7,,AUTO
         8 001466   200003 236100                    LDQ     CTX$,,AUTO
         8 001467   000323 036003                    ADLQ    211,DU
         8 001470   200022 756100                    STQ     WAIT_SN+6,,AUTO
         8 001471   200003 236100                    LDQ     CTX$,,AUTO
         8 001472   000311 036003                    ADLQ    201,DU
         8 001473   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001474   200012 631500                    EPPR1   I,,AUTO
         8 001475   200020 451500                    STP1    WAIT_SN+4,,AUTO
         8 001476   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001477   000022 631400 xsym               EPPR1   B_VECTNIL+18
         8 001500   000000 701000 xent               TSX1    XSL$QBIND
         8 001501   001621 702000 8                  TSX2    WAIT_A_BIT

      442     8701    4               WHENRETURN DO;

      443     8702    4                   CALL XSL$QLISTEN( I, DS.CTX.SOCKET#, 1) ALTRET( KILL_SERVICE);

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:74   
   8702  8 001502   000020 236000 9                  LDQ     16
         8 001503   200022 756100                    STQ     WAIT_SN+6,,AUTO
         8 001504   200003 236100                    LDQ     CTX$,,AUTO
         8 001505   000311 036003                    ADLQ    201,DU
         8 001506   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001507   200012 630500                    EPPR0   I,,AUTO
         8 001510   200020 450500                    STP0    WAIT_SN+4,,AUTO
         8 001511   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001512   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001513   000000 701000 xent               TSX1    XSL$QLISTEN
         8 001514   001346 702000 8                  TSX2    KILL_SERVICE

      444     8703    4                   DS.CTX.SYSID = 0;

   8703  8 001515   000000 220003                    LDX0    0,DU
         8 001516   200003 470500                    LDP0    CTX$,,AUTO
         8 001517   000310 740100                    STX0    200,,PR0

      445     8704    4                   WAIT_MASK( DS.CTX.SOCKET#) = '0'B;

   8704  8 001520   000311 235100                    LDA     201,,PR0
         8 001521   001523 605000 8                  TPL     s:8704+3
         8 001522   000044 035003                    ADLA    36,DU
         8 001523   003005 060400                    CSL     bolr='003'O
         8 001524   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         8 001525   000512 000001 7                  BDSC    WAIT_MASK,A              by=0,bit=0,n=1

      446     8705    4                   SELECT_MASK( DS.CTX.SOCKET#) = '1'B;

   8705  8 001526   000311 235100                    LDA     201,,PR0
         8 001527   001531 605000 8                  TPL     s:8705+3
         8 001530   000044 035003                    ADLA    36,DU
         8 001531   003005 060400                    CSL     bolr='003'O
         8 001532   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         8 001533   000510 000001 7                  BDSC    SELECT_MASK,A            by=0,bit=0,n=1

      447     8706    4                   WAIT_SN = DCBADDR( XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)->
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:75   

   8706  8 001534   000311 235100                    LDA     201,,PR0
         8 001535   000000 471400 xsym               LDP1    XSL_SOCK$$
         8 001536   100004 473505                    LDP3    4,AL,PR1
         8 001537   000000 474400 9                  LDP4    0
         8 001540   400000 475500                    LDP5    0,,PR4
         8 001541   300003 721100                    LXL1    3,,PR3
         8 001542   500000 473511                    LDP3    0,X1,PR5
         8 001543   040100 100500                    MLR     fill='040'O
         8 001544   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         8 001545   200014 000006                    ADSC9   WAIT_SN,,AUTO            cn=0,n=6

      448     8707    4                     XSL$SOCKINFO.DCB#)-> F$DCB.PSN#;
      449     8708    4                   CALL INDEX( I, WAIT_SN, WAIT_NETS);

   8708  8 001546   200012 631500                    EPPR1   I,,AUTO
         8 001547   200014 633500                    EPPR3   WAIT_SN,,AUTO
         8 001550   000006 223003                    LDX3    6,DU
         8 001551   000513 630400 7                  EPPR0   WAIT_NETS
         8 001552   000100 220003                    LDX0    64,DU
         8 001553   000000 236003                    LDQ     0,DU
         8 001554   000000 701000 xent               TSX1    X66_INDEX
         8 001555   000000 011000                    NOP     0

      450     8709    4                   IF I>=WAIT_NETSZ THEN EXIT;

   8709  8 001556   200012 236100                    LDQ     I,,AUTO
         8 001557   000533 116000 7                  CMPQ    WAIT_NETSZ
         8 001560   001621 605000 8                  TPL     WAIT_A_BIT

      451     8710    4                   CALL TSTAMP;

   8710  8 001561   001627 701000 8                  TSX1    TSTAMP
         8 001562   000000 011000                    NOP     0

      452     8711    4                   SUBSTR( WAIT_NETS, I) = SUBSTR( WAIT_NETS, I+8);

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:76   
   8711  8 001563   200012 720100                    LXL0    I,,AUTO
         8 001564   777707 620010                    EAX0    -57,X0
         8 001565   777777 660003                    ERX0    -1,DU
         8 001566   200012 721100                    LXL1    I,,AUTO
         8 001567   777677 621011                    EAX1    -65,X1
         8 001570   777777 661003                    ERX1    -1,DU
         8 001571   200012 235100                    LDA     I,,AUTO
         8 001572   040045 100445                    MLR     fill='040'O
         8 001573   000515 000010 7                  ADSC9   WAIT_NETS+2,A            cn=0,n=*X0
         8 001574   000513 000011 7                  ADSC9   WAIT_NETS,A              cn=0,n=*X1

      453     8712    4                   WAIT_NETSZ = WAIT_NETSZ-8;

   8712  8 001575   000010 336007                    LCQ     8,DL
         8 001576   000533 056000 7                  ASQ     WAIT_NETSZ

      454     8713    4                   CALL CONCAT( S_BLK.BUF, 'Connect received from ', WAIT_SN);

   8713  8 001577   040000 100400                    MLR     fill='040'O
         8 001600   000511 000026 3                  ADSC9   STT_FMT+183              cn=0,n=22
         8 001601   000210 000026 7                  ADSC9   S_BLK                    cn=0,n=22
         8 001602   040000 100500                    MLR     fill='040'O
         8 001603   200014 000006                    ADSC9   WAIT_SN,,AUTO            cn=0,n=6
         8 001604   000215 400352 7                  ADSC9   S_BLK+5                  cn=2,n=234

      455     8714    4                   FPT_WRITE.BUF_.BOUND = 27;

   8714  8 001605   000044 236000 7                  LDQ     FPT_WRITE+4
         8 001606   177777 376007                    ANQ     65535,DL
         8 001607   000021 276000 9                  ORQ     17
         8 001610   000044 756000 7                  STQ     FPT_WRITE+4

      456     8715    4                   CALL M$WRITE( FPT_WRITE);

   8715  8 001611   000040 630400 7                  EPPR0   FPT_WRITE
         8 001612   040001 713400                    CLIMB   write
         8 001613   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:77   

      457     8716    4                   FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;

   8716  8 001614   000044 237000 7                  LDAQ    FPT_WRITE+4
         8 001615   000002 757000 7                  STAQ    FPT_KEYIN+2

      458     8717    4                   CALL M$KEYIN( FPT_KEYIN);

   8717  8 001616   000000 630400 7                  EPPR0   FPT_KEYIN
         8 001617   120000 713400                    CLIMB   40960
         8 001620   401400 401760                    pmme    nvectors=4

      459     8718    4                   END;

      460     8719    3               END;

   8716  8 001621                       WAIT_A_BIT   null
      461     8720    2   WAIT_A_BIT: ;
      462     8721    2           CTX$ = PINCRW( CTX$, SIZEW( DS.CTX));

   8721  8 001621   200003 236100                    LDQ     CTX$,,AUTO
         8 001622   000130 036003                    ADLQ    88,DU
         8 001623   200003 756100                    STQ     CTX$,,AUTO

      463     8722    2           END;

   8722  8 001624   200005 116100                    CMPQ    MAXCTX$,,AUTO
         8 001625   001153 601000 8                  TNZ     s:8633

      464     8723    1       GOTO DO_SELECT;

   8723  8 001626   000774 710000 8                  TRA     DO_SELECT

      465     8724        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:78   
      466     8725    1   TSTAMP: PROC;

   8725  8 001627   200016 741300       TSTAMP       STX1  ! WAIT_SN+2,,AUTO

      467     8726    2           S_BLK.BUF = ' -*-*-';

   8726  8 001630   040000 100400                    MLR     fill='040'O
         8 001631   000517 000006 3                  ADSC9   STT_FMT+189              cn=0,n=6
         8 001632   000210 000400 7                  ADSC9   S_BLK                    cn=0,n=256

      468     8727    2           CALL M$TIME( FPT_TIME);

   8727  8 001633   000024 630400 7                  EPPR0   FPT_TIME
         8 001634   020004 713400                    CLIMB   8196
         8 001635   402000 401760                    pmme    nvectors=5

      469     8728    2           S_BLK.TSTAMP.T.TRAIL = ' -*-*-';

   8728  8 001636   040000 100400                    MLR     fill='040'O
         8 001637   000517 000006 3                  ADSC9   STT_FMT+189              cn=0,n=6
         8 001640   000215 200006 7                  ADSC9   S_BLK+5                  cn=1,n=6

      470     8729    2           FPT_WRITE.BUF_.BOUND = 26;

   8729  8 001641   000044 236000 7                  LDQ     FPT_WRITE+4
         8 001642   177777 376007                    ANQ     65535,DL
         8 001643   000022 276000 9                  ORQ     18
         8 001644   000044 756000 7                  STQ     FPT_WRITE+4

      471     8730    2           CALL M$WRITE( FPT_WRITE);

   8730  8 001645   000040 630400 7                  EPPR0   FPT_WRITE
         8 001646   040001 713400                    CLIMB   write
         8 001647   401400 401760                    pmme    nvectors=4

      472     8731    2   END TSTAMP;

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:79   
   8731  8 001650   200016 221300                    LDX1  ! WAIT_SN+2,,AUTO
         8 001651   000001 702211                    TSX2  ! 1,X1

      473     8732        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:80   
      474     8733    1   OPEN_CTX: PROC ALTRET;

   8733  8 001652   200016 741300       OPEN_CTX     STX1  ! WAIT_SN+2,,AUTO

      475     8734    2       WAIT_SN = XSL_SN;

   8734  8 001653   040100 100400                    MLR     fill='040'O
         8 001654   000000 000006 xsym               ADSC9   XSL_SN                   cn=0,n=6
         8 001655   200014 000006                    ADSC9   WAIT_SN,,AUTO            cn=0,n=6

      476     8735    2       XSL_SN = 'xxxxxx';

   8735  8 001656   040000 100400                    MLR     fill='040'O
         8 001657   000433 000006 3                  ADSC9   STT_FMT+137              cn=0,n=6
         8 001660   000000 000006 xsym               ADSC9   XSL_SN                   cn=0,n=6

      477     8736    2       CALL XSL$QSOCKET( DS.CTX.SOCKET#, %XSL_AF_INET, DS.CTX.TYPE, %XSL_AF_INET)

   8736  8 001661   000023 236000 9                  LDQ     19
         8 001662   200023 756100                    STQ     WAIT_SN+7,,AUTO
         8 001663   200003 236100                    LDQ     CTX$,,AUTO
         8 001664   000322 036003                    ADLQ    210,DU
         8 001665   200022 756100                    STQ     WAIT_SN+6,,AUTO
         8 001666   000023 236000 9                  LDQ     19
         8 001667   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001670   200003 236100                    LDQ     CTX$,,AUTO
         8 001671   000311 036003                    ADLQ    201,DU
         8 001672   200020 756100                    STQ     WAIT_SN+4,,AUTO
         8 001673   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001674   000022 631400 xsym               EPPR1   B_VECTNIL+18
         8 001675   000000 701000 xent               TSX1    XSL$QSOCKET
         8 001676   002105 702000 8                  TSX2    NO_SOCKET

      478     8737    2         ALTRET (NO_SOCKET);
      479     8738    2       XSL_SN = WAIT_SN;

   8738  8 001677   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:81   
         8 001700   200014 000006                    ADSC9   WAIT_SN,,AUTO            cn=0,n=6
         8 001701   000000 000006 xsym               ADSC9   XSL_SN                   cn=0,n=6

      480     8739    2       CALL XSL$QSETSOCKOPT( I, DS.CTX.SOCKET#, %XSL_SOL_SOCKET,

   8739  8 001702   000024 237000 9                  LDAQ    20
         8 001703   200024 757100                    STAQ    WAIT_SN+8,,AUTO
         8 001704   000026 237000 9                  LDAQ    22
         8 001705   200022 757100                    STAQ    WAIT_SN+6,,AUTO
         8 001706   200003 236100                    LDQ     CTX$,,AUTO
         8 001707   000311 036003                    ADLQ    201,DU
         8 001710   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001711   200012 630500                    EPPR0   I,,AUTO
         8 001712   200020 450500                    STP0    WAIT_SN+4,,AUTO
         8 001713   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001714   000024 631400 xsym               EPPR1   B_VECTNIL+20
         8 001715   000000 701000 xent               TSX1    XSL$QSETSOCKOPT
         8 001716   002066 702000 8                  TSX2    NO_BIND

      481     8740    2         %XSL_SO_REUSEADDR, 262144, 2) ALTRET (NO_SETSOCKOPT);
      482     8741    2       XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)-> XSL$SOCKINFO.SOCKNAME = DS.CTX.LISTEN;

   8741  8 001717   200003 470500                    LDP0    CTX$,,AUTO
         8 001720   000311 235100                    LDA     201,,PR0
         8 001721   000000 471400 xsym               LDP1    XSL_SOCK$$
         8 001722   100004 473505                    LDP3    4,AL,PR1
         8 001723   000100 100500                    MLR     fill='000'O
         8 001724   000323 000022                    ADSC9   211,,PR0                 cn=0,n=18
         8 001725   300004 000024                    ADSC9   4,,PR3                   cn=0,n=20

      483     8742    3       CALL XSL$QBIND( I, DS.CTX.SOCKET#, DS.CTX.LISTEN, 8) WHENRETURN DO;

   8742  8 001726   000017 236000 9                  LDQ     15
         8 001727   200023 756100                    STQ     WAIT_SN+7,,AUTO
         8 001730   200003 236100                    LDQ     CTX$,,AUTO
         8 001731   000323 036003                    ADLQ    211,DU
         8 001732   200022 756100                    STQ     WAIT_SN+6,,AUTO
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:82   
         8 001733   200003 236100                    LDQ     CTX$,,AUTO
         8 001734   000311 036003                    ADLQ    201,DU
         8 001735   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001736   200012 633500                    EPPR3   I,,AUTO
         8 001737   200020 453500                    STP3    WAIT_SN+4,,AUTO
         8 001740   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001741   000022 631400 xsym               EPPR1   B_VECTNIL+18
         8 001742   000000 701000 xent               TSX1    XSL$QBIND
         8 001743   001767 702000 8                  TSX2    s:8747

      484     8743    3           CALL XSL$QLISTEN( I, DS.CTX.SOCKET#, 1) ALTRET (NO_LISTEN);

   8743  8 001744   000020 236000 9                  LDQ     16
         8 001745   200022 756100                    STQ     WAIT_SN+6,,AUTO
         8 001746   200003 236100                    LDQ     CTX$,,AUTO
         8 001747   000311 036003                    ADLQ    201,DU
         8 001750   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 001751   200012 630500                    EPPR0   I,,AUTO
         8 001752   200020 450500                    STP0    WAIT_SN+4,,AUTO
         8 001753   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 001754   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001755   000000 701000 xent               TSX1    XSL$QLISTEN
         8 001756   002066 702000 8                  TSX2    NO_BIND

      485     8744    3           SELECT_MASK( DS.CTX.SOCKET#) = '1'B;

   8744  8 001757   200003 470500                    LDP0    CTX$,,AUTO
         8 001760   000311 235100                    LDA     201,,PR0
         8 001761   001763 605000 8                  TPL     s:8744+4
         8 001762   000044 035003                    ADLA    36,DU
         8 001763   003005 060400                    CSL     bolr='003'O
         8 001764   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         8 001765   000510 000001 7                  BDSC    SELECT_MASK,A            by=0,bit=0,n=1

      486     8745    3           END;

   8745  8 001766   002064 710000 8                  TRA     s:8762
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:83   

      487     8746    3       WHENALTRETURN DO;

      488     8747    3           IF XSL_ERRNO > 0 THEN GOTO NO_BIND;

   8747  8 001767   000000 235000 xsym               LDA     XSL_ERRNO
         8 001770   002066 605400 8                  TPNZ    NO_BIND

      489     8748    3           WAIT_SN = DCBADDR( XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)->

   8748  8 001771   200003 470500                    LDP0    CTX$,,AUTO
         8 001772   000311 235100                    LDA     201,,PR0
         8 001773   000000 471400 xsym               LDP1    XSL_SOCK$$
         8 001774   100004 473505                    LDP3    4,AL,PR1
         8 001775   000000 474400 9                  LDP4    0
         8 001776   400000 475500                    LDP5    0,,PR4
         8 001777   300003 720100                    LXL0    3,,PR3
         8 002000   500000 473510                    LDP3    0,X0,PR5
         8 002001   040100 100500                    MLR     fill='040'O
         8 002002   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         8 002003   200014 000006                    ADSC9   WAIT_SN,,AUTO            cn=0,n=6

      490     8749    3             XSL$SOCKINFO.DCB#)-> F$DCB.PSN#;
      491     8750    3           CALL INDEX( I, WAIT_SN, WAIT_NETS);

   8750  8 002004   200012 631500                    EPPR1   I,,AUTO
         8 002005   200014 633500                    EPPR3   WAIT_SN,,AUTO
         8 002006   000006 223003                    LDX3    6,DU
         8 002007   000513 630400 7                  EPPR0   WAIT_NETS
         8 002010   000100 220003                    LDX0    64,DU
         8 002011   000000 236003                    LDQ     0,DU
         8 002012   000000 701000 xent               TSX1    X66_INDEX
         8 002013   000000 011000                    NOP     0

      492     8751    3           SUBSTR( WAIT_NETS, WAIT_NETSZ, 8) = WAIT_SN;

   8751  8 002014   000533 235000 7                  LDA     WAIT_NETSZ
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:84   
         8 002015   040005 100500                    MLR     fill='040'O
         8 002016   200014 000006                    ADSC9   WAIT_SN,,AUTO            cn=0,n=6
         8 002017   000513 000010 7                  ADSC9   WAIT_NETS,A              cn=0,n=8

      493     8752    3           IF WAIT_NETSZ<SIZEC( WAIT_NETS)-8 THEN WAIT_NETSZ = WAIT_NETSZ+8;

   8752  8 002020   000070 115007                    CMPA    56,DL
         8 002021   002024 605000 8                  TPL     s:8753

   8752  8 002022   000010 236007                    LDQ     8,DL
         8 002023   000533 056000 7                  ASQ     WAIT_NETSZ

      494     8753    3           CALL CONCAT( S_BLK.BUF, 'Waiting for connect from ', WAIT_SN);

   8753  8 002024   040000 100400                    MLR     fill='040'O
         8 002025   000521 000031 3                  ADSC9   STT_FMT+191              cn=0,n=25
         8 002026   000210 000031 7                  ADSC9   S_BLK                    cn=0,n=25
         8 002027   040000 100500                    MLR     fill='040'O
         8 002030   200014 000006                    ADSC9   WAIT_SN,,AUTO            cn=0,n=6
         8 002031   000216 200347 7                  ADSC9   S_BLK+6                  cn=1,n=231

      495     8754    3           FPT_WRITE.BUF_.BOUND = 30;

   8754  8 002032   000044 236000 7                  LDQ     FPT_WRITE+4
         8 002033   177777 376007                    ANQ     65535,DL
         8 002034   000030 276000 9                  ORQ     24
         8 002035   000044 756000 7                  STQ     FPT_WRITE+4

      496     8755    3           CALL M$WRITE( FPT_WRITE);

   8755  8 002036   000040 630400 7                  EPPR0   FPT_WRITE
         8 002037   040001 713400                    CLIMB   write
         8 002040   401400 401760                    pmme    nvectors=4

      497     8756    3           DS.CTX.SYSID = 1;

   8756  8 002041   000001 220003                    LDX0    1,DU
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:85   
         8 002042   200003 470500                    LDP0    CTX$,,AUTO
         8 002043   000310 740100                    STX0    200,,PR0

      498     8757    3           WAIT_MASK( DS.CTX.SOCKET#) = '1'B;

   8757  8 002044   000311 235100                    LDA     201,,PR0
         8 002045   002047 605000 8                  TPL     s:8757+3
         8 002046   000044 035003                    ADLA    36,DU
         8 002047   003005 060400                    CSL     bolr='003'O
         8 002050   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         8 002051   000512 000001 7                  BDSC    WAIT_MASK,A              by=0,bit=0,n=1

      499     8758    3           IF I<WAIT_NETSZ THEN EXIT;

   8758  8 002052   200012 236100                    LDQ     I,,AUTO
         8 002053   000533 116000 7                  CMPQ    WAIT_NETSZ
         8 002054   002064 604000 8                  TMI     s:8762

      500     8759    3           FPT_KEYIN.MESS_ = FPT_WRITE.BUF_;

   8759  8 002055   000044 237000 7                  LDAQ    FPT_WRITE+4
         8 002056   000002 757000 7                  STAQ    FPT_KEYIN+2

      501     8760    4           CALL M$KEYIN( FPT_KEYIN) WHENALTRETURN DO; END;

   8760  8 002057   000000 630400 7                  EPPR0   FPT_KEYIN
         8 002060   520000 713400                    CLIMB   alt,+40960
         8 002061   401400 401760                    pmme    nvectors=4
         8 002062   002064 702000 8                  TSX2    s:8762
         8 002063   002064 710000 8                  TRA     s:8762

      502     8761    3           END;

      503     8762    2       RETURN;

   8762  8 002064   200016 221300                    LDX1  ! WAIT_SN+2,,AUTO
         8 002065   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:86   

   8762  8 002066                       NO_BIND      null
   8762  8 002066                       NO_LISTEN    null
   8762  8 002066                       NO_SETSOCKO* null
      504     8763
      505     8764    2   NO_BIND:;
      506     8765    2   NO_LISTEN:;
      507     8766    2   NO_SETSOCKOPT:;
      508     8767    2       I = XSL_ERRNO;

   8767  8 002066   000000 235000 xsym               LDA     XSL_ERRNO
         8 002067   200012 755100                    STA     I,,AUTO

      509     8768    2       IF I >= 0 THEN CALL XSL$QCLOSE( DS.CTX.ACCT, DS.CTX.SOCKET#);

   8768  8 002070   002103 604000 8                  TMI     s:8769

   8768  8 002071   200003 236100                    LDQ     CTX$,,AUTO
         8 002072   000311 036003                    ADLQ    201,DU
         8 002073   200021 756100                    STQ     WAIT_SN+5,,AUTO
         8 002074   200003 236100                    LDQ     CTX$,,AUTO
         8 002075   000300 036003                    ADLQ    192,DU
         8 002076   200020 756100                    STQ     WAIT_SN+4,,AUTO
         8 002077   200020 630500                    EPPR0   WAIT_SN+4,,AUTO
         8 002100   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002101   000000 701000 xent               TSX1    XSL$QCLOSE
         8 002102   000000 011000                    NOP     0

      510     8769    2       XSL_ERRNO = I;

   8769  8 002103   200012 235100                    LDA     I,,AUTO
         8 002104   000000 755000 xsym               STA     XSL_ERRNO

   8769  8 002105                       NO_SOCKET    null
      511     8770    2   NO_SOCKET:;
      512     8771    2       ALTRETURN;

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:87   
   8771  8 002105   200016 221300                    LDX1  ! WAIT_SN+2,,AUTO
         8 002106   000000 702211                    TSX2  ! 0,X1

      513     8772    2   END OPEN_CTX;
      514     8773        %EJECT;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:88   
      515     8774    1   GET_INETD: PROC ALTRET;

   8774  8 002107   200016 741300       GET_INETD    STX1  ! WAIT_SN+2,,AUTO

      516     8775
      517     8776    2       I = 1;

   8776  8 002110   000001 235007                    LDA     1,DL
         8 002111   200012 755100                    STA     I,,AUTO

      518     8777    3   FIND_ONE: DO WHILE '1'B;

   8777  8 002112                       FIND_ONE     null
      519     8778    3           IF I = SIZEW( DS.PTRS) - 1 THEN ALTRETURN; /* Won't fit in the PTRS */

   8778  8 002112   200012 235100                    LDA     I,,AUTO
         8 002113   000177 115007                    CMPA    127,DL
         8 002114   002117 601000 8                  TNZ     s:8779

   8778  8 002115   200016 221300                    LDX1  ! WAIT_SN+2,,AUTO
         8 002116   000000 702211                    TSX2  ! 0,X1

      520     8779    4           IF B$DS8$ -> DS.PTRS.OFFSET( I) = 0 THEN DO;

   8779  8 002117   000000 470400 3                  LDP0    BDS8B
         8 002120   000000 720105                    LXL0    0,AL,PR0
         8 002121   002143 601000 8                  TNZ     s:8790

      521     8780    4               B$DS8$ -> DS.PTRS.OFFSET( I) =

   8780  8 002122   200012 720100                    LXL0    I,,AUTO
         8 002123   077777 721110                    LXL1    -1,X0,PR0
         8 002124   000016 622011                    EAX2    14,X1
         8 002125   000000 442110                    SXL2    0,X0,PR0

      522     8781    4                 B$DS8$ -> DS.PTRS.OFFSET( I-1) + SIZEW( INETD);
      523     8782    4               INETD#.OFFSET = B$DS8$ -> DS.PTRS.OFFSET( I);
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:89   

   8782  8 002126   200012 720100                    LXL0    I,,AUTO
         8 002127   000000 721110                    LXL1    0,X0,PR0
         8 002130   200004 741100                    STX1    INETD$,,AUTO

      524     8783    5               IF INETD$ > MAXINETD$ THEN DO;

   8783  8 002131   200011 236100                    LDQ     MAXINETD$,,AUTO
         8 002132   200004 116100                    CMPQ    INETD$,,AUTO
         8 002133   002142 603000 8                  TRC     s:8787

      525     8784    5                   CALL M$EXTEND( FPT_EXTEND);

   8784  8 002134   000020 630400 3                  EPPR0   FPT_EXTEND
         8 002135   040005 713400                    CLIMB   16389
         8 002136   400000 401760                    pmme    nvectors=1

      526     8785    5                   MAXINETD$ = PINCRW( MAXINETD$, 1024);

   8785  8 002137   200011 236100                    LDQ     MAXINETD$,,AUTO
         8 002140   002000 036003                    ADLQ    1024,DU
         8 002141   200011 756100                    STQ     MAXINETD$,,AUTO

      527     8786    5                   END;

      528     8787    4               GOTO NEW_ENTRY;

   8787  8 002142   002236 710000 8                  TRA     NEW_ENTRY

      529     8788    4               END;
      530     8789
      531     8790    3           INETD#.OFFSET = B$DS8$ -> DS.PTRS.OFFSET( I);

   8790  8 002143   200012 720100                    LXL0    I,,AUTO
         8 002144   000000 721110                    LXL1    0,X0,PR0
         8 002145   200004 741100                    STX1    INETD$,,AUTO

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:90   
      532     8791    4           IF INETD.FPT_RUE.STATE ~= 1 THEN DO;

   8791  8 002146   200004 471500                    LDP1    INETD$,,AUTO
         8 002147   100002 236100                    LDQ     2,,PR1
         8 002150   000777 376007                    ANQ     511,DL
         8 002151   000001 116007                    CMPQ    1,DL
         8 002152   002164 600000 8                  TZE     s:8796

      533     8792    4              S_BLK.ARRAY( 0) = INETD.FPT_RUE.SYSID;

   8792  8 002153   100002 236100                    LDQ     2,,PR1
         8 002154   000022 772000                    QRL     18
         8 002155   000210 756000 7                  STQ     S_BLK

      534     8793    4              CALL M$STATE( FPT_STATE);

   8793  8 002156   000024 630400 3                  EPPR0   FPT_STATE
         8 002157   020010 713400                    CLIMB   8200
         8 002160   400400 401760                    pmme    nvectors=2

      535     8794    4              IF S_BLK.ARRAY( 0) = %SS_SNULL THEN EXIT FIND_ONE;

   8794  8 002161   000210 235000 7                  LDA     S_BLK
         8 002162   000030 115007                    CMPA    24,DL
         8 002163   002166 600000 8                  TZE     s:8798

      536     8795    4              END;

      537     8796    3           I = I + 1;

   8796  8 002164   200012 054100                    AOS     I,,AUTO

      538     8797    3           END FIND_ONE;

   8797  8 002165   002112 710000 8                  TRA     FIND_ONE

      539     8798    2       B$DS8$ -> DS.PTRS.SYSID( I) = 0;
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:91   

   8798  8 002166   000000 220003                    LDX0    0,DU
         8 002167   000000 470400 3                  LDP0    BDS8B
         8 002170   200012 721100                    LXL1    I,,AUTO
         8 002171   000000 740111                    STX0    0,X1,PR0

      540     8799    2       I = INETD.CTX#; /* Remove from the chain off CTX */

   8799  8 002172   200004 471500                    LDP1    INETD$,,AUTO
         8 002173   100003 236100                    LDQ     3,,PR1
         8 002174   000022 732000                    QRS     18
         8 002175   200012 756100                    STQ     I,,AUTO

      541     8800    2       IF PINCRW( B$DS8$, I) -> DS.CTX.INETD# = INETD#.OFFSET

   8800  8 002176   200004 235100                    LDA     INETD$,,AUTO
         8 002177   000022 771000                    ARL     18
         8 002200   200020 755100                    STA     WAIT_SN+4,,AUTO
         8 002201   000310 236106                    LDQ     200,QL,PR0
         8 002202   000022 736000                    QLS     18
         8 002203   000022 732000                    QRS     18
         8 002204   200020 116100                    CMPQ    WAIT_SN+4,,AUTO
         8 002205   002212 601000 8                  TNZ     s:8803

      542     8801    2       THEN PINCRW( B$DS8$, I) -> DS.CTX.INETD# = INETD.INETD#;

   8801  8 002206   100003 721100                    LXL1    3,,PR1
         8 002207   200012 722100                    LXL2    I,,AUTO
         8 002210   000310 441112                    SXL1    200,X2,PR0
         8 002211   002236 710000 8                  TRA     NEW_ENTRY

      543     8802    3       ELSE DO;

      544     8803    3           I = PINCRW( B$DS8$, I) -> DS.CTX.INETD#;

   8803  8 002212   200012 721100                    LXL1    I,,AUTO
         8 002213   000310 236111                    LDQ     200,X1,PR0
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:92   
         8 002214   000022 736000                    QLS     18
         8 002215   000022 732000                    QRS     18
         8 002216   200012 756100                    STQ     I,,AUTO

      545     8804    4           DO WHILE '1'B;

      546     8805    4               IF PINCRW( B$DS8$, I) -> INETD.INETD# = INETD#.OFFSET THEN EXIT;

   8805  8 002217   200004 235100                    LDA     INETD$,,AUTO
         8 002220   000022 771000                    ARL     18
         8 002221   200020 755100                    STA     WAIT_SN+4,,AUTO
         8 002222   000000 470400 3                  LDP0    BDS8B
         8 002223   200012 720100                    LXL0    I,,AUTO
         8 002224   000003 236110                    LDQ     3,X0,PR0
         8 002225   000022 736000                    QLS     18
         8 002226   000022 732000                    QRS     18
         8 002227   200020 116100                    CMPQ    WAIT_SN+4,,AUTO
         8 002230   002233 600000 8                  TZE     s:8808

      547     8806    4               I = PINCRW( B$DS8$, I) -> INETD.INETD#;

   8806  8 002231   200012 756100                    STQ     I,,AUTO

      548     8807    4               END;

   8807  8 002232   002217 710000 8                  TRA     s:8805

      549     8808    3           PINCRW( B$DS8$, I) -> INETD.INETD# = INETD.INETD#;

   8808  8 002233   200004 471500                    LDP1    INETD$,,AUTO
         8 002234   100003 721100                    LXL1    3,,PR1
         8 002235   000003 441110                    SXL1    3,X0,PR0

      550     8809    3           END;

   8808  8 002236                       NEW_ENTRY    null
      551     8810
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:93   
      552     8811    2   NEW_ENTRY: ;
      553     8812    2       INETD = INETD_INIT;

   8812  8 002236   200004 470500                    LDP0    INETD$,,AUTO
         8 002237   000100 100400                    MLR     fill='000'O
         8 002240   000204 000064 3                  ADSC9   INETD_INIT               cn=0,n=52
         8 002241   000000 000064                    ADSC9   0,,PR0                   cn=0,n=52

      554     8813    2       INETD.INETD# = DS.CTX.INETD#;

   8813  8 002242   200003 471500                    LDP1    CTX$,,AUTO
         8 002243   100310 720100                    LXL0    200,,PR1
         8 002244   000003 440100                    SXL0    3,,PR0

      555     8814    2       INETD.CTX# = CTX#.OFFSET;

   8814  8 002245   200003 221100                    LDX1    CTX$,,AUTO
         8 002246   000003 741100                    STX1    3,,PR0

      556     8815    2       INETD.FPT_RUE.EVENT = %SS_WU;

   8815  8 002247   027000 236007                    LDQ     11776,DL
         8 002250   000002 552110                    STBQ    2,'10'O,PR0

      557     8816    2       VBASE( INETD.FPT_RUE.V_) = ADDR( INETD.FPT_RUE.SYSID);

   8816  8 002251   200004 236100                    LDQ     INETD$,,AUTO
         8 002252   000002 036003                    ADLQ    2,DU
         8 002253   000001 756100                    STQ     1,,PR0

      558     8817    2       DS.CTX.INETD# = INETD#.OFFSET;

   8817  8 002254   200004 222100                    LDX2    INETD$,,AUTO
         8 002255   100310 442100                    SXL2    200,,PR1

      559     8818    2       INETD.NAME = XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)-> XSL$SOCKINFO.SOCKNAME;

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:94   
   8818  8 002256   100311 235100                    LDA     201,,PR1
         8 002257   000000 473400 xsym               LDP3    XSL_SOCK$$
         8 002260   300004 474505                    LDP4    4,AL,PR3
         8 002261   000100 100500                    MLR     fill='000'O
         8 002262   400004 000024                    ADSC9   4,,PR4                   cn=0,n=20
         8 002263   000010 000024                    ADSC9   8,,PR0                   cn=0,n=20

      560     8819    2       INETD.SERNUM = XSL$SOCKHD.SOCK$( DS.CTX.SOCKET#)-> XSL$SOCKINFO.SERNUM;

   8819  8 002264   100311 235100                    LDA     201,,PR1
         8 002265   300004 474505                    LDP4    4,AL,PR3
         8 002266   040100 100500                    MLR     fill='040'O
         8 002267   400002 000006                    ADSC9   2,,PR4                   cn=0,n=6
         8 002270   000004 400006                    ADSC9   4,,PR0                   cn=2,n=6

      561     8820    2   END GET_INETD;

   8820  8 002271   200016 221300                    LDX1  ! WAIT_SN+2,,AUTO
         8 002272   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
   1     000   000000 000000   000000 000000   000000 000000   000000 000501    ................
   1     004   000000 000000   000000 000000   000000 006014   000000 006014    ................
   1     010   016145 164143   072151 156145   164144 137143   157156 146040    .etc:inetd_conf
   1     014   040040 040040   040040 040040   040040 040040   040040 040040
   1     020   072123 131123   040040 040040   040040 040040   040040 040040    :SYS
   1     024   040040 040040   040040 040040   115105 040040   040040 040040            ME
   1     030   040040 040040   000000 203015   000000 001000   000000 000000        ............
   1     034   000000 000000   000000 000000   000000 000000   000002 776003    ................
   1     040   001000 000000   000000 000002   000000 000000   000000 000000    ................
   1     044   000000 000111   040040 040040   000000 006014   000000 006014    ...I    ........
   1     050   000000 006014   000000 000000   000000 000000   000000 006014    ................
   1     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     060   000000 010000   000000 000000   000000 000000   000000 000000    ................
   1     064   000000 000020   000000 000000   000000 006014   000000 000000    ................
   1     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:95   
   1     074   000000 000000   000000 006014   000000 000000   000000 000000    ................
   1     100   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     104   ****** ******   ****** ******   000000 000000   ****** ******    ................
   1     110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     124*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   1     134*  ****** ******   ****** ******   ****** ******   000000 070707    ..............8.
   1     140   ****** ******   ****** ******                                    ........

(unnamed)
 Sect OctLoc
   2     000   000000 000000   000000 000000   000000 000000   000000 000501    ................
   2     004   000000 000000   000000 000000   000000 006014   000000 006014    ................
   2     010   006151 156145   164144 072040   040040 040040   040040 040040    .inetd:
   2     014   040040 040040   040040 040040   040040 040040   040040 040040
   2     020   072123 131123   040040 040040   040040 040040   040040 040040    :SYS
   2     024   040040 040040   040040 040040   115105 040040   040040 040040            ME
   2     030   040040 040040   000000 206215   003003 001000   000000 000000        ............
   2     034   000000 000000   000000 000000   000000 000013   000002 776003    ................
   2     040   001000 000000   000000 000002   000000 000000   000000 000000    ................
   2     044   000000 000111   040040 040040   000000 006014   000000 006014    ...I    ........
   2     050   000000 006014   000000 000000   000000 000000   000000 006014    ................
   2     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     060   000000 010000   000000 000000   000000 000000   000000 000000    ................
   2     064   000000 000020   000000 000000   000000 006014   000000 000000    ................
   2     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     074   000000 000000   000000 006014   000000 000000   000000 000000    ................
   2     100   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     104   ****** ******   ****** ******   000000 000000   ****** ******    ................
   2     110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     124*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   2     134*  ****** ******   ****** ******   ****** ******   000000 070707    ..............8.
   2     140   ****** ******   ****** ******                                    ........

BDS8B
 Sect OctLoc
   3     000   000000 006013                                                    ....

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:96   
FPT_READ
 Sect OctLoc
   3     002   000005 777640   000012 006000   000000 177640   000000 006014    ................
   3     006   000077 777640   000210 006000   000000 177640   000000 006014    .?..............
   3     012   000000 400000   000000 000000   000000 000000   000000 000000    ................
   3     016   000000 000000   000000 000000                                    ........

FPT_EXTEND
 Sect OctLoc
   3     020   000001 777640   000022 006000   000000 000001   000000 000000    ................

FPT_STATE
 Sect OctLoc
   3     024   000077 777640   000210 006000   000077 777640   000210 006000    .?.......?......

SYS_PRIV
 Sect OctLoc
   3     030   000001 777640   000032 006000   000000 000010   000000 000000    ................

FMSEC_PRIV
 Sect OctLoc
   3     034   000001 777640   000036 006000   100000 000000   000000 000000    ........@.......

FPT_GJOB
 Sect OctLoc
   3     040   000001 777640   000054 006000   000001 777640   000310 006000    .....,..........
   3     044   000003 777640   000312 006000   000001 777640   000316 006000    ................
   3     050   000077 777640   000210 006000   000001 777640   000320 006000    .?..............
   3     054   000000 000000   000000 000000                                    ........

CLOSE_SI
 Sect OctLoc
   3     056   000003 777640   000110 006000   000000 177640   000000 006014    .....H..........
   3     062   000000 177640   000000 006014   000000 177640   000000 006014    ................
   3     106*  000000 177640   000000 006014   000000 000000   000000 000040    ...............
   3     112   000220 000000   000000 000000                                    ........

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:97   
CLOSE_DO
 Sect OctLoc
   3     114   000003 777640   000146 006000   000000 177640   000000 006014    .....f..........
   3     120   000000 177640   000000 006014   000000 177640   000000 006014    ................
   3     144*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   3     150   000220 000000   000000 000000                                    ........

PRINT_IT
 Sect OctLoc
   3     152   000005 777640   000170 006000   000000 177640   000000 006014    .....x..........
   3     156   000000 177640   000000 006014   000000 177640   000000 006014    ................
   3     166*  000000 177640   000000 006014   114120 060061   000000 040040    ........LP01..
   3     172   000000 000000   000000 200111   040040 040040   000040 040000    .......I    .  .

TCI_SOCKINIT
 Sect OctLoc
   3     176   000000 000044   000000 000000   000000 001000   000000 006014    ...$............
   3     202   000000 000000   000002 000000                                    ........

INETD_INIT
 Sect OctLoc
   3     204   000001 777640   000204 006000   000000 000000   000000 000000    ................
   3     210   000000 040040   040040 040040   000000 000000   000000 000000    ..      ........
   3     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
   3     220   000000 000000                                                    ....

STT_FMT
 Sect OctLoc
   3     222   045061 070116   133111 116105   124104 040151   163040 156157    %18N[INETD is no
   3     226   164040 162165   156156 151156   147040 055040   154141 163164    t running - last
   3     232   040163 164141   164165 163040   146157 154154   157167 163072     status follows:
   3     236   045057 045135   045061 062070   075045 056061   103045 061070    %/%]%128=%.1C%18
   3     242   116072 061075   050045 056061   043072 062053   120045 057055    N:1=(%.1#:2+P%/-
   3     246   045067 056061   070104 045061   123045 066056   071104 045062    %7.18D%1S%6.9D%2
   3     252   123045 061070   116056 061075   045070 056061   070104 040040    S%18N.1=%8.18D
   3     256   040045 066101   045071 104040   040045 061060   123045 100061     %6A%9D  %10S%@1
   3     262   066116 056062   075045 063050   045056 071104   056045 051045    6N.2=%3(%.9D.%)%
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:98   
   3     266   056071 104054   045056 062043   113104 045061   043051 045103    .9D,%.2#KD%1#)%C
   3     272   123145 162166   151143 145040   040040 040040   040040 040040    Service
   3     276   110157 163164   040040 040040   040040 040040   040040 040040    Host
   3     302   103157 156156   145143 164163   040040 103157   155155 141156    Connects  Comman
   3     306   144045 057040   040040 123171   163151 144040   123164 141164    d%/   Sysid Stat
   3     312   145040 040040   114144 143164   170040 040040   122156 141155    e   Ldctx   Rnam
   3     316   145040 040040   040040 105162   162156 157040   040103 154151    e     Errno  Cli
   3     322   145156 164040   101144 144162   145163 163045   057055 055055    ent Address%/---
   3     326   055055 055055   055055 055055   055055 055055   055055 055055    ----------------
   3     336*  055055 055055   055055 055055   055055 055055   055055 045057    --------------%/
   3     342   045136 045056   043072 067064   053120 045056   061066 101045    %^%.#:74+P%.16A%
   3     346   056061 066101   045056 043072   066071 053056   061120 045070    .16A%.#:69+.1P%8
   3     352   056062 067104   040040 045056   043120 045056   062065 066076    .27D  %.#P%.256>
   3     356   101045 056043   072067 062053   120045 061056   061070 116133    A%.#:72+P%1.18N[
   3     362   045057 040040   040056 056056   040167 141151   164151 156147    %/   ... waiting
   3     366   040146 157162   040156 145164   167157 162153   040143 157156     for network con
   3     372   156145 143164   045062 077045   062123 045057   040040 040052    nect%2?%2S%/   *
   3     376   052052 045056   056112 045063   077045 057040   040040 052052    **%..J%3?%/   **
   3     402   052040 163145   162166 151143   145040 163165   163160 145156    * service suspen
   3     406   144145 144045   061103 045077   045061 103045   135045 043072    ded%1C%?%1C%]%#:
   3     412   070070 053075   045056 043120   045071 116133   045061 121045    88+=%.#P%9N[%1Q%
   3     416   135045 057***                                                    ]%/.

(unnamed)
 Sect OctLoc
   3     417   123171 156164   141170 040145   162162 157162   040151 156040    Syntax error in
   3     423   143157 155155   141156 144056   122105 123124   101122 124040    command.RESTART
   3     427   120122 111116   124040 040040   123124 101124   125123 040040    PRINT   STATUS
   3     433   170170 170170   170170 170170   111116 105124   104040 141142    xxxxxxxxINETD ab
   3     437   157162 164040   055040 156157   040163 145162   166151 143145    ort - no service
   3     443   163040 164157   040163 145162   166151 143145   056040 040040    s to service.
   3     447   111116 105124   104040 141142   157162 164040   055040 141156    INETD abort - an
   3     453   157164 150145   162040 111116   105124 104040   150141 163040    other INETD has
   3     457   141163 163165   155145 144040   143157 156164   162157 154056    assumed control.
   3     463   106141 151154   145144 040164   157040 163164   141162 164040    Failed to start
   3     467   141040 147150   157163 164040   165163 145162   040146 157162    a ghost user for
   3     473   040040 040040   123145 162166   145162 040146   141151 154145        Server faile
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:99   
   3     477   144040 164157   040143 157156   156145 143164   040055 040163    d to connect - s
   3     503   165163 160145   156144 151156   147040 163145   162166 151143    uspending servic
   3     507   145040 146157   162040 040040   103157 156156   145143 164040    e for   Connect
   3     513   162145 143145   151166 145144   040146 162157   155040 040040    received from
   3     517   040055 052055   052055 040040   127141 151164   151156 147040     -*-*-  Waiting
   3     523   146157 162040   143157 156156   145143 164040   146162 157155    for connect from
   3     527   040040 040040

FPT_KEYIN
 Sect OctLoc
   7     000   000005 777640   000010 006000   000000 17764*   000000 006014    ................
   7     004   000000 17764*   000000 006014   000000 177640   000000 006014    ................
   7     010   040040 040040   040040 040040   000000 000000   400000 000000            ........
   7     014   000000 000000   000000 000000                                    ........

FPT_WAIT
 Sect OctLoc
   7     016   000001 777640   000022 006000   000000 177640   000000 006014    ................
   7     022   000000 000005   000000 000001                                    ........

FPT_TIME
 Sect OctLoc
   7     024   000001 777640   000036 006000   000002 177640   000211 606000    ................
   7     030   000002 577640   000214 006000   000000 177640   000000 006014    ................
   7     034   000000 177640   000000 006014   000003 000000   ****** ******    ................

FPT_WRITE
 Sect OctLoc
   7     040   000003 777640   000050 006000   000000 177640   000000 006014    .....(..........
   7     044   000077 777640   000210 006000   000000 177640   000000 006014    .?..............
   7     050   000000 400400   000000 000000   000000 000000   000000 000000    ................

FPT_ERRMSG
 Sect OctLoc
   7     054   000003 777640   000102 006000   000000 777640   000200 006000    .....B..........
   7     060   000077 777640   000210 006000   000000 177640   000000 006014    .?..............
   7     064   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:100  
   7     100*  000000 177640   000000 006014   000000 000000   000000 003000    ................
   7     104   371000 130001   040000 000000                                    ..X. ...

FPT_GDS
 Sect OctLoc
   7     106   000001 777640   000112 006000   000001 777640   000310 006000    .....J..........
   7     112   000600 002000   ****** ******                                    ........

FPT_LDTRC
 Sect OctLoc
   7     114   000000 177640   000000 006014   000000 177640   000000 006014    ................
   7     130*  000001 777640   000132 006000   000000 000000   000000 000000    .....Z..........

FDS
 Sect OctLoc
   7     134   000000 177640   000000 006014   000000 000000   000000 000000    ................
   7     140   000000 000000   000077 777640   000210 006000   000000 000001    .....?..........
   7     144   000000 000000   000000 000000   000000 006014   000000 101500    ..............A.
   7     150   000000 000000   000000 000000   000000 000001   000000 000012    ................
   7     154   000000 000000   ****** ******   ****** ******   000000 000000    ................
   7     160   000000 000000   000000 000000   000000 000000   000000 006014    ................
   7     164   000000 006014   000000 006014   000000 006014   000000 000000    ................
   7     170   000000 000000   000000 000000                                    ........

P_PCB
 Sect OctLoc
   7     172   000210 006000   000000 006000   000310 006000   000000 006014    ................
   7     176   000000 000000   000200 600000   000000 000000   040042 040042    ............ " "
   7     202   000000 040000   000000 000400   000000 000000   000000 006014    .. .............
   7     206   000000 006014   000000 000000                                    ........

S_BLK
 Sect OctLoc
   7     210   ****** ******   ****** ******   ****** ******   ****** ******    ................
   7     310*  040040 040040   040040 006013   ****** ******   ****** ******          ..........
   7     504*  ****** ******   ****** ******   ****** ******   ****** ******    ................

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:101  
SELECT_MASK
 Sect OctLoc
   7     510   000000 000000                                                    ....

SRVR_COUNT
 Sect OctLoc
   7     511   777777 777777                                                    ....

WAIT_MASK
 Sect OctLoc
   7     512   000000 000000                                                    ....

WAIT_NETS
 Sect OctLoc
   7     513   040040 040040   040040 040040   040040 040040   040040 040040
   7     527*  040040 040040   040040 040040   040040 040040   040040 040040

WAIT_NETSZ
 Sect OctLoc
   7     533   000000 000000                                                    ....

RB
 Sect OctLoc
   7     534   051*** ******                                                    )...

LB
 Sect OctLoc
   7     535   050*** ******                                                    (...

(unnamed)
 Sect OctLoc
   9     000   000000 006003   000007 777640   000001 777640   000077 777640    .............?..
   9     004   000174 577640   000222 006000   000134 006000   000004 006000    .|.......\......
   9     010   000176 006000   000172 006000   000040 040040   777777 437777    .~...z...   ....
   9     014   000011 200000   000511 006000   000017 200000   000012 006000    ................
   9     020   000003 006000   000006 600000   000006 400000   000004 006000    ................
   9     024   000017 006000   000004 006000   000027 006000   000006 006000    ................
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:102  
   9     030   000007 400000                                                    ....
      562     8821
      563     8822    1       END TCI$INETD;

PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:103  
--  Include file information  --

   XU_SUBS_C.:LIBRARY  is referenced.
   XU_MACRO_C.:LIBRARY  is referenced.
   XU_FORMAT_C.:LIBRARY  is referenced.
   TCI_NODES_E.:TCA2TOU  is referenced.
   XSL_INTERNAL_M.:TCA2TOU  is referenced.
   XSL_PERR_C.:TCA2TOU  is referenced.
   XSL_SOCKET_M.:TCA2TOU  is referenced.
   XSL_SOCKET_E.:TCA2TOU  is referenced.
   SS_SCHED_C.:LIBRARY  is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIBRARY  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCI$INETD.
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:104  

 **** Variables and constants ****

  ****  Section 003 RoData TCI$INETD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS8$                     0-0-0/w UBIN        r     1 BDS8B
   114-0-0/d STRC(1080)  r     1 CLOSE_DO                  56-0-0/d STRC(1080)  r     1 CLOSE_SI
    34-0-0/d STRC(144)   r     1 FMSEC_PRIV                20-0-0/d STRC(144)   r     1 FPT_EXTEND
    40-0-0/d STRC(504)   r     1 FPT_GJOB                   2-0-0/d STRC(504)   r     1 FPT_READ
    24-0-0/d STRC(144)   r     1 FPT_STATE                204-0-0/d STRC(468)   r     1 INETD_INIT
   152-0-0/d STRC(720)   r     1 PRINT_IT                 222-0-0/c STRC(4491)  r     1 STT_FMT
    30-0-0/d STRC(144)   r     1 SYS_PRIV                 176-0-0/w STRC(216)   r     1 TCI_SOCKINIT

  ****  Section 007  Data  TCI$INETD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   134-0-0/w STRC(1080)  r     1 FDS                       54-0-0/d STRC(936)   r     1 FPT_ERRMSG
   106-0-0/d STRC(216)   r     1 FPT_GDS                    0-0-0/d STRC(504)   r     1 FPT_KEYIN
   114-0-0/d STRC(576)   r     1 FPT_LDTRC                 24-0-0/d STRC(432)   r     1 FPT_TIME
    16-0-0/d STRC(216)   r     1 FPT_WAIT                  40-0-0/d STRC(432)   r     1 FPT_WRITE
   535-0-0/c CHAR        r     1 LB                       172-0-0/w STRC(504)   r     1 P_PCB
   534-0-0/c CHAR        r     1 RB
   510-0-0/b BIT         r     1 SELECT_MASK(0:35)
   511-0-0/w SBIN        r     1 SRVR_COUNT               210-0-0/d STRC(6912)  r     1 S_BLK
   512-0-0/b BIT         r     1 WAIT_MASK(0:35)
   513-0-0/c CHAR(64)    r     1 WAIT_NETS                533-0-0/w SBIN        r     1 WAIT_NETSZ

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w STRC        r     1 CTX#                       3-0-0/w PTR         r     1 CTX$
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:105  
    12-0-0/w SBIN        r     1 I                          4-0-0/w STRC        r     1 INETD#
     4-0-0/w PTR         r     1 INETD$                     5-0-0/w PTR         r     1 MAXCTX$
    11-0-0/w PTR         r     1 MAXINETD$                 10-0-0/w PTR         r     1 P$OUT$
     7-0-0/w PTR         r     1 PROTO$
    13-0-0/b BIT         r     1 SELECT_RESULT(0:35)
     6-0-0/w PTR         r     1 SERV$                     14-0-0/c CHAR(6)     r     1 WAIT_SN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w PTR         r     1 B$XL_UPPER$                0-0-0/w UBIN        r     1 TCI_CMD
     0-0-0/w SBIN        r     1 XSL_ERRNO                  0-0-0/c CHAR(6)     r     1 XSL_SN
     0-0-0/w PTR         r     1 XSL_SOCK$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w PTR         r     1 B$PTR                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w UBIN        r     1 B$UBIN                     0-0-0/d STRC(4608)  r     1 B$XL_UPPER
     0-0-0/d STRC(7776)  r     1 DS                         0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(468)   r     1 INETD                      0-0-0N  NULL        r     1 M$DO
     0-0-0/d ASTR(3528)  r     1 M$DS                       0-0-0N  NULL        r     1 M$LM
     0-0-0/d ASTR(3528)  r     1 M$SI                       0-0-0/w STRC(144)   r     1 P$OUT
     0-0-0/w ASTR(153)   r     1 P$SYM                      0-0-0/w STRC(180)   r     1 XSL$HOSTENT
     0-0-0/w STRC(144)   r     1 XSL$SERVENT                0-0-0/w STRC(180)   r     1 XSL$SOCKHD
     0-0-0/w STRC(720)   r     1 XSL$SOCKINFO               0-0-0/w ASTR(9)     r     1 ZAPDS


   Procedure TCI$INETD requires 1211 words for executable code.
   Procedure TCI$INETD requires 22 words of local(AUTO) storage.
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:106  

    No errors detected in file TCI$INETD.:TCA2TSI    .
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:107  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:108  
          MINI XREF LISTING

B$ALT.CODE
      1689**DCL      1689--REDEF    1690--REDEF    1690--REDEF
B$ALT.ERR
      1690**DCL      8639>>ASSIGN
B$ALT.ERR.ERR#
      1691**DCL      1691--REDEF
B$ALT.EVID
      1690**DCL      1690--REDEF    1690--REDEF
B$DS8$
      1849**DCL      1850--IMP-PTR  8451>>ASSIGN   8452>>ASSIGN   8465>>ASSIGN   8467>>ASSIGN   8468>>ASSIGN
      8469>>CALL     8482>>ASSIGN   8483>>ASSIGN   8484>>ASSIGN   8485>>ASSIGN   8486>>ASSIGN   8593>>ASSIGN
      8612>>IF       8612>>IF       8618>>IF       8619>>IF       8620>>ASSIGN   8621>>ASSIGN   8622>>CALL
      8630>>ASSIGN   8631>>ASSIGN   8661>>ASSIGN   8661>>ASSIGN   8779>>IF       8780>>ASSIGN   8780>>ASSIGN
      8782>>ASSIGN   8790>>ASSIGN   8798>>ASSIGN   8800>>IF       8801>>ASSIGN   8803>>ASSIGN   8805>>IF
      8806>>ASSIGN   8808>>ASSIGN
B$JIT.CCBUF
      1498**DCL      8436--ASSIGN   8437>>CALLBLT  8438>>CALLBLT
B$JIT.CPFLAGS1.SLEAZE
      1504**DCL      1504--REDEF
B$JIT.ERR.MID
      1411**DCL      1411--REDEF
B$JIT.JRESPEAK
      1572**DCL      1573--REDEF
B$JIT.MODE
      1405**DCL      8474>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1681**DCL      1681--REDEF    1682--REDEF
B$JIT.PNR
      1585**DCL      1585--REDEF
B$JIT.PRIV.JOB.FMSEC
      1455**DCL      8464>>IF       8475>>IF
B$JIT.SYSID
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:109  
      1410**DCL      8484>>ASSIGN   8612>>IF       8620>>ASSIGN
B$JIT.TSLINE
      1679**DCL      1680--REDEF
B$JIT$
      1686**DCL      1405--IMP-PTR  8436>>ASSIGN   8437>>CALLBLT  8438>>CALLBLT  8464>>IF       8474>>IF
      8475>>IF       8484>>ASSIGN   8612>>IF       8620>>ASSIGN
B$PTR
      8424**DCL      8518>>ASSIGN
B$TCB.ALT$
      1696**DCL      8639>>ASSIGN
B$TCB$
      1698**DCL      8639>>ASSIGN
B$UBIN
      8423**DCL      8518>>ASSIGN
B$XL_UPPER
      1394**DCL      8446>>CALLBLT
B$XL_UPPER$
      1393**DCL      1394--IMP-PTR  8446>>CALLBLT
BAD_HOST
      8559**LABEL    8517--CALLALT
BAD_SERVICE
      8566**LABEL    8543--GOTO     8550--CALLALT  8555--CALLALT
BDS8B
      1848**DCL      1849--REDEF
CLOSE_DO
      2023**DCL      8623<>CALL
CLOSE_DO.SN_
      2023**DCL      2023--REDEF
CLOSE_DO.UTL_
      2024**DCL      2024--REDEF
CLOSE_DO.V
      2028**DCL      2023--DCLINIT
CLOSE_DO.V.EXPIRE#
      2038**DCL      2038--REDEF
CLOSE_DO.V.TYPE#
      2036**DCL      2036--REDEF
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:110  
CLOSE_DO.V.XTNSIZE#
      2033**DCL      2033--REDEF    2035--REDEF
CLOSE_SI
      1981**DCL      8585<>CALL
CLOSE_SI.SN_
      1981**DCL      1981--REDEF
CLOSE_SI.UTL_
      1982**DCL      1982--REDEF
CLOSE_SI.V
      1986**DCL      1981--DCLINIT
CLOSE_SI.V.EXPIRE#
      1996**DCL      1996--REDEF
CLOSE_SI.V.TYPE#
      1994**DCL      1994--REDEF
CLOSE_SI.V.XTNSIZE#
      1991**DCL      1991--REDEF    1993--REDEF
CTX#.OFFSET
      8412**DCL      8593>>ASSIGN   8814>>ASSIGN
CTX$
      8411**DCL      4209--IMP-PTR  8412--REDEF    8485<<ASSIGN   8506>>ASSIGN   8507>>ASSIGN   8508>>ASSIGN
      8513>>ASSIGN   8515>>CALLBLT  8517>>CALL     8518>>ASSIGN   8522>>ASSIGN   8525>>ASSIGN   8526>>ASSIGN
      8527>>ASSIGN   8531>>ASSIGN   8534>>ASSIGN   8546>>CALLBLT  8547>>CALL     8547>>CALL     8552>>ASSIGN
      8558<<ASSIGN   8558>>ASSIGN   8559>>IF       8575>>ASSIGN   8576>>ASSIGN   8586>>ASSIGN   8630<<ASSIGN
      8632>>DOUNTIL  8633>>ASSIGN   8634>>IF       8634>>IF       8637>>ASSIGN   8646>>CALLBLT  8652>>ASSIGN
      8653>>CALL     8654>>ASSIGN   8669>>ASSIGN   8669>>ASSIGN   8672>>CALLBLT  8679>>ASSIGN   8680>>CALL
      8681>>ASSIGN   8685>>ASSIGN   8685>>ASSIGN   8686>>CALL     8699>>IF       8700>>CALL     8700>>CALL
      8702>>CALL     8703>>ASSIGN   8704>>ASSIGN   8705>>ASSIGN   8706>>ASSIGN   8721<<ASSIGN   8721>>ASSIGN
      8736>>CALL     8736>>CALL     8739>>CALL     8741>>ASSIGN   8741>>ASSIGN   8742>>CALL     8742>>CALL
      8743>>CALL     8744>>ASSIGN   8748>>ASSIGN   8756>>ASSIGN   8757>>ASSIGN   8768>>CALL     8768>>CALL
      8813>>ASSIGN   8817>>ASSIGN   8818>>ASSIGN   8819>>ASSIGN
DONE_READING
      8579**LABEL    8496--GOTO     8580--GOTO
DO_SELECT
      8593**LABEL    8629--GOTO     8723--GOTO
DS
      4209**DCL      8486--ASSIGN   8487--ASSIGN   8526>>ASSIGN   8550<>CALL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:111  
DS.CTX
      4236**DCL      8506<<ASSIGN   8558--ASSIGN   8637<<ASSIGN   8637>>ASSIGN   8721--ASSIGN
DS.CTX.ACCT
      4238**DCL      8525<<ASSIGN   8768<>CALL
DS.CTX.BUF
      4237**DCL      8534<<ASSIGN
DS.CTX.CONNECTS
      4240**DCL      8669<<ASSIGN   8669>>ASSIGN   8685<<ASSIGN   8685>>ASSIGN
DS.CTX.HOST
      4246**DCL      8515<<CALLBLT  8517<>CALL
DS.CTX.INETD#
      4243**DCL      8633>>ASSIGN   8800>>IF       8801<<ASSIGN   8803>>ASSIGN   8813>>ASSIGN   8817<<ASSIGN
DS.CTX.LISTEN
      4267**DCL      8700<>CALL     8741>>ASSIGN   8742<>CALL
DS.CTX.LISTEN.SA_FAMILY
      4280**DCL      8507<<ASSIGN
DS.CTX.LISTEN.S_ADDR
      4309**DCL      8518<<ASSIGN
DS.CTX.LISTEN.S_PORT
      4289**DCL      8546<<CALLBLT  8547<>CALL     8547<>CALL     8552<<ASSIGN
DS.CTX.NAME
      4239**DCL      8526<<ASSIGN
DS.CTX.PSWD
      4241**DCL      8527<<ASSIGN   8531<<ASSIGN
DS.CTX.SERVICE
      4245**DCL      8513<<ASSIGN   8646>>CALLBLT  8672>>CALLBLT
DS.CTX.SOCKET#
      4244**DCL      8576<<ASSIGN   8634>>IF       8652>>ASSIGN   8653<>CALL     8679>>ASSIGN   8680<>CALL
      8686<>CALL     8700<>CALL     8702<>CALL     8704>>ASSIGN   8705>>ASSIGN   8706>>ASSIGN   8736<>CALL
      8739<>CALL     8741>>ASSIGN   8742<>CALL     8743<>CALL     8744>>ASSIGN   8748>>ASSIGN   8757>>ASSIGN
      8768<>CALL     8818>>ASSIGN   8819>>ASSIGN
DS.CTX.SYSID
      4242**DCL      8575<<ASSIGN   8634>>IF       8654<<ASSIGN   8681<<ASSIGN   8699>>IF       8703<<ASSIGN
      8756<<ASSIGN
DS.CTX.TYPE
      4247**DCL      8508<<ASSIGN   8522<<ASSIGN   8736<>CALL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:112  
DS.PTRS
      4230**DCL      8593--ASSIGN   8637--ASSIGN   8778--IF
DS.PTRS.OFFSET
      4234**DCL      8593<<ASSIGN   8661>>ASSIGN   8779>>IF       8780<<ASSIGN   8780>>ASSIGN   8782>>ASSIGN
      8790>>ASSIGN
DS.PTRS.SYSID
      4233**DCL      8451>>ASSIGN   8452<<ASSIGN   8465>>ASSIGN   8467<<ASSIGN   8484<<ASSIGN   8612>>IF
      8612>>IF       8618>>IF       8619>>IF       8620<<ASSIGN   8661<<ASSIGN   8798<<ASSIGN
ERRMSG_KILL
      8639**LABEL    8695--GOTO
F$DCB.ACCT#
       117**DCL      8435--ASSIGN
F$DCB.ACTPOS
       133**DCL       133--REDEF
F$DCB.ARS#
       107**DCL       107--REDEF    8499>>ASSIGN
F$DCB.ATTR
       126**DCL       127--REDEF
F$DCB.BORROW
       141**DCL       141--REDEF     141--REDEF     141--REDEF
F$DCB.DCBNAME.L
       155**DCL       155--IMP-SIZ
F$DCB.EOMCHAR#
       111**DCL       111--REDEF
F$DCB.FCD#
       120**DCL      8580>>IF
F$DCB.FLDID
       136**DCL       136--REDEF
F$DCB.FORM$
       130**DCL       130--REDEF
F$DCB.FSECT
       146**DCL       146--REDEF
F$DCB.FSN#
       123**DCL       123--REDEF     123--REDEF     124--REDEF
F$DCB.HEADER$
       129**DCL       129--REDEF
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:113  
F$DCB.IXTNSIZE#
       127**DCL       127--REDEF
F$DCB.LASTSTA$
       116**DCL       116--REDEF
F$DCB.LVL
       142**DCL       142--REDEF
F$DCB.NAME#
       117**DCL      8434--ASSIGN
F$DCB.NAME#.C
       117**DCL       117--REDEF    8446>>CALLBLT
F$DCB.NOEOF
       139**DCL       139--REDEF
F$DCB.NRECS#
       128**DCL       128--REDEF
F$DCB.NRECX
       147**DCL       147--REDEF
F$DCB.OHDR
       139**DCL       139--REDEF
F$DCB.ORG#
       122**DCL       122--REDEF
F$DCB.PRECNO
       145**DCL       145--REDEF
F$DCB.PSN#
       117**DCL      8706>>ASSIGN   8748>>ASSIGN
F$DCB.RCSZ
       151**DCL       151--REDEF
F$DCB.RES#
       118**DCL       118--REDEF
F$DCB.SETX
       130**DCL       130--REDEF
F$DCB.TAB$
       130**DCL       130--REDEF
F$DCB.TDA
       144**DCL       145--REDEF
F$DCB.TYC.EOF#
       108**DCL      8495>>IF
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:114  
F$DCB.WSN#
       118**DCL       118--REDEF
FDS
      4708**DCL      8469<>CALL     8622<>CALL
FIND_ONE IN PROCEDURE GET_INETD
      8777**LABEL    8794--EXIT
FMSEC_PRIV
      1936**DCL      8433<>CALL     8464<>CALL     8475<>CALL
FMSEC_PRIV.V
      1936**DCL      1936--DCLINIT
FMTIT
      8468**LABEL    8605--GOTO     8626--GOTO     8628--GOTO
FPT_ERRMSG
      2162**DCL      8573<>CALL     8589<>CALL     8643<>CALL
FPT_ERRMSG.V
      2166**DCL      2162--DCLINIT
FPT_ERRMSG.V.SOURCE#
      2173**DCL      8571<<ASSIGN   8574>>IF       8579<<ASSIGN   8642<<ASSIGN   8644<<ASSIGN
FPT_EXTEND
      1904**DCL      8450<>CALL     8463<>CALL     8479<>CALL     8560<>CALL     8784<>CALL
FPT_EXTEND.V
      1904**DCL      1904--DCLINIT
FPT_GDS
      2189**DCL      8476<>CALL
FPT_GDS.V
      2189**DCL      2189--DCLINIT
FPT_GJOB
      1952**DCL      8638<>CALL
FPT_GJOB.V
      1954**DCL      1952--DCLINIT
FPT_KEYIN
      2078**DCL      8603<>CALL     8651<>CALL     8678<>CALL     8717<>CALL     8760<>CALL
FPT_KEYIN.MESS_
      2078**DCL      8602<<ASSIGN   8650<<ASSIGN   8677<<ASSIGN   8716<<ASSIGN   8759<<ASSIGN
FPT_KEYIN.V
      2081**DCL      2078--DCLINIT
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:115  
FPT_LDTRC
      2207**DCL      8471<>CALL
FPT_LDTRC.ACCT_
      2207**DCL      8435<<ASSIGN
FPT_LDTRC.CMD_
      2208**DCL      8436<<ASSIGN
FPT_LDTRC.NAME_
      2207**DCL      8434<<ASSIGN
FPT_LDTRC.V
      2209**DCL      2209--DCLINIT
FPT_READ
      1871**DCL      8494<>CALL
FPT_READ.STATION_
      1874**DCL      1875--REDEF
FPT_READ.V
      1875**DCL      1871--DCLINIT
FPT_READ.V.DVBYTE.REREAD#
      1886**DCL      1886--REDEF
FPT_READ.V.INDX#
      1884**DCL      1884--REDEF
FPT_STATE
      1907**DCL      8454<>CALL     8457<>CALL     8466<>CALL     8667<>CALL     8793<>CALL
FPT_TIME
      2111**DCL      8727<>CALL
FPT_TIME.V
      2115**DCL      2111--DCLINIT
FPT_WAIT.V
      2098**DCL      2097--DCLINIT
FPT_WRITE
      2136**DCL      8442<>CALL     8502<>CALL     8539<>CALL     8601<>CALL     8649<>CALL     8676<>CALL
      8715<>CALL     8730<>CALL     8755<>CALL
FPT_WRITE.BUF_
      2136**DCL      8602>>ASSIGN   8650>>ASSIGN   8677>>ASSIGN   8716>>ASSIGN   8759>>ASSIGN
FPT_WRITE.BUF_.BOUND
      2136**DCL      8441<<ASSIGN   8500<<ASSIGN   8600<<ASSIGN   8648<<ASSIGN   8675<<ASSIGN   8714<<ASSIGN
      8729<<ASSIGN   8754<<ASSIGN
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:116  
FPT_WRITE.STATION_
      2138**DCL      2138--REDEF
FPT_WRITE.V
      2139**DCL      2136--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      2145**DCL      2145--REDEF
GET_INETD
      8774**PROC     8635--CALL
I
      8421**DCL      8437<<CALLBLT  8438<<CALLBLT  8509<<DOINDEX  8510>>DOCASE   8512>>ASSIGN   8515>>CALLBLT
      8515>>CALLBLT  8520>>ASSIGN   8522>>ASSIGN   8524>>ASSIGN   8533>>IF       8534>>ASSIGN   8540>>IF
      8607<<ASSIGN   8608<<ASSIGN   8609<<ASSIGN   8611<>CALL     8611<>CALL     8627>>IF       8653<>CALL
      8680<>CALL     8686<>CALL     8700<>CALL     8702<>CALL     8708<<CALLBLT  8709>>IF       8711>>ASSIGN
      8711>>ASSIGN   8739<>CALL     8742<>CALL     8743<>CALL     8750<<CALLBLT  8758>>IF       8767<<ASSIGN
      8768>>IF       8769>>ASSIGN   8776<<ASSIGN   8778>>IF       8779>>IF       8780>>ASSIGN   8780>>ASSIGN
      8782>>ASSIGN   8790>>ASSIGN   8796<<ASSIGN   8796>>ASSIGN   8798>>ASSIGN   8799<<ASSIGN   8800>>IF
      8801>>ASSIGN   8803<<ASSIGN   8803>>ASSIGN   8805>>IF       8806<<ASSIGN   8806>>ASSIGN   8808>>ASSIGN
INETD
      4071**DCL      8487--ASSIGN   8593--ASSIGN   8661--ASSIGN   8686<>CALL     8780--ASSIGN   8812<<ASSIGN
INETD.CTX#
      4082**DCL      8799>>ASSIGN   8814<<ASSIGN
INETD.ERRNO
      4086**DCL      8691>>IF       8692>>IF       8693>>ASSIGN   8694>>ASSIGN
INETD.FPT_RUE.EVENT
      4080**DCL      8815<<ASSIGN
INETD.FPT_RUE.STATE
      4081**DCL      8665>>IF       8684>>IF       8791>>IF
INETD.FPT_RUE.SYSID
      4079**DCL      8636>>IF       8660<<ASSIGN   8666>>ASSIGN   8792>>ASSIGN   8816--ASSIGN
INETD.FPT_RUE.V_
      4078**DCL      8816<<ASSIGN
INETD.INETD#
      4083**DCL      8697>>ASSIGN   8801>>ASSIGN   8805>>IF       8806>>ASSIGN   8808<<ASSIGN   8808>>ASSIGN
      8813<<ASSIGN
INETD.NAME
      4107**DCL      8818<<ASSIGN
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:117  
INETD.SERNUM
      4085**DCL      8819<<ASSIGN
INETD#.OFFSET
      8414**DCL      8633<<ASSIGN   8635>>IF       8661>>ASSIGN   8697<<ASSIGN   8782<<ASSIGN   8790<<ASSIGN
      8800>>IF       8805>>IF       8817>>ASSIGN
INETD$
      8413**DCL      4071--IMP-PTR  8414--REDEF    8631<<ASSIGN   8636>>IF       8660>>ASSIGN   8665>>IF
      8666>>ASSIGN   8684>>IF       8686>>CALL     8691>>IF       8692>>IF       8693>>ASSIGN   8694>>ASSIGN
      8697>>ASSIGN   8783>>IF       8791>>IF       8792>>ASSIGN   8799>>ASSIGN   8801>>ASSIGN   8808>>ASSIGN
      8812>>ASSIGN   8813>>ASSIGN   8814>>ASSIGN   8815>>ASSIGN   8816>>ASSIGN   8816>>ASSIGN   8818>>ASSIGN
      8819>>ASSIGN
INETD_INIT
      4151**DCL      8812>>ASSIGN
INETD_INIT.FPT_RUE.V_
      4158**DCL      4158--DCLINIT
INETD_QUIT
      8598**LABEL    8616--GOTO
KILL_SERVICE
      8669**LABEL    8655--CALLALT  8658--GOTO     8702--CALLALT
LB
      8430**DCL      8437>>CALLBLT
M$CLOSE
        28**DCL-ENT  8585--CALL     8623--CALL
M$DS.ACTPOS
      1816**DCL      1816--REDEF
M$DS.ARS#
      1775**DCL      1775--REDEF
M$DS.ATTR#
      1805**DCL      1805--REDEF    1807--REDEF
M$DS.BORROW
      1827**DCL      1827--REDEF    1827--REDEF    1827--REDEF
M$DS.DCBNAME.L
      1846**DCL      1846--IMP-SIZ
M$DS.EOMCHAR#
      1782**DCL      1783--REDEF
M$DS.FLDID
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:118  
      1819**DCL      1820--REDEF
M$DS.FORM$
      1811**DCL      1811--REDEF
M$DS.FSECT
      1834**DCL      1834--REDEF
M$DS.FSN#
      1801**DCL      1801--REDEF    1801--REDEF    1802--REDEF
M$DS.HEADER$
      1810**DCL      1811--REDEF
M$DS.IXTNSIZE#
      1807**DCL      1808--REDEF
M$DS.LASTSTA$
      1791**DCL      1791--REDEF
M$DS.LVL
      1828**DCL      1828--REDEF
M$DS.NAME#.C
      1791**DCL      1792--REDEF
M$DS.NOEOF
      1823**DCL      1823--REDEF
M$DS.NRECS#
      1808**DCL      1808--REDEF
M$DS.NRECX
      1835**DCL      1835--REDEF
M$DS.OHDR
      1824**DCL      1824--REDEF
M$DS.ORG#
      1799**DCL      1800--REDEF
M$DS.PRECNO
      1832**DCL      1832--REDEF
M$DS.RCSZ
      1840**DCL      1840--REDEF
M$DS.RES#
      1793**DCL      1793--REDEF
M$DS.SETX
      1812**DCL      1812--REDEF
M$DS.TAB$
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:119  
      1811**DCL      1811--REDEF
M$DS.TDA
      1831**DCL      1832--REDEF
M$DS.WSN#
      1793**DCL      1794--REDEF
M$ERRMSG
        91**DCL-ENT  8573--CALL     8589--CALL     8643--CALL
M$EXIT
        40**DCL-ENT  8443--CALL     8587--CALL
M$EXTEND
        32**DCL-ENT  8560--CALL     8784--CALL
M$GDS
        63**DCL-ENT  8476--CALL
M$GJOB
        93**DCL-ENT  8638--CALL
M$KEYIN
        33**DCL-ENT  8603--CALL     8651--CALL     8678--CALL     8717--CALL     8760--CALL
M$LDEV
        28**DCL-ENT  8624--CALL
M$LDTRC
        41**DCL-ENT  8471--CALL
M$LM
      1852**DCL      8434--ASSIGN   8435--ASSIGN
M$READ
        29**DCL-ENT  8494--CALL
M$REW
        31**DCL-ENT  8450--CALL     8463--CALL     8479--CALL
M$RPRIV
        87**DCL-ENT  8464--CALL     8475--CALL
M$RUE
        94**DCL-ENT  8457--CALL
M$SI
      1700**DCL      8446--CALLBLT  8495--IF       8499--ASSIGN   8580--IF
M$SI.ACTPOS
      1741**DCL      1741--REDEF
M$SI.ARS#
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:120  
      1700**DCL      1700--REDEF
M$SI.ATTR#
      1730**DCL      1730--REDEF    1732--REDEF
M$SI.BORROW
      1752**DCL      1752--REDEF    1752--REDEF    1752--REDEF
M$SI.DCBNAME.L
      1771**DCL      1771--IMP-SIZ  8446>>CALLBLT  8495>>IF       8499>>ASSIGN   8580>>IF
M$SI.EOMCHAR#
      1707**DCL      1708--REDEF
M$SI.FLDID
      1744**DCL      1745--REDEF
M$SI.FORM$
      1736**DCL      1736--REDEF
M$SI.FSECT
      1759**DCL      1759--REDEF
M$SI.FSN#
      1726**DCL      1726--REDEF    1726--REDEF    1727--REDEF
M$SI.HEADER$
      1735**DCL      1736--REDEF
M$SI.IXTNSIZE#
      1732**DCL      1733--REDEF
M$SI.LASTSTA$
      1716**DCL      1716--REDEF
M$SI.LVL
      1753**DCL      1753--REDEF
M$SI.NAME#.C
      1716**DCL      1717--REDEF
M$SI.NOEOF
      1748**DCL      1748--REDEF
M$SI.NRECS#
      1733**DCL      1733--REDEF
M$SI.NRECX
      1760**DCL      1760--REDEF
M$SI.OHDR
      1749**DCL      1749--REDEF
M$SI.ORG#
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:121  
      1724**DCL      1725--REDEF
M$SI.PRECNO
      1757**DCL      1757--REDEF
M$SI.RCSZ
      1765**DCL      1765--REDEF
M$SI.RES#
      1718**DCL      1718--REDEF
M$SI.SETX
      1737**DCL      1737--REDEF
M$SI.TAB$
      1736**DCL      1736--REDEF
M$SI.TDA
      1756**DCL      1757--REDEF
M$SI.WSN#
      1718**DCL      1719--REDEF
M$SPRIV
        87**DCL-ENT  8433--CALL     8449--CALL     8588--CALL
M$STATE
        96**DCL-ENT  8454--CALL     8466--CALL     8667--CALL     8793--CALL
M$TIME
        95**DCL-ENT  8727--CALL
M$WRITE
        29**DCL-ENT  8442--CALL     8502--CALL     8539--CALL     8601--CALL     8649--CALL     8676--CALL
      8715--CALL     8730--CALL     8755--CALL
M$XXX
        40**DCL-ENT  8590--CALL
MAXCTX$
      8415**DCL      8486<<ASSIGN   8487>>ASSIGN   8559>>IF       8561<<ASSIGN   8561>>ASSIGN   8586<<ASSIGN
      8632>>DOUNTIL
MAXINETD$
      8420**DCL      8487<<ASSIGN   8562<<ASSIGN   8562>>ASSIGN   8783>>IF       8785<<ASSIGN   8785>>ASSIGN
MONABRT
      8589**LABEL    8471--CALLALT
MONERR
      8570**LABEL    8449--CALLALT  8450--CALLALT  8457--CALLALT  8463--CALLALT  8476--CALLALT  8479--CALLALT
      8489--CALLALT  8497--GOTO
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:122  
NEW_ENTRY IN PROCEDURE GET_INETD
      8808**LABEL    8787--GOTO
NEXT_CTX
      8554**LABEL    8577--GOTO
NEXT_LINE
      8564**LABEL    8540--GOTO     8554--GOTO
NO_BIND IN PROCEDURE OPEN_CTX
      8762**LABEL    8747--GOTO
NO_LISTEN IN PROCEDURE OPEN_CTX
      8762**LABEL    8743--CALLALT
NO_SETSOCKOPT IN PROCEDURE OPEN_CTX
      8762**LABEL    8739--CALLALT
NO_SOCKET IN PROCEDURE OPEN_CTX
      8769**LABEL    8736--CALLALT
OPEN_CTX
      8733**PROC     8555--CALL     8655--CALL
P$OUT.CODE
      8301**DCL      8510>>DOCASE   8522>>ASSIGN
P$OUT.CPOS
      8319**DCL      8534>>ASSIGN
P$OUT.NSUBLKS
      8305**DCL      8509>>DOINDEX  8528>>IF
P$OUT.SUBLK$
      8326**DCL      8510>>DOCASE   8512>>ASSIGN   8512>>ASSIGN   8515>>CALLBLT  8515>>CALLBLT  8515>>CALLBLT
      8515>>CALLBLT  8520>>ASSIGN   8520>>ASSIGN   8522>>ASSIGN   8522>>ASSIGN   8524>>ASSIGN   8525>>ASSIGN
      8525>>ASSIGN   8526>>ASSIGN   8529>>ASSIGN   8529>>ASSIGN   8531>>ASSIGN   8531>>ASSIGN   8533>>IF
      8533>>IF       8534>>ASSIGN
P$OUT$
      8419**DCL      8517<>CALL     8518>>ASSIGN   8524<<ASSIGN   8525>>ASSIGN   8525>>ASSIGN   8526>>ASSIGN
      8528>>IF       8529>>ASSIGN   8529>>ASSIGN   8531>>ASSIGN   8531>>ASSIGN
P$SYM.CODE
      8345**DCL      8533>>IF
P$SYM.COUNT
      8362**DCL      8365--IMP-SIZ  8513>>ASSIGN   8515>>CALLBLT  8525>>ASSIGN   8529>>ASSIGN   8531>>ASSIGN
      8546>>CALLBLT  8550<>CALL
P$SYM.CPOS
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:123  
      8354**DCL      8529>>ASSIGN
P$SYM.NDTYPE
      8342**DCL      8545>>IF
P$SYM.TEXT
      8365**DCL      8513>>ASSIGN   8515>>CALLBLT  8525>>ASSIGN   8531>>ASSIGN   8546>>CALLBLT
P$SYM.TEXTC$
      8357**DCL      8520>>ASSIGN   8526>>ASSIGN
PARSE_ERROR
      8571**LABEL    8503--GOTO
PRINT_IT
      2054**DCL      8624<>CALL
PRINT_IT.V
      2056**DCL      2054--DCLINIT
PROTO$
      8418**DCL      8520<<ASSIGN   8550>>CALL
P_PCB
      8106**DCL      8501<>CALL
P_PCB.ERROR
      8210**DCL      2162--DCLINIT  8569<<ASSIGN   8576>>ASSIGN   8639<<ASSIGN   8693<<ASSIGN   8694<<ASSIGN
P_PCB.ERROR.CODE
      8218**DCL      8645>>IF
P_PCB.NCHARS
      8253**DCL      8499<<ASSIGN   8500>>ASSIGN
P_PCB.OUT$
      8119**DCL      8293--IMP-PTR  8509>>DOINDEX  8510>>DOCASE   8512>>ASSIGN   8515>>CALLBLT  8515>>CALLBLT
      8520>>ASSIGN   8522>>ASSIGN   8524>>ASSIGN   8533>>IF       8534>>ASSIGN
RB
      8429**DCL      8438>>CALLBLT
SELECT_MASK
      8409**DCL      8596>>IF       8610>>ASSIGN   8652<<ASSIGN   8679<<ASSIGN   8705<<ASSIGN   8744<<ASSIGN
SELECT_RESULT
      8422**DCL      8607>>IF       8610<<ASSIGN   8611<>CALL     8618>>IF       8627>>IF       8634>>IF
SERV$
      8417**DCL      8512<<ASSIGN   8513>>ASSIGN   8513>>ASSIGN   8541>>IF       8545>>IF       8546>>CALLBLT
      8546>>CALLBLT  8550<>CALL     8550>>CALL     8552>>ASSIGN
SRVR_COUNT
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:124  
      8416**DCL      8470>>IF       8480<<ASSIGN   8554>>IF       8564<<ASSIGN   8564>>ASSIGN   8587>>IF
      8604<<ASSIGN   8611<>CALL
STT_FMT
      4810**DCL      8469--CALL     8622--CALL
SYNTXERR
      8436**LABEL    8437--GOTO
SYS_PRIV
      1921**DCL      8449<>CALL     8588<>CALL
SYS_PRIV.V
      1921**DCL      1921--DCLINIT
S_BLK
      8389**DCL      8637--ASSIGN
S_BLK.ARRAY
      8391**DCL      1908--DCLINIT  1909--DCLINIT  8451<<ASSIGN   8453<<ASSIGN   8453>>ASSIGN   8455>>IF
      8456<<ASSIGN   8456>>ASSIGN   8465<<ASSIGN   8467>>IF       8666<<ASSIGN   8668>>IF       8792<<ASSIGN
      8794>>IF
S_BLK.BUF
      8390**DCL      1873--DCLINIT  1874--DCLINIT  1953--DCLINIT  2137--DCLINIT  2138--DCLINIT  2163--DCLINIT
      4726--DCLINIT  4728--DCLINIT  8107--DCLINIT  8253--DCLINIT  8391--REDEF    8392--REDEF    8440<<CALLBLT
      8446<<CALLBLT  8448>>IF       8448>>IF       8452>>ASSIGN   8462>>IF       8493<<ASSIGN   8529<<ASSIGN
      8534>>ASSIGN   8598<<ASSIGN   8615<<ASSIGN   8646<<CALLBLT  8672<<CALLBLT  8713<<CALLBLT  8726<<ASSIGN
      8753<<CALLBLT
S_BLK.TSTAMP.DATE
      8394**DCL      2111--DCLINIT  2112--DCLINIT
S_BLK.TSTAMP.T.TRAIL
      8398**DCL      8728<<ASSIGN
S_BLK.TSTAMP.TIME
      8395**DCL      2113--DCLINIT  2114--DCLINIT  8396--REDEF
S_BLK.WORK
      8400**DCL      8115--DCLINIT  8136--DCLINIT
S_BLK.WORK.ACCT
      8401**DCL      1952--DCLINIT  2189--DCLINIT  8402--REDEF    8403--REDEF
S_BLK.WORK.DSCR_
      8402**DCL      8468<<ASSIGN   8482<<ASSIGN   8486>>ASSIGN   8621<<ASSIGN
S_BLK.WORK.DSZ.B
      8404**DCL      1850--IMP-SIZ  8469>>CALL     8483>>ASSIGN   8622>>CALL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:125  
S_BLK.WORK.NAME
      8405**DCL      1953--DCLINIT
S_BLK.WORK.PSWD
      8406**DCL      1953--DCLINIT
S_BLK.WORK.SYSID
      8407**DCL      1954--DCLINIT  8660>>ASSIGN   8661>>ASSIGN
TCI_CMD
      8387**DCL      8111--DCLINIT
TCI_SOCKINIT
      3637**DCL      8489<>CALL
TSTAMP
      8725**PROC     8488--CALL     8597--CALL     8614--CALL     8641--CALL     8670--CALL     8710--CALL
WAIT_A_BIT
      8716**LABEL    8635--CALLALT  8656--GOTO     8668--GOTO     8682--GOTO     8688--GOTO
WAIT_MASK
      8425**DCL      8596>>IF       8608>>IF       8704<<ASSIGN   8757<<ASSIGN
WAIT_NETS
      8426**DCL      8708>>CALLBLT  8711<<ASSIGN   8711>>ASSIGN   8750>>CALLBLT  8751<<ASSIGN   8752--IF
WAIT_NETSZ
      8427**DCL      8709>>IF       8712<<ASSIGN   8712>>ASSIGN   8751>>ASSIGN   8752>>IF       8752<<ASSIGN
      8752>>ASSIGN   8758>>IF
WAIT_SN
      8428**DCL      8706<<ASSIGN   8708>>CALLBLT  8713>>CALLBLT  8734<<ASSIGN   8738>>ASSIGN   8748<<ASSIGN
      8750>>CALLBLT  8751>>ASSIGN   8753>>CALLBLT
X$PARSE
      8371**DCL-ENT  8501--CALL
X$WRITE
      4693**DCL-ENT  8469--CALL     8622--CALL
XSL$GETHOSTBYNAME
      8376**DCL-ENT  8517--CALL
XSL$GETSERVBYNAME
      8377**DCL-ENT  8550--CALL
XSL$HOSTENT.H_ADDR_LIST$
      3524**DCL      8518>>ASSIGN
XSL$HTONL
      8383**DCL-ENT  8547--CALL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:126  
XSL$QACCEPT_INETD
      8372**DCL-ENT  8686--CALL
XSL$QBIND
      8373**DCL-ENT  8700--CALL     8742--CALL
XSL$QCLOSE
      8374**DCL-ENT  8653--CALL     8680--CALL     8768--CALL
XSL$QLISTEN
      8378**DCL-ENT  8702--CALL     8743--CALL
XSL$QSELECT
      8379**DCL-ENT  8611--CALL
XSL$QSETSOCKOPT
      8380**DCL-ENT  8739--CALL
XSL$QSOCKET
      8381**DCL-ENT  8736--CALL
XSL$SERVENT.S_PORT
      3611**DCL      8552>>ASSIGN
XSL$SOCKHD.SOCK$
      4343**DCL      8706>>ASSIGN   8741>>ASSIGN   8748>>ASSIGN   8818>>ASSIGN   8819>>ASSIGN
XSL$SOCKINFO.DCB#
      4398**DCL      8706--ASSIGN   8748--ASSIGN
XSL$SOCKINFO.NBACCEPT_SOCK$
      4487**DCL      4488--REDEF
XSL$SOCKINFO.SERNUM
      4397**DCL      8819>>ASSIGN
XSL$SOCKINFO.SOCKNAME
      4418**DCL      8741<<ASSIGN   8818>>ASSIGN
XSL$SOCKINIT
      8382**DCL-ENT  8489--CALL
XSL_ERRNO
      8385**DCL      8542<<ASSIGN   8569>>ASSIGN   8570>>IF       8628>>IF       8747>>IF       8767>>ASSIGN
      8769<<ASSIGN
XSL_SN
      4346**DCL      8734>>ASSIGN   8735<<ASSIGN   8738<<ASSIGN
XSL_SOCK$$
      4345**DCL      4329--IMP-PTR  8706>>ASSIGN   8741>>ASSIGN   8748>>ASSIGN   8818>>ASSIGN   8819>>ASSIGN
ZAPDS
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:127  
      1850**DCL      8469--CALL     8483<<ASSIGN   8622--CALL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:128  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:129  
              MINI UREF LISTING

B_POINTER    1334**DCL-ENT
M$ACCT      45**DCL-ENT
M$ACTIVATE      48**DCL-ENT
M$ALIB      41**DCL-ENT
M$ASUSER      43**DCL-ENT
M$ATTACH      50**DCL-ENT
M$BADPP      68**DCL-ENT
M$CGCTL      49**DCL-ENT
M$CGINFO      49**DCL-ENT
M$CHECK      30**DCL-ENT
M$CHGUNIT      88**DCL-ENT
M$CLRSTK      86**DCL-ENT
M$CMDVAR      97**DCL-ENT
M$CONFIG      58**DCL-ENT
M$CORRES      33**DCL-ENT
M$CPEXIT      42**DCL-ENT
M$CVM      66**DCL-ENT
M$CVOL      31**DCL-ENT
M$DCLFLD      58**DCL-ENT
M$DEACTIVATE      48**DCL-ENT
M$DELREC      30**DCL-ENT
M$DEQ      95**DCL-ENT
M$DETACH      50**DCL-ENT
M$DEVICE      32**DCL-ENT
M$DISPLAY      95**DCL-ENT
M$DISPRES      35**DCL-ENT
M$DLIB      41**DCL-ENT
M$DO    1851**DCL
M$DRIBBLE      58**DCL-ENT
M$DRTN      86**DCL-ENT
M$DSUSER      43**DCL-ENT
M$ENQ      94**DCL-ENT
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:130  
M$EOM      53**DCL-ENT
M$ERASE      59**DCL-ENT
M$ERR      40**DCL-ENT
M$EVENT      83**DCL-ENT
M$EXHUME      92**DCL-ENT
M$FDP      64**DCL-ENT
M$FDS      63**DCL-ENT
M$FEBOOT      56**DCL-ENT
M$FECTL      57**DCL-ENT
M$FEDUMP      56**DCL-ENT
M$FID      91**DCL-ENT
M$FINDPROC      45**DCL-ENT
M$FSUSER      43**DCL-ENT
M$FVP      65**DCL-ENT
M$FWCG      49**DCL-ENT
M$GBPL      69**DCL-ENT
M$GDDL      65**DCL-ENT
M$GDP      64**DCL-ENT
M$GETDCB      34**DCL-ENT
M$GETMOUSE      74**DCL-ENT
M$GETPM      75**DCL-ENT
M$GLINEATTR      53**DCL-ENT
M$GOODPP      68**DCL-ENT
M$GPLATEN      61**DCL-ENT
M$GPROMPT      60**DCL-ENT
M$GTRMATTR      54**DCL-ENT
M$GTRMCTL      52**DCL-ENT
M$GTRMTAB      55**DCL-ENT
M$GVP      64**DCL-ENT
M$HELP      91**DCL-ENT
M$INT      83**DCL-ENT
M$INTRTN      44**DCL-ENT
M$IOQ      79**DCL-ENT
M$JOBSTATS      93**DCL-ENT
M$LIMIT      34**DCL-ENT
M$LINES      33**DCL-ENT
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:131  
M$LINK      40**DCL-ENT
M$MADMUCK      36**DCL-ENT
M$MAKUSER      67**DCL-ENT
M$MBS      35**DCL-ENT
M$MDFFLD      59**DCL-ENT
M$MERC      84**DCL-ENT
M$MERCS      85**DCL-ENT
M$MIRROR      79**DCL-ENT
M$MONINFO      96**DCL-ENT
M$MPL      69**DCL-ENT
M$NODEINFO      60**DCL-ENT
M$NXTUSR      94**DCL-ENT
M$OCMSG      92**DCL-ENT
M$OLAY      40**DCL-ENT
M$OPEN      28**DCL-ENT
M$PAS      69**DCL-ENT
M$PATHCON      92**DCL-ENT
M$PDS      63**DCL-ENT
M$PFIL      30**DCL-ENT
M$PLATEN      54**DCL-ENT
M$PRECORD      32**DCL-ENT
M$PROCNAME      45**DCL-ENT
M$PROFILE      56**DCL-ENT
M$PROMPT      52**DCL-ENT
M$RACST      36**DCL-ENT
M$RDSYSLOG      77**DCL-ENT
M$RELDCB      34**DCL-ENT
M$RELRES      35**DCL-ENT
M$RELSTARF      37**DCL-ENT
M$REM      37**DCL-ENT
M$RENV      84**DCL-ENT
M$REQUIRE      36**DCL-ENT
M$RETRY      85**DCL-ENT
M$RETRYS      85**DCL-ENT
M$RLSFLD      59**DCL-ENT
M$RSPP      66**DCL-ENT
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:132  
M$RSWITCH      88**DCL-ENT
M$SAD      67**DCL-ENT
M$SAVE      43**DCL-ENT
M$SCON      44**DCL-ENT
M$SCREECH      42**DCL-ENT
M$SENV      84**DCL-ENT
M$SETFMA      28**DCL-ENT
M$SETFP      57**DCL-ENT
M$SINPUT      55**DCL-ENT
M$SLCFLD      60**DCL-ENT
M$SMOUSE      74**DCL-ENT
M$SMPRT      66**DCL-ENT
M$SSC      67**DCL-ENT
M$SSWITCH      87**DCL-ENT
M$STD      68**DCL-ENT
M$STIMER      82**DCL-ENT
M$STLPP      65**DCL-ENT
M$STRAP      82**DCL-ENT
M$STRMATTR      54**DCL-ENT
M$STRMCTL      52**DCL-ENT
M$STRMTAB      55**DCL-ENT
M$SYMBIO      93**DCL-ENT
M$SYSCON      79**DCL-ENT
M$SYSID      97**DCL-ENT
M$TDCLOSE      78**DCL-ENT
M$TDIO      78**DCL-ENT
M$TDOPEN      77**DCL-ENT
M$TDREQCPU      78**DCL-ENT
M$TEMPWROC      72**DCL-ENT
M$TRAP      82**DCL-ENT
M$TRMISC      57**DCL-ENT
M$TRMPRG      53**DCL-ENT
M$TRTN      86**DCL-ENT
M$TRUNC      29**DCL-ENT
M$TTIMER      82**DCL-ENT
M$UC      52**DCL
PL6.E3A0      #001=TCI$INETD File=TCI$INETD.:TCA2TSI                             SUN 11/16/97 14:14 Page:133  
M$UI    1853**DCL
M$UMPL      69**DCL-ENT
M$UNFID      91**DCL-ENT
M$UNLATCH      48**DCL-ENT
M$UNSHARE      45**DCL-ENT
M$USRFIELD      88**DCL-ENT
M$VIRTUAL      63**DCL-ENT
M$WAIT      86**DCL-ENT
M$WEOF      31**DCL-ENT
M$WRSYSLOG      77**DCL-ENT
M$XCON      83**DCL-ENT
M$XCONRTN      44**DCL-ENT
M$XEQTIME      96**DCL-ENT
M$XFLUSH      37**DCL-ENT
M$XMOUSE      74**DCL-ENT
M$YC      42**DCL-ENT
TCI$INETD      18**PROC
XSL$GETPROTOBYNAME    8375**DCL-ENT
XSL$PROTOENT    3543**DCL
