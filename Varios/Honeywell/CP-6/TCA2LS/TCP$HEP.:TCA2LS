VERSION A02

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:1    
        1        1        /*M* TCP$HEP - Routines to interface HEP-style code to XPS-style TCP-IP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        TCP$OPEN: PROC (PRM1, PRM2, PRM3, MODE, PRM5, PRM6) ALTRET;
        9        9
       10       10        %INCLUDE TCP_HEP_M;
       11       65        %INCLUDE XSL_INTERNAL_M;
       12      316        %INCLUDE XSL_SOCKET_M;
       13     1077        %INCLUDE XSL_SOCKET_E;
       14     1335        %INCLUDE XSL_PERR_C;
       15     1390    1   DCL XSL_ERRNO SBIN SYMREF;
       16     1391        %INCLUDE CP_6;
       17     1472        %INCLUDE B_ERRORS_C;
       18     2599    1   DCL PRM1 ALIGNED CHAR(RESULT);
       19     2600    1   DCL SOCKET REDEF PRM1 UBIN ALIGNED;
       20     2601        %VLP_NAME (FPTN=PRM1NAME, STCLASS=REDEF PRM1);
       21     2628    1   DCL PRM2 ALIGNED CHAR(RESULT);
       22     2629    1   DCL PRM2U REDEF PRM2 UBIN ALIGNED;
       23     2630        %VLP_NAME (FPTN=PRM2NAME, STCLASS=REDEF PRM2);
       24     2657        %TCP$SOCKET (NAME=PRM2_SOCK, STCLASS=REDEF PRM2);
       25     2665    1   DCL PRM2_VEC REDEF PRM2 VECTOR;
       26     2666    1   DCL PRM3 ALIGNED CHAR(RESULT);
       27     2667        %TCP$CB (NAME=PRM3_CB, STCLASS=REDEF PRM3);
       28     2670    1   DCL PUSH REDEF PRM3 BIT(1) ALIGNED;     /* TCP$WRITE                          */
       29     2671    1   DCL MODE UBIN;
       30     2672    1   DCL URGENT REDEF MODE SBIN;             /* TCP$WRITE                          */
       31     2673    1   DCL PRM5 UBIN;
       32     2674    1   DCL PRM6 UBIN;
       33     2675        %XSL$SOCKADDR (FPTN=LOCAL_SOCK, STCLASS=AUTO);
       34     2715        %XSL$SOCKADDR (FPTN=PEER_SOCK, STCLASS=AUTO);
       35     2755
       36     2756        %FPT_EVENT (STCLASS=CONSTANT, UENTRY=TCP$ASYNC);
       37     2770    1   DCL TCP$ASYNC ENTRY ASYNC;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:2    
       38     2771    1   DCL TCP_UENTRY UBIN STATIC SYMDEF INIT(0);
       39     2772    1   DCL TCP_BLKSIZE STATIC SYMDEF UBIN INIT(1600);
       40     2773    1   DCL TCP$ PTR;
       41     2774    1   DCL TCPBUF_ VECTOR STATIC INIT(VECTOR(NIL));
       42     2775    1   DCL 1 TCP_ REDEF TCPBUF_,
       43     2776    1          2 MAXSOCK SBIN,
       44     2777    1          2 P$$ PTR;
       45     2778    1   DCL 1 TCP_DAT BASED(TCP_.P$$) ALIGNED,
       46     2779    1          2 BLK$ PTR,
       47     2780    1          2 PTR$(0:0) PTR;
       48     2781    1   DCL 1 TCP$INFO BASED(TCP$) ALIGNED,
       49     2782    1          2 LISTEN BIT(1),
       50     2783    1          2 NOWAIT BIT(1),
       51     2784    1          2 RESET BIT(1),
       52     2785    1          2 PASSIVE BIT(1),
       53     2786    1          2 CLOSING BIT(1),
       54     2787    1          2 CONNECTED BIT(1),
       55     2788    1          2 * BIT(30),
       56     2789    1          2 BLK$ PTR,
       57     2790    1          2 BLKSIZ SBIN,
       58     2791    1          2 CB$ PTR,
       59     2792    1          2 ARS SBIN,
       60     2793    1          2 BUF$ PTR;
       61     2794
       62     2795        %TCP$CB (STCLASS=BASED);
       63     2798        %TCP$ADMIN (STCLASS=BASED);
       64     2819
       65     2820    1   DCL XSL$QSOCKET ENTRY(4) ALTRET;
       66     2821    1   DCL XSL$QBIND ENTRY(4) ALTRET;
       67     2822    1   DCL XSL$QLISTEN ENTRY(3) ALTRET;
       68     2823    1   DCL XSL$QACCEPT ENTRY(4) ALTRET;
       69     2824    1   DCL XSL$QACCEPT_SRVR ENTRY(3) ALTRET;
       70     2825    1   DCL XSL$QCLOSE ENTRY(2) ALTRET;
       71     2826    1   DCL XSL$QCONNECT ENTRY(4) ALTRET;
       72     2827    1   DCL XSL$QSEND ENTRY(5) ALTRET;
       73     2828    1   DCL XSL$QRECV ENTRY(5) ALTRET;
       74     2829    1   DCL XSL$QSELECT ENTRY(6) ALTRET;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:3    
       75     2830    1   DCL XSL$QSETSOCKOPT ENTRY(6) ALTRET;
       76     2831    1   DCL XSL$QSHUTDOWN ENTRY(3) ALTRET;
       77     2832    1   DCL XSL$GETHOSTNAME ENTRY(3) ALTRET;
       78     2833    1   DCL XSL$QGETPEERNAME ENTRY(4) ALTRET;
       79     2834    1   DCL XSL$QGETSOCKNAME ENTRY(4) ALTRET;
       80     2835    1   DCL XSL$QFCNTL ENTRY(4) ALTRET;
       81     2836    1   DCL XSL$HTONL ENTRY(2);
       82     2837    1   DCL XSL$HTONS ENTRY(2);
       83     2838    1   DCL XSL$NTOHL ENTRY(2);
       84     2839    1   DCL XSL$NTOHS ENTRY(2);
       85     2840    1   DCL XSL$INET_ADDR ENTRY(2) ALTRET;
       86     2841    1   DCL XSL$INET_NTOA ENTRY(2) ALTRET;
       87     2842    1   DCL XSL$GETHOSTBYADDR ENTRY(4) ALTRET;
       88     2843    1   DCL XSL$GETHOSTBYNAME ENTRY(2) ALTRET;
       89     2844        %XSL$HOSTENT;
       90     2904        %FPT_WAIT (FPTN=FPT_FOREVER, UNITS=999999, STCLASS=CONSTANT);
       91     2918        %FPT_WAIT (FPTN=WAIT1SEC, UNITS=1, STCLASS=CONSTANT);
       92     2932
       93     2933    1   DCL B$UBIN UBIN BASED;
       94     2934    1   DCL B$PTR PTR BASED;
       95     2935    1   DCL CHAR31 CHAR(31) BASED CALIGNED;
       96     2936    1   DCL I SBIN;
       97     2937    1   DCL P$ PTR;
       98     2938    1   DCL RESULT SBIN;
       99     2939    1   DCL FLAGS SBIN;
      100     2940    1   DCL FLAGBITS(0:35) REDEF FLAGS BIT(1) UNAL;
      101     2941    1   DCL 1 CBITS CONSTANT, 2 O(0:17) BIT(36) INIT(
      102     2942    1    '4'O,'2'O,'1'O,'04'O,'02'O,'01'O,'004'O,'002'O,'001'O,'0004'O,'0002'O,
      103     2943    1    '0001'O,'00004'O,'00002'O,'00001'O,'000004'O,'000002'O,'000001'O),
      104     2944    1          2 U(0:17) UBIN INIT(131073,65536,32768,16384,8192,4096,2048,1024,512,256,
      105     2945    1    128,64,32,16,8,4,2,1);
      106     2946    1   DCL BITS(0:35) REDEF CBITS BIT(36);
      107     2947
      108     2948    1   DCL B$TCB$ PTR SYMREF READONLY;
      109     2949        %B$TCB (STCLASS="BASED(B$TCB$)");
      110     2952        %B$ALT;
      111     2960
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:4    
      112     2961    1   DCL XSLERR_2_TCPERR CHAR(0) CONSTANT
      113     2962    1    INIT(%CONCAT(BINASC(E$FAILURE), BINASC(E$ACCES),
      114     2963         BINASC(E$ADDRINUSE), BINASC(E$ADDRNOTAVAIL), BINASC(E$AFNOSUPPORT),
      115     2964         BINASC(E$BADF), BINASC(E$DESTADDRREQ), BINASC(E$FAULT), BINASC(E$INTR),
      116     2965         BINASC(E$INVAL), BINASC(E$ISCONN), BINASC(E$MFILE), BINASC(E$MSGSIZE),
      117     2966         BINASC(E$NETUNREACH), BINASC(E$NOBUFFS), BINASC(E$NOENT),
      118     2967         BINASC(E$CONNREFUSED), BINASC(E$NETDOWN), BINASC(E$HOSTDOWN),
      119     2968         BINASC(E$HOSTUNREACH), BINASC(E$CONNABORTED), BINASC(E$NETRESET),
      120     2969         BINASC(E$INPROGRESS), BINASC(E$ALREADY), BINASC(E$PROTOTYPE),
      121     2970         BINASC(E$NAMETOOLONG), BINASC(E$NOPROTOOPT), BINASC(E$OPNOTSUPP),
      122     2971         BINASC(E$PFNOSUPPORT), BINASC(E$SOCKTNOSUPPORT), BINASC(E$TOOMANYREFS),
      123     2972         BINASC(E$LOOP), BINASC(E$SHUTDOWN),
      124     2973         BINASC(E$CONNRESET), BINASC(E$NOTCONN), BINASC(E$NOTSOCK),
      125     2974    1    BINASC(E$PERM), BINASC(E$TIMEDOUT), BINASC(E$WOULDBLOCK)));
      126     2975    1   DCL TCPERRS(0:42) SBIN CONSTANT INIT (-1, -1,
      127     2976    1    %E$TCP$DUP_CON*2, %E$TCP$BAD_PARM,
      128     2977    1    %E$TCP$LCN, %E$TCP$BAD_PARM, %(E$MTRAP*8+262144), %(E$BYDR*8+262144),
      129     2978    1    %E$TCP$BAD_PARM, %E$TCP$DUP_CON, %E$TCP$MAX_RESOURCES, %(E$LD*8+262144),
      130     2979    1    %E$TCP$NOT_ESTABLISHED, %E$TCP$MAX_RESOURCES*2,
      131     2980    1    %E$TCP$NOT_ESTABLISHED*3,
      132     2981    1    %E$TCP$NOT_ESTABLISHED, %E$TCP$RESET_RCVD*2,
      133     2982    1    %E$TCP$DUP_CON*2, %E$TCP$BAD_PARM,
      134     2983    1    %E$TCP$BAD_PARM*3,
      135     2984    1    %E$TCP$BAD_PARM*2, %E$TCP$MAX_RESOURCES,
      136     2985    1    %E$TCP$MAX_RESOURCES, %E$TCP$RESET_RCVD,
      137     2986    1    %E$TCP$RESET_RCVD, %E$TCP$NOT_ESTABLISHED, %E$TCP$LCN,
      138     2987    1    %E$TCP$BAD_PARM, %E$TCP$READ_TIMEOUT, 0, %E$TCP$RESET_RCVD);
      139     2988
      140     2989        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:5    
      141     2990    2      IF MODE ~= %TCP_SERVER_CLONE THEN DO;
      142     2991    2         CALL XSL$QSOCKET (SOCKET, %XSL_AF_INET, %XSL_SOCK_STREAM, %XSL_PF_INET)
      143     2992    2           ALTRET(NOSOCKET);
      144     2993    2         IF TCP_.P$$ = ADDR(NIL) THEN CALL TCPINIT ALTRET(ERRRET);
      145     2994    2         TCP$ = TCP_DAT.PTR$(SOCKET);
      146     2995    2         TCP$INFO = '0'B;
      147     2996    2         CALL HEPSOCK_2_XSLSOCK (LOCAL_SOCK, PRM2);
      148     2997    2         CALL HEPSOCK_2_XSLSOCK (PEER_SOCK, PRM3);
      149     2998    3         IF PRM2_SOCK.PORT~=0 OR PRM2_SOCK.ADDRESS~=0 OR MODE=%TCP_PASSIVE THEN DO;
      150     2999    3            CALL XSL$QSETSOCKOPT (RESULT, SOCKET, %XSL_SOL_SOCKET,
      151     3000    3              %XSL_SO_REUSEADDR, 262144, 2) ALTRET (ERRRET);
      152     3001    3            I = 60;
      153     3002    3   DOBIND:  CALL XSL$QBIND (RESULT, SOCKET, LOCAL_SOCK, 8)
      154     3003    4            WHENALTRETURN DO;
      155     3004    4               I = I - 1;
      156     3005    4               IF I <= 0 OR XSL_ERRNO ~= %E$ADDRINUSE THEN GOTO ERRRET;
      157     3006    4               CALL M$WAIT (WAIT1SEC);
      158     3007    4               GOTO DOBIND;
      159     3008    4            END;
      160     3009    3         END;
      161     3010    3         IF MODE=%TCP_ACTIVE THEN DO;
      162     3011    3            CALL XSL$QCONNECT (RESULT, SOCKET, PEER_SOCK, 8) ALTRET (ERRRET);
      163     3012    3            TCP$INFO.CONNECTED = '1'B;
      164     3013    3         END; ELSE DO;
      165     3014    3            IF MODE=%TCP_PASSIVE THEN TCP$INFO.PASSIVE = '1'B;
      166     3015    3            CALL XSL$QLISTEN (RESULT, SOCKET, 1) ALTRET (ERRRET);
      167     3016    3            TCP$INFO.LISTEN = '1'B;
      168     3017    3         END;
      169     3018    2      END; ELSE DO;
      170     3019    2         CALL XSL$QACCEPT_SRVR (SOCKET, PEER_SOCK, RESULT) ALTRET (ERRRET);
      171     3020    2         IF TCP_.P$$ = ADDR(NIL) THEN CALL TCPINIT ALTRET (ERRRET);
      172     3021    2         TCP$ = TCP_DAT.PTR$(SOCKET);
      173     3022    2         TCP$INFO = '0'B;
      174     3023    2         TCP$INFO.CONNECTED = '1'B;
      175     3024    2      END;
      176     3025        /* CALL XSL$QFCNTL (RESULT, SOCKET, 0) ALTRET (ERRRET); */
      177     3026    2      IF ADDR(PRM6)~=ADDR(NIL) THEN DO;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:6    
      178     3027    2         RESULT = 8;
      179     3028    2         CALL XSL$QGETSOCKNAME (RESULT, SOCKET, LOCAL_SOCK, RESULT);
      180     3029    2         CALL XSLSOCK_2_HEPSOCK (LOCAL_SOCK, PRM6);
      181     3030    2      END;
      182     3031    2      IF ADDR(PRM5)~=ADDR(NIL) THEN DO;
      183     3032    2         RESULT = 8;
      184     3033    2         CALL XSL$QGETPEERNAME (RESULT, SOCKET, PEER_SOCK, RESULT);
      185     3034    2         CALL XSLSOCK_2_HEPSOCK (PEER_SOCK, PRM5);
      186     3035    2      END;
      187     3036    1      RETURN;
      188     3037
      189     3038    1   NOSOCKET:;
      190     3039    1   ERRRET:;
      191     3040    1      CALL INDEX(RESULT, BINASC(XSL_ERRNO), XSLERR_2_TCPERR);
      192     3041    1      TCP_MON_ERR = '0'B;
      193     3042    1      TCP_ERR_CODE.ERR# = 0;
      194     3043    1      FLAGS = TCPERRS(RESULT);
      195     3044    1      IF FLAGS=-1
      196     3045    1      THEN TCP_MON_ERR = B$TCB.ALT$->B$ALT.ERR;
      197     3046    1      ELSE IF FLAGS>4000
      198     3047    1      THEN TCP_MON_ERR = FLAGBITS;
      199     3048    2      ELSE IF FLAGS=0 THEN DO;
      200     3049    2         IF TCP_.P$$=ADDR(NIL) OR SOCKET>TCP_.MAXSOCK THEN EXIT;
      201     3050    2         TCP_DAT.PTR$(SOCKET)->TCP$INFO.RESET = '1'B;
      202     3051    2         RETURN;
      203     3052    2      END;
      204     3053    2      ELSE DO;
      205     3054    2         TCP_ERR_CODE.ERR# = FLAGS;
      206     3055    2         TCP_MON_ERR = '302314'O|BINBIT(XSL_ERRNO,33);
      207     3056    2      END;
      208     3057    1      ALTRETURN;
      209     3058
      210     3059        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:7    
      211     3060    1   HEPSOCK_2_XSLSOCK: PROC (XSL_SOCK, HEP_SOCK);
      212     3061        %TCP$SOCKET (NAME=HEP_SOCK, STCLASS=PARAM);
      213     3069        %XSL$SOCKADDR_IN (FPTN=XSL_SOCK, STCLASS=PARAM);
      214     3133    2      XSL_SOCK.SA_FAMILY = %XSL_AF_INET;
      215     3134    2      XSL_SOCK.S_PORT = HEP_SOCK.ADDRESS;
      216     3135    2      CALL XSL$HTONL (XSL_SOCK.S_ADDR, XSL_SOCK.S_PORT);
      217     3136    2      XSL_SOCK.S_PORT = HEP_SOCK.PORT;
      218     3137    2      CALL XSL$HTONL( XSL_SOCK.S_PORT, XSL_SOCK.S_PORT);
      219     3138    2      RETURN;
      220     3139
      221     3140    2   XSLSOCK_2_HEPSOCK: ENTRY (XSL_SOCK, HEP_SOCK);
      222     3141    2      CALL XSL$NTOHL( XSL_SOCK.S_PORT, XSL_SOCK.S_PORT);
      223     3142    2      HEP_SOCK.PORT = XSL_SOCK.S_PORT;
      224     3143    2      CALL XSL$NTOHL (XSL_SOCK.S_PORT, XSL_SOCK.S_ADDR);
      225     3144    2      HEP_SOCK.ADDRESS = XSL_SOCK.S_PORT;
      226     3145    2   END HEPSOCK_2_XSLSOCK;
      227     3146        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:8    
      228     3147    1   TCPINIT: PROC ALTRET;
      229     3148        %FPT_GDS (SEGSIZE=1024,RESULTS=TCPBUF_,STCLASS=CONSTANT);
      230     3164        %XSL$SOCKHD (STCLASS="BASED(XSL_SOCK$$)");
      231     3197    2   DCL XSL_SOCK$$ PTR SYMREF;
      232     3198
      233     3199    2      VBASE(TCPBUF_) = XSL_SOCK$$;
      234     3200    3      DO UNTIL VBOUND(TCPBUF_) + 1 >= TCP_BLKSIZE +
      235     3201    3        4*(XSL$SOCKHD.SEGSIZE + XSL$SOCKHD.MAXSOCK*(1 + SIZEW(TCP$INFO)));
      236     3202    4         CALL M$GDS (FPT_GDS) WHENALTRETURN DO;
      237     3203    4            XSL_ERRNO = %E$FAILURE;
      238     3204    4            ALTRETURN;
      239     3205    4         END;
      240     3206    3      END;
      241     3207    2      TCP_.P$$ = PINCRW(XSL_SOCK$$,XSL$SOCKHD.SEGSIZE);
      242     3208    2      TCP_.MAXSOCK = XSL$SOCKHD.MAXSOCK;
      243     3209    3      DO RESULT=0 TO TCP_.MAXSOCK-1;
      244     3210    3         TCP_DAT.PTR$(RESULT) =
      245     3211    3           ADDR(TCP_DAT.PTR$(TCP_.MAXSOCK+RESULT*SIZEW(TCP$INFO)));
      246     3212    3         TCP_DAT.PTR$(RESULT)->TCP$INFO = '0'B;
      247     3213    3      END;
      248     3214    2      TCP_DAT.BLK$ = ADDR(TCP_DAT.PTR$(RESULT*(1+SIZEW(TCP$INFO))));
      249     3215    2   END TCPINIT;
      250     3216        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:9    
      251     3217    1   TCP$EVENT: ENTRY (PRM1) ALTRET;
      252     3218    1      TCP_UENTRY = SOCKET;
      253     3219    1      CALL M$EVENT (FPT_EVENT);
      254     3220    1      RETURN;
      255     3221
      256     3222    1   TCP$CLOSE: ENTRY (PRM1) ALTRET;
      257     3223    1      CALL TCP$WRITE (PRM1, VECTOR(NIL), '1'B); /* flush any buffered output     */
      258     3224    1      CALL XSL$QSHUTDOWN (RESULT, SOCKET, 1) ALTRET (ERRRET);
      259     3225    1      TCP_DAT.PTR$(SOCKET)->TCP$INFO.CLOSING = '1'B;
      260     3226    1      RETURN;
      261     3227
      262     3228    1   TCP$ABORT: ENTRY (PRM1) ALTRET;
      263     3229    1   TCP$RELEASE: ENTRY (PRM1) ALTRET;
      264     3230    1      CALL XSL$QCLOSE (RESULT, SOCKET) ALTRET (ERRRET);
      265     3231    1      RETURN;
      266     3232
      267     3233        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:10   
      268     3234    1   TCP$WRITE: ENTRY (PRM1, PRM2, PRM3, MODE) ALTRET;
      269     3235    1      IF TCP_.P$$=ADDR(NIL) OR SOCKET>=TCP_.MAXSOCK THEN GOTO NOTSOCK;
      270     3236    1      TCP$ = TCP_DAT.PTR$(SOCKET);
      271     3237    1      FLAGS = 0;
      272     3238    1      RESULT = VBOUND(PRM2_VEC)+1;
      273     3239    1      P$ = VBASE(PRM2_VEC);
      274     3240    1      IF P$=ADDR(NIL) THEN RESULT = 0;
      275     3241    1   MORE_BLK: ;
      276     3242    1      IF ADDR(URGENT)~=ADDR(NIL) THEN IF URGENT<0
      277     3243    1      THEN FLAGS = %XSL_MSG_OOB;
      278     3244    2      IF FLAGS=0 THEN DO;
      279     3245    2         IF TCP$INFO.BLKSIZ=0 THEN IF RESULT=0 THEN RETURN;
      280     3246    2         ELSE IF TCP_DAT.BLK$=ADDR(NIL) OR ADDR(PUSH)~=ADDR(NIL) AND PUSH
      281     3247    2         THEN EXIT;
      282     3248    3         ELSE DO;
      283     3249    3            TCP$INFO.BLK$ = TCP_DAT.BLK$;
      284     3250    3            TCP_DAT.BLK$ = ADDR(NIL);
      285     3251    3         END;
      286     3252    2         IF RESULT=0 THEN EXIT;
      287     3253    2         RESULT = MINIMUM (RESULT, TCP_BLKSIZE-TCP$INFO.BLKSIZ);
      288     3254    2         SUBSTR(TCP$INFO.BLK$->CHAR31,TCP$INFO.BLKSIZ,RESULT) =
      289     3255    2           SUBSTR(P$->CHAR31,0,RESULT);
      290     3256    2         TCP$INFO.BLKSIZ = TCP$INFO.BLKSIZ+RESULT;
      291     3257    2         P$ = PINCRC(P$,RESULT);
      292     3258    2         RESULT = VBOUND(PRM2_VEC)+1-POFFC(P$,VBASE(PRM2_VEC));
      293     3259    2         IF RESULT=0 AND (ADDR(PUSH)=ADDR(NIL) OR NOT PUSH) THEN RETURN;
      294     3260    2      END;
      295     3261    2      IF TCP$INFO.BLKSIZ=0 THEN DO;
      296     3262    2         TCP$INFO.BLK$ = P$;
      297     3263    2         TCP$INFO.BLKSIZ = RESULT;
      298     3264    2         RESULT = -1;
      299     3265    2      END;
      300     3266    1      ELSE FLAGS = 0;                      /* Send urgent data by itself         */
      301     3267    1      CALL XSL$QSEND (FLAGS, SOCKET,
      302     3268    1        TCP$INFO.BLK$->CHAR31, TCP$INFO.BLKSIZ, FLAGS);
      303     3269    1      TCP$INFO.BLKSIZ = 0;
      304     3270    1      IF TCP$INFO.BLK$~=P$ THEN TCP_DAT.BLK$ = TCP$INFO.BLK$;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:11   
      305     3271    1      TCP$INFO.BLK$ = ADDR(NIL);
      306     3272    1      IF FLAGS<0 THEN GOTO ERRRET;
      307     3273    1      IF RESULT>0 THEN GOTO MORE_BLK;
      308     3274    1      RETURN;
      309     3275
      310     3276    1   TCP$READ: ENTRY (PRM1, PRM2, PRM3) ALTRET;
      311     3277    1      IF TCP_.P$$=ADDR(NIL) OR SOCKET>=TCP_.MAXSOCK THEN GOTO NOTSOCK;
      312     3278    1      TCP$ = TCP_DAT.PTR$(SOCKET);
      313     3279    1      PRM3_CB.ADMIN = '1'B;
      314     3280    2      IF TCP$INFO.RESET THEN DO;
      315     3281    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSED;
      316     3282    2         RETURN;
      317     3283    2      END;
      318     3284    2      IF TCP$INFO.CLOSING THEN DO;
      319     3285    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSING;
      320     3286    2         RETURN;
      321     3287    2      END;
      322     3288    2      IF TCP$INFO.CONNECTED THEN DO;
      323     3289    2         TCP$INFO.CONNECTED = '0'B;
      324     3290    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_ESTABLISHED;
      325     3291    2         RETURN;
      326     3292    2      END;
      327     3293    2      IF TCP$INFO.LISTEN THEN DO;
      328     3294    2         RESULT = SOCKET;
      329     3295    2         CALL ACCEPT (PRM3_CB, VBASE(PRM2_VEC)->TCP$ADMIN) ALTRET (ERRRET);
      330     3296    3         IF TCP$INFO.PASSIVE THEN DO;
      331     3297    3            VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_ESTABLISHED;
      332     3298    3            TCP$INFO = '0'B;
      333     3299    3            CALL XSL$QCLOSE (RESULT, SOCKET);
      334     3300    3            SOCKET = VBASE(PRM2_VEC)->TCP$ADMIN.NEWLCN;
      335     3301    3         END;
      336     3302    2         RETURN;
      337     3303    2      END;
      338     3304    1      CALL XSL$QRECV (PRM3_CB.ARS, SOCKET,
      339     3305    2        VBASE(PRM2_VEC)->CHAR31, VBOUND(PRM2_VEC)+1, 0) WHENALTRETURN DO;
      340     3306    2         IF XSL_ERRNO ~= %E$CONNRESET THEN GOTO ERRRET;
      341     3307    2   ZERO_RESULT:
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:12   
      342     3308    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSE_WAIT;
      343     3309    2         TCP$INFO.RESET = '1'B;
      344     3310    2         RETURN;
      345     3311    2      END;
      346     3312    1      IF PRM3_CB.ARS = 0 THEN GOTO ZERO_RESULT;
      347     3313    1      PRM3_CB.ADMIN = '0'B;
      348     3314    1      RETURN;
      349     3315
      350     3316    1   TCP$READ_NW: ENTRY (PRM1, PRM2, PRM3) ALTRET;
      351     3317    2      IF TCP_.P$$=ADDR(NIL) OR SOCKET>TCP_.MAXSOCK THEN DO;
      352     3318    2   NOTSOCK:;
      353     3319    2         XSL_ERRNO = %E$NOTSOCK;
      354     3320    2         GOTO ERRRET;
      355     3321    2      END;
      356     3322    1      TCP$ = TCP_DAT.PTR$(SOCKET);
      357     3323    1      TCP$INFO.CB$ = ADDR(PRM3);
      358     3324    1      TCP$INFO.ARS = VBOUND(PRM2_VEC)+1;
      359     3325    1      TCP$INFO.BUF$ = VBASE(PRM2_VEC);
      360     3326    1      TCP$INFO.NOWAIT = '1'B;
      361     3327    1      RETURN;
      362     3328        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:13   
      363     3329    1   TCP$WAIT1: ENTRY (PRM1, PRM2) ALTRET;
      364     3330    1      FLAGS = 0;
      365     3331    2      IF TCP_.P$$=ADDR(NIL) THEN DO;
      366     3332    3         CALL M$WAIT (FPT_FOREVER) WHENALTRETURN DO; END;
      367     3333    2         RETURN;
      368     3334    2      END;
      369     3335    2      DO RESULT=0 TO TCP_.MAXSOCK-1;
      370     3336    3         IF TCP_DAT.PTR$(RESULT)->TCP$INFO.NOWAIT THEN DO;
      371     3337    3            FLAGBITS = FLAGBITS | BITS(RESULT);
      372     3338    3            TCP_DAT.PTR$(RESULT)->TCP$INFO.CB$->TCP$CB.READ_COMPLETE = '0'B;
      373     3339    3            TCP_DAT.PTR$(RESULT)->TCP$INFO.CB$->TCP$CB.ADMIN = '0'B;
      374     3340    3         END;
      375     3341    2      END;
      376     3342    1      RESULT = FLAGS;
      377     3343    1      CALL XSL$QSELECT (P$, TCP_.MAXSOCK, FLAGS, , RESULT, SOCKET);
      378     3344    1      FLAGBITS = FLAGBITS | BINBIT(RESULT,36);
      379     3345    2      DO RESULT=0 TO 35;
      380     3346    3         IF FLAGBITS & BITS(RESULT) THEN DO;
      381     3347    3            TCP$ = TCP_DAT.PTR$(RESULT);
      382     3348    4            IF TCP$INFO.LISTEN THEN DO;
      383     3349    4               CALL ACCEPT (TCP$INFO.CB$->TCP$CB, TCP$INFO.BUF$->TCP$ADMIN)
      384     3350    4                 ALTRET(WAIT_ERR);
      385     3351    4            END; ELSE DO;
      386     3352    4               CALL XSL$QRECV (TCP$INFO.CB$->TCP$CB.ARS, RESULT,
      387     3353    4                 TCP$INFO.BUF$->CHAR31, TCP$INFO.ARS, 0)
      388     3354    5               WHENRETURN DO;
      389     3355    5                  IF TCP$INFO.CB$->TCP$CB.ARS = 0 THEN GOTO WAIT_ERR;
      390     3356    5               END;
      391     3357    5               WHENALTRETURN DO;
      392     3358    5   WAIT_ERR:      ;
      393     3359    5                  TCP$INFO.CB$->TCP$CB.ADMIN = '1'B;
      394     3360    5                  TCP$INFO.BUF$->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSED;
      395     3361    5                  TCP$INFO.RESET = '1'B;
      396     3362    5                  IF XSL_ERRNO=%E$FAILURE
      397     3363    5                  THEN TCP_MON_ERR = B$TCB.ALT$->B$ALT.ERR;
      398     3364    5                  ELSE TCP_MON_ERR = '302314'O|BINBIT(XSL_ERRNO,33);
      399     3365    5               END;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:14   
      400     3366    4            END;
      401     3367    3            TCP$INFO.NOWAIT = '0'B;
      402     3368    3            TCP$INFO.CB$->TCP$CB.READ_COMPLETE = '1'B;
      403     3369    3         END;
      404     3370    2      END;
      405     3371    1      RETURN;
      406     3372
      407     3373        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:15   
      408     3374    1   ACCEPT: PROC (TCP_CB, TCP_ADMIN) ALTRET;
      409     3375        %TCP$CB (NAME=TCP_CB, STCLASS=);
      410     3378        %TCP$ADMIN (NAME=TCP_ADMIN, STCLASS=);
      411     3399
      412     3400    2      TCP_CB.ARS = 8;
      413     3401    2      CALL XSL$QACCEPT (TCP_ADMIN.NEWLCN, RESULT, PEER_SOCK, TCP_CB.ARS)
      414     3402    2        ALTRET (ERRRET);
      415     3403    2      CALL XSL$QGETSOCKNAME (P$, TCP_ADMIN.NEWLCN, LOCAL_SOCK, TCP_CB.ARS)
      416     3404    3      WHENALTRETURN DO;
      417     3405    3         CALL XSL$QCLOSE (RESULT, TCP_ADMIN.NEWLCN);
      418     3406    3   ERRRET: ;
      419     3407    3         ALTRETURN;
      420     3408    3      END;
      421     3409    2      TCP_DAT.PTR$(TCP_ADMIN.NEWLCN)->TCP$INFO = '0'B;
      422     3410    2      TCP_CB.ARS = SIZEC(TCP$ADMIN);
      423     3411    2      TCP_CB.ADMIN = '1'B;
      424     3412    2      TCP_ADMIN.CMD = %TCP_ADMINMSG_LISTEN_RESPONSE;
      425     3413    2      CALL XSLSOCK_2_HEPSOCK (PEER_SOCK, TCP_ADMIN.FS);
      426     3414    2      CALL XSLSOCK_2_HEPSOCK (LOCAL_SOCK, TCP_ADMIN.LS);
      427     3415    2      RETURN;
      428     3416    2   END ACCEPT;
      429     3417
      430     3418        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:16   
      431     3419    1   NET$IP2ADDR: ENTRY (PRM1, PRM2) ALTRET;
      432     3420    1      CALL XSL$INET_ADDR (RESULT, PRM2) ALTRET(ERRRET);
      433     3421    2      CALL XSL$INET_ADDR (RESULT, PRM2) WHENALTRETURN DO; ALTRETURN; END;
      434     3422    1      GOTO COMMON;
      435     3423    1   NET$IP2ADDRX: ENTRY (PRM1, PRM2) ALTRET;
      436     3424    1      RESULT = PRM2U;
      437     3425    1   COMMON:
      438     3426    1      CALL XSL$NTOHL (RESULT, RESULT);
      439     3427    1      SOCKET = RESULT*16;
      440     3428    1      RETURN;
      441     3429
      442     3430    1   NET$ADDR2NAME: ENTRY (PRM1, PRM2) ALTRET;
      443     3431    1      RESULT = PRM2U/16;
      444     3432    1      CALL XSL$HTONL(RESULT, RESULT);
      445     3433    1      CALL XSL$GETHOSTBYADDR (P$, RESULT, 4, %XSL_AF_INET) ALTRET(ERRRET);
      446     3434    1      P$ = P$->XSL$HOSTENT.H_NAME$;
      447     3435    1      CALL INDEX (RESULT, BINASC(0), P$->CHAR31);
      448     3436    1      PRM1NAME.L# = RESULT;
      449     3437    1      PRM1NAME.NAME# = P$->CHAR31;
      450     3438    1      RETURN;
      451     3439
      452     3440    1   NET$NAME2ADDR: ENTRY (PRM1, PRM2) ALTRET;
      453     3441    1      CALL XSL$GETHOSTBYNAME (P$, PRM2NAME) ALTRET(ERRRET);
      454     3442    1      CALL NET$IP2ADDRX (PRM1, P$->XSL$HOSTENT.H_ADDR_LIST$->B$PTR->B$UBIN);
      455     3443    1      RETURN;
      456     3444    1   END;
      457     3445        %EOD;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:17   
--  Include file information  --

   B_ERRORS_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   XSL_PERR_C.:TCA2TOU  is referenced.
   XSL_SOCKET_E.:TCA2TOU  is referenced.
   XSL_SOCKET_M.:TCA2TOU  is referenced.
   XSL_INTERNAL_M.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCP$OPEN.

   Procedure TCP$OPEN requires 1021 words for executable code.
   Procedure TCP$OPEN requires 38 words of local(AUTO) storage.

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:18   

 Object Unit name= TCP$OPEN                                   File name= TCP$HEP.:TCA2TOU
 UTS= NOV 16 '97 14:23:06.80 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    112    160  TCP$OPEN
    2   Data  even  none     4      4  TCP$OPEN
    3   Proc  even  none  1021   1775  TCP$OPEN
    4  RoData even  none    20     24  TCP$OPEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        6  TCP$OPEN
     3    573          yes     yes      Std        1  TCP$EVENT
     3    604          yes     yes      Std        1  TCP$CLOSE
     3    640          yes     yes      Std        1  TCP$ABORT
     3    643          yes     yes      Std        1  TCP$RELEASE
     3    656          yes     yes      Std        4  TCP$WRITE
     3   1072          yes     yes      Std        3  TCP$READ
     3   1256          yes     yes      Std        3  TCP$READ_NW
     3   1314          yes     yes      Std        2  TCP$WAIT1
     3   1625          yes     yes      Std        2  NET$IP2ADDR
     3   1652          yes     yes      Std        2  NET$IP2ADDRX
     3   1674          yes     yes      Std        2  NET$ADDR2NAME
     3   1750          yes     yes      Std        2  NET$NAME2ADDR
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:19   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      0  TCP_UENTRY                         2      1  TCP_BLKSIZE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 TCP$ASYNC
 yes     yes           Std       4 XSL$QSOCKET
 yes     yes           Std       3 XSL$QACCEPT_SRVR
 yes     yes           Std       2 XSL$QCLOSE
 yes     yes           Std       5 XSL$QSEND
         yes           Std       2 XSL$NTOHL
 yes     yes           Std       4 XSL$QCONNECT
 yes     yes           Std       4 XSL$QGETSOCKNAME
 yes     yes           Std       4 XSL$GETHOSTBYADDR
 yes     yes           Std       5 XSL$QRECV
 yes     yes           Std       6 XSL$QSELECT
 yes     yes           Std       2 XSL$INET_ADDR
         yes           Std       2 XSL$HTONL
 yes     yes           Std       6 XSL$QSETSOCKOPT
 yes     yes           Std       4 XSL$QBIND
 yes     yes           Std       3 XSL$QLISTEN
 yes     yes           Std       4 XSL$QGETPEERNAME
 yes     yes           Std       3 XSL$QSHUTDOWN
 yes     yes           Std       2 XSL$GETHOSTBYNAME
 yes     yes           Std       4 XSL$QACCEPT
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:20   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     TCP_ERR_CODE                          TCP_MON_ERR                           XSL_ERRNO
     M$UC                             r    B$TCB$                                XSL_SOCK$$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:21   


        1        1        /*M* TCP$HEP - Routines to interface HEP-style code to XPS-style TCP-IP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        TCP$OPEN: PROC (PRM1, PRM2, PRM3, MODE, PRM5, PRM6) ALTRET;

      8  3 000000   000000 700200 xent  TCP$OPEN     TSX0  ! X66_AUTO_N
         3 000001   000046 000006                    ZERO    38,6

        9        9
       10       10        %INCLUDE TCP_HEP_M;
       11       65        %INCLUDE XSL_INTERNAL_M;
       12      316        %INCLUDE XSL_SOCKET_M;
       13     1077        %INCLUDE XSL_SOCKET_E;
       14     1335        %INCLUDE XSL_PERR_C;
       15     1390    1   DCL XSL_ERRNO SBIN SYMREF;
       16     1391        %INCLUDE CP_6;
       17     1472        %INCLUDE B_ERRORS_C;
       18     2599    1   DCL PRM1 ALIGNED CHAR(RESULT);
       19     2600    1   DCL SOCKET REDEF PRM1 UBIN ALIGNED;
       20     2601        %VLP_NAME (FPTN=PRM1NAME, STCLASS=REDEF PRM1);
       21     2628    1   DCL PRM2 ALIGNED CHAR(RESULT);
       22     2629    1   DCL PRM2U REDEF PRM2 UBIN ALIGNED;
       23     2630        %VLP_NAME (FPTN=PRM2NAME, STCLASS=REDEF PRM2);
       24     2657        %TCP$SOCKET (NAME=PRM2_SOCK, STCLASS=REDEF PRM2);
       25     2665    1   DCL PRM2_VEC REDEF PRM2 VECTOR;
       26     2666    1   DCL PRM3 ALIGNED CHAR(RESULT);
       27     2667        %TCP$CB (NAME=PRM3_CB, STCLASS=REDEF PRM3);
       28     2670    1   DCL PUSH REDEF PRM3 BIT(1) ALIGNED;     /* TCP$WRITE                          */
       29     2671    1   DCL MODE UBIN;
       30     2672    1   DCL URGENT REDEF MODE SBIN;             /* TCP$WRITE                          */
       31     2673    1   DCL PRM5 UBIN;
       32     2674    1   DCL PRM6 UBIN;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:22   
       33     2675        %XSL$SOCKADDR (FPTN=LOCAL_SOCK, STCLASS=AUTO);
       34     2715        %XSL$SOCKADDR (FPTN=PEER_SOCK, STCLASS=AUTO);
       35     2755
       36     2756        %FPT_EVENT (STCLASS=CONSTANT, UENTRY=TCP$ASYNC);
       37     2770    1   DCL TCP$ASYNC ENTRY ASYNC;
       38     2771    1   DCL TCP_UENTRY UBIN STATIC SYMDEF INIT(0);
       39     2772    1   DCL TCP_BLKSIZE STATIC SYMDEF UBIN INIT(1600);
       40     2773    1   DCL TCP$ PTR;
       41     2774    1   DCL TCPBUF_ VECTOR STATIC INIT(VECTOR(NIL));
       42     2775    1   DCL 1 TCP_ REDEF TCPBUF_,
       43     2776    1          2 MAXSOCK SBIN,
       44     2777    1          2 P$$ PTR;
       45     2778    1   DCL 1 TCP_DAT BASED(TCP_.P$$) ALIGNED,
       46     2779    1          2 BLK$ PTR,
       47     2780    1          2 PTR$(0:0) PTR;
       48     2781    1   DCL 1 TCP$INFO BASED(TCP$) ALIGNED,
       49     2782    1          2 LISTEN BIT(1),
       50     2783    1          2 NOWAIT BIT(1),
       51     2784    1          2 RESET BIT(1),
       52     2785    1          2 PASSIVE BIT(1),
       53     2786    1          2 CLOSING BIT(1),
       54     2787    1          2 CONNECTED BIT(1),
       55     2788    1          2 * BIT(30),
       56     2789    1          2 BLK$ PTR,
       57     2790    1          2 BLKSIZ SBIN,
       58     2791    1          2 CB$ PTR,
       59     2792    1          2 ARS SBIN,
       60     2793    1          2 BUF$ PTR;
       61     2794
       62     2795        %TCP$CB (STCLASS=BASED);
       63     2798        %TCP$ADMIN (STCLASS=BASED);
       64     2819
       65     2820    1   DCL XSL$QSOCKET ENTRY(4) ALTRET;
       66     2821    1   DCL XSL$QBIND ENTRY(4) ALTRET;
       67     2822    1   DCL XSL$QLISTEN ENTRY(3) ALTRET;
       68     2823    1   DCL XSL$QACCEPT ENTRY(4) ALTRET;
       69     2824    1   DCL XSL$QACCEPT_SRVR ENTRY(3) ALTRET;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:23   
       70     2825    1   DCL XSL$QCLOSE ENTRY(2) ALTRET;
       71     2826    1   DCL XSL$QCONNECT ENTRY(4) ALTRET;
       72     2827    1   DCL XSL$QSEND ENTRY(5) ALTRET;
       73     2828    1   DCL XSL$QRECV ENTRY(5) ALTRET;
       74     2829    1   DCL XSL$QSELECT ENTRY(6) ALTRET;
       75     2830    1   DCL XSL$QSETSOCKOPT ENTRY(6) ALTRET;
       76     2831    1   DCL XSL$QSHUTDOWN ENTRY(3) ALTRET;
       77     2832    1   DCL XSL$GETHOSTNAME ENTRY(3) ALTRET;
       78     2833    1   DCL XSL$QGETPEERNAME ENTRY(4) ALTRET;
       79     2834    1   DCL XSL$QGETSOCKNAME ENTRY(4) ALTRET;
       80     2835    1   DCL XSL$QFCNTL ENTRY(4) ALTRET;
       81     2836    1   DCL XSL$HTONL ENTRY(2);
       82     2837    1   DCL XSL$HTONS ENTRY(2);
       83     2838    1   DCL XSL$NTOHL ENTRY(2);
       84     2839    1   DCL XSL$NTOHS ENTRY(2);
       85     2840    1   DCL XSL$INET_ADDR ENTRY(2) ALTRET;
       86     2841    1   DCL XSL$INET_NTOA ENTRY(2) ALTRET;
       87     2842    1   DCL XSL$GETHOSTBYADDR ENTRY(4) ALTRET;
       88     2843    1   DCL XSL$GETHOSTBYNAME ENTRY(2) ALTRET;
       89     2844        %XSL$HOSTENT;
       90     2904        %FPT_WAIT (FPTN=FPT_FOREVER, UNITS=999999, STCLASS=CONSTANT);
       91     2918        %FPT_WAIT (FPTN=WAIT1SEC, UNITS=1, STCLASS=CONSTANT);
       92     2932
       93     2933    1   DCL B$UBIN UBIN BASED;
       94     2934    1   DCL B$PTR PTR BASED;
       95     2935    1   DCL CHAR31 CHAR(31) BASED CALIGNED;
       96     2936    1   DCL I SBIN;
       97     2937    1   DCL P$ PTR;
       98     2938    1   DCL RESULT SBIN;
       99     2939    1   DCL FLAGS SBIN;
      100     2940    1   DCL FLAGBITS(0:35) REDEF FLAGS BIT(1) UNAL;
      101     2941    1   DCL 1 CBITS CONSTANT, 2 O(0:17) BIT(36) INIT(
      102     2942    1    '4'O,'2'O,'1'O,'04'O,'02'O,'01'O,'004'O,'002'O,'001'O,'0004'O,'0002'O,
      103     2943    1    '0001'O,'00004'O,'00002'O,'00001'O,'000004'O,'000002'O,'000001'O),
      104     2944    1          2 U(0:17) UBIN INIT(131073,65536,32768,16384,8192,4096,2048,1024,512,256,
      105     2945    1    128,64,32,16,8,4,2,1);
      106     2946    1   DCL BITS(0:35) REDEF CBITS BIT(36);
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:24   
      107     2947
      108     2948    1   DCL B$TCB$ PTR SYMREF READONLY;
      109     2949        %B$TCB (STCLASS="BASED(B$TCB$)");
      110     2952        %B$ALT;
      111     2960
      112     2961    1   DCL XSLERR_2_TCPERR CHAR(0) CONSTANT
      113     2962    1    INIT(%CONCAT(BINASC(E$FAILURE), BINASC(E$ACCES),
      114     2963         BINASC(E$ADDRINUSE), BINASC(E$ADDRNOTAVAIL), BINASC(E$AFNOSUPPORT),
      115     2964         BINASC(E$BADF), BINASC(E$DESTADDRREQ), BINASC(E$FAULT), BINASC(E$INTR),
      116     2965         BINASC(E$INVAL), BINASC(E$ISCONN), BINASC(E$MFILE), BINASC(E$MSGSIZE),
      117     2966         BINASC(E$NETUNREACH), BINASC(E$NOBUFFS), BINASC(E$NOENT),
      118     2967         BINASC(E$CONNREFUSED), BINASC(E$NETDOWN), BINASC(E$HOSTDOWN),
      119     2968         BINASC(E$HOSTUNREACH), BINASC(E$CONNABORTED), BINASC(E$NETRESET),
      120     2969         BINASC(E$INPROGRESS), BINASC(E$ALREADY), BINASC(E$PROTOTYPE),
      121     2970         BINASC(E$NAMETOOLONG), BINASC(E$NOPROTOOPT), BINASC(E$OPNOTSUPP),
      122     2971         BINASC(E$PFNOSUPPORT), BINASC(E$SOCKTNOSUPPORT), BINASC(E$TOOMANYREFS),
      123     2972         BINASC(E$LOOP), BINASC(E$SHUTDOWN),
      124     2973         BINASC(E$CONNRESET), BINASC(E$NOTCONN), BINASC(E$NOTSOCK),
      125     2974    1    BINASC(E$PERM), BINASC(E$TIMEDOUT), BINASC(E$WOULDBLOCK)));
      126     2975    1   DCL TCPERRS(0:42) SBIN CONSTANT INIT (-1, -1,
      127     2976    1    %E$TCP$DUP_CON*2, %E$TCP$BAD_PARM,
      128     2977    1    %E$TCP$LCN, %E$TCP$BAD_PARM, %(E$MTRAP*8+262144), %(E$BYDR*8+262144),
      129     2978    1    %E$TCP$BAD_PARM, %E$TCP$DUP_CON, %E$TCP$MAX_RESOURCES, %(E$LD*8+262144),
      130     2979    1    %E$TCP$NOT_ESTABLISHED, %E$TCP$MAX_RESOURCES*2,
      131     2980    1    %E$TCP$NOT_ESTABLISHED*3,
      132     2981    1    %E$TCP$NOT_ESTABLISHED, %E$TCP$RESET_RCVD*2,
      133     2982    1    %E$TCP$DUP_CON*2, %E$TCP$BAD_PARM,
      134     2983    1    %E$TCP$BAD_PARM*3,
      135     2984    1    %E$TCP$BAD_PARM*2, %E$TCP$MAX_RESOURCES,
      136     2985    1    %E$TCP$MAX_RESOURCES, %E$TCP$RESET_RCVD,
      137     2986    1    %E$TCP$RESET_RCVD, %E$TCP$NOT_ESTABLISHED, %E$TCP$LCN,
      138     2987    1    %E$TCP$BAD_PARM, %E$TCP$READ_TIMEOUT, 0, %E$TCP$RESET_RCVD);
      139     2988
      140     2989        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:25   
      141     2990    2      IF MODE ~= %TCP_SERVER_CLONE THEN DO;

   2990  3 000002   200006 470500                    LDP0    @MODE,,AUTO
         3 000003   000000 235100                    LDA     0,,PR0
         3 000004   000004 115007                    CMPA    4,DL
         3 000005   000200 600000 3                  TZE     s:3019

      142     2991    2         CALL XSL$QSOCKET (SOCKET, %XSL_AF_INET, %XSL_SOCK_STREAM, %XSL_PF_INET)

   2991  3 000006   000000 237000 4                  LDAQ    0
         3 000007   200042 757100                    STAQ    @HEP_SOCK+4,,AUTO
         3 000010   000001 236000 4                  LDQ     1
         3 000011   200003 235100                    LDA     @PRM1,,AUTO
         3 000012   200040 757100                    STAQ    @HEP_SOCK+2,,AUTO
         3 000013   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000014   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000015   000000 701000 xent               TSX1    XSL$QSOCKET
         3 000016   000311 702000 3                  TSX2    NOSOCKET

      143     2992    2           ALTRET(NOSOCKET);
      144     2993    2         IF TCP_.P$$ = ADDR(NIL) THEN CALL TCPINIT ALTRET(ERRRET);

   2993  3 000017   000003 236000 2                  LDQ     TCPBUF_+1
         3 000020   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000021   000024 601000 3                  TNZ     s:2994

   2993  3 000022   000476 701000 3                  TSX1    TCPINIT
         3 000023   000311 702000 3                  TSX2    NOSOCKET

      145     2994    2         TCP$ = TCP_DAT.PTR$(SOCKET);

   2994  3 000024   200003 470500                    LDP0    @PRM1,,AUTO
         3 000025   000000 720100                    LXL0    0,,PR0
         3 000026   000003 471400 2                  LDP1    TCPBUF_+1
         3 000027   100001 236110                    LDQ     1,X0,PR1
         3 000030   200023 756100                    STQ     TCP$,,AUTO

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:26   
      146     2995    2         TCP$INFO = '0'B;

   2995  3 000031   200023 473500                    LDP3    TCP$,,AUTO
         3 000032   000100 100400                    MLR     fill='000'O
         3 000033   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000034   300000 000030                    ADSC9   0,,PR3                   cn=0,n=24

      147     2996    2         CALL HEPSOCK_2_XSLSOCK (LOCAL_SOCK, PRM2);

   2996  3 000035   200004 236100                    LDQ     @PRM2,,AUTO
         3 000036   200036 756100                    STQ     @XSL_SOCK+1,,AUTO
         3 000037   200011 631500                    EPPR1   LOCAL_SOCK,,AUTO
         3 000040   200035 451500                    STP1    @TCP_ADMIN+3,,AUTO
         3 000041   000376 701000 3                  TSX1    HEPSOCK_2_XSLSOCK
         3 000042   000000 011000                    NOP     0

      148     2997    2         CALL HEPSOCK_2_XSLSOCK (PEER_SOCK, PRM3);

   2997  3 000043   200005 236100                    LDQ     @PRM3,,AUTO
         3 000044   200036 756100                    STQ     @XSL_SOCK+1,,AUTO
         3 000045   200016 630500                    EPPR0   PEER_SOCK,,AUTO
         3 000046   200035 450500                    STP0    @TCP_ADMIN+3,,AUTO
         3 000047   000376 701000 3                  TSX1    HEPSOCK_2_XSLSOCK
         3 000050   000000 011000                    NOP     0

      149     2998    3         IF PRM2_SOCK.PORT~=0 OR PRM2_SOCK.ADDRESS~=0 OR MODE=%TCP_PASSIVE THEN DO;

   2998  3 000051   200004 470500                    LDP0    @PRM2,,AUTO
         3 000052   000001 236100                    LDQ     1,,PR0
         3 000053   777774 316003                    CANQ    -4,DU
         3 000054   000064 601000 3                  TNZ     s:2999
         3 000055   000000 236100                    LDQ     0,,PR0
         3 000056   000002 316000 4                  CANQ    2
         3 000057   000064 601000 3                  TNZ     s:2999
         3 000060   200006 471500                    LDP1    @MODE,,AUTO
         3 000061   100000 235100                    LDA     0,,PR1
         3 000062   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:27   
         3 000063   000131 601000 3                  TNZ     s:3010

      150     2999    3            CALL XSL$QSETSOCKOPT (RESULT, SOCKET, %XSL_SOL_SOCKET,

   2999  3 000064   000004 237000 4                  LDAQ    4
         3 000065   200044 757100                    STAQ    @HEP_SOCK+6,,AUTO
         3 000066   000006 237000 4                  LDAQ    6
         3 000067   200042 757100                    STAQ    @HEP_SOCK+4,,AUTO
         3 000070   200003 236100                    LDQ     @PRM1,,AUTO
         3 000071   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000072   200026 631500                    EPPR1   RESULT,,AUTO
         3 000073   200040 451500                    STP1    @HEP_SOCK+2,,AUTO
         3 000074   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000075   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000076   000000 701000 xent               TSX1    XSL$QSETSOCKOPT
         3 000077   000311 702000 3                  TSX2    NOSOCKET

      151     3000    3              %XSL_SO_REUSEADDR, 262144, 2) ALTRET (ERRRET);
      152     3001    3            I = 60;

   3001  3 000100   000074 235007                    LDA     60,DL
         3 000101   200024 755100                    STA     I,,AUTO

      153     3002    3   DOBIND:  CALL XSL$QBIND (RESULT, SOCKET, LOCAL_SOCK, 8)

   3002  3 000102   000003 236000 4     DOBIND       LDQ     3
         3 000103   200043 756100                    STQ     @HEP_SOCK+5,,AUTO
         3 000104   200011 630500                    EPPR0   LOCAL_SOCK,,AUTO
         3 000105   200042 450500                    STP0    @HEP_SOCK+4,,AUTO
         3 000106   200003 236100                    LDQ     @PRM1,,AUTO
         3 000107   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000110   200026 631500                    EPPR1   RESULT,,AUTO
         3 000111   200040 451500                    STP1    @HEP_SOCK+2,,AUTO
         3 000112   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000113   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000114   000000 701000 xent               TSX1    XSL$QBIND
         3 000115   000117 702000 3                  TSX2    s:3004
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:28   
         3 000116   000131 710000 3                  TRA     s:3010

      154     3003    4            WHENALTRETURN DO;

      155     3004    4               I = I - 1;

   3004  3 000117   000001 336007                    LCQ     1,DL
         3 000120   200024 056100                    ASQ     I,,AUTO

      156     3005    4               IF I <= 0 OR XSL_ERRNO ~= %E$ADDRINUSE THEN GOTO ERRRET;

   3005  3 000121   000311 604400 3                  TMOZ    NOSOCKET
         3 000122   000000 235000 xsym               LDA     XSL_ERRNO
         3 000123   000153 115007                    CMPA    107,DL
         3 000124   000311 601000 3                  TNZ     NOSOCKET

      157     3006    4               CALL M$WAIT (WAIT1SEC);

   3006  3 000125   000012 630400 1                  EPPR0   WAIT1SEC
         3 000126   020006 713400                    CLIMB   8198
         3 000127   400400 401760                    pmme    nvectors=2

      158     3007    4               GOTO DOBIND;

   3007  3 000130   000102 710000 3                  TRA     DOBIND

      159     3008    4            END;
      160     3009    3         END;

      161     3010    3         IF MODE=%TCP_ACTIVE THEN DO;

   3010  3 000131   200006 470500                    LDP0    @MODE,,AUTO
         3 000132   000000 235100                    LDA     0,,PR0
         3 000133   000001 115007                    CMPA    1,DL
         3 000134   000155 601000 3                  TNZ     s:3014

      162     3011    3            CALL XSL$QCONNECT (RESULT, SOCKET, PEER_SOCK, 8) ALTRET (ERRRET);
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:29   

   3011  3 000135   000003 236000 4                  LDQ     3
         3 000136   200043 756100                    STQ     @HEP_SOCK+5,,AUTO
         3 000137   200016 631500                    EPPR1   PEER_SOCK,,AUTO
         3 000140   200042 451500                    STP1    @HEP_SOCK+4,,AUTO
         3 000141   200003 236100                    LDQ     @PRM1,,AUTO
         3 000142   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000143   200026 633500                    EPPR3   RESULT,,AUTO
         3 000144   200040 453500                    STP3    @HEP_SOCK+2,,AUTO
         3 000145   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000146   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000147   000000 701000 xent               TSX1    XSL$QCONNECT
         3 000150   000311 702000 3                  TSX2    NOSOCKET

      163     3012    3            TCP$INFO.CONNECTED = '1'B;

   3012  3 000151   200023 470500                    LDP0    TCP$,,AUTO
         3 000152   010000 236003                    LDQ     4096,DU
         3 000153   000000 256100                    ORSQ    0,,PR0

      164     3013    3         END; ELSE DO;

   3013  3 000154   000232 710000 3                  TRA     s:3026

      165     3014    3            IF MODE=%TCP_PASSIVE THEN TCP$INFO.PASSIVE = '1'B;

   3014  3 000155   000002 115007                    CMPA    2,DL
         3 000156   000162 601000 3                  TNZ     s:3015

   3014  3 000157   200023 471500                    LDP1    TCP$,,AUTO
         3 000160   040000 236003                    LDQ     16384,DU
         3 000161   100000 256100                    ORSQ    0,,PR1

      166     3015    3            CALL XSL$QLISTEN (RESULT, SOCKET, 1) ALTRET (ERRRET);

   3015  3 000162   000000 236000 4                  LDQ     0
         3 000163   200042 756100                    STQ     @HEP_SOCK+4,,AUTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:30   
         3 000164   200003 236100                    LDQ     @PRM1,,AUTO
         3 000165   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000166   200026 631500                    EPPR1   RESULT,,AUTO
         3 000167   200040 451500                    STP1    @HEP_SOCK+2,,AUTO
         3 000170   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000171   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000172   000000 701000 xent               TSX1    XSL$QLISTEN
         3 000173   000311 702000 3                  TSX2    NOSOCKET

      167     3016    3            TCP$INFO.LISTEN = '1'B;

   3016  3 000174   200023 470500                    LDP0    TCP$,,AUTO
         3 000175   400000 236003                    LDQ     -131072,DU
         3 000176   000000 256100                    ORSQ    0,,PR0

      168     3017    3         END;

      169     3018    2      END; ELSE DO;

   3018  3 000177   000232 710000 3                  TRA     s:3026

      170     3019    2         CALL XSL$QACCEPT_SRVR (SOCKET, PEER_SOCK, RESULT) ALTRET (ERRRET);

   3019  3 000200   200026 631500                    EPPR1   RESULT,,AUTO
         3 000201   200042 451500                    STP1    @HEP_SOCK+4,,AUTO
         3 000202   200016 633500                    EPPR3   PEER_SOCK,,AUTO
         3 000203   200041 453500                    STP3    @HEP_SOCK+3,,AUTO
         3 000204   200003 236100                    LDQ     @PRM1,,AUTO
         3 000205   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 000206   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000207   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000210   000000 701000 xent               TSX1    XSL$QACCEPT_SRVR
         3 000211   000311 702000 3                  TSX2    NOSOCKET

      171     3020    2         IF TCP_.P$$ = ADDR(NIL) THEN CALL TCPINIT ALTRET (ERRRET);

   3020  3 000212   000003 236000 2                  LDQ     TCPBUF_+1
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:31   
         3 000213   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000214   000217 601000 3                  TNZ     s:3021

   3020  3 000215   000476 701000 3                  TSX1    TCPINIT
         3 000216   000311 702000 3                  TSX2    NOSOCKET

      172     3021    2         TCP$ = TCP_DAT.PTR$(SOCKET);

   3021  3 000217   200003 470500                    LDP0    @PRM1,,AUTO
         3 000220   000000 720100                    LXL0    0,,PR0
         3 000221   000003 471400 2                  LDP1    TCPBUF_+1
         3 000222   100001 236110                    LDQ     1,X0,PR1
         3 000223   200023 756100                    STQ     TCP$,,AUTO

      173     3022    2         TCP$INFO = '0'B;

   3022  3 000224   200023 473500                    LDP3    TCP$,,AUTO
         3 000225   000100 100400                    MLR     fill='000'O
         3 000226   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000227   300000 000030                    ADSC9   0,,PR3                   cn=0,n=24

      174     3023    2         TCP$INFO.CONNECTED = '1'B;

   3023  3 000230   010000 236003                    LDQ     4096,DU
         3 000231   300000 256100                    ORSQ    0,,PR3

      175     3024    2      END;

      176     3025        /* CALL XSL$QFCNTL (RESULT, SOCKET, 0) ALTRET (ERRRET); */
      177     3026    2      IF ADDR(PRM6)~=ADDR(NIL) THEN DO;

   3026  3 000232   200010 236100                    LDQ     @PRM6,,AUTO
         3 000233   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000234   000261 600000 3                  TZE     s:3031

      178     3027    2         RESULT = 8;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:32   
   3027  3 000235   000010 235007                    LDA     8,DL
         3 000236   200026 755100                    STA     RESULT,,AUTO

      179     3028    2         CALL XSL$QGETSOCKNAME (RESULT, SOCKET, LOCAL_SOCK, RESULT);

   3028  3 000237   200026 630500                    EPPR0   RESULT,,AUTO
         3 000240   200043 450500                    STP0    @HEP_SOCK+5,,AUTO
         3 000241   200011 631500                    EPPR1   LOCAL_SOCK,,AUTO
         3 000242   200042 451500                    STP1    @HEP_SOCK+4,,AUTO
         3 000243   200003 236100                    LDQ     @PRM1,,AUTO
         3 000244   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000245   200026 633500                    EPPR3   RESULT,,AUTO
         3 000246   200040 453500                    STP3    @HEP_SOCK+2,,AUTO
         3 000247   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000250   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000251   000000 701000 xent               TSX1    XSL$QGETSOCKNAME
         3 000252   000000 011000                    NOP     0

      180     3029    2         CALL XSLSOCK_2_HEPSOCK (LOCAL_SOCK, PRM6);

   3029  3 000253   200010 236100                    LDQ     @PRM6,,AUTO
         3 000254   200036 756100                    STQ     @XSL_SOCK+1,,AUTO
         3 000255   200011 630500                    EPPR0   LOCAL_SOCK,,AUTO
         3 000256   200035 450500                    STP0    @TCP_ADMIN+3,,AUTO
         3 000257   000437 701000 3                  TSX1    XSLSOCK_2_HEPSOCK
         3 000260   000000 011000                    NOP     0

      181     3030    2      END;

      182     3031    2      IF ADDR(PRM5)~=ADDR(NIL) THEN DO;

   3031  3 000261   200007 236100                    LDQ     @PRM5,,AUTO
         3 000262   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000263   000310 600000 3                  TZE     s:3036

      183     3032    2         RESULT = 8;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:33   
   3032  3 000264   000010 235007                    LDA     8,DL
         3 000265   200026 755100                    STA     RESULT,,AUTO

      184     3033    2         CALL XSL$QGETPEERNAME (RESULT, SOCKET, PEER_SOCK, RESULT);

   3033  3 000266   200026 630500                    EPPR0   RESULT,,AUTO
         3 000267   200043 450500                    STP0    @HEP_SOCK+5,,AUTO
         3 000270   200016 631500                    EPPR1   PEER_SOCK,,AUTO
         3 000271   200042 451500                    STP1    @HEP_SOCK+4,,AUTO
         3 000272   200003 236100                    LDQ     @PRM1,,AUTO
         3 000273   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000274   200026 633500                    EPPR3   RESULT,,AUTO
         3 000275   200040 453500                    STP3    @HEP_SOCK+2,,AUTO
         3 000276   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000277   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000300   000000 701000 xent               TSX1    XSL$QGETPEERNAME
         3 000301   000000 011000                    NOP     0

      185     3034    2         CALL XSLSOCK_2_HEPSOCK (PEER_SOCK, PRM5);

   3034  3 000302   200007 236100                    LDQ     @PRM5,,AUTO
         3 000303   200036 756100                    STQ     @XSL_SOCK+1,,AUTO
         3 000304   200016 630500                    EPPR0   PEER_SOCK,,AUTO
         3 000305   200035 450500                    STP0    @TCP_ADMIN+3,,AUTO
         3 000306   000437 701000 3                  TSX1    XSLSOCK_2_HEPSOCK
         3 000307   000000 011000                    NOP     0

      186     3035    2      END;

      187     3036    1      RETURN;

   3036  3 000310   000000 702200 xent               TSX2  ! X66_ARET

   3031  3 000311                       NOSOCKET     null
   3031  3 000311                       ERRRET       null
      188     3037
      189     3038    1   NOSOCKET:;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:34   
      190     3039    1   ERRRET:;
      191     3040    1      CALL INDEX(RESULT, BINASC(XSL_ERRNO), XSLERR_2_TCPERR);

   3040  3 000311   000000 236000 xsym               LDQ     XSL_ERRNO
         3 000312   000033 736000                    QLS     27
         3 000313   000010 276000 4                  ORQ     8
         3 000314   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 000315   000100 124400                    SCM     mask='000'O
         3 000316   000064 000047 1                  ADSC9   XSLERR_2_TCPERR          cn=0,n=39
         3 000317   200040 000001                    ADSC9   @HEP_SOCK+2,,AUTO        cn=0,n=1
         3 000320   200026 000100                    ARG     RESULT,,AUTO

      192     3041    1      TCP_MON_ERR = '0'B;

   3041  3 000321   000000 450000 xsym               STZ     TCP_MON_ERR

      193     3042    1      TCP_ERR_CODE.ERR# = 0;

   3042  3 000322   000011 236000 4                  LDQ     9
         3 000323   000000 356000 xsym               ANSQ    TCP_ERR_CODE

      194     3043    1      FLAGS = TCPERRS(RESULT);

   3043  3 000324   200026 720100                    LXL0    RESULT,,AUTO
         3 000325   000076 235010 1                  LDA     TCPERRS,X0
         3 000326   200027 755100                    STA     FLAGS,,AUTO

      195     3044    1      IF FLAGS=-1

   3044  3 000327   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 000330   000336 601000 3                  TNZ     s:3046

      196     3045    1      THEN TCP_MON_ERR = B$TCB.ALT$->B$ALT.ERR;

   3045  3 000331   000000 470400 xsym               LDP0    B$TCB$
         3 000332   000000 471500                    LDP1    0,,PR0
         3 000333   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:35   
         3 000334   000000 756000 xsym               STQ     TCP_MON_ERR
         3 000335   000375 710000 3                  TRA     s:3057

      197     3046    1      ELSE IF FLAGS>4000

   3046  3 000336   007640 115007                    CMPA    4000,DL
         3 000337   000343 604400 3                  TMOZ    s:3048

      198     3047    1      THEN TCP_MON_ERR = FLAGBITS;

   3047  3 000340   200027 236100                    LDQ     FLAGS,,AUTO
         3 000341   000000 756000 xsym               STQ     TCP_MON_ERR
         3 000342   000375 710000 3                  TRA     s:3057

      199     3048    2      ELSE IF FLAGS=0 THEN DO;

   3048  3 000343   000000 115003                    CMPA    0,DU
         3 000344   000364 601000 3                  TNZ     s:3054

      200     3049    2         IF TCP_.P$$=ADDR(NIL) OR SOCKET>TCP_.MAXSOCK THEN EXIT;

   3049  3 000345   000003 236000 2                  LDQ     TCPBUF_+1
         3 000346   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000347   000363 600000 3                  TZE     s:3051+1
         3 000350   200003 470500                    LDP0    @PRM1,,AUTO
         3 000351   000000 236100                    LDQ     0,,PR0
         3 000352   000363 604000 3                  TMI     s:3051+1
         3 000353   000002 116000 2                  CMPQ    TCPBUF_
         3 000354   000363 605400 3                  TPNZ    s:3051+1

      201     3050    2         TCP_DAT.PTR$(SOCKET)->TCP$INFO.RESET = '1'B;

   3050  3 000355   000000 721100                    LXL1    0,,PR0
         3 000356   000003 471400 2                  LDP1    TCPBUF_+1
         3 000357   100001 473511                    LDP3    1,X1,PR1
         3 000360   100000 236003                    LDQ     32768,DU
         3 000361   300000 256100                    ORSQ    0,,PR3
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:36   

      202     3051    2         RETURN;

   3051  3 000362   000000 702200 xent               TSX2  ! X66_ARET
         3 000363   000375 710000 3                  TRA     s:3057

      203     3052    2      END;
      204     3053    2      ELSE DO;

      205     3054    2         TCP_ERR_CODE.ERR# = FLAGS;

   3054  3 000364   200027 236100                    LDQ     FLAGS,,AUTO
         3 000365   000003 736000                    QLS     3
         3 000366   000000 676000 xsym               ERQ     TCP_ERR_CODE
         3 000367   377770 376007                    ANQ     131064,DL
         3 000370   000000 656000 xsym               ERSQ    TCP_ERR_CODE

      206     3055    2         TCP_MON_ERR = '302314'O|BINBIT(XSL_ERRNO,33);

   3055  3 000371   000000 236000 xsym               LDQ     XSL_ERRNO
         3 000372   000003 736000                    QLS     3
         3 000373   302314 276003                    ORQ     99532,DU
         3 000374   000000 756000 xsym               STQ     TCP_MON_ERR

      207     3056    2      END;

      208     3057    1      ALTRETURN;

   3057  3 000375   000000 702200 xent               TSX2  ! X66_AALT

      209     3058
      210     3059        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:37   
      211     3060    1   HEPSOCK_2_XSLSOCK: PROC (XSL_SOCK, HEP_SOCK);

   3060  3 000376   200034 741300       HEPSOCK_2_X* STX1  ! @TCP_ADMIN+2,,AUTO

      212     3061        %TCP$SOCKET (NAME=HEP_SOCK, STCLASS=PARAM);
      213     3069        %XSL$SOCKADDR_IN (FPTN=XSL_SOCK, STCLASS=PARAM);
      214     3133    2      XSL_SOCK.SA_FAMILY = %XSL_AF_INET;

   3133  3 000377   000002 235007                    LDA     2,DL
         3 000400   200035 470500                    LDP0    @XSL_SOCK,,AUTO
         3 000401   000000 755100                    STA     0,,PR0

      215     3134    2      XSL_SOCK.S_PORT = HEP_SOCK.ADDRESS;

   3134  3 000402   200036 471500                    LDP1    @HEP_SOCK,,AUTO
         3 000403   100000 236100                    LDQ     0,,PR1
         3 000404   000004 772000                    QRL     4
         3 000405   000001 756100                    STQ     1,,PR0

      216     3135    2      CALL XSL$HTONL (XSL_SOCK.S_ADDR, XSL_SOCK.S_PORT);

   3135  3 000406   200035 236100                    LDQ     @XSL_SOCK,,AUTO
         3 000407   000001 036003                    ADLQ    1,DU
         3 000410   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000411   200035 236100                    LDQ     @XSL_SOCK,,AUTO
         3 000412   000002 036003                    ADLQ    2,DU
         3 000413   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 000414   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000415   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000416   000000 701000 xent               TSX1    XSL$HTONL
         3 000417   000000 011000                    NOP     0

      217     3136    2      XSL_SOCK.S_PORT = HEP_SOCK.PORT;

   3136  3 000420   200036 470500                    LDP0    @HEP_SOCK,,AUTO
         3 000421   200035 471500                    LDP1    @XSL_SOCK,,AUTO
         3 000422   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:38   
         3 000423   000024 772000                    QRL     20
         3 000424   100001 756100                    STQ     1,,PR1

      218     3137    2      CALL XSL$HTONL( XSL_SOCK.S_PORT, XSL_SOCK.S_PORT);

   3137  3 000425   200035 236100                    LDQ     @XSL_SOCK,,AUTO
         3 000426   000001 036003                    ADLQ    1,DU
         3 000427   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000430   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 000431   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000432   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000433   000000 701000 xent               TSX1    XSL$HTONL
         3 000434   000000 011000                    NOP     0

      219     3138    2      RETURN;

   3138  3 000435   200034 221300                    LDX1  ! @TCP_ADMIN+2,,AUTO
         3 000436   000001 702211                    TSX2  ! 1,X1

      220     3139
      221     3140    2   XSLSOCK_2_HEPSOCK: ENTRY (XSL_SOCK, HEP_SOCK);

   3140  3 000437   200034 741300       XSLSOCK_2_H* STX1  ! @TCP_ADMIN+2,,AUTO

      222     3141    2      CALL XSL$NTOHL( XSL_SOCK.S_PORT, XSL_SOCK.S_PORT);

   3141  3 000440   200035 236100                    LDQ     @XSL_SOCK,,AUTO
         3 000441   000001 036003                    ADLQ    1,DU
         3 000442   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000443   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 000444   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000445   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000446   000000 701000 xent               TSX1    XSL$NTOHL
         3 000447   000000 011000                    NOP     0

      223     3142    2      HEP_SOCK.PORT = XSL_SOCK.S_PORT;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:39   
   3142  3 000450   200035 470500                    LDP0    @XSL_SOCK,,AUTO
         3 000451   200036 471500                    LDP1    @HEP_SOCK,,AUTO
         3 000452   000001 235100                    LDA     1,,PR0
         3 000453   000024 735000                    ALS     20
         3 000454   100001 755100                    STA     1,,PR1

      224     3143    2      CALL XSL$NTOHL (XSL_SOCK.S_PORT, XSL_SOCK.S_ADDR);

   3143  3 000455   200035 236100                    LDQ     @XSL_SOCK,,AUTO
         3 000456   000002 036003                    ADLQ    2,DU
         3 000457   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000460   200035 236100                    LDQ     @XSL_SOCK,,AUTO
         3 000461   000001 036003                    ADLQ    1,DU
         3 000462   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 000463   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000464   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000465   000000 701000 xent               TSX1    XSL$NTOHL
         3 000466   000000 011000                    NOP     0

      225     3144    2      HEP_SOCK.ADDRESS = XSL_SOCK.S_PORT;

   3144  3 000467   200035 470500                    LDP0    @XSL_SOCK,,AUTO
         3 000470   200036 471500                    LDP1    @HEP_SOCK,,AUTO
         3 000471   000001 235100                    LDA     1,,PR0
         3 000472   000004 735000                    ALS     4
         3 000473   100000 755100                    STA     0,,PR1

      226     3145    2   END HEPSOCK_2_XSLSOCK;

   3145  3 000474   200034 221300                    LDX1  ! @TCP_ADMIN+2,,AUTO
         3 000475   000001 702211                    TSX2  ! 1,X1

      227     3146        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:40   
      228     3147    1   TCPINIT: PROC ALTRET;

   3147  3 000476   200030 741300       TCPINIT      STX1  ! FLAGS+1,,AUTO

      229     3148        %FPT_GDS (SEGSIZE=1024,RESULTS=TCPBUF_,STCLASS=CONSTANT);
      230     3164        %XSL$SOCKHD (STCLASS="BASED(XSL_SOCK$$)");
      231     3197    2   DCL XSL_SOCK$$ PTR SYMREF;
      232     3198
      233     3199    2      VBASE(TCPBUF_) = XSL_SOCK$$;

   3199  3 000477   000000 236000 xsym               LDQ     XSL_SOCK$$
         3 000500   000003 756000 2                  STQ     TCPBUF_+1

      234     3200    3      DO UNTIL VBOUND(TCPBUF_) + 1 >= TCP_BLKSIZE +

      235     3201    3        4*(XSL$SOCKHD.SEGSIZE + XSL$SOCKHD.MAXSOCK*(1 + SIZEW(TCP$INFO)));
      236     3202    4         CALL M$GDS (FPT_GDS) WHENALTRETURN DO;

   3202  3 000501   000152 630400 1                  EPPR0   FPT_GDS
         3 000502   430001 713400                    CLIMB   alt,gds
         3 000503   400400 401760                    pmme    nvectors=2
         3 000504   000506 702000 3                  TSX2    s:3203
         3 000505   000512 710000 3                  TRA     s:3206

      237     3203    4            XSL_ERRNO = %E$FAILURE;

   3203  3 000506   000001 335007                    LCA     1,DL
         3 000507   000000 755000 xsym               STA     XSL_ERRNO

      238     3204    4            ALTRETURN;

   3204  3 000510   200030 221300                    LDX1  ! FLAGS+1,,AUTO
         3 000511   000000 702211                    TSX2  ! 0,X1

      239     3205    4         END;
      240     3206    3      END;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:41   
   3206  3 000512   000000 470400 xsym               LDP0    XSL_SOCK$$
         3 000513   000001 236100                    LDQ     1,,PR0
         3 000514   000022 772000                    QRL     18
         3 000515   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 000516   000002 236100                    LDQ     2,,PR0
         3 000517   000007 402007                    MPY     7,DL
         3 000520   200040 036100                    ADLQ    @HEP_SOCK+2,,AUTO
         3 000521   000002 736000                    QLS     2
         3 000522   000001 036000 2                  ADLQ    TCP_BLKSIZE
         3 000523   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000524   000002 236000 2                  LDQ     TCPBUF_
         3 000525   000020 772000                    QRL     16
         3 000526   000001 036007                    ADLQ    1,DL
         3 000527   200041 116100                    CMPQ    @HEP_SOCK+3,,AUTO
         3 000530   000501 602000 3                  TNC     s:3202

      241     3207    2      TCP_.P$$ = PINCRW(XSL_SOCK$$,XSL$SOCKHD.SEGSIZE);

   3207  3 000531   000001 220100                    LDX0    1,,PR0
         3 000532   000000 636010                    EAQ     0,X0
         3 000533   000000 036000 xsym               ADLQ    XSL_SOCK$$
         3 000534   000003 756000 2                  STQ     TCPBUF_+1

      242     3208    2      TCP_.MAXSOCK = XSL$SOCKHD.MAXSOCK;

   3208  3 000535   000002 235100                    LDA     2,,PR0
         3 000536   000002 755000 2                  STA     TCPBUF_

      243     3209    3      DO RESULT=0 TO TCP_.MAXSOCK-1;

   3209  3 000537   200026 450100                    STZ     RESULT,,AUTO
         3 000540   000561 710000 3                  TRA     s:3213+1

      244     3210    3         TCP_DAT.PTR$(RESULT) =

   3210  3 000541   200026 236100                    LDQ     RESULT,,AUTO
         3 000542   000006 402007                    MPY     6,DL
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:42   
         3 000543   000002 036000 2                  ADLQ    TCPBUF_
         3 000544   000022 736000                    QLS     18
         3 000545   000001 036003                    ADLQ    1,DU
         3 000546   000003 036000 2                  ADLQ    TCPBUF_+1
         3 000547   000003 470400 2                  LDP0    TCPBUF_+1
         3 000550   200026 720100                    LXL0    RESULT,,AUTO
         3 000551   000001 756110                    STQ     1,X0,PR0

      245     3211    3           ADDR(TCP_DAT.PTR$(TCP_.MAXSOCK+RESULT*SIZEW(TCP$INFO)));
      246     3212    3         TCP_DAT.PTR$(RESULT)->TCP$INFO = '0'B;

   3212  3 000552   000003 470400 2                  LDP0    TCPBUF_+1
         3 000553   200026 720100                    LXL0    RESULT,,AUTO
         3 000554   000001 471510                    LDP1    1,X0,PR0
         3 000555   000100 100400                    MLR     fill='000'O
         3 000556   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000557   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24

      247     3213    3      END;

   3213  3 000560   200026 054100                    AOS     RESULT,,AUTO
         3 000561   200026 236100                    LDQ     RESULT,,AUTO
         3 000562   000002 116000 2                  CMPQ    TCPBUF_
         3 000563   000541 604000 3                  TMI     s:3210

      248     3214    2      TCP_DAT.BLK$ = ADDR(TCP_DAT.PTR$(RESULT*(1+SIZEW(TCP$INFO))));

   3214  3 000564   000007 402003                    MPY     7,DU
         3 000565   000001 036003                    ADLQ    1,DU
         3 000566   000003 036000 2                  ADLQ    TCPBUF_+1
         3 000567   000003 470400 2                  LDP0    TCPBUF_+1
         3 000570   000000 756100                    STQ     0,,PR0

      249     3215    2   END TCPINIT;

   3215  3 000571   200030 221300                    LDX1  ! FLAGS+1,,AUTO
         3 000572   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:43   

      250     3216        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:44   
      251     3217    1   TCP$EVENT: ENTRY (PRM1) ALTRET;

   3217  3 000573   000000 700200 xent  TCP$EVENT    TSX0  ! X66_AUTO_N
         3 000574   000046 000006                    ZERO    38,6

      252     3218    1      TCP_UENTRY = SOCKET;

   3218  3 000575   200003 470500                    LDP0    @PRM1,,AUTO
         3 000576   000000 235100                    LDA     0,,PR0
         3 000577   000000 755000 2                  STA     TCP_UENTRY

      253     3219    1      CALL M$EVENT (FPT_EVENT);

   3219  3 000600   000000 630400 1                  EPPR0   FPT_EVENT
         3 000601   010001 713400                    CLIMB   4097
         3 000602   400000 401760                    pmme    nvectors=1

      254     3220    1      RETURN;

   3220  3 000603   000000 702200 xent               TSX2  ! X66_ARET

      255     3221
      256     3222    1   TCP$CLOSE: ENTRY (PRM1) ALTRET;

   3222  3 000604   000000 700200 xent  TCP$CLOSE    TSX0  ! X66_AUTO_N
         3 000605   000046 000006                    ZERO    38,6

      257     3223    1      CALL TCP$WRITE (PRM1, VECTOR(NIL), '1'B); /* flush any buffered output     */

   3223  3 000606   000014 236000 4                  LDQ     12
         3 000607   200042 756100                    STQ     @HEP_SOCK+4,,AUTO
         3 000610   000015 236000 4                  LDQ     13
         3 000611   200003 235100                    LDA     @PRM1,,AUTO
         3 000612   200040 757100                    STAQ    @HEP_SOCK+2,,AUTO
         3 000613   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000614   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000615   000656 701000 3                  TSX1    s:3234
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:45   
         3 000616   000000 011000                    NOP     0

      258     3224    1      CALL XSL$QSHUTDOWN (RESULT, SOCKET, 1) ALTRET (ERRRET);

   3224  3 000617   000000 236000 4                  LDQ     0
         3 000620   200042 756100                    STQ     @HEP_SOCK+4,,AUTO
         3 000621   200003 236100                    LDQ     @PRM1,,AUTO
         3 000622   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000623   200026 630500                    EPPR0   RESULT,,AUTO
         3 000624   200040 450500                    STP0    @HEP_SOCK+2,,AUTO
         3 000625   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000626   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000627   000000 701000 xent               TSX1    XSL$QSHUTDOWN
         3 000630   000311 702000 3                  TSX2    NOSOCKET

      259     3225    1      TCP_DAT.PTR$(SOCKET)->TCP$INFO.CLOSING = '1'B;

   3225  3 000631   200003 470500                    LDP0    @PRM1,,AUTO
         3 000632   000000 720100                    LXL0    0,,PR0
         3 000633   000003 471400 2                  LDP1    TCPBUF_+1
         3 000634   100001 473510                    LDP3    1,X0,PR1
         3 000635   020000 236003                    LDQ     8192,DU
         3 000636   300000 256100                    ORSQ    0,,PR3

      260     3226    1      RETURN;

   3226  3 000637   000000 702200 xent               TSX2  ! X66_ARET

      261     3227
      262     3228    1   TCP$ABORT: ENTRY (PRM1) ALTRET;

   3228  3 000640   000000 700200 xent  TCP$ABORT    TSX0  ! X66_AUTO_N
         3 000641   000046 000006                    ZERO    38,6
         3 000642   000645 710000 3                  TRA     s:3230

      263     3229    1   TCP$RELEASE: ENTRY (PRM1) ALTRET;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:46   
   3229  3 000643   000000 700200 xent  TCP$RELEASE  TSX0  ! X66_AUTO_N
         3 000644   000046 000006                    ZERO    38,6

      264     3230    1      CALL XSL$QCLOSE (RESULT, SOCKET) ALTRET (ERRRET);

   3230  3 000645   200003 236100                    LDQ     @PRM1,,AUTO
         3 000646   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 000647   200026 630500                    EPPR0   RESULT,,AUTO
         3 000650   200040 450500                    STP0    @HEP_SOCK+2,,AUTO
         3 000651   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 000652   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000653   000000 701000 xent               TSX1    XSL$QCLOSE
         3 000654   000311 702000 3                  TSX2    NOSOCKET

      265     3231    1      RETURN;

   3231  3 000655   000000 702200 xent               TSX2  ! X66_ARET

      266     3232
      267     3233        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:47   
      268     3234    1   TCP$WRITE: ENTRY (PRM1, PRM2, PRM3, MODE) ALTRET;

   3234  3 000656   000000 700200 xent  TCP$WRITE    TSX0  ! X66_AUTO_N
         3 000657   000046 000006                    ZERO    38,6

      269     3235    1      IF TCP_.P$$=ADDR(NIL) OR SOCKET>=TCP_.MAXSOCK THEN GOTO NOTSOCK;

   3235  3 000660   000003 236000 2                  LDQ     TCPBUF_+1
         3 000661   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000662   001270 600000 3                  TZE     NOTSOCK
         3 000663   200003 470500                    LDP0    @PRM1,,AUTO
         3 000664   000000 236100                    LDQ     0,,PR0
         3 000665   001270 604000 3                  TMI     NOTSOCK
         3 000666   000002 116000 2                  CMPQ    TCPBUF_
         3 000667   001270 605000 3                  TPL     NOTSOCK

      270     3236    1      TCP$ = TCP_DAT.PTR$(SOCKET);

   3236  3 000670   000000 720100                    LXL0    0,,PR0
         3 000671   000003 471400 2                  LDP1    TCPBUF_+1
         3 000672   100001 236110                    LDQ     1,X0,PR1
         3 000673   200023 756100                    STQ     TCP$,,AUTO

      271     3237    1      FLAGS = 0;

   3237  3 000674   200027 450100                    STZ     FLAGS,,AUTO

      272     3238    1      RESULT = VBOUND(PRM2_VEC)+1;

   3238  3 000675   200004 473500                    LDP3    @PRM2,,AUTO
         3 000676   300000 236100                    LDQ     0,,PR3
         3 000677   000020 772000                    QRL     16
         3 000700   000001 036007                    ADLQ    1,DL
         3 000701   200026 756100                    STQ     RESULT,,AUTO

      273     3239    1      P$ = VBASE(PRM2_VEC);

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:48   
   3239  3 000702   300001 236100                    LDQ     1,,PR3
         3 000703   200025 756100                    STQ     P$,,AUTO

      274     3240    1      IF P$=ADDR(NIL) THEN RESULT = 0;

   3240  3 000704   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000705   000707 601000 3                  TNZ     MORE_BLK

   3240  3 000706   200026 450100                    STZ     RESULT,,AUTO

   3240  3 000707                       MORE_BLK     null
      275     3241    1   MORE_BLK: ;
      276     3242    1      IF ADDR(URGENT)~=ADDR(NIL) THEN IF URGENT<0

   3242  3 000707   200006 236100                    LDQ     @MODE,,AUTO
         3 000710   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000711   000717 600000 3                  TZE     s:3244

   3242  3 000712   200006 470500                    LDP0    @MODE,,AUTO
         3 000713   000000 235100                    LDA     0,,PR0
         3 000714   000717 605000 3                  TPL     s:3244

      277     3243    1      THEN FLAGS = %XSL_MSG_OOB;

   3243  3 000715   000001 235007                    LDA     1,DL
         3 000716   200027 755100                    STA     FLAGS,,AUTO

      278     3244    2      IF FLAGS=0 THEN DO;

   3244  3 000717   200027 235100                    LDA     FLAGS,,AUTO
         3 000720   001022 601000 3                  TNZ     s:3261

      279     3245    2         IF TCP$INFO.BLKSIZ=0 THEN IF RESULT=0 THEN RETURN;

   3245  3 000721   200023 470500                    LDP0    TCP$,,AUTO
         3 000722   000002 235100                    LDA     2,,PR0
         3 000723   000746 601000 3                  TNZ     s:3252
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:49   

   3245  3 000724   200026 235100                    LDA     RESULT,,AUTO
         3 000725   000727 601000 3                  TNZ     s:3246

   3245  3 000726   000000 702200 xent               TSX2  ! X66_ARET

      280     3246    2         ELSE IF TCP_DAT.BLK$=ADDR(NIL) OR ADDR(PUSH)~=ADDR(NIL) AND PUSH

   3246  3 000727   000003 471400 2                  LDP1    TCPBUF_+1
         3 000730   100000 236100                    LDQ     0,,PR1
         3 000731   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000732   001022 600000 3                  TZE     s:3261
         3 000733   200005 236100                    LDQ     @PRM3,,AUTO
         3 000734   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000735   000741 600000 3                  TZE     s:3249
         3 000736   200005 473500                    LDP3    @PRM3,,AUTO
         3 000737   300000 234100                    SZN     0,,PR3
         3 000740   001022 604000 3                  TMI     s:3261

      281     3247    2         THEN EXIT;
      282     3248    3         ELSE DO;

      283     3249    3            TCP$INFO.BLK$ = TCP_DAT.BLK$;

   3249  3 000741   100000 236100                    LDQ     0,,PR1
         3 000742   000001 756100                    STQ     1,,PR0

      284     3250    3            TCP_DAT.BLK$ = ADDR(NIL);

   3250  3 000743   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000744   000003 471400 2                  LDP1    TCPBUF_+1
         3 000745   100000 756100                    STQ     0,,PR1

      285     3251    3         END;

      286     3252    2         IF RESULT=0 THEN EXIT;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:50   
   3252  3 000746   200026 235100                    LDA     RESULT,,AUTO
         3 000747   001022 600000 3                  TZE     s:3261

      287     3253    2         RESULT = MINIMUM (RESULT, TCP_BLKSIZE-TCP$INFO.BLKSIZ);

   3253  3 000750   000001 236000 2                  LDQ     TCP_BLKSIZE
         3 000751   000002 136100                    SBLQ    2,,PR0
         3 000752   200026 116100                    CMPQ    RESULT,,AUTO
         3 000753   000755 604400 3                  TMOZ    s:3253+5
         3 000754   200026 236100                    LDQ     RESULT,,AUTO
         3 000755   200026 756100                    STQ     RESULT,,AUTO

      288     3254    2         SUBSTR(TCP$INFO.BLK$->CHAR31,TCP$INFO.BLKSIZ,RESULT) =

   3254  3 000756   000001 471500                    LDP1    1,,PR0
         3 000757   000002 235100                    LDA     2,,PR0
         3 000760   200025 473500                    LDP3    P$,,AUTO
         3 000761   000000 620006                    EAX0    0,QL
         3 000762   200026 721100                    LXL1    RESULT,,AUTO
         3 000763   040145 100540                    MLR     fill='040'O
         3 000764   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         3 000765   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1

      289     3255    2           SUBSTR(P$->CHAR31,0,RESULT);
      290     3256    2         TCP$INFO.BLKSIZ = TCP$INFO.BLKSIZ+RESULT;

   3256  3 000766   000002 236100                    LDQ     2,,PR0
         3 000767   200026 036100                    ADLQ    RESULT,,AUTO
         3 000770   000002 756100                    STQ     2,,PR0

      291     3257    2         P$ = PINCRC(P$,RESULT);

   3257  3 000771   200026 236100                    LDQ     RESULT,,AUTO
         3 000772   000020 736000                    QLS     16
         3 000773   200025 036100                    ADLQ    P$,,AUTO
         3 000774   200025 756100                    STQ     P$,,AUTO

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:51   
      292     3258    2         RESULT = VBOUND(PRM2_VEC)+1-POFFC(P$,VBASE(PRM2_VEC));

   3258  3 000775   200004 471500                    LDP1    @PRM2,,AUTO
         3 000776   100001 236100                    LDQ     1,,PR1
         3 000777   000020 772000                    QRL     16
         3 001000   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 001001   200025 236100                    LDQ     P$,,AUTO
         3 001002   000020 772000                    QRL     16
         3 001003   200040 136100                    SBLQ    @HEP_SOCK+2,,AUTO
         3 001004   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001005   100000 236100                    LDQ     0,,PR1
         3 001006   000020 772000                    QRL     16
         3 001007   200041 136100                    SBLQ    @HEP_SOCK+3,,AUTO
         3 001010   000001 036007                    ADLQ    1,DL
         3 001011   200026 756100                    STQ     RESULT,,AUTO

      293     3259    2         IF RESULT=0 AND (ADDR(PUSH)=ADDR(NIL) OR NOT PUSH) THEN RETURN;

   3259  3 001012   001022 601000 3                  TNZ     s:3261
         3 001013   200005 236100                    LDQ     @PRM3,,AUTO
         3 001014   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001015   001021 600000 3                  TZE     s:3259+7
         3 001016   200005 473500                    LDP3    @PRM3,,AUTO
         3 001017   300000 234100                    SZN     0,,PR3
         3 001020   001022 604000 3                  TMI     s:3261

   3259  3 001021   000000 702200 xent               TSX2  ! X66_ARET

      294     3260    2      END;
      295     3261    2      IF TCP$INFO.BLKSIZ=0 THEN DO;

   3261  3 001022   200023 470500                    LDP0    TCP$,,AUTO
         3 001023   000002 235100                    LDA     2,,PR0
         3 001024   001034 601000 3                  TNZ     s:3266

      296     3262    2         TCP$INFO.BLK$ = P$;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:52   
   3262  3 001025   200025 236100                    LDQ     P$,,AUTO
         3 001026   000001 756100                    STQ     1,,PR0

      297     3263    2         TCP$INFO.BLKSIZ = RESULT;

   3263  3 001027   200026 235100                    LDA     RESULT,,AUTO
         3 001030   000002 755100                    STA     2,,PR0

      298     3264    2         RESULT = -1;

   3264  3 001031   000001 335007                    LCA     1,DL
         3 001032   200026 755100                    STA     RESULT,,AUTO

      299     3265    2      END;

   3265  3 001033   001035 710000 3                  TRA     s:3267

      300     3266    1      ELSE FLAGS = 0;                      /* Send urgent data by itself         */

   3266  3 001034   200027 450100                    STZ     FLAGS,,AUTO

      301     3267    1      CALL XSL$QSEND (FLAGS, SOCKET,

   3267  3 001035   000001 471500                    LDP1    1,,PR0
         3 001036   200027 633500                    EPPR3   FLAGS,,AUTO
         3 001037   200044 453500                    STP3    @HEP_SOCK+6,,AUTO
         3 001040   200023 236100                    LDQ     TCP$,,AUTO
         3 001041   000002 036003                    ADLQ    2,DU
         3 001042   200043 756100                    STQ     @HEP_SOCK+5,,AUTO
         3 001043   200042 451500                    STP1    @HEP_SOCK+4,,AUTO
         3 001044   200003 236100                    LDQ     @PRM1,,AUTO
         3 001045   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001046   200027 634500                    EPPR4   FLAGS,,AUTO
         3 001047   200040 454500                    STP4    @HEP_SOCK+2,,AUTO
         3 001050   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001051   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 001052   000000 701000 xent               TSX1    XSL$QSEND
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:53   
         3 001053   000000 011000                    NOP     0

      302     3268    1        TCP$INFO.BLK$->CHAR31, TCP$INFO.BLKSIZ, FLAGS);
      303     3269    1      TCP$INFO.BLKSIZ = 0;

   3269  3 001054   200023 470500                    LDP0    TCP$,,AUTO
         3 001055   000002 450100                    STZ     2,,PR0

      304     3270    1      IF TCP$INFO.BLK$~=P$ THEN TCP_DAT.BLK$ = TCP$INFO.BLK$;

   3270  3 001056   000001 236100                    LDQ     1,,PR0
         3 001057   200025 116100                    CMPQ    P$,,AUTO
         3 001060   001063 600000 3                  TZE     s:3271

   3270  3 001061   000003 471400 2                  LDP1    TCPBUF_+1
         3 001062   100000 756100                    STQ     0,,PR1

      305     3271    1      TCP$INFO.BLK$ = ADDR(NIL);

   3271  3 001063   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 001064   000001 756100                    STQ     1,,PR0

      306     3272    1      IF FLAGS<0 THEN GOTO ERRRET;

   3272  3 001065   200027 235100                    LDA     FLAGS,,AUTO
         3 001066   000311 604000 3                  TMI     NOSOCKET

      307     3273    1      IF RESULT>0 THEN GOTO MORE_BLK;

   3273  3 001067   200026 235100                    LDA     RESULT,,AUTO
         3 001070   000707 605400 3                  TPNZ    MORE_BLK

      308     3274    1      RETURN;

   3274  3 001071   000000 702200 xent               TSX2  ! X66_ARET

      309     3275
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:54   
      310     3276    1   TCP$READ: ENTRY (PRM1, PRM2, PRM3) ALTRET;

   3276  3 001072   000000 700200 xent  TCP$READ     TSX0  ! X66_AUTO_N
         3 001073   000046 000006                    ZERO    38,6

      311     3277    1      IF TCP_.P$$=ADDR(NIL) OR SOCKET>=TCP_.MAXSOCK THEN GOTO NOTSOCK;

   3277  3 001074   000003 236000 2                  LDQ     TCPBUF_+1
         3 001075   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001076   001270 600000 3                  TZE     NOTSOCK
         3 001077   200003 470500                    LDP0    @PRM1,,AUTO
         3 001100   000000 236100                    LDQ     0,,PR0
         3 001101   001270 604000 3                  TMI     NOTSOCK
         3 001102   000002 116000 2                  CMPQ    TCPBUF_
         3 001103   001270 605000 3                  TPL     NOTSOCK

      312     3278    1      TCP$ = TCP_DAT.PTR$(SOCKET);

   3278  3 001104   000000 720100                    LXL0    0,,PR0
         3 001105   000003 471400 2                  LDP1    TCPBUF_+1
         3 001106   100001 236110                    LDQ     1,X0,PR1
         3 001107   200023 756100                    STQ     TCP$,,AUTO

      313     3279    1      PRM3_CB.ADMIN = '1'B;

   3279  3 001110   200005 473500                    LDP3    @PRM3,,AUTO
         3 001111   400000 236003                    LDQ     -131072,DU
         3 001112   300000 256100                    ORSQ    0,,PR3

      314     3280    2      IF TCP$INFO.RESET THEN DO;

   3280  3 001113   200023 471500                    LDP1    TCP$,,AUTO
         3 001114   100000 236100                    LDQ     0,,PR1
         3 001115   100000 316003                    CANQ    32768,DU
         3 001116   001124 600000 3                  TZE     s:3284

      315     3281    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSED;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:55   

   3281  3 001117   200004 474500                    LDP4    @PRM2,,AUTO
         3 001120   400001 475500                    LDP5    1,,PR4
         3 001121   000007 235007                    LDA     7,DL
         3 001122   500000 755100                    STA     0,,PR5

      316     3282    2         RETURN;

   3282  3 001123   000000 702200 xent               TSX2  ! X66_ARET

      317     3283    2      END;
      318     3284    2      IF TCP$INFO.CLOSING THEN DO;

   3284  3 001124   020000 316003                    CANQ    8192,DU
         3 001125   001133 600000 3                  TZE     s:3288

      319     3285    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSING;

   3285  3 001126   200004 474500                    LDP4    @PRM2,,AUTO
         3 001127   400001 475500                    LDP5    1,,PR4
         3 001130   000005 235007                    LDA     5,DL
         3 001131   500000 755100                    STA     0,,PR5

      320     3286    2         RETURN;

   3286  3 001132   000000 702200 xent               TSX2  ! X66_ARET

      321     3287    2      END;
      322     3288    2      IF TCP$INFO.CONNECTED THEN DO;

   3288  3 001133   010000 316003                    CANQ    4096,DU
         3 001134   001144 600000 3                  TZE     s:3293

      323     3289    2         TCP$INFO.CONNECTED = '0'B;

   3289  3 001135   000016 236000 4                  LDQ     14
         3 001136   100000 356100                    ANSQ    0,,PR1
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:56   

      324     3290    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_ESTABLISHED;

   3290  3 001137   200004 474500                    LDP4    @PRM2,,AUTO
         3 001140   400001 475500                    LDP5    1,,PR4
         3 001141   000003 235007                    LDA     3,DL
         3 001142   500000 755100                    STA     0,,PR5

      325     3291    2         RETURN;

   3291  3 001143   000000 702200 xent               TSX2  ! X66_ARET

      326     3292    2      END;
      327     3293    2      IF TCP$INFO.LISTEN THEN DO;

   3293  3 001144   100000 234100                    SZN     0,,PR1
         3 001145   001210 605000 3                  TPL     s:3304

      328     3294    2         RESULT = SOCKET;

   3294  3 001146   000000 235100                    LDA     0,,PR0
         3 001147   200026 755100                    STA     RESULT,,AUTO

      329     3295    2         CALL ACCEPT (PRM3_CB, VBASE(PRM2_VEC)->TCP$ADMIN) ALTRET (ERRRET);

   3295  3 001150   200004 474500                    LDP4    @PRM2,,AUTO
         3 001151   400001 475500                    LDP5    1,,PR4
         3 001152   200032 455500                    STP5    @TCP_CB+1,,AUTO
         3 001153   200005 236100                    LDQ     @PRM3,,AUTO
         3 001154   200031 756100                    STQ     FLAGS+2,,AUTO
         3 001155   001513 701000 3                  TSX1    ACCEPT
         3 001156   000311 702000 3                  TSX2    NOSOCKET

      330     3296    3         IF TCP$INFO.PASSIVE THEN DO;

   3296  3 001157   200023 470500                    LDP0    TCP$,,AUTO
         3 001160   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:57   
         3 001161   040000 316003                    CANQ    16384,DU
         3 001162   001207 600000 3                  TZE     s:3302

      331     3297    3            VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_ESTABLISHED;

   3297  3 001163   200004 471500                    LDP1    @PRM2,,AUTO
         3 001164   100001 473500                    LDP3    1,,PR1
         3 001165   000003 235007                    LDA     3,DL
         3 001166   300000 755100                    STA     0,,PR3

      332     3298    3            TCP$INFO = '0'B;

   3298  3 001167   000100 100400                    MLR     fill='000'O
         3 001170   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001171   000000 000030                    ADSC9   0,,PR0                   cn=0,n=24

      333     3299    3            CALL XSL$QCLOSE (RESULT, SOCKET);

   3299  3 001172   200003 236100                    LDQ     @PRM1,,AUTO
         3 001173   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001174   200026 633500                    EPPR3   RESULT,,AUTO
         3 001175   200040 453500                    STP3    @HEP_SOCK+2,,AUTO
         3 001176   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001177   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001200   000000 701000 xent               TSX1    XSL$QCLOSE
         3 001201   000000 011000                    NOP     0

      334     3300    3            SOCKET = VBASE(PRM2_VEC)->TCP$ADMIN.NEWLCN;

   3300  3 001202   200004 470500                    LDP0    @PRM2,,AUTO
         3 001203   000001 471500                    LDP1    1,,PR0
         3 001204   200003 473500                    LDP3    @PRM1,,AUTO
         3 001205   100003 235100                    LDA     3,,PR1
         3 001206   300000 755100                    STA     0,,PR3

      335     3301    3         END;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:58   
      336     3302    2         RETURN;

   3302  3 001207   000000 702200 xent               TSX2  ! X66_ARET

      337     3303    2      END;
      338     3304    1      CALL XSL$QRECV (PRM3_CB.ARS, SOCKET,

   3304  3 001210   200004 474500                    LDP4    @PRM2,,AUTO
         3 001211   400001 475500                    LDP5    1,,PR4
         3 001212   400000 236100                    LDQ     0,,PR4
         3 001213   000020 772000                    QRL     16
         3 001214   000001 036007                    ADLQ    1,DL
         3 001215   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 001216   000017 236000 4                  LDQ     15
         3 001217   200045 756100                    STQ     @HEP_SOCK+7,,AUTO
         3 001220   200040 636500                    EPPR6   @HEP_SOCK+2,,AUTO
         3 001221   200044 456500                    STP6    @HEP_SOCK+6,,AUTO
         3 001222   200043 455500                    STP5    @HEP_SOCK+5,,AUTO
         3 001223   200003 236100                    LDQ     @PRM1,,AUTO
         3 001224   200042 756100                    STQ     @HEP_SOCK+4,,AUTO
         3 001225   200005 236100                    LDQ     @PRM3,,AUTO
         3 001226   000001 036003                    ADLQ    1,DU
         3 001227   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001230   200041 630500                    EPPR0   @HEP_SOCK+3,,AUTO
         3 001231   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 001232   000000 701000 xent               TSX1    XSL$QRECV
         3 001233   001235 702000 3                  TSX2    s:3306
         3 001234   001250 710000 3                  TRA     s:3312

      339     3305    2        VBASE(PRM2_VEC)->CHAR31, VBOUND(PRM2_VEC)+1, 0) WHENALTRETURN DO;

      340     3306    2         IF XSL_ERRNO ~= %E$CONNRESET THEN GOTO ERRRET;

   3306  3 001235   000000 235000 xsym               LDA     XSL_ERRNO
         3 001236   000161 115007                    CMPA    113,DL
         3 001237   000311 601000 3                  TNZ     NOSOCKET

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:59   
      341     3307    2   ZERO_RESULT:
      342     3308    2         VBASE(PRM2_VEC)->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSE_WAIT;

   3308  3 001240   200004 470500       ZERO_RESULT  LDP0    @PRM2,,AUTO
         3 001241   000001 471500                    LDP1    1,,PR0
         3 001242   000006 235007                    LDA     6,DL
         3 001243   100000 755100                    STA     0,,PR1

      343     3309    2         TCP$INFO.RESET = '1'B;

   3309  3 001244   200023 471500                    LDP1    TCP$,,AUTO
         3 001245   100000 236003                    LDQ     32768,DU
         3 001246   100000 256100                    ORSQ    0,,PR1

      344     3310    2         RETURN;

   3310  3 001247   000000 702200 xent               TSX2  ! X66_ARET

      345     3311    2      END;
      346     3312    1      IF PRM3_CB.ARS = 0 THEN GOTO ZERO_RESULT;

   3312  3 001250   200005 470500                    LDP0    @PRM3,,AUTO
         3 001251   000001 235100                    LDA     1,,PR0
         3 001252   001240 600000 3                  TZE     ZERO_RESULT

      347     3313    1      PRM3_CB.ADMIN = '0'B;

   3313  3 001253   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 001254   000000 356100                    ANSQ    0,,PR0

      348     3314    1      RETURN;

   3314  3 001255   000000 702200 xent               TSX2  ! X66_ARET

      349     3315
      350     3316    1   TCP$READ_NW: ENTRY (PRM1, PRM2, PRM3) ALTRET;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:60   
   3316  3 001256   000000 700200 xent  TCP$READ_NW  TSX0  ! X66_AUTO_N
         3 001257   000046 000006                    ZERO    38,6

      351     3317    2      IF TCP_.P$$=ADDR(NIL) OR SOCKET>TCP_.MAXSOCK THEN DO;

   3317  3 001260   000003 236000 2                  LDQ     TCPBUF_+1
         3 001261   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001262   001270 600000 3                  TZE     NOTSOCK
         3 001263   200003 470500                    LDP0    @PRM1,,AUTO
         3 001264   000000 236100                    LDQ     0,,PR0
         3 001265   001270 604000 3                  TMI     NOTSOCK
         3 001266   000002 116000 2                  CMPQ    TCPBUF_
         3 001267   001273 604400 3                  TMOZ    s:3322

      352     3318    2   NOTSOCK:;

   3318  3 001270                       NOTSOCK      null
      353     3319    2         XSL_ERRNO = %E$NOTSOCK;

   3319  3 001270   000141 235007                    LDA     97,DL
         3 001271   000000 755000 xsym               STA     XSL_ERRNO

      354     3320    2         GOTO ERRRET;

   3320  3 001272   000311 710000 3                  TRA     NOSOCKET

      355     3321    2      END;
      356     3322    1      TCP$ = TCP_DAT.PTR$(SOCKET);

   3322  3 001273   000000 720100                    LXL0    0,,PR0
         3 001274   000003 471400 2                  LDP1    TCPBUF_+1
         3 001275   100001 236110                    LDQ     1,X0,PR1
         3 001276   200023 756100                    STQ     TCP$,,AUTO

      357     3323    1      TCP$INFO.CB$ = ADDR(PRM3);

   3323  3 001277   200005 236100                    LDQ     @PRM3,,AUTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:61   
         3 001300   200023 473500                    LDP3    TCP$,,AUTO
         3 001301   300003 756100                    STQ     3,,PR3

      358     3324    1      TCP$INFO.ARS = VBOUND(PRM2_VEC)+1;

   3324  3 001302   200004 471500                    LDP1    @PRM2,,AUTO
         3 001303   100000 236100                    LDQ     0,,PR1
         3 001304   000020 772000                    QRL     16
         3 001305   000001 036007                    ADLQ    1,DL
         3 001306   300004 756100                    STQ     4,,PR3

      359     3325    1      TCP$INFO.BUF$ = VBASE(PRM2_VEC);

   3325  3 001307   100001 236100                    LDQ     1,,PR1
         3 001310   300005 756100                    STQ     5,,PR3

      360     3326    1      TCP$INFO.NOWAIT = '1'B;

   3326  3 001311   200000 236003                    LDQ     65536,DU
         3 001312   300000 256100                    ORSQ    0,,PR3

      361     3327    1      RETURN;

   3327  3 001313   000000 702200 xent               TSX2  ! X66_ARET

      362     3328        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:62   
      363     3329    1   TCP$WAIT1: ENTRY (PRM1, PRM2) ALTRET;

   3329  3 001314   000000 700200 xent  TCP$WAIT1    TSX0  ! X66_AUTO_N
         3 001315   000046 000006                    ZERO    38,6

      364     3330    1      FLAGS = 0;

   3330  3 001316   200027 450100                    STZ     FLAGS,,AUTO

      365     3331    2      IF TCP_.P$$=ADDR(NIL) THEN DO;

   3331  3 001317   000003 236000 2                  LDQ     TCPBUF_+1
         3 001320   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001321   001330 601000 3                  TNZ     s:3335

      366     3332    3         CALL M$WAIT (FPT_FOREVER) WHENALTRETURN DO; END;

   3332  3 001322   000004 630400 1                  EPPR0   FPT_FOREVER
         3 001323   420006 713400                    CLIMB   alt,+8198
         3 001324   400400 401760                    pmme    nvectors=2
         3 001325   001327 702000 3                  TSX2    s:3333
         3 001326   001327 710000 3                  TRA     s:3333

      367     3333    2         RETURN;

   3333  3 001327   000000 702200 xent               TSX2  ! X66_ARET

      368     3334    2      END;
      369     3335    2      DO RESULT=0 TO TCP_.MAXSOCK-1;

   3335  3 001330   200026 450100                    STZ     RESULT,,AUTO
         3 001331   001354 710000 3                  TRA     s:3341+1

      370     3336    3         IF TCP_DAT.PTR$(RESULT)->TCP$INFO.NOWAIT THEN DO;

   3336  3 001332   000003 470400 2                  LDP0    TCPBUF_+1
         3 001333   200026 720100                    LXL0    RESULT,,AUTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:63   
         3 001334   000001 471510                    LDP1    1,X0,PR0
         3 001335   100000 236100                    LDQ     0,,PR1
         3 001336   200000 316003                    CANQ    65536,DU
         3 001337   001353 600000 3                  TZE     s:3341

      371     3337    3            FLAGBITS = FLAGBITS | BITS(RESULT);

   3337  3 001340   200027 236100                    LDQ     FLAGS,,AUTO
         3 001341   000020 276010 1                  ORQ     CBITS,X0
         3 001342   200027 756100                    STQ     FLAGS,,AUTO

      372     3338    3            TCP_DAT.PTR$(RESULT)->TCP$INFO.CB$->TCP$CB.READ_COMPLETE = '0'B;

   3338  3 001343   000001 471510                    LDP1    1,X0,PR0
         3 001344   100003 473500                    LDP3    3,,PR1
         3 001345   300003 450100                    STZ     3,,PR3

      373     3339    3            TCP_DAT.PTR$(RESULT)->TCP$INFO.CB$->TCP$CB.ADMIN = '0'B;

   3339  3 001346   000003 470400 2                  LDP0    TCPBUF_+1
         3 001347   200026 720100                    LXL0    RESULT,,AUTO
         3 001350   000001 471510                    LDP1    1,X0,PR0
         3 001351   100003 473500                    LDP3    3,,PR1
         3 001352   300000 450100                    STZ     0,,PR3

      374     3340    3         END;

      375     3341    2      END;

   3341  3 001353   200026 054100                    AOS     RESULT,,AUTO
         3 001354   200026 236100                    LDQ     RESULT,,AUTO
         3 001355   000002 116000 2                  CMPQ    TCPBUF_
         3 001356   001332 604000 3                  TMI     s:3336

      376     3342    1      RESULT = FLAGS;

   3342  3 001357   200027 235100                    LDA     FLAGS,,AUTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:64   
         3 001360   200026 755100                    STA     RESULT,,AUTO

      377     3343    1      CALL XSL$QSELECT (P$, TCP_.MAXSOCK, FLAGS, , RESULT, SOCKET);

   3343  3 001361   200003 236100                    LDQ     @PRM1,,AUTO
         3 001362   200045 756100                    STQ     @HEP_SOCK+7,,AUTO
         3 001363   200026 630500                    EPPR0   RESULT,,AUTO
         3 001364   200044 450500                    STP0    @HEP_SOCK+6,,AUTO
         3 001365   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 001366   200043 756100                    STQ     @HEP_SOCK+5,,AUTO
         3 001367   200027 631500                    EPPR1   FLAGS,,AUTO
         3 001370   200042 451500                    STP1    @HEP_SOCK+4,,AUTO
         3 001371   000020 236000 4                  LDQ     16
         3 001372   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001373   200025 633500                    EPPR3   P$,,AUTO
         3 001374   200040 453500                    STP3    @HEP_SOCK+2,,AUTO
         3 001375   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001376   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 001377   000000 701000 xent               TSX1    XSL$QSELECT
         3 001400   000000 011000                    NOP     0

      378     3344    1      FLAGBITS = FLAGBITS | BINBIT(RESULT,36);

   3344  3 001401   200026 236100                    LDQ     RESULT,,AUTO
         3 001402   200027 276100                    ORQ     FLAGS,,AUTO
         3 001403   200027 756100                    STQ     FLAGS,,AUTO

      379     3345    2      DO RESULT=0 TO 35;

   3345  3 001404   200026 450100                    STZ     RESULT,,AUTO

      380     3346    3         IF FLAGBITS & BITS(RESULT) THEN DO;

   3346  3 001405   200026 720100                    LXL0    RESULT,,AUTO
         3 001406   200027 236100                    LDQ     FLAGS,,AUTO
         3 001407   000020 376010 1                  ANQ     CBITS,X0
         3 001410   001506 600000 3                  TZE     s:3370
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:65   

      381     3347    3            TCP$ = TCP_DAT.PTR$(RESULT);

   3347  3 001411   000003 470400 2                  LDP0    TCPBUF_+1
         3 001412   000001 236110                    LDQ     1,X0,PR0
         3 001413   200023 756100                    STQ     TCP$,,AUTO

      382     3348    4            IF TCP$INFO.LISTEN THEN DO;

   3348  3 001414   200023 471500                    LDP1    TCP$,,AUTO
         3 001415   100000 234100                    SZN     0,,PR1
         3 001416   001426 605000 3                  TPL     s:3352

      383     3349    4               CALL ACCEPT (TCP$INFO.CB$->TCP$CB, TCP$INFO.BUF$->TCP$ADMIN)

   3349  3 001417   100003 473500                    LDP3    3,,PR1
         3 001420   100005 474500                    LDP4    5,,PR1
         3 001421   200032 454500                    STP4    @TCP_CB+1,,AUTO
         3 001422   200031 453500                    STP3    FLAGS+2,,AUTO
         3 001423   001513 701000 3                  TSX1    ACCEPT
         3 001424   001453 702000 3                  TSX2    WAIT_ERR

      384     3350    4                 ALTRET(WAIT_ERR);
      385     3351    4            END; ELSE DO;

   3351  3 001425   001500 710000 3                  TRA     s:3367

      386     3352    4               CALL XSL$QRECV (TCP$INFO.CB$->TCP$CB.ARS, RESULT,

   3352  3 001426   100003 473500                    LDP3    3,,PR1
         3 001427   100005 474500                    LDP4    5,,PR1
         3 001430   000017 236000 4                  LDQ     15
         3 001431   200044 756100                    STQ     @HEP_SOCK+6,,AUTO
         3 001432   200023 236100                    LDQ     TCP$,,AUTO
         3 001433   000004 036003                    ADLQ    4,DU
         3 001434   200043 756100                    STQ     @HEP_SOCK+5,,AUTO
         3 001435   200042 454500                    STP4    @HEP_SOCK+4,,AUTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:66   
         3 001436   200026 635500                    EPPR5   RESULT,,AUTO
         3 001437   200041 455500                    STP5    @HEP_SOCK+3,,AUTO
         3 001440   300001 636500                    EPPR6   1,,PR3
         3 001441   200040 456500                    STP6    @HEP_SOCK+2,,AUTO
         3 001442   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001443   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 001444   000000 701000 xent               TSX1    XSL$QRECV
         3 001445   001453 702000 3                  TSX2    WAIT_ERR

      387     3353    4                 TCP$INFO.BUF$->CHAR31, TCP$INFO.ARS, 0)
      388     3354    5               WHENRETURN DO;

      389     3355    5                  IF TCP$INFO.CB$->TCP$CB.ARS = 0 THEN GOTO WAIT_ERR;

   3355  3 001446   200023 470500                    LDP0    TCP$,,AUTO
         3 001447   000003 471500                    LDP1    3,,PR0
         3 001450   100001 235100                    LDA     1,,PR1
         3 001451   001453 600000 3                  TZE     WAIT_ERR

      390     3356    5               END;

   3356  3 001452   001500 710000 3                  TRA     s:3367

      391     3357    5               WHENALTRETURN DO;

   3355  3 001453                       WAIT_ERR     null
      392     3358    5   WAIT_ERR:      ;
      393     3359    5                  TCP$INFO.CB$->TCP$CB.ADMIN = '1'B;

   3359  3 001453   200023 470500                    LDP0    TCP$,,AUTO
         3 001454   000003 471500                    LDP1    3,,PR0
         3 001455   400000 236003                    LDQ     -131072,DU
         3 001456   100000 756100                    STQ     0,,PR1

      394     3360    5                  TCP$INFO.BUF$->TCP$ADMIN.CMD = %TCP_ADMINMSG_CLOSED;

   3360  3 001457   000005 471500                    LDP1    5,,PR0
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:67   
         3 001460   000007 235007                    LDA     7,DL
         3 001461   100000 755100                    STA     0,,PR1

      395     3361    5                  TCP$INFO.RESET = '1'B;

   3361  3 001462   100000 236003                    LDQ     32768,DU
         3 001463   000000 256100                    ORSQ    0,,PR0

      396     3362    5                  IF XSL_ERRNO=%E$FAILURE

   3362  3 001464   000000 235000 xsym               LDA     XSL_ERRNO
         3 001465   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 001466   001474 601000 3                  TNZ     s:3364

      397     3363    5                  THEN TCP_MON_ERR = B$TCB.ALT$->B$ALT.ERR;

   3363  3 001467   000000 471400 xsym               LDP1    B$TCB$
         3 001470   100000 473500                    LDP3    0,,PR1
         3 001471   300102 236100                    LDQ     66,,PR3
         3 001472   000000 756000 xsym               STQ     TCP_MON_ERR
         3 001473   001500 710000 3                  TRA     s:3367

      398     3364    5                  ELSE TCP_MON_ERR = '302314'O|BINBIT(XSL_ERRNO,33);

   3364  3 001474   000000 236000 xsym               LDQ     XSL_ERRNO
         3 001475   000003 736000                    QLS     3
         3 001476   302314 276003                    ORQ     99532,DU
         3 001477   000000 756000 xsym               STQ     TCP_MON_ERR

      399     3365    5               END;

      400     3366    4            END;

      401     3367    3            TCP$INFO.NOWAIT = '0'B;

   3367  3 001500   200023 470500                    LDP0    TCP$,,AUTO
         3 001501   000021 236000 4                  LDQ     17
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:68   
         3 001502   000000 356100                    ANSQ    0,,PR0

      402     3368    3            TCP$INFO.CB$->TCP$CB.READ_COMPLETE = '1'B;

   3368  3 001503   000003 471500                    LDP1    3,,PR0
         3 001504   400000 236003                    LDQ     -131072,DU
         3 001505   100003 756100                    STQ     3,,PR1

      403     3369    3         END;

      404     3370    2      END;

   3370  3 001506   200026 054100                    AOS     RESULT,,AUTO
         3 001507   200026 235100                    LDA     RESULT,,AUTO
         3 001510   000043 115007                    CMPA    35,DL
         3 001511   001405 604400 3                  TMOZ    s:3346

      405     3371    1      RETURN;

   3371  3 001512   000000 702200 xent               TSX2  ! X66_ARET

      406     3372
      407     3373        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:69   
      408     3374    1   ACCEPT: PROC (TCP_CB, TCP_ADMIN) ALTRET;

   3374  3 001513   200030 741300       ACCEPT       STX1  ! FLAGS+1,,AUTO

      409     3375        %TCP$CB (NAME=TCP_CB, STCLASS=);
      410     3378        %TCP$ADMIN (NAME=TCP_ADMIN, STCLASS=);
      411     3399
      412     3400    2      TCP_CB.ARS = 8;

   3400  3 001514   000010 235007                    LDA     8,DL
         3 001515   200031 470500                    LDP0    @TCP_CB,,AUTO
         3 001516   000001 755100                    STA     1,,PR0

      413     3401    2      CALL XSL$QACCEPT (TCP_ADMIN.NEWLCN, RESULT, PEER_SOCK, TCP_CB.ARS)

   3401  3 001517   200031 236100                    LDQ     @TCP_CB,,AUTO
         3 001520   000001 036003                    ADLQ    1,DU
         3 001521   200043 756100                    STQ     @HEP_SOCK+5,,AUTO
         3 001522   200016 631500                    EPPR1   PEER_SOCK,,AUTO
         3 001523   200042 451500                    STP1    @HEP_SOCK+4,,AUTO
         3 001524   200026 633500                    EPPR3   RESULT,,AUTO
         3 001525   200041 453500                    STP3    @HEP_SOCK+3,,AUTO
         3 001526   200032 236100                    LDQ     @TCP_ADMIN,,AUTO
         3 001527   000003 036003                    ADLQ    3,DU
         3 001530   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 001531   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001532   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001533   000000 701000 xent               TSX1    XSL$QACCEPT
         3 001534   001565 702000 3                  TSX2    ERRRET

      414     3402    2        ALTRET (ERRRET);
      415     3403    2      CALL XSL$QGETSOCKNAME (P$, TCP_ADMIN.NEWLCN, LOCAL_SOCK, TCP_CB.ARS)

   3403  3 001535   200031 236100                    LDQ     @TCP_CB,,AUTO
         3 001536   000001 036003                    ADLQ    1,DU
         3 001537   200043 756100                    STQ     @HEP_SOCK+5,,AUTO
         3 001540   200011 630500                    EPPR0   LOCAL_SOCK,,AUTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:70   
         3 001541   200042 450500                    STP0    @HEP_SOCK+4,,AUTO
         3 001542   200032 236100                    LDQ     @TCP_ADMIN,,AUTO
         3 001543   000003 036003                    ADLQ    3,DU
         3 001544   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001545   200025 631500                    EPPR1   P$,,AUTO
         3 001546   200040 451500                    STP1    @HEP_SOCK+2,,AUTO
         3 001547   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001550   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001551   000000 701000 xent               TSX1    XSL$QGETSOCKNAME
         3 001552   001554 702000 3                  TSX2    s:3405
         3 001553   001567 710000 3                  TRA     s:3409

      416     3404    3      WHENALTRETURN DO;

      417     3405    3         CALL XSL$QCLOSE (RESULT, TCP_ADMIN.NEWLCN);

   3405  3 001554   200032 236100                    LDQ     @TCP_ADMIN,,AUTO
         3 001555   000003 036003                    ADLQ    3,DU
         3 001556   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001557   200026 630500                    EPPR0   RESULT,,AUTO
         3 001560   200040 450500                    STP0    @HEP_SOCK+2,,AUTO
         3 001561   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001562   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001563   000000 701000 xent               TSX1    XSL$QCLOSE
         3 001564   000000 011000                    NOP     0

   3405  3 001565                       ERRRET       null
      418     3406    3   ERRRET: ;
      419     3407    3         ALTRETURN;

   3407  3 001565   200030 221300                    LDX1  ! FLAGS+1,,AUTO
         3 001566   000000 702211                    TSX2  ! 0,X1

      420     3408    3      END;
      421     3409    2      TCP_DAT.PTR$(TCP_ADMIN.NEWLCN)->TCP$INFO = '0'B;

   3409  3 001567   200032 470500                    LDP0    @TCP_ADMIN,,AUTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:71   
         3 001570   000003 720100                    LXL0    3,,PR0
         3 001571   000003 471400 2                  LDP1    TCPBUF_+1
         3 001572   100001 473510                    LDP3    1,X0,PR1
         3 001573   000100 100400                    MLR     fill='000'O
         3 001574   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001575   300000 000030                    ADSC9   0,,PR3                   cn=0,n=24

      422     3410    2      TCP_CB.ARS = SIZEC(TCP$ADMIN);

   3410  3 001576   000060 235007                    LDA     48,DL
         3 001577   200031 471500                    LDP1    @TCP_CB,,AUTO
         3 001600   100001 755100                    STA     1,,PR1

      423     3411    2      TCP_CB.ADMIN = '1'B;

   3411  3 001601   400000 236003                    LDQ     -131072,DU
         3 001602   100000 756100                    STQ     0,,PR1

      424     3412    2      TCP_ADMIN.CMD = %TCP_ADMINMSG_LISTEN_RESPONSE;

   3412  3 001603   000001 235007                    LDA     1,DL
         3 001604   000000 755100                    STA     0,,PR0

      425     3413    2      CALL XSLSOCK_2_HEPSOCK (PEER_SOCK, TCP_ADMIN.FS);

   3413  3 001605   200032 236100                    LDQ     @TCP_ADMIN,,AUTO
         3 001606   000012 036003                    ADLQ    10,DU
         3 001607   200036 756100                    STQ     @HEP_SOCK,,AUTO
         3 001610   200016 633500                    EPPR3   PEER_SOCK,,AUTO
         3 001611   200035 453500                    STP3    @XSL_SOCK,,AUTO
         3 001612   000437 701000 3                  TSX1    XSLSOCK_2_HEPSOCK
         3 001613   000000 011000                    NOP     0

      426     3414    2      CALL XSLSOCK_2_HEPSOCK (LOCAL_SOCK, TCP_ADMIN.LS);

   3414  3 001614   200032 236100                    LDQ     @TCP_ADMIN,,AUTO
         3 001615   000010 036003                    ADLQ    8,DU
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:72   
         3 001616   200036 756100                    STQ     @HEP_SOCK,,AUTO
         3 001617   200011 630500                    EPPR0   LOCAL_SOCK,,AUTO
         3 001620   200035 450500                    STP0    @XSL_SOCK,,AUTO
         3 001621   000437 701000 3                  TSX1    XSLSOCK_2_HEPSOCK
         3 001622   000000 011000                    NOP     0

      427     3415    2      RETURN;

   3415  3 001623   200030 221300                    LDX1  ! FLAGS+1,,AUTO
         3 001624   000001 702211                    TSX2  ! 1,X1

      428     3416    2   END ACCEPT;
      429     3417
      430     3418        %EJECT;
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:73   
      431     3419    1   NET$IP2ADDR: ENTRY (PRM1, PRM2) ALTRET;

   3419  3 001625   000000 700200 xent  NET$IP2ADDR  TSX0  ! X66_AUTO_N
         3 001626   000046 000006                    ZERO    38,6

      432     3420    1      CALL XSL$INET_ADDR (RESULT, PRM2) ALTRET(ERRRET);

   3420  3 001627   200004 236100                    LDQ     @PRM2,,AUTO
         3 001630   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001631   200026 630500                    EPPR0   RESULT,,AUTO
         3 001632   200040 450500                    STP0    @HEP_SOCK+2,,AUTO
         3 001633   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001634   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001635   000000 701000 xent               TSX1    XSL$INET_ADDR
         3 001636   000311 702000 3                  TSX2    NOSOCKET

      433     3421    2      CALL XSL$INET_ADDR (RESULT, PRM2) WHENALTRETURN DO; ALTRETURN; END;

   3421  3 001637   200004 236100                    LDQ     @PRM2,,AUTO
         3 001640   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001641   200026 630500                    EPPR0   RESULT,,AUTO
         3 001642   200040 450500                    STP0    @HEP_SOCK+2,,AUTO
         3 001643   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001644   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001645   000000 701000 xent               TSX1    XSL$INET_ADDR
         3 001646   001650 702000 3                  TSX2    s:3421+9
         3 001647   001651 710000 3                  TRA     s:3422

   3421  3 001650   000000 702200 xent               TSX2  ! X66_AALT

      434     3422    1      GOTO COMMON;

   3422  3 001651   001657 710000 3                  TRA     COMMON

      435     3423    1   NET$IP2ADDRX: ENTRY (PRM1, PRM2) ALTRET;

   3423  3 001652   000000 700200 xent  NET$IP2ADDRX TSX0  ! X66_AUTO_N
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:74   
         3 001653   000046 000006                    ZERO    38,6

      436     3424    1      RESULT = PRM2U;

   3424  3 001654   200004 470500                    LDP0    @PRM2,,AUTO
         3 001655   000000 235100                    LDA     0,,PR0
         3 001656   200026 755100                    STA     RESULT,,AUTO

      437     3425    1   COMMON:
      438     3426    1      CALL XSL$NTOHL (RESULT, RESULT);

   3426  3 001657   200026 630500       COMMON       EPPR0   RESULT,,AUTO
         3 001660   200041 450500                    STP0    @HEP_SOCK+3,,AUTO
         3 001661   200026 631500                    EPPR1   RESULT,,AUTO
         3 001662   200040 451500                    STP1    @HEP_SOCK+2,,AUTO
         3 001663   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001664   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001665   000000 701000 xent               TSX1    XSL$NTOHL
         3 001666   000000 011000                    NOP     0

      439     3427    1      SOCKET = RESULT*16;

   3427  3 001667   200026 235100                    LDA     RESULT,,AUTO
         3 001670   000004 735000                    ALS     4
         3 001671   200003 470500                    LDP0    @PRM1,,AUTO
         3 001672   000000 755100                    STA     0,,PR0

      440     3428    1      RETURN;

   3428  3 001673   000000 702200 xent               TSX2  ! X66_ARET

      441     3429
      442     3430    1   NET$ADDR2NAME: ENTRY (PRM1, PRM2) ALTRET;

   3430  3 001674   000000 700200 xent  NET$ADDR2NA* TSX0  ! X66_AUTO_N
         3 001675   000046 000006                    ZERO    38,6

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:75   
      443     3431    1      RESULT = PRM2U/16;

   3431  3 001676   200004 470500                    LDP0    @PRM2,,AUTO
         3 001677   000000 236100                    LDQ     0,,PR0
         3 001700   000004 772000                    QRL     4
         3 001701   200026 756100                    STQ     RESULT,,AUTO

      444     3432    1      CALL XSL$HTONL(RESULT, RESULT);

   3432  3 001702   200026 631500                    EPPR1   RESULT,,AUTO
         3 001703   200041 451500                    STP1    @HEP_SOCK+3,,AUTO
         3 001704   200026 633500                    EPPR3   RESULT,,AUTO
         3 001705   200040 453500                    STP3    @HEP_SOCK+2,,AUTO
         3 001706   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001707   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001710   000000 701000 xent               TSX1    XSL$HTONL
         3 001711   000000 011000                    NOP     0

      445     3433    1      CALL XSL$GETHOSTBYADDR (P$, RESULT, 4, %XSL_AF_INET) ALTRET(ERRRET);

   3433  3 001712   000022 237000 4                  LDAQ    18
         3 001713   200042 757100                    STAQ    @HEP_SOCK+4,,AUTO
         3 001714   200026 630500                    EPPR0   RESULT,,AUTO
         3 001715   200041 450500                    STP0    @HEP_SOCK+3,,AUTO
         3 001716   200025 631500                    EPPR1   P$,,AUTO
         3 001717   200040 451500                    STP1    @HEP_SOCK+2,,AUTO
         3 001720   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001721   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001722   000000 701000 xent               TSX1    XSL$GETHOSTBYADDR
         3 001723   000311 702000 3                  TSX2    NOSOCKET

      446     3434    1      P$ = P$->XSL$HOSTENT.H_NAME$;

   3434  3 001724   200025 470500                    LDP0    P$,,AUTO
         3 001725   000000 236100                    LDQ     0,,PR0
         3 001726   200025 756100                    STQ     P$,,AUTO

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:76   
      447     3435    1      CALL INDEX (RESULT, BINASC(0), P$->CHAR31);

   3435  3 001727   200025 470500                    LDP0    P$,,AUTO
         3 001730   000000 124500                    SCM     mask='000'O
         3 001731   000000 000037                    ADSC9   0,,PR0                   cn=0,n=31
         3 001732   000010 000001 4                  ADSC9   8                        cn=0,n=1
         3 001733   200026 000100                    ARG     RESULT,,AUTO

      448     3436    1      PRM1NAME.L# = RESULT;

   3436  3 001734   200003 471500                    LDP1    @PRM1,,AUTO
         3 001735   200026 236100                    LDQ     RESULT,,AUTO
         3 001736   000033 736000                    QLS     27
         3 001737   100000 552140                    STBQ    0,'40'O,PR1

      449     3437    1      PRM1NAME.NAME# = P$->CHAR31;

   3437  3 001740   100000 236100                    LDQ     0,,PR1
         3 001741   000033 772000                    QRL     27
         3 001742   200025 470500                    LDP0    P$,,AUTO
         3 001743   000000 620006                    EAX0    0,QL
         3 001744   040140 100500                    MLR     fill='040'O
         3 001745   000000 000037                    ADSC9   0,,PR0                   cn=0,n=31
         3 001746   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0

      450     3438    1      RETURN;

   3438  3 001747   000000 702200 xent               TSX2  ! X66_ARET

      451     3439
      452     3440    1   NET$NAME2ADDR: ENTRY (PRM1, PRM2) ALTRET;

   3440  3 001750   000000 700200 xent  NET$NAME2AD* TSX0  ! X66_AUTO_N
         3 001751   000046 000006                    ZERO    38,6

      453     3441    1      CALL XSL$GETHOSTBYNAME (P$, PRM2NAME) ALTRET(ERRRET);

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:77   
   3441  3 001752   200004 236100                    LDQ     @PRM2,,AUTO
         3 001753   200041 756100                    STQ     @HEP_SOCK+3,,AUTO
         3 001754   200025 630500                    EPPR0   P$,,AUTO
         3 001755   200040 450500                    STP0    @HEP_SOCK+2,,AUTO
         3 001756   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001757   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001760   000000 701000 xent               TSX1    XSL$GETHOSTBYNAME
         3 001761   000311 702000 3                  TSX2    NOSOCKET

      454     3442    1      CALL NET$IP2ADDRX (PRM1, P$->XSL$HOSTENT.H_ADDR_LIST$->B$PTR->B$UBIN);

   3442  3 001762   200025 470500                    LDP0    P$,,AUTO
         3 001763   000004 471500                    LDP1    4,,PR0
         3 001764   100000 473500                    LDP3    0,,PR1
         3 001765   200041 453500                    STP3    @HEP_SOCK+3,,AUTO
         3 001766   200003 236100                    LDQ     @PRM1,,AUTO
         3 001767   200040 756100                    STQ     @HEP_SOCK+2,,AUTO
         3 001770   200040 630500                    EPPR0   @HEP_SOCK+2,,AUTO
         3 001771   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001772   001652 701000 3                  TSX1    s:3423
         3 001773   000000 011000                    NOP     0

      455     3443    1      RETURN;

   3443  3 001774   000000 702200 xent               TSX2  ! X66_ARET

FPT_EVENT
 Sect OctLoc
   1     000   000001 777640   000002 006000   000000 000000   000000 000000    ................

FPT_FOREVER
 Sect OctLoc
   1     004   000001 777640   000010 006000   000000 177640   000000 006014    ................
   1     010   000003 641077   000000 000001                                    ...?....

WAIT1SEC
 Sect OctLoc
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:78   
   1     012   000001 777640   000016 006000   000000 177640   000000 006014    ................
   1     016   000000 000001   000000 000001                                    ........

CBITS
 Sect OctLoc
   1     020   400000 000000   200000 000000   100000 000000   040000 000000    ........@... ...
   1     024   020000 000000   010000 000000   004000 000000   002000 000000    ................
   1     030   001000 000000   000400 000000   000200 000000   000100 000000    .............@..
   1     034   000040 000000   000020 000000   000010 000000   000004 000000    . ..............
   1     040   000002 000000   000001 000000   000000 400001   000000 200000    ................
   1     044   000000 100000   000000 040000   000000 020000   000000 010000    ..@... .........
   1     050   000000 004000   000000 002000   000000 001000   000000 000400    ................
   1     054   000000 000200   000000 000100   000000 000040   000000 000020    .......@... ....
   1     060   000000 000010   000000 000004   000000 000002   000000 000001    ................

XSLERR_2_TCPERR
 Sect OctLoc
   1     064   777015 153154   152011 142016   004026 163030   143156 162002    ..klj.b...s.cnr.
   1     070   170155 173174   160157 137140   144172 145150   151147 166171    xm{|po_`dzehigvy
   1     074   165161 164141   001167 136***                                    uqta.w^.

TCPERRS
 Sect OctLoc
   1     076   777777 777777   777777 777777   000000 000001   000000 000001    ................
   1     102   000000 000005   000000 000007   000000 000005   000001 000130    ...............X
   1     106   000001 020430   000000 000005   000000 000001   000000 000004    ................
   1     112   000001 000070   000000 000013   000000 000004   000000 000004    ...8............
   1     116   000000 000013   000000 000013   000000 000013   000000 000013    ................
   1     122   000000 000015   000000 000015   000000 000001   000000 000001    ................
   1     126   000000 000005   000000 000005   000000 000005   000000 000005    ................
   1     132   000000 000005   000000 000005   000000 000004   000000 000004    ................
   1     136   000000 000015   000000 000015   000000 000013   000000 000007    ................
   1     142   000000 000005   000000 000020   000000 000000   000000 000015    ................
   1     146   ****** ******   ****** ******   ****** ******                    ............

FPT_GDS
 Sect OctLoc
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:79   
   1     152   000001 777640   000156 006000   000001 777640   000002 006000    .....n..........
   1     156   000600 002000   ****** ******                                    ........

TCP_UENTRY
 Sect OctLoc
   2     000   000000 000000                                                    ....

TCP_BLKSIZE
 Sect OctLoc
   2     001   000000 003100                                                    ...@

(unnamed)
 Sect OctLoc
   2     002   000000 177640   000000 006014                                    ........

(unnamed)
 Sect OctLoc
   4     000   000003 006000   000004 006000   777777 777760   000012 006000    ................
   4     004   000017 006000   000004 006000   000027 006000   000006 006000    ................
   4     010   000040 040040   777777 400007   000000 177640   000000 006014    .   ............
   4     014   000030 006000   000012 006000   767777 777777   000002 006000    ................
   4     020   000002 006000   577777 777777   000006 006000   000004 006000    ................
      456     3444    1   END;
      457     3445        %EOD;

PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:80   
--  Include file information  --

   B_ERRORS_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   XSL_PERR_C.:TCA2TOU  is referenced.
   XSL_SOCKET_E.:TCA2TOU  is referenced.
   XSL_SOCKET_M.:TCA2TOU  is referenced.
   XSL_INTERNAL_M.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCP$OPEN.
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:81   

 **** Variables and constants ****

  ****  Section 001 RoData TCP$OPEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    20-0-0/w BIT         r     1 BITS(0:35)                20-0-0/w STRC(1296)  r     1 CBITS
     0-0-0/d STRC(144)   r     1 FPT_EVENT                  4-0-0/d STRC(216)   r     1 FPT_FOREVER
   152-0-0/d STRC(216)   r     1 FPT_GDS                   76-0-0/w SBIN        r     1 TCPERRS(0:42)
    12-0-0/d STRC(216)   r     1 WAIT1SEC                  64-0-0/c CHAR(39)    r     1 XSLERR_2_TCPERR

  ****  Section 002  Data  TCP$OPEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d VECT        r     1 TCPBUF_                    2-0-0/d STRC(72)    r     1 TCP_
     1-0-0/w UBIN        r     1 TCP_BLKSIZE                0-0-0/w UBIN        r     1 TCP_UENTRY

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/w PTR         r     1 @HEP_SOCK                  6-0-0/w PTR         r     1 @MODE
     3-0-0/w PTR         r     1 @PRM1                      4-0-0/w PTR         r     1 @PRM2
     5-0-0/w PTR         r     1 @PRM3                      7-0-0/w PTR         r     1 @PRM5
    10-0-0/w PTR         r     1 @PRM6                     32-0-0/w PTR         r     1 @TCP_ADMIN
    31-0-0/w PTR         r     1 @TCP_CB                   35-0-0/w PTR         r     1 @XSL_SOCK
    27-0-0/w BIT         r     1 FLAGBITS(0:35)
    27-0-0/w SBIN        r     1 FLAGS                     *0-0-0/w STRC(72)    r     1 HEP_SOCK
    24-0-0/w SBIN        r     1 I                         11-0-0/w STRC(180)   r     1 LOCAL_SOCK
    *0-0-0/w UBIN        r     1 MODE                      25-0-0/w PTR         r     1 P$
    16-0-0/w STRC(180)   r     1 PEER_SOCK                 *0-0-0/w ACHR        r     1 PRM1
    *0-0-0/w ASTR(9)     r     1 PRM1NAME                  *0-0-0/w ACHR        r     1 PRM2
    *0-0-0/w ASTR(9)     r     1 PRM2NAME                  *0-0-0/w UBIN        r     1 PRM2U
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:82   
    *0-0-0/w STRC(72)    r     1 PRM2_SOCK                 *0-0-0/d VECT        r     1 PRM2_VEC
    *0-0-0/w ACHR        r     1 PRM3                      *0-0-0/w STRC(180)   r     1 PRM3_CB
    *0-0-0/w UBIN        r     1 PRM5                      *0-0-0/w UBIN        r     1 PRM6
    *0-0-0/w BIT         r     1 PUSH                      26-0-0/w SBIN        r     1 RESULT
    *0-0-0/w UBIN        r     1 SOCKET                    23-0-0/w PTR         r     1 TCP$
    *0-0-0/w STRC(432)   r     1 TCP_ADMIN                 *0-0-0/w STRC(180)   r     1 TCP_CB
    *0-0-0/w SBIN        r     1 URGENT                    *0-0-0/w STRC(162)   r     1 XSL_SOCK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b STRC        r     1 TCP_ERR_CODE
     0-0-0/b STRC        r     1 TCP_MON_ERR                0-0-0/w SBIN        r     1 XSL_ERRNO
     0-0-0/w PTR         r     1 XSL_SOCK$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w PTR         r     1 B$PTR
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w UBIN        r     1 B$UBIN
     0-0-0/c CHAR(31)    r     1 CHAR31                     0-0-0/w STRC(432)   r     1 TCP$ADMIN
     0-0-0/w STRC(180)   r     1 TCP$CB                     0-0-0/w STRC(216)   r     1 TCP$INFO
     0-0-0/w STRC(72)    r     1 TCP_DAT                    0-0-0/w STRC(180)   r     1 XSL$HOSTENT
     0-0-0/w STRC(180)   r     1 XSL$SOCKHD


   Procedure TCP$OPEN requires 1021 words for executable code.
   Procedure TCP$OPEN requires 38 words of local(AUTO) storage.
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:84   
          MINI XREF LISTING

ACCEPT
      3374**PROC     3295--CALL     3349--CALL
B$ALT.CODE
      2954**DCL      2954--REDEF    2955--REDEF    2955--REDEF
B$ALT.ERR
      2955**DCL      3045>>ASSIGN   3363>>ASSIGN
B$ALT.ERR.ERR#
      2956**DCL      2956--REDEF
B$ALT.EVID
      2955**DCL      2955--REDEF    2955--REDEF
B$PTR
      2934**DCL      3442>>CALL
B$TCB.ALT$
      2950**DCL      3045>>ASSIGN   3363>>ASSIGN
B$TCB$
      2948**DCL      2950--IMP-PTR  3045>>ASSIGN   3363>>ASSIGN
B$UBIN
      2933**DCL      3442<>CALL
BITS
      2946**DCL      3337>>ASSIGN   3346>>IF
CBITS
      2941**DCL      2946--REDEF
CHAR31
      2935**DCL      3254<<ASSIGN   3254>>ASSIGN   3267<>CALL     3304<>CALL     3352<>CALL     3435>>CALLBLT
      3437>>ASSIGN
COMMON
      3426**LABEL    3422--GOTO
DOBIND
      3002**LABEL    3007--GOTO
ERRRET
      3031**LABEL    2993--CALLALT  2999--CALLALT  3005--GOTO     3011--CALLALT  3015--CALLALT  3019--CALLALT
      3020--CALLALT  3224--CALLALT  3230--CALLALT  3272--GOTO     3295--CALLALT  3306--GOTO     3320--GOTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:85   
      3420--CALLALT  3433--CALLALT  3441--CALLALT
ERRRET IN PROCEDURE ACCEPT
      3405**LABEL    3401--CALLALT
FLAGBITS
      2940**DCL      3047>>ASSIGN   3337<<ASSIGN   3337>>ASSIGN   3344<<ASSIGN   3344>>ASSIGN   3346>>IF
FLAGS
      2939**DCL      2940--REDEF    3043<<ASSIGN   3044>>IF       3046>>IF       3048>>IF       3054>>ASSIGN
      3237<<ASSIGN   3243<<ASSIGN   3244>>IF       3266<<ASSIGN   3267<>CALL     3267<>CALL     3272>>IF
      3330<<ASSIGN   3342>>ASSIGN   3343<>CALL
FPT_EVENT
      2767**DCL      3219<>CALL
FPT_EVENT.V
      2767**DCL      2767--DCLINIT
FPT_FOREVER
      2915**DCL      3332<>CALL
FPT_FOREVER.V
      2916**DCL      2915--DCLINIT
FPT_GDS IN PROCEDURE TCPINIT
      3159**DCL      3202<>CALL
FPT_GDS.V IN PROCEDURE TCPINIT
      3159**DCL      3159--DCLINIT
HEPSOCK_2_XSLSOCK
      3060**PROC     2996--CALL     2997--CALL
HEP_SOCK IN PROCEDURE HEPSOCK_2_XSLSOCK
      3063**DCL      3060--PROC     3140--ENTRY
HEP_SOCK.ADDRESS IN PROCEDURE HEPSOCK_2_XSLSOCK
      3067**DCL      3134>>ASSIGN   3144<<ASSIGN
HEP_SOCK.PORT IN PROCEDURE HEPSOCK_2_XSLSOCK
      3067**DCL      3136>>ASSIGN   3142<<ASSIGN
I
      2936**DCL      3001<<ASSIGN   3004<<ASSIGN   3004>>ASSIGN   3005>>IF
LOCAL_SOCK
      2692**DCL      2996<>CALL     3002<>CALL     3028<>CALL     3029<>CALL     3403<>CALL     3414<>CALL
M$EVENT
      1455**DCL-ENT  3219--CALL
M$GDS
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:86   
      1435**DCL-ENT  3202--CALL
M$WAIT
      1458**DCL-ENT  3006--CALL     3332--CALL
MODE
      2671**DCL         8--PROC     2672--REDEF    2990>>IF       2998>>IF       3010>>IF       3014>>IF
      3234--ENTRY
MORE_BLK
      3240**LABEL    3273--GOTO
NET$IP2ADDRX
      3423**ENTRY    3442--CALL
NOSOCKET
      3031**LABEL    2991--CALLALT
NOTSOCK
      3318**LABEL    3235--GOTO     3277--GOTO
P$
      2937**DCL      3239<<ASSIGN   3240>>IF       3254>>ASSIGN   3257<<ASSIGN   3257>>ASSIGN   3258>>ASSIGN
      3262>>ASSIGN   3270>>IF       3343<>CALL     3403<>CALL     3433<>CALL     3434<<ASSIGN   3434>>ASSIGN
      3435>>CALLBLT  3437>>ASSIGN   3441<>CALL     3442>>CALL
PEER_SOCK
      2732**DCL      2997<>CALL     3011<>CALL     3019<>CALL     3033<>CALL     3034<>CALL     3401<>CALL
      3413<>CALL
PRM1
      2599**DCL         8--PROC     2600--REDEF    2626--REDEF    3217--ENTRY    3222--ENTRY    3223<>CALL
      3228--ENTRY    3229--ENTRY    3234--ENTRY    3276--ENTRY    3316--ENTRY    3329--ENTRY    3419--ENTRY
      3423--ENTRY    3430--ENTRY    3440--ENTRY    3442<>CALL
PRM1NAME.L#
      2626**DCL      2626--IMP-SIZ  3436<<ASSIGN   3437>>ASSIGN
PRM1NAME.NAME#
      2626**DCL      3437<<ASSIGN
PRM2
      2628**DCL         8--PROC     2629--REDEF    2655--REDEF    2659--REDEF    2665--REDEF    2996<>CALL
      3234--ENTRY    3276--ENTRY    3316--ENTRY    3329--ENTRY    3419--ENTRY    3420<>CALL     3421<>CALL
      3423--ENTRY    3430--ENTRY    3440--ENTRY
PRM2NAME
      2655**DCL      3441<>CALL
PRM2NAME.L#
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:87   
      2655**DCL      2655--IMP-SIZ  3441>>CALL
PRM2U
      2629**DCL      3424>>ASSIGN   3431>>ASSIGN
PRM2_SOCK.ADDRESS
      2663**DCL      2998>>IF
PRM2_SOCK.PORT
      2663**DCL      2998>>IF
PRM2_VEC
      2665**DCL      3238>>ASSIGN   3239>>ASSIGN   3258>>ASSIGN   3258>>ASSIGN   3281>>ASSIGN   3285>>ASSIGN
      3290>>ASSIGN   3295>>CALL     3297>>ASSIGN   3300>>ASSIGN   3304>>CALL     3304>>CALL     3308>>ASSIGN
      3324>>ASSIGN   3325>>ASSIGN
PRM3
      2666**DCL         8--PROC     2668--REDEF    2670--REDEF    2997<>CALL     3234--ENTRY    3276--ENTRY
      3316--ENTRY    3323--ASSIGN
PRM3_CB
      2668**DCL      3295<>CALL
PRM3_CB.ADMIN
      2668**DCL      3279<<ASSIGN   3313<<ASSIGN
PRM3_CB.ARS
      2668**DCL      3304<>CALL     3312>>IF
PRM5
      2673**DCL         8--PROC     3031--IF       3034<>CALL
PRM6
      2674**DCL         8--PROC     3026--IF       3029<>CALL
PUSH
      2670**DCL      3246--IF       3246>>IF       3259--IF       3259>>IF
RESULT
      2938**DCL      2599--IMP-SIZ  2628--IMP-SIZ  2666--IMP-SIZ  2996>>CALL     2997>>CALL     2999<>CALL
      3002<>CALL     3011<>CALL     3015<>CALL     3019<>CALL     3027<<ASSIGN   3028<>CALL     3028<>CALL
      3032<<ASSIGN   3033<>CALL     3033<>CALL     3040<<CALLBLT  3043>>ASSIGN   3209<<DOINDEX  3210>>ASSIGN
      3210>>ASSIGN   3212>>ASSIGN   3214>>ASSIGN   3223>>CALL     3224<>CALL     3230<>CALL     3238<<ASSIGN
      3240<<ASSIGN   3245>>IF       3252>>IF       3253<<ASSIGN   3253>>ASSIGN   3254>>ASSIGN   3254>>ASSIGN
      3256>>ASSIGN   3257>>ASSIGN   3258<<ASSIGN   3259>>IF       3263>>ASSIGN   3264<<ASSIGN   3273>>IF
      3294<<ASSIGN   3299<>CALL     3335<<DOINDEX  3336>>IF       3337>>ASSIGN   3338>>ASSIGN   3339>>ASSIGN
      3342<<ASSIGN   3343<>CALL     3344>>ASSIGN   3345<<DOINDEX  3346>>IF       3347>>ASSIGN   3352<>CALL
      3401<>CALL     3405<>CALL     3420<>CALL     3420>>CALL     3421<>CALL     3421>>CALL     3424<<ASSIGN
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:88   
      3426<>CALL     3426<>CALL     3427>>ASSIGN   3431<<ASSIGN   3432<>CALL     3432<>CALL     3433<>CALL
      3435<<CALLBLT  3436>>ASSIGN   3442>>CALL
SOCKET
      2600**DCL      2991<>CALL     2994>>ASSIGN   2999<>CALL     3002<>CALL     3011<>CALL     3015<>CALL
      3019<>CALL     3021>>ASSIGN   3028<>CALL     3033<>CALL     3049>>IF       3050>>ASSIGN   3218>>ASSIGN
      3224<>CALL     3225>>ASSIGN   3230<>CALL     3235>>IF       3236>>ASSIGN   3267<>CALL     3277>>IF
      3278>>ASSIGN   3294>>ASSIGN   3299<>CALL     3300<<ASSIGN   3304<>CALL     3317>>IF       3322>>ASSIGN
      3343<>CALL     3427<<ASSIGN
TCP$
      2773**DCL      2781--IMP-PTR  2994<<ASSIGN   2995>>ASSIGN   3012>>ASSIGN   3014>>ASSIGN   3016>>ASSIGN
      3021<<ASSIGN   3022>>ASSIGN   3023>>ASSIGN   3236<<ASSIGN   3245>>IF       3249>>ASSIGN   3253>>ASSIGN
      3254>>ASSIGN   3254>>ASSIGN   3256>>ASSIGN   3256>>ASSIGN   3261>>IF       3262>>ASSIGN   3263>>ASSIGN
      3267>>CALL     3267>>CALL     3269>>ASSIGN   3270>>IF       3270>>ASSIGN   3271>>ASSIGN   3278<<ASSIGN
      3280>>IF       3284>>IF       3288>>IF       3289>>ASSIGN   3293>>IF       3296>>IF       3298>>ASSIGN
      3309>>ASSIGN   3322<<ASSIGN   3323>>ASSIGN   3324>>ASSIGN   3325>>ASSIGN   3326>>ASSIGN   3347<<ASSIGN
      3348>>IF       3349>>CALL     3349>>CALL     3352>>CALL     3352>>CALL     3352>>CALL     3355>>IF
      3359>>ASSIGN   3360>>ASSIGN   3361>>ASSIGN   3367>>ASSIGN   3368>>ASSIGN
TCP$ADMIN
      2799**DCL      3295<>CALL     3349<>CALL     3410--ASSIGN
TCP$ADMIN.CMD
      2799**DCL      3281<<ASSIGN   3285<<ASSIGN   3290<<ASSIGN   3297<<ASSIGN   3308<<ASSIGN   3360<<ASSIGN
TCP$ADMIN.GHST_LCN
      2800**DCL      2800--REDEF
TCP$ADMIN.NEWLCN
      2800**DCL      3300>>ASSIGN
TCP$ADMIN.USER_LCN
      2799**DCL      2800--REDEF
TCP$ASYNC
      2770**DCL-ENT  2767--DCLINIT
TCP$CB
      2796**DCL      3349<>CALL
TCP$CB.ADMIN
      2796**DCL      3339<<ASSIGN   3359<<ASSIGN
TCP$CB.ARS
      2796**DCL      3352<>CALL     3355>>IF
TCP$CB.READ_COMPLETE
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:89   
      2796**DCL      3338<<ASSIGN   3368<<ASSIGN
TCP$INFO
      2781**DCL      2995<<ASSIGN   3022<<ASSIGN   3200--DOUNTIL  3210--ASSIGN   3212<<ASSIGN   3214--ASSIGN
      3298<<ASSIGN   3409<<ASSIGN
TCP$INFO.ARS
      2792**DCL      3324<<ASSIGN   3352<>CALL
TCP$INFO.BLK$
      2789**DCL      3249<<ASSIGN   3254>>ASSIGN   3262<<ASSIGN   3267>>CALL     3270>>IF       3270>>ASSIGN
      3271<<ASSIGN
TCP$INFO.BLKSIZ
      2790**DCL      3245>>IF       3253>>ASSIGN   3254>>ASSIGN   3256<<ASSIGN   3256>>ASSIGN   3261>>IF
      3263<<ASSIGN   3267<>CALL     3269<<ASSIGN
TCP$INFO.BUF$
      2793**DCL      3325<<ASSIGN   3349>>CALL     3352>>CALL     3360>>ASSIGN
TCP$INFO.CB$
      2791**DCL      3323<<ASSIGN   3338>>ASSIGN   3339>>ASSIGN   3349>>CALL     3352>>CALL     3355>>IF
      3359>>ASSIGN   3368>>ASSIGN
TCP$INFO.CLOSING
      2786**DCL      3225<<ASSIGN   3284>>IF
TCP$INFO.CONNECTED
      2787**DCL      3012<<ASSIGN   3023<<ASSIGN   3288>>IF       3289<<ASSIGN
TCP$INFO.LISTEN
      2782**DCL      3016<<ASSIGN   3293>>IF       3348>>IF
TCP$INFO.NOWAIT
      2783**DCL      3326<<ASSIGN   3336>>IF       3367<<ASSIGN
TCP$INFO.PASSIVE
      2785**DCL      3014<<ASSIGN   3296>>IF
TCP$INFO.RESET
      2784**DCL      3050<<ASSIGN   3280>>IF       3309<<ASSIGN   3361<<ASSIGN
TCP$WRITE
      3234**ENTRY    3223--CALL
TCPBUF_
      2774**DCL      2775--REDEF    3159--DCLINIT  3199<<ASSIGN   3200>>DOUNTIL
TCPERRS
      2975**DCL      3043>>ASSIGN
TCPINIT
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:90   
      3147**PROC     2993--CALL     3020--CALL
TCP_.MAXSOCK
      2776**DCL      3049>>IF       3208<<ASSIGN   3209>>DOINDEX  3210>>ASSIGN   3235>>IF       3277>>IF
      3317>>IF       3335>>DOINDEX  3343<>CALL
TCP_.P$$
      2777**DCL      2778--IMP-PTR  2993>>IF       2994>>ASSIGN   3020>>IF       3021>>ASSIGN   3049>>IF
      3050>>ASSIGN   3207<<ASSIGN   3210>>ASSIGN   3210>>ASSIGN   3212>>ASSIGN   3214>>ASSIGN   3214>>ASSIGN
      3225>>ASSIGN   3235>>IF       3236>>ASSIGN   3246>>IF       3249>>ASSIGN   3250>>ASSIGN   3270>>ASSIGN
      3277>>IF       3278>>ASSIGN   3317>>IF       3322>>ASSIGN   3331>>IF       3336>>IF       3338>>ASSIGN
      3339>>ASSIGN   3347>>ASSIGN   3409>>ASSIGN
TCP_ADMIN IN PROCEDURE ACCEPT
      3379**DCL      3374--PROC
TCP_ADMIN.CMD IN PROCEDURE ACCEPT
      3379**DCL      3412<<ASSIGN
TCP_ADMIN.FS IN PROCEDURE ACCEPT
      3394**DCL      3413<>CALL
TCP_ADMIN.GHST_LCN IN PROCEDURE ACCEPT
      3380**DCL      3380--REDEF
TCP_ADMIN.LS IN PROCEDURE ACCEPT
      3386**DCL      3414<>CALL
TCP_ADMIN.NEWLCN IN PROCEDURE ACCEPT
      3380**DCL      3401<>CALL     3403<>CALL     3405<>CALL     3409>>ASSIGN
TCP_ADMIN.USER_LCN IN PROCEDURE ACCEPT
      3379**DCL      3380--REDEF
TCP_BLKSIZE
      2772**DCL      3200>>DOUNTIL  3253>>ASSIGN
TCP_CB IN PROCEDURE ACCEPT
      3376**DCL      3374--PROC
TCP_CB.ADMIN IN PROCEDURE ACCEPT
      3376**DCL      3411<<ASSIGN
TCP_CB.ARS IN PROCEDURE ACCEPT
      3376**DCL      3400<<ASSIGN   3401<>CALL     3403<>CALL     3410<<ASSIGN
TCP_DAT.BLK$
      2779**DCL      3214<<ASSIGN   3246>>IF       3249>>ASSIGN   3250<<ASSIGN   3270<<ASSIGN
TCP_DAT.PTR$
      2780**DCL      2994>>ASSIGN   3021>>ASSIGN   3050>>ASSIGN   3210<<ASSIGN   3210--ASSIGN   3212>>ASSIGN
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:91   
      3214--ASSIGN   3225>>ASSIGN   3236>>ASSIGN   3278>>ASSIGN   3322>>ASSIGN   3336>>IF       3338>>ASSIGN
      3339>>ASSIGN   3347>>ASSIGN   3409>>ASSIGN
TCP_ERR_CODE.ERR#
        46**DCL      3042<<ASSIGN   3054<<ASSIGN
TCP_MON_ERR
        46**DCL      3041<<ASSIGN   3045<<ASSIGN   3047<<ASSIGN   3055<<ASSIGN   3363<<ASSIGN   3364<<ASSIGN
TCP_UENTRY
      2771**DCL      3218<<ASSIGN
URGENT
      2672**DCL      3242--IF       3242>>IF
WAIT1SEC
      2929**DCL      3006<>CALL
WAIT1SEC.V
      2930**DCL      2929--DCLINIT
WAIT_ERR
      3355**LABEL    3349--CALLALT  3355--GOTO
XSL$GETHOSTBYADDR
      2842**DCL-ENT  3433--CALL
XSL$GETHOSTBYNAME
      2843**DCL-ENT  3441--CALL
XSL$HOSTENT.H_ADDR_LIST$
      2902**DCL      3442>>CALL
XSL$HOSTENT.H_NAME$
      2872**DCL      3434>>ASSIGN
XSL$HTONL
      2836**DCL-ENT  3135--CALL     3137--CALL     3432--CALL
XSL$INET_ADDR
      2840**DCL-ENT  3420--CALL     3421--CALL
XSL$NTOHL
      2838**DCL-ENT  3141--CALL     3143--CALL     3426--CALL
XSL$QACCEPT
      2823**DCL-ENT  3401--CALL
XSL$QACCEPT_SRVR
      2824**DCL-ENT  3019--CALL
XSL$QBIND
      2821**DCL-ENT  3002--CALL
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:92   
XSL$QCLOSE
      2825**DCL-ENT  3230--CALL     3299--CALL     3405--CALL
XSL$QCONNECT
      2826**DCL-ENT  3011--CALL
XSL$QGETPEERNAME
      2833**DCL-ENT  3033--CALL
XSL$QGETSOCKNAME
      2834**DCL-ENT  3028--CALL     3403--CALL
XSL$QLISTEN
      2822**DCL-ENT  3015--CALL
XSL$QRECV
      2828**DCL-ENT  3304--CALL     3352--CALL
XSL$QSELECT
      2829**DCL-ENT  3343--CALL
XSL$QSEND
      2827**DCL-ENT  3267--CALL
XSL$QSETSOCKOPT
      2830**DCL-ENT  2999--CALL
XSL$QSHUTDOWN
      2831**DCL-ENT  3224--CALL
XSL$QSOCKET
      2820**DCL-ENT  2991--CALL
XSL$SOCKHD.MAXSOCK IN PROCEDURE TCPINIT
      3193**DCL      3200>>DOUNTIL  3208>>ASSIGN
XSL$SOCKHD.SEGSIZE IN PROCEDURE TCPINIT
      3190**DCL      3200>>DOUNTIL  3207>>ASSIGN
XSLERR_2_TCPERR
      2961**DCL      3040>>CALLBLT
XSLSOCK_2_HEPSOCK IN PROCEDURE HEPSOCK_2_XSLSOCK
      3140**ENTRY    3029--CALL     3034--CALL     3413--CALL     3414--CALL
XSL_ERRNO
      1390**DCL      3005>>IF       3040>>CALLBLT  3055>>ASSIGN   3203<<ASSIGN   3306>>IF       3319<<ASSIGN
      3362>>IF       3364>>ASSIGN
XSL_SOCK IN PROCEDURE HEPSOCK_2_XSLSOCK
      3086**DCL      3060--PROC     3140--ENTRY
XSL_SOCK.SA_FAMILY IN PROCEDURE HEPSOCK_2_XSLSOCK
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:93   
      3101**DCL      3133<<ASSIGN
XSL_SOCK.S_ADDR IN PROCEDURE HEPSOCK_2_XSLSOCK
      3130**DCL      3135<>CALL     3143<>CALL
XSL_SOCK.S_PORT IN PROCEDURE HEPSOCK_2_XSLSOCK
      3110**DCL      3134<<ASSIGN   3135<>CALL     3136<<ASSIGN   3137<>CALL     3137<>CALL     3141<>CALL
      3141<>CALL     3142>>ASSIGN   3143<>CALL     3144>>ASSIGN
XSL_SOCK$$ IN PROCEDURE TCPINIT
      3197**DCL      3181--IMP-PTR  3199>>ASSIGN   3200>>DOUNTIL  3200>>DOUNTIL  3207>>ASSIGN   3207>>ASSIGN
      3208>>ASSIGN
ZERO_RESULT
      3308**LABEL    3312--GOTO
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:94   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:95   
              MINI UREF LISTING

M$ACCT    1417**DCL-ENT
M$ACTIVATE    1420**DCL-ENT
M$ALIB    1413**DCL-ENT
M$ASUSER    1415**DCL-ENT
M$ATTACH    1422**DCL-ENT
M$BADPP    1440**DCL-ENT
M$CGCTL    1421**DCL-ENT
M$CGINFO    1421**DCL-ENT
M$CHECK    1402**DCL-ENT
M$CHGUNIT    1460**DCL-ENT
M$CLOSE    1400**DCL-ENT
M$CLRSTK    1458**DCL-ENT
M$CMDVAR    1469**DCL-ENT
M$CONFIG    1430**DCL-ENT
M$CORRES    1405**DCL-ENT
M$CPEXIT    1414**DCL-ENT
M$CVM    1438**DCL-ENT
M$CVOL    1403**DCL-ENT
M$DCLFLD    1430**DCL-ENT
M$DEACTIVATE    1420**DCL-ENT
M$DELREC    1402**DCL-ENT
M$DEQ    1467**DCL-ENT
M$DETACH    1422**DCL-ENT
M$DEVICE    1404**DCL-ENT
M$DISPLAY    1467**DCL-ENT
M$DISPRES    1407**DCL-ENT
M$DLIB    1413**DCL-ENT
M$DRIBBLE    1430**DCL-ENT
M$DRTN    1458**DCL-ENT
M$DSUSER    1415**DCL-ENT
M$ENQ    1466**DCL-ENT
M$EOM    1425**DCL-ENT
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:96   
M$ERASE    1431**DCL-ENT
M$ERR    1412**DCL-ENT
M$ERRMSG    1463**DCL-ENT
M$EXHUME    1464**DCL-ENT
M$EXIT    1412**DCL-ENT
M$EXTEND    1404**DCL-ENT
M$FDP    1436**DCL-ENT
M$FDS    1435**DCL-ENT
M$FEBOOT    1428**DCL-ENT
M$FECTL    1429**DCL-ENT
M$FEDUMP    1428**DCL-ENT
M$FID    1463**DCL-ENT
M$FINDPROC    1417**DCL-ENT
M$FSUSER    1415**DCL-ENT
M$FVP    1437**DCL-ENT
M$FWCG    1421**DCL-ENT
M$GBPL    1441**DCL-ENT
M$GDDL    1437**DCL-ENT
M$GDP    1436**DCL-ENT
M$GETDCB    1406**DCL-ENT
M$GETMOUSE    1446**DCL-ENT
M$GETPM    1447**DCL-ENT
M$GJOB    1465**DCL-ENT
M$GLINEATTR    1425**DCL-ENT
M$GOODPP    1440**DCL-ENT
M$GPLATEN    1433**DCL-ENT
M$GPROMPT    1432**DCL-ENT
M$GTRMATTR    1426**DCL-ENT
M$GTRMCTL    1424**DCL-ENT
M$GTRMTAB    1427**DCL-ENT
M$GVP    1436**DCL-ENT
M$HELP    1463**DCL-ENT
M$INT    1455**DCL-ENT
M$INTRTN    1416**DCL-ENT
M$IOQ    1451**DCL-ENT
M$JOBSTATS    1465**DCL-ENT
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:97   
M$KEYIN    1405**DCL-ENT
M$LDEV    1400**DCL-ENT
M$LDTRC    1413**DCL-ENT
M$LIMIT    1406**DCL-ENT
M$LINES    1405**DCL-ENT
M$LINK    1412**DCL-ENT
M$MADMUCK    1408**DCL-ENT
M$MAKUSER    1439**DCL-ENT
M$MBS    1407**DCL-ENT
M$MDFFLD    1431**DCL-ENT
M$MERC    1456**DCL-ENT
M$MERCS    1457**DCL-ENT
M$MIRROR    1451**DCL-ENT
M$MONINFO    1468**DCL-ENT
M$MPL    1441**DCL-ENT
M$NODEINFO    1432**DCL-ENT
M$NXTUSR    1466**DCL-ENT
M$OCMSG    1464**DCL-ENT
M$OLAY    1412**DCL-ENT
M$OPEN    1400**DCL-ENT
M$PAS    1441**DCL-ENT
M$PATHCON    1464**DCL-ENT
M$PDS    1435**DCL-ENT
M$PFIL    1402**DCL-ENT
M$PLATEN    1426**DCL-ENT
M$PRECORD    1404**DCL-ENT
M$PROCNAME    1417**DCL-ENT
M$PROFILE    1428**DCL-ENT
M$PROMPT    1424**DCL-ENT
M$RACST    1408**DCL-ENT
M$RDSYSLOG    1449**DCL-ENT
M$READ    1401**DCL-ENT
M$RELDCB    1406**DCL-ENT
M$RELRES    1407**DCL-ENT
M$RELSTARF    1409**DCL-ENT
M$REM    1409**DCL-ENT
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:98   
M$RENV    1456**DCL-ENT
M$REQUIRE    1408**DCL-ENT
M$RETRY    1457**DCL-ENT
M$RETRYS    1457**DCL-ENT
M$REW    1403**DCL-ENT
M$RLSFLD    1431**DCL-ENT
M$RPRIV    1459**DCL-ENT
M$RSPP    1438**DCL-ENT
M$RSWITCH    1460**DCL-ENT
M$RUE    1466**DCL-ENT
M$SAD    1439**DCL-ENT
M$SAVE    1415**DCL-ENT
M$SCON    1416**DCL-ENT
M$SCREECH    1414**DCL-ENT
M$SENV    1456**DCL-ENT
M$SETFMA    1400**DCL-ENT
M$SETFP    1429**DCL-ENT
M$SINPUT    1427**DCL-ENT
M$SLCFLD    1432**DCL-ENT
M$SMOUSE    1446**DCL-ENT
M$SMPRT    1438**DCL-ENT
M$SPRIV    1459**DCL-ENT
M$SSC    1439**DCL-ENT
M$SSWITCH    1459**DCL-ENT
M$STATE    1468**DCL-ENT
M$STD    1440**DCL-ENT
M$STIMER    1454**DCL-ENT
M$STLPP    1437**DCL-ENT
M$STRAP    1454**DCL-ENT
M$STRMATTR    1426**DCL-ENT
M$STRMCTL    1424**DCL-ENT
M$STRMTAB    1427**DCL-ENT
M$SYMBIO    1465**DCL-ENT
M$SYSCON    1451**DCL-ENT
M$SYSID    1469**DCL-ENT
M$TDCLOSE    1450**DCL-ENT
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:99   
M$TDIO    1450**DCL-ENT
M$TDOPEN    1449**DCL-ENT
M$TDREQCPU    1450**DCL-ENT
M$TEMPWROC    1444**DCL-ENT
M$TIME    1467**DCL-ENT
M$TRAP    1454**DCL-ENT
M$TRMISC    1429**DCL-ENT
M$TRMPRG    1425**DCL-ENT
M$TRTN    1458**DCL-ENT
M$TRUNC    1401**DCL-ENT
M$TTIMER    1454**DCL-ENT
M$UC    1424**DCL
M$UMPL    1441**DCL-ENT
M$UNFID    1463**DCL-ENT
M$UNLATCH    1420**DCL-ENT
M$UNSHARE    1417**DCL-ENT
M$USRFIELD    1460**DCL-ENT
M$VIRTUAL    1435**DCL-ENT
M$WEOF    1403**DCL-ENT
M$WRITE    1401**DCL-ENT
M$WRSYSLOG    1449**DCL-ENT
M$XCON    1455**DCL-ENT
M$XCONRTN    1416**DCL-ENT
M$XEQTIME    1468**DCL-ENT
M$XFLUSH    1409**DCL-ENT
M$XMOUSE    1446**DCL-ENT
M$XXX    1412**DCL-ENT
M$YC    1414**DCL-ENT
NET$ADDR2NAME    3430**ENTRY
NET$IP2ADDR    3419**ENTRY
NET$NAME2ADDR    3440**ENTRY
TCP$ABORT    3228**ENTRY
TCP$CLOSE    3222**ENTRY
TCP$EVENT    3217**ENTRY
TCP$OPEN       8**PROC
TCP$READ    3276**ENTRY
PL6.E3A0      #001=TCP$OPEN File=TCP$HEP.:TCA2TSI                                SUN 11/16/97 14:23 Page:100  
TCP$READ_NW    3316**ENTRY
TCP$RELEASE    3229**ENTRY
TCP$WAIT1    3329**ENTRY
XSL$GETHOSTNAME    2832**DCL-ENT
XSL$HTONS    2837**DCL-ENT
XSL$INET_NTOA    2841**DCL-ENT
XSL$NTOHS    2839**DCL-ENT
XSL$QFCNTL    2835**DCL-ENT

PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:101  
      458        1        /*T***********************************************************/
      459        2        /*T*                                                         */
      460        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      461        4        /*T*                                                         */
      462        5        /*T***********************************************************/
      463        6        TCP$ASYNC: PROC ASYNC;
      464        7        /*F* NAME: TCP$ASYNC
      465        8             DESCRIPTION: Just a dummy entry to implement TCP$EVENT
      466        9        */
      467       10    1   DCL TCP_UENTRY EPTR SYMREF;
      468       11    1   DCL TCP_MON_ERR SBIN STATIC SYMDEF;
      469       12    1   DCL TCP_ERR_CODE SBIN STATIC SYMDEF;
      470       13    1   DCL IP_WAIT_UETIME SBIN STATIC SYMDEF INIT(0);
      471       14
      472       15    2      DO INHIBIT;
      473       16    2         CALL TCP_UENTRY;
      474       17    2      END;
      475       18    1   END TCP$ASYNC;
      476       19        %EOD;

PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:102  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure TCP$ASYNC.

   Procedure TCP$ASYNC requires 7 words for executable code.
   Procedure TCP$ASYNC requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:103  

 Object Unit name= TCP$ASYNC                                  File name= TCP$HEP.:TCA2TOU
 UTS= NOV 16 '97 14:24:47.84 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     3      3  TCP$ASYNC
    1   Proc  even  none     7      7  TCP$ASYNC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes     Async       0  TCP$ASYNC

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  TCP_MON_ERR                        0      1  TCP_ERR_CODE
    0      2  IP_WAIT_UETIME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AARET
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:104  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     TCP_UENTRY                            B_VECTNIL
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:105  


      458        1        /*T***********************************************************/
      459        2        /*T*                                                         */
      460        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      461        4        /*T*                                                         */
      462        5        /*T***********************************************************/
      463        6        TCP$ASYNC: PROC ASYNC;

      6  1 000000   000000 700200 xent  TCP$ASYNC    TSX0  ! X66_AAUTO
         1 000001   000004 000000                    ZERO    4,0

      464        7        /*F* NAME: TCP$ASYNC
      465        8             DESCRIPTION: Just a dummy entry to implement TCP$EVENT
      466        9        */
      467       10    1   DCL TCP_UENTRY EPTR SYMREF;
      468       11    1   DCL TCP_MON_ERR SBIN STATIC SYMDEF;
      469       12    1   DCL TCP_ERR_CODE SBIN STATIC SYMDEF;
      470       13    1   DCL IP_WAIT_UETIME SBIN STATIC SYMDEF INIT(0);
      471       14
      472       15    2      DO INHIBIT;

      473       16    2         CALL TCP_UENTRY;

     16  1 000002   000000 220200 xsym               LDX0  ! TCP_UENTRY
         1 000003   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 000004   000000 701210                    TSX1  ! 0,X0
         1 000005   000000 011200                    NOP   ! 0

      474       17    2      END;

      475       18    1   END TCP$ASYNC;

     18  1 000006   000000 702200 xent               TSX2  ! X66_AARET

(unnamed)
 Sect OctLoc
   0     000   ****** ******   ****** ******   000000 000000                    ............
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:106  
      476       19        %EOD;

PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:107  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure TCP$ASYNC.
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:108  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 TCP_UENTRY


   Procedure TCP$ASYNC requires 7 words for executable code.
   Procedure TCP$ASYNC requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:109  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:110  
          MINI XREF LISTING

TCP_UENTRY
        10**DCL        16>>CALL
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:111  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=TCP$ASYNC File=TCP$HEP.:TCA2TSI                               SUN 11/16/97 14:24 Page:112  
              MINI UREF LISTING

IP_WAIT_UETIME      13**DCL
TCP$ASYNC       6**PROC
TCP_ERR_CODE      12**DCL
TCP_MON_ERR      11**DCL

PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:113  
      477        1        /*T***********************************************************/
      478        2        /*T*                                                         */
      479        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      480        4        /*T*                                                         */
      481        5        /*T***********************************************************/
      482        6        NET$ADDR2IP: PROC (PRM1, PRM2);
      483        7
      484        8    1   DCL PRM1 UBIN;
      485        9    1   DCL PRM2 UBIN;
      486       10    1   DCL 1 NAME BASED ALIGNED,
      487       11    1          2 L# UBIN BYTE CALIGNED,
      488       12    1          2 NAME# CHAR(NAME.L#);
      489       13
      490       14    1   DCL TCP$WAIT1 ENTRY(2) ALTRET;
      491       15    1   DCL XSL$HTONL ENTRY(2);
      492       16    1   DCL XSL$INET_NTOA ENTRY(2) ALTRET;
      493       17    1   DCL XSL$NTOHL ENTRY(2);
      494       18
      495       19    1   DCL P$ PTR;
      496       20    1   DCL RESULT UBIN;
      497       21    1   DCL CHAR31 BASED CHAR(31);
      498       22
      499       23    1      RESULT = PRM2/16;
      500       24    1      CALL XSL$HTONL(RESULT, RESULT);
      501       25    1      CALL XSL$INET_NTOA (P$, RESULT);
      502       26    1      CALL INDEX(RESULT, BINASC(0), P$->CHAR31);
      503       27    1      ADDR(PRM1)->NAME.L# = RESULT;
      504       28    1      ADDR(PRM1)->NAME.NAME# = P$->CHAR31;
      505       29    1      RETURN;
      506       30
      507       31    1   TCP$WAIT: ENTRY (PRM1, PRM2);
      508       32    1      CALL TCP$WAIT1 (PRM1, PRM2);
      509       33    1      RETURN;
      510       34
      511       35    1   IP$WAIT: ENTRY (PRM1, PRM2);
      512       36    1      CALL TCP$WAIT1 (PRM1, PRM2);
      513       37    1      RETURN;
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:114  
      514       38
      515       39    1   TCP$USER_TIMEOUT: ENTRY (PRM1);
      516       40    1      RETURN;
      517       41
      518       42    1   END;

PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:115  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure NET$ADDR2IP.

   Procedure NET$ADDR2IP requires 56 words for executable code.
   Procedure NET$ADDR2IP requires 10 words of local(AUTO) storage.

    No errors detected in file TCP$HEP.:TCA2TSI    .

PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:116  

 Object Unit name= NET$ADDR2IP                                File name= TCP$HEP.:TCA2TOU
 UTS= NOV 16 '97 14:24:55.04 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    56     70  NET$ADDR2IP
    1  RoData even  none     1      1  NET$ADDR2IP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  NET$ADDR2IP
     0     47                  yes      Std        2  TCP$WAIT
     0     56                  yes      Std        2  IP$WAIT
     0     65                  yes      Std        1  TCP$USER_TIMEOUT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 XSL$HTONL
 yes     yes           Std       2 XSL$INET_NTOA
 yes     yes           Std       2 TCP$WAIT1
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:117  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:118  


      477        1        /*T***********************************************************/
      478        2        /*T*                                                         */
      479        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      480        4        /*T*                                                         */
      481        5        /*T***********************************************************/
      482        6        NET$ADDR2IP: PROC (PRM1, PRM2);

      6  0 000000   000000 700200 xent  NET$ADDR2IP  TSX0  ! X66_AUTO_2
         0 000001   000012 000002                    ZERO    10,2

      483        7
      484        8    1   DCL PRM1 UBIN;
      485        9    1   DCL PRM2 UBIN;
      486       10    1   DCL 1 NAME BASED ALIGNED,
      487       11    1          2 L# UBIN BYTE CALIGNED,
      488       12    1          2 NAME# CHAR(NAME.L#);
      489       13
      490       14    1   DCL TCP$WAIT1 ENTRY(2) ALTRET;
      491       15    1   DCL XSL$HTONL ENTRY(2);
      492       16    1   DCL XSL$INET_NTOA ENTRY(2) ALTRET;
      493       17    1   DCL XSL$NTOHL ENTRY(2);
      494       18
      495       19    1   DCL P$ PTR;
      496       20    1   DCL RESULT UBIN;
      497       21    1   DCL CHAR31 BASED CHAR(31);
      498       22
      499       23    1      RESULT = PRM2/16;

     23  0 000002   200004 470500                    LDP0    @PRM2,,AUTO
         0 000003   000000 236100                    LDQ     0,,PR0
         0 000004   000004 772000                    QRL     4
         0 000005   200006 756100                    STQ     RESULT,,AUTO

      500       24    1      CALL XSL$HTONL(RESULT, RESULT);

     24  0 000006   200006 631500                    EPPR1   RESULT,,AUTO
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:119  
         0 000007   200011 451500                    STP1    RESULT+3,,AUTO
         0 000010   200006 633500                    EPPR3   RESULT,,AUTO
         0 000011   200010 453500                    STP3    RESULT+2,,AUTO
         0 000012   200010 630500                    EPPR0   RESULT+2,,AUTO
         0 000013   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000014   000000 701000 xent               TSX1    XSL$HTONL
         0 000015   000000 011000                    NOP     0

      501       25    1      CALL XSL$INET_NTOA (P$, RESULT);

     25  0 000016   200006 630500                    EPPR0   RESULT,,AUTO
         0 000017   200011 450500                    STP0    RESULT+3,,AUTO
         0 000020   200005 631500                    EPPR1   P$,,AUTO
         0 000021   200010 451500                    STP1    RESULT+2,,AUTO
         0 000022   200010 630500                    EPPR0   RESULT+2,,AUTO
         0 000023   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000024   000000 701000 xent               TSX1    XSL$INET_NTOA
         0 000025   000000 011000                    NOP     0

      502       26    1      CALL INDEX(RESULT, BINASC(0), P$->CHAR31);

     26  0 000026   200005 470500                    LDP0    P$,,AUTO
         0 000027   000000 124500                    SCM     mask='000'O
         0 000030   000000 000037                    ADSC9   0,,PR0                   cn=0,n=31
         0 000031   000000 000001 1                  ADSC9   0                        cn=0,n=1
         0 000032   200006 000100                    ARG     RESULT,,AUTO

      503       27    1      ADDR(PRM1)->NAME.L# = RESULT;

     27  0 000033   200003 471500                    LDP1    @PRM1,,AUTO
         0 000034   200006 236100                    LDQ     RESULT,,AUTO
         0 000035   000033 736000                    QLS     27
         0 000036   100000 552140                    STBQ    0,'40'O,PR1

      504       28    1      ADDR(PRM1)->NAME.NAME# = P$->CHAR31;

     28  0 000037   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:120  
         0 000040   000033 772000                    QRL     27
         0 000041   200005 470500                    LDP0    P$,,AUTO
         0 000042   000000 620006                    EAX0    0,QL
         0 000043   040140 100500                    MLR     fill='040'O
         0 000044   000000 000037                    ADSC9   0,,PR0                   cn=0,n=31
         0 000045   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0

      505       29    1      RETURN;

     29  0 000046   000000 702200 xent               TSX2  ! X66_ARET

      506       30
      507       31    1   TCP$WAIT: ENTRY (PRM1, PRM2);

     31  0 000047   000000 700200 xent  TCP$WAIT     TSX0  ! X66_AUTO_2
         0 000050   000012 000002                    ZERO    10,2

      508       32    1      CALL TCP$WAIT1 (PRM1, PRM2);

     32  0 000051   200003 630500                    EPPR0   @PRM1,,AUTO
         0 000052   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000053   000000 701000 xent               TSX1    TCP$WAIT1
         0 000054   000000 011000                    NOP     0

      509       33    1      RETURN;

     33  0 000055   000000 702200 xent               TSX2  ! X66_ARET

      510       34
      511       35    1   IP$WAIT: ENTRY (PRM1, PRM2);

     35  0 000056   000000 700200 xent  IP$WAIT      TSX0  ! X66_AUTO_2
         0 000057   000012 000002                    ZERO    10,2

      512       36    1      CALL TCP$WAIT1 (PRM1, PRM2);

     36  0 000060   200003 630500                    EPPR0   @PRM1,,AUTO
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:121  
         0 000061   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000062   000000 701000 xent               TSX1    TCP$WAIT1
         0 000063   000000 011000                    NOP     0

      513       37    1      RETURN;

     37  0 000064   000000 702200 xent               TSX2  ! X66_ARET

      514       38
      515       39    1   TCP$USER_TIMEOUT: ENTRY (PRM1);

     39  0 000065   000000 700200 xent  TCP$USER_TI* TSX0  ! X66_AUTO_2
         0 000066   000012 000002                    ZERO    10,2

      516       40    1      RETURN;

     40  0 000067   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000040 040040                                                    .
      517       41
      518       42    1   END;

PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:122  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure NET$ADDR2IP.
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:123  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PRM1                      4-0-0/w PTR         r     1 @PRM2
     5-0-0/w PTR         r     1 P$                        *0-0-0/w UBIN        r     1 PRM1
    *0-0-0/w UBIN        r     1 PRM2                       6-0-0/w UBIN        r     1 RESULT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(31)    r     1 CHAR31                     0-0-0/w ASTR(9)     r     1 NAME


   Procedure NET$ADDR2IP requires 56 words for executable code.
   Procedure NET$ADDR2IP requires 10 words of local(AUTO) storage.

    No errors detected in file TCP$HEP.:TCA2TSI    .
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:124  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:125  
          MINI XREF LISTING

CHAR31
        21**DCL        26>>CALLBLT    28>>ASSIGN
NAME.L#
        11**DCL        12--IMP-SIZ    27<<ASSIGN     28>>ASSIGN
NAME.NAME#
        12**DCL        28<<ASSIGN
P$
        19**DCL        25<>CALL       26>>CALLBLT    28>>ASSIGN
PRM1
         8**DCL         6--PROC       27--ASSIGN     28--ASSIGN     28--ASSIGN     31--ENTRY      32<>CALL
        35--ENTRY      36<>CALL       39--ENTRY
PRM2
         9**DCL         6--PROC       23>>ASSIGN     31--ENTRY      32<>CALL       35--ENTRY      36<>CALL
RESULT
        20**DCL        23<<ASSIGN     24<>CALL       24<>CALL       25<>CALL       26<<CALLBLT    27>>ASSIGN
TCP$WAIT1
        14**DCL-ENT    32--CALL       36--CALL
XSL$HTONL
        15**DCL-ENT    24--CALL
XSL$INET_NTOA
        16**DCL-ENT    25--CALL
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:126  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #003=NET$ADDR2IP File=TCP$HEP.:TCA2TSI                             SUN 11/16/97 14:24 Page:127  
              MINI UREF LISTING

IP$WAIT      35**ENTRY
NET$ADDR2IP       6**PROC
TCP$USER_TIMEOUT      39**ENTRY
TCP$WAIT      31**ENTRY
XSL$NTOHL      17**DCL-ENT
