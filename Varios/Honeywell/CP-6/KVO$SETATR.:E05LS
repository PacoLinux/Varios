VERSION E05

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:1    
        1        1        /*M* KVO$SETATR Set attributes (graphic rendition, input qualification) */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVO$SETATR: PROC(PRM_USR_SETATR);
        9        9
       10       10        /* Include files  */
       11       11
       12       12        %INCLUDE K_CP6_M;
       13      208        %G#QLF_E;
       14      218        %INCLUDE KV_ASCCHR_E;
       15      355 S      %INCLUDE KV_GLBCNS_E;
       16      356        %KV_DVCCTR_E;
       17      371        %KV_PHSPSTMOD_E;
       18      378        %INCLUDE KV_ERD_E;
       19      465        %INCLUDE KV_INT_M;
       20      608 S      %INCLUDE KV$GLB;
       21      609 S      %INCLUDE KV$GLBCTX;
       22      610 S      %INCLUDE KV$USR;
       23      611 S      %INCLUDE KV$VDH;
       24      612
       25      613        /* Parameters */
       26      614
       27      615         %KV$USR_SETATR(NAME = PRM_USR_SETATR, STCLASS = );
       28      738        %EQU Y_OTPBFRBYTSIZ = 64;
       29      739
       30      740        /* Auto */
       31      741
       32      742    1   DCL Y@ERD$ PTR AUTO;
       33      743    1   DCL OTPBFR CHAR(%Y_OTPBFRBYTSIZ);       /* Buffer for write                   */
       34      744    1   DCL OTPBFR_BYT(0:%(Y_OTPBFRBYTSIZ-1)) REDEF OTPBFR UBIN BYTE UNAL;
       35      745    1   DCL OTPBFRX UBIN;                       /* Buffer index                       */
       36      746    1   DCL TMP UBIN;
       37      747
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:2    
       38      748        /* Based Structures */
       39      749
       40      750    1   DCL Y$CHR CHAR(1) CALIGNED BASED;
       41      751        %KV$ERD (STCLASS = "BASED(Y@ERD$)");
       42      835        %KV$MRD;
       43      882        %KV$PTR;
       44      925        %KV$SRD;
       45     1200        %KV$VDI;
       46     1271
       47     1272        /* External Calls */
       48     1273
       49     1274    1   DCL KVV$CALUSR_PST ENTRY ALTRET;        /* Call VDH-user for positioning      */
       50     1275    1   DCL KVO$DVCCTR ENTRY(1);                /* DVCCTR entry point                 */
       51     1276        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:3    
       52     1277        /*                 MACROs                                                     */
       53     1278
       54     1279        /* This macro checks to see if the given attribute bit is set in
       55     1280           PRM_USR_SETATR and if it is, the given ANSCODE is buffered followed
       56     1281           by a semicolon if this is not the last selective parameter.  If
       57     1282           this is the last selective parameter, an 'm' (the final character)
       58     1283           is buffered instead.                                                       */
       59     1284
       60     1285        %MACRO SETANS (ATR=PRM_USR_SETATR, ANSCODE=0);
       61     1286           IF PRM_USR_SETATR.GRPRND.ATR THEN
       62     1287           DO;
       63     1288              OTPBFR_BYT(OTPBFRX) = ANSCODE;
       64     1289              OTPBFR_BYT(OTPBFRX+1) = BITBIN(%ASCIISEMCLN);
       65     1290              OTPBFRX = OTPBFRX+2;
       66     1291           END;
       67     1292        %MEND;
       68     1293
       69     1294        /*  Buffer a KV$ERD variable-length character string. */
       70     1295
       71     1296        %MACRO BFRERDCHRSTR (SOURCE=, EXIT_STMT=);
       72     1297        %LSET LISTSUB='1'B;
       73     1298        %LSET LISTEXP='1'B;
       74     1299           IF KV$ERD.SOURCE ~= 0 THEN
       75     1300           DO;
       76     1301              TMP = KV$ERD.CNT(KV$ERD.SOURCE);
       77     1302              IF TMP>%Y_OTPBFRBYTSIZ-OTPBFRX THEN CALL Y$OTP;
       78     1303              IF TMP>%Y_OTPBFRBYTSIZ-1 THEN EXIT;
       79     1304              SUBSTR(OTPBFR,OTPBFRX,TMP) = SUBSTR(KV$ERD.TXT,KV$ERD.SOURCE+1,TMP);
       80     1305              OTPBFRX = OTPBFRX+TMP;
       81     1306              EXIT_STMT;END;
       82     1307        %MEND;
       83     1308        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:4    
       84     1309    1      Y@ERD$ = %KV_MRD.ERD$;
       85     1310
       86     1311        /* Don't do anything if this device does not support attributes               */
       87     1312
       88     1313    1      IF KV$ERD.DCLFLD_ALG=%KV_DCLFLD_ALG_NON THEN RETURN;
       89     1314    1      OTPBFRX = 1;
       90     1315
       91     1316        /* Take care of any pending positioning that matters.                     */
       92     1317
       93     1318    1      IF %KV_VDI.OTPCNDPND.PST=%KV_PHSPSTMOD_BLN
       94     1319    1        OR %KV_VDI.OTPCNDPND.PST~=0 AND KV$ERD.DCLFLD_ALG=3
       95     1320    1      THEN CALL KVV$CALUSR_PST;
       96     1321
       97     1322        /* Call the appropriate routine, depending on the positioning
       98     1323           algorithm we are using.                                                    */
       99     1324
      100     1325    2      DO CASE (KV$ERD.DCLFLD_ALG);
      101     1326
      102     1327    2      CASE(%KV_DCLFLD_ALG_ANS);
      103     1328
      104     1329    2         CALL Y$PSTTO_FLD;
      105     1330    2         CALL Y$ANSX364;
      106     1331
      107     1332    2      CASE(%KV_DCLFLD_ALG_2);
      108     1333
      109     1334    2         CALL Y$DAQSGR;
      110     1335
      111     1336    2      CASE(3);
      112     1337
      113     1338    2         CALL Y$DAQSGR;
      114     1339    2      END;                                 /* CASE                               */
      115     1340
      116     1341        /* If anything was stuffed into the output buffer, write it out               */
      117     1342
      118     1343    1      CALL Y$OTP;
      119     1344    1      RETURN;
      120     1345        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:5    
      121     1346    1   Y$DAQSGR: PROC;
      122     1347
      123     1348    2   DCL 1 Y@MASK,
      124     1349    2          2 CHR UBIN(8) UNAL,
      125     1350    2          2 * BIT(8);
      126     1351
      127     1352        /* Make sure that an SGR_ALG exists                                           */
      128     1353
      129     1354    2      IF KV$ERD.SGR_ALG=%KV_SGR_ALG_NON THEN RETURN;
      130     1355
      131     1356        /* Buffer the enter mode sequence if it exists                                */
      132     1357
      133     1358           %BFRERDCHRSTR(SOURCE = DCLFRM_CHR);
      134     1370
      135     1371        /* Position to start of field if and only if this device does not    */
      136     1372        /* follow algorithm three                                            */
      137     1373
      138     1374    2      IF KV$ERD.DCLFLD_ALG~=3 THEN CALL Y$PSTTO_FLD;
      139     1375
      140     1376        /* Determine which SGR_ALG to use                                             */
      141     1377
      142     1378    3      DO CASE (KV$ERD.SGR_ALG);
      143     1379
      144     1380        /* This device follows the ANS X3.64 standard                                */
      145     1381
      146     1382    3      CASE(%KV_SGR_ALG_ANS);
      147     1383
      148     1384    3         CALL Y$ANSX364;
      149     1385
      150     1386        /* In order to declare attributes on this device, a seperate
      151     1387           sequence must be sent for each attribute to be declared.  This
      152     1388           sequence consists of an option SGR_INTRO sequence followed by the
      153     1389           character which determines what attribute is selected.  If attributes
      154     1390           take up a position on this device, we will send a BS character following
      155     1391           each attribute decleration sequence.                                       */
      156     1392
      157     1393    3      CASE(%KV_SGR_ALG_2);
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:6    
      158     1394
      159     1395        /* If DLTFLD is required, and there is a DLTFLD string in KV$ERD, use it. */
      160     1396
      161     1397    3         IF PRM_USR_SETATR.DLTFLD
      162     1398    3           AND (PRM_USR_SETATR.PHSPST.CLM~=1
      163     1399    4           OR NOT %KV_MRD.FRSCLMFLD) THEN DO;
      164     1400                 %BFRERDCHRSTR(SOURCE=DLTFLD_CHR, EXIT_STMT=GOTO ERDDONE);
      165     1412    4         END;
      166     1413
      167     1414        /* Start by sending the reset attributes sequence.  If no attributes
      168     1415           are desired, that's all that will happen.                                  */
      169     1416
      170     1417              %BFRERDCHRSTR(SOURCE = RESTORE_DFLTSCRN_CHR, EXIT_STMT=DO);
      171     1429        /* FORMAT.X can't see the DO; from EXIT_STMT,
      172     1430           so here's one it can see but PL6 can't.  */
      173     1431    5         %CHARTEXT('/*'); DO; %CHARTEXT('*/')
      174     1432    5            IF %KV_MRD.ATRRQRDSPPST THEN DO;
      175     1433    5               %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;
      176     1434    5               %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;
      177     1435    5            END;
      178     1436    4         END;
      179     1437    3         IF PRM_USR_SETATR.GRPRND.HDN THEN CALL Y$SGR2 (%KV$ERD_SGRHDN_CHR#/8);
      180     1438    3         IF PRM_USR_SETATR.GRPRND.INCINT THEN CALL Y$SGR2 (%KV$ERD_SGRINCINT_CHR#/8);
      181     1439    3         IF PRM_USR_SETATR.GRPRND.DCRINT THEN CALL Y$SGR2 (%KV$ERD_SGRDCRINT_CHR#/8);
      182     1440    3         IF PRM_USR_SETATR.GRPRND.UNDSCR THEN CALL Y$SGR2 (%KV$ERD_SGRUNDSCR_CHR#/8);
      183     1441    3         IF PRM_USR_SETATR.GRPRND.SLWBLN THEN CALL Y$SGR2 (%KV$ERD_SGRSLWBLN_CHR#/8);
      184     1442    3         IF PRM_USR_SETATR.GRPRND.FSTBLN THEN CALL Y$SGR2 (%KV$ERD_SGRFSTBLN_CHR#/8);
      185     1443    3         IF PRM_USR_SETATR.GRPRND.RVRVID THEN CALL Y$SGR2 (%KV$ERD_SGRRVRVID_CHR#/8);
      186     1444    3         IF NOT KV$ERD.SGRINCDAQ THEN EXIT;
      187     1445    3         IF PRM_USR_SETATR.QLF&%(G#QLF_PRT|G#QLF_CNS|G#QLF_PRTGRD)
      188     1446    3         THEN IF KV$ERD.DFLMODPRT THEN EXIT; ELSE;
      189     1447    3         ELSE IF NOT KV$ERD.DFLMODPRT THEN EXIT;
      190     1448    3         IF KV$ERD.DFLMODPRT THEN CALL Y$SGR2 (%KV$ERD_DAQINP_CHR#/8);
      191     1449    3         ELSE CALL Y$SGR2 (%KV$ERD_DAQPRT_CHR#/8);
      192     1450
      193     1451        /* A bit mask must be contructed by ORing together a single charcter
      194     1452           for each attribute to be declared on the screen.  This bit mak is then
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:7    
      195     1453           buffered following an option SGR_INTRO sequence.                           */
      196     1454
      197     1455    3      CASE(%KV_SGR_ALG_3);
      198     1456
      199     1457        /* If DLTFLD is required, and there is a DLTFLD string in KV$ERD, use it. */
      200     1458
      201     1459    3         IF PRM_USR_SETATR.DLTFLD
      202     1460    3           AND (PRM_USR_SETATR.PHSPST.CLM~=1
      203     1461    4           OR NOT %KV_MRD.FRSCLMFLD) THEN DO;
      204     1462                 %BFRERDCHRSTR(SOURCE=DLTFLD_CHR, EXIT_STMT=GOTO ERDDONE);
      205     1474    4         END;
      206     1475
      207     1476        /* First check to see if no bits are set in PRM_USR_SETATR, indicating
      208     1477           that the restore sequence must be sent to restore the scrren to its
      209     1478           default state.                                                             */
      210     1479
      211     1480    4         IF PRM_USR_SETATR.GRPRND = '0'B THEN DO;
      212     1481                 %BFRERDCHRSTR (SOURCE=RESTORE_DFLTSCRN_CHR, EXIT_STMT=GOTO ERDDONE);
      213     1493    4         END;
      214     1494
      215     1495        /* Otherwise, we want to init the bit mask and set a bit for each attribute
      216     1496           we want to set.                                                            */
      217     1497
      218     1498    3         Y@MASK = '0'B;
      219     1499              %BFRERDCHRSTR(SOURCE = SGRINTRO_CHR);
      220     1511    3         IF ASCBIT(KV$ERD.SGRHDN_CHR) AND PRM_USR_SETATR.GRPRND.HDN
      221     1512    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRHDN_CHR);
      222     1513    3         IF PRM_USR_SETATR.GRPRND.INCINT
      223     1514    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRINCINT_CHR);
      224     1515    3         IF PRM_USR_SETATR.GRPRND.DCRINT
      225     1516    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRDCRINT_CHR);
      226     1517    3         IF PRM_USR_SETATR.GRPRND.UNDSCR
      227     1518    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRUNDSCR_CHR);
      228     1519    3         IF PRM_USR_SETATR.GRPRND.SLWBLN
      229     1520    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRSLWBLN_CHR);
      230     1521    3         IF PRM_USR_SETATR.GRPRND.FSTBLN
      231     1522    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRFSTBLN_CHR);
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:8    
      232     1523    3         IF PRM_USR_SETATR.GRPRND.RVRVID
      233     1524    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRRVRVID_CHR);
      234     1525
      235     1526        /* Buffer the bit mask                                                        */
      236     1527
      237     1528    3         OTPBFR_BYT(OTPBFRX) = Y@MASK.CHR;
      238     1529    3         OTPBFRX = OTPBFRX+1;
      239     1530    3   ERDDONE:;
      240     1531    4         IF %KV_MRD.ATRRQRDSPPST THEN DO;
      241     1532    4            %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;
      242     1533    4            %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;
      243     1534    4         END;
      244     1535    3      END;                                 /* CASE                               */
      245     1536
      246     1537        /* If the terminal was in any sort of special forms declaration mode
      247     1538           send the sequence to cause it to exit this mode.                           */
      248     1539
      249     1540           %BFRERDCHRSTR(SOURCE = ENDDCLFRM_CHR);
      250     1552    2      RETURN;
      251     1553    2   END;
      252     1554        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:9    
      253     1555    1   Y$ANSX364: PROC;
      254     1556
      255     1557        /* If DLTFLD is required, and there is a DLTFLD string in KV$ERD, use it. */
      256     1558
      257     1559    2      IF PRM_USR_SETATR.DLTFLD
      258     1560    2        AND (PRM_USR_SETATR.PHSPST.CLM~=1
      259     1561    3        OR NOT %KV_MRD.FRSCLMFLD) THEN DO;
      260     1562              %BFRERDCHRSTR(SOURCE=DLTFLD_CHR, EXIT_STMT=GOTO ANSDONE);
      261     1574    3      END;
      262     1575    2      IF OTPBFRX>%Y_OTPBFRBYTSIZ-18 THEN CALL Y$OTP;
      263     1576
      264     1577        /* Buffer the ESC [ sequence followed by 0 and ; since most terms want that.  */
      265     1578
      266     1579    2      SUBSTR(OTPBFR,OTPBFRX,4) = %CONCAT(BITASC(ASCIIESC),'[0;');
      267     1580    2      OTPBFRX = OTPBFRX+4;
      268     1581
      269     1582        /* Buffer an ANS sequence for each set bit in PRM_USR_SETATR.  Following     */
      270     1583        /* the last selective param, the proc buffers a 'm'.                          */
      271     1584
      272     1585    3      IF ASCBIT(KV$ERD.SGRHDN_CHR) THEN DO;
      273     1586        /* Since hidden is non-standard X3.64, only send what the profile specifies */
      274     1587              %SETANS (ATR = HDN, ANSCODE = "BITBIN(%ASCII8)");
      275     1595    3      END;
      276     1596           %SETANS (ATR = INCINT, ANSCODE = "BITBIN(%ASCII1)");
      277     1604           %SETANS (ATR = DCRINT, ANSCODE = "BITBIN(%ASCII2)");
      278     1612           %SETANS (ATR = UNDSCR, ANSCODE = "BITBIN(%ASCII4)");
      279     1620           %SETANS (ATR = SLWBLN, ANSCODE = "BITBIN(%ASCII5)");
      280     1628           %SETANS (ATR = FSTBLN, ANSCODE = "BITBIN(%ASCII6)");
      281     1636           %SETANS (ATR = RVRVID, ANSCODE = "BITBIN(%ASCII7)");
      282     1644    2      OTPBFR_BYT(OTPBFRX-1) = BITBIN(%ASCIILCM);
      283     1645    2   ANSDONE:;
      284     1646    3      IF %KV_MRD.ATRRQRDSPPST THEN DO;
      285     1647    3         %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;
      286     1648    3         %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;
      287     1649    3      END;
      288     1650    2   END;
      289     1651        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:10   
      290     1652    1   Y$SGR2: PROC (ATR);
      291     1653
      292     1654    2   DCL Y@ERDBIN(0:0) BASED(Y@ERD$) UBIN BYTE CALIGNED;
      293     1655    2   DCL ATR SBIN;
      294     1656    3      IF Y@ERDBIN (ATR)~=0 THEN DO;
      295     1657    3         IF KV$ERD.DCLFLD_ALG~=3 THEN CALL Y$PSTTO_FLD;
      296     1658              %BFRERDCHRSTR(SOURCE = SGRINTRO_CHR);
      297     1670    3         OTPBFR_BYT(OTPBFRX) = Y@ERDBIN (ATR);
      298     1671    3         OTPBFRX = OTPBFRX+1;
      299     1672    4         IF %KV_MRD.ATRRQRDSPPST THEN DO;
      300     1673    4            %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;
      301     1674    4            %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;
      302     1675    4         END;
      303     1676    3      END;
      304     1677    2      RETURN;
      305     1678    2   END Y$SGR2;
      306     1679        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:11   
      307     1680    1   Y$PSTTO_FLD: PROC;
      308     1681
      309     1682        /* Position to start of field (the attribute location)                        */
      310     1683
      311     1684    2      IF %KV_SRD.CRT_PST=PRM_USR_SETATR.PHSPST_PST AND %KV_VDI.OTPCNDPND.PST=0
      312     1685    2      THEN RETURN;
      313     1686    2      IF OTPBFRX>1 THEN CALL Y$OTP;
      314     1687    2      %KV_SRD.CRT = PRM_USR_SETATR.PHSPST;
      315     1688    2      %KV_SRD.HI_NONBLN = PRM_USR_SETATR.PHSPST;
      316     1689    2      %KV_VDI.OTPCNDPND.PST = %KV_PHSPSTMOD_SKP;
      317     1690    2      CALL KVV$CALUSR_PST;
      318     1691
      319     1692    2      RETURN;
      320     1693    2   END;
      321     1694    1   Y$OTP: PROC;
      322     1695
      323     1696        /* If anything was stuffed into the output buffer, write it out               */
      324     1697
      325     1698    3      IF OTPBFRX>1 THEN DO;
      326     1699    3         OTPBFR_BYT(0) = OTPBFRX-1;
      327     1700    3         OTPBFRX = 1;
      328     1701    3         CALL KVO$DVCCTR (OTPBFR);
      329     1702    3      END;
      330     1703    2   END;
      331     1704    1   END;

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:12   
--  Include file information  --

   KV_INT_M.:E05TOU  is referenced.
   KV_ERD_E.:E05TOU  is referenced.
   KV_ASCCHR_E.:E05TOU  is referenced.
   K_CP6_M.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is never referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$SETATR.

   Procedure KVO$SETATR requires 1233 words for executable code.
   Procedure KVO$SETATR requires 56 words of local(AUTO) storage.

    No errors detected in file KVO$SETATR.:E05TSI    .

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:13   

 Object Unit name= KVO$SETATR                                 File name= KVO$SETATR.:E05TOU
 UTS= JUL 30 '97 02:11:35.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS      2      2  KVO$SETATR
    1   Proc  even  none  1233    4D1  KVO$SETATR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KVO$SETATR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 KVV$CALUSR_PST
         yes           Std       1 KVO$DVCCTR
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KV$PTR$                          r    G$ROS$
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:14   


        1        1        /*M* KVO$SETATR Set attributes (graphic rendition, input qualification) */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVO$SETATR: PROC(PRM_USR_SETATR);

      8   1 000000  D380 0000 0000  xent KVO$SETATR      LNJ,B5   X6A_AUTO_1
          1 000003       0038 0001                       DC       56,1

        9        9
       10       10        /* Include files  */
       11       11
       12       12        %INCLUDE K_CP6_M;
       13      208        %G#QLF_E;
       14      218        %INCLUDE KV_ASCCHR_E;
       15      355 S      %INCLUDE KV_GLBCNS_E;
       16      356        %KV_DVCCTR_E;
       17      371        %KV_PHSPSTMOD_E;
       18      378        %INCLUDE KV_ERD_E;
       19      465        %INCLUDE KV_INT_M;
       20      608 S      %INCLUDE KV$GLB;
       21      609 S      %INCLUDE KV$GLBCTX;
       22      610 S      %INCLUDE KV$USR;
       23      611 S      %INCLUDE KV$VDH;
       24      612
       25      613        /* Parameters */
       26      614
       27      615         %KV$USR_SETATR(NAME = PRM_USR_SETATR, STCLASS = );
       28      738        %EQU Y_OTPBFRBYTSIZ = 64;
       29      739
       30      740        /* Auto */
       31      741
       32      742    1   DCL Y@ERD$ PTR AUTO;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:15   
       33      743    1   DCL OTPBFR CHAR(%Y_OTPBFRBYTSIZ);       /* Buffer for write                   */
       34      744    1   DCL OTPBFR_BYT(0:%(Y_OTPBFRBYTSIZ-1)) REDEF OTPBFR UBIN BYTE UNAL;
       35      745    1   DCL OTPBFRX UBIN;                       /* Buffer index                       */
       36      746    1   DCL TMP UBIN;
       37      747
       38      748        /* Based Structures */
       39      749
       40      750    1   DCL Y$CHR CHAR(1) CALIGNED BASED;
       41      751        %KV$ERD (STCLASS = "BASED(Y@ERD$)");
       42      835        %KV$MRD;
       43      882        %KV$PTR;
       44      925        %KV$SRD;
       45     1200        %KV$VDI;
       46     1271
       47     1272        /* External Calls */
       48     1273
       49     1274    1   DCL KVV$CALUSR_PST ENTRY ALTRET;        /* Call VDH-user for positioning      */
       50     1275    1   DCL KVO$DVCCTR ENTRY(1);                /* DVCCTR entry point                 */
       51     1276        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:16   
       52     1277        /*                 MACROs                                                     */
       53     1278
       54     1279        /* This macro checks to see if the given attribute bit is set in
       55     1280           PRM_USR_SETATR and if it is, the given ANSCODE is buffered followed
       56     1281           by a semicolon if this is not the last selective parameter.  If
       57     1282           this is the last selective parameter, an 'm' (the final character)
       58     1283           is buffered instead.                                                       */
       59     1284
       60     1285        %MACRO SETANS (ATR=PRM_USR_SETATR, ANSCODE=0);
       61     1286           IF PRM_USR_SETATR.GRPRND.ATR THEN
       62     1287           DO;
       63     1288              OTPBFR_BYT(OTPBFRX) = ANSCODE;
       64     1289              OTPBFR_BYT(OTPBFRX+1) = BITBIN(%ASCIISEMCLN);
       65     1290              OTPBFRX = OTPBFRX+2;
       66     1291           END;
       67     1292        %MEND;
       68     1293
       69     1294        /*  Buffer a KV$ERD variable-length character string. */
       70     1295
       71     1296        %MACRO BFRERDCHRSTR (SOURCE=, EXIT_STMT=);
       72     1297        %LSET LISTSUB='1'B;
       73     1298        %LSET LISTEXP='1'B;
       74     1299           IF KV$ERD.SOURCE ~= 0 THEN
       75     1300           DO;
       76     1301              TMP = KV$ERD.CNT(KV$ERD.SOURCE);
       77     1302              IF TMP>%Y_OTPBFRBYTSIZ-OTPBFRX THEN CALL Y$OTP;
       78     1303              IF TMP>%Y_OTPBFRBYTSIZ-1 THEN EXIT;
       79     1304              SUBSTR(OTPBFR,OTPBFRX,TMP) = SUBSTR(KV$ERD.TXT,KV$ERD.SOURCE+1,TMP);
       80     1305              OTPBFRX = OTPBFRX+TMP;
       81     1306              EXIT_STMT;END;
       82     1307        %MEND;
       83     1308        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:17   
       84     1309    1      Y@ERD$ = %KV_MRD.ERD$;

   1309   1 000005  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000008  DCC6 0008                            LDB,B5   8,B6
          1 00000A  CCC5 0008                            LDB,B4   8,B5
          1 00000C  CFC7 0006                            STB,B4   Y@ERD$,AUTO

       85     1310
       86     1311        /* Don't do anything if this device does not support attributes               */
       87     1312
       88     1313    1      IF KV$ERD.DCLFLD_ALG=%KV_DCLFLD_ALG_NON THEN RETURN;

   1313   1 00000E  E2C4 0018                            LLH,R6   24,B4
          1 000010  6981 0004                            BNEZ,R6  s:1314,PREL

   1313   1 000012  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

       89     1314    1      OTPBFRX = 1;

   1314   1 000015  5C01                                 LDV,R5   1
          1 000016  DF47 0028                            STR,R5   OTPBFRX,AUTO

       90     1315
       91     1316        /* Take care of any pending positioning that matters.                     */
       92     1317
       93     1318    1      IF %KV_VDI.OTPCNDPND.PST=%KV_PHSPSTMOD_BLN

   1318   1 000018  BC86                                 LDB,B3   ,B6
          1 000019  C843 001A                            LDR,R4   26,B3
          1 00001B  4D02                                 CMV,R4   2
          1 00001C  0901 0006                            BE       s:1320,PREL
          1 00001E  4901 000A                            BEZ,R4   s:1325,PREL
          1 000020  6D03                                 CMV,R6   3
          1 000021  0981 0007                            BNE      s:1325,PREL

       94     1319    1        OR %KV_VDI.OTPCNDPND.PST~=0 AND KV$ERD.DCLFLD_ALG=3
       95     1320    1      THEN CALL KVV$CALUSR_PST;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:18   

   1320   1 000023  CBF0 0000                            LAB,B4   0,IMO
          1 000025  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR_PST
          1 000028       0001                            DC       s:1325,PREL

       96     1321
       97     1322        /* Call the appropriate routine, depending on the positioning
       98     1323           algorithm we are using.                                                    */
       99     1324
      100     1325    2      DO CASE (KV$ERD.DCLFLD_ALG);

   1325   1 000029  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 00002B  B2C6 0018                            LLH,R3   24,B6
          1 00002D  3D04                                 CMV,R3   4
          1 00002E  0281 001B                            BGE      s:1343,PREL
          1 000030  A830 0000 0036  01                   LDR,R2   s:1325+13,R3
          1 000033  83A0 0000 003A  01                   JMP      s:1329,R2
          1 000036       0010                            DC       s:1343,PREL
          1 000037       0000                            DC       s:1329,PREL
          1 000038       0008                            DC       s:1334,PREL
          1 000039       000D                            DC       s:1338,PREL

      101     1326
      102     1327    2      CASE(%KV_DCLFLD_ALG_ANS);

      103     1328
      104     1329    2         CALL Y$PSTTO_FLD;

   1329   1 00003A  E3C0 0438                            LNJ,B6   s:0,PREL
          1 00003C       0001                            DC       s:1330,PREL

      105     1330    2         CALL Y$ANSX364;

   1330   1 00003D  E3C0 02E0                            LNJ,B6   s:0,PREL
          1 00003F       0001                            DC       s:1330+3,PREL
          1 000040  0F81 0009                            B        s:1343,PREL

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:19   
      106     1331
      107     1332    2      CASE(%KV_DCLFLD_ALG_2);

      108     1333
      109     1334    2         CALL Y$DAQSGR;

   1334   1 000042  E3C0 000D                            LNJ,B6   s:0,PREL
          1 000044       0001                            DC       s:1334+3,PREL
          1 000045  0F81 0004                            B        s:1343,PREL

      110     1335
      111     1336    2      CASE(3);

      112     1337
      113     1338    2         CALL Y$DAQSGR;

   1338   1 000047  E3C0 0008                            LNJ,B6   s:0,PREL
          1 000049       0001                            DC       s:1343,PREL

      114     1339    2      END;                                 /* CASE                               */

      115     1340
      116     1341        /* If anything was stuffed into the output buffer, write it out               */
      117     1342
      118     1343    1      CALL Y$OTP;

   1343   1 00004A  E3C0 0469                            LNJ,B6   s:0,PREL
          1 00004C       0001                            DC       s:1344,PREL

      119     1344    1      RETURN;

   1344   1 00004D  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      120     1345        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:20   
      121     1346    1   Y$DAQSGR: PROC;

   1346   1 000050  EFC7 002A            Y$DAQSGR        STB,B6   TMP+1,AUTO

      122     1347
      123     1348    2   DCL 1 Y@MASK,
      124     1349    2          2 CHR UBIN(8) UNAL,
      125     1350    2          2 * BIT(8);
      126     1351
      127     1352        /* Make sure that an SGR_ALG exists                                           */
      128     1353
      129     1354    2      IF KV$ERD.SGR_ALG=%KV_SGR_ALG_NON THEN RETURN;

   1354   1 000052  DCC7 0006                            LDB,B5   Y@ERD$,AUTO
          1 000054  E2C5 0017                            LLH,R6   23,B5
          1 000056  6981 0005                            BNEZ,R6  s:1361,PREL

   1354   1 000058  ECC7 002A                            LDB,B6   TMP+1,AUTO
          1 00005A  C3C6 0001                            LNJ,B4   1,B6

      130     1355
      131     1356        /* Buffer the enter mode sequence if it exists                                */
      132     1357
      133     1358           %BFRERDCHRSTR(SOURCE = DCLFRM_CHR);

   1361   1 00005C  D2C5 0028                            LLH,R5   40,B5
          1 00005E  5901 0029                            BEZ,R5   s:1374,PREL

   1363   1 000060  B855                                 LDR,R3   R5
          1 000061  3E5A                                 ADV,R3   90
          1 000062  C2B5                                 LLH,R4   ,B5,R3
          1 000063  CF47 0029                            STR,R4   TMP,AUTO

   1364   1 000065  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 000067  8253                                 NEG      R3
          1 000068  3E40                                 ADV,R3   64
          1 000069  3801 0004                            BLZ,R3   s:1364+9,PREL
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:21   
          1 00006B  B954                                 CMR,R3   R4
          1 00006C  0281 0004                            BGE      s:1365,PREL

   1364   1 00006E  E3C0 0445                            LNJ,B6   s:0,PREL
          1 000070       0001                            DC       s:1365,PREL

   1365   1 000071  E847 0029                            LDR,R6   TMP,AUTO
          1 000073  6D3F                                 CMV,R6   63
          1 000074  0301 0013                            BG       s:1374,PREL

   1366   1 000076  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000078  D2C6 0028                            LLH,R5   40,B6
          1 00007A  AB86                                 LAB,B2   ,B6
          1 00007B  A855                                 LDR,R2   R5
          1 00007C  2E5B                                 ADV,R2   91
          1 00007D  BB87                                 LAB,B3   ,AUTO
          1 00007E  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 000080  3E10                                 ADV,R3   16
          1 000081  0008                                 MMM

   1367   1 000082  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 000084  EA47 0029                            ADD,R6   TMP,AUTO
          1 000086  EF47 0028                            STR,R6   OTPBFRX,AUTO

      134     1370
      135     1371        /* Position to start of field if and only if this device does not    */
      136     1372        /* follow algorithm three                                            */
      137     1373
      138     1374    2      IF KV$ERD.DCLFLD_ALG~=3 THEN CALL Y$PSTTO_FLD;

   1374   1 000088  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 00008A  E2C6 0018                            LLH,R6   24,B6
          1 00008C  6D03                                 CMV,R6   3
          1 00008D  0901 0004                            BE       s:1378,PREL

   1374   1 00008F  E3C0 03E3                            LNJ,B6   s:0,PREL
          1 000091       0001                            DC       s:1378,PREL
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:22   

      139     1375
      140     1376        /* Determine which SGR_ALG to use                                             */
      141     1377
      142     1378    3      DO CASE (KV$ERD.SGR_ALG);

   1378   1 000092  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000094  B2C6 0017                            LLH,R3   23,B6
          1 000096  3D04                                 CMV,R3   4
          1 000097  0281 024E                            BGE      s:1543,PREL
          1 000099  A830 0000 009F  01                   LDR,R2   s:1378+13,R3
          1 00009C  83A0 0000 00A3  01                   JMP      s:1384,R2
          1 00009F       0243                            DC       s:1543,PREL
          1 0000A0       0000                            DC       s:1384,PREL
          1 0000A1       0005                            DC       s:1397,PREL
          1 0000A2       0120                            DC       s:1459,PREL

      143     1379
      144     1380        /* This device follows the ANS X3.64 standard                                */
      145     1381
      146     1382    3      CASE(%KV_SGR_ALG_ANS);

      147     1383
      148     1384    3         CALL Y$ANSX364;

   1384   1 0000A3  E3C0 027A                            LNJ,B6   s:0,PREL
          1 0000A5       0001                            DC       s:1384+3,PREL
          1 0000A6  0F81 023F                            B        s:1543,PREL

      149     1385
      150     1386        /* In order to declare attributes on this device, a seperate
      151     1387           sequence must be sent for each attribute to be declared.  This
      152     1388           sequence consists of an option SGR_INTRO sequence followed by the
      153     1389           character which determines what attribute is selected.  If attributes
      154     1390           take up a position on this device, we will send a BS character following
      155     1391           each attribute decleration sequence.                                       */
      156     1392
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:23   
      157     1393    3      CASE(%KV_SGR_ALG_2);

      158     1394
      159     1395        /* If DLTFLD is required, and there is a DLTFLD string in KV$ERD, use it. */
      160     1396
      161     1397    3         IF PRM_USR_SETATR.DLTFLD

   1397   1 0000A8  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 0000AA  8285                                 LB,'0040'X        ,B5
          1 0000AB       0040
          1 0000AC  0581 0044                            BBF      s:1420,PREL
          1 0000AE  E845 0002                            LDR,R6   2,B5
          1 0000B0  6D01                                 CMV,R6   1
          1 0000B1  0981 000B                            BNE      s:1403,PREL
          1 0000B3  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 0000B6  BCC4 0008                            LDB,B3   8,B4
          1 0000B8  82C3 0018                            LB,'0010'X        24,B3
          1 0000BA       0010
          1 0000BB  0501 0035                            BBT      s:1420,PREL

      162     1398    3           AND (PRM_USR_SETATR.PHSPST.CLM~=1
      163     1399    4           OR NOT %KV_MRD.FRSCLMFLD) THEN DO;

      164     1400                 %BFRERDCHRSTR(SOURCE=DLTFLD_CHR, EXIT_STMT=GOTO ERDDONE);

   1403   1 0000BD  82C6 002C                            LB,'00FF'X        44,B6
   1403   1 0000BF       00FF
          1 0000C0  0581 0030                            BBF      s:1420,PREL

   1405   1 0000C2  9846 002C                            LDR,R1   44,B6
          1 0000C4  9570 00FF                            AND,R1   255,IMO
          1 0000C6  1E5A                                 ADV,R1   90
          1 0000C7  D296                                 LLH,R5   ,B6,R1
          1 0000C8  DF47 0029                            STR,R5   TMP,AUTO

   1406   1 0000CA  C847 0028                            LDR,R4   OTPBFRX,AUTO
          1 0000CC  8254                                 NEG      R4
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:24   
          1 0000CD  4E40                                 ADV,R4   64
          1 0000CE  4801 0004                            BLZ,R4   s:1406+9,PREL
          1 0000D0  C955                                 CMR,R4   R5
          1 0000D1  0281 0004                            BGE      s:1407,PREL

   1406   1 0000D3  E3C0 03E0                            LNJ,B6   s:0,PREL
          1 0000D5       0001                            DC       s:1407,PREL

   1407   1 0000D6  E847 0029                            LDR,R6   TMP,AUTO
          1 0000D8  6D3F                                 CMV,R6   63
          1 0000D9  0301 0017                            BG       s:1420,PREL

   1408   1 0000DB  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 0000DD  D846 002C                            LDR,R5   44,B6
          1 0000DF  D570 00FF                            AND,R5   255,IMO
          1 0000E1  AB86                                 LAB,B2   ,B6
          1 0000E2  A855                                 LDR,R2   R5
          1 0000E3  2E5B                                 ADV,R2   91
          1 0000E4  BB87                                 LAB,B3   ,AUTO
          1 0000E5  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 0000E7  3E10                                 ADV,R3   16
          1 0000E8  0008                                 MMM

   1409   1 0000E9  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 0000EB  EA47 0029                            ADD,R6   TMP,AUTO
          1 0000ED  EF47 0028                            STR,R6   OTPBFRX,AUTO

   1410   1 0000EF  0F81 01E7                            B        s:1529,PREL

      165     1412    4         END;

      166     1413
      167     1414        /* Start by sending the reset attributes sequence.  If no attributes
      168     1415           are desired, that's all that will happen.                                  */
      169     1416
      170     1417              %BFRERDCHRSTR(SOURCE = RESTORE_DFLTSCRN_CHR, EXIT_STMT=DO);

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:25   
   1420   1 0000F1  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 0000F3  E2C6 0029                            LLH,R6   41,B6
          1 0000F5  6901 0038                            BEZ,R6   s:1437,PREL

   1422   1 0000F7  B856                                 LDR,R3   R6
          1 0000F8  3E5A                                 ADV,R3   90
          1 0000F9  D2B6                                 LLH,R5   ,B6,R3
          1 0000FA  DF47 0029                            STR,R5   TMP,AUTO

   1423   1 0000FC  C847 0028                            LDR,R4   OTPBFRX,AUTO
          1 0000FE  8254                                 NEG      R4
          1 0000FF  4E40                                 ADV,R4   64
          1 000100  4801 0004                            BLZ,R4   s:1423+9,PREL
          1 000102  C955                                 CMR,R4   R5
          1 000103  0281 0004                            BGE      s:1424,PREL

   1423   1 000105  E3C0 03AE                            LNJ,B6   s:0,PREL
          1 000107       0001                            DC       s:1424,PREL

   1424   1 000108  E847 0029                            LDR,R6   TMP,AUTO
          1 00010A  6D3F                                 CMV,R6   63
          1 00010B  0301 0022                            BG       s:1437,PREL

   1425   1 00010D  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 00010F  D2C6 0029                            LLH,R5   41,B6
          1 000111  AB86                                 LAB,B2   ,B6
          1 000112  A855                                 LDR,R2   R5
          1 000113  2E5B                                 ADV,R2   91
          1 000114  BB87                                 LAB,B3   ,AUTO
          1 000115  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 000117  3E10                                 ADV,R3   16
          1 000118  0008                                 MMM

   1426   1 000119  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 00011B  EA47 0029                            ADD,R6   TMP,AUTO
          1 00011D  EF47 0028                            STR,R6   OTPBFRX,AUTO

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:26   
      171     1429        /* FORMAT.X can't see the DO; from EXIT_STMT,
      172     1430           so here's one it can see but PL6 can't.  */
      173     1431    5         %CHARTEXT('/*'); DO; %CHARTEXT('*/')
      174     1432    5            IF %KV_MRD.ATRRQRDSPPST THEN DO;

   1432   1 00011F  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000122  CCC5 0008                            LDB,B4   8,B5
          1 000124  89C4 0018                            CMZ      24,B4
          1 000126  0881 0007                            BAGE     s:1437,PREL

      175     1433    5               %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;

   1433   1 000128  8AC4 001E                            INC      30,B4

      176     1434    5               %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;

   1434   1 00012A  CCC5 000A                            LDB,B4   10,B5
          1 00012C  8AC4 0016                            INC      22,B4

      177     1435    5            END;

      178     1436    4         END;

      179     1437    3         IF PRM_USR_SETATR.GRPRND.HDN THEN CALL Y$SGR2 (%KV$ERD_SGRHDN_CHR#/8);

   1437   1 00012E  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
          1 000130  82C6 0003                            LB,'0040'X        3,B6
          1 000132       0040
          1 000133  0581 0008                            BBF      s:1438,PREL

   1437   1 000135  DBF0 0031                            LAB,B5   49,IMO
          1 000137  DFC7 0030                            STB,B5   Y@MASK+4,AUTO
          1 000139  E3C0 02DA                            LNJ,B6   s:0,PREL
          1 00013B       0001                            DC       s:1438,PREL

      180     1438    3         IF PRM_USR_SETATR.GRPRND.INCINT THEN CALL Y$SGR2 (%KV$ERD_SGRINCINT_CHR#/8);

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:27   
   1438   1 00013C  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
          1 00013E  82C6 0003                            LB,'0020'X        3,B6
          1 000140       0020
          1 000141  0581 0008                            BBF      s:1439,PREL

   1438   1 000143  DBF0 0032                            LAB,B5   50,IMO
          1 000145  DFC7 0030                            STB,B5   Y@MASK+4,AUTO
          1 000147  E3C0 02CC                            LNJ,B6   s:0,PREL
          1 000149       0001                            DC       s:1439,PREL

      181     1439    3         IF PRM_USR_SETATR.GRPRND.DCRINT THEN CALL Y$SGR2 (%KV$ERD_SGRDCRINT_CHR#/8);

   1439   1 00014A  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
          1 00014C  82C6 0003                            LB,'0010'X        3,B6
          1 00014E       0010
          1 00014F  0581 0008                            BBF      s:1440,PREL

   1439   1 000151  DBF0 0033                            LAB,B5   51,IMO
          1 000153  DFC7 0030                            STB,B5   Y@MASK+4,AUTO
          1 000155  E3C0 02BE                            LNJ,B6   s:0,PREL
          1 000157       0001                            DC       s:1440,PREL

      182     1440    3         IF PRM_USR_SETATR.GRPRND.UNDSCR THEN CALL Y$SGR2 (%KV$ERD_SGRUNDSCR_CHR#/8);

   1440   1 000158  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
          1 00015A  82C6 0003                            LB,'0008'X        3,B6
          1 00015C       0008
          1 00015D  0581 0008                            BBF      s:1441,PREL

   1440   1 00015F  DBF0 0034                            LAB,B5   52,IMO
          1 000161  DFC7 0030                            STB,B5   Y@MASK+4,AUTO
          1 000163  E3C0 02B0                            LNJ,B6   s:0,PREL
          1 000165       0001                            DC       s:1441,PREL

      183     1441    3         IF PRM_USR_SETATR.GRPRND.SLWBLN THEN CALL Y$SGR2 (%KV$ERD_SGRSLWBLN_CHR#/8);

   1441   1 000166  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:28   
          1 000168  82C6 0003                            LB,'0004'X        3,B6
          1 00016A       0004
          1 00016B  0581 0008                            BBF      s:1442,PREL

   1441   1 00016D  DBF0 0035                            LAB,B5   53,IMO
          1 00016F  DFC7 0030                            STB,B5   Y@MASK+4,AUTO
          1 000171  E3C0 02A2                            LNJ,B6   s:0,PREL
          1 000173       0001                            DC       s:1442,PREL

      184     1442    3         IF PRM_USR_SETATR.GRPRND.FSTBLN THEN CALL Y$SGR2 (%KV$ERD_SGRFSTBLN_CHR#/8);

   1442   1 000174  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
          1 000176  82C6 0003                            LB,'0002'X        3,B6
          1 000178       0002
          1 000179  0581 0008                            BBF      s:1443,PREL

   1442   1 00017B  DBF0 0036                            LAB,B5   54,IMO
          1 00017D  DFC7 0030                            STB,B5   Y@MASK+4,AUTO
          1 00017F  E3C0 0294                            LNJ,B6   s:0,PREL
          1 000181       0001                            DC       s:1443,PREL

      185     1443    3         IF PRM_USR_SETATR.GRPRND.RVRVID THEN CALL Y$SGR2 (%KV$ERD_SGRRVRVID_CHR#/8);

   1443   1 000182  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
          1 000184  82C6 0003                            LB,'0001'X        3,B6
          1 000186       0001
          1 000187  0581 0008                            BBF      s:1444,PREL

   1443   1 000189  DBF0 0037                            LAB,B5   55,IMO
          1 00018B  DFC7 0030                            STB,B5   Y@MASK+4,AUTO
          1 00018D  E3C0 0286                            LNJ,B6   s:0,PREL
          1 00018F       0001                            DC       s:1444,PREL

      186     1444    3         IF NOT KV$ERD.SGRINCDAQ THEN EXIT;

   1444   1 000190  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000192  82C6 0016                            LB,'0800'X        22,B6
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:29   
          1 000194       0800
          1 000195  0581 0150                            BBF      s:1543,PREL

      187     1445    3         IF PRM_USR_SETATR.QLF&%(G#QLF_PRT|G#QLF_CNS|G#QLF_PRTGRD)

   1445   1 000197  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 000199  E2C5 0003                            LLH,R6   3,B5
          1 00019B  6008                                 SOL,R6   8
          1 00019C  E570 4500                            AND,R6   17664,IMO
          1 00019E  6901 0008                            BEZ,R6   s:1447,PREL

      188     1446    3         THEN IF KV$ERD.DFLMODPRT THEN EXIT; ELSE;

   1446   1 0001A0  82C6 0016                            LB,'0400'X        22,B6
   1446   1 0001A2       0400
          1 0001A3  0501 0142                            BBT      s:1543,PREL
          1 0001A5  0F81 0006                            B        s:1448,PREL

      189     1447    3         ELSE IF NOT KV$ERD.DFLMODPRT THEN EXIT;

   1447   1 0001A7  82C6 0016                            LB,'0400'X        22,B6
   1447   1 0001A9       0400
          1 0001AA  0581 013B                            BBF      s:1543,PREL

      190     1448    3         IF KV$ERD.DFLMODPRT THEN CALL Y$SGR2 (%KV$ERD_DAQINP_CHR#/8);

   1448   1 0001AC  82C6 0016                            LB,'0400'X        22,B6
   1448   1 0001AE       0400
          1 0001AF  0581 000A                            BBF      s:1449,PREL

   1448   1 0001B1  CBF0 003C                            LAB,B4   60,IMO
          1 0001B3  CFC7 0030                            STB,B4   Y@MASK+4,AUTO
          1 0001B5  E3C0 025E                            LNJ,B6   s:0,PREL
          1 0001B7       0001                            DC       s:1448+12,PREL
          1 0001B8  0F81 012D                            B        s:1543,PREL

      191     1449    3         ELSE CALL Y$SGR2 (%KV$ERD_DAQPRT_CHR#/8);
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:30   

   1449   1 0001BA  CBF0 003B                            LAB,B4   59,IMO
          1 0001BC  CFC7 0030                            STB,B4   Y@MASK+4,AUTO
          1 0001BE  E3C0 0255                            LNJ,B6   s:0,PREL
          1 0001C0       0001                            DC       s:1449+7,PREL
          1 0001C1  0F81 0124                            B        s:1543,PREL

      192     1450
      193     1451        /* A bit mask must be contructed by ORing together a single charcter
      194     1452           for each attribute to be declared on the screen.  This bit mak is then
      195     1453           buffered following an option SGR_INTRO sequence.                           */
      196     1454
      197     1455    3      CASE(%KV_SGR_ALG_3);

      198     1456
      199     1457        /* If DLTFLD is required, and there is a DLTFLD string in KV$ERD, use it. */
      200     1458
      201     1459    3         IF PRM_USR_SETATR.DLTFLD

   1459   1 0001C3  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 0001C5  8285                                 LB,'0040'X        ,B5
          1 0001C6       0040
          1 0001C7  0581 0044                            BBF      s:1480,PREL
          1 0001C9  E845 0002                            LDR,R6   2,B5
          1 0001CB  6D01                                 CMV,R6   1
          1 0001CC  0981 000B                            BNE      s:1465,PREL
          1 0001CE  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 0001D1  BCC4 0008                            LDB,B3   8,B4
          1 0001D3  82C3 0018                            LB,'0010'X        24,B3
          1 0001D5       0010
          1 0001D6  0501 0035                            BBT      s:1480,PREL

      202     1460    3           AND (PRM_USR_SETATR.PHSPST.CLM~=1
      203     1461    4           OR NOT %KV_MRD.FRSCLMFLD) THEN DO;

      204     1462                 %BFRERDCHRSTR(SOURCE=DLTFLD_CHR, EXIT_STMT=GOTO ERDDONE);

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:31   
   1465   1 0001D8  82C6 002C                            LB,'00FF'X        44,B6
   1465   1 0001DA       00FF
          1 0001DB  0581 0030                            BBF      s:1480,PREL

   1467   1 0001DD  9846 002C                            LDR,R1   44,B6
          1 0001DF  9570 00FF                            AND,R1   255,IMO
          1 0001E1  1E5A                                 ADV,R1   90
          1 0001E2  D296                                 LLH,R5   ,B6,R1
          1 0001E3  DF47 0029                            STR,R5   TMP,AUTO

   1468   1 0001E5  C847 0028                            LDR,R4   OTPBFRX,AUTO
          1 0001E7  8254                                 NEG      R4
          1 0001E8  4E40                                 ADV,R4   64
          1 0001E9  4801 0004                            BLZ,R4   s:1468+9,PREL
          1 0001EB  C955                                 CMR,R4   R5
          1 0001EC  0281 0004                            BGE      s:1469,PREL

   1468   1 0001EE  E3C0 02C5                            LNJ,B6   s:0,PREL
          1 0001F0       0001                            DC       s:1469,PREL

   1469   1 0001F1  E847 0029                            LDR,R6   TMP,AUTO
          1 0001F3  6D3F                                 CMV,R6   63
          1 0001F4  0301 0017                            BG       s:1480,PREL

   1470   1 0001F6  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 0001F8  D846 002C                            LDR,R5   44,B6
          1 0001FA  D570 00FF                            AND,R5   255,IMO
          1 0001FC  AB86                                 LAB,B2   ,B6
          1 0001FD  A855                                 LDR,R2   R5
          1 0001FE  2E5B                                 ADV,R2   91
          1 0001FF  BB87                                 LAB,B3   ,AUTO
          1 000200  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 000202  3E10                                 ADV,R3   16
          1 000203  0008                                 MMM

   1471   1 000204  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 000206  EA47 0029                            ADD,R6   TMP,AUTO
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:32   
          1 000208  EF47 0028                            STR,R6   OTPBFRX,AUTO

   1472   1 00020A  0F81 00CC                            B        s:1529,PREL

      205     1474    4         END;

      206     1475
      207     1476        /* First check to see if no bits are set in PRM_USR_SETATR, indicating
      208     1477           that the restore sequence must be sent to restore the scrren to its
      209     1478           default state.                                                             */
      210     1479
      211     1480    4         IF PRM_USR_SETATR.GRPRND = '0'B THEN DO;

   1480   1 00020C  ECC7 0004                            LDB,B6   @PRM_USR_SETATR,AUTO
          1 00020E  82C6 0003                            LB,'00FF'X        3,B6
          1 000210       00FF
          1 000211  0501 0031                            BBT      s:1498,PREL

      212     1481                 %BFRERDCHRSTR (SOURCE=RESTORE_DFLTSCRN_CHR, EXIT_STMT=GOTO ERDDONE);

   1484   1 000213  DCC7 0006                            LDB,B5   Y@ERD$,AUTO
          1 000215  E2C5 0029                            LLH,R6   41,B5
          1 000217  6901 002B                            BEZ,R6   s:1498,PREL

   1486   1 000219  B856                                 LDR,R3   R6
          1 00021A  3E5A                                 ADV,R3   90
          1 00021B  D2B5                                 LLH,R5   ,B5,R3
          1 00021C  DF47 0029                            STR,R5   TMP,AUTO

   1487   1 00021E  C847 0028                            LDR,R4   OTPBFRX,AUTO
          1 000220  8254                                 NEG      R4
          1 000221  4E40                                 ADV,R4   64
          1 000222  4801 0004                            BLZ,R4   s:1487+9,PREL
          1 000224  C955                                 CMR,R4   R5
          1 000225  0281 0004                            BGE      s:1488,PREL

   1487   1 000227  E3C0 028C                            LNJ,B6   s:0,PREL
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:33   
          1 000229       0001                            DC       s:1488,PREL

   1488   1 00022A  E847 0029                            LDR,R6   TMP,AUTO
          1 00022C  6D3F                                 CMV,R6   63
          1 00022D  0301 0015                            BG       s:1498,PREL

   1489   1 00022F  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000231  D2C6 0029                            LLH,R5   41,B6
          1 000233  AB86                                 LAB,B2   ,B6
          1 000234  A855                                 LDR,R2   R5
          1 000235  2E5B                                 ADV,R2   91
          1 000236  BB87                                 LAB,B3   ,AUTO
          1 000237  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 000239  3E10                                 ADV,R3   16
          1 00023A  0008                                 MMM

   1490   1 00023B  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 00023D  EA47 0029                            ADD,R6   TMP,AUTO
          1 00023F  EF47 0028                            STR,R6   OTPBFRX,AUTO

   1491   1 000241  0F81 0095                            B        s:1529,PREL

      213     1493    4         END;

      214     1494
      215     1495        /* Otherwise, we want to init the bit mask and set a bit for each attribute
      216     1496           we want to set.                                                            */
      217     1497
      218     1498    3         Y@MASK = '0'B;

   1498   1 000243  8747 002C                            CL       Y@MASK,AUTO

      219     1499              %BFRERDCHRSTR(SOURCE = SGRINTRO_CHR);

   1502   1 000245  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000247  E2C6 0027                            LLH,R6   39,B6
          1 000249  6901 0029                            BEZ,R6   s:1511,PREL
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:34   

   1504   1 00024B  B856                                 LDR,R3   R6
          1 00024C  3E5A                                 ADV,R3   90
          1 00024D  D2B6                                 LLH,R5   ,B6,R3
          1 00024E  DF47 0029                            STR,R5   TMP,AUTO

   1505   1 000250  C847 0028                            LDR,R4   OTPBFRX,AUTO
          1 000252  8254                                 NEG      R4
          1 000253  4E40                                 ADV,R4   64
          1 000254  4801 0004                            BLZ,R4   s:1505+9,PREL
          1 000256  C955                                 CMR,R4   R5
          1 000257  0281 0004                            BGE      s:1506,PREL

   1505   1 000259  E3C0 025A                            LNJ,B6   s:0,PREL
          1 00025B       0001                            DC       s:1506,PREL

   1506   1 00025C  E847 0029                            LDR,R6   TMP,AUTO
          1 00025E  6D3F                                 CMV,R6   63
          1 00025F  0301 0013                            BG       s:1511,PREL

   1507   1 000261  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000263  D2C6 0027                            LLH,R5   39,B6
          1 000265  AB86                                 LAB,B2   ,B6
          1 000266  A855                                 LDR,R2   R5
          1 000267  2E5B                                 ADV,R2   91
          1 000268  BB87                                 LAB,B3   ,AUTO
          1 000269  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 00026B  3E10                                 ADV,R3   16
          1 00026C  0008                                 MMM

   1508   1 00026D  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 00026F  EA47 0029                            ADD,R6   TMP,AUTO
          1 000271  EF47 0028                            STR,R6   OTPBFRX,AUTO

      220     1511    3         IF ASCBIT(KV$ERD.SGRHDN_CHR) AND PRM_USR_SETATR.GRPRND.HDN

   1511   1 000273  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:35   
          1 000275  E846 0018                            LDR,R6   24,B6
          1 000277  6008                                 SOL,R6   8
          1 000278  6901 000C                            BEZ,R6   s:1513,PREL
          1 00027A  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 00027C  82C5 0003                            LB,'0040'X        3,B5
          1 00027E       0040
          1 00027F  0581 0005                            BBF      s:1513,PREL

      221     1512    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRHDN_CHR);

   1512   1 000281  E447 002C                            OR,R6    Y@MASK,AUTO
          1 000283  EF47 002C                            STR,R6   Y@MASK,AUTO

      222     1513    3         IF PRM_USR_SETATR.GRPRND.INCINT

   1513   1 000285  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 000287  82C5 0003                            LB,'0020'X        3,B5
          1 000289       0020
          1 00028A  0581 0008                            BBF      s:1515,PREL

      223     1514    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRINCINT_CHR);

   1514   1 00028C  E2C6 0019                            LLH,R6   25,B6
          1 00028E  6008                                 SOL,R6   8
          1 00028F  E447 002C                            OR,R6    Y@MASK,AUTO
          1 000291  EF47 002C                            STR,R6   Y@MASK,AUTO

      224     1515    3         IF PRM_USR_SETATR.GRPRND.DCRINT

   1515   1 000293  82C5 0003                            LB,'0010'X        3,B5
   1515   1 000295       0010
          1 000296  0581 0008                            BBF      s:1517,PREL

      225     1516    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRDCRINT_CHR);

   1516   1 000298  E846 0019                            LDR,R6   25,B6
          1 00029A  6008                                 SOL,R6   8
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:36   
          1 00029B  E447 002C                            OR,R6    Y@MASK,AUTO
          1 00029D  EF47 002C                            STR,R6   Y@MASK,AUTO

      226     1517    3         IF PRM_USR_SETATR.GRPRND.UNDSCR

   1517   1 00029F  82C5 0003                            LB,'0008'X        3,B5
   1517   1 0002A1       0008
          1 0002A2  0581 0008                            BBF      s:1519,PREL

      227     1518    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRUNDSCR_CHR);

   1518   1 0002A4  E2C6 001A                            LLH,R6   26,B6
          1 0002A6  6008                                 SOL,R6   8
          1 0002A7  E447 002C                            OR,R6    Y@MASK,AUTO
          1 0002A9  EF47 002C                            STR,R6   Y@MASK,AUTO

      228     1519    3         IF PRM_USR_SETATR.GRPRND.SLWBLN

   1519   1 0002AB  82C5 0003                            LB,'0004'X        3,B5
   1519   1 0002AD       0004
          1 0002AE  0581 0008                            BBF      s:1521,PREL

      229     1520    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRSLWBLN_CHR);

   1520   1 0002B0  E846 001A                            LDR,R6   26,B6
          1 0002B2  6008                                 SOL,R6   8
          1 0002B3  E447 002C                            OR,R6    Y@MASK,AUTO
          1 0002B5  EF47 002C                            STR,R6   Y@MASK,AUTO

      230     1521    3         IF PRM_USR_SETATR.GRPRND.FSTBLN

   1521   1 0002B7  82C5 0003                            LB,'0002'X        3,B5
   1521   1 0002B9       0002
          1 0002BA  0581 0008                            BBF      s:1523,PREL

      231     1522    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRFSTBLN_CHR);

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:37   
   1522   1 0002BC  E2C6 001B                            LLH,R6   27,B6
          1 0002BE  6008                                 SOL,R6   8
          1 0002BF  E447 002C                            OR,R6    Y@MASK,AUTO
          1 0002C1  EF47 002C                            STR,R6   Y@MASK,AUTO

      232     1523    3         IF PRM_USR_SETATR.GRPRND.RVRVID

   1523   1 0002C3  82C5 0003                            LB,'0001'X        3,B5
   1523   1 0002C5       0001
          1 0002C6  0581 0008                            BBF      s:1528,PREL

      233     1524    3         THEN Y@MASK = Y@MASK|ASCBIT(KV$ERD.SGRRVRVID_CHR);

   1524   1 0002C8  E846 001B                            LDR,R6   27,B6
          1 0002CA  6008                                 SOL,R6   8
          1 0002CB  E447 002C                            OR,R6    Y@MASK,AUTO
          1 0002CD  EF47 002C                            STR,R6   Y@MASK,AUTO

      234     1525
      235     1526        /* Buffer the bit mask                                                        */
      236     1527
      237     1528    3         OTPBFR_BYT(OTPBFRX) = Y@MASK.CHR;

   1528   1 0002CF  E2C7 002C                            LLH,R6   Y@MASK,AUTO
          1 0002D1  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 0002D3  3E10                                 ADV,R3   16
          1 0002D4  E7B7                                 STH,R6   ,AUTO,R3

      238     1529    3         OTPBFRX = OTPBFRX+1;

   1529   1 0002D5  8AC7 0028                            INC      OTPBFRX,AUTO

   1529   1                              ERDDONE         null
      239     1530    3   ERDDONE:;
      240     1531    4         IF %KV_MRD.ATRRQRDSPPST THEN DO;

   1531   1 0002D7  EC80 0000 0000  xsym ERDDONE         LDB,B6   KV$PTR$
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:38   
          1 0002DA  DCC6 0008                            LDB,B5   8,B6
          1 0002DC  89C5 0018                            CMZ      24,B5
          1 0002DE  0881 0007                            BAGE     s:1543,PREL

      241     1532    4            %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;

   1532   1 0002E0  8AC5 001E                            INC      30,B5

      242     1533    4            %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;

   1533   1 0002E2  DCC6 000A                            LDB,B5   10,B6
          1 0002E4  8AC5 0016                            INC      22,B5

      243     1534    4         END;

      244     1535    3      END;                                 /* CASE                               */

      245     1536
      246     1537        /* If the terminal was in any sort of special forms declaration mode
      247     1538           send the sequence to cause it to exit this mode.                           */
      248     1539
      249     1540           %BFRERDCHRSTR(SOURCE = ENDDCLFRM_CHR);

   1543   1 0002E6  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 0002E8  82C6 0028                            LB,'00FF'X        40,B6
          1 0002EA       00FF
          1 0002EB  0581 002E                            BBF      s:1552,PREL

   1545   1 0002ED  B846 0028                            LDR,R3   40,B6
          1 0002EF  B570 00FF                            AND,R3   255,IMO
          1 0002F1  3E5A                                 ADV,R3   90
          1 0002F2  E2B6                                 LLH,R6   ,B6,R3
          1 0002F3  EF47 0029                            STR,R6   TMP,AUTO

   1546   1 0002F5  D847 0028                            LDR,R5   OTPBFRX,AUTO
          1 0002F7  8255                                 NEG      R5
          1 0002F8  5E40                                 ADV,R5   64
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:39   
          1 0002F9  5801 0004                            BLZ,R5   s:1546+9,PREL
          1 0002FB  D956                                 CMR,R5   R6
          1 0002FC  0281 0004                            BGE      s:1547,PREL

   1546   1 0002FE  E3C0 01B5                            LNJ,B6   s:0,PREL
          1 000300       0001                            DC       s:1547,PREL

   1547   1 000301  E847 0029                            LDR,R6   TMP,AUTO
          1 000303  6D3F                                 CMV,R6   63
          1 000304  0301 0015                            BG       s:1552,PREL

   1548   1 000306  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000308  D846 0028                            LDR,R5   40,B6
          1 00030A  D570 00FF                            AND,R5   255,IMO
          1 00030C  AB86                                 LAB,B2   ,B6
          1 00030D  A855                                 LDR,R2   R5
          1 00030E  2E5B                                 ADV,R2   91
          1 00030F  BB87                                 LAB,B3   ,AUTO
          1 000310  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 000312  3E10                                 ADV,R3   16
          1 000313  0008                                 MMM

   1549   1 000314  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 000316  EA47 0029                            ADD,R6   TMP,AUTO
          1 000318  EF47 0028                            STR,R6   OTPBFRX,AUTO

      250     1552    2      RETURN;

   1552   1 00031A  ECC7 002A                            LDB,B6   TMP+1,AUTO
          1 00031C  C3C6 0001                            LNJ,B4   1,B6

      251     1553    2   END;
      252     1554        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:40   
      253     1555    1   Y$ANSX364: PROC;

   1555   1 00031E  EFC7 002E            Y$ANSX364       STB,B6   Y@MASK+2,AUTO

      254     1556
      255     1557        /* If DLTFLD is required, and there is a DLTFLD string in KV$ERD, use it. */
      256     1558
      257     1559    2      IF PRM_USR_SETATR.DLTFLD

   1559   1 000320  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 000322  8285                                 LB,'0040'X        ,B5
          1 000323       0040
          1 000324  0581 0046                            BBF      s:1575,PREL
          1 000326  E845 0002                            LDR,R6   2,B5
          1 000328  6D01                                 CMV,R6   1
          1 000329  0981 000B                            BNE      s:1565,PREL
          1 00032B  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 00032E  BCC4 0008                            LDB,B3   8,B4
          1 000330  82C3 0018                            LB,'0010'X        24,B3
          1 000332       0010
          1 000333  0501 0037                            BBT      s:1575,PREL

      258     1560    2        AND (PRM_USR_SETATR.PHSPST.CLM~=1
      259     1561    3        OR NOT %KV_MRD.FRSCLMFLD) THEN DO;

      260     1562              %BFRERDCHRSTR(SOURCE=DLTFLD_CHR, EXIT_STMT=GOTO ANSDONE);

   1565   1 000335  CCC7 0006                            LDB,B4   Y@ERD$,AUTO
          1 000337  82C4 002C                            LB,'00FF'X        44,B4
          1 000339       00FF
          1 00033A  0581 0030                            BBF      s:1575,PREL

   1567   1 00033C  B844 002C                            LDR,R3   44,B4
          1 00033E  B570 00FF                            AND,R3   255,IMO
          1 000340  3E5A                                 ADV,R3   90
          1 000341  D2B4                                 LLH,R5   ,B4,R3
          1 000342  DF47 0029                            STR,R5   TMP,AUTO
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:41   

   1568   1 000344  C847 0028                            LDR,R4   OTPBFRX,AUTO
          1 000346  8254                                 NEG      R4
          1 000347  4E40                                 ADV,R4   64
          1 000348  4801 0004                            BLZ,R4   s:1568+9,PREL
          1 00034A  C955                                 CMR,R4   R5
          1 00034B  0281 0004                            BGE      s:1569,PREL

   1568   1 00034D  E3C0 0166                            LNJ,B6   s:0,PREL
          1 00034F       0001                            DC       s:1569,PREL

   1569   1 000350  E847 0029                            LDR,R6   TMP,AUTO
          1 000352  6D3F                                 CMV,R6   63
          1 000353  0301 0017                            BG       s:1575,PREL

   1570   1 000355  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000357  D846 002C                            LDR,R5   44,B6
          1 000359  D570 00FF                            AND,R5   255,IMO
          1 00035B  AB86                                 LAB,B2   ,B6
          1 00035C  A855                                 LDR,R2   R5
          1 00035D  2E5B                                 ADV,R2   91
          1 00035E  BB87                                 LAB,B3   ,AUTO
          1 00035F  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 000361  3E10                                 ADV,R3   16
          1 000362  0008                                 MMM

   1571   1 000363  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 000365  EA47 0029                            ADD,R6   TMP,AUTO
          1 000367  EF47 0028                            STR,R6   OTPBFRX,AUTO

   1572   1 000369  0F81 0097                            B        s:1644,PREL

      261     1574    3      END;

      262     1575    2      IF OTPBFRX>%Y_OTPBFRBYTSIZ-18 THEN CALL Y$OTP;

   1575   1 00036B  E847 0028                            LDR,R6   OTPBFRX,AUTO
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:42   
          1 00036D  6D2E                                 CMV,R6   46
          1 00036E  0381 0004                            BLE      s:1579,PREL

   1575   1 000370  E3C0 0143                            LNJ,B6   s:0,PREL
          1 000372       0001                            DC       s:1579,PREL

      263     1576
      264     1577        /* Buffer the ESC [ sequence followed by 0 and ; since most terms want that.  */
      265     1578
      266     1579    2      SUBSTR(OTPBFR,OTPBFRX,4) = %CONCAT(BITASC(ASCIIESC),'[0;');

   1579   1 000373  AB80 0000 0000  00                   LAB,B2   0
          1 000376  2C00                                 LDV,R2   0
          1 000377  6C04                                 LDV,R6   4
          1 000378  BB87                                 LAB,B3   ,AUTO
          1 000379  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 00037B  3E10                                 ADV,R3   16
          1 00037C  0008                                 MMM

      267     1580    2      OTPBFRX = OTPBFRX+4;

   1580   1 00037D  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 00037F  6E04                                 ADV,R6   4
          1 000380  EF47 0028                            STR,R6   OTPBFRX,AUTO

      268     1581
      269     1582        /* Buffer an ANS sequence for each set bit in PRM_USR_SETATR.  Following     */
      270     1583        /* the last selective param, the proc buffers a 'm'.                          */
      271     1584
      272     1585    3      IF ASCBIT(KV$ERD.SGRHDN_CHR) THEN DO;

   1585   1 000382  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000384  D846 0018                            LDR,R5   24,B6
          1 000386  5008                                 SOL,R5   8
          1 000387  5901 0013                            BEZ,R5   s:1597,PREL

      273     1586        /* Since hidden is non-standard X3.64, only send what the profile specifies */
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:43   
      274     1587              %SETANS (ATR = HDN, ANSCODE = "BITBIN(%ASCII8)");

   1588   1 000389  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 00038B  82C5 0003                            LB,'0040'X        3,B5
          1 00038D       0040
          1 00038E  0581 000C                            BBF      s:1597,PREL

   1590   1 000390  4C38                                 LDV,R4   56
          1 000391  B856                                 LDR,R3   R6
          1 000392  3E10                                 ADV,R3   16
          1 000393  C7B7                                 STH,R4   ,AUTO,R3

   1591   1 000394  5C3B                                 LDV,R5   59
          1 000395  A856                                 LDR,R2   R6
          1 000396  2E11                                 ADV,R2   17
          1 000397  D7A7                                 STH,R5   ,AUTO,R2

   1592   1 000398  6E02                                 ADV,R6   2
          1 000399  EF47 0028                            STR,R6   OTPBFRX,AUTO

      275     1595    3      END;

      276     1596           %SETANS (ATR = INCINT, ANSCODE = "BITBIN(%ASCII1)");

   1597   1 00039B  DCC7 0004                            LDB,B5   @PRM_USR_SETATR,AUTO
          1 00039D  82C5 0003                            LB,'0020'X        3,B5
          1 00039F       0020
          1 0003A0  0581 000C                            BBF      s:1605,PREL

   1599   1 0003A2  5C31                                 LDV,R5   49
          1 0003A3  B856                                 LDR,R3   R6
          1 0003A4  3E10                                 ADV,R3   16
          1 0003A5  D7B7                                 STH,R5   ,AUTO,R3

   1600   1 0003A6  4C3B                                 LDV,R4   59
          1 0003A7  A856                                 LDR,R2   R6
          1 0003A8  2E11                                 ADV,R2   17
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:44   
          1 0003A9  C7A7                                 STH,R4   ,AUTO,R2

   1601   1 0003AA  6E02                                 ADV,R6   2
          1 0003AB  EF47 0028                            STR,R6   OTPBFRX,AUTO

      277     1604           %SETANS (ATR = DCRINT, ANSCODE = "BITBIN(%ASCII2)");

   1605   1 0003AD  82C5 0003                            LB,'0010'X        3,B5
   1605   1 0003AF       0010
          1 0003B0  0581 000C                            BBF      s:1613,PREL

   1607   1 0003B2  5C32                                 LDV,R5   50
          1 0003B3  B856                                 LDR,R3   R6
          1 0003B4  3E10                                 ADV,R3   16
          1 0003B5  D7B7                                 STH,R5   ,AUTO,R3

   1608   1 0003B6  4C3B                                 LDV,R4   59
          1 0003B7  A856                                 LDR,R2   R6
          1 0003B8  2E11                                 ADV,R2   17
          1 0003B9  C7A7                                 STH,R4   ,AUTO,R2

   1609   1 0003BA  6E02                                 ADV,R6   2
          1 0003BB  EF47 0028                            STR,R6   OTPBFRX,AUTO

      278     1612           %SETANS (ATR = UNDSCR, ANSCODE = "BITBIN(%ASCII4)");

   1613   1 0003BD  82C5 0003                            LB,'0008'X        3,B5
   1613   1 0003BF       0008
          1 0003C0  0581 000C                            BBF      s:1621,PREL

   1615   1 0003C2  5C34                                 LDV,R5   52
          1 0003C3  B856                                 LDR,R3   R6
          1 0003C4  3E10                                 ADV,R3   16
          1 0003C5  D7B7                                 STH,R5   ,AUTO,R3

   1616   1 0003C6  4C3B                                 LDV,R4   59
          1 0003C7  A856                                 LDR,R2   R6
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:45   
          1 0003C8  2E11                                 ADV,R2   17
          1 0003C9  C7A7                                 STH,R4   ,AUTO,R2

   1617   1 0003CA  6E02                                 ADV,R6   2
          1 0003CB  EF47 0028                            STR,R6   OTPBFRX,AUTO

      279     1620           %SETANS (ATR = SLWBLN, ANSCODE = "BITBIN(%ASCII5)");

   1621   1 0003CD  82C5 0003                            LB,'0004'X        3,B5
   1621   1 0003CF       0004
          1 0003D0  0581 000C                            BBF      s:1629,PREL

   1623   1 0003D2  5C35                                 LDV,R5   53
          1 0003D3  B856                                 LDR,R3   R6
          1 0003D4  3E10                                 ADV,R3   16
          1 0003D5  D7B7                                 STH,R5   ,AUTO,R3

   1624   1 0003D6  4C3B                                 LDV,R4   59
          1 0003D7  A856                                 LDR,R2   R6
          1 0003D8  2E11                                 ADV,R2   17
          1 0003D9  C7A7                                 STH,R4   ,AUTO,R2

   1625   1 0003DA  6E02                                 ADV,R6   2
          1 0003DB  EF47 0028                            STR,R6   OTPBFRX,AUTO

      280     1628           %SETANS (ATR = FSTBLN, ANSCODE = "BITBIN(%ASCII6)");

   1629   1 0003DD  82C5 0003                            LB,'0002'X        3,B5
   1629   1 0003DF       0002
          1 0003E0  0581 000C                            BBF      s:1637,PREL

   1631   1 0003E2  5C36                                 LDV,R5   54
          1 0003E3  B856                                 LDR,R3   R6
          1 0003E4  3E10                                 ADV,R3   16
          1 0003E5  D7B7                                 STH,R5   ,AUTO,R3

   1632   1 0003E6  4C3B                                 LDV,R4   59
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:46   
          1 0003E7  A856                                 LDR,R2   R6
          1 0003E8  2E11                                 ADV,R2   17
          1 0003E9  C7A7                                 STH,R4   ,AUTO,R2

   1633   1 0003EA  6E02                                 ADV,R6   2
          1 0003EB  EF47 0028                            STR,R6   OTPBFRX,AUTO

      281     1636           %SETANS (ATR = RVRVID, ANSCODE = "BITBIN(%ASCII7)");

   1637   1 0003ED  82C5 0003                            LB,'0001'X        3,B5
   1637   1 0003EF       0001
          1 0003F0  0581 000C                            BBF      s:1644,PREL

   1639   1 0003F2  5C37                                 LDV,R5   55
          1 0003F3  B856                                 LDR,R3   R6
          1 0003F4  3E10                                 ADV,R3   16
          1 0003F5  D7B7                                 STH,R5   ,AUTO,R3

   1640   1 0003F6  4C3B                                 LDV,R4   59
          1 0003F7  A856                                 LDR,R2   R6
          1 0003F8  2E11                                 ADV,R2   17
          1 0003F9  C7A7                                 STH,R4   ,AUTO,R2

   1641   1 0003FA  6E02                                 ADV,R6   2
          1 0003FB  EF47 0028                            STR,R6   OTPBFRX,AUTO

      282     1644    2      OTPBFR_BYT(OTPBFRX-1) = BITBIN(%ASCIILCM);

   1644   1 0003FD  5C6D                                 LDV,R5   109
          1 0003FE  B856                                 LDR,R3   R6
          1 0003FF  3E0F                                 ADV,R3   15
          1 000400  D7B7                                 STH,R5   ,AUTO,R3

   1644   1                              ANSDONE         null
      283     1645    2   ANSDONE:;
      284     1646    3      IF %KV_MRD.ATRRQRDSPPST THEN DO;

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:47   
   1646   1 000401  EC80 0000 0000  xsym ANSDONE         LDB,B6   KV$PTR$
          1 000404  DCC6 0008                            LDB,B5   8,B6
          1 000406  89C5 0018                            CMZ      24,B5
          1 000408  0881 0007                            BAGE     s:1650,PREL

      285     1647    3         %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;

   1647   1 00040A  8AC5 001E                            INC      30,B5

      286     1648    3         %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;

   1648   1 00040C  DCC6 000A                            LDB,B5   10,B6
          1 00040E  8AC5 0016                            INC      22,B5

      287     1649    3      END;

      288     1650    2   END;

   1650   1 000410  ECC7 002E                            LDB,B6   Y@MASK+2,AUTO
          1 000412  C3C6 0001                            LNJ,B4   1,B6

      289     1651        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:48   
      290     1652    1   Y$SGR2: PROC (ATR);

   1652   1 000414  EFC7 002E            Y$SGR2          STB,B6   Y@MASK+2,AUTO

      291     1653
      292     1654    2   DCL Y@ERDBIN(0:0) BASED(Y@ERD$) UBIN BYTE CALIGNED;
      293     1655    2   DCL ATR SBIN;
      294     1656    3      IF Y@ERDBIN (ATR)~=0 THEN DO;

   1656   1 000416  DCC7 0030                            LDB,B5   @ATR,AUTO
          1 000418  B805                                 LDR,R3   ,B5
          1 000419  CCC7 0006                            LDB,B4   Y@ERD$,AUTO
          1 00041B  E2B4                                 LLH,R6   ,B4,R3
          1 00041C  6901 0052                            BEZ,R6   s:1677,PREL

      295     1657    3         IF KV$ERD.DCLFLD_ALG~=3 THEN CALL Y$PSTTO_FLD;

   1657   1 00041E  D2C4 0018                            LLH,R5   24,B4
          1 000420  5D03                                 CMV,R5   3
          1 000421  0901 0004                            BE       s:1661,PREL

   1657   1 000423  E3C0 004F                            LNJ,B6   s:0,PREL
          1 000425       0001                            DC       s:1661,PREL

      296     1658              %BFRERDCHRSTR(SOURCE = SGRINTRO_CHR);

   1661   1 000426  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000428  E2C6 0027                            LLH,R6   39,B6
          1 00042A  6901 0029                            BEZ,R6   s:1670,PREL

   1663   1 00042C  B856                                 LDR,R3   R6
          1 00042D  3E5A                                 ADV,R3   90
          1 00042E  D2B6                                 LLH,R5   ,B6,R3
          1 00042F  DF47 0029                            STR,R5   TMP,AUTO

   1664   1 000431  C847 0028                            LDR,R4   OTPBFRX,AUTO
          1 000433  8254                                 NEG      R4
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:49   
          1 000434  4E40                                 ADV,R4   64
          1 000435  4801 0004                            BLZ,R4   s:1664+9,PREL
          1 000437  C955                                 CMR,R4   R5
          1 000438  0281 0004                            BGE      s:1665,PREL

   1664   1 00043A  E3C0 0079                            LNJ,B6   s:0,PREL
          1 00043C       0001                            DC       s:1665,PREL

   1665   1 00043D  E847 0029                            LDR,R6   TMP,AUTO
          1 00043F  6D3F                                 CMV,R6   63
          1 000440  0301 0013                            BG       s:1670,PREL

   1666   1 000442  ECC7 0006                            LDB,B6   Y@ERD$,AUTO
          1 000444  D2C6 0027                            LLH,R5   39,B6
          1 000446  AB86                                 LAB,B2   ,B6
          1 000447  A855                                 LDR,R2   R5
          1 000448  2E5B                                 ADV,R2   91
          1 000449  BB87                                 LAB,B3   ,AUTO
          1 00044A  B847 0028                            LDR,R3   OTPBFRX,AUTO
          1 00044C  3E10                                 ADV,R3   16
          1 00044D  0008                                 MMM

   1667   1 00044E  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 000450  EA47 0029                            ADD,R6   TMP,AUTO
          1 000452  EF47 0028                            STR,R6   OTPBFRX,AUTO

      297     1670    3         OTPBFR_BYT(OTPBFRX) = Y@ERDBIN (ATR);

   1670   1 000454  ECC7 0030                            LDB,B6   @ATR,AUTO
          1 000456  B806                                 LDR,R3   ,B6
          1 000457  DCC7 0006                            LDB,B5   Y@ERD$,AUTO
          1 000459  E2B5                                 LLH,R6   ,B5,R3
          1 00045A  A847 0028                            LDR,R2   OTPBFRX,AUTO
          1 00045C  2E10                                 ADV,R2   16
          1 00045D  E7A7                                 STH,R6   ,AUTO,R2

      298     1671    3         OTPBFRX = OTPBFRX+1;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:50   

   1671   1 00045E  8AC7 0028                            INC      OTPBFRX,AUTO

      299     1672    4         IF %KV_MRD.ATRRQRDSPPST THEN DO;

   1672   1 000460  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 000463  BCC4 0008                            LDB,B3   8,B4
          1 000465  89C3 0018                            CMZ      24,B3
          1 000467  0881 0007                            BAGE     s:1677,PREL

      300     1673    4            %KV_MRD.DVCCLM = %KV_MRD.DVCCLM+1;

   1673   1 000469  8AC3 001E                            INC      30,B3

      301     1674    4            %KV_SRD.CRT.CLM = %KV_SRD.CRT.CLM+1;

   1674   1 00046B  BCC4 000A                            LDB,B3   10,B4
          1 00046D  8AC3 0016                            INC      22,B3

      302     1675    4         END;

      303     1676    3      END;

      304     1677    2      RETURN;

   1677   1 00046F  ECC7 002E                            LDB,B6   Y@MASK+2,AUTO
          1 000471  C3C6 0001                            LNJ,B4   1,B6

      305     1678    2   END Y$SGR2;
      306     1679        %EJECT;
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:51   
      307     1680    1   Y$PSTTO_FLD: PROC;

   1680   1 000473  EFC7 0032            Y$PSTTO_FLD     STB,B6   @ATR+2,AUTO

      308     1681
      309     1682        /* Position to start of field (the attribute location)                        */
      310     1683
      311     1684    2      IF %KV_SRD.CRT_PST=PRM_USR_SETATR.PHSPST_PST AND %KV_VDI.OTPCNDPND.PST=0

   1684   1 000475  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000478  CCC5 000A                            LDB,B4   10,B5
          1 00047A  BCC7 0004                            LDB,B3   @PRM_USR_SETATR,AUTO
          1 00047C  8CC4 0015                            LDI      21,B4
          1 00047E  84C3 0001                            SID      1,B3
          1 000480  6981 000C                            BNEZ,R6  s:1686,PREL
          1 000482  7981 000A                            BNEZ,R7  s:1686,PREL
          1 000484  AC85                                 LDB,B2   ,B5
          1 000485  E842 001A                            LDR,R6   26,B2
          1 000487  6981 0005                            BNEZ,R6  s:1686,PREL

      312     1685    2      THEN RETURN;

   1685   1 000489  ECC7 0032                            LDB,B6   @ATR+2,AUTO
          1 00048B  C3C6 0001                            LNJ,B4   1,B6

      313     1686    2      IF OTPBFRX>1 THEN CALL Y$OTP;

   1686   1 00048D  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 00048F  6D01                                 CMV,R6   1
          1 000490  0381 0004                            BLE      s:1687,PREL

   1686   1 000492  E3C0 0021                            LNJ,B6   s:0,PREL
          1 000494       0001                            DC       s:1687,PREL

      314     1687    2      %KV_SRD.CRT = PRM_USR_SETATR.PHSPST;

   1687   1 000495  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:52   
          1 000498  DCC6 000A                            LDB,B5   10,B6
          1 00049A  CCC7 0004                            LDB,B4   @PRM_USR_SETATR,AUTO
          1 00049C  8CC4 0001                            LDI      1,B4
          1 00049E  8D45 0015                            SDI      21,B5

      315     1688    2      %KV_SRD.HI_NONBLN = PRM_USR_SETATR.PHSPST;

   1688   1 0004A0  DCC6 000A                            LDB,B5   10,B6
          1 0004A2  8CC4 0001                            LDI      1,B4
          1 0004A4  8D45 0017                            SDI      23,B5

      316     1689    2      %KV_VDI.OTPCNDPND.PST = %KV_PHSPSTMOD_SKP;

   1689   1 0004A6  DC86                                 LDB,B5   ,B6
          1 0004A7  6C01                                 LDV,R6   1
          1 0004A8  EF45 001A                            STR,R6   26,B5

      317     1690    2      CALL KVV$CALUSR_PST;

   1690   1 0004AA  CBF0 0000                            LAB,B4   0,IMO
          1 0004AC  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR_PST
          1 0004AF       0001                            DC       s:1692,PREL

      318     1691
      319     1692    2      RETURN;

   1692   1 0004B0  ECC7 0032                            LDB,B6   @ATR+2,AUTO
          1 0004B2  C3C6 0001                            LNJ,B4   1,B6

      320     1693    2   END;
      321     1694    1   Y$OTP: PROC;

   1694   1 0004B4  EFC7 0034            Y$OTP           STB,B6   @ATR+4,AUTO

      322     1695
      323     1696        /* If anything was stuffed into the output buffer, write it out               */
      324     1697
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:53   
      325     1698    3      IF OTPBFRX>1 THEN DO;

   1698   1 0004B6  E847 0028                            LDR,R6   OTPBFRX,AUTO
          1 0004B8  6D01                                 CMV,R6   1
          1 0004B9  0381 0013                            BLE      s:1703,PREL

      326     1699    3         OTPBFR_BYT(0) = OTPBFRX-1;

   1699   1 0004BB  6EFF                                 ADV,R6   -1
          1 0004BC  E7C7 0008                            STH,R6   OTPBFR,AUTO

      327     1700    3         OTPBFRX = 1;

   1700   1 0004BE  5C01                                 LDV,R5   1
          1 0004BF  DF47 0028                            STR,R5   OTPBFRX,AUTO

      328     1701    3         CALL KVO$DVCCTR (OTPBFR);

   1701   1 0004C1  DBC7 0008                            LAB,B5   OTPBFR,AUTO
          1 0004C3  DFC7 0036                            STB,B5   @ATR+6,AUTO
          1 0004C5  BBC7 0036                            LAB,B3   @ATR+6,AUTO
          1 0004C7  CBF0 0100                            LAB,B4   256,IMO
          1 0004C9  E380 0000 0000  xent                 LNJ,B6   KVO$DVCCTR
          1 0004CC       0001                            DC       s:1703,PREL

      329     1702    3      END;

      330     1703    2   END;

   1703   1 0004CD  ECC7 0034                            LDB,B6   @ATR+4,AUTO
          1 0004CF  C3C6 0001                            LNJ,B4   1,B6
      331     1704    1   END;

PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:54   
--  Include file information  --

   KV_INT_M.:E05TOU  is referenced.
   KV_ERD_E.:E05TOU  is referenced.
   KV_ASCCHR_E.:E05TOU  is referenced.
   K_CP6_M.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is never referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$SETATR.
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:55   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    30-0-0/w PTR         r     1 @ATR                       4-0-0/w PTR         r     1 @PRM_USR_SETATR
    *0-0-0/w SBIN(16)    r     1 ATR                        8-0-0/c CHAR(64)    r     1 OTPBFR
    28-0-0/w UBIN(16)    r     1 OTPBFRX
     8-0-0/c UBIN(8)     r     1 OTPBFR_BYT(0:63)
    *0-0-0/w STRC(64)    r     1 PRM_USR_SETATR            29-0-0/w UBIN(16)    r     1 TMP
     6-0-0/w PTR         r     1 Y@ERD$                    2C-0-0/b STRC(16)    r     1 Y@MASK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV$PTR$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(728)   r     1 KV$ERD                     0-0-0/w STRC(512)   r     1 KV$MRD
     0-0-0/w STRC(480)   r     1 KV$PTR                     0-0-0/w STRC(496)   r     1 KV$SRD
     0-0-0/w STRC(512)   r     1 KV$VDI
     0-0-0/c UBIN(8)     r     1 Y@ERDBIN(0:0)


   Procedure KVO$SETATR requires 1233 words for executable code.
   Procedure KVO$SETATR requires 56 words of local(AUTO) storage.
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:56   

    No errors detected in file KVO$SETATR.:E05TSI    .
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:57   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:58   
          MINI XREF LISTING

ANSDONE IN PROCEDURE Y$ANSX364
      1644**LABEL    1572--GOTO
ATR IN PROCEDURE Y$SGR2
      1655**DCL      1652--PROC     1656>>IF       1670>>ASSIGN
ERDDONE IN PROCEDURE Y$DAQSGR
      1529**LABEL    1410--GOTO     1472--GOTO     1491--GOTO
KV$ERD.CNT
       830**DCL      1363>>ASSIGN   1405>>ASSIGN   1422>>ASSIGN   1467>>ASSIGN   1486>>ASSIGN   1504>>ASSIGN
      1545>>ASSIGN   1567>>ASSIGN   1663>>ASSIGN
KV$ERD.DCLFLD_ALG
       814**DCL      1313>>IF       1318>>IF       1325>>DOCASE   1374>>IF       1657>>IF
KV$ERD.DCLFRM_CHR
       825**DCL      1361>>IF       1363>>ASSIGN   1366>>ASSIGN
KV$ERD.DFLMODPRT
       812**DCL      1446>>IF       1447>>IF       1448>>IF
KV$ERD.DLTFLD_CHR
       829**DCL      1403>>IF       1405>>ASSIGN   1408>>ASSIGN   1465>>IF       1467>>ASSIGN   1470>>ASSIGN
      1565>>IF       1567>>ASSIGN   1570>>ASSIGN
KV$ERD.ENDDCLFRM_CHR
       826**DCL      1543>>IF       1545>>ASSIGN   1548>>ASSIGN
KV$ERD.EXTSRD_CHR
       829**DCL       829--REDEF     830--REDEF
KV$ERD.RESTORE_DFLTSCRN_CHR
       826**DCL      1420>>IF       1422>>ASSIGN   1425>>ASSIGN   1484>>IF       1486>>ASSIGN   1489>>ASSIGN
KV$ERD.SGRDCRINT_CHR
       815**DCL      1516>>ASSIGN
KV$ERD.SGRFSTBLN_CHR
       817**DCL      1522>>ASSIGN
KV$ERD.SGRHDN_CHR
       815**DCL      1511>>IF       1512>>ASSIGN   1585>>IF
KV$ERD.SGRINCDAQ
       811**DCL      1444>>IF
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:59   
KV$ERD.SGRINCINT_CHR
       815**DCL      1514>>ASSIGN
KV$ERD.SGRINTRO_CHR
       825**DCL      1502>>IF       1504>>ASSIGN   1507>>ASSIGN   1661>>IF       1663>>ASSIGN   1666>>ASSIGN
KV$ERD.SGRRVRVID_CHR
       817**DCL      1524>>ASSIGN
KV$ERD.SGRSLWBLN_CHR
       816**DCL      1520>>ASSIGN
KV$ERD.SGRUNDSCR_CHR
       816**DCL      1518>>ASSIGN
KV$ERD.SGR_ALG
       814**DCL      1354>>IF       1378>>DOCASE
KV$ERD.TXT
       829**DCL      1366>>ASSIGN   1408>>ASSIGN   1425>>ASSIGN   1470>>ASSIGN   1489>>ASSIGN   1507>>ASSIGN
      1548>>ASSIGN   1570>>ASSIGN   1666>>ASSIGN
KV$MRD.ATRRQRDSPPST
       869**DCL      1432>>IF       1531>>IF       1646>>IF       1672>>IF
KV$MRD.DVCCLM
       879**DCL      1433<<ASSIGN   1433>>ASSIGN   1532<<ASSIGN   1532>>ASSIGN   1647<<ASSIGN   1647>>ASSIGN
      1673<<ASSIGN   1673>>ASSIGN
KV$MRD.ERD$
       857**DCL      1309>>ASSIGN
KV$MRD.FRSCLMFLD
       872**DCL      1397>>IF       1459>>IF       1559>>IF
KV$PTR.INPCNDPND
       909**DCL       918--REDEF     922--REDEF
KV$PTR.LINLST$
       905**DCL       906--REDEF
KV$PTR.MRD$
       904**DCL      1309>>ASSIGN   1397>>IF       1432>>IF       1433>>ASSIGN   1433>>ASSIGN   1459>>IF
      1531>>IF       1532>>ASSIGN   1532>>ASSIGN   1559>>IF       1646>>IF       1647>>ASSIGN   1647>>ASSIGN
      1672>>IF       1673>>ASSIGN   1673>>ASSIGN
KV$PTR.SRD$
       905**DCL      1434>>ASSIGN   1434>>ASSIGN   1533>>ASSIGN   1533>>ASSIGN   1648>>ASSIGN   1648>>ASSIGN
      1674>>ASSIGN   1674>>ASSIGN   1684>>IF       1687>>ASSIGN   1688>>ASSIGN
KV$PTR.VDI$
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:60   
       903**DCL      1318>>IF       1318>>IF       1684>>IF       1689>>ASSIGN
KV$PTR$
       897**DCL       903--IMP-PTR  1309>>ASSIGN   1318>>IF       1318>>IF       1397>>IF       1432>>IF
      1433>>ASSIGN   1433>>ASSIGN   1434>>ASSIGN   1434>>ASSIGN   1459>>IF       1531>>IF       1532>>ASSIGN
      1532>>ASSIGN   1533>>ASSIGN   1533>>ASSIGN   1559>>IF       1646>>IF       1647>>ASSIGN   1647>>ASSIGN
      1648>>ASSIGN   1648>>ASSIGN   1672>>IF       1673>>ASSIGN   1673>>ASSIGN   1674>>ASSIGN   1674>>ASSIGN
      1684>>IF       1684>>IF       1687>>ASSIGN   1688>>ASSIGN   1689>>ASSIGN
KV$SRD.BTMRHT
      1042**DCL      1047--REDEF
KV$SRD.CRT
      1118**DCL      1123--REDEF    1687<<ASSIGN
KV$SRD.CRT.CLM
      1120**DCL      1434<<ASSIGN   1434>>ASSIGN   1533<<ASSIGN   1533>>ASSIGN   1648<<ASSIGN   1648>>ASSIGN
      1674<<ASSIGN   1674>>ASSIGN
KV$SRD.CRT_PST
      1123**DCL      1684>>IF
KV$SRD.FLDEND
      1082**DCL      1087--REDEF
KV$SRD.HI_NONBLN
      1152**DCL      1157--REDEF    1688<<ASSIGN
KV$SRD.ORG
       974**DCL       979--REDEF
KV$SRD.SRDEND
      1187**DCL      1192--REDEF
KV$SRD.TOPLFT
      1008**DCL      1013--REDEF
KV$VDI.OTPCNDPND.PST
      1258**DCL      1318>>IF       1318>>IF       1684>>IF       1689<<ASSIGN
KVO$DVCCTR
      1275**DCL-ENT  1701--CALL
KVV$CALUSR_PST
      1274**DCL-ENT  1320--CALL     1690--CALL
OTPBFR
       743**DCL       744--REDEF    1366<<ASSIGN   1408<<ASSIGN   1425<<ASSIGN   1470<<ASSIGN   1489<<ASSIGN
      1507<<ASSIGN   1548<<ASSIGN   1570<<ASSIGN   1579<<ASSIGN   1666<<ASSIGN   1701<>CALL
OTPBFRX
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:61   
       745**DCL      1314<<ASSIGN   1364>>IF       1366>>ASSIGN   1367<<ASSIGN   1367>>ASSIGN   1406>>IF
      1408>>ASSIGN   1409<<ASSIGN   1409>>ASSIGN   1423>>IF       1425>>ASSIGN   1426<<ASSIGN   1426>>ASSIGN
      1468>>IF       1470>>ASSIGN   1471<<ASSIGN   1471>>ASSIGN   1487>>IF       1489>>ASSIGN   1490<<ASSIGN
      1490>>ASSIGN   1505>>IF       1507>>ASSIGN   1508<<ASSIGN   1508>>ASSIGN   1528>>ASSIGN   1529<<ASSIGN
      1529>>ASSIGN   1546>>IF       1548>>ASSIGN   1549<<ASSIGN   1549>>ASSIGN   1568>>IF       1570>>ASSIGN
      1571<<ASSIGN   1571>>ASSIGN   1575>>IF       1579>>ASSIGN   1580<<ASSIGN   1580>>ASSIGN   1590>>ASSIGN
      1591>>ASSIGN   1592<<ASSIGN   1592>>ASSIGN   1599>>ASSIGN   1600>>ASSIGN   1601<<ASSIGN   1601>>ASSIGN
      1607>>ASSIGN   1608>>ASSIGN   1609<<ASSIGN   1609>>ASSIGN   1615>>ASSIGN   1616>>ASSIGN   1617<<ASSIGN
      1617>>ASSIGN   1623>>ASSIGN   1624>>ASSIGN   1625<<ASSIGN   1625>>ASSIGN   1631>>ASSIGN   1632>>ASSIGN
      1633<<ASSIGN   1633>>ASSIGN   1639>>ASSIGN   1640>>ASSIGN   1641<<ASSIGN   1641>>ASSIGN   1644>>ASSIGN
      1664>>IF       1666>>ASSIGN   1667<<ASSIGN   1667>>ASSIGN   1670>>ASSIGN   1671<<ASSIGN   1671>>ASSIGN
      1686>>IF       1698>>IF       1699>>ASSIGN   1700<<ASSIGN
OTPBFR_BYT
       744**DCL      1528<<ASSIGN   1590<<ASSIGN   1591<<ASSIGN   1599<<ASSIGN   1600<<ASSIGN   1607<<ASSIGN
      1608<<ASSIGN   1615<<ASSIGN   1616<<ASSIGN   1623<<ASSIGN   1624<<ASSIGN   1631<<ASSIGN   1632<<ASSIGN
      1639<<ASSIGN   1640<<ASSIGN   1644<<ASSIGN   1670<<ASSIGN   1699<<ASSIGN
PRM_USR_SETATR
       642**DCL         8--PROC
PRM_USR_SETATR.DLTFLD
       648**DCL      1397>>IF       1459>>IF       1559>>IF
PRM_USR_SETATR.GRPRND
       731**DCL      1480>>IF
PRM_USR_SETATR.GRPRND.DCRINT
       733**DCL      1439>>IF       1515>>IF       1605>>IF
PRM_USR_SETATR.GRPRND.FSTBLN
       734**DCL      1442>>IF       1521>>IF       1629>>IF
PRM_USR_SETATR.GRPRND.HDN
       733**DCL      1437>>IF       1511>>IF       1588>>IF
PRM_USR_SETATR.GRPRND.INCINT
       733**DCL      1438>>IF       1513>>IF       1597>>IF
PRM_USR_SETATR.GRPRND.RVRVID
       735**DCL      1443>>IF       1523>>IF       1637>>IF
PRM_USR_SETATR.GRPRND.SLWBLN
       734**DCL      1441>>IF       1519>>IF       1621>>IF
PRM_USR_SETATR.GRPRND.UNDSCR
       734**DCL      1440>>IF       1517>>IF       1613>>IF
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:62   
PRM_USR_SETATR.PHSPST
       675**DCL       680--REDEF    1687>>ASSIGN   1688>>ASSIGN
PRM_USR_SETATR.PHSPST.CLM
       677**DCL      1397>>IF       1459>>IF       1559>>IF
PRM_USR_SETATR.PHSPST_PST
       680**DCL      1684>>IF
PRM_USR_SETATR.QLF
       704**DCL      1445>>IF
TMP
       746**DCL      1363<<ASSIGN   1364>>IF       1365>>IF       1366>>ASSIGN   1366>>ASSIGN   1367>>ASSIGN
      1405<<ASSIGN   1406>>IF       1407>>IF       1408>>ASSIGN   1408>>ASSIGN   1409>>ASSIGN   1422<<ASSIGN
      1423>>IF       1424>>IF       1425>>ASSIGN   1425>>ASSIGN   1426>>ASSIGN   1467<<ASSIGN   1468>>IF
      1469>>IF       1470>>ASSIGN   1470>>ASSIGN   1471>>ASSIGN   1486<<ASSIGN   1487>>IF       1488>>IF
      1489>>ASSIGN   1489>>ASSIGN   1490>>ASSIGN   1504<<ASSIGN   1505>>IF       1506>>IF       1507>>ASSIGN
      1507>>ASSIGN   1508>>ASSIGN   1545<<ASSIGN   1546>>IF       1547>>IF       1548>>ASSIGN   1548>>ASSIGN
      1549>>ASSIGN   1567<<ASSIGN   1568>>IF       1569>>IF       1570>>ASSIGN   1570>>ASSIGN   1571>>ASSIGN
      1663<<ASSIGN   1664>>IF       1665>>IF       1666>>ASSIGN   1666>>ASSIGN   1667>>ASSIGN
Y$ANSX364
      1555**PROC     1330--CALL     1384--CALL
Y$DAQSGR
      1346**PROC     1334--CALL     1338--CALL
Y$OTP
      1694**PROC     1343--CALL     1364--CALL     1406--CALL     1423--CALL     1468--CALL     1487--CALL
      1505--CALL     1546--CALL     1568--CALL     1575--CALL     1664--CALL     1686--CALL
Y$PSTTO_FLD
      1680**PROC     1329--CALL     1374--CALL     1657--CALL
Y$SGR2
      1652**PROC     1437--CALL     1438--CALL     1439--CALL     1440--CALL     1441--CALL     1442--CALL
      1443--CALL     1448--CALL     1449--CALL
Y@ERD$
       742**DCL       786--IMP-PTR  1309<<ASSIGN   1313>>IF       1318>>IF       1325>>DOCASE   1354>>IF
      1361>>IF       1363>>ASSIGN   1363>>ASSIGN   1366>>ASSIGN   1366>>ASSIGN   1374>>IF       1378>>DOCASE
      1403>>IF       1405>>ASSIGN   1405>>ASSIGN   1408>>ASSIGN   1408>>ASSIGN   1420>>IF       1422>>ASSIGN
      1422>>ASSIGN   1425>>ASSIGN   1425>>ASSIGN   1444>>IF       1446>>IF       1447>>IF       1448>>IF
      1465>>IF       1467>>ASSIGN   1467>>ASSIGN   1470>>ASSIGN   1470>>ASSIGN   1484>>IF       1486>>ASSIGN
      1486>>ASSIGN   1489>>ASSIGN   1489>>ASSIGN   1502>>IF       1504>>ASSIGN   1504>>ASSIGN   1507>>ASSIGN
PL6.E3A0      #001=KVO$SETATR File=KVO$SETATR.:E05TSI                            WED 07/30/97 02:11 Page:63   
      1507>>ASSIGN   1511>>IF       1512>>ASSIGN   1514>>ASSIGN   1516>>ASSIGN   1518>>ASSIGN   1520>>ASSIGN
      1522>>ASSIGN   1524>>ASSIGN   1543>>IF       1545>>ASSIGN   1545>>ASSIGN   1548>>ASSIGN   1548>>ASSIGN
      1565>>IF       1567>>ASSIGN   1567>>ASSIGN   1570>>ASSIGN   1570>>ASSIGN   1585>>IF       1654--IMP-PTR
      1656>>IF       1657>>IF       1661>>IF       1663>>ASSIGN   1663>>ASSIGN   1666>>ASSIGN   1666>>ASSIGN
      1670>>ASSIGN
Y@ERDBIN IN PROCEDURE Y$SGR2
      1654**DCL      1656>>IF       1670>>ASSIGN
Y@MASK IN PROCEDURE Y$DAQSGR
      1348**DCL      1498<<ASSIGN   1512<<ASSIGN   1512>>ASSIGN   1514<<ASSIGN   1514>>ASSIGN   1516<<ASSIGN
      1516>>ASSIGN   1518<<ASSIGN   1518>>ASSIGN   1520<<ASSIGN   1520>>ASSIGN   1522<<ASSIGN   1522>>ASSIGN
      1524<<ASSIGN   1524>>ASSIGN
Y@MASK.CHR IN PROCEDURE Y$DAQSGR
      1349**DCL      1528>>ASSIGN
