VERSION A01

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:1    
        1        1        /*M* XSP$ASN1 - send and receive ASN.1 protocol messages. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        9        9        XSP$ASN1: PROC (PARM) ALTRET;
       10       10
       11       11        %INCLUDE XSP_ASN1_M;
       12      357        %XSP$ASN1_PARM (NAME=PARM, STCLASS=PARAM);
       13      383        %XSP_ASN1_N (NAME=NODE, STCLASS="BASED(PTRS.NODE$)");
       14      471        %XSP_ASN1_N (NAME=VNODE, STCLASS="BASED(PTRS.VNODE$)");
       15      559        %XSP_ASN1_E;
       16      626
       17      627        %XSP_ASN1_FPT (FPTN=FPT, STCLASS="BASED(PTRS.FPT$)");
       18      647
       19      648        %XSP$ASN1_PARM (PTRONLY=YES, PNAME=PTRS, STCLASS=);
       20      674    1   DCL VALTXT CHAR(SIZE) BASED(PTRS.VAL$);
       21      675    1   DCL TXT CHAR(4000) BASED(PTRS.BUF$);
       22      676        %EQU CHRS = CHARTEXT('SUBSTR(TXT');
       23      677
       24      678    1   DCL 1 C1 BASED ALIGNED,
       25      679    1          2 * CHAR(3),
       26      680    1          2 C CHAR(1);
       27      681    1   DCL 1 C2 BASED ALIGNED,
       28      682    1          2 * CHAR(2),
       29      683    1          2 C CHAR(2);
       30      684    1   DCL 1 C3 BASED ALIGNED,
       31      685    1          2 * CHAR(1),
       32      686    1          2 C CHAR(3);
       33      687    1   DCL VALC CHAR(8);
       34      688    1   DCL 1 VAL REDEF VALC,
       35      689    1          2 B BIT(36),
       36      690    1          2 U0 REDEF B UBIN,
       37      691    1          2 N0 REDEF B SBIN,
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:2    
       38      692    1          2 TAG REDEF B,
       39      693    1             3 HI_BITS BIT(3),
       40      694    1             3 CONSTRUCTED BIT(1),
       41      695    1             3 TAG UBIN(5) UNAL, 3 * BIT(27),
       42      696    1          2 B2 BIT(36),
       43      697    1          2 N REDEF B2 SBIN,
       44      698    1          2 NU REDEF B2 UBIN,
       45      699    1          2 LO18 REDEF B2, 3 * BIT(18), 3 N UBIN(18) UNAL,
       46      700    1          2 LO27 REDEF B2, 3 * BIT(9), 3 N UBIN(27) UNAL;
       47      701    1   DCL 1 VALU(0:7) REDEF VALC UBIN(9) UNAL;
       48      702    1   DCL 1 VALP(0:8) REDEF VALC UBIN(8) UNAL;
       49      703    1   DCL 1 VAL7 REDEF VALC, 2 * BIT(2), 2 N(0:9) BIT(7) UNAL;
       50      704    1   DCL 1 VALSHF REDEF VALC, 2 * BIT(9), 2 B BIT(63);
       51      705
       52      706    1   DCL I SBIN;
       53      707    1   DCL IU REDEF I UBIN;
       54      708    1   DCL TAG UBIN;
       55      709    1   DCL 1 TAG7 REDEF TAG, 2 * BIT(1), 2 N(0:4) UBIN(7) UNAL;
       56      710    1   DCL SIZE SBIN;
       57      711    1   DCL SIZEU REDEF SIZE UBIN;
       58      712    1   DCL TAGX SBIN;
       59      713    1   DCL LNGX SBIN;
       60      714    1   DCL T1 SBIN;
       61      715    1   DCL ERR SBIN;
       62      716    1   DCL VALX SBIN;
       63      717    1   DCL 1 VALB(0:35) REDEF VALX BIT(1) UNAL;
       64      718    1   DCL VALLIM SBIN;
       65      719
       66      720    1   DCL YEARS(0:42) CONSTANT UBIN INIT      /*      YEARS 1978 - 2020             */
       67      721    1   (0,365,730,1096,1461,1826,2191,2557,2922,3287,3652,4018,4383, /* 1978-1990    */
       68      722    1   4748,5113,5479,5844,6209,7574,6940,7305,7670, /* 1991-1999                    */
       69      723    1   8035,8401,8766,9131,9496,9862,10227,10592,10957,11323,11688, /* 2000-2010     */
       70      724    1   12053,12418,12784,13149,13514,13879,14245,14610,14975,15340); /* 2011-2020    */
       71      725    1   DCL MONTHS(0:12) CONSTANT UBIN INIT
       72      726    1    (0,31,60,91,121,152,182,213,244,274,305,335);
       73      727    1   DCL SIGNS(0:5) BIT(36) CONSTANT INIT
       74      728    1    ('0'X,'00000008'X,'000008'X,'0008'X,'08'X,'0'X);
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:3    
       75      729    1   DCL NSIGNS(0:4) BIT(36) CONSTANT INIT
       76      730    1    ('0'X,'FFFFFFF0'X,'FFFFF0'X,'FFF0'X,'F0'X);
       77      731
       78      732    1   DCL XSP_UTC_OFFSET CHAR(5) STATIC SYMDEF INIT('-0800');
       79      733    1   DCL XSP_UTC_OFFSETN SBIN STATIC SYMDEF INIT(%(-8*24*60*6000));
       80      734        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:4    
       81      735    1   XSP$RECV1: ENTRY (PARM) ALTRET;
       82      736
       83      737    1      ERR = 0;
       84      738    1      PTRS = PARM.P;
       85      739    1      IF PTRS.VNODE$=ADDR(NIL) THEN PTRS.VNODE$ = PTRS.NODE$;
       86      740    1      SIZE = PARM.MAXX;
       87      741    1      IF PARM.PARSED THEN CALL GET_TAG ALTRET(RETALT);
       88      742    2      IF NODE.PRE.RCV THEN DO;
       89      743    2         PARM.USR = %XSP_ASN1_RCV_PRE;
       90      744    2         CALL FPT.UENTRY$ (PARM) ALTRET (RETALT);
       91      745    2      END;
       92      746    1      TAG = PARM.TAG;
       93      747    1      SIZE = PARM.SIZE;
       94      748    1      IF TAG=0 OR TAG~=NODE.TAG AND NOT NODE.IMPLICIT
       95      749    2      THEN IF TAG=0 OR NODE.TYPE~=%XSP_ASN1_CHOICE THEN DO;
       96      750    2         IF NODE.DEFAULT_EXISTS THEN GOTO RETALT;
       97      751    2         IF NOT NODE.OPTIONL OR FPT.CONDITION(NODE.CONDITION)
       98      752    2         THEN GOTO ERR_WRONG_TAG;
       99      753    2         GOTO RETALT;
      100      754    2      END;
      101      755        /* We have a CHOICE node - find the choice that matches. */
      102      756
      103      757    2      ELSE DO;
      104      758    2         LNGX = PARM.NXTX;
      105      759    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);
      106      760    2         IF NODE.ORDERED THEN I = TAG-NODE.SUBND$(0)->NODE.TAG;
      107      761    3         ELSE DO I=0 TO NODE.NSUBNDS-1;
      108      762    3            IF TAG=NODE.SUBND$(I)->NODE.TAG THEN EXIT;
      109      763    4            IF NODE.SUBND$(I)->NODE.TYPE=%XSP_ASN1_CHOICE THEN DO;
      110      764    4               PARM.P.NODE$ = NODE.SUBND$(I);
      111      765    5               CALL XSP$RECV1 (PARM) WHENRETURN DO;
      112      766    5                  IF PARM.PARSED OR PARM.NXTX>LNGX THEN RETURN;
      113      767    5               END; WHENALTRETURN DO;
      114      768    5                  IF PARM.ERR~=%XSP_ASN1_E$WRONG_TAG OR PARM.NXTX>LNGX
      115      769    5                  THEN GOTO RETALT;
      116      770    5                  PARM.ERR = 0;            /* Otherwise, keep looking            */
      117      771    5               END;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:5    
      118      772    4            END;
      119      773    3         END;
      120      774    2         IF I>=NODE.NSUBNDS THEN GOTO ERR_WRONG_TAG;
      121      775    2         PARM.P.NODE$ = NODE.SUBND$(I);
      122      776    2         CALL XSP$RECV1(PARM) ALTRET(RETALT);
      123      777    2         RETURN;
      124      778    2      END;
      125      779        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:6    
      126      780        /* The TAG matches this node - process accordingly */
      127      781
      128      782    1      IF VNODE.FPTID>0 THEN FPT.RESULT(VNODE.FPTID) = '1'B;
      129      783    1      IF NODE.CONSTRUCTED AND NOT PARM.TAGC THEN GOTO ERR_NOT_STR;
      130      784    1      I = SIZE-PARM.NXTX;
      131      785    2      DO CASE (NODE.TYPE);
      132      786    2      CASE (%XSP_ASN1_SEQUENCE);
      133      787    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);
      134      788    2         IF NOT NODE.IMPLICIT THEN PARM.PARSED = '1'B;
      135      789    3         DO I=0 TO NODE.NSUBNDS-1;
      136      790    3            IF PARM.PARSED THEN CALL GET_TAG ALTRET(RETALT);
      137      791    3            PARM.P.NODE$ = NODE.SUBND$(I);
      138      792    3            IF NODE.IMPLICIT THEN PARM.TAG = PARM.P.NODE$->NODE.TAG-NODE.TAG+TAG-I;
      139      793    3            CALL XSP$RECV1 (PARM) ALTRET(RETALT);
      140      794    3         END;
      141      795    2         GOTO END_CONSTR;
      142      796        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:7    
      143      797    2      CASE (%XSP_ASN1_SET);
      144      798    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);
      145      799    2         VALB = '0'B;
      146      800    2         VALLIM = 0;                       /* (VALB(36:71), just in case )       */
      147      801    3         DO WHILE '1'B;
      148      802    3            CALL GET_TAG ALTRET(RETALT);
      149      803    3            IF TAG=0 THEN EXIT;
      150      804    3            I = -1;
      151      805    4            DO WHILE '1'B;
      152      806    4               I = I+1;
      153      807    4               IF I=NODE.NSUBNDS THEN GOTO ERR_WRONG_TAG;
      154      808    4               IF NODE.SUBND$(I)->NODE.TAG=TAG AND NOT VALB(IU) THEN EXIT;
      155      809    4            END;
      156      810    3            PARM.P.NODE$ = NODE.SUBND$(I);
      157      811    3            VALB(IU) = '1'B;
      158      812    3            CALL XSP$RECV1 (PARM) ALTRET(RETALT);
      159      813    3         END;
      160      814    3         DO I=0 TO NODE.NSUBNDS-1;
      161      815    4            IF NOT VALB(IU) THEN DO;
      162      816    4               PARM.P.NODE$ = NODE.SUBND$(I);
      163      817    4               CALL XSP$RECV1 (PARM) ALTRET(RETALT);
      164      818    4            END;
      165      819    3         END;
      166      820    2         GOTO END_CONSTR;
      167      821        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:8    
      168      822    2      CASE (%XSP_ASN1_SET_OF, %XSP_ASN1_SEQUENCE_OF);
      169      823    2         VALX = 0;
      170      824    3         DO WHILE '1'B;
      171      825    3            PARM.P.NODE$ = NODE.SUBND$(0);
      172      826    3            CALL GET_TAG ALTRET(RETALT);
      173      827    3            IF TAG=0 THEN EXIT;
      174      828    3            CALL XSP$RECV1 (PARM) ALTRET(RETALT);
      175      829    3            VALX = VALX+1;
      176      830    3         END;
      177      831    3         IF NODE.CP6TYP~=0 THEN DO;
      178      832    3            VAL.N = VALX;
      179      833    3            VALX = SIZE;              /* Preserve SIZE for check at END_CONSTR   */
      180      834    3            CALL PUTVALN;
      181      835    3            SIZE = VALX;
      182      836    3         END;
      183      837    2         GOTO END_CONSTR;
      184      838        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:9    
      185      839    2      CASE (%XSP_ASN1_CHOICE);
      186      840        /* If we get here, it must be just a tag node (1 subnode) */
      187      841    2         CALL GET_TAG ALTRET(RETALT);
      188      842    2         PARM.P.NODE$ = NODE.SUBND$(0);
      189      843    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);
      190      844    2         CALL XSP$RECV1 (PARM) ALTRET(RETALT);
      191      845    2   END_CONSTR:;
      192      846    2         IF PARM.P.VNODE$~=ADDR(NIL)
      193      847    2         THEN IF PTRS.VNODE$~=PTRS.NODE$ THEN PARM.P.VNODE$ = PTRS.VNODE$;
      194      848    2         ELSE PARM.P.VNODE$ = ADDR(NIL);
      195      849    3         IF SIZE~=PARM.NXTX THEN DO;
      196      850    3            IF SIZE~=65535 THEN GOTO ERR_STR_SIZE; /* Not indefinite length      */
      197      851    3            IF PARM.TAG=0 AND PARM.SIZE=0 THEN EXIT; /* Indefinite terminated    */
      198      852    3            IF PARM.PARSED THEN CALL GET_TAG ALTRET(RETALT);
      199      853    3            IF TAG~=0 THEN GOTO ERR_STR_SIZE;
      200      854    3         END;
      201      855        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:10   
      202      856    2      CASE (%XSP_ASN1_INTEGER);
      203      857    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;
      204      858    2         IF I>5 THEN GOTO ERR_BIG_VALUE;
      205      859    2         VAL = '0'B;
      206      860    2         SUBSTR(VALC,8-I,I) = %CHRS,PARM.NXTX,I);
      207      861    2         PARM.NXTX = PARM.NXTX+I;
      208      862    2         IF VAL.N0>7 AND VAL.N0<248 THEN GOTO ERR_BIG_VALUE;
      209      863    2         IF I<2 THEN;
      210      864    2         ELSE IF I=2 THEN VAL.NU = (VAL.NU+VALP(8))/2;
      211      865    3         ELSE DO;
      212      866    3            VAL.NU = (VAL.NU+VALP(8))/2;
      213      867    3            VAL.NU = (VAL.NU+MOD(VAL.NU,256*256))/2;
      214      868    3            VAL.NU = (VAL.NU+MOD(VAL.NU,256*256*256))/2;
      215      869    3            IF I=5 THEN VAL.NU = VAL.NU+VAL.N0*%BITBIN('100000000'X);
      216      870    3         END;
      217      871    2         IF VAL.B2&SIGNS(I) THEN VAL.B2 = VAL.B2|NSIGNS(I);
      218      872    2         IF VAL.N<0 THEN VAL.N0 = -1;
      219      873    2         CALL PUTVALN;
      220      874        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:11   
      221      875    2      CASE (%XSP_ASN1_BIT_STRING);
      222      876    3         IF PARM.TAGC THEN DO;
      223      877    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);
      224      878    3            I = PARM.SIZE-PARM.NXTX;
      225      879    3            PARM.SIZE = PARM.TAG;
      226      880    3         END;
      227      881    2         IF I>8 THEN GOTO ERR_BIG_VALUE;
      228      882    2         VAL = '0'B;
      229      883    2         SUBSTR(VALC,0,I) = %CHRS,PARM.NXTX,I);
      230      884    2         PARM.NXTX = PARM.SIZE;
      231      885    2         T1 = VALU(0);
      232      886    2         IF T1>7 THEN GOTO ERR_BAD_VALUE;
      233      887    2         I = 8*I-T1-8;
      234      888    2         VAL.U0 = VAL.U0*1024;
      235      889    3         IF I>8 THEN DO;
      236      890    3            VAL.U0 = VAL.U0+MOD(VAL.U0,512*512*512);
      237      891    3            IF I<17 THEN EXIT;
      238      892    3            VAL.U0 = VAL.U0+MOD(VAL.U0,512*512*2);
      239      893    3            IF I<25 THEN EXIT;
      240      894    3            VAL.U0 = VAL.U0+VALU(4)*16;
      241      895    3            IF I<33 THEN EXIT;
      242      896    3            VAL.U0 = VAL.U0+VALU(5)/16;
      243      897    3            VAL.NU = VAL.NU+VALP(8);
      244      898    3            VAL.NU = (VAL.NU+MOD(VAL.NU,131072))*512*32;
      245      899    3         END;
      246      900    2         CALL PUTVALB;
      247      901        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:12   
      248      902    2      CASE (%XSP_ASN1_BOOLEAN);
      249      903    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;
      250      904    2         IF I~=1 THEN GOTO ERR_BAD_SIZE;
      251      905    2         VAL = '0'B;
      252      906    2         SUBSTR(VALC,0,1) = %CHRS,PARM.NXTX,1);
      253      907    2         PARM.NXTX = PARM.NXTX+1;
      254      908    2         IF VAL.B THEN VAL.B = '1'B;
      255      909    2         CALL PUTVALB;
      256      910        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:13   
      257      911    2      CASE (%XSP_ASN1_NULL);
      258      912    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;
      259      913    2         IF I~=0 THEN GOTO ERR_BAD_SIZE;
      260      914    2         IF VNODE.FPTID>0 THEN FPT.NULLRSLT(VNODE.FPTID)='1'B;
      261      915        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:14   
      262      916    2      CASE (%XSP_ASN1_OBJECT_IDENTIFIER);
      263      917    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;
      264      918    2         IF NOT VNODE.IGNORE THEN CALL GETVALPTR;
      265      919    2         ELSE VALLIM=-1;
      266      920    2         CALL GET_7S ALTRET(ERR_BIG_VALUE);
      267      921    2         T1 = MINIMUM(VAL.N/40,2);
      268      922    2         IF VALLIM>=0 THEN CALL BINCHAR(SUBSTR(VALTXT,VALX,1),T1);
      269      923    2         VAL.N = VAL.N-40*T1;
      270      924    2         VALX = VALX+1;
      271      925    2         IF I<=0 THEN GOTO ERR_BAD_SIZE;
      272      926    3         DO WHILE '1'B;
      273      927    3            T1 = 1;
      274      928    3            IF VAL.NU<10 THEN;
      275      929    4            ELSE DO;
      276      930    4               T1 = T1+1;
      277      931    4               IF VAL.NU<100 THEN EXIT;
      278      932    4               T1 = T1+1;
      279      933    4               IF VAL.NU<1000 THEN EXIT;
      280      934    4               T1 = T1+1;
      281      935    4               IF VAL.NU<10000 THEN EXIT;
      282      936    4               T1 = T1+1;
      283      937    4               IF VAL.NU<100000 THEN EXIT;
      284      938    4               T1 = T1+1;
      285      939    4               IF VAL.NU<1000000 THEN EXIT;
      286      940    4               T1 = T1+1;
      287      941    4            END;
      288      942    3            IF VALLIM<VALX+T1+1 THEN IF VALLIM>=0 THEN GOTO ERR_WONT_FIT;
      289      943    3            ELSE GOTO SKIP_STORE;
      290      944    3            SUBSTR(VALTXT,VALX,1) = '-';
      291      945    3            CALL BINCHAR(SUBSTR(VALTXT,VALX+1,T1),VAL.N);
      292      946    3   SKIP_STORE:;
      293      947    3            VALX = VALX+T1+1;
      294      948    3            IF I<=0 THEN EXIT;
      295      949    3            CALL GET_7S ALTRET(ERR_BIG_VALUE);
      296      950    3         END;
      297      951    3         IF VALLIM>=0 THEN DO;
      298      952    3            SUBSTR(VALTXT,VALX,VALLIM-VALX) = ' ';
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:15   
      299      953    3            CALL SET_LNG;
      300      954    3         END;
      301      955        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:16   
      302      956    2      CASE (%XSP_ASN1_GENERALIZED_TIME, %XSP_ASN1_UTC_TIME);
      303      957    2         TAG = NODE.TYPE;
      304      958    3         IF PARM.TAGC THEN DO;
      305      959    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);
      306      960    3            I = PARM.SIZE-PARM.NXTX;
      307      961    3            PARM.SIZE = PARM.TAG;
      308      962    3         END;
      309      963    3         IF TAG=%XSP_ASN1_GENERALIZED_TIME THEN DO;
      310      964    3            IF %CHRS,PARM.NXTX,2)~='19' AND
      311      965    3              %CHRS,PARM.NXTX,2)~='20' THEN GOTO ERR_BIG_VALUE;
      312      966    3            PARM.NXTX = PARM.NXTX+2;
      313      967    3            I = I-2;
      314      968    3         END;
      315      969    2         IF I<11 THEN GOTO ERR_BAD_SIZE;
      316      970    2         CALL CHARBIN(T1,%CHRS,PARM.NXTX,10)); /* YYMMDDhhmm                     */
      317      971    2         VAL.N = MOD(T1,10000);            /* hh:mm                              */
      318      972    2         VAL.N = VAL.N-40*(VAL.N/100);     /* mmmmm                              */
      319      973    2         T1 = T1/10000;                    /* YYMMDD                             */
      320      974    2         IF T1 < 210101 THEN T1=T1+1000000;/* ALLOW FOR YEARS >1999              */
      321      975    2         T1 = T1 - 780101;                 /* YEARS SINCE 1978                   */
      322      976    2         IF T1<0 THEN GOTO ERR_BIG_VALUE;  /* YEARS PRIOR TO 1978                */
      323      977    2         SIZE = T1/10000;                  /* YY-78                              */
      324      978    2         T1 = MOD(T1,10000);               /* MM(-1)DD(-1)                       */
      325      979    2         IF MOD(SIZEU,4)~=2 AND T1>199 THEN VAL.N = VAL.N-24*60;
      326      980    2         VAL.N = VAL.N + 24*60*(YEARS(SIZE) + MONTHS(T1/100) + MOD(T1,100));
      327      981    2         I = I-10;
      328      982    2         VAL.N = VAL.N*6000;
      329      983    2         VALX = 0;
      330      984    3         DO WHILE I>0;
      331      985    3            T1 = ASCBIN(%CHRS,PARM.NXTX+10,1));
      332      986    3            I = I-1;
      333      987    3            PARM.NXTX = PARM.NXTX+1;
      334      988    4            IF T1>=ASCBIN('0') AND T1<=ASCBIN('9') THEN DO;
      335      989    5               IF VALX=0 THEN DO;
      336      990         /* Seconds specified */
      337      991    5                  CALL CHARBIN(T1,%CHRS,PARM.NXTX+9,2));
      338      992    5                  VAL.N = VAL.N+T1*100;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:17   
      339      993    5                  I = I-1;
      340      994    5                  PARM.NXTX = PARM.NXTX+1;
      341      995    4               END; ELSE IF VALX>0 THEN VAL.N = VAL.N+VALX*(T1-ASCBIN('0'));
      342      996    4               ELSE IF VALX=-9 THEN GOTO ERR_BAD_VALUE;
      343      997    4               VALX = VALX-9;
      344      998    4            END;
      345      999    3            ELSE IF T1=ASCBIN('Z') THEN GOTO GOT_UTC_TIME;
      346     1000    4            ELSE IF T1=ASCBIN('+') OR T1=ASCBIN('-') THEN DO;
      347     1001    4               IF I~=4 THEN GOTO ERR_BAD_VALUE;
      348     1002    4               CALL CHARBIN(VALX,%CHRS,PARM.NXTX+10,4));
      349     1003    4               VALX = (VALX-40*(VALX/100))*6000;
      350     1004    4               IF T1=ASCBIN('+') THEN VAL.N = VAL.N-VALX;
      351     1005    4               ELSE VAL.N = VAL.N+VALX;
      352     1006    4               GOTO GOT_UTC_TIME;
      353     1007    4            END;
      354     1008    3            ELSE IF (T1=ASCBIN('.') OR T1=ASCBIN(','))
      355     1009    3              AND VALX=-9 AND TAG=%XSP_ASN1_GENERALIZED_TIME THEN VALX = 10;
      356     1010    3            ELSE GOTO ERR_BAD_VALUE;
      357     1011    3         END;
      358     1012    2         IF TAG=%XSP_ASN1_UTC_TIME THEN GOTO ERR_BAD_VALUE; /* Local not ok      */
      359     1013    3         ELSE DO WHILE '0'B;
      360     1014    3   GOT_UTC_TIME:
      361     1015    3            VAL.N = VAL.N+XSP_UTC_OFFSETN;
      362     1016    3         END;
      363     1017    2         CALL PUTVALN;
      364     1018        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:18   
      365     1019    2      CASE (ELSE);                         /* Text strings                       */
      366     1020    3         IF PARM.TAGC THEN DO;
      367     1021    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);
      368     1022    3            I = PARM.SIZE-PARM.NXTX;
      369     1023    3            PARM.SIZE = PARM.TAG;
      370     1024    3         END;
      371     1025    3         IF NOT VNODE.IGNORE THEN DO;
      372     1026    3            CALL GETVALPTR;
      373     1027    3            IF VALX+I>VALLIM THEN GOTO ERR_WONT_FIT;
      374     1028    3            SUBSTR(VALTXT,VALX,VALLIM-VALX) = %CHRS,PARM.NXTX,I);
      375     1029    3            VALX = VALX+I;
      376     1030    3            CALL SET_LNG;
      377     1031    3         END;
      378     1032    2         ELSE PARM.P.VAL$ = ADDR(%CHRS,PARM.NXTX));
      379     1033    2         PARM.NXTX = PARM.SIZE;
      380     1034    2         PARM.SIZE = I;
      381     1035    2      END;
      382     1036        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:19   
      383     1037        /*
      384     1038           Done parsing this node (successfully).
      385     1039        */
      386     1040    1      PARM.PARSED = '1'B;
      387     1041    2      IF NODE.SUCC.RCV THEN DO;
      388     1042    2         PARM.USR = %XSP_ASN1_RCV_SUCC;
      389     1043    2         CALL FPT.UENTRY$ (PARM);
      390     1044    2      END;
      391     1045    1      RETURN;
      392     1046        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:20   
      393     1047        /*
      394     1048           Error returns.  Something didn't jibe.
      395     1049        */
      396     1050    1   ERR_WONT_FIT: ERR = ERR+1;              /* Data exceeds supplied buffer       */
      397     1051    1   ERR_BIG_VALUE: ERR = ERR+1;        /* CP-6 values are not umlimited in size   */
      398     1052    1   ERR_BAD_VALUE: ERR = ERR+1;        /* Bad syntax for time or bitstring value  */
      399     1053    1   ERR_STR_SIZE: ERR = ERR+1;              /* Whole ~= sum of the parts          */
      400     1054    1   ERR_NOT_STR: ERR = ERR+1;     /* Expected constructed item, got primitive     */
      401     1055    1   ERR_NOT_PRIM: ERR = ERR+1;    /* Expected primitive item, got constructed     */
      402     1056    1   ERR_BAD_SIZE: ERR = ERR+1;    /* Wrong size for BOOLEAN, NULL, or time value  */
      403     1057    1   ERR_WRONG_TAG: ERR = ERR+1;        /* Couldn't match the specified syntax     */
      404     1058    1   RETALT:;
      405     1059    1      IF ERR~=0 THEN PARM.ERR = ERR;
      406     1060    2      IF NODE.FAIL.RCV THEN DO;
      407     1061    2         PARM.USR = %XSP_ASN1_RCV_FAIL;
      408     1062    2         CALL FPT.UENTRY$ (PARM);
      409     1063    2      END;
      410     1064    1      IF PARM.ERR=0 THEN RETURN;
      411     1065    1      ALTRETURN;
      412     1066        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:21   
      413     1067        /*
      414     1068        Subroutines
      415     1069        */
      416     1070    1   GET_7S: PROC ALTRET;
      417     1071    3      CALL INDEX(T1,%BINASC(0),%CHRS,PARM.NXTX,I),0,'577'O) WHENALTRETURN DO;
      418     1072    3         ERR = ERR-1;                      /* BAD_VALUE is BIG_VALUE-1           */
      419     1073    3         ALTRETURN;
      420     1074    3      END;
      421     1075    2      VAL='0'B;
      422     1076    2      IF T1>4 THEN ALTRETURN;
      423     1077    2      T1 = T1+1;
      424     1078    2      SUBSTR(VALC,8-T1,T1) = %CHRS,PARM.NXTX,T1);
      425     1079    2      PARM.NXTX = PARM.NXTX+T1;
      426     1080    2      I = I-T1;
      427     1081    3      IF T1>1 THEN DO;
      428     1082    3         VALU(7) = VAL.NU*4;
      429     1083    3         VAL.LO18.N = VAL.NU*4;
      430     1084    3         VAL.LO27.N = VAL.NU*4;
      431     1085    3         VAL.NU = VAL.NU*4;
      432     1086    3         VAL.NU = VAL.NU/(4*4*4*4);
      433     1087    3         IF T1=5 THEN VAL.NU = VAL.NU+VAL.U0*512*512*512*2;
      434     1088    3      END;
      435     1089    2      RETURN;
      436     1090    2   END GET_7S;
      437     1091        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:22   
      438     1092    1   GET_TAG: PROC ALTRET;
      439     1093
      440     1094    3      IF SIZE<=PARM.NXTX THEN DO;
      441     1095        /* No more tags in this structure */
      442     1096    3         TAG = 0;
      443     1097    3         PARM.TAG = 0;
      444     1098    3         PARM.SIZE = SIZE;
      445     1099    3         RETURN;
      446     1100    3      END;
      447     1101    2      T1 = PARM.MAXX-PARM.NXTX-2;
      448     1102    2      IF T1<0 THEN GOTO ERR_NO_TAG;
      449     1103    2      VALC = %CHRS,PARM.NXTX,T1+2);
      450     1104    2      TAG = VALU(0);
      451     1105    2      PARM.TAGC = '0'B;
      452     1106    2      IF VAL.TAG.CONSTRUCTED THEN PARM.TAGC = '1'B;
      453     1107    3      IF NOT VAL.B&'777777'O THEN DO;      /* Two zero bytes                     */
      454     1108    3         PARM.TAG = 0;
      455     1109    3         PARM.SIZE = 0;
      456     1110    3         RETURN;
      457     1111    3      END;
      458     1112    2      TAGX = TAG/64*65536;
      459     1113    2      TAG = MOD(TAG,32);
      460     1114    3      IF TAG=31 THEN DO;
      461     1115    3         VAL = VALSHF.B;
      462     1116    3         TAG = VALU(0);
      463     1117    4         DO WHILE '1'B;
      464     1118    4            T1 = T1-1;
      465     1119    4            IF NOT VAL.B&'2'O THEN EXIT;
      466     1120    4            VAL = VALSHF.B;
      467     1121    4            TAG = TAG*128+VALU(0)-128*128;
      468     1122    4            IF TAG>65535 THEN GOTO ERR_BIG_TAG;
      469     1123    4         END;
      470     1124    3      END;
      471     1125    2      TAG = TAG+TAGX;
      472     1126    2      PARM.TAG = TAG;
      473     1127    2      IF TAG=0 OR T1<0 THEN GOTO ERR_NO_TAG;
      474     1128    2      PARM.NXTX = PARM.MAXX-T1;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:23   
      475     1129    2      VAL.NU = VALU(1);
      476     1130    3      IF VAL.NU<128 THEN DO;               /* Short form for length              */
      477     1131    3         PARM.SIZE = PARM.NXTX+VAL.NU;
      478     1132    3         IF PARM.SIZE>PARM.MAXX THEN GOTO ERR_BIG_LNG;
      479     1133    3      END; ELSE IF VAL.NU=128 THEN DO;     /* Indefinite form for length         */
      480     1134    3         PARM.SIZE = 65535;
      481     1135    3      END; ELSE /* IF VAL.NU>128 THEN */ DO; /* Long form                        */
      482     1136    3         PARM.NXTX = PARM.NXTX+1;
      483     1137    3         IF VAL.NU<130 THEN VAL.NU = VALU(2);
      484     1138    4         ELSE IF VAL.NU=130 THEN DO;
      485     1139    4            VAL.NU = MOD((VAL.U0+VALU(3))/2,65536);
      486     1140    4            PARM.NXTX = PARM.NXTX+1;
      487     1141    4         END; ELSE DO;
      488     1142    4            VAL.NU = VAL.NU-128;
      489     1143    4            VAL.B = '0'B;
      490     1144    4            T1 = T1-VAL.NU;
      491     1145    4            IF T1<0 OR VAL.NU=127 THEN GOTO ERR_BIG_LNG;
      492     1146    4            PARM.NXTX = PARM.MAXX-T1;
      493     1147    4            IF VAL.NU>8 THEN VAL.NU=8;
      494     1148    4            SUBSTR(VALC,8-VAL.NU,VAL.NU) = %CHRS,PARM.NXTX-VAL.NU,VAL.NU);
      495     1149    4            IF VAL.B THEN GOTO ERR_BIG_LNG;
      496     1150    4            VAL.NU = VAL.NU+MOD(VAL.NU,512);
      497     1151    4            VAL.NU = VAL.NU+MOD(VAL.NU,512*512);
      498     1152    4            VAL.NU = (VAL.NU+MOD(VAL.NU,512*512*512))/8;
      499     1153    4         END;
      500     1154    3         PARM.SIZE = VAL.NU+PARM.NXTX;
      501     1155    3         IF PARM.SIZE>PARM.MAXX THEN GOTO ERR_BIG_LNG;
      502     1156    3      END;
      503     1157    2      PARM.PARSED = '0'B;
      504     1158    2      RETURN;
      505     1159    2   ERR_BIG_LNG: ERR = ERR+1;
      506     1160    2   ERR_BIG_TAG: ERR = ERR+1;
      507     1161    2   ERR_NO_TAG: ERR = ERR+%XSP_ASN1_E$NO_TAG;
      508     1162    2      ALTRETURN;
      509     1163    2   END GET_TAG;
      510     1164        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:24   
      511     1165    1   PUTVALN: PROC;
      512     1166
      513     1167    2   DCL BITS BIT(SIZE) BASED;
      514     1168    2   DCL CHARS CHAR(4000) BASED(PTRS.VAL$);
      515     1169    2   DCL BYTES(0:0) UBIN(9) CALIGNED BASED(PTRS.VAL$);
      516     1170    2   DCL HWORD UBIN(18) BASED(PTRS.VAL$) ALIGNED;
      517     1171    2   DCL WORDS(0:0) UBIN BASED(PTRS.VAL$) ALIGNED;
      518     1172
      519     1173    3      IF VNODE.IGNORE THEN DO;
      520     1174    3         PARM.P.VAL$ = ADDR(VAL.N);
      521     1175    3         PARM.SIZE = 36;
      522     1176    3         RETURN;
      523     1177    3      END;
      524     1178    2      PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);
      525     1179    2      IF VNODE.INCRPTR
      526     1180    2      THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);
      527     1181    2      SIZE = VNODE.SIZE;
      528     1182    2      IF SIZE=0 THEN SIZE = 36;
      529     1183    3      IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;
      530     1184    3         SIZE = SIZE/9;
      531     1185    4         IF SIZE>7 THEN DO;
      532     1186    4            PTRS.VAL$ = PINCRC(PTRS.VAL$,SIZE-7);
      533     1187    4            SIZE = 7;
      534     1188    4         END;
      535     1189    3         SUBSTR(CHARS,VNODE.OFFSET,SIZE) = SUBSTR(VALC,8-SIZE,SIZE);
      536     1190    3      END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;
      537     1191    4         IF SIZE>72 THEN DO;
      538     1192    4            PTRS.VAL$ = PINCRW(PTRS.VAL$,SIZE/36-2);
      539     1193    4            SIZE = 72;
      540     1194    4         END;
      541     1195    3         WORDS(VNODE.OFFSET) = VAL.N;
      542     1196    4         IF SIZE>36 THEN DO;
      543     1197    4            WORDS(VNODE.OFFSET+1) = VAL.N;
      544     1198    4            WORDS(VNODE.OFFSET) = VAL.N0;
      545     1199    4         END;
      546     1200    3      END; ELSE DO;
      547     1201    4         IF SIZE>72 THEN DO;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:25   
      548     1202    4            PTRS.VAL$ = PINCRB(PTRS.VAL$,SIZEU-72);
      549     1203    4            SIZE = 72;
      550     1204    4         END;
      551     1205    3         PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS =
      552     1206    3           PINCRB(ADDR(VAL),72-SIZE)->BITS;
      553     1207    3      END;
      554     1208    2      RETURN;
      555     1209        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:26   
      556     1210    2   PUTVALB: ENTRY;
      557     1211    3      IF VNODE.IGNORE THEN DO;
      558     1212    3         PARM.P.VAL$ = ADDR(VAL);
      559     1213    3         PARM.SIZE = I;
      560     1214    3         RETURN;
      561     1215    3      END;
      562     1216    2      PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);
      563     1217    2      IF VNODE.INCRPTR
      564     1218    2      THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);
      565     1219    2      SIZE = VNODE.SIZE;
      566     1220    2      IF SIZE=0 THEN SIZE = 1;
      567     1221    2      IF SIZE>56 THEN SIZE = 56;
      568     1222    3      IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;
      569     1223    3         T1 = SIZE/9;
      570     1224    3         SUBSTR(CHARS,VNODE.OFFSET,T1) = SUBSTR(VALC,0,T1);
      571     1225    3      END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;
      572     1226    3         WORDS(VNODE.OFFSET) = VAL.N0;
      573     1227    3         IF SIZE>36 THEN WORDS(VNODE.OFFSET+1) = VAL.N;
      574     1228    2      END; ELSE PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS = ADDR(VAL)->BITS;
      575     1229    2      RETURN;
      576     1230        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:27   
      577     1231    2   GETVALPTR: ENTRY;
      578     1232    2      PTRS.VAL$ = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(VNODE.OFFSET));
      579     1233    2      VALLIM = VNODE.SIZELIM;
      580     1234    2      IF VNODE.INCRPTR
      581     1235    2      THEN FPT.DAT$(VNODE.FPTPTR) = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(VALLIM));
      582     1236    2      IF VALLIM=0 THEN VALLIM = VNODE.SIZE;
      583     1237    2      VALX = 0;
      584     1238    3      DO CASE VNODE.CP6TYP;                /* textc stuff                        */
      585     1239    3      CASE (%XSP_ASN1_CP6TYP_TEXTH);       /* Half-word size, aligned            */
      586     1240    3         IF VALLIM=0 THEN VALLIM = PTRS.VAL$->HWORD+2;
      587     1241    3         VALX = 2;
      588     1242    3      CASE (%XSP_ASN1_CP6TYP_TEXT, %XSP_ASN1_CP6TYP_TEXTNB);
      589     1243    3      CASE (%XSP_ASN1_CP6TYP_TEXTFPTSIZ);  /* Size is in FPT.DAT$+1              */
      590     1244    3         IF VALLIM=0 THEN VALLIM = FPT.DATSIZ(VNODE.FPTPTR+1);
      591     1245    3      CASE (ELSE);
      592     1246    3         IF VNODE.SIZE=0 THEN GOTO GETVALPTR1;
      593     1247    3      CASE (%XSP_ASN1_CP6TYP_TEXTC);
      594     1248    3   GETVALPTR1:;
      595     1249    3         VALX = VALX+1;
      596     1250    3         IF VALLIM = 0 THEN VALLIM = BYTES(0)+1;
      597     1251    3      END;
      598     1252    2      RETURN;
      599     1253    2   SET_LNG: ENTRY;
      600     1254    3      DO CASE VNODE.CP6TYP;                /* textc stuff                        */
      601     1255    3      CASE (%XSP_ASN1_CP6TYP_TEXTH);       /* Half-word size, aligned            */
      602     1256    3         PTRS.VAL$->HWORD = VALX-2;
      603     1257    3      CASE (%XSP_ASN1_CP6TYP_TEXTFPTSIZ);  /* Size is in FPT.DAT$+1              */
      604     1258    3         FPT.DATSIZ(VNODE.FPTPTR+1) = VALX;
      605     1259    3      CASE (%XSP_ASN1_CP6TYP_TEXTC);
      606     1260    3         BYTES(0) = VALX-1;
      607     1261    3      CASE (%XSP_ASN1_CP6TYP_TEXT, %XSP_ASN1_CP6TYP_TEXTNB);
      608     1262    3      CASE (ELSE);
      609     1263    3         IF VNODE.SIZE=0 THEN BYTES(0) = VALX-1;
      610     1264    3      END;
      611     1265    2      RETURN;
      612     1266    2   END PUTVALN;
      613     1267        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:28   
      614     1268        /*F* NAME: XSP$DECONSTRUCT
      615     1269             PURPOSE: Scrunches a constructed string_type item down to
      616     1270             look like a primitive one.
      617     1271        */
      618     1272    1   XSP$DECONSTRUCT: ENTRY (PARM) ALTRET;
      619     1273    1      PTRS = PARM.P;
      620     1274    1      TAG = NODE.TYPE;
      621     1275    1      IF TAG~=%XSP_ASN1_BIT_STRING THEN TAG = %XSP_ASN1_OCTET_STRING;
      622     1276    1      SIZE = PARM.SIZE;
      623     1277    1      TAGX = PARM.NXTX;
      624     1278    1      I = PARM.NXTX;
      625     1279    1      T1 = PARM.NXTX;
      626     1280    2      DO WHILE '1'B;
      627     1281    2         VALC = %CHRS,I,8);
      628     1282    2         I = I+2;
      629     1283    2         IF SIZE=65535 AND VAL.U0/262144=0 THEN EXIT;
      630     1284    2         IF VAL.TAG.HI_BITS OR VAL.TAG.TAG~=TAG THEN GOTO ERR_WRONG_TAG;
      631     1285    2         LNGX = VALU(1);                   /* Length control byte                */
      632     1286    2         IF LNGX<128 THEN;
      633     1287    2         ELSE IF LNGX=128 THEN LNGX=65535;
      634     1288    3         ELSE DO;
      635     1289    3            I = I+1;
      636     1290    3            IF LNGX<130 THEN LNGX = VALU(2);
      637     1291    4            ELSE IF LNGX=130 THEN DO;
      638     1292    4               LNGX = MOD((VAL.U0+VALU(3))/2,65536);
      639     1293    4               I = I+1;
      640     1294    4            END; ELSE DO;
      641     1295    4               LNGX = LNGX-128;
      642     1296    4               IF LNGX=127 THEN GOTO ERR_BAD_SIZE;
      643     1297    4               I = I+LNGX;
      644     1298    4               IF LNGX>4 THEN LNGX=4;
      645     1299    4               SUBSTR(VALC,8-LNGX,LNGX) = %CHRS,I-LNGX,LNGX);
      646     1300    4               LNGX = (VAL.NU+MOD(VAL.NU,512))/2;
      647     1301    4            END;
      648     1302    3         END;
      649     1303    3         IF VAL.TAG.CONSTRUCTED THEN DO;
      650     1304    3            PARM.SIZE = LNGX;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:29   
      651     1305    3            PARM.NXTX = I;
      652     1306    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);
      653     1307    3            LNGX = PARM.SIZE;
      654     1308    3         END;
      655     1309    2         IF LNGX>=65535 THEN GOTO ERR_BAD_SIZE;
      656     1310    3         IF TAG=%XSP_ASN1_BIT_STRING THEN DO;
      657     1311    3            %CHRS,T1,1) = %CHRS,I,1);
      658     1312    3            I = I+1; LNGX = LNGX-1;
      659     1313    3         END;
      660     1314    2         %CHRS,TAGX,LNGX) = %CHRS,I,LNGX);
      661     1315    2         TAGX = TAGX+LNGX;
      662     1316    2         I = I+LNGX;
      663     1317    2         IF VAL.TAG.CONSTRUCTED THEN I = PARM.TAG;
      664     1318    2         IF I>=SIZE THEN EXIT;
      665     1319    2         IF TAG=%XSP_ASN1_BIT_STRING AND %CHRS,T1,1)~=BINASC(0)
      666     1320    2         THEN GOTO ERR_BAD_SIZE;
      667     1321    2      END;
      668     1322    1      PARM.NXTX = T1;
      669     1323    1      PARM.SIZE = TAGX;
      670     1324    1      PARM.TAG = I;
      671     1325    1      RETURN;
      672     1326        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:30   
      673     1327    1   XSP$SEND1: ENTRY (PARM) ALTRET;
      674     1328
      675     1329    1      LNGX = 0;
      676     1330    1      SIZE = 65535;
      677     1331    1      PTRS = PARM.P;
      678     1332    1      IF PTRS.VNODE$=ADDR(NIL) THEN PTRS.VNODE$ = PTRS.NODE$;
      679     1333    2      IF NODE.PRE.SND THEN DO;
      680     1334    2         PARM.USR = %XSP_ASN1_SND_PRE;
      681     1335    3         CALL FPT.UENTRY$ (PARM) WHENALTRETURN DO;
      682     1336    3            ALTRETURN;
      683     1337    3         END;
      684     1338    2         PTRS.VAL$ = PARM.P.VAL$;
      685     1339    2         PARM.P.VAL$ = ADDR(NIL);
      686     1340    2      END;
      687     1341    1      IF NODE.OPTIONL AND NOT FPT.CONDITION(NODE.CONDITION)
      688     1342    1      THEN ALTRETURN;
      689     1343    2      DO CASE (NODE.TYPE);
      690     1344    2      CASE (%XSP_ASN1_SET, %XSP_ASN1_SEQUENCE);
      691     1345    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);
      692     1346    2         IF NODE.TAG~=0 AND NOT NODE.IMPLICIT THEN CALL PUT_TAG;
      693     1347    3         DO I=0 TO NODE.NSUBNDS-1;
      694     1348    3            PARM.P.NODE$ = NODE.SUBND$(I);
      695     1349    4            IF NODE.IMPLICIT THEN DO;
      696     1350    4               CALL PUT_TAG;
      697     1351    4               PARM.IMPLICIT = '1'B;
      698     1352    5               CALL XSP$SEND1 (PARM) WHENRETURN DO;
      699     1353    5                  CALL FIX_LNG;
      700     1354    5               END; WHENALTRETURN DO;
      701     1355    5                  PARM.NXTX = TAGX;
      702     1356    5               END;
      703     1357    4               LNGX = 0;
      704     1358    4               PARM.IMPLICIT = '0'B;
      705     1359    4            END;
      706     1360    3            ELSE CALL XSP$SEND1 (PARM);
      707     1361    3         END;
      708     1362    2         GOTO END_CHOICE;
      709     1363        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:31   
      710     1364    2      CASE (%XSP_ASN1_SET_OF, %XSP_ASN1_SEQUENCE_OF);
      711     1365    2         IF VNODE.VALUE_EXISTS THEN VAL.N = VNODE.VALUE(1);
      712     1366    2         ELSE CALL GETVALN;
      713     1367    2         IF VAL.N<=0 AND NODE.OPTIONL THEN ALTRETURN;
      714     1368    2         SIZE = 65535;
      715     1369    2         IF NODE.TAG~=0 THEN CALL PUT_TAG;
      716     1370    3         DO WHILE VAL.N>0;
      717     1371    3            PARM.P.NODE$ = NODE.SUBND$(0);
      718     1372    3            CALL XSP$SEND1 (PARM) ALTRET (END_CHOICE);
      719     1373    3            VAL.N = VAL.N-1;
      720     1374    3         END;
      721     1375    2         GOTO END_CHOICE;
      722     1376        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:32   
      723     1377    2      CASE (%XSP_ASN1_CHOICE);
      724     1378    2         IF NODE.TAG~=0 THEN CALL PUT_TAG;
      725     1379    2         IF NODE.NSUBNDS>1 AND NODE.TAGS THEN CALL GETVALN;
      726     1380    3         ELSE DO;
      727     1381    3            VAL.N=0;
      728     1382    3            IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);
      729     1383    3         END;
      730     1384    3         DO I=VAL.N TO NODE.NSUBNDS-1;
      731     1385    3            PARM.P.NODE$ = NODE.SUBND$(I);
      732     1386    4            CALL XSP$SEND1 (PARM) WHENRETURN DO;
      733     1387    4               GOTO END_CHOICE;
      734     1388    4            END;
      735     1389    3         END;
      736     1390    2   END_CHOICE:;
      737     1391    2         IF LNGX~=0 THEN CALL FIX_LNG;
      738     1392    2         IF PARM.P.VNODE$~=ADDR(NIL)
      739     1393    2         THEN IF PTRS.VNODE$~=PTRS.NODE$ THEN PARM.P.VNODE$ = PTRS.VNODE$;
      740     1394    2         ELSE PARM.P.VNODE$ = ADDR(NIL);
      741     1395        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:33   
      742     1396    2      CASE (%XSP_ASN1_INTEGER);
      743     1397    2         CALL GETVALN;
      744     1398    2         IF NODE.DEFAULT_EXISTS AND VAL.N=NODE.DEFAULT THEN RETURN;
      745     1399    2         IF VAL.N0<0 THEN VAL.B2=~VAL.B2;
      746     1400    2         SIZE = 1;
      747     1401    3         IF VAL.NU>127 THEN DO;
      748     1402    3            SIZE = SIZE+1;
      749     1403    3            IF VAL.NU<128*256 THEN EXIT;
      750     1404    3            SIZE = SIZE+1;
      751     1405    3            IF VAL.NU<128*256*256 THEN EXIT;
      752     1406    3            SIZE = SIZE+1;
      753     1407    3            IF VAL.NU<128*256*256*256 THEN EXIT;
      754     1408    3            SIZE = SIZE+1;
      755     1409    3         END;
      756     1410    2         IF VAL.N0<0 THEN VAL.B2=~VAL.B2;
      757     1411    2         CALL PUT_TAG;
      758     1412    2         IF SIZE<2 THEN GOTO INT_1;
      759     1413    2         IF SIZE=2 THEN GOTO INT_2;
      760     1414    2         IF SIZE<4 THEN GOTO INT_3;
      761     1415    2         IF SIZE=4 THEN GOTO INT_4;
      762     1416    2         VALU(3)=VALP(4);
      763     1417    2   INT_4:VALU(4)=VALP(5);
      764     1418    2   INT_3:VALU(5)=VALP(6);
      765     1419    2   INT_2:VALU(6)=VALP(7);
      766     1420    2   INT_1:VALU(7)=VALP(8);
      767     1421    2         %CHRS,PARM.NXTX,SIZE) = SUBSTR(VALC,8-SIZE,SIZE);
      768     1422    2         PARM.NXTX = PARM.NXTX+SIZE;
      769     1423        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:34   
      770     1424    2      CASE (%XSP_ASN1_BIT_STRING);
      771     1425    2         CALL GETVALB;
      772     1426    2         IF NODE.DEFAULT_EXISTS AND VAL.B=NODE.DEFAULTB THEN RETURN;
      773     1427    2         I = MOD(SIZEU+7,8);
      774     1428    2         SIZE = 1 + (SIZEU+7)/8;
      775     1429    2         CALL PUT_TAG;
      776     1430    2         IF SIZE<3 THEN GOTO BIT_1;
      777     1431    2         IF SIZE=3 THEN GOTO BIT_2;
      778     1432    2         IF SIZE<5 THEN GOTO BIT_3;
      779     1433    2         IF SIZE=5 THEN GOTO BIT_4;
      780     1434    2         IF SIZE<7 THEN GOTO BIT_5;
      781     1435    2         IF SIZE=7 THEN GOTO BIT_6;
      782     1436    2         VALU(7)=VALP(6);
      783     1437    2   BIT_6:VALU(6)=VALP(5);
      784     1438    2   BIT_5:VALU(5)=VALP(4);
      785     1439    2   BIT_4:VALU(4)=VALP(3);
      786     1440    2   BIT_3:VALU(3)=VALP(2);
      787     1441    2   BIT_2:VALU(2)=VALP(1);
      788     1442    2   BIT_1:VALU(1)=VALP(0);
      789     1443    2         VALU(0) = 7-I;
      790     1444    2         %CHRS,PARM.NXTX,SIZE) = SUBSTR(VALC,0,SIZE);
      791     1445    2         PARM.NXTX = PARM.NXTX+SIZE;
      792     1446        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:35   
      793     1447    2      CASE (%XSP_ASN1_BOOLEAN);
      794     1448    2         CALL GETVALB;
      795     1449    2         SIZE = 1;
      796     1450    2         IF VAL.B THEN VAL.B = '1'B;
      797     1451    2         IF NODE.DEFAULT_EXISTS AND VAL.B=NODE.DEFAULTB
      798     1452    2         THEN RETURN;
      799     1453    2         CALL PUT_TAG;
      800     1454    2         %CHRS,PARM.NXTX,1) = SUBSTR(VALC,0,1);
      801     1455    2         PARM.NXTX = PARM.NXTX+1;
      802     1456        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:36   
      803     1457    2      CASE (%XSP_ASN1_NULL);
      804     1458    2         SIZE = 0;
      805     1459    2         CALL PUT_TAG;
      806     1460        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:37   
      807     1461    2      CASE (%XSP_ASN1_OBJECT_IDENTIFIER);
      808     1462    2         CALL GETVALTXT;
      809     1463    2         IF SIZE<2 AND NODE.OPTIONL THEN ALTRETURN;
      810     1464    2         CALL PUT_TAG;
      811     1465    2         VAL.N = 40*(ASCBIN(SUBSTR(VALTXT,0,1))-ASCBIN('0'));
      812     1466    2         PTRS.VAL$ = PINCRC(PTRS.VAL$,2);
      813     1467    2         SIZE = SIZE-2;
      814     1468    3         DO UNTIL SIZE<=0;
      815     1469    3            CALL INDEX(I,' ',VALTXT,,'017'O);
      816     1470    3            IF I=0 THEN EXIT;
      817     1471    3            CALL CHARBIN(TAG,SUBSTR(VALTXT,0,I));
      818     1472    3            TAG=TAG+VAL.N;
      819     1473    3            SIZE = SIZE-I-1;
      820     1474    3            PTRS.VAL$ = PINCRC(PTRS.VAL$,I+1);
      821     1475    3            CALL PUT_7S;
      822     1476    3            VAL.N = 0;
      823     1477    3         END;
      824     1478    2         CALL FIX_LNG;
      825     1479        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:38   
      826     1480    2      CASE (%XSP_ASN1_GENERALIZED_TIME, %XSP_ASN1_UTC_TIME);
      827     1481    2         CALL GETVALN;
      828     1482    2         IF NODE.TYPE=%XSP_ASN1_UTC_TIME THEN SIZE = 17;
      829     1483    2         ELSE SIZE = 22;
      830     1484    2         CALL PUT_TAG;
      831     1485    3         IF SIZE=22 THEN DO;
      832     1486    3            %CHRS,PARM.NXTX,2) = '19';
      833     1487    3            PARM.NXTX = PARM.NXTX+2;
      834     1488    3         END;
      835     1489        %EQU TIC_DAY = 6000*60*24;
      836     1490    2         VAL.N0 = VAL.NU/%TIC_DAY;         /* Days since 1978                    */
      837     1491    2         IF VAL.N0<3*365+1 THEN I = VAL.N0/365;
      838     1492    2         ELSE I = (VAL.N0-3*356+1)*4/(365*4+1)+3;
      839     1493    2         VAL.NU = VAL.NU-VAL.N0*%TIC_DAY;
      840     1494    2         VAL.N0 = VAL.N0-YEARS(I);
      841     1495    2         IF VAL.N0>=31+28 AND MOD(I,4)~=2 THEN VAL.N0 = VAL.N0+1;
      842     1496    2         I = I+78; CALL PUT_2;
      843     1497    2         I = VAL.N0/29;
      844     1498    2         IF VAL.N0>=MONTHS(I) THEN I = I+1;
      845     1499    2         CALL PUT_2;
      846     1500    2         I = VAL.N0-MONTHS(I-1)+1;         /* Day of month                       */
      847     1501    2         CALL PUT_2;
      848     1502    2         I = VAL.N/(6000*60); VAL.N = MOD(VAL.N,6000*60); /* Hours               */
      849     1503    2         CALL PUT_2;
      850     1504    2         I = VAL.N/6000; VAL.N = MOD(VAL.N,6000); /* Minutes                     */
      851     1505    2         CALL PUT_2;
      852     1506    2         I = VAL.N/100;                    /* SECONDS                            */
      853     1507    2         CALL PUT_2;
      854     1508    3         IF SIZE=22 THEN DO;
      855     1509    3            %CHRS,PARM.NXTX,1) = '.';
      856     1510    3            PARM.NXTX = PARM.NXTX+1;
      857     1511    3            I = MOD(VAL.N,100);
      858     1512    3            CALL PUT_2;
      859     1513    3         END;
      860     1514    2         %CHRS,PARM.NXTX,5) = XSP_UTC_OFFSET;
      861     1515    2         PARM.NXTX = PARM.NXTX+5;
      862     1516        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:39   
      863     1517    2      CASE (ELSE);                         /* Text strings                       */
      864     1518    2         CALL GETVALTXT;
      865     1519    2         IF SIZE=0 AND NODE.OPTIONL THEN ALTRETURN;
      866     1520    2         CALL PUT_TAG;
      867     1521    2         %CHRS,PARM.NXTX,SIZE) = VALTXT;
      868     1522    2         PARM.NXTX = PARM.NXTX+SIZE;
      869     1523    2      END;
      870     1524    2      IF NODE.SUCC.SND THEN DO;
      871     1525    2         PARM.USR = %XSP_ASN1_SND_SUCC;
      872     1526    2         CALL FPT.UENTRY$ (PARM);
      873     1527    2      END;
      874     1528    1      RETURN;
      875     1529        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:40   
      876     1530        /*
      877     1531        Subroutines
      878     1532        */
      879     1533    1   PUT_2: PROC;
      880     1534    2      CALL BINCHAR(%CHRS,PARM.NXTX,2), I);
      881     1535    2      PARM.NXTX = PARM.NXTX+2;
      882     1536    2      RETURN;
      883     1537    2   END PUT_2;
      884     1538
      885     1539    1   PUT_7S: PROC;
      886     1540    2      IF PTRS.BUF$->NODE.DEFAULT=PARM.NXTX THEN RETURN; /* Load some pointers    */
      887     1541    2      IF TAG<128 THEN GOTO PUT_71;
      888     1542    2      IF TAG<128*128 THEN GOTO PUT_72;
      889     1543    2      IF TAG<128*128*128 THEN GOTO PUT_73;
      890     1544    2      IF TAG<128*128*128*128 THEN GOTO PUT_74;
      891     1545    2   PUT_75: T1 = TAG7.N(0)+128;
      892     1546    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;
      893     1547    2   PUT_74: T1 = TAG7.N(1)+128;
      894     1548    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;
      895     1549    2   PUT_73: T1 = TAG7.N(2)+128;
      896     1550    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;
      897     1551    2   PUT_72: T1 = TAG7.N(3)+128;
      898     1552    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;
      899     1553    2   PUT_71: T1 = TAG7.N(4);
      900     1554    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;
      901     1555    2      RETURN;
      902     1556    2   END PUT_7S;
      903     1557        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:41   
      904     1558    1   PUT_TAG: PROC;
      905     1559
      906     1560    2      IF PARM.IMPLICIT AND NOT NODE.IMPLICIT THEN RETURN;
      907     1561    3      IF PARM.MAXX-PARM.NXTX<SIZE+3 THEN DO;
      908     1562    3         IF SIZE=65535 AND PARM.MAXX-PARM.NXTX>3 THEN EXIT;
      909     1563    3         PARM.ERR = %XSP_ASN1_E$WONT_FIT;
      910     1564    3         UNWIND TO PARM.ABORT;
      911     1565    3      END;
      912     1566    2      TAGX = 0;
      913     1567    2      IF NODE.CONSTRUCTED THEN TAGX = 32;
      914     1568    3      IF NODE.IMPLICIT THEN DO;
      915     1569    3         TAG = NODE.TAG+I;
      916     1570    3         IF NOT NODE.SUBND$(I)->NODE.CONSTRUCTED THEN TAGX = 0;
      917     1571    3      END;
      918     1572    2      ELSE TAG = NODE.TAG;
      919     1573    2      TAGX = TAGX+64*(TAG/65536);
      920     1574    2      TAG = MOD(TAG,65536);
      921     1575    2      IF TAG<31 THEN TAGX = TAGX+TAG;
      922     1576    2      ELSE TAGX = TAGX+31;
      923     1577    2      %CHRS,PARM.NXTX,1) = ADDR(TAGX)->C1.C;
      924     1578    2      TAGX = PARM.NXTX;
      925     1579    2      PARM.NXTX = PARM.NXTX+1;
      926     1580    2      IF TAG>30 THEN CALL PUT_7S;
      927     1581    2      LNGX = PARM.NXTX;
      928     1582    3      IF SIZE<128 OR NODE.SHORT THEN DO;
      929     1583    3         SIZE = MOD(SIZEU,128);
      930     1584    3         %CHRS,PARM.NXTX,1) = ADDR(SIZE)->C1.C;
      931     1585    3         PARM.NXTX = PARM.NXTX+1;
      932     1586    3      END; ELSE DO;
      933     1587    3         SIZE = SIZE+BITBIN(BINBIT(SIZE,36)&'0000001774'O|'000202'O);
      934     1588    3         %CHRS,PARM.NXTX,3) = ADDR(SIZE)->C3.C;
      935     1589    3         SIZE = MOD(SIZEU+MOD(SIZEU,256),262144)/2;
      936     1590    3         PARM.NXTX = PARM.NXTX+3;
      937     1591    3      END;
      938     1592    2      RETURN;
      939     1593    2   END PUT_TAG;
      940     1594        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:42   
      941     1595    1   FIX_LNG: PROC;
      942     1596    2      SIZE = PARM.NXTX-LNGX-1;
      943     1597    2      IF %CHRS,LNGX,1)<BINASC(128) THEN IF SIZE<128
      944     1598    2      THEN %CHRS,LNGX,1) = ADDR(SIZE)->C1.C;
      945     1599    3      ELSE DO;
      946     1600    3         %CHRS,LNGX,1) = BINASC(128);
      947     1601    3         %CHRS,PARM.NXTX,2) = %CONCAT(BINASC(0),BINASC(0));
      948     1602    3         PARM.NXTX = PARM.NXTX+2;
      949     1603    3      END; ELSE DO;
      950     1604    3         SIZE = SIZE-2;
      951     1605    3         SIZE = SIZE+BITBIN(BINBIT(SIZE,36)&'0000001774'O);
      952     1606    3         %CHRS,LNGX+1,2) = ADDR(SIZE)->C2.C;
      953     1607    4         IF SIZE<128 THEN DO;
      954     1608    4            %CHRS,LNGX,SIZE+1) = %CHRS,LNGX+2,SIZE+1);
      955     1609    4            PARM.NXTX = PARM.NXTX-2;
      956     1610    4         END; ELSE IF SIZE<256 THEN DO;
      957     1611    4            %CHRS,LNGX,1) = BINASC(129);
      958     1612    4            %CHRS,LNGX+1,SIZE+1) = %CHRS,LNGX+2,SIZE+1);
      959     1613    4            PARM.NXTX = PARM.NXTX-1;
      960     1614    4         END;
      961     1615    3      END;
      962     1616    2      RETURN;
      963     1617    2   END FIX_LNG;
      964     1618        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:43   
      965     1619    1   GETVALN: PROC;
      966     1620
      967     1621    2   DCL BITS BIT(SIZE) BASED;
      968     1622    2   DCL CHARS CHAR(4000) BASED(PTRS.VAL$);
      969     1623    2   DCL BYTES(0:0) UBIN(9) CALIGNED BASED(PTRS.VAL$);
      970     1624    2   DCL HWORD UBIN(18) BASED(PTRS.VAL$) ALIGNED;
      971     1625    2   DCL WORDS(0:0) UBIN BASED(PTRS.VAL$) ALIGNED;
      972     1626
      973     1627    2      VAL = '0'B;
      974     1628    3      IF VNODE.VALUE_EXISTS THEN DO;
      975     1629    3         VAL.N = VNODE.VALUE(BITBIN(VNODE.DEFAULT_EXISTS));
      976     1630    3         IF VAL.N<0 THEN VAL.N0 = -1;
      977     1631    3      END;
      978     1632    3      ELSE IF PTRS.VAL$~=ADDR(NIL) THEN DO;
      979     1633    3         VAL.N = WORDS(0);
      980     1634    3         SIZE = 36;
      981     1635    3         IF VAL.N<0 AND VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN THEN VAL.N0 = -1;
      982     1636    3      END;
      983     1637    3      ELSE DO;
      984     1638    3         PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);
      985     1639    3         IF VNODE.INCRPTR
      986     1640    3         THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);
      987     1641    3         SIZE = VNODE.SIZE;
      988     1642    3         IF SIZE=0 THEN SIZE = 36;
      989     1643    4         IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;
      990     1644    4            SIZE = SIZE/9;
      991     1645    5            IF SIZE>7 THEN DO;
      992     1646    5               PTRS.VAL$ = PINCRC(PTRS.VAL$,SIZE-7);
      993     1647    5               SIZE = 7;
      994     1648    5            END;
      995     1649    4            IF VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN AND SUBSTR(CHARS,0,1)>BINASC(255)
      996     1650    5            THEN DO;
      997     1651    5               VAL.N0 = -1;
      998     1652    5               VAL.N = -1;
      999     1653    5            END;
     1000     1654    4            SUBSTR(VALC,8-SIZE,SIZE) = SUBSTR(CHARS,VNODE.OFFSET,SIZE);
     1001     1655    4         END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:44   
     1002     1656    5            IF SIZE>72 THEN DO;
     1003     1657    5               PTRS.VAL$ = PINCRW(PTRS.VAL$,SIZE/36-2);
     1004     1658    5               SIZE = 72;
     1005     1659    5            END;
     1006     1660    4            VAL.N = WORDS(VNODE.OFFSET);
     1007     1661    5            IF SIZE>36 THEN DO;
     1008     1662    5               VAL.N0 = VAL.N;
     1009     1663    5               VAL.N = WORDS(VNODE.OFFSET+1);
     1010     1664    5            END;
     1011     1665    4            ELSE IF VAL.N<0 AND VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN
     1012     1666    4            THEN VAL.N0 = -1;
     1013     1667    4         END; ELSE DO;
     1014     1668    5            IF SIZE>72 THEN DO;
     1015     1669    5               PTRS.VAL$ = PINCRB(PTRS.VAL$,SIZEU-72);
     1016     1670    5               SIZE = 72;
     1017     1671    5            END;
     1018     1672    5            IF VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN THEN DO;
     1019     1673    5               VAL.N0 = -1;
     1020     1674    5               VAL.N = -1;
     1021     1675    5            END;
     1022     1676    4            PINCRB(ADDR(VAL),72-SIZE)->BITS =
     1023     1677    4              PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS;
     1024     1678    4         END;
     1025     1679    3      END;
     1026     1680    2      RETURN;
     1027     1681        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:45   
     1028     1682    2   GETVALB: ENTRY;
     1029     1683    2      VAL = '0'B;
     1030     1684    2      SIZE = VNODE.SIZE;
     1031     1685    2      IF VNODE.VALUE_EXISTS
     1032     1686    2      THEN VAL.B = VNODE.VALUEB(BITBIN(VNODE.DEFAULT_EXISTS));
     1033     1687    3      ELSE IF PTRS.VAL$~=ADDR(NIL) THEN DO;
     1034     1688    3         VAL.N0 = WORDS(0);
     1035     1689    3         IF SIZE=0 THEN SIZE = 1;
     1036     1690    3      END;
     1037     1691    3      ELSE DO;
     1038     1692    3         PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);
     1039     1693    3         IF VNODE.INCRPTR
     1040     1694    3         THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);
     1041     1695    3         IF SIZE=0 THEN SIZE = 1;
     1042     1696    3         IF SIZE>56 THEN SIZE = 56;
     1043     1697    4         IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;
     1044     1698    4            T1 = SIZE/9;
     1045     1699    4            SUBSTR(VALC,0,T1) = SUBSTR(CHARS,VNODE.OFFSET,T1);
     1046     1700    4         END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;
     1047     1701    4            VAL.N0 = WORDS(VNODE.OFFSET);
     1048     1702    4            IF SIZE>36 THEN VAL.N = WORDS(VNODE.OFFSET+1);
     1049     1703    3         END; ELSE ADDR(VALC)->BITS = PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS;
     1050     1704    3      END;
     1051     1705    2      RETURN;
     1052     1706        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:46   
     1053     1707    2   GETVALTXT: ENTRY;
     1054     1708    2      SIZE = VNODE.SIZE;
     1055     1709    2      T1 = VNODE.SIZELIM;
     1056     1710    3      IF NOT VNODE.VALUE_EXISTS THEN DO;
     1057     1711    3         IF PTRS.VAL$~=ADDR(NIL) THEN EXIT;
     1058     1712    3         PTRS.VAL$ = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(VNODE.OFFSET));
     1059     1713    3         IF VNODE.INCRPTR
     1060     1714    3         THEN FPT.DAT$(VNODE.FPTPTR) = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(T1));
     1061     1715    3      END;
     1062     1716    2      ELSE IF NOT VNODE.DEFAULT_EXISTS THEN PTRS.VAL$ = ADDR(VNODE.DEFAULT);
     1063     1717    2      ELSE PTRS.VAL$ = PINCRC(ADDR(VNODE.DEFAULT),SIZE);
     1064     1718    3      IF SIZE=0 THEN DO CASE VNODE.CP6TYP; /* textc stuff                        */
     1065     1719    3      CASE (%XSP_ASN1_CP6TYP_TEXTH);       /* Half-word size, aligned            */
     1066     1720    3         SIZE = PTRS.VAL$->HWORD;
     1067     1721    3         IF T1=0 THEN T1=SIZE+2;
     1068     1722    3         PTRS.VAL$ = PINCRC(PTRS.VAL$,2);
     1069     1723    3      CASE (%XSP_ASN1_CP6TYP_TEXTNB);      /* Skip trailing blanks               */
     1070     1724    4         DO WHILE SIZE<T1;
     1071     1725    4            IF SUBSTR(CHARS,SIZE,T1-SIZE)=' ' THEN EXIT;
     1072     1726    4            CALL INDEX (SIZE,' ',SUBSTR(CHARS,0,T1),SIZE+1);
     1073     1727    4         END;
     1074     1728    3      CASE (%XSP_ASN1_CP6TYP_TEXTFPTSIZ);  /* Size is in FPT.DAT$+1              */
     1075     1729    3         SIZE = FPT.DATSIZ(VNODE.FPTPTR+1);
     1076     1730    3         IF T1=0 THEN T1=SIZE;
     1077     1731    3      CASE (ELSE);
     1078     1732    3         IF VNODE.VALUE_EXISTS AND VNODE.DEFAULT_EXISTS
     1079     1733    3         THEN PTRS.VAL$ = PINCRC(PTRS.VAL$,BYTES(0)+1);
     1080     1734    3         SIZE = BYTES(0);
     1081     1735    3         IF T1=0 THEN T1 = SIZE+1;
     1082     1736    3         PTRS.VAL$ = PINCRC(PTRS.VAL$,1);
     1083     1737    3      END;
     1084     1738    2      RETURN;
     1085     1739    2   END GETVALN;
     1086     1740    1   END XSP$ASN1;
     1087     1741        %EOD;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:47   
--  Include file information  --

   XSP_ASN1_M.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$ASN1.

   Procedure XSP$ASN1 requires 2938 words for executable code.
   Procedure XSP$ASN1 requires 26 words of local(AUTO) storage.

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:48   

 Object Unit name= XSP$ASN1                                   File name= XSP$ASN1.:XSA1TOU
 UTS= OCT 01 '97 11:58:24.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     70    106  XSP$ASN1
    1   Data  even  none     3      3  XSP$ASN1
    2   Proc  even  none  2938   5572  XSP$ASN1
    3  RoData even  none    29     35  XSP$ASN1

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  XSP$ASN1
     2      3          yes     yes      Std        1  XSP$RECV1
     2   2737          yes     yes      Std        1  XSP$DECONSTRUCT
     2   3200          yes     yes      Std        1  XSP$SEND1

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  XSP_UTC_OFFSET                     1      2  XSP_UTC_OFFSETN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       nStd      0 X66_AUNWIND
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:49   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:50   


        1        1        /*M* XSP$ASN1 - send and receive ASN.1 protocol messages. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        9        9        XSP$ASN1: PROC (PARM) ALTRET;

      9  2 000000   000000 700200 xent  XSP$ASN1     TSX0  ! X66_AUTO_1
         2 000001   000032 000001                    ZERO    26,1
         2 000002   000005 710000 2                  TRA     s:737

       10       10
       11       11        %INCLUDE XSP_ASN1_M;
       12      357        %XSP$ASN1_PARM (NAME=PARM, STCLASS=PARAM);
       13      383        %XSP_ASN1_N (NAME=NODE, STCLASS="BASED(PTRS.NODE$)");
       14      471        %XSP_ASN1_N (NAME=VNODE, STCLASS="BASED(PTRS.VNODE$)");
       15      559        %XSP_ASN1_E;
       16      626
       17      627        %XSP_ASN1_FPT (FPTN=FPT, STCLASS="BASED(PTRS.FPT$)");
       18      647
       19      648        %XSP$ASN1_PARM (PTRONLY=YES, PNAME=PTRS, STCLASS=);
       20      674    1   DCL VALTXT CHAR(SIZE) BASED(PTRS.VAL$);
       21      675    1   DCL TXT CHAR(4000) BASED(PTRS.BUF$);
       22      676        %EQU CHRS = CHARTEXT('SUBSTR(TXT');
       23      677
       24      678    1   DCL 1 C1 BASED ALIGNED,
       25      679    1          2 * CHAR(3),
       26      680    1          2 C CHAR(1);
       27      681    1   DCL 1 C2 BASED ALIGNED,
       28      682    1          2 * CHAR(2),
       29      683    1          2 C CHAR(2);
       30      684    1   DCL 1 C3 BASED ALIGNED,
       31      685    1          2 * CHAR(1),
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:51   
       32      686    1          2 C CHAR(3);
       33      687    1   DCL VALC CHAR(8);
       34      688    1   DCL 1 VAL REDEF VALC,
       35      689    1          2 B BIT(36),
       36      690    1          2 U0 REDEF B UBIN,
       37      691    1          2 N0 REDEF B SBIN,
       38      692    1          2 TAG REDEF B,
       39      693    1             3 HI_BITS BIT(3),
       40      694    1             3 CONSTRUCTED BIT(1),
       41      695    1             3 TAG UBIN(5) UNAL, 3 * BIT(27),
       42      696    1          2 B2 BIT(36),
       43      697    1          2 N REDEF B2 SBIN,
       44      698    1          2 NU REDEF B2 UBIN,
       45      699    1          2 LO18 REDEF B2, 3 * BIT(18), 3 N UBIN(18) UNAL,
       46      700    1          2 LO27 REDEF B2, 3 * BIT(9), 3 N UBIN(27) UNAL;
       47      701    1   DCL 1 VALU(0:7) REDEF VALC UBIN(9) UNAL;
       48      702    1   DCL 1 VALP(0:8) REDEF VALC UBIN(8) UNAL;
       49      703    1   DCL 1 VAL7 REDEF VALC, 2 * BIT(2), 2 N(0:9) BIT(7) UNAL;
       50      704    1   DCL 1 VALSHF REDEF VALC, 2 * BIT(9), 2 B BIT(63);
       51      705
       52      706    1   DCL I SBIN;
       53      707    1   DCL IU REDEF I UBIN;
       54      708    1   DCL TAG UBIN;
       55      709    1   DCL 1 TAG7 REDEF TAG, 2 * BIT(1), 2 N(0:4) UBIN(7) UNAL;
       56      710    1   DCL SIZE SBIN;
       57      711    1   DCL SIZEU REDEF SIZE UBIN;
       58      712    1   DCL TAGX SBIN;
       59      713    1   DCL LNGX SBIN;
       60      714    1   DCL T1 SBIN;
       61      715    1   DCL ERR SBIN;
       62      716    1   DCL VALX SBIN;
       63      717    1   DCL 1 VALB(0:35) REDEF VALX BIT(1) UNAL;
       64      718    1   DCL VALLIM SBIN;
       65      719
       66      720    1   DCL YEARS(0:42) CONSTANT UBIN INIT      /*      YEARS 1978 - 2020             */
       67      721    1   (0,365,730,1096,1461,1826,2191,2557,2922,3287,3652,4018,4383, /* 1978-1990    */
       68      722    1   4748,5113,5479,5844,6209,7574,6940,7305,7670, /* 1991-1999                    */
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:52   
       69      723    1   8035,8401,8766,9131,9496,9862,10227,10592,10957,11323,11688, /* 2000-2010     */
       70      724    1   12053,12418,12784,13149,13514,13879,14245,14610,14975,15340); /* 2011-2020    */
       71      725    1   DCL MONTHS(0:12) CONSTANT UBIN INIT
       72      726    1    (0,31,60,91,121,152,182,213,244,274,305,335);
       73      727    1   DCL SIGNS(0:5) BIT(36) CONSTANT INIT
       74      728    1    ('0'X,'00000008'X,'000008'X,'0008'X,'08'X,'0'X);
       75      729    1   DCL NSIGNS(0:4) BIT(36) CONSTANT INIT
       76      730    1    ('0'X,'FFFFFFF0'X,'FFFFF0'X,'FFF0'X,'F0'X);
       77      731
       78      732    1   DCL XSP_UTC_OFFSET CHAR(5) STATIC SYMDEF INIT('-0800');
       79      733    1   DCL XSP_UTC_OFFSETN SBIN STATIC SYMDEF INIT(%(-8*24*60*6000));
       80      734        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:53   
       81      735    1   XSP$RECV1: ENTRY (PARM) ALTRET;

    735  2 000003   000000 700200 xent  XSP$RECV1    TSX0  ! X66_AUTO_1
         2 000004   000032 000001                    ZERO    26,1

       82      736
       83      737    1      ERR = 0;

    737  2 000005   200021 450100                    STZ     ERR,,AUTO

       84      738    1      PTRS = PARM.P;

    738  2 000006   200003 470500                    LDP0    @PARM,,AUTO
         2 000007   000100 100500                    MLR     fill='000'O
         2 000010   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
         2 000011   200004 000024                    ADSC9   PTRS,,AUTO               cn=0,n=20

       85      739    1      IF PTRS.VNODE$=ADDR(NIL) THEN PTRS.VNODE$ = PTRS.NODE$;

    739  2 000012   200010 236100                    LDQ     PTRS+4,,AUTO
         2 000013   000000 116000 3                  CMPQ    0
         2 000014   000017 601000 2                  TNZ     s:740

    739  2 000015   200004 236100                    LDQ     PTRS,,AUTO
         2 000016   200010 756100                    STQ     PTRS+4,,AUTO

       86      740    1      SIZE = PARM.MAXX;

    740  2 000017   000014 235100                    LDA     12,,PR0
         2 000020   200015 755100                    STA     SIZE,,AUTO

       87      741    1      IF PARM.PARSED THEN CALL GET_TAG ALTRET(RETALT);

    741  2 000021   000005 236100                    LDQ     5,,PR0
         2 000022   100000 316003                    CANQ    32768,DU
         2 000023   000026 600000 2                  TZE     s:742

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:54   
    741  2 000024   002002 701000 2                  TSX1    GET_TAG
         2 000025   001660 702000 2                  TSX2    RETALT

       88      742    2      IF NODE.PRE.RCV THEN DO;

    742  2 000026   200004 470500                    LDP0    PTRS,,AUTO
         2 000027   000001 236100                    LDQ     1,,PR0
         2 000030   100000 316003                    CANQ    32768,DU
         2 000031   000043 600000 2                  TZE     s:746

       89      743    2         PARM.USR = %XSP_ASN1_RCV_PRE;

    743  2 000032   200003 471500                    LDP1    @PARM,,AUTO
         2 000033   000000 236003                    LDQ     0,DU
         2 000034   100005 552120                    STBQ    5,'20'O,PR1

       90      744    2         CALL FPT.UENTRY$ (PARM) ALTRET (RETALT);

    744  2 000035   200003 630500                    EPPR0   @PARM,,AUTO
         2 000036   200006 473500                    LDP3    PTRS+2,,AUTO
         2 000037   300002 220100                    LDX0    2,,PR3
         2 000040   000001 631400 3                  EPPR1   1
         2 000041   000000 701010                    TSX1    0,X0
         2 000042   001660 702000 2                  TSX2    RETALT

       91      745    2      END;

       92      746    1      TAG = PARM.TAG;

    746  2 000043   200003 470500                    LDP0    @PARM,,AUTO
         2 000044   000013 235100                    LDA     11,,PR0
         2 000045   200014 755100                    STA     TAG,,AUTO

       93      747    1      SIZE = PARM.SIZE;

    747  2 000046   000012 235100                    LDA     10,,PR0
         2 000047   200015 755100                    STA     SIZE,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:55   

       94      748    1      IF TAG=0 OR TAG~=NODE.TAG AND NOT NODE.IMPLICIT

    748  2 000050   200014 236100                    LDQ     TAG,,AUTO
         2 000051   000062 600000 2                  TZE     s:749
         2 000052   200004 471500                    LDP1    PTRS,,AUTO
         2 000053   100000 236100                    LDQ     0,,PR1
         2 000054   777777 376007                    ANQ     -1,DL
         2 000055   200014 116100                    CMPQ    TAG,,AUTO
         2 000056   000222 600000 2                  TZE     s:782
         2 000057   100001 236100                    LDQ     1,,PR1
         2 000060   002000 316003                    CANQ    1024,DU
         2 000061   000222 601000 2                  TNZ     s:782

       95      749    2      THEN IF TAG=0 OR NODE.TYPE~=%XSP_ASN1_CHOICE THEN DO;

    749  2 000062   200014 236100                    LDQ     TAG,,AUTO
         2 000063   000071 600000 2                  TZE     s:750
         2 000064   200004 471500                    LDP1    PTRS,,AUTO
         2 000065   100000 236100                    LDQ     0,,PR1
         2 000066   770000 376003                    ANQ     -4096,DU
         2 000067   400000 116003                    CMPQ    -131072,DU
         2 000070   000110 600000 2                  TZE     s:758

       96      750    2         IF NODE.DEFAULT_EXISTS THEN GOTO RETALT;

    750  2 000071   200004 471500                    LDP1    PTRS,,AUTO
         2 000072   100002 236100                    LDQ     2,,PR1
         2 000073   400000 316007                    CANQ    -131072,DL
         2 000074   001660 601000 2                  TNZ     RETALT

       97      751    2         IF NOT NODE.OPTIONL OR FPT.CONDITION(NODE.CONDITION)

    751  2 000075   100001 234100                    SZN     1,,PR1
         2 000076   001657 605000 2                  TPL     ERR_WRONG_TAG
         2 000077   100000 236100                    LDQ     0,,PR1
         2 000100   000022 772000                    QRL     18
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:56   
         2 000101   000177 376007                    ANQ     127,DL
         2 000102   200006 473500                    LDP3    PTRS+2,,AUTO
         2 000103   000000 066506                    CMPB    filb='0'B
         2 000104   300010 000001                    BDSC    8,Q,PR3                  by=0,bit=0,n=1
         2 000105   000002 000022 3                  BDSC    2                        by=0,bit=0,n=18
         2 000106   001657 601000 2                  TNZ     ERR_WRONG_TAG

       98      752    2         THEN GOTO ERR_WRONG_TAG;
       99      753    2         GOTO RETALT;

    753  2 000107   001660 710000 2                  TRA     RETALT

      100      754    2      END;
      101      755        /* We have a CHOICE node - find the choice that matches. */
      102      756
      103      757    2      ELSE DO;

      104      758    2         LNGX = PARM.NXTX;

    758  2 000110   000011 235100                    LDA     9,,PR0
         2 000111   200017 755100                    STA     LNGX,,AUTO

      105      759    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);

    759  2 000112   100000 236100                    LDQ     0,,PR1
         2 000113   007400 316003                    CANQ    3840,DU
         2 000114   000117 600000 2                  TZE     s:760

    759  2 000115   200004 236100                    LDQ     PTRS,,AUTO
         2 000116   000004 756100                    STQ     4,,PR0

      106      760    2         IF NODE.ORDERED THEN I = TAG-NODE.SUBND$(0)->NODE.TAG;

    760  2 000117   100001 430100                    FSZN    1,,PR1
         2 000120   000131 605000 2                  TPL     s:761

    760  2 000121   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:57   
         2 000122   300000 236100                    LDQ     0,,PR3
         2 000123   777777 376007                    ANQ     -1,DL
         2 000124   200030 756100                    STQ     VALLIM+5,,AUTO
         2 000125   200014 236100                    LDQ     TAG,,AUTO
         2 000126   200030 136100                    SBLQ    VALLIM+5,,AUTO
         2 000127   200013 756100                    STQ     I,,AUTO
         2 000130   000204 710000 2                  TRA     s:774

      107      761    3         ELSE DO I=0 TO NODE.NSUBNDS-1;

    761  2 000131   200013 450100                    STZ     I,,AUTO
         2 000132   000177 710000 2                  TRA     s:773+1

      108      762    3            IF TAG=NODE.SUBND$(I)->NODE.TAG THEN EXIT;

    762  2 000133   200004 470500                    LDP0    PTRS,,AUTO
         2 000134   200013 720100                    LXL0    I,,AUTO
         2 000135   000003 471510                    LDP1    3,X0,PR0
         2 000136   100000 236100                    LDQ     0,,PR1
         2 000137   777777 376007                    ANQ     -1,DL
         2 000140   200014 116100                    CMPQ    TAG,,AUTO
         2 000141   000204 600000 2                  TZE     s:774

      109      763    4            IF NODE.SUBND$(I)->NODE.TYPE=%XSP_ASN1_CHOICE THEN DO;

    763  2 000142   100000 236100                    LDQ     0,,PR1
         2 000143   770000 376003                    ANQ     -4096,DU
         2 000144   400000 116003                    CMPQ    -131072,DU
         2 000145   000176 601000 2                  TNZ     s:773

      110      764    4               PARM.P.NODE$ = NODE.SUBND$(I);

    764  2 000146   000003 236110                    LDQ     3,X0,PR0
         2 000147   200003 473500                    LDP3    @PARM,,AUTO
         2 000150   300000 756100                    STQ     0,,PR3

      111      765    5               CALL XSP$RECV1 (PARM) WHENRETURN DO;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:58   

    765  2 000151   200003 630500                    EPPR0   @PARM,,AUTO
         2 000152   000001 631400 3                  EPPR1   1
         2 000153   000003 701000 2                  TSX1    s:735
         2 000154   000166 702000 2                  TSX2    s:768

      112      766    5                  IF PARM.PARSED OR PARM.NXTX>LNGX THEN RETURN;

    766  2 000155   200003 470500                    LDP0    @PARM,,AUTO
         2 000156   000005 236100                    LDQ     5,,PR0
         2 000157   100000 316003                    CANQ    32768,DU
         2 000160   000164 601000 2                  TNZ     s:766+7
         2 000161   000011 236100                    LDQ     9,,PR0
         2 000162   200017 116100                    CMPQ    LNGX,,AUTO
         2 000163   000165 604400 2                  TMOZ    s:766+8

    766  2 000164   000000 702200 xent               TSX2  ! X66_ARET
         2 000165   000176 710000 2                  TRA     s:773

      113      767    5               END; WHENALTRETURN DO;

      114      768    5                  IF PARM.ERR~=%XSP_ASN1_E$WRONG_TAG OR PARM.NXTX>LNGX

    768  2 000166   200003 470500                    LDP0    @PARM,,AUTO
         2 000167   000010 235100                    LDA     8,,PR0
         2 000170   000001 115007                    CMPA    1,DL
         2 000171   001660 601000 2                  TNZ     RETALT
         2 000172   000011 236100                    LDQ     9,,PR0
         2 000173   200017 116100                    CMPQ    LNGX,,AUTO
         2 000174   001660 605400 2                  TPNZ    RETALT

      115      769    5                  THEN GOTO RETALT;
      116      770    5                  PARM.ERR = 0;            /* Otherwise, keep looking            */

    770  2 000175   000010 450100                    STZ     8,,PR0

      117      771    5               END;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:59   

      118      772    4            END;

      119      773    3         END;

    773  2 000176   200013 054100                    AOS     I,,AUTO
         2 000177   200004 470500                    LDP0    PTRS,,AUTO
         2 000200   000001 236100                    LDQ     1,,PR0
         2 000201   000077 376007                    ANQ     63,DL
         2 000202   200013 116100                    CMPQ    I,,AUTO
         2 000203   000133 605400 2                  TPNZ    s:762

      120      774    2         IF I>=NODE.NSUBNDS THEN GOTO ERR_WRONG_TAG;

    774  2 000204   200004 470500                    LDP0    PTRS,,AUTO
         2 000205   000001 236100                    LDQ     1,,PR0
         2 000206   000077 376007                    ANQ     63,DL
         2 000207   200013 116100                    CMPQ    I,,AUTO
         2 000210   001657 604400 2                  TMOZ    ERR_WRONG_TAG

      121      775    2         PARM.P.NODE$ = NODE.SUBND$(I);

    775  2 000211   200013 720100                    LXL0    I,,AUTO
         2 000212   000003 236110                    LDQ     3,X0,PR0
         2 000213   200003 471500                    LDP1    @PARM,,AUTO
         2 000214   100000 756100                    STQ     0,,PR1

      122      776    2         CALL XSP$RECV1(PARM) ALTRET(RETALT);

    776  2 000215   200003 630500                    EPPR0   @PARM,,AUTO
         2 000216   000001 631400 3                  EPPR1   1
         2 000217   000003 701000 2                  TSX1    s:735
         2 000220   001660 702000 2                  TSX2    RETALT

      123      777    2         RETURN;

    777  2 000221   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:60   

      124      778    2      END;
      125      779        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:61   
      126      780        /* The TAG matches this node - process accordingly */
      127      781
      128      782    1      IF VNODE.FPTID>0 THEN FPT.RESULT(VNODE.FPTID) = '1'B;

    782  2 000222   200010 473500                    LDP3    PTRS+4,,AUTO
         2 000223   300001 236100                    LDQ     1,,PR3
         2 000224   017700 316007                    CANQ    8128,DL
         2 000225   000235 600000 2                  TZE     s:783

    782  2 000226   300001 236100                    LDQ     1,,PR3
         2 000227   000006 772000                    QRL     6
         2 000230   000177 376007                    ANQ     127,DL
         2 000231   200006 474500                    LDP4    PTRS+2,,AUTO
         2 000232   003106 060400                    CSL     bolr='003'O
         2 000233   000003 000001 3                  BDSC    3                        by=0,bit=0,n=1
         2 000234   400006 000001                    BDSC    6,Q,PR4                  by=0,bit=0,n=1

      129      783    1      IF NODE.CONSTRUCTED AND NOT PARM.TAGC THEN GOTO ERR_NOT_STR;

    783  2 000235   100000 236100                    LDQ     0,,PR1
         2 000236   000200 316003                    CANQ    128,DU
         2 000237   000243 600000 2                  TZE     s:784
         2 000240   000005 236100                    LDQ     5,,PR0
         2 000241   200000 316003                    CANQ    65536,DU
         2 000242   001654 600000 2                  TZE     ERR_NOT_STR

      130      784    1      I = SIZE-PARM.NXTX;

    784  2 000243   200015 236100                    LDQ     SIZE,,AUTO
         2 000244   000011 136100                    SBLQ    9,,PR0
         2 000245   200013 756100                    STQ     I,,AUTO

      131      785    2      DO CASE (NODE.TYPE);

    785  2 000246   100000 236100                    LDQ     0,,PR1
         2 000247   000036 772000                    QRL     30
         2 000250   000062 116007                    CMPQ    50,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:62   
         2 000251   000253 602006 2                  TNC     s:785+5,QL
         2 000252   001542 710000 2                  TRA     s:1020
         2 000253   001542 710000 2                  TRA     s:1020
         2 000254   001043 710000 2                  TRA     s:903
         2 000255   000624 710000 2                  TRA     s:857
         2 000256   000725 710000 2                  TRA     s:876
         2 000257   001542 710000 2                  TRA     s:1020
         2 000260   001070 710000 2                  TRA     s:912
         2 000261   001110 710000 2                  TRA     s:917
         2 000262   001542 710000 2                  TRA     s:1020
         2 000263   001542 710000 2                  TRA     s:1020
         2 000264   001542 710000 2                  TRA     s:1020
         2 000265   001542 710000 2                  TRA     s:1020
         2 000266   001542 710000 2                  TRA     s:1020
         2 000267   001542 710000 2                  TRA     s:1020
         2 000270   001542 710000 2                  TRA     s:1020
         2 000271   001542 710000 2                  TRA     s:1020
         2 000272   001542 710000 2                  TRA     s:1020
         2 000273   000335 710000 2                  TRA     s:787
         2 000274   000414 710000 2                  TRA     s:798
         2 000275   001542 710000 2                  TRA     s:1020
         2 000276   001542 710000 2                  TRA     s:1020
         2 000277   001542 710000 2                  TRA     s:1020
         2 000300   001542 710000 2                  TRA     s:1020
         2 000301   001542 710000 2                  TRA     s:1020
         2 000302   001245 710000 2                  TRA     s:957
         2 000303   001245 710000 2                  TRA     s:957
         2 000304   001542 710000 2                  TRA     s:1020
         2 000305   001542 710000 2                  TRA     s:1020
         2 000306   001542 710000 2                  TRA     s:1020
         2 000307   001542 710000 2                  TRA     s:1020
         2 000310   001542 710000 2                  TRA     s:1020
         2 000311   001542 710000 2                  TRA     s:1020
         2 000312   001542 710000 2                  TRA     s:1020
         2 000313   000551 710000 2                  TRA     s:841
         2 000314   001542 710000 2                  TRA     s:1020
         2 000315   001542 710000 2                  TRA     s:1020
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:63   
         2 000316   001542 710000 2                  TRA     s:1020
         2 000317   001542 710000 2                  TRA     s:1020
         2 000320   001542 710000 2                  TRA     s:1020
         2 000321   001542 710000 2                  TRA     s:1020
         2 000322   001542 710000 2                  TRA     s:1020
         2 000323   001542 710000 2                  TRA     s:1020
         2 000324   001542 710000 2                  TRA     s:1020
         2 000325   001542 710000 2                  TRA     s:1020
         2 000326   001542 710000 2                  TRA     s:1020
         2 000327   001542 710000 2                  TRA     s:1020
         2 000330   001542 710000 2                  TRA     s:1020
         2 000331   001542 710000 2                  TRA     s:1020
         2 000332   001542 710000 2                  TRA     s:1020
         2 000333   000515 710000 2                  TRA     s:823
         2 000334   000515 710000 2                  TRA     s:823

      132      786    2      CASE (%XSP_ASN1_SEQUENCE);

      133      787    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);

    787  2 000335   100000 236100                    LDQ     0,,PR1
         2 000336   007400 316003                    CANQ    3840,DU
         2 000337   000342 600000 2                  TZE     s:788

    787  2 000340   200004 236100                    LDQ     PTRS,,AUTO
         2 000341   000004 756100                    STQ     4,,PR0

      134      788    2         IF NOT NODE.IMPLICIT THEN PARM.PARSED = '1'B;

    788  2 000342   100001 236100                    LDQ     1,,PR1
         2 000343   002000 316003                    CANQ    1024,DU
         2 000344   000347 601000 2                  TNZ     s:789

    788  2 000345   100000 236003                    LDQ     32768,DU
         2 000346   000005 256100                    ORSQ    5,,PR0

      135      789    3         DO I=0 TO NODE.NSUBNDS-1;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:64   

    789  2 000347   200013 450100                    STZ     I,,AUTO
         2 000350   000406 710000 2                  TRA     s:794+1

      136      790    3            IF PARM.PARSED THEN CALL GET_TAG ALTRET(RETALT);

    790  2 000351   200003 470500                    LDP0    @PARM,,AUTO
         2 000352   000005 236100                    LDQ     5,,PR0
         2 000353   100000 316003                    CANQ    32768,DU
         2 000354   000357 600000 2                  TZE     s:791

    790  2 000355   002002 701000 2                  TSX1    GET_TAG
         2 000356   001660 702000 2                  TSX2    RETALT

      137      791    3            PARM.P.NODE$ = NODE.SUBND$(I);

    791  2 000357   200004 470500                    LDP0    PTRS,,AUTO
         2 000360   200013 720100                    LXL0    I,,AUTO
         2 000361   000003 236110                    LDQ     3,X0,PR0
         2 000362   200003 471500                    LDP1    @PARM,,AUTO
         2 000363   100000 756100                    STQ     0,,PR1

      138      792    3            IF NODE.IMPLICIT THEN PARM.TAG = PARM.P.NODE$->NODE.TAG-NODE.TAG+TAG-I;

    792  2 000364   000001 236100                    LDQ     1,,PR0
         2 000365   002000 316003                    CANQ    1024,DU
         2 000366   000401 600000 2                  TZE     s:793

    792  2 000367   100000 473500                    LDP3    0,,PR1
         2 000370   000000 236100                    LDQ     0,,PR0
         2 000371   777777 376007                    ANQ     -1,DL
         2 000372   200030 756100                    STQ     VALLIM+5,,AUTO
         2 000373   300000 236100                    LDQ     0,,PR3
         2 000374   777777 376007                    ANQ     -1,DL
         2 000375   200030 136100                    SBLQ    VALLIM+5,,AUTO
         2 000376   200014 036100                    ADLQ    TAG,,AUTO
         2 000377   200013 136100                    SBLQ    I,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:65   
         2 000400   100013 756100                    STQ     11,,PR1

      139      793    3            CALL XSP$RECV1 (PARM) ALTRET(RETALT);

    793  2 000401   200003 630500                    EPPR0   @PARM,,AUTO
         2 000402   000001 631400 3                  EPPR1   1
         2 000403   000003 701000 2                  TSX1    s:735
         2 000404   001660 702000 2                  TSX2    RETALT

      140      794    3         END;

    794  2 000405   200013 054100                    AOS     I,,AUTO
         2 000406   200004 470500                    LDP0    PTRS,,AUTO
         2 000407   000001 236100                    LDQ     1,,PR0
         2 000410   000077 376007                    ANQ     63,DL
         2 000411   200013 116100                    CMPQ    I,,AUTO
         2 000412   000351 605400 2                  TPNZ    s:790

      141      795    2         GOTO END_CONSTR;

    795  2 000413   000570 710000 2                  TRA     END_CONSTR

      142      796        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:66   
      143      797    2      CASE (%XSP_ASN1_SET);

      144      798    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);

    798  2 000414   100000 236100                    LDQ     0,,PR1
         2 000415   007400 316003                    CANQ    3840,DU
         2 000416   000421 600000 2                  TZE     s:799

    798  2 000417   200004 236100                    LDQ     PTRS,,AUTO
         2 000420   000004 756100                    STQ     4,,PR0

      145      799    2         VALB = '0'B;

    799  2 000421   200022 450100                    STZ     VALX,,AUTO

      146      800    2         VALLIM = 0;                       /* (VALB(36:71), just in case )       */

    800  2 000422   200023 450100                    STZ     VALLIM,,AUTO

      147      801    3         DO WHILE '1'B;

      148      802    3            CALL GET_TAG ALTRET(RETALT);

    802  2 000423   002002 701000 2                  TSX1    GET_TAG
         2 000424   001660 702000 2                  TSX2    RETALT

      149      803    3            IF TAG=0 THEN EXIT;

    803  2 000425   200014 235100                    LDA     TAG,,AUTO
         2 000426   000466 600000 2                  TZE     s:814

      150      804    3            I = -1;

    804  2 000427   000001 336007                    LCQ     1,DL
         2 000430   200013 756100                    STQ     I,,AUTO

      151      805    4            DO WHILE '1'B;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:67   

      152      806    4               I = I+1;

    806  2 000431   200013 054100                    AOS     I,,AUTO

      153      807    4               IF I=NODE.NSUBNDS THEN GOTO ERR_WRONG_TAG;

    807  2 000432   200004 470500                    LDP0    PTRS,,AUTO
         2 000433   000001 236100                    LDQ     1,,PR0
         2 000434   000077 376007                    ANQ     63,DL
         2 000435   200013 116100                    CMPQ    I,,AUTO
         2 000436   001657 600000 2                  TZE     ERR_WRONG_TAG

      154      808    4               IF NODE.SUBND$(I)->NODE.TAG=TAG AND NOT VALB(IU) THEN EXIT;

    808  2 000437   200013 720100                    LXL0    I,,AUTO
         2 000440   000003 471510                    LDP1    3,X0,PR0
         2 000441   100000 236100                    LDQ     0,,PR1
         2 000442   777777 376007                    ANQ     -1,DL
         2 000443   200014 116100                    CMPQ    TAG,,AUTO
         2 000444   000452 601000 2                  TNZ     s:809
         2 000445   200013 235100                    LDA     I,,AUTO
         2 000446   000000 066505                    CMPB    filb='0'B
         2 000447   200022 000001                    BDSC    VALX,A,AUTO              by=0,bit=0,n=1
         2 000450   000002 000022 3                  BDSC    2                        by=0,bit=0,n=18
         2 000451   000453 600000 2                  TZE     s:810

      155      809    4            END;

    809  2 000452   000431 710000 2                  TRA     s:806

      156      810    3            PARM.P.NODE$ = NODE.SUBND$(I);

    810  2 000453   000003 236110                    LDQ     3,X0,PR0
         2 000454   200003 473500                    LDP3    @PARM,,AUTO
         2 000455   300000 756100                    STQ     0,,PR3

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:68   
      157      811    3            VALB(IU) = '1'B;

    811  2 000456   003105 060400                    CSL     bolr='003'O
         2 000457   000003 000001 3                  BDSC    3                        by=0,bit=0,n=1
         2 000460   200022 000001                    BDSC    VALX,A,AUTO              by=0,bit=0,n=1

      158      812    3            CALL XSP$RECV1 (PARM) ALTRET(RETALT);

    812  2 000461   200003 630500                    EPPR0   @PARM,,AUTO
         2 000462   000001 631400 3                  EPPR1   1
         2 000463   000003 701000 2                  TSX1    s:735
         2 000464   001660 702000 2                  TSX2    RETALT

      159      813    3         END;

    813  2 000465   000423 710000 2                  TRA     s:802

      160      814    3         DO I=0 TO NODE.NSUBNDS-1;

    814  2 000466   200013 450100                    STZ     I,,AUTO
         2 000467   000507 710000 2                  TRA     s:819+1

      161      815    4            IF NOT VALB(IU) THEN DO;

    815  2 000470   200013 235100                    LDA     I,,AUTO
         2 000471   000000 066505                    CMPB    filb='0'B
         2 000472   200022 000001                    BDSC    VALX,A,AUTO              by=0,bit=0,n=1
         2 000473   000002 000022 3                  BDSC    2                        by=0,bit=0,n=18
         2 000474   000506 601000 2                  TNZ     s:819

      162      816    4               PARM.P.NODE$ = NODE.SUBND$(I);

    816  2 000475   200004 470500                    LDP0    PTRS,,AUTO
         2 000476   200013 720100                    LXL0    I,,AUTO
         2 000477   000003 236110                    LDQ     3,X0,PR0
         2 000500   200003 471500                    LDP1    @PARM,,AUTO
         2 000501   100000 756100                    STQ     0,,PR1
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:69   

      163      817    4               CALL XSP$RECV1 (PARM) ALTRET(RETALT);

    817  2 000502   200003 630500                    EPPR0   @PARM,,AUTO
         2 000503   000001 631400 3                  EPPR1   1
         2 000504   000003 701000 2                  TSX1    s:735
         2 000505   001660 702000 2                  TSX2    RETALT

      164      818    4            END;

      165      819    3         END;

    819  2 000506   200013 054100                    AOS     I,,AUTO
         2 000507   200004 470500                    LDP0    PTRS,,AUTO
         2 000510   000001 236100                    LDQ     1,,PR0
         2 000511   000077 376007                    ANQ     63,DL
         2 000512   200013 116100                    CMPQ    I,,AUTO
         2 000513   000470 605400 2                  TPNZ    s:815

      166      820    2         GOTO END_CONSTR;

    820  2 000514   000570 710000 2                  TRA     END_CONSTR

      167      821        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:70   
      168      822    2      CASE (%XSP_ASN1_SET_OF, %XSP_ASN1_SEQUENCE_OF);

      169      823    2         VALX = 0;

    823  2 000515   200022 450100                    STZ     VALX,,AUTO

      170      824    3         DO WHILE '1'B;

      171      825    3            PARM.P.NODE$ = NODE.SUBND$(0);

    825  2 000516   200004 470500                    LDP0    PTRS,,AUTO
         2 000517   000003 236100                    LDQ     3,,PR0
         2 000520   200003 471500                    LDP1    @PARM,,AUTO
         2 000521   100000 756100                    STQ     0,,PR1

      172      826    3            CALL GET_TAG ALTRET(RETALT);

    826  2 000522   002002 701000 2                  TSX1    GET_TAG
         2 000523   001660 702000 2                  TSX2    RETALT

      173      827    3            IF TAG=0 THEN EXIT;

    827  2 000524   200014 235100                    LDA     TAG,,AUTO
         2 000525   000534 600000 2                  TZE     s:831

      174      828    3            CALL XSP$RECV1 (PARM) ALTRET(RETALT);

    828  2 000526   200003 630500                    EPPR0   @PARM,,AUTO
         2 000527   000001 631400 3                  EPPR1   1
         2 000530   000003 701000 2                  TSX1    s:735
         2 000531   001660 702000 2                  TSX2    RETALT

      175      829    3            VALX = VALX+1;

    829  2 000532   200022 054100                    AOS     VALX,,AUTO

      176      830    3         END;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:71   

    830  2 000533   000516 710000 2                  TRA     s:825

      177      831    3         IF NODE.CP6TYP~=0 THEN DO;

    831  2 000534   200004 470500                    LDP0    PTRS,,AUTO
         2 000535   000000 236100                    LDQ     0,,PR0
         2 000536   007400 316003                    CANQ    3840,DU
         2 000537   000550 600000 2                  TZE     s:837

      178      832    3            VAL.N = VALX;

    832  2 000540   200022 235100                    LDA     VALX,,AUTO
         2 000541   200012 755100                    STA     VALC+1,,AUTO

      179      833    3            VALX = SIZE;              /* Preserve SIZE for check at END_CONSTR   */

    833  2 000542   200015 236100                    LDQ     SIZE,,AUTO
         2 000543   200022 756100                    STQ     VALX,,AUTO

      180      834    3            CALL PUTVALN;

    834  2 000544   002255 701000 2                  TSX1    PUTVALN
         2 000545   000000 011000                    NOP     0

      181      835    3            SIZE = VALX;

    835  2 000546   200022 235100                    LDA     VALX,,AUTO
         2 000547   200015 755100                    STA     SIZE,,AUTO

      182      836    3         END;

      183      837    2         GOTO END_CONSTR;

    837  2 000550   000570 710000 2                  TRA     END_CONSTR

      184      838        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:72   
      185      839    2      CASE (%XSP_ASN1_CHOICE);

      186      840        /* If we get here, it must be just a tag node (1 subnode) */
      187      841    2         CALL GET_TAG ALTRET(RETALT);

    841  2 000551   002002 701000 2                  TSX1    GET_TAG
         2 000552   001660 702000 2                  TSX2    RETALT

      188      842    2         PARM.P.NODE$ = NODE.SUBND$(0);

    842  2 000553   200004 470500                    LDP0    PTRS,,AUTO
         2 000554   000003 236100                    LDQ     3,,PR0
         2 000555   200003 471500                    LDP1    @PARM,,AUTO
         2 000556   100000 756100                    STQ     0,,PR1

      189      843    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);

    843  2 000557   000000 236100                    LDQ     0,,PR0
         2 000560   007400 316003                    CANQ    3840,DU
         2 000561   000564 600000 2                  TZE     s:844

    843  2 000562   200004 236100                    LDQ     PTRS,,AUTO
         2 000563   100004 756100                    STQ     4,,PR1

      190      844    2         CALL XSP$RECV1 (PARM) ALTRET(RETALT);

    844  2 000564   200003 630500                    EPPR0   @PARM,,AUTO
         2 000565   000001 631400 3                  EPPR1   1
         2 000566   000003 701000 2                  TSX1    s:735
         2 000567   001660 702000 2                  TSX2    RETALT

    843  2 000570                       END_CONSTR   null
      191      845    2   END_CONSTR:;
      192      846    2         IF PARM.P.VNODE$~=ADDR(NIL)

    846  2 000570   200003 470500                    LDP0    @PARM,,AUTO
         2 000571   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:73   
         2 000572   000000 116000 3                  CMPQ    0
         2 000573   000603 600000 2                  TZE     s:849

      193      847    2         THEN IF PTRS.VNODE$~=PTRS.NODE$ THEN PARM.P.VNODE$ = PTRS.VNODE$;

    847  2 000574   200010 236100                    LDQ     PTRS+4,,AUTO
         2 000575   200004 116100                    CMPQ    PTRS,,AUTO
         2 000576   000601 600000 2                  TZE     s:848

    847  2 000577   000004 756100                    STQ     4,,PR0
         2 000600   000603 710000 2                  TRA     s:849

      194      848    2         ELSE PARM.P.VNODE$ = ADDR(NIL);

    848  2 000601   000000 236000 3                  LDQ     0
         2 000602   000004 756100                    STQ     4,,PR0

      195      849    3         IF SIZE~=PARM.NXTX THEN DO;

    849  2 000603   200015 236100                    LDQ     SIZE,,AUTO
         2 000604   000011 116100                    CMPQ    9,,PR0
         2 000605   001630 600000 2                  TZE     s:1040

      196      850    3            IF SIZE~=65535 THEN GOTO ERR_STR_SIZE; /* Not indefinite length      */

    850  2 000606   177777 116007                    CMPQ    65535,DL
         2 000607   001653 601000 2                  TNZ     ERR_STR_SIZE

      197      851    3            IF PARM.TAG=0 AND PARM.SIZE=0 THEN EXIT; /* Indefinite terminated    */

    851  2 000610   000013 235100                    LDA     11,,PR0
         2 000611   000614 601000 2                  TNZ     s:852
         2 000612   000012 235100                    LDA     10,,PR0
         2 000613   000623 600000 2                  TZE     s:854

      198      852    3            IF PARM.PARSED THEN CALL GET_TAG ALTRET(RETALT);

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:74   
    852  2 000614   000005 236100                    LDQ     5,,PR0
         2 000615   100000 316003                    CANQ    32768,DU
         2 000616   000621 600000 2                  TZE     s:853

    852  2 000617   002002 701000 2                  TSX1    GET_TAG
         2 000620   001660 702000 2                  TSX2    RETALT

      199      853    3            IF TAG~=0 THEN GOTO ERR_STR_SIZE;

    853  2 000621   200014 235100                    LDA     TAG,,AUTO
         2 000622   001653 601000 2                  TNZ     ERR_STR_SIZE

      200      854    3         END;

    854  2 000623   001630 710000 2                  TRA     s:1040

      201      855        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:75   
      202      856    2      CASE (%XSP_ASN1_INTEGER);

      203      857    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;

    857  2 000624   000005 236100                    LDQ     5,,PR0
         2 000625   200000 316003                    CANQ    65536,DU
         2 000626   001655 601000 2                  TNZ     ERR_NOT_PRIM

      204      858    2         IF I>5 THEN GOTO ERR_BIG_VALUE;

    858  2 000627   200013 235100                    LDA     I,,AUTO
         2 000630   000005 115007                    CMPA    5,DL
         2 000631   001651 605400 2                  TPNZ    ERR_BIG_VALUE

      205      859    2         VAL = '0'B;

    859  2 000632   200011 450100                    STZ     VALC,,AUTO
         2 000633   200012 450100                    STZ     VALC+1,,AUTO

      206      860    2         SUBSTR(VALC,8-I,I) = %CHRS,PARM.NXTX,I);

    860  2 000634   000011 235100                    LDA     9,,PR0
         2 000635   200013 336100                    LCQ     I,,AUTO
         2 000636   200005 474500                    LDP4    PTRS+1,,AUTO
         2 000637   200013 720100                    LXL0    I,,AUTO
         2 000640   040146 100545                    MLR     fill='040'O
         2 000641   400000 000010                    ADSC9   0,A,PR4                  cn=0,n=*X0
         2 000642   200013 000010                    ADSC9   I,Q,AUTO                 cn=0,n=*X0

      207      861    2         PARM.NXTX = PARM.NXTX+I;

    861  2 000643   000011 236100                    LDQ     9,,PR0
         2 000644   200013 036100                    ADLQ    I,,AUTO
         2 000645   000011 756100                    STQ     9,,PR0

      208      862    2         IF VAL.N0>7 AND VAL.N0<248 THEN GOTO ERR_BIG_VALUE;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:76   
    862  2 000646   200011 235100                    LDA     VALC,,AUTO
         2 000647   000007 115007                    CMPA    7,DL
         2 000650   000653 604400 2                  TMOZ    s:863
         2 000651   000370 115007                    CMPA    248,DL
         2 000652   001651 604000 2                  TMI     ERR_BIG_VALUE

      209      863    2         IF I<2 THEN;

    863  2 000653   200013 235100                    LDA     I,,AUTO
         2 000654   000002 115007                    CMPA    2,DL
         2 000655   000710 604000 2                  TMI     s:871

      210      864    2         ELSE IF I=2 THEN VAL.NU = (VAL.NU+VALP(8))/2;

    864  2 000656   000665 601000 2                  TNZ     s:866

    864  2 000657   200012 236100                    LDQ     VALC+1,,AUTO
         2 000660   000377 376007                    ANQ     255,DL
         2 000661   200012 036100                    ADLQ    VALC+1,,AUTO
         2 000662   000001 772000                    QRL     1
         2 000663   200012 756100                    STQ     VALC+1,,AUTO
         2 000664   000710 710000 2                  TRA     s:871

      211      865    3         ELSE DO;

      212      866    3            VAL.NU = (VAL.NU+VALP(8))/2;

    866  2 000665   200012 236100                    LDQ     VALC+1,,AUTO
         2 000666   000377 376007                    ANQ     255,DL
         2 000667   200012 036100                    ADLQ    VALC+1,,AUTO
         2 000670   000001 772000                    QRL     1
         2 000671   200012 756100                    STQ     VALC+1,,AUTO

      213      867    3            VAL.NU = (VAL.NU+MOD(VAL.NU,256*256))/2;

    867  2 000672   177777 376007                    ANQ     65535,DL
         2 000673   200012 036100                    ADLQ    VALC+1,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:77   
         2 000674   000001 772000                    QRL     1
         2 000675   200012 756100                    STQ     VALC+1,,AUTO

      214      868    3            VAL.NU = (VAL.NU+MOD(VAL.NU,256*256*256))/2;

    868  2 000676   000004 376000 3                  ANQ     4
         2 000677   200012 036100                    ADLQ    VALC+1,,AUTO
         2 000700   000001 772000                    QRL     1
         2 000701   200012 756100                    STQ     VALC+1,,AUTO

      215      869    3            IF I=5 THEN VAL.NU = VAL.NU+VAL.N0*%BITBIN('100000000'X);

    869  2 000702   000005 115007                    CMPA    5,DL
         2 000703   000710 601000 2                  TNZ     s:871

    869  2 000704   200011 236100                    LDQ     VALC,,AUTO
         2 000705   000040 736000                    QLS     32
         2 000706   200012 036100                    ADLQ    VALC+1,,AUTO
         2 000707   200012 756100                    STQ     VALC+1,,AUTO

      216      870    3         END;

      217      871    2         IF VAL.B2&SIGNS(I) THEN VAL.B2 = VAL.B2|NSIGNS(I);

    871  2 000710   200012 236100                    LDQ     VALC+1,,AUTO
         2 000711   000070 376010 0                  ANQ     SIGNS,X0
         2 000712   000716 600000 2                  TZE     s:872

    871  2 000713   200012 236100                    LDQ     VALC+1,,AUTO
         2 000714   000076 276010 0                  ORQ     NSIGNS,X0
         2 000715   200012 756100                    STQ     VALC+1,,AUTO

      218      872    2         IF VAL.N<0 THEN VAL.N0 = -1;

    872  2 000716   200012 236100                    LDQ     VALC+1,,AUTO
         2 000717   000722 605000 2                  TPL     s:873

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:78   
    872  2 000720   000001 335007                    LCA     1,DL
         2 000721   200011 755100                    STA     VALC,,AUTO

      219      873    2         CALL PUTVALN;

    873  2 000722   002255 701000 2                  TSX1    PUTVALN
         2 000723   000000 011000                    NOP     0
         2 000724   001630 710000 2                  TRA     s:1040

      220      874        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:79   
      221      875    2      CASE (%XSP_ASN1_BIT_STRING);

      222      876    3         IF PARM.TAGC THEN DO;

    876  2 000725   000005 236100                    LDQ     5,,PR0
         2 000726   200000 316003                    CANQ    65536,DU
         2 000727   000742 600000 2                  TZE     s:881

      223      877    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);

    877  2 000730   200003 630500                    EPPR0   @PARM,,AUTO
         2 000731   000001 631400 3                  EPPR1   1
         2 000732   002737 701000 2                  TSX1    s:1272
         2 000733   001660 702000 2                  TSX2    RETALT

      224      878    3            I = PARM.SIZE-PARM.NXTX;

    878  2 000734   200003 470500                    LDP0    @PARM,,AUTO
         2 000735   000012 236100                    LDQ     10,,PR0
         2 000736   000011 136100                    SBLQ    9,,PR0
         2 000737   200013 756100                    STQ     I,,AUTO

      225      879    3            PARM.SIZE = PARM.TAG;

    879  2 000740   000013 235100                    LDA     11,,PR0
         2 000741   000012 755100                    STA     10,,PR0

      226      880    3         END;

      227      881    2         IF I>8 THEN GOTO ERR_BIG_VALUE;

    881  2 000742   200013 235100                    LDA     I,,AUTO
         2 000743   000010 115007                    CMPA    8,DL
         2 000744   001651 605400 2                  TPNZ    ERR_BIG_VALUE

      228      882    2         VAL = '0'B;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:80   
    882  2 000745   200011 450100                    STZ     VALC,,AUTO
         2 000746   200012 450100                    STZ     VALC+1,,AUTO

      229      883    2         SUBSTR(VALC,0,I) = %CHRS,PARM.NXTX,I);

    883  2 000747   000011 235100                    LDA     9,,PR0
         2 000750   200005 471500                    LDP1    PTRS+1,,AUTO
         2 000751   200013 720100                    LXL0    I,,AUTO
         2 000752   040140 100545                    MLR     fill='040'O
         2 000753   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 000754   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=*X0

      230      884    2         PARM.NXTX = PARM.SIZE;

    884  2 000755   000012 235100                    LDA     10,,PR0
         2 000756   000011 755100                    STA     9,,PR0

      231      885    2         T1 = VALU(0);

    885  2 000757   200011 236100                    LDQ     VALC,,AUTO
         2 000760   000033 772000                    QRL     27
         2 000761   200020 756100                    STQ     T1,,AUTO

      232      886    2         IF T1>7 THEN GOTO ERR_BAD_VALUE;

    886  2 000762   000007 116007                    CMPQ    7,DL
         2 000763   001652 605400 2                  TPNZ    ERR_BAD_VALUE

      233      887    2         I = 8*I-T1-8;

    887  2 000764   200013 336100                    LCQ     I,,AUTO
         2 000765   000003 736000                    QLS     3
         2 000766   200020 036100                    ADLQ    T1,,AUTO
         2 000767   000005 676000 3                  ERQ     5
         2 000770   000007 136007                    SBLQ    7,DL
         2 000771   200013 756100                    STQ     I,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:81   
      234      888    2         VAL.U0 = VAL.U0*1024;

    888  2 000772   200011 235100                    LDA     VALC,,AUTO
         2 000773   000012 735000                    ALS     10
         2 000774   200011 755100                    STA     VALC,,AUTO

      235      889    3         IF I>8 THEN DO;

    889  2 000775   000010 116007                    CMPQ    8,DL
         2 000776   001040 604400 2                  TMOZ    s:900

      236      890    3            VAL.U0 = VAL.U0+MOD(VAL.U0,512*512*512);

    890  2 000777   200011 236100                    LDQ     VALC,,AUTO
         2 001000   000006 376000 3                  ANQ     6
         2 001001   200011 036100                    ADLQ    VALC,,AUTO
         2 001002   200011 756100                    STQ     VALC,,AUTO

      237      891    3            IF I<17 THEN EXIT;

    891  2 001003   200013 235100                    LDA     I,,AUTO
         2 001004   000021 115007                    CMPA    17,DL
         2 001005   001040 604000 2                  TMI     s:900

      238      892    3            VAL.U0 = VAL.U0+MOD(VAL.U0,512*512*2);

    892  2 001006   000007 376000 3                  ANQ     7
         2 001007   200011 036100                    ADLQ    VALC,,AUTO
         2 001010   200011 756100                    STQ     VALC,,AUTO

      239      893    3            IF I<25 THEN EXIT;

    893  2 001011   000031 115007                    CMPA    25,DL
         2 001012   001040 604000 2                  TMI     s:900

      240      894    3            VAL.U0 = VAL.U0+VALU(4)*16;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:82   
    894  2 001013   200012 236100                    LDQ     VALC+1,,AUTO
         2 001014   000027 772000                    QRL     23
         2 001015   017760 376007                    ANQ     8176,DL
         2 001016   200011 036100                    ADLQ    VALC,,AUTO
         2 001017   200011 756100                    STQ     VALC,,AUTO

      241      895    3            IF I<33 THEN EXIT;

    895  2 001020   000041 115007                    CMPA    33,DL
         2 001021   001040 604000 2                  TMI     s:900

      242      896    3            VAL.U0 = VAL.U0+VALU(5)/16;

    896  2 001022   200012 236100                    LDQ     VALC+1,,AUTO
         2 001023   000022 772000                    QRL     18
         2 001024   000777 376007                    ANQ     511,DL
         2 001025   000004 772000                    QRL     4
         2 001026   200011 036100                    ADLQ    VALC,,AUTO
         2 001027   200011 756100                    STQ     VALC,,AUTO

      243      897    3            VAL.NU = VAL.NU+VALP(8);

    897  2 001030   200012 236100                    LDQ     VALC+1,,AUTO
         2 001031   000377 376007                    ANQ     255,DL
         2 001032   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001033   200012 756100                    STQ     VALC+1,,AUTO

      244      898    3            VAL.NU = (VAL.NU+MOD(VAL.NU,131072))*512*32;

    898  2 001034   377777 376007                    ANQ     131071,DL
         2 001035   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001036   000016 736000                    QLS     14
         2 001037   200012 756100                    STQ     VALC+1,,AUTO

      245      899    3         END;

      246      900    2         CALL PUTVALB;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:83   

    900  2 001040   002427 701000 2                  TSX1    PUTVALB
         2 001041   000000 011000                    NOP     0
         2 001042   001630 710000 2                  TRA     s:1040

      247      901        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:84   
      248      902    2      CASE (%XSP_ASN1_BOOLEAN);

      249      903    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;

    903  2 001043   000005 236100                    LDQ     5,,PR0
         2 001044   200000 316003                    CANQ    65536,DU
         2 001045   001655 601000 2                  TNZ     ERR_NOT_PRIM

      250      904    2         IF I~=1 THEN GOTO ERR_BAD_SIZE;

    904  2 001046   200013 235100                    LDA     I,,AUTO
         2 001047   000001 115007                    CMPA    1,DL
         2 001050   001656 601000 2                  TNZ     ERR_BAD_SIZE

      251      905    2         VAL = '0'B;

    905  2 001051   200011 450100                    STZ     VALC,,AUTO
         2 001052   200012 450100                    STZ     VALC+1,,AUTO

      252      906    2         SUBSTR(VALC,0,1) = %CHRS,PARM.NXTX,1);

    906  2 001053   000011 235100                    LDA     9,,PR0
         2 001054   200005 474500                    LDP4    PTRS+1,,AUTO
         2 001055   040100 100505                    MLR     fill='040'O
         2 001056   400000 000001                    ADSC9   0,A,PR4                  cn=0,n=1
         2 001057   200011 000001                    ADSC9   VALC,,AUTO               cn=0,n=1

      253      907    2         PARM.NXTX = PARM.NXTX+1;

    907  2 001060   000011 054100                    AOS     9,,PR0

      254      908    2         IF VAL.B THEN VAL.B = '1'B;

    908  2 001061   200011 235100                    LDA     VALC,,AUTO
         2 001062   001065 600000 2                  TZE     s:909

    908  2 001063   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:85   
         2 001064   200011 756100                    STQ     VALC,,AUTO

      255      909    2         CALL PUTVALB;

    909  2 001065   002427 701000 2                  TSX1    PUTVALB
         2 001066   000000 011000                    NOP     0
         2 001067   001630 710000 2                  TRA     s:1040

      256      910        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:86   
      257      911    2      CASE (%XSP_ASN1_NULL);

      258      912    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;

    912  2 001070   000005 236100                    LDQ     5,,PR0
         2 001071   200000 316003                    CANQ    65536,DU
         2 001072   001655 601000 2                  TNZ     ERR_NOT_PRIM

      259      913    2         IF I~=0 THEN GOTO ERR_BAD_SIZE;

    913  2 001073   200013 235100                    LDA     I,,AUTO
         2 001074   001656 601000 2                  TNZ     ERR_BAD_SIZE

      260      914    2         IF VNODE.FPTID>0 THEN FPT.NULLRSLT(VNODE.FPTID)='1'B;

    914  2 001075   300001 236100                    LDQ     1,,PR3
         2 001076   017700 316007                    CANQ    8128,DL
         2 001077   001630 600000 2                  TZE     s:1040

    914  2 001100   300001 236100                    LDQ     1,,PR3
         2 001101   000006 772000                    QRL     6
         2 001102   000177 376007                    ANQ     127,DL
         2 001103   200006 474500                    LDP4    PTRS+2,,AUTO
         2 001104   003106 060400                    CSL     bolr='003'O
         2 001105   000003 000001 3                  BDSC    3                        by=0,bit=0,n=1
         2 001106   400012 000001                    BDSC    10,Q,PR4                 by=0,bit=0,n=1
         2 001107   001630 710000 2                  TRA     s:1040

      261      915        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:87   
      262      916    2      CASE (%XSP_ASN1_OBJECT_IDENTIFIER);

      263      917    2         IF PARM.TAGC THEN GOTO ERR_NOT_PRIM;

    917  2 001110   000005 236100                    LDQ     5,,PR0
         2 001111   200000 316003                    CANQ    65536,DU
         2 001112   001655 601000 2                  TNZ     ERR_NOT_PRIM

      264      918    2         IF NOT VNODE.IGNORE THEN CALL GETVALPTR;

    918  2 001113   300001 236100                    LDQ     1,,PR3
         2 001114   000020 316003                    CANQ    16,DU
         2 001115   001121 601000 2                  TNZ     s:919

    918  2 001116   002543 701000 2                  TSX1    GETVALPTR
         2 001117   000000 011000                    NOP     0
         2 001120   001123 710000 2                  TRA     s:920

      265      919    2         ELSE VALLIM=-1;

    919  2 001121   000001 335007                    LCA     1,DL
         2 001122   200023 755100                    STA     VALLIM,,AUTO

      266      920    2         CALL GET_7S ALTRET(ERR_BIG_VALUE);

    920  2 001123   001706 701000 2                  TSX1    GET_7S
         2 001124   001651 702000 2                  TSX2    ERR_BIG_VALUE

      267      921    2         T1 = MINIMUM(VAL.N/40,2);

    921  2 001125   200012 236100                    LDQ     VALC+1,,AUTO
         2 001126   000050 506007                    DIV     40,DL
         2 001127   000002 116007                    CMPQ    2,DL
         2 001130   001132 604400 2                  TMOZ    s:921+5
         2 001131   000002 236007                    LDQ     2,DL
         2 001132   200020 756100                    STQ     T1,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:88   
      268      922    2         IF VALLIM>=0 THEN CALL BINCHAR(SUBSTR(VALTXT,VALX,1),T1);

    922  2 001133   200023 235100                    LDA     VALLIM,,AUTO
         2 001134   001142 604000 2                  TMI     s:923

    922  2 001135   200007 470500                    LDP0    PTRS+3,,AUTO
         2 001136   200022 235100                    LDA     VALX,,AUTO
         2 001137   000105 301500                    BTD
         2 001140   200020 000004                    NDSC9   T1,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
         2 001141   000000 030001                    NDSC9   0,A,PR0                  cn=0,s=nosgn,sf=0,n=1

      269      923    2         VAL.N = VAL.N-40*T1;

    923  2 001142   000000 236003                    LDQ     0,DU
         2 001143   200020 136100                    SBLQ    T1,,AUTO
         2 001144   000050 402007                    MPY     40,DL
         2 001145   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001146   200012 756100                    STQ     VALC+1,,AUTO

      270      924    2         VALX = VALX+1;

    924  2 001147   200022 054100                    AOS     VALX,,AUTO

      271      925    2         IF I<=0 THEN GOTO ERR_BAD_SIZE;

    925  2 001150   200013 235100                    LDA     I,,AUTO
         2 001151   001656 604400 2                  TMOZ    ERR_BAD_SIZE

      272      926    3         DO WHILE '1'B;

      273      927    3            T1 = 1;

    927  2 001152   000001 235007                    LDA     1,DL
         2 001153   200020 755100                    STA     T1,,AUTO

      274      928    3            IF VAL.NU<10 THEN;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:89   
    928  2 001154   200012 236100                    LDQ     VALC+1,,AUTO
         2 001155   000012 116007                    CMPQ    10,DL
         2 001156   001177 602000 2                  TNC     s:942

      275      929    4            ELSE DO;

      276      930    4               T1 = T1+1;

    930  2 001157   200020 054100                    AOS     T1,,AUTO

      277      931    4               IF VAL.NU<100 THEN EXIT;

    931  2 001160   000144 116007                    CMPQ    100,DL
         2 001161   001177 602000 2                  TNC     s:942

      278      932    4               T1 = T1+1;

    932  2 001162   200020 054100                    AOS     T1,,AUTO

      279      933    4               IF VAL.NU<1000 THEN EXIT;

    933  2 001163   001750 116007                    CMPQ    1000,DL
         2 001164   001177 602000 2                  TNC     s:942

      280      934    4               T1 = T1+1;

    934  2 001165   200020 054100                    AOS     T1,,AUTO

      281      935    4               IF VAL.NU<10000 THEN EXIT;

    935  2 001166   023420 116007                    CMPQ    10000,DL
         2 001167   001177 602000 2                  TNC     s:942

      282      936    4               T1 = T1+1;

    936  2 001170   200020 054100                    AOS     T1,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:90   
      283      937    4               IF VAL.NU<100000 THEN EXIT;

    937  2 001171   303240 116007                    CMPQ    100000,DL
         2 001172   001177 602000 2                  TNC     s:942

      284      938    4               T1 = T1+1;

    938  2 001173   200020 054100                    AOS     T1,,AUTO

      285      939    4               IF VAL.NU<1000000 THEN EXIT;

    939  2 001174   000010 116000 3                  CMPQ    8
         2 001175   001177 602000 2                  TNC     s:942

      286      940    4               T1 = T1+1;

    940  2 001176   200020 054100                    AOS     T1,,AUTO

      287      941    4            END;

      288      942    3            IF VALLIM<VALX+T1+1 THEN IF VALLIM>=0 THEN GOTO ERR_WONT_FIT;

    942  2 001177   200022 236100                    LDQ     VALX,,AUTO
         2 001200   200020 036100                    ADLQ    T1,,AUTO
         2 001201   200023 116100                    CMPQ    VALLIM,,AUTO
         2 001202   001206 604000 2                  TMI     s:944

    942  2 001203   200023 236100                    LDQ     VALLIM,,AUTO
         2 001204   001650 605000 2                  TPL     ERR_WONT_FIT

      289      943    3            ELSE GOTO SKIP_STORE;

    943  2 001205   001217 710000 2                  TRA     SKIP_STORE

      290      944    3            SUBSTR(VALTXT,VALX,1) = '-';

    944  2 001206   200007 470500                    LDP0    PTRS+3,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:91   
         2 001207   200022 236100                    LDQ     VALX,,AUTO
         2 001210   040106 100400                    MLR     fill='040'O
         2 001211   000011 000001 3                  ADSC9   9                        cn=0,n=1
         2 001212   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

      291      945    3            CALL BINCHAR(SUBSTR(VALTXT,VALX+1,T1),VAL.N);

    945  2 001213   200020 720100                    LXL0    T1,,AUTO
         2 001214   000146 301500                    BTD
         2 001215   200012 000004                    NDSC9   VALC+1,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 001216   000000 230010                    NDSC9   0,Q,PR0                  cn=1,s=nosgn,sf=0,n=*X0

    945  2 001217                       SKIP_STORE   null
      292      946    3   SKIP_STORE:;
      293      947    3            VALX = VALX+T1+1;

    947  2 001217   200022 236100                    LDQ     VALX,,AUTO
         2 001220   200020 036100                    ADLQ    T1,,AUTO
         2 001221   000001 036007                    ADLQ    1,DL
         2 001222   200022 756100                    STQ     VALX,,AUTO

      294      948    3            IF I<=0 THEN EXIT;

    948  2 001223   200013 235100                    LDA     I,,AUTO
         2 001224   001230 604400 2                  TMOZ    s:951

      295      949    3            CALL GET_7S ALTRET(ERR_BIG_VALUE);

    949  2 001225   001706 701000 2                  TSX1    GET_7S
         2 001226   001651 702000 2                  TSX2    ERR_BIG_VALUE

      296      950    3         END;

    950  2 001227   001152 710000 2                  TRA     s:927

      297      951    3         IF VALLIM>=0 THEN DO;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:92   
    951  2 001230   200023 235100                    LDA     VALLIM,,AUTO
         2 001231   001630 604000 2                  TMI     s:1040

      298      952    3            SUBSTR(VALTXT,VALX,VALLIM-VALX) = ' ';

    952  2 001232   200023 236100                    LDQ     VALLIM,,AUTO
         2 001233   200022 136100                    SBLQ    VALX,,AUTO
         2 001234   200007 470500                    LDP0    PTRS+3,,AUTO
         2 001235   000000 620006                    EAX0    0,QL
         2 001236   200022 236100                    LDQ     VALX,,AUTO
         2 001237   040146 100400                    MLR     fill='040'O
         2 001240   000012 000001 3                  ADSC9   10                       cn=0,n=1
         2 001241   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0

      299      953    3            CALL SET_LNG;

    953  2 001242   002656 701000 2                  TSX1    SET_LNG
         2 001243   000000 011000                    NOP     0

      300      954    3         END;

    954  2 001244   001630 710000 2                  TRA     s:1040

      301      955        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:93   
      302      956    2      CASE (%XSP_ASN1_GENERALIZED_TIME, %XSP_ASN1_UTC_TIME);

      303      957    2         TAG = NODE.TYPE;

    957  2 001245   200014 756100                    STQ     TAG,,AUTO

      304      958    3         IF PARM.TAGC THEN DO;

    958  2 001246   000005 236100                    LDQ     5,,PR0
         2 001247   200000 316003                    CANQ    65536,DU
         2 001250   001263 600000 2                  TZE     s:963

      305      959    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);

    959  2 001251   200003 630500                    EPPR0   @PARM,,AUTO
         2 001252   000001 631400 3                  EPPR1   1
         2 001253   002737 701000 2                  TSX1    s:1272
         2 001254   001660 702000 2                  TSX2    RETALT

      306      960    3            I = PARM.SIZE-PARM.NXTX;

    960  2 001255   200003 470500                    LDP0    @PARM,,AUTO
         2 001256   000012 236100                    LDQ     10,,PR0
         2 001257   000011 136100                    SBLQ    9,,PR0
         2 001260   200013 756100                    STQ     I,,AUTO

      307      961    3            PARM.SIZE = PARM.TAG;

    961  2 001261   000013 235100                    LDA     11,,PR0
         2 001262   000012 755100                    STA     10,,PR0

      308      962    3         END;

      309      963    3         IF TAG=%XSP_ASN1_GENERALIZED_TIME THEN DO;

    963  2 001263   200014 235100                    LDA     TAG,,AUTO
         2 001264   000030 115007                    CMPA    24,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:94   
         2 001265   001304 601000 2                  TNZ     s:969

      310      964    3            IF %CHRS,PARM.NXTX,2)~='19' AND

    964  2 001266   000011 235100                    LDA     9,,PR0
         2 001267   200005 471500                    LDP1    PTRS+1,,AUTO
         2 001270   040000 106505                    CMPC    fill='040'O
         2 001271   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2
         2 001272   000103 000002 0                  ADSC9   NSIGNS+5                 cn=0,n=2
         2 001273   001300 600000 2                  TZE     s:966
         2 001274   040000 106505                    CMPC    fill='040'O
         2 001275   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2
         2 001276   000104 000002 0                  ADSC9   NSIGNS+6                 cn=0,n=2
         2 001277   001651 601000 2                  TNZ     ERR_BIG_VALUE

      311      965    3              %CHRS,PARM.NXTX,2)~='20' THEN GOTO ERR_BIG_VALUE;
      312      966    3            PARM.NXTX = PARM.NXTX+2;

    966  2 001300   000002 236007                    LDQ     2,DL
         2 001301   000011 056100                    ASQ     9,,PR0

      313      967    3            I = I-2;

    967  2 001302   000002 336007                    LCQ     2,DL
         2 001303   200013 056100                    ASQ     I,,AUTO

      314      968    3         END;

      315      969    2         IF I<11 THEN GOTO ERR_BAD_SIZE;

    969  2 001304   200013 235100                    LDA     I,,AUTO
         2 001305   000013 115007                    CMPA    11,DL
         2 001306   001656 604000 2                  TMI     ERR_BAD_SIZE

      316      970    2         CALL CHARBIN(T1,%CHRS,PARM.NXTX,10)); /* YYMMDDhhmm                     */

    970  2 001307   000011 235100                    LDA     9,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:95   
         2 001310   200005 471500                    LDP1    PTRS+1,,AUTO
         2 001311   000100 305505                    DTB
         2 001312   100000 030012                    NDSC9   0,A,PR1                  cn=0,s=nosgn,sf=0,n=10
         2 001313   200020 000004                    NDSC9   T1,,AUTO                 cn=0,s=lsgnf,sf=0,n=4

      317      971    2         VAL.N = MOD(T1,10000);            /* hh:mm                              */

    971  2 001314   200020 236100                    LDQ     T1,,AUTO
         2 001315   023420 506007                    DIV     10000,DL
         2 001316   200012 755100                    STA     VALC+1,,AUTO

      318      972    2         VAL.N = VAL.N-40*(VAL.N/100);     /* mmmmm                              */

    972  2 001317   200012 236100                    LDQ     VALC+1,,AUTO
         2 001320   000144 506007                    DIV     100,DL
         2 001321   000013 402000 3                  MPY     11
         2 001322   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001323   200012 756100                    STQ     VALC+1,,AUTO

      319      973    2         T1 = T1/10000;                    /* YYMMDD                             */

    973  2 001324   200020 236100                    LDQ     T1,,AUTO
         2 001325   023420 506007                    DIV     10000,DL
         2 001326   200020 756100                    STQ     T1,,AUTO

      320      974    2         IF T1 < 210101 THEN T1=T1+1000000;/* ALLOW FOR YEARS >1999              */

    974  2 001327   632265 116007                    CMPQ    -52043,DL
         2 001330   001333 605000 2                  TPL     s:975

    974  2 001331   000010 236000 3                  LDQ     8
         2 001332   200020 056100                    ASQ     T1,,AUTO

      321      975    2         T1 = T1 - 780101;                 /* YEARS SINCE 1978                   */

    975  2 001333   000014 236000 3                  LDQ     12
         2 001334   200020 056100                    ASQ     T1,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:96   

      322      976    2         IF T1<0 THEN GOTO ERR_BIG_VALUE;  /* YEARS PRIOR TO 1978                */

    976  2 001335   001651 604000 2                  TMI     ERR_BIG_VALUE

      323      977    2         SIZE = T1/10000;                  /* YY-78                              */

    977  2 001336   200020 236100                    LDQ     T1,,AUTO
         2 001337   023420 506007                    DIV     10000,DL
         2 001340   200015 756100                    STQ     SIZE,,AUTO

      324      978    2         T1 = MOD(T1,10000);               /* MM(-1)DD(-1)                       */

    978  2 001341   200020 236100                    LDQ     T1,,AUTO
         2 001342   023420 506007                    DIV     10000,DL
         2 001343   200020 755100                    STA     T1,,AUTO

      325      979    2         IF MOD(SIZEU,4)~=2 AND T1>199 THEN VAL.N = VAL.N-24*60;

    979  2 001344   200015 236100                    LDQ     SIZE,,AUTO
         2 001345   000003 376007                    ANQ     3,DL
         2 001346   000002 116007                    CMPQ    2,DL
         2 001347   001354 600000 2                  TZE     s:980
         2 001350   000307 115007                    CMPA    199,DL
         2 001351   001354 604400 2                  TMOZ    s:980

    979  2 001352   002640 336007                    LCQ     1440,DL
         2 001353   200012 056100                    ASQ     VALC+1,,AUTO

      326      980    2         VAL.N = VAL.N + 24*60*(YEARS(SIZE) + MONTHS(T1/100) + MOD(T1,100));

    980  2 001354   200020 236100                    LDQ     T1,,AUTO
         2 001355   000144 506007                    DIV     100,DL
         2 001356   000000 620006                    EAX0    0,QL
         2 001357   200015 721100                    LXL1    SIZE,,AUTO
         2 001360   000000 236011 0                  LDQ     YEARS,X1
         2 001361   000053 036010 0                  ADLQ    MONTHS,X0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:97   
         2 001362   200030 756100                    STQ     VALLIM+5,,AUTO
         2 001363   200020 236100                    LDQ     T1,,AUTO
         2 001364   000144 506007                    DIV     100,DL
         2 001365   000044 733000                    LRS     36
         2 001366   200030 036100                    ADLQ    VALLIM+5,,AUTO
         2 001367   002640 402007                    MPY     1440,DL
         2 001370   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001371   200012 756100                    STQ     VALC+1,,AUTO

      327      981    2         I = I-10;

    981  2 001372   000012 336007                    LCQ     10,DL
         2 001373   200013 056100                    ASQ     I,,AUTO

      328      982    2         VAL.N = VAL.N*6000;

    982  2 001374   200012 236100                    LDQ     VALC+1,,AUTO
         2 001375   013560 402007                    MPY     6000,DL
         2 001376   200012 756100                    STQ     VALC+1,,AUTO

      329      983    2         VALX = 0;

    983  2 001377   200022 450100                    STZ     VALX,,AUTO

      330      984    3         DO WHILE I>0;

    984  2 001400   200013 235100                    LDA     I,,AUTO
         2 001401   001530 604400 2                  TMOZ    s:1012

      331      985    3            T1 = ASCBIN(%CHRS,PARM.NXTX+10,1));

    985  2 001402   200003 470500                    LDP0    @PARM,,AUTO
         2 001403   000011 235100                    LDA     9,,PR0
         2 001404   200005 471500                    LDP1    PTRS+1,,AUTO
         2 001405   000100 101505                    MRL     fill='000'O
         2 001406   100002 400001                    ADSC9   2,A,PR1                  cn=2,n=1
         2 001407   200030 000004                    ADSC9   VALLIM+5,,AUTO           cn=0,n=4
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:98   
         2 001410   200030 236100                    LDQ     VALLIM+5,,AUTO
         2 001411   200020 756100                    STQ     T1,,AUTO

      332      986    3            I = I-1;

    986  2 001412   000001 336007                    LCQ     1,DL
         2 001413   200013 056100                    ASQ     I,,AUTO

      333      987    3            PARM.NXTX = PARM.NXTX+1;

    987  2 001414   000011 054100                    AOS     9,,PR0

      334      988    4            IF T1>=ASCBIN('0') AND T1<=ASCBIN('9') THEN DO;

    988  2 001415   200020 235100                    LDA     T1,,AUTO
         2 001416   000060 115007                    CMPA    48,DL
         2 001417   001454 604000 2                  TMI     s:999
         2 001420   000071 115007                    CMPA    57,DL
         2 001421   001454 605400 2                  TPNZ    s:999

      335      989    5               IF VALX=0 THEN DO;

    989  2 001422   200022 235100                    LDA     VALX,,AUTO
         2 001423   001440 601000 2                  TNZ     s:995+1

      336      990         /* Seconds specified */
      337      991    5                  CALL CHARBIN(T1,%CHRS,PARM.NXTX+9,2));

    991  2 001424   000011 235100                    LDA     9,,PR0
         2 001425   000100 305505                    DTB
         2 001426   100002 230002                    NDSC9   2,A,PR1                  cn=1,s=nosgn,sf=0,n=2
         2 001427   200020 000004                    NDSC9   T1,,AUTO                 cn=0,s=lsgnf,sf=0,n=4

      338      992    5                  VAL.N = VAL.N+T1*100;

    992  2 001430   200020 236100                    LDQ     T1,,AUTO
         2 001431   000144 402007                    MPY     100,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:99   
         2 001432   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001433   200012 756100                    STQ     VALC+1,,AUTO

      339      993    5                  I = I-1;

    993  2 001434   000001 336007                    LCQ     1,DL
         2 001435   200013 056100                    ASQ     I,,AUTO

      340      994    5                  PARM.NXTX = PARM.NXTX+1;

    994  2 001436   000011 054100                    AOS     9,,PR0

      341      995    4               END; ELSE IF VALX>0 THEN VAL.N = VAL.N+VALX*(T1-ASCBIN('0'));

    995  2 001437   001451 710000 2                  TRA     s:997

    995  2 001440   001447 604400 2                  TMOZ    s:996

    995  2 001441   200020 236100                    LDQ     T1,,AUTO
         2 001442   000060 136007                    SBLQ    48,DL
         2 001443   200022 402100                    MPY     VALX,,AUTO
         2 001444   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001445   200012 756100                    STQ     VALC+1,,AUTO
         2 001446   001451 710000 2                  TRA     s:997

      342      996    4               ELSE IF VALX=-9 THEN GOTO ERR_BAD_VALUE;

    996  2 001447   000015 115000 3                  CMPA    13
         2 001450   001652 600000 2                  TZE     ERR_BAD_VALUE

      343      997    4               VALX = VALX-9;

    997  2 001451   000011 336007                    LCQ     9,DL
         2 001452   200022 056100                    ASQ     VALX,,AUTO

      344      998    4            END;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:100  
    998  2 001453   001526 710000 2                  TRA     s:1011

      345      999    3            ELSE IF T1=ASCBIN('Z') THEN GOTO GOT_UTC_TIME;

    999  2 001454   000132 115007                    CMPA    90,DL
         2 001455   001534 600000 2                  TZE     GOT_UTC_TIME

      346     1000    4            ELSE IF T1=ASCBIN('+') OR T1=ASCBIN('-') THEN DO;

   1000  2 001456   000053 115007                    CMPA    43,DL
         2 001457   001462 600000 2                  TZE     s:1001
         2 001460   000055 115007                    CMPA    45,DL
         2 001461   001511 601000 2                  TNZ     s:1008

      347     1001    4               IF I~=4 THEN GOTO ERR_BAD_VALUE;

   1001  2 001462   200013 235100                    LDA     I,,AUTO
         2 001463   000004 115007                    CMPA    4,DL
         2 001464   001652 601000 2                  TNZ     ERR_BAD_VALUE

      348     1002    4               CALL CHARBIN(VALX,%CHRS,PARM.NXTX+10,4));

   1002  2 001465   000011 235100                    LDA     9,,PR0
         2 001466   000100 305505                    DTB
         2 001467   100002 430004                    NDSC9   2,A,PR1                  cn=2,s=nosgn,sf=0,n=4
         2 001470   200022 000004                    NDSC9   VALX,,AUTO               cn=0,s=lsgnf,sf=0,n=4

      349     1003    4               VALX = (VALX-40*(VALX/100))*6000;

   1003  2 001471   200022 236100                    LDQ     VALX,,AUTO
         2 001472   000144 506007                    DIV     100,DL
         2 001473   000013 402000 3                  MPY     11
         2 001474   200022 036100                    ADLQ    VALX,,AUTO
         2 001475   013560 402007                    MPY     6000,DL
         2 001476   200022 756100                    STQ     VALX,,AUTO

      350     1004    4               IF T1=ASCBIN('+') THEN VAL.N = VAL.N-VALX;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:101  

   1004  2 001477   200020 235100                    LDA     T1,,AUTO
         2 001500   000053 115007                    CMPA    43,DL
         2 001501   001506 601000 2                  TNZ     s:1005

   1004  2 001502   200012 236100                    LDQ     VALC+1,,AUTO
         2 001503   200022 136100                    SBLQ    VALX,,AUTO
         2 001504   200012 756100                    STQ     VALC+1,,AUTO
         2 001505   001510 710000 2                  TRA     s:1006

      351     1005    4               ELSE VAL.N = VAL.N+VALX;

   1005  2 001506   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001507   200012 756100                    STQ     VALC+1,,AUTO

      352     1006    4               GOTO GOT_UTC_TIME;

   1006  2 001510   001534 710000 2                  TRA     GOT_UTC_TIME

      353     1007    4            END;
      354     1008    3            ELSE IF (T1=ASCBIN('.') OR T1=ASCBIN(','))

   1008  2 001511   000056 115007                    CMPA    46,DL
         2 001512   001515 600000 2                  TZE     s:1008+4
         2 001513   000054 115007                    CMPA    44,DL
         2 001514   001652 601000 2                  TNZ     ERR_BAD_VALUE
         2 001515   200022 235100                    LDA     VALX,,AUTO
         2 001516   000015 115000 3                  CMPA    13
         2 001517   001652 601000 2                  TNZ     ERR_BAD_VALUE
         2 001520   200014 235100                    LDA     TAG,,AUTO
         2 001521   000030 115007                    CMPA    24,DL
         2 001522   001652 601000 2                  TNZ     ERR_BAD_VALUE

      355     1009    3              AND VALX=-9 AND TAG=%XSP_ASN1_GENERALIZED_TIME THEN VALX = 10;

   1009  2 001523   000012 235007                    LDA     10,DL
         2 001524   200022 755100                    STA     VALX,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:102  
         2 001525   001526 710000 2                  TRA     s:1011

      356     1010    3            ELSE GOTO ERR_BAD_VALUE;
      357     1011    3         END;

   1011  2 001526   200013 235100                    LDA     I,,AUTO
         2 001527   001402 605400 2                  TPNZ    s:985

      358     1012    2         IF TAG=%XSP_ASN1_UTC_TIME THEN GOTO ERR_BAD_VALUE; /* Local not ok      */

   1012  2 001530   200014 236100                    LDQ     TAG,,AUTO
         2 001531   000027 116007                    CMPQ    23,DL
         2 001532   001652 600000 2                  TZE     ERR_BAD_VALUE

      359     1013    3         ELSE DO WHILE '0'B;

   1013  2 001533   001537 710000 2                  TRA     s:1017

      360     1014    3   GOT_UTC_TIME:
      361     1015    3            VAL.N = VAL.N+XSP_UTC_OFFSETN;

   1015  2 001534   200012 236100       GOT_UTC_TIME LDQ     VALC+1,,AUTO
         2 001535   000002 036000 1                  ADLQ    XSP_UTC_OFFSETN
         2 001536   200012 756100                    STQ     VALC+1,,AUTO

      362     1016    3         END;

      363     1017    2         CALL PUTVALN;

   1017  2 001537   002255 701000 2                  TSX1    PUTVALN
         2 001540   000000 011000                    NOP     0
         2 001541   001630 710000 2                  TRA     s:1040

      364     1018        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:103  
      365     1019    2      CASE (ELSE);                         /* Text strings                       */

      366     1020    3         IF PARM.TAGC THEN DO;

   1020  2 001542   000005 236100                    LDQ     5,,PR0
         2 001543   200000 316003                    CANQ    65536,DU
         2 001544   001557 600000 2                  TZE     s:1025

      367     1021    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);

   1021  2 001545   200003 630500                    EPPR0   @PARM,,AUTO
         2 001546   000001 631400 3                  EPPR1   1
         2 001547   002737 701000 2                  TSX1    s:1272
         2 001550   001660 702000 2                  TSX2    RETALT

      368     1022    3            I = PARM.SIZE-PARM.NXTX;

   1022  2 001551   200003 470500                    LDP0    @PARM,,AUTO
         2 001552   000012 236100                    LDQ     10,,PR0
         2 001553   000011 136100                    SBLQ    9,,PR0
         2 001554   200013 756100                    STQ     I,,AUTO

      369     1023    3            PARM.SIZE = PARM.TAG;

   1023  2 001555   000013 235100                    LDA     11,,PR0
         2 001556   000012 755100                    STA     10,,PR0

      370     1024    3         END;

      371     1025    3         IF NOT VNODE.IGNORE THEN DO;

   1025  2 001557   200010 471500                    LDP1    PTRS+4,,AUTO
         2 001560   100001 236100                    LDQ     1,,PR1
         2 001561   000020 316003                    CANQ    16,DU
         2 001562   001612 601000 2                  TNZ     s:1032

      372     1026    3            CALL GETVALPTR;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:104  

   1026  2 001563   002543 701000 2                  TSX1    GETVALPTR
         2 001564   000000 011000                    NOP     0

      373     1027    3            IF VALX+I>VALLIM THEN GOTO ERR_WONT_FIT;

   1027  2 001565   200022 236100                    LDQ     VALX,,AUTO
         2 001566   200013 036100                    ADLQ    I,,AUTO
         2 001567   200023 116100                    CMPQ    VALLIM,,AUTO
         2 001570   001650 605400 2                  TPNZ    ERR_WONT_FIT

      374     1028    3            SUBSTR(VALTXT,VALX,VALLIM-VALX) = %CHRS,PARM.NXTX,I);

   1028  2 001571   200023 236100                    LDQ     VALLIM,,AUTO
         2 001572   200022 136100                    SBLQ    VALX,,AUTO
         2 001573   200003 470500                    LDP0    @PARM,,AUTO
         2 001574   000011 235100                    LDA     9,,PR0
         2 001575   200005 471500                    LDP1    PTRS+1,,AUTO
         2 001576   200013 720100                    LXL0    I,,AUTO
         2 001577   200007 473500                    LDP3    PTRS+3,,AUTO
         2 001600   000000 621006                    EAX1    0,QL
         2 001601   200022 236100                    LDQ     VALX,,AUTO
         2 001602   040146 100545                    MLR     fill='040'O
         2 001603   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 001604   300000 000011                    ADSC9   0,Q,PR3                  cn=0,n=*X1

      375     1029    3            VALX = VALX+I;

   1029  2 001605   200013 036100                    ADLQ    I,,AUTO
         2 001606   200022 756100                    STQ     VALX,,AUTO

      376     1030    3            CALL SET_LNG;

   1030  2 001607   002656 701000 2                  TSX1    SET_LNG
         2 001610   000000 011000                    NOP     0

      377     1031    3         END;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:105  

   1031  2 001611   001623 710000 2                  TRA     s:1033

      378     1032    2         ELSE PARM.P.VAL$ = ADDR(%CHRS,PARM.NXTX));

   1032  2 001612   000011 235100                    LDA     9,,PR0
         2 001613   200030 755100                    STA     VALLIM+5,,AUTO
         2 001614   000011 235100                    LDA     9,,PR0
         2 001615   000005 675000 3                  ERA     5
         2 001616   007641 035007                    ADLA    4001,DL
         2 001617   200030 236100                    LDQ     VALLIM+5,,AUTO
         2 001620   000020 736000                    QLS     16
         2 001621   200005 036100                    ADLQ    PTRS+1,,AUTO
         2 001622   000003 756100                    STQ     3,,PR0

      379     1033    2         PARM.NXTX = PARM.SIZE;

   1033  2 001623   200003 470500                    LDP0    @PARM,,AUTO
         2 001624   000012 235100                    LDA     10,,PR0
         2 001625   000011 755100                    STA     9,,PR0

      380     1034    2         PARM.SIZE = I;

   1034  2 001626   200013 236100                    LDQ     I,,AUTO
         2 001627   000012 756100                    STQ     10,,PR0

      381     1035    2      END;

      382     1036        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:106  
      383     1037        /*
      384     1038           Done parsing this node (successfully).
      385     1039        */
      386     1040    1      PARM.PARSED = '1'B;

   1040  2 001630   200003 470500                    LDP0    @PARM,,AUTO
         2 001631   100000 236003                    LDQ     32768,DU
         2 001632   000005 256100                    ORSQ    5,,PR0

      387     1041    2      IF NODE.SUCC.RCV THEN DO;

   1041  2 001633   200004 471500                    LDP1    PTRS,,AUTO
         2 001634   100001 236100                    LDQ     1,,PR1
         2 001635   020000 316003                    CANQ    8192,DU
         2 001636   001647 600000 2                  TZE     s:1045

      388     1042    2         PARM.USR = %XSP_ASN1_RCV_SUCC;

   1042  2 001637   000001 236003                    LDQ     1,DU
         2 001640   000005 552120                    STBQ    5,'20'O,PR0

      389     1043    2         CALL FPT.UENTRY$ (PARM);

   1043  2 001641   200003 630500                    EPPR0   @PARM,,AUTO
         2 001642   200006 473500                    LDP3    PTRS+2,,AUTO
         2 001643   300002 220100                    LDX0    2,,PR3
         2 001644   000001 631400 3                  EPPR1   1
         2 001645   000000 701010                    TSX1    0,X0
         2 001646   000000 011000                    NOP     0

      390     1044    2      END;

      391     1045    1      RETURN;

   1045  2 001647   000000 702200 xent               TSX2  ! X66_ARET

      392     1046        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:107  
      393     1047        /*
      394     1048           Error returns.  Something didn't jibe.
      395     1049        */
      396     1050    1   ERR_WONT_FIT: ERR = ERR+1;              /* Data exceeds supplied buffer       */

   1050  2 001650   200021 054100       ERR_WONT_FIT AOS     ERR,,AUTO

      397     1051    1   ERR_BIG_VALUE: ERR = ERR+1;        /* CP-6 values are not umlimited in size   */

   1051  2 001651   200021 054100       ERR_BIG_VAL* AOS     ERR,,AUTO

      398     1052    1   ERR_BAD_VALUE: ERR = ERR+1;        /* Bad syntax for time or bitstring value  */

   1052  2 001652   200021 054100       ERR_BAD_VAL* AOS     ERR,,AUTO

      399     1053    1   ERR_STR_SIZE: ERR = ERR+1;              /* Whole ~= sum of the parts          */

   1053  2 001653   200021 054100       ERR_STR_SIZE AOS     ERR,,AUTO

      400     1054    1   ERR_NOT_STR: ERR = ERR+1;     /* Expected constructed item, got primitive     */

   1054  2 001654   200021 054100       ERR_NOT_STR  AOS     ERR,,AUTO

      401     1055    1   ERR_NOT_PRIM: ERR = ERR+1;    /* Expected primitive item, got constructed     */

   1055  2 001655   200021 054100       ERR_NOT_PRIM AOS     ERR,,AUTO

      402     1056    1   ERR_BAD_SIZE: ERR = ERR+1;    /* Wrong size for BOOLEAN, NULL, or time value  */

   1056  2 001656   200021 054100       ERR_BAD_SIZE AOS     ERR,,AUTO

      403     1057    1   ERR_WRONG_TAG: ERR = ERR+1;        /* Couldn't match the specified syntax     */

   1057  2 001657   200021 054100       ERR_WRONG_T* AOS     ERR,,AUTO

   1053  2 001660                       RETALT       null
      404     1058    1   RETALT:;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:108  
      405     1059    1      IF ERR~=0 THEN PARM.ERR = ERR;

   1059  2 001660   200021 235100                    LDA     ERR,,AUTO
         2 001661   001664 600000 2                  TZE     s:1060

   1059  2 001662   200003 470500                    LDP0    @PARM,,AUTO
         2 001663   000010 755100                    STA     8,,PR0

      406     1060    2      IF NODE.FAIL.RCV THEN DO;

   1060  2 001664   200004 470500                    LDP0    PTRS,,AUTO
         2 001665   000001 236100                    LDQ     1,,PR0
         2 001666   004000 316003                    CANQ    2048,DU
         2 001667   001701 600000 2                  TZE     s:1064

      407     1061    2         PARM.USR = %XSP_ASN1_RCV_FAIL;

   1061  2 001670   200003 471500                    LDP1    @PARM,,AUTO
         2 001671   000002 236003                    LDQ     2,DU
         2 001672   100005 552120                    STBQ    5,'20'O,PR1

      408     1062    2         CALL FPT.UENTRY$ (PARM);

   1062  2 001673   200003 630500                    EPPR0   @PARM,,AUTO
         2 001674   200006 473500                    LDP3    PTRS+2,,AUTO
         2 001675   300002 220100                    LDX0    2,,PR3
         2 001676   000001 631400 3                  EPPR1   1
         2 001677   000000 701010                    TSX1    0,X0
         2 001700   000000 011000                    NOP     0

      409     1063    2      END;

      410     1064    1      IF PARM.ERR=0 THEN RETURN;

   1064  2 001701   200003 470500                    LDP0    @PARM,,AUTO
         2 001702   000010 235100                    LDA     8,,PR0
         2 001703   001705 601000 2                  TNZ     s:1065
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:109  

   1064  2 001704   000000 702200 xent               TSX2  ! X66_ARET

      411     1065    1      ALTRETURN;

   1065  2 001705   000000 702200 xent               TSX2  ! X66_AALT

      412     1066        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:110  
      413     1067        /*
      414     1068        Subroutines
      415     1069        */
      416     1070    1   GET_7S: PROC ALTRET;

   1070  2 001706   200024 741300       GET_7S       STX1  ! VALLIM+1,,AUTO

      417     1071    3      CALL INDEX(T1,%BINASC(0),%CHRS,PARM.NXTX,I),0,'577'O) WHENALTRETURN DO;

   1071  2 001707   200003 470500                    LDP0    @PARM,,AUTO
         2 001710   000011 235100                    LDA     9,,PR0
         2 001711   200005 471500                    LDP1    PTRS+1,,AUTO
         2 001712   200013 720100                    LXL0    I,,AUTO
         2 001713   577000 124545                    SCM     mask='577'O
         2 001714   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 001715   000016 000001 3                  ADSC9   14                       cn=0,n=1
         2 001716   200020 000100                    ARG     T1,,AUTO
         2 001717   001721 606400 2                  TTN     s:1072
         2 001720   001725 710000 2                  TRA     s:1075

      418     1072    3         ERR = ERR-1;                      /* BAD_VALUE is BIG_VALUE-1           */

   1072  2 001721   000001 336007                    LCQ     1,DL
         2 001722   200021 056100                    ASQ     ERR,,AUTO

      419     1073    3         ALTRETURN;

   1073  2 001723   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 001724   000000 702211                    TSX2  ! 0,X1

      420     1074    3      END;
      421     1075    2      VAL='0'B;

   1075  2 001725   200011 450100                    STZ     VALC,,AUTO
         2 001726   200012 450100                    STZ     VALC+1,,AUTO

      422     1076    2      IF T1>4 THEN ALTRETURN;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:111  

   1076  2 001727   200020 235100                    LDA     T1,,AUTO
         2 001730   000004 115007                    CMPA    4,DL
         2 001731   001733 604400 2                  TMOZ    s:1077

   1076  2 001732   000000 702211                    TSX2  ! 0,X1

      423     1077    2      T1 = T1+1;

   1077  2 001733   200020 054100                    AOS     T1,,AUTO

      424     1078    2      SUBSTR(VALC,8-T1,T1) = %CHRS,PARM.NXTX,T1);

   1078  2 001734   000011 235100                    LDA     9,,PR0
         2 001735   200020 336100                    LCQ     T1,,AUTO
         2 001736   200020 720100                    LXL0    T1,,AUTO
         2 001737   040146 100545                    MLR     fill='040'O
         2 001740   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 001741   200013 000010                    ADSC9   I,Q,AUTO                 cn=0,n=*X0

      425     1079    2      PARM.NXTX = PARM.NXTX+T1;

   1079  2 001742   000011 236100                    LDQ     9,,PR0
         2 001743   200020 036100                    ADLQ    T1,,AUTO
         2 001744   000011 756100                    STQ     9,,PR0

      426     1080    2      I = I-T1;

   1080  2 001745   200013 236100                    LDQ     I,,AUTO
         2 001746   200020 136100                    SBLQ    T1,,AUTO
         2 001747   200013 756100                    STQ     I,,AUTO

      427     1081    3      IF T1>1 THEN DO;

   1081  2 001750   200020 235100                    LDA     T1,,AUTO
         2 001751   000001 115007                    CMPA    1,DL
         2 001752   002000 604400 2                  TMOZ    s:1089
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:112  

      428     1082    3         VALU(7) = VAL.NU*4;

   1082  2 001753   200012 236100                    LDQ     VALC+1,,AUTO
         2 001754   000002 736000                    QLS     2
         2 001755   200012 552104                    STBQ    VALC+1,'04'O,AUTO

      429     1083    3         VAL.LO18.N = VAL.NU*4;

   1083  2 001756   200012 236100                    LDQ     VALC+1,,AUTO
         2 001757   000002 736000                    QLS     2
         2 001760   000000 620006                    EAX0    0,QL
         2 001761   200012 440100                    SXL0    VALC+1,,AUTO

      430     1084    3         VAL.LO27.N = VAL.NU*4;

   1084  2 001762   200012 236100                    LDQ     VALC+1,,AUTO
         2 001763   000002 736000                    QLS     2
         2 001764   200012 552134                    STBQ    VALC+1,'34'O,AUTO

      431     1085    3         VAL.NU = VAL.NU*4;

   1085  2 001765   200012 236100                    LDQ     VALC+1,,AUTO
         2 001766   000002 736000                    QLS     2
         2 001767   200012 756100                    STQ     VALC+1,,AUTO

      432     1086    3         VAL.NU = VAL.NU/(4*4*4*4);

   1086  2 001770   000010 772000                    QRL     8
         2 001771   200012 756100                    STQ     VALC+1,,AUTO

      433     1087    3         IF T1=5 THEN VAL.NU = VAL.NU+VAL.U0*512*512*512*2;

   1087  2 001772   000005 115007                    CMPA    5,DL
         2 001773   002000 601000 2                  TNZ     s:1089

   1087  2 001774   200011 236100                    LDQ     VALC,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:113  
         2 001775   000034 736000                    QLS     28
         2 001776   200012 036100                    ADLQ    VALC+1,,AUTO
         2 001777   200012 756100                    STQ     VALC+1,,AUTO

      434     1088    3      END;

      435     1089    2      RETURN;

   1089  2 002000   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002001   000001 702211                    TSX2  ! 1,X1

      436     1090    2   END GET_7S;
      437     1091        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:114  
      438     1092    1   GET_TAG: PROC ALTRET;

   1092  2 002002   200024 741300       GET_TAG      STX1  ! VALLIM+1,,AUTO

      439     1093
      440     1094    3      IF SIZE<=PARM.NXTX THEN DO;

   1094  2 002003   200003 470500                    LDP0    @PARM,,AUTO
         2 002004   200015 236100                    LDQ     SIZE,,AUTO
         2 002005   000011 116100                    CMPQ    9,,PR0
         2 002006   002015 605400 2                  TPNZ    s:1101

      441     1095        /* No more tags in this structure */
      442     1096    3         TAG = 0;

   1096  2 002007   200014 450100                    STZ     TAG,,AUTO

      443     1097    3         PARM.TAG = 0;

   1097  2 002010   000013 450100                    STZ     11,,PR0

      444     1098    3         PARM.SIZE = SIZE;

   1098  2 002011   200015 235100                    LDA     SIZE,,AUTO
         2 002012   000012 755100                    STA     10,,PR0

      445     1099    3         RETURN;

   1099  2 002013   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002014   000001 702211                    TSX2  ! 1,X1

      446     1100    3      END;
      447     1101    2      T1 = PARM.MAXX-PARM.NXTX-2;

   1101  2 002015   000014 236100                    LDQ     12,,PR0
         2 002016   000011 136100                    SBLQ    9,,PR0
         2 002017   000002 136007                    SBLQ    2,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:115  
         2 002020   200020 756100                    STQ     T1,,AUTO

      448     1102    2      IF T1<0 THEN GOTO ERR_NO_TAG;

   1102  2 002021   002251 604000 2                  TMI     ERR_NO_TAG

      449     1103    2      VALC = %CHRS,PARM.NXTX,T1+2);

   1103  2 002022   000011 235100                    LDA     9,,PR0
         2 002023   000002 620006                    EAX0    2,QL
         2 002024   200005 471500                    LDP1    PTRS+1,,AUTO
         2 002025   040100 100545                    MLR     fill='040'O
         2 002026   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 002027   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=8

      450     1104    2      TAG = VALU(0);

   1104  2 002030   200011 236100                    LDQ     VALC,,AUTO
         2 002031   000033 772000                    QRL     27
         2 002032   200014 756100                    STQ     TAG,,AUTO

      451     1105    2      PARM.TAGC = '0'B;

   1105  2 002033   000017 236000 3                  LDQ     15
         2 002034   000005 356100                    ANSQ    5,,PR0

      452     1106    2      IF VAL.TAG.CONSTRUCTED THEN PARM.TAGC = '1'B;

   1106  2 002035   200011 236100                    LDQ     VALC,,AUTO
         2 002036   040000 316003                    CANQ    16384,DU
         2 002037   002042 600000 2                  TZE     s:1107

   1106  2 002040   200000 236003                    LDQ     65536,DU
         2 002041   000005 256100                    ORSQ    5,,PR0

      453     1107    3      IF NOT VAL.B&'777777'O THEN DO;      /* Two zero bytes                     */

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:116  
   1107  2 002042   200011 236100                    LDQ     VALC,,AUTO
         2 002043   777777 376003                    ANQ     -1,DU
         2 002044   002051 601000 2                  TNZ     s:1112

      454     1108    3         PARM.TAG = 0;

   1108  2 002045   000013 450100                    STZ     11,,PR0

      455     1109    3         PARM.SIZE = 0;

   1109  2 002046   000012 450100                    STZ     10,,PR0

      456     1110    3         RETURN;

   1110  2 002047   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002050   000001 702211                    TSX2  ! 1,X1

      457     1111    3      END;
      458     1112    2      TAGX = TAG/64*65536;

   1112  2 002051   200014 236100                    LDQ     TAG,,AUTO
         2 002052   000006 772000                    QRL     6
         2 002053   000020 736000                    QLS     16
         2 002054   200016 756100                    STQ     TAGX,,AUTO

      459     1113    2      TAG = MOD(TAG,32);

   1113  2 002055   200014 236100                    LDQ     TAG,,AUTO
         2 002056   000037 376007                    ANQ     31,DL
         2 002057   200014 756100                    STQ     TAG,,AUTO

      460     1114    3      IF TAG=31 THEN DO;

   1114  2 002060   000037 116007                    CMPQ    31,DL
         2 002061   002113 601000 2                  TNZ     s:1125

      461     1115    3         VAL = VALSHF.B;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:117  

   1115  2 002062   000100 100500                    MLR     fill='000'O
         2 002063   200011 200007                    ADSC9   VALC,,AUTO               cn=1,n=7
         2 002064   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=8

      462     1116    3         TAG = VALU(0);

   1116  2 002065   200011 236100                    LDQ     VALC,,AUTO
         2 002066   000033 772000                    QRL     27
         2 002067   200014 756100                    STQ     TAG,,AUTO

      463     1117    4         DO WHILE '1'B;

      464     1118    4            T1 = T1-1;

   1118  2 002070   000001 336007                    LCQ     1,DL
         2 002071   200020 056100                    ASQ     T1,,AUTO

      465     1119    4            IF NOT VAL.B&'2'O THEN EXIT;

   1119  2 002072   200011 236100                    LDQ     VALC,,AUTO
         2 002073   200000 376003                    ANQ     65536,DU
         2 002074   002113 600000 2                  TZE     s:1125

      466     1120    4            VAL = VALSHF.B;

   1120  2 002075   000100 100500                    MLR     fill='000'O
         2 002076   200011 200007                    ADSC9   VALC,,AUTO               cn=1,n=7
         2 002077   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=8

      467     1121    4            TAG = TAG*128+VALU(0)-128*128;

   1121  2 002100   200011 236100                    LDQ     VALC,,AUTO
         2 002101   000033 772000                    QRL     27
         2 002102   200030 756100                    STQ     VALLIM+5,,AUTO
         2 002103   200014 236100                    LDQ     TAG,,AUTO
         2 002104   000007 736000                    QLS     7
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:118  
         2 002105   200030 036100                    ADLQ    VALLIM+5,,AUTO
         2 002106   040000 136007                    SBLQ    16384,DL
         2 002107   200014 756100                    STQ     TAG,,AUTO

      468     1122    4            IF TAG>65535 THEN GOTO ERR_BIG_TAG;

   1122  2 002110   200000 116007                    CMPQ    65536,DL
         2 002111   002250 603000 2                  TRC     ERR_BIG_TAG

      469     1123    4         END;

   1123  2 002112   002070 710000 2                  TRA     s:1118

      470     1124    3      END;

      471     1125    2      TAG = TAG+TAGX;

   1125  2 002113   200014 236100                    LDQ     TAG,,AUTO
         2 002114   200016 036100                    ADLQ    TAGX,,AUTO
         2 002115   200014 756100                    STQ     TAG,,AUTO

      472     1126    2      PARM.TAG = TAG;

   1126  2 002116   200003 470500                    LDP0    @PARM,,AUTO
         2 002117   000013 756100                    STQ     11,,PR0

      473     1127    2      IF TAG=0 OR T1<0 THEN GOTO ERR_NO_TAG;

   1127  2 002120   002251 600000 2                  TZE     ERR_NO_TAG
         2 002121   200020 235100                    LDA     T1,,AUTO
         2 002122   002251 604000 2                  TMI     ERR_NO_TAG

      474     1128    2      PARM.NXTX = PARM.MAXX-T1;

   1128  2 002123   000014 236100                    LDQ     12,,PR0
         2 002124   200020 136100                    SBLQ    T1,,AUTO
         2 002125   000011 756100                    STQ     9,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:119  

      475     1129    2      VAL.NU = VALU(1);

   1129  2 002126   200011 236100                    LDQ     VALC,,AUTO
         2 002127   000022 772000                    QRL     18
         2 002130   000777 376007                    ANQ     511,DL
         2 002131   200012 756100                    STQ     VALC+1,,AUTO

      476     1130    3      IF VAL.NU<128 THEN DO;               /* Short form for length              */

   1130  2 002132   000200 116007                    CMPQ    128,DL
         2 002133   002141 603000 2                  TRC     s:1133+1

      477     1131    3         PARM.SIZE = PARM.NXTX+VAL.NU;

   1131  2 002134   000011 036100                    ADLQ    9,,PR0
         2 002135   000012 756100                    STQ     10,,PR0

      478     1132    3         IF PARM.SIZE>PARM.MAXX THEN GOTO ERR_BIG_LNG;

   1132  2 002136   000014 116100                    CMPQ    12,,PR0
         2 002137   002247 605400 2                  TPNZ    ERR_BIG_LNG

      479     1133    3      END; ELSE IF VAL.NU=128 THEN DO;     /* Indefinite form for length         */

   1133  2 002140   002243 710000 2                  TRA     s:1157

   1133  2 002141   002145 601000 2                  TNZ     s:1136

      480     1134    3         PARM.SIZE = 65535;

   1134  2 002142   177777 235007                    LDA     65535,DL
         2 002143   000012 755100                    STA     10,,PR0

      481     1135    3      END; ELSE /* IF VAL.NU>128 THEN */ DO; /* Long form                        */

   1135  2 002144   002243 710000 2                  TRA     s:1157
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:120  

      482     1136    3         PARM.NXTX = PARM.NXTX+1;

   1136  2 002145   000011 054100                    AOS     9,,PR0

      483     1137    3         IF VAL.NU<130 THEN VAL.NU = VALU(2);

   1137  2 002146   200012 235100                    LDA     VALC+1,,AUTO
         2 002147   000202 115007                    CMPA    130,DL
         2 002150   002156 603000 2                  TRC     s:1138

   1137  2 002151   200011 236100                    LDQ     VALC,,AUTO
         2 002152   000011 772000                    QRL     9
         2 002153   000777 376007                    ANQ     511,DL
         2 002154   200012 756100                    STQ     VALC+1,,AUTO
         2 002155   002236 710000 2                  TRA     s:1154

      484     1138    4         ELSE IF VAL.NU=130 THEN DO;

   1138  2 002156   002167 601000 2                  TNZ     s:1142

      485     1139    4            VAL.NU = MOD((VAL.U0+VALU(3))/2,65536);

   1139  2 002157   200011 236100                    LDQ     VALC,,AUTO
         2 002160   000777 376007                    ANQ     511,DL
         2 002161   200011 036100                    ADLQ    VALC,,AUTO
         2 002162   000001 772000                    QRL     1
         2 002163   177777 376007                    ANQ     65535,DL
         2 002164   200012 756100                    STQ     VALC+1,,AUTO

      486     1140    4            PARM.NXTX = PARM.NXTX+1;

   1140  2 002165   000011 054100                    AOS     9,,PR0

      487     1141    4         END; ELSE DO;

   1141  2 002166   002236 710000 2                  TRA     s:1154
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:121  

      488     1142    4            VAL.NU = VAL.NU-128;

   1142  2 002167   000200 135007                    SBLA    128,DL
         2 002170   200012 755100                    STA     VALC+1,,AUTO

      489     1143    4            VAL.B = '0'B;

   1143  2 002171   200011 450100                    STZ     VALC,,AUTO

      490     1144    4            T1 = T1-VAL.NU;

   1144  2 002172   200020 236100                    LDQ     T1,,AUTO
         2 002173   200012 136100                    SBLQ    VALC+1,,AUTO
         2 002174   200020 756100                    STQ     T1,,AUTO

      491     1145    4            IF T1<0 OR VAL.NU=127 THEN GOTO ERR_BIG_LNG;

   1145  2 002175   002247 604000 2                  TMI     ERR_BIG_LNG
         2 002176   000177 115007                    CMPA    127,DL
         2 002177   002247 600000 2                  TZE     ERR_BIG_LNG

      492     1146    4            PARM.NXTX = PARM.MAXX-T1;

   1146  2 002200   000014 236100                    LDQ     12,,PR0
         2 002201   200020 136100                    SBLQ    T1,,AUTO
         2 002202   000011 756100                    STQ     9,,PR0

      493     1147    4            IF VAL.NU>8 THEN VAL.NU=8;

   1147  2 002203   200012 235100                    LDA     VALC+1,,AUTO
         2 002204   000011 115007                    CMPA    9,DL
         2 002205   002210 602000 2                  TNC     s:1148

   1147  2 002206   000010 235007                    LDA     8,DL
         2 002207   200012 755100                    STA     VALC+1,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:122  
      494     1148    4            SUBSTR(VALC,8-VAL.NU,VAL.NU) = %CHRS,PARM.NXTX-VAL.NU,VAL.NU);

   1148  2 002210   000011 236100                    LDQ     9,,PR0
         2 002211   200012 136100                    SBLQ    VALC+1,,AUTO
         2 002212   000005 675000 3                  ERA     5
         2 002213   000001 035007                    ADLA    1,DL
         2 002214   200005 471500                    LDP1    PTRS+1,,AUTO
         2 002215   200012 720100                    LXL0    VALC+1,,AUTO
         2 002216   040145 100546                    MLR     fill='040'O
         2 002217   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
         2 002220   200013 000010                    ADSC9   I,A,AUTO                 cn=0,n=*X0

      495     1149    4            IF VAL.B THEN GOTO ERR_BIG_LNG;

   1149  2 002221   200011 235100                    LDA     VALC,,AUTO
         2 002222   002247 601000 2                  TNZ     ERR_BIG_LNG

      496     1150    4            VAL.NU = VAL.NU+MOD(VAL.NU,512);

   1150  2 002223   200012 236100                    LDQ     VALC+1,,AUTO
         2 002224   000777 376007                    ANQ     511,DL
         2 002225   200012 036100                    ADLQ    VALC+1,,AUTO
         2 002226   200012 756100                    STQ     VALC+1,,AUTO

      497     1151    4            VAL.NU = VAL.NU+MOD(VAL.NU,512*512);

   1151  2 002227   777777 376007                    ANQ     -1,DL
         2 002230   200012 036100                    ADLQ    VALC+1,,AUTO
         2 002231   200012 756100                    STQ     VALC+1,,AUTO

      498     1152    4            VAL.NU = (VAL.NU+MOD(VAL.NU,512*512*512))/8;

   1152  2 002232   000006 376000 3                  ANQ     6
         2 002233   200012 036100                    ADLQ    VALC+1,,AUTO
         2 002234   000003 772000                    QRL     3
         2 002235   200012 756100                    STQ     VALC+1,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:123  
      499     1153    4         END;

      500     1154    3         PARM.SIZE = VAL.NU+PARM.NXTX;

   1154  2 002236   200012 236100                    LDQ     VALC+1,,AUTO
         2 002237   000011 036100                    ADLQ    9,,PR0
         2 002240   000012 756100                    STQ     10,,PR0

      501     1155    3         IF PARM.SIZE>PARM.MAXX THEN GOTO ERR_BIG_LNG;

   1155  2 002241   000014 116100                    CMPQ    12,,PR0
         2 002242   002247 605400 2                  TPNZ    ERR_BIG_LNG

      502     1156    3      END;

      503     1157    2      PARM.PARSED = '0'B;

   1157  2 002243   000020 236000 3                  LDQ     16
         2 002244   000005 356100                    ANSQ    5,,PR0

      504     1158    2      RETURN;

   1158  2 002245   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002246   000001 702211                    TSX2  ! 1,X1

      505     1159    2   ERR_BIG_LNG: ERR = ERR+1;

   1159  2 002247   200021 054100       ERR_BIG_LNG  AOS     ERR,,AUTO

      506     1160    2   ERR_BIG_TAG: ERR = ERR+1;

   1160  2 002250   200021 054100       ERR_BIG_TAG  AOS     ERR,,AUTO

      507     1161    2   ERR_NO_TAG: ERR = ERR+%XSP_ASN1_E$NO_TAG;

   1161  2 002251   000013 236007       ERR_NO_TAG   LDQ     11,DL
         2 002252   200021 056100                    ASQ     ERR,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:124  

      508     1162    2      ALTRETURN;

   1162  2 002253   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002254   000000 702211                    TSX2  ! 0,X1

      509     1163    2   END GET_TAG;
      510     1164        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:125  
      511     1165    1   PUTVALN: PROC;

   1165  2 002255   200024 741300       PUTVALN      STX1  ! VALLIM+1,,AUTO

      512     1166
      513     1167    2   DCL BITS BIT(SIZE) BASED;
      514     1168    2   DCL CHARS CHAR(4000) BASED(PTRS.VAL$);
      515     1169    2   DCL BYTES(0:0) UBIN(9) CALIGNED BASED(PTRS.VAL$);
      516     1170    2   DCL HWORD UBIN(18) BASED(PTRS.VAL$) ALIGNED;
      517     1171    2   DCL WORDS(0:0) UBIN BASED(PTRS.VAL$) ALIGNED;
      518     1172
      519     1173    3      IF VNODE.IGNORE THEN DO;

   1173  2 002256   200010 470500                    LDP0    PTRS+4,,AUTO
         2 002257   000001 236100                    LDQ     1,,PR0
         2 002260   000020 316003                    CANQ    16,DU
         2 002261   002271 600000 2                  TZE     s:1178

      520     1174    3         PARM.P.VAL$ = ADDR(VAL.N);

   1174  2 002262   200012 631500                    EPPR1   VALC+1,,AUTO
         2 002263   200003 473500                    LDP3    @PARM,,AUTO
         2 002264   300003 451500                    STP1    3,,PR3

      521     1175    3         PARM.SIZE = 36;

   1175  2 002265   000044 235007                    LDA     36,DL
         2 002266   300012 755100                    STA     10,,PR3

      522     1176    3         RETURN;

   1176  2 002267   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002270   000001 702211                    TSX2  ! 1,X1

      523     1177    3      END;
      524     1178    2      PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:126  
   1178  2 002271   000002 720100                    LXL0    2,,PR0
         2 002272   000077 360003                    ANX0    63,DU
         2 002273   200006 471500                    LDP1    PTRS+2,,AUTO
         2 002274   100015 236110                    LDQ     13,X0,PR1
         2 002275   200007 756100                    STQ     PTRS+3,,AUTO

      525     1179    2      IF VNODE.INCRPTR

   1179  2 002276   000001 236100                    LDQ     1,,PR0
         2 002277   000040 316003                    CANQ    32,DU
         2 002300   002307 600000 2                  TZE     s:1181

      526     1180    2      THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);

   1180  2 002301   000002 236100                    LDQ     2,,PR0
         2 002302   000006 772000                    QRL     6
         2 002303   000377 376007                    ANQ     255,DL
         2 002304   200007 473500                    LDP3    PTRS+3,,AUTO
         2 002305   300000 503506                    ABD     0,QL,PR3
         2 002306   100015 453510                    STP3    13,X0,PR1

      527     1181    2      SIZE = VNODE.SIZE;

   1181  2 002307   000001 236100                    LDQ     1,,PR0
         2 002310   000015 772000                    QRL     13
         2 002311   000377 376007                    ANQ     255,DL
         2 002312   200015 756100                    STQ     SIZE,,AUTO

      528     1182    2      IF SIZE=0 THEN SIZE = 36;

   1182  2 002313   002316 601000 2                  TNZ     s:1183

   1182  2 002314   000044 235007                    LDA     36,DL
         2 002315   200015 755100                    STA     SIZE,,AUTO

      529     1183    3      IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:127  
   1183  2 002316   000002 236100                    LDQ     2,,PR0
         2 002317   140000 376007                    ANQ     49152,DL
         2 002320   040000 116007                    CMPQ    16384,DL
         2 002321   002346 601000 2                  TNZ     s:1190+1

      530     1184    3         SIZE = SIZE/9;

   1184  2 002322   200015 236100                    LDQ     SIZE,,AUTO
         2 002323   000011 506007                    DIV     9,DL
         2 002324   200015 756100                    STQ     SIZE,,AUTO

      531     1185    4         IF SIZE>7 THEN DO;

   1185  2 002325   000007 116007                    CMPQ    7,DL
         2 002326   002335 604400 2                  TMOZ    s:1189

      532     1186    4            PTRS.VAL$ = PINCRC(PTRS.VAL$,SIZE-7);

   1186  2 002327   000020 736000                    QLS     16
         2 002330   000021 136000 3                  SBLQ    17
         2 002331   200007 036100                    ADLQ    PTRS+3,,AUTO
         2 002332   200007 756100                    STQ     PTRS+3,,AUTO

      533     1187    4            SIZE = 7;

   1187  2 002333   000007 235007                    LDA     7,DL
         2 002334   200015 755100                    STA     SIZE,,AUTO

      534     1188    4         END;

      535     1189    3         SUBSTR(CHARS,VNODE.OFFSET,SIZE) = SUBSTR(VALC,8-SIZE,SIZE);

   1189  2 002335   000002 236100                    LDQ     2,,PR0
         2 002336   000022 772000                    QRL     18
         2 002337   200015 335100                    LCA     SIZE,,AUTO
         2 002340   200015 720100                    LXL0    SIZE,,AUTO
         2 002341   200007 473500                    LDP3    PTRS+3,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:128  
         2 002342   040146 100545                    MLR     fill='040'O
         2 002343   200013 000010                    ADSC9   I,A,AUTO                 cn=0,n=*X0
         2 002344   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=*X0

      536     1190    3      END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;

   1190  2 002345   002425 710000 2                  TRA     s:1208

   1190  2 002346   000002 236100                    LDQ     2,,PR0
         2 002347   140000 316007                    CANQ    49152,DL
         2 002350   002402 601000 2                  TNZ     s:1201

      537     1191    4         IF SIZE>72 THEN DO;

   1191  2 002351   200015 235100                    LDA     SIZE,,AUTO
         2 002352   000110 115007                    CMPA    72,DL
         2 002353   002364 604400 2                  TMOZ    s:1195

      538     1192    4            PTRS.VAL$ = PINCRW(PTRS.VAL$,SIZE/36-2);

   1192  2 002354   200015 236100                    LDQ     SIZE,,AUTO
         2 002355   000044 506007                    DIV     36,DL
         2 002356   000022 736000                    QLS     18
         2 002357   000002 136003                    SBLQ    2,DU
         2 002360   200007 036100                    ADLQ    PTRS+3,,AUTO
         2 002361   200007 756100                    STQ     PTRS+3,,AUTO

      539     1193    4            SIZE = 72;

   1193  2 002362   000110 235007                    LDA     72,DL
         2 002363   200015 755100                    STA     SIZE,,AUTO

      540     1194    4         END;

      541     1195    3         WORDS(VNODE.OFFSET) = VAL.N;

   1195  2 002364   000002 220100                    LDX0    2,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:129  
         2 002365   200012 236100                    LDQ     VALC+1,,AUTO
         2 002366   200007 473500                    LDP3    PTRS+3,,AUTO
         2 002367   300000 756110                    STQ     0,X0,PR3

      542     1196    4         IF SIZE>36 THEN DO;

   1196  2 002370   200015 235100                    LDA     SIZE,,AUTO
         2 002371   000044 115007                    CMPA    36,DL
         2 002372   002425 604400 2                  TMOZ    s:1208

      543     1197    4            WORDS(VNODE.OFFSET+1) = VAL.N;

   1197  2 002373   000002 220100                    LDX0    2,,PR0
         2 002374   200012 236100                    LDQ     VALC+1,,AUTO
         2 002375   300001 756110                    STQ     1,X0,PR3

      544     1198    4            WORDS(VNODE.OFFSET) = VAL.N0;

   1198  2 002376   000002 220100                    LDX0    2,,PR0
         2 002377   200011 235100                    LDA     VALC,,AUTO
         2 002400   300000 755110                    STA     0,X0,PR3

      545     1199    4         END;

      546     1200    3      END; ELSE DO;

   1200  2 002401   002425 710000 2                  TRA     s:1208

      547     1201    4         IF SIZE>72 THEN DO;

   1201  2 002402   200015 235100                    LDA     SIZE,,AUTO
         2 002403   000110 115007                    CMPA    72,DL
         2 002404   002413 604400 2                  TMOZ    s:1205

      548     1202    4            PTRS.VAL$ = PINCRB(PTRS.VAL$,SIZEU-72);

   1202  2 002405   200007 473500                    LDP3    PTRS+3,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:130  
         2 002406   200015 235100                    LDA     SIZE,,AUTO
         2 002407   377776 503505                    ABD     -2,AL,PR3
         2 002410   200007 453500                    STP3    PTRS+3,,AUTO

      549     1203    4            SIZE = 72;

   1203  2 002411   000110 235007                    LDA     72,DL
         2 002412   200015 755100                    STA     SIZE,,AUTO

      550     1204    4         END;

      551     1205    3         PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS =

   1205  2 002413   000002 236100                    LDQ     2,,PR0
         2 002414   000022 772000                    QRL     18
         2 002415   000000 531000                    NEG     0
         2 002416   002420 605000 2                  TPL     s:1205+5
         2 002417   000044 035003                    ADLA    36,DU
         2 002420   200015 720100                    LXL0    SIZE,,AUTO
         2 002421   200007 473500                    LDP3    PTRS+3,,AUTO
         2 002422   003146 060545                    CSL     bolr='003'O
         2 002423   200013 000010                    BDSC    I,A,AUTO                 by=0,bit=0,n=*X0
         2 002424   300000 000010                    BDSC    0,Q,PR3                  by=0,bit=0,n=*X0

      552     1206    3           PINCRB(ADDR(VAL),72-SIZE)->BITS;
      553     1207    3      END;

      554     1208    2      RETURN;

   1208  2 002425   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002426   000001 702211                    TSX2  ! 1,X1

      555     1209        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:131  
      556     1210    2   PUTVALB: ENTRY;

   1210  2 002427   200024 741300       PUTVALB      STX1  ! VALLIM+1,,AUTO

      557     1211    3      IF VNODE.IGNORE THEN DO;

   1211  2 002430   200010 470500                    LDP0    PTRS+4,,AUTO
         2 002431   000001 236100                    LDQ     1,,PR0
         2 002432   000020 316003                    CANQ    16,DU
         2 002433   002443 600000 2                  TZE     s:1216

      558     1212    3         PARM.P.VAL$ = ADDR(VAL);

   1212  2 002434   200011 631500                    EPPR1   VALC,,AUTO
         2 002435   200003 473500                    LDP3    @PARM,,AUTO
         2 002436   300003 451500                    STP1    3,,PR3

      559     1213    3         PARM.SIZE = I;

   1213  2 002437   200013 235100                    LDA     I,,AUTO
         2 002440   300012 755100                    STA     10,,PR3

      560     1214    3         RETURN;

   1214  2 002441   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002442   000001 702211                    TSX2  ! 1,X1

      561     1215    3      END;
      562     1216    2      PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);

   1216  2 002443   000002 720100                    LXL0    2,,PR0
         2 002444   000077 360003                    ANX0    63,DU
         2 002445   200006 471500                    LDP1    PTRS+2,,AUTO
         2 002446   100015 236110                    LDQ     13,X0,PR1
         2 002447   200007 756100                    STQ     PTRS+3,,AUTO

      563     1217    2      IF VNODE.INCRPTR
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:132  

   1217  2 002450   000001 236100                    LDQ     1,,PR0
         2 002451   000040 316003                    CANQ    32,DU
         2 002452   002461 600000 2                  TZE     s:1219

      564     1218    2      THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);

   1218  2 002453   000002 236100                    LDQ     2,,PR0
         2 002454   000006 772000                    QRL     6
         2 002455   000377 376007                    ANQ     255,DL
         2 002456   200007 473500                    LDP3    PTRS+3,,AUTO
         2 002457   300000 503506                    ABD     0,QL,PR3
         2 002460   100015 453510                    STP3    13,X0,PR1

      565     1219    2      SIZE = VNODE.SIZE;

   1219  2 002461   000001 236100                    LDQ     1,,PR0
         2 002462   000015 772000                    QRL     13
         2 002463   000377 376007                    ANQ     255,DL
         2 002464   200015 756100                    STQ     SIZE,,AUTO

      566     1220    2      IF SIZE=0 THEN SIZE = 1;

   1220  2 002465   002470 601000 2                  TNZ     s:1221

   1220  2 002466   000001 235007                    LDA     1,DL
         2 002467   200015 755100                    STA     SIZE,,AUTO

      567     1221    2      IF SIZE>56 THEN SIZE = 56;

   1221  2 002470   200015 235100                    LDA     SIZE,,AUTO
         2 002471   000070 115007                    CMPA    56,DL
         2 002472   002475 604400 2                  TMOZ    s:1222

   1221  2 002473   000070 236007                    LDQ     56,DL
         2 002474   200015 756100                    STQ     SIZE,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:133  
      568     1222    3      IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;

   1222  2 002475   000002 236100                    LDQ     2,,PR0
         2 002476   140000 376007                    ANQ     49152,DL
         2 002477   040000 116007                    CMPQ    16384,DL
         2 002500   002514 601000 2                  TNZ     s:1225+1

      569     1223    3         T1 = SIZE/9;

   1223  2 002501   200015 236100                    LDQ     SIZE,,AUTO
         2 002502   000011 506007                    DIV     9,DL
         2 002503   200020 756100                    STQ     T1,,AUTO

      570     1224    3         SUBSTR(CHARS,VNODE.OFFSET,T1) = SUBSTR(VALC,0,T1);

   1224  2 002504   000002 236100                    LDQ     2,,PR0
         2 002505   000022 772000                    QRL     18
         2 002506   200020 720100                    LXL0    T1,,AUTO
         2 002507   200007 473500                    LDP3    PTRS+3,,AUTO
         2 002510   040146 100540                    MLR     fill='040'O
         2 002511   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=*X0
         2 002512   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=*X0

      571     1225    3      END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;

   1225  2 002513   002541 710000 2                  TRA     s:1229

   1225  2 002514   000002 236100                    LDQ     2,,PR0
         2 002515   140000 316007                    CANQ    49152,DL
         2 002516   002532 601000 2                  TNZ     s:1228+1

      572     1226    3         WORDS(VNODE.OFFSET) = VAL.N0;

   1226  2 002517   000002 220100                    LDX0    2,,PR0
         2 002520   200011 235100                    LDA     VALC,,AUTO
         2 002521   200007 473500                    LDP3    PTRS+3,,AUTO
         2 002522   300000 755110                    STA     0,X0,PR3
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:134  

      573     1227    3         IF SIZE>36 THEN WORDS(VNODE.OFFSET+1) = VAL.N;

   1227  2 002523   200015 235100                    LDA     SIZE,,AUTO
         2 002524   000044 115007                    CMPA    36,DL
         2 002525   002541 604400 2                  TMOZ    s:1229

   1227  2 002526   000002 220100                    LDX0    2,,PR0
         2 002527   200012 236100                    LDQ     VALC+1,,AUTO
         2 002530   300001 756110                    STQ     1,X0,PR3

      574     1228    2      END; ELSE PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS = ADDR(VAL)->BITS;

   1228  2 002531   002541 710000 2                  TRA     s:1229

   1228  2 002532   000002 236100                    LDQ     2,,PR0
         2 002533   000022 772000                    QRL     18
         2 002534   200015 720100                    LXL0    SIZE,,AUTO
         2 002535   200007 473500                    LDP3    PTRS+3,,AUTO
         2 002536   003146 060540                    CSL     bolr='003'O
         2 002537   200011 000010                    BDSC    VALC,,AUTO               by=0,bit=0,n=*X0
         2 002540   300000 000010                    BDSC    0,Q,PR3                  by=0,bit=0,n=*X0

      575     1229    2      RETURN;

   1229  2 002541   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002542   000001 702211                    TSX2  ! 1,X1

      576     1230        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:135  
      577     1231    2   GETVALPTR: ENTRY;

   1231  2 002543   200024 741300       GETVALPTR    STX1  ! VALLIM+1,,AUTO

      578     1232    2      PTRS.VAL$ = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(VNODE.OFFSET));

   1232  2 002544   200010 470500                    LDP0    PTRS+4,,AUTO
         2 002545   000002 720100                    LXL0    2,,PR0
         2 002546   000077 360003                    ANX0    63,DU
         2 002547   200006 471500                    LDP1    PTRS+2,,AUTO
         2 002550   100015 473510                    LDP3    13,X0,PR1
         2 002551   000002 236100                    LDQ     2,,PR0
         2 002552   000022 772000                    QRL     18
         2 002553   300000 500506                    A9BD    0,QL,PR3
         2 002554   200007 453500                    STP3    PTRS+3,,AUTO

      579     1233    2      VALLIM = VNODE.SIZELIM;

   1233  2 002555   000002 236100                    LDQ     2,,PR0
         2 002556   000006 772000                    QRL     6
         2 002557   000377 376007                    ANQ     255,DL
         2 002560   200023 756100                    STQ     VALLIM,,AUTO

      580     1234    2      IF VNODE.INCRPTR

   1234  2 002561   000001 236100                    LDQ     1,,PR0
         2 002562   000040 316003                    CANQ    32,DU
         2 002563   002570 600000 2                  TZE     s:1236

      581     1235    2      THEN FPT.DAT$(VNODE.FPTPTR) = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(VALLIM));

   1235  2 002564   100015 474510                    LDP4    13,X0,PR1
         2 002565   200023 235100                    LDA     VALLIM,,AUTO
         2 002566   400000 500505                    A9BD    0,AL,PR4
         2 002567   100015 454510                    STP4    13,X0,PR1

      582     1236    2      IF VALLIM=0 THEN VALLIM = VNODE.SIZE;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:136  

   1236  2 002570   200023 235100                    LDA     VALLIM,,AUTO
         2 002571   002576 601000 2                  TNZ     s:1237

   1236  2 002572   000001 236100                    LDQ     1,,PR0
         2 002573   000015 772000                    QRL     13
         2 002574   000377 376007                    ANQ     255,DL
         2 002575   200023 756100                    STQ     VALLIM,,AUTO

      583     1237    2      VALX = 0;

   1237  2 002576   200022 450100                    STZ     VALX,,AUTO

      584     1238    3      DO CASE VNODE.CP6TYP;                /* textc stuff                        */

   1238  2 002577   000000 236100                    LDQ     0,,PR0
         2 002600   000032 772000                    QRL     26
         2 002601   000017 376007                    ANQ     15,DL
         2 002602   000012 116007                    CMPQ    10,DL
         2 002603   002605 602006 2                  TNC     s:1238+6,QL
         2 002604   002637 710000 2                  TRA     s:1246
         2 002605   002637 710000 2                  TRA     s:1246
         2 002606   002643 710000 2                  TRA     GETVALPTR1
         2 002607   002654 710000 2                  TRA     s:1252
         2 002610   002637 710000 2                  TRA     s:1246
         2 002611   002637 710000 2                  TRA     s:1246
         2 002612   002637 710000 2                  TRA     s:1246
         2 002613   002637 710000 2                  TRA     s:1246
         2 002614   002617 710000 2                  TRA     s:1240
         2 002615   002654 710000 2                  TRA     s:1252
         2 002616   002630 710000 2                  TRA     s:1244

      585     1239    3      CASE (%XSP_ASN1_CP6TYP_TEXTH);       /* Half-word size, aligned            */

      586     1240    3         IF VALLIM=0 THEN VALLIM = PTRS.VAL$->HWORD+2;

   1240  2 002617   200023 235100                    LDA     VALLIM,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:137  
         2 002620   002625 601000 2                  TNZ     s:1241

   1240  2 002621   300000 236100                    LDQ     0,,PR3
         2 002622   000022 772000                    QRL     18
         2 002623   000002 036007                    ADLQ    2,DL
         2 002624   200023 756100                    STQ     VALLIM,,AUTO

      587     1241    3         VALX = 2;

   1241  2 002625   000002 235007                    LDA     2,DL
         2 002626   200022 755100                    STA     VALX,,AUTO
         2 002627   002654 710000 2                  TRA     s:1252

      588     1242    3      CASE (%XSP_ASN1_CP6TYP_TEXT, %XSP_ASN1_CP6TYP_TEXTNB);

      589     1243    3      CASE (%XSP_ASN1_CP6TYP_TEXTFPTSIZ);  /* Size is in FPT.DAT$+1              */

      590     1244    3         IF VALLIM=0 THEN VALLIM = FPT.DATSIZ(VNODE.FPTPTR+1);

   1244  2 002630   200023 235100                    LDA     VALLIM,,AUTO
         2 002631   002654 601000 2                  TNZ     s:1252

   1244  2 002632   000002 720100                    LXL0    2,,PR0
         2 002633   000077 360003                    ANX0    63,DU
         2 002634   100016 235110                    LDA     14,X0,PR1
         2 002635   200023 755100                    STA     VALLIM,,AUTO
         2 002636   002654 710000 2                  TRA     s:1252

      591     1245    3      CASE (ELSE);

      592     1246    3         IF VNODE.SIZE=0 THEN GOTO GETVALPTR1;

   1246  2 002637   000001 236100                    LDQ     1,,PR0
         2 002640   000022 316000 3                  CANQ    18
         2 002641   002643 600000 2                  TZE     GETVALPTR1
         2 002642   002654 710000 2                  TRA     s:1252

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:138  
      593     1247    3      CASE (%XSP_ASN1_CP6TYP_TEXTC);

   1246  2 002643                       GETVALPTR1   null
      594     1248    3   GETVALPTR1:;
      595     1249    3         VALX = VALX+1;

   1249  2 002643   200022 054100                    AOS     VALX,,AUTO

      596     1250    3         IF VALLIM = 0 THEN VALLIM = BYTES(0)+1;

   1250  2 002644   200023 235100                    LDA     VALLIM,,AUTO
         2 002645   002654 601000 2                  TNZ     s:1252

   1250  2 002646   000100 101500                    MRL     fill='000'O
         2 002647   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 002650   200030 000004                    ADSC9   VALLIM+5,,AUTO           cn=0,n=4
         2 002651   200030 236100                    LDQ     VALLIM+5,,AUTO
         2 002652   000001 036007                    ADLQ    1,DL
         2 002653   200023 756100                    STQ     VALLIM,,AUTO

      597     1251    3      END;

      598     1252    2      RETURN;

   1252  2 002654   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002655   000001 702211                    TSX2  ! 1,X1

      599     1253    2   SET_LNG: ENTRY;

   1253  2 002656   200024 741300       SET_LNG      STX1  ! VALLIM+1,,AUTO

      600     1254    3      DO CASE VNODE.CP6TYP;                /* textc stuff                        */

   1254  2 002657   200010 470500                    LDP0    PTRS+4,,AUTO
         2 002660   000000 236100                    LDQ     0,,PR0
         2 002661   000032 772000                    QRL     26
         2 002662   000017 376007                    ANQ     15,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:139  
         2 002663   000012 116007                    CMPQ    10,DL
         2 002664   002666 602006 2                  TNC     s:1254+7,QL
         2 002665   002723 710000 2                  TRA     s:1263
         2 002666   002723 710000 2                  TRA     s:1263
         2 002667   002713 710000 2                  TRA     s:1260
         2 002670   002735 710000 2                  TRA     s:1265
         2 002671   002723 710000 2                  TRA     s:1263
         2 002672   002723 710000 2                  TRA     s:1263
         2 002673   002723 710000 2                  TRA     s:1263
         2 002674   002723 710000 2                  TRA     s:1263
         2 002675   002700 710000 2                  TRA     s:1256
         2 002676   002735 710000 2                  TRA     s:1265
         2 002677   002705 710000 2                  TRA     s:1258

      601     1255    3      CASE (%XSP_ASN1_CP6TYP_TEXTH);       /* Half-word size, aligned            */

      602     1256    3         PTRS.VAL$->HWORD = VALX-2;

   1256  2 002700   200022 720100                    LXL0    VALX,,AUTO
         2 002701   777776 622010                    EAX2    -2,X0
         2 002702   200007 471500                    LDP1    PTRS+3,,AUTO
         2 002703   100000 742100                    STX2    0,,PR1
         2 002704   002735 710000 2                  TRA     s:1265

      603     1257    3      CASE (%XSP_ASN1_CP6TYP_TEXTFPTSIZ);  /* Size is in FPT.DAT$+1              */

      604     1258    3         FPT.DATSIZ(VNODE.FPTPTR+1) = VALX;

   1258  2 002705   000002 720100                    LXL0    2,,PR0
         2 002706   000077 360003                    ANX0    63,DU
         2 002707   200022 235100                    LDA     VALX,,AUTO
         2 002710   200006 471500                    LDP1    PTRS+2,,AUTO
         2 002711   100016 755110                    STA     14,X0,PR1
         2 002712   002735 710000 2                  TRA     s:1265

      605     1259    3      CASE (%XSP_ASN1_CP6TYP_TEXTC);

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:140  
      606     1260    3         BYTES(0) = VALX-1;

   1260  2 002713   200022 236100                    LDQ     VALX,,AUTO
         2 002714   000001 136007                    SBLQ    1,DL
         2 002715   200030 756100                    STQ     VALLIM+5,,AUTO
         2 002716   200007 471500                    LDP1    PTRS+3,,AUTO
         2 002717   000100 101500                    MRL     fill='000'O
         2 002720   200030 000004                    ADSC9   VALLIM+5,,AUTO           cn=0,n=4
         2 002721   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 002722   002735 710000 2                  TRA     s:1265

      607     1261    3      CASE (%XSP_ASN1_CP6TYP_TEXT, %XSP_ASN1_CP6TYP_TEXTNB);

      608     1262    3      CASE (ELSE);

      609     1263    3         IF VNODE.SIZE=0 THEN BYTES(0) = VALX-1;

   1263  2 002723   000001 236100                    LDQ     1,,PR0
         2 002724   000022 316000 3                  CANQ    18
         2 002725   002735 601000 2                  TNZ     s:1265

   1263  2 002726   200022 236100                    LDQ     VALX,,AUTO
         2 002727   000001 136007                    SBLQ    1,DL
         2 002730   200030 756100                    STQ     VALLIM+5,,AUTO
         2 002731   200007 471500                    LDP1    PTRS+3,,AUTO
         2 002732   000100 101500                    MRL     fill='000'O
         2 002733   200030 000004                    ADSC9   VALLIM+5,,AUTO           cn=0,n=4
         2 002734   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      610     1264    3      END;

      611     1265    2      RETURN;

   1265  2 002735   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 002736   000001 702211                    TSX2  ! 1,X1

      612     1266    2   END PUTVALN;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:141  
      613     1267        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:142  
      614     1268        /*F* NAME: XSP$DECONSTRUCT
      615     1269             PURPOSE: Scrunches a constructed string_type item down to
      616     1270             look like a primitive one.
      617     1271        */
      618     1272    1   XSP$DECONSTRUCT: ENTRY (PARM) ALTRET;

   1272  2 002737   000000 700200 xent  XSP$DECONST* TSX0  ! X66_AUTO_1
         2 002740   000032 000001                    ZERO    26,1

      619     1273    1      PTRS = PARM.P;

   1273  2 002741   200003 470500                    LDP0    @PARM,,AUTO
         2 002742   000100 100500                    MLR     fill='000'O
         2 002743   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
         2 002744   200004 000024                    ADSC9   PTRS,,AUTO               cn=0,n=20

      620     1274    1      TAG = NODE.TYPE;

   1274  2 002745   200004 471500                    LDP1    PTRS,,AUTO
         2 002746   100000 236100                    LDQ     0,,PR1
         2 002747   000036 772000                    QRL     30
         2 002750   200014 756100                    STQ     TAG,,AUTO

      621     1275    1      IF TAG~=%XSP_ASN1_BIT_STRING THEN TAG = %XSP_ASN1_OCTET_STRING;

   1275  2 002751   000003 116007                    CMPQ    3,DL
         2 002752   002755 600000 2                  TZE     s:1276

   1275  2 002753   000004 235007                    LDA     4,DL
         2 002754   200014 755100                    STA     TAG,,AUTO

      622     1276    1      SIZE = PARM.SIZE;

   1276  2 002755   000012 235100                    LDA     10,,PR0
         2 002756   200015 755100                    STA     SIZE,,AUTO

      623     1277    1      TAGX = PARM.NXTX;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:143  

   1277  2 002757   000011 235100                    LDA     9,,PR0
         2 002760   200016 755100                    STA     TAGX,,AUTO

      624     1278    1      I = PARM.NXTX;

   1278  2 002761   000011 235100                    LDA     9,,PR0
         2 002762   200013 755100                    STA     I,,AUTO

      625     1279    1      T1 = PARM.NXTX;

   1279  2 002763   200020 755100                    STA     T1,,AUTO

      626     1280    2      DO WHILE '1'B;

      627     1281    2         VALC = %CHRS,I,8);

   1281  2 002764   200005 470500                    LDP0    PTRS+1,,AUTO
         2 002765   200013 235100                    LDA     I,,AUTO
         2 002766   040100 100505                    MLR     fill='040'O
         2 002767   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
         2 002770   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=8

      628     1282    2         I = I+2;

   1282  2 002771   000002 236007                    LDQ     2,DL
         2 002772   200013 056100                    ASQ     I,,AUTO

      629     1283    2         IF SIZE=65535 AND VAL.U0/262144=0 THEN EXIT;

   1283  2 002773   200015 235100                    LDA     SIZE,,AUTO
         2 002774   177777 115007                    CMPA    65535,DL
         2 002775   003001 601000 2                  TNZ     s:1284
         2 002776   200011 236100                    LDQ     VALC,,AUTO
         2 002777   000022 772000                    QRL     18
         2 003000   003170 600000 2                  TZE     s:1322

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:144  
      630     1284    2         IF VAL.TAG.HI_BITS OR VAL.TAG.TAG~=TAG THEN GOTO ERR_WRONG_TAG;

   1284  2 003001   200011 236100                    LDQ     VALC,,AUTO
         2 003002   700000 316003                    CANQ    -32768,DU
         2 003003   001657 601000 2                  TNZ     ERR_WRONG_TAG
         2 003004   200011 236100                    LDQ     VALC,,AUTO
         2 003005   000033 772000                    QRL     27
         2 003006   000037 376007                    ANQ     31,DL
         2 003007   200014 116100                    CMPQ    TAG,,AUTO
         2 003010   001657 601000 2                  TNZ     ERR_WRONG_TAG

      631     1285    2         LNGX = VALU(1);                   /* Length control byte                */

   1285  2 003011   200011 236100                    LDQ     VALC,,AUTO
         2 003012   000022 772000                    QRL     18
         2 003013   000777 376007                    ANQ     511,DL
         2 003014   200017 756100                    STQ     LNGX,,AUTO

      632     1286    2         IF LNGX<128 THEN;

   1286  2 003015   000200 116007                    CMPQ    128,DL
         2 003016   003073 604000 2                  TMI     s:1303

      633     1287    2         ELSE IF LNGX=128 THEN LNGX=65535;

   1287  2 003017   003023 601000 2                  TNZ     s:1289

   1287  2 003020   177777 235007                    LDA     65535,DL
         2 003021   200017 755100                    STA     LNGX,,AUTO
         2 003022   003073 710000 2                  TRA     s:1303

      634     1288    3         ELSE DO;

      635     1289    3            I = I+1;

   1289  2 003023   200013 054100                    AOS     I,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:145  
      636     1290    3            IF LNGX<130 THEN LNGX = VALU(2);

   1290  2 003024   000202 116007                    CMPQ    130,DL
         2 003025   003033 605000 2                  TPL     s:1291

   1290  2 003026   200011 236100                    LDQ     VALC,,AUTO
         2 003027   000011 772000                    QRL     9
         2 003030   000777 376007                    ANQ     511,DL
         2 003031   200017 756100                    STQ     LNGX,,AUTO
         2 003032   003073 710000 2                  TRA     s:1303

      637     1291    4            ELSE IF LNGX=130 THEN DO;

   1291  2 003033   003044 601000 2                  TNZ     s:1295

      638     1292    4               LNGX = MOD((VAL.U0+VALU(3))/2,65536);

   1292  2 003034   200011 236100                    LDQ     VALC,,AUTO
         2 003035   000777 376007                    ANQ     511,DL
         2 003036   200011 036100                    ADLQ    VALC,,AUTO
         2 003037   000001 772000                    QRL     1
         2 003040   177777 376007                    ANQ     65535,DL
         2 003041   200017 756100                    STQ     LNGX,,AUTO

      639     1293    4               I = I+1;

   1293  2 003042   200013 054100                    AOS     I,,AUTO

      640     1294    4            END; ELSE DO;

   1294  2 003043   003073 710000 2                  TRA     s:1303

      641     1295    4               LNGX = LNGX-128;

   1295  2 003044   000200 336007                    LCQ     128,DL
         2 003045   200017 056100                    ASQ     LNGX,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:146  
      642     1296    4               IF LNGX=127 THEN GOTO ERR_BAD_SIZE;

   1296  2 003046   200017 235100                    LDA     LNGX,,AUTO
         2 003047   000177 115007                    CMPA    127,DL
         2 003050   001656 600000 2                  TZE     ERR_BAD_SIZE

      643     1297    4               I = I+LNGX;

   1297  2 003051   200013 236100                    LDQ     I,,AUTO
         2 003052   200017 036100                    ADLQ    LNGX,,AUTO
         2 003053   200013 756100                    STQ     I,,AUTO

      644     1298    4               IF LNGX>4 THEN LNGX=4;

   1298  2 003054   000004 115007                    CMPA    4,DL
         2 003055   003060 604400 2                  TMOZ    s:1299

   1298  2 003056   000004 235007                    LDA     4,DL
         2 003057   200017 755100                    STA     LNGX,,AUTO

      645     1299    4               SUBSTR(VALC,8-LNGX,LNGX) = %CHRS,I-LNGX,LNGX);

   1299  2 003060   200017 136100                    SBLQ    LNGX,,AUTO
         2 003061   000000 531000                    NEG     0
         2 003062   200017 720100                    LXL0    LNGX,,AUTO
         2 003063   040145 100546                    MLR     fill='040'O
         2 003064   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
         2 003065   200013 000010                    ADSC9   I,A,AUTO                 cn=0,n=*X0

      646     1300    4               LNGX = (VAL.NU+MOD(VAL.NU,512))/2;

   1300  2 003066   200012 236100                    LDQ     VALC+1,,AUTO
         2 003067   000777 376007                    ANQ     511,DL
         2 003070   200012 036100                    ADLQ    VALC+1,,AUTO
         2 003071   000001 772000                    QRL     1
         2 003072   200017 756100                    STQ     LNGX,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:147  
      647     1301    4            END;

      648     1302    3         END;

      649     1303    3         IF VAL.TAG.CONSTRUCTED THEN DO;

   1303  2 003073   200011 236100                    LDQ     VALC,,AUTO
         2 003074   040000 316003                    CANQ    16384,DU
         2 003075   003112 600000 2                  TZE     s:1309

      650     1304    3            PARM.SIZE = LNGX;

   1304  2 003076   200003 471500                    LDP1    @PARM,,AUTO
         2 003077   200017 235100                    LDA     LNGX,,AUTO
         2 003100   100012 755100                    STA     10,,PR1

      651     1305    3            PARM.NXTX = I;

   1305  2 003101   200013 235100                    LDA     I,,AUTO
         2 003102   100011 755100                    STA     9,,PR1

      652     1306    3            CALL XSP$DECONSTRUCT (PARM) ALTRET(RETALT);

   1306  2 003103   200003 630500                    EPPR0   @PARM,,AUTO
         2 003104   000001 631400 3                  EPPR1   1
         2 003105   002737 701000 2                  TSX1    s:1272
         2 003106   001660 702000 2                  TSX2    RETALT

      653     1307    3            LNGX = PARM.SIZE;

   1307  2 003107   200003 470500                    LDP0    @PARM,,AUTO
         2 003110   000012 235100                    LDA     10,,PR0
         2 003111   200017 755100                    STA     LNGX,,AUTO

      654     1308    3         END;

      655     1309    2         IF LNGX>=65535 THEN GOTO ERR_BAD_SIZE;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:148  

   1309  2 003112   200017 235100                    LDA     LNGX,,AUTO
         2 003113   177777 115007                    CMPA    65535,DL
         2 003114   001656 605000 2                  TPL     ERR_BAD_SIZE

      656     1310    3         IF TAG=%XSP_ASN1_BIT_STRING THEN DO;

   1310  2 003115   200014 236100                    LDQ     TAG,,AUTO
         2 003116   000003 116007                    CMPQ    3,DL
         2 003117   003131 601000 2                  TNZ     s:1314

      657     1311    3            %CHRS,T1,1) = %CHRS,I,1);

   1311  2 003120   200005 470500                    LDP0    PTRS+1,,AUTO
         2 003121   200013 235100                    LDA     I,,AUTO
         2 003122   200020 236100                    LDQ     T1,,AUTO
         2 003123   040106 100505                    MLR     fill='040'O
         2 003124   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 003125   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

      658     1312    3            I = I+1; LNGX = LNGX-1;

   1312  2 003126   200013 054100                    AOS     I,,AUTO

   1312  2 003127   000001 336007                    LCQ     1,DL
         2 003130   200017 056100                    ASQ     LNGX,,AUTO

      659     1313    3         END;

      660     1314    2         %CHRS,TAGX,LNGX) = %CHRS,I,LNGX);

   1314  2 003131   200005 470500                    LDP0    PTRS+1,,AUTO
         2 003132   200017 720100                    LXL0    LNGX,,AUTO
         2 003133   200013 235100                    LDA     I,,AUTO
         2 003134   200016 236100                    LDQ     TAGX,,AUTO
         2 003135   040146 100545                    MLR     fill='040'O
         2 003136   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:149  
         2 003137   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0

      661     1315    2         TAGX = TAGX+LNGX;

   1315  2 003140   200016 236100                    LDQ     TAGX,,AUTO
         2 003141   200017 036100                    ADLQ    LNGX,,AUTO
         2 003142   200016 756100                    STQ     TAGX,,AUTO

      662     1316    2         I = I+LNGX;

   1316  2 003143   200013 236100                    LDQ     I,,AUTO
         2 003144   200017 036100                    ADLQ    LNGX,,AUTO
         2 003145   200013 756100                    STQ     I,,AUTO

      663     1317    2         IF VAL.TAG.CONSTRUCTED THEN I = PARM.TAG;

   1317  2 003146   200011 236100                    LDQ     VALC,,AUTO
         2 003147   040000 316003                    CANQ    16384,DU
         2 003150   003154 600000 2                  TZE     s:1318

   1317  2 003151   200003 471500                    LDP1    @PARM,,AUTO
         2 003152   100013 235100                    LDA     11,,PR1
         2 003153   200013 755100                    STA     I,,AUTO

      664     1318    2         IF I>=SIZE THEN EXIT;

   1318  2 003154   200013 236100                    LDQ     I,,AUTO
         2 003155   200015 116100                    CMPQ    SIZE,,AUTO
         2 003156   003170 605000 2                  TPL     s:1322

      665     1319    2         IF TAG=%XSP_ASN1_BIT_STRING AND %CHRS,T1,1)~=BINASC(0)

   1319  2 003157   200014 235100                    LDA     TAG,,AUTO
         2 003160   000003 115007                    CMPA    3,DL
         2 003161   003167 601000 2                  TNZ     s:1321
         2 003162   200020 235100                    LDA     T1,,AUTO
         2 003163   040000 106505                    CMPC    fill='040'O
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:150  
         2 003164   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 003165   000016 000001 3                  ADSC9   14                       cn=0,n=1
         2 003166   001656 601000 2                  TNZ     ERR_BAD_SIZE

      666     1320    2         THEN GOTO ERR_BAD_SIZE;
      667     1321    2      END;

   1321  2 003167   002764 710000 2                  TRA     s:1281

      668     1322    1      PARM.NXTX = T1;

   1322  2 003170   200003 471500                    LDP1    @PARM,,AUTO
         2 003171   200020 235100                    LDA     T1,,AUTO
         2 003172   100011 755100                    STA     9,,PR1

      669     1323    1      PARM.SIZE = TAGX;

   1323  2 003173   200016 236100                    LDQ     TAGX,,AUTO
         2 003174   100012 756100                    STQ     10,,PR1

      670     1324    1      PARM.TAG = I;

   1324  2 003175   200013 235100                    LDA     I,,AUTO
         2 003176   100013 755100                    STA     11,,PR1

      671     1325    1      RETURN;

   1325  2 003177   000000 702200 xent               TSX2  ! X66_ARET

      672     1326        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:151  
      673     1327    1   XSP$SEND1: ENTRY (PARM) ALTRET;

   1327  2 003200   000000 700200 xent  XSP$SEND1    TSX0  ! X66_AUTO_1
         2 003201   000032 000001                    ZERO    26,1

      674     1328
      675     1329    1      LNGX = 0;

   1329  2 003202   200017 450100                    STZ     LNGX,,AUTO

      676     1330    1      SIZE = 65535;

   1330  2 003203   177777 235007                    LDA     65535,DL
         2 003204   200015 755100                    STA     SIZE,,AUTO

      677     1331    1      PTRS = PARM.P;

   1331  2 003205   200003 470500                    LDP0    @PARM,,AUTO
         2 003206   000100 100500                    MLR     fill='000'O
         2 003207   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
         2 003210   200004 000024                    ADSC9   PTRS,,AUTO               cn=0,n=20

      678     1332    1      IF PTRS.VNODE$=ADDR(NIL) THEN PTRS.VNODE$ = PTRS.NODE$;

   1332  2 003211   200010 236100                    LDQ     PTRS+4,,AUTO
         2 003212   000000 116000 3                  CMPQ    0
         2 003213   003216 601000 2                  TNZ     s:1333

   1332  2 003214   200004 236100                    LDQ     PTRS,,AUTO
         2 003215   200010 756100                    STQ     PTRS+4,,AUTO

      679     1333    2      IF NODE.PRE.SND THEN DO;

   1333  2 003216   200004 471500                    LDP1    PTRS,,AUTO
         2 003217   100001 236100                    LDQ     1,,PR1
         2 003220   200000 316003                    CANQ    65536,DU
         2 003221   003241 600000 2                  TZE     s:1341
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:152  

      680     1334    2         PARM.USR = %XSP_ASN1_SND_PRE;

   1334  2 003222   000003 236003                    LDQ     3,DU
         2 003223   000005 552120                    STBQ    5,'20'O,PR0

      681     1335    3         CALL FPT.UENTRY$ (PARM) WHENALTRETURN DO;

   1335  2 003224   200003 630500                    EPPR0   @PARM,,AUTO
         2 003225   200006 473500                    LDP3    PTRS+2,,AUTO
         2 003226   300002 220100                    LDX0    2,,PR3
         2 003227   000001 631400 3                  EPPR1   1
         2 003230   000000 701010                    TSX1    0,X0
         2 003231   003233 702000 2                  TSX2    s:1336
         2 003232   003234 710000 2                  TRA     s:1338

      682     1336    3            ALTRETURN;

   1336  2 003233   000000 702200 xent               TSX2  ! X66_AALT

      683     1337    3         END;
      684     1338    2         PTRS.VAL$ = PARM.P.VAL$;

   1338  2 003234   200003 470500                    LDP0    @PARM,,AUTO
         2 003235   000003 236100                    LDQ     3,,PR0
         2 003236   200007 756100                    STQ     PTRS+3,,AUTO

      685     1339    2         PARM.P.VAL$ = ADDR(NIL);

   1339  2 003237   000000 236000 3                  LDQ     0
         2 003240   000003 756100                    STQ     3,,PR0

      686     1340    2      END;

      687     1341    1      IF NODE.OPTIONL AND NOT FPT.CONDITION(NODE.CONDITION)

   1341  2 003241   200004 471500                    LDP1    PTRS,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:153  
         2 003242   100001 234100                    SZN     1,,PR1
         2 003243   003255 605000 2                  TPL     s:1343
         2 003244   100000 236100                    LDQ     0,,PR1
         2 003245   000022 772000                    QRL     18
         2 003246   000177 376007                    ANQ     127,DL
         2 003247   200006 473500                    LDP3    PTRS+2,,AUTO
         2 003250   000000 066506                    CMPB    filb='0'B
         2 003251   300010 000001                    BDSC    8,Q,PR3                  by=0,bit=0,n=1
         2 003252   000002 000022 3                  BDSC    2                        by=0,bit=0,n=18
         2 003253   003255 601000 2                  TNZ     s:1343

      688     1342    1      THEN ALTRETURN;

   1342  2 003254   000000 702200 xent               TSX2  ! X66_AALT

      689     1343    2      DO CASE (NODE.TYPE);

   1343  2 003255   100000 236100                    LDQ     0,,PR1
         2 003256   000036 772000                    QRL     30
         2 003257   000062 116007                    CMPQ    50,DL
         2 003260   003262 602006 2                  TNC     s:1343+5,QL
         2 003261   004341 710000 2                  TRA     s:1518
         2 003262   004341 710000 2                  TRA     s:1518
         2 003263   004016 710000 2                  TRA     s:1448
         2 003264   003566 710000 2                  TRA     s:1397
         2 003265   003702 710000 2                  TRA     s:1425
         2 003266   004341 710000 2                  TRA     s:1518
         2 003267   004050 710000 2                  TRA     s:1458
         2 003270   004054 710000 2                  TRA     s:1462
         2 003271   004341 710000 2                  TRA     s:1518
         2 003272   004341 710000 2                  TRA     s:1518
         2 003273   004341 710000 2                  TRA     s:1518
         2 003274   004341 710000 2                  TRA     s:1518
         2 003275   004341 710000 2                  TRA     s:1518
         2 003276   004341 710000 2                  TRA     s:1518
         2 003277   004341 710000 2                  TRA     s:1518
         2 003300   004341 710000 2                  TRA     s:1518
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:154  
         2 003301   004341 710000 2                  TRA     s:1518
         2 003302   003344 710000 2                  TRA     s:1345
         2 003303   003344 710000 2                  TRA     s:1345
         2 003304   004341 710000 2                  TRA     s:1518
         2 003305   004341 710000 2                  TRA     s:1518
         2 003306   004341 710000 2                  TRA     s:1518
         2 003307   004341 710000 2                  TRA     s:1518
         2 003310   004341 710000 2                  TRA     s:1518
         2 003311   004146 710000 2                  TRA     s:1481
         2 003312   004146 710000 2                  TRA     s:1481
         2 003313   004341 710000 2                  TRA     s:1518
         2 003314   004341 710000 2                  TRA     s:1518
         2 003315   004341 710000 2                  TRA     s:1518
         2 003316   004341 710000 2                  TRA     s:1518
         2 003317   004341 710000 2                  TRA     s:1518
         2 003320   004341 710000 2                  TRA     s:1518
         2 003321   004341 710000 2                  TRA     s:1518
         2 003322   003475 710000 2                  TRA     s:1378
         2 003323   004341 710000 2                  TRA     s:1518
         2 003324   004341 710000 2                  TRA     s:1518
         2 003325   004341 710000 2                  TRA     s:1518
         2 003326   004341 710000 2                  TRA     s:1518
         2 003327   004341 710000 2                  TRA     s:1518
         2 003330   004341 710000 2                  TRA     s:1518
         2 003331   004341 710000 2                  TRA     s:1518
         2 003332   004341 710000 2                  TRA     s:1518
         2 003333   004341 710000 2                  TRA     s:1518
         2 003334   004341 710000 2                  TRA     s:1518
         2 003335   004341 710000 2                  TRA     s:1518
         2 003336   004341 710000 2                  TRA     s:1518
         2 003337   004341 710000 2                  TRA     s:1518
         2 003340   004341 710000 2                  TRA     s:1518
         2 003341   004341 710000 2                  TRA     s:1518
         2 003342   003431 710000 2                  TRA     s:1365
         2 003343   003431 710000 2                  TRA     s:1365

      690     1344    2      CASE (%XSP_ASN1_SET, %XSP_ASN1_SEQUENCE);
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:155  

      691     1345    2         IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);

   1345  2 003344   100000 236100                    LDQ     0,,PR1
         2 003345   007400 316003                    CANQ    3840,DU
         2 003346   003351 600000 2                  TZE     s:1346

   1345  2 003347   200004 236100                    LDQ     PTRS,,AUTO
         2 003350   000004 756100                    STQ     4,,PR0

      692     1346    2         IF NODE.TAG~=0 AND NOT NODE.IMPLICIT THEN CALL PUT_TAG;

   1346  2 003351   100000 720100                    LXL0    0,,PR1
         2 003352   003360 600000 2                  TZE     s:1347
         2 003353   100001 236100                    LDQ     1,,PR1
         2 003354   002000 316003                    CANQ    1024,DU
         2 003355   003360 601000 2                  TNZ     s:1347

   1346  2 003356   004521 701000 2                  TSX1    PUT_TAG
         2 003357   000000 011000                    NOP     0

      693     1347    3         DO I=0 TO NODE.NSUBNDS-1;

   1347  2 003360   200013 450100                    STZ     I,,AUTO
         2 003361   003423 710000 2                  TRA     s:1361+1

      694     1348    3            PARM.P.NODE$ = NODE.SUBND$(I);

   1348  2 003362   200004 470500                    LDP0    PTRS,,AUTO
         2 003363   200013 720100                    LXL0    I,,AUTO
         2 003364   000003 236110                    LDQ     3,X0,PR0
         2 003365   200003 471500                    LDP1    @PARM,,AUTO
         2 003366   100000 756100                    STQ     0,,PR1

      695     1349    4            IF NODE.IMPLICIT THEN DO;

   1349  2 003367   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:156  
         2 003370   002000 316003                    CANQ    1024,DU
         2 003371   003416 600000 2                  TZE     s:1360

      696     1350    4               CALL PUT_TAG;

   1350  2 003372   004521 701000 2                  TSX1    PUT_TAG
         2 003373   000000 011000                    NOP     0

      697     1351    4               PARM.IMPLICIT = '1'B;

   1351  2 003374   200003 470500                    LDP0    @PARM,,AUTO
         2 003375   400000 236003                    LDQ     -131072,DU
         2 003376   000005 256100                    ORSQ    5,,PR0

      698     1352    5               CALL XSP$SEND1 (PARM) WHENRETURN DO;

   1352  2 003377   200003 630500                    EPPR0   @PARM,,AUTO
         2 003400   000001 631400 3                  EPPR1   1
         2 003401   003200 701000 2                  TSX1    s:1327
         2 003402   003406 702000 2                  TSX2    s:1355

      699     1353    5                  CALL FIX_LNG;

   1353  2 003403   004711 701000 2                  TSX1    FIX_LNG
         2 003404   000000 011000                    NOP     0

      700     1354    5               END; WHENALTRETURN DO;

   1354  2 003405   003411 710000 2                  TRA     s:1357

      701     1355    5                  PARM.NXTX = TAGX;

   1355  2 003406   200003 470500                    LDP0    @PARM,,AUTO
         2 003407   200016 235100                    LDA     TAGX,,AUTO
         2 003410   000011 755100                    STA     9,,PR0

      702     1356    5               END;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:157  

      703     1357    4               LNGX = 0;

   1357  2 003411   200017 450100                    STZ     LNGX,,AUTO

      704     1358    4               PARM.IMPLICIT = '0'B;

   1358  2 003412   200003 470500                    LDP0    @PARM,,AUTO
         2 003413   000023 236000 3                  LDQ     19
         2 003414   000005 356100                    ANSQ    5,,PR0

      705     1359    4            END;

   1359  2 003415   003422 710000 2                  TRA     s:1361

      706     1360    3            ELSE CALL XSP$SEND1 (PARM);

   1360  2 003416   200003 630500                    EPPR0   @PARM,,AUTO
         2 003417   000001 631400 3                  EPPR1   1
         2 003420   003200 701000 2                  TSX1    s:1327
         2 003421   000000 011000                    NOP     0

      707     1361    3         END;

   1361  2 003422   200013 054100                    AOS     I,,AUTO
         2 003423   200004 470500                    LDP0    PTRS,,AUTO
         2 003424   000001 236100                    LDQ     1,,PR0
         2 003425   000077 376007                    ANQ     63,DL
         2 003426   200013 116100                    CMPQ    I,,AUTO
         2 003427   003362 605400 2                  TPNZ    s:1348

      708     1362    2         GOTO END_CHOICE;

   1362  2 003430   003546 710000 2                  TRA     END_CHOICE

      709     1363        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:158  
      710     1364    2      CASE (%XSP_ASN1_SET_OF, %XSP_ASN1_SEQUENCE_OF);

      711     1365    2         IF VNODE.VALUE_EXISTS THEN VAL.N = VNODE.VALUE(1);

   1365  2 003431   200010 473500                    LDP3    PTRS+4,,AUTO
         2 003432   300002 236100                    LDQ     2,,PR3
         2 003433   200000 316007                    CANQ    65536,DL
         2 003434   003440 600000 2                  TZE     s:1366

   1365  2 003435   300004 235100                    LDA     4,,PR3
         2 003436   200012 755100                    STA     VALC+1,,AUTO
         2 003437   003442 710000 2                  TRA     s:1367

      712     1366    2         ELSE CALL GETVALN;

   1366  2 003440   005006 701000 2                  TSX1    GETVALN
         2 003441   000000 011000                    NOP     0

      713     1367    2         IF VAL.N<=0 AND NODE.OPTIONL THEN ALTRETURN;

   1367  2 003442   200012 235100                    LDA     VALC+1,,AUTO
         2 003443   003450 605400 2                  TPNZ    s:1368
         2 003444   200004 470500                    LDP0    PTRS,,AUTO
         2 003445   000001 234100                    SZN     1,,PR0
         2 003446   003450 605000 2                  TPL     s:1368

   1367  2 003447   000000 702200 xent               TSX2  ! X66_AALT

      714     1368    2         SIZE = 65535;

   1368  2 003450   177777 236007                    LDQ     65535,DL
         2 003451   200015 756100                    STQ     SIZE,,AUTO

      715     1369    2         IF NODE.TAG~=0 THEN CALL PUT_TAG;

   1369  2 003452   200004 470500                    LDP0    PTRS,,AUTO
         2 003453   000000 720100                    LXL0    0,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:159  
         2 003454   003457 600000 2                  TZE     s:1370

   1369  2 003455   004521 701000 2                  TSX1    PUT_TAG
         2 003456   000000 011000                    NOP     0

      716     1370    3         DO WHILE VAL.N>0;

   1370  2 003457   200012 235100                    LDA     VALC+1,,AUTO
         2 003460   003474 604400 2                  TMOZ    s:1375

      717     1371    3            PARM.P.NODE$ = NODE.SUBND$(0);

   1371  2 003461   200004 470500                    LDP0    PTRS,,AUTO
         2 003462   000003 236100                    LDQ     3,,PR0
         2 003463   200003 471500                    LDP1    @PARM,,AUTO
         2 003464   100000 756100                    STQ     0,,PR1

      718     1372    3            CALL XSP$SEND1 (PARM) ALTRET (END_CHOICE);

   1372  2 003465   200003 630500                    EPPR0   @PARM,,AUTO
         2 003466   000001 631400 3                  EPPR1   1
         2 003467   003200 701000 2                  TSX1    s:1327
         2 003470   003546 702000 2                  TSX2    END_CHOICE

      719     1373    3            VAL.N = VAL.N-1;

   1373  2 003471   000001 336007                    LCQ     1,DL
         2 003472   200012 056100                    ASQ     VALC+1,,AUTO

      720     1374    3         END;

   1374  2 003473   003461 605400 2                  TPNZ    s:1371

      721     1375    2         GOTO END_CHOICE;

   1375  2 003474   003546 710000 2                  TRA     END_CHOICE

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:160  
      722     1376        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:161  
      723     1377    2      CASE (%XSP_ASN1_CHOICE);

      724     1378    2         IF NODE.TAG~=0 THEN CALL PUT_TAG;

   1378  2 003475   100000 720100                    LXL0    0,,PR1
         2 003476   003501 600000 2                  TZE     s:1379

   1378  2 003477   004521 701000 2                  TSX1    PUT_TAG
         2 003500   000000 011000                    NOP     0

      725     1379    2         IF NODE.NSUBNDS>1 AND NODE.TAGS THEN CALL GETVALN;

   1379  2 003501   200004 470500                    LDP0    PTRS,,AUTO
         2 003502   000001 236100                    LDQ     1,,PR0
         2 003503   000077 376007                    ANQ     63,DL
         2 003504   000002 116007                    CMPQ    2,DL
         2 003505   003514 602000 2                  TNC     s:1381
         2 003506   000001 236100                    LDQ     1,,PR0
         2 003507   000200 316003                    CANQ    128,DU
         2 003510   003514 600000 2                  TZE     s:1381

   1379  2 003511   005006 701000 2                  TSX1    GETVALN
         2 003512   000000 011000                    NOP     0
         2 003513   003523 710000 2                  TRA     s:1384

      726     1380    3         ELSE DO;

      727     1381    3            VAL.N=0;

   1381  2 003514   200012 450100                    STZ     VALC+1,,AUTO

      728     1382    3            IF NODE.CP6TYP~=0 THEN PARM.P.VNODE$ = ADDR(NODE);

   1382  2 003515   000000 236100                    LDQ     0,,PR0
         2 003516   007400 316003                    CANQ    3840,DU
         2 003517   003523 600000 2                  TZE     s:1384

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:162  
   1382  2 003520   200004 236100                    LDQ     PTRS,,AUTO
         2 003521   200003 471500                    LDP1    @PARM,,AUTO
         2 003522   100004 756100                    STQ     4,,PR1

      729     1383    3         END;

      730     1384    3         DO I=VAL.N TO NODE.NSUBNDS-1;

   1384  2 003523   200012 235100                    LDA     VALC+1,,AUTO
         2 003524   200013 755100                    STA     I,,AUTO
         2 003525   003541 710000 2                  TRA     s:1389+1

      731     1385    3            PARM.P.NODE$ = NODE.SUBND$(I);

   1385  2 003526   200004 470500                    LDP0    PTRS,,AUTO
         2 003527   200013 720100                    LXL0    I,,AUTO
         2 003530   000003 236110                    LDQ     3,X0,PR0
         2 003531   200003 471500                    LDP1    @PARM,,AUTO
         2 003532   100000 756100                    STQ     0,,PR1

      732     1386    4            CALL XSP$SEND1 (PARM) WHENRETURN DO;

   1386  2 003533   200003 630500                    EPPR0   @PARM,,AUTO
         2 003534   000001 631400 3                  EPPR1   1
         2 003535   003200 701000 2                  TSX1    s:1327
         2 003536   003540 702000 2                  TSX2    s:1389

      733     1387    4               GOTO END_CHOICE;

   1387  2 003537   003546 710000 2                  TRA     END_CHOICE

      734     1388    4            END;
      735     1389    3         END;

   1389  2 003540   200013 054100                    AOS     I,,AUTO
         2 003541   200004 470500                    LDP0    PTRS,,AUTO
         2 003542   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:163  
         2 003543   000077 376007                    ANQ     63,DL
         2 003544   200013 116100                    CMPQ    I,,AUTO
         2 003545   003526 605400 2                  TPNZ    s:1385

   1385  2 003546                       END_CHOICE   null
      736     1390    2   END_CHOICE:;
      737     1391    2         IF LNGX~=0 THEN CALL FIX_LNG;

   1391  2 003546   200017 235100                    LDA     LNGX,,AUTO
         2 003547   003552 600000 2                  TZE     s:1392

   1391  2 003550   004711 701000 2                  TSX1    FIX_LNG
         2 003551   000000 011000                    NOP     0

      738     1392    2         IF PARM.P.VNODE$~=ADDR(NIL)

   1392  2 003552   200003 470500                    LDP0    @PARM,,AUTO
         2 003553   000004 236100                    LDQ     4,,PR0
         2 003554   000000 116000 3                  CMPQ    0
         2 003555   004366 600000 2                  TZE     s:1524

      739     1393    2         THEN IF PTRS.VNODE$~=PTRS.NODE$ THEN PARM.P.VNODE$ = PTRS.VNODE$;

   1393  2 003556   200010 236100                    LDQ     PTRS+4,,AUTO
         2 003557   200004 116100                    CMPQ    PTRS,,AUTO
         2 003560   003563 600000 2                  TZE     s:1394

   1393  2 003561   000004 756100                    STQ     4,,PR0
         2 003562   004366 710000 2                  TRA     s:1524

      740     1394    2         ELSE PARM.P.VNODE$ = ADDR(NIL);

   1394  2 003563   000000 236000 3                  LDQ     0
         2 003564   000004 756100                    STQ     4,,PR0
         2 003565   004366 710000 2                  TRA     s:1524

      741     1395        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:164  
      742     1396    2      CASE (%XSP_ASN1_INTEGER);

      743     1397    2         CALL GETVALN;

   1397  2 003566   005006 701000 2                  TSX1    GETVALN
         2 003567   000000 011000                    NOP     0

      744     1398    2         IF NODE.DEFAULT_EXISTS AND VAL.N=NODE.DEFAULT THEN RETURN;

   1398  2 003570   200004 470500                    LDP0    PTRS,,AUTO
         2 003571   000002 236100                    LDQ     2,,PR0
         2 003572   400000 316007                    CANQ    -131072,DL
         2 003573   003600 600000 2                  TZE     s:1399
         2 003574   200012 236100                    LDQ     VALC+1,,AUTO
         2 003575   000003 116100                    CMPQ    3,,PR0
         2 003576   003600 601000 2                  TNZ     s:1399

   1398  2 003577   000000 702200 xent               TSX2  ! X66_ARET

      745     1399    2         IF VAL.N0<0 THEN VAL.B2=~VAL.B2;

   1399  2 003600   200011 235100                    LDA     VALC,,AUTO
         2 003601   003605 605000 2                  TPL     s:1400

   1399  2 003602   200012 236100                    LDQ     VALC+1,,AUTO
         2 003603   000005 676000 3                  ERQ     5
         2 003604   200012 756100                    STQ     VALC+1,,AUTO

      746     1400    2         SIZE = 1;

   1400  2 003605   000001 236007                    LDQ     1,DL
         2 003606   200015 756100                    STQ     SIZE,,AUTO

      747     1401    3         IF VAL.NU>127 THEN DO;

   1401  2 003607   200012 235100                    LDA     VALC+1,,AUTO
         2 003610   000200 115007                    CMPA    128,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:165  
         2 003611   003624 602000 2                  TNC     s:1410

      748     1402    3            SIZE = SIZE+1;

   1402  2 003612   200015 054100                    AOS     SIZE,,AUTO

      749     1403    3            IF VAL.NU<128*256 THEN EXIT;

   1403  2 003613   100000 115007                    CMPA    32768,DL
         2 003614   003624 602000 2                  TNC     s:1410

      750     1404    3            SIZE = SIZE+1;

   1404  2 003615   200015 054100                    AOS     SIZE,,AUTO

      751     1405    3            IF VAL.NU<128*256*256 THEN EXIT;

   1405  2 003616   000040 115003                    CMPA    32,DU
         2 003617   003624 602000 2                  TNC     s:1410

      752     1406    3            SIZE = SIZE+1;

   1406  2 003620   200015 054100                    AOS     SIZE,,AUTO

      753     1407    3            IF VAL.NU<128*256*256*256 THEN EXIT;

   1407  2 003621   020000 115003                    CMPA    8192,DU
         2 003622   003624 602000 2                  TNC     s:1410

      754     1408    3            SIZE = SIZE+1;

   1408  2 003623   200015 054100                    AOS     SIZE,,AUTO

      755     1409    3         END;

      756     1410    2         IF VAL.N0<0 THEN VAL.B2=~VAL.B2;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:166  
   1410  2 003624   200011 235100                    LDA     VALC,,AUTO
         2 003625   003631 605000 2                  TPL     s:1411

   1410  2 003626   200012 236100                    LDQ     VALC+1,,AUTO
         2 003627   000005 676000 3                  ERQ     5
         2 003630   200012 756100                    STQ     VALC+1,,AUTO

      757     1411    2         CALL PUT_TAG;

   1411  2 003631   004521 701000 2                  TSX1    PUT_TAG
         2 003632   000000 011000                    NOP     0

      758     1412    2         IF SIZE<2 THEN GOTO INT_1;

   1412  2 003633   200015 235100                    LDA     SIZE,,AUTO
         2 003634   000002 115007                    CMPA    2,DL
         2 003635   003663 604000 2                  TMI     INT_1

      759     1413    2         IF SIZE=2 THEN GOTO INT_2;

   1413  2 003636   003657 600000 2                  TZE     INT_2

      760     1414    2         IF SIZE<4 THEN GOTO INT_3;

   1414  2 003637   000004 115007                    CMPA    4,DL
         2 003640   003653 604000 2                  TMI     INT_3

      761     1415    2         IF SIZE=4 THEN GOTO INT_4;

   1415  2 003641   003647 600000 2                  TZE     INT_4

      762     1416    2         VALU(3)=VALP(4);

   1416  2 003642   200011 235100                    LDA     VALC,,AUTO
         2 003643   200012 236100                    LDQ     VALC+1,,AUTO
         2 003644   000040 773000                    LRL     32
         2 003645   000377 376007                    ANQ     255,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:167  
         2 003646   200011 552104                    STBQ    VALC,'04'O,AUTO

      763     1417    2   INT_4:VALU(4)=VALP(5);

   1417  2 003647   200012 236100       INT_4        LDQ     VALC+1,,AUTO
         2 003650   037700 376003                    ANQ     16320,DU
         2 003651   000003 736000                    QLS     3
         2 003652   200012 552140                    STBQ    VALC+1,'40'O,AUTO

      764     1418    2   INT_3:VALU(5)=VALP(6);

   1418  2 003653   200012 236100       INT_3        LDQ     VALC+1,,AUTO
         2 003654   000024 376000 3                  ANQ     20
         2 003655   000002 736000                    QLS     2
         2 003656   200012 552120                    STBQ    VALC+1,'20'O,AUTO

      765     1419    2   INT_2:VALU(6)=VALP(7);

   1419  2 003657   200012 236100       INT_2        LDQ     VALC+1,,AUTO
         2 003660   177400 376007                    ANQ     65280,DL
         2 003661   000001 736000                    QLS     1
         2 003662   200012 552110                    STBQ    VALC+1,'10'O,AUTO

      766     1420    2   INT_1:VALU(7)=VALP(8);

   1420  2 003663   200012 236100       INT_1        LDQ     VALC+1,,AUTO
         2 003664   000377 376007                    ANQ     255,DL
         2 003665   200012 552104                    STBQ    VALC+1,'04'O,AUTO

      767     1421    2         %CHRS,PARM.NXTX,SIZE) = SUBSTR(VALC,8-SIZE,SIZE);

   1421  2 003666   200003 470500                    LDP0    @PARM,,AUTO
         2 003667   000011 235100                    LDA     9,,PR0
         2 003670   200015 336100                    LCQ     SIZE,,AUTO
         2 003671   200015 720100                    LXL0    SIZE,,AUTO
         2 003672   200005 471500                    LDP1    PTRS+1,,AUTO
         2 003673   040145 100546                    MLR     fill='040'O
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:168  
         2 003674   200013 000010                    ADSC9   I,Q,AUTO                 cn=0,n=*X0
         2 003675   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0

      768     1422    2         PARM.NXTX = PARM.NXTX+SIZE;

   1422  2 003676   000011 236100                    LDQ     9,,PR0
         2 003677   200015 036100                    ADLQ    SIZE,,AUTO
         2 003700   000011 756100                    STQ     9,,PR0
         2 003701   004366 710000 2                  TRA     s:1524

      769     1423        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:169  
      770     1424    2      CASE (%XSP_ASN1_BIT_STRING);

      771     1425    2         CALL GETVALB;

   1425  2 003702   005237 701000 2                  TSX1    GETVALB
         2 003703   000000 011000                    NOP     0

      772     1426    2         IF NODE.DEFAULT_EXISTS AND VAL.B=NODE.DEFAULTB THEN RETURN;

   1426  2 003704   200004 470500                    LDP0    PTRS,,AUTO
         2 003705   000002 236100                    LDQ     2,,PR0
         2 003706   400000 316007                    CANQ    -131072,DL
         2 003707   003714 600000 2                  TZE     s:1427
         2 003710   200011 236100                    LDQ     VALC,,AUTO
         2 003711   000003 116100                    CMPQ    3,,PR0
         2 003712   003714 601000 2                  TNZ     s:1427

   1426  2 003713   000000 702200 xent               TSX2  ! X66_ARET

      773     1427    2         I = MOD(SIZEU+7,8);

   1427  2 003714   200015 236100                    LDQ     SIZE,,AUTO
         2 003715   000007 036007                    ADLQ    7,DL
         2 003716   000007 376007                    ANQ     7,DL
         2 003717   200013 756100                    STQ     I,,AUTO

      774     1428    2         SIZE = 1 + (SIZEU+7)/8;

   1428  2 003720   200015 236100                    LDQ     SIZE,,AUTO
         2 003721   000007 036007                    ADLQ    7,DL
         2 003722   000003 772000                    QRL     3
         2 003723   000001 036007                    ADLQ    1,DL
         2 003724   200015 756100                    STQ     SIZE,,AUTO

      775     1429    2         CALL PUT_TAG;

   1429  2 003725   004521 701000 2                  TSX1    PUT_TAG
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:170  
         2 003726   000000 011000                    NOP     0

      776     1430    2         IF SIZE<3 THEN GOTO BIT_1;

   1430  2 003727   200015 235100                    LDA     SIZE,,AUTO
         2 003730   000003 115007                    CMPA    3,DL
         2 003731   003773 604000 2                  TMI     BIT_1

      777     1431    2         IF SIZE=3 THEN GOTO BIT_2;

   1431  2 003732   003767 600000 2                  TZE     BIT_2

      778     1432    2         IF SIZE<5 THEN GOTO BIT_3;

   1432  2 003733   000005 115007                    CMPA    5,DL
         2 003734   003763 604000 2                  TMI     BIT_3

      779     1433    2         IF SIZE=5 THEN GOTO BIT_4;

   1433  2 003735   003757 600000 2                  TZE     BIT_4

      780     1434    2         IF SIZE<7 THEN GOTO BIT_5;

   1434  2 003736   000007 115007                    CMPA    7,DL
         2 003737   003751 604000 2                  TMI     BIT_5

      781     1435    2         IF SIZE=7 THEN GOTO BIT_6;

   1435  2 003740   003745 600000 2                  TZE     BIT_6

      782     1436    2         VALU(7)=VALP(6);

   1436  2 003741   200012 236100                    LDQ     VALC+1,,AUTO
         2 003742   000024 376000 3                  ANQ     20
         2 003743   000020 772000                    QRL     16
         2 003744   200012 552104                    STBQ    VALC+1,'04'O,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:171  
      783     1437    2   BIT_6:VALU(6)=VALP(5);

   1437  2 003745   200012 236100       BIT_6        LDQ     VALC+1,,AUTO
         2 003746   037700 376003                    ANQ     16320,DU
         2 003747   000017 772000                    QRL     15
         2 003750   200012 552110                    STBQ    VALC+1,'10'O,AUTO

      784     1438    2   BIT_5:VALU(5)=VALP(4);

   1438  2 003751   200011 235100       BIT_5        LDA     VALC,,AUTO
         2 003752   200012 236100                    LDQ     VALC+1,,AUTO
         2 003753   000040 773000                    LRL     32
         2 003754   000377 376007                    ANQ     255,DL
         2 003755   000022 736000                    QLS     18
         2 003756   200012 552120                    STBQ    VALC+1,'20'O,AUTO

      785     1439    2   BIT_4:VALU(4)=VALP(3);

   1439  2 003757   200011 236100       BIT_4        LDQ     VALC,,AUTO
         2 003760   007760 376007                    ANQ     4080,DL
         2 003761   000027 736000                    QLS     23
         2 003762   200012 552140                    STBQ    VALC+1,'40'O,AUTO

      786     1440    2   BIT_3:VALU(3)=VALP(2);

   1440  2 003763   200011 236100       BIT_3        LDQ     VALC,,AUTO
         2 003764   000025 376000 3                  ANQ     21
         2 003765   000014 772000                    QRL     12
         2 003766   200011 552104                    STBQ    VALC,'04'O,AUTO

      787     1441    2   BIT_2:VALU(2)=VALP(1);

   1441  2 003767   200011 236100       BIT_2        LDQ     VALC,,AUTO
         2 003770   001774 376003                    ANQ     1020,DU
         2 003771   000013 772000                    QRL     11
         2 003772   200011 552110                    STBQ    VALC,'10'O,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:172  
      788     1442    2   BIT_1:VALU(1)=VALP(0);

   1442  2 003773   200011 236100       BIT_1        LDQ     VALC,,AUTO
         2 003774   776000 376003                    ANQ     -1024,DU
         2 003775   000012 772000                    QRL     10
         2 003776   200011 552120                    STBQ    VALC,'20'O,AUTO

      789     1443    2         VALU(0) = 7-I;

   1443  2 003777   000007 236007                    LDQ     7,DL
         2 004000   200013 136100                    SBLQ    I,,AUTO
         2 004001   000033 736000                    QLS     27
         2 004002   200011 552140                    STBQ    VALC,'40'O,AUTO

      790     1444    2         %CHRS,PARM.NXTX,SIZE) = SUBSTR(VALC,0,SIZE);

   1444  2 004003   200003 470500                    LDP0    @PARM,,AUTO
         2 004004   000011 235100                    LDA     9,,PR0
         2 004005   200015 720100                    LXL0    SIZE,,AUTO
         2 004006   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004007   040145 100540                    MLR     fill='040'O
         2 004010   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=*X0
         2 004011   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0

      791     1445    2         PARM.NXTX = PARM.NXTX+SIZE;

   1445  2 004012   000011 236100                    LDQ     9,,PR0
         2 004013   200015 036100                    ADLQ    SIZE,,AUTO
         2 004014   000011 756100                    STQ     9,,PR0
         2 004015   004366 710000 2                  TRA     s:1524

      792     1446        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:173  
      793     1447    2      CASE (%XSP_ASN1_BOOLEAN);

      794     1448    2         CALL GETVALB;

   1448  2 004016   005237 701000 2                  TSX1    GETVALB
         2 004017   000000 011000                    NOP     0

      795     1449    2         SIZE = 1;

   1449  2 004020   000001 235007                    LDA     1,DL
         2 004021   200015 755100                    STA     SIZE,,AUTO

      796     1450    2         IF VAL.B THEN VAL.B = '1'B;

   1450  2 004022   200011 236100                    LDQ     VALC,,AUTO
         2 004023   004026 600000 2                  TZE     s:1451

   1450  2 004024   400000 236003                    LDQ     -131072,DU
         2 004025   200011 756100                    STQ     VALC,,AUTO

      797     1451    2         IF NODE.DEFAULT_EXISTS AND VAL.B=NODE.DEFAULTB

   1451  2 004026   200004 470500                    LDP0    PTRS,,AUTO
         2 004027   000002 236100                    LDQ     2,,PR0
         2 004030   400000 316007                    CANQ    -131072,DL
         2 004031   004036 600000 2                  TZE     s:1453
         2 004032   200011 236100                    LDQ     VALC,,AUTO
         2 004033   000003 116100                    CMPQ    3,,PR0
         2 004034   004036 601000 2                  TNZ     s:1453

      798     1452    2         THEN RETURN;

   1452  2 004035   000000 702200 xent               TSX2  ! X66_ARET

      799     1453    2         CALL PUT_TAG;

   1453  2 004036   004521 701000 2                  TSX1    PUT_TAG
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:174  
         2 004037   000000 011000                    NOP     0

      800     1454    2         %CHRS,PARM.NXTX,1) = SUBSTR(VALC,0,1);

   1454  2 004040   200003 470500                    LDP0    @PARM,,AUTO
         2 004041   000011 235100                    LDA     9,,PR0
         2 004042   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004043   040105 100500                    MLR     fill='040'O
         2 004044   200011 000001                    ADSC9   VALC,,AUTO               cn=0,n=1
         2 004045   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      801     1455    2         PARM.NXTX = PARM.NXTX+1;

   1455  2 004046   000011 054100                    AOS     9,,PR0
         2 004047   004366 710000 2                  TRA     s:1524

      802     1456        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:175  
      803     1457    2      CASE (%XSP_ASN1_NULL);

      804     1458    2         SIZE = 0;

   1458  2 004050   200015 450100                    STZ     SIZE,,AUTO

      805     1459    2         CALL PUT_TAG;

   1459  2 004051   004521 701000 2                  TSX1    PUT_TAG
         2 004052   000000 011000                    NOP     0
         2 004053   004366 710000 2                  TRA     s:1524

      806     1460        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:176  
      807     1461    2      CASE (%XSP_ASN1_OBJECT_IDENTIFIER);

      808     1462    2         CALL GETVALTXT;

   1462  2 004054   005370 701000 2                  TSX1    GETVALTXT
         2 004055   000000 011000                    NOP     0

      809     1463    2         IF SIZE<2 AND NODE.OPTIONL THEN ALTRETURN;

   1463  2 004056   200015 235100                    LDA     SIZE,,AUTO
         2 004057   000002 115007                    CMPA    2,DL
         2 004060   004065 605000 2                  TPL     s:1464
         2 004061   200004 470500                    LDP0    PTRS,,AUTO
         2 004062   000001 234100                    SZN     1,,PR0
         2 004063   004065 605000 2                  TPL     s:1464

   1463  2 004064   000000 702200 xent               TSX2  ! X66_AALT

      810     1464    2         CALL PUT_TAG;

   1464  2 004065   004521 701000 2                  TSX1    PUT_TAG
         2 004066   000000 011000                    NOP     0

      811     1465    2         VAL.N = 40*(ASCBIN(SUBSTR(VALTXT,0,1))-ASCBIN('0'));

   1465  2 004067   200007 470500                    LDP0    PTRS+3,,AUTO
         2 004070   000100 101500                    MRL     fill='000'O
         2 004071   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 004072   200030 000004                    ADSC9   VALLIM+5,,AUTO           cn=0,n=4
         2 004073   200030 236100                    LDQ     VALLIM+5,,AUTO
         2 004074   000050 402007                    MPY     40,DL
         2 004075   003600 136007                    SBLQ    1920,DL
         2 004076   200012 756100                    STQ     VALC+1,,AUTO

      812     1466    2         PTRS.VAL$ = PINCRC(PTRS.VAL$,2);

   1466  2 004077   200007 236100                    LDQ     PTRS+3,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:177  
         2 004100   400000 036007                    ADLQ    -131072,DL
         2 004101   200007 756100                    STQ     PTRS+3,,AUTO

      813     1467    2         SIZE = SIZE-2;

   1467  2 004102   000002 336007                    LCQ     2,DL
         2 004103   200015 056100                    ASQ     SIZE,,AUTO

      814     1468    3         DO UNTIL SIZE<=0;

      815     1469    3            CALL INDEX(I,' ',VALTXT,,'017'O);

   1469  2 004104   200007 470500                    LDP0    PTRS+3,,AUTO
         2 004105   200015 720100                    LXL0    SIZE,,AUTO
         2 004106   017000 124540                    SCM     mask='017'O
         2 004107   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 004110   000012 000001 3                  ADSC9   10                       cn=0,n=1
         2 004111   200013 000100                    ARG     I,,AUTO

      816     1470    3            IF I=0 THEN EXIT;

   1470  2 004112   200013 235100                    LDA     I,,AUTO
         2 004113   004143 600000 2                  TZE     s:1478

      817     1471    3            CALL CHARBIN(TAG,SUBSTR(VALTXT,0,I));

   1471  2 004114   000000 621005                    EAX1    0,AL
         2 004115   000100 305540                    DTB
         2 004116   000000 030011                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X1
         2 004117   200030 000010                    NDSC9   VALLIM+5,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         2 004120   200031 235100                    LDA     VALLIM+6,,AUTO
         2 004121   200014 755100                    STA     TAG,,AUTO

      818     1472    3            TAG=TAG+VAL.N;

   1472  2 004122   200014 236100                    LDQ     TAG,,AUTO
         2 004123   200012 036100                    ADLQ    VALC+1,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:178  
         2 004124   200014 756100                    STQ     TAG,,AUTO

      819     1473    3            SIZE = SIZE-I-1;

   1473  2 004125   200015 236100                    LDQ     SIZE,,AUTO
         2 004126   200013 136100                    SBLQ    I,,AUTO
         2 004127   000001 136007                    SBLQ    1,DL
         2 004130   200015 756100                    STQ     SIZE,,AUTO

      820     1474    3            PTRS.VAL$ = PINCRC(PTRS.VAL$,I+1);

   1474  2 004131   200013 236100                    LDQ     I,,AUTO
         2 004132   000020 736000                    QLS     16
         2 004133   200000 036007                    ADLQ    65536,DL
         2 004134   200007 036100                    ADLQ    PTRS+3,,AUTO
         2 004135   200007 756100                    STQ     PTRS+3,,AUTO

      821     1475    3            CALL PUT_7S;

   1475  2 004136   004417 701000 2                  TSX1    PUT_7S
         2 004137   000000 011000                    NOP     0

      822     1476    3            VAL.N = 0;

   1476  2 004140   200012 450100                    STZ     VALC+1,,AUTO

      823     1477    3         END;

   1477  2 004141   200015 235100                    LDA     SIZE,,AUTO
         2 004142   004104 605400 2                  TPNZ    s:1469

      824     1478    2         CALL FIX_LNG;

   1478  2 004143   004711 701000 2                  TSX1    FIX_LNG
         2 004144   000000 011000                    NOP     0
         2 004145   004366 710000 2                  TRA     s:1524

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:179  
      825     1479        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:180  
      826     1480    2      CASE (%XSP_ASN1_GENERALIZED_TIME, %XSP_ASN1_UTC_TIME);

      827     1481    2         CALL GETVALN;

   1481  2 004146   005006 701000 2                  TSX1    GETVALN
         2 004147   000000 011000                    NOP     0

      828     1482    2         IF NODE.TYPE=%XSP_ASN1_UTC_TIME THEN SIZE = 17;

   1482  2 004150   200004 470500                    LDP0    PTRS,,AUTO
         2 004151   000000 236100                    LDQ     0,,PR0
         2 004152   770000 376003                    ANQ     -4096,DU
         2 004153   270000 116003                    CMPQ    94208,DU
         2 004154   004160 601000 2                  TNZ     s:1483

   1482  2 004155   000021 235007                    LDA     17,DL
         2 004156   200015 755100                    STA     SIZE,,AUTO
         2 004157   004162 710000 2                  TRA     s:1484

      829     1483    2         ELSE SIZE = 22;

   1483  2 004160   000026 235007                    LDA     22,DL
         2 004161   200015 755100                    STA     SIZE,,AUTO

      830     1484    2         CALL PUT_TAG;

   1484  2 004162   004521 701000 2                  TSX1    PUT_TAG
         2 004163   000000 011000                    NOP     0

      831     1485    3         IF SIZE=22 THEN DO;

   1485  2 004164   200015 235100                    LDA     SIZE,,AUTO
         2 004165   000026 115007                    CMPA    22,DL
         2 004166   004177 601000 2                  TNZ     s:1490

      832     1486    3            %CHRS,PARM.NXTX,2) = '19';

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:181  
   1486  2 004167   200003 470500                    LDP0    @PARM,,AUTO
         2 004170   000011 235100                    LDA     9,,PR0
         2 004171   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004172   040105 100400                    MLR     fill='040'O
         2 004173   000103 000002 0                  ADSC9   NSIGNS+5                 cn=0,n=2
         2 004174   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2

      833     1487    3            PARM.NXTX = PARM.NXTX+2;

   1487  2 004175   000002 236007                    LDQ     2,DL
         2 004176   000011 056100                    ASQ     9,,PR0

      834     1488    3         END;

      835     1489        %EQU TIC_DAY = 6000*60*24;
      836     1490    2         VAL.N0 = VAL.NU/%TIC_DAY;         /* Days since 1978                    */

   1490  2 004177   200012 236100                    LDQ     VALC+1,,AUTO
         2 004200   000001 772000                    QRL     1
         2 004201   000026 506000 3                  DIV     22
         2 004202   200011 756100                    STQ     VALC,,AUTO

      837     1491    2         IF VAL.N0<3*365+1 THEN I = VAL.N0/365;

   1491  2 004203   002110 116007                    CMPQ    1096,DL
         2 004204   004210 605000 2                  TPL     s:1492

   1491  2 004205   000555 506007                    DIV     365,DL
         2 004206   200013 756100                    STQ     I,,AUTO
         2 004207   004215 710000 2                  TRA     s:1493

      838     1492    2         ELSE I = (VAL.N0-3*356+1)*4/(365*4+1)+3;

   1492  2 004210   000002 736000                    QLS     2
         2 004211   010254 136007                    SBLQ    4268,DL
         2 004212   002665 506007                    DIV     1461,DL
         2 004213   000003 036007                    ADLQ    3,DL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:182  
         2 004214   200013 756100                    STQ     I,,AUTO

      839     1493    2         VAL.NU = VAL.NU-VAL.N0*%TIC_DAY;

   1493  2 004215   000000 236003                    LDQ     0,DU
         2 004216   200011 136100                    SBLQ    VALC,,AUTO
         2 004217   000027 402000 3                  MPY     23
         2 004220   200012 036100                    ADLQ    VALC+1,,AUTO
         2 004221   200012 756100                    STQ     VALC+1,,AUTO

      840     1494    2         VAL.N0 = VAL.N0-YEARS(I);

   1494  2 004222   200013 720100                    LXL0    I,,AUTO
         2 004223   200011 236100                    LDQ     VALC,,AUTO
         2 004224   000000 136010 0                  SBLQ    YEARS,X0
         2 004225   200011 756100                    STQ     VALC,,AUTO

      841     1495    2         IF VAL.N0>=31+28 AND MOD(I,4)~=2 THEN VAL.N0 = VAL.N0+1;

   1495  2 004226   000073 116007                    CMPQ    59,DL
         2 004227   004236 604000 2                  TMI     s:1496
         2 004230   200013 236100                    LDQ     I,,AUTO
         2 004231   000004 506007                    DIV     4,DL
         2 004232   000044 733000                    LRS     36
         2 004233   000002 116007                    CMPQ    2,DL
         2 004234   004236 600000 2                  TZE     s:1496

   1495  2 004235   200011 054100                    AOS     VALC,,AUTO

      842     1496    2         I = I+78; CALL PUT_2;

   1496  2 004236   000116 236007                    LDQ     78,DL
         2 004237   200013 056100                    ASQ     I,,AUTO

   1496  2 004240   004404 701000 2                  TSX1    PUT_2
         2 004241   000000 011000                    NOP     0

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:183  
      843     1497    2         I = VAL.N0/29;

   1497  2 004242   200011 236100                    LDQ     VALC,,AUTO
         2 004243   000035 506007                    DIV     29,DL
         2 004244   200013 756100                    STQ     I,,AUTO

      844     1498    2         IF VAL.N0>=MONTHS(I) THEN I = I+1;

   1498  2 004245   000000 620006                    EAX0    0,QL
         2 004246   200011 236100                    LDQ     VALC,,AUTO
         2 004247   004253 604000 2                  TMI     s:1499
         2 004250   000053 116010 0                  CMPQ    MONTHS,X0
         2 004251   004253 602000 2                  TNC     s:1499

   1498  2 004252   200013 054100                    AOS     I,,AUTO

      845     1499    2         CALL PUT_2;

   1499  2 004253   004404 701000 2                  TSX1    PUT_2
         2 004254   000000 011000                    NOP     0

      846     1500    2         I = VAL.N0-MONTHS(I-1)+1;         /* Day of month                       */

   1500  2 004255   200013 720100                    LXL0    I,,AUTO
         2 004256   200011 236100                    LDQ     VALC,,AUTO
         2 004257   000052 136010 0                  SBLQ    YEARS+42,X0
         2 004260   000001 036007                    ADLQ    1,DL
         2 004261   200013 756100                    STQ     I,,AUTO

      847     1501    2         CALL PUT_2;

   1501  2 004262   004404 701000 2                  TSX1    PUT_2
         2 004263   000000 011000                    NOP     0

      848     1502    2         I = VAL.N/(6000*60); VAL.N = MOD(VAL.N,6000*60); /* Hours               */

   1502  2 004264   200012 236100                    LDQ     VALC+1,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:184  
         2 004265   000030 506000 3                  DIV     24
         2 004266   200013 756100                    STQ     I,,AUTO

   1502  2 004267   200012 236100                    LDQ     VALC+1,,AUTO
         2 004270   000030 506000 3                  DIV     24
         2 004271   200012 755100                    STA     VALC+1,,AUTO

      849     1503    2         CALL PUT_2;

   1503  2 004272   004404 701000 2                  TSX1    PUT_2
         2 004273   000000 011000                    NOP     0

      850     1504    2         I = VAL.N/6000; VAL.N = MOD(VAL.N,6000); /* Minutes                     */

   1504  2 004274   200012 236100                    LDQ     VALC+1,,AUTO
         2 004275   013560 506007                    DIV     6000,DL
         2 004276   200013 756100                    STQ     I,,AUTO

   1504  2 004277   200012 236100                    LDQ     VALC+1,,AUTO
         2 004300   013560 506007                    DIV     6000,DL
         2 004301   200012 755100                    STA     VALC+1,,AUTO

      851     1505    2         CALL PUT_2;

   1505  2 004302   004404 701000 2                  TSX1    PUT_2
         2 004303   000000 011000                    NOP     0

      852     1506    2         I = VAL.N/100;                    /* SECONDS                            */

   1506  2 004304   200012 236100                    LDQ     VALC+1,,AUTO
         2 004305   000144 506007                    DIV     100,DL
         2 004306   200013 756100                    STQ     I,,AUTO

      853     1507    2         CALL PUT_2;

   1507  2 004307   004404 701000 2                  TSX1    PUT_2
         2 004310   000000 011000                    NOP     0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:185  

      854     1508    3         IF SIZE=22 THEN DO;

   1508  2 004311   200015 235100                    LDA     SIZE,,AUTO
         2 004312   000026 115007                    CMPA    22,DL
         2 004313   004330 601000 2                  TNZ     s:1514

      855     1509    3            %CHRS,PARM.NXTX,1) = '.';

   1509  2 004314   200003 470500                    LDP0    @PARM,,AUTO
         2 004315   000011 235100                    LDA     9,,PR0
         2 004316   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004317   040105 100400                    MLR     fill='040'O
         2 004320   000031 000001 3                  ADSC9   25                       cn=0,n=1
         2 004321   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      856     1510    3            PARM.NXTX = PARM.NXTX+1;

   1510  2 004322   000011 054100                    AOS     9,,PR0

      857     1511    3            I = MOD(VAL.N,100);

   1511  2 004323   200012 236100                    LDQ     VALC+1,,AUTO
         2 004324   000144 506007                    DIV     100,DL
         2 004325   200013 755100                    STA     I,,AUTO

      858     1512    3            CALL PUT_2;

   1512  2 004326   004404 701000 2                  TSX1    PUT_2
         2 004327   000000 011000                    NOP     0

      859     1513    3         END;

      860     1514    2         %CHRS,PARM.NXTX,5) = XSP_UTC_OFFSET;

   1514  2 004330   200003 470500                    LDP0    @PARM,,AUTO
         2 004331   000011 235100                    LDA     9,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:186  
         2 004332   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004333   040105 100400                    MLR     fill='040'O
         2 004334   000000 000005 1                  ADSC9   XSP_UTC_OFFSET           cn=0,n=5
         2 004335   100000 000005                    ADSC9   0,A,PR1                  cn=0,n=5

      861     1515    2         PARM.NXTX = PARM.NXTX+5;

   1515  2 004336   000005 236007                    LDQ     5,DL
         2 004337   000011 056100                    ASQ     9,,PR0
         2 004340   004366 710000 2                  TRA     s:1524

      862     1516        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:187  
      863     1517    2      CASE (ELSE);                         /* Text strings                       */

      864     1518    2         CALL GETVALTXT;

   1518  2 004341   005370 701000 2                  TSX1    GETVALTXT
         2 004342   000000 011000                    NOP     0

      865     1519    2         IF SIZE=0 AND NODE.OPTIONL THEN ALTRETURN;

   1519  2 004343   200015 235100                    LDA     SIZE,,AUTO
         2 004344   004351 601000 2                  TNZ     s:1520
         2 004345   200004 470500                    LDP0    PTRS,,AUTO
         2 004346   000001 234100                    SZN     1,,PR0
         2 004347   004351 605000 2                  TPL     s:1520

   1519  2 004350   000000 702200 xent               TSX2  ! X66_AALT

      866     1520    2         CALL PUT_TAG;

   1520  2 004351   004521 701000 2                  TSX1    PUT_TAG
         2 004352   000000 011000                    NOP     0

      867     1521    2         %CHRS,PARM.NXTX,SIZE) = VALTXT;

   1521  2 004353   200003 470500                    LDP0    @PARM,,AUTO
         2 004354   000011 235100                    LDA     9,,PR0
         2 004355   200007 471500                    LDP1    PTRS+3,,AUTO
         2 004356   200015 720100                    LXL0    SIZE,,AUTO
         2 004357   200005 473500                    LDP3    PTRS+1,,AUTO
         2 004360   040145 100540                    MLR     fill='040'O
         2 004361   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 004362   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0

      868     1522    2         PARM.NXTX = PARM.NXTX+SIZE;

   1522  2 004363   000011 236100                    LDQ     9,,PR0
         2 004364   200015 036100                    ADLQ    SIZE,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:188  
         2 004365   000011 756100                    STQ     9,,PR0

      869     1523    2      END;

      870     1524    2      IF NODE.SUCC.SND THEN DO;

   1524  2 004366   200004 470500                    LDP0    PTRS,,AUTO
         2 004367   000001 236100                    LDQ     1,,PR0
         2 004370   040000 316003                    CANQ    16384,DU
         2 004371   004403 600000 2                  TZE     s:1528

      871     1525    2         PARM.USR = %XSP_ASN1_SND_SUCC;

   1525  2 004372   200003 471500                    LDP1    @PARM,,AUTO
         2 004373   000004 236003                    LDQ     4,DU
         2 004374   100005 552120                    STBQ    5,'20'O,PR1

      872     1526    2         CALL FPT.UENTRY$ (PARM);

   1526  2 004375   200003 630500                    EPPR0   @PARM,,AUTO
         2 004376   200006 473500                    LDP3    PTRS+2,,AUTO
         2 004377   300002 220100                    LDX0    2,,PR3
         2 004400   000001 631400 3                  EPPR1   1
         2 004401   000000 701010                    TSX1    0,X0
         2 004402   000000 011000                    NOP     0

      873     1527    2      END;

      874     1528    1      RETURN;

   1528  2 004403   000000 702200 xent               TSX2  ! X66_ARET

      875     1529        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:189  
      876     1530        /*
      877     1531        Subroutines
      878     1532        */
      879     1533    1   PUT_2: PROC;

   1533  2 004404   200024 741300       PUT_2        STX1  ! VALLIM+1,,AUTO

      880     1534    2      CALL BINCHAR(%CHRS,PARM.NXTX,2), I);

   1534  2 004405   200003 470500                    LDP0    @PARM,,AUTO
         2 004406   000011 235100                    LDA     9,,PR0
         2 004407   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004410   000105 301500                    BTD
         2 004411   200013 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 004412   100000 030002                    NDSC9   0,A,PR1                  cn=0,s=nosgn,sf=0,n=2

      881     1535    2      PARM.NXTX = PARM.NXTX+2;

   1535  2 004413   000002 236007                    LDQ     2,DL
         2 004414   000011 056100                    ASQ     9,,PR0

      882     1536    2      RETURN;

   1536  2 004415   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 004416   000001 702211                    TSX2  ! 1,X1

      883     1537    2   END PUT_2;
      884     1538
      885     1539    1   PUT_7S: PROC;

   1539  2 004417   200026 741300       PUT_7S       STX1  ! VALLIM+3,,AUTO

      886     1540    2      IF PTRS.BUF$->NODE.DEFAULT=PARM.NXTX THEN RETURN; /* Load some pointers    */

   1540  2 004420   200005 470500                    LDP0    PTRS+1,,AUTO
         2 004421   200003 471500                    LDP1    @PARM,,AUTO
         2 004422   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:190  
         2 004423   100011 116100                    CMPQ    9,,PR1
         2 004424   004426 601000 2                  TNZ     s:1541

   1540  2 004425   000001 702211                    TSX2  ! 1,X1

      887     1541    2      IF TAG<128 THEN GOTO PUT_71;

   1541  2 004426   200014 235100                    LDA     TAG,,AUTO
         2 004427   000200 115007                    CMPA    128,DL
         2 004430   004507 602000 2                  TNC     PUT_71

      888     1542    2      IF TAG<128*128 THEN GOTO PUT_72;

   1542  2 004431   040000 115007                    CMPA    16384,DL
         2 004432   004475 602000 2                  TNC     PUT_72

      889     1543    2      IF TAG<128*128*128 THEN GOTO PUT_73;

   1543  2 004433   000010 115003                    CMPA    8,DU
         2 004434   004463 602000 2                  TNC     PUT_73

      890     1544    2      IF TAG<128*128*128*128 THEN GOTO PUT_74;

   1544  2 004435   002000 115003                    CMPA    1024,DU
         2 004436   004451 602000 2                  TNC     PUT_74

      891     1545    2   PUT_75: T1 = TAG7.N(0)+128;

   1545  2 004437   200014 236100       PUT_75       LDQ     TAG,,AUTO
         2 004440   000034 772000                    QRL     28
         2 004441   000177 376007                    ANQ     127,DL
         2 004442   000200 036007                    ADLQ    128,DL
         2 004443   200020 756100                    STQ     T1,,AUTO

      892     1546    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;

   1546  2 004444   100011 235100                    LDA     9,,PR1
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:191  
         2 004445   040105 100500                    MLR     fill='040'O
         2 004446   200020 600001                    ADSC9   T1,,AUTO                 cn=3,n=1
         2 004447   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

   1546  2 004450   100011 054100                    AOS     9,,PR1

      893     1547    2   PUT_74: T1 = TAG7.N(1)+128;

   1547  2 004451   200014 236100       PUT_74       LDQ     TAG,,AUTO
         2 004452   000025 772000                    QRL     21
         2 004453   000177 376007                    ANQ     127,DL
         2 004454   000200 036007                    ADLQ    128,DL
         2 004455   200020 756100                    STQ     T1,,AUTO

      894     1548    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;

   1548  2 004456   100011 235100                    LDA     9,,PR1
         2 004457   040105 100500                    MLR     fill='040'O
         2 004460   200020 600001                    ADSC9   T1,,AUTO                 cn=3,n=1
         2 004461   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

   1548  2 004462   100011 054100                    AOS     9,,PR1

      895     1549    2   PUT_73: T1 = TAG7.N(2)+128;

   1549  2 004463   200014 236100       PUT_73       LDQ     TAG,,AUTO
         2 004464   000016 772000                    QRL     14
         2 004465   000177 376007                    ANQ     127,DL
         2 004466   000200 036007                    ADLQ    128,DL
         2 004467   200020 756100                    STQ     T1,,AUTO

      896     1550    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;

   1550  2 004470   100011 235100                    LDA     9,,PR1
         2 004471   040105 100500                    MLR     fill='040'O
         2 004472   200020 600001                    ADSC9   T1,,AUTO                 cn=3,n=1
         2 004473   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:192  

   1550  2 004474   100011 054100                    AOS     9,,PR1

      897     1551    2   PUT_72: T1 = TAG7.N(3)+128;

   1551  2 004475   200014 236100       PUT_72       LDQ     TAG,,AUTO
         2 004476   000007 772000                    QRL     7
         2 004477   000177 376007                    ANQ     127,DL
         2 004500   000200 036007                    ADLQ    128,DL
         2 004501   200020 756100                    STQ     T1,,AUTO

      898     1552    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;

   1552  2 004502   100011 235100                    LDA     9,,PR1
         2 004503   040105 100500                    MLR     fill='040'O
         2 004504   200020 600001                    ADSC9   T1,,AUTO                 cn=3,n=1
         2 004505   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

   1552  2 004506   100011 054100                    AOS     9,,PR1

      899     1553    2   PUT_71: T1 = TAG7.N(4);

   1553  2 004507   200014 236100       PUT_71       LDQ     TAG,,AUTO
         2 004510   000177 376007                    ANQ     127,DL
         2 004511   200020 756100                    STQ     T1,,AUTO

      900     1554    2      %CHRS,PARM.NXTX,1) = ADDR(T1)->C1.C; PARM.NXTX = PARM.NXTX+1;

   1554  2 004512   100011 235100                    LDA     9,,PR1
         2 004513   040105 100500                    MLR     fill='040'O
         2 004514   200020 600001                    ADSC9   T1,,AUTO                 cn=3,n=1
         2 004515   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

   1554  2 004516   100011 054100                    AOS     9,,PR1

      901     1555    2      RETURN;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:193  
   1555  2 004517   200026 221300                    LDX1  ! VALLIM+3,,AUTO
         2 004520   000001 702211                    TSX2  ! 1,X1

      902     1556    2   END PUT_7S;
      903     1557        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:194  
      904     1558    1   PUT_TAG: PROC;

   1558  2 004521   200024 741300       PUT_TAG      STX1  ! VALLIM+1,,AUTO

      905     1559
      906     1560    2      IF PARM.IMPLICIT AND NOT NODE.IMPLICIT THEN RETURN;

   1560  2 004522   200003 470500                    LDP0    @PARM,,AUTO
         2 004523   000005 234100                    SZN     5,,PR0
         2 004524   004532 605000 2                  TPL     s:1561
         2 004525   200004 471500                    LDP1    PTRS,,AUTO
         2 004526   100001 236100                    LDQ     1,,PR1
         2 004527   002000 316003                    CANQ    1024,DU
         2 004530   004532 601000 2                  TNZ     s:1561

   1560  2 004531   000001 702211                    TSX2  ! 1,X1

      907     1561    3      IF PARM.MAXX-PARM.NXTX<SIZE+3 THEN DO;

   1561  2 004532   000014 236100                    LDQ     12,,PR0
         2 004533   000011 136100                    SBLQ    9,,PR0
         2 004534   200015 235100                    LDA     SIZE,,AUTO
         2 004535   000003 035007                    ADLA    3,DL
         2 004536   200030 755100                    STA     VALLIM+5,,AUTO
         2 004537   200030 116100                    CMPQ    VALLIM+5,,AUTO
         2 004540   004555 605000 2                  TPL     s:1566

      908     1562    3         IF SIZE=65535 AND PARM.MAXX-PARM.NXTX>3 THEN EXIT;

   1562  2 004541   200015 236100                    LDQ     SIZE,,AUTO
         2 004542   177777 116007                    CMPQ    65535,DL
         2 004543   004550 601000 2                  TNZ     s:1563
         2 004544   000014 236100                    LDQ     12,,PR0
         2 004545   000011 136100                    SBLQ    9,,PR0
         2 004546   000003 116007                    CMPQ    3,DL
         2 004547   004555 605400 2                  TPNZ    s:1566

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:195  
      909     1563    3         PARM.ERR = %XSP_ASN1_E$WONT_FIT;

   1563  2 004550   000010 236007                    LDQ     8,DL
         2 004551   000010 756100                    STQ     8,,PR0

      910     1564    3         UNWIND TO PARM.ABORT;

   1564  2 004552   000006 237300                    LDAQ  ! 6,,PR0
         2 004553   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 004554   000000 000200                    ZERO    0,128

      911     1565    3      END;
      912     1566    2      TAGX = 0;

   1566  2 004555   200016 450100                    STZ     TAGX,,AUTO

      913     1567    2      IF NODE.CONSTRUCTED THEN TAGX = 32;

   1567  2 004556   200004 471500                    LDP1    PTRS,,AUTO
         2 004557   100000 236100                    LDQ     0,,PR1
         2 004560   000200 316003                    CANQ    128,DU
         2 004561   004564 600000 2                  TZE     s:1568

   1567  2 004562   000040 235007                    LDA     32,DL
         2 004563   200016 755100                    STA     TAGX,,AUTO

      914     1568    3      IF NODE.IMPLICIT THEN DO;

   1568  2 004564   100001 236100                    LDQ     1,,PR1
         2 004565   002000 316003                    CANQ    1024,DU
         2 004566   004602 600000 2                  TZE     s:1572

      915     1569    3         TAG = NODE.TAG+I;

   1569  2 004567   100000 236100                    LDQ     0,,PR1
         2 004570   777777 376007                    ANQ     -1,DL
         2 004571   200013 036100                    ADLQ    I,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:196  
         2 004572   200014 756100                    STQ     TAG,,AUTO

      916     1570    3         IF NOT NODE.SUBND$(I)->NODE.CONSTRUCTED THEN TAGX = 0;

   1570  2 004573   200013 720100                    LXL0    I,,AUTO
         2 004574   100003 473510                    LDP3    3,X0,PR1
         2 004575   300000 236100                    LDQ     0,,PR3
         2 004576   000200 316003                    CANQ    128,DU
         2 004577   004605 601000 2                  TNZ     s:1573

   1570  2 004600   200016 450100                    STZ     TAGX,,AUTO

      917     1571    3      END;

   1571  2 004601   004605 710000 2                  TRA     s:1573

      918     1572    2      ELSE TAG = NODE.TAG;

   1572  2 004602   100000 236100                    LDQ     0,,PR1
         2 004603   777777 376007                    ANQ     -1,DL
         2 004604   200014 756100                    STQ     TAG,,AUTO

      919     1573    2      TAGX = TAGX+64*(TAG/65536);

   1573  2 004605   200014 236100                    LDQ     TAG,,AUTO
         2 004606   000020 772000                    QRL     16
         2 004607   000006 736000                    QLS     6
         2 004610   200016 036100                    ADLQ    TAGX,,AUTO
         2 004611   200016 756100                    STQ     TAGX,,AUTO

      920     1574    2      TAG = MOD(TAG,65536);

   1574  2 004612   200014 236100                    LDQ     TAG,,AUTO
         2 004613   177777 376007                    ANQ     65535,DL
         2 004614   200014 756100                    STQ     TAG,,AUTO

      921     1575    2      IF TAG<31 THEN TAGX = TAGX+TAG;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:197  

   1575  2 004615   000037 116007                    CMPQ    31,DL
         2 004616   004622 603000 2                  TRC     s:1576

   1575  2 004617   200016 036100                    ADLQ    TAGX,,AUTO
         2 004620   200016 756100                    STQ     TAGX,,AUTO
         2 004621   004624 710000 2                  TRA     s:1577

      922     1576    2      ELSE TAGX = TAGX+31;

   1576  2 004622   000037 236007                    LDQ     31,DL
         2 004623   200016 056100                    ASQ     TAGX,,AUTO

      923     1577    2      %CHRS,PARM.NXTX,1) = ADDR(TAGX)->C1.C;

   1577  2 004624   000011 235100                    LDA     9,,PR0
         2 004625   200005 473500                    LDP3    PTRS+1,,AUTO
         2 004626   040105 100500                    MLR     fill='040'O
         2 004627   200016 600001                    ADSC9   TAGX,,AUTO               cn=3,n=1
         2 004630   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1

      924     1578    2      TAGX = PARM.NXTX;

   1578  2 004631   000011 235100                    LDA     9,,PR0
         2 004632   200016 755100                    STA     TAGX,,AUTO

      925     1579    2      PARM.NXTX = PARM.NXTX+1;

   1579  2 004633   000011 054100                    AOS     9,,PR0

      926     1580    2      IF TAG>30 THEN CALL PUT_7S;

   1580  2 004634   200014 235100                    LDA     TAG,,AUTO
         2 004635   000037 115007                    CMPA    31,DL
         2 004636   004641 602000 2                  TNC     s:1581

   1580  2 004637   004417 701000 2                  TSX1    PUT_7S
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:198  
         2 004640   000000 011000                    NOP     0

      927     1581    2      LNGX = PARM.NXTX;

   1581  2 004641   200003 470500                    LDP0    @PARM,,AUTO
         2 004642   000011 235100                    LDA     9,,PR0
         2 004643   200017 755100                    STA     LNGX,,AUTO

      928     1582    3      IF SIZE<128 OR NODE.SHORT THEN DO;

   1582  2 004644   200015 236100                    LDQ     SIZE,,AUTO
         2 004645   000200 116007                    CMPQ    128,DL
         2 004646   004653 604000 2                  TMI     s:1583
         2 004647   200004 471500                    LDP1    PTRS,,AUTO
         2 004650   100001 236100                    LDQ     1,,PR1
         2 004651   000100 316003                    CANQ    64,DU
         2 004652   004665 600000 2                  TZE     s:1587

      929     1583    3         SIZE = MOD(SIZEU,128);

   1583  2 004653   200015 236100                    LDQ     SIZE,,AUTO
         2 004654   000177 376007                    ANQ     127,DL
         2 004655   200015 756100                    STQ     SIZE,,AUTO

      930     1584    3         %CHRS,PARM.NXTX,1) = ADDR(SIZE)->C1.C;

   1584  2 004656   000011 235100                    LDA     9,,PR0
         2 004657   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004660   040105 100500                    MLR     fill='040'O
         2 004661   200015 600001                    ADSC9   SIZE,,AUTO               cn=3,n=1
         2 004662   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      931     1585    3         PARM.NXTX = PARM.NXTX+1;

   1585  2 004663   000011 054100                    AOS     9,,PR0

      932     1586    3      END; ELSE DO;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:199  

   1586  2 004664   004707 710000 2                  TRA     s:1592

      933     1587    3         SIZE = SIZE+BITBIN(BINBIT(SIZE,36)&'0000001774'O|'000202'O);

   1587  2 004665   000105 236000 0                  LDQ     NSIGNS+7
         2 004666   200015 376100                    ANQ     SIZE,,AUTO
         2 004667   000202 276003                    ORQ     130,DU
         2 004670   200015 036100                    ADLQ    SIZE,,AUTO
         2 004671   200015 756100                    STQ     SIZE,,AUTO

      934     1588    3         %CHRS,PARM.NXTX,3) = ADDR(SIZE)->C3.C;

   1588  2 004672   000011 235100                    LDA     9,,PR0
         2 004673   200005 473500                    LDP3    PTRS+1,,AUTO
         2 004674   040105 100500                    MLR     fill='040'O
         2 004675   200015 200003                    ADSC9   SIZE,,AUTO               cn=1,n=3
         2 004676   300000 000003                    ADSC9   0,A,PR3                  cn=0,n=3

      935     1589    3         SIZE = MOD(SIZEU+MOD(SIZEU,256),262144)/2;

   1589  2 004677   200015 236100                    LDQ     SIZE,,AUTO
         2 004700   000377 376007                    ANQ     255,DL
         2 004701   200015 036100                    ADLQ    SIZE,,AUTO
         2 004702   777777 376007                    ANQ     -1,DL
         2 004703   000001 772000                    QRL     1
         2 004704   200015 756100                    STQ     SIZE,,AUTO

      936     1590    3         PARM.NXTX = PARM.NXTX+3;

   1590  2 004705   000003 236007                    LDQ     3,DL
         2 004706   000011 056100                    ASQ     9,,PR0

      937     1591    3      END;

      938     1592    2      RETURN;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:200  
   1592  2 004707   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 004710   000001 702211                    TSX2  ! 1,X1

      939     1593    2   END PUT_TAG;
      940     1594        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:201  
      941     1595    1   FIX_LNG: PROC;

   1595  2 004711   200024 741300       FIX_LNG      STX1  ! VALLIM+1,,AUTO

      942     1596    2      SIZE = PARM.NXTX-LNGX-1;

   1596  2 004712   200003 470500                    LDP0    @PARM,,AUTO
         2 004713   000011 236100                    LDQ     9,,PR0
         2 004714   200017 136100                    SBLQ    LNGX,,AUTO
         2 004715   000001 136007                    SBLQ    1,DL
         2 004716   200015 756100                    STQ     SIZE,,AUTO

      943     1597    2      IF %CHRS,LNGX,1)<BINASC(128) THEN IF SIZE<128

   1597  2 004717   200005 471500                    LDP1    PTRS+1,,AUTO
         2 004720   200017 235100                    LDA     LNGX,,AUTO
         2 004721   040000 106505                    CMPC    fill='040'O
         2 004722   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 004723   000032 000001 3                  ADSC9   26                       cn=0,n=1
         2 004724   004745 603000 2                  TRC     s:1604

   1597  2 004725   000200 116007                    CMPQ    128,DL
         2 004726   004733 605000 2                  TPL     s:1600

      944     1598    2      THEN %CHRS,LNGX,1) = ADDR(SIZE)->C1.C;

   1598  2 004727   040105 100500                    MLR     fill='040'O
         2 004730   200015 600001                    ADSC9   SIZE,,AUTO               cn=3,n=1
         2 004731   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 004732   005004 710000 2                  TRA     s:1616

      945     1599    3      ELSE DO;

      946     1600    3         %CHRS,LNGX,1) = BINASC(128);

   1600  2 004733   040105 100400                    MLR     fill='040'O
         2 004734   000032 000001 3                  ADSC9   26                       cn=0,n=1
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:202  
         2 004735   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      947     1601    3         %CHRS,PARM.NXTX,2) = %CONCAT(BINASC(0),BINASC(0));

   1601  2 004736   000011 235100                    LDA     9,,PR0
         2 004737   040105 100400                    MLR     fill='040'O
         2 004740   000105 000002 0                  ADSC9   NSIGNS+7                 cn=0,n=2
         2 004741   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2

      948     1602    3         PARM.NXTX = PARM.NXTX+2;

   1602  2 004742   000002 236007                    LDQ     2,DL
         2 004743   000011 056100                    ASQ     9,,PR0

      949     1603    3      END; ELSE DO;

   1603  2 004744   005004 710000 2                  TRA     s:1616

      950     1604    3         SIZE = SIZE-2;

   1604  2 004745   000002 336007                    LCQ     2,DL
         2 004746   200015 056100                    ASQ     SIZE,,AUTO

      951     1605    3         SIZE = SIZE+BITBIN(BINBIT(SIZE,36)&'0000001774'O);

   1605  2 004747   000105 236000 0                  LDQ     NSIGNS+7
         2 004750   200015 376100                    ANQ     SIZE,,AUTO
         2 004751   200015 036100                    ADLQ    SIZE,,AUTO
         2 004752   200015 756100                    STQ     SIZE,,AUTO

      952     1606    3         %CHRS,LNGX+1,2) = ADDR(SIZE)->C2.C;

   1606  2 004753   040105 100500                    MLR     fill='040'O
         2 004754   200015 400002                    ADSC9   SIZE,,AUTO               cn=2,n=2
         2 004755   100000 200002                    ADSC9   0,A,PR1                  cn=1,n=2

      953     1607    4         IF SIZE<128 THEN DO;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:203  

   1607  2 004756   200015 236100                    LDQ     SIZE,,AUTO
         2 004757   000200 116007                    CMPQ    128,DL
         2 004760   004770 605000 2                  TPL     s:1610+1

      954     1608    4            %CHRS,LNGX,SIZE+1) = %CHRS,LNGX+2,SIZE+1);

   1608  2 004761   000001 620006                    EAX0    1,QL
         2 004762   040145 100545                    MLR     fill='040'O
         2 004763   100000 400010                    ADSC9   0,A,PR1                  cn=2,n=*X0
         2 004764   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0

      955     1609    4            PARM.NXTX = PARM.NXTX-2;

   1609  2 004765   000002 336007                    LCQ     2,DL
         2 004766   000011 056100                    ASQ     9,,PR0

      956     1610    4         END; ELSE IF SIZE<256 THEN DO;

   1610  2 004767   005004 710000 2                  TRA     s:1616

   1610  2 004770   000400 116007                    CMPQ    256,DL
         2 004771   005004 605000 2                  TPL     s:1616

      957     1611    4            %CHRS,LNGX,1) = BINASC(129);

   1611  2 004772   040105 100400                    MLR     fill='040'O
         2 004773   000033 000001 3                  ADSC9   27                       cn=0,n=1
         2 004774   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      958     1612    4            %CHRS,LNGX+1,SIZE+1) = %CHRS,LNGX+2,SIZE+1);

   1612  2 004775   200015 720100                    LXL0    SIZE,,AUTO
         2 004776   000001 621010                    EAX1    1,X0
         2 004777   040145 100545                    MLR     fill='040'O
         2 005000   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
         2 005001   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:204  

      959     1613    4            PARM.NXTX = PARM.NXTX-1;

   1613  2 005002   000001 336007                    LCQ     1,DL
         2 005003   000011 056100                    ASQ     9,,PR0

      960     1614    4         END;

      961     1615    3      END;

      962     1616    2      RETURN;

   1616  2 005004   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 005005   000001 702211                    TSX2  ! 1,X1

      963     1617    2   END FIX_LNG;
      964     1618        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:205  
      965     1619    1   GETVALN: PROC;

   1619  2 005006   200024 741300       GETVALN      STX1  ! VALLIM+1,,AUTO

      966     1620
      967     1621    2   DCL BITS BIT(SIZE) BASED;
      968     1622    2   DCL CHARS CHAR(4000) BASED(PTRS.VAL$);
      969     1623    2   DCL BYTES(0:0) UBIN(9) CALIGNED BASED(PTRS.VAL$);
      970     1624    2   DCL HWORD UBIN(18) BASED(PTRS.VAL$) ALIGNED;
      971     1625    2   DCL WORDS(0:0) UBIN BASED(PTRS.VAL$) ALIGNED;
      972     1626
      973     1627    2      VAL = '0'B;

   1627  2 005007   200011 450100                    STZ     VALC,,AUTO
         2 005010   200012 450100                    STZ     VALC+1,,AUTO

      974     1628    3      IF VNODE.VALUE_EXISTS THEN DO;

   1628  2 005011   200010 470500                    LDP0    PTRS+4,,AUTO
         2 005012   000002 236100                    LDQ     2,,PR0
         2 005013   200000 316007                    CANQ    65536,DL
         2 005014   005026 600000 2                  TZE     s:1632

      975     1629    3         VAL.N = VNODE.VALUE(BITBIN(VNODE.DEFAULT_EXISTS));

   1629  2 005015   000002 236100                    LDQ     2,,PR0
         2 005016   000021 772000                    QRL     17
         2 005017   000001 376007                    ANQ     1,DL
         2 005020   000003 235106                    LDA     3,QL,PR0
         2 005021   200012 755100                    STA     VALC+1,,AUTO

      976     1630    3         IF VAL.N<0 THEN VAL.N0 = -1;

   1630  2 005022   005235 605000 2                  TPL     s:1680

   1630  2 005023   000001 336007                    LCQ     1,DL
         2 005024   200011 756100                    STQ     VALC,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:206  

      977     1631    3      END;

   1631  2 005025   005235 710000 2                  TRA     s:1680

      978     1632    3      ELSE IF PTRS.VAL$~=ADDR(NIL) THEN DO;

   1632  2 005026   200007 236100                    LDQ     PTRS+3,,AUTO
         2 005027   000000 116000 3                  CMPQ    0
         2 005030   005047 600000 2                  TZE     s:1638

      979     1633    3         VAL.N = WORDS(0);

   1633  2 005031   200007 471500                    LDP1    PTRS+3,,AUTO
         2 005032   100000 235100                    LDA     0,,PR1
         2 005033   200012 755100                    STA     VALC+1,,AUTO

      980     1634    3         SIZE = 36;

   1634  2 005034   000044 235007                    LDA     36,DL
         2 005035   200015 755100                    STA     SIZE,,AUTO

      981     1635    3         IF VAL.N<0 AND VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN THEN VAL.N0 = -1;

   1635  2 005036   200012 235100                    LDA     VALC+1,,AUTO
         2 005037   005235 605000 2                  TPL     s:1680
         2 005040   000000 236100                    LDQ     0,,PR0
         2 005041   007400 376003                    ANQ     3840,DU
         2 005042   002400 116003                    CMPQ    1280,DU
         2 005043   005235 601000 2                  TNZ     s:1680

   1635  2 005044   000001 335007                    LCA     1,DL
         2 005045   200011 755100                    STA     VALC,,AUTO

      982     1636    3      END;

   1636  2 005046   005235 710000 2                  TRA     s:1680
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:207  

      983     1637    3      ELSE DO;

      984     1638    3         PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);

   1638  2 005047   000002 720100                    LXL0    2,,PR0
         2 005050   000077 360003                    ANX0    63,DU
         2 005051   200006 471500                    LDP1    PTRS+2,,AUTO
         2 005052   100015 236110                    LDQ     13,X0,PR1
         2 005053   200007 756100                    STQ     PTRS+3,,AUTO

      985     1639    3         IF VNODE.INCRPTR

   1639  2 005054   000001 236100                    LDQ     1,,PR0
         2 005055   000040 316003                    CANQ    32,DU
         2 005056   005065 600000 2                  TZE     s:1641

      986     1640    3         THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);

   1640  2 005057   000002 236100                    LDQ     2,,PR0
         2 005060   000006 772000                    QRL     6
         2 005061   000377 376007                    ANQ     255,DL
         2 005062   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005063   300000 503506                    ABD     0,QL,PR3
         2 005064   100015 453510                    STP3    13,X0,PR1

      987     1641    3         SIZE = VNODE.SIZE;

   1641  2 005065   000001 236100                    LDQ     1,,PR0
         2 005066   000015 772000                    QRL     13
         2 005067   000377 376007                    ANQ     255,DL
         2 005070   200015 756100                    STQ     SIZE,,AUTO

      988     1642    3         IF SIZE=0 THEN SIZE = 36;

   1642  2 005071   005074 601000 2                  TNZ     s:1643

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:208  
   1642  2 005072   000044 235007                    LDA     36,DL
         2 005073   200015 755100                    STA     SIZE,,AUTO

      989     1643    4         IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;

   1643  2 005074   000002 236100                    LDQ     2,,PR0
         2 005075   140000 376007                    ANQ     49152,DL
         2 005076   040000 116007                    CMPQ    16384,DL
         2 005077   005140 601000 2                  TNZ     s:1655+1

      990     1644    4            SIZE = SIZE/9;

   1644  2 005100   200015 236100                    LDQ     SIZE,,AUTO
         2 005101   000011 506007                    DIV     9,DL
         2 005102   200015 756100                    STQ     SIZE,,AUTO

      991     1645    5            IF SIZE>7 THEN DO;

   1645  2 005103   000007 116007                    CMPQ    7,DL
         2 005104   005113 604400 2                  TMOZ    s:1649

      992     1646    5               PTRS.VAL$ = PINCRC(PTRS.VAL$,SIZE-7);

   1646  2 005105   000020 736000                    QLS     16
         2 005106   000021 136000 3                  SBLQ    17
         2 005107   200007 036100                    ADLQ    PTRS+3,,AUTO
         2 005110   200007 756100                    STQ     PTRS+3,,AUTO

      993     1647    5               SIZE = 7;

   1647  2 005111   000007 235007                    LDA     7,DL
         2 005112   200015 755100                    STA     SIZE,,AUTO

      994     1648    5            END;

      995     1649    4            IF VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN AND SUBSTR(CHARS,0,1)>BINASC(255)

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:209  
   1649  2 005113   000000 236100                    LDQ     0,,PR0
         2 005114   007400 376003                    ANQ     3840,DU
         2 005115   002400 116003                    CMPQ    1280,DU
         2 005116   005127 601000 2                  TNZ     s:1654
         2 005117   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005120   040100 106400                    CMPC    fill='040'O
         2 005121   000034 000001 3                  ADSC9   28                       cn=0,n=1
         2 005122   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 005123   005127 603000 2                  TRC     s:1654

      996     1650    5            THEN DO;

      997     1651    5               VAL.N0 = -1;

   1651  2 005124   000001 335007                    LCA     1,DL
         2 005125   200011 755100                    STA     VALC,,AUTO

      998     1652    5               VAL.N = -1;

   1652  2 005126   200012 755100                    STA     VALC+1,,AUTO

      999     1653    5            END;

     1000     1654    4            SUBSTR(VALC,8-SIZE,SIZE) = SUBSTR(CHARS,VNODE.OFFSET,SIZE);

   1654  2 005127   000002 236100                    LDQ     2,,PR0
         2 005130   000022 772000                    QRL     18
         2 005131   200015 335100                    LCA     SIZE,,AUTO
         2 005132   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005133   200015 720100                    LXL0    SIZE,,AUTO
         2 005134   040145 100546                    MLR     fill='040'O
         2 005135   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=*X0
         2 005136   200013 000010                    ADSC9   I,A,AUTO                 cn=0,n=*X0

     1001     1655    4         END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;

   1655  2 005137   005235 710000 2                  TRA     s:1680
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:210  

   1655  2 005140   000002 236100                    LDQ     2,,PR0
         2 005141   140000 316007                    CANQ    49152,DL
         2 005142   005203 601000 2                  TNZ     s:1668

     1002     1656    5            IF SIZE>72 THEN DO;

   1656  2 005143   200015 235100                    LDA     SIZE,,AUTO
         2 005144   000110 115007                    CMPA    72,DL
         2 005145   005156 604400 2                  TMOZ    s:1660

     1003     1657    5               PTRS.VAL$ = PINCRW(PTRS.VAL$,SIZE/36-2);

   1657  2 005146   200015 236100                    LDQ     SIZE,,AUTO
         2 005147   000044 506007                    DIV     36,DL
         2 005150   000022 736000                    QLS     18
         2 005151   000002 136003                    SBLQ    2,DU
         2 005152   200007 036100                    ADLQ    PTRS+3,,AUTO
         2 005153   200007 756100                    STQ     PTRS+3,,AUTO

     1004     1658    5               SIZE = 72;

   1658  2 005154   000110 235007                    LDA     72,DL
         2 005155   200015 755100                    STA     SIZE,,AUTO

     1005     1659    5            END;

     1006     1660    4            VAL.N = WORDS(VNODE.OFFSET);

   1660  2 005156   000002 220100                    LDX0    2,,PR0
         2 005157   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005160   300000 235110                    LDA     0,X0,PR3
         2 005161   200012 755100                    STA     VALC+1,,AUTO

     1007     1661    5            IF SIZE>36 THEN DO;

   1661  2 005162   200015 236100                    LDQ     SIZE,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:211  
         2 005163   000044 116007                    CMPQ    36,DL
         2 005164   005172 604400 2                  TMOZ    s:1665

     1008     1662    5               VAL.N0 = VAL.N;

   1662  2 005165   200011 755100                    STA     VALC,,AUTO

     1009     1663    5               VAL.N = WORDS(VNODE.OFFSET+1);

   1663  2 005166   000002 220100                    LDX0    2,,PR0
         2 005167   300001 235110                    LDA     1,X0,PR3
         2 005170   200012 755100                    STA     VALC+1,,AUTO

     1010     1664    5            END;

   1664  2 005171   005235 710000 2                  TRA     s:1680

     1011     1665    4            ELSE IF VAL.N<0 AND VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN

   1665  2 005172   000000 115003                    CMPA    0,DU
         2 005173   005235 605000 2                  TPL     s:1680
         2 005174   000000 236100                    LDQ     0,,PR0
         2 005175   007400 376003                    ANQ     3840,DU
         2 005176   002400 116003                    CMPQ    1280,DU
         2 005177   005235 601000 2                  TNZ     s:1680

     1012     1666    4            THEN VAL.N0 = -1;

   1666  2 005200   000001 335007                    LCA     1,DL
         2 005201   200011 755100                    STA     VALC,,AUTO

     1013     1667    4         END; ELSE DO;

   1667  2 005202   005235 710000 2                  TRA     s:1680

     1014     1668    5            IF SIZE>72 THEN DO;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:212  
   1668  2 005203   200015 235100                    LDA     SIZE,,AUTO
         2 005204   000110 115007                    CMPA    72,DL
         2 005205   005214 604400 2                  TMOZ    s:1672

     1015     1669    5               PTRS.VAL$ = PINCRB(PTRS.VAL$,SIZEU-72);

   1669  2 005206   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005207   200015 235100                    LDA     SIZE,,AUTO
         2 005210   377776 503505                    ABD     -2,AL,PR3
         2 005211   200007 453500                    STP3    PTRS+3,,AUTO

     1016     1670    5               SIZE = 72;

   1670  2 005212   000110 235007                    LDA     72,DL
         2 005213   200015 755100                    STA     SIZE,,AUTO

     1017     1671    5            END;

     1018     1672    5            IF VNODE.CP6TYP=%XSP_ASN1_CP6TYP_SBIN THEN DO;

   1672  2 005214   000000 236100                    LDQ     0,,PR0
         2 005215   007400 376003                    ANQ     3840,DU
         2 005216   002400 116003                    CMPQ    1280,DU
         2 005217   005223 601000 2                  TNZ     s:1676

     1019     1673    5               VAL.N0 = -1;

   1673  2 005220   000001 335007                    LCA     1,DL
         2 005221   200011 755100                    STA     VALC,,AUTO

     1020     1674    5               VAL.N = -1;

   1674  2 005222   200012 755100                    STA     VALC+1,,AUTO

     1021     1675    5            END;

     1022     1676    4            PINCRB(ADDR(VAL),72-SIZE)->BITS =
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:213  

   1676  2 005223   000002 236100                    LDQ     2,,PR0
         2 005224   000022 772000                    QRL     18
         2 005225   200015 335100                    LCA     SIZE,,AUTO
         2 005226   005230 605000 2                  TPL     s:1676+5
         2 005227   000044 035003                    ADLA    36,DU
         2 005230   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005231   200015 720100                    LXL0    SIZE,,AUTO
         2 005232   003145 060546                    CSL     bolr='003'O
         2 005233   300000 000010                    BDSC    0,Q,PR3                  by=0,bit=0,n=*X0
         2 005234   200013 000010                    BDSC    I,A,AUTO                 by=0,bit=0,n=*X0

     1023     1677    4              PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS;
     1024     1678    4         END;

     1025     1679    3      END;

     1026     1680    2      RETURN;

   1680  2 005235   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 005236   000001 702211                    TSX2  ! 1,X1

     1027     1681        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:214  
     1028     1682    2   GETVALB: ENTRY;

   1682  2 005237   200024 741300       GETVALB      STX1  ! VALLIM+1,,AUTO

     1029     1683    2      VAL = '0'B;

   1683  2 005240   200011 450100                    STZ     VALC,,AUTO
         2 005241   200012 450100                    STZ     VALC+1,,AUTO

     1030     1684    2      SIZE = VNODE.SIZE;

   1684  2 005242   200010 470500                    LDP0    PTRS+4,,AUTO
         2 005243   000001 236100                    LDQ     1,,PR0
         2 005244   000015 772000                    QRL     13
         2 005245   000377 376007                    ANQ     255,DL
         2 005246   200015 756100                    STQ     SIZE,,AUTO

     1031     1685    2      IF VNODE.VALUE_EXISTS

   1685  2 005247   000002 236100                    LDQ     2,,PR0
         2 005250   200000 316007                    CANQ    65536,DL
         2 005251   005260 600000 2                  TZE     s:1687

     1032     1686    2      THEN VAL.B = VNODE.VALUEB(BITBIN(VNODE.DEFAULT_EXISTS));

   1686  2 005252   000002 236100                    LDQ     2,,PR0
         2 005253   000021 772000                    QRL     17
         2 005254   000001 376007                    ANQ     1,DL
         2 005255   000003 236106                    LDQ     3,QL,PR0
         2 005256   200011 756100                    STQ     VALC,,AUTO
         2 005257   005366 710000 2                  TRA     s:1705

     1033     1687    3      ELSE IF PTRS.VAL$~=ADDR(NIL) THEN DO;

   1687  2 005260   200007 236100                    LDQ     PTRS+3,,AUTO
         2 005261   000000 116000 3                  CMPQ    0
         2 005262   005273 600000 2                  TZE     s:1692
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:215  

     1034     1688    3         VAL.N0 = WORDS(0);

   1688  2 005263   200007 471500                    LDP1    PTRS+3,,AUTO
         2 005264   100000 235100                    LDA     0,,PR1
         2 005265   200011 755100                    STA     VALC,,AUTO

     1035     1689    3         IF SIZE=0 THEN SIZE = 1;

   1689  2 005266   200015 235100                    LDA     SIZE,,AUTO
         2 005267   005366 601000 2                  TNZ     s:1705

   1689  2 005270   000001 235007                    LDA     1,DL
         2 005271   200015 755100                    STA     SIZE,,AUTO

     1036     1690    3      END;

   1690  2 005272   005366 710000 2                  TRA     s:1705

     1037     1691    3      ELSE DO;

     1038     1692    3         PTRS.VAL$ = FPT.DAT$(VNODE.FPTPTR);

   1692  2 005273   000002 720100                    LXL0    2,,PR0
         2 005274   000077 360003                    ANX0    63,DU
         2 005275   200006 471500                    LDP1    PTRS+2,,AUTO
         2 005276   100015 236110                    LDQ     13,X0,PR1
         2 005277   200007 756100                    STQ     PTRS+3,,AUTO

     1039     1693    3         IF VNODE.INCRPTR

   1693  2 005300   000001 236100                    LDQ     1,,PR0
         2 005301   000040 316003                    CANQ    32,DU
         2 005302   005311 600000 2                  TZE     s:1695

     1040     1694    3         THEN FPT.DAT$(VNODE.FPTPTR) = PINCRB(PTRS.VAL$,VNODE.SIZELIM);

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:216  
   1694  2 005303   000002 236100                    LDQ     2,,PR0
         2 005304   000006 772000                    QRL     6
         2 005305   000377 376007                    ANQ     255,DL
         2 005306   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005307   300000 503506                    ABD     0,QL,PR3
         2 005310   100015 453510                    STP3    13,X0,PR1

     1041     1695    3         IF SIZE=0 THEN SIZE = 1;

   1695  2 005311   200015 235100                    LDA     SIZE,,AUTO
         2 005312   005315 601000 2                  TNZ     s:1696

   1695  2 005313   000001 236007                    LDQ     1,DL
         2 005314   200015 756100                    STQ     SIZE,,AUTO

     1042     1696    3         IF SIZE>56 THEN SIZE = 56;

   1696  2 005315   200015 235100                    LDA     SIZE,,AUTO
         2 005316   000070 115007                    CMPA    56,DL
         2 005317   005322 604400 2                  TMOZ    s:1697

   1696  2 005320   000070 236007                    LDQ     56,DL
         2 005321   200015 756100                    STQ     SIZE,,AUTO

     1043     1697    4         IF VNODE.DATALGN=%XSP_ASN1_DATALGN_BYTE THEN DO;

   1697  2 005322   000002 236100                    LDQ     2,,PR0
         2 005323   140000 376007                    ANQ     49152,DL
         2 005324   040000 116007                    CMPQ    16384,DL
         2 005325   005341 601000 2                  TNZ     s:1700+1

     1044     1698    4            T1 = SIZE/9;

   1698  2 005326   200015 236100                    LDQ     SIZE,,AUTO
         2 005327   000011 506007                    DIV     9,DL
         2 005330   200020 756100                    STQ     T1,,AUTO

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:217  
     1045     1699    4            SUBSTR(VALC,0,T1) = SUBSTR(CHARS,VNODE.OFFSET,T1);

   1699  2 005331   000002 236100                    LDQ     2,,PR0
         2 005332   000022 772000                    QRL     18
         2 005333   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005334   200020 720100                    LXL0    T1,,AUTO
         2 005335   040140 100546                    MLR     fill='040'O
         2 005336   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=*X0
         2 005337   200011 000010                    ADSC9   VALC,,AUTO               cn=0,n=*X0

     1046     1700    4         END; ELSE IF VNODE.DATALGN=%XSP_ASN1_DATALGN_WORD THEN DO;

   1700  2 005340   005366 710000 2                  TRA     s:1705

   1700  2 005341   000002 236100                    LDQ     2,,PR0
         2 005342   140000 316007                    CANQ    49152,DL
         2 005343   005357 601000 2                  TNZ     s:1703+1

     1047     1701    4            VAL.N0 = WORDS(VNODE.OFFSET);

   1701  2 005344   000002 220100                    LDX0    2,,PR0
         2 005345   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005346   300000 235110                    LDA     0,X0,PR3
         2 005347   200011 755100                    STA     VALC,,AUTO

     1048     1702    4            IF SIZE>36 THEN VAL.N = WORDS(VNODE.OFFSET+1);

   1702  2 005350   200015 236100                    LDQ     SIZE,,AUTO
         2 005351   000044 116007                    CMPQ    36,DL
         2 005352   005366 604400 2                  TMOZ    s:1705

   1702  2 005353   000002 220100                    LDX0    2,,PR0
         2 005354   300001 235110                    LDA     1,X0,PR3
         2 005355   200012 755100                    STA     VALC+1,,AUTO

     1049     1703    3         END; ELSE ADDR(VALC)->BITS = PINCRB(PTRS.VAL$,VNODE.OFFSET)->BITS;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:218  
   1703  2 005356   005366 710000 2                  TRA     s:1705

   1703  2 005357   000002 236100                    LDQ     2,,PR0
         2 005360   000022 772000                    QRL     18
         2 005361   200007 473500                    LDP3    PTRS+3,,AUTO
         2 005362   200015 720100                    LXL0    SIZE,,AUTO
         2 005363   003140 060546                    CSL     bolr='003'O
         2 005364   300000 000010                    BDSC    0,Q,PR3                  by=0,bit=0,n=*X0
         2 005365   200011 000010                    BDSC    VALC,,AUTO               by=0,bit=0,n=*X0

     1050     1704    3      END;

     1051     1705    2      RETURN;

   1705  2 005366   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 005367   000001 702211                    TSX2  ! 1,X1

     1052     1706        %EJECT;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:219  
     1053     1707    2   GETVALTXT: ENTRY;

   1707  2 005370   200024 741300       GETVALTXT    STX1  ! VALLIM+1,,AUTO

     1054     1708    2      SIZE = VNODE.SIZE;

   1708  2 005371   200010 470500                    LDP0    PTRS+4,,AUTO
         2 005372   000001 236100                    LDQ     1,,PR0
         2 005373   000015 772000                    QRL     13
         2 005374   000377 376007                    ANQ     255,DL
         2 005375   200015 756100                    STQ     SIZE,,AUTO

     1055     1709    2      T1 = VNODE.SIZELIM;

   1709  2 005376   000002 236100                    LDQ     2,,PR0
         2 005377   000006 772000                    QRL     6
         2 005400   000377 376007                    ANQ     255,DL
         2 005401   200020 756100                    STQ     T1,,AUTO

     1056     1710    3      IF NOT VNODE.VALUE_EXISTS THEN DO;

   1710  2 005402   000002 236100                    LDQ     2,,PR0
         2 005403   200000 316007                    CANQ    65536,DL
         2 005404   005430 601000 2                  TNZ     s:1716

     1057     1711    3         IF PTRS.VAL$~=ADDR(NIL) THEN EXIT;

   1711  2 005405   200007 236100                    LDQ     PTRS+3,,AUTO
         2 005406   000000 116000 3                  CMPQ    0
         2 005407   005427 601000 2                  TNZ     s:1715

     1058     1712    3         PTRS.VAL$ = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(VNODE.OFFSET));

   1712  2 005410   000002 720100                    LXL0    2,,PR0
         2 005411   000077 360003                    ANX0    63,DU
         2 005412   200006 471500                    LDP1    PTRS+2,,AUTO
         2 005413   100015 473510                    LDP3    13,X0,PR1
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:220  
         2 005414   000002 236100                    LDQ     2,,PR0
         2 005415   000022 772000                    QRL     18
         2 005416   300000 500506                    A9BD    0,QL,PR3
         2 005417   200007 453500                    STP3    PTRS+3,,AUTO

     1059     1713    3         IF VNODE.INCRPTR

   1713  2 005420   000001 236100                    LDQ     1,,PR0
         2 005421   000040 316003                    CANQ    32,DU
         2 005422   005443 600000 2                  TZE     s:1718

     1060     1714    3         THEN FPT.DAT$(VNODE.FPTPTR) = ADDR(FPT.DAT$(VNODE.FPTPTR)->BYTES(T1));

   1714  2 005423   100015 474510                    LDP4    13,X0,PR1
         2 005424   200020 235100                    LDA     T1,,AUTO
         2 005425   400000 500505                    A9BD    0,AL,PR4
         2 005426   100015 454510                    STP4    13,X0,PR1

     1061     1715    3      END;

   1715  2 005427   005443 710000 2                  TRA     s:1718

     1062     1716    2      ELSE IF NOT VNODE.DEFAULT_EXISTS THEN PTRS.VAL$ = ADDR(VNODE.DEFAULT);

   1716  2 005430   400000 316007                    CANQ    -131072,DL
         2 005431   005436 601000 2                  TNZ     s:1717

   1716  2 005432   200010 236100                    LDQ     PTRS+4,,AUTO
         2 005433   000003 036003                    ADLQ    3,DU
         2 005434   200007 756100                    STQ     PTRS+3,,AUTO
         2 005435   005443 710000 2                  TRA     s:1718

     1063     1717    2      ELSE PTRS.VAL$ = PINCRC(ADDR(VNODE.DEFAULT),SIZE);

   1717  2 005436   200015 236100                    LDQ     SIZE,,AUTO
         2 005437   000020 736000                    QLS     16
         2 005440   000003 036003                    ADLQ    3,DU
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:221  
         2 005441   200010 036100                    ADLQ    PTRS+4,,AUTO
         2 005442   200007 756100                    STQ     PTRS+3,,AUTO

     1064     1718    3      IF SIZE=0 THEN DO CASE VNODE.CP6TYP; /* textc stuff                        */

   1718  2 005443   200015 235100                    LDA     SIZE,,AUTO
         2 005444   005570 601000 2                  TNZ     s:1738

   1718  2 005445   000000 236100                    LDQ     0,,PR0
         2 005446   000032 772000                    QRL     26
         2 005447   000017 376007                    ANQ     15,DL
         2 005450   000007 136007                    SBLQ    7,DL
         2 005451   000003 116007                    CMPQ    3,DL
         2 005452   005454 602006 2                  TNC     s:1718+9,QL
         2 005453   005536 710000 2                  TRA     s:1732
         2 005454   005457 710000 2                  TRA     s:1720
         2 005455   005473 710000 2                  TRA     s:1724
         2 005456   005525 710000 2                  TRA     s:1729

     1065     1719    3      CASE (%XSP_ASN1_CP6TYP_TEXTH);       /* Half-word size, aligned            */

     1066     1720    3         SIZE = PTRS.VAL$->HWORD;

   1720  2 005457   200007 471500                    LDP1    PTRS+3,,AUTO
         2 005460   100000 236100                    LDQ     0,,PR1
         2 005461   000022 772000                    QRL     18
         2 005462   200015 756100                    STQ     SIZE,,AUTO

     1067     1721    3         IF T1=0 THEN T1=SIZE+2;

   1721  2 005463   200020 235100                    LDA     T1,,AUTO
         2 005464   005467 601000 2                  TNZ     s:1722

   1721  2 005465   000002 036007                    ADLQ    2,DL
         2 005466   200020 756100                    STQ     T1,,AUTO

     1068     1722    3         PTRS.VAL$ = PINCRC(PTRS.VAL$,2);
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:222  

   1722  2 005467   200007 236100                    LDQ     PTRS+3,,AUTO
         2 005470   400000 036007                    ADLQ    -131072,DL
         2 005471   200007 756100                    STQ     PTRS+3,,AUTO
         2 005472   005570 710000 2                  TRA     s:1738

     1069     1723    3      CASE (%XSP_ASN1_CP6TYP_TEXTNB);      /* Skip trailing blanks               */

     1070     1724    4         DO WHILE SIZE<T1;

   1724  2 005473   200015 236100                    LDQ     SIZE,,AUTO
         2 005474   200020 116100                    CMPQ    T1,,AUTO
         2 005475   005570 605000 2                  TPL     s:1738

     1071     1725    4            IF SUBSTR(CHARS,SIZE,T1-SIZE)=' ' THEN EXIT;

   1725  2 005476   200020 236100                    LDQ     T1,,AUTO
         2 005477   200015 136100                    SBLQ    SIZE,,AUTO
         2 005500   200007 470500                    LDP0    PTRS+3,,AUTO
         2 005501   000000 620006                    EAX0    0,QL
         2 005502   200015 235100                    LDA     SIZE,,AUTO
         2 005503   040000 106545                    CMPC    fill='040'O
         2 005504   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 005505   000012 000001 3                  ADSC9   10                       cn=0,n=1
         2 005506   005524 600000 2                  TZE     s:1727+3

     1072     1726    4            CALL INDEX (SIZE,' ',SUBSTR(CHARS,0,T1),SIZE+1);

   1726  2 005507   200020 236100                    LDQ     T1,,AUTO
         2 005510   200015 136100                    SBLQ    SIZE,,AUTO
         2 005511   777777 620006                    EAX0    -1,QL
         2 005512   200015 236100                    LDQ     SIZE,,AUTO
         2 005513   000001 036007                    ADLQ    1,DL
         2 005514   000000 124545                    SCM     mask='000'O
         2 005515   000000 200010                    ADSC9   0,A,PR0                  cn=1,n=*X0
         2 005516   000012 000001 3                  ADSC9   10                       cn=0,n=1
         2 005517   200015 000100                    ARG     SIZE,,AUTO
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:223  
         2 005520   200015 056100                    ASQ     SIZE,,AUTO

     1073     1727    4         END;

   1727  2 005521   200015 236100                    LDQ     SIZE,,AUTO
         2 005522   200020 116100                    CMPQ    T1,,AUTO
         2 005523   005476 604000 2                  TMI     s:1725
         2 005524   005570 710000 2                  TRA     s:1738

     1074     1728    3      CASE (%XSP_ASN1_CP6TYP_TEXTFPTSIZ);  /* Size is in FPT.DAT$+1              */

     1075     1729    3         SIZE = FPT.DATSIZ(VNODE.FPTPTR+1);

   1729  2 005525   000002 720100                    LXL0    2,,PR0
         2 005526   000077 360003                    ANX0    63,DU
         2 005527   200006 471500                    LDP1    PTRS+2,,AUTO
         2 005530   100016 235110                    LDA     14,X0,PR1
         2 005531   200015 755100                    STA     SIZE,,AUTO

     1076     1730    3         IF T1=0 THEN T1=SIZE;

   1730  2 005532   200020 236100                    LDQ     T1,,AUTO
         2 005533   005570 601000 2                  TNZ     s:1738

   1730  2 005534   200020 755100                    STA     T1,,AUTO
         2 005535   005570 710000 2                  TRA     s:1738

     1077     1731    3      CASE (ELSE);

     1078     1732    3         IF VNODE.VALUE_EXISTS AND VNODE.DEFAULT_EXISTS

   1732  2 005536   000002 236100                    LDQ     2,,PR0
         2 005537   200000 316007                    CANQ    65536,DL
         2 005540   005554 600000 2                  TZE     s:1734
         2 005541   400000 316007                    CANQ    -131072,DL
         2 005542   005554 600000 2                  TZE     s:1734

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:224  
     1079     1733    3         THEN PTRS.VAL$ = PINCRC(PTRS.VAL$,BYTES(0)+1);

   1733  2 005543   200007 471500                    LDP1    PTRS+3,,AUTO
         2 005544   000100 101500                    MRL     fill='000'O
         2 005545   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 005546   200030 000004                    ADSC9   VALLIM+5,,AUTO           cn=0,n=4
         2 005547   200030 236100                    LDQ     VALLIM+5,,AUTO
         2 005550   000020 736000                    QLS     16
         2 005551   200000 036007                    ADLQ    65536,DL
         2 005552   200007 036100                    ADLQ    PTRS+3,,AUTO
         2 005553   200007 756100                    STQ     PTRS+3,,AUTO

     1080     1734    3         SIZE = BYTES(0);

   1734  2 005554   200007 471500                    LDP1    PTRS+3,,AUTO
         2 005555   000100 101500                    MRL     fill='000'O
         2 005556   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 005557   200015 000004                    ADSC9   SIZE,,AUTO               cn=0,n=4

     1081     1735    3         IF T1=0 THEN T1 = SIZE+1;

   1735  2 005560   200020 235100                    LDA     T1,,AUTO
         2 005561   005565 601000 2                  TNZ     s:1736

   1735  2 005562   200015 236100                    LDQ     SIZE,,AUTO
         2 005563   000001 036007                    ADLQ    1,DL
         2 005564   200020 756100                    STQ     T1,,AUTO

     1082     1736    3         PTRS.VAL$ = PINCRC(PTRS.VAL$,1);

   1736  2 005565   200007 236100                    LDQ     PTRS+3,,AUTO
         2 005566   200000 036007                    ADLQ    65536,DL
         2 005567   200007 756100                    STQ     PTRS+3,,AUTO

     1083     1737    3      END;

     1084     1738    2      RETURN;
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:225  

   1738  2 005570   200024 221300                    LDX1  ! VALLIM+1,,AUTO
         2 005571   000001 702211                    TSX2  ! 1,X1

YEARS
 Sect OctLoc
   0     000   000000 000000   000000 000555   000000 001332   000000 002110    ...............H
   0     004   000000 002665   000000 003442   000000 004217   000000 004775    ................
   0     010   000000 005552   000000 006327   000000 007104   000000 007662    ...........D....
   0     014   000000 010437   000000 011214   000000 011771   000000 012547    ................
   0     020   000000 013324   000000 014101   000000 016626   000000 015434    .......A........
   0     024   000000 016211   000000 016766   000000 017543   000000 020321    ................
   0     030   000000 021076   000000 021653   000000 022430   000000 023206    ...>............
   0     034   000000 023763   000000 024540   000000 025315   000000 026073    ...............;
   0     040   000000 026650   000000 027425   000000 030202   000000 030760    ................
   0     044   000000 031535   000000 032312   000000 033067   000000 033645    ...........7....
   0     050   000000 034422   000000 035177   000000 035754                    ............

MONTHS
 Sect OctLoc
   0     053   000000 000000   000000 000037   000000 000074   000000 000133    ...........<...[
   0     057   000000 000171   000000 000230   000000 000266   000000 000325    ...y............
   0     063   000000 000364   000000 000422   000000 000461   000000 000517    ................
   0     067   ****** ******                                                    ....

SIGNS
 Sect OctLoc
   0     070   000000 000000   000000 000200   000000 100000   000040 000000    ..........@.. ..
   0     074   020000 000000   000000 000000                                    ........

NSIGNS
 Sect OctLoc
   0     076   000000 000000   777777 777400   777777 600000   777700 000000    ................
   0     102   740000 000000                                                    ....

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:226  
   0     103   061071 040040   062060 040040   000000 177400                    19  20  ....

XSP_UTC_OFFSET
 Sect OctLoc
   1     000   055060 070060   060*** ******                                    -0800...

XSP_UTC_OFFSETN
 Sect OctLoc
   1     002   777370 250000                                                    ....

(unnamed)
 Sect OctLoc
   3     000   000000 006014   000001 000000   000000 000000   400000 000000    ................
   3     004   000077 777777   777777 777777   000777 777777   000001 777777    .?..............
   3     010   000003 641100   055040 040040   040040 040040   777777 777730    ...@-       ....
   3     014   777775 014273   777777 777767   000040 040040   577777 777777    .........   ....
   3     020   677777 777777   000001 600000   000007 760000   377777 777777    ................
   3     024   000077 600000   000003 770000   000020 365400   000040 753000    .?........... ..
   3     030   000001 277100   056040 040040   200040 040040   201040 040040    ...@.   .   .
   3     034   377040 040040                                                    .
     1085     1739    2   END GETVALN;
     1086     1740    1   END XSP$ASN1;
     1087     1741        %EOD;

PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:227  
--  Include file information  --

   XSP_ASN1_M.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$ASN1.
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:228  

 **** Variables and constants ****

  ****  Section 000 RoData XSP$ASN1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    53-0-0/w UBIN        r     1 MONTHS(0:12)              76-0-0/b BIT         r     1 NSIGNS(0:4)
    70-0-0/b BIT         r     1 SIGNS(0:5)                 0-0-0/w UBIN        r     1 YEARS(0:42)

  ****  Section 001  Data  XSP$ASN1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)     r     1 XSP_UTC_OFFSET             2-0-0/w SBIN        r     1 XSP_UTC_OFFSETN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM                     21-0-0/w SBIN        r     1 ERR
    13-0-0/w SBIN        r     1 I                         13-0-0/w UBIN        r     1 IU
    17-0-0/w SBIN        r     1 LNGX                      *0-0-0/d STRC(468)   r     1 PARM
     4-0-0/w STRC(180)   r     1 PTRS                      15-0-0/w SBIN        r     1 SIZE
    15-0-0/w UBIN        r     1 SIZEU                     20-0-0/w SBIN        r     1 T1
    14-0-0/w UBIN        r     1 TAG                       14-0-0/w STRC        r     1 TAG7
    16-0-0/w SBIN        r     1 TAGX                      11-0-0/w STRC(72)    r     1 VAL
    22-0-0/w BIT         r     1 VALB(0:35)                11-0-0/w CHAR(8)     r     1 VALC
    23-0-0/w SBIN        r     1 VALLIM                    11-0-0/c UBIN(8)     r     1 VALP(0:8)
    11-0-0/c STRC(72)    r     1 VALSHF                    11-0-0/c UBIN(9)     r     1 VALU(0:7)
    22-0-0/w SBIN        r     1 VALX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:229  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b ABIT        r     1 BITS                       0-0-0/b ABIT        r     1 BITS
     0-0-0/c UBIN(9)     r     1 BYTES(0:0)                 0-0-0/c UBIN(9)     r     1 BYTES(0:0)
     0-0-0/w STRC        r     1 C1                         0-0-0/w STRC        r     1 C2
     0-0-0/w STRC        r     1 C3                         0-0-0/c CHAR(4000)  r     1 CHARS
     0-0-0/c CHAR(4000)  r     1 CHARS                      0-0-0/w STRC(504)   r     1 FPT
     0-0-0/w UBIN(18)    r     1 HWORD                      0-0-0/w UBIN(18)    r     1 HWORD
     0-0-0/w STRC(144)   r     1 NODE                       0-0-0/c CHAR(4000)  r     1 TXT
     0-0-0/c ACHR        r     1 VALTXT                     0-0-0/w STRC(144)   r     1 VNODE
     0-0-0/w UBIN        r     1 WORDS(0:0)                 0-0-0/w UBIN        r     1 WORDS(0:0)


   Procedure XSP$ASN1 requires 2938 words for executable code.
   Procedure XSP$ASN1 requires 26 words of local(AUTO) storage.
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:230  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:231  
          MINI XREF LISTING

BITS IN PROCEDURE GETVALN
      1621**DCL      1676<<ASSIGN   1676>>ASSIGN   1703<<ASSIGN   1703>>ASSIGN
BITS IN PROCEDURE PUTVALN
      1167**DCL      1205<<ASSIGN   1205>>ASSIGN   1228<<ASSIGN   1228>>ASSIGN
BIT_1
      1442**LABEL    1430--GOTO
BIT_2
      1441**LABEL    1431--GOTO
BIT_3
      1440**LABEL    1432--GOTO
BIT_4
      1439**LABEL    1433--GOTO
BIT_5
      1438**LABEL    1434--GOTO
BIT_6
      1437**LABEL    1435--GOTO
BYTES IN PROCEDURE GETVALN
      1623**DCL      1712--ASSIGN   1714--ASSIGN   1733>>ASSIGN   1734>>ASSIGN
BYTES IN PROCEDURE PUTVALN
      1169**DCL      1232--ASSIGN   1235--ASSIGN   1250>>ASSIGN   1260<<ASSIGN   1263<<ASSIGN
C1.C
       680**DCL      1546>>ASSIGN   1548>>ASSIGN   1550>>ASSIGN   1552>>ASSIGN   1554>>ASSIGN   1577>>ASSIGN
      1584>>ASSIGN   1598>>ASSIGN
C2.C
       683**DCL      1606>>ASSIGN
C3.C
       686**DCL      1588>>ASSIGN
CHARS IN PROCEDURE GETVALN
      1622**DCL      1649>>IF       1654>>ASSIGN   1699>>ASSIGN   1725>>IF       1726>>CALLBLT
CHARS IN PROCEDURE PUTVALN
      1168**DCL      1189<<ASSIGN   1224<<ASSIGN
END_CHOICE
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:232  
      1385**LABEL    1362--GOTO     1372--CALLALT  1375--GOTO     1387--GOTO
END_CONSTR
       843**LABEL     795--GOTO      820--GOTO      837--GOTO
ERR
       715**DCL       737<<ASSIGN   1050<<ASSIGN   1050>>ASSIGN   1051<<ASSIGN   1051>>ASSIGN   1052<<ASSIGN
      1052>>ASSIGN   1053<<ASSIGN   1053>>ASSIGN   1054<<ASSIGN   1054>>ASSIGN   1055<<ASSIGN   1055>>ASSIGN
      1056<<ASSIGN   1056>>ASSIGN   1057<<ASSIGN   1057>>ASSIGN   1059>>IF       1059>>ASSIGN   1072<<ASSIGN
      1072>>ASSIGN   1159<<ASSIGN   1159>>ASSIGN   1160<<ASSIGN   1160>>ASSIGN   1161<<ASSIGN   1161>>ASSIGN
ERR_BAD_SIZE
      1056**LABEL     904--GOTO      913--GOTO      925--GOTO      969--GOTO     1296--GOTO     1309--GOTO
      1320--GOTO
ERR_BAD_VALUE
      1052**LABEL     886--GOTO      996--GOTO     1001--GOTO     1010--GOTO     1012--GOTO
ERR_BIG_LNG IN PROCEDURE GET_TAG
      1159**LABEL    1132--GOTO     1145--GOTO     1149--GOTO     1155--GOTO
ERR_BIG_TAG IN PROCEDURE GET_TAG
      1160**LABEL    1122--GOTO
ERR_BIG_VALUE
      1051**LABEL     858--GOTO      862--GOTO      881--GOTO      920--CALLALT   949--CALLALT   965--GOTO
       976--GOTO
ERR_NOT_PRIM
      1055**LABEL     857--GOTO      903--GOTO      912--GOTO      917--GOTO
ERR_NOT_STR
      1054**LABEL     783--GOTO
ERR_NO_TAG IN PROCEDURE GET_TAG
      1161**LABEL    1102--GOTO     1127--GOTO
ERR_STR_SIZE
      1053**LABEL     850--GOTO      853--GOTO
ERR_WONT_FIT
      1050**LABEL     942--GOTO     1027--GOTO
ERR_WRONG_TAG
      1057**LABEL     752--GOTO      774--GOTO      807--GOTO     1284--GOTO
FIX_LNG
      1595**PROC     1353--CALL     1391--CALL     1478--CALL
FPT.C0
       643**DCL       643--REDEF
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:233  
FPT.CONDITION
       643**DCL       751>>IF       1341>>IF
FPT.DAT$
       645**DCL       645--REDEF    1178>>ASSIGN   1180<<ASSIGN   1216>>ASSIGN   1218<<ASSIGN   1232>>ASSIGN
      1235<<ASSIGN   1235>>ASSIGN   1638>>ASSIGN   1640<<ASSIGN   1692>>ASSIGN   1694<<ASSIGN   1712>>ASSIGN
      1714<<ASSIGN   1714>>ASSIGN
FPT.DATSIZ
       645**DCL      1244>>ASSIGN   1258<<ASSIGN   1729>>ASSIGN
FPT.N0
       644**DCL       644--REDEF
FPT.NULLRSLT
       644**DCL       914<<ASSIGN
FPT.R0
       642**DCL       643--REDEF
FPT.RESULT
       643**DCL       782<<ASSIGN
FPT.UENTRY$
       641**DCL       744>>CALL     1043>>CALL     1062>>CALL     1335>>CALL     1526>>CALL
GETVALB IN PROCEDURE GETVALN
      1682**ENTRY    1425--CALL     1448--CALL
GETVALN
      1619**PROC     1366--CALL     1379--CALL     1397--CALL     1481--CALL
GETVALPTR IN PROCEDURE PUTVALN
      1231**ENTRY     918--CALL     1026--CALL
GETVALPTR1 IN PROCEDURE PUTVALN
      1246**LABEL    1246--GOTO
GETVALTXT IN PROCEDURE GETVALN
      1707**ENTRY    1462--CALL     1518--CALL
GET_7S
      1070**PROC      920--CALL      949--CALL
GET_TAG
      1092**PROC      741--CALL      790--CALL      802--CALL      826--CALL      841--CALL      852--CALL
GOT_UTC_TIME
      1015**LABEL     999--GOTO     1006--GOTO
HWORD IN PROCEDURE GETVALN
      1624**DCL      1720>>ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:234  
HWORD IN PROCEDURE PUTVALN
      1170**DCL      1240>>ASSIGN   1256<<ASSIGN
I
       706**DCL       707--REDEF     760<<ASSIGN    761<<DOINDEX   762>>IF        763>>IF        764>>ASSIGN
       774>>IF        775>>ASSIGN    784<<ASSIGN    789<<DOINDEX   791>>ASSIGN    792>>ASSIGN    804<<ASSIGN
       806<<ASSIGN    806>>ASSIGN    807>>IF        808>>IF        810>>ASSIGN    814<<DOINDEX   816>>ASSIGN
       858>>IF        860>>ASSIGN    860>>ASSIGN    860>>ASSIGN    861>>ASSIGN    863>>IF        864>>IF
       869>>IF        871>>IF        871>>ASSIGN    878<<ASSIGN    881>>IF        883>>ASSIGN    883>>ASSIGN
       887<<ASSIGN    887>>ASSIGN    889>>IF        891>>IF        893>>IF        895>>IF        904>>IF
       913>>IF        925>>IF        948>>IF        960<<ASSIGN    967<<ASSIGN    967>>ASSIGN    969>>IF
       981<<ASSIGN    981>>ASSIGN    984>>DOWHILE   986<<ASSIGN    986>>ASSIGN    993<<ASSIGN    993>>ASSIGN
      1001>>IF       1022<<ASSIGN   1027>>IF       1028>>ASSIGN   1029>>ASSIGN   1034>>ASSIGN   1071>>CALLBLT
      1080<<ASSIGN   1080>>ASSIGN   1213>>ASSIGN   1278<<ASSIGN   1281>>ASSIGN   1282<<ASSIGN   1282>>ASSIGN
      1289<<ASSIGN   1289>>ASSIGN   1293<<ASSIGN   1293>>ASSIGN   1297<<ASSIGN   1297>>ASSIGN   1299>>ASSIGN
      1305>>ASSIGN   1311>>ASSIGN   1312<<ASSIGN   1312>>ASSIGN   1314>>ASSIGN   1316<<ASSIGN   1316>>ASSIGN
      1317<<ASSIGN   1318>>IF       1324>>ASSIGN   1347<<DOINDEX  1348>>ASSIGN   1384<<DOINDEX  1385>>ASSIGN
      1427<<ASSIGN   1443>>ASSIGN   1469<<CALLBLT  1470>>IF       1471>>CALLBLT  1473>>ASSIGN   1474>>ASSIGN
      1491<<ASSIGN   1492<<ASSIGN   1494>>ASSIGN   1495>>IF       1496<<ASSIGN   1496>>ASSIGN   1497<<ASSIGN
      1498>>IF       1498<<ASSIGN   1498>>ASSIGN   1500<<ASSIGN   1500>>ASSIGN   1502<<ASSIGN   1504<<ASSIGN
      1506<<ASSIGN   1511<<ASSIGN   1534>>CALLBLT  1569>>ASSIGN   1570>>IF
INT_1
      1420**LABEL    1412--GOTO
INT_2
      1419**LABEL    1413--GOTO
INT_3
      1418**LABEL    1414--GOTO
INT_4
      1417**LABEL    1415--GOTO
IU
       707**DCL       808>>IF        811>>ASSIGN    815>>IF
LNGX
       713**DCL       758<<ASSIGN    766>>IF        768>>IF       1285<<ASSIGN   1286>>IF       1287>>IF
      1287<<ASSIGN   1290>>IF       1290<<ASSIGN   1291>>IF       1292<<ASSIGN   1295<<ASSIGN   1295>>ASSIGN
      1296>>IF       1297>>ASSIGN   1298>>IF       1298<<ASSIGN   1299>>ASSIGN   1299>>ASSIGN   1299>>ASSIGN
      1299>>ASSIGN   1300<<ASSIGN   1304>>ASSIGN   1307<<ASSIGN   1309>>IF       1312<<ASSIGN   1312>>ASSIGN
      1314>>ASSIGN   1314>>ASSIGN   1315>>ASSIGN   1316>>ASSIGN   1329<<ASSIGN   1357<<ASSIGN   1391>>IF
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:235  
      1581<<ASSIGN   1596>>ASSIGN   1597>>IF       1598>>ASSIGN   1600>>ASSIGN   1606>>ASSIGN   1608>>ASSIGN
      1608>>ASSIGN   1611>>ASSIGN   1612>>ASSIGN   1612>>ASSIGN
MONTHS
       725**DCL       980>>ASSIGN   1498>>IF       1500>>ASSIGN
NODE
       392**DCL       759--ASSIGN    787--ASSIGN    798--ASSIGN    843--ASSIGN   1345--ASSIGN   1382--ASSIGN
NODE.CONDITION
       393**DCL       751>>IF       1341>>IF
NODE.CONSTRUCTED
       393**DCL       783>>IF       1567>>IF       1570>>IF
NODE.CP6TYP
       392**DCL       759>>IF        787>>IF        798>>IF        831>>IF        843>>IF       1345>>IF
      1382>>IF
NODE.DEFAULT
       467**DCL      1398>>IF       1540>>IF
NODE.DEFAULTB
       467**DCL      1426>>IF       1451>>IF
NODE.DEFAULT_EXISTS
       432**DCL       750>>IF       1398>>IF       1426>>IF       1451>>IF
NODE.FAIL.RCV
       415**DCL      1060>>IF
NODE.IMPLICIT
       415**DCL       748>>IF        788>>IF        792>>IF       1346>>IF       1349>>IF       1560>>IF
      1568>>IF
NODE.NSUBNDS
       432**DCL       761>>DOINDEX   774>>IF        789>>DOINDEX   807>>IF        814>>DOINDEX  1347>>DOINDEX
      1379>>IF       1384>>DOINDEX
NODE.OPTIONL
       412**DCL       751>>IF       1341>>IF       1367>>IF       1463>>IF       1519>>IF
NODE.ORDERED
       415**DCL       760>>IF
NODE.PRE.RCV
       413**DCL       742>>IF
NODE.PRE.SND
       413**DCL      1333>>IF
NODE.SHORT
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:236  
       417**DCL      1582>>IF
NODE.SUBND$
       467**DCL       467--REDEF     467--REDEF     467--REDEF     468--REDEF     468--REDEF     760>>ASSIGN
       762>>IF        763>>IF        764>>ASSIGN    775>>ASSIGN    791>>ASSIGN    808>>IF        810>>ASSIGN
       816>>ASSIGN    825>>ASSIGN    842>>ASSIGN   1348>>ASSIGN   1371>>ASSIGN   1385>>ASSIGN   1570>>IF
NODE.SUCC.RCV
       414**DCL      1041>>IF
NODE.SUCC.SND
       414**DCL      1524>>IF
NODE.TAG
       412**DCL       412--REDEF     748>>IF        760>>ASSIGN    762>>IF        792>>ASSIGN    792>>ASSIGN
       808>>IF       1346>>IF       1369>>IF       1378>>IF       1569>>ASSIGN   1572>>ASSIGN
NODE.TAGS
       416**DCL      1379>>IF
NODE.TYPE
       392**DCL       749>>IF        763>>IF        785>>DOCASE    957>>ASSIGN   1274>>ASSIGN   1343>>DOCASE
      1482>>IF
NSIGNS
       729**DCL       871>>ASSIGN
PARM
       370**DCL         9--PROC      735--ENTRY     744<>CALL      765<>CALL      776<>CALL      793<>CALL
       812<>CALL      817<>CALL      828<>CALL      844<>CALL      877<>CALL      959<>CALL     1021<>CALL
      1043<>CALL     1062<>CALL     1272--ENTRY    1306<>CALL     1327--ENTRY    1335<>CALL     1352<>CALL
      1360<>CALL     1372<>CALL     1386<>CALL     1526<>CALL
PARM.ABORT
       379**DCL      1564>>UNWIND
PARM.ERR
       379**DCL       768>>IF        770<<ASSIGN   1059<<ASSIGN   1064>>IF       1563<<ASSIGN
PARM.IMPLICIT
       378**DCL      1351<<ASSIGN   1358<<ASSIGN   1560>>IF
PARM.MAXX
       379**DCL       740>>ASSIGN   1101>>ASSIGN   1128>>ASSIGN   1132>>IF       1146>>ASSIGN   1155>>IF
      1561>>IF       1562>>IF
PARM.NXTX
       379**DCL       758>>ASSIGN    766>>IF        768>>IF        784>>ASSIGN    849>>IF        860>>ASSIGN
       861<<ASSIGN    861>>ASSIGN    878>>ASSIGN    883>>ASSIGN    884<<ASSIGN    906>>ASSIGN    907<<ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:237  
       907>>ASSIGN    960>>ASSIGN    964>>IF        964>>IF        966<<ASSIGN    966>>ASSIGN    970>>CALLBLT
       985>>ASSIGN    987<<ASSIGN    987>>ASSIGN    991>>CALLBLT   994<<ASSIGN    994>>ASSIGN   1002>>CALLBLT
      1022>>ASSIGN   1028>>ASSIGN   1032>>ASSIGN   1033<<ASSIGN   1071>>CALLBLT  1078>>ASSIGN   1079<<ASSIGN
      1079>>ASSIGN   1094>>IF       1101>>ASSIGN   1103>>ASSIGN   1128<<ASSIGN   1131>>ASSIGN   1136<<ASSIGN
      1136>>ASSIGN   1140<<ASSIGN   1140>>ASSIGN   1146<<ASSIGN   1148>>ASSIGN   1154>>ASSIGN   1277>>ASSIGN
      1278>>ASSIGN   1279>>ASSIGN   1305<<ASSIGN   1322<<ASSIGN   1355<<ASSIGN   1421>>ASSIGN   1422<<ASSIGN
      1422>>ASSIGN   1444>>ASSIGN   1445<<ASSIGN   1445>>ASSIGN   1454>>ASSIGN   1455<<ASSIGN   1455>>ASSIGN
      1486>>ASSIGN   1487<<ASSIGN   1487>>ASSIGN   1509>>ASSIGN   1510<<ASSIGN   1510>>ASSIGN   1514>>ASSIGN
      1515<<ASSIGN   1515>>ASSIGN   1521>>ASSIGN   1522<<ASSIGN   1522>>ASSIGN   1534>>CALLBLT  1535<<ASSIGN
      1535>>ASSIGN   1540>>IF       1546>>ASSIGN   1546<<ASSIGN   1546>>ASSIGN   1548>>ASSIGN   1548<<ASSIGN
      1548>>ASSIGN   1550>>ASSIGN   1550<<ASSIGN   1550>>ASSIGN   1552>>ASSIGN   1552<<ASSIGN   1552>>ASSIGN
      1554>>ASSIGN   1554<<ASSIGN   1554>>ASSIGN   1561>>IF       1562>>IF       1577>>ASSIGN   1578>>ASSIGN
      1579<<ASSIGN   1579>>ASSIGN   1581>>ASSIGN   1584>>ASSIGN   1585<<ASSIGN   1585>>ASSIGN   1588>>ASSIGN
      1590<<ASSIGN   1590>>ASSIGN   1596>>ASSIGN   1601>>ASSIGN   1602<<ASSIGN   1602>>ASSIGN   1609<<ASSIGN
      1609>>ASSIGN   1613<<ASSIGN   1613>>ASSIGN
PARM.P
       372**DCL       738>>ASSIGN   1273>>ASSIGN   1331>>ASSIGN
PARM.P.NODE$
       375**DCL       764<<ASSIGN    775<<ASSIGN    791<<ASSIGN    792>>ASSIGN    810<<ASSIGN    816<<ASSIGN
       825<<ASSIGN    842<<ASSIGN   1348<<ASSIGN   1371<<ASSIGN   1385<<ASSIGN
PARM.P.VAL$
       375**DCL      1032<<ASSIGN   1174<<ASSIGN   1212<<ASSIGN   1338>>ASSIGN   1339<<ASSIGN
PARM.P.VNODE$
       376**DCL       759<<ASSIGN    787<<ASSIGN    798<<ASSIGN    843<<ASSIGN    846>>IF        847<<ASSIGN
       848<<ASSIGN   1345<<ASSIGN   1382<<ASSIGN   1392>>IF       1393<<ASSIGN   1394<<ASSIGN
PARM.PARSED
       378**DCL       741>>IF        766>>IF        788<<ASSIGN    790>>IF        852>>IF       1040<<ASSIGN
      1157<<ASSIGN
PARM.SIZE
       379**DCL       747>>ASSIGN    851>>IF        878>>ASSIGN    879<<ASSIGN    884>>ASSIGN    960>>ASSIGN
       961<<ASSIGN   1022>>ASSIGN   1023<<ASSIGN   1033>>ASSIGN   1034<<ASSIGN   1098<<ASSIGN   1109<<ASSIGN
      1131<<ASSIGN   1132>>IF       1134<<ASSIGN   1154<<ASSIGN   1155>>IF       1175<<ASSIGN   1213<<ASSIGN
      1276>>ASSIGN   1304<<ASSIGN   1307>>ASSIGN   1323<<ASSIGN
PARM.TAG
       379**DCL       746>>ASSIGN    792<<ASSIGN    851>>IF        879>>ASSIGN    961>>ASSIGN   1023>>ASSIGN
      1097<<ASSIGN   1108<<ASSIGN   1126<<ASSIGN   1317>>ASSIGN   1324<<ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:238  
PARM.TAGC
       378**DCL       783>>IF        857>>IF        876>>IF        903>>IF        912>>IF        917>>IF
       958>>IF       1020>>IF       1105<<ASSIGN   1106<<ASSIGN
PARM.USR
       378**DCL       743<<ASSIGN   1042<<ASSIGN   1061<<ASSIGN   1334<<ASSIGN   1525<<ASSIGN
PTRS
       658**DCL       738<<ASSIGN   1273<<ASSIGN   1331<<ASSIGN
PTRS.BUF$
       666**DCL       675--IMP-PTR   860>>ASSIGN    883>>ASSIGN    906>>ASSIGN    964>>IF        964>>IF
       970>>CALLBLT   985>>ASSIGN    991>>CALLBLT  1002>>CALLBLT  1028>>ASSIGN   1032>>ASSIGN   1071>>CALLBLT
      1078>>ASSIGN   1103>>ASSIGN   1148>>ASSIGN   1281>>ASSIGN   1299>>ASSIGN   1311>>ASSIGN   1311>>ASSIGN
      1314>>ASSIGN   1314>>ASSIGN   1319>>IF       1421>>ASSIGN   1444>>ASSIGN   1454>>ASSIGN   1486>>ASSIGN
      1509>>ASSIGN   1514>>ASSIGN   1521>>ASSIGN   1534>>CALLBLT  1540>>IF       1546>>ASSIGN   1548>>ASSIGN
      1550>>ASSIGN   1552>>ASSIGN   1554>>ASSIGN   1577>>ASSIGN   1584>>ASSIGN   1588>>ASSIGN   1597>>IF
      1598>>ASSIGN   1600>>ASSIGN   1601>>ASSIGN   1606>>ASSIGN   1608>>ASSIGN   1608>>ASSIGN   1611>>ASSIGN
      1612>>ASSIGN   1612>>ASSIGN
PTRS.FPT$
       666**DCL       637--IMP-PTR   744>>CALL      751>>IF        782>>ASSIGN    914>>ASSIGN   1043>>CALL
      1062>>CALL     1178>>ASSIGN   1180>>ASSIGN   1216>>ASSIGN   1218>>ASSIGN   1232>>ASSIGN   1235>>ASSIGN
      1235>>ASSIGN   1244>>ASSIGN   1258>>ASSIGN   1335>>CALL     1341>>IF       1526>>CALL     1638>>ASSIGN
      1640>>ASSIGN   1692>>ASSIGN   1694>>ASSIGN   1712>>ASSIGN   1714>>ASSIGN   1714>>ASSIGN   1729>>ASSIGN
PTRS.NODE$
       666**DCL       392--IMP-PTR   739>>ASSIGN    742>>IF        748>>IF        748>>IF        749>>IF
       750>>IF        751>>IF        751>>IF        759>>IF        759>>ASSIGN    760>>IF        760>>ASSIGN
       761>>DOINDEX   762>>IF        763>>IF        764>>ASSIGN    774>>IF        775>>ASSIGN    783>>IF
       785>>DOCASE    787>>IF        787>>ASSIGN    788>>IF        789>>DOINDEX   791>>ASSIGN    792>>IF
       792>>ASSIGN    798>>IF        798>>ASSIGN    807>>IF        808>>IF        810>>ASSIGN    814>>DOINDEX
       816>>ASSIGN    825>>ASSIGN    831>>IF        842>>ASSIGN    843>>IF        843>>ASSIGN    847>>IF
       957>>ASSIGN   1041>>IF       1060>>IF       1274>>ASSIGN   1332>>ASSIGN   1333>>IF       1341>>IF
      1341>>IF       1343>>DOCASE   1345>>IF       1345>>ASSIGN   1346>>IF       1346>>IF       1347>>DOINDEX
      1348>>ASSIGN   1349>>IF       1367>>IF       1369>>IF       1371>>ASSIGN   1378>>IF       1379>>IF
      1379>>IF       1382>>IF       1382>>ASSIGN   1384>>DOINDEX  1385>>ASSIGN   1393>>IF       1398>>IF
      1398>>IF       1426>>IF       1426>>IF       1451>>IF       1451>>IF       1463>>IF       1482>>IF
      1519>>IF       1524>>IF       1560>>IF       1567>>IF       1568>>IF       1569>>ASSIGN   1570>>IF
      1572>>ASSIGN   1582>>IF
PTRS.VAL$
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:239  
       666**DCL       674--IMP-PTR   922>>CALLBLT   944>>ASSIGN    945>>CALLBLT   952>>ASSIGN   1028>>ASSIGN
      1168--IMP-PTR  1169--IMP-PTR  1170--IMP-PTR  1171--IMP-PTR  1178<<ASSIGN   1180>>ASSIGN   1186<<ASSIGN
      1186>>ASSIGN   1189>>ASSIGN   1192<<ASSIGN   1192>>ASSIGN   1195>>ASSIGN   1197>>ASSIGN   1198>>ASSIGN
      1202<<ASSIGN   1202>>ASSIGN   1205>>ASSIGN   1216<<ASSIGN   1218>>ASSIGN   1224>>ASSIGN   1226>>ASSIGN
      1227>>ASSIGN   1228>>ASSIGN   1232<<ASSIGN   1240>>ASSIGN   1250>>ASSIGN   1256>>ASSIGN   1260>>ASSIGN
      1263>>ASSIGN   1338<<ASSIGN   1465>>ASSIGN   1466<<ASSIGN   1466>>ASSIGN   1469>>CALLBLT  1471>>CALLBLT
      1474<<ASSIGN   1474>>ASSIGN   1521>>ASSIGN   1622--IMP-PTR  1623--IMP-PTR  1624--IMP-PTR  1625--IMP-PTR
      1632>>IF       1633>>ASSIGN   1638<<ASSIGN   1640>>ASSIGN   1646<<ASSIGN   1646>>ASSIGN   1649>>IF
      1654>>ASSIGN   1657<<ASSIGN   1657>>ASSIGN   1660>>ASSIGN   1663>>ASSIGN   1669<<ASSIGN   1669>>ASSIGN
      1676>>ASSIGN   1687>>IF       1688>>ASSIGN   1692<<ASSIGN   1694>>ASSIGN   1699>>ASSIGN   1701>>ASSIGN
      1702>>ASSIGN   1703>>ASSIGN   1711>>IF       1712<<ASSIGN   1716<<ASSIGN   1717<<ASSIGN   1720>>ASSIGN
      1722<<ASSIGN   1722>>ASSIGN   1725>>IF       1726>>CALLBLT  1733<<ASSIGN   1733>>ASSIGN   1733>>ASSIGN
      1734>>ASSIGN   1736<<ASSIGN   1736>>ASSIGN
PTRS.VNODE$
       667**DCL       480--IMP-PTR   739>>IF        739<<ASSIGN    782>>IF        782>>ASSIGN    847>>IF
       847>>ASSIGN    914>>IF        914>>ASSIGN    918>>IF       1025>>IF       1173>>IF       1178>>ASSIGN
      1179>>IF       1180>>ASSIGN   1180>>ASSIGN   1181>>ASSIGN   1183>>IF       1189>>ASSIGN   1190>>IF
      1195>>ASSIGN   1197>>ASSIGN   1198>>ASSIGN   1205>>ASSIGN   1211>>IF       1216>>ASSIGN   1217>>IF
      1218>>ASSIGN   1218>>ASSIGN   1219>>ASSIGN   1222>>IF       1224>>ASSIGN   1225>>IF       1226>>ASSIGN
      1227>>ASSIGN   1228>>ASSIGN   1232>>ASSIGN   1232>>ASSIGN   1233>>ASSIGN   1234>>IF       1235>>ASSIGN
      1235>>ASSIGN   1236>>ASSIGN   1238>>DOCASE   1244>>ASSIGN   1246>>IF       1254>>DOCASE   1258>>ASSIGN
      1263>>IF       1332>>IF       1332<<ASSIGN   1365>>IF       1365>>ASSIGN   1393>>IF       1393>>ASSIGN
      1628>>IF       1629>>ASSIGN   1629>>ASSIGN   1635>>IF       1638>>ASSIGN   1639>>IF       1640>>ASSIGN
      1640>>ASSIGN   1641>>ASSIGN   1643>>IF       1649>>IF       1654>>ASSIGN   1655>>IF       1660>>ASSIGN
      1663>>ASSIGN   1665>>IF       1672>>IF       1676>>ASSIGN   1684>>ASSIGN   1685>>IF       1686>>ASSIGN
      1686>>ASSIGN   1692>>ASSIGN   1693>>IF       1694>>ASSIGN   1694>>ASSIGN   1697>>IF       1699>>ASSIGN
      1700>>IF       1701>>ASSIGN   1702>>ASSIGN   1703>>ASSIGN   1708>>ASSIGN   1709>>ASSIGN   1710>>IF
      1712>>ASSIGN   1712>>ASSIGN   1713>>IF       1714>>ASSIGN   1714>>ASSIGN   1716>>IF       1716>>ASSIGN
      1717>>ASSIGN   1718>>DOCASE   1729>>ASSIGN   1732>>IF       1732>>IF
PUTVALB IN PROCEDURE PUTVALN
      1210**ENTRY     900--CALL      909--CALL
PUTVALN
      1165**PROC      834--CALL      873--CALL     1017--CALL
PUT_2
      1533**PROC     1496--CALL     1499--CALL     1501--CALL     1503--CALL     1505--CALL     1507--CALL
      1512--CALL
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:240  
PUT_71 IN PROCEDURE PUT_7S
      1553**LABEL    1541--GOTO
PUT_72 IN PROCEDURE PUT_7S
      1551**LABEL    1542--GOTO
PUT_73 IN PROCEDURE PUT_7S
      1549**LABEL    1543--GOTO
PUT_74 IN PROCEDURE PUT_7S
      1547**LABEL    1544--GOTO
PUT_7S
      1539**PROC     1475--CALL     1580--CALL
PUT_TAG
      1558**PROC     1346--CALL     1350--CALL     1369--CALL     1378--CALL     1411--CALL     1429--CALL
      1453--CALL     1459--CALL     1464--CALL     1484--CALL     1520--CALL
RETALT
      1053**LABEL     741--CALLALT   744--CALLALT   750--GOTO      753--GOTO      769--GOTO      776--CALLALT
       790--CALLALT   793--CALLALT   802--CALLALT   812--CALLALT   817--CALLALT   826--CALLALT   828--CALLALT
       841--CALLALT   844--CALLALT   852--CALLALT   877--CALLALT   959--CALLALT  1021--CALLALT  1306--CALLALT
SET_LNG IN PROCEDURE PUTVALN
      1253**ENTRY     953--CALL     1030--CALL
SIGNS
       727**DCL       871>>IF
SIZE
       710**DCL       674--IMP-SIZ   711--REDEF     740<<ASSIGN    747<<ASSIGN    784>>ASSIGN    833>>ASSIGN
       835<<ASSIGN    849>>IF        850>>IF        922>>CALLBLT   944>>ASSIGN    945>>CALLBLT   952>>ASSIGN
       977<<ASSIGN    980>>ASSIGN   1028>>ASSIGN   1094>>IF       1098>>ASSIGN   1167--IMP-SIZ  1181<<ASSIGN
      1182>>IF       1182<<ASSIGN   1184<<ASSIGN   1184>>ASSIGN   1185>>IF       1186>>ASSIGN   1187<<ASSIGN
      1189>>ASSIGN   1189>>ASSIGN   1189>>ASSIGN   1191>>IF       1192>>ASSIGN   1193<<ASSIGN   1196>>IF
      1201>>IF       1203<<ASSIGN   1205>>ASSIGN   1205>>ASSIGN   1205>>ASSIGN   1219<<ASSIGN   1220>>IF
      1220<<ASSIGN   1221>>IF       1221<<ASSIGN   1223>>ASSIGN   1227>>IF       1228>>ASSIGN   1228>>ASSIGN
      1276<<ASSIGN   1283>>IF       1318>>IF       1330<<ASSIGN   1368<<ASSIGN   1400<<ASSIGN   1402<<ASSIGN
      1402>>ASSIGN   1404<<ASSIGN   1404>>ASSIGN   1406<<ASSIGN   1406>>ASSIGN   1408<<ASSIGN   1408>>ASSIGN
      1412>>IF       1413>>IF       1414>>IF       1415>>IF       1421>>ASSIGN   1421>>ASSIGN   1421>>ASSIGN
      1422>>ASSIGN   1428<<ASSIGN   1430>>IF       1431>>IF       1432>>IF       1433>>IF       1434>>IF
      1435>>IF       1444>>ASSIGN   1444>>ASSIGN   1445>>ASSIGN   1449<<ASSIGN   1458<<ASSIGN   1463>>IF
      1465>>ASSIGN   1467<<ASSIGN   1467>>ASSIGN   1468>>DOUNTIL  1469>>CALLBLT  1471>>CALLBLT  1473<<ASSIGN
      1473>>ASSIGN   1482<<ASSIGN   1483<<ASSIGN   1485>>IF       1508>>IF       1519>>IF       1521>>ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:241  
      1521>>ASSIGN   1522>>ASSIGN   1561>>IF       1562>>IF       1582>>IF       1583<<ASSIGN   1584--ASSIGN
      1587<<ASSIGN   1587>>ASSIGN   1587>>ASSIGN   1588--ASSIGN   1589<<ASSIGN   1596<<ASSIGN   1597>>IF
      1598--ASSIGN   1604<<ASSIGN   1604>>ASSIGN   1605<<ASSIGN   1605>>ASSIGN   1605>>ASSIGN   1606--ASSIGN
      1607>>IF       1608>>ASSIGN   1608>>ASSIGN   1610>>IF       1612>>ASSIGN   1612>>ASSIGN   1621--IMP-SIZ
      1634<<ASSIGN   1641<<ASSIGN   1642>>IF       1642<<ASSIGN   1644<<ASSIGN   1644>>ASSIGN   1645>>IF
      1646>>ASSIGN   1647<<ASSIGN   1654>>ASSIGN   1654>>ASSIGN   1654>>ASSIGN   1656>>IF       1657>>ASSIGN
      1658<<ASSIGN   1661>>IF       1668>>IF       1670<<ASSIGN   1676>>ASSIGN   1676>>ASSIGN   1676>>ASSIGN
      1684<<ASSIGN   1689>>IF       1689<<ASSIGN   1695>>IF       1695<<ASSIGN   1696>>IF       1696<<ASSIGN
      1698>>ASSIGN   1702>>IF       1703>>ASSIGN   1703>>ASSIGN   1708<<ASSIGN   1717>>ASSIGN   1718>>IF
      1720<<ASSIGN   1721>>ASSIGN   1724>>DOWHILE  1725>>IF       1725>>IF       1726<<CALLBLT  1726>>CALLBLT
      1729<<ASSIGN   1730>>ASSIGN   1734<<ASSIGN   1735>>ASSIGN
SIZEU
       711**DCL       979>>IF       1202>>ASSIGN   1427>>ASSIGN   1428>>ASSIGN   1583>>ASSIGN   1589>>ASSIGN
      1589>>ASSIGN   1669>>ASSIGN
SKIP_STORE
       945**LABEL     943--GOTO
T1
       714**DCL       885<<ASSIGN    886>>IF        887>>ASSIGN    921<<ASSIGN    922>>CALLBLT   923>>ASSIGN
       927<<ASSIGN    930<<ASSIGN    930>>ASSIGN    932<<ASSIGN    932>>ASSIGN    934<<ASSIGN    934>>ASSIGN
       936<<ASSIGN    936>>ASSIGN    938<<ASSIGN    938>>ASSIGN    940<<ASSIGN    940>>ASSIGN    942>>IF
       945>>CALLBLT   947>>ASSIGN    970<<CALLBLT   971>>ASSIGN    973<<ASSIGN    973>>ASSIGN    974>>IF
       974<<ASSIGN    974>>ASSIGN    975<<ASSIGN    975>>ASSIGN    976>>IF        977>>ASSIGN    978<<ASSIGN
       978>>ASSIGN    979>>IF        980>>ASSIGN    980>>ASSIGN    985<<ASSIGN    988>>IF        988>>IF
       991<<CALLBLT   992>>ASSIGN    995>>ASSIGN    999>>IF       1000>>IF       1000>>IF       1004>>IF
      1008>>IF       1008>>IF       1071<<CALLBLT  1076>>IF       1077<<ASSIGN   1077>>ASSIGN   1078>>ASSIGN
      1078>>ASSIGN   1078>>ASSIGN   1079>>ASSIGN   1080>>ASSIGN   1081>>IF       1087>>IF       1101<<ASSIGN
      1102>>IF       1103>>ASSIGN   1118<<ASSIGN   1118>>ASSIGN   1127>>IF       1128>>ASSIGN   1144<<ASSIGN
      1144>>ASSIGN   1145>>IF       1146>>ASSIGN   1223<<ASSIGN   1224>>ASSIGN   1224>>ASSIGN   1279<<ASSIGN
      1311>>ASSIGN   1319>>IF       1322>>ASSIGN   1545<<ASSIGN   1546--ASSIGN   1547<<ASSIGN   1548--ASSIGN
      1549<<ASSIGN   1550--ASSIGN   1551<<ASSIGN   1552--ASSIGN   1553<<ASSIGN   1554--ASSIGN   1698<<ASSIGN
      1699>>ASSIGN   1699>>ASSIGN   1709<<ASSIGN   1714>>ASSIGN   1721>>IF       1721<<ASSIGN   1724>>DOWHILE
      1725>>IF       1726>>CALLBLT  1730>>IF       1730<<ASSIGN   1735>>IF       1735<<ASSIGN
TAG
       708**DCL       709--REDEF     746<<ASSIGN    748>>IF        748>>IF        749>>IF        760>>ASSIGN
       762>>IF        792>>ASSIGN    803>>IF        808>>IF        827>>IF        853>>IF        957<<ASSIGN
       963>>IF       1008>>IF       1012>>IF       1096<<ASSIGN   1104<<ASSIGN   1112>>ASSIGN   1113<<ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:242  
      1113>>ASSIGN   1114>>IF       1116<<ASSIGN   1121<<ASSIGN   1121>>ASSIGN   1122>>IF       1125<<ASSIGN
      1125>>ASSIGN   1126>>ASSIGN   1127>>IF       1274<<ASSIGN   1275>>IF       1275<<ASSIGN   1284>>IF
      1310>>IF       1319>>IF       1471<<CALLBLT  1472<<ASSIGN   1472>>ASSIGN   1541>>IF       1542>>IF
      1543>>IF       1544>>IF       1569<<ASSIGN   1572<<ASSIGN   1573>>ASSIGN   1574<<ASSIGN   1574>>ASSIGN
      1575>>IF       1575>>ASSIGN   1580>>IF
TAG7.N
       709**DCL      1545>>ASSIGN   1547>>ASSIGN   1549>>ASSIGN   1551>>ASSIGN   1553>>ASSIGN
TAGX
       712**DCL      1112<<ASSIGN   1125>>ASSIGN   1277<<ASSIGN   1314>>ASSIGN   1315<<ASSIGN   1315>>ASSIGN
      1323>>ASSIGN   1355>>ASSIGN   1566<<ASSIGN   1567<<ASSIGN   1570<<ASSIGN   1573<<ASSIGN   1573>>ASSIGN
      1575<<ASSIGN   1575>>ASSIGN   1576<<ASSIGN   1576>>ASSIGN   1577--ASSIGN   1578<<ASSIGN
TXT
       675**DCL       860>>ASSIGN    883>>ASSIGN    906>>ASSIGN    964>>IF        964>>IF        970>>CALLBLT
       985>>ASSIGN    991>>CALLBLT  1002>>CALLBLT  1028>>ASSIGN   1032--ASSIGN   1071>>CALLBLT  1078>>ASSIGN
      1103>>ASSIGN   1148>>ASSIGN   1281>>ASSIGN   1299>>ASSIGN   1311<<ASSIGN   1311>>ASSIGN   1314<<ASSIGN
      1314>>ASSIGN   1319>>IF       1421<<ASSIGN   1444<<ASSIGN   1454<<ASSIGN   1486<<ASSIGN   1509<<ASSIGN
      1514<<ASSIGN   1521<<ASSIGN   1534<<CALLBLT  1546<<ASSIGN   1548<<ASSIGN   1550<<ASSIGN   1552<<ASSIGN
      1554<<ASSIGN   1577<<ASSIGN   1584<<ASSIGN   1588<<ASSIGN   1597>>IF       1598<<ASSIGN   1600<<ASSIGN
      1601<<ASSIGN   1606<<ASSIGN   1608<<ASSIGN   1608>>ASSIGN   1611<<ASSIGN   1612<<ASSIGN   1612>>ASSIGN
VAL
       688**DCL       859<<ASSIGN    882<<ASSIGN    905<<ASSIGN   1075<<ASSIGN   1115<<ASSIGN   1120<<ASSIGN
      1205--ASSIGN   1212--ASSIGN   1228--ASSIGN   1627<<ASSIGN   1676--ASSIGN   1683<<ASSIGN
VAL.B
       689**DCL       690--REDEF     691--REDEF     692--REDEF     908>>IF        908<<ASSIGN   1107>>IF
      1119>>IF       1143<<ASSIGN   1149>>IF       1426>>IF       1450>>IF       1450<<ASSIGN   1451>>IF
      1686<<ASSIGN
VAL.B2
       696**DCL       697--REDEF     698--REDEF     699--REDEF     700--REDEF     871>>IF        871<<ASSIGN
       871>>ASSIGN   1399<<ASSIGN   1399>>ASSIGN   1410<<ASSIGN   1410>>ASSIGN
VAL.LO18.N
       699**DCL      1083<<ASSIGN
VAL.LO27.N
       700**DCL      1084<<ASSIGN
VAL.N
       697**DCL       832<<ASSIGN    872>>IF        921>>ASSIGN    923<<ASSIGN    923>>ASSIGN    945>>CALLBLT
       971<<ASSIGN    972<<ASSIGN    972>>ASSIGN    972>>ASSIGN    979<<ASSIGN    979>>ASSIGN    980<<ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:243  
       980>>ASSIGN    982<<ASSIGN    982>>ASSIGN    992<<ASSIGN    992>>ASSIGN    995<<ASSIGN    995>>ASSIGN
      1004<<ASSIGN   1004>>ASSIGN   1005<<ASSIGN   1005>>ASSIGN   1015<<ASSIGN   1015>>ASSIGN   1174--ASSIGN
      1195>>ASSIGN   1197>>ASSIGN   1227>>ASSIGN   1365<<ASSIGN   1367>>IF       1370>>DOWHILE  1373<<ASSIGN
      1373>>ASSIGN   1381<<ASSIGN   1384>>DOINDEX  1398>>IF       1465<<ASSIGN   1472>>ASSIGN   1476<<ASSIGN
      1502>>ASSIGN   1502<<ASSIGN   1502>>ASSIGN   1504>>ASSIGN   1504<<ASSIGN   1504>>ASSIGN   1506>>ASSIGN
      1511>>ASSIGN   1629<<ASSIGN   1630>>IF       1633<<ASSIGN   1635>>IF       1652<<ASSIGN   1660<<ASSIGN
      1662>>ASSIGN   1663<<ASSIGN   1665>>IF       1674<<ASSIGN   1702<<ASSIGN
VAL.N0
       691**DCL       862>>IF        862>>IF        869>>ASSIGN    872<<ASSIGN   1198>>ASSIGN   1226>>ASSIGN
      1399>>IF       1410>>IF       1490<<ASSIGN   1491>>IF       1491>>ASSIGN   1492>>ASSIGN   1493>>ASSIGN
      1494<<ASSIGN   1494>>ASSIGN   1495>>IF       1495<<ASSIGN   1495>>ASSIGN   1497>>ASSIGN   1498>>IF
      1500>>ASSIGN   1630<<ASSIGN   1635<<ASSIGN   1651<<ASSIGN   1662<<ASSIGN   1666<<ASSIGN   1673<<ASSIGN
      1688<<ASSIGN   1701<<ASSIGN
VAL.NU
       698**DCL       864<<ASSIGN    864>>ASSIGN    866<<ASSIGN    866>>ASSIGN    867<<ASSIGN    867>>ASSIGN
       867>>ASSIGN    868<<ASSIGN    868>>ASSIGN    868>>ASSIGN    869<<ASSIGN    869>>ASSIGN    897<<ASSIGN
       897>>ASSIGN    898<<ASSIGN    898>>ASSIGN    898>>ASSIGN    928>>IF        931>>IF        933>>IF
       935>>IF        937>>IF        939>>IF       1082>>ASSIGN   1083>>ASSIGN   1084>>ASSIGN   1085<<ASSIGN
      1085>>ASSIGN   1086<<ASSIGN   1086>>ASSIGN   1087<<ASSIGN   1087>>ASSIGN   1129<<ASSIGN   1130>>IF
      1131>>ASSIGN   1133>>IF       1137>>IF       1137<<ASSIGN   1138>>IF       1139<<ASSIGN   1142<<ASSIGN
      1142>>ASSIGN   1144>>ASSIGN   1145>>IF       1147>>IF       1147<<ASSIGN   1148>>ASSIGN   1148>>ASSIGN
      1148>>ASSIGN   1148>>ASSIGN   1150<<ASSIGN   1150>>ASSIGN   1150>>ASSIGN   1151<<ASSIGN   1151>>ASSIGN
      1151>>ASSIGN   1152<<ASSIGN   1152>>ASSIGN   1152>>ASSIGN   1154>>ASSIGN   1300>>ASSIGN   1300>>ASSIGN
      1401>>IF       1403>>IF       1405>>IF       1407>>IF       1490>>ASSIGN   1493<<ASSIGN   1493>>ASSIGN
VAL.TAG.CONSTRUCTED
       694**DCL      1106>>IF       1303>>IF       1317>>IF
VAL.TAG.HI_BITS
       693**DCL      1284>>IF
VAL.TAG.TAG
       695**DCL      1284>>IF
VAL.U0
       690**DCL       888<<ASSIGN    888>>ASSIGN    890<<ASSIGN    890>>ASSIGN    890>>ASSIGN    892<<ASSIGN
       892>>ASSIGN    892>>ASSIGN    894<<ASSIGN    894>>ASSIGN    896<<ASSIGN    896>>ASSIGN   1087>>ASSIGN
      1139>>ASSIGN   1283>>IF       1292>>ASSIGN
VALB
       717**DCL       799<<ASSIGN    808>>IF        811<<ASSIGN    815>>IF
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:244  
VALC
       687**DCL       688--REDEF     701--REDEF     702--REDEF     703--REDEF     704--REDEF     860<<ASSIGN
       883<<ASSIGN    906<<ASSIGN   1078<<ASSIGN   1103<<ASSIGN   1148<<ASSIGN   1189>>ASSIGN   1224>>ASSIGN
      1281<<ASSIGN   1299<<ASSIGN   1421>>ASSIGN   1444>>ASSIGN   1454>>ASSIGN   1654<<ASSIGN   1699<<ASSIGN
      1703--ASSIGN
VALLIM
       718**DCL       800<<ASSIGN    919<<ASSIGN    922>>IF        942>>IF        942>>IF        951>>IF
       952>>ASSIGN   1027>>IF       1028>>ASSIGN   1233<<ASSIGN   1235>>ASSIGN   1236>>IF       1236<<ASSIGN
      1240>>IF       1240<<ASSIGN   1244>>IF       1244<<ASSIGN   1250>>IF       1250<<ASSIGN
VALP
       702**DCL       864>>ASSIGN    866>>ASSIGN    897>>ASSIGN   1416>>ASSIGN   1417>>ASSIGN   1418>>ASSIGN
      1419>>ASSIGN   1420>>ASSIGN   1436>>ASSIGN   1437>>ASSIGN   1438>>ASSIGN   1439>>ASSIGN   1440>>ASSIGN
      1441>>ASSIGN   1442>>ASSIGN
VALSHF.B
       704**DCL      1115>>ASSIGN   1120>>ASSIGN
VALTXT
       674**DCL       922<<CALLBLT   944<<ASSIGN    945<<CALLBLT   952<<ASSIGN   1028<<ASSIGN   1465>>ASSIGN
      1469>>CALLBLT  1471>>CALLBLT  1521>>ASSIGN
VALU
       701**DCL       885>>ASSIGN    894>>ASSIGN    896>>ASSIGN   1082<<ASSIGN   1104>>ASSIGN   1116>>ASSIGN
      1121>>ASSIGN   1129>>ASSIGN   1137>>ASSIGN   1139>>ASSIGN   1285>>ASSIGN   1290>>ASSIGN   1292>>ASSIGN
      1416<<ASSIGN   1417<<ASSIGN   1418<<ASSIGN   1419<<ASSIGN   1420<<ASSIGN   1436<<ASSIGN   1437<<ASSIGN
      1438<<ASSIGN   1439<<ASSIGN   1440<<ASSIGN   1441<<ASSIGN   1442<<ASSIGN   1443<<ASSIGN
VALX
       716**DCL       717--REDEF     823<<ASSIGN    829<<ASSIGN    829>>ASSIGN    832>>ASSIGN    833<<ASSIGN
       835>>ASSIGN    922>>CALLBLT   924<<ASSIGN    924>>ASSIGN    942>>IF        944>>ASSIGN    945>>CALLBLT
       947<<ASSIGN    947>>ASSIGN    952>>ASSIGN    952>>ASSIGN    983<<ASSIGN    989>>IF        995>>IF
       995>>ASSIGN    996>>IF        997<<ASSIGN    997>>ASSIGN   1002<<CALLBLT  1003<<ASSIGN   1003>>ASSIGN
      1003>>ASSIGN   1004>>ASSIGN   1005>>ASSIGN   1008>>IF       1009<<ASSIGN   1027>>IF       1028>>ASSIGN
      1028>>ASSIGN   1029<<ASSIGN   1029>>ASSIGN   1237<<ASSIGN   1241<<ASSIGN   1249<<ASSIGN   1249>>ASSIGN
      1256>>ASSIGN   1258>>ASSIGN   1260>>ASSIGN   1263>>ASSIGN
VNODE.CP6TYP
       480**DCL      1238>>DOCASE   1254>>DOCASE   1635>>IF       1649>>IF       1665>>IF       1672>>IF
      1718>>DOCASE
VNODE.DATALGN
       521**DCL      1183>>IF       1190>>IF       1222>>IF       1225>>IF       1643>>IF       1655>>IF
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:245  
      1697>>IF       1700>>IF
VNODE.DEFAULT
       555**DCL      1716--ASSIGN   1717--ASSIGN
VNODE.DEFAULT_EXISTS
       520**DCL      1629>>ASSIGN   1686>>ASSIGN   1716>>IF       1732>>IF
VNODE.FPTID
       509**DCL       782>>IF        782>>ASSIGN    914>>IF        914>>ASSIGN
VNODE.FPTPTR
       522**DCL      1178>>ASSIGN   1180>>ASSIGN   1216>>ASSIGN   1218>>ASSIGN   1232>>ASSIGN   1235>>ASSIGN
      1235>>ASSIGN   1244>>ASSIGN   1258>>ASSIGN   1638>>ASSIGN   1640>>ASSIGN   1692>>ASSIGN   1694>>ASSIGN
      1712>>ASSIGN   1714>>ASSIGN   1714>>ASSIGN   1729>>ASSIGN
VNODE.IGNORE
       505**DCL       918>>IF       1025>>IF       1173>>IF       1211>>IF
VNODE.INCRPTR
       505**DCL      1179>>IF       1217>>IF       1234>>IF       1639>>IF       1693>>IF       1713>>IF
VNODE.OFFSET
       520**DCL      1189>>ASSIGN   1195>>ASSIGN   1197>>ASSIGN   1198>>ASSIGN   1205>>ASSIGN   1224>>ASSIGN
      1226>>ASSIGN   1227>>ASSIGN   1228>>ASSIGN   1232>>ASSIGN   1654>>ASSIGN   1660>>ASSIGN   1663>>ASSIGN
      1676>>ASSIGN   1699>>ASSIGN   1701>>ASSIGN   1702>>ASSIGN   1703>>ASSIGN   1712>>ASSIGN
VNODE.SIZE
       506**DCL      1181>>ASSIGN   1219>>ASSIGN   1236>>ASSIGN   1246>>IF       1263>>IF       1641>>ASSIGN
      1684>>ASSIGN   1708>>ASSIGN
VNODE.SIZELIM
       522**DCL      1180>>ASSIGN   1218>>ASSIGN   1233>>ASSIGN   1640>>ASSIGN   1694>>ASSIGN   1709>>ASSIGN
VNODE.SUBND$
       555**DCL       555--REDEF     555--REDEF     555--REDEF     556--REDEF     556--REDEF
VNODE.TAG
       500**DCL       500--REDEF
VNODE.VALUE
       555**DCL      1365>>ASSIGN   1629>>ASSIGN
VNODE.VALUEB
       556**DCL      1686>>ASSIGN
VNODE.VALUE_EXISTS
       521**DCL      1365>>IF       1628>>IF       1685>>IF       1710>>IF       1732>>IF
WORDS IN PROCEDURE GETVALN
      1625**DCL      1633>>ASSIGN   1660>>ASSIGN   1663>>ASSIGN   1688>>ASSIGN   1701>>ASSIGN   1702>>ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:246  
WORDS IN PROCEDURE PUTVALN
      1171**DCL      1195<<ASSIGN   1197<<ASSIGN   1198<<ASSIGN   1226<<ASSIGN   1227<<ASSIGN
XSP$DECONSTRUCT
      1272**ENTRY     877--CALL      959--CALL     1021--CALL     1306--CALL
XSP$RECV1
       735**ENTRY     765--CALL      776--CALL      793--CALL      812--CALL      817--CALL      828--CALL
       844--CALL
XSP$SEND1
      1327**ENTRY    1352--CALL     1360--CALL     1372--CALL     1386--CALL
XSP_UTC_OFFSET
       732**DCL      1514>>ASSIGN
XSP_UTC_OFFSETN
       733**DCL      1015>>ASSIGN
YEARS
       720**DCL       980>>ASSIGN   1494>>ASSIGN
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:247  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSP$ASN1 File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:58 Page:248  
              MINI UREF LISTING

PUT_75 IN PROCEDURE PUT_7S   1545**LABEL
VAL7     703**DCL
XSP$ASN1       9**PROC

PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:249  
     1088        1        /*T***********************************************************/
     1089        2        /*T*                                                         */
     1090        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1091        4        /*T*                                                         */
     1092        5        /*T***********************************************************/
     1093        6        XSP$RECV: PROC (FPT) ALTRET;
     1094        7
     1095        8        %INCLUDE XSP_ASN1_M;
     1096      354        %XSP_ASN1_FPT (FPTN=FPT, STCLASS=PARAM);
     1097      374        %XSP_ASN1_FPT (FPTN=BFPT, STCLASS="BASED(PARM.P.FPT$)");
     1098      394        %XSP$ASN1_PARM (NAME=PARM, STCLASS=AUTO);
     1099      420        %XSP$ASN1_PARM (STCLASS=CONSTANT);
     1100      446
     1101      447    1   DCL XSP$RECV1 ENTRY(1) ALTRET;
     1102      448    1   DCL XSP$SEND1 ENTRY(1) ALTRET;
     1103      449
     1104      450    1      CALL SETPARM;
     1105      451    1      CALL XSP$RECV1 (PARM) ALTRET(RETALT);
     1106      452    1      GOTO RETRET;
     1107      453
     1108      454    1   XSP$SEND: ENTRY (FPT) ALTRET;
     1109      455
     1110      456    1      CALL SETPARM;
     1111      457    1      REMEMBER RETALT IN PARM.ABORT;
     1112      458    1      CALL XSP$SEND1 (PARM) ALTRET(RETALT);
     1113      459
     1114      460    1   RETRET:;
     1115      461    1      BFPT.NXTX = PARM.NXTX;
     1116      462    1      RETURN;
     1117      463
     1118      464    1   SETPARM: PROC;
     1119      465    2      PARM = XSP$ASN1_PARM;
     1120      466    2      PARM.P.FPT$ = ADDR(FPT);
     1121      467    2      PARM.P.NODE$ = FPT.TOPNODE$;
     1122      468    2      PARM.P.BUF$ = FPT.BUF$;
     1123      469    2      PARM.MAXX = FPT.NXTX;
     1124      470    2   END SETPARM;
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:250  
     1125      471
     1126      472    1   RETALT: BFPT.ERR = PARM.ERR;
     1127      473    1      BFPT.NXTX = PARM.NXTX;
     1128      474    1      ALTRETURN;
     1129      475    1   END XSP$RECV;

PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:251  
--  Include file information  --

   XSP_ASN1_M.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$RECV.

   Procedure XSP$RECV requires 49 words for executable code.
   Procedure XSP$RECV requires 22 words of local(AUTO) storage.

    No errors detected in file XSP$ASN1.:XSA1TSI    .

PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:252  

 Object Unit name= XSP$RECV                                   File name= XSP$ASN1.:XSA1TOU
 UTS= OCT 01 '97 11:59:05.96 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     14     16  XSP$RECV
    1   Proc  even  none    49     61  XSP$RECV
    2  RoData even  none     1      1  XSP$RECV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  XSP$RECV
     1     13          yes     yes      Std        1  XSP$SEND

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XSP$RECV1
 yes     yes           Std       1 XSP$SEND1
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:253  


     1088        1        /*T***********************************************************/
     1089        2        /*T*                                                         */
     1090        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1091        4        /*T*                                                         */
     1092        5        /*T***********************************************************/
     1093        6        XSP$RECV: PROC (FPT) ALTRET;

      6  1 000000   000000 700200 xent  XSP$RECV     TSX0  ! X66_AUTO_1
         1 000001   000026 000001                    ZERO    22,1

     1094        7
     1095        8        %INCLUDE XSP_ASN1_M;
     1096      354        %XSP_ASN1_FPT (FPTN=FPT, STCLASS=PARAM);
     1097      374        %XSP_ASN1_FPT (FPTN=BFPT, STCLASS="BASED(PARM.P.FPT$)");
     1098      394        %XSP$ASN1_PARM (NAME=PARM, STCLASS=AUTO);
     1099      420        %XSP$ASN1_PARM (STCLASS=CONSTANT);
     1100      446
     1101      447    1   DCL XSP$RECV1 ENTRY(1) ALTRET;
     1102      448    1   DCL XSP$SEND1 ENTRY(1) ALTRET;
     1103      449
     1104      450    1      CALL SETPARM;

    450  1 000002   000034 701000 1                  TSX1    SETPARM
         1 000003   000000 011000                    NOP     0

     1105      451    1      CALL XSP$RECV1 (PARM) ALTRET(RETALT);

    451  1 000004   200004 630500                    EPPR0   PARM,,AUTO
         1 000005   200024 450500                    STP0    PARM+16,,AUTO
         1 000006   200024 630500                    EPPR0   PARM+16,,AUTO
         1 000007   000000 631400 2                  EPPR1   0
         1 000010   000000 701000 xent               TSX1    XSP$RECV1
         1 000011   000052 702000 1                  TSX2    RETALT

     1106      452    1      GOTO RETRET;

PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:254  
    452  1 000012   000030 710000 1                  TRA     RETRET

     1107      453
     1108      454    1   XSP$SEND: ENTRY (FPT) ALTRET;

    454  1 000013   000000 700200 xent  XSP$SEND     TSX0  ! X66_AUTO_1
         1 000014   000026 000001                    ZERO    22,1

     1109      455
     1110      456    1      CALL SETPARM;

    456  1 000015   000034 701000 1                  TSX1    SETPARM
         1 000016   000000 011000                    NOP     0

     1111      457    1      REMEMBER RETALT IN PARM.ABORT;

    457  1 000017   000052 635000 1                  EAA     RETALT
         1 000020   200012 452500                    STP2    PARM+6,,AUTO
         1 000021   200013 755100                    STA     PARM+7,,AUTO

     1112      458    1      CALL XSP$SEND1 (PARM) ALTRET(RETALT);

    458  1 000022   200004 630500                    EPPR0   PARM,,AUTO
         1 000023   200024 450500                    STP0    PARM+16,,AUTO
         1 000024   200024 630500                    EPPR0   PARM+16,,AUTO
         1 000025   000000 631400 2                  EPPR1   0
         1 000026   000000 701000 xent               TSX1    XSP$SEND1
         1 000027   000052 702000 1                  TSX2    RETALT

    450  1 000030                       RETRET       null
     1113      459
     1114      460    1   RETRET:;
     1115      461    1      BFPT.NXTX = PARM.NXTX;

    461  1 000030   200006 470500                    LDP0    PARM+2,,AUTO
         1 000031   200015 235100                    LDA     PARM+9,,AUTO
         1 000032   000014 755100                    STA     12,,PR0
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:255  

     1116      462    1      RETURN;

    462  1 000033   000000 702200 xent               TSX2  ! X66_ARET

     1117      463
     1118      464    1   SETPARM: PROC;

    464  1 000034   200022 741300       SETPARM      STX1  ! PARM+14,,AUTO

     1119      465    2      PARM = XSP$ASN1_PARM;

    465  1 000035   000100 100400                    MLR     fill='000'O
         1 000036   000000 000064 0                  ADSC9   XSP$ASN1_PARM            cn=0,n=52
         1 000037   200004 000064                    ADSC9   PARM,,AUTO               cn=0,n=52

     1120      466    2      PARM.P.FPT$ = ADDR(FPT);

    466  1 000040   200003 236100                    LDQ     @FPT,,AUTO
         1 000041   200006 756100                    STQ     PARM+2,,AUTO

     1121      467    2      PARM.P.NODE$ = FPT.TOPNODE$;

    467  1 000042   200003 470500                    LDP0    @FPT,,AUTO
         1 000043   000000 236100                    LDQ     0,,PR0
         1 000044   200004 756100                    STQ     PARM,,AUTO

     1122      468    2      PARM.P.BUF$ = FPT.BUF$;

    468  1 000045   000001 236100                    LDQ     1,,PR0
         1 000046   200005 756100                    STQ     PARM+1,,AUTO

     1123      469    2      PARM.MAXX = FPT.NXTX;

    469  1 000047   000014 235100                    LDA     12,,PR0
         1 000050   200020 755100                    STA     PARM+12,,AUTO

PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:256  
     1124      470    2   END SETPARM;

    470  1 000051   000001 702211                    TSX2  ! 1,X1

     1125      471
     1126      472    1   RETALT: BFPT.ERR = PARM.ERR;

    472  1 000052   200014 235100       RETALT       LDA     PARM+8,,AUTO
         1 000053   200006 470500                    LDP0    PARM+2,,AUTO
         1 000054   000003 755100                    STA     3,,PR0

     1127      473    1      BFPT.NXTX = PARM.NXTX;

    473  1 000055   200006 470500                    LDP0    PARM+2,,AUTO
         1 000056   200015 235100                    LDA     PARM+9,,AUTO
         1 000057   000014 755100                    STA     12,,PR0

     1128      474    1      ALTRETURN;

    474  1 000060   000000 702200 xent               TSX2  ! X66_AALT

XSP$ASN1_PARM
 Sect OctLoc
   0     000   000000 006014   000000 006014   000000 006014   000000 006014    ................
   0     004   000000 006014   10*000 ******   ****** ******   ****** ******    ....@...........
   0     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     014   000000 000000                                                    ....

(unnamed)
 Sect OctLoc
   2     000   000001 000000                                                    ....
     1129      475    1   END XSP$RECV;

PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:257  
--  Include file information  --

   XSP_ASN1_M.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$RECV.
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:258  

 **** Variables and constants ****

  ****  Section 000 RoData XSP$RECV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(468)   r     1 XSP$ASN1_PARM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPT                      *0-0-0/w STRC(504)   r     1 FPT
     4-0-0/d STRC(468)   r     1 PARM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(504)   r     1 BFPT


   Procedure XSP$RECV requires 49 words for executable code.
   Procedure XSP$RECV requires 22 words of local(AUTO) storage.

    No errors detected in file XSP$ASN1.:XSA1TSI    .
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:259  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:260  
          MINI XREF LISTING

BFPT.C0
       390**DCL       390--REDEF
BFPT.DAT$
       392**DCL       392--REDEF
BFPT.ERR
       389**DCL       472<<ASSIGN
BFPT.N0
       391**DCL       391--REDEF
BFPT.NXTX
       391**DCL       461<<ASSIGN    473<<ASSIGN
BFPT.R0
       389**DCL       390--REDEF
FPT
       364**DCL         6--PROC      454--ENTRY     466--ASSIGN
FPT.BUF$
       368**DCL       468>>ASSIGN
FPT.C0
       370**DCL       370--REDEF
FPT.DAT$
       372**DCL       372--REDEF
FPT.N0
       371**DCL       371--REDEF
FPT.NXTX
       371**DCL       469>>ASSIGN
FPT.R0
       369**DCL       370--REDEF
FPT.TOPNODE$
       368**DCL       467>>ASSIGN
PARM
       407**DCL       451<>CALL      458<>CALL      465<<ASSIGN
PARM.ABORT
       416**DCL       457<<REMEMBR
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:261  
PARM.ERR
       416**DCL       472>>ASSIGN
PARM.MAXX
       416**DCL       469<<ASSIGN
PARM.NXTX
       416**DCL       461>>ASSIGN    473>>ASSIGN
PARM.P.BUF$
       412**DCL       468<<ASSIGN
PARM.P.FPT$
       412**DCL       384--IMP-PTR   461>>ASSIGN    466<<ASSIGN    472>>ASSIGN    473>>ASSIGN
PARM.P.NODE$
       412**DCL       467<<ASSIGN
RETALT
       472**LABEL     451--CALLALT   457--REMEMBR   458--CALLALT
RETRET
       450**LABEL     452--GOTO
SETPARM
       464**PROC      450--CALL      456--CALL
XSP$ASN1_PARM
       433**DCL       465>>ASSIGN
XSP$RECV1
       447**DCL-ENT   451--CALL
XSP$SEND1
       448**DCL-ENT   458--CALL
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:262  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=XSP$RECV File=XSP$ASN1.:XSA1TSI                               WED 10/01/97 11:59 Page:263  
              MINI UREF LISTING

XSP$RECV       6**PROC
XSP$SEND     454**ENTRY
