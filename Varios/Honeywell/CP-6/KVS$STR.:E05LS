VERSION E05

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:1    
        1        1        /*M* KVS$STR Message interface routines                                       */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVS$SETSTR: PROC (STR_ID);
        9        9
       10       10        %INCLUDE KV_ERD_E;
       11       97 S      %INCLUDE KV$GLB;
       12       98 S      %INCLUDE KV$GLBCTX;
       13       99 S      %INCLUDE KV_GLBCNS_E;
       14      100        %KV#VD_ORG_E;
       15      108        %KV_PHSPSTMOD_E;
       16      115        %KV_INPOPRX_E;
       17      127        %KV_INPUNT_E;
       18      132 S      %INCLUDE KV$VDO;
       19      133        %KV$VDO (STCLASS="BASED(KV_RCVVDO$)");
       20      160    1   DCL KV$RCVVDO$ PTR SYMREF;
       21      161 S      %INCLUDE KV$INT;
       22      162 S      %INCLUDE KV$USR;
       23      163 S      %INCLUDE KV$VDH;
       24      164        %INCLUDE KV$VDP;
       25      322        %INCLUDE KV_SCODE_C;
       26      343        %INCLUDE LCP_6;
       27      534        %VLP_SCODE (FPTN=KVS_VDOSTR,FCG=KV,MID=M,ERR#=%S$KV_VDOSTR,STCLASS=CONSTANT);
       28      595        %VLP_SCODE (FPTN=KVS_VDHSTR,FCG=KV,MID=M,ERR#=%S$KV_VDHSTR,STCLASS=CONSTANT);
       29      656        %KV$RCVVDO (NAME=KV_RCVVDO, STCLASS="BASED(KV$RCVVDO$)");
       30      797    1   DCL KV_RCVVDO$ PTR SYMREF;
       31      798        %KV$RCVSSN (NAME=KV_RCVSSN, STCLASS="BASED(KV$RCVSSN$)");
       32      823    1   DCL KV$RCVSSN$ PTR SYMREF;
       33      824    1   DCL KV_VDH_PST_NEWLIN_VRT UBIN SYMREF;
       34      825
       35      826        %KV$ERD;
       36      910        %KV$LIN;
       37      934        %KV$LINLST;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:2    
       38      961        %KV$MRD;                                /*                                    */
       39     1008        %KV$MVD;                                /*                                    */
       40     1052        %KV$PTR;                                /*  VDH Pointers, status              */
       41     1095        %KV$SHRBFR (NAME=Y$ENTSRD, LAST=",");   /*  VDH shared buffer                 */
       42     1127    1          2 TXTSIZ UBIN BYTE;
       43     1128        %KV$SRD;                                /*                                    */
       44     1403        %KV$SSN;                                /*  VDH Session                       */
       45     1482        %KV$STR;                                /*  VDH Stream                        */
       46     1569        %KV$VDI;                                /*  VDH Context                       */
       47     1640    1   DCL KHD$SCREECH ENTRY(1);
       48     1641
       49     1642    1   DCL KVI$ENBRED ENTRY;
       50     1643    1   DCL KVI$INTINPOPRX ENTRY(1);
       51     1644    1   DCL KVI$RE_DSPINP ENTRY;
       52     1645    1   DCL KVO$DVCCTR ENTRY(1);
       53     1646    1   DCL KVO$PST ENTRY(1);
       54     1647    1   DCL KVV$CALUSR ENTRY(1) ALTRET;
       55     1648    1   DCL KVV$CALUSR_PST ENTRY ALTRET;
       56     1649        /* Set stream. Set up the specified stream, and all of its                    */
       57     1650        /* subordinates, as the current stream.                                       */
       58     1651
       59     1652    1   DCL STR_ID UBIN;
       60     1653    1   DCL ID UBIN;                            /* Stream ID that we want.            */
       61     1654    1   DCL PTR$ PTR;                           /* Original ASNINPPTR$                */
       62     1655    1   DCL PRVMVD$ PTR;
       63     1656    1   DCL STR$ PTR;
       64     1657        /*
       65     1658        We might need to position.
       66     1659        */
       67     1660    1   DCL Y@PST BIT(1) AUTO;
       68     1661        /*
       69     1662        FPT to get the attributes set properly
       70     1663        */
       71     1664        %KV$USR_SETATR (STCLASS=AUTO, NAME=USR_SETATR);
       72     1787        %KV$USR_SETATR (STCLASS=SYMREF, NAME=KV_USR_SETATR);
       73     1910        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:3    
       74     1911        /* Figure out whats required. */
       75     1912
       76     1913    1      Y@PST = '1'B;
       77     1914    1      STR$ = KV$PTR.STR$;
       78     1915    2      IF ADDR(STR_ID)=ADDR(NIL) THEN IF KV_RCVVDO.VDP_VDO.SETSTR THEN DO;
       79     1916
       80     1917        /* We've been called by KVM$RCV. Get ID from the current VDO. */
       81     1918
       82     1919    2         ID = KV$VDO.STR;
       83     1920    2         IF ID=0 THEN ID=1;
       84     1921    3         IF KV_RCVVDO.PRVSTR$~=ADDR(NIL) THEN DO;
       85     1922        /*
       86     1923           We're being called to position to a stream that we only set contextfor.
       87     1924        */
       88     1925    3            STR$ = KV_RCVVDO.PRVSTR$;
       89     1926    3            KV$PTR.STR$ = STR$;
       90     1927    3            KV$PTR.MVD$ = STR$->KV$STR.MVD$;
       91     1928    3            KV$PTR.SRD$ = %KV_MVD.SRD$;
       92     1929    3            KV$PTR.LINLST$ = %KV_MVD.LINLST$;
       93     1930    3            KV$PTR.MRD$ = %KV_SRD.MRD$;
       94     1931    3            KV_RCVVDO.PRVSTR$ = ADDR(NIL);
       95     1932    3         END;
       96     1933    2         Y@PST = KV_RCVVDO.VDP_VDO.PSTSTR;
       97     1934    3         IF KV_RCVVDO.VDP_VDO.RSTSTR OR NOT Y@PST THEN DO;
       98     1935    4            IF Y@PST THEN DO;
       99     1936    4               IF KV_RCVSSN.PRVSTR$=ADDR(NIL) THEN KV_RCVSSN.PRVSTR$ = STR$;
      100     1937    4            END; ELSE DO;
      101     1938        /*
      102     1939           Context switch with no need for IO (usually).
      103     1940           Set up for a change of heart.
      104     1941        */
      105     1942    4               KV_RCVVDO.VDP_VDO.PSTSTR = '1'B;
      106     1943    4               IF STR$->KV$STR.ID=ID THEN RETURN;
      107     1944        /*
      108     1945           If we're already here, we must be doing the call to set position for
      109     1946           a stream "that we only set context for", but we didn't do that because
      110     1947           we were already there in the first place.  Don't setup to return anywhere.
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:4    
      111     1948        */
      112     1949    4               KV_RCVVDO.PRVSTR$ = STR$;
      113     1950    4            END;
      114     1951    3         END;
      115     1952    2         ELSE IF NOT KV_RCVVDO.VDP_VDO.RSTSTR
      116     1953    2         THEN KV_RCVSSN.PRVSTR$ = ADDR(NIL);
      117     1954    2      END;
      118     1955    2      ELSE DO;
      119     1956
      120     1957        /* We're restoring a previous stream and/or session. */
      121     1958
      122     1959    3         IF KV_RCVVDO.PRVSTR$~=ADDR(NIL) THEN DO;
      123     1960    3            STR$ = KV_RCVVDO.PRVSTR$;
      124     1961    3            Y@PST = '0'B;
      125     1962    3         END;
      126     1963    2         ELSE IF KV_RCVSSN.PRVSTR$~=ADDR(NIL) THEN STR$ = KV_RCVSSN.PRVSTR$;
      127     1964    2         ID = STR$->KV$STR.ID;
      128     1965    2      END;
      129     1966    2      ELSE DO;
      130     1967    2         ID = STR_ID;
      131     1968    2         IF ID=0 THEN ID=1;
      132     1969    2      END;
      133     1970    2      IF KV$PTR$~=%KV_VDI.ASNINPPTR$ AND Y@PST THEN DO;
      134     1971    2         IF ADDR(STR_ID)=ADDR(NIL)
      135     1972    2         THEN KV_RCVSSN.PRVPTR$ = %KV_VDI.ASNINPPTR$;
      136     1973    2         PTR$ = KV$PTR$;
      137     1974    2         KV$PTR$ = %KV_VDI.ASNINPPTR$;
      138     1975    2         CALL Y$CHNSSN;
      139     1976    2      END;
      140     1977
      141     1978        /* FIND THE APPROPRIATE STREAM AND MAKE IT CURRENT                            */
      142     1979
      143     1980    1      IF STR$=ADDR(NIL) OR ID~=STR$->KV$STR.ID
      144     1981    1      THEN STR$ = %KV_SSN.STR$;
      145     1982
      146     1983    2      IF ID~=STR$->KV$STR.ID THEN DO WHILE STR$~=ADDR(NIL);
      147     1984        /* CHECK TO SEE IF WE HAVE RIGHT STREAM                                       */
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:5    
      148     1985
      149     1986    2         IF ID=STR$->KV$STR.ID THEN EXIT;
      150     1987    2         STR$ = STR$->KV$STR.LNK$;
      151     1988    2      END /* LOOP */;
      152     1989    1      IF STR$=ADDR(NIL) THEN IF ADDR(STR_ID)=ADDR(NIL)
      153     1990    1        AND KV_RCVVDO.VDP_VDO.SETSTR
      154     1991    1      THEN CALL KHD$SCREECH (KVS_VDOSTR);
      155     1992        /*S*   SCREECH_CODE: KVS-S$KV_VDOSTR
      156     1993               MESSAGE: VDH got a VDO for a non-existent stream.
      157     1994        */
      158     1995    1      ELSE CALL KHD$SCREECH (KVS_VDHSTR);
      159     1996        /*S*   SCREECH_CODE: KVS-S$KV_VDHSTR
      160     1997               MESSAGE: VDH tried to switch to a non-existent stream.
      161     1998        */
      162     1999    2      IF STR$~=KV$PTR.STR$ THEN DO;
      163     2000
      164     2001        /* We found the right stream.                                                 */
      165     2002
      166     2003    2         PRVMVD$ = KV$PTR.MVD$;
      167     2004    2         IF PRVMVD$~=ADDR(NIL)
      168     2005    2         THEN IF PRVMVD$->KV$MVD.SRD$~=STR$->KV$STR.MVD$->KV$MVD.SRD$ AND Y@PST
      169     2006    2         THEN CALL Y$EXTSRD;
      170     2007    2         KV$PTR.STR$ = STR$;
      171     2008    2         KV$PTR.MVD$ = STR$->KV$STR.MVD$;
      172     2009    2         KV$PTR.SRD$ = %KV_MVD.SRD$;
      173     2010    2         KV$PTR.LINLST$ = %KV_MVD.LINLST$;
      174     2011    2         KV$PTR.MRD$ = %KV_SRD.MRD$;
      175     2012
      176     2013    3         IF KV$PTR.MVD$~=PRVMVD$ THEN DO;
      177     2014    3            IF PRVMVD$=ADDR(NIL) THEN CALL Y$ENTSRD;
      178     2015    3            ELSE IF KV$PTR.SRD$~=PRVMVD$->KV$MVD.SRD$ AND Y@PST THEN CALL Y$ENTSRD;
      179     2016
      180     2017        /* We're changing MVDs.                                                    */
      181     2018
      182     2019    4            IF %KV_MVD.ORG=%KV#VD_ORG_FORM THEN DO;
      183     2020
      184     2021        /* The new stream points to a virtual device whose organization         */
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:6    
      185     2022        /* is of 'form'. Initialize the form-specific data.                     */
      186     2023
      187     2024    4               KV$PTR.VRTCLM = %KV_MVD.VRTCLM;
      188     2025    4               IF %KV_MRD.ATRRQRDSPPST THEN KV$PTR.VRTCLM = KV$PTR.VRTCLM+1;
      189     2026    4               KV$PTR.LIN$ = %KV_LINLST.ONEFLDLIN$;
      190     2027    5               IF KV$PTR.LIN$~=ADDR(NIL) AND %KV_SSN.REDRQSPND THEN DO;
      191     2028    5                  KV$PTR.VRTLIN = %KV_LIN.VRTLIN;
      192     2029    5                  KV$PTR.FLDLST$ = %KV_LIN.FLDLST$;
      193     2030    5                  KV$PTR.FLDWRDX = %KV_LINLST.ONEFLDWRDX;
      194     2031    5                  KV$PTR.FLD$ = PINCRW (KV$PTR.FLDLST$,KV$PTR.FLDWRDX);
      195     2032    5               END;
      196     2033    4               ELSE KV$PTR.FLD$ = ADDR(NIL);
      197     2034    4            END;                           /* IFnew MVD.ORG=FORM                 */
      198     2035    3         END;
      199     2036    3         ELSE IF Y@PST THEN DO;
      200     2037        /*
      201     2038        New stream, but the same window.
      202     2039        */
      203     2040    3            IF %KV_MRD.DCLATRWHNOTP
      204     2041    3              AND BITBIN(%KV_MRD.DVCATR)~=BITBIN(STR$->KV$STR.GRPRND)
      205     2042    3            THEN CALL Y$FIXATR;
      206     2043    3            CALL Y$FIXRED;
      207     2044    3         END;
      208     2045    2      END; /* IF STR is new */
      209     2046    1      IF ADDR(STR_ID)=ADDR(NIL) AND NOT KV_RCVVDO.VDP_VDO.SETSTR
      210     2047    1        AND KV_RCVVDO.PRVSTR$=ADDR(NIL)
      211     2048    2      THEN IF KV_RCVSSN.PRVPTR$~=ADDR(NIL) THEN DO;
      212     2049        /*
      213     2050           Returning to a different SSN.  Fix up some more stuff.
      214     2051        */
      215     2052    2         PTR$ = KV_RCVSSN.PRVPTR$;
      216     2053    2         CALL Y$CHNSSN;
      217     2054    2      END;
      218     2055    1      RETURN;
      219     2056        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:7    
      220     2057    1   Y$CHNSSN: PROC;
      221     2058        /*D* NAME: Y$CHNSSN.  Switch sessions.
      222     2059             DESCRIPTION: Does whatever is needed to switch context from the
      223     2060             session reflected by KV$PTR$ to the one for PTR$.
      224     2061        */
      225     2062    2      STR$ = PTR$->KV$PTR.STR$;
      226     2063    3      IF KV$PTR.SRD$~=PTR$->KV$PTR.SRD$ THEN DO;
      227     2064        /*
      228     2065           Only go through the whole process if we're doing windows.
      229     2066        */
      230     2067    3         IF KV$PTR.SRD$~=ADDR(NIL) THEN CALL Y$EXTSRD;
      231     2068    3         KV$PTR$ = PTR$;
      232     2069    3         %KV_VDI.USRRQSDAT.RED = %KV_SSN.REDRQSPND;
      233     2070    3         CALL Y$ENTSRD;
      234     2071    3      END; ELSE DO;
      235     2072        /*
      236     2073           Redisplay the prompt and partial input if there is one.
      237     2074        */
      238     2075    3         KV$PTR$ = PTR$;
      239     2076    3         IF %KV_MRD.DCLATRWHNOTP
      240     2077    3           AND BITBIN(%KV_MRD.DVCATR)~=BITBIN(STR$->KV$STR.GRPRND)
      241     2078    3         THEN CALL Y$FIXATR;
      242     2079    3         %KV_VDI.RE_DSPINP = '0'B;
      243     2080    3         %KV_VDI.USRRQSDAT.RED = %KV_SSN.REDRQSPND;
      244     2081    3         CALL Y$FIXRED;
      245     2082    3      END;
      246     2083    2      %KV_VDI.ASNINPPTR$ = KV$PTR$;
      247     2084    2      RETURN;
      248     2085    2   END Y$CHNSSN;
      249     2086
      250     2087    1   KVS$CHNSSN: ENTRY;
      251     2088        /*F* NAME:KVS$CHNSSN.  Switch from a released session.
      252     2089             DESCRIPTION: Does whatever is needed to establish context and
      253     2090             position for a session other than the current one.
      254     2091        */
      255     2092    1      IF KV$PTR$~=%KV_VDI.ASNINPPTR$
      256     2093    1      THEN PTR$ = %KV_VDI.ASNINPPTR$;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:8    
      257     2094    1      ELSE IF KV$PTR$=%KV_VDI.SSN$->KV$SSN.SNCPTR$ THEN RETURN;
      258     2095    1      ELSE PTR$ = %KV_VDI.SSN$->KV$SSN.SNCPTR$;
      259     2096    1      CALL Y$CHNSSN;
      260     2097    1      RETURN;
      261     2098        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:9    
      262     2099    1   Y$EXTSRD: PROC;
      263     2100        /*D* NAME: Y$EXTSRD. Exit the SRD.
      264     2101             DESCRIPTION: Performs any positioning and related operations to
      265     2102             get out of the current SRD. */
      266     2103    2      IF %KV_VDI.PHSDSC THEN RETURN;
      267     2104    2      IF %KV_VDI.RE_DSPINP THEN CALL KVI$RE_DSPINP;
      268     2105    2      IF %KV_VDI.OTPCNDPND.PST=%KV_PHSPSTMOD_BLN AND %KV_MRD.BLANKERASES
      269     2106    2      THEN CALL KVV$CALUSR_PST;
      270     2107    3      IF %KV_SRD.ENBENTEXTSRDCHR THEN DO;
      271     2108    4         IF %KV_ERD.EXTSRD_CHR ~= 0 THEN DO;
      272     2109        /*
      273     2110        There is a character string to be sent to the device when
      274     2111        exiting this SRD.  Send it.
      275     2112        */
      276     2113    4            CALL KVO$DVCCTR(%KV$ERD_EXTSRD_CHR#/8);
      277     2114    4         END;                              /* END IF %KV_ERD.EXTSRD_CHR ~= 0     */
      278     2115    3      END; /* END IF %KV_SRD.ENBENTEXTSRDCHR */
      279     2116    2      RETURN;
      280     2117    2   END Y$EXTSRD;
      281     2118        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:10   
      282     2119        /*D* NAME: Y$ENTSRD. Enter the SRD.
      283     2120             DESCRIPTION: Causes anything required to happed when entering the
      284     2121             currently addressed SRD to happen.
      285     2122        */
      286     2123    1   Y$ENTSRD: PROC;
      287     2124    2      IF %KV_VDI.PHSDSC THEN RETURN;
      288     2125    2      %KV_VDI.OTPCNDPND.PST = %KV_PHSPSTMOD_SKP;
      289     2126    2      IF NOT %KV_MRD.CALUSR_PST
      290     2127        /*
      291     2128           It may not be possible to LF into the new window, but that can be fixed.
      292     2129        */
      293     2130    2      THEN IF %KV_ERD.RGNSCR THEN %KV_SRD.UNKRGN = '1'B;
      294     2131    2      IF %KV_SRD.ENBENTEXTSRDCHR AND %KV_SRD.ENTSRDCHR$~=ADDR(NIL)
      295     2132    3      THEN IF %KV_SRD.ENTSRDCHR$->Y$ENTSRD.TXTSIZ~=0 THEN DO;
      296     2133        /*
      297     2134        There is a character string to be sent to the device when
      298     2135        entering this SRD.  Send it.
      299     2136        */
      300     2137    3         CALL KVV$CALUSR_PST;
      301     2138    3         CALL KVO$DVCCTR (%KV_SRD.ENTSRDCHR$->Y$ENTSRD.TXTSIZ);
      302     2139    3      END;
      303     2140    2      IF %KV_MRD.DCLATRWHNOTP
      304     2141    2        AND BITBIN(%KV_MRD.DVCATR)~=BITBIN(STR$->KV$STR.GRPRND)
      305     2142    2      THEN CALL Y$FIXATR;
      306     2143    2   Y$FIXRED: ENTRY;
      307     2144    2      IF %KV_SRD.LNG>0 AND %KV_SRD.WDT>0 AND %KV_MVD.ORG<%KV#VD_ORG_X364
      308     2145    2        AND %KV_VDI.INPUNT=%KV_INPUNT_CHR
      309     2146    3        AND (%KV_SRD.UNKPST OR %KV_MVD.REDSSNID~=%KV_SSN.SSNID) THEN DO;
      310     2147    4         IF %KV_SRD.UNKPST THEN DO;
      311     2148    4            %KV_SRD.UNKPST = '0'B;
      312     2149    4            %KV_MVD.VRTCLM = 1;
      313     2150    4            %KV_SRD.CRT.LIN = %KV_SRD.BTMRHT.LIN-%KV_SRD.DVCLINBIS;
      314     2151    4            %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRT.LIN+1;
      315     2152    4            %KV_SRD.VRTPSTOK = '0'B;
      316     2153    4            %KV_VDI.UN_KNWPST = '1'B;
      317     2154    4         END;
      318     2155    3         IF %KV_SSN.REDRQSPND AND %KV_SSN.REDSTRID=%KV_STR.ID
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:11   
      319     2156    4           AND NOT KV$PTR.INPCNDPND.TRN THEN DO;
      320     2157    4            IF %KV_MVD.VRTCLM>1 OR %KV_SRD.HI_NONBLN.LIN>=%KV_SRD.CRT.LIN
      321     2158    4              OR %KV_VDI.UN_KNWPST
      322     2159    4            THEN CALL KVO$PST (KV_VDH_PST_NEWLIN_VRT);
      323     2160    4            CALL KVI$ENBRED;
      324     2161    4            CALL KVI$INTINPOPRX (%KV_INPOPRX_RE_TYP);
      325     2162    4         END;
      326     2163    3      END;
      327     2164    2      ELSE %KV_SRD.UNKPST = '0'B;
      328     2165    2      RETURN;
      329     2166    2   END Y$ENTSRD;
      330     2167        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:12   
      331     2168        /*D* NAME: Y$FIXATR.  Fix the graphic rendition.
      332     2169             DESCRIPTION: Just builds a USR_SETATR FPT and makes the call.
      333     2170        */
      334     2171    1   Y$FIXATR: PROC;
      335     2172    2      USR_SETATR = KV_USR_SETATR;
      336     2173    2      USR_SETATR.GRPRND = STR$->KV$STR.GRPRND;
      337     2174    2      CALL KVV$CALUSR (USR_SETATR);
      338     2175    2   END;
      339     2176    1   END;

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:13   
--  Include file information  --

   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KV_SCODE_C.:E05TOU  is referenced.
   KV$VDP.:E05TOU  is referenced.
   KV_ERD_E.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KVS$SETSTR.

   Procedure KVS$SETSTR requires 1000 words for executable code.
   Procedure KVS$SETSTR requires 26 words of local(AUTO) storage.

    No errors detected in file KVS$STR.:E05TSI    .

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:14   

 Object Unit name= KVS$SETSTR                                 File name= KVS$STR.:E05TOU
 UTS= JUL 30 '97 02:15:27.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS      6      6  KVS$SETSTR
    1   Proc  even  none  1000    3E8  KVS$SETSTR
    2  RoData even  none    12      C  KVS$SETSTR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KVS$SETSTR
     1    250                  yes      Std        0  KVS$CHNSSN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KHD$SCREECH
         yes           Std       0 KVI$RE_DSPINP
 yes     yes           Std       0 KVV$CALUSR_PST
         yes           Std       1 KVO$DVCCTR
         yes           Std       0 KVI$ENBRED
         yes           Std       1 KVO$PST
         yes           Std       1 KVI$INTINPOPRX
 yes     yes           Std       1 KVV$CALUSR
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:15   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KV$RCVVDO$                            KV_RCVVDO$                            KV$RCVSSN$
     KV_VDH_PST_NEWLIN_VRT                 KV$PTR$                               KV_USR_SETATR
r    G$ROS$
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:16   


        1        1        /*M* KVS$STR Message interface routines                                       */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVS$SETSTR: PROC (STR_ID);

      8   1 000000  D380 0000 0000  xent KVS$SETSTR      LNJ,B5   X6A_AUTO_1
          1 000003       001A 0001                       DC       26,1

        9        9
       10       10        %INCLUDE KV_ERD_E;
       11       97 S      %INCLUDE KV$GLB;
       12       98 S      %INCLUDE KV$GLBCTX;
       13       99 S      %INCLUDE KV_GLBCNS_E;
       14      100        %KV#VD_ORG_E;
       15      108        %KV_PHSPSTMOD_E;
       16      115        %KV_INPOPRX_E;
       17      127        %KV_INPUNT_E;
       18      132 S      %INCLUDE KV$VDO;
       19      133        %KV$VDO (STCLASS="BASED(KV_RCVVDO$)");
       20      160    1   DCL KV$RCVVDO$ PTR SYMREF;
       21      161 S      %INCLUDE KV$INT;
       22      162 S      %INCLUDE KV$USR;
       23      163 S      %INCLUDE KV$VDH;
       24      164        %INCLUDE KV$VDP;
       25      322        %INCLUDE KV_SCODE_C;
       26      343        %INCLUDE LCP_6;
       27      534        %VLP_SCODE (FPTN=KVS_VDOSTR,FCG=KV,MID=M,ERR#=%S$KV_VDOSTR,STCLASS=CONSTANT);
       28      595        %VLP_SCODE (FPTN=KVS_VDHSTR,FCG=KV,MID=M,ERR#=%S$KV_VDHSTR,STCLASS=CONSTANT);
       29      656        %KV$RCVVDO (NAME=KV_RCVVDO, STCLASS="BASED(KV$RCVVDO$)");
       30      797    1   DCL KV_RCVVDO$ PTR SYMREF;
       31      798        %KV$RCVSSN (NAME=KV_RCVSSN, STCLASS="BASED(KV$RCVSSN$)");
       32      823    1   DCL KV$RCVSSN$ PTR SYMREF;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:17   
       33      824    1   DCL KV_VDH_PST_NEWLIN_VRT UBIN SYMREF;
       34      825
       35      826        %KV$ERD;
       36      910        %KV$LIN;
       37      934        %KV$LINLST;
       38      961        %KV$MRD;                                /*                                    */
       39     1008        %KV$MVD;                                /*                                    */
       40     1052        %KV$PTR;                                /*  VDH Pointers, status              */
       41     1095        %KV$SHRBFR (NAME=Y$ENTSRD, LAST=",");   /*  VDH shared buffer                 */
       42     1127    1          2 TXTSIZ UBIN BYTE;
       43     1128        %KV$SRD;                                /*                                    */
       44     1403        %KV$SSN;                                /*  VDH Session                       */
       45     1482        %KV$STR;                                /*  VDH Stream                        */
       46     1569        %KV$VDI;                                /*  VDH Context                       */
       47     1640    1   DCL KHD$SCREECH ENTRY(1);
       48     1641
       49     1642    1   DCL KVI$ENBRED ENTRY;
       50     1643    1   DCL KVI$INTINPOPRX ENTRY(1);
       51     1644    1   DCL KVI$RE_DSPINP ENTRY;
       52     1645    1   DCL KVO$DVCCTR ENTRY(1);
       53     1646    1   DCL KVO$PST ENTRY(1);
       54     1647    1   DCL KVV$CALUSR ENTRY(1) ALTRET;
       55     1648    1   DCL KVV$CALUSR_PST ENTRY ALTRET;
       56     1649        /* Set stream. Set up the specified stream, and all of its                    */
       57     1650        /* subordinates, as the current stream.                                       */
       58     1651
       59     1652    1   DCL STR_ID UBIN;
       60     1653    1   DCL ID UBIN;                            /* Stream ID that we want.            */
       61     1654    1   DCL PTR$ PTR;                           /* Original ASNINPPTR$                */
       62     1655    1   DCL PRVMVD$ PTR;
       63     1656    1   DCL STR$ PTR;
       64     1657        /*
       65     1658        We might need to position.
       66     1659        */
       67     1660    1   DCL Y@PST BIT(1) AUTO;
       68     1661        /*
       69     1662        FPT to get the attributes set properly
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:18   
       70     1663        */
       71     1664        %KV$USR_SETATR (STCLASS=AUTO, NAME=USR_SETATR);
       72     1787        %KV$USR_SETATR (STCLASS=SYMREF, NAME=KV_USR_SETATR);
       73     1910        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:19   
       74     1911        /* Figure out whats required. */
       75     1912
       76     1913    1      Y@PST = '1'B;

   1913   1 000005  8947 000D                            LBT,'8000'X       Y@PST,AUTO
   1913   1 000007       8000

       77     1914    1      STR$ = KV$PTR.STR$;

   1914   1 000008  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00000B  DCC6 0004                            LDB,B5   4,B6
          1 00000D  DFC7 000B                            STB,B5   STR$,AUTO

       78     1915    2      IF ADDR(STR_ID)=ADDR(NIL) THEN IF KV_RCVVDO.VDP_VDO.SETSTR THEN DO;

   1915   1 00000F  CCC7 0004                            LDB,B4   @STR_ID,AUTO
          1 000011  8DD4                                 CMN      B4
          1 000012  0981 009D                            BNE      s:1967,PREL

   1915   1 000014  BC80 0000 0000  xsym                 LDB,B3   KV$RCVVDO$
          1 000017  82C3 001D                            LB,'0080'X        29,B3
          1 000019       0080
          1 00001A  0581 0076                            BBF      s:1959,PREL

       79     1916
       80     1917        /* We've been called by KVM$RCV. Get ID from the current VDO. */
       81     1918
       82     1919    2         ID = KV$VDO.STR;

   1919   1 00001C  AC80 0000 0000  xsym                 LDB,B2   KV_RCVVDO$
          1 00001F  E802                                 LDR,R6   ,B2
          1 000020  E570 007F                            AND,R6   127,IMO
          1 000022  EF47 0006                            STR,R6   ID,AUTO

       83     1920    2         IF ID=0 THEN ID=1;

   1920   1 000024  6981 0004                            BNEZ,R6  s:1921,PREL
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:20   

   1920   1 000026  6C01                                 LDV,R6   1
          1 000027  EF47 0006                            STR,R6   ID,AUTO

       84     1921    3         IF KV_RCVVDO.PRVSTR$~=ADDR(NIL) THEN DO;

   1921   1 000029  8DC3 0020                            CMN      32,B3
          1 00002B  0901 0027                            BE       s:1933,PREL

       85     1922        /*
       86     1923           We're being called to position to a stream that we only set contextfor.
       87     1924        */
       88     1925    3            STR$ = KV_RCVVDO.PRVSTR$;

   1925   1 00002D  9CC3 0020                            LDB,B1   32,B3
          1 00002F  9FC7 000B                            STB,B1   STR$,AUTO

       89     1926    3            KV$PTR.STR$ = STR$;

   1926   1 000031  9FC6 0004                            STB,B1   4,B6

       90     1927    3            KV$PTR.MVD$ = STR$->KV$STR.MVD$;

   1927   1 000033  DCC1 0004                            LDB,B5   4,B1
          1 000035  DFC6 0006                            STB,B5   6,B6

       91     1928    3            KV$PTR.SRD$ = %KV_MVD.SRD$;

   1928   1 000037  EC85                                 LDB,B6   ,B5
          1 000038  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 00003B  EFC5 000A                            STB,B6   10,B5

       92     1929    3            KV$PTR.LINLST$ = %KV_MVD.LINLST$;

   1929   1 00003D  ECC5 0006                            LDB,B6   6,B5
          1 00003F  DCC6 0010                            LDB,B5   16,B6
          1 000041  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:21   
          1 000044  DFC6 000E                            STB,B5   14,B6

       93     1930    3            KV$PTR.MRD$ = %KV_SRD.MRD$;

   1930   1 000046  DCC6 000A                            LDB,B5   10,B6
          1 000048  EC85                                 LDB,B6   ,B5
          1 000049  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 00004C  EFC5 0008                            STB,B6   8,B5

       94     1931    3            KV_RCVVDO.PRVSTR$ = ADDR(NIL);

   1931   1 00004E  EB80 0000 0000                       LAB,B6   0
          1 000051  EFC3 0020                            STB,B6   32,B3

       95     1932    3         END;

       96     1933    2         Y@PST = KV_RCVVDO.VDP_VDO.PSTSTR;

   1933   1 000053  D843 001D                            LDR,R5   29,B3
          1 000055  500A                                 SOL,R5   10
          1 000056  D570 8000                            AND,R5   -32768,IMO
          1 000058  DF47 000D                            STR,R5   Y@PST,AUTO

       97     1934    3         IF KV_RCVVDO.VDP_VDO.RSTSTR OR NOT Y@PST THEN DO;

   1934   1 00005A  82C3 001D                            LB,'0040'X        29,B3
   1934   1 00005C       0040
          1 00005D  0501 0005                            BBT      s:1935,PREL
          1 00005F  89C7 000D                            CMZ      Y@PST,AUTO
          1 000061  0801 0023                            BAL      s:1952,PREL

       98     1935    4            IF Y@PST THEN DO;

   1935   1 000063  89C7 000D                            CMZ      Y@PST,AUTO
          1 000065  0881 000E                            BAGE     s:1942,PREL

       99     1936    4               IF KV_RCVSSN.PRVSTR$=ADDR(NIL) THEN KV_RCVSSN.PRVSTR$ = STR$;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:22   

   1936   1 000067  EC80 0000 0000  xsym                 LDB,B6   KV$RCVSSN$
          1 00006A  8DC6 0004                            CMN      4,B6
          1 00006C  0981 004B                            BNE      s:1970,PREL

   1936   1 00006E  DCC7 000B                            LDB,B5   STR$,AUTO
          1 000070  DFC6 0004                            STB,B5   4,B6

      100     1937    4            END; ELSE DO;

   1937   1 000072  0F81 0045                            B        s:1970,PREL

      101     1938        /*
      102     1939           Context switch with no need for IO (usually).
      103     1940           Set up for a change of heart.
      104     1941        */
      105     1942    4               KV_RCVVDO.VDP_VDO.PSTSTR = '1'B;

   1942   1 000074  8943 001D                            LBT,'0020'X       29,B3
   1942   1 000076       0020

      106     1943    4               IF STR$->KV$STR.ID=ID THEN RETURN;

   1943   1 000077  ECC7 000B                            LDB,B6   STR$,AUTO
          1 000079  D2C6 001C                            LLH,R5   28,B6
          1 00007B  D956                                 CMR,R5   R6
          1 00007C  0981 0004                            BNE      s:1949,PREL

   1943   1 00007E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      107     1944        /*
      108     1945           If we're already here, we must be doing the call to set position for
      109     1946           a stream "that we only set context for", but we didn't do that because
      110     1947           we were already there in the first place.  Don't setup to return anywhere.
      111     1948        */
      112     1949    4               KV_RCVVDO.PRVSTR$ = STR$;

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:23   
   1949   1 000081  EFC3 0020                            STB,B6   32,B3

      113     1950    4            END;

      114     1951    3         END;

   1951   1 000083  0F81 0034                            B        s:1970,PREL

      115     1952    2         ELSE IF NOT KV_RCVVDO.VDP_VDO.RSTSTR

   1952   1 000085  0501 0032                            BBT      s:1970,PREL

      116     1953    2         THEN KV_RCVSSN.PRVSTR$ = ADDR(NIL);

   1953   1 000087  EB80 0000 0000                       LAB,B6   0
          1 00008A  DC80 0000 0000  xsym                 LDB,B5   KV$RCVSSN$
          1 00008D  EFC5 0004                            STB,B6   4,B5

      117     1954    2      END;

   1954   1 00008F  0F81 0028                            B        s:1970,PREL

      118     1955    2      ELSE DO;

      119     1956
      120     1957        /* We're restoring a previous stream and/or session. */
      121     1958
      122     1959    3         IF KV_RCVVDO.PRVSTR$~=ADDR(NIL) THEN DO;

   1959   1 000091  8DC3 0020                            CMN      32,B3
          1 000093  0901 0009                            BE       s:1963,PREL

      123     1960    3            STR$ = KV_RCVVDO.PRVSTR$;

   1960   1 000095  ACC3 0020                            LDB,B2   32,B3
          1 000097  AFC7 000B                            STB,B2   STR$,AUTO

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:24   
      124     1961    3            Y@PST = '0'B;

   1961   1 000099  8747 000D                            CL       Y@PST,AUTO

      125     1962    3         END;

   1962   1 00009B  0F81 000C                            B        s:1964,PREL

      126     1963    2         ELSE IF KV_RCVSSN.PRVSTR$~=ADDR(NIL) THEN STR$ = KV_RCVSSN.PRVSTR$;

   1963   1 00009D  AC80 0000 0000  xsym                 LDB,B2   KV$RCVSSN$
          1 0000A0  8DC2 0004                            CMN      4,B2
          1 0000A2  0901 0005                            BE       s:1964,PREL

   1963   1 0000A4  9CC2 0004                            LDB,B1   4,B2
          1 0000A6  9FC7 000B                            STB,B1   STR$,AUTO

      127     1964    2         ID = STR$->KV$STR.ID;

   1964   1 0000A8  ACC7 000B                            LDB,B2   STR$,AUTO
          1 0000AA  E2C2 001C                            LLH,R6   28,B2
          1 0000AC  EF47 0006                            STR,R6   ID,AUTO

      128     1965    2      END;

   1965   1 0000AE  0F81 0009                            B        s:1970,PREL

      129     1966    2      ELSE DO;

      130     1967    2         ID = STR_ID;

   1967   1 0000B0  E804                                 LDR,R6   ,B4
          1 0000B1  EF47 0006                            STR,R6   ID,AUTO

      131     1968    2         IF ID=0 THEN ID=1;

   1968   1 0000B3  6981 0004                            BNEZ,R6  s:1970,PREL
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:25   

   1968   1 0000B5  6C01                                 LDV,R6   1
          1 0000B6  EF47 0006                            STR,R6   ID,AUTO

      132     1969    2      END;

      133     1970    2      IF KV$PTR$~=%KV_VDI.ASNINPPTR$ AND Y@PST THEN DO;

   1970   1 0000B8  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0000BB  DC86                                 LDB,B5   ,B6
          1 0000BC  EDC5 0006                            CMB,B6   6,B5
          1 0000BE  0901 001A                            BE       s:1980,PREL
          1 0000C0  89C7 000D                            CMZ      Y@PST,AUTO
          1 0000C2  0881 0016                            BAGE     s:1980,PREL

      134     1971    2         IF ADDR(STR_ID)=ADDR(NIL)

   1971   1 0000C4  8DD4                                 CMN      B4
          1 0000C5  0981 0008                            BNE      s:1973,PREL

      135     1972    2         THEN KV_RCVSSN.PRVPTR$ = %KV_VDI.ASNINPPTR$;

   1972   1 0000C7  BCC5 0006                            LDB,B3   6,B5
          1 0000C9  AC80 0000 0000  xsym                 LDB,B2   KV$RCVSSN$
          1 0000CC  BFC2 0002                            STB,B3   2,B2

      136     1973    2         PTR$ = KV$PTR$;

   1973   1 0000CE  EFC7 0007                            STB,B6   PTR$,AUTO

      137     1974    2         KV$PTR$ = %KV_VDI.ASNINPPTR$;

   1974   1 0000D0  DC86                                 LDB,B5   ,B6
          1 0000D1  BCC5 0006                            LDB,B3   6,B5
          1 0000D3  BF80 0000 0000  xsym                 STB,B3   KV$PTR$

      138     1975    2         CALL Y$CHNSSN;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:26   

   1975   1 0000D6  E3C0 011D                            LNJ,B6   s:0,PREL
          1 0000D8       0001                            DC       s:1980,PREL

      139     1976    2      END;

      140     1977
      141     1978        /* FIND THE APPROPRIATE STREAM AND MAKE IT CURRENT                            */
      142     1979
      143     1980    1      IF STR$=ADDR(NIL) OR ID~=STR$->KV$STR.ID

   1980   1 0000D9  8DC7 000B                            CMN      STR$,AUTO
          1 0000DB  0901 0009                            BE       s:1981,PREL
          1 0000DD  ECC7 000B                            LDB,B6   STR$,AUTO
          1 0000DF  E2C6 001C                            LLH,R6   28,B6
          1 0000E1  E947 0006                            CMR,R6   ID,AUTO
          1 0000E3  0901 000A                            BE       s:1983,PREL

      144     1981    1      THEN STR$ = %KV_SSN.STR$;

   1981   1 0000E5  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0000E8  DCC6 0002                            LDB,B5   2,B6
          1 0000EA  CCC5 0004                            LDB,B4   4,B5
          1 0000EC  CFC7 000B                            STB,B4   STR$,AUTO

      145     1982
      146     1983    2      IF ID~=STR$->KV$STR.ID THEN DO WHILE STR$~=ADDR(NIL);

   1983   1 0000EE  ECC7 000B                            LDB,B6   STR$,AUTO
          1 0000F0  E2C6 001C                            LLH,R6   28,B6
          1 0000F2  E947 0006                            CMR,R6   ID,AUTO
          1 0000F4  0901 0012                            BE       s:1989,PREL

   1983   1 0000F6  0F81 000D                            B        s:1988,PREL

      147     1984        /* CHECK TO SEE IF WE HAVE RIGHT STREAM                                       */
      148     1985
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:27   
      149     1986    2         IF ID=STR$->KV$STR.ID THEN EXIT;

   1986   1 0000F8  ECC7 000B                            LDB,B6   STR$,AUTO
          1 0000FA  E2C6 001C                            LLH,R6   28,B6
          1 0000FC  E947 0006                            CMR,R6   ID,AUTO
          1 0000FE  0901 0008                            BE       s:1989,PREL

      150     1987    2         STR$ = STR$->KV$STR.LNK$;

   1987   1 000100  DCC6 0002                            LDB,B5   2,B6
          1 000102  DFC7 000B                            STB,B5   STR$,AUTO

      151     1988    2      END /* LOOP */;

   1988   1 000104  8DC7 000B                            CMN      STR$,AUTO
          1 000106  09F2                                 BNE      s:1986,SPREL

      152     1989    1      IF STR$=ADDR(NIL) THEN IF ADDR(STR_ID)=ADDR(NIL)

   1989   1 000107  8DC7 000B                            CMN      STR$,AUTO
          1 000109  0981 0022                            BNE      s:1999,PREL

   1989   1 00010B  ECC7 0004                            LDB,B6   @STR_ID,AUTO
          1 00010D  8DD6                                 CMN      B6
          1 00010E  0981 0014                            BNE      s:1995,PREL
          1 000110  DC80 0000 0000  xsym                 LDB,B5   KV$RCVVDO$
          1 000113  82C5 001D                            LB,'0080'X        29,B5
          1 000115       0080
          1 000116  0581 000C                            BBF      s:1995,PREL

      153     1990    1        AND KV_RCVVDO.VDP_VDO.SETSTR
      154     1991    1      THEN CALL KHD$SCREECH (KVS_VDOSTR);

   1991   1 000118  BB80 0000 0000  02                   LAB,B3   0
          1 00011B  CBF0 0100                            LAB,B4   256,IMO
          1 00011D  E380 0000 0000  xent                 LNJ,B6   KHD$SCREECH
          1 000120       0001                            DC       s:1991+9,PREL
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:28   
          1 000121  0F81 000A                            B        s:1999,PREL

      155     1992        /*S*   SCREECH_CODE: KVS-S$KV_VDOSTR
      156     1993               MESSAGE: VDH got a VDO for a non-existent stream.
      157     1994        */
      158     1995    1      ELSE CALL KHD$SCREECH (KVS_VDHSTR);

   1995   1 000123  BB80 0000 0002  02                   LAB,B3   +2
          1 000126  CBF0 0100                            LAB,B4   256,IMO
          1 000128  E380 0000 0000  xent                 LNJ,B6   KHD$SCREECH
          1 00012B       0001                            DC       s:1999,PREL

      159     1996        /*S*   SCREECH_CODE: KVS-S$KV_VDHSTR
      160     1997               MESSAGE: VDH tried to switch to a non-existent stream.
      161     1998        */
      162     1999    2      IF STR$~=KV$PTR.STR$ THEN DO;

   1999   1 00012C  ECC7 000B                            LDB,B6   STR$,AUTO
          1 00012E  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000131  EDC5 0004                            CMB,B6   4,B5
          1 000133  0901 009E                            BE       s:2046,PREL

      163     2000
      164     2001        /* We found the right stream.                                                 */
      165     2002
      166     2003    2         PRVMVD$ = KV$PTR.MVD$;

   2003   1 000135  CCC5 0006                            LDB,B4   6,B5
          1 000137  CFC7 0009                            STB,B4   PRVMVD$,AUTO

      167     2004    2         IF PRVMVD$~=ADDR(NIL)

   2004   1 000139  8DC7 0009                            CMN      PRVMVD$,AUTO
          1 00013B  0901 000E                            BE       s:2007,PREL

      168     2005    2         THEN IF PRVMVD$->KV$MVD.SRD$~=STR$->KV$STR.MVD$->KV$MVD.SRD$ AND Y@PST

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:29   
   2005   1 00013D  BCC6 0004                            LDB,B3   4,B6
          1 00013F  AC84                                 LDB,B2   ,B4
          1 000140  AD83                                 CMB,B2   ,B3
          1 000141  0901 0008                            BE       s:2007,PREL
          1 000143  89C7 000D                            CMZ      Y@PST,AUTO
          1 000145  0881 0004                            BAGE     s:2007,PREL

      169     2006    2         THEN CALL Y$EXTSRD;

   2006   1 000147  E3C0 012E                            LNJ,B6   s:0,PREL
          1 000149       0001                            DC       s:2007,PREL

      170     2007    2         KV$PTR.STR$ = STR$;

   2007   1 00014A  ECC7 000B                            LDB,B6   STR$,AUTO
          1 00014C  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 00014F  EFC5 0004                            STB,B6   4,B5

      171     2008    2         KV$PTR.MVD$ = STR$->KV$STR.MVD$;

   2008   1 000151  CCC6 0004                            LDB,B4   4,B6
          1 000153  CFC5 0006                            STB,B4   6,B5

      172     2009    2         KV$PTR.SRD$ = %KV_MVD.SRD$;

   2009   1 000155  BC84                                 LDB,B3   ,B4
          1 000156  BFC5 000A                            STB,B3   10,B5

      173     2010    2         KV$PTR.LINLST$ = %KV_MVD.LINLST$;

   2010   1 000158  ACC4 0010                            LDB,B2   16,B4
          1 00015A  AFC5 000E                            STB,B2   14,B5

      174     2011    2         KV$PTR.MRD$ = %KV_SRD.MRD$;

   2011   1 00015C  9C83                                 LDB,B1   ,B3
          1 00015D  9FC5 0008                            STB,B1   8,B5
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:30   

      175     2012
      176     2013    3         IF KV$PTR.MVD$~=PRVMVD$ THEN DO;

   2013   1 00015F  CDC7 0009                            CMB,B4   PRVMVD$,AUTO
          1 000161  0901 005A                            BE       s:2036,PREL

      177     2014    3            IF PRVMVD$=ADDR(NIL) THEN CALL Y$ENTSRD;

   2014   1 000163  8DC7 0009                            CMN      PRVMVD$,AUTO
          1 000165  0981 0006                            BNE      s:2015,PREL

   2014   1 000167  E3C0 015D                            LNJ,B6   s:0,PREL
          1 000169       0001                            DC       s:2014+7,PREL
          1 00016A  0F81 000D                            B        s:2019,PREL

      178     2015    3            ELSE IF KV$PTR.SRD$~=PRVMVD$->KV$MVD.SRD$ AND Y@PST THEN CALL Y$ENTSRD;

   2015   1 00016C  ECC7 0009                            LDB,B6   PRVMVD$,AUTO
          1 00016E  BD86                                 CMB,B3   ,B6
          1 00016F  0901 0008                            BE       s:2019,PREL
          1 000171  89C7 000D                            CMZ      Y@PST,AUTO
          1 000173  0881 0004                            BAGE     s:2019,PREL

   2015   1 000175  E3C0 014F                            LNJ,B6   s:0,PREL
          1 000177       0001                            DC       s:2019,PREL

      179     2016
      180     2017        /* We're changing MVDs.                                                    */
      181     2018
      182     2019    4            IF %KV_MVD.ORG=%KV#VD_ORG_FORM THEN DO;

   2019   1 000178  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00017B  DCC6 0006                            LDB,B5   6,B6
          1 00017D  E2C5 0015                            LLH,R6   21,B5
          1 00017F  6D04                                 CMV,R6   4
          1 000180  0981 0051                            BNE      s:2046,PREL
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:31   

      183     2020
      184     2021        /* The new stream points to a virtual device whose organization         */
      185     2022        /* is of 'form'. Initialize the form-specific data.                     */
      186     2023
      187     2024    4               KV$PTR.VRTCLM = %KV_MVD.VRTCLM;

   2024   1 000182  D845 001B                            LDR,R5   27,B5
          1 000184  DF46 001A                            STR,R5   26,B6

      188     2025    4               IF %KV_MRD.ATRRQRDSPPST THEN KV$PTR.VRTCLM = KV$PTR.VRTCLM+1;

   2025   1 000186  CCC6 0008                            LDB,B4   8,B6
          1 000188  89C4 0018                            CMZ      24,B4
          1 00018A  0881 0003                            BAGE     s:2026,PREL

   2025   1 00018C  8AC6 001A                            INC      26,B6

      189     2026    4               KV$PTR.LIN$ = %KV_LINLST.ONEFLDLIN$;

   2026   1 00018E  BCC6 000E                            LDB,B3   14,B6
          1 000190  ACC3 0002                            LDB,B2   2,B3
          1 000192  AFC6 0010                            STB,B2   16,B6

      190     2027    5               IF KV$PTR.LIN$~=ADDR(NIL) AND %KV_SSN.REDRQSPND THEN DO;

   2027   1 000194  8DC6 0010                            CMN      16,B6
          1 000196  0901 001E                            BE       s:2033,PREL
          1 000198  9CC6 0002                            LDB,B1   2,B6
          1 00019A  82C1 0028                            LB,'0002'X        40,B1
          1 00019C       0002
          1 00019D  0581 0017                            BBF      s:2033,PREL

      191     2028    5                  KV$PTR.VRTLIN = %KV_LIN.VRTLIN;

   2028   1 00019F  E842 0002                            LDR,R6   2,B2
          1 0001A1  EF46 0019                            STR,R6   25,B6
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:32   

      192     2029    5                  KV$PTR.FLDLST$ = %KV_LIN.FLDLST$;

   2029   1 0001A3  EC82                                 LDB,B6   ,B2
          1 0001A4  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 0001A7  EFC5 0012                            STB,B6   18,B5

      193     2030    5                  KV$PTR.FLDWRDX = %KV_LINLST.ONEFLDWRDX;

   2030   1 0001A9  CCC5 000E                            LDB,B4   14,B5
          1 0001AB  E844 0004                            LDR,R6   4,B4
          1 0001AD  EF45 0018                            STR,R6   24,B5

      194     2031    5                  KV$PTR.FLD$ = PINCRW (KV$PTR.FLDLST$,KV$PTR.FLDWRDX);

   2031   1 0001AF  B856                                 LDR,R3   R6
          1 0001B0  BBB6                                 LAB,B3   ,B6,R3
          1 0001B1  BFC5 0014                            STB,B3   20,B5

      195     2032    5               END;

   2032   1 0001B3  0F81 001E                            B        s:2046,PREL

      196     2033    4               ELSE KV$PTR.FLD$ = ADDR(NIL);

   2033   1 0001B5  9B80 0000 0000                       LAB,B1   0
          1 0001B8  9FC6 0014                            STB,B1   20,B6

      197     2034    4            END;                           /* IFnew MVD.ORG=FORM                 */

      198     2035    3         END;

   2035   1 0001BA  0F81 0017                            B        s:2046,PREL

      199     2036    3         ELSE IF Y@PST THEN DO;

   2036   1 0001BC  89C7 000D                            CMZ      Y@PST,AUTO
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:33   
          1 0001BE  0881 0013                            BAGE     s:2046,PREL

      200     2037        /*
      201     2038        New stream, but the same window.
      202     2039        */
      203     2040    3            IF %KV_MRD.DCLATRWHNOTP

   2040   1 0001C0  82C1 0018                            LB,'0200'X        24,B1
   2040   1 0001C2       0200
          1 0001C3  0581 000B                            BBF      s:2043,PREL
          1 0001C5  E2C1 001F                            LLH,R6   31,B1
          1 0001C7  D2C6 001F                            LLH,R5   31,B6
          1 0001C9  E955                                 CMR,R6   R5
          1 0001CA  0901 0004                            BE       s:2043,PREL

      204     2041    3              AND BITBIN(%KV_MRD.DVCATR)~=BITBIN(STR$->KV$STR.GRPRND)
      205     2042    3            THEN CALL Y$FIXATR;

   2042   1 0001CC  E3C0 01F8                            LNJ,B6   s:0,PREL
          1 0001CE       0001                            DC       s:2043,PREL

      206     2043    3            CALL Y$FIXRED;

   2043   1 0001CF  E3C0 015C                            LNJ,B6   s:0,PREL
          1 0001D1       0001                            DC       s:2046,PREL

      207     2044    3         END;

      208     2045    2      END; /* IF STR is new */

      209     2046    1      IF ADDR(STR_ID)=ADDR(NIL) AND NOT KV_RCVVDO.VDP_VDO.SETSTR

   2046   1 0001D2  ECC7 0004                            LDB,B6   @STR_ID,AUTO
          1 0001D4  8DD6                                 CMN      B6
          1 0001D5  0981 001B                            BNE      s:2055,PREL
          1 0001D7  DC80 0000 0000  xsym                 LDB,B5   KV$RCVVDO$
          1 0001DA  82C5 001D                            LB,'0080'X        29,B5
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:34   
          1 0001DC       0080
          1 0001DD  0501 0013                            BBT      s:2055,PREL
          1 0001DF  8DC5 0020                            CMN      32,B5
          1 0001E1  0981 000F                            BNE      s:2055,PREL

      210     2047    1        AND KV_RCVVDO.PRVSTR$=ADDR(NIL)
      211     2048    2      THEN IF KV_RCVSSN.PRVPTR$~=ADDR(NIL) THEN DO;

   2048   1 0001E3  CC80 0000 0000  xsym                 LDB,B4   KV$RCVSSN$
          1 0001E6  8DC4 0002                            CMN      2,B4
          1 0001E8  0901 0008                            BE       s:2055,PREL

      212     2049        /*
      213     2050           Returning to a different SSN.  Fix up some more stuff.
      214     2051        */
      215     2052    2         PTR$ = KV_RCVSSN.PRVPTR$;

   2052   1 0001EA  BCC4 0002                            LDB,B3   2,B4
          1 0001EC  BFC7 0007                            STB,B3   PTR$,AUTO

      216     2053    2         CALL Y$CHNSSN;

   2053   1 0001EE  E3C0 0005                            LNJ,B6   s:0,PREL
          1 0001F0       0001                            DC       s:2055,PREL

      217     2054    2      END;

      218     2055    1      RETURN;

   2055   1 0001F1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      219     2056        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:35   
      220     2057    1   Y$CHNSSN: PROC;

   2057   1 0001F4  EFC7 0012            Y$CHNSSN        STB,B6   USR_SETATR+4,AUTO

      221     2058        /*D* NAME: Y$CHNSSN.  Switch sessions.
      222     2059             DESCRIPTION: Does whatever is needed to switch context from the
      223     2060             session reflected by KV$PTR$ to the one for PTR$.
      224     2061        */
      225     2062    2      STR$ = PTR$->KV$PTR.STR$;

   2062   1 0001F6  DCC7 0007                            LDB,B5   PTR$,AUTO
          1 0001F8  CCC5 0004                            LDB,B4   4,B5
          1 0001FA  CFC7 000B                            STB,B4   STR$,AUTO

      226     2063    3      IF KV$PTR.SRD$~=PTR$->KV$PTR.SRD$ THEN DO;

   2063   1 0001FC  BC80 0000 0000  xsym                 LDB,B3   KV$PTR$
          1 0001FF  ACC3 000A                            LDB,B2   10,B3
          1 000201  ADC5 000A                            CMB,B2   10,B5
          1 000203  0901 001B                            BE       s:2075,PREL

      227     2064        /*
      228     2065           Only go through the whole process if we're doing windows.
      229     2066        */
      230     2067    3         IF KV$PTR.SRD$~=ADDR(NIL) THEN CALL Y$EXTSRD;

   2067   1 000205  8DC3 000A                            CMN      10,B3
          1 000207  0901 0004                            BE       s:2068,PREL

   2067   1 000209  E3C0 006C                            LNJ,B6   s:0,PREL
          1 00020B       0001                            DC       s:2068,PREL

      231     2068    3         KV$PTR$ = PTR$;

   2068   1 00020C  ECC7 0007                            LDB,B6   PTR$,AUTO
          1 00020E  EF80 0000 0000  xsym                 STB,B6   KV$PTR$

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:36   
      232     2069    3         %KV_VDI.USRRQSDAT.RED = %KV_SSN.REDRQSPND;

   2069   1 000211  DC86                                 LDB,B5   ,B6
          1 000212  CCC6 0002                            LDB,B4   2,B6
          1 000214  E844 0028                            LDR,R6   40,B4
          1 000216  6003                                 SOL,R6   3
          1 000217  EAC5 001D                            SRM,R6,'0010'X    29,B5
          1 000219       0010

      233     2070    3         CALL Y$ENTSRD;

   2070   1 00021A  E3C0 00AA                            LNJ,B6   s:0,PREL
          1 00021C       0001                            DC       s:2071,PREL

      234     2071    3      END; ELSE DO;

   2071   1 00021D  0F81 0028                            B        s:2083,PREL

      235     2072        /*
      236     2073           Redisplay the prompt and partial input if there is one.
      237     2074        */
      238     2075    3         KV$PTR$ = PTR$;

   2075   1 00021F  DF80 0000 0000  xsym                 STB,B5   KV$PTR$

      239     2076    3         IF %KV_MRD.DCLATRWHNOTP

   2076   1 000222  BCC5 0008                            LDB,B3   8,B5
          1 000224  82C3 0018                            LB,'0200'X        24,B3
          1 000226       0200
          1 000227  0581 000B                            BBF      s:2079,PREL
          1 000229  E2C3 001F                            LLH,R6   31,B3
          1 00022B  D2C4 001F                            LLH,R5   31,B4
          1 00022D  E955                                 CMR,R6   R5
          1 00022E  0901 0004                            BE       s:2079,PREL

      240     2077    3           AND BITBIN(%KV_MRD.DVCATR)~=BITBIN(STR$->KV$STR.GRPRND)
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:37   
      241     2078    3         THEN CALL Y$FIXATR;

   2078   1 000230  E3C0 0194                            LNJ,B6   s:0,PREL
          1 000232       0001                            DC       s:2079,PREL

      242     2079    3         %KV_VDI.RE_DSPINP = '0'B;

   2079   1 000233  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000236  DC86                                 LDB,B5   ,B6
          1 000237  8845 0019                            LBF,'0010'X       25,B5
          1 000239       0010

      243     2080    3         %KV_VDI.USRRQSDAT.RED = %KV_SSN.REDRQSPND;

   2080   1 00023A  DC86                                 LDB,B5   ,B6
          1 00023B  CCC6 0002                            LDB,B4   2,B6
          1 00023D  E844 0028                            LDR,R6   40,B4
          1 00023F  6003                                 SOL,R6   3
          1 000240  EAC5 001D                            SRM,R6,'0010'X    29,B5
          1 000242       0010

      244     2081    3         CALL Y$FIXRED;

   2081   1 000243  E3C0 00E8                            LNJ,B6   s:0,PREL
          1 000245       0001                            DC       s:2083,PREL

      245     2082    3      END;

      246     2083    2      %KV_VDI.ASNINPPTR$ = KV$PTR$;

   2083   1 000246  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000249  DC86                                 LDB,B5   ,B6
          1 00024A  EFC5 0006                            STB,B6   6,B5

      247     2084    2      RETURN;

   2084   1 00024C  ECC7 0012                            LDB,B6   USR_SETATR+4,AUTO
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:38   
          1 00024E  C3C6 0001                            LNJ,B4   1,B6

      248     2085    2   END Y$CHNSSN;
      249     2086
      250     2087    1   KVS$CHNSSN: ENTRY;

   2087   1 000250  D380 0000 0000  xent KVS$CHNSSN      LNJ,B5   X6A_AUTO_1
          1 000253       001A 0001                       DC       26,1

      251     2088        /*F* NAME:KVS$CHNSSN.  Switch from a released session.
      252     2089             DESCRIPTION: Does whatever is needed to establish context and
      253     2090             position for a session other than the current one.
      254     2091        */
      255     2092    1      IF KV$PTR$~=%KV_VDI.ASNINPPTR$

   2092   1 000255  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000258  DC86                                 LDB,B5   ,B6
          1 000259  EDC5 0006                            CMB,B6   6,B5
          1 00025B  0901 0007                            BE       s:2094,PREL

      256     2093    1      THEN PTR$ = %KV_VDI.ASNINPPTR$;

   2093   1 00025D  CCC5 0006                            LDB,B4   6,B5
          1 00025F  CFC7 0007                            STB,B4   PTR$,AUTO
          1 000261  0F81 000E                            B        s:2096,PREL

      257     2094    1      ELSE IF KV$PTR$=%KV_VDI.SSN$->KV$SSN.SNCPTR$ THEN RETURN;

   2094   1 000263  CCC5 0004                            LDB,B4   4,B5
          1 000265  EDC4 0008                            CMB,B6   8,B4
          1 000267  0981 0004                            BNE      s:2095,PREL

   2094   1 000269  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      258     2095    1      ELSE PTR$ = %KV_VDI.SSN$->KV$SSN.SNCPTR$;

   2095   1 00026C  BCC4 0008                            LDB,B3   8,B4
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:39   
          1 00026E  BFC7 0007                            STB,B3   PTR$,AUTO

      259     2096    1      CALL Y$CHNSSN;

   2096   1 000270  E3C0 FF83                            LNJ,B6   s:0,PREL
          1 000272       0001                            DC       s:2097,PREL

      260     2097    1      RETURN;

   2097   1 000273  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      261     2098        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:40   
      262     2099    1   Y$EXTSRD: PROC;

   2099   1 000276  EFC7 0014            Y$EXTSRD        STB,B6   USR_SETATR+6,AUTO

      263     2100        /*D* NAME: Y$EXTSRD. Exit the SRD.
      264     2101             DESCRIPTION: Performs any positioning and related operations to
      265     2102             get out of the current SRD. */
      266     2103    2      IF %KV_VDI.PHSDSC THEN RETURN;

   2103   1 000278  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 00027B  CC85                                 LDB,B4   ,B5
          1 00027C  82C4 0019                            LB,'0040'X        25,B4
          1 00027E       0040
          1 00027F  0581 0005                            BBF      s:2104,PREL

   2103   1 000281  ECC7 0014                            LDB,B6   USR_SETATR+6,AUTO
          1 000283  C3C6 0001                            LNJ,B4   1,B6

      267     2104    2      IF %KV_VDI.RE_DSPINP THEN CALL KVI$RE_DSPINP;

   2104   1 000285  82C4 0019                            LB,'0010'X        25,B4
   2104   1 000287       0010
          1 000288  0581 0007                            BBF      s:2105,PREL

   2104   1 00028A  CBF0 0000                            LAB,B4   0,IMO
          1 00028C  E380 0000 0000  xent                 LNJ,B6   KVI$RE_DSPINP
          1 00028F       0001                            DC       s:2105,PREL

      268     2105    2      IF %KV_VDI.OTPCNDPND.PST=%KV_PHSPSTMOD_BLN AND %KV_MRD.BLANKERASES

   2105   1 000290  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000293  DC86                                 LDB,B5   ,B6
          1 000294  E845 001A                            LDR,R6   26,B5
          1 000296  6D02                                 CMV,R6   2
          1 000297  0981 000E                            BNE      s:2107,PREL
          1 000299  CCC6 0008                            LDB,B4   8,B6
          1 00029B  82C4 0016                            LB,'0002'X        22,B4
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:41   
          1 00029D       0002
          1 00029E  0581 0007                            BBF      s:2107,PREL

      269     2106    2      THEN CALL KVV$CALUSR_PST;

   2106   1 0002A0  CBF0 0000                            LAB,B4   0,IMO
          1 0002A2  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR_PST
          1 0002A5       0001                            DC       s:2107,PREL

      270     2107    3      IF %KV_SRD.ENBENTEXTSRDCHR THEN DO;

   2107   1 0002A6  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0002A9  DCC6 000A                            LDB,B5   10,B6
          1 0002AB  82C5 000F                            LB,'0080'X        15,B5
          1 0002AD       0080
          1 0002AE  0581 0012                            BBF      s:2116,PREL

      271     2108    4         IF %KV_ERD.EXTSRD_CHR ~= 0 THEN DO;

   2108   1 0002B0  CCC6 0008                            LDB,B4   8,B6
          1 0002B2  BCC4 0008                            LDB,B3   8,B4
          1 0002B4  E2C3 002D                            LLH,R6   45,B3
          1 0002B6  6901 000A                            BEZ,R6   s:2116,PREL

      272     2109        /*
      273     2110        There is a character string to be sent to the device when
      274     2111        exiting this SRD.  Send it.
      275     2112        */
      276     2113    4            CALL KVO$DVCCTR(%KV$ERD_EXTSRD_CHR#/8);

   2113   1 0002B8  BB80 0000 0005  02                   LAB,B3   +5
          1 0002BB  CBF0 0100                            LAB,B4   256,IMO
          1 0002BD  E380 0000 0000  xent                 LNJ,B6   KVO$DVCCTR
          1 0002C0       0001                            DC       s:2116,PREL

      277     2114    4         END;                              /* END IF %KV_ERD.EXTSRD_CHR ~= 0     */

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:42   
      278     2115    3      END; /* END IF %KV_SRD.ENBENTEXTSRDCHR */

      279     2116    2      RETURN;

   2116   1 0002C1  ECC7 0014                            LDB,B6   USR_SETATR+6,AUTO
          1 0002C3  C3C6 0001                            LNJ,B4   1,B6

      280     2117    2   END Y$EXTSRD;
      281     2118        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:43   
      282     2119        /*D* NAME: Y$ENTSRD. Enter the SRD.
      283     2120             DESCRIPTION: Causes anything required to happed when entering the
      284     2121             currently addressed SRD to happen.
      285     2122        */
      286     2123    1   Y$ENTSRD: PROC;

   2123   1 0002C5  EFC7 0014            Y$ENTSRD        STB,B6   USR_SETATR+6,AUTO

      287     2124    2      IF %KV_VDI.PHSDSC THEN RETURN;

   2124   1 0002C7  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 0002CA  CC85                                 LDB,B4   ,B5
          1 0002CB  82C4 0019                            LB,'0040'X        25,B4
          1 0002CD       0040
          1 0002CE  0581 0005                            BBF      s:2125,PREL

   2124   1 0002D0  ECC7 0014                            LDB,B6   USR_SETATR+6,AUTO
          1 0002D2  C3C6 0001                            LNJ,B4   1,B6

      288     2125    2      %KV_VDI.OTPCNDPND.PST = %KV_PHSPSTMOD_SKP;

   2125   1 0002D4  6C01                                 LDV,R6   1
          1 0002D5  EF44 001A                            STR,R6   26,B4

      289     2126    2      IF NOT %KV_MRD.CALUSR_PST

   2126   1 0002D7  CCC5 0008                            LDB,B4   8,B5
          1 0002D9  82C4 000C                            LB,'0040'X        12,B4
          1 0002DB       0040
          1 0002DC  0501 000D                            BBT      s:2131,PREL

      290     2127        /*
      291     2128           It may not be possible to LF into the new window, but that can be fixed.
      292     2129        */
      293     2130    2      THEN IF %KV_ERD.RGNSCR THEN %KV_SRD.UNKRGN = '1'B;

   2130   1 0002DE  BCC4 0008                            LDB,B3   8,B4
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:44   
          1 0002E0  82C3 0016                            LB,'0008'X        22,B3
          1 0002E2       0008
          1 0002E3  0581 0006                            BBF      s:2131,PREL

   2130   1 0002E5  ACC5 000A                            LDB,B2   10,B5
          1 0002E7  8942 000F                            LBT,'0002'X       15,B2
          1 0002E9       0002

      294     2131    2      IF %KV_SRD.ENBENTEXTSRDCHR AND %KV_SRD.ENTSRDCHR$~=ADDR(NIL)

   2131   1 0002EA  ECC5 000A                            LDB,B6   10,B5
          1 0002EC  82C6 000F                            LB,'0080'X        15,B6
          1 0002EE       0080
          1 0002EF  0581 0024                            BBF      s:2140,PREL
          1 0002F1  8DC6 0004                            CMN      4,B6
          1 0002F3  0901 0020                            BE       s:2140,PREL

      295     2132    3      THEN IF %KV_SRD.ENTSRDCHR$->Y$ENTSRD.TXTSIZ~=0 THEN DO;

   2132   1 0002F5  CCC6 0004                            LDB,B4   4,B6
          1 0002F7  D2C4 0004                            LLH,R5   4,B4
          1 0002F9  5901 001A                            BEZ,R5   s:2140,PREL

      296     2133        /*
      297     2134        There is a character string to be sent to the device when
      298     2135        entering this SRD.  Send it.
      299     2136        */
      300     2137    3         CALL KVV$CALUSR_PST;

   2137   1 0002FB  CBF0 0000                            LAB,B4   0,IMO
          1 0002FD  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR_PST
          1 000300       0001                            DC       s:2138,PREL

      301     2138    3         CALL KVO$DVCCTR (%KV_SRD.ENTSRDCHR$->Y$ENTSRD.TXTSIZ);

   2138   1 000301  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000304  DCC6 000A                            LDB,B5   10,B6
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:45   
          1 000306  CCC5 0004                            LDB,B4   4,B5
          1 000308  BBC4 0004                            LAB,B3   4,B4
          1 00030A  BFC7 0018                            STB,B3   USR_SETATR+10,AUTO
          1 00030C  BBC7 0018                            LAB,B3   USR_SETATR+10,AUTO
          1 00030E  CBF0 0100                            LAB,B4   256,IMO
          1 000310  E380 0000 0000  xent                 LNJ,B6   KVO$DVCCTR
          1 000313       0001                            DC       s:2140,PREL

      302     2139    3      END;

      303     2140    2      IF %KV_MRD.DCLATRWHNOTP

   2140   1 000314  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000317  DCC6 0008                            LDB,B5   8,B6
          1 000319  82C5 0018                            LB,'0200'X        24,B5
          1 00031B       0200
          1 00031C  0581 000D                            BBF      s:2142+3,PREL
          1 00031E  E2C5 001F                            LLH,R6   31,B5
          1 000320  CCC7 000B                            LDB,B4   STR$,AUTO
          1 000322  D2C4 001F                            LLH,R5   31,B4
          1 000324  E955                                 CMR,R6   R5
          1 000325  0901 0004                            BE       s:2142+3,PREL

      304     2141    2        AND BITBIN(%KV_MRD.DVCATR)~=BITBIN(STR$->KV$STR.GRPRND)
      305     2142    2      THEN CALL Y$FIXATR;

   2142   1 000327  E3C0 009D                            LNJ,B6   s:0,PREL
          1 000329       0001                            DC       s:2142+3,PREL
          1 00032A  0F81 0003                            B        s:2144,PREL

      306     2143    2   Y$FIXRED: ENTRY;

   2143   1 00032C  EFC7 0014            Y$FIXRED        STB,B6   USR_SETATR+6,AUTO

      307     2144    2      IF %KV_SRD.LNG>0 AND %KV_SRD.WDT>0 AND %KV_MVD.ORG<%KV#VD_ORG_X364

   2144   1 00032E  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:46   
          1 000331  DCC6 000A                            LDB,B5   10,B6
          1 000333  E2C5 000E                            LLH,R6   14,B5
          1 000335  6901 0088                            BEZ,R6   s:2164,PREL
          1 000337  D845 000D                            LDR,R5   13,B5
          1 000339  5901 0084                            BEZ,R5   s:2164,PREL
          1 00033B  CCC6 0006                            LDB,B4   6,B6
          1 00033D  C2C4 0015                            LLH,R4   21,B4
          1 00033F  4D02                                 CMV,R4   2
          1 000340  0281 007D                            BGE      s:2164,PREL
          1 000342  BC86                                 LDB,B3   ,B6
          1 000343  B843 001D                            LDR,R3   29,B3
          1 000345  3045                                 SOR,R3   5
          1 000346  B570 0003                            AND,R3   3,IMO
          1 000348  3D01                                 CMV,R3   1
          1 000349  0981 0074                            BNE      s:2164,PREL
          1 00034B  82C5 001C                            LB,'4000'X        28,B5
          1 00034D       4000
          1 00034E  0501 000A                            BBT      s:2147,PREL
          1 000350  ACC6 0002                            LDB,B2   2,B6
          1 000352  A2C4 001F                            LLH,R2   31,B4
          1 000354  92C2 0037                            LLH,R1   55,B2
          1 000356  A951                                 CMR,R2   R1
          1 000357  0901 0066                            BE       s:2164,PREL

      308     2145    2        AND %KV_VDI.INPUNT=%KV_INPUNT_CHR
      309     2146    3        AND (%KV_SRD.UNKPST OR %KV_MVD.REDSSNID~=%KV_SSN.SSNID) THEN DO;

      310     2147    4         IF %KV_SRD.UNKPST THEN DO;

   2147   1 000359  0581 0021                            BBF      s:2155,PREL

      311     2148    4            %KV_SRD.UNKPST = '0'B;

   2148   1 00035B  8845 001C                            LBF,'4000'X       28,B5
   2148   1 00035D       4000

      312     2149    4            %KV_MVD.VRTCLM = 1;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:47   

   2149   1 00035E  DCC6 0006                            LDB,B5   6,B6
          1 000360  6C01                                 LDV,R6   1
          1 000361  EF45 001B                            STR,R6   27,B5

      313     2150    4            %KV_SRD.CRT.LIN = %KV_SRD.BTMRHT.LIN-%KV_SRD.DVCLINBIS;

   2150   1 000363  DCC6 000A                            LDB,B5   10,B6
          1 000365  D845 000B                            LDR,R5   11,B5
          1 000367  D245 0019                            SUB,R5   25,B5
          1 000369  DF45 0015                            STR,R5   21,B5

      314     2151    4            %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRT.LIN+1;

   2151   1 00036B  DCC6 000A                            LDB,B5   10,B6
          1 00036D  D845 0015                            LDR,R5   21,B5
          1 00036F  5E01                                 ADV,R5   1
          1 000370  DF45 0013                            STR,R5   19,B5

      315     2152    4            %KV_SRD.VRTPSTOK = '0'B;

   2152   1 000372  DCC6 000A                            LDB,B5   10,B6
          1 000374  8845 000E                            LBF,'0010'X       14,B5
          1 000376       0010

      316     2153    4            %KV_VDI.UN_KNWPST = '1'B;

   2153   1 000377  DC86                                 LDB,B5   ,B6
          1 000378  8945 001D                            LBT,'1000'X       29,B5
          1 00037A       1000

      317     2154    4         END;

      318     2155    3         IF %KV_SSN.REDRQSPND AND %KV_SSN.REDSTRID=%KV_STR.ID

   2155   1 00037B  DCC6 0002                            LDB,B5   2,B6
          1 00037D  82C5 0028                            LB,'0002'X        40,B5
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:48   
          1 00037F       0002
          1 000380  0581 0040                            BBF      s:2165,PREL
          1 000382  CCC6 0004                            LDB,B4   4,B6
          1 000384  E2C5 0038                            LLH,R6   56,B5
          1 000386  D2C4 001C                            LLH,R5   28,B4
          1 000388  E955                                 CMR,R6   R5
          1 000389  0981 0037                            BNE      s:2165,PREL
          1 00038B  89C6 001B                            CMZ      27,B6
          1 00038D  0801 0033                            BAL      s:2165,PREL

      319     2156    4           AND NOT KV$PTR.INPCNDPND.TRN THEN DO;

      320     2157    4            IF %KV_MVD.VRTCLM>1 OR %KV_SRD.HI_NONBLN.LIN>=%KV_SRD.CRT.LIN

   2157   1 00038F  BCC6 0006                            LDB,B3   6,B6
          1 000391  C843 001B                            LDR,R4   27,B3
          1 000393  4D01                                 CMV,R4   1
          1 000394  0A01 000F                            BAG      s:2159,PREL
          1 000396  ACC6 000A                            LDB,B2   10,B6
          1 000398  B842 0017                            LDR,R3   23,B2
          1 00039A  B942 0015                            CMR,R3   21,B2
          1 00039C  0881 0007                            BAGE     s:2159,PREL
          1 00039E  9C86                                 LDB,B1   ,B6
          1 00039F  82C1 001D                            LB,'1000'X        29,B1
          1 0003A1       1000
          1 0003A2  0581 000A                            BBF      s:2160,PREL

      321     2158    4              OR %KV_VDI.UN_KNWPST
      322     2159    4            THEN CALL KVO$PST (KV_VDH_PST_NEWLIN_VRT);

   2159   1 0003A4  BB80 0000 0007  02                   LAB,B3   +7
          1 0003A7  CBF0 0100                            LAB,B4   256,IMO
          1 0003A9  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 0003AC       0001                            DC       s:2160,PREL

      323     2160    4            CALL KVI$ENBRED;

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:49   
   2160   1 0003AD  CBF0 0000                            LAB,B4   0,IMO
          1 0003AF  E380 0000 0000  xent                 LNJ,B6   KVI$ENBRED
          1 0003B2       0001                            DC       s:2161,PREL

      324     2161    4            CALL KVI$INTINPOPRX (%KV_INPOPRX_RE_TYP);

   2161   1 0003B3  BB80 0000 000A  02                   LAB,B3   +10
          1 0003B6  CBF0 0100                            LAB,B4   256,IMO
          1 0003B8  E380 0000 0000  xent                 LNJ,B6   KVI$INTINPOPRX
          1 0003BB       0001                            DC       s:2163,PREL

      325     2162    4         END;

      326     2163    3      END;

   2163   1 0003BC  0F81 0004                            B        s:2165,PREL

      327     2164    2      ELSE %KV_SRD.UNKPST = '0'B;

   2164   1 0003BE  8845 001C                            LBF,'4000'X       28,B5
   2164   1 0003C0       4000

      328     2165    2      RETURN;

   2165   1 0003C1  ECC7 0014                            LDB,B6   USR_SETATR+6,AUTO
          1 0003C3  C3C6 0001                            LNJ,B4   1,B6

      329     2166    2   END Y$ENTSRD;
      330     2167        %EJECT;
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:50   
      331     2168        /*D* NAME: Y$FIXATR.  Fix the graphic rendition.
      332     2169             DESCRIPTION: Just builds a USR_SETATR FPT and makes the call.
      333     2170        */
      334     2171    1   Y$FIXATR: PROC;

   2171   1 0003C5  EFC7 0016            Y$FIXATR        STB,B6   USR_SETATR+8,AUTO

      335     2172    2      USR_SETATR = KV_USR_SETATR;

   2172   1 0003C7  AB80 0000 0000  xsym                 LAB,B2   KV_USR_SETATR
          1 0003CA  2C00                                 LDV,R2   0
          1 0003CB  6C08                                 LDV,R6   8
          1 0003CC  BB87                                 LAB,B3   ,AUTO
          1 0003CD  3C1C                                 LDV,R3   28
          1 0003CE  0008                                 MMM

      336     2173    2      USR_SETATR.GRPRND = STR$->KV$STR.GRPRND;

   2173   1 0003CF  ECC7 000B                            LDB,B6   STR$,AUTO
          1 0003D1  E2C6 001F                            LLH,R6   31,B6
          1 0003D3  6008                                 SOL,R6   8
          1 0003D4  6048                                 SOR,R6   8
          1 0003D5  EAC7 0011                            SRM,R6,'00FF'X    USR_SETATR+3,AUTO
          1 0003D7       00FF

      337     2174    2      CALL KVV$CALUSR (USR_SETATR);

   2174   1 0003D8  DBC7 000E                            LAB,B5   USR_SETATR,AUTO
          1 0003DA  DFC7 0018                            STB,B5   USR_SETATR+10,AUTO
          1 0003DC  BBC7 0018                            LAB,B3   USR_SETATR+10,AUTO
          1 0003DE  CBF0 0100                            LAB,B4   256,IMO
          1 0003E0  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 0003E3       0001                            DC       s:2175,PREL

      338     2175    2   END;

   2175   1 0003E4  ECC7 0016                            LDB,B6   USR_SETATR+8,AUTO
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:51   
          1 0003E6  C3C6 0001                            LNJ,B4   1,B6
      339     2176    1   END;

PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:52   
--  Include file information  --

   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KV_SCODE_C.:E05TOU  is referenced.
   KV$VDP.:E05TOU  is referenced.
   KV_ERD_E.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KVS$SETSTR.
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:53   

 **** Variables and constants ****

  ****  Section 000 RoData KVS$SETSTR

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w STRC(48)    r     1 KVS_VDHSTR                 0-0-0/w STRC(48)    r     1 KVS_VDOSTR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @STR_ID                    6-0-0/w UBIN(16)    r     1 ID
     9-0-0/w PTR         r     1 PRVMVD$                    7-0-0/w PTR         r     1 PTR$
     B-0-0/w PTR         r     1 STR$                      *0-0-0/w UBIN(16)    r     1 STR_ID
     E-0-0/w STRC(64)    r     1 USR_SETATR                 D-0-0/b BIT         r     1 Y@PST

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV$PTR$                    0-0-0/w PTR         r     1 KV$RCVSSN$
     0-0-0/w PTR         r     1 KV$RCVVDO$                 0-0-0/w PTR         r     1 KV_RCVVDO$
     0-0-0/w STRC(64)    r     1 KV_USR_SETATR
     0-0-0/w UBIN(16)    r     1 KV_VDH_PST_NEWLIN_VRT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(728)   r     1 KV$ERD                     0-0-0/w STRC(64)    r     1 KV$LIN
     0-0-0/w STRC(128)   r     1 KV$LINLST                  0-0-0/w STRC(512)   r     1 KV$MRD
     0-0-0/w STRC(512)   r     1 KV$MVD                     0-0-0/w STRC(480)   r     1 KV$PTR
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:54   
     0-0-0/w STRC(496)   r     1 KV$SRD                     0-0-0/w STRC(1024)  r     1 KV$SSN
     0-0-0/w STRC(512)   r     1 KV$STR                     0-0-0/w STRC(512)   r     1 KV$VDI
     0-0-0/w STRC(16)    r     1 KV$VDO                     0-0-0/w STRC(96)    r     1 KV_RCVSSN
     0-0-0/w STRC(544)   r     1 KV_RCVVDO                  0-0-0/w STRC(80)    r     1 Y$ENTSRD


   Procedure KVS$SETSTR requires 1000 words for executable code.
   Procedure KVS$SETSTR requires 26 words of local(AUTO) storage.

    No errors detected in file KVS$STR.:E05TSI    .
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:55   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:56   
          MINI XREF LISTING

ID
      1653**DCL      1919<<ASSIGN   1920>>IF       1920<<ASSIGN   1943>>IF       1964<<ASSIGN   1967<<ASSIGN
      1968>>IF       1968<<ASSIGN   1980>>IF       1983>>IF       1986>>IF
KHD$SCREECH
      1640**DCL-ENT  1991--CALL     1995--CALL
KV$ERD.EXTSRD_CHR
       904**DCL       904--REDEF     905--REDEF    2108>>IF
KV$ERD.RGNSCR
       888**DCL      2130>>IF
KV$LIN.FLDLST$
       931**DCL      2029>>ASSIGN
KV$LIN.VRTLIN
       931**DCL      2028>>ASSIGN
KV$LINLST.ONEFLDLIN$
       956**DCL      2026>>ASSIGN
KV$LINLST.ONEFLDWRDX
       956**DCL      2030>>ASSIGN
KV$MRD.ATRRQRDSPPST
       995**DCL      2025>>IF
KV$MRD.BLANKERASES
       990**DCL      2105>>IF
KV$MRD.CALUSR_PST
       985**DCL      2126>>IF
KV$MRD.DCLATRWHNOTP
       996**DCL      2040>>IF       2076>>IF       2140>>IF
KV$MRD.DVCATR
      1005**DCL      2040>>IF       2076>>IF       2140>>IF
KV$MRD.ERD$
       983**DCL      2108>>IF       2130>>IF
KV$MVD.LINLST$
      1033**DCL      1929>>ASSIGN   2010>>ASSIGN
KV$MVD.ORG
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:57   
      1035**DCL      2019>>IF       2144>>IF
KV$MVD.REDSSNID
      1049**DCL      2144>>IF
KV$MVD.SRD$
      1030**DCL      1928>>ASSIGN   2005>>IF       2005>>IF       2009>>ASSIGN   2015>>IF
KV$MVD.VRTCLM
      1047**DCL      2024>>ASSIGN   2149<<ASSIGN   2157>>IF
KV$PTR.FLD$
      1077**DCL      2031<<ASSIGN   2033<<ASSIGN
KV$PTR.FLDLST$
      1076**DCL      2029<<ASSIGN   2031>>ASSIGN
KV$PTR.FLDWRDX
      1077**DCL      2030<<ASSIGN   2031>>ASSIGN
KV$PTR.INPCNDPND
      1079**DCL      1088--REDEF    1092--REDEF
KV$PTR.INPCNDPND.TRN
      1083**DCL      2155>>IF
KV$PTR.LIN$
      1076**DCL      2026<<ASSIGN   2027>>IF       2028>>ASSIGN   2029>>ASSIGN
KV$PTR.LINLST$
      1075**DCL      1076--REDEF    1929<<ASSIGN   2010<<ASSIGN   2026>>ASSIGN   2030>>ASSIGN
KV$PTR.MRD$
      1074**DCL      1930<<ASSIGN   2011<<ASSIGN   2025>>IF       2040>>IF       2040>>IF       2076>>IF
      2076>>IF       2105>>IF       2108>>IF       2126>>IF       2130>>IF       2140>>IF       2140>>IF
KV$PTR.MVD$
      1074**DCL      1927<<ASSIGN   1928>>ASSIGN   1929>>ASSIGN   2003>>ASSIGN   2008<<ASSIGN   2009>>ASSIGN
      2010>>ASSIGN   2013>>IF       2019>>IF       2024>>ASSIGN   2144>>IF       2144>>IF       2149>>ASSIGN
      2157>>IF
KV$PTR.SRD$
      1075**DCL      1928<<ASSIGN   1930>>ASSIGN   2009<<ASSIGN   2011>>ASSIGN   2015>>IF       2063>>IF
      2063>>IF       2067>>IF       2107>>IF       2130>>ASSIGN   2131>>IF       2131>>IF       2132>>IF
      2138>>CALL     2144>>IF       2144>>IF       2144>>IF       2147>>IF       2148>>ASSIGN   2150>>ASSIGN
      2150>>ASSIGN   2150>>ASSIGN   2151>>ASSIGN   2151>>ASSIGN   2152>>ASSIGN   2157>>IF       2157>>IF
      2164>>ASSIGN
KV$PTR.SSN$
      1073**DCL      1981>>ASSIGN   2027>>IF       2069>>ASSIGN   2080>>ASSIGN   2144>>IF       2155>>IF
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:58   
      2155>>IF
KV$PTR.STR$
      1073**DCL      1914>>ASSIGN   1926<<ASSIGN   1999>>IF       2007<<ASSIGN   2062>>ASSIGN   2155>>IF
KV$PTR.VDI$
      1073**DCL      1970>>IF       1972>>ASSIGN   1974>>ASSIGN   2069>>ASSIGN   2079>>ASSIGN   2080>>ASSIGN
      2083>>ASSIGN   2092>>IF       2093>>ASSIGN   2094>>IF       2095>>ASSIGN   2103>>IF       2104>>IF
      2105>>IF       2124>>IF       2125>>ASSIGN   2144>>IF       2153>>ASSIGN   2157>>IF
KV$PTR.VRTCLM
      1078**DCL      2024<<ASSIGN   2025<<ASSIGN   2025>>ASSIGN
KV$PTR.VRTLIN
      1078**DCL      2028<<ASSIGN
KV$PTR$
      1067**DCL      1073--IMP-PTR  1914>>ASSIGN   1926>>ASSIGN   1927>>ASSIGN   1928>>ASSIGN   1928>>ASSIGN
      1929>>ASSIGN   1929>>ASSIGN   1930>>ASSIGN   1930>>ASSIGN   1970>>IF       1970>>IF       1972>>ASSIGN
      1973>>ASSIGN   1974<<ASSIGN   1974>>ASSIGN   1981>>ASSIGN   1999>>IF       2003>>ASSIGN   2007>>ASSIGN
      2008>>ASSIGN   2009>>ASSIGN   2009>>ASSIGN   2010>>ASSIGN   2010>>ASSIGN   2011>>ASSIGN   2011>>ASSIGN
      2013>>IF       2015>>IF       2019>>IF       2024>>ASSIGN   2024>>ASSIGN   2025>>IF       2025>>ASSIGN
      2025>>ASSIGN   2026>>ASSIGN   2026>>ASSIGN   2027>>IF       2027>>IF       2028>>ASSIGN   2028>>ASSIGN
      2029>>ASSIGN   2029>>ASSIGN   2030>>ASSIGN   2030>>ASSIGN   2031>>ASSIGN   2031>>ASSIGN   2031>>ASSIGN
      2033>>ASSIGN   2040>>IF       2040>>IF       2063>>IF       2067>>IF       2068<<ASSIGN   2069>>ASSIGN
      2069>>ASSIGN   2075<<ASSIGN   2076>>IF       2076>>IF       2079>>ASSIGN   2080>>ASSIGN   2080>>ASSIGN
      2083>>ASSIGN   2083>>ASSIGN   2092>>IF       2092>>IF       2093>>ASSIGN   2094>>IF       2094>>IF
      2095>>ASSIGN   2103>>IF       2104>>IF       2105>>IF       2105>>IF       2107>>IF       2108>>IF
      2124>>IF       2125>>ASSIGN   2126>>IF       2130>>IF       2130>>ASSIGN   2131>>IF       2131>>IF
      2132>>IF       2138>>CALL     2140>>IF       2140>>IF       2144>>IF       2144>>IF       2144>>IF
      2144>>IF       2144>>IF       2144>>IF       2144>>IF       2147>>IF       2148>>ASSIGN   2149>>ASSIGN
      2150>>ASSIGN   2150>>ASSIGN   2150>>ASSIGN   2151>>ASSIGN   2151>>ASSIGN   2152>>ASSIGN   2153>>ASSIGN
      2155>>IF       2155>>IF       2155>>IF       2155>>IF       2157>>IF       2157>>IF       2157>>IF
      2157>>IF       2164>>ASSIGN
KV$RCVSSN$
       823**DCL       820--IMP-PTR  1936>>IF       1936>>ASSIGN   1953>>ASSIGN   1963>>IF       1963>>ASSIGN
      1972>>ASSIGN   2048>>IF       2052>>ASSIGN
KV$RCVVDO$
       160**DCL       669--IMP-PTR  1915>>IF       1921>>IF       1925>>ASSIGN   1931>>ASSIGN   1933>>ASSIGN
      1934>>IF       1942>>ASSIGN   1949>>ASSIGN   1952>>IF       1959>>IF       1960>>ASSIGN   1989>>IF
      2046>>IF       2046>>IF
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:59   
KV$SRD.BTMRHT
      1245**DCL      1250--REDEF
KV$SRD.BTMRHT.LIN
      1247**DCL      2150>>ASSIGN
KV$SRD.CRT
      1321**DCL      1326--REDEF
KV$SRD.CRT.LIN
      1323**DCL      2150<<ASSIGN   2151>>ASSIGN   2157>>IF
KV$SRD.CRTVRTLINPHSLIN
      1293**DCL      2151<<ASSIGN
KV$SRD.DVCLINBIS
      1363**DCL      2150>>ASSIGN
KV$SRD.ENBENTEXTSRDCHR
      1256**DCL      2107>>IF       2131>>IF
KV$SRD.ENTSRDCHR$
      1149**DCL      2131>>IF       2132>>IF       2138>>CALL
KV$SRD.FLDEND
      1285**DCL      1290--REDEF
KV$SRD.HI_NONBLN
      1355**DCL      1360--REDEF
KV$SRD.HI_NONBLN.LIN
      1357**DCL      2157>>IF
KV$SRD.LNG
      1253**DCL      2144>>IF
KV$SRD.MRD$
      1149**DCL      1930>>ASSIGN   2011>>ASSIGN
KV$SRD.ORG
      1177**DCL      1182--REDEF
KV$SRD.SRDEND
      1390**DCL      1395--REDEF
KV$SRD.TOPLFT
      1211**DCL      1216--REDEF
KV$SRD.UNKPST
      1398**DCL      2144>>IF       2147>>IF       2148<<ASSIGN   2164<<ASSIGN
KV$SRD.UNKRGN
      1257**DCL      2130<<ASSIGN
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:60   
KV$SRD.VRTPSTOK
      1254**DCL      2152<<ASSIGN
KV$SRD.WDT
      1253**DCL      2144>>IF
KV$SSN.REDRQSPND
      1444**DCL      2027>>IF       2069>>ASSIGN   2080>>ASSIGN   2155>>IF
KV$SSN.REDRSPCNT
      1432**DCL      1433--REDEF
KV$SSN.REDSTRID
      1478**DCL      2155>>IF
KV$SSN.SNCPTR$
      1427**DCL      2094>>IF       2095>>ASSIGN
KV$SSN.SSNID
      1476**DCL      2144>>IF
KV$SSN.STR$
      1426**DCL      1981>>ASSIGN
KV$STR.GRPRND
      1567**DCL      2040>>IF       2076>>IF       2140>>IF       2173>>ASSIGN
KV$STR.ID
      1563**DCL      1943>>IF       1964>>ASSIGN   1980>>IF       1983>>IF       1986>>IF       2155>>IF
KV$STR.LNK$
      1503**DCL      1987>>ASSIGN
KV$STR.MVD$
      1503**DCL      1927>>ASSIGN   2005>>IF       2008>>ASSIGN
KV$VDI.ASNINPPTR$
      1591**DCL      1970>>IF       1972>>ASSIGN   1974>>ASSIGN   2083<<ASSIGN   2092>>IF       2093>>ASSIGN
KV$VDI.INPUNT
      1631**DCL      2144>>IF
KV$VDI.OTPCNDPND.PST
      1627**DCL      2105>>IF       2125<<ASSIGN
KV$VDI.PHSDSC
      1625**DCL      2103>>IF       2124>>IF
KV$VDI.RE_DSPINP
      1625**DCL      2079<<ASSIGN   2104>>IF
KV$VDI.SSN$
      1590**DCL      2094>>IF       2095>>ASSIGN
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:61   
KV$VDI.UN_KNWPST
      1629**DCL      2153<<ASSIGN   2157>>IF
KV$VDI.USRRQSDAT.RED
      1631**DCL      2069<<ASSIGN   2080<<ASSIGN
KV$VDO.STR
       157**DCL      1919>>ASSIGN
KVI$ENBRED
      1642**DCL-ENT  2160--CALL
KVI$INTINPOPRX
      1643**DCL-ENT  2161--CALL
KVI$RE_DSPINP
      1644**DCL-ENT  2104--CALL
KVO$DVCCTR
      1645**DCL-ENT  2113--CALL     2138--CALL
KVO$PST
      1646**DCL-ENT  2159--CALL
KVS_VDHSTR
       622**DCL      1995<>CALL
KVS_VDOSTR
       561**DCL      1991<>CALL
KVV$CALUSR
      1647**DCL-ENT  2174--CALL
KVV$CALUSR_PST
      1648**DCL-ENT  2106--CALL     2137--CALL
KV_RCVSSN.PRVPTR$
       821**DCL      1972<<ASSIGN   2048>>IF       2052>>ASSIGN
KV_RCVSSN.PRVSTR$
       821**DCL      1936>>IF       1936<<ASSIGN   1953<<ASSIGN   1963>>IF       1963>>ASSIGN
KV_RCVVDO.PRVSTR$
       795**DCL      1921>>IF       1925>>ASSIGN   1931<<ASSIGN   1949<<ASSIGN   1959>>IF       1960>>ASSIGN
      2046>>IF
KV_RCVVDO.VDP_VDO.LGLVD_ORG_BIT
       784**DCL       786--REDEF
KV_RCVVDO.VDP_VDO.PSTSTR
       790**DCL      1933>>ASSIGN   1942<<ASSIGN
KV_RCVVDO.VDP_VDO.RSTSTR
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:62   
       789**DCL      1934>>IF       1952>>IF
KV_RCVVDO.VDP_VDO.SETSTR
       789**DCL      1915>>IF       1989>>IF       2046>>IF
KV_RCVVDO$
       797**DCL       153--IMP-PTR  1919>>ASSIGN
KV_USR_SETATR
      1814**DCL      2172>>ASSIGN
KV_USR_SETATR.PHSPST
      1847**DCL      1852--REDEF
KV_VDH_PST_NEWLIN_VRT
       824**DCL      2159<>CALL
PRVMVD$
      1655**DCL      2003<<ASSIGN   2004>>IF       2005>>IF       2013>>IF       2014>>IF       2015>>IF
PTR$
      1654**DCL      1973<<ASSIGN   2052<<ASSIGN   2062>>ASSIGN   2063>>IF       2068>>ASSIGN   2075>>ASSIGN
      2093<<ASSIGN   2095<<ASSIGN
STR$
      1656**DCL      1914<<ASSIGN   1925<<ASSIGN   1926>>ASSIGN   1927>>ASSIGN   1936>>ASSIGN   1943>>IF
      1949>>ASSIGN   1960<<ASSIGN   1963<<ASSIGN   1964>>ASSIGN   1980>>IF       1980>>IF       1981<<ASSIGN
      1983>>IF       1983>>DOWHILE  1986>>IF       1987<<ASSIGN   1987>>ASSIGN   1989>>IF       1999>>IF
      2005>>IF       2007>>ASSIGN   2008>>ASSIGN   2040>>IF       2062<<ASSIGN   2076>>IF       2140>>IF
      2173>>ASSIGN
STR_ID
      1652**DCL         8--PROC     1915--IF       1967>>ASSIGN   1971--IF       1989--IF       2046--IF
USR_SETATR
      1691**DCL      2172<<ASSIGN   2174<>CALL
USR_SETATR.GRPRND
      1780**DCL      2173<<ASSIGN
USR_SETATR.PHSPST
      1724**DCL      1729--REDEF
Y$CHNSSN
      2057**PROC     1975--CALL     2053--CALL     2096--CALL
Y$ENTSRD
      2123**PROC     2014--CALL     2015--CALL     2070--CALL
Y$ENTSRD.TXTSIZ
      1127**DCL      2132>>IF       2138<>CALL
PL6.E3A0      #001=KVS$SETSTR File=KVS$STR.:E05TSI                               WED 07/30/97 02:15 Page:63   
Y$EXTSRD
      2099**PROC     2006--CALL     2067--CALL
Y$FIXATR
      2171**PROC     2042--CALL     2078--CALL     2142--CALL
Y$FIXRED IN PROCEDURE Y$ENTSRD
      2143**ENTRY    2043--CALL     2081--CALL
Y@PST
      1660**DCL      1913<<ASSIGN   1933<<ASSIGN   1934>>IF       1935>>IF       1961<<ASSIGN   1970>>IF
      2005>>IF       2015>>IF       2036>>IF
