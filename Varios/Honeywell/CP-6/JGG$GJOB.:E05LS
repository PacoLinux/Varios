VERSION E05

PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:1    
        1        1        /*M* JGG$GJOB Start ghost jobs*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=2,DCI=4,THI=2,CSI=2,ECI=2,STI=2,IND=2,ENI=2 */
        8        8        JGG$GJOB: PROC(VJIT$,UNAME,ACCT,CCBUF,VLR_NXTUSR);
        9        9        /*D* NAME:        JGG$GJOB
       10       10             PURPOSE:     To init the JIT page with UNAME,ACCT,CCBUF,USER & SYSID
       11       11             CALL:        CALL JGG$GJOB(VJIT$,UNAME,ACCT,CCBUF,VLR_NXTUSR);
       12       12             INPUT:       VJIT$       - PTR to the JIT page
       13       13                          UNAME      - User name
       14       14                          ACCT       - User account
       15       15                          CCBUF      - String to place into CCBUF
       16       16                          VLR_NXTUSR - Contains SYSID and USER number
       17       17             OUTPUT:      JIT.USER
       18       18                          JIT.SYSID
       19       19                          JIT.ACCN
       20       20                          JIT.FACCN
       21       21                          JIT.UNAME
       22       22                          JIT.CCARS, JIT.CCBUF and JIT.CPFLAGS1|%CP_BUFFULL#
       23       23             DESCRIPTION: JGG$GJOB accepts VJIT$ as a pointer to a JIT page to
       24       24                          initialize and proceeds to initialize with the inputs
       25       25                          shown above. JIT.CCBUF is marked full only if something
       26       26                          is placed in it.
       27       27        */
       28       28        %INCLUDE B$JIT;
       29      318        %INCLUDE JG_DATA_R;
       30      388        %INCLUDE JG_MACRO_C;
       31      404        %INCLUDE UM$CP6V_C;
       32      591    1   DCL VJIT$ PTR;
       33      592    1   DCL 1 UNAME,
       34      593    1         2 CNT UBIN(9) UNAL,
       35      594    1         2 TXT CHAR(UNAME.CNT);
       36      595    1   DCL ACCT CHAR(8);
       37      596    1   DCL 1 CCBUF UNAL,
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:2    
       38      597    1         2 CNT UBIN(9) UNAL,
       39      598    1         2 TXT CHAR(CCBUF.CNT) UNAL;
       40      599        %VLR$NXTUSR_V (FPTN=VLR_NXTUSR,BASED="");
       41      602    1   DCL VCHR1 CHAR(1) BASED UNAL;
       42      603    1   DCL B$JIT$ PTR SYMREF;
       43      604    1           VJIT$->B$JIT.USER=VLR_NXTUSR.USR;
       44      605    1           VJIT$->B$JIT.SYSID=VLR_NXTUSR.SYSID;
       45      606    1           VJIT$->B$JIT.ACCN=ACCT;
       46      607    1           VJIT$->B$JIT.FACCN=ACCT;
       47      608    1           VJIT$->B$JIT.UNAME=UNAME.TXT;
       48      609    1           IF CCBUF.CNT~=0
       49      610    2             THEN DO;
       50      611    2               VJIT$->B$JIT.CCARS=CCBUF.CNT;
       51      612    2               VJIT$->B$JIT.CCBUF=CCBUF.TXT;
       52      613    2               VJIT$->B$JIT.CPFLAGS1=B$JIT.CPFLAGS1|%CP_BUFFULL#;
       53      614    2               END;
       54      615    1           RETURN;
       55      616    1   END JGG$GJOB;
       56      617        %EOD;

PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:3    
--  Include file information  --

   UM$CP6V_C.:E05TOU  is referenced.
   JG_MACRO_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   JG_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure JGG$GJOB.

   Procedure JGG$GJOB requires 54 words for executable code.
   Procedure JGG$GJOB requires 10 words of local(AUTO) storage.

PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:4    

 Object Unit name= JGG$GJOB                                   File name= JGG$GJOB.:E05TOU
 UTS= JUL 29 '97 23:22:58.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  JGG$GJOB
    1   Proc  even  none    54     66  JGG$GJOB

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        5  JGG$GJOB

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:5    


        1        1        /*M* JGG$GJOB Start ghost jobs*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=2,DCI=4,THI=2,CSI=2,ECI=2,STI=2,IND=2,ENI=2 */
        8        8        JGG$GJOB: PROC(VJIT$,UNAME,ACCT,CCBUF,VLR_NXTUSR);

      8  1 000000   000000 700200 xent  JGG$GJOB     TSX0  ! X66_AUTO_5
         1 000001   000012 000005                    ZERO    10,5

        9        9        /*D* NAME:        JGG$GJOB
       10       10             PURPOSE:     To init the JIT page with UNAME,ACCT,CCBUF,USER & SYSID
       11       11             CALL:        CALL JGG$GJOB(VJIT$,UNAME,ACCT,CCBUF,VLR_NXTUSR);
       12       12             INPUT:       VJIT$       - PTR to the JIT page
       13       13                          UNAME      - User name
       14       14                          ACCT       - User account
       15       15                          CCBUF      - String to place into CCBUF
       16       16                          VLR_NXTUSR - Contains SYSID and USER number
       17       17             OUTPUT:      JIT.USER
       18       18                          JIT.SYSID
       19       19                          JIT.ACCN
       20       20                          JIT.FACCN
       21       21                          JIT.UNAME
       22       22                          JIT.CCARS, JIT.CCBUF and JIT.CPFLAGS1|%CP_BUFFULL#
       23       23             DESCRIPTION: JGG$GJOB accepts VJIT$ as a pointer to a JIT page to
       24       24                          initialize and proceeds to initialize with the inputs
       25       25                          shown above. JIT.CCBUF is marked full only if something
       26       26                          is placed in it.
       27       27        */
       28       28        %INCLUDE B$JIT;
       29      318        %INCLUDE JG_DATA_R;
       30      388        %INCLUDE JG_MACRO_C;
       31      404        %INCLUDE UM$CP6V_C;
       32      591    1   DCL VJIT$ PTR;
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:6    
       33      592    1   DCL 1 UNAME,
       34      593    1         2 CNT UBIN(9) UNAL,
       35      594    1         2 TXT CHAR(UNAME.CNT);
       36      595    1   DCL ACCT CHAR(8);
       37      596    1   DCL 1 CCBUF UNAL,
       38      597    1         2 CNT UBIN(9) UNAL,
       39      598    1         2 TXT CHAR(CCBUF.CNT) UNAL;
       40      599        %VLR$NXTUSR_V (FPTN=VLR_NXTUSR,BASED="");
       41      602    1   DCL VCHR1 CHAR(1) BASED UNAL;
       42      603    1   DCL B$JIT$ PTR SYMREF;
       43      604    1           VJIT$->B$JIT.USER=VLR_NXTUSR.USR;

    604  1 000002   200003 470500                    LDP0    @VJIT$,,AUTO
         1 000003   000000 471500                    LDP1    0,,PR0
         1 000004   200007 473500                    LDP3    @VLR_NXTUSR,,AUTO
         1 000005   300003 236100                    LDQ     3,,PR3
         1 000006   000022 736000                    QLS     18
         1 000007   100000 552120                    STBQ    0,'20'O,PR1

       44      605    1           VJIT$->B$JIT.SYSID=VLR_NXTUSR.SYSID;

    605  1 000010   000000 471500                    LDP1    0,,PR0
         1 000011   300002 720100                    LXL0    2,,PR3
         1 000012   100000 440100                    SXL0    0,,PR1

       45      606    1           VJIT$->B$JIT.ACCN=ACCT;

    606  1 000013   000000 471500                    LDP1    0,,PR0
         1 000014   200005 474500                    LDP4    @ACCT,,AUTO
         1 000015   040100 100500                    MLR     fill='040'O
         1 000016   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         1 000017   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

       46      607    1           VJIT$->B$JIT.FACCN=ACCT;

    607  1 000020   000000 471500                    LDP1    0,,PR0
         1 000021   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:7    
         1 000022   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         1 000023   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8

       47      608    1           VJIT$->B$JIT.UNAME=UNAME.TXT;

    608  1 000024   000000 471500                    LDP1    0,,PR0
         1 000025   200004 475500                    LDP5    @UNAME,,AUTO
         1 000026   000100 101500                    MRL     fill='000'O
         1 000027   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         1 000030   200010 000002                    ADSC9   @VLR_NXTUSR+1,,AUTO      cn=0,n=2
         1 000031   200010 220100                    LDX0    @VLR_NXTUSR+1,,AUTO
         1 000032   040100 100540                    MLR     fill='040'O
         1 000033   500000 200010                    ADSC9   0,,PR5                   cn=1,n=*X0
         1 000034   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12

       48      609    1           IF CCBUF.CNT~=0

    609  1 000035   200006 471500                    LDP1    @CCBUF,,AUTO
         1 000036   000100 101500                    MRL     fill='000'O
         1 000037   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000040   200010 000004                    ADSC9   @VLR_NXTUSR+1,,AUTO      cn=0,n=4
         1 000041   200010 236100                    LDQ     @VLR_NXTUSR+1,,AUTO
         1 000042   000000 116003                    CMPQ    0,DU
         1 000043   000065 600000 1                  TZE     s:615

       49      610    2             THEN DO;

       50      611    2               VJIT$->B$JIT.CCARS=CCBUF.CNT;

    611  1 000044   000000 476500                    LDP6    0,,PR0
         1 000045   000100 101500                    MRL     fill='000'O
         1 000046   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000047   600032 000002                    ADSC9   26,,PR6                  cn=0,n=2

       51      612    2               VJIT$->B$JIT.CCBUF=CCBUF.TXT;

    612  1 000050   000000 476500                    LDP6    0,,PR0
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:8    
         1 000051   000100 101500                    MRL     fill='000'O
         1 000052   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000053   200010 000002                    ADSC9   @VLR_NXTUSR+1,,AUTO      cn=0,n=2
         1 000054   200010 220100                    LDX0    @VLR_NXTUSR+1,,AUTO
         1 000055   040100 100540                    MLR     fill='040'O
         1 000056   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         1 000057   600033 000400                    ADSC9   27,,PR6                  cn=0,n=256

       52      613    2               VJIT$->B$JIT.CPFLAGS1=B$JIT.CPFLAGS1|%CP_BUFFULL#;

    613  1 000060   000000 476500                    LDP6    0,,PR0
         1 000061   000000 477400 xsym               LDP7    B$JIT$
         1 000062   700143 236100                    LDQ     99,,PR7
         1 000063   000000 276000 0                  ORQ     0
         1 000064   600143 756100                    STQ     99,,PR6

       53      614    2               END;

       54      615    1           RETURN;

    615  1 000065   000000 702200 xent               TSX2  ! X66_ARET
       55      616    1   END JGG$GJOB;
       56      617        %EOD;

PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:9    
--  Include file information  --

   UM$CP6V_C.:E05TOU  is referenced.
   JG_MACRO_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   JG_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure JGG$GJOB.
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:10   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ACCT                      6-0-0/w PTR         r     1 @CCBUF
     4-0-0/w PTR         r     1 @UNAME                     3-0-0/w PTR         r     1 @VJIT$
     7-0-0/w PTR         r     1 @VLR_NXTUSR               *0-0-0/c CHAR(8)     r     1 ACCT
    *0-0-0/c ASTR(9)     r     1 CCBUF                     *0-0-0/c ASTR(9)     r     1 UNAME
    *0-0-0/w PTR         r     1 VJIT$                     *0-0-0/d STRC(144)   r     1 VLR_NXTUSR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT


   Procedure JGG$GJOB requires 54 words for executable code.
   Procedure JGG$GJOB requires 10 words of local(AUTO) storage.
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:11   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:12   
          MINI XREF LISTING

ACCT
       595**DCL         8--PROC      606>>ASSIGN    607>>ASSIGN
B$JIT.ACCN
        42**DCL       606<<ASSIGN
B$JIT.CCARS
       130**DCL       611<<ASSIGN
B$JIT.CCBUF
       130**DCL       612<<ASSIGN
B$JIT.CPFLAGS1
       131**DCL       613<<ASSIGN    613>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       136**DCL       136--REDEF
B$JIT.ERR.MID
        43**DCL        43--REDEF
B$JIT.FACCN
        42**DCL       607<<ASSIGN
B$JIT.JRESPEAK
       204**DCL       205--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       313**DCL       313--REDEF     314--REDEF
B$JIT.PNR
       217**DCL       217--REDEF
B$JIT.SYSID
        42**DCL       605<<ASSIGN
B$JIT.TSLINE
       311**DCL       312--REDEF
B$JIT.UNAME
        42**DCL       608<<ASSIGN
B$JIT.USER
        42**DCL       604<<ASSIGN
B$JIT$
       603**DCL        37--IMP-PTR   613>>ASSIGN
PL6.E3A0      #001=JGG$GJOB File=JGG$GJOB.:E05TSI                                TUE 07/29/97 23:22 Page:13   
CCBUF
       596**DCL         8--PROC
CCBUF.CNT
       597**DCL       598--IMP-SIZ   609>>IF        611>>ASSIGN    612>>ASSIGN
CCBUF.TXT
       598**DCL       612>>ASSIGN
JG_KRSP.FLAGS
       372**DCL       373--REDEF
JG_KRSP.MSGID
       368**DCL       369--REDEF
JG_KRSP.WSN
       375**DCL       376--REDEF
UNAME
       592**DCL         8--PROC
UNAME.CNT
       593**DCL       594--IMP-SIZ   608>>ASSIGN
UNAME.TXT
       594**DCL       608>>ASSIGN
VJIT$
       591**DCL         8--PROC      604>>ASSIGN    605>>ASSIGN    606>>ASSIGN    607>>ASSIGN    608>>ASSIGN
       611>>ASSIGN    612>>ASSIGN    613>>ASSIGN
VLR_NXTUSR
       600**DCL         8--PROC
VLR_NXTUSR.SYSID
       600**DCL       605>>ASSIGN
VLR_NXTUSR.USR
       600**DCL       604>>ASSIGN

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:14   
       57        1        /*T***********************************************************/
       58        2        /*T*                                                         */
       59        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       60        4        /*T*                                                         */
       61        5        /*T***********************************************************/
       62        6        JGG$TGJOB: PROC(NAME,ACCT,PASS,CCBUF);
       63        7        /*D* NAME:        JGG$TGJOB
       64        8             PURPOSE:     To logon an automatic ghost associated with a TERMINAL logon
       65        9             CALL:        CALL JGG$TGJOB(NAME,ACCT,PASS CCBUF);
       66       10             INPUT:       NAME - Name of user to logon as a ghost
       67       11                          ACCT - Account of new user
       68       12                          PASS - Scrambled password of new user
       69       13                          CCBUF - TEXTC string to place into JIT.CCBUF for the user
       70       14             OUTPUT:      A new ghost user and a logon message -or- an error
       71       15                          message to the operator's console
       72       16             DESCRIPTION: JGG$TGJOB validates the passed logon for the TERMINAL
       73       17                          ghost. It then starts the ghost up if the logon is valid
       74       18                          and if a user slot and memory are available.
       75       19                          JIT.CCBUF is filled in with the
       76       20                          passed CCBUF if CCBUF.C~=0 and a user logon message is
       77       21                          sent to the operator's console. If the user cannot be
       78       22                          started, an appropriate message is sent to the operator's
       79       23                          console.
       80       24        */
       81       25 S      %INCLUDE B$JIT_C;
       82       26        %INCLUDE CP_6;
       83      107        %INCLUDE CP_6_SUBS;
       84      647        %INCLUDE F$DCB;
       85      696        %INCLUDE JC_MACRO_C;
       86      810        %INCLUDE JG_DATA_R;
       87      880        %INCLUDE JG_ERRORS_C;
       88      894        %INCLUDE JG_MACRO_C;
       89      910        %INCLUDE KL_SUPER_C;
       90     3812        %INCLUDE OC_SUBS_C;
       91     4543        %INCLUDE ES_SUBS_E;
       92     4569        %SUB CNSGMODE=5/*CONSOLE GHOST*/;       /* FOR JCM$SETU                       */
       93     4570    1   DCL 1 NAME ALIGNED,
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:15   
       94     4571    1         2 C UBIN BYTE UNAL,
       95     4572    1         2 T CHAR(12) UNAL;
       96     4573    1   DCL ACCT CHAR(8);
       97     4574    1   DCL PASS CHAR(8);
       98     4575    1   DCL 1 CCBUF,
       99     4576    1         2 C UBIN BYTE UNAL,
      100     4577    1         2 T CHAR(CCBUF.C);
      101     4578        %B$JIT0(STCLASS=BASED);
      102     4667        %U$JIT1;
      103     4741        %M$JIT2X;
      104     4744        %F$JIT3;
      105     4749        %S$JIT4;
      106     4755        %A$JIT6X;
      107     4758    1   DCL 1 TEXT$C BASED,
      108     4759    1         2 CNT UBIN(9) UNAL,
      109     4760    1         2 TXT CHAR(TEXT$C.CNT) UNAL;
      110     4761        %VLP_SETSTA(FPTN=VLP$SETSTA,STCLASS=BASED);
      111     4789        %JC_CITE (FPTN=JG$GMSG,TYP=UGJOB,STCLASS="BASED(JC_CSMBF$)");
      112     4839        %KL_DREC (NAME=KL_HLPR,STCLASS=SYMREF,LAST=";");
      113     4952    1   DCL VJIT$ PTR;
      114     4953    1   DCL TPTR$ PTR;
      115     4954    1   DCL 1 TPTR REDEF TPTR$,
      116     4955    1         2 COFFSET UBIN(20) UNAL,
      117     4956    1         2 * UBIN(16) UNAL;
      118     4957    1   DCL VM_UC$ PTR;
      119     4958    1   DCL VROSEG$ PTR;
      120     4959    1   DCL CADDR BIT(18) UNAL;
      121     4960    1   DCL CNT UBIN WORD;
      122     4961    1   DCL LGNERR SBIN;
      123     4962    1   DCL MODE SBIN;
      124     4963    1   DCL PP (0:2) UBIN WORD;
      125     4964    1   DCL CGSTA CHAR(8);
      126     4965    1   DCL 1 CGSTAB REDEF CGSTA,
      127     4966    1         2 DLR CHAR(1),
      128     4967    1         2 SYSID CHAR(7);
      129     4968        %VLR_NXTUSR (FPTN=VLR_NXTUSR,STCLASS=AUTO);
      130     4981        %FPT_NXTUSR (FPTN=FPT_NXTUSR,STCLASS="");
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:16   
      131     4994    1   DCL GACCT CHAR(8) STATIC DALIGNED;
      132     4995    1   DCL 1 GHSTNM STATIC ALIGNED,
      133     4996    1         2 * CHAR(4) INIT('GHST'),
      134     4997    1         2 SYSID UBIN(18) UNAL INIT(0),
      135     4998    1         2 CADDR BIT(18) UNAL INIT('0'B);
      136     4999    1   DCL GHSTNMT REDEF GHSTNM CHAR(8);
      137     5000    1   DCL 1 GNAME STATIC DALIGNED,
      138     5001    1         2 L# UBIN BYTE UNAL,
      139     5002    1         2 NAME# CHAR(12) UNAL;
      140     5003    1   DCL GPASS CHAR(8) STATIC DALIGNED;
      141     5004    1   DCL 1 KL_HLPKEY SYMREF,
      142     5005    1         2 CNT UBIN BYTE UNAL,
      143     5006    1         2 ACCT CHAR(8) UNAL,
      144     5007    1         2 NAME CHAR(12) UNAL;
      145     5008        %JG_RSLTS (NAME=JG_RSLTS,STCLASS=STATIC);
      146     5014        %FPT_READ (FPTN=KL_RDHLPR,STCLASS=SYMREF);
      147     5053        %FPT_WRITE (FPTN=WJG_RSLTS,DCB=M$CSCG,BUF=JG_RSLTS,STCLASS=CONSTANT,STATION=
              5053            JC_RPLYSTA);
      148     5084    1   DCL JC_CSMBF$ PTR CONSTANT INIT(ADDR(JC_CSMBF));
      149     5085    1   DCL 1 CSCG CONSTANT ALIGNED,
      150     5086    1         2 * UBIN(9) UNAL INIT(4),
      151     5087    1         2 * CHAR(4) UNAL INIT('CSCG');
      152     5088    1   DCL JC_CSMBF CHAR(300) SYMREF;
      153     5089    1   DCL 1 GHKIN REDEF JC_CSMBF,
      154     5090    1         2 MSG# UBIN(18) UNAL,
      155     5091    1         2 CADDR BIT(18) UNAL,
      156     5092    1         2 ACCT CHAR(8) UNAL,
      157     5093    1         2 NAME CHAR(12) UNAL,
      158     5094    1         2 PASS CHAR(8) UNAL,
      159     5095    1         2 * CHAR(268) UNAL;
      160     5096    1   DCL 1 R_CCBUF REDEF JC_CSMBF,
      161     5097    1         2 C UBIN BYTE UNAL,
      162     5098    1         2 T CHAR(299) UNAL;
      163     5099    1   DCL KL_HLPFILS UBIN WORD SYMREF;
      164     5100        %VLP_STATION (FPTN=JC_RPLYSTA,STCLASS=SYMREF);
      165     5127        %FPT_WRITE (FPTN=JG_WKYN,STCLASS=SYMREF);
      166     5158    1   DCL M$CSCG DCB;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:17   
      167     5159    1   DCL M$HLPF DCB;
      168     5160    1   DCL ASZ$SCRAMBLE ENTRY(1);
      169     5161    1   DCL JCM$MAKEU ENTRY(1);
      170     5162    1   DCL JCM$SETU ENTRY(5) ALTRET;
      171     5163    1   DCL JGG$GJOB ENTRY(5);
      172     5164    1   DCL KLH$OPFILS ENTRY ALTRET;
      173     5165    1   DCL JGG$SECLOG ENTRY(4);
      174     5166        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:18   
      175     5167    1           JG_KRSP.FCN=OC_WR;
      176     5168    1           JG_KRSP.SSID=2;       /* Special TERMINAL GHOST originator's sysid    */
      177     5169    1           JG_KRSP.WSN = '?';              /* For error reporting only           */
      178     5170    1           CADDR = M_ADMIN;                /* For error reporting and LOGON msg  */
      179     5171    1           GNAME=NAME;
      180     5172    1           GACCT=ACCT;
      181     5173    1           GPASS=PASS;
      182     5174    1           R_CCBUF = CCBUF;
      183     5175    1           CALL LOGON(GACCT,GNAME,GPASS,'0'B,%M_GHOST#,LGNERR) ALTRET(NOTLGN);
      184     5176    1           CALL JGG$SECLOG(GACCT,GNAME,GPASS,%ES_LOG_ALL#);
      185     5177    1           CALL SETU(%M_GHOST#) ALTRET (NOKSETU);
      186     5178    1           CALL JGG$GJOB (VJIT$,GNAME,GACCT,R_CCBUF,VLR_NXTUSR);
      187     5179    1           JG_KRSP.WSN=VJIT$->B$JIT.WOO;   /* For LOGON msg                      */
      188     5180    1           CALL JCM$MAKEU (PP);
      189     5181    1           CALL GSTD;
      190     5182    1           RETURN;
      191     5183        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:19   
      192     5184    1   JGG$UGJOB: ENTRY;
      193     5185        /*D* NAME:        JGG$UGJOB
      194     5186             PURPOSE:     To log on ghosts or TP users requested by M$GJOB.
      195     5187             CALL:        CALL JGG$UGJOB;
      196     5188             INPUT:       The structure JG$GMSG found in JC_CSMBF input buffer.
      197     5189             OUTPUT:      A new ghost or TP user and a user logon message to the
      198     5190                          operator's console if user is started.
      199     5191                          A return message of JG_RSLTS to the originator of th
      200     5192                          JG$GMSG write to SLUG. This will be JGP$PMME, the M$GJOB
      201     5193                          pmme handler.
      202     5194             DESCRIPTION: JGG$UGJOB verifies that the logon specified in JG$GMSG
      203     5195                          is legal (if JG$GMSG.SLEAZE is reset). If JG$GMSG.SLEAZE is
      204     5196                          set, the logon is not to be verified, this is a system
      205     5197                          ghost startup. Also, if JG$GMSG.SLEAZE is set, this
      206     5198                          user will take a shortened path (no :USERS info) through
      207     5199                          LOGON as a result of JIT.CPFLAGS1 & %CP_SLEAZE# being set.
      208     5200                          If the startup is for a TP user, M$UC is set to be a
      209     5201                          station on the TP instance comgroup with station name
      210     5202                          '&xxxxxxx' where xxxxxxx is the new user's sysid.
      211     5203                          If the startup is successful, a user logon message is
      212     5204                          sent to the operator's console.
      213     5205        */
      214     5206    1           JG_KRSP.FCN = OC_WR;
      215     5207    1           JG_KRSP.SSID = JG$GMSG.SSID;
      216     5208    1           JG_RSLTS = '0'B;
      217     5209    1           GNAME = JG$GMSG.UNAME;
      218     5210    1           GACCT=JG$GMSG.ACCT;
      219     5211    1           IF JG$GMSG.TP
      220     5212    2             THEN DO;
      221     5213    2               MODE = %M_TP#;
      222     5214    2               CADDR = M_ADMIN | M_TP;     /* For LOGON msg                      */
      223     5215    2               END;
      224     5216    2             ELSE DO;
      225     5217    2               MODE = %M_GHOST#;
      226     5218    2               CADDR = M_ADMIN;            /* For LOGON msg                      */
      227     5219    2               END;
      228     5220    1           IF ~JG$GMSG.SLEAZE
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:20   
      229     5221                                                /* Must really log user on            */
      230     5222    2             THEN DO; CALL LOGON(GACCT,GNAME,JG$GMSG.PASS,JG$GMSG.NOPASSCK,
      231     5223    2                 MODE,LGNERR) ALTRET(NOLGN);
      232     5224    2               CALL JGG$SECLOG(GACCT,GNAME,JG$GMSG.PASS,%ES_LOG_ALL#);
      233     5225    2               END;
      234     5226    1           CALL SETU(MODE) ALTRET (NUGH);
      235     5227    1           IF ~JG$GMSG.SLEAZE THEN VJIT$->B$JIT.WOO = KL_HLPR.WOO;
      236     5228    1           JG_RSLTS.SYSID=VLR_NXTUSR.SYSID;
      237     5229    1           CALL JGG$GJOB (VJIT$,GNAME,GACCT,JG$GMSG.CCBUF,VLR_NXTUSR);
      238     5230    1           IF JG$GMSG.SLEAZE
      239     5231    1             THEN VJIT$->B$JIT.CPFLAGS1 = VJIT$->B$JIT.CPFLAGS1 | %CP_SLEAZE#;
      240     5232                                                /* Don't go through LOGON             */
      241     5233    1           VJIT$->B$JIT.PRIINC = JG$GMSG.PRIINC;
      242     5234    1           JG_KRSP.WSN=VJIT$->B$JIT.WOO;
      243     5235    1           IF JG$GMSG.TP
      244     5236    2             THEN DO;
      245     5237    2               CGSTAB.DLR = '&';
      246     5238    2               CALL BINCHAR(CGSTAB.SYSID,VLR_NXTUSR.SYSID);
      247     5239    2               TPTR$ = VM_UC$->F$DCB.SETSTA$;
      248     5240    2               PINCRC(VROSEG$,TPTR.COFFSET)->VLP$SETSTA.MYSTATION# = CGSTA;
      249     5241    2               VM_UC$->F$DCB.ACCT=GACCT;
      250     5242    2               VM_UC$->F$DCB.NAME.C=GACCT;
      251     5243    2               CNT=8;
      252     5244    3               DO WHILE (SUBSTR(GACCT,CNT-1,1)=' ');
      253     5245    3                 CNT=CNT-1;
      254     5246    3                 END;
      255     5247    2               VM_UC$->F$DCB.NAME.L=CNT;
      256     5248    2               END;
      257     5249    1           CALL JCM$MAKEU (PP);
      258     5250    1           CALL GSTD;
      259     5251    2           DO WHILE('0'B);
      260     5252    3   NOLGN:    DO CASE(LGNERR);
      261     5253    3               CASE(1,2);
      262     5254    3                 JG_RSLTS.ERR = %E$NGLGN;
      263     5255    3               CASE(3);
      264     5256    3                 JG_RSLTS.ERR = %E$NGAUTH;
      265     5257    3               END;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:21   
      266     5258    2             CALL JGG$SECLOG(GNAME,GACCT,JG$GMSG.PASS,%ES_BAD_PW#);
      267     5259    2             END;
      268     5260    2           DO WHILE('0'B);
      269     5261    2   NUGH:     IF VLR_NXTUSR.ERR=0
      270     5262    2               THEN JG_RSLTS.ERR = %E$NGHMEM;
      271     5263    2               ELSE JG_RSLTS.ERR = %E$NGHUSR;
      272     5264    2             END;
      273     5265    1   WRSLT:  CALL M$WRITE (WJG_RSLTS) ALTRET (RET1);
      274     5266    1   RET1:   RETURN;
      275     5267        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:22   
      276     5268    1   JGG$KGHOST: ENTRY;
      277     5269        /*D* NAME:        JGG$KGHOST
      278     5270             PURPOSE:     To startup a console ghost
      279     5271             CALL:        CALL JGG$KGHOST;
      280     5272             INPUT:       The GHKIN structure found in JC_CSMBF input buffer.
      281     5273             OUTPUT:      A onsole ghost and a user logon message to the operator's
      282     5274                          console -or- an error message to the originating console.
      283     5275             DESCRIPTION: JGG$KGHOST verifies the logon passed in GHKIN and if it is
      284     5276                          a legal logon, proceeds to attempt to log this console
      285     5277                          ghost on. If a user slot exists and the system has enough
      286     5278                          memory available to get the user's initial 3 pages, the
      287     5279                          console ghost is started up and a user logon message is
      288     5280                          sent to the operator's console. The M$UC DCB will be
      289     5281                          set up as a station on the CSCG comgroup with a strange
      290     5282                          station name containing the user's sysid and the owning
      291     5283                          console's CADDR. If there are any problems,
      292     5284                          an error message is sent back to the requesting operator's
      293     5285                          console with a special keyin function code, OC_XOCG,
      294     5286                          which specifies write just like OC_WR but also says to
      295     5287                          keyin that the console ghost did not start successfully.
      296     5288        */
      297     5289    1           JG_KRSP.FCN=OC_XOCG;
      298     5290    1           JG_KRSP.SSID=0;       /* Special console ghost originator's sysid     */
      299     5291    1           CADDR = GHKIN.CADDR;            /* For error reporting                */
      300     5292    1           GACCT = GHKIN.ACCT;
      301     5293    1           GNAME.NAME# = GHKIN.NAME;
      302     5294    1           CALL INDEX(CNT,' ',GNAME.NAME#);
      303     5295    1           GNAME.L# = CNT;
      304     5296    1           CALL ASZ$SCRAMBLE(GHKIN.PASS);
      305     5297    1           CALL LOGON(GACCT,GNAME,GHKIN.PASS,'0'B,%M_INT#,LGNERR) ALTRET(NOKLGN);
      306     5298    1           CALL JGG$SECLOG(GACCT,GNAME,GHKIN.PASS,%ES_LOG_ALL#);
      307     5299    1           CALL SETU(%M_INT#) ALTRET (NOKSETU);
      308     5300                                                /* Console ghosts appear as TS        */
      309     5301    1           CALL JGG$GJOB(VJIT$,GNAME,GACCT,0,VLR_NXTUSR);
      310     5302                                                /* No CCBUF for console ghosts        */
      311     5303    1           VJIT$->B$JIT.WOO=KL_HLPR.WOO;
      312     5304    1           GHSTNM.CADDR=GHKIN.CADDR;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:23   
      313     5305    1           GHSTNM.SYSID=VLR_NXTUSR.SYSID;
      314     5306    1           TPTR$ = VM_UC$->F$DCB.SETSTA$;
      315     5307    1           PINCRC(VROSEG$,TPTR.COFFSET)->VLP$SETSTA.MYSTATION# = GHSTNMT;
      316     5308    1           VM_UC$->F$DCB.NAME=CSCG;
      317     5309    1           VM_UC$->F$DCB.ACCT=':SYS';
      318     5310    1           VM_UC$->F$DCB.RECL=72;
      319     5311    1           VM_UC$->F$DCB.LINES=38;
      320     5312    1           JG_KRSP.WSN=VJIT$->B$JIT.WOO;
      321     5313    1           CALL JCM$MAKEU (PP);
      322     5314    1           CADDR = M_ADMIN;                /* For LOGON msg                      */
      323     5315    1           CALL GSTD;
      324     5316    1           RETURN;
      325     5317        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:24   
      326     5318    2   DUMMY:  DO WHILE('0'B);
      327     5319    2   NOKSETU:  JG_KRSP.MSG# = NGUSR_MSG#;
      328     5320    2             IF VLR_NXTUSR.ERR=2
      329     5321    2               THEN JG_KRSP.SID = 3+VLR_NXTUSR.MODE;
      330     5322    2               ELSE JG_KRSP.SID = VLR_NXTUSR.ERR;
      331     5323    2             END;
      332     5324    2           DO WHILE('0'B);
      333     5325    2   NOKLGN:   GPASS = GHKIN.PASS;
      334     5326    2   NOTLGN:   JG_KRSP.MSG# = NGOK_MSG#;
      335     5327    2             JG_KRSP.SID = LGNERR;
      336     5328    2             CALL JGG$SECLOG(GNAME,GACCT,GPASS,%ES_BAD_PW#);
      337     5329    2             END;
      338     5330    1           JG_KRSP.CADDR = CADDR;
      339     5331    1           CALL M$WRITE (JG_WKYN) ALTRET (RET);
      340     5332    1   RET:    RETURN;
      341     5333        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:25   
      342     5334    1   LOGON:  PROC(ACCT,UNAME,PASS,NOPASSCK,MODE,ERR) ALTRET;
      343     5335        /*I* NAME:        LOGON
      344     5336             PURPOSE:     To verify a user logon.
      345     5337             CALL:        CALL LOGON(ACCT,UNAME,PASS,NOPASSCK,MODE,ERR) ALTRET(LBL);
      346     5338             INPUT:       ACCT - account of user to verify
      347     5339                          UNAME - name of user to verify
      348     5340                          PASS - scrambled password of user to verify
      349     5341                          NOPASSCK - if set, don't check password, its OK.
      350     5342                          MODE - mode under which user is trying to logon
      351     5343             OUTPUT:      ERR - error if ALTRET. May take on the values below:
      352     5344                             1 - Can't get to :HLP or :PRO
      353     5345                             2 - No such user logon
      354     5346                             3 - User not authorized for that mode
      355     5347             DESCRIPTION: LOGON reads the :HLP file for the specified ACCT,UNAME
      356     5348                          record. If the record exists, the password is checked
      357     5349                          (only if NOPASSCK is reset), the record is checked for
      358     5350                          legality as a timesharing user and the mode is checked
      359     5351                          against authorized modes for this user. If any problems
      360     5352                          occur, ERR is set and LOGON ALTRETs. If the logon is
      361     5353                          legal, LOGON RETURNs normally.
      362     5354        */
      363     5355    2   DCL ACCT CHAR(8);
      364     5356    2   DCL 1 UNAME,
      365     5357    2         2 L UBIN BYTE UNAL,
      366     5358    2         2 T CHAR(12);
      367     5359    2   DCL PASS CHAR(8);
      368     5360    2   DCL NOPASSCK BIT(1) UNAL;
      369     5361    2   DCL MODE SBIN;
      370     5362    2   DCL ERR SBIN;
      371     5363    2           IF KL_HLPFILS<2
      372     5364    3             THEN DO;
      373     5365    3               CALL KLH$OPFILS ALTRET (LGN);
      374     5366    3               ERR = 1;                    /* Can't get to files                 */
      375     5367    3               ALTRETURN;
      376     5368    3               END;
      377     5369    2   LGN:
      378     5370    2           KL_HLPKEY.ACCT=ACCT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:26   
      379     5371    2           KL_HLPKEY.NAME=UNAME.T;
      380     5372    2           KL_HLPKEY.CNT = 8+UNAME.L;
      381     5373    2           IF KL_HLPKEY.CNT<=8
      382     5374    3             THEN DO;
      383     5375    3   NOREC:      ERR = 2;                    /* Bad logon                          */
      384     5376    3               ALTRETURN;
      385     5377    3               END;
      386     5378    2           CALL M$READ (KL_RDHLPR) ALTRET(NOREC);
      387     5379    2           IF (KL_HLPR.PASSWORD~=PASS AND NOT NOPASSCK) OR KL_HLPR.ATYP~=%KLAT_TS#
      388     5380    3             THEN DO;
      389     5381    3               ERR = 2;
      390     5382    3               ALTRETURN;
      391     5383    3               END;
      392     5384    2           IF NOT(MODE=%M_GHOST# AND KL_HLPR.FLAGS.GHOSTOK
      393     5385    2             OR MODE=%M_TP# AND KL_HLPR.FLAGS.TPOK
      394     5386    2             OR MODE=%M_INT# AND KL_HLPR.FLAGS.OLOK)
      395     5387    3             THEN DO;
      396     5388    3               ERR = 3;                    /* Not authorized for that mode       */
      397     5389    3               ALTRETURN;
      398     5390    3               END;
      399     5391    2           RETURN;
      400     5392    2   END LOGON;
      401     5393        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:27   
      402     5394    1   GSTD:   PROC;
      403     5395        /*I* NAME:        GSTD
      404     5396             PURPOSE:     To send out a user logon message to the ops console
      405     5397             CALL:        CALL GSTD;
      406     5398             DESCRIPTION: GSTD causes a message to be sent to the operator's
      407     5399                          console informing of a new user on the system.
      408     5400                          The console type is obtained from CADDR.
      409     5401        */
      410     5402    2           JG_KRSP.FCN=OC_WR;
      411     5403    2           JG_KRSP.MSG#=GSTD_MSG#;
      412     5404    2           JG_KRSP.CADDR = CADDR;
      413     5405    2           JG_KRSP.NAME=GNAME.NAME#;
      414     5406    2           JG_KRSP.ACCT=GACCT;
      415     5407    2           JG_KRSP.SID=VLR_NXTUSR.SYSID;
      416     5408    2           CALL M$WRITE (JG_WKYN) ALTRET (RT);
      417     5409    2   RT:     RETURN;
      418     5410    2   END GSTD;
      419     5411        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:28   
      420     5412    1   SETU:   PROC(MODE) ALTRET;
      421     5413        /*I* NAME:        SETU
      422     5414             PURPOSE:     To obtain a user number, sysid, and initial 3 user pages
      423     5415             CALL:        CALL SETU(MODE) ALTRET(LBL);
      424     5416             INPUT:       MODE - The mode at which the user will run. NOTE: console
      425     5417                             ghosts run as %M_INT# users but must call JCM$SETU
      426     5418                             with MODE=CNSGMODE for correct initialization
      427     5419             OUTPUT:      SYSID and USER# in VLR_NXTUSR
      428     5420                          PP - The 3 physical page numbers
      429     5421                          VJIT$ - PTR to the JIT page
      430     5422                          VM_UC$ - PTR to the M$UC DCB
      431     5423                          VROSEG$ - PTR to the read-only page
      432     5424                          VLR_NXTUSR.ERR - Meaningful if this procedure ALTRETs
      433     5425             DESCRIPTION: SETU calls M$NXTUSR with MODE to obtain a SYSID and
      434     5426                          USER# for a new user. If this is successful, SETU calls
      435     5427                          JCM$SETU to obtain the three initial pages for a user
      436     5428                          (JIT, HJIT and ROSEG) and initializes them slightly.
      437     5429                          If JCM$SETU ALTRETs, SETU will call M$NXTUSR to release
      438     5430                          the sysid and user# just obtained and to decrement users
      439     5431                          in this mode.
      440     5432                          If any errors occur, SETU will ALTRETURN and the cause
      441     5433                          may be determined from the value of VLR_NXTUSR.ERR.
      442     5434                                0 - Not able to get initial 3 pages
      443     5435                                1 - No user slots available
      444     5436                                2 - No user slots available for mode VLR_NXTUSR.MODE
      445     5437                                3 - No sysids available
      446     5438        */
      447     5439    2   DCL MODE SBIN;
      448     5440    2           VLR_NXTUSR.MODE=MODE;
      449     5441    2           FPT_NXTUSR.RESULTS_=VECTOR(VLR_NXTUSR);
      450     5442    2           CALL M$NXTUSR (FPT_NXTUSR);
      451     5443    2           IF VLR_NXTUSR.ERR~=0 THEN ALTRETURN;
      452     5444    2           IF MODE=%M_INT#
      453     5445    2             THEN CALL JCM$SETU(CNSGMODE,VJIT$,VM_UC$,VROSEG$,PP) ALTRET(ALT);
      454     5446    2             ELSE CALL JCM$SETU(MODE,VJIT$,VM_UC$,VROSEG$,PP) ALTRET(ALT);
      455     5447    2           RETURN;
      456     5448    2   ALT:    VLR_NXTUSR.MODE = -VLR_NXTUSR.MODE;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:29   
      457     5449    2           CALL M$NXTUSR(FPT_NXTUSR);
      458     5450    2           ALTRETURN;
      459     5451    2   END SETU;
      460     5452    1   END JGG$TGJOB;
      461     5453        %EOD;

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:30   
--  Include file information  --

   ES_SUBS_E.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   JG_MACRO_C.:E05TOU  is referenced.
   JG_ERRORS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   JG_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JGG$TGJOB.

   Procedure JGG$TGJOB requires 559 words for executable code.
   Procedure JGG$TGJOB requires 40 words of local(AUTO) storage.

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:31   

 Object Unit name= JGG$TGJOB                                  File name= JGG$GJOB.:E05TOU
 UTS= JUL 29 '97 23:23:19.52 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    12     14  JGG$TGJOB
    2  RoData even  UTS     16     20  JGG$TGJOB
    3   DCB   even  none     0      0  M$CSCG
    4   DCB   even  none     0      0  M$HLPF
    5   Proc  even  none   559   1057  JGG$TGJOB
    6  RoData even  none    34     42  JGG$TGJOB

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        4  JGG$TGJOB
     5    114                  yes      Std        0  JGG$UGJOB
     5    414                  yes      Std        0  JGG$KGHOST
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:32   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 JGG$SECLOG
         yes           Std       5 JGG$GJOB
         yes           Std       1 JCM$MAKEU
         yes           Std       1 ASZ$SCRAMBLE
 yes     yes           Std       0 KLH$OPFILS
 yes     yes           Std       5 JCM$SETU
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  JG_KRSP                               KL_HLPR
     KL_HLPKEY                             KL_RDHLPR                             JC_CSMBF
     KL_HLPFILS                            JC_RPLYSTA                            JG_WKYN
     M$CSCG                                M$HLPF                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:33   


       57        1        /*T***********************************************************/
       58        2        /*T*                                                         */
       59        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       60        4        /*T*                                                         */
       61        5        /*T***********************************************************/
       62        6        JGG$TGJOB: PROC(NAME,ACCT,PASS,CCBUF);

      6  5 000000   000000 700200 xent  JGG$TGJOB    TSX0  ! X66_AUTO_4
         5 000001   000050 000004                    ZERO    40,4

       63        7        /*D* NAME:        JGG$TGJOB
       64        8             PURPOSE:     To logon an automatic ghost associated with a TERMINAL logon
       65        9             CALL:        CALL JGG$TGJOB(NAME,ACCT,PASS CCBUF);
       66       10             INPUT:       NAME - Name of user to logon as a ghost
       67       11                          ACCT - Account of new user
       68       12                          PASS - Scrambled password of new user
       69       13                          CCBUF - TEXTC string to place into JIT.CCBUF for the user
       70       14             OUTPUT:      A new ghost user and a logon message -or- an error
       71       15                          message to the operator's console
       72       16             DESCRIPTION: JGG$TGJOB validates the passed logon for the TERMINAL
       73       17                          ghost. It then starts the ghost up if the logon is valid
       74       18                          and if a user slot and memory are available.
       75       19                          JIT.CCBUF is filled in with the
       76       20                          passed CCBUF if CCBUF.C~=0 and a user logon message is
       77       21                          sent to the operator's console. If the user cannot be
       78       22                          started, an appropriate message is sent to the operator's
       79       23                          console.
       80       24        */
       81       25 S      %INCLUDE B$JIT_C;
       82       26        %INCLUDE CP_6;
       83      107        %INCLUDE CP_6_SUBS;
       84      647        %INCLUDE F$DCB;
       85      696        %INCLUDE JC_MACRO_C;
       86      810        %INCLUDE JG_DATA_R;
       87      880        %INCLUDE JG_ERRORS_C;
       88      894        %INCLUDE JG_MACRO_C;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:34   
       89      910        %INCLUDE KL_SUPER_C;
       90     3812        %INCLUDE OC_SUBS_C;
       91     4543        %INCLUDE ES_SUBS_E;
       92     4569        %SUB CNSGMODE=5/*CONSOLE GHOST*/;       /* FOR JCM$SETU                       */
       93     4570    1   DCL 1 NAME ALIGNED,
       94     4571    1         2 C UBIN BYTE UNAL,
       95     4572    1         2 T CHAR(12) UNAL;
       96     4573    1   DCL ACCT CHAR(8);
       97     4574    1   DCL PASS CHAR(8);
       98     4575    1   DCL 1 CCBUF,
       99     4576    1         2 C UBIN BYTE UNAL,
      100     4577    1         2 T CHAR(CCBUF.C);
      101     4578        %B$JIT0(STCLASS=BASED);
      102     4667        %U$JIT1;
      103     4741        %M$JIT2X;
      104     4744        %F$JIT3;
      105     4749        %S$JIT4;
      106     4755        %A$JIT6X;
      107     4758    1   DCL 1 TEXT$C BASED,
      108     4759    1         2 CNT UBIN(9) UNAL,
      109     4760    1         2 TXT CHAR(TEXT$C.CNT) UNAL;
      110     4761        %VLP_SETSTA(FPTN=VLP$SETSTA,STCLASS=BASED);
      111     4789        %JC_CITE (FPTN=JG$GMSG,TYP=UGJOB,STCLASS="BASED(JC_CSMBF$)");
      112     4839        %KL_DREC (NAME=KL_HLPR,STCLASS=SYMREF,LAST=";");
      113     4952    1   DCL VJIT$ PTR;
      114     4953    1   DCL TPTR$ PTR;
      115     4954    1   DCL 1 TPTR REDEF TPTR$,
      116     4955    1         2 COFFSET UBIN(20) UNAL,
      117     4956    1         2 * UBIN(16) UNAL;
      118     4957    1   DCL VM_UC$ PTR;
      119     4958    1   DCL VROSEG$ PTR;
      120     4959    1   DCL CADDR BIT(18) UNAL;
      121     4960    1   DCL CNT UBIN WORD;
      122     4961    1   DCL LGNERR SBIN;
      123     4962    1   DCL MODE SBIN;
      124     4963    1   DCL PP (0:2) UBIN WORD;
      125     4964    1   DCL CGSTA CHAR(8);
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:35   
      126     4965    1   DCL 1 CGSTAB REDEF CGSTA,
      127     4966    1         2 DLR CHAR(1),
      128     4967    1         2 SYSID CHAR(7);
      129     4968        %VLR_NXTUSR (FPTN=VLR_NXTUSR,STCLASS=AUTO);
      130     4981        %FPT_NXTUSR (FPTN=FPT_NXTUSR,STCLASS="");
      131     4994    1   DCL GACCT CHAR(8) STATIC DALIGNED;
      132     4995    1   DCL 1 GHSTNM STATIC ALIGNED,
      133     4996    1         2 * CHAR(4) INIT('GHST'),
      134     4997    1         2 SYSID UBIN(18) UNAL INIT(0),
      135     4998    1         2 CADDR BIT(18) UNAL INIT('0'B);
      136     4999    1   DCL GHSTNMT REDEF GHSTNM CHAR(8);
      137     5000    1   DCL 1 GNAME STATIC DALIGNED,
      138     5001    1         2 L# UBIN BYTE UNAL,
      139     5002    1         2 NAME# CHAR(12) UNAL;
      140     5003    1   DCL GPASS CHAR(8) STATIC DALIGNED;
      141     5004    1   DCL 1 KL_HLPKEY SYMREF,
      142     5005    1         2 CNT UBIN BYTE UNAL,
      143     5006    1         2 ACCT CHAR(8) UNAL,
      144     5007    1         2 NAME CHAR(12) UNAL;
      145     5008        %JG_RSLTS (NAME=JG_RSLTS,STCLASS=STATIC);
      146     5014        %FPT_READ (FPTN=KL_RDHLPR,STCLASS=SYMREF);
      147     5053        %FPT_WRITE (FPTN=WJG_RSLTS,DCB=M$CSCG,BUF=JG_RSLTS,STCLASS=CONSTANT,STATION=
              5053            JC_RPLYSTA);
      148     5084    1   DCL JC_CSMBF$ PTR CONSTANT INIT(ADDR(JC_CSMBF));
      149     5085    1   DCL 1 CSCG CONSTANT ALIGNED,
      150     5086    1         2 * UBIN(9) UNAL INIT(4),
      151     5087    1         2 * CHAR(4) UNAL INIT('CSCG');
      152     5088    1   DCL JC_CSMBF CHAR(300) SYMREF;
      153     5089    1   DCL 1 GHKIN REDEF JC_CSMBF,
      154     5090    1         2 MSG# UBIN(18) UNAL,
      155     5091    1         2 CADDR BIT(18) UNAL,
      156     5092    1         2 ACCT CHAR(8) UNAL,
      157     5093    1         2 NAME CHAR(12) UNAL,
      158     5094    1         2 PASS CHAR(8) UNAL,
      159     5095    1         2 * CHAR(268) UNAL;
      160     5096    1   DCL 1 R_CCBUF REDEF JC_CSMBF,
      161     5097    1         2 C UBIN BYTE UNAL,
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:36   
      162     5098    1         2 T CHAR(299) UNAL;
      163     5099    1   DCL KL_HLPFILS UBIN WORD SYMREF;
      164     5100        %VLP_STATION (FPTN=JC_RPLYSTA,STCLASS=SYMREF);
      165     5127        %FPT_WRITE (FPTN=JG_WKYN,STCLASS=SYMREF);
      166     5158    1   DCL M$CSCG DCB;
      167     5159    1   DCL M$HLPF DCB;
      168     5160    1   DCL ASZ$SCRAMBLE ENTRY(1);
      169     5161    1   DCL JCM$MAKEU ENTRY(1);
      170     5162    1   DCL JCM$SETU ENTRY(5) ALTRET;
      171     5163    1   DCL JGG$GJOB ENTRY(5);
      172     5164    1   DCL KLH$OPFILS ENTRY ALTRET;
      173     5165    1   DCL JGG$SECLOG ENTRY(4);
      174     5166        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:37   
      175     5167    1           JG_KRSP.FCN=OC_WR;

   5167  5 000002   000003 236007                    LDQ     3,DL
         5 000003   000001 552004 xsym               STBQ    JG_KRSP+1,'04'O

      176     5168    1           JG_KRSP.SSID=2;       /* Special TERMINAL GHOST originator's sysid    */

   5168  5 000004   000002 220003                    LDX0    2,DU
         5 000005   000013 440000 xsym               SXL0    JG_KRSP+11

      177     5169    1           JG_KRSP.WSN = '?';              /* For error reporting only           */

   5169  5 000006   000000 235000 6                  LDA     0
         5 000007   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000010   000003 755000 xsym               STA     JG_KRSP+3
         5 000011   000004 756000 xsym               STQ     JG_KRSP+4

      178     5170    1           CADDR = M_ADMIN;                /* For error reporting and LOGON msg  */

   5170  5 000012   040000 221003                    LDX1    16384,DU
         5 000013   200013 741100                    STX1    CADDR,,AUTO

      179     5171    1           GNAME=NAME;

   5171  5 000014   200003 470500                    LDP0    @NAME,,AUTO
         5 000015   000000 100500                    MLR     fill='000'O
         5 000016   000000 000015                    ADSC9   0,,PR0                   cn=0,n=13
         5 000017   000004 000015 1                  ADSC9   GNAME                    cn=0,n=13

      180     5172    1           GACCT=ACCT;

   5172  5 000020   200004 471500                    LDP1    @ACCT,,AUTO
         5 000021   040000 100500                    MLR     fill='040'O
         5 000022   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         5 000023   000000 000010 1                  ADSC9   GACCT                    cn=0,n=8

      181     5173    1           GPASS=PASS;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:38   

   5173  5 000024   200005 473500                    LDP3    @PASS,,AUTO
         5 000025   040000 100500                    MLR     fill='040'O
         5 000026   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         5 000027   000010 000010 1                  ADSC9   GPASS                    cn=0,n=8

      182     5174    1           R_CCBUF = CCBUF;

   5174  5 000030   200006 474500                    LDP4    @CCBUF,,AUTO
         5 000031   000100 101500                    MRL     fill='000'O
         5 000032   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         5 000033   200042 000002                    ADSC9   @ERR+2,,AUTO             cn=0,n=2
         5 000034   200042 222100                    LDX2    @ERR+2,,AUTO
         5 000035   000001 623012                    EAX3    1,X2
         5 000036   000000 100540                    MLR     fill='000'O
         5 000037   400000 000013                    ADSC9   0,,PR4                   cn=0,n=*X3
         5 000040   000000 000454 xsym               ADSC9   JC_CSMBF                 cn=0,n=300

      183     5175    1           CALL LOGON(GACCT,GNAME,GPASS,'0'B,%M_GHOST#,LGNERR) ALTRET(NOTLGN);

   5175  5 000041   200015 635500                    EPPR5   LGNERR,,AUTO
         5 000042   200040 455500                    STP5    @MODE+1,,AUTO
         5 000043   000002 237000 6                  LDAQ    2
         5 000044   200036 757100                    STAQ    @PASS+1,,AUTO
         5 000045   000004 237000 6                  LDAQ    4
         5 000046   200034 757100                    STAQ    @MODE+1,,AUTO
         5 000047   000001 236000 6                  LDQ     1
         5 000050   200033 756100                    STQ     FPT_NXTUSR+3,,AUTO
         5 000051   000615 701000 5                  TSX1    LOGON
         5 000052   000576 702000 5                  TSX2    NOTLGN

      184     5176    1           CALL JGG$SECLOG(GACCT,GNAME,GPASS,%ES_LOG_ALL#);

   5176  5 000053   000006 630400 6                  EPPR0   6
         5 000054   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000055   000000 701000 xent               TSX1    JGG$SECLOG
         5 000056   000000 011000                    NOP     0
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:39   

      185     5177    1           CALL SETU(%M_GHOST#) ALTRET (NOKSETU);

   5177  5 000057   000003 236000 6                  LDQ     3
         5 000060   200033 756100                    STQ     FPT_NXTUSR+3,,AUTO
         5 000061   000765 701000 5                  TSX1    SETU
         5 000062   000557 702000 5                  TSX2    DUMMY

      186     5178    1           CALL JGG$GJOB (VJIT$,GNAME,GACCT,R_CCBUF,VLR_NXTUSR);

   5178  5 000063   200024 630500                    EPPR0   VLR_NXTUSR,,AUTO
         5 000064   200046 450500                    STP0    @ERR+6,,AUTO
         5 000065   000012 237000 6                  LDAQ    10
         5 000066   200044 757100                    STAQ    @ERR+4,,AUTO
         5 000067   000004 236000 6                  LDQ     4
         5 000070   200043 756100                    STQ     @ERR+3,,AUTO
         5 000071   200007 631500                    EPPR1   VJIT$,,AUTO
         5 000072   200042 451500                    STP1    @ERR+2,,AUTO
         5 000073   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 000074   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000075   000000 701000 xent               TSX1    JGG$GJOB
         5 000076   000000 011000                    NOP     0

      187     5179    1           JG_KRSP.WSN=VJIT$->B$JIT.WOO;   /* For LOGON msg                      */

   5179  5 000077   200007 470500                    LDP0    VJIT$,,AUTO
         5 000100   000010 237100                    LDAQ    8,,PR0
         5 000101   000003 755000 xsym               STA     JG_KRSP+3
         5 000102   000004 756000 xsym               STQ     JG_KRSP+4

      188     5180    1           CALL JCM$MAKEU (PP);

   5180  5 000103   200017 631500                    EPPR1   PP,,AUTO
         5 000104   200042 451500                    STP1    @ERR+2,,AUTO
         5 000105   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 000106   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000107   000000 701000 xent               TSX1    JCM$MAKEU
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:40   
         5 000110   000000 011000                    NOP     0

      189     5181    1           CALL GSTD;

   5181  5 000111   000740 701000 5                  TSX1    GSTD
         5 000112   000000 011000                    NOP     0

      190     5182    1           RETURN;

   5182  5 000113   000000 702200 xent               TSX2  ! X66_ARET

      191     5183        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:41   
      192     5184    1   JGG$UGJOB: ENTRY;

   5184  5 000114   000000 700200 xent  JGG$UGJOB    TSX0  ! X66_AUTO_4
         5 000115   000050 000004                    ZERO    40,4

      193     5185        /*D* NAME:        JGG$UGJOB
      194     5186             PURPOSE:     To log on ghosts or TP users requested by M$GJOB.
      195     5187             CALL:        CALL JGG$UGJOB;
      196     5188             INPUT:       The structure JG$GMSG found in JC_CSMBF input buffer.
      197     5189             OUTPUT:      A new ghost or TP user and a user logon message to the
      198     5190                          operator's console if user is started.
      199     5191                          A return message of JG_RSLTS to the originator of th
      200     5192                          JG$GMSG write to SLUG. This will be JGP$PMME, the M$GJOB
      201     5193                          pmme handler.
      202     5194             DESCRIPTION: JGG$UGJOB verifies that the logon specified in JG$GMSG
      203     5195                          is legal (if JG$GMSG.SLEAZE is reset). If JG$GMSG.SLEAZE is
      204     5196                          set, the logon is not to be verified, this is a system
      205     5197                          ghost startup. Also, if JG$GMSG.SLEAZE is set, this
      206     5198                          user will take a shortened path (no :USERS info) through
      207     5199                          LOGON as a result of JIT.CPFLAGS1 & %CP_SLEAZE# being set.
      208     5200                          If the startup is for a TP user, M$UC is set to be a
      209     5201                          station on the TP instance comgroup with station name
      210     5202                          '&xxxxxxx' where xxxxxxx is the new user's sysid.
      211     5203                          If the startup is successful, a user logon message is
      212     5204                          sent to the operator's console.
      213     5205        */
      214     5206    1           JG_KRSP.FCN = OC_WR;

   5206  5 000116   000003 236007                    LDQ     3,DL
         5 000117   000001 552004 xsym               STBQ    JG_KRSP+1,'04'O

      215     5207    1           JG_KRSP.SSID = JG$GMSG.SSID;

   5207  5 000120   000014 470400 2                  LDP0    JC_CSMBF$
         5 000121   000001 236100                    LDQ     1,,PR0
         5 000122   000011 772000                    QRL     9
         5 000123   777777 376007                    ANQ     -1,DL
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:42   
         5 000124   000000 620006                    EAX0    0,QL
         5 000125   000013 440000 xsym               SXL0    JG_KRSP+11

      216     5208    1           JG_RSLTS = '0'B;

   5208  5 000126   000000 235003                    LDA     0,DU
         5 000127   000000 236003                    LDQ     0,DU
         5 000130   000012 757000 1                  STAQ    JG_RSLTS

      217     5209    1           GNAME = JG$GMSG.UNAME;

   5209  5 000131   000000 100500                    MLR     fill='000'O
         5 000132   000004 000015                    ADSC9   4,,PR0                   cn=0,n=13
         5 000133   000004 000015 1                  ADSC9   GNAME                    cn=0,n=13

      218     5210    1           GACCT=JG$GMSG.ACCT;

   5210  5 000134   040000 100500                    MLR     fill='040'O
         5 000135   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         5 000136   000000 000010 1                  ADSC9   GACCT                    cn=0,n=8

      219     5211    1           IF JG$GMSG.TP

   5211  5 000137   000001 236100                    LDQ     1,,PR0
         5 000140   000400 316007                    CANQ    256,DL
         5 000141   000147 600000 5                  TZE     s:5217

      220     5212    2             THEN DO;

      221     5213    2               MODE = %M_TP#;

   5213  5 000142   000004 235007                    LDA     4,DL
         5 000143   200016 755100                    STA     MODE,,AUTO

      222     5214    2               CADDR = M_ADMIN | M_TP;     /* For LOGON msg                      */

   5214  5 000144   041000 221003                    LDX1    16896,DU
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:43   
         5 000145   200013 741100                    STX1    CADDR,,AUTO

      223     5215    2               END;

   5215  5 000146   000153 710000 5                  TRA     s:5220

      224     5216    2             ELSE DO;

      225     5217    2               MODE = %M_GHOST#;

   5217  5 000147   000002 235007                    LDA     2,DL
         5 000150   200016 755100                    STA     MODE,,AUTO

      226     5218    2               CADDR = M_ADMIN;            /* For LOGON msg                      */

   5218  5 000151   040000 221003                    LDX1    16384,DU
         5 000152   200013 741100                    STX1    CADDR,,AUTO

      227     5219    2               END;

      228     5220    1           IF ~JG$GMSG.SLEAZE

   5220  5 000153   000001 236100                    LDQ     1,,PR0
         5 000154   000034 736000                    QLS     28
         5 000155   400000 376003                    ANQ     -131072,DU
         5 000156   400000 676003                    ERQ     -131072,DU
         5 000157   000212 600000 5                  TZE     s:5226

      229     5221                                                /* Must really log user on            */
      230     5222    2             THEN DO; CALL LOGON(GACCT,GNAME,JG$GMSG.PASS,JG$GMSG.NOPASSCK,

   5222  5 000160   200015 631500                    EPPR1   LGNERR,,AUTO
         5 000161   200040 451500                    STP1    @MODE+1,,AUTO
         5 000162   200016 633500                    EPPR3   MODE,,AUTO
         5 000163   200037 453500                    STP3    @NOPASSCK+1,,AUTO
         5 000164   000014 236000 2                  LDQ     JC_CSMBF$
         5 000165   000014 036000 6                  ADLQ    12
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:44   
         5 000166   200036 756100                    STQ     @PASS+1,,AUTO
         5 000167   000014 236000 2                  LDQ     JC_CSMBF$
         5 000170   000015 036000 6                  ADLQ    13
         5 000171   000004 235000 6                  LDA     4
         5 000172   200034 757100                    STAQ    @MODE+1,,AUTO
         5 000173   000001 236000 6                  LDQ     1
         5 000174   200033 756100                    STQ     FPT_NXTUSR+3,,AUTO
         5 000175   000615 701000 5                  TSX1    LOGON
         5 000176   000347 702000 5                  TSX2    NOLGN

      231     5223    2                 MODE,LGNERR) ALTRET(NOLGN);
      232     5224    2               CALL JGG$SECLOG(GACCT,GNAME,JG$GMSG.PASS,%ES_LOG_ALL#);

   5224  5 000177   000011 236000 6                  LDQ     9
         5 000200   200045 756100                    STQ     @ERR+5,,AUTO
         5 000201   000014 236000 2                  LDQ     JC_CSMBF$
         5 000202   000015 036000 6                  ADLQ    13
         5 000203   200044 756100                    STQ     @ERR+4,,AUTO
         5 000204   000006 237000 6                  LDAQ    6
         5 000205   200042 757100                    STAQ    @ERR+2,,AUTO
         5 000206   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 000207   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000210   000000 701000 xent               TSX1    JGG$SECLOG
         5 000211   000000 011000                    NOP     0

      233     5225    2               END;

      234     5226    1           CALL SETU(MODE) ALTRET (NUGH);

   5226  5 000212   200016 630500                    EPPR0   MODE,,AUTO
         5 000213   200033 450500                    STP0    FPT_NXTUSR+3,,AUTO
         5 000214   000765 701000 5                  TSX1    SETU
         5 000215   000400 702000 5                  TSX2    NUGH

      235     5227    1           IF ~JG$GMSG.SLEAZE THEN VJIT$->B$JIT.WOO = KL_HLPR.WOO;

   5227  5 000216   000014 470400 2                  LDP0    JC_CSMBF$
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:45   
         5 000217   000001 236100                    LDQ     1,,PR0
         5 000220   000034 736000                    QLS     28
         5 000221   400000 376003                    ANQ     -131072,DU
         5 000222   400000 676003                    ERQ     -131072,DU
         5 000223   000230 600000 5                  TZE     s:5228

   5227  5 000224   200007 471500                    LDP1    VJIT$,,AUTO
         5 000225   040100 100400                    MLR     fill='040'O
         5 000226   000007 000010 xsym               ADSC9   KL_HLPR+7                cn=0,n=8
         5 000227   100010 000010                    ADSC9   8,,PR1                   cn=0,n=8

      236     5228    1           JG_RSLTS.SYSID=VLR_NXTUSR.SYSID;

   5228  5 000230   200026 235100                    LDA     VLR_NXTUSR+2,,AUTO
         5 000231   000012 755000 1                  STA     JG_RSLTS

      237     5229    1           CALL JGG$GJOB (VJIT$,GNAME,GACCT,JG$GMSG.CCBUF,VLR_NXTUSR);

   5229  5 000232   200024 631500                    EPPR1   VLR_NXTUSR,,AUTO
         5 000233   200046 451500                    STP1    @ERR+6,,AUTO
         5 000234   000014 236000 2                  LDQ     JC_CSMBF$
         5 000235   000016 036000 6                  ADLQ    14
         5 000236   000001 235000 6                  LDA     1
         5 000237   200044 757100                    STAQ    @ERR+4,,AUTO
         5 000240   000004 236000 6                  LDQ     4
         5 000241   200043 756100                    STQ     @ERR+3,,AUTO
         5 000242   200007 633500                    EPPR3   VJIT$,,AUTO
         5 000243   200042 453500                    STP3    @ERR+2,,AUTO
         5 000244   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 000245   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000246   000000 701000 xent               TSX1    JGG$GJOB
         5 000247   000000 011000                    NOP     0

      238     5230    1           IF JG$GMSG.SLEAZE

   5230  5 000250   000014 470400 2                  LDP0    JC_CSMBF$
         5 000251   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:46   
         5 000252   000200 316007                    CANQ    128,DL
         5 000253   000260 600000 5                  TZE     s:5233

      239     5231    1             THEN VJIT$->B$JIT.CPFLAGS1 = VJIT$->B$JIT.CPFLAGS1 | %CP_SLEAZE#;

   5231  5 000254   200007 471500                    LDP1    VJIT$,,AUTO
         5 000255   100143 236100                    LDQ     99,,PR1
         5 000256   000003 276000 xsym               ORQ     B_VECTNIL+3
         5 000257   100143 756100                    STQ     99,,PR1

      240     5232                                                /* Don't go through LOGON             */
      241     5233    1           VJIT$->B$JIT.PRIINC = JG$GMSG.PRIINC;

   5233  5 000260   200007 471500                    LDP1    VJIT$,,AUTO
         5 000261   000001 236100                    LDQ     1,,PR0
         5 000262   100302 552140                    STBQ    194,'40'O,PR1

      242     5234    1           JG_KRSP.WSN=VJIT$->B$JIT.WOO;

   5234  5 000263   100010 237100                    LDAQ    8,,PR1
         5 000264   000003 755000 xsym               STA     JG_KRSP+3
         5 000265   000004 756000 xsym               STQ     JG_KRSP+4

      243     5235    1           IF JG$GMSG.TP

   5235  5 000266   000001 236100                    LDQ     1,,PR0
         5 000267   000400 316007                    CANQ    256,DL
         5 000270   000336 600000 5                  TZE     s:5249

      244     5236    2             THEN DO;

      245     5237    2               CGSTAB.DLR = '&';

   5237  5 000271   046000 236003                    LDQ     19456,DU
         5 000272   200022 552140                    STBQ    CGSTA,'40'O,AUTO

      246     5238    2               CALL BINCHAR(CGSTAB.SYSID,VLR_NXTUSR.SYSID);
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:47   

   5238  5 000273   200026 235100                    LDA     VLR_NXTUSR+2,,AUTO
         5 000274   000044 773000                    LRL     36
         5 000275   200042 757100                    STAQ    @ERR+2,,AUTO
         5 000276   000100 301500                    BTD
         5 000277   200042 000010                    NDSC9   @ERR+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         5 000300   200022 230007                    NDSC9   CGSTA,,AUTO              cn=1,s=nosgn,sf=0,n=7

      247     5239    2               TPTR$ = VM_UC$->F$DCB.SETSTA$;

   5239  5 000301   200011 473500                    LDP3    VM_UC$,,AUTO
         5 000302   300006 236100                    LDQ     6,,PR3
         5 000303   200010 756100                    STQ     TPTR$,,AUTO

      248     5240    2               PINCRC(VROSEG$,TPTR.COFFSET)->VLP$SETSTA.MYSTATION# = CGSTA;

   5240  5 000304   200010 236100                    LDQ     TPTR$,,AUTO
         5 000305   000020 772000                    QRL     16
         5 000306   200012 474500                    LDP4    VROSEG$,,AUTO
         5 000307   040106 100500                    MLR     fill='040'O
         5 000310   200022 000010                    ADSC9   CGSTA,,AUTO              cn=0,n=8
         5 000311   400000 000010                    ADSC9   0,Q,PR4                  cn=0,n=8

      249     5241    2               VM_UC$->F$DCB.ACCT=GACCT;

   5241  5 000312   000000 237000 1                  LDAQ    GACCT
         5 000313   200011 471500                    LDP1    VM_UC$,,AUTO
         5 000314   100020 757100                    STAQ    16,,PR1

      250     5242    2               VM_UC$->F$DCB.NAME.C=GACCT;

   5242  5 000315   040100 100400                    MLR     fill='040'O
         5 000316   000000 000010 1                  ADSC9   GACCT                    cn=0,n=8
         5 000317   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31

      251     5243    2               CNT=8;

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:48   
   5243  5 000320   000010 235007                    LDA     8,DL
         5 000321   200014 755100                    STA     CNT,,AUTO

      252     5244    3               DO WHILE (SUBSTR(GACCT,CNT-1,1)=' ');

   5244  5 000322   000326 710000 5                  TRA     s:5246

      253     5245    3                 CNT=CNT-1;

   5245  5 000323   200014 235100                    LDA     CNT,,AUTO
         5 000324   000001 135007                    SBLA    1,DL
         5 000325   200014 755100                    STA     CNT,,AUTO

      254     5246    3                 END;

   5246  5 000326   040000 106405                    CMPC    fill='040'O
         5 000327   777777 600001 1                  ADSC9   JG_RSLTS-11,A            cn=3,n=1
         5 000330   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000331   000323 600000 5                  TZE     s:5245

      255     5247    2               VM_UC$->F$DCB.NAME.L=CNT;

   5247  5 000332   200011 470500                    LDP0    VM_UC$,,AUTO
         5 000333   200014 236100                    LDQ     CNT,,AUTO
         5 000334   000033 736000                    QLS     27
         5 000335   000010 552140                    STBQ    8,'40'O,PR0

      256     5248    2               END;

      257     5249    1           CALL JCM$MAKEU (PP);

   5249  5 000336   200017 630500                    EPPR0   PP,,AUTO
         5 000337   200042 450500                    STP0    @ERR+2,,AUTO
         5 000340   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 000341   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000342   000000 701000 xent               TSX1    JCM$MAKEU
         5 000343   000000 011000                    NOP     0
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:49   

      258     5250    1           CALL GSTD;

   5250  5 000344   000740 701000 5                  TSX1    GSTD
         5 000345   000000 011000                    NOP     0

      259     5251    2           DO WHILE('0'B);

   5251  5 000346   000377 710000 5                  TRA     s:5260

      260     5252    3   NOLGN:    DO CASE(LGNERR);

   5252  5 000347   200015 235100       NOLGN        LDA     LGNERR,,AUTO
         5 000350   000004 115007                    CMPA    4,DL
         5 000351   000353 602005 5                  TNC     NOLGN+4,AL
         5 000352   000364 710000 5                  TRA     s:5258
         5 000353   000364 710000 5                  TRA     s:5258
         5 000354   000357 710000 5                  TRA     s:5254
         5 000355   000357 710000 5                  TRA     s:5254
         5 000356   000362 710000 5                  TRA     s:5256

      261     5253    3               CASE(1,2);

      262     5254    3                 JG_RSLTS.ERR = %E$NGLGN;

   5254  5 000357   002152 236007                    LDQ     1130,DL
         5 000360   000013 756000 1                  STQ     JG_RSLTS+1
         5 000361   000364 710000 5                  TRA     s:5258

      263     5255    3               CASE(3);

      264     5256    3                 JG_RSLTS.ERR = %E$NGAUTH;

   5256  5 000362   002153 236007                    LDQ     1131,DL
         5 000363   000013 756000 1                  STQ     JG_RSLTS+1

      265     5257    3               END;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:50   

      266     5258    2             CALL JGG$SECLOG(GNAME,GACCT,JG$GMSG.PASS,%ES_BAD_PW#);

   5258  5 000364   000003 236000 6                  LDQ     3
         5 000365   200045 756100                    STQ     @ERR+5,,AUTO
         5 000366   000014 236000 2                  LDQ     JC_CSMBF$
         5 000367   000015 036000 6                  ADLQ    13
         5 000370   200044 756100                    STQ     @ERR+4,,AUTO
         5 000371   000020 237000 6                  LDAQ    16
         5 000372   200042 757100                    STAQ    @ERR+2,,AUTO
         5 000373   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 000374   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000375   000000 701000 xent               TSX1    JGG$SECLOG
         5 000376   000000 011000                    NOP     0

      267     5259    2             END;

      268     5260    2           DO WHILE('0'B);

   5260  5 000377   000407 710000 5                  TRA     WRSLT

      269     5261    2   NUGH:     IF VLR_NXTUSR.ERR=0

   5261  5 000400   200025 235100       NUGH         LDA     VLR_NXTUSR+1,,AUTO
         5 000401   000405 601000 5                  TNZ     s:5263

      270     5262    2               THEN JG_RSLTS.ERR = %E$NGHMEM;

   5262  5 000402   002145 236007                    LDQ     1125,DL
         5 000403   000013 756000 1                  STQ     JG_RSLTS+1
         5 000404   000407 710000 5                  TRA     WRSLT

      271     5263    2               ELSE JG_RSLTS.ERR = %E$NGHUSR;

   5263  5 000405   002146 236007                    LDQ     1126,DL
         5 000406   000013 756000 1                  STQ     JG_RSLTS+1

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:51   
      272     5264    2             END;

      273     5265    1   WRSLT:  CALL M$WRITE (WJG_RSLTS) ALTRET (RET1);

   5265  5 000407   000000 630400 2     WRSLT        EPPR0   WJG_RSLTS
         5 000410   440001 713400                    CLIMB   alt,write
         5 000411   401400 401760                    pmme    nvectors=4
         5 000412   000413 702000 5                  TSX2    RET1

      274     5266    1   RET1:   RETURN;

   5266  5 000413   000000 702200 xent  RET1         TSX2  ! X66_ARET

      275     5267        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:52   
      276     5268    1   JGG$KGHOST: ENTRY;

   5268  5 000414   000000 700200 xent  JGG$KGHOST   TSX0  ! X66_AUTO_4
         5 000415   000050 000004                    ZERO    40,4

      277     5269        /*D* NAME:        JGG$KGHOST
      278     5270             PURPOSE:     To startup a console ghost
      279     5271             CALL:        CALL JGG$KGHOST;
      280     5272             INPUT:       The GHKIN structure found in JC_CSMBF input buffer.
      281     5273             OUTPUT:      A onsole ghost and a user logon message to the operator's
      282     5274                          console -or- an error message to the originating console.
      283     5275             DESCRIPTION: JGG$KGHOST verifies the logon passed in GHKIN and if it is
      284     5276                          a legal logon, proceeds to attempt to log this console
      285     5277                          ghost on. If a user slot exists and the system has enough
      286     5278                          memory available to get the user's initial 3 pages, the
      287     5279                          console ghost is started up and a user logon message is
      288     5280                          sent to the operator's console. The M$UC DCB will be
      289     5281                          set up as a station on the CSCG comgroup with a strange
      290     5282                          station name containing the user's sysid and the owning
      291     5283                          console's CADDR. If there are any problems,
      292     5284                          an error message is sent back to the requesting operator's
      293     5285                          console with a special keyin function code, OC_XOCG,
      294     5286                          which specifies write just like OC_WR but also says to
      295     5287                          keyin that the console ghost did not start successfully.
      296     5288        */
      297     5289    1           JG_KRSP.FCN=OC_XOCG;

   5289  5 000416   000006 236007                    LDQ     6,DL
         5 000417   000001 552004 xsym               STBQ    JG_KRSP+1,'04'O

      298     5290    1           JG_KRSP.SSID=0;       /* Special console ghost originator's sysid     */

   5290  5 000420   000000 220003                    LDX0    0,DU
         5 000421   000013 440000 xsym               SXL0    JG_KRSP+11

      299     5291    1           CADDR = GHKIN.CADDR;            /* For error reporting                */

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:53   
   5291  5 000422   000000 721000 xsym               LXL1    JC_CSMBF
         5 000423   200013 741100                    STX1    CADDR,,AUTO

      300     5292    1           GACCT = GHKIN.ACCT;

   5292  5 000424   040000 100400                    MLR     fill='040'O
         5 000425   000001 000010 xsym               ADSC9   JC_CSMBF+1               cn=0,n=8
         5 000426   000000 000010 1                  ADSC9   GACCT                    cn=0,n=8

      301     5293    1           GNAME.NAME# = GHKIN.NAME;

   5293  5 000427   040000 100400                    MLR     fill='040'O
         5 000430   000003 000014 xsym               ADSC9   JC_CSMBF+3               cn=0,n=12
         5 000431   000004 200014 1                  ADSC9   GNAME                    cn=1,n=12

      302     5294    1           CALL INDEX(CNT,' ',GNAME.NAME#);

   5294  5 000432   000000 124400                    SCM     mask='000'O
         5 000433   000004 200014 1                  ADSC9   GNAME                    cn=1,n=12
         5 000434   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000435   200014 000100                    ARG     CNT,,AUTO

      303     5295    1           GNAME.L# = CNT;

   5295  5 000436   200014 236100                    LDQ     CNT,,AUTO
         5 000437   000033 736000                    QLS     27
         5 000440   000004 552040 1                  STBQ    GNAME,'40'O

      304     5296    1           CALL ASZ$SCRAMBLE(GHKIN.PASS);

   5296  5 000441   000017 630400 6                  EPPR0   15
         5 000442   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000443   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         5 000444   000000 011000                    NOP     0

      305     5297    1           CALL LOGON(GACCT,GNAME,GHKIN.PASS,'0'B,%M_INT#,LGNERR) ALTRET(NOKLGN);

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:54   
   5297  5 000445   200015 630500                    EPPR0   LGNERR,,AUTO
         5 000446   200040 450500                    STP0    @MODE+1,,AUTO
         5 000447   000022 237000 6                  LDAQ    18
         5 000450   200036 757100                    STAQ    @PASS+1,,AUTO
         5 000451   000024 237000 6                  LDAQ    20
         5 000452   200034 757100                    STAQ    @MODE+1,,AUTO
         5 000453   000001 236000 6                  LDQ     1
         5 000454   200033 756100                    STQ     FPT_NXTUSR+3,,AUTO
         5 000455   000615 701000 5                  TSX1    LOGON
         5 000456   000573 702000 5                  TSX2    NOKLGN

      306     5298    1           CALL JGG$SECLOG(GACCT,GNAME,GHKIN.PASS,%ES_LOG_ALL#);

   5298  5 000457   000026 630400 6                  EPPR0   22
         5 000460   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000461   000000 701000 xent               TSX1    JGG$SECLOG
         5 000462   000000 011000                    NOP     0

      307     5299    1           CALL SETU(%M_INT#) ALTRET (NOKSETU);

   5299  5 000463   000023 236000 6                  LDQ     19
         5 000464   200033 756100                    STQ     FPT_NXTUSR+3,,AUTO
         5 000465   000765 701000 5                  TSX1    SETU
         5 000466   000557 702000 5                  TSX2    DUMMY

      308     5300                                                /* Console ghosts appear as TS        */
      309     5301    1           CALL JGG$GJOB(VJIT$,GNAME,GACCT,0,VLR_NXTUSR);

   5301  5 000467   200024 630500                    EPPR0   VLR_NXTUSR,,AUTO
         5 000470   200046 450500                    STP0    @ERR+6,,AUTO
         5 000471   000032 237000 6                  LDAQ    26
         5 000472   200044 757100                    STAQ    @ERR+4,,AUTO
         5 000473   000004 236000 6                  LDQ     4
         5 000474   200043 756100                    STQ     @ERR+3,,AUTO
         5 000475   200007 631500                    EPPR1   VJIT$,,AUTO
         5 000476   200042 451500                    STP1    @ERR+2,,AUTO
         5 000477   200042 630500                    EPPR0   @ERR+2,,AUTO
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:55   
         5 000500   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000501   000000 701000 xent               TSX1    JGG$GJOB
         5 000502   000000 011000                    NOP     0

      310     5302                                                /* No CCBUF for console ghosts        */
      311     5303    1           VJIT$->B$JIT.WOO=KL_HLPR.WOO;

   5303  5 000503   200007 470500                    LDP0    VJIT$,,AUTO
         5 000504   040100 100400                    MLR     fill='040'O
         5 000505   000007 000010 xsym               ADSC9   KL_HLPR+7                cn=0,n=8
         5 000506   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8

      312     5304    1           GHSTNM.CADDR=GHKIN.CADDR;

   5304  5 000507   000000 720000 xsym               LXL0    JC_CSMBF
         5 000510   000003 440000 1                  SXL0    GHSTNM+1

      313     5305    1           GHSTNM.SYSID=VLR_NXTUSR.SYSID;

   5305  5 000511   200026 721100                    LXL1    VLR_NXTUSR+2,,AUTO
         5 000512   000003 741000 1                  STX1    GHSTNM+1

      314     5306    1           TPTR$ = VM_UC$->F$DCB.SETSTA$;

   5306  5 000513   200011 471500                    LDP1    VM_UC$,,AUTO
         5 000514   100006 236100                    LDQ     6,,PR1
         5 000515   200010 756100                    STQ     TPTR$,,AUTO

      315     5307    1           PINCRC(VROSEG$,TPTR.COFFSET)->VLP$SETSTA.MYSTATION# = GHSTNMT;

   5307  5 000516   200010 236100                    LDQ     TPTR$,,AUTO
         5 000517   000020 772000                    QRL     16
         5 000520   200012 473500                    LDP3    VROSEG$,,AUTO
         5 000521   040106 100400                    MLR     fill='040'O
         5 000522   000002 000010 1                  ADSC9   GHSTNM                   cn=0,n=8
         5 000523   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=8

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:56   
      316     5308    1           VM_UC$->F$DCB.NAME=CSCG;

   5308  5 000524   200011 470500                    LDP0    VM_UC$,,AUTO
         5 000525   000100 100400                    MLR     fill='000'O
         5 000526   000015 000005 2                  ADSC9   CSCG                     cn=0,n=5
         5 000527   000010 000040                    ADSC9   8,,PR0                   cn=0,n=32

      317     5309    1           VM_UC$->F$DCB.ACCT=':SYS';

   5309  5 000530   000017 235000 2                  LDA     CSCG+2
         5 000531   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000532   200011 470500                    LDP0    VM_UC$,,AUTO
         5 000533   000020 757100                    STAQ    16,,PR0

      318     5310    1           VM_UC$->F$DCB.RECL=72;

   5310  5 000534   000110 222003                    LDX2    72,DU
         5 000535   000033 442100                    SXL2    27,,PR0

      319     5311    1           VM_UC$->F$DCB.LINES=38;

   5311  5 000536   000046 223003                    LDX3    38,DU
         5 000537   000044 743100                    STX3    36,,PR0

      320     5312    1           JG_KRSP.WSN=VJIT$->B$JIT.WOO;

   5312  5 000540   200007 471500                    LDP1    VJIT$,,AUTO
         5 000541   100010 237100                    LDAQ    8,,PR1
         5 000542   000003 755000 xsym               STA     JG_KRSP+3
         5 000543   000004 756000 xsym               STQ     JG_KRSP+4

      321     5313    1           CALL JCM$MAKEU (PP);

   5313  5 000544   200017 633500                    EPPR3   PP,,AUTO
         5 000545   200042 453500                    STP3    @ERR+2,,AUTO
         5 000546   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 000547   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:57   
         5 000550   000000 701000 xent               TSX1    JCM$MAKEU
         5 000551   000000 011000                    NOP     0

      322     5314    1           CADDR = M_ADMIN;                /* For LOGON msg                      */

   5314  5 000552   040000 220003                    LDX0    16384,DU
         5 000553   200013 740100                    STX0    CADDR,,AUTO

      323     5315    1           CALL GSTD;

   5315  5 000554   000740 701000 5                  TSX1    GSTD
         5 000555   000000 011000                    NOP     0

      324     5316    1           RETURN;

   5316  5 000556   000000 702200 xent               TSX2  ! X66_ARET

      325     5317        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:58   
      326     5318    2   DUMMY:  DO WHILE('0'B);

   5318  5 000557                       DUMMY        null
      327     5319    2   NOKSETU:  JG_KRSP.MSG# = NGUSR_MSG#;

   5319  5 000557   000004 220003       NOKSETU      LDX0    4,DU
         5 000560   000000 440000 xsym               SXL0    JG_KRSP

      328     5320    2             IF VLR_NXTUSR.ERR=2

   5320  5 000561   200025 235100                    LDA     VLR_NXTUSR+1,,AUTO
         5 000562   000002 115007                    CMPA    2,DL
         5 000563   000570 601000 5                  TNZ     s:5322

      329     5321    2               THEN JG_KRSP.SID = 3+VLR_NXTUSR.MODE;

   5321  5 000564   200024 721100                    LXL1    VLR_NXTUSR,,AUTO
         5 000565   000003 622011                    EAX2    3,X1
         5 000566   000013 742000 xsym               STX2    JG_KRSP+11
         5 000567   000572 710000 5                  TRA     s:5324

      330     5322    2               ELSE JG_KRSP.SID = VLR_NXTUSR.ERR;

   5322  5 000570   000000 621005                    EAX1    0,AL
         5 000571   000013 741000 xsym               STX1    JG_KRSP+11

      331     5323    2             END;

      332     5324    2           DO WHILE('0'B);

   5324  5 000572   000606 710000 5                  TRA     s:5330

      333     5325    2   NOKLGN:   GPASS = GHKIN.PASS;

   5325  5 000573   040000 100400       NOKLGN       MLR     fill='040'O
         5 000574   000006 000010 xsym               ADSC9   JC_CSMBF+6               cn=0,n=8
         5 000575   000010 000010 1                  ADSC9   GPASS                    cn=0,n=8
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:59   

      334     5326    2   NOTLGN:   JG_KRSP.MSG# = NGOK_MSG#;

   5326  5 000576   000016 220003       NOTLGN       LDX0    14,DU
         5 000577   000000 440000 xsym               SXL0    JG_KRSP

      335     5327    2             JG_KRSP.SID = LGNERR;

   5327  5 000600   200015 721100                    LXL1    LGNERR,,AUTO
         5 000601   000013 741000 xsym               STX1    JG_KRSP+11

      336     5328    2             CALL JGG$SECLOG(GNAME,GACCT,GPASS,%ES_BAD_PW#);

   5328  5 000602   000034 630400 6                  EPPR0   28
         5 000603   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000604   000000 701000 xent               TSX1    JGG$SECLOG
         5 000605   000000 011000                    NOP     0

      337     5329    2             END;

      338     5330    1           JG_KRSP.CADDR = CADDR;

   5330  5 000606   200013 220100                    LDX0    CADDR,,AUTO
         5 000607   000000 740000 xsym               STX0    JG_KRSP

      339     5331    1           CALL M$WRITE (JG_WKYN) ALTRET (RET);

   5331  5 000610   000000 630400 xsym               EPPR0   JG_WKYN
         5 000611   440001 713400                    CLIMB   alt,write
         5 000612   401400 401760                    pmme    nvectors=4
         5 000613   000614 702000 5                  TSX2    RET

      340     5332    1   RET:    RETURN;

   5332  5 000614   000000 702200 xent  RET          TSX2  ! X66_ARET

      341     5333        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:60   
      342     5334    1   LOGON:  PROC(ACCT,UNAME,PASS,NOPASSCK,MODE,ERR) ALTRET;

   5334  5 000615   200032 741300       LOGON        STX1  ! FPT_NXTUSR+2,,AUTO

      343     5335        /*I* NAME:        LOGON
      344     5336             PURPOSE:     To verify a user logon.
      345     5337             CALL:        CALL LOGON(ACCT,UNAME,PASS,NOPASSCK,MODE,ERR) ALTRET(LBL);
      346     5338             INPUT:       ACCT - account of user to verify
      347     5339                          UNAME - name of user to verify
      348     5340                          PASS - scrambled password of user to verify
      349     5341                          NOPASSCK - if set, don't check password, its OK.
      350     5342                          MODE - mode under which user is trying to logon
      351     5343             OUTPUT:      ERR - error if ALTRET. May take on the values below:
      352     5344                             1 - Can't get to :HLP or :PRO
      353     5345                             2 - No such user logon
      354     5346                             3 - User not authorized for that mode
      355     5347             DESCRIPTION: LOGON reads the :HLP file for the specified ACCT,UNAME
      356     5348                          record. If the record exists, the password is checked
      357     5349                          (only if NOPASSCK is reset), the record is checked for
      358     5350                          legality as a timesharing user and the mode is checked
      359     5351                          against authorized modes for this user. If any problems
      360     5352                          occur, ERR is set and LOGON ALTRETs. If the logon is
      361     5353                          legal, LOGON RETURNs normally.
      362     5354        */
      363     5355    2   DCL ACCT CHAR(8);
      364     5356    2   DCL 1 UNAME,
      365     5357    2         2 L UBIN BYTE UNAL,
      366     5358    2         2 T CHAR(12);
      367     5359    2   DCL PASS CHAR(8);
      368     5360    2   DCL NOPASSCK BIT(1) UNAL;
      369     5361    2   DCL MODE SBIN;
      370     5362    2   DCL ERR SBIN;
      371     5363    2           IF KL_HLPFILS<2

   5363  5 000616   000000 235000 xsym               LDA     KL_HLPFILS
         5 000617   000002 115007                    CMPA    2,DL
         5 000620   000631 603000 5                  TRC     LGN
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:61   

      372     5364    3             THEN DO;

      373     5365    3               CALL KLH$OPFILS ALTRET (LGN);

   5365  5 000621   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000622   000000 701000 xent               TSX1    KLH$OPFILS
         5 000623   000631 702000 5                  TSX2    LGN

      374     5366    3               ERR = 1;                    /* Can't get to files                 */

   5366  5 000624   000001 235007                    LDA     1,DL
         5 000625   200040 470500                    LDP0    @ERR,,AUTO
         5 000626   000000 755100                    STA     0,,PR0

      375     5367    3               ALTRETURN;

   5367  5 000627   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 000630   000000 702211                    TSX2  ! 0,X1

      376     5368    3               END;
      377     5369    2   LGN:
      378     5370    2           KL_HLPKEY.ACCT=ACCT;

   5370  5 000631   200033 470500       LGN          LDP0    @ACCT,,AUTO
         5 000632   040000 100500                    MLR     fill='040'O
         5 000633   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000634   000000 200010 xsym               ADSC9   KL_HLPKEY                cn=1,n=8

      379     5371    2           KL_HLPKEY.NAME=UNAME.T;

   5371  5 000635   200034 471500                    LDP1    @UNAME,,AUTO
         5 000636   040000 100500                    MLR     fill='040'O
         5 000637   100000 200014                    ADSC9   0,,PR1                   cn=1,n=12
         5 000640   000002 200014 xsym               ADSC9   KL_HLPKEY+2              cn=1,n=12

      380     5372    2           KL_HLPKEY.CNT = 8+UNAME.L;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:62   

   5372  5 000641   000100 101500                    MRL     fill='000'O
         5 000642   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 000643   200042 000004                    ADSC9   @ERR+2,,AUTO             cn=0,n=4
         5 000644   200042 236100                    LDQ     @ERR+2,,AUTO
         5 000645   000010 036007                    ADLQ    8,DL
         5 000646   000033 736000                    QLS     27
         5 000647   000000 552040 xsym               STBQ    KL_HLPKEY,'40'O

      381     5373    2           IF KL_HLPKEY.CNT<=8

   5373  5 000650   000000 236000 xsym               LDQ     KL_HLPKEY
         5 000651   777000 376003                    ANQ     -512,DU
         5 000652   011000 116003                    CMPQ    4608,DU
         5 000653   000661 603000 5                  TRC     s:5378

      382     5374    3             THEN DO;

      383     5375    3   NOREC:      ERR = 2;                    /* Bad logon                          */

   5375  5 000654   000002 235007       NOREC        LDA     2,DL
         5 000655   200040 470500                    LDP0    @ERR,,AUTO
         5 000656   000000 755100                    STA     0,,PR0

      384     5376    3               ALTRETURN;

   5376  5 000657   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 000660   000000 702211                    TSX2  ! 0,X1

      385     5377    3               END;
      386     5378    2           CALL M$READ (KL_RDHLPR) ALTRET(NOREC);

   5378  5 000661   000000 630400 xsym               EPPR0   KL_RDHLPR
         5 000662   440000 713400                    CLIMB   alt,read
         5 000663   401400 401760                    pmme    nvectors=4
         5 000664   000654 702000 5                  TSX2    NOREC

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:63   
      387     5379    2           IF (KL_HLPR.PASSWORD~=PASS AND NOT NOPASSCK) OR KL_HLPR.ATYP~=%KLAT_TS#

   5379  5 000665   200035 470500                    LDP0    @PASS,,AUTO
         5 000666   040100 106400                    CMPC    fill='040'O
         5 000667   000002 000010 xsym               ADSC9   KL_HLPR+2                cn=0,n=8
         5 000670   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000671   000677 600000 5                  TZE     s:5379+10
         5 000672   200036 471500                    LDP1    @NOPASSCK,,AUTO
         5 000673   000000 066500                    CMPB    filb='0'B
         5 000674   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         5 000675   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000676   000703 600000 5                  TZE     s:5381
         5 000677   000000 236000 xsym               LDQ     KL_HLPR
         5 000700   777000 376003                    ANQ     -512,DU
         5 000701   001000 116003                    CMPQ    512,DU
         5 000702   000710 600000 5                  TZE     s:5384

      388     5380    3             THEN DO;

      389     5381    3               ERR = 2;

   5381  5 000703   000002 235007                    LDA     2,DL
         5 000704   200040 471500                    LDP1    @ERR,,AUTO
         5 000705   100000 755100                    STA     0,,PR1

      390     5382    3               ALTRETURN;

   5382  5 000706   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 000707   000000 702211                    TSX2  ! 0,X1

      391     5383    3               END;
      392     5384    2           IF NOT(MODE=%M_GHOST# AND KL_HLPR.FLAGS.GHOSTOK

   5384  5 000710   200037 471500                    LDP1    @MODE,,AUTO
         5 000711   100000 235100                    LDA     0,,PR1
         5 000712   000002 115007                    CMPA    2,DL
         5 000713   000717 601000 5                  TNZ     s:5384+7
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:64   
         5 000714   000000 236000 xsym               LDQ     KL_HLPR
         5 000715   000200 316003                    CANQ    128,DU
         5 000716   000736 601000 5                  TNZ     s:5391
         5 000717   000004 115007                    CMPA    4,DL
         5 000720   000724 601000 5                  TNZ     s:5384+12
         5 000721   000000 236000 xsym               LDQ     KL_HLPR
         5 000722   000001 316003                    CANQ    1,DU
         5 000723   000736 601000 5                  TNZ     s:5391
         5 000724   000003 115007                    CMPA    3,DL
         5 000725   000731 601000 5                  TNZ     s:5388
         5 000726   000000 236000 xsym               LDQ     KL_HLPR
         5 000727   000100 316003                    CANQ    64,DU
         5 000730   000736 601000 5                  TNZ     s:5391

      393     5385    2             OR MODE=%M_TP# AND KL_HLPR.FLAGS.TPOK
      394     5386    2             OR MODE=%M_INT# AND KL_HLPR.FLAGS.OLOK)
      395     5387    3             THEN DO;

      396     5388    3               ERR = 3;                    /* Not authorized for that mode       */

   5388  5 000731   000003 236007                    LDQ     3,DL
         5 000732   200040 473500                    LDP3    @ERR,,AUTO
         5 000733   300000 756100                    STQ     0,,PR3

      397     5389    3               ALTRETURN;

   5389  5 000734   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 000735   000000 702211                    TSX2  ! 0,X1

      398     5390    3               END;
      399     5391    2           RETURN;

   5391  5 000736   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 000737   000001 702211                    TSX2  ! 1,X1

      400     5392    2   END LOGON;
      401     5393        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:65   
      402     5394    1   GSTD:   PROC;

   5394  5 000740   200032 741300       GSTD         STX1  ! FPT_NXTUSR+2,,AUTO

      403     5395        /*I* NAME:        GSTD
      404     5396             PURPOSE:     To send out a user logon message to the ops console
      405     5397             CALL:        CALL GSTD;
      406     5398             DESCRIPTION: GSTD causes a message to be sent to the operator's
      407     5399                          console informing of a new user on the system.
      408     5400                          The console type is obtained from CADDR.
      409     5401        */
      410     5402    2           JG_KRSP.FCN=OC_WR;

   5402  5 000741   000003 236007                    LDQ     3,DL
         5 000742   000001 552004 xsym               STBQ    JG_KRSP+1,'04'O

      411     5403    2           JG_KRSP.MSG#=GSTD_MSG#;

   5403  5 000743   000002 220003                    LDX0    2,DU
         5 000744   000000 440000 xsym               SXL0    JG_KRSP

      412     5404    2           JG_KRSP.CADDR = CADDR;

   5404  5 000745   200013 222100                    LDX2    CADDR,,AUTO
         5 000746   000000 742000 xsym               STX2    JG_KRSP

      413     5405    2           JG_KRSP.NAME=GNAME.NAME#;

   5405  5 000747   040000 100400                    MLR     fill='040'O
         5 000750   000004 200014 1                  ADSC9   GNAME                    cn=1,n=12
         5 000751   000006 000014 xsym               ADSC9   JG_KRSP+6                cn=0,n=12

      414     5406    2           JG_KRSP.ACCT=GACCT;

   5406  5 000752   000000 237000 1                  LDAQ    GACCT
         5 000753   000011 755000 xsym               STA     JG_KRSP+9
         5 000754   000012 756000 xsym               STQ     JG_KRSP+10
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:66   

      415     5407    2           JG_KRSP.SID=VLR_NXTUSR.SYSID;

   5407  5 000755   200026 723100                    LXL3    VLR_NXTUSR+2,,AUTO
         5 000756   000013 743000 xsym               STX3    JG_KRSP+11

      416     5408    2           CALL M$WRITE (JG_WKYN) ALTRET (RT);

   5408  5 000757   000000 630400 xsym               EPPR0   JG_WKYN
         5 000760   440001 713400                    CLIMB   alt,write
         5 000761   401400 401760                    pmme    nvectors=4
         5 000762   000763 702000 5                  TSX2    RT

      417     5409    2   RT:     RETURN;

   5409  5 000763   200032 221300       RT           LDX1  ! FPT_NXTUSR+2,,AUTO
         5 000764   000001 702211                    TSX2  ! 1,X1

      418     5410    2   END GSTD;
      419     5411        %EJECT;
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:67   
      420     5412    1   SETU:   PROC(MODE) ALTRET;

   5412  5 000765   200032 741300       SETU         STX1  ! FPT_NXTUSR+2,,AUTO

      421     5413        /*I* NAME:        SETU
      422     5414             PURPOSE:     To obtain a user number, sysid, and initial 3 user pages
      423     5415             CALL:        CALL SETU(MODE) ALTRET(LBL);
      424     5416             INPUT:       MODE - The mode at which the user will run. NOTE: console
      425     5417                             ghosts run as %M_INT# users but must call JCM$SETU
      426     5418                             with MODE=CNSGMODE for correct initialization
      427     5419             OUTPUT:      SYSID and USER# in VLR_NXTUSR
      428     5420                          PP - The 3 physical page numbers
      429     5421                          VJIT$ - PTR to the JIT page
      430     5422                          VM_UC$ - PTR to the M$UC DCB
      431     5423                          VROSEG$ - PTR to the read-only page
      432     5424                          VLR_NXTUSR.ERR - Meaningful if this procedure ALTRETs
      433     5425             DESCRIPTION: SETU calls M$NXTUSR with MODE to obtain a SYSID and
      434     5426                          USER# for a new user. If this is successful, SETU calls
      435     5427                          JCM$SETU to obtain the three initial pages for a user
      436     5428                          (JIT, HJIT and ROSEG) and initializes them slightly.
      437     5429                          If JCM$SETU ALTRETs, SETU will call M$NXTUSR to release
      438     5430                          the sysid and user# just obtained and to decrement users
      439     5431                          in this mode.
      440     5432                          If any errors occur, SETU will ALTRETURN and the cause
      441     5433                          may be determined from the value of VLR_NXTUSR.ERR.
      442     5434                                0 - Not able to get initial 3 pages
      443     5435                                1 - No user slots available
      444     5436                                2 - No user slots available for mode VLR_NXTUSR.MODE
      445     5437                                3 - No sysids available
      446     5438        */
      447     5439    2   DCL MODE SBIN;
      448     5440    2           VLR_NXTUSR.MODE=MODE;

   5440  5 000766   200033 470500                    LDP0    @MODE,,AUTO
         5 000767   000000 235100                    LDA     0,,PR0
         5 000770   200024 755100                    STA     VLR_NXTUSR,,AUTO

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:68   
      449     5441    2           FPT_NXTUSR.RESULTS_=VECTOR(VLR_NXTUSR);

   5441  5 000771   000040 235000 6                  LDA     32
         5 000772   200042 452500                    STP2    @ERR+2,,AUTO
         5 000773   200042 236100                    LDQ     @ERR+2,,AUTO
         5 000774   000024 036003                    ADLQ    20,DU
         5 000775   200030 757100                    STAQ    FPT_NXTUSR,,AUTO

      450     5442    2           CALL M$NXTUSR (FPT_NXTUSR);

   5442  5 000776   200030 630500                    EPPR0   FPT_NXTUSR,,AUTO
         5 000777   020005 713400                    CLIMB   8197
         5 001000   400000 401760                    pmme    nvectors=1

      451     5443    2           IF VLR_NXTUSR.ERR~=0 THEN ALTRETURN;

   5443  5 001001   200025 235100                    LDA     VLR_NXTUSR+1,,AUTO
         5 001002   001005 600000 5                  TZE     s:5444

   5443  5 001003   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 001004   000000 702211                    TSX2  ! 0,X1

      452     5444    2           IF MODE=%M_INT#

   5444  5 001005   200033 470500                    LDP0    @MODE,,AUTO
         5 001006   000000 235100                    LDA     0,,PR0
         5 001007   000003 115007                    CMPA    3,DL
         5 001010   001030 601000 5                  TNZ     s:5446

      453     5445    2             THEN CALL JCM$SETU(CNSGMODE,VJIT$,VM_UC$,VROSEG$,PP) ALTRET(ALT);

   5445  5 001011   200017 631500                    EPPR1   PP,,AUTO
         5 001012   200046 451500                    STP1    @ERR+6,,AUTO
         5 001013   200012 633500                    EPPR3   VROSEG$,,AUTO
         5 001014   200045 453500                    STP3    @ERR+5,,AUTO
         5 001015   200011 634500                    EPPR4   VM_UC$,,AUTO
         5 001016   200044 454500                    STP4    @ERR+4,,AUTO
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:69   
         5 001017   200007 635500                    EPPR5   VJIT$,,AUTO
         5 001020   200043 455500                    STP5    @ERR+3,,AUTO
         5 001021   000041 236000 6                  LDQ     33
         5 001022   200042 756100                    STQ     @ERR+2,,AUTO
         5 001023   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 001024   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 001025   000000 701000 xent               TSX1    JCM$SETU
         5 001026   001050 702000 5                  TSX2    ALT
         5 001027   001046 710000 5                  TRA     s:5447

      454     5446    2             ELSE CALL JCM$SETU(MODE,VJIT$,VM_UC$,VROSEG$,PP) ALTRET(ALT);

   5446  5 001030   200017 631500                    EPPR1   PP,,AUTO
         5 001031   200046 451500                    STP1    @ERR+6,,AUTO
         5 001032   200012 633500                    EPPR3   VROSEG$,,AUTO
         5 001033   200045 453500                    STP3    @ERR+5,,AUTO
         5 001034   200011 634500                    EPPR4   VM_UC$,,AUTO
         5 001035   200044 454500                    STP4    @ERR+4,,AUTO
         5 001036   200007 635500                    EPPR5   VJIT$,,AUTO
         5 001037   200043 455500                    STP5    @ERR+3,,AUTO
         5 001040   200033 236100                    LDQ     @MODE,,AUTO
         5 001041   200042 756100                    STQ     @ERR+2,,AUTO
         5 001042   200042 630500                    EPPR0   @ERR+2,,AUTO
         5 001043   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 001044   000000 701000 xent               TSX1    JCM$SETU
         5 001045   001050 702000 5                  TSX2    ALT

      455     5447    2           RETURN;

   5447  5 001046   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 001047   000001 702211                    TSX2  ! 1,X1

      456     5448    2   ALT:    VLR_NXTUSR.MODE = -VLR_NXTUSR.MODE;

   5448  5 001050   200024 335100       ALT          LCA     VLR_NXTUSR,,AUTO
         5 001051   200024 755100                    STA     VLR_NXTUSR,,AUTO

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:70   
      457     5449    2           CALL M$NXTUSR(FPT_NXTUSR);

   5449  5 001052   200030 630500                    EPPR0   FPT_NXTUSR,,AUTO
         5 001053   020005 713400                    CLIMB   8197
         5 001054   400000 401760                    pmme    nvectors=1

      458     5450    2           ALTRETURN;

   5450  5 001055   200032 221300                    LDX1  ! FPT_NXTUSR+2,,AUTO
         5 001056   000000 702211                    TSX2  ! 0,X1
      459     5451    2   END SETU;
      460     5452    1   END JGG$TGJOB;
      461     5453        %EOD;

PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:71   
--  Include file information  --

   ES_SUBS_E.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   JG_MACRO_C.:E05TOU  is referenced.
   JG_ERRORS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   JG_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JGG$TGJOB.
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:72   

 **** Variables and constants ****

  ****  Section 001  Data  JGG$TGJOB

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d CHAR(8)     r     1 GACCT                      2-0-0/w STRC(72)    r     1 GHSTNM
     2-0-0/w CHAR(8)     r     1 GHSTNMT                    4-0-0/d STRC(117)   r     1 GNAME
    10-0-0/d CHAR(8)     r     1 GPASS                     12-0-0/w STRC(72)    r     1 JG_RSLTS

  ****  Section 002 RoData JGG$TGJOB

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w STRC(45)    r     1 CSCG                      14-0-0/w PTR         r     1 JC_CSMBF$
     0-0-0/d STRC(432)   r     1 WJG_RSLTS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ACCT                     33-0-0/w PTR         r     1 @ACCT
     6-0-0/w PTR         r     1 @CCBUF                    40-0-0/w PTR         r     1 @ERR
    37-0-0/w PTR         r     1 @MODE                     33-0-0/w PTR         r     1 @MODE
     3-0-0/w PTR         r     1 @NAME                     36-0-0/w PTR         r     1 @NOPASSCK
     5-0-0/w PTR         r     1 @PASS                     35-0-0/w PTR         r     1 @PASS
    34-0-0/w PTR         r     1 @UNAME                    *0-0-0/c CHAR(8)     r     1 ACCT
    *0-0-0/c CHAR(8)     r     1 ACCT                      13-0-0/b BIT (18)    r     1 CADDR
    *0-0-0/c ASTR(9)     r     1 CCBUF                     22-0-0/c CHAR(8)     r     1 CGSTA
    22-0-0/c STRC(72)    r     1 CGSTAB                    14-0-0/w UBIN        r     1 CNT
    *0-0-0/w SBIN        r     1 ERR                       30-0-0/d STRC(72)    r     1 FPT_NXTUSR
    15-0-0/w SBIN        r     1 LGNERR                    16-0-0/w SBIN        r     1 MODE
    *0-0-0/w SBIN        r     1 MODE                      *0-0-0/w SBIN        r     1 MODE
    *0-0-0/w STRC(117)   r     1 NAME                      *0-0-0/b BIT         r     1 NOPASSCK
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:73   
    *0-0-0/c CHAR(8)     r     1 PASS                      *0-0-0/c CHAR(8)     r     1 PASS
    17-0-0/w UBIN        r     1 PP(0:2)                   10-0-0/w STRC        r     1 TPTR
    10-0-0/w PTR         r     1 TPTR$                     *0-0-0/c STRC(117)   r     1 UNAME
     7-0-0/w PTR         r     1 VJIT$                     24-0-0/d STRC(144)   r     1 VLR_NXTUSR
    11-0-0/w PTR         r     1 VM_UC$                    12-0-0/w PTR         r     1 VROSEG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(2700)  r     1 GHKIN                      0-0-0/c CHAR(300)   r     1 JC_CSMBF
     0-0-0/w STRC(288)   r     1 JC_RPLYSTA                 0-0-0/w STRC(432)   r     1 JG_KRSP
     0-0-0/d STRC(432)   r     1 JG_WKYN                    0-0-0/w UBIN        r     1 KL_HLPFILS
     0-0-0/c STRC(189)   r     1 KL_HLPKEY                  0-0-0/w STRC(576)   r     1 KL_HLPR
     0-0-0/d STRC(504)   r     1 KL_RDHLPR                  0-0-0/c STRC(2700)  r     1 R_CCBUF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8568)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(2646)  r     1 JG$GMSG                    0-0-0N  NULL        r     1 M$CSCG
     0-0-0/c ASTR(9)     r     1 TEXT$C                     0-0-0/w STRC(432)   r     1 VLP$SETSTA


   Procedure JGG$TGJOB requires 559 words for executable code.
   Procedure JGG$TGJOB requires 40 words of local(AUTO) storage.
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:74   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:75   
          MINI XREF LISTING

ACCT
      4573**DCL         6--PROC     5172>>ASSIGN
ACCT IN PROCEDURE LOGON
      5355**DCL      5334--PROC     5370>>ASSIGN
ALT IN PROCEDURE SETU
      5448**LABEL    5445--CALLALT  5446--CALLALT
ASZ$SCRAMBLE
      5160**DCL-ENT  5296--CALL
B$JIT.CPFLAGS1
      4673**DCL      5231<<ASSIGN   5231>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      4678**DCL      4678--REDEF
B$JIT.ERR.MID
      4585**DCL      4585--REDEF
B$JIT.PNR
      4752**DCL      4752--REDEF
B$JIT.PRIINC
      4752**DCL      5233<<ASSIGN
B$JIT.WOO
      4584**DCL      5179>>ASSIGN   5227<<ASSIGN   5234>>ASSIGN   5303<<ASSIGN   5312>>ASSIGN
CADDR
      4959**DCL      5170<<ASSIGN   5214<<ASSIGN   5218<<ASSIGN   5291<<ASSIGN   5314<<ASSIGN   5330>>ASSIGN
      5404>>ASSIGN
CCBUF
      4575**DCL         6--PROC     5174>>ASSIGN
CCBUF.C
      4576**DCL      4577--IMP-SIZ  5174>>ASSIGN
CGSTA
      4964**DCL      4965--REDEF    5240>>ASSIGN
CGSTAB.DLR
      4966**DCL      5237<<ASSIGN
CGSTAB.SYSID
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:76   
      4967**DCL      5238<<CALLBLT
CNT
      4960**DCL      5243<<ASSIGN   5244>>DOWHILE  5245<<ASSIGN   5245>>ASSIGN   5247>>ASSIGN   5294<<CALLBLT
      5295>>ASSIGN
CSCG
      5085**DCL      5308>>ASSIGN
ERR IN PROCEDURE LOGON
      5362**DCL      5334--PROC     5366<<ASSIGN   5375<<ASSIGN   5381<<ASSIGN   5388<<ASSIGN
F$DCB.ACCT
       658**DCL      5241<<ASSIGN   5309<<ASSIGN
F$DCB.ACTPOS
       673**DCL       673--REDEF
F$DCB.ARS
       648**DCL       648--REDEF
F$DCB.ATTR
       666**DCL       667--REDEF
F$DCB.BORROW
       681**DCL       681--REDEF     681--REDEF     681--REDEF
F$DCB.DCBNAME.L
       695**DCL       695--IMP-SIZ
F$DCB.EOMCHAR
       652**DCL       652--REDEF
F$DCB.FLDID
       676**DCL       676--REDEF
F$DCB.FORM$
       670**DCL       670--REDEF
F$DCB.FSECT
       686**DCL       686--REDEF
F$DCB.FSN
       663**DCL       663--REDEF     663--REDEF     664--REDEF
F$DCB.HEADER$
       669**DCL       669--REDEF
F$DCB.IXTNSIZE
       667**DCL       667--REDEF
F$DCB.LASTSTA$
       657**DCL       657--REDEF
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:77   
F$DCB.LINES
       669**DCL      5311<<ASSIGN
F$DCB.LVL
       682**DCL       682--REDEF
F$DCB.NAME
       657**DCL      5308<<ASSIGN
F$DCB.NAME.C
       657**DCL       657--REDEF    5242<<ASSIGN
F$DCB.NAME.L
       657**DCL      5247<<ASSIGN
F$DCB.NOEOF
       678**DCL       678--REDEF
F$DCB.NRECS
       668**DCL       668--REDEF
F$DCB.NRECX
       687**DCL       687--REDEF
F$DCB.OHDR
       679**DCL       679--REDEF
F$DCB.ORG
       662**DCL       662--REDEF
F$DCB.PRECNO
       685**DCL       685--REDEF
F$DCB.RCSZ
       690**DCL       690--REDEF
F$DCB.RECL
       663**DCL      5310<<ASSIGN
F$DCB.RES
       658**DCL       658--REDEF
F$DCB.SETSTA$
       657**DCL      5239>>ASSIGN   5306>>ASSIGN
F$DCB.SETX
       670**DCL       670--REDEF
F$DCB.TAB$
       669**DCL       670--REDEF
F$DCB.TDA
       684**DCL       684--REDEF
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:78   
F$DCB.WSN
       659**DCL       659--REDEF
FPT_NXTUSR
      4992**DCL      5442<>CALL     5449<>CALL
FPT_NXTUSR.RESULTS_
      4992**DCL      5441<<ASSIGN
GACCT
      4994**DCL      5172<<ASSIGN   5175<>CALL     5176<>CALL     5178<>CALL     5210<<ASSIGN   5222<>CALL
      5224<>CALL     5229<>CALL     5241>>ASSIGN   5242>>ASSIGN   5244>>DOWHILE  5258<>CALL     5292<<ASSIGN
      5297<>CALL     5298<>CALL     5301<>CALL     5328<>CALL     5406>>ASSIGN
GHKIN.ACCT
      5092**DCL      5292>>ASSIGN
GHKIN.CADDR
      5091**DCL      5291>>ASSIGN   5304>>ASSIGN
GHKIN.NAME
      5093**DCL      5293>>ASSIGN
GHKIN.PASS
      5094**DCL      5296<>CALL     5297<>CALL     5298<>CALL     5325>>ASSIGN
GHSTNM
      4995**DCL      4999--REDEF
GHSTNM.CADDR
      4998**DCL      5304<<ASSIGN
GHSTNM.SYSID
      4997**DCL      5305<<ASSIGN
GHSTNMT
      4999**DCL      5307>>ASSIGN
GNAME
      5000**DCL      5171<<ASSIGN   5175<>CALL     5176<>CALL     5178<>CALL     5209<<ASSIGN   5222<>CALL
      5224<>CALL     5229<>CALL     5258<>CALL     5297<>CALL     5298<>CALL     5301<>CALL     5328<>CALL
GNAME.L#
      5001**DCL      5295<<ASSIGN
GNAME.NAME#
      5002**DCL      5293<<ASSIGN   5294>>CALLBLT  5405>>ASSIGN
GPASS
      5003**DCL      5173<<ASSIGN   5175<>CALL     5176<>CALL     5325<<ASSIGN   5328<>CALL
GSTD
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:79   
      5394**PROC     5181--CALL     5250--CALL     5315--CALL
JCM$MAKEU
      5161**DCL-ENT  5180--CALL     5249--CALL     5313--CALL
JCM$SETU
      5162**DCL-ENT  5445--CALL     5446--CALL
JC_CSMBF
      5088**DCL      5084--DCLINIT  5089--REDEF    5096--REDEF
JC_CSMBF$
      5084**DCL      4802--IMP-PTR  5207>>ASSIGN   5209>>ASSIGN   5210>>ASSIGN   5211>>IF       5220>>IF
      5222>>CALL     5222>>CALL     5224>>CALL     5227>>IF       5229>>CALL     5230>>IF       5233>>ASSIGN
      5235>>IF       5258>>CALL
JC_RPLYSTA
      5112**DCL      5072--DCLINIT
JC_RPLYSTA.MSGIDXT
      5122**DCL      5125--REDEF
JG$GMSG.ACCT
      4828**DCL      5210>>ASSIGN
JG$GMSG.CCBUF
      4833**DCL      5229<>CALL
JG$GMSG.NOPASSCK
      4825**DCL      5222<>CALL
JG$GMSG.PASS
      4832**DCL      5222<>CALL     5224<>CALL     5258<>CALL
JG$GMSG.PRIINC
      4818**DCL      5233>>ASSIGN
JG$GMSG.SLEAZE
      4823**DCL      5220>>IF       5227>>IF       5230>>IF
JG$GMSG.SSID
      4819**DCL      5207>>ASSIGN
JG$GMSG.TP
      4821**DCL      5211>>IF       5235>>IF
JG$GMSG.UNAME
      4829**DCL      5209>>ASSIGN
JGG$GJOB
      5163**DCL-ENT  5178--CALL     5229--CALL     5301--CALL
JGG$SECLOG
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:80   
      5165**DCL-ENT  5176--CALL     5224--CALL     5258--CALL     5298--CALL     5328--CALL
JG_KRSP.ACCT
       875**DCL      5406<<ASSIGN
JG_KRSP.CADDR
       858**DCL      5330<<ASSIGN   5404<<ASSIGN
JG_KRSP.FCN
       863**DCL      5167<<ASSIGN   5206<<ASSIGN   5289<<ASSIGN   5402<<ASSIGN
JG_KRSP.FLAGS
       864**DCL       865--REDEF
JG_KRSP.MSG#
       859**DCL      5319<<ASSIGN   5326<<ASSIGN   5403<<ASSIGN
JG_KRSP.MSGID
       860**DCL       861--REDEF
JG_KRSP.NAME
       874**DCL      5405<<ASSIGN
JG_KRSP.SID
       876**DCL      5321<<ASSIGN   5322<<ASSIGN   5327<<ASSIGN   5407<<ASSIGN
JG_KRSP.SSID
       877**DCL      5168<<ASSIGN   5207<<ASSIGN   5290<<ASSIGN
JG_KRSP.WSN
       867**DCL       868--REDEF    5169<<ASSIGN   5179<<ASSIGN   5234<<ASSIGN   5312<<ASSIGN
JG_RSLTS
      5009**DCL      5071--DCLINIT  5072--DCLINIT  5208<<ASSIGN
JG_RSLTS.ERR
      5011**DCL      5254<<ASSIGN   5256<<ASSIGN   5262<<ASSIGN   5263<<ASSIGN
JG_RSLTS.SYSID
      5010**DCL      5228<<ASSIGN
JG_WKYN
      5144**DCL      5331<>CALL     5408<>CALL
JG_WKYN.STATION_
      5146**DCL      5146--REDEF
JG_WKYN.V.DVBYTE.VFC#
      5153**DCL      5153--REDEF
KLH$OPFILS
      5164**DCL-ENT  5365--CALL
KL_HLPFILS
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:81   
      5099**DCL      5363>>IF
KL_HLPKEY.ACCT
      5006**DCL      5370<<ASSIGN
KL_HLPKEY.CNT
      5005**DCL      5372<<ASSIGN   5373>>IF
KL_HLPKEY.NAME
      5007**DCL      5371<<ASSIGN
KL_HLPR.ATYP
      4857**DCL      5379>>IF
KL_HLPR.FLAGS.GHOSTOK
      4867**DCL      5384>>IF
KL_HLPR.FLAGS.OLOK
      4870**DCL      5384>>IF
KL_HLPR.FLAGS.TPOK
      4894**DCL      5384>>IF
KL_HLPR.PASSWORD
      4910**DCL      4914--REDEF    5379>>IF
KL_HLPR.RENAME
      4933**DCL      4934--REDEF
KL_HLPR.WOO
      4930**DCL      5227>>ASSIGN   5303>>ASSIGN
KL_RDHLPR
      5031**DCL      5378<>CALL
KL_RDHLPR.STATION_
      5034**DCL      5035--REDEF
KL_RDHLPR.V.DVBYTE.REREAD#
      5046**DCL      5046--REDEF
KL_RDHLPR.V.INDX#
      5044**DCL      5044--REDEF
LGN IN PROCEDURE LOGON
      5370**LABEL    5365--CALLALT
LGNERR
      4961**DCL      5175<>CALL     5222<>CALL     5252>>DOCASE   5297<>CALL     5327>>ASSIGN
LOGON
      5334**PROC     5175--CALL     5222--CALL     5297--CALL
M$NXTUSR
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:82   
       101**DCL-ENT  5442--CALL     5449--CALL
M$READ
        36**DCL-ENT  5378--CALL
M$WRITE
        36**DCL-ENT  5265--CALL     5331--CALL     5408--CALL
MODE
      4962**DCL      5213<<ASSIGN   5217<<ASSIGN   5222<>CALL     5226<>CALL
MODE IN PROCEDURE LOGON
      5361**DCL      5334--PROC     5384>>IF       5384>>IF       5384>>IF
MODE IN PROCEDURE SETU
      5439**DCL      5412--PROC     5440>>ASSIGN   5444>>IF       5446<>CALL
NAME
      4570**DCL         6--PROC     5171>>ASSIGN
NOKLGN
      5325**LABEL    5297--CALLALT
NOKSETU
      5319**LABEL    5177--CALLALT  5299--CALLALT
NOLGN
      5252**LABEL    5222--CALLALT
NOPASSCK IN PROCEDURE LOGON
      5360**DCL      5334--PROC     5379>>IF
NOREC IN PROCEDURE LOGON
      5375**LABEL    5378--CALLALT
NOTLGN
      5326**LABEL    5175--CALLALT
NUGH
      5261**LABEL    5226--CALLALT
PASS
      4574**DCL         6--PROC     5173>>ASSIGN
PASS IN PROCEDURE LOGON
      5359**DCL      5334--PROC     5379>>IF
PP
      4963**DCL      5180<>CALL     5249<>CALL     5313<>CALL     5445<>CALL     5446<>CALL
RET
      5332**LABEL    5331--CALLALT
RET1
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:83   
      5266**LABEL    5265--CALLALT
RT IN PROCEDURE GSTD
      5409**LABEL    5408--CALLALT
R_CCBUF
      5096**DCL      5174<<ASSIGN   5178<>CALL
SETU
      5412**PROC     5177--CALL     5226--CALL     5299--CALL
TEXT$C.CNT
      4759**DCL      4760--IMP-SIZ
TPTR.COFFSET
      4955**DCL      5240>>ASSIGN   5307>>ASSIGN
TPTR$
      4953**DCL      4954--REDEF    5239<<ASSIGN   5306<<ASSIGN
UNAME IN PROCEDURE LOGON
      5356**DCL      5334--PROC
UNAME.L IN PROCEDURE LOGON
      5357**DCL      5372>>ASSIGN
UNAME.T IN PROCEDURE LOGON
      5358**DCL      5371>>ASSIGN
VJIT$
      4952**DCL      5178<>CALL     5179>>ASSIGN   5227>>ASSIGN   5229<>CALL     5231>>ASSIGN   5231>>ASSIGN
      5233>>ASSIGN   5234>>ASSIGN   5301<>CALL     5303>>ASSIGN   5312>>ASSIGN   5445<>CALL     5446<>CALL
VLP$SETSTA.MYSTATION#
      4777**DCL      5240<<ASSIGN   5307<<ASSIGN
VLR_NXTUSR
      4979**DCL      5178<>CALL     5229<>CALL     5301<>CALL     5441--ASSIGN
VLR_NXTUSR.ERR
      4979**DCL      5261>>IF       5320>>IF       5322>>ASSIGN   5443>>IF
VLR_NXTUSR.MODE
      4979**DCL      5321>>ASSIGN   5440<<ASSIGN   5448<<ASSIGN   5448>>ASSIGN
VLR_NXTUSR.SYSID
      4979**DCL      5228>>ASSIGN   5238>>CALLBLT  5305>>ASSIGN   5407>>ASSIGN
VM_UC$
      4957**DCL      5239>>ASSIGN   5241>>ASSIGN   5242>>ASSIGN   5247>>ASSIGN   5306>>ASSIGN   5308>>ASSIGN
      5309>>ASSIGN   5310>>ASSIGN   5311>>ASSIGN   5445<>CALL     5446<>CALL
VROSEG$
PL6.E3A0      #002=JGG$TGJOB File=JGG$GJOB.:E05TSI                               TUE 07/29/97 23:23 Page:84   
      4958**DCL      5240>>ASSIGN   5307>>ASSIGN   5445<>CALL     5446<>CALL
WJG_RSLTS
      5070**DCL      5265<>CALL
WJG_RSLTS.STATION_
      5072**DCL      5072--REDEF
WJG_RSLTS.V
      5073**DCL      5070--DCLINIT
WJG_RSLTS.V.DVBYTE.VFC#
      5079**DCL      5079--REDEF

PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:85   
      462        1        /*T***********************************************************/
      463        2        /*T*                                                         */
      464        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      465        4        /*T*                                                         */
      466        5        /*T***********************************************************/
      467        6        %EJECT;
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:86   
      468        7        JGG$SECLOG: PROC(NAME,ACCT,PASS,REASON);
      469        8    1   DCL 1 NAME,
      470        9    1         2 C UBIN BYTE UNAL,
      471       10    1         2 T CHAR(12) UNAL;
      472       11    1   DCL ACCT CHAR(8);
      473       12    1   DCL PASS CHAR(8);
      474       13    1   DCL REASON UBIN;
      475       14        %INCLUDE B$JIT;
      476      304        %INCLUDE EL_SUBS_C;
      477      388        %INCLUDE ES_TABLES_M;
      478      782        %INCLUDE ES_SUBS_E;
      479      808        %ES$SECLOG(NAME=ES$SECLOG,STCLASS=STATIC);
      480     1085    1   DCL B$JIT$ PTR SYMREF;
      481     1086        %INCLUDE PC_SUBS_C;
      482     1418    1   DCL ES_LOGSYSACC UBIN WORD SYMREF;
      483     1419    1   DCL ES$ PTR;
      484     1420    1   DCL LOGSYSACCT UBIN BASED;
      485     1421        %INCLUDE CP_6;
      486     1502        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
      487     1503                  ENTRY=ES$SECLOG,
      488     1504                  FILENUM=EL_SEC,
      489     1505                  SIZE="SIZEW(ES$SECLOG)",
      490     1506                  TYPE=EL_SYS_ACCESS);
      491     1521        %INCLUDE AS_SUBS_C;
      492     2935        %INCLUDE B_SEGIDS_C;
      493     3474    1   DCL JMU$SETSEG ENTRY(2);
      494     3475
      495     3476    1           ES$ = ADDR(ES_LOGSYSACC);
      496     3477    1           CALL JMU$SETSEG(ES$,%SPCL1SID);
      497     3478    1           IF REASON > ES$->LOGSYSACCT THEN RETURN;
      498     3479    1           ES$SECLOG.REASON=REASON;
      499     3480    1           ES$SECLOG.GRANTED='0'B;
      500     3481    1           ES$SECLOG.MODE=%M_GHOST#;
      501     3482    1           ES$SECLOG.ACCN = ' ';
      502     3483    1           ES$SECLOG.UNAME = ' ';
      503     3484    1           ES$SECLOG.PASSWORD = ' ';
      504     3485    1           ES$SECLOG.PRIV='0'B;
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:87   
      505     3486    1           ES$SECLOG.PPRIV='0'B;
      506     3487    1           ES$SECLOG.LOGON.L = 0;
      507     3488    1           ES$SECLOG.LOGON.C = ' ';
      508     3489    2           DO CASE(REASON);
      509     3490
      510     3491    2             CASE(%ES_LOG_ALL#);
      511     3492    2               ES$SECLOG.GRANTED='1'B;
      512     3493    2               ES$SECLOG.ACCN=ACCT;
      513     3494    2               IF NAME.C ~= 0 THEN
      514     3495    2                   ES$SECLOG.UNAME=NAME.T;
      515     3496
      516     3497    2             CASE(%ES_JUNK_LOGON#,%ES_NO_SUCH_USER#,%ES_BAD_PW#);
      517     3498    2               ES$SECLOG.ACCN=ACCT;
      518     3499    2               IF NAME.C ~= 0 THEN
      519     3500    2                   ES$SECLOG.UNAME = NAME.T;
      520     3501
      521     3502    2               ES$SECLOG.PASSWORD = PASS;
      522     3503    2               ES$SECLOG.MODE=%M_GHOST#;
      523     3504    2             CASE(ELSE);
      524     3505                                                /* Should never happen                */
      525     3506    2               RETURN;
      526     3507    2             END;                          /* End Do Case(Reason)                */
      527     3508    2           CALL M$WRSYSLOG(WR_SECLOG) WHENALTRETURN DO;
      528     3509                                                /*JCG LIVES*/
      529     3510    2               END;
      530     3511    1           RETURN;
      531     3512    1   END JGG$SECLOG;

PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:88   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JGG$SECLOG.

   Procedure JGG$SECLOG requires 100 words for executable code.
   Procedure JGG$SECLOG requires 10 words of local(AUTO) storage.

    No errors detected in file JGG$GJOB.:E05TSI    .

PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:89   

 Object Unit name= JGG$SECLOG                                 File name= JGG$GJOB.:E05TOU
 UTS= JUL 29 '97 23:24:50.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    58     72  JGG$SECLOG
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   100    144  JGG$SECLOG
    3  RoData even  none     5      5  JGG$SECLOG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        4  JGG$SECLOG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 JMU$SETSEG
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                ES_LOGSYSACC                          M$UC
     B_VECTNIL
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:90   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:91   


      462        1        /*T***********************************************************/
      463        2        /*T*                                                         */
      464        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      465        4        /*T*                                                         */
      466        5        /*T***********************************************************/
      467        6        %EJECT;
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:92   
      468        7        JGG$SECLOG: PROC(NAME,ACCT,PASS,REASON);

      7  2 000000   000000 700200 xent  JGG$SECLOG   TSX0  ! X66_AUTO_4
         2 000001   000012 000004                    ZERO    10,4

      469        8    1   DCL 1 NAME,
      470        9    1         2 C UBIN BYTE UNAL,
      471       10    1         2 T CHAR(12) UNAL;
      472       11    1   DCL ACCT CHAR(8);
      473       12    1   DCL PASS CHAR(8);
      474       13    1   DCL REASON UBIN;
      475       14        %INCLUDE B$JIT;
      476      304        %INCLUDE EL_SUBS_C;
      477      388        %INCLUDE ES_TABLES_M;
      478      782        %INCLUDE ES_SUBS_E;
      479      808        %ES$SECLOG(NAME=ES$SECLOG,STCLASS=STATIC);
      480     1085    1   DCL B$JIT$ PTR SYMREF;
      481     1086        %INCLUDE PC_SUBS_C;
      482     1418    1   DCL ES_LOGSYSACC UBIN WORD SYMREF;
      483     1419    1   DCL ES$ PTR;
      484     1420    1   DCL LOGSYSACCT UBIN BASED;
      485     1421        %INCLUDE CP_6;
      486     1502        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
      487     1503                  ENTRY=ES$SECLOG,
      488     1504                  FILENUM=EL_SEC,
      489     1505                  SIZE="SIZEW(ES$SECLOG)",
      490     1506                  TYPE=EL_SYS_ACCESS);
      491     1521        %INCLUDE AS_SUBS_C;
      492     2935        %INCLUDE B_SEGIDS_C;
      493     3474    1   DCL JMU$SETSEG ENTRY(2);
      494     3475
      495     3476    1           ES$ = ADDR(ES_LOGSYSACC);

   3476  2 000002   000000 236000 3                  LDQ     0
         2 000003   200007 756100                    STQ     ES$,,AUTO

      496     3477    1           CALL JMU$SETSEG(ES$,%SPCL1SID);
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:93   

   3477  2 000004   000002 236000 3                  LDQ     2
         2 000005   200011 756100                    STQ     ES$+2,,AUTO
         2 000006   200007 630500                    EPPR0   ES$,,AUTO
         2 000007   200010 450500                    STP0    ES$+1,,AUTO
         2 000010   200010 630500                    EPPR0   ES$+1,,AUTO
         2 000011   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000012   000000 701000 xent               TSX1    JMU$SETSEG
         2 000013   000000 011000                    NOP     0

      497     3478    1           IF REASON > ES$->LOGSYSACCT THEN RETURN;

   3478  2 000014   200007 470500                    LDP0    ES$,,AUTO
         2 000015   200006 471500                    LDP1    @REASON,,AUTO
         2 000016   000000 236100                    LDQ     0,,PR0
         2 000017   100000 116100                    CMPQ    0,,PR1
         2 000020   000022 603000 2                  TRC     s:3479

   3478  2 000021   000000 702200 xent               TSX2  ! X66_ARET

      498     3479    1           ES$SECLOG.REASON=REASON;

   3479  2 000022   100000 236100                    LDQ     0,,PR1
         2 000023   000033 736000                    QLS     27
         2 000024   000000 552040 0                  STBQ    ES$SECLOG,'40'O

      499     3480    1           ES$SECLOG.GRANTED='0'B;

   3480  2 000025   000003 236000 3                  LDQ     3
         2 000026   000000 356000 0                  ANSQ    ES$SECLOG

      500     3481    1           ES$SECLOG.MODE=%M_GHOST#;

   3481  2 000027   000001 236000 0                  LDQ     ES$SECLOG+1
         2 000030   000004 376000 3                  ANQ     4
         2 000031   100000 276003                    ORQ     32768,DU
         2 000032   000001 756000 0                  STQ     ES$SECLOG+1
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:94   

      501     3482    1           ES$SECLOG.ACCN = ' ';

   3482  2 000033   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000034   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000035   000002 757000 0                  STAQ    ES$SECLOG+2

      502     3483    1           ES$SECLOG.UNAME = ' ';

   3483  2 000036   040000 100400                    MLR     fill='040'O
         2 000037   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000040   000004 000014 0                  ADSC9   ES$SECLOG+4              cn=0,n=12

      503     3484    1           ES$SECLOG.PASSWORD = ' ';

   3484  2 000041   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000042   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000043   000007 755000 0                  STA     ES$SECLOG+7
         2 000044   000010 756000 0                  STQ     ES$SECLOG+8

      504     3485    1           ES$SECLOG.PRIV='0'B;

   3485  2 000045   000014 450000 0                  STZ     ES$SECLOG+12

      505     3486    1           ES$SECLOG.PPRIV='0'B;

   3486  2 000046   000015 450000 0                  STZ     ES$SECLOG+13

      506     3487    1           ES$SECLOG.LOGON.L = 0;

   3487  2 000047   000000 236003                    LDQ     0,DU
         2 000050   000020 552040 0                  STBQ    ES$SECLOG+16,'40'O

      507     3488    1           ES$SECLOG.LOGON.C = ' ';

   3488  2 000051   040000 100400                    MLR     fill='040'O
         2 000052   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:95   
         2 000053   000020 200037 0                  ADSC9   ES$SECLOG+16             cn=1,n=31

      508     3489    2           DO CASE(REASON);

   3489  2 000054   100000 235100                    LDA     0,,PR1
         2 000055   000005 115007                    CMPA    5,DL
         2 000056   000060 602005 2                  TNC     s:3489+4,AL
         2 000057   000135 710000 2                  TRA     s:3506
         2 000060   000135 710000 2                  TRA     s:3506
         2 000061   000065 710000 2                  TRA     s:3492
         2 000062   000106 710000 2                  TRA     s:3498
         2 000063   000106 710000 2                  TRA     s:3498
         2 000064   000106 710000 2                  TRA     s:3498

      509     3490
      510     3491    2             CASE(%ES_LOG_ALL#);

      511     3492    2               ES$SECLOG.GRANTED='1'B;

   3492  2 000065   000400 236003                    LDQ     256,DU
         2 000066   000000 256000 0                  ORSQ    ES$SECLOG

      512     3493    2               ES$SECLOG.ACCN=ACCT;

   3493  2 000067   200004 473500                    LDP3    @ACCT,,AUTO
         2 000070   040000 100500                    MLR     fill='040'O
         2 000071   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         2 000072   000002 000010 0                  ADSC9   ES$SECLOG+2              cn=0,n=8

      513     3494    2               IF NAME.C ~= 0 THEN

   3494  2 000073   200003 474500                    LDP4    @NAME,,AUTO
         2 000074   000100 101500                    MRL     fill='000'O
         2 000075   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 000076   200010 000004                    ADSC9   ES$+1,,AUTO              cn=0,n=4
         2 000077   200010 236100                    LDQ     ES$+1,,AUTO
         2 000100   000000 116003                    CMPQ    0,DU
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:96   
         2 000101   000136 600000 2                  TZE     s:3508

      514     3495    2                   ES$SECLOG.UNAME=NAME.T;

   3495  2 000102   040000 100500                    MLR     fill='040'O
         2 000103   400000 200014                    ADSC9   0,,PR4                   cn=1,n=12
         2 000104   000004 000014 0                  ADSC9   ES$SECLOG+4              cn=0,n=12
         2 000105   000136 710000 2                  TRA     s:3508

      515     3496
      516     3497    2             CASE(%ES_JUNK_LOGON#,%ES_NO_SUCH_USER#,%ES_BAD_PW#);

      517     3498    2               ES$SECLOG.ACCN=ACCT;

   3498  2 000106   200004 473500                    LDP3    @ACCT,,AUTO
         2 000107   040000 100500                    MLR     fill='040'O
         2 000110   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         2 000111   000002 000010 0                  ADSC9   ES$SECLOG+2              cn=0,n=8

      518     3499    2               IF NAME.C ~= 0 THEN

   3499  2 000112   200003 474500                    LDP4    @NAME,,AUTO
         2 000113   000100 101500                    MRL     fill='000'O
         2 000114   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 000115   200010 000004                    ADSC9   ES$+1,,AUTO              cn=0,n=4
         2 000116   200010 236100                    LDQ     ES$+1,,AUTO
         2 000117   000000 116003                    CMPQ    0,DU
         2 000120   000124 600000 2                  TZE     s:3502

      519     3500    2                   ES$SECLOG.UNAME = NAME.T;

   3500  2 000121   040000 100500                    MLR     fill='040'O
         2 000122   400000 200014                    ADSC9   0,,PR4                   cn=1,n=12
         2 000123   000004 000014 0                  ADSC9   ES$SECLOG+4              cn=0,n=12

      520     3501
      521     3502    2               ES$SECLOG.PASSWORD = PASS;
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:97   

   3502  2 000124   200005 475500                    LDP5    @PASS,,AUTO
         2 000125   040000 100500                    MLR     fill='040'O
         2 000126   500000 000010                    ADSC9   0,,PR5                   cn=0,n=8
         2 000127   000007 000010 0                  ADSC9   ES$SECLOG+7              cn=0,n=8

      522     3503    2               ES$SECLOG.MODE=%M_GHOST#;

   3503  2 000130   000001 236000 0                  LDQ     ES$SECLOG+1
         2 000131   000004 376000 3                  ANQ     4
         2 000132   100000 276003                    ORQ     32768,DU
         2 000133   000001 756000 0                  STQ     ES$SECLOG+1
         2 000134   000136 710000 2                  TRA     s:3508

      523     3504    2             CASE(ELSE);

      524     3505                                                /* Should never happen                */
      525     3506    2               RETURN;

   3506  2 000135   000000 702200 xent               TSX2  ! X66_ARET

      526     3507    2             END;                          /* End Do Case(Reason)                */

      527     3508    2           CALL M$WRSYSLOG(WR_SECLOG) WHENALTRETURN DO;

   3508  2 000136   000062 630400 0                  EPPR0   WR_SECLOG
         2 000137   470001 713400                    CLIMB   alt,+28673
         2 000140   400400 401760                    pmme    nvectors=2
         2 000141   000143 702000 2                  TSX2    s:3511
         2 000142   000143 710000 2                  TRA     s:3511

      528     3509                                                /*JCG LIVES*/
      529     3510    2               END;

      530     3511    1           RETURN;

   3511  2 000143   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:98   
      531     3512    1   END JGG$SECLOG;

PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:99   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JGG$SECLOG.
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:100  

 **** Variables and constants ****

  ****  Section 000  Data  JGG$SECLOG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1764)  r     1 ES$SECLOG                 62-0-0/d STRC(288)   r     1 WR_SECLOG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ACCT                      3-0-0/w PTR         r     1 @NAME
     5-0-0/w PTR         r     1 @PASS                      6-0-0/w PTR         r     1 @REASON
    *0-0-0/c CHAR(8)     r     1 ACCT                       7-0-0/w PTR         r     1 ES$
    *0-0-0/c STRC(117)   r     1 NAME                      *0-0-0/c CHAR(8)     r     1 PASS
    *0-0-0/w UBIN        r     1 REASON

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w UBIN        r     1 ES_LOGSYSACC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 LOGSYSACCT


   Procedure JGG$SECLOG requires 100 words for executable code.
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:101  
   Procedure JGG$SECLOG requires 10 words of local(AUTO) storage.

    No errors detected in file JGG$GJOB.:E05TSI    .
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:102  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:103  
          MINI XREF LISTING

ACCT
        11**DCL         7--PROC     3493>>ASSIGN   3498>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       122**DCL       122--REDEF
B$JIT.ERR.MID
        29**DCL        29--REDEF
B$JIT.JRESPEAK
       190**DCL       191--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       299**DCL       299--REDEF     300--REDEF
B$JIT.PNR
       203**DCL       203--REDEF
B$JIT.TSLINE
       297**DCL       298--REDEF
B$JIT$
      1085**DCL        23--IMP-PTR
ES$
      1419**DCL      3476<<ASSIGN   3477<>CALL     3478>>IF
ES$SECLOG
       822**DCL      1517--DCLINIT  1519--DCLINIT
ES$SECLOG.ACCN
       855**DCL      3482<<ASSIGN   3493<<ASSIGN   3498<<ASSIGN
ES$SECLOG.FACCN
       863**DCL       867--REDEF
ES$SECLOG.FILE
      1023**DCL      1054--REDEF
ES$SECLOG.GRANTED
       829**DCL      3480<<ASSIGN   3492<<ASSIGN
ES$SECLOG.LOGON
       912**DCL       924--REDEF
ES$SECLOG.LOGON.C
       921**DCL      3488<<ASSIGN
PL6.E3A0      #003=JGG$SECLOG File=JGG$GJOB.:E05TSI                              TUE 07/29/97 23:24 Page:104  
ES$SECLOG.LOGON.L
       918**DCL      3487<<ASSIGN
ES$SECLOG.MODE
       833**DCL      3481<<ASSIGN   3503<<ASSIGN
ES$SECLOG.PASSWORD
       867**DCL      3484<<ASSIGN   3502<<ASSIGN
ES$SECLOG.PPRIV
       898**DCL      3486<<ASSIGN
ES$SECLOG.PRIV
       891**DCL      3485<<ASSIGN
ES$SECLOG.REASON
       824**DCL      3479<<ASSIGN
ES$SECLOG.UNAME
       859**DCL      3483<<ASSIGN   3495<<ASSIGN   3500<<ASSIGN
ES_LOGSYSACC
      1418**DCL      3476--ASSIGN
JMU$SETSEG
      3474**DCL-ENT  3477--CALL
LOGSYSACCT
      1420**DCL      3478>>IF
M$WRSYSLOG
      1479**DCL-ENT  3508--CALL
NAME
         8**DCL         7--PROC
NAME.C
         9**DCL      3494>>IF       3499>>IF
NAME.T
        10**DCL      3495>>ASSIGN   3500>>ASSIGN
PASS
        12**DCL         7--PROC     3502>>ASSIGN
REASON
        13**DCL         7--PROC     3478>>IF       3479>>ASSIGN   3489>>DOCASE
WR_SECLOG
      1517**DCL      3508<>CALL
WR_SECLOG.V
      1517**DCL      1517--DCLINIT
