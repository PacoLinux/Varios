VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:1    
        1        1        /*M* ASL$LIST_ALL_DEVICES: routine for LIST DEV FOR LINE cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINE_DEVICES: PROC;
       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINE_DEVICES
       14       14             CALL:     CALL ASL$LIST_ALL_LINE_DEVICES
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINE_DEVICES is a subroutine to handle
       18       18                           the LIST DEV FOR LINE command for SUPER.
       19       19                           Line records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual line name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for lines
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For lines the
       35       35                           EQU is KLAT_LINE# and its value is 5.
       36       36                           This routine will either read a single line
       37       37                           record or it will cycle through all of the :HLP
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:2    
       38       38                           records looking for lines and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the controllers
       42       42                           belonging to the line just found.  It will match
       43       43                           controller numbers in the line record against the
       44       44                           controller number asked for.  If a match is found
       45       45                           it will then look for the devices belonging to the
       46       46                           controller just found.  If it finds a device
       47       47                           matching the device selection criterion, it will
       48       48                           call a display function if the command was DISPLAY,
       49       49                           or it will call the formatter with the device number.
       50       50
       51       51                  MEMORY REQUIREMENTS:
       52       52                           For all of the routines that deal with listing/
       53       53                           displaying lines:
       54       54
       55       55                            ASL$LIST_ALL_LINE_DEVICES
       56       56                            ASL$FIND_LINE_DEVICE
       57       57                            ASL$DISP_ONE_LINE_DEVICE
       58       58
       59       59                            The line record will be read into
       60       60                            data segment 1.  The name will be used by the
       61       61                            ASL$LIST_ALL_LINE_DEVICES, while the other info
       62       62                            will be used by the ASL$DISP_ONE_LINE_DEVICE routine.
       63       63        */
       64       64        /********************************************************************/
       65       65        /*   Include files   include files   include files   include files  */
       66       66        /********************************************************************/
       67       67        %INCLUDE AS_PERR_C;
       68      669        %INCLUDE AS_SUPER_C;
       69     1104        %INCLUDE AS_SUBS_C;
       70     2518        %INCLUDE AS_MAC_C;
       71     2598        %INCLUDE AS_ENTRIES_M;
       72     3648        %INCLUDE AS_SSUBS_C;
       73     3740        %INCLUDE B_ERRORS_C;
       74     4867        %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:3    
       75     5407        %INCLUDE KL_SUPER_C;
       76     8309        %INCLUDE XU_MACRO_C;
       77    11415        %INCLUDE XU_FORMAT_C;
       78    11577        %INCLUDE OCI_SUBS_C ;
       79    11675        %INCLUDE AS_SUPER_R;
       80    14691        /********************************************************************/
       81    14692        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       82    14693        /********************************************************************/
       83    14694        %ASB$PREC_HLP ;
       84    14697        %ASB$READ_HLP ;
       85    14700        %ASB$READ_HLP_SEQ ;
       86    14703        %ASH$ERROR ;
       87    14706        %ASA$ERROR ;
       88    14709        %ASL$FIND_LINE_DEVICE ;
       89    14712        %ASL$FIND_CONTROLLER ;
       90    14715        %ASL$DISP_ONE_LINE_DEVICE ;
       91    14718        %ASB$WILD_MATCH ;
       92    14721    1   DCL X$FORMAT ENTRY(1) ;
       93    14722        /********************************************************************/
       94    14723        /*   Local based     local based     local based     local based    */
       95    14724        /********************************************************************/
       96    14725        %PARSE$OUT       ( NAME = P$B, STCLASS = "BASED(NODE$)",
       97    14726                           NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       98    14771        %PARSE$SYM       ( NAME = P$S, STCLASS = BASED);
       99    14809        %KL_DREC         ( NAME = LINE$DREC,
      100    14810                           STCLASS = "BASED(DSEG1$)",
      101    14811                           LAST = ";");
      102    14924        %KL_CONTROLLER   ( NAME = KL$CONTROLLER,
      103    14925                           LVL = 1,
      104    14926                           LAST = ";",
      105    14927                           STCLASS = "BASED( CONT$ )" );
      106    15076        %KL_LINEDEV      ( NAME = KL$LINEDEV,
      107    15077                           LVL = 1,
      108    15078                           STCLASS = "BASED( DEV$ )" );
      109    15227        /********************************************************************/
      110    15228        /*   Auto data       auto data       auto data       auto data      */
      111    15229        /********************************************************************/
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:4    
      112    15230    1   DCL ALL_LINES              BIT(1);
      113    15231    1   DCL ARS                    UBIN;
      114    15232    1   DCL 1 BEGIN_KEY ,
      115    15233    1          2 COUNT             UBIN BYTE,
      116    15234    1          2 TEXT              CHAR(8);
      117    15235    1   DCL 1 CONT_NAME,
      118    15236    1          2 COUNT             UBIN BYTE UNAL,
      119    15237    1          2 TEXT              CHAR(2) UNAL;
      120    15238    1   DCL CONT$                  PTR;
      121    15239    1   DCL CONTROLLER_NUMBER      UBIN;
      122    15240    1   DCL CURRENT_LINE           CHAR(8);
      123    15241    1   DCL DEV_ARS                UBIN;
      124    15242    1   DCL DEV$                   PTR;
      125    15243    1   DCL 1 DEVICE_NAME,
      126    15244    1          2 COUNT             UBIN BYTE UNAL,
      127    15245    1          2 TEXT              CHAR(2) UNAL;
      128    15246    1   DCL DISP                   BIT(1);
      129    15247    1   DCL DISP_CONTROLLERS       SBIN;
      130    15248    1   DCL DISP_DEVICES           SBIN;
      131    15249    1   DCL DISP_LINES             SBIN;
      132    15250    1   DCL 1 END_KEY ,
      133    15251    1          2 COUNT             UBIN BYTE,
      134    15252    1          2 TEXT              CHAR(8);
      135    15253    1   DCL END$                   PTR;
      136    15254    1   DCL I                      UBIN;
      137    15255    1   DCL J                      UBIN;
      138    15256    1   DCL JCL                    BIT(1);
      139    15257    1   DCL 1 LINE_NAME,
      140    15258    1          2 COUNT             UBIN BYTE UNAL,
      141    15259    1          2 TEXT              CHAR(8) UNAL;
      142    15260    1   DCL NEW_CONTROLLER         BIT(1);
      143    15261    1   DCL NEW_LINE               BIT(1);
      144    15262    1   DCL WILD_CARD              BIT(1);
      145    15263
      146    15264        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:5    
      147    15265        /********************************************************************/
      148    15266        /*   Constant data   constant data   constant data   constant data  */
      149    15267        /********************************************************************/
      150    15268    1   DCL LINE_STR               CHAR(0) CONSTANT INIT ('line');
      151    15269    1   DCL LINES_STR              CHAR(0) CONSTANT INIT ('lines');
      152    15270    1   DCL DEVICE_STR             CHAR(0) CONSTANT INIT ('line device');
      153    15271    1   DCL DEVICES_STR            CHAR(0) CONSTANT INIT ('line devices');
      154    15272    1   DCL CONTROLLER_STR         CHAR(0) CONSTANT INIT ('controller');
      155    15273    1   DCL CONTROLLERS_STR        CHAR(0) CONSTANT INIT ('controllers');
      156    15274    1   DCL LIST_STR               CHAR(0) CONSTANT INIT ('listed');
      157    15275    1   DCL DISPLAY_STR            CHAR(0) CONSTANT INIT ('displayed');
      158    15276    1   DCL FOUND_STR              CHAR(0) CONSTANT INIT ('found');
      159    15277        %KL_CONTROLLER   ( LVL = 1, STCLASS = CONSTANT );
      160    15426        %KL_LINEDEV      ( LVL = 1, STCLASS = CONSTANT );
      161    15575        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:6    
      162    15576        /********************************************************************/
      163    15577        /*   Procedure       procedure       procedure       procedure      */
      164    15578        /********************************************************************/
      165    15579    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      166    15580    1   JCL = %NO#;
      167    15581    1   WILD_CARD = %NO#;
      168    15582    1   LINE_NAME.TEXT = '?';
      169    15583    1   LINE_NAME.COUNT = 1;
      170    15584    1   CONT_NAME.TEXT = '?';
      171    15585    1   CONT_NAME.COUNT = 1;
      172    15586    1   DEVICE_NAME.TEXT = '?';
      173    15587    1   DEVICE_NAME.COUNT = 1;
      174    15588    1   DISP_DEVICES = 0;
      175    15589    1   DISP_CONTROLLERS = 0;
      176    15590    1   DISP_LINES = 0;
      177    15591
      178    15592    2   DO SELECT (CODE);
      179    15593
      180    15594    2      SELECT (%LIST_ALL_VAL);
      181    15595
      182    15596    2      DISP = %NO#;
      183    15597    2      JCL = %NO#;
      184    15598
      185    15599    2      SELECT (%DISPLAY_ALL_VAL);
      186    15600
      187    15601    2      DISP = %YES#;
      188    15602    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN
      189    15603    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      190    15604    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN
      191    15605    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);
      192    15606
      193    15607    2      SELECT ( %LIST_DEVICE_VAL,
      194    15608    2           %DISPLAY_DEVICE_VAL);
      195    15609
      196    15610    2      DISP = (CODE = %DISPLAY_DEVICE_VAL);
      197    15611    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      198    15612    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINE_NAME_WILD_VAL THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:7    
      199    15613    4            LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      200    15614    4            LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      201    15615    4            END;  /*  Code = LINE_NAME_WILD  */
      202    15616    3         ELSE
      203    15617    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %CONTROLLER_NAME_WILD_VAL THEN DO;
      204    15618    4               CONT_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      205    15619    4               CONT_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      206    15620    4               END; /*  Code = CONTROLLER_NAME_WILD  */
      207    15621    3            ELSE
      208    15622    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %DEVICE_NAME_WILD_VAL THEN DO;
      209    15623    4                  DEVICE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      210    15624    4                  DEVICE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      211    15625    4                  END; /*  Code = DEVICE_NAME_WILD  */
      212    15626    3               ELSE
      213    15627    4                  IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;
      214    15628
      215    15629    4                     JCL = %YES#;
      216    15630
      217    15631    4                     END; /*  Code = JCL_VAL  */
      218    15632
      219    15633    3         END;  /*  Do i  */
      220    15634
      221    15635    2      END;  /*  Do case (code)  */
      222    15636
      223    15637    1   FDS.NVECS# = 0;
      224    15638    2   IF JCL THEN DO;
      225    15639    2      CALL CONCAT (FMT_BUF, '%1/"', DEVICES_STR, '%1/');
      226    15640    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 6;
      227    15641    2      END;  /*  Jcl  */
      228    15642    2   ELSE DO;
      229    15643    2      CALL CONCAT (FMT_BUF, '%1/', DEVICES_STR, '%1/');
      230    15644    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 5;
      231    15645    2      END;   /*  Not jcl  */
      232    15646    1   FDS.TABDFLT# = 10;
      233    15647    1   CALL X$FORMAT (FDS);
      234    15648
      235    15649    1   IF LINE_NAME.TEXT = '?' THEN
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:8    
      236    15650    1      ALL_LINES = %YES#;
      237    15651    2   ELSE DO;
      238    15652    2      ALL_LINES = %NO#;
      239    15653    2      BEGIN_KEY.TEXT = ' ';
      240    15654    2      END_KEY.TEXT = ' ';
      241    15655    3      CALL INDEX (I,'?',LINE_NAME.TEXT) WHENRETURN DO;
      242    15656    3         BEGIN_KEY.TEXT = SUBSTR(LINE_NAME.TEXT,0,I);
      243    15657    3         BEGIN_KEY.COUNT = 8;
      244    15658    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINE_NAME.TEXT,0,I),'~');
      245    15659    3         END_KEY.COUNT = I + 1;
      246    15660    3         WILD_CARD = %YES#;
      247    15661    3         END;  /*  Whenreturn from index  */
      248    15662    3      WHENALTRETURN DO;
      249    15663    3         WILD_CARD = %NO#;
      250    15664    3         END;  /* Whenaltreturn  */
      251    15665    2      END;  /*  Else  */
      252    15666
      253    15667    2   IF ALL_LINES THEN DO;
      254    15668    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */
      255    15669    2      END;  /*  ALL_LINES  */
      256    15670    2   ELSE IF WILD_CARD THEN DO;
      257    15671    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');
      258    15672    2         USERS_KEY.COUNT = 9 ;
      259    15673    2         END; /*  WILD_CARD  */
      260    15674    2      ELSE DO;  /*  Single line  */
      261    15675    2         CALL CONCAT (USERS_KEY.TXTC,LINE_NAME.TEXT,'*');
      262    15676    2         USERS_KEY.COUNT = 9 ;
      263    15677    2         I = DSEG1SIZE;
      264    15678    2         CALL ASB$READ_HLP (DSEG1$,I,1)
      265    15679    3         WHENRETURN DO;
      266    15680    4            IF LINE$DREC.ATYP ~= %KLAT_LINE# THEN DO;
      267    15681    4               AS_FIELD1 = LINE_NAME;
      268    15682                    %SCREAM( ERR#=E$NOTLINE , LEVEL=ERROR, MID='L' );
      269    15697    4               RETURN ;
      270    15698    4               END ; /* Then do */
      271    15699    3            DISP_LINES = 1;
      272    15700    3            CONT$ = DSEG1$;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:9    
      273    15701    3            ARS = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;
      274    15702    4            DO FOREVER;
      275    15703    4               CALL ASL$FIND_CONTROLLER (DSEG1$, ARS, CONT_NAME, CONT$) ALTRET (
             15703                        END_FOREVER);
      276    15704    4               NEW_CONTROLLER = %YES#;
      277    15705    4               DISP_CONTROLLERS = DISP_CONTROLLERS + 1;
      278    15706    4               DEV_ARS = SIZEW (KL_CONTROLLER) + (KL$CONTROLLER.BLKHDR.NSUBS * SIZEW(
             15706                        KL_LINEDEV));
      279    15707    4               DEV$ = CONT$;
      280    15708    4               END$ = PINCRW (CONT$, DEV_ARS);
      281    15709    5               DO WHILE DEV$ < END$ ;
      282    15710    5                  CALL ASL$FIND_LINE_DEVICE (CONT$, DEV_ARS, DEVICE_NAME, DEV$) ALTRET
             15710                           (END_J);
      283    15711    6                  IF DISP THEN DO;
      284    15712    7                     IF DISP_DEVICES = 0 AND NOT JCL THEN DO;
      285    15713    7                        CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', LINE_NAME.
             15713                                 TEXT);
      286    15714    7                        FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 17;
      287    15715    7                        FDS.NVECS# = 0;
      288    15716    7                        CALL X$FORMAT (FDS);
      289    15717    7                        END;  /*  DISP_DEVICES = 0 and not jcl */
      290    15718    7                     IF NEW_CONTROLLER AND NOT JCL THEN DO;
      291    15719    7                        CALL CONCAT (FMT_BUF, '      ', CONTROLLER_STR, '    %2D');
      292    15720    7                        FDS.FMT_.BOUND = LENGTHC(CONTROLLER_STR) + 12;
      293    15721    7                        FDS.NVECS# = 1;
      294    15722    7                        FMT_VEC (0) = VECTOR (KL$CONTROLLER.CONT#);
      295    15723    7                        CALL X$FORMAT (FDS);
      296    15724    7                        END;  /*  NEW_CONTROLLER and not jcl  */
      297    15725    6                     CONTROLLER_NUMBER = KL$CONTROLLER.CONT#;
      298    15726    6                     CALL ASL$DISP_ONE_LINE_DEVICE (DEV$, JCL, LINE_NAME.TEXT,
             15726                              CONTROLLER_NUMBER, NEW_CONTROLLER);
      299    15727    6                     NEW_CONTROLLER = %NO#;
      300    15728    6                     END;  /*  Disp  */
      301    15729    6                  ELSE DO;
      302    15730    6                     FMT_BUF = '%1/   %A  %A  %A  %2D  %A  %2D';
      303    15731    6                     FDS.FMT_.BOUND = 29;
      304    15732    6                     FDS.NVECS# = 6;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:10   
      305    15733    6                     FMT_VEC (0) = VECTOR (LINE_STR);
      306    15734    6                     FMT_VEC (1) = VECTOR (LINE_NAME.TEXT);
      307    15735    6                     FMT_VEC (2) = VECTOR (CONTROLLER_STR);
      308    15736    6                     FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);
      309    15737    6                     FMT_VEC (4) = VECTOR (DEVICE_STR);
      310    15738    6                     FMT_VEC (5) = VECTOR (KL$LINEDEV.DEVICE#);
      311    15739    6                     CALL X$FORMAT (FDS);
      312    15740    6                     END;  /*  ~ disp  */
      313    15741    5                  DISP_DEVICES = DISP_DEVICES + 1;
      314    15742    5                  END;  /* Do while DEV$ < END$  */
      315    15743    4   END_J:
      316    15744    4               END; /*  Do forever  */
      317    15745    3   END_FOREVER:
      318    15746    3            END;  /*  Whenreturn  */
      319    15747    3         WHENALTRETURN DO;
      320    15748    3            IF MERR_CODE.CODE = %E$NOKEY
      321    15749    4            THEN DO;
      322    15750    4               AS_FIELD1 = LINE_NAME;
      323    15751                    %SCREAM( ERR#=E$LINE_NO_EXIST2, MID='L', LEVEL=ERROR );
      324    15766    4               END;  /*  Error = nokey  */
      325    15767    4            ELSE DO;
      326    15768    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      327    15769    4               END;  /* Error ~= nokey */
      328    15770    3            END;  /*  Whenaltreturn  */
      329    15771    2         GOTO FINISH_UP;
      330    15772    2         END; /*  Else  */
      331    15773    1   CALL ASB$PREC_HLP ;
      332    15774    2   DO FOREVER;
      333    15775
      334    15776    3      DO UNTIL LINE$DREC.ATYP = %KLAT_LINE# ;
      335    15777    3         I = DSEG1SIZE;
      336    15778    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)
      337    15779    4         WHENALTRETURN DO;
      338    15780    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
      339    15781    4            GOTO FINISH_UP;
      340    15782    4            END;  /*  Whenaltreturn  */
      341    15783    3         END;  /*  Do until we find a line record  */
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:11   
      342    15784    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;
      343    15785    2      IF I > 8 THEN I = 8;
      344    15786    2      CURRENT_LINE = SUBSTR(USERS_KEY.TXTC,0,I);
      345    15787    3      IF WILD_CARD THEN DO;
      346    15788    3         J = LINE_NAME.COUNT;
      347    15789    3         CALL ASB$WILD_MATCH (I, CURRENT_LINE, J, LINE_NAME.TEXT)
      348    15790    4         WHENALTRETURN DO;
      349    15791    4            IF CURRENT_LINE > END_KEY.TEXT THEN
      350    15792    4               GOTO FINISH_UP;
      351    15793    4            ELSE
      352    15794    4               GOTO END_FOREVER;
      353    15795    4            END;  /*  Whenaltreturn  */
      354    15796    3         END; /*  WILD_CARD  */
      355    15797    2      NEW_LINE = %YES#;
      356    15798    2      DISP_LINES = DISP_LINES + 1;
      357    15799    2      CONT$ = DSEG1$;
      358    15800    2      ARS = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;
      359    15801    3      DO FOREVER;
      360    15802    3         CALL ASL$FIND_CONTROLLER (DSEG1$, ARS, CONT_NAME, CONT$) ALTRET (END_FOREVER2)
             15802                  ;
      361    15803    3         NEW_CONTROLLER = %YES#;
      362    15804    3         DISP_CONTROLLERS = DISP_CONTROLLERS + 1;
      363    15805    3         DEV_ARS = SIZEW (KL_CONTROLLER) + (KL$CONTROLLER.BLKHDR.NSUBS * SIZEW(
             15805                  KL_LINEDEV));
      364    15806    3         DEV$ = CONT$;
      365    15807    3         END$ = PINCRW (CONT$, DEV_ARS);
      366    15808    4         DO WHILE DEV$ < END$ ;
      367    15809    4            CALL ASL$FIND_LINE_DEVICE (CONT$, DEV_ARS, DEVICE_NAME, DEV$) ALTRET (
             15809                     END_J2);
      368    15810    5            IF DISP THEN DO;
      369    15811    6               IF NEW_LINE AND NOT JCL THEN DO;
      370    15812    6                  CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', CURRENT_LINE);
      371    15813    6                  FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 17;
      372    15814    6                  FDS.NVECS# = 0;
      373    15815    6                  CALL X$FORMAT (FDS);
      374    15816    6                  NEW_LINE = %NO#;
      375    15817    6                  END;  /*  New line and not jcl  */
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:12   
      376    15818    6               IF NEW_CONTROLLER AND NOT JCL THEN DO;
      377    15819    6                  CALL CONCAT (FMT_BUF, '      ', CONTROLLER_STR, '    %2D');
      378    15820    6                  FDS.FMT_.BOUND = LENGTHC(CONTROLLER_STR) + 12;
      379    15821    6                  FDS.NVECS# = 1;
      380    15822    6                  FMT_VEC (0) = VECTOR (KL$CONTROLLER.CONT#);
      381    15823    6                  CALL X$FORMAT (FDS);
      382    15824    6                  END;  /*  New controller and not jcl  */
      383    15825    5               CONTROLLER_NUMBER = KL$CONTROLLER.CONT#;
      384    15826    5               CALL ASL$DISP_ONE_LINE_DEVICE (DEV$, JCL, CURRENT_LINE,
             15826                        CONTROLLER_NUMBER, NEW_CONTROLLER );
      385    15827    5               NEW_CONTROLLER = %NO#;
      386    15828    5               END;  /*  Disp  */
      387    15829    5            ELSE DO;
      388    15830    5               FMT_BUF = '%1/   %A  %A  %A  %2D  %A  %2D';
      389    15831    5               FDS.FMT_.BOUND = 29;
      390    15832    5               FDS.NVECS# = 6;
      391    15833    5               FMT_VEC (0) = VECTOR (LINE_STR);
      392    15834    5               FMT_VEC (1) = VECTOR (CURRENT_LINE);
      393    15835    5               FMT_VEC (2) = VECTOR (CONTROLLER_STR);
      394    15836    5               FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);
      395    15837    5               FMT_VEC (4) = VECTOR (DEVICE_STR);
      396    15838    5               FMT_VEC (5) = VECTOR (KL$LINEDEV.DEVICE#);
      397    15839    5               CALL X$FORMAT (FDS);
      398    15840    5               END;  /*  ~ disp  */
      399    15841    4            DISP_DEVICES = DISP_DEVICES + 1;
      400    15842    4            END;  /* Do while DEV$ < END$  */
      401    15843    3   END_J2:
      402    15844    3         END; /*  Do forever  */
      403    15845    2   END_FOREVER2:
      404    15846    2      END;  /*  Do forever  */
      405    15847    1   FINISH_UP:
      406    15848    2   IF NOT DISP THEN DO;
      407    15849    2      FMT_BUF = '%\%/';
      408    15850    2      FDS.FMT_.BOUND = 3;
      409    15851    2      FDS.NVECS# = 0;
      410    15852    2      CALL X$FORMAT(FDS);
      411    15853    2      END; /*  If not disp  */
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:13   
      412    15854    2   IF NOT JCL THEN DO;
      413    15855    2      FMT_VEC(0) = VECTOR (DISP_DEVICES);
      414    15856    2      IF DISP_DEVICES = 1 THEN
      415    15857    3      DO;
      416    15858    3         FMT_VEC(1) = VECTOR (DEVICE_STR);
      417    15859    3         END; /*  DISP_DEVICES = 1  */
      418    15860    3      ELSE DO;
      419    15861    3         FMT_VEC(1) = VECTOR (DEVICES_STR);
      420    15862    3         END; /*  DISP_DEVICES ~= 1  */
      421    15863    2      IF DISP THEN
      422    15864    3      DO;
      423    15865    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      424    15866    3         END; /*  If disp  */
      425    15867    3      ELSE DO;
      426    15868    3         FMT_VEC(2) = VECTOR (LIST_STR);
      427    15869    3         END; /*  If ~ disp  */
      428    15870    2      FDS.NVECS# = 3;
      429    15871    2      FMT_BUF = '   %5D %A %A.';
      430    15872    2      FDS.FMT_.BOUND = 12;
      431    15873    2      CALL X$FORMAT(FDS);
      432    15874    2      FMT_VEC(0) = VECTOR (DISP_CONTROLLERS);
      433    15875    2      IF DISP_CONTROLLERS = 1 THEN
      434    15876    3      DO;
      435    15877    3         FMT_VEC(1) = VECTOR (CONTROLLER_STR);
      436    15878    3         END; /*  DISP_CONTROLLERS = 1  */
      437    15879    3      ELSE DO;
      438    15880    3         FMT_VEC(1) = VECTOR (CONTROLLERS_STR);
      439    15881    3         END; /*  DISP_CONTROLLERS ~= 1  */
      440    15882    2      FMT_VEC(2) = VECTOR (FOUND_STR);
      441    15883    2      FDS.NVECS# = 3;
      442    15884    2      FMT_BUF = '   %5D %A %A.';
      443    15885    2      FDS.FMT_.BOUND = 12;
      444    15886    2      CALL X$FORMAT(FDS);
      445    15887    2      FMT_VEC(0) = VECTOR (DISP_LINES);
      446    15888    2      IF DISP_LINES = 1 THEN
      447    15889    3      DO;
      448    15890    3         FMT_VEC(1) = VECTOR (LINE_STR);
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:14   
      449    15891    3         END; /*  DISP_LINES = 1  */
      450    15892    3      ELSE DO;
      451    15893    3         FMT_VEC(1) = VECTOR (LINES_STR);
      452    15894    3         END; /*  DISP_LINES ~= 1  */
      453    15895    2      FMT_VEC(2) = VECTOR (FOUND_STR);
      454    15896    2      FDS.NVECS# = 3;
      455    15897    2      FMT_BUF = '   %5D %A %A.';
      456    15898    2      FDS.FMT_.BOUND = 12;
      457    15899    2      CALL X$FORMAT(FDS);
      458    15900    2      END; /* Not jcl */
      459    15901    1   RETURN;
      460    15902    1   END ASL$LIST_ALL_LINE_DEVICES;
      461    15903        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:15   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINE_DEVICES.

   Procedure ASL$LIST_ALL_LINE_DEVICES requires 808 words for executable code.
   Procedure ASL$LIST_ALL_LINE_DEVICES requires 40 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:16   

 Object Unit name= ASL$LIST_ALL_LINE_DEVICES                  File name= ASL$LIST_LINE_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:12:19.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     52     64  ASL$LIST_ALL_LINE_DEVICES
    2   Proc  even  none   808   1450  ASL$LIST_ALL_LINE_DEVICES
    3  RoData even  none    40     50  ASL$LIST_ALL_LINE_DEVICES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_LINE_DEVICES
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:17   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       5 ASL$DISP_ONE_LINE_DEVICE
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$ERROR
 yes     yes           Std       4 ASL$FIND_CONTROLLER
 yes     yes           Std       0 ASB$PREC_HLP
         yes           Std       3 ASA$ERROR
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       4 ASL$FIND_LINE_DEVICE
 yes     yes           Std       3 ASB$READ_HLP_SEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:18   


        1        1        /*M* ASL$LIST_ALL_DEVICES: routine for LIST DEV FOR LINE cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINE_DEVICES: PROC;

     10  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000050 000000                    ZERO    40,0

       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINE_DEVICES
       14       14             CALL:     CALL ASL$LIST_ALL_LINE_DEVICES
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINE_DEVICES is a subroutine to handle
       18       18                           the LIST DEV FOR LINE command for SUPER.
       19       19                           Line records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual line name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for lines
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:19   
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For lines the
       35       35                           EQU is KLAT_LINE# and its value is 5.
       36       36                           This routine will either read a single line
       37       37                           record or it will cycle through all of the :HLP
       38       38                           records looking for lines and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the controllers
       42       42                           belonging to the line just found.  It will match
       43       43                           controller numbers in the line record against the
       44       44                           controller number asked for.  If a match is found
       45       45                           it will then look for the devices belonging to the
       46       46                           controller just found.  If it finds a device
       47       47                           matching the device selection criterion, it will
       48       48                           call a display function if the command was DISPLAY,
       49       49                           or it will call the formatter with the device number.
       50       50
       51       51                  MEMORY REQUIREMENTS:
       52       52                           For all of the routines that deal with listing/
       53       53                           displaying lines:
       54       54
       55       55                            ASL$LIST_ALL_LINE_DEVICES
       56       56                            ASL$FIND_LINE_DEVICE
       57       57                            ASL$DISP_ONE_LINE_DEVICE
       58       58
       59       59                            The line record will be read into
       60       60                            data segment 1.  The name will be used by the
       61       61                            ASL$LIST_ALL_LINE_DEVICES, while the other info
       62       62                            will be used by the ASL$DISP_ONE_LINE_DEVICE routine.
       63       63        */
       64       64        /********************************************************************/
       65       65        /*   Include files   include files   include files   include files  */
       66       66        /********************************************************************/
       67       67        %INCLUDE AS_PERR_C;
       68      669        %INCLUDE AS_SUPER_C;
       69     1104        %INCLUDE AS_SUBS_C;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:20   
       70     2518        %INCLUDE AS_MAC_C;
       71     2598        %INCLUDE AS_ENTRIES_M;
       72     3648        %INCLUDE AS_SSUBS_C;
       73     3740        %INCLUDE B_ERRORS_C;
       74     4867        %INCLUDE CP_6_SUBS;
       75     5407        %INCLUDE KL_SUPER_C;
       76     8309        %INCLUDE XU_MACRO_C;
       77    11415        %INCLUDE XU_FORMAT_C;
       78    11577        %INCLUDE OCI_SUBS_C ;
       79    11675        %INCLUDE AS_SUPER_R;
       80    14691        /********************************************************************/
       81    14692        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       82    14693        /********************************************************************/
       83    14694        %ASB$PREC_HLP ;
       84    14697        %ASB$READ_HLP ;
       85    14700        %ASB$READ_HLP_SEQ ;
       86    14703        %ASH$ERROR ;
       87    14706        %ASA$ERROR ;
       88    14709        %ASL$FIND_LINE_DEVICE ;
       89    14712        %ASL$FIND_CONTROLLER ;
       90    14715        %ASL$DISP_ONE_LINE_DEVICE ;
       91    14718        %ASB$WILD_MATCH ;
       92    14721    1   DCL X$FORMAT ENTRY(1) ;
       93    14722        /********************************************************************/
       94    14723        /*   Local based     local based     local based     local based    */
       95    14724        /********************************************************************/
       96    14725        %PARSE$OUT       ( NAME = P$B, STCLASS = "BASED(NODE$)",
       97    14726                           NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       98    14771        %PARSE$SYM       ( NAME = P$S, STCLASS = BASED);
       99    14809        %KL_DREC         ( NAME = LINE$DREC,
      100    14810                           STCLASS = "BASED(DSEG1$)",
      101    14811                           LAST = ";");
      102    14924        %KL_CONTROLLER   ( NAME = KL$CONTROLLER,
      103    14925                           LVL = 1,
      104    14926                           LAST = ";",
      105    14927                           STCLASS = "BASED( CONT$ )" );
      106    15076        %KL_LINEDEV      ( NAME = KL$LINEDEV,
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:21   
      107    15077                           LVL = 1,
      108    15078                           STCLASS = "BASED( DEV$ )" );
      109    15227        /********************************************************************/
      110    15228        /*   Auto data       auto data       auto data       auto data      */
      111    15229        /********************************************************************/
      112    15230    1   DCL ALL_LINES              BIT(1);
      113    15231    1   DCL ARS                    UBIN;
      114    15232    1   DCL 1 BEGIN_KEY ,
      115    15233    1          2 COUNT             UBIN BYTE,
      116    15234    1          2 TEXT              CHAR(8);
      117    15235    1   DCL 1 CONT_NAME,
      118    15236    1          2 COUNT             UBIN BYTE UNAL,
      119    15237    1          2 TEXT              CHAR(2) UNAL;
      120    15238    1   DCL CONT$                  PTR;
      121    15239    1   DCL CONTROLLER_NUMBER      UBIN;
      122    15240    1   DCL CURRENT_LINE           CHAR(8);
      123    15241    1   DCL DEV_ARS                UBIN;
      124    15242    1   DCL DEV$                   PTR;
      125    15243    1   DCL 1 DEVICE_NAME,
      126    15244    1          2 COUNT             UBIN BYTE UNAL,
      127    15245    1          2 TEXT              CHAR(2) UNAL;
      128    15246    1   DCL DISP                   BIT(1);
      129    15247    1   DCL DISP_CONTROLLERS       SBIN;
      130    15248    1   DCL DISP_DEVICES           SBIN;
      131    15249    1   DCL DISP_LINES             SBIN;
      132    15250    1   DCL 1 END_KEY ,
      133    15251    1          2 COUNT             UBIN BYTE,
      134    15252    1          2 TEXT              CHAR(8);
      135    15253    1   DCL END$                   PTR;
      136    15254    1   DCL I                      UBIN;
      137    15255    1   DCL J                      UBIN;
      138    15256    1   DCL JCL                    BIT(1);
      139    15257    1   DCL 1 LINE_NAME,
      140    15258    1          2 COUNT             UBIN BYTE UNAL,
      141    15259    1          2 TEXT              CHAR(8) UNAL;
      142    15260    1   DCL NEW_CONTROLLER         BIT(1);
      143    15261    1   DCL NEW_LINE               BIT(1);
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:22   
      144    15262    1   DCL WILD_CARD              BIT(1);
      145    15263
      146    15264        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:23   
      147    15265        /********************************************************************/
      148    15266        /*   Constant data   constant data   constant data   constant data  */
      149    15267        /********************************************************************/
      150    15268    1   DCL LINE_STR               CHAR(0) CONSTANT INIT ('line');
      151    15269    1   DCL LINES_STR              CHAR(0) CONSTANT INIT ('lines');
      152    15270    1   DCL DEVICE_STR             CHAR(0) CONSTANT INIT ('line device');
      153    15271    1   DCL DEVICES_STR            CHAR(0) CONSTANT INIT ('line devices');
      154    15272    1   DCL CONTROLLER_STR         CHAR(0) CONSTANT INIT ('controller');
      155    15273    1   DCL CONTROLLERS_STR        CHAR(0) CONSTANT INIT ('controllers');
      156    15274    1   DCL LIST_STR               CHAR(0) CONSTANT INIT ('listed');
      157    15275    1   DCL DISPLAY_STR            CHAR(0) CONSTANT INIT ('displayed');
      158    15276    1   DCL FOUND_STR              CHAR(0) CONSTANT INIT ('found');
      159    15277        %KL_CONTROLLER   ( LVL = 1, STCLASS = CONSTANT );
      160    15426        %KL_LINEDEV      ( LVL = 1, STCLASS = CONSTANT );
      161    15575        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:24   
      162    15576        /********************************************************************/
      163    15577        /*   Procedure       procedure       procedure       procedure      */
      164    15578        /********************************************************************/
      165    15579    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15579  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      166    15580    1   JCL = %NO#;

  15580  2 000007   200032 450100                    STZ     JCL,,AUTO

      167    15581    1   WILD_CARD = %NO#;

  15581  2 000010   200040 450100                    STZ     WILD_CARD,,AUTO

      168    15582    1   LINE_NAME.TEXT = '?';

  15582  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000013   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8

      169    15583    1   LINE_NAME.COUNT = 1;

  15583  2 000014   001000 236003                    LDQ     512,DU
         2 000015   200033 552140                    STBQ    LINE_NAME,'40'O,AUTO

      170    15584    1   CONT_NAME.TEXT = '?';

  15584  2 000016   000001 236000 3                  LDQ     1
         2 000017   200010 552130                    STBQ    CONT_NAME,'30'O,AUTO

      171    15585    1   CONT_NAME.COUNT = 1;

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:25   
  15585  2 000020   001000 236003                    LDQ     512,DU
         2 000021   200010 552140                    STBQ    CONT_NAME,'40'O,AUTO

      172    15586    1   DEVICE_NAME.TEXT = '?';

  15586  2 000022   000001 236000 3                  LDQ     1
         2 000023   200017 552130                    STBQ    DEVICE_NAME,'30'O,AUTO

      173    15587    1   DEVICE_NAME.COUNT = 1;

  15587  2 000024   001000 236003                    LDQ     512,DU
         2 000025   200017 552140                    STBQ    DEVICE_NAME,'40'O,AUTO

      174    15588    1   DISP_DEVICES = 0;

  15588  2 000026   200022 450100                    STZ     DISP_DEVICES,,AUTO

      175    15589    1   DISP_CONTROLLERS = 0;

  15589  2 000027   200021 450100                    STZ     DISP_CONTROLLERS,,AUTO

      176    15590    1   DISP_LINES = 0;

  15590  2 000030   200023 450100                    STZ     DISP_LINES,,AUTO

      177    15591
      178    15592    2   DO SELECT (CODE);

  15592  2 000031   000000 236000 xsym               LDQ     CODE
         2 000032   000022 116007                    CMPQ    18,DL
         2 000033   000044 602000 2                  TNC     s:15592+11
         2 000034   000047 600000 2                  TZE     s:15596
         2 000035   000144 116007                    CMPQ    100,DL
         2 000036   000041 602000 2                  TNC     s:15592+8
         2 000037   000052 600000 2                  TZE     s:15601
         2 000040   000201 710000 2                  TRA     s:15637
         2 000041   000125 116007                    CMPQ    85,DL
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:26   
         2 000042   000201 601000 2                  TNZ     s:15637
         2 000043   000104 710000 2                  TRA     s:15610
         2 000044   000005 116007                    CMPQ    5,DL
         2 000045   000201 601000 2                  TNZ     s:15637
         2 000046   000104 710000 2                  TRA     s:15610

      179    15593
      180    15594    2      SELECT (%LIST_ALL_VAL);

      181    15595
      182    15596    2      DISP = %NO#;

  15596  2 000047   200020 450100                    STZ     DISP,,AUTO

      183    15597    2      JCL = %NO#;

  15597  2 000050   200032 450100                    STZ     JCL,,AUTO
         2 000051   000201 710000 2                  TRA     s:15637

      184    15598
      185    15599    2      SELECT (%DISPLAY_ALL_VAL);

      186    15600
      187    15601    2      DISP = %YES#;

  15601  2 000052   400000 236003                    LDQ     -131072,DU
         2 000053   200020 756100                    STQ     DISP,,AUTO

      188    15602    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN

  15602  2 000054   000003 471500                    LDP1    3,,PR0
         2 000055   100001 220100                    LDX0    1,,PR1
         2 000056   000002 100003                    CMPX0   2,DU
         2 000057   000071 601000 2                  TNZ     s:15604

      189    15603    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:27   
  15603  2 000060   100004 473500                    LDP3    4,,PR1
         2 000061   400000 221003                    LDX1    -131072,DU
         2 000062   300000 722100                    LXL2    0,,PR3
         2 000063   000001 102003                    CMPX2   1,DU
         2 000064   000066 600000 2                  TZE     s:15603+6
         2 000065   000000 221003                    LDX1    0,DU
         2 000066   000000 636011                    EAQ     0,X1
         2 000067   200032 756100                    STQ     JCL,,AUTO
         2 000070   000201 710000 2                  TRA     s:15637

      190    15604    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN

  15604  2 000071   000000 100003                    CMPX0   0,DU
         2 000072   000201 600000 2                  TZE     s:15637

      191    15605    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);

  15605  2 000073   100003 473500                    LDP3    3,,PR1
         2 000074   400000 221003                    LDX1    -131072,DU
         2 000075   300000 722100                    LXL2    0,,PR3
         2 000076   000001 102003                    CMPX2   1,DU
         2 000077   000101 600000 2                  TZE     s:15605+6
         2 000100   000000 221003                    LDX1    0,DU
         2 000101   000000 636011                    EAQ     0,X1
         2 000102   200032 756100                    STQ     JCL,,AUTO
         2 000103   000201 710000 2                  TRA     s:15637

      192    15606
      193    15607    2      SELECT ( %LIST_DEVICE_VAL,

      194    15608    2           %DISPLAY_DEVICE_VAL);
      195    15609
      196    15610    2      DISP = (CODE = %DISPLAY_DEVICE_VAL);

  15610  2 000104   400000 220003                    LDX0    -131072,DU
         2 000105   000125 116007                    CMPQ    85,DL
         2 000106   000110 600000 2                  TZE     s:15610+4
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:28   
         2 000107   000000 220003                    LDX0    0,DU
         2 000110   000000 636010                    EAQ     0,X0
         2 000111   200020 756100                    STQ     DISP,,AUTO

      197    15611    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  15611  2 000112   000001 235007                    LDA     1,DL
         2 000113   200030 755100                    STA     I,,AUTO
         2 000114   000174 710000 2                  TRA     s:15633+3

      198    15612    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINE_NAME_WILD_VAL THEN DO;

  15612  2 000115   000003 470400 xsym               LDP0    P_PCB+3
         2 000116   200030 720100                    LXL0    I,,AUTO
         2 000117   000003 471510                    LDP1    3,X0,PR0
         2 000120   100000 721100                    LXL1    0,,PR1
         2 000121   000353 101003                    CMPX1   235,DU
         2 000122   000135 601000 2                  TNZ     s:15617

      199    15613    4            LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15613  2 000123   100004 236100                    LDQ     4,,PR1
         2 000124   000033 772000                    QRL     27
         2 000125   000000 622006                    EAX2    0,QL
         2 000126   040100 100540                    MLR     fill='040'O
         2 000127   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000130   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8

      200    15614    4            LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15614  2 000131   000003 471510                    LDP1    3,X0,PR0
         2 000132   100004 236100                    LDQ     4,,PR1
         2 000133   200033 552140                    STBQ    LINE_NAME,'40'O,AUTO

      201    15615    4            END;  /*  Code = LINE_NAME_WILD  */

  15615  2 000134   000171 710000 2                  TRA     s:15633
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:29   

      202    15616    3         ELSE
      203    15617    4           IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %CONTROLLER_NAME_WILD_VAL THEN DO;

  15617  2 000135   000347 101003                    CMPX1   231,DU
         2 000136   000151 601000 2                  TNZ     s:15622

      204    15618    4               CONT_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15618  2 000137   100004 236100                    LDQ     4,,PR1
         2 000140   000033 772000                    QRL     27
         2 000141   000000 622006                    EAX2    0,QL
         2 000142   040100 100540                    MLR     fill='040'O
         2 000143   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000144   200010 200002                    ADSC9   CONT_NAME,,AUTO          cn=1,n=2

      205    15619    4               CONT_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15619  2 000145   000003 471510                    LDP1    3,X0,PR0
         2 000146   100004 236100                    LDQ     4,,PR1
         2 000147   200010 552140                    STBQ    CONT_NAME,'40'O,AUTO

      206    15620    4               END; /*  Code = CONTROLLER_NAME_WILD  */

  15620  2 000150   000171 710000 2                  TRA     s:15633

      207    15621    3            ELSE
      208    15622    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %DEVICE_NAME_WILD_VAL THEN DO;

  15622  2 000151   000337 101003                    CMPX1   223,DU
         2 000152   000165 601000 2                  TNZ     s:15627

      209    15623    4                  DEVICE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15623  2 000153   100004 236100                    LDQ     4,,PR1
         2 000154   000033 772000                    QRL     27
         2 000155   000000 622006                    EAX2    0,QL
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:30   
         2 000156   040100 100540                    MLR     fill='040'O
         2 000157   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000160   200017 200002                    ADSC9   DEVICE_NAME,,AUTO        cn=1,n=2

      210    15624    4                  DEVICE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15624  2 000161   000003 471510                    LDP1    3,X0,PR0
         2 000162   100004 236100                    LDQ     4,,PR1
         2 000163   200017 552140                    STBQ    DEVICE_NAME,'40'O,AUTO

      211    15625    4                  END; /*  Code = DEVICE_NAME_WILD  */

  15625  2 000164   000171 710000 2                  TRA     s:15633

      212    15626    3               ELSE
      213    15627    4                  IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;

  15627  2 000165   000001 101003                    CMPX1   1,DU
         2 000166   000171 601000 2                  TNZ     s:15633

      214    15628
      215    15629    4                     JCL = %YES#;

  15629  2 000167   400000 236003                    LDQ     -131072,DU
         2 000170   200032 756100                    STQ     JCL,,AUTO

      216    15630
      217    15631    4                     END; /*  Code = JCL_VAL  */

      218    15632
      219    15633    3         END;  /*  Do i  */

  15633  2 000171   200030 235100                    LDA     I,,AUTO
         2 000172   000001 035007                    ADLA    1,DL
         2 000173   200030 755100                    STA     I,,AUTO
         2 000174   000001 236100                    LDQ     1,,PR0
         2 000175   000022 772000                    QRL     18
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:31   
         2 000176   200030 116100                    CMPQ    I,,AUTO
         2 000177   000201 600000 2                  TZE     s:15637
         2 000200   000115 603000 2                  TRC     s:15612

      220    15634
      221    15635    2      END;  /*  Do case (code)  */

      222    15636
      223    15637    1   FDS.NVECS# = 0;

  15637  2 000201   000011 450000 xsym               STZ     FDS+9

      224    15638    2   IF JCL THEN DO;

  15638  2 000202   200032 234100                    SZN     JCL,,AUTO
         2 000203   000221 605000 2                  TPL     s:15643

      225    15639    2      CALL CONCAT (FMT_BUF, '%1/"', DEVICES_STR, '%1/');

  15639  2 000204   000036 236000 1                  LDQ     KL_LINEDEV+4
         2 000205   000000 756000 xsym               STQ     FMT_BUF
         2 000206   040000 100400                    MLR     fill='040'O
         2 000207   000006 000014 1                  ADSC9   DEVICES_STR              cn=0,n=12
         2 000210   000001 000014 xsym               ADSC9   FMT_BUF+1                cn=0,n=12
         2 000211   040000 100400                    MLR     fill='040'O
         2 000212   000036 000003 1                  ADSC9   KL_LINEDEV+4             cn=0,n=3
         2 000213   000004 000357 xsym               ADSC9   FMT_BUF+4                cn=0,n=239

      226    15640    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 6;

  15640  2 000214   000000 236000 xsym               LDQ     FDS
         2 000215   177777 376007                    ANQ     65535,DL
         2 000216   000002 276000 3                  ORQ     2
         2 000217   000000 756000 xsym               STQ     FDS

      227    15641    2      END;  /*  Jcl  */

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:32   
  15641  2 000220   000237 710000 2                  TRA     s:15646

      228    15642    2   ELSE DO;

      229    15643    2      CALL CONCAT (FMT_BUF, '%1/', DEVICES_STR, '%1/');

  15643  2 000221   000036 236000 1                  LDQ     KL_LINEDEV+4
         2 000222   000003 376000 3                  ANQ     3
         2 000223   000040 276007                    ORQ     32,DL
         2 000224   000000 756000 xsym               STQ     FMT_BUF
         2 000225   040000 100400                    MLR     fill='040'O
         2 000226   000006 000014 1                  ADSC9   DEVICES_STR              cn=0,n=12
         2 000227   000000 600014 xsym               ADSC9   FMT_BUF                  cn=3,n=12
         2 000230   040000 100400                    MLR     fill='040'O
         2 000231   000036 000003 1                  ADSC9   KL_LINEDEV+4             cn=0,n=3
         2 000232   000003 600360 xsym               ADSC9   FMT_BUF+3                cn=3,n=240

      230    15644    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 5;

  15644  2 000233   000000 236000 xsym               LDQ     FDS
         2 000234   177777 376007                    ANQ     65535,DL
         2 000235   000004 276000 3                  ORQ     4
         2 000236   000000 756000 xsym               STQ     FDS

      231    15645    2      END;   /*  Not jcl  */

      232    15646    1   FDS.TABDFLT# = 10;

  15646  2 000237   000012 235007                    LDA     10,DL
         2 000240   000017 755000 xsym               STA     FDS+15

      233    15647    1   CALL X$FORMAT (FDS);

  15647  2 000241   000005 630400 3                  EPPR0   5
         2 000242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000243   000000 701000 xent               TSX1    X$FORMAT
         2 000244   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:33   

      234    15648
      235    15649    1   IF LINE_NAME.TEXT = '?' THEN

  15649  2 000245   040000 106500                    CMPC    fill='040'O
         2 000246   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000247   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000250   000254 601000 2                  TNZ     s:15652

      236    15650    1      ALL_LINES = %YES#;

  15650  2 000251   400000 236003                    LDQ     -131072,DU
         2 000252   200003 756100                    STQ     ALL_LINES,,AUTO
         2 000253   000321 710000 2                  TRA     s:15667

      237    15651    2   ELSE DO;

      238    15652    2      ALL_LINES = %NO#;

  15652  2 000254   200003 450100                    STZ     ALL_LINES,,AUTO

      239    15653    2      BEGIN_KEY.TEXT = ' ';

  15653  2 000255   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000256   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000257   200006 757100                    STAQ    BEGIN_KEY+1,,AUTO

      240    15654    2      END_KEY.TEXT = ' ';

  15654  2 000260   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000261   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000262   200025 755100                    STA     END_KEY+1,,AUTO
         2 000263   200026 756100                    STQ     END_KEY+2,,AUTO

      241    15655    3      CALL INDEX (I,'?',LINE_NAME.TEXT) WHENRETURN DO;

  15655  2 000264   000000 124500                    SCM     mask='000'O
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:34   
         2 000265   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000266   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000267   200030 000100                    ARG     I,,AUTO
         2 000270   000320 606400 2                  TTN     s:15663

      242    15656    3         BEGIN_KEY.TEXT = SUBSTR(LINE_NAME.TEXT,0,I);

  15656  2 000271   200030 720100                    LXL0    I,,AUTO
         2 000272   040100 100540                    MLR     fill='040'O
         2 000273   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=*X0
         2 000274   200006 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

      243    15657    3         BEGIN_KEY.COUNT = 8;

  15657  2 000275   010000 236003                    LDQ     4096,DU
         2 000276   200005 756100                    STQ     BEGIN_KEY,,AUTO

      244    15658    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINE_NAME.TEXT,0,I),'~');

  15658  2 000277   040100 100540                    MLR     fill='040'O
         2 000300   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=*X0
         2 000301   200025 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000302   200030 236100                    LDQ     I,,AUTO
         2 000303   000010 116007                    CMPQ    8,DL
         2 000304   000312 603000 2                  TRC     s:15659
         2 000305   777767 621006                    EAX1    -9,QL
         2 000306   777777 661003                    ERX1    -1,DU
         2 000307   040146 100400                    MLR     fill='040'O
         2 000310   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 000311   200025 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      245    15659    3         END_KEY.COUNT = I + 1;

  15659  2 000312   000001 036007                    ADLQ    1,DL
         2 000313   000033 736000                    QLS     27
         2 000314   200024 756100                    STQ     END_KEY,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:35   
      246    15660    3         WILD_CARD = %YES#;

  15660  2 000315   400000 236003                    LDQ     -131072,DU
         2 000316   200040 756100                    STQ     WILD_CARD,,AUTO

      247    15661    3         END;  /*  Whenreturn from index  */

  15661  2 000317   000321 710000 2                  TRA     s:15667

      248    15662    3      WHENALTRETURN DO;

      249    15663    3         WILD_CARD = %NO#;

  15663  2 000320   200040 450100                    STZ     WILD_CARD,,AUTO

      250    15664    3         END;  /* Whenaltreturn  */

      251    15665    2      END;  /*  Else  */

      252    15666
      253    15667    2   IF ALL_LINES THEN DO;

  15667  2 000321   200003 234100                    SZN     ALL_LINES,,AUTO
         2 000322   000327 605000 2                  TPL     s:15670

      254    15668    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */

  15668  2 000323   000000 100400                    MLR     fill='000'O
         2 000324   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         2 000325   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      255    15669    2      END;  /*  ALL_LINES  */

  15669  2 000326   000700 710000 2                  TRA     s:15773

      256    15670    2   ELSE IF WILD_CARD THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:36   
  15670  2 000327   200040 234100                    SZN     WILD_CARD,,AUTO
         2 000330   000342 605000 2                  TPL     s:15675

      257    15671    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');

  15671  2 000331   040000 100500                    MLR     fill='040'O
         2 000332   200006 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8
         2 000333   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000334   040000 100400                    MLR     fill='040'O
         2 000335   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000336   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      258    15672    2         USERS_KEY.COUNT = 9 ;

  15672  2 000337   011000 236003                    LDQ     4608,DU
         2 000340   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      259    15673    2         END; /*  WILD_CARD  */

  15673  2 000341   000700 710000 2                  TRA     s:15773

      260    15674    2      ELSE DO;  /*  Single line  */

      261    15675    2         CALL CONCAT (USERS_KEY.TXTC,LINE_NAME.TEXT,'*');

  15675  2 000342   040000 100500                    MLR     fill='040'O
         2 000343   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000344   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000345   040000 100400                    MLR     fill='040'O
         2 000346   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000347   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      262    15676    2         USERS_KEY.COUNT = 9 ;

  15676  2 000350   011000 236003                    LDQ     4608,DU
         2 000351   000000 552040 xsym               STBQ    USERS_KEY,'40'O

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:37   
      263    15677    2         I = DSEG1SIZE;

  15677  2 000352   000000 235000 xsym               LDA     DSEG1SIZE
         2 000353   200030 755100                    STA     I,,AUTO

      264    15678    2         CALL ASB$READ_HLP (DSEG1$,I,1)

  15678  2 000354   000010 236000 3                  LDQ     8
         2 000355   200044 756100                    STQ     WILD_CARD+4,,AUTO
         2 000356   200030 630500                    EPPR0   I,,AUTO
         2 000357   200043 450500                    STP0    WILD_CARD+3,,AUTO
         2 000360   000011 236000 3                  LDQ     9
         2 000361   200042 756100                    STQ     WILD_CARD+2,,AUTO
         2 000362   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000363   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000364   000000 701000 xent               TSX1    ASB$READ_HLP
         2 000365   000657 702000 2                  TSX2    s:15748

      265    15679    3         WHENRETURN DO;

      266    15680    4            IF LINE$DREC.ATYP ~= %KLAT_LINE# THEN DO;

  15680  2 000366   000000 470400 xsym               LDP0    DSEG1$
         2 000367   000000 236100                    LDQ     0,,PR0
         2 000370   777000 376003                    ANQ     -512,DU
         2 000371   005000 116003                    CMPQ    2560,DU
         2 000372   000403 600000 2                  TZE     s:15699

      267    15681    4               AS_FIELD1 = LINE_NAME;

  15681  2 000373   000000 100500                    MLR     fill='000'O
         2 000374   200033 000011                    ADSC9   LINE_NAME,,AUTO          cn=0,n=9
         2 000375   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      268    15682                    %SCREAM( ERR#=E$NOTLINE , LEVEL=ERROR, MID='L' );

  15694  2 000376   000012 630400 3                  EPPR0   10
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:38   
         2 000377   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000400   000000 701000 xent               TSX1    ASH$ERROR
         2 000401   000000 011000                    NOP     0

      269    15697    4               RETURN ;

  15697  2 000402   000000 702200 xent               TSX2  ! X66_ARET

      270    15698    4               END ; /* Then do */
      271    15699    3            DISP_LINES = 1;

  15699  2 000403   000001 235007                    LDA     1,DL
         2 000404   200023 755100                    STA     DISP_LINES,,AUTO

      272    15700    3            CONT$ = DSEG1$;

  15700  2 000405   000000 236000 xsym               LDQ     DSEG1$
         2 000406   200011 756100                    STQ     CONT$,,AUTO

      273    15701    3            ARS = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;

  15701  2 000407   000017 235100                    LDA     15,,PR0
         2 000410   000020 035007                    ADLA    16,DL
         2 000411   200004 755100                    STA     ARS,,AUTO

      274    15702    4            DO FOREVER;

      275    15703    4               CALL ASL$FIND_CONTROLLER (DSEG1$, ARS, CONT_NAME, CONT$) ALTRET (
             15703                        END_FOREVER);

  15703  2 000412   200011 630500                    EPPR0   CONT$,,AUTO
         2 000413   200045 450500                    STP0    WILD_CARD+5,,AUTO
         2 000414   200010 631500                    EPPR1   CONT_NAME,,AUTO
         2 000415   200044 451500                    STP1    WILD_CARD+4,,AUTO
         2 000416   200004 633500                    EPPR3   ARS,,AUTO
         2 000417   200043 453500                    STP3    WILD_CARD+3,,AUTO
         2 000420   000011 236000 3                  LDQ     9
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:39   
         2 000421   200042 756100                    STQ     WILD_CARD+2,,AUTO
         2 000422   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000423   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000424   000000 701000 xent               TSX1    ASL$FIND_CONTROLLER
         2 000425   000656 702000 2                  TSX2    END_J+1

      276    15704    4               NEW_CONTROLLER = %YES#;

  15704  2 000426   400000 236003                    LDQ     -131072,DU
         2 000427   200036 756100                    STQ     NEW_CONTROLLER,,AUTO

      277    15705    4               DISP_CONTROLLERS = DISP_CONTROLLERS + 1;

  15705  2 000430   200021 054100                    AOS     DISP_CONTROLLERS,,AUTO

      278    15706    4               DEV_ARS = SIZEW (KL_CONTROLLER) + (KL$CONTROLLER.BLKHDR.NSUBS * SIZEW(
             15706                        KL_LINEDEV));

  15706  2 000431   200011 470500                    LDP0    CONT$,,AUTO
         2 000432   000100 101500                    MRL     fill='000'O
         2 000433   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 000434   200042 000004                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=4
         2 000435   200042 236100                    LDQ     WILD_CARD+2,,AUTO
         2 000436   000002 736000                    QLS     2
         2 000437   000004 036007                    ADLQ    4,DL
         2 000440   200015 756100                    STQ     DEV_ARS,,AUTO

      279    15707    4               DEV$ = CONT$;

  15707  2 000441   200011 236100                    LDQ     CONT$,,AUTO
         2 000442   200016 756100                    STQ     DEV$,,AUTO

      280    15708    4               END$ = PINCRW (CONT$, DEV_ARS);

  15708  2 000443   200015 236100                    LDQ     DEV_ARS,,AUTO
         2 000444   000022 736000                    QLS     18
         2 000445   200011 036100                    ADLQ    CONT$,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:40   
         2 000446   200027 756100                    STQ     END$,,AUTO

      281    15709    5               DO WHILE DEV$ < END$ ;

  15709  2 000447   200016 116100                    CMPQ    DEV$,,AUTO
         2 000450   000655 602000 2                  TNC     END_J
         2 000451   000655 600000 2                  TZE     END_J

      282    15710    5                  CALL ASL$FIND_LINE_DEVICE (CONT$, DEV_ARS, DEVICE_NAME, DEV$) ALTRET
             15710                           (END_J);

  15710  2 000452   200016 630500                    EPPR0   DEV$,,AUTO
         2 000453   200045 450500                    STP0    WILD_CARD+5,,AUTO
         2 000454   200017 631500                    EPPR1   DEVICE_NAME,,AUTO
         2 000455   200044 451500                    STP1    WILD_CARD+4,,AUTO
         2 000456   200015 633500                    EPPR3   DEV_ARS,,AUTO
         2 000457   200043 453500                    STP3    WILD_CARD+3,,AUTO
         2 000460   200011 634500                    EPPR4   CONT$,,AUTO
         2 000461   200042 454500                    STP4    WILD_CARD+2,,AUTO
         2 000462   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000463   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000464   000000 701000 xent               TSX1    ASL$FIND_LINE_DEVICE
         2 000465   000655 702000 2                  TSX2    END_J

      283    15711    6                  IF DISP THEN DO;

  15711  2 000466   200020 234100                    SZN     DISP,,AUTO
         2 000467   000603 605000 2                  TPL     s:15730

      284    15712    7                     IF DISP_DEVICES = 0 AND NOT JCL THEN DO;

  15712  2 000470   200022 235100                    LDA     DISP_DEVICES,,AUTO
         2 000471   000521 601000 2                  TNZ     s:15718
         2 000472   200032 234100                    SZN     JCL,,AUTO
         2 000473   000521 604000 2                  TMI     s:15718

      285    15713    7                        CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', LINE_NAME.
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:41   
             15713                                 TEXT);

  15713  2 000474   040000 100400                    MLR     fill='040'O
         2 000475   000040 000006 1                  ADSC9   KL_LINEDEV+6             cn=0,n=6
         2 000476   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000477   040000 100400                    MLR     fill='040'O
         2 000500   000000 000004 1                  ADSC9   LINE_STR                 cn=0,n=4
         2 000501   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
         2 000502   040000 100400                    MLR     fill='040'O
         2 000503   000041 000004 1                  ADSC9   KL_LINEDEV+7             cn=0,n=4
         2 000504   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 000505   040000 100500                    MLR     fill='040'O
         2 000506   200033 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000507   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      286    15714    7                        FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 17;

  15714  2 000510   000000 236000 xsym               LDQ     FDS
         2 000511   177777 376007                    ANQ     65535,DL
         2 000512   000013 276000 3                  ORQ     11
         2 000513   000000 756000 xsym               STQ     FDS

      287    15715    7                        FDS.NVECS# = 0;

  15715  2 000514   000011 450000 xsym               STZ     FDS+9

      288    15716    7                        CALL X$FORMAT (FDS);

  15716  2 000515   000005 630400 3                  EPPR0   5
         2 000516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000517   000000 701000 xent               TSX1    X$FORMAT
         2 000520   000000 011000                    NOP     0

      289    15717    7                        END;  /*  DISP_DEVICES = 0 and not jcl */

      290    15718    7                     IF NEW_CONTROLLER AND NOT JCL THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:42   
  15718  2 000521   200036 234100                    SZN     NEW_CONTROLLER,,AUTO
         2 000522   000555 605000 2                  TPL     s:15725
         2 000523   200032 234100                    SZN     JCL,,AUTO
         2 000524   000555 604000 2                  TMI     s:15725

      291    15719    7                        CALL CONCAT (FMT_BUF, '      ', CONTROLLER_STR, '    %2D');

  15719  2 000525   040000 100400                    MLR     fill='040'O
         2 000526   000042 000006 1                  ADSC9   KL_LINEDEV+8             cn=0,n=6
         2 000527   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000530   040000 100400                    MLR     fill='040'O
         2 000531   000011 000012 1                  ADSC9   CONTROLLER_STR           cn=0,n=10
         2 000532   000001 400012 xsym               ADSC9   FMT_BUF+1                cn=2,n=10
         2 000533   040000 100400                    MLR     fill='040'O
         2 000534   000044 000007 1                  ADSC9   KL_LINEDEV+10            cn=0,n=7
         2 000535   000004 000357 xsym               ADSC9   FMT_BUF+4                cn=0,n=239

      292    15720    7                        FDS.FMT_.BOUND = LENGTHC(CONTROLLER_STR) + 12;

  15720  2 000536   000000 236000 xsym               LDQ     FDS
         2 000537   177777 376007                    ANQ     65535,DL
         2 000540   000014 276000 3                  ORQ     12
         2 000541   000000 756000 xsym               STQ     FDS

      293    15721    7                        FDS.NVECS# = 1;

  15721  2 000542   000001 235007                    LDA     1,DL
         2 000543   000011 755000 xsym               STA     FDS+9

      294    15722    7                        FMT_VEC (0) = VECTOR (KL$CONTROLLER.CONT#);

  15722  2 000544   177640 235007                    LDA     65440,DL
         2 000545   200011 236100                    LDQ     CONT$,,AUTO
         2 000546   000002 036003                    ADLQ    2,DU
         2 000547   000000 755000 xsym               STA     FMT_VEC
         2 000550   000001 756000 xsym               STQ     FMT_VEC+1

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:43   
      295    15723    7                        CALL X$FORMAT (FDS);

  15723  2 000551   000005 630400 3                  EPPR0   5
         2 000552   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000553   000000 701000 xent               TSX1    X$FORMAT
         2 000554   000000 011000                    NOP     0

      296    15724    7                        END;  /*  NEW_CONTROLLER and not jcl  */

      297    15725    6                     CONTROLLER_NUMBER = KL$CONTROLLER.CONT#;

  15725  2 000555   200011 470500                    LDP0    CONT$,,AUTO
         2 000556   000100 101500                    MRL     fill='000'O
         2 000557   000002 000001                    ADSC9   2,,PR0                   cn=0,n=1
         2 000560   200012 000004                    ADSC9   CONTROLLER_NUMBER,,AUTO  cn=0,n=4

      298    15726    6                     CALL ASL$DISP_ONE_LINE_DEVICE (DEV$, JCL, LINE_NAME.TEXT,
             15726                              CONTROLLER_NUMBER, NEW_CONTROLLER);

  15726  2 000561   200036 631500                    EPPR1   NEW_CONTROLLER,,AUTO
         2 000562   200046 451500                    STP1    WILD_CARD+6,,AUTO
         2 000563   200012 633500                    EPPR3   CONTROLLER_NUMBER,,AUTO
         2 000564   200045 453500                    STP3    WILD_CARD+5,,AUTO
         2 000565   200047 452500                    STP2    WILD_CARD+7,,AUTO
         2 000566   200047 236100                    LDQ     WILD_CARD+7,,AUTO
         2 000567   000015 036000 3                  ADLQ    13
         2 000570   200044 756100                    STQ     WILD_CARD+4,,AUTO
         2 000571   200032 634500                    EPPR4   JCL,,AUTO
         2 000572   200043 454500                    STP4    WILD_CARD+3,,AUTO
         2 000573   200016 635500                    EPPR5   DEV$,,AUTO
         2 000574   200042 455500                    STP5    WILD_CARD+2,,AUTO
         2 000575   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000576   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000577   000000 701000 xent               TSX1    ASL$DISP_ONE_LINE_DEVICE
         2 000600   000000 011000                    NOP     0

      299    15727    6                     NEW_CONTROLLER = %NO#;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:44   

  15727  2 000601   200036 450100                    STZ     NEW_CONTROLLER,,AUTO

      300    15728    6                     END;  /*  Disp  */

  15728  2 000602   000651 710000 2                  TRA     s:15741

      301    15729    6                  ELSE DO;

      302    15730    6                     FMT_BUF = '%1/   %A  %A  %A  %2D  %A  %2D';

  15730  2 000603   040000 100400                    MLR     fill='040'O
         2 000604   000046 000036 1                  ADSC9   KL_LINEDEV+12            cn=0,n=30
         2 000605   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      303    15731    6                     FDS.FMT_.BOUND = 29;

  15731  2 000606   000000 236000 xsym               LDQ     FDS
         2 000607   177777 376007                    ANQ     65535,DL
         2 000610   000016 276000 3                  ORQ     14
         2 000611   000000 756000 xsym               STQ     FDS

      304    15732    6                     FDS.NVECS# = 6;

  15732  2 000612   000006 235007                    LDA     6,DL
         2 000613   000011 755000 xsym               STA     FDS+9

      305    15733    6                     FMT_VEC (0) = VECTOR (LINE_STR);

  15733  2 000614   000020 237000 3                  LDAQ    16
         2 000615   000000 755000 xsym               STA     FMT_VEC
         2 000616   000001 756000 xsym               STQ     FMT_VEC+1

      306    15734    6                     FMT_VEC (1) = VECTOR (LINE_NAME.TEXT);

  15734  2 000617   000017 235000 3                  LDA     15
         2 000620   200042 452500                    STP2    WILD_CARD+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:45   
         2 000621   200042 236100                    LDQ     WILD_CARD+2,,AUTO
         2 000622   000015 036000 3                  ADLQ    13
         2 000623   000002 755000 xsym               STA     FMT_VEC+2
         2 000624   000003 756000 xsym               STQ     FMT_VEC+3

      307    15735    6                     FMT_VEC (2) = VECTOR (CONTROLLER_STR);

  15735  2 000625   000022 237000 3                  LDAQ    18
         2 000626   000004 755000 xsym               STA     FMT_VEC+4
         2 000627   000005 756000 xsym               STQ     FMT_VEC+5

      308    15736    6                     FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);

  15736  2 000630   177640 235007                    LDA     65440,DL
         2 000631   200011 236100                    LDQ     CONT$,,AUTO
         2 000632   000002 036003                    ADLQ    2,DU
         2 000633   000006 755000 xsym               STA     FMT_VEC+6
         2 000634   000007 756000 xsym               STQ     FMT_VEC+7

      309    15737    6                     FMT_VEC (4) = VECTOR (DEVICE_STR);

  15737  2 000635   000024 237000 3                  LDAQ    20
         2 000636   000010 755000 xsym               STA     FMT_VEC+8
         2 000637   000011 756000 xsym               STQ     FMT_VEC+9

      310    15738    6                     FMT_VEC (5) = VECTOR (KL$LINEDEV.DEVICE#);

  15738  2 000640   177640 235007                    LDA     65440,DL
         2 000641   200016 236100                    LDQ     DEV$,,AUTO
         2 000642   000026 036000 3                  ADLQ    22
         2 000643   000012 755000 xsym               STA     FMT_VEC+10
         2 000644   000013 756000 xsym               STQ     FMT_VEC+11

      311    15739    6                     CALL X$FORMAT (FDS);

  15739  2 000645   000005 630400 3                  EPPR0   5
         2 000646   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:46   
         2 000647   000000 701000 xent               TSX1    X$FORMAT
         2 000650   000000 011000                    NOP     0

      312    15740    6                     END;  /*  ~ disp  */

      313    15741    5                  DISP_DEVICES = DISP_DEVICES + 1;

  15741  2 000651   200022 054100                    AOS     DISP_DEVICES,,AUTO

      314    15742    5                  END;  /* Do while DEV$ < END$  */

  15742  2 000652   200016 236100                    LDQ     DEV$,,AUTO
         2 000653   200027 116100                    CMPQ    END$,,AUTO
         2 000654   000452 602000 2                  TNC     s:15710

      315    15743    4   END_J:
      316    15744    4               END; /*  Do forever  */

  15744  2 000655   000412 710000 2     END_J        TRA     s:15703
         2 000656   000677 710000 2                  TRA     s:15771

      317    15745    3   END_FOREVER:
      318    15746    3            END;  /*  Whenreturn  */
      319    15747    3         WHENALTRETURN DO;

      320    15748    3            IF MERR_CODE.CODE = %E$NOKEY

  15748  2 000657   000000 236000 xsym               LDQ     ERR_CODE
         2 000660   377770 376007                    ANQ     131064,DL
         2 000661   001020 116007                    CMPQ    528,DL
         2 000662   000673 601000 2                  TNZ     s:15768

      321    15749    4            THEN DO;

      322    15750    4               AS_FIELD1 = LINE_NAME;

  15750  2 000663   000000 100500                    MLR     fill='000'O
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:47   
         2 000664   200033 000011                    ADSC9   LINE_NAME,,AUTO          cn=0,n=9
         2 000665   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      323    15751                    %SCREAM( ERR#=E$LINE_NO_EXIST2, MID='L', LEVEL=ERROR );

  15763  2 000666   000027 630400 3                  EPPR0   23
         2 000667   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000670   000000 701000 xent               TSX1    ASH$ERROR
         2 000671   000000 011000                    NOP     0

      324    15766    4               END;  /*  Error = nokey  */

  15766  2 000672   000677 710000 2                  TRA     s:15771

      325    15767    4            ELSE DO;

      326    15768    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  15768  2 000673   000031 630400 3                  EPPR0   25
         2 000674   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000675   000000 701000 xent               TSX1    ASA$ERROR
         2 000676   000000 011000                    NOP     0

      327    15769    4               END;  /* Error ~= nokey */

      328    15770    3            END;  /*  Whenaltreturn  */

      329    15771    2         GOTO FINISH_UP;

  15771  2 000677   001261 710000 2                  TRA     FINISH_UP

      330    15772    2         END; /*  Else  */
      331    15773    1   CALL ASB$PREC_HLP ;

  15773  2 000700   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000701   000000 701000 xent               TSX1    ASB$PREC_HLP
         2 000702   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:48   

      332    15774    2   DO FOREVER;

      333    15775
      334    15776    3      DO UNTIL LINE$DREC.ATYP = %KLAT_LINE# ;

      335    15777    3         I = DSEG1SIZE;

  15777  2 000703   000000 235000 xsym               LDA     DSEG1SIZE
         2 000704   200030 755100                    STA     I,,AUTO

      336    15778    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)

  15778  2 000705   000010 236000 3                  LDQ     8
         2 000706   200044 756100                    STQ     WILD_CARD+4,,AUTO
         2 000707   200030 630500                    EPPR0   I,,AUTO
         2 000710   200043 450500                    STP0    WILD_CARD+3,,AUTO
         2 000711   000011 236000 3                  LDQ     9
         2 000712   200042 756100                    STQ     WILD_CARD+2,,AUTO
         2 000713   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000714   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000715   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         2 000716   000720 702000 2                  TSX2    s:15780
         2 000717   000731 710000 2                  TRA     s:15783

      337    15779    4         WHENALTRETURN DO;

      338    15780    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

  15780  2 000720   000000 236000 xsym               LDQ     ERR_CODE
         2 000721   377770 376007                    ANQ     131064,DL
         2 000722   000060 116007                    CMPQ    48,DL
         2 000723   000730 600000 2                  TZE     s:15781

  15780  2 000724   000033 630400 3                  EPPR0   27
         2 000725   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000726   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:49   
         2 000727   000000 011000                    NOP     0

      339    15781    4            GOTO FINISH_UP;

  15781  2 000730   001261 710000 2                  TRA     FINISH_UP

      340    15782    4            END;  /*  Whenaltreturn  */
      341    15783    3         END;  /*  Do until we find a line record  */

  15783  2 000731   000000 470400 xsym               LDP0    DSEG1$
         2 000732   000000 236100                    LDQ     0,,PR0
         2 000733   777000 376003                    ANQ     -512,DU
         2 000734   005000 116003                    CMPQ    2560,DU
         2 000735   000703 601000 2                  TNZ     s:15777

      342    15784    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;

  15784  2 000736   000000 124400                    SCM     mask='000'O
         2 000737   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000740   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000741   200030 000100                    ARG     I,,AUTO

      343    15785    2      IF I > 8 THEN I = 8;

  15785  2 000742   200030 235100                    LDA     I,,AUTO
         2 000743   000011 115007                    CMPA    9,DL
         2 000744   000747 602000 2                  TNC     s:15786

  15785  2 000745   000010 236007                    LDQ     8,DL
         2 000746   200030 756100                    STQ     I,,AUTO

      344    15786    2      CURRENT_LINE = SUBSTR(USERS_KEY.TXTC,0,I);

  15786  2 000747   200030 720100                    LXL0    I,,AUTO
         2 000750   040100 100440                    MLR     fill='040'O
         2 000751   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         2 000752   200013 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=8
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:50   

      345    15787    3      IF WILD_CARD THEN DO;

  15787  2 000753   200040 234100                    SZN     WILD_CARD,,AUTO
         2 000754   001004 605000 2                  TPL     s:15797

      346    15788    3         J = LINE_NAME.COUNT;

  15788  2 000755   200033 236100                    LDQ     LINE_NAME,,AUTO
         2 000756   000033 772000                    QRL     27
         2 000757   200031 756100                    STQ     J,,AUTO

      347    15789    3         CALL ASB$WILD_MATCH (I, CURRENT_LINE, J, LINE_NAME.TEXT)

  15789  2 000760   200046 452500                    STP2    WILD_CARD+6,,AUTO
         2 000761   200046 236100                    LDQ     WILD_CARD+6,,AUTO
         2 000762   000015 036000 3                  ADLQ    13
         2 000763   200045 756100                    STQ     WILD_CARD+5,,AUTO
         2 000764   200031 631500                    EPPR1   J,,AUTO
         2 000765   200044 451500                    STP1    WILD_CARD+4,,AUTO
         2 000766   200013 633500                    EPPR3   CURRENT_LINE,,AUTO
         2 000767   200043 453500                    STP3    WILD_CARD+3,,AUTO
         2 000770   200030 634500                    EPPR4   I,,AUTO
         2 000771   200042 454500                    STP4    WILD_CARD+2,,AUTO
         2 000772   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000773   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000774   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000775   000777 702000 2                  TSX2    s:15791
         2 000776   001004 710000 2                  TRA     s:15797

      348    15790    4         WHENALTRETURN DO;

      349    15791    4            IF CURRENT_LINE > END_KEY.TEXT THEN

  15791  2 000777   040100 106500                    CMPC    fill='040'O
         2 001000   200025 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 001001   200013 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=8
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:51   
         2 001002   001261 602000 2                  TNC     FINISH_UP

      350    15792    4               GOTO FINISH_UP;
      351    15793    4            ELSE
      352    15794    4               GOTO END_FOREVER;

  15794  2 001003   000656 710000 2                  TRA     END_J+1

      353    15795    4            END;  /*  Whenaltreturn  */
      354    15796    3         END; /*  WILD_CARD  */

      355    15797    2      NEW_LINE = %YES#;

  15797  2 001004   400000 236003                    LDQ     -131072,DU
         2 001005   200037 756100                    STQ     NEW_LINE,,AUTO

      356    15798    2      DISP_LINES = DISP_LINES + 1;

  15798  2 001006   200023 054100                    AOS     DISP_LINES,,AUTO

      357    15799    2      CONT$ = DSEG1$;

  15799  2 001007   000000 236000 xsym               LDQ     DSEG1$
         2 001010   200011 756100                    STQ     CONT$,,AUTO

      358    15800    2      ARS = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;

  15800  2 001011   000000 470400 xsym               LDP0    DSEG1$
         2 001012   000017 235100                    LDA     15,,PR0
         2 001013   000020 035007                    ADLA    16,DL
         2 001014   200004 755100                    STA     ARS,,AUTO

      359    15801    3      DO FOREVER;

      360    15802    3        CALL ASL$FIND_CONTROLLER (DSEG1$, ARS, CONT_NAME, CONT$) ALTRET (END_FOREVER2)
             15802                  ;

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:52   
  15802  2 001015   200011 630500                    EPPR0   CONT$,,AUTO
         2 001016   200045 450500                    STP0    WILD_CARD+5,,AUTO
         2 001017   200010 631500                    EPPR1   CONT_NAME,,AUTO
         2 001020   200044 451500                    STP1    WILD_CARD+4,,AUTO
         2 001021   200004 633500                    EPPR3   ARS,,AUTO
         2 001022   200043 453500                    STP3    WILD_CARD+3,,AUTO
         2 001023   000011 236000 3                  LDQ     9
         2 001024   200042 756100                    STQ     WILD_CARD+2,,AUTO
         2 001025   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 001026   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001027   000000 701000 xent               TSX1    ASL$FIND_CONTROLLER
         2 001030   001260 702000 2                  TSX2    END_FOREVER2

      361    15803    3         NEW_CONTROLLER = %YES#;

  15803  2 001031   400000 236003                    LDQ     -131072,DU
         2 001032   200036 756100                    STQ     NEW_CONTROLLER,,AUTO

      362    15804    3         DISP_CONTROLLERS = DISP_CONTROLLERS + 1;

  15804  2 001033   200021 054100                    AOS     DISP_CONTROLLERS,,AUTO

      363    15805    3         DEV_ARS = SIZEW (KL_CONTROLLER) + (KL$CONTROLLER.BLKHDR.NSUBS * SIZEW(
             15805                  KL_LINEDEV));

  15805  2 001034   200011 470500                    LDP0    CONT$,,AUTO
         2 001035   000100 101500                    MRL     fill='000'O
         2 001036   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 001037   200042 000004                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=4
         2 001040   200042 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001041   000002 736000                    QLS     2
         2 001042   000004 036007                    ADLQ    4,DL
         2 001043   200015 756100                    STQ     DEV_ARS,,AUTO

      364    15806    3         DEV$ = CONT$;

  15806  2 001044   200011 236100                    LDQ     CONT$,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:53   
         2 001045   200016 756100                    STQ     DEV$,,AUTO

      365    15807    3         END$ = PINCRW (CONT$, DEV_ARS);

  15807  2 001046   200015 236100                    LDQ     DEV_ARS,,AUTO
         2 001047   000022 736000                    QLS     18
         2 001050   200011 036100                    ADLQ    CONT$,,AUTO
         2 001051   200027 756100                    STQ     END$,,AUTO

      366    15808    4         DO WHILE DEV$ < END$ ;

  15808  2 001052   200016 116100                    CMPQ    DEV$,,AUTO
         2 001053   001257 602000 2                  TNC     END_J2
         2 001054   001257 600000 2                  TZE     END_J2

      367    15809    4            CALL ASL$FIND_LINE_DEVICE (CONT$, DEV_ARS, DEVICE_NAME, DEV$) ALTRET (
             15809                     END_J2);

  15809  2 001055   200016 630500                    EPPR0   DEV$,,AUTO
         2 001056   200045 450500                    STP0    WILD_CARD+5,,AUTO
         2 001057   200017 631500                    EPPR1   DEVICE_NAME,,AUTO
         2 001060   200044 451500                    STP1    WILD_CARD+4,,AUTO
         2 001061   200015 633500                    EPPR3   DEV_ARS,,AUTO
         2 001062   200043 453500                    STP3    WILD_CARD+3,,AUTO
         2 001063   200011 634500                    EPPR4   CONT$,,AUTO
         2 001064   200042 454500                    STP4    WILD_CARD+2,,AUTO
         2 001065   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 001066   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001067   000000 701000 xent               TSX1    ASL$FIND_LINE_DEVICE
         2 001070   001257 702000 2                  TSX2    END_J2

      368    15810    5            IF DISP THEN DO;

  15810  2 001071   200020 234100                    SZN     DISP,,AUTO
         2 001072   001205 605000 2                  TPL     s:15830

      369    15811    6               IF NEW_LINE AND NOT JCL THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:54   

  15811  2 001073   200037 234100                    SZN     NEW_LINE,,AUTO
         2 001074   001125 605000 2                  TPL     s:15818
         2 001075   200032 234100                    SZN     JCL,,AUTO
         2 001076   001125 604000 2                  TMI     s:15818

      370    15812    6                  CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', CURRENT_LINE);

  15812  2 001077   040000 100400                    MLR     fill='040'O
         2 001100   000040 000006 1                  ADSC9   KL_LINEDEV+6             cn=0,n=6
         2 001101   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 001102   040000 100400                    MLR     fill='040'O
         2 001103   000000 000004 1                  ADSC9   LINE_STR                 cn=0,n=4
         2 001104   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
         2 001105   040000 100400                    MLR     fill='040'O
         2 001106   000041 000004 1                  ADSC9   KL_LINEDEV+7             cn=0,n=4
         2 001107   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 001110   040000 100500                    MLR     fill='040'O
         2 001111   200013 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=8
         2 001112   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      371    15813    6                  FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 17;

  15813  2 001113   000000 236000 xsym               LDQ     FDS
         2 001114   177777 376007                    ANQ     65535,DL
         2 001115   000013 276000 3                  ORQ     11
         2 001116   000000 756000 xsym               STQ     FDS

      372    15814    6                  FDS.NVECS# = 0;

  15814  2 001117   000011 450000 xsym               STZ     FDS+9

      373    15815    6                  CALL X$FORMAT (FDS);

  15815  2 001120   000005 630400 3                  EPPR0   5
         2 001121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001122   000000 701000 xent               TSX1    X$FORMAT
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:55   
         2 001123   000000 011000                    NOP     0

      374    15816    6                  NEW_LINE = %NO#;

  15816  2 001124   200037 450100                    STZ     NEW_LINE,,AUTO

      375    15817    6                  END;  /*  New line and not jcl  */

      376    15818    6               IF NEW_CONTROLLER AND NOT JCL THEN DO;

  15818  2 001125   200036 234100                    SZN     NEW_CONTROLLER,,AUTO
         2 001126   001161 605000 2                  TPL     s:15825
         2 001127   200032 234100                    SZN     JCL,,AUTO
         2 001130   001161 604000 2                  TMI     s:15825

      377    15819    6                  CALL CONCAT (FMT_BUF, '      ', CONTROLLER_STR, '    %2D');

  15819  2 001131   040000 100400                    MLR     fill='040'O
         2 001132   000041 000006 1                  ADSC9   KL_LINEDEV+7             cn=0,n=6
         2 001133   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 001134   040000 100400                    MLR     fill='040'O
         2 001135   000011 000012 1                  ADSC9   CONTROLLER_STR           cn=0,n=10
         2 001136   000001 400012 xsym               ADSC9   FMT_BUF+1                cn=2,n=10
         2 001137   040000 100400                    MLR     fill='040'O
         2 001140   000044 000007 1                  ADSC9   KL_LINEDEV+10            cn=0,n=7
         2 001141   000004 000357 xsym               ADSC9   FMT_BUF+4                cn=0,n=239

      378    15820    6                  FDS.FMT_.BOUND = LENGTHC(CONTROLLER_STR) + 12;

  15820  2 001142   000000 236000 xsym               LDQ     FDS
         2 001143   177777 376007                    ANQ     65535,DL
         2 001144   000014 276000 3                  ORQ     12
         2 001145   000000 756000 xsym               STQ     FDS

      379    15821    6                  FDS.NVECS# = 1;

  15821  2 001146   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:56   
         2 001147   000011 755000 xsym               STA     FDS+9

      380    15822    6                  FMT_VEC (0) = VECTOR (KL$CONTROLLER.CONT#);

  15822  2 001150   177640 235007                    LDA     65440,DL
         2 001151   200011 236100                    LDQ     CONT$,,AUTO
         2 001152   000002 036003                    ADLQ    2,DU
         2 001153   000000 755000 xsym               STA     FMT_VEC
         2 001154   000001 756000 xsym               STQ     FMT_VEC+1

      381    15823    6                  CALL X$FORMAT (FDS);

  15823  2 001155   000005 630400 3                  EPPR0   5
         2 001156   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001157   000000 701000 xent               TSX1    X$FORMAT
         2 001160   000000 011000                    NOP     0

      382    15824    6                  END;  /*  New controller and not jcl  */

      383    15825    5               CONTROLLER_NUMBER = KL$CONTROLLER.CONT#;

  15825  2 001161   200011 470500                    LDP0    CONT$,,AUTO
         2 001162   000100 101500                    MRL     fill='000'O
         2 001163   000002 000001                    ADSC9   2,,PR0                   cn=0,n=1
         2 001164   200012 000004                    ADSC9   CONTROLLER_NUMBER,,AUTO  cn=0,n=4

      384    15826    5               CALL ASL$DISP_ONE_LINE_DEVICE (DEV$, JCL, CURRENT_LINE,
             15826                        CONTROLLER_NUMBER, NEW_CONTROLLER );

  15826  2 001165   200036 631500                    EPPR1   NEW_CONTROLLER,,AUTO
         2 001166   200046 451500                    STP1    WILD_CARD+6,,AUTO
         2 001167   200012 633500                    EPPR3   CONTROLLER_NUMBER,,AUTO
         2 001170   200045 453500                    STP3    WILD_CARD+5,,AUTO
         2 001171   200013 634500                    EPPR4   CURRENT_LINE,,AUTO
         2 001172   200044 454500                    STP4    WILD_CARD+4,,AUTO
         2 001173   200032 635500                    EPPR5   JCL,,AUTO
         2 001174   200043 455500                    STP5    WILD_CARD+3,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:57   
         2 001175   200016 636500                    EPPR6   DEV$,,AUTO
         2 001176   200042 456500                    STP6    WILD_CARD+2,,AUTO
         2 001177   200042 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 001200   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001201   000000 701000 xent               TSX1    ASL$DISP_ONE_LINE_DEVICE
         2 001202   000000 011000                    NOP     0

      385    15827    5               NEW_CONTROLLER = %NO#;

  15827  2 001203   200036 450100                    STZ     NEW_CONTROLLER,,AUTO

      386    15828    5               END;  /*  Disp  */

  15828  2 001204   001253 710000 2                  TRA     s:15841

      387    15829    5            ELSE DO;

      388    15830    5               FMT_BUF = '%1/   %A  %A  %A  %2D  %A  %2D';

  15830  2 001205   040000 100400                    MLR     fill='040'O
         2 001206   000046 000036 1                  ADSC9   KL_LINEDEV+12            cn=0,n=30
         2 001207   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      389    15831    5               FDS.FMT_.BOUND = 29;

  15831  2 001210   000000 236000 xsym               LDQ     FDS
         2 001211   177777 376007                    ANQ     65535,DL
         2 001212   000016 276000 3                  ORQ     14
         2 001213   000000 756000 xsym               STQ     FDS

      390    15832    5               FDS.NVECS# = 6;

  15832  2 001214   000006 235007                    LDA     6,DL
         2 001215   000011 755000 xsym               STA     FDS+9

      391    15833    5               FMT_VEC (0) = VECTOR (LINE_STR);

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:58   
  15833  2 001216   000020 237000 3                  LDAQ    16
         2 001217   000000 755000 xsym               STA     FMT_VEC
         2 001220   000001 756000 xsym               STQ     FMT_VEC+1

      392    15834    5               FMT_VEC (1) = VECTOR (CURRENT_LINE);

  15834  2 001221   000017 235000 3                  LDA     15
         2 001222   200042 452500                    STP2    WILD_CARD+2,,AUTO
         2 001223   200042 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001224   000013 036003                    ADLQ    11,DU
         2 001225   000002 755000 xsym               STA     FMT_VEC+2
         2 001226   000003 756000 xsym               STQ     FMT_VEC+3

      393    15835    5               FMT_VEC (2) = VECTOR (CONTROLLER_STR);

  15835  2 001227   000022 237000 3                  LDAQ    18
         2 001230   000004 755000 xsym               STA     FMT_VEC+4
         2 001231   000005 756000 xsym               STQ     FMT_VEC+5

      394    15836    5               FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);

  15836  2 001232   177640 235007                    LDA     65440,DL
         2 001233   200011 236100                    LDQ     CONT$,,AUTO
         2 001234   000002 036003                    ADLQ    2,DU
         2 001235   000006 755000 xsym               STA     FMT_VEC+6
         2 001236   000007 756000 xsym               STQ     FMT_VEC+7

      395    15837    5               FMT_VEC (4) = VECTOR (DEVICE_STR);

  15837  2 001237   000024 237000 3                  LDAQ    20
         2 001240   000010 755000 xsym               STA     FMT_VEC+8
         2 001241   000011 756000 xsym               STQ     FMT_VEC+9

      396    15838    5               FMT_VEC (5) = VECTOR (KL$LINEDEV.DEVICE#);

  15838  2 001242   177640 235007                    LDA     65440,DL
         2 001243   200016 236100                    LDQ     DEV$,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:59   
         2 001244   000026 036000 3                  ADLQ    22
         2 001245   000012 755000 xsym               STA     FMT_VEC+10
         2 001246   000013 756000 xsym               STQ     FMT_VEC+11

      397    15839    5               CALL X$FORMAT (FDS);

  15839  2 001247   000005 630400 3                  EPPR0   5
         2 001250   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001251   000000 701000 xent               TSX1    X$FORMAT
         2 001252   000000 011000                    NOP     0

      398    15840    5               END;  /*  ~ disp  */

      399    15841    4            DISP_DEVICES = DISP_DEVICES + 1;

  15841  2 001253   200022 054100                    AOS     DISP_DEVICES,,AUTO

      400    15842    4            END;  /* Do while DEV$ < END$  */

  15842  2 001254   200016 236100                    LDQ     DEV$,,AUTO
         2 001255   200027 116100                    CMPQ    END$,,AUTO
         2 001256   001055 602000 2                  TNC     s:15809

      401    15843    3   END_J2:
      402    15844    3         END; /*  Do forever  */

  15844  2 001257   001015 710000 2     END_J2       TRA     s:15802

      403    15845    2   END_FOREVER2:
      404    15846    2      END;  /*  Do forever  */

  15846  2 001260   000703 710000 2     END_FOREVER2 TRA     s:15777

      405    15847    1   FINISH_UP:
      406    15848    2   IF NOT DISP THEN DO;

  15848  2 001261   200020 234100       FINISH_UP    SZN     DISP,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:60   
         2 001262   001277 604000 2                  TMI     s:15854

      407    15849    2      FMT_BUF = '%\%/';

  15849  2 001263   040000 100400                    MLR     fill='040'O
         2 001264   000057 000004 1                  ADSC9   KL_LINEDEV+21            cn=0,n=4
         2 001265   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      408    15850    2      FDS.FMT_.BOUND = 3;

  15850  2 001266   000000 236000 xsym               LDQ     FDS
         2 001267   177777 376007                    ANQ     65535,DL
         2 001270   600000 276007                    ORQ     -65536,DL
         2 001271   000000 756000 xsym               STQ     FDS

      409    15851    2      FDS.NVECS# = 0;

  15851  2 001272   000011 450000 xsym               STZ     FDS+9

      410    15852    2      CALL X$FORMAT(FDS);

  15852  2 001273   000005 630400 3                  EPPR0   5
         2 001274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001275   000000 701000 xent               TSX1    X$FORMAT
         2 001276   000000 011000                    NOP     0

      411    15853    2      END; /*  If not disp  */

      412    15854    2   IF NOT JCL THEN DO;

  15854  2 001277   200032 234100                    SZN     JCL,,AUTO
         2 001300   001447 604000 2                  TMI     s:15901

      413    15855    2      FMT_VEC(0) = VECTOR (DISP_DEVICES);

  15855  2 001301   777640 235007                    LDA     -96,DL
         2 001302   200042 452500                    STP2    WILD_CARD+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:61   
         2 001303   200042 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001304   000022 036003                    ADLQ    18,DU
         2 001305   000000 755000 xsym               STA     FMT_VEC
         2 001306   000001 756000 xsym               STQ     FMT_VEC+1

      414    15856    2      IF DISP_DEVICES = 1 THEN

  15856  2 001307   200022 235100                    LDA     DISP_DEVICES,,AUTO
         2 001310   000001 115007                    CMPA    1,DL
         2 001311   001316 601000 2                  TNZ     s:15861

      415    15857    3      DO;

      416    15858    3         FMT_VEC(1) = VECTOR (DEVICE_STR);

  15858  2 001312   000024 237000 3                  LDAQ    20
         2 001313   000002 755000 xsym               STA     FMT_VEC+2
         2 001314   000003 756000 xsym               STQ     FMT_VEC+3

      417    15859    3         END; /*  DISP_DEVICES = 1  */

  15859  2 001315   001321 710000 2                  TRA     s:15863

      418    15860    3      ELSE DO;

      419    15861    3         FMT_VEC(1) = VECTOR (DEVICES_STR);

  15861  2 001316   000034 237000 3                  LDAQ    28
         2 001317   000002 755000 xsym               STA     FMT_VEC+2
         2 001320   000003 756000 xsym               STQ     FMT_VEC+3

      420    15862    3         END; /*  DISP_DEVICES ~= 1  */

      421    15863    2      IF DISP THEN

  15863  2 001321   200020 234100                    SZN     DISP,,AUTO
         2 001322   001327 605000 2                  TPL     s:15868
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:62   

      422    15864    3      DO;

      423    15865    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15865  2 001323   000036 237000 3                  LDAQ    30
         2 001324   000004 755000 xsym               STA     FMT_VEC+4
         2 001325   000005 756000 xsym               STQ     FMT_VEC+5

      424    15866    3         END; /*  If disp  */

  15866  2 001326   001332 710000 2                  TRA     s:15870

      425    15867    3      ELSE DO;

      426    15868    3         FMT_VEC(2) = VECTOR (LIST_STR);

  15868  2 001327   000040 237000 3                  LDAQ    32
         2 001330   000004 755000 xsym               STA     FMT_VEC+4
         2 001331   000005 756000 xsym               STQ     FMT_VEC+5

      427    15869    3         END; /*  If ~ disp  */

      428    15870    2      FDS.NVECS# = 3;

  15870  2 001332   000003 235007                    LDA     3,DL
         2 001333   000011 755000 xsym               STA     FDS+9

      429    15871    2      FMT_BUF = '   %5D %A %A.';

  15871  2 001334   040000 100400                    MLR     fill='040'O
         2 001335   000060 000015 1                  ADSC9   KL_LINEDEV+22            cn=0,n=13
         2 001336   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      430    15872    2      FDS.FMT_.BOUND = 12;

  15872  2 001337   000000 236000 xsym               LDQ     FDS
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:63   
         2 001340   177777 376007                    ANQ     65535,DL
         2 001341   000003 276003                    ORQ     3,DU
         2 001342   000000 756000 xsym               STQ     FDS

      431    15873    2      CALL X$FORMAT(FDS);

  15873  2 001343   000005 630400 3                  EPPR0   5
         2 001344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001345   000000 701000 xent               TSX1    X$FORMAT
         2 001346   000000 011000                    NOP     0

      432    15874    2      FMT_VEC(0) = VECTOR (DISP_CONTROLLERS);

  15874  2 001347   777640 235007                    LDA     -96,DL
         2 001350   200042 452500                    STP2    WILD_CARD+2,,AUTO
         2 001351   200042 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001352   000021 036003                    ADLQ    17,DU
         2 001353   000000 755000 xsym               STA     FMT_VEC
         2 001354   000001 756000 xsym               STQ     FMT_VEC+1

      433    15875    2      IF DISP_CONTROLLERS = 1 THEN

  15875  2 001355   200021 235100                    LDA     DISP_CONTROLLERS,,AUTO
         2 001356   000001 115007                    CMPA    1,DL
         2 001357   001364 601000 2                  TNZ     s:15880

      434    15876    3      DO;

      435    15877    3         FMT_VEC(1) = VECTOR (CONTROLLER_STR);

  15877  2 001360   000022 237000 3                  LDAQ    18
         2 001361   000002 755000 xsym               STA     FMT_VEC+2
         2 001362   000003 756000 xsym               STQ     FMT_VEC+3

      436    15878    3         END; /*  DISP_CONTROLLERS = 1  */

  15878  2 001363   001367 710000 2                  TRA     s:15882
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:64   

      437    15879    3      ELSE DO;

      438    15880    3         FMT_VEC(1) = VECTOR (CONTROLLERS_STR);

  15880  2 001364   000042 237000 3                  LDAQ    34
         2 001365   000002 755000 xsym               STA     FMT_VEC+2
         2 001366   000003 756000 xsym               STQ     FMT_VEC+3

      439    15881    3         END; /*  DISP_CONTROLLERS ~= 1  */

      440    15882    2      FMT_VEC(2) = VECTOR (FOUND_STR);

  15882  2 001367   000044 237000 3                  LDAQ    36
         2 001370   000004 755000 xsym               STA     FMT_VEC+4
         2 001371   000005 756000 xsym               STQ     FMT_VEC+5

      441    15883    2      FDS.NVECS# = 3;

  15883  2 001372   000003 235007                    LDA     3,DL
         2 001373   000011 755000 xsym               STA     FDS+9

      442    15884    2      FMT_BUF = '   %5D %A %A.';

  15884  2 001374   040000 100400                    MLR     fill='040'O
         2 001375   000060 000015 1                  ADSC9   KL_LINEDEV+22            cn=0,n=13
         2 001376   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      443    15885    2      FDS.FMT_.BOUND = 12;

  15885  2 001377   000000 236000 xsym               LDQ     FDS
         2 001400   177777 376007                    ANQ     65535,DL
         2 001401   000003 276003                    ORQ     3,DU
         2 001402   000000 756000 xsym               STQ     FDS

      444    15886    2      CALL X$FORMAT(FDS);

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:65   
  15886  2 001403   000005 630400 3                  EPPR0   5
         2 001404   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001405   000000 701000 xent               TSX1    X$FORMAT
         2 001406   000000 011000                    NOP     0

      445    15887    2      FMT_VEC(0) = VECTOR (DISP_LINES);

  15887  2 001407   777640 235007                    LDA     -96,DL
         2 001410   200042 452500                    STP2    WILD_CARD+2,,AUTO
         2 001411   200042 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001412   000023 036003                    ADLQ    19,DU
         2 001413   000000 755000 xsym               STA     FMT_VEC
         2 001414   000001 756000 xsym               STQ     FMT_VEC+1

      446    15888    2      IF DISP_LINES = 1 THEN

  15888  2 001415   200023 235100                    LDA     DISP_LINES,,AUTO
         2 001416   000001 115007                    CMPA    1,DL
         2 001417   001424 601000 2                  TNZ     s:15893

      447    15889    3      DO;

      448    15890    3         FMT_VEC(1) = VECTOR (LINE_STR);

  15890  2 001420   000020 237000 3                  LDAQ    16
         2 001421   000002 755000 xsym               STA     FMT_VEC+2
         2 001422   000003 756000 xsym               STQ     FMT_VEC+3

      449    15891    3         END; /*  DISP_LINES = 1  */

  15891  2 001423   001427 710000 2                  TRA     s:15895

      450    15892    3      ELSE DO;

      451    15893    3         FMT_VEC(1) = VECTOR (LINES_STR);

  15893  2 001424   000046 237000 3                  LDAQ    38
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:66   
         2 001425   000002 755000 xsym               STA     FMT_VEC+2
         2 001426   000003 756000 xsym               STQ     FMT_VEC+3

      452    15894    3         END; /*  DISP_LINES ~= 1  */

      453    15895    2      FMT_VEC(2) = VECTOR (FOUND_STR);

  15895  2 001427   000044 237000 3                  LDAQ    36
         2 001430   000004 755000 xsym               STA     FMT_VEC+4
         2 001431   000005 756000 xsym               STQ     FMT_VEC+5

      454    15896    2      FDS.NVECS# = 3;

  15896  2 001432   000003 235007                    LDA     3,DL
         2 001433   000011 755000 xsym               STA     FDS+9

      455    15897    2      FMT_BUF = '   %5D %A %A.';

  15897  2 001434   040000 100400                    MLR     fill='040'O
         2 001435   000060 000015 1                  ADSC9   KL_LINEDEV+22            cn=0,n=13
         2 001436   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      456    15898    2      FDS.FMT_.BOUND = 12;

  15898  2 001437   000000 236000 xsym               LDQ     FDS
         2 001440   177777 376007                    ANQ     65535,DL
         2 001441   000003 276003                    ORQ     3,DU
         2 001442   000000 756000 xsym               STQ     FDS

      457    15899    2      CALL X$FORMAT(FDS);

  15899  2 001443   000005 630400 3                  EPPR0   5
         2 001444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001445   000000 701000 xent               TSX1    X$FORMAT
         2 001446   000000 011000                    NOP     0

      458    15900    2      END; /* Not jcl */
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:67   

      459    15901    1   RETURN;

  15901  2 001447   000000 702200 xent               TSX2  ! X66_ARET
      460    15902    1   END ASL$LIST_ALL_LINE_DEVICES;
      461    15903        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:68   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINE_DEVICES.
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:69   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_LINE_DEVICES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/c CHAR(11)    r     1 CONTROLLERS_STR           11-0-0/c CHAR(10)    r     1 CONTROLLER_STR
     6-0-0/c CHAR(12)    r     1 DEVICES_STR                3-0-0/c CHAR(11)    r     1 DEVICE_STR
    21-0-0/c CHAR(9)     r     1 DISPLAY_STR               24-0-0/c CHAR(5)     r     1 FOUND_STR
    26-0-0/c STRC(144)   r     1 KL_CONTROLLER             32-0-0/c STRC(144)   r     1 KL_LINEDEV
     1-0-0/c CHAR(5)     r     1 LINES_STR                  0-0-0/c CHAR(4)     r     1 LINE_STR
    17-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_LINES                  4-0-0/w UBIN        r     1 ARS
     5-0-0/w STRC(108)   r     1 BEGIN_KEY                 11-0-0/w PTR         r     1 CONT$
    12-0-0/w UBIN        r     1 CONTROLLER_NUMBER         10-0-0/c STRC(27)    r     1 CONT_NAME
    13-0-0/c CHAR(8)     r     1 CURRENT_LINE              16-0-0/w PTR         r     1 DEV$
    17-0-0/c STRC(27)    r     1 DEVICE_NAME               15-0-0/w UBIN        r     1 DEV_ARS
    20-0-0/b BIT         r     1 DISP                      21-0-0/w SBIN        r     1 DISP_CONTROLLERS
    22-0-0/w SBIN        r     1 DISP_DEVICES              23-0-0/w SBIN        r     1 DISP_LINES
    27-0-0/w PTR         r     1 END$                      24-0-0/w STRC(108)   r     1 END_KEY
    30-0-0/w UBIN        r     1 I                         31-0-0/w UBIN        r     1 J
    32-0-0/b BIT         r     1 JCL                       33-0-0/c STRC(81)    r     1 LINE_NAME
    36-0-0/b BIT         r     1 NEW_CONTROLLER            37-0-0/b BIT         r     1 NEW_LINE
    40-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:70   
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL$CONTROLLER              0-0-0/c STRC(144)   r     1 KL$LINEDEV
     0-0-0/w STRC(576)   r     1 LINE$DREC                  0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_LINE_DEVICES requires 808 words for executable code.
   Procedure ASL$LIST_ALL_LINE_DEVICES requires 40 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:71   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:72   
          MINI XREF LISTING

ALL_LINES
     15230**DCL     15650<<ASSIGN  15652<<ASSIGN  15667>>IF
ARS
     15231**DCL     15701<<ASSIGN  15703<>CALL    15800<<ASSIGN  15802<>CALL
ASA$ERROR
     14707**DCL-ENT 15768--CALL
ASA_BRKS_LOC
     11839**DCL     11839--REDEF
ASB$PREC_HLP
     14695**DCL-ENT 15773--CALL
ASB$READ_HLP
     14698**DCL-ENT 15678--CALL
ASB$READ_HLP_SEQ
     14701**DCL-ENT 15778--CALL
ASB$WILD_MATCH
     14719**DCL-ENT 15789--CALL
ASH$ERROR
     14704**DCL-ENT 15694--CALL    15763--CALL    15780--CALL
ASL$DISP_ONE_LINE_DEVICE
     14716**DCL-ENT 15726--CALL    15826--CALL
ASL$FIND_CONTROLLER
     14713**DCL-ENT 15703--CALL    15802--CALL
ASL$FIND_LINE_DEVICE
     14710**DCL-ENT 15710--CALL    15809--CALL
AS_DEFAULT.BANNER_PERM
     12532**DCL     12533--REDEF
AS_DEFAULT.BUDGET.MACCT
     12437**DCL     12441--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12450**DCL     12453--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12433**DCL     12435--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:73   
AS_DEFAULT.BUDGET.PMAXC
     12428**DCL     12430--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12548**DCL     12549--REDEF   12550--REDEF
AS_DEFAULT_DREC.PASSWORD
     13802**DCL     13806--REDEF
AS_DEFAULT_DREC.RENAME
     13825**DCL     13826--REDEF
AS_DFLT.BANNER_PERM
     12354**DCL     12355--REDEF
AS_DFLT.BUDGET.MACCT
     12259**DCL     12263--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12272**DCL     12275--REDEF
AS_DFLT.BUDGET.PACCUM
     12255**DCL     12257--REDEF
AS_DFLT.BUDGET.PMAXC
     12250**DCL     12252--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12370**DCL     12371--REDEF   12372--REDEF
AS_FE_MODE
     11705**DCL     11706--REDEF
AS_FIELD1
     11835**DCL     15681<<ASSIGN  15750<<ASSIGN
AS_MODE
     11702**DCL     11704--REDEF
AS_MOD_USER.ACCESS
     14567**DCL     14568--REDEF
AS_MOD_USER.BANNER
     14554**DCL     14555--REDEF
AS_MOD_USER.BANNER_PERM
     14556**DCL     14557--REDEF
AS_MOD_USER.BILL
     14562**DCL     14563--REDEF
AS_MOD_USER.CPROC
     14558**DCL     14559--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:74   
AS_MOD_USER.FEBILL
     14638**DCL     14639--REDEF
AS_MOD_USER.FECXTMEM
     14655**DCL     14656--REDEF
AS_MOD_USER.FEMINTS
     14640**DCL     14641--REDEF
AS_MOD_USER.FEMMEM
     14651**DCL     14652--REDEF
AS_MOD_USER.FEMTIME
     14649**DCL     14650--REDEF
AS_MOD_USER.FEPPRIV
     14646**DCL     14648--REDEF
AS_MOD_USER.FEPRIV
     14643**DCL     14645--REDEF
AS_MOD_USER.FORCE_BIT
     14552**DCL     14553--REDEF
AS_MOD_USER.KEY
     14634**DCL     14636--REDEF
AS_MOD_USER.LASTCPROC
     14560**DCL     14561--REDEF
AS_MOD_USER.LIMITS.DO_
     14608**DCL     14609--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14624**DCL     14625--REDEF
AS_MOD_USER.LIMITS.LO
     14604**DCL     14605--REDEF
AS_MOD_USER.LIMITS.MEM
     14600**DCL     14601--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14628**DCL     14629--REDEF
AS_MOD_USER.LIMITS.PDIS
     14616**DCL     14617--REDEF
AS_MOD_USER.LIMITS.PO
     14612**DCL     14613--REDEF
AS_MOD_USER.LIMITS.TDIS
     14620**DCL     14621--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:75   
AS_MOD_USER.LIMITS.TIME
     14596**DCL     14597--REDEF
AS_MOD_USER.MAXENQ
     14577**DCL     14578--REDEF
AS_MOD_USER.PERM_BIT
     14550**DCL     14551--REDEF
AS_MOD_USER.PPRIV
     14572**DCL     14574--REDEF
AS_MOD_USER.PRIOB
     14579**DCL     14580--REDEF
AS_MOD_USER.PRIV
     14569**DCL     14571--REDEF
AS_MOD_USER.QUAN
     14575**DCL     14576--REDEF
AS_MOD_USER.SETUP
     14548**DCL     14549--REDEF
AS_PROJECT.BANNER_PERM
     12888**DCL     12889--REDEF
AS_PROJECT.BUDGET.MACCT
     12793**DCL     12797--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12806**DCL     12809--REDEF
AS_PROJECT.BUDGET.PACCUM
     12789**DCL     12791--REDEF
AS_PROJECT.BUDGET.PMAXC
     12784**DCL     12786--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12904**DCL     12905--REDEF   12906--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13066**DCL     13067--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12971**DCL     12975--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12984**DCL     12987--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12967**DCL     12969--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:76   
AS_PROJECT_DFLT.BUDGET.PMAXC
     12962**DCL     12964--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13082**DCL     13083--REDEF   13084--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14288**DCL     14292--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14311**DCL     14312--REDEF
AS_PROJECT_DREC.PASSWORD
     14126**DCL     14130--REDEF
AS_PROJECT_DREC.RENAME
     14149**DCL     14150--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12710**DCL     12711--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12615**DCL     12619--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12628**DCL     12631--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12611**DCL     12613--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12606**DCL     12608--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12726**DCL     12727--REDEF   12728--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13964**DCL     13968--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13987**DCL     13988--REDEF
AS_USERS.BANNER_PERM
     12176**DCL     12177--REDEF
AS_USERS.BUDGET.MACCT
     12081**DCL     12085--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12094**DCL     12097--REDEF
AS_USERS.BUDGET.PACCUM
     12077**DCL     12079--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:77   
AS_USERS.BUDGET.PMAXC
     12072**DCL     12074--REDEF
AS_USERS.SETUP_CHRA.TXT
     12192**DCL     12193--REDEF   12194--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13244**DCL     13245--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13149**DCL     13153--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13162**DCL     13165--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13145**DCL     13147--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13140**DCL     13142--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13260**DCL     13261--REDEF   13262--REDEF
BEGIN_KEY.COUNT
     15233**DCL     15657<<ASSIGN
BEGIN_KEY.TEXT
     15234**DCL     15653<<ASSIGN  15656<<ASSIGN  15671>>CALLBLT
CODE
     11832**DCL     15579<<ASSIGN  15592>>DOSELCT 15610>>ASSIGN
CONT$
     15238**DCL     14942--IMP-PTR 15700<<ASSIGN  15703<>CALL    15706>>ASSIGN  15707>>ASSIGN  15708>>ASSIGN
     15710<>CALL    15722>>ASSIGN  15725>>ASSIGN  15736>>ASSIGN  15799<<ASSIGN  15802<>CALL    15805>>ASSIGN
     15806>>ASSIGN  15807>>ASSIGN  15809<>CALL    15822>>ASSIGN  15825>>ASSIGN  15836>>ASSIGN
CONTROLLERS_STR
     15273**DCL     15880--ASSIGN
CONTROLLER_NUMBER
     15239**DCL     15725<<ASSIGN  15726<>CALL    15825<<ASSIGN  15826<>CALL
CONTROLLER_STR
     15272**DCL     15719>>CALLBLT 15720--ASSIGN  15735--ASSIGN  15819>>CALLBLT 15820--ASSIGN  15835--ASSIGN
     15877--ASSIGN
CONT_NAME
     15235**DCL     15703<>CALL    15802<>CALL
CONT_NAME.COUNT
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:78   
     15236**DCL     15585<<ASSIGN  15619<<ASSIGN
CONT_NAME.TEXT
     15237**DCL     15584<<ASSIGN  15618<<ASSIGN
CURRENT_LINE
     15240**DCL     15786<<ASSIGN  15789<>CALL    15791>>IF      15812>>CALLBLT 15826<>CALL    15834--ASSIGN
DEV$
     15242**DCL     15093--IMP-PTR 15707<<ASSIGN  15709>>DOWHILE 15710<>CALL    15726<>CALL    15738>>ASSIGN
     15806<<ASSIGN  15808>>DOWHILE 15809<>CALL    15826<>CALL    15838>>ASSIGN
DEVICES_STR
     15271**DCL     15639>>CALLBLT 15640--ASSIGN  15643>>CALLBLT 15644--ASSIGN  15861--ASSIGN
DEVICE_NAME
     15243**DCL     15710<>CALL    15809<>CALL
DEVICE_NAME.COUNT
     15244**DCL     15587<<ASSIGN  15624<<ASSIGN
DEVICE_NAME.TEXT
     15245**DCL     15586<<ASSIGN  15623<<ASSIGN
DEVICE_STR
     15270**DCL     15737--ASSIGN  15837--ASSIGN  15858--ASSIGN
DEV_ARS
     15241**DCL     15706<<ASSIGN  15708>>ASSIGN  15710<>CALL    15805<<ASSIGN  15807>>ASSIGN  15809<>CALL
DISP
     15246**DCL     15596<<ASSIGN  15601<<ASSIGN  15610<<ASSIGN  15711>>IF      15810>>IF      15848>>IF
     15863>>IF
DISPLAY_STR
     15275**DCL     15865--ASSIGN
DISP_CONTROLLERS
     15247**DCL     15589<<ASSIGN  15705<<ASSIGN  15705>>ASSIGN  15804<<ASSIGN  15804>>ASSIGN  15874--ASSIGN
     15875>>IF
DISP_DEVICES
     15248**DCL     15588<<ASSIGN  15712>>IF      15741<<ASSIGN  15741>>ASSIGN  15841<<ASSIGN  15841>>ASSIGN
     15855--ASSIGN  15856>>IF
DISP_LINES
     15249**DCL     15590<<ASSIGN  15699<<ASSIGN  15798<<ASSIGN  15798>>ASSIGN  15887--ASSIGN  15888>>IF
DSEG1$
     11840**DCL     14824--IMP-PTR 15678<>CALL    15680>>IF      15700>>ASSIGN  15701>>ASSIGN  15703<>CALL
     15776>>DOUNTIL 15778<>CALL    15799>>ASSIGN  15800>>ASSIGN  15802<>CALL
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:79   
DSEG1SIZE
     11841**DCL     15677>>ASSIGN  15777>>ASSIGN
END$
     15253**DCL     15708<<ASSIGN  15709>>DOWHILE 15807<<ASSIGN  15808>>DOWHILE
END_FOREVER
     15746**LABEL   15703--CALLALT 15794--GOTO
END_FOREVER2
     15846**LABEL   15802--CALLALT
END_J
     15744**LABEL   15710--CALLALT
END_J2
     15844**LABEL   15809--CALLALT
END_KEY.COUNT
     15251**DCL     15659<<ASSIGN
END_KEY.TEXT
     15252**DCL     15654<<ASSIGN  15658<<CALLBLT 15791>>IF
ERR_CODE
     11834**DCL     11835--REDEF
FDS
     11731**DCL     15647<>CALL    15716<>CALL    15723<>CALL    15739<>CALL    15815<>CALL    15823<>CALL
     15839<>CALL    15852<>CALL    15873<>CALL    15886<>CALL    15899<>CALL
FDS.FMT_.BOUND
     11736**DCL     15640<<ASSIGN  15644<<ASSIGN  15714<<ASSIGN  15720<<ASSIGN  15731<<ASSIGN  15813<<ASSIGN
     15820<<ASSIGN  15831<<ASSIGN  15850<<ASSIGN  15872<<ASSIGN  15885<<ASSIGN  15898<<ASSIGN
FDS.NVECS#
     11759**DCL     15637<<ASSIGN  15715<<ASSIGN  15721<<ASSIGN  15732<<ASSIGN  15814<<ASSIGN  15821<<ASSIGN
     15832<<ASSIGN  15851<<ASSIGN  15870<<ASSIGN  15883<<ASSIGN  15896<<ASSIGN
FDS.TABDFLT#
     11797**DCL     15646<<ASSIGN
FINISH_UP
     15848**LABEL   15771--GOTO    15781--GOTO    15792--GOTO
FMT_BUF
     11830**DCL     15639<<CALLBLT 15643<<CALLBLT 15713<<CALLBLT 15719<<CALLBLT 15730<<ASSIGN  15812<<CALLBLT
     15819<<CALLBLT 15830<<ASSIGN  15849<<ASSIGN  15871<<ASSIGN  15884<<ASSIGN  15897<<ASSIGN
FMT_VEC
     11830**DCL     15722<<ASSIGN  15733<<ASSIGN  15734<<ASSIGN  15735<<ASSIGN  15736<<ASSIGN  15737<<ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:80   
     15738<<ASSIGN  15822<<ASSIGN  15833<<ASSIGN  15834<<ASSIGN  15835<<ASSIGN  15836<<ASSIGN  15837<<ASSIGN
     15838<<ASSIGN  15855<<ASSIGN  15858<<ASSIGN  15861<<ASSIGN  15865<<ASSIGN  15868<<ASSIGN  15874<<ASSIGN
     15877<<ASSIGN  15880<<ASSIGN  15882<<ASSIGN  15887<<ASSIGN  15890<<ASSIGN  15893<<ASSIGN  15895<<ASSIGN
FOUND_STR
     15276**DCL     15882--ASSIGN  15895--ASSIGN
I
     15254**DCL     15611<<DOINDEX 15612>>IF      15613>>ASSIGN  15613>>ASSIGN  15614>>ASSIGN  15617>>IF
     15618>>ASSIGN  15618>>ASSIGN  15619>>ASSIGN  15622>>IF      15623>>ASSIGN  15623>>ASSIGN  15624>>ASSIGN
     15627>>IF      15655<<CALLBLT 15656>>ASSIGN  15658>>CALLBLT 15659>>ASSIGN  15677<<ASSIGN  15678<>CALL
     15777<<ASSIGN  15778<>CALL    15784<<CALLBLT 15785>>IF      15785<<ASSIGN  15786>>ASSIGN  15789<>CALL
J
     15255**DCL     15788<<ASSIGN  15789<>CALL
JCL
     15256**DCL     15580<<ASSIGN  15597<<ASSIGN  15603<<ASSIGN  15605<<ASSIGN  15629<<ASSIGN  15638>>IF
     15712>>IF      15718>>IF      15726<>CALL    15811>>IF      15818>>IF      15826<>CALL    15854>>IF
KL$CONTROLLER.BLKHDR.NSUBS
     14990**DCL     15706>>ASSIGN  15805>>ASSIGN
KL$CONTROLLER.CONT#
     15059**DCL     15722--ASSIGN  15725>>ASSIGN  15736--ASSIGN  15822--ASSIGN  15825>>ASSIGN  15836--ASSIGN
KL$LINEDEV.DEVICE#
     15211**DCL     15738--ASSIGN  15838--ASSIGN
KL_CONTROLLER
     15292**DCL     15706--ASSIGN  15805--ASSIGN
KL_DEFAULT.PASSWORD
     14450**DCL     14454--REDEF
KL_DEFAULT.RENAME
     14473**DCL     14474--REDEF
KL_DFLT.PASSWORD
     13640**DCL     13644--REDEF
KL_DFLT.RENAME
     13663**DCL     13664--REDEF
KL_DREC.PASSWORD
     13478**DCL     13482--REDEF
KL_DREC.RENAME
     13501**DCL     13502--REDEF
KL_DREC_CNT.PASSWORD
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:81   
     13365**DCL     13369--REDEF
KL_DREC_CNT.RENAME
     13388**DCL     13389--REDEF
KL_LINEDEV
     15441**DCL     15706--ASSIGN  15805--ASSIGN
LINE$DREC
     14824**DCL     15701--ASSIGN  15800--ASSIGN
LINE$DREC.ATYP
     14829**DCL     15680>>IF      15776>>DOUNTIL
LINE$DREC.NWINFO
     14922**DCL     15701>>ASSIGN  15800>>ASSIGN
LINE$DREC.PASSWORD
     14882**DCL     14886--REDEF
LINE$DREC.RENAME
     14905**DCL     14906--REDEF
LINES_STR
     15269**DCL     15893--ASSIGN
LINE_NAME
     15257**DCL     15681>>ASSIGN  15750>>ASSIGN
LINE_NAME.COUNT
     15258**DCL     15583<<ASSIGN  15614<<ASSIGN  15788>>ASSIGN
LINE_NAME.TEXT
     15259**DCL     15582<<ASSIGN  15613<<ASSIGN  15649>>IF      15655>>CALLBLT 15656>>ASSIGN  15658>>CALLBLT
     15675>>CALLBLT 15713>>CALLBLT 15726<>CALL    15734--ASSIGN  15789<>CALL
LINE_STR
     15268**DCL     15713>>CALLBLT 15714--ASSIGN  15733--ASSIGN  15812>>CALLBLT 15813--ASSIGN  15833--ASSIGN
     15890--ASSIGN
LIST_STR
     15274**DCL     15868--ASSIGN
MERR_CODE
     11835**DCL     15780<>CALL
MERR_CODE.CODE
     11835**DCL     15748>>IF      15780>>IF
NEW_CONTROLLER
     15260**DCL     15704<<ASSIGN  15718>>IF      15726<>CALL    15727<<ASSIGN  15803<<ASSIGN  15818>>IF
     15826<>CALL    15827<<ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:82   
NEW_LINE
     15261**DCL     15797<<ASSIGN  15811>>IF      15816<<ASSIGN
NODE$
     11832**DCL     14732--IMP-PTR
P$B.CODE
     14740**DCL     15579>>ASSIGN  15603>>ASSIGN  15605>>ASSIGN  15612>>IF      15617>>IF      15622>>IF
     15627>>IF
P$B.NSUBLKS
     14744**DCL     15602>>IF      15604>>IF      15611>>DOINDEX
P$B.SUBLK$
     14765**DCL     15579>>ASSIGN  15602>>IF      15603>>ASSIGN  15603>>ASSIGN  15604>>IF      15605>>ASSIGN
     15605>>ASSIGN  15612>>IF      15613>>ASSIGN  15613>>ASSIGN  15614>>ASSIGN  15617>>IF      15618>>ASSIGN
     15618>>ASSIGN  15619>>ASSIGN  15622>>IF      15623>>ASSIGN  15623>>ASSIGN  15624>>ASSIGN  15627>>IF
P$S.COUNT
     14801**DCL     14804--IMP-SIZ 15613>>ASSIGN  15614>>ASSIGN  15618>>ASSIGN  15619>>ASSIGN  15623>>ASSIGN
     15624>>ASSIGN
P$S.TEXT
     14804**DCL     15613>>ASSIGN  15618>>ASSIGN  15623>>ASSIGN
PROJ_KEY.TEXT
     11712**DCL     11712--REDEF
PROJ_KEY.TXT.PROJECT
     11712**DCL     11712--REDEF
P_PCB.OUT$
     11880**DCL     15579>>ASSIGN  15602>>IF      15603>>ASSIGN  15604>>IF      15605>>ASSIGN  15611>>DOINDEX
     15612>>IF      15613>>ASSIGN  15613>>ASSIGN  15614>>ASSIGN  15617>>IF      15618>>ASSIGN  15618>>ASSIGN
     15619>>ASSIGN  15622>>IF      15623>>ASSIGN  15623>>ASSIGN  15624>>ASSIGN  15627>>IF
REMEM_VAR
     11838**DCL     11838--REDEF
REM_FCMD
     11838**DCL     11839--REDEF
USERS_KEY
     11709**DCL     15668<<ASSIGN  15768<>CALL
USERS_KEY.COUNT
     11709**DCL     15672<<ASSIGN  15676<<ASSIGN
USERS_KEY.TEXT
     11709**DCL     11710--REDEF   11710--REDEF   11710--REDEF   11711--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINE_DEVICES File=ASL$LIST_LINE_DEVICES.:E05TSI  TUE 07/29/97 10:12 Page:83   
USERS_KEY.TXTC
     11710**DCL     15671<<CALLBLT 15675<<CALLBLT 15784>>CALLBLT 15786>>ASSIGN
WILD_CARD
     15262**DCL     15581<<ASSIGN  15660<<ASSIGN  15663<<ASSIGN  15670>>IF      15787>>IF
X$FORMAT
     14721**DCL-ENT 15647--CALL    15716--CALL    15723--CALL    15739--CALL    15815--CALL    15823--CALL
     15839--CALL    15852--CALL    15873--CALL    15886--CALL    15899--CALL

PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:84   
      462        1        /*T***********************************************************/
      463        2        /*T*                                                         */
      464        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      465        4        /*T*                                                         */
      466        5        /*T***********************************************************/
      467        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:85   
      468        7        /*M* ASL$FIND_LINE_DEVICE: Routine to find line devices.*/
      469        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      470        9              ECU=3,CSU=3,SDI=3                                           */
      471       10        ASL$FIND_LINE_DEVICE: PROC (CONT$, SIZE, DEV_NAME, DEV$) ALTRET;
      472       11        /**********************************************************/
      473       12
      474       13        /*D* NAME:     ASL$FIND_LINE_DEVICE
      475       14             CALL:     CALL ASL$FIND_LINE_DEVICE (CONT$, SIZE, DEV_NAME, DEV$)
      476       15             INPUT:
      477       16                       CONT$      - Pointer to a kl_controller structure.
      478       17                       SIZE       - The size in words of the kl_controller
      479       18                                      and the kl_linedev structures attached
      480       19                                      to the kl_controller.
      481       20                       DEV_NAME   - Textc device name.
      482       21             OUTPUT:   DEV$ - Pointer to a kl_linedev structure.
      483       22             DESCRIPTION:  ASL$FIND_LINE_DEVICE is the routine to handle
      484       23                           the finding of line devices for the line in data
      485       24                           segment 1.  This routine will cycle through the
      486       25                           controllers devices, pointed at by CONT$, matching
      487       26                           the device names against DEV_NAME and then
      488       27                           returning, if it finds a match.  If no match is
      489       28                           found then this routine will altreturn after
      490       29                           setting DEV$ to NIL.
      491       30        */
      492       31        /********************************************************************/
      493       32        /*   Include files   include files   include files   include files  */
      494       33        /********************************************************************/
      495       34        %INCLUDE AS_PERR_C;
      496      636        %INCLUDE AS_SUPER_C;
      497     1071        %INCLUDE AS_SUBS_C;
      498     2485        %INCLUDE AS_MAC_C;
      499     2565        %INCLUDE AS_ENTRIES_M;
      500     3615        %INCLUDE AS_SSUBS_C;
      501     3707        %INCLUDE B_ERRORS_C;
      502     4834        %INCLUDE CP_6_SUBS;
      503     5374        %INCLUDE KL_SUPER_C;
      504     8276        %INCLUDE XU_MACRO_C;
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:86   
      505    11382        %INCLUDE XU_FORMAT_C;
      506    11544        %INCLUDE AS_SUPER_R;
      507    14560        /********************************************************************/
      508    14561        /*   Parameters      parameters      parameters      parameters     */
      509    14562        /********************************************************************/
      510    14563    1   DCL CONT$                  PTR;
      511    14564    1   DCL 1 DEV_NAME,
      512    14565    1          2 COUNT             UBIN BYTE UNAL,
      513    14566    1          2 TEXT              CHAR(2) CALIGNED;
      514    14567    1   DCL DEV$                   PTR;
      515    14568    1   DCL SIZE                   UBIN;
      516    14569        /********************************************************************/
      517    14570        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      518    14571        /********************************************************************/
      519    14572        %ASH$ERROR ;
      520    14575        %ASB$WILD_MATCH ;
      521    14578        /********************************************************************/
      522    14579        /*   Local based     local based     local based     local based    */
      523    14580        /********************************************************************/
      524    14581    1   DCL 1 TEXT$C BASED ALIGNED,
      525    14582    1          2 CNT                UBIN(9) UNAL ,
      526    14583    1          2 TEXT               CHAR(TEXT$C.CNT) UNAL;
      527    14584        %KL_DREC      ( NAME      = LINE$DREC,
      528    14585                        STCLASS   = "BASED(DSEG1$)",
      529    14586                        LAST      = ",");
      530    14699        %KL_LN3270    ( NAME      = LN,
      531    14700                        LVL       = 2,
      532    14701                        STCLASS   = BASED);
      533    14843        %KL_LINEDEV   ( NAME      = KL$LINEDEV,
      534    14844                        LVL       = 1,
      535    14845                        STCLASS   = "BASED( DEV$ )" );
      536    14994        /********************************************************************/
      537    14995        /*   Auto data       auto data       auto data       auto data      */
      538    14996        /********************************************************************/
      539    14997    1   DCL ALL                    BIT(1);
      540    14998    1   DCL DEVNUM                 UBIN;
      541    14999    1   DCL DEV_START$             PTR ;
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:87   
      542    15000    1   DCL DEV_STOP$              PTR ;
      543    15001    1   DCL I                      UBIN;
      544    15002    1   DCL TEMPDEV                CHAR(2);
      545    15003    1   DCL WILD_CARD              BIT(1);
      546    15004        /********************************************************************/
      547    15005        /*   Constant data   constant data   constant data   constant data  */
      548    15006        /********************************************************************/
      549    15007        %KL_CONTROLLER   ( LVL = 1, STCLASS = CONSTANT );
      550    15156        %KL_LINEDEV      ( LVL = 1, STCLASS = CONSTANT );
      551    15305        /********************************************************************/
      552    15306        /*   Procedure       procedure       procedure       procedure      */
      553    15307        /********************************************************************/
      554    15308    1   DEV_START$ = CONT$;
      555    15309    1   DEV_STOP$ = PINCRW(DEV_START$, SIZE);
      556    15310    1   ALL = %NO#;
      557    15311    1   WILD_CARD = %NO#;
      558    15312    1   IF DEV$ = CONT$ THEN
      559    15313    1      DEV$ = PINCRW (CONT$, SIZEW (KL_CONTROLLER));
      560    15314    1   ELSE
      561    15315    1      DEV$ = PINCRW (DEV$, SIZEW (KL_LINEDEV));
      562    15316
      563    15317    2   IF DEV$ >= DEV_STOP$ THEN DO;
      564    15318    2      DEV$ = ADDR (NIL);
      565    15319    2      ALTRETURN ;
      566    15320    2      END; /*  DEV$ has gone too far  */
      567    15321    1   IF DEV_NAME.TEXT = '?' THEN
      568    15322    1      ALL = %YES#;
      569    15323    2   ELSE DO;
      570    15324    2      CALL INDEX (I, '?', DEV_NAME.TEXT)
      571    15325    3      WHENRETURN DO;
      572    15326    3         WILD_CARD = %YES#;
      573    15327    3         END; /*  Whenreturn  */
      574    15328    3      WHENALTRETURN DO;
      575    15329    3         CALL CHARBIN( DEVNUM, DEV_NAME.TEXT );
      576    15330    3         END; /*  Whenaltreturn  */
      577    15331    2      IF (WILD_CARD AND SUBSTR(DEV_NAME.TEXT,0,1) > '3') OR
      578    15332    3           (NOT WILD_CARD AND DEVNUM > 31) THEN DO;
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:88   
      579    15333        /*E*  ERROR:  ASL-E$BAD_DEV_NUM-C
      580    15334              MESSAGE: Illegal DEVICE number.
      581    15335              MESSAGE1: A DEVICE number must be between 0 and 31.
      582    15336        */
      583    15337              %SCREAM( ERR#=E$BAD_DEV_NUM, LEVEL=ERROR, MID='L' );
      584    15352    3         DEV$ = ADDR (NIL);
      585    15353    3         ALTRETURN;
      586    15354    3         END;   /*  Bad controller number  */
      587    15355    2      END;  /*  Whenaltreturn  */
      588    15356                                                  /* Find device. */
      589    15357    2   DO WHILE DEV$ < DEV_STOP$;
      590    15358    3      IF WILD_CARD THEN DO;
      591    15359    3         CALL BINCHAR (TEMPDEV, KL$LINEDEV.DEVICE#);
      592    15360    3         CALL ASB$WILD_MATCH (2, TEMPDEV, 2, DEV_NAME.TEXT) ALTRET (LOOP_END);
      593    15361    3         END;   /*  If WILD_CARD  */
      594    15362    2      ELSE IF NOT WILD_CARD AND NOT ALL THEN
      595    15363    2            IF KL$LINEDEV.DEVICE# ~= DEVNUM THEN GOTO LOOP_END;
      596    15364    2      RETURN;
      597    15365    2   LOOP_END:
      598    15366    2      DEV$ = PINCRW (DEV$, SIZEW (KL_LINEDEV));
      599    15367    2      END; /*  Do while DEV$ < DEV_STOP$  */
      600    15368    1   DEV$ = ADDR (NIL);
      601    15369    1   ALTRETURN ;
      602    15370    1   END ASL$FIND_LINE_DEVICE;
      603    15371        %EOD;

PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:89   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_LINE_DEVICE.

   Procedure ASL$FIND_LINE_DEVICE requires 120 words for executable code.
   Procedure ASL$FIND_LINE_DEVICE requires 18 words of local(AUTO) storage.

PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:90   

 Object Unit name= ASL$FIND_LINE_DEVICE                       File name= ASL$LIST_LINE_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:14:38.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      9     11  ASL$FIND_LINE_DEVICE
    2   Proc  even  none   120    170  ASL$FIND_LINE_DEVICE
    3  RoData even  none     4      4  ASL$FIND_LINE_DEVICE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        4  ASL$FIND_LINE_DEVICE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASH$ERROR
 yes     yes           Std       4 ASB$WILD_MATCH
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:91   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG1$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:92   


      462        1        /*T***********************************************************/
      463        2        /*T*                                                         */
      464        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      465        4        /*T*                                                         */
      466        5        /*T***********************************************************/
      467        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:93   
      468        7        /*M* ASL$FIND_LINE_DEVICE: Routine to find line devices.*/
      469        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      470        9              ECU=3,CSU=3,SDI=3                                           */
      471       10        ASL$FIND_LINE_DEVICE: PROC (CONT$, SIZE, DEV_NAME, DEV$) ALTRET;

     10  2 000000   000000 700200 xent  ASL$FIND_LI* TSX0  ! X66_AUTO_4
         2 000001   000022 000004                    ZERO    18,4

      472       11        /**********************************************************/
      473       12
      474       13        /*D* NAME:     ASL$FIND_LINE_DEVICE
      475       14             CALL:     CALL ASL$FIND_LINE_DEVICE (CONT$, SIZE, DEV_NAME, DEV$)
      476       15             INPUT:
      477       16                       CONT$      - Pointer to a kl_controller structure.
      478       17                       SIZE       - The size in words of the kl_controller
      479       18                                      and the kl_linedev structures attached
      480       19                                      to the kl_controller.
      481       20                       DEV_NAME   - Textc device name.
      482       21             OUTPUT:   DEV$ - Pointer to a kl_linedev structure.
      483       22             DESCRIPTION:  ASL$FIND_LINE_DEVICE is the routine to handle
      484       23                           the finding of line devices for the line in data
      485       24                           segment 1.  This routine will cycle through the
      486       25                           controllers devices, pointed at by CONT$, matching
      487       26                           the device names against DEV_NAME and then
      488       27                           returning, if it finds a match.  If no match is
      489       28                           found then this routine will altreturn after
      490       29                           setting DEV$ to NIL.
      491       30        */
      492       31        /********************************************************************/
      493       32        /*   Include files   include files   include files   include files  */
      494       33        /********************************************************************/
      495       34        %INCLUDE AS_PERR_C;
      496      636        %INCLUDE AS_SUPER_C;
      497     1071        %INCLUDE AS_SUBS_C;
      498     2485        %INCLUDE AS_MAC_C;
      499     2565        %INCLUDE AS_ENTRIES_M;
      500     3615        %INCLUDE AS_SSUBS_C;
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:94   
      501     3707        %INCLUDE B_ERRORS_C;
      502     4834        %INCLUDE CP_6_SUBS;
      503     5374        %INCLUDE KL_SUPER_C;
      504     8276        %INCLUDE XU_MACRO_C;
      505    11382        %INCLUDE XU_FORMAT_C;
      506    11544        %INCLUDE AS_SUPER_R;
      507    14560        /********************************************************************/
      508    14561        /*   Parameters      parameters      parameters      parameters     */
      509    14562        /********************************************************************/
      510    14563    1   DCL CONT$                  PTR;
      511    14564    1   DCL 1 DEV_NAME,
      512    14565    1          2 COUNT             UBIN BYTE UNAL,
      513    14566    1          2 TEXT              CHAR(2) CALIGNED;
      514    14567    1   DCL DEV$                   PTR;
      515    14568    1   DCL SIZE                   UBIN;
      516    14569        /********************************************************************/
      517    14570        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      518    14571        /********************************************************************/
      519    14572        %ASH$ERROR ;
      520    14575        %ASB$WILD_MATCH ;
      521    14578        /********************************************************************/
      522    14579        /*   Local based     local based     local based     local based    */
      523    14580        /********************************************************************/
      524    14581    1   DCL 1 TEXT$C BASED ALIGNED,
      525    14582    1          2 CNT                UBIN(9) UNAL ,
      526    14583    1          2 TEXT               CHAR(TEXT$C.CNT) UNAL;
      527    14584        %KL_DREC      ( NAME      = LINE$DREC,
      528    14585                        STCLASS   = "BASED(DSEG1$)",
      529    14586                        LAST      = ",");
      530    14699        %KL_LN3270    ( NAME      = LN,
      531    14700                        LVL       = 2,
      532    14701                        STCLASS   = BASED);
      533    14843        %KL_LINEDEV   ( NAME      = KL$LINEDEV,
      534    14844                        LVL       = 1,
      535    14845                        STCLASS   = "BASED( DEV$ )" );
      536    14994        /********************************************************************/
      537    14995        /*   Auto data       auto data       auto data       auto data      */
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:95   
      538    14996        /********************************************************************/
      539    14997    1   DCL ALL                    BIT(1);
      540    14998    1   DCL DEVNUM                 UBIN;
      541    14999    1   DCL DEV_START$             PTR ;
      542    15000    1   DCL DEV_STOP$              PTR ;
      543    15001    1   DCL I                      UBIN;
      544    15002    1   DCL TEMPDEV                CHAR(2);
      545    15003    1   DCL WILD_CARD              BIT(1);
      546    15004        /********************************************************************/
      547    15005        /*   Constant data   constant data   constant data   constant data  */
      548    15006        /********************************************************************/
      549    15007        %KL_CONTROLLER   ( LVL = 1, STCLASS = CONSTANT );
      550    15156        %KL_LINEDEV      ( LVL = 1, STCLASS = CONSTANT );
      551    15305        /********************************************************************/
      552    15306        /*   Procedure       procedure       procedure       procedure      */
      553    15307        /********************************************************************/
      554    15308    1   DEV_START$ = CONT$;

  15308  2 000002   200003 470500                    LDP0    @CONT$,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   200011 756100                    STQ     DEV_START$,,AUTO

      555    15309    1   DEV_STOP$ = PINCRW(DEV_START$, SIZE);

  15309  2 000005   200004 471500                    LDP1    @SIZE,,AUTO
         2 000006   100000 720100                    LXL0    0,,PR1
         2 000007   000000 636010                    EAQ     0,X0
         2 000010   200011 036100                    ADLQ    DEV_START$,,AUTO
         2 000011   200012 756100                    STQ     DEV_STOP$,,AUTO

      556    15310    1   ALL = %NO#;

  15310  2 000012   200007 450100                    STZ     ALL,,AUTO

      557    15311    1   WILD_CARD = %NO#;

  15311  2 000013   200015 450100                    STZ     WILD_CARD,,AUTO
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:96   

      558    15312    1   IF DEV$ = CONT$ THEN

  15312  2 000014   200006 473500                    LDP3    @DEV$,,AUTO
         2 000015   300000 236100                    LDQ     0,,PR3
         2 000016   000000 116100                    CMPQ    0,,PR0
         2 000017   000024 601000 2                  TNZ     s:15315

      559    15313    1      DEV$ = PINCRW (CONT$, SIZEW (KL_CONTROLLER));

  15313  2 000020   000000 236100                    LDQ     0,,PR0
         2 000021   000004 036003                    ADLQ    4,DU
         2 000022   300000 756100                    STQ     0,,PR3
         2 000023   000026 710000 2                  TRA     s:15317

      560    15314    1   ELSE
      561    15315    1      DEV$ = PINCRW (DEV$, SIZEW (KL_LINEDEV));

  15315  2 000024   000004 036003                    ADLQ    4,DU
         2 000025   300000 756100                    STQ     0,,PR3

      562    15316
      563    15317    2   IF DEV$ >= DEV_STOP$ THEN DO;

  15317  2 000026   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000027   000033 602000 2                  TNC     s:15321

      564    15318    2      DEV$ = ADDR (NIL);

  15318  2 000030   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000031   300000 756100                    STQ     0,,PR3

      565    15319    2      ALTRETURN ;

  15319  2 000032   000000 702200 xent               TSX2  ! X66_AALT

      566    15320    2      END; /*  DEV$ has gone too far  */
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:97   
      567    15321    1   IF DEV_NAME.TEXT = '?' THEN

  15321  2 000033   200005 474500                    LDP4    @DEV_NAME,,AUTO
         2 000034   040000 106500                    CMPC    fill='040'O
         2 000035   400000 200002                    ADSC9   0,,PR4                   cn=1,n=2
         2 000036   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000037   000043 601000 2                  TNZ     s:15324

      568    15322    1      ALL = %YES#;

  15322  2 000040   400000 236003                    LDQ     -131072,DU
         2 000041   200007 756100                    STQ     ALL,,AUTO
         2 000042   000105 710000 2                  TRA     s:15357

      569    15323    2   ELSE DO;

      570    15324    2      CALL INDEX (I, '?', DEV_NAME.TEXT)

  15324  2 000043   000000 124500                    SCM     mask='000'O
         2 000044   400000 200002                    ADSC9   0,,PR4                   cn=1,n=2
         2 000045   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000046   200013 000100                    ARG     I,,AUTO
         2 000047   000053 606400 2                  TTN     s:15329

      571    15325    3      WHENRETURN DO;

      572    15326    3         WILD_CARD = %YES#;

  15326  2 000050   400000 236003                    LDQ     -131072,DU
         2 000051   200015 756100                    STQ     WILD_CARD,,AUTO

      573    15327    3         END; /*  Whenreturn  */

  15327  2 000052   000061 710000 2                  TRA     s:15331

      574    15328    3      WHENALTRETURN DO;

PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:98   
      575    15329    3         CALL CHARBIN( DEVNUM, DEV_NAME.TEXT );

  15329  2 000053   200005 470500                    LDP0    @DEV_NAME,,AUTO
         2 000054   000100 305500                    DTB
         2 000055   000000 230002                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=2
         2 000056   200016 000010                    NDSC9   WILD_CARD+1,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         2 000057   200017 235100                    LDA     WILD_CARD+2,,AUTO
         2 000060   200010 755100                    STA     DEVNUM,,AUTO

      576    15330    3         END; /*  Whenaltreturn  */

      577    15331    2      IF (WILD_CARD AND SUBSTR(DEV_NAME.TEXT,0,1) > '3') OR

  15331  2 000061   200015 234100                    SZN     WILD_CARD,,AUTO
         2 000062   000070 605000 2                  TPL     s:15331+7
         2 000063   200005 470500                    LDP0    @DEV_NAME,,AUTO
         2 000064   040100 106400                    CMPC    fill='040'O
         2 000065   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000066   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 000067   000075 602000 2                  TNC     s:15349
         2 000070   200015 234100                    SZN     WILD_CARD,,AUTO
         2 000071   000105 604000 2                  TMI     s:15357
         2 000072   200010 235100                    LDA     DEVNUM,,AUTO
         2 000073   000040 115007                    CMPA    32,DL
         2 000074   000105 602000 2                  TNC     s:15357

      578    15332    3           (NOT WILD_CARD AND DEVNUM > 31) THEN DO;

      579    15333        /*E*  ERROR:  ASL-E$BAD_DEV_NUM-C
      580    15334              MESSAGE: Illegal DEVICE number.
      581    15335              MESSAGE1: A DEVICE number must be between 0 and 31.
      582    15336        */
      583    15337              %SCREAM( ERR#=E$BAD_DEV_NUM, LEVEL=ERROR, MID='L' );

  15349  2 000075   000002 630400 3                  EPPR0   2
         2 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000077   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:99   
         2 000100   000000 011000                    NOP     0

      584    15352    3         DEV$ = ADDR (NIL);

  15352  2 000101   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000102   200006 470500                    LDP0    @DEV$,,AUTO
         2 000103   000000 756100                    STQ     0,,PR0

      585    15353    3         ALTRETURN;

  15353  2 000104   000000 702200 xent               TSX2  ! X66_AALT

      586    15354    3         END;   /*  Bad controller number  */
      587    15355    2      END;  /*  Whenaltreturn  */
      588    15356                                                  /* Find device. */
      589    15357    2   DO WHILE DEV$ < DEV_STOP$;

  15357  2 000105   200006 470500                    LDP0    @DEV$,,AUTO
         2 000106   000000 236100                    LDQ     0,,PR0
         2 000107   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000110   000165 603000 2                  TRC     s:15368

      590    15358    3      IF WILD_CARD THEN DO;

  15358  2 000111   200015 234100                    SZN     WILD_CARD,,AUTO
         2 000112   000143 605000 2                  TPL     s:15362

      591    15359    3         CALL BINCHAR (TEMPDEV, KL$LINEDEV.DEVICE#);

  15359  2 000113   200006 470500                    LDP0    @DEV$,,AUTO
         2 000114   000000 471500                    LDP1    0,,PR0
         2 000115   000100 101500                    MRL     fill='000'O
         2 000116   100002 200001                    ADSC9   2,,PR1                   cn=1,n=1
         2 000117   200016 000004                    ADSC9   WILD_CARD+1,,AUTO        cn=0,n=4
         2 000120   200016 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000121   000000 235003                    LDA     0,DU
         2 000122   200020 757100                    STAQ    WILD_CARD+3,,AUTO
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:100  
         2 000123   000100 301500                    BTD
         2 000124   200020 000010                    NDSC9   WILD_CARD+3,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         2 000125   200014 030002                    NDSC9   TEMPDEV,,AUTO            cn=0,s=nosgn,sf=0,n=2

      592    15360    3         CALL ASB$WILD_MATCH (2, TEMPDEV, 2, DEV_NAME.TEXT) ALTRET (LOOP_END);

  15360  2 000126   200005 236100                    LDQ     @DEV_NAME,,AUTO
         2 000127   200000 036007                    ADLQ    65536,DL
         2 000130   000003 235000 3                  LDA     3
         2 000131   200020 757100                    STAQ    WILD_CARD+3,,AUTO
         2 000132   200014 631500                    EPPR1   TEMPDEV,,AUTO
         2 000133   200017 451500                    STP1    WILD_CARD+2,,AUTO
         2 000134   000003 236000 3                  LDQ     3
         2 000135   200016 756100                    STQ     WILD_CARD+1,,AUTO
         2 000136   200016 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000137   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000140   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000141   000157 702000 2                  TSX2    LOOP_END

      593    15361    3         END;   /*  If WILD_CARD  */

  15361  2 000142   000156 710000 2                  TRA     s:15364

      594    15362    2      ELSE IF NOT WILD_CARD AND NOT ALL THEN

  15362  2 000143   000156 604000 2                  TMI     s:15364
         2 000144   200007 234100                    SZN     ALL,,AUTO
         2 000145   000156 604000 2                  TMI     s:15364

      595    15363    2            IF KL$LINEDEV.DEVICE# ~= DEVNUM THEN GOTO LOOP_END;

  15363  2 000146   200006 470500                    LDP0    @DEV$,,AUTO
         2 000147   000000 471500                    LDP1    0,,PR0
         2 000150   000100 101500                    MRL     fill='000'O
         2 000151   100002 200001                    ADSC9   2,,PR1                   cn=1,n=1
         2 000152   200016 000004                    ADSC9   WILD_CARD+1,,AUTO        cn=0,n=4
         2 000153   200016 236100                    LDQ     WILD_CARD+1,,AUTO
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:101  
         2 000154   200010 116100                    CMPQ    DEVNUM,,AUTO
         2 000155   000157 601000 2                  TNZ     LOOP_END

      596    15364    2      RETURN;

  15364  2 000156   000000 702200 xent               TSX2  ! X66_ARET

      597    15365    2   LOOP_END:
      598    15366    2      DEV$ = PINCRW (DEV$, SIZEW (KL_LINEDEV));

  15366  2 000157   200006 470500       LOOP_END     LDP0    @DEV$,,AUTO
         2 000160   000000 236100                    LDQ     0,,PR0
         2 000161   000004 036003                    ADLQ    4,DU
         2 000162   000000 756100                    STQ     0,,PR0

      599    15367    2      END; /*  Do while DEV$ < DEV_STOP$  */

  15367  2 000163   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000164   000111 602000 2                  TNC     s:15358

      600    15368    1   DEV$ = ADDR (NIL);

  15368  2 000165   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000166   000000 756100                    STQ     0,,PR0

      601    15369    1   ALTRETURN ;

  15369  2 000167   000000 702200 xent               TSX2  ! X66_AALT
      602    15370    1   END ASL$FIND_LINE_DEVICE;
      603    15371        %EOD;

PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:102  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_LINE_DEVICE.
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:103  

 **** Variables and constants ****

  ****  Section 001 RoData ASL$FIND_LINE_DEVICE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL_CONTROLLER              4-0-0/c STRC(144)   r     1 KL_LINEDEV

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CONT$                     6-0-0/w PTR         r     1 @DEV$
     5-0-0/w PTR         r     1 @DEV_NAME                  4-0-0/w PTR         r     1 @SIZE
     7-0-0/b BIT         r     1 ALL                       *0-0-0/w PTR         r     1 CONT$
    *0-0-0/w PTR         r     1 DEV$                      10-0-0/w UBIN        r     1 DEVNUM
    *0-0-0/c STRC(27)    r     1 DEV_NAME                  11-0-0/w PTR         r     1 DEV_START$
    12-0-0/w PTR         r     1 DEV_STOP$                 13-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 SIZE                      14-0-0/c CHAR(2)     r     1 TEMPDEV
    15-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DSEG1$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL$LINEDEV                 0-0-0/w ASTR(9)     r     1 TEXT$C

PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:104  

   Procedure ASL$FIND_LINE_DEVICE requires 120 words for executable code.
   Procedure ASL$FIND_LINE_DEVICE requires 18 words of local(AUTO) storage.
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:105  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:106  
          MINI XREF LISTING

ALL
     14997**DCL     15310<<ASSIGN  15322<<ASSIGN  15362>>IF
ASA_BRKS_LOC
     11708**DCL     11708--REDEF
ASB$WILD_MATCH
     14576**DCL-ENT 15360--CALL
ASH$ERROR
     14573**DCL-ENT 15349--CALL
AS_DEFAULT.BANNER_PERM
     12401**DCL     12402--REDEF
AS_DEFAULT.BUDGET.MACCT
     12306**DCL     12310--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12319**DCL     12322--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12302**DCL     12304--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12297**DCL     12299--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12417**DCL     12418--REDEF   12419--REDEF
AS_DEFAULT_DREC.PASSWORD
     13671**DCL     13675--REDEF
AS_DEFAULT_DREC.RENAME
     13694**DCL     13695--REDEF
AS_DFLT.BANNER_PERM
     12223**DCL     12224--REDEF
AS_DFLT.BUDGET.MACCT
     12128**DCL     12132--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12141**DCL     12144--REDEF
AS_DFLT.BUDGET.PACCUM
     12124**DCL     12126--REDEF
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:107  
AS_DFLT.BUDGET.PMAXC
     12119**DCL     12121--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12239**DCL     12240--REDEF   12241--REDEF
AS_FE_MODE
     11574**DCL     11575--REDEF
AS_MODE
     11571**DCL     11573--REDEF
AS_MOD_USER.ACCESS
     14436**DCL     14437--REDEF
AS_MOD_USER.BANNER
     14423**DCL     14424--REDEF
AS_MOD_USER.BANNER_PERM
     14425**DCL     14426--REDEF
AS_MOD_USER.BILL
     14431**DCL     14432--REDEF
AS_MOD_USER.CPROC
     14427**DCL     14428--REDEF
AS_MOD_USER.FEBILL
     14507**DCL     14508--REDEF
AS_MOD_USER.FECXTMEM
     14524**DCL     14525--REDEF
AS_MOD_USER.FEMINTS
     14509**DCL     14510--REDEF
AS_MOD_USER.FEMMEM
     14520**DCL     14521--REDEF
AS_MOD_USER.FEMTIME
     14518**DCL     14519--REDEF
AS_MOD_USER.FEPPRIV
     14515**DCL     14517--REDEF
AS_MOD_USER.FEPRIV
     14512**DCL     14514--REDEF
AS_MOD_USER.FORCE_BIT
     14421**DCL     14422--REDEF
AS_MOD_USER.KEY
     14503**DCL     14505--REDEF
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:108  
AS_MOD_USER.LASTCPROC
     14429**DCL     14430--REDEF
AS_MOD_USER.LIMITS.DO_
     14477**DCL     14478--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14493**DCL     14494--REDEF
AS_MOD_USER.LIMITS.LO
     14473**DCL     14474--REDEF
AS_MOD_USER.LIMITS.MEM
     14469**DCL     14470--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14497**DCL     14498--REDEF
AS_MOD_USER.LIMITS.PDIS
     14485**DCL     14486--REDEF
AS_MOD_USER.LIMITS.PO
     14481**DCL     14482--REDEF
AS_MOD_USER.LIMITS.TDIS
     14489**DCL     14490--REDEF
AS_MOD_USER.LIMITS.TIME
     14465**DCL     14466--REDEF
AS_MOD_USER.MAXENQ
     14446**DCL     14447--REDEF
AS_MOD_USER.PERM_BIT
     14419**DCL     14420--REDEF
AS_MOD_USER.PPRIV
     14441**DCL     14443--REDEF
AS_MOD_USER.PRIOB
     14448**DCL     14449--REDEF
AS_MOD_USER.PRIV
     14438**DCL     14440--REDEF
AS_MOD_USER.QUAN
     14444**DCL     14445--REDEF
AS_MOD_USER.SETUP
     14417**DCL     14418--REDEF
AS_PROJECT.BANNER_PERM
     12757**DCL     12758--REDEF
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:109  
AS_PROJECT.BUDGET.MACCT
     12662**DCL     12666--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12675**DCL     12678--REDEF
AS_PROJECT.BUDGET.PACCUM
     12658**DCL     12660--REDEF
AS_PROJECT.BUDGET.PMAXC
     12653**DCL     12655--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12773**DCL     12774--REDEF   12775--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12935**DCL     12936--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12840**DCL     12844--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12853**DCL     12856--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12836**DCL     12838--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12831**DCL     12833--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12951**DCL     12952--REDEF   12953--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14157**DCL     14161--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14180**DCL     14181--REDEF
AS_PROJECT_DREC.PASSWORD
     13995**DCL     13999--REDEF
AS_PROJECT_DREC.RENAME
     14018**DCL     14019--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12579**DCL     12580--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12484**DCL     12488--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12497**DCL     12500--REDEF
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:110  
AS_PROJ_ADMIN.BUDGET.PACCUM
     12480**DCL     12482--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12475**DCL     12477--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12595**DCL     12596--REDEF   12597--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13833**DCL     13837--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13856**DCL     13857--REDEF
AS_USERS.BANNER_PERM
     12045**DCL     12046--REDEF
AS_USERS.BUDGET.MACCT
     11950**DCL     11954--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11963**DCL     11966--REDEF
AS_USERS.BUDGET.PACCUM
     11946**DCL     11948--REDEF
AS_USERS.BUDGET.PMAXC
     11941**DCL     11943--REDEF
AS_USERS.SETUP_CHRA.TXT
     12061**DCL     12062--REDEF   12063--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13113**DCL     13114--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13018**DCL     13022--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13031**DCL     13034--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13014**DCL     13016--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13009**DCL     13011--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13129**DCL     13130--REDEF   13131--REDEF
CONT$
     14563**DCL        10--PROC    15308>>ASSIGN  15312>>IF      15313>>ASSIGN
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:111  
DEV$
     14567**DCL        10--PROC    14860--IMP-PTR 15312>>IF      15313<<ASSIGN  15315<<ASSIGN  15315>>ASSIGN
     15317>>IF      15318<<ASSIGN  15352<<ASSIGN  15357>>DOWHILE 15359>>CALLBLT 15363>>IF      15366<<ASSIGN
     15366>>ASSIGN  15368<<ASSIGN
DEVNUM
     14998**DCL     15329<<CALLBLT 15331>>IF      15363>>IF
DEV_NAME
     14564**DCL        10--PROC
DEV_NAME.TEXT
     14566**DCL     15321>>IF      15324>>CALLBLT 15329>>CALLBLT 15331>>IF      15360<>CALL
DEV_START$
     14999**DCL     15308<<ASSIGN  15309>>ASSIGN
DEV_STOP$
     15000**DCL     15309<<ASSIGN  15317>>IF      15357>>DOWHILE
DSEG1$
     11709**DCL     14599--IMP-PTR
ERR_CODE
     11703**DCL     11704--REDEF
I
     15001**DCL     15324<<CALLBLT
KL$LINEDEV.DEVICE#
     14978**DCL     15359>>CALLBLT 15363>>IF
KL_CONTROLLER
     15022**DCL     15313--ASSIGN
KL_DEFAULT.PASSWORD
     14319**DCL     14323--REDEF
KL_DEFAULT.RENAME
     14342**DCL     14343--REDEF
KL_DFLT.PASSWORD
     13509**DCL     13513--REDEF
KL_DFLT.RENAME
     13532**DCL     13533--REDEF
KL_DREC.PASSWORD
     13347**DCL     13351--REDEF
KL_DREC.RENAME
     13370**DCL     13371--REDEF
PL6.E3A0      #002=ASL$FIND_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI       TUE 07/29/97 10:14 Page:112  
KL_DREC_CNT.PASSWORD
     13234**DCL     13238--REDEF
KL_DREC_CNT.RENAME
     13257**DCL     13258--REDEF
KL_LINEDEV
     15171**DCL     15315--ASSIGN  15366--ASSIGN
LINE$DREC.PASSWORD
     14657**DCL     14661--REDEF
LINE$DREC.RENAME
     14680**DCL     14681--REDEF
LOOP_END
     15366**LABEL   15360--CALLALT 15363--GOTO
PROJ_KEY.TEXT
     11581**DCL     11581--REDEF
PROJ_KEY.TXT.PROJECT
     11581**DCL     11581--REDEF
REMEM_VAR
     11707**DCL     11707--REDEF
REM_FCMD
     11707**DCL     11708--REDEF
SIZE
     14568**DCL        10--PROC    15309>>ASSIGN
TEMPDEV
     15002**DCL     15359<<CALLBLT 15360<>CALL
TEXT$C.CNT
     14582**DCL     14583--IMP-SIZ
USERS_KEY.TEXT
     11578**DCL     11579--REDEF   11579--REDEF   11579--REDEF   11580--REDEF
WILD_CARD
     15003**DCL     15311<<ASSIGN  15326<<ASSIGN  15331>>IF      15331>>IF      15358>>IF      15362>>IF

PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:113  
      604        1        /*T***********************************************************/
      605        2        /*T*                                                         */
      606        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      607        4        /*T*                                                         */
      608        5        /*T***********************************************************/
      609        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:114  
      610        7        ASL$DISP_ONE_LINE_DEVICE: PROC (DEVICE$, JCL, LINE_NAME, CONTROLLER_NUMBER,
                 7            NEW_CONTROLLER);
      611        8        /**********************************************************/
      612        9
      613       10        /*D* NAME:     ASL$DISP_ONE_DEVICE
      614       11             CALL:     CALL ASL$DISP_ONE_DEVICE ( DEVICE$, JCL)
      615       12             INPUT:    DEVICE$ - Pointer to a kl_linedev structure.
      616       13                       JCL    - bit set for JCL type display.
      617       14                       LINE_NAME - the name of the line the current device
      618       15                                   belongs to.
      619       16                       CONTROLLER_NUMBER - the number of the controller
      620       17                                           the current device belongs to.
      621       18             OUTPUT:   Nothing is returned.
      622       19             DESCRIPTION:  ASL$DISP_ONE_DEVICE is the routine to handle
      623       20                           the display of a line device pointed at by
      624       21                           DEVICE$.  The output from this routine will
      625       22                           depened upon the setting of the JCL flag.
      626       23        */
      627       24        /********************************************************************/
      628       25        /*   Include files   include files   include files   include files  */
      629       26        /********************************************************************/
      630       27        %INCLUDE AS_PERR_C;
      631      629        %INCLUDE AS_SUPER_C;
      632     1064        %INCLUDE AS_SUBS_C;
      633     2478        %INCLUDE AS_MAC_C;
      634     2558        %INCLUDE AS_ENTRIES_M;
      635     3608        %INCLUDE AS_SSUBS_C;
      636     3700        %INCLUDE B_ERRORS_C;
      637     4827        %INCLUDE KL_SUPER_C;
      638     7729        %INCLUDE XU_MACRO_C;
      639    10835        %INCLUDE XU_FORMAT_C;
      640    10997        %INCLUDE AS_SUPER_R;
      641    14013        /********************************************************************/
      642    14014        /*   Parameters      parameters      parameters      parameters     */
      643    14015        /********************************************************************/
      644    14016    1   DCL CONTROLLER_NUMBER      UBIN;
      645    14017    1   DCL DEVICE$                PTR;
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:115  
      646    14018    1   DCL JCL                    BIT(1);
      647    14019    1   DCL LINE_NAME              CHAR(8);
      648    14020    1   DCL NEW_CONTROLLER         BIT(1);
      649    14021        /********************************************************************/
      650    14022        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      651    14023        /********************************************************************/
      652    14024    1   DCL X$FORMAT ENTRY(1) ;
      653    14025        %ASB$WRITE_LO ;
      654    14028        /********************************************************************/
      655    14029        /*   Local based     local based     local based     local based    */
      656    14030        /********************************************************************/
      657    14031        %KL_LINEDEV     ( NAME      = KL$LINEDEV,
      658    14032                          LVL       = 1,
      659    14033                          STCLASS   = "BASED( DEVICE$ )" );
      660    14182        %KL$UWORD       ( NAME      = KL_UWORD,
      661    14183                          STCLASS   = AUTO );
      662    14188        %KL$UBWORD      ( NAME      = KL_UBWORD,
      663    14189                          STCLASS   = AUTO );
      664    14199        /********************************************************************/
      665    14200        /*   Auto data       auto data       auto data       auto data      */
      666    14201        /********************************************************************/
      667    14202    1   DCL DEVNUM UBIN;
      668    14203        /********************************************************************/
      669    14204        /*   Constant data   constant data   constant data   constant data  */
      670    14205        /********************************************************************/
      671    14206    1   DCL CONT_DEV_HDR           CHAR(0) CONSTANT INIT
      672    14207    1   ('              DEVICE  TYPE    COLUMNS  ROWS');
      673    14208    1   DCL CONT_DEV_FMT           CHAR(0) CONSTANT INIT
      674    14209    1             ('%16-%D%24-%D%32-%D%41-%D');
      675    14210    1   DCL CONT_DEV_JCL_FMT       CHAR(0) CONSTANT INIT
      676    14211    1       ('CREATE DEVICE %2D FOR LINE %A CONTROLLER %2D%/%3-ROWS = %3D; COLUMNS = %3D; TY
             14211        PE = %D%/   END');
      677    14212        /********************************************************************/
      678    14213        /*   Procedure       procedure       procedure       procedure      */
      679    14214        /********************************************************************/
      680    14215                                                  /* List device jcl info. */
      681    14216    2   IF JCL THEN DO;
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:116  
      682    14217    2      FMT_BUF = CONT_DEV_JCL_FMT;
      683    14218    2      FDS.FMT_.BOUND = SIZEV(CONT_DEV_JCL_FMT);
      684    14219    2      FDS.NVECS# = 6;
      685    14220    2      FMT_VEC(0) = VECTOR( KL$LINEDEV.DEVICE# );
      686    14221    2      FMT_VEC(1) = VECTOR( LINE_NAME );
      687    14222    2      FMT_VEC(2) = VECTOR( CONTROLLER_NUMBER );
      688    14223    2      FMT_VEC(3) = VECTOR( KL$LINEDEV.ROWS );
      689    14224    2      FMT_VEC(4) = VECTOR( KL$LINEDEV.COLUMNS );
      690    14225    2      KL_UBWORD.NUM = KL$LINEDEV.TYPE;
      691    14226    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;
      692    14227    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;
      693    14228    2      FMT_VEC(5) = VECTOR( KL_UWORD );
      694    14229    2      END; /*  Jcl  */
      695    14230    2   ELSE DO;  /*  Not jcl  */
      696    14231                                                  /* List device info. */
      697    14232    3      IF NEW_CONTROLLER THEN DO;
      698    14233    3         CALL ASB$WRITE_LO( CONT_DEV_HDR, LENGTHC(CONT_DEV_HDR) );
      699    14234    3         END;  /*  New controller  */
      700    14235    2      FMT_BUF = CONT_DEV_FMT;
      701    14236    2      FDS.FMT_.BOUND = SIZEV(CONT_DEV_FMT);
      702    14237    2      FDS.NVECS# = 4;
      703    14238    2      FMT_VEC(0) = VECTOR( KL$LINEDEV.DEVICE# );
      704    14239    2      KL_UBWORD.NUM = KL$LINEDEV.TYPE;
      705    14240    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;
      706    14241    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;
      707    14242    2      FMT_VEC(1) = VECTOR( KL_UWORD );
      708    14243    2      FMT_VEC(2) = VECTOR( KL$LINEDEV.COLUMNS );
      709    14244    2      FMT_VEC(3) = VECTOR( KL$LINEDEV.ROWS );
      710    14245    2      END; /*  Not jcl  */
      711    14246
      712    14247    1   CALL X$FORMAT( FDS );
      713    14248
      714    14249    1   RETURN;
      715    14250
      716    14251    1   END ASL$DISP_ONE_LINE_DEVICE;

PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:117  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINE_DEVICE.

   Procedure ASL$DISP_ONE_LINE_DEVICE requires 132 words for executable code.
   Procedure ASL$DISP_ONE_LINE_DEVICE requires 14 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINE_DEVICES.:E05TSI    .

PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:118  

 Object Unit name= ASL$DISP_ONE_LINE_DEVICE                   File name= ASL$LIST_LINE_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:16:12.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     41     51  ASL$DISP_ONE_LINE_DEVICE
    2   Proc  even  none   132    204  ASL$DISP_ONE_LINE_DEVICE
    3  RoData even  none     9     11  ASL$DISP_ONE_LINE_DEVICE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        5  ASL$DISP_ONE_LINE_DEVICE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:119  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     FDS                                   FMT_BUF                               FMT_VEC
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:120  


      604        1        /*T***********************************************************/
      605        2        /*T*                                                         */
      606        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      607        4        /*T*                                                         */
      608        5        /*T***********************************************************/
      609        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:121  
      610        7        ASL$DISP_ONE_LINE_DEVICE: PROC (DEVICE$, JCL, LINE_NAME, CONTROLLER_NUMBER,
                 7            NEW_CONTROLLER);

      7  2 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_5
         2 000001   000016 000005                    ZERO    14,5

      611        8        /**********************************************************/
      612        9
      613       10        /*D* NAME:     ASL$DISP_ONE_DEVICE
      614       11             CALL:     CALL ASL$DISP_ONE_DEVICE ( DEVICE$, JCL)
      615       12             INPUT:    DEVICE$ - Pointer to a kl_linedev structure.
      616       13                       JCL    - bit set for JCL type display.
      617       14                       LINE_NAME - the name of the line the current device
      618       15                                   belongs to.
      619       16                       CONTROLLER_NUMBER - the number of the controller
      620       17                                           the current device belongs to.
      621       18             OUTPUT:   Nothing is returned.
      622       19             DESCRIPTION:  ASL$DISP_ONE_DEVICE is the routine to handle
      623       20                           the display of a line device pointed at by
      624       21                           DEVICE$.  The output from this routine will
      625       22                           depened upon the setting of the JCL flag.
      626       23        */
      627       24        /********************************************************************/
      628       25        /*   Include files   include files   include files   include files  */
      629       26        /********************************************************************/
      630       27        %INCLUDE AS_PERR_C;
      631      629        %INCLUDE AS_SUPER_C;
      632     1064        %INCLUDE AS_SUBS_C;
      633     2478        %INCLUDE AS_MAC_C;
      634     2558        %INCLUDE AS_ENTRIES_M;
      635     3608        %INCLUDE AS_SSUBS_C;
      636     3700        %INCLUDE B_ERRORS_C;
      637     4827        %INCLUDE KL_SUPER_C;
      638     7729        %INCLUDE XU_MACRO_C;
      639    10835        %INCLUDE XU_FORMAT_C;
      640    10997        %INCLUDE AS_SUPER_R;
      641    14013        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:122  
      642    14014        /*   Parameters      parameters      parameters      parameters     */
      643    14015        /********************************************************************/
      644    14016    1   DCL CONTROLLER_NUMBER      UBIN;
      645    14017    1   DCL DEVICE$                PTR;
      646    14018    1   DCL JCL                    BIT(1);
      647    14019    1   DCL LINE_NAME              CHAR(8);
      648    14020    1   DCL NEW_CONTROLLER         BIT(1);
      649    14021        /********************************************************************/
      650    14022        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      651    14023        /********************************************************************/
      652    14024    1   DCL X$FORMAT ENTRY(1) ;
      653    14025        %ASB$WRITE_LO ;
      654    14028        /********************************************************************/
      655    14029        /*   Local based     local based     local based     local based    */
      656    14030        /********************************************************************/
      657    14031        %KL_LINEDEV     ( NAME      = KL$LINEDEV,
      658    14032                          LVL       = 1,
      659    14033                          STCLASS   = "BASED( DEVICE$ )" );
      660    14182        %KL$UWORD       ( NAME      = KL_UWORD,
      661    14183                          STCLASS   = AUTO );
      662    14188        %KL$UBWORD      ( NAME      = KL_UBWORD,
      663    14189                          STCLASS   = AUTO );
      664    14199        /********************************************************************/
      665    14200        /*   Auto data       auto data       auto data       auto data      */
      666    14201        /********************************************************************/
      667    14202    1   DCL DEVNUM UBIN;
      668    14203        /********************************************************************/
      669    14204        /*   Constant data   constant data   constant data   constant data  */
      670    14205        /********************************************************************/
      671    14206    1   DCL CONT_DEV_HDR           CHAR(0) CONSTANT INIT
      672    14207    1   ('              DEVICE  TYPE    COLUMNS  ROWS');
      673    14208    1   DCL CONT_DEV_FMT           CHAR(0) CONSTANT INIT
      674    14209    1             ('%16-%D%24-%D%32-%D%41-%D');
      675    14210    1   DCL CONT_DEV_JCL_FMT       CHAR(0) CONSTANT INIT
      676    14211    1      ('CREATE DEVICE %2D FOR LINE %A CONTROLLER %2D%/%3-ROWS = %3D; COLUMNS = %3D; TY
             14211        PE = %D%/   END');
      677    14212        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:123  
      678    14213        /*   Procedure       procedure       procedure       procedure      */
      679    14214        /********************************************************************/
      680    14215                                                  /* List device jcl info. */
      681    14216    2   IF JCL THEN DO;

  14216  2 000002   200004 470500                    LDP0    @JCL,,AUTO
         2 000003   000000 066500                    CMPB    filb='0'B
         2 000004   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 000005   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000006   000103 600000 2                  TZE     s:14232

      682    14217    2      FMT_BUF = CONT_DEV_JCL_FMT;

  14217  2 000007   040000 100400                    MLR     fill='040'O
         2 000010   000021 000135 1                  ADSC9   CONT_DEV_JCL_FMT         cn=0,n=93
         2 000011   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      683    14218    2      FDS.FMT_.BOUND = SIZEV(CONT_DEV_JCL_FMT);

  14218  2 000012   000000 236000 xsym               LDQ     FDS
         2 000013   177777 376007                    ANQ     65535,DL
         2 000014   000027 276003                    ORQ     23,DU
         2 000015   000000 756000 xsym               STQ     FDS

      684    14219    2      FDS.NVECS# = 6;

  14219  2 000016   000006 235007                    LDA     6,DL
         2 000017   000011 755000 xsym               STA     FDS+9

      685    14220    2      FMT_VEC(0) = VECTOR( KL$LINEDEV.DEVICE# );

  14220  2 000020   200003 471500                    LDP1    @DEVICE$,,AUTO
         2 000021   100000 473500                    LDP3    0,,PR1
         2 000022   177640 235007                    LDA     65440,DL
         2 000023   200014 453500                    STP3    KL_UBWORD+3,,AUTO
         2 000024   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000025   000000 036000 3                  ADLQ    0
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:124  
         2 000026   000000 755000 xsym               STA     FMT_VEC
         2 000027   000001 756000 xsym               STQ     FMT_VEC+1

      686    14221    2      FMT_VEC(1) = VECTOR( LINE_NAME );

  14221  2 000030   000001 235000 3                  LDA     1
         2 000031   200005 236100                    LDQ     @LINE_NAME,,AUTO
         2 000032   000002 755000 xsym               STA     FMT_VEC+2
         2 000033   000003 756000 xsym               STQ     FMT_VEC+3

      687    14222    2      FMT_VEC(2) = VECTOR( CONTROLLER_NUMBER );

  14222  2 000034   777640 235007                    LDA     -96,DL
         2 000035   200006 236100                    LDQ     @CONTROLLER_NUMBER,,AUTO
         2 000036   000004 755000 xsym               STA     FMT_VEC+4
         2 000037   000005 756000 xsym               STQ     FMT_VEC+5

      688    14223    2      FMT_VEC(3) = VECTOR( KL$LINEDEV.ROWS );

  14223  2 000040   100000 473500                    LDP3    0,,PR1
         2 000041   177640 235007                    LDA     65440,DL
         2 000042   200014 453500                    STP3    KL_UBWORD+3,,AUTO
         2 000043   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000044   000003 036003                    ADLQ    3,DU
         2 000045   000006 755000 xsym               STA     FMT_VEC+6
         2 000046   000007 756000 xsym               STQ     FMT_VEC+7

      689    14224    2      FMT_VEC(4) = VECTOR( KL$LINEDEV.COLUMNS );

  14224  2 000047   100000 473500                    LDP3    0,,PR1
         2 000050   177640 235007                    LDA     65440,DL
         2 000051   200014 453500                    STP3    KL_UBWORD+3,,AUTO
         2 000052   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000053   000002 036000 3                  ADLQ    2
         2 000054   000010 755000 xsym               STA     FMT_VEC+8
         2 000055   000011 756000 xsym               STQ     FMT_VEC+9

PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:125  
      690    14225    2      KL_UBWORD.NUM = KL$LINEDEV.TYPE;

  14225  2 000056   100000 473500                    LDP3    0,,PR1
         2 000057   000100 100500                    MLR     fill='000'O
         2 000060   300002 400002                    ADSC9   2,,PR3                   cn=2,n=2
         2 000061   200011 400002                    ADSC9   KL_UBWORD,,AUTO          cn=2,n=2

      691    14226    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;

  14226  2 000062   200011 236100                    LDQ     KL_UBWORD,,AUTO
         2 000063   377000 376007                    ANQ     130560,DL
         2 000064   000001 772000                    QRL     1
         2 000065   200010 676100                    ERQ     KL_UWORD,,AUTO
         2 000066   000003 376000 3                  ANQ     3
         2 000067   200010 656100                    ERSQ    KL_UWORD,,AUTO

      692    14227    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;

  14227  2 000070   200011 236100                    LDQ     KL_UBWORD,,AUTO
         2 000071   200010 676100                    ERQ     KL_UWORD,,AUTO
         2 000072   000377 376007                    ANQ     255,DL
         2 000073   200010 656100                    ERSQ    KL_UWORD,,AUTO

      693    14228    2      FMT_VEC(5) = VECTOR( KL_UWORD );

  14228  2 000074   777640 235007                    LDA     -96,DL
         2 000075   200014 452500                    STP2    KL_UBWORD+3,,AUTO
         2 000076   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000077   000010 036003                    ADLQ    8,DU
         2 000100   000012 755000 xsym               STA     FMT_VEC+10
         2 000101   000013 756000 xsym               STQ     FMT_VEC+11

      694    14229    2      END; /*  Jcl  */

  14229  2 000102   000177 710000 2                  TRA     s:14247

      695    14230    2   ELSE DO;  /*  Not jcl  */
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:126  

      696    14231                                                  /* List device info. */
      697    14232    3      IF NEW_CONTROLLER THEN DO;

  14232  2 000103   200007 471500                    LDP1    @NEW_CONTROLLER,,AUTO
         2 000104   000000 066500                    CMPB    filb='0'B
         2 000105   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         2 000106   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000107   000114 600000 2                  TZE     s:14235

      698    14233    3         CALL ASB$WRITE_LO( CONT_DEV_HDR, LENGTHC(CONT_DEV_HDR) );

  14233  2 000110   000005 630400 3                  EPPR0   5
         2 000111   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000112   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000113   000000 011000                    NOP     0

      699    14234    3         END;  /*  New controller  */

      700    14235    2      FMT_BUF = CONT_DEV_FMT;

  14235  2 000114   040000 100400                    MLR     fill='040'O
         2 000115   000013 000030 1                  ADSC9   CONT_DEV_FMT             cn=0,n=24
         2 000116   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      701    14236    2      FDS.FMT_.BOUND = SIZEV(CONT_DEV_FMT);

  14236  2 000117   000000 236000 xsym               LDQ     FDS
         2 000120   177777 376007                    ANQ     65535,DL
         2 000121   000007 276000 3                  ORQ     7
         2 000122   000000 756000 xsym               STQ     FDS

      702    14237    2      FDS.NVECS# = 4;

  14237  2 000123   000004 235007                    LDA     4,DL
         2 000124   000011 755000 xsym               STA     FDS+9

PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:127  
      703    14238    2      FMT_VEC(0) = VECTOR( KL$LINEDEV.DEVICE# );

  14238  2 000125   200003 470500                    LDP0    @DEVICE$,,AUTO
         2 000126   000000 471500                    LDP1    0,,PR0
         2 000127   177640 235007                    LDA     65440,DL
         2 000130   200014 451500                    STP1    KL_UBWORD+3,,AUTO
         2 000131   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000132   000000 036000 3                  ADLQ    0
         2 000133   000000 755000 xsym               STA     FMT_VEC
         2 000134   000001 756000 xsym               STQ     FMT_VEC+1

      704    14239    2      KL_UBWORD.NUM = KL$LINEDEV.TYPE;

  14239  2 000135   000000 471500                    LDP1    0,,PR0
         2 000136   000100 100500                    MLR     fill='000'O
         2 000137   100002 400002                    ADSC9   2,,PR1                   cn=2,n=2
         2 000140   200011 400002                    ADSC9   KL_UBWORD,,AUTO          cn=2,n=2

      705    14240    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;

  14240  2 000141   200011 236100                    LDQ     KL_UBWORD,,AUTO
         2 000142   377000 376007                    ANQ     130560,DL
         2 000143   000001 772000                    QRL     1
         2 000144   200010 676100                    ERQ     KL_UWORD,,AUTO
         2 000145   000003 376000 3                  ANQ     3
         2 000146   200010 656100                    ERSQ    KL_UWORD,,AUTO

      706    14241    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;

  14241  2 000147   200011 236100                    LDQ     KL_UBWORD,,AUTO
         2 000150   200010 676100                    ERQ     KL_UWORD,,AUTO
         2 000151   000377 376007                    ANQ     255,DL
         2 000152   200010 656100                    ERSQ    KL_UWORD,,AUTO

      707    14242    2      FMT_VEC(1) = VECTOR( KL_UWORD );

  14242  2 000153   777640 235007                    LDA     -96,DL
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:128  
         2 000154   200014 452500                    STP2    KL_UBWORD+3,,AUTO
         2 000155   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000156   000010 036003                    ADLQ    8,DU
         2 000157   000002 755000 xsym               STA     FMT_VEC+2
         2 000160   000003 756000 xsym               STQ     FMT_VEC+3

      708    14243    2      FMT_VEC(2) = VECTOR( KL$LINEDEV.COLUMNS );

  14243  2 000161   000000 471500                    LDP1    0,,PR0
         2 000162   177640 235007                    LDA     65440,DL
         2 000163   200014 451500                    STP1    KL_UBWORD+3,,AUTO
         2 000164   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000165   000002 036000 3                  ADLQ    2
         2 000166   000004 755000 xsym               STA     FMT_VEC+4
         2 000167   000005 756000 xsym               STQ     FMT_VEC+5

      709    14244    2      FMT_VEC(3) = VECTOR( KL$LINEDEV.ROWS );

  14244  2 000170   000000 471500                    LDP1    0,,PR0
         2 000171   177640 235007                    LDA     65440,DL
         2 000172   200014 451500                    STP1    KL_UBWORD+3,,AUTO
         2 000173   200014 236100                    LDQ     KL_UBWORD+3,,AUTO
         2 000174   000003 036003                    ADLQ    3,DU
         2 000175   000006 755000 xsym               STA     FMT_VEC+6
         2 000176   000007 756000 xsym               STQ     FMT_VEC+7

      710    14245    2      END; /*  Not jcl  */

      711    14246
      712    14247    1   CALL X$FORMAT( FDS );

  14247  2 000177   000010 630400 3                  EPPR0   8
         2 000200   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000201   000000 701000 xent               TSX1    X$FORMAT
         2 000202   000000 011000                    NOP     0

      713    14248
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:129  
      714    14249    1   RETURN;

  14249  2 000203   000000 702200 xent               TSX2  ! X66_ARET
      715    14250
      716    14251    1   END ASL$DISP_ONE_LINE_DEVICE;

PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:130  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINE_DEVICE.
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:131  

 **** Variables and constants ****

  ****  Section 001 RoData ASL$DISP_ONE_LINE_DEVICE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    13-0-0/c CHAR(24)    r     1 CONT_DEV_FMT               0-0-0/c CHAR(43)    r     1 CONT_DEV_HDR
    21-0-0/c CHAR(93)    r     1 CONT_DEV_JCL_FMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @CONTROLLER_NUMBER         3-0-0/w PTR         r     1 @DEVICE$
     4-0-0/w PTR         r     1 @JCL                       5-0-0/w PTR         r     1 @LINE_NAME
     7-0-0/w PTR         r     1 @NEW_CONTROLLER           *0-0-0/w UBIN        r     1 CONTROLLER_NUMBER
    *0-0-0/w PTR         r     1 DEVICE$                   *0-0-0/b BIT         r     1 JCL
    11-0-0/w STRC        r     1 KL_UBWORD                 10-0-0/w STRC        r     1 KL_UWORD
    *0-0-0/c CHAR(8)     r     1 LINE_NAME                 *0-0-0/b BIT         r     1 NEW_CONTROLLER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL$LINEDEV

PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:132  

   Procedure ASL$DISP_ONE_LINE_DEVICE requires 132 words for executable code.
   Procedure ASL$DISP_ONE_LINE_DEVICE requires 14 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINE_DEVICES.:E05TSI    .
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:133  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:134  
          MINI XREF LISTING

ASA_BRKS_LOC
     11161**DCL     11161--REDEF
ASB$WRITE_LO
     14026**DCL-ENT 14233--CALL
AS_DEFAULT.BANNER_PERM
     11854**DCL     11855--REDEF
AS_DEFAULT.BUDGET.MACCT
     11759**DCL     11763--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11772**DCL     11775--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11755**DCL     11757--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11750**DCL     11752--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11870**DCL     11871--REDEF   11872--REDEF
AS_DEFAULT_DREC.PASSWORD
     13124**DCL     13128--REDEF
AS_DEFAULT_DREC.RENAME
     13147**DCL     13148--REDEF
AS_DFLT.BANNER_PERM
     11676**DCL     11677--REDEF
AS_DFLT.BUDGET.MACCT
     11581**DCL     11585--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11594**DCL     11597--REDEF
AS_DFLT.BUDGET.PACCUM
     11577**DCL     11579--REDEF
AS_DFLT.BUDGET.PMAXC
     11572**DCL     11574--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11692**DCL     11693--REDEF   11694--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:135  
AS_FE_MODE
     11027**DCL     11028--REDEF
AS_MODE
     11024**DCL     11026--REDEF
AS_MOD_USER.ACCESS
     13889**DCL     13890--REDEF
AS_MOD_USER.BANNER
     13876**DCL     13877--REDEF
AS_MOD_USER.BANNER_PERM
     13878**DCL     13879--REDEF
AS_MOD_USER.BILL
     13884**DCL     13885--REDEF
AS_MOD_USER.CPROC
     13880**DCL     13881--REDEF
AS_MOD_USER.FEBILL
     13960**DCL     13961--REDEF
AS_MOD_USER.FECXTMEM
     13977**DCL     13978--REDEF
AS_MOD_USER.FEMINTS
     13962**DCL     13963--REDEF
AS_MOD_USER.FEMMEM
     13973**DCL     13974--REDEF
AS_MOD_USER.FEMTIME
     13971**DCL     13972--REDEF
AS_MOD_USER.FEPPRIV
     13968**DCL     13970--REDEF
AS_MOD_USER.FEPRIV
     13965**DCL     13967--REDEF
AS_MOD_USER.FORCE_BIT
     13874**DCL     13875--REDEF
AS_MOD_USER.KEY
     13956**DCL     13958--REDEF
AS_MOD_USER.LASTCPROC
     13882**DCL     13883--REDEF
AS_MOD_USER.LIMITS.DO_
     13930**DCL     13931--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:136  
AS_MOD_USER.LIMITS.FPOOLS
     13946**DCL     13947--REDEF
AS_MOD_USER.LIMITS.LO
     13926**DCL     13927--REDEF
AS_MOD_USER.LIMITS.MEM
     13922**DCL     13923--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13950**DCL     13951--REDEF
AS_MOD_USER.LIMITS.PDIS
     13938**DCL     13939--REDEF
AS_MOD_USER.LIMITS.PO
     13934**DCL     13935--REDEF
AS_MOD_USER.LIMITS.TDIS
     13942**DCL     13943--REDEF
AS_MOD_USER.LIMITS.TIME
     13918**DCL     13919--REDEF
AS_MOD_USER.MAXENQ
     13899**DCL     13900--REDEF
AS_MOD_USER.PERM_BIT
     13872**DCL     13873--REDEF
AS_MOD_USER.PPRIV
     13894**DCL     13896--REDEF
AS_MOD_USER.PRIOB
     13901**DCL     13902--REDEF
AS_MOD_USER.PRIV
     13891**DCL     13893--REDEF
AS_MOD_USER.QUAN
     13897**DCL     13898--REDEF
AS_MOD_USER.SETUP
     13870**DCL     13871--REDEF
AS_PROJECT.BANNER_PERM
     12210**DCL     12211--REDEF
AS_PROJECT.BUDGET.MACCT
     12115**DCL     12119--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12128**DCL     12131--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:137  
AS_PROJECT.BUDGET.PACCUM
     12111**DCL     12113--REDEF
AS_PROJECT.BUDGET.PMAXC
     12106**DCL     12108--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12226**DCL     12227--REDEF   12228--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12388**DCL     12389--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12293**DCL     12297--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12306**DCL     12309--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12289**DCL     12291--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12284**DCL     12286--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12404**DCL     12405--REDEF   12406--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13610**DCL     13614--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13633**DCL     13634--REDEF
AS_PROJECT_DREC.PASSWORD
     13448**DCL     13452--REDEF
AS_PROJECT_DREC.RENAME
     13471**DCL     13472--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12032**DCL     12033--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11937**DCL     11941--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11950**DCL     11953--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11933**DCL     11935--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11928**DCL     11930--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:138  
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12048**DCL     12049--REDEF   12050--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13286**DCL     13290--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13309**DCL     13310--REDEF
AS_USERS.BANNER_PERM
     11498**DCL     11499--REDEF
AS_USERS.BUDGET.MACCT
     11403**DCL     11407--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11416**DCL     11419--REDEF
AS_USERS.BUDGET.PACCUM
     11399**DCL     11401--REDEF
AS_USERS.BUDGET.PMAXC
     11394**DCL     11396--REDEF
AS_USERS.SETUP_CHRA.TXT
     11514**DCL     11515--REDEF   11516--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12566**DCL     12567--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12471**DCL     12475--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12484**DCL     12487--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12467**DCL     12469--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12462**DCL     12464--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12582**DCL     12583--REDEF   12584--REDEF
CONTROLLER_NUMBER
     14016**DCL         7--PROC    14222--ASSIGN
CONT_DEV_FMT
     14208**DCL     14235>>ASSIGN  14236--ASSIGN
CONT_DEV_HDR
     14206**DCL     14233<>CALL    14233--CALL
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:139  
CONT_DEV_JCL_FMT
     14210**DCL     14217>>ASSIGN  14218--ASSIGN
DEVICE$
     14017**DCL         7--PROC    14048--IMP-PTR 14220>>ASSIGN  14223>>ASSIGN  14224>>ASSIGN  14225>>ASSIGN
     14238>>ASSIGN  14239>>ASSIGN  14243>>ASSIGN  14244>>ASSIGN
ERR_CODE
     11156**DCL     11157--REDEF
FDS
     11053**DCL     14247<>CALL
FDS.FMT_.BOUND
     11058**DCL     14218<<ASSIGN  14236<<ASSIGN
FDS.NVECS#
     11081**DCL     14219<<ASSIGN  14237<<ASSIGN
FMT_BUF
     11152**DCL     14217<<ASSIGN  14235<<ASSIGN
FMT_VEC
     11152**DCL     14220<<ASSIGN  14221<<ASSIGN  14222<<ASSIGN  14223<<ASSIGN  14224<<ASSIGN  14228<<ASSIGN
     14238<<ASSIGN  14242<<ASSIGN  14243<<ASSIGN  14244<<ASSIGN
JCL
     14018**DCL         7--PROC    14216>>IF
KL$LINEDEV.COLUMNS
     14179**DCL     14224--ASSIGN  14243--ASSIGN
KL$LINEDEV.DEVICE#
     14166**DCL     14220--ASSIGN  14238--ASSIGN
KL$LINEDEV.ROWS
     14175**DCL     14223--ASSIGN  14244--ASSIGN
KL$LINEDEV.TYPE
     14171**DCL     14225>>ASSIGN  14239>>ASSIGN
KL_DEFAULT.PASSWORD
     13772**DCL     13776--REDEF
KL_DEFAULT.RENAME
     13795**DCL     13796--REDEF
KL_DFLT.PASSWORD
     12962**DCL     12966--REDEF
KL_DFLT.RENAME
     12985**DCL     12986--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINE_DEVICE File=ASL$LIST_LINE_DEVICES.:E05TSI   TUE 07/29/97 10:16 Page:140  
KL_DREC.PASSWORD
     12800**DCL     12804--REDEF
KL_DREC.RENAME
     12823**DCL     12824--REDEF
KL_DREC_CNT.PASSWORD
     12687**DCL     12691--REDEF
KL_DREC_CNT.RENAME
     12710**DCL     12711--REDEF
KL_UBWORD.NUM
     14192**DCL     14193--REDEF   14225<<ASSIGN  14239<<ASSIGN
KL_UBWORD.REPLACE.B
     14197**DCL     14227>>ASSIGN  14241>>ASSIGN
KL_UBWORD.REPLACE.T
     14195**DCL     14226>>ASSIGN  14240>>ASSIGN
KL_UWORD
     14184**DCL     14228--ASSIGN  14242--ASSIGN
KL_UWORD.B
     14186**DCL     14227<<ASSIGN  14241<<ASSIGN
KL_UWORD.T
     14185**DCL     14226<<ASSIGN  14240<<ASSIGN
LINE_NAME
     14019**DCL         7--PROC    14221--ASSIGN
NEW_CONTROLLER
     14020**DCL         7--PROC    14232>>IF
PROJ_KEY.TEXT
     11034**DCL     11034--REDEF
PROJ_KEY.TXT.PROJECT
     11034**DCL     11034--REDEF
REMEM_VAR
     11160**DCL     11160--REDEF
REM_FCMD
     11160**DCL     11161--REDEF
USERS_KEY.TEXT
     11031**DCL     11032--REDEF   11032--REDEF   11032--REDEF   11033--REDEF
X$FORMAT
     14024**DCL-ENT 14247--CALL
