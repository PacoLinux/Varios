
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:1    
        1        1        /*M*     ZIM$IDEL - delete index record           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIM$IDEL: PROC ALTRET
        8        8               AVOID($PR5,$PR6,$PR7);
        9        9        %INCLUDE ZI$GLOBAL;
       10      495            %GLOBALS;
       11      803            %TRCE_SUBS;
       12      827        %INCLUDE ZI$DBCB;
       13     1469            %DBCB;
       14     1947            %AWS;
       15     1987            %RWS;
       16     2007            %RECVAR;
       17     2041
       18     2042        %INCLUDE ZI$SSS;
       19     2591            %OA1;
       20     2599            %OA;
       21     2664            %SC;
       22     2691            %SC1;
       23     2701            %RC;
       24     2733            %RS;
       25     2809        %INCLUDE CP_6;
       26     2890            %FPT_DELREC(FPTN=FPT$DELI,STCLASS=BASED);
       27     2909            %VLP_VECTOR(FPTN=VLP$VECTOR,STCLASS=BASED);
       28     2924            %B$TCB(STCLASS=BASED);
       29     2927            %B$ALT(STCLASS=BASED);
       30     2935        %INCLUDE CP_6_SUBS;
       31     3475        %INCLUDE B_ERRORS_C;
       32     4602        %INCLUDE ZI_ERRORS_C;
       33     4928    1   DCL ERROR UBIN(36);
       34     4929    1   DCL TEMP UBIN HALF;
       35     4930    1   DCL RVI$ PTR;
       36     4931    1   DCL B$TCB$ PTR SYMREF;
       37     4932    1   DCL LENGTH UBIN WORD;
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:2    
       38     4933    1   DCL 1 IXBUF BASED,
       39     4934    1         2 * CHAR(LENGTH) CALIGNED;
       40     4935    1   DCL ZIM$JIDEL ENTRY;
       41     4936    1   DCL ZIM$TRACE ENTRY;
       42     4937    1   DCL ZIM$ENQM ENTRY(1) ALTRET;
       43     4938    1   DCL ZIM$IHASH ENTRY(4);
       44     4939    1   DCL ZIM$ENQ_INDEXED ENTRY(1) ALTRET;
       45     4940    1   DCL ZIM$DEQ_INDEXED ENTRY(1) ALTRET;
       46     4941    1   DCL ZIM$INDXMAP_ADD ENTRY ALTRET;
       47     4942    1   DCL HASH UBIN;
       48     4943    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
       49     4944    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);
       50     4945    1       SSS$=GLOBAL.ACTIVE.SSS$;
       51     4946    1       OA$=PINCRW(SSS$,SIZEW(OA1));
       52     4947    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);
       53     4948    1       SC1$=PINCRW(SC$,-SIZEW(SC1));
       54     4949    1       RC$=PINCRW(SSS$,RVI$->RECVAR.RCPTR);
       55     4950    1       AWS$=RVI$->RECVAR.AWS$;
       56     4951    1       IF AWS.DDCB = 0 THEN GOTO ER_UNAVIL;
       57     4952    1       IF AWS.ATRIB.FUN=%IN# THEN
       58     4953    1           GOTO ER_IUM;
       59     4954    1       RWS$=PINCRW(DBCB$,RC.RCWSO);
       60     4955    1       GLOBAL.KEY.VALUE=RWS.KEY.VALUE;
       61     4956    2       IF AWS.ATRIB.CAC THEN DO;
       62     4957    2           GLOBAL.ENQ.SHARE=%NONE#;
       63     4958    2           GLOBAL.ENQ.VALUE.DCB#=AWS.DDCB;
       64     4959    2           LENGTH=SC1.KLNG;
       65     4960    2           CALL ZIM$IHASH(GLOBAL.KEY.VALUE,0,LENGTH,HASH);
       66     4961    2           GLOBAL.ENQ.VALUE.RNAME=HASH;
       67     4962    2           CALL ZIM$ENQM ALTRET(ALT);
       68     4963    2           GLOBAL.KEYID.RECID=RWS.CURR;
       69     4964    2           CALL ZIM$INDXMAP_ADD ALTRET(ALT);
       70     4965    2           END;
       71     4966    1       CALL ZIM$JIDEL;
       72     4967    1       GLOBAL.DELI$->FPT$DELI.V.DCB#=AWS.DDCB;
       73     4968    1       ADDR(GLOBAL.DELI$->FPT$DELI.KEY_)->VLP$VECTOR.W1.VSIZE#=
       74     4969    1          SC1.KLNG-1;
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:3    
       75     4970    1       IF AWS.ATRIB.CAC THEN
       76     4971    1           CALL ZIM$ENQ_INDEXED(AWS) ALTRET(ALT);
       77     4972    1       CALL M$DELREC(GLOBAL.DELI$->FPT$DELI)
       78     4973    2       WHENALTRETURN DO;
       79     4974    2           IF AWS.ATRIB.CAC THEN
       80     4975    2               CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);
       81     4976    2           GOTO ER_DELR;
       82     4977    2           END;
       83     4978    1       IF AWS.ATRIB.CAC THEN
       84     4979    1           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);
       85     4980    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;
       86     4981    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;
       87     4982    2       IF GLOBAL.PARAN.TRACE.MODE~='0'B THEN DO;
       88     4983    2           GLOBAL.PARAN.TRACE.RTYPE=RC.RTYP;
       89     4984    2           GLOBAL.PARAN.TRACE.RNAME=RC.RNAM;
       90     4985    2           IF AWS.ATRIB.CAC THEN
       91     4986    2               GLOBAL.PARAN.TRACE.TYPE=TR#IDELENQ;
       92     4987    2           ELSE
       93     4988    2               GLOBAL.PARAN.TRACE.TYPE=TR#IDEL;
       94     4989    2           CALL ZIM$TRACE;
       95     4990    2           END;
       96     4991    1       RETURN;
       97     4992    1   ER_UNAVIL: ERROR=EXC#UNA;
       98     4993    1       GOTO ALT;
       99     4994    1   ER_DELR: ERROR=ERR#IX#DELAK;
      100     4995    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      101     4996    1       GLOBAL.RET.DCB#=GLOBAL.DELI$->FPT$DELI.V.DCB#;
      102     4997    1       GOTO ALT;
      103     4998    1   ER_IUM:ERROR=EXC#IUM;
      104     4999    1       GOTO ALT;
      105     5000    1   ER_JRNL: ;
      106     5001    1   ALT: ;
      107     5002            %DBALT;
      108     5016    1   END ZIM$IDEL;
      109     5017        %EOD;

PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:4    
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$IDEL.

   Procedure ZIM$IDEL requires 197 words for executable code.
   Procedure ZIM$IDEL requires 22 words of local(AUTO) storage.

PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:5    

 Object Unit name= ZIM$IDEL                                   File name= ZIM$INDEXED.:ZIC0TOU
 UTS= SEP 05 '97 12:56:50.76 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   197    305  ZIM$IDEL
    2  RoData even  none     7      7  ZIM$IDEL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       0  ZIM$IDEL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      4 ZIM$IHASH
 yes     yes           XStd      1 ZIM$DEQ_INDEXED
 yes     yes           XStd      1 ZIM$ENQM
 yes     yes           XStd      1 ZIM$ENQ_INDEXED
 yes     yes           XStd      0 ZIM$INDXMAP_ADD
         yes           XStd      0 ZIM$JIDEL
         yes           XStd      0 ZIM$TRACE
         yes           XStd      0 ZIB$ERR
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:6    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:7    


        1        1        /*M*     ZIM$IDEL - delete index record           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIM$IDEL: PROC ALTRET

      7  1 000000   000000 700200 xent  ZIM$IDEL     TSX0  ! X66_AUTO_0
         1 000001   000026 000000                    ZERO    22,0

        8        8               AVOID($PR5,$PR6,$PR7);
        9        9        %INCLUDE ZI$GLOBAL;
       10      495            %GLOBALS;
       11      803            %TRCE_SUBS;
       12      827        %INCLUDE ZI$DBCB;
       13     1469            %DBCB;
       14     1947            %AWS;
       15     1987            %RWS;
       16     2007            %RECVAR;
       17     2041
       18     2042        %INCLUDE ZI$SSS;
       19     2591            %OA1;
       20     2599            %OA;
       21     2664            %SC;
       22     2691            %SC1;
       23     2701            %RC;
       24     2733            %RS;
       25     2809        %INCLUDE CP_6;
       26     2890            %FPT_DELREC(FPTN=FPT$DELI,STCLASS=BASED);
       27     2909            %VLP_VECTOR(FPTN=VLP$VECTOR,STCLASS=BASED);
       28     2924            %B$TCB(STCLASS=BASED);
       29     2927            %B$ALT(STCLASS=BASED);
       30     2935        %INCLUDE CP_6_SUBS;
       31     3475        %INCLUDE B_ERRORS_C;
       32     4602        %INCLUDE ZI_ERRORS_C;
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:8    
       33     4928    1   DCL ERROR UBIN(36);
       34     4929    1   DCL TEMP UBIN HALF;
       35     4930    1   DCL RVI$ PTR;
       36     4931    1   DCL B$TCB$ PTR SYMREF;
       37     4932    1   DCL LENGTH UBIN WORD;
       38     4933    1   DCL 1 IXBUF BASED,
       39     4934    1         2 * CHAR(LENGTH) CALIGNED;
       40     4935    1   DCL ZIM$JIDEL ENTRY;
       41     4936    1   DCL ZIM$TRACE ENTRY;
       42     4937    1   DCL ZIM$ENQM ENTRY(1) ALTRET;
       43     4938    1   DCL ZIM$IHASH ENTRY(4);
       44     4939    1   DCL ZIM$ENQ_INDEXED ENTRY(1) ALTRET;
       45     4940    1   DCL ZIM$DEQ_INDEXED ENTRY(1) ALTRET;
       46     4941    1   DCL ZIM$INDXMAP_ADD ENTRY ALTRET;
       47     4942    1   DCL HASH UBIN;
       48     4943    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   4943  1 000002   000000 470400 xsym               LDP0    GLOBAL$
         1 000003   000001 236100                    LDQ     1,,PR0
         1 000004   200003 756100                    STQ     DBCB$,,AUTO

       49     4944    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);

   4944  1 000005   200003 471500                    LDP1    DBCB$,,AUTO
         1 000006   100510 220100                    LDX0    328,,PR1
         1 000007   000000 636010                    EAQ     0,X0
         1 000010   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000011   200017 756100                    STQ     RVI$,,AUTO

       50     4945    1       SSS$=GLOBAL.ACTIVE.SSS$;

   4945  1 000012   000000 236100                    LDQ     0,,PR0
         1 000013   200006 756100                    STQ     SSS$,,AUTO

       51     4946    1       OA$=PINCRW(SSS$,SIZEW(OA1));

   4946  1 000014   000001 036003                    ADLQ    1,DU
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:9    
         1 000015   200010 756100                    STQ     OA$,,AUTO

       52     4947    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);

   4947  1 000016   100520 221100                    LDX1    336,,PR1
         1 000017   000000 636011                    EAQ     0,X1
         1 000020   200006 036100                    ADLQ    SSS$,,AUTO
         1 000021   200011 756100                    STQ     SC$,,AUTO

       53     4948    1       SC1$=PINCRW(SC$,-SIZEW(SC1));

   4948  1 000022   777776 036003                    ADLQ    -2,DU
         1 000023   200012 756100                    STQ     SC1$,,AUTO

       54     4949    1       RC$=PINCRW(SSS$,RVI$->RECVAR.RCPTR);

   4949  1 000024   200017 473500                    LDP3    RVI$,,AUTO
         1 000025   300006 222100                    LDX2    6,,PR3
         1 000026   000000 636012                    EAQ     0,X2
         1 000027   200006 036100                    ADLQ    SSS$,,AUTO
         1 000030   200013 756100                    STQ     RC$,,AUTO

       55     4950    1       AWS$=RVI$->RECVAR.AWS$;

   4950  1 000031   300013 236100                    LDQ     11,,PR3
         1 000032   200004 756100                    STQ     AWS$,,AUTO

       56     4951    1       IF AWS.DDCB = 0 THEN GOTO ER_UNAVIL;

   4951  1 000033   200004 474500                    LDP4    AWS$,,AUTO
         1 000034   400006 223100                    LDX3    6,,PR4
         1 000035   000243 600000 1                  TZE     ER_UNAVIL

       57     4952    1       IF AWS.ATRIB.FUN=%IN# THEN

   4952  1 000036   400000 236100                    LDQ     0,,PR4
         1 000037   000060 376003                    ANQ     48,DU
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:10   
         1 000040   000040 116003                    CMPQ    32,DU
         1 000041   000261 600000 1                  TZE     ER_IUM

       58     4953    1           GOTO ER_IUM;
       59     4954    1       RWS$=PINCRW(DBCB$,RC.RCWSO);

   4954  1 000042   200013 470500                    LDP0    RC$,,AUTO
         1 000043   000004 224100                    LDX4    4,,PR0
         1 000044   000000 636014                    EAQ     0,X4
         1 000045   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000046   200005 756100                    STQ     RWS$,,AUTO

       60     4955    1       GLOBAL.KEY.VALUE=RWS.KEY.VALUE;

   4955  1 000047   200005 470500                    LDP0    RWS$,,AUTO
         1 000050   000002 236100                    LDQ     2,,PR0
         1 000051   000033 772000                    QRL     27
         1 000052   000000 624006                    EAX4    0,QL
         1 000053   000000 471400 xsym               LDP1    GLOBAL$
         1 000054   040100 100540                    MLR     fill='040'O
         1 000055   000002 200014                    ADSC9   2,,PR0                   cn=1,n=*X4
         1 000056   104624 200377                    ADSC9   2452,,PR1                cn=1,n=255

       61     4956    2       IF AWS.ATRIB.CAC THEN DO;

   4956  1 000057   400000 236100                    LDQ     0,,PR4
         1 000060   000001 316003                    CANQ    1,DU
         1 000061   000124 600000 1                  TZE     s:4966

       62     4957    2           GLOBAL.ENQ.SHARE=%NONE#;

   4957  1 000062   003000 236003                    LDQ     1536,DU
         1 000063   101407 552140                    STBQ    775,'40'O,PR1

       63     4958    2           GLOBAL.ENQ.VALUE.DCB#=AWS.DDCB;

   4958  1 000064   400006 220100                    LDX0    6,,PR4
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:11   
         1 000065   101407 440100                    SXL0    775,,PR1

       64     4959    2           LENGTH=SC1.KLNG;

   4959  1 000066   200012 470500                    LDP0    SC1$,,AUTO
         1 000067   000000 236100                    LDQ     0,,PR0
         1 000070   777777 376007                    ANQ     -1,DL
         1 000071   200020 756100                    STQ     LENGTH,,AUTO

       65     4960    2           CALL ZIM$IHASH(GLOBAL.KEY.VALUE,0,LENGTH,HASH);

   4960  1 000072   200021 630500                    EPPR0   HASH,,AUTO
         1 000073   200025 450500                    STP0    HASH+4,,AUTO
         1 000074   200020 630500                    EPPR0   LENGTH,,AUTO
         1 000075   200024 450500                    STP0    HASH+3,,AUTO
         1 000076   000003 236000 2                  LDQ     3
         1 000077   200023 756100                    STQ     HASH+2,,AUTO
         1 000100   000000 236000 xsym               LDQ     GLOBAL$
         1 000101   000004 036000 2                  ADLQ    4
         1 000102   200022 756100                    STQ     HASH+1,,AUTO
         1 000103   200022 630500                    EPPR0   HASH+1,,AUTO
         1 000104   000001 631400 2                  EPPR1   1
         1 000105   000000 701000 xent               TSX1    ZIM$IHASH
         1 000106   000000 011000                    NOP     0

       66     4961    2           GLOBAL.ENQ.VALUE.RNAME=HASH;

   4961  1 000107   000000 470400 xsym               LDP0    GLOBAL$
         1 000110   200021 235100                    LDA     HASH,,AUTO
         1 000111   001410 755100                    STA     776,,PR0

       67     4962    2           CALL ZIM$ENQM ALTRET(ALT);

   4962  1 000112   000002 631400 2                  EPPR1   2
         1 000113   000000 701000 xent               TSX1    ZIM$ENQM
         1 000114   000264 702000 1                  TSX2    ER_JRNL

PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:12   
       68     4963    2           GLOBAL.KEYID.RECID=RWS.CURR;

   4963  1 000115   200005 470500                    LDP0    RWS$,,AUTO
         1 000116   000001 235100                    LDA     1,,PR0
         1 000117   000000 471400 xsym               LDP1    GLOBAL$
         1 000120   105012 755100                    STA     2570,,PR1

       69     4964    2           CALL ZIM$INDXMAP_ADD ALTRET(ALT);

   4964  1 000121   000002 631400 2                  EPPR1   2
         1 000122   000000 701000 xent               TSX1    ZIM$INDXMAP_ADD
         1 000123   000264 702000 1                  TSX2    ER_JRNL

       70     4965    2           END;

       71     4966    1       CALL ZIM$JIDEL;

   4966  1 000124   000002 631400 2                  EPPR1   2
         1 000125   000000 701000 xent               TSX1    ZIM$JIDEL
         1 000126   000000 011000                    NOP     0

       72     4967    1       GLOBAL.DELI$->FPT$DELI.V.DCB#=AWS.DDCB;

   4967  1 000127   000000 470400 xsym               LDP0    GLOBAL$
         1 000130   005132 471500                    LDP1    2650,,PR0
         1 000131   200004 473500                    LDP3    AWS$,,AUTO
         1 000132   300006 220100                    LDX0    6,,PR3
         1 000133   100010 740100                    STX0    8,,PR1

       73     4968    1       ADDR(GLOBAL.DELI$->FPT$DELI.KEY_)->VLP$VECTOR.W1.VSIZE#=

   4968  1 000134   005132 471500                    LDP1    2650,,PR0
         1 000135   200012 474500                    LDP4    SC1$,,AUTO
         1 000136   400000 236100                    LDQ     0,,PR4
         1 000137   777777 376007                    ANQ     -1,DL
         1 000140   000001 136007                    SBLQ    1,DL
         1 000141   000020 736000                    QLS     16
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:13   
         1 000142   100002 676100                    ERQ     2,,PR1
         1 000143   000005 376000 2                  ANQ     5
         1 000144   100002 656100                    ERSQ    2,,PR1

       74     4969    1          SC1.KLNG-1;
       75     4970    1       IF AWS.ATRIB.CAC THEN

   4970  1 000145   300000 236100                    LDQ     0,,PR3
         1 000146   000001 316003                    CANQ    1,DU
         1 000147   000154 600000 1                  TZE     s:4972

       76     4971    1           CALL ZIM$ENQ_INDEXED(AWS) ALTRET(ALT);

   4971  1 000150   200004 630500                    EPPR0   AWS$,,AUTO
         1 000151   000006 631400 2                  EPPR1   6
         1 000152   000000 701000 xent               TSX1    ZIM$ENQ_INDEXED
         1 000153   000264 702000 1                  TSX2    ER_JRNL

       77     4972    1       CALL M$DELREC(GLOBAL.DELI$->FPT$DELI)

   4972  1 000154   000000 470400 xsym               LDP0    GLOBAL$
         1 000155   005132 471500                    LDP1    2650,,PR0
         1 000156   100000 630500                    EPPR0   0,,PR1
         1 000157   440002 713400                    CLIMB   alt,+16386
         1 000160   401400 401760                    pmme    nvectors=4
         1 000161   000163 702000 1                  TSX2    s:4974
         1 000162   000174 710000 1                  TRA     s:4978

       78     4973    2       WHENALTRETURN DO;

       79     4974    2           IF AWS.ATRIB.CAC THEN

   4974  1 000163   200004 470500                    LDP0    AWS$,,AUTO
         1 000164   000000 236100                    LDQ     0,,PR0
         1 000165   000001 316003                    CANQ    1,DU
         1 000166   000173 600000 1                  TZE     s:4976

PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:14   
       80     4975    2               CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);

   4975  1 000167   200004 630500                    EPPR0   AWS$,,AUTO
         1 000170   000006 631400 2                  EPPR1   6
         1 000171   000000 701000 xent               TSX1    ZIM$DEQ_INDEXED
         1 000172   000264 702000 1                  TSX2    ER_JRNL

       81     4976    2           GOTO ER_DELR;

   4976  1 000173   000246 710000 1                  TRA     ER_DELR

       82     4977    2           END;
       83     4978    1       IF AWS.ATRIB.CAC THEN

   4978  1 000174   200004 470500                    LDP0    AWS$,,AUTO
         1 000175   000000 236100                    LDQ     0,,PR0
         1 000176   000001 316003                    CANQ    1,DU
         1 000177   000204 600000 1                  TZE     s:4980

       84     4979    1           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);

   4979  1 000200   200004 630500                    EPPR0   AWS$,,AUTO
         1 000201   000006 631400 2                  EPPR1   6
         1 000202   000000 701000 xent               TSX1    ZIM$DEQ_INDEXED
         1 000203   000264 702000 1                  TSX2    ER_JRNL

       85     4980    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;

   4980  1 000204   000000 470400 xsym               LDP0    GLOBAL$
         1 000205   001425 235100                    LDA     789,,PR0
         1 000206   000001 035007                    ADLA    1,DL
         1 000207   001425 755100                    STA     789,,PR0

       86     4981    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;

   4981  1 000210   001426 235100                    LDA     790,,PR0
         1 000211   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:15   
         1 000212   001426 755100                    STA     790,,PR0

       87     4982    2       IF GLOBAL.PARAN.TRACE.MODE~='0'B THEN DO;

   4982  1 000213   000061 235100                    LDA     49,,PR0
         1 000214   000242 600000 1                  TZE     s:4991

       88     4983    2           GLOBAL.PARAN.TRACE.RTYPE=RC.RTYP;

   4983  1 000215   200013 471500                    LDP1    RC$,,AUTO
         1 000216   100003 720100                    LXL0    3,,PR1
         1 000217   007777 360003                    ANX0    4095,DU
         1 000220   000060 440100                    SXL0    48,,PR0

       89     4984    2           GLOBAL.PARAN.TRACE.RNAME=RC.RNAM;

   4984  1 000221   100000 721100                    LXL1    0,,PR1
         1 000222   000077 361003                    ANX1    63,DU
         1 000223   040100 100540                    MLR     fill='040'O
         1 000224   100005 000011                    ADSC9   5,,PR1                   cn=0,n=*X1
         1 000225   000046 000036                    ADSC9   38,,PR0                  cn=0,n=30

       90     4985    2           IF AWS.ATRIB.CAC THEN

   4985  1 000226   200004 473500                    LDP3    AWS$,,AUTO
         1 000227   300000 236100                    LDQ     0,,PR3
         1 000230   000001 316003                    CANQ    1,DU
         1 000231   000235 600000 1                  TZE     s:4988

       91     4986    2               GLOBAL.PARAN.TRACE.TYPE=TR#IDELENQ;

   4986  1 000232   000021 221003                    LDX1    17,DU
         1 000233   000060 741100                    STX1    48,,PR0
         1 000234   000237 710000 1                  TRA     s:4989

       92     4987    2           ELSE
       93     4988    2               GLOBAL.PARAN.TRACE.TYPE=TR#IDEL;
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:16   

   4988  1 000235   000012 221003                    LDX1    10,DU
         1 000236   000060 741100                    STX1    48,,PR0

       94     4989    2           CALL ZIM$TRACE;

   4989  1 000237   000002 631400 2                  EPPR1   2
         1 000240   000000 701000 xent               TSX1    ZIM$TRACE
         1 000241   000000 011000                    NOP     0

       95     4990    2           END;

       96     4991    1       RETURN;

   4991  1 000242   000000 702200 xent               TSX2  ! X66_ARET

       97     4992    1   ER_UNAVIL: ERROR=EXC#UNA;

   4992  1 000243   004230 235007       ER_UNAVIL    LDA     2200,DL
         1 000244   200015 755100                    STA     ERROR,,AUTO

       98     4993    1       GOTO ALT;

   4993  1 000245   000264 710000 1                  TRA     ER_JRNL

       99     4994    1   ER_DELR: ERROR=ERR#IX#DELAK;

   4994  1 000246   303424 235007       ER_DELR      LDA     100116,DL
         1 000247   200015 755100                    STA     ERROR,,AUTO

      100     4995    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4995  1 000250   000000 470400 xsym               LDP0    B$TCB$
         1 000251   000000 471500                    LDP1    0,,PR0
         1 000252   100102 236100                    LDQ     66,,PR1
         1 000253   000000 473400 xsym               LDP3    GLOBAL$
         1 000254   300007 756100                    STQ     7,,PR3
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:17   

      101     4996    1       GLOBAL.RET.DCB#=GLOBAL.DELI$->FPT$DELI.V.DCB#;

   4996  1 000255   305132 471500                    LDP1    2650,,PR3
         1 000256   100010 220100                    LDX0    8,,PR1
         1 000257   300014 740100                    STX0    12,,PR3

      102     4997    1       GOTO ALT;

   4997  1 000260   000264 710000 1                  TRA     ER_JRNL

      103     4998    1   ER_IUM:ERROR=EXC#IUM;

   4998  1 000261   021760 235007       ER_IUM       LDA     9200,DL
         1 000262   200015 755100                    STA     ERROR,,AUTO

      104     4999    1       GOTO ALT;

   4999  1 000263   000264 710000 1                  TRA     ER_JRNL

   4996  1 000264                       ER_JRNL      null
   4996  1 000264                       ALT          null
      105     5000    1   ER_JRNL: ;
      106     5001    1   ALT: ;
      107     5002            %DBALT;

   5003  1 000264   000000 470400 xsym               LDP0    GLOBAL$
         1 000265   000006 235100                    LDA     6,,PR0
         1 000266   000275 601000 1                  TNZ     s:5011

   5005  1 000267   000010 450100                    STZ     8,,PR0

   5006  1 000270   000012 450100                    STZ     10,,PR0

   5007  1 000271   000013 450100                    STZ     11,,PR0

   5008  1 000272   000011 450100                    STZ     9,,PR0
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:18   

   5009  1 000273   200015 236100                    LDQ     ERROR,,AUTO
         1 000274   000006 756100                    STQ     6,,PR0

   5011  1 000275   000006 235100                    LDA     6,,PR0
         1 000276   303240 115007                    CMPA    100000,DL
         1 000277   000301 603000 1                  TRC     s:5014

   5012  1 000300   000000 702200 xent               TSX2  ! X66_AALT

   5014  1 000301   000002 631400 2                  EPPR1   2
         1 000302   000000 701000 xent               TSX1    ZIB$ERR
         1 000303   000000 011000                    NOP     0

      108     5016    1   END ZIM$IDEL;

   5016  1 000304   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 006014   000004 000000   000000 000000   000002 006000    ................
   2     004   004624 200000   777777 600000   000001 000000                    ............
      109     5017        %EOD;

PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:19   
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$IDEL.

   Procedure ZIM$IDEL requires 197 words for executable code.
   Procedure ZIM$IDEL requires 22 words of local(AUTO) storage.
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:20   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:21   
          MINI XREF LISTING

ALT
      4996**LABEL    4962--CALLALT  4964--CALLALT  4971--CALLALT  4975--CALLALT  4979--CALLALT  4993--GOTO
      4997--GOTO     4999--GOTO
AWS
      1949**DCL      4971<>CALL     4975<>CALL     4979<>CALL
AWS.ATRIB.CAC
      1966**DCL      4956>>IF       4970>>IF       4974>>IF       4978>>IF       4985>>IF
AWS.ATRIB.FUN
      1962**DCL      4952>>IF
AWS.DDCB
      1974**DCL      4951>>IF       4958>>ASSIGN   4967>>ASSIGN
AWS$
      1948**DCL      1949--IMP-PTR  4950<<ASSIGN   4951>>IF       4952>>IF       4956>>IF       4958>>ASSIGN
      4967>>ASSIGN   4970>>IF       4971>>CALL     4974>>IF       4975>>CALL     4978>>IF       4979>>CALL
      4985>>IF
B$ALT.CODE
      2929**DCL      2929--REDEF    2930--REDEF    2930--REDEF
B$ALT.ERR
      2930**DCL      4995>>ASSIGN
B$ALT.ERR.ERR#
      2931**DCL      2931--REDEF
B$ALT.EVID
      2930**DCL      2930--REDEF    2930--REDEF
B$TCB.ALT$
      2925**DCL      4995>>ASSIGN
B$TCB$
      4931**DCL      4995>>ASSIGN
DBCB.IOWS.CFCT
      1899**DCL      1900--REDEF
DBCB.IOWS.DBKF.RQ
      1842**DCL      1843--REDEF
DBCB.IOWS.DBKR
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:22   
      1839**DCL      1840--REDEF
DBCB.IOWS.NOBF
      1901**DCL      1902--REDEF
DBCB.IOWS.SPND
      1827**DCL      1828--REDEF
DBCB.PCB.PRSC
      1688**DCL      4947>>ASSIGN
DBCB.PCB.RVI
      1675**DCL      4944>>ASSIGN
DBCB.SWS.RDYCW
      1565**DCL      1566--REDEF
DBCB.SWS.TEMP.PTR1$
      1599**DCL      1600--REDEF    1601--REDEF
DBCB.SWS.TEMP.PTR2$
      1602**DCL      1603--REDEF
DBCB$
      1470**DCL      1471--IMP-PTR  4943<<ASSIGN   4944>>ASSIGN   4944>>ASSIGN   4947>>ASSIGN   4954>>ASSIGN
ERROR
      4928**DCL      4992<<ASSIGN   4994<<ASSIGN   4998<<ASSIGN   5009>>ASSIGN
ER_DELR
      4994**LABEL    4976--GOTO
ER_IUM
      4998**LABEL    4953--GOTO
ER_UNAVIL
      4992**LABEL    4951--GOTO
FPT$DELI
      2901**DCL      4972<>CALL
FPT$DELI.KEY_
      2901**DCL      4968--ASSIGN
FPT$DELI.V.DCB#
      2905**DCL      4967<<ASSIGN   4996>>ASSIGN
GLOBAL.ACTIVE.DBCB$
       502**DCL       503--REDEF    4943>>ASSIGN
GLOBAL.ACTIVE.SSS$
       498**DCL       499--REDEF    4945>>ASSIGN
GLOBAL.DELI$
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:23   
       789**DCL      4967>>ASSIGN   4968>>ASSIGN   4972>>CALL     4996>>ASSIGN
GLOBAL.ENQ.SHARE
       622**DCL      4957<<ASSIGN
GLOBAL.ENQ.VALUE.DCB#
       629**DCL      4958<<ASSIGN
GLOBAL.ENQ.VALUE.RNAME
       631**DCL      4961<<ASSIGN
GLOBAL.KEY
       706**DCL       709--REDEF
GLOBAL.KEY.VALUE
       708**DCL      4955<<ASSIGN   4960<>CALL
GLOBAL.KEYID.RECID
       736**DCL      4963<<ASSIGN
GLOBAL.PARAN.TRACE.MODE
       581**DCL       588--REDEF    4982>>IF
GLOBAL.PARAN.TRACE.RNAME
       575**DCL      4984<<ASSIGN
GLOBAL.PARAN.TRACE.RTYPE
       580**DCL      4983<<ASSIGN
GLOBAL.PARAN.TRACE.TYPE
       579**DCL      4986<<ASSIGN   4988<<ASSIGN
GLOBAL.PRINTBUF.BUFFER
       740**DCL       741--REDEF     742--REDEF     743--REDEF
GLOBAL.PRINTBUF.ERR.V
       745**DCL       748--REDEF     749--REDEF     750--REDEF
GLOBAL.RET.AC#
       518**DCL      5005<<ASSIGN
GLOBAL.RET.DCB#
       522**DCL      4996<<ASSIGN
GLOBAL.RET.ERROR#
       516**DCL      5003>>IF       5009<<ASSIGN   5011>>IF
GLOBAL.RET.FR#
       519**DCL      5008<<ASSIGN
GLOBAL.RET.RC#
       521**DCL      5007<<ASSIGN
GLOBAL.RET.SC#
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:24   
       520**DCL      5006<<ASSIGN
GLOBAL.RET.SYSERR#
       517**DCL      4995<<ASSIGN
GLOBAL.STATS.CURR.READS
       656**DCL      4980<<ASSIGN   4980>>ASSIGN
GLOBAL.STATS.CURR.WRITES
       657**DCL      4981<<ASSIGN   4981>>ASSIGN
GLOBAL$
       800**DCL       496--IMP-PTR  4943>>ASSIGN   4945>>ASSIGN   4955>>ASSIGN   4957>>ASSIGN   4958>>ASSIGN
      4960>>CALL     4961>>ASSIGN   4963>>ASSIGN   4967>>ASSIGN   4968>>ASSIGN   4972>>CALL     4980>>ASSIGN
      4980>>ASSIGN   4981>>ASSIGN   4981>>ASSIGN   4982>>IF       4983>>ASSIGN   4984>>ASSIGN   4986>>ASSIGN
      4988>>ASSIGN   4995>>ASSIGN   4996>>ASSIGN   4996>>ASSIGN   5003>>IF       5005>>ASSIGN   5006>>ASSIGN
      5007>>ASSIGN   5008>>ASSIGN   5009>>ASSIGN   5011>>IF
HASH
      4942**DCL      4960<>CALL     4961>>ASSIGN
LENGTH
      4932**DCL      4934--IMP-SIZ  4959<<ASSIGN   4960<>CALL
M$DELREC
      2820**DCL-ENT  4972--CALL
OA.SCNAM.EIS.COUNT
      2624**DCL      2659--IMP-SIZ
OA$
      2602**DCL      2603--IMP-PTR  4946<<ASSIGN
OA1
      2594**DCL      4946--ASSIGN
OA1$
      2593**DCL      2594--IMP-PTR
RC.DEF.RNL
      2720**DCL      2730--IMP-SIZ  4984>>ASSIGN
RC.RCWSO
      2728**DCL      4954>>ASSIGN
RC.RNAM
      2730**DCL      4984>>ASSIGN
RC.RTYP
      2727**DCL      4983>>ASSIGN
RC$
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:25   
      2704**DCL      2705--IMP-PTR  4949<<ASSIGN   4954>>ASSIGN   4983>>ASSIGN   4984>>ASSIGN   4984>>ASSIGN
RECVAR.AWS$
      2034**DCL      4950>>ASSIGN
RECVAR.BADDR
      2010**DCL      2013--REDEF
RECVAR.RADDR
      2014**DCL      2018--REDEF
RECVAR.RCPTR
      2030**DCL      4949>>ASSIGN
RS.NPOS
      2761**DCL      2770--REDEF
RS$
      2735**DCL      2736--IMP-PTR
RVI$
      4930**DCL      4944<<ASSIGN   4949>>ASSIGN   4950>>ASSIGN
RWS.CURR
      2001**DCL      4963>>ASSIGN
RWS.KEY.LENGTH
      2003**DCL      2004--IMP-SIZ  4955>>ASSIGN
RWS.KEY.VALUE
      2004**DCL      4955>>ASSIGN
RWS$
      1988**DCL      1989--IMP-PTR  4954<<ASSIGN   4955>>ASSIGN   4955>>ASSIGN   4963>>ASSIGN
SC.DEF.SNL
      2680**DCL      2685--IMP-SIZ
SC$
      2667**DCL      2668--IMP-PTR  4947<<ASSIGN   4948>>ASSIGN
SC1
      2694**DCL      4948--ASSIGN
SC1.KLNG
      2696**DCL      4959>>ASSIGN   4968>>ASSIGN
SC1$
      2693**DCL      2694--IMP-PTR  4948<<ASSIGN   4959>>ASSIGN   4968>>ASSIGN
SSS$
      2049**DCL      4945<<ASSIGN   4946>>ASSIGN   4947>>ASSIGN   4949>>ASSIGN
VLP$VECTOR.W1.VSIZE#
PL6.E3A0      #001=ZIM$IDEL File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:56 Page:26   
      2920**DCL      4968<<ASSIGN
VLP$VECTOR.W2
      2921**DCL      2922--REDEF
ZIB$ERR
       801**DCL-ENT  5014--CALL
ZIM$DEQ_INDEXED
      4940**DCL-ENT  4975--CALL     4979--CALL
ZIM$ENQM
      4937**DCL-ENT  4962--CALL
ZIM$ENQ_INDEXED
      4939**DCL-ENT  4971--CALL
ZIM$IHASH
      4938**DCL-ENT  4960--CALL
ZIM$INDXMAP_ADD
      4941**DCL-ENT  4964--CALL
ZIM$JIDEL
      4935**DCL-ENT  4966--CALL
ZIM$TRACE
      4936**DCL-ENT  4989--CALL

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:27   
      110        1        /*M*     ZIM$IFIND - find useing alternate key     */
      111        2        /*T***********************************************************/
      112        3        /*T*                                                         */
      113        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      114        5        /*T*                                                         */
      115        6        /*T***********************************************************/
      116        7        ZIM$IFIND: PROC ALTRET
      117        8        /*          USE($PR5 FOR GLOBAL$)              */
      118        9               AVOID($PR5,$PR6,$PR7);
      119       10        /*       Input:   Key in KEYPA
      120       11                          ACPTR in the record variable RVI
      121       12                          DBCB.PCB.PRSC
      122       13
      123       14                           EXCEPT find first and last which dont set up the
      124       15                          key beforehand.
      125       16        */
      126       17        %INCLUDE ZI$GLOBAL;
      127      503            %GLOBALS;
      128      811            %TRCE_SUBS;
      129      835        %INCLUDE ZI$DBCB;
      130     1477            %DBCB;
      131     1955            %AWS;
      132     1995            %SETWS;
      133     2014            %RECVAR;
      134     2048        %INCLUDE ZI$SSS;
      135     2597            %OA;
      136     2662            %OA1;
      137     2670            %AC;
      138     2765            %SC;
      139     2792            %SC1;
      140     2802            %RC;
      141     2834            %RA;
      142     2854            %RS;
      143     2930        %INCLUDE ZI_ERRORS_C;
      144     3256        %INCLUDE CP_6;
      145     3337            %FPT_READ(FPTN=FPT$READI,STCLASS=BASED);
      146     3376            %FPT_PRECORD(FPTN=FPT$PRECI,STCLASS=BASED);
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:28   
      147     3397            %FPT_ENQ(FPTN=FPT$ENQI,STCLASS=BASED);
      148     3415            %FPT_DEQ(FPTN=FPT$DEQI,STCLASS=BASED);
      149     3432            %VLP_VECTOR(FPTN=VLP$VECTOR,STCLASS=BASED);
      150     3447            %F$DCB;
      151     3504            %B$TCB;
      152     3507            %B$ALT;
      153     3515        %INCLUDE FM$FIT;
      154     3736            %FITALTKEYS;
      155     3742        %INCLUDE B_ERRORS_C;
      156     4869        %INCLUDE CP_6_SUBS;
      157     5409    1   DCL B$TCB$ PTR SYMREF;
      158     5410    1   DCL PS0$ PTR SYMREF;
      159     5411    1   DCL ZI_MAXKEY CHAR(256) SYMREF;
      160     5412    1   DCL ZIM$GETRS ENTRY(3) ALTRET;
      161     5413    1   DCL ZIM$ICURR ENTRY;
      162     5414    1   DCL ZIM$PROL ENTRY ALTRET;
      163     5415    1   DCL ZIM$TRACE ENTRY;
      164     5416    1   DCL ZIM$ENQM ENTRY(1) ALTRET;
      165     5417    1   DCL ZIM$DEQ_ONE ENTRY ALTRET;
      166     5418    1   DCL ZIM$INDXMAP_ADD ENTRY ALTRET;
      167     5419    1   DCL ZIM$IHASH ENTRY(4);
      168     5420    1   DCL ZIM$ENQ_INDEXED ENTRY(1) ALTRET;
      169     5421    1   DCL ZIM$DEQ_INDEXED ENTRY(1) ALTRET;
      170     5422    1   DCL B$ROS$ PTR SYMREF;
      171     5423    1   DCL PCOMP BIT(1);
      172     5424    1   DCL TEMP UBIN HALF;
      173     5425    1   DCL ERROR UBIN(36);
      174     5426    1   DCL RVI$ PTR;
      175     5427    1   DCL FUNCT SBIN(36);
      176     5428    1   DCL LENGTH UBIN(36);
      177     5429    1   DCL 1 STRING BASED,
      178     5430    1         2 * CHAR(LENGTH) CALIGNED;
      179     5431    1   DCL ERR# UBIN;
      180     5432    1   DCL KEYX# UBIN;
      181     5433    1   DCL KEYL# UBIN;
      182     5434    1   DCL HASH UBIN;
      183     5435    1   DCL SAVE_KEY(0:255) CHAR(1) CALIGNED;
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:29   
      184     5436    1       FUNCT=1;
      185     5437    1       GOTO XNI;
      186     5438    1   ZIM$IFINDF: ENTRY ALTRET;
      187     5439    1       FUNCT=2;
      188     5440    1       GOTO XNI;
      189     5441    1   ZIM$IFINDL: ENTRY ALTRET;
      190     5442    1       FUNCT=3;
      191     5443    1       GOTO XNI;
      192     5444    1   ZIM$IFINDN: ENTRY ALTRET;
      193     5445    1       FUNCT=4;
      194     5446    1       GOTO XNI;
      195     5447    1   ZIM$IFINDP: ENTRY ALTRET;
      196     5448    1       FUNCT=5;
      197     5449    1   XNI: DBCB$=GLOBAL.ACTIVE.DBCB$;
      198     5450    1       SSS$=GLOBAL.ACTIVE.SSS$;
      199     5451    1       OA$=PINCRW(SSS$,SIZEW(OA1));
      200     5452    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);
      201     5453        /* Get RC given or use only one in AREA if unspecified */
      202     5454    1       RC$=PINCRW(SSS$,PINCRW(SSS$,PINCRW(SSS$,
      203     5455    1          RVI$->RECVAR.ACPTR)->AC.ACRAN)->RA.RCRAH);
      204     5456    1       IF DBCB.PCB.PRRC~=0 AND
      205     5457    1          RC$~=PINCRW(SSS$,DBCB.PCB.PRRC) THEN
      206     5458    1           GOTO ER_EOSR;
      207     5459    1       AWS$=PINCRW(DBCB$,PINCRW(SSS$,RVI$->RECVAR.ACPTR)->AC.WSOF);
      208     5460    1       IF AWS.DDCB = 0 THEN GOTO ER_UNAVIL;
      209     5461    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);
      210     5462    1       SC1$=PINCRW(SC$,-SIZEW(SC1));
      211     5463    1       CALL ZIM$GETRS(SC$,RC$,RS$) ALTRET(ALT);
      212     5464        /*          Remember key incase of retry operation */
      213     5465    2       DO CASE(FUNCT);
      214     5466    2       CASE(1,4,5);
      215     5467    2           SAVE_KEY=GLOBAL.KEY;
      216     5468    2           END;
      217     5469    1       GOTO SKIP;
      218     5470    1   RETRY: ;
      219     5471        /*          Reset key for retry operation */
      220     5472    2       DO CASE(FUNCT);
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:30   
      221     5473    2       CASE(1,4,5);
      222     5474    2           GLOBAL.KEY=SAVE_KEY;
      223     5475    2           END;
      224     5476    1   SKIP: ;
      225     5477    1       PCOMP=%NO#;
      226     5478    1       LENGTH=SC1.KLNG;
      227     5479    1       GLOBAL.PRECI$->FPT$PRECI.V.DCB#=AWS.DDCB;
      228     5480    1       GLOBAL.PRECI$->FPT$PRECI.V.INDX#=RS.DEF.IXNUM;
      229     5481    2       DO CASE(FUNCT);
      230     5482    2       CASE(1); /* ZIM$IFIND */
      231     5483    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=0;
      232     5484    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%NO#;
      233     5485    2       CASE(2); /* ZIM$IFINDF */
      234     5486    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=DBCB.SWS.ROCUR-1;
      235     5487    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%NO#;
      236     5488    2           GLOBAL.KEY='0'B;
      237     5489    2       CASE(3); /* ZIM$IFINDL */
      238     5490    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=DBCB.SWS.ROCUR;
      239     5491    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%NO#;
      240     5492    2           GLOBAL.KEY=ADDR(ZI_MAXKEY)->STRING;
      241     5493    2       CASE(4); /* ZIM$IFINDN */
      242     5494    2           IF PINCRW(DBCB$,SC.SCWSO)->SETWS.PRIV.CSE THEN
      243     5495    2               GLOBAL.PRECI$->FPT$PRECI.V.N#=0;
      244     5496    2           ELSE
      245     5497    2               GLOBAL.PRECI$->FPT$PRECI.V.N#=1;
      246     5498    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%YES#;
      247     5499    2           GLOBAL.KEYID.RECID=RVI$->RECVAR.DBKEY;
      248     5500    2       CASE(5); /* ZIM$IFINDP */
      249     5501         /* For current erased or not prior is always -1 */
      250     5502    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=-1;
      251     5503    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%YES#;
      252     5504    2           GLOBAL.KEYID.RECID=RVI$->RECVAR.DBKEY;
      253     5505    2           END; /* CASE */
      254     5506    1       ADDR(GLOBAL.PRECI$->FPT$PRECI.KEY_)->VLP$VECTOR.W1.VSIZE#=
      255     5507    1          SC1.KLNG-1;
      256     5508    1       IF AWS.ATRIB.CAC THEN
      257     5509    1           CALL ZIM$ENQ_INDEXED(AWS) ALTRET(ALT);
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:31   
      258     5510    1       CALL M$PRECORD(GLOBAL.PRECI$->FPT$PRECI) ALTRET(ER_READ);
      259     5511    1   READOK: IF ADDR(GLOBAL.KEY.VALUE)->STRING='0'B THEN
      260     5512    1           GOTO ER_EOSR;
      261     5513    1       GLOBAL.READI$->FPT$READI.V.DCB#=AWS.DDCB;
      262     5514    1       GLOBAL.READI$->FPT$READI.V.INDX#=RS.DEF.IXNUM;
      263     5515    1       GLOBAL.READI$->FPT$READI.BUF_.BUF$=DBCB.CSECT.IXBUF$;
      264     5516    1       GLOBAL.READI$->FPT$READI.BUF_.BOUND=OA.LRSZ*4-1;
      265     5517    1       GLOBAL.READI$->FPT$READI.KEY_=GLOBAL.PRECI$->FPT$PRECI.KEY_;
      266     5518    2       IF AWS.ATRIB.CAC THEN DO;
      267     5519    2           CALL M$READ(GLOBAL.READI$->FPT$READI) ALTRET(ER_UNEX);
      268     5520    2           GLOBAL.ENQ.SHARE=%ALL#;
      269     5521    2           GLOBAL.ENQ.VALUE.DCB#=AWS.DDCB;
      270     5522    2           KEYX#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->
      271     5523    2              FITALTKEYS.K.KEYX(0);
      272     5524    2           KEYL#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->
      273     5525    2              FITALTKEYS.K.KEYL(0);
      274     5526    2           CALL ZIM$IHASH(DBCB.CSECT.IXBUF$->STRING,KEYX#,KEYL#,HASH);
      275     5527    2           GLOBAL.ENQ.VALUE.RNAME=HASH;
      276     5528    2           CALL ZIM$ENQM(0)
      277     5529    3           WHENALTRETURN DO;
      278     5530        /*                     See if its a real deadlock/timout or not. */
      279     5531    3               ERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#;
      280     5532    3               CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);
      281     5533    3               IF ERR#=%E$TIMELIMIT OR
      282     5534    4                  ERR#=%E$DLOCK THEN DO;
      283     5535    4                   CALL ZIM$ENQM ALTRET(ALT);
      284     5536    4                   CALL ZIM$DEQ_ONE ALTRET(ALT);
      285     5537    4                   GOTO RETRY;
      286     5538    4                   END;
      287     5539    3               GOTO E_CAC;
      288     5540    3               END;
      289     5541    2           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);
      290     5542    2           END;
      291     5543    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;
      292     5544    1       CALL M$READ(GLOBAL.READI$->FPT$READI)
      293     5545    2       WHENALTRETURN DO;
      294     5546    2           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:32   
      295     5547    2               GOTO RETRY;
      296     5548    2           GOTO ER_UNEX;
      297     5549    2           END;
      298     5550    1       IF AWS.ATRIB.CAC THEN
      299     5551    1           CALL ZIM$INDXMAP_ADD ALTRET(ALT);
      300     5552    1       RVI$->RECVAR.DBKEY=GLOBAL.KEYID.RECID;
      301     5553    1       RVI$->RECVAR.RECSZ=DCBADDR(AWS.DDCB)->F$DCB.ARS#;
      302     5554    1       RVI$->RECVAR.RTP.TYPE=RC.RTYP;
      303     5555    1       RVI$->RECVAR.BADDR$=ADDR(NIL);
      304     5556    1       RVI$->RECVAR.RADDR$=DBCB.CSECT.IXBUF$;
      305     5557    1       RVI$->RECVAR.AWS$=AWS$;
      306     5558    1       IF (RC.DEF.FVR = '0'B AND
      307     5559    1          RC.RSIZ ~= RVI$->RECVAR.RECSZ)
      308     5560    1          OR (RC.DEF.FVR = '1'B AND
      309     5561    1          RC.RSIZ < RVI$ -> RECVAR.RECSZ) THEN
      310     5562    1           GOTO ER_SIZE;
      311     5563    1       RVI$->RECVAR.RCPTR=POFFW(RC$,SSS$);
      312     5564    2       IF GLOBAL.PARAN.TRACE.MODE~='0'B THEN DO;
      313     5565    2           GLOBAL.PARAN.TRACE.RTYPE=RC.RTYP;
      314     5566    2           GLOBAL.PARAN.TRACE.RNAME=RC.RNAM;
      315     5567    2           IF AWS.ATRIB.CAC THEN
      316     5568    2               GLOBAL.PARAN.TRACE.TYPE=TR#IREADENQ;
      317     5569    2           ELSE
      318     5570    2               GLOBAL.PARAN.TRACE.TYPE=TR#IREAD;
      319     5571    2           CALL ZIM$TRACE;
      320     5572    2           END;
      321     5573    1       TEMP=DBCB.PCB.RVI;
      322     5574    1       DBCB.PCB.RVI=DBCB.PCB.RVO;
      323     5575    1       DBCB.PCB.RVO=TEMP;
      324     5576    1       CALL ZIM$ICURR;
      325     5577    1       IF PCOMP AND FUNCT=1 THEN
      326     5578    1           GOTO EX_PCOMP;
      327     5579    1       RETURN;
      328     5580    2   ER_READ: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN DO;
      329     5581    2           PCOMP=%YES#;
      330     5582    2           GOTO READOK;
      331     5583    2           END;
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:33   
      332     5584    1       ELSE
      333     5585    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$BOF OR
      334     5586    1              B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$EOF THEN
      335     5587    1               GOTO ER_EOSR;
      336     5588    1           ELSE
      337     5589    1               GOTO ER_UNEX;
      338     5590    1   ER_UNAVIL: ERROR=EXC#UNA;
      339     5591    1       GOTO ALT;
      340     5592    1   E_CAC: ERROR=ERR#IO#CAC;
      341     5593    1       GOTO ALT;
      342     5594    1   ER_UNEX: ERROR=ERR#IX#UNEX;
      343     5595    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      344     5596    1       GLOBAL.RET.DCB#=AWS.DDCB;
      345     5597    1       GOTO ALT;
      346     5598    1   EX_PCOMP: ERROR=EXC#PCOMP;
      347     5599            %DBEXC;
      348     5603    1   ER_EOSR: IF AWS.ATRIB.CAC THEN
      349     5604    1           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);
      350     5605    1       ERROR=EXC#EOSR;
      351     5606    1       GOTO ALT;
      352     5607    1   ER_SIZE: ERROR=ERR#CM#RSZER;
      353     5608    1   ER_ENQM: ;
      354     5609    1   ALT: ;
      355     5610            %DBALT;
      356     5624    1   END ZIM$IFIND;
      357     5625        %EOD;

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:34   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$IFIND.

   Procedure ZIM$IFIND requires 490 words for executable code.
   Procedure ZIM$IFIND requires 94 words of local(AUTO) storage.

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:35   

 Object Unit name= ZIM$IFIND                                  File name= ZIM$INDEXED.:ZIC0TOU
 UTS= SEP 05 '97 12:57:04.68 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   490    752  ZIM$IFIND
    2  RoData even  none    10     12  ZIM$IFIND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       0  ZIM$IFIND
     1      5          yes     yes      XStd       0  ZIM$IFINDF
     1     12          yes     yes      XStd       0  ZIM$IFINDL
     1     17          yes     yes      XStd       0  ZIM$IFINDN
     1     24          yes     yes      XStd       0  ZIM$IFINDP
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:36   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           XStd      3 ZIM$GETRS
 yes     yes           XStd      1 ZIM$ENQ_INDEXED
         yes           XStd      4 ZIM$IHASH
 yes     yes           XStd      1 ZIM$DEQ_INDEXED
 yes     yes           XStd      1 ZIM$ENQM
         yes           XStd      0 ZIM$TRACE
         yes           XStd      0 ZIM$ICURR
         yes           XStd      0 ZIB$ERR
 yes     yes           XStd      0 ZIM$INDXMAP_ADD
 yes     yes           XStd      0 ZIM$DEQ_ONE
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$TCB$
     PS0$                                  ZI_MAXKEY                             B$ROS$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ROSID                                 ISSID
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:37   


      110        1        /*M*     ZIM$IFIND - find useing alternate key     */
      111        2        /*T***********************************************************/
      112        3        /*T*                                                         */
      113        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      114        5        /*T*                                                         */
      115        6        /*T***********************************************************/
      116        7        ZIM$IFIND: PROC ALTRET

      7  1 000000   000000 700200 xent  ZIM$IFIND    TSX0  ! X66_AUTO_0
         1 000001   000136 000000                    ZERO    94,0

      117        8        /*          USE($PR5 FOR GLOBAL$)              */
      118        9               AVOID($PR5,$PR6,$PR7);
      119       10        /*       Input:   Key in KEYPA
      120       11                          ACPTR in the record variable RVI
      121       12                          DBCB.PCB.PRSC
      122       13
      123       14                           EXCEPT find first and last which dont set up the
      124       15                          key beforehand.
      125       16        */
      126       17        %INCLUDE ZI$GLOBAL;
      127      503            %GLOBALS;
      128      811            %TRCE_SUBS;
      129      835        %INCLUDE ZI$DBCB;
      130     1477            %DBCB;
      131     1955            %AWS;
      132     1995            %SETWS;
      133     2014            %RECVAR;
      134     2048        %INCLUDE ZI$SSS;
      135     2597            %OA;
      136     2662            %OA1;
      137     2670            %AC;
      138     2765            %SC;
      139     2792            %SC1;
      140     2802            %RC;
      141     2834            %RA;
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:38   
      142     2854            %RS;
      143     2930        %INCLUDE ZI_ERRORS_C;
      144     3256        %INCLUDE CP_6;
      145     3337            %FPT_READ(FPTN=FPT$READI,STCLASS=BASED);
      146     3376            %FPT_PRECORD(FPTN=FPT$PRECI,STCLASS=BASED);
      147     3397            %FPT_ENQ(FPTN=FPT$ENQI,STCLASS=BASED);
      148     3415            %FPT_DEQ(FPTN=FPT$DEQI,STCLASS=BASED);
      149     3432            %VLP_VECTOR(FPTN=VLP$VECTOR,STCLASS=BASED);
      150     3447            %F$DCB;
      151     3504            %B$TCB;
      152     3507            %B$ALT;
      153     3515        %INCLUDE FM$FIT;
      154     3736            %FITALTKEYS;
      155     3742        %INCLUDE B_ERRORS_C;
      156     4869        %INCLUDE CP_6_SUBS;
      157     5409    1   DCL B$TCB$ PTR SYMREF;
      158     5410    1   DCL PS0$ PTR SYMREF;
      159     5411    1   DCL ZI_MAXKEY CHAR(256) SYMREF;
      160     5412    1   DCL ZIM$GETRS ENTRY(3) ALTRET;
      161     5413    1   DCL ZIM$ICURR ENTRY;
      162     5414    1   DCL ZIM$PROL ENTRY ALTRET;
      163     5415    1   DCL ZIM$TRACE ENTRY;
      164     5416    1   DCL ZIM$ENQM ENTRY(1) ALTRET;
      165     5417    1   DCL ZIM$DEQ_ONE ENTRY ALTRET;
      166     5418    1   DCL ZIM$INDXMAP_ADD ENTRY ALTRET;
      167     5419    1   DCL ZIM$IHASH ENTRY(4);
      168     5420    1   DCL ZIM$ENQ_INDEXED ENTRY(1) ALTRET;
      169     5421    1   DCL ZIM$DEQ_INDEXED ENTRY(1) ALTRET;
      170     5422    1   DCL B$ROS$ PTR SYMREF;
      171     5423    1   DCL PCOMP BIT(1);
      172     5424    1   DCL TEMP UBIN HALF;
      173     5425    1   DCL ERROR UBIN(36);
      174     5426    1   DCL RVI$ PTR;
      175     5427    1   DCL FUNCT SBIN(36);
      176     5428    1   DCL LENGTH UBIN(36);
      177     5429    1   DCL 1 STRING BASED,
      178     5430    1         2 * CHAR(LENGTH) CALIGNED;
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:39   
      179     5431    1   DCL ERR# UBIN;
      180     5432    1   DCL KEYX# UBIN;
      181     5433    1   DCL KEYL# UBIN;
      182     5434    1   DCL HASH UBIN;
      183     5435    1   DCL SAVE_KEY(0:255) CHAR(1) CALIGNED;
      184     5436    1       FUNCT=1;

   5436  1 000002   000001 235007                    LDA     1,DL
         1 000003   200023 755100                    STA     FUNCT,,AUTO

      185     5437    1       GOTO XNI;

   5437  1 000004   000030 710000 1                  TRA     XNI

      186     5438    1   ZIM$IFINDF: ENTRY ALTRET;

   5438  1 000005   000000 700200 xent  ZIM$IFINDF   TSX0  ! X66_AUTO_0
         1 000006   000136 000000                    ZERO    94,0

      187     5439    1       FUNCT=2;

   5439  1 000007   000002 235007                    LDA     2,DL
         1 000010   200023 755100                    STA     FUNCT,,AUTO

      188     5440    1       GOTO XNI;

   5440  1 000011   000030 710000 1                  TRA     XNI

      189     5441    1   ZIM$IFINDL: ENTRY ALTRET;

   5441  1 000012   000000 700200 xent  ZIM$IFINDL   TSX0  ! X66_AUTO_0
         1 000013   000136 000000                    ZERO    94,0

      190     5442    1       FUNCT=3;

   5442  1 000014   000003 235007                    LDA     3,DL
         1 000015   200023 755100                    STA     FUNCT,,AUTO
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:40   

      191     5443    1       GOTO XNI;

   5443  1 000016   000030 710000 1                  TRA     XNI

      192     5444    1   ZIM$IFINDN: ENTRY ALTRET;

   5444  1 000017   000000 700200 xent  ZIM$IFINDN   TSX0  ! X66_AUTO_0
         1 000020   000136 000000                    ZERO    94,0

      193     5445    1       FUNCT=4;

   5445  1 000021   000004 235007                    LDA     4,DL
         1 000022   200023 755100                    STA     FUNCT,,AUTO

      194     5446    1       GOTO XNI;

   5446  1 000023   000030 710000 1                  TRA     XNI

      195     5447    1   ZIM$IFINDP: ENTRY ALTRET;

   5447  1 000024   000000 700200 xent  ZIM$IFINDP   TSX0  ! X66_AUTO_0
         1 000025   000136 000000                    ZERO    94,0

      196     5448    1       FUNCT=5;

   5448  1 000026   000005 235007                    LDA     5,DL
         1 000027   200023 755100                    STA     FUNCT,,AUTO

      197     5449    1   XNI: DBCB$=GLOBAL.ACTIVE.DBCB$;

   5449  1 000030   000000 470400 xsym  XNI          LDP0    GLOBAL$
         1 000031   000001 236100                    LDQ     1,,PR0
         1 000032   200003 756100                    STQ     DBCB$,,AUTO

      198     5450    1       SSS$=GLOBAL.ACTIVE.SSS$;

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:41   
   5450  1 000033   000000 236100                    LDQ     0,,PR0
         1 000034   200006 756100                    STQ     SSS$,,AUTO

      199     5451    1       OA$=PINCRW(SSS$,SIZEW(OA1));

   5451  1 000035   000001 036003                    ADLQ    1,DU
         1 000036   200007 756100                    STQ     OA$,,AUTO

      200     5452    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);

   5452  1 000037   200003 471500                    LDP1    DBCB$,,AUTO
         1 000040   100510 220100                    LDX0    328,,PR1
         1 000041   000000 636010                    EAQ     0,X0
         1 000042   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000043   200022 756100                    STQ     RVI$,,AUTO

      201     5453        /* Get RC given or use only one in AREA if unspecified */
      202     5454    1       RC$=PINCRW(SSS$,PINCRW(SSS$,PINCRW(SSS$,

   5454  1 000044   200022 473500                    LDP3    RVI$,,AUTO
         1 000045   300005 221100                    LDX1    5,,PR3
         1 000046   200006 474500                    LDP4    SSS$,,AUTO
         1 000047   400001 722111                    LXL2    1,X1,PR4
         1 000050   400002 223112                    LDX3    2,X2,PR4
         1 000051   000000 636013                    EAQ     0,X3
         1 000052   200006 036100                    ADLQ    SSS$,,AUTO
         1 000053   200014 756100                    STQ     RC$,,AUTO

      203     5455    1          RVI$->RECVAR.ACPTR)->AC.ACRAN)->RA.RCRAH);
      204     5456    1       IF DBCB.PCB.PRRC~=0 AND

   5456  1 000054   100517 221100                    LDX1    335,,PR1
         1 000055   000062 600000 1                  TZE     s:5459
         1 000056   000000 636011                    EAQ     0,X1
         1 000057   200006 036100                    ADLQ    SSS$,,AUTO
         1 000060   200014 116100                    CMPQ    RC$,,AUTO
         1 000061   000714 601000 1                  TNZ     ER_EOSR
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:42   

      205     5457    1          RC$~=PINCRW(SSS$,DBCB.PCB.PRRC) THEN
      206     5458    1           GOTO ER_EOSR;
      207     5459    1       AWS$=PINCRW(DBCB$,PINCRW(SSS$,RVI$->RECVAR.ACPTR)->AC.WSOF);

   5459  1 000062   300005 222100                    LDX2    5,,PR3
         1 000063   400003 223112                    LDX3    3,X2,PR4
         1 000064   000000 636013                    EAQ     0,X3
         1 000065   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000066   200004 756100                    STQ     AWS$,,AUTO

      208     5460    1       IF AWS.DDCB = 0 THEN GOTO ER_UNAVIL;

   5460  1 000067   200004 470500                    LDP0    AWS$,,AUTO
         1 000070   000006 224100                    LDX4    6,,PR0
         1 000071   000666 600000 1                  TZE     ER_UNAVIL

      209     5461    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);

   5461  1 000072   100520 225100                    LDX5    336,,PR1
         1 000073   000000 636015                    EAQ     0,X5
         1 000074   200006 036100                    ADLQ    SSS$,,AUTO
         1 000075   200012 756100                    STQ     SC$,,AUTO

      210     5462    1       SC1$=PINCRW(SC$,-SIZEW(SC1));

   5462  1 000076   777776 036003                    ADLQ    -2,DU
         1 000077   200013 756100                    STQ     SC1$,,AUTO

      211     5463    1       CALL ZIM$GETRS(SC$,RC$,RS$) ALTRET(ALT);

   5463  1 000100   200016 630500                    EPPR0   RS$,,AUTO
         1 000101   200134 450500                    STP0    SAVE_KEY+67,,AUTO
         1 000102   200014 630500                    EPPR0   RC$,,AUTO
         1 000103   200133 450500                    STP0    SAVE_KEY+66,,AUTO
         1 000104   200012 630500                    EPPR0   SC$,,AUTO
         1 000105   200132 450500                    STP0    SAVE_KEY+65,,AUTO
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:43   
         1 000106   200132 630500                    EPPR0   SAVE_KEY+65,,AUTO
         1 000107   000001 631400 2                  EPPR1   1
         1 000110   000000 701000 xent               TSX1    ZIM$GETRS
         1 000111   000731 702000 1                  TSX2    ER_ENQM

      212     5464        /*          Remember key incase of retry operation */
      213     5465    2       DO CASE(FUNCT);

   5465  1 000112   200023 235100                    LDA     FUNCT,,AUTO
         1 000113   000006 115007                    CMPA    6,DL
         1 000114   000116 602005 1                  TNC     s:5465+4,AL
         1 000115   000130 710000 1                  TRA     s:5469
         1 000116   000130 710000 1                  TRA     s:5469
         1 000117   000124 710000 1                  TRA     s:5467
         1 000120   000130 710000 1                  TRA     s:5469
         1 000121   000130 710000 1                  TRA     s:5469
         1 000122   000124 710000 1                  TRA     s:5467
         1 000123   000124 710000 1                  TRA     s:5467

      214     5466    2       CASE(1,4,5);

      215     5467    2           SAVE_KEY=GLOBAL.KEY;

   5467  1 000124   000000 470400 xsym               LDP0    GLOBAL$
         1 000125   000100 100500                    MLR     fill='000'O
         1 000126   004624 000400                    ADSC9   2452,,PR0                cn=0,n=256
         1 000127   200031 000400                    ADSC9   SAVE_KEY,,AUTO           cn=0,n=256

      216     5468    2           END;

      217     5469    1       GOTO SKIP;

   5469  1 000130   000147 710000 1                  TRA     SKIP

   5465  1 000131                       RETRY        null
      218     5470    1   RETRY: ;
      219     5471        /*          Reset key for retry operation */
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:44   
      220     5472    2       DO CASE(FUNCT);

   5472  1 000131   200023 235100                    LDA     FUNCT,,AUTO
         1 000132   000006 115007                    CMPA    6,DL
         1 000133   000135 602005 1                  TNC     RETRY+4,AL
         1 000134   000147 710000 1                  TRA     SKIP
         1 000135   000147 710000 1                  TRA     SKIP
         1 000136   000143 710000 1                  TRA     s:5474
         1 000137   000147 710000 1                  TRA     SKIP
         1 000140   000147 710000 1                  TRA     SKIP
         1 000141   000143 710000 1                  TRA     s:5474
         1 000142   000143 710000 1                  TRA     s:5474

      221     5473    2       CASE(1,4,5);

      222     5474    2           GLOBAL.KEY=SAVE_KEY;

   5474  1 000143   000000 470400 xsym               LDP0    GLOBAL$
         1 000144   000100 100500                    MLR     fill='000'O
         1 000145   200031 000400                    ADSC9   SAVE_KEY,,AUTO           cn=0,n=256
         1 000146   004624 000400                    ADSC9   2452,,PR0                cn=0,n=256

      223     5475    2           END;

   5472  1 000147                       SKIP         null
      224     5476    1   SKIP: ;
      225     5477    1       PCOMP=%NO#;

   5477  1 000147   200017 450100                    STZ     PCOMP,,AUTO

      226     5478    1       LENGTH=SC1.KLNG;

   5478  1 000150   200013 470500                    LDP0    SC1$,,AUTO
         1 000151   000000 236100                    LDQ     0,,PR0
         1 000152   777777 376007                    ANQ     -1,DL
         1 000153   200024 756100                    STQ     LENGTH,,AUTO

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:45   
      227     5479    1       GLOBAL.PRECI$->FPT$PRECI.V.DCB#=AWS.DDCB;

   5479  1 000154   000000 471400 xsym               LDP1    GLOBAL$
         1 000155   105131 473500                    LDP3    2649,,PR1
         1 000156   200004 474500                    LDP4    AWS$,,AUTO
         1 000157   400006 220100                    LDX0    6,,PR4
         1 000160   300006 740100                    STX0    6,,PR3

      228     5480    1       GLOBAL.PRECI$->FPT$PRECI.V.INDX#=RS.DEF.IXNUM;

   5480  1 000161   105131 473500                    LDP3    2649,,PR1
         1 000162   200016 470500                    LDP0    RS$,,AUTO
         1 000163   000000 236100                    LDQ     0,,PR0
         1 000164   300006 552104                    STBQ    6,'04'O,PR3

      229     5481    2       DO CASE(FUNCT);

   5481  1 000165   000006 115007                    CMPA    6,DL
         1 000166   000170 602005 1                  TNC     s:5481+3,AL
         1 000167   000267 710000 1                  TRA     s:5506
         1 000170   000267 710000 1                  TRA     s:5506
         1 000171   000176 710000 1                  TRA     s:5483
         1 000172   000204 710000 1                  TRA     s:5486
         1 000173   000220 710000 1                  TRA     s:5490
         1 000174   000234 710000 1                  TRA     s:5494
         1 000175   000256 710000 1                  TRA     s:5502

      230     5482    2       CASE(1); /* ZIM$IFIND */

      231     5483    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=0;

   5483  1 000176   105131 470500                    LDP0    2649,,PR1
         1 000177   000007 450100                    STZ     7,,PR0

      232     5484    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%NO#;

   5484  1 000200   105131 470500                    LDP0    2649,,PR1
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:46   
         1 000201   000002 236000 2                  LDQ     2
         1 000202   000006 356100                    ANSQ    6,,PR0
         1 000203   000267 710000 1                  TRA     s:5506

      233     5485    2       CASE(2); /* ZIM$IFINDF */

      234     5486    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=DBCB.SWS.ROCUR-1;

   5486  1 000204   105131 470500                    LDP0    2649,,PR1
         1 000205   200003 473500                    LDP3    DBCB$,,AUTO
         1 000206   300041 235100                    LDA     33,,PR3
         1 000207   000001 135007                    SBLA    1,DL
         1 000210   000007 755100                    STA     7,,PR0

      235     5487    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%NO#;

   5487  1 000211   105131 470500                    LDP0    2649,,PR1
         1 000212   000002 236000 2                  LDQ     2
         1 000213   000006 356100                    ANSQ    6,,PR0

      236     5488    2           GLOBAL.KEY='0'B;

   5488  1 000214   000100 100400                    MLR     fill='000'O
         1 000215   000003 000001 2                  ADSC9   3                        cn=0,n=1
         1 000216   104624 000400                    ADSC9   2452,,PR1                cn=0,n=256
         1 000217   000267 710000 1                  TRA     s:5506

      237     5489    2       CASE(3); /* ZIM$IFINDL */

      238     5490    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=DBCB.SWS.ROCUR;

   5490  1 000220   105131 470500                    LDP0    2649,,PR1
         1 000221   200003 473500                    LDP3    DBCB$,,AUTO
         1 000222   300041 235100                    LDA     33,,PR3
         1 000223   000007 755100                    STA     7,,PR0

      239     5491    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%NO#;
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:47   

   5491  1 000224   105131 470500                    LDP0    2649,,PR1
         1 000225   000002 236000 2                  LDQ     2
         1 000226   000006 356100                    ANSQ    6,,PR0

      240     5492    2           GLOBAL.KEY=ADDR(ZI_MAXKEY)->STRING;

   5492  1 000227   200024 720100                    LXL0    LENGTH,,AUTO
         1 000230   000100 100440                    MLR     fill='000'O
         1 000231   000000 000010 xsym               ADSC9   ZI_MAXKEY                cn=0,n=*X0
         1 000232   104624 000400                    ADSC9   2452,,PR1                cn=0,n=256
         1 000233   000267 710000 1                  TRA     s:5506

      241     5493    2       CASE(4); /* ZIM$IFINDN */

      242     5494    2           IF PINCRW(DBCB$,SC.SCWSO)->SETWS.PRIV.CSE THEN

   5494  1 000234   200012 470500                    LDP0    SC$,,AUTO
         1 000235   000001 220100                    LDX0    1,,PR0
         1 000236   200003 473500                    LDP3    DBCB$,,AUTO
         1 000237   300000 234110                    SZN     0,X0,PR3
         1 000240   000244 605000 1                  TPL     s:5497

      243     5495    2               GLOBAL.PRECI$->FPT$PRECI.V.N#=0;

   5495  1 000241   105131 470500                    LDP0    2649,,PR1
         1 000242   000007 450100                    STZ     7,,PR0
         1 000243   000247 710000 1                  TRA     s:5498

      244     5496    2           ELSE
      245     5497    2               GLOBAL.PRECI$->FPT$PRECI.V.N#=1;

   5497  1 000244   105131 470500                    LDP0    2649,,PR1
         1 000245   000001 236007                    LDQ     1,DL
         1 000246   000007 756100                    STQ     7,,PR0

      246     5498    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%YES#;
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:48   

   5498  1 000247   105131 470500                    LDP0    2649,,PR1
         1 000250   040000 236007                    LDQ     16384,DL
         1 000251   000006 256100                    ORSQ    6,,PR0

      247     5499    2           GLOBAL.KEYID.RECID=RVI$->RECVAR.DBKEY;

   5499  1 000252   200022 470500                    LDP0    RVI$,,AUTO
         1 000253   000000 235100                    LDA     0,,PR0
         1 000254   105012 755100                    STA     2570,,PR1
         1 000255   000267 710000 1                  TRA     s:5506

      248     5500    2       CASE(5); /* ZIM$IFINDP */

      249     5501         /* For current erased or not prior is always -1 */
      250     5502    2           GLOBAL.PRECI$->FPT$PRECI.V.N#=-1;

   5502  1 000256   105131 470500                    LDP0    2649,,PR1
         1 000257   000001 336007                    LCQ     1,DL
         1 000260   000007 756100                    STQ     7,,PR0

      251     5503    2           GLOBAL.PRECI$->FPT$PRECI.V.IDS#=%YES#;

   5503  1 000261   105131 470500                    LDP0    2649,,PR1
         1 000262   040000 236007                    LDQ     16384,DL
         1 000263   000006 256100                    ORSQ    6,,PR0

      252     5504    2           GLOBAL.KEYID.RECID=RVI$->RECVAR.DBKEY;

   5504  1 000264   200022 470500                    LDP0    RVI$,,AUTO
         1 000265   000000 235100                    LDA     0,,PR0
         1 000266   105012 755100                    STA     2570,,PR1

      253     5505    2           END; /* CASE */

      254     5506    1       ADDR(GLOBAL.PRECI$->FPT$PRECI.KEY_)->VLP$VECTOR.W1.VSIZE#=

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:49   
   5506  1 000267   105131 470500                    LDP0    2649,,PR1
         1 000270   200013 473500                    LDP3    SC1$,,AUTO
         1 000271   300000 236100                    LDQ     0,,PR3
         1 000272   777777 376007                    ANQ     -1,DL
         1 000273   000001 136007                    SBLQ    1,DL
         1 000274   000020 736000                    QLS     16
         1 000275   000002 676100                    ERQ     2,,PR0
         1 000276   000004 376000 2                  ANQ     4
         1 000277   000002 656100                    ERSQ    2,,PR0

      255     5507    1          SC1.KLNG-1;
      256     5508    1       IF AWS.ATRIB.CAC THEN

   5508  1 000300   400000 236100                    LDQ     0,,PR4
         1 000301   000001 316003                    CANQ    1,DU
         1 000302   000307 600000 1                  TZE     s:5510

      257     5509    1           CALL ZIM$ENQ_INDEXED(AWS) ALTRET(ALT);

   5509  1 000303   200004 630500                    EPPR0   AWS$,,AUTO
         1 000304   000005 631400 2                  EPPR1   5
         1 000305   000000 701000 xent               TSX1    ZIM$ENQ_INDEXED
         1 000306   000731 702000 1                  TSX2    ER_ENQM

      258     5510    1       CALL M$PRECORD(GLOBAL.PRECI$->FPT$PRECI) ALTRET(ER_READ);

   5510  1 000307   000000 470400 xsym               LDP0    GLOBAL$
         1 000310   005131 471500                    LDP1    2649,,PR0
         1 000311   100000 630500                    EPPR0   0,,PR1
         1 000312   440003 713400                    CLIMB   alt,+16387
         1 000313   401000 401760                    pmme    nvectors=3
         1 000314   000650 702000 1                  TSX2    ER_READ

      259     5511    1   READOK: IF ADDR(GLOBAL.KEY.VALUE)->STRING='0'B THEN

   5511  1 000315   000000 470400 xsym  READOK       LDP0    GLOBAL$
         1 000316   200024 720100                    LXL0    LENGTH,,AUTO
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:50   
         1 000317   000000 106540                    CMPC    fill='000'O
         1 000320   004624 200010                    ADSC9   2452,,PR0                cn=1,n=*X0
         1 000321   000003 000002 2                  ADSC9   3                        cn=0,n=2
         1 000322   000714 600000 1                  TZE     ER_EOSR

      260     5512    1           GOTO ER_EOSR;
      261     5513    1       GLOBAL.READI$->FPT$READI.V.DCB#=AWS.DDCB;

   5513  1 000323   005075 471500                    LDP1    2621,,PR0
         1 000324   200004 473500                    LDP3    AWS$,,AUTO
         1 000325   300006 221100                    LDX1    6,,PR3
         1 000326   100010 741100                    STX1    8,,PR1

      262     5514    1       GLOBAL.READI$->FPT$READI.V.INDX#=RS.DEF.IXNUM;

   5514  1 000327   005075 471500                    LDP1    2621,,PR0
         1 000330   200016 474500                    LDP4    RS$,,AUTO
         1 000331   400000 236100                    LDQ     0,,PR4
         1 000332   100010 552104                    STBQ    8,'04'O,PR1

      263     5515    1       GLOBAL.READI$->FPT$READI.BUF_.BUF$=DBCB.CSECT.IXBUF$;

   5515  1 000333   005075 471500                    LDP1    2621,,PR0
         1 000334   200003 474500                    LDP4    DBCB$,,AUTO
         1 000335   400011 236100                    LDQ     9,,PR4
         1 000336   100005 756100                    STQ     5,,PR1

      264     5516    1       GLOBAL.READI$->FPT$READI.BUF_.BOUND=OA.LRSZ*4-1;

   5516  1 000337   005075 471500                    LDP1    2621,,PR0
         1 000340   200007 470500                    LDP0    OA$,,AUTO
         1 000341   000017 236100                    LDQ     15,,PR0
         1 000342   000002 736000                    QLS     2
         1 000343   000006 376000 2                  ANQ     6
         1 000344   000001 136007                    SBLQ    1,DL
         1 000345   000020 736000                    QLS     16
         1 000346   100004 676100                    ERQ     4,,PR1
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:51   
         1 000347   000004 376000 2                  ANQ     4
         1 000350   100004 656100                    ERSQ    4,,PR1

      265     5517    1       GLOBAL.READI$->FPT$READI.KEY_=GLOBAL.PRECI$->FPT$PRECI.KEY_;

   5517  1 000351   000000 471400 xsym               LDP1    GLOBAL$
         1 000352   105075 470500                    LDP0    2621,,PR1
         1 000353   105131 473500                    LDP3    2649,,PR1
         1 000354   300002 237100                    LDAQ    2,,PR3
         1 000355   000002 757100                    STAQ    2,,PR0

      266     5518    2       IF AWS.ATRIB.CAC THEN DO;

   5518  1 000356   200004 470500                    LDP0    AWS$,,AUTO
         1 000357   000000 236100                    LDQ     0,,PR0
         1 000360   000001 316003                    CANQ    1,DU
         1 000361   000475 600000 1                  TZE     s:5543

      267     5519    2           CALL M$READ(GLOBAL.READI$->FPT$READI) ALTRET(ER_UNEX);

   5519  1 000362   105075 473500                    LDP3    2621,,PR1
         1 000363   300000 630500                    EPPR0   0,,PR3
         1 000364   440000 713400                    CLIMB   alt,read
         1 000365   401400 401760                    pmme    nvectors=4
         1 000366   000674 702000 1                  TSX2    ER_UNEX

      268     5520    2           GLOBAL.ENQ.SHARE=%ALL#;

   5520  1 000367   000000 470400 xsym               LDP0    GLOBAL$
         1 000370   001000 236003                    LDQ     512,DU
         1 000371   001407 552140                    STBQ    775,'40'O,PR0

      269     5521    2           GLOBAL.ENQ.VALUE.DCB#=AWS.DDCB;

   5521  1 000372   200004 471500                    LDP1    AWS$,,AUTO
         1 000373   100006 220100                    LDX0    6,,PR1
         1 000374   001407 440100                    SXL0    775,,PR0
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:52   

      270     5522    2           KEYX#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->

   5522  1 000375   000007 473400 2                  LDP3    7
         1 000376   300000 474500                    LDP4    0,,PR3
         1 000377   100006 221100                    LDX1    6,,PR1
         1 000400   400000 470511                    LDP0    0,X1,PR4
         1 000401   000052 720100                    LXL0    42,,PR0
         1 000402   000000 470400 xsym               LDP0    B$ROS$
         1 000403   000003 236110                    LDQ     3,X0,PR0
         1 000404   777777 376007                    ANQ     -1,DL
         1 000405   200026 756100                    STQ     KEYX#,,AUTO

      271     5523    2              FITALTKEYS.K.KEYX(0);
      272     5524    2           KEYL#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->

   5524  1 000406   100006 220100                    LDX0    6,,PR1
         1 000407   400000 470510                    LDP0    0,X0,PR4
         1 000410   000052 721100                    LXL1    42,,PR0
         1 000411   000000 470400 xsym               LDP0    B$ROS$
         1 000412   000001 236111                    LDQ     1,X1,PR0
         1 000413   000033 772000                    QRL     27
         1 000414   200027 756100                    STQ     KEYL#,,AUTO

      273     5525    2              FITALTKEYS.K.KEYL(0);
      274     5526    2           CALL ZIM$IHASH(DBCB.CSECT.IXBUF$->STRING,KEYX#,KEYL#,HASH);

   5526  1 000415   200003 470500                    LDP0    DBCB$,,AUTO
         1 000416   000011 471500                    LDP1    9,,PR0
         1 000417   200030 630500                    EPPR0   HASH,,AUTO
         1 000420   200135 450500                    STP0    SAVE_KEY+68,,AUTO
         1 000421   200027 630500                    EPPR0   KEYL#,,AUTO
         1 000422   200134 450500                    STP0    SAVE_KEY+67,,AUTO
         1 000423   200026 630500                    EPPR0   KEYX#,,AUTO
         1 000424   200133 450500                    STP0    SAVE_KEY+66,,AUTO
         1 000425   200132 451500                    STP1    SAVE_KEY+65,,AUTO
         1 000426   200132 630500                    EPPR0   SAVE_KEY+65,,AUTO
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:53   
         1 000427   000010 631400 2                  EPPR1   8
         1 000430   000000 701000 xent               TSX1    ZIM$IHASH
         1 000431   000000 011000                    NOP     0

      275     5527    2           GLOBAL.ENQ.VALUE.RNAME=HASH;

   5527  1 000432   000000 470400 xsym               LDP0    GLOBAL$
         1 000433   200030 235100                    LDA     HASH,,AUTO
         1 000434   001410 755100                    STA     776,,PR0

      276     5528    2           CALL ZIM$ENQM(0)

   5528  1 000435   000011 630400 2                  EPPR0   9
         1 000436   000005 631400 2                  EPPR1   5
         1 000437   000000 701000 xent               TSX1    ZIM$ENQM
         1 000440   000442 702000 1                  TSX2    s:5531
         1 000441   000471 710000 1                  TRA     s:5541

      277     5529    3           WHENALTRETURN DO;

      278     5530        /*                     See if its a real deadlock/timout or not. */
      279     5531    3               ERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#;

   5531  1 000442   000000 470400 xsym               LDP0    B$TCB$
         1 000443   000000 471500                    LDP1    0,,PR0
         1 000444   100102 236100                    LDQ     66,,PR1
         1 000445   000003 772000                    QRL     3
         1 000446   037777 376007                    ANQ     16383,DL
         1 000447   200025 756100                    STQ     ERR#,,AUTO

      280     5532    3               CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);

   5532  1 000450   200004 630500                    EPPR0   AWS$,,AUTO
         1 000451   000005 631400 2                  EPPR1   5
         1 000452   000000 701000 xent               TSX1    ZIM$DEQ_INDEXED
         1 000453   000731 702000 1                  TSX2    ER_ENQM

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:54   
      281     5533    3               IF ERR#=%E$TIMELIMIT OR

   5533  1 000454   200025 235100                    LDA     ERR#,,AUTO
         1 000455   001442 115007                    CMPA    802,DL
         1 000456   000461 600000 1                  TZE     s:5535
         1 000457   001441 115007                    CMPA    801,DL
         1 000460   000470 601000 1                  TNZ     s:5539

      282     5534    4                  ERR#=%E$DLOCK THEN DO;

      283     5535    4                   CALL ZIM$ENQM ALTRET(ALT);

   5535  1 000461   000003 631400 2                  EPPR1   3
         1 000462   000000 701000 xent               TSX1    ZIM$ENQM
         1 000463   000731 702000 1                  TSX2    ER_ENQM

      284     5536    4                   CALL ZIM$DEQ_ONE ALTRET(ALT);

   5536  1 000464   000003 631400 2                  EPPR1   3
         1 000465   000000 701000 xent               TSX1    ZIM$DEQ_ONE
         1 000466   000731 702000 1                  TSX2    ER_ENQM

      285     5537    4                   GOTO RETRY;

   5537  1 000467   000131 710000 1                  TRA     RETRY

      286     5538    4                   END;
      287     5539    3               GOTO E_CAC;

   5539  1 000470   000671 710000 1                  TRA     E_CAC

      288     5540    3               END;
      289     5541    2           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);

   5541  1 000471   200004 630500                    EPPR0   AWS$,,AUTO
         1 000472   000005 631400 2                  EPPR1   5
         1 000473   000000 701000 xent               TSX1    ZIM$DEQ_INDEXED
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:55   
         1 000474   000731 702000 1                  TSX2    ER_ENQM

      290     5542    2           END;

      291     5543    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;

   5543  1 000475   000000 470400 xsym               LDP0    GLOBAL$
         1 000476   001425 235100                    LDA     789,,PR0
         1 000477   000001 035007                    ADLA    1,DL
         1 000500   001425 755100                    STA     789,,PR0

      292     5544    1       CALL M$READ(GLOBAL.READI$->FPT$READI)

   5544  1 000501   005075 471500                    LDP1    2621,,PR0
         1 000502   100000 630500                    EPPR0   0,,PR1
         1 000503   440000 713400                    CLIMB   alt,read
         1 000504   401400 401760                    pmme    nvectors=4
         1 000505   000507 702000 1                  TSX2    s:5546
         1 000506   000516 710000 1                  TRA     s:5550

      293     5545    2       WHENALTRETURN DO;

      294     5546    2           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN

   5546  1 000507   000000 470400 xsym               LDP0    B$TCB$
         1 000510   000000 471500                    LDP1    0,,PR0
         1 000511   100102 236100                    LDQ     66,,PR1
         1 000512   377770 376007                    ANQ     131064,DL
         1 000513   001020 116007                    CMPQ    528,DL
         1 000514   000131 600000 1                  TZE     RETRY

      295     5547    2               GOTO RETRY;
      296     5548    2           GOTO ER_UNEX;

   5548  1 000515   000674 710000 1                  TRA     ER_UNEX

      297     5549    2           END;
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:56   
      298     5550    1       IF AWS.ATRIB.CAC THEN

   5550  1 000516   200004 470500                    LDP0    AWS$,,AUTO
         1 000517   000000 236100                    LDQ     0,,PR0
         1 000520   000001 316003                    CANQ    1,DU
         1 000521   000525 600000 1                  TZE     s:5552

      299     5551    1           CALL ZIM$INDXMAP_ADD ALTRET(ALT);

   5551  1 000522   000003 631400 2                  EPPR1   3
         1 000523   000000 701000 xent               TSX1    ZIM$INDXMAP_ADD
         1 000524   000731 702000 1                  TSX2    ER_ENQM

      300     5552    1       RVI$->RECVAR.DBKEY=GLOBAL.KEYID.RECID;

   5552  1 000525   000000 470400 xsym               LDP0    GLOBAL$
         1 000526   005012 235100                    LDA     2570,,PR0
         1 000527   200022 471500                    LDP1    RVI$,,AUTO
         1 000530   100000 755100                    STA     0,,PR1

      301     5553    1       RVI$->RECVAR.RECSZ=DCBADDR(AWS.DDCB)->F$DCB.ARS#;

   5553  1 000531   000007 473400 2                  LDP3    7
         1 000532   300000 474500                    LDP4    0,,PR3
         1 000533   200004 470500                    LDP0    AWS$,,AUTO
         1 000534   000006 220100                    LDX0    6,,PR0
         1 000535   400000 470510                    LDP0    0,X0,PR4
         1 000536   000000 720100                    LXL0    0,,PR0
         1 000537   100003 740100                    STX0    3,,PR1

      302     5554    1       RVI$->RECVAR.RTP.TYPE=RC.RTYP;

   5554  1 000540   200014 470500                    LDP0    RC$,,AUTO
         1 000541   000003 236100                    LDQ     3,,PR0
         1 000542   100003 752103                    STCQ    3,'03'O,PR1

      303     5555    1       RVI$->RECVAR.BADDR$=ADDR(NIL);
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:57   

   5555  1 000543   000000 236000 2                  LDQ     0
         1 000544   100001 756100                    STQ     1,,PR1

      304     5556    1       RVI$->RECVAR.RADDR$=DBCB.CSECT.IXBUF$;

   5556  1 000545   200003 470500                    LDP0    DBCB$,,AUTO
         1 000546   000011 236100                    LDQ     9,,PR0
         1 000547   100002 756100                    STQ     2,,PR1

      305     5557    1       RVI$->RECVAR.AWS$=AWS$;

   5557  1 000550   200004 236100                    LDQ     AWS$,,AUTO
         1 000551   100013 756100                    STQ     11,,PR1

      306     5558    1       IF (RC.DEF.FVR = '0'B AND

   5558  1 000552   200014 470500                    LDP0    RC$,,AUTO
         1 000553   000000 236100                    LDQ     0,,PR0
         1 000554   040000 316007                    CANQ    16384,DL
         1 000555   000561 601000 1                  TNZ     s:5558+7
         1 000556   000003 220100                    LDX0    3,,PR0
         1 000557   100003 100100                    CMPX0   3,,PR1
         1 000560   000727 601000 1                  TNZ     ER_SIZE
         1 000561   040000 316007                    CANQ    16384,DL
         1 000562   000566 600000 1                  TZE     s:5563
         1 000563   000003 220100                    LDX0    3,,PR0
         1 000564   100003 100100                    CMPX0   3,,PR1
         1 000565   000727 602000 1                  TNC     ER_SIZE

      307     5559    1          RC.RSIZ ~= RVI$->RECVAR.RECSZ)
      308     5560    1          OR (RC.DEF.FVR = '1'B AND
      309     5561    1          RC.RSIZ < RVI$ -> RECVAR.RECSZ) THEN
      310     5562    1           GOTO ER_SIZE;
      311     5563    1       RVI$->RECVAR.RCPTR=POFFW(RC$,SSS$);

   5563  1 000566   200006 235100                    LDA     SSS$,,AUTO
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:58   
         1 000567   000022 771000                    ARL     18
         1 000570   200132 755100                    STA     SAVE_KEY+65,,AUTO
         1 000571   200014 236100                    LDQ     RC$,,AUTO
         1 000572   000022 772000                    QRL     18
         1 000573   200132 136100                    SBLQ    SAVE_KEY+65,,AUTO
         1 000574   000000 620006                    EAX0    0,QL
         1 000575   100006 740100                    STX0    6,,PR1

      312     5564    2       IF GLOBAL.PARAN.TRACE.MODE~='0'B THEN DO;

   5564  1 000576   000000 470400 xsym               LDP0    GLOBAL$
         1 000577   000061 235100                    LDA     49,,PR0
         1 000600   000631 600000 1                  TZE     s:5573

      313     5565    2           GLOBAL.PARAN.TRACE.RTYPE=RC.RTYP;

   5565  1 000601   200014 470500                    LDP0    RC$,,AUTO
         1 000602   000003 721100                    LXL1    3,,PR0
         1 000603   007777 361003                    ANX1    4095,DU
         1 000604   000000 470400 xsym               LDP0    GLOBAL$
         1 000605   000060 441100                    SXL1    48,,PR0

      314     5566    2           GLOBAL.PARAN.TRACE.RNAME=RC.RNAM;

   5566  1 000606   200014 470500                    LDP0    RC$,,AUTO
         1 000607   000000 720100                    LXL0    0,,PR0
         1 000610   000077 360003                    ANX0    63,DU
         1 000611   000000 471400 xsym               LDP1    GLOBAL$
         1 000612   040100 100540                    MLR     fill='040'O
         1 000613   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
         1 000614   100046 000036                    ADSC9   38,,PR1                  cn=0,n=30

      315     5567    2           IF AWS.ATRIB.CAC THEN

   5567  1 000615   200004 470500                    LDP0    AWS$,,AUTO
         1 000616   000000 236100                    LDQ     0,,PR0
         1 000617   000001 316003                    CANQ    1,DU
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:59   
         1 000620   000624 600000 1                  TZE     s:5570

      316     5568    2               GLOBAL.PARAN.TRACE.TYPE=TR#IREADENQ;

   5568  1 000621   000023 220003                    LDX0    19,DU
         1 000622   100060 740100                    STX0    48,,PR1
         1 000623   000626 710000 1                  TRA     s:5571

      317     5569    2           ELSE
      318     5570    2               GLOBAL.PARAN.TRACE.TYPE=TR#IREAD;

   5570  1 000624   000014 220003                    LDX0    12,DU
         1 000625   100060 740100                    STX0    48,,PR1

      319     5571    2           CALL ZIM$TRACE;

   5571  1 000626   000003 631400 2                  EPPR1   3
         1 000627   000000 701000 xent               TSX1    ZIM$TRACE
         1 000630   000000 011000                    NOP     0

      320     5572    2           END;

      321     5573    1       TEMP=DBCB.PCB.RVI;

   5573  1 000631   200003 470500                    LDP0    DBCB$,,AUTO
         1 000632   000510 220100                    LDX0    328,,PR0
         1 000633   200020 740100                    STX0    TEMP,,AUTO

      322     5574    1       DBCB.PCB.RVI=DBCB.PCB.RVO;

   5574  1 000634   000511 221100                    LDX1    329,,PR0
         1 000635   000510 741100                    STX1    328,,PR0

      323     5575    1       DBCB.PCB.RVO=TEMP;

   5575  1 000636   000511 740100                    STX0    329,,PR0

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:60   
      324     5576    1       CALL ZIM$ICURR;

   5576  1 000637   000003 631400 2                  EPPR1   3
         1 000640   000000 701000 xent               TSX1    ZIM$ICURR
         1 000641   000000 011000                    NOP     0

      325     5577    1       IF PCOMP AND FUNCT=1 THEN

   5577  1 000642   200017 234100                    SZN     PCOMP,,AUTO
         1 000643   000647 605000 1                  TPL     s:5579
         1 000644   200023 235100                    LDA     FUNCT,,AUTO
         1 000645   000001 115007                    CMPA    1,DL
         1 000646   000707 600000 1                  TZE     EX_PCOMP

      326     5578    1           GOTO EX_PCOMP;
      327     5579    1       RETURN;

   5579  1 000647   000000 702200 xent               TSX2  ! X66_ARET

      328     5580    2   ER_READ: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN DO;

   5580  1 000650   000000 470400 xsym  ER_READ      LDP0    B$TCB$
         1 000651   000000 471500                    LDP1    0,,PR0
         1 000652   100102 236100                    LDQ     66,,PR1
         1 000653   377770 376007                    ANQ     131064,DL
         1 000654   001020 116007                    CMPQ    528,DL
         1 000655   000661 601000 1                  TNZ     s:5585

      329     5581    2           PCOMP=%YES#;

   5581  1 000656   400000 236003                    LDQ     -131072,DU
         1 000657   200017 756100                    STQ     PCOMP,,AUTO

      330     5582    2           GOTO READOK;

   5582  1 000660   000315 710000 1                  TRA     READOK

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:61   
      331     5583    2           END;
      332     5584    1       ELSE
      333     5585    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$BOF OR

   5585  1 000661   000040 116007                    CMPQ    32,DL
         1 000662   000714 600000 1                  TZE     ER_EOSR
         1 000663   000060 116007                    CMPQ    48,DL
         1 000664   000714 600000 1                  TZE     ER_EOSR

      334     5586    1              B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$EOF THEN
      335     5587    1               GOTO ER_EOSR;
      336     5588    1           ELSE
      337     5589    1               GOTO ER_UNEX;

   5589  1 000665   000674 710000 1                  TRA     ER_UNEX

      338     5590    1   ER_UNAVIL: ERROR=EXC#UNA;

   5590  1 000666   004230 235007       ER_UNAVIL    LDA     2200,DL
         1 000667   200021 755100                    STA     ERROR,,AUTO

      339     5591    1       GOTO ALT;

   5591  1 000670   000731 710000 1                  TRA     ER_ENQM

      340     5592    1   E_CAC: ERROR=ERR#IO#CAC;

   5592  1 000671   303375 236007       E_CAC        LDQ     100093,DL
         1 000672   200021 756100                    STQ     ERROR,,AUTO

      341     5593    1       GOTO ALT;

   5593  1 000673   000731 710000 1                  TRA     ER_ENQM

      342     5594    1   ER_UNEX: ERROR=ERR#IX#UNEX;

   5594  1 000674   303423 235007       ER_UNEX      LDA     100115,DL
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:62   
         1 000675   200021 755100                    STA     ERROR,,AUTO

      343     5595    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5595  1 000676   000000 470400 xsym               LDP0    B$TCB$
         1 000677   000000 471500                    LDP1    0,,PR0
         1 000700   100102 236100                    LDQ     66,,PR1
         1 000701   000000 473400 xsym               LDP3    GLOBAL$
         1 000702   300007 756100                    STQ     7,,PR3

      344     5596    1       GLOBAL.RET.DCB#=AWS.DDCB;

   5596  1 000703   200004 471500                    LDP1    AWS$,,AUTO
         1 000704   100006 220100                    LDX0    6,,PR1
         1 000705   300014 740100                    STX0    12,,PR3

      345     5597    1       GOTO ALT;

   5597  1 000706   000731 710000 1                  TRA     ER_ENQM

      346     5598    1   EX_PCOMP: ERROR=EXC#PCOMP;

   5598  1 000707   004541 236007       EX_PCOMP     LDQ     2401,DL
         1 000710   200021 756100                    STQ     ERROR,,AUTO

      347     5599            %DBEXC;

   5600  1 000711   000000 470400 xsym               LDP0    GLOBAL$
         1 000712   000006 756100                    STQ     6,,PR0

   5601  1 000713   000000 702200 xent               TSX2  ! X66_ARET

      348     5603    1   ER_EOSR: IF AWS.ATRIB.CAC THEN

   5603  1 000714   200004 470500       ER_EOSR      LDP0    AWS$,,AUTO
         1 000715   000000 236100                    LDQ     0,,PR0
         1 000716   000001 316003                    CANQ    1,DU
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:63   
         1 000717   000724 600000 1                  TZE     s:5605

      349     5604    1           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);

   5604  1 000720   200004 630500                    EPPR0   AWS$,,AUTO
         1 000721   000005 631400 2                  EPPR1   5
         1 000722   000000 701000 xent               TSX1    ZIM$DEQ_INDEXED
         1 000723   000731 702000 1                  TSX2    ER_ENQM

      350     5605    1       ERROR=EXC#EOSR;

   5605  1 000724   004064 235007                    LDA     2100,DL
         1 000725   200021 755100                    STA     ERROR,,AUTO

      351     5606    1       GOTO ALT;

   5606  1 000726   000731 710000 1                  TRA     ER_ENQM

      352     5607    1   ER_SIZE: ERROR=ERR#CM#RSZER;

   5607  1 000727   210574 235007       ER_SIZE      LDA     70012,DL
         1 000730   200021 755100                    STA     ERROR,,AUTO

   5605  1 000731                       ER_ENQM      null
   5605  1 000731                       ALT          null
      353     5608    1   ER_ENQM: ;
      354     5609    1   ALT: ;
      355     5610            %DBALT;

   5611  1 000731   000000 470400 xsym               LDP0    GLOBAL$
         1 000732   000006 235100                    LDA     6,,PR0
         1 000733   000742 601000 1                  TNZ     s:5619

   5613  1 000734   000010 450100                    STZ     8,,PR0

   5614  1 000735   000012 450100                    STZ     10,,PR0

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:64   
   5615  1 000736   000013 450100                    STZ     11,,PR0

   5616  1 000737   000011 450100                    STZ     9,,PR0

   5617  1 000740   200021 236100                    LDQ     ERROR,,AUTO
         1 000741   000006 756100                    STQ     6,,PR0

   5619  1 000742   000006 235100                    LDA     6,,PR0
         1 000743   303240 115007                    CMPA    100000,DL
         1 000744   000746 603000 1                  TRC     s:5622

   5620  1 000745   000000 702200 xent               TSX2  ! X66_AALT

   5622  1 000746   000003 631400 2                  EPPR1   3
         1 000747   000000 701000 xent               TSX1    ZIB$ERR
         1 000750   000000 011000                    NOP     0

      356     5624    1   END ZIM$IFIND;

   5624  1 000751   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 006014   000003 000000   777777 737777   000000 000000    ................
   2     004   777777 600000   000001 000000   000003 777774   000000 006003    ................
   2     010   000004 000000   000003 006000                                    ........
      357     5625        %EOD;

PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:65   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$IFIND.

   Procedure ZIM$IFIND requires 490 words for executable code.
   Procedure ZIM$IFIND requires 94 words of local(AUTO) storage.
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:66   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:67   
          MINI XREF LISTING

AC.ACRAN
      2692**DCL      5454>>ASSIGN
AC.DEF.ANL
      2690**DCL      2761--IMP-SIZ
AC.DEF.FORG
      2677**DCL      2681--REDEF
AC.WSOF
      2694**DCL      5459>>ASSIGN
AC$
      2673**DCL      2674--IMP-PTR
ALT
      5605**LABEL    5463--CALLALT  5509--CALLALT  5532--CALLALT  5535--CALLALT  5536--CALLALT  5541--CALLALT
      5551--CALLALT  5591--GOTO     5593--GOTO     5597--GOTO     5604--CALLALT  5606--GOTO
AWS
      1957**DCL      5509<>CALL     5532<>CALL     5541<>CALL     5604<>CALL
AWS.ATRIB.CAC
      1974**DCL      5508>>IF       5518>>IF       5550>>IF       5567>>IF       5603>>IF
AWS.DDCB
      1982**DCL      5460>>IF       5479>>ASSIGN   5513>>ASSIGN   5521>>ASSIGN   5522--ASSIGN   5524--ASSIGN
      5553--ASSIGN   5596>>ASSIGN
AWS$
      1956**DCL      1957--IMP-PTR  5459<<ASSIGN   5460>>IF       5479>>ASSIGN   5508>>IF       5509>>CALL
      5513>>ASSIGN   5518>>IF       5521>>ASSIGN   5522>>ASSIGN   5524>>ASSIGN   5532>>CALL     5541>>CALL
      5550>>IF       5553>>ASSIGN   5557>>ASSIGN   5567>>IF       5596>>ASSIGN   5603>>IF       5604>>CALL
B$ALT.CODE
      3509**DCL      3509--REDEF    3510--REDEF    3510--REDEF
B$ALT.ERR
      3510**DCL      5595>>ASSIGN
B$ALT.ERR.ERR#
      3511**DCL      3511--REDEF    5531>>ASSIGN   5546>>IF       5580>>IF       5585>>IF       5585>>IF
B$ALT.EVID
      3510**DCL      3510--REDEF    3510--REDEF
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:68   
B$ROS$
      5422**DCL      5522>>ASSIGN   5524>>ASSIGN
B$TCB.ALT$
      3505**DCL      5531>>ASSIGN   5546>>IF       5580>>IF       5585>>IF       5585>>IF       5595>>ASSIGN
B$TCB$
      5409**DCL      5531>>ASSIGN   5546>>IF       5580>>IF       5585>>IF       5585>>IF       5595>>ASSIGN
DBCB.CSECT.IXBUF$
      1495**DCL      5515>>ASSIGN   5526>>CALL     5556>>ASSIGN
DBCB.IOWS.CFCT
      1907**DCL      1908--REDEF
DBCB.IOWS.DBKF.RQ
      1850**DCL      1851--REDEF
DBCB.IOWS.DBKR
      1847**DCL      1848--REDEF
DBCB.IOWS.NOBF
      1909**DCL      1910--REDEF
DBCB.IOWS.SPND
      1835**DCL      1836--REDEF
DBCB.PCB.PRRC
      1694**DCL      5456>>IF       5456>>IF
DBCB.PCB.PRSC
      1696**DCL      5461>>ASSIGN
DBCB.PCB.RVI
      1683**DCL      5452>>ASSIGN   5573>>ASSIGN   5574<<ASSIGN
DBCB.PCB.RVO
      1685**DCL      5574>>ASSIGN   5575<<ASSIGN
DBCB.SWS.RDYCW
      1573**DCL      1574--REDEF
DBCB.SWS.ROCUR
      1533**DCL      5486>>ASSIGN   5490>>ASSIGN
DBCB.SWS.TEMP.PTR1$
      1607**DCL      1608--REDEF    1609--REDEF
DBCB.SWS.TEMP.PTR2$
      1610**DCL      1611--REDEF
DBCB$
      1478**DCL      1479--IMP-PTR  5449<<ASSIGN   5452>>ASSIGN   5452>>ASSIGN   5456>>IF       5456>>IF
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:69   
      5459>>ASSIGN   5461>>ASSIGN   5486>>ASSIGN   5490>>ASSIGN   5494>>IF       5515>>ASSIGN   5526>>CALL
      5556>>ASSIGN   5573>>ASSIGN   5574>>ASSIGN   5574>>ASSIGN   5575>>ASSIGN
ERR#
      5431**DCL      5531<<ASSIGN   5533>>IF       5533>>IF
ERROR
      5425**DCL      5590<<ASSIGN   5592<<ASSIGN   5594<<ASSIGN   5598<<ASSIGN   5600>>ASSIGN   5605<<ASSIGN
      5607<<ASSIGN   5617>>ASSIGN
ER_EOSR
      5603**LABEL    5458--GOTO     5512--GOTO     5587--GOTO
ER_READ
      5580**LABEL    5510--CALLALT
ER_SIZE
      5607**LABEL    5562--GOTO
ER_UNAVIL
      5590**LABEL    5460--GOTO
ER_UNEX
      5594**LABEL    5519--CALLALT  5548--GOTO     5589--GOTO
EX_PCOMP
      5598**LABEL    5578--GOTO
E_CAC
      5592**LABEL    5539--GOTO
F$DCB.ACTPOS
      3480**DCL      3480--REDEF
F$DCB.ALTKEYX
      3479**DCL      5522>>ASSIGN   5524>>ASSIGN
F$DCB.ARS#
      3454**DCL      3454--REDEF    5553>>ASSIGN
F$DCB.ATTR
      3473**DCL      3474--REDEF
F$DCB.BORROW
      3488**DCL      3488--REDEF    3488--REDEF    3488--REDEF
F$DCB.DCBNAME.L
      3502**DCL      3502--IMP-SIZ
F$DCB.EOMCHAR#
      3458**DCL      3458--REDEF
F$DCB.FLDID
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:70   
      3483**DCL      3483--REDEF
F$DCB.FORM$
      3477**DCL      3477--REDEF
F$DCB.FSECT
      3493**DCL      3493--REDEF
F$DCB.FSN#
      3470**DCL      3470--REDEF    3470--REDEF    3471--REDEF
F$DCB.HEADER$
      3476**DCL      3476--REDEF
F$DCB.IXTNSIZE#
      3474**DCL      3474--REDEF
F$DCB.LASTSTA$
      3463**DCL      3463--REDEF
F$DCB.LVL
      3489**DCL      3489--REDEF
F$DCB.NAME#.C
      3464**DCL      3464--REDEF
F$DCB.NOEOF
      3486**DCL      3486--REDEF
F$DCB.NRECS#
      3475**DCL      3475--REDEF
F$DCB.NRECX
      3494**DCL      3494--REDEF
F$DCB.OHDR
      3486**DCL      3486--REDEF
F$DCB.ORG#
      3469**DCL      3469--REDEF
F$DCB.PRECNO
      3492**DCL      3492--REDEF
F$DCB.RCSZ
      3498**DCL      3498--REDEF
F$DCB.RES#
      3465**DCL      3465--REDEF
F$DCB.SETX
      3477**DCL      3477--REDEF
F$DCB.TAB$
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:71   
      3477**DCL      3477--REDEF
F$DCB.TDA
      3491**DCL      3492--REDEF
F$DCB.WSN#
      3465**DCL      3465--REDEF
FITALTKEYS.K.KEYL
      3738**DCL      5524>>ASSIGN
FITALTKEYS.K.KEYX
      3738**DCL      5522>>ASSIGN
FPT$PRECI
      3387**DCL      5510<>CALL
FPT$PRECI.KEY_
      3387**DCL      5506--ASSIGN   5517>>ASSIGN
FPT$PRECI.V.DCB#
      3389**DCL      5479<<ASSIGN
FPT$PRECI.V.IDS#
      3390**DCL      5484<<ASSIGN   5487<<ASSIGN   5491<<ASSIGN   5498<<ASSIGN   5503<<ASSIGN
FPT$PRECI.V.INDX#
      3392**DCL      5480<<ASSIGN
FPT$PRECI.V.N#
      3393**DCL      5483<<ASSIGN   5486<<ASSIGN   5490<<ASSIGN   5495<<ASSIGN   5497<<ASSIGN   5502<<ASSIGN
FPT$READI
      3354**DCL      5519<>CALL     5544<>CALL
FPT$READI.BUF_.BOUND
      3356**DCL      5516<<ASSIGN
FPT$READI.BUF_.BUF$
      3357**DCL      5515<<ASSIGN
FPT$READI.KEY_
      3354**DCL      5517<<ASSIGN
FPT$READI.STATION_
      3357**DCL      3358--REDEF
FPT$READI.V.DCB#
      3358**DCL      5513<<ASSIGN
FPT$READI.V.DVBYTE.REREAD#
      3369**DCL      3369--REDEF
FPT$READI.V.INDX#
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:72   
      3367**DCL      3367--REDEF    5514<<ASSIGN
FUNCT
      5427**DCL      5436<<ASSIGN   5439<<ASSIGN   5442<<ASSIGN   5445<<ASSIGN   5448<<ASSIGN   5465>>DOCASE
      5472>>DOCASE   5481>>DOCASE   5577>>IF
GLOBAL.ACTIVE.DBCB$
       510**DCL       511--REDEF    5449>>ASSIGN
GLOBAL.ACTIVE.SSS$
       506**DCL       507--REDEF    5450>>ASSIGN
GLOBAL.ENQ.SHARE
       630**DCL      5520<<ASSIGN
GLOBAL.ENQ.VALUE.DCB#
       637**DCL      5521<<ASSIGN
GLOBAL.ENQ.VALUE.RNAME
       639**DCL      5527<<ASSIGN
GLOBAL.KEY
       714**DCL       717--REDEF    5467>>ASSIGN   5474<<ASSIGN   5488<<ASSIGN   5492<<ASSIGN
GLOBAL.KEY.VALUE
       716**DCL      5511--IF
GLOBAL.KEYID.RECID
       744**DCL      5499<<ASSIGN   5504<<ASSIGN   5552>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       589**DCL       596--REDEF    5564>>IF
GLOBAL.PARAN.TRACE.RNAME
       583**DCL      5566<<ASSIGN
GLOBAL.PARAN.TRACE.RTYPE
       588**DCL      5565<<ASSIGN
GLOBAL.PARAN.TRACE.TYPE
       587**DCL      5568<<ASSIGN   5570<<ASSIGN
GLOBAL.PRECI$
       796**DCL      5479>>ASSIGN   5480>>ASSIGN   5483>>ASSIGN   5484>>ASSIGN   5486>>ASSIGN   5487>>ASSIGN
      5490>>ASSIGN   5491>>ASSIGN   5495>>ASSIGN   5497>>ASSIGN   5498>>ASSIGN   5502>>ASSIGN   5503>>ASSIGN
      5506>>ASSIGN   5510>>CALL     5517>>ASSIGN
GLOBAL.PRINTBUF.BUFFER
       748**DCL       749--REDEF     750--REDEF     751--REDEF
GLOBAL.PRINTBUF.ERR.V
       753**DCL       756--REDEF     757--REDEF     758--REDEF
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:73   
GLOBAL.READI$
       768**DCL      5513>>ASSIGN   5514>>ASSIGN   5515>>ASSIGN   5516>>ASSIGN   5517>>ASSIGN   5519>>CALL
      5544>>CALL
GLOBAL.RET.AC#
       526**DCL      5613<<ASSIGN
GLOBAL.RET.DCB#
       530**DCL      5596<<ASSIGN
GLOBAL.RET.ERROR#
       524**DCL      5600<<ASSIGN   5611>>IF       5617<<ASSIGN   5619>>IF
GLOBAL.RET.FR#
       527**DCL      5616<<ASSIGN
GLOBAL.RET.RC#
       529**DCL      5615<<ASSIGN
GLOBAL.RET.SC#
       528**DCL      5614<<ASSIGN
GLOBAL.RET.SYSERR#
       525**DCL      5595<<ASSIGN
GLOBAL.STATS.CURR.READS
       664**DCL      5543<<ASSIGN   5543>>ASSIGN
GLOBAL$
       808**DCL       504--IMP-PTR  5449>>ASSIGN   5450>>ASSIGN   5467>>ASSIGN   5474>>ASSIGN   5479>>ASSIGN
      5480>>ASSIGN   5483>>ASSIGN   5484>>ASSIGN   5486>>ASSIGN   5487>>ASSIGN   5488>>ASSIGN   5490>>ASSIGN
      5491>>ASSIGN   5492>>ASSIGN   5495>>ASSIGN   5497>>ASSIGN   5498>>ASSIGN   5499>>ASSIGN   5502>>ASSIGN
      5503>>ASSIGN   5504>>ASSIGN   5506>>ASSIGN   5510>>CALL     5511>>IF       5513>>ASSIGN   5514>>ASSIGN
      5515>>ASSIGN   5516>>ASSIGN   5517>>ASSIGN   5517>>ASSIGN   5519>>CALL     5520>>ASSIGN   5521>>ASSIGN
      5527>>ASSIGN   5543>>ASSIGN   5543>>ASSIGN   5544>>CALL     5552>>ASSIGN   5564>>IF       5565>>ASSIGN
      5566>>ASSIGN   5568>>ASSIGN   5570>>ASSIGN   5595>>ASSIGN   5596>>ASSIGN   5600>>ASSIGN   5611>>IF
      5613>>ASSIGN   5614>>ASSIGN   5615>>ASSIGN   5616>>ASSIGN   5617>>ASSIGN   5619>>IF
HASH
      5434**DCL      5526<>CALL     5527>>ASSIGN
KEYL#
      5433**DCL      5524<<ASSIGN   5526<>CALL
KEYX#
      5432**DCL      5522<<ASSIGN   5526<>CALL
LENGTH
      5428**DCL      5430--IMP-SIZ  5478<<ASSIGN   5492>>ASSIGN   5511>>IF       5526>>CALL
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:74   
M$PRECORD
      3269**DCL-ENT  5510--CALL
M$READ
      3266**DCL-ENT  5519--CALL     5544--CALL
OA.LRSZ
      2646**DCL      5516>>ASSIGN
OA.SCNAM.EIS.COUNT
      2622**DCL      2657--IMP-SIZ
OA$
      2600**DCL      2601--IMP-PTR  5451<<ASSIGN   5516>>ASSIGN
OA1
      2665**DCL      5451--ASSIGN
OA1$
      2664**DCL      2665--IMP-PTR
PCOMP
      5423**DCL      5477<<ASSIGN   5577>>IF       5581<<ASSIGN
RA.PGRNG.IHIGHDBK
      2849**DCL      2850--REDEF
RA.RCRAH
      2845**DCL      5454>>ASSIGN
RA$
      2836**DCL      2837--IMP-PTR
RC.DEF.FVR
      2814**DCL      5558>>IF       5558>>IF
RC.DEF.RNL
      2821**DCL      2831--IMP-SIZ  5566>>ASSIGN
RC.RNAM
      2831**DCL      5566>>ASSIGN
RC.RSIZ
      2826**DCL      5558>>IF       5558>>IF
RC.RTYP
      2828**DCL      5554>>ASSIGN   5565>>ASSIGN
RC$
      2805**DCL      2806--IMP-PTR  5454<<ASSIGN   5456>>IF       5463<>CALL     5554>>ASSIGN   5558>>IF
      5558>>IF       5558>>IF       5558>>IF       5563>>ASSIGN   5565>>ASSIGN   5566>>ASSIGN   5566>>ASSIGN
READOK
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:75   
      5511**LABEL    5582--GOTO
RECVAR.ACPTR
      2035**DCL      5454>>ASSIGN   5459>>ASSIGN
RECVAR.AWS$
      2041**DCL      5557<<ASSIGN
RECVAR.BADDR
      2017**DCL      2020--REDEF
RECVAR.BADDR$
      2020**DCL      5555<<ASSIGN
RECVAR.DBKEY
      2016**DCL      5499>>ASSIGN   5504>>ASSIGN   5552<<ASSIGN
RECVAR.RADDR
      2021**DCL      2025--REDEF
RECVAR.RADDR$
      2025**DCL      5556<<ASSIGN
RECVAR.RCPTR
      2037**DCL      5563<<ASSIGN
RECVAR.RECSZ
      2026**DCL      5553<<ASSIGN   5558>>IF       5558>>IF
RECVAR.RTP.TYPE
      2032**DCL      5554<<ASSIGN
RETRY
      5465**LABEL    5537--GOTO     5547--GOTO
RS.DEF.IXNUM
      2875**DCL      5480>>ASSIGN   5514>>ASSIGN
RS.NPOS
      2882**DCL      2891--REDEF
RS$
      2856**DCL      2857--IMP-PTR  5463<>CALL     5480>>ASSIGN   5514>>ASSIGN
RVI$
      5426**DCL      5452<<ASSIGN   5454>>ASSIGN   5459>>ASSIGN   5499>>ASSIGN   5504>>ASSIGN   5552>>ASSIGN
      5553>>ASSIGN   5554>>ASSIGN   5555>>ASSIGN   5556>>ASSIGN   5557>>ASSIGN   5558>>IF       5558>>IF
      5563>>ASSIGN
SAVE_KEY
      5435**DCL      5467<<ASSIGN   5474>>ASSIGN
SC.DEF.SNL
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:76   
      2781**DCL      2786--IMP-SIZ
SC.SCWSO
      2782**DCL      5494>>IF
SC$
      2768**DCL      2769--IMP-PTR  5461<<ASSIGN   5462>>ASSIGN   5463<>CALL     5494>>IF
SC1
      2795**DCL      5462--ASSIGN
SC1.KLNG
      2797**DCL      5478>>ASSIGN   5506>>ASSIGN
SC1$
      2794**DCL      2795--IMP-PTR  5462<<ASSIGN   5478>>ASSIGN   5506>>ASSIGN
SETWS.KEY.LENGTH
      2010**DCL      2011--IMP-SIZ
SETWS.PRIV.CSE
      1999**DCL      5494>>IF
SETWS$
      1996**DCL      1997--IMP-PTR
SKIP
      5472**LABEL    5469--GOTO
SSS$
      2055**DCL      5450<<ASSIGN   5451>>ASSIGN   5454>>ASSIGN   5454>>ASSIGN   5454>>ASSIGN   5456>>IF
      5459>>ASSIGN   5461>>ASSIGN   5563>>ASSIGN
STRING
      5429**DCL      5492>>ASSIGN   5511>>IF       5526<>CALL
TEMP
      5424**DCL      5573<<ASSIGN   5575>>ASSIGN
VLP$VECTOR.W1.VSIZE#
      3443**DCL      5506<<ASSIGN
VLP$VECTOR.W2
      3444**DCL      3445--REDEF
XNI
      5449**LABEL    5437--GOTO     5440--GOTO     5443--GOTO     5446--GOTO
ZIB$ERR
       809**DCL-ENT  5622--CALL
ZIM$DEQ_INDEXED
      5421**DCL-ENT  5532--CALL     5541--CALL     5604--CALL
PL6.E3A0      #002=ZIM$IFIND File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:77   
ZIM$DEQ_ONE
      5417**DCL-ENT  5536--CALL
ZIM$ENQM
      5416**DCL-ENT  5528--CALL     5535--CALL
ZIM$ENQ_INDEXED
      5420**DCL-ENT  5509--CALL
ZIM$GETRS
      5412**DCL-ENT  5463--CALL
ZIM$ICURR
      5413**DCL-ENT  5576--CALL
ZIM$IHASH
      5419**DCL-ENT  5526--CALL
ZIM$INDXMAP_ADD
      5418**DCL-ENT  5551--CALL
ZIM$TRACE
      5415**DCL-ENT  5571--CALL
ZI_MAXKEY
      5411**DCL      5492--ASSIGN

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:78   
      358        1        /*M*     ZIM$ISTO - store index record            */
      359        2        /*T***********************************************************/
      360        3        /*T*                                                         */
      361        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      362        5        /*T*                                                         */
      363        6        /*T***********************************************************/
      364        7        ZIM$ISTO: PROC ALTRET
      365        8               AVOID($PR5,$PR6,$PR7);
      366        9        %INCLUDE ZI$GLOBAL;
      367      495            %GLOBALS;
      368      803            %TRCE_SUBS;
      369      827        %INCLUDE ZI$DBCB;
      370     1469            %DBCB;
      371     1947            %RECVAR;
      372     1981            %AWS;
      373     2021        %INCLUDE ZI$SSS;
      374     2570            %AC;
      375     2665            %RC;
      376     2697            %RA;
      377     2717        %INCLUDE ZI_ERRORS_C;
      378     3043        %INCLUDE CP_6;
      379     3124            %FPT_WRITE(FPTN=FPT$WRTI,STCLASS=BASED);
      380     3155            %FPT_OPEN(FPTN=FPT$REOPEN,STCLASS=BASED);
      381     3264            %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      382     3306            %FPT_ENQ(FPTN=FPT$ENQI,STCLASS=BASED);
      383     3324            %FPT_DEQ(FPTN=FPT$DEQI,STCLASS=BASED);
      384     3341            %F$DCB;
      385     3398            %B$TCB(STCLASS=BASED);
      386     3401            %B$ALT(STCLASS=BASED);
      387     3409        %INCLUDE FM$FIT;
      388     3630            %FITALTKEYS;
      389     3636        %INCLUDE B_ERRORS_C;
      390     4763        %INCLUDE CP_6_SUBS;
      391     5303    1   DCL ERROR UBIN(36);
      392     5304    1   DCL FUNCT UBIN WORD;
      393     5305    1   DCL RVT$ PTR;
      394     5306    1   DCL LENGTH UBIN WORD;
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:79   
      395     5307    1   DCL IXBUF CHAR(LENGTH) BASED CALIGNED;
      396     5308    1   DCL PS0$ PTR SYMREF;
      397     5309    1   DCL B$ROS$ PTR SYMREF;
      398     5310    1   DCL B$TCB$ PTR SYMREF;
      399     5311    1   DCL TEMP UBIN HALF;
      400     5312    1   DCL ZIM$ICURR ENTRY;
      401     5313    1   DCL ZIM$JISTO ENTRY;
      402     5314    1   DCL ZIM$JIMOD ENTRY;
      403     5315    1   DCL ZIM$PROL ENTRY ALTRET;
      404     5316    1   DCL ZIM$TRACE ENTRY;
      405     5317    1   DCL ZIM$ENQM ENTRY(1) ALTRET;
      406     5318    1   DCL ZIM$DEQ_ONE ENTRY ALTRET;
      407     5319    1   DCL ZIM$INDXMAP_ADD ENTRY ALTRET;
      408     5320    1   DCL ZIM$IHASH ENTRY(4);
      409     5321    1   DCL ZIM$ENQ_INDEXED ENTRY(1) ALTRET;
      410     5322    1   DCL ZIM$DEQ_INDEXED ENTRY(1) ALTRET;
      411     5323
      412     5324    1   DCL HASH UBIN;
      413     5325    1   DCL KEYX# UBIN;
      414     5326    1   DCL KEYL# UBIN;
      415     5327    1       FUNCT=1;
      416     5328    1       GOTO COM;
      417     5329    1   ZIM$IMOD: ENTRY ALTRET;
      418     5330    1       FUNCT=2;
      419     5331    1   COM: ERROR=0;
      420     5332    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
      421     5333    1       SSS$=GLOBAL.ACTIVE.SSS$;
      422     5334    1       RVT$=PINCRW(DBCB$,DBCB.PCB.RVT);
      423     5335    1       AC$=PINCRW(SSS$,RVT$->RECVAR.ACPTR);
      424     5336    1       AWS$=PINCRW(DBCB$,AC.WSOF);
      425     5337    1       IF AWS.DDCB = 0 THEN GOTO ER_UNAVIL;
      426     5338    1       IF AWS.ATRIB.FUN=%IN# THEN
      427     5339    1           GOTO ER_IUM;
      428     5340    1       RC$=PINCRW(SSS$,RVT$->RECVAR.RCPTR);
      429     5341    1       RVT$->RECVAR.BADDR$=ADDR(NIL);
      430     5342    1       RVT$->RECVAR.RADDR$=DBCB.CSECT.TBUF$;
      431     5343    1       RVT$->RECVAR.AWS$=AWS$;
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:80   
      432     5344    1       RVT$->RECVAR.RTP.TYPE=RC.RTYP;
      433     5345    1       RVT$->RECVAR.RCPTR=POFFW(RC$,SSS$);
      434     5346    1       RVT$->RECVAR.ACPTR=POFFW(AC$,SSS$);
      435     5347    1       IF RC.DEF.FVR THEN
      436     5348    1           RVT$->RECVAR.RECSZ=DBCB.IOWS.VRSIZ;
      437     5349    1       ELSE
      438     5350    1           RVT$->RECVAR.RECSZ=RC.RSIZ;
      439     5351    2       DO CASE(FUNCT);
      440     5352    2       CASE(1);
      441     5353    2           CALL ZIM$JISTO;
      442     5354    2           GLOBAL.WRTI$->FPT$WRTI.V.ONEWKEY#=%NO#;
      443     5355    2       CASE(2);
      444     5356    2           CALL ZIM$JIMOD;
      445     5357    2           GLOBAL.WRTI$->FPT$WRTI.V.ONEWKEY#=%YES#;
      446     5358    2           END; /* CASE */
      447     5359    1       GLOBAL.WRTI$->FPT$WRTI.V.DCB#=AWS.DDCB;
      448     5360    1       GLOBAL.WRTI$->FPT$WRTI.BUF_.BUF$=RVT$->RECVAR.RADDR$;
      449     5361    1       GLOBAL.WRTI$->FPT$WRTI.BUF_.BOUND=RVT$->RECVAR.RECSZ-1;
      450     5362    1       LENGTH=RVT$->RECVAR.RECSZ;
      451     5363    1       DBCB.CSECT.IXBUF$->IXBUF=DBCB.CSECT.TBUF$->IXBUF;
      452     5364    2       IF AWS.ATRIB.CAC THEN DO;
      453     5365    2           GLOBAL.ENQ.SHARE=%NONE#;
      454     5366    2           GLOBAL.ENQ.VALUE.DCB#=AWS.DDCB;
      455     5367    2           KEYX#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->
      456     5368    2              FITALTKEYS.K.KEYX(0);
      457     5369    2           KEYL#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->
      458     5370    2              FITALTKEYS.K.KEYL(0);
      459     5371    2           CALL ZIM$IHASH(DBCB.CSECT.IXBUF$->IXBUF,KEYX#,KEYL#,HASH);
      460     5372    2           GLOBAL.ENQ.VALUE.RNAME=HASH;
      461     5373    2           CALL ZIM$ENQM ALTRET(ALT);
      462     5374    2           END;
      463     5375    1       IF AWS.ATRIB.CAC THEN
      464     5376    1           CALL ZIM$ENQ_INDEXED(AWS) ALTRET(ALT);
      465     5377    1       CALL M$WRITE(GLOBAL.WRTI$->FPT$WRTI) ALTRET(ER_WRT);
      466     5378    2       IF AWS.ATRIB.CAC THEN DO;
      467     5379    2           CALL ZIM$INDXMAP_ADD ALTRET(ALT);
      468     5380    2           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:81   
      469     5381    2           END;
      470     5382    1       ELSE
      471     5383    2           IF DCBADDR(AWS.DDCB)->F$DCB.RDL0#>3 THEN DO;
      472     5384    2               GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.DDCB;
      473     5385    2               GLOBAL.CLOSE$->FPT$CLOSE.V.OPER.REBLD#='1'B; /* REB KEY */
      474     5386    2               CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE) ALTRET(ER_CLSI);
      475     5387    2               GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#=AWS.DDCB;
      476     5388    2               CALL M$OPEN(GLOBAL.REOPEN$->FPT$REOPEN) ALTRET(ER_OPNI);
      477     5389    2               END;
      478     5390    1       RVT$->RECVAR.DBKEY=GLOBAL.KEYID.RECID;
      479     5391    1       RVT$->RECVAR.RADDR$=DBCB.CSECT.IXBUF$;
      480     5392    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;
      481     5393    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;
      482     5394    2       IF GLOBAL.PARAN.TRACE.MODE~='0'B THEN DO;
      483     5395    2           GLOBAL.PARAN.TRACE.RTYPE=RC.RTYP;
      484     5396    2           GLOBAL.PARAN.TRACE.RNAME=RC.RNAM;
      485     5397    2           IF AWS.ATRIB.CAC THEN
      486     5398    2               IF FUNCT=1 THEN
      487     5399    2                   GLOBAL.PARAN.TRACE.TYPE=TR#ISTOENQ;
      488     5400    2               ELSE
      489     5401    2                   GLOBAL.PARAN.TRACE.TYPE=TR#IMODENQ;
      490     5402    2           ELSE
      491     5403    2               IF FUNCT=1 THEN
      492     5404    2                   GLOBAL.PARAN.TRACE.TYPE=TR#ISTO;
      493     5405    2               ELSE
      494     5406    2                   GLOBAL.PARAN.TRACE.TYPE=TR#IMOD;
      495     5407    2           CALL ZIM$TRACE;
      496     5408    2           END;
      497     5409    1       TEMP=DBCB.PCB.RVT;
      498     5410    1       DBCB.PCB.RVT=DBCB.PCB.RVO;
      499     5411    1       DBCB.PCB.RVO=TEMP;
      500     5412    1       CALL ZIM$ICURR;
      501     5413    1       TEMP=DBCB.PCB.RVT;
      502     5414    1       DBCB.PCB.RVT=DBCB.PCB.RVO;
      503     5415    1       DBCB.PCB.RVO=TEMP;
      504     5416    1       RETURN;
      505     5417    1   ER_WRT: ;
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:82   
      506     5418    2       IF AWS.ATRIB.CAC THEN DO;
      507     5419                %DBCAL(NAME=ZIM$DEQ_ONE,EXC=ER_WRT0,ALT=ALT);
      508     5435    2   ER_WRT0: ;
      509     5436    2           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);
      510     5437    2           END;
      511     5438    1       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$OLDREC OR
      512     5439    1          B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$DUPKEY THEN
      513     5440    1           GOTO EX_DDI;
      514     5441    1       ELSE
      515     5442    1           ERROR=ERR#IX#UNEX;
      516     5443    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      517     5444    1       GLOBAL.RET.DCB#=GLOBAL.WRTI$->FPT$WRTI.V.DCB#;
      518     5445    1       GOTO ALT;
      519     5446    1   ER_UNAVIL: ERROR=EXC#UNA;
      520     5447    1       GOTO ALT;
      521     5448    1   ER_IUM:ERROR=EXC#IUM;
      522     5449    1       GOTO ALT;
      523     5450    1   ER_CLSI: ERROR=ERR#IO#CLSI;
      524     5451    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      525     5452    1       GLOBAL.RET.DCB#=GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#;
      526     5453    1       GOTO ALT;
      527     5454    1   ER_OPNI: ERROR=ERR#IO#OPNI;
      528     5455    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      529     5456    1       GLOBAL.RET.DCB#=GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#;
      530     5457    1       GOTO ALT;
      531     5458    1   EX_DDI: ERROR=EXC#DDI;
      532     5459    1       GOTO ALT;
      533     5460    1   ER_JRNL: ;
      534     5461    1   ER_ENQM: ;
      535     5462    1   ALT: ;
      536     5463            %DBALT;
      537     5477    1       RETURN;
      538     5478    1   END ZIM$ISTO;
      539     5479        %EOD;

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:83   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$ISTO.

   Procedure ZIM$ISTO requires 377 words for executable code.
   Procedure ZIM$ISTO requires 22 words of local(AUTO) storage.

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:84   

 Object Unit name= ZIM$ISTO                                   File name= ZIM$INDEXED.:ZIC0TOU
 UTS= SEP 05 '97 12:57:25.56 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   377    571  ZIM$ISTO
    2  RoData even  none     7      7  ZIM$ISTO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       0  ZIM$ISTO
     1      5          yes     yes      XStd       0  ZIM$IMOD
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:85   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIM$JISTO
         yes           XStd      0 ZIM$JIMOD
         yes           XStd      4 ZIM$IHASH
 yes     yes           XStd      1 ZIM$DEQ_INDEXED
 yes     yes           XStd      1 ZIM$ENQM
 yes     yes           XStd      1 ZIM$ENQ_INDEXED
         yes           XStd      0 ZIM$TRACE
 yes     yes           XStd      0 ZIM$INDXMAP_ADD
         yes           XStd      0 ZIM$ICURR
         yes           XStd      0 ZIB$ERR
 yes     yes           XStd      0 ZIM$DEQ_ONE
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  PS0$
     B$ROS$                                B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ROSID
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:86   


      358        1        /*M*     ZIM$ISTO - store index record            */
      359        2        /*T***********************************************************/
      360        3        /*T*                                                         */
      361        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      362        5        /*T*                                                         */
      363        6        /*T***********************************************************/
      364        7        ZIM$ISTO: PROC ALTRET

      7  1 000000   000000 700200 xent  ZIM$ISTO     TSX0  ! X66_AUTO_0
         1 000001   000026 000000                    ZERO    22,0

      365        8               AVOID($PR5,$PR6,$PR7);
      366        9        %INCLUDE ZI$GLOBAL;
      367      495            %GLOBALS;
      368      803            %TRCE_SUBS;
      369      827        %INCLUDE ZI$DBCB;
      370     1469            %DBCB;
      371     1947            %RECVAR;
      372     1981            %AWS;
      373     2021        %INCLUDE ZI$SSS;
      374     2570            %AC;
      375     2665            %RC;
      376     2697            %RA;
      377     2717        %INCLUDE ZI_ERRORS_C;
      378     3043        %INCLUDE CP_6;
      379     3124            %FPT_WRITE(FPTN=FPT$WRTI,STCLASS=BASED);
      380     3155            %FPT_OPEN(FPTN=FPT$REOPEN,STCLASS=BASED);
      381     3264            %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      382     3306            %FPT_ENQ(FPTN=FPT$ENQI,STCLASS=BASED);
      383     3324            %FPT_DEQ(FPTN=FPT$DEQI,STCLASS=BASED);
      384     3341            %F$DCB;
      385     3398            %B$TCB(STCLASS=BASED);
      386     3401            %B$ALT(STCLASS=BASED);
      387     3409        %INCLUDE FM$FIT;
      388     3630            %FITALTKEYS;
      389     3636        %INCLUDE B_ERRORS_C;
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:87   
      390     4763        %INCLUDE CP_6_SUBS;
      391     5303    1   DCL ERROR UBIN(36);
      392     5304    1   DCL FUNCT UBIN WORD;
      393     5305    1   DCL RVT$ PTR;
      394     5306    1   DCL LENGTH UBIN WORD;
      395     5307    1   DCL IXBUF CHAR(LENGTH) BASED CALIGNED;
      396     5308    1   DCL PS0$ PTR SYMREF;
      397     5309    1   DCL B$ROS$ PTR SYMREF;
      398     5310    1   DCL B$TCB$ PTR SYMREF;
      399     5311    1   DCL TEMP UBIN HALF;
      400     5312    1   DCL ZIM$ICURR ENTRY;
      401     5313    1   DCL ZIM$JISTO ENTRY;
      402     5314    1   DCL ZIM$JIMOD ENTRY;
      403     5315    1   DCL ZIM$PROL ENTRY ALTRET;
      404     5316    1   DCL ZIM$TRACE ENTRY;
      405     5317    1   DCL ZIM$ENQM ENTRY(1) ALTRET;
      406     5318    1   DCL ZIM$DEQ_ONE ENTRY ALTRET;
      407     5319    1   DCL ZIM$INDXMAP_ADD ENTRY ALTRET;
      408     5320    1   DCL ZIM$IHASH ENTRY(4);
      409     5321    1   DCL ZIM$ENQ_INDEXED ENTRY(1) ALTRET;
      410     5322    1   DCL ZIM$DEQ_INDEXED ENTRY(1) ALTRET;
      411     5323
      412     5324    1   DCL HASH UBIN;
      413     5325    1   DCL KEYX# UBIN;
      414     5326    1   DCL KEYL# UBIN;
      415     5327    1       FUNCT=1;

   5327  1 000002   000001 235007                    LDA     1,DL
         1 000003   200012 755100                    STA     FUNCT,,AUTO

      416     5328    1       GOTO COM;

   5328  1 000004   000011 710000 1                  TRA     COM

      417     5329    1   ZIM$IMOD: ENTRY ALTRET;

   5329  1 000005   000000 700200 xent  ZIM$IMOD     TSX0  ! X66_AUTO_0
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:88   
         1 000006   000026 000000                    ZERO    22,0

      418     5330    1       FUNCT=2;

   5330  1 000007   000002 235007                    LDA     2,DL
         1 000010   200012 755100                    STA     FUNCT,,AUTO

      419     5331    1   COM: ERROR=0;

   5331  1 000011   200011 450100       COM          STZ     ERROR,,AUTO

      420     5332    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   5332  1 000012   000000 470400 xsym               LDP0    GLOBAL$
         1 000013   000001 236100                    LDQ     1,,PR0
         1 000014   200003 756100                    STQ     DBCB$,,AUTO

      421     5333    1       SSS$=GLOBAL.ACTIVE.SSS$;

   5333  1 000015   000000 236100                    LDQ     0,,PR0
         1 000016   200005 756100                    STQ     SSS$,,AUTO

      422     5334    1       RVT$=PINCRW(DBCB$,DBCB.PCB.RVT);

   5334  1 000017   200003 471500                    LDP1    DBCB$,,AUTO
         1 000020   100512 220100                    LDX0    330,,PR1
         1 000021   000000 636010                    EAQ     0,X0
         1 000022   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000023   200013 756100                    STQ     RVT$,,AUTO

      423     5335    1       AC$=PINCRW(SSS$,RVT$->RECVAR.ACPTR);

   5335  1 000024   200013 473500                    LDP3    RVT$,,AUTO
         1 000025   300005 221100                    LDX1    5,,PR3
         1 000026   000000 636011                    EAQ     0,X1
         1 000027   200005 036100                    ADLQ    SSS$,,AUTO
         1 000030   200006 756100                    STQ     AC$,,AUTO
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:89   

      424     5336    1       AWS$=PINCRW(DBCB$,AC.WSOF);

   5336  1 000031   200006 474500                    LDP4    AC$,,AUTO
         1 000032   400003 222100                    LDX2    3,,PR4
         1 000033   000000 636012                    EAQ     0,X2
         1 000034   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000035   200004 756100                    STQ     AWS$,,AUTO

      425     5337    1       IF AWS.DDCB = 0 THEN GOTO ER_UNAVIL;

   5337  1 000036   200004 470500                    LDP0    AWS$,,AUTO
         1 000037   000006 223100                    LDX3    6,,PR0
         1 000040   000511 600000 1                  TZE     ER_UNAVIL

      426     5338    1       IF AWS.ATRIB.FUN=%IN# THEN

   5338  1 000041   000000 236100                    LDQ     0,,PR0
         1 000042   000060 376003                    ANQ     48,DU
         1 000043   000040 116003                    CMPQ    32,DU
         1 000044   000514 600000 1                  TZE     ER_IUM

      427     5339    1           GOTO ER_IUM;
      428     5340    1       RC$=PINCRW(SSS$,RVT$->RECVAR.RCPTR);

   5340  1 000045   300006 224100                    LDX4    6,,PR3
         1 000046   000000 636014                    EAQ     0,X4
         1 000047   200005 036100                    ADLQ    SSS$,,AUTO
         1 000050   200007 756100                    STQ     RC$,,AUTO

      429     5341    1       RVT$->RECVAR.BADDR$=ADDR(NIL);

   5341  1 000051   000000 236000 2                  LDQ     0
         1 000052   300001 756100                    STQ     1,,PR3

      430     5342    1       RVT$->RECVAR.RADDR$=DBCB.CSECT.TBUF$;

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:90   
   5342  1 000053   100004 236100                    LDQ     4,,PR1
         1 000054   300002 756100                    STQ     2,,PR3

      431     5343    1       RVT$->RECVAR.AWS$=AWS$;

   5343  1 000055   200004 236100                    LDQ     AWS$,,AUTO
         1 000056   300013 756100                    STQ     11,,PR3

      432     5344    1       RVT$->RECVAR.RTP.TYPE=RC.RTYP;

   5344  1 000057   200007 470500                    LDP0    RC$,,AUTO
         1 000060   000003 236100                    LDQ     3,,PR0
         1 000061   300003 752103                    STCQ    3,'03'O,PR3

      433     5345    1       RVT$->RECVAR.RCPTR=POFFW(RC$,SSS$);

   5345  1 000062   200005 236100                    LDQ     SSS$,,AUTO
         1 000063   000022 772000                    QRL     18
         1 000064   200022 756100                    STQ     KEYL#+2,,AUTO
         1 000065   200007 236100                    LDQ     RC$,,AUTO
         1 000066   000022 772000                    QRL     18
         1 000067   200022 136100                    SBLQ    KEYL#+2,,AUTO
         1 000070   000000 620006                    EAX0    0,QL
         1 000071   300006 740100                    STX0    6,,PR3

      434     5346    1       RVT$->RECVAR.ACPTR=POFFW(AC$,SSS$);

   5346  1 000072   200005 236100                    LDQ     SSS$,,AUTO
         1 000073   000022 772000                    QRL     18
         1 000074   200022 756100                    STQ     KEYL#+2,,AUTO
         1 000075   200006 236100                    LDQ     AC$,,AUTO
         1 000076   000022 772000                    QRL     18
         1 000077   200022 136100                    SBLQ    KEYL#+2,,AUTO
         1 000100   000000 620006                    EAX0    0,QL
         1 000101   300005 740100                    STX0    5,,PR3

      435     5347    1       IF RC.DEF.FVR THEN
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:91   

   5347  1 000102   000000 236100                    LDQ     0,,PR0
         1 000103   040000 316007                    CANQ    16384,DL
         1 000104   000110 600000 1                  TZE     s:5350

      436     5348    1           RVT$->RECVAR.RECSZ=DBCB.IOWS.VRSIZ;

   5348  1 000105   101074 721100                    LXL1    572,,PR1
         1 000106   300003 741100                    STX1    3,,PR3
         1 000107   000112 710000 1                  TRA     s:5351

      437     5349    1       ELSE
      438     5350    1           RVT$->RECVAR.RECSZ=RC.RSIZ;

   5350  1 000110   000003 221100                    LDX1    3,,PR0
         1 000111   300003 741100                    STX1    3,,PR3

      439     5351    2       DO CASE(FUNCT);

   5351  1 000112   000003 115007                    CMPA    3,DL
         1 000113   000115 602005 1                  TNC     s:5351+3,AL
         1 000114   000137 710000 1                  TRA     s:5359
         1 000115   000137 710000 1                  TRA     s:5359
         1 000116   000120 710000 1                  TRA     s:5353
         1 000117   000130 710000 1                  TRA     s:5356

      440     5352    2       CASE(1);

      441     5353    2           CALL ZIM$JISTO;

   5353  1 000120   000001 631400 2                  EPPR1   1
         1 000121   000000 701000 xent               TSX1    ZIM$JISTO
         1 000122   000000 011000                    NOP     0

      442     5354    2           GLOBAL.WRTI$->FPT$WRTI.V.ONEWKEY#=%NO#;

   5354  1 000123   000000 470400 xsym               LDP0    GLOBAL$
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:92   
         1 000124   005076 471500                    LDP1    2622,,PR0
         1 000125   000002 236000 2                  LDQ     2
         1 000126   100010 356100                    ANSQ    8,,PR1
         1 000127   000137 710000 1                  TRA     s:5359

      443     5355    2       CASE(2);

      444     5356    2           CALL ZIM$JIMOD;

   5356  1 000130   000001 631400 2                  EPPR1   1
         1 000131   000000 701000 xent               TSX1    ZIM$JIMOD
         1 000132   000000 011000                    NOP     0

      445     5357    2           GLOBAL.WRTI$->FPT$WRTI.V.ONEWKEY#=%YES#;

   5357  1 000133   000000 470400 xsym               LDP0    GLOBAL$
         1 000134   005076 471500                    LDP1    2622,,PR0
         1 000135   000400 236007                    LDQ     256,DL
         1 000136   100010 256100                    ORSQ    8,,PR1

      446     5358    2           END; /* CASE */

      447     5359    1       GLOBAL.WRTI$->FPT$WRTI.V.DCB#=AWS.DDCB;

   5359  1 000137   000000 470400 xsym               LDP0    GLOBAL$
         1 000140   005076 471500                    LDP1    2622,,PR0
         1 000141   200004 473500                    LDP3    AWS$,,AUTO
         1 000142   300006 220100                    LDX0    6,,PR3
         1 000143   100010 740100                    STX0    8,,PR1

      448     5360    1       GLOBAL.WRTI$->FPT$WRTI.BUF_.BUF$=RVT$->RECVAR.RADDR$;

   5360  1 000144   005076 471500                    LDP1    2622,,PR0
         1 000145   200013 474500                    LDP4    RVT$,,AUTO
         1 000146   400002 236100                    LDQ     2,,PR4
         1 000147   100005 756100                    STQ     5,,PR1

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:93   
      449     5361    1       GLOBAL.WRTI$->FPT$WRTI.BUF_.BOUND=RVT$->RECVAR.RECSZ-1;

   5361  1 000150   005076 471500                    LDP1    2622,,PR0
         1 000151   400003 236100                    LDQ     3,,PR4
         1 000152   000022 772000                    QRL     18
         1 000153   000001 136007                    SBLQ    1,DL
         1 000154   000020 736000                    QLS     16
         1 000155   100004 676100                    ERQ     4,,PR1
         1 000156   000003 376000 2                  ANQ     3
         1 000157   100004 656100                    ERSQ    4,,PR1

      450     5362    1       LENGTH=RVT$->RECVAR.RECSZ;

   5362  1 000160   400003 236100                    LDQ     3,,PR4
         1 000161   000022 772000                    QRL     18
         1 000162   200014 756100                    STQ     LENGTH,,AUTO

      451     5363    1       DBCB.CSECT.IXBUF$->IXBUF=DBCB.CSECT.TBUF$->IXBUF;

   5363  1 000163   200003 471500                    LDP1    DBCB$,,AUTO
         1 000164   100011 470500                    LDP0    9,,PR1
         1 000165   100004 473500                    LDP3    4,,PR1
         1 000166   000000 620006                    EAX0    0,QL
         1 000167   200014 721100                    LXL1    LENGTH,,AUTO
         1 000170   040140 100540                    MLR     fill='040'O
         1 000171   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000172   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

      452     5364    2       IF AWS.ATRIB.CAC THEN DO;

   5364  1 000173   200004 470500                    LDP0    AWS$,,AUTO
         1 000174   000000 236100                    LDQ     0,,PR0
         1 000175   000001 316003                    CANQ    1,DU
         1 000176   000253 600000 1                  TZE     s:5375

      453     5365    2           GLOBAL.ENQ.SHARE=%NONE#;

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:94   
   5365  1 000177   000000 473400 xsym               LDP3    GLOBAL$
         1 000200   003000 236003                    LDQ     1536,DU
         1 000201   301407 552140                    STBQ    775,'40'O,PR3

      454     5366    2           GLOBAL.ENQ.VALUE.DCB#=AWS.DDCB;

   5366  1 000202   000006 220100                    LDX0    6,,PR0
         1 000203   301407 440100                    SXL0    775,,PR3

      455     5367    2           KEYX#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->

   5367  1 000204   000004 470400 2                  LDP0    4
         1 000205   000000 471500                    LDP1    0,,PR0
         1 000206   200004 470500                    LDP0    AWS$,,AUTO
         1 000207   000006 222100                    LDX2    6,,PR0
         1 000210   100000 470512                    LDP0    0,X2,PR1
         1 000211   000052 722100                    LXL2    42,,PR0
         1 000212   000000 470400 xsym               LDP0    B$ROS$
         1 000213   000003 236112                    LDQ     3,X2,PR0
         1 000214   777777 376007                    ANQ     -1,DL
         1 000215   200017 756100                    STQ     KEYX#,,AUTO

      456     5368    2              FITALTKEYS.K.KEYX(0);
      457     5369    2           KEYL#=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->

   5369  1 000216   000004 471400 2                  LDP1    4
         1 000217   100000 470500                    LDP0    0,,PR1
         1 000220   200004 471500                    LDP1    AWS$,,AUTO
         1 000221   100006 222100                    LDX2    6,,PR1
         1 000222   000000 471512                    LDP1    0,X2,PR0
         1 000223   100052 722100                    LXL2    42,,PR1
         1 000224   000000 470400 xsym               LDP0    B$ROS$
         1 000225   000001 236112                    LDQ     1,X2,PR0
         1 000226   000033 772000                    QRL     27
         1 000227   200020 756100                    STQ     KEYL#,,AUTO

      458     5370    2              FITALTKEYS.K.KEYL(0);
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:95   
      459     5371    2           CALL ZIM$IHASH(DBCB.CSECT.IXBUF$->IXBUF,KEYX#,KEYL#,HASH);

   5371  1 000230   200003 471500                    LDP1    DBCB$,,AUTO
         1 000231   100011 470500                    LDP0    9,,PR1
         1 000232   200016 631500                    EPPR1   HASH,,AUTO
         1 000233   200025 451500                    STP1    KEYL#+5,,AUTO
         1 000234   200020 631500                    EPPR1   KEYL#,,AUTO
         1 000235   200024 451500                    STP1    KEYL#+4,,AUTO
         1 000236   200017 631500                    EPPR1   KEYX#,,AUTO
         1 000237   200023 451500                    STP1    KEYL#+3,,AUTO
         1 000240   200022 450500                    STP0    KEYL#+2,,AUTO
         1 000241   200022 630500                    EPPR0   KEYL#+2,,AUTO
         1 000242   000005 631400 2                  EPPR1   5
         1 000243   000000 701000 xent               TSX1    ZIM$IHASH
         1 000244   000000 011000                    NOP     0

      460     5372    2           GLOBAL.ENQ.VALUE.RNAME=HASH;

   5372  1 000245   000000 470400 xsym               LDP0    GLOBAL$
         1 000246   200016 235100                    LDA     HASH,,AUTO
         1 000247   001410 755100                    STA     776,,PR0

      461     5373    2           CALL ZIM$ENQM ALTRET(ALT);

   5373  1 000250   000001 631400 2                  EPPR1   1
         1 000251   000000 701000 xent               TSX1    ZIM$ENQM
         1 000252   000550 702000 1                  TSX2    ER_JRNL

      462     5374    2           END;

      463     5375    1       IF AWS.ATRIB.CAC THEN

   5375  1 000253   200004 470500                    LDP0    AWS$,,AUTO
         1 000254   000000 236100                    LDQ     0,,PR0
         1 000255   000001 316003                    CANQ    1,DU
         1 000256   000263 600000 1                  TZE     s:5377

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:96   
      464     5376    1           CALL ZIM$ENQ_INDEXED(AWS) ALTRET(ALT);

   5376  1 000257   200004 630500                    EPPR0   AWS$,,AUTO
         1 000260   000006 631400 2                  EPPR1   6
         1 000261   000000 701000 xent               TSX1    ZIM$ENQ_INDEXED
         1 000262   000550 702000 1                  TSX2    ER_JRNL

      465     5377    1       CALL M$WRITE(GLOBAL.WRTI$->FPT$WRTI) ALTRET(ER_WRT);

   5377  1 000263   000000 470400 xsym               LDP0    GLOBAL$
         1 000264   005076 471500                    LDP1    2622,,PR0
         1 000265   100000 630500                    EPPR0   0,,PR1
         1 000266   440001 713400                    CLIMB   alt,write
         1 000267   401400 401760                    pmme    nvectors=4
         1 000270   000450 702000 1                  TSX2    ER_WRT

      466     5378    2       IF AWS.ATRIB.CAC THEN DO;

   5378  1 000271   200004 470500                    LDP0    AWS$,,AUTO
         1 000272   000000 236100                    LDQ     0,,PR0
         1 000273   000001 316003                    CANQ    1,DU
         1 000274   000305 600000 1                  TZE     s:5383

      467     5379    2           CALL ZIM$INDXMAP_ADD ALTRET(ALT);

   5379  1 000275   000001 631400 2                  EPPR1   1
         1 000276   000000 701000 xent               TSX1    ZIM$INDXMAP_ADD
         1 000277   000550 702000 1                  TSX2    ER_JRNL

      468     5380    2           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);

   5380  1 000300   200004 630500                    EPPR0   AWS$,,AUTO
         1 000301   000006 631400 2                  EPPR1   6
         1 000302   000000 701000 xent               TSX1    ZIM$DEQ_INDEXED
         1 000303   000550 702000 1                  TSX2    ER_JRNL

      469     5381    2           END;
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:97   

   5381  1 000304   000344 710000 1                  TRA     s:5390

      470     5382    1       ELSE
      471     5383    2           IF DCBADDR(AWS.DDCB)->F$DCB.RDL0#>3 THEN DO;

   5383  1 000305   000004 471400 2                  LDP1    4
         1 000306   100000 473500                    LDP3    0,,PR1
         1 000307   000006 220100                    LDX0    6,,PR0
         1 000310   300000 474510                    LDP4    0,X0,PR3
         1 000311   400003 236100                    LDQ     3,,PR4
         1 000312   000777 376003                    ANQ     511,DU
         1 000313   000004 116003                    CMPQ    4,DU
         1 000314   000344 602000 1                  TNC     s:5390

      472     5384    2               GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.DDCB;

   5384  1 000315   000000 470400 xsym               LDP0    GLOBAL$
         1 000316   005072 474500                    LDP4    2618,,PR0
         1 000317   200004 470500                    LDP0    AWS$,,AUTO
         1 000320   000006 220100                    LDX0    6,,PR0
         1 000321   400032 740100                    STX0    26,,PR4

      473     5385    2               GLOBAL.CLOSE$->FPT$CLOSE.V.OPER.REBLD#='1'B; /* REB KEY */

   5385  1 000322   000000 474400 xsym               LDP4    GLOBAL$
         1 000323   405072 470500                    LDP0    2618,,PR4
         1 000324   100000 236007                    LDQ     32768,DL
         1 000325   000032 256100                    ORSQ    26,,PR0

      474     5386    2               CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE) ALTRET(ER_CLSI);

   5386  1 000326   405072 470500                    LDP0    2618,,PR4
         1 000327   450001 713400                    CLIMB   alt,close
         1 000330   406000 401760                    pmme    nvectors=13
         1 000331   000517 702000 1                  TSX2    ER_CLSI

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:98   
      475     5387    2               GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#=AWS.DDCB;

   5387  1 000332   000000 470400 xsym               LDP0    GLOBAL$
         1 000333   005071 471500                    LDP1    2617,,PR0
         1 000334   200004 473500                    LDP3    AWS$,,AUTO
         1 000335   300006 220100                    LDX0    6,,PR3
         1 000336   100044 740100                    STX0    36,,PR1

      476     5388    2               CALL M$OPEN(GLOBAL.REOPEN$->FPT$REOPEN) ALTRET(ER_OPNI);

   5388  1 000337   005071 471500                    LDP1    2617,,PR0
         1 000340   100000 630500                    EPPR0   0,,PR1
         1 000341   450000 713400                    CLIMB   alt,open
         1 000342   410400 401760                    pmme    nvectors=18
         1 000343   000532 702000 1                  TSX2    ER_OPNI

      477     5389    2               END;

      478     5390    1       RVT$->RECVAR.DBKEY=GLOBAL.KEYID.RECID;

   5390  1 000344   000000 470400 xsym               LDP0    GLOBAL$
         1 000345   005012 235100                    LDA     2570,,PR0
         1 000346   200013 471500                    LDP1    RVT$,,AUTO
         1 000347   100000 755100                    STA     0,,PR1

      479     5391    1       RVT$->RECVAR.RADDR$=DBCB.CSECT.IXBUF$;

   5391  1 000350   200003 473500                    LDP3    DBCB$,,AUTO
         1 000351   300011 236100                    LDQ     9,,PR3
         1 000352   100002 756100                    STQ     2,,PR1

      480     5392    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;

   5392  1 000353   001425 235100                    LDA     789,,PR0
         1 000354   000001 035007                    ADLA    1,DL
         1 000355   001425 755100                    STA     789,,PR0

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:99   
      481     5393    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;

   5393  1 000356   001426 235100                    LDA     790,,PR0
         1 000357   000001 035007                    ADLA    1,DL
         1 000360   001426 755100                    STA     790,,PR0

      482     5394    2       IF GLOBAL.PARAN.TRACE.MODE~='0'B THEN DO;

   5394  1 000361   000061 235100                    LDA     49,,PR0
         1 000362   000430 600000 1                  TZE     s:5409

      483     5395    2           GLOBAL.PARAN.TRACE.RTYPE=RC.RTYP;

   5395  1 000363   200007 474500                    LDP4    RC$,,AUTO
         1 000364   400003 720100                    LXL0    3,,PR4
         1 000365   007777 360003                    ANX0    4095,DU
         1 000366   000060 440100                    SXL0    48,,PR0

      484     5396    2           GLOBAL.PARAN.TRACE.RNAME=RC.RNAM;

   5396  1 000367   400000 721100                    LXL1    0,,PR4
         1 000370   000077 361003                    ANX1    63,DU
         1 000371   040100 100540                    MLR     fill='040'O
         1 000372   400005 000011                    ADSC9   5,,PR4                   cn=0,n=*X1
         1 000373   000046 000036                    ADSC9   38,,PR0                  cn=0,n=30

      485     5397    2           IF AWS.ATRIB.CAC THEN

   5397  1 000374   200004 470500                    LDP0    AWS$,,AUTO
         1 000375   000000 236100                    LDQ     0,,PR0
         1 000376   000001 316003                    CANQ    1,DU
         1 000377   000413 600000 1                  TZE     s:5403

      486     5398    2               IF FUNCT=1 THEN

   5398  1 000400   200012 235100                    LDA     FUNCT,,AUTO
         1 000401   000001 115007                    CMPA    1,DL
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:100  
         1 000402   000407 601000 1                  TNZ     s:5401

      487     5399    2                   GLOBAL.PARAN.TRACE.TYPE=TR#ISTOENQ;

   5399  1 000403   000020 220003                    LDX0    16,DU
         1 000404   000000 470400 xsym               LDP0    GLOBAL$
         1 000405   000060 740100                    STX0    48,,PR0
         1 000406   000425 710000 1                  TRA     s:5407

      488     5400    2               ELSE
      489     5401    2                   GLOBAL.PARAN.TRACE.TYPE=TR#IMODENQ;

   5401  1 000407   000022 220003                    LDX0    18,DU
         1 000410   000000 470400 xsym               LDP0    GLOBAL$
         1 000411   000060 740100                    STX0    48,,PR0
         1 000412   000425 710000 1                  TRA     s:5407

      490     5402    2           ELSE
      491     5403    2               IF FUNCT=1 THEN

   5403  1 000413   200012 235100                    LDA     FUNCT,,AUTO
         1 000414   000001 115007                    CMPA    1,DL
         1 000415   000422 601000 1                  TNZ     s:5406

      492     5404    2                   GLOBAL.PARAN.TRACE.TYPE=TR#ISTO;

   5404  1 000416   000011 220003                    LDX0    9,DU
         1 000417   000000 470400 xsym               LDP0    GLOBAL$
         1 000420   000060 740100                    STX0    48,,PR0
         1 000421   000425 710000 1                  TRA     s:5407

      493     5405    2               ELSE
      494     5406    2                   GLOBAL.PARAN.TRACE.TYPE=TR#IMOD;

   5406  1 000422   000013 220003                    LDX0    11,DU
         1 000423   000000 470400 xsym               LDP0    GLOBAL$
         1 000424   000060 740100                    STX0    48,,PR0
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:101  

      495     5407    2           CALL ZIM$TRACE;

   5407  1 000425   000001 631400 2                  EPPR1   1
         1 000426   000000 701000 xent               TSX1    ZIM$TRACE
         1 000427   000000 011000                    NOP     0

      496     5408    2           END;

      497     5409    1       TEMP=DBCB.PCB.RVT;

   5409  1 000430   200003 470500                    LDP0    DBCB$,,AUTO
         1 000431   000512 220100                    LDX0    330,,PR0
         1 000432   200015 740100                    STX0    TEMP,,AUTO

      498     5410    1       DBCB.PCB.RVT=DBCB.PCB.RVO;

   5410  1 000433   000511 221100                    LDX1    329,,PR0
         1 000434   000512 741100                    STX1    330,,PR0

      499     5411    1       DBCB.PCB.RVO=TEMP;

   5411  1 000435   000511 740100                    STX0    329,,PR0

      500     5412    1       CALL ZIM$ICURR;

   5412  1 000436   000001 631400 2                  EPPR1   1
         1 000437   000000 701000 xent               TSX1    ZIM$ICURR
         1 000440   000000 011000                    NOP     0

      501     5413    1       TEMP=DBCB.PCB.RVT;

   5413  1 000441   200003 470500                    LDP0    DBCB$,,AUTO
         1 000442   000512 220100                    LDX0    330,,PR0
         1 000443   200015 740100                    STX0    TEMP,,AUTO

      502     5414    1       DBCB.PCB.RVT=DBCB.PCB.RVO;
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:102  

   5414  1 000444   000511 221100                    LDX1    329,,PR0
         1 000445   000512 741100                    STX1    330,,PR0

      503     5415    1       DBCB.PCB.RVO=TEMP;

   5415  1 000446   000511 740100                    STX0    329,,PR0

      504     5416    1       RETURN;

   5416  1 000447   000000 702200 xent               TSX2  ! X66_ARET

   5415  1 000450                       ER_WRT       null
      505     5417    1   ER_WRT: ;
      506     5418    2       IF AWS.ATRIB.CAC THEN DO;

   5418  1 000450   200004 470500                    LDP0    AWS$,,AUTO
         1 000451   000000 236100                    LDQ     0,,PR0
         1 000452   000001 316003                    CANQ    1,DU
         1 000453   000470 600000 1                  TZE     s:5438

      507     5419                %DBCAL(NAME=ZIM$DEQ_ONE,EXC=ER_WRT0,ALT=ALT);

   5423  1 000454   000001 631400 2                  EPPR1   1
         1 000455   000000 701000 xent               TSX1    ZIM$DEQ_ONE
         1 000456   000550 702000 1                  TSX2    ER_JRNL

   5424  1 000457   000000 470400 xsym               LDP0    GLOBAL$
         1 000460   000006 235100                    LDA     6,,PR0
         1 000461   000464 600000 1                  TZE     ER_WRT0

   5429  1 000462   000006 450100                    STZ     6,,PR0

   5430  1 000463   000464 710000 1                  TRA     ER_WRT0

   5423  1 000464                       ER_WRT0      null
      508     5435    2   ER_WRT0: ;
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:103  
      509     5436    2           CALL ZIM$DEQ_INDEXED(AWS) ALTRET(ALT);

   5436  1 000464   200004 630500                    EPPR0   AWS$,,AUTO
         1 000465   000006 631400 2                  EPPR1   6
         1 000466   000000 701000 xent               TSX1    ZIM$DEQ_INDEXED
         1 000467   000550 702000 1                  TSX2    ER_JRNL

      510     5437    2           END;

      511     5438    1       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$OLDREC OR

   5438  1 000470   000000 470400 xsym               LDP0    B$TCB$
         1 000471   000000 471500                    LDP1    0,,PR0
         1 000472   100102 236100                    LDQ     66,,PR1
         1 000473   377770 376007                    ANQ     131064,DL
         1 000474   000750 116007                    CMPQ    488,DL
         1 000475   000545 600000 1                  TZE     EX_DDI
         1 000476   001310 116007                    CMPQ    712,DL
         1 000477   000545 600000 1                  TZE     EX_DDI

      512     5439    1          B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$DUPKEY THEN
      513     5440    1           GOTO EX_DDI;
      514     5441    1       ELSE
      515     5442    1           ERROR=ERR#IX#UNEX;

   5442  1 000500   303423 235007                    LDA     100115,DL
         1 000501   200011 755100                    STA     ERROR,,AUTO

      516     5443    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5443  1 000502   100102 236100                    LDQ     66,,PR1
         1 000503   000000 473400 xsym               LDP3    GLOBAL$
         1 000504   300007 756100                    STQ     7,,PR3

      517     5444    1       GLOBAL.RET.DCB#=GLOBAL.WRTI$->FPT$WRTI.V.DCB#;

   5444  1 000505   305076 471500                    LDP1    2622,,PR3
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:104  
         1 000506   100010 220100                    LDX0    8,,PR1
         1 000507   300014 740100                    STX0    12,,PR3

      518     5445    1       GOTO ALT;

   5445  1 000510   000550 710000 1                  TRA     ER_JRNL

      519     5446    1   ER_UNAVIL: ERROR=EXC#UNA;

   5446  1 000511   004230 235007       ER_UNAVIL    LDA     2200,DL
         1 000512   200011 755100                    STA     ERROR,,AUTO

      520     5447    1       GOTO ALT;

   5447  1 000513   000550 710000 1                  TRA     ER_JRNL

      521     5448    1   ER_IUM:ERROR=EXC#IUM;

   5448  1 000514   021760 235007       ER_IUM       LDA     9200,DL
         1 000515   200011 755100                    STA     ERROR,,AUTO

      522     5449    1       GOTO ALT;

   5449  1 000516   000550 710000 1                  TRA     ER_JRNL

      523     5450    1   ER_CLSI: ERROR=ERR#IO#CLSI;

   5450  1 000517   210761 235007       ER_CLSI      LDA     70129,DL
         1 000520   200011 755100                    STA     ERROR,,AUTO

      524     5451    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5451  1 000521   000000 470400 xsym               LDP0    B$TCB$
         1 000522   000000 471500                    LDP1    0,,PR0
         1 000523   100102 236100                    LDQ     66,,PR1
         1 000524   000000 473400 xsym               LDP3    GLOBAL$
         1 000525   300007 756100                    STQ     7,,PR3
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:105  

      525     5452    1       GLOBAL.RET.DCB#=GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#;

   5452  1 000526   305072 471500                    LDP1    2618,,PR3
         1 000527   100032 220100                    LDX0    26,,PR1
         1 000530   300014 740100                    STX0    12,,PR3

      526     5453    1       GOTO ALT;

   5453  1 000531   000550 710000 1                  TRA     ER_JRNL

      527     5454    1   ER_OPNI: ERROR=ERR#IO#OPNI;

   5454  1 000532   210760 235007       ER_OPNI      LDA     70128,DL
         1 000533   200011 755100                    STA     ERROR,,AUTO

      528     5455    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5455  1 000534   000000 470400 xsym               LDP0    B$TCB$
         1 000535   000000 471500                    LDP1    0,,PR0
         1 000536   100102 236100                    LDQ     66,,PR1
         1 000537   000000 473400 xsym               LDP3    GLOBAL$
         1 000540   300007 756100                    STQ     7,,PR3

      529     5456    1       GLOBAL.RET.DCB#=GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#;

   5456  1 000541   305071 471500                    LDP1    2617,,PR3
         1 000542   100044 220100                    LDX0    36,,PR1
         1 000543   300014 740100                    STX0    12,,PR3

      530     5457    1       GOTO ALT;

   5457  1 000544   000550 710000 1                  TRA     ER_JRNL

      531     5458    1   EX_DDI: ERROR=EXC#DDI;

   5458  1 000545   011754 235007       EX_DDI       LDA     5100,DL
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:106  
         1 000546   200011 755100                    STA     ERROR,,AUTO

      532     5459    1       GOTO ALT;

   5459  1 000547   000550 710000 1                  TRA     ER_JRNL

   5456  1 000550                       ER_JRNL      null
   5456  1 000550                       ER_ENQM      null
   5456  1 000550                       ALT          null
      533     5460    1   ER_JRNL: ;
      534     5461    1   ER_ENQM: ;
      535     5462    1   ALT: ;
      536     5463            %DBALT;

   5464  1 000550   000000 470400 xsym               LDP0    GLOBAL$
         1 000551   000006 235100                    LDA     6,,PR0
         1 000552   000561 601000 1                  TNZ     s:5472

   5466  1 000553   000010 450100                    STZ     8,,PR0

   5467  1 000554   000012 450100                    STZ     10,,PR0

   5468  1 000555   000013 450100                    STZ     11,,PR0

   5469  1 000556   000011 450100                    STZ     9,,PR0

   5470  1 000557   200011 236100                    LDQ     ERROR,,AUTO
         1 000560   000006 756100                    STQ     6,,PR0

   5472  1 000561   000006 235100                    LDA     6,,PR0
         1 000562   303240 115007                    CMPA    100000,DL
         1 000563   000565 603000 1                  TRC     s:5475

   5473  1 000564   000000 702200 xent               TSX2  ! X66_AALT

   5475  1 000565   000001 631400 2                  EPPR1   1
         1 000566   000000 701000 xent               TSX1    ZIB$ERR
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:107  
         1 000567   000000 011000                    NOP     0

      537     5477    1       RETURN;

   5477  1 000570   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 006014   000000 000000   777777 777377   777777 600000    ................
   2     004   000000 006003   000004 000000   000001 000000                    ............
      538     5478    1   END ZIM$ISTO;
      539     5479        %EOD;

PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:108  
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$ISTO.

   Procedure ZIM$ISTO requires 377 words for executable code.
   Procedure ZIM$ISTO requires 22 words of local(AUTO) storage.
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:109  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:110  
          MINI XREF LISTING

AC.DEF.ANL
      2590**DCL      2661--IMP-SIZ
AC.DEF.FORG
      2577**DCL      2581--REDEF
AC.WSOF
      2594**DCL      5336>>ASSIGN
AC$
      2573**DCL      2574--IMP-PTR  5335<<ASSIGN   5336>>ASSIGN   5346>>ASSIGN
ALT
      5456**LABEL    5373--CALLALT  5376--CALLALT  5379--CALLALT  5380--CALLALT  5423--CALLALT  5436--CALLALT
      5445--GOTO     5447--GOTO     5449--GOTO     5453--GOTO     5457--GOTO     5459--GOTO
AWS
      1983**DCL      5376<>CALL     5380<>CALL     5436<>CALL
AWS.ATRIB.CAC
      2000**DCL      5364>>IF       5375>>IF       5378>>IF       5397>>IF       5418>>IF
AWS.ATRIB.FUN
      1996**DCL      5338>>IF
AWS.DDCB
      2008**DCL      5337>>IF       5359>>ASSIGN   5366>>ASSIGN   5367--ASSIGN   5369--ASSIGN   5383--IF
      5384>>ASSIGN   5387>>ASSIGN
AWS$
      1982**DCL      1983--IMP-PTR  5336<<ASSIGN   5337>>IF       5338>>IF       5343>>ASSIGN   5359>>ASSIGN
      5364>>IF       5366>>ASSIGN   5367>>ASSIGN   5369>>ASSIGN   5375>>IF       5376>>CALL     5378>>IF
      5380>>CALL     5383>>IF       5384>>ASSIGN   5387>>ASSIGN   5397>>IF       5418>>IF       5436>>CALL
B$ALT.CODE
      3403**DCL      3403--REDEF    3404--REDEF    3404--REDEF
B$ALT.ERR
      3404**DCL      5443>>ASSIGN   5451>>ASSIGN   5455>>ASSIGN
B$ALT.ERR.ERR#
      3405**DCL      3405--REDEF    5438>>IF       5438>>IF
B$ALT.EVID
      3404**DCL      3404--REDEF    3404--REDEF
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:111  
B$ROS$
      5309**DCL      5367>>ASSIGN   5369>>ASSIGN
B$TCB.ALT$
      3399**DCL      5438>>IF       5438>>IF       5443>>ASSIGN   5451>>ASSIGN   5455>>ASSIGN
B$TCB$
      5310**DCL      5438>>IF       5438>>IF       5443>>ASSIGN   5451>>ASSIGN   5455>>ASSIGN
COM
      5331**LABEL    5328--GOTO
DBCB.CSECT.IXBUF$
      1487**DCL      5363>>ASSIGN   5371>>CALL     5391>>ASSIGN
DBCB.CSECT.TBUF$
      1481**DCL      5342>>ASSIGN   5363>>ASSIGN
DBCB.IOWS.CFCT
      1899**DCL      1900--REDEF
DBCB.IOWS.DBKF.RQ
      1842**DCL      1843--REDEF
DBCB.IOWS.DBKR
      1839**DCL      1840--REDEF
DBCB.IOWS.NOBF
      1901**DCL      1902--REDEF
DBCB.IOWS.SPND
      1827**DCL      1828--REDEF
DBCB.IOWS.VRSIZ
      1918**DCL      5348>>ASSIGN
DBCB.PCB.RVO
      1677**DCL      5410>>ASSIGN   5411<<ASSIGN   5414>>ASSIGN   5415<<ASSIGN
DBCB.PCB.RVT
      1679**DCL      5334>>ASSIGN   5409>>ASSIGN   5410<<ASSIGN   5413>>ASSIGN   5414<<ASSIGN
DBCB.SWS.RDYCW
      1565**DCL      1566--REDEF
DBCB.SWS.TEMP.PTR1$
      1599**DCL      1600--REDEF    1601--REDEF
DBCB.SWS.TEMP.PTR2$
      1602**DCL      1603--REDEF
DBCB$
      1470**DCL      1471--IMP-PTR  5332<<ASSIGN   5334>>ASSIGN   5334>>ASSIGN   5336>>ASSIGN   5342>>ASSIGN
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:112  
      5348>>ASSIGN   5363>>ASSIGN   5363>>ASSIGN   5371>>CALL     5391>>ASSIGN   5409>>ASSIGN   5410>>ASSIGN
      5410>>ASSIGN   5411>>ASSIGN   5413>>ASSIGN   5414>>ASSIGN   5414>>ASSIGN   5415>>ASSIGN
ERROR
      5303**DCL      5331<<ASSIGN   5442<<ASSIGN   5446<<ASSIGN   5448<<ASSIGN   5450<<ASSIGN   5454<<ASSIGN
      5458<<ASSIGN   5470>>ASSIGN
ER_CLSI
      5450**LABEL    5386--CALLALT
ER_IUM
      5448**LABEL    5339--GOTO
ER_OPNI
      5454**LABEL    5388--CALLALT
ER_UNAVIL
      5446**LABEL    5337--GOTO
ER_WRT
      5415**LABEL    5377--CALLALT
ER_WRT0
      5423**LABEL    5430--GOTO
EX_DDI
      5458**LABEL    5440--GOTO
F$DCB.ACTPOS
      3374**DCL      3374--REDEF
F$DCB.ALTKEYX
      3373**DCL      5367>>ASSIGN   5369>>ASSIGN
F$DCB.ARS#
      3348**DCL      3348--REDEF
F$DCB.ATTR
      3367**DCL      3368--REDEF
F$DCB.BORROW
      3382**DCL      3382--REDEF    3382--REDEF    3382--REDEF
F$DCB.DCBNAME.L
      3396**DCL      3396--IMP-SIZ
F$DCB.EOMCHAR#
      3352**DCL      3352--REDEF
F$DCB.FLDID
      3377**DCL      3377--REDEF
F$DCB.FORM$
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:113  
      3371**DCL      3371--REDEF
F$DCB.FSECT
      3387**DCL      3387--REDEF
F$DCB.FSN#
      3364**DCL      3364--REDEF    3364--REDEF    3365--REDEF
F$DCB.HEADER$
      3370**DCL      3370--REDEF
F$DCB.IXTNSIZE#
      3368**DCL      3368--REDEF
F$DCB.LASTSTA$
      3357**DCL      3357--REDEF
F$DCB.LVL
      3383**DCL      3383--REDEF
F$DCB.NAME#.C
      3358**DCL      3358--REDEF
F$DCB.NOEOF
      3380**DCL      3380--REDEF
F$DCB.NRECS#
      3369**DCL      3369--REDEF
F$DCB.NRECX
      3388**DCL      3388--REDEF
F$DCB.OHDR
      3380**DCL      3380--REDEF
F$DCB.ORG#
      3363**DCL      3363--REDEF
F$DCB.PRECNO
      3386**DCL      3386--REDEF
F$DCB.RCSZ
      3392**DCL      3392--REDEF
F$DCB.RDL0#
      3352**DCL      5383>>IF
F$DCB.RES#
      3359**DCL      3359--REDEF
F$DCB.SETX
      3371**DCL      3371--REDEF
F$DCB.TAB$
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:114  
      3371**DCL      3371--REDEF
F$DCB.TDA
      3385**DCL      3386--REDEF
F$DCB.WSN#
      3359**DCL      3359--REDEF
FITALTKEYS.K.KEYL
      3632**DCL      5369>>ASSIGN
FITALTKEYS.K.KEYX
      3632**DCL      5367>>ASSIGN
FPT$CLOSE
      3287**DCL      5386<>CALL
FPT$CLOSE.SN_
      3287**DCL      3287--REDEF
FPT$CLOSE.UTL_
      3288**DCL      3288--REDEF
FPT$CLOSE.V.DCB#
      3293**DCL      5384<<ASSIGN   5452>>ASSIGN
FPT$CLOSE.V.EXPIRE#
      3302**DCL      3302--REDEF
FPT$CLOSE.V.OPER.REBLD#
      3294**DCL      5385<<ASSIGN
FPT$CLOSE.V.TYPE#
      3300**DCL      3300--REDEF
FPT$CLOSE.V.XTNSIZE#
      3297**DCL      3297--REDEF    3299--REDEF
FPT$REOPEN
      3220**DCL      5388<>CALL
FPT$REOPEN.ACSVEH_
      3222**DCL      3223--REDEF
FPT$REOPEN.ALTKEYS_
      3228**DCL      3229--REDEF    3229--REDEF
FPT$REOPEN.HDR_
      3227**DCL      3228--REDEF
FPT$REOPEN.TAB_
      3226**DCL      3227--REDEF
FPT$REOPEN.UHL_
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:115  
      3220**DCL      3221--REDEF    3221--REDEF
FPT$REOPEN.V.DCB#
      3229**DCL      5387<<ASSIGN   5456>>ASSIGN
FPT$REOPEN.V.FSN#
      3260**DCL      3260--REDEF    3260--REDEF
FPT$REOPEN.WSN_
      3226**DCL      3226--REDEF
FPT$WRTI
      3141**DCL      5377<>CALL
FPT$WRTI.BUF_.BOUND
      3141**DCL      5361<<ASSIGN
FPT$WRTI.BUF_.BUF$
      3143**DCL      5360<<ASSIGN
FPT$WRTI.STATION_
      3143**DCL      3143--REDEF
FPT$WRTI.V.DCB#
      3144**DCL      5359<<ASSIGN   5444>>ASSIGN
FPT$WRTI.V.DVBYTE.VFC#
      3150**DCL      3150--REDEF
FPT$WRTI.V.ONEWKEY#
      3146**DCL      5354<<ASSIGN   5357<<ASSIGN
FUNCT
      5304**DCL      5327<<ASSIGN   5330<<ASSIGN   5351>>DOCASE   5398>>IF       5403>>IF
GLOBAL.ACTIVE.DBCB$
       502**DCL       503--REDEF    5332>>ASSIGN
GLOBAL.ACTIVE.SSS$
       498**DCL       499--REDEF    5333>>ASSIGN
GLOBAL.CLOSE$
       757**DCL      5384>>ASSIGN   5385>>ASSIGN   5386>>CALL     5452>>ASSIGN
GLOBAL.ENQ.SHARE
       622**DCL      5365<<ASSIGN
GLOBAL.ENQ.VALUE.DCB#
       629**DCL      5366<<ASSIGN
GLOBAL.ENQ.VALUE.RNAME
       631**DCL      5372<<ASSIGN
GLOBAL.KEY
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:116  
       706**DCL       709--REDEF
GLOBAL.KEYID.RECID
       736**DCL      5390>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       581**DCL       588--REDEF    5394>>IF
GLOBAL.PARAN.TRACE.RNAME
       575**DCL      5396<<ASSIGN
GLOBAL.PARAN.TRACE.RTYPE
       580**DCL      5395<<ASSIGN
GLOBAL.PARAN.TRACE.TYPE
       579**DCL      5399<<ASSIGN   5401<<ASSIGN   5404<<ASSIGN   5406<<ASSIGN
GLOBAL.PRINTBUF.BUFFER
       740**DCL       741--REDEF     742--REDEF     743--REDEF
GLOBAL.PRINTBUF.ERR.V
       745**DCL       748--REDEF     749--REDEF     750--REDEF
GLOBAL.REOPEN$
       756**DCL      5387>>ASSIGN   5388>>CALL     5456>>ASSIGN
GLOBAL.RET.AC#
       518**DCL      5466<<ASSIGN
GLOBAL.RET.DCB#
       522**DCL      5444<<ASSIGN   5452<<ASSIGN   5456<<ASSIGN
GLOBAL.RET.ERROR#
       516**DCL      5424>>IF       5429<<ASSIGN   5464>>IF       5470<<ASSIGN   5472>>IF
GLOBAL.RET.FR#
       519**DCL      5469<<ASSIGN
GLOBAL.RET.RC#
       521**DCL      5468<<ASSIGN
GLOBAL.RET.SC#
       520**DCL      5467<<ASSIGN
GLOBAL.RET.SYSERR#
       517**DCL      5443<<ASSIGN   5451<<ASSIGN   5455<<ASSIGN
GLOBAL.STATS.CURR.READS
       656**DCL      5392<<ASSIGN   5392>>ASSIGN
GLOBAL.STATS.CURR.WRITES
       657**DCL      5393<<ASSIGN   5393>>ASSIGN
GLOBAL.WRTI$
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:117  
       761**DCL      5354>>ASSIGN   5357>>ASSIGN   5359>>ASSIGN   5360>>ASSIGN   5361>>ASSIGN   5377>>CALL
      5444>>ASSIGN
GLOBAL$
       800**DCL       496--IMP-PTR  5332>>ASSIGN   5333>>ASSIGN   5354>>ASSIGN   5357>>ASSIGN   5359>>ASSIGN
      5360>>ASSIGN   5361>>ASSIGN   5365>>ASSIGN   5366>>ASSIGN   5372>>ASSIGN   5377>>CALL     5384>>ASSIGN
      5385>>ASSIGN   5386>>CALL     5387>>ASSIGN   5388>>CALL     5390>>ASSIGN   5392>>ASSIGN   5392>>ASSIGN
      5393>>ASSIGN   5393>>ASSIGN   5394>>IF       5395>>ASSIGN   5396>>ASSIGN   5399>>ASSIGN   5401>>ASSIGN
      5404>>ASSIGN   5406>>ASSIGN   5424>>IF       5429>>ASSIGN   5443>>ASSIGN   5444>>ASSIGN   5444>>ASSIGN
      5451>>ASSIGN   5452>>ASSIGN   5452>>ASSIGN   5455>>ASSIGN   5456>>ASSIGN   5456>>ASSIGN   5464>>IF
      5466>>ASSIGN   5467>>ASSIGN   5468>>ASSIGN   5469>>ASSIGN   5470>>ASSIGN   5472>>IF
HASH
      5324**DCL      5371<>CALL     5372>>ASSIGN
IXBUF
      5307**DCL      5363<<ASSIGN   5363>>ASSIGN   5371<>CALL
KEYL#
      5326**DCL      5369<<ASSIGN   5371<>CALL
KEYX#
      5325**DCL      5367<<ASSIGN   5371<>CALL
LENGTH
      5306**DCL      5307--IMP-SIZ  5362<<ASSIGN   5363>>ASSIGN   5363>>ASSIGN   5371>>CALL
M$CLOSE
      3052**DCL-ENT  5386--CALL
M$OPEN
      3052**DCL-ENT  5388--CALL
M$WRITE
      3053**DCL-ENT  5377--CALL
RA.PGRNG.IHIGHDBK
      2712**DCL      2713--REDEF
RA$
      2699**DCL      2700--IMP-PTR
RC.DEF.FVR
      2677**DCL      5347>>IF
RC.DEF.RNL
      2684**DCL      2694--IMP-SIZ  5396>>ASSIGN
RC.RNAM
      2694**DCL      5396>>ASSIGN
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:118  
RC.RSIZ
      2689**DCL      5350>>ASSIGN
RC.RTYP
      2691**DCL      5344>>ASSIGN   5395>>ASSIGN
RC$
      2668**DCL      2669--IMP-PTR  5340<<ASSIGN   5344>>ASSIGN   5345>>ASSIGN   5347>>IF       5350>>ASSIGN
      5395>>ASSIGN   5396>>ASSIGN   5396>>ASSIGN
RECVAR.ACPTR
      1968**DCL      5335>>ASSIGN   5346<<ASSIGN
RECVAR.AWS$
      1974**DCL      5343<<ASSIGN
RECVAR.BADDR
      1950**DCL      1953--REDEF
RECVAR.BADDR$
      1953**DCL      5341<<ASSIGN
RECVAR.DBKEY
      1949**DCL      5390<<ASSIGN
RECVAR.RADDR
      1954**DCL      1958--REDEF
RECVAR.RADDR$
      1958**DCL      5342<<ASSIGN   5360>>ASSIGN   5391<<ASSIGN
RECVAR.RCPTR
      1970**DCL      5340>>ASSIGN   5345<<ASSIGN
RECVAR.RECSZ
      1959**DCL      5348<<ASSIGN   5350<<ASSIGN   5361>>ASSIGN   5362>>ASSIGN
RECVAR.RTP.TYPE
      1965**DCL      5344<<ASSIGN
RVT$
      5305**DCL      5334<<ASSIGN   5335>>ASSIGN   5340>>ASSIGN   5341>>ASSIGN   5342>>ASSIGN   5343>>ASSIGN
      5344>>ASSIGN   5345>>ASSIGN   5346>>ASSIGN   5348>>ASSIGN   5350>>ASSIGN   5360>>ASSIGN   5361>>ASSIGN
      5362>>ASSIGN   5390>>ASSIGN   5391>>ASSIGN
SSS$
      2028**DCL      5333<<ASSIGN   5335>>ASSIGN   5340>>ASSIGN   5345>>ASSIGN   5346>>ASSIGN
TEMP
      5311**DCL      5409<<ASSIGN   5411>>ASSIGN   5413<<ASSIGN   5415>>ASSIGN
ZIB$ERR
PL6.E3A0      #003=ZIM$ISTO File=ZIM$INDEXED.:ZIC0TSI                            FRI 09/05/97 12:57 Page:119  
       801**DCL-ENT  5475--CALL
ZIM$DEQ_INDEXED
      5322**DCL-ENT  5380--CALL     5436--CALL
ZIM$DEQ_ONE
      5318**DCL-ENT  5423--CALL
ZIM$ENQM
      5317**DCL-ENT  5373--CALL
ZIM$ENQ_INDEXED
      5321**DCL-ENT  5376--CALL
ZIM$ICURR
      5312**DCL-ENT  5412--CALL
ZIM$IHASH
      5320**DCL-ENT  5371--CALL
ZIM$INDXMAP_ADD
      5319**DCL-ENT  5379--CALL
ZIM$JIMOD
      5314**DCL-ENT  5356--CALL
ZIM$JISTO
      5313**DCL-ENT  5353--CALL
ZIM$TRACE
      5316**DCL-ENT  5407--CALL

PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:120  
      540        1        /*T***********************************************************/
      541        2        /*T*                                                         */
      542        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      543        4        /*T*                                                         */
      544        5        /*T***********************************************************/
      545        6        ZIM$ICURR: PROC
      546        7               AVOID($PR5,$PR6,$PR7);
      547        8        %INCLUDE ZI$GLOBAL;
      548      494            %GLOBALS;
      549      802        %INCLUDE ZI$DBCB;
      550     1444            %DBCB;
      551     1922            %AWS(AWSTYPE=INDEXED);
      552     1962            %RWS;
      553     1982            %SETWS;
      554     2001            %RECVAR;
      555     2035            %CRUNI;
      556     2040        %INCLUDE ZI$SSS;
      557     2589            %AC;
      558     2684            %RC;
      559     2716            %SC;
      560     2743            %SC1;
      561     2753        %INCLUDE CP_6;
      562     2834            %F$DCB;
      563     2891        %INCLUDE CP_6_SUBS;
      564     3431         %INCLUDE FM$FIT;
      565     3652            %FITALTKEYS;
      566     3658    1   DCL LENGTH UBIN(36);
      567     3659    1   DCL IXBUF$ PTR;
      568     3660    1   DCL IXBUF CHAR(LENGTH) BASED(IXBUF$) CALIGNED;
      569     3661    1   DCL RECVAR$ PTR;
      570     3662    1   DCL KEYX# UBIN(18);
      571     3663    1   DCL KEYL# UBIN(18);
      572     3664    1   DCL IS$ PTR SYMREF;
      573     3665    1   DCL B$ROS$ PTR SYMREF;
      574     3666    1   DCL I$FRI UBIN(36) SYMREF;
      575     3667    1   DCL I$FUI UBIN(36) SYMREF;
      576     3668    1   DCL I$FAA UBIN(36) SYMREF;
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:121  
      577     3669    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
      578     3670    1       SSS$=GLOBAL.ACTIVE.SSS$;
      579     3671    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);
      580     3672    1       SC1$=PINCRW(SC$,-SIZEW(SC1));
      581     3673    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVO);
      582     3674    1       IF GLOBAL.FCN.CODE=POFFW(ADDR(I$FRI),IS$) OR
      583     3675    1          GLOBAL.FCN.CODE=POFFW(ADDR(I$FAA),IS$) OR
      584     3676    2          GLOBAL.FCN.CODE=POFFW(ADDR(I$FUI),IS$) THEN DO;
      585     3677    2           SETWS$=PINCRW(DBCB$,SC.SCWSO);
      586     3678    2           SETWS.CURR=RECVAR$->RECVAR.DBKEY;
      587     3679    2           SETWS.PRIV.CSE=%NO#;
      588     3680    2           SETWS.AC=RECVAR$->RECVAR.ACPTR;
      589     3681    2           SETWS.KEY.LENGTH=SC1.KLNG;
      590     3682    2           SETWS.KEY.VALUE=GLOBAL.KEY.VALUE;
      591     3683    2           END;
      592     3684    1       AWS$=RECVAR$->RECVAR.AWS$;
      593     3685    1       KEYX# = PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->FITALTKEYS.K.KEYX(0);
      594     3686    1       KEYL# = PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->FITALTKEYS.K.KEYL(0);
      595     3687    1       LENGTH=DCBADDR(AWS.DDCB)->F$DCB.ARS#;
      596     3688    1       IXBUF$=RECVAR$->RECVAR.RADDR$;
      597     3689    2       IF ~GLOBAL.PARAN.RLCW.A THEN DO;
      598     3690    2           AWS.KEY.LENGTH = KEYL#;
      599     3691    2           AWS.KEY.VALUE=SUBSTR(IXBUF,KEYX#,KEYL#);
      600     3692    2           AWS.ATRIB.CAE=%NO#;
      601     3693    2           AWS.CURR=RECVAR$->RECVAR.DBKEY;
      602     3694    2           END;
      603     3695    2       IF ~GLOBAL.PARAN.RLCW.R THEN DO;
      604     3696    2           RWS$=PINCRW(DBCB$,PINCRW(SSS$,RECVAR$->RECVAR.RCPTR)->RC.RCWSO);
      605     3697    2           RWS.KEY.LENGTH = KEYL#;
      606     3698    2           RWS.KEY.VALUE=SUBSTR(IXBUF,KEYX#,KEYL#);
      607     3699    2           RWS.CURR=RECVAR$->RECVAR.DBKEY;
      608     3700    2           END;
      609     3701    1       DBCB.CRUN.DBK=RECVAR$->RECVAR.DBKEY;
      610     3702    1       PINCRW(DBCB$,DBCB.CSECT.CIWSOF)->CRUNI.LENGTH=KEYL#;
      611     3703    1       PINCRW(DBCB$,DBCB.CSECT.CIWSOF)->CRUNI.VALUE=
      612     3704    1          SUBSTR(IXBUF,KEYX#,KEYL#);
      613     3705    1       RETURN;
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:122  
      614     3706    1   END ZIM$ICURR;
      615     3707        %EOD;

PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:123  
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$ICURR.

   Procedure ZIM$ICURR requires 180 words for executable code.
   Procedure ZIM$ICURR requires 24 words of local(AUTO) storage.

PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:124  

 Object Unit name= ZIM$ICURR                                  File name= ZIM$INDEXED.:ZIC0TOU
 UTS= SEP 05 '97 12:57:45.68 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   180    264  ZIM$ICURR
    2  RoData even  none     6      6  ZIM$ICURR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       0  ZIM$ICURR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  IS$
     B$ROS$                                I$FRI                                 I$FUI
     I$FAA
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:125  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ROSID                                 ISSID
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:126  


      540        1        /*T***********************************************************/
      541        2        /*T*                                                         */
      542        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      543        4        /*T*                                                         */
      544        5        /*T***********************************************************/
      545        6        ZIM$ICURR: PROC

      6  1 000000   000000 700200 xent  ZIM$ICURR    TSX0  ! X66_AUTO_0
         1 000001   000030 000000                    ZERO    24,0

      546        7               AVOID($PR5,$PR6,$PR7);
      547        8        %INCLUDE ZI$GLOBAL;
      548      494            %GLOBALS;
      549      802        %INCLUDE ZI$DBCB;
      550     1444            %DBCB;
      551     1922            %AWS(AWSTYPE=INDEXED);
      552     1962            %RWS;
      553     1982            %SETWS;
      554     2001            %RECVAR;
      555     2035            %CRUNI;
      556     2040        %INCLUDE ZI$SSS;
      557     2589            %AC;
      558     2684            %RC;
      559     2716            %SC;
      560     2743            %SC1;
      561     2753        %INCLUDE CP_6;
      562     2834            %F$DCB;
      563     2891        %INCLUDE CP_6_SUBS;
      564     3431         %INCLUDE FM$FIT;
      565     3652            %FITALTKEYS;
      566     3658    1   DCL LENGTH UBIN(36);
      567     3659    1   DCL IXBUF$ PTR;
      568     3660    1   DCL IXBUF CHAR(LENGTH) BASED(IXBUF$) CALIGNED;
      569     3661    1   DCL RECVAR$ PTR;
      570     3662    1   DCL KEYX# UBIN(18);
      571     3663    1   DCL KEYL# UBIN(18);
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:127  
      572     3664    1   DCL IS$ PTR SYMREF;
      573     3665    1   DCL B$ROS$ PTR SYMREF;
      574     3666    1   DCL I$FRI UBIN(36) SYMREF;
      575     3667    1   DCL I$FUI UBIN(36) SYMREF;
      576     3668    1   DCL I$FAA UBIN(36) SYMREF;
      577     3669    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   3669  1 000002   000000 470400 xsym               LDP0    GLOBAL$
         1 000003   000001 236100                    LDQ     1,,PR0
         1 000004   200003 756100                    STQ     DBCB$,,AUTO

      578     3670    1       SSS$=GLOBAL.ACTIVE.SSS$;

   3670  1 000005   000000 236100                    LDQ     0,,PR0
         1 000006   200007 756100                    STQ     SSS$,,AUTO

      579     3671    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);

   3671  1 000007   200003 471500                    LDP1    DBCB$,,AUTO
         1 000010   100520 220100                    LDX0    336,,PR1
         1 000011   000000 636010                    EAQ     0,X0
         1 000012   200007 036100                    ADLQ    SSS$,,AUTO
         1 000013   200012 756100                    STQ     SC$,,AUTO

      580     3672    1       SC1$=PINCRW(SC$,-SIZEW(SC1));

   3672  1 000014   777776 036003                    ADLQ    -2,DU
         1 000015   200013 756100                    STQ     SC1$,,AUTO

      581     3673    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVO);

   3673  1 000016   100511 221100                    LDX1    329,,PR1
         1 000017   000000 636011                    EAQ     0,X1
         1 000020   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000021   200016 756100                    STQ     RECVAR$,,AUTO

      582     3674    1       IF GLOBAL.FCN.CODE=POFFW(ADDR(I$FRI),IS$) OR
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:128  

   3674  1 000022   000001 236000 2                  LDQ     1
         1 000023   000022 772000                    QRL     18
         1 000024   000000 235000 xsym               LDA     IS$
         1 000025   000022 771000                    ARL     18
         1 000026   200022 755100                    STA     KEYL#+2,,AUTO
         1 000027   200022 136100                    SBLQ    KEYL#+2,,AUTO
         1 000030   200023 756100                    STQ     KEYL#+3,,AUTO
         1 000031   000004 236100                    LDQ     4,,PR0
         1 000032   777777 376007                    ANQ     -1,DL
         1 000033   200023 116100                    CMPQ    KEYL#+3,,AUTO
         1 000034   000057 600000 1                  TZE     s:3677
         1 000035   000002 236000 2                  LDQ     2
         1 000036   000022 772000                    QRL     18
         1 000037   200024 755100                    STA     KEYL#+4,,AUTO
         1 000040   200024 136100                    SBLQ    KEYL#+4,,AUTO
         1 000041   200025 756100                    STQ     KEYL#+5,,AUTO
         1 000042   000004 236100                    LDQ     4,,PR0
         1 000043   777777 376007                    ANQ     -1,DL
         1 000044   200025 116100                    CMPQ    KEYL#+5,,AUTO
         1 000045   000057 600000 1                  TZE     s:3677
         1 000046   000003 236000 2                  LDQ     3
         1 000047   000022 772000                    QRL     18
         1 000050   200026 755100                    STA     KEYL#+6,,AUTO
         1 000051   200026 136100                    SBLQ    KEYL#+6,,AUTO
         1 000052   200027 756100                    STQ     KEYL#+7,,AUTO
         1 000053   000004 236100                    LDQ     4,,PR0
         1 000054   777777 376007                    ANQ     -1,DL
         1 000055   200027 116100                    CMPQ    KEYL#+7,,AUTO
         1 000056   000110 601000 1                  TNZ     s:3684

      583     3675    1          GLOBAL.FCN.CODE=POFFW(ADDR(I$FAA),IS$) OR
      584     3676    2          GLOBAL.FCN.CODE=POFFW(ADDR(I$FUI),IS$) THEN DO;

      585     3677    2           SETWS$=PINCRW(DBCB$,SC.SCWSO);

   3677  1 000057   200012 473500                    LDP3    SC$,,AUTO
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:129  
         1 000060   300001 222100                    LDX2    1,,PR3
         1 000061   000000 636012                    EAQ     0,X2
         1 000062   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000063   200006 756100                    STQ     SETWS$,,AUTO

      586     3678    2           SETWS.CURR=RECVAR$->RECVAR.DBKEY;

   3678  1 000064   200016 474500                    LDP4    RECVAR$,,AUTO
         1 000065   200006 470500                    LDP0    SETWS$,,AUTO
         1 000066   400000 235100                    LDA     0,,PR4
         1 000067   000001 755100                    STA     1,,PR0

      587     3679    2           SETWS.PRIV.CSE=%NO#;

   3679  1 000070   000004 236000 2                  LDQ     4
         1 000071   000000 356100                    ANSQ    0,,PR0

      588     3680    2           SETWS.AC=RECVAR$->RECVAR.ACPTR;

   3680  1 000072   400005 220100                    LDX0    5,,PR4
         1 000073   000000 440100                    SXL0    0,,PR0

      589     3681    2           SETWS.KEY.LENGTH=SC1.KLNG;

   3681  1 000074   200013 471500                    LDP1    SC1$,,AUTO
         1 000075   100000 236100                    LDQ     0,,PR1
         1 000076   000033 736000                    QLS     27
         1 000077   000002 552140                    STBQ    2,'40'O,PR0

      590     3682    2           SETWS.KEY.VALUE=GLOBAL.KEY.VALUE;

   3682  1 000100   000002 236100                    LDQ     2,,PR0
         1 000101   000033 772000                    QRL     27
         1 000102   000000 470400 xsym               LDP0    GLOBAL$
         1 000103   200006 471500                    LDP1    SETWS$,,AUTO
         1 000104   000000 620006                    EAX0    0,QL
         1 000105   040140 100500                    MLR     fill='040'O
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:130  
         1 000106   004624 200377                    ADSC9   2452,,PR0                cn=1,n=255
         1 000107   100002 200010                    ADSC9   2,,PR1                   cn=1,n=*X0

      591     3683    2           END;

      592     3684    1       AWS$=RECVAR$->RECVAR.AWS$;

   3684  1 000110   200016 471500                    LDP1    RECVAR$,,AUTO
         1 000111   100013 236100                    LDQ     11,,PR1
         1 000112   200004 756100                    STQ     AWS$,,AUTO

      593     3685    1       KEYX# = PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->FITALTKEYS.K.KEYX(0);

   3685  1 000113   000005 473400 2                  LDP3    5
         1 000114   300000 474500                    LDP4    0,,PR3
         1 000115   200004 470500                    LDP0    AWS$,,AUTO
         1 000116   000006 220100                    LDX0    6,,PR0
         1 000117   400000 470510                    LDP0    0,X0,PR4
         1 000120   000052 720100                    LXL0    42,,PR0
         1 000121   000000 470400 xsym               LDP0    B$ROS$
         1 000122   000003 721110                    LXL1    3,X0,PR0
         1 000123   200017 741100                    STX1    KEYX#,,AUTO

      594     3686    1       KEYL# = PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX)->FITALTKEYS.K.KEYL(0);

   3686  1 000124   200004 470500                    LDP0    AWS$,,AUTO
         1 000125   000006 220100                    LDX0    6,,PR0
         1 000126   400000 470510                    LDP0    0,X0,PR4
         1 000127   000052 720100                    LXL0    42,,PR0
         1 000130   000000 470400 xsym               LDP0    B$ROS$
         1 000131   000001 236110                    LDQ     1,X0,PR0
         1 000132   000033 772000                    QRL     27
         1 000133   000000 620006                    EAX0    0,QL
         1 000134   200020 740100                    STX0    KEYL#,,AUTO

      595     3687    1       LENGTH=DCBADDR(AWS.DDCB)->F$DCB.ARS#;

PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:131  
   3687  1 000135   200004 470500                    LDP0    AWS$,,AUTO
         1 000136   000006 222100                    LDX2    6,,PR0
         1 000137   400000 470512                    LDP0    0,X2,PR4
         1 000140   000000 235100                    LDA     0,,PR0
         1 000141   200014 755100                    STA     LENGTH,,AUTO

      596     3688    1       IXBUF$=RECVAR$->RECVAR.RADDR$;

   3688  1 000142   100002 236100                    LDQ     2,,PR1
         1 000143   200015 756100                    STQ     IXBUF$,,AUTO

      597     3689    2       IF ~GLOBAL.PARAN.RLCW.A THEN DO;

   3689  1 000144   000000 470400 xsym               LDP0    GLOBAL$
         1 000145   000025 236100                    LDQ     21,,PR0
         1 000146   000022 736000                    QLS     18
         1 000147   400000 376003                    ANQ     -131072,DU
         1 000150   400000 676003                    ERQ     -131072,DU
         1 000151   000175 600000 1                  TZE     s:3695

      598     3690    2           AWS.KEY.LENGTH = KEYL#;

   3690  1 000152   200004 470500                    LDP0    AWS$,,AUTO
         1 000153   200020 236100                    LDQ     KEYL#,,AUTO
         1 000154   000011 736000                    QLS     9
         1 000155   000012 552140                    STBQ    10,'40'O,PR0

      599     3691    2           AWS.KEY.VALUE=SUBSTR(IXBUF,KEYX#,KEYL#);

   3691  1 000156   000012 236100                    LDQ     10,,PR0
         1 000157   000033 772000                    QRL     27
         1 000160   200015 470500                    LDP0    IXBUF$,,AUTO
         1 000161   200017 235100                    LDA     KEYX#,,AUTO
         1 000162   000022 771000                    ARL     18
         1 000163   200004 471500                    LDP1    AWS$,,AUTO
         1 000164   000000 622006                    EAX2    0,QL
         1 000165   040140 100545                    MLR     fill='040'O
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:132  
         1 000166   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         1 000167   100012 200012                    ADSC9   10,,PR1                  cn=1,n=*X2

      600     3692    2           AWS.ATRIB.CAE=%NO#;

   3692  1 000170   000004 236000 2                  LDQ     4
         1 000171   100000 356100                    ANSQ    0,,PR1

      601     3693    2           AWS.CURR=RECVAR$->RECVAR.DBKEY;

   3693  1 000172   200016 470500                    LDP0    RECVAR$,,AUTO
         1 000173   000000 235100                    LDA     0,,PR0
         1 000174   100001 755100                    STA     1,,PR1

      602     3694    2           END;

      603     3695    2       IF ~GLOBAL.PARAN.RLCW.R THEN DO;

   3695  1 000175   000000 470400 xsym               LDP0    GLOBAL$
         1 000176   000025 236100                    LDQ     21,,PR0
         1 000177   000024 736000                    QLS     20
         1 000200   400000 376003                    ANQ     -131072,DU
         1 000201   400000 676003                    ERQ     -131072,DU
         1 000202   000233 600000 1                  TZE     s:3701

      604     3696    2           RWS$=PINCRW(DBCB$,PINCRW(SSS$,RECVAR$->RECVAR.RCPTR)->RC.RCWSO);

   3696  1 000203   200016 471500                    LDP1    RECVAR$,,AUTO
         1 000204   100006 222100                    LDX2    6,,PR1
         1 000205   200007 470500                    LDP0    SSS$,,AUTO
         1 000206   000004 223112                    LDX3    4,X2,PR0
         1 000207   000000 636013                    EAQ     0,X3
         1 000210   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000211   200005 756100                    STQ     RWS$,,AUTO

      605     3697    2           RWS.KEY.LENGTH = KEYL#;

PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:133  
   3697  1 000212   200005 470500                    LDP0    RWS$,,AUTO
         1 000213   200020 236100                    LDQ     KEYL#,,AUTO
         1 000214   000011 736000                    QLS     9
         1 000215   000002 552140                    STBQ    2,'40'O,PR0

      606     3698    2           RWS.KEY.VALUE=SUBSTR(IXBUF,KEYX#,KEYL#);

   3698  1 000216   000002 236100                    LDQ     2,,PR0
         1 000217   000033 772000                    QRL     27
         1 000220   200015 470500                    LDP0    IXBUF$,,AUTO
         1 000221   200017 235100                    LDA     KEYX#,,AUTO
         1 000222   000022 771000                    ARL     18
         1 000223   200005 471500                    LDP1    RWS$,,AUTO
         1 000224   000000 622006                    EAX2    0,QL
         1 000225   040140 100545                    MLR     fill='040'O
         1 000226   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         1 000227   100002 200012                    ADSC9   2,,PR1                   cn=1,n=*X2

      607     3699    2           RWS.CURR=RECVAR$->RECVAR.DBKEY;

   3699  1 000230   200016 470500                    LDP0    RECVAR$,,AUTO
         1 000231   000000 235100                    LDA     0,,PR0
         1 000232   100001 755100                    STA     1,,PR1

      608     3700    2           END;

      609     3701    1       DBCB.CRUN.DBK=RECVAR$->RECVAR.DBKEY;

   3701  1 000233   200016 470500                    LDP0    RECVAR$,,AUTO
         1 000234   200003 471500                    LDP1    DBCB$,,AUTO
         1 000235   000000 235100                    LDA     0,,PR0
         1 000236   101223 755100                    STA     659,,PR1

      610     3702    1       PINCRW(DBCB$,DBCB.CSECT.CIWSOF)->CRUNI.LENGTH=KEYL#;

   3702  1 000237   100014 722100                    LXL2    12,,PR1
         1 000240   200020 236100                    LDQ     KEYL#,,AUTO
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:134  
         1 000241   000011 736000                    QLS     9
         1 000242   100000 676112                    ERQ     0,X2,PR1
         1 000243   777000 376003                    ANQ     -512,DU
         1 000244   100000 656112                    ERSQ    0,X2,PR1

      611     3703    1       PINCRW(DBCB$,DBCB.CSECT.CIWSOF)->CRUNI.VALUE=

   3703  1 000245   100014 722100                    LXL2    12,,PR1
         1 000246   100000 236112                    LDQ     0,X2,PR1
         1 000247   000033 772000                    QRL     27
         1 000250   000000 635012                    EAA     0,X2
         1 000251   000020 771000                    ARL     16
         1 000252   200015 470500                    LDP0    IXBUF$,,AUTO
         1 000253   200022 755100                    STA     KEYL#+2,,AUTO
         1 000254   200017 235100                    LDA     KEYX#,,AUTO
         1 000255   000022 771000                    ARL     18
         1 000256   000000 622006                    EAX2    0,QL
         1 000257   200022 236100                    LDQ     KEYL#+2,,AUTO
         1 000260   040146 100545                    MLR     fill='040'O
         1 000261   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         1 000262   100000 200012                    ADSC9   0,Q,PR1                  cn=1,n=*X2

      612     3704    1          SUBSTR(IXBUF,KEYX#,KEYL#);
      613     3705    1       RETURN;

   3705  1 000263   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 006014   000000 006000   000000 006000   000000 006000    ................
   2     004   377777 777777   000000 006003                                    ........
      614     3706    1   END ZIM$ICURR;
      615     3707        %EOD;

PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:135  
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$ICURR.

   Procedure ZIM$ICURR requires 180 words for executable code.
   Procedure ZIM$ICURR requires 24 words of local(AUTO) storage.
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:136  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:137  
          MINI XREF LISTING

AC.DEF.ANL
      2609**DCL      2680--IMP-SIZ
AC.DEF.FORG
      2596**DCL      2600--REDEF
AC$
      2592**DCL      2593--IMP-PTR
AWS.ATRIB.CAE
      1926**DCL      3692<<ASSIGN
AWS.CURR
      1944**DCL      3693<<ASSIGN
AWS.DDCB
      1949**DCL      3685--ASSIGN   3686--ASSIGN   3687--ASSIGN
AWS.KEY.LENGTH
      1958**DCL      1959--IMP-SIZ  3690<<ASSIGN   3691>>ASSIGN
AWS.KEY.VALUE
      1959**DCL      3691<<ASSIGN
AWS$
      1923**DCL      1924--IMP-PTR  3684<<ASSIGN   3685>>ASSIGN   3686>>ASSIGN   3687>>ASSIGN   3690>>ASSIGN
      3691>>ASSIGN   3691>>ASSIGN   3692>>ASSIGN   3693>>ASSIGN
B$ROS$
      3665**DCL      3685>>ASSIGN   3686>>ASSIGN
CRUNI.LENGTH
      2037**DCL      2038--IMP-SIZ  3702<<ASSIGN   3703>>ASSIGN
CRUNI.VALUE
      2038**DCL      3703<<ASSIGN
DBCB.CRUN.DBK
      1904**DCL      3701<<ASSIGN
DBCB.CSECT.CIWSOF
      1465**DCL      3702>>ASSIGN   3703>>ASSIGN   3703>>ASSIGN
DBCB.IOWS.CFCT
      1874**DCL      1875--REDEF
DBCB.IOWS.DBKF.RQ
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:138  
      1817**DCL      1818--REDEF
DBCB.IOWS.DBKR
      1814**DCL      1815--REDEF
DBCB.IOWS.NOBF
      1876**DCL      1877--REDEF
DBCB.IOWS.SPND
      1802**DCL      1803--REDEF
DBCB.PCB.PRSC
      1663**DCL      3671>>ASSIGN
DBCB.PCB.RVO
      1652**DCL      3673>>ASSIGN
DBCB.SWS.RDYCW
      1540**DCL      1541--REDEF
DBCB.SWS.TEMP.PTR1$
      1574**DCL      1575--REDEF    1576--REDEF
DBCB.SWS.TEMP.PTR2$
      1577**DCL      1578--REDEF
DBCB$
      1445**DCL      1446--IMP-PTR  3669<<ASSIGN   3671>>ASSIGN   3673>>ASSIGN   3673>>ASSIGN   3677>>ASSIGN
      3696>>ASSIGN   3701>>ASSIGN   3702>>ASSIGN   3702>>ASSIGN   3703>>ASSIGN   3703>>ASSIGN   3703>>ASSIGN
      3703>>ASSIGN
F$DCB.ACTPOS
      2867**DCL      2867--REDEF
F$DCB.ALTKEYX
      2866**DCL      3685>>ASSIGN   3686>>ASSIGN
F$DCB.ARS#
      2841**DCL      2841--REDEF    3687>>ASSIGN
F$DCB.ATTR
      2860**DCL      2861--REDEF
F$DCB.BORROW
      2875**DCL      2875--REDEF    2875--REDEF    2875--REDEF
F$DCB.DCBNAME.L
      2889**DCL      2889--IMP-SIZ
F$DCB.EOMCHAR#
      2845**DCL      2845--REDEF
F$DCB.FLDID
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:139  
      2870**DCL      2870--REDEF
F$DCB.FORM$
      2864**DCL      2864--REDEF
F$DCB.FSECT
      2880**DCL      2880--REDEF
F$DCB.FSN#
      2857**DCL      2857--REDEF    2857--REDEF    2858--REDEF
F$DCB.HEADER$
      2863**DCL      2863--REDEF
F$DCB.IXTNSIZE#
      2861**DCL      2861--REDEF
F$DCB.LASTSTA$
      2850**DCL      2850--REDEF
F$DCB.LVL
      2876**DCL      2876--REDEF
F$DCB.NAME#.C
      2851**DCL      2851--REDEF
F$DCB.NOEOF
      2873**DCL      2873--REDEF
F$DCB.NRECS#
      2862**DCL      2862--REDEF
F$DCB.NRECX
      2881**DCL      2881--REDEF
F$DCB.OHDR
      2873**DCL      2873--REDEF
F$DCB.ORG#
      2856**DCL      2856--REDEF
F$DCB.PRECNO
      2879**DCL      2879--REDEF
F$DCB.RCSZ
      2885**DCL      2885--REDEF
F$DCB.RES#
      2852**DCL      2852--REDEF
F$DCB.SETX
      2864**DCL      2864--REDEF
F$DCB.TAB$
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:140  
      2864**DCL      2864--REDEF
F$DCB.TDA
      2878**DCL      2879--REDEF
F$DCB.WSN#
      2852**DCL      2852--REDEF
FITALTKEYS.K.KEYL
      3654**DCL      3686>>ASSIGN
FITALTKEYS.K.KEYX
      3654**DCL      3685>>ASSIGN
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF    3669>>ASSIGN
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF    3670>>ASSIGN
GLOBAL.FCN.CODE
       510**DCL      3674>>IF       3674>>IF       3674>>IF
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.KEY.VALUE
       707**DCL      3682>>ASSIGN
GLOBAL.PARAN.RLCW.A
       552**DCL      3689>>IF
GLOBAL.PARAN.RLCW.R
       554**DCL      3695>>IF
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL$
       799**DCL       495--IMP-PTR  3669>>ASSIGN   3670>>ASSIGN   3674>>IF       3674>>IF       3674>>IF
      3682>>ASSIGN   3689>>IF       3695>>IF
I$FAA
      3668**DCL      3674--IF
I$FRI
      3666**DCL      3674--IF
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:141  
I$FUI
      3667**DCL      3674--IF
IS$
      3664**DCL      3674>>IF       3674>>IF       3674>>IF
IXBUF
      3660**DCL      3691>>ASSIGN   3698>>ASSIGN   3703>>ASSIGN
IXBUF$
      3659**DCL      3660--IMP-PTR  3688<<ASSIGN   3691>>ASSIGN   3698>>ASSIGN   3703>>ASSIGN
KEYL#
      3663**DCL      3686<<ASSIGN   3690>>ASSIGN   3691>>ASSIGN   3697>>ASSIGN   3698>>ASSIGN   3702>>ASSIGN
      3703>>ASSIGN
KEYX#
      3662**DCL      3685<<ASSIGN   3691>>ASSIGN   3698>>ASSIGN   3703>>ASSIGN
LENGTH
      3658**DCL      3660--IMP-SIZ  3687<<ASSIGN   3691>>ASSIGN   3698>>ASSIGN   3703>>ASSIGN
RC.DEF.RNL
      2703**DCL      2713--IMP-SIZ
RC.RCWSO
      2711**DCL      3696>>ASSIGN
RC$
      2687**DCL      2688--IMP-PTR
RECVAR.ACPTR
      2022**DCL      3680>>ASSIGN
RECVAR.AWS$
      2028**DCL      3684>>ASSIGN
RECVAR.BADDR
      2004**DCL      2007--REDEF
RECVAR.DBKEY
      2003**DCL      3678>>ASSIGN   3693>>ASSIGN   3699>>ASSIGN   3701>>ASSIGN
RECVAR.RADDR
      2008**DCL      2012--REDEF
RECVAR.RADDR$
      2012**DCL      3688>>ASSIGN
RECVAR.RCPTR
      2024**DCL      3696>>ASSIGN
RECVAR$
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:142  
      3661**DCL      3673<<ASSIGN   3678>>ASSIGN   3680>>ASSIGN   3684>>ASSIGN   3688>>ASSIGN   3693>>ASSIGN
      3696>>ASSIGN   3699>>ASSIGN   3701>>ASSIGN
RWS.CURR
      1976**DCL      3699<<ASSIGN
RWS.KEY.LENGTH
      1978**DCL      1979--IMP-SIZ  3697<<ASSIGN   3698>>ASSIGN
RWS.KEY.VALUE
      1979**DCL      3698<<ASSIGN
RWS$
      1963**DCL      1964--IMP-PTR  3696<<ASSIGN   3697>>ASSIGN   3698>>ASSIGN   3698>>ASSIGN   3699>>ASSIGN
SC.DEF.SNL
      2732**DCL      2737--IMP-SIZ
SC.SCWSO
      2733**DCL      3677>>ASSIGN
SC$
      2719**DCL      2720--IMP-PTR  3671<<ASSIGN   3672>>ASSIGN   3677>>ASSIGN
SC1
      2746**DCL      3672--ASSIGN
SC1.KLNG
      2748**DCL      3681>>ASSIGN
SC1$
      2745**DCL      2746--IMP-PTR  3672<<ASSIGN   3681>>ASSIGN
SETWS.AC
      1994**DCL      3680<<ASSIGN
SETWS.CURR
      1995**DCL      3678<<ASSIGN
SETWS.KEY.LENGTH
      1997**DCL      1998--IMP-SIZ  3681<<ASSIGN   3682>>ASSIGN
SETWS.KEY.VALUE
      1998**DCL      3682<<ASSIGN
SETWS.PRIV.CSE
      1986**DCL      3679<<ASSIGN
SETWS$
      1983**DCL      1984--IMP-PTR  3677<<ASSIGN   3678>>ASSIGN   3679>>ASSIGN   3680>>ASSIGN   3681>>ASSIGN
      3682>>ASSIGN   3682>>ASSIGN
SSS$
PL6.E3A0      #004=ZIM$ICURR File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:143  
      2047**DCL      3670<<ASSIGN   3671>>ASSIGN   3696>>ASSIGN

PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:144  
      616        1        /*T***********************************************************/
      617        2        /*T*                                                         */
      618        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      619        4        /*T*                                                         */
      620        5        /*T***********************************************************/
      621        6        ZIM$IHASH: PROC(CHARACTERS,START,LEN,HASH)
      622        7               AVOID($PR5,$PR6,$PR7);
      623        8    1   DCL CHARACTERS(0:0) CHAR(1) CALIGNED;
      624        9    1   DCL START UBIN;
      625       10    1   DCL LEN UBIN;
      626       11    1   DCL HASH UBIN;
      627       12
      628       13    1   DCL I UBIN;
      629       14    1   DCL SUM UBIN;
      630       15
      631       16    1       SUM=0;
      632       17    2       DO I=START TO LEN-1;
      633       18    2           SUM=SUM+ASCBIN(CHARACTERS(I));
      634       19    2           END;
      635       20    1       HASH=SUM;
      636       21    1       RETURN;
      637       22    1   END ZIM$IHASH;
      638       23        %EOD;

PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:145  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIM$IHASH.

   Procedure ZIM$IHASH requires 25 words for executable code.
   Procedure ZIM$IHASH requires 12 words of local(AUTO) storage.

PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:146  

 Object Unit name= ZIM$IHASH                                  File name= ZIM$INDEXED.:ZIC0TOU
 UTS= SEP 05 '97 12:57:58.52 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    25     31  ZIM$IHASH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      XStd       4  ZIM$IHASH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:147  


      616        1        /*T***********************************************************/
      617        2        /*T*                                                         */
      618        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      619        4        /*T*                                                         */
      620        5        /*T***********************************************************/
      621        6        ZIM$IHASH: PROC(CHARACTERS,START,LEN,HASH)

      6  0 000000   000000 700200 xent  ZIM$IHASH    TSX0  ! X66_AUTO_4
         0 000001   000014 000004                    ZERO    12,4

      622        7               AVOID($PR5,$PR6,$PR7);
      623        8    1   DCL CHARACTERS(0:0) CHAR(1) CALIGNED;
      624        9    1   DCL START UBIN;
      625       10    1   DCL LEN UBIN;
      626       11    1   DCL HASH UBIN;
      627       12
      628       13    1   DCL I UBIN;
      629       14    1   DCL SUM UBIN;
      630       15
      631       16    1       SUM=0;

     16  0 000002   200010 450100                    STZ     SUM,,AUTO

      632       17    2       DO I=START TO LEN-1;

     17  0 000003   200004 470500                    LDP0    @START,,AUTO
         0 000004   000000 235100                    LDA     0,,PR0
         0 000005   200007 755100                    STA     I,,AUTO
         0 000006   000021 710000 0                  TRA     s:19+2

      633       18    2           SUM=SUM+ASCBIN(CHARACTERS(I));

     18  0 000007   200003 470500                    LDP0    @CHARACTERS,,AUTO
         0 000010   200007 235100                    LDA     I,,AUTO
         0 000011   000100 101505                    MRL     fill='000'O
         0 000012   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:148  
         0 000013   200012 000004                    ADSC9   SUM+2,,AUTO              cn=0,n=4
         0 000014   200012 236100                    LDQ     SUM+2,,AUTO
         0 000015   200010 036100                    ADLQ    SUM,,AUTO
         0 000016   200010 756100                    STQ     SUM,,AUTO

      634       19    2           END;

     19  0 000017   000001 035007                    ADLA    1,DL
         0 000020   200007 755100                    STA     I,,AUTO
         0 000021   200005 470500                    LDP0    @LEN,,AUTO
         0 000022   200007 236100                    LDQ     I,,AUTO
         0 000023   000000 116100                    CMPQ    0,,PR0
         0 000024   000007 602000 0                  TNC     s:18

      635       20    1       HASH=SUM;

     20  0 000025   200006 471500                    LDP1    @HASH,,AUTO
         0 000026   200010 235100                    LDA     SUM,,AUTO
         0 000027   100000 755100                    STA     0,,PR1

      636       21    1       RETURN;

     21  0 000030   000000 702200 xent               TSX2  ! X66_ARET
      637       22    1   END ZIM$IHASH;
      638       23        %EOD;

PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:149  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIM$IHASH.

   Procedure ZIM$IHASH requires 25 words for executable code.
   Procedure ZIM$IHASH requires 12 words of local(AUTO) storage.
PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:150  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ZIM$IHASH File=ZIM$INDEXED.:ZIC0TSI                           FRI 09/05/97 12:57 Page:151  
          MINI XREF LISTING

CHARACTERS
         8**DCL         6--PROC       18>>ASSIGN
HASH
        11**DCL         6--PROC       20<<ASSIGN
I
        13**DCL        17<<DOINDEX    18>>ASSIGN
LEN
        10**DCL         6--PROC       17>>DOINDEX
START
         9**DCL         6--PROC       17>>DOINDEX
SUM
        14**DCL        16<<ASSIGN     18<<ASSIGN     18>>ASSIGN     20>>ASSIGN

PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:152  
      639        1        /*T***********************************************************/
      640        2        /*T*                                                         */
      641        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      642        4        /*T*                                                         */
      643        5        /*T***********************************************************/
      644        6        ZIM$ENQ_INDEXED: PROC(DUMMY) ALTRET
      645        7               AVOID($PR5,$PR6,$PR7);
      646        8        %INCLUDE CP_6;
      647       89            %FPT_ENQ(FPTN=FPT$ENQI,STCLASS=BASED);
      648      107            %FPT_DEQ(FPTN=FPT$DEQI,STCLASS=BASED);
      649      124            %FPT_WAIT(FPTN=FPT_WAIT,STCLASS=SYMREF);
      650      138            %B$TCB;
      651      141            %B$ALT;
      652      149        %INCLUDE B_ERRORS_C;
      653     1276        %INCLUDE ZI$GLOBAL;
      654     1762        %GLOBALS;
      655     2070        %INCLUDE ZI$DBCB;
      656     2712        %AWS;
      657     2752        %INCLUDE ZI_ERRORS_C;
      658     3078    1   DCL B$TCB$ PTR SYMREF;
      659     3079    1   DCL DUMMY UBIN;
      660     3080    1   DCL ERROR UBIN;
      661     3081
      662     3082    1       AWS$=ADDR(DUMMY);
      663     3083    1       GLOBAL.ENQI$->FPT$ENQI.V.DCB#=AWS.DDCB;
      664     3084    1   RETRY: ;
      665     3085    1       CALL M$ENQ(GLOBAL.ENQI$->FPT$ENQI)
      666     3086    2       WHENALTRETURN DO;
      667     3087    3           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$DLOCK THEN DO;
      668     3088    4               CALL M$WAIT(FPT_WAIT) WHENALTRETURN DO; END;
      669     3089    3               GOTO RETRY;
      670     3090    3               END;
      671     3091    2           ELSE
      672     3092    3               IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$ENQ_LIMIT THEN DO;
      673     3093    3                   GLOBAL.RET.ERROR#=ERR#IO#MAXENQ;
      674     3094    3                   GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      675     3095    3                   CALL M$ERR;
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:153  
      676     3096    3                   END;
      677     3097    3               ELSE DO;
      678     3098    3                   ERROR=ERR#IO#CAC;
      679     3099    3                   GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      680     3100    3                   GLOBAL.RET.DCB#=AWS.DDCB;
      681     3101    3                   GOTO ALT;
      682     3102    3                   END;
      683     3103    2           END;
      684     3104    1       GOTO RET;
      685     3105
      686     3106    1   ZIM$DEQ_INDEXED: ENTRY(DUMMY) ALTRET;
      687     3107    1       AWS$=ADDR(DUMMY);
      688     3108
      689     3109    1       GLOBAL.DEQI$->FPT$DEQI.V.DCB#=AWS.DDCB;
      690     3110    1       CALL M$DEQ(GLOBAL.DEQI$->FPT$DEQI)
      691     3111    2       WHENALTRETURN DO;
      692     3112    2           ERROR=ERR#IO#CAC;
      693     3113    2           GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      694     3114    2           GLOBAL.RET.DCB#=AWS.DDCB;
      695     3115    2           GOTO ALT;
      696     3116    2           END;
      697     3117    1   RET: RETURN;
      698     3118    1   ALT: ;
      699     3119            %DBALT;
      700     3133    1       RETURN;
      701     3134    1   END ZIM$ENQ_INDEXED;

PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:154  
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$ENQ_INDEXED.

   Procedure ZIM$ENQ_INDEXED requires 91 words for executable code.
   Procedure ZIM$ENQ_INDEXED requires 6 words of local(AUTO) storage.

    No errors detected in file ZIM$INDEXED.:ZIC0TSI    .

PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:155  

 Object Unit name= ZIM$ENQ_INDEXED                            File name= ZIM$INDEXED.:ZIC0TOU
 UTS= SEP 05 '97 12:57:59.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none    91    133  ZIM$ENQ_INDEXED
    2  RoData even  none     1      1  ZIM$ENQ_INDEXED

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       1  ZIM$ENQ_INDEXED
     1     61          yes     yes      XStd       1  ZIM$DEQ_INDEXED

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIB$ERR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  FPT_WAIT                         r    GLOBAL$
     B$TCB$
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:156  


      639        1        /*T***********************************************************/
      640        2        /*T*                                                         */
      641        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      642        4        /*T*                                                         */
      643        5        /*T***********************************************************/
      644        6        ZIM$ENQ_INDEXED: PROC(DUMMY) ALTRET

      6  1 000000   000000 700200 xent  ZIM$ENQ_IND* TSX0  ! X66_AUTO_1
         1 000001   000006 000001                    ZERO    6,1

      645        7               AVOID($PR5,$PR6,$PR7);
      646        8        %INCLUDE CP_6;
      647       89            %FPT_ENQ(FPTN=FPT$ENQI,STCLASS=BASED);
      648      107            %FPT_DEQ(FPTN=FPT$DEQI,STCLASS=BASED);
      649      124            %FPT_WAIT(FPTN=FPT_WAIT,STCLASS=SYMREF);
      650      138            %B$TCB;
      651      141            %B$ALT;
      652      149        %INCLUDE B_ERRORS_C;
      653     1276        %INCLUDE ZI$GLOBAL;
      654     1762        %GLOBALS;
      655     2070        %INCLUDE ZI$DBCB;
      656     2712        %AWS;
      657     2752        %INCLUDE ZI_ERRORS_C;
      658     3078    1   DCL B$TCB$ PTR SYMREF;
      659     3079    1   DCL DUMMY UBIN;
      660     3080    1   DCL ERROR UBIN;
      661     3081
      662     3082    1       AWS$=ADDR(DUMMY);

   3082  1 000002   200003 236100                    LDQ     @DUMMY,,AUTO
         1 000003   200004 756100                    STQ     AWS$,,AUTO

      663     3083    1       GLOBAL.ENQI$->FPT$ENQI.V.DCB#=AWS.DDCB;

   3083  1 000004   000000 470400 xsym               LDP0    GLOBAL$
         1 000005   005136 471500                    LDP1    2654,,PR0
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:157  
         1 000006   200004 473500                    LDP3    AWS$,,AUTO
         1 000007   300006 220100                    LDX0    6,,PR3
         1 000010   100006 740100                    STX0    6,,PR1

   3083  1 000011                       RETRY        null
      664     3084    1   RETRY: ;
      665     3085    1       CALL M$ENQ(GLOBAL.ENQI$->FPT$ENQI)

   3085  1 000011   000000 470400 xsym               LDP0    GLOBAL$
         1 000012   005136 471500                    LDP1    2654,,PR0
         1 000013   100000 630500                    EPPR0   0,,PR1
         1 000014   420002 713400                    CLIMB   alt,+8194
         1 000015   401000 401760                    pmme    nvectors=3
         1 000016   000020 702000 1                  TSX2    s:3087
         1 000017   000060 710000 1                  TRA     s:3104

      666     3086    2       WHENALTRETURN DO;

      667     3087    3           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$DLOCK THEN DO;

   3087  1 000020   000000 470400 xsym               LDP0    B$TCB$
         1 000021   000000 471500                    LDP1    0,,PR0
         1 000022   100102 236100                    LDQ     66,,PR1
         1 000023   377770 376007                    ANQ     131064,DL
         1 000024   014410 116007                    CMPQ    6408,DL
         1 000025   000034 601000 1                  TNZ     s:3092

      668     3088    4               CALL M$WAIT(FPT_WAIT) WHENALTRETURN DO; END;

   3088  1 000026   000000 630400 xsym               EPPR0   FPT_WAIT
         1 000027   420006 713400                    CLIMB   alt,+8198
         1 000030   400400 401760                    pmme    nvectors=2
         1 000031   000033 702000 1                  TSX2    s:3089
         1 000032   000033 710000 1                  TRA     s:3089

      669     3089    3               GOTO RETRY;

PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:158  
   3089  1 000033   000011 710000 1                  TRA     RETRY

      670     3090    3               END;
      671     3091    2           ELSE
      672     3092    3               IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$ENQ_LIMIT THEN DO;

   3092  1 000034   014540 116007                    CMPQ    6496,DL
         1 000035   000047 601000 1                  TNZ     s:3098

      673     3093    3                   GLOBAL.RET.ERROR#=ERR#IO#MAXENQ;

   3093  1 000036   210763 235007                    LDA     70131,DL
         1 000037   000000 473400 xsym               LDP3    GLOBAL$
         1 000040   300006 755100                    STA     6,,PR3

      674     3094    3                   GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3094  1 000041   000000 471500                    LDP1    0,,PR0
         1 000042   100102 236100                    LDQ     66,,PR1
         1 000043   300007 756100                    STQ     7,,PR3

      675     3095    3                   CALL M$ERR;

   3095  1 000044   000002 713400                    CLIMB   err
         1 000045   000000 401760                    pmme    nvectors=0

      676     3096    3                   END;

   3096  1 000046   000060 710000 1                  TRA     s:3104

      677     3097    3               ELSE DO;

      678     3098    3                   ERROR=ERR#IO#CAC;

   3098  1 000047   303375 235007                    LDA     100093,DL
         1 000050   200005 755100                    STA     ERROR,,AUTO

PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:159  
      679     3099    3                   GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3099  1 000051   100102 236100                    LDQ     66,,PR1
         1 000052   000000 473400 xsym               LDP3    GLOBAL$
         1 000053   300007 756100                    STQ     7,,PR3

      680     3100    3                   GLOBAL.RET.DCB#=AWS.DDCB;

   3100  1 000054   200004 471500                    LDP1    AWS$,,AUTO
         1 000055   100006 220100                    LDX0    6,,PR1
         1 000056   300014 740100                    STX0    12,,PR3

      681     3101    3                   GOTO ALT;

   3101  1 000057   000114 710000 1                  TRA     ALT

      682     3102    3                   END;
      683     3103    2           END;
      684     3104    1       GOTO RET;

   3104  1 000060   000113 710000 1                  TRA     RET

      685     3105
      686     3106    1   ZIM$DEQ_INDEXED: ENTRY(DUMMY) ALTRET;

   3106  1 000061   000000 700200 xent  ZIM$DEQ_IND* TSX0  ! X66_AUTO_1
         1 000062   000006 000001                    ZERO    6,1

      687     3107    1       AWS$=ADDR(DUMMY);

   3107  1 000063   200003 236100                    LDQ     @DUMMY,,AUTO
         1 000064   200004 756100                    STQ     AWS$,,AUTO

      688     3108
      689     3109    1       GLOBAL.DEQI$->FPT$DEQI.V.DCB#=AWS.DDCB;

   3109  1 000065   000000 470400 xsym               LDP0    GLOBAL$
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:160  
         1 000066   005135 471500                    LDP1    2653,,PR0
         1 000067   200004 473500                    LDP3    AWS$,,AUTO
         1 000070   300006 220100                    LDX0    6,,PR3
         1 000071   100006 740100                    STX0    6,,PR1

      690     3110    1       CALL M$DEQ(GLOBAL.DEQI$->FPT$DEQI)

   3110  1 000072   005135 471500                    LDP1    2653,,PR0
         1 000073   100000 630500                    EPPR0   0,,PR1
         1 000074   420003 713400                    CLIMB   alt,+8195
         1 000075   401000 401760                    pmme    nvectors=3
         1 000076   000100 702000 1                  TSX2    s:3112
         1 000077   000113 710000 1                  TRA     RET

      691     3111    2       WHENALTRETURN DO;

      692     3112    2           ERROR=ERR#IO#CAC;

   3112  1 000100   303375 235007                    LDA     100093,DL
         1 000101   200005 755100                    STA     ERROR,,AUTO

      693     3113    2           GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3113  1 000102   000000 470400 xsym               LDP0    B$TCB$
         1 000103   000000 471500                    LDP1    0,,PR0
         1 000104   100102 236100                    LDQ     66,,PR1
         1 000105   000000 473400 xsym               LDP3    GLOBAL$
         1 000106   300007 756100                    STQ     7,,PR3

      694     3114    2           GLOBAL.RET.DCB#=AWS.DDCB;

   3114  1 000107   200004 471500                    LDP1    AWS$,,AUTO
         1 000110   100006 220100                    LDX0    6,,PR1
         1 000111   300014 740100                    STX0    12,,PR3

      695     3115    2           GOTO ALT;

PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:161  
   3115  1 000112   000114 710000 1                  TRA     ALT

      696     3116    2           END;
      697     3117    1   RET: RETURN;

   3117  1 000113   000000 702200 xent  RET          TSX2  ! X66_ARET

   3117  1 000114                       ALT          null
      698     3118    1   ALT: ;
      699     3119            %DBALT;

   3120  1 000114   300006 235100                    LDA     6,,PR3
         1 000115   000124 601000 1                  TNZ     s:3128

   3122  1 000116   300010 450100                    STZ     8,,PR3

   3123  1 000117   300012 450100                    STZ     10,,PR3

   3124  1 000120   300013 450100                    STZ     11,,PR3

   3125  1 000121   300011 450100                    STZ     9,,PR3

   3126  1 000122   200005 235100                    LDA     ERROR,,AUTO
         1 000123   300006 755100                    STA     6,,PR3

   3128  1 000124   303240 115007                    CMPA    100000,DL
         1 000125   000127 603000 1                  TRC     s:3131

   3129  1 000126   000000 702200 xent               TSX2  ! X66_AALT

   3131  1 000127   000000 631400 2                  EPPR1   0
         1 000130   000000 701000 xent               TSX1    ZIB$ERR
         1 000131   000000 011000                    NOP     0

      700     3133    1       RETURN;

   3133  1 000132   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:162  

(unnamed)
 Sect OctLoc
   2     000   000000 000000                                                    ....
      701     3134    1   END ZIM$ENQ_INDEXED;

PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:163  
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$ENQ_INDEXED.

   Procedure ZIM$ENQ_INDEXED requires 91 words for executable code.
   Procedure ZIM$ENQ_INDEXED requires 6 words of local(AUTO) storage.

    No errors detected in file ZIM$INDEXED.:ZIC0TSI    .
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:164  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:165  
          MINI XREF LISTING

ALT
      3117**LABEL    3101--GOTO     3115--GOTO
AWS.DDCB
      2739**DCL      3083>>ASSIGN   3100>>ASSIGN   3109>>ASSIGN   3114>>ASSIGN
AWS$
      2713**DCL      2714--IMP-PTR  3082<<ASSIGN   3083>>ASSIGN   3100>>ASSIGN   3107<<ASSIGN   3109>>ASSIGN
      3114>>ASSIGN
B$ALT.CODE
       143**DCL       143--REDEF     144--REDEF     144--REDEF
B$ALT.ERR
       144**DCL      3094>>ASSIGN   3099>>ASSIGN   3113>>ASSIGN
B$ALT.ERR.ERR#
       145**DCL       145--REDEF    3087>>IF       3092>>IF
B$ALT.EVID
       144**DCL       144--REDEF     144--REDEF
B$TCB.ALT$
       139**DCL      3087>>IF       3092>>IF       3094>>ASSIGN   3099>>ASSIGN   3113>>ASSIGN
B$TCB$
      3078**DCL      3087>>IF       3092>>IF       3094>>ASSIGN   3099>>ASSIGN   3113>>ASSIGN
DUMMY
      3079**DCL         6--PROC     3082--ASSIGN   3106--ENTRY    3107--ASSIGN
ERROR
      3080**DCL      3098<<ASSIGN   3112<<ASSIGN   3126>>ASSIGN
FPT$DEQI
       118**DCL      3110<>CALL
FPT$DEQI.V.DCB#
       119**DCL      3109<<ASSIGN
FPT$ENQI
       100**DCL      3085<>CALL
FPT$ENQI.V.DCB#
       101**DCL      3083<<ASSIGN
FPT_WAIT
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:166  
       135**DCL      3088<>CALL
GLOBAL.ACTIVE.DBCB$
      1769**DCL      1770--REDEF
GLOBAL.ACTIVE.SSS$
      1765**DCL      1766--REDEF
GLOBAL.DEQI$
      2059**DCL      3109>>ASSIGN   3110>>CALL
GLOBAL.ENQI$
      2060**DCL      3083>>ASSIGN   3085>>CALL
GLOBAL.KEY
      1973**DCL      1976--REDEF
GLOBAL.PARAN.TRACE.MODE
      1848**DCL      1855--REDEF
GLOBAL.PRINTBUF.BUFFER
      2007**DCL      2008--REDEF    2009--REDEF    2010--REDEF
GLOBAL.PRINTBUF.ERR.V
      2012**DCL      2015--REDEF    2016--REDEF    2017--REDEF
GLOBAL.RET.AC#
      1785**DCL      3122<<ASSIGN
GLOBAL.RET.DCB#
      1789**DCL      3100<<ASSIGN   3114<<ASSIGN
GLOBAL.RET.ERROR#
      1783**DCL      3093<<ASSIGN   3120>>IF       3126<<ASSIGN   3128>>IF
GLOBAL.RET.FR#
      1786**DCL      3125<<ASSIGN
GLOBAL.RET.RC#
      1788**DCL      3124<<ASSIGN
GLOBAL.RET.SC#
      1787**DCL      3123<<ASSIGN
GLOBAL.RET.SYSERR#
      1784**DCL      3094<<ASSIGN   3099<<ASSIGN   3113<<ASSIGN
GLOBAL$
      2067**DCL      1763--IMP-PTR  3083>>ASSIGN   3085>>CALL     3093>>ASSIGN   3094>>ASSIGN   3099>>ASSIGN
      3100>>ASSIGN   3109>>ASSIGN   3110>>CALL     3113>>ASSIGN   3114>>ASSIGN   3120>>IF       3122>>ASSIGN
      3123>>ASSIGN   3124>>ASSIGN   3125>>ASSIGN   3126>>ASSIGN   3128>>IF
M$DEQ
PL6.E3A0      #006=ZIM$ENQ_INDEXED File=ZIM$INDEXED.:ZIC0TSI                     FRI 09/05/97 12:57 Page:167  
        84**DCL-ENT  3110--CALL
M$ENQ
        83**DCL-ENT  3085--CALL
M$ERR
        29**DCL-ENT  3095--CALL
M$WAIT
        75**DCL-ENT  3088--CALL
RET
      3117**LABEL    3104--GOTO
RETRY
      3083**LABEL    3089--GOTO
ZIB$ERR
      2068**DCL-ENT  3131--CALL
