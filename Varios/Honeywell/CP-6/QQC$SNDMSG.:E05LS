VERSION E05

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:1    
        1        1        /*M* QQC$SNDMSG - Transmit a message */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQC$SNDMSG:
        9        9                PROC(P_MSGBLK);
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QQ_MACROS_C;
       16      575        %INCLUDE QQ_DATA_R;
       17      821        %INCLUDE QQ_SUBS_C;
       18     1013        %INCLUDE OC_MESSHD_C;
       19     1066        %INCLUDE OC_SUBS_C;
       20     1797        %INCLUDE EL$TABLES;
       21     2120        %INCLUDE EL_SUBS_C;
       22     2204        %INCLUDE B_ERRORS_C;
       23     3331        %INCLUDE Q_ERRCODE_C;
       24     3354        %INCLUDE QQ_PERR_C;
       25     3515        %PAGE(ARG="Parameters");

              3532    1   /***************************************************************************
              3533    1    *                                                                         *
              3534    1    *                                 Parameters                              *
              3535    1    *                                                                         *
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:2    
              3536    1    ***************************************************************************/

       26     3540        %MSGBLK(FPTN="P_MSGBLK");
       27     3630        %PAGE(ARG="Externaly defined routines");

              3647    1   /***************************************************************************
              3648    1    *                                                                         *
              3649    1    *                         Externaly defined routines                      *
              3650    1    *                                                                         *
              3651    1    ***************************************************************************/

       28     3655    1   DCL QQC$FINDSTA ENTRY(3);
       29     3656    1   DCL QQC$BLDMSG ENTRY(1);
       30     3657    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       31     3658    1   DCL QQC$SCREECH ENTRY;
       32     3659    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       33     3660    1   DCL QQC$STOPTP ENTRY(1);
       34     3661        %PAGE(ARG="Symrefs");

              3678    1   /***************************************************************************
              3679    1    *                                                                         *
              3680    1    *                                  Symrefs                                *
              3681    1    *                                                                         *
              3682    1    ***************************************************************************/

       35     3686    1   DCL B$TCB$ PTR SYMREF;
       36     3687        %PAGE(ARG="DCBs");

              3704    1   /***************************************************************************
              3705    1    *                                                                         *
              3706    1    *                                    DCBs                                 *
              3707    1    *                                                                         *
              3708    1    ***************************************************************************/

       37     3712    1   DCL M$CG DCB;
       38     3713    1   DCL M$DO DCB;
       39     3714    1   DCL M$CSCG DCB;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:3    
       40     3715        %PAGE(ARG="Based");

              3732    1   /***************************************************************************
              3733    1    *                                                                         *
              3734    1    *                                   Based                                 *
              3735    1    *                                                                         *
              3736    1    ***************************************************************************/

       41     3740        %PAGE(ARG="Constant");

              3757    1   /***************************************************************************
              3758    1    *                                                                         *
              3759    1    *                                  Constant                               *
              3760    1    *                                                                         *
              3761    1    ***************************************************************************/

       42     3765        %FPT_WRSYSLOG(FPTN=FPT_WRSYSLOG, TYPE=EL_DODCB, STCLASS=CONSTANT);
       43     3780    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       44     3781
       45     3782        %B$TCB;
       46     3785        %B$ALT;
       47     3793        %TP$STATION;
       48     3866        %VLP_ERRCODE(FPTN=ERR,STCLASS=BASED);
       49     3911        %PAGE(ARG="Static");

              3928    1   /***************************************************************************
              3929    1    *                                                                         *
              3930    1    *                                   Static                                *
              3931    1    *                                                                         *
              3932    1    ***************************************************************************/

       50     3936        %OC_MESSHD_D(NAME=HDR_TO_MCT, STCLASS=STATIC, ATR=M_TP,
       51     3937        MSG=TP_MCT_MSG#, NPARMS=2);
       52     3950    1           2 LEN(0:1) UBIN(9) UNAL INIT(8, 100),
       53     3951    1               2 INSTANCE CHAR(8),
       54     3952    1               2 TEXT CHAR(100);
       55     3953        %OC_MESSHD_D(NAME=HDR_TO_ONECONSOLE, STCLASS=STATIC, ATR=M_TP,
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:4    
       56     3954        MSG=TP_TXT_MSG#, NPARMS=2);
       57     3967    1           2 LEN(0:1) UBIN(9) UNAL INIT(8, 100),
       58     3968    1               2 INSTANCE CHAR(8),
       59     3969    1               2 TEXT CHAR(100);
       60     3970
       61     3971    1   DCL 1 WRITE_XACTION STATIC,
       62     3972    1         2 FUNCTION CHAR(3) INIT('002'),
       63     3973    1         2 TEXT CHAR(80);
       64     3974
       65     3975    1   DCL TIMEBUF CHAR(11) STATIC INIT(' ');
       66     3976    1   DCL DATEBUF CHAR(10) STATIC INIT(' ');
       67     3977    1   DCL SAVE_TIMESTAMP CHAR(20) STATIC INIT(' ');
       68     3978    1   DCL ERROR_CODE CHAR(05) STATIC INIT(' ');
       69     3979        %PAGE(ARG="Auto");

              3996    1   /***************************************************************************
              3997    1    *                                                                         *
              3998    1    *                                    Auto                                 *
              3999    1    *                                                                         *
              4000    1    ***************************************************************************/

       70     4004    1   DCL P$ PTR;
       71     4005
       72     4006    1   DCL CHARS_LEFT SBIN WORD;
       73     4007    1   DCL POS SBIN WORD;
       74     4008    1   DCL I SBIN WORD;
       75     4009    1   DCL K SBIN WORD;
       76     4010    1   DCL NUM_LINES SBIN WORD;
       77     4011    1   DCL CHAR_STRING_SIZE SBIN WORD;
       78     4012
       79     4013    1   DCL 1 OUTPUT_LINE,
       80     4014    1         2 VFC CHAR(1),
       81     4015    1         2 TEXT CHAR(79);
       82     4016
       83     4017    1   DCL WILD_FLAG BIT(1) ALIGNED;
       84     4018    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       85     4019
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:5    
       86     4020        %EL$DODCB(STCLASS=AUTO);
       87     4023        %FPT_WRSYSLOG(FPTN=FPTWRSYSLOG, STCLASS=AUTO);
       88     4038        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:6    
              4055    1   /***************************************************************************
              4056    1    *                                                                         *
              4057    1    *                                    FPTs                                 *
              4058    1    *                                                                         *
              4059    1    ***************************************************************************/

       89     4063        %FPT_WRITE(FPTN=FPT_WRITE_SEQ, DCB=M$DO, VFC=YES);
       90     4094
       91     4095        %FPT_WRITE(FPTN=FPT_WRITE_CSCG, DCB=M$CSCG, STATION=VLP_STATION_CSCG);
       92     4126
       93     4127        %FPT_WRITE(FPTN=FPT_WRITE_CG, DCB=M$CG, STATION=VLP_STATION_CG,
       94     4128        BUF=WRITE_XACTION);
       95     4159
       96     4160        %FPT_TIME(TIME=TIMEBUF, DATE=DATEBUF, DEST=EXT);
       97     4179
       98     4180        %PAGE(ARG="VLPs");

              4197    1   /***************************************************************************
              4198    1    *                                                                         *
              4199    1    *                                    VLPs                                 *
              4200    1    *                                                                         *
              4201    1    ***************************************************************************/

       99     4205        %VLP_STATION(FPTN=VLP_STATION_CSCG, STATION='KEYIN');
      100     4232        %VLP_STATION(FPTN=VLP_STATION_CG);
      101     4259        %PAGE(ARG="Error codes");

              4276    1   /***************************************************************************
              4277    1    *                                                                         *
              4278    1    *                                Error codes                              *
              4279    1    *                                                                         *
              4280    1    ***************************************************************************/

      102     4284        %ERRCODE(NAME=CODE_CGFILL,CODE#=%E$CGFILL,FCG#=%FCG_QQ, MID#=%MID_A);
      103     4291        %PAGE(ARG="QQC$SNDMSG", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:7    
              4308    1   /***************************************************************************
              4309    1    *                                                                         *
              4310    1    *                                 QQC$SNDMSG                              *
              4311    1    *                                                                         *
              4312    1    ***************************************************************************/

      104     4316    1           IF P_MSGBLK.FLAGS.DEST.DODCB THEN
      105     4317    2             DO;
      106     4318    2               CALL TO_DODCB;
      107     4319    2             END;
      108     4320
      109     4321    1           IF P_MSGBLK.FLAGS.DEST.STATION THEN
      110     4322    2             DO;
      111     4323    2               CALL TO_STATION;
      112     4324    2             END;
      113     4325
      114     4326    1           IF P_MSGBLK.FLAGS.DEST.MCT THEN
      115     4327    2             DO;
      116     4328    2               CALL TO_DODCB;
      117     4329    2               CALL TO_MCT;
      118     4330    2             END;
      119     4331
      120     4332    1           IF P_MSGBLK.FLAGS.DEST.HISTORY OR
      121     4333    1               P_MSGBLK.FLAGS.DEST.MCT THEN
      122     4334    2             DO;
      123     4335    2               CALL TO_HISTORY;
      124     4336    2             END;
      125     4337
      126     4338    1           IF P_MSGBLK.FLAGS.DEST.ONECONSOLE THEN
      127     4339    2             DO;
      128     4340    2               CALL TO_ONECONSOLE;
      129     4341    2             END;
      130     4342
      131     4343    1           IF P_MSGBLK.FLAGS.DEST.CSCG THEN
      132     4344    2             DO;
      133     4345    2               CALL TO_CSCG;
      134     4346    2             END;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:8    
      135     4347
      136     4348    1           RETURN;
      137     4349                %PAGE(ARG="TO_DODCB",PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:9    
              4366    1   /***************************************************************************
              4367    1    *                                                                         *
              4368    1    *                                  TO_DODCB                               *
              4369    1    *                                                                         *
              4370    1    ***************************************************************************/

      138     4374    1   TO_DODCB:
      139     4375    1           PROC;
      140     4376
      141     4377    2           CHAR_STRING_SIZE = 79;
      142     4378    2           NUM_LINES = (P_MSGBLK.ARS + 79) / 80;
      143     4379    2           P$ = P_MSGBLK.TEXT$;
      144     4380    2           CHARS_LEFT = P_MSGBLK.ARS;
      145     4381    2           OUTPUT_LINE.VFC = 'A';
      146     4382    2           FPT_WRITE_SEQ.BUF_ = VECTOR(OUTPUT_LINE);
      147     4383
      148     4384    2           CALL M$TIME(FPT_TIME) ALTRET(MON_ERR);
      149     4385    2           CALL INSERT(OUTPUT_LINE.TEXT, 0, 79, SUBSTR(TIMEBUF, 0, 5),
      150     4386    2               '   ',DATEBUF);
      151     4387    2           IF OUTPUT_LINE.TEXT ~= SAVE_TIMESTAMP THEN
      152     4388    3             DO;
      153     4389    3               CALL M$WRITE(FPT_WRITE_SEQ) ALTRET(MON_ERR);
      154     4390    3               SAVE_TIMESTAMP = OUTPUT_LINE.TEXT;
      155     4391    3             END;
      156     4392
      157     4393
      158     4394    3           DO I = 1 TO NUM_LINES;
      159     4395    3             IF CHARS_LEFT < 80 THEN
      160     4396    4               DO;
      161     4397    4                 CHAR_STRING_SIZE = CHARS_LEFT;
      162     4398    4               END;
      163     4399    3             OUTPUT_LINE.TEXT = P$ -> CHAR$STRING;
      164     4400    3             CALL M$WRITE(FPT_WRITE_SEQ) ALTRET(MON_ERR);
      165     4401    3             CHARS_LEFT = CHARS_LEFT - 80;
      166     4402    3             P$ = PINCRC(P$, 80);
      167     4403    3           END;
      168     4404    2           RETURN;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:10   
      169     4405    2   MON_ERR:
      170     4406    2           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 21 THEN
      171     4407    3             DO;
      172     4408    3               EL$DODCB.PROCESSOR = 'TPA' ;
      173     4409    3               EL$DODCB.TXT = 'M$DO file is busy.' ;
      174     4410    3               FPTWRSYSLOG = FPT_WRSYSLOG ;
      175     4411    3               FPTWRSYSLOG.V_ = VECTOR(FPTWRSYSLOG.V) ;
      176     4412    3               FPTWRSYSLOG.ENTRY_ = VECTOR(EL$DODCB) ;
      177     4413    3               FPTWRSYSLOG.V.SIZE# = SIZEW(EL$DODCB) ;
      178     4414    3               CALL M$WRSYSLOG (FPTWRSYSLOG) ALTRET(MON_ERR1);
      179     4415    3               RETURN;
      180     4416    3             END;
      181     4417                  /*  ELSE check to see if we're in the initialization
      182     4418                      phase of TP.  If so, don't screech, just send a
      183     4419                      message to the system log as before
      184     4420                  */
      185     4421    2           ELSE IF QQ_CMDBLK.ORIGIN = 2 /* ORIGIN_INIT */
              4421                    /* ORIGIN_INIT                */
      186     4422    2             THEN
      187     4423    3               DO;
      188     4424    3                 EL$DODCB.PROCESSOR = 'TPA';
      189     4425    3                 CALL BINCHAR(ERROR_CODE,B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE);
      190     4426    3                 CALL INSERT(EL$DODCB.TXT, 0, 20, 'Init ERR.CODE: ',
      191     4427    3                     ERROR_CODE);
      192     4428    3                 FPTWRSYSLOG = FPT_WRSYSLOG ;
      193     4429    3                 FPTWRSYSLOG.V_ = VECTOR(FPTWRSYSLOG.V) ;
      194     4430    3                 FPTWRSYSLOG.ENTRY_ = VECTOR(EL$DODCB) ;
      195     4431    3                 FPTWRSYSLOG.V.SIZE# = SIZEW(EL$DODCB) ;
      196     4432    3                 CALL M$WRSYSLOG (FPTWRSYSLOG) ALTRET(MON_ERR1);
      197     4433    3                 QQ_GLOBAL.ERR = '0'B;
      198     4434    3                 CALL QQC$STOPTP('1'B);
      199     4435    3               END;
      200     4436
      201     4437    2   MON_ERR1:
      202     4438    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      203     4439    2           CALL QQC$SCREECH;
      204     4440    2   END TO_DODCB;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:11   
      205     4441                %PAGE(ARG="TO_STATION",PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:12   
              4458    2   /***************************************************************************
              4459    2    *                                                                         *
              4460    2    *                                 TO_STATION                              *
              4461    2    *                                                                         *
              4462    2    ***************************************************************************/

      206     4466    1   TO_STATION:
      207     4467    1           PROC;
      208     4468
      209     4469    2           IF QQ_ERRMAP(ADDR(P_MSGBLK.ERRINFO.ERR(0))->ERR.ERR#)
      210     4470    2           THEN WRITE_XACTION.FUNCTION='005';
      211     4471    2           IF P_MSGBLK.FLAGS.REPORT THEN
      212     4472    3             DO;
      213     4473    3               VLP_STATION_CG.CTL.LATCH# = '0'B;
      214     4474    3               VLP_STATION_CG.MSGTYP# = 'MSGG';
      215     4475    3             END;
      216     4476    2           ELSE
      217     4477    3             DO;
      218     4478    3               VLP_STATION_CG.CTL.LATCH# = '1'B;
      219     4479    3               VLP_STATION_CG.MSGTYP# = ' ';
      220     4480    3             END;
      221     4481
      222     4482    2           WILD_FLAG = '0'B;
      223     4483
      224     4484    2           CALL INDEX(POS, '?', P_MSGBLK.ID) ALTRET(NO_Q);
      225     4485    2           WILD_FLAG = '1'B;
      226     4486
      227     4487    2   NO_Q:
      228     4488    2           IF NOT WILD_FLAG THEN
      229     4489    3             DO;
      230     4490    3               VLP_STATION_CG.STATION# = P_MSGBLK.ID;
      231     4491    3               CALL SEND_TO_STATION;
      232     4492    3               P_MSGBLK.FLAGS.MSG_SENT = '1'B;
      233     4493    3             END;
      234     4494    2           ELSE
      235     4495    3             DO;
      236     4496    4               DO K = 1 TO QQ_GLOBAL.STATION_CNT;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:13   
      237     4497    4                 S$ = PINCRW(QQ_GLOBAL.STATION$, (K - 1) * SIZEW(TP$STATION));
      238     4498    4                 CALL QQC$WILD_COMP(P_MSGBLK.ID, TP$STATION.ID) ALTRET(LOOP);
      239     4499    4                 VLP_STATION_CG.STATION# = TP$STATION.ID;
      240     4500    4                 CALL SEND_TO_STATION;
      241     4501    4                 P_MSGBLK.FLAGS.MSG_SENT = '1'B;
      242     4502
      243     4503    4   LOOP:
      244     4504    4               END;
      245     4505    3             END;
      246     4506
      247     4507    2           RETURN;
      248     4508
      249     4509    2   END TO_STATION;
      250     4510                %PAGE(ARG="SEND_TO_STATION", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:14   
              4527    2   /***************************************************************************
              4528    2    *                                                                         *
              4529    2    *                              SEND_TO_STATION                            *
              4530    2    *                                                                         *
              4531    2    ***************************************************************************/

      251     4535    1   SEND_TO_STATION:
      252     4536    1           PROC;
      253     4537
      254     4538    2           CHAR_STRING_SIZE = 79;
      255     4539    2           NUM_LINES = (P_MSGBLK.ARS +79) / 80;
      256     4540    2           P$ = P_MSGBLK.TEXT$;
      257     4541    2           CHARS_LEFT = P_MSGBLK.ARS;
      258     4542
      259     4543    3           DO I = 1 TO NUM_LINES;
      260     4544    3             IF CHARS_LEFT < 80 THEN
      261     4545    4               DO;
      262     4546    4                 CHAR_STRING_SIZE = CHARS_LEFT;
      263     4547    4               END;
      264     4548
      265     4549    3             WRITE_XACTION.TEXT = P$ -> CHAR$STRING;
      266     4550    3             CALL M$WRITE(FPT_WRITE_CG) ALTRET(MON_ERR);
      267     4551    3             CHARS_LEFT = CHARS_LEFT - 80;
      268     4552    3             P$ = PINCRC(P$, 80);
      269     4553    3             WRITE_XACTION.FUNCTION = '002';
      270     4554    3           END;
      271     4555
      272     4556    2           RETURN;
      273     4557
      274     4558    2   MON_ERR:
      275     4559    2           CALL QQC$BLDMSG_ERRBLK(P_MSGBLK);
      276     4560    2           P_MSGBLK.ERRINFO.ERR(0) = CODE_CGFILL;
      277     4561    2           QQ_GLOBAL.ERROR_CNT = QQ_GLOBAL.ERROR_CNT - 1;
      278     4562    2           CALL QQC$BLDMSG(P_MSGBLK);
      279     4563    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      280     4564    2           CALL QQC$SCREECH;
      281     4565
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:15   
      282     4566    2   END SEND_TO_STATION;
      283     4567                %PAGE(ARG="TO_MCT", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:16   
              4584    2   /***************************************************************************
              4585    2    *                                                                         *
              4586    2    *                                   TO_MCT                                *
              4587    2    *                                                                         *
              4588    2    ***************************************************************************/

      284     4592    1   TO_MCT:
      285     4593    1           PROC;
      286     4594
      287     4595    2           VLP_STATION_CG.CTL.LATCH# = '0'B;
      288     4596    2           VLP_STATION_CG.MSGTYP# = 'MSGG';
      289     4597
      290     4598    3           DO K = 1 TO QQ_GLOBAL.STATION_CNT;
      291     4599    3             S$ = PINCRW(QQ_GLOBAL.STATION$, (K - 1) * SIZEW(TP$STATION));
      292     4600    3             IF TP$STATION.FLAGS.MCT AND
      293     4601    3                 NOT (P_MSGBLK.FLAGS.DEST.STATION AND P_MSGBLK.ID =
      294     4602    3                 TP$STATION.ID) THEN
      295     4603    4               DO;
      296     4604    4                 P_MSGBLK.FLAGS.MSG_SENT = '1'B;
      297     4605    4                 VLP_STATION_CG.STATION# = TP$STATION.ID;
      298     4606    4                 CALL SEND_TO_STATION;
      299     4607    4               END;
      300     4608    3           END;
      301     4609
      302     4610    2           IF QQ_GLOBAL.MCTID ~= ' ' THEN
      303     4611    3             DO;
      304     4612    3               CALL QQC$FINDSTA(QQ_GLOBAL.MCTID, S$, FOUND_FLAG);
      305     4613    3               IF NOT FOUND_FLAG AND
      306     4614    3                   NOT (P_MSGBLK.FLAGS.DEST.STATION AND P_MSGBLK.ID =
      307     4615    3                   QQ_GLOBAL.MCTID) THEN
      308     4616    4                 DO;
      309     4617    4                   P_MSGBLK.FLAGS.MSG_SENT = '1'B;
      310     4618    4                   VLP_STATION_CG.STATION# = QQ_GLOBAL.MCTID;
      311     4619    4                   CALL SEND_TO_STATION;
      312     4620    4                 END;
      313     4621    3             END;
      314     4622
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:17   
      315     4623        %EJECT;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:18   
      316     4624    2           IF QQ_GLOBAL.LOG AND
      317     4625    2               NOT P_MSGBLK.FLAGS.INHIB_CSCG THEN
      318     4626    3             DO;
      319     4627    3               HDR_TO_MCT.INSTANCE = QQ_GLOBAL.INSTANCE_NAME;
      320     4628    3               CHAR_STRING_SIZE = 79;
      321     4629    3               NUM_LINES = (P_MSGBLK.ARS + 79) / 80;
      322     4630    3               P$ = P_MSGBLK.TEXT$;
      323     4631    3               CHARS_LEFT = P_MSGBLK.ARS;
      324     4632    3               HDR_TO_MCT.LEN(1) = 79;
      325     4633    3               P_MSGBLK.TEXT$ = ADDR(HDR_TO_MCT);
      326     4634    3               P_MSGBLK.ARS = SIZEC(HDR_TO_MCT);
      327     4635
      328     4636    4               DO I = 1 TO NUM_LINES;
      329     4637    4                 IF CHARS_LEFT < 80 THEN
      330     4638    5                   DO;
      331     4639    5                     CHAR_STRING_SIZE = CHARS_LEFT;
      332     4640    5                     HDR_TO_MCT.LEN(1) = CHARS_LEFT;
      333     4641    5                   END;
      334     4642    4                 HDR_TO_MCT.TEXT = P$ -> CHAR$STRING;
      335     4643
      336     4644    4                 CALL TO_CSCG;
      337     4645
      338     4646    4                 CHARS_LEFT = CHARS_LEFT - 80;
      339     4647    4                 P$ = PINCRC(P$, 80);
      340     4648    4               END;
      341     4649    3               P_MSGBLK.FLAGS.MSG_SENT = '1'B;
      342     4650    3             END;
      343     4651
      344     4652    2           RETURN;
      345     4653
      346     4654    2   END TO_MCT;
      347     4655                %PAGE(ARG="TO_ONCONSOLE", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:19   
              4672    2   /***************************************************************************
              4673    2    *                                                                         *
              4674    2    *                                TO_ONCONSOLE                             *
              4675    2    *                                                                         *
              4676    2    ***************************************************************************/

      348     4680    1   TO_ONECONSOLE:
      349     4681    1           PROC;
      350     4682
      351     4683    2           HDR_TO_ONECONSOLE.CADDR = P_MSGBLK.CADDR;
      352     4684    2           HDR_TO_ONECONSOLE.INSTANCE = QQ_GLOBAL.INSTANCE_NAME;
      353     4685    2           CHAR_STRING_SIZE = 79;
      354     4686    2           NUM_LINES = (P_MSGBLK.ARS + 79) / 80;
      355     4687    2           P$ = P_MSGBLK.TEXT$;
      356     4688    2           CHARS_LEFT = P_MSGBLK.ARS;
      357     4689    2           HDR_TO_ONECONSOLE.LEN(1) = 79;
      358     4690    2           P_MSGBLK.TEXT$ = ADDR(HDR_TO_ONECONSOLE);
      359     4691    2           P_MSGBLK.ARS = SIZEC(HDR_TO_ONECONSOLE);
      360     4692
      361     4693    3           DO I = 1 TO NUM_LINES;
      362     4694    3             IF CHARS_LEFT < 80 THEN
      363     4695    4               DO;
      364     4696    4                 CHAR_STRING_SIZE = CHARS_LEFT;
      365     4697    4                 HDR_TO_ONECONSOLE.LEN(1) = CHARS_LEFT;
      366     4698    4               END;
      367     4699    3             HDR_TO_ONECONSOLE.TEXT = P$ -> CHAR$STRING;
      368     4700
      369     4701    3             CALL TO_CSCG;
      370     4702
      371     4703    3             CHARS_LEFT = CHARS_LEFT - 80;
      372     4704    3             P$ = PINCRC(P$, 80);
      373     4705    3           END;
      374     4706
      375     4707    2           P_MSGBLK.FLAGS.MSG_SENT = '1'B;
      376     4708
      377     4709    2           RETURN;
      378     4710
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:20   
      379     4711    2   END TO_ONECONSOLE;
      380     4712                %PAGE(ARG="TO_CSCG", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:21   
              4729    2   /***************************************************************************
              4730    2    *                                                                         *
              4731    2    *                                  TO_CSCG                                *
              4732    2    *                                                                         *
              4733    2    ***************************************************************************/

      381     4737    1   TO_CSCG:
      382     4738    1           PROC;
      383     4739
      384     4740    2           FPT_WRITE_CSCG.BUF_.BUF$ = P_MSGBLK.TEXT$;
      385     4741    2           FPT_WRITE_CSCG.BUF_.BOUND = P_MSGBLK.ARS - 1 ;
      386     4742    2           CALL M$WRITE(FPT_WRITE_CSCG) ALTRET(MON_ERR);
      387     4743
      388     4744    2           P_MSGBLK.FLAGS.MSG_SENT = '1'B;
      389     4745
      390     4746    2           RETURN;
      391     4747
      392     4748    2   MON_ERR:
      393     4749    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      394     4750    2           CALL QQC$SCREECH;
      395     4751
      396     4752    2   END TO_CSCG;
      397     4753        %EJECT;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:22   
      398     4754    1   TO_HISTORY:
      399     4755    1           PROC;
      400     4756    2           RETURN;
      401     4757    2   END TO_HISTORY;
      402     4758    1   END QQC$SNDMSG;

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:23   
--  Include file information  --

   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$SNDMSG.

   Procedure QQC$SNDMSG requires 559 words for executable code.
   Procedure QQC$SNDMSG requires 58 words of local(AUTO) storage.

    No errors detected in file QQC$SNDMSG.:E05TSI    .

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:24   

 Object Unit name= QQC$SNDMSG                                 File name= QQC$SNDMSG.:E05TOU
 UTS= JUL 30 '97 05:41:42.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   DCB   even  none     0      0  M$DO
    3   DCB   even  none     0      0  M$CSCG
    4  RoData even  UTS     23     27  QQC$SNDMSG
    5   Data  even  none   164    244  QQC$SNDMSG
    6   Proc  even  none   559   1057  QQC$SNDMSG
    7  RoData even  none     9     11  QQC$SNDMSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        1  QQC$SNDMSG
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:25   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 QQC$SCREECH
         yes           Std       1 QQC$STOPTP
 yes     yes           Std       2 QQC$WILD_COMP
         yes           Std       1 QQC$BLDMSG_ERRBLK
         yes           Std       1 QQC$BLDMSG
         yes           Std       3 QQC$FINDSTA
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
r    QQ_ERRMAP                             B$TCB$                                M$CG
     M$DO                                  M$CSCG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:26   


        1        1        /*M* QQC$SNDMSG - Transmit a message */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQC$SNDMSG:
        9        9                PROC(P_MSGBLK);

      9  6 000000   000000 700200 xent  QQC$SNDMSG   TSX0  ! X66_AUTO_1
         6 000001   000072 000001                    ZERO    58,1

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QQ_MACROS_C;
       16      575        %INCLUDE QQ_DATA_R;
       17      821        %INCLUDE QQ_SUBS_C;
       18     1013        %INCLUDE OC_MESSHD_C;
       19     1066        %INCLUDE OC_SUBS_C;
       20     1797        %INCLUDE EL$TABLES;
       21     2120        %INCLUDE EL_SUBS_C;
       22     2204        %INCLUDE B_ERRORS_C;
       23     3331        %INCLUDE Q_ERRCODE_C;
       24     3354        %INCLUDE QQ_PERR_C;
       25     3515        %PAGE(ARG="Parameters");
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:27   

              3532    1   /***************************************************************************
              3533    1    *                                                                         *
              3534    1    *                                 Parameters                              *
              3535    1    *                                                                         *
              3536    1    ***************************************************************************/

       26     3540        %MSGBLK(FPTN="P_MSGBLK");
       27     3630        %PAGE(ARG="Externaly defined routines");

              3647    1   /***************************************************************************
              3648    1    *                                                                         *
              3649    1    *                         Externaly defined routines                      *
              3650    1    *                                                                         *
              3651    1    ***************************************************************************/

       28     3655    1   DCL QQC$FINDSTA ENTRY(3);
       29     3656    1   DCL QQC$BLDMSG ENTRY(1);
       30     3657    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       31     3658    1   DCL QQC$SCREECH ENTRY;
       32     3659    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       33     3660    1   DCL QQC$STOPTP ENTRY(1);
       34     3661        %PAGE(ARG="Symrefs");

              3678    1   /***************************************************************************
              3679    1    *                                                                         *
              3680    1    *                                  Symrefs                                *
              3681    1    *                                                                         *
              3682    1    ***************************************************************************/

       35     3686    1   DCL B$TCB$ PTR SYMREF;
       36     3687        %PAGE(ARG="DCBs");

              3704    1   /***************************************************************************
              3705    1    *                                                                         *
              3706    1    *                                    DCBs                                 *
              3707    1    *                                                                         *
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:28   
              3708    1    ***************************************************************************/

       37     3712    1   DCL M$CG DCB;
       38     3713    1   DCL M$DO DCB;
       39     3714    1   DCL M$CSCG DCB;
       40     3715        %PAGE(ARG="Based");

              3732    1   /***************************************************************************
              3733    1    *                                                                         *
              3734    1    *                                   Based                                 *
              3735    1    *                                                                         *
              3736    1    ***************************************************************************/

       41     3740        %PAGE(ARG="Constant");

              3757    1   /***************************************************************************
              3758    1    *                                                                         *
              3759    1    *                                  Constant                               *
              3760    1    *                                                                         *
              3761    1    ***************************************************************************/

       42     3765        %FPT_WRSYSLOG(FPTN=FPT_WRSYSLOG, TYPE=EL_DODCB, STCLASS=CONSTANT);
       43     3780    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       44     3781
       45     3782        %B$TCB;
       46     3785        %B$ALT;
       47     3793        %TP$STATION;
       48     3866        %VLP_ERRCODE(FPTN=ERR,STCLASS=BASED);
       49     3911        %PAGE(ARG="Static");

              3928    1   /***************************************************************************
              3929    1    *                                                                         *
              3930    1    *                                   Static                                *
              3931    1    *                                                                         *
              3932    1    ***************************************************************************/

       50     3936        %OC_MESSHD_D(NAME=HDR_TO_MCT, STCLASS=STATIC, ATR=M_TP,
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:29   
       51     3937        MSG=TP_MCT_MSG#, NPARMS=2);
       52     3950    1           2 LEN(0:1) UBIN(9) UNAL INIT(8, 100),
       53     3951    1               2 INSTANCE CHAR(8),
       54     3952    1               2 TEXT CHAR(100);
       55     3953        %OC_MESSHD_D(NAME=HDR_TO_ONECONSOLE, STCLASS=STATIC, ATR=M_TP,
       56     3954        MSG=TP_TXT_MSG#, NPARMS=2);
       57     3967    1           2 LEN(0:1) UBIN(9) UNAL INIT(8, 100),
       58     3968    1               2 INSTANCE CHAR(8),
       59     3969    1               2 TEXT CHAR(100);
       60     3970
       61     3971    1   DCL 1 WRITE_XACTION STATIC,
       62     3972    1         2 FUNCTION CHAR(3) INIT('002'),
       63     3973    1         2 TEXT CHAR(80);
       64     3974
       65     3975    1   DCL TIMEBUF CHAR(11) STATIC INIT(' ');
       66     3976    1   DCL DATEBUF CHAR(10) STATIC INIT(' ');
       67     3977    1   DCL SAVE_TIMESTAMP CHAR(20) STATIC INIT(' ');
       68     3978    1   DCL ERROR_CODE CHAR(05) STATIC INIT(' ');
       69     3979        %PAGE(ARG="Auto");

              3996    1   /***************************************************************************
              3997    1    *                                                                         *
              3998    1    *                                    Auto                                 *
              3999    1    *                                                                         *
              4000    1    ***************************************************************************/

       70     4004    1   DCL P$ PTR;
       71     4005
       72     4006    1   DCL CHARS_LEFT SBIN WORD;
       73     4007    1   DCL POS SBIN WORD;
       74     4008    1   DCL I SBIN WORD;
       75     4009    1   DCL K SBIN WORD;
       76     4010    1   DCL NUM_LINES SBIN WORD;
       77     4011    1   DCL CHAR_STRING_SIZE SBIN WORD;
       78     4012
       79     4013    1   DCL 1 OUTPUT_LINE,
       80     4014    1         2 VFC CHAR(1),
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:30   
       81     4015    1         2 TEXT CHAR(79);
       82     4016
       83     4017    1   DCL WILD_FLAG BIT(1) ALIGNED;
       84     4018    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       85     4019
       86     4020        %EL$DODCB(STCLASS=AUTO);
       87     4023        %FPT_WRSYSLOG(FPTN=FPTWRSYSLOG, STCLASS=AUTO);
       88     4038        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:31   
              4055    1   /***************************************************************************
              4056    1    *                                                                         *
              4057    1    *                                    FPTs                                 *
              4058    1    *                                                                         *
              4059    1    ***************************************************************************/

       89     4063        %FPT_WRITE(FPTN=FPT_WRITE_SEQ, DCB=M$DO, VFC=YES);
       90     4094
       91     4095        %FPT_WRITE(FPTN=FPT_WRITE_CSCG, DCB=M$CSCG, STATION=VLP_STATION_CSCG);
       92     4126
       93     4127        %FPT_WRITE(FPTN=FPT_WRITE_CG, DCB=M$CG, STATION=VLP_STATION_CG,
       94     4128        BUF=WRITE_XACTION);
       95     4159
       96     4160        %FPT_TIME(TIME=TIMEBUF, DATE=DATEBUF, DEST=EXT);
       97     4179
       98     4180        %PAGE(ARG="VLPs");

              4197    1   /***************************************************************************
              4198    1    *                                                                         *
              4199    1    *                                    VLPs                                 *
              4200    1    *                                                                         *
              4201    1    ***************************************************************************/

       99     4205        %VLP_STATION(FPTN=VLP_STATION_CSCG, STATION='KEYIN');
      100     4232        %VLP_STATION(FPTN=VLP_STATION_CG);
      101     4259        %PAGE(ARG="Error codes");

              4276    1   /***************************************************************************
              4277    1    *                                                                         *
              4278    1    *                                Error codes                              *
              4279    1    *                                                                         *
              4280    1    ***************************************************************************/

      102     4284        %ERRCODE(NAME=CODE_CGFILL,CODE#=%E$CGFILL,FCG#=%FCG_QQ, MID#=%MID_A);
      103     4291        %PAGE(ARG="QQC$SNDMSG", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:32   
              4308    1   /***************************************************************************
              4309    1    *                                                                         *
              4310    1    *                                 QQC$SNDMSG                              *
              4311    1    *                                                                         *
              4312    1    ***************************************************************************/

      104     4316    1           IF P_MSGBLK.FLAGS.DEST.DODCB THEN

   4316  6 000002   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000003   000002 236100                    LDQ     2,,PR0
         6 000004   000010 316003                    CANQ    8,DU
         6 000005   000010 600000 6                  TZE     s:4321

      105     4317    2             DO;

      106     4318    2               CALL TO_DODCB;

   4318  6 000006   000053 701000 6                  TSX1    TO_DODCB
         6 000007   000000 011000                    NOP     0

      107     4319    2             END;

      108     4320
      109     4321    1           IF P_MSGBLK.FLAGS.DEST.STATION THEN

   4321  6 000010   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000011   000002 236100                    LDQ     2,,PR0
         6 000012   000100 316003                    CANQ    64,DU
         6 000013   000016 600000 6                  TZE     s:4326

      110     4322    2             DO;

      111     4323    2               CALL TO_STATION;

   4323  6 000014   000312 701000 6                  TSX1    TO_STATION
         6 000015   000000 011000                    NOP     0

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:33   
      112     4324    2             END;

      113     4325
      114     4326    1           IF P_MSGBLK.FLAGS.DEST.MCT THEN

   4326  6 000016   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000017   000002 236100                    LDQ     2,,PR0
         6 000020   000020 316003                    CANQ    16,DU
         6 000021   000026 600000 6                  TZE     s:4332

      115     4327    2             DO;

      116     4328    2               CALL TO_DODCB;

   4328  6 000022   000053 701000 6                  TSX1    TO_DODCB
         6 000023   000000 011000                    NOP     0

      117     4329    2               CALL TO_MCT;

   4329  6 000024   000525 701000 6                  TSX1    TO_MCT
         6 000025   000000 011000                    NOP     0

      118     4330    2             END;

      119     4331
      120     4332    1           IF P_MSGBLK.FLAGS.DEST.HISTORY OR

   4332  6 000026   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000027   000002 236100                    LDQ     2,,PR0
         6 000030   000004 316003                    CANQ    4,DU
         6 000031   000034 601000 6                  TNZ     s:4335
         6 000032   000020 316003                    CANQ    16,DU
         6 000033   000036 600000 6                  TZE     s:4338

      121     4333    1               P_MSGBLK.FLAGS.DEST.MCT THEN
      122     4334    2             DO;

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:34   
      123     4335    2               CALL TO_HISTORY;

   4335  6 000034   001055 701000 6                  TSX1    TO_HISTORY
         6 000035   000000 011000                    NOP     0

      124     4336    2             END;

      125     4337
      126     4338    1           IF P_MSGBLK.FLAGS.DEST.ONECONSOLE THEN

   4338  6 000036   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000037   000002 236100                    LDQ     2,,PR0
         6 000040   000002 316003                    CANQ    2,DU
         6 000041   000044 600000 6                  TZE     s:4343

      127     4339    2             DO;

      128     4340    2               CALL TO_ONECONSOLE;

   4340  6 000042   000725 701000 6                  TSX1    TO_ONECONSOLE
         6 000043   000000 011000                    NOP     0

      129     4341    2             END;

      130     4342
      131     4343    1           IF P_MSGBLK.FLAGS.DEST.CSCG THEN

   4343  6 000044   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000045   000002 236100                    LDQ     2,,PR0
         6 000046   000040 316003                    CANQ    32,DU
         6 000047   000052 600000 6                  TZE     s:4348

      132     4344    2             DO;

      133     4345    2               CALL TO_CSCG;

   4345  6 000050   001020 701000 6                  TSX1    TO_CSCG
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:35   
         6 000051   000000 011000                    NOP     0

      134     4346    2             END;

      135     4347
      136     4348    1           RETURN;

   4348  6 000052   000000 702200 xent               TSX2  ! X66_ARET

      137     4349                %PAGE(ARG="TO_DODCB",PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:36   
              4366    1   /***************************************************************************
              4367    1    *                                                                         *
              4368    1    *                                  TO_DODCB                               *
              4369    1    *                                                                         *
              4370    1    ***************************************************************************/

      138     4374    1   TO_DODCB:

   4374  6 000053   200062 741300       TO_DODCB     STX1  ! FPTWRSYSLOG+8,,AUTO

      139     4375    1           PROC;
      140     4376
      141     4377    2           CHAR_STRING_SIZE = 79;

   4377  6 000054   000117 235007                    LDA     79,DL
         6 000055   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      142     4378    2           NUM_LINES = (P_MSGBLK.ARS + 79) / 80;

   4378  6 000056   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000057   000003 236100                    LDQ     3,,PR0
         6 000060   000022 772000                    QRL     18
         6 000061   000117 036007                    ADLQ    79,DL
         6 000062   000120 506007                    DIV     80,DL
         6 000063   200012 756100                    STQ     NUM_LINES,,AUTO

      143     4379    2           P$ = P_MSGBLK.TEXT$;

   4379  6 000064   000005 236100                    LDQ     5,,PR0
         6 000065   200005 756100                    STQ     P$,,AUTO

      144     4380    2           CHARS_LEFT = P_MSGBLK.ARS;

   4380  6 000066   000003 236100                    LDQ     3,,PR0
         6 000067   000022 772000                    QRL     18
         6 000070   200006 756100                    STQ     CHARS_LEFT,,AUTO

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:37   
      145     4381    2           OUTPUT_LINE.VFC = 'A';

   4381  6 000071   101000 236003                    LDQ     33280,DU
         6 000072   200014 552140                    STBQ    OUTPUT_LINE,'40'O,AUTO

      146     4382    2           FPT_WRITE_SEQ.BUF_ = VECTOR(OUTPUT_LINE);

   4382  6 000073   000000 235000 7                  LDA     0
         6 000074   200066 452500                    STP2    FPTWRSYSLOG+12,,AUTO
         6 000075   200066 236100                    LDQ     FPTWRSYSLOG+12,,AUTO
         6 000076   000014 036003                    ADLQ    12,DU
         6 000077   000150 757000 5                  STAQ    FPT_WRITE_SEQ+4

      147     4383
      148     4384    2           CALL M$TIME(FPT_TIME) ALTRET(MON_ERR);

   4384  6 000100   000210 630400 5                  EPPR0   FPT_TIME
         6 000101   420004 713400                    CLIMB   alt,+8196
         6 000102   402000 401760                    pmme    nvectors=5
         6 000103   000163 702000 6                  TSX2    MON_ERR

      149     4385    2           CALL INSERT(OUTPUT_LINE.TEXT, 0, 79, SUBSTR(TIMEBUF, 0, 5),

   4385  6 000104   040100 100400                    MLR     fill='040'O
         6 000105   000127 000005 5                  ADSC9   TIMEBUF                  cn=0,n=5
         6 000106   200014 200005                    ADSC9   OUTPUT_LINE,,AUTO        cn=1,n=5
         6 000107   040100 100400                    MLR     fill='040'O
         6 000110   000011 000003 4                  ADSC9   CODE_CGFILL+1            cn=0,n=3
         6 000111   200015 400003                    ADSC9   OUTPUT_LINE+1,,AUTO      cn=2,n=3
         6 000112   040100 100400                    MLR     fill='040'O
         6 000113   000132 000012 5                  ADSC9   DATEBUF                  cn=0,n=10
         6 000114   200016 200107                    ADSC9   OUTPUT_LINE+2,,AUTO      cn=1,n=71

      150     4386    2               '   ',DATEBUF);
      151     4387    2           IF OUTPUT_LINE.TEXT ~= SAVE_TIMESTAMP THEN

   4387  6 000115   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:38   
         6 000116   200014 200117                    ADSC9   OUTPUT_LINE,,AUTO        cn=1,n=79
         6 000117   000135 000024 5                  ADSC9   SAVE_TIMESTAMP           cn=0,n=20
         6 000120   000130 600000 6                  TZE     s:4394

      152     4388    3             DO;

      153     4389    3               CALL M$WRITE(FPT_WRITE_SEQ) ALTRET(MON_ERR);

   4389  6 000121   000144 630400 5                  EPPR0   FPT_WRITE_SEQ
         6 000122   440001 713400                    CLIMB   alt,write
         6 000123   401400 401760                    pmme    nvectors=4
         6 000124   000163 702000 6                  TSX2    MON_ERR

      154     4390    3               SAVE_TIMESTAMP = OUTPUT_LINE.TEXT;

   4390  6 000125   040000 100500                    MLR     fill='040'O
         6 000126   200014 200024                    ADSC9   OUTPUT_LINE,,AUTO        cn=1,n=20
         6 000127   000135 000024 5                  ADSC9   SAVE_TIMESTAMP           cn=0,n=20

      155     4391    3             END;

      156     4392
      157     4393
      158     4394    3           DO I = 1 TO NUM_LINES;

   4394  6 000130   000001 235007                    LDA     1,DL
         6 000131   200010 755100                    STA     I,,AUTO
         6 000132   000156 710000 6                  TRA     s:4403+1

      159     4395    3             IF CHARS_LEFT < 80 THEN

   4395  6 000133   200006 235100                    LDA     CHARS_LEFT,,AUTO
         6 000134   000120 115007                    CMPA    80,DL
         6 000135   000137 605000 6                  TPL     s:4399

      160     4396    4               DO;

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:39   
      161     4397    4                 CHAR_STRING_SIZE = CHARS_LEFT;

   4397  6 000136   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      162     4398    4               END;

      163     4399    3             OUTPUT_LINE.TEXT = P$ -> CHAR$STRING;

   4399  6 000137   200005 470500                    LDP0    P$,,AUTO
         6 000140   200013 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         6 000141   040100 100540                    MLR     fill='040'O
         6 000142   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         6 000143   200014 200117                    ADSC9   OUTPUT_LINE,,AUTO        cn=1,n=79

      164     4400    3             CALL M$WRITE(FPT_WRITE_SEQ) ALTRET(MON_ERR);

   4400  6 000144   000144 630400 5                  EPPR0   FPT_WRITE_SEQ
         6 000145   440001 713400                    CLIMB   alt,write
         6 000146   401400 401760                    pmme    nvectors=4
         6 000147   000163 702000 6                  TSX2    MON_ERR

      165     4401    3             CHARS_LEFT = CHARS_LEFT - 80;

   4401  6 000150   000120 336007                    LCQ     80,DL
         6 000151   200006 056100                    ASQ     CHARS_LEFT,,AUTO

      166     4402    3             P$ = PINCRC(P$, 80);

   4402  6 000152   200005 236100                    LDQ     P$,,AUTO
         6 000153   000024 036003                    ADLQ    20,DU
         6 000154   200005 756100                    STQ     P$,,AUTO

      167     4403    3           END;

   4403  6 000155   200010 054100                    AOS     I,,AUTO
         6 000156   200010 236100                    LDQ     I,,AUTO
         6 000157   200012 116100                    CMPQ    NUM_LINES,,AUTO
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:40   
         6 000160   000133 604400 6                  TMOZ    s:4395

      168     4404    2           RETURN;

   4404  6 000161   200062 221300                    LDX1  ! FPTWRSYSLOG+8,,AUTO
         6 000162   000001 702211                    TSX2  ! 1,X1

      169     4405    2   MON_ERR:
      170     4406    2           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 21 THEN

   4406  6 000163   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         6 000164   000000 471500                    LDP1    0,,PR0
         6 000165   100102 236100                    LDQ     66,,PR1
         6 000166   377770 376007                    ANQ     131064,DL
         6 000167   000250 116007                    CMPQ    168,DL
         6 000170   000224 601000 6                  TNZ     s:4421

      171     4407    3             DO;

      172     4408    3               EL$DODCB.PROCESSOR = 'TPA' ;

   4408  6 000171   040100 100400                    MLR     fill='040'O
         6 000172   000012 000003 4                  ADSC9   CODE_CGFILL+2            cn=0,n=3
         6 000173   200042 000012                    ADSC9   EL$DODCB,,AUTO           cn=0,n=10

      173     4409    3               EL$DODCB.TXT = 'M$DO file is busy.' ;

   4409  6 000174   040100 100400                    MLR     fill='040'O
         6 000175   000013 000022 4                  ADSC9   CODE_CGFILL+3            cn=0,n=18
         6 000176   200044 400024                    ADSC9   EL$DODCB+2,,AUTO         cn=2,n=20

      174     4410    3               FPTWRSYSLOG = FPT_WRSYSLOG ;

   4410  6 000177   000100 100400                    MLR     fill='000'O
         6 000200   000000 000040 4                  ADSC9   FPT_WRSYSLOG             cn=0,n=32
         6 000201   200052 000040                    ADSC9   FPTWRSYSLOG,,AUTO        cn=0,n=32

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:41   
      175     4411    3               FPTWRSYSLOG.V_ = VECTOR(FPTWRSYSLOG.V) ;

   4411  6 000202   000001 235000 7                  LDA     1
         6 000203   200066 452500                    STP2    FPTWRSYSLOG+12,,AUTO
         6 000204   200066 236100                    LDQ     FPTWRSYSLOG+12,,AUTO
         6 000205   000056 036003                    ADLQ    46,DU
         6 000206   200052 757100                    STAQ    FPTWRSYSLOG,,AUTO

      176     4412    3               FPTWRSYSLOG.ENTRY_ = VECTOR(EL$DODCB) ;

   4412  6 000207   000002 235000 7                  LDA     2
         6 000210   200066 452500                    STP2    FPTWRSYSLOG+12,,AUTO
         6 000211   200066 236100                    LDQ     FPTWRSYSLOG+12,,AUTO
         6 000212   000042 036003                    ADLQ    34,DU
         6 000213   200054 757100                    STAQ    FPTWRSYSLOG+2,,AUTO

      177     4413    3               FPTWRSYSLOG.V.SIZE# = SIZEW(EL$DODCB) ;

   4413  6 000214   000010 235007                    LDA     8,DL
         6 000215   200060 755100                    STA     FPTWRSYSLOG+6,,AUTO

      178     4414    3               CALL M$WRSYSLOG (FPTWRSYSLOG) ALTRET(MON_ERR1);

   4414  6 000216   200052 630500                    EPPR0   FPTWRSYSLOG,,AUTO
         6 000217   470001 713400                    CLIMB   alt,+28673
         6 000220   400400 401760                    pmme    nvectors=2
         6 000221   000301 702000 6                  TSX2    MON_ERR1

      179     4415    3               RETURN;

   4415  6 000222   200062 221300                    LDX1  ! FPTWRSYSLOG+8,,AUTO
         6 000223   000001 702211                    TSX2  ! 1,X1

      180     4416    3             END;
      181     4417                  /*  ELSE check to see if we're in the initialization
      182     4418                      phase of TP.  If so, don't screech, just send a
      183     4419                      message to the system log as before
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:42   
      184     4420                  */
      185     4421    2           ELSE IF QQ_CMDBLK.ORIGIN = 2 /* ORIGIN_INIT */
              4421                    /* ORIGIN_INIT                */

   4421  6 000224   000007 220000 xsym               LDX0    QQ_CMDBLK+7
         6 000225   000002 100003                    CMPX0   2,DU
         6 000226   000301 601000 6                  TNZ     MON_ERR1

      186     4422    2             THEN
      187     4423    3               DO;

      188     4424    3                 EL$DODCB.PROCESSOR = 'TPA';

   4424  6 000227   040100 100400                    MLR     fill='040'O
         6 000230   000012 000003 4                  ADSC9   CODE_CGFILL+2            cn=0,n=3
         6 000231   200042 000012                    ADSC9   EL$DODCB,,AUTO           cn=0,n=10

      189     4425    3                 CALL BINCHAR(ERROR_CODE,B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE);

   4425  6 000232   000000 471500                    LDP1    0,,PR0
         6 000233   100102 236100                    LDQ     66,,PR1
         6 000234   000003 772000                    QRL     3
         6 000235   037777 376007                    ANQ     16383,DL
         6 000236   000000 235003                    LDA     0,DU
         6 000237   200066 757100                    STAQ    FPTWRSYSLOG+12,,AUTO
         6 000240   000000 301500                    BTD
         6 000241   200066 000010                    NDSC9   FPTWRSYSLOG+12,,AUTO     cn=0,s=lsgnf,sf=0,n=8
         6 000242   000142 030005 5                  NDSC9   ERROR_CODE               cn=0,s=nosgn,sf=0,n=5

      190     4426    3                 CALL INSERT(EL$DODCB.TXT, 0, 20, 'Init ERR.CODE: ',

   4426  6 000243   040100 100400                    MLR     fill='040'O
         6 000244   000020 000017 4                  ADSC9   CODE_CGFILL+8            cn=0,n=15
         6 000245   200044 400017                    ADSC9   EL$DODCB+2,,AUTO         cn=2,n=15
         6 000246   040100 100400                    MLR     fill='040'O
         6 000247   000142 000005 5                  ADSC9   ERROR_CODE               cn=0,n=5
         6 000250   200050 200005                    ADSC9   EL$DODCB+6,,AUTO         cn=1,n=5
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:43   

      191     4427    3                     ERROR_CODE);
      192     4428    3                 FPTWRSYSLOG = FPT_WRSYSLOG ;

   4428  6 000251   000100 100400                    MLR     fill='000'O
         6 000252   000000 000040 4                  ADSC9   FPT_WRSYSLOG             cn=0,n=32
         6 000253   200052 000040                    ADSC9   FPTWRSYSLOG,,AUTO        cn=0,n=32

      193     4429    3                 FPTWRSYSLOG.V_ = VECTOR(FPTWRSYSLOG.V) ;

   4429  6 000254   000001 235000 7                  LDA     1
         6 000255   200066 452500                    STP2    FPTWRSYSLOG+12,,AUTO
         6 000256   200066 236100                    LDQ     FPTWRSYSLOG+12,,AUTO
         6 000257   000056 036003                    ADLQ    46,DU
         6 000260   200052 757100                    STAQ    FPTWRSYSLOG,,AUTO

      194     4430    3                 FPTWRSYSLOG.ENTRY_ = VECTOR(EL$DODCB) ;

   4430  6 000261   000002 235000 7                  LDA     2
         6 000262   200066 452500                    STP2    FPTWRSYSLOG+12,,AUTO
         6 000263   200066 236100                    LDQ     FPTWRSYSLOG+12,,AUTO
         6 000264   000042 036003                    ADLQ    34,DU
         6 000265   200054 757100                    STAQ    FPTWRSYSLOG+2,,AUTO

      195     4431    3                 FPTWRSYSLOG.V.SIZE# = SIZEW(EL$DODCB) ;

   4431  6 000266   000010 235007                    LDA     8,DL
         6 000267   200060 755100                    STA     FPTWRSYSLOG+6,,AUTO

      196     4432    3                 CALL M$WRSYSLOG (FPTWRSYSLOG) ALTRET(MON_ERR1);

   4432  6 000270   200052 630500                    EPPR0   FPTWRSYSLOG,,AUTO
         6 000271   470001 713400                    CLIMB   alt,+28673
         6 000272   400400 401760                    pmme    nvectors=2
         6 000273   000301 702000 6                  TSX2    MON_ERR1

      197     4433    3                 QQ_GLOBAL.ERR = '0'B;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:44   

   4433  6 000274   000000 450000 xsym               STZ     QQ_GLOBAL

      198     4434    3                 CALL QQC$STOPTP('1'B);

   4434  6 000275   000003 630400 7                  EPPR0   3
         6 000276   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000277   000000 701000 xent               TSX1    QQC$STOPTP
         6 000300   000000 011000                    NOP     0

      199     4435    3               END;

      200     4436
      201     4437    2   MON_ERR1:
      202     4438    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4438  6 000301   000000 470400 xsym  MON_ERR1     LDP0    B$TCB$
         6 000302   000000 471500                    LDP1    0,,PR0
         6 000303   100102 236100                    LDQ     66,,PR1
         6 000304   000000 756000 xsym               STQ     QQ_GLOBAL

      203     4439    2           CALL QQC$SCREECH;

   4439  6 000305   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000306   000000 701000 xent               TSX1    QQC$SCREECH
         6 000307   000000 011000                    NOP     0

      204     4440    2   END TO_DODCB;

   4440  6 000310   200062 221300                    LDX1  ! FPTWRSYSLOG+8,,AUTO
         6 000311   000001 702211                    TSX2  ! 1,X1

      205     4441                %PAGE(ARG="TO_STATION",PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:45   
              4458    2   /***************************************************************************
              4459    2    *                                                                         *
              4460    2    *                                 TO_STATION                              *
              4461    2    *                                                                         *
              4462    2    ***************************************************************************/

      206     4466    1   TO_STATION:

   4466  6 000312   200062 741300       TO_STATION   STX1  ! FPTWRSYSLOG+8,,AUTO

      207     4467    1           PROC;
      208     4468
      209     4469    2           IF QQ_ERRMAP(ADDR(P_MSGBLK.ERRINFO.ERR(0))->ERR.ERR#)

   4469  6 000313   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000314   000006 236100                    LDQ     6,,PR0
         6 000315   000003 772000                    QRL     3
         6 000316   037777 376007                    ANQ     16383,DL
         6 000317   000000 066406                    CMPB    filb='0'B
         6 000320   000000 000001 xsym               BDSC    QQ_ERRMAP,Q              by=0,bit=0,n=1
         6 000321   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 000322   000325 600000 6                  TZE     s:4471

      210     4470    2           THEN WRITE_XACTION.FUNCTION='005';

   4470  6 000323   000024 236000 4                  LDQ     CODE_CGFILL+12
         6 000324   000102 552070 5                  STBQ    WRITE_XACTION,'70'O

      211     4471    2           IF P_MSGBLK.FLAGS.REPORT THEN

   4471  6 000325   000002 236100                    LDQ     2,,PR0
         6 000326   100000 316007                    CANQ    32768,DL
         6 000327   000336 600000 6                  TZE     s:4478

      212     4472    3             DO;

      213     4473    3               VLP_STATION_CG.CTL.LATCH# = '0'B;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:46   

   4473  6 000330   000004 236000 7                  LDQ     4
         6 000331   000240 356000 5                  ANSQ    VLP_STATION_CG+4

      214     4474    3               VLP_STATION_CG.MSGTYP# = 'MSGG';

   4474  6 000332   000025 235000 4                  LDA     CODE_CGFILL+13
         6 000333   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000334   000236 757000 5                  STAQ    VLP_STATION_CG+2

      215     4475    3             END;

   4475  6 000335   000343 710000 6                  TRA     s:4482

      216     4476    2           ELSE
      217     4477    3             DO;

      218     4478    3               VLP_STATION_CG.CTL.LATCH# = '1'B;

   4478  6 000336   200000 236003                    LDQ     65536,DU
         6 000337   000240 256000 5                  ORSQ    VLP_STATION_CG+4

      219     4479    3               VLP_STATION_CG.MSGTYP# = ' ';

   4479  6 000340   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000341   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000342   000236 757000 5                  STAQ    VLP_STATION_CG+2

      220     4480    3             END;

      221     4481
      222     4482    2           WILD_FLAG = '0'B;

   4482  6 000343   200040 450100                    STZ     WILD_FLAG,,AUTO

      223     4483
      224     4484    2           CALL INDEX(POS, '?', P_MSGBLK.ID) ALTRET(NO_Q);
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:47   

   4484  6 000344   000000 124500                    SCM     mask='000'O
         6 000345   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000346   000005 000001 7                  ADSC9   5                        cn=0,n=1
         6 000347   200007 000100                    ARG     POS,,AUTO
         6 000350   000353 606400 6                  TTN     NO_Q

      225     4485    2           WILD_FLAG = '1'B;

   4485  6 000351   400000 236003                    LDQ     -131072,DU
         6 000352   200040 756100                    STQ     WILD_FLAG,,AUTO

      226     4486
      227     4487    2   NO_Q:
      228     4488    2           IF NOT WILD_FLAG THEN

   4488  6 000353   200040 234100       NO_Q         SZN     WILD_FLAG,,AUTO
         6 000354   000367 604000 6                  TMI     s:4496

      229     4489    3             DO;

      230     4490    3               VLP_STATION_CG.STATION# = P_MSGBLK.ID;

   4490  6 000355   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000356   040000 100500                    MLR     fill='040'O
         6 000357   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000360   000234 000010 5                  ADSC9   VLP_STATION_CG           cn=0,n=8

      231     4491    3               CALL SEND_TO_STATION;

   4491  6 000361   000423 701000 6                  TSX1    SEND_TO_STATION
         6 000362   000000 011000                    NOP     0

      232     4492    3               P_MSGBLK.FLAGS.MSG_SENT = '1'B;

   4492  6 000363   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000364   040000 236007                    LDQ     16384,DL
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:48   
         6 000365   000002 256100                    ORSQ    2,,PR0

      233     4493    3             END;

   4493  6 000366   000421 710000 6                  TRA     s:4507

      234     4494    2           ELSE
      235     4495    3             DO;

      236     4496    4               DO K = 1 TO QQ_GLOBAL.STATION_CNT;

   4496  6 000367   000001 235007                    LDA     1,DL
         6 000370   200011 755100                    STA     K,,AUTO
         6 000371   000415 710000 6                  TRA     LOOP+1

      237     4497    4                 S$ = PINCRW(QQ_GLOBAL.STATION$, (K - 1) * SIZEW(TP$STATION));

   4497  6 000372   200011 236100                    LDQ     K,,AUTO
         6 000373   000032 402003                    MPY     26,DU
         6 000374   000032 136003                    SBLQ    26,DU
         6 000375   000151 036000 xsym               ADLQ    QQ_GLOBAL+105
         6 000376   200004 756100                    STQ     S$,,AUTO

      238     4498    4                 CALL QQC$WILD_COMP(P_MSGBLK.ID, TP$STATION.ID) ALTRET(LOOP);

   4498  6 000377   200003 630500                    EPPR0   @P_MSGBLK,,AUTO
         6 000400   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000401   000000 701000 xent               TSX1    QQC$WILD_COMP
         6 000402   000414 702000 6                  TSX2    LOOP

      239     4499    4                 VLP_STATION_CG.STATION# = TP$STATION.ID;

   4499  6 000403   200004 470500                    LDP0    S$,,AUTO
         6 000404   040000 100500                    MLR     fill='040'O
         6 000405   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000406   000234 000010 5                  ADSC9   VLP_STATION_CG           cn=0,n=8

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:49   
      240     4500    4                 CALL SEND_TO_STATION;

   4500  6 000407   000423 701000 6                  TSX1    SEND_TO_STATION
         6 000410   000000 011000                    NOP     0

      241     4501    4                 P_MSGBLK.FLAGS.MSG_SENT = '1'B;

   4501  6 000411   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000412   040000 236007                    LDQ     16384,DL
         6 000413   000002 256100                    ORSQ    2,,PR0

      242     4502
      243     4503    4   LOOP:
      244     4504    4               END;

   4504  6 000414   200011 054100       LOOP         AOS     K,,AUTO
         6 000415   000032 236000 xsym               LDQ     QQ_GLOBAL+26
         6 000416   000372 604000 6                  TMI     s:4497
         6 000417   200011 116100                    CMPQ    K,,AUTO
         6 000420   000372 605000 6                  TPL     s:4497

      245     4505    3             END;

      246     4506
      247     4507    2           RETURN;

   4507  6 000421   200062 221300                    LDX1  ! FPTWRSYSLOG+8,,AUTO
         6 000422   000001 702211                    TSX2  ! 1,X1

      248     4508
      249     4509    2   END TO_STATION;
      250     4510                %PAGE(ARG="SEND_TO_STATION", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:50   
              4527    2   /***************************************************************************
              4528    2    *                                                                         *
              4529    2    *                              SEND_TO_STATION                            *
              4530    2    *                                                                         *
              4531    2    ***************************************************************************/

      251     4535    1   SEND_TO_STATION:

   4535  6 000423   200064 741300       SEND_TO_STA* STX1  ! FPTWRSYSLOG+10,,AUTO

      252     4536    1           PROC;
      253     4537
      254     4538    2           CHAR_STRING_SIZE = 79;

   4538  6 000424   000117 235007                    LDA     79,DL
         6 000425   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      255     4539    2           NUM_LINES = (P_MSGBLK.ARS +79) / 80;

   4539  6 000426   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000427   000003 236100                    LDQ     3,,PR0
         6 000430   000022 772000                    QRL     18
         6 000431   000117 036007                    ADLQ    79,DL
         6 000432   000120 506007                    DIV     80,DL
         6 000433   200012 756100                    STQ     NUM_LINES,,AUTO

      256     4540    2           P$ = P_MSGBLK.TEXT$;

   4540  6 000434   000005 236100                    LDQ     5,,PR0
         6 000435   200005 756100                    STQ     P$,,AUTO

      257     4541    2           CHARS_LEFT = P_MSGBLK.ARS;

   4541  6 000436   000003 236100                    LDQ     3,,PR0
         6 000437   000022 772000                    QRL     18
         6 000440   200006 756100                    STQ     CHARS_LEFT,,AUTO

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:51   
      258     4542
      259     4543    3           DO I = 1 TO NUM_LINES;

   4543  6 000441   000001 235007                    LDA     1,DL
         6 000442   200010 755100                    STA     I,,AUTO
         6 000443   000471 710000 6                  TRA     s:4554+1

      260     4544    3             IF CHARS_LEFT < 80 THEN

   4544  6 000444   200006 235100                    LDA     CHARS_LEFT,,AUTO
         6 000445   000120 115007                    CMPA    80,DL
         6 000446   000450 605000 6                  TPL     s:4549

      261     4545    4               DO;

      262     4546    4                 CHAR_STRING_SIZE = CHARS_LEFT;

   4546  6 000447   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      263     4547    4               END;

      264     4548
      265     4549    3             WRITE_XACTION.TEXT = P$ -> CHAR$STRING;

   4549  6 000450   200005 470500                    LDP0    P$,,AUTO
         6 000451   200013 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         6 000452   040000 100540                    MLR     fill='040'O
         6 000453   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         6 000454   000102 600120 5                  ADSC9   WRITE_XACTION            cn=3,n=80

      266     4550    3             CALL M$WRITE(FPT_WRITE_CG) ALTRET(MON_ERR);

   4550  6 000455   000174 630400 5                  EPPR0   FPT_WRITE_CG
         6 000456   440001 713400                    CLIMB   alt,write
         6 000457   401400 401760                    pmme    nvectors=4
         6 000460   000476 702000 6                  TSX2    MON_ERR

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:52   
      267     4551    3             CHARS_LEFT = CHARS_LEFT - 80;

   4551  6 000461   000120 336007                    LCQ     80,DL
         6 000462   200006 056100                    ASQ     CHARS_LEFT,,AUTO

      268     4552    3             P$ = PINCRC(P$, 80);

   4552  6 000463   200005 236100                    LDQ     P$,,AUTO
         6 000464   000024 036003                    ADLQ    20,DU
         6 000465   200005 756100                    STQ     P$,,AUTO

      269     4553    3             WRITE_XACTION.FUNCTION = '002';

   4553  6 000466   000026 236000 4                  LDQ     CODE_CGFILL+14
         6 000467   000102 552070 5                  STBQ    WRITE_XACTION,'70'O

      270     4554    3           END;

   4554  6 000470   200010 054100                    AOS     I,,AUTO
         6 000471   200010 236100                    LDQ     I,,AUTO
         6 000472   200012 116100                    CMPQ    NUM_LINES,,AUTO
         6 000473   000444 604400 6                  TMOZ    s:4544

      271     4555
      272     4556    2           RETURN;

   4556  6 000474   200064 221300                    LDX1  ! FPTWRSYSLOG+10,,AUTO
         6 000475   000001 702211                    TSX2  ! 1,X1

      273     4557
      274     4558    2   MON_ERR:
      275     4559    2           CALL QQC$BLDMSG_ERRBLK(P_MSGBLK);

   4559  6 000476   200003 630500       MON_ERR      EPPR0   @P_MSGBLK,,AUTO
         6 000477   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000500   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         6 000501   000000 011000                    NOP     0
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:53   

      276     4560    2           P_MSGBLK.ERRINFO.ERR(0) = CODE_CGFILL;

   4560  6 000502   000010 236000 4                  LDQ     CODE_CGFILL
         6 000503   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000504   000006 756100                    STQ     6,,PR0

      277     4561    2           QQ_GLOBAL.ERROR_CNT = QQ_GLOBAL.ERROR_CNT - 1;

   4561  6 000505   000040 235000 xsym               LDA     QQ_GLOBAL+32
         6 000506   000001 135007                    SBLA    1,DL
         6 000507   000040 755000 xsym               STA     QQ_GLOBAL+32

      278     4562    2           CALL QQC$BLDMSG(P_MSGBLK);

   4562  6 000510   200003 630500                    EPPR0   @P_MSGBLK,,AUTO
         6 000511   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000512   000000 701000 xent               TSX1    QQC$BLDMSG
         6 000513   000000 011000                    NOP     0

      279     4563    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4563  6 000514   000000 470400 xsym               LDP0    B$TCB$
         6 000515   000000 471500                    LDP1    0,,PR0
         6 000516   100102 236100                    LDQ     66,,PR1
         6 000517   000000 756000 xsym               STQ     QQ_GLOBAL

      280     4564    2           CALL QQC$SCREECH;

   4564  6 000520   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000521   000000 701000 xent               TSX1    QQC$SCREECH
         6 000522   000000 011000                    NOP     0

      281     4565
      282     4566    2   END SEND_TO_STATION;

   4566  6 000523   200064 221300                    LDX1  ! FPTWRSYSLOG+10,,AUTO
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:54   
         6 000524   000001 702211                    TSX2  ! 1,X1

      283     4567                %PAGE(ARG="TO_MCT", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:55   
              4584    2   /***************************************************************************
              4585    2    *                                                                         *
              4586    2    *                                   TO_MCT                                *
              4587    2    *                                                                         *
              4588    2    ***************************************************************************/

      284     4592    1   TO_MCT:

   4592  6 000525   200062 741300       TO_MCT       STX1  ! FPTWRSYSLOG+8,,AUTO

      285     4593    1           PROC;
      286     4594
      287     4595    2           VLP_STATION_CG.CTL.LATCH# = '0'B;

   4595  6 000526   000004 236000 7                  LDQ     4
         6 000527   000240 356000 5                  ANSQ    VLP_STATION_CG+4

      288     4596    2           VLP_STATION_CG.MSGTYP# = 'MSGG';

   4596  6 000530   000025 235000 4                  LDA     CODE_CGFILL+13
         6 000531   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000532   000236 757000 5                  STAQ    VLP_STATION_CG+2

      289     4597
      290     4598    3           DO K = 1 TO QQ_GLOBAL.STATION_CNT;

   4598  6 000533   000001 235007                    LDA     1,DL
         6 000534   200011 755100                    STA     K,,AUTO
         6 000535   000570 710000 6                  TRA     s:4608+1

      291     4599    3             S$ = PINCRW(QQ_GLOBAL.STATION$, (K - 1) * SIZEW(TP$STATION));

   4599  6 000536   200011 236100                    LDQ     K,,AUTO
         6 000537   000032 402003                    MPY     26,DU
         6 000540   000032 136003                    SBLQ    26,DU
         6 000541   000151 036000 xsym               ADLQ    QQ_GLOBAL+105
         6 000542   200004 756100                    STQ     S$,,AUTO
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:56   

      292     4600    3             IF TP$STATION.FLAGS.MCT AND

   4600  6 000543   200004 470500                    LDP0    S$,,AUTO
         6 000544   000022 236100                    LDQ     18,,PR0
         6 000545   200000 316003                    CANQ    65536,DU
         6 000546   000567 600000 6                  TZE     s:4608
         6 000547   200003 471500                    LDP1    @P_MSGBLK,,AUTO
         6 000550   100002 236100                    LDQ     2,,PR1
         6 000551   000100 316003                    CANQ    64,DU
         6 000552   000557 600000 6                  TZE     s:4604
         6 000553   040100 106500                    CMPC    fill='040'O
         6 000554   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 000555   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000556   000567 600000 6                  TZE     s:4608

      293     4601    3                 NOT (P_MSGBLK.FLAGS.DEST.STATION AND P_MSGBLK.ID =
      294     4602    3                 TP$STATION.ID) THEN
      295     4603    4               DO;

      296     4604    4                 P_MSGBLK.FLAGS.MSG_SENT = '1'B;

   4604  6 000557   040000 236007                    LDQ     16384,DL
         6 000560   100002 256100                    ORSQ    2,,PR1

      297     4605    4                 VLP_STATION_CG.STATION# = TP$STATION.ID;

   4605  6 000561   200004 470500                    LDP0    S$,,AUTO
         6 000562   040000 100500                    MLR     fill='040'O
         6 000563   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000564   000234 000010 5                  ADSC9   VLP_STATION_CG           cn=0,n=8

      298     4606    4                 CALL SEND_TO_STATION;

   4606  6 000565   000423 701000 6                  TSX1    SEND_TO_STATION
         6 000566   000000 011000                    NOP     0

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:57   
      299     4607    4               END;

      300     4608    3           END;

   4608  6 000567   200011 054100                    AOS     K,,AUTO
         6 000570   000032 236000 xsym               LDQ     QQ_GLOBAL+26
         6 000571   000536 604000 6                  TMI     s:4599
         6 000572   200011 116100                    CMPQ    K,,AUTO
         6 000573   000536 605000 6                  TPL     s:4599

      301     4609
      302     4610    2           IF QQ_GLOBAL.MCTID ~= ' ' THEN

   4610  6 000574   040000 106400                    CMPC    fill='040'O
         6 000575   000323 000010 xsym               ADSC9   QQ_GLOBAL+211            cn=0,n=8
         6 000576   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000577   000633 600000 6                  TZE     s:4624

      303     4611    3             DO;

      304     4612    3               CALL QQC$FINDSTA(QQ_GLOBAL.MCTID, S$, FOUND_FLAG);

   4612  6 000600   200041 630500                    EPPR0   FOUND_FLAG,,AUTO
         6 000601   200070 450500                    STP0    FPTWRSYSLOG+14,,AUTO
         6 000602   200004 631500                    EPPR1   S$,,AUTO
         6 000603   200067 451500                    STP1    FPTWRSYSLOG+13,,AUTO
         6 000604   000006 236000 7                  LDQ     6
         6 000605   200066 756100                    STQ     FPTWRSYSLOG+12,,AUTO
         6 000606   200066 630500                    EPPR0   FPTWRSYSLOG+12,,AUTO
         6 000607   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000610   000000 701000 xent               TSX1    QQC$FINDSTA
         6 000611   000000 011000                    NOP     0

      305     4613    3               IF NOT FOUND_FLAG AND

   4613  6 000612   200041 234100                    SZN     FOUND_FLAG,,AUTO
         6 000613   000633 604000 6                  TMI     s:4624
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:58   
         6 000614   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000615   000002 236100                    LDQ     2,,PR0
         6 000616   000100 316003                    CANQ    64,DU
         6 000617   000624 600000 6                  TZE     s:4617
         6 000620   040000 106500                    CMPC    fill='040'O
         6 000621   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000622   000323 000010 xsym               ADSC9   QQ_GLOBAL+211            cn=0,n=8
         6 000623   000633 600000 6                  TZE     s:4624

      306     4614    3                   NOT (P_MSGBLK.FLAGS.DEST.STATION AND P_MSGBLK.ID =
      307     4615    3                   QQ_GLOBAL.MCTID) THEN
      308     4616    4                 DO;

      309     4617    4                   P_MSGBLK.FLAGS.MSG_SENT = '1'B;

   4617  6 000624   040000 236007                    LDQ     16384,DL
         6 000625   000002 256100                    ORSQ    2,,PR0

      310     4618    4                   VLP_STATION_CG.STATION# = QQ_GLOBAL.MCTID;

   4618  6 000626   040000 100400                    MLR     fill='040'O
         6 000627   000323 000010 xsym               ADSC9   QQ_GLOBAL+211            cn=0,n=8
         6 000630   000234 000010 5                  ADSC9   VLP_STATION_CG           cn=0,n=8

      311     4619    4                   CALL SEND_TO_STATION;

   4619  6 000631   000423 701000 6                  TSX1    SEND_TO_STATION
         6 000632   000000 011000                    NOP     0

      312     4620    4                 END;

      313     4621    3             END;

      314     4622
      315     4623        %EJECT;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:59   
      316     4624    2           IF QQ_GLOBAL.LOG AND

   4624  6 000633   000005 234000 xsym               SZN     QQ_GLOBAL+5
         6 000634   000723 605000 6                  TPL     s:4652
         6 000635   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000636   000002 236100                    LDQ     2,,PR0
         6 000637   020000 316007                    CANQ    8192,DL
         6 000640   000723 601000 6                  TNZ     s:4652

      317     4625    2               NOT P_MSGBLK.FLAGS.INHIB_CSCG THEN
      318     4626    3             DO;

      319     4627    3               HDR_TO_MCT.INSTANCE = QQ_GLOBAL.INSTANCE_NAME;

   4627  6 000641   040000 100400                    MLR     fill='040'O
         6 000642   000325 000010 xsym               ADSC9   QQ_GLOBAL+213            cn=0,n=8
         6 000643   000005 400010 5                  ADSC9   HDR_TO_MCT+5             cn=2,n=8

      320     4628    3               CHAR_STRING_SIZE = 79;

   4628  6 000644   000117 235007                    LDA     79,DL
         6 000645   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      321     4629    3               NUM_LINES = (P_MSGBLK.ARS + 79) / 80;

   4629  6 000646   000003 236100                    LDQ     3,,PR0
         6 000647   000022 772000                    QRL     18
         6 000650   000117 036007                    ADLQ    79,DL
         6 000651   000120 506007                    DIV     80,DL
         6 000652   200012 756100                    STQ     NUM_LINES,,AUTO

      322     4630    3               P$ = P_MSGBLK.TEXT$;

   4630  6 000653   000005 236100                    LDQ     5,,PR0
         6 000654   200005 756100                    STQ     P$,,AUTO

      323     4631    3               CHARS_LEFT = P_MSGBLK.ARS;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:60   

   4631  6 000655   000003 236100                    LDQ     3,,PR0
         6 000656   000022 772000                    QRL     18
         6 000657   200006 756100                    STQ     CHARS_LEFT,,AUTO

      324     4632    3               HDR_TO_MCT.LEN(1) = 79;

   4632  6 000660   000117 236003                    LDQ     79,DU
         6 000661   000005 552020 5                  STBQ    HDR_TO_MCT+5,'20'O

      325     4633    3               P_MSGBLK.TEXT$ = ADDR(HDR_TO_MCT);

   4633  6 000662   000007 236000 7                  LDQ     7
         6 000663   000005 756100                    STQ     5,,PR0

      326     4634    3               P_MSGBLK.ARS = SIZEC(HDR_TO_MCT);

   4634  6 000664   000202 220003                    LDX0    130,DU
         6 000665   000003 740100                    STX0    3,,PR0

      327     4635
      328     4636    4               DO I = 1 TO NUM_LINES;

   4636  6 000666   000001 235007                    LDA     1,DL
         6 000667   200010 755100                    STA     I,,AUTO
         6 000670   000715 710000 6                  TRA     s:4648+1

      329     4637    4                 IF CHARS_LEFT < 80 THEN

   4637  6 000671   200006 235100                    LDA     CHARS_LEFT,,AUTO
         6 000672   000120 115007                    CMPA    80,DL
         6 000673   000700 605000 6                  TPL     s:4642

      330     4638    5                   DO;

      331     4639    5                     CHAR_STRING_SIZE = CHARS_LEFT;

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:61   
   4639  6 000674   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      332     4640    5                     HDR_TO_MCT.LEN(1) = CHARS_LEFT;

   4640  6 000675   200006 236100                    LDQ     CHARS_LEFT,,AUTO
         6 000676   000022 736000                    QLS     18
         6 000677   000005 552020 5                  STBQ    HDR_TO_MCT+5,'20'O

      333     4641    5                   END;

      334     4642    4                 HDR_TO_MCT.TEXT = P$ -> CHAR$STRING;

   4642  6 000700   200005 470500                    LDP0    P$,,AUTO
         6 000701   200013 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         6 000702   040000 100540                    MLR     fill='040'O
         6 000703   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         6 000704   000007 400144 5                  ADSC9   HDR_TO_MCT+7             cn=2,n=100

      335     4643
      336     4644    4                 CALL TO_CSCG;

   4644  6 000705   001020 701000 6                  TSX1    TO_CSCG
         6 000706   000000 011000                    NOP     0

      337     4645
      338     4646    4                 CHARS_LEFT = CHARS_LEFT - 80;

   4646  6 000707   000120 336007                    LCQ     80,DL
         6 000710   200006 056100                    ASQ     CHARS_LEFT,,AUTO

      339     4647    4                 P$ = PINCRC(P$, 80);

   4647  6 000711   200005 236100                    LDQ     P$,,AUTO
         6 000712   000024 036003                    ADLQ    20,DU
         6 000713   200005 756100                    STQ     P$,,AUTO

      340     4648    4               END;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:62   

   4648  6 000714   200010 054100                    AOS     I,,AUTO
         6 000715   200010 236100                    LDQ     I,,AUTO
         6 000716   200012 116100                    CMPQ    NUM_LINES,,AUTO
         6 000717   000671 604400 6                  TMOZ    s:4637

      341     4649    3               P_MSGBLK.FLAGS.MSG_SENT = '1'B;

   4649  6 000720   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000721   040000 236007                    LDQ     16384,DL
         6 000722   000002 256100                    ORSQ    2,,PR0

      342     4650    3             END;

      343     4651
      344     4652    2           RETURN;

   4652  6 000723   200062 221300                    LDX1  ! FPTWRSYSLOG+8,,AUTO
         6 000724   000001 702211                    TSX2  ! 1,X1

      345     4653
      346     4654    2   END TO_MCT;
      347     4655                %PAGE(ARG="TO_ONCONSOLE", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:63   
              4672    2   /***************************************************************************
              4673    2    *                                                                         *
              4674    2    *                                TO_ONCONSOLE                             *
              4675    2    *                                                                         *
              4676    2    ***************************************************************************/

      348     4680    1   TO_ONECONSOLE:

   4680  6 000725   200062 741300       TO_ONECONSO* STX1  ! FPTWRSYSLOG+8,,AUTO

      349     4681    1           PROC;
      350     4682
      351     4683    2           HDR_TO_ONECONSOLE.CADDR = P_MSGBLK.CADDR;

   4683  6 000726   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 000727   000100 100500                    MLR     fill='000'O
         6 000730   000003 600002                    ADSC9   3,,PR0                   cn=3,n=2
         6 000731   200066 000004                    ADSC9   FPTWRSYSLOG+12,,AUTO     cn=0,n=4
         6 000732   200066 220100                    LDX0    FPTWRSYSLOG+12,,AUTO
         6 000733   000041 740000 5                  STX0    HDR_TO_ONECONSOLE

      352     4684    2           HDR_TO_ONECONSOLE.INSTANCE = QQ_GLOBAL.INSTANCE_NAME;

   4684  6 000734   040000 100400                    MLR     fill='040'O
         6 000735   000325 000010 xsym               ADSC9   QQ_GLOBAL+213            cn=0,n=8
         6 000736   000046 400010 5                  ADSC9   HDR_TO_ONECONSOLE+5      cn=2,n=8

      353     4685    2           CHAR_STRING_SIZE = 79;

   4685  6 000737   000117 235007                    LDA     79,DL
         6 000740   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      354     4686    2           NUM_LINES = (P_MSGBLK.ARS + 79) / 80;

   4686  6 000741   000003 236100                    LDQ     3,,PR0
         6 000742   000022 772000                    QRL     18
         6 000743   000117 036007                    ADLQ    79,DL
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:64   
         6 000744   000120 506007                    DIV     80,DL
         6 000745   200012 756100                    STQ     NUM_LINES,,AUTO

      355     4687    2           P$ = P_MSGBLK.TEXT$;

   4687  6 000746   000005 236100                    LDQ     5,,PR0
         6 000747   200005 756100                    STQ     P$,,AUTO

      356     4688    2           CHARS_LEFT = P_MSGBLK.ARS;

   4688  6 000750   000003 236100                    LDQ     3,,PR0
         6 000751   000022 772000                    QRL     18
         6 000752   200006 756100                    STQ     CHARS_LEFT,,AUTO

      357     4689    2           HDR_TO_ONECONSOLE.LEN(1) = 79;

   4689  6 000753   000117 236003                    LDQ     79,DU
         6 000754   000046 552020 5                  STBQ    HDR_TO_ONECONSOLE+5,'20'O

      358     4690    2           P_MSGBLK.TEXT$ = ADDR(HDR_TO_ONECONSOLE);

   4690  6 000755   000010 236000 7                  LDQ     8
         6 000756   000005 756100                    STQ     5,,PR0

      359     4691    2           P_MSGBLK.ARS = SIZEC(HDR_TO_ONECONSOLE);

   4691  6 000757   000202 220003                    LDX0    130,DU
         6 000760   000003 740100                    STX0    3,,PR0

      360     4692
      361     4693    3           DO I = 1 TO NUM_LINES;

   4693  6 000761   000001 235007                    LDA     1,DL
         6 000762   200010 755100                    STA     I,,AUTO
         6 000763   001010 710000 6                  TRA     s:4705+1

      362     4694    3             IF CHARS_LEFT < 80 THEN
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:65   

   4694  6 000764   200006 235100                    LDA     CHARS_LEFT,,AUTO
         6 000765   000120 115007                    CMPA    80,DL
         6 000766   000773 605000 6                  TPL     s:4699

      363     4695    4               DO;

      364     4696    4                 CHAR_STRING_SIZE = CHARS_LEFT;

   4696  6 000767   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      365     4697    4                 HDR_TO_ONECONSOLE.LEN(1) = CHARS_LEFT;

   4697  6 000770   200006 236100                    LDQ     CHARS_LEFT,,AUTO
         6 000771   000022 736000                    QLS     18
         6 000772   000046 552020 5                  STBQ    HDR_TO_ONECONSOLE+5,'20'O

      366     4698    4               END;

      367     4699    3             HDR_TO_ONECONSOLE.TEXT = P$ -> CHAR$STRING;

   4699  6 000773   200005 470500                    LDP0    P$,,AUTO
         6 000774   200013 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         6 000775   040000 100540                    MLR     fill='040'O
         6 000776   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         6 000777   000050 400144 5                  ADSC9   HDR_TO_ONECONSOLE+7      cn=2,n=100

      368     4700
      369     4701    3             CALL TO_CSCG;

   4701  6 001000   001020 701000 6                  TSX1    TO_CSCG
         6 001001   000000 011000                    NOP     0

      370     4702
      371     4703    3             CHARS_LEFT = CHARS_LEFT - 80;

   4703  6 001002   000120 336007                    LCQ     80,DL
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:66   
         6 001003   200006 056100                    ASQ     CHARS_LEFT,,AUTO

      372     4704    3             P$ = PINCRC(P$, 80);

   4704  6 001004   200005 236100                    LDQ     P$,,AUTO
         6 001005   000024 036003                    ADLQ    20,DU
         6 001006   200005 756100                    STQ     P$,,AUTO

      373     4705    3           END;

   4705  6 001007   200010 054100                    AOS     I,,AUTO
         6 001010   200010 236100                    LDQ     I,,AUTO
         6 001011   200012 116100                    CMPQ    NUM_LINES,,AUTO
         6 001012   000764 604400 6                  TMOZ    s:4694

      374     4706
      375     4707    2           P_MSGBLK.FLAGS.MSG_SENT = '1'B;

   4707  6 001013   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 001014   040000 236007                    LDQ     16384,DL
         6 001015   000002 256100                    ORSQ    2,,PR0

      376     4708
      377     4709    2           RETURN;

   4709  6 001016   200062 221300                    LDX1  ! FPTWRSYSLOG+8,,AUTO
         6 001017   000001 702211                    TSX2  ! 1,X1

      378     4710
      379     4711    2   END TO_ONECONSOLE;
      380     4712                %PAGE(ARG="TO_CSCG", PAGE=YES);

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:67   
              4729    2   /***************************************************************************
              4730    2    *                                                                         *
              4731    2    *                                  TO_CSCG                                *
              4732    2    *                                                                         *
              4733    2    ***************************************************************************/

      381     4737    1   TO_CSCG:

   4737  6 001020   200064 741300       TO_CSCG      STX1  ! FPTWRSYSLOG+10,,AUTO

      382     4738    1           PROC;
      383     4739
      384     4740    2           FPT_WRITE_CSCG.BUF_.BUF$ = P_MSGBLK.TEXT$;

   4740  6 001021   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 001022   000005 236100                    LDQ     5,,PR0
         6 001023   000165 756000 5                  STQ     FPT_WRITE_CSCG+5

      385     4741    2           FPT_WRITE_CSCG.BUF_.BOUND = P_MSGBLK.ARS - 1 ;

   4741  6 001024   000003 236100                    LDQ     3,,PR0
         6 001025   000022 772000                    QRL     18
         6 001026   000001 136007                    SBLQ    1,DL
         6 001027   000020 736000                    QLS     16
         6 001030   000164 676000 5                  ERQ     FPT_WRITE_CSCG+4
         6 001031   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001032   000164 656000 5                  ERSQ    FPT_WRITE_CSCG+4

      386     4742    2           CALL M$WRITE(FPT_WRITE_CSCG) ALTRET(MON_ERR);

   4742  6 001033   000160 630400 5                  EPPR0   FPT_WRITE_CSCG
         6 001034   440001 713400                    CLIMB   alt,write
         6 001035   401400 401760                    pmme    nvectors=4
         6 001036   001044 702000 6                  TSX2    MON_ERR

      387     4743
      388     4744    2           P_MSGBLK.FLAGS.MSG_SENT = '1'B;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:68   

   4744  6 001037   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         6 001040   040000 236007                    LDQ     16384,DL
         6 001041   000002 256100                    ORSQ    2,,PR0

      389     4745
      390     4746    2           RETURN;

   4746  6 001042   200064 221300                    LDX1  ! FPTWRSYSLOG+10,,AUTO
         6 001043   000001 702211                    TSX2  ! 1,X1

      391     4747
      392     4748    2   MON_ERR:
      393     4749    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4749  6 001044   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         6 001045   000000 471500                    LDP1    0,,PR0
         6 001046   100102 236100                    LDQ     66,,PR1
         6 001047   000000 756000 xsym               STQ     QQ_GLOBAL

      394     4750    2           CALL QQC$SCREECH;

   4750  6 001050   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 001051   000000 701000 xent               TSX1    QQC$SCREECH
         6 001052   000000 011000                    NOP     0

      395     4751
      396     4752    2   END TO_CSCG;

   4752  6 001053   200064 221300                    LDX1  ! FPTWRSYSLOG+10,,AUTO
         6 001054   000001 702211                    TSX2  ! 1,X1

      397     4753        %EJECT;
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:69   
      398     4754    1   TO_HISTORY:

   4754  6 001055   200062 741300       TO_HISTORY   STX1  ! FPTWRSYSLOG+8,,AUTO

      399     4755    1           PROC;
      400     4756    2           RETURN;

   4756  6 001056   000001 702211                    TSX2  ! 1,X1
      401     4757    2   END TO_HISTORY;
      402     4758    1   END QQC$SNDMSG;

PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:70   
--  Include file information  --

   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$SNDMSG.
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:71   

 **** Variables and constants ****

  ****  Section 004 RoData QQC$SNDMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/b STRC        r     1 CODE_CGFILL                0-0-0/d STRC(288)   r     1 FPT_WRSYSLOG

  ****  Section 005  Data  QQC$SNDMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   132-0-0/c CHAR(10)    r     1 DATEBUF                  142-0-0/c CHAR(5)     r     1 ERROR_CODE
   210-0-0/d STRC(432)   r     1 FPT_TIME                 174-0-0/d STRC(432)   r     1 FPT_WRITE_CG
   160-0-0/d STRC(432)   r     1 FPT_WRITE_CSCG           144-0-0/d STRC(432)   r     1 FPT_WRITE_SEQ
     0-0-0/c STRC(1170)  r     1 HDR_TO_MCT                41-0-0/c STRC(1170)  r     1 HDR_TO_ONECONSOLE
   135-0-0/c CHAR(20)    r     1 SAVE_TIMESTAMP           127-0-0/c CHAR(11)    r     1 TIMEBUF
   234-0-0/w STRC(288)   r     1 VLP_STATION_CG           224-0-0/w STRC(288)   r     1 VLP_STATION_CSCG
   102-0-0/c STRC(747)   r     1 WRITE_XACTION

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_MSGBLK                  6-0-0/w SBIN        r     1 CHARS_LEFT
    13-0-0/w SBIN        r     1 CHAR_STRING_SIZE          42-0-0/w STRC(270)   r     1 EL$DODCB
    41-0-0/w BIT         r     1 FOUND_FLAG                52-0-0/d STRC(288)   r     1 FPTWRSYSLOG
    10-0-0/w SBIN        r     1 I                         11-0-0/w SBIN        r     1 K
    12-0-0/w SBIN        r     1 NUM_LINES                 14-0-0/c STRC(720)   r     1 OUTPUT_LINE
     5-0-0/w PTR         r     1 P$                         7-0-0/w SBIN        r     1 POS
    *0-0-0/w STRC(738)   r     1 P_MSGBLK                   4-0-0/w PTR         r     1 S$
    40-0-0/w BIT         r     1 WILD_FLAG

  ****  SYMREF variables  ****
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:72   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(315)   r     1 QQ_CMDBLK
     0-0-0/b BIT         r     1 QQ_ERRMAP(0:511)
     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c ACHR        r     1 CHAR$STRING                0-0-0/w STRC        r     1 ERR
     0-0-0N  NULL        r     1 M$CG                       0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$DO                       0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQC$SNDMSG requires 559 words for executable code.
   Procedure QQC$SNDMSG requires 58 words of local(AUTO) storage.

    No errors detected in file QQC$SNDMSG.:E05TSI    .
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:73   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:74   
          MINI XREF LISTING

B$ALT.CODE
      3787**DCL      3787--REDEF    3788--REDEF    3788--REDEF
B$ALT.ERR
      3788**DCL      4438>>ASSIGN   4563>>ASSIGN   4749>>ASSIGN
B$ALT.ERR.CODE
      3789**DCL      4406>>IF       4425>>CALLBLT
B$ALT.ERR.ERR#
      3789**DCL      3789--REDEF
B$ALT.EVID
      3788**DCL      3788--REDEF    3788--REDEF
B$TCB.ALT$
      3783**DCL      4406>>IF       4425>>CALLBLT  4438>>ASSIGN   4563>>ASSIGN   4749>>ASSIGN
B$TCB$
      3686**DCL      4406>>IF       4425>>CALLBLT  4438>>ASSIGN   4563>>ASSIGN   4749>>ASSIGN
CHAR$STRING
      3780**DCL      4399>>ASSIGN   4549>>ASSIGN   4642>>ASSIGN   4699>>ASSIGN
CHARS_LEFT
      4006**DCL      4380<<ASSIGN   4395>>IF       4397>>ASSIGN   4401<<ASSIGN   4401>>ASSIGN   4541<<ASSIGN
      4544>>IF       4546>>ASSIGN   4551<<ASSIGN   4551>>ASSIGN   4631<<ASSIGN   4637>>IF       4639>>ASSIGN
      4640>>ASSIGN   4646<<ASSIGN   4646>>ASSIGN   4688<<ASSIGN   4694>>IF       4696>>ASSIGN   4697>>ASSIGN
      4703<<ASSIGN   4703>>ASSIGN
CHAR_STRING_SIZE
      4011**DCL      3780--IMP-SIZ  4377<<ASSIGN   4397<<ASSIGN   4399>>ASSIGN   4538<<ASSIGN   4546<<ASSIGN
      4549>>ASSIGN   4628<<ASSIGN   4639<<ASSIGN   4642>>ASSIGN   4685<<ASSIGN   4696<<ASSIGN   4699>>ASSIGN
CODE_CGFILL
      4285**DCL      4560>>ASSIGN
DATEBUF
      3976**DCL      4171--DCLINIT  4172--DCLINIT  4385>>CALLBLT
EL$DODCB
      4021**DCL      4412--ASSIGN   4413--ASSIGN   4430--ASSIGN   4431--ASSIGN
EL$DODCB.PROCESSOR
      4021**DCL      4408<<ASSIGN   4424<<ASSIGN
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:75   
EL$DODCB.TXT
      4021**DCL      4409<<ASSIGN   4426<<CALLBLT
ERR.ERR#
      3908**DCL      4469>>IF
ERROR_CODE
      3978**DCL      4425<<CALLBLT  4426>>CALLBLT
FOUND_FLAG
      4018**DCL      4612<>CALL     4613>>IF
FPTWRSYSLOG
      4034**DCL      4410<<ASSIGN   4414<>CALL     4428<<ASSIGN   4432<>CALL
FPTWRSYSLOG.ENTRY_
      4034**DCL      4412<<ASSIGN   4430<<ASSIGN
FPTWRSYSLOG.V
      4034**DCL      4411--ASSIGN   4429--ASSIGN
FPTWRSYSLOG.V.SIZE#
      4036**DCL      4413<<ASSIGN   4431<<ASSIGN
FPTWRSYSLOG.V_
      4034**DCL      4411<<ASSIGN   4429<<ASSIGN
FPT_TIME
      4171**DCL      4384<>CALL
FPT_TIME.V
      4175**DCL      4171--DCLINIT
FPT_WRITE_CG
      4145**DCL      4550<>CALL
FPT_WRITE_CG.STATION_
      4147**DCL      4147--REDEF
FPT_WRITE_CG.V
      4148**DCL      4145--DCLINIT
FPT_WRITE_CG.V.DVBYTE.VFC#
      4154**DCL      4154--REDEF
FPT_WRITE_CSCG
      4112**DCL      4742<>CALL
FPT_WRITE_CSCG.BUF_.BOUND
      4112**DCL      4741<<ASSIGN
FPT_WRITE_CSCG.BUF_.BUF$
      4114**DCL      4740<<ASSIGN
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:76   
FPT_WRITE_CSCG.STATION_
      4114**DCL      4114--REDEF
FPT_WRITE_CSCG.V
      4115**DCL      4112--DCLINIT
FPT_WRITE_CSCG.V.DVBYTE.VFC#
      4121**DCL      4121--REDEF
FPT_WRITE_SEQ
      4080**DCL      4389<>CALL     4400<>CALL
FPT_WRITE_SEQ.BUF_
      4080**DCL      4382<<ASSIGN
FPT_WRITE_SEQ.STATION_
      4082**DCL      4082--REDEF
FPT_WRITE_SEQ.V
      4083**DCL      4080--DCLINIT
FPT_WRITE_SEQ.V.DVBYTE.VFC#
      4089**DCL      4089--REDEF
FPT_WRSYSLOG
      3776**DCL      4410>>ASSIGN   4428>>ASSIGN
FPT_WRSYSLOG.V
      3776**DCL      3776--DCLINIT
HDR_TO_MCT
      3938**DCL      4633--ASSIGN   4634--ASSIGN
HDR_TO_MCT.FLAGS
      3945**DCL      3946--REDEF
HDR_TO_MCT.INSTANCE
      3951**DCL      4627<<ASSIGN
HDR_TO_MCT.LEN
      3950**DCL      4632<<ASSIGN   4640<<ASSIGN
HDR_TO_MCT.MSGID
      3941**DCL      3942--REDEF
HDR_TO_MCT.TEXT
      3952**DCL      4642<<ASSIGN
HDR_TO_ONECONSOLE
      3955**DCL      4690--ASSIGN   4691--ASSIGN
HDR_TO_ONECONSOLE.CADDR
      3956**DCL      4683<<ASSIGN
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:77   
HDR_TO_ONECONSOLE.FLAGS
      3962**DCL      3963--REDEF
HDR_TO_ONECONSOLE.INSTANCE
      3968**DCL      4684<<ASSIGN
HDR_TO_ONECONSOLE.LEN
      3967**DCL      4689<<ASSIGN   4697<<ASSIGN
HDR_TO_ONECONSOLE.MSGID
      3958**DCL      3959--REDEF
HDR_TO_ONECONSOLE.TEXT
      3969**DCL      4699<<ASSIGN
I
      4008**DCL      4394<<DOINDEX  4543<<DOINDEX  4636<<DOINDEX  4693<<DOINDEX
K
      4009**DCL      4496<<DOINDEX  4497>>ASSIGN   4598<<DOINDEX  4599>>ASSIGN
LOOP IN PROCEDURE TO_STATION
      4504**LABEL    4498--CALLALT
M$TIME
       145**DCL-ENT  4384--CALL
M$WRITE
        79**DCL-ENT  4389--CALL     4400--CALL     4550--CALL     4742--CALL
M$WRSYSLOG
       127**DCL-ENT  4414--CALL     4432--CALL
MON_ERR IN PROCEDURE SEND_TO_STATION
      4559**LABEL    4550--CALLALT
MON_ERR IN PROCEDURE TO_CSCG
      4749**LABEL    4742--CALLALT
MON_ERR IN PROCEDURE TO_DODCB
      4406**LABEL    4384--CALLALT  4389--CALLALT  4400--CALLALT
MON_ERR1 IN PROCEDURE TO_DODCB
      4438**LABEL    4414--CALLALT  4432--CALLALT
NO_Q IN PROCEDURE TO_STATION
      4488**LABEL    4484--CALLALT
NUM_LINES
      4010**DCL      4378<<ASSIGN   4394>>DOINDEX  4539<<ASSIGN   4543>>DOINDEX  4629<<ASSIGN   4636>>DOINDEX
      4686<<ASSIGN   4693>>DOINDEX
OUTPUT_LINE
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:78   
      4013**DCL      4382--ASSIGN
OUTPUT_LINE.TEXT
      4015**DCL      4385<<CALLBLT  4387>>IF       4390>>ASSIGN   4399<<ASSIGN
OUTPUT_LINE.VFC
      4014**DCL      4381<<ASSIGN
P$
      4004**DCL      4379<<ASSIGN   4399>>ASSIGN   4402<<ASSIGN   4402>>ASSIGN   4540<<ASSIGN   4549>>ASSIGN
      4552<<ASSIGN   4552>>ASSIGN   4630<<ASSIGN   4642>>ASSIGN   4647<<ASSIGN   4647>>ASSIGN   4687<<ASSIGN
      4699>>ASSIGN   4704<<ASSIGN   4704>>ASSIGN
POS
      4007**DCL      4484<<CALLBLT
P_MSGBLK
      3541**DCL         8--PROC     4559<>CALL     4562<>CALL
P_MSGBLK.ARS
      3608**DCL      4378>>ASSIGN   4380>>ASSIGN   4539>>ASSIGN   4541>>ASSIGN   4629>>ASSIGN   4631>>ASSIGN
      4634<<ASSIGN   4686>>ASSIGN   4688>>ASSIGN   4691<<ASSIGN   4741>>ASSIGN
P_MSGBLK.CADDR
      3612**DCL      4683>>ASSIGN
P_MSGBLK.ERRINFO.ERR
      3619**DCL      4469--IF       4560<<ASSIGN
P_MSGBLK.FLAGS.DEST.CSCG
      3585**DCL      4343>>IF
P_MSGBLK.FLAGS.DEST.DODCB
      3589**DCL      4316>>IF
P_MSGBLK.FLAGS.DEST.HISTORY
      3591**DCL      4332>>IF
P_MSGBLK.FLAGS.DEST.MCT
      3587**DCL      4326>>IF       4332>>IF
P_MSGBLK.FLAGS.DEST.ONECONSOLE
      3593**DCL      4338>>IF
P_MSGBLK.FLAGS.DEST.STATION
      3583**DCL      4321>>IF       4600>>IF       4613>>IF
P_MSGBLK.FLAGS.INHIB_CSCG
      3605**DCL      4624>>IF
P_MSGBLK.FLAGS.MSG_SENT
      3603**DCL      4492<<ASSIGN   4501<<ASSIGN   4604<<ASSIGN   4617<<ASSIGN   4649<<ASSIGN   4707<<ASSIGN
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:79   
      4744<<ASSIGN
P_MSGBLK.FLAGS.REPORT
      3601**DCL      4471>>IF
P_MSGBLK.ID
      3542**DCL      4484>>CALLBLT  4490>>ASSIGN   4498<>CALL     4600>>IF       4613>>IF
P_MSGBLK.TEXT$
      3615**DCL      4379>>ASSIGN   4540>>ASSIGN   4630>>ASSIGN   4633<<ASSIGN   4687>>ASSIGN   4690<<ASSIGN
      4740>>ASSIGN
QQC$BLDMSG
      3656**DCL-ENT  4562--CALL
QQC$BLDMSG_ERRBLK
      3657**DCL-ENT  4559--CALL
QQC$FINDSTA
      3655**DCL-ENT  4612--CALL
QQC$SCREECH
      3658**DCL-ENT  4439--CALL     4564--CALL     4750--CALL
QQC$STOPTP
      3660**DCL-ENT  4434--CALL
QQC$WILD_COMP
      3659**DCL-ENT  4498--CALL
QQ_CMDBLK.ORIGIN
       584**DCL      4421>>IF
QQ_ERRMAP
       820**DCL      4469>>IF
QQ_GLOBAL.DS1$_BITS
       595**DCL       595--REDEF
QQ_GLOBAL.DS2$_BITS
       595**DCL       596--REDEF
QQ_GLOBAL.DS3$_BITS
       596**DCL       596--REDEF
QQ_GLOBAL.DS4$_BITS
       596**DCL       597--REDEF
QQ_GLOBAL.ERR
       585**DCL      4433<<ASSIGN   4438<<ASSIGN   4563<<ASSIGN   4749<<ASSIGN
QQ_GLOBAL.ERROR_CNT
       591**DCL      4561<<ASSIGN   4561>>ASSIGN
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:80   
QQ_GLOBAL.INSTANCE_NAME
       672**DCL      4627>>ASSIGN   4684>>ASSIGN
QQ_GLOBAL.LOG
       586**DCL      4624>>IF
QQ_GLOBAL.MCTID
       672**DCL      4610>>IF       4612<>CALL     4613>>IF       4618>>ASSIGN
QQ_GLOBAL.STATION$
       596**DCL      4497>>ASSIGN   4599>>ASSIGN
QQ_GLOBAL.STATION_CNT
       590**DCL      4496>>DOINDEX  4598>>DOINDEX
S$
      3805**DCL      3807--IMP-PTR  4497<<ASSIGN   4498>>CALL     4499>>ASSIGN   4599<<ASSIGN   4600>>IF
      4600>>IF       4605>>ASSIGN   4612<>CALL
SAVE_TIMESTAMP
      3977**DCL      4387>>IF       4390<<ASSIGN
SEND_TO_STATION
      4536**PROC     4491--CALL     4500--CALL     4606--CALL     4619--CALL
TIMEBUF
      3975**DCL      4173--DCLINIT  4174--DCLINIT  4385>>CALLBLT
TO_CSCG
      4738**PROC     4345--CALL     4644--CALL     4701--CALL
TO_DODCB
      4375**PROC     4318--CALL     4328--CALL
TO_HISTORY
      4755**PROC     4335--CALL
TO_MCT
      4593**PROC     4329--CALL
TO_ONECONSOLE
      4681**PROC     4340--CALL
TO_STATION
      4467**PROC     4323--CALL
TP$STATION
      3807**DCL      4497--ASSIGN   4599--ASSIGN
TP$STATION.FLAGS.MCT
      3837**DCL      4600>>IF
TP$STATION.ID
PL6.E3A0      #001=QQC$SNDMSG File=QQC$SNDMSG.:E05TSI                            WED 07/30/97 05:41 Page:81   
      3808**DCL      4498<>CALL     4499>>ASSIGN   4600>>IF       4605>>ASSIGN
VLP_STATION_CG
      4244**DCL      4147--DCLINIT
VLP_STATION_CG.CTL.LATCH#
      4249**DCL      4473<<ASSIGN   4478<<ASSIGN   4595<<ASSIGN
VLP_STATION_CG.MSGIDXT
      4254**DCL      4257--REDEF
VLP_STATION_CG.MSGTYP#
      4248**DCL      4474<<ASSIGN   4479<<ASSIGN   4596<<ASSIGN
VLP_STATION_CG.STATION#
      4248**DCL      4490<<ASSIGN   4499<<ASSIGN   4605<<ASSIGN   4618<<ASSIGN
VLP_STATION_CSCG
      4217**DCL      4114--DCLINIT
VLP_STATION_CSCG.MSGIDXT
      4227**DCL      4230--REDEF
WILD_FLAG
      4017**DCL      4482<<ASSIGN   4485<<ASSIGN   4488>>IF
WRITE_XACTION
      3971**DCL      4146--DCLINIT  4147--DCLINIT
WRITE_XACTION.FUNCTION
      3972**DCL      4470<<ASSIGN   4553<<ASSIGN
WRITE_XACTION.TEXT
      3973**DCL      4549<<ASSIGN
