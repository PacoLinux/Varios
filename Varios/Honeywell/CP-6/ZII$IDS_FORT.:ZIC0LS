
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /****************************************************************/
        7        7        /*                                                              */
        8        8        /*    I-D-S/II INTERFACE MODULE WITH FORTRAN/PL6 USERS          */
        9        9        /*                                                              */
       10       10        /****************************************************************/
       11       11        /* This error message is called from ZII$COB_PARAM_ERR, which is
       12       12           called from ZII$DBCSCI--the COBOL interface.  The message has
       13       13           been placed here since ZII$DBCSCI is a BMAP routine.  */
       14       14        /*E*  ERROR: ZII-195-1
       15       15              MESSAGE: IDS library routine called with wrong number
       16       16                       of parameters at IC
       17       17        */
       18       18        %MACRO GEN_PARAMS(TYPE=0); /* GENERATE SOURCE CODES FOR ALL ARGUMENTS */
       19       19         %SET PARAM# = %PARAM# + 1;
       20       20         %IF %PARAM# > %PARAMETERS;
       21       21         %SET PARAM# = 1;
       22       22         %ENDIF;
       23       23         %SET DIGITS = %PARAM# /10 + 1; /* NUMBER OF DIGITS */
       24       24         %SET ARG = CONCAT('A',BINCHAR(%PARAM#,%DIGITS));
       25       25         %IF TYPE = 0; /* GENERATE ARGUMENTS LIST */
       26       26         %IF %PARAM# < %PARAMETERS;
       27       27         %CHARTEXT(ARG),
       28       28         %ELSE;
       29       29         %CHARTEXT(ARG) );
       30       30         %ENDIF;
       31       31         %ELSEIF TYPE = 1;
       32       32         %IF %PARAM# < 4;
       33       33        DCL %CHARTEXT(ARG) (0:0) SBIN CALIGNED;
       34       34         %ELSE;
       35       35        DCL %CHARTEXT(ARG) SBIN CALIGNED;
       36       36         %ENDIF;
       37       37         %ELSEIF TYPE = 2;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:2    
       38       38            CALL CHK_ARG(%CHARTEXT(ARG)) ALTRET(END_OF_ARGS);
       39       39         %ELSE
       40       40         %ERROR('UNKNOWN TYPE IN MACRO GEN_PARAMS CALL');
       41       41         %ENDIF;
       42       42         %IF %PARAM# < %PARAMETERS;
       43       43            %GEN_PARAMS(TYPE=TYPE); /* KEEP GENERATING */
       44       44         %ENDIF;
       45       45        %MEND;
       46       46
       47       47        %EQU PARAMETERS = 20; /* MUST BE A MUTIPLE OF 4 */
       48       48        %EQU TYPE_BITS=2;
       49       49        %SET PARAM#=0;
       50       50         %EQU PARAMETERS_TIMES_TWO=%PARAMETERS*2;
       51       51        ZII$FORT_PL6: PROC(
       52       52               %GEN_PARAMS;
       53      593        %GEN_PARAMS(TYPE=1); /* GEN ALL DCL OF ARGUEMENTS */
       54     1134         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:3    
       55     1135        /** DEFINE CONTENTS OF KEY-WORDS IN SNA **/
       56     1136         %EQU ALL=2;
       57     1137         %EQU ANY=3;
       58     1138         %EQU AREANAME=4;
       59     1139         %EQU AREA=5;
       60     1140         %EQU CURRENCY=6;
       61     1141         %EQU CURRENT=7;
       62     1142         %EQU DBKEY=8;
       63     1143         %EQU DUPLICATE=9;
       64     1144         %EQU FIRST=10;
       65     1145         %EQU INCLUDING=11;
       66     1146         %EQU ITEM=12;
       67     1147         %EQU LAST=13;
       68     1148         %EQU LOAD=14;
       69     1149         %EQU NEXT=15;
       70     1150         %EQU NOSHALL=16;
       71     1151         %EQU ONLY=17;
       72     1152         %EQU OWNER=18;
       73     1153         %EQU PRIOR=19;
       74     1154         %EQU RECORD=20;
       75     1155         %EQU RETRIEVAL=12;
       76     1156         %EQU SET=22;
       77     1157         %EQU SETS=23;
       78     1158         %EQU SHAREALL=24;
       79     1159         %EQU SHAREANY=25;
       80     1160         %EQU SHAREIN=26;
       81     1161         %EQU UPDATE=27;
       82     1162         %EQU USING=28;
       83     1163         %EQU WITHIN=29;
       84     1164         %EQU SHCUR=30;
       85     1165         %EQU SHINCUR=31;
       86     1166        %EQU SNA_SIZE=30;
       87     1167         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:4    
       88     1168        /***************************************************************/
       89     1169        /*                                                             */
       90     1170        /*  SPECIAL NAME AREA (SNA) -  EXTROOT                         */
       91     1171        /*                                                             */
       92     1172        /***************************************************************/
       93     1173    1   DCL 1 SNA EXTROOT,
       94     1174    1         2 ALL SBIN INIT(%ALL),
       95     1175    1         2 ANY SBIN INIT(%ANY),
       96     1176    1         2 CURRENCY SBIN INIT(%CURRENCY),
       97     1177    1         2 CURRENT SBIN INIT(%CURRENT),
       98     1178    1         2 DBKEY SBIN INIT(%DBKEY),
       99     1179    1         2 DUPLICATE SBIN INIT(%DUPLICATE),
      100     1180    1         2 FIRST SBIN INIT(%FIRST),
      101     1181    1         2 INCLUDING SBIN INIT(%INCLUDING),
      102     1182    1         2 ITEM SBIN INIT(%ITEM),
      103     1183    1         2 LAST SBIN INIT(%LAST),
      104     1184    1         2 LOAD SBIN INIT(%LOAD),
      105     1185    1         2 NEXT SBIN INIT(%NEXT),
      106     1186    1         2 NOSHALL SBIN INIT(%NOSHALL),
      107     1187    1         2 ONLY SBIN INIT(%ONLY),
      108     1188    1         2 OWNER SBIN INIT(%OWNER),
      109     1189    1         2 PRIOR SBIN INIT(%PRIOR),
      110     1190    1         2 AREA SBIN INIT(%AREA),
      111     1191    1         2 AREANAME SBIN INIT(%AREANAME),
      112     1192    1         2 RECORD SBIN INIT(%RECORD),
      113     1193    1         2 RETRIEVAL SBIN INIT(%RETRIEVAL),
      114     1194    1         2 SET SBIN INIT(%SET),
      115     1195    1         2 SETS SBIN INIT(%SETS),
      116     1196    1         2 SHAREALL SBIN INIT(%SHAREALL),
      117     1197    1         2 SHAREANY SBIN INIT(%SHAREANY),
      118     1198    1         2 SHAREIN SBIN INIT(%SHAREIN),
      119     1199    1         2 UPDATE SBIN INIT(%UPDATE),
      120     1200    1         2 USING SBIN INIT(%USING),
      121     1201    1         2 WITHIN SBIN INIT(%WITHIN),
      122     1202    1         2 SHCUR SBIN INIT(%SHCUR),
      123     1203    1         2 SHINCUR SBIN INIT(%SHINCUR);
      124     1204        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:5    
      125     1205        /****************************************************************/
      126     1206        /*                                                              */
      127     1207        /*    DEFINE THE BASED STRUCTURE INTO A DYNAMIC PAGE            */
      128     1208        /*                                                              */
      129     1209        /****************************************************************/
      130     1210    1   DCL 1 ARG(0:0) BASED(ARG$) ALIGNED,
      131     1211    1         2 OFFSET UBIN HALF CALIGNED,
      132     1212    1         2 TYPE UBIN HALF CALIGNED;
      133     1213
      134     1214        /******************************************************************/
      135     1215        /*                                                                */
      136     1216        /*      COMMON FPT IS RESERVED TO 2*(%PARAMETERS)+10 WORDS        */
      137     1217        /*      IT IS UPDATED WHEN DOING MOST OF IDS_CALLS                */
      138     1218        /*                                                                */
      139     1219        /******************************************************************/
      140     1220    1   DCL 1 FPTS BASED(FPT$) DALIGNED, /* DALIGNED SO VECTOR IT RIGHT */
      141     1221    1         2 V_ VECTOR ALIGNED,
      142     1222    1         2 IA_ VECTOR ALIGNED,
      143     1223    1         2 UWA_ VECTOR ALIGNED,
      144     1224    1         2 RVA_ VECTOR ALIGNED,
      145     1225    1         2 USEP_ VECTOR ALIGNED,
      146     1226    1         2 V DALIGNED,
      147     1227    1           3 *(0:9) SBIN,
      148     1228    1           3 FPARAM (0:%PARAMETERS) SBIN WORD,
      149     1229    1           3 ARG(0:%PARAMETERS) PTR;
      150     1230
      151     1231    1   DCL 1 RLCW_SAVE BASED(RLCW$) ALIGNED,
      152     1232    1         2 * UBIN HALF UNAL,
      153     1233    1         2 AC_INDICATORS BIT(1) UNAL,
      154     1234    1         2 SC_INDICATORS BIT(1) UNAL,
      155     1235    1         2 RC_INDICATORS BIT(1) UNAL,
      156     1236    1         2 * BIT(7) UNAL,
      157     1237    1         2 N_SETS# UBIN(8) UNAL,
      158     1238    1         2 RETAIN_LIST(0:0) SBIN HALF CALIGNED;
      159     1239
      160     1240        /***************************************************************/
      161     1241        /*                                                             */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:6    
      162     1242        /*  USE PROCEDURE TABLE (USEP) - GENERATED BEFORE HIA          */
      163     1243        /*                                                             */
      164     1244        /***************************************************************/
      165     1245    1   DCL 1 USEP BASED(USEP$) DALIGNED, /* MUST BE DALIGNED */
      166     1246    1         2 FLAG BIT(1) UNAL,
      167     1247    1         2 M UBIN(17) UNAL,
      168     1248    1         2 * SBIN HALF CALIGNED,
      169     1249    1         2 UC(0:200) ALIGNED, /* ALLOW 200 ENTRIES */
      170     1250    1           3 UCW_PRV,
      171     1251    1             4 PT UBIN BYTE CALIGNED,
      172     1252    1             4 PB BIT(9) CALIGNED,
      173     1253    1             4 A UBIN HALF CALIGNED,
      174     1254    1           3 UCW_USE REDEF UCW_PRV,
      175     1255    1             4 PT UBIN BYTE CALIGNED,
      176     1256    1             4 CODE UBIN(27) CALIGNED,
      177     1257    1           3 ENT$ PTR ALIGNED;
      178     1258        %INCLUDE B_SEGIDS_C;
      179     1797        %INCLUDE CP_6_SUBS;
      180     2337        %INCLUDE B_ERRORS_C;
      181     3464    1   DCL B$DS8$_B BIT(36) STATIC INIT('000000006013'O);
      182     3465    1   DCL B$DS8$ REDEF B$DS8$_B PTR;
      183     3466
      184     3467    1   DCL RVA_TYPE(0:0) UBIN(%TYPE_BITS) UNAL BASED(TYPE$);
      185     3468    1   DCL RVA_TYPEC CHAR(IX) BASED(TYPE$);
      186     3469    1   DCL IX UBIN STATIC;
      187     3470
      188     3471         %EQU FPT_SIZE=10+2*(%PARAMETERS+1)+10;
      189     3472         %EQU RLCW_SIZE=1+%PARAMETERS/2;
      190     3473         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:7    
      191     3474        /****************************************************************/
      192     3475        /*                                                              */
      193     3476        /*    WORKING SPACE FOR INTERFACE MODULE                        */
      194     3477        /*                                                              */
      195     3478        /****************************************************************/
      196     3479    1   DCL IDSSYSERR SBIN STATIC SYMDEF; /* FOR MON ERR_CODE IN IA(5) */
      197     3480    1   DCL CHAR7 CHAR(7) BASED ALIGNED;
      198     3481    1   DCL CHAR_V CHAR(K) BASED(PT$) ALIGNED;
      199     3482    1   DCL B$TCB$ PTR SYMREF;
      200     3483
      201     3484    1   DCL I SBIN STATIC;
      202     3485    1   DCL K SBIN STATIC;
      203     3486    1   DCL J SBIN STATIC;
      204     3487    1   DCL 1 REDEF_J REDEF J,
      205     3488    1         2 BIT9 BIT(9) UNAL,
      206     3489    1         2 * BIT(9) UNAL,
      207     3490    1         2 NAME SBIN HALF UNAL;
      208     3491    1   DCL SBIN36 SBIN WORD BASED;
      209     3492    1   DCL AUTO_FRAME(0:0) SBIN HALF HALIGNED BASED (B$AUTO$);
      210     3493    1   DCL ANAME_ (0:7) SBIN BASED;
      211     3494    1   DCL DEADLOCK_RET BIT(72) STATIC INIT('000000006004000000000000'O);
      212     3495    1   DCL 1 DK_RET REDEF DEADLOCK_RET,
      213     3496    1         2 AUTO_OFFSET UBIN HALF UNAL,
      214     3497    1         2 SEG# UBIN HALF UNAL,
      215     3498    1         2 RET_ADDR UBIN HALF UNAL,
      216     3499    1         2 * UBIN HALF UNAL;
      217     3500    1   DCL P$ PTR BASED;
      218     3501    1   DCL AUTO$ BIT(36) CONSTANT ALIGNED INIT('000000006004'O);
      219     3502    1   DCL B$AUTO$ REDEF AUTO$ PTR ALIGNED; /* SIMULATE B$AUTO$ */
      220     3503    1   DCL PT$ PTR STATIC;
      221     3504    1   DCL EPTR$ REDEF PT$ EPTR;
      222     3505    1   DCL 1 REDEF_PT REDEF PT$,
      223     3506    1         2 ADR UBIN HALF UNAL,
      224     3507    1         2 SEG# BIT(18) UNAL;
      225     3508    1   DCL E$ EPTR STATIC;
      226     3509    1   DCL 1 REDEF_E$ REDEF E$,
      227     3510    1         2 ADR UBIN HALF UNAL,
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:8    
      228     3511    1         2 * UBIN HALF UNAL;
      229     3512    1   DCL NINE_WORDS(0:8) UBIN BASED ALIGNED;
      230     3513    1   DCL NO_ARGS SBIN STATIC;
      231     3514    1   DCL 1 FPT_SHORT STATIC DALIGNED,
      232     3515    1         2 VEC1 BIT(72) INIT(VECTOR(I)),
      233     3516    1         2 VEC2 BIT(72),
      234     3517    1         2 VEC3 BIT(72);
      235     3518    1   DCL CHK_NBF_ROL_CRPT$ PTR STATIC INIT(ADDR(FPT_SHORT));
      236     3519    1   DCL ZII$HAVEIT (0:199) UBIN STATIC INIT(0*0);
      237     3520    1   DCL IDS_ADR(0:7) UBIN HALF STATIC;
      238     3521    1   DCL IDS_BIT9(0:7) BIT(9) STATIC ALIGNED
      239     3522    1    INIT ('400'O,
      240     3523    1    '200'O,
      241     3524    1    '100'O,
      242     3525    1    '040'O,
      243     3526    1    '020'O,
      244     3527    1    '010'O,
      245     3528    1    '004'O);
      246     3529
      247     3530    1   DCL RETAIN_SWITCH SBIN STATIC INIT(0);
      248     3531    1   DCL II SBIN STATIC;
      249     3532    1   DCL LOW REDEF II SBIN;
      250     3533    1   DCL JJ SBIN STATIC;
      251     3534    1   DCL HIGH REDEF JJ SBIN;
      252     3535    1   DCL KK SBIN STATIC;
      253     3536    1   DCL NN SBIN STATIC;
      254     3537    1   DCL SDSDCB UBIN STATIC;
      255     3538    1   DCL SUBDCB UBIN STATIC;
      256     3539    1   DCL SDSFLAG BIT(1) STATIC INIT('0'B);
      257     3540        %INCLUDE FM$FIT;
      258     3761        %FM$FIT;
      259     3764        %CODE04;
      260     3772    1   DCL FPBUF CHAR(4096) STATIC;
      261     3773    1   DCL FIT$ PTR;
      262     3774    1   DCL RVA (0:0) SBIN WORD BASED(RVA$);
      263     3775    1   DCL RVA_HALF(0:0) UBIN HALF HALIGNED BASED(RVA$);
      264     3776    1   DCL IA_HALF(0:0) UBIN HALF HALIGNED BASED(IA$);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:9    
      265     3777    1   DCL UWA (0:0) SBIN BASED(UWA$);
      266     3778
      267     3779    1   DCL UWA_SIZE SBIN STATIC;
      268     3780    1   DCL RVA_SIZE SBIN STATIC;
      269     3781    1   DCL NULL_OFFSET SBIN STATIC;
      270     3782        %INCLUDE ZI$USER;
      271     3927         %IA (STCLASS="STATIC");
      272     3976    1   DCL 1 IAR$ REDEF IA$,
      273     3977    1         2 * BIT(24) UNAL,
      274     3978    1         2 SEGID BIT(12) UNAL;
      275     3979    1   DCL UWA$ PTR STATIC;
      276     3980    1   DCL RVA$ PTR STATIC;
      277     3981    1   DCL FPT$ PTR STATIC;
      278     3982    1   DCL ARG$ PTR STATIC;
      279     3983    1   DCL USEP$ PTR STATIC;
      280     3984    1   DCL KEY$ PTR STATIC;
      281     3985    1   DCL RLCW$ PTR STATIC;
      282     3986    1   DCL TYPE$ PTR STATIC;
      283     3987
      284     3988        %EQU AREA_NAME=31;
      285     3989        %EQU SET_NAME=32;
      286     3990        %EQU RECORD_NAME=33;
      287     3991        %EQU FIELD_NAME=34;
      288     3992        %EQU ELSE_NAME=1;
      289     3993        %EQU AREA_NAME_NET=0;
      290     3994        %EQU SET_NAME_NET=1;
      291     3995        %EQU RECORD_NAME_NET=2;
      292     3996        %EQU FIELD_NAME_NET=3;
      293     3997        %EQU ON=1;
      294     3998        %EQU OFF=0;
      295     3999        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:10   
      296     4000        /****************************************************************/
      297     4001        /*                                                              */
      298     4002        /*    INCLUDE ZI_DBCS TO INVOKE IDS FPTS AND ENTRY DEFS         */
      299     4003        /*                                                              */
      300     4004        /****************************************************************/
      301     4005        %INCLUDE ZI_DBCS;
      302     4618         %ASL;
      303     4632        %IPT_ACC(STCLASS="BASED(FPT$)");
      304     4645        %IPT_ACN(STCLASS="BASED(FPT$)");
      305     4659        %IPT_CALC(STCLASS="BASED(FPT$)");
      306     4671        %IPT_CHK(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      307     4681        %IPT_CON(STCLASS="BASED(FPT$)");
      308     4694        %IPT_CRPT(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      309     4703        %IPT_DIS(STCLASS="BASED(FPT$)");
      310     4716        %IPT_ERS(STCLASS="BASED(FPT$)");
      311     4728        %IPT_ETC(STCLASS="BASED(FPT$)");
      312     4741        %IPT_FAA(STCLASS="BASED(FPT$)");
      313     4758        %IPT_FAS(STCLASS="BASED(FPT$)");
      314     4775        %IPT_FCD(STCLASS="BASED(FPT$)");
      315     4790        %IPT_FCR(STCLASS="BASED(FPT$)");
      316     4804        %IPT_FCT(STCLASS="BASED(FPT$)");
      317     4819        %IPT_FDC(STCLASS="BASED(FPT$)");
      318     4834        %IPT_FDP(STCLASS="BASED(FPT$)");
      319     4850        %IPT_FDR(STCLASS="BASED(FPT$)");
      320     4866        %IPT_FIN(STCLASS="BASED(FPT$)");
      321     4879        %IPT_FKC(STCLASS="BASED(FPT$)");
      322     4896        %IPT_FKY(STCLASS="BASED(FPT$)");
      323     4913        %IPT_FOR(STCLASS="BASED(FPT$)");
      324     4928        %IPT_FRA(STCLASS="BASED(FPT$)");
      325     4945        %IPT_FRI(STCLASS="BASED(FPT$)");
      326     4962        %IPT_FRS(STCLASS="BASED(FPT$)");
      327     4979        %IPT_FUI(STCLASS="BASED(FPT$)");
      328     4995        %IPT_GET(STCLASS="BASED(FPT$)");
      329     5007        %IPT_GTF(STCLASS="BASED(FPT$)");
      330     5020        %IPT_HIA(STCLASS="BASED(FPT$)");
      331     5031        %IPT_IFM(STCLASS="BASED(FPT$)");
      332     5043        %IPT_IFT(STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:11   
      333     5055        %IPT_INA(STCLASS="BASED(FPT$)");
      334     5069        %IPT_IST(STCLASS="BASED(FPT$)");
      335     5082        %IPT_MOD(STCLASS="BASED(FPT$)");
      336     5098        %IPT_NBF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      337     5108        %IPT_KEEP(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      338     5117        %IPT_REDUCEQ(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      339     5126        %IPT_RDY(STCLASS="BASED(FPT$)");
      340     5140        %IPT_ROL(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      341     5149        %IPT_STO(STCLASS="BASED(FPT$)");
      342     5164        %IPT_TRON(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      343     5173        %IPT_TROFF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      344     5182        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:12   
      345     5183        /****************************************************************/
      346     5184        /*                                                              */
      347     5185        /*    INCLUDE CP_6 TO DO M$GDP AND M$ERR                        */
      348     5186        /*                                                              */
      349     5187        /****************************************************************/
      350     5188    1   DCL M$DO DCB;
      351     5189    1   DCL 1 PAGE_VECTOR STATIC DALIGNED,
      352     5190    1         2 * BIT(36),
      353     5191    1         2 ADR PTR INIT(ADDR(NIL));
      354     5192    1   DCL 1 ERR_CODE STATIC,
      355     5193    1         2 * BIT(18) UNAL INIT('321111'O),
      356     5194    1         2 ERR_NO UBIN(15) UNAL,
      357     5195    1         2 * UBIN(3) UNAL INIT(3);
      358     5196
      359     5197        %INCLUDE CP_6;
      360     5278
      361     5279
      362     5280        %FPT_GDP(PAGES=1,RESULTS=PAGE_VECTOR);
      363     5294
      364     5295        %VLP_NAME(FPTN=FILE_NAME,LEN=9,NAME=':ZIERRMSG');
      365     5322        %VLP_ACCT(FPTN=FILE_ACCT,ACCT=':SYS ');
      366     5335        %FPT_ERRMSG(OUTDCB1=M$DO,CODE=ERR_CODE,FILEACCT=FILE_ACCT,
      367     5336         FILENAME=FILE_NAME,INCLCODE=YES);
      368     5363        %FPT_YC;
      369     5380        %B$TCB;
      370     5383        %B$EXCFR;
      371     5401
      372     5402        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:13   
      373     5403        /**     INTERNAL SUBROUTINE TO RETURN A POFFW      **/
      374     5404        /**     WITH ADDITIONAL SEGMENT NUMBER CHECK       **/
      375     5405
      376     5406    1   P_OFF_W: PROC(A,B);
      377     5407    2   DCL 1 A ALIGNED,
      378     5408    2         2 ADR UBIN HALF UNAL,
      379     5409    2         2 * BIT(6) UNAL,
      380     5410    2         2 SEG UBIN(12) UNAL;
      381     5411    2   DCL 1 B ALIGNED,
      382     5412    2         2 ADR UBIN HALF UNAL,
      383     5413    2         2 * BIT(6) UNAL,
      384     5414    2         2 SEG UBIN(12) UNAL;
      385     5415
      386     5416    2       IF A.SEG=B.SEG THEN
      387     5417    2           I=A.ADR-B.ADR;
      388     5418    2       ELSE
      389     5419    2           I=-1;
      390     5420    2   END P_OFF_W;
      391     5421
      392     5422        /**     INTERNAL SUBROUTINE TO RETURN A VECTOR   **/
      393     5423
      394     5424    1   VEC_MAKER: PROC(A,B,C);
      395     5425    2   DCL A UBIN;
      396     5426    2   DCL B SBIN;
      397     5427    2   DCL 1 C ALIGNED,
      398     5428    2         2 V_SIZE UBIN(20) UNAL,
      399     5429    2         2 * UBIN(16) UNAL,
      400     5430    2         2 * UBIN UNAL;
      401     5431    2       C=VECTOR(A);
      402     5432    2       C.V_SIZE=(B+1)*4-1;
      403     5433    2   END VEC_MAKER;
      404     5434        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:14   
      405     5435    1   SDS$OPEN: PROC;
      406     5436
      407     5437        /*****************************************************/
      408     5438        /*                                                   */
      409     5439        /*  Procedure to open the shared data segment (SDS). */
      410     5440        /*                                                   */
      411     5441        /*****************************************************/
      412     5442
      413     5443        %F$DCB(STCLASS="BASED");
      414     5500        %FPT_FDS(FPTN=FPT_FDS,RESULTS=VEC,SEGSIZE=262143);
      415     5515        %FPT_GETDCB(FPTN=FPT_GETDCB,DCBNAME=SDS_NAME,DCBNUM=SDSDCB);
      416     5530        %FPT_RELDCB(FPTN=FPT_RELDCB);
      417     5544        %FPT_OPEN(FPTN=OPEN_SDS,ASN=FILE,EXIST=OLDFILE,FUN=IN,ACS=DS8,
      418     5545         FPARAM=FPBUF);
      419     5654        %VLP_NAME(FPTN=SDS_NAME,NAME=' ',LEN=31);
      420     5681        %VLP_NAME(FPTN=VLP_NAME,NAME=' ',LEN=31);
      421     5708        %VLP_VECTOR(FPTN=VEC,SEGID='6013'O);
      422     5723        /*  DCB name for SDS open is subschema-name||'$'  */
      423     5724    2       SDS_NAME.L# = 31;
      424     5725    2       SDS_NAME.NAME# = IA.SSNAME;
      425     5726    3       DO WHILE(SUBSTR(SDS_NAME.NAME#,SDS_NAME.L#-1,1) = ' ');
      426     5727    3           SDS_NAME.L# = SDS_NAME.L# - 1;
      427     5728    3           END;
      428     5729    2       CALL INSERT(SDS_NAME.NAME#,SDS_NAME.L#,1,'$');
      429     5730    2       SDS_NAME.L# = SDS_NAME.L# + 1;
      430     5731        /*  Get a dcb for the SDS */
      431     5732    2       FPT_GETDCB.V.TEST# = %NO#;
      432     5733    2       FPT_GETDCB.V.MERGE# = %YES#;
      433     5734    2       CALL M$GETDCB(FPT_GETDCB);
      434     5735
      435     5736        /*  If dcb for SDS is open, just return */
      436     5737    2       IF DCBADDR(SDSDCB)->F$DCB.FCD# THEN
      437     5738    2           RETURN;
      438     5739    2       OPEN_SDS.V.DCB# = SDSDCB;
      439     5740
      440     5741        /*  Free unitialized RVA  */
      441     5742    2       CALL M$FDS(FPT_FDS);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:15   
      442     5743
      443     5744    3       IF DCBADDR(SDSDCB)->F$DCB.ASN# ~= %FILE# THEN DO;
      444     5745        /*      Set up the file name for open of SDS file */
      445     5746    3           VLP_NAME.L# = SDS_NAME.L# - 1;
      446     5747    3           VLP_NAME.NAME# = IA.SSNAME;
      447     5748
      448     5749        /*      Now, prepare for and get the dcb for the subschema so we can pull
      449     5750                the subschema file name out of the dcb */
      450     5751    3           FPT_GETDCB.DCBNAME_ = VECTOR(VLP_NAME);
      451     5752    3           FPT_GETDCB.DCBNUM_ = VECTOR(SUBDCB);
      452     5753    3           FPT_GETDCB.V.MERGE# = %YES#;
      453     5754    3           CALL M$GETDCB(FPT_GETDCB);
      454     5755    4           IF DCBADDR(SUBDCB)->F$DCB.ASN# = %FILE# THEN DO;
      455     5756        /*      SET statement for subschema provided.  Get subschema file name
      456     5757                from DCB and frame the ACCOUNT specification in DCB */
      457     5758    4               VLP_NAME = DCBADDR(SUBDCB)->F$DCB.NAME#;
      458     5759    4               OPEN_SDS.ACCT_ = VECTOR(DCBADDR(SUBDCB)->F$DCB.ACCT#);
      459     5760    4               END;
      460     5761    4           ELSE DO;
      461     5762        /*          No SET statement provided.  Use IA.SSNAME for subschema
      462     5763                    file name and provide no ACCOUNT specification.  */
      463     5764    4               OPEN_SDS.ACCT_ = VECTOR(NIL);
      464     5765        /*          Now we have the subschema file name.  The name of the SDS
      465     5766                    will be 'subschema-name$' so put the '$' on the end */
      466     5767    4               CALL INSERT(VLP_NAME.NAME#,VLP_NAME.L#,1,'$');
      467     5768    4               VLP_NAME.L# = VLP_NAME.L# + 1;
      468     5769    4               END;
      469     5770        /*      Frame the name of the SDS for the open   */
      470     5771    3           OPEN_SDS.NAME_ = VECTOR(VLP_NAME);
      471     5772        /*      Free up the DCB used to obtain the subschema SET info  */
      472     5773    3           FPT_RELDCB.V.DCB# = SUBDCB;
      473     5774    3           CALL M$RELDCB(FPT_RELDCB);
      474     5775    3           END;
      475     5776    2       CALL M$OPEN(OPEN_SDS)
      476     5777    3       WHENRETURN DO;
      477     5778        /*  Check to determine whether the RVA data segment predates the
      478     5779            subschema file.  If so, access is denied. */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:16   
      479     5780    3           J=1;
      480     5781    3           FIT$ = ADDR(FPBUF);
      481     5782    4           DO WHILE(FIT$->FM$FIT.CODES.CODE(J)~=4);
      482     5783    4               J = J + 1;
      483     5784    4               END;
      484     5785    3           FIT$ = PINCRW(FIT$, FIT$->FM$FIT.CODES.ITEMX(J));
      485     5786    4           IF FIT$->CODE04.CREATION.TIME < IA.SSTDT(1) THEN DO;
      486     5787    4               CALL ARG_ERROR(5013);
      487     5788        /*E*   ERROR:   ZII-5013-1
      488     5789              MESSAGE:  RVA data segment file predates subschema file. */
      489     5790    4               CALL M$XXX;
      490     5791    4               END;
      491     5792    3           END;
      492     5793    3       WHENALTRETURN DO;
      493     5794        /*E*   ERROR:   ZII-5014-1
      494     5795              MESSAGE:  Unable to open RVA shared data segment file. */
      495     5796    3           CALL ARG_ERROR(5014);
      496     5797    3           CALL M$MERC;
      497     5798    3           END;
      498     5799    2       RETURN;
      499     5800    2   END SDS$OPEN;
      500     5801         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:17   
      501     5802        /******************************************************************/
      502     5803        /*                                                                */
      503     5804        /*      INTERNAL SUBROUTINE  CHK_ARG                              */
      504     5805        /*                                                                */
      505     5806        /******************************************************************/
      506     5807    1   CHK_ARG: PROC(A) ALTRET;
      507     5808
      508     5809    2   DCL A UBIN;
      509     5810
      510     5811    2       FPTS.V.ARG(NO_ARGS)=ADDR(A);
      511     5812    2       IF ADDR(A)=ADDR(NIL) THEN ALTRETURN;
      512     5813    2       CALL P_OFF_W(ADDR(A),RVA$);
      513     5814    2       IF I>0 AND I<=RVA_SIZE THEN
      514     5815    3       DO;
      515     5816    3           ARG.OFFSET(NO_ARGS)=I;
      516     5817    3           ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(I);
      517     5818    3           END;
      518     5819    2       ELSE
      519     5820    3       DO;
      520     5821    3           CALL P_OFF_W(ADDR(A),ADDR(SNA));
      521     5822    3           IF I>=0 AND I<%SNA_SIZE THEN
      522     5823    3               ARG.TYPE(NO_ARGS)=A;
      523     5824    3           ELSE
      524     5825    4           DO;
      525     5826    4               CALL P_OFF_W(ADDR(A),UWA$);
      526     5827    4               ARG.TYPE(NO_ARGS)=%ELSE_NAME;
      527     5828    4               IF I>=48 AND I<UWA_SIZE THEN
      528     5829    5               DO;
      529     5830    5                   I=POFFC(ADDR(A),UWA$)*2;
      530     5831    5                   LOW=2;
      531     5832    5                   HIGH=RVA_SIZE-1;
      532     5833    5   BINARY_SEARCH: /* BINARY SEARCH THRU RVA */
      533     5834    5                   IF LOW>HIGH THEN CALL ARG_ERROR(2);
      534     5835        /*E*   ERROR:  ZII-2-1
      535     5836              MESSAGE: RVA and UWA are inconsistent.   */
      536     5837    5                   K=LOW+(HIGH-LOW)/2;
      537     5838    5                   J=RVA(K);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:18   
      538     5839    5                   IF REDEF_J.NAME<I THEN
      539     5840    6                   DO;
      540     5841    6                       LOW=K+1;
      541     5842    6                       GOTO BINARY_SEARCH;
      542     5843    6                       END;
      543     5844    5                   IF REDEF_J.NAME>I THEN
      544     5845    6                   DO;
      545     5846    6                       HIGH=K-1;
      546     5847    6                       GOTO BINARY_SEARCH;
      547     5848    6                       END;
      548     5849    5                   IF RVA_TYPE(K)=%RECORD_NAME_NET THEN
      549     5850    6                   DO;
      550     5851    6                       K=K+1;
      551     5852    6                       IF RVA_TYPE(K)=%RECORD_NAME_NET THEN CALL ARG_ERROR(2);
      552     5853    6                       END;
      553     5854    5                   ARG.OFFSET(NO_ARGS)=K;
      554     5855    5                   ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(K);
      555     5856    5                   END;
      556     5857    4               END;
      557     5858    3           END;
      558     5859    2       NO_ARGS=NO_ARGS+1;
      559     5860    2   END CHK_ARG;
      560     5861         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:19   
      561     5862        /************************************************************/
      562     5863        /*                                                          */
      563     5864        /*    INTERNAL SUBROUTINE TO SETUP ARG'S LIST               */
      564     5865        /*                                                          */
      565     5866        /*    1. DETERMINE THE NUMBER OF PARAMETERS PASSED          */
      566     5867        /*    2. SAVE EACH ARG'S ADDRESS, AND CONVERT INTO RVA ADDR */
      567     5868        /*       IF IT IS A FIELD-NAME                              */
      568     5869        /*                                                          */
      569     5870        /************************************************************/
      570     5871
      571     5872    1   SET_ARGS: PROC;
      572     5873
      573     5874    2       IA_HALF(12) = 0; /* Roll back flag should start zero */
      574     5875    2       IA_HALF(13)=AUTO_FRAME(-2*(AUTO_FRAME(1)+1));
      575     5876    2   SET_ARGS1: ENTRY; /* FOR USEPROC, CALLED BEFORE INVOKE */
      576     5877    2       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN CALL ARG_ERROR(10);
      577     5878        /*E*  ERROR: ZII-10-7
      578     5879              MESSAGE: INVOKE CALL is not performed as your 1st IDS statement.  */
      579     5880    2       NO_ARGS=0;
      580     5881            %GEN_PARAMS(TYPE=2); /* CALL CHK_ARG(A1 TO A20); */
      581     6422    2   END_OF_ARGS: ADDR(FPTS.V) -> NINE_WORDS = '0'B;
      582     6423
      583     6424    2   END SET_ARGS;
      584     6425         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:20   
      585     6426        /*******************************************************************/
      586     6427        /*                                                                 */
      587     6428        /*    ARG_ERROR: READ ERROR MESSAGE AND ABORT THE JOB              */
      588     6429        /*                                                                 */
      589     6430        /*******************************************************************/
      590     6431
      591     6432    1   ARG_ERROR: PROC(ERR_NO);
      592     6433
      593     6434    2   DCL ERR_NO UBIN;
      594     6435    2   DCL ERRMSG_BUF CHAR(120) AUTO ALIGNED;
      595     6436
      596     6437    2       ERR_CODE.ERR_NO=ERR_NO;
      597     6438    2       FPT_ERRMSG.BUF_=VECTOR(ERRMSG_BUF);
      598     6439    2       CALL M$ERRMSG(FPT_ERRMSG);
      599     6440    2       CALL M$ERR;
      600     6441    2   END ARG_ERROR;
      601     6442         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:21   
      602     6443        /****************************************************************/
      603     6444        /*                                                              */
      604     6445        /*    GET A PAGE OF DYNAMIC MEMORY AT THE VERY 1ST IDS CALL     */
      605     6446        /*                                                              */
      606     6447        /****************************************************************/
      607     6448
      608     6449    1   GET_A_PAGE: PROC;
      609     6450
      610     6451    2       CALL M$GDP(FPT_GDP) ALTRET(OUT_OF_MEMORY);
      611     6452    2       FPT$=PAGE_VECTOR.ADR;
      612     6453    2       ARG$=ADDR(FPTS.V.FPARAM(0));
      613     6454    2       RLCW$=PINCRW(FPT$,%FPT_SIZE);
      614     6455    2       TYPE$=PINCRW(RLCW$,%RLCW_SIZE);
      615     6456    2       FPTS.V_=VECTOR(FPTS.V);
      616     6457    2       FPT_ERRMSG.BUF_=FPTS.V_; /* M$ERRMSG USE THIS AREA TOO */
      617     6458    2       RETURN;
      618     6459
      619     6460        /*E*  ERROR: ZII-5-1
      620     6461              MESSAGE: Failed to get a dynamic page, core limit exceeded.  */
      621     6462
      622     6463    2   OUT_OF_MEMORY:
      623     6464    2       CALL ARG_ERROR(5);
      624     6465    2   END GET_A_PAGE;
      625     6466         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:22   
      626     6467        /****************************************************************/
      627     6468        /*                                                              */
      628     6469        /*    CALL PRIVACY(RECORD,IDS-NAME1,PRIVACY-KEY,REC-NAME)       */
      629     6470        /*                                                              */
      630     6471        /*      IDS-NAME1: CONNECT,DISCONNECT,STORE,ERASE               */
      631     6472        /*                 MODIFY,FIND,GET                              */
      632     6473        /*                                                              */
      633     6474        /*    CALL PRIVACY(SET,CONNECT,PRIVACY-KEY,SET-NAME1,....)      */
      634     6475        /*                     DISCONNECT                               */
      635     6476        /*                     FIND                                     */
      636     6477        /*                                                              */
      637     6478        /*    CALL PRIVACY(ITEM,MODIFY/GET,PRIVACY-KEY,ITEM-1,...)      */
      638     6479        /*                                                              */
      639     6480        /****************************************************************/
      640     6481
      641     6482    1   PRIVACY: ENTRY(
      642     6483               %GEN_PARAMS;
      643     7024
      644     7025        /*E*  ERROR: ZII-15-1
      645     7026              MESSAGE: Syntax error detected in PRIVACY CALL. */
      646     7027
      647     7028    1       CALL SET_ARGS;
      648     7029    1       IF A1(0)=SNA.SET THEN
      649     7030    1           K=1;
      650     7031    1       ELSE
      651     7032    1           IF A1(0)=SNA.RECORD THEN
      652     7033    1               K=2;
      653     7034    1           ELSE
      654     7035    1               IF A1(0)=SNA.ITEM THEN
      655     7036    1                   K=3;
      656     7037    1               ELSE
      657     7038    1                   CALL ARG_ERROR(15); /* UNKNOWN FIRST ARGUMENT */
      658     7039
      659     7040    1       JJ=NO_ARGS-1; /* START FROM THE END OF ARG_LIST */
      660     7041    2       DO WHILE(ARG.TYPE(JJ)-%SET_NAME+1=K);
      661     7042    2           JJ=JJ-1;
      662     7043    2           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:23   
      663     7044    1       IF (K<3 AND JJ=NO_ARGS-1) THEN
      664     7045    2       DO; /* IN CASE NO REC OR SET SPECIFIED IN THE LIST */
      665     7046    2           ARG.OFFSET(NO_ARGS)=0; /* FOR ALL REC OR SETS */
      666     7047    2           NO_ARGS=NO_ARGS+1; /* MAKE A FAKE ARGUMENT */
      667     7048    2           END;
      668     7049
      669     7050    1       KK=USEP.M;
      670     7051    2       DO I=1 TO JJ-1; /* LOOP THRU IDS ROUTINE ADDR */
      671     7052    2           PT$=FPTS.V.ARG(I);
      672     7053    2           J=0;
      673     7054    3           DO WHILE(J<8 AND IDS_ADR(J)~=REDEF_PT.ADR);
      674     7055    3               J=J+1;
      675     7056    3               END;
      676     7057    2           IF J=8 THEN CALL ARG_ERROR(15); /* UNKNOWN IDS ROUTINE */
      677     7058    3           DO II=JJ+1 TO NO_ARGS-1; /* LOOP THRU REC OR SET OR ITEM LIST */
      678     7059    3               USEP.UC.UCW_PRV.PT(KK)=K;
      679     7060    3               USEP.UC.UCW_PRV.PB(KK)=IDS_BIT9(J);
      680     7061    3               USEP.UC.UCW_PRV.A(KK)=RVA_HALF(2*ARG.OFFSET(II)+1);
      681     7062    3               USEP.UC.ENT$(KK)=FPTS.V.ARG(JJ); /* USER PROCEDURE ADDR */
      682     7063    3               KK=KK+1;
      683     7064    3               END;
      684     7065    2           END;
      685     7066    1       USEP.M=KK;
      686     7067    1       RETURN;
      687     7068         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:24   
      688     7069        /**************************************************************/
      689     7070        /*                                                            */
      690     7071        /*    CALL USE(SUBROUTINE-NAME,ERROR-1,ERROR-2,...)           */
      691     7072        /*                                                            */
      692     7073        /*    1.   GENERATE ENTRY POINTS IN 'USEP' TABLE              */
      693     7074        /*    2.   SAVE SUBROUITNE ADDRESSES IN 'EPTR_SAVE' TABLE     */
      694     7075        /*                                                            */
      695     7076        /**************************************************************/
      696     7077
      697     7078    1   USEPROC: ENTRY(
      698     7079               %GEN_PARAMS;
      699     7620
      700     7621    1       CALL SET_ARGS1;
      701     7622    2       DO I=1 TO NO_ARGS-1;
      702     7623    2           IF ARG.TYPE(I)=SNA.ALL THEN
      703     7624    2               J=0; /* USEPROC FOR ALL OTHERS */
      704     7625    2           ELSE
      705     7626    2               CALL CHARBIN(J,FPTS.V.ARG(I)->CHAR7);
      706     7627    2           USEP.UC.UCW_USE.PT(USEP.M)=6;
      707     7628    2           USEP.UC.UCW_USE.CODE(USEP.M)=J;
      708     7629    2           USEP.UC.ENT$(USEP.M)=FPTS.V.ARG(0);
      709     7630    2           USEP.M=USEP.M+1;
      710     7631    2           END;
      711     7632    1       RETURN;
      712     7633         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:25   
      713     7634        /****************************************************************/
      714     7635        /*                                                              */
      715     7636        /*    CALL RETAIN( AREA                               )         */
      716     7637        /*                 SETS                                         */
      717     7638        /*                 RECORD                                       */
      718     7639        /*                 SET-NAME1,SET-NAME2,.....                    */
      719     7640        /*                                                              */
      720     7641        /*         1.  SAVE RETAINING CONTROL LIST.                     */
      721     7642        /*         2.  SET SWITCH ON, RETAINING LIST WILL BE USED ON    */
      722     7643        /*             NEXT IDS CALL WITH RETAIN CURRENCY OPTION        */
      723     7644        /*                                                              */
      724     7645        /****************************************************************/
      725     7646
      726     7647    1   RETAIN: ENTRY(
      727     7648               %GEN_PARAMS;
      728     8189
      729     8190    1       ADDR(RLCW_SAVE)->SBIN36=0;
      730     8191    1       CALL SET_ARGS;
      731     8192        /*E*  ERROR: ZII-20-1
      732     8193              MESSAGE: Syntax error in RETAIN CALL.  */
      733     8194    1       K=0;
      734     8195    2       DO WHILE (K<NO_ARGS);
      735     8196    2           IF ARG.TYPE(K)=%SET_NAME THEN
      736     8197    3           DO;
      737     8198    3               RLCW_SAVE.RETAIN_LIST(RLCW_SAVE.N_SETS#)=ARG.OFFSET(K);
      738     8199    3               RLCW_SAVE.N_SETS#=RLCW_SAVE.N_SETS#+1;
      739     8200    3               END;
      740     8201    2           ELSE
      741     8202    2               IF ARG.TYPE(K)=SNA.AREA THEN
      742     8203    2                   RLCW_SAVE.AC_INDICATORS='1'B;
      743     8204    2               ELSE
      744     8205    2                   IF ARG.TYPE(K)=SNA.SETS THEN
      745     8206    2                       RLCW_SAVE.SC_INDICATORS='1'B;
      746     8207    2                   ELSE
      747     8208    2                       IF ARG.TYPE(K)=SNA.RECORD THEN
      748     8209    2                           RLCW_SAVE.RC_INDICATORS='1'B;
      749     8210    2                       ELSE
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:26   
      750     8211    2                           CALL ARG_ERROR(20);
      751     8212    2           K=K+1;
      752     8213    2           END;
      753     8214    1       RETAIN_SWITCH=%ON;
      754     8215    1       RETURN;
      755     8216
      756     8217    1   IDSSET: ENTRY(A1,A2);
      757     8218
      758     8219    1       PT$=ADDR(A1);
      759     8220    1       K=256;
      760     8221    1       CALL INDEX(I,'SET ',CHAR_V);
      761     8222    1       A2(0)=1;
      762     8223    1       IF I=K THEN RETURN; /* NOT A LEGAL SET COMMAND */
      763     8224    1       K=K-I;
      764     8225    1       PT$=PINCRC(PT$,I);
      765     8226    1       I=4;
      766     8227    2       DO J=1 TO 2;
      767     8228    3           DO WHILE(SUBSTR(CHAR_V,I,1)=' ' AND I<K);
      768     8229    3               I=I+1;
      769     8230    3               END;
      770     8231    2           CALL INDEX1(I,' ',CHAR_V,I+1);
      771     8232    2           END;
      772     8233    1       IF SUBSTR(CHAR_V,I-1,1)='.' THEN I=I-1;
      773     8234    1       K=I;
      774     8235    1       FPT_YC.CMD_=VECTOR(CHAR_V);
      775     8236    1       CALL M$YC(FPT_YC) ALTRET(YC_ERROR);
      776     8237    1       A2(0)=0; /* NORMAL FLAG */
      777     8238    1       RETURN;
      778     8239    1   YC_ERROR: A2(0)=ADDR(B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.FCG)->SBIN36;
      779     8240    1       RETURN;
      780     8241         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:27   
      781     8242        /**   INTERNAL SUBROUTINE TO SETUP RETAIN CONTROL LIST   **/
      782     8243
      783     8244    1   CHK_RETAIN: PROC(RLCW,OFFSET);
      784     8245
      785     8246    2   DCL 1 RLCW,
      786     8247    2         2 FLAGS SBIN WORD,
      787     8248    2         2 LISTS (0:0),
      788     8249    2           3 RVA_OFFSET# SBIN HALF UNAL,
      789     8250    2           3 MBZ UBIN HALF UNAL;
      790     8251    2   DCL OFFSET SBIN HALF CALIGNED;
      791     8252
      792     8253    2       IF RETAIN_SWITCH=%OFF THEN
      793     8254    2           RLCW.FLAGS=0;
      794     8255    2       ELSE
      795     8256    3       DO;
      796     8257    3           RETAIN_SWITCH=%OFF;
      797     8258    3           RLCW.FLAGS=ADDR(RLCW_SAVE)->SBIN36;
      798     8259    4           DO II=OFFSET TO RLCW_SAVE.N_SETS#+OFFSET-1;
      799     8260    4               RLCW.LISTS.RVA_OFFSET#(II)=RLCW_SAVE.RETAIN_LIST(II-OFFSET);
      800     8261    4               RLCW.LISTS.MBZ(II)=0;
      801     8262    4               END;
      802     8263    3           END;
      803     8264    2   END CHK_RETAIN;
      804     8265         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:28   
      805     8266        /**************************************************************/
      806     8267        /*                                                            */
      807     8268        /*    CALL READY([AREA-1[,AREA-2[,....]],FUN-OPT,[MODE-OPT])  */
      808     8269        /*                                                            */
      809     8270        /*    FUN-OPT: LOAD, UPDATE, OR RETRIEVAL                     */
      810     8271        /*    MODE-OPT: SHAREALL,SHAREANY,NOSHARE, OR SHAREIN.        */
      811     8272        /*                                                            */
      812     8273        /**************************************************************/
      813     8274
      814     8275    1   READY: ENTRY(
      815     8276               %GEN_PARAMS;
      816     8817
      817     8818    1       CALL SET_ARGS;
      818     8819        /*E*  ERROR: ZII-25-1
      819     8820              MESSAGE: Syntax error in READY CALL.
      820     8821                       Required option LOAD/UPDATE/RETRIEVAL missing.  */
      821     8822    1       J=2;
      822     8823    1       I=ARG.TYPE(NO_ARGS-1);
      823     8824    1       IF I=SNA.NOSHALL THEN
      824     8825                %CLIMB(FCN=SHNO,PARAMS=0);
      825     8839    1       ELSE
      826     8840    1           IF I=SNA.SHAREALL THEN
      827     8841                    %CLIMB(FCN=SHALL,PARAMS=0);
      828     8855    1           ELSE
      829     8856    1               IF I=SNA.SHAREIN THEN
      830     8857                        %CLIMB(FCN=SHIN,PARAMS=0);
      831     8871    1               ELSE
      832     8872    1                   IF I=SNA.SHAREANY THEN
      833     8873                            %CLIMB(FCN=SHANY,PARAMS=0);
      834     8887    1                   ELSE
      835     8888    1                       IF I=SNA.SHCUR THEN
      836     8889                                %CLIMB(FCN=SHCUR,PARAMS=0);
      837     8903    1                       ELSE
      838     8904    1                           IF I=SNA.SHINCUR THEN
      839     8905                                    %CLIMB(FCN=SHINCUR,PARAMS=0);
      840     8919    1                           ELSE
      841     8920    1                               J=1;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:29   
      842     8921
      843     8922    1       I=ARG.TYPE(NO_ARGS-J);
      844     8923    1       IF I=SNA.UPDATE THEN
      845     8924    1           IPT_RDY.V.RDCW.READY_OPTION#='010'B;
      846     8925    1       ELSE
      847     8926    1           IF I=SNA.RETRIEVAL THEN
      848     8927    1               IPT_RDY.V.RDCW.READY_OPTION#='100'B;
      849     8928    1           ELSE
      850     8929    1               IF I=SNA.LOAD THEN
      851     8930    1                   IPT_RDY.V.RDCW.READY_OPTION#='001'B;
      852     8931    1               ELSE
      853     8932    1                   CALL ARG_ERROR(25);
      854     8933
      855     8934        /*E*  ERROR: ZII-30-1
      856     8935              MESSAGE: Arguments in CALL READY are not all AREA-NAMEs. */
      857     8936    2       DO I=0 TO NO_ARGS-J-1;
      858     8937    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(30);
      859     8938    2           IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);
      860     8939    2           END;
      861     8940    1       IPT_RDY.V.RDCW.AREAS_TO_READY#=I;
      862     8941    1       IPT_RDY.V_ = VECTOR(IPT_RDY.V);
      863     8942    1       VBOUND(IPT_RDY.V_) = VBOUND(IPT_RDY.V_) + SIZEC(IPT_RDY.V.AC_OFFSETS) * (I-1);
      864     8943         /* I computed from previous DO */
      865     8944            %CLIMB(FCN=RDY);
      866     8958    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);
      867     8959    2       DO WHILE (IA_HALF(15)>0);
      868     8960    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */
      869     8961    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */
      870     8962    2           CALL EPTR$;
      871     8963    2           IPT_ETC.V_ = VECTOR(IPT_ETC.V);
      872     8964                %CLIMB(FCN=ETC);
      873     8978    2           END;
      874     8979    1       RETAIN_SWITCH=%OFF; /* RESET RETAIN CONTROL FLAG */
      875     8980    1       GOTO COMMON_RETURN;
      876     8981         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:30   
      877     8982        /**************************************************************/
      878     8983        /*                                                            */
      879     8984        /*    CALL FINISH([AREA-1,[AREA-2,....,],])                   */
      880     8985        /*                                                            */
      881     8986        /**************************************************************/
      882     8987    1   FINISH: ENTRY(
      883     8988               %GEN_PARAMS;
      884     9529
      885     9530    1       CALL SET_ARGS;
      886     9531        /*E*  ERROR: ZII-35-1
      887     9532              MESSAGE: Arguments in CALL FINISH are not all AREA-NAMES. */
      888     9533    2       DO I=0 TO NO_ARGS-1;
      889     9534    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(35);
      890     9535    2           IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);
      891     9536    2           END;
      892     9537    1       IPT_FIN.V.ALCW.N_AREAS#=I;
      893     9538    1       IPT_FIN.V_ = VECTOR(IPT_FIN.V);
      894     9539    1       VBOUND(IPT_FIN.V_) = VBOUND(IPT_FIN.V_) + SIZEC(IPT_FIN.V.AC_OFFSETS) * (I-1);
      895     9540         /* I computed from previous DO */
      896     9541            %CLIMB(FCN=FIN);
      897     9555    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);
      898     9556    1       GOTO COMMON_RETURN;
      899     9557
      900     9558    1   CALC: ENTRY(A1,A2);
      901     9559
      902     9560    1       CALL SET_ARGS1;
      903     9561    1       IF NO_ARGS~=2 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(37);
      904     9562        /*E*  ERROR: ZII-37-1
      905     9563              MESSAGE: Argument count error, or the 1st argument is not
      906     9564                       a RECORD-NAME in CALL CALC. */
      907     9565    1       IPT_CALC.V_=VECTOR(IPT_CALC.V);
      908     9566    1       IPT_CALC.DBK_=VECTOR(A2(0));
      909     9567    1       IPT_CALC.V.UWA_OFFSET=RVA_HALF(ARG.OFFSET(0)*2+1)/8;
      910     9568            %CLIMB(FCN=CALC);
      911     9582    1       IPT_CALC.V_=VECTOR(FPTS.V);
      912     9583    1       RETURN;
      913     9584         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:31   
      914     9585    1   ACCEPT: ENTRY(A1,A2,A3);
      915     9586
      916     9587    1       CALL SET_ARGS;
      917     9588        /*****************************************************************/
      918     9589        /*                                                               */
      919     9590        /*    CALL ACCEPT(IDENT-1,[REC-NAME],AREANAME)                   */
      920     9591        /*                                   SET-NAME                    */
      921     9592        /*                                   IDENT-2                     */
      922     9593        /*         IDENT-1: LOCATION TO RECEIVE THE AREA'S TEXT NAME     */
      923     9594        /*         IDENT-2: LOCATION CONTAINS A DBKEY TO IDENT THE AREA  */
      924     9595        /*                                                               */
      925     9596        /*****************************************************************/
      926     9597    1       IF ARG.TYPE(NO_ARGS-1)=SNA.AREANAME THEN
      927     9598    2       DO;
      928     9599    2           IPT_ACN.DBK_=VECTOR(NIL);
      929     9600    2           IPT_ACN.ANAME_=VECTOR(ADDR(A1)->ANAME_);
      930     9601    3           DO CASE(ARG.TYPE(1)-%AREA_NAME);
      931     9602
      932     9603    3           CASE(%RECORD_NAME_NET);
      933     9604    3               IPT_ACN.V.NCW.CI#=1;
      934     9605    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);
      935     9606    3           CASE(%SET_NAME_NET);
      936     9607    3               IPT_ACN.V.NCW.CI#=3;
      937     9608    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);
      938     9609    3           CASE(ELSE);
      939     9610    3               IPT_ACN.V.RVA_ITEM.OFFSET#=NULL_OFFSET;
      940     9611    3               IF NO_ARGS=3 THEN IPT_ACN.V.NCW.CI#=2;
      941     9612    3               ELSE IPT_ACN.V.NCW.CI#=0;
      942     9613    3               IPT_ACN.DBK_=VECTOR(A2(0));
      943     9614    3               END;
      944     9615    2           IPT_ACN.V.NCW.AREA_NME_SIZE#=30;
      945     9616    2           IPT_ACN.V_=VECTOR(IPT_ACN.V);
      946     9617                %CLIMB(FCN=ACN);
      947     9631    2           END;
      948     9632    1       ELSE
      949     9633        /****************************************************************/
      950     9634        /*                                                              */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:32   
      951     9635        /*    CALL ACCEPT(IDENTIFIER,[REC-NAME],CURRENCY)               */
      952     9636        /*                            SET-NAME  NEXT                    */
      953     9637        /*                            AREA-NAME PRIOR                   */
      954     9638        /*                                      OWNER                   */
      955     9639        /*                                                              */
      956     9640        /****************************************************************/
      957     9641    2       DO;
      958     9642    2           IPT_ACC.DBK_=VECTOR(A1(0));
      959     9643    3           DO CASE(NO_ARGS);
      960     9644
      961     9645    3           CASE(2);
      962     9646    3               IF ARG.TYPE(1)~=SNA.CURRENCY THEN CALL ARG_ERROR(40);
      963     9647        /*E* ERROR: ZII-40-1
      964     9648              MESSAGE: Bad 2nd argument in ACCEPT CALL.
      965     9649                       The correct syntax is
      966     9650                       CALL ACCEPT(RETURNED-IDENTIFIER,CURRENCY)  */
      967     9651    3               IPT_ACC.V.RVA_ITEM.OFFSET#=NULL_OFFSET;
      968     9652    3               IPT_ACC.V.CCW.SCI#=0;
      969     9653    3           CASE(3);
      970     9654    3               IPT_ACC.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);
      971     9655    4               DO CASE(ARG.TYPE(1)-%AREA_NAME);
      972     9656
      973     9657    4               CASE(%RECORD_NAME_NET);
      974     9658    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN
      975     9659    4                       IPT_ACC.V.CCW.SCI#=1;
      976     9660    4                   ELSE
      977     9661    4                       CALL ARG_ERROR(41);
      978     9662    4               CASE(%AREA_NAME_NET);
      979     9663    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN
      980     9664    4                       IPT_ACC.V.CCW.SCI#=2;
      981     9665    4                   ELSE
      982     9666    4                       CALL ARG_ERROR(41);
      983     9667    4               CASE(%SET_NAME_NET);
      984     9668    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN
      985     9669    4                       IPT_ACC.V.CCW.SCI#=3;
      986     9670    4                   ELSE
      987     9671    4                       IF ARG.TYPE(2)=SNA.NEXT THEN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:33   
      988     9672    4                           IPT_ACC.V.CCW.SCI#=4;
      989     9673    4                       ELSE
      990     9674    4                           IF ARG.TYPE(2)=SNA.PRIOR THEN
      991     9675    4                               IPT_ACC.V.CCW.SCI#=5;
      992     9676    4                           ELSE
      993     9677    4                               IF ARG.TYPE(2)=SNA.OWNER THEN
      994     9678    4                                   IPT_ACC.V.CCW.SCI#=6;
      995     9679    4                               ELSE
      996     9680    4                                   CALL ARG_ERROR(43);
      997     9681    4               CASE(ELSE);
      998     9682    4                   CALL ARG_ERROR(44);
      999     9683    4                   END;
     1000     9684    3           CASE(ELSE);
     1001     9685    3               CALL ARG_ERROR(45);
     1002     9686    3               END;
     1003     9687
     1004     9688        /*E*  ERROR: ZII-41-1
     1005     9689              MESSAGE: Bad 3rd argument in ACCEPT CALL.
     1006     9690                       The correct syntax is
     1007     9691                       CALL ACCEPT(RETURN-VARIABLE,RECORD-NAME/AREA-NAME,CURRENCY) */
     1008     9692        /*E*  ERROR: ZII-43-1
     1009     9693              MESSAGE: Required keyword CURRENCY/NEXT/PRIOR/OWNER missing
     1010     9694                       in ACCEPT CALL with 2nd argument a SET-NAME.  */
     1011     9695        /*E*  ERROR: ZII-44-1
     1012     9696              MESSAGE: Bad 2nd argument in ACCEPT CALL.
     1013     9697                       Must be a RECORD-NAME/SET-NAME/AREA-NAME.  */
     1014     9698        /*E*  ERROR: ZII-45-1
     1015     9699              MESSAGE: Number of arguments passed to ACCEPT CALL is less than 2.  */
     1016     9700
     1017     9701    2           IPT_ACC.V_=VECTOR(IPT_ACC.V);
     1018     9702                %CLIMB(FCN=ACC);
     1019     9716    2           END;
     1020     9717    1       FPTS.V_=VECTOR(FPTS.V);
     1021     9718    1       GOTO COMMON_RETURN;
     1022     9719         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:34   
     1023     9720    1   STORE: ENTRY(A1);
     1024     9721
     1025     9722        /*E*  ERROR: ZII-50-1
     1026     9723              MESSAGE: The argument in STORE CALL is not a RECORD-NAME. */
     1027     9724    1       CALL SET_ARGS;
     1028     9725    1       IF NO_ARGS~=1 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(50);
     1029     9726    1       IPT_STO.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1030     9727    1       IPT_STO.V_ = VECTOR(IPT_STO.V);
     1031     9728    1       CALL CHK_RETAIN(IPT_STO.V.RLCW,0);
     1032     9729            %CLIMB(FCN=STO);
     1033     9743    1       GOTO COMMON_RETURN;
     1034     9744
     1035     9745    1   CHECK: ENTRY(A1,A2);
     1036     9746
     1037     9747    1       CALL SET_ARGS;
     1038     9748    1       IF NO_ARGS=0 OR NO_ARGS>2 THEN
     1039     9749    1           CALL ARG_ERROR(53);
     1040     9750    1       IPT_CHK.CHKPT_NUMBER_=VECTOR(A1(0));
     1041     9751        /*E*  ERROR: ZII-53-1
     1042     9752              MESSAGE: Argument count error in CHECK CALL.
     1043     9753                       The correct format is
     1044     9754                       CALL CHECK(checkpoint-number [,returned-status]) */
     1045     9755    1       IF ADDR(A2)=ADDR(NIL) THEN
     1046     9756    1           IPT_CHK.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);
     1047     9757    1       ELSE
     1048     9758    1           IPT_CHK.ERROR_=VECTOR(ADDR(A2)->CHAR7);
     1049     9759    1       IPT_CHK.IA_=FPTS.IA_;
     1050     9760            %CLIMB(FCN=CHK);
     1051     9774    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);
     1052     9775    1       GOTO COMMON_RETURN;
     1053     9776         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:35   
     1054     9777    1   ERASER: ENTRY(A1,A2);
     1055     9778
     1056     9779        /*E*  ERROR: ZII-55-1
     1057     9780              MESSAGE: Bad arguments found in ERASE CALL.
     1058     9781                       The correct syntax is CALL ERASE([RECORD-NAME][,ALL]). */
     1059     9782    1       CALL SET_ARGS;
     1060     9783    1       IPT_ERS.V.RC.RC_OFFSET#=NULL_OFFSET;
     1061     9784    1       IF NO_ARGS>0 THEN
     1062     9785    2       DO;
     1063     9786    2           IF ARG.TYPE(0)=%RECORD_NAME THEN
     1064     9787    2               IPT_ERS.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1065     9788    2           ELSE IF ARG.TYPE(0)=SNA.ALL THEN
     1066     9789    2                   IPT_ERS.V.ECW.EC_BIT#='1'B;
     1067     9790    2               ELSE CALL ARG_ERROR(55);
     1068     9791    2           IF ADDR(A2)=ADDR(SNA.ALL) THEN IPT_ERS.V.ECW.EC_BIT#='1'B;
     1069     9792    2           END;
     1070     9793    1       IPT_ERS.V_ = VECTOR(IPT_ERS.V);
     1071     9794            %CLIMB(FCN=ERS);
     1072     9808    1       GOTO COMMON_RETURN;
     1073     9809         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:36   
     1074     9810        /**   COMMON CALLING SEQUENCES FOR 'CALL FIND(DBKEY)'   **/
     1075     9811
     1076     9812    1   FINDBKEY: PROC;
     1077     9813
     1078     9814    2       CALL CHK_RETAIN(IPT_FDR.V.RLCW,0);
     1079     9815    2       IPT_FDR.V_ = VECTOR(IPT_FDR.V);
     1080     9816    3       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1081     9817    3           VBOUND(IPT_FDR.V_) = VBOUND(IPT_FDR.V_) +
     1082     9818    3              SIZEC(IPT_FDR.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1083     9819    3           END;
     1084     9820            %CLIMB(FCN=FDR);
     1085     9834    2       FPTS.V_=VECTOR(FPTS.V);
     1086     9835    2   END;
     1087     9836
     1088     9837    1   FIND: ENTRY(
     1089     9838               %GEN_PARAMS;
     1090    10379
     1091    10380    1       CALL SET_ARGS;
     1092    10381    1       IF NO_ARGS=1 AND ARG.TYPE(0)=SNA.CURRENT THEN
     1093    10382    2       DO;
     1094    10383    2           CALL CHK_RETAIN(IPT_FCR.V.RLCW,0); /* CALL FIND(CURRENT) */
     1095    10384    2           IPT_FCR.V_ = VECTOR(IPT_FCR.V);
     1096    10385                %CLIMB(FCN=FCR); /* FIND CURRENT OF RUN */
     1097    10399    2           GOTO COMMON_RETURN;
     1098    10400    2           END;
     1099    10401        /*E*  ERROR: ZII-60-1
     1100    10402              MESSAGE: Syntax error in FIND CALL.
     1101    10403                       Argument count is less than 2.  */
     1102    10404    1       IF NO_ARGS<2 THEN CALL ARG_ERROR(60);
     1103    10405    1       IF ARG.TYPE(NO_ARGS-2)=SNA.USING THEN
     1104    10406    2       DO;
     1105    10407        /**************************************************************/
     1106    10408        /*                                                            */
     1107    10409        /*     TYPE OF FIND: USING KEY (KEY IN INDEX)                 */
     1108    10410        /*                                                            */
     1109    10411        /*                FIRST[,REC-NAME]                            */
     1110    10412        /*     CALL FIND(<NEXT [,REC-NAME]>,USING,KEY-NAME)           */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:37   
     1111    10413        /*                  REC-NAME                                  */
     1112    10414        /*                                                            */
     1113    10415        /**************************************************************/
     1114    10416
     1115    10417    2           IF ARG.TYPE(0)=%RECORD_NAME THEN
     1116    10418    3           DO;
     1117    10419    3               IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(65);
     1118    10420        /*E*  ERROR: ZII-65-1
     1119    10421              MESSAGE: Bad 3rd argument in FIND CALL.
     1120    10422                       The correct syntax is CALL FIND(RECORD-NAME,USING,KEY-NAME) */
     1121    10423    3               IPT_FUI.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1122    10424    3               IPT_FUI.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1123    10425    3               IPT_FUI.V_ = VECTOR(IPT_FUI.V);
     1124    10426    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1125    10427    4                   VBOUND(IPT_FUI.V_) = VBOUND(IPT_FUI.V_) +
     1126    10428    4                      SIZEC(IPT_FUI.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1127    10429    4                   END;
     1128    10430    3               CALL CHK_RETAIN(IPT_FUI.V.RLCW,0);
     1129    10431                    %CLIMB(FCN=FUI);
     1130    10445    3               END;
     1131    10446    2           ELSE
     1132    10447    3           DO;
     1133    10448    3               IF ARG.TYPE(0)=SNA.FIRST THEN
     1134    10449    3                   IPT_FRI.V.FCW.RECORD_LOCATION#=0;
     1135    10450    3               ELSE
     1136    10451    3                   IF ARG.TYPE(0)=SNA.NEXT THEN
     1137    10452    3                       IPT_FRI.V.FCW.RECORD_LOCATION#=1;
     1138    10453    3                   ELSE
     1139    10454    3                       CALL ARG_ERROR(70);
     1140    10455        /*E*  ERROR: ZII-70-1
     1141    10456              MESSAGE: Required keyword FIRST/NEXT missing in
     1142    10457                       CALL FIND(NEXT/FIRST,[RECORD-NAME],USING,KEY-NAME) */
     1143    10458    3               IF ARG.TYPE(2)=SNA.USING THEN
     1144    10459    4               DO;
     1145    10460    4                   IF ARG.TYPE(1)~=%RECORD_NAME OR ARG.TYPE(3)~=%SET_NAME THEN
     1146    10461    4                       CALL ARG_ERROR(75);
     1147    10462        /*E*  ERROR: ZII-75-1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:38   
     1148    10463              MESSAGE: The 2nd argument in FIND CALL is not a RECORD-NAME,
     1149    10464                       or the 4th argument is not a SET-NAME.
     1150    10465                       The correct syntax is
     1151    10466                       CALL FIND(NEXT/FIRST,RECORD-NAME,USING,KEY-NAME) */
     1152    10467    4                   IPT_FRI.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1153    10468    4                   IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(3);
     1154    10469    4                   END;
     1155    10470    3               ELSE IF NO_ARGS=3 AND ARG.TYPE(2)=%SET_NAME THEN
     1156    10471    4                   DO;
     1157    10472    4                       IPT_FRI.V.RC.RC_OFFSET#=NULL_OFFSET;
     1158    10473    4                       IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1159    10474    4                       END;
     1160    10475    3                   ELSE
     1161    10476    3                       CALL ARG_ERROR(80);
     1162    10477        /*E*  ERROR: ZII-80-1
     1163    10478              MESSAGE: 3rd argument in FIND CALL is not a KEY-NAME.
     1164    10479                       The correct syntax is
     1165    10480                       CALL FIND(FIRST/NEXT,USING,KEY-NAME)  */
     1166    10481    3               CALL CHK_RETAIN(IPT_FRI.V.RLCW,0);
     1167    10482    3               IPT_FRI.V_ = VECTOR(IPT_FRI.V);
     1168    10483    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1169    10484    4                   VBOUND(IPT_FRI.V_) = VBOUND(IPT_FRI.V_) +
     1170    10485    4                      SIZEC(IPT_FRI.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1171    10486    4                   END;
     1172    10487                    %CLIMB(FCN=FRI);
     1173    10501    3               END;
     1174    10502    2           END;
     1175    10503         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:39   
     1176    10504    1       ELSE
     1177    10505    2       DO;
     1178    10506    3           DO CASE(ARG.TYPE(0));
     1179    10507    3           CASE(%RECORD_NAME);
     1180    10508    3               IF ARG.TYPE(1)=SNA.DBKEY THEN
     1181    10509    4               DO;
     1182    10510
     1183    10511        /****************************************************************/
     1184    10512        /*                                                              */
     1185    10513        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1186    10514        /*                                                              */
     1187    10515        /*            CALL FIND(REC-NAME,DBKEY,IDENTIFIER)              */
     1188    10516        /*                                                              */
     1189    10517        /****************************************************************/
     1190    10518
     1191    10519    4                   IPT_FDR.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1192    10520    4                   IPT_FDR.DBK_=VECTOR(A3);
     1193    10521    4                   CALL FINDBKEY;
     1194    10522    4                   END;
     1195    10523    3               ELSE IF ARG.TYPE(1)=SNA.WITHIN THEN
     1196    10524    4                   DO;
     1197    10525
     1198    10526        /***************************************************************/
     1199    10527        /*                                                             */
     1200    10528        /*            TYPE OF FIND: WITH KEY WITHIN CURRENT SET        */
     1201    10529        /*                                                             */
     1202    10530        /*            CALL FIND(REC-NAME,WITHIN,SET-NAME,[CURRENT]     */
     1203    10531        /*                      [,IDENT-5],[IDENT-6],....])            */
     1204    10532        /*                                                             */
     1205    10533        /***************************************************************/
     1206    10534
     1207    10535    4                       IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(85);
     1208    10536        /*E*  ERROR: ZII-85-1
     1209    10537              MESSAGE: 3rd argument in FIND CALL is not a SET-NAME.
     1210    10538                       The correct syntax is
     1211    10539                       CALL FIND(RECORD-NAME,WITHIN,SET-NAME,[CURRENT],...) */
     1212    10540    4                       IPT_FKC.V.RC.RC_OFFSET#=ARG.OFFSET(0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:40   
     1213    10541    4                       IPT_FKC.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1214    10542    4                       IF NO_ARGS>3 AND ARG.TYPE(3)=SNA.CURRENT THEN
     1215    10543    4                           I=4; ELSE I=3;
     1216    10544    5                       DO J=I TO NO_ARGS-1;
     1217    10545        /*E*  ERROR: ZII-90-1
     1218    10546              MESSAGE: The variable length argument list in FIND CALL
     1219    10547                       does not contain all FIELD-NAMES. The correct syntax is
     1220    10548                       CALL FIND(REC-NAME,WITHIN,SET-NAME,FIELD-NAME,....).  */
     1221    10549    5                           IF ARG.TYPE(J)~=%FIELD_NAME THEN CALL ARG_ERROR(90);
     1222    10550    5                           IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#(J-I)=ARG.OFFSET(J);
     1223    10551    5                           END;
     1224    10552    4                       IPT_FKC.V.FLCW.N_FIELDS#=NO_ARGS-I;
     1225    10553    4                       CALL CHK_RETAIN(IPT_FKC.V.RLCW,IPT_FKC.V.FLCW.N_FIELDS#);
     1226    10554    4                       IPT_FKC.V_ = VECTOR(IPT_FKC.V);
     1227    10555    4                       IF RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# ~= 0
     1228    10556    5                       THEN DO;
     1229    10557    5                           VBOUND(IPT_FKC.V_) = VBOUND(IPT_FKC.V_) +
     1230    10558    5                              SIZEC(IPT_FKC.V.FL_RL_LIST) *
     1231    10559    5                              (RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# - 1 );
     1232    10560    5                           END;
     1233    10561    4                       IF I = 3
     1234    10562    5                       THEN DO;
     1235    10563                                %CLIMB(FCN=FKY);
     1236    10577    5                           END;
     1237    10578    5                       ELSE DO;
     1238    10579                                %CLIMB(FCN=FKC);
     1239    10593    5                           END;
     1240    10594    4                       END;
     1241    10595    3                   ELSE CALL ARG_ERROR(95);
     1242    10596        /*E*  ERROR: ZII-95-1
     1243    10597              MESSAGE: Unknown type of FIND.
     1244    10598                       Required keyword DBKEY/WITHIN missing after
     1245    10599                       the 1st argument of a RECORD-NAME.  */
     1246    10600         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:41   
     1247    10601    3           CASE(%DBKEY);
     1248    10602
     1249    10603        /****************************************************************/
     1250    10604        /*                                                              */
     1251    10605        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1252    10606        /*                                                              */
     1253    10607        /*            CALL FIND(DBKEY,IDENTIFIER)                       */
     1254    10608        /*                                                              */
     1255    10609        /****************************************************************/
     1256    10610
     1257    10611    3               IPT_FDR.V.RC.RC_OFFSET#=NULL_OFFSET;
     1258    10612    3               IPT_FDR.DBK_=VECTOR(A2);
     1259    10613    3               CALL FINDBKEY;
     1260    10614    3           CASE(%ANY,%DUPLICATE);
     1261    10615        /**************************************************************/
     1262    10616        /*                                                            */
     1263    10617        /*       TYPE OF FIND: WITH CALC KEY                          */
     1264    10618        /*                                                            */
     1265    10619        /*       CALL FIND(ANY/DUPANY,REC-NAME)                       */
     1266    10620        /*                                                            */
     1267    10621        /**************************************************************/
     1268    10622
     1269    10623    3               IF ARG.TYPE(1)=%RECORD_NAME THEN
     1270    10624    4               DO;
     1271    10625    4                   IF NO_ARGS>2 THEN CALL ARG_ERROR(100);
     1272    10626        /*E*  ERROR: ZII-100-1
     1273    10627              MESSAGE: Argument count error in FIND CALL.
     1274    10628                       The correct syntax is
     1275    10629                       CALL FIND(ANY/DUPLICATE,RECORD-NAME). */
     1276    10630    4                   IPT_FDC.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1277    10631    4                   CALL CHK_RETAIN(IPT_FDC.V.RLCW,0);
     1278    10632    5                   IF A1(0)=SNA.ANY THEN DO;
     1279    10633    5                       IPT_FDC.V_ = VECTOR(IPT_FDC.V);
     1280    10634    6                       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1281    10635    6                           VBOUND(IPT_FDC.V_) = VBOUND(IPT_FDC.V_) +
     1282    10636    6                              SIZEC(IPT_FDC.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1283    10637    6                           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:42   
     1284    10638                            %CLIMB(FCN=FDC);
     1285    10652    5                       END;
     1286    10653    5                   ELSE DO;
     1287    10654    5                       IPT_FCD.V_ = VECTOR(IPT_FCD.V);
     1288    10655                            %CLIMB(FCN=FCD);
     1289    10669    5                       END;
     1290    10670    4                   END;
     1291    10671    3               ELSE
     1292    10672    4               DO;
     1293    10673         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:43   
     1294    10674        /*************************************************************/
     1295    10675        /*                                                           */
     1296    10676        /*       TYPE OF FIND: DUPLICATE RECORD WITHIN A SET         */
     1297    10677        /*                                                           */
     1298    10678        /*       CALL FIND(DUPSET,SET-NAME,IDENT-2,[IDENT-3],...])   */
     1299    10679        /*                                                           */
     1300    10680        /*************************************************************/
     1301    10681
     1302    10682    4                   IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS<3 THEN CALL ARG_ERROR(105);
     1303    10683        /*E*  ERROR: ZII-105-1
     1304    10684              MESSAGE: Argument count error, or the 2nd argument in
     1305    10685                     CALL FIND(DUPLICATE,SET-NAME,FIELD-NAME1,....)
     1306    10686                     is not a SET-NAME.  */
     1307    10687    4                   IPT_FDP.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1308    10688    4                   IPT_FDP.V.FLCW.N_FIELDS#=NO_ARGS-2;
     1309    10689    5                   DO I=0 TO NO_ARGS-3;
     1310    10690    5                       IF ARG.TYPE(I+2)~=%FIELD_NAME THEN CALL ARG_ERROR(110);
     1311    10691        /*E*  ERROR: ZII-110-1
     1312    10692            MESSAGE: The variable length list in FIND CALL does not contain all FIELD-NAMES.
     1313    10693                       The correct syntax is
     1314    10694                       CALL FIND(DUPSET,SET-NAME,FIELD-NAME1,....)  */
     1315    10695    5                       IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I+2);
     1316    10696    5                       END;
     1317    10697    4                   CALL CHK_RETAIN(IPT_FDP.V.RLCW,IPT_FDP.V.FLCW.N_FIELDS#);
     1318    10698    4                   IPT_FDP.V_ = VECTOR(IPT_FDP.V);
     1319    10699    5                   IF RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# ~= 0 THEN DO;
     1320    10700    5                       VBOUND(IPT_FDP.V_) = VBOUND(IPT_FDP.V_) +
     1321    10701    5                          SIZEC(IPT_FDP.V.FL_RL_LIST) *
     1322    10702    5                          (RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# - 1);
     1323    10703    5                       END;
     1324    10704                        %CLIMB(FCN=FDP);
     1325    10718    4                   END;
     1326    10719         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:44   
     1327    10720    3           CASE(%NEXT,%PRIOR,%CURRENT);
     1328    10721    3               IF NO_ARGS=2 AND ARG.TYPE(1)=%RECORD_NAME AND A1(0)=SNA.CURRENT THEN
     1329    10722
     1330    10723        /******************************************************************/
     1331    10724        /*                                                                */
     1332    10725        /*       TYPE OF FIND: CURRENT OF RECORD                          */
     1333    10726        /*                                                                */
     1334    10727        /*       CALL FIND(CURRENT,REC-NAME)                              */
     1335    10728        /*                                                                */
     1336    10729        /******************************************************************/
     1337    10730    4               DO;
     1338    10731    4                   IPT_FCT.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1339    10732    4                   CALL CHK_RETAIN(IPT_FCT.V.RLCW,0);
     1340    10733    4                   IPT_FCT.V_ = VECTOR(IPT_FCT.V);
     1341    10734    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1342    10735    5                       VBOUND(IPT_FCT.V_) = VBOUND(IPT_FCT.V_) +
     1343    10736    5                          SIZEC(IPT_FCT.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1344    10737    5                       END;
     1345    10738                        %CLIMB(FCN=FCT);
     1346    10752    4                   END;
     1347    10753    3               ELSE
     1348    10754         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:45   
     1349    10755        /****************************************************************/
     1350    10756        /*                                                              */
     1351    10757        /*       TYPE OF FIND: RELATIVE TO A SET OR A AREA              */
     1352    10758        /*                                                              */
     1353    10759        /*                 PRIOR                                        */
     1354    10760        /*       CALL FIND(CURRENT,[REC-NAME],SET-NAME)                 */
     1355    10761        /*                 NEXT               AREA-NAME                 */
     1356    10762        /*                                                              */
     1357    10763        /****************************************************************/
     1358    10764    4               DO;
     1359    10765    4                   IF ARG.TYPE(0)=SNA.PRIOR THEN
     1360    10766    4                       IPT_FRS.V.FCW.RECORD_LOCATION#=0;
     1361    10767    4                   ELSE
     1362    10768    4                       IF ARG.TYPE(0)=SNA.CURRENT THEN
     1363    10769    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=1;
     1364    10770    4                       ELSE
     1365    10771    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=2;
     1366    10772    5                   DO CASE(NO_ARGS);
     1367    10773
     1368    10774    5                   CASE(3);
     1369    10775    5                       IF ARG.TYPE(1)~=%RECORD_NAME THEN CALL ARG_ERROR(115);
     1370    10776        /*E*  ERROR: ZII-115-1
     1371    10777              MESSAGE: Argument count error, or 2nd argument in
     1372    10778                       CALL FIND(PRIOR/CURRENT/NEXT,RECORD-NAME,SET-NAME/AREA-NAME)
     1373    10779                       is not a RECORD-NAME.  */
     1374    10780    5                       IPT_FRS.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1375    10781    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1376    10782    5                   CASE(2);
     1377    10783    5                       IPT_FRS.V.RC.RC_OFFSET#=NULL_OFFSET;
     1378    10784    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1379    10785    5                   CASE(ELSE);
     1380    10786    5                       CALL ARG_ERROR(115);
     1381    10787    5                       END;
     1382    10788    4                   CALL CHK_RETAIN(IPT_FRS.V.RLCW,0);
     1383    10789    5                   DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);
     1384    10790
     1385    10791    5                   CASE(%AREA_NAME_NET);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:46   
     1386    10792    5                       IPT_FRA.V_ = VECTOR(IPT_FRA.V);
     1387    10793                            %CLIMB(FCN=FRA);
     1388    10807    5                   CASE(%SET_NAME_NET);
     1389    10808    5                       IPT_FRS.V_ = VECTOR(IPT_FRS.V);
     1390    10809    5                       VBOUND(IPT_FRS.V_) = VBOUND(IPT_FRS.V_) +
     1391    10810    5                          SIZEC(IPT_FRS.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1392    10811                            %CLIMB(FCN=FRS);
     1393    10825    5                   CASE(ELSE);
     1394    10826    5                       CALL ARG_ERROR(120);
     1395    10827        /*E*  ERROR: ZII-120-1
     1396    10828              MESSAGE: The last argument in
     1397    10829                       CALL FIND(NEXT/PRIOR/CURRENT,[REC-NAME],SET-NAME/AREA-NAME)
     1398    10830                       is neither a SET-NAME nor an AREA-NAME.  */
     1399    10831    5                       END;
     1400    10832    4                   END;
     1401    10833         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:47   
     1402    10834    3           CASE(%OWNER);
     1403    10835
     1404    10836        /***************************************************************/
     1405    10837        /*                                                             */
     1406    10838        /*       TYPE OF FIND: OWNER OF A SET                          */
     1407    10839        /*                                                             */
     1408    10840        /*       CALL FIND(OWNER,SET-NAME)                             */
     1409    10841        /*                                                             */
     1410    10842        /***************************************************************/
     1411    10843
     1412    10844    3               IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS>2 THEN CALL ARG_ERROR(125);
     1413    10845        /*E*  ERROR: ZII-125-1
     1414    10846              MESSAGE: Argument count error, or the 2nd argument in
     1415    10847                       CALL FIND(OWNER,SET-NAME) is not a SET-NAME. */
     1416    10848    3               IPT_FOR.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1417    10849    3               CALL CHK_RETAIN(IPT_FOR.V.RLCW,0);
     1418    10850    3               IPT_FOR.V_ = VECTOR(IPT_FOR.V);
     1419    10851    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1420    10852    4                   VBOUND(IPT_FOR.V_) = VBOUND(IPT_FOR.V_) +
     1421    10853    4                      SIZEC(IPT_FOR.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1422    10854    4                   END;
     1423    10855                    %CLIMB(FCN=FOR);
     1424    10869    3           CASE(ELSE);
     1425    10870         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:48   
     1426    10871        /**************************************************************/
     1427    10872        /*                                                            */
     1428    10873        /*       TYPE OF FIND: I-TH NUMBER WITHIN A SET OR A AREA     */
     1429    10874        /*                                                            */
     1430    10875        /*       CALL FIND(FIRST,[REC-NAME],SET-NAME )                */
     1431    10876        /*                 LAST             AREA-NAME                 */
     1432    10877        /*                 INTEGER                                    */
     1433    10878        /*                 IDENTIFIER                                 */
     1434    10879        /*                                                            */
     1435    10880        /**************************************************************/
     1436    10881
     1437    10882    3               IPT_FAA.V.AC.AC_OFFSET#=ARG.OFFSET(NO_ARGS-1);
     1438    10883    3               IF ARG.TYPE(0)=%LAST THEN
     1439    10884
     1440    10885    3                   IPT_FAS.V.RECORD_NUMBER#=-1;
     1441    10886    3               ELSE
     1442    10887    3                   IF ARG.TYPE(0)=%FIRST THEN
     1443    10888    3                       IPT_FAS.V.RECORD_NUMBER#=1;
     1444    10889    3                   ELSE
     1445    10890    3                       IPT_FAS.V.RECORD_NUMBER#=A1(0);
     1446    10891    3               IF NO_ARGS>2 AND ARG.TYPE(1)=%RECORD_NAME THEN
     1447    10892    3                   IPT_FAS.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1448    10893    3               ELSE
     1449    10894    3                   IPT_FAS.V.RC.RC_OFFSET#=NULL_OFFSET;
     1450    10895    3               CALL CHK_RETAIN(IPT_FAS.V.RLCW,0);
     1451    10896    3               IF NO_ARGS>3 THEN CALL ARG_ERROR(130);
     1452    10897    4               DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);
     1453    10898
     1454    10899    4               CASE(%AREA_NAME_NET);
     1455    10900    4                   IPT_FAA.V_ = VECTOR(IPT_FAA.V);
     1456    10901    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1457    10902    5                       VBOUND(IPT_FAA.V_) = VBOUND(IPT_FAA.V_) +
     1458    10903    5                          SIZEC(IPT_FAA.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1459    10904    5                       END;
     1460    10905                        %CLIMB(FCN=FAA);
     1461    10919    4               CASE(%SET_NAME_NET);
     1462    10920    4                   IPT_FAS.V_ = VECTOR(IPT_FAS.V);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:49   
     1463    10921                        %CLIMB(FCN=FAS);
     1464    10935    4               CASE(ELSE);
     1465    10936    4                   CALL ARG_ERROR(130);
     1466    10937        /*E*  ERROR: ZII-130-1
     1467    10938              MESSAGE: Argument count error, or the last argument in
     1468    10939                       CALL FIND(FIRST/LAST/FORT-VAR,[REC-NAME],SET-NAME/AREA-NAME)
     1469    10940                       is neither a SET-NAME nor an AREA-NAME. */
     1470    10941    4                   END;
     1471    10942    3               END;
     1472    10943    2           END;
     1473    10944    1       GOTO COMMON_RETURN;
     1474    10945         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:50   
     1475    10946        /***************************************************************/
     1476    10947        /*                                                             */
     1477    10948        /*     CALLING SEQUENCE FOR GET:                               */
     1478    10949        /*          1. CALL GET                                        */
     1479    10950        /*          2. CALL GET(REC-NAME)                              */
     1480    10951        /*          3. CALL GET(FIELD-1,[FIELD-2],.....])              */
     1481    10952        /*                                                             */
     1482    10953        /***************************************************************/
     1483    10954
     1484    10955    1   GET: ENTRY(
     1485    10956               %GEN_PARAMS;
     1486    11497
     1487    11498    1       CALL SET_ARGS;
     1488    11499    1       IF NO_ARGS>0 AND ARG.TYPE(0)=%FIELD_NAME THEN
     1489    11500    2       DO;
     1490    11501    2           IPT_GTF.V.FLCW.N_FIELDS#=NO_ARGS;
     1491    11502    3           DO I=0 TO NO_ARGS-1;
     1492    11503    3               IF ARG.TYPE(I)~=%FIELD_NAME THEN CALL ARG_ERROR(140);
     1493    11504        /*E*  ERROR: ZII-140-1
     1494    11505              MESSAGE: The argument list in GET CALL does not contain FIELD-NAMES.
     1495    11506                       The correct syntax is CALL GET(FIELD-NAME,....). */
     1496    11507    3               IPT_GTF.V.FIELD_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I);
     1497    11508    3               END;
     1498    11509    2           IPT_GTF.V_ = VECTOR(IPT_GTF.V);
     1499    11510    3           IF NO_ARGS > 1 THEN DO;
     1500    11511    3               VBOUND(IPT_GTF.V_) = VBOUND(IPT_GTF.V_) +
     1501    11512    3                  SIZEC(IPT_GTF.V.FIELD_LIST) * (NO_ARGS-1);
     1502    11513    3               END;
     1503    11514                %CLIMB(FCN=GTF);
     1504    11528    2           END;
     1505    11529    1       ELSE
     1506    11530    2       DO;
     1507    11531    2           IF NO_ARGS=0 THEN
     1508    11532    2               IPT_GET.V.RC.RC_OFFSET#=NULL_OFFSET;
     1509    11533    2           ELSE
     1510    11534    2               IF ARG.TYPE(0)=%RECORD_NAME THEN
     1511    11535    2                   IPT_GET.V.RC.RC_OFFSET#=ARG.OFFSET(0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:51   
     1512    11536    2               ELSE CALL ARG_ERROR(145);
     1513    11537        /*E*  ERROR: ZII-145-1
     1514    11538              MESSAGE: Unknown 1st argument in GET CALL.
     1515    11539                       It is neither a RECORD-NAME nor a FIELD-NAME.  */
     1516    11540    2           IPT_GET.V_ = VECTOR(IPT_GET.V);
     1517    11541                %CLIMB(FCN=GET);
     1518    11555    2           END;
     1519    11556    1       GOTO COMMON_RETURN;
     1520    11557         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:52   
     1521    11558    1   MODIFY: ENTRY(
     1522    11559               %GEN_PARAMS;
     1523    12100
     1524    12101        /******************************************************************/
     1525    12102        /*                                                                */
     1526    12103        /*    CALL MODIFY([REC-NAME],[INCLUDING,ALL             ])        */
     1527    12104        /*                           ONLY      SET-NAME1,[...]            */
     1528    12105        /*                                                                */
     1529    12106        /*    CALL MODIFY(IDENT-1,[IDENT-2],...,,[INCLUDING,ALL       ])  */
     1530    12107        /*                                                SET-NAME-LIST   */
     1531    12108        /*                                                                */
     1532    12109        /******************************************************************/
     1533    12110
     1534    12111    1       CALL SET_ARGS;
     1535    12112    1       IPT_MOD.V.RC.RC_OFFSET#=NULL_OFFSET;
     1536    12113    1       IF NO_ARGS>0 THEN
     1537    12114    2       DO;
     1538    12115    2           K=0;
     1539    12116    2           KK = 0; /* count dynamic structures */
     1540    12117    2           IF ARG.TYPE(0)=%RECORD_NAME THEN
     1541    12118    3           DO;
     1542    12119    3               K=1;
     1543    12120    3               KK = 1;
     1544    12121    3               IPT_MOD.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1545    12122    3               END;
     1546    12123    2           ELSE
     1547    12124    3           DO;
     1548    12125    4               DO WHILE(ARG.TYPE(K)=%FIELD_NAME AND K<NO_ARGS);
     1549    12126    4                   IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(K)=ARG.OFFSET(K);
     1550    12127    4                   IPT_MOD.V.FLCW.N_FIELDS#=IPT_MOD.V.FLCW.N_FIELDS#+1;
     1551    12128    4                   K=K+1;
     1552    12129    4                   KK = KK + 1;
     1553    12130    4                   END;
     1554    12131    3               END;
     1555    12132    2           IF K<NO_ARGS-1 AND (ARG.TYPE(K)=SNA.ONLY OR ARG.TYPE(K)=SNA.INCLUDING) THEN
     1556    12133    3           DO;
     1557    12134    3               IF ARG.TYPE(K)=SNA.ONLY THEN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:53   
     1558    12135    4               DO;
     1559    12136    4                   IPT_MOD.V.MCW.MC_BIT0#='1'B;
     1560    12137    4                   IF IPT_MOD.V.FLCW.N_FIELDS#>0 THEN CALL ARG_ERROR(153);
     1561    12138    4                   END;
     1562    12139        /*E*  ERROR: ZII-153-1
     1563    12140              MESSAGE: Keyword ONLY not legal in MODIFY CALL
     1564    12141                       in conjunction with FIELD-NAME list.  */
     1565    12142    3               K=K+1;
     1566    12143    3               IF ARG.TYPE(K)=SNA.ALL THEN
     1567    12144    3                   IPT_MOD.V.MCW.MC_BIT1#='1'B;
     1568    12145    3               ELSE
     1569    12146    4               DO;
     1570    12147    5                   DO WHILE (K<NO_ARGS);
     1571    12148    5                       IF ARG.TYPE(K)~=%SET_NAME THEN CALL ARG_ERROR(150);
     1572    12149        /*E*  ERROR: ZII-150-1
     1573    12150              MESSAGE: Bad arguments found in MODIFY CALL
     1574    12151                       after keyword ONLY/INCLUDING.              */
     1575    12152    5                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#
     1576    12153    5                          (IPT_MOD.V.FLCW.N_FIELDS#+IPT_MOD.V.SLCW.N_SETS#)
     1577    12154    5                          =ARG.OFFSET(K);
     1578    12155    5                       IPT_MOD.V.SLCW.N_SETS#=IPT_MOD.V.SLCW.N_SETS#+1;
     1579    12156    5                       K=K+1;
     1580    12157    5                       KK = KK + 1;
     1581    12158    5                       END;
     1582    12159    4                   END;
     1583    12160    3               END;
     1584    12161    2           ELSE
     1585    12162    2               IF K<NO_ARGS THEN CALL ARG_ERROR(155);
     1586    12163        /*E*  ERROR: ZII-155-1
     1587    12164              MESSAGE: Bad arguments found in MODIFY CALL.  */
     1588    12165    2           END;
     1589    12166    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);
     1590    12167    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);
     1591    12168    2       IF KK ~= 0 THEN DO;
     1592    12169    2           VBOUND(IPT_MOD.V_) = VBOUND(IPT_MOD.V_) +
     1593    12170    2              SIZEC(IPT_MOD.V.FL_SL_LIST) * (KK-1);
     1594    12171    2           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:54   
     1595    12172            %CLIMB(FCN=MOD);
     1596    12186    1       GOTO COMMON_RETURN;
     1597    12187         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:55   
     1598    12188        /**   INTERNAL COMMON SUBROUTINE FOR CONNECT AND DISCONNECT   **/
     1599    12189
     1600    12190    1   CON_DIS: PROC ALTRET;
     1601    12191
     1602    12192    2       CALL SET_ARGS;
     1603    12193
     1604    12194    3       DO CASE(NO_ARGS);
     1605    12195
     1606    12196    3       CASE(2);
     1607    12197    3           IF ARG.TYPE(0)~=%RECORD_NAME OR ARG.TYPE(1)~=%SET_NAME THEN CALL ARG_ERROR(
             12197                    160);
     1608    12198        /*E*  ERROR: ZII-160-1
     1609    12199              MESSAGE: Bad arguments found in CONNECT/DISCONNECT CALL.
     1610    12200                       The correct syntax is
     1611    12201                       CALL CONNECT/DISCONNECT(RECORD-NAME,SET-NAME). */
     1612    12202    3           IPT_CON.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1613    12203    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1614    12204    3       CASE(1);
     1615    12205    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(165);
     1616    12206        /*E*  ERROR: ZII-165-1
     1617    12207              MESSAGE: The only argument in CONNECT/DISCONNECT CALL
     1618    12208                       is not a SET-NAME.  */
     1619    12209    3           IPT_CON.V.RC.RC_OFFSET#=NULL_OFFSET;
     1620    12210    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(0);
     1621    12211    3       CASE(ELSE);
     1622    12212    3           CALL ARG_ERROR(170);
     1623    12213        /*E*  ERROR: ZII-170-1
     1624    12214              MESSAGE: Wrong number of arguments in CONNECT/DISCONNECT CALL. */
     1625    12215    3           END;
     1626    12216    2   END CON_DIS;
     1627    12217
     1628    12218    1   CONNECT: ENTRY(A1,A2);
     1629    12219
     1630    12220    1       IPT_CON.V_ = VECTOR(IPT_CON.V);
     1631    12221    1       CALL CON_DIS;
     1632    12222            %CLIMB(FCN=CON);
     1633    12236    1       GOTO COMMON_RETURN;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:56   
     1634    12237
     1635    12238    1   DISCONNECT: ENTRY(A1,A2);
     1636    12239    1   DISCONNE: ENTRY(A1,A2);
     1637    12240
     1638    12241    1       IPT_DIS.V_ = VECTOR(IPT_DIS.V);
     1639    12242    1       CALL CON_DIS;
     1640    12243            %CLIMB(FCN=DIS);
     1641    12257    1       GOTO COMMON_RETURN;
     1642    12258         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:57   
     1643    12259    1   COMMON_RETURN: /*  CHK IA(7) SEE IF ANY CLEAN-UP TO DO */
     1644    12260
     1645    12261    1       IDSSYSERR = PINCRW(IA$,5) -> SBIN36; /* MON ERR_CODE */
     1646    12262    1       IF IA_HALF(14)>0 THEN
     1647    12263    2       DO;
     1648    12264    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */
     1649    12265    2           IA_HALF(14) = 0; /* RESET FLAG */
     1650    12266    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */
     1651    12267    2           CALL EPTR$;
     1652    12268    2           END;
     1653    12269    1       IF IA_HALF(12)>0 THEN /* RETURN FROM ROLL BACK */
     1654    12270    2       DO;
     1655    12271    2           IA_HALF(12)=0; /* RESET FLAG */
     1656    12272    2           DK_RET.RET_ADDR=IA_HALF(13); /* ASL PUT RETADDR THERE */
     1657    12273    2           UNWIND TO DEADLOCK_RET;
     1658    12274    2           END;
     1659    12275    1       RETURN;
     1660    12276         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:58   
     1661    12277        /**   COMMON SUBROUTINE FOR IFT OR IST   **/
     1662    12278    1   DO_IF: PROC(A) ALTRET;
     1663    12279    2   DCL A BIT(2) ALIGNED;
     1664    12280
     1665    12281    2       CALL SET_ARGS;
     1666    12282    2       IPT_IST.V.TDW=A;
     1667    12283    3       DO CASE(NO_ARGS);
     1668    12284    3       CASE(1);
     1669    12285    3           IPT_IFT.V_ = VECTOR(IPT_IFT.V);
     1670    12286                %CLIMB(FCN=IFT);
     1671    12300    3           A1(0)=-1*UWA(0); /* UWA=0 IF F,1 IF T(FORTRAN WANT -1) */
     1672    12301    3       CASE(2);
     1673    12302    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(175);
     1674    12303        /*E*  ERROR: ZII-175-1
     1675    12304              MESSAGE: The 1st argument in IFOWNER/IFMEMBER/IFTENANT CALL
     1676    12305                       is not a SET-NAME but two arguments specified.  */
     1677    12306    3           IPT_IST.V.SC.SC_OFFSET#=ARG.OFFSET(0);
     1678    12307    3           IPT_IST.V_ = VECTOR(IPT_IST.V);
     1679    12308                %CLIMB(FCN=IST);
     1680    12322    3           A2(0)=-1*UWA(0);
     1681    12323    3       CASE(ELSE);
     1682    12324    3           CALL ARG_ERROR(180);
     1683    12325        /*E*  ERROR: ZII-180-1
     1684    12326              MESSAGE: Wrong number of arguments in
     1685    12327                       IFOWNER/IFMEMBER/IFTENANT CALL.  */
     1686    12328    3           END;
     1687    12329    2   END DO_IF;
     1688    12330         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:59   
     1689    12331    1   IFEMPTY: ENTRY(A1,A2);
     1690    12332
     1691    12333    1       CALL P_OFF_W(ADDR(A1),RVA$);
     1692    12334    1       IF I<=0 OR I>RVA_SIZE OR RVA_TYPE(I)~=%SET_NAME_NET THEN CALL ARG_ERROR(185);
     1693    12335        /*E*  ERROR: ZII-185-1
     1694    12336              MESSAGE: The 1st argument in IFEMPTY CALL is not a SET-NAME. */
     1695    12337    1       IPT_IFM.V.SC.SC_OFFSET#=I;
     1696    12338    1       IPT_IFM.V_ = VECTOR(IPT_IFM.V);
     1697    12339            %CLIMB(FCN=IFM);
     1698    12353    1       IF ADDR(A2(0))=ADDR(NIL) THEN CALL ARG_ERROR(190);
     1699    12354        /*E*  ERROR: ZII-190-3
     1700    12355              MESSAGE: Wrong number of arguments in IFEMPTY CALL.
     1701    12356                       The correct syntax is
     1702    12357                       CALL IFEMPTY(SET-NAME,LOGIC-RESULT).  */
     1703    12358    1       A2(0)=-1*UWA(0);
     1704    12359    1       GOTO COMMON_RETURN;
     1705    12360
     1706    12361    1   IFMEMBER: ENTRY(A1,A2);
     1707    12362
     1708    12363    1       CALL DO_IF('01'B);
     1709    12364    1       GOTO COMMON_RETURN;
     1710    12365
     1711    12366    1   IFOWNER: ENTRY(A1,A2);
     1712    12367
     1713    12368    1       CALL DO_IF('10'B);
     1714    12369    1       GOTO COMMON_RETURN;
     1715    12370
     1716    12371    1   IFTENANT: ENTRY(A1,A2);
     1717    12372
     1718    12373    1       CALL DO_IF('11'B);
     1719    12374    1       GOTO COMMON_RETURN;
     1720    12375        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:60   
     1721    12376    1   BUFFERS: ENTRY(A1,A2);
     1722    12377
     1723    12378    1       IPT_NBF.BUFFS_REQ_=VECTOR(A1(0));
     1724    12379    1       IPT_NBF.BUFFS_ALLOC_=VECTOR(A2(0));
     1725    12380            %CLIMB(FCN=NBF);
     1726    12394    1       GOTO COMMON_RETURN;
     1727    12395    1   CRPT: ENTRY(A1);
     1728    12396
     1729    12397    1       FPT_SHORT.VEC1=VECTOR(FPT_SHORT.VEC2);
     1730    12398    1       ADDR(FPT_SHORT.VEC2)->SBIN36=A1(0); /* MAKE SURE SEED IS DALIGNED */
     1731    12399            %CLIMB(FCN=CRPT);
     1732    12413    1       GOTO COMMON_RETURN;
     1733    12414
     1734    12415    1   ROLL: ENTRY(A1);
     1735    12416
     1736    12417    1       IF ADDR(A1)=ADDR(NIL) THEN
     1737    12418    1           FPT_SHORT.VEC1=VECTOR(PINCRW(UWA$,1)->CHAR7);
     1738    12419    1       ELSE
     1739    12420    1           FPT_SHORT.VEC1=VECTOR(ADDR(A1)->CHAR7);
     1740    12421    1       FPT_SHORT.VEC2=FPTS.IA_;
     1741    12422            %CLIMB(FCN=ROL);
     1742    12436    1       GOTO COMMON_RETURN;
     1743    12437    1   KEEP: ENTRY;
     1744    12438
     1745    12439    1       IPT_KEEP.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);
     1746    12440            %CLIMB(FCN=KEEP);
     1747    12454    1       GOTO COMMON_RETURN;
     1748    12455
     1749    12456    1   REDUCEQ: ENTRY;
     1750    12457
     1751    12458            %CLIMB(FCN=REDUCEQ);
     1752    12472    1       GOTO COMMON_RETURN;
     1753    12473        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:61   
     1754    12474    1   RPTSTATS: ENTRY;
     1755    12475
     1756    12476            %CLIMB(FCN=RPT,PARAMS=0);
     1757    12490    1       RETURN;
     1758    12491
     1759    12492    1   STATSON: ENTRY;
     1760    12493
     1761    12494            %CLIMB(FCN=STON,PARAMS=0);
     1762    12508    1       RETURN;
     1763    12509
     1764    12510    1   STATSOFF: ENTRY;
     1765    12511
     1766    12512            %CLIMB(FCN=STOFF,PARAMS=0);
     1767    12526    1       RETURN;
     1768    12527
     1769    12528    1   TRACE_COMMON: PROC;
     1770    12529
     1771    12530    2       IF ADDR(A1)=ADDR(NIL) THEN
     1772    12531    2           I=0; /* NO TRACE OPTION SPECIFIED */
     1773    12532    2       ELSE
     1774    12533    2           I=A1(0);
     1775    12534    2       FPT_SHORT.VEC1=VECTOR(I);
     1776    12535    2   END TRACE_COMMON;
     1777    12536
     1778    12537    1   TRACEOFF: ENTRY(A1);
     1779    12538
     1780    12539    1       CALL TRACE_COMMON;
     1781    12540            %CLIMB(FCN=TROFF);
     1782    12554    1       RETURN;
     1783    12555
     1784    12556    1   TRACEON: ENTRY(A1);
     1785    12557
     1786    12558    1       CALL TRACE_COMMON;
     1787    12559            %CLIMB(FCN=TRON);
     1788    12573    1       RETURN;
     1789    12574        /**************************************************************/
     1790    12575        /*                                                            */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:62   
     1791    12576        /*    CALL INVOKE(IA,UWA,RVA)                                 */
     1792    12577        /*                                                            */
     1793    12578        /*    1. REMEMBER UWA$ AND RVA$.  2.  DO A CLIMB TO 'HIA'     */
     1794    12579        /*                                                            */
     1795    12580        /**************************************************************/
     1796    12581
     1797    12582    1   INVOKE: ENTRY(A1,A2,A3);
     1798    12583
     1799    12584    1       IA$=ADDR(A1);
     1800    12585    1       UWA$=ADDR(A2);
     1801    12586    1       RVA$=ADDR(A3);
     1802    12587    1       IF RVA$ = B$DS8$ THEN
     1803    12588    1           CALL SDS$OPEN;
     1804    12589    1       IA_HALF(12) = 0; /* Roll back flag must start zero */
     1805    12590    1       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN
     1806    12591    1           CALL GET_A_PAGE;
     1807    12592    1       IF RVA_HALF(0)<131072 THEN
     1808    12593    1           RVA_SIZE=RVA_HALF(0);
     1809    12594    1       ELSE
     1810    12595    1           RVA_SIZE=RVA_HALF(0)-131072;
     1811    12596    1       UWA_SIZE=A1(1);
     1812    12597    1       CALL VEC_MAKER(A1,47,FPTS.IA_);
     1813    12598    1       CALL VEC_MAKER(A2,UWA_SIZE,FPTS.UWA_);
     1814    12599    1       CALL VEC_MAKER(A3,RVA_SIZE,FPTS.RVA_);
     1815    12600    1       IF RVA_HALF(0)<131072 OR
     1816    12601    2          (RVA$ = B$DS8$ & ~ SDSFLAG) THEN DO;
     1817    12602    2           SDSFLAG = '1'B;
     1818    12603    3           IF RVA$ = B$DS8$ THEN DO;
     1819    12604        /*          Set up NULL_OFFSET and RVA_TYPE table DBACS supplied
     1820    12605                    data in shared data segment file buffers */
     1821    12606    3               PT$ = PINCRW(RVA$, RVA_SIZE+1);
     1822    12607    3               NULL_OFFSET = PT$->SBIN36;
     1823    12608    3               PT$ = PINCRW(PT$, 1);
     1824    12609    3               IX = (RVA_SIZE+1)*%TYPE_BITS/9 + 1;
     1825    12610    3               RVA_TYPEC = PT$->RVA_TYPEC;
     1826    12611    3               END;
     1827    12612    3           ELSE DO;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:63   
     1828    12613    4               DO I=1 TO RVA_SIZE;
     1829    12614    4                   RVA_TYPE(I)=RVA_HALF(2*I);
     1830    12615    4                   IF RVA_HALF(2*I)=4 THEN
     1831    12616    4                       NULL_OFFSET=I;
     1832    12617    4                   END;
     1833    12618    3               END;
     1834    12619    2           I=%FPT_SIZE+%RLCW_SIZE+RVA_SIZE/(36/%TYPE_BITS)+1;
     1835    12620    2           IF MOD(I,2)=0 THEN
     1836    12621    2               USEP$=PINCRW(FPT$,I);
     1837    12622    2           ELSE
     1838    12623    2               USEP$=PINCRW(FPT$,I+1);
     1839    12624    2           USEP.M=0;
     1840    12625    2           USEP.FLAG='0'B;
     1841    12626    2           FPTS.USEP_=VECTOR(USEP);
     1842    12627    2           E$=ENTADDR(GET);
     1843    12628    2           IDS_ADR(0)=REDEF_E$.ADR;
     1844    12629    2           E$=ENTADDR(MODIFY);
     1845    12630    2           IDS_ADR(1)=REDEF_E$.ADR;
     1846    12631    2           E$=ENTADDR(STORE);
     1847    12632    2           IDS_ADR(2)=REDEF_E$.ADR;
     1848    12633    2           E$=ENTADDR(ERASER);
     1849    12634    2           IDS_ADR(3)=REDEF_E$.ADR;
     1850    12635    2           E$=ENTADDR(CONNECT);
     1851    12636    2           IDS_ADR(4)=REDEF_E$.ADR;
     1852    12637    2           E$=ENTADDR(DISCONNE);
     1853    12638    2           IDS_ADR(5)=REDEF_E$.ADR;
     1854    12639    2           E$=ENTADDR(DISCONNECT);
     1855    12640    2           IDS_ADR(6)=REDEF_E$.ADR;
     1856    12641    2           E$=ENTADDR(FIND);
     1857    12642    2           IDS_ADR(7)=REDEF_E$.ADR;
     1858    12643    2           END;
     1859    12644    1   HIA:
     1860    12645            %CLIMB(FCN=HIA);
     1861    12659    1       GOTO COMMON_RETURN;
     1862    12660    1   END ZII$FORT_PL6;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:64   
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_DBCS.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B_SEGIDS_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$FORT_PL6.

   Procedure ZII$FORT_PL6 requires 3062 words for executable code.
   Procedure ZII$FORT_PL6 requires 70 words of local(AUTO) storage.

    No errors detected in file ZII$IDS_FORT.:ZIC0TSI    .

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:65   

 Object Unit name= ZII$FORT_PL6                               File name= ZII$IDS_FORT.:ZIC0TOU
 UTS= SEP 05 '97 12:27:28.36 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=IDS


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RtLbCm even  none    30     36  SNA
    1   Data  even  none  1424   2620  ZII$FORT_PL6
    2  RoData even  UTS      2      2  ZII$FORT_PL6
    3   DCB   even  none     0      0  M$DO
    4   DCB   even  none     0      0  M$UC
    5   Proc  even  none  3062   5766  ZII$FORT_PL6
    6  RoData even  none   137    211  ZII$FORT_PL6

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std       20  ZII$FORT_PL6
     5    777                  yes      Std       20  PRIVACY
     5   1211                  yes      Std       20  USEPROC
     5   1302                  yes      Std       20  RETAIN
     5   1400                  yes      Std        2  IDSSET
     5   1617                  yes      Std       20  READY
     5   2067                  yes      Std       20  FINISH
     5   2165                  yes      Std        2  CALC
     5   2237                  yes      Std        3  ACCEPT
     5   2507                  yes      Std        1  STORE
     5   2551                  yes      Std        2  CHECK
     5   2632                  yes      Std        2  ERASER
     5   2751                  yes      Std       20  FIND
     5   4346                  yes      Std       20  GET
     5   4467                  yes      Std       20  MODIFY
     5   4762                  yes      Std        2  CONNECT
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:66   
     5   4777                  yes      Std        2  DISCONNECT
     5   5002                  yes      Std        2  DISCONNE
     5   5164                  yes      Std        2  IFEMPTY
     5   5251                  yes      Std        2  IFMEMBER
     5   5260                  yes      Std        2  IFOWNER
     5   5267                  yes      Std        2  IFTENANT
     5   5276                  yes      Std        2  BUFFERS
     5   5312                  yes      Std        1  CRPT
     5   5326                  yes      Std        1  ROLL
     5   5351                  yes      Std        0  KEEP
     5   5363                  yes      Std        0  REDUCEQ
     5   5371                  yes      Std        0  RPTSTATS
     5   5376                  yes      Std        0  STATSON
     5   5403                  yes      Std        0  STATSOFF
     5   5425                  yes      Std        1  TRACEOFF
     5   5435                  yes      Std        1  TRACEON
     5   5445                  yes      Std        3  INVOKE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      2  IDSSYSERR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:67   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      20 GET
         yes           Std      20 MODIFY
         yes           Std       1 STORE
         yes           Std       2 ERASER
         yes           Std       2 CONNECT
         yes           Std       2 DISCONNE
         yes           Std       2 DISCONNECT
         yes           Std      20 FIND
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX
                       nStd      0 X66_AUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     I$SHNO                                I$CALC                                I$FUI
     I$CRPT                                I$RDY                                 I$ACC
     I$FCR                                 I$FCT                                 I$IFM
     I$SHIN                                I$NBF                                 I$CON
     I$REDUCEQ                             I$SHCUR                               I$ETC
     I$CHK                                 I$FOR                                 I$GET
     I$GTF                                 I$ACN                                 I$ERS
     I$KEEP                                I$TRON                                I$STON
     I$FRI                                 I$FRA                                 I$SHALL
     I$SHANY                               I$FAS                                 I$MOD
     I$TROFF                               I$DIS                                 I$ROL
     I$HIA                                 I$SHINCUR                             I$FIN
     I$STO                                 I$FDP                                 I$FKY
     I$FRS                                 I$FKC                                 I$FAA
     I$RPT                                 I$STOFF                               I$FDC
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:68   
     I$FCD                                 I$FDR                                 I$IST
     I$IFT                                 B$TCB$                                M$DO
     M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
     ASLENTSID
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:69   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /****************************************************************/
        7        7        /*                                                              */
        8        8        /*    I-D-S/II INTERFACE MODULE WITH FORTRAN/PL6 USERS          */
        9        9        /*                                                              */
       10       10        /****************************************************************/
       11       11        /* This error message is called from ZII$COB_PARAM_ERR, which is
       12       12           called from ZII$DBCSCI--the COBOL interface.  The message has
       13       13           been placed here since ZII$DBCSCI is a BMAP routine.  */
       14       14        /*E*  ERROR: ZII-195-1
       15       15              MESSAGE: IDS library routine called with wrong number
       16       16                       of parameters at IC
       17       17        */
       18       18        %MACRO GEN_PARAMS(TYPE=0); /* GENERATE SOURCE CODES FOR ALL ARGUMENTS */
       19       19         %SET PARAM# = %PARAM# + 1;
       20       20         %IF %PARAM# > %PARAMETERS;
       21       21         %SET PARAM# = 1;
       22       22         %ENDIF;
       23       23         %SET DIGITS = %PARAM# /10 + 1; /* NUMBER OF DIGITS */
       24       24         %SET ARG = CONCAT('A',BINCHAR(%PARAM#,%DIGITS));
       25       25         %IF TYPE = 0; /* GENERATE ARGUMENTS LIST */
       26       26         %IF %PARAM# < %PARAMETERS;
       27       27         %CHARTEXT(ARG),
       28       28         %ELSE;
       29       29         %CHARTEXT(ARG) );
       30       30         %ENDIF;
       31       31         %ELSEIF TYPE = 1;
       32       32         %IF %PARAM# < 4;
       33       33        DCL %CHARTEXT(ARG) (0:0) SBIN CALIGNED;
       34       34         %ELSE;
       35       35        DCL %CHARTEXT(ARG) SBIN CALIGNED;
       36       36         %ENDIF;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:70   
       37       37         %ELSEIF TYPE = 2;
       38       38            CALL CHK_ARG(%CHARTEXT(ARG)) ALTRET(END_OF_ARGS);
       39       39         %ELSE
       40       40         %ERROR('UNKNOWN TYPE IN MACRO GEN_PARAMS CALL');
       41       41         %ENDIF;
       42       42         %IF %PARAM# < %PARAMETERS;
       43       43            %GEN_PARAMS(TYPE=TYPE); /* KEEP GENERATING */
       44       44         %ENDIF;
       45       45        %MEND;
       46       46
       47       47        %EQU PARAMETERS = 20; /* MUST BE A MUTIPLE OF 4 */
       48       48        %EQU TYPE_BITS=2;
       49       49        %SET PARAM#=0;
       50       50         %EQU PARAMETERS_TIMES_TWO=%PARAMETERS*2;
       51       51        ZII$FORT_PL6: PROC(

     51  5 000000   000000 700200 xent  ZII$FORT_PL6 TSX0  ! X66_AUTO_N
         5 000001   000106 000024                    ZERO    70,20
         5 000002   000776 710000 5                  TRA     s:6465+2

       52       52               %GEN_PARAMS;
       53      593        %GEN_PARAMS(TYPE=1); /* GEN ALL DCL OF ARGUEMENTS */
       54     1134         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:71   
       55     1135        /** DEFINE CONTENTS OF KEY-WORDS IN SNA **/
       56     1136         %EQU ALL=2;
       57     1137         %EQU ANY=3;
       58     1138         %EQU AREANAME=4;
       59     1139         %EQU AREA=5;
       60     1140         %EQU CURRENCY=6;
       61     1141         %EQU CURRENT=7;
       62     1142         %EQU DBKEY=8;
       63     1143         %EQU DUPLICATE=9;
       64     1144         %EQU FIRST=10;
       65     1145         %EQU INCLUDING=11;
       66     1146         %EQU ITEM=12;
       67     1147         %EQU LAST=13;
       68     1148         %EQU LOAD=14;
       69     1149         %EQU NEXT=15;
       70     1150         %EQU NOSHALL=16;
       71     1151         %EQU ONLY=17;
       72     1152         %EQU OWNER=18;
       73     1153         %EQU PRIOR=19;
       74     1154         %EQU RECORD=20;
       75     1155         %EQU RETRIEVAL=12;
       76     1156         %EQU SET=22;
       77     1157         %EQU SETS=23;
       78     1158         %EQU SHAREALL=24;
       79     1159         %EQU SHAREANY=25;
       80     1160         %EQU SHAREIN=26;
       81     1161         %EQU UPDATE=27;
       82     1162         %EQU USING=28;
       83     1163         %EQU WITHIN=29;
       84     1164         %EQU SHCUR=30;
       85     1165         %EQU SHINCUR=31;
       86     1166        %EQU SNA_SIZE=30;
       87     1167         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:72   
       88     1168        /***************************************************************/
       89     1169        /*                                                             */
       90     1170        /*  SPECIAL NAME AREA (SNA) -  EXTROOT                         */
       91     1171        /*                                                             */
       92     1172        /***************************************************************/
       93     1173    1   DCL 1 SNA EXTROOT,
       94     1174    1         2 ALL SBIN INIT(%ALL),
       95     1175    1         2 ANY SBIN INIT(%ANY),
       96     1176    1         2 CURRENCY SBIN INIT(%CURRENCY),
       97     1177    1         2 CURRENT SBIN INIT(%CURRENT),
       98     1178    1         2 DBKEY SBIN INIT(%DBKEY),
       99     1179    1         2 DUPLICATE SBIN INIT(%DUPLICATE),
      100     1180    1         2 FIRST SBIN INIT(%FIRST),
      101     1181    1         2 INCLUDING SBIN INIT(%INCLUDING),
      102     1182    1         2 ITEM SBIN INIT(%ITEM),
      103     1183    1         2 LAST SBIN INIT(%LAST),
      104     1184    1         2 LOAD SBIN INIT(%LOAD),
      105     1185    1         2 NEXT SBIN INIT(%NEXT),
      106     1186    1         2 NOSHALL SBIN INIT(%NOSHALL),
      107     1187    1         2 ONLY SBIN INIT(%ONLY),
      108     1188    1         2 OWNER SBIN INIT(%OWNER),
      109     1189    1         2 PRIOR SBIN INIT(%PRIOR),
      110     1190    1         2 AREA SBIN INIT(%AREA),
      111     1191    1         2 AREANAME SBIN INIT(%AREANAME),
      112     1192    1         2 RECORD SBIN INIT(%RECORD),
      113     1193    1         2 RETRIEVAL SBIN INIT(%RETRIEVAL),
      114     1194    1         2 SET SBIN INIT(%SET),
      115     1195    1         2 SETS SBIN INIT(%SETS),
      116     1196    1         2 SHAREALL SBIN INIT(%SHAREALL),
      117     1197    1         2 SHAREANY SBIN INIT(%SHAREANY),
      118     1198    1         2 SHAREIN SBIN INIT(%SHAREIN),
      119     1199    1         2 UPDATE SBIN INIT(%UPDATE),
      120     1200    1         2 USING SBIN INIT(%USING),
      121     1201    1         2 WITHIN SBIN INIT(%WITHIN),
      122     1202    1         2 SHCUR SBIN INIT(%SHCUR),
      123     1203    1         2 SHINCUR SBIN INIT(%SHINCUR);
      124     1204        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:73   
      125     1205        /****************************************************************/
      126     1206        /*                                                              */
      127     1207        /*    DEFINE THE BASED STRUCTURE INTO A DYNAMIC PAGE            */
      128     1208        /*                                                              */
      129     1209        /****************************************************************/
      130     1210    1   DCL 1 ARG(0:0) BASED(ARG$) ALIGNED,
      131     1211    1         2 OFFSET UBIN HALF CALIGNED,
      132     1212    1         2 TYPE UBIN HALF CALIGNED;
      133     1213
      134     1214        /******************************************************************/
      135     1215        /*                                                                */
      136     1216        /*      COMMON FPT IS RESERVED TO 2*(%PARAMETERS)+10 WORDS        */
      137     1217        /*      IT IS UPDATED WHEN DOING MOST OF IDS_CALLS                */
      138     1218        /*                                                                */
      139     1219        /******************************************************************/
      140     1220    1   DCL 1 FPTS BASED(FPT$) DALIGNED, /* DALIGNED SO VECTOR IT RIGHT */
      141     1221    1         2 V_ VECTOR ALIGNED,
      142     1222    1         2 IA_ VECTOR ALIGNED,
      143     1223    1         2 UWA_ VECTOR ALIGNED,
      144     1224    1         2 RVA_ VECTOR ALIGNED,
      145     1225    1         2 USEP_ VECTOR ALIGNED,
      146     1226    1         2 V DALIGNED,
      147     1227    1           3 *(0:9) SBIN,
      148     1228    1           3 FPARAM (0:%PARAMETERS) SBIN WORD,
      149     1229    1           3 ARG(0:%PARAMETERS) PTR;
      150     1230
      151     1231    1   DCL 1 RLCW_SAVE BASED(RLCW$) ALIGNED,
      152     1232    1         2 * UBIN HALF UNAL,
      153     1233    1         2 AC_INDICATORS BIT(1) UNAL,
      154     1234    1         2 SC_INDICATORS BIT(1) UNAL,
      155     1235    1         2 RC_INDICATORS BIT(1) UNAL,
      156     1236    1         2 * BIT(7) UNAL,
      157     1237    1         2 N_SETS# UBIN(8) UNAL,
      158     1238    1         2 RETAIN_LIST(0:0) SBIN HALF CALIGNED;
      159     1239
      160     1240        /***************************************************************/
      161     1241        /*                                                             */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:74   
      162     1242        /*  USE PROCEDURE TABLE (USEP) - GENERATED BEFORE HIA          */
      163     1243        /*                                                             */
      164     1244        /***************************************************************/
      165     1245    1   DCL 1 USEP BASED(USEP$) DALIGNED, /* MUST BE DALIGNED */
      166     1246    1         2 FLAG BIT(1) UNAL,
      167     1247    1         2 M UBIN(17) UNAL,
      168     1248    1         2 * SBIN HALF CALIGNED,
      169     1249    1         2 UC(0:200) ALIGNED, /* ALLOW 200 ENTRIES */
      170     1250    1           3 UCW_PRV,
      171     1251    1             4 PT UBIN BYTE CALIGNED,
      172     1252    1             4 PB BIT(9) CALIGNED,
      173     1253    1             4 A UBIN HALF CALIGNED,
      174     1254    1           3 UCW_USE REDEF UCW_PRV,
      175     1255    1             4 PT UBIN BYTE CALIGNED,
      176     1256    1             4 CODE UBIN(27) CALIGNED,
      177     1257    1           3 ENT$ PTR ALIGNED;
      178     1258        %INCLUDE B_SEGIDS_C;
      179     1797        %INCLUDE CP_6_SUBS;
      180     2337        %INCLUDE B_ERRORS_C;
      181     3464    1   DCL B$DS8$_B BIT(36) STATIC INIT('000000006013'O);
      182     3465    1   DCL B$DS8$ REDEF B$DS8$_B PTR;
      183     3466
      184     3467    1   DCL RVA_TYPE(0:0) UBIN(%TYPE_BITS) UNAL BASED(TYPE$);
      185     3468    1   DCL RVA_TYPEC CHAR(IX) BASED(TYPE$);
      186     3469    1   DCL IX UBIN STATIC;
      187     3470
      188     3471         %EQU FPT_SIZE=10+2*(%PARAMETERS+1)+10;
      189     3472         %EQU RLCW_SIZE=1+%PARAMETERS/2;
      190     3473         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:75   
      191     3474        /****************************************************************/
      192     3475        /*                                                              */
      193     3476        /*    WORKING SPACE FOR INTERFACE MODULE                        */
      194     3477        /*                                                              */
      195     3478        /****************************************************************/
      196     3479    1   DCL IDSSYSERR SBIN STATIC SYMDEF; /* FOR MON ERR_CODE IN IA(5) */
      197     3480    1   DCL CHAR7 CHAR(7) BASED ALIGNED;
      198     3481    1   DCL CHAR_V CHAR(K) BASED(PT$) ALIGNED;
      199     3482    1   DCL B$TCB$ PTR SYMREF;
      200     3483
      201     3484    1   DCL I SBIN STATIC;
      202     3485    1   DCL K SBIN STATIC;
      203     3486    1   DCL J SBIN STATIC;
      204     3487    1   DCL 1 REDEF_J REDEF J,
      205     3488    1         2 BIT9 BIT(9) UNAL,
      206     3489    1         2 * BIT(9) UNAL,
      207     3490    1         2 NAME SBIN HALF UNAL;
      208     3491    1   DCL SBIN36 SBIN WORD BASED;
      209     3492    1   DCL AUTO_FRAME(0:0) SBIN HALF HALIGNED BASED (B$AUTO$);
      210     3493    1   DCL ANAME_ (0:7) SBIN BASED;
      211     3494    1   DCL DEADLOCK_RET BIT(72) STATIC INIT('000000006004000000000000'O);
      212     3495    1   DCL 1 DK_RET REDEF DEADLOCK_RET,
      213     3496    1         2 AUTO_OFFSET UBIN HALF UNAL,
      214     3497    1         2 SEG# UBIN HALF UNAL,
      215     3498    1         2 RET_ADDR UBIN HALF UNAL,
      216     3499    1         2 * UBIN HALF UNAL;
      217     3500    1   DCL P$ PTR BASED;
      218     3501    1   DCL AUTO$ BIT(36) CONSTANT ALIGNED INIT('000000006004'O);
      219     3502    1   DCL B$AUTO$ REDEF AUTO$ PTR ALIGNED; /* SIMULATE B$AUTO$ */
      220     3503    1   DCL PT$ PTR STATIC;
      221     3504    1   DCL EPTR$ REDEF PT$ EPTR;
      222     3505    1   DCL 1 REDEF_PT REDEF PT$,
      223     3506    1         2 ADR UBIN HALF UNAL,
      224     3507    1         2 SEG# BIT(18) UNAL;
      225     3508    1   DCL E$ EPTR STATIC;
      226     3509    1   DCL 1 REDEF_E$ REDEF E$,
      227     3510    1         2 ADR UBIN HALF UNAL,
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:76   
      228     3511    1         2 * UBIN HALF UNAL;
      229     3512    1   DCL NINE_WORDS(0:8) UBIN BASED ALIGNED;
      230     3513    1   DCL NO_ARGS SBIN STATIC;
      231     3514    1   DCL 1 FPT_SHORT STATIC DALIGNED,
      232     3515    1         2 VEC1 BIT(72) INIT(VECTOR(I)),
      233     3516    1         2 VEC2 BIT(72),
      234     3517    1         2 VEC3 BIT(72);
      235     3518    1   DCL CHK_NBF_ROL_CRPT$ PTR STATIC INIT(ADDR(FPT_SHORT));
      236     3519    1   DCL ZII$HAVEIT (0:199) UBIN STATIC INIT(0*0);
      237     3520    1   DCL IDS_ADR(0:7) UBIN HALF STATIC;
      238     3521    1   DCL IDS_BIT9(0:7) BIT(9) STATIC ALIGNED
      239     3522    1    INIT ('400'O,
      240     3523    1    '200'O,
      241     3524    1    '100'O,
      242     3525    1    '040'O,
      243     3526    1    '020'O,
      244     3527    1    '010'O,
      245     3528    1    '004'O);
      246     3529
      247     3530    1   DCL RETAIN_SWITCH SBIN STATIC INIT(0);
      248     3531    1   DCL II SBIN STATIC;
      249     3532    1   DCL LOW REDEF II SBIN;
      250     3533    1   DCL JJ SBIN STATIC;
      251     3534    1   DCL HIGH REDEF JJ SBIN;
      252     3535    1   DCL KK SBIN STATIC;
      253     3536    1   DCL NN SBIN STATIC;
      254     3537    1   DCL SDSDCB UBIN STATIC;
      255     3538    1   DCL SUBDCB UBIN STATIC;
      256     3539    1   DCL SDSFLAG BIT(1) STATIC INIT('0'B);
      257     3540        %INCLUDE FM$FIT;
      258     3761        %FM$FIT;
      259     3764        %CODE04;
      260     3772    1   DCL FPBUF CHAR(4096) STATIC;
      261     3773    1   DCL FIT$ PTR;
      262     3774    1   DCL RVA (0:0) SBIN WORD BASED(RVA$);
      263     3775    1   DCL RVA_HALF(0:0) UBIN HALF HALIGNED BASED(RVA$);
      264     3776    1   DCL IA_HALF(0:0) UBIN HALF HALIGNED BASED(IA$);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:77   
      265     3777    1   DCL UWA (0:0) SBIN BASED(UWA$);
      266     3778
      267     3779    1   DCL UWA_SIZE SBIN STATIC;
      268     3780    1   DCL RVA_SIZE SBIN STATIC;
      269     3781    1   DCL NULL_OFFSET SBIN STATIC;
      270     3782        %INCLUDE ZI$USER;
      271     3927         %IA (STCLASS="STATIC");
      272     3976    1   DCL 1 IAR$ REDEF IA$,
      273     3977    1         2 * BIT(24) UNAL,
      274     3978    1         2 SEGID BIT(12) UNAL;
      275     3979    1   DCL UWA$ PTR STATIC;
      276     3980    1   DCL RVA$ PTR STATIC;
      277     3981    1   DCL FPT$ PTR STATIC;
      278     3982    1   DCL ARG$ PTR STATIC;
      279     3983    1   DCL USEP$ PTR STATIC;
      280     3984    1   DCL KEY$ PTR STATIC;
      281     3985    1   DCL RLCW$ PTR STATIC;
      282     3986    1   DCL TYPE$ PTR STATIC;
      283     3987
      284     3988        %EQU AREA_NAME=31;
      285     3989        %EQU SET_NAME=32;
      286     3990        %EQU RECORD_NAME=33;
      287     3991        %EQU FIELD_NAME=34;
      288     3992        %EQU ELSE_NAME=1;
      289     3993        %EQU AREA_NAME_NET=0;
      290     3994        %EQU SET_NAME_NET=1;
      291     3995        %EQU RECORD_NAME_NET=2;
      292     3996        %EQU FIELD_NAME_NET=3;
      293     3997        %EQU ON=1;
      294     3998        %EQU OFF=0;
      295     3999        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:78   
      296     4000        /****************************************************************/
      297     4001        /*                                                              */
      298     4002        /*    INCLUDE ZI_DBCS TO INVOKE IDS FPTS AND ENTRY DEFS         */
      299     4003        /*                                                              */
      300     4004        /****************************************************************/
      301     4005        %INCLUDE ZI_DBCS;
      302     4618         %ASL;
      303     4632        %IPT_ACC(STCLASS="BASED(FPT$)");
      304     4645        %IPT_ACN(STCLASS="BASED(FPT$)");
      305     4659        %IPT_CALC(STCLASS="BASED(FPT$)");
      306     4671        %IPT_CHK(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      307     4681        %IPT_CON(STCLASS="BASED(FPT$)");
      308     4694        %IPT_CRPT(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      309     4703        %IPT_DIS(STCLASS="BASED(FPT$)");
      310     4716        %IPT_ERS(STCLASS="BASED(FPT$)");
      311     4728        %IPT_ETC(STCLASS="BASED(FPT$)");
      312     4741        %IPT_FAA(STCLASS="BASED(FPT$)");
      313     4758        %IPT_FAS(STCLASS="BASED(FPT$)");
      314     4775        %IPT_FCD(STCLASS="BASED(FPT$)");
      315     4790        %IPT_FCR(STCLASS="BASED(FPT$)");
      316     4804        %IPT_FCT(STCLASS="BASED(FPT$)");
      317     4819        %IPT_FDC(STCLASS="BASED(FPT$)");
      318     4834        %IPT_FDP(STCLASS="BASED(FPT$)");
      319     4850        %IPT_FDR(STCLASS="BASED(FPT$)");
      320     4866        %IPT_FIN(STCLASS="BASED(FPT$)");
      321     4879        %IPT_FKC(STCLASS="BASED(FPT$)");
      322     4896        %IPT_FKY(STCLASS="BASED(FPT$)");
      323     4913        %IPT_FOR(STCLASS="BASED(FPT$)");
      324     4928        %IPT_FRA(STCLASS="BASED(FPT$)");
      325     4945        %IPT_FRI(STCLASS="BASED(FPT$)");
      326     4962        %IPT_FRS(STCLASS="BASED(FPT$)");
      327     4979        %IPT_FUI(STCLASS="BASED(FPT$)");
      328     4995        %IPT_GET(STCLASS="BASED(FPT$)");
      329     5007        %IPT_GTF(STCLASS="BASED(FPT$)");
      330     5020        %IPT_HIA(STCLASS="BASED(FPT$)");
      331     5031        %IPT_IFM(STCLASS="BASED(FPT$)");
      332     5043        %IPT_IFT(STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:79   
      333     5055        %IPT_INA(STCLASS="BASED(FPT$)");
      334     5069        %IPT_IST(STCLASS="BASED(FPT$)");
      335     5082        %IPT_MOD(STCLASS="BASED(FPT$)");
      336     5098        %IPT_NBF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      337     5108        %IPT_KEEP(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      338     5117        %IPT_REDUCEQ(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      339     5126        %IPT_RDY(STCLASS="BASED(FPT$)");
      340     5140        %IPT_ROL(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      341     5149        %IPT_STO(STCLASS="BASED(FPT$)");
      342     5164        %IPT_TRON(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      343     5173        %IPT_TROFF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      344     5182        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:80   
      345     5183        /****************************************************************/
      346     5184        /*                                                              */
      347     5185        /*    INCLUDE CP_6 TO DO M$GDP AND M$ERR                        */
      348     5186        /*                                                              */
      349     5187        /****************************************************************/
      350     5188    1   DCL M$DO DCB;
      351     5189    1   DCL 1 PAGE_VECTOR STATIC DALIGNED,
      352     5190    1         2 * BIT(36),
      353     5191    1         2 ADR PTR INIT(ADDR(NIL));
      354     5192    1   DCL 1 ERR_CODE STATIC,
      355     5193    1         2 * BIT(18) UNAL INIT('321111'O),
      356     5194    1         2 ERR_NO UBIN(15) UNAL,
      357     5195    1         2 * UBIN(3) UNAL INIT(3);
      358     5196
      359     5197        %INCLUDE CP_6;
      360     5278
      361     5279
      362     5280        %FPT_GDP(PAGES=1,RESULTS=PAGE_VECTOR);
      363     5294
      364     5295        %VLP_NAME(FPTN=FILE_NAME,LEN=9,NAME=':ZIERRMSG');
      365     5322        %VLP_ACCT(FPTN=FILE_ACCT,ACCT=':SYS ');
      366     5335        %FPT_ERRMSG(OUTDCB1=M$DO,CODE=ERR_CODE,FILEACCT=FILE_ACCT,
      367     5336         FILENAME=FILE_NAME,INCLCODE=YES);
      368     5363        %FPT_YC;
      369     5380        %B$TCB;
      370     5383        %B$EXCFR;
      371     5401
      372     5402        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:81   
      373     5403        /**     INTERNAL SUBROUTINE TO RETURN A POFFW      **/
      374     5404        /**     WITH ADDITIONAL SEGMENT NUMBER CHECK       **/
      375     5405
      376     5406    1   P_OFF_W: PROC(A,B);

   5406  5 000003   200036 741300       P_OFF_W      STX1  ! @A+1,,AUTO

      377     5407    2   DCL 1 A ALIGNED,
      378     5408    2         2 ADR UBIN HALF UNAL,
      379     5409    2         2 * BIT(6) UNAL,
      380     5410    2         2 SEG UBIN(12) UNAL;
      381     5411    2   DCL 1 B ALIGNED,
      382     5412    2         2 ADR UBIN HALF UNAL,
      383     5413    2         2 * BIT(6) UNAL,
      384     5414    2         2 SEG UBIN(12) UNAL;
      385     5415
      386     5416    2       IF A.SEG=B.SEG THEN

   5416  5 000004   200040 470500                    LDP0    @B,,AUTO
         5 000005   200037 471500                    LDP1    @A,,AUTO
         5 000006   100000 236100                    LDQ     0,,PR1
         5 000007   000000 676100                    ERQ     0,,PR0
         5 000010   007777 376007                    ANQ     4095,DL
         5 000011   000022 601000 5                  TNZ     s:5419

      387     5417    2           I=A.ADR-B.ADR;

   5417  5 000012   000000 236100                    LDQ     0,,PR0
         5 000013   000022 772000                    QRL     18
         5 000014   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 000015   100000 236100                    LDQ     0,,PR1
         5 000016   000022 772000                    QRL     18
         5 000017   200076 136100                    SBLQ    ERRMSG_BUF+30,,AUTO
         5 000020   000003 756000 1                  STQ     I
         5 000021   000024 710000 5                  TRA     s:5420

      388     5418    2       ELSE
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:82   
      389     5419    2           I=-1;

   5419  5 000022   000001 335007                    LCA     1,DL
         5 000023   000003 755000 1                  STA     I

      390     5420    2   END P_OFF_W;

   5420  5 000024   000001 702211                    TSX2  ! 1,X1

      391     5421
      392     5422        /**     INTERNAL SUBROUTINE TO RETURN A VECTOR   **/
      393     5423
      394     5424    1   VEC_MAKER: PROC(A,B,C);

   5424  5 000025   200030 741300       VEC_MAKER    STX1  ! FIT$+1,,AUTO

      395     5425    2   DCL A UBIN;
      396     5426    2   DCL B SBIN;
      397     5427    2   DCL 1 C ALIGNED,
      398     5428    2         2 V_SIZE UBIN(20) UNAL,
      399     5429    2         2 * UBIN(16) UNAL,
      400     5430    2         2 * UBIN UNAL;
      401     5431    2       C=VECTOR(A);

   5431  5 000026   777640 235007                    LDA     -96,DL
         5 000027   200031 236100                    LDQ     @A,,AUTO
         5 000030   200033 470500                    LDP0    @C,,AUTO
         5 000031   000000 755100                    STA     0,,PR0
         5 000032   000001 756100                    STQ     1,,PR0

      402     5432    2       C.V_SIZE=(B+1)*4-1;

   5432  5 000033   200032 471500                    LDP1    @B,,AUTO
         5 000034   100000 236100                    LDQ     0,,PR1
         5 000035   000002 736000                    QLS     2
         5 000036   000003 036007                    ADLQ    3,DL
         5 000037   000020 736000                    QLS     16
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:83   
         5 000040   000000 676100                    ERQ     0,,PR0
         5 000041   000000 376000 6                  ANQ     0
         5 000042   000000 656100                    ERSQ    0,,PR0

      403     5433    2   END VEC_MAKER;

   5433  5 000043   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000044   000001 702211                    TSX2  ! 1,X1

      404     5434        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:84   
      405     5435    1   SDS$OPEN: PROC;

   5435  5 000045   200030 741300       SDS$OPEN     STX1  ! FIT$+1,,AUTO

      406     5436
      407     5437        /*****************************************************/
      408     5438        /*                                                   */
      409     5439        /*  Procedure to open the shared data segment (SDS). */
      410     5440        /*                                                   */
      411     5441        /*****************************************************/
      412     5442
      413     5443        %F$DCB(STCLASS="BASED");
      414     5500        %FPT_FDS(FPTN=FPT_FDS,RESULTS=VEC,SEGSIZE=262143);
      415     5515        %FPT_GETDCB(FPTN=FPT_GETDCB,DCBNAME=SDS_NAME,DCBNUM=SDSDCB);
      416     5530        %FPT_RELDCB(FPTN=FPT_RELDCB);
      417     5544        %FPT_OPEN(FPTN=OPEN_SDS,ASN=FILE,EXIST=OLDFILE,FUN=IN,ACS=DS8,
      418     5545         FPARAM=FPBUF);
      419     5654        %VLP_NAME(FPTN=SDS_NAME,NAME=' ',LEN=31);
      420     5681        %VLP_NAME(FPTN=VLP_NAME,NAME=' ',LEN=31);
      421     5708        %VLP_VECTOR(FPTN=VEC,SEGID='6013'O);
      422     5723        /*  DCB name for SDS open is subschema-name||'$'  */
      423     5724    2       SDS_NAME.L# = 31;

   5724  5 000046   037000 236003                    LDQ     15872,DU
         5 000047   002576 552040 1                  STBQ    SDS_NAME,'40'O

      424     5725    2       SDS_NAME.NAME# = IA.SSNAME;

   5725  5 000050   002366 470400 1                  LDP0    IA$
         5 000051   040000 100500                    MLR     fill='040'O
         5 000052   000022 000036                    ADSC9   18,,PR0                  cn=0,n=30
         5 000053   002576 200037 1                  ADSC9   SDS_NAME                 cn=1,n=31

      425     5726    3       DO WHILE(SUBSTR(SDS_NAME.NAME#,SDS_NAME.L#-1,1) = ' ');

   5726  5 000054   000060 710000 5                  TRA     s:5728

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:85   
      426     5727    3           SDS_NAME.L# = SDS_NAME.L# - 1;

   5727  5 000055   002576 236000 1                  LDQ     SDS_NAME
         5 000056   777000 036003                    ADLQ    -512,DU
         5 000057   002576 552040 1                  STBQ    SDS_NAME,'40'O

      427     5728    3           END;

   5728  5 000060   002576 236000 1                  LDQ     SDS_NAME
         5 000061   000033 772000                    QRL     27
         5 000062   040000 106406                    CMPC    fill='040'O
         5 000063   002576 000001 1                  ADSC9   SDS_NAME,Q               cn=0,n=1
         5 000064   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 000065   000055 600000 5                  TZE     s:5727

      428     5729    2       CALL INSERT(SDS_NAME.NAME#,SDS_NAME.L#,1,'$');

   5729  5 000066   040006 100400                    MLR     fill='040'O
         5 000067   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000070   002576 200001 1                  ADSC9   SDS_NAME,Q               cn=1,n=1

      429     5730    2       SDS_NAME.L# = SDS_NAME.L# + 1;

   5730  5 000071   002576 236000 1                  LDQ     SDS_NAME
         5 000072   001000 036003                    ADLQ    512,DU
         5 000073   002576 552040 1                  STBQ    SDS_NAME,'40'O

      430     5731        /*  Get a dcb for the SDS */
      431     5732    2       FPT_GETDCB.V.TEST# = %NO#;

   5732  5 000074   000003 236000 6                  LDQ     3
         5 000075   002476 356000 1                  ANSQ    FPT_GETDCB+6

      432     5733    2       FPT_GETDCB.V.MERGE# = %YES#;

   5733  5 000076   400000 236007                    LDQ     -131072,DL
         5 000077   002476 256000 1                  ORSQ    FPT_GETDCB+6
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:86   

      433     5734    2       CALL M$GETDCB(FPT_GETDCB);

   5734  5 000100   002470 630400 1                  EPPR0   FPT_GETDCB
         5 000101   060002 713400                    CLIMB   24578
         5 000102   401000 401760                    pmme    nvectors=3

      434     5735
      435     5736        /*  If dcb for SDS is open, just return */
      436     5737    2       IF DCBADDR(SDSDCB)->F$DCB.FCD# THEN

   5737  5 000103   000004 470400 6                  LDP0    4
         5 000104   000000 471500                    LDP1    0,,PR0
         5 000105   000360 720000 1                  LXL0    SDSDCB
         5 000106   100000 473510                    LDP3    0,X0,PR1
         5 000107   300031 236100                    LDQ     25,,PR3
         5 000110   020000 316007                    CANQ    8192,DL
         5 000111   000114 600000 5                  TZE     s:5739

      437     5738    2           RETURN;

   5738  5 000112   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000113   000001 702211                    TSX2  ! 1,X1

      438     5739    2       OPEN_SDS.V.DCB# = SDSDCB;

   5739  5 000114   002550 740000 1                  STX0    OPEN_SDS+36

      439     5740
      440     5741        /*  Free unitialized RVA  */
      441     5742    2       CALL M$FDS(FPT_FDS);

   5742  5 000115   002462 630400 1                  EPPR0   FPT_FDS
         5 000116   030002 713400                    CLIMB   fds
         5 000117   400400 401760                    pmme    nvectors=2

      442     5743
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:87   
      443     5744    3       IF DCBADDR(SDSDCB)->F$DCB.ASN# ~= %FILE# THEN DO;

   5744  5 000120   000004 470400 6                  LDP0    4
         5 000121   000000 471500                    LDP1    0,,PR0
         5 000122   000360 720000 1                  LXL0    SDSDCB
         5 000123   100000 473510                    LDP3    0,X0,PR1
         5 000124   300032 236100                    LDQ     26,,PR3
         5 000125   777000 376007                    ANQ     -512,DL
         5 000126   001000 116007                    CMPQ    512,DL
         5 000127   000214 600000 5                  TZE     s:5776

      444     5745        /*      Set up the file name for open of SDS file */
      445     5746    3           VLP_NAME.L# = SDS_NAME.L# - 1;

   5746  5 000130   002576 236000 1                  LDQ     SDS_NAME
         5 000131   000033 772000                    QRL     27
         5 000132   000001 136007                    SBLQ    1,DL
         5 000133   000033 736000                    QLS     27
         5 000134   002606 552040 1                  STBQ    VLP_NAME,'40'O

      446     5747    3           VLP_NAME.NAME# = IA.SSNAME;

   5747  5 000135   002366 474400 1                  LDP4    IA$
         5 000136   040000 100500                    MLR     fill='040'O
         5 000137   400022 000036                    ADSC9   18,,PR4                  cn=0,n=30
         5 000140   002606 200037 1                  ADSC9   VLP_NAME                 cn=1,n=31

      447     5748
      448     5749        /*      Now, prepare for and get the dcb for the subschema so we can pull
      449     5750                the subschema file name out of the dcb */
      450     5751    3           FPT_GETDCB.DCBNAME_ = VECTOR(VLP_NAME);

   5751  5 000141   000006 237000 6                  LDAQ    6
         5 000142   002472 757000 1                  STAQ    FPT_GETDCB+2

      451     5752    3           FPT_GETDCB.DCBNUM_ = VECTOR(SUBDCB);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:88   
   5752  5 000143   000010 237000 6                  LDAQ    8
         5 000144   002474 757000 1                  STAQ    FPT_GETDCB+4

      452     5753    3           FPT_GETDCB.V.MERGE# = %YES#;

   5753  5 000145   400000 236007                    LDQ     -131072,DL
         5 000146   002476 256000 1                  ORSQ    FPT_GETDCB+6

      453     5754    3           CALL M$GETDCB(FPT_GETDCB);

   5754  5 000147   002470 630400 1                  EPPR0   FPT_GETDCB
         5 000150   060002 713400                    CLIMB   24578
         5 000151   401000 401760                    pmme    nvectors=3

      454     5755    4           IF DCBADDR(SUBDCB)->F$DCB.ASN# = %FILE# THEN DO;

   5755  5 000152   000004 470400 6                  LDP0    4
         5 000153   000000 471500                    LDP1    0,,PR0
         5 000154   000361 720000 1                  LXL0    SUBDCB
         5 000155   100000 473510                    LDP3    0,X0,PR1
         5 000156   300032 236100                    LDQ     26,,PR3
         5 000157   777000 376007                    ANQ     -512,DL
         5 000160   001000 116007                    CMPQ    512,DL
         5 000161   000173 601000 5                  TNZ     s:5764

      455     5756        /*      SET statement for subschema provided.  Get subschema file name
      456     5757                from DCB and frame the ACCOUNT specification in DCB */
      457     5758    4               VLP_NAME = DCBADDR(SUBDCB)->F$DCB.NAME#;

   5758  5 000162   000000 100500                    MLR     fill='000'O
         5 000163   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         5 000164   002606 000040 1                  ADSC9   VLP_NAME                 cn=0,n=32

      458     5759    4               OPEN_SDS.ACCT_ = VECTOR(DCBADDR(SUBDCB)->F$DCB.ACCT#);

   5759  5 000165   000012 235000 6                  LDA     10
         5 000166   200076 453500                    STP3    ERRMSG_BUF+30,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:89   
         5 000167   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000170   000020 036003                    ADLQ    16,DU
         5 000171   002530 757000 1                  STAQ    OPEN_SDS+20

      459     5760    4               END;

   5760  5 000172   000205 710000 5                  TRA     s:5771

      460     5761    4           ELSE DO;

      461     5762        /*          No SET statement provided.  Use IA.SSNAME for subschema
      462     5763                    file name and provide no ACCOUNT specification.  */
      463     5764    4               OPEN_SDS.ACCT_ = VECTOR(NIL);

   5764  5 000173   000014 237000 6                  LDAQ    12
         5 000174   002530 757000 1                  STAQ    OPEN_SDS+20

      464     5765        /*          Now we have the subschema file name.  The name of the SDS
      465     5766                    will be 'subschema-name$' so put the '$' on the end */
      466     5767    4               CALL INSERT(VLP_NAME.NAME#,VLP_NAME.L#,1,'$');

   5767  5 000175   002606 236000 1                  LDQ     VLP_NAME
         5 000176   000033 772000                    QRL     27
         5 000177   040006 100400                    MLR     fill='040'O
         5 000200   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000201   002606 200001 1                  ADSC9   VLP_NAME,Q               cn=1,n=1

      467     5768    4               VLP_NAME.L# = VLP_NAME.L# + 1;

   5768  5 000202   002606 236000 1                  LDQ     VLP_NAME
         5 000203   001000 036003                    ADLQ    512,DU
         5 000204   002606 552040 1                  STBQ    VLP_NAME,'40'O

      468     5769    4               END;

      469     5770        /*      Frame the name of the SDS for the open   */
      470     5771    3           OPEN_SDS.NAME_ = VECTOR(VLP_NAME);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:90   

   5771  5 000205   000006 237000 6                  LDAQ    6
         5 000206   002512 757000 1                  STAQ    OPEN_SDS+6

      471     5772        /*      Free up the DCB used to obtain the subschema SET info  */
      472     5773    3           FPT_RELDCB.V.DCB# = SUBDCB;

   5773  5 000207   000361 720000 1                  LXL0    SUBDCB
         5 000210   002502 740000 1                  STX0    FPT_RELDCB+2

      473     5774    3           CALL M$RELDCB(FPT_RELDCB);

   5774  5 000211   002500 630400 1                  EPPR0   FPT_RELDCB
         5 000212   060003 713400                    CLIMB   24579
         5 000213   400000 401760                    pmme    nvectors=1

      474     5775    3           END;

      475     5776    2       CALL M$OPEN(OPEN_SDS)

   5776  5 000214   002504 630400 1                  EPPR0   OPEN_SDS
         5 000215   450000 713400                    CLIMB   alt,open
         5 000216   410400 401760                    pmme    nvectors=18
         5 000217   000262 702000 5                  TSX2    s:5796

      476     5777    3       WHENRETURN DO;

      477     5778        /*  Check to determine whether the RVA data segment predates the
      478     5779            subschema file.  If so, access is denied. */
      479     5780    3           J=1;

   5780  5 000220   000001 235007                    LDA     1,DL
         5 000221   000005 755000 1                  STA     J

      480     5781    3           FIT$ = ADDR(FPBUF);

   5781  5 000222   000013 236000 6                  LDQ     11
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:91   
         5 000223   200027 756100                    STQ     FIT$,,AUTO

      481     5782    4           DO WHILE(FIT$->FM$FIT.CODES.CODE(J)~=4);

   5782  5 000224   200027 470500                    LDP0    FIT$,,AUTO
         5 000225   000000 236105                    LDQ     0,AL,PR0
         5 000226   760000 376003                    ANQ     -8192,DU
         5 000227   100000 116003                    CMPQ    32768,DU
         5 000230   000240 600000 5                  TZE     s:5785

      482     5783    4               J = J + 1;

   5783  5 000231   000005 054000 1                  AOS     J

      483     5784    4               END;

   5784  5 000232   200027 470500                    LDP0    FIT$,,AUTO
         5 000233   000005 720000 1                  LXL0    J
         5 000234   000000 236110                    LDQ     0,X0,PR0
         5 000235   760000 376003                    ANQ     -8192,DU
         5 000236   100000 116003                    CMPQ    32768,DU
         5 000237   000231 601000 5                  TNZ     s:5783

      484     5785    3           FIT$ = PINCRW(FIT$, FIT$->FM$FIT.CODES.ITEMX(J));

   5785  5 000240   000005 720000 1                  LXL0    J
         5 000241   000000 721110                    LXL1    0,X0,PR0
         5 000242   001777 361003                    ANX1    1023,DU
         5 000243   000000 636011                    EAQ     0,X1
         5 000244   200027 036100                    ADLQ    FIT$,,AUTO
         5 000245   200027 756100                    STQ     FIT$,,AUTO

      485     5786    4           IF FIT$->CODE04.CREATION.TIME < IA.SSTDT(1) THEN DO;

   5786  5 000246   200027 470500                    LDP0    FIT$,,AUTO
         5 000247   002366 471400 1                  LDP1    IA$
         5 000250   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:92   
         5 000251   100055 116100                    CMPQ    45,,PR1
         5 000252   000261 603000 5                  TRC     s:5792

      486     5787    4               CALL ARG_ERROR(5013);

   5787  5 000253   000017 236000 6                  LDQ     15
         5 000254   200037 756100                    STQ     @A,,AUTO
         5 000255   000716 701000 5                  TSX1    ARG_ERROR
         5 000256   000000 011000                    NOP     0

      487     5788        /*E*   ERROR:   ZII-5013-1
      488     5789              MESSAGE:  RVA data segment file predates subschema file. */
      489     5790    4               CALL M$XXX;

   5790  5 000257   000003 713400                    CLIMB   3
         5 000260   000000 401760                    pmme    nvectors=0

      490     5791    4               END;

      491     5792    3           END;

   5792  5 000261   000270 710000 5                  TRA     s:5799

      492     5793    3       WHENALTRETURN DO;

      493     5794        /*E*   ERROR:   ZII-5014-1
      494     5795              MESSAGE:  Unable to open RVA shared data segment file. */
      495     5796    3           CALL ARG_ERROR(5014);

   5796  5 000262   000021 236000 6                  LDQ     17
         5 000263   200037 756100                    STQ     @A,,AUTO
         5 000264   000716 701000 5                  TSX1    ARG_ERROR
         5 000265   000000 011000                    NOP     0

      496     5797    3           CALL M$MERC;

   5797  5 000266   010007 713400                    CLIMB   4103
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:93   
         5 000267   000000 401760                    pmme    nvectors=0

      497     5798    3           END;

      498     5799    2       RETURN;

   5799  5 000270   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000271   000001 702211                    TSX2  ! 1,X1

      499     5800    2   END SDS$OPEN;
      500     5801         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:94   
      501     5802        /******************************************************************/
      502     5803        /*                                                                */
      503     5804        /*      INTERNAL SUBROUTINE  CHK_ARG                              */
      504     5805        /*                                                                */
      505     5806        /******************************************************************/
      506     5807    1   CHK_ARG: PROC(A) ALTRET;

   5807  5 000272   200034 741300       CHK_ARG      STX1  ! @RLCW+1,,AUTO

      507     5808
      508     5809    2   DCL A UBIN;
      509     5810
      510     5811    2       FPTS.V.ARG(NO_ARGS)=ADDR(A);

   5811  5 000273   200035 236100                    LDQ     @A,,AUTO
         5 000274   002371 470400 1                  LDP0    FPT$
         5 000275   000012 720000 1                  LXL0    NO_ARGS
         5 000276   000051 756110                    STQ     41,X0,PR0

      511     5812    2       IF ADDR(A)=ADDR(NIL) THEN ALTRETURN;

   5812  5 000277   000015 116000 6                  CMPQ    13
         5 000300   000303 601000 5                  TNZ     s:5813

   5812  5 000301   200034 221300                    LDX1  ! @RLCW+1,,AUTO
         5 000302   000000 702211                    TSX2  ! 0,X1

      512     5813    2       CALL P_OFF_W(ADDR(A),RVA$);

   5813  5 000303   200101 756100                    STQ     ERRMSG_BUF+33,,AUTO
         5 000304   000022 236000 6                  LDQ     18
         5 000305   200040 756100                    STQ     @B,,AUTO
         5 000306   200101 631500                    EPPR1   ERRMSG_BUF+33,,AUTO
         5 000307   200037 451500                    STP1    @A,,AUTO
         5 000310   000003 701000 5                  TSX1    P_OFF_W
         5 000311   000000 011000                    NOP     0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:95   
      513     5814    2       IF I>0 AND I<=RVA_SIZE THEN

   5814  5 000312   000003 235000 1                  LDA     I
         5 000313   000337 604400 5                  TMOZ    s:5821
         5 000314   000003 236000 1                  LDQ     I
         5 000315   002364 116000 1                  CMPQ    RVA_SIZE
         5 000316   000337 605400 5                  TPNZ    s:5821

      514     5815    3       DO;

      515     5816    3           ARG.OFFSET(NO_ARGS)=I;

   5816  5 000317   000000 620006                    EAX0    0,QL
         5 000320   002372 470400 1                  LDP0    ARG$
         5 000321   000012 721000 1                  LXL1    NO_ARGS
         5 000322   000000 740111                    STX0    0,X1,PR0

      516     5817    3           ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(I);

   5817  5 000323   000003 235000 1                  LDA     I
         5 000324   000001 735000                    ALS     1
         5 000325   000327 605000 5                  TPL     s:5817+4
         5 000326   000044 035003                    ADLA    36,DU
         5 000327   002376 471400 1                  LDP1    TYPE$
         5 000330   003100 061505                    CSR     bolr='003'O
         5 000331   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000332   200076 000022                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=18
         5 000333   200076 220100                    LDX0    ERRMSG_BUF+30,,AUTO
         5 000334   000037 622010                    EAX2    31,X0
         5 000335   000000 442111                    SXL2    0,X1,PR0

      517     5818    3           END;

   5818  5 000336   000532 710000 5                  TRA     s:5859

      518     5819    2       ELSE
      519     5820    3       DO;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:96   

      520     5821    3           CALL P_OFF_W(ADDR(A),ADDR(SNA));

   5821  5 000337   200035 236100                    LDQ     @A,,AUTO
         5 000340   200102 756100                    STQ     ERRMSG_BUF+34,,AUTO
         5 000341   000023 236000 6                  LDQ     19
         5 000342   200103 756100                    STQ     ERRMSG_BUF+35,,AUTO
         5 000343   200103 630500                    EPPR0   ERRMSG_BUF+35,,AUTO
         5 000344   200040 450500                    STP0    @B,,AUTO
         5 000345   200102 631500                    EPPR1   ERRMSG_BUF+34,,AUTO
         5 000346   200037 451500                    STP1    @A,,AUTO
         5 000347   000003 701000 5                  TSX1    P_OFF_W
         5 000350   000000 011000                    NOP     0

      521     5822    3           IF I>=0 AND I<%SNA_SIZE THEN

   5822  5 000351   000003 235000 1                  LDA     I
         5 000352   000363 604000 5                  TMI     s:5826
         5 000353   000036 115007                    CMPA    30,DL
         5 000354   000363 605000 5                  TPL     s:5826

      522     5823    3               ARG.TYPE(NO_ARGS)=A;

   5823  5 000355   200035 470500                    LDP0    @A,,AUTO
         5 000356   000000 720100                    LXL0    0,,PR0
         5 000357   002372 471400 1                  LDP1    ARG$
         5 000360   000012 721000 1                  LXL1    NO_ARGS
         5 000361   100000 440111                    SXL0    0,X1,PR1
         5 000362   000532 710000 5                  TRA     s:5859

      523     5824    3           ELSE
      524     5825    4           DO;

      525     5826    4               CALL P_OFF_W(ADDR(A),UWA$);

   5826  5 000363   200035 236100                    LDQ     @A,,AUTO
         5 000364   200104 756100                    STQ     ERRMSG_BUF+36,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:97   
         5 000365   000024 236000 6                  LDQ     20
         5 000366   200040 756100                    STQ     @B,,AUTO
         5 000367   200104 630500                    EPPR0   ERRMSG_BUF+36,,AUTO
         5 000370   200037 450500                    STP0    @A,,AUTO
         5 000371   000003 701000 5                  TSX1    P_OFF_W
         5 000372   000000 011000                    NOP     0

      526     5827    4               ARG.TYPE(NO_ARGS)=%ELSE_NAME;

   5827  5 000373   000001 220003                    LDX0    1,DU
         5 000374   002372 470400 1                  LDP0    ARG$
         5 000375   000012 721000 1                  LXL1    NO_ARGS
         5 000376   000000 440111                    SXL0    0,X1,PR0

      527     5828    4               IF I>=48 AND I<UWA_SIZE THEN

   5828  5 000377   000003 235000 1                  LDA     I
         5 000400   000060 115007                    CMPA    48,DL
         5 000401   000532 604000 5                  TMI     s:5859
         5 000402   000003 236000 1                  LDQ     I
         5 000403   002363 116000 1                  CMPQ    UWA_SIZE
         5 000404   000532 605000 5                  TPL     s:5859

      528     5829    5               DO;

      529     5830    5                   I=POFFC(ADDR(A),UWA$)*2;

   5830  5 000405   200035 236100                    LDQ     @A,,AUTO
         5 000406   000020 772000                    QRL     16
         5 000407   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 000410   002367 236000 1                  LDQ     UWA$
         5 000411   000020 772000                    QRL     16
         5 000412   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 000413   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000414   200077 136100                    SBLQ    ERRMSG_BUF+31,,AUTO
         5 000415   000001 736000                    QLS     1
         5 000416   000003 756000 1                  STQ     I
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:98   

      530     5831    5                   LOW=2;

   5831  5 000417   000002 235007                    LDA     2,DL
         5 000420   000354 755000 1                  STA     II

      531     5832    5                   HIGH=RVA_SIZE-1;

   5832  5 000421   002364 235000 1                  LDA     RVA_SIZE
         5 000422   000001 135007                    SBLA    1,DL
         5 000423   000355 755000 1                  STA     JJ

      532     5833    5   BINARY_SEARCH: /* BINARY SEARCH THRU RVA */
      533     5834    5                   IF LOW>HIGH THEN CALL ARG_ERROR(2);

   5834  5 000424   000354 236000 1     BINARY_SEAR* LDQ     II
         5 000425   000355 116000 1                  CMPQ    JJ
         5 000426   000433 604400 5                  TMOZ    s:5837

   5834  5 000427   000026 236000 6                  LDQ     22
         5 000430   200037 756100                    STQ     @A,,AUTO
         5 000431   000716 701000 5                  TSX1    ARG_ERROR
         5 000432   000000 011000                    NOP     0

      534     5835        /*E*   ERROR:  ZII-2-1
      535     5836              MESSAGE: RVA and UWA are inconsistent.   */
      536     5837    5                   K=LOW+(HIGH-LOW)/2;

   5837  5 000433   000355 236000 1                  LDQ     JJ
         5 000434   000354 136000 1                  SBLQ    II
         5 000435   000002 506007                    DIV     2,DL
         5 000436   000354 036000 1                  ADLQ    II
         5 000437   000004 756000 1                  STQ     K

      537     5838    5                   J=RVA(K);

   5838  5 000440   002370 470400 1                  LDP0    RVA$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:99   
         5 000441   000000 235106                    LDA     0,QL,PR0
         5 000442   000005 755000 1                  STA     J

      538     5839    5                   IF REDEF_J.NAME<I THEN

   5839  5 000443   000005 236000 1                  LDQ     J
         5 000444   000022 736000                    QLS     18
         5 000445   000022 732000                    QRS     18
         5 000446   000003 116000 1                  CMPQ    I
         5 000447   000454 605000 5                  TPL     s:5844

      539     5840    6                   DO;

      540     5841    6                       LOW=K+1;

   5841  5 000450   000004 235000 1                  LDA     K
         5 000451   000001 035007                    ADLA    1,DL
         5 000452   000354 755000 1                  STA     II

      541     5842    6                       GOTO BINARY_SEARCH;

   5842  5 000453   000424 710000 5                  TRA     BINARY_SEARCH

      542     5843    6                       END;
      543     5844    5                   IF REDEF_J.NAME>I THEN

   5844  5 000454   000461 604400 5                  TMOZ    s:5849

      544     5845    6                   DO;

      545     5846    6                       HIGH=K-1;

   5846  5 000455   000004 235000 1                  LDA     K
         5 000456   000001 135007                    SBLA    1,DL
         5 000457   000355 755000 1                  STA     JJ

      546     5847    6                       GOTO BINARY_SEARCH;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:100  

   5847  5 000460   000424 710000 5                  TRA     BINARY_SEARCH

      547     5848    6                       END;
      548     5849    5                   IF RVA_TYPE(K)=%RECORD_NAME_NET THEN

   5849  5 000461   000004 235000 1                  LDA     K
         5 000462   000001 735000                    ALS     1
         5 000463   000465 605000 5                  TPL     s:5849+4
         5 000464   000044 035003                    ADLA    36,DU
         5 000465   002376 471400 1                  LDP1    TYPE$
         5 000466   003100 061505                    CSR     bolr='003'O
         5 000467   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000470   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 000471   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000472   000002 116007                    CMPQ    2,DL
         5 000473   000513 601000 5                  TNZ     s:5854

      549     5850    6                   DO;

      550     5851    6                       K=K+1;

   5851  5 000474   000004 054000 1                  AOS     K

      551     5852    6                       IF RVA_TYPE(K)=%RECORD_NAME_NET THEN CALL ARG_ERROR(2);

   5852  5 000475   000004 235000 1                  LDA     K
         5 000476   000001 735000                    ALS     1
         5 000477   000501 605000 5                  TPL     s:5852+4
         5 000500   000044 035003                    ADLA    36,DU
         5 000501   003100 061505                    CSR     bolr='003'O
         5 000502   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000503   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 000504   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000505   000002 116007                    CMPQ    2,DL
         5 000506   000513 601000 5                  TNZ     s:5854

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:101  
   5852  5 000507   000026 236000 6                  LDQ     22
         5 000510   200037 756100                    STQ     @A,,AUTO
         5 000511   000716 701000 5                  TSX1    ARG_ERROR
         5 000512   000000 011000                    NOP     0

      552     5853    6                       END;

      553     5854    5                   ARG.OFFSET(NO_ARGS)=K;

   5854  5 000513   000004 720000 1                  LXL0    K
         5 000514   002372 470400 1                  LDP0    ARG$
         5 000515   000012 721000 1                  LXL1    NO_ARGS
         5 000516   000000 740111                    STX0    0,X1,PR0

      554     5855    5                   ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(K);

   5855  5 000517   000004 235000 1                  LDA     K
         5 000520   000001 735000                    ALS     1
         5 000521   000523 605000 5                  TPL     s:5855+4
         5 000522   000044 035003                    ADLA    36,DU
         5 000523   002376 471400 1                  LDP1    TYPE$
         5 000524   003100 061505                    CSR     bolr='003'O
         5 000525   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000526   200076 000022                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=18
         5 000527   200076 222100                    LDX2    ERRMSG_BUF+30,,AUTO
         5 000530   000037 623012                    EAX3    31,X2
         5 000531   000000 443111                    SXL3    0,X1,PR0

      555     5856    5                   END;

      556     5857    4               END;

      557     5858    3           END;

      558     5859    2       NO_ARGS=NO_ARGS+1;

   5859  5 000532   000012 054000 1                  AOS     NO_ARGS
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:102  

      559     5860    2   END CHK_ARG;

   5860  5 000533   200034 221300                    LDX1  ! @RLCW+1,,AUTO
         5 000534   000001 702211                    TSX2  ! 1,X1

      560     5861         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:103  
      561     5862        /************************************************************/
      562     5863        /*                                                          */
      563     5864        /*    INTERNAL SUBROUTINE TO SETUP ARG'S LIST               */
      564     5865        /*                                                          */
      565     5866        /*    1. DETERMINE THE NUMBER OF PARAMETERS PASSED          */
      566     5867        /*    2. SAVE EACH ARG'S ADDRESS, AND CONVERT INTO RVA ADDR */
      567     5868        /*       IF IT IS A FIELD-NAME                              */
      568     5869        /*                                                          */
      569     5870        /************************************************************/
      570     5871
      571     5872    1   SET_ARGS: PROC;

   5872  5 000535   200032 741300       SET_ARGS     STX1  ! @B,,AUTO

      572     5873
      573     5874    2       IA_HALF(12) = 0; /* Roll back flag should start zero */

   5874  5 000536   002366 470400 1                  LDP0    IA$
         5 000537   000100 101400                    MRL     fill='000'O
         5 000540   000027 000004 6                  ADSC9   23                       cn=0,n=4
         5 000541   000006 000002                    ADSC9   6,,PR0                   cn=0,n=2

      574     5875    2       IA_HALF(13)=AUTO_FRAME(-2*(AUTO_FRAME(1)+1));

   5875  5 000542   000000 471400 2                  LDP1    AUTO$
         5 000543   000100 100500                    MLR     fill='000'O
         5 000544   100000 400002                    ADSC9   0,,PR1                   cn=2,n=2
         5 000545   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 000546   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000547   000022 732000                    QRS     18
         5 000550   000002 736000                    QLS     2
         5 000551   000030 676000 6                  ERQ     24
         5 000552   000001 036007                    ADLQ    1,DL
         5 000553   000100 100506                    MLR     fill='000'O
         5 000554   177777 000002                    ADSC9   -1,Q,PR1                 cn=0,n=2
         5 000555   000006 400002                    ADSC9   6,,PR0                   cn=2,n=2
         5 000556   000560 710000 5                  TRA     s:5877
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:104  

      575     5876    2   SET_ARGS1: ENTRY; /* FOR USEPROC, CALLED BEFORE INVOKE */

   5876  5 000557   200032 741300       SET_ARGS1    STX1  ! @B,,AUTO

      576     5877    2       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN CALL ARG_ERROR(10);

   5877  5 000560   002401 236000 1                  LDQ     PAGE_VECTOR+1
         5 000561   000015 116000 6                  CMPQ    13
         5 000562   000567 601000 5                  TNZ     s:5880

   5877  5 000563   000032 236000 6                  LDQ     26
         5 000564   200037 756100                    STQ     @A,,AUTO
         5 000565   000716 701000 5                  TSX1    ARG_ERROR
         5 000566   000000 011000                    NOP     0

      577     5878        /*E*  ERROR: ZII-10-7
      578     5879              MESSAGE: INVOKE CALL is not performed as your 1st IDS statement.  */
      579     5880    2       NO_ARGS=0;

   5880  5 000567   000012 450000 1                  STZ     NO_ARGS

      580     5881            %GEN_PARAMS(TYPE=2); /* CALL CHK_ARG(A1 TO A20); */

   5901  5 000570   200003 236100                    LDQ     @A1,,AUTO
         5 000571   200035 756100                    STQ     @A,,AUTO
         5 000572   000272 701000 5                  TSX1    CHK_ARG
         5 000573   000710 702000 5                  TSX2    END_OF_ARGS

   5926  5 000574   200004 236100                    LDQ     @A2,,AUTO
         5 000575   200035 756100                    STQ     @A,,AUTO
         5 000576   000272 701000 5                  TSX1    CHK_ARG
         5 000577   000710 702000 5                  TSX2    END_OF_ARGS

   5951  5 000600   200005 236100                    LDQ     @A3,,AUTO
         5 000601   200035 756100                    STQ     @A,,AUTO
         5 000602   000272 701000 5                  TSX1    CHK_ARG
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:105  
         5 000603   000710 702000 5                  TSX2    END_OF_ARGS

   5976  5 000604   200006 236100                    LDQ     @A4,,AUTO
         5 000605   200035 756100                    STQ     @A,,AUTO
         5 000606   000272 701000 5                  TSX1    CHK_ARG
         5 000607   000710 702000 5                  TSX2    END_OF_ARGS

   6001  5 000610   200007 236100                    LDQ     @A5,,AUTO
         5 000611   200035 756100                    STQ     @A,,AUTO
         5 000612   000272 701000 5                  TSX1    CHK_ARG
         5 000613   000710 702000 5                  TSX2    END_OF_ARGS

   6026  5 000614   200010 236100                    LDQ     @A6,,AUTO
         5 000615   200035 756100                    STQ     @A,,AUTO
         5 000616   000272 701000 5                  TSX1    CHK_ARG
         5 000617   000710 702000 5                  TSX2    END_OF_ARGS

   6051  5 000620   200011 236100                    LDQ     @A7,,AUTO
         5 000621   200035 756100                    STQ     @A,,AUTO
         5 000622   000272 701000 5                  TSX1    CHK_ARG
         5 000623   000710 702000 5                  TSX2    END_OF_ARGS

   6076  5 000624   200012 236100                    LDQ     @A8,,AUTO
         5 000625   200035 756100                    STQ     @A,,AUTO
         5 000626   000272 701000 5                  TSX1    CHK_ARG
         5 000627   000710 702000 5                  TSX2    END_OF_ARGS

   6101  5 000630   200013 236100                    LDQ     @A9,,AUTO
         5 000631   200035 756100                    STQ     @A,,AUTO
         5 000632   000272 701000 5                  TSX1    CHK_ARG
         5 000633   000710 702000 5                  TSX2    END_OF_ARGS

   6126  5 000634   200014 236100                    LDQ     @A10,,AUTO
         5 000635   200035 756100                    STQ     @A,,AUTO
         5 000636   000272 701000 5                  TSX1    CHK_ARG
         5 000637   000710 702000 5                  TSX2    END_OF_ARGS

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:106  
   6151  5 000640   200015 236100                    LDQ     @A11,,AUTO
         5 000641   200035 756100                    STQ     @A,,AUTO
         5 000642   000272 701000 5                  TSX1    CHK_ARG
         5 000643   000710 702000 5                  TSX2    END_OF_ARGS

   6176  5 000644   200016 236100                    LDQ     @A12,,AUTO
         5 000645   200035 756100                    STQ     @A,,AUTO
         5 000646   000272 701000 5                  TSX1    CHK_ARG
         5 000647   000710 702000 5                  TSX2    END_OF_ARGS

   6201  5 000650   200017 236100                    LDQ     @A13,,AUTO
         5 000651   200035 756100                    STQ     @A,,AUTO
         5 000652   000272 701000 5                  TSX1    CHK_ARG
         5 000653   000710 702000 5                  TSX2    END_OF_ARGS

   6226  5 000654   200020 236100                    LDQ     @A14,,AUTO
         5 000655   200035 756100                    STQ     @A,,AUTO
         5 000656   000272 701000 5                  TSX1    CHK_ARG
         5 000657   000710 702000 5                  TSX2    END_OF_ARGS

   6251  5 000660   200021 236100                    LDQ     @A15,,AUTO
         5 000661   200035 756100                    STQ     @A,,AUTO
         5 000662   000272 701000 5                  TSX1    CHK_ARG
         5 000663   000710 702000 5                  TSX2    END_OF_ARGS

   6276  5 000664   200022 236100                    LDQ     @A16,,AUTO
         5 000665   200035 756100                    STQ     @A,,AUTO
         5 000666   000272 701000 5                  TSX1    CHK_ARG
         5 000667   000710 702000 5                  TSX2    END_OF_ARGS

   6301  5 000670   200023 236100                    LDQ     @A17,,AUTO
         5 000671   200035 756100                    STQ     @A,,AUTO
         5 000672   000272 701000 5                  TSX1    CHK_ARG
         5 000673   000710 702000 5                  TSX2    END_OF_ARGS

   6326  5 000674   200024 236100                    LDQ     @A18,,AUTO
         5 000675   200035 756100                    STQ     @A,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:107  
         5 000676   000272 701000 5                  TSX1    CHK_ARG
         5 000677   000710 702000 5                  TSX2    END_OF_ARGS

   6351  5 000700   200025 236100                    LDQ     @A19,,AUTO
         5 000701   200035 756100                    STQ     @A,,AUTO
         5 000702   000272 701000 5                  TSX1    CHK_ARG
         5 000703   000710 702000 5                  TSX2    END_OF_ARGS

   6376  5 000704   200026 236100                    LDQ     @A020,,AUTO
         5 000705   200035 756100                    STQ     @A,,AUTO
         5 000706   000272 701000 5                  TSX1    CHK_ARG
         5 000707   000710 702000 5                  TSX2    END_OF_ARGS

      581     6422    2   END_OF_ARGS: ADDR(FPTS.V) -> NINE_WORDS = '0'B;

   6422  5 000710   002371 470400 1     END_OF_ARGS  LDP0    FPT$
         5 000711   000100 100400                    MLR     fill='000'O
         5 000712   000027 000001 6                  ADSC9   23                       cn=0,n=1
         5 000713   000012 000044                    ADSC9   10,,PR0                  cn=0,n=36

      582     6423
      583     6424    2   END SET_ARGS;

   6424  5 000714   200032 221300                    LDX1  ! @B,,AUTO
         5 000715   000001 702211                    TSX2  ! 1,X1

      584     6425         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:108  
      585     6426        /*******************************************************************/
      586     6427        /*                                                                 */
      587     6428        /*    ARG_ERROR: READ ERROR MESSAGE AND ABORT THE JOB              */
      588     6429        /*                                                                 */
      589     6430        /*******************************************************************/
      590     6431
      591     6432    1   ARG_ERROR: PROC(ERR_NO);

   6432  5 000716   200036 741300       ARG_ERROR    STX1  ! @A+1,,AUTO

      592     6433
      593     6434    2   DCL ERR_NO UBIN;
      594     6435    2   DCL ERRMSG_BUF CHAR(120) AUTO ALIGNED;
      595     6436
      596     6437    2       ERR_CODE.ERR_NO=ERR_NO;

   6437  5 000717   200037 470500                    LDP0    @ERR_NO,,AUTO
         5 000720   000000 236100                    LDQ     0,,PR0
         5 000721   000003 736000                    QLS     3
         5 000722   002402 676000 1                  ERQ     ERR_CODE
         5 000723   777770 376007                    ANQ     -8,DL
         5 000724   002402 656000 1                  ERSQ    ERR_CODE

      597     6438    2       FPT_ERRMSG.BUF_=VECTOR(ERRMSG_BUF);

   6438  5 000725   000033 235000 6                  LDA     27
         5 000726   200076 452500                    STP2    ERRMSG_BUF+30,,AUTO
         5 000727   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000730   000040 036003                    ADLQ    32,DU
         5 000731   002424 757000 1                  STAQ    FPT_ERRMSG+4

      598     6439    2       CALL M$ERRMSG(FPT_ERRMSG);

   6439  5 000732   002420 630400 1                  EPPR0   FPT_ERRMSG
         5 000733   020000 713400                    CLIMB   8192
         5 000734   405000 401760                    pmme    nvectors=11

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:109  
      599     6440    2       CALL M$ERR;

   6440  5 000735   000002 713400                    CLIMB   err
         5 000736   000000 401760                    pmme    nvectors=0

      600     6441    2   END ARG_ERROR;

   6441  5 000737   200036 221300                    LDX1  ! @A+1,,AUTO
         5 000740   000001 702211                    TSX2  ! 1,X1

      601     6442         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:110  
      602     6443        /****************************************************************/
      603     6444        /*                                                              */
      604     6445        /*    GET A PAGE OF DYNAMIC MEMORY AT THE VERY 1ST IDS CALL     */
      605     6446        /*                                                              */
      606     6447        /****************************************************************/
      607     6448
      608     6449    1   GET_A_PAGE: PROC;

   6449  5 000741   200030 741300       GET_A_PAGE   STX1  ! FIT$+1,,AUTO

      609     6450
      610     6451    2       CALL M$GDP(FPT_GDP) ALTRET(OUT_OF_MEMORY);

   6451  5 000742   002404 630400 1                  EPPR0   FPT_GDP
         5 000743   430003 713400                    CLIMB   alt,+12291
         5 000744   400400 401760                    pmme    nvectors=2
         5 000745   000770 702000 5                  TSX2    OUT_OF_MEMORY

      611     6452    2       FPT$=PAGE_VECTOR.ADR;

   6452  5 000746   002401 236000 1                  LDQ     PAGE_VECTOR+1
         5 000747   002371 756000 1                  STQ     FPT$

      612     6453    2       ARG$=ADDR(FPTS.V.FPARAM(0));

   6453  5 000750   000024 036003                    ADLQ    20,DU
         5 000751   002372 756000 1                  STQ     ARG$

      613     6454    2       RLCW$=PINCRW(FPT$,%FPT_SIZE);

   6454  5 000752   002371 236000 1                  LDQ     FPT$
         5 000753   000076 036003                    ADLQ    62,DU
         5 000754   002375 756000 1                  STQ     RLCW$

      614     6455    2       TYPE$=PINCRW(RLCW$,%RLCW_SIZE);

   6455  5 000755   000013 036003                    ADLQ    11,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:111  
         5 000756   002376 756000 1                  STQ     TYPE$

      615     6456    2       FPTS.V_=VECTOR(FPTS.V);

   6456  5 000757   000034 235000 6                  LDA     28
         5 000760   002371 236000 1                  LDQ     FPT$
         5 000761   000012 036003                    ADLQ    10,DU
         5 000762   002371 470400 1                  LDP0    FPT$
         5 000763   000000 757100                    STAQ    0,,PR0

      616     6457    2       FPT_ERRMSG.BUF_=FPTS.V_; /* M$ERRMSG USE THIS AREA TOO */

   6457  5 000764   000000 237100                    LDAQ    0,,PR0
         5 000765   002424 757000 1                  STAQ    FPT_ERRMSG+4

      617     6458    2       RETURN;

   6458  5 000766   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000767   000001 702211                    TSX2  ! 1,X1

      618     6459
      619     6460        /*E*  ERROR: ZII-5-1
      620     6461              MESSAGE: Failed to get a dynamic page, core limit exceeded.  */
      621     6462
      622     6463    2   OUT_OF_MEMORY:
      623     6464    2       CALL ARG_ERROR(5);

   6464  5 000770   000036 236000 6     OUT_OF_MEMO* LDQ     30
         5 000771   200037 756100                    STQ     @ERR_NO,,AUTO
         5 000772   000716 701000 5                  TSX1    ARG_ERROR
         5 000773   000000 011000                    NOP     0

      624     6465    2   END GET_A_PAGE;

   6465  5 000774   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000775   000001 702211                    TSX2  ! 1,X1
         5 000776   001001 710000 5                  TRA     s:7028
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:112  

      625     6466         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:113  
      626     6467        /****************************************************************/
      627     6468        /*                                                              */
      628     6469        /*    CALL PRIVACY(RECORD,IDS-NAME1,PRIVACY-KEY,REC-NAME)       */
      629     6470        /*                                                              */
      630     6471        /*      IDS-NAME1: CONNECT,DISCONNECT,STORE,ERASE               */
      631     6472        /*                 MODIFY,FIND,GET                              */
      632     6473        /*                                                              */
      633     6474        /*    CALL PRIVACY(SET,CONNECT,PRIVACY-KEY,SET-NAME1,....)      */
      634     6475        /*                     DISCONNECT                               */
      635     6476        /*                     FIND                                     */
      636     6477        /*                                                              */
      637     6478        /*    CALL PRIVACY(ITEM,MODIFY/GET,PRIVACY-KEY,ITEM-1,...)      */
      638     6479        /*                                                              */
      639     6480        /****************************************************************/
      640     6481
      641     6482    1   PRIVACY: ENTRY(

   6482  5 000777   000000 700200 xent  PRIVACY      TSX0  ! X66_AUTO_N
         5 001000   000106 000024                    ZERO    70,20

      642     6483               %GEN_PARAMS;
      643     7024
      644     7025        /*E*  ERROR: ZII-15-1
      645     7026              MESSAGE: Syntax error detected in PRIVACY CALL. */
      646     7027
      647     7028    1       CALL SET_ARGS;

   7028  5 001001   000535 701000 5                  TSX1    SET_ARGS
         5 001002   000000 011000                    NOP     0

      648     7029    1       IF A1(0)=SNA.SET THEN

   7029  5 001003   200003 470500                    LDP0    @A1,,AUTO
         5 001004   000100 100500                    MLR     fill='000'O
         5 001005   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 001006   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001007   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:114  
         5 001010   000024 116000 0                  CMPQ    SNA+20
         5 001011   001015 601000 5                  TNZ     s:7032

      649     7030    1           K=1;

   7030  5 001012   000001 235007                    LDA     1,DL
         5 001013   000004 755000 1                  STA     K
         5 001014   001043 710000 5                  TRA     s:7040

      650     7031    1       ELSE
      651     7032    1           IF A1(0)=SNA.RECORD THEN

   7032  5 001015   000100 100500                    MLR     fill='000'O
         5 001016   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 001017   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001020   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001021   000022 116000 0                  CMPQ    SNA+18
         5 001022   001026 601000 5                  TNZ     s:7035

      652     7033    1               K=2;

   7033  5 001023   000002 235007                    LDA     2,DL
         5 001024   000004 755000 1                  STA     K
         5 001025   001043 710000 5                  TRA     s:7040

      653     7034    1           ELSE
      654     7035    1               IF A1(0)=SNA.ITEM THEN

   7035  5 001026   000100 100500                    MLR     fill='000'O
         5 001027   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 001030   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001031   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001032   000010 116000 0                  CMPQ    SNA+8
         5 001033   001037 601000 5                  TNZ     s:7038

      655     7036    1                   K=3;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:115  
   7036  5 001034   000003 235007                    LDA     3,DL
         5 001035   000004 755000 1                  STA     K
         5 001036   001043 710000 5                  TRA     s:7040

      656     7037    1               ELSE
      657     7038    1                   CALL ARG_ERROR(15); /* UNKNOWN FIRST ARGUMENT */

   7038  5 001037   000040 236000 6                  LDQ     32
         5 001040   200037 756100                    STQ     @A+2,,AUTO
         5 001041   000716 701000 5                  TSX1    ARG_ERROR
         5 001042   000000 011000                    NOP     0

      658     7039
      659     7040    1       JJ=NO_ARGS-1; /* START FROM THE END OF ARG_LIST */

   7040  5 001043   000012 235000 1                  LDA     NO_ARGS
         5 001044   000001 135007                    SBLA    1,DL
         5 001045   000355 755000 1                  STA     JJ

      660     7041    2       DO WHILE(ARG.TYPE(JJ)-%SET_NAME+1=K);

   7041  5 001046   001051 710000 5                  TRA     s:7043

      661     7042    2           JJ=JJ-1;

   7042  5 001047   000001 336007                    LCQ     1,DL
         5 001050   000355 056000 1                  ASQ     JJ

      662     7043    2           END;

   7043  5 001051   002372 470400 1                  LDP0    ARG$
         5 001052   000355 720000 1                  LXL0    JJ
         5 001053   000000 236110                    LDQ     0,X0,PR0
         5 001054   777777 376007                    ANQ     -1,DL
         5 001055   000037 136007                    SBLQ    31,DL
         5 001056   000004 116000 1                  CMPQ    K
         5 001057   001047 600000 5                  TZE     s:7042
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:116  

      663     7044    1       IF (K<3 AND JJ=NO_ARGS-1) THEN

   7044  5 001060   000004 235000 1                  LDA     K
         5 001061   000003 115007                    CMPA    3,DL
         5 001062   001073 605000 5                  TPL     s:7050
         5 001063   000012 236000 1                  LDQ     NO_ARGS
         5 001064   000001 136007                    SBLQ    1,DL
         5 001065   000355 116000 1                  CMPQ    JJ
         5 001066   001073 601000 5                  TNZ     s:7050

      664     7045    2       DO; /* IN CASE NO REC OR SET SPECIFIED IN THE LIST */

      665     7046    2           ARG.OFFSET(NO_ARGS)=0; /* FOR ALL REC OR SETS */

   7046  5 001067   000000 221003                    LDX1    0,DU
         5 001070   000012 722000 1                  LXL2    NO_ARGS
         5 001071   000000 741112                    STX1    0,X2,PR0

      666     7047    2           NO_ARGS=NO_ARGS+1; /* MAKE A FAKE ARGUMENT */

   7047  5 001072   000012 054000 1                  AOS     NO_ARGS

      667     7048    2           END;

      668     7049
      669     7050    1       KK=USEP.M;

   7050  5 001073   002373 471400 1                  LDP1    USEP$
         5 001074   100000 236100                    LDQ     0,,PR1
         5 001075   000022 772000                    QRL     18
         5 001076   377777 376007                    ANQ     131071,DL
         5 001077   000356 756000 1                  STQ     KK

      670     7051    2       DO I=1 TO JJ-1; /* LOOP THRU IDS ROUTINE ADDR */

   7051  5 001100   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:117  
         5 001101   000003 755000 1                  STA     I
         5 001102   001177 710000 5                  TRA     s:7065+1

      671     7052    2           PT$=FPTS.V.ARG(I);

   7052  5 001103   002371 470400 1                  LDP0    FPT$
         5 001104   000003 720000 1                  LXL0    I
         5 001105   000051 236110                    LDQ     41,X0,PR0
         5 001106   000010 756000 1                  STQ     PT$

      672     7053    2           J=0;

   7053  5 001107   000005 450000 1                  STZ     J

      673     7054    3           DO WHILE(J<8 AND IDS_ADR(J)~=REDEF_PT.ADR);

   7054  5 001110   001112 710000 5                  TRA     s:7056

      674     7055    3               J=J+1;

   7055  5 001111   000005 054000 1                  AOS     J

      675     7056    3               END;

   7056  5 001112   000005 235000 1                  LDA     J
         5 001113   000010 115007                    CMPA    8,DL
         5 001114   001120 605000 5                  TPL     s:7057
         5 001115   000333 220005 1                  LDX0    IDS_ADR,AL
         5 001116   000010 100000 1                  CMPX0   PT$
         5 001117   001111 601000 5                  TNZ     s:7055

      676     7057    2           IF J=8 THEN CALL ARG_ERROR(15); /* UNKNOWN IDS ROUTINE */

   7057  5 001120   000005 235000 1                  LDA     J
         5 001121   000010 115007                    CMPA    8,DL
         5 001122   001127 601000 5                  TNZ     s:7058

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:118  
   7057  5 001123   000040 236000 6                  LDQ     32
         5 001124   200037 756100                    STQ     @A+2,,AUTO
         5 001125   000716 701000 5                  TSX1    ARG_ERROR
         5 001126   000000 011000                    NOP     0

      677     7058    3           DO II=JJ+1 TO NO_ARGS-1; /* LOOP THRU REC OR SET OR ITEM LIST */

   7058  5 001127   000355 235000 1                  LDA     JJ
         5 001130   000001 035007                    ADLA    1,DL
         5 001131   000354 755000 1                  STA     II
         5 001132   001173 710000 5                  TRA     s:7064+1

      678     7059    3               USEP.UC.UCW_PRV.PT(KK)=K;

   7059  5 001133   000356 235000 1                  LDA     KK
         5 001134   000001 735000                    ALS     1
         5 001135   002373 470400 1                  LDP0    USEP$
         5 001136   000004 236000 1                  LDQ     K
         5 001137   000033 736000                    QLS     27
         5 001140   000001 676105                    ERQ     1,AL,PR0
         5 001141   777000 376003                    ANQ     -512,DU
         5 001142   000001 656105                    ERSQ    1,AL,PR0

      679     7060    3               USEP.UC.UCW_PRV.PB(KK)=IDS_BIT9(J);

   7060  5 001143   000005 720000 1                  LXL0    J
         5 001144   000343 236010 1                  LDQ     IDS_BIT9,X0
         5 001145   000011 772000                    QRL     9
         5 001146   000001 676105                    ERQ     1,AL,PR0
         5 001147   000777 376003                    ANQ     511,DU
         5 001150   000001 656105                    ERSQ    1,AL,PR0

      680     7061    3               USEP.UC.UCW_PRV.A(KK)=RVA_HALF(2*ARG.OFFSET(II)+1);

   7061  5 001151   002372 471400 1                  LDP1    ARG$
         5 001152   000354 721000 1                  LXL1    II
         5 001153   100000 236111                    LDQ     0,X1,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:119  
         5 001154   000022 772000                    QRL     18
         5 001155   000002 736000                    QLS     2
         5 001156   000002 735000                    ALS     2
         5 001157   002370 473400 1                  LDP3    RVA$
         5 001160   000105 100506                    MLR     fill='000'O
         5 001161   300000 400002                    ADSC9   0,Q,PR3                  cn=2,n=2
         5 001162   000001 400002                    ADSC9   1,A,PR0                  cn=2,n=2

      681     7062    3               USEP.UC.ENT$(KK)=FPTS.V.ARG(JJ); /* USER PROCEDURE ADDR */

   7062  5 001163   000356 235000 1                  LDA     KK
         5 001164   000001 735000                    ALS     1
         5 001165   002371 473400 1                  LDP3    FPT$
         5 001166   000355 722000 1                  LXL2    JJ
         5 001167   300051 236112                    LDQ     41,X2,PR3
         5 001170   000002 756105                    STQ     2,AL,PR0

      682     7063    3               KK=KK+1;

   7063  5 001171   000356 054000 1                  AOS     KK

      683     7064    3               END;

   7064  5 001172   000354 054000 1                  AOS     II
         5 001173   000354 236000 1                  LDQ     II
         5 001174   000012 116000 1                  CMPQ    NO_ARGS
         5 001175   001133 604000 5                  TMI     s:7059

      684     7065    2           END;

   7065  5 001176   000003 054000 1                  AOS     I
         5 001177   000003 236000 1                  LDQ     I
         5 001200   000355 116000 1                  CMPQ    JJ
         5 001201   001103 604000 5                  TMI     s:7052

      685     7066    1       USEP.M=KK;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:120  
   7066  5 001202   002373 470400 1                  LDP0    USEP$
         5 001203   000356 236000 1                  LDQ     KK
         5 001204   000022 736000                    QLS     18
         5 001205   000000 676100                    ERQ     0,,PR0
         5 001206   377777 376003                    ANQ     131071,DU
         5 001207   000000 656100                    ERSQ    0,,PR0

      686     7067    1       RETURN;

   7067  5 001210   000000 702200 xent               TSX2  ! X66_ARET

      687     7068         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:121  
      688     7069        /**************************************************************/
      689     7070        /*                                                            */
      690     7071        /*    CALL USE(SUBROUTINE-NAME,ERROR-1,ERROR-2,...)           */
      691     7072        /*                                                            */
      692     7073        /*    1.   GENERATE ENTRY POINTS IN 'USEP' TABLE              */
      693     7074        /*    2.   SAVE SUBROUITNE ADDRESSES IN 'EPTR_SAVE' TABLE     */
      694     7075        /*                                                            */
      695     7076        /**************************************************************/
      696     7077
      697     7078    1   USEPROC: ENTRY(

   7078  5 001211   000000 700200 xent  USEPROC      TSX0  ! X66_AUTO_N
         5 001212   000106 000024                    ZERO    70,20

      698     7079               %GEN_PARAMS;
      699     7620
      700     7621    1       CALL SET_ARGS1;

   7621  5 001213   000557 701000 5                  TSX1    SET_ARGS1
         5 001214   000000 011000                    NOP     0

      701     7622    2       DO I=1 TO NO_ARGS-1;

   7622  5 001215   000001 235007                    LDA     1,DL
         5 001216   000003 755000 1                  STA     I
         5 001217   001276 710000 5                  TRA     s:7631+1

      702     7623    2           IF ARG.TYPE(I)=SNA.ALL THEN

   7623  5 001220   002372 470400 1                  LDP0    ARG$
         5 001221   000003 720000 1                  LXL0    I
         5 001222   000000 236110                    LDQ     0,X0,PR0
         5 001223   777777 376007                    ANQ     -1,DL
         5 001224   000000 116000 0                  CMPQ    SNA
         5 001225   001230 601000 5                  TNZ     s:7626

      703     7624    2               J=0; /* USEPROC FOR ALL OTHERS */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:122  

   7624  5 001226   000005 450000 1                  STZ     J
         5 001227   001235 710000 5                  TRA     s:7627

      704     7625    2           ELSE
      705     7626    2               CALL CHARBIN(J,FPTS.V.ARG(I)->CHAR7);

   7626  5 001230   002371 471400 1                  LDP1    FPT$
         5 001231   100051 473510                    LDP3    41,X0,PR1
         5 001232   000000 305500                    DTB
         5 001233   300000 030007                    NDSC9   0,,PR3                   cn=0,s=nosgn,sf=0,n=7
         5 001234   000005 000004 1                  NDSC9   J                        cn=0,s=lsgnf,sf=0,n=4

      706     7627    2           USEP.UC.UCW_USE.PT(USEP.M)=6;

   7627  5 001235   002373 471400 1                  LDP1    USEP$
         5 001236   100000 221100                    LDX1    0,,PR1
         5 001237   377777 361003                    ANX1    131071,DU
         5 001240   000000 635011                    EAA     0,X1
         5 001241   000021 771000                    ARL     17
         5 001242   100001 236105                    LDQ     1,AL,PR1
         5 001243   000041 376000 6                  ANQ     33
         5 001244   006000 276003                    ORQ     3072,DU
         5 001245   100001 756105                    STQ     1,AL,PR1

      707     7628    2           USEP.UC.UCW_USE.CODE(USEP.M)=J;

   7628  5 001246   100000 220100                    LDX0    0,,PR1
         5 001247   377777 360003                    ANX0    131071,DU
         5 001250   000000 635010                    EAA     0,X0
         5 001251   000021 771000                    ARL     17
         5 001252   000005 236000 1                  LDQ     J
         5 001253   100001 676105                    ERQ     1,AL,PR1
         5 001254   000041 376000 6                  ANQ     33
         5 001255   100001 656105                    ERSQ    1,AL,PR1

      708     7629    2           USEP.UC.ENT$(USEP.M)=FPTS.V.ARG(0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:123  

   7629  5 001256   100000 220100                    LDX0    0,,PR1
         5 001257   377777 360003                    ANX0    131071,DU
         5 001260   000000 635010                    EAA     0,X0
         5 001261   000021 771000                    ARL     17
         5 001262   002371 473400 1                  LDP3    FPT$
         5 001263   300051 236100                    LDQ     41,,PR3
         5 001264   100002 756105                    STQ     2,AL,PR1

      709     7630    2           USEP.M=USEP.M+1;

   7630  5 001265   100000 236100                    LDQ     0,,PR1
         5 001266   000022 772000                    QRL     18
         5 001267   377777 376007                    ANQ     131071,DL
         5 001270   000001 036007                    ADLQ    1,DL
         5 001271   000022 736000                    QLS     18
         5 001272   100000 676100                    ERQ     0,,PR1
         5 001273   377777 376003                    ANQ     131071,DU
         5 001274   100000 656100                    ERSQ    0,,PR1

      710     7631    2           END;

   7631  5 001275   000003 054000 1                  AOS     I
         5 001276   000003 236000 1                  LDQ     I
         5 001277   000012 116000 1                  CMPQ    NO_ARGS
         5 001300   001220 604000 5                  TMI     s:7623

      711     7632    1       RETURN;

   7632  5 001301   000000 702200 xent               TSX2  ! X66_ARET

      712     7633         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:124  
      713     7634        /****************************************************************/
      714     7635        /*                                                              */
      715     7636        /*    CALL RETAIN( AREA                               )         */
      716     7637        /*                 SETS                                         */
      717     7638        /*                 RECORD                                       */
      718     7639        /*                 SET-NAME1,SET-NAME2,.....                    */
      719     7640        /*                                                              */
      720     7641        /*         1.  SAVE RETAINING CONTROL LIST.                     */
      721     7642        /*         2.  SET SWITCH ON, RETAINING LIST WILL BE USED ON    */
      722     7643        /*             NEXT IDS CALL WITH RETAIN CURRENCY OPTION        */
      723     7644        /*                                                              */
      724     7645        /****************************************************************/
      725     7646
      726     7647    1   RETAIN: ENTRY(

   7647  5 001302   000000 700200 xent  RETAIN       TSX0  ! X66_AUTO_N
         5 001303   000106 000024                    ZERO    70,20

      727     7648               %GEN_PARAMS;
      728     8189
      729     8190    1       ADDR(RLCW_SAVE)->SBIN36=0;

   8190  5 001304   002375 470400 1                  LDP0    RLCW$
         5 001305   000000 450100                    STZ     0,,PR0

      730     8191    1       CALL SET_ARGS;

   8191  5 001306   000535 701000 5                  TSX1    SET_ARGS
         5 001307   000000 011000                    NOP     0

      731     8192        /*E*  ERROR: ZII-20-1
      732     8193              MESSAGE: Syntax error in RETAIN CALL.  */
      733     8194    1       K=0;

   8194  5 001310   000004 450000 1                  STZ     K

      734     8195    2       DO WHILE (K<NO_ARGS);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:125  

   8195  5 001311   000004 236000 1                  LDQ     K
         5 001312   000012 116000 1                  CMPQ    NO_ARGS
         5 001313   001375 605000 5                  TPL     s:8214

      735     8196    2           IF ARG.TYPE(K)=%SET_NAME THEN

   8196  5 001314   002372 470400 1                  LDP0    ARG$
         5 001315   000004 720000 1                  LXL0    K
         5 001316   000000 721110                    LXL1    0,X0,PR0
         5 001317   000040 101003                    CMPX1   32,DU
         5 001320   001341 601000 5                  TNZ     s:8202

      736     8197    3           DO;

      737     8198    3               RLCW_SAVE.RETAIN_LIST(RLCW_SAVE.N_SETS#)=ARG.OFFSET(K);

   8198  5 001321   002375 471400 1                  LDP1    RLCW$
         5 001322   100000 236100                    LDQ     0,,PR1
         5 001323   000377 376007                    ANQ     255,DL
         5 001324   000004 235000 1                  LDA     K
         5 001325   000002 735000                    ALS     2
         5 001326   000001 736000                    QLS     1
         5 001327   000106 100505                    MLR     fill='000'O
         5 001330   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         5 001331   100001 000002                    ADSC9   1,Q,PR1                  cn=0,n=2

      738     8199    3               RLCW_SAVE.N_SETS#=RLCW_SAVE.N_SETS#+1;

   8199  5 001332   100000 236100                    LDQ     0,,PR1
         5 001333   000377 376007                    ANQ     255,DL
         5 001334   000001 036007                    ADLQ    1,DL
         5 001335   100000 676100                    ERQ     0,,PR1
         5 001336   000377 376007                    ANQ     255,DL
         5 001337   100000 656100                    ERSQ    0,,PR1

      739     8200    3               END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:126  

   8200  5 001340   001371 710000 5                  TRA     s:8212

      740     8201    2           ELSE
      741     8202    2               IF ARG.TYPE(K)=SNA.AREA THEN

   8202  5 001341   000000 236110                    LDQ     0,X0,PR0
         5 001342   777777 376007                    ANQ     -1,DL
         5 001343   000020 116000 0                  CMPQ    SNA+16
         5 001344   001351 601000 5                  TNZ     s:8205

      742     8203    2                   RLCW_SAVE.AC_INDICATORS='1'B;

   8203  5 001345   002375 471400 1                  LDP1    RLCW$
         5 001346   400000 236007                    LDQ     -131072,DL
         5 001347   100000 256100                    ORSQ    0,,PR1
         5 001350   001371 710000 5                  TRA     s:8212

      743     8204    2               ELSE
      744     8205    2                   IF ARG.TYPE(K)=SNA.SETS THEN

   8205  5 001351   000025 116000 0                  CMPQ    SNA+21
         5 001352   001357 601000 5                  TNZ     s:8208

      745     8206    2                       RLCW_SAVE.SC_INDICATORS='1'B;

   8206  5 001353   002375 471400 1                  LDP1    RLCW$
         5 001354   200000 236007                    LDQ     65536,DL
         5 001355   100000 256100                    ORSQ    0,,PR1
         5 001356   001371 710000 5                  TRA     s:8212

      746     8207    2                   ELSE
      747     8208    2                       IF ARG.TYPE(K)=SNA.RECORD THEN

   8208  5 001357   000022 116000 0                  CMPQ    SNA+18
         5 001360   001365 601000 5                  TNZ     s:8211

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:127  
      748     8209    2                           RLCW_SAVE.RC_INDICATORS='1'B;

   8209  5 001361   002375 471400 1                  LDP1    RLCW$
         5 001362   100000 236007                    LDQ     32768,DL
         5 001363   100000 256100                    ORSQ    0,,PR1
         5 001364   001371 710000 5                  TRA     s:8212

      749     8210    2                       ELSE
      750     8211    2                           CALL ARG_ERROR(20);

   8211  5 001365   000043 236000 6                  LDQ     35
         5 001366   200037 756100                    STQ     @A+2,,AUTO
         5 001367   000716 701000 5                  TSX1    ARG_ERROR
         5 001370   000000 011000                    NOP     0

      751     8212    2           K=K+1;

   8212  5 001371   000004 054000 1                  AOS     K

      752     8213    2           END;

   8213  5 001372   000004 236000 1                  LDQ     K
         5 001373   000012 116000 1                  CMPQ    NO_ARGS
         5 001374   001314 604000 5                  TMI     s:8196

      753     8214    1       RETAIN_SWITCH=%ON;

   8214  5 001375   000001 235007                    LDA     1,DL
         5 001376   000353 755000 1                  STA     RETAIN_SWITCH

      754     8215    1       RETURN;

   8215  5 001377   000000 702200 xent               TSX2  ! X66_ARET

      755     8216
      756     8217    1   IDSSET: ENTRY(A1,A2);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:128  
   8217  5 001400   000000 700200 xent  IDSSET       TSX0  ! X66_AUTO_N
         5 001401   000106 000024                    ZERO    70,20

      757     8218
      758     8219    1       PT$=ADDR(A1);

   8219  5 001402   200003 236100                    LDQ     @A1,,AUTO
         5 001403   000010 756000 1                  STQ     PT$

      759     8220    1       K=256;

   8220  5 001404   000400 235007                    LDA     256,DL
         5 001405   000004 755000 1                  STA     K

      760     8221    1       CALL INDEX(I,'SET ',CHAR_V);

   8221  5 001406   000003 631400 1                  EPPR1   I
         5 001407   000001 633400 2                  EPPR3   AUTO$+1
         5 001410   000004 223003                    LDX3    4,DU
         5 001411   000010 470400 1                  LDP0    PT$
         5 001412   000000 620005                    EAX0    0,AL
         5 001413   000000 236003                    LDQ     0,DU
         5 001414   000000 701000 xent               TSX1    X66_INDEX
         5 001415   000000 011000                    NOP     0

      761     8222    1       A2(0)=1;

   8222  5 001416   200004 471500                    LDP1    @A2,,AUTO
         5 001417   000100 100400                    MLR     fill='000'O
         5 001420   000044 000004 6                  ADSC9   36                       cn=0,n=4
         5 001421   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

      762     8223    1       IF I=K THEN RETURN; /* NOT A LEGAL SET COMMAND */

   8223  5 001422   000003 236000 1                  LDQ     I
         5 001423   000004 116000 1                  CMPQ    K
         5 001424   001426 601000 5                  TNZ     s:8224
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:129  

   8223  5 001425   000000 702200 xent               TSX2  ! X66_ARET

      763     8224    1       K=K-I;

   8224  5 001426   000004 236000 1                  LDQ     K
         5 001427   000003 136000 1                  SBLQ    I
         5 001430   000004 756000 1                  STQ     K

      764     8225    1       PT$=PINCRC(PT$,I);

   8225  5 001431   000003 236000 1                  LDQ     I
         5 001432   000020 736000                    QLS     16
         5 001433   000010 036000 1                  ADLQ    PT$
         5 001434   000010 756000 1                  STQ     PT$

      765     8226    1       I=4;

   8226  5 001435   000004 235007                    LDA     4,DL
         5 001436   000003 755000 1                  STA     I

      766     8227    2       DO J=1 TO 2;

   8227  5 001437   000001 235007                    LDA     1,DL
         5 001440   000005 755000 1                  STA     J

      767     8228    3           DO WHILE(SUBSTR(CHAR_V,I,1)=' ' AND I<K);

   8228  5 001441   001443 710000 5                  TRA     s:8230

      768     8229    3               I=I+1;

   8229  5 001442   000003 054000 1                  AOS     I

      769     8230    3               END;

   8230  5 001443   000010 470400 1                  LDP0    PT$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:130  
         5 001444   000003 235000 1                  LDA     I
         5 001445   040000 106505                    CMPC    fill='040'O
         5 001446   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 001447   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 001450   001454 601000 5                  TNZ     s:8231
         5 001451   000003 236000 1                  LDQ     I
         5 001452   000004 116000 1                  CMPQ    K
         5 001453   001442 604000 5                  TMI     s:8229

      770     8231    2           CALL INDEX1(I,' ',CHAR_V,I+1);

   8231  5 001454   000004 236000 1                  LDQ     K
         5 001455   000003 136000 1                  SBLQ    I
         5 001456   777777 620006                    EAX0    -1,QL
         5 001457   000003 236000 1                  LDQ     I
         5 001460   000001 036007                    ADLQ    1,DL
         5 001461   000000 124545                    SCM     mask='000'O
         5 001462   000000 200010                    ADSC9   0,A,PR0                  cn=1,n=*X0
         5 001463   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 001464   000003 000000 1                  ARG     I
         5 001465   000003 056000 1                  ASQ     I

      771     8232    2           END;

   8232  5 001466   000005 054000 1                  AOS     J
         5 001467   000005 235000 1                  LDA     J
         5 001470   000002 115007                    CMPA    2,DL
         5 001471   001441 604400 5                  TMOZ    s:8228

      772     8233    1       IF SUBSTR(CHAR_V,I-1,1)='.' THEN I=I-1;

   8233  5 001472   000003 236000 1                  LDQ     I
         5 001473   040000 106506                    CMPC    fill='040'O
         5 001474   077777 600001                    ADSC9   -1,Q,PR0                 cn=3,n=1
         5 001475   000045 000001 6                  ADSC9   37                       cn=0,n=1
         5 001476   001501 601000 5                  TNZ     s:8234

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:131  
   8233  5 001477   000001 336007                    LCQ     1,DL
         5 001500   000003 056000 1                  ASQ     I

      773     8234    1       K=I;

   8234  5 001501   000003 236000 1                  LDQ     I
         5 001502   000004 756000 1                  STQ     K

      774     8235    1       FPT_YC.CMD_=VECTOR(CHAR_V);

   8235  5 001503   000004 235000 1                  LDA     K
         5 001504   000020 735000                    ALS     16
         5 001505   000140 135007                    SBLA    96,DL
         5 001506   000010 236000 1                  LDQ     PT$
         5 001507   002452 757000 1                  STAQ    FPT_YC

      775     8236    1       CALL M$YC(FPT_YC) ALTRET(YC_ERROR);

   8236  5 001510   002452 630400 1                  EPPR0   FPT_YC
         5 001511   400011 713400                    CLIMB   alt,+9
         5 001512   401000 401760                    pmme    nvectors=3
         5 001513   001521 702000 5                  TSX2    YC_ERROR

      776     8237    1       A2(0)=0; /* NORMAL FLAG */

   8237  5 001514   200004 470500                    LDP0    @A2,,AUTO
         5 001515   000100 100400                    MLR     fill='000'O
         5 001516   000027 000004 6                  ADSC9   23                       cn=0,n=4
         5 001517   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      777     8238    1       RETURN;

   8238  5 001520   000000 702200 xent               TSX2  ! X66_ARET

      778     8239    1   YC_ERROR: A2(0)=ADDR(B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.FCG)->SBIN36;

   8239  5 001521   000000 470400 xsym  YC_ERROR     LDP0    B$TCB$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:132  
         5 001522   000000 471500                    LDP1    0,,PR0
         5 001523   200004 473500                    LDP3    @A2,,AUTO
         5 001524   000100 100500                    MLR     fill='000'O
         5 001525   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         5 001526   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

      779     8240    1       RETURN;

   8240  5 001527   000000 702200 xent               TSX2  ! X66_ARET

      780     8241         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:133  
      781     8242        /**   INTERNAL SUBROUTINE TO SETUP RETAIN CONTROL LIST   **/
      782     8243
      783     8244    1   CHK_RETAIN: PROC(RLCW,OFFSET);

   8244  5 001530   200032 741300       CHK_RETAIN   STX1  ! @B,,AUTO

      784     8245
      785     8246    2   DCL 1 RLCW,
      786     8247    2         2 FLAGS SBIN WORD,
      787     8248    2         2 LISTS (0:0),
      788     8249    2           3 RVA_OFFSET# SBIN HALF UNAL,
      789     8250    2           3 MBZ UBIN HALF UNAL;
      790     8251    2   DCL OFFSET SBIN HALF CALIGNED;
      791     8252
      792     8253    2       IF RETAIN_SWITCH=%OFF THEN

   8253  5 001531   000353 235000 1                  LDA     RETAIN_SWITCH
         5 001532   001536 601000 5                  TNZ     s:8257

      793     8254    2           RLCW.FLAGS=0;

   8254  5 001533   200033 470500                    LDP0    @RLCW,,AUTO
         5 001534   000000 450100                    STZ     0,,PR0
         5 001535   001615 710000 5                  TRA     s:8264

      794     8255    2       ELSE
      795     8256    3       DO;

      796     8257    3           RETAIN_SWITCH=%OFF;

   8257  5 001536   000353 450000 1                  STZ     RETAIN_SWITCH

      797     8258    3           RLCW.FLAGS=ADDR(RLCW_SAVE)->SBIN36;

   8258  5 001537   002375 470400 1                  LDP0    RLCW$
         5 001540   200033 471500                    LDP1    @RLCW,,AUTO
         5 001541   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:134  
         5 001542   100000 755100                    STA     0,,PR1

      798     8259    4           DO II=OFFSET TO RLCW_SAVE.N_SETS#+OFFSET-1;

   8259  5 001543   200034 473500                    LDP3    @OFFSET,,AUTO
         5 001544   000100 100500                    MLR     fill='000'O
         5 001545   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         5 001546   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001547   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001550   000022 732000                    QRS     18
         5 001551   000354 756000 1                  STQ     II
         5 001552   001600 710000 5                  TRA     s:8262+1

      799     8260    4               RLCW.LISTS.RVA_OFFSET#(II)=RLCW_SAVE.RETAIN_LIST(II-OFFSET);

   8260  5 001553   200034 470500                    LDP0    @OFFSET,,AUTO
         5 001554   000100 100500                    MLR     fill='000'O
         5 001555   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 001556   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001557   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001560   000022 732000                    QRS     18
         5 001561   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 001562   000354 236000 1                  LDQ     II
         5 001563   200077 136100                    SBLQ    ERRMSG_BUF+31,,AUTO
         5 001564   000001 736000                    QLS     1
         5 001565   000354 235000 1                  LDA     II
         5 001566   000002 735000                    ALS     2
         5 001567   002375 471400 1                  LDP1    RLCW$
         5 001570   200033 473500                    LDP3    @RLCW,,AUTO
         5 001571   000105 100506                    MLR     fill='000'O
         5 001572   100001 000002                    ADSC9   1,Q,PR1                  cn=0,n=2
         5 001573   300001 000002                    ADSC9   1,A,PR3                  cn=0,n=2

      800     8261    4               RLCW.LISTS.MBZ(II)=0;

   8261  5 001574   000000 220003                    LDX0    0,DU
         5 001575   000354 721000 1                  LXL1    II
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:135  
         5 001576   300001 440111                    SXL0    1,X1,PR3

      801     8262    4               END;

   8262  5 001577   000354 054000 1                  AOS     II
         5 001600   200034 470500                    LDP0    @OFFSET,,AUTO
         5 001601   000100 100500                    MLR     fill='000'O
         5 001602   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 001603   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001604   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001605   000022 732000                    QRS     18
         5 001606   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 001607   002375 471400 1                  LDP1    RLCW$
         5 001610   100000 236100                    LDQ     0,,PR1
         5 001611   000377 376007                    ANQ     255,DL
         5 001612   200077 036100                    ADLQ    ERRMSG_BUF+31,,AUTO
         5 001613   000354 116000 1                  CMPQ    II
         5 001614   001553 605400 5                  TPNZ    s:8260

      802     8263    3           END;

      803     8264    2   END CHK_RETAIN;

   8264  5 001615   200032 221300                    LDX1  ! @B,,AUTO
         5 001616   000001 702211                    TSX2  ! 1,X1

      804     8265         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:136  
      805     8266        /**************************************************************/
      806     8267        /*                                                            */
      807     8268        /*    CALL READY([AREA-1[,AREA-2[,....]],FUN-OPT,[MODE-OPT])  */
      808     8269        /*                                                            */
      809     8270        /*    FUN-OPT: LOAD, UPDATE, OR RETRIEVAL                     */
      810     8271        /*    MODE-OPT: SHAREALL,SHAREANY,NOSHARE, OR SHAREIN.        */
      811     8272        /*                                                            */
      812     8273        /**************************************************************/
      813     8274
      814     8275    1   READY: ENTRY(

   8275  5 001617   000000 700200 xent  READY        TSX0  ! X66_AUTO_N
         5 001620   000106 000024                    ZERO    70,20

      815     8276               %GEN_PARAMS;
      816     8817
      817     8818    1       CALL SET_ARGS;

   8818  5 001621   000535 701000 5                  TSX1    SET_ARGS
         5 001622   000000 011000                    NOP     0

      818     8819        /*E*  ERROR: ZII-25-1
      819     8820              MESSAGE: Syntax error in READY CALL.
      820     8821                       Required option LOAD/UPDATE/RETRIEVAL missing.  */
      821     8822    1       J=2;

   8822  5 001623   000002 235007                    LDA     2,DL
         5 001624   000005 755000 1                  STA     J

      822     8823    1       I=ARG.TYPE(NO_ARGS-1);

   8823  5 001625   002372 470400 1                  LDP0    ARG$
         5 001626   000012 720000 1                  LXL0    NO_ARGS
         5 001627   077777 236110                    LDQ     -1,X0,PR0
         5 001630   777777 376007                    ANQ     -1,DL
         5 001631   000003 756000 1                  STQ     I

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:137  
      823     8824    1       IF I=SNA.NOSHALL THEN

   8824  5 001632   000014 116000 0                  CMPQ    SNA+12
         5 001633   001637 601000 5                  TNZ     s:8840

      824     8825                %CLIMB(FCN=SHNO,PARAMS=0);

   8836  5 001634   000000 713400 xsym               CLIMB   I$SHNO
         5 001635   000000 600000 xsid               climb   nvectors=         0
         5 001636   001672 710000 5                  TRA     s:8922

      825     8839    1       ELSE
      826     8840    1           IF I=SNA.SHAREALL THEN

   8840  5 001637   000026 116000 0                  CMPQ    SNA+22
         5 001640   001644 601000 5                  TNZ     s:8856

      827     8841                    %CLIMB(FCN=SHALL,PARAMS=0);

   8852  5 001641   000000 713400 xsym               CLIMB   I$SHALL
         5 001642   000000 600000 xsid               climb   nvectors=         0
         5 001643   001672 710000 5                  TRA     s:8922

      828     8855    1           ELSE
      829     8856    1               IF I=SNA.SHAREIN THEN

   8856  5 001644   000030 116000 0                  CMPQ    SNA+24
         5 001645   001651 601000 5                  TNZ     s:8872

      830     8857                        %CLIMB(FCN=SHIN,PARAMS=0);

   8868  5 001646   000000 713400 xsym               CLIMB   I$SHIN
         5 001647   000000 600000 xsid               climb   nvectors=         0
         5 001650   001672 710000 5                  TRA     s:8922

      831     8871    1               ELSE
      832     8872    1                   IF I=SNA.SHAREANY THEN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:138  

   8872  5 001651   000027 116000 0                  CMPQ    SNA+23
         5 001652   001656 601000 5                  TNZ     s:8888

      833     8873                            %CLIMB(FCN=SHANY,PARAMS=0);

   8884  5 001653   000000 713400 xsym               CLIMB   I$SHANY
         5 001654   000000 600000 xsid               climb   nvectors=         0
         5 001655   001672 710000 5                  TRA     s:8922

      834     8887    1                   ELSE
      835     8888    1                       IF I=SNA.SHCUR THEN

   8888  5 001656   000034 116000 0                  CMPQ    SNA+28
         5 001657   001663 601000 5                  TNZ     s:8904

      836     8889                                %CLIMB(FCN=SHCUR,PARAMS=0);

   8900  5 001660   000000 713400 xsym               CLIMB   I$SHCUR
         5 001661   000000 600000 xsid               climb   nvectors=         0
         5 001662   001672 710000 5                  TRA     s:8922

      837     8903    1                       ELSE
      838     8904    1                           IF I=SNA.SHINCUR THEN

   8904  5 001663   000035 116000 0                  CMPQ    SNA+29
         5 001664   001670 601000 5                  TNZ     s:8920

      839     8905                                    %CLIMB(FCN=SHINCUR,PARAMS=0);

   8916  5 001665   000000 713400 xsym               CLIMB   I$SHINCUR
         5 001666   000000 600000 xsid               climb   nvectors=         0
         5 001667   001672 710000 5                  TRA     s:8922

      840     8919    1                           ELSE
      841     8920    1                               J=1;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:139  
   8920  5 001670   000001 235007                    LDA     1,DL
         5 001671   000005 755000 1                  STA     J

      842     8921
      843     8922    1       I=ARG.TYPE(NO_ARGS-J);

   8922  5 001672   000012 236000 1                  LDQ     NO_ARGS
         5 001673   000005 136000 1                  SBLQ    J
         5 001674   002372 470400 1                  LDP0    ARG$
         5 001675   000000 236106                    LDQ     0,QL,PR0
         5 001676   777777 376007                    ANQ     -1,DL
         5 001677   000003 756000 1                  STQ     I

      844     8923    1       IF I=SNA.UPDATE THEN

   8923  5 001700   000031 116000 0                  CMPQ    SNA+25
         5 001701   001710 601000 5                  TNZ     s:8926

      845     8924    1           IPT_RDY.V.RDCW.READY_OPTION#='010'B;

   8924  5 001702   002371 471400 1                  LDP1    FPT$
         5 001703   100012 236100                    LDQ     10,,PR1
         5 001704   000046 376000 6                  ANQ     38
         5 001705   000010 276003                    ORQ     8,DU
         5 001706   100012 756100                    STQ     10,,PR1
         5 001707   001734 710000 5                  TRA     s:8936

      846     8925    1       ELSE
      847     8926    1           IF I=SNA.RETRIEVAL THEN

   8926  5 001710   000023 116000 0                  CMPQ    SNA+19
         5 001711   001720 601000 5                  TNZ     s:8929

      848     8927    1               IPT_RDY.V.RDCW.READY_OPTION#='100'B;

   8927  5 001712   002371 471400 1                  LDP1    FPT$
         5 001713   100012 236100                    LDQ     10,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:140  
         5 001714   000046 376000 6                  ANQ     38
         5 001715   000020 276003                    ORQ     16,DU
         5 001716   100012 756100                    STQ     10,,PR1
         5 001717   001734 710000 5                  TRA     s:8936

      849     8928    1           ELSE
      850     8929    1               IF I=SNA.LOAD THEN

   8929  5 001720   000012 116000 0                  CMPQ    SNA+10
         5 001721   001730 601000 5                  TNZ     s:8932

      851     8930    1                   IPT_RDY.V.RDCW.READY_OPTION#='001'B;

   8930  5 001722   002371 471400 1                  LDP1    FPT$
         5 001723   100012 236100                    LDQ     10,,PR1
         5 001724   000046 376000 6                  ANQ     38
         5 001725   000004 276003                    ORQ     4,DU
         5 001726   100012 756100                    STQ     10,,PR1
         5 001727   001734 710000 5                  TRA     s:8936

      852     8931    1               ELSE
      853     8932    1                   CALL ARG_ERROR(25);

   8932  5 001730   000050 236000 6                  LDQ     40
         5 001731   200037 756100                    STQ     @A+2,,AUTO
         5 001732   000716 701000 5                  TSX1    ARG_ERROR
         5 001733   000000 011000                    NOP     0

      854     8933
      855     8934        /*E*  ERROR: ZII-30-1
      856     8935              MESSAGE: Arguments in CALL READY are not all AREA-NAMEs. */
      857     8936    2       DO I=0 TO NO_ARGS-J-1;

   8936  5 001734   000003 450000 1                  STZ     I
         5 001735   001755 710000 5                  TRA     s:8939+1

      858     8937    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(30);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:141  

   8937  5 001736   002372 470400 1                  LDP0    ARG$
         5 001737   000003 720000 1                  LXL0    I
         5 001740   000000 721110                    LXL1    0,X0,PR0
         5 001741   000037 101003                    CMPX1   31,DU
         5 001742   001747 600000 5                  TZE     s:8938

   8937  5 001743   000052 236000 6                  LDQ     42
         5 001744   200037 756100                    STQ     @A+2,,AUTO
         5 001745   000716 701000 5                  TSX1    ARG_ERROR
         5 001746   000000 011000                    NOP     0

      859     8938    2           IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);

   8938  5 001747   002372 470400 1                  LDP0    ARG$
         5 001750   000003 720000 1                  LXL0    I
         5 001751   000000 221110                    LDX1    0,X0,PR0
         5 001752   002371 471400 1                  LDP1    FPT$
         5 001753   100013 741110                    STX1    11,X0,PR1

      860     8939    2           END;

   8939  5 001754   000003 054000 1                  AOS     I
         5 001755   000012 236000 1                  LDQ     NO_ARGS
         5 001756   000005 136000 1                  SBLQ    J
         5 001757   000003 116000 1                  CMPQ    I
         5 001760   001736 605400 5                  TPNZ    s:8937

      861     8940    1       IPT_RDY.V.RDCW.AREAS_TO_READY#=I;

   8940  5 001761   000003 720000 1                  LXL0    I
         5 001762   002371 470400 1                  LDP0    FPT$
         5 001763   000012 440100                    SXL0    10,,PR0

      862     8941    1       IPT_RDY.V_ = VECTOR(IPT_RDY.V);

   8941  5 001764   000012 235000 6                  LDA     10
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:142  
         5 001765   002371 236000 1                  LDQ     FPT$
         5 001766   000012 036003                    ADLQ    10,DU
         5 001767   000000 757100                    STAQ    0,,PR0

      863     8942    1       VBOUND(IPT_RDY.V_) = VBOUND(IPT_RDY.V_) + SIZEC(IPT_RDY.V.AC_OFFSETS) * (I-1);

   8942  5 001770   000000 236100                    LDQ     0,,PR0
         5 001771   000020 772000                    QRL     16
         5 001772   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 001773   000003 236000 1                  LDQ     I
         5 001774   000002 736000                    QLS     2
         5 001775   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 001776   000004 136007                    SBLQ    4,DL
         5 001777   000020 736000                    QLS     16
         5 002000   000000 676100                    ERQ     0,,PR0
         5 002001   000000 376000 6                  ANQ     0
         5 002002   000000 656100                    ERSQ    0,,PR0

      864     8943         /* I computed from previous DO */
      865     8944            %CLIMB(FCN=RDY);

   8952  5 002003   000000 713400 xsym               CLIMB   I$RDY
         5 002004   402000 600000 xsid               climb   nvectors=         5

      866     8958    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);

   8958  5 002005   000000 470400 2                  LDP0    AUTO$
         5 002006   000100 100500                    MLR     fill='000'O
         5 002007   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         5 002010   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002011   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002012   000022 732000                    QRS     18
         5 002013   000002 736000                    QLS     2
         5 002014   000030 676000 6                  ERQ     24
         5 002015   000001 036007                    ADLQ    1,DL
         5 002016   000100 100506                    MLR     fill='000'O
         5 002017   077777 400002                    ADSC9   -1,Q,PR0                 cn=2,n=2
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:143  
         5 002020   200077 000004                    ADSC9   ERRMSG_BUF+31,,AUTO      cn=0,n=4
         5 002021   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 002022   000022 732000                    QRS     18
         5 002023   000030 676000 6                  ERQ     24
         5 002024   000000 620006                    EAX0    0,QL
         5 002025   000006 740000 1                  STX0    DEADLOCK_RET

      867     8959    2       DO WHILE (IA_HALF(15)>0);

   8959  5 002026   002366 471400 1                  LDP1    IA$
         5 002027   000100 101500                    MRL     fill='000'O
         5 002030   100007 400002                    ADSC9   7,,PR1                   cn=2,n=2
         5 002031   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002032   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002033   000000 116003                    CMPQ    0,DU
         5 002034   002065 600000 5                  TZE     s:8979

      868     8960    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */

   8960  5 002035   002366 470400 1                  LDP0    IA$
         5 002036   000000 100500                    MLR     fill='000'O
         5 002037   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2
         5 002040   000010 000002 1                  ADSC9   PT$                      cn=0,n=2

      869     8961    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */

   8961  5 002041   006000 220003                    LDX0    3072,DU
         5 002042   000010 440000 1                  SXL0    PT$

      870     8962    2           CALL EPTR$;

   8962  5 002043   000010 221000 1                  LDX1    PT$
         5 002044   000027 631400 6                  EPPR1   23
         5 002045   000000 701011                    TSX1    0,X1
         5 002046   000000 011000                    NOP     0

      871     8963    2           IPT_ETC.V_ = VECTOR(IPT_ETC.V);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:144  

   8963  5 002047   000012 235000 6                  LDA     10
         5 002050   002371 236000 1                  LDQ     FPT$
         5 002051   000012 036003                    ADLQ    10,DU
         5 002052   002371 470400 1                  LDP0    FPT$
         5 002053   000000 757100                    STAQ    0,,PR0

      872     8964                %CLIMB(FCN=ETC);

   8972  5 002054   000000 713400 xsym               CLIMB   I$ETC
         5 002055   402000 600000 xsid               climb   nvectors=         5

      873     8978    2           END;

   8978  5 002056   002366 470400 1                  LDP0    IA$
         5 002057   000100 101500                    MRL     fill='000'O
         5 002060   000007 400002                    ADSC9   7,,PR0                   cn=2,n=2
         5 002061   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002062   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002063   000000 116003                    CMPQ    0,DU
         5 002064   002035 601000 5                  TNZ     s:8960

      874     8979    1       RETAIN_SWITCH=%OFF; /* RESET RETAIN CONTROL FLAG */

   8979  5 002065   000353 450000 1                  STZ     RETAIN_SWITCH

      875     8980    1       GOTO COMMON_RETURN;

   8980  5 002066   005017 710000 5                  TRA     COMMON_RETURN

      876     8981         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:145  
      877     8982        /**************************************************************/
      878     8983        /*                                                            */
      879     8984        /*    CALL FINISH([AREA-1,[AREA-2,....,],])                   */
      880     8985        /*                                                            */
      881     8986        /**************************************************************/
      882     8987    1   FINISH: ENTRY(

   8987  5 002067   000000 700200 xent  FINISH       TSX0  ! X66_AUTO_N
         5 002070   000106 000024                    ZERO    70,20

      883     8988               %GEN_PARAMS;
      884     9529
      885     9530    1       CALL SET_ARGS;

   9530  5 002071   000535 701000 5                  TSX1    SET_ARGS
         5 002072   000000 011000                    NOP     0

      886     9531        /*E*  ERROR: ZII-35-1
      887     9532              MESSAGE: Arguments in CALL FINISH are not all AREA-NAMES. */
      888     9533    2       DO I=0 TO NO_ARGS-1;

   9533  5 002073   000003 450000 1                  STZ     I
         5 002074   002114 710000 5                  TRA     s:9536+1

      889     9534    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(35);

   9534  5 002075   002372 470400 1                  LDP0    ARG$
         5 002076   000003 720000 1                  LXL0    I
         5 002077   000000 721110                    LXL1    0,X0,PR0
         5 002100   000037 101003                    CMPX1   31,DU
         5 002101   002106 600000 5                  TZE     s:9535

   9534  5 002102   000054 236000 6                  LDQ     44
         5 002103   200037 756100                    STQ     @A+2,,AUTO
         5 002104   000716 701000 5                  TSX1    ARG_ERROR
         5 002105   000000 011000                    NOP     0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:146  
      890     9535    2           IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);

   9535  5 002106   002372 470400 1                  LDP0    ARG$
         5 002107   000003 720000 1                  LXL0    I
         5 002110   000000 221110                    LDX1    0,X0,PR0
         5 002111   002371 471400 1                  LDP1    FPT$
         5 002112   100013 741110                    STX1    11,X0,PR1

      891     9536    2           END;

   9536  5 002113   000003 054000 1                  AOS     I
         5 002114   000003 236000 1                  LDQ     I
         5 002115   000012 116000 1                  CMPQ    NO_ARGS
         5 002116   002075 604000 5                  TMI     s:9534

      892     9537    1       IPT_FIN.V.ALCW.N_AREAS#=I;

   9537  5 002117   000000 620006                    EAX0    0,QL
         5 002120   002371 470400 1                  LDP0    FPT$
         5 002121   000012 740100                    STX0    10,,PR0

      893     9538    1       IPT_FIN.V_ = VECTOR(IPT_FIN.V);

   9538  5 002122   000012 235000 6                  LDA     10
         5 002123   002371 236000 1                  LDQ     FPT$
         5 002124   000012 036003                    ADLQ    10,DU
         5 002125   000000 757100                    STAQ    0,,PR0

      894     9539    1       VBOUND(IPT_FIN.V_) = VBOUND(IPT_FIN.V_) + SIZEC(IPT_FIN.V.AC_OFFSETS) * (I-1);

   9539  5 002126   000000 236100                    LDQ     0,,PR0
         5 002127   000020 772000                    QRL     16
         5 002130   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 002131   000003 236000 1                  LDQ     I
         5 002132   000002 736000                    QLS     2
         5 002133   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 002134   000004 136007                    SBLQ    4,DL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:147  
         5 002135   000020 736000                    QLS     16
         5 002136   000000 676100                    ERQ     0,,PR0
         5 002137   000000 376000 6                  ANQ     0
         5 002140   000000 656100                    ERSQ    0,,PR0

      895     9540         /* I computed from previous DO */
      896     9541            %CLIMB(FCN=FIN);

   9549  5 002141   000000 713400 xsym               CLIMB   I$FIN
         5 002142   402000 600000 xsid               climb   nvectors=         5

      897     9555    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);

   9555  5 002143   000000 470400 2                  LDP0    AUTO$
         5 002144   000100 100500                    MLR     fill='000'O
         5 002145   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         5 002146   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002147   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002150   000022 732000                    QRS     18
         5 002151   000002 736000                    QLS     2
         5 002152   000030 676000 6                  ERQ     24
         5 002153   000001 036007                    ADLQ    1,DL
         5 002154   000100 100506                    MLR     fill='000'O
         5 002155   077777 400002                    ADSC9   -1,Q,PR0                 cn=2,n=2
         5 002156   200077 000004                    ADSC9   ERRMSG_BUF+31,,AUTO      cn=0,n=4
         5 002157   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 002160   000022 732000                    QRS     18
         5 002161   000030 676000 6                  ERQ     24
         5 002162   000000 620006                    EAX0    0,QL
         5 002163   000006 740000 1                  STX0    DEADLOCK_RET

      898     9556    1       GOTO COMMON_RETURN;

   9556  5 002164   005017 710000 5                  TRA     COMMON_RETURN

      899     9557
      900     9558    1   CALC: ENTRY(A1,A2);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:148  

   9558  5 002165   000000 700200 xent  CALC         TSX0  ! X66_AUTO_N
         5 002166   000106 000024                    ZERO    70,20

      901     9559
      902     9560    1       CALL SET_ARGS1;

   9560  5 002167   000557 701000 5                  TSX1    SET_ARGS1
         5 002170   000000 011000                    NOP     0

      903     9561    1       IF NO_ARGS~=2 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(37);

   9561  5 002171   000012 235000 1                  LDA     NO_ARGS
         5 002172   000002 115007                    CMPA    2,DL
         5 002173   002200 601000 5                  TNZ     s:9561+7
         5 002174   002372 470400 1                  LDP0    ARG$
         5 002175   000000 720100                    LXL0    0,,PR0
         5 002176   000041 100003                    CMPX0   33,DU
         5 002177   002204 600000 5                  TZE     s:9565

   9561  5 002200   000056 236000 6                  LDQ     46
         5 002201   200037 756100                    STQ     @A+2,,AUTO
         5 002202   000716 701000 5                  TSX1    ARG_ERROR
         5 002203   000000 011000                    NOP     0

      904     9562        /*E*  ERROR: ZII-37-1
      905     9563              MESSAGE: Argument count error, or the 1st argument is not
      906     9564                       a RECORD-NAME in CALL CALC. */
      907     9565    1       IPT_CALC.V_=VECTOR(IPT_CALC.V);

   9565  5 002204   000012 235000 6                  LDA     10
         5 002205   002371 236000 1                  LDQ     FPT$
         5 002206   000014 036003                    ADLQ    12,DU
         5 002207   002371 470400 1                  LDP0    FPT$
         5 002210   000000 757100                    STAQ    0,,PR0

      908     9566    1       IPT_CALC.DBK_=VECTOR(A2(0));
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:149  

   9566  5 002211   777640 235007                    LDA     -96,DL
         5 002212   200004 236100                    LDQ     @A2,,AUTO
         5 002213   000012 757100                    STAQ    10,,PR0

      909     9567    1       IPT_CALC.V.UWA_OFFSET=RVA_HALF(ARG.OFFSET(0)*2+1)/8;

   9567  5 002214   002372 471400 1                  LDP1    ARG$
         5 002215   100000 236100                    LDQ     0,,PR1
         5 002216   000022 772000                    QRL     18
         5 002217   000002 736000                    QLS     2
         5 002220   002370 473400 1                  LDP3    RVA$
         5 002221   000100 101506                    MRL     fill='000'O
         5 002222   300000 400002                    ADSC9   0,Q,PR3                  cn=2,n=2
         5 002223   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002224   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002225   000003 772000                    QRL     3
         5 002226   000014 756100                    STQ     12,,PR0

      910     9568            %CLIMB(FCN=CALC);

   9576  5 002227   000000 713400 xsym               CLIMB   I$CALC
         5 002230   402400 600000 xsid               climb   nvectors=         6

      911     9582    1       IPT_CALC.V_=VECTOR(FPTS.V);

   9582  5 002231   000034 235000 6                  LDA     28
         5 002232   002371 236000 1                  LDQ     FPT$
         5 002233   000012 036003                    ADLQ    10,DU
         5 002234   002371 470400 1                  LDP0    FPT$
         5 002235   000000 757100                    STAQ    0,,PR0

      912     9583    1       RETURN;

   9583  5 002236   000000 702200 xent               TSX2  ! X66_ARET

      913     9584         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:150  
      914     9585    1   ACCEPT: ENTRY(A1,A2,A3);

   9585  5 002237   000000 700200 xent  ACCEPT       TSX0  ! X66_AUTO_N
         5 002240   000106 000024                    ZERO    70,20

      915     9586
      916     9587    1       CALL SET_ARGS;

   9587  5 002241   000535 701000 5                  TSX1    SET_ARGS
         5 002242   000000 011000                    NOP     0

      917     9588        /*****************************************************************/
      918     9589        /*                                                               */
      919     9590        /*    CALL ACCEPT(IDENT-1,[REC-NAME],AREANAME)                   */
      920     9591        /*                                   SET-NAME                    */
      921     9592        /*                                   IDENT-2                     */
      922     9593        /*         IDENT-1: LOCATION TO RECEIVE THE AREA'S TEXT NAME     */
      923     9594        /*         IDENT-2: LOCATION CONTAINS A DBKEY TO IDENT THE AREA  */
      924     9595        /*                                                               */
      925     9596        /*****************************************************************/
      926     9597    1       IF ARG.TYPE(NO_ARGS-1)=SNA.AREANAME THEN

   9597  5 002243   002372 470400 1                  LDP0    ARG$
         5 002244   000012 720000 1                  LXL0    NO_ARGS
         5 002245   077777 236110                    LDQ     -1,X0,PR0
         5 002246   777777 376007                    ANQ     -1,DL
         5 002247   000021 116000 0                  CMPQ    SNA+17
         5 002250   002331 601000 5                  TNZ     s:9642

      927     9598    2       DO;

      928     9599    2           IPT_ACN.DBK_=VECTOR(NIL);

   9599  5 002251   000014 237000 6                  LDAQ    12
         5 002252   002371 471400 1                  LDP1    FPT$
         5 002253   100014 757100                    STAQ    12,,PR1

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:151  
      929     9600    2           IPT_ACN.ANAME_=VECTOR(ADDR(A1)->ANAME_);

   9600  5 002254   000006 235000 6                  LDA     6
         5 002255   200003 236100                    LDQ     @A1,,AUTO
         5 002256   100012 757100                    STAQ    10,,PR1

      930     9601    3           DO CASE(ARG.TYPE(1)-%AREA_NAME);

   9601  5 002257   000001 236100                    LDQ     1,,PR0
         5 002260   777777 376007                    ANQ     -1,DL
         5 002261   000037 136007                    SBLQ    31,DL
         5 002262   000003 116007                    CMPQ    3,DL
         5 002263   002265 602006 5                  TNC     s:9601+6,QL
         5 002264   002302 710000 5                  TRA     s:9610
         5 002265   002302 710000 5                  TRA     s:9610
         5 002266   002275 710000 5                  TRA     s:9607
         5 002267   002270 710000 5                  TRA     s:9604

      931     9602
      932     9603    3           CASE(%RECORD_NAME_NET);

      933     9604    3               IPT_ACN.V.NCW.CI#=1;

   9604  5 002270   000001 221003                    LDX1    1,DU
         5 002271   100016 741100                    STX1    14,,PR1

      934     9605    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);

   9605  5 002272   000001 222100                    LDX2    1,,PR0
         5 002273   100020 742100                    STX2    16,,PR1
         5 002274   002317 710000 5                  TRA     s:9615

      935     9606    3           CASE(%SET_NAME_NET);

      936     9607    3               IPT_ACN.V.NCW.CI#=3;

   9607  5 002275   000003 221003                    LDX1    3,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:152  
         5 002276   100016 741100                    STX1    14,,PR1

      937     9608    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);

   9608  5 002277   000001 222100                    LDX2    1,,PR0
         5 002300   100020 742100                    STX2    16,,PR1
         5 002301   002317 710000 5                  TRA     s:9615

      938     9609    3           CASE(ELSE);

      939     9610    3               IPT_ACN.V.RVA_ITEM.OFFSET#=NULL_OFFSET;

   9610  5 002302   002365 721000 1                  LXL1    NULL_OFFSET
         5 002303   100020 741100                    STX1    16,,PR1

      940     9611    3               IF NO_ARGS=3 THEN IPT_ACN.V.NCW.CI#=2;

   9611  5 002304   000012 236000 1                  LDQ     NO_ARGS
         5 002305   000003 116007                    CMPQ    3,DL
         5 002306   002312 601000 5                  TNZ     s:9612

   9611  5 002307   000002 222003                    LDX2    2,DU
         5 002310   100016 742100                    STX2    14,,PR1
         5 002311   002314 710000 5                  TRA     s:9613

      941     9612    3               ELSE IPT_ACN.V.NCW.CI#=0;

   9612  5 002312   000000 222003                    LDX2    0,DU
         5 002313   100016 742100                    STX2    14,,PR1

      942     9613    3               IPT_ACN.DBK_=VECTOR(A2(0));

   9613  5 002314   777640 235007                    LDA     -96,DL
         5 002315   200004 236100                    LDQ     @A2,,AUTO
         5 002316   100014 757100                    STAQ    12,,PR1

      943     9614    3               END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:153  

      944     9615    2           IPT_ACN.V.NCW.AREA_NME_SIZE#=30;

   9615  5 002317   000036 221003                    LDX1    30,DU
         5 002320   100016 441100                    SXL1    14,,PR1

      945     9616    2           IPT_ACN.V_=VECTOR(IPT_ACN.V);

   9616  5 002321   000057 235000 6                  LDA     47
         5 002322   002371 236000 1                  LDQ     FPT$
         5 002323   000016 036003                    ADLQ    14,DU
         5 002324   100000 757100                    STAQ    0,,PR1

      946     9617                %CLIMB(FCN=ACN);

   9625  5 002325   100000 630500                    EPPR0   0,,PR1
         5 002326   000000 713400 xsym               CLIMB   I$ACN
         5 002327   403000 600000 xsid               climb   nvectors=         7

      947     9631    2           END;

   9631  5 002330   002501 710000 5                  TRA     s:9717

      948     9632    1       ELSE
      949     9633        /****************************************************************/
      950     9634        /*                                                              */
      951     9635        /*    CALL ACCEPT(IDENTIFIER,[REC-NAME],CURRENCY)               */
      952     9636        /*                            SET-NAME  NEXT                    */
      953     9637        /*                            AREA-NAME PRIOR                   */
      954     9638        /*                                      OWNER                   */
      955     9639        /*                                                              */
      956     9640        /****************************************************************/
      957     9641    2       DO;

      958     9642    2           IPT_ACC.DBK_=VECTOR(A1(0));

   9642  5 002331   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:154  
         5 002332   200003 236100                    LDQ     @A1,,AUTO
         5 002333   002371 471400 1                  LDP1    FPT$
         5 002334   100012 757100                    STAQ    10,,PR1

      959     9643    3           DO CASE(NO_ARGS);

   9643  5 002335   000012 235000 1                  LDA     NO_ARGS
         5 002336   000004 115007                    CMPA    4,DL
         5 002337   002341 602005 5                  TNC     s:9643+4,AL
         5 002340   002466 710000 5                  TRA     s:9685
         5 002341   002466 710000 5                  TRA     s:9685
         5 002342   002466 710000 5                  TRA     s:9685
         5 002343   002345 710000 5                  TRA     s:9646
         5 002344   002363 710000 5                  TRA     s:9654

      960     9644
      961     9645    3           CASE(2);

      962     9646    3               IF ARG.TYPE(1)~=SNA.CURRENCY THEN CALL ARG_ERROR(40);

   9646  5 002345   000001 236100                    LDQ     1,,PR0
         5 002346   777777 376007                    ANQ     -1,DL
         5 002347   000002 116000 0                  CMPQ    SNA+2
         5 002350   002355 600000 5                  TZE     s:9651

   9646  5 002351   000061 236000 6                  LDQ     49
         5 002352   200037 756100                    STQ     @A+2,,AUTO
         5 002353   000716 701000 5                  TSX1    ARG_ERROR
         5 002354   000000 011000                    NOP     0

      963     9647        /*E* ERROR: ZII-40-1
      964     9648              MESSAGE: Bad 2nd argument in ACCEPT CALL.
      965     9649                       The correct syntax is
      966     9650                       CALL ACCEPT(RETURNED-IDENTIFIER,CURRENCY)  */
      967     9651    3               IPT_ACC.V.RVA_ITEM.OFFSET#=NULL_OFFSET;

   9651  5 002355   002365 720000 1                  LXL0    NULL_OFFSET
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:155  
         5 002356   002371 470400 1                  LDP0    FPT$
         5 002357   000016 740100                    STX0    14,,PR0

      968     9652    3               IPT_ACC.V.CCW.SCI#=0;

   9652  5 002360   000000 221003                    LDX1    0,DU
         5 002361   000014 741100                    STX1    12,,PR0
         5 002362   002472 710000 5                  TRA     s:9701

      969     9653    3           CASE(3);

      970     9654    3               IPT_ACC.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);

   9654  5 002363   000001 221100                    LDX1    1,,PR0
         5 002364   100016 741100                    STX1    14,,PR1

      971     9655    4               DO CASE(ARG.TYPE(1)-%AREA_NAME);

   9655  5 002365   000001 236100                    LDQ     1,,PR0
         5 002366   777777 376007                    ANQ     -1,DL
         5 002367   000037 136007                    SBLQ    31,DL
         5 002370   000003 116007                    CMPQ    3,DL
         5 002371   002373 602006 5                  TNC     s:9655+6,QL
         5 002372   002461 710000 5                  TRA     s:9682
         5 002373   002412 710000 5                  TRA     s:9663
         5 002374   002426 710000 5                  TRA     s:9668
         5 002375   002376 710000 5                  TRA     s:9658

      972     9656
      973     9657    4               CASE(%RECORD_NAME_NET);

      974     9658    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN

   9658  5 002376   000002 236100                    LDQ     2,,PR0
         5 002377   777777 376007                    ANQ     -1,DL
         5 002400   000002 116000 0                  CMPQ    SNA+2
         5 002401   002405 601000 5                  TNZ     s:9661
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:156  

      975     9659    4                       IPT_ACC.V.CCW.SCI#=1;

   9659  5 002402   000001 222003                    LDX2    1,DU
         5 002403   100014 742100                    STX2    12,,PR1
         5 002404   002472 710000 5                  TRA     s:9701

      976     9660    4                   ELSE
      977     9661    4                       CALL ARG_ERROR(41);

   9661  5 002405   000063 236000 6                  LDQ     51
         5 002406   200037 756100                    STQ     @A+2,,AUTO
         5 002407   000716 701000 5                  TSX1    ARG_ERROR
         5 002410   000000 011000                    NOP     0
         5 002411   002472 710000 5                  TRA     s:9701

      978     9662    4               CASE(%AREA_NAME_NET);

      979     9663    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN

   9663  5 002412   000002 236100                    LDQ     2,,PR0
         5 002413   777777 376007                    ANQ     -1,DL
         5 002414   000002 116000 0                  CMPQ    SNA+2
         5 002415   002421 601000 5                  TNZ     s:9666

      980     9664    4                       IPT_ACC.V.CCW.SCI#=2;

   9664  5 002416   000002 222003                    LDX2    2,DU
         5 002417   100014 742100                    STX2    12,,PR1
         5 002420   002472 710000 5                  TRA     s:9701

      981     9665    4                   ELSE
      982     9666    4                       CALL ARG_ERROR(41);

   9666  5 002421   000063 236000 6                  LDQ     51
         5 002422   200037 756100                    STQ     @A+2,,AUTO
         5 002423   000716 701000 5                  TSX1    ARG_ERROR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:157  
         5 002424   000000 011000                    NOP     0
         5 002425   002472 710000 5                  TRA     s:9701

      983     9667    4               CASE(%SET_NAME_NET);

      984     9668    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN

   9668  5 002426   000002 236100                    LDQ     2,,PR0
         5 002427   777777 376007                    ANQ     -1,DL
         5 002430   000002 116000 0                  CMPQ    SNA+2
         5 002431   002435 601000 5                  TNZ     s:9671

      985     9669    4                       IPT_ACC.V.CCW.SCI#=3;

   9669  5 002432   000003 222003                    LDX2    3,DU
         5 002433   100014 742100                    STX2    12,,PR1
         5 002434   002472 710000 5                  TRA     s:9701

      986     9670    4                   ELSE
      987     9671    4                       IF ARG.TYPE(2)=SNA.NEXT THEN

   9671  5 002435   000013 116000 0                  CMPQ    SNA+11
         5 002436   002442 601000 5                  TNZ     s:9674

      988     9672    4                           IPT_ACC.V.CCW.SCI#=4;

   9672  5 002437   000004 222003                    LDX2    4,DU
         5 002440   100014 742100                    STX2    12,,PR1
         5 002441   002472 710000 5                  TRA     s:9701

      989     9673    4                       ELSE
      990     9674    4                           IF ARG.TYPE(2)=SNA.PRIOR THEN

   9674  5 002442   000017 116000 0                  CMPQ    SNA+15
         5 002443   002447 601000 5                  TNZ     s:9677

      991     9675    4                               IPT_ACC.V.CCW.SCI#=5;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:158  

   9675  5 002444   000005 222003                    LDX2    5,DU
         5 002445   100014 742100                    STX2    12,,PR1
         5 002446   002472 710000 5                  TRA     s:9701

      992     9676    4                           ELSE
      993     9677    4                               IF ARG.TYPE(2)=SNA.OWNER THEN

   9677  5 002447   000016 116000 0                  CMPQ    SNA+14
         5 002450   002454 601000 5                  TNZ     s:9680

      994     9678    4                                   IPT_ACC.V.CCW.SCI#=6;

   9678  5 002451   000006 222003                    LDX2    6,DU
         5 002452   100014 742100                    STX2    12,,PR1
         5 002453   002472 710000 5                  TRA     s:9701

      995     9679    4                               ELSE
      996     9680    4                                   CALL ARG_ERROR(43);

   9680  5 002454   000065 236000 6                  LDQ     53
         5 002455   200037 756100                    STQ     @A+2,,AUTO
         5 002456   000716 701000 5                  TSX1    ARG_ERROR
         5 002457   000000 011000                    NOP     0
         5 002460   002472 710000 5                  TRA     s:9701

      997     9681    4               CASE(ELSE);

      998     9682    4                   CALL ARG_ERROR(44);

   9682  5 002461   000067 236000 6                  LDQ     55
         5 002462   200037 756100                    STQ     @A+2,,AUTO
         5 002463   000716 701000 5                  TSX1    ARG_ERROR
         5 002464   000000 011000                    NOP     0

      999     9683    4                   END;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:159  
   9683  5 002465   002472 710000 5                  TRA     s:9701

     1000     9684    3           CASE(ELSE);

     1001     9685    3               CALL ARG_ERROR(45);

   9685  5 002466   000071 236000 6                  LDQ     57
         5 002467   200037 756100                    STQ     @A+2,,AUTO
         5 002470   000716 701000 5                  TSX1    ARG_ERROR
         5 002471   000000 011000                    NOP     0

     1002     9686    3               END;

     1003     9687
     1004     9688        /*E*  ERROR: ZII-41-1
     1005     9689              MESSAGE: Bad 3rd argument in ACCEPT CALL.
     1006     9690                       The correct syntax is
     1007     9691                       CALL ACCEPT(RETURN-VARIABLE,RECORD-NAME/AREA-NAME,CURRENCY) */
     1008     9692        /*E*  ERROR: ZII-43-1
     1009     9693              MESSAGE: Required keyword CURRENCY/NEXT/PRIOR/OWNER missing
     1010     9694                       in ACCEPT CALL with 2nd argument a SET-NAME.  */
     1011     9695        /*E*  ERROR: ZII-44-1
     1012     9696              MESSAGE: Bad 2nd argument in ACCEPT CALL.
     1013     9697                       Must be a RECORD-NAME/SET-NAME/AREA-NAME.  */
     1014     9698        /*E*  ERROR: ZII-45-1
     1015     9699              MESSAGE: Number of arguments passed to ACCEPT CALL is less than 2.  */
     1016     9700
     1017     9701    2           IPT_ACC.V_=VECTOR(IPT_ACC.V);

   9701  5 002472   000057 235000 6                  LDA     47
         5 002473   002371 236000 1                  LDQ     FPT$
         5 002474   000014 036003                    ADLQ    12,DU
         5 002475   002371 470400 1                  LDP0    FPT$
         5 002476   000000 757100                    STAQ    0,,PR0

     1018     9702                %CLIMB(FCN=ACC);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:160  
   9710  5 002477   000000 713400 xsym               CLIMB   I$ACC
         5 002500   402400 600000 xsid               climb   nvectors=         6

     1019     9716    2           END;

     1020     9717    1       FPTS.V_=VECTOR(FPTS.V);

   9717  5 002501   000034 235000 6                  LDA     28
         5 002502   002371 236000 1                  LDQ     FPT$
         5 002503   000012 036003                    ADLQ    10,DU
         5 002504   002371 470400 1                  LDP0    FPT$
         5 002505   000000 757100                    STAQ    0,,PR0

     1021     9718    1       GOTO COMMON_RETURN;

   9718  5 002506   005017 710000 5                  TRA     COMMON_RETURN

     1022     9719         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:161  
     1023     9720    1   STORE: ENTRY(A1);

   9720  5 002507   000000 700200 xent  STORE        TSX0  ! X66_AUTO_N
         5 002510   000106 000024                    ZERO    70,20

     1024     9721
     1025     9722        /*E*  ERROR: ZII-50-1
     1026     9723              MESSAGE: The argument in STORE CALL is not a RECORD-NAME. */
     1027     9724    1       CALL SET_ARGS;

   9724  5 002511   000535 701000 5                  TSX1    SET_ARGS
         5 002512   000000 011000                    NOP     0

     1028     9725    1       IF NO_ARGS~=1 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(50);

   9725  5 002513   000012 235000 1                  LDA     NO_ARGS
         5 002514   000001 115007                    CMPA    1,DL
         5 002515   002522 601000 5                  TNZ     s:9725+7
         5 002516   002372 470400 1                  LDP0    ARG$
         5 002517   000000 720100                    LXL0    0,,PR0
         5 002520   000041 100003                    CMPX0   33,DU
         5 002521   002526 600000 5                  TZE     s:9726

   9725  5 002522   000073 236000 6                  LDQ     59
         5 002523   200037 756100                    STQ     @A+2,,AUTO
         5 002524   000716 701000 5                  TSX1    ARG_ERROR
         5 002525   000000 011000                    NOP     0

     1029     9726    1       IPT_STO.V.RC.RC_OFFSET#=ARG.OFFSET(0);

   9726  5 002526   002372 470400 1                  LDP0    ARG$
         5 002527   000000 220100                    LDX0    0,,PR0
         5 002530   002371 471400 1                  LDP1    FPT$
         5 002531   100012 740100                    STX0    10,,PR1

     1030     9727    1       IPT_STO.V_ = VECTOR(IPT_STO.V);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:162  
   9727  5 002532   000057 235000 6                  LDA     47
         5 002533   002371 236000 1                  LDQ     FPT$
         5 002534   000012 036003                    ADLQ    10,DU
         5 002535   100000 757100                    STAQ    0,,PR1

     1031     9728    1       CALL CHK_RETAIN(IPT_STO.V.RLCW,0);

   9728  5 002536   000074 236000 6                  LDQ     60
         5 002537   200034 756100                    STQ     @RLCW+1,,AUTO
         5 002540   002371 236000 1                  LDQ     FPT$
         5 002541   000013 036003                    ADLQ    11,DU
         5 002542   200033 756100                    STQ     @B+1,,AUTO
         5 002543   001530 701000 5                  TSX1    CHK_RETAIN
         5 002544   000000 011000                    NOP     0

     1032     9729            %CLIMB(FCN=STO);

   9737  5 002545   002371 470400 1                  LDP0    FPT$
         5 002546   000000 713400 xsym               CLIMB   I$STO
         5 002547   402000 600000 xsid               climb   nvectors=         5

     1033     9743    1       GOTO COMMON_RETURN;

   9743  5 002550   005017 710000 5                  TRA     COMMON_RETURN

     1034     9744
     1035     9745    1   CHECK: ENTRY(A1,A2);

   9745  5 002551   000000 700200 xent  CHECK        TSX0  ! X66_AUTO_N
         5 002552   000106 000024                    ZERO    70,20

     1036     9746
     1037     9747    1       CALL SET_ARGS;

   9747  5 002553   000535 701000 5                  TSX1    SET_ARGS
         5 002554   000000 011000                    NOP     0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:163  
     1038     9748    1       IF NO_ARGS=0 OR NO_ARGS>2 THEN

   9748  5 002555   000012 235000 1                  LDA     NO_ARGS
         5 002556   002561 600000 5                  TZE     s:9749
         5 002557   000002 115007                    CMPA    2,DL
         5 002560   002565 604400 5                  TMOZ    s:9750

     1039     9749    1           CALL ARG_ERROR(53);

   9749  5 002561   000076 236000 6                  LDQ     62
         5 002562   200037 756100                    STQ     @A+2,,AUTO
         5 002563   000716 701000 5                  TSX1    ARG_ERROR
         5 002564   000000 011000                    NOP     0

     1040     9750    1       IPT_CHK.CHKPT_NUMBER_=VECTOR(A1(0));

   9750  5 002565   777640 235007                    LDA     -96,DL
         5 002566   200003 236100                    LDQ     @A1,,AUTO
         5 002567   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 002570   000004 757100                    STAQ    4,,PR0

     1041     9751        /*E*  ERROR: ZII-53-1
     1042     9752              MESSAGE: Argument count error in CHECK CALL.
     1043     9753                       The correct format is
     1044     9754                       CALL CHECK(checkpoint-number [,returned-status]) */
     1045     9755    1       IF ADDR(A2)=ADDR(NIL) THEN

   9755  5 002571   200004 236100                    LDQ     @A2,,AUTO
         5 002572   000015 116000 6                  CMPQ    13
         5 002573   002601 601000 5                  TNZ     s:9758

     1046     9756    1           IPT_CHK.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);

   9756  5 002574   000012 235000 6                  LDA     10
         5 002575   002367 236000 1                  LDQ     UWA$
         5 002576   000001 036003                    ADLQ    1,DU
         5 002577   000000 757100                    STAQ    0,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:164  
         5 002600   002603 710000 5                  TRA     s:9759

     1047     9757    1       ELSE
     1048     9758    1           IPT_CHK.ERROR_=VECTOR(ADDR(A2)->CHAR7);

   9758  5 002601   000012 235000 6                  LDA     10
         5 002602   000000 757100                    STAQ    0,,PR0

     1049     9759    1       IPT_CHK.IA_=FPTS.IA_;

   9759  5 002603   002371 471400 1                  LDP1    FPT$
         5 002604   100002 237100                    LDAQ    2,,PR1
         5 002605   000002 757100                    STAQ    2,,PR0

     1050     9760            %CLIMB(FCN=CHK);

   9768  5 002606   000000 713400 xsym               CLIMB   I$CHK
         5 002607   401000 600000 xsid               climb   nvectors=         3

     1051     9774    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);

   9774  5 002610   000000 470400 2                  LDP0    AUTO$
         5 002611   000100 100500                    MLR     fill='000'O
         5 002612   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         5 002613   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002614   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002615   000022 732000                    QRS     18
         5 002616   000002 736000                    QLS     2
         5 002617   000030 676000 6                  ERQ     24
         5 002620   000001 036007                    ADLQ    1,DL
         5 002621   000100 100506                    MLR     fill='000'O
         5 002622   077777 400002                    ADSC9   -1,Q,PR0                 cn=2,n=2
         5 002623   200077 000004                    ADSC9   ERRMSG_BUF+31,,AUTO      cn=0,n=4
         5 002624   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 002625   000022 732000                    QRS     18
         5 002626   000030 676000 6                  ERQ     24
         5 002627   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:165  
         5 002630   000006 740000 1                  STX0    DEADLOCK_RET

     1052     9775    1       GOTO COMMON_RETURN;

   9775  5 002631   005017 710000 5                  TRA     COMMON_RETURN

     1053     9776         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:166  
     1054     9777    1   ERASER: ENTRY(A1,A2);

   9777  5 002632   000000 700200 xent  ERASER       TSX0  ! X66_AUTO_N
         5 002633   000106 000024                    ZERO    70,20

     1055     9778
     1056     9779        /*E*  ERROR: ZII-55-1
     1057     9780              MESSAGE: Bad arguments found in ERASE CALL.
     1058     9781                       The correct syntax is CALL ERASE([RECORD-NAME][,ALL]). */
     1059     9782    1       CALL SET_ARGS;

   9782  5 002634   000535 701000 5                  TSX1    SET_ARGS
         5 002635   000000 011000                    NOP     0

     1060     9783    1       IPT_ERS.V.RC.RC_OFFSET#=NULL_OFFSET;

   9783  5 002636   002365 720000 1                  LXL0    NULL_OFFSET
         5 002637   002371 470400 1                  LDP0    FPT$
         5 002640   000012 740100                    STX0    10,,PR0

     1061     9784    1       IF NO_ARGS>0 THEN

   9784  5 002641   000012 235000 1                  LDA     NO_ARGS
         5 002642   002673 604400 5                  TMOZ    s:9793

     1062     9785    2       DO;

     1063     9786    2           IF ARG.TYPE(0)=%RECORD_NAME THEN

   9786  5 002643   002372 471400 1                  LDP1    ARG$
         5 002644   100000 721100                    LXL1    0,,PR1
         5 002645   000041 101003                    CMPX1   33,DU
         5 002646   002652 601000 5                  TNZ     s:9788

     1064     9787    2               IPT_ERS.V.RC.RC_OFFSET#=ARG.OFFSET(0);

   9787  5 002647   100000 222100                    LDX2    0,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:167  
         5 002650   000012 742100                    STX2    10,,PR0
         5 002651   002665 710000 5                  TRA     s:9791

     1065     9788    2           ELSE IF ARG.TYPE(0)=SNA.ALL THEN

   9788  5 002652   100000 236100                    LDQ     0,,PR1
         5 002653   777777 376007                    ANQ     -1,DL
         5 002654   000000 116000 0                  CMPQ    SNA
         5 002655   002661 601000 5                  TNZ     s:9790

     1066     9789    2                   IPT_ERS.V.ECW.EC_BIT#='1'B;

   9789  5 002656   400000 236003                    LDQ     -131072,DU
         5 002657   000013 256100                    ORSQ    11,,PR0
         5 002660   002665 710000 5                  TRA     s:9791

     1067     9790    2               ELSE CALL ARG_ERROR(55);

   9790  5 002661   000100 236000 6                  LDQ     64
         5 002662   200037 756100                    STQ     @A+2,,AUTO
         5 002663   000716 701000 5                  TSX1    ARG_ERROR
         5 002664   000000 011000                    NOP     0

     1068     9791    2           IF ADDR(A2)=ADDR(SNA.ALL) THEN IPT_ERS.V.ECW.EC_BIT#='1'B;

   9791  5 002665   000023 236000 6                  LDQ     19
         5 002666   200004 116100                    CMPQ    @A2,,AUTO
         5 002667   002673 601000 5                  TNZ     s:9793

   9791  5 002670   002371 470400 1                  LDP0    FPT$
         5 002671   400000 236003                    LDQ     -131072,DU
         5 002672   000013 256100                    ORSQ    11,,PR0

     1069     9792    2           END;

     1070     9793    1       IPT_ERS.V_ = VECTOR(IPT_ERS.V);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:168  
   9793  5 002673   000012 235000 6                  LDA     10
         5 002674   002371 236000 1                  LDQ     FPT$
         5 002675   000012 036003                    ADLQ    10,DU
         5 002676   002371 470400 1                  LDP0    FPT$
         5 002677   000000 757100                    STAQ    0,,PR0

     1071     9794            %CLIMB(FCN=ERS);

   9802  5 002700   000000 713400 xsym               CLIMB   I$ERS
         5 002701   402000 600000 xsid               climb   nvectors=         5

     1072     9808    1       GOTO COMMON_RETURN;

   9808  5 002702   005017 710000 5                  TRA     COMMON_RETURN

     1073     9809         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:169  
     1074     9810        /**   COMMON CALLING SEQUENCES FOR 'CALL FIND(DBKEY)'   **/
     1075     9811
     1076     9812    1   FINDBKEY: PROC;

   9812  5 002703   200030 741300       FINDBKEY     STX1  ! FIT$+1,,AUTO

     1077     9813
     1078     9814    2       CALL CHK_RETAIN(IPT_FDR.V.RLCW,0);

   9814  5 002704   000074 236000 6                  LDQ     60
         5 002705   200034 756100                    STQ     @OFFSET,,AUTO
         5 002706   002371 236000 1                  LDQ     FPT$
         5 002707   000016 036003                    ADLQ    14,DU
         5 002710   200033 756100                    STQ     @RLCW,,AUTO
         5 002711   001530 701000 5                  TSX1    CHK_RETAIN
         5 002712   000000 011000                    NOP     0

     1079     9815    2       IPT_FDR.V_ = VECTOR(IPT_FDR.V);

   9815  5 002713   000057 235000 6                  LDA     47
         5 002714   002371 236000 1                  LDQ     FPT$
         5 002715   000014 036003                    ADLQ    12,DU
         5 002716   002371 470400 1                  LDP0    FPT$
         5 002717   000000 757100                    STAQ    0,,PR0

     1080     9816    3       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

   9816  5 002720   002375 471400 1                  LDP1    RLCW$
         5 002721   100000 236100                    LDQ     0,,PR1
         5 002722   000377 316007                    CANQ    255,DL
         5 002723   002740 600000 5                  TZE     s:9828

     1081     9817    3           VBOUND(IPT_FDR.V_) = VBOUND(IPT_FDR.V_) +

   9817  5 002724   000000 236100                    LDQ     0,,PR0
         5 002725   000020 772000                    QRL     16
         5 002726   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:170  
         5 002727   100000 236100                    LDQ     0,,PR1
         5 002730   000002 736000                    QLS     2
         5 002731   001774 376007                    ANQ     1020,DL
         5 002732   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 002733   000004 136007                    SBLQ    4,DL
         5 002734   000020 736000                    QLS     16
         5 002735   000000 676100                    ERQ     0,,PR0
         5 002736   000000 376000 6                  ANQ     0
         5 002737   000000 656100                    ERSQ    0,,PR0

     1082     9818    3              SIZEC(IPT_FDR.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1083     9819    3           END;

     1084     9820            %CLIMB(FCN=FDR);

   9828  5 002740   000000 713400 xsym               CLIMB   I$FDR
         5 002741   402400 600000 xsid               climb   nvectors=         6

     1085     9834    2       FPTS.V_=VECTOR(FPTS.V);

   9834  5 002742   000034 235000 6                  LDA     28
         5 002743   002371 236000 1                  LDQ     FPT$
         5 002744   000012 036003                    ADLQ    10,DU
         5 002745   002371 470400 1                  LDP0    FPT$
         5 002746   000000 757100                    STAQ    0,,PR0

     1086     9835    2   END;

   9835  5 002747   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 002750   000001 702211                    TSX2  ! 1,X1

     1087     9836
     1088     9837    1   FIND: ENTRY(

   9837  5 002751   000000 700200 xent  FIND         TSX0  ! X66_AUTO_N
         5 002752   000106 000024                    ZERO    70,20

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:171  
     1089     9838               %GEN_PARAMS;
     1090    10379
     1091    10380    1       CALL SET_ARGS;

  10380  5 002753   000535 701000 5                  TSX1    SET_ARGS
         5 002754   000000 011000                    NOP     0

     1092    10381    1       IF NO_ARGS=1 AND ARG.TYPE(0)=SNA.CURRENT THEN

  10381  5 002755   000012 235000 1                  LDA     NO_ARGS
         5 002756   000001 115007                    CMPA    1,DL
         5 002757   003004 601000 5                  TNZ     s:10404
         5 002760   002372 470400 1                  LDP0    ARG$
         5 002761   000000 236100                    LDQ     0,,PR0
         5 002762   777777 376007                    ANQ     -1,DL
         5 002763   000003 116000 0                  CMPQ    SNA+3
         5 002764   003004 601000 5                  TNZ     s:10404

     1093    10382    2       DO;

     1094    10383    2           CALL CHK_RETAIN(IPT_FCR.V.RLCW,0); /* CALL FIND(CURRENT) */

  10383  5 002765   000074 236000 6                  LDQ     60
         5 002766   200034 756100                    STQ     @RLCW+1,,AUTO
         5 002767   002371 236000 1                  LDQ     FPT$
         5 002770   000012 036003                    ADLQ    10,DU
         5 002771   200033 756100                    STQ     @B+1,,AUTO
         5 002772   001530 701000 5                  TSX1    CHK_RETAIN
         5 002773   000000 011000                    NOP     0

     1095    10384    2           IPT_FCR.V_ = VECTOR(IPT_FCR.V);

  10384  5 002774   000012 235000 6                  LDA     10
         5 002775   002371 236000 1                  LDQ     FPT$
         5 002776   000012 036003                    ADLQ    10,DU
         5 002777   002371 470400 1                  LDP0    FPT$
         5 003000   000000 757100                    STAQ    0,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:172  

     1096    10385                %CLIMB(FCN=FCR); /* FIND CURRENT OF RUN */

  10393  5 003001   000000 713400 xsym               CLIMB   I$FCR
         5 003002   402000 600000 xsid               climb   nvectors=         5

     1097    10399    2           GOTO COMMON_RETURN;

  10399  5 003003   005017 710000 5                  TRA     COMMON_RETURN

     1098    10400    2           END;
     1099    10401        /*E*  ERROR: ZII-60-1
     1100    10402              MESSAGE: Syntax error in FIND CALL.
     1101    10403                       Argument count is less than 2.  */
     1102    10404    1       IF NO_ARGS<2 THEN CALL ARG_ERROR(60);

  10404  5 003004   000002 115007                    CMPA    2,DL
         5 003005   003012 605000 5                  TPL     s:10405

  10404  5 003006   000102 236000 6                  LDQ     66
         5 003007   200037 756100                    STQ     @A+2,,AUTO
         5 003010   000716 701000 5                  TSX1    ARG_ERROR
         5 003011   000000 011000                    NOP     0

     1103    10405    1       IF ARG.TYPE(NO_ARGS-2)=SNA.USING THEN

  10405  5 003012   002372 470400 1                  LDP0    ARG$
         5 003013   000012 720000 1                  LXL0    NO_ARGS
         5 003014   077776 236110                    LDQ     -2,X0,PR0
         5 003015   777777 376007                    ANQ     -1,DL
         5 003016   000032 116000 0                  CMPQ    SNA+26
         5 003017   003226 601000 5                  TNZ     s:10506

     1104    10406    2       DO;

     1105    10407        /**************************************************************/
     1106    10408        /*                                                            */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:173  
     1107    10409        /*     TYPE OF FIND: USING KEY (KEY IN INDEX)                 */
     1108    10410        /*                                                            */
     1109    10411        /*                FIRST[,REC-NAME]                            */
     1110    10412        /*     CALL FIND(<NEXT [,REC-NAME]>,USING,KEY-NAME)           */
     1111    10413        /*                  REC-NAME                                  */
     1112    10414        /*                                                            */
     1113    10415        /**************************************************************/
     1114    10416
     1115    10417    2           IF ARG.TYPE(0)=%RECORD_NAME THEN

  10417  5 003020   000000 721100                    LXL1    0,,PR0
         5 003021   000041 101003                    CMPX1   33,DU
         5 003022   003077 601000 5                  TNZ     s:10448

     1116    10418    3           DO;

     1117    10419    3               IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(65);

  10419  5 003023   000002 722100                    LXL2    2,,PR0
         5 003024   000040 102003                    CMPX2   32,DU
         5 003025   003032 600000 5                  TZE     s:10423

  10419  5 003026   000104 236000 6                  LDQ     68
         5 003027   200037 756100                    STQ     @A+2,,AUTO
         5 003030   000716 701000 5                  TSX1    ARG_ERROR
         5 003031   000000 011000                    NOP     0

     1118    10420        /*E*  ERROR: ZII-65-1
     1119    10421              MESSAGE: Bad 3rd argument in FIND CALL.
     1120    10422                       The correct syntax is CALL FIND(RECORD-NAME,USING,KEY-NAME) */
     1121    10423    3               IPT_FUI.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  10423  5 003032   002372 470400 1                  LDP0    ARG$
         5 003033   000000 220100                    LDX0    0,,PR0
         5 003034   002371 471400 1                  LDP1    FPT$
         5 003035   100012 740100                    STX0    10,,PR1

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:174  
     1122    10424    3               IPT_FUI.V.SC.SC_OFFSET#=ARG.OFFSET(2);

  10424  5 003036   000002 221100                    LDX1    2,,PR0
         5 003037   100013 741100                    STX1    11,,PR1

     1123    10425    3               IPT_FUI.V_ = VECTOR(IPT_FUI.V);

  10425  5 003040   000057 235000 6                  LDA     47
         5 003041   002371 236000 1                  LDQ     FPT$
         5 003042   000012 036003                    ADLQ    10,DU
         5 003043   100000 757100                    STAQ    0,,PR1

     1124    10426    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10426  5 003044   002375 473400 1                  LDP3    RLCW$
         5 003045   300000 236100                    LDQ     0,,PR3
         5 003046   000377 316007                    CANQ    255,DL
         5 003047   003064 600000 5                  TZE     s:10430

     1125    10427    4                   VBOUND(IPT_FUI.V_) = VBOUND(IPT_FUI.V_) +

  10427  5 003050   100000 236100                    LDQ     0,,PR1
         5 003051   000020 772000                    QRL     16
         5 003052   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003053   300000 236100                    LDQ     0,,PR3
         5 003054   000002 736000                    QLS     2
         5 003055   001774 376007                    ANQ     1020,DL
         5 003056   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003057   000004 136007                    SBLQ    4,DL
         5 003060   000020 736000                    QLS     16
         5 003061   100000 676100                    ERQ     0,,PR1
         5 003062   000000 376000 6                  ANQ     0
         5 003063   100000 656100                    ERSQ    0,,PR1

     1126    10428    4                      SIZEC(IPT_FUI.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1127    10429    4                   END;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:175  
     1128    10430    3               CALL CHK_RETAIN(IPT_FUI.V.RLCW,0);

  10430  5 003064   000074 236000 6                  LDQ     60
         5 003065   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003066   002371 236000 1                  LDQ     FPT$
         5 003067   000014 036003                    ADLQ    12,DU
         5 003070   200033 756100                    STQ     @B+1,,AUTO
         5 003071   001530 701000 5                  TSX1    CHK_RETAIN
         5 003072   000000 011000                    NOP     0

     1129    10431                    %CLIMB(FCN=FUI);

  10439  5 003073   002371 470400 1                  LDP0    FPT$
         5 003074   000000 713400 xsym               CLIMB   I$FUI
         5 003075   402000 600000 xsid               climb   nvectors=         5

     1130    10445    3               END;

  10445  5 003076   004345 710000 5                  TRA     s:10944

     1131    10446    2           ELSE
     1132    10447    3           DO;

     1133    10448    3               IF ARG.TYPE(0)=SNA.FIRST THEN

  10448  5 003077   000000 236100                    LDQ     0,,PR0
         5 003100   777777 376007                    ANQ     -1,DL
         5 003101   000006 116000 0                  CMPQ    SNA+6
         5 003102   003107 601000 5                  TNZ     s:10451

     1134    10449    3                   IPT_FRI.V.FCW.RECORD_LOCATION#=0;

  10449  5 003103   000000 222003                    LDX2    0,DU
         5 003104   002371 471400 1                  LDP1    FPT$
         5 003105   100012 742100                    STX2    10,,PR1
         5 003106   003121 710000 5                  TRA     s:10458

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:176  
     1135    10450    3               ELSE
     1136    10451    3                   IF ARG.TYPE(0)=SNA.NEXT THEN

  10451  5 003107   000013 116000 0                  CMPQ    SNA+11
         5 003110   003115 601000 5                  TNZ     s:10454

     1137    10452    3                       IPT_FRI.V.FCW.RECORD_LOCATION#=1;

  10452  5 003111   000001 222003                    LDX2    1,DU
         5 003112   002371 471400 1                  LDP1    FPT$
         5 003113   100012 742100                    STX2    10,,PR1
         5 003114   003121 710000 5                  TRA     s:10458

     1138    10453    3                   ELSE
     1139    10454    3                       CALL ARG_ERROR(70);

  10454  5 003115   000106 236000 6                  LDQ     70
         5 003116   200037 756100                    STQ     @A+2,,AUTO
         5 003117   000716 701000 5                  TSX1    ARG_ERROR
         5 003120   000000 011000                    NOP     0

     1140    10455        /*E*  ERROR: ZII-70-1
     1141    10456              MESSAGE: Required keyword FIRST/NEXT missing in
     1142    10457                       CALL FIND(NEXT/FIRST,[RECORD-NAME],USING,KEY-NAME) */
     1143    10458    3               IF ARG.TYPE(2)=SNA.USING THEN

  10458  5 003121   002372 470400 1                  LDP0    ARG$
         5 003122   000002 236100                    LDQ     2,,PR0
         5 003123   777777 376007                    ANQ     -1,DL
         5 003124   000032 116000 0                  CMPQ    SNA+26
         5 003125   003147 601000 5                  TNZ     s:10470

     1144    10459    4               DO;

     1145    10460    4                   IF ARG.TYPE(1)~=%RECORD_NAME OR ARG.TYPE(3)~=%SET_NAME THEN

  10460  5 003126   000001 720100                    LXL0    1,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:177  
         5 003127   000041 100003                    CMPX0   33,DU
         5 003130   003134 601000 5                  TNZ     s:10461
         5 003131   000003 721100                    LXL1    3,,PR0
         5 003132   000040 101003                    CMPX1   32,DU
         5 003133   003140 600000 5                  TZE     s:10467

     1146    10461    4                       CALL ARG_ERROR(75);

  10461  5 003134   000110 236000 6                  LDQ     72
         5 003135   200037 756100                    STQ     @A+2,,AUTO
         5 003136   000716 701000 5                  TSX1    ARG_ERROR
         5 003137   000000 011000                    NOP     0

     1147    10462        /*E*  ERROR: ZII-75-1
     1148    10463              MESSAGE: The 2nd argument in FIND CALL is not a RECORD-NAME,
     1149    10464                       or the 4th argument is not a SET-NAME.
     1150    10465                       The correct syntax is
     1151    10466                       CALL FIND(NEXT/FIRST,RECORD-NAME,USING,KEY-NAME) */
     1152    10467    4                   IPT_FRI.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10467  5 003140   002372 470400 1                  LDP0    ARG$
         5 003141   000001 220100                    LDX0    1,,PR0
         5 003142   002371 471400 1                  LDP1    FPT$
         5 003143   100013 740100                    STX0    11,,PR1

     1153    10468    4                   IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(3);

  10468  5 003144   000003 221100                    LDX1    3,,PR0
         5 003145   100014 741100                    STX1    12,,PR1

     1154    10469    4                   END;

  10469  5 003146   003167 710000 5                  TRA     s:10481

     1155    10470    3               ELSE IF NO_ARGS=3 AND ARG.TYPE(2)=%SET_NAME THEN

  10470  5 003147   000012 235000 1                  LDA     NO_ARGS
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:178  
         5 003150   000003 115007                    CMPA    3,DL
         5 003151   003163 601000 5                  TNZ     s:10476
         5 003152   000002 720100                    LXL0    2,,PR0
         5 003153   000040 100003                    CMPX0   32,DU
         5 003154   003163 601000 5                  TNZ     s:10476

     1156    10471    4                   DO;

     1157    10472    4                       IPT_FRI.V.RC.RC_OFFSET#=NULL_OFFSET;

  10472  5 003155   002365 721000 1                  LXL1    NULL_OFFSET
         5 003156   002371 471400 1                  LDP1    FPT$
         5 003157   100013 741100                    STX1    11,,PR1

     1158    10473    4                       IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(2);

  10473  5 003160   000002 220100                    LDX0    2,,PR0
         5 003161   100014 740100                    STX0    12,,PR1

     1159    10474    4                       END;

  10474  5 003162   003167 710000 5                  TRA     s:10481

     1160    10475    3                   ELSE
     1161    10476    3                       CALL ARG_ERROR(80);

  10476  5 003163   000112 236000 6                  LDQ     74
         5 003164   200037 756100                    STQ     @A+2,,AUTO
         5 003165   000716 701000 5                  TSX1    ARG_ERROR
         5 003166   000000 011000                    NOP     0

     1162    10477        /*E*  ERROR: ZII-80-1
     1163    10478              MESSAGE: 3rd argument in FIND CALL is not a KEY-NAME.
     1164    10479                       The correct syntax is
     1165    10480                       CALL FIND(FIRST/NEXT,USING,KEY-NAME)  */
     1166    10481    3               CALL CHK_RETAIN(IPT_FRI.V.RLCW,0);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:179  
  10481  5 003167   000074 236000 6                  LDQ     60
         5 003170   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003171   002371 236000 1                  LDQ     FPT$
         5 003172   000015 036003                    ADLQ    13,DU
         5 003173   200033 756100                    STQ     @B+1,,AUTO
         5 003174   001530 701000 5                  TSX1    CHK_RETAIN
         5 003175   000000 011000                    NOP     0

     1167    10482    3               IPT_FRI.V_ = VECTOR(IPT_FRI.V);

  10482  5 003176   000113 235000 6                  LDA     75
         5 003177   002371 236000 1                  LDQ     FPT$
         5 003200   000012 036003                    ADLQ    10,DU
         5 003201   002371 470400 1                  LDP0    FPT$
         5 003202   000000 757100                    STAQ    0,,PR0

     1168    10483    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10483  5 003203   002375 471400 1                  LDP1    RLCW$
         5 003204   100000 236100                    LDQ     0,,PR1
         5 003205   000377 316007                    CANQ    255,DL
         5 003206   003223 600000 5                  TZE     s:10495

     1169    10484    4                   VBOUND(IPT_FRI.V_) = VBOUND(IPT_FRI.V_) +

  10484  5 003207   000000 236100                    LDQ     0,,PR0
         5 003210   000020 772000                    QRL     16
         5 003211   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003212   100000 236100                    LDQ     0,,PR1
         5 003213   000002 736000                    QLS     2
         5 003214   001774 376007                    ANQ     1020,DL
         5 003215   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003216   000004 136007                    SBLQ    4,DL
         5 003217   000020 736000                    QLS     16
         5 003220   000000 676100                    ERQ     0,,PR0
         5 003221   000000 376000 6                  ANQ     0
         5 003222   000000 656100                    ERSQ    0,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:180  

     1170    10485    4                      SIZEC(IPT_FRI.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1171    10486    4                   END;

     1172    10487                    %CLIMB(FCN=FRI);

  10495  5 003223   000000 713400 xsym               CLIMB   I$FRI
         5 003224   402000 600000 xsid               climb   nvectors=         5

     1173    10501    3               END;

     1174    10502    2           END;

  10502  5 003225   004345 710000 5                  TRA     s:10944

     1175    10503         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:181  
     1176    10504    1       ELSE
     1177    10505    2       DO;

     1178    10506    3           DO CASE(ARG.TYPE(0));

  10506  5 003226   000000 721100                    LXL1    0,,PR0
         5 003227   000042 101003                    CMPX1   34,DU
         5 003230   003232 602011 5                  TNC     s:10506+4,X1
         5 003231   004212 710000 5                  TRA     s:10882
         5 003232   004212 710000 5                  TRA     s:10882
         5 003233   004212 710000 5                  TRA     s:10882
         5 003234   004212 710000 5                  TRA     s:10882
         5 003235   003475 710000 5                  TRA     s:10623
         5 003236   004212 710000 5                  TRA     s:10882
         5 003237   004212 710000 5                  TRA     s:10882
         5 003240   004212 710000 5                  TRA     s:10882
         5 003241   003712 710000 5                  TRA     s:10721
         5 003242   003464 710000 5                  TRA     s:10611
         5 003243   003475 710000 5                  TRA     s:10623
         5 003244   004212 710000 5                  TRA     s:10882
         5 003245   004212 710000 5                  TRA     s:10882
         5 003246   004212 710000 5                  TRA     s:10882
         5 003247   004212 710000 5                  TRA     s:10882
         5 003250   004212 710000 5                  TRA     s:10882
         5 003251   003712 710000 5                  TRA     s:10721
         5 003252   004212 710000 5                  TRA     s:10882
         5 003253   004212 710000 5                  TRA     s:10882
         5 003254   004135 710000 5                  TRA     s:10844
         5 003255   003712 710000 5                  TRA     s:10721
         5 003256   004212 710000 5                  TRA     s:10882
         5 003257   004212 710000 5                  TRA     s:10882
         5 003260   004212 710000 5                  TRA     s:10882
         5 003261   004212 710000 5                  TRA     s:10882
         5 003262   004212 710000 5                  TRA     s:10882
         5 003263   004212 710000 5                  TRA     s:10882
         5 003264   004212 710000 5                  TRA     s:10882
         5 003265   004212 710000 5                  TRA     s:10882
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:182  
         5 003266   004212 710000 5                  TRA     s:10882
         5 003267   004212 710000 5                  TRA     s:10882
         5 003270   004212 710000 5                  TRA     s:10882
         5 003271   004212 710000 5                  TRA     s:10882
         5 003272   004212 710000 5                  TRA     s:10882
         5 003273   003274 710000 5                  TRA     s:10508

     1179    10507    3           CASE(%RECORD_NAME);

     1180    10508    3               IF ARG.TYPE(1)=SNA.DBKEY THEN

  10508  5 003274   000001 236100                    LDQ     1,,PR0
         5 003275   777777 376007                    ANQ     -1,DL
         5 003276   000004 116000 0                  CMPQ    SNA+4
         5 003277   003311 601000 5                  TNZ     s:10523

     1181    10509    4               DO;

     1182    10510
     1183    10511        /****************************************************************/
     1184    10512        /*                                                              */
     1185    10513        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1186    10514        /*                                                              */
     1187    10515        /*            CALL FIND(REC-NAME,DBKEY,IDENTIFIER)              */
     1188    10516        /*                                                              */
     1189    10517        /****************************************************************/
     1190    10518
     1191    10519    4                   IPT_FDR.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  10519  5 003300   000000 222100                    LDX2    0,,PR0
         5 003301   002371 471400 1                  LDP1    FPT$
         5 003302   100014 742100                    STX2    12,,PR1

     1192    10520    4                   IPT_FDR.DBK_=VECTOR(A3);

  10520  5 003303   777640 235007                    LDA     -96,DL
         5 003304   200005 236100                    LDQ     @A3,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:183  
         5 003305   100012 757100                    STAQ    10,,PR1

     1193    10521    4                   CALL FINDBKEY;

  10521  5 003306   002703 701000 5                  TSX1    FINDBKEY
         5 003307   000000 011000                    NOP     0

     1194    10522    4                   END;

  10522  5 003310   004345 710000 5                  TRA     s:10944

     1195    10523    3               ELSE IF ARG.TYPE(1)=SNA.WITHIN THEN

  10523  5 003311   000033 116000 0                  CMPQ    SNA+27
         5 003312   003457 601000 5                  TNZ     s:10595

     1196    10524    4                   DO;

     1197    10525
     1198    10526        /***************************************************************/
     1199    10527        /*                                                             */
     1200    10528        /*            TYPE OF FIND: WITH KEY WITHIN CURRENT SET        */
     1201    10529        /*                                                             */
     1202    10530        /*            CALL FIND(REC-NAME,WITHIN,SET-NAME,[CURRENT]     */
     1203    10531        /*                      [,IDENT-5],[IDENT-6],....])            */
     1204    10532        /*                                                             */
     1205    10533        /***************************************************************/
     1206    10534
     1207    10535    4                       IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(85);

  10535  5 003313   000002 722100                    LXL2    2,,PR0
         5 003314   000040 102003                    CMPX2   32,DU
         5 003315   003322 600000 5                  TZE     s:10540

  10535  5 003316   000115 236000 6                  LDQ     77
         5 003317   200037 756100                    STQ     @A+2,,AUTO
         5 003320   000716 701000 5                  TSX1    ARG_ERROR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:184  
         5 003321   000000 011000                    NOP     0

     1208    10536        /*E*  ERROR: ZII-85-1
     1209    10537              MESSAGE: 3rd argument in FIND CALL is not a SET-NAME.
     1210    10538                       The correct syntax is
     1211    10539                       CALL FIND(RECORD-NAME,WITHIN,SET-NAME,[CURRENT],...) */
     1212    10540    4                       IPT_FKC.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  10540  5 003322   002372 470400 1                  LDP0    ARG$
         5 003323   000000 220100                    LDX0    0,,PR0
         5 003324   002371 471400 1                  LDP1    FPT$
         5 003325   100012 740100                    STX0    10,,PR1

     1213    10541    4                       IPT_FKC.V.SC.SC_OFFSET#=ARG.OFFSET(2);

  10541  5 003326   000002 221100                    LDX1    2,,PR0
         5 003327   100013 741100                    STX1    11,,PR1

     1214    10542    4                       IF NO_ARGS>3 AND ARG.TYPE(3)=SNA.CURRENT THEN

  10542  5 003330   000012 235000 1                  LDA     NO_ARGS
         5 003331   000003 115007                    CMPA    3,DL
         5 003332   003342 604400 5                  TMOZ    s:10543+3
         5 003333   000003 236100                    LDQ     3,,PR0
         5 003334   777777 376007                    ANQ     -1,DL
         5 003335   000003 116000 0                  CMPQ    SNA+3
         5 003336   003342 601000 5                  TNZ     s:10543+3

     1215    10543    4                           I=4; ELSE I=3;

  10543  5 003337   000004 235007                    LDA     4,DL
         5 003340   000003 755000 1                  STA     I
         5 003341   003344 710000 5                  TRA     s:10544

  10543  5 003342   000003 236007                    LDQ     3,DL
         5 003343   000003 756000 1                  STQ     I

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:185  
     1216    10544    5                       DO J=I TO NO_ARGS-1;

  10544  5 003344   000003 235000 1                  LDA     I
         5 003345   000005 755000 1                  STA     J
         5 003346   003370 710000 5                  TRA     s:10551+1

     1217    10545        /*E*  ERROR: ZII-90-1
     1218    10546              MESSAGE: The variable length argument list in FIND CALL
     1219    10547                       does not contain all FIELD-NAMES. The correct syntax is
     1220    10548                       CALL FIND(REC-NAME,WITHIN,SET-NAME,FIELD-NAME,....).  */
     1221    10549    5                           IF ARG.TYPE(J)~=%FIELD_NAME THEN CALL ARG_ERROR(90);

  10549  5 003347   002372 470400 1                  LDP0    ARG$
         5 003350   000005 720000 1                  LXL0    J
         5 003351   000000 721110                    LXL1    0,X0,PR0
         5 003352   000042 101003                    CMPX1   34,DU
         5 003353   003360 600000 5                  TZE     s:10550

  10549  5 003354   000117 236000 6                  LDQ     79
         5 003355   200037 756100                    STQ     @A+2,,AUTO
         5 003356   000716 701000 5                  TSX1    ARG_ERROR
         5 003357   000000 011000                    NOP     0

     1222    10550    5                           IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#(J-I)=ARG.OFFSET(J);

  10550  5 003360   000005 236000 1                  LDQ     J
         5 003361   000003 136000 1                  SBLQ    I
         5 003362   002372 470400 1                  LDP0    ARG$
         5 003363   000005 720000 1                  LXL0    J
         5 003364   000000 221110                    LDX1    0,X0,PR0
         5 003365   002371 471400 1                  LDP1    FPT$
         5 003366   100016 741106                    STX1    14,QL,PR1

     1223    10551    5                           END;

  10551  5 003367   000005 054000 1                  AOS     J
         5 003370   000005 236000 1                  LDQ     J
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:186  
         5 003371   000012 116000 1                  CMPQ    NO_ARGS
         5 003372   003347 604000 5                  TMI     s:10549

     1224    10552    4                       IPT_FKC.V.FLCW.N_FIELDS#=NO_ARGS-I;

  10552  5 003373   000012 236000 1                  LDQ     NO_ARGS
         5 003374   000003 136000 1                  SBLQ    I
         5 003375   000000 620006                    EAX0    0,QL
         5 003376   100014 740100                    STX0    12,,PR1

     1225    10553    4                       CALL CHK_RETAIN(IPT_FKC.V.RLCW,IPT_FKC.V.FLCW.N_FIELDS#);

  10553  5 003377   002371 236000 1                  LDQ     FPT$
         5 003400   000014 036003                    ADLQ    12,DU
         5 003401   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003402   002371 236000 1                  LDQ     FPT$
         5 003403   000015 036003                    ADLQ    13,DU
         5 003404   200033 756100                    STQ     @B+1,,AUTO
         5 003405   001530 701000 5                  TSX1    CHK_RETAIN
         5 003406   000000 011000                    NOP     0

     1226    10554    4                       IPT_FKC.V_ = VECTOR(IPT_FKC.V);

  10554  5 003407   000113 235000 6                  LDA     75
         5 003410   002371 236000 1                  LDQ     FPT$
         5 003411   000012 036003                    ADLQ    10,DU
         5 003412   002371 470400 1                  LDP0    FPT$
         5 003413   000000 757100                    STAQ    0,,PR0

     1227    10555    4                       IF RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# ~= 0

  10555  5 003414   000014 236100                    LDQ     12,,PR0
         5 003415   000022 732000                    QRS     18
         5 003416   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003417   002375 471400 1                  LDP1    RLCW$
         5 003420   100000 236100                    LDQ     0,,PR1
         5 003421   000377 376007                    ANQ     255,DL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:187  
         5 003422   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003423   003446 600000 5                  TZE     s:10561

     1228    10556    5                       THEN DO;

     1229    10557    5                           VBOUND(IPT_FKC.V_) = VBOUND(IPT_FKC.V_) +

  10557  5 003424   000014 236100                    LDQ     12,,PR0
         5 003425   000022 732000                    QRS     18
         5 003426   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003427   100000 236100                    LDQ     0,,PR1
         5 003430   000377 376007                    ANQ     255,DL
         5 003431   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003432   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 003433   000000 236100                    LDQ     0,,PR0
         5 003434   000020 772000                    QRL     16
         5 003435   200100 756100                    STQ     ERRMSG_BUF+32,,AUTO
         5 003436   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 003437   000002 736000                    QLS     2
         5 003440   200100 036100                    ADLQ    ERRMSG_BUF+32,,AUTO
         5 003441   000004 136007                    SBLQ    4,DL
         5 003442   000020 736000                    QLS     16
         5 003443   000000 676100                    ERQ     0,,PR0
         5 003444   000000 376000 6                  ANQ     0
         5 003445   000000 656100                    ERSQ    0,,PR0

     1230    10558    5                              SIZEC(IPT_FKC.V.FL_RL_LIST) *
     1231    10559    5                              (RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# - 1 );
     1232    10560    5                           END;

     1233    10561    4                       IF I = 3

  10561  5 003446   000003 235000 1                  LDA     I
         5 003447   000003 115007                    CMPA    3,DL
         5 003450   003454 601000 5                  TNZ     s:10587

     1234    10562    5                       THEN DO;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:188  

     1235    10563                                %CLIMB(FCN=FKY);

  10571  5 003451   000000 713400 xsym               CLIMB   I$FKY
         5 003452   402000 600000 xsid               climb   nvectors=         5

     1236    10577    5                           END;

  10577  5 003453   004345 710000 5                  TRA     s:10944

     1237    10578    5                       ELSE DO;

     1238    10579                                %CLIMB(FCN=FKC);

  10587  5 003454   000000 713400 xsym               CLIMB   I$FKC
         5 003455   402000 600000 xsid               climb   nvectors=         5

     1239    10593    5                           END;

     1240    10594    4                       END;

  10594  5 003456   004345 710000 5                  TRA     s:10944

     1241    10595    3                   ELSE CALL ARG_ERROR(95);

  10595  5 003457   000121 236000 6                  LDQ     81
         5 003460   200037 756100                    STQ     @A+2,,AUTO
         5 003461   000716 701000 5                  TSX1    ARG_ERROR
         5 003462   000000 011000                    NOP     0
         5 003463   004345 710000 5                  TRA     s:10944

     1242    10596        /*E*  ERROR: ZII-95-1
     1243    10597              MESSAGE: Unknown type of FIND.
     1244    10598                       Required keyword DBKEY/WITHIN missing after
     1245    10599                       the 1st argument of a RECORD-NAME.  */
     1246    10600         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:189  
     1247    10601    3           CASE(%DBKEY);

     1248    10602
     1249    10603        /****************************************************************/
     1250    10604        /*                                                              */
     1251    10605        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1252    10606        /*                                                              */
     1253    10607        /*            CALL FIND(DBKEY,IDENTIFIER)                       */
     1254    10608        /*                                                              */
     1255    10609        /****************************************************************/
     1256    10610
     1257    10611    3               IPT_FDR.V.RC.RC_OFFSET#=NULL_OFFSET;

  10611  5 003464   002365 722000 1                  LXL2    NULL_OFFSET
         5 003465   002371 471400 1                  LDP1    FPT$
         5 003466   100014 742100                    STX2    12,,PR1

     1258    10612    3               IPT_FDR.DBK_=VECTOR(A2);

  10612  5 003467   777640 235007                    LDA     -96,DL
         5 003470   200004 236100                    LDQ     @A2,,AUTO
         5 003471   100012 757100                    STAQ    10,,PR1

     1259    10613    3               CALL FINDBKEY;

  10613  5 003472   002703 701000 5                  TSX1    FINDBKEY
         5 003473   000000 011000                    NOP     0
         5 003474   004345 710000 5                  TRA     s:10944

     1260    10614    3           CASE(%ANY,%DUPLICATE);

     1261    10615        /**************************************************************/
     1262    10616        /*                                                            */
     1263    10617        /*       TYPE OF FIND: WITH CALC KEY                          */
     1264    10618        /*                                                            */
     1265    10619        /*       CALL FIND(ANY/DUPANY,REC-NAME)                       */
     1266    10620        /*                                                            */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:190  
     1267    10621        /**************************************************************/
     1268    10622
     1269    10623    3               IF ARG.TYPE(1)=%RECORD_NAME THEN

  10623  5 003475   000001 722100                    LXL2    1,,PR0
         5 003476   000041 102003                    CMPX2   33,DU
         5 003477   003573 601000 5                  TNZ     s:10682

     1270    10624    4               DO;

     1271    10625    4                   IF NO_ARGS>2 THEN CALL ARG_ERROR(100);

  10625  5 003500   000012 235000 1                  LDA     NO_ARGS
         5 003501   000002 115007                    CMPA    2,DL
         5 003502   003507 604400 5                  TMOZ    s:10630

  10625  5 003503   000123 236000 6                  LDQ     83
         5 003504   200037 756100                    STQ     @A+2,,AUTO
         5 003505   000716 701000 5                  TSX1    ARG_ERROR
         5 003506   000000 011000                    NOP     0

     1272    10626        /*E*  ERROR: ZII-100-1
     1273    10627              MESSAGE: Argument count error in FIND CALL.
     1274    10628                       The correct syntax is
     1275    10629                       CALL FIND(ANY/DUPLICATE,RECORD-NAME). */
     1276    10630    4                   IPT_FDC.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10630  5 003507   002372 470400 1                  LDP0    ARG$
         5 003510   000001 220100                    LDX0    1,,PR0
         5 003511   002371 471400 1                  LDP1    FPT$
         5 003512   100012 740100                    STX0    10,,PR1

     1277    10631    4                   CALL CHK_RETAIN(IPT_FDC.V.RLCW,0);

  10631  5 003513   000074 236000 6                  LDQ     60
         5 003514   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003515   002371 236000 1                  LDQ     FPT$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:191  
         5 003516   000013 036003                    ADLQ    11,DU
         5 003517   200033 756100                    STQ     @B+1,,AUTO
         5 003520   001530 701000 5                  TSX1    CHK_RETAIN
         5 003521   000000 011000                    NOP     0

     1278    10632    5                   IF A1(0)=SNA.ANY THEN DO;

  10632  5 003522   200003 470500                    LDP0    @A1,,AUTO
         5 003523   000100 100500                    MLR     fill='000'O
         5 003524   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 003525   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 003526   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 003527   000001 116000 0                  CMPQ    SNA+1
         5 003530   003562 601000 5                  TNZ     s:10654

     1279    10633    5                       IPT_FDC.V_ = VECTOR(IPT_FDC.V);

  10633  5 003531   000057 235000 6                  LDA     47
         5 003532   002371 236000 1                  LDQ     FPT$
         5 003533   000012 036003                    ADLQ    10,DU
         5 003534   002371 471400 1                  LDP1    FPT$
         5 003535   100000 757100                    STAQ    0,,PR1

     1280    10634    6                       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10634  5 003536   002375 473400 1                  LDP3    RLCW$
         5 003537   300000 236100                    LDQ     0,,PR3
         5 003540   000377 316007                    CANQ    255,DL
         5 003541   003556 600000 5                  TZE     s:10646

     1281    10635    6                           VBOUND(IPT_FDC.V_) = VBOUND(IPT_FDC.V_) +

  10635  5 003542   100000 236100                    LDQ     0,,PR1
         5 003543   000020 772000                    QRL     16
         5 003544   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003545   300000 236100                    LDQ     0,,PR3
         5 003546   000002 736000                    QLS     2
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:192  
         5 003547   001774 376007                    ANQ     1020,DL
         5 003550   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003551   000004 136007                    SBLQ    4,DL
         5 003552   000020 736000                    QLS     16
         5 003553   100000 676100                    ERQ     0,,PR1
         5 003554   000000 376000 6                  ANQ     0
         5 003555   100000 656100                    ERSQ    0,,PR1

     1282    10636    6                              SIZEC(IPT_FDC.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1283    10637    6                           END;

     1284    10638                            %CLIMB(FCN=FDC);

  10646  5 003556   100000 630500                    EPPR0   0,,PR1
         5 003557   000000 713400 xsym               CLIMB   I$FDC
         5 003560   402000 600000 xsid               climb   nvectors=         5

     1285    10652    5                       END;

  10652  5 003561   004345 710000 5                  TRA     s:10944

     1286    10653    5                   ELSE DO;

     1287    10654    5                       IPT_FCD.V_ = VECTOR(IPT_FCD.V);

  10654  5 003562   000057 235000 6                  LDA     47
         5 003563   002371 236000 1                  LDQ     FPT$
         5 003564   000012 036003                    ADLQ    10,DU
         5 003565   002371 471400 1                  LDP1    FPT$
         5 003566   100000 757100                    STAQ    0,,PR1

     1288    10655                            %CLIMB(FCN=FCD);

  10663  5 003567   100000 630500                    EPPR0   0,,PR1
         5 003570   000000 713400 xsym               CLIMB   I$FCD
         5 003571   402000 600000 xsid               climb   nvectors=         5

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:193  
     1289    10669    5                       END;

     1290    10670    4                   END;

  10670  5 003572   004345 710000 5                  TRA     s:10944

     1291    10671    3               ELSE
     1292    10672    4               DO;

     1293    10673         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:194  
     1294    10674        /*************************************************************/
     1295    10675        /*                                                           */
     1296    10676        /*       TYPE OF FIND: DUPLICATE RECORD WITHIN A SET         */
     1297    10677        /*                                                           */
     1298    10678        /*       CALL FIND(DUPSET,SET-NAME,IDENT-2,[IDENT-3],...])   */
     1299    10679        /*                                                           */
     1300    10680        /*************************************************************/
     1301    10681
     1302    10682    4                   IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS<3 THEN CALL ARG_ERROR(105);

  10682  5 003573   000040 102003                    CMPX2   32,DU
         5 003574   003600 601000 5                  TNZ     s:10682+5
         5 003575   000012 235000 1                  LDA     NO_ARGS
         5 003576   000003 115007                    CMPA    3,DL
         5 003577   003604 605000 5                  TPL     s:10687

  10682  5 003600   000125 236000 6                  LDQ     85
         5 003601   200037 756100                    STQ     @A+2,,AUTO
         5 003602   000716 701000 5                  TSX1    ARG_ERROR
         5 003603   000000 011000                    NOP     0

     1303    10683        /*E*  ERROR: ZII-105-1
     1304    10684              MESSAGE: Argument count error, or the 2nd argument in
     1305    10685                     CALL FIND(DUPLICATE,SET-NAME,FIELD-NAME1,....)
     1306    10686                     is not a SET-NAME.  */
     1307    10687    4                   IPT_FDP.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  10687  5 003604   002372 470400 1                  LDP0    ARG$
         5 003605   000001 220100                    LDX0    1,,PR0
         5 003606   002371 471400 1                  LDP1    FPT$
         5 003607   100012 740100                    STX0    10,,PR1

     1308    10688    4                   IPT_FDP.V.FLCW.N_FIELDS#=NO_ARGS-2;

  10688  5 003610   000012 721000 1                  LXL1    NO_ARGS
         5 003611   777776 622011                    EAX2    -2,X1
         5 003612   100013 742100                    STX2    11,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:195  

     1309    10689    5                   DO I=0 TO NO_ARGS-3;

  10689  5 003613   000003 450000 1                  STZ     I
         5 003614   003634 710000 5                  TRA     s:10696+1

     1310    10690    5                       IF ARG.TYPE(I+2)~=%FIELD_NAME THEN CALL ARG_ERROR(110);

  10690  5 003615   002372 470400 1                  LDP0    ARG$
         5 003616   000003 720000 1                  LXL0    I
         5 003617   000002 721110                    LXL1    2,X0,PR0
         5 003620   000042 101003                    CMPX1   34,DU
         5 003621   003626 600000 5                  TZE     s:10695

  10690  5 003622   000127 236000 6                  LDQ     87
         5 003623   200037 756100                    STQ     @A+2,,AUTO
         5 003624   000716 701000 5                  TSX1    ARG_ERROR
         5 003625   000000 011000                    NOP     0

     1311    10691        /*E*  ERROR: ZII-110-1
     1312    10692           MESSAGE: The variable length list in FIND CALL does not contain all FIELD-NAMES.
     1313    10693                       The correct syntax is
     1314    10694                       CALL FIND(DUPSET,SET-NAME,FIELD-NAME1,....)  */
     1315    10695    5                       IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I+2);

  10695  5 003626   002372 470400 1                  LDP0    ARG$
         5 003627   000003 720000 1                  LXL0    I
         5 003630   000002 221110                    LDX1    2,X0,PR0
         5 003631   002371 471400 1                  LDP1    FPT$
         5 003632   100015 741110                    STX1    13,X0,PR1

     1316    10696    5                       END;

  10696  5 003633   000003 054000 1                  AOS     I
         5 003634   000012 236000 1                  LDQ     NO_ARGS
         5 003635   000003 136007                    SBLQ    3,DL
         5 003636   000003 116000 1                  CMPQ    I
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:196  
         5 003637   003615 605000 5                  TPL     s:10690

     1317    10697    4                   CALL CHK_RETAIN(IPT_FDP.V.RLCW,IPT_FDP.V.FLCW.N_FIELDS#);

  10697  5 003640   002371 236000 1                  LDQ     FPT$
         5 003641   000013 036003                    ADLQ    11,DU
         5 003642   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003643   002371 236000 1                  LDQ     FPT$
         5 003644   000014 036003                    ADLQ    12,DU
         5 003645   200033 756100                    STQ     @B+1,,AUTO
         5 003646   001530 701000 5                  TSX1    CHK_RETAIN
         5 003647   000000 011000                    NOP     0

     1318    10698    4                   IPT_FDP.V_ = VECTOR(IPT_FDP.V);

  10698  5 003650   000057 235000 6                  LDA     47
         5 003651   002371 236000 1                  LDQ     FPT$
         5 003652   000012 036003                    ADLQ    10,DU
         5 003653   002371 470400 1                  LDP0    FPT$
         5 003654   000000 757100                    STAQ    0,,PR0

     1319    10699    5                   IF RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# ~= 0 THEN DO;

  10699  5 003655   000013 236100                    LDQ     11,,PR0
         5 003656   000022 732000                    QRS     18
         5 003657   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003660   002375 471400 1                  LDP1    RLCW$
         5 003661   100000 236100                    LDQ     0,,PR1
         5 003662   000377 376007                    ANQ     255,DL
         5 003663   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003664   003707 600000 5                  TZE     s:10712

     1320    10700    5                       VBOUND(IPT_FDP.V_) = VBOUND(IPT_FDP.V_) +

  10700  5 003665   000013 236100                    LDQ     11,,PR0
         5 003666   000022 732000                    QRS     18
         5 003667   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:197  
         5 003670   100000 236100                    LDQ     0,,PR1
         5 003671   000377 376007                    ANQ     255,DL
         5 003672   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003673   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 003674   000000 236100                    LDQ     0,,PR0
         5 003675   000020 772000                    QRL     16
         5 003676   200100 756100                    STQ     ERRMSG_BUF+32,,AUTO
         5 003677   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 003700   000002 736000                    QLS     2
         5 003701   200100 036100                    ADLQ    ERRMSG_BUF+32,,AUTO
         5 003702   000004 136007                    SBLQ    4,DL
         5 003703   000020 736000                    QLS     16
         5 003704   000000 676100                    ERQ     0,,PR0
         5 003705   000000 376000 6                  ANQ     0
         5 003706   000000 656100                    ERSQ    0,,PR0

     1321    10701    5                          SIZEC(IPT_FDP.V.FL_RL_LIST) *
     1322    10702    5                          (RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# - 1);
     1323    10703    5                       END;

     1324    10704                        %CLIMB(FCN=FDP);

  10712  5 003707   000000 713400 xsym               CLIMB   I$FDP
         5 003710   402000 600000 xsid               climb   nvectors=         5

     1325    10718    4                   END;

  10718  5 003711   004345 710000 5                  TRA     s:10944

     1326    10719         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:198  
     1327    10720    3           CASE(%NEXT,%PRIOR,%CURRENT);

     1328    10721    3               IF NO_ARGS=2 AND ARG.TYPE(1)=%RECORD_NAME AND A1(0)=SNA.CURRENT THEN

  10721  5 003712   000012 235000 1                  LDA     NO_ARGS
         5 003713   000002 115007                    CMPA    2,DL
         5 003714   003771 601000 5                  TNZ     s:10765
         5 003715   000001 722100                    LXL2    1,,PR0
         5 003716   000041 102003                    CMPX2   33,DU
         5 003717   003771 601000 5                  TNZ     s:10765
         5 003720   200003 471500                    LDP1    @A1,,AUTO
         5 003721   000100 100500                    MLR     fill='000'O
         5 003722   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         5 003723   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 003724   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 003725   000003 116000 0                  CMPQ    SNA+3
         5 003726   003771 601000 5                  TNZ     s:10765

     1329    10722
     1330    10723        /******************************************************************/
     1331    10724        /*                                                                */
     1332    10725        /*       TYPE OF FIND: CURRENT OF RECORD                          */
     1333    10726        /*                                                                */
     1334    10727        /*       CALL FIND(CURRENT,REC-NAME)                              */
     1335    10728        /*                                                                */
     1336    10729        /******************************************************************/
     1337    10730    4               DO;

     1338    10731    4                   IPT_FCT.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10731  5 003727   000001 221100                    LDX1    1,,PR0
         5 003730   002371 473400 1                  LDP3    FPT$
         5 003731   300012 741100                    STX1    10,,PR3

     1339    10732    4                   CALL CHK_RETAIN(IPT_FCT.V.RLCW,0);

  10732  5 003732   000074 236000 6                  LDQ     60
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:199  
         5 003733   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003734   002371 236000 1                  LDQ     FPT$
         5 003735   000013 036003                    ADLQ    11,DU
         5 003736   200033 756100                    STQ     @B+1,,AUTO
         5 003737   001530 701000 5                  TSX1    CHK_RETAIN
         5 003740   000000 011000                    NOP     0

     1340    10733    4                   IPT_FCT.V_ = VECTOR(IPT_FCT.V);

  10733  5 003741   000057 235000 6                  LDA     47
         5 003742   002371 236000 1                  LDQ     FPT$
         5 003743   000012 036003                    ADLQ    10,DU
         5 003744   002371 470400 1                  LDP0    FPT$
         5 003745   000000 757100                    STAQ    0,,PR0

     1341    10734    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10734  5 003746   002375 471400 1                  LDP1    RLCW$
         5 003747   100000 236100                    LDQ     0,,PR1
         5 003750   000377 316007                    CANQ    255,DL
         5 003751   003766 600000 5                  TZE     s:10746

     1342    10735    5                       VBOUND(IPT_FCT.V_) = VBOUND(IPT_FCT.V_) +

  10735  5 003752   000000 236100                    LDQ     0,,PR0
         5 003753   000020 772000                    QRL     16
         5 003754   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003755   100000 236100                    LDQ     0,,PR1
         5 003756   000002 736000                    QLS     2
         5 003757   001774 376007                    ANQ     1020,DL
         5 003760   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003761   000004 136007                    SBLQ    4,DL
         5 003762   000020 736000                    QLS     16
         5 003763   000000 676100                    ERQ     0,,PR0
         5 003764   000000 376000 6                  ANQ     0
         5 003765   000000 656100                    ERSQ    0,,PR0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:200  
     1343    10736    5                          SIZEC(IPT_FCT.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1344    10737    5                       END;

     1345    10738                        %CLIMB(FCN=FCT);

  10746  5 003766   000000 713400 xsym               CLIMB   I$FCT
         5 003767   402000 600000 xsid               climb   nvectors=         5

     1346    10752    4                   END;

  10752  5 003770   004345 710000 5                  TRA     s:10944

     1347    10753    3               ELSE
     1348    10754         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:201  
     1349    10755        /****************************************************************/
     1350    10756        /*                                                              */
     1351    10757        /*       TYPE OF FIND: RELATIVE TO A SET OR A AREA              */
     1352    10758        /*                                                              */
     1353    10759        /*                 PRIOR                                        */
     1354    10760        /*       CALL FIND(CURRENT,[REC-NAME],SET-NAME)                 */
     1355    10761        /*                 NEXT               AREA-NAME                 */
     1356    10762        /*                                                              */
     1357    10763        /****************************************************************/
     1358    10764    4               DO;

     1359    10765    4                   IF ARG.TYPE(0)=SNA.PRIOR THEN

  10765  5 003771   000000 236100                    LDQ     0,,PR0
         5 003772   777777 376007                    ANQ     -1,DL
         5 003773   000017 116000 0                  CMPQ    SNA+15
         5 003774   004001 601000 5                  TNZ     s:10768

     1360    10766    4                       IPT_FRS.V.FCW.RECORD_LOCATION#=0;

  10766  5 003775   000000 221003                    LDX1    0,DU
         5 003776   002371 471400 1                  LDP1    FPT$
         5 003777   100012 741100                    STX1    10,,PR1
         5 004000   004012 710000 5                  TRA     s:10772

     1361    10767    4                   ELSE
     1362    10768    4                       IF ARG.TYPE(0)=SNA.CURRENT THEN

  10768  5 004001   000003 116000 0                  CMPQ    SNA+3
         5 004002   004007 601000 5                  TNZ     s:10771

     1363    10769    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=1;

  10769  5 004003   000001 221003                    LDX1    1,DU
         5 004004   002371 471400 1                  LDP1    FPT$
         5 004005   100012 741100                    STX1    10,,PR1
         5 004006   004012 710000 5                  TRA     s:10772
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:202  

     1364    10770    4                       ELSE
     1365    10771    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=2;

  10771  5 004007   000002 221003                    LDX1    2,DU
         5 004010   002371 471400 1                  LDP1    FPT$
         5 004011   100012 741100                    STX1    10,,PR1

     1366    10772    5                   DO CASE(NO_ARGS);

  10772  5 004012   000004 115007                    CMPA    4,DL
         5 004013   004015 602005 5                  TNC     s:10772+3,AL
         5 004014   004044 710000 5                  TRA     s:10786
         5 004015   004044 710000 5                  TRA     s:10786
         5 004016   004044 710000 5                  TRA     s:10786
         5 004017   004037 710000 5                  TRA     s:10783
         5 004020   004021 710000 5                  TRA     s:10775

     1367    10773
     1368    10774    5                   CASE(3);

     1369    10775    5                       IF ARG.TYPE(1)~=%RECORD_NAME THEN CALL ARG_ERROR(115);

  10775  5 004021   000001 722100                    LXL2    1,,PR0
         5 004022   000041 102003                    CMPX2   33,DU
         5 004023   004030 600000 5                  TZE     s:10780

  10775  5 004024   000131 236000 6                  LDQ     89
         5 004025   200037 756100                    STQ     @A+2,,AUTO
         5 004026   000716 701000 5                  TSX1    ARG_ERROR
         5 004027   000000 011000                    NOP     0

     1370    10776        /*E*  ERROR: ZII-115-1
     1371    10777              MESSAGE: Argument count error, or 2nd argument in
     1372    10778                       CALL FIND(PRIOR/CURRENT/NEXT,RECORD-NAME,SET-NAME/AREA-NAME)
     1373    10779                       is not a RECORD-NAME.  */
     1374    10780    5                       IPT_FRS.V.RC.RC_OFFSET#=ARG.OFFSET(1);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:203  

  10780  5 004030   002372 470400 1                  LDP0    ARG$
         5 004031   000001 220100                    LDX0    1,,PR0
         5 004032   002371 471400 1                  LDP1    FPT$
         5 004033   100013 740100                    STX0    11,,PR1

     1375    10781    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(2);

  10781  5 004034   000002 221100                    LDX1    2,,PR0
         5 004035   100014 741100                    STX1    12,,PR1
         5 004036   004050 710000 5                  TRA     s:10788

     1376    10782    5                   CASE(2);

     1377    10783    5                       IPT_FRS.V.RC.RC_OFFSET#=NULL_OFFSET;

  10783  5 004037   002365 722000 1                  LXL2    NULL_OFFSET
         5 004040   100013 742100                    STX2    11,,PR1

     1378    10784    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  10784  5 004041   000001 223100                    LDX3    1,,PR0
         5 004042   100014 743100                    STX3    12,,PR1
         5 004043   004050 710000 5                  TRA     s:10788

     1379    10785    5                   CASE(ELSE);

     1380    10786    5                       CALL ARG_ERROR(115);

  10786  5 004044   000131 236000 6                  LDQ     89
         5 004045   200037 756100                    STQ     @A+2,,AUTO
         5 004046   000716 701000 5                  TSX1    ARG_ERROR
         5 004047   000000 011000                    NOP     0

     1381    10787    5                       END;

     1382    10788    4                   CALL CHK_RETAIN(IPT_FRS.V.RLCW,0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:204  

  10788  5 004050   000074 236000 6                  LDQ     60
         5 004051   200034 756100                    STQ     @RLCW+1,,AUTO
         5 004052   002371 236000 1                  LDQ     FPT$
         5 004053   000015 036003                    ADLQ    13,DU
         5 004054   200033 756100                    STQ     @B+1,,AUTO
         5 004055   001530 701000 5                  TSX1    CHK_RETAIN
         5 004056   000000 011000                    NOP     0

     1383    10789    5                   DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);

  10789  5 004057   002372 470400 1                  LDP0    ARG$
         5 004060   000012 720000 1                  LXL0    NO_ARGS
         5 004061   077777 236110                    LDQ     -1,X0,PR0
         5 004062   777777 376007                    ANQ     -1,DL
         5 004063   000037 136007                    SBLQ    31,DL
         5 004064   000002 116007                    CMPQ    2,DL
         5 004065   004067 602006 5                  TNC     s:10789+8,QL
         5 004066   004130 710000 5                  TRA     s:10826
         5 004067   004071 710000 5                  TRA     s:10792
         5 004070   004102 710000 5                  TRA     s:10808

     1384    10790
     1385    10791    5                   CASE(%AREA_NAME_NET);

     1386    10792    5                       IPT_FRA.V_ = VECTOR(IPT_FRA.V);

  10792  5 004071   000113 235000 6                  LDA     75
         5 004072   002371 236000 1                  LDQ     FPT$
         5 004073   000012 036003                    ADLQ    10,DU
         5 004074   002371 471400 1                  LDP1    FPT$
         5 004075   100000 757100                    STAQ    0,,PR1

     1387    10793                            %CLIMB(FCN=FRA);

  10801  5 004076   100000 630500                    EPPR0   0,,PR1
         5 004077   000000 713400 xsym               CLIMB   I$FRA
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:205  
         5 004100   402000 600000 xsid               climb   nvectors=         5
         5 004101   004345 710000 5                  TRA     s:10944

     1388    10807    5                   CASE(%SET_NAME_NET);

     1389    10808    5                       IPT_FRS.V_ = VECTOR(IPT_FRS.V);

  10808  5 004102   000113 235000 6                  LDA     75
         5 004103   002371 236000 1                  LDQ     FPT$
         5 004104   000012 036003                    ADLQ    10,DU
         5 004105   002371 471400 1                  LDP1    FPT$
         5 004106   100000 757100                    STAQ    0,,PR1

     1390    10809    5                       VBOUND(IPT_FRS.V_) = VBOUND(IPT_FRS.V_) +

  10809  5 004107   100000 236100                    LDQ     0,,PR1
         5 004110   000020 772000                    QRL     16
         5 004111   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 004112   002375 473400 1                  LDP3    RLCW$
         5 004113   300000 236100                    LDQ     0,,PR3
         5 004114   000002 736000                    QLS     2
         5 004115   001774 376007                    ANQ     1020,DL
         5 004116   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 004117   000004 136007                    SBLQ    4,DL
         5 004120   000020 736000                    QLS     16
         5 004121   100000 676100                    ERQ     0,,PR1
         5 004122   000000 376000 6                  ANQ     0
         5 004123   100000 656100                    ERSQ    0,,PR1

     1391    10810    5                          SIZEC(IPT_FRS.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1392    10811                            %CLIMB(FCN=FRS);

  10819  5 004124   100000 630500                    EPPR0   0,,PR1
         5 004125   000000 713400 xsym               CLIMB   I$FRS
         5 004126   402000 600000 xsid               climb   nvectors=         5
         5 004127   004345 710000 5                  TRA     s:10944

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:206  
     1393    10825    5                   CASE(ELSE);

     1394    10826    5                       CALL ARG_ERROR(120);

  10826  5 004130   000133 236000 6                  LDQ     91
         5 004131   200037 756100                    STQ     @A+2,,AUTO
         5 004132   000716 701000 5                  TSX1    ARG_ERROR
         5 004133   000000 011000                    NOP     0

     1395    10827        /*E*  ERROR: ZII-120-1
     1396    10828              MESSAGE: The last argument in
     1397    10829                       CALL FIND(NEXT/PRIOR/CURRENT,[REC-NAME],SET-NAME/AREA-NAME)
     1398    10830                       is neither a SET-NAME nor an AREA-NAME.  */
     1399    10831    5                       END;

     1400    10832    4                   END;

  10832  5 004134   004345 710000 5                  TRA     s:10944

     1401    10833         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:207  
     1402    10834    3           CASE(%OWNER);

     1403    10835
     1404    10836        /***************************************************************/
     1405    10837        /*                                                             */
     1406    10838        /*       TYPE OF FIND: OWNER OF A SET                          */
     1407    10839        /*                                                             */
     1408    10840        /*       CALL FIND(OWNER,SET-NAME)                             */
     1409    10841        /*                                                             */
     1410    10842        /***************************************************************/
     1411    10843
     1412    10844    3               IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS>2 THEN CALL ARG_ERROR(125);

  10844  5 004135   000001 722100                    LXL2    1,,PR0
         5 004136   000040 102003                    CMPX2   32,DU
         5 004137   004143 601000 5                  TNZ     s:10844+6
         5 004140   000012 235000 1                  LDA     NO_ARGS
         5 004141   000002 115007                    CMPA    2,DL
         5 004142   004147 604400 5                  TMOZ    s:10848

  10844  5 004143   000135 236000 6                  LDQ     93
         5 004144   200037 756100                    STQ     @A+2,,AUTO
         5 004145   000716 701000 5                  TSX1    ARG_ERROR
         5 004146   000000 011000                    NOP     0

     1413    10845        /*E*  ERROR: ZII-125-1
     1414    10846              MESSAGE: Argument count error, or the 2nd argument in
     1415    10847                       CALL FIND(OWNER,SET-NAME) is not a SET-NAME. */
     1416    10848    3               IPT_FOR.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  10848  5 004147   002372 470400 1                  LDP0    ARG$
         5 004150   000001 220100                    LDX0    1,,PR0
         5 004151   002371 471400 1                  LDP1    FPT$
         5 004152   100012 740100                    STX0    10,,PR1

     1417    10849    3               CALL CHK_RETAIN(IPT_FOR.V.RLCW,0);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:208  
  10849  5 004153   000074 236000 6                  LDQ     60
         5 004154   200034 756100                    STQ     @RLCW+1,,AUTO
         5 004155   002371 236000 1                  LDQ     FPT$
         5 004156   000013 036003                    ADLQ    11,DU
         5 004157   200033 756100                    STQ     @B+1,,AUTO
         5 004160   001530 701000 5                  TSX1    CHK_RETAIN
         5 004161   000000 011000                    NOP     0

     1418    10850    3               IPT_FOR.V_ = VECTOR(IPT_FOR.V);

  10850  5 004162   000057 235000 6                  LDA     47
         5 004163   002371 236000 1                  LDQ     FPT$
         5 004164   000012 036003                    ADLQ    10,DU
         5 004165   002371 470400 1                  LDP0    FPT$
         5 004166   000000 757100                    STAQ    0,,PR0

     1419    10851    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10851  5 004167   002375 471400 1                  LDP1    RLCW$
         5 004170   100000 236100                    LDQ     0,,PR1
         5 004171   000377 316007                    CANQ    255,DL
         5 004172   004207 600000 5                  TZE     s:10863

     1420    10852    4                   VBOUND(IPT_FOR.V_) = VBOUND(IPT_FOR.V_) +

  10852  5 004173   000000 236100                    LDQ     0,,PR0
         5 004174   000020 772000                    QRL     16
         5 004175   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 004176   100000 236100                    LDQ     0,,PR1
         5 004177   000002 736000                    QLS     2
         5 004200   001774 376007                    ANQ     1020,DL
         5 004201   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 004202   000004 136007                    SBLQ    4,DL
         5 004203   000020 736000                    QLS     16
         5 004204   000000 676100                    ERQ     0,,PR0
         5 004205   000000 376000 6                  ANQ     0
         5 004206   000000 656100                    ERSQ    0,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:209  

     1421    10853    4                      SIZEC(IPT_FOR.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1422    10854    4                   END;

     1423    10855                    %CLIMB(FCN=FOR);

  10863  5 004207   000000 713400 xsym               CLIMB   I$FOR
         5 004210   402000 600000 xsid               climb   nvectors=         5
         5 004211   004345 710000 5                  TRA     s:10944

     1424    10869    3           CASE(ELSE);

     1425    10870         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:210  
     1426    10871        /**************************************************************/
     1427    10872        /*                                                            */
     1428    10873        /*       TYPE OF FIND: I-TH NUMBER WITHIN A SET OR A AREA     */
     1429    10874        /*                                                            */
     1430    10875        /*       CALL FIND(FIRST,[REC-NAME],SET-NAME )                */
     1431    10876        /*                 LAST             AREA-NAME                 */
     1432    10877        /*                 INTEGER                                    */
     1433    10878        /*                 IDENTIFIER                                 */
     1434    10879        /*                                                            */
     1435    10880        /**************************************************************/
     1436    10881
     1437    10882    3               IPT_FAA.V.AC.AC_OFFSET#=ARG.OFFSET(NO_ARGS-1);

  10882  5 004212   077777 222110                    LDX2    -1,X0,PR0
         5 004213   002371 471400 1                  LDP1    FPT$
         5 004214   100014 742100                    STX2    12,,PR1

     1438    10883    3               IF ARG.TYPE(0)=%LAST THEN

  10883  5 004215   000000 721100                    LXL1    0,,PR0
         5 004216   000015 101003                    CMPX1   13,DU
         5 004217   004223 601000 5                  TNZ     s:10887

     1439    10884
     1440    10885    3                   IPT_FAS.V.RECORD_NUMBER#=-1;

  10885  5 004220   000001 335007                    LCA     1,DL
         5 004221   100012 755100                    STA     10,,PR1
         5 004222   004234 710000 5                  TRA     s:10891

     1441    10886    3               ELSE
     1442    10887    3                   IF ARG.TYPE(0)=%FIRST THEN

  10887  5 004223   000012 101003                    CMPX1   10,DU
         5 004224   004230 601000 5                  TNZ     s:10890

     1443    10888    3                       IPT_FAS.V.RECORD_NUMBER#=1;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:211  

  10888  5 004225   000001 235007                    LDA     1,DL
         5 004226   100012 755100                    STA     10,,PR1
         5 004227   004234 710000 5                  TRA     s:10891

     1444    10889    3                   ELSE
     1445    10890    3                       IPT_FAS.V.RECORD_NUMBER#=A1(0);

  10890  5 004230   200003 473500                    LDP3    @A1,,AUTO
         5 004231   000100 100500                    MLR     fill='000'O
         5 004232   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         5 004233   100012 000004                    ADSC9   10,,PR1                  cn=0,n=4

     1446    10891    3               IF NO_ARGS>2 AND ARG.TYPE(1)=%RECORD_NAME THEN

  10891  5 004234   000012 235000 1                  LDA     NO_ARGS
         5 004235   000002 115007                    CMPA    2,DL
         5 004236   004245 604400 5                  TMOZ    s:10894
         5 004237   000001 721100                    LXL1    1,,PR0
         5 004240   000041 101003                    CMPX1   33,DU
         5 004241   004245 601000 5                  TNZ     s:10894

     1447    10892    3                   IPT_FAS.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10892  5 004242   000001 223100                    LDX3    1,,PR0
         5 004243   100013 743100                    STX3    11,,PR1
         5 004244   004247 710000 5                  TRA     s:10895

     1448    10893    3               ELSE
     1449    10894    3                   IPT_FAS.V.RC.RC_OFFSET#=NULL_OFFSET;

  10894  5 004245   002365 721000 1                  LXL1    NULL_OFFSET
         5 004246   100013 741100                    STX1    11,,PR1

     1450    10895    3               CALL CHK_RETAIN(IPT_FAS.V.RLCW,0);

  10895  5 004247   000074 236000 6                  LDQ     60
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:212  
         5 004250   200034 756100                    STQ     @RLCW+1,,AUTO
         5 004251   002371 236000 1                  LDQ     FPT$
         5 004252   000015 036003                    ADLQ    13,DU
         5 004253   200033 756100                    STQ     @B+1,,AUTO
         5 004254   001530 701000 5                  TSX1    CHK_RETAIN
         5 004255   000000 011000                    NOP     0

     1451    10896    3               IF NO_ARGS>3 THEN CALL ARG_ERROR(130);

  10896  5 004256   000012 235000 1                  LDA     NO_ARGS
         5 004257   000003 115007                    CMPA    3,DL
         5 004260   004265 604400 5                  TMOZ    s:10897

  10896  5 004261   000137 236000 6                  LDQ     95
         5 004262   200037 756100                    STQ     @A+2,,AUTO
         5 004263   000716 701000 5                  TSX1    ARG_ERROR
         5 004264   000000 011000                    NOP     0

     1452    10897    4               DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);

  10897  5 004265   002372 470400 1                  LDP0    ARG$
         5 004266   000012 720000 1                  LXL0    NO_ARGS
         5 004267   077777 236110                    LDQ     -1,X0,PR0
         5 004270   777777 376007                    ANQ     -1,DL
         5 004271   000037 136007                    SBLQ    31,DL
         5 004272   000002 116007                    CMPQ    2,DL
         5 004273   004275 602006 5                  TNC     s:10897+8,QL
         5 004274   004341 710000 5                  TRA     s:10936
         5 004275   004277 710000 5                  TRA     s:10900
         5 004276   004330 710000 5                  TRA     s:10920

     1453    10898
     1454    10899    4               CASE(%AREA_NAME_NET);

     1455    10900    4                   IPT_FAA.V_ = VECTOR(IPT_FAA.V);

  10900  5 004277   000113 235000 6                  LDA     75
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:213  
         5 004300   002371 236000 1                  LDQ     FPT$
         5 004301   000012 036003                    ADLQ    10,DU
         5 004302   002371 471400 1                  LDP1    FPT$
         5 004303   100000 757100                    STAQ    0,,PR1

     1456    10901    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10901  5 004304   002375 473400 1                  LDP3    RLCW$
         5 004305   300000 236100                    LDQ     0,,PR3
         5 004306   000377 316007                    CANQ    255,DL
         5 004307   004324 600000 5                  TZE     s:10913

     1457    10902    5                       VBOUND(IPT_FAA.V_) = VBOUND(IPT_FAA.V_) +

  10902  5 004310   100000 236100                    LDQ     0,,PR1
         5 004311   000020 772000                    QRL     16
         5 004312   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 004313   300000 236100                    LDQ     0,,PR3
         5 004314   000002 736000                    QLS     2
         5 004315   001774 376007                    ANQ     1020,DL
         5 004316   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 004317   000004 136007                    SBLQ    4,DL
         5 004320   000020 736000                    QLS     16
         5 004321   100000 676100                    ERQ     0,,PR1
         5 004322   000000 376000 6                  ANQ     0
         5 004323   100000 656100                    ERSQ    0,,PR1

     1458    10903    5                          SIZEC(IPT_FAA.V.RETENTION_LIST) * (RLCW_SAVE.N_SETS#-1);
     1459    10904    5                       END;

     1460    10905                        %CLIMB(FCN=FAA);

  10913  5 004324   100000 630500                    EPPR0   0,,PR1
         5 004325   000000 713400 xsym               CLIMB   I$FAA
         5 004326   402000 600000 xsid               climb   nvectors=         5
         5 004327   004345 710000 5                  TRA     s:10944

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:214  
     1461    10919    4               CASE(%SET_NAME_NET);

     1462    10920    4                   IPT_FAS.V_ = VECTOR(IPT_FAS.V);

  10920  5 004330   000113 235000 6                  LDA     75
         5 004331   002371 236000 1                  LDQ     FPT$
         5 004332   000012 036003                    ADLQ    10,DU
         5 004333   002371 471400 1                  LDP1    FPT$
         5 004334   100000 757100                    STAQ    0,,PR1

     1463    10921                        %CLIMB(FCN=FAS);

  10929  5 004335   100000 630500                    EPPR0   0,,PR1
         5 004336   000000 713400 xsym               CLIMB   I$FAS
         5 004337   402000 600000 xsid               climb   nvectors=         5
         5 004340   004345 710000 5                  TRA     s:10944

     1464    10935    4               CASE(ELSE);

     1465    10936    4                   CALL ARG_ERROR(130);

  10936  5 004341   000137 236000 6                  LDQ     95
         5 004342   200037 756100                    STQ     @A+2,,AUTO
         5 004343   000716 701000 5                  TSX1    ARG_ERROR
         5 004344   000000 011000                    NOP     0

     1466    10937        /*E*  ERROR: ZII-130-1
     1467    10938              MESSAGE: Argument count error, or the last argument in
     1468    10939                       CALL FIND(FIRST/LAST/FORT-VAR,[REC-NAME],SET-NAME/AREA-NAME)
     1469    10940                       is neither a SET-NAME nor an AREA-NAME. */
     1470    10941    4                   END;

     1471    10942    3               END;

     1472    10943    2           END;

     1473    10944    1       GOTO COMMON_RETURN;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:215  

  10944  5 004345   005017 710000 5                  TRA     COMMON_RETURN

     1474    10945         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:216  
     1475    10946        /***************************************************************/
     1476    10947        /*                                                             */
     1477    10948        /*     CALLING SEQUENCE FOR GET:                               */
     1478    10949        /*          1. CALL GET                                        */
     1479    10950        /*          2. CALL GET(REC-NAME)                              */
     1480    10951        /*          3. CALL GET(FIELD-1,[FIELD-2],.....])              */
     1481    10952        /*                                                             */
     1482    10953        /***************************************************************/
     1483    10954
     1484    10955    1   GET: ENTRY(

  10955  5 004346   000000 700200 xent  GET          TSX0  ! X66_AUTO_N
         5 004347   000106 000024                    ZERO    70,20

     1485    10956               %GEN_PARAMS;
     1486    11497
     1487    11498    1       CALL SET_ARGS;

  11498  5 004350   000535 701000 5                  TSX1    SET_ARGS
         5 004351   000000 011000                    NOP     0

     1488    11499    1       IF NO_ARGS>0 AND ARG.TYPE(0)=%FIELD_NAME THEN

  11499  5 004352   000012 235000 1                  LDA     NO_ARGS
         5 004353   004435 604400 5                  TMOZ    s:11531
         5 004354   002372 470400 1                  LDP0    ARG$
         5 004355   000000 720100                    LXL0    0,,PR0
         5 004356   000042 100003                    CMPX0   34,DU
         5 004357   004435 601000 5                  TNZ     s:11531

     1489    11500    2       DO;

     1490    11501    2           IPT_GTF.V.FLCW.N_FIELDS#=NO_ARGS;

  11501  5 004360   000000 621005                    EAX1    0,AL
         5 004361   002371 471400 1                  LDP1    FPT$
         5 004362   100012 741100                    STX1    10,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:217  

     1491    11502    3           DO I=0 TO NO_ARGS-1;

  11502  5 004363   000003 450000 1                  STZ     I
         5 004364   004404 710000 5                  TRA     s:11508+1

     1492    11503    3               IF ARG.TYPE(I)~=%FIELD_NAME THEN CALL ARG_ERROR(140);

  11503  5 004365   002372 470400 1                  LDP0    ARG$
         5 004366   000003 720000 1                  LXL0    I
         5 004367   000000 721110                    LXL1    0,X0,PR0
         5 004370   000042 101003                    CMPX1   34,DU
         5 004371   004376 600000 5                  TZE     s:11507

  11503  5 004372   000141 236000 6                  LDQ     97
         5 004373   200037 756100                    STQ     @A+2,,AUTO
         5 004374   000716 701000 5                  TSX1    ARG_ERROR
         5 004375   000000 011000                    NOP     0

     1493    11504        /*E*  ERROR: ZII-140-1
     1494    11505              MESSAGE: The argument list in GET CALL does not contain FIELD-NAMES.
     1495    11506                       The correct syntax is CALL GET(FIELD-NAME,....). */
     1496    11507    3               IPT_GTF.V.FIELD_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I);

  11507  5 004376   002372 470400 1                  LDP0    ARG$
         5 004377   000003 720000 1                  LXL0    I
         5 004400   000000 221110                    LDX1    0,X0,PR0
         5 004401   002371 471400 1                  LDP1    FPT$
         5 004402   100013 741110                    STX1    11,X0,PR1

     1497    11508    3               END;

  11508  5 004403   000003 054000 1                  AOS     I
         5 004404   000003 236000 1                  LDQ     I
         5 004405   000012 116000 1                  CMPQ    NO_ARGS
         5 004406   004365 604000 5                  TMI     s:11503

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:218  
     1498    11509    2           IPT_GTF.V_ = VECTOR(IPT_GTF.V);

  11509  5 004407   000012 235000 6                  LDA     10
         5 004410   002371 236000 1                  LDQ     FPT$
         5 004411   000012 036003                    ADLQ    10,DU
         5 004412   100000 757100                    STAQ    0,,PR1

     1499    11510    3           IF NO_ARGS > 1 THEN DO;

  11510  5 004413   000012 235000 1                  LDA     NO_ARGS
         5 004414   000001 115007                    CMPA    1,DL
         5 004415   004431 604400 5                  TMOZ    s:11522

     1500    11511    3               VBOUND(IPT_GTF.V_) = VBOUND(IPT_GTF.V_) +

  11511  5 004416   100000 236100                    LDQ     0,,PR1
         5 004417   000020 772000                    QRL     16
         5 004420   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 004421   000012 236000 1                  LDQ     NO_ARGS
         5 004422   000002 736000                    QLS     2
         5 004423   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 004424   000004 136007                    SBLQ    4,DL
         5 004425   000020 736000                    QLS     16
         5 004426   100000 676100                    ERQ     0,,PR1
         5 004427   000000 376000 6                  ANQ     0
         5 004430   100000 656100                    ERSQ    0,,PR1

     1501    11512    3                  SIZEC(IPT_GTF.V.FIELD_LIST) * (NO_ARGS-1);
     1502    11513    3               END;

     1503    11514                %CLIMB(FCN=GTF);

  11522  5 004431   100000 630500                    EPPR0   0,,PR1
         5 004432   000000 713400 xsym               CLIMB   I$GTF
         5 004433   402000 600000 xsid               climb   nvectors=         5

     1504    11528    2           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:219  

  11528  5 004434   004466 710000 5                  TRA     s:11556

     1505    11529    1       ELSE
     1506    11530    2       DO;

     1507    11531    2           IF NO_ARGS=0 THEN

  11531  5 004435   000000 115003                    CMPA    0,DU
         5 004436   004443 601000 5                  TNZ     s:11534

     1508    11532    2               IPT_GET.V.RC.RC_OFFSET#=NULL_OFFSET;

  11532  5 004437   002365 720000 1                  LXL0    NULL_OFFSET
         5 004440   002371 470400 1                  LDP0    FPT$
         5 004441   000012 740100                    STX0    10,,PR0
         5 004442   004457 710000 5                  TRA     s:11540

     1509    11533    2           ELSE
     1510    11534    2               IF ARG.TYPE(0)=%RECORD_NAME THEN

  11534  5 004443   002372 470400 1                  LDP0    ARG$
         5 004444   000000 720100                    LXL0    0,,PR0
         5 004445   000041 100003                    CMPX0   33,DU
         5 004446   004453 601000 5                  TNZ     s:11536

     1511    11535    2                   IPT_GET.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  11535  5 004447   000000 221100                    LDX1    0,,PR0
         5 004450   002371 471400 1                  LDP1    FPT$
         5 004451   100012 741100                    STX1    10,,PR1
         5 004452   004457 710000 5                  TRA     s:11540

     1512    11536    2               ELSE CALL ARG_ERROR(145);

  11536  5 004453   000143 236000 6                  LDQ     99
         5 004454   200037 756100                    STQ     @A+2,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:220  
         5 004455   000716 701000 5                  TSX1    ARG_ERROR
         5 004456   000000 011000                    NOP     0

     1513    11537        /*E*  ERROR: ZII-145-1
     1514    11538              MESSAGE: Unknown 1st argument in GET CALL.
     1515    11539                       It is neither a RECORD-NAME nor a FIELD-NAME.  */
     1516    11540    2           IPT_GET.V_ = VECTOR(IPT_GET.V);

  11540  5 004457   000012 235000 6                  LDA     10
         5 004460   002371 236000 1                  LDQ     FPT$
         5 004461   000012 036003                    ADLQ    10,DU
         5 004462   002371 470400 1                  LDP0    FPT$
         5 004463   000000 757100                    STAQ    0,,PR0

     1517    11541                %CLIMB(FCN=GET);

  11549  5 004464   000000 713400 xsym               CLIMB   I$GET
         5 004465   402000 600000 xsid               climb   nvectors=         5

     1518    11555    2           END;

     1519    11556    1       GOTO COMMON_RETURN;

  11556  5 004466   005017 710000 5                  TRA     COMMON_RETURN

     1520    11557         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:221  
     1521    11558    1   MODIFY: ENTRY(

  11558  5 004467   000000 700200 xent  MODIFY       TSX0  ! X66_AUTO_N
         5 004470   000106 000024                    ZERO    70,20

     1522    11559               %GEN_PARAMS;
     1523    12100
     1524    12101        /******************************************************************/
     1525    12102        /*                                                                */
     1526    12103        /*    CALL MODIFY([REC-NAME],[INCLUDING,ALL             ])        */
     1527    12104        /*                           ONLY      SET-NAME1,[...]            */
     1528    12105        /*                                                                */
     1529    12106        /*    CALL MODIFY(IDENT-1,[IDENT-2],...,,[INCLUDING,ALL       ])  */
     1530    12107        /*                                                SET-NAME-LIST   */
     1531    12108        /*                                                                */
     1532    12109        /******************************************************************/
     1533    12110
     1534    12111    1       CALL SET_ARGS;

  12111  5 004471   000535 701000 5                  TSX1    SET_ARGS
         5 004472   000000 011000                    NOP     0

     1535    12112    1       IPT_MOD.V.RC.RC_OFFSET#=NULL_OFFSET;

  12112  5 004473   002365 720000 1                  LXL0    NULL_OFFSET
         5 004474   002371 470400 1                  LDP0    FPT$
         5 004475   000012 740100                    STX0    10,,PR0

     1536    12113    1       IF NO_ARGS>0 THEN

  12113  5 004476   000012 235000 1                  LDA     NO_ARGS
         5 004477   004650 604400 5                  TMOZ    s:12166

     1537    12114    2       DO;

     1538    12115    2           K=0;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:222  
  12115  5 004500   000004 450000 1                  STZ     K

     1539    12116    2           KK = 0; /* count dynamic structures */

  12116  5 004501   000356 450000 1                  STZ     KK

     1540    12117    2           IF ARG.TYPE(0)=%RECORD_NAME THEN

  12117  5 004502   002372 471400 1                  LDP1    ARG$
         5 004503   100000 721100                    LXL1    0,,PR1
         5 004504   000041 101003                    CMPX1   33,DU
         5 004505   004514 601000 5                  TNZ     s:12125

     1541    12118    3           DO;

     1542    12119    3               K=1;

  12119  5 004506   000001 236007                    LDQ     1,DL
         5 004507   000004 756000 1                  STQ     K

     1543    12120    3               KK = 1;

  12120  5 004510   000356 756000 1                  STQ     KK

     1544    12121    3               IPT_MOD.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  12121  5 004511   100000 222100                    LDX2    0,,PR1
         5 004512   000012 742100                    STX2    10,,PR0

     1545    12122    3               END;

  12122  5 004513   004537 710000 5                  TRA     s:12132

     1546    12123    2           ELSE
     1547    12124    3           DO;

     1548    12125    4               DO WHILE(ARG.TYPE(K)=%FIELD_NAME AND K<NO_ARGS);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:223  

  12125  5 004514   004527 710000 5                  TRA     s:12130

     1549    12126    4                   IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(K)=ARG.OFFSET(K);

  12126  5 004515   002372 470400 1                  LDP0    ARG$
         5 004516   000004 720000 1                  LXL0    K
         5 004517   000000 221110                    LDX1    0,X0,PR0
         5 004520   002371 471400 1                  LDP1    FPT$
         5 004521   100016 741110                    STX1    14,X0,PR1

     1550    12127    4                   IPT_MOD.V.FLCW.N_FIELDS#=IPT_MOD.V.FLCW.N_FIELDS#+1;

  12127  5 004522   100014 222100                    LDX2    12,,PR1
         5 004523   000001 623012                    EAX3    1,X2
         5 004524   100014 743100                    STX3    12,,PR1

     1551    12128    4                   K=K+1;

  12128  5 004525   000004 054000 1                  AOS     K

     1552    12129    4                   KK = KK + 1;

  12129  5 004526   000356 054000 1                  AOS     KK

     1553    12130    4                   END;

  12130  5 004527   002372 470400 1                  LDP0    ARG$
         5 004530   000004 720000 1                  LXL0    K
         5 004531   000000 721110                    LXL1    0,X0,PR0
         5 004532   000042 101003                    CMPX1   34,DU
         5 004533   004537 601000 5                  TNZ     s:12132
         5 004534   000004 236000 1                  LDQ     K
         5 004535   000012 116000 1                  CMPQ    NO_ARGS
         5 004536   004515 604000 5                  TMI     s:12126

     1554    12131    3               END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:224  

     1555    12132    2           IF K<NO_ARGS-1 AND (ARG.TYPE(K)=SNA.ONLY OR ARG.TYPE(K)=SNA.INCLUDING) THEN

  12132  5 004537   000012 236000 1                  LDQ     NO_ARGS
         5 004540   000001 136007                    SBLQ    1,DL
         5 004541   000004 116000 1                  CMPQ    K
         5 004542   004641 604400 5                  TMOZ    s:12162
         5 004543   002372 470400 1                  LDP0    ARG$
         5 004544   000004 720000 1                  LXL0    K
         5 004545   000000 236110                    LDQ     0,X0,PR0
         5 004546   777777 376007                    ANQ     -1,DL
         5 004547   000015 116000 0                  CMPQ    SNA+13
         5 004550   004553 600000 5                  TZE     s:12134
         5 004551   000007 116000 0                  CMPQ    SNA+7
         5 004552   004641 601000 5                  TNZ     s:12162

     1556    12133    3           DO;

     1557    12134    3               IF ARG.TYPE(K)=SNA.ONLY THEN

  12134  5 004553   000015 116000 0                  CMPQ    SNA+13
         5 004554   004566 601000 5                  TNZ     s:12142

     1558    12135    4               DO;

     1559    12136    4                   IPT_MOD.V.MCW.MC_BIT0#='1'B;

  12136  5 004555   002371 471400 1                  LDP1    FPT$
         5 004556   400000 236003                    LDQ     -131072,DU
         5 004557   100013 256100                    ORSQ    11,,PR1

     1560    12137    4                   IF IPT_MOD.V.FLCW.N_FIELDS#>0 THEN CALL ARG_ERROR(153);

  12137  5 004560   100014 221100                    LDX1    12,,PR1
         5 004561   004566 604400 5                  TMOZ    s:12142

  12137  5 004562   000145 236000 6                  LDQ     101
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:225  
         5 004563   200037 756100                    STQ     @A+2,,AUTO
         5 004564   000716 701000 5                  TSX1    ARG_ERROR
         5 004565   000000 011000                    NOP     0

     1561    12138    4                   END;

     1562    12139        /*E*  ERROR: ZII-153-1
     1563    12140              MESSAGE: Keyword ONLY not legal in MODIFY CALL
     1564    12141                       in conjunction with FIELD-NAME list.  */
     1565    12142    3               K=K+1;

  12142  5 004566   000004 054000 1                  AOS     K

     1566    12143    3               IF ARG.TYPE(K)=SNA.ALL THEN

  12143  5 004567   002372 470400 1                  LDP0    ARG$
         5 004570   000004 720000 1                  LXL0    K
         5 004571   000000 236110                    LDQ     0,X0,PR0
         5 004572   777777 376007                    ANQ     -1,DL
         5 004573   000000 116000 0                  CMPQ    SNA
         5 004574   004601 601000 5                  TNZ     s:12147

     1567    12144    3                   IPT_MOD.V.MCW.MC_BIT1#='1'B;

  12144  5 004575   002371 471400 1                  LDP1    FPT$
         5 004576   200000 236003                    LDQ     65536,DU
         5 004577   100013 256100                    ORSQ    11,,PR1
         5 004600   004650 710000 5                  TRA     s:12166

     1568    12145    3               ELSE
     1569    12146    4               DO;

     1570    12147    5                   DO WHILE (K<NO_ARGS);

  12147  5 004601   000004 236000 1                  LDQ     K
         5 004602   000012 116000 1                  CMPQ    NO_ARGS
         5 004603   004650 605000 5                  TPL     s:12166
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:226  

     1571    12148    5                       IF ARG.TYPE(K)~=%SET_NAME THEN CALL ARG_ERROR(150);

  12148  5 004604   002372 470400 1                  LDP0    ARG$
         5 004605   000004 720000 1                  LXL0    K
         5 004606   000000 721110                    LXL1    0,X0,PR0
         5 004607   000040 101003                    CMPX1   32,DU
         5 004610   004615 600000 5                  TZE     s:12152

  12148  5 004611   000147 236000 6                  LDQ     103
         5 004612   200037 756100                    STQ     @A+2,,AUTO
         5 004613   000716 701000 5                  TSX1    ARG_ERROR
         5 004614   000000 011000                    NOP     0

     1572    12149        /*E*  ERROR: ZII-150-1
     1573    12150              MESSAGE: Bad arguments found in MODIFY CALL
     1574    12151                       after keyword ONLY/INCLUDING.              */
     1575    12152    5                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#

  12152  5 004615   002371 470400 1                  LDP0    FPT$
         5 004616   000015 236100                    LDQ     13,,PR0
         5 004617   000022 732000                    QRS     18
         5 004620   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 004621   000014 236100                    LDQ     12,,PR0
         5 004622   000022 732000                    QRS     18
         5 004623   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 004624   002372 471400 1                  LDP1    ARG$
         5 004625   000004 720000 1                  LXL0    K
         5 004626   100000 221110                    LDX1    0,X0,PR1
         5 004627   000016 741106                    STX1    14,QL,PR0

     1576    12153    5                          (IPT_MOD.V.FLCW.N_FIELDS#+IPT_MOD.V.SLCW.N_SETS#)
     1577    12154    5                          =ARG.OFFSET(K);
     1578    12155    5                       IPT_MOD.V.SLCW.N_SETS#=IPT_MOD.V.SLCW.N_SETS#+1;

  12155  5 004630   000015 221100                    LDX1    13,,PR0
         5 004631   000001 622011                    EAX2    1,X1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:227  
         5 004632   000015 742100                    STX2    13,,PR0

     1579    12156    5                       K=K+1;

  12156  5 004633   000004 054000 1                  AOS     K

     1580    12157    5                       KK = KK + 1;

  12157  5 004634   000356 054000 1                  AOS     KK

     1581    12158    5                       END;

  12158  5 004635   000004 236000 1                  LDQ     K
         5 004636   000012 116000 1                  CMPQ    NO_ARGS
         5 004637   004604 604000 5                  TMI     s:12148

     1582    12159    4                   END;

     1583    12160    3               END;

  12160  5 004640   004650 710000 5                  TRA     s:12166

     1584    12161    2           ELSE
     1585    12162    2               IF K<NO_ARGS THEN CALL ARG_ERROR(155);

  12162  5 004641   000004 236000 1                  LDQ     K
         5 004642   000012 116000 1                  CMPQ    NO_ARGS
         5 004643   004650 605000 5                  TPL     s:12166

  12162  5 004644   000151 236000 6                  LDQ     105
         5 004645   200037 756100                    STQ     @A+2,,AUTO
         5 004646   000716 701000 5                  TSX1    ARG_ERROR
         5 004647   000000 011000                    NOP     0

     1586    12163        /*E*  ERROR: ZII-155-1
     1587    12164              MESSAGE: Bad arguments found in MODIFY CALL.  */
     1588    12165    2           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:228  

     1589    12166    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);

  12166  5 004650   000113 235000 6                  LDA     75
         5 004651   002371 236000 1                  LDQ     FPT$
         5 004652   000012 036003                    ADLQ    10,DU
         5 004653   002371 470400 1                  LDP0    FPT$
         5 004654   000000 757100                    STAQ    0,,PR0

     1590    12167    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);

  12167  5 004655   000113 235000 6                  LDA     75
         5 004656   002371 236000 1                  LDQ     FPT$
         5 004657   000012 036003                    ADLQ    10,DU
         5 004660   000000 757100                    STAQ    0,,PR0

     1591    12168    2       IF KK ~= 0 THEN DO;

  12168  5 004661   000356 235000 1                  LDA     KK
         5 004662   004676 600000 5                  TZE     s:12180

     1592    12169    2           VBOUND(IPT_MOD.V_) = VBOUND(IPT_MOD.V_) +

  12169  5 004663   000000 236100                    LDQ     0,,PR0
         5 004664   000020 772000                    QRL     16
         5 004665   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 004666   000356 236000 1                  LDQ     KK
         5 004667   000002 736000                    QLS     2
         5 004670   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 004671   000004 136007                    SBLQ    4,DL
         5 004672   000020 736000                    QLS     16
         5 004673   000000 676100                    ERQ     0,,PR0
         5 004674   000000 376000 6                  ANQ     0
         5 004675   000000 656100                    ERSQ    0,,PR0

     1593    12170    2              SIZEC(IPT_MOD.V.FL_SL_LIST) * (KK-1);
     1594    12171    2           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:229  

     1595    12172            %CLIMB(FCN=MOD);

  12180  5 004676   000000 713400 xsym               CLIMB   I$MOD
         5 004677   402000 600000 xsid               climb   nvectors=         5

     1596    12186    1       GOTO COMMON_RETURN;

  12186  5 004700   005017 710000 5                  TRA     COMMON_RETURN

     1597    12187         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:230  
     1598    12188        /**   INTERNAL COMMON SUBROUTINE FOR CONNECT AND DISCONNECT   **/
     1599    12189
     1600    12190    1   CON_DIS: PROC ALTRET;

  12190  5 004701   200030 741300       CON_DIS      STX1  ! FIT$+1,,AUTO

     1601    12191
     1602    12192    2       CALL SET_ARGS;

  12192  5 004702   000535 701000 5                  TSX1    SET_ARGS
         5 004703   000000 011000                    NOP     0

     1603    12193
     1604    12194    3       DO CASE(NO_ARGS);

  12194  5 004704   000012 235000 1                  LDA     NO_ARGS
         5 004705   000003 115007                    CMPA    3,DL
         5 004706   004710 602005 5                  TNC     s:12194+4,AL
         5 004707   004754 710000 5                  TRA     s:12212
         5 004710   004754 710000 5                  TRA     s:12212
         5 004711   004735 710000 5                  TRA     s:12205
         5 004712   004713 710000 5                  TRA     s:12197

     1605    12195
     1606    12196    3       CASE(2);

     1607    12197    3           IF ARG.TYPE(0)~=%RECORD_NAME OR ARG.TYPE(1)~=%SET_NAME THEN CALL ARG_ERROR(
             12197                    160);

  12197  5 004713   002372 470400 1                  LDP0    ARG$
         5 004714   000000 720100                    LXL0    0,,PR0
         5 004715   000041 100003                    CMPX0   33,DU
         5 004716   004722 601000 5                  TNZ     s:12197+7
         5 004717   000001 721100                    LXL1    1,,PR0
         5 004720   000040 101003                    CMPX1   32,DU
         5 004721   004726 600000 5                  TZE     s:12202

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:231  
  12197  5 004722   000153 236000 6                  LDQ     107
         5 004723   200037 756100                    STQ     @ERR_NO,,AUTO
         5 004724   000716 701000 5                  TSX1    ARG_ERROR
         5 004725   000000 011000                    NOP     0

     1608    12198        /*E*  ERROR: ZII-160-1
     1609    12199              MESSAGE: Bad arguments found in CONNECT/DISCONNECT CALL.
     1610    12200                       The correct syntax is
     1611    12201                       CALL CONNECT/DISCONNECT(RECORD-NAME,SET-NAME). */
     1612    12202    3           IPT_CON.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  12202  5 004726   002372 470400 1                  LDP0    ARG$
         5 004727   000000 220100                    LDX0    0,,PR0
         5 004730   002371 471400 1                  LDP1    FPT$
         5 004731   100012 740100                    STX0    10,,PR1

     1613    12203    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  12203  5 004732   000001 221100                    LDX1    1,,PR0
         5 004733   100013 741100                    STX1    11,,PR1
         5 004734   004760 710000 5                  TRA     s:12216

     1614    12204    3       CASE(1);

     1615    12205    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(165);

  12205  5 004735   002372 470400 1                  LDP0    ARG$
         5 004736   000000 720100                    LXL0    0,,PR0
         5 004737   000040 100003                    CMPX0   32,DU
         5 004740   004745 600000 5                  TZE     s:12209

  12205  5 004741   000155 236000 6                  LDQ     109
         5 004742   200037 756100                    STQ     @ERR_NO,,AUTO
         5 004743   000716 701000 5                  TSX1    ARG_ERROR
         5 004744   000000 011000                    NOP     0

     1616    12206        /*E*  ERROR: ZII-165-1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:232  
     1617    12207              MESSAGE: The only argument in CONNECT/DISCONNECT CALL
     1618    12208                       is not a SET-NAME.  */
     1619    12209    3           IPT_CON.V.RC.RC_OFFSET#=NULL_OFFSET;

  12209  5 004745   002365 720000 1                  LXL0    NULL_OFFSET
         5 004746   002371 470400 1                  LDP0    FPT$
         5 004747   000012 740100                    STX0    10,,PR0

     1620    12210    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(0);

  12210  5 004750   002372 471400 1                  LDP1    ARG$
         5 004751   100000 221100                    LDX1    0,,PR1
         5 004752   000013 741100                    STX1    11,,PR0
         5 004753   004760 710000 5                  TRA     s:12216

     1621    12211    3       CASE(ELSE);

     1622    12212    3           CALL ARG_ERROR(170);

  12212  5 004754   000157 236000 6                  LDQ     111
         5 004755   200037 756100                    STQ     @ERR_NO,,AUTO
         5 004756   000716 701000 5                  TSX1    ARG_ERROR
         5 004757   000000 011000                    NOP     0

     1623    12213        /*E*  ERROR: ZII-170-1
     1624    12214              MESSAGE: Wrong number of arguments in CONNECT/DISCONNECT CALL. */
     1625    12215    3           END;

     1626    12216    2   END CON_DIS;

  12216  5 004760   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 004761   000001 702211                    TSX2  ! 1,X1

     1627    12217
     1628    12218    1   CONNECT: ENTRY(A1,A2);

  12218  5 004762   000000 700200 xent  CONNECT      TSX0  ! X66_AUTO_N
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:233  
         5 004763   000106 000024                    ZERO    70,20

     1629    12219
     1630    12220    1       IPT_CON.V_ = VECTOR(IPT_CON.V);

  12220  5 004764   000012 235000 6                  LDA     10
         5 004765   002371 236000 1                  LDQ     FPT$
         5 004766   000012 036003                    ADLQ    10,DU
         5 004767   002371 470400 1                  LDP0    FPT$
         5 004770   000000 757100                    STAQ    0,,PR0

     1631    12221    1       CALL CON_DIS;

  12221  5 004771   004701 701000 5                  TSX1    CON_DIS
         5 004772   000000 011000                    NOP     0

     1632    12222            %CLIMB(FCN=CON);

  12230  5 004773   002371 470400 1                  LDP0    FPT$
         5 004774   000000 713400 xsym               CLIMB   I$CON
         5 004775   402000 600000 xsid               climb   nvectors=         5

     1633    12236    1       GOTO COMMON_RETURN;

  12236  5 004776   005017 710000 5                  TRA     COMMON_RETURN

     1634    12237
     1635    12238    1   DISCONNECT: ENTRY(A1,A2);

  12238  5 004777   000000 700200 xent  DISCONNECT   TSX0  ! X66_AUTO_N
         5 005000   000106 000024                    ZERO    70,20
         5 005001   005004 710000 5                  TRA     s:12241

     1636    12239    1   DISCONNE: ENTRY(A1,A2);

  12239  5 005002   000000 700200 xent  DISCONNE     TSX0  ! X66_AUTO_N
         5 005003   000106 000024                    ZERO    70,20
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:234  

     1637    12240
     1638    12241    1       IPT_DIS.V_ = VECTOR(IPT_DIS.V);

  12241  5 005004   000012 235000 6                  LDA     10
         5 005005   002371 236000 1                  LDQ     FPT$
         5 005006   000012 036003                    ADLQ    10,DU
         5 005007   002371 470400 1                  LDP0    FPT$
         5 005010   000000 757100                    STAQ    0,,PR0

     1639    12242    1       CALL CON_DIS;

  12242  5 005011   004701 701000 5                  TSX1    CON_DIS
         5 005012   000000 011000                    NOP     0

     1640    12243            %CLIMB(FCN=DIS);

  12251  5 005013   002371 470400 1                  LDP0    FPT$
         5 005014   000000 713400 xsym               CLIMB   I$DIS
         5 005015   402000 600000 xsid               climb   nvectors=         5

     1641    12257    1       GOTO COMMON_RETURN;

  12257  5 005016   005017 710000 5                  TRA     COMMON_RETURN

     1642    12258         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:235  
     1643    12259    1   COMMON_RETURN: /*  CHK IA(7) SEE IF ANY CLEAN-UP TO DO */
     1644    12260
     1645    12261    1       IDSSYSERR = PINCRW(IA$,5) -> SBIN36; /* MON ERR_CODE */

  12261  5 005017   002366 470400 1     COMMON_RETU* LDP0    IA$
         5 005020   000005 235100                    LDA     5,,PR0
         5 005021   000002 755000 1                  STA     IDSSYSERR

     1646    12262    1       IF IA_HALF(14)>0 THEN

  12262  5 005022   000100 101500                    MRL     fill='000'O
         5 005023   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2
         5 005024   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005025   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005026   000000 116003                    CMPQ    0,DU
         5 005027   005044 600000 5                  TZE     s:12269

     1647    12263    2       DO;

     1648    12264    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */

  12264  5 005030   000000 100500                    MLR     fill='000'O
         5 005031   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2
         5 005032   000010 000002 1                  ADSC9   PT$                      cn=0,n=2

     1649    12265    2           IA_HALF(14) = 0; /* RESET FLAG */

  12265  5 005033   000100 101400                    MRL     fill='000'O
         5 005034   000027 000004 6                  ADSC9   23                       cn=0,n=4
         5 005035   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2

     1650    12266    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */

  12266  5 005036   006000 220003                    LDX0    3072,DU
         5 005037   000010 440000 1                  SXL0    PT$

     1651    12267    2           CALL EPTR$;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:236  

  12267  5 005040   000010 221000 1                  LDX1    PT$
         5 005041   000027 631400 6                  EPPR1   23
         5 005042   000000 701011                    TSX1    0,X1
         5 005043   000000 011000                    NOP     0

     1652    12268    2           END;

     1653    12269    1       IF IA_HALF(12)>0 THEN /* RETURN FROM ROLL BACK */

  12269  5 005044   002366 470400 1                  LDP0    IA$
         5 005045   000100 101500                    MRL     fill='000'O
         5 005046   000006 000002                    ADSC9   6,,PR0                   cn=0,n=2
         5 005047   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005050   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005051   000000 116003                    CMPQ    0,DU
         5 005052   005064 600000 5                  TZE     s:12275

     1654    12270    2       DO;

     1655    12271    2           IA_HALF(12)=0; /* RESET FLAG */

  12271  5 005053   000100 101400                    MRL     fill='000'O
         5 005054   000027 000004 6                  ADSC9   23                       cn=0,n=4
         5 005055   000006 000002                    ADSC9   6,,PR0                   cn=0,n=2

     1656    12272    2           DK_RET.RET_ADDR=IA_HALF(13); /* ASL PUT RETADDR THERE */

  12272  5 005056   000000 100500                    MLR     fill='000'O
         5 005057   000006 400002                    ADSC9   6,,PR0                   cn=2,n=2
         5 005060   000007 000002 1                  ADSC9   DEADLOCK_RET+1           cn=0,n=2

     1657    12273    2           UNWIND TO DEADLOCK_RET;

  12273  5 005061   000006 237200 1                  LDAQ  ! DEADLOCK_RET
         5 005062   000000 700200 xent               TSX0  ! X66_AUNWIND
         5 005063   000000 000200                    ZERO    0,128
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:237  

     1658    12274    2           END;
     1659    12275    1       RETURN;

  12275  5 005064   000000 702200 xent               TSX2  ! X66_ARET

     1660    12276         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:238  
     1661    12277        /**   COMMON SUBROUTINE FOR IFT OR IST   **/
     1662    12278    1   DO_IF: PROC(A) ALTRET;

  12278  5 005065   200030 741300       DO_IF        STX1  ! FIT$+1,,AUTO

     1663    12279    2   DCL A BIT(2) ALIGNED;
     1664    12280
     1665    12281    2       CALL SET_ARGS;

  12281  5 005066   000535 701000 5                  TSX1    SET_ARGS
         5 005067   000000 011000                    NOP     0

     1666    12282    2       IPT_IST.V.TDW=A;

  12282  5 005070   200031 470500                    LDP0    @A,,AUTO
         5 005071   000000 236100                    LDQ     0,,PR0
         5 005072   600000 376003                    ANQ     -65536,DU
         5 005073   002371 471400 1                  LDP1    FPT$
         5 005074   100012 756100                    STQ     10,,PR1

     1667    12283    3       DO CASE(NO_ARGS);

  12283  5 005075   000012 235000 1                  LDA     NO_ARGS
         5 005076   000003 115007                    CMPA    3,DL
         5 005077   005101 602005 5                  TNC     s:12283+4,AL
         5 005100   005156 710000 5                  TRA     s:12324
         5 005101   005156 710000 5                  TRA     s:12324
         5 005102   005104 710000 5                  TRA     s:12285
         5 005103   005123 710000 5                  TRA     s:12302

     1668    12284    3       CASE(1);

     1669    12285    3           IPT_IFT.V_ = VECTOR(IPT_IFT.V);

  12285  5 005104   000012 235000 6                  LDA     10
         5 005105   002371 236000 1                  LDQ     FPT$
         5 005106   000012 036003                    ADLQ    10,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:239  
         5 005107   100000 757100                    STAQ    0,,PR1

     1670    12286                %CLIMB(FCN=IFT);

  12294  5 005110   100000 630500                    EPPR0   0,,PR1
         5 005111   000000 713400 xsym               CLIMB   I$IFT
         5 005112   402000 600000 xsid               climb   nvectors=         5

     1671    12300    3           A1(0)=-1*UWA(0); /* UWA=0 IF F,1 IF T(FORTRAN WANT -1) */

  12300  5 005113   002367 470400 1                  LDP0    UWA$
         5 005114   000000 336100                    LCQ     0,,PR0
         5 005115   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 005116   200003 471500                    LDP1    @A1,,AUTO
         5 005117   000100 100500                    MLR     fill='000'O
         5 005120   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005121   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         5 005122   005162 710000 5                  TRA     s:12329

     1672    12301    3       CASE(2);

     1673    12302    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(175);

  12302  5 005123   002372 473400 1                  LDP3    ARG$
         5 005124   300000 720100                    LXL0    0,,PR3
         5 005125   000040 100003                    CMPX0   32,DU
         5 005126   005133 600000 5                  TZE     s:12306

  12302  5 005127   000161 236000 6                  LDQ     113
         5 005130   200037 756100                    STQ     @ERR_NO,,AUTO
         5 005131   000716 701000 5                  TSX1    ARG_ERROR
         5 005132   000000 011000                    NOP     0

     1674    12303        /*E*  ERROR: ZII-175-1
     1675    12304              MESSAGE: The 1st argument in IFOWNER/IFMEMBER/IFTENANT CALL
     1676    12305                       is not a SET-NAME but two arguments specified.  */
     1677    12306    3           IPT_IST.V.SC.SC_OFFSET#=ARG.OFFSET(0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:240  

  12306  5 005133   002372 470400 1                  LDP0    ARG$
         5 005134   000000 220100                    LDX0    0,,PR0
         5 005135   002371 471400 1                  LDP1    FPT$
         5 005136   100013 740100                    STX0    11,,PR1

     1678    12307    3           IPT_IST.V_ = VECTOR(IPT_IST.V);

  12307  5 005137   000012 235000 6                  LDA     10
         5 005140   002371 236000 1                  LDQ     FPT$
         5 005141   000012 036003                    ADLQ    10,DU
         5 005142   100000 757100                    STAQ    0,,PR1

     1679    12308                %CLIMB(FCN=IST);

  12316  5 005143   100000 630500                    EPPR0   0,,PR1
         5 005144   000000 713400 xsym               CLIMB   I$IST
         5 005145   402000 600000 xsid               climb   nvectors=         5

     1680    12322    3           A2(0)=-1*UWA(0);

  12322  5 005146   002367 470400 1                  LDP0    UWA$
         5 005147   000000 336100                    LCQ     0,,PR0
         5 005150   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 005151   200004 471500                    LDP1    @A2,,AUTO
         5 005152   000100 100500                    MLR     fill='000'O
         5 005153   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005154   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         5 005155   005162 710000 5                  TRA     s:12329

     1681    12323    3       CASE(ELSE);

     1682    12324    3           CALL ARG_ERROR(180);

  12324  5 005156   000163 236000 6                  LDQ     115
         5 005157   200037 756100                    STQ     @ERR_NO,,AUTO
         5 005160   000716 701000 5                  TSX1    ARG_ERROR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:241  
         5 005161   000000 011000                    NOP     0

     1683    12325        /*E*  ERROR: ZII-180-1
     1684    12326              MESSAGE: Wrong number of arguments in
     1685    12327                       IFOWNER/IFMEMBER/IFTENANT CALL.  */
     1686    12328    3           END;

     1687    12329    2   END DO_IF;

  12329  5 005162   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 005163   000001 702211                    TSX2  ! 1,X1

     1688    12330         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:242  
     1689    12331    1   IFEMPTY: ENTRY(A1,A2);

  12331  5 005164   000000 700200 xent  IFEMPTY      TSX0  ! X66_AUTO_N
         5 005165   000106 000024                    ZERO    70,20

     1690    12332
     1691    12333    1       CALL P_OFF_W(ADDR(A1),RVA$);

  12333  5 005166   200003 236100                    LDQ     @A1,,AUTO
         5 005167   200105 756100                    STQ     ERRMSG_BUF+37,,AUTO
         5 005170   000022 236000 6                  LDQ     18
         5 005171   200040 756100                    STQ     @ERR_NO+1,,AUTO
         5 005172   200105 630500                    EPPR0   ERRMSG_BUF+37,,AUTO
         5 005173   200037 450500                    STP0    @A+2,,AUTO
         5 005174   000003 701000 5                  TSX1    P_OFF_W
         5 005175   000000 011000                    NOP     0

     1692    12334    1       IF I<=0 OR I>RVA_SIZE OR RVA_TYPE(I)~=%SET_NAME_NET THEN CALL ARG_ERROR(185);

  12334  5 005176   000003 235000 1                  LDA     I
         5 005177   005215 604400 5                  TMOZ    s:12334+15
         5 005200   000003 236000 1                  LDQ     I
         5 005201   002364 116000 1                  CMPQ    RVA_SIZE
         5 005202   005215 605400 5                  TPNZ    s:12334+15
         5 005203   000001 735000                    ALS     1
         5 005204   005206 605000 5                  TPL     s:12334+8
         5 005205   000044 035003                    ADLA    36,DU
         5 005206   002376 470400 1                  LDP0    TYPE$
         5 005207   003100 061505                    CSR     bolr='003'O
         5 005210   000000 000002                    BDSC    0,A,PR0                  by=0,bit=0,n=2
         5 005211   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 005212   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005213   000001 116007                    CMPQ    1,DL
         5 005214   005221 600000 5                  TZE     s:12337

  12334  5 005215   000165 236000 6                  LDQ     117
         5 005216   200037 756100                    STQ     @A+2,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:243  
         5 005217   000716 701000 5                  TSX1    ARG_ERROR
         5 005220   000000 011000                    NOP     0

     1693    12335        /*E*  ERROR: ZII-185-1
     1694    12336              MESSAGE: The 1st argument in IFEMPTY CALL is not a SET-NAME. */
     1695    12337    1       IPT_IFM.V.SC.SC_OFFSET#=I;

  12337  5 005221   000003 720000 1                  LXL0    I
         5 005222   002371 470400 1                  LDP0    FPT$
         5 005223   000012 740100                    STX0    10,,PR0

     1696    12338    1       IPT_IFM.V_ = VECTOR(IPT_IFM.V);

  12338  5 005224   000012 235000 6                  LDA     10
         5 005225   002371 236000 1                  LDQ     FPT$
         5 005226   000012 036003                    ADLQ    10,DU
         5 005227   000000 757100                    STAQ    0,,PR0

     1697    12339            %CLIMB(FCN=IFM);

  12347  5 005230   000000 713400 xsym               CLIMB   I$IFM
         5 005231   402000 600000 xsid               climb   nvectors=         5

     1698    12353    1       IF ADDR(A2(0))=ADDR(NIL) THEN CALL ARG_ERROR(190);

  12353  5 005232   200004 236100                    LDQ     @A2,,AUTO
         5 005233   000015 116000 6                  CMPQ    13
         5 005234   005241 601000 5                  TNZ     s:12358

  12353  5 005235   000167 236000 6                  LDQ     119
         5 005236   200037 756100                    STQ     @A+2,,AUTO
         5 005237   000716 701000 5                  TSX1    ARG_ERROR
         5 005240   000000 011000                    NOP     0

     1699    12354        /*E*  ERROR: ZII-190-3
     1700    12355              MESSAGE: Wrong number of arguments in IFEMPTY CALL.
     1701    12356                       The correct syntax is
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:244  
     1702    12357                       CALL IFEMPTY(SET-NAME,LOGIC-RESULT).  */
     1703    12358    1       A2(0)=-1*UWA(0);

  12358  5 005241   002367 470400 1                  LDP0    UWA$
         5 005242   000000 336100                    LCQ     0,,PR0
         5 005243   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 005244   200004 471500                    LDP1    @A2,,AUTO
         5 005245   000100 100500                    MLR     fill='000'O
         5 005246   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005247   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1704    12359    1       GOTO COMMON_RETURN;

  12359  5 005250   005017 710000 5                  TRA     COMMON_RETURN

     1705    12360
     1706    12361    1   IFMEMBER: ENTRY(A1,A2);

  12361  5 005251   000000 700200 xent  IFMEMBER     TSX0  ! X66_AUTO_N
         5 005252   000106 000024                    ZERO    70,20

     1707    12362
     1708    12363    1       CALL DO_IF('01'B);

  12363  5 005253   000171 236000 6                  LDQ     121
         5 005254   200031 756100                    STQ     FIT$+2,,AUTO
         5 005255   005065 701000 5                  TSX1    DO_IF
         5 005256   000000 011000                    NOP     0

     1709    12364    1       GOTO COMMON_RETURN;

  12364  5 005257   005017 710000 5                  TRA     COMMON_RETURN

     1710    12365
     1711    12366    1   IFOWNER: ENTRY(A1,A2);

  12366  5 005260   000000 700200 xent  IFOWNER      TSX0  ! X66_AUTO_N
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:245  
         5 005261   000106 000024                    ZERO    70,20

     1712    12367
     1713    12368    1       CALL DO_IF('10'B);

  12368  5 005262   000173 236000 6                  LDQ     123
         5 005263   200031 756100                    STQ     FIT$+2,,AUTO
         5 005264   005065 701000 5                  TSX1    DO_IF
         5 005265   000000 011000                    NOP     0

     1714    12369    1       GOTO COMMON_RETURN;

  12369  5 005266   005017 710000 5                  TRA     COMMON_RETURN

     1715    12370
     1716    12371    1   IFTENANT: ENTRY(A1,A2);

  12371  5 005267   000000 700200 xent  IFTENANT     TSX0  ! X66_AUTO_N
         5 005270   000106 000024                    ZERO    70,20

     1717    12372
     1718    12373    1       CALL DO_IF('11'B);

  12373  5 005271   000175 236000 6                  LDQ     125
         5 005272   200031 756100                    STQ     FIT$+2,,AUTO
         5 005273   005065 701000 5                  TSX1    DO_IF
         5 005274   000000 011000                    NOP     0

     1719    12374    1       GOTO COMMON_RETURN;

  12374  5 005275   005017 710000 5                  TRA     COMMON_RETURN

     1720    12375        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:246  
     1721    12376    1   BUFFERS: ENTRY(A1,A2);

  12376  5 005276   000000 700200 xent  BUFFERS      TSX0  ! X66_AUTO_N
         5 005277   000106 000024                    ZERO    70,20

     1722    12377
     1723    12378    1       IPT_NBF.BUFFS_REQ_=VECTOR(A1(0));

  12378  5 005300   777640 235007                    LDA     -96,DL
         5 005301   200003 236100                    LDQ     @A1,,AUTO
         5 005302   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005303   000000 757100                    STAQ    0,,PR0

     1724    12379    1       IPT_NBF.BUFFS_ALLOC_=VECTOR(A2(0));

  12379  5 005304   777640 235007                    LDA     -96,DL
         5 005305   200004 236100                    LDQ     @A2,,AUTO
         5 005306   000002 757100                    STAQ    2,,PR0

     1725    12380            %CLIMB(FCN=NBF);

  12388  5 005307   000000 713400 xsym               CLIMB   I$NBF
         5 005310   400400 600000 xsid               climb   nvectors=         2

     1726    12394    1       GOTO COMMON_RETURN;

  12394  5 005311   005017 710000 5                  TRA     COMMON_RETURN

     1727    12395    1   CRPT: ENTRY(A1);

  12395  5 005312   000000 700200 xent  CRPT         TSX0  ! X66_AUTO_N
         5 005313   000106 000024                    ZERO    70,20

     1728    12396
     1729    12397    1       FPT_SHORT.VEC1=VECTOR(FPT_SHORT.VEC2);

  12397  5 005314   000176 237000 6                  LDAQ    126
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:247  
         5 005315   000014 757000 1                  STAQ    FPT_SHORT

     1730    12398    1       ADDR(FPT_SHORT.VEC2)->SBIN36=A1(0); /* MAKE SURE SEED IS DALIGNED */

  12398  5 005316   200003 470500                    LDP0    @A1,,AUTO
         5 005317   000000 100500                    MLR     fill='000'O
         5 005320   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 005321   000016 000004 1                  ADSC9   FPT_SHORT+2              cn=0,n=4

     1731    12399            %CLIMB(FCN=CRPT);

  12407  5 005322   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005323   000000 713400 xsym               CLIMB   I$CRPT
         5 005324   400000 600000 xsid               climb   nvectors=         1

     1732    12413    1       GOTO COMMON_RETURN;

  12413  5 005325   005017 710000 5                  TRA     COMMON_RETURN

     1733    12414
     1734    12415    1   ROLL: ENTRY(A1);

  12415  5 005326   000000 700200 xent  ROLL         TSX0  ! X66_AUTO_N
         5 005327   000106 000024                    ZERO    70,20

     1735    12416
     1736    12417    1       IF ADDR(A1)=ADDR(NIL) THEN

  12417  5 005330   200003 236100                    LDQ     @A1,,AUTO
         5 005331   000015 116000 6                  CMPQ    13
         5 005332   005340 601000 5                  TNZ     s:12420

     1737    12418    1           FPT_SHORT.VEC1=VECTOR(PINCRW(UWA$,1)->CHAR7);

  12418  5 005333   000012 235000 6                  LDA     10
         5 005334   002367 236000 1                  LDQ     UWA$
         5 005335   000001 036003                    ADLQ    1,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:248  
         5 005336   000014 757000 1                  STAQ    FPT_SHORT
         5 005337   005342 710000 5                  TRA     s:12421

     1738    12419    1       ELSE
     1739    12420    1           FPT_SHORT.VEC1=VECTOR(ADDR(A1)->CHAR7);

  12420  5 005340   000012 235000 6                  LDA     10
         5 005341   000014 757000 1                  STAQ    FPT_SHORT

     1740    12421    1       FPT_SHORT.VEC2=FPTS.IA_;

  12421  5 005342   002371 470400 1                  LDP0    FPT$
         5 005343   000002 237100                    LDAQ    2,,PR0
         5 005344   000016 757000 1                  STAQ    FPT_SHORT+2

     1741    12422            %CLIMB(FCN=ROL);

  12430  5 005345   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005346   000000 713400 xsym               CLIMB   I$ROL
         5 005347   400400 600000 xsid               climb   nvectors=         2

     1742    12436    1       GOTO COMMON_RETURN;

  12436  5 005350   005017 710000 5                  TRA     COMMON_RETURN

     1743    12437    1   KEEP: ENTRY;

  12437  5 005351   000000 700200 xent  KEEP         TSX0  ! X66_AUTO_N
         5 005352   000106 000024                    ZERO    70,20

     1744    12438
     1745    12439    1       IPT_KEEP.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);

  12439  5 005353   000012 235000 6                  LDA     10
         5 005354   002367 236000 1                  LDQ     UWA$
         5 005355   000001 036003                    ADLQ    1,DU
         5 005356   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:249  
         5 005357   000000 757100                    STAQ    0,,PR0

     1746    12440            %CLIMB(FCN=KEEP);

  12448  5 005360   000000 713400 xsym               CLIMB   I$KEEP
         5 005361   400000 600000 xsid               climb   nvectors=         1

     1747    12454    1       GOTO COMMON_RETURN;

  12454  5 005362   005017 710000 5                  TRA     COMMON_RETURN

     1748    12455
     1749    12456    1   REDUCEQ: ENTRY;

  12456  5 005363   000000 700200 xent  REDUCEQ      TSX0  ! X66_AUTO_N
         5 005364   000106 000024                    ZERO    70,20

     1750    12457
     1751    12458            %CLIMB(FCN=REDUCEQ);

  12466  5 005365   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005366   000000 713400 xsym               CLIMB   I$REDUCEQ
         5 005367   400000 600000 xsid               climb   nvectors=         1

     1752    12472    1       GOTO COMMON_RETURN;

  12472  5 005370   005017 710000 5                  TRA     COMMON_RETURN

     1753    12473        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:250  
     1754    12474    1   RPTSTATS: ENTRY;

  12474  5 005371   000000 700200 xent  RPTSTATS     TSX0  ! X66_AUTO_N
         5 005372   000106 000024                    ZERO    70,20

     1755    12475
     1756    12476            %CLIMB(FCN=RPT,PARAMS=0);

  12487  5 005373   000000 713400 xsym               CLIMB   I$RPT
         5 005374   000000 600000 xsid               climb   nvectors=         0

     1757    12490    1       RETURN;

  12490  5 005375   000000 702200 xent               TSX2  ! X66_ARET

     1758    12491
     1759    12492    1   STATSON: ENTRY;

  12492  5 005376   000000 700200 xent  STATSON      TSX0  ! X66_AUTO_N
         5 005377   000106 000024                    ZERO    70,20

     1760    12493
     1761    12494            %CLIMB(FCN=STON,PARAMS=0);

  12505  5 005400   000000 713400 xsym               CLIMB   I$STON
         5 005401   000000 600000 xsid               climb   nvectors=         0

     1762    12508    1       RETURN;

  12508  5 005402   000000 702200 xent               TSX2  ! X66_ARET

     1763    12509
     1764    12510    1   STATSOFF: ENTRY;

  12510  5 005403   000000 700200 xent  STATSOFF     TSX0  ! X66_AUTO_N
         5 005404   000106 000024                    ZERO    70,20

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:251  
     1765    12511
     1766    12512            %CLIMB(FCN=STOFF,PARAMS=0);

  12523  5 005405   000000 713400 xsym               CLIMB   I$STOFF
         5 005406   000000 600000 xsid               climb   nvectors=         0

     1767    12526    1       RETURN;

  12526  5 005407   000000 702200 xent               TSX2  ! X66_ARET

     1768    12527
     1769    12528    1   TRACE_COMMON: PROC;

  12528  5 005410   200030 741300       TRACE_COMMON STX1  ! FIT$+1,,AUTO

     1770    12529
     1771    12530    2       IF ADDR(A1)=ADDR(NIL) THEN

  12530  5 005411   200003 236100                    LDQ     @A1,,AUTO
         5 005412   000015 116000 6                  CMPQ    13
         5 005413   005416 601000 5                  TNZ     s:12533

     1772    12531    2           I=0; /* NO TRACE OPTION SPECIFIED */

  12531  5 005414   000003 450000 1                  STZ     I
         5 005415   005422 710000 5                  TRA     s:12534

     1773    12532    2       ELSE
     1774    12533    2           I=A1(0);

  12533  5 005416   200003 470500                    LDP0    @A1,,AUTO
         5 005417   000000 100500                    MLR     fill='000'O
         5 005420   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 005421   000003 000004 1                  ADSC9   I                        cn=0,n=4

     1775    12534    2       FPT_SHORT.VEC1=VECTOR(I);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:252  
  12534  5 005422   000200 237000 6                  LDAQ    128
         5 005423   000014 757000 1                  STAQ    FPT_SHORT

     1776    12535    2   END TRACE_COMMON;

  12535  5 005424   000001 702211                    TSX2  ! 1,X1

     1777    12536
     1778    12537    1   TRACEOFF: ENTRY(A1);

  12537  5 005425   000000 700200 xent  TRACEOFF     TSX0  ! X66_AUTO_N
         5 005426   000106 000024                    ZERO    70,20

     1779    12538
     1780    12539    1       CALL TRACE_COMMON;

  12539  5 005427   005410 701000 5                  TSX1    TRACE_COMMON
         5 005430   000000 011000                    NOP     0

     1781    12540            %CLIMB(FCN=TROFF);

  12548  5 005431   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005432   000000 713400 xsym               CLIMB   I$TROFF
         5 005433   400000 600000 xsid               climb   nvectors=         1

     1782    12554    1       RETURN;

  12554  5 005434   000000 702200 xent               TSX2  ! X66_ARET

     1783    12555
     1784    12556    1   TRACEON: ENTRY(A1);

  12556  5 005435   000000 700200 xent  TRACEON      TSX0  ! X66_AUTO_N
         5 005436   000106 000024                    ZERO    70,20

     1785    12557
     1786    12558    1       CALL TRACE_COMMON;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:253  

  12558  5 005437   005410 701000 5                  TSX1    TRACE_COMMON
         5 005440   000000 011000                    NOP     0

     1787    12559            %CLIMB(FCN=TRON);

  12567  5 005441   000022 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005442   000000 713400 xsym               CLIMB   I$TRON
         5 005443   400000 600000 xsid               climb   nvectors=         1

     1788    12573    1       RETURN;

  12573  5 005444   000000 702200 xent               TSX2  ! X66_ARET

     1789    12574        /**************************************************************/
     1790    12575        /*                                                            */
     1791    12576        /*    CALL INVOKE(IA,UWA,RVA)                                 */
     1792    12577        /*                                                            */
     1793    12578        /*    1. REMEMBER UWA$ AND RVA$.  2.  DO A CLIMB TO 'HIA'     */
     1794    12579        /*                                                            */
     1795    12580        /**************************************************************/
     1796    12581
     1797    12582    1   INVOKE: ENTRY(A1,A2,A3);

  12582  5 005445   000000 700200 xent  INVOKE       TSX0  ! X66_AUTO_N
         5 005446   000106 000024                    ZERO    70,20

     1798    12583
     1799    12584    1       IA$=ADDR(A1);

  12584  5 005447   200003 236100                    LDQ     @A1,,AUTO
         5 005450   002366 756000 1                  STQ     IA$

     1800    12585    1       UWA$=ADDR(A2);

  12585  5 005451   200004 236100                    LDQ     @A2,,AUTO
         5 005452   002367 756000 1                  STQ     UWA$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:254  

     1801    12586    1       RVA$=ADDR(A3);

  12586  5 005453   200005 236100                    LDQ     @A3,,AUTO
         5 005454   002370 756000 1                  STQ     RVA$

     1802    12587    1       IF RVA$ = B$DS8$ THEN

  12587  5 005455   000000 116000 1                  CMPQ    B$DS8$_B
         5 005456   005461 601000 5                  TNZ     s:12589

     1803    12588    1           CALL SDS$OPEN;

  12588  5 005457   000045 701000 5                  TSX1    SDS$OPEN
         5 005460   000000 011000                    NOP     0

     1804    12589    1       IA_HALF(12) = 0; /* Roll back flag must start zero */

  12589  5 005461   002366 470400 1                  LDP0    IA$
         5 005462   000100 101400                    MRL     fill='000'O
         5 005463   000027 000004 6                  ADSC9   23                       cn=0,n=4
         5 005464   000006 000002                    ADSC9   6,,PR0                   cn=0,n=2

     1805    12590    1       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN

  12590  5 005465   002401 236000 1                  LDQ     PAGE_VECTOR+1
         5 005466   000015 116000 6                  CMPQ    13
         5 005467   005472 601000 5                  TNZ     s:12592

     1806    12591    1           CALL GET_A_PAGE;

  12591  5 005470   000741 701000 5                  TSX1    GET_A_PAGE
         5 005471   000000 011000                    NOP     0

     1807    12592    1       IF RVA_HALF(0)<131072 THEN

  12592  5 005472   002370 470400 1                  LDP0    RVA$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:255  
         5 005473   000100 101500                    MRL     fill='000'O
         5 005474   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 005475   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005476   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005477   400000 116007                    CMPQ    -131072,DL
         5 005500   005505 605000 5                  TPL     s:12595

     1808    12593    1           RVA_SIZE=RVA_HALF(0);

  12593  5 005501   000000 101500                    MRL     fill='000'O
         5 005502   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 005503   002364 000004 1                  ADSC9   RVA_SIZE                 cn=0,n=4
         5 005504   005513 710000 5                  TRA     s:12596

     1809    12594    1       ELSE
     1810    12595    1           RVA_SIZE=RVA_HALF(0)-131072;

  12595  5 005505   000100 101500                    MRL     fill='000'O
         5 005506   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 005507   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005510   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005511   400000 136007                    SBLQ    -131072,DL
         5 005512   002364 756000 1                  STQ     RVA_SIZE

     1811    12596    1       UWA_SIZE=A1(1);

  12596  5 005513   200003 471500                    LDP1    @A1,,AUTO
         5 005514   000000 100500                    MLR     fill='000'O
         5 005515   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4
         5 005516   002363 000004 1                  ADSC9   UWA_SIZE                 cn=0,n=4

     1812    12597    1       CALL VEC_MAKER(A1,47,FPTS.IA_);

  12597  5 005517   002371 236000 1                  LDQ     FPT$
         5 005520   000002 036003                    ADLQ    2,DU
         5 005521   000203 235000 6                  LDA     131
         5 005522   200032 757100                    STAQ    @A+1,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:256  
         5 005523   200003 236100                    LDQ     @A1,,AUTO
         5 005524   200031 756100                    STQ     FIT$+2,,AUTO
         5 005525   000025 701000 5                  TSX1    VEC_MAKER
         5 005526   000000 011000                    NOP     0

     1813    12598    1       CALL VEC_MAKER(A2,UWA_SIZE,FPTS.UWA_);

  12598  5 005527   002371 236000 1                  LDQ     FPT$
         5 005530   000004 036003                    ADLQ    4,DU
         5 005531   000204 235000 6                  LDA     132
         5 005532   200032 757100                    STAQ    @A+1,,AUTO
         5 005533   200004 236100                    LDQ     @A2,,AUTO
         5 005534   200031 756100                    STQ     FIT$+2,,AUTO
         5 005535   000025 701000 5                  TSX1    VEC_MAKER
         5 005536   000000 011000                    NOP     0

     1814    12599    1       CALL VEC_MAKER(A3,RVA_SIZE,FPTS.RVA_);

  12599  5 005537   002371 236000 1                  LDQ     FPT$
         5 005540   000006 036003                    ADLQ    6,DU
         5 005541   000205 235000 6                  LDA     133
         5 005542   200032 757100                    STAQ    @A+1,,AUTO
         5 005543   200005 236100                    LDQ     @A3,,AUTO
         5 005544   200031 756100                    STQ     FIT$+2,,AUTO
         5 005545   000025 701000 5                  TSX1    VEC_MAKER
         5 005546   000000 011000                    NOP     0

     1815    12600    1       IF RVA_HALF(0)<131072 OR

  12600  5 005547   002370 470400 1                  LDP0    RVA$
         5 005550   000100 101500                    MRL     fill='000'O
         5 005551   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 005552   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005553   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005554   400000 116007                    CMPQ    -131072,DL
         5 005555   005572 604000 5                  TMI     s:12602
         5 005556   400000 220003                    LDX0    -131072,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:257  
         5 005557   002370 236000 1                  LDQ     RVA$
         5 005560   000000 116000 1                  CMPQ    B$DS8$_B
         5 005561   005563 600000 5                  TZE     s:12600+12
         5 005562   000000 220003                    LDX0    0,DU
         5 005563   000362 236000 1                  LDQ     SDSFLAG
         5 005564   400000 376003                    ANQ     -131072,DU
         5 005565   400000 676003                    ERQ     -131072,DU
         5 005566   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 005567   000000 636010                    EAQ     0,X0
         5 005570   200077 376100                    ANQ     ERRMSG_BUF+31,,AUTO
         5 005571   005762 600000 5                  TZE     HIA

     1816    12601    2          (RVA$ = B$DS8$ & ~ SDSFLAG) THEN DO;

     1817    12602    2           SDSFLAG = '1'B;

  12602  5 005572   400000 236003                    LDQ     -131072,DU
         5 005573   000362 756000 1                  STQ     SDSFLAG

     1818    12603    3           IF RVA$ = B$DS8$ THEN DO;

  12603  5 005574   002370 236000 1                  LDQ     RVA$
         5 005575   000000 116000 1                  CMPQ    B$DS8$_B
         5 005576   005627 601000 5                  TNZ     s:12613

     1819    12604        /*          Set up NULL_OFFSET and RVA_TYPE table DBACS supplied
     1820    12605                    data in shared data segment file buffers */
     1821    12606    3               PT$ = PINCRW(RVA$, RVA_SIZE+1);

  12606  5 005577   002364 236000 1                  LDQ     RVA_SIZE
         5 005600   000022 736000                    QLS     18
         5 005601   000001 036003                    ADLQ    1,DU
         5 005602   002370 036000 1                  ADLQ    RVA$
         5 005603   000010 756000 1                  STQ     PT$

     1822    12607    3               NULL_OFFSET = PT$->SBIN36;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:258  
  12607  5 005604   000010 471400 1                  LDP1    PT$
         5 005605   100000 235100                    LDA     0,,PR1
         5 005606   002365 755000 1                  STA     NULL_OFFSET

     1823    12608    3               PT$ = PINCRW(PT$, 1);

  12608  5 005607   000001 036003                    ADLQ    1,DU
         5 005610   000010 756000 1                  STQ     PT$

     1824    12609    3               IX = (RVA_SIZE+1)*%TYPE_BITS/9 + 1;

  12609  5 005611   002364 236000 1                  LDQ     RVA_SIZE
         5 005612   000001 736000                    QLS     1
         5 005613   000002 036007                    ADLQ    2,DL
         5 005614   000011 506007                    DIV     9,DL
         5 005615   000001 036007                    ADLQ    1,DL
         5 005616   000001 756000 1                  STQ     IX

     1825    12610    3               RVA_TYPEC = PT$->RVA_TYPEC;

  12610  5 005617   000010 471400 1                  LDP1    PT$
         5 005620   000000 620006                    EAX0    0,QL
         5 005621   002376 473400 1                  LDP3    TYPE$
         5 005622   000001 721000 1                  LXL1    IX
         5 005623   040140 100540                    MLR     fill='040'O
         5 005624   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 005625   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     1826    12611    3               END;

  12611  5 005626   005667 710000 5                  TRA     s:12619

     1827    12612    3           ELSE DO;

     1828    12613    4               DO I=1 TO RVA_SIZE;

  12613  5 005627   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:259  
         5 005630   000003 755000 1                  STA     I
         5 005631   005664 710000 5                  TRA     s:12617+1

     1829    12614    4                   RVA_TYPE(I)=RVA_HALF(2*I);

  12614  5 005632   000003 236000 1                  LDQ     I
         5 005633   000044 402007                    MPY     36,DL
         5 005634   000000 116003                    CMPQ    0,DU
         5 005635   005637 605000 5                  TPL     s:12614+5
         5 005636   000044 036003                    ADLQ    36,DU
         5 005637   000003 235000 1                  LDA     I
         5 005640   000001 735000                    ALS     1
         5 005641   005643 605000 5                  TPL     s:12614+9
         5 005642   000044 035003                    ADLA    36,DU
         5 005643   002370 470400 1                  LDP0    RVA$
         5 005644   002376 471400 1                  LDP1    TYPE$
         5 005645   003105 061506                    CSR     bolr='003'O
         5 005646   000000 000022                    BDSC    0,Q,PR0                  by=0,bit=0,n=18
         5 005647   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2

     1830    12615    4                   IF RVA_HALF(2*I)=4 THEN

  12615  5 005650   000003 235000 1                  LDA     I
         5 005651   000002 735000                    ALS     2
         5 005652   002370 470400 1                  LDP0    RVA$
         5 005653   000100 101505                    MRL     fill='000'O
         5 005654   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         5 005655   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005656   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005657   000004 116007                    CMPQ    4,DL
         5 005660   005663 601000 5                  TNZ     s:12617

     1831    12616    4                       NULL_OFFSET=I;

  12616  5 005661   000003 236000 1                  LDQ     I
         5 005662   002365 756000 1                  STQ     NULL_OFFSET

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:260  
     1832    12617    4                   END;

  12617  5 005663   000003 054000 1                  AOS     I
         5 005664   000003 236000 1                  LDQ     I
         5 005665   002364 116000 1                  CMPQ    RVA_SIZE
         5 005666   005632 604400 5                  TMOZ    s:12614

     1833    12618    3               END;

     1834    12619    2           I=%FPT_SIZE+%RLCW_SIZE+RVA_SIZE/(36/%TYPE_BITS)+1;

  12619  5 005667   002364 236000 1                  LDQ     RVA_SIZE
         5 005670   000022 506007                    DIV     18,DL
         5 005671   000112 036007                    ADLQ    74,DL
         5 005672   000003 756000 1                  STQ     I

     1835    12620    2           IF MOD(I,2)=0 THEN

  12620  5 005673   000002 506007                    DIV     2,DL
         5 005674   000044 733000                    LRS     36
         5 005675   000000 116003                    CMPQ    0,DU
         5 005676   005704 601000 5                  TNZ     s:12623

     1836    12621    2               USEP$=PINCRW(FPT$,I);

  12621  5 005677   000003 236000 1                  LDQ     I
         5 005700   000022 736000                    QLS     18
         5 005701   002371 036000 1                  ADLQ    FPT$
         5 005702   002373 756000 1                  STQ     USEP$
         5 005703   005711 710000 5                  TRA     s:12624

     1837    12622    2           ELSE
     1838    12623    2               USEP$=PINCRW(FPT$,I+1);

  12623  5 005704   000003 236000 1                  LDQ     I
         5 005705   000022 736000                    QLS     18
         5 005706   000001 036003                    ADLQ    1,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:261  
         5 005707   002371 036000 1                  ADLQ    FPT$
         5 005710   002373 756000 1                  STQ     USEP$

     1839    12624    2           USEP.M=0;

  12624  5 005711   002373 470400 1                  LDP0    USEP$
         5 005712   000206 236000 6                  LDQ     134
         5 005713   000000 356100                    ANSQ    0,,PR0

     1840    12625    2           USEP.FLAG='0'B;

  12625  5 005714   000207 236000 6                  LDQ     135
         5 005715   000000 356100                    ANSQ    0,,PR0

     1841    12626    2           FPTS.USEP_=VECTOR(USEP);

  12626  5 005716   000210 235000 6                  LDA     136
         5 005717   002373 236000 1                  LDQ     USEP$
         5 005720   002371 471400 1                  LDP1    FPT$
         5 005721   100010 757100                    STAQ    8,,PR1

     1842    12627    2           E$=ENTADDR(GET);

  12627  5 005722   004346 636000 5                  EAQ     s:10955
         5 005723   000011 756000 1                  STQ     E$

     1843    12628    2           IDS_ADR(0)=REDEF_E$.ADR;

  12628  5 005724   000011 220000 1                  LDX0    E$
         5 005725   000333 740000 1                  STX0    IDS_ADR

     1844    12629    2           E$=ENTADDR(MODIFY);

  12629  5 005726   004467 636000 5                  EAQ     s:11558
         5 005727   000011 756000 1                  STQ     E$

     1845    12630    2           IDS_ADR(1)=REDEF_E$.ADR;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:262  

  12630  5 005730   000011 221000 1                  LDX1    E$
         5 005731   000334 741000 1                  STX1    IDS_ADR+1

     1846    12631    2           E$=ENTADDR(STORE);

  12631  5 005732   002507 636000 5                  EAQ     s:9720
         5 005733   000011 756000 1                  STQ     E$

     1847    12632    2           IDS_ADR(2)=REDEF_E$.ADR;

  12632  5 005734   000011 222000 1                  LDX2    E$
         5 005735   000335 742000 1                  STX2    IDS_ADR+2

     1848    12633    2           E$=ENTADDR(ERASER);

  12633  5 005736   002632 636000 5                  EAQ     s:9777
         5 005737   000011 756000 1                  STQ     E$

     1849    12634    2           IDS_ADR(3)=REDEF_E$.ADR;

  12634  5 005740   000011 223000 1                  LDX3    E$
         5 005741   000336 743000 1                  STX3    IDS_ADR+3

     1850    12635    2           E$=ENTADDR(CONNECT);

  12635  5 005742   004762 636000 5                  EAQ     s:12218
         5 005743   000011 756000 1                  STQ     E$

     1851    12636    2           IDS_ADR(4)=REDEF_E$.ADR;

  12636  5 005744   000011 224000 1                  LDX4    E$
         5 005745   000337 744000 1                  STX4    IDS_ADR+4

     1852    12637    2           E$=ENTADDR(DISCONNE);

  12637  5 005746   005002 636000 5                  EAQ     s:12239
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:263  
         5 005747   000011 756000 1                  STQ     E$

     1853    12638    2           IDS_ADR(5)=REDEF_E$.ADR;

  12638  5 005750   000011 225000 1                  LDX5    E$
         5 005751   000340 745000 1                  STX5    IDS_ADR+5

     1854    12639    2           E$=ENTADDR(DISCONNECT);

  12639  5 005752   004777 636000 5                  EAQ     s:12238
         5 005753   000011 756000 1                  STQ     E$

     1855    12640    2           IDS_ADR(6)=REDEF_E$.ADR;

  12640  5 005754   000011 226000 1                  LDX6    E$
         5 005755   000341 746000 1                  STX6    IDS_ADR+6

     1856    12641    2           E$=ENTADDR(FIND);

  12641  5 005756   002751 636000 5                  EAQ     s:9837
         5 005757   000011 756000 1                  STQ     E$

     1857    12642    2           IDS_ADR(7)=REDEF_E$.ADR;

  12642  5 005760   000011 227000 1                  LDX7    E$
         5 005761   000342 747000 1                  STX7    IDS_ADR+7

     1858    12643    2           END;

     1859    12644    1   HIA:
     1860    12645            %CLIMB(FCN=HIA);

  12653  5 005762   002371 470400 1     HIA          LDP0    FPT$
         5 005763   000000 713400 xsym               CLIMB   I$HIA
         5 005764   402000 600000 xsid               climb   nvectors=         5

     1861    12659    1       GOTO COMMON_RETURN;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:264  

  12659  5 005765   005017 710000 5                  TRA     COMMON_RETURN

SNA
 Sect OctLoc
   0     000   000000 000002   000000 000003   000000 000006   000000 000007    ................
   0     004   000000 000010   000000 000011   000000 000012   000000 000013    ................
   0     010   000000 000014   000000 000015   000000 000016   000000 000017    ................
   0     014   000000 000020   000000 000021   000000 000022   000000 000023    ................
   0     020   000000 000005   000000 000004   000000 000024   000000 000014    ................
   0     024   000000 000026   000000 000027   000000 000030   000000 000031    ................
   0     030   000000 000032   000000 000033   000000 000034   000000 000035    ................
   0     034   000000 000036   000000 000037                                    ........

B$DS8$_B
 Sect OctLoc
   1     000   000000 006013                                                    ....

DEADLOCK_RET
 Sect OctLoc
   1     006   000000 006004   000000 000000                                    ........

FPT_SHORT
 Sect OctLoc
   1     014   000000 777640   000003 006000   ****** ******   ****** ******    ................
   1     020   ****** ******   ****** ******                                    ........

CHK_NBF_ROL_CRPT$
 Sect OctLoc
   1     022   000014 006000                                                    ....

ZII$HAVEIT
 Sect OctLoc
   1     023   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     327*  000000 000000   000000 000000   000000 000000   000000 000000    ................

IDS_ADR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:265  
 Sect OctLoc
   1     333   ****** ******   ****** ******   ****** ******   ****** ******    ................

IDS_BIT9
 Sect OctLoc
   1     343   400000 000000   200000 000000   100000 000000   040000 000000    ........@... ...
   1     347   020000 000000   010000 000000   004000 000000   ****** ******    ................

RETAIN_SWITCH
 Sect OctLoc
   1     353   000000 000000                                                    ....

SDSFLAG
 Sect OctLoc
   1     362   0***** ******                                                    ....

FPBUF
 Sect OctLoc
   1     363   ****** ******   ****** ******   ****** ******   ****** ******    ................

PAGE_VECTOR
 Sect OctLoc
   1    2400   ****** ******   000000 006014                                    ........

ERR_CODE
 Sect OctLoc
   1    2402   321111 *****3                                                    .I..

FPT_GDP
 Sect OctLoc
   1    2404   000001 777640   002410 006000   000001 777640   002400 006000    ................
   1    2410   000000 000001   ****** ******                                    ........

FILE_NAME
 Sect OctLoc
   1    2412   011072 132111   105122 122115   123107 ******                    .:ZIERRMSG..

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:266  
FILE_ACCT
 Sect OctLoc
   1    2415   072123 131123   040040 040040                                    :SYS

FPT_ERRMSG
 Sect OctLoc
   1    2420   000003 777640   002446 006000   000000 777640   002402 006000    ................
   1    2424   000000 177640   000000 006014   000002 377640   002412 006000    ................
   1    2430   000001 777640   002415 006000   000000 177640   000000 006014    ................
   1    2434   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1    2444*  000000 177640   000000 006014   000000 000000   000000 000000    ................
   1    2450   375000 030001   040000 000000                                    .... ...

FPT_YC
 Sect OctLoc
   1    2452   000000 177640   000000 006014   000001 777640   002460 006000    ................
   1    2456   000000 177640   000000 006014   000000 000000   0***** ******    ................

FPT_FDS
 Sect OctLoc
   1    2462   000001 777640   002466 006000   000001 777640   002616 006000    ................
   1    2466   000000 777777   ****** ******                                    ........

FPT_GETDCB
 Sect OctLoc
   1    2470   000001 777640   002476 006000   000007 777640   002576 006000    ................
   1    2474   000000 777640   000360 006000   000000 000000   000000 000000    ................

FPT_RELDCB
 Sect OctLoc
   1    2500   000001 777640   002502 006000   000000 000000   000000 000000    ................

OPEN_SDS
 Sect OctLoc
   1    2504   000025 777640   002550 006000   000000 177640   000000 006014    ................
   1    2510   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1    2534*  001777 777640   000363 006000   000000 177640   000000 006014    ................
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:267  
   1    2540   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1    2550*  000000 000442   000000 002001   252525 000013   000040 252520    ............. ..
   1    2554   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1    2560   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    2564   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1    2570   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1    2574   000000 000000   ****** ******                                    ........

SDS_NAME
 Sect OctLoc
   1    2576   001040 040040   040040 040040   040040 040040   040040 040040    .
   1    2602   040040 040040   040040 040040   040040 040040   040040 040040

VLP_NAME
 Sect OctLoc
   1    2606   001040 040040   040040 040040   040040 040040   040040 040040    .
   1    2612   040040 040040   040040 040040   040040 040040   040040 040040

VEC
 Sect OctLoc
   1    2616   000000 177640   000000 006013                                    ........

AUTO$
 Sect OctLoc
   2     000   000000 006004                                                    ....

(unnamed)
 Sect OctLoc
   2     001   123105 124040                                                    SET

(unnamed)
 Sect OctLoc
   6     000   777777 600000   040040 040040   044040 040040   777777 577777    ....    $   ....
   6     004   000000 006003   000000 000000   000007 777640   002606 006000    ................
   6     010   000000 777640   000361 006000   000001 777640   000363 006000    ................
   6     014   000000 177640   000000 006014   000000 011625   000016 006000    ................
   6     020   000000 011626   000020 006000   002370 006000   000000 006000    ................
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:268  
   6     024   002367 006000   000000 000002   000025 006000   000000 000000    ................
   6     030   777777 777777   000000 000012   000031 006000   000035 777640    ................
   6     034   000063 777640   000000 000005   000035 006000   000000 000017    .3..............
   6     040   000037 006000   000777 777777   000000 000024   000042 006000    ............."..
   6     044   000000 000001   056040 040040   777743 777777   000000 000031    .....   ........
   6     050   000047 006000   000000 000036   000051 006000   000000 000043    .'.......).....#
   6     054   000053 006000   000000 000045   000055 006000   000003 777640    .+.....%.-......
   6     060   000000 000050   000060 006000   000000 000051   000062 006000    ...(.0.....).2..
   6     064   000000 000053   000064 006000   000000 000054   000066 006000    ...+.4.....,.6..
   6     070   000000 000055   000070 006000   000000 000062   000072 006000    ...-.8.....2.:..
   6     074   000027 006000   000000 000065   000075 006000   000000 000067    .......5.=.....7
   6     100   000077 006000   000000 000074   000101 006000   000000 000101    .?.....<.A.....A
   6     104   000103 006000   000000 000106   000105 006000   000000 000113    .C.....F.E.....K
   6     110   000107 006000   000000 000120   000111 006000   000005 777640    .G.....P.I......
   6     114   000000 000125   000114 006000   000000 000132   000116 006000    ...U.L.....Z.N..
   6     120   000000 000137   000120 006000   000000 000144   000122 006000    ..._.P.....d.R..
   6     124   000000 000151   000124 006000   000000 000156   000126 006000    ...i.T.....n.V..
   6     130   000000 000163   000130 006000   000000 000170   000132 006000    ...s.X.....x.Z..
   6     134   000000 000175   000134 006000   000000 000202   000136 006000    ...}.\.......^..
   6     140   000000 000214   000140 006000   000000 000221   000142 006000    .....`.......b..
   6     144   000000 000231   000144 006000   000000 000226   000146 006000    .....d.......f..
   6     150   000000 000233   000150 006000   000000 000240   000152 006000    .....h.......j..
   6     154   000000 000245   000154 006000   000000 000252   000156 006000    .....l.......n..
   6     160   000000 000257   000160 006000   000000 000264   000162 006000    .....p.......r..
   6     164   000000 000271   000164 006000   000000 000276   000166 006000    .....t.......v..
   6     170   200000 000000   000170 006000   400000 000000   000172 006000    .....x.......z..
   6     174   600000 000000   000174 006000   000001 777640   000016 006000    .....|..........
   6     200   000000 777640   000003 006000   000000 000057   000202 006000    .........../....
   6     204   002363 006000   002364 006000   400000 777777   377777 777777    ................
   6     210   000623 777640                                                    ....
     1862    12660    1   END ZII$FORT_PL6;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:269  
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_DBCS.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B_SEGIDS_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$FORT_PL6.

   Procedure ZII$FORT_PL6 requires 3062 words for executable code.
   Procedure ZII$FORT_PL6 requires 70 words of local(AUTO) storage.

    No errors detected in file ZII$IDS_FORT.:ZIC0TSI    .
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:270  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:271  
          MINI XREF LISTING

A IN PROCEDURE CHK_ARG
      5809**DCL      5807--PROC     5811--ASSIGN   5812--IF       5813--CALL     5821--CALL     5823>>ASSIGN
      5826--CALL     5830--ASSIGN
A IN PROCEDURE DO_IF
     12279**DCL     12278--PROC    12282>>ASSIGN
A IN PROCEDURE P_OFF_W
      5407**DCL      5406--PROC
A.ADR IN PROCEDURE P_OFF_W
      5408**DCL      5417>>ASSIGN
A.SEG IN PROCEDURE P_OFF_W
      5410**DCL      5416>>IF
A IN PROCEDURE VEC_MAKER
      5425**DCL      5424--PROC     5431--ASSIGN
A020
      1085**DCL        51--PROC     6376<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A1
       608**DCL        51--PROC     5901<>CALL     6482--ENTRY    7029>>IF       7032>>IF       7035>>IF
      7078--ENTRY    7647--ENTRY    8217--ENTRY    8219--ASSIGN   8275--ENTRY    8987--ENTRY    9558--ENTRY
      9585--ENTRY    9600--ASSIGN   9642--ASSIGN   9720--ENTRY    9745--ENTRY    9750--ASSIGN   9777--ENTRY
      9837--ENTRY   10632>>IF      10721>>IF      10890>>ASSIGN  10955--ENTRY   11558--ENTRY   12218--ENTRY
     12238--ENTRY   12239--ENTRY   12300<<ASSIGN  12331--ENTRY   12333--CALL    12361--ENTRY   12366--ENTRY
     12371--ENTRY   12376--ENTRY   12378--ASSIGN  12395--ENTRY   12398>>ASSIGN  12415--ENTRY   12417--IF
     12420--ASSIGN  12530--IF      12533>>ASSIGN  12537--ENTRY   12556--ENTRY   12582--ENTRY   12584--ASSIGN
     12596>>ASSIGN  12597<>CALL
A10
       835**DCL        51--PROC     6126<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A11
       860**DCL        51--PROC     6151<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A12
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:272  
       885**DCL        51--PROC     6176<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A13
       910**DCL        51--PROC     6201<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A14
       935**DCL        51--PROC     6226<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A15
       960**DCL        51--PROC     6251<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A16
       985**DCL        51--PROC     6276<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A17
      1010**DCL        51--PROC     6301<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A18
      1035**DCL        51--PROC     6326<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A19
      1060**DCL        51--PROC     6351<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A2
       633**DCL        51--PROC     5926<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8217--ENTRY
      8222<<ASSIGN   8237<<ASSIGN   8239<<ASSIGN   8275--ENTRY    8987--ENTRY    9558--ENTRY    9566--ASSIGN
      9585--ENTRY    9613--ASSIGN   9745--ENTRY    9755--IF       9758--ASSIGN   9777--ENTRY    9791--IF
      9837--ENTRY   10612--ASSIGN  10955--ENTRY   11558--ENTRY   12218--ENTRY   12238--ENTRY   12239--ENTRY
     12322<<ASSIGN  12331--ENTRY   12353--IF      12358<<ASSIGN  12361--ENTRY   12366--ENTRY   12371--ENTRY
     12376--ENTRY   12379--ASSIGN  12582--ENTRY   12585--ASSIGN  12598<>CALL
A3
       658**DCL        51--PROC     5951<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9585--ENTRY    9837--ENTRY   10520--ASSIGN  10955--ENTRY   11558--ENTRY   12582--ENTRY
     12586--ASSIGN  12599<>CALL
A4
       685**DCL        51--PROC     5976<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:273  
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A5
       710**DCL        51--PROC     6001<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A6
       735**DCL        51--PROC     6026<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A7
       760**DCL        51--PROC     6051<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A8
       785**DCL        51--PROC     6076<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
A9
       810**DCL        51--PROC     6101<>CALL     6482--ENTRY    7078--ENTRY    7647--ENTRY    8275--ENTRY
      8987--ENTRY    9837--ENTRY   10955--ENTRY   11558--ENTRY
ANAME_
      3493**DCL      9600--ASSIGN
ARG.OFFSET
      1211**DCL      5816<<ASSIGN   5854<<ASSIGN   7046<<ASSIGN   7061>>ASSIGN   8198>>ASSIGN   8938>>ASSIGN
      9535>>ASSIGN   9567>>ASSIGN   9605>>ASSIGN   9608>>ASSIGN   9654>>ASSIGN   9726>>ASSIGN   9787>>ASSIGN
     10423>>ASSIGN  10424>>ASSIGN  10467>>ASSIGN  10468>>ASSIGN  10473>>ASSIGN  10519>>ASSIGN  10540>>ASSIGN
     10541>>ASSIGN  10550>>ASSIGN  10630>>ASSIGN  10687>>ASSIGN  10695>>ASSIGN  10731>>ASSIGN  10780>>ASSIGN
     10781>>ASSIGN  10784>>ASSIGN  10848>>ASSIGN  10882>>ASSIGN  10892>>ASSIGN  11507>>ASSIGN  11535>>ASSIGN
     12121>>ASSIGN  12126>>ASSIGN  12152>>ASSIGN  12202>>ASSIGN  12203>>ASSIGN  12210>>ASSIGN  12306>>ASSIGN
ARG.TYPE
      1212**DCL      5817<<ASSIGN   5823<<ASSIGN   5827<<ASSIGN   5855<<ASSIGN   7041>>DOWHILE  7623>>IF
      8196>>IF       8202>>IF       8205>>IF       8208>>IF       8823>>ASSIGN   8922>>ASSIGN   8937>>IF
      9534>>IF       9561>>IF       9597>>IF       9601>>DOCASE   9646>>IF       9655>>DOCASE   9658>>IF
      9663>>IF       9668>>IF       9671>>IF       9674>>IF       9677>>IF       9725>>IF       9786>>IF
      9788>>IF      10381>>IF      10405>>IF      10417>>IF      10419>>IF      10448>>IF      10451>>IF
     10458>>IF      10460>>IF      10460>>IF      10470>>IF      10506>>DOCASE  10508>>IF      10523>>IF
     10535>>IF      10542>>IF      10549>>IF      10623>>IF      10682>>IF      10690>>IF      10721>>IF
     10765>>IF      10768>>IF      10775>>IF      10789>>DOCASE  10844>>IF      10883>>IF      10887>>IF
     10891>>IF      10897>>DOCASE  11499>>IF      11503>>IF      11534>>IF      12117>>IF      12125>>DOWHILE
     12132>>IF      12132>>IF      12134>>IF      12143>>IF      12148>>IF      12197>>IF      12197>>IF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:274  
     12205>>IF      12302>>IF
ARG$
      3982**DCL      1210--IMP-PTR  5816>>ASSIGN   5817>>ASSIGN   5823>>ASSIGN   5827>>ASSIGN   5854>>ASSIGN
      5855>>ASSIGN   6453<<ASSIGN   7041>>DOWHILE  7046>>ASSIGN   7061>>ASSIGN   7623>>IF       8196>>IF
      8198>>ASSIGN   8202>>IF       8205>>IF       8208>>IF       8823>>ASSIGN   8922>>ASSIGN   8937>>IF
      8938>>ASSIGN   9534>>IF       9535>>ASSIGN   9561>>IF       9567>>ASSIGN   9597>>IF       9601>>DOCASE
      9605>>ASSIGN   9608>>ASSIGN   9646>>IF       9654>>ASSIGN   9655>>DOCASE   9658>>IF       9663>>IF
      9668>>IF       9671>>IF       9674>>IF       9677>>IF       9725>>IF       9726>>ASSIGN   9786>>IF
      9787>>ASSIGN   9788>>IF      10381>>IF      10405>>IF      10417>>IF      10419>>IF      10423>>ASSIGN
     10424>>ASSIGN  10448>>IF      10451>>IF      10458>>IF      10460>>IF      10460>>IF      10467>>ASSIGN
     10468>>ASSIGN  10470>>IF      10473>>ASSIGN  10506>>DOCASE  10508>>IF      10519>>ASSIGN  10523>>IF
     10535>>IF      10540>>ASSIGN  10541>>ASSIGN  10542>>IF      10549>>IF      10550>>ASSIGN  10623>>IF
     10630>>ASSIGN  10682>>IF      10687>>ASSIGN  10690>>IF      10695>>ASSIGN  10721>>IF      10731>>ASSIGN
     10765>>IF      10768>>IF      10775>>IF      10780>>ASSIGN  10781>>ASSIGN  10784>>ASSIGN  10789>>DOCASE
     10844>>IF      10848>>ASSIGN  10882>>ASSIGN  10883>>IF      10887>>IF      10891>>IF      10892>>ASSIGN
     10897>>DOCASE  11499>>IF      11503>>IF      11507>>ASSIGN  11534>>IF      11535>>ASSIGN  12117>>IF
     12121>>ASSIGN  12125>>DOWHILE 12126>>ASSIGN  12132>>IF      12132>>IF      12134>>IF      12143>>IF
     12148>>IF      12152>>ASSIGN  12197>>IF      12197>>IF      12202>>ASSIGN  12203>>ASSIGN  12205>>IF
     12210>>ASSIGN  12302>>IF      12306>>ASSIGN
ARG_ERROR
      6432**PROC     5787--CALL     5796--CALL     5834--CALL     5852--CALL     5877--CALL     6464--CALL
      7038--CALL     7057--CALL     8211--CALL     8932--CALL     8937--CALL     9534--CALL     9561--CALL
      9646--CALL     9661--CALL     9666--CALL     9680--CALL     9682--CALL     9685--CALL     9725--CALL
      9749--CALL     9790--CALL    10404--CALL    10419--CALL    10454--CALL    10461--CALL    10476--CALL
     10535--CALL    10549--CALL    10595--CALL    10625--CALL    10682--CALL    10690--CALL    10775--CALL
     10786--CALL    10826--CALL    10844--CALL    10896--CALL    10936--CALL    11503--CALL    11536--CALL
     12137--CALL    12148--CALL    12162--CALL    12197--CALL    12205--CALL    12212--CALL    12302--CALL
     12324--CALL    12334--CALL    12353--CALL
AUTO$
      3501**DCL      3502--REDEF
AUTO_FRAME
      3492**DCL      5875>>ASSIGN   5875>>ASSIGN   8958>>ASSIGN   8958>>ASSIGN   9555>>ASSIGN   9555>>ASSIGN
      9774>>ASSIGN   9774>>ASSIGN
B IN PROCEDURE P_OFF_W
      5411**DCL      5406--PROC
B.ADR IN PROCEDURE P_OFF_W
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:275  
      5412**DCL      5417>>ASSIGN
B.SEG IN PROCEDURE P_OFF_W
      5414**DCL      5416>>IF
B IN PROCEDURE VEC_MAKER
      5426**DCL      5424--PROC     5432>>ASSIGN
B$AUTO$
      3502**DCL      3492--IMP-PTR  5875>>ASSIGN   5875>>ASSIGN   8958>>ASSIGN   8958>>ASSIGN   9555>>ASSIGN
      9555>>ASSIGN   9774>>ASSIGN   9774>>ASSIGN
B$DS8$
      3465**DCL     12587>>IF      12600>>IF      12603>>IF
B$DS8$_B
      3464**DCL      3465--REDEF
B$EXCFR.ASL
      5384**DCL      5384--REDEF
B$EXCFR.ERR.ERR#
      5398**DCL      5398--REDEF
B$EXCFR.ERR.FCG
      5398**DCL      8239--ASSIGN
B$EXCFR.EVID
      5397**DCL      5397--REDEF    5398--REDEF
B$EXCFR.IR
      5385**DCL      5385--REDEF
B$EXCFR.PREVSZ
      5384**DCL      5384--REDEF
B$EXCFR.SUBC
      5396**DCL      5396--REDEF    5397--REDEF    5397--REDEF
B$TCB.ALT$
      5381**DCL      8239>>ASSIGN
B$TCB$
      3482**DCL      8239>>ASSIGN
BINARY_SEARCH IN PROCEDURE CHK_ARG
      5834**LABEL    5842--GOTO     5847--GOTO
C IN PROCEDURE VEC_MAKER
      5427**DCL      5424--PROC     5431<<ASSIGN
C.V_SIZE IN PROCEDURE VEC_MAKER
      5428**DCL      5432<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:276  
CHAR7
      3480**DCL      7626>>CALLBLT  9756--ASSIGN   9758--ASSIGN  12418--ASSIGN  12420--ASSIGN  12439--ASSIGN
CHAR_V
      3481**DCL      8221>>CALLBLT  8228>>DOWHILE  8231>>CALLBLT  8233>>IF       8235--ASSIGN
CHK_ARG
      5807**PROC     5901--CALL     5926--CALL     5951--CALL     5976--CALL     6001--CALL     6026--CALL
      6051--CALL     6076--CALL     6101--CALL     6126--CALL     6151--CALL     6176--CALL     6201--CALL
      6226--CALL     6251--CALL     6276--CALL     6301--CALL     6326--CALL     6351--CALL     6376--CALL
CHK_NBF_ROL_CRPT$
      3518**DCL      4678--IMP-PTR  4701--IMP-PTR  5105--IMP-PTR  5115--IMP-PTR  5124--IMP-PTR  5147--IMP-PTR
      5171--IMP-PTR  5180--IMP-PTR  9750>>ASSIGN   9756>>ASSIGN   9758>>ASSIGN   9759>>ASSIGN   9768>>CALL
     12378>>ASSIGN  12379>>ASSIGN  12388>>CALL    12407>>CALL    12430>>CALL    12439>>ASSIGN  12448>>CALL
     12466>>CALL    12548>>CALL    12567>>CALL
CHK_RETAIN
      8244**PROC     9728--CALL     9814--CALL    10383--CALL    10430--CALL    10481--CALL    10553--CALL
     10631--CALL    10697--CALL    10732--CALL    10788--CALL    10849--CALL    10895--CALL
CODE04.CREATION.TIME
      3769**DCL      5786>>IF
COMMON_RETURN
     12261**LABEL    8980--GOTO     9556--GOTO     9718--GOTO     9743--GOTO     9775--GOTO     9808--GOTO
     10399--GOTO    10944--GOTO    11556--GOTO    12186--GOTO    12236--GOTO    12257--GOTO    12359--GOTO
     12364--GOTO    12369--GOTO    12374--GOTO    12394--GOTO    12413--GOTO    12436--GOTO    12454--GOTO
     12472--GOTO    12659--GOTO
CONNECT
     12218**ENTRY   12635--ASSIGN
CON_DIS
     12190**PROC    12221--CALL    12242--CALL
DEADLOCK_RET
      3494**DCL      3495--REDEF   12273>>UNWIND
DISCONNE
     12239**ENTRY   12637--ASSIGN
DISCONNECT
     12238**ENTRY   12639--ASSIGN
DK_RET.AUTO_OFFSET
      3496**DCL      8958<<ASSIGN   9555<<ASSIGN   9774<<ASSIGN
DK_RET.RET_ADDR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:277  
      3498**DCL     12272<<ASSIGN
DO_IF
     12278**PROC    12363--CALL    12368--CALL    12373--CALL
E$
      3508**DCL      3509--REDEF   12627<<ASSIGN  12629<<ASSIGN  12631<<ASSIGN  12633<<ASSIGN  12635<<ASSIGN
     12637<<ASSIGN  12639<<ASSIGN  12641<<ASSIGN
END_OF_ARGS IN PROCEDURE SET_ARGS
      6422**LABEL    5901--CALLALT  5926--CALLALT  5951--CALLALT  5976--CALLALT  6001--CALLALT  6026--CALLALT
      6051--CALLALT  6076--CALLALT  6101--CALLALT  6126--CALLALT  6151--CALLALT  6176--CALLALT  6201--CALLALT
      6226--CALLALT  6251--CALLALT  6276--CALLALT  6301--CALLALT  6326--CALLALT  6351--CALLALT  6376--CALLALT
EPTR$
      3504**DCL      8962>>CALL    12267>>CALL
ERASER
      9777**ENTRY   12633--ASSIGN
ERRMSG_BUF IN PROCEDURE ARG_ERROR
      6435**DCL      6438--ASSIGN
ERR_CODE
      5192**DCL      5347--DCLINIT
ERR_CODE.ERR_NO
      5194**DCL      6437<<ASSIGN
ERR_NO IN PROCEDURE ARG_ERROR
      6434**DCL      6432--PROC     6437>>ASSIGN
F$DCB.ACCT# IN PROCEDURE SDS$OPEN
      5460**DCL      5759--ASSIGN
F$DCB.ACTPOS IN PROCEDURE SDS$OPEN
      5476**DCL      5476--REDEF
F$DCB.ARS# IN PROCEDURE SDS$OPEN
      5450**DCL      5450--REDEF
F$DCB.ASN# IN PROCEDURE SDS$OPEN
      5465**DCL      5744>>IF       5755>>IF
F$DCB.ATTR IN PROCEDURE SDS$OPEN
      5469**DCL      5470--REDEF
F$DCB.BORROW IN PROCEDURE SDS$OPEN
      5484**DCL      5484--REDEF    5484--REDEF    5484--REDEF
F$DCB.DCBNAME.L IN PROCEDURE SDS$OPEN
      5498**DCL      5498--IMP-SIZ
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:278  
F$DCB.EOMCHAR# IN PROCEDURE SDS$OPEN
      5454**DCL      5454--REDEF
F$DCB.FCD# IN PROCEDURE SDS$OPEN
      5463**DCL      5737>>IF
F$DCB.FLDID IN PROCEDURE SDS$OPEN
      5479**DCL      5479--REDEF
F$DCB.FORM$ IN PROCEDURE SDS$OPEN
      5473**DCL      5473--REDEF
F$DCB.FSECT IN PROCEDURE SDS$OPEN
      5489**DCL      5489--REDEF
F$DCB.FSN# IN PROCEDURE SDS$OPEN
      5466**DCL      5466--REDEF    5466--REDEF    5467--REDEF
F$DCB.HEADER$ IN PROCEDURE SDS$OPEN
      5472**DCL      5472--REDEF
F$DCB.IXTNSIZE# IN PROCEDURE SDS$OPEN
      5470**DCL      5470--REDEF
F$DCB.LASTSTA$ IN PROCEDURE SDS$OPEN
      5459**DCL      5459--REDEF
F$DCB.LVL IN PROCEDURE SDS$OPEN
      5485**DCL      5485--REDEF
F$DCB.NAME# IN PROCEDURE SDS$OPEN
      5460**DCL      5758>>ASSIGN
F$DCB.NAME#.C IN PROCEDURE SDS$OPEN
      5460**DCL      5460--REDEF
F$DCB.NOEOF IN PROCEDURE SDS$OPEN
      5482**DCL      5482--REDEF
F$DCB.NRECS# IN PROCEDURE SDS$OPEN
      5471**DCL      5471--REDEF
F$DCB.NRECX IN PROCEDURE SDS$OPEN
      5490**DCL      5490--REDEF
F$DCB.OHDR IN PROCEDURE SDS$OPEN
      5482**DCL      5482--REDEF
F$DCB.ORG# IN PROCEDURE SDS$OPEN
      5465**DCL      5465--REDEF
F$DCB.PRECNO IN PROCEDURE SDS$OPEN
      5488**DCL      5488--REDEF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:279  
F$DCB.RCSZ IN PROCEDURE SDS$OPEN
      5494**DCL      5494--REDEF
F$DCB.RES# IN PROCEDURE SDS$OPEN
      5461**DCL      5461--REDEF
F$DCB.SETX IN PROCEDURE SDS$OPEN
      5473**DCL      5473--REDEF
F$DCB.TAB$ IN PROCEDURE SDS$OPEN
      5473**DCL      5473--REDEF
F$DCB.TDA IN PROCEDURE SDS$OPEN
      5487**DCL      5488--REDEF
F$DCB.WSN# IN PROCEDURE SDS$OPEN
      5461**DCL      5461--REDEF
FILE_ACCT
      5333**DCL      5348--DCLINIT
FILE_NAME
      5320**DCL      5348--DCLINIT
FIND
      9837**ENTRY   12641--ASSIGN
FINDBKEY
      9812**PROC    10521--CALL    10613--CALL
FIT$
      3773**DCL      5781<<ASSIGN   5782>>DOWHILE  5785<<ASSIGN   5785>>ASSIGN   5785>>ASSIGN   5786>>IF
FM$FIT.CODES.CODE
      3762**DCL      5782>>DOWHILE
FM$FIT.CODES.ITEMX
      3762**DCL      5785>>ASSIGN
FPBUF
      3772**DCL      5615--DCLINIT  5781--ASSIGN
FPT$
      3981**DCL      1220--IMP-PTR  4639--IMP-PTR  4652--IMP-PTR  4666--IMP-PTR  4688--IMP-PTR  4710--IMP-PTR
      4723--IMP-PTR  4735--IMP-PTR  4748--IMP-PTR  4765--IMP-PTR  4782--IMP-PTR  4797--IMP-PTR  4811--IMP-PTR
      4826--IMP-PTR  4841--IMP-PTR  4857--IMP-PTR  4873--IMP-PTR  4886--IMP-PTR  4903--IMP-PTR  4920--IMP-PTR
      4935--IMP-PTR  4952--IMP-PTR  4969--IMP-PTR  4986--IMP-PTR  5002--IMP-PTR  5014--IMP-PTR  5027--IMP-PTR
      5038--IMP-PTR  5050--IMP-PTR  5062--IMP-PTR  5076--IMP-PTR  5089--IMP-PTR  5133--IMP-PTR  5156--IMP-PTR
      5811>>ASSIGN   6422>>ASSIGN   6452<<ASSIGN   6453>>ASSIGN   6454>>ASSIGN   6456>>ASSIGN   6456>>ASSIGN
      6457>>ASSIGN   7052>>ASSIGN   7062>>ASSIGN   7626>>CALLBLT  7629>>ASSIGN   8924>>ASSIGN   8927>>ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:280  
      8930>>ASSIGN   8938>>ASSIGN   8940>>ASSIGN   8941>>ASSIGN   8941>>ASSIGN   8942>>ASSIGN   8942>>ASSIGN
      8952>>CALL     8963>>ASSIGN   8963>>ASSIGN   8972>>CALL     9535>>ASSIGN   9537>>ASSIGN   9538>>ASSIGN
      9538>>ASSIGN   9539>>ASSIGN   9539>>ASSIGN   9549>>CALL     9565>>ASSIGN   9565>>ASSIGN   9566>>ASSIGN
      9567>>ASSIGN   9576>>CALL     9582>>ASSIGN   9582>>ASSIGN   9599>>ASSIGN   9600>>ASSIGN   9604>>ASSIGN
      9605>>ASSIGN   9607>>ASSIGN   9608>>ASSIGN   9610>>ASSIGN   9611>>ASSIGN   9612>>ASSIGN   9613>>ASSIGN
      9615>>ASSIGN   9616>>ASSIGN   9616>>ASSIGN   9625>>CALL     9642>>ASSIGN   9651>>ASSIGN   9652>>ASSIGN
      9654>>ASSIGN   9659>>ASSIGN   9664>>ASSIGN   9669>>ASSIGN   9672>>ASSIGN   9675>>ASSIGN   9678>>ASSIGN
      9701>>ASSIGN   9701>>ASSIGN   9710>>CALL     9717>>ASSIGN   9717>>ASSIGN   9726>>ASSIGN   9727>>ASSIGN
      9727>>ASSIGN   9728>>CALL     9737>>CALL     9759>>ASSIGN   9783>>ASSIGN   9787>>ASSIGN   9789>>ASSIGN
      9791>>ASSIGN   9793>>ASSIGN   9793>>ASSIGN   9802>>CALL     9814>>CALL     9815>>ASSIGN   9815>>ASSIGN
      9817>>ASSIGN   9817>>ASSIGN   9828>>CALL     9834>>ASSIGN   9834>>ASSIGN  10383>>CALL    10384>>ASSIGN
     10384>>ASSIGN  10393>>CALL    10423>>ASSIGN  10424>>ASSIGN  10425>>ASSIGN  10425>>ASSIGN  10427>>ASSIGN
     10427>>ASSIGN  10430>>CALL    10439>>CALL    10449>>ASSIGN  10452>>ASSIGN  10467>>ASSIGN  10468>>ASSIGN
     10472>>ASSIGN  10473>>ASSIGN  10481>>CALL    10482>>ASSIGN  10482>>ASSIGN  10484>>ASSIGN  10484>>ASSIGN
     10495>>CALL    10519>>ASSIGN  10520>>ASSIGN  10540>>ASSIGN  10541>>ASSIGN  10550>>ASSIGN  10552>>ASSIGN
     10553>>CALL    10553>>CALL    10554>>ASSIGN  10554>>ASSIGN  10555>>IF      10557>>ASSIGN  10557>>ASSIGN
     10557>>ASSIGN  10571>>CALL    10587>>CALL    10611>>ASSIGN  10612>>ASSIGN  10630>>ASSIGN  10631>>CALL
     10633>>ASSIGN  10633>>ASSIGN  10635>>ASSIGN  10635>>ASSIGN  10646>>CALL    10654>>ASSIGN  10654>>ASSIGN
     10663>>CALL    10687>>ASSIGN  10688>>ASSIGN  10695>>ASSIGN  10697>>CALL    10697>>CALL    10698>>ASSIGN
     10698>>ASSIGN  10699>>IF      10700>>ASSIGN  10700>>ASSIGN  10700>>ASSIGN  10712>>CALL    10731>>ASSIGN
     10732>>CALL    10733>>ASSIGN  10733>>ASSIGN  10735>>ASSIGN  10735>>ASSIGN  10746>>CALL    10766>>ASSIGN
     10769>>ASSIGN  10771>>ASSIGN  10780>>ASSIGN  10781>>ASSIGN  10783>>ASSIGN  10784>>ASSIGN  10788>>CALL
     10792>>ASSIGN  10792>>ASSIGN  10801>>CALL    10808>>ASSIGN  10808>>ASSIGN  10809>>ASSIGN  10809>>ASSIGN
     10819>>CALL    10848>>ASSIGN  10849>>CALL    10850>>ASSIGN  10850>>ASSIGN  10852>>ASSIGN  10852>>ASSIGN
     10863>>CALL    10882>>ASSIGN  10885>>ASSIGN  10888>>ASSIGN  10890>>ASSIGN  10892>>ASSIGN  10894>>ASSIGN
     10895>>CALL    10900>>ASSIGN  10900>>ASSIGN  10902>>ASSIGN  10902>>ASSIGN  10913>>CALL    10920>>ASSIGN
     10920>>ASSIGN  10929>>CALL    11501>>ASSIGN  11507>>ASSIGN  11509>>ASSIGN  11509>>ASSIGN  11511>>ASSIGN
     11511>>ASSIGN  11522>>CALL    11532>>ASSIGN  11535>>ASSIGN  11540>>ASSIGN  11540>>ASSIGN  11549>>CALL
     12112>>ASSIGN  12121>>ASSIGN  12126>>ASSIGN  12127>>ASSIGN  12127>>ASSIGN  12136>>ASSIGN  12137>>IF
     12144>>ASSIGN  12152>>ASSIGN  12152>>ASSIGN  12152>>ASSIGN  12155>>ASSIGN  12155>>ASSIGN  12166>>ASSIGN
     12166>>ASSIGN  12167>>ASSIGN  12167>>ASSIGN  12169>>ASSIGN  12169>>ASSIGN  12180>>CALL    12202>>ASSIGN
     12203>>ASSIGN  12209>>ASSIGN  12210>>ASSIGN  12220>>ASSIGN  12220>>ASSIGN  12230>>CALL    12241>>ASSIGN
     12241>>ASSIGN  12251>>CALL    12282>>ASSIGN  12285>>ASSIGN  12285>>ASSIGN  12294>>CALL    12306>>ASSIGN
     12307>>ASSIGN  12307>>ASSIGN  12316>>CALL    12337>>ASSIGN  12338>>ASSIGN  12338>>ASSIGN  12347>>CALL
     12421>>ASSIGN  12597>>CALL    12598>>CALL    12599>>CALL    12621>>ASSIGN  12623>>ASSIGN  12626>>ASSIGN
     12653>>CALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:281  
FPTS.IA_
      1222**DCL      9759>>ASSIGN  12421>>ASSIGN  12597<>CALL
FPTS.RVA_
      1224**DCL     12599<>CALL
FPTS.USEP_
      1225**DCL     12626<<ASSIGN
FPTS.UWA_
      1223**DCL     12598<>CALL
FPTS.V
      1226**DCL      6422--ASSIGN   6456--ASSIGN   9582--ASSIGN   9717--ASSIGN   9834--ASSIGN
FPTS.V.ARG
      1229**DCL      5811<<ASSIGN   7052>>ASSIGN   7062>>ASSIGN   7626>>CALLBLT  7629>>ASSIGN
FPTS.V.FPARAM
      1228**DCL      6453--ASSIGN
FPTS.V_
      1221**DCL      6456<<ASSIGN   6457>>ASSIGN   9717<<ASSIGN   9834<<ASSIGN
FPT_ERRMSG
      5347**DCL      6439<>CALL
FPT_ERRMSG.BUF_
      5347**DCL      6438<<ASSIGN   6457<<ASSIGN
FPT_ERRMSG.V
      5351**DCL      5347--DCLINIT
FPT_FDS IN PROCEDURE SDS$OPEN
      5511**DCL      5742<>CALL
FPT_FDS.V IN PROCEDURE SDS$OPEN
      5511**DCL      5511--DCLINIT
FPT_GDP
      5291**DCL      6451<>CALL
FPT_GDP.V
      5291**DCL      5291--DCLINIT
FPT_GETDCB IN PROCEDURE SDS$OPEN
      5526**DCL      5734<>CALL     5754<>CALL
FPT_GETDCB.DCBNAME_ IN PROCEDURE SDS$OPEN
      5526**DCL      5751<<ASSIGN
FPT_GETDCB.DCBNUM_ IN PROCEDURE SDS$OPEN
      5526**DCL      5752<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:282  
FPT_GETDCB.V IN PROCEDURE SDS$OPEN
      5527**DCL      5526--DCLINIT
FPT_GETDCB.V.MERGE# IN PROCEDURE SDS$OPEN
      5527**DCL      5733<<ASSIGN   5753<<ASSIGN
FPT_GETDCB.V.TEST# IN PROCEDURE SDS$OPEN
      5528**DCL      5732<<ASSIGN
FPT_RELDCB IN PROCEDURE SDS$OPEN
      5541**DCL      5774<>CALL
FPT_RELDCB.V IN PROCEDURE SDS$OPEN
      5541**DCL      5541--DCLINIT
FPT_RELDCB.V.DCB# IN PROCEDURE SDS$OPEN
      5541**DCL      5773<<ASSIGN
FPT_SHORT
      3514**DCL      3518--DCLINIT
FPT_SHORT.VEC1
      3515**DCL     12397<<ASSIGN  12418<<ASSIGN  12420<<ASSIGN  12534<<ASSIGN
FPT_SHORT.VEC2
      3516**DCL     12397--ASSIGN  12398--ASSIGN  12421<<ASSIGN
FPT_YC
      5376**DCL      8236<>CALL
FPT_YC.CMD_
      5376**DCL      8235<<ASSIGN
FPT_YC.V
      5377**DCL      5376--DCLINIT
GET
     10955**ENTRY   12627--ASSIGN
GET_A_PAGE
      6449**PROC    12591--CALL
HIGH
      3534**DCL      5832<<ASSIGN   5834>>IF       5837>>ASSIGN   5846<<ASSIGN
I
      3484**DCL      3515--DCLINIT  5417<<ASSIGN   5419<<ASSIGN   5814>>IF       5814>>IF       5816>>ASSIGN
      5817>>ASSIGN   5822>>IF       5822>>IF       5828>>IF       5828>>IF       5830<<ASSIGN   5839>>IF
      5844>>IF       7051<<DOINDEX  7052>>ASSIGN   7622<<DOINDEX  7623>>IF       7626>>CALLBLT  8221<<CALLBLT
      8223>>IF       8224>>ASSIGN   8225>>ASSIGN   8226<<ASSIGN   8228>>DOWHILE  8228>>DOWHILE  8229<<ASSIGN
      8229>>ASSIGN   8231<<CALLBLT  8231>>CALLBLT  8233>>IF       8233<<ASSIGN   8233>>ASSIGN   8234>>ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:283  
      8823<<ASSIGN   8824>>IF       8840>>IF       8856>>IF       8872>>IF       8888>>IF       8904>>IF
      8922<<ASSIGN   8923>>IF       8926>>IF       8929>>IF       8936<<DOINDEX  8937>>IF       8938>>ASSIGN
      8938>>ASSIGN   8940>>ASSIGN   8942>>ASSIGN   9533<<DOINDEX  9534>>IF       9535>>ASSIGN   9535>>ASSIGN
      9537>>ASSIGN   9539>>ASSIGN  10543<<ASSIGN  10543<<ASSIGN  10544>>DOINDEX 10550>>ASSIGN  10552>>ASSIGN
     10561>>IF      10689<<DOINDEX 10690>>IF      10695>>ASSIGN  10695>>ASSIGN  11502<<DOINDEX 11503>>IF
     11507>>ASSIGN  11507>>ASSIGN  12334>>IF      12334>>IF      12334>>IF      12337>>ASSIGN  12531<<ASSIGN
     12533<<ASSIGN  12534--ASSIGN  12613<<DOINDEX 12614>>ASSIGN  12614>>ASSIGN  12615>>IF      12616>>ASSIGN
     12619<<ASSIGN  12620>>IF      12621>>ASSIGN  12623>>ASSIGN
I$ACC
      4622**DCL-ENT  9710--CALL
I$ACN
      4621**DCL-ENT  9625--CALL
I$CALC
      4630**DCL-ENT  9576--CALL
I$CHK
      4626**DCL-ENT  9768--CALL
I$CON
      4621**DCL-ENT 12230--CALL
I$CRPT
      4629**DCL-ENT 12407--CALL
I$DIS
      4621**DCL-ENT 12251--CALL
I$ERS
      4621**DCL-ENT  9802--CALL
I$ETC
      4630**DCL-ENT  8972--CALL
I$FAA
      4624**DCL-ENT 10913--CALL
I$FAS
      4624**DCL-ENT 10929--CALL
I$FCD
      4623**DCL-ENT 10663--CALL
I$FCR
      4624**DCL-ENT 10393--CALL
I$FCT
      4624**DCL-ENT 10746--CALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:284  
I$FDC
      4623**DCL-ENT 10646--CALL
I$FDP
      4623**DCL-ENT 10712--CALL
I$FDR
      4625**DCL-ENT  9828--CALL
I$FIN
      4620**DCL-ENT  9549--CALL
I$FKC
      4623**DCL-ENT 10587--CALL
I$FKY
      4623**DCL-ENT 10571--CALL
I$FOR
      4624**DCL-ENT 10863--CALL
I$FRA
      4625**DCL-ENT 10801--CALL
I$FRI
      4626**DCL-ENT 10495--CALL
I$FRS
      4625**DCL-ENT 10819--CALL
I$FUI
      4625**DCL-ENT 10439--CALL
I$GET
      4626**DCL-ENT 11549--CALL
I$GTF
      4626**DCL-ENT 11522--CALL
I$HIA
      4620**DCL-ENT 12653--CALL
I$IFM
      4622**DCL-ENT 12347--CALL
I$IFT
      4622**DCL-ENT 12294--CALL
I$IST
      4622**DCL-ENT 12316--CALL
I$KEEP
      4629**DCL-ENT 12448--CALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:285  
I$MOD
      4621**DCL-ENT 12180--CALL
I$NBF
      4630**DCL-ENT 12388--CALL
I$RDY
      4620**DCL-ENT  8952--CALL
I$REDUCEQ
      4629**DCL-ENT 12466--CALL
I$ROL
      4620**DCL-ENT 12430--CALL
I$RPT
      4629**DCL-ENT 12487--CALL
I$SHALL
      4627**DCL-ENT  8852--CALL
I$SHANY
      4628**DCL-ENT  8884--CALL
I$SHCUR
      4628**DCL-ENT  8900--CALL
I$SHIN
      4627**DCL-ENT  8868--CALL
I$SHINCUR
      4628**DCL-ENT  8916--CALL
I$SHNO
      4628**DCL-ENT  8836--CALL
I$STO
      4620**DCL-ENT  9737--CALL
I$STOFF
      4627**DCL-ENT 12523--CALL
I$STON
      4627**DCL-ENT 12505--CALL
I$TROFF
      4627**DCL-ENT 12548--CALL
I$TRON
      4626**DCL-ENT 12567--CALL
IA.SNAME
      3952**DCL      3953--REDEF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:286  
IA.SSDT
      3964**DCL      3965--REDEF
IA.SSNAME
      3955**DCL      3956--REDEF    5725>>ASSIGN   5747>>ASSIGN
IA.SSTDT
      3965**DCL      5786>>IF
IA$
      3966**DCL      3776--IMP-PTR  3931--IMP-PTR  3976--REDEF    5725>>ASSIGN   5747>>ASSIGN   5786>>IF
      5874>>ASSIGN   5875>>ASSIGN   8959>>DOWHILE  8960>>ASSIGN  12261>>ASSIGN  12262>>IF      12264>>ASSIGN
     12265>>ASSIGN  12269>>IF      12271>>ASSIGN  12272>>ASSIGN  12584<<ASSIGN  12589>>ASSIGN
IA_HALF
      3776**DCL      5874<<ASSIGN   5875<<ASSIGN   8959>>DOWHILE  8960>>ASSIGN  12262>>IF      12264>>ASSIGN
     12265<<ASSIGN  12269>>IF      12271<<ASSIGN  12272>>ASSIGN  12589<<ASSIGN
IDSSYSERR
      3479**DCL     12261<<ASSIGN
IDS_ADR
      3520**DCL      7054>>DOWHILE 12628<<ASSIGN  12630<<ASSIGN  12632<<ASSIGN  12634<<ASSIGN  12636<<ASSIGN
     12638<<ASSIGN  12640<<ASSIGN  12642<<ASSIGN
IDS_BIT9
      3521**DCL      7060>>ASSIGN
II
      3531**DCL      3532--REDEF    7058<<DOINDEX  7061>>ASSIGN   8259<<DOINDEX  8260>>ASSIGN   8260>>ASSIGN
      8261>>ASSIGN
IPT_ACC
      4639**DCL      9710<>CALL
IPT_ACC.DBK_
      4641**DCL      9642<<ASSIGN
IPT_ACC.V
      4641**DCL      9701--ASSIGN
IPT_ACC.V.CCW.SCI#
      4641**DCL      9652<<ASSIGN   9659<<ASSIGN   9664<<ASSIGN   9669<<ASSIGN   9672<<ASSIGN   9675<<ASSIGN
      9678<<ASSIGN
IPT_ACC.V.RVA_ITEM.OFFSET#
      4642**DCL      9651<<ASSIGN   9654<<ASSIGN
IPT_ACC.V_
      4639**DCL      9701<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:287  
IPT_ACN
      4652**DCL      9625<>CALL
IPT_ACN.ANAME_
      4654**DCL      9600<<ASSIGN
IPT_ACN.DBK_
      4654**DCL      9599<<ASSIGN   9613<<ASSIGN
IPT_ACN.V
      4655**DCL      9616--ASSIGN
IPT_ACN.V.NCW.AREA_NME_SIZE#
      4655**DCL      9615<<ASSIGN
IPT_ACN.V.NCW.CI#
      4655**DCL      9604<<ASSIGN   9607<<ASSIGN   9611<<ASSIGN   9612<<ASSIGN
IPT_ACN.V.RVA_ITEM.OFFSET#
      4656**DCL      9605<<ASSIGN   9608<<ASSIGN   9610<<ASSIGN
IPT_ACN.V_
      4652**DCL      9616<<ASSIGN
IPT_CALC
      4666**DCL      9576<>CALL
IPT_CALC.DBK_
      4668**DCL      9566<<ASSIGN
IPT_CALC.V
      4668**DCL      9565--ASSIGN
IPT_CALC.V.UWA_OFFSET
      4668**DCL      9567<<ASSIGN
IPT_CALC.V_
      4666**DCL      9565<<ASSIGN   9582<<ASSIGN
IPT_CHK
      4678**DCL      9768<>CALL
IPT_CHK.CHKPT_NUMBER_
      4678**DCL      9750<<ASSIGN
IPT_CHK.ERROR_
      4678**DCL      9756<<ASSIGN   9758<<ASSIGN
IPT_CHK.IA_
      4678**DCL      9759<<ASSIGN
IPT_CON
      4688**DCL     12230<>CALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:288  
IPT_CON.V
      4690**DCL     12220--ASSIGN
IPT_CON.V.RC.RC_OFFSET#
      4690**DCL     12202<<ASSIGN  12209<<ASSIGN
IPT_CON.V.SC.SC_OFFSET#
      4691**DCL     12203<<ASSIGN  12210<<ASSIGN
IPT_CON.V_
      4688**DCL     12220<<ASSIGN
IPT_CRPT
      4701**DCL     12407<>CALL
IPT_DIS
      4710**DCL     12251<>CALL
IPT_DIS.V
      4712**DCL     12241--ASSIGN
IPT_DIS.V_
      4710**DCL     12241<<ASSIGN
IPT_ERS
      4723**DCL      9802<>CALL
IPT_ERS.V
      4725**DCL      9793--ASSIGN
IPT_ERS.V.ECW.EC_BIT#
      4726**DCL      9789<<ASSIGN   9791<<ASSIGN
IPT_ERS.V.RC.RC_OFFSET#
      4725**DCL      9783<<ASSIGN   9787<<ASSIGN
IPT_ERS.V_
      4723**DCL      9793<<ASSIGN
IPT_ETC
      4735**DCL      8972<>CALL
IPT_ETC.V
      4737**DCL      8963--ASSIGN
IPT_ETC.V_
      4735**DCL      8963<<ASSIGN
IPT_FAA
      4748**DCL     10913<>CALL
IPT_FAA.V
      4750**DCL     10900--ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:289  
IPT_FAA.V.AC.AC_OFFSET#
      4751**DCL     10882<<ASSIGN
IPT_FAA.V.RETENTION_LIST
      4755**DCL     10902--ASSIGN
IPT_FAA.V_
      4748**DCL     10900<<ASSIGN  10902<<ASSIGN  10902>>ASSIGN
IPT_FAS
      4765**DCL     10929<>CALL
IPT_FAS.V
      4767**DCL     10920--ASSIGN
IPT_FAS.V.RC.RC_OFFSET#
      4767**DCL     10892<<ASSIGN  10894<<ASSIGN
IPT_FAS.V.RECORD_NUMBER#
      4767**DCL     10885<<ASSIGN  10888<<ASSIGN  10890<<ASSIGN
IPT_FAS.V.RLCW
      4769**DCL     10895<>CALL
IPT_FAS.V_
      4765**DCL     10920<<ASSIGN
IPT_FCD
      4782**DCL     10663<>CALL
IPT_FCD.V
      4784**DCL     10654--ASSIGN
IPT_FCD.V_
      4782**DCL     10654<<ASSIGN
IPT_FCR
      4797**DCL     10393<>CALL
IPT_FCR.V
      4799**DCL     10384--ASSIGN
IPT_FCR.V.RLCW
      4799**DCL     10383<>CALL
IPT_FCR.V_
      4797**DCL     10384<<ASSIGN
IPT_FCT
      4811**DCL     10746<>CALL
IPT_FCT.V
      4813**DCL     10733--ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:290  
IPT_FCT.V.RC.RC_OFFSET#
      4813**DCL     10731<<ASSIGN
IPT_FCT.V.RETENTION_LIST
      4816**DCL     10735--ASSIGN
IPT_FCT.V.RLCW
      4814**DCL     10732<>CALL
IPT_FCT.V_
      4811**DCL     10733<<ASSIGN  10735<<ASSIGN  10735>>ASSIGN
IPT_FDC
      4826**DCL     10646<>CALL
IPT_FDC.V
      4828**DCL     10633--ASSIGN
IPT_FDC.V.RC.RC_OFFSET#
      4828**DCL     10630<<ASSIGN
IPT_FDC.V.RETENTION_LIST
      4831**DCL     10635--ASSIGN
IPT_FDC.V.RLCW
      4829**DCL     10631<>CALL
IPT_FDC.V_
      4826**DCL     10633<<ASSIGN  10635<<ASSIGN  10635>>ASSIGN
IPT_FDP
      4841**DCL     10712<>CALL
IPT_FDP.V
      4843**DCL     10698--ASSIGN
IPT_FDP.V.FLCW.N_FIELDS#
      4844**DCL     10688<<ASSIGN  10697<>CALL    10699>>IF      10700>>ASSIGN
IPT_FDP.V.FL_RL_LIST
      4847**DCL     10700--ASSIGN
IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#
      4847**DCL     10695<<ASSIGN
IPT_FDP.V.RLCW
      4845**DCL     10697<>CALL
IPT_FDP.V.SC.SC_OFFSET#
      4843**DCL     10687<<ASSIGN
IPT_FDP.V_
      4841**DCL     10698<<ASSIGN  10700<<ASSIGN  10700>>ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:291  
IPT_FDR
      4857**DCL      9828<>CALL
IPT_FDR.DBK_
      4859**DCL     10520<<ASSIGN  10612<<ASSIGN
IPT_FDR.V
      4859**DCL      9815--ASSIGN
IPT_FDR.V.RC.RC_OFFSET#
      4859**DCL     10519<<ASSIGN  10611<<ASSIGN
IPT_FDR.V.RETENTION_LIST
      4863**DCL      9817--ASSIGN
IPT_FDR.V.RLCW
      4860**DCL      9814<>CALL
IPT_FDR.V_
      4857**DCL      9815<<ASSIGN   9817<<ASSIGN   9817>>ASSIGN
IPT_FIN
      4873**DCL      9549<>CALL
IPT_FIN.V
      4875**DCL      9538--ASSIGN
IPT_FIN.V.AC_OFFSETS
      4876**DCL      9539--ASSIGN
IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#
      4876**DCL      9535<<ASSIGN
IPT_FIN.V.ALCW.N_AREAS#
      4875**DCL      9537<<ASSIGN
IPT_FIN.V_
      4873**DCL      9538<<ASSIGN   9539<<ASSIGN   9539>>ASSIGN
IPT_FKC
      4886**DCL     10587<>CALL
IPT_FKC.V
      4888**DCL     10554--ASSIGN
IPT_FKC.V.FLCW.N_FIELDS#
      4890**DCL     10552<<ASSIGN  10553<>CALL    10555>>IF      10557>>ASSIGN
IPT_FKC.V.FL_RL_LIST
      4893**DCL     10557--ASSIGN
IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#
      4893**DCL     10550<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:292  
IPT_FKC.V.RC.RC_OFFSET#
      4888**DCL     10540<<ASSIGN
IPT_FKC.V.RLCW
      4890**DCL     10553<>CALL
IPT_FKC.V.SC.SC_OFFSET#
      4889**DCL     10541<<ASSIGN
IPT_FKC.V_
      4886**DCL     10554<<ASSIGN  10557<<ASSIGN  10557>>ASSIGN
IPT_FKY
      4903**DCL     10571<>CALL
IPT_FOR
      4920**DCL     10863<>CALL
IPT_FOR.V
      4922**DCL     10850--ASSIGN
IPT_FOR.V.RETENTION_LIST
      4925**DCL     10852--ASSIGN
IPT_FOR.V.RLCW
      4923**DCL     10849<>CALL
IPT_FOR.V.SC.SC_OFFSET#
      4922**DCL     10848<<ASSIGN
IPT_FOR.V_
      4920**DCL     10850<<ASSIGN  10852<<ASSIGN  10852>>ASSIGN
IPT_FRA
      4935**DCL     10801<>CALL
IPT_FRA.V
      4937**DCL     10792--ASSIGN
IPT_FRA.V_
      4935**DCL     10792<<ASSIGN
IPT_FRI
      4952**DCL     10495<>CALL
IPT_FRI.V
      4954**DCL     10482--ASSIGN
IPT_FRI.V.FCW.RECORD_LOCATION#
      4954**DCL     10449<<ASSIGN  10452<<ASSIGN
IPT_FRI.V.RC.RC_OFFSET#
      4955**DCL     10467<<ASSIGN  10472<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:293  
IPT_FRI.V.RETENTION_LIST
      4959**DCL     10484--ASSIGN
IPT_FRI.V.RLCW
      4956**DCL     10481<>CALL
IPT_FRI.V.SC.SC_OFFSET#
      4956**DCL     10468<<ASSIGN  10473<<ASSIGN
IPT_FRI.V_
      4952**DCL     10482<<ASSIGN  10484<<ASSIGN  10484>>ASSIGN
IPT_FRS
      4969**DCL     10819<>CALL
IPT_FRS.V
      4971**DCL     10808--ASSIGN
IPT_FRS.V.FCW.RECORD_LOCATION#
      4971**DCL     10766<<ASSIGN  10769<<ASSIGN  10771<<ASSIGN
IPT_FRS.V.RC.RC_OFFSET#
      4972**DCL     10780<<ASSIGN  10783<<ASSIGN
IPT_FRS.V.RETENTION_LIST
      4976**DCL     10809--ASSIGN
IPT_FRS.V.RLCW
      4973**DCL     10788<>CALL
IPT_FRS.V.SC.SC_OFFSET#
      4973**DCL     10781<<ASSIGN  10784<<ASSIGN
IPT_FRS.V_
      4969**DCL     10808<<ASSIGN  10809<<ASSIGN  10809>>ASSIGN
IPT_FUI
      4986**DCL     10439<>CALL
IPT_FUI.V
      4988**DCL     10425--ASSIGN
IPT_FUI.V.RC.RC_OFFSET#
      4988**DCL     10423<<ASSIGN
IPT_FUI.V.RETENTION_LIST
      4992**DCL     10427--ASSIGN
IPT_FUI.V.RLCW
      4990**DCL     10430<>CALL
IPT_FUI.V.SC.SC_OFFSET#
      4989**DCL     10424<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:294  
IPT_FUI.V_
      4986**DCL     10425<<ASSIGN  10427<<ASSIGN  10427>>ASSIGN
IPT_GET
      5002**DCL     11549<>CALL
IPT_GET.V
      5004**DCL     11540--ASSIGN
IPT_GET.V.RC.RC_OFFSET#
      5004**DCL     11532<<ASSIGN  11535<<ASSIGN
IPT_GET.V_
      5002**DCL     11540<<ASSIGN
IPT_GTF
      5014**DCL     11522<>CALL
IPT_GTF.V
      5016**DCL     11509--ASSIGN
IPT_GTF.V.FIELD_LIST
      5017**DCL     11511--ASSIGN
IPT_GTF.V.FIELD_LIST.RVA_OFFSET#
      5017**DCL     11507<<ASSIGN
IPT_GTF.V.FLCW.N_FIELDS#
      5016**DCL     11501<<ASSIGN
IPT_GTF.V_
      5014**DCL     11509<<ASSIGN  11511<<ASSIGN  11511>>ASSIGN
IPT_HIA
      5027**DCL     12653<>CALL
IPT_IFM
      5038**DCL     12347<>CALL
IPT_IFM.V
      5040**DCL     12338--ASSIGN
IPT_IFM.V.SC.SC_OFFSET#
      5040**DCL     12337<<ASSIGN
IPT_IFM.V_
      5038**DCL     12338<<ASSIGN
IPT_IFT
      5050**DCL     12294<>CALL
IPT_IFT.V
      5052**DCL     12285--ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:295  
IPT_IFT.V_
      5050**DCL     12285<<ASSIGN
IPT_IST
      5076**DCL     12316<>CALL
IPT_IST.V
      5078**DCL     12307--ASSIGN
IPT_IST.V.SC.SC_OFFSET#
      5079**DCL     12306<<ASSIGN
IPT_IST.V.TDW
      5078**DCL     12282<<ASSIGN
IPT_IST.V_
      5076**DCL     12307<<ASSIGN
IPT_KEEP
      5115**DCL     12448<>CALL
IPT_KEEP.ERROR_
      5115**DCL     12439<<ASSIGN
IPT_MOD
      5089**DCL     12180<>CALL
IPT_MOD.V
      5091**DCL     12166--ASSIGN  12167--ASSIGN
IPT_MOD.V.FLCW.N_FIELDS#
      5093**DCL     12127<<ASSIGN  12127>>ASSIGN  12137>>IF      12152>>ASSIGN
IPT_MOD.V.FL_SL_LIST
      5094**DCL     12169--ASSIGN
IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#
      5095**DCL     12126<<ASSIGN  12152<<ASSIGN
IPT_MOD.V.MCW.MC_BIT0#
      5092**DCL     12136<<ASSIGN
IPT_MOD.V.MCW.MC_BIT1#
      5092**DCL     12144<<ASSIGN
IPT_MOD.V.RC.RC_OFFSET#
      5091**DCL     12112<<ASSIGN  12121<<ASSIGN
IPT_MOD.V.SLCW.N_SETS#
      5094**DCL     12152>>ASSIGN  12155<<ASSIGN  12155>>ASSIGN
IPT_MOD.V_
      5089**DCL     12166<<ASSIGN  12167<<ASSIGN  12169<<ASSIGN  12169>>ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:296  
IPT_NBF
      5105**DCL     12388<>CALL
IPT_NBF.BUFFS_ALLOC_
      5105**DCL     12379<<ASSIGN
IPT_NBF.BUFFS_REQ_
      5105**DCL     12378<<ASSIGN
IPT_RDY
      5133**DCL      8952<>CALL
IPT_RDY.V
      5135**DCL      8941--ASSIGN
IPT_RDY.V.AC_OFFSETS
      5136**DCL      8942--ASSIGN
IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#
      5137**DCL      8938<<ASSIGN
IPT_RDY.V.RDCW.AREAS_TO_READY#
      5136**DCL      8940<<ASSIGN
IPT_RDY.V.RDCW.READY_OPTION#
      5135**DCL      8924<<ASSIGN   8927<<ASSIGN   8930<<ASSIGN
IPT_RDY.V_
      5133**DCL      8941<<ASSIGN   8942<<ASSIGN   8942>>ASSIGN
IPT_REDUCEQ
      5124**DCL     12466<>CALL
IPT_ROL
      5147**DCL     12430<>CALL
IPT_STO
      5156**DCL      9737<>CALL
IPT_STO.V
      5158**DCL      9727--ASSIGN
IPT_STO.V.RC.RC_OFFSET#
      5158**DCL      9726<<ASSIGN
IPT_STO.V.RLCW
      5159**DCL      9728<>CALL
IPT_STO.V_
      5156**DCL      9727<<ASSIGN
IPT_TROFF
      5180**DCL     12548<>CALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:297  
IPT_TRON
      5171**DCL     12567<>CALL
IX
      3469**DCL      3468--IMP-SIZ 12609<<ASSIGN  12610>>ASSIGN  12610>>ASSIGN
J
      3486**DCL      3487--REDEF    5780<<ASSIGN   5782>>DOWHILE  5783<<ASSIGN   5783>>ASSIGN   5785>>ASSIGN
      5838<<ASSIGN   7053<<ASSIGN   7054>>DOWHILE  7054>>DOWHILE  7055<<ASSIGN   7055>>ASSIGN   7057>>IF
      7060>>ASSIGN   7624<<ASSIGN   7626<<CALLBLT  7628>>ASSIGN   8227<<DOINDEX  8822<<ASSIGN   8920<<ASSIGN
      8922>>ASSIGN   8936>>DOINDEX 10544<<DOINDEX 10549>>IF      10550>>ASSIGN  10550>>ASSIGN
JJ
      3533**DCL      3534--REDEF    7040<<ASSIGN   7041>>DOWHILE  7042<<ASSIGN   7042>>ASSIGN   7044>>IF
      7051>>DOINDEX  7058>>DOINDEX  7062>>ASSIGN
K
      3485**DCL      3481--IMP-SIZ  5837<<ASSIGN   5838>>ASSIGN   5841>>ASSIGN   5846>>ASSIGN   5849>>IF
      5851<<ASSIGN   5851>>ASSIGN   5852>>IF       5854>>ASSIGN   5855>>ASSIGN   7030<<ASSIGN   7033<<ASSIGN
      7036<<ASSIGN   7041>>DOWHILE  7044>>IF       7059>>ASSIGN   8194<<ASSIGN   8195>>DOWHILE  8196>>IF
      8198>>ASSIGN   8202>>IF       8205>>IF       8208>>IF       8212<<ASSIGN   8212>>ASSIGN   8220<<ASSIGN
      8221>>CALLBLT  8223>>IF       8224<<ASSIGN   8224>>ASSIGN   8228>>DOWHILE  8228>>DOWHILE  8231>>CALLBLT
      8233>>IF       8234<<ASSIGN   8235>>ASSIGN  12115<<ASSIGN  12119<<ASSIGN  12125>>DOWHILE 12125>>DOWHILE
     12126>>ASSIGN  12126>>ASSIGN  12128<<ASSIGN  12128>>ASSIGN  12132>>IF      12132>>IF      12132>>IF
     12134>>IF      12142<<ASSIGN  12142>>ASSIGN  12143>>IF      12147>>DOWHILE 12148>>IF      12152>>ASSIGN
     12156<<ASSIGN  12156>>ASSIGN  12162>>IF
KK
      3535**DCL      7050<<ASSIGN   7059>>ASSIGN   7060>>ASSIGN   7061>>ASSIGN   7062>>ASSIGN   7063<<ASSIGN
      7063>>ASSIGN   7066>>ASSIGN  12116<<ASSIGN  12120<<ASSIGN  12129<<ASSIGN  12129>>ASSIGN  12157<<ASSIGN
     12157>>ASSIGN  12168>>IF      12169>>ASSIGN
LOW
      3532**DCL      5831<<ASSIGN   5834>>IF       5837>>ASSIGN   5837>>ASSIGN   5841<<ASSIGN
M$ERR
      5218**DCL-ENT  6440--CALL
M$ERRMSG
      5269**DCL-ENT  6439--CALL
M$FDS
      5241**DCL-ENT  5742--CALL
M$GDP
      5242**DCL-ENT  6451--CALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:298  
M$GETDCB
      5212**DCL-ENT  5734--CALL     5754--CALL
M$MERC
      5262**DCL-ENT  5797--CALL
M$OPEN
      5206**DCL-ENT  5776--CALL
M$RELDCB
      5212**DCL-ENT  5774--CALL
M$XXX
      5218**DCL-ENT  5790--CALL
M$YC
      5220**DCL-ENT  8236--CALL
MODIFY
     11558**ENTRY   12629--ASSIGN
NINE_WORDS
      3512**DCL      6422<<ASSIGN
NO_ARGS
      3513**DCL      5811>>ASSIGN   5816>>ASSIGN   5817>>ASSIGN   5823>>ASSIGN   5827>>ASSIGN   5854>>ASSIGN
      5855>>ASSIGN   5859<<ASSIGN   5859>>ASSIGN   5880<<ASSIGN   7040>>ASSIGN   7044>>IF       7046>>ASSIGN
      7047<<ASSIGN   7047>>ASSIGN   7058>>DOINDEX  7622>>DOINDEX  8195>>DOWHILE  8823>>ASSIGN   8922>>ASSIGN
      8936>>DOINDEX  9533>>DOINDEX  9561>>IF       9597>>IF       9611>>IF       9643>>DOCASE   9725>>IF
      9748>>IF       9748>>IF       9784>>IF      10381>>IF      10404>>IF      10405>>IF      10470>>IF
     10542>>IF      10544>>DOINDEX 10552>>ASSIGN  10625>>IF      10682>>IF      10688>>ASSIGN  10689>>DOINDEX
     10721>>IF      10772>>DOCASE  10789>>DOCASE  10844>>IF      10882>>ASSIGN  10891>>IF      10896>>IF
     10897>>DOCASE  11499>>IF      11501>>ASSIGN  11502>>DOINDEX 11510>>IF      11511>>ASSIGN  11531>>IF
     12113>>IF      12125>>DOWHILE 12132>>IF      12147>>DOWHILE 12162>>IF      12194>>DOCASE  12283>>DOCASE
NULL_OFFSET
      3781**DCL      9610>>ASSIGN   9651>>ASSIGN   9783>>ASSIGN  10472>>ASSIGN  10611>>ASSIGN  10783>>ASSIGN
     10894>>ASSIGN  11532>>ASSIGN  12112>>ASSIGN  12209>>ASSIGN  12607<<ASSIGN  12616<<ASSIGN
OFFSET IN PROCEDURE CHK_RETAIN
      8251**DCL      8244--PROC     8259>>DOINDEX  8259>>DOINDEX  8260>>ASSIGN
OPEN_SDS IN PROCEDURE SDS$OPEN
      5610**DCL      5776<>CALL
OPEN_SDS.ACCT_ IN PROCEDURE SDS$OPEN
      5614**DCL      5759<<ASSIGN   5764<<ASSIGN
OPEN_SDS.ACSVEH_ IN PROCEDURE SDS$OPEN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:299  
      5612**DCL      5613--REDEF
OPEN_SDS.ALTKEYS_ IN PROCEDURE SDS$OPEN
      5618**DCL      5619--REDEF    5619--REDEF
OPEN_SDS.HDR_ IN PROCEDURE SDS$OPEN
      5617**DCL      5618--REDEF
OPEN_SDS.NAME_ IN PROCEDURE SDS$OPEN
      5611**DCL      5771<<ASSIGN
OPEN_SDS.TAB_ IN PROCEDURE SDS$OPEN
      5616**DCL      5617--REDEF
OPEN_SDS.UHL_ IN PROCEDURE SDS$OPEN
      5610**DCL      5611--REDEF    5611--REDEF
OPEN_SDS.V IN PROCEDURE SDS$OPEN
      5619**DCL      5610--DCLINIT
OPEN_SDS.V.DCB# IN PROCEDURE SDS$OPEN
      5619**DCL      5739<<ASSIGN
OPEN_SDS.V.FSN# IN PROCEDURE SDS$OPEN
      5650**DCL      5650--REDEF    5650--REDEF
OPEN_SDS.WSN_ IN PROCEDURE SDS$OPEN
      5616**DCL      5616--REDEF
OUT_OF_MEMORY IN PROCEDURE GET_A_PAGE
      6464**LABEL    6451--CALLALT
PAGE_VECTOR
      5189**DCL      5291--DCLINIT
PAGE_VECTOR.ADR
      5191**DCL      5877>>IF       6452>>ASSIGN  12590>>IF
PT$
      3503**DCL      3481--IMP-PTR  3504--REDEF    3505--REDEF    7052<<ASSIGN   8219<<ASSIGN   8221>>CALLBLT
      8225<<ASSIGN   8225>>ASSIGN   8228>>DOWHILE  8231>>CALLBLT  8233>>IF       8235>>ASSIGN  12606<<ASSIGN
     12607>>ASSIGN  12608<<ASSIGN  12608>>ASSIGN  12610>>ASSIGN
P_OFF_W
      5406**PROC     5813--CALL     5821--CALL     5826--CALL    12333--CALL
REDEF_E$.ADR
      3510**DCL     12628>>ASSIGN  12630>>ASSIGN  12632>>ASSIGN  12634>>ASSIGN  12636>>ASSIGN  12638>>ASSIGN
     12640>>ASSIGN  12642>>ASSIGN
REDEF_J.NAME
      3490**DCL      5839>>IF       5844>>IF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:300  
REDEF_PT.ADR
      3506**DCL      7054>>DOWHILE  8960<<ASSIGN  12264<<ASSIGN
REDEF_PT.SEG#
      3507**DCL      8961<<ASSIGN  12266<<ASSIGN
RETAIN_SWITCH
      3530**DCL      8214<<ASSIGN   8253>>IF       8257<<ASSIGN   8979<<ASSIGN
RLCW IN PROCEDURE CHK_RETAIN
      8246**DCL      8244--PROC
RLCW.FLAGS IN PROCEDURE CHK_RETAIN
      8247**DCL      8254<<ASSIGN   8258<<ASSIGN
RLCW.LISTS.MBZ IN PROCEDURE CHK_RETAIN
      8250**DCL      8261<<ASSIGN
RLCW.LISTS.RVA_OFFSET# IN PROCEDURE CHK_RETAIN
      8249**DCL      8260<<ASSIGN
RLCW$
      3985**DCL      1231--IMP-PTR  6454<<ASSIGN   6455>>ASSIGN   8190>>ASSIGN   8198>>ASSIGN   8198>>ASSIGN
      8199>>ASSIGN   8199>>ASSIGN   8203>>ASSIGN   8206>>ASSIGN   8209>>ASSIGN   8258>>ASSIGN   8259>>DOINDEX
      8260>>ASSIGN   9816>>IF       9817>>ASSIGN  10426>>IF      10427>>ASSIGN  10483>>IF      10484>>ASSIGN
     10555>>IF      10557>>ASSIGN  10634>>IF      10635>>ASSIGN  10699>>IF      10700>>ASSIGN  10734>>IF
     10735>>ASSIGN  10809>>ASSIGN  10851>>IF      10852>>ASSIGN  10901>>IF      10902>>ASSIGN
RLCW_SAVE
      1231**DCL      8190--ASSIGN   8258--ASSIGN
RLCW_SAVE.AC_INDICATORS
      1233**DCL      8203<<ASSIGN
RLCW_SAVE.N_SETS#
      1237**DCL      8198>>ASSIGN   8199<<ASSIGN   8199>>ASSIGN   8259>>DOINDEX  9816>>IF       9817>>ASSIGN
     10426>>IF      10427>>ASSIGN  10483>>IF      10484>>ASSIGN  10555>>IF      10557>>ASSIGN  10634>>IF
     10635>>ASSIGN  10699>>IF      10700>>ASSIGN  10734>>IF      10735>>ASSIGN  10809>>ASSIGN  10851>>IF
     10852>>ASSIGN  10901>>IF      10902>>ASSIGN
RLCW_SAVE.RC_INDICATORS
      1235**DCL      8209<<ASSIGN
RLCW_SAVE.RETAIN_LIST
      1238**DCL      8198<<ASSIGN   8260>>ASSIGN
RLCW_SAVE.SC_INDICATORS
      1234**DCL      8206<<ASSIGN
RVA
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:301  
      3774**DCL      5838>>ASSIGN
RVA$
      3980**DCL      3774--IMP-PTR  3775--IMP-PTR  5813<>CALL     5838>>ASSIGN   7061>>ASSIGN   9567>>ASSIGN
     12333<>CALL    12586<<ASSIGN  12587>>IF      12592>>IF      12593>>ASSIGN  12595>>ASSIGN  12600>>IF
     12600>>IF      12603>>IF      12606>>ASSIGN  12614>>ASSIGN  12615>>IF
RVA_HALF
      3775**DCL      7061>>ASSIGN   9567>>ASSIGN  12592>>IF      12593>>ASSIGN  12595>>ASSIGN  12600>>IF
     12614>>ASSIGN  12615>>IF
RVA_SIZE
      3780**DCL      5814>>IF       5832>>ASSIGN  12334>>IF      12593<<ASSIGN  12595<<ASSIGN  12599<>CALL
     12606>>ASSIGN  12609>>ASSIGN  12613>>DOINDEX 12619>>ASSIGN
RVA_TYPE
      3467**DCL      5817>>ASSIGN   5849>>IF       5852>>IF       5855>>ASSIGN  12334>>IF      12614<<ASSIGN
RVA_TYPEC
      3468**DCL     12610<<ASSIGN  12610>>ASSIGN
SBIN36
      3491**DCL      8190<<ASSIGN   8239>>ASSIGN   8258>>ASSIGN  12261>>ASSIGN  12398<<ASSIGN  12607>>ASSIGN
SDS$OPEN
      5435**PROC    12588--CALL
SDSDCB
      3537**DCL      5527--DCLINIT  5737--IF       5739>>ASSIGN   5744--IF
SDSFLAG
      3539**DCL     12600>>IF      12602<<ASSIGN
SDS_NAME IN PROCEDURE SDS$OPEN
      5679**DCL      5526--DCLINIT
SDS_NAME.L# IN PROCEDURE SDS$OPEN
      5679**DCL      5724<<ASSIGN   5726>>DOWHILE  5727<<ASSIGN   5727>>ASSIGN   5729>>CALLBLT  5730<<ASSIGN
      5730>>ASSIGN   5746>>ASSIGN
SDS_NAME.NAME# IN PROCEDURE SDS$OPEN
      5679**DCL      5725<<ASSIGN   5726>>DOWHILE  5729<<CALLBLT
SET_ARGS
      5872**PROC     7028--CALL     8191--CALL     8818--CALL     9530--CALL     9587--CALL     9724--CALL
      9747--CALL     9782--CALL    10380--CALL    11498--CALL    12111--CALL    12192--CALL    12281--CALL
SET_ARGS1 IN PROCEDURE SET_ARGS
      5876**ENTRY    7621--CALL     9560--CALL
SNA
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:302  
      1173**DCL      5821--CALL
SNA.ALL
      1174**DCL      7623>>IF       9788>>IF       9791--IF      12143>>IF
SNA.ANY
      1175**DCL     10632>>IF
SNA.AREA
      1190**DCL      8202>>IF
SNA.AREANAME
      1191**DCL      9597>>IF
SNA.CURRENCY
      1176**DCL      9646>>IF       9658>>IF       9663>>IF       9668>>IF
SNA.CURRENT
      1177**DCL     10381>>IF      10542>>IF      10721>>IF      10768>>IF
SNA.DBKEY
      1178**DCL     10508>>IF
SNA.FIRST
      1180**DCL     10448>>IF
SNA.INCLUDING
      1181**DCL     12132>>IF
SNA.ITEM
      1182**DCL      7035>>IF
SNA.LOAD
      1184**DCL      8929>>IF
SNA.NEXT
      1185**DCL      9671>>IF      10451>>IF
SNA.NOSHALL
      1186**DCL      8824>>IF
SNA.ONLY
      1187**DCL     12132>>IF      12134>>IF
SNA.OWNER
      1188**DCL      9677>>IF
SNA.PRIOR
      1189**DCL      9674>>IF      10765>>IF
SNA.RECORD
      1192**DCL      7032>>IF       8208>>IF
SNA.RETRIEVAL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:303  
      1193**DCL      8926>>IF
SNA.SET
      1194**DCL      7029>>IF
SNA.SETS
      1195**DCL      8205>>IF
SNA.SHAREALL
      1196**DCL      8840>>IF
SNA.SHAREANY
      1197**DCL      8872>>IF
SNA.SHAREIN
      1198**DCL      8856>>IF
SNA.SHCUR
      1202**DCL      8888>>IF
SNA.SHINCUR
      1203**DCL      8904>>IF
SNA.UPDATE
      1199**DCL      8923>>IF
SNA.USING
      1200**DCL     10405>>IF      10458>>IF
SNA.WITHIN
      1201**DCL     10523>>IF
STORE
      9720**ENTRY   12631--ASSIGN
SUBDCB
      3538**DCL      5752--ASSIGN   5755--IF       5758--ASSIGN   5759--ASSIGN   5773>>ASSIGN
TRACE_COMMON
     12528**PROC    12539--CALL    12558--CALL
TYPE$
      3986**DCL      3467--IMP-PTR  3468--IMP-PTR  5817>>ASSIGN   5849>>IF       5852>>IF       5855>>ASSIGN
      6455<<ASSIGN  12334>>IF      12610>>ASSIGN  12614>>ASSIGN
USEP
      1245**DCL     12626--ASSIGN
USEP.FLAG
      1246**DCL     12625<<ASSIGN
USEP.M
      1247**DCL      7050>>ASSIGN   7066<<ASSIGN   7627>>ASSIGN   7628>>ASSIGN   7629>>ASSIGN   7630<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:304  
      7630>>ASSIGN  12624<<ASSIGN
USEP.UC.ENT$
      1257**DCL      7062<<ASSIGN   7629<<ASSIGN
USEP.UC.UCW_PRV
      1250**DCL      1254--REDEF
USEP.UC.UCW_PRV.A
      1253**DCL      7061<<ASSIGN
USEP.UC.UCW_PRV.PB
      1252**DCL      7060<<ASSIGN
USEP.UC.UCW_PRV.PT
      1251**DCL      7059<<ASSIGN
USEP.UC.UCW_USE.CODE
      1256**DCL      7628<<ASSIGN
USEP.UC.UCW_USE.PT
      1255**DCL      7627<<ASSIGN
USEP$
      3983**DCL      1245--IMP-PTR  7050>>ASSIGN   7059>>ASSIGN   7060>>ASSIGN   7061>>ASSIGN   7062>>ASSIGN
      7066>>ASSIGN   7627>>ASSIGN   7627>>ASSIGN   7628>>ASSIGN   7628>>ASSIGN   7629>>ASSIGN   7629>>ASSIGN
      7630>>ASSIGN   7630>>ASSIGN  12621<<ASSIGN  12623<<ASSIGN  12624>>ASSIGN  12625>>ASSIGN  12626>>ASSIGN
UWA
      3777**DCL     12300>>ASSIGN  12322>>ASSIGN  12358>>ASSIGN
UWA$
      3979**DCL      3777--IMP-PTR  5826<>CALL     5830>>ASSIGN   9756>>ASSIGN  12300>>ASSIGN  12322>>ASSIGN
     12358>>ASSIGN  12418>>ASSIGN  12439>>ASSIGN  12585<<ASSIGN
UWA_SIZE
      3779**DCL      5828>>IF      12596<<ASSIGN  12598<>CALL
VEC IN PROCEDURE SDS$OPEN
      5719**DCL      5511--DCLINIT
VEC.W2 IN PROCEDURE SDS$OPEN
      5720**DCL      5721--REDEF
VEC_MAKER
      5424**PROC    12597--CALL    12598--CALL    12599--CALL
VLP_NAME IN PROCEDURE SDS$OPEN
      5706**DCL      5751--ASSIGN   5758<<ASSIGN   5771--ASSIGN
VLP_NAME.L# IN PROCEDURE SDS$OPEN
      5706**DCL      5746<<ASSIGN   5767>>CALLBLT  5768<<ASSIGN   5768>>ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT.:ZIC0TSI                       FRI 09/05/97 12:27 Page:305  
VLP_NAME.NAME# IN PROCEDURE SDS$OPEN
      5706**DCL      5747<<ASSIGN   5767<<CALLBLT
YC_ERROR
      8239**LABEL    8236--CALLALT
