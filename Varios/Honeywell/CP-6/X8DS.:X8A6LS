VERSION A06

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:1    
        1        1        /*M* X8DS$DISPLAY_SYSOUT -- Display sysout or console               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P*
        9        9
       10       10              NAME: X8DS$DISPLAY_SYSOUT
       11       11           PURPOSE: To DISPLAY identifiers and literals upon a device
       12       12                    (Sysout or Console)
       13       13
       14       14
       15       15        */
       16       16        /*D*
       17       17
       18       18              NAME: X8DS$DISPLAY_SYSOUT
       19       19              CALL: Example: DISPLAY A1,A2,A3
       20       20                       ...
       21       21                     EPPR1    .DATA.+0   (#ARGS = 2)
       22       22                     EPPR0    .DATA.+1   (ARG-LIST)
       23       23                     TSX0     X9OS+9     (OPERATOR SEGMENT)
       24       24                       ...
       25       25              .DATA. ZERO     2,0        (#ARGS = 2)
       26       26                     PTR      ACTUAL-ARGLIST
       27       27                     PTR      ACTUAL-DESCLIST
       28       28                       ...
       29       29              ALIST  PTR      A1
       30       30                     PTR      A2
       31       31                     PTR      A3
       32       32              DLIST  ZERO     3,3        (#ACTUAL ARGS , DESC)
       33       33                     VFD      6/TYPE1,6/0,24/LENGTH1
       34       34                     VFD      6/TYPE2,6/0,12/S.F.1,12/LENGTH2
       35       35                     VFD      6/TYPE3,6/0,EITHER OF THE ABOVE
       36       36
       37       37                    For unpacked decimal types(41 -> 45) the length is
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:2    
       38       38                    12 bits for scale factor and 12 bits for length.
       39       39                    In the case of alpha numeric data the length is 24 bits.
       40       40
       41       41         INTERFACE:
       42       42                    1.) CUTLINE - Internal procedure which cuts an ident or literal
       43       43                        if it exceeds the maximum hardware device output buffer
       44       44                        length
       45       45                     2.) X9LP$PRINT- Calls the appropriate output routine according
       46       46                        to which O/S option bit is set.
       47       47             INPUT:
       48       48                    1.) Array of pointers pointing to the args.
       49       49                    2.) # of args and # of desc followed by an array of desc cor-
       50       50                        responding to the args
       51       51            OUTPUT: Args displayed upon device .
       52       52           SCRATCH: None
       53       53         REFERENCE: X8LC$DOCUMENT, NAME DISPLAY_DESCRIPTION, TYPE F
       54       54
       55       55
       56       56        */
       57       57        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:3    
       58       58        /*-----------------*/
       59       59        X8DS$DISPLAY_SYSOUT:          PROC (ARGS, DESC);
       60       60        /*-----------------*/
       61       61
       62       62            %INCLUDE X8A_LIBCOM;
       63      282            %INCLUDE X8A_MACROS;
       64      539            %INCLUDE X9A_MACROS;
       65      570            %INCLUDE X8A_ERRCOM;
       66      659            %INCLUDE X9A_TYPES;
       67     4208
       68     4209        %EQU MAX_LENGTH = 8191 ; /* Maximum variable size */
       69     4210
       70     4211        /* Factors -- Size_In_Buffer / Size_On_Device */
       71     4212
       72     4213        %EQU FACTOR_KATAKANA = 1 ;
       73     4214        %EQU FACTOR_ASCII    = 1 ;
       74     4215        %EQU FACTOR_KANJI    = 2 ; /* 2 bytes per display column */
       75     4216
       76     4217    1   DCL X9LP$PRINT                ENTRY (3);
       77     4218    1   DCL X8ER$ERROR                ENTRY (3);
       78     4219    1   DCL X9MV                      ENTRY (4);     /* gmap MVN */
       79     4220    1   DCL X9RD$CVRD                 ENTRY (3);     /* REAL -> DEC */
       80     4221    1   DCL X9RD$CVQD                 ENTRY (3);     /* REAL DOUBLE -> DEC */
       81     4222
       82     4223    1   DCL ARGS(0:8191)            PTR ; /* Array of pointers to arguments */
       83     4224    1   DCL 1 DESC ALIGNED,               /* 2nd arg - descriptors and # of them */
       84     4225            %DCL_RT_DESC( @DIM = "(0:8191)" );
       85     4247
       86     4248    1   DCL DISPLAY_CODE      SBIN WORD;
       87     4249    1   DCL OVERFLOW_CODE     SBIN WORD;
       88     4250    1   DCL L                 SBIN WORD;  /* Subscript for arrays of args,desc*/
       89     4251    1   DCL J                 SBIN WORD;  /* Scratch variable for loops, etc.*/
       90     4252    1   DCL I                 SBIN WORD;  /* Contains the length of args     */
       91     4253    1   DCL ITEMP             SBIN WORD;  /* Temp length of args             */
       92     4254    1   DCL DISPLAY_COUNT     SBIN WORD;  /* Length of current items to Display*/
       93     4255    1   DCL BUFFER_COUNT      SBIN WORD ; /* Amount used in record buffer   */
       94     4256    1   DCL LINE_LENGTH       UBIN WORD ;    /* Line Length = 72 or 132 */
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:4    
       95     4257    1   DCL DISPLAY_STRING    CHAR(396);     /* String to hold Display items */
       96     4258    1   DCL DATA              CHAR(I) BASED; /* Variable for each argument */
       97     4259    1   DCL TEMP_ARG            CHAR(90);
       98     4260    1   DCL RESULT_STR          CHAR(90) ;/* Used in forming var len temp*/
       99     4261    1   DCL RESULT_ARG$                PTR  ;/* Same as RESULT_STR*/
      100     4262    1   DCL RESULT_ARG             CHAR(I) BASED(RESULT_ARG$);
              4262            /* The variable length temp  */
      101     4263    1   DCL CHR_EXP           CHAR(4); /* The expanded exponent              */
      102     4264    1   DCL FLOAT_NUM         CHAR(I) BASED; /* Variable used for Floating args*/
      103     4265
      104     4266    1   DCL 1    EXPON,       /* Structure for dissasembling exponents       */
      105     4267    1        2   EXPONEN      CHAR(1) UNAL, /* The actual exponent           */
      106     4268    1        2   EXPONENT   REDEF EXPONEN, /* Exponent at the bit level    */
      107     4269    1         3  *            BIT(1) UNAL, /* Always zero                    */
      108     4270    1         3  EXP          SBIN(8) UNAL;/* signed number for the exponent */
      109     4271
      110     4272    1   DCL 1    LARGE_EXPON,
      111     4273    1         2  EXPONEN      CHAR(1)  UNAL,
      112     4274    1         2  EXPONENT     REDEF EXPONEN,
      113     4275    1           3 EXP         SBIN(9)  UNAL;
      114     4276
      115     4277    1   DCL 1 SEND_DESC            ALIGNED,
      116     4278            %DESCRIPTOR(ENDING = YES);
      117     4306
      118     4307    1   DCL 1 REC_DESC             ALIGNED,
      119     4308            %DESCRIPTOR(ENDING = YES);
      120     4336
      121     4337    1   DCL SIGN_TYPE              BIT(2);
      122     4338    1   DCL OVP_SIGN               CHAR(1);
      123     4339    1   DCL SIGN                   CHAR(1);
      124     4340    1   DCL OVPNUM                 CHAR(1);
      125     4341    1   DCL LENGTH                 UBIN(12);
      126     4342    1   DCL SEND_FLD               CHAR(63);
      127     4343    1   DCL REC_FLD                CHAR(63);
      128     4344
      129     4345    1   DCL ZEROES         CHAR(0) CONSTANT INIT
      130     4346    1                      ('0000000000000000000000000000000');
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:5    
      131     4347
      132     4348    1   DCL DESCRIPTOR     UBIN WORD;
      133     4349    1   DCL 1 DES_WORD     REDEF    DESCRIPTOR,
      134     4350    1         2 *          UBIN HALF UNAL,
      135     4351    1         2 *          UBIN (3) UNAL,
      136     4352    1         2 TN         UBIN(1)  UNAL,
      137     4353    1         2 *          UBIN(8)  UNAL,
      138     4354    1         2 N          UBIN(6)  UNAL;
      139     4355
      140     4356    1   DCL FLOAT_SINGLE   UBIN WORD BASED( ARGS );
      141     4357    1   DCL FLOAT_DOUBLE   CHAR(3) BASED( ARGS );
      142     4358
      143     4359    1   DCL RESULT         CHAR(32);
      144     4360        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:6    
      145     4361
      146     4362        /*V*
      147     4363                                   MULTIPLE_ENTRIES
      148     4364             There are three entry points: X8DS$DISPLAY_SYSOUT
      149     4365                                           X8DS$DISPLAY_SYSOUT_NO_ADV
      150     4366                                           X8DS$DISPLAY_CONSOLE
      151     4367             cases of DISPLAY(SYSOUT, SYSOUT WITH NO ADVANCING, CONSOLE).   When an
      152     4368             entry point is entered the line length is set accordingly, and the bit
      153     4369             for the different styles(cases) are set also.
      154     4370
      155     4371        */
      156     4372    1       DISPLAY_CODE = %DISPLAY_SYSOUT;
      157     4373    1       OVERFLOW_CODE = %DISPLAY_SYSOUT;
      158     4374    1       LINE_LENGTH = 132;
      159     4375    1       GOTO PROCESS;
      160     4376        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:7    
      161     4377        /*------------------------*/
      162     4378    1   X8DS$DISPLAY_SYSOUT_NO_ADV:   ENTRY (ARGS, DESC);
      163     4379        /*------------------------*/
      164     4380
      165     4381    1       DISPLAY_CODE = %DISPLAY_NO_ADVANCING;
      166     4382    1       OVERFLOW_CODE = %DISPLAY_SYSOUT;
      167     4383    1       LINE_LENGTH = 132;
      168     4384    1       GOTO PROCESS;
      169     4385        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:8    
      170     4386        /*--------------------*/
      171     4387    1     X8DS$DISPLAY_CONSOLE:       ENTRY (ARGS, DESC);
      172     4388        /*--------------------*/
      173     4389
      174     4390    1       DISPLAY_CODE = %DISPLAY_CONSOLE;
      175     4391    1       OVERFLOW_CODE = %DISPLAY_CONSOLE;
      176     4392    1       LINE_LENGTH = 72;
      177     4393    1       J = 0;
      178     4394
      179     4395    2       DO I = 0 TO DESC.ARGS#-1;
      180     4396    2         IF DESC.D_WORD.DES_W.TYPE(I) = %ASCII_CHARACTER_STRING THEN
      181     4397    2           J = J + DESC.D_WORD.DES_W.ADSC.ARG_SIZE(I);
      182     4398    2         ELSE
      183     4399    2           J = J + DESC.D_WORD.DES_W.NDSC.N (I);
      184     4400    2       END;
      185     4401                                                                    /*#31940*/
      186     4402        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:9    
      187     4403        /*-----*/
      188     4404    1   PROCESS:
      189     4405        /*-----*/
      190     4406
      191     4407        /*V*
      192     4408                                   INITIALIZE
      193     4409             Initialize output buffer to spaces and the length to zero
      194     4410
      195     4411        */
      196     4412
      197     4413    1      RESULT_ARG$ = ADDR (RESULT_STR);
      198     4414
      199     4415    1      IF LIBCOM.PREVIOUS_NO_ADVANCE THEN
      200     4416    1         DISPLAY_COUNT = NO_ADVANCE_OFFSET;
      201     4417    1      ELSE
      202     4418    2        DO;
      203     4419    2          NO_ADVANCE_OFFSET = 0;
      204     4420    2          DISPLAY_COUNT = 0;
      205     4421    2        END;
      206     4422
      207     4423    1      DISPLAY_STRING = ' ';
      208     4424    1      BUFFER_COUNT  = 0;
      209     4425
      210     4426    1   ARGCNT:                /* do until all the arguments are displayed */
      211     4427    2      DO L = 0 TO DESC.ARGS#-1;
      212     4428    2        I = DESC.D_WORD.DES_W.NDSC.N (L);
      213     4429    2        ITEMP = I;
      214     4430
      215     4431    3        DO CASE (DESC.D_WORD.DES_W.TYPE(L));
      216     4432        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:10   
      217     4433    3          CASE (%ASCII_CHARACTER_STRING);
      218     4434
      219     4435
      220     4436    3              I = DESC.D_WORD.DES_W.ADSC.ARG_SIZE(L);
      221     4437
      222     4438    3              CALL ADD_TO_DISPLAY_STRING (ARGS(L) -> DATA, I, %FACTOR_ASCII) ;
      223     4439
      224     4440        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:11   
      225     4441    3          CASE (%KANJI_CHARACTER_STRING) ;
      226     4442
      227     4443                   /*V* KANJI -- DISPLAY Kanji_Start, String, Kanji_End */
      228     4444
      229     4445    3              I = DESC.D_WORD.DES_W.ADSC.ARG_SIZE (L) / 2 ;
      230     4446
      231     4447    3              CALL ADD_TO_DISPLAY_STRING (%KANJI_START, 1, %FACTOR_KATAKANA) ;
      232     4448    3              CALL ADD_TO_DISPLAY_STRING (ARGS(L) -> DATA, I, %FACTOR_KANJI) ;
      233     4449    3              CALL ADD_TO_DISPLAY_STRING (%KANJI_END, 1, %FACTOR_KATAKANA) ;
      234     4450
      235     4451        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:12   
      236     4452    3          CASE (%UNPACK_FIXED_NO_SIGN, %UNPACK_FIXED_LEAD_SIGN,
      237     4453    3                %UNPACK_FIXED_TRAIL_SIGN, %UNPACK_FIXED_LEAD_OPUNCH_SIGN,
      238     4454    3                %UNPACK_FIXED_TRAIL_OPUNCH_SIGN, %UNPACK_FLOAT_LEAD_SIGN );
      239     4455
      240     4456                   /* RESULT_ARG IS A TEMP FOR MANIPULATING THE
      241     4457                      INPUT DATA, SO AS NOT TO CHANGE THE
      242     4458                      THE ORIGINAL DATA                    */
      243     4459    3            RESULT_ARG = ' ';
      244     4460    3            RESULT_ARG = ARGS(L)->DATA;
      245     4461    3            REC_FLD = RESULT_ARG;
      246     4462    3            CALL UNPACKED;
      247     4463        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:13   
      248     4464    3          CASE (%PACK_FIXED_LEAD_SIGN, %PACK_FLOAT_LEAD_SIGN,
      249     4465    3                %PACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN_EBCDIC,
      250     4466    3                %PACK_FIXED_NO_SIGN, %RUNTIME_BINARY_FLOAT_SINGLE,
      251     4467    3                %RUNTIME_BINARY_FLOAT_DOUBLE, %PACK_FIXED_LEAD_SIGN_EBCDIC );
      252     4468
      253     4469    4             DO CASE( DESC.D_WORD.DES_W.TYPE(L) );
      254     4470    4               CASE(%PACK_FIXED_LEAD_SIGN, %PACK_FIXED_LEAD_SIGN_EBCDIC);
      255     4471    4                 SIGN_TYPE = %LEADING_SIGN;
      256     4472    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L) - 1;
      257     4473
      258     4474    4               CASE(%PACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN_EBCDIC);
      259     4475    4                 SIGN_TYPE = %TRAILING_SIGN;
      260     4476    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L) - 1;
      261     4477
      262     4478    4               CASE(%PACK_FLOAT_LEAD_SIGN);
      263     4479    4                 SIGN_TYPE = %FLOATING_POINT_LEADING_SIGN;
      264     4480    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L) - 3;
      265     4481    4                 I = I - 1;   /* Adjust display length to unpacked length */
      266     4482
      267     4483    4               CASE( %RUNTIME_BINARY_FLOAT_DOUBLE );
      268     4484
      269     4485    4                 DESCRIPTOR = 0;
      270     4486    4                 DES_WORD.TN = 1;
      271     4487    4                 DES_WORD.N = 29;
      272     4488
      273     4489    4                 RESULT = ' ';
      274     4490    4                 CALL X9RD$CVQD( ARGS( L ) -> FLOAT_DOUBLE,
      275     4491    4                                 RESULT,
      276     4492    4                                 DESCRIPTOR );
      277     4493
      278     4494    4                 SIGN_TYPE = %FLOATING_POINT_LEADING_SIGN;
      279     4495    4                 LENGTH = 26;
      280     4496    4                 I = 28;
      281     4497
      282     4498    4               CASE( %RUNTIME_BINARY_FLOAT_SINGLE );
      283     4499
      284     4500    4                 DESCRIPTOR = 0;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:14   
      285     4501    4                 DES_WORD.TN = 1;
      286     4502    4                 DES_WORD.N = 29;
      287     4503
      288     4504    4                 RESULT = ' ';
      289     4505    4                 CALL X9RD$CVRD( ARGS( L ) -> FLOAT_SINGLE,
      290     4506    4                                 RESULT,
      291     4507    4                                 DESCRIPTOR );
      292     4508
      293     4509    4                 SIGN_TYPE = %FLOATING_POINT_LEADING_SIGN;
      294     4510    4                 LENGTH = 26;
      295     4511    4                 I = 28;
      296     4512
      297     4513    4               CASE(%PACK_FIXED_NO_SIGN);
      298     4514    4                 SIGN_TYPE = %NO_SIGN;
      299     4515    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L);
      300     4516
      301     4517    4             END;  /* case */
      302     4518        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:15   
      303     4519                  %PACK_NDSC( @DESC   = SEND_DESC,
      304     4520                              @SCALE  = "DESC.D_WORD.DES_W.NDSC.SF(L)",
      305     4521                              @LENGTH = LENGTH,
      306     4522                              @TN     = %NDSC4,
      307     4523                              @SIGN   = SIGN_TYPE );
      308     4572
      309     4573    3             REC_DESC = SEND_DESC;
      310     4574    3             REC_DESC.NDSC.TN = %NDSC9;
      311     4575
      312     4576    3             IF DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE  OR
      313     4577    3                DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_DOUBLE  THEN
      314     4578    4               DO;
      315     4579    4                 REC_DESC.NDSC.N = REC_DESC.NDSC.N - 1;
      316     4580    4                 CALL X9MV( SEND_DESC, REC_DESC, ADDR(REC_FLD), ADDR( RESULT ) );
      317     4581    4               END;
      318     4582    3             ELSE
      319     4583
      320     4584    3               CALL X9MV( SEND_DESC, REC_DESC, ADDR(REC_FLD), ARGS(L) );
      321     4585    3             RESULT_ARG = REC_FLD;
      322     4586    3             CALL UNPACKED;
      323     4587        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:16   
      324     4588    3          CASE (0,ELSE);
      325     4589
      326     4590    3            CALL X8ER$ERROR( %UNEXPECTED_CASE, 'X8DS', 4);
      327     4591    3            RETURN;
      328     4592
      329     4593    3        END;     /* case desc.d_word.type (l) */
      330     4594    2      END ARGCNT;   /* do l  0 to desc.args#-1 */
      331     4595
      332     4596
      333     4597        /*V*
      334     4598                                      FLUSH
      335     4599             At the end of processing if anything is in the buffer we flush it out
      336     4600             to the printer.
      337     4601
      338     4602        */
      339     4603    1      IF DISPLAY_COUNT ~= 0 THEN
      340     4604    2        DO;
      341     4605    2          IF DISPLAY_CODE = %DISPLAY_NO_ADVANCING THEN
      342     4606    2            NO_ADVANCE_OFFSET = DISPLAY_COUNT;
      343     4607    2          CALL X9LP$PRINT (DISPLAY_STRING, BUFFER_COUNT, DISPLAY_CODE);
      344     4608    2        END;
      345     4609        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:17   
      346     4610        /*-------*/
      347     4611    1     CUTLINE:             PROC (STRING, SIZE_ON_DEVICE, FACTOR);
      348     4612        /*-------*/
      349     4613
      350     4614        /*I*
      351     4615             NAME:  CUTLINE
      352     4616
      353     4617          PURPOSE:  To fill the output buffer with as much of the current
      354     4618                    argument as possible and print the output buffer.
      355     4619
      356     4620        */
      357     4621    2       DCL X_LENGTH     SBIN WORD; /* #CHARS NOT PROCESSED */
      358     4622    2       DCL PART         SBIN WORD; /* # OF CHARS PROCESSED */
      359     4623    2       DCL STRING       CHAR (SIZE_IN_BUFFER) ;
      360     4624    2       DCL FACTOR       SBIN WORD ; /* 1 or 2 (2 for kanji) */
      361     4625    2       DCL SIZE_ON_DEVICE  UBIN WORD ;
      362     4626    2       DCL SIZE_IN_BUFFER  UBIN WORD ;
      363     4627        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:18   
      364     4628    2       SIZE_IN_BUFFER = SIZE_ON_DEVICE * FACTOR ;
      365     4629    2       X_LENGTH = SIZE_ON_DEVICE ;
      366     4630        /*V*
      367     4631                                      FILL_CURRENT_BUFFER
      368     4632             Fill the current buffer with as much args as possible, then output.
      369     4633
      370     4634        */
      371     4635    2       IF DISPLAY_COUNT ~= 0 THEN
      372     4636    3         DO;
      373     4637    3           PART = (LINE_LENGTH - DISPLAY_COUNT) * FACTOR ;
      374     4638    3           X_LENGTH = X_LENGTH - PART/FACTOR ;
      375     4639    3           CALL CONCAT (DISPLAY_STRING, SUBSTR (DISPLAY_STRING, 0, BUFFER_COUNT),
      376     4640    3                        SUBSTR (STRING, 0, PART));
      377     4641    3           BUFFER_COUNT = BUFFER_COUNT + PART ;
      378     4642    3           CALL X9LP$PRINT (DISPLAY_STRING, BUFFER_COUNT, OVERFLOW_CODE);
      379     4643    3           DISPLAY_STRING = ' ';
      380     4644    3           DISPLAY_COUNT = 0;
      381     4645    3           BUFFER_COUNT = 0 ;
      382     4646    3         END; /* IF DO */
      383     4647    2       ELSE
      384     4648    2         PART = 0 ;
      385     4649        /*V*
      386     4650                                      NEW_BUFFER
      387     4651             Fill and output the new buffer as many times as needed to exhaust the arg.
      388     4652
      389     4653        */
      390     4654
      391     4655    3       DO WHILE (X_LENGTH >= LINE_LENGTH);
      392     4656    3         CALL X9LP$PRINT (SUBSTR (STRING, PART, LINE_LENGTH * FACTOR),
      393     4657    3                          LINE_LENGTH * FACTOR, OVERFLOW_CODE);
      394     4658    3         PART = PART + LINE_LENGTH * FACTOR;
      395     4659    3         X_LENGTH = X_LENGTH - LINE_LENGTH;
      396     4660    3       END; /* while x_length >= line_length */
      397     4661        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:19   
      398     4662        /*V*
      399     4663                                      SET_LENGTHS
      400     4664             Set length of buffer according to the variable x_lnth which contains
      401     4665             the length of the unprinted arg.
      402     4666
      403     4667        */
      404     4668
      405     4669    2       IF X_LENGTH > 0 THEN
      406     4670    3         DO;
      407     4671    3           DISPLAY_COUNT = X_LENGTH;
      408     4672    3           DISPLAY_STRING = SUBSTR (STRING, PART) ;
      409     4673    3           BUFFER_COUNT = X_LENGTH * FACTOR ;
      410     4674    3         END;
      411     4675    2       ELSE
      412     4676    3         DO;
      413     4677    3           DISPLAY_STRING = ' ';
      414     4678    3           DISPLAY_COUNT = 0;
      415     4679    3           BUFFER_COUNT = 0 ;
      416     4680    3         END;  /* else if x_length <= 0 */
      417     4681    2     END CUTLINE;  /* proc */
      418     4682        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:20   
      419     4683        /*--------*/
      420     4684    1     UNPACKED:            PROC;
      421     4685        /*--------*/
      422     4686
      423     4687        /*I*
      424     4688             NAME:  UNPACKED
      425     4689
      426     4690             PURPOSE:
      427     4691        */
      428     4692
      429     4693    2       IF  DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE
      430     4694    2       OR  DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_DOUBLE  THEN
      431     4695    2         CALL DISPLAY_FLOATING_POINT ;
      432     4696
      433     4697    2       IF NOT LIBCOM.COBOL_74 THEN
      434     4698    3         DO;
      435     4699    3           IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_TRAIL_OPUNCH_SIGN
      436     4700    3           OR DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_LEAD_OPUNCH_SIGN THEN
      437     4701    3             CALL DISPLAY_OVERPUNCH;
      438     4702
      439     4703    3           IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_TRAIL_SIGN
      440     4704    3           OR DESC.D_WORD.DES_W.TYPE(L) = %PACK_FIXED_TRAIL_SIGN_EBCDIC
      441     4705    3           OR DESC.D_WORD.DES_W.TYPE(L) = %PACK_FIXED_TRAIL_SIGN THEN
      442     4706    3             CALL DISPLAY_TRAILING_SIGN;
      443     4707
      444     4708    3           IF DESC.D_WORD.DES_W.TYPE(L) ~= %RUNTIME_BINARY_FLOAT_SINGLE
      445     4709    3           AND DESC.D_WORD.DES_W.TYPE(L) ~= %RUNTIME_BINARY_FLOAT_DOUBLE THEN
      446     4710    4             DO;
      447     4711    4               IF DESC.D_WORD.DES_W.NDSC.SF(L)< (I * -1) THEN
      448     4712    4                 CALL ADJUST_FOR_LARGE_SF ;
      449     4713    4               ELSE
      450     4714    4                 IF (DESC.D_WORD.DES_W.NDSC.SF(L) < %ZERO) AND
      451     4715    4                 ((DESC.D_WORD.DES_W.NDSC.SF(L) * -1) <=  I ) THEN
      452     4716    4                   CALL ADJUST_FOR_MEDIUM_SF;
      453     4717    4                 ELSE
      454     4718    4                   IF DESC.D_WORD.DES_W.NDSC.SF(L)>%ZERO THEN
      455     4719    4                     CALL ADJUST_FOR_SMALL_SF;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:21   
      456     4720    4              END;
      457     4721    3       END; /*  END COBOL 85 SEMANTICS LOOP */
      458     4722
      459     4723        /*V*
      460     4724                                     LINE_TOO_LONG
      461     4725             If the length of the print buffer + the length of the current input data >
      462     4726             the length of a ''print line'' then apply appropriate semantics, COBOL 74
      463     4727             or 85
      464     4728
      465     4729        */
      466     4730        /*V*
      467     4731                                     COBOL_74_OR_85
      468     4732             COBOL_74 semantics call for the current data to be chopped off after being
      469     4733             placed in the buffer and then continued on the next line
      470     4734
      471     4735        */
      472     4736    2       IF I + DISPLAY_COUNT > LINE_LENGTH  THEN
      473     4737    2         CALL CUTLINE (RESULT_ARG, I, %FACTOR_ASCII) ;
      474     4738    2       ELSE
      475     4739    3         DO;
      476     4740
      477     4741        /*V*
      478     4742                                      LINE_OK
      479     4743             Add the current arg to the end of the print buffer and increment to
      480     4744             the new length
      481     4745
      482     4746        */
      483     4747    3           IF DISPLAY_COUNT ~= 0 THEN
      484     4748    4             DO;
      485     4749    4               CALL CONCAT (DISPLAY_STRING, SUBSTR (DISPLAY_STRING, 0,
      486     4750    4                            BUFFER_COUNT), RESULT_ARG);    /*#28021*/
      487     4751    4               DISPLAY_COUNT = DISPLAY_COUNT + I;
      488     4752    4               BUFFER_COUNT = BUFFER_COUNT + I;
      489     4753    4             END;
      490     4754
      491     4755        /*V*
      492     4756                                      FIRST_TIME
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:22   
      493     4757             First time through... length of buffer is length of string, contents
      494     4758             of buffer is the string.
      495     4759
      496     4760        */
      497     4761    3           ELSE
      498     4762    4             DO;
      499     4763    4               DISPLAY_COUNT = I;
      500     4764    4               BUFFER_COUNT = DISPLAY_COUNT;
      501     4765    4               DISPLAY_STRING = RESULT_ARG;
      502     4766    4             END;
      503     4767    3         END; /* else do */
      504     4768    2   END UNPACKED;  /* proc */
      505     4769        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:23   
      506     4770        /*----------------------*/
      507     4771    1     DISPLAY_FLOATING_POINT:     PROC;
      508     4772        /*----------------------*/
      509     4773
      510     4774        /*I*
      511     4775             NAME:  DISPLAY_FLOATING_POINT
      512     4776
      513     4777             PURPOSE:  To convert a floating point number to its display
      514     4778                       format and store into the temporary argument buffer.
      515     4779        */
      516     4780
      517     4781    2   DCL LAST      UBIN WORD;
      518     4782    2   DCL COUNT     UBIN WORD;
      519     4783    2   DCL TEMP_NUM  UBIN WORD;
      520     4784    2   DCL TEMP_CHAR CHAR(10);
      521     4785    2   DCL SAVE_CHAR CHAR(10);
      522     4786    2   DCL START     UBIN WORD;
      523     4787    2   DCL SHIFTS    UBIN WORD;
      524     4788
      525     4789
      526     4790    2       EXPON.EXPONEN = SUBSTR(REC_FLD, 27, 1);
      527     4791    2       LARGE_EXPON.EXPONENT.EXP = EXPON.EXPONENT.EXP;
      528     4792
      529     4793    2       IF DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE   THEN
      530     4794    3         DO;
      531     4795    3           I = 15;
      532     4796    3           LAST = 8;
      533     4797    3           LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 18;
      534     4798    3         END;
      535     4799    2       ELSE
      536     4800    3         DO;
      537     4801    3           I = 25;
      538     4802    3           LAST = 18;
      539     4803    3           LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 8;
      540     4804    3         END;
      541     4805
      542     4806    2       SHIFTS = 0;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:24   
      543     4807
      544     4808    3       DO WHILE( (SUBSTR( REC_FLD, SHIFTS + 1, 1 ) = '0' )  AND
      545     4809    3              ( SHIFTS <= 25 ) );
      546     4810
      547     4811    3         SHIFTS = SHIFTS + 1;
      548     4812    3       END;
      549     4813
      550     4814    3       IF SHIFTS > 0 THEN DO;
      551     4815
      552     4816    3         TEMP_ARG = SUBSTR( REC_FLD, SHIFTS + 1, 25 );
      553     4817    3         CALL INSERT( TEMP_ARG, 26 - SHIFTS, 25, ZEROES );
      554     4818    3         CALL INSERT( REC_FLD, 1, 26, TEMP_ARG );
      555     4819
      556     4820    3         LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP - SHIFTS;
      557     4821
      558     4822    3       END;
      559     4823
      560     4824    2       IF SUBSTR( REC_FLD, LAST + 1, 1 ) >= '5'    THEN
      561     4825    3         DO;
      562     4826
      563     4827    3           IF DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE  THEN
      564     4828    4             DO;
      565     4829
      566     4830    4               CALL CHARBIN( TEMP_NUM, SUBSTR( REC_FLD, 1, LAST ));
      567     4831    4               TEMP_NUM = TEMP_NUM + 1;
      568     4832    4               CALL BINCHAR( TEMP_CHAR, TEMP_NUM );
      569     4833
      570     4834    4               IF SUBSTR( TEMP_CHAR, 1, 1 ) = '1'       THEN
      571     4835    5                 DO;
      572     4836    5                   LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 1;
      573     4837    5                   START = 1;
      574     4838    5                 END;
      575     4839    4               ELSE
      576     4840    4                 START = 2;
      577     4841
      578     4842    4               SUBSTR( REC_FLD, 1, LAST ) = SUBSTR( TEMP_CHAR, START, LAST );
      579     4843
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:25   
      580     4844    4             END;
      581     4845    3           ELSE
      582     4846    4             DO;
      583     4847
      584     4848    4               CALL CHARBIN( TEMP_NUM, SUBSTR( REC_FLD, 10, 9 ) );
      585     4849    4               TEMP_NUM = TEMP_NUM + 1;
      586     4850    4               CALL BINCHAR( SAVE_CHAR, TEMP_NUM );
      587     4851
      588     4852    4               IF SUBSTR( REC_FLD, 10, 1 ) = '9'     AND
      589     4853    4                  SUBSTR( SAVE_CHAR, 0, 1 ) = '1'        THEN
      590     4854    5                 DO;
      591     4855
      592     4856    5                   CALL CHARBIN( TEMP_NUM, SUBSTR( REC_FLD, 1, 9 ) );
      593     4857    5                   TEMP_NUM = TEMP_NUM + 1;
      594     4858    5                   CALL BINCHAR( TEMP_CHAR, TEMP_NUM );
      595     4859
      596     4860    5                   IF SUBSTR( REC_FLD, 1, 1 ) = '9'    AND
      597     4861    5                      SUBSTR( TEMP_CHAR, 0, 1 ) = '1'      THEN
      598     4862    6                     DO;
      599     4863    6                       SUBSTR( REC_FLD, 1, 10 ) = TEMP_CHAR;
      600     4864    6                       SUBSTR( REC_FLD, 11, 8 ) = SUBSTR( SAVE_CHAR, 1, 8 );
      601     4865    6                       LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 1;
      602     4866    6                     END;
      603     4867    5                   ELSE
      604     4868    6                     DO;
      605     4869    6                       SUBSTR( REC_FLD, 1, 9 ) = SUBSTR( TEMP_CHAR, 1, 9 );
      606     4870    6                       SUBSTR( REC_FLD, 10, 9 ) = SUBSTR( SAVE_CHAR, 1, 9 );
      607     4871    6                     END;
      608     4872
      609     4873    5                 END;
      610     4874    4               ELSE
      611     4875    4                 SUBSTR( REC_FLD, 10, 9 ) = SUBSTR( SAVE_CHAR, 1, 9 );
      612     4876
      613     4877    4             END;
      614     4878
      615     4879    3         END;
      616     4880
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:26   
      617     4881    2       COUNT = LAST;
      618     4882
      619     4883    3       DO WHILE( (SUBSTR( REC_FLD, COUNT, 1 ) = '0' )  AND
      620     4884    3              ( LARGE_EXPON.EXPONENT.EXP ~= 0 ) );
      621     4885
      622     4886    3         COUNT = COUNT - 1;
      623     4887    3         LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 1;
      624     4888
      625     4889    3       END;
      626     4890
      627     4891    2       SHIFTS = LAST - COUNT;
      628     4892
      629     4893    3       IF SHIFTS > 0 THEN DO;
      630     4894
      631     4895    3         TEMP_ARG = ZEROES;
      632     4896    3         CALL INSERT( TEMP_ARG, SHIFTS, 25, SUBSTR( REC_FLD, 1 ) );
      633     4897    3         CALL INSERT( REC_FLD, 1, 26, TEMP_ARG );
      634     4898
      635     4899    3       END;
      636     4900
      637     4901    2       CALL BINXCHAR(CHR_EXP,LARGE_EXPON.EXPONENT.EXP);
      638     4902    2       CALL CONCAT(RESULT_ARG,SUBSTR(REC_FLD,0,I-6),
      639     4903    2                   ' E',CHR_EXP);
      640     4904    2   END DISPLAY_FLOATING_POINT; /* proc */
      641     4905        %EJECT ;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:27   
      642     4906        /*-----------------*/
      643     4907    1     DISPLAY_OVERPUNCH:          PROC;
      644     4908        /*-----------------*/
      645     4909
      646     4910        /*I*
      647     4911             NAME:  DISPLAY_OVERPUNCH
      648     4912
      649     4913             PURPOSE: To convert an overpunch number into its display format
      650     4914                      and store it into the temporary argument buffer.
      651     4915        */
      652     4916
      653     4917
      654     4918
      655     4919    2        IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_LEAD_OPUNCH_SIGN THEN
      656     4920    2          OVRCHR = SUBSTR (RESULT_ARG, 0, 1);  /* leading sign overpunch */
      657     4921    2        ELSE
      658     4922    2          OVRCHR = SUBSTR (RESULT_ARG, I-1, 1); /* trailing sign overpunch */
      659     4923
      660     4924             %REMOVE_OVP( @OVRCHR = OVRCHR );  /* returns sign in OVP_SIGN */
      661     4966
      662     4967    2        IF OVP_SIGN  ~=   ' ' THEN
      663     4968    3          DO;
      664     4969    3            I = I + 1;
      665     4970    3            ITEMP = ITEMP + 1;
      666     4971
      667     4972    3            IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_TRAIL_OPUNCH_SIGN THEN
      668     4973    3              CALL CONCAT (TEMP_ARG, OVP_SIGN, SUBSTR (RESULT_ARG, 0, I-2), OVPNUM);
      669     4974    3            ELSE
      670     4975    3              CALL CONCAT (TEMP_ARG, OVP_SIGN, OVPNUM, SUBSTR (RESULT_ARG, 1, I-2));
      671     4976    3            RESULT_ARG = TEMP_ARG;
      672     4977    3          END;
      673     4978
      674     4979    2     END DISPLAY_OVERPUNCH; /* proc */
      675     4980        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:28   
      676     4981        /*---------------------*/
      677     4982    1     DISPLAY_TRAILING_SIGN:      PROC;
      678     4983        /*---------------------*/
      679     4984
      680     4985        /*I*
      681     4986             NAME:  DISPLAY_TRAILING_SIGN
      682     4987
      683     4988             PURPOSE: To convert trailing sign numbers to their display
      684     4989                      format and store into temporary argument buffer.
      685     4990        */
      686     4991
      687     4992    2       OVP_SIGN = SUBSTR (RESULT_ARG, I-1, 1);
      688     4993
      689     4994    2       IF OVP_SIGN = '+'
      690     4995    2       OR OVP_SIGN = '-' THEN
      691     4996    3         DO;
      692     4997    3           CALL CONCAT (TEMP_ARG, OVP_SIGN, SUBSTR (RESULT_ARG, 0, I-1));
      693     4998    3           RESULT_ARG = TEMP_ARG;
      694     4999    3         END;
      695     5000
      696     5001    2     END DISPLAY_TRAILING_SIGN; /* proc */
      697     5002        %EJECT ;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:29   
      698     5003        /*-------------------*/
      699     5004    1     ADJUST_FOR_LARGE_SF:        PROC;
      700     5005        /*-------------------*/
      701     5006
      702     5007        /*I*
      703     5008             NAME:  ADJUST_FOR_LARGE_SF
      704     5009
      705     5010             PURPOSE:  To adjust the argument for a large scale factor --
      706     5011                       scale factor * -1 > length.  The scale factor - length
      707     5012                       is the number of zeros to the right of the radix point.
      708     5013        */
      709     5014
      710     5015    2       IF SUBSTR (RESULT_ARG,0,1) = '+'
      711     5016    2       OR SUBSTR (RESULT_ARG,0,1) = '-' THEN
      712     5017    2         SIGN = SUBSTR (RESULT_ARG,0,1);
      713     5018    2       ELSE
      714     5019    2         SIGN = ' ';
      715     5020
      716     5021    2       J = (DESC.D_WORD.DES_W.NDSC.SF(L) * -1) - DESC.D_WORD.DES_W.NDSC.N(L);
      717     5022    2       I = I + J + 1;
      718     5023
      719     5024    2         IF SIGN = ' ' THEN    /* add zeros to the front */
      720     5025    3           DO;
      721     5026    3             CALL CONCAT (TEMP_ARG, DEC_OR_COMMA, SUBSTR (ZEROES, 0, J),
      722     5027    3                 RESULT_ARG);
      723     5028    3             RESULT_ARG = TEMP_ARG;
      724     5029    3           END;
      725     5030    2         ELSE                  /* add zeros to the front avoiding sign */
      726     5031    3           DO;
      727     5032    3             CALL CONCAT (TEMP_ARG, DEC_OR_COMMA, SUBSTR (ZEROES, 0, J),
      728     5033    3                 SUBSTR (RESULT_ARG,1));
      729     5034    3             SUBSTR (RESULT_ARG, 1) = TEMP_ARG;
      730     5035    3           END;
      731     5036
      732     5037    2   END ADJUST_FOR_LARGE_SF; /* proc */
      733     5038        %EJECT ;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:30   
      734     5039        /*--------------------*/
      735     5040    1     ADJUST_FOR_MEDIUM_SF:       PROC;
      736     5041        /*--------------------*/
      737     5042
      738     5043        /*I*
      739     5044             NAME:  ADJUST_FOR_MEDIUM_SF
      740     5045
      741     5046             PURPOSE: To adjust for a medium scale factor.  The scale factor
      742     5047                      is medium when less than zero and > length.  This
      743     5048                      causes the radix point to be placed (scale factor * -1)
      744     5049                      positions to the right of the low order digit.
      745     5050        */
      746     5051
      747     5052    2       I = I + 1;
      748     5053    2       LT = ITEMP  + DESC.D_WORD.DES_W.NDSC.SF(L);
      749     5054    2       LTHOLD = SUBSTR( RESULT_ARG,0,LT );
      750     5055    2       RTHOLD = SUBSTR( RESULT_ARG,LT );
      751     5056    2       CALL INDEX (NDX,' ',RTHOLD);
      752     5057    2       CALL INDEX (NDX2,' ',LTHOLD);
      753     5058    2       CALL CONCAT (RESULT_ARG,SUBSTR(LTHOLD,0,NDX2),DEC_OR_COMMA,
      754     5059    2                          SUBSTR(RTHOLD,0,NDX ) );
      755     5060
      756     5061    2   END ADJUST_FOR_MEDIUM_SF; /* proc */
      757     5062        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:31   
      758     5063        /*-------------------*/
      759     5064    1     ADJUST_FOR_SMALL_SF:        PROC;
      760     5065        /*-------------------*/
      761     5066
      762     5067        /*I*
      763     5068             NAME:  ADJUST_FOR_SMALL_SF
      764     5069
      765     5070             PURPOSE:  To adjust for a small scale factor (positive). Zeros are
      766     5071                       added to the end of the argument.
      767     5072        */
      768     5073
      769     5074    2      CALL INSERT (RESULT_ARG, I, DESC.D_WORD.DES_W.NDSC.SF(L), ZEROES);
      770     5075
      771     5076    2       I = I+DESC.D_WORD.DES_W.NDSC.SF(L);
      772     5077
      773     5078    2   END ADJUST_FOR_SMALL_SF; /* proc */
      774     5079        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:32   
      775     5080        /*---------------------*/
      776     5081    1     ADD_TO_DISPLAY_STRING:      PROC (STRING, SIZE_ON_DEVICE, FACTOR);
      777     5082        /*---------------------*/
      778     5083
      779     5084        /*I*   NAME: ADD_TO_DISPLAY_STRING
      780     5085
      781     5086            PURPOSE: For Kanji or Alphanumeric strings, add a string
      782     5087                     to the Display buffer.
      783     5088
      784     5089              INPUT: STRING -- The string to add.
      785     5090                     SIZE_ON_DEVICE -- Size of string on the output device.
      786     5091                     FACTOR -- Ratio of bytes per column (2 for Kanji).
      787     5092                     LINE_LENGTH -- Length of line (132 or 72).
      788     5093
      789     5094                I/O: DISPLAY_COUNT -- # of columns used up on the device.
      790     5095                     BUFFER_COUNT --- # of bytes used up in the buffer.
      791     5096                     DISPLAY_STRING -- The record buffer.
      792     5097        */
      793     5098
      794     5099    2   DCL    STRING          CHAR (SIZE_IN_BUFFER) ;
      795     5100    2   DCL    SIZE_ON_DEVICE  UBIN WORD ;
      796     5101    2   DCL    FACTOR          SBIN WORD ; /* 1 (ascii) or 2 (kanji) */
      797     5102    2   DCL    SIZE_IN_BUFFER  UBIN WORD ; /* SIZE_ON_DEVICE * FACTOR */
      798     5103        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:33   
      799     5104    2          SIZE_IN_BUFFER = SIZE_ON_DEVICE * FACTOR ;
      800     5105
      801     5106    2          IF SIZE_ON_DEVICE > LINE_LENGTH THEN
      802     5107    3            DO;
      803     5108    3              IF SIZE_ON_DEVICE > %MAX_LENGTH THEN
      804     5109    4                DO;
      805     5110    4                  CALL X8ER$ERROR (%LENGTH_EXCEEDED);
      806     5111    4                  SIZE_ON_DEVICE = %MAX_LENGTH ;
      807     5112    4                END;
      808     5113
      809     5114    3              CALL CUTLINE (STRING, SIZE_ON_DEVICE, FACTOR) ;
      810     5115    3            END;
      811     5116    2          ELSE
      812     5117    3            DO;
      813     5118    3              IF SIZE_ON_DEVICE + DISPLAY_COUNT >= LINE_LENGTH THEN
      814     5119    3                  CALL CUTLINE (STRING, SIZE_ON_DEVICE, FACTOR) ;
      815     5120    3              ELSE     /* String won't fit on the rest of the line */
      816     5121    3                IF DISPLAY_COUNT = 0 THEN
      817     5122    4                  DO;
      818     5123    4                    DISPLAY_STRING = STRING ;
      819     5124    4                    DISPLAY_COUNT  = SIZE_ON_DEVICE ;
      820     5125    4                    BUFFER_COUNT   = SIZE_ON_DEVICE * FACTOR ;
      821     5126    4                  END;
      822     5127    3                ELSE
      823     5128    4                  DO;
      824     5129    4                    CALL CONCAT (DISPLAY_STRING,
      825     5130    4                                 SUBSTR (DISPLAY_STRING, 0, BUFFER_COUNT),
      826     5131    4                                 STRING) ;
      827     5132    4                    DISPLAY_COUNT = DISPLAY_COUNT + SIZE_ON_DEVICE ;
      828     5133    4                    BUFFER_COUNT  = BUFFER_COUNT  + SIZE_ON_DEVICE * FACTOR;
      829     5134    4                  END;
      830     5135    3            END;
      831     5136
      832     5137    2     END ADD_TO_DISPLAY_STRING;
      833     5138
      834     5139    1   END X8DS$DISPLAY_SYSOUT;  /* PROC */
      835     5140        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:34   

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:35   
--  Include file information  --

   B$OBJECT_C.:LIB_E04  is referenced.
   X9A_TYPES.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_MACROS.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X8DS$DISPLAY_SYSOUT.

   Procedure X8DS$DISPLAY_SYSOUT requires 1521 words for executable code.
   Procedure X8DS$DISPLAY_SYSOUT requires 288 words of local(AUTO) storage.

    No errors detected in file X8DS.:X8A6TSI    .

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:36   

 Object Unit name= X8DS$DISPLAY_SYSOUT                        File name= X8DS.:X8A6TOU
 UTS= AUG 09 '97 10:48:01.52 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none    20     24  LIBCOM
    1  LblCom even  none     1      1  DEC_OR_COMMA
    2  LblCom even  none    20     24  IN_TEMP
    3  LblCom even  none     1      1  OVRCHR
    4  LblCom even  none     1      1  SELECT_TIME
    5  LblCom even  none     1      1  NO_ADVANCE_OFFSET
    6  LblCom even  none    18     22  DSPLY_SAVE
    7  LblCom even  none     3      3  D_DATE
    8  LblCom even  none     3      3  D_TIME
    9  LblCom even  none     1      1  D_DAY
   10  LblCom even  none     2      2  C_DATE
   11  LblCom even  none     2      2  C_TIME
   12  LblCom even  none     2      2  C_DAY
   13  LblCom even  none     1      1  RTHOLD2
   14  LblCom even  none     1      1  LTHOLD2
   15  LblCom even  none     1      1  NDX2
   16  LblCom even  none     1      1  IN_LEN
   17  RoData even  UTS     10     12  X8DS$DISPLAY_SYSOUT
   18   Proc  even  none  1521   2761  X8DS$DISPLAY_SYSOUT
   19  RoData even  none    31     37  X8DS$DISPLAY_SYSOUT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    18      0   yes            yes      Std        2  X8DS$DISPLAY_SYSOUT
    18     10                  yes      Std        2  X8DS$DISPLAY_SYSOUT_NO_ADV
    18     21                  yes      Std        2  X8DS$DISPLAY_CONSOLE
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:37   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 X9RD$CVRD
         yes           Std       4 X9MV
         yes           Std       3 X9RD$CVQD
         yes           Std       3 X8ER$ERROR
         yes           Std       3 X9LP$PRINT
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:38   


        1        1        /*M* X8DS$DISPLAY_SYSOUT -- Display sysout or console               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P*
        9        9
       10       10              NAME: X8DS$DISPLAY_SYSOUT
       11       11           PURPOSE: To DISPLAY identifiers and literals upon a device
       12       12                    (Sysout or Console)
       13       13
       14       14
       15       15        */
       16       16        /*D*
       17       17
       18       18              NAME: X8DS$DISPLAY_SYSOUT
       19       19              CALL: Example: DISPLAY A1,A2,A3
       20       20                       ...
       21       21                     EPPR1    .DATA.+0   (#ARGS = 2)
       22       22                     EPPR0    .DATA.+1   (ARG-LIST)
       23       23                     TSX0     X9OS+9     (OPERATOR SEGMENT)
       24       24                       ...
       25       25              .DATA. ZERO     2,0        (#ARGS = 2)
       26       26                     PTR      ACTUAL-ARGLIST
       27       27                     PTR      ACTUAL-DESCLIST
       28       28                       ...
       29       29              ALIST  PTR      A1
       30       30                     PTR      A2
       31       31                     PTR      A3
       32       32              DLIST  ZERO     3,3        (#ACTUAL ARGS , DESC)
       33       33                     VFD      6/TYPE1,6/0,24/LENGTH1
       34       34                     VFD      6/TYPE2,6/0,12/S.F.1,12/LENGTH2
       35       35                     VFD      6/TYPE3,6/0,EITHER OF THE ABOVE
       36       36
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:39   
       37       37                    For unpacked decimal types(41 -> 45) the length is
       38       38                    12 bits for scale factor and 12 bits for length.
       39       39                    In the case of alpha numeric data the length is 24 bits.
       40       40
       41       41         INTERFACE:
       42       42                    1.) CUTLINE - Internal procedure which cuts an ident or literal
       43       43                        if it exceeds the maximum hardware device output buffer
       44       44                        length
       45       45                     2.) X9LP$PRINT- Calls the appropriate output routine according
       46       46                        to which O/S option bit is set.
       47       47             INPUT:
       48       48                    1.) Array of pointers pointing to the args.
       49       49                    2.) # of args and # of desc followed by an array of desc cor-
       50       50                        responding to the args
       51       51            OUTPUT: Args displayed upon device .
       52       52           SCRATCH: None
       53       53         REFERENCE: X8LC$DOCUMENT, NAME DISPLAY_DESCRIPTION, TYPE F
       54       54
       55       55
       56       56        */
       57       57        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:40   
       58       58        /*-----------------*/
       59       59        X8DS$DISPLAY_SYSOUT:          PROC (ARGS, DESC);

     59 18 000000   000000 700200 xent  X8DS$DISPLA* TSX0  ! X66_AUTO_2
        18 000001   000440 000002                    ZERO    288,2

       60       60        /*-----------------*/
       61       61
       62       62            %INCLUDE X8A_LIBCOM;
       63      282            %INCLUDE X8A_MACROS;
       64      539            %INCLUDE X9A_MACROS;
       65      570            %INCLUDE X8A_ERRCOM;
       66      659            %INCLUDE X9A_TYPES;
       67     4208
       68     4209        %EQU MAX_LENGTH = 8191 ; /* Maximum variable size */
       69     4210
       70     4211        /* Factors -- Size_In_Buffer / Size_On_Device */
       71     4212
       72     4213        %EQU FACTOR_KATAKANA = 1 ;
       73     4214        %EQU FACTOR_ASCII    = 1 ;
       74     4215        %EQU FACTOR_KANJI    = 2 ; /* 2 bytes per display column */
       75     4216
       76     4217    1   DCL X9LP$PRINT                ENTRY (3);
       77     4218    1   DCL X8ER$ERROR                ENTRY (3);
       78     4219    1   DCL X9MV                      ENTRY (4);     /* gmap MVN */
       79     4220    1   DCL X9RD$CVRD                 ENTRY (3);     /* REAL -> DEC */
       80     4221    1   DCL X9RD$CVQD                 ENTRY (3);     /* REAL DOUBLE -> DEC */
       81     4222
       82     4223    1   DCL ARGS(0:8191)            PTR ; /* Array of pointers to arguments */
       83     4224    1   DCL 1 DESC ALIGNED,               /* 2nd arg - descriptors and # of them */
       84     4225            %DCL_RT_DESC( @DIM = "(0:8191)" );
       85     4247
       86     4248    1   DCL DISPLAY_CODE      SBIN WORD;
       87     4249    1   DCL OVERFLOW_CODE     SBIN WORD;
       88     4250    1   DCL L                 SBIN WORD;  /* Subscript for arrays of args,desc*/
       89     4251    1   DCL J                 SBIN WORD;  /* Scratch variable for loops, etc.*/
       90     4252    1   DCL I                 SBIN WORD;  /* Contains the length of args     */
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:41   
       91     4253    1   DCL ITEMP             SBIN WORD;  /* Temp length of args             */
       92     4254    1   DCL DISPLAY_COUNT     SBIN WORD;  /* Length of current items to Display*/
       93     4255    1   DCL BUFFER_COUNT      SBIN WORD ; /* Amount used in record buffer   */
       94     4256    1   DCL LINE_LENGTH       UBIN WORD ;    /* Line Length = 72 or 132 */
       95     4257    1   DCL DISPLAY_STRING    CHAR(396);     /* String to hold Display items */
       96     4258    1   DCL DATA              CHAR(I) BASED; /* Variable for each argument */
       97     4259    1   DCL TEMP_ARG            CHAR(90);
       98     4260    1   DCL RESULT_STR          CHAR(90) ;/* Used in forming var len temp*/
       99     4261    1   DCL RESULT_ARG$                PTR  ;/* Same as RESULT_STR*/
      100     4262    1   DCL RESULT_ARG             CHAR(I) BASED(RESULT_ARG$);
              4262            /* The variable length temp  */
      101     4263    1   DCL CHR_EXP           CHAR(4); /* The expanded exponent              */
      102     4264    1   DCL FLOAT_NUM         CHAR(I) BASED; /* Variable used for Floating args*/
      103     4265
      104     4266    1   DCL 1    EXPON,       /* Structure for dissasembling exponents       */
      105     4267    1        2   EXPONEN      CHAR(1) UNAL, /* The actual exponent           */
      106     4268    1        2   EXPONENT   REDEF EXPONEN, /* Exponent at the bit level    */
      107     4269    1         3  *            BIT(1) UNAL, /* Always zero                    */
      108     4270    1         3  EXP          SBIN(8) UNAL;/* signed number for the exponent */
      109     4271
      110     4272    1   DCL 1    LARGE_EXPON,
      111     4273    1         2  EXPONEN      CHAR(1)  UNAL,
      112     4274    1         2  EXPONENT     REDEF EXPONEN,
      113     4275    1           3 EXP         SBIN(9)  UNAL;
      114     4276
      115     4277    1   DCL 1 SEND_DESC            ALIGNED,
      116     4278            %DESCRIPTOR(ENDING = YES);
      117     4306
      118     4307    1   DCL 1 REC_DESC             ALIGNED,
      119     4308            %DESCRIPTOR(ENDING = YES);
      120     4336
      121     4337    1   DCL SIGN_TYPE              BIT(2);
      122     4338    1   DCL OVP_SIGN               CHAR(1);
      123     4339    1   DCL SIGN                   CHAR(1);
      124     4340    1   DCL OVPNUM                 CHAR(1);
      125     4341    1   DCL LENGTH                 UBIN(12);
      126     4342    1   DCL SEND_FLD               CHAR(63);
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:42   
      127     4343    1   DCL REC_FLD                CHAR(63);
      128     4344
      129     4345    1   DCL ZEROES         CHAR(0) CONSTANT INIT
      130     4346    1                      ('0000000000000000000000000000000');
      131     4347
      132     4348    1   DCL DESCRIPTOR     UBIN WORD;
      133     4349    1   DCL 1 DES_WORD     REDEF    DESCRIPTOR,
      134     4350    1         2 *          UBIN HALF UNAL,
      135     4351    1         2 *          UBIN (3) UNAL,
      136     4352    1         2 TN         UBIN(1)  UNAL,
      137     4353    1         2 *          UBIN(8)  UNAL,
      138     4354    1         2 N          UBIN(6)  UNAL;
      139     4355
      140     4356    1   DCL FLOAT_SINGLE   UBIN WORD BASED( ARGS );
      141     4357    1   DCL FLOAT_DOUBLE   CHAR(3) BASED( ARGS );
      142     4358
      143     4359    1   DCL RESULT         CHAR(32);
      144     4360        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:43   
      145     4361
      146     4362        /*V*
      147     4363                                   MULTIPLE_ENTRIES
      148     4364             There are three entry points: X8DS$DISPLAY_SYSOUT
      149     4365                                           X8DS$DISPLAY_SYSOUT_NO_ADV
      150     4366                                           X8DS$DISPLAY_CONSOLE
      151     4367             cases of DISPLAY(SYSOUT, SYSOUT WITH NO ADVANCING, CONSOLE).   When an
      152     4368             entry point is entered the line length is set accordingly, and the bit
      153     4369             for the different styles(cases) are set also.
      154     4370
      155     4371        */
      156     4372    1       DISPLAY_CODE = %DISPLAY_SYSOUT;

   4372 18 000002   000001 235007                    LDA     1,DL
        18 000003   200076 755100                    STA     DISPLAY_CODE,,AUTO

      157     4373    1       OVERFLOW_CODE = %DISPLAY_SYSOUT;

   4373 18 000004   200077 755100                    STA     OVERFLOW_CODE,,AUTO

      158     4374    1       LINE_LENGTH = 132;

   4374 18 000005   000204 236007                    LDQ     132,DL
        18 000006   200106 756100                    STQ     LINE_LENGTH,,AUTO

      159     4375    1       GOTO PROCESS;

   4375 18 000007   000057 710000 18                 TRA     PROCESS

      160     4376        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:44   
      161     4377        /*------------------------*/
      162     4378    1   X8DS$DISPLAY_SYSOUT_NO_ADV:   ENTRY (ARGS, DESC);

   4378 18 000010   000000 700200 xent  X8DS$DISPLA* TSX0  ! X66_AUTO_2
        18 000011   000440 000002                    ZERO    288,2

      163     4379        /*------------------------*/
      164     4380
      165     4381    1       DISPLAY_CODE = %DISPLAY_NO_ADVANCING;

   4381 18 000012   000002 235007                    LDA     2,DL
        18 000013   200076 755100                    STA     DISPLAY_CODE,,AUTO

      166     4382    1       OVERFLOW_CODE = %DISPLAY_SYSOUT;

   4382 18 000014   000001 236007                    LDQ     1,DL
        18 000015   200077 756100                    STQ     OVERFLOW_CODE,,AUTO

      167     4383    1       LINE_LENGTH = 132;

   4383 18 000016   000204 235007                    LDA     132,DL
        18 000017   200106 755100                    STA     LINE_LENGTH,,AUTO

      168     4384    1       GOTO PROCESS;

   4384 18 000020   000057 710000 18                 TRA     PROCESS

      169     4385        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:45   
      170     4386        /*--------------------*/
      171     4387    1     X8DS$DISPLAY_CONSOLE:       ENTRY (ARGS, DESC);

   4387 18 000021   000000 700200 xent  X8DS$DISPLA* TSX0  ! X66_AUTO_2
        18 000022   000440 000002                    ZERO    288,2

      172     4388        /*--------------------*/
      173     4389
      174     4390    1       DISPLAY_CODE = %DISPLAY_CONSOLE;

   4390 18 000023   000003 235007                    LDA     3,DL
        18 000024   200076 755100                    STA     DISPLAY_CODE,,AUTO

      175     4391    1       OVERFLOW_CODE = %DISPLAY_CONSOLE;

   4391 18 000025   200077 755100                    STA     OVERFLOW_CODE,,AUTO

      176     4392    1       LINE_LENGTH = 72;

   4392 18 000026   000110 236007                    LDQ     72,DL
        18 000027   200106 756100                    STQ     LINE_LENGTH,,AUTO

      177     4393    1       J = 0;

   4393 18 000030   200101 450100                    STZ     J,,AUTO

      178     4394
      179     4395    2       DO I = 0 TO DESC.ARGS#-1;

   4395 18 000031   200102 450100                    STZ     I,,AUTO
        18 000032   000052 710000 18                 TRA     s:4400+1

      180     4396    2         IF DESC.D_WORD.DES_W.TYPE(I) = %ASCII_CHARACTER_STRING THEN

   4396 18 000033   200004 470500                    LDP0    @DESC,,AUTO
        18 000034   200102 720100                    LXL0    I,,AUTO
        18 000035   000001 221110                    LDX1    1,X0,PR0
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:46   
        18 000036   000025 101003                    CMPX1   21,DU
        18 000037   000045 601000 18                 TNZ     s:4399

      181     4397    2           J = J + DESC.D_WORD.DES_W.ADSC.ARG_SIZE(I);

   4397 18 000040   000001 236110                    LDQ     1,X0,PR0
        18 000041   017777 376007                    ANQ     8191,DL
        18 000042   200101 036100                    ADLQ    J,,AUTO
        18 000043   200101 756100                    STQ     J,,AUTO
        18 000044   000051 710000 18                 TRA     s:4400

      182     4398    2         ELSE
      183     4399    2           J = J + DESC.D_WORD.DES_W.NDSC.N (I);

   4399 18 000045   000001 236110                    LDQ     1,X0,PR0
        18 000046   000077 376007                    ANQ     63,DL
        18 000047   200101 036100                    ADLQ    J,,AUTO
        18 000050   200101 756100                    STQ     J,,AUTO

      184     4400    2       END;

   4400 18 000051   200102 054100                    AOS     I,,AUTO
        18 000052   200004 470500                    LDP0    @DESC,,AUTO
        18 000053   000000 236100                    LDQ     0,,PR0
        18 000054   000022 772000                    QRL     18
        18 000055   200102 116100                    CMPQ    I,,AUTO
        18 000056   000033 605400 18                 TPNZ    s:4396

      185     4401                                                                    /*#31940*/
      186     4402        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:47   
      187     4403        /*-----*/
      188     4404    1   PROCESS:
      189     4405        /*-----*/
      190     4406
      191     4407        /*V*
      192     4408                                   INITIALIZE
      193     4409             Initialize output buffer to spaces and the length to zero
      194     4410
      195     4411        */
      196     4412
      197     4413    1      RESULT_ARG$ = ADDR (RESULT_STR);

   4413 18 000057   200301 630500       PROCESS      EPPR0   RESULT_STR,,AUTO
        18 000060   200330 450500                    STP0    RESULT_ARG$,,AUTO

      198     4414
      199     4415    1      IF LIBCOM.PREVIOUS_NO_ADVANCE THEN

   4415 18 000061   000013 234000 0                  SZN     LIBCOM+11
        18 000062   000066 605000 18                 TPL     s:4419

      200     4416    1         DISPLAY_COUNT = NO_ADVANCE_OFFSET;

   4416 18 000063   000000 235000 5                  LDA     NO_ADVANCE_OFFSET
        18 000064   200104 755100                    STA     DISPLAY_COUNT,,AUTO
        18 000065   000070 710000 18                 TRA     s:4423

      201     4417    1      ELSE
      202     4418    2        DO;

      203     4419    2          NO_ADVANCE_OFFSET = 0;

   4419 18 000066   000000 450000 5                  STZ     NO_ADVANCE_OFFSET

      204     4420    2          DISPLAY_COUNT = 0;

   4420 18 000067   200104 450100                    STZ     DISPLAY_COUNT,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:48   

      205     4421    2        END;

      206     4422
      207     4423    1      DISPLAY_STRING = ' ';

   4423 18 000070   040100 100400                    MLR     fill='040'O
        18 000071   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000072   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396

      208     4424    1      BUFFER_COUNT  = 0;

   4424 18 000073   200105 450100                    STZ     BUFFER_COUNT,,AUTO

      209     4425
      210     4426    1   ARGCNT:                /* do until all the arguments are displayed */
      211     4427    2      DO L = 0 TO DESC.ARGS#-1;

   4427 18 000074   200100 450100       ARGCNT       STZ     L,,AUTO
        18 000075   000636 710000 18                 TRA     s:4594+1

      212     4428    2        I = DESC.D_WORD.DES_W.NDSC.N (L);

   4428 18 000076   200004 470500                    LDP0    @DESC,,AUTO
        18 000077   200100 720100                    LXL0    L,,AUTO
        18 000100   000001 236110                    LDQ     1,X0,PR0
        18 000101   000077 376007                    ANQ     63,DL
        18 000102   200102 756100                    STQ     I,,AUTO

      213     4429    2        ITEMP = I;

   4429 18 000103   200103 756100                    STQ     ITEMP,,AUTO

      214     4430
      215     4431    3        DO CASE (DESC.D_WORD.DES_W.TYPE(L));

   4431 18 000104   000001 221110                    LDX1    1,X0,PR0
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:49   
        18 000105   000064 101003                    CMPX1   52,DU
        18 000106   000110 602011 18                 TNC     s:4431+4,X1
        18 000107   000630 710000 18                 TRA     s:4590
        18 000110   000630 710000 18                 TRA     s:4590
        18 000111   000630 710000 18                 TRA     s:4590
        18 000112   000630 710000 18                 TRA     s:4590
        18 000113   000266 710000 18                 TRA     s:4469
        18 000114   000266 710000 18                 TRA     s:4469
        18 000115   000630 710000 18                 TRA     s:4590
        18 000116   000630 710000 18                 TRA     s:4590
        18 000117   000630 710000 18                 TRA     s:4590
        18 000120   000630 710000 18                 TRA     s:4590
        18 000121   000266 710000 18                 TRA     s:4469
        18 000122   000266 710000 18                 TRA     s:4469
        18 000123   000630 710000 18                 TRA     s:4590
        18 000124   000630 710000 18                 TRA     s:4590
        18 000125   000630 710000 18                 TRA     s:4590
        18 000126   000630 710000 18                 TRA     s:4590
        18 000127   000630 710000 18                 TRA     s:4590
        18 000130   000630 710000 18                 TRA     s:4590
        18 000131   000630 710000 18                 TRA     s:4590
        18 000132   000630 710000 18                 TRA     s:4590
        18 000133   000630 710000 18                 TRA     s:4590
        18 000134   000630 710000 18                 TRA     s:4590
        18 000135   000174 710000 18                 TRA     s:4436
        18 000136   000211 710000 18                 TRA     s:4445
        18 000137   000630 710000 18                 TRA     s:4590
        18 000140   000630 710000 18                 TRA     s:4590
        18 000141   000266 710000 18                 TRA     s:4469
        18 000142   000630 710000 18                 TRA     s:4590
        18 000143   000630 710000 18                 TRA     s:4590
        18 000144   000630 710000 18                 TRA     s:4590
        18 000145   000630 710000 18                 TRA     s:4590
        18 000146   000630 710000 18                 TRA     s:4590
        18 000147   000266 710000 18                 TRA     s:4469
        18 000150   000630 710000 18                 TRA     s:4590
        18 000151   000630 710000 18                 TRA     s:4590
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:50   
        18 000152   000630 710000 18                 TRA     s:4590
        18 000153   000630 710000 18                 TRA     s:4590
        18 000154   000630 710000 18                 TRA     s:4590
        18 000155   000630 710000 18                 TRA     s:4590
        18 000156   000630 710000 18                 TRA     s:4590
        18 000157   000630 710000 18                 TRA     s:4590
        18 000160   000266 710000 18                 TRA     s:4469
        18 000161   000244 710000 18                 TRA     s:4459
        18 000162   000244 710000 18                 TRA     s:4459
        18 000163   000244 710000 18                 TRA     s:4459
        18 000164   000244 710000 18                 TRA     s:4459
        18 000165   000244 710000 18                 TRA     s:4459
        18 000166   000630 710000 18                 TRA     s:4590
        18 000167   000630 710000 18                 TRA     s:4590
        18 000170   000630 710000 18                 TRA     s:4590
        18 000171   000630 710000 18                 TRA     s:4590
        18 000172   000244 710000 18                 TRA     s:4459
        18 000173   000266 710000 18                 TRA     s:4469

      216     4432        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:51   
      217     4433    3          CASE (%ASCII_CHARACTER_STRING);

      218     4434
      219     4435
      220     4436    3              I = DESC.D_WORD.DES_W.ADSC.ARG_SIZE(L);

   4436 18 000174   000001 236110                    LDQ     1,X0,PR0
        18 000175   017777 376007                    ANQ     8191,DL
        18 000176   200102 756100                    STQ     I,,AUTO

      221     4437
      222     4438    3              CALL ADD_TO_DISPLAY_STRING (ARGS(L) -> DATA, I, %FACTOR_ASCII) ;

   4438 18 000177   200003 471500                    LDP1    @ARGS,,AUTO
        18 000200   100000 473510                    LDP3    0,X0,PR1
        18 000201   000002 236000 19                 LDQ     2
        18 000202   200417 756100                    STQ     @SIZE_ON_DEVICE+1,,AUTO
        18 000203   200102 634500                    EPPR4   I,,AUTO
        18 000204   200416 454500                    STP4    @STRING+1,,AUTO
        18 000205   200415 453500                    STP3    RESULT+9,,AUTO
        18 000206   002646 701000 18                 TSX1    ADD_TO_DISPLAY_STRING
        18 000207   000000 011000                    NOP     0
        18 000210   000635 710000 18                 TRA     s:4594

      223     4439
      224     4440        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:52   
      225     4441    3          CASE (%KANJI_CHARACTER_STRING) ;

      226     4442
      227     4443                   /*V* KANJI -- DISPLAY Kanji_Start, String, Kanji_End */
      228     4444
      229     4445    3              I = DESC.D_WORD.DES_W.ADSC.ARG_SIZE (L) / 2 ;

   4445 18 000211   000001 236110                    LDQ     1,X0,PR0
        18 000212   017777 376007                    ANQ     8191,DL
        18 000213   000001 772000                    QRL     1
        18 000214   200102 756100                    STQ     I,,AUTO

      230     4446
      231     4447    3              CALL ADD_TO_DISPLAY_STRING (%KANJI_START, 1, %FACTOR_KATAKANA) ;

   4447 18 000215   000004 237000 19                 LDAQ    4
        18 000216   200416 757100                    STAQ    @STRING+1,,AUTO
        18 000217   000006 236000 19                 LDQ     6
        18 000220   200415 756100                    STQ     RESULT+9,,AUTO
        18 000221   002646 701000 18                 TSX1    ADD_TO_DISPLAY_STRING
        18 000222   000000 011000                    NOP     0

      232     4448    3              CALL ADD_TO_DISPLAY_STRING (ARGS(L) -> DATA, I, %FACTOR_KANJI) ;

   4448 18 000223   200003 470500                    LDP0    @ARGS,,AUTO
        18 000224   200100 720100                    LXL0    L,,AUTO
        18 000225   000000 471510                    LDP1    0,X0,PR0
        18 000226   000010 236000 19                 LDQ     8
        18 000227   200417 756100                    STQ     @SIZE_ON_DEVICE+1,,AUTO
        18 000230   200102 633500                    EPPR3   I,,AUTO
        18 000231   200416 453500                    STP3    @STRING+1,,AUTO
        18 000232   200415 451500                    STP1    RESULT+9,,AUTO
        18 000233   002646 701000 18                 TSX1    ADD_TO_DISPLAY_STRING
        18 000234   000000 011000                    NOP     0

      233     4449    3              CALL ADD_TO_DISPLAY_STRING (%KANJI_END, 1, %FACTOR_KATAKANA) ;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:53   
   4449 18 000235   000004 237000 19                 LDAQ    4
        18 000236   200416 757100                    STAQ    @STRING+1,,AUTO
        18 000237   000012 236000 19                 LDQ     10
        18 000240   200415 756100                    STQ     RESULT+9,,AUTO
        18 000241   002646 701000 18                 TSX1    ADD_TO_DISPLAY_STRING
        18 000242   000000 011000                    NOP     0
        18 000243   000635 710000 18                 TRA     s:4594

      234     4450
      235     4451        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:54   
      236     4452    3          CASE (%UNPACK_FIXED_NO_SIGN, %UNPACK_FIXED_LEAD_SIGN,

      237     4453    3                %UNPACK_FIXED_TRAIL_SIGN, %UNPACK_FIXED_LEAD_OPUNCH_SIGN,
      238     4454    3                %UNPACK_FIXED_TRAIL_OPUNCH_SIGN, %UNPACK_FLOAT_LEAD_SIGN );
      239     4455
      240     4456                   /* RESULT_ARG IS A TEMP FOR MANIPULATING THE
      241     4457                      INPUT DATA, SO AS NOT TO CHANGE THE
      242     4458                      THE ORIGINAL DATA                    */
      243     4459    3            RESULT_ARG = ' ';

   4459 18 000244   200330 471500                    LDP1    RESULT_ARG$,,AUTO
        18 000245   000000 622006                    EAX2    0,QL
        18 000246   040140 100400                    MLR     fill='040'O
        18 000247   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000250   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2

      244     4460    3            RESULT_ARG = ARGS(L)->DATA;

   4460 18 000251   200003 473500                    LDP3    @ARGS,,AUTO
        18 000252   300000 474510                    LDP4    0,X0,PR3
        18 000253   200102 721100                    LXL1    I,,AUTO
        18 000254   040140 100540                    MLR     fill='040'O
        18 000255   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
        18 000256   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      245     4461    3            REC_FLD = RESULT_ARG;

   4461 18 000257   200102 721100                    LXL1    I,,AUTO
        18 000260   040100 100540                    MLR     fill='040'O
        18 000261   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        18 000262   200363 000077                    ADSC9   REC_FLD,,AUTO            cn=0,n=63

      246     4462    3            CALL UNPACKED;

   4462 18 000263   001043 701000 18                 TSX1    UNPACKED
        18 000264   000000 011000                    NOP     0
        18 000265   000635 710000 18                 TRA     s:4594
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:55   

      247     4463        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:56   
      248     4464    3          CASE (%PACK_FIXED_LEAD_SIGN, %PACK_FLOAT_LEAD_SIGN,

      249     4465    3                %PACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN_EBCDIC,
      250     4466    3                %PACK_FIXED_NO_SIGN, %RUNTIME_BINARY_FLOAT_SINGLE,
      251     4467    3                %RUNTIME_BINARY_FLOAT_DOUBLE, %PACK_FIXED_LEAD_SIGN_EBCDIC );
      252     4468
      253     4469    4             DO CASE( DESC.D_WORD.DES_W.TYPE(L) );

   4469 18 000266   000064 101003                    CMPX1   52,DU
        18 000267   000271 602011 18                 TNC     s:4469+3,X1
        18 000270   000476 710000 18                 TRA     s:4528
        18 000271   000476 710000 18                 TRA     s:4528
        18 000272   000476 710000 18                 TRA     s:4528
        18 000273   000476 710000 18                 TRA     s:4528
        18 000274   000437 710000 18                 TRA     s:4500
        18 000275   000406 710000 18                 TRA     s:4485
        18 000276   000476 710000 18                 TRA     s:4528
        18 000277   000476 710000 18                 TRA     s:4528
        18 000300   000476 710000 18                 TRA     s:4528
        18 000301   000476 710000 18                 TRA     s:4528
        18 000302   000355 710000 18                 TRA     s:4471
        18 000303   000375 710000 18                 TRA     s:4479
        18 000304   000476 710000 18                 TRA     s:4528
        18 000305   000476 710000 18                 TRA     s:4528
        18 000306   000476 710000 18                 TRA     s:4528
        18 000307   000476 710000 18                 TRA     s:4528
        18 000310   000476 710000 18                 TRA     s:4528
        18 000311   000476 710000 18                 TRA     s:4528
        18 000312   000476 710000 18                 TRA     s:4528
        18 000313   000476 710000 18                 TRA     s:4528
        18 000314   000476 710000 18                 TRA     s:4528
        18 000315   000476 710000 18                 TRA     s:4528
        18 000316   000476 710000 18                 TRA     s:4528
        18 000317   000476 710000 18                 TRA     s:4528
        18 000320   000476 710000 18                 TRA     s:4528
        18 000321   000476 710000 18                 TRA     s:4528
        18 000322   000365 710000 18                 TRA     s:4475
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:57   
        18 000323   000476 710000 18                 TRA     s:4528
        18 000324   000476 710000 18                 TRA     s:4528
        18 000325   000476 710000 18                 TRA     s:4528
        18 000326   000476 710000 18                 TRA     s:4528
        18 000327   000476 710000 18                 TRA     s:4528
        18 000330   000365 710000 18                 TRA     s:4475
        18 000331   000476 710000 18                 TRA     s:4528
        18 000332   000476 710000 18                 TRA     s:4528
        18 000333   000476 710000 18                 TRA     s:4528
        18 000334   000476 710000 18                 TRA     s:4528
        18 000335   000476 710000 18                 TRA     s:4528
        18 000336   000476 710000 18                 TRA     s:4528
        18 000337   000476 710000 18                 TRA     s:4528
        18 000340   000476 710000 18                 TRA     s:4528
        18 000341   000470 710000 18                 TRA     s:4514
        18 000342   000476 710000 18                 TRA     s:4528
        18 000343   000476 710000 18                 TRA     s:4528
        18 000344   000476 710000 18                 TRA     s:4528
        18 000345   000476 710000 18                 TRA     s:4528
        18 000346   000476 710000 18                 TRA     s:4528
        18 000347   000476 710000 18                 TRA     s:4528
        18 000350   000476 710000 18                 TRA     s:4528
        18 000351   000476 710000 18                 TRA     s:4528
        18 000352   000476 710000 18                 TRA     s:4528
        18 000353   000476 710000 18                 TRA     s:4528
        18 000354   000355 710000 18                 TRA     s:4471

      254     4470    4               CASE(%PACK_FIXED_LEAD_SIGN, %PACK_FIXED_LEAD_SIGN_EBCDIC);

      255     4471    4                 SIGN_TYPE = %LEADING_SIGN;

   4471 18 000355   200000 236003                    LDQ     65536,DU
        18 000356   200336 756100                    STQ     SIGN_TYPE,,AUTO

      256     4472    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L) - 1;

   4472 18 000357   000001 236110                    LDQ     1,X0,PR0
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:58   
        18 000360   000077 376007                    ANQ     63,DL
        18 000361   000001 136007                    SBLQ    1,DL
        18 000362   000030 736000                    QLS     24
        18 000363   200342 756100                    STQ     LENGTH,,AUTO
        18 000364   000476 710000 18                 TRA     s:4528

      257     4473
      258     4474    4               CASE(%PACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN_EBCDIC);

      259     4475    4                 SIGN_TYPE = %TRAILING_SIGN;

   4475 18 000365   400000 236003                    LDQ     -131072,DU
        18 000366   200336 756100                    STQ     SIGN_TYPE,,AUTO

      260     4476    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L) - 1;

   4476 18 000367   000001 236110                    LDQ     1,X0,PR0
        18 000370   000077 376007                    ANQ     63,DL
        18 000371   000001 136007                    SBLQ    1,DL
        18 000372   000030 736000                    QLS     24
        18 000373   200342 756100                    STQ     LENGTH,,AUTO
        18 000374   000476 710000 18                 TRA     s:4528

      261     4477
      262     4478    4               CASE(%PACK_FLOAT_LEAD_SIGN);

      263     4479    4                 SIGN_TYPE = %FLOATING_POINT_LEADING_SIGN;

   4479 18 000375   200336 450100                    STZ     SIGN_TYPE,,AUTO

      264     4480    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L) - 3;

   4480 18 000376   000001 236110                    LDQ     1,X0,PR0
        18 000377   000077 376007                    ANQ     63,DL
        18 000400   000003 136007                    SBLQ    3,DL
        18 000401   000030 736000                    QLS     24
        18 000402   200342 756100                    STQ     LENGTH,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:59   

      265     4481    4                 I = I - 1;   /* Adjust display length to unpacked length */

   4481 18 000403   000001 336007                    LCQ     1,DL
        18 000404   200102 056100                    ASQ     I,,AUTO
        18 000405   000476 710000 18                 TRA     s:4528

      266     4482
      267     4483    4               CASE( %RUNTIME_BINARY_FLOAT_DOUBLE );

      268     4484
      269     4485    4                 DESCRIPTOR = 0;

   4485 18 000406   200403 450100                    STZ     DESCRIPTOR,,AUTO

      270     4486    4                 DES_WORD.TN = 1;

   4486 18 000407   040000 236007                    LDQ     16384,DL
        18 000410   200403 256100                    ORSQ    DESCRIPTOR,,AUTO

      271     4487    4                 DES_WORD.N = 29;

   4487 18 000411   000035 236007                    LDQ     29,DL
        18 000412   200403 752101                    STCQ    DESCRIPTOR,'01'O,AUTO

      272     4488
      273     4489    4                 RESULT = ' ';

   4489 18 000413   040100 100400                    MLR     fill='040'O
        18 000414   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000415   200404 000040                    ADSC9   RESULT,,AUTO             cn=0,n=32

      274     4490    4                 CALL X9RD$CVQD( ARGS( L ) -> FLOAT_DOUBLE,

   4490 18 000416   200003 471500                    LDP1    @ARGS,,AUTO
        18 000417   100000 473510                    LDP3    0,X0,PR1
        18 000420   200403 634500                    EPPR4   DESCRIPTOR,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:60   
        18 000421   200434 454500                    STP4    SHIFTS+3,,AUTO
        18 000422   200404 635500                    EPPR5   RESULT,,AUTO
        18 000423   200433 455500                    STP5    SHIFTS+2,,AUTO
        18 000424   200432 453500                    STP3    SHIFTS+1,,AUTO
        18 000425   200432 630500                    EPPR0   SHIFTS+1,,AUTO
        18 000426   000013 631400 19                 EPPR1   11
        18 000427   000000 701000 xent               TSX1    X9RD$CVQD
        18 000430   000000 011000                    NOP     0

      275     4491    4                                 RESULT,
      276     4492    4                                 DESCRIPTOR );
      277     4493
      278     4494    4                 SIGN_TYPE = %FLOATING_POINT_LEADING_SIGN;

   4494 18 000431   200336 450100                    STZ     SIGN_TYPE,,AUTO

      279     4495    4                 LENGTH = 26;

   4495 18 000432   003200 236003                    LDQ     1664,DU
        18 000433   200342 756100                    STQ     LENGTH,,AUTO

      280     4496    4                 I = 28;

   4496 18 000434   000034 235007                    LDA     28,DL
        18 000435   200102 755100                    STA     I,,AUTO
        18 000436   000476 710000 18                 TRA     s:4528

      281     4497
      282     4498    4               CASE( %RUNTIME_BINARY_FLOAT_SINGLE );

      283     4499
      284     4500    4                 DESCRIPTOR = 0;

   4500 18 000437   200403 450100                    STZ     DESCRIPTOR,,AUTO

      285     4501    4                 DES_WORD.TN = 1;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:61   
   4501 18 000440   040000 236007                    LDQ     16384,DL
        18 000441   200403 256100                    ORSQ    DESCRIPTOR,,AUTO

      286     4502    4                 DES_WORD.N = 29;

   4502 18 000442   000035 236007                    LDQ     29,DL
        18 000443   200403 752101                    STCQ    DESCRIPTOR,'01'O,AUTO

      287     4503
      288     4504    4                 RESULT = ' ';

   4504 18 000444   040100 100400                    MLR     fill='040'O
        18 000445   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000446   200404 000040                    ADSC9   RESULT,,AUTO             cn=0,n=32

      289     4505    4                 CALL X9RD$CVRD( ARGS( L ) -> FLOAT_SINGLE,

   4505 18 000447   200003 471500                    LDP1    @ARGS,,AUTO
        18 000450   100000 473510                    LDP3    0,X0,PR1
        18 000451   200403 634500                    EPPR4   DESCRIPTOR,,AUTO
        18 000452   200434 454500                    STP4    SHIFTS+3,,AUTO
        18 000453   200404 635500                    EPPR5   RESULT,,AUTO
        18 000454   200433 455500                    STP5    SHIFTS+2,,AUTO
        18 000455   200432 453500                    STP3    SHIFTS+1,,AUTO
        18 000456   200432 630500                    EPPR0   SHIFTS+1,,AUTO
        18 000457   000013 631400 19                 EPPR1   11
        18 000460   000000 701000 xent               TSX1    X9RD$CVRD
        18 000461   000000 011000                    NOP     0

      290     4506    4                                 RESULT,
      291     4507    4                                 DESCRIPTOR );
      292     4508
      293     4509    4                 SIGN_TYPE = %FLOATING_POINT_LEADING_SIGN;

   4509 18 000462   200336 450100                    STZ     SIGN_TYPE,,AUTO

      294     4510    4                 LENGTH = 26;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:62   

   4510 18 000463   003200 236003                    LDQ     1664,DU
        18 000464   200342 756100                    STQ     LENGTH,,AUTO

      295     4511    4                 I = 28;

   4511 18 000465   000034 235007                    LDA     28,DL
        18 000466   200102 755100                    STA     I,,AUTO
        18 000467   000476 710000 18                 TRA     s:4528

      296     4512
      297     4513    4               CASE(%PACK_FIXED_NO_SIGN);

      298     4514    4                 SIGN_TYPE = %NO_SIGN;

   4514 18 000470   600000 236003                    LDQ     -65536,DU
        18 000471   200336 756100                    STQ     SIGN_TYPE,,AUTO

      299     4515    4                 LENGTH = DESC.D_WORD.DES_W.NDSC.N(L);

   4515 18 000472   000001 236110                    LDQ     1,X0,PR0
        18 000473   000077 376007                    ANQ     63,DL
        18 000474   000030 736000                    QLS     24
        18 000475   200342 756100                    STQ     LENGTH,,AUTO

      300     4516
      301     4517    4             END;  /* case */

      302     4518        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:63   
      303     4519                  %PACK_NDSC( @DESC   = SEND_DESC,
      304     4520                              @SCALE  = "DESC.D_WORD.DES_W.NDSC.SF(L)",
      305     4521                              @LENGTH = LENGTH,
      306     4522                              @TN     = %NDSC4,
      307     4523                              @SIGN   = SIGN_TYPE );

   4528 18 000476   000000 220003                    LDX0    0,DU
        18 000477   200334 740100                    STX0    SEND_DESC,,AUTO

   4529 18 000500   000014 236000 19                 LDQ     12
        18 000501   200334 356100                    ANSQ    SEND_DESC,,AUTO

   4530 18 000502   040000 236007                    LDQ     16384,DL
        18 000503   200334 256100                    ORSQ    SEND_DESC,,AUTO

   4531 18 000504   200336 236100                    LDQ     SIGN_TYPE,,AUTO
        18 000505   000026 772000                    QRL     22
        18 000506   200334 676100                    ERQ     SEND_DESC,,AUTO
        18 000507   030000 376007                    ANQ     12288,DL
        18 000510   200334 656100                    ERSQ    SEND_DESC,,AUTO

   4532 18 000511   200004 470500                    LDP0    @DESC,,AUTO
        18 000512   200100 721100                    LXL1    L,,AUTO
        18 000513   000001 236111                    LDQ     1,X1,PR0
        18 000514   200334 752102                    STCQ    SEND_DESC,'02'O,AUTO

   4533 18 000515   200336 236100                    LDQ     SIGN_TYPE,,AUTO
        18 000516   000042 772000                    QRL     34
        18 000517   000004 116007                    CMPQ    4,DL
        18 000520   000522 602006 18                 TNC     s:4533+5,QL
        18 000521   000543 710000 18                 TRA     s:4573
        18 000522   000537 710000 18                 TRA     s:4567
        18 000523   000532 710000 18                 TRA     s:4540
        18 000524   000532 710000 18                 TRA     s:4540
        18 000525   000526 710000 18                 TRA     s:4535

   4535 18 000526   200342 236100                    LDQ     LENGTH,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:64   
        18 000527   000030 772000                    QRL     24
        18 000530   200334 752101                    STCQ    SEND_DESC,'01'O,AUTO
        18 000531   000543 710000 18                 TRA     s:4573

   4540 18 000532   200342 236100                    LDQ     LENGTH,,AUTO
        18 000533   000030 772000                    QRL     24
        18 000534   000001 036007                    ADLQ    1,DL
        18 000535   200334 752101                    STCQ    SEND_DESC,'01'O,AUTO
        18 000536   000543 710000 18                 TRA     s:4573

   4567 18 000537   200342 236100                    LDQ     LENGTH,,AUTO
        18 000540   000030 772000                    QRL     24
        18 000541   000003 036007                    ADLQ    3,DL
        18 000542   200334 752101                    STCQ    SEND_DESC,'01'O,AUTO

      308     4572
      309     4573    3             REC_DESC = SEND_DESC;

   4573 18 000543   200334 236100                    LDQ     SEND_DESC,,AUTO
        18 000544   200335 756100                    STQ     REC_DESC,,AUTO

      310     4574    3             REC_DESC.NDSC.TN = %NDSC9;

   4574 18 000545   000015 236000 19                 LDQ     13
        18 000546   200335 356100                    ANSQ    REC_DESC,,AUTO

      311     4575
      312     4576    3             IF DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE  OR

   4576 18 000547   000001 222111                    LDX2    1,X1,PR0
        18 000550   000003 102003                    CMPX2   3,DU
        18 000551   000554 600000 18                 TZE     s:4579
        18 000552   000004 102003                    CMPX2   4,DU
        18 000553   000600 601000 18                 TNZ     s:4584

      313     4577    3                DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_DOUBLE  THEN
      314     4578    4               DO;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:65   

      315     4579    4                 REC_DESC.NDSC.N = REC_DESC.NDSC.N - 1;

   4579 18 000554   200335 236100                    LDQ     REC_DESC,,AUTO
        18 000555   000077 036007                    ADLQ    63,DL
        18 000556   200335 752101                    STCQ    REC_DESC,'01'O,AUTO

      316     4580    4                 CALL X9MV( SEND_DESC, REC_DESC, ADDR(REC_FLD), ADDR( RESULT ) );

   4580 18 000557   200363 631500                    EPPR1   REC_FLD,,AUTO
        18 000560   200432 451500                    STP1    SHIFTS+1,,AUTO
        18 000561   200404 633500                    EPPR3   RESULT,,AUTO
        18 000562   200433 453500                    STP3    SHIFTS+2,,AUTO
        18 000563   200433 634500                    EPPR4   SHIFTS+2,,AUTO
        18 000564   200437 454500                    STP4    SHIFTS+6,,AUTO
        18 000565   200432 635500                    EPPR5   SHIFTS+1,,AUTO
        18 000566   200436 455500                    STP5    SHIFTS+5,,AUTO
        18 000567   200335 636500                    EPPR6   REC_DESC,,AUTO
        18 000570   200435 456500                    STP6    SHIFTS+4,,AUTO
        18 000571   200334 637500                    EPPR7   SEND_DESC,,AUTO
        18 000572   200434 457500                    STP7    SHIFTS+3,,AUTO
        18 000573   200434 630500                    EPPR0   SHIFTS+3,,AUTO
        18 000574   000016 631400 19                 EPPR1   14
        18 000575   000000 701000 xent               TSX1    X9MV
        18 000576   000000 011000                    NOP     0

      317     4581    4               END;

   4581 18 000577   000620 710000 18                 TRA     s:4585

      318     4582    3             ELSE
      319     4583
      320     4584    3               CALL X9MV( SEND_DESC, REC_DESC, ADDR(REC_FLD), ARGS(L) );

   4584 18 000600   200363 631500                    EPPR1   REC_FLD,,AUTO
        18 000601   200432 451500                    STP1    SHIFTS+1,,AUTO
        18 000602   200100 236100                    LDQ     L,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:66   
        18 000603   000022 736000                    QLS     18
        18 000604   200003 036100                    ADLQ    @ARGS,,AUTO
        18 000605   200437 756100                    STQ     SHIFTS+6,,AUTO
        18 000606   200432 633500                    EPPR3   SHIFTS+1,,AUTO
        18 000607   200436 453500                    STP3    SHIFTS+5,,AUTO
        18 000610   200335 634500                    EPPR4   REC_DESC,,AUTO
        18 000611   200435 454500                    STP4    SHIFTS+4,,AUTO
        18 000612   200334 635500                    EPPR5   SEND_DESC,,AUTO
        18 000613   200434 455500                    STP5    SHIFTS+3,,AUTO
        18 000614   200434 630500                    EPPR0   SHIFTS+3,,AUTO
        18 000615   000016 631400 19                 EPPR1   14
        18 000616   000000 701000 xent               TSX1    X9MV
        18 000617   000000 011000                    NOP     0

      321     4585    3             RESULT_ARG = REC_FLD;

   4585 18 000620   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 000621   200102 720100                    LXL0    I,,AUTO
        18 000622   040140 100500                    MLR     fill='040'O
        18 000623   200363 000077                    ADSC9   REC_FLD,,AUTO            cn=0,n=63
        18 000624   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      322     4586    3             CALL UNPACKED;

   4586 18 000625   001043 701000 18                 TSX1    UNPACKED
        18 000626   000000 011000                    NOP     0
        18 000627   000635 710000 18                 TRA     s:4594

      323     4587        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:67   
      324     4588    3          CASE (0,ELSE);

      325     4589
      326     4590    3            CALL X8ER$ERROR( %UNEXPECTED_CASE, 'X8DS', 4);

   4590 18 000630   000021 630400 19                 EPPR0   17
        18 000631   000013 631400 19                 EPPR1   11
        18 000632   000000 701000 xent               TSX1    X8ER$ERROR
        18 000633   000000 011000                    NOP     0

      327     4591    3            RETURN;

   4591 18 000634   000000 702200 xent               TSX2  ! X66_ARET

      328     4592
      329     4593    3        END;     /* case desc.d_word.type (l) */

      330     4594    2      END ARGCNT;   /* do l  0 to desc.args#-1 */

   4594 18 000635   200100 054100                    AOS     L,,AUTO
        18 000636   200004 470500                    LDP0    @DESC,,AUTO
        18 000637   000000 236100                    LDQ     0,,PR0
        18 000640   000022 772000                    QRL     18
        18 000641   200100 116100                    CMPQ    L,,AUTO
        18 000642   000076 605400 18                 TPNZ    s:4428

      331     4595
      332     4596
      333     4597        /*V*
      334     4598                                      FLUSH
      335     4599             At the end of processing if anything is in the buffer we flush it out
      336     4600             to the printer.
      337     4601
      338     4602        */
      339     4603    1      IF DISPLAY_COUNT ~= 0 THEN

   4603 18 000643   200104 235100                    LDA     DISPLAY_COUNT,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:68   
        18 000644   000664 600000 18                 TZE     s:4608

      340     4604    2        DO;

      341     4605    2          IF DISPLAY_CODE = %DISPLAY_NO_ADVANCING THEN

   4605 18 000645   200076 235100                    LDA     DISPLAY_CODE,,AUTO
        18 000646   000002 115007                    CMPA    2,DL
        18 000647   000652 601000 18                 TNZ     s:4607

      342     4606    2            NO_ADVANCE_OFFSET = DISPLAY_COUNT;

   4606 18 000650   200104 235100                    LDA     DISPLAY_COUNT,,AUTO
        18 000651   000000 755000 5                  STA     NO_ADVANCE_OFFSET

      343     4607    2          CALL X9LP$PRINT (DISPLAY_STRING, BUFFER_COUNT, DISPLAY_CODE);

   4607 18 000652   200076 631500                    EPPR1   DISPLAY_CODE,,AUTO
        18 000653   200434 451500                    STP1    SHIFTS+3,,AUTO
        18 000654   200105 633500                    EPPR3   BUFFER_COUNT,,AUTO
        18 000655   200433 453500                    STP3    SHIFTS+2,,AUTO
        18 000656   200107 634500                    EPPR4   DISPLAY_STRING,,AUTO
        18 000657   200432 454500                    STP4    SHIFTS+1,,AUTO
        18 000660   200432 630500                    EPPR0   SHIFTS+1,,AUTO
        18 000661   000013 631400 19                 EPPR1   11
        18 000662   000000 701000 xent               TSX1    X9LP$PRINT
        18 000663   000000 011000                    NOP     0

      344     4608    2        END;

   4608 18 000664   002760 710000 18                 TRA     s:5139

      345     4609        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:69   
      346     4610        /*-------*/
      347     4611    1     CUTLINE:             PROC (STRING, SIZE_ON_DEVICE, FACTOR);

   4611 18 000665   200422 741300       CUTLINE      STX1  ! TEMP_NUM+1,,AUTO

      348     4612        /*-------*/
      349     4613
      350     4614        /*I*
      351     4615             NAME:  CUTLINE
      352     4616
      353     4617          PURPOSE:  To fill the output buffer with as much of the current
      354     4618                    argument as possible and print the output buffer.
      355     4619
      356     4620        */
      357     4621    2       DCL X_LENGTH     SBIN WORD; /* #CHARS NOT PROCESSED */
      358     4622    2       DCL PART         SBIN WORD; /* # OF CHARS PROCESSED */
      359     4623    2       DCL STRING       CHAR (SIZE_IN_BUFFER) ;
      360     4624    2       DCL FACTOR       SBIN WORD ; /* 1 or 2 (2 for kanji) */
      361     4625    2       DCL SIZE_ON_DEVICE  UBIN WORD ;
      362     4626    2       DCL SIZE_IN_BUFFER  UBIN WORD ;
      363     4627        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:70   
      364     4628    2       SIZE_IN_BUFFER = SIZE_ON_DEVICE * FACTOR ;

   4628 18 000666   200424 470500                    LDP0    @SIZE_ON_DEVICE,,AUTO
        18 000667   200425 471500                    LDP1    @FACTOR,,AUTO
        18 000670   000000 236100                    LDQ     0,,PR0
        18 000671   100000 402100                    MPY     0,,PR1
        18 000672   200430 756100                    STQ     SIZE_IN_BUFFER,,AUTO

      365     4629    2       X_LENGTH = SIZE_ON_DEVICE ;

   4629 18 000673   000000 235100                    LDA     0,,PR0
        18 000674   200426 755100                    STA     X_LENGTH,,AUTO

      366     4630        /*V*
      367     4631                                      FILL_CURRENT_BUFFER
      368     4632             Fill the current buffer with as much args as possible, then output.
      369     4633
      370     4634        */
      371     4635    2       IF DISPLAY_COUNT ~= 0 THEN

   4635 18 000675   200104 235100                    LDA     DISPLAY_COUNT,,AUTO
        18 000676   000751 600000 18                 TZE     s:4648

      372     4636    3         DO;

      373     4637    3           PART = (LINE_LENGTH - DISPLAY_COUNT) * FACTOR ;

   4637 18 000677   200106 236100                    LDQ     LINE_LENGTH,,AUTO
        18 000700   200104 136100                    SBLQ    DISPLAY_COUNT,,AUTO
        18 000701   100000 402100                    MPY     0,,PR1
        18 000702   200427 756100                    STQ     PART,,AUTO

      374     4638    3           X_LENGTH = X_LENGTH - PART/FACTOR ;

   4638 18 000703   100000 506100                    DIV     0,,PR1
        18 000704   200432 756100                    STQ     SHIFTS+1,,AUTO
        18 000705   200426 236100                    LDQ     X_LENGTH,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:71   
        18 000706   200432 136100                    SBLQ    SHIFTS+1,,AUTO
        18 000707   200426 756100                    STQ     X_LENGTH,,AUTO

      375     4639    3           CALL CONCAT (DISPLAY_STRING, SUBSTR (DISPLAY_STRING, 0, BUFFER_COUNT),

   4639 18 000710   200105 720100                    LXL0    BUFFER_COUNT,,AUTO
        18 000711   040100 100540                    MLR     fill='040'O
        18 000712   200107 000010                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=*X0
        18 000713   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396
        18 000714   200105 236100                    LDQ     BUFFER_COUNT,,AUTO
        18 000715   000614 116007                    CMPQ    396,DL
        18 000716   000726 605000 18                 TPL     s:4641
        18 000717   777163 622006                    EAX2    -397,QL
        18 000720   777777 662003                    ERX2    -1,DU
        18 000721   200423 473500                    LDP3    @STRING,,AUTO
        18 000722   200427 723100                    LXL3    PART,,AUTO
        18 000723   040146 100540                    MLR     fill='040'O
        18 000724   300000 000013                    ADSC9   0,,PR3                   cn=0,n=*X3
        18 000725   200107 000012                    ADSC9   DISPLAY_STRING,Q,AUTO    cn=0,n=*X2

      376     4640    3                        SUBSTR (STRING, 0, PART));
      377     4641    3           BUFFER_COUNT = BUFFER_COUNT + PART ;

   4641 18 000726   200105 236100                    LDQ     BUFFER_COUNT,,AUTO
        18 000727   200427 036100                    ADLQ    PART,,AUTO
        18 000730   200105 756100                    STQ     BUFFER_COUNT,,AUTO

      378     4642    3           CALL X9LP$PRINT (DISPLAY_STRING, BUFFER_COUNT, OVERFLOW_CODE);

   4642 18 000731   200077 633500                    EPPR3   OVERFLOW_CODE,,AUTO
        18 000732   200434 453500                    STP3    SHIFTS+3,,AUTO
        18 000733   200105 634500                    EPPR4   BUFFER_COUNT,,AUTO
        18 000734   200433 454500                    STP4    SHIFTS+2,,AUTO
        18 000735   200107 635500                    EPPR5   DISPLAY_STRING,,AUTO
        18 000736   200432 455500                    STP5    SHIFTS+1,,AUTO
        18 000737   200432 630500                    EPPR0   SHIFTS+1,,AUTO
        18 000740   000013 631400 19                 EPPR1   11
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:72   
        18 000741   000000 701000 xent               TSX1    X9LP$PRINT
        18 000742   000000 011000                    NOP     0

      379     4643    3           DISPLAY_STRING = ' ';

   4643 18 000743   040100 100400                    MLR     fill='040'O
        18 000744   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000745   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396

      380     4644    3           DISPLAY_COUNT = 0;

   4644 18 000746   200104 450100                    STZ     DISPLAY_COUNT,,AUTO

      381     4645    3           BUFFER_COUNT = 0 ;

   4645 18 000747   200105 450100                    STZ     BUFFER_COUNT,,AUTO

      382     4646    3         END; /* IF DO */

   4646 18 000750   000752 710000 18                 TRA     s:4655

      383     4647    2       ELSE
      384     4648    2         PART = 0 ;

   4648 18 000751   200427 450100                    STZ     PART,,AUTO

      385     4649        /*V*
      386     4650                                      NEW_BUFFER
      387     4651             Fill and output the new buffer as many times as needed to exhaust the arg.
      388     4652
      389     4653        */
      390     4654
      391     4655    3       DO WHILE (X_LENGTH >= LINE_LENGTH);

   4655 18 000752   200426 236100                    LDQ     X_LENGTH,,AUTO
        18 000753   001014 604000 18                 TMI     s:4669
        18 000754   200106 116100                    CMPQ    LINE_LENGTH,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:73   
        18 000755   001014 602000 18                 TNC     s:4669

      392     4656    3         CALL X9LP$PRINT (SUBSTR (STRING, PART, LINE_LENGTH * FACTOR),

   4656 18 000756   200425 470500                    LDP0    @FACTOR,,AUTO
        18 000757   200106 236100                    LDQ     LINE_LENGTH,,AUTO
        18 000760   000000 402100                    MPY     0,,PR0
        18 000761   200432 756100                    STQ     SHIFTS+1,,AUTO
        18 000762   200106 236100                    LDQ     LINE_LENGTH,,AUTO
        18 000763   000000 402100                    MPY     0,,PR0
        18 000764   200433 756100                    STQ     SHIFTS+2,,AUTO
        18 000765   200077 631500                    EPPR1   OVERFLOW_CODE,,AUTO
        18 000766   200436 451500                    STP1    SHIFTS+5,,AUTO
        18 000767   200433 633500                    EPPR3   SHIFTS+2,,AUTO
        18 000770   200435 453500                    STP3    SHIFTS+4,,AUTO
        18 000771   200427 236100                    LDQ     PART,,AUTO
        18 000772   000020 736000                    QLS     16
        18 000773   200423 036100                    ADLQ    @STRING,,AUTO
        18 000774   200434 756100                    STQ     SHIFTS+3,,AUTO
        18 000775   200434 630500                    EPPR0   SHIFTS+3,,AUTO
        18 000776   000013 631400 19                 EPPR1   11
        18 000777   000000 701000 xent               TSX1    X9LP$PRINT
        18 001000   000000 011000                    NOP     0

      393     4657    3                          LINE_LENGTH * FACTOR, OVERFLOW_CODE);
      394     4658    3         PART = PART + LINE_LENGTH * FACTOR;

   4658 18 001001   200425 470500                    LDP0    @FACTOR,,AUTO
        18 001002   200106 236100                    LDQ     LINE_LENGTH,,AUTO
        18 001003   000000 402100                    MPY     0,,PR0
        18 001004   200427 036100                    ADLQ    PART,,AUTO
        18 001005   200427 756100                    STQ     PART,,AUTO

      395     4659    3         X_LENGTH = X_LENGTH - LINE_LENGTH;

   4659 18 001006   200426 236100                    LDQ     X_LENGTH,,AUTO
        18 001007   200106 136100                    SBLQ    LINE_LENGTH,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:74   
        18 001010   200426 756100                    STQ     X_LENGTH,,AUTO

      396     4660    3       END; /* while x_length >= line_length */

   4660 18 001011   001014 604000 18                 TMI     s:4669
        18 001012   200106 116100                    CMPQ    LINE_LENGTH,,AUTO
        18 001013   000756 603000 18                 TRC     s:4656

      397     4661        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:75   
      398     4662        /*V*
      399     4663                                      SET_LENGTHS
      400     4664             Set length of buffer according to the variable x_lnth which contains
      401     4665             the length of the unprinted arg.
      402     4666
      403     4667        */
      404     4668
      405     4669    2       IF X_LENGTH > 0 THEN

   4669 18 001014   000000 116003                    CMPQ    0,DU
        18 001015   001034 604400 18                 TMOZ    s:4677

      406     4670    3         DO;

      407     4671    3           DISPLAY_COUNT = X_LENGTH;

   4671 18 001016   200104 756100                    STQ     DISPLAY_COUNT,,AUTO

      408     4672    3           DISPLAY_STRING = SUBSTR (STRING, PART) ;

   4672 18 001017   200430 236100                    LDQ     SIZE_IN_BUFFER,,AUTO
        18 001020   200427 136100                    SBLQ    PART,,AUTO
        18 001021   200423 470500                    LDP0    @STRING,,AUTO
        18 001022   000000 620006                    EAX0    0,QL
        18 001023   200427 235100                    LDA     PART,,AUTO
        18 001024   040100 100545                    MLR     fill='040'O
        18 001025   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        18 001026   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396

      409     4673    3           BUFFER_COUNT = X_LENGTH * FACTOR ;

   4673 18 001027   200425 471500                    LDP1    @FACTOR,,AUTO
        18 001030   200426 236100                    LDQ     X_LENGTH,,AUTO
        18 001031   100000 402100                    MPY     0,,PR1
        18 001032   200105 756100                    STQ     BUFFER_COUNT,,AUTO

      410     4674    3         END;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:76   

   4674 18 001033   001041 710000 18                 TRA     s:4681

      411     4675    2       ELSE
      412     4676    3         DO;

      413     4677    3           DISPLAY_STRING = ' ';

   4677 18 001034   040100 100400                    MLR     fill='040'O
        18 001035   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 001036   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396

      414     4678    3           DISPLAY_COUNT = 0;

   4678 18 001037   200104 450100                    STZ     DISPLAY_COUNT,,AUTO

      415     4679    3           BUFFER_COUNT = 0 ;

   4679 18 001040   200105 450100                    STZ     BUFFER_COUNT,,AUTO

      416     4680    3         END;  /* else if x_length <= 0 */

      417     4681    2     END CUTLINE;  /* proc */

   4681 18 001041   200422 221300                    LDX1  ! TEMP_NUM+1,,AUTO
        18 001042   000001 702211                    TSX2  ! 1,X1

      418     4682        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:77   
      419     4683        /*--------*/
      420     4684    1     UNPACKED:            PROC;

   4684 18 001043   200414 741300       UNPACKED     STX1  ! RESULT+8,,AUTO

      421     4685        /*--------*/
      422     4686
      423     4687        /*I*
      424     4688             NAME:  UNPACKED
      425     4689
      426     4690             PURPOSE:
      427     4691        */
      428     4692
      429     4693    2       IF  DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE

   4693 18 001044   200004 470500                    LDP0    @DESC,,AUTO
        18 001045   200100 720100                    LXL0    L,,AUTO
        18 001046   000001 222110                    LDX2    1,X0,PR0
        18 001047   000003 102003                    CMPX2   3,DU
        18 001050   001053 600000 18                 TZE     s:4695
        18 001051   000004 102003                    CMPX2   4,DU
        18 001052   001055 601000 18                 TNZ     s:4697

      430     4694    2       OR  DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_DOUBLE  THEN
      431     4695    2         CALL DISPLAY_FLOATING_POINT ;

   4695 18 001053   001224 701000 18                 TSX1    DISPLAY_FLOATING_POINT
        18 001054   000000 011000                    NOP     0

      432     4696
      433     4697    2       IF NOT LIBCOM.COBOL_74 THEN

   4697 18 001055   000000 234000 0                  SZN     LIBCOM
        18 001056   001144 604000 18                 TMI     s:4736

      434     4698    3         DO;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:78   
      435     4699    3           IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_TRAIL_OPUNCH_SIGN

   4699 18 001057   200004 470500                    LDP0    @DESC,,AUTO
        18 001060   200100 720100                    LXL0    L,,AUTO
        18 001061   000001 221110                    LDX1    1,X0,PR0
        18 001062   000055 101003                    CMPX1   45,DU
        18 001063   001066 600000 18                 TZE     s:4701
        18 001064   000054 101003                    CMPX1   44,DU
        18 001065   001070 601000 18                 TNZ     s:4703

      436     4700    3           OR DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_LEAD_OPUNCH_SIGN THEN
      437     4701    3             CALL DISPLAY_OVERPUNCH;

   4701 18 001066   001547 701000 18                 TSX1    DISPLAY_OVERPUNCH
        18 001067   000000 011000                    NOP     0

      438     4702
      439     4703    3           IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_TRAIL_SIGN

   4703 18 001070   200004 470500                    LDP0    @DESC,,AUTO
        18 001071   200100 720100                    LXL0    L,,AUTO
        18 001072   000001 221110                    LDX1    1,X0,PR0
        18 001073   000053 101003                    CMPX1   43,DU
        18 001074   001101 600000 18                 TZE     s:4706
        18 001075   000037 101003                    CMPX1   31,DU
        18 001076   001101 600000 18                 TZE     s:4706
        18 001077   000031 101003                    CMPX1   25,DU
        18 001100   001103 601000 18                 TNZ     s:4708

      440     4704    3           OR DESC.D_WORD.DES_W.TYPE(L) = %PACK_FIXED_TRAIL_SIGN_EBCDIC
      441     4705    3           OR DESC.D_WORD.DES_W.TYPE(L) = %PACK_FIXED_TRAIL_SIGN THEN
      442     4706    3             CALL DISPLAY_TRAILING_SIGN;

   4706 18 001101   002360 701000 18                 TSX1    DISPLAY_TRAILING_SIGN
        18 001102   000000 011000                    NOP     0

      443     4707
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:79   
      444     4708    3           IF DESC.D_WORD.DES_W.TYPE(L) ~= %RUNTIME_BINARY_FLOAT_SINGLE

   4708 18 001103   200004 470500                    LDP0    @DESC,,AUTO
        18 001104   200100 720100                    LXL0    L,,AUTO
        18 001105   000001 221110                    LDX1    1,X0,PR0
        18 001106   000003 101003                    CMPX1   3,DU
        18 001107   001144 600000 18                 TZE     s:4736
        18 001110   000004 101003                    CMPX1   4,DU
        18 001111   001144 600000 18                 TZE     s:4736

      445     4709    3           AND DESC.D_WORD.DES_W.TYPE(L) ~= %RUNTIME_BINARY_FLOAT_DOUBLE THEN
      446     4710    4             DO;

      447     4711    4               IF DESC.D_WORD.DES_W.NDSC.SF(L)< (I * -1) THEN

   4711 18 001112   200102 335100                    LCA     I,,AUTO
        18 001113   200432 755100                    STA     SHIFTS+1,,AUTO
        18 001114   000001 236110                    LDQ     1,X0,PR0
        18 001115   000030 736000                    QLS     24
        18 001116   000036 732000                    QRS     30
        18 001117   200432 116100                    CMPQ    SHIFTS+1,,AUTO
        18 001120   001124 605000 18                 TPL     s:4714

      448     4712    4                 CALL ADJUST_FOR_LARGE_SF ;

   4712 18 001121   002415 701000 18                 TSX1    ADJUST_FOR_LARGE_SF
        18 001122   000000 011000                    NOP     0
        18 001123   001144 710000 18                 TRA     s:4736

      449     4713    4               ELSE
      450     4714    4                 IF (DESC.D_WORD.DES_W.NDSC.SF(L) < %ZERO) AND

   4714 18 001124   000000 116003                    CMPQ    0,DU
        18 001125   001135 605000 18                 TPL     s:4718
        18 001126   000024 676000 19                 ERQ     20
        18 001127   000001 036007                    ADLQ    1,DL
        18 001130   200102 116100                    CMPQ    I,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:80   
        18 001131   001135 605400 18                 TPNZ    s:4718

      451     4715    4                 ((DESC.D_WORD.DES_W.NDSC.SF(L) * -1) <=  I ) THEN
      452     4716    4                   CALL ADJUST_FOR_MEDIUM_SF;

   4716 18 001132   002537 701000 18                 TSX1    ADJUST_FOR_MEDIUM_SF
        18 001133   000000 011000                    NOP     0
        18 001134   001144 710000 18                 TRA     s:4736

      453     4717    4                 ELSE
      454     4718    4                   IF DESC.D_WORD.DES_W.NDSC.SF(L)>%ZERO THEN

   4718 18 001135   000001 236110                    LDQ     1,X0,PR0
        18 001136   000030 736000                    QLS     24
        18 001137   000036 732000                    QRS     30
        18 001140   000000 116003                    CMPQ    0,DU
        18 001141   001144 604400 18                 TMOZ    s:4736

      455     4719    4                     CALL ADJUST_FOR_SMALL_SF;

   4719 18 001142   002623 701000 18                 TSX1    ADJUST_FOR_SMALL_SF
        18 001143   000000 011000                    NOP     0

      456     4720    4              END;

      457     4721    3       END; /*  END COBOL 85 SEMANTICS LOOP */

      458     4722
      459     4723        /*V*
      460     4724                                     LINE_TOO_LONG
      461     4725             If the length of the print buffer + the length of the current input data >
      462     4726             the length of a ''print line'' then apply appropriate semantics, COBOL 74
      463     4727             or 85
      464     4728
      465     4729        */
      466     4730        /*V*
      467     4731                                     COBOL_74_OR_85
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:81   
      468     4732             COBOL_74 semantics call for the current data to be chopped off after being
      469     4733             placed in the buffer and then continued on the next line
      470     4734
      471     4735        */
      472     4736    2       IF I + DISPLAY_COUNT > LINE_LENGTH  THEN

   4736 18 001144   200102 236100                    LDQ     I,,AUTO
        18 001145   200104 036100                    ADLQ    DISPLAY_COUNT,,AUTO
        18 001146   001163 604000 18                 TMI     s:4747
        18 001147   200106 116100                    CMPQ    LINE_LENGTH,,AUTO
        18 001150   001163 602000 18                 TNC     s:4747
        18 001151   001163 600000 18                 TZE     s:4747

      473     4737    2         CALL CUTLINE (RESULT_ARG, I, %FACTOR_ASCII) ;

   4737 18 001152   000002 236000 19                 LDQ     2
        18 001153   200425 756100                    STQ     @FACTOR,,AUTO
        18 001154   200102 630500                    EPPR0   I,,AUTO
        18 001155   200424 450500                    STP0    @SIZE_ON_DEVICE,,AUTO
        18 001156   200330 236100                    LDQ     RESULT_ARG$,,AUTO
        18 001157   200423 756100                    STQ     @STRING,,AUTO
        18 001160   000665 701000 18                 TSX1    CUTLINE
        18 001161   000000 011000                    NOP     0
        18 001162   001222 710000 18                 TRA     s:4768

      474     4738    2       ELSE
      475     4739    3         DO;

      476     4740
      477     4741        /*V*
      478     4742                                      LINE_OK
      479     4743             Add the current arg to the end of the print buffer and increment to
      480     4744             the new length
      481     4745
      482     4746        */
      483     4747    3           IF DISPLAY_COUNT ~= 0 THEN

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:82   
   4747 18 001163   200104 235100                    LDA     DISPLAY_COUNT,,AUTO
        18 001164   001212 600000 18                 TZE     s:4763

      484     4748    4             DO;

      485     4749    4               CALL CONCAT (DISPLAY_STRING, SUBSTR (DISPLAY_STRING, 0,

   4749 18 001165   200105 720100                    LXL0    BUFFER_COUNT,,AUTO
        18 001166   040100 100540                    MLR     fill='040'O
        18 001167   200107 000010                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=*X0
        18 001170   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396
        18 001171   200105 236100                    LDQ     BUFFER_COUNT,,AUTO
        18 001172   000614 116007                    CMPQ    396,DL
        18 001173   001203 605000 18                 TPL     s:4751
        18 001174   777163 621006                    EAX1    -397,QL
        18 001175   777777 661003                    ERX1    -1,DU
        18 001176   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 001177   200102 722100                    LXL2    I,,AUTO
        18 001200   040146 100540                    MLR     fill='040'O
        18 001201   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        18 001202   200107 000011                    ADSC9   DISPLAY_STRING,Q,AUTO    cn=0,n=*X1

      486     4750    4                            BUFFER_COUNT), RESULT_ARG);    /*#28021*/
      487     4751    4               DISPLAY_COUNT = DISPLAY_COUNT + I;

   4751 18 001203   200104 236100                    LDQ     DISPLAY_COUNT,,AUTO
        18 001204   200102 036100                    ADLQ    I,,AUTO
        18 001205   200104 756100                    STQ     DISPLAY_COUNT,,AUTO

      488     4752    4               BUFFER_COUNT = BUFFER_COUNT + I;

   4752 18 001206   200105 236100                    LDQ     BUFFER_COUNT,,AUTO
        18 001207   200102 036100                    ADLQ    I,,AUTO
        18 001210   200105 756100                    STQ     BUFFER_COUNT,,AUTO

      489     4753    4             END;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:83   
   4753 18 001211   001222 710000 18                 TRA     s:4768

      490     4754
      491     4755        /*V*
      492     4756                                      FIRST_TIME
      493     4757             First time through... length of buffer is length of string, contents
      494     4758             of buffer is the string.
      495     4759
      496     4760        */
      497     4761    3           ELSE
      498     4762    4             DO;

      499     4763    4               DISPLAY_COUNT = I;

   4763 18 001212   200102 236100                    LDQ     I,,AUTO
        18 001213   200104 756100                    STQ     DISPLAY_COUNT,,AUTO

      500     4764    4               BUFFER_COUNT = DISPLAY_COUNT;

   4764 18 001214   200105 756100                    STQ     BUFFER_COUNT,,AUTO

      501     4765    4               DISPLAY_STRING = RESULT_ARG;

   4765 18 001215   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 001216   000000 620006                    EAX0    0,QL
        18 001217   040100 100540                    MLR     fill='040'O
        18 001220   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        18 001221   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396

      502     4766    4             END;

      503     4767    3         END; /* else do */

      504     4768    2   END UNPACKED;  /* proc */

   4768 18 001222   200414 221300                    LDX1  ! RESULT+8,,AUTO
        18 001223   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:84   

      505     4769        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:85   
      506     4770        /*----------------------*/
      507     4771    1     DISPLAY_FLOATING_POINT:     PROC;

   4771 18 001224   200416 741300       DISPLAY_FLO* STX1  ! @STRING+1,,AUTO

      508     4772        /*----------------------*/
      509     4773
      510     4774        /*I*
      511     4775             NAME:  DISPLAY_FLOATING_POINT
      512     4776
      513     4777             PURPOSE:  To convert a floating point number to its display
      514     4778                       format and store into the temporary argument buffer.
      515     4779        */
      516     4780
      517     4781    2   DCL LAST      UBIN WORD;
      518     4782    2   DCL COUNT     UBIN WORD;
      519     4783    2   DCL TEMP_NUM  UBIN WORD;
      520     4784    2   DCL TEMP_CHAR CHAR(10);
      521     4785    2   DCL SAVE_CHAR CHAR(10);
      522     4786    2   DCL START     UBIN WORD;
      523     4787    2   DCL SHIFTS    UBIN WORD;
      524     4788
      525     4789
      526     4790    2       EXPON.EXPONEN = SUBSTR(REC_FLD, 27, 1);

   4790 18 001225   200371 236100                    LDQ     REC_FLD+6,,AUTO
        18 001226   000033 736000                    QLS     27
        18 001227   200332 552140                    STBQ    EXPON,'40'O,AUTO

      527     4791    2       LARGE_EXPON.EXPONENT.EXP = EXPON.EXPONENT.EXP;

   4791 18 001230   200332 236100                    LDQ     EXPON,,AUTO
        18 001231   000001 736000                    QLS     1
        18 001232   000034 732000                    QRS     28
        18 001233   000033 736000                    QLS     27
        18 001234   200333 552140                    STBQ    LARGE_EXPON,'40'O,AUTO

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:86   
      528     4792
      529     4793    2       IF DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE   THEN

   4793 18 001235   200004 470500                    LDP0    @DESC,,AUTO
        18 001236   200100 720100                    LXL0    L,,AUTO
        18 001237   000001 222110                    LDX2    1,X0,PR0
        18 001240   000003 102003                    CMPX2   3,DU
        18 001241   001251 601000 18                 TNZ     s:4801

      530     4794    3         DO;

      531     4795    3           I = 15;

   4795 18 001242   000017 235007                    LDA     15,DL
        18 001243   200102 755100                    STA     I,,AUTO

      532     4796    3           LAST = 8;

   4796 18 001244   000010 236007                    LDQ     8,DL
        18 001245   200417 756100                    STQ     LAST,,AUTO

      533     4797    3           LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 18;

   4797 18 001246   022000 236003                    LDQ     9216,DU
        18 001247   200333 056100                    ASQ     LARGE_EXPON,,AUTO

      534     4798    3         END;

   4798 18 001250   001257 710000 18                 TRA     s:4806

      535     4799    2       ELSE
      536     4800    3         DO;

      537     4801    3           I = 25;

   4801 18 001251   000031 235007                    LDA     25,DL
        18 001252   200102 755100                    STA     I,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:87   

      538     4802    3           LAST = 18;

   4802 18 001253   000022 236007                    LDQ     18,DL
        18 001254   200417 756100                    STQ     LAST,,AUTO

      539     4803    3           LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 8;

   4803 18 001255   010000 236003                    LDQ     4096,DU
        18 001256   200333 056100                    ASQ     LARGE_EXPON,,AUTO

      540     4804    3         END;

      541     4805
      542     4806    2       SHIFTS = 0;

   4806 18 001257   200431 450100                    STZ     SHIFTS,,AUTO

      543     4807
      544     4808    3       DO WHILE( (SUBSTR( REC_FLD, SHIFTS + 1, 1 ) = '0' )  AND

   4808 18 001260   001264 710000 18                 TRA     s:4812

      545     4809    3              ( SHIFTS <= 25 ) );
      546     4810
      547     4811    3         SHIFTS = SHIFTS + 1;

   4811 18 001261   200431 235100                    LDA     SHIFTS,,AUTO
        18 001262   000001 035007                    ADLA    1,DL
        18 001263   200431 755100                    STA     SHIFTS,,AUTO

      548     4812    3       END;

   4812 18 001264   200431 235100                    LDA     SHIFTS,,AUTO
        18 001265   040000 106505                    CMPC    fill='040'O
        18 001266   200363 200001                    ADSC9   REC_FLD,A,AUTO           cn=1,n=1
        18 001267   000025 000001 19                 ADSC9   21                       cn=0,n=1
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:88   
        18 001270   001273 601000 18                 TNZ     s:4814
        18 001271   000032 115007                    CMPA    26,DL
        18 001272   001261 602000 18                 TNC     s:4811

      549     4813
      550     4814    3       IF SHIFTS > 0 THEN DO;

   4814 18 001273   000000 115003                    CMPA    0,DU
        18 001274   001315 600000 18                 TZE     s:4824

      551     4815
      552     4816    3         TEMP_ARG = SUBSTR( REC_FLD, SHIFTS + 1, 25 );

   4816 18 001275   040100 100505                    MLR     fill='040'O
        18 001276   200363 200031                    ADSC9   REC_FLD,A,AUTO           cn=1,n=25
        18 001277   200252 000132                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=90

      553     4817    3         CALL INSERT( TEMP_ARG, 26 - SHIFTS, 25, ZEROES );

   4817 18 001300   000024 675000 19                 ERA     20
        18 001301   000001 035007                    ADLA    1,DL
        18 001302   040105 100400                    MLR     fill='040'O
        18 001303   000000 000031 17                 ADSC9   ZEROES                   cn=0,n=25
        18 001304   200260 400031                    ADSC9   TEMP_ARG+6,A,AUTO        cn=2,n=25

      554     4818    3         CALL INSERT( REC_FLD, 1, 26, TEMP_ARG );

   4818 18 001305   040100 100500                    MLR     fill='040'O
        18 001306   200252 000032                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=26
        18 001307   200363 200032                    ADSC9   REC_FLD,,AUTO            cn=1,n=26

      555     4819
      556     4820    3         LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP - SHIFTS;

   4820 18 001310   200333 236100                    LDQ     LARGE_EXPON,,AUTO
        18 001311   000033 732000                    QRS     27
        18 001312   200431 136100                    SBLQ    SHIFTS,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:89   
        18 001313   000033 736000                    QLS     27
        18 001314   200333 552140                    STBQ    LARGE_EXPON,'40'O,AUTO

      557     4821
      558     4822    3       END;

      559     4823
      560     4824    2       IF SUBSTR( REC_FLD, LAST + 1, 1 ) >= '5'    THEN

   4824 18 001315   200417 235100                    LDA     LAST,,AUTO
        18 001316   040000 106505                    CMPC    fill='040'O
        18 001317   200363 200001                    ADSC9   REC_FLD,A,AUTO           cn=1,n=1
        18 001320   000026 000001 19                 ADSC9   22                       cn=0,n=1
        18 001321   001457 602000 18                 TNC     s:4881

      561     4825    3         DO;

      562     4826
      563     4827    3           IF DESC.D_WORD.DES_W.TYPE(L) = %RUNTIME_BINARY_FLOAT_SINGLE  THEN

   4827 18 001322   200004 470500                    LDP0    @DESC,,AUTO
        18 001323   200100 720100                    LXL0    L,,AUTO
        18 001324   000001 221110                    LDX1    1,X0,PR0
        18 001325   000003 101003                    CMPX1   3,DU
        18 001326   001364 601000 18                 TNZ     s:4848

      564     4828    4             DO;

      565     4829
      566     4830    4               CALL CHARBIN( TEMP_NUM, SUBSTR( REC_FLD, 1, LAST ));

   4830 18 001327   000000 622005                    EAX2    0,AL
        18 001330   000100 305540                    DTB
        18 001331   200363 230012                    NDSC9   REC_FLD,,AUTO            cn=1,s=nosgn,sf=0,n=*X2
        18 001332   200432 000010                    NDSC9   SHIFTS+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
        18 001333   200433 235100                    LDA     SHIFTS+2,,AUTO
        18 001334   200421 755100                    STA     TEMP_NUM,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:90   

      567     4831    4               TEMP_NUM = TEMP_NUM + 1;

   4831 18 001335   000001 035007                    ADLA    1,DL
        18 001336   200421 755100                    STA     TEMP_NUM,,AUTO

      568     4832    4               CALL BINCHAR( TEMP_CHAR, TEMP_NUM );

   4832 18 001337   000044 773000                    LRL     36
        18 001340   200432 757100                    STAQ    SHIFTS+1,,AUTO
        18 001341   000100 301500                    BTD
        18 001342   200432 000010                    NDSC9   SHIFTS+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
        18 001343   200422 030012                    NDSC9   TEMP_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=10

      569     4833
      570     4834    4               IF SUBSTR( TEMP_CHAR, 1, 1 ) = '1'       THEN

   4834 18 001344   200422 236100                    LDQ     TEMP_CHAR,,AUTO
        18 001345   000777 376003                    ANQ     511,DU
        18 001346   000061 116003                    CMPQ    49,DU
        18 001347   001355 601000 18                 TNZ     s:4840

      571     4835    5                 DO;

      572     4836    5                   LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 1;

   4836 18 001350   001000 236003                    LDQ     512,DU
        18 001351   200333 056100                    ASQ     LARGE_EXPON,,AUTO

      573     4837    5                   START = 1;

   4837 18 001352   000001 235007                    LDA     1,DL
        18 001353   200430 755100                    STA     START,,AUTO

      574     4838    5                 END;

   4838 18 001354   001357 710000 18                 TRA     s:4842
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:91   

      575     4839    4               ELSE
      576     4840    4                 START = 2;

   4840 18 001355   000002 235007                    LDA     2,DL
        18 001356   200430 755100                    STA     START,,AUTO

      577     4841
      578     4842    4               SUBSTR( REC_FLD, 1, LAST ) = SUBSTR( TEMP_CHAR, START, LAST );

   4842 18 001357   200417 721100                    LXL1    LAST,,AUTO
        18 001360   040140 100545                    MLR     fill='040'O
        18 001361   200422 000011                    ADSC9   TEMP_CHAR,A,AUTO         cn=0,n=*X1
        18 001362   200363 200011                    ADSC9   REC_FLD,,AUTO            cn=1,n=*X1

      579     4843
      580     4844    4             END;

   4844 18 001363   001457 710000 18                 TRA     s:4881

      581     4845    3           ELSE
      582     4846    4             DO;

      583     4847
      584     4848    4               CALL CHARBIN( TEMP_NUM, SUBSTR( REC_FLD, 10, 9 ) );

   4848 18 001364   000100 305500                    DTB
        18 001365   200365 430011                    NDSC9   REC_FLD+2,,AUTO          cn=2,s=nosgn,sf=0,n=9
        18 001366   200432 000010                    NDSC9   SHIFTS+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
        18 001367   200433 236100                    LDQ     SHIFTS+2,,AUTO
        18 001370   200421 756100                    STQ     TEMP_NUM,,AUTO

      585     4849    4               TEMP_NUM = TEMP_NUM + 1;

   4849 18 001371   000001 036007                    ADLQ    1,DL
        18 001372   200421 756100                    STQ     TEMP_NUM,,AUTO

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:92   
      586     4850    4               CALL BINCHAR( SAVE_CHAR, TEMP_NUM );

   4850 18 001373   000000 235003                    LDA     0,DU
        18 001374   200432 757100                    STAQ    SHIFTS+1,,AUTO
        18 001375   000100 301500                    BTD
        18 001376   200432 000010                    NDSC9   SHIFTS+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
        18 001377   200425 030012                    NDSC9   SAVE_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=10

      587     4851
      588     4852    4               IF SUBSTR( REC_FLD, 10, 1 ) = '9'     AND

   4852 18 001400   200365 236100                    LDQ     REC_FLD+2,,AUTO
        18 001401   777000 376007                    ANQ     -512,DL
        18 001402   071000 116007                    CMPQ    29184,DL
        18 001403   001454 601000 18                 TNZ     s:4875
        18 001404   200425 236100                    LDQ     SAVE_CHAR,,AUTO
        18 001405   777000 376003                    ANQ     -512,DU
        18 001406   061000 116003                    CMPQ    25088,DU
        18 001407   001454 601000 18                 TNZ     s:4875

      589     4853    4                  SUBSTR( SAVE_CHAR, 0, 1 ) = '1'        THEN
      590     4854    5                 DO;

      591     4855
      592     4856    5                   CALL CHARBIN( TEMP_NUM, SUBSTR( REC_FLD, 1, 9 ) );

   4856 18 001410   000100 305500                    DTB
        18 001411   200363 230011                    NDSC9   REC_FLD,,AUTO            cn=1,s=nosgn,sf=0,n=9
        18 001412   200432 000010                    NDSC9   SHIFTS+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
        18 001413   200433 236100                    LDQ     SHIFTS+2,,AUTO
        18 001414   200421 756100                    STQ     TEMP_NUM,,AUTO

      593     4857    5                   TEMP_NUM = TEMP_NUM + 1;

   4857 18 001415   000001 036007                    ADLQ    1,DL
        18 001416   200421 756100                    STQ     TEMP_NUM,,AUTO

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:93   
      594     4858    5                   CALL BINCHAR( TEMP_CHAR, TEMP_NUM );

   4858 18 001417   000000 235003                    LDA     0,DU
        18 001420   200432 757100                    STAQ    SHIFTS+1,,AUTO
        18 001421   000100 301500                    BTD
        18 001422   200432 000010                    NDSC9   SHIFTS+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
        18 001423   200422 030012                    NDSC9   TEMP_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=10

      595     4859
      596     4860    5                   IF SUBSTR( REC_FLD, 1, 1 ) = '9'    AND

   4860 18 001424   200363 236100                    LDQ     REC_FLD,,AUTO
        18 001425   000777 376003                    ANQ     511,DU
        18 001426   000071 116003                    CMPQ    57,DU
        18 001427   001445 601000 18                 TNZ     s:4869
        18 001430   200422 236100                    LDQ     TEMP_CHAR,,AUTO
        18 001431   777000 376003                    ANQ     -512,DU
        18 001432   061000 116003                    CMPQ    25088,DU
        18 001433   001445 601000 18                 TNZ     s:4869

      597     4861    5                      SUBSTR( TEMP_CHAR, 0, 1 ) = '1'      THEN
      598     4862    6                     DO;

      599     4863    6                       SUBSTR( REC_FLD, 1, 10 ) = TEMP_CHAR;

   4863 18 001434   040100 100500                    MLR     fill='040'O
        18 001435   200422 000012                    ADSC9   TEMP_CHAR,,AUTO          cn=0,n=10
        18 001436   200363 200012                    ADSC9   REC_FLD,,AUTO            cn=1,n=10

      600     4864    6                       SUBSTR( REC_FLD, 11, 8 ) = SUBSTR( SAVE_CHAR, 1, 8 );

   4864 18 001437   040100 100500                    MLR     fill='040'O
        18 001440   200425 200010                    ADSC9   SAVE_CHAR,,AUTO          cn=1,n=8
        18 001441   200365 600010                    ADSC9   REC_FLD+2,,AUTO          cn=3,n=8

      601     4865    6                       LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 1;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:94   
   4865 18 001442   001000 236003                    LDQ     512,DU
        18 001443   200333 056100                    ASQ     LARGE_EXPON,,AUTO

      602     4866    6                     END;

   4866 18 001444   001457 710000 18                 TRA     s:4881

      603     4867    5                   ELSE
      604     4868    6                     DO;

      605     4869    6                       SUBSTR( REC_FLD, 1, 9 ) = SUBSTR( TEMP_CHAR, 1, 9 );

   4869 18 001445   040100 100500                    MLR     fill='040'O
        18 001446   200422 200011                    ADSC9   TEMP_CHAR,,AUTO          cn=1,n=9
        18 001447   200363 200011                    ADSC9   REC_FLD,,AUTO            cn=1,n=9

      606     4870    6                       SUBSTR( REC_FLD, 10, 9 ) = SUBSTR( SAVE_CHAR, 1, 9 );

   4870 18 001450   040100 100500                    MLR     fill='040'O
        18 001451   200425 200011                    ADSC9   SAVE_CHAR,,AUTO          cn=1,n=9
        18 001452   200365 400011                    ADSC9   REC_FLD+2,,AUTO          cn=2,n=9

      607     4871    6                     END;

      608     4872
      609     4873    5                 END;

   4873 18 001453   001457 710000 18                 TRA     s:4881

      610     4874    4               ELSE
      611     4875    4                 SUBSTR( REC_FLD, 10, 9 ) = SUBSTR( SAVE_CHAR, 1, 9 );

   4875 18 001454   040100 100500                    MLR     fill='040'O
        18 001455   200425 200011                    ADSC9   SAVE_CHAR,,AUTO          cn=1,n=9
        18 001456   200365 400011                    ADSC9   REC_FLD+2,,AUTO          cn=2,n=9

      612     4876
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:95   
      613     4877    4             END;

      614     4878
      615     4879    3         END;

      616     4880
      617     4881    2       COUNT = LAST;

   4881 18 001457   200417 235100                    LDA     LAST,,AUTO
        18 001460   200420 755100                    STA     COUNT,,AUTO

      618     4882
      619     4883    3       DO WHILE( (SUBSTR( REC_FLD, COUNT, 1 ) = '0' )  AND

   4883 18 001461   001467 710000 18                 TRA     s:4889

      620     4884    3              ( LARGE_EXPON.EXPONENT.EXP ~= 0 ) );
      621     4885
      622     4886    3         COUNT = COUNT - 1;

   4886 18 001462   200420 235100                    LDA     COUNT,,AUTO
        18 001463   000001 135007                    SBLA    1,DL
        18 001464   200420 755100                    STA     COUNT,,AUTO

      623     4887    3         LARGE_EXPON.EXPONENT.EXP = LARGE_EXPON.EXPONENT.EXP + 1;

   4887 18 001465   001000 236003                    LDQ     512,DU
        18 001466   200333 056100                    ASQ     LARGE_EXPON,,AUTO

      624     4888
      625     4889    3       END;

   4889 18 001467   040000 106505                    CMPC    fill='040'O
        18 001470   200363 000001                    ADSC9   REC_FLD,A,AUTO           cn=0,n=1
        18 001471   000025 000001 19                 ADSC9   21                       cn=0,n=1
        18 001472   001476 601000 18                 TNZ     s:4891
        18 001473   200333 236100                    LDQ     LARGE_EXPON,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:96   
        18 001474   777000 316003                    CANQ    -512,DU
        18 001475   001462 601000 18                 TNZ     s:4886

      626     4890
      627     4891    2       SHIFTS = LAST - COUNT;

   4891 18 001476   200417 236100                    LDQ     LAST,,AUTO
        18 001477   200420 136100                    SBLQ    COUNT,,AUTO
        18 001500   200431 756100                    STQ     SHIFTS,,AUTO

      628     4892
      629     4893    3       IF SHIFTS > 0 THEN DO;

   4893 18 001501   001513 600000 18                 TZE     s:4901

      630     4894
      631     4895    3         TEMP_ARG = ZEROES;

   4895 18 001502   040100 100400                    MLR     fill='040'O
        18 001503   000000 000037 17                 ADSC9   ZEROES                   cn=0,n=31
        18 001504   200252 000132                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=90

      632     4896    3         CALL INSERT( TEMP_ARG, SHIFTS, 25, SUBSTR( REC_FLD, 1 ) );

   4896 18 001505   040106 100500                    MLR     fill='040'O
        18 001506   200363 200031                    ADSC9   REC_FLD,,AUTO            cn=1,n=25
        18 001507   200252 000031                    ADSC9   TEMP_ARG,Q,AUTO          cn=0,n=25

      633     4897    3         CALL INSERT( REC_FLD, 1, 26, TEMP_ARG );

   4897 18 001510   040100 100500                    MLR     fill='040'O
        18 001511   200252 000032                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=26
        18 001512   200363 200032                    ADSC9   REC_FLD,,AUTO            cn=1,n=26

      634     4898
      635     4899    3       END;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:97   
      636     4900
      637     4901    2       CALL BINXCHAR(CHR_EXP,LARGE_EXPON.EXPONENT.EXP);

   4901 18 001513   000100 301500                    BTD
        18 001514   200333 000001                    NDSC9   LARGE_EXPON,,AUTO        cn=0,s=lsgnf,sf=0,n=1
        18 001515   200331 010004                    NDSC9   CHR_EXP,,AUTO            cn=0,s=lsgns,sf=0,n=4

      638     4902    2       CALL CONCAT(RESULT_ARG,SUBSTR(REC_FLD,0,I-6),

   4902 18 001516   200102 720100                    LXL0    I,,AUTO
        18 001517   777772 621010                    EAX1    -6,X0
        18 001520   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 001521   200102 722100                    LXL2    I,,AUTO
        18 001522   040140 100540                    MLR     fill='040'O
        18 001523   200363 000011                    ADSC9   REC_FLD,,AUTO            cn=0,n=*X1
        18 001524   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        18 001525   200102 236100                    LDQ     I,,AUTO
        18 001526   200102 136100                    SBLQ    I,,AUTO
        18 001527   000027 116000 19                 CMPQ    23
        18 001530   001545 604400 18                 TMOZ    s:4904
        18 001531   000006 620006                    EAX0    6,QL
        18 001532   200102 235100                    LDA     I,,AUTO
        18 001533   040145 100400                    MLR     fill='040'O
        18 001534   000011 000002 17                 ADSC9   ZEROES+9                 cn=0,n=2
        18 001535   077776 400010                    ADSC9   -2,A,PR0                 cn=2,n=*X0
        18 001536   000030 116000 19                 CMPQ    24
        18 001537   001545 604400 18                 TMOZ    s:4904
        18 001540   000004 620006                    EAX0    4,QL
        18 001541   200102 235100                    LDA     I,,AUTO
        18 001542   040145 100500                    MLR     fill='040'O
        18 001543   200331 000004                    ADSC9   CHR_EXP,,AUTO            cn=0,n=4
        18 001544   077777 000010                    ADSC9   -1,A,PR0                 cn=0,n=*X0

      639     4903    2                   ' E',CHR_EXP);
      640     4904    2   END DISPLAY_FLOATING_POINT; /* proc */

   4904 18 001545   200416 221300                    LDX1  ! @STRING+1,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:98   
        18 001546   000001 702211                    TSX2  ! 1,X1

      641     4905        %EJECT ;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:99   
      642     4906        /*-----------------*/
      643     4907    1     DISPLAY_OVERPUNCH:          PROC;

   4907 18 001547   200416 741300       DISPLAY_OVE* STX1  ! @STRING+1,,AUTO

      644     4908        /*-----------------*/
      645     4909
      646     4910        /*I*
      647     4911             NAME:  DISPLAY_OVERPUNCH
      648     4912
      649     4913             PURPOSE: To convert an overpunch number into its display format
      650     4914                      and store it into the temporary argument buffer.
      651     4915        */
      652     4916
      653     4917
      654     4918
      655     4919    2        IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_LEAD_OPUNCH_SIGN THEN

   4919 18 001550   200004 470500                    LDP0    @DESC,,AUTO
        18 001551   200100 720100                    LXL0    L,,AUTO
        18 001552   000001 222110                    LDX2    1,X0,PR0
        18 001553   000054 102003                    CMPX2   44,DU
        18 001554   001562 601000 18                 TNZ     s:4922

      656     4920    2          OVRCHR = SUBSTR (RESULT_ARG, 0, 1);  /* leading sign overpunch */

   4920 18 001555   200330 471500                    LDP1    RESULT_ARG$,,AUTO
        18 001556   040000 100500                    MLR     fill='040'O
        18 001557   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        18 001560   000000 000001 3                  ADSC9   OVRCHR                   cn=0,n=1
        18 001561   001567 710000 18                 TRA     s:4925

      657     4921    2        ELSE
      658     4922    2          OVRCHR = SUBSTR (RESULT_ARG, I-1, 1); /* trailing sign overpunch */

   4922 18 001562   200330 471500                    LDP1    RESULT_ARG$,,AUTO
        18 001563   200102 235100                    LDA     I,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:100  
        18 001564   040000 100505                    MLR     fill='040'O
        18 001565   177777 600001                    ADSC9   -1,A,PR1                 cn=3,n=1
        18 001566   000000 000001 3                  ADSC9   OVRCHR                   cn=0,n=1

      659     4923
      660     4924             %REMOVE_OVP( @OVRCHR = OVRCHR );  /* returns sign in OVP_SIGN */

   4925 18 001567   000000 236000 3                  LDQ     OVRCHR
        18 001570   777000 376003                    ANQ     -512,DU
        18 001571   143000 116003                    CMPQ    50688,DU
        18 001572   001754 602000 18                 TNC     s:4925+117
        18 001573   000000 236000 3                  LDQ     OVRCHR
        18 001574   777000 376003                    ANQ     -512,DU
        18 001575   143000 116003                    CMPQ    50688,DU
        18 001576   002232 600000 18                 TZE     s:4941
        18 001577   000000 236000 3                  LDQ     OVRCHR
        18 001600   777000 376003                    ANQ     -512,DU
        18 001601   153000 116003                    CMPQ    54784,DU
        18 001602   001700 602000 18                 TNC     s:4925+73
        18 001603   000000 236000 3                  LDQ     OVRCHR
        18 001604   777000 376003                    ANQ     -512,DU
        18 001605   153000 116003                    CMPQ    54784,DU
        18 001606   002254 600000 18                 TZE     s:4948
        18 001607   000000 236000 3                  LDQ     OVRCHR
        18 001610   777000 376003                    ANQ     -512,DU
        18 001611   157000 116003                    CMPQ    56832,DU
        18 001612   001656 602000 18                 TNC     s:4925+55
        18 001613   000000 236000 3                  LDQ     OVRCHR
        18 001614   777000 376003                    ANQ     -512,DU
        18 001615   157000 116003                    CMPQ    56832,DU
        18 001616   002254 600000 18                 TZE     s:4948
        18 001617   000000 236000 3                  LDQ     OVRCHR
        18 001620   777000 376003                    ANQ     -512,DU
        18 001621   161000 116003                    CMPQ    57856,DU
        18 001622   001651 602000 18                 TNC     s:4925+50
        18 001623   000000 236000 3                  LDQ     OVRCHR
        18 001624   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:101  
        18 001625   161000 116003                    CMPQ    57856,DU
        18 001626   002254 600000 18                 TZE     s:4948
        18 001627   000000 236000 3                  LDQ     OVRCHR
        18 001630   777000 376003                    ANQ     -512,DU
        18 001631   173000 116003                    CMPQ    62976,DU
        18 001632   001644 602000 18                 TNC     s:4925+45
        18 001633   000000 236000 3                  LDQ     OVRCHR
        18 001634   777000 376003                    ANQ     -512,DU
        18 001635   173000 116003                    CMPQ    62976,DU
        18 001636   002265 600000 18                 TZE     s:4951
        18 001637   000000 236000 3                  LDQ     OVRCHR
        18 001640   777000 376003                    ANQ     -512,DU
        18 001641   175000 116003                    CMPQ    64000,DU
        18 001642   002277 601000 18                 TNZ     s:4957
        18 001643   002272 710000 18                 TRA     s:4954
        18 001644   000000 236000 3                  LDQ     OVRCHR
        18 001645   777000 376003                    ANQ     -512,DU
        18 001646   162000 116003                    CMPQ    58368,DU
        18 001647   002277 601000 18                 TNZ     s:4957
        18 001650   002254 710000 18                 TRA     s:4948
        18 001651   000000 236000 3                  LDQ     OVRCHR
        18 001652   777000 376003                    ANQ     -512,DU
        18 001653   160000 116003                    CMPQ    57344,DU
        18 001654   002277 601000 18                 TNZ     s:4957
        18 001655   002254 710000 18                 TRA     s:4948
        18 001656   000000 236000 3                  LDQ     OVRCHR
        18 001657   777000 376003                    ANQ     -512,DU
        18 001660   155000 116003                    CMPQ    55808,DU
        18 001661   001673 602000 18                 TNC     s:4925+68
        18 001662   000000 236000 3                  LDQ     OVRCHR
        18 001663   777000 376003                    ANQ     -512,DU
        18 001664   155000 116003                    CMPQ    55808,DU
        18 001665   002254 600000 18                 TZE     s:4948
        18 001666   000000 236000 3                  LDQ     OVRCHR
        18 001667   777000 376003                    ANQ     -512,DU
        18 001670   156000 116003                    CMPQ    56320,DU
        18 001671   002277 601000 18                 TNZ     s:4957
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:102  
        18 001672   002254 710000 18                 TRA     s:4948
        18 001673   000000 236000 3                  LDQ     OVRCHR
        18 001674   777000 376003                    ANQ     -512,DU
        18 001675   154000 116003                    CMPQ    55296,DU
        18 001676   002277 601000 18                 TNZ     s:4957
        18 001677   002254 710000 18                 TRA     s:4948
        18 001700   000000 236000 3                  LDQ     OVRCHR
        18 001701   777000 376003                    ANQ     -512,DU
        18 001702   147000 116003                    CMPQ    52736,DU
        18 001703   001732 602000 18                 TNC     s:4925+99
        18 001704   000000 236000 3                  LDQ     OVRCHR
        18 001705   777000 376003                    ANQ     -512,DU
        18 001706   147000 116003                    CMPQ    52736,DU
        18 001707   002232 600000 18                 TZE     s:4941
        18 001710   000000 236000 3                  LDQ     OVRCHR
        18 001711   777000 376003                    ANQ     -512,DU
        18 001712   151000 116003                    CMPQ    53760,DU
        18 001713   001725 602000 18                 TNC     s:4925+94
        18 001714   000000 236000 3                  LDQ     OVRCHR
        18 001715   777000 376003                    ANQ     -512,DU
        18 001716   151000 116003                    CMPQ    53760,DU
        18 001717   002232 600000 18                 TZE     s:4941
        18 001720   000000 236000 3                  LDQ     OVRCHR
        18 001721   777000 376003                    ANQ     -512,DU
        18 001722   152000 116003                    CMPQ    54272,DU
        18 001723   002277 601000 18                 TNZ     s:4957
        18 001724   002254 710000 18                 TRA     s:4948
        18 001725   000000 236000 3                  LDQ     OVRCHR
        18 001726   777000 376003                    ANQ     -512,DU
        18 001727   150000 116003                    CMPQ    53248,DU
        18 001730   002277 601000 18                 TNZ     s:4957
        18 001731   002232 710000 18                 TRA     s:4941
        18 001732   000000 236000 3                  LDQ     OVRCHR
        18 001733   777000 376003                    ANQ     -512,DU
        18 001734   145000 116003                    CMPQ    51712,DU
        18 001735   001747 602000 18                 TNC     s:4925+112
        18 001736   000000 236000 3                  LDQ     OVRCHR
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:103  
        18 001737   777000 376003                    ANQ     -512,DU
        18 001740   145000 116003                    CMPQ    51712,DU
        18 001741   002232 600000 18                 TZE     s:4941
        18 001742   000000 236000 3                  LDQ     OVRCHR
        18 001743   777000 376003                    ANQ     -512,DU
        18 001744   146000 116003                    CMPQ    52224,DU
        18 001745   002277 601000 18                 TNZ     s:4957
        18 001746   002232 710000 18                 TRA     s:4941
        18 001747   000000 236000 3                  LDQ     OVRCHR
        18 001750   777000 376003                    ANQ     -512,DU
        18 001751   144000 116003                    CMPQ    51200,DU
        18 001752   002277 601000 18                 TNZ     s:4957
        18 001753   002232 710000 18                 TRA     s:4941
        18 001754   000000 236000 3                  LDQ     OVRCHR
        18 001755   777000 376003                    ANQ     -512,DU
        18 001756   113000 116003                    CMPQ    38400,DU
        18 001757   002072 602000 18                 TNC     s:4925+195
        18 001760   000000 236000 3                  LDQ     OVRCHR
        18 001761   777000 376003                    ANQ     -512,DU
        18 001762   113000 116003                    CMPQ    38400,DU
        18 001763   002243 600000 18                 TZE     s:4945
        18 001764   000000 236000 3                  LDQ     OVRCHR
        18 001765   777000 376003                    ANQ     -512,DU
        18 001766   121000 116003                    CMPQ    41472,DU
        18 001767   002026 602000 18                 TNC     s:4925+159
        18 001770   000000 236000 3                  LDQ     OVRCHR
        18 001771   777000 376003                    ANQ     -512,DU
        18 001772   121000 116003                    CMPQ    41472,DU
        18 001773   002243 600000 18                 TZE     s:4945
        18 001774   000000 236000 3                  LDQ     OVRCHR
        18 001775   777000 376003                    ANQ     -512,DU
        18 001776   141000 116003                    CMPQ    49664,DU
        18 001777   002011 602000 18                 TNC     s:4925+146
        18 002000   000000 236000 3                  LDQ     OVRCHR
        18 002001   777000 376003                    ANQ     -512,DU
        18 002002   141000 116003                    CMPQ    49664,DU
        18 002003   002232 600000 18                 TZE     s:4941
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:104  
        18 002004   000000 236000 3                  LDQ     OVRCHR
        18 002005   777000 376003                    ANQ     -512,DU
        18 002006   142000 116003                    CMPQ    50176,DU
        18 002007   002277 601000 18                 TNZ     s:4957
        18 002010   002232 710000 18                 TRA     s:4941
        18 002011   000000 236000 3                  LDQ     OVRCHR
        18 002012   777000 376003                    ANQ     -512,DU
        18 002013   122000 116003                    CMPQ    41984,DU
        18 002014   002277 602000 18                 TNC     s:4957
        18 002015   000000 236000 3                  LDQ     OVRCHR
        18 002016   777000 376003                    ANQ     -512,DU
        18 002017   122000 116003                    CMPQ    41984,DU
        18 002020   002243 600000 18                 TZE     s:4945
        18 002021   000000 236000 3                  LDQ     OVRCHR
        18 002022   777000 376003                    ANQ     -512,DU
        18 002023   136000 116003                    CMPQ    48128,DU
        18 002024   002277 601000 18                 TNZ     s:4957
        18 002025   002272 710000 18                 TRA     s:4954
        18 002026   000000 236000 3                  LDQ     OVRCHR
        18 002027   777000 376003                    ANQ     -512,DU
        18 002030   116000 116003                    CMPQ    39936,DU
        18 002031   002054 602000 18                 TNC     s:4925+181
        18 002032   000000 236000 3                  LDQ     OVRCHR
        18 002033   777000 376003                    ANQ     -512,DU
        18 002034   116000 116003                    CMPQ    39936,DU
        18 002035   002243 600000 18                 TZE     s:4945
        18 002036   000000 236000 3                  LDQ     OVRCHR
        18 002037   777000 376003                    ANQ     -512,DU
        18 002040   120000 116003                    CMPQ    40960,DU
        18 002041   002047 602000 18                 TNC     s:4925+176
        18 002042   000000 236000 3                  LDQ     OVRCHR
        18 002043   777000 376003                    ANQ     -512,DU
        18 002044   120000 116003                    CMPQ    40960,DU
        18 002045   002243 600000 18                 TZE     s:4945
        18 002046   002277 710000 18                 TRA     s:4957
        18 002047   000000 236000 3                  LDQ     OVRCHR
        18 002050   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:105  
        18 002051   117000 116003                    CMPQ    40448,DU
        18 002052   002277 601000 18                 TNZ     s:4957
        18 002053   002243 710000 18                 TRA     s:4945
        18 002054   000000 236000 3                  LDQ     OVRCHR
        18 002055   777000 376003                    ANQ     -512,DU
        18 002056   115000 116003                    CMPQ    39424,DU
        18 002057   002065 602000 18                 TNC     s:4925+190
        18 002060   000000 236000 3                  LDQ     OVRCHR
        18 002061   777000 376003                    ANQ     -512,DU
        18 002062   115000 116003                    CMPQ    39424,DU
        18 002063   002243 600000 18                 TZE     s:4945
        18 002064   002277 710000 18                 TRA     s:4957
        18 002065   000000 236000 3                  LDQ     OVRCHR
        18 002066   777000 376003                    ANQ     -512,DU
        18 002067   114000 116003                    CMPQ    38912,DU
        18 002070   002277 601000 18                 TNZ     s:4957
        18 002071   002243 710000 18                 TRA     s:4945
        18 002072   000000 236000 3                  LDQ     OVRCHR
        18 002073   777000 376003                    ANQ     -512,DU
        18 002074   104000 116003                    CMPQ    34816,DU
        18 002075   002152 602000 18                 TNC     s:4925+243
        18 002076   000000 236000 3                  LDQ     OVRCHR
        18 002077   777000 376003                    ANQ     -512,DU
        18 002100   104000 116003                    CMPQ    34816,DU
        18 002101   002221 600000 18                 TZE     s:4938
        18 002102   000000 236000 3                  LDQ     OVRCHR
        18 002103   777000 376003                    ANQ     -512,DU
        18 002104   110000 116003                    CMPQ    36864,DU
        18 002105   002130 602000 18                 TNC     s:4925+225
        18 002106   000000 236000 3                  LDQ     OVRCHR
        18 002107   777000 376003                    ANQ     -512,DU
        18 002110   110000 116003                    CMPQ    36864,DU
        18 002111   002221 600000 18                 TZE     s:4938
        18 002112   000000 236000 3                  LDQ     OVRCHR
        18 002113   777000 376003                    ANQ     -512,DU
        18 002114   112000 116003                    CMPQ    37888,DU
        18 002115   002123 602000 18                 TNC     s:4925+220
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:106  
        18 002116   000000 236000 3                  LDQ     OVRCHR
        18 002117   777000 376003                    ANQ     -512,DU
        18 002120   112000 116003                    CMPQ    37888,DU
        18 002121   002243 600000 18                 TZE     s:4945
        18 002122   002277 710000 18                 TRA     s:4957
        18 002123   000000 236000 3                  LDQ     OVRCHR
        18 002124   777000 376003                    ANQ     -512,DU
        18 002125   111000 116003                    CMPQ    37376,DU
        18 002126   002277 601000 18                 TNZ     s:4957
        18 002127   002221 710000 18                 TRA     s:4938
        18 002130   000000 236000 3                  LDQ     OVRCHR
        18 002131   777000 376003                    ANQ     -512,DU
        18 002132   106000 116003                    CMPQ    35840,DU
        18 002133   002145 602000 18                 TNC     s:4925+238
        18 002134   000000 236000 3                  LDQ     OVRCHR
        18 002135   777000 376003                    ANQ     -512,DU
        18 002136   106000 116003                    CMPQ    35840,DU
        18 002137   002221 600000 18                 TZE     s:4938
        18 002140   000000 236000 3                  LDQ     OVRCHR
        18 002141   777000 376003                    ANQ     -512,DU
        18 002142   107000 116003                    CMPQ    36352,DU
        18 002143   002277 601000 18                 TNZ     s:4957
        18 002144   002221 710000 18                 TRA     s:4938
        18 002145   000000 236000 3                  LDQ     OVRCHR
        18 002146   777000 376003                    ANQ     -512,DU
        18 002147   105000 116003                    CMPQ    35328,DU
        18 002150   002277 601000 18                 TNZ     s:4957
        18 002151   002221 710000 18                 TRA     s:4938
        18 002152   000000 236000 3                  LDQ     OVRCHR
        18 002153   777000 376003                    ANQ     -512,DU
        18 002154   101000 116003                    CMPQ    33280,DU
        18 002155   002177 602000 18                 TNC     s:4925+264
        18 002156   000000 236000 3                  LDQ     OVRCHR
        18 002157   777000 376003                    ANQ     -512,DU
        18 002160   101000 116003                    CMPQ    33280,DU
        18 002161   002221 600000 18                 TZE     s:4938
        18 002162   000000 236000 3                  LDQ     OVRCHR
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:107  
        18 002163   777000 376003                    ANQ     -512,DU
        18 002164   102000 116003                    CMPQ    33792,DU
        18 002165   002277 602000 18                 TNC     s:4957
        18 002166   000000 236000 3                  LDQ     OVRCHR
        18 002167   777000 376003                    ANQ     -512,DU
        18 002170   102000 116003                    CMPQ    33792,DU
        18 002171   002221 600000 18                 TZE     s:4938
        18 002172   000000 236000 3                  LDQ     OVRCHR
        18 002173   777000 376003                    ANQ     -512,DU
        18 002174   103000 116003                    CMPQ    34304,DU
        18 002175   002277 601000 18                 TNZ     s:4957
        18 002176   002221 710000 18                 TRA     s:4938
        18 002177   000000 236000 3                  LDQ     OVRCHR
        18 002200   777000 376003                    ANQ     -512,DU
        18 002201   053000 116003                    CMPQ    22016,DU
        18 002202   002214 602000 18                 TNC     s:4925+277
        18 002203   000000 236000 3                  LDQ     OVRCHR
        18 002204   777000 376003                    ANQ     -512,DU
        18 002205   053000 116003                    CMPQ    22016,DU
        18 002206   002265 600000 18                 TZE     s:4951
        18 002207   000000 236000 3                  LDQ     OVRCHR
        18 002210   777000 376003                    ANQ     -512,DU
        18 002211   055000 116003                    CMPQ    23040,DU
        18 002212   002277 601000 18                 TNZ     s:4957
        18 002213   002272 710000 18                 TRA     s:4954
        18 002214   000000 236000 3                  LDQ     OVRCHR
        18 002215   777000 376003                    ANQ     -512,DU
        18 002216   040000 116003                    CMPQ    16384,DU
        18 002217   002277 601000 18                 TNZ     s:4957
        18 002220   002265 710000 18                 TRA     s:4951

   4938 18 002221   000000 236000 3                  LDQ     OVRCHR
        18 002222   000033 772000                    QRL     27
        18 002223   000020 136007                    SBLQ    16,DL
        18 002224   000033 736000                    QLS     27
        18 002225   000031 276000 19                 ORQ     25
        18 002226   200341 756100                    STQ     OVPNUM,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:108  

   4939 18 002227   053000 236003                    LDQ     22016,DU
        18 002230   200337 756100                    STQ     OVP_SIGN,,AUTO
        18 002231   002302 710000 18                 TRA     s:4967

   4941 18 002232   000000 236000 3                  LDQ     OVRCHR
        18 002233   000033 772000                    QRL     27
        18 002234   000060 136007                    SBLQ    48,DL
        18 002235   000033 736000                    QLS     27
        18 002236   000031 276000 19                 ORQ     25
        18 002237   200341 756100                    STQ     OVPNUM,,AUTO

   4942 18 002240   053000 236003                    LDQ     22016,DU
        18 002241   200337 756100                    STQ     OVP_SIGN,,AUTO
        18 002242   002302 710000 18                 TRA     s:4967

   4945 18 002243   000000 236000 3                  LDQ     OVRCHR
        18 002244   000033 772000                    QRL     27
        18 002245   000031 136007                    SBLQ    25,DL
        18 002246   000033 736000                    QLS     27
        18 002247   000031 276000 19                 ORQ     25
        18 002250   200341 756100                    STQ     OVPNUM,,AUTO

   4946 18 002251   055000 236003                    LDQ     23040,DU
        18 002252   200337 756100                    STQ     OVP_SIGN,,AUTO
        18 002253   002302 710000 18                 TRA     s:4967

   4948 18 002254   000000 236000 3                  LDQ     OVRCHR
        18 002255   000033 772000                    QRL     27
        18 002256   000071 136007                    SBLQ    57,DL
        18 002257   000033 736000                    QLS     27
        18 002260   000031 276000 19                 ORQ     25
        18 002261   200341 756100                    STQ     OVPNUM,,AUTO

   4949 18 002262   055000 236003                    LDQ     23040,DU
        18 002263   200337 756100                    STQ     OVP_SIGN,,AUTO
        18 002264   002302 710000 18                 TRA     s:4967
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:109  

   4951 18 002265   060000 236003                    LDQ     24576,DU
        18 002266   200341 756100                    STQ     OVPNUM,,AUTO

   4952 18 002267   053000 236003                    LDQ     22016,DU
        18 002270   200337 756100                    STQ     OVP_SIGN,,AUTO
        18 002271   002302 710000 18                 TRA     s:4967

   4954 18 002272   060000 236003                    LDQ     24576,DU
        18 002273   200341 756100                    STQ     OVPNUM,,AUTO

   4955 18 002274   055000 236003                    LDQ     23040,DU
        18 002275   200337 756100                    STQ     OVP_SIGN,,AUTO
        18 002276   002302 710000 18                 TRA     s:4967

   4957 18 002277   040000 236003                    LDQ     16384,DU
        18 002300   200341 756100                    STQ     OVPNUM,,AUTO

   4958 18 002301   200337 756100                    STQ     OVP_SIGN,,AUTO

      661     4966
      662     4967    2        IF OVP_SIGN  ~=   ' ' THEN

   4967 18 002302   200337 236100                    LDQ     OVP_SIGN,,AUTO
        18 002303   777000 376003                    ANQ     -512,DU
        18 002304   040000 116003                    CMPQ    16384,DU
        18 002305   002356 600000 18                 TZE     s:4979

      663     4968    3          DO;

      664     4969    3            I = I + 1;

   4969 18 002306   200102 054100                    AOS     I,,AUTO

      665     4970    3            ITEMP = ITEMP + 1;

   4970 18 002307   200103 054100                    AOS     ITEMP,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:110  

      666     4971
      667     4972    3            IF DESC.D_WORD.DES_W.TYPE(L) = %UNPACK_FIXED_TRAIL_OPUNCH_SIGN THEN

   4972 18 002310   000001 222110                    LDX2    1,X0,PR0
        18 002311   000055 102003                    CMPX2   45,DU
        18 002312   002335 601000 18                 TNZ     s:4975

      668     4973    3              CALL CONCAT (TEMP_ARG, OVP_SIGN, SUBSTR (RESULT_ARG, 0, I-2), OVPNUM);

   4973 18 002313   200337 236100                    LDQ     OVP_SIGN,,AUTO
        18 002314   777000 376003                    ANQ     -512,DU
        18 002315   000031 276000 19                 ORQ     25
        18 002316   200252 756100                    STQ     TEMP_ARG,,AUTO
        18 002317   200102 723100                    LXL3    I,,AUTO
        18 002320   777776 624013                    EAX4    -2,X3
        18 002321   040100 100540                    MLR     fill='040'O
        18 002322   100000 000014                    ADSC9   0,,PR1                   cn=0,n=*X4
        18 002323   200252 200131                    ADSC9   TEMP_ARG,,AUTO           cn=1,n=89
        18 002324   200102 236100                    LDQ     I,,AUTO
        18 002325   000133 116007                    CMPQ    91,DL
        18 002326   002334 605000 18                 TPL     s:4973+17
        18 002327   777644 625006                    EAX5    -92,QL
        18 002330   777777 665003                    ERX5    -1,DU
        18 002331   040146 100500                    MLR     fill='040'O
        18 002332   200341 000001                    ADSC9   OVPNUM,,AUTO             cn=0,n=1
        18 002333   200251 600015                    ADSC9   DISPLAY_STRING+98,Q,AUTO cn=3,n=*X5
        18 002334   002351 710000 18                 TRA     s:4976

      669     4974    3            ELSE
      670     4975    3              CALL CONCAT (TEMP_ARG, OVP_SIGN, OVPNUM, SUBSTR (RESULT_ARG, 1, I-2));

   4975 18 002335   200337 236100                    LDQ     OVP_SIGN,,AUTO
        18 002336   777000 376003                    ANQ     -512,DU
        18 002337   000031 276000 19                 ORQ     25
        18 002340   200252 756100                    STQ     TEMP_ARG,,AUTO
        18 002341   200341 236100                    LDQ     OVPNUM,,AUTO
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:111  
        18 002342   000011 772000                    QRL     9
        18 002343   200252 552120                    STBQ    TEMP_ARG,'20'O,AUTO
        18 002344   200102 723100                    LXL3    I,,AUTO
        18 002345   777776 624013                    EAX4    -2,X3
        18 002346   040100 100540                    MLR     fill='040'O
        18 002347   100000 200014                    ADSC9   0,,PR1                   cn=1,n=*X4
        18 002350   200252 400130                    ADSC9   TEMP_ARG,,AUTO           cn=2,n=88

      671     4976    3            RESULT_ARG = TEMP_ARG;

   4976 18 002351   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 002352   200102 720100                    LXL0    I,,AUTO
        18 002353   040140 100500                    MLR     fill='040'O
        18 002354   200252 000132                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=90
        18 002355   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      672     4977    3          END;

      673     4978
      674     4979    2     END DISPLAY_OVERPUNCH; /* proc */

   4979 18 002356   200416 221300                    LDX1  ! @STRING+1,,AUTO
        18 002357   000001 702211                    TSX2  ! 1,X1

      675     4980        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:112  
      676     4981        /*---------------------*/
      677     4982    1     DISPLAY_TRAILING_SIGN:      PROC;

   4982 18 002360   200416 741300       DISPLAY_TRA* STX1  ! @STRING+1,,AUTO

      678     4983        /*---------------------*/
      679     4984
      680     4985        /*I*
      681     4986             NAME:  DISPLAY_TRAILING_SIGN
      682     4987
      683     4988             PURPOSE: To convert trailing sign numbers to their display
      684     4989                      format and store into temporary argument buffer.
      685     4990        */
      686     4991
      687     4992    2       OVP_SIGN = SUBSTR (RESULT_ARG, I-1, 1);

   4992 18 002361   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 002362   200102 235100                    LDA     I,,AUTO
        18 002363   040100 100505                    MLR     fill='040'O
        18 002364   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
        18 002365   200337 000001                    ADSC9   OVP_SIGN,,AUTO           cn=0,n=1

      688     4993
      689     4994    2       IF OVP_SIGN = '+'

   4994 18 002366   200337 236100                    LDQ     OVP_SIGN,,AUTO
        18 002367   777000 376003                    ANQ     -512,DU
        18 002370   053000 116003                    CMPQ    22016,DU
        18 002371   002376 600000 18                 TZE     s:4997
        18 002372   200337 236100                    LDQ     OVP_SIGN,,AUTO
        18 002373   777000 376003                    ANQ     -512,DU
        18 002374   055000 116003                    CMPQ    23040,DU
        18 002375   002413 601000 18                 TNZ     s:5001

      690     4995    2       OR OVP_SIGN = '-' THEN
      691     4996    3         DO;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:113  
      692     4997    3           CALL CONCAT (TEMP_ARG, OVP_SIGN, SUBSTR (RESULT_ARG, 0, I-1));

   4997 18 002376   200337 236100                    LDQ     OVP_SIGN,,AUTO
        18 002377   777000 376003                    ANQ     -512,DU
        18 002400   000031 276000 19                 ORQ     25
        18 002401   200252 756100                    STQ     TEMP_ARG,,AUTO
        18 002402   777777 620005                    EAX0    -1,AL
        18 002403   040100 100540                    MLR     fill='040'O
        18 002404   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        18 002405   200252 200131                    ADSC9   TEMP_ARG,,AUTO           cn=1,n=89

      693     4998    3           RESULT_ARG = TEMP_ARG;

   4998 18 002406   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 002407   200102 720100                    LXL0    I,,AUTO
        18 002410   040140 100500                    MLR     fill='040'O
        18 002411   200252 000132                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=90
        18 002412   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      694     4999    3         END;

      695     5000
      696     5001    2     END DISPLAY_TRAILING_SIGN; /* proc */

   5001 18 002413   200416 221300                    LDX1  ! @STRING+1,,AUTO
        18 002414   000001 702211                    TSX2  ! 1,X1

      697     5002        %EJECT ;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:114  
      698     5003        /*-------------------*/
      699     5004    1     ADJUST_FOR_LARGE_SF:        PROC;

   5004 18 002415   200416 741300       ADJUST_FOR_* STX1  ! @STRING+1,,AUTO

      700     5005        /*-------------------*/
      701     5006
      702     5007        /*I*
      703     5008             NAME:  ADJUST_FOR_LARGE_SF
      704     5009
      705     5010             PURPOSE:  To adjust the argument for a large scale factor --
      706     5011                       scale factor * -1 > length.  The scale factor - length
      707     5012                       is the number of zeros to the right of the radix point.
      708     5013        */
      709     5014
      710     5015    2       IF SUBSTR (RESULT_ARG,0,1) = '+'

   5015 18 002416   200330 470500                    LDP0    RESULT_ARG$,,AUTO
        18 002417   040000 106500                    CMPC    fill='040'O
        18 002420   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        18 002421   000032 000001 19                 ADSC9   26                       cn=0,n=1
        18 002422   002427 600000 18                 TZE     s:5017
        18 002423   040000 106500                    CMPC    fill='040'O
        18 002424   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        18 002425   000033 000001 19                 ADSC9   27                       cn=0,n=1
        18 002426   002433 601000 18                 TNZ     s:5019

      711     5016    2       OR SUBSTR (RESULT_ARG,0,1) = '-' THEN
      712     5017    2         SIGN = SUBSTR (RESULT_ARG,0,1);

   5017 18 002427   040100 100500                    MLR     fill='040'O
        18 002430   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        18 002431   200340 000001                    ADSC9   SIGN,,AUTO               cn=0,n=1
        18 002432   002435 710000 18                 TRA     s:5021

      713     5018    2       ELSE
      714     5019    2         SIGN = ' ';
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:115  

   5019 18 002433   040000 236003                    LDQ     16384,DU
        18 002434   200340 756100                    STQ     SIGN,,AUTO

      715     5020
      716     5021    2       J = (DESC.D_WORD.DES_W.NDSC.SF(L) * -1) - DESC.D_WORD.DES_W.NDSC.N(L);

   5021 18 002435   200004 471500                    LDP1    @DESC,,AUTO
        18 002436   200100 720100                    LXL0    L,,AUTO
        18 002437   100001 236110                    LDQ     1,X0,PR1
        18 002440   000077 376007                    ANQ     63,DL
        18 002441   200432 756100                    STQ     SHIFTS+1,,AUTO
        18 002442   100001 236110                    LDQ     1,X0,PR1
        18 002443   000030 736000                    QLS     24
        18 002444   000036 732000                    QRS     30
        18 002445   200432 036100                    ADLQ    SHIFTS+1,,AUTO
        18 002446   000024 676000 19                 ERQ     20
        18 002447   000001 036007                    ADLQ    1,DL
        18 002450   200101 756100                    STQ     J,,AUTO

      717     5022    2       I = I + J + 1;

   5022 18 002451   200102 036100                    ADLQ    I,,AUTO
        18 002452   000001 036007                    ADLQ    1,DL
        18 002453   200102 756100                    STQ     I,,AUTO

      718     5023
      719     5024    2         IF SIGN = ' ' THEN    /* add zeros to the front */

   5024 18 002454   200340 236100                    LDQ     SIGN,,AUTO
        18 002455   777000 376003                    ANQ     -512,DU
        18 002456   040000 116003                    CMPQ    16384,DU
        18 002457   002506 601000 18                 TNZ     s:5032

      720     5025    3           DO;

      721     5026    3             CALL CONCAT (TEMP_ARG, DEC_OR_COMMA, SUBSTR (ZEROES, 0, J),
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:116  

   5026 18 002460   000000 236000 1                  LDQ     DEC_OR_COMMA
        18 002461   777000 376003                    ANQ     -512,DU
        18 002462   000031 276000 19                 ORQ     25
        18 002463   200252 756100                    STQ     TEMP_ARG,,AUTO
        18 002464   200101 722100                    LXL2    J,,AUTO
        18 002465   040100 100440                    MLR     fill='040'O
        18 002466   000000 000012 17                 ADSC9   ZEROES                   cn=0,n=*X2
        18 002467   200252 200131                    ADSC9   TEMP_ARG,,AUTO           cn=1,n=89
        18 002470   200101 236100                    LDQ     J,,AUTO
        18 002471   000131 116007                    CMPQ    89,DL
        18 002472   002501 605000 18                 TPL     s:5028
        18 002473   777646 623006                    EAX3    -90,QL
        18 002474   777777 663003                    ERX3    -1,DU
        18 002475   200102 724100                    LXL4    I,,AUTO
        18 002476   040146 100540                    MLR     fill='040'O
        18 002477   000000 000014                    ADSC9   0,,PR0                   cn=0,n=*X4
        18 002500   200252 200013                    ADSC9   TEMP_ARG,Q,AUTO          cn=1,n=*X3

      722     5027    3                 RESULT_ARG);
      723     5028    3             RESULT_ARG = TEMP_ARG;

   5028 18 002501   200102 723100                    LXL3    I,,AUTO
        18 002502   040140 100500                    MLR     fill='040'O
        18 002503   200252 000132                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=90
        18 002504   000000 000013                    ADSC9   0,,PR0                   cn=0,n=*X3

      724     5029    3           END;

   5029 18 002505   002535 710000 18                 TRA     s:5037

      725     5030    2         ELSE                  /* add zeros to the front avoiding sign */
      726     5031    3           DO;

      727     5032    3             CALL CONCAT (TEMP_ARG, DEC_OR_COMMA, SUBSTR (ZEROES, 0, J),

   5032 18 002506   000000 236000 1                  LDQ     DEC_OR_COMMA
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:117  
        18 002507   777000 376003                    ANQ     -512,DU
        18 002510   000031 276000 19                 ORQ     25
        18 002511   200252 756100                    STQ     TEMP_ARG,,AUTO
        18 002512   200101 722100                    LXL2    J,,AUTO
        18 002513   040100 100440                    MLR     fill='040'O
        18 002514   000000 000012 17                 ADSC9   ZEROES                   cn=0,n=*X2
        18 002515   200252 200131                    ADSC9   TEMP_ARG,,AUTO           cn=1,n=89
        18 002516   200101 236100                    LDQ     J,,AUTO
        18 002517   000131 116007                    CMPQ    89,DL
        18 002520   002530 605000 18                 TPL     s:5034
        18 002521   200102 723100                    LXL3    I,,AUTO
        18 002522   777777 624013                    EAX4    -1,X3
        18 002523   777646 625006                    EAX5    -90,QL
        18 002524   777777 665003                    ERX5    -1,DU
        18 002525   040146 100540                    MLR     fill='040'O
        18 002526   000000 200014                    ADSC9   0,,PR0                   cn=1,n=*X4
        18 002527   200252 200015                    ADSC9   TEMP_ARG,Q,AUTO          cn=1,n=*X5

      728     5033    3                 SUBSTR (RESULT_ARG,1));
      729     5034    3             SUBSTR (RESULT_ARG, 1) = TEMP_ARG;

   5034 18 002530   200102 723100                    LXL3    I,,AUTO
        18 002531   777777 624013                    EAX4    -1,X3
        18 002532   040140 100500                    MLR     fill='040'O
        18 002533   200252 000132                    ADSC9   TEMP_ARG,,AUTO           cn=0,n=90
        18 002534   000000 200014                    ADSC9   0,,PR0                   cn=1,n=*X4

      730     5035    3           END;

      731     5036
      732     5037    2   END ADJUST_FOR_LARGE_SF; /* proc */

   5037 18 002535   200416 221300                    LDX1  ! @STRING+1,,AUTO
        18 002536   000001 702211                    TSX2  ! 1,X1

      733     5038        %EJECT ;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:118  
      734     5039        /*--------------------*/
      735     5040    1     ADJUST_FOR_MEDIUM_SF:       PROC;

   5040 18 002537   200416 741300       ADJUST_FOR_* STX1  ! @STRING+1,,AUTO

      736     5041        /*--------------------*/
      737     5042
      738     5043        /*I*
      739     5044             NAME:  ADJUST_FOR_MEDIUM_SF
      740     5045
      741     5046             PURPOSE: To adjust for a medium scale factor.  The scale factor
      742     5047                      is medium when less than zero and > length.  This
      743     5048                      causes the radix point to be placed (scale factor * -1)
      744     5049                      positions to the right of the low order digit.
      745     5050        */
      746     5051
      747     5052    2       I = I + 1;

   5052 18 002540   200102 054100                    AOS     I,,AUTO

      748     5053    2       LT = ITEMP  + DESC.D_WORD.DES_W.NDSC.SF(L);

   5053 18 002541   200004 470500                    LDP0    @DESC,,AUTO
        18 002542   200100 720100                    LXL0    L,,AUTO
        18 002543   000001 236110                    LDQ     1,X0,PR0
        18 002544   000030 736000                    QLS     24
        18 002545   000036 732000                    QRS     30
        18 002546   200103 036100                    ADLQ    ITEMP,,AUTO
        18 002547   200005 756100                    STQ     LT,,AUTO

      749     5054    2       LTHOLD = SUBSTR( RESULT_ARG,0,LT );

   5054 18 002550   200330 471500                    LDP1    RESULT_ARG$,,AUTO
        18 002551   000000 622006                    EAX2    0,QL
        18 002552   040100 100540                    MLR     fill='040'O
        18 002553   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        18 002554   200006 000101                    ADSC9   LTHOLD,,AUTO             cn=0,n=65
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:119  

      750     5055    2       RTHOLD = SUBSTR( RESULT_ARG,LT );

   5055 18 002555   200102 236100                    LDQ     I,,AUTO
        18 002556   200005 136100                    SBLQ    LT,,AUTO
        18 002557   000000 622006                    EAX2    0,QL
        18 002560   200005 235100                    LDA     LT,,AUTO
        18 002561   040100 100545                    MLR     fill='040'O
        18 002562   100000 000012                    ADSC9   0,A,PR1                  cn=0,n=*X2
        18 002563   200027 000101                    ADSC9   RTHOLD,,AUTO             cn=0,n=65

      751     5056    2       CALL INDEX (NDX,' ',RTHOLD);

   5056 18 002564   000000 124500                    SCM     mask='000'O
        18 002565   200027 000101                    ADSC9   RTHOLD,,AUTO             cn=0,n=65
        18 002566   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 002567   200050 000100                    ARG     NDX,,AUTO

      752     5057    2       CALL INDEX (NDX2,' ',LTHOLD);

   5057 18 002570   000000 124500                    SCM     mask='000'O
        18 002571   200006 000101                    ADSC9   LTHOLD,,AUTO             cn=0,n=65
        18 002572   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 002573   000000 000000 15                 ARG     NDX2

      753     5058    2       CALL CONCAT (RESULT_ARG,SUBSTR(LTHOLD,0,NDX2),DEC_OR_COMMA,

   5058 18 002574   000000 722000 15                 LXL2    NDX2
        18 002575   200102 723100                    LXL3    I,,AUTO
        18 002576   040140 100540                    MLR     fill='040'O
        18 002577   200006 000012                    ADSC9   LTHOLD,,AUTO             cn=0,n=*X2
        18 002600   100000 000013                    ADSC9   0,,PR1                   cn=0,n=*X3
        18 002601   200102 236100                    LDQ     I,,AUTO
        18 002602   000000 136000 15                 SBLQ    NDX2
        18 002603   002621 604400 18                 TMOZ    s:5061
        18 002604   000000 621006                    EAX1    0,QL
        18 002605   000000 235000 15                 LDA     NDX2
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:120  
        18 002606   040145 100400                    MLR     fill='040'O
        18 002607   000000 000001 1                  ADSC9   DEC_OR_COMMA             cn=0,n=1
        18 002610   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
        18 002611   000001 116007                    CMPQ    1,DL
        18 002612   002621 604400 18                 TMOZ    s:5061
        18 002613   777777 621006                    EAX1    -1,QL
        18 002614   200050 722100                    LXL2    NDX,,AUTO
        18 002615   000000 235000 15                 LDA     NDX2
        18 002616   040145 100540                    MLR     fill='040'O
        18 002617   200027 000012                    ADSC9   RTHOLD,,AUTO             cn=0,n=*X2
        18 002620   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1

      754     5059    2                          SUBSTR(RTHOLD,0,NDX ) );
      755     5060
      756     5061    2   END ADJUST_FOR_MEDIUM_SF; /* proc */

   5061 18 002621   200416 221300                    LDX1  ! @STRING+1,,AUTO
        18 002622   000001 702211                    TSX2  ! 1,X1

      757     5062        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:121  
      758     5063        /*-------------------*/
      759     5064    1     ADJUST_FOR_SMALL_SF:        PROC;

   5064 18 002623   200416 741300       ADJUST_FOR_* STX1  ! @STRING+1,,AUTO

      760     5065        /*-------------------*/
      761     5066
      762     5067        /*I*
      763     5068             NAME:  ADJUST_FOR_SMALL_SF
      764     5069
      765     5070             PURPOSE:  To adjust for a small scale factor (positive). Zeros are
      766     5071                       added to the end of the argument.
      767     5072        */
      768     5073
      769     5074    2      CALL INSERT (RESULT_ARG, I, DESC.D_WORD.DES_W.NDSC.SF(L), ZEROES);

   5074 18 002624   200004 470500                    LDP0    @DESC,,AUTO
        18 002625   200100 720100                    LXL0    L,,AUTO
        18 002626   000001 236110                    LDQ     1,X0,PR0
        18 002627   000030 736000                    QLS     24
        18 002630   000036 732000                    QRS     30
        18 002631   200330 471500                    LDP1    RESULT_ARG$,,AUTO
        18 002632   000000 622006                    EAX2    0,QL
        18 002633   200102 235100                    LDA     I,,AUTO
        18 002634   040145 100400                    MLR     fill='040'O
        18 002635   000000 000037 17                 ADSC9   ZEROES                   cn=0,n=31
        18 002636   100000 000012                    ADSC9   0,A,PR1                  cn=0,n=*X2

      770     5075
      771     5076    2       I = I+DESC.D_WORD.DES_W.NDSC.SF(L);

   5076 18 002637   000001 236110                    LDQ     1,X0,PR0
        18 002640   000030 736000                    QLS     24
        18 002641   000036 732000                    QRS     30
        18 002642   200102 036100                    ADLQ    I,,AUTO
        18 002643   200102 756100                    STQ     I,,AUTO

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:122  
      772     5077
      773     5078    2   END ADJUST_FOR_SMALL_SF; /* proc */

   5078 18 002644   200416 221300                    LDX1  ! @STRING+1,,AUTO
        18 002645   000001 702211                    TSX2  ! 1,X1

      774     5079        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:123  
      775     5080        /*---------------------*/
      776     5081    1     ADD_TO_DISPLAY_STRING:      PROC (STRING, SIZE_ON_DEVICE, FACTOR);

   5081 18 002646   200414 741300       ADD_TO_DISP* STX1  ! RESULT+8,,AUTO

      777     5082        /*---------------------*/
      778     5083
      779     5084        /*I*   NAME: ADD_TO_DISPLAY_STRING
      780     5085
      781     5086            PURPOSE: For Kanji or Alphanumeric strings, add a string
      782     5087                     to the Display buffer.
      783     5088
      784     5089              INPUT: STRING -- The string to add.
      785     5090                     SIZE_ON_DEVICE -- Size of string on the output device.
      786     5091                     FACTOR -- Ratio of bytes per column (2 for Kanji).
      787     5092                     LINE_LENGTH -- Length of line (132 or 72).
      788     5093
      789     5094                I/O: DISPLAY_COUNT -- # of columns used up on the device.
      790     5095                     BUFFER_COUNT --- # of bytes used up in the buffer.
      791     5096                     DISPLAY_STRING -- The record buffer.
      792     5097        */
      793     5098
      794     5099    2   DCL    STRING          CHAR (SIZE_IN_BUFFER) ;
      795     5100    2   DCL    SIZE_ON_DEVICE  UBIN WORD ;
      796     5101    2   DCL    FACTOR          SBIN WORD ; /* 1 (ascii) or 2 (kanji) */
      797     5102    2   DCL    SIZE_IN_BUFFER  UBIN WORD ; /* SIZE_ON_DEVICE * FACTOR */
      798     5103        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:124  
      799     5104    2          SIZE_IN_BUFFER = SIZE_ON_DEVICE * FACTOR ;

   5104 18 002647   200416 470500                    LDP0    @SIZE_ON_DEVICE,,AUTO
        18 002650   200417 471500                    LDP1    @FACTOR,,AUTO
        18 002651   000000 236100                    LDQ     0,,PR0
        18 002652   100000 402100                    MPY     0,,PR1
        18 002653   200420 756100                    STQ     SIZE_IN_BUFFER,,AUTO

      800     5105
      801     5106    2          IF SIZE_ON_DEVICE > LINE_LENGTH THEN

   5106 18 002654   200106 236100                    LDQ     LINE_LENGTH,,AUTO
        18 002655   000000 116100                    CMPQ    0,,PR0
        18 002656   002700 603000 18                 TRC     s:5118

      802     5107    3            DO;

      803     5108    3              IF SIZE_ON_DEVICE > %MAX_LENGTH THEN

   5108 18 002657   000000 235100                    LDA     0,,PR0
        18 002660   020000 115007                    CMPA    8192,DL
        18 002661   002671 602000 18                 TNC     s:5114

      804     5109    4                DO;

      805     5110    4                  CALL X8ER$ERROR (%LENGTH_EXCEEDED);

   5110 18 002662   000036 630400 19                 EPPR0   30
        18 002663   000034 631400 19                 EPPR1   28
        18 002664   000000 701000 xent               TSX1    X8ER$ERROR
        18 002665   000000 011000                    NOP     0

      806     5111    4                  SIZE_ON_DEVICE = %MAX_LENGTH ;

   5111 18 002666   017777 235007                    LDA     8191,DL
        18 002667   200416 470500                    LDP0    @SIZE_ON_DEVICE,,AUTO
        18 002670   000000 755100                    STA     0,,PR0
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:125  

      807     5112    4                END;

      808     5113
      809     5114    3              CALL CUTLINE (STRING, SIZE_ON_DEVICE, FACTOR) ;

   5114 18 002671   200416 237100                    LDAQ    @SIZE_ON_DEVICE,,AUTO
        18 002672   200424 757100                    STAQ    @SIZE_ON_DEVICE,,AUTO
        18 002673   200415 236100                    LDQ     @STRING,,AUTO
        18 002674   200423 756100                    STQ     @STRING,,AUTO
        18 002675   000665 701000 18                 TSX1    CUTLINE
        18 002676   000000 011000                    NOP     0

      810     5115    3            END;

   5115 18 002677   002756 710000 18                 TRA     s:5137

      811     5116    2          ELSE
      812     5117    3            DO;

      813     5118    3              IF SIZE_ON_DEVICE + DISPLAY_COUNT >= LINE_LENGTH THEN

   5118 18 002700   000000 236100                    LDQ     0,,PR0
        18 002701   200104 036100                    ADLQ    DISPLAY_COUNT,,AUTO
        18 002702   002714 604000 18                 TMI     s:5121
        18 002703   200106 116100                    CMPQ    LINE_LENGTH,,AUTO
        18 002704   002714 602000 18                 TNC     s:5121

      814     5119    3                  CALL CUTLINE (STRING, SIZE_ON_DEVICE, FACTOR) ;

   5119 18 002705   200416 237100                    LDAQ    @SIZE_ON_DEVICE,,AUTO
        18 002706   200424 757100                    STAQ    @SIZE_ON_DEVICE,,AUTO
        18 002707   200415 236100                    LDQ     @STRING,,AUTO
        18 002710   200423 756100                    STQ     @STRING,,AUTO
        18 002711   000665 701000 18                 TSX1    CUTLINE
        18 002712   000000 011000                    NOP     0
        18 002713   002756 710000 18                 TRA     s:5137
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:126  

      815     5120    3              ELSE     /* String won't fit on the rest of the line */
      816     5121    3                IF DISPLAY_COUNT = 0 THEN

   5121 18 002714   200104 235100                    LDA     DISPLAY_COUNT,,AUTO
        18 002715   002731 601000 18                 TNZ     s:5129

      817     5122    4                  DO;

      818     5123    4                    DISPLAY_STRING = STRING ;

   5123 18 002716   200415 473500                    LDP3    @STRING,,AUTO
        18 002717   200420 720100                    LXL0    SIZE_IN_BUFFER,,AUTO
        18 002720   040100 100540                    MLR     fill='040'O
        18 002721   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
        18 002722   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396

      819     5124    4                    DISPLAY_COUNT  = SIZE_ON_DEVICE ;

   5124 18 002723   000000 235100                    LDA     0,,PR0
        18 002724   200104 755100                    STA     DISPLAY_COUNT,,AUTO

      820     5125    4                    BUFFER_COUNT   = SIZE_ON_DEVICE * FACTOR ;

   5125 18 002725   000000 236100                    LDQ     0,,PR0
        18 002726   100000 402100                    MPY     0,,PR1
        18 002727   200105 756100                    STQ     BUFFER_COUNT,,AUTO

      821     5126    4                  END;

   5126 18 002730   002756 710000 18                 TRA     s:5137

      822     5127    3                ELSE
      823     5128    4                  DO;

      824     5129    4                    CALL CONCAT (DISPLAY_STRING,

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:127  
   5129 18 002731   200105 720100                    LXL0    BUFFER_COUNT,,AUTO
        18 002732   040100 100540                    MLR     fill='040'O
        18 002733   200107 000010                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=*X0
        18 002734   200107 000614                    ADSC9   DISPLAY_STRING,,AUTO     cn=0,n=396
        18 002735   200105 236100                    LDQ     BUFFER_COUNT,,AUTO
        18 002736   000614 116007                    CMPQ    396,DL
        18 002737   002747 605000 18                 TPL     s:5132
        18 002740   777163 622006                    EAX2    -397,QL
        18 002741   777777 662003                    ERX2    -1,DU
        18 002742   200415 473500                    LDP3    @STRING,,AUTO
        18 002743   200420 723100                    LXL3    SIZE_IN_BUFFER,,AUTO
        18 002744   040146 100540                    MLR     fill='040'O
        18 002745   300000 000013                    ADSC9   0,,PR3                   cn=0,n=*X3
        18 002746   200107 000012                    ADSC9   DISPLAY_STRING,Q,AUTO    cn=0,n=*X2

      825     5130    4                                 SUBSTR (DISPLAY_STRING, 0, BUFFER_COUNT),
      826     5131    4                                 STRING) ;
      827     5132    4                    DISPLAY_COUNT = DISPLAY_COUNT + SIZE_ON_DEVICE ;

   5132 18 002747   200104 236100                    LDQ     DISPLAY_COUNT,,AUTO
        18 002750   000000 036100                    ADLQ    0,,PR0
        18 002751   200104 756100                    STQ     DISPLAY_COUNT,,AUTO

      828     5133    4                    BUFFER_COUNT  = BUFFER_COUNT  + SIZE_ON_DEVICE * FACTOR;

   5133 18 002752   000000 236100                    LDQ     0,,PR0
        18 002753   100000 402100                    MPY     0,,PR1
        18 002754   200105 036100                    ADLQ    BUFFER_COUNT,,AUTO
        18 002755   200105 756100                    STQ     BUFFER_COUNT,,AUTO

      829     5134    4                  END;

      830     5135    3            END;

      831     5136
      832     5137    2     END ADD_TO_DISPLAY_STRING;

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:128  
   5137 18 002756   200414 221300                    LDX1  ! RESULT+8,,AUTO
        18 002757   000001 702211                    TSX2  ! 1,X1

      833     5138
      834     5139    1   END X8DS$DISPLAY_SYSOUT;  /* PROC */

   5139 18 002760   000000 702200 xent               TSX2  ! X66_ARET
      835     5140        %EJECT;
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:129  

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:130  
--  Include file information  --

   B$OBJECT_C.:LIB_E04  is referenced.
   X9A_TYPES.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_MACROS.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X8DS$DISPLAY_SYSOUT.
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:131  

 **** Variables and constants ****

  ****  Section 000 LblCom LIBCOM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(720)   r     1 LIBCOM

  ****  Section 001 LblCom DEC_OR_COMMA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 DEC_OR_COMMA

  ****  Section 002 LblCom IN_TEMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)          1 IN_TEMP

  ****  Section 003 LblCom OVRCHR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 OVRCHR

  ****  Section 004 LblCom SELECT_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 SELECT_TIME

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:132  
  ****  Section 005 LblCom NO_ADVANCE_OFFSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 NO_ADVANCE_OFFSET

  ****  Section 006 LblCom DSPLY_SAVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)          1 DSPLY_SAVE

  ****  Section 007 LblCom D_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)          1 D_DATE

  ****  Section 008 LblCom D_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(11)          1 D_TIME

  ****  Section 009 LblCom D_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)           1 D_DAY

  ****  Section 010 LblCom C_DATE

PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:133  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)           1 C_DATE

  ****  Section 011 LblCom C_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)           1 C_TIME

  ****  Section 012 LblCom C_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)           1 C_DAY

  ****  Section 013 LblCom RTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 RTHOLD2

  ****  Section 014 LblCom LTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTHOLD2

  ****  Section 015 LblCom NDX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:134  

     0-0-0/w SBIN        r     1 NDX2

  ****  Section 016 LblCom IN_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 IN_LEN

  ****  Section 017 RoData X8DS$DISPLAY_SYSOUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(31)    r     1 ZEROES

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ARGS                      4-0-0/w PTR         r     1 @DESC
   425-0-0/w PTR         r     1 @FACTOR                  417-0-0/w PTR         r     1 @FACTOR
   424-0-0/w PTR         r     1 @SIZE_ON_DEVICE          416-0-0/w PTR         r     1 @SIZE_ON_DEVICE
   423-0-0/w PTR         r     1 @STRING                  415-0-0/w PTR         r     1 @STRING
    *0-0-0/w PTR         r     1 ARGS(0:8191)             105-0-0/w SBIN        r     1 BUFFER_COUNT
   331-0-0/c CHAR(4)     r     1 CHR_EXP                  420-0-0/w UBIN        r     1 COUNT
    *0-0-0/w STRC(32804) r     1 DESC                     403-0-0/w UBIN        r     1 DESCRIPTOR
   403-0-0/w STRC        r     1 DES_WORD                  76-0-0/w SBIN        r     1 DISPLAY_CODE
   104-0-0/w SBIN        r     1 DISPLAY_COUNT            107-0-0/c CHAR(396)   r     1 DISPLAY_STRING
   332-0-0/c STRC(9)     r     1 EXPON                     *0-0-0/w SBIN        r     1 FACTOR
    *0-0-0/w SBIN        r     1 FACTOR                   102-0-0/w SBIN        r     1 I
   103-0-0/w SBIN        r     1 ITEMP                    101-0-0/w SBIN        r     1 J
   100-0-0/w SBIN        r     1 L                        333-0-0/c STRC(9)     r     1 LARGE_EXPON
   417-0-0/w UBIN        r     1 LAST                     342-0-0/w UBIN(12)    r     1 LENGTH
   106-0-0/w UBIN        r     1 LINE_LENGTH                5-0-0/w SBIN        r     1 LT
PL6.E3A0      #001=X8DS$DISPLAY_SYSOUT File=X8DS.:X8A6TSI                        SAT 08/09/97 10:48 Page:135  
     6-0-0/c CHAR(65)    r     1 LTHOLD                    50-0-0/w SBIN        r     1 NDX
    51-0-0/w SBIN              1 NDX3                      77-0-0/w SBIN        r     1 OVERFLOW_CODE
   341-0-0/c CHAR        r     1 OVPNUM                   337-0-0/c CHAR        r     1 OVP_SIGN
   427-0-0/w SBIN        r     1 PART                     335-0-0/w STRC        r     1 REC_DESC
   363-0-0/c CHAR(63)    r     1 REC_FLD                  404-0-0/c CHAR(32)    r     1 RESULT
   330-0-0/w PTR         r     1 RESULT_ARG$              301-0-0/c CHAR(90)    r     1 RESULT_STR
    27-0-0/c CHAR(65)    r     1 RTHOLD                   425-0-0/c CHAR(10)    r     1 SAVE_CHAR
   334-0-0/w STRC        r     1 SEND_DESC                343-0-0/c CHAR(63)          1 SEND_FLD
   431-0-0/w UBIN        r     1 SHIFTS                   340-0-0/c CHAR        r     1 SIGN
   336-0-0/b BIT (2)     r     1 SIGN_TYPE                430-0-0/w UBIN        r     1 SIZE_IN_BUFFER
   420-0-0/w UBIN        r     1 SIZE_IN_BUFFER            *0-0-0/w UBIN        r     1 SIZE_ON_DEVICE
    *0-0-0/w UBIN        r     1 SIZE_ON_DEVICE            52-0-0/c CHAR(80)          1 SPECIAL_ERR_MSG
   430-0-0/w UBIN        r     1 START                     *0-0-0/c ACHR        r     1 STRING
    *0-0-0/c ACHR        r     1 STRING                   252-0-0/c CHAR(90)    r     1 TEMP_ARG
   422-0-0/c CHAR(10)    r     1 TEMP_CHAR                421-0-0/w UBIN        r     1 TEMP_NUM
   426-0-0/w SBIN        r     1 X_LENGTH

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 DATA                       0-0-0/c CHAR(3)     r     1 FLOAT_DOUBLE
     0-0-0/c ACHR              1 FLOAT_NUM                  0-0-0/w UBIN        r     1 FLOAT_SINGLE
     0-0-0/c ACHR        r     1 RESULT_ARG


   Procedure X8DS$DISPLAY_SYSOUT requires 1521 words for executable code.
   Procedure X8DS$DISPLAY_SYSOUT requires 288 words of local(AUTO) storage.

    No errors detected in file X8DS.:X8A6TSI    .
