VERSION E05

PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:1    
        1        1        /*M* FLN$ROUTINES - Routines for multi_DCB next open */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8        FLN$DISK_IO_INIT: PROC;
        9        9        /*F*  NAME: FLN$DISK_IO_INIT
       10       10              PURPOSE: Gets necessary DCBs.
       11       11         */
       12       12
       13       13         /***
       14       14          *** INCLUDE
       15       15          ***/
       16       16
       17       17        %INCLUDE CP_6_SUBS;
       18      557        %INCLUDE CP_6;
       19     6116        %INCLUDE FLI_DATA_R;
       20     7530        %INCLUDE FLN_DATA_R;
       21     8267        %INCLUDE FM$FIT;
       22     8488
       23     8489         /***
       24     8490          *** ENTRY
       25     8491          ***/
       26     8492
       27     8493    1   DCL FLI$ALLOC ENTRY(2);
       28     8494    1   DCL FLI$ALLOC_BUF ENTRY(2);
       29     8495
       30     8496         /***
       31     8497          *** AUTO
       32     8498          ***/
       33     8499
       34     8500    1   DCL I SBIN AUTO;
       35     8501
       36     8502        /***
       37     8503         *** BASED
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:2    
       38     8504         ***/
       39     8505
       40     8506        %F$DCB;
       41     8563        %CODE14;
       42     8573
       43     8574        /****************************************/
       44     8575
       45     8576         /***
       46     8577          *** Set up DCB number list.
       47     8578          ***/
       48     8579
       49     8580    2      DO I=0 TO %(MAX_NBR_DISK_DCBS - 1);
       50     8581    2         DISK_DCBLIST.DCB$(I) = DCBADDR(DISK_DCBLIST.DCB#(I));
       51     8582    2         IF DISK_DCBLIST.DCB$(I)->F$DCB.FCD#
       52     8583    3          THEN DO;                         /* Close it                           */
       53     8584    3            DISK_CLOSE_NEXT.V.DCB# = DISK_DCBLIST.DCB#(I);
       54     8585    3            CALL M$CLOSE( DISK_CLOSE_NEXT )
       55     8586    4             WHENALTRETURN DO;
       56     8587    4               END;
       57     8588    3            END;
       58     8589    2         CALL FLI$ALLOC_BUF( DISK_DCBLIST.FPARAM_(I), 1 );
       59     8590    2         END;
       60     8591
       61     8592    1      FIRST_FREE_DCB = 0;
       62     8593    1      NEXT_OPEN_DCB = -1;
       63     8594    1      LAST_OPEN_DCB = -1;
       64     8595    1      LAST_DCB = -1;
       65     8596    1      ON_TO_NEXT_DP = '1'B;
       66     8597    1      DPLISTX = -1;
       67     8598    1      DISK_SEARCH_COMPLETE = '0'B;
       68     8599
       69     8600    1      DISK_OPEN_NEXT.V.SRCHCOND = DISK_SRCHCOND;
       70     8601    1      DISK_CLOSE_NEXT.V.EFTOPER = '0'B;
       71     8602    1      DISK_CLOSE_NEXT.SN_ = VECTOR(NIL);
       72     8603    1      DISK_CLOSE_NEXT.V.DESC = '0'B;
       73     8604    1      DISK_CLOSE_NEXT.V.EXPIRE# = 0;
       74     8605
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:3    
       75     8606    1      DISK_ACCT_FIRST.ACCT# = ' ';
       76     8607    1      DISK_ACCT_LAST.ACCT# = ' ';
       77     8608
       78     8609    1      CALL FLI$ALLOC( SIZEW(CODE14), SAVE_CODE14$ );
       79     8610
       80     8611    1      RETURN;
       81     8612
       82     8613    1   END FLN$DISK_IO_INIT;
       83     8614        %EOD;

PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:4    
--  Include file information  --

   FM$FIT.:E05TOU  is referenced.
   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FLN$DISK_IO_INIT.

   Procedure FLN$DISK_IO_INIT requires 68 words for executable code.
   Procedure FLN$DISK_IO_INIT requires 6 words of local(AUTO) storage.

PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:5    

 Object Unit name= FLN$DISK_IO_INIT                           File name= FLN$ROUTINES.:E05TOU
 UTS= JUL 29 '97 16:09:12.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    94    136  FLN$DISK_IO_INIT
    3   DCB   even  none     0      0  M$DISK_IN
    4   DCB   even  none     0      0  M$DISK00
    5   DCB   even  none     0      0  M$DISK01
    6   DCB   even  none     0      0  M$DISK02
    7   DCB   even  none     0      0  M$DISK03
    8   Proc  even  none    68    104  FLN$DISK_IO_INIT
    9  RoData even  none     8     10  FLN$DISK_IO_INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes            yes      Std        0  FLN$DISK_IO_INIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 FLI$ALLOC_BUF
         yes           Std       2 FLI$ALLOC
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:6    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         SNVECLIST$
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             DISK_SRCHCOND                         EFTWORD
     DPLISTX                               M$PRE_RET                             RET_CMDS_NAME
     M$DISK_IN                             LAST_DCB                              NEXT_OPEN_DCB
     LAST_OPEN_DCB                         FIRST_FREE_DCB                        ON_TO_NEXT_DP
     SAVE_CODE14$                          DISK_SEARCH_COMPLETE                  M$DISK00
     M$DISK01                              M$DISK02                              M$DISK03
     DISK_DCBLIST                          FROM_DISK_NAME                        FROM_DISK_ACCT
     FROM_DISK_SN                          DISK_OPEN_NEXT                        DISK_CLOSE_NEXT
     DISK_ACCT_FIRST                       DISK_ACCT_LAST                        B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:7    


        1        1        /*M* FLN$ROUTINES - Routines for multi_DCB next open */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8        FLN$DISK_IO_INIT: PROC;

      8  8 000000   000000 700200 xent  FLN$DISK_IO* TSX0  ! X66_AUTO_0
         8 000001   000006 000000                    ZERO    6,0

        9        9        /*F*  NAME: FLN$DISK_IO_INIT
       10       10              PURPOSE: Gets necessary DCBs.
       11       11         */
       12       12
       13       13         /***
       14       14          *** INCLUDE
       15       15          ***/
       16       16
       17       17        %INCLUDE CP_6_SUBS;
       18      557        %INCLUDE CP_6;
       19     6116        %INCLUDE FLI_DATA_R;
       20     7530        %INCLUDE FLN_DATA_R;
       21     8267        %INCLUDE FM$FIT;
       22     8488
       23     8489         /***
       24     8490          *** ENTRY
       25     8491          ***/
       26     8492
       27     8493    1   DCL FLI$ALLOC ENTRY(2);
       28     8494    1   DCL FLI$ALLOC_BUF ENTRY(2);
       29     8495
       30     8496         /***
       31     8497          *** AUTO
       32     8498          ***/
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:8    
       33     8499
       34     8500    1   DCL I SBIN AUTO;
       35     8501
       36     8502        /***
       37     8503         *** BASED
       38     8504         ***/
       39     8505
       40     8506        %F$DCB;
       41     8563        %CODE14;
       42     8573
       43     8574        /****************************************/
       44     8575
       45     8576         /***
       46     8577          *** Set up DCB number list.
       47     8578          ***/
       48     8579
       49     8580    2      DO I=0 TO %(MAX_NBR_DISK_DCBS - 1);

   8580  8 000002   200003 450100                    STZ     I,,AUTO

       50     8581    2         DISK_DCBLIST.DCB$(I) = DCBADDR(DISK_DCBLIST.DCB#(I));

   8581  8 000003   200003 235100                    LDA     I,,AUTO
         8 000004   000003 735000                    ALS     3
         8 000005   000000 470400 9                  LDP0    0
         8 000006   000000 471500                    LDP1    0,,PR0
         8 000007   000000 720005 xsym               LXL0    DISK_DCBLIST,AL
         8 000010   100000 236110                    LDQ     0,X0,PR1
         8 000011   000001 756005 xsym               STQ     DISK_DCBLIST+1,AL

       51     8582    2         IF DISK_DCBLIST.DCB$(I)->F$DCB.FCD#

   8582  8 000012   000001 473405 xsym               LDP3    DISK_DCBLIST+1,AL
         8 000013   300031 236100                    LDQ     25,,PR3
         8 000014   020000 316007                    CANQ    8192,DL
         8 000015   000025 600000 8                  TZE     s:8589

PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:9    
       52     8583    3          THEN DO;                         /* Close it                           */

       53     8584    3            DISK_CLOSE_NEXT.V.DCB# = DISK_DCBLIST.DCB#(I);

   8584  8 000016   000000 720005 xsym               LXL0    DISK_DCBLIST,AL
         8 000017   000032 740000 xsym               STX0    DISK_CLOSE_NEXT+26

       54     8585    3            CALL M$CLOSE( DISK_CLOSE_NEXT )

   8585  8 000020   000000 630400 xsym               EPPR0   DISK_CLOSE_NEXT
         8 000021   450001 713400                    CLIMB   alt,close
         8 000022   406000 401760                    pmme    nvectors=13
         8 000023   000025 702000 8                  TSX2    s:8589
         8 000024   000025 710000 8                  TRA     s:8589

       55     8586    4             WHENALTRETURN DO;

       56     8587    4               END;

       57     8588    3            END;

       58     8589    2         CALL FLI$ALLOC_BUF( DISK_DCBLIST.FPARAM_(I), 1 );

   8589  8 000025   000001 236000 9                  LDQ     1
         8 000026   200005 756100                    STQ     I+2,,AUTO
         8 000027   200003 236100                    LDQ     I,,AUTO
         8 000030   000025 736000                    QLS     21
         8 000031   000002 036000 9                  ADLQ    2
         8 000032   200004 756100                    STQ     I+1,,AUTO
         8 000033   200004 630500                    EPPR0   I+1,,AUTO
         8 000034   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000035   000000 701000 xent               TSX1    FLI$ALLOC_BUF
         8 000036   000000 011000                    NOP     0

       59     8590    2         END;

   8590  8 000037   200003 054100                    AOS     I,,AUTO
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:10   
         8 000040   200003 235100                    LDA     I,,AUTO
         8 000041   000003 115007                    CMPA    3,DL
         8 000042   000003 604400 8                  TMOZ    s:8581

       60     8591
       61     8592    1      FIRST_FREE_DCB = 0;

   8592  8 000043   000000 450000 xsym               STZ     FIRST_FREE_DCB

       62     8593    1      NEXT_OPEN_DCB = -1;

   8593  8 000044   000001 336007                    LCQ     1,DL
         8 000045   000000 756000 xsym               STQ     NEXT_OPEN_DCB

       63     8594    1      LAST_OPEN_DCB = -1;

   8594  8 000046   000000 756000 xsym               STQ     LAST_OPEN_DCB

       64     8595    1      LAST_DCB = -1;

   8595  8 000047   000000 756000 xsym               STQ     LAST_DCB

       65     8596    1      ON_TO_NEXT_DP = '1'B;

   8596  8 000050   400000 236003                    LDQ     -131072,DU
         8 000051   000000 756000 xsym               STQ     ON_TO_NEXT_DP

       66     8597    1      DPLISTX = -1;

   8597  8 000052   000001 335007                    LCA     1,DL
         8 000053   000000 755000 xsym               STA     DPLISTX

       67     8598    1      DISK_SEARCH_COMPLETE = '0'B;

   8598  8 000054   000000 450000 xsym               STZ     DISK_SEARCH_COMPLETE

       68     8599
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:11   
       69     8600    1      DISK_OPEN_NEXT.V.SRCHCOND = DISK_SRCHCOND;

   8600  8 000055   000000 220000 xsym               LDX0    DISK_SRCHCOND
         8 000056   000045 740000 xsym               STX0    DISK_OPEN_NEXT+37

       70     8601    1      DISK_CLOSE_NEXT.V.EFTOPER = '0'B;

   8601  8 000057   000003 236000 9                  LDQ     3
         8 000060   000032 356000 xsym               ANSQ    DISK_CLOSE_NEXT+26

       71     8602    1      DISK_CLOSE_NEXT.SN_ = VECTOR(NIL);

   8602  8 000061   000004 237000 9                  LDAQ    4
         8 000062   000002 757000 xsym               STAQ    DISK_CLOSE_NEXT+2

       72     8603    1      DISK_CLOSE_NEXT.V.DESC = '0'B;

   8603  8 000063   000000 221003                    LDX1    0,DU
         8 000064   000033 741000 xsym               STX1    DISK_CLOSE_NEXT+27

       73     8604    1      DISK_CLOSE_NEXT.V.EXPIRE# = 0;

   8604  8 000065   000000 222003                    LDX2    0,DU
         8 000066   000034 442000 xsym               SXL2    DISK_CLOSE_NEXT+28

       74     8605
       75     8606    1      DISK_ACCT_FIRST.ACCT# = ' ';

   8606  8 000067   000035 235000 xsym               LDA     B_VECTNIL+29
         8 000070   000035 236000 xsym               LDQ     B_VECTNIL+29
         8 000071   000000 755000 xsym               STA     DISK_ACCT_FIRST
         8 000072   000001 756000 xsym               STQ     DISK_ACCT_FIRST+1

       76     8607    1      DISK_ACCT_LAST.ACCT# = ' ';

   8607  8 000073   000035 235000 xsym               LDA     B_VECTNIL+29
         8 000074   000035 236000 xsym               LDQ     B_VECTNIL+29
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:12   
         8 000075   000000 755000 xsym               STA     DISK_ACCT_LAST
         8 000076   000001 756000 xsym               STQ     DISK_ACCT_LAST+1

       77     8608
       78     8609    1      CALL FLI$ALLOC( SIZEW(CODE14), SAVE_CODE14$ );

   8609  8 000077   000006 630400 9                  EPPR0   6
         8 000100   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000101   000000 701000 xent               TSX1    FLI$ALLOC
         8 000102   000000 011000                    NOP     0

       79     8610
       80     8611    1      RETURN;

   8611  8 000103   000000 702200 xent               TSX2  ! X66_ARET
       81     8612
       82     8613    1   END FLN$DISK_IO_INIT;
       83     8614        %EOD;

PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:13   
--  Include file information  --

   FM$FIT.:E05TOU  is referenced.
   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FLN$DISK_IO_INIT.
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:14   

 **** Variables and constants ****

  ****  Section 002  Data  FLN$DISK_IO_INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   100-0-0/d STRC(1080)  r     1 CLOSE_BLOCK_FILE           6-0-0/d STRC(2088)  r     1 OPEN_BLOCK_FILE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 I

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(72)    r     1 DISK_ACCT_FIRST            0-0-0/c STRC(72)    r     1 DISK_ACCT_LAST
     0-0-0/d STRC(1080)  r     1 DISK_CLOSE_NEXT
     0-0-0/d STRC(252)   r     1 DISK_DCBLIST(0:8191)
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/d STRC(2088)  r     1 DISK_OPEN_NEXT
     0-0-0/b BIT         r     1 DISK_SEARCH_COMPLETE       0-0-0/b STRC(18)    r     1 DISK_SRCHCOND
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w SBIN        r     1 DPLISTX
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/w SBIN        r     1 FIRST_FREE_DCB
     0-0-0/c STRC(72)    r     1 FROM_DISK_ACCT             0-0-0/c STRC(288)   r     1 FROM_DISK_NAME
     0-0-0/d STRC(90)    r     1 FROM_DISK_SN               0-0-0/w SBIN        r     1 LAST_DCB
     0-0-0/w SBIN        r     1 LAST_OPEN_DCB              0-0-0/w SBIN        r     1 NEXT_OPEN_DCB
     0-0-0/b BIT         r     1 ON_TO_NEXT_DP              0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SAVE_CODE14$               0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/w PTR         r     1 TAPE_DCBLIST$

  ****  BASED and DCB variables  ****

PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:15   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 CODE14                     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$DISK_IN


   Procedure FLN$DISK_IO_INIT requires 68 words for executable code.
   Procedure FLN$DISK_IO_INIT requires 6 words of local(AUTO) storage.
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:16   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:17   
          MINI XREF LISTING

CLOSE_BLOCK_FILE.SN_
      8209**DCL      8209--REDEF
CLOSE_BLOCK_FILE.UTL_
      8210**DCL      8210--REDEF
CLOSE_BLOCK_FILE.V
      8214**DCL      8209--DCLINIT
CLOSE_BLOCK_FILE.V.EXPIRE#
      8224**DCL      8224--REDEF
CLOSE_BLOCK_FILE.V.TYPE#
      8222**DCL      8222--REDEF
CLOSE_BLOCK_FILE.V.XTNSIZE#
      8219**DCL      8219--REDEF    8221--REDEF
CODE14
      8566**DCL      8609--CALL
DISK_ACCT_FIRST.ACCT#
      8252**DCL      8606<<ASSIGN
DISK_ACCT_LAST.ACCT#
      8265**DCL      8607<<ASSIGN
DISK_CLOSE.SN_
      6727**DCL      6727--REDEF
DISK_CLOSE.UTL_
      6728**DCL      6728--REDEF
DISK_CLOSE.V.EXPIRE#
      6742**DCL      6742--REDEF
DISK_CLOSE.V.TYPE#
      6740**DCL      6740--REDEF
DISK_CLOSE.V.XTNSIZE#
      6737**DCL      6737--REDEF    6739--REDEF
DISK_CLOSE_NEXT
      7906**DCL      8585<>CALL
DISK_CLOSE_NEXT.SN_
      7906**DCL      7906--REDEF    8602<<ASSIGN
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:18   
DISK_CLOSE_NEXT.UTL_
      7907**DCL      7907--REDEF
DISK_CLOSE_NEXT.V.DCB#
      7912**DCL      8584<<ASSIGN
DISK_CLOSE_NEXT.V.DESC
      7916**DCL      8603<<ASSIGN
DISK_CLOSE_NEXT.V.EFTOPER
      7913**DCL      8601<<ASSIGN
DISK_CLOSE_NEXT.V.EXPIRE#
      7921**DCL      7921--REDEF    8604<<ASSIGN
DISK_CLOSE_NEXT.V.TYPE#
      7919**DCL      7919--REDEF
DISK_CLOSE_NEXT.V.XTNSIZE#
      7916**DCL      7916--REDEF    7918--REDEF
DISK_CLOSE_ORDINARY.SN_
      7948**DCL      7948--REDEF
DISK_CLOSE_ORDINARY.UTL_
      7949**DCL      7949--REDEF
DISK_CLOSE_ORDINARY.V.EXPIRE#
      7963**DCL      7963--REDEF
DISK_CLOSE_ORDINARY.V.TYPE#
      7961**DCL      7961--REDEF
DISK_CLOSE_ORDINARY.V.XTNSIZE#
      7958**DCL      7958--REDEF    7960--REDEF
DISK_DCBLIST.DCB#
      7543**DCL      8581--ASSIGN   8584>>ASSIGN
DISK_DCBLIST.DCB$
      7543**DCL      8581<<ASSIGN   8582>>IF
DISK_DCBLIST.FPARAM_
      7544**DCL      8589<>CALL
DISK_FILE_SPEC.SPEC
      7092**DCL      7094--REDEF
DISK_FILE_SPEC.SPEC.START
      7093**DCL      7093--REDEF
DISK_FILE_SPEC.SPEC.STOP
      7094**DCL      7094--REDEF
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:19   
DISK_FILE_SPEC$
      7091**DCL      7092--IMP-PTR
DISK_OPEN.ACSVEH_
      6592**DCL      6593--REDEF
DISK_OPEN.ALTKEYS_
      6598**DCL      6599--REDEF    6599--REDEF
DISK_OPEN.HDR_
      6597**DCL      6598--REDEF
DISK_OPEN.TAB_
      6596**DCL      6597--REDEF
DISK_OPEN.UHL_
      6590**DCL      6591--REDEF    6591--REDEF
DISK_OPEN.V.FSN#
      6630**DCL      6630--REDEF    6630--REDEF
DISK_OPEN.WSN_
      6596**DCL      6596--REDEF
DISK_OPEN_NEXT.ACSVEH_
      7732**DCL      7733--REDEF
DISK_OPEN_NEXT.ALTKEYS_
      7738**DCL      7739--REDEF    7739--REDEF
DISK_OPEN_NEXT.HDR_
      7737**DCL      7738--REDEF
DISK_OPEN_NEXT.TAB_
      7736**DCL      7737--REDEF
DISK_OPEN_NEXT.UHL_
      7730**DCL      7731--REDEF    7731--REDEF
DISK_OPEN_NEXT.V.FSN#
      7770**DCL      7770--REDEF    7770--REDEF
DISK_OPEN_NEXT.V.SRCHCOND
      7745**DCL      8600<<ASSIGN
DISK_OPEN_NEXT.WSN_
      7736**DCL      7736--REDEF
DISK_OPEN_ORDINARY.ACSVEH_
      7841**DCL      7842--REDEF
DISK_OPEN_ORDINARY.ALTKEYS_
      7847**DCL      7848--REDEF    7848--REDEF
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:20   
DISK_OPEN_ORDINARY.HDR_
      7846**DCL      7847--REDEF
DISK_OPEN_ORDINARY.TAB_
      7845**DCL      7846--REDEF
DISK_OPEN_ORDINARY.UHL_
      7839**DCL      7840--REDEF    7840--REDEF
DISK_OPEN_ORDINARY.V.FSN#
      7879**DCL      7879--REDEF    7879--REDEF
DISK_OPEN_ORDINARY.WSN_
      7845**DCL      7845--REDEF
DISK_READ.STATION_
      6654**DCL      6655--REDEF
DISK_READ.V.DVBYTE.REREAD#
      6666**DCL      6666--REDEF
DISK_READ.V.INDX#
      6664**DCL      6664--REDEF
DISK_SEARCH_COMPLETE
      7540**DCL      8598<<ASSIGN
DISK_SRCHCOND
      7097**DCL      8600>>ASSIGN
DISK_WRITE.STATION_
      6692**DCL      6692--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      6699**DCL      6699--REDEF
DPLIST$
      7077**DCL      7089--IMP-PTR
DPLISTX
      7213**DCL      8597<<ASSIGN
DPRESLIST$
      7091**DCL      7091--IMP-PTR
EFTWORD
      7212**DCL      7212--REDEF
F$DCB.ACTPOS
      8539**DCL      8539--REDEF
F$DCB.ARS#
      8513**DCL      8513--REDEF
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:21   
F$DCB.ATTR
      8532**DCL      8533--REDEF
F$DCB.BORROW
      8547**DCL      8547--REDEF    8547--REDEF    8547--REDEF
F$DCB.DCBNAME.L
      8561**DCL      8561--IMP-SIZ
F$DCB.EOMCHAR#
      8517**DCL      8517--REDEF
F$DCB.FCD#
      8526**DCL      8582>>IF
F$DCB.FLDID
      8542**DCL      8542--REDEF
F$DCB.FORM$
      8536**DCL      8536--REDEF
F$DCB.FSECT
      8552**DCL      8552--REDEF
F$DCB.FSN#
      8529**DCL      8529--REDEF    8529--REDEF    8530--REDEF
F$DCB.HEADER$
      8535**DCL      8535--REDEF
F$DCB.IXTNSIZE#
      8533**DCL      8533--REDEF
F$DCB.LASTSTA$
      8522**DCL      8522--REDEF
F$DCB.LVL
      8548**DCL      8548--REDEF
F$DCB.NAME#.C
      8523**DCL      8523--REDEF
F$DCB.NOEOF
      8545**DCL      8545--REDEF
F$DCB.NRECS#
      8534**DCL      8534--REDEF
F$DCB.NRECX
      8553**DCL      8553--REDEF
F$DCB.OHDR
      8545**DCL      8545--REDEF
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:22   
F$DCB.ORG#
      8528**DCL      8528--REDEF
F$DCB.PRECNO
      8551**DCL      8551--REDEF
F$DCB.RCSZ
      8557**DCL      8557--REDEF
F$DCB.RES#
      8524**DCL      8524--REDEF
F$DCB.SETX
      8536**DCL      8536--REDEF
F$DCB.TAB$
      8536**DCL      8536--REDEF
F$DCB.TDA
      8550**DCL      8551--REDEF
F$DCB.WSN#
      8524**DCL      8524--REDEF
FIRST_FREE_DCB
      7538**DCL      8592<<ASSIGN
FLI$ALLOC
      8493**DCL-ENT  8609--CALL
FLI$ALLOC_BUF
      8494**DCL-ENT  8589--CALL
FPT_EXIT.V.STEPCC#
      6517**DCL      6517--REDEF
FROM_DISK_ACCT
      7623**DCL      8147--DCLINIT
FROM_DISK_NAME
      7597**DCL      8143--DCLINIT
FROM_DISK_SN
      7649**DCL      8142--DCLINIT
I
      8500**DCL      8580<<DOINDEX  8581>>ASSIGN   8581>>ASSIGN   8582>>IF       8584>>ASSIGN   8589>>CALL
LAST_DCB
      7538**DCL      8595<<ASSIGN
LAST_OPEN_DCB
      7538**DCL      8594<<ASSIGN
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:23   
M$CLOSE
      6044**DCL-ENT  8585--CALL
NEXT_OPEN_DCB
      7538**DCL      8593<<ASSIGN
ON_TO_NEXT_DP
      7539**DCL      8596<<ASSIGN
OPEN_BLOCK_FILE.ACSVEH_
      8144**DCL      8145--REDEF
OPEN_BLOCK_FILE.ALTKEYS_
      8150**DCL      8151--REDEF    8151--REDEF
OPEN_BLOCK_FILE.HDR_
      8149**DCL      8150--REDEF
OPEN_BLOCK_FILE.TAB_
      8148**DCL      8149--REDEF
OPEN_BLOCK_FILE.UHL_
      8142**DCL      8143--REDEF    8143--REDEF
OPEN_BLOCK_FILE.V
      8151**DCL      8142--DCLINIT
OPEN_BLOCK_FILE.V.FSN#
      8182**DCL      8182--REDEF    8182--REDEF
OPEN_BLOCK_FILE.WSN_
      8148**DCL      8148--REDEF
PRE_RET_CLOSE.SN_
      7455**DCL      7455--REDEF
PRE_RET_CLOSE.UTL_
      7456**DCL      7456--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      7470**DCL      7470--REDEF
PRE_RET_CLOSE.V.TYPE#
      7468**DCL      7468--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      7465**DCL      7465--REDEF    7467--REDEF
PRE_RET_OPEN.ACSVEH_
      7390**DCL      7391--REDEF
PRE_RET_OPEN.ALTKEYS_
      7396**DCL      7397--REDEF    7397--REDEF
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:24   
PRE_RET_OPEN.HDR_
      7395**DCL      7396--REDEF
PRE_RET_OPEN.TAB_
      7394**DCL      7395--REDEF
PRE_RET_OPEN.UHL_
      7388**DCL      7389--REDEF    7389--REDEF
PRE_RET_OPEN.V.FSN#
      7428**DCL      7428--REDEF    7428--REDEF
PRE_RET_OPEN.WSN_
      7394**DCL      7394--REDEF
PRE_RET_READ.STATION_
      7245**DCL      7246--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      7257**DCL      7257--REDEF
PRE_RET_READ.V.INDX#
      7255**DCL      7255--REDEF
PRE_RET_WRITE.STATION_
      7283**DCL      7283--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      7290**DCL      7290--REDEF
READ_AD_OR_FD.ACSVEH_
      8034**DCL      8035--REDEF
READ_AD_OR_FD.ALTKEYS_
      8040**DCL      8041--REDEF    8041--REDEF
READ_AD_OR_FD.HDR_
      8039**DCL      8040--REDEF
READ_AD_OR_FD.TAB_
      8038**DCL      8039--REDEF
READ_AD_OR_FD.UHL_
      8032**DCL      8033--REDEF    8033--REDEF
READ_AD_OR_FD.V.FSN#
      8072**DCL      8072--REDEF    8072--REDEF
READ_AD_OR_FD.WSN_
      8038**DCL      8038--REDEF
RET_CMDS_NAME.L#
      7499**DCL      7499--IMP-SIZ
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:25   
SAVE_CODE14$
      7539**DCL      8609<>CALL
SNVECLIST$
      7031**DCL      7031--IMP-PTR
SPEC.START
      7095**DCL      7096--REDEF
SPEC.STOP
      7096**DCL      7097--REDEF
SPECCHARS
      7095**DCL      7095--REDEF
TAPE_CLOSE.SN_
      6948**DCL      6948--REDEF
TAPE_CLOSE.UTL_
      6949**DCL      6949--REDEF
TAPE_CLOSE.V.EXPIRE#
      6963**DCL      6963--REDEF
TAPE_CLOSE.V.TYPE#
      6961**DCL      6961--REDEF
TAPE_CLOSE.V.XTNSIZE#
      6958**DCL      6958--REDEF    6960--REDEF
TAPE_DCBLIST$
      6504**DCL      6504--IMP-PTR
TAPE_OPEN.ACSVEH_
      6813**DCL      6814--REDEF
TAPE_OPEN.ALTKEYS_
      6819**DCL      6820--REDEF    6820--REDEF
TAPE_OPEN.HDR_
      6818**DCL      6819--REDEF
TAPE_OPEN.TAB_
      6817**DCL      6818--REDEF
TAPE_OPEN.UHL_
      6811**DCL      6812--REDEF    6812--REDEF
TAPE_OPEN.V.FSN#
      6851**DCL      6851--REDEF    6851--REDEF
TAPE_OPEN.WSN_
      6817**DCL      6817--REDEF
PL6.E3A0      #001=FLN$DISK_IO_INIT File=FLN$ROUTINES.:E05TSI                    TUE 07/29/97 16:09 Page:26   
TAPE_READ.STATION_
      6875**DCL      6876--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      6887**DCL      6887--REDEF
TAPE_READ.V.INDX#
      6885**DCL      6885--REDEF
TAPE_WRITE.STATION_
      6913**DCL      6913--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      6920**DCL      6920--REDEF
TVECTOR.W2
      7044**DCL      7045--REDEF

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:27   
       84        1        /*T***********************************************************/
       85        2        /*T*                                                         */
       86        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       87        4        /*T*                                                         */
       88        5        /*T***********************************************************/
       89        6        FLN$DISK_OPEN_NEXT: PROC( DCB$, DCB#, DCBN, FPARAM_, ERR ) ALTRET;
       90        7        /*F*  NAME: FLN$DISK_OPEN_NEXT
       91        8              PURPOSE: Opens next file after last file with next free DCB.
       92        9        */
       93       10
       94       11    1   DCL DCB$ PTR ALIGNED;                   /* Returned pointer to next open DCB  */
       95       12    1   DCL DCB# SBIN ALIGNED;             /* Returned DCB number of next open DCB    */
       96       13    1   DCL DCBN SBIN ALIGNED;                  /* Returned internal DCB number       */
       97       14    1   DCL 1 FPARAM_ DALIGNED,
       98       15    1         2 * BIT(36),
       99       16    1         2 PTR$ PTR;
      100       17    1   DCL ERR BIT(36) ALIGNED;                /* Returned error word                */
      101       18
      102       19        /***
      103       20         *** INCLUDE
      104       21         ***/
      105       22
      106       23        %INCLUDE B_ERRORS_C;
      107     1150        %INCLUDE CP_6;
      108     6709        %INCLUDE CP_6_SUBS;
      109     7249        %INCLUDE FLI_DATA_R;
      110     8663        %INCLUDE FLN_DATA_R;
      111     9400        %INCLUDE FM$FIT;
      112     9621        %INCLUDE FM$GRAN;
      113     9690
      114     9691        /***
      115     9692         *** ENTRY
      116     9693         ***/
      117     9694
      118     9695    1   DCL FLI$RPT_ERR ENTRY(5);
      119     9696    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      120     9697
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:28   
      121     9698         /***
      122     9699          *** SYMREF
      123     9700          ***/
      124     9701
      125     9702    1   DCL BREAK_DCB# SBIN SYMREF;
      126     9703
      127     9704        /***
      128     9705         *** STATIC
      129     9706         ***/
      130     9707
      131     9708    1   DCL CURR_DCB$ PTR STATIC;
      132     9709
      133     9710        /***
      134     9711         *** AUTO
      135     9712         ***/
      136     9713
      137     9714    1   DCL NEXT_DCB SBIN AUTO;
      138     9715    1   DCL FOUND_FILE BIT(1) ALIGNED AUTO;
      139     9716    1   DCL RESET_PREVIOUS_ACCT BIT(1) ALIGNED AUTO;
      140     9717    1   DCL CODE SBIN AUTO;
      141     9718    1   DCL ACCT_CODE14$ PTR AUTO;
      142     9719    1   DCL CODE04$ PTR AUTO;
      143     9720
      144     9721        /***
      145     9722         *** BASED
      146     9723         ***/
      147     9724
      148     9725        %F$DCB( STCLASS="BASED(CURR_DCB$)" );
      149     9782        %B$TCB( STCLASS="BASED(B$TCB$)" );
      150     9785        %B$ALT;
      151     9793        %CODE04( BASED="BASED(CODE04$)" );
      152     9801        %CODE14( BASED="BASED(ACCT_CODE14$)" );
      153     9811        %FM$GRAN;
      154     9815
      155     9816        /****************************************/
      156     9817
      157     9818        /***
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:29   
      158     9819         *** If called with parameters and the next DCB is already open, return it.
      159     9820         ***/
      160     9821
      161     9822    1      IF ADDR(DCB$) ~= ADDR(NIL)
      162     9823    2       THEN DO;
      163     9824    2         IF NEXT_OPEN_DCB >= 0
      164     9825    3          THEN DO;                    /* Return next open DCB from open DCB list */
      165     9826    3            DCB$ = DISK_DCBLIST.DCB$(NEXT_OPEN_DCB);
      166     9827    3            BREAK_DCB# = DISK_DCBLIST.DCB#(NEXT_OPEN_DCB);
      167     9828    3            DCB# = BREAK_DCB#;
      168     9829    3            DCBN = NEXT_OPEN_DCB;
      169     9830    3            FPARAM_ = DISK_DCBLIST.FPARAM_(NEXT_OPEN_DCB);
      170     9831    3            ERR = DISK_DCBLIST.ERR(NEXT_OPEN_DCB);
      171     9832    3            NEXT_OPEN_DCB = DISK_DCBLIST.NEXT_IX(NEXT_OPEN_DCB);
      172     9833    3            DISK_DCBLIST.NEXT_IX(DCBN) = -1;
      173     9834    3            IF NEXT_OPEN_DCB < 0
      174     9835    3             THEN LAST_OPEN_DCB = NEXT_OPEN_DCB; /* Exhausted list               */
      175     9836    3            IF DCB$->F$DCB.ACCT# ~= BINASC(0)
      176     9837    4             THEN DO;
      177     9838    4               DISK_ACCT_LAST.ACCT# = DCB$->F$DCB.ACCT#;
      178     9839    4               IF DISK_ACCT_FIRST.ACCT# = ' '
      179     9840    4                THEN DISK_ACCT_FIRST = DISK_ACCT_LAST;
      180     9841    4               END;
      181     9842    3            RETURN;
      182     9843    3            END;
      183     9844    2          ELSE ERR = '0'B;
      184     9845    2         END;
      185     9846
      186     9847        /***
      187     9848         *** If no internal DCBs are free, just altreturn.  Otherwise get
      188     9849         *** internal number of free DCB.
      189     9850         ***/
      190     9851
      191     9852    1      IF DISK_SEARCH_COMPLETE
      192     9853    2       THEN DO;                            /* All done                           */
      193     9854    2         ALTRETURN;
      194     9855    2         END;
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:30   
      195     9856    1      IF FIRST_FREE_DCB < 0
      196     9857    1       THEN IF ADDR(DCB$) = ADDR(NIL)
      197     9858    1          THEN ALTRETURN;                  /* No DCBs left...caller doesn't care */
      198     9859    1          ELSE CALL M$XXX;                 /* Should have had at least one       */
      199     9860    1      NEXT_DCB = FIRST_FREE_DCB;
      200     9861    1      FIRST_FREE_DCB = DISK_DCBLIST.NEXT_IX(FIRST_FREE_DCB);
      201     9862
      202     9863        /***
      203     9864         *** Get ready for opening next file.
      204     9865         ***/
      205     9866
      206     9867    1      DISK_OPEN_NEXT.V.DCB# = DISK_DCBLIST.DCB#(NEXT_DCB);
      207     9868    1      DISK_OPEN_NEXT.FPARAM_ = DISK_DCBLIST.FPARAM_(NEXT_DCB);
      208     9869    1      CURR_DCB$ = DISK_DCBLIST.DCB$(NEXT_DCB);
      209     9870
      210     9871        /***
      211     9872         *** Open the next file.  Remember any errors.
      212     9873         ***/
      213     9874
      214     9875    1      FOUND_FILE = '0'B;
      215     9876    2      DO WHILE( NOT FOUND_FILE );
      216     9877
      217     9878    2         IF ON_TO_NEXT_DP
      218     9879    3          THEN DO;                    /* Start with first range on next packset  */
      219     9880    3            DPLISTX = DPLISTX + 1;
      220     9881    3            IF DPLISTX >= DPLIST.NUM#
      221     9882    4             THEN DO;                      /* No more packsets                   */
      222     9883    4               DISK_SEARCH_COMPLETE = '1'B;
      223     9884    4               ALTRETURN;
      224     9885    4               END;
      225     9886    3            ON_TO_NEXT_DP = '0'B;
      226     9887    3            DISK_SN.SN#(0) = DPLIST.SN#(DPLISTX);
      227     9888    3            DISK_OPEN_NEXT.V.RES# = DPRESLIST.NAME(DPLISTX);
      228     9889    3            SPECX = -1;
      229     9890    3            ON_TO_NEXT_SPEC = '1'B;
      230     9891    3            PREVIOUS_ACCT.ACCT# = BINASC(0);
      231     9892    3            IF DISK_OPTION.PAD
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:31   
      232     9893    4             THEN DO;                      /* Read the PAD                       */
      233     9894    4               READ_AD_OR_FD.FPARAM_ = DISK_OPEN_NEXT.FPARAM_;
      234     9895    4               READ_AD_OR_FD.V.DCB# = DISK_OPEN_NEXT.V.DCB#;
      235     9896    4               DISK_ACCT.ACCT# = BINASC(0);
      236     9897    4               FOUND_FILE = '1'B;
      237     9898    4               CALL M$OPEN( READ_AD_OR_FD )
      238     9899    5                WHENRETURN DO;
      239     9900    5                  DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;
      240     9901    5                  DISK_DCBLIST.ERR.CODE(NEXT_DCB) = %E$ADEOF; /* PAD indicator   */
      241     9902    5                  END;
      242     9903    5                WHENALTRETURN DO;          /* Return error to caller             */
      243     9904    5                  DISK_DCBLIST.ERR(NEXT_DCB) = B$TCB.ALT$->B$ALT.ERR;
      244     9905    5                  END;
      245     9906    4               END;
      246     9907    3            END;
      247     9908
      248     9909    2         IF ON_TO_NEXT_SPEC AND NOT FOUND_FILE /* Get next range spec'b by user? */
      249     9910    3          THEN DO;
      250     9911    3            SPECX = SPECX + 1;
      251     9912    3            IF SPECX >= DISK_FILE_SPEC.NBR
      252     9913    4             THEN DO;            /* No more ranges...move on to next packset     */
      253     9914    4               ON_TO_NEXT_DP = '1'B;
      254     9915    4               END;
      255     9916    4             ELSE DO;            /* Get ready for opening first file of range    */
      256     9917    4               DISK_OPEN_NEXT.V.INITZ.SCRUB# = '1'B;
      257     9918    4               DISK_OPEN_NEXT.V.OPER.NXTA# = '0'B;
      258     9919    4               ON_TO_NEXT_SPEC = '0'B;
      259     9920    4               DISK_NAME.NAME# = DISK_FILE_SPEC.SPEC.START.FILE.NAME#(SPECX);
      260     9921    4               DISK_NAME.L# = DISK_FILE_SPEC.SPEC.START.FILE.L#(SPECX);
      261     9922    4               DISK_ACCT = DISK_FILE_SPEC.SPEC.START.ACCT(SPECX);
      262     9923        /***
      263     9924         *** Check if password specified on an [UN]STOW,[UN]FETCH or UNARCHIVE.
      264     9925         ***/
      265     9926    4               IF DISK_FILE_SPEC.PASSWORD_SPEC
      266     9927    5                THEN DO;
      267     9928    5                  DISK_PASS.PASS# = DISK_FILE_SPEC.PASSWORD#;
      268     9929    5                  DISK_OPEN_NEXT.PASS_ = VECTOR(DISK_PASS);
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:32   
      269     9930    5                  END;
      270     9931    4                ELSE DISK_OPEN_NEXT.PASS_ = VECTOR(NIL);
      271     9932    4               IF SPECX <= 0
      272     9933    4                THEN ANY_FILES_IN_ACCT = '0'B;
      273     9934    4                ELSE IF DISK_FILE_SPEC.SPEC.START.ACCT(SPECX) ~= DISK_FILE_SPEC.SPEC.
              9934                         STOP.ACCT(SPECX-1)
      274     9935    4                   THEN ANY_FILES_IN_ACCT = '0'B;
      275     9936    4               DISK_OPEN_NEXT.V.OPER.NXTF# = '1'B;
      276     9937    4               DISK_OPEN_NEXT.V.OPER.THISF# = '1'B;
      277     9938    4               END;
      278     9939    3            END;
      279     9940
      280     9941    2         IF NOT ON_TO_NEXT_DP AND NOT FOUND_FILE
      281     9942    3          THEN DO;
      282     9943    3            CALL M$OPEN( DISK_OPEN_NEXT )
      283     9944    4             WHENRETURN DO;
      284     9945    4               DISK_OPEN_NEXT.V.INITZ.SCRUB# = '0'B;
      285     9946    4               DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;
      286     9947    4               CODE = 0;
      287     9948    4               CALL FLN_CHECK_STOP
      288     9949    5                WHENRETURN DO;
      289     9950    5                  ANY_FILES_IN_ACCT = '1'B;
      290     9951    5                  FOUND_FILE = '1'B;
      291     9952        /***
      292     9953         *** SVMODIFY time is not init. to 0 if file in use by multiple users
      293     9954         *** (opened update,in) so testing for crash should not be performed.
      294     9955        ***/
      295     9956    5                  IF NOT F$DCB.DESC.DELF# AND
      296     9957    5                    ( DISK_OPEN_NEXT.V.FUN# ~= %UPDATE# ) AND
      297     9958    5                    ( DISK_OPEN_NEXT.V.SHARE# ~= %IN# )
      298     9959    6                   THEN DO;
      299     9960    6                     CODE04$ = PINCRW( DISK_DCBLIST.FPARAM_.PTR$(NEXT_DCB), SIZEW(
              9960                              FM$GRAN) );
      300     9961    6                     CALL XSF$LOCCODP( CODE04$, 04 )
      301     9962    7                      WHENRETURN DO;
      302     9963    7                        IF CODE04.SVMODIFY.TIME ~= 0
      303     9964    8                         THEN DO;          /* Caught in crash...clean it up      */
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:33   
      304     9965    8                           DISK_CLOSE_ORDINARY.V.DCB# = DISK_OPEN_NEXT.V.DCB#;
      305     9966    8                           CALL M$CLOSE( DISK_CLOSE_ORDINARY )
      306     9967    9                            WHENALTRETURN DO;
      307     9968    9                              END;
      308     9969    8                           DISK_OPEN_ORDINARY.V.ACS# = 0;
      309     9970    8                           DISK_OPEN_ORDINARY.V.DCB# = DISK_OPEN_NEXT.V.DCB#;
      310     9971    8                           CALL M$OPEN( DISK_OPEN_ORDINARY ) ALTRET( CHKERR );
      311     9972    8                           CALL M$CLOSE ( DISK_CLOSE_ORDINARY )
      312     9973    9                            WHENALTRETURN DO;
      313     9974    9                              END;
      314     9975    8                           DISK_OPEN_ORDINARY.V.ACS# = %BLOCK#;
      315     9976    8                           CALL M$OPEN ( DISK_OPEN_ORDINARY )  ALTRET(CHKERR);
      316     9977    8                           END;
      317     9978    7                        END;
      318     9979    7                      WHENALTRETURN DO;
      319     9980                                                /* Not to worry                       */
      320     9981    7                        END;
      321     9982    6                     END;
      322     9983    5                  END;
      323     9984    5                WHENALTRETURN DO;
      324     9985    5                  ON_TO_NEXT_SPEC = '1'B;
      325     9986    5                  IF F$DCB.FCD#
      326     9987    6                   THEN DO;                /* Close DCB                          */
      327     9988    6                     DISK_CLOSE_NEXT.V.DCB# = DISK_OPEN_NEXT.V.DCB#;
      328     9989    6                     CALL M$CLOSE( DISK_CLOSE_NEXT )
      329     9990    7                      WHENALTRETURN DO;
      330     9991    7                        CALL FLI$RPT_ERR;
      331     9992    7                        END;
      332     9993    6                     END;
      333     9994    5                  END;
      334     9995    4               END;
      335     9996    4             WHENALTRETURN DO;
      336     9997    4   CHKERR:     ;
      337     9998    4               DISK_OPEN_NEXT.V.INITZ.SCRUB# = '0'B;
      338     9999    4               DISK_DCBLIST.ERR(NEXT_DCB) = B$TCB.ALT$->B$ALT.ERR;
      339    10000    4               CODE = B$TCB.ALT$->B$ALT.ERR.CODE;
      340    10001    4               CALL FLN_CHECK_STOP
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:34   
      341    10002    5                WHENALTRETURN DO;
      342    10003    5                  IF CODE ~= %E$NOFILE AND CODE ~= %E$FDEOF AND CODE ~= %E$NOKEY AND
             10003                           CODE ~= %E$ADEOF
      343    10004    5                   THEN CODE = 0;
      344    10005    5                  END;
      345    10006    4               IF CODE = %E$STOWEDFILE
      346    10007    4                THEN DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;
             10007                         /* Ignore error - file exists */
      347    10008    4               IF CODE = %E$FDEOF OR CODE = %E$NOKEY
      348    10009    5                THEN DO;                   /* File directory end or not there    */
      349    10010    5                  DISK_NAME.NAME# = ' ';   /* Reset file name for next account   */
      350    10011    5                  DISK_NAME.L# = 0;
      351    10012    5                  DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;
      352    10013    5                  READ_AD_OR_FD.FPARAM_ = DISK_OPEN_NEXT.FPARAM_;
      353    10014    5                  READ_AD_OR_FD.V.DCB# = DISK_OPEN_NEXT.V.DCB#;
      354    10015    5                  CALL M$OPEN( READ_AD_OR_FD )
      355    10016    6                   WHENRETURN DO;
      356    10017                                                /* Account really does exist          */
      357    10018    6                     END;
      358    10019    6                   WHENALTRETURN DO;
      359    10020    6                     IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      360    10021    6                      THEN IF F$DCB.EXPIRE# ~= 0
      361    10022    6                         THEN CODE = %E$NOKEY; /* A deleted account              */
      362    10023    6                         ELSE ;            /* Account really doesn't exist       */
      363    10024    6                     END;
      364    10025    5                  IF F$DCB.ACCT# >= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(SPECX)
      365    10026    5                   THEN ON_TO_NEXT_SPEC = '1'B; /* Done with range               */
      366    10027    5                  IF F$DCB.ACCT# <= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(SPECX)
      367    10028    5                   THEN IF (CODE = %E$FDEOF AND DISK_OPTION.DIR AND NOT
             10028                            ANY_FILES_IN_ACCT)
      368    10029    5                       OR (CODE = %E$NOKEY AND DISK_OPTION.DELETED_ACCOUNTS)
      369    10030    5                      THEN FOUND_FILE = '1'B;
      370    10031    5                  ANY_FILES_IN_ACCT = '0'B;
      371    10032    5                  END;
      372    10033    4                ELSE IF CODE = %E$ADEOF
      373    10034    4                   THEN ON_TO_NEXT_DP = '1'B; /* End of packset...on to next     */
      374    10035    4                   ELSE IF CODE = 0
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:35   
      375    10036    4                      THEN ON_TO_NEXT_SPEC = '1'B; /* Didn't want file anyway    */
      376    10037    4                      ELSE FOUND_FILE = '1'B;
      377    10038    4               END;
      378    10039    3            END;
      379    10040
      380    10041        /***
      381    10042         *** Special handling for account changes if DIR specified.
      382    10043         ***/
      383    10044
      384    10045    2         IF FOUND_FILE
      385    10046    3          THEN DO;
      386    10047    3            IF DISK_OPTION.DIR OR DISK_OPTION.DELETED_ACCOUNTS
      387    10048    3              OR DISK_OPTION.SKIP_NO_BACKUP OR DISK_OPTION.SKIP_NO_STOW
      388    10049    3              OR DISK_OPTION.SKIP_NO_PURGE
      389    10050    4             THEN DO;
      390    10051    4               RESET_PREVIOUS_ACCT = '0'B;
      391    10052    4               IF PREVIOUS_ACCT.ACCT# ~= F$DCB.ACCT#
      392    10053    5                THEN DO;                   /* Must get FD for account            */
      393    10054    5                  IF CODE = %E$FDEOF OR CODE = %E$NOKEY
      394    10055    5                   THEN DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;
      395    10056    5                   ELSE DISK_OPEN_NEXT.V.OPER.THISF# = '1'B; /* Reopen current file */
      396    10057    5                  IF F$DCB.FCD#
      397    10058    6                   THEN DO;                /* Close DCB...will use it to get FD  */
      398    10059    6                     DISK_CLOSE_NEXT.V.DCB# = DISK_OPEN_NEXT.V.DCB#;
      399    10060    6                     CALL M$CLOSE( DISK_CLOSE_NEXT )
      400    10061    7                      WHENALTRETURN DO;
      401    10062    7                        CALL FLI$RPT_ERR;
      402    10063    7                        END;
      403    10064    6                     END;
      404    10065    5                  READ_AD_OR_FD.FPARAM_ = DISK_OPEN_NEXT.FPARAM_;
      405    10066    5                  READ_AD_OR_FD.V.DCB# = DISK_OPEN_NEXT.V.DCB#;
      406    10067    5                  CALL M$OPEN( READ_AD_OR_FD )
      407    10068    6                   WHENRETURN DO;          /* Get FD                             */
      408    10069    6                     DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;
      409    10070    6                     DISK_DCBLIST.ERR.CODE(NEXT_DCB) = %E$FDEOF; /* FD indicator */
      410    10071    6                     ACCT_CODE14$ = DISK_DCBLIST.FPARAM_.PTR$(NEXT_DCB);
      411    10072    6                     CALL XSF$LOCCODP( ACCT_CODE14$, 14 )
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:36   
      412    10073    7                      WHENRETURN DO;
      413    10074    7                        IF (DISK_OPTION.SKIP_NO_BACKUP AND NOT CODE14.ACCESS.BUPF)
      414    10075    8                         THEN DO;
      415    10076    8                           DISK_NAME.L# = 0;
      416    10077    8                           DISK_NAME.NAME# = ' ';
      417    10078    8                           RESET_PREVIOUS_ACCT = '1'B ; /* Forces chking of nxt FD */
      418    10079    8                           DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;
      419    10080    8                           IF NOT DISK_OPTION.SAVE_DIR /* FD saved on SAVE and   */
      420    10081    8                            THEN           /* BACKUP but not files.              */
      421    10082    8                              FOUND_FILE = '0'B;
      422    10083    8                           END;
      423    10084    8                         ELSE DO;
      424    10085    8                           IF (DISK_OPTION.SKIP_NO_STOW AND CODE14.ACCESS.NOSTOW)
      425    10086    8                             OR (DISK_OPTION.SKIP_NO_PURGE AND CODE14.ACCESS.NPUR)
      426    10087    9                            THEN DO;       /* Skip no backup account             */
      427    10088    9                              FOUND_FILE = '0'B;
      428    10089    9                              DISK_NAME.L# = 0;
      429    10090    9                              DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;
      430    10091    9                              DISK_NAME.NAME# = ' ';
      431    10092    9                              END;
      432    10093    8                           END;
      433    10094    7                        END;
      434    10095    7                      WHENALTRETURN DO;
      435    10096    7                        END;
      436    10097    6                     END;
      437    10098    6                   WHENALTRETURN DO;
      438    10099    6                     IF CODE = %E$FDEOF AND B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      439    10100    7                      THEN DO;
             10100                               /* Only happens if attempted to open nonexistent account */
      440    10101    7                        FOUND_FILE = '0'B;
      441    10102    7                        END;
      442    10103    6                      ELSE DISK_DCBLIST.ERR(NEXT_DCB) = B$TCB.ALT$->B$ALT.ERR;
      443    10104    6                     END;
      444    10105    5                  IF RESET_PREVIOUS_ACCT
      445    10106    5                   THEN PREVIOUS_ACCT.ACCT# = ' ';
      446    10107    5                   ELSE PREVIOUS_ACCT.ACCT# = F$DCB.ACCT#;
      447    10108    5                  IF NOT (DISK_OPTION.DIR OR DISK_OPTION.DELETED_ACCOUNTS)
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:37   
      448    10109    5                   THEN FOUND_FILE = '0'B;
      449    10110    5                  END;
      450    10111    4               END;
      451    10112    3             ELSE DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;
      452    10113    3            END;
      453    10114    2         END;
      454    10115
      455    10116    1      LAST_DCB = NEXT_DCB;
      456    10117
      457    10118        /***
      458    10119         *** If called with parameters, return values.  If not, link
      459    10120         *** open DCB to open DCB list.
      460    10121         ***/
      461    10122
      462    10123    1      IF ADDR(DCB$) ~= ADDR(NIL)
      463    10124    2       THEN DO;                            /* Return values                      */
      464    10125    2         DCB$ = DISK_DCBLIST.DCB$(NEXT_DCB);
      465    10126    2         BREAK_DCB# = DISK_DCBLIST.DCB#(NEXT_DCB);
      466    10127    2         DCB# = BREAK_DCB#;
      467    10128    2         FPARAM_ = DISK_DCBLIST.FPARAM_(NEXT_DCB);
      468    10129    2         ERR = DISK_DCBLIST.ERR(NEXT_DCB);
      469    10130    2         DISK_DCBLIST.NEXT_IX(NEXT_DCB) = -1;
      470    10131    2         DCBN = NEXT_DCB;
      471    10132    2         IF DCB$->F$DCB.ACCT# ~= BINASC(0)
      472    10133    3          THEN DO;
      473    10134    3            DISK_ACCT_LAST.ACCT# = DCB$->F$DCB.ACCT#;
      474    10135    3            IF DISK_ACCT_FIRST.ACCT# = ' '
      475    10136    3             THEN DISK_ACCT_FIRST = DISK_ACCT_LAST;
      476    10137    3            END;
      477    10138    2         END;
      478    10139    2       ELSE DO;                            /* Link to open DCB list              */
      479    10140    2         IF LAST_OPEN_DCB < 0
      480    10141    3          THEN DO;                         /* Completely new open DCB list       */
      481    10142    3            NEXT_OPEN_DCB = NEXT_DCB;
      482    10143    3            LAST_OPEN_DCB = NEXT_DCB;
      483    10144    3            END;
      484    10145    3          ELSE DO;                         /* Add to end of open DCB list        */
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:38   
      485    10146    3            DISK_DCBLIST.NEXT_IX(LAST_OPEN_DCB) = NEXT_DCB;
      486    10147    3            LAST_OPEN_DCB = NEXT_DCB;
      487    10148    3            END;
      488    10149    2         DISK_DCBLIST.NEXT_IX(NEXT_DCB) = -1;
      489    10150    2         END;
      490    10151    1      RETURN;
      491    10152
      492    10153    1   FLN_CHECK_STOP: PROC ALTRET;
      493    10154
      494    10155        /********************/
      495    10156
      496    10157    2      DISK_OPEN_NEXT.V.OPER.NXTA# = '0'B;
      497    10158    2      DISK_OPEN_NEXT.V.OPER.NXTF# = '1'B;
      498    10159    2      DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;
      499    10160    2      DISK_NAME = F$DCB.NAME#;
      500    10161    2      DISK_ACCT.ACCT# = F$DCB.ACCT#;
      501    10162    2      SPEC.STOP.ACCT.ACCT# = F$DCB.ACCT#;
      502    10163    2      SPEC.STOP.FILE.NAME# = F$DCB.NAME#.C;
      503    10164    2      SPEC.STOP.FILE.L# = F$DCB.NAME#.L;
      504    10165    2      IF SPEC.STOP > DISK_FILE_SPEC.SPEC.STOP(SPECX)
      505    10166    2       THEN ALTRETURN;           /* Current file is past end of current range    */
      506    10167    2       ELSE RETURN;
      507    10168
      508    10169    2   END FLN_CHECK_STOP;
      509    10170
      510    10171
      511    10172    1   END FLN$DISK_OPEN_NEXT;
      512    10173        %EOD;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:39   
--  Include file information  --

   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLN$DISK_OPEN_NEXT.

   Procedure FLN$DISK_OPEN_NEXT requires 644 words for executable code.
   Procedure FLN$DISK_OPEN_NEXT requires 18 words of local(AUTO) storage.

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:40   

 Object Unit name= FLN$DISK_OPEN_NEXT                         File name= FLN$ROUTINES.:E05TOU
 UTS= JUL 29 '97 16:10:57.52 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    95    137  FLN$DISK_OPEN_NEXT
    3   DCB   even  none     0      0  M$DISK_IN
    4   DCB   even  none     0      0  M$DISK00
    5   DCB   even  none     0      0  M$DISK01
    6   DCB   even  none     0      0  M$DISK02
    7   DCB   even  none     0      0  M$DISK03
    8   Proc  even  none   644   1204  FLN$DISK_OPEN_NEXT
    9  RoData even  none    13     15  FLN$DISK_OPEN_NEXT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes    yes     yes      Std        5  FLN$DISK_OPEN_NEXT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XSF$LOCCODP
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:41   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         SNVECLIST$
     B$TCB$                                DPLIST$                               DPRESLIST$
     DISK_FILE_SPEC$                       SPECCHARS                             DISK_OPTION
     EFTWORD                               DPLISTX                               SPECX
     M$PRE_RET                             RET_CMDS_NAME                         M$DISK_IN
     LAST_DCB                              NEXT_OPEN_DCB                         LAST_OPEN_DCB
     FIRST_FREE_DCB                        ON_TO_NEXT_DP                         ON_TO_NEXT_SPEC
     ANY_FILES_IN_ACCT                     DISK_SEARCH_COMPLETE                  M$DISK00
     M$DISK01                              M$DISK02                              M$DISK03
     DISK_DCBLIST                          DISK_NAME                             FROM_DISK_NAME
     DISK_ACCT                             FROM_DISK_ACCT                        DISK_SN
     FROM_DISK_SN                          DISK_PASS                             DISK_OPEN_NEXT
     DISK_OPEN_ORDINARY                    DISK_CLOSE_NEXT                       DISK_CLOSE_ORDINARY
     READ_AD_OR_FD                         PREVIOUS_ACCT                         DISK_ACCT_FIRST
     DISK_ACCT_LAST                        BREAK_DCB#                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:42   


       84        1        /*T***********************************************************/
       85        2        /*T*                                                         */
       86        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       87        4        /*T*                                                         */
       88        5        /*T***********************************************************/
       89        6        FLN$DISK_OPEN_NEXT: PROC( DCB$, DCB#, DCBN, FPARAM_, ERR ) ALTRET;

      6  8 000000   000000 700200 xent  FLN$DISK_OP* TSX0  ! X66_AUTO_5
         8 000001   000022 000005                    ZERO    18,5

       90        7        /*F*  NAME: FLN$DISK_OPEN_NEXT
       91        8              PURPOSE: Opens next file after last file with next free DCB.
       92        9        */
       93       10
       94       11    1   DCL DCB$ PTR ALIGNED;                   /* Returned pointer to next open DCB  */
       95       12    1   DCL DCB# SBIN ALIGNED;             /* Returned DCB number of next open DCB    */
       96       13    1   DCL DCBN SBIN ALIGNED;                  /* Returned internal DCB number       */
       97       14    1   DCL 1 FPARAM_ DALIGNED,
       98       15    1         2 * BIT(36),
       99       16    1         2 PTR$ PTR;
      100       17    1   DCL ERR BIT(36) ALIGNED;                /* Returned error word                */
      101       18
      102       19        /***
      103       20         *** INCLUDE
      104       21         ***/
      105       22
      106       23        %INCLUDE B_ERRORS_C;
      107     1150        %INCLUDE CP_6;
      108     6709        %INCLUDE CP_6_SUBS;
      109     7249        %INCLUDE FLI_DATA_R;
      110     8663        %INCLUDE FLN_DATA_R;
      111     9400        %INCLUDE FM$FIT;
      112     9621        %INCLUDE FM$GRAN;
      113     9690
      114     9691        /***
      115     9692         *** ENTRY
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:43   
      116     9693         ***/
      117     9694
      118     9695    1   DCL FLI$RPT_ERR ENTRY(5);
      119     9696    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      120     9697
      121     9698         /***
      122     9699          *** SYMREF
      123     9700          ***/
      124     9701
      125     9702    1   DCL BREAK_DCB# SBIN SYMREF;
      126     9703
      127     9704        /***
      128     9705         *** STATIC
      129     9706         ***/
      130     9707
      131     9708    1   DCL CURR_DCB$ PTR STATIC;
      132     9709
      133     9710        /***
      134     9711         *** AUTO
      135     9712         ***/
      136     9713
      137     9714    1   DCL NEXT_DCB SBIN AUTO;
      138     9715    1   DCL FOUND_FILE BIT(1) ALIGNED AUTO;
      139     9716    1   DCL RESET_PREVIOUS_ACCT BIT(1) ALIGNED AUTO;
      140     9717    1   DCL CODE SBIN AUTO;
      141     9718    1   DCL ACCT_CODE14$ PTR AUTO;
      142     9719    1   DCL CODE04$ PTR AUTO;
      143     9720
      144     9721        /***
      145     9722         *** BASED
      146     9723         ***/
      147     9724
      148     9725        %F$DCB( STCLASS="BASED(CURR_DCB$)" );
      149     9782        %B$TCB( STCLASS="BASED(B$TCB$)" );
      150     9785        %B$ALT;
      151     9793        %CODE04( BASED="BASED(CODE04$)" );
      152     9801        %CODE14( BASED="BASED(ACCT_CODE14$)" );
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:44   
      153     9811        %FM$GRAN;
      154     9815
      155     9816        /****************************************/
      156     9817
      157     9818        /***
      158     9819         *** If called with parameters and the next DCB is already open, return it.
      159     9820         ***/
      160     9821
      161     9822    1      IF ADDR(DCB$) ~= ADDR(NIL)

   9822  8 000002   200003 236100                    LDQ     @DCB$,,AUTO
         8 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         8 000004   000074 600000 8                  TZE     s:9852

      162     9823    2       THEN DO;

      163     9824    2         IF NEXT_OPEN_DCB >= 0

   9824  8 000005   000000 235000 xsym               LDA     NEXT_OPEN_DCB
         8 000006   000072 604000 8                  TMI     s:9844

      164     9825    3          THEN DO;                    /* Return next open DCB from open DCB list */

      165     9826    3            DCB$ = DISK_DCBLIST.DCB$(NEXT_OPEN_DCB);

   9826  8 000007   000003 735000                    ALS     3
         8 000010   000001 236005 xsym               LDQ     DISK_DCBLIST+1,AL
         8 000011   200003 470500                    LDP0    @DCB$,,AUTO
         8 000012   000000 756100                    STQ     0,,PR0

      166     9827    3            BREAK_DCB# = DISK_DCBLIST.DCB#(NEXT_OPEN_DCB);

   9827  8 000013   000000 235000 xsym               LDA     NEXT_OPEN_DCB
         8 000014   000003 735000                    ALS     3
         8 000015   000000 235005 xsym               LDA     DISK_DCBLIST,AL
         8 000016   000000 755000 xsym               STA     BREAK_DCB#

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:45   
      167     9828    3            DCB# = BREAK_DCB#;

   9828  8 000017   200004 471500                    LDP1    @DCB#,,AUTO
         8 000020   100000 755100                    STA     0,,PR1

      168     9829    3            DCBN = NEXT_OPEN_DCB;

   9829  8 000021   200005 473500                    LDP3    @DCBN,,AUTO
         8 000022   000000 236000 xsym               LDQ     NEXT_OPEN_DCB
         8 000023   300000 756100                    STQ     0,,PR3

      169     9830    3            FPARAM_ = DISK_DCBLIST.FPARAM_(NEXT_OPEN_DCB);

   9830  8 000024   000000 235000 xsym               LDA     NEXT_OPEN_DCB
         8 000025   000005 735000                    ALS     5
         8 000026   200006 474500                    LDP4    @FPARAM_,,AUTO
         8 000027   000100 100405                    MLR     fill='000'O
         8 000030   000005 000010 xsym               ADSC9   DISK_DCBLIST+5,A         cn=0,n=8
         8 000031   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8

      170     9831    3            ERR = DISK_DCBLIST.ERR(NEXT_OPEN_DCB);

   9831  8 000032   000000 235000 xsym               LDA     NEXT_OPEN_DCB
         8 000033   000003 735000                    ALS     3
         8 000034   000002 236005 xsym               LDQ     DISK_DCBLIST+2,AL
         8 000035   200007 475500                    LDP5    @ERR,,AUTO
         8 000036   500000 756100                    STQ     0,,PR5

      171     9832    3            NEXT_OPEN_DCB = DISK_DCBLIST.NEXT_IX(NEXT_OPEN_DCB);

   9832  8 000037   000000 235000 xsym               LDA     NEXT_OPEN_DCB
         8 000040   000003 735000                    ALS     3
         8 000041   000003 235005 xsym               LDA     DISK_DCBLIST+3,AL
         8 000042   000000 755000 xsym               STA     NEXT_OPEN_DCB

      172     9833    3            DISK_DCBLIST.NEXT_IX(DCBN) = -1;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:46   
   9833  8 000043   300000 235100                    LDA     0,,PR3
         8 000044   000002 735000                    ALS     2
         8 000045   000001 735000                    ALS     1
         8 000046   000001 336007                    LCQ     1,DL
         8 000047   000003 756005 xsym               STQ     DISK_DCBLIST+3,AL

      173     9834    3            IF NEXT_OPEN_DCB < 0

   9834  8 000050   000000 235000 xsym               LDA     NEXT_OPEN_DCB
         8 000051   000053 605000 8                  TPL     s:9836

      174     9835    3             THEN LAST_OPEN_DCB = NEXT_OPEN_DCB; /* Exhausted list               */

   9835  8 000052   000000 755000 xsym               STA     LAST_OPEN_DCB

      175     9836    3            IF DCB$->F$DCB.ACCT# ~= BINASC(0)

   9836  8 000053   000000 476500                    LDP6    0,,PR0
         8 000054   600020 237100                    LDAQ    16,,PR6
         8 000055   000000 117000 9                  CMPAQ   0
         8 000056   000071 600000 8                  TZE     s:9842

      176     9837    4             THEN DO;

      177     9838    4               DISK_ACCT_LAST.ACCT# = DCB$->F$DCB.ACCT#;

   9838  8 000057   600020 237100                    LDAQ    16,,PR6
         8 000060   000000 755000 xsym               STA     DISK_ACCT_LAST
         8 000061   000001 756000 xsym               STQ     DISK_ACCT_LAST+1

      178     9839    4               IF DISK_ACCT_FIRST.ACCT# = ' '

   9839  8 000062   040000 106400                    CMPC    fill='040'O
         8 000063   000000 000010 xsym               ADSC9   DISK_ACCT_FIRST          cn=0,n=8
         8 000064   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 000065   000071 601000 8                  TNZ     s:9842

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:47   
      179     9840    4                THEN DISK_ACCT_FIRST = DISK_ACCT_LAST;

   9840  8 000066   000000 100400                    MLR     fill='000'O
         8 000067   000000 000010 xsym               ADSC9   DISK_ACCT_LAST           cn=0,n=8
         8 000070   000000 000010 xsym               ADSC9   DISK_ACCT_FIRST          cn=0,n=8

      180     9841    4               END;

      181     9842    3            RETURN;

   9842  8 000071   000000 702200 xent               TSX2  ! X66_ARET

      182     9843    3            END;
      183     9844    2          ELSE ERR = '0'B;

   9844  8 000072   200007 470500                    LDP0    @ERR,,AUTO
         8 000073   000000 450100                    STZ     0,,PR0

      184     9845    2         END;

      185     9846
      186     9847        /***
      187     9848         *** If no internal DCBs are free, just altreturn.  Otherwise get
      188     9849         *** internal number of free DCB.
      189     9850         ***/
      190     9851
      191     9852    1      IF DISK_SEARCH_COMPLETE

   9852  8 000074   000000 234000 xsym               SZN     DISK_SEARCH_COMPLETE
         8 000075   000077 605000 8                  TPL     s:9856

      192     9853    2       THEN DO;                            /* All done                           */

      193     9854    2         ALTRETURN;

   9854  8 000076   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:48   
      194     9855    2         END;
      195     9856    1      IF FIRST_FREE_DCB < 0

   9856  8 000077   000000 235000 xsym               LDA     FIRST_FREE_DCB
         8 000100   000106 605000 8                  TPL     s:9860

      196     9857    1       THEN IF ADDR(DCB$) = ADDR(NIL)

   9857  8 000101   000001 116000 xsym               CMPQ    B_VECTNIL+1
         8 000102   000104 601000 8                  TNZ     s:9859

      197     9858    1          THEN ALTRETURN;                  /* No DCBs left...caller doesn't care */

   9858  8 000103   000000 702200 xent               TSX2  ! X66_AALT

      198     9859    1          ELSE CALL M$XXX;                 /* Should have had at least one       */

   9859  8 000104   000003 713400                    CLIMB   3
         8 000105   000000 401760                    pmme    nvectors=0

      199     9860    1      NEXT_DCB = FIRST_FREE_DCB;

   9860  8 000106   000000 235000 xsym               LDA     FIRST_FREE_DCB
         8 000107   200010 755100                    STA     NEXT_DCB,,AUTO

      200     9861    1      FIRST_FREE_DCB = DISK_DCBLIST.NEXT_IX(FIRST_FREE_DCB);

   9861  8 000110   000003 735000                    ALS     3
         8 000111   000003 235005 xsym               LDA     DISK_DCBLIST+3,AL
         8 000112   000000 755000 xsym               STA     FIRST_FREE_DCB

      201     9862
      202     9863        /***
      203     9864         *** Get ready for opening next file.
      204     9865         ***/
      205     9866
      206     9867    1      DISK_OPEN_NEXT.V.DCB# = DISK_DCBLIST.DCB#(NEXT_DCB);
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:49   

   9867  8 000113   200010 236100                    LDQ     NEXT_DCB,,AUTO
         8 000114   000003 736000                    QLS     3
         8 000115   000000 720006 xsym               LXL0    DISK_DCBLIST,QL
         8 000116   000044 740000 xsym               STX0    DISK_OPEN_NEXT+36

      207     9868    1      DISK_OPEN_NEXT.FPARAM_ = DISK_DCBLIST.FPARAM_(NEXT_DCB);

   9868  8 000117   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 000120   000005 735000                    ALS     5
         8 000121   000000 100405                    MLR     fill='000'O
         8 000122   000005 000010 xsym               ADSC9   DISK_DCBLIST+5,A         cn=0,n=8
         8 000123   000030 000010 xsym               ADSC9   DISK_OPEN_NEXT+24        cn=0,n=8

      208     9869    1      CURR_DCB$ = DISK_DCBLIST.DCB$(NEXT_DCB);

   9869  8 000124   000001 236006 xsym               LDQ     DISK_DCBLIST+1,QL
         8 000125   000136 756000 2                  STQ     CURR_DCB$

      209     9870
      210     9871        /***
      211     9872         *** Open the next file.  Remember any errors.
      212     9873         ***/
      213     9874
      214     9875    1      FOUND_FILE = '0'B;

   9875  8 000126   200011 450100                    STZ     FOUND_FILE,,AUTO

      215     9876    2      DO WHILE( NOT FOUND_FILE );

   9876  8 000127   001047 710000 8                  TRA     s:10114

      216     9877
      217     9878    2         IF ON_TO_NEXT_DP

   9878  8 000130   000000 234000 xsym               SZN     ON_TO_NEXT_DP
         8 000131   000222 605000 8                  TPL     s:9909
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:50   

      218     9879    3          THEN DO;                    /* Start with first range on next packset  */

      219     9880    3            DPLISTX = DPLISTX + 1;

   9880  8 000132   000000 054000 xsym               AOS     DPLISTX

      220     9881    3            IF DPLISTX >= DPLIST.NUM#

   9881  8 000133   000000 470400 xsym               LDP0    DPLIST$
         8 000134   000000 236000 xsym               LDQ     DPLISTX
         8 000135   000000 116100                    CMPQ    0,,PR0
         8 000136   000142 604000 8                  TMI     s:9886

      221     9882    4             THEN DO;                      /* No more packsets                   */

      222     9883    4               DISK_SEARCH_COMPLETE = '1'B;

   9883  8 000137   400000 236003                    LDQ     -131072,DU
         8 000140   000000 756000 xsym               STQ     DISK_SEARCH_COMPLETE

      223     9884    4               ALTRETURN;

   9884  8 000141   000000 702200 xent               TSX2  ! X66_AALT

      224     9885    4               END;
      225     9886    3            ON_TO_NEXT_DP = '0'B;

   9886  8 000142   000000 450000 xsym               STZ     ON_TO_NEXT_DP

      226     9887    3            DISK_SN.SN#(0) = DPLIST.SN#(DPLISTX);

   9887  8 000143   000006 402007                    MPY     6,DL
         8 000144   040000 100506                    MLR     fill='040'O
         8 000145   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
         8 000146   000001 000006 xsym               ADSC9   DISK_SN+1                cn=0,n=6

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:51   
      227     9888    3            DISK_OPEN_NEXT.V.RES# = DPRESLIST.NAME(DPLISTX);

   9888  8 000147   000000 471400 xsym               LDP1    DPRESLIST$
         8 000150   000000 720000 xsym               LXL0    DPLISTX
         8 000151   100001 236110                    LDQ     1,X0,PR1
         8 000152   000050 756000 xsym               STQ     DISK_OPEN_NEXT+40

      228     9889    3            SPECX = -1;

   9889  8 000153   000001 335007                    LCA     1,DL
         8 000154   000000 755000 xsym               STA     SPECX

      229     9890    3            ON_TO_NEXT_SPEC = '1'B;

   9890  8 000155   400000 236003                    LDQ     -131072,DU
         8 000156   000000 756000 xsym               STQ     ON_TO_NEXT_SPEC

      230     9891    3            PREVIOUS_ACCT.ACCT# = BINASC(0);

   9891  8 000157   000000 235000 9                  LDA     0
         8 000160   000035 236000 xsym               LDQ     B_VECTNIL+29
         8 000161   000000 755000 xsym               STA     PREVIOUS_ACCT
         8 000162   000001 756000 xsym               STQ     PREVIOUS_ACCT+1

      231     9892    3            IF DISK_OPTION.PAD

   9892  8 000163   000000 236000 xsym               LDQ     DISK_OPTION
         8 000164   020000 316003                    CANQ    8192,DU
         8 000165   000222 600000 8                  TZE     s:9909

      232     9893    4             THEN DO;                      /* Read the PAD                       */

      233     9894    4               READ_AD_OR_FD.FPARAM_ = DISK_OPEN_NEXT.FPARAM_;

   9894  8 000166   000030 237000 xsym               LDAQ    DISK_OPEN_NEXT+24
         8 000167   000030 757000 xsym               STAQ    READ_AD_OR_FD+24

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:52   
      234     9895    4               READ_AD_OR_FD.V.DCB# = DISK_OPEN_NEXT.V.DCB#;

   9895  8 000170   000044 221000 xsym               LDX1    DISK_OPEN_NEXT+36
         8 000171   000044 741000 xsym               STX1    READ_AD_OR_FD+36

      235     9896    4               DISK_ACCT.ACCT# = BINASC(0);

   9896  8 000172   000000 235000 9                  LDA     0
         8 000173   000035 236000 xsym               LDQ     B_VECTNIL+29
         8 000174   000000 755000 xsym               STA     DISK_ACCT
         8 000175   000001 756000 xsym               STQ     DISK_ACCT+1

      236     9897    4               FOUND_FILE = '1'B;

   9897  8 000176   400000 236003                    LDQ     -131072,DU
         8 000177   200011 756100                    STQ     FOUND_FILE,,AUTO

      237     9898    4               CALL M$OPEN( READ_AD_OR_FD )

   9898  8 000200   000000 630400 xsym               EPPR0   READ_AD_OR_FD
         8 000201   450000 713400                    CLIMB   alt,open
         8 000202   410400 401760                    pmme    nvectors=18
         8 000203   000214 702000 8                  TSX2    s:9904

      238     9899    5                WHENRETURN DO;

      239     9900    5                  DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;

   9900  8 000204   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 000205   000003 735000                    ALS     3
         8 000206   000002 450005 xsym               STZ     DISK_DCBLIST+2,AL

      240     9901    5                  DISK_DCBLIST.ERR.CODE(NEXT_DCB) = %E$ADEOF; /* PAD indicator   */

   9901  8 000207   000002 236005 xsym               LDQ     DISK_DCBLIST+2,AL
         8 000210   000002 376000 9                  ANQ     2
         8 000211   001750 276007                    ORQ     1000,DL
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:53   
         8 000212   000002 756005 xsym               STQ     DISK_DCBLIST+2,AL

      241     9902    5                  END;

   9902  8 000213   000222 710000 8                  TRA     s:9909

      242     9903    5                WHENALTRETURN DO;          /* Return error to caller             */

      243     9904    5                  DISK_DCBLIST.ERR(NEXT_DCB) = B$TCB.ALT$->B$ALT.ERR;

   9904  8 000214   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 000215   000003 735000                    ALS     3
         8 000216   000000 470400 xsym               LDP0    B$TCB$
         8 000217   000000 471500                    LDP1    0,,PR0
         8 000220   100102 236100                    LDQ     66,,PR1
         8 000221   000002 756005 xsym               STQ     DISK_DCBLIST+2,AL

      244     9905    5                  END;

      245     9906    4               END;

      246     9907    3            END;

      247     9908
      248     9909    2         IF ON_TO_NEXT_SPEC AND NOT FOUND_FILE /* Get next range spec'b by user? */

   9909  8 000222   000000 234000 xsym               SZN     ON_TO_NEXT_SPEC
         8 000223   000313 605000 8                  TPL     s:9941
         8 000224   200011 234100                    SZN     FOUND_FILE,,AUTO
         8 000225   000313 604000 8                  TMI     s:9941

      249     9910    3          THEN DO;

      250     9911    3            SPECX = SPECX + 1;

   9911  8 000226   000000 054000 xsym               AOS     SPECX

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:54   
      251     9912    3            IF SPECX >= DISK_FILE_SPEC.NBR

   9912  8 000227   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
         8 000230   000000 236000 xsym               LDQ     SPECX
         8 000231   000000 116100                    CMPQ    0,,PR0
         8 000232   000236 604000 8                  TMI     s:9917

      252     9913    4             THEN DO;            /* No more ranges...move on to next packset     */

      253     9914    4               ON_TO_NEXT_DP = '1'B;

   9914  8 000233   400000 236003                    LDQ     -131072,DU
         8 000234   000000 756000 xsym               STQ     ON_TO_NEXT_DP

      254     9915    4               END;

   9915  8 000235   000313 710000 8                  TRA     s:9941

      255     9916    4             ELSE DO;            /* Get ready for opening first file of range    */

      256     9917    4               DISK_OPEN_NEXT.V.INITZ.SCRUB# = '1'B;

   9917  8 000236   400000 236007                    LDQ     -131072,DL
         8 000237   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      257     9918    4               DISK_OPEN_NEXT.V.OPER.NXTA# = '0'B;

   9918  8 000240   000003 236000 9                  LDQ     3
         8 000241   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

      258     9919    4               ON_TO_NEXT_SPEC = '0'B;

   9919  8 000242   000000 450000 xsym               STZ     ON_TO_NEXT_SPEC

      259     9920    4               DISK_NAME.NAME# = DISK_FILE_SPEC.SPEC.START.FILE.NAME#(SPECX);

   9920  8 000243   000000 236000 xsym               LDQ     SPECX
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:55   
         8 000244   000124 402007                    MPY     84,DL
         8 000245   040000 100506                    MLR     fill='040'O
         8 000246   000010 000037                    ADSC9   8,Q,PR0                  cn=0,n=31
         8 000247   000000 200037 xsym               ADSC9   DISK_NAME                cn=1,n=31

      260     9921    4               DISK_NAME.L# = DISK_FILE_SPEC.SPEC.START.FILE.L#(SPECX);

   9921  8 000250   000000 236000 xsym               LDQ     SPECX
         8 000251   000025 402007                    MPY     21,DL
         8 000252   000017 236106                    LDQ     15,QL,PR0
         8 000253   000033 736000                    QLS     27
         8 000254   000000 552040 xsym               STBQ    DISK_NAME,'40'O

      261     9922    4               DISK_ACCT = DISK_FILE_SPEC.SPEC.START.ACCT(SPECX);

   9922  8 000255   000000 236000 xsym               LDQ     SPECX
         8 000256   000124 402007                    MPY     84,DL
         8 000257   000000 100506                    MLR     fill='000'O
         8 000260   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8
         8 000261   000000 000010 xsym               ADSC9   DISK_ACCT                cn=0,n=8

      262     9923        /***
      263     9924         *** Check if password specified on an [UN]STOW,[UN]FETCH or UNARCHIVE.
      264     9925         ***/
      265     9926    4               IF DISK_FILE_SPEC.PASSWORD_SPEC

   9926  8 000262   000002 234100                    SZN     2,,PR0
         8 000263   000272 605000 8                  TPL     s:9931

      266     9927    5                THEN DO;

      267     9928    5                  DISK_PASS.PASS# = DISK_FILE_SPEC.PASSWORD#;

   9928  8 000264   040000 100500                    MLR     fill='040'O
         8 000265   000002 200010                    ADSC9   2,,PR0                   cn=1,n=8
         8 000266   000000 000010 xsym               ADSC9   DISK_PASS                cn=0,n=8

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:56   
      268     9929    5                  DISK_OPEN_NEXT.PASS_ = VECTOR(DISK_PASS);

   9929  8 000267   000004 237000 9                  LDAQ    4
         8 000270   000010 757000 xsym               STAQ    DISK_OPEN_NEXT+8

      269     9930    5                  END;

   9930  8 000271   000274 710000 8                  TRA     s:9932

      270     9931    4                ELSE DISK_OPEN_NEXT.PASS_ = VECTOR(NIL);

   9931  8 000272   000006 237000 9                  LDAQ    6
         8 000273   000010 757000 xsym               STAQ    DISK_OPEN_NEXT+8

      271     9932    4               IF SPECX <= 0

   9932  8 000274   000000 235000 xsym               LDA     SPECX
         8 000275   000300 605400 8                  TPNZ    s:9934

      272     9933    4                THEN ANY_FILES_IN_ACCT = '0'B;

   9933  8 000276   000000 450000 xsym               STZ     ANY_FILES_IN_ACCT
         8 000277   000307 710000 8                  TRA     s:9936

      273     9934    4                ELSE IF DISK_FILE_SPEC.SPEC.START.ACCT(SPECX) ~= DISK_FILE_SPEC.SPEC.
              9934                         STOP.ACCT(SPECX-1)

   9934  8 000300   000000 236000 xsym               LDQ     SPECX
         8 000301   000124 402007                    MPY     84,DL
         8 000302   000106 106506                    CMPC    fill='000'O
         8 000303   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8
         8 000304   077773 000010                    ADSC9   -5,Q,PR0                 cn=0,n=8
         8 000305   000307 600000 8                  TZE     s:9936

      274     9935    4                   THEN ANY_FILES_IN_ACCT = '0'B;

   9935  8 000306   000000 450000 xsym               STZ     ANY_FILES_IN_ACCT
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:57   

      275     9936    4               DISK_OPEN_NEXT.V.OPER.NXTF# = '1'B;

   9936  8 000307   004000 236007                    LDQ     2048,DL
         8 000310   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      276     9937    4               DISK_OPEN_NEXT.V.OPER.THISF# = '1'B;

   9937  8 000311   002000 236007                    LDQ     1024,DL
         8 000312   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      277     9938    4               END;

      278     9939    3            END;

      279     9940
      280     9941    2         IF NOT ON_TO_NEXT_DP AND NOT FOUND_FILE

   9941  8 000313   000000 234000 xsym               SZN     ON_TO_NEXT_DP
         8 000314   000622 604000 8                  TMI     s:10045
         8 000315   200011 234100                    SZN     FOUND_FILE,,AUTO
         8 000316   000622 604000 8                  TMI     s:10045

      281     9942    3          THEN DO;

      282     9943    3            CALL M$OPEN( DISK_OPEN_NEXT )

   9943  8 000317   000000 630400 xsym               EPPR0   DISK_OPEN_NEXT
         8 000320   450000 713400                    CLIMB   alt,open
         8 000321   410400 401760                    pmme    nvectors=18
         8 000322   000447 702000 8                  TSX2    CHKERR

      283     9944    4             WHENRETURN DO;

      284     9945    4               DISK_OPEN_NEXT.V.INITZ.SCRUB# = '0'B;

   9945  8 000323   000010 236000 9                  LDQ     8
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:58   
         8 000324   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

      285     9946    4               DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;

   9946  8 000325   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 000326   000003 735000                    ALS     3
         8 000327   000002 450005 xsym               STZ     DISK_DCBLIST+2,AL

      286     9947    4               CODE = 0;

   9947  8 000330   200013 450100                    STZ     CODE,,AUTO

      287     9948    4               CALL FLN_CHECK_STOP

   9948  8 000331   001144 701000 8                  TSX1    FLN_CHECK_STOP
         8 000332   000426 702000 8                  TSX2    s:9985

      288     9949    5                WHENRETURN DO;

      289     9950    5                  ANY_FILES_IN_ACCT = '1'B;

   9950  8 000333   400000 236003                    LDQ     -131072,DU
         8 000334   000000 756000 xsym               STQ     ANY_FILES_IN_ACCT

      290     9951    5                  FOUND_FILE = '1'B;

   9951  8 000335   200011 756100                    STQ     FOUND_FILE,,AUTO

      291     9952        /***
      292     9953         *** SVMODIFY time is not init. to 0 if file in use by multiple users
      293     9954         *** (opened update,in) so testing for crash should not be performed.
      294     9955        ***/
      295     9956    5                  IF NOT F$DCB.DESC.DELF# AND

   9956  8 000336   000136 470400 2                  LDP0    CURR_DCB$
         8 000337   000005 236100                    LDQ     5,,PR0
         8 000340   400000 316007                    CANQ    -131072,DL
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:59   
         8 000341   000425 601000 8                  TNZ     s:9983
         8 000342   000045 236000 xsym               LDQ     DISK_OPEN_NEXT+37
         8 000343   777000 376007                    ANQ     -512,DL
         8 000344   001000 116007                    CMPQ    512,DL
         8 000345   000425 600000 8                  TZE     s:9983
         8 000346   000044 236000 xsym               LDQ     DISK_OPEN_NEXT+36
         8 000347   000030 376007                    ANQ     24,DL
         8 000350   000020 116007                    CMPQ    16,DL
         8 000351   000425 600000 8                  TZE     s:9983

      296     9957    5                    ( DISK_OPEN_NEXT.V.FUN# ~= %UPDATE# ) AND
      297     9958    5                    ( DISK_OPEN_NEXT.V.SHARE# ~= %IN# )
      298     9959    6                   THEN DO;

      299     9960    6                     CODE04$ = PINCRW( DISK_DCBLIST.FPARAM_.PTR$(NEXT_DCB), SIZEW(
              9960                              FM$GRAN) );

   9960  8 000352   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 000353   000003 735000                    ALS     3
         8 000354   000006 236005 xsym               LDQ     DISK_DCBLIST+6,AL
         8 000355   000005 036003                    ADLQ    5,DU
         8 000356   200015 756100                    STQ     CODE04$,,AUTO

      300     9961    6                     CALL XSF$LOCCODP( CODE04$, 04 )

   9961  8 000357   000011 236000 9                  LDQ     9
         8 000360   200021 756100                    STQ     CODE04$+4,,AUTO
         8 000361   200015 631500                    EPPR1   CODE04$,,AUTO
         8 000362   200020 451500                    STP1    CODE04$+3,,AUTO
         8 000363   200020 630500                    EPPR0   CODE04$+3,,AUTO
         8 000364   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000365   000000 701000 xent               TSX1    XSF$LOCCODP
         8 000366   000425 702000 8                  TSX2    s:9983

      301     9962    7                      WHENRETURN DO;

      302     9963    7                        IF CODE04.SVMODIFY.TIME ~= 0
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:60   

   9963  8 000367   200015 470500                    LDP0    CODE04$,,AUTO
         8 000370   000010 235100                    LDA     8,,PR0
         8 000371   000424 600000 8                  TZE     s:9978

      303     9964    8                         THEN DO;          /* Caught in crash...clean it up      */

      304     9965    8                           DISK_CLOSE_ORDINARY.V.DCB# = DISK_OPEN_NEXT.V.DCB#;

   9965  8 000372   000044 220000 xsym               LDX0    DISK_OPEN_NEXT+36
         8 000373   000032 740000 xsym               STX0    DISK_CLOSE_ORDINARY+26

      305     9966    8                           CALL M$CLOSE( DISK_CLOSE_ORDINARY )

   9966  8 000374   000000 630400 xsym               EPPR0   DISK_CLOSE_ORDINARY
         8 000375   450001 713400                    CLIMB   alt,close
         8 000376   406000 401760                    pmme    nvectors=13
         8 000377   000401 702000 8                  TSX2    s:9969
         8 000400   000401 710000 8                  TRA     s:9969

      306     9967    9                            WHENALTRETURN DO;

      307     9968    9                              END;

      308     9969    8                           DISK_OPEN_ORDINARY.V.ACS# = 0;

   9969  8 000401   000000 236003                    LDQ     0,DU
         8 000402   000046 552004 xsym               STBQ    DISK_OPEN_ORDINARY+38,'04'O

      309     9970    8                           DISK_OPEN_ORDINARY.V.DCB# = DISK_OPEN_NEXT.V.DCB#;

   9970  8 000403   000044 220000 xsym               LDX0    DISK_OPEN_NEXT+36
         8 000404   000044 740000 xsym               STX0    DISK_OPEN_ORDINARY+36

      310     9971    8                           CALL M$OPEN( DISK_OPEN_ORDINARY ) ALTRET( CHKERR );

   9971  8 000405   000000 630400 xsym               EPPR0   DISK_OPEN_ORDINARY
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:61   
         8 000406   450000 713400                    CLIMB   alt,open
         8 000407   410400 401760                    pmme    nvectors=18
         8 000410   000447 702000 8                  TSX2    CHKERR

      311     9972    8                           CALL M$CLOSE ( DISK_CLOSE_ORDINARY )

   9972  8 000411   000000 630400 xsym               EPPR0   DISK_CLOSE_ORDINARY
         8 000412   450001 713400                    CLIMB   alt,close
         8 000413   406000 401760                    pmme    nvectors=13
         8 000414   000416 702000 8                  TSX2    s:9975
         8 000415   000416 710000 8                  TRA     s:9975

      312     9973    9                            WHENALTRETURN DO;

      313     9974    9                              END;

      314     9975    8                           DISK_OPEN_ORDINARY.V.ACS# = %BLOCK#;

   9975  8 000416   000003 236007                    LDQ     3,DL
         8 000417   000046 552004 xsym               STBQ    DISK_OPEN_ORDINARY+38,'04'O

      315     9976    8                           CALL M$OPEN ( DISK_OPEN_ORDINARY )  ALTRET(CHKERR);

   9976  8 000420   000000 630400 xsym               EPPR0   DISK_OPEN_ORDINARY
         8 000421   450000 713400                    CLIMB   alt,open
         8 000422   410400 401760                    pmme    nvectors=18
         8 000423   000447 702000 8                  TSX2    CHKERR

      316     9977    8                           END;

      317     9978    7                        END;

   9978  8 000424   000425 710000 8                  TRA     s:9983

      318     9979    7                      WHENALTRETURN DO;

      319     9980                                                /* Not to worry                       */
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:62   
      320     9981    7                        END;

      321     9982    6                     END;

      322     9983    5                  END;

   9983  8 000425   000446 710000 8                  TRA     s:9995

      323     9984    5                WHENALTRETURN DO;

      324     9985    5                  ON_TO_NEXT_SPEC = '1'B;

   9985  8 000426   400000 236003                    LDQ     -131072,DU
         8 000427   000000 756000 xsym               STQ     ON_TO_NEXT_SPEC

      325     9986    5                  IF F$DCB.FCD#

   9986  8 000430   000136 470400 2                  LDP0    CURR_DCB$
         8 000431   000031 236100                    LDQ     25,,PR0
         8 000432   020000 316007                    CANQ    8192,DL
         8 000433   000446 600000 8                  TZE     s:9995

      326     9987    6                   THEN DO;                /* Close DCB                          */

      327     9988    6                     DISK_CLOSE_NEXT.V.DCB# = DISK_OPEN_NEXT.V.DCB#;

   9988  8 000434   000044 220000 xsym               LDX0    DISK_OPEN_NEXT+36
         8 000435   000032 740000 xsym               STX0    DISK_CLOSE_NEXT+26

      328     9989    6                     CALL M$CLOSE( DISK_CLOSE_NEXT )

   9989  8 000436   000000 630400 xsym               EPPR0   DISK_CLOSE_NEXT
         8 000437   450001 713400                    CLIMB   alt,close
         8 000440   406000 401760                    pmme    nvectors=13
         8 000441   000443 702000 8                  TSX2    s:9991
         8 000442   000446 710000 8                  TRA     s:9995

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:63   
      329     9990    7                      WHENALTRETURN DO;

      330     9991    7                        CALL FLI$RPT_ERR;

   9991  8 000443   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000444   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000445   000000 011000                    NOP     0

      331     9992    7                        END;

      332     9993    6                     END;

      333     9994    5                  END;

      334     9995    4               END;

   9995  8 000446   000622 710000 8                  TRA     s:10045

      335     9996    4             WHENALTRETURN DO;

   9989  8 000447                       CHKERR       null
      336     9997    4   CHKERR:     ;
      337     9998    4               DISK_OPEN_NEXT.V.INITZ.SCRUB# = '0'B;

   9998  8 000447   000010 236000 9                  LDQ     8
         8 000450   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

      338     9999    4               DISK_DCBLIST.ERR(NEXT_DCB) = B$TCB.ALT$->B$ALT.ERR;

   9999  8 000451   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 000452   000003 735000                    ALS     3
         8 000453   000000 470400 xsym               LDP0    B$TCB$
         8 000454   000000 471500                    LDP1    0,,PR0
         8 000455   100102 236100                    LDQ     66,,PR1
         8 000456   000002 756005 xsym               STQ     DISK_DCBLIST+2,AL

      339    10000    4               CODE = B$TCB.ALT$->B$ALT.ERR.CODE;
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:64   

  10000  8 000457   000000 471500                    LDP1    0,,PR0
         8 000460   100102 236100                    LDQ     66,,PR1
         8 000461   000003 772000                    QRL     3
         8 000462   037777 376007                    ANQ     16383,DL
         8 000463   200013 756100                    STQ     CODE,,AUTO

      340    10001    4               CALL FLN_CHECK_STOP

  10001  8 000464   001144 701000 8                  TSX1    FLN_CHECK_STOP
         8 000465   000467 702000 8                  TSX2    s:10003
         8 000466   000501 710000 8                  TRA     s:10006

      341    10002    5                WHENALTRETURN DO;

      342    10003    5                  IF CODE ~= %E$NOFILE AND CODE ~= %E$FDEOF AND CODE ~= %E$NOKEY AND
             10003                           CODE ~= %E$ADEOF

  10003  8 000467   200013 235100                    LDA     CODE,,AUTO
         8 000470   000161 115007                    CMPA    113,DL
         8 000471   000501 600000 8                  TZE     s:10006
         8 000472   000154 115007                    CMPA    108,DL
         8 000473   000501 600000 8                  TZE     s:10006
         8 000474   000102 115007                    CMPA    66,DL
         8 000475   000501 600000 8                  TZE     s:10006
         8 000476   000175 115007                    CMPA    125,DL
         8 000477   000501 600000 8                  TZE     s:10006

      343    10004    5                   THEN CODE = 0;

  10004  8 000500   200013 450100                    STZ     CODE,,AUTO

      344    10005    5                  END;

      345    10006    4               IF CODE = %E$STOWEDFILE

  10006  8 000501   200013 235100                    LDA     CODE,,AUTO
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:65   
         8 000502   000202 115007                    CMPA    130,DL
         8 000503   000507 601000 8                  TNZ     s:10008

      346    10007    4                THEN DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;
             10007                         /* Ignore error - file exists */

  10007  8 000504   200010 236100                    LDQ     NEXT_DCB,,AUTO
         8 000505   000003 736000                    QLS     3
         8 000506   000002 450006 xsym               STZ     DISK_DCBLIST+2,QL

      347    10008    4               IF CODE = %E$FDEOF OR CODE = %E$NOKEY

  10008  8 000507   000154 115007                    CMPA    108,DL
         8 000510   000513 600000 8                  TZE     s:10010
         8 000511   000102 115007                    CMPA    66,DL
         8 000512   000606 601000 8                  TNZ     s:10033

      348    10009    5                THEN DO;                   /* File directory end or not there    */

      349    10010    5                  DISK_NAME.NAME# = ' ';   /* Reset file name for next account   */

  10010  8 000513   040000 100400                    MLR     fill='040'O
         8 000514   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 000515   000000 200037 xsym               ADSC9   DISK_NAME                cn=1,n=31

      350    10011    5                  DISK_NAME.L# = 0;

  10011  8 000516   000000 236003                    LDQ     0,DU
         8 000517   000000 552040 xsym               STBQ    DISK_NAME,'40'O

      351    10012    5                  DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;

  10012  8 000520   010000 236007                    LDQ     4096,DL
         8 000521   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      352    10013    5                  READ_AD_OR_FD.FPARAM_ = DISK_OPEN_NEXT.FPARAM_;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:66   
  10013  8 000522   000030 237000 xsym               LDAQ    DISK_OPEN_NEXT+24
         8 000523   000030 757000 xsym               STAQ    READ_AD_OR_FD+24

      353    10014    5                  READ_AD_OR_FD.V.DCB# = DISK_OPEN_NEXT.V.DCB#;

  10014  8 000524   000044 220000 xsym               LDX0    DISK_OPEN_NEXT+36
         8 000525   000044 740000 xsym               STX0    READ_AD_OR_FD+36

      354    10015    5                  CALL M$OPEN( READ_AD_OR_FD )

  10015  8 000526   000000 630400 xsym               EPPR0   READ_AD_OR_FD
         8 000527   450000 713400                    CLIMB   alt,open
         8 000530   410400 401760                    pmme    nvectors=18
         8 000531   000533 702000 8                  TSX2    s:10020

      355    10016    6                   WHENRETURN DO;

      356    10017                                                /* Account really does exist          */
      357    10018    6                     END;

  10018  8 000532   000546 710000 8                  TRA     s:10025

      358    10019    6                   WHENALTRETURN DO;

      359    10020    6                     IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

  10020  8 000533   000000 470400 xsym               LDP0    B$TCB$
         8 000534   000000 471500                    LDP1    0,,PR0
         8 000535   100102 236100                    LDQ     66,,PR1
         8 000536   377770 376007                    ANQ     131064,DL
         8 000537   001020 116007                    CMPQ    528,DL
         8 000540   000546 601000 8                  TNZ     s:10025

      360    10021    6                      THEN IF F$DCB.EXPIRE# ~= 0

  10021  8 000541   000136 473400 2                  LDP3    CURR_DCB$
         8 000542   300035 235100                    LDA     29,,PR3
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:67   
         8 000543   000546 600000 8                  TZE     s:10025

      361    10022    6                         THEN CODE = %E$NOKEY; /* A deleted account              */

  10022  8 000544   000102 235007                    LDA     66,DL
         8 000545   200013 755100                    STA     CODE,,AUTO

      362    10023    6                         ELSE ;            /* Account really doesn't exist       */
      363    10024    6                     END;

      364    10025    5                  IF F$DCB.ACCT# >= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(SPECX)

  10025  8 000546   000000 236000 xsym               LDQ     SPECX
         8 000547   000124 402007                    MPY     84,DL
         8 000550   000136 470400 2                  LDP0    CURR_DCB$
         8 000551   000000 471400 xsym               LDP1    DISK_FILE_SPEC$
         8 000552   040106 106500                    CMPC    fill='040'O
         8 000553   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         8 000554   100020 000010                    ADSC9   16,Q,PR1                 cn=0,n=8
         8 000555   000560 602000 8                  TNC     s:10027

      365    10026    5                   THEN ON_TO_NEXT_SPEC = '1'B; /* Done with range               */

  10026  8 000556   400000 236003                    LDQ     -131072,DU
         8 000557   000000 756000 xsym               STQ     ON_TO_NEXT_SPEC

      366    10027    5                  IF F$DCB.ACCT# <= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(SPECX)

  10027  8 000560   000000 236000 xsym               LDQ     SPECX
         8 000561   000124 402007                    MPY     84,DL
         8 000562   040100 106506                    CMPC    fill='040'O
         8 000563   100020 000010                    ADSC9   16,Q,PR1                 cn=0,n=8
         8 000564   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         8 000565   000604 602000 8                  TNC     s:10031

      367    10028    5                   THEN IF (CODE = %E$FDEOF AND DISK_OPTION.DIR AND NOT
             10028                            ANY_FILES_IN_ACCT)
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:68   

  10028  8 000566   200013 235100                    LDA     CODE,,AUTO
         8 000567   000154 115007                    CMPA    108,DL
         8 000570   000575 601000 8                  TNZ     s:10028+7
         8 000571   000000 234000 xsym               SZN     DISK_OPTION
         8 000572   000575 605000 8                  TPL     s:10028+7
         8 000573   000000 234000 xsym               SZN     ANY_FILES_IN_ACCT
         8 000574   000602 605000 8                  TPL     s:10030
         8 000575   000102 115007                    CMPA    66,DL
         8 000576   000604 601000 8                  TNZ     s:10031
         8 000577   000000 236000 xsym               LDQ     DISK_OPTION
         8 000600   200000 316003                    CANQ    65536,DU
         8 000601   000604 600000 8                  TZE     s:10031

      368    10029    5                       OR (CODE = %E$NOKEY AND DISK_OPTION.DELETED_ACCOUNTS)
      369    10030    5                      THEN FOUND_FILE = '1'B;

  10030  8 000602   400000 236003                    LDQ     -131072,DU
         8 000603   200011 756100                    STQ     FOUND_FILE,,AUTO

      370    10031    5                  ANY_FILES_IN_ACCT = '0'B;

  10031  8 000604   000000 450000 xsym               STZ     ANY_FILES_IN_ACCT

      371    10032    5                  END;

  10032  8 000605   000622 710000 8                  TRA     s:10045

      372    10033    4                ELSE IF CODE = %E$ADEOF

  10033  8 000606   000175 115007                    CMPA    125,DL
         8 000607   000613 601000 8                  TNZ     s:10035

      373    10034    4                   THEN ON_TO_NEXT_DP = '1'B; /* End of packset...on to next     */

  10034  8 000610   400000 236003                    LDQ     -131072,DU
         8 000611   000000 756000 xsym               STQ     ON_TO_NEXT_DP
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:69   
         8 000612   000622 710000 8                  TRA     s:10045

      374    10035    4                   ELSE IF CODE = 0

  10035  8 000613   000000 115003                    CMPA    0,DU
         8 000614   000620 601000 8                  TNZ     s:10037

      375    10036    4                      THEN ON_TO_NEXT_SPEC = '1'B; /* Didn't want file anyway    */

  10036  8 000615   400000 236003                    LDQ     -131072,DU
         8 000616   000000 756000 xsym               STQ     ON_TO_NEXT_SPEC
         8 000617   000622 710000 8                  TRA     s:10045

      376    10037    4                      ELSE FOUND_FILE = '1'B;

  10037  8 000620   400000 236003                    LDQ     -131072,DU
         8 000621   200011 756100                    STQ     FOUND_FILE,,AUTO

      377    10038    4               END;

      378    10039    3            END;

      379    10040
      380    10041        /***
      381    10042         *** Special handling for account changes if DIR specified.
      382    10043         ***/
      383    10044
      384    10045    2         IF FOUND_FILE

  10045  8 000622   200011 234100                    SZN     FOUND_FILE,,AUTO
         8 000623   001047 605000 8                  TPL     s:10114

      385    10046    3          THEN DO;

      386    10047    3            IF DISK_OPTION.DIR OR DISK_OPTION.DELETED_ACCOUNTS

  10047  8 000624   000000 234000 xsym               SZN     DISK_OPTION
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:70   
         8 000625   000640 604000 8                  TMI     s:10051
         8 000626   000000 236000 xsym               LDQ     DISK_OPTION
         8 000627   200000 316003                    CANQ    65536,DU
         8 000630   000640 601000 8                  TNZ     s:10051
         8 000631   000002 236000 xsym               LDQ     DISK_OPTION+2
         8 000632   004000 316003                    CANQ    2048,DU
         8 000633   000640 601000 8                  TNZ     s:10051
         8 000634   002000 316003                    CANQ    1024,DU
         8 000635   000640 601000 8                  TNZ     s:10051
         8 000636   000002 430000 xsym               FSZN    DISK_OPTION+2
         8 000637   001045 605000 8                  TPL     s:10112

      387    10048    3              OR DISK_OPTION.SKIP_NO_BACKUP OR DISK_OPTION.SKIP_NO_STOW
      388    10049    3              OR DISK_OPTION.SKIP_NO_PURGE
      389    10050    4             THEN DO;

      390    10051    4               RESET_PREVIOUS_ACCT = '0'B;

  10051  8 000640   200012 450100                    STZ     RESET_PREVIOUS_ACCT,,AUTO

      391    10052    4               IF PREVIOUS_ACCT.ACCT# ~= F$DCB.ACCT#

  10052  8 000641   000136 470400 2                  LDP0    CURR_DCB$
         8 000642   040100 106400                    CMPC    fill='040'O
         8 000643   000000 000010 xsym               ADSC9   PREVIOUS_ACCT            cn=0,n=8
         8 000644   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         8 000645   001047 600000 8                  TZE     s:10114

      392    10053    5                THEN DO;                   /* Must get FD for account            */

      393    10054    5                  IF CODE = %E$FDEOF OR CODE = %E$NOKEY

  10054  8 000646   200013 235100                    LDA     CODE,,AUTO
         8 000647   000154 115007                    CMPA    108,DL
         8 000650   000653 600000 8                  TZE     s:10055
         8 000651   000102 115007                    CMPA    66,DL
         8 000652   000656 601000 8                  TNZ     s:10056
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:71   

      394    10055    5                   THEN DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;

  10055  8 000653   000012 236000 9                  LDQ     10
         8 000654   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36
         8 000655   000660 710000 8                  TRA     s:10057

      395    10056    5                   ELSE DISK_OPEN_NEXT.V.OPER.THISF# = '1'B; /* Reopen current file */

  10056  8 000656   002000 236007                    LDQ     1024,DL
         8 000657   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      396    10057    5                  IF F$DCB.FCD#

  10057  8 000660   000031 236100                    LDQ     25,,PR0
         8 000661   020000 316007                    CANQ    8192,DL
         8 000662   000675 600000 8                  TZE     s:10065

      397    10058    6                   THEN DO;                /* Close DCB...will use it to get FD  */

      398    10059    6                     DISK_CLOSE_NEXT.V.DCB# = DISK_OPEN_NEXT.V.DCB#;

  10059  8 000663   000044 220000 xsym               LDX0    DISK_OPEN_NEXT+36
         8 000664   000032 740000 xsym               STX0    DISK_CLOSE_NEXT+26

      399    10060    6                     CALL M$CLOSE( DISK_CLOSE_NEXT )

  10060  8 000665   000000 630400 xsym               EPPR0   DISK_CLOSE_NEXT
         8 000666   450001 713400                    CLIMB   alt,close
         8 000667   406000 401760                    pmme    nvectors=13
         8 000670   000672 702000 8                  TSX2    s:10062
         8 000671   000675 710000 8                  TRA     s:10065

      400    10061    7                      WHENALTRETURN DO;

      401    10062    7                        CALL FLI$RPT_ERR;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:72   
  10062  8 000672   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000673   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000674   000000 011000                    NOP     0

      402    10063    7                        END;

      403    10064    6                     END;

      404    10065    5                  READ_AD_OR_FD.FPARAM_ = DISK_OPEN_NEXT.FPARAM_;

  10065  8 000675   000030 237000 xsym               LDAQ    DISK_OPEN_NEXT+24
         8 000676   000030 757000 xsym               STAQ    READ_AD_OR_FD+24

      405    10066    5                  READ_AD_OR_FD.V.DCB# = DISK_OPEN_NEXT.V.DCB#;

  10066  8 000677   000044 220000 xsym               LDX0    DISK_OPEN_NEXT+36
         8 000700   000044 740000 xsym               STX0    READ_AD_OR_FD+36

      406    10067    5                  CALL M$OPEN( READ_AD_OR_FD )

  10067  8 000701   000000 630400 xsym               EPPR0   READ_AD_OR_FD
         8 000702   450000 713400                    CLIMB   alt,open
         8 000703   410400 401760                    pmme    nvectors=18
         8 000704   001001 702000 8                  TSX2    s:10099

      407    10068    6                   WHENRETURN DO;          /* Get FD                             */

      408    10069    6                     DISK_DCBLIST.ERR(NEXT_DCB) = '0'B;

  10069  8 000705   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 000706   000003 735000                    ALS     3
         8 000707   000002 450005 xsym               STZ     DISK_DCBLIST+2,AL

      409    10070    6                     DISK_DCBLIST.ERR.CODE(NEXT_DCB) = %E$FDEOF; /* FD indicator */

  10070  8 000710   000002 236005 xsym               LDQ     DISK_DCBLIST+2,AL
         8 000711   000002 376000 9                  ANQ     2
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:73   
         8 000712   001540 276007                    ORQ     864,DL
         8 000713   000002 756005 xsym               STQ     DISK_DCBLIST+2,AL

      410    10071    6                     ACCT_CODE14$ = DISK_DCBLIST.FPARAM_.PTR$(NEXT_DCB);

  10071  8 000714   000006 236005 xsym               LDQ     DISK_DCBLIST+6,AL
         8 000715   200014 756100                    STQ     ACCT_CODE14$,,AUTO

      411    10072    6                     CALL XSF$LOCCODP( ACCT_CODE14$, 14 )

  10072  8 000716   000014 236000 9                  LDQ     12
         8 000717   200021 756100                    STQ     CODE04$+4,,AUTO
         8 000720   200014 630500                    EPPR0   ACCT_CODE14$,,AUTO
         8 000721   200020 450500                    STP0    CODE04$+3,,AUTO
         8 000722   200020 630500                    EPPR0   CODE04$+3,,AUTO
         8 000723   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000724   000000 701000 xent               TSX1    XSF$LOCCODP
         8 000725   001000 702000 8                  TSX2    s:10097

      412    10073    7                      WHENRETURN DO;

      413    10074    7                        IF (DISK_OPTION.SKIP_NO_BACKUP AND NOT CODE14.ACCESS.BUPF)

  10074  8 000726   000002 236000 xsym               LDQ     DISK_OPTION+2
         8 000727   004000 316003                    CANQ    2048,DU
         8 000730   000753 600000 8                  TZE     s:10085
         8 000731   200014 470500                    LDP0    ACCT_CODE14$,,AUTO
         8 000732   000000 236100                    LDQ     0,,PR0
         8 000733   040000 316003                    CANQ    16384,DU
         8 000734   000753 601000 8                  TNZ     s:10085

      414    10075    8                         THEN DO;

      415    10076    8                           DISK_NAME.L# = 0;

  10076  8 000735   000000 236003                    LDQ     0,DU
         8 000736   000000 552040 xsym               STBQ    DISK_NAME,'40'O
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:74   

      416    10077    8                           DISK_NAME.NAME# = ' ';

  10077  8 000737   040000 100400                    MLR     fill='040'O
         8 000740   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 000741   000000 200037 xsym               ADSC9   DISK_NAME                cn=1,n=31

      417    10078    8                           RESET_PREVIOUS_ACCT = '1'B ; /* Forces chking of nxt FD */

  10078  8 000742   400000 236003                    LDQ     -131072,DU
         8 000743   200012 756100                    STQ     RESET_PREVIOUS_ACCT,,AUTO

      418    10079    8                           DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;

  10079  8 000744   010000 236007                    LDQ     4096,DL
         8 000745   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      419    10080    8                           IF NOT DISK_OPTION.SAVE_DIR /* FD saved on SAVE and   */

  10080  8 000746   000002 236000 xsym               LDQ     DISK_OPTION+2
         8 000747   000200 316003                    CANQ    128,DU
         8 000750   000777 601000 8                  TNZ     s:10094

      420    10081    8                            THEN           /* BACKUP but not files.              */
      421    10082    8                              FOUND_FILE = '0'B;

  10082  8 000751   200011 450100                    STZ     FOUND_FILE,,AUTO

      422    10083    8                           END;

  10083  8 000752   000777 710000 8                  TRA     s:10094

      423    10084    8                         ELSE DO;

      424    10085    8                           IF (DISK_OPTION.SKIP_NO_STOW AND CODE14.ACCESS.NOSTOW)

  10085  8 000753   000002 236000 xsym               LDQ     DISK_OPTION+2
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:75   
         8 000754   002000 316003                    CANQ    1024,DU
         8 000755   000761 600000 8                  TZE     s:10085+6
         8 000756   200014 470500                    LDP0    ACCT_CODE14$,,AUTO
         8 000757   000000 430100                    FSZN    0,,PR0
         8 000760   000767 604000 8                  TMI     s:10088
         8 000761   000002 430000 xsym               FSZN    DISK_OPTION+2
         8 000762   000777 605000 8                  TPL     s:10094
         8 000763   200014 470500                    LDP0    ACCT_CODE14$,,AUTO
         8 000764   000000 236100                    LDQ     0,,PR0
         8 000765   010000 316003                    CANQ    4096,DU
         8 000766   000777 600000 8                  TZE     s:10094

      425    10086    8                             OR (DISK_OPTION.SKIP_NO_PURGE AND CODE14.ACCESS.NPUR)
      426    10087    9                            THEN DO;       /* Skip no backup account             */

      427    10088    9                              FOUND_FILE = '0'B;

  10088  8 000767   200011 450100                    STZ     FOUND_FILE,,AUTO

      428    10089    9                              DISK_NAME.L# = 0;

  10089  8 000770   000000 236003                    LDQ     0,DU
         8 000771   000000 552040 xsym               STBQ    DISK_NAME,'40'O

      429    10090    9                              DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;

  10090  8 000772   010000 236007                    LDQ     4096,DL
         8 000773   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      430    10091    9                              DISK_NAME.NAME# = ' ';

  10091  8 000774   040000 100400                    MLR     fill='040'O
         8 000775   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 000776   000000 200037 xsym               ADSC9   DISK_NAME                cn=1,n=31

      431    10092    9                              END;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:76   
      432    10093    8                           END;

      433    10094    7                        END;

  10094  8 000777   001000 710000 8                  TRA     s:10097

      434    10095    7                      WHENALTRETURN DO;

      435    10096    7                        END;

      436    10097    6                     END;

  10097  8 001000   001023 710000 8                  TRA     s:10105

      437    10098    6                   WHENALTRETURN DO;

      438    10099    6                     IF CODE = %E$FDEOF AND B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

  10099  8 001001   200013 235100                    LDA     CODE,,AUTO
         8 001002   000154 115007                    CMPA    108,DL
         8 001003   001014 601000 8                  TNZ     s:10103
         8 001004   000000 470400 xsym               LDP0    B$TCB$
         8 001005   000000 471500                    LDP1    0,,PR0
         8 001006   100102 236100                    LDQ     66,,PR1
         8 001007   377770 376007                    ANQ     131064,DL
         8 001010   001020 116007                    CMPQ    528,DL
         8 001011   001014 601000 8                  TNZ     s:10103

      439    10100    7                      THEN DO;
             10100                               /* Only happens if attempted to open nonexistent account */

      440    10101    7                        FOUND_FILE = '0'B;

  10101  8 001012   200011 450100                    STZ     FOUND_FILE,,AUTO

      441    10102    7                        END;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:77   
  10102  8 001013   001023 710000 8                  TRA     s:10105

      442    10103    6                      ELSE DISK_DCBLIST.ERR(NEXT_DCB) = B$TCB.ALT$->B$ALT.ERR;

  10103  8 001014   200010 236100                    LDQ     NEXT_DCB,,AUTO
         8 001015   000003 736000                    QLS     3
         8 001016   000000 470400 xsym               LDP0    B$TCB$
         8 001017   000000 471500                    LDP1    0,,PR0
         8 001020   000000 620006                    EAX0    0,QL
         8 001021   100102 236100                    LDQ     66,,PR1
         8 001022   000002 756010 xsym               STQ     DISK_DCBLIST+2,X0

      443    10104    6                     END;

      444    10105    5                  IF RESET_PREVIOUS_ACCT

  10105  8 001023   200012 234100                    SZN     RESET_PREVIOUS_ACCT,,AUTO
         8 001024   001032 605000 8                  TPL     s:10107

      445    10106    5                   THEN PREVIOUS_ACCT.ACCT# = ' ';

  10106  8 001025   000035 235000 xsym               LDA     B_VECTNIL+29
         8 001026   000035 236000 xsym               LDQ     B_VECTNIL+29
         8 001027   000000 755000 xsym               STA     PREVIOUS_ACCT
         8 001030   000001 756000 xsym               STQ     PREVIOUS_ACCT+1
         8 001031   001036 710000 8                  TRA     s:10108

      446    10107    5                   ELSE PREVIOUS_ACCT.ACCT# = F$DCB.ACCT#;

  10107  8 001032   000136 470400 2                  LDP0    CURR_DCB$
         8 001033   000020 237100                    LDAQ    16,,PR0
         8 001034   000000 755000 xsym               STA     PREVIOUS_ACCT
         8 001035   000001 756000 xsym               STQ     PREVIOUS_ACCT+1

      447    10108    5                  IF NOT (DISK_OPTION.DIR OR DISK_OPTION.DELETED_ACCOUNTS)

  10108  8 001036   000000 234000 xsym               SZN     DISK_OPTION
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:78   
         8 001037   001047 604000 8                  TMI     s:10114
         8 001040   000000 236000 xsym               LDQ     DISK_OPTION
         8 001041   200000 316003                    CANQ    65536,DU
         8 001042   001047 601000 8                  TNZ     s:10114

      448    10109    5                   THEN FOUND_FILE = '0'B;

  10109  8 001043   200011 450100                    STZ     FOUND_FILE,,AUTO

      449    10110    5                  END;

      450    10111    4               END;

  10111  8 001044   001047 710000 8                  TRA     s:10114

      451    10112    3             ELSE DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;

  10112  8 001045   000012 236000 9                  LDQ     10
         8 001046   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

      452    10113    3            END;

      453    10114    2         END;

  10114  8 001047   200011 234100                    SZN     FOUND_FILE,,AUTO
         8 001050   000130 605000 8                  TPL     s:9878

      454    10115
      455    10116    1      LAST_DCB = NEXT_DCB;

  10116  8 001051   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 001052   000000 755000 xsym               STA     LAST_DCB

      456    10117
      457    10118        /***
      458    10119         *** If called with parameters, return values.  If not, link
      459    10120         *** open DCB to open DCB list.
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:79   
      460    10121         ***/
      461    10122
      462    10123    1      IF ADDR(DCB$) ~= ADDR(NIL)

  10123  8 001053   200003 236100                    LDQ     @DCB$,,AUTO
         8 001054   000001 116000 xsym               CMPQ    B_VECTNIL+1
         8 001055   001125 600000 8                  TZE     s:10140

      463    10124    2       THEN DO;                            /* Return values                      */

      464    10125    2         DCB$ = DISK_DCBLIST.DCB$(NEXT_DCB);

  10125  8 001056   000003 735000                    ALS     3
         8 001057   000001 236005 xsym               LDQ     DISK_DCBLIST+1,AL
         8 001060   200003 470500                    LDP0    @DCB$,,AUTO
         8 001061   000000 756100                    STQ     0,,PR0

      465    10126    2         BREAK_DCB# = DISK_DCBLIST.DCB#(NEXT_DCB);

  10126  8 001062   000000 235005 xsym               LDA     DISK_DCBLIST,AL
         8 001063   000000 755000 xsym               STA     BREAK_DCB#

      466    10127    2         DCB# = BREAK_DCB#;

  10127  8 001064   200004 471500                    LDP1    @DCB#,,AUTO
         8 001065   100000 755100                    STA     0,,PR1

      467    10128    2         FPARAM_ = DISK_DCBLIST.FPARAM_(NEXT_DCB);

  10128  8 001066   200010 236100                    LDQ     NEXT_DCB,,AUTO
         8 001067   000005 736000                    QLS     5
         8 001070   200006 473500                    LDP3    @FPARAM_,,AUTO
         8 001071   000100 100406                    MLR     fill='000'O
         8 001072   000005 000010 xsym               ADSC9   DISK_DCBLIST+5,Q         cn=0,n=8
         8 001073   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8

      468    10129    2         ERR = DISK_DCBLIST.ERR(NEXT_DCB);
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:80   

  10129  8 001074   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 001075   000003 735000                    ALS     3
         8 001076   000002 236005 xsym               LDQ     DISK_DCBLIST+2,AL
         8 001077   200007 474500                    LDP4    @ERR,,AUTO
         8 001100   400000 756100                    STQ     0,,PR4

      469    10130    2         DISK_DCBLIST.NEXT_IX(NEXT_DCB) = -1;

  10130  8 001101   000001 336007                    LCQ     1,DL
         8 001102   000003 756005 xsym               STQ     DISK_DCBLIST+3,AL

      470    10131    2         DCBN = NEXT_DCB;

  10131  8 001103   200005 475500                    LDP5    @DCBN,,AUTO
         8 001104   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 001105   500000 755100                    STA     0,,PR5

      471    10132    2         IF DCB$->F$DCB.ACCT# ~= BINASC(0)

  10132  8 001106   000000 476500                    LDP6    0,,PR0
         8 001107   600020 237100                    LDAQ    16,,PR6
         8 001110   000000 117000 9                  CMPAQ   0
         8 001111   001143 600000 8                  TZE     s:10151

      472    10133    3          THEN DO;

      473    10134    3            DISK_ACCT_LAST.ACCT# = DCB$->F$DCB.ACCT#;

  10134  8 001112   600020 237100                    LDAQ    16,,PR6
         8 001113   000000 755000 xsym               STA     DISK_ACCT_LAST
         8 001114   000001 756000 xsym               STQ     DISK_ACCT_LAST+1

      474    10135    3            IF DISK_ACCT_FIRST.ACCT# = ' '

  10135  8 001115   040000 106400                    CMPC    fill='040'O
         8 001116   000000 000010 xsym               ADSC9   DISK_ACCT_FIRST          cn=0,n=8
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:81   
         8 001117   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 001120   001143 601000 8                  TNZ     s:10151

      475    10136    3             THEN DISK_ACCT_FIRST = DISK_ACCT_LAST;

  10136  8 001121   000000 100400                    MLR     fill='000'O
         8 001122   000000 000010 xsym               ADSC9   DISK_ACCT_LAST           cn=0,n=8
         8 001123   000000 000010 xsym               ADSC9   DISK_ACCT_FIRST          cn=0,n=8

      476    10137    3            END;

      477    10138    2         END;

  10138  8 001124   001143 710000 8                  TRA     s:10151

      478    10139    2       ELSE DO;                            /* Link to open DCB list              */

      479    10140    2         IF LAST_OPEN_DCB < 0

  10140  8 001125   000000 235000 xsym               LDA     LAST_OPEN_DCB
         8 001126   001133 605000 8                  TPL     s:10146

      480    10141    3          THEN DO;                         /* Completely new open DCB list       */

      481    10142    3            NEXT_OPEN_DCB = NEXT_DCB;

  10142  8 001127   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 001130   000000 755000 xsym               STA     NEXT_OPEN_DCB

      482    10143    3            LAST_OPEN_DCB = NEXT_DCB;

  10143  8 001131   000000 755000 xsym               STA     LAST_OPEN_DCB

      483    10144    3            END;

  10144  8 001132   001137 710000 8                  TRA     s:10149

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:82   
      484    10145    3          ELSE DO;                         /* Add to end of open DCB list        */

      485    10146    3            DISK_DCBLIST.NEXT_IX(LAST_OPEN_DCB) = NEXT_DCB;

  10146  8 001133   000003 735000                    ALS     3
         8 001134   200010 236100                    LDQ     NEXT_DCB,,AUTO
         8 001135   000003 756005 xsym               STQ     DISK_DCBLIST+3,AL

      486    10147    3            LAST_OPEN_DCB = NEXT_DCB;

  10147  8 001136   000000 756000 xsym               STQ     LAST_OPEN_DCB

      487    10148    3            END;

      488    10149    2         DISK_DCBLIST.NEXT_IX(NEXT_DCB) = -1;

  10149  8 001137   200010 235100                    LDA     NEXT_DCB,,AUTO
         8 001140   000003 735000                    ALS     3
         8 001141   000001 336007                    LCQ     1,DL
         8 001142   000003 756005 xsym               STQ     DISK_DCBLIST+3,AL

      489    10150    2         END;

      490    10151    1      RETURN;

  10151  8 001143   000000 702200 xent               TSX2  ! X66_ARET

      491    10152
      492    10153    1   FLN_CHECK_STOP: PROC ALTRET;

  10153  8 001144   200016 741300       FLN_CHECK_S* STX1  ! CODE04$+1,,AUTO

      493    10154
      494    10155        /********************/
      495    10156
      496    10157    2      DISK_OPEN_NEXT.V.OPER.NXTA# = '0'B;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:83   
  10157  8 001145   000003 236000 9                  LDQ     3
         8 001146   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

      497    10158    2      DISK_OPEN_NEXT.V.OPER.NXTF# = '1'B;

  10158  8 001147   004000 236007                    LDQ     2048,DL
         8 001150   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      498    10159    2      DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;

  10159  8 001151   000012 236000 9                  LDQ     10
         8 001152   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

      499    10160    2      DISK_NAME = F$DCB.NAME#;

  10160  8 001153   000136 470400 2                  LDP0    CURR_DCB$
         8 001154   000000 100500                    MLR     fill='000'O
         8 001155   000010 000040                    ADSC9   8,,PR0                   cn=0,n=32
         8 001156   000000 000040 xsym               ADSC9   DISK_NAME                cn=0,n=32

      500    10161    2      DISK_ACCT.ACCT# = F$DCB.ACCT#;

  10161  8 001157   000020 237100                    LDAQ    16,,PR0
         8 001160   000000 755000 xsym               STA     DISK_ACCT
         8 001161   000001 756000 xsym               STQ     DISK_ACCT+1

      501    10162    2      SPEC.STOP.ACCT.ACCT# = F$DCB.ACCT#;

  10162  8 001162   000020 237100                    LDAQ    16,,PR0
         8 001163   000013 755000 xsym               STA     SPECCHARS+11
         8 001164   000014 756000 xsym               STQ     SPECCHARS+12

      502    10163    2      SPEC.STOP.FILE.NAME# = F$DCB.NAME#.C;

  10163  8 001165   040000 100500                    MLR     fill='040'O
         8 001166   000010 200037                    ADSC9   8,,PR0                   cn=1,n=31
         8 001167   000015 000037 xsym               ADSC9   SPECCHARS+13             cn=0,n=31
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:84   

      503    10164    2      SPEC.STOP.FILE.L# = F$DCB.NAME#.L;

  10164  8 001170   000010 236100                    LDQ     8,,PR0
         8 001171   000033 772000                    QRL     27
         8 001172   000024 552004 xsym               STBQ    SPECCHARS+20,'04'O

      504    10165    2      IF SPEC.STOP > DISK_FILE_SPEC.SPEC.STOP(SPECX)

  10165  8 001173   000000 236000 xsym               LDQ     SPECX
         8 001174   000124 402007                    MPY     84,DL
         8 001175   000000 471400 xsym               LDP1    DISK_FILE_SPEC$
         8 001176   000000 106506                    CMPC    fill='000'O
         8 001177   100020 000050                    ADSC9   16,Q,PR1                 cn=0,n=40
         8 001200   000013 000050 xsym               ADSC9   SPECCHARS+11             cn=0,n=40
         8 001201   001203 603000 8                  TRC     s:10167

      505    10166    2       THEN ALTRETURN;           /* Current file is past end of current range    */

  10166  8 001202   000000 702211                    TSX2  ! 0,X1

      506    10167    2       ELSE RETURN;

  10167  8 001203   000001 702211                    TSX2  ! 1,X1
      507    10168
      508    10169    2   END FLN_CHECK_STOP;
      509    10170
      510    10171
      511    10172    1   END FLN$DISK_OPEN_NEXT;
      512    10173        %EOD;

PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:85   
--  Include file information  --

   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLN$DISK_OPEN_NEXT.
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:86   

 **** Variables and constants ****

  ****  Section 002  Data  FLN$DISK_OPEN_NEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   100-0-0/d STRC(1080)  r     1 CLOSE_BLOCK_FILE         136-0-0/w PTR         r     1 CURR_DCB$
     6-0-0/d STRC(2088)  r     1 OPEN_BLOCK_FILE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DCB#                      3-0-0/w PTR         r     1 @DCB$
     5-0-0/w PTR         r     1 @DCBN                      7-0-0/w PTR         r     1 @ERR
     6-0-0/w PTR         r     1 @FPARAM_                  14-0-0/w PTR         r     1 ACCT_CODE14$
    13-0-0/w SBIN        r     1 CODE                      15-0-0/w PTR         r     1 CODE04$
    *0-0-0/w SBIN        r     1 DCB#                      *0-0-0/w PTR         r     1 DCB$
    *0-0-0/w SBIN        r     1 DCBN                      *0-0-0/w BIT         r     1 ERR
    11-0-0/w BIT         r     1 FOUND_FILE                *0-0-0/d STRC(72)    r     1 FPARAM_
    10-0-0/w SBIN        r     1 NEXT_DCB                  12-0-0/w BIT         r     1 RESET_PREVIOUS_ACCT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 ANY_FILES_IN_ACCT          0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w SBIN        r     1 BREAK_DCB#                 0-0-0/c STRC(72)    r     1 DISK_ACCT
     0-0-0/c STRC(72)    r     1 DISK_ACCT_FIRST            0-0-0/c STRC(72)    r     1 DISK_ACCT_LAST
     0-0-0/d STRC(1080)  r     1 DISK_CLOSE_NEXT            0-0-0/d STRC(1080)  r     1 DISK_CLOSE_ORDINARY
     0-0-0/d STRC(252)   r     1 DISK_DCBLIST(0:8191)
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/c STRC(288)   r     1 DISK_NAME
     0-0-0/d STRC(2088)  r     1 DISK_OPEN_NEXT             0-0-0/d STRC(2088)  r     1 DISK_OPEN_ORDINARY
     0-0-0/w STRC(145)   r     1 DISK_OPTION                0-0-0/c STRC(72)    r     1 DISK_PASS
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:87   
     0-0-0/b BIT         r     1 DISK_SEARCH_COMPLETE       0-0-0/d STRC(90)    r     1 DISK_SN
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w SBIN        r     1 DPLISTX
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/w SBIN        r     1 FIRST_FREE_DCB
     0-0-0/c STRC(72)    r     1 FROM_DISK_ACCT             0-0-0/c STRC(288)   r     1 FROM_DISK_NAME
     0-0-0/d STRC(90)    r     1 FROM_DISK_SN               0-0-0/w SBIN        r     1 LAST_DCB
     0-0-0/w SBIN        r     1 LAST_OPEN_DCB              0-0-0/w SBIN        r     1 NEXT_OPEN_DCB
     0-0-0/b BIT         r     1 ON_TO_NEXT_DP              0-0-0/b BIT         r     1 ON_TO_NEXT_SPEC
     0-0-0/c STRC(72)    r     1 PREVIOUS_ACCT              0-0-0/d STRC(2088)  r     1 READ_AD_OR_FD
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/w STRC(756)   r     1 SPEC                       0-0-0/w CHAR(84)    r     1 SPECCHARS
     0-0-0/w SBIN        r     1 SPECX                      0-0-0/w PTR         r     1 TAPE_DCBLIST$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(396)   r     1 CODE04                     0-0-0/w STRC(288)   r     1 CODE14
     0-0-0/w STRC(936)   r     1 DISK_FILE_SPEC             0-0-0/d STRC(90)    r     1 DPLIST
     0-0-0/w STRC(72)    r     1 DPRESLIST                  0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(180)   r     1 FM$GRAN                    0-0-0N  NULL        r     1 M$DISK_IN


   Procedure FLN$DISK_OPEN_NEXT requires 644 words for executable code.
   Procedure FLN$DISK_OPEN_NEXT requires 18 words of local(AUTO) storage.
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:88   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:89   
          MINI XREF LISTING

ACCT_CODE14$
      9718**DCL      9804--IMP-PTR 10071<<ASSIGN  10072<>CALL    10074>>IF      10085>>IF      10085>>IF
ANY_FILES_IN_ACCT
      8672**DCL      9933<<ASSIGN   9935<<ASSIGN   9950<<ASSIGN  10028>>IF      10031<<ASSIGN
B$ALT.CODE
      9787**DCL      9787--REDEF    9788--REDEF    9788--REDEF
B$ALT.ERR
      9788**DCL      9904>>ASSIGN   9999>>ASSIGN  10103>>ASSIGN
B$ALT.ERR.CODE
      9789**DCL     10000>>ASSIGN  10020>>IF      10099>>IF
B$ALT.ERR.ERR#
      9789**DCL      9789--REDEF
B$ALT.EVID
      9788**DCL      9788--REDEF    9788--REDEF
B$TCB.ALT$
      9783**DCL      9904>>ASSIGN   9999>>ASSIGN  10000>>ASSIGN  10020>>IF      10099>>IF      10103>>ASSIGN
B$TCB$
      8180**DCL      9783--IMP-PTR  9904>>ASSIGN   9999>>ASSIGN  10000>>ASSIGN  10020>>IF      10099>>IF
     10103>>ASSIGN
BREAK_DCB#
      9702**DCL      9827<<ASSIGN   9828>>ASSIGN  10126<<ASSIGN  10127>>ASSIGN
CHKERR
      9989**LABEL    9971--CALLALT  9976--CALLALT
CLOSE_BLOCK_FILE.SN_
      9342**DCL      9342--REDEF
CLOSE_BLOCK_FILE.UTL_
      9343**DCL      9343--REDEF
CLOSE_BLOCK_FILE.V
      9347**DCL      9342--DCLINIT
CLOSE_BLOCK_FILE.V.EXPIRE#
      9357**DCL      9357--REDEF
CLOSE_BLOCK_FILE.V.TYPE#
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:90   
      9355**DCL      9355--REDEF
CLOSE_BLOCK_FILE.V.XTNSIZE#
      9352**DCL      9352--REDEF    9354--REDEF
CODE
      9717**DCL      9947<<ASSIGN  10000<<ASSIGN  10003>>IF      10003>>IF      10003>>IF      10003>>IF
     10004<<ASSIGN  10006>>IF      10008>>IF      10008>>IF      10022<<ASSIGN  10028>>IF      10028>>IF
     10033>>IF      10035>>IF      10054>>IF      10054>>IF      10099>>IF
CODE04.SVMODIFY.TIME
      9799**DCL      9963>>IF
CODE04$
      9719**DCL      9796--IMP-PTR  9960<<ASSIGN   9961<>CALL     9963>>IF
CODE14.ACCESS.BUPF
      9806**DCL     10074>>IF
CODE14.ACCESS.NOSTOW
      9806**DCL     10085>>IF
CODE14.ACCESS.NPUR
      9806**DCL     10085>>IF
CURR_DCB$
      9708**DCL      9726--IMP-PTR  9869<<ASSIGN   9956>>IF       9986>>IF      10021>>IF      10025>>IF
     10027>>IF      10052>>IF      10057>>IF      10107>>ASSIGN  10160>>ASSIGN  10161>>ASSIGN  10162>>ASSIGN
     10163>>ASSIGN  10164>>ASSIGN
DCB#
        12**DCL         6--PROC     9828<<ASSIGN  10127<<ASSIGN
DCB$
        11**DCL         6--PROC     9822--IF       9826<<ASSIGN   9836>>IF       9838>>ASSIGN   9857--IF
     10123--IF      10125<<ASSIGN  10132>>IF      10134>>ASSIGN
DCBN
        13**DCL         6--PROC     9829<<ASSIGN   9833>>ASSIGN  10131<<ASSIGN
DISK_ACCT
      8743**DCL      9922<<ASSIGN
DISK_ACCT.ACCT#
      8743**DCL      9896<<ASSIGN  10161<<ASSIGN
DISK_ACCT_FIRST
      9385**DCL      9840<<ASSIGN  10136<<ASSIGN
DISK_ACCT_FIRST.ACCT#
      9385**DCL      9839>>IF      10135>>IF
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:91   
DISK_ACCT_LAST
      9398**DCL      9840>>ASSIGN  10136>>ASSIGN
DISK_ACCT_LAST.ACCT#
      9398**DCL      9838<<ASSIGN  10134<<ASSIGN
DISK_CLOSE.SN_
      7860**DCL      7860--REDEF
DISK_CLOSE.UTL_
      7861**DCL      7861--REDEF
DISK_CLOSE.V.EXPIRE#
      7875**DCL      7875--REDEF
DISK_CLOSE.V.TYPE#
      7873**DCL      7873--REDEF
DISK_CLOSE.V.XTNSIZE#
      7870**DCL      7870--REDEF    7872--REDEF
DISK_CLOSE_NEXT
      9039**DCL      9989<>CALL    10060<>CALL
DISK_CLOSE_NEXT.SN_
      9039**DCL      9039--REDEF
DISK_CLOSE_NEXT.UTL_
      9040**DCL      9040--REDEF
DISK_CLOSE_NEXT.V.DCB#
      9045**DCL      9988<<ASSIGN  10059<<ASSIGN
DISK_CLOSE_NEXT.V.EXPIRE#
      9054**DCL      9054--REDEF
DISK_CLOSE_NEXT.V.TYPE#
      9052**DCL      9052--REDEF
DISK_CLOSE_NEXT.V.XTNSIZE#
      9049**DCL      9049--REDEF    9051--REDEF
DISK_CLOSE_ORDINARY
      9081**DCL      9966<>CALL     9972<>CALL
DISK_CLOSE_ORDINARY.SN_
      9081**DCL      9081--REDEF
DISK_CLOSE_ORDINARY.UTL_
      9082**DCL      9082--REDEF
DISK_CLOSE_ORDINARY.V.DCB#
      9087**DCL      9965<<ASSIGN
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:92   
DISK_CLOSE_ORDINARY.V.EXPIRE#
      9096**DCL      9096--REDEF
DISK_CLOSE_ORDINARY.V.TYPE#
      9094**DCL      9094--REDEF
DISK_CLOSE_ORDINARY.V.XTNSIZE#
      9091**DCL      9091--REDEF    9093--REDEF
DISK_DCBLIST.DCB#
      8676**DCL      9827>>ASSIGN   9867>>ASSIGN  10126>>ASSIGN
DISK_DCBLIST.DCB$
      8676**DCL      9826>>ASSIGN   9869>>ASSIGN  10125>>ASSIGN
DISK_DCBLIST.ERR
      8676**DCL      9831>>ASSIGN   9900<<ASSIGN   9904<<ASSIGN   9946<<ASSIGN   9999<<ASSIGN  10007<<ASSIGN
     10069<<ASSIGN  10103<<ASSIGN  10129>>ASSIGN
DISK_DCBLIST.ERR.CODE
      8676**DCL      9901<<ASSIGN  10070<<ASSIGN
DISK_DCBLIST.FPARAM_
      8677**DCL      9830>>ASSIGN   9868>>ASSIGN  10128>>ASSIGN
DISK_DCBLIST.FPARAM_.PTR$
      8677**DCL      9960>>ASSIGN  10071>>ASSIGN
DISK_DCBLIST.NEXT_IX
      8677**DCL      9832>>ASSIGN   9833<<ASSIGN   9861>>ASSIGN  10130<<ASSIGN  10146<<ASSIGN  10149<<ASSIGN
DISK_FILE_SPEC.NBR
      8225**DCL      9912>>IF
DISK_FILE_SPEC.PASSWORD#
      8225**DCL      9928>>ASSIGN
DISK_FILE_SPEC.PASSWORD_SPEC
      8225**DCL      9926>>IF
DISK_FILE_SPEC.SPEC
      8225**DCL      8227--REDEF
DISK_FILE_SPEC.SPEC.START
      8226**DCL      8226--REDEF
DISK_FILE_SPEC.SPEC.START.ACCT
      8226**DCL      9922>>ASSIGN   9934>>IF
DISK_FILE_SPEC.SPEC.START.FILE.L#
      8226**DCL      9921>>ASSIGN
DISK_FILE_SPEC.SPEC.START.FILE.NAME#
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:93   
      8226**DCL      9920>>ASSIGN
DISK_FILE_SPEC.SPEC.STOP
      8227**DCL      8227--REDEF   10165>>IF
DISK_FILE_SPEC.SPEC.STOP.ACCT
      8227**DCL      9934>>IF
DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#
      8227**DCL     10025>>IF      10027>>IF
DISK_FILE_SPEC$
      8224**DCL      8225--IMP-PTR  9912>>IF       9920>>ASSIGN   9921>>ASSIGN   9922>>ASSIGN   9926>>IF
      9928>>ASSIGN   9934>>IF       9934>>IF      10025>>IF      10027>>IF      10165>>IF
DISK_NAME
      8703**DCL     10160<<ASSIGN
DISK_NAME.L#
      8703**DCL      9921<<ASSIGN  10011<<ASSIGN  10076<<ASSIGN  10089<<ASSIGN
DISK_NAME.NAME#
      8703**DCL      9920<<ASSIGN  10010<<ASSIGN  10077<<ASSIGN  10091<<ASSIGN
DISK_OPEN.ACSVEH_
      7725**DCL      7726--REDEF
DISK_OPEN.ALTKEYS_
      7731**DCL      7732--REDEF    7732--REDEF
DISK_OPEN.HDR_
      7730**DCL      7731--REDEF
DISK_OPEN.TAB_
      7729**DCL      7730--REDEF
DISK_OPEN.UHL_
      7723**DCL      7724--REDEF    7724--REDEF
DISK_OPEN.V.FSN#
      7763**DCL      7763--REDEF    7763--REDEF
DISK_OPEN.WSN_
      7729**DCL      7729--REDEF
DISK_OPEN_NEXT
      8863**DCL      9943<>CALL
DISK_OPEN_NEXT.ACSVEH_
      8865**DCL      8866--REDEF
DISK_OPEN_NEXT.ALTKEYS_
      8871**DCL      8872--REDEF    8872--REDEF
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:94   
DISK_OPEN_NEXT.FPARAM_
      8868**DCL      9868<<ASSIGN   9894>>ASSIGN  10013>>ASSIGN  10065>>ASSIGN
DISK_OPEN_NEXT.HDR_
      8870**DCL      8871--REDEF
DISK_OPEN_NEXT.PASS_
      8865**DCL      9929<<ASSIGN   9931<<ASSIGN
DISK_OPEN_NEXT.TAB_
      8869**DCL      8870--REDEF
DISK_OPEN_NEXT.UHL_
      8863**DCL      8864--REDEF    8864--REDEF
DISK_OPEN_NEXT.V.DCB#
      8872**DCL      9867<<ASSIGN   9895>>ASSIGN   9965>>ASSIGN   9970>>ASSIGN   9988>>ASSIGN  10014>>ASSIGN
     10059>>ASSIGN  10066>>ASSIGN
DISK_OPEN_NEXT.V.FSN#
      8903**DCL      8903--REDEF    8903--REDEF
DISK_OPEN_NEXT.V.FUN#
      8882**DCL      9956>>IF
DISK_OPEN_NEXT.V.INITZ.SCRUB#
      8873**DCL      9917<<ASSIGN   9945<<ASSIGN   9998<<ASSIGN
DISK_OPEN_NEXT.V.OPER.NXTA#
      8875**DCL      9918<<ASSIGN  10012<<ASSIGN  10079<<ASSIGN  10090<<ASSIGN  10157<<ASSIGN
DISK_OPEN_NEXT.V.OPER.NXTF#
      8875**DCL      9936<<ASSIGN  10158<<ASSIGN
DISK_OPEN_NEXT.V.OPER.THISF#
      8875**DCL      9937<<ASSIGN  10055<<ASSIGN  10056<<ASSIGN  10112<<ASSIGN  10159<<ASSIGN
DISK_OPEN_NEXT.V.RES#
      8887**DCL      9888<<ASSIGN
DISK_OPEN_NEXT.V.SHARE#
      8877**DCL      9956>>IF
DISK_OPEN_NEXT.WSN_
      8869**DCL      8869--REDEF
DISK_OPEN_ORDINARY
      8972**DCL      9971<>CALL     9976<>CALL
DISK_OPEN_ORDINARY.ACSVEH_
      8974**DCL      8975--REDEF
DISK_OPEN_ORDINARY.ALTKEYS_
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:95   
      8980**DCL      8981--REDEF    8981--REDEF
DISK_OPEN_ORDINARY.HDR_
      8979**DCL      8980--REDEF
DISK_OPEN_ORDINARY.TAB_
      8978**DCL      8979--REDEF
DISK_OPEN_ORDINARY.UHL_
      8972**DCL      8973--REDEF    8973--REDEF
DISK_OPEN_ORDINARY.V.ACS#
      8992**DCL      9969<<ASSIGN   9975<<ASSIGN
DISK_OPEN_ORDINARY.V.DCB#
      8981**DCL      9970<<ASSIGN
DISK_OPEN_ORDINARY.V.FSN#
      9012**DCL      9012--REDEF    9012--REDEF
DISK_OPEN_ORDINARY.WSN_
      8978**DCL      8978--REDEF
DISK_OPTION.DELETED_ACCOUNTS
      8237**DCL     10028>>IF      10047>>IF      10108>>IF
DISK_OPTION.DIR
      8237**DCL     10028>>IF      10047>>IF      10108>>IF
DISK_OPTION.PAD
      8238**DCL      9892>>IF
DISK_OPTION.SAVE_DIR
      8240**DCL     10080>>IF
DISK_OPTION.SKIP_NO_BACKUP
      8239**DCL     10047>>IF      10074>>IF
DISK_OPTION.SKIP_NO_PURGE
      8240**DCL     10047>>IF      10085>>IF
DISK_OPTION.SKIP_NO_STOW
      8239**DCL     10047>>IF      10085>>IF
DISK_PASS
      8795**DCL      9929--ASSIGN
DISK_PASS.PASS#
      8795**DCL      9928<<ASSIGN
DISK_READ.STATION_
      7787**DCL      7788--REDEF
DISK_READ.V.DVBYTE.REREAD#
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:96   
      7799**DCL      7799--REDEF
DISK_READ.V.INDX#
      7797**DCL      7797--REDEF
DISK_SEARCH_COMPLETE
      8673**DCL      9852>>IF       9883<<ASSIGN
DISK_SN.SN#
      8769**DCL      9887<<ASSIGN
DISK_WRITE.STATION_
      7825**DCL      7825--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7832**DCL      7832--REDEF
DPLIST.NUM#
      8222**DCL      9881>>IF
DPLIST.SN#
      8222**DCL      9887>>ASSIGN
DPLIST$
      8210**DCL      8222--IMP-PTR  9881>>IF       9887>>ASSIGN
DPLISTX
      8346**DCL      9880<<ASSIGN   9880>>ASSIGN   9881>>IF       9887>>ASSIGN   9888>>ASSIGN
DPRESLIST.NAME
      8224**DCL      9888>>ASSIGN
DPRESLIST$
      8224**DCL      8224--IMP-PTR  9888>>ASSIGN
EFTWORD
      8345**DCL      8345--REDEF
ERR
        17**DCL         6--PROC     9831<<ASSIGN   9844<<ASSIGN  10129<<ASSIGN
F$DCB.ACCT#
      9742**DCL      9836>>IF       9838>>ASSIGN  10025>>IF      10027>>IF      10052>>IF      10107>>ASSIGN
     10132>>IF      10134>>ASSIGN  10161>>ASSIGN  10162>>ASSIGN
F$DCB.ACTPOS
      9758**DCL      9758--REDEF
F$DCB.ARS#
      9732**DCL      9732--REDEF
F$DCB.ATTR
      9751**DCL      9752--REDEF
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:97   
F$DCB.BORROW
      9766**DCL      9766--REDEF    9766--REDEF    9766--REDEF
F$DCB.DCBNAME.L
      9780**DCL      9780--IMP-SIZ
F$DCB.DESC.DELF#
      9739**DCL      9956>>IF
F$DCB.EOMCHAR#
      9736**DCL      9736--REDEF
F$DCB.EXPIRE#
      9749**DCL     10021>>IF
F$DCB.FCD#
      9745**DCL      9986>>IF      10057>>IF
F$DCB.FLDID
      9761**DCL      9761--REDEF
F$DCB.FORM$
      9755**DCL      9755--REDEF
F$DCB.FSECT
      9771**DCL      9771--REDEF
F$DCB.FSN#
      9748**DCL      9748--REDEF    9748--REDEF    9749--REDEF
F$DCB.HEADER$
      9754**DCL      9754--REDEF
F$DCB.IXTNSIZE#
      9752**DCL      9752--REDEF
F$DCB.LASTSTA$
      9741**DCL      9741--REDEF
F$DCB.LVL
      9767**DCL      9767--REDEF
F$DCB.NAME#
      9742**DCL     10160>>ASSIGN
F$DCB.NAME#.C
      9742**DCL      9742--REDEF   10163>>ASSIGN
F$DCB.NAME#.L
      9742**DCL     10164>>ASSIGN
F$DCB.NOEOF
      9764**DCL      9764--REDEF
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:98   
F$DCB.NRECS#
      9753**DCL      9753--REDEF
F$DCB.NRECX
      9772**DCL      9772--REDEF
F$DCB.OHDR
      9764**DCL      9764--REDEF
F$DCB.ORG#
      9747**DCL      9747--REDEF
F$DCB.PRECNO
      9770**DCL      9770--REDEF
F$DCB.RCSZ
      9776**DCL      9776--REDEF
F$DCB.RES#
      9743**DCL      9743--REDEF
F$DCB.SETX
      9755**DCL      9755--REDEF
F$DCB.TAB$
      9755**DCL      9755--REDEF
F$DCB.TDA
      9769**DCL      9770--REDEF
F$DCB.WSN#
      9743**DCL      9743--REDEF
FIRST_FREE_DCB
      8671**DCL      9856>>IF       9860>>ASSIGN   9861<<ASSIGN   9861>>ASSIGN
FLI$RPT_ERR
      9695**DCL-ENT  9991--CALL    10062--CALL
FLN_CHECK_STOP
     10153**PROC     9948--CALL    10001--CALL
FM$GRAN
      9812**DCL      9960--ASSIGN
FOUND_FILE
      9715**DCL      9875<<ASSIGN   9876>>DOWHILE  9897<<ASSIGN   9909>>IF       9941>>IF       9951<<ASSIGN
     10030<<ASSIGN  10037<<ASSIGN  10045>>IF      10082<<ASSIGN  10088<<ASSIGN  10101<<ASSIGN  10109<<ASSIGN
FPARAM_
        14**DCL         6--PROC     9830<<ASSIGN  10128<<ASSIGN
FPT_EXIT.V.STEPCC#
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:99   
      7650**DCL      7650--REDEF
FROM_DISK_ACCT
      8756**DCL      9280--DCLINIT
FROM_DISK_NAME
      8730**DCL      9276--DCLINIT
FROM_DISK_SN
      8782**DCL      9275--DCLINIT
LAST_DCB
      8671**DCL     10116<<ASSIGN
LAST_OPEN_DCB
      8671**DCL      9835<<ASSIGN  10140>>IF      10143<<ASSIGN  10146>>ASSIGN  10147<<ASSIGN
M$CLOSE
      6637**DCL-ENT  9966--CALL     9972--CALL     9989--CALL    10060--CALL
M$OPEN
      6637**DCL-ENT  9898--CALL     9943--CALL     9971--CALL     9976--CALL    10015--CALL    10067--CALL
M$XXX
      6649**DCL-ENT  9859--CALL
NEXT_DCB
      9714**DCL      9860<<ASSIGN   9867>>ASSIGN   9868>>ASSIGN   9869>>ASSIGN   9900>>ASSIGN   9901>>ASSIGN
      9904>>ASSIGN   9946>>ASSIGN   9960>>ASSIGN   9999>>ASSIGN  10007>>ASSIGN  10069>>ASSIGN  10070>>ASSIGN
     10071>>ASSIGN  10103>>ASSIGN  10116>>ASSIGN  10125>>ASSIGN  10126>>ASSIGN  10128>>ASSIGN  10129>>ASSIGN
     10130>>ASSIGN  10131>>ASSIGN  10142>>ASSIGN  10143>>ASSIGN  10146>>ASSIGN  10147>>ASSIGN  10149>>ASSIGN
NEXT_OPEN_DCB
      8671**DCL      9824>>IF       9826>>ASSIGN   9827>>ASSIGN   9829>>ASSIGN   9830>>ASSIGN   9831>>ASSIGN
      9832<<ASSIGN   9832>>ASSIGN   9834>>IF       9835>>ASSIGN  10142<<ASSIGN
ON_TO_NEXT_DP
      8672**DCL      9878>>IF       9886<<ASSIGN   9914<<ASSIGN   9941>>IF      10034<<ASSIGN
ON_TO_NEXT_SPEC
      8672**DCL      9890<<ASSIGN   9909>>IF       9919<<ASSIGN   9985<<ASSIGN  10026<<ASSIGN  10036<<ASSIGN
OPEN_BLOCK_FILE.ACSVEH_
      9277**DCL      9278--REDEF
OPEN_BLOCK_FILE.ALTKEYS_
      9283**DCL      9284--REDEF    9284--REDEF
OPEN_BLOCK_FILE.HDR_
      9282**DCL      9283--REDEF
OPEN_BLOCK_FILE.TAB_
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:100  
      9281**DCL      9282--REDEF
OPEN_BLOCK_FILE.UHL_
      9275**DCL      9276--REDEF    9276--REDEF
OPEN_BLOCK_FILE.V
      9284**DCL      9275--DCLINIT
OPEN_BLOCK_FILE.V.FSN#
      9315**DCL      9315--REDEF    9315--REDEF
OPEN_BLOCK_FILE.WSN_
      9281**DCL      9281--REDEF
PREVIOUS_ACCT.ACCT#
      9372**DCL      9891<<ASSIGN  10052>>IF      10106<<ASSIGN  10107<<ASSIGN
PRE_RET_CLOSE.SN_
      8588**DCL      8588--REDEF
PRE_RET_CLOSE.UTL_
      8589**DCL      8589--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      8603**DCL      8603--REDEF
PRE_RET_CLOSE.V.TYPE#
      8601**DCL      8601--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      8598**DCL      8598--REDEF    8600--REDEF
PRE_RET_OPEN.ACSVEH_
      8523**DCL      8524--REDEF
PRE_RET_OPEN.ALTKEYS_
      8529**DCL      8530--REDEF    8530--REDEF
PRE_RET_OPEN.HDR_
      8528**DCL      8529--REDEF
PRE_RET_OPEN.TAB_
      8527**DCL      8528--REDEF
PRE_RET_OPEN.UHL_
      8521**DCL      8522--REDEF    8522--REDEF
PRE_RET_OPEN.V.FSN#
      8561**DCL      8561--REDEF    8561--REDEF
PRE_RET_OPEN.WSN_
      8527**DCL      8527--REDEF
PRE_RET_READ.STATION_
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:101  
      8378**DCL      8379--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      8390**DCL      8390--REDEF
PRE_RET_READ.V.INDX#
      8388**DCL      8388--REDEF
PRE_RET_WRITE.STATION_
      8416**DCL      8416--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      8423**DCL      8423--REDEF
READ_AD_OR_FD
      9165**DCL      9898<>CALL    10015<>CALL    10067<>CALL
READ_AD_OR_FD.ACSVEH_
      9167**DCL      9168--REDEF
READ_AD_OR_FD.ALTKEYS_
      9173**DCL      9174--REDEF    9174--REDEF
READ_AD_OR_FD.FPARAM_
      9170**DCL      9894<<ASSIGN  10013<<ASSIGN  10065<<ASSIGN
READ_AD_OR_FD.HDR_
      9172**DCL      9173--REDEF
READ_AD_OR_FD.TAB_
      9171**DCL      9172--REDEF
READ_AD_OR_FD.UHL_
      9165**DCL      9166--REDEF    9166--REDEF
READ_AD_OR_FD.V.DCB#
      9174**DCL      9895<<ASSIGN  10014<<ASSIGN  10066<<ASSIGN
READ_AD_OR_FD.V.FSN#
      9205**DCL      9205--REDEF    9205--REDEF
READ_AD_OR_FD.WSN_
      9171**DCL      9171--REDEF
RESET_PREVIOUS_ACCT
      9716**DCL     10051<<ASSIGN  10078<<ASSIGN  10105>>IF
RET_CMDS_NAME.L#
      8632**DCL      8632--IMP-SIZ
SNVECLIST$
      8164**DCL      8164--IMP-PTR
SPEC.START
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:102  
      8228**DCL      8229--REDEF
SPEC.STOP
      8229**DCL      8230--REDEF   10165>>IF
SPEC.STOP.ACCT.ACCT#
      8229**DCL     10162<<ASSIGN
SPEC.STOP.FILE.L#
      8230**DCL     10164<<ASSIGN
SPEC.STOP.FILE.NAME#
      8229**DCL     10163<<ASSIGN
SPECCHARS
      8228**DCL      8228--REDEF
SPECX
      8346**DCL      9889<<ASSIGN   9911<<ASSIGN   9911>>ASSIGN   9912>>IF       9920>>ASSIGN   9921>>ASSIGN
      9922>>ASSIGN   9932>>IF       9934>>IF       9934>>IF      10025>>IF      10027>>IF      10165>>IF
TAPE_CLOSE.SN_
      8081**DCL      8081--REDEF
TAPE_CLOSE.UTL_
      8082**DCL      8082--REDEF
TAPE_CLOSE.V.EXPIRE#
      8096**DCL      8096--REDEF
TAPE_CLOSE.V.TYPE#
      8094**DCL      8094--REDEF
TAPE_CLOSE.V.XTNSIZE#
      8091**DCL      8091--REDEF    8093--REDEF
TAPE_DCBLIST$
      7637**DCL      7637--IMP-PTR
TAPE_OPEN.ACSVEH_
      7946**DCL      7947--REDEF
TAPE_OPEN.ALTKEYS_
      7952**DCL      7953--REDEF    7953--REDEF
TAPE_OPEN.HDR_
      7951**DCL      7952--REDEF
TAPE_OPEN.TAB_
      7950**DCL      7951--REDEF
TAPE_OPEN.UHL_
      7944**DCL      7945--REDEF    7945--REDEF
PL6.E3A0      #002=FLN$DISK_OPEN_NEXT File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:10 Page:103  
TAPE_OPEN.V.FSN#
      7984**DCL      7984--REDEF    7984--REDEF
TAPE_OPEN.WSN_
      7950**DCL      7950--REDEF
TAPE_READ.STATION_
      8008**DCL      8009--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      8020**DCL      8020--REDEF
TAPE_READ.V.INDX#
      8018**DCL      8018--REDEF
TAPE_WRITE.STATION_
      8046**DCL      8046--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      8053**DCL      8053--REDEF
TVECTOR.W2
      8177**DCL      8178--REDEF
XSF$LOCCODP
      9696**DCL-ENT  9961--CALL    10072--CALL

PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:104  
      513        1        /*T***********************************************************/
      514        2        /*T*                                                         */
      515        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      516        4        /*T*                                                         */
      517        5        /*T***********************************************************/
      518        6        FLN$DISK_CLOSE_ALL: PROC;
      519        7        /*F*  NAME: FLN$DISK_CLOSE_ALL
      520        8              PURPOSE: Close all open disk DCBs.
      521        9        */
      522       10
      523       11        /***
      524       12         *** INCLUDE
      525       13         ***/
      526       14
      527       15        %INCLUDE CP_6;
      528     5574        %INCLUDE FLN_DATA_R;
      529     6311
      530     6312        /***
      531     6313         *** ENTRY
      532     6314         ***/
      533     6315
      534     6316    1   DCL FLI$RPT_ERR ENTRY(5);
      535     6317
      536     6318        /***
      537     6319         *** AUTO
      538     6320         ***/
      539     6321
      540     6322    1   DCL DCBX SBIN AUTO;
      541     6323
      542     6324        /***
      543     6325         *** BASED
      544     6326         ***/
      545     6327
      546     6328        %F$DCB;
      547     6385
      548     6386        /****************************************/
      549     6387
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:105  
      550     6388        /***
      551     6389         *** Close DCB if it's open.
      552     6390         ***/
      553     6391
      554     6392    2      DO DCBX=0 TO %(MAX_NBR_DISK_DCBS - 1);
      555     6393    2         IF DISK_DCBLIST.DCB$(DCBX)->F$DCB.FCD#
      556     6394    3          THEN DO;                         /* Close DCB                          */
      557     6395    3            DISK_CLOSE_NEXT.V.DCB# = DISK_DCBLIST.DCB#(DCBX);
      558     6396    3            CALL M$CLOSE( DISK_CLOSE_NEXT )
      559     6397    4             WHENALTRETURN DO;
      560     6398    4               CALL FLI$RPT_ERR;
      561     6399    4               END;
      562     6400    3            END;
      563     6401    2         END;
      564     6402
      565     6403    1      RETURN;
      566     6404
      567     6405    1   END FLN$DISK_CLOSE_ALL;
      568     6406        %EOD;

PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:106  
--  Include file information  --

   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLN$DISK_CLOSE_ALL.

   Procedure FLN$DISK_CLOSE_ALL requires 24 words for executable code.
   Procedure FLN$DISK_CLOSE_ALL requires 4 words of local(AUTO) storage.

PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:107  

 Object Unit name= FLN$DISK_CLOSE_ALL                         File name= FLN$ROUTINES.:E05TOU
 UTS= JUL 29 '97 16:13:13.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DISK_IN
    2   DCB   even  none     0      0  M$DISK00
    3   DCB   even  none     0      0  M$DISK01
    4   DCB   even  none     0      0  M$DISK02
    5   DCB   even  none     0      0  M$DISK03
    6   Data  even  none    88    130  FLN$DISK_CLOSE_ALL
    7   Proc  even  none    24     30  FLN$DISK_CLOSE_ALL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Std        0  FLN$DISK_CLOSE_ALL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:108  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DISK_IN                             M$DISK00
     M$DISK01                              M$DISK02                              M$DISK03
     DISK_DCBLIST                          FROM_DISK_NAME                        FROM_DISK_ACCT
     FROM_DISK_SN                          DISK_CLOSE_NEXT                       B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:109  


      513        1        /*T***********************************************************/
      514        2        /*T*                                                         */
      515        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      516        4        /*T*                                                         */
      517        5        /*T***********************************************************/
      518        6        FLN$DISK_CLOSE_ALL: PROC;

      6  7 000000   000000 700200 xent  FLN$DISK_CL* TSX0  ! X66_AUTO_0
         7 000001   000004 000000                    ZERO    4,0

      519        7        /*F*  NAME: FLN$DISK_CLOSE_ALL
      520        8              PURPOSE: Close all open disk DCBs.
      521        9        */
      522       10
      523       11        /***
      524       12         *** INCLUDE
      525       13         ***/
      526       14
      527       15        %INCLUDE CP_6;
      528     5574        %INCLUDE FLN_DATA_R;
      529     6311
      530     6312        /***
      531     6313         *** ENTRY
      532     6314         ***/
      533     6315
      534     6316    1   DCL FLI$RPT_ERR ENTRY(5);
      535     6317
      536     6318        /***
      537     6319         *** AUTO
      538     6320         ***/
      539     6321
      540     6322    1   DCL DCBX SBIN AUTO;
      541     6323
      542     6324        /***
      543     6325         *** BASED
      544     6326         ***/
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:110  
      545     6327
      546     6328        %F$DCB;
      547     6385
      548     6386        /****************************************/
      549     6387
      550     6388        /***
      551     6389         *** Close DCB if it's open.
      552     6390         ***/
      553     6391
      554     6392    2      DO DCBX=0 TO %(MAX_NBR_DISK_DCBS - 1);

   6392  7 000002   200003 450100                    STZ     DCBX,,AUTO

      555     6393    2         IF DISK_DCBLIST.DCB$(DCBX)->F$DCB.FCD#

   6393  7 000003   200003 235100                    LDA     DCBX,,AUTO
         7 000004   000003 735000                    ALS     3
         7 000005   000001 470405 xsym               LDP0    DISK_DCBLIST+1,AL
         7 000006   000031 236100                    LDQ     25,,PR0
         7 000007   020000 316007                    CANQ    8192,DL
         7 000010   000023 600000 7                  TZE     s:6401

      556     6394    3          THEN DO;                         /* Close DCB                          */

      557     6395    3            DISK_CLOSE_NEXT.V.DCB# = DISK_DCBLIST.DCB#(DCBX);

   6395  7 000011   000000 720005 xsym               LXL0    DISK_DCBLIST,AL
         7 000012   000032 740000 xsym               STX0    DISK_CLOSE_NEXT+26

      558     6396    3            CALL M$CLOSE( DISK_CLOSE_NEXT )

   6396  7 000013   000000 630400 xsym               EPPR0   DISK_CLOSE_NEXT
         7 000014   450001 713400                    CLIMB   alt,close
         7 000015   406000 401760                    pmme    nvectors=13
         7 000016   000020 702000 7                  TSX2    s:6398
         7 000017   000023 710000 7                  TRA     s:6401

PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:111  
      559     6397    4             WHENALTRETURN DO;

      560     6398    4               CALL FLI$RPT_ERR;

   6398  7 000020   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000021   000000 701000 xent               TSX1    FLI$RPT_ERR
         7 000022   000000 011000                    NOP     0

      561     6399    4               END;

      562     6400    3            END;

      563     6401    2         END;

   6401  7 000023   200003 054100                    AOS     DCBX,,AUTO
         7 000024   200003 235100                    LDA     DCBX,,AUTO
         7 000025   000003 115007                    CMPA    3,DL
         7 000026   000003 604400 7                  TMOZ    s:6393

      564     6402
      565     6403    1      RETURN;

   6403  7 000027   000000 702200 xent               TSX2  ! X66_ARET
      566     6404
      567     6405    1   END FLN$DISK_CLOSE_ALL;
      568     6406        %EOD;

PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:112  
--  Include file information  --

   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLN$DISK_CLOSE_ALL.
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:113  

 **** Variables and constants ****

  ****  Section 006  Data  FLN$DISK_CLOSE_ALL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/d STRC(1080)  r     1 CLOSE_BLOCK_FILE           0-0-0/d STRC(2088)  r     1 OPEN_BLOCK_FILE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 DCBX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1080)  r     1 DISK_CLOSE_NEXT
     0-0-0/d STRC(252)   r     1 DISK_DCBLIST(0:8191)
     0-0-0/c STRC(72)    r     1 FROM_DISK_ACCT             0-0-0/c STRC(288)   r     1 FROM_DISK_NAME
     0-0-0/d STRC(90)    r     1 FROM_DISK_SN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DISK_IN


   Procedure FLN$DISK_CLOSE_ALL requires 24 words for executable code.
   Procedure FLN$DISK_CLOSE_ALL requires 4 words of local(AUTO) storage.
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:114  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:115  
          MINI XREF LISTING

CLOSE_BLOCK_FILE.SN_
      6253**DCL      6253--REDEF
CLOSE_BLOCK_FILE.UTL_
      6254**DCL      6254--REDEF
CLOSE_BLOCK_FILE.V
      6258**DCL      6253--DCLINIT
CLOSE_BLOCK_FILE.V.EXPIRE#
      6268**DCL      6268--REDEF
CLOSE_BLOCK_FILE.V.TYPE#
      6266**DCL      6266--REDEF
CLOSE_BLOCK_FILE.V.XTNSIZE#
      6263**DCL      6263--REDEF    6265--REDEF
DCBX
      6322**DCL      6392<<DOINDEX  6393>>IF       6395>>ASSIGN
DISK_CLOSE_NEXT
      5950**DCL      6396<>CALL
DISK_CLOSE_NEXT.SN_
      5950**DCL      5950--REDEF
DISK_CLOSE_NEXT.UTL_
      5951**DCL      5951--REDEF
DISK_CLOSE_NEXT.V.DCB#
      5956**DCL      6395<<ASSIGN
DISK_CLOSE_NEXT.V.EXPIRE#
      5965**DCL      5965--REDEF
DISK_CLOSE_NEXT.V.TYPE#
      5963**DCL      5963--REDEF
DISK_CLOSE_NEXT.V.XTNSIZE#
      5960**DCL      5960--REDEF    5962--REDEF
DISK_CLOSE_ORDINARY.SN_
      5992**DCL      5992--REDEF
DISK_CLOSE_ORDINARY.UTL_
      5993**DCL      5993--REDEF
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:116  
DISK_CLOSE_ORDINARY.V.EXPIRE#
      6007**DCL      6007--REDEF
DISK_CLOSE_ORDINARY.V.TYPE#
      6005**DCL      6005--REDEF
DISK_CLOSE_ORDINARY.V.XTNSIZE#
      6002**DCL      6002--REDEF    6004--REDEF
DISK_DCBLIST.DCB#
      5587**DCL      6395>>ASSIGN
DISK_DCBLIST.DCB$
      5587**DCL      6393>>IF
DISK_OPEN_NEXT.ACSVEH_
      5776**DCL      5777--REDEF
DISK_OPEN_NEXT.ALTKEYS_
      5782**DCL      5783--REDEF    5783--REDEF
DISK_OPEN_NEXT.HDR_
      5781**DCL      5782--REDEF
DISK_OPEN_NEXT.TAB_
      5780**DCL      5781--REDEF
DISK_OPEN_NEXT.UHL_
      5774**DCL      5775--REDEF    5775--REDEF
DISK_OPEN_NEXT.V.FSN#
      5814**DCL      5814--REDEF    5814--REDEF
DISK_OPEN_NEXT.WSN_
      5780**DCL      5780--REDEF
DISK_OPEN_ORDINARY.ACSVEH_
      5885**DCL      5886--REDEF
DISK_OPEN_ORDINARY.ALTKEYS_
      5891**DCL      5892--REDEF    5892--REDEF
DISK_OPEN_ORDINARY.HDR_
      5890**DCL      5891--REDEF
DISK_OPEN_ORDINARY.TAB_
      5889**DCL      5890--REDEF
DISK_OPEN_ORDINARY.UHL_
      5883**DCL      5884--REDEF    5884--REDEF
DISK_OPEN_ORDINARY.V.FSN#
      5923**DCL      5923--REDEF    5923--REDEF
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:117  
DISK_OPEN_ORDINARY.WSN_
      5889**DCL      5889--REDEF
F$DCB.ACTPOS
      6361**DCL      6361--REDEF
F$DCB.ARS#
      6335**DCL      6335--REDEF
F$DCB.ATTR
      6354**DCL      6355--REDEF
F$DCB.BORROW
      6369**DCL      6369--REDEF    6369--REDEF    6369--REDEF
F$DCB.DCBNAME.L
      6383**DCL      6383--IMP-SIZ
F$DCB.EOMCHAR#
      6339**DCL      6339--REDEF
F$DCB.FCD#
      6348**DCL      6393>>IF
F$DCB.FLDID
      6364**DCL      6364--REDEF
F$DCB.FORM$
      6358**DCL      6358--REDEF
F$DCB.FSECT
      6374**DCL      6374--REDEF
F$DCB.FSN#
      6351**DCL      6351--REDEF    6351--REDEF    6352--REDEF
F$DCB.HEADER$
      6357**DCL      6357--REDEF
F$DCB.IXTNSIZE#
      6355**DCL      6355--REDEF
F$DCB.LASTSTA$
      6344**DCL      6344--REDEF
F$DCB.LVL
      6370**DCL      6370--REDEF
F$DCB.NAME#.C
      6345**DCL      6345--REDEF
F$DCB.NOEOF
      6367**DCL      6367--REDEF
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:118  
F$DCB.NRECS#
      6356**DCL      6356--REDEF
F$DCB.NRECX
      6375**DCL      6375--REDEF
F$DCB.OHDR
      6367**DCL      6367--REDEF
F$DCB.ORG#
      6350**DCL      6350--REDEF
F$DCB.PRECNO
      6373**DCL      6373--REDEF
F$DCB.RCSZ
      6379**DCL      6379--REDEF
F$DCB.RES#
      6346**DCL      6346--REDEF
F$DCB.SETX
      6358**DCL      6358--REDEF
F$DCB.TAB$
      6358**DCL      6358--REDEF
F$DCB.TDA
      6372**DCL      6373--REDEF
F$DCB.WSN#
      6346**DCL      6346--REDEF
FLI$RPT_ERR
      6316**DCL-ENT  6398--CALL
FROM_DISK_ACCT
      5667**DCL      6191--DCLINIT
FROM_DISK_NAME
      5641**DCL      6187--DCLINIT
FROM_DISK_SN
      5693**DCL      6186--DCLINIT
M$CLOSE
      5502**DCL-ENT  6396--CALL
OPEN_BLOCK_FILE.ACSVEH_
      6188**DCL      6189--REDEF
OPEN_BLOCK_FILE.ALTKEYS_
      6194**DCL      6195--REDEF    6195--REDEF
PL6.E3A0      #003=FLN$DISK_CLOSE_ALL File=FLN$ROUTINES.:E05TSI                  TUE 07/29/97 16:13 Page:119  
OPEN_BLOCK_FILE.HDR_
      6193**DCL      6194--REDEF
OPEN_BLOCK_FILE.TAB_
      6192**DCL      6193--REDEF
OPEN_BLOCK_FILE.UHL_
      6186**DCL      6187--REDEF    6187--REDEF
OPEN_BLOCK_FILE.V
      6195**DCL      6186--DCLINIT
OPEN_BLOCK_FILE.V.FSN#
      6226**DCL      6226--REDEF    6226--REDEF
OPEN_BLOCK_FILE.WSN_
      6192**DCL      6192--REDEF
READ_AD_OR_FD.ACSVEH_
      6078**DCL      6079--REDEF
READ_AD_OR_FD.ALTKEYS_
      6084**DCL      6085--REDEF    6085--REDEF
READ_AD_OR_FD.HDR_
      6083**DCL      6084--REDEF
READ_AD_OR_FD.TAB_
      6082**DCL      6083--REDEF
READ_AD_OR_FD.UHL_
      6076**DCL      6077--REDEF    6077--REDEF
READ_AD_OR_FD.V.FSN#
      6116**DCL      6116--REDEF    6116--REDEF
READ_AD_OR_FD.WSN_
      6082**DCL      6082--REDEF

PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:120  
      569        1        /*T***********************************************************/
      570        2        /*T*                                                         */
      571        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      572        4        /*T*                                                         */
      573        5        /*T***********************************************************/
      574        6        FLN$DISK_NXTA: PROC;
      575        7        /*F*  NAME: FLN$DISK_NXTA
      576        8              PURPOSE: Set up to force next account.
      577        9        */
      578       10
      579       11        /***
      580       12         *** INCLUDE
      581       13         ***/
      582       14
      583       15        %INCLUDE CP_6;
      584     5574        %INCLUDE FLN_DATA_R;
      585     6311
      586     6312        /****************************************/
      587     6313
      588     6314    1      DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;
      589     6315    1      DISK_OPEN_NEXT.V.OPER.NXTF# = '1'B;
      590     6316    1      DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;
      591     6317    1      DISK_NAME.NAME# = ' ';
      592     6318    1      DISK_NAME.L# = 0;
      593     6319    1      ANY_FILES_IN_ACCT = '0'B;
      594     6320
      595     6321    1      RETURN;
      596     6322
      597     6323    1   END FLN$DISK_NXTA;
      598     6324        %EOD;

PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:121  
--  Include file information  --

   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLN$DISK_NXTA.

   Procedure FLN$DISK_NXTA requires 15 words for executable code.
   Procedure FLN$DISK_NXTA requires 4 words of local(AUTO) storage.

PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:122  

 Object Unit name= FLN$DISK_NXTA                              File name= FLN$ROUTINES.:E05TOU
 UTS= JUL 29 '97 16:14:21.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DISK_IN
    2   DCB   even  none     0      0  M$DISK00
    3   DCB   even  none     0      0  M$DISK01
    4   DCB   even  none     0      0  M$DISK02
    5   DCB   even  none     0      0  M$DISK03
    6   Data  even  none    88    130  FLN$DISK_NXTA
    7   Proc  even  none    15     17  FLN$DISK_NXTA
    8  RoData even  none     1      1  FLN$DISK_NXTA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Std        0  FLN$DISK_NXTA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:123  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DISK_IN                             ANY_FILES_IN_ACCT
     M$DISK00                              M$DISK01                              M$DISK02
     M$DISK03                              DISK_NAME                             FROM_DISK_NAME
     FROM_DISK_ACCT                        FROM_DISK_SN                          DISK_OPEN_NEXT
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:124  


      569        1        /*T***********************************************************/
      570        2        /*T*                                                         */
      571        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      572        4        /*T*                                                         */
      573        5        /*T***********************************************************/
      574        6        FLN$DISK_NXTA: PROC;

      6  7 000000   000000 700200 xent  FLN$DISK_NX* TSX0  ! X66_AUTO_0
         7 000001   000004 000000                    ZERO    4,0

      575        7        /*F*  NAME: FLN$DISK_NXTA
      576        8              PURPOSE: Set up to force next account.
      577        9        */
      578       10
      579       11        /***
      580       12         *** INCLUDE
      581       13         ***/
      582       14
      583       15        %INCLUDE CP_6;
      584     5574        %INCLUDE FLN_DATA_R;
      585     6311
      586     6312        /****************************************/
      587     6313
      588     6314    1      DISK_OPEN_NEXT.V.OPER.THISF# = '0'B;

   6314  7 000002   000000 236000 8                  LDQ     0
         7 000003   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

      589     6315    1      DISK_OPEN_NEXT.V.OPER.NXTF# = '1'B;

   6315  7 000004   004000 236007                    LDQ     2048,DL
         7 000005   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      590     6316    1      DISK_OPEN_NEXT.V.OPER.NXTA# = '1'B;

   6316  7 000006   010000 236007                    LDQ     4096,DL
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:125  
         7 000007   000044 256000 xsym               ORSQ    DISK_OPEN_NEXT+36

      591     6317    1      DISK_NAME.NAME# = ' ';

   6317  7 000010   040000 100400                    MLR     fill='040'O
         7 000011   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 000012   000000 200037 xsym               ADSC9   DISK_NAME                cn=1,n=31

      592     6318    1      DISK_NAME.L# = 0;

   6318  7 000013   000000 236003                    LDQ     0,DU
         7 000014   000000 552040 xsym               STBQ    DISK_NAME,'40'O

      593     6319    1      ANY_FILES_IN_ACCT = '0'B;

   6319  7 000015   000000 450000 xsym               STZ     ANY_FILES_IN_ACCT

      594     6320
      595     6321    1      RETURN;

   6321  7 000016   000000 702200 xent               TSX2  ! X66_ARET
      596     6322
      597     6323    1   END FLN$DISK_NXTA;
      598     6324        %EOD;

PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:126  
--  Include file information  --

   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLN$DISK_NXTA.
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:127  

 **** Variables and constants ****

  ****  Section 006  Data  FLN$DISK_NXTA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/d STRC(1080)  r     1 CLOSE_BLOCK_FILE           0-0-0/d STRC(2088)  r     1 OPEN_BLOCK_FILE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 ANY_FILES_IN_ACCT          0-0-0/c STRC(288)   r     1 DISK_NAME
     0-0-0/d STRC(2088)  r     1 DISK_OPEN_NEXT             0-0-0/c STRC(72)    r     1 FROM_DISK_ACCT
     0-0-0/c STRC(288)   r     1 FROM_DISK_NAME             0-0-0/d STRC(90)    r     1 FROM_DISK_SN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DISK_IN


   Procedure FLN$DISK_NXTA requires 15 words for executable code.
   Procedure FLN$DISK_NXTA requires 4 words of local(AUTO) storage.
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:128  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:129  
          MINI XREF LISTING

ANY_FILES_IN_ACCT
      5583**DCL      6319<<ASSIGN
CLOSE_BLOCK_FILE.SN_
      6253**DCL      6253--REDEF
CLOSE_BLOCK_FILE.UTL_
      6254**DCL      6254--REDEF
CLOSE_BLOCK_FILE.V
      6258**DCL      6253--DCLINIT
CLOSE_BLOCK_FILE.V.EXPIRE#
      6268**DCL      6268--REDEF
CLOSE_BLOCK_FILE.V.TYPE#
      6266**DCL      6266--REDEF
CLOSE_BLOCK_FILE.V.XTNSIZE#
      6263**DCL      6263--REDEF    6265--REDEF
DISK_CLOSE_NEXT.SN_
      5950**DCL      5950--REDEF
DISK_CLOSE_NEXT.UTL_
      5951**DCL      5951--REDEF
DISK_CLOSE_NEXT.V.EXPIRE#
      5965**DCL      5965--REDEF
DISK_CLOSE_NEXT.V.TYPE#
      5963**DCL      5963--REDEF
DISK_CLOSE_NEXT.V.XTNSIZE#
      5960**DCL      5960--REDEF    5962--REDEF
DISK_CLOSE_ORDINARY.SN_
      5992**DCL      5992--REDEF
DISK_CLOSE_ORDINARY.UTL_
      5993**DCL      5993--REDEF
DISK_CLOSE_ORDINARY.V.EXPIRE#
      6007**DCL      6007--REDEF
DISK_CLOSE_ORDINARY.V.TYPE#
      6005**DCL      6005--REDEF
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:130  
DISK_CLOSE_ORDINARY.V.XTNSIZE#
      6002**DCL      6002--REDEF    6004--REDEF
DISK_NAME.L#
      5614**DCL      6318<<ASSIGN
DISK_NAME.NAME#
      5614**DCL      6317<<ASSIGN
DISK_OPEN_NEXT.ACSVEH_
      5776**DCL      5777--REDEF
DISK_OPEN_NEXT.ALTKEYS_
      5782**DCL      5783--REDEF    5783--REDEF
DISK_OPEN_NEXT.HDR_
      5781**DCL      5782--REDEF
DISK_OPEN_NEXT.TAB_
      5780**DCL      5781--REDEF
DISK_OPEN_NEXT.UHL_
      5774**DCL      5775--REDEF    5775--REDEF
DISK_OPEN_NEXT.V.FSN#
      5814**DCL      5814--REDEF    5814--REDEF
DISK_OPEN_NEXT.V.OPER.NXTA#
      5786**DCL      6316<<ASSIGN
DISK_OPEN_NEXT.V.OPER.NXTF#
      5786**DCL      6315<<ASSIGN
DISK_OPEN_NEXT.V.OPER.THISF#
      5786**DCL      6314<<ASSIGN
DISK_OPEN_NEXT.WSN_
      5780**DCL      5780--REDEF
DISK_OPEN_ORDINARY.ACSVEH_
      5885**DCL      5886--REDEF
DISK_OPEN_ORDINARY.ALTKEYS_
      5891**DCL      5892--REDEF    5892--REDEF
DISK_OPEN_ORDINARY.HDR_
      5890**DCL      5891--REDEF
DISK_OPEN_ORDINARY.TAB_
      5889**DCL      5890--REDEF
DISK_OPEN_ORDINARY.UHL_
      5883**DCL      5884--REDEF    5884--REDEF
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:131  
DISK_OPEN_ORDINARY.V.FSN#
      5923**DCL      5923--REDEF    5923--REDEF
DISK_OPEN_ORDINARY.WSN_
      5889**DCL      5889--REDEF
FROM_DISK_ACCT
      5667**DCL      6191--DCLINIT
FROM_DISK_NAME
      5641**DCL      6187--DCLINIT
FROM_DISK_SN
      5693**DCL      6186--DCLINIT
OPEN_BLOCK_FILE.ACSVEH_
      6188**DCL      6189--REDEF
OPEN_BLOCK_FILE.ALTKEYS_
      6194**DCL      6195--REDEF    6195--REDEF
OPEN_BLOCK_FILE.HDR_
      6193**DCL      6194--REDEF
OPEN_BLOCK_FILE.TAB_
      6192**DCL      6193--REDEF
OPEN_BLOCK_FILE.UHL_
      6186**DCL      6187--REDEF    6187--REDEF
OPEN_BLOCK_FILE.V
      6195**DCL      6186--DCLINIT
OPEN_BLOCK_FILE.V.FSN#
      6226**DCL      6226--REDEF    6226--REDEF
OPEN_BLOCK_FILE.WSN_
      6192**DCL      6192--REDEF
READ_AD_OR_FD.ACSVEH_
      6078**DCL      6079--REDEF
READ_AD_OR_FD.ALTKEYS_
      6084**DCL      6085--REDEF    6085--REDEF
READ_AD_OR_FD.HDR_
      6083**DCL      6084--REDEF
READ_AD_OR_FD.TAB_
      6082**DCL      6083--REDEF
READ_AD_OR_FD.UHL_
      6076**DCL      6077--REDEF    6077--REDEF
PL6.E3A0      #004=FLN$DISK_NXTA File=FLN$ROUTINES.:E05TSI                       TUE 07/29/97 16:14 Page:132  
READ_AD_OR_FD.V.FSN#
      6116**DCL      6116--REDEF    6116--REDEF
READ_AD_OR_FD.WSN_
      6082**DCL      6082--REDEF

PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:133  
      599        1        /*T***********************************************************/
      600        2        /*T*                                                         */
      601        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      602        4        /*T*                                                         */
      603        5        /*T***********************************************************/
      604        6        FLN$DISK_CLOSE_NEXT: PROC( DCBN );
      605        7        /*F*  NAME: FLN$DISK_CLOSE_NEXT
      606        8              PURPOSE: Close specified DCB by internal number.
      607        9        */
      608       10
      609       11    1   DCL DCBN SBIN;                          /* Internal number of DCB to close    */
      610       12
      611       13        /***
      612       14         *** INCLUDE
      613       15         ***/
      614       16
      615       17        %INCLUDE CP_6;
      616     5576        %INCLUDE FLN_DATA_R;
      617     6313
      618     6314        /***
      619     6315         *** ENTRY
      620     6316         ***/
      621     6317
      622     6318    1   DCL FLI$RPT_ERR ENTRY(5);
      623     6319
      624     6320        /***
      625     6321         *** BASED
      626     6322         ***/
      627     6323
      628     6324        %F$DCB;
      629     6381
      630     6382        /****************************************/
      631     6383
      632     6384        /***
      633     6385         *** Close DCB if it's open.
      634     6386         ***/
      635     6387
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:134  
      636     6388    1      IF DISK_DCBLIST.DCB$(DCBN)->F$DCB.FCD#
      637     6389    2       THEN DO;                            /* Close DCB                          */
      638     6390    2         DISK_CLOSE_NEXT.V.DCB# = DISK_DCBLIST.DCB#(DCBN);
      639     6391    2         CALL M$CLOSE( DISK_CLOSE_NEXT )
      640     6392    3          WHENALTRETURN DO;
      641     6393    3            CALL FLI$RPT_ERR;
      642     6394    3            END;
      643     6395    2         END;
      644     6396
      645     6397        /***
      646     6398         *** Link DCB back onto free list.
      647     6399         ***/
      648     6400
      649     6401    1      DISK_DCBLIST.NEXT_IX(DCBN) = FIRST_FREE_DCB;
      650     6402    1      FIRST_FREE_DCB = DCBN;
      651     6403    1      DISK_CLOSE_NEXT.V.EFTOPER = '0'B;    /* Clear for next call                */
      652     6404
      653     6405    1      RETURN;
      654     6406
      655     6407    1   END FLN$DISK_CLOSE_NEXT;

PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:135  
--  Include file information  --

   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLN$DISK_CLOSE_NEXT.

   Procedure FLN$DISK_CLOSE_NEXT requires 34 words for executable code.
   Procedure FLN$DISK_CLOSE_NEXT requires 4 words of local(AUTO) storage.

    No errors detected in file FLN$ROUTINES.:E05TSI    .

PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:136  

 Object Unit name= FLN$DISK_CLOSE_NEXT                        File name= FLN$ROUTINES.:E05TOU
 UTS= JUL 29 '97 16:15:17.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DISK_IN
    2   DCB   even  none     0      0  M$DISK00
    3   DCB   even  none     0      0  M$DISK01
    4   DCB   even  none     0      0  M$DISK02
    5   DCB   even  none     0      0  M$DISK03
    6   Data  even  none    88    130  FLN$DISK_CLOSE_NEXT
    7   Proc  even  none    34     42  FLN$DISK_CLOSE_NEXT
    8  RoData even  none     1      1  FLN$DISK_CLOSE_NEXT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Std        1  FLN$DISK_CLOSE_NEXT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:137  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DISK_IN                             FIRST_FREE_DCB
     M$DISK00                              M$DISK01                              M$DISK02
     M$DISK03                              DISK_DCBLIST                          FROM_DISK_NAME
     FROM_DISK_ACCT                        FROM_DISK_SN                          DISK_CLOSE_NEXT
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:138  


      599        1        /*T***********************************************************/
      600        2        /*T*                                                         */
      601        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      602        4        /*T*                                                         */
      603        5        /*T***********************************************************/
      604        6        FLN$DISK_CLOSE_NEXT: PROC( DCBN );

      6  7 000000   000000 700200 xent  FLN$DISK_CL* TSX0  ! X66_AUTO_1
         7 000001   000004 000001                    ZERO    4,1

      605        7        /*F*  NAME: FLN$DISK_CLOSE_NEXT
      606        8              PURPOSE: Close specified DCB by internal number.
      607        9        */
      608       10
      609       11    1   DCL DCBN SBIN;                          /* Internal number of DCB to close    */
      610       12
      611       13        /***
      612       14         *** INCLUDE
      613       15         ***/
      614       16
      615       17        %INCLUDE CP_6;
      616     5576        %INCLUDE FLN_DATA_R;
      617     6313
      618     6314        /***
      619     6315         *** ENTRY
      620     6316         ***/
      621     6317
      622     6318    1   DCL FLI$RPT_ERR ENTRY(5);
      623     6319
      624     6320        /***
      625     6321         *** BASED
      626     6322         ***/
      627     6323
      628     6324        %F$DCB;
      629     6381
      630     6382        /****************************************/
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:139  
      631     6383
      632     6384        /***
      633     6385         *** Close DCB if it's open.
      634     6386         ***/
      635     6387
      636     6388    1      IF DISK_DCBLIST.DCB$(DCBN)->F$DCB.FCD#

   6388  7 000002   200003 470500                    LDP0    @DCBN,,AUTO
         7 000003   000000 235100                    LDA     0,,PR0
         7 000004   000002 735000                    ALS     2
         7 000005   000001 735000                    ALS     1
         7 000006   000001 471405 xsym               LDP1    DISK_DCBLIST+1,AL
         7 000007   100031 236100                    LDQ     25,,PR1
         7 000010   020000 316007                    CANQ    8192,DL
         7 000011   000027 600000 7                  TZE     s:6401

      637     6389    2       THEN DO;                            /* Close DCB                          */

      638     6390    2         DISK_CLOSE_NEXT.V.DCB# = DISK_DCBLIST.DCB#(DCBN);

   6390  7 000012   000000 235100                    LDA     0,,PR0
         7 000013   000002 735000                    ALS     2
         7 000014   000001 735000                    ALS     1
         7 000015   000000 720005 xsym               LXL0    DISK_DCBLIST,AL
         7 000016   000032 740000 xsym               STX0    DISK_CLOSE_NEXT+26

      639     6391    2         CALL M$CLOSE( DISK_CLOSE_NEXT )

   6391  7 000017   000000 630400 xsym               EPPR0   DISK_CLOSE_NEXT
         7 000020   450001 713400                    CLIMB   alt,close
         7 000021   406000 401760                    pmme    nvectors=13
         7 000022   000024 702000 7                  TSX2    s:6393
         7 000023   000027 710000 7                  TRA     s:6401

      640     6392    3          WHENALTRETURN DO;

      641     6393    3            CALL FLI$RPT_ERR;
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:140  

   6393  7 000024   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000025   000000 701000 xent               TSX1    FLI$RPT_ERR
         7 000026   000000 011000                    NOP     0

      642     6394    3            END;

      643     6395    2         END;

      644     6396
      645     6397        /***
      646     6398         *** Link DCB back onto free list.
      647     6399         ***/
      648     6400
      649     6401    1      DISK_DCBLIST.NEXT_IX(DCBN) = FIRST_FREE_DCB;

   6401  7 000027   200003 470500                    LDP0    @DCBN,,AUTO
         7 000030   000000 235100                    LDA     0,,PR0
         7 000031   000002 735000                    ALS     2
         7 000032   000001 735000                    ALS     1
         7 000033   000000 236000 xsym               LDQ     FIRST_FREE_DCB
         7 000034   000003 756005 xsym               STQ     DISK_DCBLIST+3,AL

      650     6402    1      FIRST_FREE_DCB = DCBN;

   6402  7 000035   000000 235100                    LDA     0,,PR0
         7 000036   000000 755000 xsym               STA     FIRST_FREE_DCB

      651     6403    1      DISK_CLOSE_NEXT.V.EFTOPER = '0'B;    /* Clear for next call                */

   6403  7 000037   000000 236000 8                  LDQ     0
         7 000040   000032 356000 xsym               ANSQ    DISK_CLOSE_NEXT+26

      652     6404
      653     6405    1      RETURN;

   6405  7 000041   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:141  
      654     6406
      655     6407    1   END FLN$DISK_CLOSE_NEXT;

PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:142  
--  Include file information  --

   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLN$DISK_CLOSE_NEXT.
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:143  

 **** Variables and constants ****

  ****  Section 006  Data  FLN$DISK_CLOSE_NEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/d STRC(1080)  r     1 CLOSE_BLOCK_FILE           0-0-0/d STRC(2088)  r     1 OPEN_BLOCK_FILE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCBN                     *0-0-0/w SBIN        r     1 DCBN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1080)  r     1 DISK_CLOSE_NEXT
     0-0-0/d STRC(252)   r     1 DISK_DCBLIST(0:8191)
     0-0-0/w SBIN        r     1 FIRST_FREE_DCB             0-0-0/c STRC(72)    r     1 FROM_DISK_ACCT
     0-0-0/c STRC(288)   r     1 FROM_DISK_NAME             0-0-0/d STRC(90)    r     1 FROM_DISK_SN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DISK_IN


   Procedure FLN$DISK_CLOSE_NEXT requires 34 words for executable code.
   Procedure FLN$DISK_CLOSE_NEXT requires 4 words of local(AUTO) storage.
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:144  

    No errors detected in file FLN$ROUTINES.:E05TSI    .
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:145  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:146  
          MINI XREF LISTING

CLOSE_BLOCK_FILE.SN_
      6255**DCL      6255--REDEF
CLOSE_BLOCK_FILE.UTL_
      6256**DCL      6256--REDEF
CLOSE_BLOCK_FILE.V
      6260**DCL      6255--DCLINIT
CLOSE_BLOCK_FILE.V.EXPIRE#
      6270**DCL      6270--REDEF
CLOSE_BLOCK_FILE.V.TYPE#
      6268**DCL      6268--REDEF
CLOSE_BLOCK_FILE.V.XTNSIZE#
      6265**DCL      6265--REDEF    6267--REDEF
DCBN
        11**DCL         6--PROC     6388>>IF       6390>>ASSIGN   6401>>ASSIGN   6402>>ASSIGN
DISK_CLOSE_NEXT
      5952**DCL      6391<>CALL
DISK_CLOSE_NEXT.SN_
      5952**DCL      5952--REDEF
DISK_CLOSE_NEXT.UTL_
      5953**DCL      5953--REDEF
DISK_CLOSE_NEXT.V.DCB#
      5958**DCL      6390<<ASSIGN
DISK_CLOSE_NEXT.V.EFTOPER
      5959**DCL      6403<<ASSIGN
DISK_CLOSE_NEXT.V.EXPIRE#
      5967**DCL      5967--REDEF
DISK_CLOSE_NEXT.V.TYPE#
      5965**DCL      5965--REDEF
DISK_CLOSE_NEXT.V.XTNSIZE#
      5962**DCL      5962--REDEF    5964--REDEF
DISK_CLOSE_ORDINARY.SN_
      5994**DCL      5994--REDEF
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:147  
DISK_CLOSE_ORDINARY.UTL_
      5995**DCL      5995--REDEF
DISK_CLOSE_ORDINARY.V.EXPIRE#
      6009**DCL      6009--REDEF
DISK_CLOSE_ORDINARY.V.TYPE#
      6007**DCL      6007--REDEF
DISK_CLOSE_ORDINARY.V.XTNSIZE#
      6004**DCL      6004--REDEF    6006--REDEF
DISK_DCBLIST.DCB#
      5589**DCL      6390>>ASSIGN
DISK_DCBLIST.DCB$
      5589**DCL      6388>>IF
DISK_DCBLIST.NEXT_IX
      5590**DCL      6401<<ASSIGN
DISK_OPEN_NEXT.ACSVEH_
      5778**DCL      5779--REDEF
DISK_OPEN_NEXT.ALTKEYS_
      5784**DCL      5785--REDEF    5785--REDEF
DISK_OPEN_NEXT.HDR_
      5783**DCL      5784--REDEF
DISK_OPEN_NEXT.TAB_
      5782**DCL      5783--REDEF
DISK_OPEN_NEXT.UHL_
      5776**DCL      5777--REDEF    5777--REDEF
DISK_OPEN_NEXT.V.FSN#
      5816**DCL      5816--REDEF    5816--REDEF
DISK_OPEN_NEXT.WSN_
      5782**DCL      5782--REDEF
DISK_OPEN_ORDINARY.ACSVEH_
      5887**DCL      5888--REDEF
DISK_OPEN_ORDINARY.ALTKEYS_
      5893**DCL      5894--REDEF    5894--REDEF
DISK_OPEN_ORDINARY.HDR_
      5892**DCL      5893--REDEF
DISK_OPEN_ORDINARY.TAB_
      5891**DCL      5892--REDEF
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:148  
DISK_OPEN_ORDINARY.UHL_
      5885**DCL      5886--REDEF    5886--REDEF
DISK_OPEN_ORDINARY.V.FSN#
      5925**DCL      5925--REDEF    5925--REDEF
DISK_OPEN_ORDINARY.WSN_
      5891**DCL      5891--REDEF
F$DCB.ACTPOS
      6357**DCL      6357--REDEF
F$DCB.ARS#
      6331**DCL      6331--REDEF
F$DCB.ATTR
      6350**DCL      6351--REDEF
F$DCB.BORROW
      6365**DCL      6365--REDEF    6365--REDEF    6365--REDEF
F$DCB.DCBNAME.L
      6379**DCL      6379--IMP-SIZ
F$DCB.EOMCHAR#
      6335**DCL      6335--REDEF
F$DCB.FCD#
      6344**DCL      6388>>IF
F$DCB.FLDID
      6360**DCL      6360--REDEF
F$DCB.FORM$
      6354**DCL      6354--REDEF
F$DCB.FSECT
      6370**DCL      6370--REDEF
F$DCB.FSN#
      6347**DCL      6347--REDEF    6347--REDEF    6348--REDEF
F$DCB.HEADER$
      6353**DCL      6353--REDEF
F$DCB.IXTNSIZE#
      6351**DCL      6351--REDEF
F$DCB.LASTSTA$
      6340**DCL      6340--REDEF
F$DCB.LVL
      6366**DCL      6366--REDEF
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:149  
F$DCB.NAME#.C
      6341**DCL      6341--REDEF
F$DCB.NOEOF
      6363**DCL      6363--REDEF
F$DCB.NRECS#
      6352**DCL      6352--REDEF
F$DCB.NRECX
      6371**DCL      6371--REDEF
F$DCB.OHDR
      6363**DCL      6363--REDEF
F$DCB.ORG#
      6346**DCL      6346--REDEF
F$DCB.PRECNO
      6369**DCL      6369--REDEF
F$DCB.RCSZ
      6375**DCL      6375--REDEF
F$DCB.RES#
      6342**DCL      6342--REDEF
F$DCB.SETX
      6354**DCL      6354--REDEF
F$DCB.TAB$
      6354**DCL      6354--REDEF
F$DCB.TDA
      6368**DCL      6369--REDEF
F$DCB.WSN#
      6342**DCL      6342--REDEF
FIRST_FREE_DCB
      5584**DCL      6401>>ASSIGN   6402<<ASSIGN
FLI$RPT_ERR
      6318**DCL-ENT  6393--CALL
FROM_DISK_ACCT
      5669**DCL      6193--DCLINIT
FROM_DISK_NAME
      5643**DCL      6189--DCLINIT
FROM_DISK_SN
      5695**DCL      6188--DCLINIT
PL6.E3A0      #005=FLN$DISK_CLOSE_NEXT File=FLN$ROUTINES.:E05TSI                 TUE 07/29/97 16:15 Page:150  
M$CLOSE
      5504**DCL-ENT  6391--CALL
OPEN_BLOCK_FILE.ACSVEH_
      6190**DCL      6191--REDEF
OPEN_BLOCK_FILE.ALTKEYS_
      6196**DCL      6197--REDEF    6197--REDEF
OPEN_BLOCK_FILE.HDR_
      6195**DCL      6196--REDEF
OPEN_BLOCK_FILE.TAB_
      6194**DCL      6195--REDEF
OPEN_BLOCK_FILE.UHL_
      6188**DCL      6189--REDEF    6189--REDEF
OPEN_BLOCK_FILE.V
      6197**DCL      6188--DCLINIT
OPEN_BLOCK_FILE.V.FSN#
      6228**DCL      6228--REDEF    6228--REDEF
OPEN_BLOCK_FILE.WSN_
      6194**DCL      6194--REDEF
READ_AD_OR_FD.ACSVEH_
      6080**DCL      6081--REDEF
READ_AD_OR_FD.ALTKEYS_
      6086**DCL      6087--REDEF    6087--REDEF
READ_AD_OR_FD.HDR_
      6085**DCL      6086--REDEF
READ_AD_OR_FD.TAB_
      6084**DCL      6085--REDEF
READ_AD_OR_FD.UHL_
      6078**DCL      6079--REDEF    6079--REDEF
READ_AD_OR_FD.V.FSN#
      6118**DCL      6118--REDEF    6118--REDEF
READ_AD_OR_FD.WSN_
      6084**DCL      6084--REDEF
