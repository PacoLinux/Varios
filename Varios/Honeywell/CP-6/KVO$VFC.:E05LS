VERSION E05

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:1    
        1        1        /*M* KVO$VFC VDH VFC HANDLING ROUTINES                                        */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVO$VFC: PROC (VFC);
        9        9
       10       10 S      %INCLUDE KV$GLB;                        /* VDH Global structures              */
       11       11 S      %INCLUDE KV$GLBCTX;                     /* VDH Global context                 */
       12       12 S      %INCLUDE KV$INT;                        /* VDH internal structures            */
       13       13 S      %INCLUDE KV$USR;                        /* VDH to VDH-user request structures */
       14       14 S      %INCLUDE KV$VDH;                        /* VDH-user to VDH request structures */
       15       15        %INCLUDE KV_ASCCHR_E;                   /* Equates for ASCII characters       */
       16      152 S      %INCLUDE KV_GLBCNS_E;                   /* Virtual device handler constants   */
       17      153        %KV_PHSPSTMOD_E;
       18      160
       19      161        %KV_VFC_E;                              /*  VFC DEFINITIONS                   */
       20      180        %KV$MRD;                                /*  REAL DEVICE CONTEXT BLOCK         */
       21      227        %KV$MVD;                                /*  VIRTUAL DEVICE CONTEXT BLOCK      */
       22      271        %KV$PTR;                                /*  VDH POINTER BLOCK                 */
       23      314        %KV$SRD;                                /*  SUBORDINATE REAL DEVICE CONTEXT   */
       24      589        %KV$STR;                                /*  STREAM CONTEXT                    */
       25      676        %KV$VDH_OTPLCL;                         /*  ARGUMENT STRUCTURE                */
       26      749        %KV$VDH_PST;                            /*  ARGUMENT TO VDH POSITION ROUTINE  */
       27      823        %KV$VDI;                                /*  VDI CONTEXT                       */
       28      894        %KV$VFU;                                /*  VFU IMAGE TEMPLATE                */
       29      941
       30      942        %KV$VFC (NAME = VFC, STCLASS = "");     /* ARG                                */
       31      967
       32      968        /* VFC FUNCTION                                                               */
       33      969
       34      970    1   DCL VFCFNC AUTO UBIN ALIGNED;
       35      971
       36      972        /* VFC COUNT/PARAMETER                                                        */
       37      973
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:2    
       38      974        %EQU VFCPRM = CHARTEXT('VDH_PST.PSTVAL.LIN');
       39      975
       40      976    1   DCL WRTVFC BIT(1) ALIGNED;
       41      977
       42      978        %KV$VDH_PST(NAME = VDH_PST, STCLASS = AUTO);
       43     1052        %KV$VDH_PST(NAME = KV_VDH_PST_NEWLIN_VRT, STCLASS = SYMREF);
       44     1126        %KV$VDH_PST(NAME = KV_VDH_PST_CR_VRT, STCLASS = SYMREF);
       45     1200        %KV$VDH_PST(NAME = KV_VDH_PST_LF_VRT, STCLASS = SYMREF);
       46     1274        %KV$VDH_PST(NAME = KV_VDH_PST_VRT, STCLASS = SYMREF);
       47     1348        %KV$VDH_PST(NAME = KV_VDH_PST_WHTSPC_CR, STCLASS = SYMREF);
       48     1422
       49     1423    1   DCL KVO$ERSSRD ENTRY;
       50     1424    1   DCL KVO$PST ENTRY(1);
       51     1425    1   DCL KVO$PAGBRK ENTRY;
       52     1426    1   DCL KVO$PAGBRKNO_TTL ENTRY;
       53     1427    1   DCL KVO$SCREND ENTRY;
       54     1428    1   DCL KVO$UP_SPC_NO_PAGBRK_PST ENTRY(1);
       55     1429
       56     1430    1   KVO$VFCAFTTXT: ENTRY (VFC);
       57     1431
       58     1432        /* DO VFC AFTER TEXT.                                                         */
       59     1433    1      WRTVFC = '1'B;
       60     1434    1   VFCAFTX:;
       61     1435
       62     1436    1      VDH_PST = KV_VDH_PST_NEWLIN_VRT;
       63     1437    1      VFCFNC = VFC.FNC;
       64     1438    1      %VFCPRM = VFC.PRM;
       65     1439
       66     1440    2      DO CASE( VFCFNC );
       67     1441    2      CASE(%KV#VFCFNCSPC );
       68     1442
       69     1443        /* THIS IS THE SPECIAL VFC FUNCTION.                                          */
       70     1444
       71     1445    3         IF (%VFCPRM = %KV#SPCVFCSKPCLRLINBFRPRTNL) THEN DO;
       72     1446
       73     1447        /* TRANSITION VFC (SKIP TO CLEAR LINE BEFORE PRINTING, THEN NEW-LINE)         */
       74     1448
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:3    
       75     1449        /* DO CARRIAGE RETURN                                                         */
       76     1450        /* SKIP TO A CLEAR LINE                                                       */
       77     1451        /* PRINT TEXT                                                                 */
       78     1452        /* DO A CARRIAGE RETURN AND LINE FEED                                         */
       79     1453
       80     1454    3            CALL KVO$PST(KV_VDH_PST_NEWLIN_VRT);
       81     1455    3         END; ELSE IF (%VFCPRM = %KV#SPCVFCPAG) THEN DO;
       82     1456
       83     1457        /* GO TO LIMBO, DO NOT CAUSE TOP OF FORM                                      */
       84     1458
       85     1459
       86     1460        /* IF THERE IS A FORM GO TO LIMBO WITHOUT DOING A TOF                         */
       87     1461
       88     1462    3            IF %KV_MVD.PAGBRKPND THEN EXIT;
       89     1463    4            IF (%KV_MVD.LNG > 11) THEN DO;
       90     1464    4               %VFCPRM = 1000;
       91     1465    4               GOTO DO_N_LFS;
       92     1466    4            END; ELSE DO;
       93     1467    4               IF NOT %KV_SRD.SCROLL THEN CALL KVO$PST (KV_VDH_PST_WHTSPC_CR);
       94     1468    4               ELSE IF %KV_SRD.CRT.LIN+%KV_SRD.DVCLINBIS<%KV_SRD.BTMRHT.LIN
       95     1469    5               THEN DO;
       96     1470    5                  %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.BTMRHT.LIN-1;
       97     1471    5                  %KV_SRD.DVCLINBIS = 1;
       98     1472    5                  %KV_SRD.VRTPSTOK = '0'B;
       99     1473    5                  %KV_MVD.VRTCLM = 1;
      100     1474    5               END;
      101     1475    4               %KV_MVD.PAGBRKPND = '1'B;
      102     1476    4            END /* IF */;
      103     1477    3         END; ELSE IF %VFCPRM=%KV#SPCVFCCLRWND THEN DO;
      104     1478    3            IF %KV_MRD.CTNFRM OR NOT %KV_MRD.CURSORUP THEN EXIT;
      105     1479        /*
      106     1480           Clear-the-window VFC.
      107     1481        */
      108     1482    3            %KV_SRD.DVCLINBIS = 0;
      109     1483    3            %KV_VDI.OTPCNDPND.PST = %KV_PHSPSTMOD_SKP;
      110     1484    3            %KV_MVD.VRTCLM = 1;
      111     1485    3            %KV_SRD.CRT_PST = %KV_SRD.TOPLFT_PST;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:4    
      112     1486    3            %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.TOPLFT.LIN;
      113     1487    3            CALL KVO$ERSSRD;
      114     1488    3         END /* IF */;
      115     1489    2      CASE(%KV#VFCFNCSKPCHNAFTPRT );
      116     1490
      117     1491        /* SKIP TO CHANNEL AFTER PRINTING                                             */
      118     1492
      119     1493        /* DO CARRIAGE RETURN                                                         */
      120     1494        /* PRINT TEXT                                                                 */
      121     1495        /* DO CARRIAGE RETURN                                                         */
      122     1496        /* SKIP TO SPECIFIED CHANNEL                                                  */
      123     1497
      124     1498    2         CALL SKPCHN ALTRET (DO_N_LFS);
      125     1499    2      CASE(%KV#VFCFNCSPCN_AFTPRT );
      126     1500
      127     1501
      128     1502        /* DO CARRIAGE RETURN IF N > 0                                                  */
      129     1503        /* PRINT TEXT                                                                 */
      130     1504        /* DO CARRIAGE RETURN IF N > 0                                                  */
      131     1505        /* DO N LINE FEEDS (N CAN BE 0).                                              */
      132     1506
      133     1507    2         IF (%VFCPRM ~= 0) THEN GOTO DO_N_LFS;
      134     1508    2      CASE(%KV#VFCFNCSPCPST );
      135     1509
      136     1510        /* PRINT TEXT AS A PAGE HEADING.                                              */
      137     1511
      138     1512        /* DO CARRIAGE RETURN                                                         */
      139     1513        /* GO TO TOP OF FORM; DON'T PRINT THE HEADER.                                 */
      140     1514        /* PRINT TEXT.                                                                */
      141     1515        /* DO CARRIAGE RETURN                                                         */
      142     1516        /* DO N LINE FEEDS.                                                           */
      143     1517
      144     1518    3         IF (%VFCPRM ~= 0) AND WRTVFC THEN DO;
      145     1519    3   DO_N_LFS:;
      146     1520    3            CALL KVO$UP_SPC_NO_PAGBRK_PST(VDH_PST);
      147     1521    3         END /* IF */;
      148     1522    2      END /* CASE */;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:5    
      149     1523    1      RETURN;
      150     1524        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:6    
      151     1525    1   KVO$VFCAFTPRM: ENTRY (VFC);
      152     1526    1      WRTVFC = '0'B;
      153     1527    1      GOTO VFCAFTX;
      154     1528        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:7    
      155     1529    1   KVO$VFCBFRTXT: ENTRY (VFC);
      156     1530        /* DO VFC BEFORE TEXT.                                                        */
      157     1531    1      WRTVFC = '1'B;
      158     1532    1   VFCBFRX:;
      159     1533
      160     1534    1      VFCFNC = VFC.FNC;
      161     1535
      162     1536    2      IF NOT %KV_SRD.VRTPSTOK THEN DO;
      163     1537        /* THE VIRTUAL POSITION WASN'T OK WHEN WE ENTERED THIS ROUTINE.               */
      164     1538        /* POSITION TO THE CURRENT VIRTUAL COLUMN.                                    */
      165     1539
      166     1540    2         CALL KVO$PST(KV_VDH_PST_VRT);
      167     1541    2      END /* IF */;
      168     1542        /* IF THERE IS A PAGE BREAK PENDING, FORCE IT BEFORE PRINTING THE CURRENT     */
      169     1543        /* LINE.                                                                      */
      170     1544
      171     1545    2      IF %KV_MVD.PAGBRKPND THEN DO;
      172     1546
      173     1547        /* IF THIS IS HEADER VFC, A HEADER WILL FALL OUT BELOW, SO DONT               */
      174     1548        /* GO TO TOF NOW                                                              */
      175     1549
      176     1550    3         IF BITBIN(VFC)<112 AND BITBIN(VFC)~=26 OR NOT WRTVFC THEN DO;
      177     1551    3            CALL KVO$PAGBRK;
      178     1552    3            %KV_VDI.DVCPGNENB = '1'B;
      179     1553    3         END /* IF */;
      180     1554    2      END /* IF */;
      181     1555
      182     1556    1      VDH_PST = KV_VDH_PST_NEWLIN_VRT;
      183     1557    1      %VFCPRM = VFC.PRM;
      184     1558
      185     1559    2      DO CASE( VFCFNC );
      186     1560
      187     1561    2      CASE(%KV#VFCFNCSPC );
      188     1562
      189     1563        /* THIS IS THE SPECIAL VFC FUNCTION.                                          */
      190     1564
      191     1565    3         IF %VFCPRM ~= %KV#SPCVFCPAG THEN DO;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:8    
      192     1566
      193     1567        /* TRANSITION VFC (SKIP TO CLEAR LINE, PRINT, THEN NEW-LINE                   */
      194     1568        /* IF %KV#SPCVFCSKPCLRLINBFRPRTNL).                                            */
      195     1569
      196     1570        /* DO CARRIAGE RETURN                                                         */
      197     1571        /* SKIP TO A CLEAR LINE                                                       */
      198     1572        /* PRINT TEXT                                                                 */
      199     1573        /* DO A CARRIAGE RETURN AND LINE FEED IF %KV#SPCVFCSKPCLRLINBFRPRTNL)          */
      200     1574
      201     1575    3            CALL KVO$PST (KV_VDH_PST_WHTSPC_CR);
      202     1576    3         END /* IF */;
      203     1577    2      CASE(%KV#VFCFNCSKPCHNBFRPRT );
      204     1578
      205     1579        /* SKIP TO CHANNEL BEFORE PRINTING                                            */
      206     1580
      207     1581        /* DO CARRIAGE RETURN                                                         */
      208     1582        /* SKIP TO SPECIFIED CHANNEL                                                  */
      209     1583        /* PRINT TEXT                                                                 */
      210     1584
      211     1585    2         CALL SKPCHN ALTRET (UP_N_LFS);
      212     1586
      213     1587    2      CASE(%KV#VFCFNCSKPCHNAFTPRT );
      214     1588
      215     1589        /* SKIP TO CHANNEL AFTER PRINTING                                             */
      216     1590
      217     1591        /* DO CARRIAGE RETURN                                                         */
      218     1592        /* PRINT TEXT                                                                 */
      219     1593        /* DO CARRIAGE RETURN                                                         */
      220     1594        /* SKIP TO SPECIFIED CHANNEL                                                  */
      221     1595
      222     1596    2         CALL KVO$PST(KV_VDH_PST_CR_VRT);
      223     1597
      224     1598    2      CASE(%KV#VFCFNCSPCN_AFTPRT );
      225     1599
      226     1600
      227     1601        /* DO CARRIAGE RETURN IF N > 0                                                  */
      228     1602        /* PRINT TEXT                                                                 */
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:9    
      229     1603        /* DO CARRIAGE RETURN IF N > 0                                                  */
      230     1604        /* DO N LINE FEEDS (N CAN BE 0).                                              */
      231     1605
      232     1606    3         IF (%VFCPRM ~= 0) THEN DO;
      233     1607    3            CALL KVO$PST(KV_VDH_PST_CR_VRT);
      234     1608    3         END /* IF */;
      235     1609    2      CASE(%KV#VFCFNCSPCN_BFRPRT );
      236     1610
      237     1611        /* UPSPACE N LINES BEFORE TEXT.                                               */
      238     1612
      239     1613        /* DO CARRIAGE RETURN                                                         */
      240     1614        /* DO N LINE FEEDS (N CAN BE 0)                                               */
      241     1615        /* PRINT TEXT                                                                 */
      242     1616    2   UP_N_LFS:;
      243     1617    2         CALL KVO$UP_SPC_NO_PAGBRK_PST(VDH_PST);
      244     1618
      245     1619        /* IF THIS UPSPACE CAUSED A PAGE BREAK, WE WANT TO REPEAT THE UPSPACE ON      */
      246     1620        /* THE NEXT PAGE AFTER GIVING THE USER THE PAGE BREAK                         */
      247     1621
      248     1622    3         IF %KV_MVD.PAGBRKPND THEN DO;
      249     1623    3            CALL KVO$PAGBRK;
      250     1624
      251     1625        /* IF THE NUMBER OF LINES TO UPSPACE WILL NOT TAKE US OVER ANOTHER PAGE       */
      252     1626        /* WE REPEAT THE UPSPACE, OTHERWISE WE FORGET IT                              */
      253     1627
      254     1628    4            IF %KV_MVD.LNG-%KV_MVD.FRMLIN-%VFCPRM > 0 THEN DO;
      255     1629    4               CALL KVO$PST(VDH_PST);
      256     1630    4            END /* IF */;
      257     1631    3         END /* IF */;
      258     1632    2      CASE(%KV#VFCFNCSPCPST );
      259     1633    3         IF NOT WRTVFC THEN DO;
      260     1634
      261     1635        /* SPECIAL POSITIONING FOR PROMPTS.                                           */
      262     1636
      263     1637        /* DO CARRIAGE RETURN                                                         */
      264     1638        /* IF CURSOR NOT IN WHITE SPACE, GO TO LEFT MARGIN IN WHITE SPACE.            */
      265     1639        /* DO N LINE FEEDS (N CAN BE 0).                                              */
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:10   
      266     1640        /* PRINT TEXT.                                                                */
      267     1641
      268     1642    4            IF (%KV_SRD.HI_NONBLN.LIN >= %KV_SRD.CRT.LIN) THEN DO;
      269     1643    4               %VFCPRM = %VFCPRM+%KV_SRD.HI_NONBLN.LIN-%KV_SRD.CRT.LIN+1;
      270     1644    4            END /* IF */;
      271     1645    3            CALL KVO$PST(VDH_PST);
      272     1646    3         END; ELSE DO;
      273     1647
      274     1648        /* PRINT TEXT AS A PAGE HEADING.                                              */
      275     1649
      276     1650        /* DO CARRIAGE RETURN                                                         */
      277     1651        /* GO TO TOP OF FORM* PRINT TEXT.                                             */
      278     1652        /* DO CARRIAGE RETURN                                                         */
      279     1653        /* DO N LINE FEEDS.                                                           */
      280     1654
      281     1655
      282     1656        /* IF THERE IS NO FORM ON THIS TERMINAL, GIVE HIM ONE UPSPACE                 */
      283     1657        /* OTHERWISE, DO A TITLE-LESS PAGBRK                                          */
      284     1658
      285     1659    4            IF (%KV_MVD.LNG < 12) THEN DO;
      286     1660    4               CALL KVO$PST(KV_VDH_PST_NEWLIN_VRT);
      287     1661    4            END; ELSE DO;
      288     1662    4               %KV_MVD.VRTCLM = 1;         /* DO A CR TOO                        */
      289     1663    4               CALL KVO$PAGBRKNO_TTL;
      290     1664    4            END /* IF */;
      291     1665    3            %KV_VDI.DVCPGNENB = '1'B;
      292     1666    3         END /* IF */;
      293     1667    2      END /* CASE */;
      294     1668    1      RETURN;
      295     1669        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:11   
      296     1670    1   KVO$VFCBFRPRM: ENTRY (VFC);
      297     1671    1      WRTVFC = '0'B;
      298     1672    1      GOTO VFCBFRX;
      299     1673        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:12   
      300     1674    1   SKPCHN: PROC ALTRET;
      301     1675        /* SKIP TO SPECIFIED CHANNEL                                                  */
      302     1676
      303     1677
      304     1678        /* IF WE WANT TO GO TO CHANNEL 0, DO IT DIRECTLY                              */
      305     1679
      306     1680    3      IF (%VFCPRM = 0) THEN DO;
      307     1681
      308     1682        /* IF THERE IS NO FORM, UPSPACE 1                                             */
      309     1683
      310     1684    3         IF %KV_MVD.LNG < 12
      311     1685    3         THEN CALL KVO$PST(KV_VDH_PST_NEWLIN_VRT);
      312     1686
      313     1687    4         ELSE DO;
      314     1688    4            %VFCPRM = 1000;                /* SKIP TO PAGE-BOTTOM                */
      315     1689    4            ALTRETURN;           /* BUT ONLY THE CALLER KNOWS WHAT TO DO NEXT    */
      316     1690    4         END /* IF */;
      317     1691
      318     1692    3         RETURN;
      319     1693    3      END;
      320     1694
      321     1695    2      CALL VFU_SRCH;
      322     1696
      323     1697        /* UPSPACE COUNT LINES                                                     */
      324     1698
      325     1699    2      CALL KVO$UP_SPC_NO_PAGBRK_PST(VDH_PST);
      326     1700
      327     1701        /* IF THIS UPSPACE CAUSED A PAGE BREAK, WE WANT TO REPEAT THE UPSPACE ON   */
      328     1702        /* THE NEXT PAGE AFTER GIVING THE USER THE PAGE BREAK                      */
      329     1703
      330     1704    3      IF %KV_MVD.PAGBRKPND AND VFCFNC = %KV#VFCFNCSKPCHNBFRPRT THEN DO;
      331     1705    3         CALL KVO$PAGBRK;
      332     1706
      333     1707        /* IF THE NUMBER OF LINES TO UPSPACE WILL NOT TAKE US OVER ANOTHER PAGE    */
      334     1708        /* WE REPEAT THE UPSPACE, OTHERWISE WE FORGET IT                           */
      335     1709
      336     1710    3         %VFCPRM = VFC.PRM;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:13   
      337     1711    3         CALL VFU_SRCH;
      338     1712
      339     1713    4         IF %KV_MVD.LNG-%KV_MVD.FRMLIN-%VFCPRM > 0 THEN DO;
      340     1714    4            CALL KVO$PST(VDH_PST);
      341     1715    4         END /* IF */;
      342     1716    3      END /* IF */;
      343     1717
      344     1718    2      RETURN;
      345     1719
      346     1720    2   END /* PROC */;
      347     1721        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:14   
      348     1722    1   VFU_SRCH: PROC;
      349     1723
      350     1724
      351     1725        /* SEARCH THE VFU IMAGE (IF ONE EXISTS) TO SEE IF A VALID PUNCH EXISTS        */
      352     1726        /* BETWEEN WHERE WE ARE AND THE END OF THE LOGICAL FORM. ON ENTRY %VFCPRM        */
      353     1727        /* CONTAINS THE CHANNEL TO LOOK FOR. ON EXIT, %VFCPRM CONTAINS THE NUMBER OF     */
      354     1728        /* LINES TO UPSPACE. THIS WILL BE 0 IF NO VALID PUNCHES EXIST AND             */
      355     1729        /* NUMBER OF LINES LEFT ON THE PAGE + 1 IF PUNCHES EXIST, BUT NOT IN A        */
      356     1730        /* VALID RANGE                                                                */
      357     1731
      358     1732
      359     1733        /* IF NO VFU IMAGE EXISTS, NO PUNCHES CAN EXIST                               */
      360     1734
      361     1735    2      IF (%KV_MVD.VFU$ = ADDR(NIL)) THEN RETURN;
      362     1736
      363     1737        /* IF NO PUNCH EXISTS IN THE PRIMARY CHANNEL, NO PUNCHES MAY EXIST            */
      364     1738        /* AT ALL                                                                     */
      365     1739
      366     1740    2      IF (%KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM) = 0) THEN RETURN;
      367     1741
      368     1742        /* WE KNOW THAT AT LEAST ONE PUNCH EXISTS. THIS LOOP SCANS THE VFU            */
      369     1743        /* IMAGE LOOKING FOR A GOOD PUNCH                                             */
      370     1744
      371     1745    3      DO WHILE (%VFCPRM ~= 0);
      372     1746
      373     1747        /* IF THE CURRENT PUNCH IS FOR A LINE > CURRENT LINE AND LESS THAN            */
      374     1748        /* LOGICAL FORM LENGTH, WE GOT A WINNER                                       */
      375     1749
      376     1750    4         IF %KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM) > %KV_MVD.FRMLIN THEN DO;
      377     1751    5            IF (%KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM) < %KV_MVD.LNG) THEN DO;
      378     1752
      379     1753        /* MOVE THE NUMBER OF LF'S NECESSARY TO GET TO THIS LINE INTO %VFCPRM            */
      380     1754
      381     1755    5               %VFCPRM = %KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM)-%KV_MVD.FRMLIN;
      382     1756    5               RETURN;
      383     1757    5            END /* IF */;
      384     1758    4         END /* IF */;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:15   
      385     1759
      386     1760        /* IF ANOTHER PUNCH EXISTS FOR THIS CHANNEL, TRY IT                           */
      387     1761
      388     1762    3         %VFCPRM = %KV_MVD.VFU$->KV$VFU.NXT(%VFCPRM);
      389     1763
      390     1764        /* NO MORE PUNCHES EXIST, SO PLACE A VALUE INTO %VFCPRM WHICH WILL PUT US        */
      391     1765        /* INTO LIMBO                                                                 */
      392     1766
      393     1767    3      END /* LOOP */;
      394     1768    2      %VFCPRM = %KV_MVD.LNG - %KV_MVD.FRMLIN + 1;
      395     1769    2      RETURN;
      396     1770    2   END /* SUBROUTINE */;
      397     1771    1   END;
      398     1772        %EOD;

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:16   
--  Include file information  --

   KV_ASCCHR_E.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$VFC.

   Procedure KVO$VFC requires 725 words for executable code.
   Procedure KVO$VFC requires 18 words of local(AUTO) storage.

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:17   

 Object Unit name= KVO$VFC                                    File name= KVO$VFC.:E05TOU
 UTS= JUL 30 '97 02:11:58.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none   725    2D5  KVO$VFC
    1  RoData even  none     8      8  KVO$VFC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KVO$VFC
     0      7                  yes      Std        1  KVO$VFCAFTTXT
     0     E4                  yes      Std        1  KVO$VFCAFTPRM
     0     ED                  yes      Std        1  KVO$VFCBFRTXT
     0    205                  yes      Std        1  KVO$VFCBFRPRM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KVO$PST
         yes           Std       0 KVO$ERSSRD
         yes           Std       0 KVO$PAGBRKNO_TTL
         yes           Std       1 KVO$UP_SPC_NO_PAGBRK_PST
         yes           Std       0 KVO$PAGBRK
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:18   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KV$PTR$                               KV_VDH_PST_NEWLIN_VRT                 KV_VDH_PST_CR_VRT
     KV_VDH_PST_VRT                        KV_VDH_PST_WHTSPC_CR             r    G$ROS$
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:19   


        1        1        /*M* KVO$VFC VDH VFC HANDLING ROUTINES                                        */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        KVO$VFC: PROC (VFC);

      8   0 000000  D380 0000 0000  xent KVO$VFC         LNJ,B5   X6A_AUTO_1
          0 000003       0012 0001                       DC       18,1
          0 000005  0F81 0006                            B        s:1433,PREL

        9        9
       10       10 S      %INCLUDE KV$GLB;                        /* VDH Global structures              */
       11       11 S      %INCLUDE KV$GLBCTX;                     /* VDH Global context                 */
       12       12 S      %INCLUDE KV$INT;                        /* VDH internal structures            */
       13       13 S      %INCLUDE KV$USR;                        /* VDH to VDH-user request structures */
       14       14 S      %INCLUDE KV$VDH;                        /* VDH-user to VDH request structures */
       15       15        %INCLUDE KV_ASCCHR_E;                   /* Equates for ASCII characters       */
       16      152 S      %INCLUDE KV_GLBCNS_E;                   /* Virtual device handler constants   */
       17      153        %KV_PHSPSTMOD_E;
       18      160
       19      161        %KV_VFC_E;                              /*  VFC DEFINITIONS                   */
       20      180        %KV$MRD;                                /*  REAL DEVICE CONTEXT BLOCK         */
       21      227        %KV$MVD;                                /*  VIRTUAL DEVICE CONTEXT BLOCK      */
       22      271        %KV$PTR;                                /*  VDH POINTER BLOCK                 */
       23      314        %KV$SRD;                                /*  SUBORDINATE REAL DEVICE CONTEXT   */
       24      589        %KV$STR;                                /*  STREAM CONTEXT                    */
       25      676        %KV$VDH_OTPLCL;                         /*  ARGUMENT STRUCTURE                */
       26      749        %KV$VDH_PST;                            /*  ARGUMENT TO VDH POSITION ROUTINE  */
       27      823        %KV$VDI;                                /*  VDI CONTEXT                       */
       28      894        %KV$VFU;                                /*  VFU IMAGE TEMPLATE                */
       29      941
       30      942        %KV$VFC (NAME = VFC, STCLASS = "");     /* ARG                                */
       31      967
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:20   
       32      968        /* VFC FUNCTION                                                               */
       33      969
       34      970    1   DCL VFCFNC AUTO UBIN ALIGNED;
       35      971
       36      972        /* VFC COUNT/PARAMETER                                                        */
       37      973
       38      974        %EQU VFCPRM = CHARTEXT('VDH_PST.PSTVAL.LIN');
       39      975
       40      976    1   DCL WRTVFC BIT(1) ALIGNED;
       41      977
       42      978        %KV$VDH_PST(NAME = VDH_PST, STCLASS = AUTO);
       43     1052        %KV$VDH_PST(NAME = KV_VDH_PST_NEWLIN_VRT, STCLASS = SYMREF);
       44     1126        %KV$VDH_PST(NAME = KV_VDH_PST_CR_VRT, STCLASS = SYMREF);
       45     1200        %KV$VDH_PST(NAME = KV_VDH_PST_LF_VRT, STCLASS = SYMREF);
       46     1274        %KV$VDH_PST(NAME = KV_VDH_PST_VRT, STCLASS = SYMREF);
       47     1348        %KV$VDH_PST(NAME = KV_VDH_PST_WHTSPC_CR, STCLASS = SYMREF);
       48     1422
       49     1423    1   DCL KVO$ERSSRD ENTRY;
       50     1424    1   DCL KVO$PST ENTRY(1);
       51     1425    1   DCL KVO$PAGBRK ENTRY;
       52     1426    1   DCL KVO$PAGBRKNO_TTL ENTRY;
       53     1427    1   DCL KVO$SCREND ENTRY;
       54     1428    1   DCL KVO$UP_SPC_NO_PAGBRK_PST ENTRY(1);
       55     1429
       56     1430    1   KVO$VFCAFTTXT: ENTRY (VFC);

   1430   0 000007  D380 0000 0000  xent KVO$VFCAFTTXT   LNJ,B5   X6A_AUTO_1
          0 00000A       0012 0001                       DC       18,1

       57     1431
       58     1432        /* DO VFC AFTER TEXT.                                                         */
       59     1433    1      WRTVFC = '1'B;

   1433   0 00000C  8947 0007                            LBT,'8000'X       WRTVFC,AUTO
   1433   0 00000E       8000

   1433   0                              VFCAFTX         null
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:21   
       60     1434    1   VFCAFTX:;
       61     1435
       62     1436    1      VDH_PST = KV_VDH_PST_NEWLIN_VRT;

   1436   0 00000F  AB80 0000 0000  xsym VFCAFTX         LAB,B2   KV_VDH_PST_NEWLIN_VRT
          0 000012  2C00                                 LDV,R2   0
          0 000013  6C08                                 LDV,R6   8
          0 000014  BB87                                 LAB,B3   ,AUTO
          0 000015  3C10                                 LDV,R3   16
          0 000016  0008                                 MMM

       63     1437    1      VFCFNC = VFC.FNC;

   1437   0 000017  ECC7 0004                            LDB,B6   @VFC,AUTO
          0 000019  E806                                 LDR,R6   ,B6
          0 00001A  604C                                 SOR,R6   12
          0 00001B  E570 0007                            AND,R6   7,IMO
          0 00001D  EF47 0006                            STR,R6   VFCFNC,AUTO

       64     1438    1      %VFCPRM = VFC.PRM;

   1438   0 00001F  D806                                 LDR,R5   ,B6
          0 000020  5048                                 SOR,R5   8
          0 000021  D570 000F                            AND,R5   15,IMO
          0 000023  DF47 000A                            STR,R5   VDH_PST+2,AUTO

       65     1439
       66     1440    2      DO CASE( VFCFNC );

   1440   0 000025  B856                                 LDR,R3   R6
          0 000026  3D08                                 CMV,R3   8
          0 000027  0281 00B9                            BGE      s:1523,PREL
          0 000029  A830 0000 002F  00                   LDR,R2   s:1440+10,R3
          0 00002C  83A0 0000 0037  00                   JMP      s:1445,R2
          0 00002F       00AA                            DC       s:1523,PREL
          0 000030       0000                            DC       s:1445,PREL
          0 000031       00AA                            DC       s:1523,PREL
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:22   
          0 000032       00AA                            DC       s:1523,PREL
          0 000033       0094                            DC       s:1507,PREL
          0 000034       008F                            DC       s:1498,PREL
          0 000035       00AA                            DC       s:1523,PREL
          0 000036       0098                            DC       s:1518,PREL

       67     1441    2      CASE(%KV#VFCFNCSPC );

       68     1442
       69     1443        /* THIS IS THE SPECIAL VFC FUNCTION.                                          */
       70     1444
       71     1445    3         IF (%VFCPRM = %KV#SPCVFCSKPCLRLINBFRPRTNL) THEN DO;

   1445   0 000037  5D0F                                 CMV,R5   15
          0 000038  0981 000C                            BNE      s:1455+2,PREL

       72     1446
       73     1447        /* TRANSITION VFC (SKIP TO CLEAR LINE BEFORE PRINTING, THEN NEW-LINE)         */
       74     1448
       75     1449        /* DO CARRIAGE RETURN                                                         */
       76     1450        /* SKIP TO A CLEAR LINE                                                       */
       77     1451        /* PRINT TEXT                                                                 */
       78     1452        /* DO A CARRIAGE RETURN AND LINE FEED                                         */
       79     1453
       80     1454    3            CALL KVO$PST(KV_VDH_PST_NEWLIN_VRT);

   1454   0 00003A  BB80 0000 0000  01                   LAB,B3   0
          0 00003D  CBF0 0100                            LAB,B4   256,IMO
          0 00003F  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 000042       0001                            DC       s:1455,PREL

       81     1455    3         END; ELSE IF (%VFCPRM = %KV#SPCVFCPAG) THEN DO;

   1455   0 000043  0F81 009D                            B        s:1523,PREL

   1455   0 000045  5D0A                                 CMV,R5   10
          0 000046  0981 004D                            BNE      s:1477+2,PREL
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:23   

       82     1456
       83     1457        /* GO TO LIMBO, DO NOT CAUSE TOP OF FORM                                      */
       84     1458
       85     1459
       86     1460        /* IF THERE IS A FORM GO TO LIMBO WITHOUT DOING A TOF                         */
       87     1461
       88     1462    3            IF %KV_MVD.PAGBRKPND THEN EXIT;

   1462   0 000048  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 00004B  CCC5 0006                            LDB,B4   6,B5
          0 00004D  82C4 0016                            LB,'0001'X        22,B4
          0 00004F       0001
          0 000050  0501 0041                            BBT      s:1477,PREL

       89     1463    4            IF (%KV_MVD.LNG > 11) THEN DO;

   1463   0 000052  C2C4 0014                            LLH,R4   20,B4
          0 000054  4D0B                                 CMV,R4   11
          0 000055  0381 0007                            BLE      s:1467,PREL

       90     1464    4               %VFCPRM = 1000;

   1464   0 000057  D870 03E8                            LDR,R5   1000,IMO
          0 000059  DF47 000A                            STR,R5   VDH_PST+2,AUTO

       91     1465    4               GOTO DO_N_LFS;

   1465   0 00005B  0F81 0079                            B        s:1518,PREL

       92     1466    4            END; ELSE DO;

       93     1467    4               IF NOT %KV_SRD.SCROLL THEN CALL KVO$PST (KV_VDH_PST_WHTSPC_CR);

   1467   0 00005D  ACC5 000A                            LDB,B2   10,B5
          0 00005F  82C2 000E                            LB,'0008'X        14,B2
          0 000061       0008
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:24   
          0 000062  0501 000C                            BBT      s:1468,PREL

   1467   0 000064  BB80 0000 0002  01                   LAB,B3   +2
          0 000067  CBF0 0100                            LAB,B4   256,IMO
          0 000069  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 00006C       0001                            DC       s:1467+16,PREL
          0 00006D  0F81 001C                            B        s:1475,PREL

       94     1468    4               ELSE IF %KV_SRD.CRT.LIN+%KV_SRD.DVCLINBIS<%KV_SRD.BTMRHT.LIN

   1468   0 00006F  9842 0015                            LDR,R1   21,B2
          0 000071  9A42 0019                            ADD,R1   25,B2
          0 000073  9942 000B                            CMR,R1   11,B2
          0 000075  0881 0014                            BAGE     s:1475,PREL

       95     1469    5               THEN DO;

       96     1470    5                  %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.BTMRHT.LIN-1;

   1470   0 000077  9842 000B                            LDR,R1   11,B2
          0 000079  1EFF                                 ADV,R1   -1
          0 00007A  9F42 0013                            STR,R1   19,B2

       97     1471    5                  %KV_SRD.DVCLINBIS = 1;

   1471   0 00007C  CCC5 000A                            LDB,B4   10,B5
          0 00007E  4C01                                 LDV,R4   1
          0 00007F  CF44 0019                            STR,R4   25,B4

       98     1472    5                  %KV_SRD.VRTPSTOK = '0'B;

   1472   0 000081  CCC5 000A                            LDB,B4   10,B5
          0 000083  8844 000E                            LBF,'0010'X       14,B4
          0 000085       0010

       99     1473    5                  %KV_MVD.VRTCLM = 1;

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:25   
   1473   0 000086  CCC5 0006                            LDB,B4   6,B5
          0 000088  CF44 001B                            STR,R4   27,B4

      100     1474    5               END;

      101     1475    4               %KV_MVD.PAGBRKPND = '1'B;

   1475   0 00008A  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 00008D  DCC6 0006                            LDB,B5   6,B6
          0 00008F  8945 0016                            LBT,'0001'X       22,B5
          0 000091       0001

      102     1476    4            END /* IF */;

      103     1477    3         END; ELSE IF %VFCPRM=%KV#SPCVFCCLRWND THEN DO;

   1477   0 000092  0F81 004E                            B        s:1523,PREL

   1477   0 000094  5D0D                                 CMV,R5   13
          0 000095  0981 004B                            BNE      s:1523,PREL

      104     1478    3            IF %KV_MRD.CTNFRM OR NOT %KV_MRD.CURSORUP THEN EXIT;

   1478   0 000097  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 00009A  CCC5 0008                            LDB,B4   8,B5
          0 00009C  82C4 0018                            LB,'0800'X        24,B4
          0 00009E       0800
          0 00009F  0501 0024                            BBT      s:1488,PREL
          0 0000A1  82C4 0017                            LB,'0002'X        23,B4
          0 0000A3       0002
          0 0000A4  0581 001F                            BBF      s:1488,PREL

      105     1479        /*
      106     1480           Clear-the-window VFC.
      107     1481        */
      108     1482    3            %KV_SRD.DVCLINBIS = 0;

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:26   
   1482   0 0000A6  ACC5 000A                            LDB,B2   10,B5
          0 0000A8  8742 0019                            CL       25,B2

      109     1483    3            %KV_VDI.OTPCNDPND.PST = %KV_PHSPSTMOD_SKP;

   1483   0 0000AA  CC85                                 LDB,B4   ,B5
          0 0000AB  4C01                                 LDV,R4   1
          0 0000AC  CF44 001A                            STR,R4   26,B4

      110     1484    3            %KV_MVD.VRTCLM = 1;

   1484   0 0000AE  CCC5 0006                            LDB,B4   6,B5
          0 0000B0  CF44 001B                            STR,R4   27,B4

      111     1485    3            %KV_SRD.CRT_PST = %KV_SRD.TOPLFT_PST;

   1485   0 0000B2  CCC5 000A                            LDB,B4   10,B5
          0 0000B4  8CC4 0009                            LDI      9,B4
          0 0000B6  8D44 0015                            SDI      21,B4

      112     1486    3            %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.TOPLFT.LIN;

   1486   0 0000B8  CCC5 000A                            LDB,B4   10,B5
          0 0000BA  E844 0009                            LDR,R6   9,B4
          0 0000BC  EF44 0013                            STR,R6   19,B4

      113     1487    3            CALL KVO$ERSSRD;

   1487   0 0000BE  CBF0 0000                            LAB,B4   0,IMO
          0 0000C0  E380 0000 0000  xent                 LNJ,B6   KVO$ERSSRD
          0 0000C3       0001                            DC       s:1488,PREL

      114     1488    3         END /* IF */;

   1488   0 0000C4  0F81 001C                            B        s:1523,PREL

      115     1489    2      CASE(%KV#VFCFNCSKPCHNAFTPRT );
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:27   

      116     1490
      117     1491        /* SKIP TO CHANNEL AFTER PRINTING                                             */
      118     1492
      119     1493        /* DO CARRIAGE RETURN                                                         */
      120     1494        /* PRINT TEXT                                                                 */
      121     1495        /* DO CARRIAGE RETURN                                                         */
      122     1496        /* SKIP TO SPECIFIED CHANNEL                                                  */
      123     1497
      124     1498    2         CALL SKPCHN ALTRET (DO_N_LFS);

   1498   0 0000C6  E3C0 0147                            LNJ,B6   s:0,PREL
          0 0000C8       000D                            DC       s:1518,PREL
          0 0000C9  0F81 0017                            B        s:1523,PREL

      125     1499    2      CASE(%KV#VFCFNCSPCN_AFTPRT );

      126     1500
      127     1501
      128     1502        /* DO CARRIAGE RETURN IF N > 0                                                  */
      129     1503        /* PRINT TEXT                                                                 */
      130     1504        /* DO CARRIAGE RETURN IF N > 0                                                  */
      131     1505        /* DO N LINE FEEDS (N CAN BE 0).                                              */
      132     1506
      133     1507    2         IF (%VFCPRM ~= 0) THEN GOTO DO_N_LFS;

   1507   0 0000CB  5981 0009                            BNEZ,R5  s:1518,PREL
          0 0000CD  0F81 0013                            B        s:1523,PREL

      134     1508    2      CASE(%KV#VFCFNCSPCPST );

      135     1509
      136     1510        /* PRINT TEXT AS A PAGE HEADING.                                              */
      137     1511
      138     1512        /* DO CARRIAGE RETURN                                                         */
      139     1513        /* GO TO TOP OF FORM; DON'T PRINT THE HEADER.                                 */
      140     1514        /* PRINT TEXT.                                                                */
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:28   
      141     1515        /* DO CARRIAGE RETURN                                                         */
      142     1516        /* DO N LINE FEEDS.                                                           */
      143     1517
      144     1518    3         IF (%VFCPRM ~= 0) AND WRTVFC THEN DO;

   1518   0 0000CF  5901 0011                            BEZ,R5   s:1523,PREL
          0 0000D1  89C7 0007                            CMZ      WRTVFC,AUTO
          0 0000D3  0881 000D                            BAGE     s:1523,PREL

   1518   0                              DO_N_LFS        null
      145     1519    3   DO_N_LFS:;
      146     1520    3            CALL KVO$UP_SPC_NO_PAGBRK_PST(VDH_PST);

   1520   0 0000D5  EBC7 0008            DO_N_LFS        LAB,B6   VDH_PST,AUTO
          0 0000D7  EFC7 0010                            STB,B6   VDH_PST+8,AUTO
          0 0000D9  BBC7 0010                            LAB,B3   VDH_PST+8,AUTO
          0 0000DB  CBF0 0100                            LAB,B4   256,IMO
          0 0000DD  E380 0000 0000  xent                 LNJ,B6   KVO$UP_SPC_NO_PAGBRK_PST
          0 0000E0       0001                            DC       s:1523,PREL

      147     1521    3         END /* IF */;

      148     1522    2      END /* CASE */;

      149     1523    1      RETURN;

   1523   0 0000E1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      150     1524        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:29   
      151     1525    1   KVO$VFCAFTPRM: ENTRY (VFC);

   1525   0 0000E4  D380 0000 0000  xent KVO$VFCAFTPRM   LNJ,B5   X6A_AUTO_1
          0 0000E7       0012 0001                       DC       18,1

      152     1526    1      WRTVFC = '0'B;

   1526   0 0000E9  8747 0007                            CL       WRTVFC,AUTO

      153     1527    1      GOTO VFCAFTX;

   1527   0 0000EB  0F81 FF23                            B        s:1433,PREL

      154     1528        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:30   
      155     1529    1   KVO$VFCBFRTXT: ENTRY (VFC);

   1529   0 0000ED  D380 0000 0000  xent KVO$VFCBFRTXT   LNJ,B5   X6A_AUTO_1
          0 0000F0       0012 0001                       DC       18,1

      156     1530        /* DO VFC BEFORE TEXT.                                                        */
      157     1531    1      WRTVFC = '1'B;

   1531   0 0000F2  8947 0007                            LBT,'8000'X       WRTVFC,AUTO
   1531   0 0000F4       8000

   1531   0                              VFCBFRX         null
      158     1532    1   VFCBFRX:;
      159     1533
      160     1534    1      VFCFNC = VFC.FNC;

   1534   0 0000F5  ECC7 0004            VFCBFRX         LDB,B6   @VFC,AUTO
          0 0000F7  E806                                 LDR,R6   ,B6
          0 0000F8  604C                                 SOR,R6   12
          0 0000F9  E570 0007                            AND,R6   7,IMO
          0 0000FB  EF47 0006                            STR,R6   VFCFNC,AUTO

      161     1535
      162     1536    2      IF NOT %KV_SRD.VRTPSTOK THEN DO;

   1536   0 0000FD  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 000100  CCC5 000A                            LDB,B4   10,B5
          0 000102  82C4 000E                            LB,'0010'X        14,B4
          0 000104       0010
          0 000105  0501 000A                            BBT      s:1545,PREL

      163     1537        /* THE VIRTUAL POSITION WASN'T OK WHEN WE ENTERED THIS ROUTINE.               */
      164     1538        /* POSITION TO THE CURRENT VIRTUAL COLUMN.                                    */
      165     1539
      166     1540    2         CALL KVO$PST(KV_VDH_PST_VRT);

   1540   0 000107  BB80 0000 0004  01                   LAB,B3   +4
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:31   
          0 00010A  CBF0 0100                            LAB,B4   256,IMO
          0 00010C  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 00010F       0001                            DC       s:1545,PREL

      167     1541    2      END /* IF */;

      168     1542        /* IF THERE IS A PAGE BREAK PENDING, FORCE IT BEFORE PRINTING THE CURRENT     */
      169     1543        /* LINE.                                                                      */
      170     1544
      171     1545    2      IF %KV_MVD.PAGBRKPND THEN DO;

   1545   0 000110  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 000113  DCC6 0006                            LDB,B5   6,B6
          0 000115  82C5 0016                            LB,'0001'X        22,B5
          0 000117       0001
          0 000118  0581 001B                            BBF      s:1556,PREL

      172     1546
      173     1547        /* IF THIS IS HEADER VFC, A HEADER WILL FALL OUT BELOW, SO DONT               */
      174     1548        /* GO TO TOF NOW                                                              */
      175     1549
      176     1550    3         IF BITBIN(VFC)<112 AND BITBIN(VFC)~=26 OR NOT WRTVFC THEN DO;

   1550   0 00011A  CCC7 0004                            LDB,B4   @VFC,AUTO
          0 00011C  E284                                 LLH,R6   ,B4
          0 00011D  6D70                                 CMV,R6   112
          0 00011E  0281 0004                            BGE      s:1550+9,PREL
          0 000120  6D1A                                 CMV,R6   26
          0 000121  0981 0005                            BNE      s:1551,PREL
          0 000123  89C7 0007                            CMZ      WRTVFC,AUTO
          0 000125  0801 000E                            BAL      s:1556,PREL

      177     1551    3            CALL KVO$PAGBRK;

   1551   0 000127  CBF0 0000                            LAB,B4   0,IMO
          0 000129  E380 0000 0000  xent                 LNJ,B6   KVO$PAGBRK
          0 00012C       0001                            DC       s:1552,PREL
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:32   

      178     1552    3            %KV_VDI.DVCPGNENB = '1'B;

   1552   0 00012D  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 000130  DC86                                 LDB,B5   ,B6
          0 000131  8945 0019                            LBT,'0004'X       25,B5
          0 000133       0004

      179     1553    3         END /* IF */;

      180     1554    2      END /* IF */;

      181     1555
      182     1556    1      VDH_PST = KV_VDH_PST_NEWLIN_VRT;

   1556   0 000134  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_PST_NEWLIN_VRT
          0 000137  2C00                                 LDV,R2   0
          0 000138  6C08                                 LDV,R6   8
          0 000139  BB87                                 LAB,B3   ,AUTO
          0 00013A  3C10                                 LDV,R3   16
          0 00013B  0008                                 MMM

      183     1557    1      %VFCPRM = VFC.PRM;

   1557   0 00013C  ECC7 0004                            LDB,B6   @VFC,AUTO
          0 00013E  E806                                 LDR,R6   ,B6
          0 00013F  6048                                 SOR,R6   8
          0 000140  E570 000F                            AND,R6   15,IMO
          0 000142  EF47 000A                            STR,R6   VDH_PST+2,AUTO

      184     1558
      185     1559    2      DO CASE( VFCFNC );

   1559   0 000144  B847 0006                            LDR,R3   VFCFNC,AUTO
          0 000146  3D08                                 CMV,R3   8
          0 000147  0281 00BA                            BGE      s:1668,PREL
          0 000149  A830 0000 014F  00                   LDR,R2   s:1559+11,R3
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:33   
          0 00014C  83A0 0000 0157  00                   JMP      s:1565,R2
          0 00014F       00AB                            DC       s:1668,PREL
          0 000150       0000                            DC       s:1565,PREL
          0 000151       00AB                            DC       s:1668,PREL
          0 000152       000E                            DC       s:1585,PREL
          0 000153       001E                            DC       s:1606,PREL
          0 000154       0013                            DC       s:1596,PREL
          0 000155       002B                            DC       s:1609,PREL
          0 000156       0063                            DC       s:1633,PREL

      186     1560
      187     1561    2      CASE(%KV#VFCFNCSPC );

      188     1562
      189     1563        /* THIS IS THE SPECIAL VFC FUNCTION.                                          */
      190     1564
      191     1565    3         IF %VFCPRM ~= %KV#SPCVFCPAG THEN DO;

   1565   0 000157  6D0A                                 CMV,R6   10
          0 000158  0901 00A9                            BE       s:1668,PREL

      192     1566
      193     1567        /* TRANSITION VFC (SKIP TO CLEAR LINE, PRINT, THEN NEW-LINE                   */
      194     1568        /* IF %KV#SPCVFCSKPCLRLINBFRPRTNL).                                            */
      195     1569
      196     1570        /* DO CARRIAGE RETURN                                                         */
      197     1571        /* SKIP TO A CLEAR LINE                                                       */
      198     1572        /* PRINT TEXT                                                                 */
      199     1573        /* DO A CARRIAGE RETURN AND LINE FEED IF %KV#SPCVFCSKPCLRLINBFRPRTNL)          */
      200     1574
      201     1575    3            CALL KVO$PST (KV_VDH_PST_WHTSPC_CR);

   1575   0 00015A  BB80 0000 0002  01                   LAB,B3   +2
          0 00015D  CBF0 0100                            LAB,B4   256,IMO
          0 00015F  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 000162       0001                            DC       s:1576,PREL

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:34   
      202     1576    3         END /* IF */;

   1576   0 000163  0F81 009E                            B        s:1668,PREL

      203     1577    2      CASE(%KV#VFCFNCSKPCHNBFRPRT );

      204     1578
      205     1579        /* SKIP TO CHANNEL BEFORE PRINTING                                            */
      206     1580
      207     1581        /* DO CARRIAGE RETURN                                                         */
      208     1582        /* SKIP TO SPECIFIED CHANNEL                                                  */
      209     1583        /* PRINT TEXT                                                                 */
      210     1584
      211     1585    2         CALL SKPCHN ALTRET (UP_N_LFS);

   1585   0 000165  E3C0 00A8                            LNJ,B6   s:0,PREL
          0 000167       001B                            DC       s:1609,PREL
          0 000168  0F81 0099                            B        s:1668,PREL

      212     1586
      213     1587    2      CASE(%KV#VFCFNCSKPCHNAFTPRT );

      214     1588
      215     1589        /* SKIP TO CHANNEL AFTER PRINTING                                             */
      216     1590
      217     1591        /* DO CARRIAGE RETURN                                                         */
      218     1592        /* PRINT TEXT                                                                 */
      219     1593        /* DO CARRIAGE RETURN                                                         */
      220     1594        /* SKIP TO SPECIFIED CHANNEL                                                  */
      221     1595
      222     1596    2         CALL KVO$PST(KV_VDH_PST_CR_VRT);

   1596   0 00016A  BB80 0000 0006  01                   LAB,B3   +6
          0 00016D  CBF0 0100                            LAB,B4   256,IMO
          0 00016F  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 000172       0001                            DC       s:1596+9,PREL
          0 000173  0F81 008E                            B        s:1668,PREL
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:35   

      223     1597
      224     1598    2      CASE(%KV#VFCFNCSPCN_AFTPRT );

      225     1599
      226     1600
      227     1601        /* DO CARRIAGE RETURN IF N > 0                                                  */
      228     1602        /* PRINT TEXT                                                                 */
      229     1603        /* DO CARRIAGE RETURN IF N > 0                                                  */
      230     1604        /* DO N LINE FEEDS (N CAN BE 0).                                              */
      231     1605
      232     1606    3         IF (%VFCPRM ~= 0) THEN DO;

   1606   0 000175  6901 008C                            BEZ,R6   s:1668,PREL

      233     1607    3            CALL KVO$PST(KV_VDH_PST_CR_VRT);

   1607   0 000177  BB80 0000 0006  01                   LAB,B3   +6
          0 00017A  CBF0 0100                            LAB,B4   256,IMO
          0 00017C  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 00017F       0001                            DC       s:1608,PREL

      234     1608    3         END /* IF */;

   1608   0 000180  0F81 0081                            B        s:1668,PREL

      235     1609    2      CASE(%KV#VFCFNCSPCN_BFRPRT );

   1606   0                              UP_N_LFS        null
      236     1610
      237     1611        /* UPSPACE N LINES BEFORE TEXT.                                               */
      238     1612
      239     1613        /* DO CARRIAGE RETURN                                                         */
      240     1614        /* DO N LINE FEEDS (N CAN BE 0)                                               */
      241     1615        /* PRINT TEXT                                                                 */
      242     1616    2   UP_N_LFS:;
      243     1617    2         CALL KVO$UP_SPC_NO_PAGBRK_PST(VDH_PST);
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:36   

   1617   0 000182  EBC7 0008            UP_N_LFS        LAB,B6   VDH_PST,AUTO
          0 000184  EFC7 0010                            STB,B6   VDH_PST+8,AUTO
          0 000186  BBC7 0010                            LAB,B3   VDH_PST+8,AUTO
          0 000188  CBF0 0100                            LAB,B4   256,IMO
          0 00018A  E380 0000 0000  xent                 LNJ,B6   KVO$UP_SPC_NO_PAGBRK_PST
          0 00018D       0001                            DC       s:1622,PREL

      244     1618
      245     1619        /* IF THIS UPSPACE CAUSED A PAGE BREAK, WE WANT TO REPEAT THE UPSPACE ON      */
      246     1620        /* THE NEXT PAGE AFTER GIVING THE USER THE PAGE BREAK                         */
      247     1621
      248     1622    3         IF %KV_MVD.PAGBRKPND THEN DO;

   1622   0 00018E  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 000191  DCC6 0006                            LDB,B5   6,B6
          0 000193  82C5 0016                            LB,'0001'X        22,B5
          0 000195       0001
          0 000196  0581 006B                            BBF      s:1668,PREL

      249     1623    3            CALL KVO$PAGBRK;

   1623   0 000198  CBF0 0000                            LAB,B4   0,IMO
          0 00019A  E380 0000 0000  xent                 LNJ,B6   KVO$PAGBRK
          0 00019D       0001                            DC       s:1628,PREL

      250     1624
      251     1625        /* IF THE NUMBER OF LINES TO UPSPACE WILL NOT TAKE US OVER ANOTHER PAGE       */
      252     1626        /* WE REPEAT THE UPSPACE, OTHERWISE WE FORGET IT                              */
      253     1627
      254     1628    4            IF %KV_MVD.LNG-%KV_MVD.FRMLIN-%VFCPRM > 0 THEN DO;

   1628   0 00019E  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 0001A1  DCC6 0006                            LDB,B5   6,B6
          0 0001A3  E2C5 0014                            LLH,R6   20,B5
          0 0001A5  D2C5 001D                            LLH,R5   29,B5
          0 0001A7  E255                                 SUB,R6   R5
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:37   
          0 0001A8  E247 000A                            SUB,R6   VDH_PST+2,AUTO
          0 0001AA  6A81 0057                            BLEZ,R6  s:1668,PREL

      255     1629    4               CALL KVO$PST(VDH_PST);

   1629   0 0001AC  CBC7 0008                            LAB,B4   VDH_PST,AUTO
          0 0001AE  CFC7 0010                            STB,B4   VDH_PST+8,AUTO
          0 0001B0  BBC7 0010                            LAB,B3   VDH_PST+8,AUTO
          0 0001B2  CBF0 0100                            LAB,B4   256,IMO
          0 0001B4  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 0001B7       0001                            DC       s:1631,PREL

      256     1630    4            END /* IF */;

      257     1631    3         END /* IF */;

   1631   0 0001B8  0F81 0049                            B        s:1668,PREL

      258     1632    2      CASE(%KV#VFCFNCSPCPST );

      259     1633    3         IF NOT WRTVFC THEN DO;

   1633   0 0001BA  89C7 0007                            CMZ      WRTVFC,AUTO
          0 0001BC  0801 0020                            BAL      s:1659,PREL

      260     1634
      261     1635        /* SPECIAL POSITIONING FOR PROMPTS.                                           */
      262     1636
      263     1637        /* DO CARRIAGE RETURN                                                         */
      264     1638        /* IF CURSOR NOT IN WHITE SPACE, GO TO LEFT MARGIN IN WHITE SPACE.            */
      265     1639        /* DO N LINE FEEDS (N CAN BE 0).                                              */
      266     1640        /* PRINT TEXT.                                                                */
      267     1641
      268     1642    4            IF (%KV_SRD.HI_NONBLN.LIN >= %KV_SRD.CRT.LIN) THEN DO;

   1642   0 0001BE  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 0001C1  CCC5 000A                            LDB,B4   10,B5
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:38   
          0 0001C3  D844 0017                            LDR,R5   23,B4
          0 0001C5  D944 0015                            CMR,R5   21,B4
          0 0001C7  0801 0007                            BAL      s:1645,PREL

      269     1643    4               %VFCPRM = %VFCPRM+%KV_SRD.HI_NONBLN.LIN-%KV_SRD.CRT.LIN+1;

   1643   0 0001C9  EA55                                 ADD,R6   R5
          0 0001CA  E244 0015                            SUB,R6   21,B4
          0 0001CC  6E01                                 ADV,R6   1
          0 0001CD  EF47 000A                            STR,R6   VDH_PST+2,AUTO

      270     1644    4            END /* IF */;

      271     1645    3            CALL KVO$PST(VDH_PST);

   1645   0 0001CF  CBC7 0008                            LAB,B4   VDH_PST,AUTO
          0 0001D1  CFC7 0010                            STB,B4   VDH_PST+8,AUTO
          0 0001D3  BBC7 0010                            LAB,B3   VDH_PST+8,AUTO
          0 0001D5  CBF0 0100                            LAB,B4   256,IMO
          0 0001D7  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 0001DA       0001                            DC       s:1646,PREL

      272     1646    3         END; ELSE DO;

   1646   0 0001DB  0F81 0026                            B        s:1668,PREL

      273     1647
      274     1648        /* PRINT TEXT AS A PAGE HEADING.                                              */
      275     1649
      276     1650        /* DO CARRIAGE RETURN                                                         */
      277     1651        /* GO TO TOP OF FORM* PRINT TEXT.                                             */
      278     1652        /* DO CARRIAGE RETURN                                                         */
      279     1653        /* DO N LINE FEEDS.                                                           */
      280     1654
      281     1655
      282     1656        /* IF THERE IS NO FORM ON THIS TERMINAL, GIVE HIM ONE UPSPACE                 */
      283     1657        /* OTHERWISE, DO A TITLE-LESS PAGBRK                                          */
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:39   
      284     1658
      285     1659    4            IF (%KV_MVD.LNG < 12) THEN DO;

   1659   0 0001DD  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 0001E0  CCC5 0006                            LDB,B4   6,B5
          0 0001E2  D2C4 0014                            LLH,R5   20,B4
          0 0001E4  5D0C                                 CMV,R5   12
          0 0001E5  0281 000C                            BGE      s:1662,PREL

      286     1660    4               CALL KVO$PST(KV_VDH_PST_NEWLIN_VRT);

   1660   0 0001E7  BB80 0000 0000  01                   LAB,B3   0
          0 0001EA  CBF0 0100                            LAB,B4   256,IMO
          0 0001EC  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 0001EF       0001                            DC       s:1661,PREL

      287     1661    4            END; ELSE DO;

   1661   0 0001F0  0F81 000A                            B        s:1665,PREL

      288     1662    4               %KV_MVD.VRTCLM = 1;         /* DO A CR TOO                        */

   1662   0 0001F2  4C01                                 LDV,R4   1
          0 0001F3  CF44 001B                            STR,R4   27,B4

      289     1663    4               CALL KVO$PAGBRKNO_TTL;

   1663   0 0001F5  CBF0 0000                            LAB,B4   0,IMO
          0 0001F7  E380 0000 0000  xent                 LNJ,B6   KVO$PAGBRKNO_TTL
          0 0001FA       0001                            DC       s:1665,PREL

      290     1664    4            END /* IF */;

      291     1665    3            %KV_VDI.DVCPGNENB = '1'B;

   1665   0 0001FB  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 0001FE  DC86                                 LDB,B5   ,B6
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:40   
          0 0001FF  8945 0019                            LBT,'0004'X       25,B5
          0 000201       0004

      292     1666    3         END /* IF */;

      293     1667    2      END /* CASE */;

      294     1668    1      RETURN;

   1668   0 000202  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      295     1669        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:41   
      296     1670    1   KVO$VFCBFRPRM: ENTRY (VFC);

   1670   0 000205  D380 0000 0000  xent KVO$VFCBFRPRM   LNJ,B5   X6A_AUTO_1
          0 000208       0012 0001                       DC       18,1

      297     1671    1      WRTVFC = '0'B;

   1671   0 00020A  8747 0007                            CL       WRTVFC,AUTO

      298     1672    1      GOTO VFCBFRX;

   1672   0 00020C  0F81 FEE8                            B        s:1531,PREL

      299     1673        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:42   
      300     1674    1   SKPCHN: PROC ALTRET;

   1674   0 00020E  EFC7 000C            SKPCHN          STB,B6   VDH_PST+4,AUTO

      301     1675        /* SKIP TO SPECIFIED CHANNEL                                                  */
      302     1676
      303     1677
      304     1678        /* IF WE WANT TO GO TO CHANNEL 0, DO IT DIRECTLY                              */
      305     1679
      306     1680    3      IF (%VFCPRM = 0) THEN DO;

   1680   0 000210  E847 000A                            LDR,R6   VDH_PST+2,AUTO
          0 000212  6981 0022                            BNEZ,R6  s:1695,PREL

      307     1681
      308     1682        /* IF THERE IS NO FORM, UPSPACE 1                                             */
      309     1683
      310     1684    3         IF %KV_MVD.LNG < 12

   1684   0 000214  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 000217  CCC5 0006                            LDB,B4   6,B5
          0 000219  D2C4 0014                            LLH,R5   20,B4
          0 00021B  5D0C                                 CMV,R5   12
          0 00021C  0281 000C                            BGE      s:1688,PREL

      311     1685    3         THEN CALL KVO$PST(KV_VDH_PST_NEWLIN_VRT);

   1685   0 00021E  BB80 0000 0000  01                   LAB,B3   0
          0 000221  CBF0 0100                            LAB,B4   256,IMO
          0 000223  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 000226       0001                            DC       s:1685+9,PREL
          0 000227  0F81 0009                            B        s:1692,PREL

      312     1686
      313     1687    4         ELSE DO;

      314     1688    4            %VFCPRM = 1000;                /* SKIP TO PAGE-BOTTOM                */
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:43   

   1688   0 000229  E870 03E8                            LDR,R6   1000,IMO
          0 00022B  EF47 000A                            STR,R6   VDH_PST+2,AUTO

      315     1689    4            ALTRETURN;           /* BUT ONLY THE CALLER KNOWS WHAT TO DO NEXT    */

   1689   0 00022D  ECC7 000C                            LDB,B6   VDH_PST+4,AUTO
          0 00022F  B806                                 LDR,R3   ,B6
          0 000230  C3B6                                 LNJ,B4   ,B6,R3

      316     1690    4         END /* IF */;
      317     1691
      318     1692    3         RETURN;

   1692   0 000231  ECC7 000C                            LDB,B6   VDH_PST+4,AUTO
          0 000233  C3C6 0001                            LNJ,B4   1,B6

      319     1693    3      END;
      320     1694
      321     1695    2      CALL VFU_SRCH;

   1695   0 000235  E3C0 004C                            LNJ,B6   s:0,PREL
          0 000237       0001                            DC       s:1699,PREL

      322     1696
      323     1697        /* UPSPACE COUNT LINES                                                     */
      324     1698
      325     1699    2      CALL KVO$UP_SPC_NO_PAGBRK_PST(VDH_PST);

   1699   0 000238  EBC7 0008                            LAB,B6   VDH_PST,AUTO
          0 00023A  EFC7 0010                            STB,B6   VDH_PST+8,AUTO
          0 00023C  BBC7 0010                            LAB,B3   VDH_PST+8,AUTO
          0 00023E  CBF0 0100                            LAB,B4   256,IMO
          0 000240  E380 0000 0000  xent                 LNJ,B6   KVO$UP_SPC_NO_PAGBRK_PST
          0 000243       0001                            DC       s:1704,PREL

      326     1700
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:44   
      327     1701        /* IF THIS UPSPACE CAUSED A PAGE BREAK, WE WANT TO REPEAT THE UPSPACE ON   */
      328     1702        /* THE NEXT PAGE AFTER GIVING THE USER THE PAGE BREAK                      */
      329     1703
      330     1704    3      IF %KV_MVD.PAGBRKPND AND VFCFNC = %KV#VFCFNCSKPCHNBFRPRT THEN DO;

   1704   0 000244  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 000247  DCC6 0006                            LDB,B5   6,B6
          0 000249  82C5 0016                            LB,'0001'X        22,B5
          0 00024B       0001
          0 00024C  0581 0031                            BBF      s:1718,PREL
          0 00024E  E847 0006                            LDR,R6   VFCFNC,AUTO
          0 000250  6D03                                 CMV,R6   3
          0 000251  0981 002C                            BNE      s:1718,PREL

      331     1705    3         CALL KVO$PAGBRK;

   1705   0 000253  CBF0 0000                            LAB,B4   0,IMO
          0 000255  E380 0000 0000  xent                 LNJ,B6   KVO$PAGBRK
          0 000258       0001                            DC       s:1710,PREL

      332     1706
      333     1707        /* IF THE NUMBER OF LINES TO UPSPACE WILL NOT TAKE US OVER ANOTHER PAGE    */
      334     1708        /* WE REPEAT THE UPSPACE, OTHERWISE WE FORGET IT                           */
      335     1709
      336     1710    3         %VFCPRM = VFC.PRM;

   1710   0 000259  ECC7 0004                            LDB,B6   @VFC,AUTO
          0 00025B  E806                                 LDR,R6   ,B6
          0 00025C  6048                                 SOR,R6   8
          0 00025D  E570 000F                            AND,R6   15,IMO
          0 00025F  EF47 000A                            STR,R6   VDH_PST+2,AUTO

      337     1711    3         CALL VFU_SRCH;

   1711   0 000261  E3C0 0020                            LNJ,B6   s:0,PREL
          0 000263       0001                            DC       s:1713,PREL

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:45   
      338     1712
      339     1713    4         IF %KV_MVD.LNG-%KV_MVD.FRMLIN-%VFCPRM > 0 THEN DO;

   1713   0 000264  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 000267  DCC6 0006                            LDB,B5   6,B6
          0 000269  E2C5 0014                            LLH,R6   20,B5
          0 00026B  D2C5 001D                            LLH,R5   29,B5
          0 00026D  E255                                 SUB,R6   R5
          0 00026E  E247 000A                            SUB,R6   VDH_PST+2,AUTO
          0 000270  6A81 000D                            BLEZ,R6  s:1718,PREL

      340     1714    4            CALL KVO$PST(VDH_PST);

   1714   0 000272  CBC7 0008                            LAB,B4   VDH_PST,AUTO
          0 000274  CFC7 0010                            STB,B4   VDH_PST+8,AUTO
          0 000276  BBC7 0010                            LAB,B3   VDH_PST+8,AUTO
          0 000278  CBF0 0100                            LAB,B4   256,IMO
          0 00027A  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          0 00027D       0001                            DC       s:1718,PREL

      341     1715    4         END /* IF */;

      342     1716    3      END /* IF */;

      343     1717
      344     1718    2      RETURN;

   1718   0 00027E  ECC7 000C                            LDB,B6   VDH_PST+4,AUTO
          0 000280  C3C6 0001                            LNJ,B4   1,B6

      345     1719
      346     1720    2   END /* PROC */;
      347     1721        %EJECT;
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:46   
      348     1722    1   VFU_SRCH: PROC;

   1722   0 000282  EFC7 000E            VFU_SRCH        STB,B6   VDH_PST+6,AUTO

      349     1723
      350     1724
      351     1725        /* SEARCH THE VFU IMAGE (IF ONE EXISTS) TO SEE IF A VALID PUNCH EXISTS        */
      352     1726        /* BETWEEN WHERE WE ARE AND THE END OF THE LOGICAL FORM. ON ENTRY %VFCPRM        */
      353     1727        /* CONTAINS THE CHANNEL TO LOOK FOR. ON EXIT, %VFCPRM CONTAINS THE NUMBER OF     */
      354     1728        /* LINES TO UPSPACE. THIS WILL BE 0 IF NO VALID PUNCHES EXIST AND             */
      355     1729        /* NUMBER OF LINES LEFT ON THE PAGE + 1 IF PUNCHES EXIST, BUT NOT IN A        */
      356     1730        /* VALID RANGE                                                                */
      357     1731
      358     1732
      359     1733        /* IF NO VFU IMAGE EXISTS, NO PUNCHES CAN EXIST                               */
      360     1734
      361     1735    2      IF (%KV_MVD.VFU$ = ADDR(NIL)) THEN RETURN;

   1735   0 000284  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 000287  CCC5 0006                            LDB,B4   6,B5
          0 000289  8DC4 000C                            CMN      12,B4
          0 00028B  0981 0005                            BNE      s:1740,PREL

   1735   0 00028D  ECC7 000E                            LDB,B6   VDH_PST+6,AUTO
          0 00028F  C3C6 0001                            LNJ,B4   1,B6

      362     1736
      363     1737        /* IF NO PUNCH EXISTS IN THE PRIMARY CHANNEL, NO PUNCHES MAY EXIST            */
      364     1738        /* AT ALL                                                                     */
      365     1739
      366     1740    2      IF (%KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM) = 0) THEN RETURN;

   1740   0 000291  BCC4 000C                            LDB,B3   12,B4
          0 000293  B847 000A                            LDR,R3   VDH_PST+2,AUTO
          0 000295  3E08                                 ADV,R3   8
          0 000296  E2B3                                 LLH,R6   ,B3,R3
          0 000297  6981 0005                            BNEZ,R6  s:1745,PREL
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:47   

   1740   0 000299  ECC7 000E                            LDB,B6   VDH_PST+6,AUTO
          0 00029B  C3C6 0001                            LNJ,B4   1,B6

      367     1741
      368     1742        /* WE KNOW THAT AT LEAST ONE PUNCH EXISTS. THIS LOOP SCANS THE VFU            */
      369     1743        /* IMAGE LOOKING FOR A GOOD PUNCH                                             */
      370     1744
      371     1745    3      DO WHILE (%VFCPRM ~= 0);

   1745   0 00029D  D847 000A                            LDR,R5   VDH_PST+2,AUTO
          0 00029F  5901 0024                            BEZ,R5   s:1768,PREL

      372     1746
      373     1747        /* IF THE CURRENT PUNCH IS FOR A LINE > CURRENT LINE AND LESS THAN            */
      374     1748        /* LOGICAL FORM LENGTH, WE GOT A WINNER                                       */
      375     1749
      376     1750    4         IF %KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM) > %KV_MVD.FRMLIN THEN DO;

   1750   0 0002A1  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 0002A4  DCC6 0006                            LDB,B5   6,B6
          0 0002A6  CCC5 000C                            LDB,B4   12,B5
          0 0002A8  B847 000A                            LDR,R3   VDH_PST+2,AUTO
          0 0002AA  3E08                                 ADV,R3   8
          0 0002AB  E2B4                                 LLH,R6   ,B4,R3
          0 0002AC  D2C5 001D                            LLH,R5   29,B5
          0 0002AE  E955                                 CMR,R6   R5
          0 0002AF  0A81 000D                            BALE     s:1762,PREL

      377     1751    5            IF (%KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM) < %KV_MVD.LNG) THEN DO;

   1751   0 0002B1  C2C5 0014                            LLH,R4   20,B5
          0 0002B3  E954                                 CMR,R6   R4
          0 0002B4  0881 0008                            BAGE     s:1762,PREL

      378     1752
      379     1753        /* MOVE THE NUMBER OF LF'S NECESSARY TO GET TO THIS LINE INTO %VFCPRM            */
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:48   
      380     1754
      381     1755    5               %VFCPRM = %KV_MVD.VFU$->KV$VFU.LIN(%VFCPRM)-%KV_MVD.FRMLIN;

   1755   0 0002B6  E255                                 SUB,R6   R5
          0 0002B7  EF47 000A                            STR,R6   VDH_PST+2,AUTO

      382     1756    5               RETURN;

   1756   0 0002B9  ECC7 000E                            LDB,B6   VDH_PST+6,AUTO
          0 0002BB  C3C6 0001                            LNJ,B4   1,B6

      383     1757    5            END /* IF */;
      384     1758    4         END /* IF */;
      385     1759
      386     1760        /* IF ANOTHER PUNCH EXISTS FOR THIS CHANNEL, TRY IT                           */
      387     1761
      388     1762    3         %VFCPRM = %KV_MVD.VFU$->KV$VFU.NXT(%VFCPRM);

   1762   0 0002BD  A847 000A                            LDR,R2   VDH_PST+2,AUTO
          0 0002BF  2E28                                 ADV,R2   40
          0 0002C0  C2A4                                 LLH,R4   ,B4,R2
          0 0002C1  CF47 000A                            STR,R4   VDH_PST+2,AUTO

      389     1763
      390     1764        /* NO MORE PUNCHES EXIST, SO PLACE A VALUE INTO %VFCPRM WHICH WILL PUT US        */
      391     1765        /* INTO LIMBO                                                                 */
      392     1766
      393     1767    3      END /* LOOP */;

   1767   0 0002C3  49DE                                 BNEZ,R4  s:1750,SPREL

      394     1768    2      %VFCPRM = %KV_MVD.LNG - %KV_MVD.FRMLIN + 1;

   1768   0 0002C4  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 0002C7  DCC6 0006                            LDB,B5   6,B6
          0 0002C9  E2C5 0014                            LLH,R6   20,B5
          0 0002CB  D2C5 001D                            LLH,R5   29,B5
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:49   
          0 0002CD  E255                                 SUB,R6   R5
          0 0002CE  6E01                                 ADV,R6   1
          0 0002CF  EF47 000A                            STR,R6   VDH_PST+2,AUTO

      395     1769    2      RETURN;

   1769   0 0002D1  ECC7 000E                            LDB,B6   VDH_PST+6,AUTO
          0 0002D3  C3C6 0001                            LNJ,B4   1,B6
      396     1770    2   END /* SUBROUTINE */;
      397     1771    1   END;
      398     1772        %EOD;

PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:50   
--  Include file information  --

   KV_ASCCHR_E.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$VFC.
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:51   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @VFC                       8-0-0/w STRC(64)    r     1 VDH_PST
    *0-0-0/w STRC(8)     r     1 VFC                        6-0-0/w UBIN(16)    r     1 VFCFNC
     7-0-0/w BIT         r     1 WRTVFC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV$PTR$                    0-0-0/w STRC(64)    r     1 KV_VDH_PST_CR_VRT
     0-0-0/w STRC(64)    r     1 KV_VDH_PST_NEWLIN_VRT
     0-0-0/w STRC(64)    r     1 KV_VDH_PST_VRT             0-0-0/w STRC(64)    r     1 KV_VDH_PST_WHTSPC_CR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KV$MRD                     0-0-0/w STRC(512)   r     1 KV$MVD
     0-0-0/w STRC(480)   r     1 KV$PTR                     0-0-0/w STRC(496)   r     1 KV$SRD
     0-0-0/w STRC(512)   r     1 KV$VDI                     0-0-0/w STRC(576)   r     1 KV$VFU


   Procedure KVO$VFC requires 725 words for executable code.
   Procedure KVO$VFC requires 18 words of local(AUTO) storage.
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:52   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:53   
          MINI XREF LISTING

DO_N_LFS
      1518**LABEL    1465--GOTO     1498--CALLALT  1507--GOTO
KV$MRD.CTNFRM
       215**DCL      1478>>IF
KV$MRD.CURSORUP
       213**DCL      1478>>IF
KV$MVD.FRMLIN
       267**DCL      1628>>IF       1713>>IF       1750>>IF       1755>>ASSIGN   1768>>ASSIGN
KV$MVD.LNG
       253**DCL      1463>>IF       1628>>IF       1659>>IF       1684>>IF       1713>>IF       1751>>IF
      1768>>ASSIGN
KV$MVD.PAGBRKPND
       259**DCL      1462>>IF       1475<<ASSIGN   1545>>IF       1622>>IF       1704>>IF
KV$MVD.VFU$
       251**DCL      1735>>IF       1740>>IF       1750>>IF       1751>>IF       1755>>ASSIGN   1762>>ASSIGN
KV$MVD.VRTCLM
       266**DCL      1473<<ASSIGN   1484<<ASSIGN   1662<<ASSIGN
KV$PTR.INPCNDPND
       298**DCL       307--REDEF     311--REDEF
KV$PTR.LINLST$
       294**DCL       295--REDEF
KV$PTR.MRD$
       293**DCL      1478>>IF       1478>>IF
KV$PTR.MVD$
       293**DCL      1462>>IF       1463>>IF       1473>>ASSIGN   1475>>ASSIGN   1484>>ASSIGN   1545>>IF
      1622>>IF       1628>>IF       1628>>IF       1659>>IF       1662>>ASSIGN   1684>>IF       1704>>IF
      1713>>IF       1713>>IF       1735>>IF       1740>>IF       1750>>IF       1750>>IF       1751>>IF
      1751>>IF       1755>>ASSIGN   1755>>ASSIGN   1762>>ASSIGN   1768>>ASSIGN   1768>>ASSIGN
KV$PTR.SRD$
       294**DCL      1467>>IF       1468>>IF       1468>>IF       1468>>IF       1470>>ASSIGN   1470>>ASSIGN
      1471>>ASSIGN   1472>>ASSIGN   1482>>ASSIGN   1485>>ASSIGN   1485>>ASSIGN   1486>>ASSIGN   1486>>ASSIGN
      1536>>IF       1642>>IF       1642>>IF       1643>>ASSIGN   1643>>ASSIGN
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:54   
KV$PTR.VDI$
       292**DCL      1483>>ASSIGN   1552>>ASSIGN   1665>>ASSIGN
KV$PTR$
       286**DCL       292--IMP-PTR  1462>>IF       1463>>IF       1467>>IF       1468>>IF       1468>>IF
      1468>>IF       1470>>ASSIGN   1470>>ASSIGN   1471>>ASSIGN   1472>>ASSIGN   1473>>ASSIGN   1475>>ASSIGN
      1478>>IF       1478>>IF       1482>>ASSIGN   1483>>ASSIGN   1484>>ASSIGN   1485>>ASSIGN   1485>>ASSIGN
      1486>>ASSIGN   1486>>ASSIGN   1536>>IF       1545>>IF       1552>>ASSIGN   1622>>IF       1628>>IF
      1628>>IF       1642>>IF       1642>>IF       1643>>ASSIGN   1643>>ASSIGN   1659>>IF       1662>>ASSIGN
      1665>>ASSIGN   1684>>IF       1704>>IF       1713>>IF       1713>>IF       1735>>IF       1740>>IF
      1750>>IF       1750>>IF       1751>>IF       1751>>IF       1755>>ASSIGN   1755>>ASSIGN   1762>>ASSIGN
      1768>>ASSIGN   1768>>ASSIGN
KV$SRD.BTMRHT
       431**DCL       436--REDEF
KV$SRD.BTMRHT.LIN
       433**DCL      1468>>IF       1470>>ASSIGN
KV$SRD.CRT
       507**DCL       512--REDEF
KV$SRD.CRT.LIN
       509**DCL      1468>>IF       1642>>IF       1643>>ASSIGN
KV$SRD.CRTVRTLINPHSLIN
       479**DCL      1470<<ASSIGN   1486<<ASSIGN
KV$SRD.CRT_PST
       512**DCL      1485<<ASSIGN
KV$SRD.DVCLINBIS
       549**DCL      1468>>IF       1471<<ASSIGN   1482<<ASSIGN
KV$SRD.FLDEND
       471**DCL       476--REDEF
KV$SRD.HI_NONBLN
       541**DCL       546--REDEF
KV$SRD.HI_NONBLN.LIN
       543**DCL      1642>>IF       1643>>ASSIGN
KV$SRD.ORG
       363**DCL       368--REDEF
KV$SRD.SCROLL
       440**DCL      1467>>IF
KV$SRD.SRDEND
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:55   
       576**DCL       581--REDEF
KV$SRD.TOPLFT
       397**DCL       402--REDEF
KV$SRD.TOPLFT.LIN
       399**DCL      1486>>ASSIGN
KV$SRD.TOPLFT_PST
       402**DCL      1485>>ASSIGN
KV$SRD.VRTPSTOK
       440**DCL      1472<<ASSIGN   1536>>IF
KV$VDH_PST.PSTVAL
       814**DCL       819--REDEF
KV$VDI.DVCPGNENB
       880**DCL      1552<<ASSIGN   1665<<ASSIGN
KV$VDI.OTPCNDPND.PST
       881**DCL      1483<<ASSIGN
KV$VFU.LIN
       939**DCL      1740>>IF       1750>>IF       1751>>IF       1755>>ASSIGN
KV$VFU.NXT
       939**DCL      1762>>ASSIGN
KVO$ERSSRD
      1423**DCL-ENT  1487--CALL
KVO$PAGBRK
      1425**DCL-ENT  1551--CALL     1623--CALL     1705--CALL
KVO$PAGBRKNO_TTL
      1426**DCL-ENT  1663--CALL
KVO$PST
      1424**DCL-ENT  1454--CALL     1467--CALL     1540--CALL     1575--CALL     1596--CALL     1607--CALL
      1629--CALL     1645--CALL     1660--CALL     1685--CALL     1714--CALL
KVO$UP_SPC_NO_PAGBRK_PST
      1428**DCL-ENT  1520--CALL     1617--CALL     1699--CALL
KV_VDH_PST_CR_VRT
      1153**DCL      1596<>CALL     1607<>CALL
KV_VDH_PST_CR_VRT.PSTVAL
      1191**DCL      1196--REDEF
KV_VDH_PST_LF_VRT.PSTVAL
      1265**DCL      1270--REDEF
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:56   
KV_VDH_PST_NEWLIN_VRT
      1079**DCL      1436>>ASSIGN   1454<>CALL     1556>>ASSIGN   1660<>CALL     1685<>CALL
KV_VDH_PST_NEWLIN_VRT.PSTVAL
      1117**DCL      1122--REDEF
KV_VDH_PST_VRT
      1301**DCL      1540<>CALL
KV_VDH_PST_VRT.PSTVAL
      1339**DCL      1344--REDEF
KV_VDH_PST_WHTSPC_CR
      1375**DCL      1467<>CALL     1575<>CALL
KV_VDH_PST_WHTSPC_CR.PSTVAL
      1413**DCL      1418--REDEF
SKPCHN
      1674**PROC     1498--CALL     1585--CALL
UP_N_LFS
      1606**LABEL    1585--CALLALT
VDH_PST
      1005**DCL      1436<<ASSIGN   1520<>CALL     1556<<ASSIGN   1617<>CALL     1629<>CALL     1645<>CALL
      1699<>CALL     1714<>CALL
VDH_PST.PSTVAL
      1043**DCL      1048--REDEF
VDH_PST.PSTVAL.LIN
      1045**DCL      1438<<ASSIGN   1445>>IF       1455>>IF       1464<<ASSIGN   1477>>IF       1507>>IF
      1518>>IF       1557<<ASSIGN   1565>>IF       1606>>IF       1628>>IF       1643<<ASSIGN   1643>>ASSIGN
      1680>>IF       1688<<ASSIGN   1710<<ASSIGN   1713>>IF       1740>>IF       1745>>DOWHILE  1750>>IF
      1751>>IF       1755<<ASSIGN   1755>>ASSIGN   1762<<ASSIGN   1762>>ASSIGN   1768<<ASSIGN
VFC
       961**DCL         8--PROC     1430--ENTRY    1525--ENTRY    1529--ENTRY    1550>>IF       1550>>IF
      1670--ENTRY
VFC.FNC
       965**DCL      1437>>ASSIGN   1534>>ASSIGN
VFC.PRM
       965**DCL      1438>>ASSIGN   1557>>ASSIGN   1710>>ASSIGN
VFCAFTX
      1433**LABEL    1527--GOTO
VFCBFRX
PL6.E3A0      #001=KVO$VFC File=KVO$VFC.:E05TSI                                  WED 07/30/97 02:11 Page:57   
      1531**LABEL    1672--GOTO
VFCFNC
       970**DCL      1437<<ASSIGN   1440>>DOCASE   1534<<ASSIGN   1559>>DOCASE   1704>>IF
VFU_SRCH
      1722**PROC     1695--CALL     1711--CALL
WRTVFC
       976**DCL      1433<<ASSIGN   1518>>IF       1526<<ASSIGN   1531<<ASSIGN   1550>>IF       1633>>IF
      1671<<ASSIGN

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:58   
      399        1        /*T***********************************************************/
      400        2        /*T*                                                         */
      401        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      402        4        /*T*                                                         */
      403        5        /*T***********************************************************/
      404        6        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
      405        7        KVO$PAGBRK: PROC;
      406        8
      407        9        /* PAGE BREAK - DO PAGINATION, ETC.                                           */
      408       10
      409       11 S      %INCLUDE KV$GLB;                        /* VDH Global structures              */
      410       12 S      %INCLUDE KV$GLBCTX;                     /* VDH Global context                 */
      411       13 S      %INCLUDE KV$INT;                        /* VDH internal structures            */
      412       14 S      %INCLUDE KV$USR;                        /* VDH to VDH-user request structures */
      413       15 S      %INCLUDE KV$VDH;                        /* VDH-user to VDH request structures */
      414       16        %INCLUDE KV_ASCCHR_E;                   /* Equates for ASCII characters       */
      415      153 S      %INCLUDE KV_GLBCNS_E;                   /* Virtual device handler constants   */
      416      154
      417      155        %KV_VFC_E;                              /* VFC DEFINITIONS                    */
      418      174        %KV$MRD;                                /*  REAL DEVICE CONTEXT BLOCK         */
      419      221        %KV$MVD;                                /*  VIRTUAL DEVICE CONTEXT BLOCK      */
      420      265        %KV$PTR;                                /*  VDH POINTER BLOCK                 */
      421      308        %KV$SRD;                                /*  SUBORDINATE REAL DEVICE CONTEXT   */
      422      583        %KV$SSN;                                /*  SESSION CONTEXT                   */
      423      662        %KV$STR;                                /*  STREAM CONTEXT                    */
      424      749        %KV$VDH_OTPLCL;                         /*  ARGUMENT STRUCTURE                */
      425      822        %KV$VDH_PST;                            /*  ARGUMENT TO VDH POSITION ROUTINE  */
      426      896        %KV$VDI;                                /*  VDI CONTEXT                       */
      427      967        %KV$VFU;                                /*  VFU IMAGE TEMPLATE                */
      428     1014        %KV_PSTORG_E;                           /*  PST ORG EQU                       */
      429     1019        %KV#VD_ORG_E;                           /* VD ORGs                            */
      430     1027        %KV$TITLE(STCLASS = "BASED(TTL$)");
      431     1075
      432     1076    1   DCL KVO$PST ENTRY(1);
      433     1077    1   DCL KVO$OTPLCL ENTRY(1);
      434     1078    1   DCL KVO$SCREND ENTRY;
      435     1079
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:59   
      436     1080
      437     1081        /* ORIGINAL VIRTUAL COLUMN                                                    */
      438     1082
      439     1083    1   DCL ORGVRTCLM UBIN ALIGNED;
      440     1084
      441     1085    1   DCL TTL$ PTR ALIGNED;
      442     1086
      443     1087    1   DCL TTLENB BIT(1) ALIGNED;
      444     1088
      445     1089        /* BUFFER TO HOLD UNDERSCORES FOR PERF SIMULATION                             */
      446     1090
      447     1091    1   DCL BFR(0:149) CHAR(1) UNAL INIT('_'*0) CONSTANT;
      448     1092
      449     1093    1   DCL PGBUF CHAR(6);
      450     1094    1   DCL PGBUFN(0:5) REDEF PGBUF UBIN BYTE UNAL;
      451     1095    1   DCL LIN SBIN ALIGNED;
      452     1096
      453     1097         %KV$VDH_OTPLCL(NAME = VDH_OTPLCL, STCLASS = AUTO);
      454     1170         %KV$VDH_OTPLCL(NAME = KV_VDH_OTPLCL, STCLASS = SYMREF);
      455     1243         %KV$VDH_PST(NAME = VDH_PST, STCLASS = AUTO);
      456     1317         %KV$VDH_PST(NAME = KV_VDH_PST_CR, STCLASS = SYMREF);
      457     1391    1   DCL KV_VDH_PST_WHTSPC_CR SBIN SYMREF;
      458     1392
      459     1393    1      TTLENB = '1'B;
      460     1394    1      GOTO SUBCOMMON;
      461     1395
      462     1396    1   KVO$PAGBRKNO_TTL: ENTRY;
      463     1397
      464     1398    1      TTLENB = '0'B;
      465     1399
      466     1400    1   SUBCOMMON:
      467     1401
      468     1402        /* RESET PAGE BREAK PENDING                                                   */
      469     1403
      470     1404    1      %KV_MVD.PAGBRKPND = '0'B;
      471     1405
      472     1406        /* MAKE SURE WE CAN DO A LOGICAL PAGE BREAK                                   */
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:60   
      473     1407
      474     1408    2      IF NOT %KV_MVD.FRMSCNINH THEN DO;
      475     1409
      476     1410        /* IF THE PAGE LENGTH IS LESS THAN 12, FORGET PAGINATION                      */
      477     1411
      478     1412    3         IF (%KV_MVD.LNG < 12) THEN DO;
      479     1413    3            CALL KVO$PST (KV_VDH_PST_WHTSPC_CR);
      480     1414    3            RETURN;
      481     1415    3         END /* IF */;
      482     1416
      483     1417        /* DISABLE LOGICAL PAGINATION                                                 */
      484     1418
      485     1419    2         %KV_MVD.FRMSCNINH = '1'B;
      486     1420
      487     1421        /* STASH AWAY A FEW FLAGS AND BUMP THE PAGE COUNT                             */
      488     1422
      489     1423    2         ORGVRTCLM = %KV_MVD.VRTCLM;
      490     1424    2         %KV_MVD.PAGNMB = %KV_MVD.PAGNMB+1;
      491     1425
      492     1426        /* SETUP A POSITIONING FPT                                                    */
      493     1427
      494     1428    2         VDH_PST = KV_VDH_PST_CR;
      495     1429
      496     1430        /* IF THE USER WANTS TO SIMULATE THE PERF (HE HAS CONTINUOUS FORMS ON HIS     */
      497     1431        /* TERMINAL) PRINT UNDERSCORES ACROSS THE PAGE AT THE BOTTOM                  */
      498     1432
      499     1433    3         IF %KV_VDI.DVCPGNENB THEN DO;
      500     1434    4            IF %KV_MVD.SIMPERF AND NOT %KV_SRD.SCROLL THEN DO;
      501     1435
      502     1436        /* POSITION TO THE BOTTOM LINE                                                */
      503     1437
      504     1438    4               LIN = %KV_SRD.BTMRHT.LIN-%KV_SRD.CRT.LIN;
      505     1439    5               IF %KV_SRD.PAGEHALT AND %KV_SRD.PRINTHALT THEN DO;
      506     1440    5                  LIN = LIN-1;
      507     1441    5               END /* IF */;
      508     1442    5               IF LIN > 0 THEN DO;
      509     1443    5                  VDH_PST.PSTVAL.LIN = LIN;
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:61   
      510     1444    5               END /* IF */;
      511     1445    4               CALL KVO$PST(VDH_PST);
      512     1446
      513     1447    4               VDH_OTPLCL = KV_VDH_OTPLCL;
      514     1448    4               VDH_OTPLCL.NONVRT = '1'B;
      515     1449    4               VDH_OTPLCL.BFR_.ADR$ = ADDR(BFR);
      516     1450    4               VDH_OTPLCL.BFR_.BYTSIZ = %KV_SRD.WDT;
      517     1451    4               CALL KVO$OTPLCL(VDH_OTPLCL);
      518     1452
      519     1453    4            END /* IF */;
      520     1454
      521     1455        /* NOW GET TO TOF                                                             */
      522     1456
      523     1457    3            CALL KVO$SCREND;
      524     1458    3         END /* IF */;
      525     1459
      526     1460        /* ADVANCE TO FIRST PRINTABLE LINE                                            */
      527     1461
      528     1462    2         VDH_PST.PSTVAL.LIN = %KV_MVD.FRSLIN;
      529     1463    2         CALL KVO$PST(VDH_PST);
      530     1464
      531     1465        /* REINIT COUNTERS FOR START OF NEW PAGE                                      */
      532     1466
      533     1467    2         %KV_MVD.FRMLIN = 0;
      534     1468    2         %KV_MVD.VRTLIN = 0;
      535     1469    2         %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRT.LIN;
      536     1470    2         %KV_SRD.VRTPSTOK = '1'B;
      537     1471    2         VDH_PST.PSTVAL.LIN = 0;
      538     1472    2         VDH_PST.VRT = '1'B;
      539     1473
      540     1474        /* CHECK TO MAKE SURE WE ARE TO PUT OUT A HEADER                              */
      541     1475
      542     1476    3         IF TTLENB THEN DO;
      543     1477
      544     1478        /* DECIDE WHETHER TO USE SESSION HEADER OR DCB HEADER                         */
      545     1479
      546     1480    3            IF %KV_SSN.HDNTYPIS_DCB
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:62   
      547     1481    3            THEN TTL$ = %KV_MVD.DCBHDN$;
      548     1482    3            ELSE TTL$ = %KV_SSN.SSNHDN$;
      549     1483
      550     1484        /* IF THE HEADER IS NON-ADDR(NIL), WE PRINT IT
              1484        */
      551     1485
      552     1486    4            IF (TTL$ ~= ADDR(NIL)) THEN DO;
      553     1487
      554     1488    4               VDH_OTPLCL = KV_VDH_OTPLCL;
      555     1489
      556     1490        /* ADVANCE TO EITHER COUNT COLUMN OR INDENT COLUMN, WHICHEVER IS              */
      557     1491        /* CLOSEST TO LEFT MARGIN                                                     */
      558     1492
      559     1493    4               IF KV$TITLE.INDCLM < KV$TITLE.CNTCLM
      560     1494    5                 OR KV$TITLE.CNTCLM = 0 THEN DO;
      561     1495
      562     1496        /* The title starts first, put out some of it */
      563     1497
      564     1498    5                  VDH_PST.PSTVAL.CLM = KV$TITLE.INDCLM;
      565     1499    5                  CALL KVO$PST(VDH_PST);
      566     1500    5                  VDH_OTPLCL.BFR_.ADR$ = TTL$;
      567     1501    5                  VDH_OTPLCL.BFR_.BYTX = SIZEC(KV$TITLE)-1;
      568     1502    5                  VDH_OTPLCL.BFR_.BYTSIZ = KV$TITLE.TXTSIZ;
      569     1503    6                  IF KV$TITLE.CNTCLM ~= 0 THEN DO;
      570     1504    6                     VDH_OTPLCL.BFR_.BYTSIZ = MINIMUM (VDH_OTPLCL.BFR_.BYTSIZ,
      571     1505    6                       KV$TITLE.CNTCLM - KV$TITLE.INDCLM);
      572     1506    6                  END;
      573     1507    5                  CALL KVO$OTPLCL(VDH_OTPLCL);
      574     1508    5               END;
      575     1509        /* Now send the page number, if it wants to go */
      576     1510    5               IF KV$TITLE.CNTCLM ~= 0 THEN DO;
      577     1511    5                  VDH_PST.PSTVAL.CLM = KV$TITLE.CNTCLM;
      578     1512    5                  CALL KVO$PST(VDH_PST);
      579     1513    5                  CALL BINCHAR(PGBUF, %KV_MVD.PAGNMB);
      580     1514    5                  VDH_OTPLCL.BFR_.ADR$ = ADDR(PGBUF);
      581     1515    6                  DO VDH_OTPLCL.BFR_.BYTX = 0 TO SIZEC(PGBUF)-2;
      582     1516    6                     IF PGBUFN(VDH_OTPLCL.BFR_.BYTX) ~= ASCBIN('0') THEN EXIT;
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:63   
      583     1517    6                  END;
      584     1518    5                  VDH_OTPLCL.BFR_.BYTSIZ = SIZEC(PGBUF)-VDH_OTPLCL.BFR_.BYTX;
      585     1519    5                  CALL KVO$OTPLCL(VDH_OTPLCL);
      586     1520    5               END;
      587     1521    5               IF KV$TITLE.INDCLM+KV$TITLE.TXTSIZ > %KV_MVD.VRTCLM THEN DO;
      588     1522
      589     1523        /* There's still some title left to send */
      590     1524
      591     1525    6                  IF KV$TITLE.INDCLM > %KV_MVD.VRTCLM THEN DO;
      592     1526        /* We need to position to the start of the title */
      593     1527
      594     1528    6                     VDH_PST.PSTVAL.CLM = KV$TITLE.INDCLM;
      595     1529    6                     CALL KVO$PST(VDH_PST);
      596     1530    6                  END;
      597     1531    5                  VDH_OTPLCL.BFR_.BYTSIZ =
      598     1532    5                    KV$TITLE.TXTSIZ+KV$TITLE.INDCLM-%KV_MVD.VRTCLM;
      599     1533    5                  VDH_OTPLCL.BFR_.ADR$ = TTL$;
      600     1534    5                  VDH_OTPLCL.BFR_.BYTX = SIZEC(KV$TITLE)-1+
      601     1535    5                    KV$TITLE.TXTSIZ-VDH_OTPLCL.BFR_.BYTSIZ;
      602     1536    5                  CALL KVO$OTPLCL(VDH_OTPLCL);
      603     1537    5               END;
      604     1538
      605     1539        /* IF THE USER HAS SPECIFIED A HEIGHT IN THE TITLE, FUDGE UP A CALL TO        */
      606     1540
      607     1541    4               VDH_PST.PSTVAL.LIN = KV$TITLE.HGT;
      608     1542    4            END /* IF */;
      609     1543    3         END /* IF */;
      610     1544
      611     1545        /* RESTORE VIRTUAL AND PHYSICAL COLUMNS                                       */
      612     1546
      613     1547    2         VDH_PST.PSTVAL.CLM = ORGVRTCLM;
      614     1548    2         CALL KVO$PST(VDH_PST);
      615     1549
      616     1550        /* RE-ENABLE LOGICAL PAGINATION                                               */
      617     1551
      618     1552    2         %KV_MVD.FRMSCNINH = '0'B;
      619     1553    2      END /* IF */;
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:64   
      620     1554    1      RETURN;
      621     1555        %EJECT;
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:65   
      622     1556        /* SET THE COUNTERS IF USER SAID AT PERF                                      */
      623     1557
      624     1558    1   KVO$PAGBRK_ATPRF: ENTRY;
      625     1559
      626     1560
      627     1561    1      LIN = %KV_SRD.CRTVRTLINPHSLIN-%KV_SRD.CRT.LIN;
      628     1562    1      %KV_MVD.VRTLIN = %KV_MVD.LNG;
      629     1563    1      %KV_MVD.FRMLIN = %KV_MVD.LNG;
      630     1564    1      %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.BTMRHT.LIN;
      631     1565    1      %KV_SRD.CRT.LIN = %KV_SRD.BTMRHT.LIN;
      632     1566    1      %KV_MRD.DVCLIN = %KV_SRD.BTMRHT.LIN;
      633     1567    1      %KV_MVD.FRMLIN = %KV_MVD.FRMLIN-1;
      634     1568    1      %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRTVRTLINPHSLIN + LIN;
      635     1569    1      RETURN;
      636     1570    1   END;

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:66   
--  Include file information  --

   KV_ASCCHR_E.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$PAGBRK.

   Procedure KVO$PAGBRK requires 580 words for executable code.
   Procedure KVO$PAGBRK requires 24 words of local(AUTO) storage.

    No errors detected in file KVO$VFC.:E05TSI    .

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:67   

 Object Unit name= KVO$PAGBRK                                 File name= KVO$VFC.:E05TOU
 UTS= JUL 30 '97 02:12:17.96 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS     75     4B  KVO$PAGBRK
    1   Proc  even  none   580    244  KVO$PAGBRK
    2  RoData even  none     2      2  KVO$PAGBRK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  KVO$PAGBRK
     1      A                  yes      Std        0  KVO$PAGBRKNO_TTL
     1    204                  yes      Std        0  KVO$PAGBRK_ATPRF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KVO$PST
         yes           Std       1 KVO$OTPLCL
         yes           Std       0 KVO$SCREND
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:68   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KV$PTR$                               KV_VDH_OTPLCL                         KV_VDH_PST_CR
     KV_VDH_PST_WHTSPC_CR             r    G$ROS$
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:69   


      399        1        /*T***********************************************************/
      400        2        /*T*                                                         */
      401        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      402        4        /*T*                                                         */
      403        5        /*T***********************************************************/
      404        6        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
      405        7        KVO$PAGBRK: PROC;

      7   1 000000  D380 0000 0000  xent KVO$PAGBRK      LNJ,B5   X6A_AUTO_0
          1 000003       0018 0000                       DC       24,0

      406        8
      407        9        /* PAGE BREAK - DO PAGINATION, ETC.                                           */
      408       10
      409       11 S      %INCLUDE KV$GLB;                        /* VDH Global structures              */
      410       12 S      %INCLUDE KV$GLBCTX;                     /* VDH Global context                 */
      411       13 S      %INCLUDE KV$INT;                        /* VDH internal structures            */
      412       14 S      %INCLUDE KV$USR;                        /* VDH to VDH-user request structures */
      413       15 S      %INCLUDE KV$VDH;                        /* VDH-user to VDH request structures */
      414       16        %INCLUDE KV_ASCCHR_E;                   /* Equates for ASCII characters       */
      415      153 S      %INCLUDE KV_GLBCNS_E;                   /* Virtual device handler constants   */
      416      154
      417      155        %KV_VFC_E;                              /* VFC DEFINITIONS                    */
      418      174        %KV$MRD;                                /*  REAL DEVICE CONTEXT BLOCK         */
      419      221        %KV$MVD;                                /*  VIRTUAL DEVICE CONTEXT BLOCK      */
      420      265        %KV$PTR;                                /*  VDH POINTER BLOCK                 */
      421      308        %KV$SRD;                                /*  SUBORDINATE REAL DEVICE CONTEXT   */
      422      583        %KV$SSN;                                /*  SESSION CONTEXT                   */
      423      662        %KV$STR;                                /*  STREAM CONTEXT                    */
      424      749        %KV$VDH_OTPLCL;                         /*  ARGUMENT STRUCTURE                */
      425      822        %KV$VDH_PST;                            /*  ARGUMENT TO VDH POSITION ROUTINE  */
      426      896        %KV$VDI;                                /*  VDI CONTEXT                       */
      427      967        %KV$VFU;                                /*  VFU IMAGE TEMPLATE                */
      428     1014        %KV_PSTORG_E;                           /*  PST ORG EQU                       */
      429     1019        %KV#VD_ORG_E;                           /* VD ORGs                            */
      430     1027        %KV$TITLE(STCLASS = "BASED(TTL$)");
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:70   
      431     1075
      432     1076    1   DCL KVO$PST ENTRY(1);
      433     1077    1   DCL KVO$OTPLCL ENTRY(1);
      434     1078    1   DCL KVO$SCREND ENTRY;
      435     1079
      436     1080
      437     1081        /* ORIGINAL VIRTUAL COLUMN                                                    */
      438     1082
      439     1083    1   DCL ORGVRTCLM UBIN ALIGNED;
      440     1084
      441     1085    1   DCL TTL$ PTR ALIGNED;
      442     1086
      443     1087    1   DCL TTLENB BIT(1) ALIGNED;
      444     1088
      445     1089        /* BUFFER TO HOLD UNDERSCORES FOR PERF SIMULATION                             */
      446     1090
      447     1091    1   DCL BFR(0:149) CHAR(1) UNAL INIT('_'*0) CONSTANT;
      448     1092
      449     1093    1   DCL PGBUF CHAR(6);
      450     1094    1   DCL PGBUFN(0:5) REDEF PGBUF UBIN BYTE UNAL;
      451     1095    1   DCL LIN SBIN ALIGNED;
      452     1096
      453     1097         %KV$VDH_OTPLCL(NAME = VDH_OTPLCL, STCLASS = AUTO);
      454     1170         %KV$VDH_OTPLCL(NAME = KV_VDH_OTPLCL, STCLASS = SYMREF);
      455     1243         %KV$VDH_PST(NAME = VDH_PST, STCLASS = AUTO);
      456     1317         %KV$VDH_PST(NAME = KV_VDH_PST_CR, STCLASS = SYMREF);
      457     1391    1   DCL KV_VDH_PST_WHTSPC_CR SBIN SYMREF;
      458     1392
      459     1393    1      TTLENB = '1'B;

   1393   1 000005  8947 0007                            LBT,'8000'X       TTLENB,AUTO
   1393   1 000007       8000

      460     1394    1      GOTO SUBCOMMON;

   1394   1 000008  0F81 0008                            B        s:1404,PREL

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:71   
      461     1395
      462     1396    1   KVO$PAGBRKNO_TTL: ENTRY;

   1396   1 00000A  D380 0000 0000  xent KVO$PAGBRKNO_TTLLNJ,B5   X6A_AUTO_0
          1 00000D       0018 0000                       DC       24,0

      463     1397
      464     1398    1      TTLENB = '0'B;

   1398   1 00000F  8747 0007                            CL       TTLENB,AUTO

      465     1399
      466     1400    1   SUBCOMMON:
      467     1401
      468     1402        /* RESET PAGE BREAK PENDING                                                   */
      469     1403
      470     1404    1      %KV_MVD.PAGBRKPND = '0'B;

   1404   1 000011  EC80 0000 0000  xsym SUBCOMMON       LDB,B6   KV$PTR$
          1 000014  DCC6 0006                            LDB,B5   6,B6
          1 000016  8845 0016                            LBF,'0001'X       22,B5
          1 000018       0001

      471     1405
      472     1406        /* MAKE SURE WE CAN DO A LOGICAL PAGE BREAK                                   */
      473     1407
      474     1408    2      IF NOT %KV_MVD.FRMSCNINH THEN DO;

   1408   1 000019  DCC6 0006                            LDB,B5   6,B6
          1 00001B  82C5 0016                            LB,'0010'X        22,B5
          1 00001D       0010
          1 00001E  0501 01E2                            BBT      s:1554,PREL

      475     1409
      476     1410        /* IF THE PAGE LENGTH IS LESS THAN 12, FORGET PAGINATION                      */
      477     1411
      478     1412    3         IF (%KV_MVD.LNG < 12) THEN DO;
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:72   

   1412   1 000020  E2C5 0014                            LLH,R6   20,B5
          1 000022  6D0C                                 CMV,R6   12
          1 000023  0281 000D                            BGE      s:1419,PREL

      479     1413    3            CALL KVO$PST (KV_VDH_PST_WHTSPC_CR);

   1413   1 000025  BB80 0000 0000  02                   LAB,B3   0
          1 000028  CBF0 0100                            LAB,B4   256,IMO
          1 00002A  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 00002D       0001                            DC       s:1414,PREL

      480     1414    3            RETURN;

   1414   1 00002E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      481     1415    3         END /* IF */;
      482     1416
      483     1417        /* DISABLE LOGICAL PAGINATION                                                 */
      484     1418
      485     1419    2         %KV_MVD.FRMSCNINH = '1'B;

   1419   1 000031  8945 0016                            LBT,'0010'X       22,B5
   1419   1 000033       0010

      486     1420
      487     1421        /* STASH AWAY A FEW FLAGS AND BUMP THE PAGE COUNT                             */
      488     1422
      489     1423    2         ORGVRTCLM = %KV_MVD.VRTCLM;

   1423   1 000034  DCC6 0006                            LDB,B5   6,B6
          1 000036  E845 001B                            LDR,R6   27,B5
          1 000038  EF47 0004                            STR,R6   ORGVRTCLM,AUTO

      490     1424    2         %KV_MVD.PAGNMB = %KV_MVD.PAGNMB+1;

   1424   1 00003A  8AC5 001E                            INC      30,B5
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:73   

      491     1425
      492     1426        /* SETUP A POSITIONING FPT                                                    */
      493     1427
      494     1428    2         VDH_PST = KV_VDH_PST_CR;

   1428   1 00003C  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_PST_CR
          1 00003F  2C00                                 LDV,R2   0
          1 000040  6C08                                 LDV,R6   8
          1 000041  BB87                                 LAB,B3   ,AUTO
          1 000042  3C22                                 LDV,R3   34
          1 000043  0008                                 MMM

      495     1429
      496     1430        /* IF THE USER WANTS TO SIMULATE THE PERF (HE HAS CONTINUOUS FORMS ON HIS     */
      497     1431        /* TERMINAL) PRINT UNDERSCORES ACROSS THE PAGE AT THE BOTTOM                  */
      498     1432
      499     1433    3         IF %KV_VDI.DVCPGNENB THEN DO;

   1433   1 000044  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000047  DC86                                 LDB,B5   ,B6
          1 000048  82C5 0019                            LB,'0004'X        25,B5
          1 00004A       0004
          1 00004B  0581 005E                            BBF      s:1462,PREL

      500     1434    4            IF %KV_MVD.SIMPERF AND NOT %KV_SRD.SCROLL THEN DO;

   1434   1 00004D  CCC6 0006                            LDB,B4   6,B6
          1 00004F  82C4 0016                            LB,'0002'X        22,B4
          1 000051       0002
          1 000052  0581 0051                            BBF      s:1457,PREL
          1 000054  ACC6 000A                            LDB,B2   10,B6
          1 000056  82C2 000E                            LB,'0008'X        14,B2
          1 000058       0008
          1 000059  0501 004A                            BBT      s:1457,PREL

      501     1435
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:74   
      502     1436        /* POSITION TO THE BOTTOM LINE                                                */
      503     1437
      504     1438    4               LIN = %KV_SRD.BTMRHT.LIN-%KV_SRD.CRT.LIN;

   1438   1 00005B  E842 000B                            LDR,R6   11,B2
          1 00005D  E242 0015                            SUB,R6   21,B2
          1 00005F  EF47 000B                            STR,R6   LIN,AUTO

      505     1439    5               IF %KV_SRD.PAGEHALT AND %KV_SRD.PRINTHALT THEN DO;

   1439   1 000061  82C2 000E                            LB,'0020'X        14,B2
   1439   1 000063       0020
          1 000064  0581 0008                            BBF      s:1442,PREL
          1 000066  82C2 000E                            LB,'0080'X        14,B2
          1 000068       0080
          1 000069  0581 0003                            BBF      s:1442,PREL

      506     1440    5                  LIN = LIN-1;

   1440   1 00006B  88C7 000B                            DEC      LIN,AUTO

      507     1441    5               END /* IF */;

      508     1442    5               IF LIN > 0 THEN DO;

   1442   1 00006D  E847 000B                            LDR,R6   LIN,AUTO
          1 00006F  6A81 0003                            BLEZ,R6  s:1445,PREL

      509     1443    5                  VDH_PST.PSTVAL.LIN = LIN;

   1443   1 000071  EF47 0013                            STR,R6   VDH_PST+2,AUTO

      510     1444    5               END /* IF */;

      511     1445    4               CALL KVO$PST(VDH_PST);

   1445   1 000073  DBC7 0011                            LAB,B5   VDH_PST,AUTO
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:75   
          1 000075  DFC7 0016                            STB,B5   VDH_PST+5,AUTO
          1 000077  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 000079  CBF0 0100                            LAB,B4   256,IMO
          1 00007B  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 00007E       0001                            DC       s:1447,PREL

      512     1446
      513     1447    4               VDH_OTPLCL = KV_VDH_OTPLCL;

   1447   1 00007F  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_OTPLCL
          1 000082  2C00                                 LDV,R2   0
          1 000083  6C0A                                 LDV,R6   10
          1 000084  BB87                                 LAB,B3   ,AUTO
          1 000085  3C18                                 LDV,R3   24
          1 000086  0008                                 MMM

      514     1448    4               VDH_OTPLCL.NONVRT = '1'B;

   1448   1 000087  8947 000C                            LBT,'0080'X       VDH_OTPLCL,AUTO
   1448   1 000089       0080

      515     1449    4               VDH_OTPLCL.BFR_.ADR$ = ADDR(BFR);

   1449   1 00008A  EB80 0000 0000  00                   LAB,B6   BFR
          1 00008D  EFC7 000D                            STB,B6   VDH_OTPLCL+1,AUTO

      516     1450    4               VDH_OTPLCL.BFR_.BYTSIZ = %KV_SRD.WDT;

   1450   1 00008F  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 000092  CCC5 000A                            LDB,B4   10,B5
          1 000094  E844 000D                            LDR,R6   13,B4
          1 000096  EF47 0010                            STR,R6   VDH_OTPLCL+4,AUTO

      517     1451    4               CALL KVO$OTPLCL(VDH_OTPLCL);

   1451   1 000098  CBC7 000C                            LAB,B4   VDH_OTPLCL,AUTO
          1 00009A  CFC7 0016                            STB,B4   VDH_PST+5,AUTO
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:76   
          1 00009C  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 00009E  CBF0 0100                            LAB,B4   256,IMO
          1 0000A0  E380 0000 0000  xent                 LNJ,B6   KVO$OTPLCL
          1 0000A3       0001                            DC       s:1457,PREL

      518     1452
      519     1453    4            END /* IF */;

      520     1454
      521     1455        /* NOW GET TO TOF                                                             */
      522     1456
      523     1457    3            CALL KVO$SCREND;

   1457   1 0000A4  CBF0 0000                            LAB,B4   0,IMO
          1 0000A6  E380 0000 0000  xent                 LNJ,B6   KVO$SCREND
          1 0000A9       0001                            DC       s:1462,PREL

      524     1458    3         END /* IF */;

      525     1459
      526     1460        /* ADVANCE TO FIRST PRINTABLE LINE                                            */
      527     1461
      528     1462    2         VDH_PST.PSTVAL.LIN = %KV_MVD.FRSLIN;

   1462   1 0000AA  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0000AD  DCC6 0006                            LDB,B5   6,B6
          1 0000AF  E845 001D                            LDR,R6   29,B5
          1 0000B1  E570 00FF                            AND,R6   255,IMO
          1 0000B3  EF47 0013                            STR,R6   VDH_PST+2,AUTO

      529     1463    2         CALL KVO$PST(VDH_PST);

   1463   1 0000B5  DBC7 0011                            LAB,B5   VDH_PST,AUTO
          1 0000B7  DFC7 0016                            STB,B5   VDH_PST+5,AUTO
          1 0000B9  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 0000BB  CBF0 0100                            LAB,B4   256,IMO
          1 0000BD  E380 0000 0000  xent                 LNJ,B6   KVO$PST
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:77   
          1 0000C0       0001                            DC       s:1467,PREL

      530     1464
      531     1465        /* REINIT COUNTERS FOR START OF NEW PAGE                                      */
      532     1466
      533     1467    2         %KV_MVD.FRMLIN = 0;

   1467   1 0000C1  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0000C4  DCC6 0006                            LDB,B5   6,B6
          1 0000C6  87C5 001D                            CLH      29,B5

      534     1468    2         %KV_MVD.VRTLIN = 0;

   1468   1 0000C8  DCC6 0006                            LDB,B5   6,B6
          1 0000CA  8745 001A                            CL       26,B5

      535     1469    2         %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRT.LIN;

   1469   1 0000CC  DCC6 000A                            LDB,B5   10,B6
          1 0000CE  E845 0015                            LDR,R6   21,B5
          1 0000D0  EF45 0013                            STR,R6   19,B5

      536     1470    2         %KV_SRD.VRTPSTOK = '1'B;

   1470   1 0000D2  DCC6 000A                            LDB,B5   10,B6
          1 0000D4  8945 000E                            LBT,'0010'X       14,B5
          1 0000D6       0010

      537     1471    2         VDH_PST.PSTVAL.LIN = 0;

   1471   1 0000D7  8747 0013                            CL       VDH_PST+2,AUTO

      538     1472    2         VDH_PST.VRT = '1'B;

   1472   1 0000D9  8947 0011                            LBT,'0080'X       VDH_PST,AUTO
   1472   1 0000DB       0080

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:78   
      539     1473
      540     1474        /* CHECK TO MAKE SURE WE ARE TO PUT OUT A HEADER                              */
      541     1475
      542     1476    3         IF TTLENB THEN DO;

   1476   1 0000DC  89C7 0007                            CMZ      TTLENB,AUTO
          1 0000DE  0881 010A                            BAGE     s:1547,PREL

      543     1477
      544     1478        /* DECIDE WHETHER TO USE SESSION HEADER OR DCB HEADER                         */
      545     1479
      546     1480    3            IF %KV_SSN.HDNTYPIS_DCB

   1480   1 0000E0  DCC6 0002                            LDB,B5   2,B6
          1 0000E2  82C5 0027                            LB,'0040'X        39,B5
          1 0000E4       0040
          1 0000E5  0581 0009                            BBF      s:1482,PREL

      547     1481    3            THEN TTL$ = %KV_MVD.DCBHDN$;

   1481   1 0000E7  CCC6 0006                            LDB,B4   6,B6
          1 0000E9  BCC4 0006                            LDB,B3   6,B4
          1 0000EB  BFC7 0005                            STB,B3   TTL$,AUTO
          1 0000ED  0F81 0005                            B        s:1486,PREL

      548     1482    3            ELSE TTL$ = %KV_SSN.SSNHDN$;

   1482   1 0000EF  CCC5 0006                            LDB,B4   6,B5
          1 0000F1  CFC7 0005                            STB,B4   TTL$,AUTO

      549     1483
      550     1484        /* IF THE HEADER IS NON-ADDR(NIL), WE PRINT IT
              1484        */
      551     1485
      552     1486    4            IF (TTL$ ~= ADDR(NIL)) THEN DO;

   1486   1 0000F3  8DC7 0005                            CMN      TTL$,AUTO
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:79   
          1 0000F5  0901 00F3                            BE       s:1547,PREL

      553     1487
      554     1488    4               VDH_OTPLCL = KV_VDH_OTPLCL;

   1488   1 0000F7  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_OTPLCL
          1 0000FA  2C00                                 LDV,R2   0
          1 0000FB  6C0A                                 LDV,R6   10
          1 0000FC  BB87                                 LAB,B3   ,AUTO
          1 0000FD  3C18                                 LDV,R3   24
          1 0000FE  0008                                 MMM

      555     1489
      556     1490        /* ADVANCE TO EITHER COUNT COLUMN OR INDENT COLUMN, WHICHEVER IS              */
      557     1491        /* CLOSEST TO LEFT MARGIN                                                     */
      558     1492
      559     1493    4               IF KV$TITLE.INDCLM < KV$TITLE.CNTCLM

   1493   1 0000FF  ECC7 0005                            LDB,B6   TTL$,AUTO
          1 000101  E2C6 0005                            LLH,R6   5,B6
          1 000103  D846 0005                            LDR,R5   5,B6
          1 000105  D570 00FF                            AND,R5   255,IMO
          1 000107  E955                                 CMR,R6   R5
          1 000108  0801 0006                            BAL      s:1498,PREL
          1 00010A  82C6 0005                            LB,'00FF'X        5,B6
          1 00010C       00FF
          1 00010D  0501 0039                            BBT      s:1510,PREL

      560     1494    5                 OR KV$TITLE.CNTCLM = 0 THEN DO;

      561     1495
      562     1496        /* The title starts first, put out some of it */
      563     1497
      564     1498    5                  VDH_PST.PSTVAL.CLM = KV$TITLE.INDCLM;

   1498   1 00010F  EF47 0014                            STR,R6   VDH_PST+3,AUTO

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:80   
      565     1499    5                  CALL KVO$PST(VDH_PST);

   1499   1 000111  DBC7 0011                            LAB,B5   VDH_PST,AUTO
          1 000113  DFC7 0016                            STB,B5   VDH_PST+5,AUTO
          1 000115  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 000117  CBF0 0100                            LAB,B4   256,IMO
          1 000119  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 00011C       0001                            DC       s:1500,PREL

      566     1500    5                  VDH_OTPLCL.BFR_.ADR$ = TTL$;

   1500   1 00011D  ECC7 0005                            LDB,B6   TTL$,AUTO
          1 00011F  EFC7 000D                            STB,B6   VDH_OTPLCL+1,AUTO

      567     1501    5                  VDH_OTPLCL.BFR_.BYTX = SIZEC(KV$TITLE)-1;

   1501   1 000121  6C0D                                 LDV,R6   13
          1 000122  EF47 000F                            STR,R6   VDH_OTPLCL+3,AUTO

      568     1502    5                  VDH_OTPLCL.BFR_.BYTSIZ = KV$TITLE.TXTSIZ;

   1502   1 000124  D2C6 0006                            LLH,R5   6,B6
          1 000126  DF47 0010                            STR,R5   VDH_OTPLCL+4,AUTO

      569     1503    6                  IF KV$TITLE.CNTCLM ~= 0 THEN DO;

   1503   1 000128  82C6 0005                            LB,'00FF'X        5,B6
   1503   1 00012A       00FF
          1 00012B  0581 000F                            BBF      s:1507,PREL

      570     1504    6                     VDH_OTPLCL.BFR_.BYTSIZ = MINIMUM (VDH_OTPLCL.BFR_.BYTSIZ,

   1504   1 00012D  C846 0005                            LDR,R4   5,B6
          1 00012F  C570 00FF                            AND,R4   255,IMO
          1 000131  B2C6 0005                            LLH,R3   5,B6
          1 000133  C253                                 SUB,R4   R3
          1 000134  C955                                 CMR,R4   R5
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:81   
          1 000135  0A81 0002                            BALE     s:1504+11,PREL
          1 000137  C855                                 LDR,R4   R5
          1 000138  D854                                 LDR,R5   R4
          1 000139  DF47 0010                            STR,R5   VDH_OTPLCL+4,AUTO

      571     1505    6                       KV$TITLE.CNTCLM - KV$TITLE.INDCLM);
      572     1506    6                  END;

      573     1507    5                  CALL KVO$OTPLCL(VDH_OTPLCL);

   1507   1 00013B  DBC7 000C                            LAB,B5   VDH_OTPLCL,AUTO
          1 00013D  DFC7 0016                            STB,B5   VDH_PST+5,AUTO
          1 00013F  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 000141  CBF0 0100                            LAB,B4   256,IMO
          1 000143  E380 0000 0000  xent                 LNJ,B6   KVO$OTPLCL
          1 000146       0001                            DC       s:1510,PREL

      574     1508    5               END;

      575     1509        /* Now send the page number, if it wants to go */
      576     1510    5               IF KV$TITLE.CNTCLM ~= 0 THEN DO;

   1510   1 000147  ECC7 0005                            LDB,B6   TTL$,AUTO
          1 000149  82C6 0005                            LB,'00FF'X        5,B6
          1 00014B       00FF
          1 00014C  0581 004A                            BBF      s:1521,PREL

      577     1511    5                  VDH_PST.PSTVAL.CLM = KV$TITLE.CNTCLM;

   1511   1 00014E  E846 0005                            LDR,R6   5,B6
          1 000150  E570 00FF                            AND,R6   255,IMO
          1 000152  EF47 0014                            STR,R6   VDH_PST+3,AUTO

      578     1512    5                  CALL KVO$PST(VDH_PST);

   1512   1 000154  DBC7 0011                            LAB,B5   VDH_PST,AUTO
          1 000156  DFC7 0016                            STB,B5   VDH_PST+5,AUTO
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:82   
          1 000158  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 00015A  CBF0 0100                            LAB,B4   256,IMO
          1 00015C  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 00015F       0001                            DC       s:1513,PREL

      579     1513    5                  CALL BINCHAR(PGBUF, %KV_MVD.PAGNMB);

   1513   1 000160  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000163  DCC6 0006                            LDB,B5   6,B6
          1 000165  F845 001E                            LDR,R7   30,B5
          1 000167  6C00                                 LDV,R6   0
          1 000168  8D47 0016                            SDI      VDH_PST+5,AUTO
          1 00016A  0027                                 CBD      ;
          1 00016B       0407 0016                                BINARY(VDH_PST+5,AUTO,,4),;
          1 00016D       0607 0008                                UNPACKED(PGBUF,AUTO,,6,UNSIGNED)

      580     1514    5                  VDH_OTPLCL.BFR_.ADR$ = ADDR(PGBUF);

   1514   1 00016F  DBC7 0008                            LAB,B5   PGBUF,AUTO
          1 000171  DFC7 000D                            STB,B5   VDH_OTPLCL+1,AUTO

      581     1515    6                  DO VDH_OTPLCL.BFR_.BYTX = 0 TO SIZEC(PGBUF)-2;

   1515   1 000173  8747 000F                            CL       VDH_OTPLCL+3,AUTO
          1 000175  437F                                 CSYNC    s:1515+1,SPREL
          1 000176  0F81 000A                            B        s:1517+2,PREL

      582     1516    6                     IF PGBUFN(VDH_OTPLCL.BFR_.BYTX) ~= ASCBIN('0') THEN EXIT;

   1516   1 000178  B847 000F                            LDR,R3   VDH_OTPLCL+3,AUTO
          1 00017A  3E10                                 ADV,R3   16
          1 00017B  E2B7                                 LLH,R6   ,AUTO,R3
          1 00017C  6D30                                 CMV,R6   48
          1 00017D  0981 0007                            BNE      s:1518,PREL

      583     1517    6                  END;

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:83   
   1517   1 00017F  8AC7 000F                            INC      VDH_OTPLCL+3,AUTO
          1 000181  E847 000F                            LDR,R6   VDH_OTPLCL+3,AUTO
          1 000183  6D04                                 CMV,R6   4
          1 000184  0AF4                                 BALE     s:1516,SPREL

      584     1518    5                  VDH_OTPLCL.BFR_.BYTSIZ = SIZEC(PGBUF)-VDH_OTPLCL.BFR_.BYTX;

   1518   1 000185  E847 000F                            LDR,R6   VDH_OTPLCL+3,AUTO
          1 000187  8256                                 NEG      R6
          1 000188  6E06                                 ADV,R6   6
          1 000189  EF47 0010                            STR,R6   VDH_OTPLCL+4,AUTO

      585     1519    5                  CALL KVO$OTPLCL(VDH_OTPLCL);

   1519   1 00018B  EBC7 000C                            LAB,B6   VDH_OTPLCL,AUTO
          1 00018D  EFC7 0016                            STB,B6   VDH_PST+5,AUTO
          1 00018F  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 000191  CBF0 0100                            LAB,B4   256,IMO
          1 000193  E380 0000 0000  xent                 LNJ,B6   KVO$OTPLCL
          1 000196       0001                            DC       s:1521,PREL

      586     1520    5               END;

      587     1521    5               IF KV$TITLE.INDCLM+KV$TITLE.TXTSIZ > %KV_MVD.VRTCLM THEN DO;

   1521   1 000197  ECC7 0005                            LDB,B6   TTL$,AUTO
          1 000199  E2C6 0005                            LLH,R6   5,B6
          1 00019B  D2C6 0006                            LLH,R5   6,B6
          1 00019D  EA55                                 ADD,R6   R5
          1 00019E  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 0001A1  CCC5 0006                            LDB,B4   6,B5
          1 0001A3  6801 0005                            BLZ,R6   s:1525,PREL
          1 0001A5  E944 001B                            CMR,R6   27,B4
          1 0001A7  0A81 0039                            BALE     s:1541,PREL

      588     1522
      589     1523        /* There's still some title left to send */
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:84   
      590     1524
      591     1525    6                  IF KV$TITLE.INDCLM > %KV_MVD.VRTCLM THEN DO;

   1525   1 0001A9  E2C6 0005                            LLH,R6   5,B6
          1 0001AB  E944 001B                            CMR,R6   27,B4
          1 0001AD  0A81 000F                            BALE     s:1531,PREL

      592     1526        /* We need to position to the start of the title */
      593     1527
      594     1528    6                     VDH_PST.PSTVAL.CLM = KV$TITLE.INDCLM;

   1528   1 0001AF  EF47 0014                            STR,R6   VDH_PST+3,AUTO

      595     1529    6                     CALL KVO$PST(VDH_PST);

   1529   1 0001B1  CBC7 0011                            LAB,B4   VDH_PST,AUTO
          1 0001B3  CFC7 0016                            STB,B4   VDH_PST+5,AUTO
          1 0001B5  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 0001B7  CBF0 0100                            LAB,B4   256,IMO
          1 0001B9  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 0001BC       0001                            DC       s:1531,PREL

      596     1530    6                  END;

      597     1531    5                  VDH_OTPLCL.BFR_.BYTSIZ =

   1531   1 0001BD  ECC7 0005                            LDB,B6   TTL$,AUTO
          1 0001BF  E2C6 0006                            LLH,R6   6,B6
          1 0001C1  D2C6 0005                            LLH,R5   5,B6
          1 0001C3  EA55                                 ADD,R6   R5
          1 0001C4  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 0001C7  CCC5 0006                            LDB,B4   6,B5
          1 0001C9  E244 001B                            SUB,R6   27,B4
          1 0001CB  EF47 0010                            STR,R6   VDH_OTPLCL+4,AUTO

      598     1532    5                    KV$TITLE.TXTSIZ+KV$TITLE.INDCLM-%KV_MVD.VRTCLM;
      599     1533    5                  VDH_OTPLCL.BFR_.ADR$ = TTL$;
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:85   

   1533   1 0001CD  EFC7 000D                            STB,B6   VDH_OTPLCL+1,AUTO

      600     1534    5                  VDH_OTPLCL.BFR_.BYTX = SIZEC(KV$TITLE)-1+

   1534   1 0001CF  D2C6 0006                            LLH,R5   6,B6
          1 0001D1  D256                                 SUB,R5   R6
          1 0001D2  5E0D                                 ADV,R5   13
          1 0001D3  DF47 000F                            STR,R5   VDH_OTPLCL+3,AUTO

      601     1535    5                    KV$TITLE.TXTSIZ-VDH_OTPLCL.BFR_.BYTSIZ;
      602     1536    5                  CALL KVO$OTPLCL(VDH_OTPLCL);

   1536   1 0001D5  CBC7 000C                            LAB,B4   VDH_OTPLCL,AUTO
          1 0001D7  CFC7 0016                            STB,B4   VDH_PST+5,AUTO
          1 0001D9  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 0001DB  CBF0 0100                            LAB,B4   256,IMO
          1 0001DD  E380 0000 0000  xent                 LNJ,B6   KVO$OTPLCL
          1 0001E0       0001                            DC       s:1541,PREL

      603     1537    5               END;

      604     1538
      605     1539        /* IF THE USER HAS SPECIFIED A HEIGHT IN THE TITLE, FUDGE UP A CALL TO        */
      606     1540
      607     1541    4               VDH_PST.PSTVAL.LIN = KV$TITLE.HGT;

   1541   1 0001E1  ECC7 0005                            LDB,B6   TTL$,AUTO
          1 0001E3  E846 0004                            LDR,R6   4,B6
          1 0001E5  E570 00FF                            AND,R6   255,IMO
          1 0001E7  EF47 0013                            STR,R6   VDH_PST+2,AUTO

      608     1542    4            END /* IF */;

      609     1543    3         END /* IF */;

      610     1544
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:86   
      611     1545        /* RESTORE VIRTUAL AND PHYSICAL COLUMNS                                       */
      612     1546
      613     1547    2         VDH_PST.PSTVAL.CLM = ORGVRTCLM;

   1547   1 0001E9  E847 0004                            LDR,R6   ORGVRTCLM,AUTO
          1 0001EB  EF47 0014                            STR,R6   VDH_PST+3,AUTO

      614     1548    2         CALL KVO$PST(VDH_PST);

   1548   1 0001ED  EBC7 0011                            LAB,B6   VDH_PST,AUTO
          1 0001EF  EFC7 0016                            STB,B6   VDH_PST+5,AUTO
          1 0001F1  BBC7 0016                            LAB,B3   VDH_PST+5,AUTO
          1 0001F3  CBF0 0100                            LAB,B4   256,IMO
          1 0001F5  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 0001F8       0001                            DC       s:1552,PREL

      615     1549
      616     1550        /* RE-ENABLE LOGICAL PAGINATION                                               */
      617     1551
      618     1552    2         %KV_MVD.FRMSCNINH = '0'B;

   1552   1 0001F9  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 0001FC  DCC6 0006                            LDB,B5   6,B6
          1 0001FE  8845 0016                            LBF,'0010'X       22,B5
          1 000200       0010

      619     1553    2      END /* IF */;

      620     1554    1      RETURN;

   1554   1 000201  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      621     1555        %EJECT;
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:87   
      622     1556        /* SET THE COUNTERS IF USER SAID AT PERF                                      */
      623     1557
      624     1558    1   KVO$PAGBRK_ATPRF: ENTRY;

   1558   1 000204  D380 0000 0000  xent KVO$PAGBRK_ATPRFLNJ,B5   X6A_AUTO_0
          1 000207       0018 0000                       DC       24,0

      625     1559
      626     1560
      627     1561    1      LIN = %KV_SRD.CRTVRTLINPHSLIN-%KV_SRD.CRT.LIN;

   1561   1 000209  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 00020C  DCC6 000A                            LDB,B5   10,B6
          1 00020E  E845 0013                            LDR,R6   19,B5
          1 000210  E245 0015                            SUB,R6   21,B5
          1 000212  EF47 000B                            STR,R6   LIN,AUTO

      628     1562    1      %KV_MVD.VRTLIN = %KV_MVD.LNG;

   1562   1 000214  CCC6 0006                            LDB,B4   6,B6
          1 000216  D2C4 0014                            LLH,R5   20,B4
          1 000218  DF44 001A                            STR,R5   26,B4

      629     1563    1      %KV_MVD.FRMLIN = %KV_MVD.LNG;

   1563   1 00021A  DCC6 0006                            LDB,B5   6,B6
          1 00021C  D2C5 0014                            LLH,R5   20,B5
          1 00021E  D7C5 001D                            STH,R5   29,B5

      630     1564    1      %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.BTMRHT.LIN;

   1564   1 000220  DCC6 000A                            LDB,B5   10,B6
          1 000222  D845 000B                            LDR,R5   11,B5
          1 000224  DF45 0013                            STR,R5   19,B5

      631     1565    1      %KV_SRD.CRT.LIN = %KV_SRD.BTMRHT.LIN;

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:88   
   1565   1 000226  DCC6 000A                            LDB,B5   10,B6
          1 000228  D845 000B                            LDR,R5   11,B5
          1 00022A  DF45 0015                            STR,R5   21,B5

      632     1566    1      %KV_MRD.DVCLIN = %KV_SRD.BTMRHT.LIN;

   1566   1 00022C  DCC6 0008                            LDB,B5   8,B6
          1 00022E  CCC6 000A                            LDB,B4   10,B6
          1 000230  D844 000B                            LDR,R5   11,B4
          1 000232  DF45 001D                            STR,R5   29,B5

      633     1567    1      %KV_MVD.FRMLIN = %KV_MVD.FRMLIN-1;

   1567   1 000234  DCC6 0006                            LDB,B5   6,B6
          1 000236  D2C5 001D                            LLH,R5   29,B5
          1 000238  5EFF                                 ADV,R5   -1
          1 000239  D7C5 001D                            STH,R5   29,B5

      634     1568    1      %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRTVRTLINPHSLIN + LIN;

   1568   1 00023B  DCC6 000A                            LDB,B5   10,B6
          1 00023D  EA45 0013                            ADD,R6   19,B5
          1 00023F  EF45 0013                            STR,R6   19,B5

      635     1569    1      RETURN;

   1569   1 000241  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      636     1570    1   END;

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:89   
--  Include file information  --

   KV_ASCCHR_E.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$PAGBRK.
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:90   

 **** Variables and constants ****

  ****  Section 000 RoData KVO$PAGBRK

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 BFR(0:149)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     B-0-0/w SBIN(16)    r     1 LIN                        4-0-0/w UBIN(16)    r     1 ORGVRTCLM
     8-0-0/c CHAR(6)     r     1 PGBUF                      8-0-0/c UBIN(8)     r     1 PGBUFN(0:5)
     5-0-0/w PTR         r     1 TTL$                       7-0-0/w BIT         r     1 TTLENB
     C-0-0/w STRC(80)    r     1 VDH_OTPLCL                11-0-0/w STRC(64)    r     1 VDH_PST

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV$PTR$                    0-0-0/w STRC(80)    r     1 KV_VDH_OTPLCL
     0-0-0/w STRC(64)    r     1 KV_VDH_PST_CR              0-0-0/w SBIN(16)    r     1 KV_VDH_PST_WHTSPC_CR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KV$MRD                     0-0-0/w STRC(512)   r     1 KV$MVD
     0-0-0/w STRC(480)   r     1 KV$PTR                     0-0-0/w STRC(496)   r     1 KV$SRD
     0-0-0/w STRC(1024)  r     1 KV$SSN                     0-0-0/w STRC(104)   r     1 KV$TITLE
     0-0-0/w STRC(512)   r     1 KV$VDI

PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:91   

   Procedure KVO$PAGBRK requires 580 words for executable code.
   Procedure KVO$PAGBRK requires 24 words of local(AUTO) storage.

    No errors detected in file KVO$VFC.:E05TSI    .
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:92   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:93   
          MINI XREF LISTING

BFR
      1091**DCL      1449--ASSIGN
KV$MRD.DVCLIN
       218**DCL      1566<<ASSIGN
KV$MVD.DCBHDN$
       244**DCL      1481>>ASSIGN
KV$MVD.FRMLIN
       261**DCL      1467<<ASSIGN   1563<<ASSIGN   1567<<ASSIGN   1567>>ASSIGN
KV$MVD.FRMSCNINH
       252**DCL      1408>>IF       1419<<ASSIGN   1552<<ASSIGN
KV$MVD.FRSLIN
       261**DCL      1462>>ASSIGN
KV$MVD.LNG
       247**DCL      1412>>IF       1562>>ASSIGN   1563>>ASSIGN
KV$MVD.PAGBRKPND
       253**DCL      1404<<ASSIGN
KV$MVD.PAGNMB
       262**DCL      1424<<ASSIGN   1424>>ASSIGN   1513>>CALLBLT
KV$MVD.SIMPERF
       252**DCL      1434>>IF
KV$MVD.VRTCLM
       260**DCL      1423>>ASSIGN   1521>>IF       1525>>IF       1531>>ASSIGN
KV$MVD.VRTLIN
       260**DCL      1468<<ASSIGN   1562<<ASSIGN
KV$PTR.INPCNDPND
       292**DCL       301--REDEF     305--REDEF
KV$PTR.LINLST$
       288**DCL       289--REDEF
KV$PTR.MRD$
       287**DCL      1566>>ASSIGN
KV$PTR.MVD$
       287**DCL      1404>>ASSIGN   1408>>IF       1412>>IF       1419>>ASSIGN   1423>>ASSIGN   1424>>ASSIGN
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:94   
      1424>>ASSIGN   1434>>IF       1462>>ASSIGN   1467>>ASSIGN   1468>>ASSIGN   1481>>ASSIGN   1513>>CALLBLT
      1521>>IF       1525>>IF       1531>>ASSIGN   1552>>ASSIGN   1562>>ASSIGN   1562>>ASSIGN   1563>>ASSIGN
      1563>>ASSIGN   1567>>ASSIGN   1567>>ASSIGN
KV$PTR.SRD$
       288**DCL      1434>>IF       1438>>ASSIGN   1438>>ASSIGN   1439>>IF       1439>>IF       1450>>ASSIGN
      1469>>ASSIGN   1469>>ASSIGN   1470>>ASSIGN   1561>>ASSIGN   1561>>ASSIGN   1564>>ASSIGN   1564>>ASSIGN
      1565>>ASSIGN   1565>>ASSIGN   1566>>ASSIGN   1568>>ASSIGN   1568>>ASSIGN
KV$PTR.SSN$
       286**DCL      1480>>IF       1482>>ASSIGN
KV$PTR.VDI$
       286**DCL      1433>>IF
KV$PTR$
       280**DCL       286--IMP-PTR  1404>>ASSIGN   1408>>IF       1412>>IF       1419>>ASSIGN   1423>>ASSIGN
      1424>>ASSIGN   1424>>ASSIGN   1433>>IF       1434>>IF       1434>>IF       1438>>ASSIGN   1438>>ASSIGN
      1439>>IF       1439>>IF       1450>>ASSIGN   1462>>ASSIGN   1467>>ASSIGN   1468>>ASSIGN   1469>>ASSIGN
      1469>>ASSIGN   1470>>ASSIGN   1480>>IF       1481>>ASSIGN   1482>>ASSIGN   1513>>CALLBLT  1521>>IF
      1525>>IF       1531>>ASSIGN   1552>>ASSIGN   1561>>ASSIGN   1561>>ASSIGN   1562>>ASSIGN   1562>>ASSIGN
      1563>>ASSIGN   1563>>ASSIGN   1564>>ASSIGN   1564>>ASSIGN   1565>>ASSIGN   1565>>ASSIGN   1566>>ASSIGN
      1566>>ASSIGN   1567>>ASSIGN   1567>>ASSIGN   1568>>ASSIGN   1568>>ASSIGN
KV$SRD.BTMRHT
       425**DCL       430--REDEF
KV$SRD.BTMRHT.LIN
       427**DCL      1438>>ASSIGN   1564>>ASSIGN   1565>>ASSIGN   1566>>ASSIGN
KV$SRD.CRT
       501**DCL       506--REDEF
KV$SRD.CRT.LIN
       503**DCL      1438>>ASSIGN   1469>>ASSIGN   1561>>ASSIGN   1565<<ASSIGN
KV$SRD.CRTVRTLINPHSLIN
       473**DCL      1469<<ASSIGN   1561>>ASSIGN   1564<<ASSIGN   1568<<ASSIGN   1568>>ASSIGN
KV$SRD.FLDEND
       465**DCL       470--REDEF
KV$SRD.HI_NONBLN
       535**DCL       540--REDEF
KV$SRD.ORG
       357**DCL       362--REDEF
KV$SRD.PAGEHALT
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:95   
       434**DCL      1439>>IF
KV$SRD.PRINTHALT
       433**DCL      1439>>IF
KV$SRD.SCROLL
       434**DCL      1434>>IF
KV$SRD.SRDEND
       570**DCL       575--REDEF
KV$SRD.TOPLFT
       391**DCL       396--REDEF
KV$SRD.VRTPSTOK
       434**DCL      1470<<ASSIGN
KV$SRD.WDT
       433**DCL      1450>>ASSIGN
KV$SSN.HDNTYPIS_DCB
       618**DCL      1480>>IF
KV$SSN.REDRSPCNT
       612**DCL       613--REDEF
KV$SSN.SSNHDN$
       607**DCL      1482>>ASSIGN
KV$TITLE
      1057**DCL      1501--ASSIGN   1534--ASSIGN
KV$TITLE.CNTCLM
      1073**DCL      1493>>IF       1493>>IF       1503>>IF       1504>>ASSIGN   1510>>IF       1511>>ASSIGN
KV$TITLE.HGT
      1072**DCL      1541>>ASSIGN
KV$TITLE.INDCLM
      1072**DCL      1493>>IF       1498>>ASSIGN   1504>>ASSIGN   1521>>IF       1525>>IF       1528>>ASSIGN
      1531>>ASSIGN
KV$TITLE.TXTSIZ
      1073**DCL      1073--REDEF    1502>>ASSIGN   1521>>IF       1531>>ASSIGN   1534>>ASSIGN
KV$VDH_PST.PSTVAL
       887**DCL       892--REDEF
KV$VDI.DVCPGNENB
       953**DCL      1433>>IF
KVO$OTPLCL
      1077**DCL-ENT  1451--CALL     1507--CALL     1519--CALL     1536--CALL
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:96   
KVO$PST
      1076**DCL-ENT  1413--CALL     1445--CALL     1463--CALL     1499--CALL     1512--CALL     1529--CALL
      1548--CALL
KVO$SCREND
      1078**DCL-ENT  1457--CALL
KV_VDH_OTPLCL
      1206**DCL      1447>>ASSIGN   1488>>ASSIGN
KV_VDH_PST_CR
      1344**DCL      1428>>ASSIGN
KV_VDH_PST_CR.PSTVAL
      1382**DCL      1387--REDEF
KV_VDH_PST_WHTSPC_CR
      1391**DCL      1413<>CALL
LIN
      1095**DCL      1438<<ASSIGN   1440<<ASSIGN   1440>>ASSIGN   1442>>IF       1443>>ASSIGN   1561<<ASSIGN
      1568>>ASSIGN
ORGVRTCLM
      1083**DCL      1423<<ASSIGN   1547>>ASSIGN
PGBUF
      1093**DCL      1094--REDEF    1513<<CALLBLT  1514--ASSIGN   1515--DOINDEX  1518--ASSIGN
PGBUFN
      1094**DCL      1516>>IF
SUBCOMMON
      1404**LABEL    1394--GOTO
TTL$
      1085**DCL      1057--IMP-PTR  1481<<ASSIGN   1482<<ASSIGN   1486>>IF       1493>>IF       1493>>IF
      1493>>IF       1498>>ASSIGN   1500>>ASSIGN   1502>>ASSIGN   1503>>IF       1504>>ASSIGN   1504>>ASSIGN
      1510>>IF       1511>>ASSIGN   1521>>IF       1521>>IF       1525>>IF       1528>>ASSIGN   1531>>ASSIGN
      1531>>ASSIGN   1533>>ASSIGN   1534>>ASSIGN   1541>>ASSIGN
TTLENB
      1087**DCL      1393<<ASSIGN   1398<<ASSIGN   1476>>IF
VDH_OTPLCL
      1133**DCL      1447<<ASSIGN   1451<>CALL     1488<<ASSIGN   1507<>CALL     1519<>CALL     1536<>CALL
VDH_OTPLCL.BFR_.ADR$
      1166**DCL      1449<<ASSIGN   1500<<ASSIGN   1514<<ASSIGN   1533<<ASSIGN
VDH_OTPLCL.BFR_.BYTSIZ
PL6.E3A0      #002=KVO$PAGBRK File=KVO$VFC.:E05TSI                               WED 07/30/97 02:12 Page:97   
      1166**DCL      1450<<ASSIGN   1502<<ASSIGN   1504<<ASSIGN   1504>>ASSIGN   1518<<ASSIGN   1531<<ASSIGN
      1534>>ASSIGN
VDH_OTPLCL.BFR_.BYTX
      1166**DCL      1501<<ASSIGN   1515<<DOINDEX  1516>>IF       1518>>ASSIGN   1534<<ASSIGN
VDH_OTPLCL.NONVRT
      1139**DCL      1448<<ASSIGN
VDH_PST
      1270**DCL      1428<<ASSIGN   1445<>CALL     1463<>CALL     1499<>CALL     1512<>CALL     1529<>CALL
      1548<>CALL
VDH_PST.PSTVAL
      1308**DCL      1313--REDEF
VDH_PST.PSTVAL.CLM
      1310**DCL      1498<<ASSIGN   1511<<ASSIGN   1528<<ASSIGN   1547<<ASSIGN
VDH_PST.PSTVAL.LIN
      1310**DCL      1443<<ASSIGN   1462<<ASSIGN   1471<<ASSIGN   1541<<ASSIGN
VDH_PST.VRT
      1276**DCL      1472<<ASSIGN
