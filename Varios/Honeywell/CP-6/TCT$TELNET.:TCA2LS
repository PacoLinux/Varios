VERSION A02

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* NTB,MCR=NO,PLM=3,CTI=6,IND=4,MCI=YES,SDI=1,DCI=4,ENU=0,ECU=0,CCC */
        7        7        TELNET: PROC MAIN;
        8        8        %INCLUDE CP_6;
        9       89
       10       90        %INCLUDE XU_MACRO_C;
       11     3196        %INCLUDE XUG_ENTRY;
       12     3227    1   DCL X$PRE_PROCESS ENTRY(1) ALTRET;
       13     3228        %XUG_GETCMD (NODES=TELNET_CMD, PROMPT=PROMPT);
       14     3566    1   DCL TELNET_CMD SBIN SYMREF;
       15     3567    1   DCL PROMPT CONSTANT CHAR(0) INIT(' Telnet>');
       16     3568        %XUG_INIT (PREPROCESS=YES, PREPROCESSOR=X$PRE_PROCESS, GOODCMD=YES);
       17     3981        %PARSE$OUT (STCLASS="BASED(P$)");
       18     4026        %PARSE$SYM (STCLASS=BASED);
       19     4064
       20     4065        %INCLUDE XSL_PERR_C;
       21     4120        %INCLUDE XSL_SOCKMSGS_E;
       22     4166        %INCLUDE XSL_SOCKET_E;
       23     4424        %INCLUDE XSL_SOCKET_M;
       24     5185        %INCLUDE XSL_INTERNAL_M;
       25     5436        %XSL_SOCKINIT( FPTN=TCT_SOCKINIT, MAXSOCK=2, NWSOCKS=0, STCLASS="CONSTANT SYMDEF");
       26     5559    1   DCL XSL$CLOSE ENTRY(2) ALTRET;
       27     5560    1   DCL XSL$CONNECT ENTRY(4) ALTRET;
       28     5561    1   DCL XSL$GETHOSTBYNAME ENTRY(2) ALTRET;
       29     5562    1   DCL XSL$INET_ADDR ENTRY(2) ALTRET;
       30     5563    1   DCL XSL$INET_NTOA ENTRY(2) ALTRET;
       31     5564    1   DCL XSL$SOCKET ENTRY(4) ALTRET;
       32     5565    1   DCL XSL$WRITE ENTRY(4) ALTRET;
       33     5566    1   DCL XSL$SOCKINIT ENTRY(1) ALTRET;
       34     5567    1   DCL XSL$HTONL ENTRY(2);
       35     5568
       36     5569        %INCLUDE TCT_TELNET_E;
       37     5624    1   DCL EVENT_HNDLR ENTRY ASYNC;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:2    
       38     5625    1   DCL INT_HNDLR ENTRY ASYNC;
       39     5626
       40     5627        %XSL$SOCKADDR_IN (FPTN=FS, STCLASS=STATIC);
       41     5691        %XSL$SOCKADDR_IN (FPTN=LS, STCLASS=STATIC);
       42     5755        %XSL$HOSTENT;
       43     5815
       44     5816    1   DCL LCN UBIN(36) STATIC SYMDEF;
       45     5817    1   DCL NET_BUF CHAR(1600) STATIC;
       46     5818        %F$DCB;
       47     5875        %M$DCB (DCBN=M$LO, RES='LO', FUN=CREATE, CTG=YES, ORG=TERMINAL);
       48     5949    1   DCL M$LO$ PTR;
       49     5950        %FPT_WRITE (DCB=M$LO,TRANS=YES,VFC=YES);
       50     5981        %FPT_WRITE (FPTN=WRITE_LO, DCB=M$LO);
       51     6012    1   DCL F$XSL00 DCB;
       52     6013    1   DCL I SBIN;
       53     6014    1   DCL P$ PTR;
       54     6015    1   DCL ACTCHRS(0:31) UBIN BYTE UNAL STATIC INIT(0*0);
       55     6016    1   DCL BITS8TO0(0:7) CONSTANT UBIN INIT(128, 64, 32,16,8,4,2,1);
       56     6017        %FPT_EOM (FPTN=EOMTERMINAL, DCB=M$UC, TIMEOUT=1, STCLASS=STATIC,
       57     6018                  UTYPE=MIL10, EOMTABLE=ACTCHRS);
       58     6048        %FPT_PROMPT (FPTN=TELNET_PROMPT, PROMPT=PROMPT, STCLASS=CONSTANT);
       59     6076        %FPT_PROMPT (FPTN=NO_PROMPT, PROMPT=ATPROMPT, VFC=YES, STCLASS=CONSTANT);
       60     6104    1   DCL ATPROMPT CONSTANT CHAR(0) INIT('@');
       61     6105        %VLP_EOMTABLE (FPTN=ACTNORMAL, STCLASS=CONSTANT, VALUES=STD);
       62     6124        %FPT_EOM (FPTN=EOMNORMAL, EOMTABLE=ACTNORMAL, TIMEOUT=0, STCLASS=CONSTANT);
       63     6154        %FPT_TRMPRG (FPTN=STOPTERMREAD, DCB=M$UC, ABORTREAD=YES, STCLASS=CONSTANT);
       64     6183        %FPT_TRMPRG (FPTN=STOPNETREAD, DCB=F$XSL00, ABORTREAD=YES, STCLASS=CONSTANT);
       65     6212    1   DCL TERM_BUF CHAR(256) STATIC SYMDEF;
       66     6213        %FPT_READ (FPTN=READ_TERM,
       67     6214               STCLASS=STATIC SYMDEF,
       68     6215               DCB=M$UC,
       69     6216               TRANS=YES,
       70     6217               WAIT=NO,
       71     6218               EVENT=1,
       72     6219               BUF=TERM_BUF);
       73     6258
       74     6259    1   DCL OUTBUF CHAR(800) STATIC;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:3    
       75     6260    1   DCL FMTBUF CHAR(800) STATIC;       /* Second half of outbuf for net input */
       76     6261    1   DCL OUTBUFL UBIN(36) STATIC;
       77     6262    1   DCL CHARN CHAR(OUTBUFL) BASED;
       78     6263    1   DCL BASED$UBIN UBIN BASED ALIGNED;
       79     6264    1   DCL BASED$PTR PTR BASED;
       80     6265    1   DCL CHAR31 CHAR(31) BASED;
       81     6266
       82     6267    1   DCL CMASK BIT(36) STATIC INIT('0'B);
       83     6268    1   DCL 1 CINIT REDEF CMASK,
       84     6269    1        2 * BIT(27) UNAL,
       85     6270    1        2 C CHAR(1);
       86     6271    1   DCL CBIN REDEF CMASK UBIN;
       87     6272        %FPT_WRITE (FPTN=WRITE_RECVRQS, DCB=F$XSL00, KEY=XSL_RCVRQS, STCLASS=CONSTANT);
       88     6303    1   DCL XSL_RCVRQS(0:2) UBIN(18) UNAL CONSTANT INIT(%RECVRQS, 0, 1600);
       89     6304        %FPT_READ (FPTN=READ_RECVRSP, DCB=F$XSL00, WAIT=NO, BUF=NET_BUF, KEY=HELLO3,
       90     6305                  EVENT=10, STCLASS=CONSTANT);
       91     6344        %FPT_EVENT (UENTRY=EVENT_HNDLR, STCLASS=CONSTANT);
       92     6358        %FPT_INT (UENTRY=INT_HNDLR, STCLASS=CONSTANT);
       93     6372        %FPT_WAIT (FPTN=WAIT_FOREVER, UNITS=6000, STCLASS=CONSTANT);
       94     6386        %FPT_WAIT (FPTN=WAIT_AWHILE, UNITS=10, UTYPE=TUN, STCLASS=CONSTANT);
       95     6400    1   DCL REMOTE_CR BIT(1) STATIC INIT('0'B);
       96     6401    1   DCL REMOTE_IAC BIT(1) STATIC INIT('0'B);
       97     6402    1   DCL REMOTE_OPTION BIT(1) STATIC INIT('0'B);
       98     6403
       99     6404    1   DCL 1 HELLO STATIC,
      100     6405    1        2 * CHAR(0) INIT('TELNET version '),
      101     6406    1        2 VERS CHAR(6) INIT('0.1');
      102     6407    1   DCL 1 B_VERSION SYMREF,2 L UBIN BYTE UNAL,2 T CHAR(B_VERSION.L);
      103     6408
      104     6409    1   DCL 1 HELLO2  STATIC,
      105     6410    1        2 * CHAR(0) INIT('Attempting connection to '),
      106     6411    1        2 IP CHAR(16);
      107     6412
      108     6413    1   DCL 1 HELLO3 STATIC,
      109     6414    1        2 * CHAR(0) INIT('Connected to '),
      110     6415    1        2 IPNAME CHAR(40) INIT(' ');
      111     6416
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:4    
      112     6417    1   DCL MSG_NO_LINK CHAR(0) CONSTANT INIT('Not connected - use open first.');
      113     6418
      114     6419        %FPT_ERRMSG (BUF=OUTBUF,                /* errmsg */
      115     6420               OUTDCB1=M$DO,
      116     6421               SOURCE=ALTRET,
      117     6422               INCLCODE=NO,
      118     6423               CODE=ERR_CODE);
      119     6450        %VLP_ERRCODE (FPTN=ERR_CODE, FCG=XS, MID=L);
      120     6495    1   DCL XSL_ERRNO SBIN SYMREF;
      121     6496    1   DCL M$DO DCB;
      122     6497        %INCLUDE B$JIT;
      123     6787    1   DCL B$JIT$ PTR SYMREF;
      124     6788
      125     6789    1   DCL LINK_UP BIT(36) STATIC SYMDEF INIT('0'B);
      126     6790    1   DCL MODE SBIN STATIC INIT(%TCT_OPT_CHAR);
      127     6791    1   DCL MODE_SENT SBIN STATIC INIT(0);
      128     6792    1   DCL NET_ARS SBIN STATIC SYMDEF INIT(0);
      129     6793    1   DCL TRM_ARS SBIN STATIC SYMDEF INIT(0);
      130     6794    1   DCL TRM_BRK SBIN STATIC SYMDEF INIT(0);
      131     6795    1   DCL GET_CMD BIT(36) STATIC INIT('0'B);
      132     6796    1   DCL CMD_MODE SBIN STATIC INIT(-1);
      133     6797    1   DCL WAIT_ARS SBIN STATIC INIT(0);
      134     6798    1   DCL ESC_WAIT SBIN STATIC INIT(0);
      135     6799    1   DCL ESC_CHRS CHAR(4) STATIC;
      136     6800    1   DCL READ_CMD SBIN STATIC INIT(-1);
      137     6801    1   DCL 1 READ_YC STATIC,
      138     6802    1        2 * CHAR(0) INIT('!ADJUST M$SI '),
      139     6803    1        2 FID CHAR(60) INIT('ME');
      140     6804    1   DCL TOGGLES(0:9) BIT(36) STATIC INIT('0'B*7, 'FFFFFFFFF'X, '0'B, 'FFFFFFFFF'X);
      141     6805        %EQU NC=BINASC(511);
      142     6806    1   DCL LOCAL_CHAR(0:19) CHAR(1) STATIC INIT(%NC/*Se*/, %NC/*Nop*/,%NC/*Dm*/,
      143     6807    1       %NC/*Break*/, %CP6_IP/*Ip*/, %NC/*Ao*/, %NC/*Ayt*/, %CP6_EC/*Ec*/,
      144     6808    1       %CP6_EL/*El*/, %NC*5/*Ga,sb,will,wont,do*/, BINASC(13)/*Dont aka cr*/,
      145     6809    1       %TELNET_IAC/*Iac*/, %CP6_BRK/*Esc*/, BINASC(4)/*Eof*/,%NC*0);
      146     6810        %INCLUDE XU_FORMAT_C;
      147     6972    1   DCL X$WRITE ENTRY(22);
      148     6973        %F_FDS (NAME=FDS, BUF=FMTBUF, DCB=M$LO);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:5    
      149     7086
      150     7087        %EQU XUF=CHARTEXT('3 * CHAR(0) INIT');
      151     7088    1   DCL 1 DISP_FMT CONSTANT,
      152     7089    1        2 WW,
      153     7090    1   %XUF('%.1C%N[won''t %?will %]%C'),
      154     7091    1   2 CD,
      155     7092    1   %XUF('%.2C[%.9N:=[^@%511?undef%127?^?%256?break%?%.#:3+:5/:6?['),
      156     7093    1   %XUF('^%1.#:64+KA%1?%1.#KA%?^%1.#:96+KA%]%]]%-%C'),
      157     7094    1   2 TG,
      158     7095    1   %XUF('%1Cflush output when sending interrupt characters.%/'),
      159     7096    1   %XUF('%1Csend interrupt characters in urgent mode.%000000/'),
      160     7097    1   %XUF('%1Cmap carriage return on output.%00000000000000000/'),
      161     7098    1   %XUF('%1Crecognize certain control characters.%0000000000/'),
      162     7099    1   %XUF('%1Cprovide debugging information.%00000000000000000/'),
      163     7100    1   %XUF('%1Cdisplay network traffic in hex.%0000000000000000/'),
      164     7101    1   %XUF('%1Cdisplay option negotiation.%00000000000000000000/'),
      165     7102    1   %XUF('%1Cstrip the parity bit.%00000000000000000000000000/'),
      166     7103    1   %XUF('%1Cstay in command mode.%00000000000000000000000000/'),
      167     7104    1   %XUF('%1Cdelay to send ESC character.%0000000000000000000/'),
      168     7105    1   2 TGA(0:9) REDEF TG CHAR(52),
      169     7106    1   2 CH,
      170     7107    1   %XUF('%/%000000000000001S'),
      171     7108    1   %XUF('%00000000000000001S'),
      172     7109    1   %XUF('%00000000000000001S'),
      173     7110    1   %XUF('%2Cbreak.%00000000/'),
      174     7111    1   %XUF('%2Cinterrupt.%0000/'),
      175     7112    1   %XUF('%2Cabort output.%0/'),
      176     7113    1   %XUF('%2Care you there.%/'),
      177     7114    1   %XUF('%2Cerase.%00000000/'),
      178     7115    1   %XUF('%2Ckill.%000000000/'),
      179     7116    1   %XUF('%00000000000000001S'),
      180     7117    1   %XUF('%00000000000000001S'),
      181     7118    1   %XUF('%00000000000000001S'),
      182     7119    1   %XUF('%00000000000000001S'),
      183     7120    1   %XUF('%00000000000000001S'),
      184     7121    1   %XUF('%00000000000000001S'),
      185     7122    1   %XUF('%00000000000000001S'),
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:6    
      186     7123    1   %XUF('%2Cescape.%0000000/'),
      187     7124    1   %XUF('%2Ceof.%0000000001Q'),
      188     7125    1   2 CHA(0:17) REDEF CH CHAR(19);
      189     7126
      190     7127    1   DCL 1 FMT_1CH STATIC,
      191     7128    1        2 * CHAR(0) INIT('[%.9N:=[^@%511?undef%127?^?%256?break%?%.#:3+:5/:6?['),
      192     7129    1        2 * CHAR(0) INIT('^%1.#:64+KA%1?%1.#KA%?^%1.#:96+KA%]%]]%-'),
      193     7130    1        2 CH CHAR(15),2 * CHAR(1) INIT('Q');
      194     7131
      195     7132    1   DCL 1 FMT_1TG STATIC,
      196     7133    1        2 * CHAR(0) INIT('%N[won''t %?will %]'),
      197     7134    1        2 TG CHAR(48),2 * CHAR(1) INIT('Q');
      198     7135
      199     7136    1   DCL 1 STATUS_FMT CONSTANT,2 T,
      200     7137    1   %XUF('%.1C[%.9N:=[^@%511?undef%127?^?%256?break%?%.#:3+:5/:6?['),
      201     7138    1   %XUF('^%1.#:64+KA%1?%1.#KA%?^%1.#:96+KA%]%]]%C'),
      202     7139    1   %XUF('%.N[Not connected%S%?Connected to %>A%].%/'),
      203     7140    1   %XUF('Operating in %.N[character%?line%] mode.%/'),
      204     7141    1   %XUF('Escape character is %1C.');
      205     7142
      206     7143    1   DCL 1 NETIN_FMT CONSTANT,2 T,
      207     7144    1   %XUF('%V@ <- %1(%2@.8ZH %Q%1)');
      208     7145    1   DCL 1 NETOUT_FMT CONSTANT,2 T,
      209     7146    1   %XUF('%V@ -> %1(%2@.8ZH %Q%1)');
      210     7147
      211     7148    1   DCL SEARCH_TBL(0:259) CHAR(1);
      212     7149    1   DCL 1 XLATE_TBL STATIC,
      213     7150    1        2 LOW,
      214     7151    1         3 CTL(0:31) UBIN(9) CALIGNED INIT(0,1,2,3,4,5,6,7,8,9,10,11,12,
      215     7152    1       13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31),
      216     7153    1         3 ASCII(0:4) CHAR(19) INIT(' !"#$%&''()*+,-./012','3456789:;<=>?@ABCDE',
      217     7154    1       'FGHIJKLMNOPQRSTUVWX','YZ[\]^_`abcdefghijk','lmnopqrstuvwxyz{|}~'),
      218     7155    1         3 DEL UBIN BYTE CALIGNED INIT(127),
      219     7156    1        2 HIGH(0:127) CHAR(1);
      220     7157    1   DCL XLATE_TBL_HIGH(0:31) CONSTANT BIT(36) INIT(
      221     7158    1    '000001002003'O,'004005006007'O,'010011012013'O,'014015016017'O,
      222     7159    1    '020021022023'O,'024025026027'O,'030031032033'O,'034035036037'O,
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:7    
      223     7160    1    '040041042043'O,'044045046047'O,'050051052053'O,'054055056057'O,
      224     7161    1    '060061062063'O,'064065066067'O,'070071072073'O,'074075076077'O,
      225     7162    1    '100101102103'O,'104105106107'O,'110111112113'O,'114115116117'O,
      226     7163    1    '120121122123'O,'124125126127'O,'130131132133'O,'134135136137'O,
      227     7164    1    '140141142143'O,'144145146147'O,'150151152153'O,'154155156157'O,
      228     7165    1    '160161162163'O,'164165166167'O,'170171172173'O,'174175176177'O);
      229     7166
      230     7167    1      CALL M$INT (FPT_INT);
      231     7168    1      CALL M$EVENT (FPT_EVENT);
      232     7169    1      CALL XSL$SOCKINIT( TCT_SOCKINIT);
      233     7170    1      CALL XUG$INIT (XUG_GETCMD, XUG_INIT);
      234     7171    1      HELLO.VERS = B_VERSION.T;
      235     7172    1      WRITE_LO.BUF_ = VECTOR(HELLO);
      236     7173    1      CALL M$WRITE (WRITE_LO);
      237     7174    1      M$LO$ = DCBADDR(DCBNUM(M$LO));
      238     7175    1      IF NOT B$JIT.PRFLAGS.OU AND NOT B$JIT.PRFLAGS.LS
      239     7176    1      THEN XUG_GETCMD.TEXT_ = VECTOR(SUBSTR(B$JIT.CCBUF,0,B$JIT.CCARS));
      240     7177    1      ELSE CMD_MODE = 0;
      241     7178
      242     7179    2   NXTCMD: DO UNTIL (LINK_UP) ;
      243     7180    3          CALL XUG$GETCMD (XUG_GETCMD) WHENALTRETURN DO;
      244     7181    3              READ_YC.FID = 'ME';
      245     7182    4              IF READ_CMD<0 THEN DO;
      246     7183    4                  IF XUG_GETCMD.TEXT_~=VECTOR(NIL) THEN CALL M$EXIT;
      247     7184    4                  CMD_MODE = 1;
      248     7185    4                  END;
      249     7186    3              ELSE IF READ_CMD=0 THEN EXIT;
      250     7187    4                  ELSE DO;
      251     7188    4                      XUG_GETCMD.TEXT_ = VECTOR(READ_YC);
      252     7189    4                      READ_CMD = 0;
      253     7190    4                      END;
      254     7191    3              GOTO MONERR;
      255     7192    3              END;
      256     7193    2          XUG_GETCMD.TEXT_ = VECTOR(NIL);
      257     7194    3          IF READ_CMD = 0 THEN DO;
      258     7195    3              IF READ_YC.FID = 'ME' THEN READ_CMD = -1;
      259     7196    3              ELSE READ_CMD = READ_CMD + 1;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:8    
      260     7197    3              GOTO NXTCMD;
      261     7198    3              END;
      262     7199    2          READ_YC.FID = 'ME';
      263     7200
      264     7201    2          P$ = XUG_GETCMD.OUT$->OUT$BLK.SUBLK$(0);
      265     7202    3          DO CASE (OUT$BLK.CODE);
      266     7203    3           CASE (%TCT_CMD_CLOSE);
      267     7204    3              CALL XSL$CLOSE (I, LCN);
      268     7205    3              NET_ARS = 0;
      269     7206    3              TRM_ARS = 0;
      270     7207    3              LINK_UP = '0'B;
      271     7208
      272     7209    3           CASE (%TCT_CMD_DISPLAY);
      273     7210    3              IF OUT$BLK.NSUBLKS=0
      274     7211    3              THEN CALL X$WRITE (FDS, VECTOR(DISP_FMT), VECTOR(TOGGLES),
      275     7212    3                        VECTOR(LOCAL_CHAR));
      276     7213    4              ELSE DO I=0 TO OUT$BLK.NSUBLKS-1;
      277     7214    4                  OUTBUFL = OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;
      278     7215    5                  IF OUTBUFL<240 THEN DO;
      279     7216    5                      FMT_1TG.TG = SUBSTR (DISP_FMT.TGA (OUTBUFL), 3);
      280     7217    5                      CALL X$WRITE (FDS, VECTOR(FMT_1TG),
      281     7218    5                            VECTOR(TOGGLES (OUTBUFL)));
      282     7219    5                      END;
      283     7220    5                  ELSE DO;
      284     7221    5                      FMT_1CH.CH = SUBSTR (DISP_FMT.CHA (OUTBUFL-240), 3);
      285     7222    5                      CALL X$WRITE (FDS, VECTOR(FMT_1CH),
      286     7223    5                            VECTOR(LOCAL_CHAR (OUTBUFL-240)));
      287     7224    5                      END;
      288     7225    4                  END;
      289     7226
      290     7227    3           CASE (%TCT_CMD_MODE);
      291     7228    3              IF MODE = OUT$BLK.SUBLK$(0)->OUT$BLK.CODE THEN EXIT;
      292     7229    3              MODE = OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      293     7230    3              IF LINK_UP THEN GOTO SET_MODE;
      294     7231
      295     7232    3           CASE (%TCT_CMD_OPEN);
      296     7233
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:9    
      297     7234    3              IF CMD_MODE<0 THEN CMD_MODE = 1; /* Quick exit mode */
      298     7235    3              IF OUT$BLK.NSUBLKS = 2
      299     7236    3              THEN CALL CHARBIN(FS.S_PORT,OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
      300     7237    3              ELSE FS.S_PORT = %TCT_WKS_TELNET;
      301     7238    3              CALL XSL$HTONL( FS.S_PORT, FS.S_PORT);
      302     7239    3              HELLO3.IPNAME = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      303     7240    4              CALL XSL$INET_ADDR(FS.S_ADDR, HELLO3.IPNAME) WHENALTRETURN DO;
      304     7241    4                  CALL XSL$GETHOSTBYNAME (P$,HELLO3.IPNAME) ALTRET (RETALT);
      305     7242    4                  FS.S_ADDR = P$->XSL$HOSTENT.H_ADDR_LIST$->BASED$PTR->BASED$UBIN;
      306     7243    4                  END;
      307     7244
      308     7245    3              CALL XSL$INET_NTOA (P$,FS.S_ADDR);
      309     7246    3              CALL INDEX (OUTBUFL, BINASC(0), P$->CHAR31);
      310     7247    3              HELLO2.IP = SUBSTR(P$->CHAR31,0,OUTBUFL);
      311     7248
      312     7249    3              WRITE_LO.BUF_ = VECTOR(HELLO2);
      313     7250    3              CALL M$WRITE (WRITE_LO);
      314     7251
      315     7252    3              LS = '0'B;
      316     7253    3              FS.SA_FAMILY = %XSL_AF_INET;
      317     7254    3              CALL XSL$SOCKET (LCN, %XSL_AF_INET, %XSL_SOCK_STREAM, %XSL_PF_INET)
      318     7255    3                    ALTRET (RETALT);
      319     7256    3              CALL XSL$CONNECT (I, LCN, FS, 8)
      320     7257    4              WHENALTRETURN DO;
      321     7258    4   RETALT:        ;
      322     7259    4                  ERR_CODE.ERR# = XSL_ERRNO;
      323     7260    4                  IF XSL_ERRNO>0 THEN FPT_ERRMSG.V.SOURCE# = 0;
      324     7261    4   MONERR:        ;
      325     7262    4                  CALL M$ERRMSG (FPT_ERRMSG);
      326     7263    4                  FPT_ERRMSG.V.SOURCE# = 2;
      327     7264    4                  IF CMD_MODE=0 THEN GOTO NXTCMD;
      328     7265    4                  CALL M$EXIT;
      329     7266    4                  END;
      330     7267
      331     7268    3              LINK_UP = '1'B;
      332     7269    3              WRITE_LO.BUF_ = VECTOR(HELLO3);
      333     7270    3              CALL M$WRITE (WRITE_LO);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:10   
      334     7271    3              IF MODE = %TCT_OPT_CHAR THEN EXIT;
      335     7272    3   SET_MODE:  ;
      336     7273    3              SUBSTR(OUTBUF,0,6) = %CONCAT(TELNET_IAC,TELNET_DO,BINASC(3)/*Sga*/,
      337     7274    3                    TELNET_IAC,TELNET_DO,BINASC(1)/*Echo*/);
      338     7275    4              IF MODE = %TCT_OPT_LINE THEN DO;
      339     7276    4                  SUBSTR(OUTBUF,1,1) = %TELNET_DONT;
      340     7277    4                  SUBSTR(OUTBUF,4,1) = %TELNET_DONT;
      341     7278    4                  END;
      342     7279    3              CALL XSL$WRITE (I, LCN, OUTBUF, 6);
      343     7280    3              IF TOGGLES(%TCT_OPT_ND)
      344     7281    3              THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),
      345     7282    3                        VECTOR(SUBSTR(OUTBUF,0,6)));
      346     7283    3              MODE_SENT = 4;
      347     7284
      348     7285    3           CASE (%TCT_CMD_READ);
      349     7286    3              READ_YC.FID = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      350     7287    3              READ_CMD = 0;
      351     7288    3              XUG_GETCMD.TEXT_ = VECTOR(READ_YC);
      352     7289
      353     7290    3           CASE (%TCT_CMD_SEND);
      354     7291    4              IF NOT LINK_UP THEN DO;
      355     7292    4                  WRITE_LO.BUF_ = VECTOR (MSG_NO_LINK);
      356     7293    4                  CALL M$WRITE (WRITE_LO);
      357     7294    4                  GOTO NXTCMD;
      358     7295    4                  END;
      359     7296    3              SUBSTR (OUTBUF,1,1) = BINASC (OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);
      360     7297    4              IF SUBSTR (OUTBUF,1,1) = %BINASC(TCT_OPT_ESC) THEN DO;
      361     7298    4                  OUTBUFL = 1;
      362     7299    4                  SUBSTR (OUTBUF,0,1) = LOCAL_CHAR(%TCT_OPT_ESC);
      363     7300    4                  END;
      364     7301    4              ELSE IF SUBSTR (OUTBUF,1,1) = BINASC(0) THEN DO; /* Send string */
      365     7302    4                      OUTBUFL = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
      366     7303    4                      ADDR(OUTBUF)->CHARN = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      367     7304    4                      IF OUT$BLK.NSUBLKS=1 THEN EXIT; /* all done if only a string */
      368     7305    5                      IF OUT$BLK.NSUBLKS~=3 THEN DO; /* 2 or 4 means cr option */
      369     7306    5                          SUBSTR (OUTBUF,OUTBUFL,1) = %BINASC(13);
      370     7307    5                          OUTBUFL = OUTBUFL+1;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:11   
      371     7308    5                          OUT$BLK.SUBLK$(2) = OUT$BLK.SUBLK$(3);
      372     7309    5                          END;
      373     7310    4                      IF OUT$BLK.NSUBLKS=2 THEN EXIT; /* all done if string+cr */
      374     7311    4                      WAIT_ARS = OUTBUFL+1; /* Send it after string2 arrives */
      375     7312    4                      ADDR(TERM_BUF)->CHARN = ADDR(OUTBUF)->CHARN;
      376     7313    4                      EXIT NXTCMD;
      377     7314    4                      END;
      378     7315    4                  ELSE DO;
      379     7316    4                      OUTBUFL = 2;
      380     7317    4                      SUBSTR (OUTBUF,0,1) = %TELNET_IAC;
      381     7318    4                      END;
      382     7319    3              CALL XSL$WRITE (I, LCN, OUTBUF, OUTBUFL);
      383     7320    3              IF TOGGLES(%TCT_OPT_ND)
      384     7321    3              THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),
      385     7322    3                        VECTOR(SUBSTR(OUTBUF,0,OUTBUFL)));
      386     7323
      387     7324    3           CASE (%TCT_CMD_SET);
      388     7325    3              IF OUT$BLK.NSUBLKS < 2 THEN CMASK = %ASCBIT(CP6_BRK);
      389     7326    3              ELSE IF OUT$BLK.NSUBLKS = 2
      390     7327    3                  THEN CINIT.C = SUBSTR(OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT,0,1);
      391     7328    4                  ELSE DO;
      392     7329    4                      CINIT.C = SUBSTR(OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT,0,1);
      393     7330    4                      IF CINIT.C = '?' THEN CBIN = 127;
      394     7331    4                      ELSE CBIN = MOD (CBIN, 32);
      395     7332    4                      END;
      396     7333    3              LOCAL_CHAR (OUT$BLK.SUBLK$(0)->OUT$BLK.CODE-240) = CINIT.C;
      397     7334
      398     7335    3           CASE (%TCT_CMD_STATUS);
      399     7336    3              CALL X$WRITE (FDS, VECTOR(STATUS_FMT), VECTOR(LINK_UP),
      400     7337    3                    VECTOR(HELLO3.IPNAME), VECTOR(MODE),
      401     7338    3                    VECTOR(LOCAL_CHAR(%TCT_OPT_ESC-240)));
      402     7339
      403     7340    3           CASE (%TCT_CMD_TOGGLE);
      404     7341    4              DO I=0 TO OUT$BLK.NSUBLKS-1;
      405     7342    4                  OUTBUFL = OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;
      406     7343    4                  TOGGLES (OUTBUFL) = ~TOGGLES (OUTBUFL);
      407     7344    4                  FMT_1TG.TG = SUBSTR (DISP_FMT.TGA (OUTBUFL), 3);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:12   
      408     7345    4                  IF OUTBUFL~=%TCT_OPT_CO OR TOGGLES (OUTBUFL)
      409     7346    4                  THEN CALL X$WRITE
      410     7347    4                            (FDS, VECTOR(FMT_1TG), VECTOR(TOGGLES (OUTBUFL)));
      411     7348    4                  END;
      412     7349
      413     7350    3           CASE (ELSE);
      414     7351    3              IF CMD_MODE<0 THEN CMD_MODE = 0;
      415     7352    3              END;
      416     7353    2          END;
      417     7354
      418     7355    1      SEARCH_TBL = '0'B;
      419     7356    2      DO I=0 TO %TCT_OPT_ESC-240;          /* forget eof, its just an actchr */
      420     7357    2          IF I=0 AND NOT TOGGLES(%TCT_OPT_LC)
      421     7358    2          THEN I=%ASCBIN(TELNET_DO)-240;   /* skip to cr, or thereabouts */
      422     7359    2          IF LOCAL_CHAR(I)~=%NC
      423     7360    2          THEN SEARCH_TBL (ASCBIN (LOCAL_CHAR(I) ) ) = BINASC (I);
      424     7361    2          END;
      425     7362
      426     7363    1      IF TOGGLES(%TCT_OPT_ST) THEN XLATE_TBL.HIGH = XLATE_TBL.LOW;
      427     7364    1      ELSE XLATE_TBL.HIGH = XLATE_TBL_HIGH;
      428     7365
      429     7366    1      ACTCHRS = '0'B;
      430     7367    1      EOMTERMINAL.V.TIMEOUT# = 1;
      431     7368    1      READ_TERM.V.DVBYTE.TRANS# = '1'B;
      432     7369    1      FPT_WRITE.V.DVBYTE.TRANS# = '1'B;
      433     7370    2      IF MODE=%TCT_OPT_LINE THEN DO;
      434     7371    2          ACTCHRS(1) = 4;                  /* Cr */
      435     7372    2          I = ASCBIN(LOCAL_CHAR(%TCT_OPT_EOF-240));
      436     7373    2          ACTCHRS(I/8) = ACTCHRS(I/8) + BITS8TO0(MOD(I,8));
      437     7374    2          EOMTERMINAL.V.TIMEOUT# = 0;
      438     7375    2          READ_TERM.V.DVBYTE.TRANS# = '0'B;
      439     7376    2          FPT_WRITE.V.DVBYTE.TRANS# = '0'B;
      440     7377    2          CALL M$PROMPT (NO_PROMPT);
      441     7378    2          END;
      442     7379
      443     7380    2      IF WAIT_ARS=0 THEN DO;
      444     7381    2          IF TOGGLES(%TCT_OPT_CO) THEN GOTO NXTCMD;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:13   
      445     7382    2          CALL M$EOM (EOMTERMINAL);
      446     7383    2          CALL M$READ (READ_TERM);
      447     7384    2          END;
      448     7385    1      CALL M$WRITE (WRITE_RECVRQS);
      449     7386    1      CALL M$READ (READ_RECVRSP);
      450     7387    1      GET_CMD = '0'B;
      451     7388
      452     7389    2      DO INHIBIT;
      453     7390    3          DO WHILE(LINK_UP AND NOT GET_CMD);
      454     7391    3              IF ESC_WAIT=0 THEN CALL M$WAIT (WAIT_FOREVER);
      455     7392    4              ELSE CALL M$WAIT (WAIT_AWHILE) WHENRETURN DO;
      456     7393    4                      CALL LOCAL_INPUT;
      457     7394    4                      END;
      458     7395    4              DO WHILE TRM_BRK+NET_ARS+TRM_ARS ~= 0;
      459     7396    4                  IF TRM_BRK ~= 0 THEN CALL BREAK_INPUT;
      460     7397    4                  IF NET_ARS ~= 0 THEN CALL REMOTE_INPUT;
      461     7398    4                  IF TRM_ARS ~= 0 THEN CALL LOCAL_INPUT;
      462     7399    4                  END;
      463     7400    3              END;
      464     7401    2          END;
      465     7402
      466     7403    1      CALL M$TRMPRG (STOPTERMREAD);
      467     7404    1      CALL M$TRMPRG (STOPNETREAD);
      468     7405    2      DO WHILE '1'B;
      469     7406    2          IF DCBADDR(DCBNUM(M$UC))->F$DCB.FCN.CNT(0) = 0
      470     7407    2                AND DCBADDR(DCBNUM(F$XSL00))->F$DCB.FCN.CNT(0) = 0 THEN EXIT;
      471     7408    2          CALL M$WAIT (WAIT_FOREVER);
      472     7409    2          END;
      473     7410    1      CALL M$EOM (EOMNORMAL);
      474     7411    1      CALL M$PROMPT (TELNET_PROMPT);
      475     7412    1      IF LINK_UP THEN GOTO NXTCMD;
      476     7413    1      CALL XSL$CLOSE (I, LCN);
      477     7414    1      XSL_ERRNO = %E$CONNRESET;
      478     7415    1      GOTO RETALT;
      479     7416        %EJECT;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:14   
      480     7417    1   LOCAL_INPUT: PROC;
      481     7418        %FPT_TRMPRG (FPTN=RESET_BREAK, STCLASS=CONSTANT, RESETBREAK=YES);
      482     7447    2   DCL J SBIN;
      483     7448
      484     7449    2      OUTBUFL = ESC_WAIT;
      485     7450    2      SUBSTR (OUTBUF,0,4) = ESC_CHRS;
      486     7451    2      CALL XLATE (SUBSTR(TERM_BUF,0,TRM_ARS), XLATE_TBL, TERM_BUF);
      487     7452    2      I = 0;
      488     7453    3      DO UNTIL I>=TRM_ARS;
      489     7454    3          CALL SEARCH (J, CBIN, SEARCH_TBL, SUBSTR(TERM_BUF,0,TRM_ARS), I);
      490     7455    4          IF J>I THEN DO;
      491     7456    4              J = J-I;
      492     7457    4              SUBSTR(OUTBUF,OUTBUFL,J) = SUBSTR(TERM_BUF,I,J);
      493     7458    4              I = I+J;
      494     7459    4              OUTBUFL = OUTBUFL+J;
      495     7460    4              END;
      496     7461    3          IF I>=TRM_ARS THEN EXIT;
      497     7462    3   TEST_CHAR: ;
      498     7463    4          DO CASE (CBIN+240);
      499     7464    4           CASE(%ASCBIN(TELNET_AO));
      500     7465    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_AO));
      501     7466    4              GOTO INC_INO;
      502     7467    4           CASE(%ASCBIN(TELNET_AYT));
      503     7468    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_AYT));
      504     7469    4              GOTO INC_INO;
      505     7470    4           CASE(%ASCBIN(TELNET_IP));
      506     7471    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_IP));
      507     7472    4              GOTO INC_INO;
      508     7473    4           CASE(%ASCBIN(TELNET_EC));
      509     7474    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_EC));
      510     7475    4              GOTO INC_INO;
      511     7476    4           CASE(%ASCBIN(TELNET_BREAK));
      512     7477    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_BREAK));
      513     7478    4              GOTO INC_INO;
      514     7479    4           CASE(%ASCBIN(TELNET_EL));
      515     7480    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_EL));
      516     7481    4              GOTO INC_INO;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:15   
      517     7482    4           CASE(%ASCBIN(TELNET_IAC));
      518     7483    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_IAC));
      519     7484    4              GOTO INC_INO;
      520     7485    4           CASE(%ASCBIN(TELNET_DONT));     /* really a cr */
      521     7486    4              IF MODE = %TCT_OPT_CHAR
      522     7487    4              THEN SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(CP6_CR,BINASC(0)));
      523     7488    5              ELSE DO;
      524     7489    5                  SUBSTR(OUTBUF,OUTBUFL,1) = %CP6_LF;
      525     7490    5                  OUTBUFL = OUTBUFL-1;
      526     7491    5                  END;
      527     7492    4   INC_INO:   OUTBUFL = OUTBUFL+2;
      528     7493    4              I = I+1;
      529     7494    4           CASE(%TCT_OPT_ESC);
      530     7495    4              GET_CMD = '1'B;
      531     7496    5              IF READ_CMD>0 THEN DO;
      532     7497    5                  XUG_GETCMD.TEXT_ = VECTOR(READ_YC);
      533     7498    5                  READ_CMD = 0;
      534     7499    5                  END;
      535     7500    4              WAIT_ARS = 0;
      536     7501    4              I = I+1;
      537     7502    4           CASE(ELSE);
      538     7503    4              END;
      539     7504    3          END;
      540     7505
      541     7506    3      IF LINK_UP THEN DO;
      542     7507    3          ESC_WAIT = 0;
      543     7508    4          IF TRM_ARS>0 AND TOGGLES(%TCT_OPT_ED) THEN DO TRM_ARS=1 TO 4;
      544     7509    4              IF TRM_ARS>OUTBUFL THEN EXIT;
      545     7510    5              IF SUBSTR (OUTBUF,OUTBUFL-TRM_ARS,1) = BINASC(27) THEN DO;
      546     7511    5                  ESC_CHRS = SUBSTR (OUTBUF,OUTBUFL-TRM_ARS,4);
      547     7512    5                  ESC_WAIT = TRM_ARS;
      548     7513    5                  OUTBUFL = OUTBUFL-TRM_ARS;
      549     7514    5                  TRM_ARS = 4;
      550     7515    5                  END;
      551     7516    4              END;
      552     7517    4          IF OUTBUFL > 0 THEN DO;
      553     7518    4              CALL XSL$WRITE (J, LCN, OUTBUF, OUTBUFL);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:16   
      554     7519    4              IF TOGGLES(%TCT_OPT_ND)
      555     7520    4              THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),
      556     7521    4                        VECTOR(SUBSTR(OUTBUF,0,OUTBUFL)));
      557     7522    4              END;
      558     7523
      559     7524    3          IF I>SIZEC(TERM_BUF) THEN RETURN;
      560     7525    3          TRM_ARS = 0;
      561     7526    3          IF NOT TOGGLES(%TCT_OPT_CO) THEN CALL M$READ (READ_TERM);
      562     7527    3          END;
      563     7528    2      ELSE TRM_ARS = 0;
      564     7529    2      RETURN;
      565     7530
      566     7531    2   BREAK_INPUT: ENTRY;
      567     7532    2      CALL M$TRMPRG (RESET_BREAK);
      568     7533    2      TRM_BRK = 0;
      569     7534    2      IF SEARCH_TBL(%ASCBIN(CP6_BRK))=%NC THEN RETURN;
      570     7535    2      I = SIZEC(TERM_BUF);
      571     7536    2      OUTBUFL = 0;
      572     7537    2      CINIT.C = SEARCH_TBL(%ASCBIN(CP6_BRK));
      573     7538    2      GOTO TEST_CHAR;
      574     7539
      575     7540    2   END LOCAL_INPUT;
      576     7541        %EJECT;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:17   
      577     7542    1   REMOTE_INPUT: PROC;
      578     7543
      579     7544    2   DCL 1 OPTION_REPLY STATIC,
      580     7545    2        2 IAC CHAR(1) INIT(%TELNET_IAC),
      581     7546    2        2 DODONTWONT CHAR(1) INIT(%TELNET_WONT),
      582     7547    2        2 DDW REDEF DODONTWONT UBIN BYTE UNAL,
      583     7548    2        2 OPT CHAR(1),
      584     7549    2        2 OPTN REDEF OPT UBIN BYTE UNAL;
      585     7550    2   DCL SAV_ARS STATIC SBIN INIT(1);
      586     7551    2   DCL SAV_BUF STATIC CHAR(132) INIT('@');
      587     7552
      588     7553                                                /* Scan for iac */
      589     7554    2      OUTBUFL = SAV_ARS;
      590     7555    2      SUBSTR(OUTBUF,0,SAV_ARS) = SAV_BUF;  /* Set the vfc character */
      591     7556    2      IF WAIT_ARS>0 THEN CALL INDEX (I, OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT,
      592     7557    3                SUBSTR (NET_BUF,0,NET_ARS)) WHENRETURN DO;
      593     7558    3              TRM_ARS = WAIT_ARS-1;
      594     7559    3              WAIT_ARS = 0;
      595     7560    3              GET_CMD = '1'B;
      596     7561    3              END;
      597     7562    2      IF TOGGLES(%TCT_OPT_ND)
      598     7563    2      THEN CALL X$WRITE(FDS, VECTOR(NETIN_FMT), VECTOR(SUBSTR(NET_BUF,0,NET_ARS)));
      599     7564
      600     7565    3      DO I=0 TO NET_ARS-1;
      601     7566    3          IF REMOTE_IAC
      602     7567    4          THEN DO;
      603     7568    4              REMOTE_IAC = '0'B;
      604     7569    5              DO SELECT (SUBSTR(NET_BUF,I,1));
      605     7570    5                  SELECT (%TELNET_IAC);
      606     7571    5                  SUBSTR(OUTBUF,OUTBUFL,1) = %TELNET_IAC;
      607     7572    5                  OUTBUFL = OUTBUFL+1;
      608     7573
      609     7574    5                  SELECT (%TELNET_WILL, %TELNET_WONT);
      610     7575    5                  REMOTE_OPTION = '1'B;
      611     7576    5                  OPTION_REPLY.DODONTWONT = BINASC(ASCBIN(SUBSTR(NET_BUF,I,1))+2);
      612     7577
      613     7578    5                  SELECT (%TELNET_DO, %TELNET_DONT);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:18   
      614     7579    5                  REMOTE_OPTION='1'B;
      615     7580    5                  OPTION_REPLY.DODONTWONT = %TELNET_WONT;
      616     7581
      617     7582    5                  SELECT (ELSE);
      618     7583                                                /* Ignore all commands */
      619     7584    5                  END;
      620     7585    4              END;
      621     7586
      622     7587    3          ELSE IF REMOTE_OPTION
      623     7588    4              THEN DO;
      624     7589    4                  REMOTE_OPTION = '0'B;
      625     7590    4                  OPTION_REPLY.OPT = SUBSTR(NET_BUF,I,1);
      626     7591    4                  IF (OPTION_REPLY.OPTN = 1 OR OPTION_REPLY.OPTN = 3)
      627     7592    4                        AND (MODE_SENT = 4 OR MODE_SENT = OPTION_REPLY.OPTN)
      628     7593    5                        AND OPTION_REPLY.DODONTWONT ~= %TELNET_WONT THEN DO;
      629     7594    5                      MODE_SENT = MODE_SENT - OPTION_REPLY.OPTN;
      630     7595    5                      IF OPTION_REPLY.DDW-ASCBIN(%TELNET_DO) = MODE-%TCT_OPT_CHAR
      631     7596    5                      THEN GOTO NXT_BYTE;  /* Agreement, no response needed */
      632     7597    5                      OPTION_REPLY.DDW = ASCBIN(%TELNET_DO)+MODE-%TCT_OPT_CHAR;
      633     7598    5                      END;
      634     7599
      635     7600    4                  CALL XSL$WRITE(FPT_WRITE.BUF_,LCN,OPTION_REPLY,3);
      636     7601    4                  IF TOGGLES(%TCT_OPT_ND)
      637     7602    4                  THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),
      638     7603    4                            VECTOR(OPTION_REPLY));
      639     7604    4                  END;
      640     7605
      641     7606    4              ELSE IF REMOTE_CR THEN DO;
      642     7607    4                      REMOTE_CR = '0'B;
      643     7608    4                      IF SUBSTR(NET_BUF,I,1) = %CP6_LF
      644     7609    5                            AND NOT M$LO$->F$DCB.DDEV.UCOUT# THEN DO;
      645     7610    5                          OUTBUFL = OUTBUFL-1;
      646     7611    5                          GOTO LINE_OUT;
      647     7612    5                          END;
      648     7613    4                      IF SUBSTR(NET_BUF,I,1) ~= BINASC(0) THEN GOTO COPY_CHR;
      649     7614    4                      END;
      650     7615    4                  ELSE DO SELECT (SUBSTR(NET_BUF,I,1));
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:19   
      651     7616
      652     7617    4                      SELECT (%TELNET_IAC);
      653     7618    4                      REMOTE_IAC = '1'B;
      654     7619    4                      SELECT (%CP6_CR);
      655     7620    4                      REMOTE_CR = '1'B;
      656     7621    4                      GOTO COPY_CHR;
      657     7622    4                      SELECT (%CP6_LF);
      658     7623    5                      IF NOT M$LO$->F$DCB.DDEV.UCOUT# THEN DO;
      659     7624    5   LINE_OUT:              SUBSTR(OUTBUF,0,1)='A';
      660     7625    5                          FPT_WRITE.BUF_ = VECTOR(ADDR(OUTBUF)->CHARN);
      661     7626    5                          CALL M$WRITE (FPT_WRITE);
      662     7627    5                          OUTBUFL = 1;
      663     7628    5                          SAV_ARS = 1;
      664     7629    5                          GOTO NXT_BYTE;
      665     7630    5                          END;
      666     7631    5                      IF MODE= %TCT_OPT_LINE THEN DO;
      667     7632    5                          SUBSTR(OUTBUF,OUTBUFL,1) = %CP6_CR;
      668     7633    5                          OUTBUFL = OUTBUFL+1;
      669     7634    5                          END;
      670     7635    4                      GOTO COPY_CHR;
      671     7636    4                      SELECT (ELSE);
      672     7637    4   COPY_CHR:      ;
      673     7638    4                  SUBSTR(OUTBUF,OUTBUFL,1) = SUBSTR(NET_BUF,I,1);
      674     7639    4                  OUTBUFL = OUTBUFL+1;
      675     7640    4                      END;
      676     7641
      677     7642    3   NXT_BYTE: ;
      678     7643    3          END;                             /* Do to EVT.ARS */
      679     7644
      680     7645    2      NET_ARS = 0;
      681     7646    2      CALL M$WRITE (WRITE_RECVRQS);
      682     7647    2      CALL M$READ (READ_RECVRSP);
      683     7648
      684     7649    2      FPT_WRITE.BUF_=VECTOR(ADDR(OUTBUF)->CHARN);
      685     7650    3      IF OUTBUFL > 1 THEN DO;
      686     7651    3          SAV_ARS = 1;
      687     7652    4          IF NOT M$LO$->F$DCB.DDEV.UCOUT# THEN DO;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:20   
      688     7653    4              SAV_BUF = SUBSTR (OUTBUF,0,OUTBUFL);
      689     7654    4              SUBSTR (SAV_BUF,0,1) = '@';
      690     7655    4              SAV_ARS = MINIMUM (OUTBUFL, SIZEC(SAV_BUF));
      691     7656    4              END;
      692     7657    3          ELSE CALL M$WRITE (FPT_WRITE);
      693     7658    3          END;
      694     7659    2      RETURN;
      695     7660
      696     7661    2   END REMOTE_INPUT;
      697     7662
      698     7663    1   END TELNET;
      699     7664        %EOD;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:21   
--  Include file information  --

   XU_FORMAT_C.:LIBRARY  is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   TCT_TELNET_E.:TCA2TOU  is referenced.
   XSL_INTERNAL_M.:TCA2TOU  is referenced.
   XSL_SOCKET_M.:TCA2TOU  is referenced.
   XSL_SOCKET_E.:TCA2TOU  is referenced.
   XSL_SOCKMSGS_E.:TCA2TOU  is referenced.
   XSL_PERR_C.:TCA2TOU  is referenced.
   XUG_ENTRY.:LIBRARY  cannot be made into a system file and is referenced.
   XU_MACRO_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TELNET.

   Procedure TELNET requires 1212 words for executable code.
   Procedure TELNET requires 80 words of local(AUTO) storage.

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:22   

 Object Unit name= TELNET                                     File name= TCT$TELNET.:TCA2TOU
 UTS= NOV 16 '97 14:23:33.52 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none  1292   2414  TELNET
    2  RoData even  UTS    489    751  TELNET
    3   DCB   even  none    98    142  M$LO
    4   DCB   even  none     0      0  F$XSL00
    5   DCB   even  none     0      0  M$DO
    6   Proc  even  none  1212   2274  TELNET
    7  RoData even  none   107    153  TELNET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Main       0  TELNET

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      2  TCT_SOCKINIT                       1    130  LCN
    1   1024  TERM_BUF                           1   1124  READ_TERM
    1   2061  LINK_UP                            1   2064  NET_ARS
    1   2065  TRM_ARS                            1   2066  TRM_BRK
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:23   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 X$PRE_PROCESS
         yes          Async      0 INT_HNDLR
 yes     yes           Std       2 XSL$INET_NTOA
 yes     yes           Std       2 XTX$ADAPT
         yes          Async      0 EVENT_HNDLR
 yes     yes           Std       4 XSL$CONNECT
 yes     yes           Std       1 XSL$SOCKINIT
 yes     yes           Std       2 XUG$INIT
 yes     yes           Std       1 XUG$GETCMD
         yes           Std      22 X$WRITE
         yes           Std       2 XSL$HTONL
 yes     yes           Std       2 XSL$INET_ADDR
 yes     yes           Std       4 XSL$SOCKET
 yes     yes           Std       4 XSL$WRITE
 yes     yes           Std       2 XSL$CLOSE
 yes     yes           Std       2 XSL$GETHOSTBYNAME
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_INDEX

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TELNET_CMD                            M$LO
     F$XSL00                               B_VERSION                             XSL_ERRNO
     M$DO                                  B$JIT$                                B_VECTNIL
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:24   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:25   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* NTB,MCR=NO,PLM=3,CTI=6,IND=4,MCI=YES,SDI=1,DCI=4,ENU=0,ECU=0,CCC */
        7        7        TELNET: PROC MAIN;

      7  6 000000   000000 700200 xent  TELNET       TSX0  ! X66_MAUTO
         6 000001   000120 000000                    ZERO    80,0

        8        8        %INCLUDE CP_6;
        9       89
       10       90        %INCLUDE XU_MACRO_C;
       11     3196        %INCLUDE XUG_ENTRY;
       12     3227    1   DCL X$PRE_PROCESS ENTRY(1) ALTRET;
       13     3228        %XUG_GETCMD (NODES=TELNET_CMD, PROMPT=PROMPT);
       14     3566    1   DCL TELNET_CMD SBIN SYMREF;
       15     3567    1   DCL PROMPT CONSTANT CHAR(0) INIT(' Telnet>');
       16     3568        %XUG_INIT (PREPROCESS=YES, PREPROCESSOR=X$PRE_PROCESS, GOODCMD=YES);
       17     3981        %PARSE$OUT (STCLASS="BASED(P$)");
       18     4026        %PARSE$SYM (STCLASS=BASED);
       19     4064
       20     4065        %INCLUDE XSL_PERR_C;
       21     4120        %INCLUDE XSL_SOCKMSGS_E;
       22     4166        %INCLUDE XSL_SOCKET_E;
       23     4424        %INCLUDE XSL_SOCKET_M;
       24     5185        %INCLUDE XSL_INTERNAL_M;
       25     5436        %XSL_SOCKINIT( FPTN=TCT_SOCKINIT, MAXSOCK=2, NWSOCKS=0, STCLASS="CONSTANT SYMDEF");
       26     5559    1   DCL XSL$CLOSE ENTRY(2) ALTRET;
       27     5560    1   DCL XSL$CONNECT ENTRY(4) ALTRET;
       28     5561    1   DCL XSL$GETHOSTBYNAME ENTRY(2) ALTRET;
       29     5562    1   DCL XSL$INET_ADDR ENTRY(2) ALTRET;
       30     5563    1   DCL XSL$INET_NTOA ENTRY(2) ALTRET;
       31     5564    1   DCL XSL$SOCKET ENTRY(4) ALTRET;
       32     5565    1   DCL XSL$WRITE ENTRY(4) ALTRET;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:26   
       33     5566    1   DCL XSL$SOCKINIT ENTRY(1) ALTRET;
       34     5567    1   DCL XSL$HTONL ENTRY(2);
       35     5568
       36     5569        %INCLUDE TCT_TELNET_E;
       37     5624    1   DCL EVENT_HNDLR ENTRY ASYNC;
       38     5625    1   DCL INT_HNDLR ENTRY ASYNC;
       39     5626
       40     5627        %XSL$SOCKADDR_IN (FPTN=FS, STCLASS=STATIC);
       41     5691        %XSL$SOCKADDR_IN (FPTN=LS, STCLASS=STATIC);
       42     5755        %XSL$HOSTENT;
       43     5815
       44     5816    1   DCL LCN UBIN(36) STATIC SYMDEF;
       45     5817    1   DCL NET_BUF CHAR(1600) STATIC;
       46     5818        %F$DCB;
       47     5875        %M$DCB (DCBN=M$LO, RES='LO', FUN=CREATE, CTG=YES, ORG=TERMINAL);
       48     5949    1   DCL M$LO$ PTR;
       49     5950        %FPT_WRITE (DCB=M$LO,TRANS=YES,VFC=YES);
       50     5981        %FPT_WRITE (FPTN=WRITE_LO, DCB=M$LO);
       51     6012    1   DCL F$XSL00 DCB;
       52     6013    1   DCL I SBIN;
       53     6014    1   DCL P$ PTR;
       54     6015    1   DCL ACTCHRS(0:31) UBIN BYTE UNAL STATIC INIT(0*0);
       55     6016    1   DCL BITS8TO0(0:7) CONSTANT UBIN INIT(128, 64, 32,16,8,4,2,1);
       56     6017        %FPT_EOM (FPTN=EOMTERMINAL, DCB=M$UC, TIMEOUT=1, STCLASS=STATIC,
       57     6018                  UTYPE=MIL10, EOMTABLE=ACTCHRS);
       58     6048        %FPT_PROMPT (FPTN=TELNET_PROMPT, PROMPT=PROMPT, STCLASS=CONSTANT);
       59     6076        %FPT_PROMPT (FPTN=NO_PROMPT, PROMPT=ATPROMPT, VFC=YES, STCLASS=CONSTANT);
       60     6104    1   DCL ATPROMPT CONSTANT CHAR(0) INIT('@');
       61     6105        %VLP_EOMTABLE (FPTN=ACTNORMAL, STCLASS=CONSTANT, VALUES=STD);
       62     6124        %FPT_EOM (FPTN=EOMNORMAL, EOMTABLE=ACTNORMAL, TIMEOUT=0, STCLASS=CONSTANT);
       63     6154        %FPT_TRMPRG (FPTN=STOPTERMREAD, DCB=M$UC, ABORTREAD=YES, STCLASS=CONSTANT);
       64     6183        %FPT_TRMPRG (FPTN=STOPNETREAD, DCB=F$XSL00, ABORTREAD=YES, STCLASS=CONSTANT);
       65     6212    1   DCL TERM_BUF CHAR(256) STATIC SYMDEF;
       66     6213        %FPT_READ (FPTN=READ_TERM,
       67     6214               STCLASS=STATIC SYMDEF,
       68     6215               DCB=M$UC,
       69     6216               TRANS=YES,
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:27   
       70     6217               WAIT=NO,
       71     6218               EVENT=1,
       72     6219               BUF=TERM_BUF);
       73     6258
       74     6259    1   DCL OUTBUF CHAR(800) STATIC;
       75     6260    1   DCL FMTBUF CHAR(800) STATIC;       /* Second half of outbuf for net input */
       76     6261    1   DCL OUTBUFL UBIN(36) STATIC;
       77     6262    1   DCL CHARN CHAR(OUTBUFL) BASED;
       78     6263    1   DCL BASED$UBIN UBIN BASED ALIGNED;
       79     6264    1   DCL BASED$PTR PTR BASED;
       80     6265    1   DCL CHAR31 CHAR(31) BASED;
       81     6266
       82     6267    1   DCL CMASK BIT(36) STATIC INIT('0'B);
       83     6268    1   DCL 1 CINIT REDEF CMASK,
       84     6269    1        2 * BIT(27) UNAL,
       85     6270    1        2 C CHAR(1);
       86     6271    1   DCL CBIN REDEF CMASK UBIN;
       87     6272        %FPT_WRITE (FPTN=WRITE_RECVRQS, DCB=F$XSL00, KEY=XSL_RCVRQS, STCLASS=CONSTANT);
       88     6303    1   DCL XSL_RCVRQS(0:2) UBIN(18) UNAL CONSTANT INIT(%RECVRQS, 0, 1600);
       89     6304        %FPT_READ (FPTN=READ_RECVRSP, DCB=F$XSL00, WAIT=NO, BUF=NET_BUF, KEY=HELLO3,
       90     6305                  EVENT=10, STCLASS=CONSTANT);
       91     6344        %FPT_EVENT (UENTRY=EVENT_HNDLR, STCLASS=CONSTANT);
       92     6358        %FPT_INT (UENTRY=INT_HNDLR, STCLASS=CONSTANT);
       93     6372        %FPT_WAIT (FPTN=WAIT_FOREVER, UNITS=6000, STCLASS=CONSTANT);
       94     6386        %FPT_WAIT (FPTN=WAIT_AWHILE, UNITS=10, UTYPE=TUN, STCLASS=CONSTANT);
       95     6400    1   DCL REMOTE_CR BIT(1) STATIC INIT('0'B);
       96     6401    1   DCL REMOTE_IAC BIT(1) STATIC INIT('0'B);
       97     6402    1   DCL REMOTE_OPTION BIT(1) STATIC INIT('0'B);
       98     6403
       99     6404    1   DCL 1 HELLO STATIC,
      100     6405    1        2 * CHAR(0) INIT('TELNET version '),
      101     6406    1        2 VERS CHAR(6) INIT('0.1');
      102     6407    1   DCL 1 B_VERSION SYMREF,2 L UBIN BYTE UNAL,2 T CHAR(B_VERSION.L);
      103     6408
      104     6409    1   DCL 1 HELLO2  STATIC,
      105     6410    1        2 * CHAR(0) INIT('Attempting connection to '),
      106     6411    1        2 IP CHAR(16);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:28   
      107     6412
      108     6413    1   DCL 1 HELLO3 STATIC,
      109     6414    1        2 * CHAR(0) INIT('Connected to '),
      110     6415    1        2 IPNAME CHAR(40) INIT(' ');
      111     6416
      112     6417    1   DCL MSG_NO_LINK CHAR(0) CONSTANT INIT('Not connected - use open first.');
      113     6418
      114     6419        %FPT_ERRMSG (BUF=OUTBUF,                /* errmsg */
      115     6420               OUTDCB1=M$DO,
      116     6421               SOURCE=ALTRET,
      117     6422               INCLCODE=NO,
      118     6423               CODE=ERR_CODE);
      119     6450        %VLP_ERRCODE (FPTN=ERR_CODE, FCG=XS, MID=L);
      120     6495    1   DCL XSL_ERRNO SBIN SYMREF;
      121     6496    1   DCL M$DO DCB;
      122     6497        %INCLUDE B$JIT;
      123     6787    1   DCL B$JIT$ PTR SYMREF;
      124     6788
      125     6789    1   DCL LINK_UP BIT(36) STATIC SYMDEF INIT('0'B);
      126     6790    1   DCL MODE SBIN STATIC INIT(%TCT_OPT_CHAR);
      127     6791    1   DCL MODE_SENT SBIN STATIC INIT(0);
      128     6792    1   DCL NET_ARS SBIN STATIC SYMDEF INIT(0);
      129     6793    1   DCL TRM_ARS SBIN STATIC SYMDEF INIT(0);
      130     6794    1   DCL TRM_BRK SBIN STATIC SYMDEF INIT(0);
      131     6795    1   DCL GET_CMD BIT(36) STATIC INIT('0'B);
      132     6796    1   DCL CMD_MODE SBIN STATIC INIT(-1);
      133     6797    1   DCL WAIT_ARS SBIN STATIC INIT(0);
      134     6798    1   DCL ESC_WAIT SBIN STATIC INIT(0);
      135     6799    1   DCL ESC_CHRS CHAR(4) STATIC;
      136     6800    1   DCL READ_CMD SBIN STATIC INIT(-1);
      137     6801    1   DCL 1 READ_YC STATIC,
      138     6802    1        2 * CHAR(0) INIT('!ADJUST M$SI '),
      139     6803    1        2 FID CHAR(60) INIT('ME');
      140     6804    1   DCL TOGGLES(0:9) BIT(36) STATIC INIT('0'B*7, 'FFFFFFFFF'X, '0'B, 'FFFFFFFFF'X);
      141     6805        %EQU NC=BINASC(511);
      142     6806    1   DCL LOCAL_CHAR(0:19) CHAR(1) STATIC INIT(%NC/*Se*/, %NC/*Nop*/,%NC/*Dm*/,
      143     6807    1       %NC/*Break*/, %CP6_IP/*Ip*/, %NC/*Ao*/, %NC/*Ayt*/, %CP6_EC/*Ec*/,
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:29   
      144     6808    1       %CP6_EL/*El*/, %NC*5/*Ga,sb,will,wont,do*/, BINASC(13)/*Dont aka cr*/,
      145     6809    1       %TELNET_IAC/*Iac*/, %CP6_BRK/*Esc*/, BINASC(4)/*Eof*/,%NC*0);
      146     6810        %INCLUDE XU_FORMAT_C;
      147     6972    1   DCL X$WRITE ENTRY(22);
      148     6973        %F_FDS (NAME=FDS, BUF=FMTBUF, DCB=M$LO);
      149     7086
      150     7087        %EQU XUF=CHARTEXT('3 * CHAR(0) INIT');
      151     7088    1   DCL 1 DISP_FMT CONSTANT,
      152     7089    1        2 WW,
      153     7090    1   %XUF('%.1C%N[won''t %?will %]%C'),
      154     7091    1   2 CD,
      155     7092    1   %XUF('%.2C[%.9N:=[^@%511?undef%127?^?%256?break%?%.#:3+:5/:6?['),
      156     7093    1   %XUF('^%1.#:64+KA%1?%1.#KA%?^%1.#:96+KA%]%]]%-%C'),
      157     7094    1   2 TG,
      158     7095    1   %XUF('%1Cflush output when sending interrupt characters.%/'),
      159     7096    1   %XUF('%1Csend interrupt characters in urgent mode.%000000/'),
      160     7097    1   %XUF('%1Cmap carriage return on output.%00000000000000000/'),
      161     7098    1   %XUF('%1Crecognize certain control characters.%0000000000/'),
      162     7099    1   %XUF('%1Cprovide debugging information.%00000000000000000/'),
      163     7100    1   %XUF('%1Cdisplay network traffic in hex.%0000000000000000/'),
      164     7101    1   %XUF('%1Cdisplay option negotiation.%00000000000000000000/'),
      165     7102    1   %XUF('%1Cstrip the parity bit.%00000000000000000000000000/'),
      166     7103    1   %XUF('%1Cstay in command mode.%00000000000000000000000000/'),
      167     7104    1   %XUF('%1Cdelay to send ESC character.%0000000000000000000/'),
      168     7105    1   2 TGA(0:9) REDEF TG CHAR(52),
      169     7106    1   2 CH,
      170     7107    1   %XUF('%/%000000000000001S'),
      171     7108    1   %XUF('%00000000000000001S'),
      172     7109    1   %XUF('%00000000000000001S'),
      173     7110    1   %XUF('%2Cbreak.%00000000/'),
      174     7111    1   %XUF('%2Cinterrupt.%0000/'),
      175     7112    1   %XUF('%2Cabort output.%0/'),
      176     7113    1   %XUF('%2Care you there.%/'),
      177     7114    1   %XUF('%2Cerase.%00000000/'),
      178     7115    1   %XUF('%2Ckill.%000000000/'),
      179     7116    1   %XUF('%00000000000000001S'),
      180     7117    1   %XUF('%00000000000000001S'),
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:30   
      181     7118    1   %XUF('%00000000000000001S'),
      182     7119    1   %XUF('%00000000000000001S'),
      183     7120    1   %XUF('%00000000000000001S'),
      184     7121    1   %XUF('%00000000000000001S'),
      185     7122    1   %XUF('%00000000000000001S'),
      186     7123    1   %XUF('%2Cescape.%0000000/'),
      187     7124    1   %XUF('%2Ceof.%0000000001Q'),
      188     7125    1   2 CHA(0:17) REDEF CH CHAR(19);
      189     7126
      190     7127    1   DCL 1 FMT_1CH STATIC,
      191     7128    1        2 * CHAR(0) INIT('[%.9N:=[^@%511?undef%127?^?%256?break%?%.#:3+:5/:6?['),
      192     7129    1        2 * CHAR(0) INIT('^%1.#:64+KA%1?%1.#KA%?^%1.#:96+KA%]%]]%-'),
      193     7130    1        2 CH CHAR(15),2 * CHAR(1) INIT('Q');
      194     7131
      195     7132    1   DCL 1 FMT_1TG STATIC,
      196     7133    1        2 * CHAR(0) INIT('%N[won''t %?will %]'),
      197     7134    1        2 TG CHAR(48),2 * CHAR(1) INIT('Q');
      198     7135
      199     7136    1   DCL 1 STATUS_FMT CONSTANT,2 T,
      200     7137    1   %XUF('%.1C[%.9N:=[^@%511?undef%127?^?%256?break%?%.#:3+:5/:6?['),
      201     7138    1   %XUF('^%1.#:64+KA%1?%1.#KA%?^%1.#:96+KA%]%]]%C'),
      202     7139    1   %XUF('%.N[Not connected%S%?Connected to %>A%].%/'),
      203     7140    1   %XUF('Operating in %.N[character%?line%] mode.%/'),
      204     7141    1   %XUF('Escape character is %1C.');
      205     7142
      206     7143    1   DCL 1 NETIN_FMT CONSTANT,2 T,
      207     7144    1   %XUF('%V@ <- %1(%2@.8ZH %Q%1)');
      208     7145    1   DCL 1 NETOUT_FMT CONSTANT,2 T,
      209     7146    1   %XUF('%V@ -> %1(%2@.8ZH %Q%1)');
      210     7147
      211     7148    1   DCL SEARCH_TBL(0:259) CHAR(1);
      212     7149    1   DCL 1 XLATE_TBL STATIC,
      213     7150    1        2 LOW,
      214     7151    1         3 CTL(0:31) UBIN(9) CALIGNED INIT(0,1,2,3,4,5,6,7,8,9,10,11,12,
      215     7152    1       13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31),
      216     7153    1         3 ASCII(0:4) CHAR(19) INIT(' !"#$%&''()*+,-./012','3456789:;<=>?@ABCDE',
      217     7154    1       'FGHIJKLMNOPQRSTUVWX','YZ[\]^_`abcdefghijk','lmnopqrstuvwxyz{|}~'),
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:31   
      218     7155    1         3 DEL UBIN BYTE CALIGNED INIT(127),
      219     7156    1        2 HIGH(0:127) CHAR(1);
      220     7157    1   DCL XLATE_TBL_HIGH(0:31) CONSTANT BIT(36) INIT(
      221     7158    1    '000001002003'O,'004005006007'O,'010011012013'O,'014015016017'O,
      222     7159    1    '020021022023'O,'024025026027'O,'030031032033'O,'034035036037'O,
      223     7160    1    '040041042043'O,'044045046047'O,'050051052053'O,'054055056057'O,
      224     7161    1    '060061062063'O,'064065066067'O,'070071072073'O,'074075076077'O,
      225     7162    1    '100101102103'O,'104105106107'O,'110111112113'O,'114115116117'O,
      226     7163    1    '120121122123'O,'124125126127'O,'130131132133'O,'134135136137'O,
      227     7164    1    '140141142143'O,'144145146147'O,'150151152153'O,'154155156157'O,
      228     7165    1    '160161162163'O,'164165166167'O,'170171172173'O,'174175176177'O);
      229     7166
      230     7167    1      CALL M$INT (FPT_INT);

   7167  6 000002   000150 630400 2                  EPPR0   FPT_INT
         6 000003   010002 713400                    CLIMB   4098
         6 000004   400000 401760                    pmme    nvectors=1

      231     7168    1      CALL M$EVENT (FPT_EVENT);

   7168  6 000005   000144 630400 2                  EPPR0   FPT_EVENT
         6 000006   010001 713400                    CLIMB   4097
         6 000007   400000 401760                    pmme    nvectors=1

      232     7169    1      CALL XSL$SOCKINIT( TCT_SOCKINIT);

   7169  6 000010   000000 630400 7                  EPPR0   0
         6 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000012   000000 701000 xent               TSX1    XSL$SOCKINIT
         6 000013   000000 011000                    NOP     0

      233     7170    1      CALL XUG$INIT (XUG_GETCMD, XUG_INIT);

   7170  6 000014   000001 630400 7                  EPPR0   1
         6 000015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000016   000000 701000 xent               TSX1    XUG$INIT
         6 000017   000000 011000                    NOP     0
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:32   

      234     7171    1      HELLO.VERS = B_VERSION.T;

   7171  6 000020   000000 236000 xsym               LDQ     B_VERSION
         6 000021   000033 772000                    QRL     27
         6 000022   000000 620006                    EAX0    0,QL
         6 000023   040000 100440                    MLR     fill='040'O
         6 000024   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         6 000025   001772 600006 1                  ADSC9   HELLO+3                  cn=3,n=6

      235     7172    1      WRITE_LO.BUF_ = VECTOR(HELLO);

   7172  6 000026   000004 237000 7                  LDAQ    4
         6 000027   000772 757000 1                  STAQ    WRITE_LO+4

      236     7173    1      CALL M$WRITE (WRITE_LO);

   7173  6 000030   000766 630400 1                  EPPR0   WRITE_LO
         6 000031   040001 713400                    CLIMB   write
         6 000032   401400 401760                    pmme    nvectors=4

      237     7174    1      M$LO$ = DCBADDR(DCBNUM(M$LO));

   7174  6 000033   000000 236007 xsym               LDQ     M$LO,DL
         6 000034   000006 470400 7                  LDP0    6
         6 000035   000000 471500                    LDP1    0,,PR0
         6 000036   100000 236106                    LDQ     0,QL,PR1
         6 000037   200003 756100                    STQ     M$LO$,,AUTO

      238     7175    1      IF NOT B$JIT.PRFLAGS.OU AND NOT B$JIT.PRFLAGS.LS

   7175  6 000040   000000 473400 xsym               LDP3    B$JIT$
         6 000041   300030 236100                    LDQ     24,,PR3
         6 000042   100000 316003                    CANQ    32768,DU
         6 000043   000056 601000 6                  TNZ     s:7177
         6 000044   040000 316003                    CANQ    16384,DU
         6 000045   000056 601000 6                  TNZ     s:7177
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:33   

      239     7176    1      THEN XUG_GETCMD.TEXT_ = VECTOR(SUBSTR(B$JIT.CCBUF,0,B$JIT.CCARS));

   7176  6 000046   300032 220100                    LDX0    26,,PR3
         6 000047   000000 635010                    EAA     0,X0
         6 000050   000002 771000                    ARL     2
         6 000051   000140 135007                    SBLA    96,DL
         6 000052   000000 236000 xsym               LDQ     B$JIT$
         6 000053   000033 036003                    ADLQ    27,DU
         6 000054   000034 757000 1                  STAQ    XUG_GETCMD+28
         6 000055   000057 710000 6                  TRA     NXTCMD

      240     7177    1      ELSE CMD_MODE = 0;

   7177  6 000056   002070 450000 1                  STZ     CMD_MODE

      241     7178
      242     7179    2   NXTCMD: DO UNTIL (LINK_UP) ;

   7179  6 000057                       NXTCMD       null
      243     7180    3          CALL XUG$GETCMD (XUG_GETCMD) WHENALTRETURN DO;

   7180  6 000057   000001 630400 7                  EPPR0   1
         6 000060   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000061   000000 701000 xent               TSX1    XUG$GETCMD
         6 000062   000064 702000 6                  TSX2    s:7181
         6 000063   000106 710000 6                  TRA     s:7193

      244     7181    3              READ_YC.FID = 'ME';

   7181  6 000064   040000 100400                    MLR     fill='040'O
         6 000065   000736 000002 2                  ADSC9   RESET_BREAK+8            cn=0,n=2
         6 000066   002100 200074 1                  ADSC9   READ_YC+3                cn=1,n=60

      245     7182    4              IF READ_CMD<0 THEN DO;

   7182  6 000067   002074 235000 1                  LDA     READ_CMD
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:34   
         6 000070   000101 605000 6                  TPL     s:7186

      246     7183    4                  IF XUG_GETCMD.TEXT_~=VECTOR(NIL) THEN CALL M$EXIT;

   7183  6 000071   000034 237000 1                  LDAQ    XUG_GETCMD+28
         6 000072   000010 117000 7                  CMPAQ   8
         6 000073   000076 600000 6                  TZE     s:7184

   7183  6 000074   000001 713400                    CLIMB   exit
         6 000075   000000 401760                    pmme    nvectors=0

      247     7184    4                  CMD_MODE = 1;

   7184  6 000076   000001 235007                    LDA     1,DL
         6 000077   002070 755000 1                  STA     CMD_MODE

      248     7185    4                  END;

   7185  6 000100   000105 710000 6                  TRA     s:7191

      249     7186    3              ELSE IF READ_CMD=0 THEN EXIT;

   7186  6 000101   000106 600000 6                  TZE     s:7193

      250     7187    4                  ELSE DO;

      251     7188    4                      XUG_GETCMD.TEXT_ = VECTOR(READ_YC);

   7188  6 000102   000012 237000 7                  LDAQ    10
         6 000103   000034 757000 1                  STAQ    XUG_GETCMD+28

      252     7189    4                      READ_CMD = 0;

   7189  6 000104   002074 450000 1                  STZ     READ_CMD

      253     7190    4                      END;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:35   
      254     7191    3              GOTO MONERR;

   7191  6 000105   000433 710000 6                  TRA     MONERR

      255     7192    3              END;
      256     7193    2          XUG_GETCMD.TEXT_ = VECTOR(NIL);

   7193  6 000106   000010 237000 7                  LDAQ    8
         6 000107   000034 757000 1                  STAQ    XUG_GETCMD+28

      257     7194    3          IF READ_CMD = 0 THEN DO;

   7194  6 000110   002074 235000 1                  LDA     READ_CMD
         6 000111   000123 601000 6                  TNZ     s:7199

      258     7195    3              IF READ_YC.FID = 'ME' THEN READ_CMD = -1;

   7195  6 000112   040000 106400                    CMPC    fill='040'O
         6 000113   002100 200074 1                  ADSC9   READ_YC+3                cn=1,n=60
         6 000114   000736 000002 2                  ADSC9   RESET_BREAK+8            cn=0,n=2
         6 000115   000121 601000 6                  TNZ     s:7196

   7195  6 000116   000001 335007                    LCA     1,DL
         6 000117   002074 755000 1                  STA     READ_CMD
         6 000120   000122 710000 6                  TRA     s:7197

      259     7196    3              ELSE READ_CMD = READ_CMD + 1;

   7196  6 000121   002074 054000 1                  AOS     READ_CMD

      260     7197    3              GOTO NXTCMD;

   7197  6 000122   000057 710000 6                  TRA     NXTCMD

      261     7198    3              END;
      262     7199    2          READ_YC.FID = 'ME';

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:36   
   7199  6 000123   040000 100400                    MLR     fill='040'O
         6 000124   000736 000002 2                  ADSC9   RESET_BREAK+8            cn=0,n=2
         6 000125   002100 200074 1                  ADSC9   READ_YC+3                cn=1,n=60

      263     7200
      264     7201    2          P$ = XUG_GETCMD.OUT$->OUT$BLK.SUBLK$(0);

   7201  6 000126   000001 470400 1                  LDP0    XUG_GETCMD+1
         6 000127   000003 236100                    LDQ     3,,PR0
         6 000130   200005 756100                    STQ     P$,,AUTO

      265     7202    3          DO CASE (OUT$BLK.CODE);

   7202  6 000131   200005 471500                    LDP1    P$,,AUTO
         6 000132   100000 720100                    LXL0    0,,PR1
         6 000133   000011 100003                    CMPX0   9,DU
         6 000134   000136 602010 6                  TNC     s:7202+5,X0
         6 000135   001015 710000 6                  TRA     s:7351
         6 000136   000147 710000 6                  TRA     s:7204
         6 000137   000163 710000 6                  TRA     s:7210
         6 000140   000256 710000 6                  TRA     s:7228
         6 000141   000267 710000 6                  TRA     s:7234
         6 000142   000514 710000 6                  TRA     s:7286
         6 000143   000527 710000 6                  TRA     s:7291
         6 000144   000670 710000 6                  TRA     s:7325
         6 000145   000736 710000 6                  TRA     s:7336
         6 000146   000743 710000 6                  TRA     s:7341

      266     7203    3           CASE (%TCT_CMD_CLOSE);

      267     7204    3              CALL XSL$CLOSE (I, LCN);

   7204  6 000147   000014 236000 7                  LDQ     12
         6 000150   200113 756100                    STQ     J+2,,AUTO
         6 000151   200004 633500                    EPPR3   I,,AUTO
         6 000152   200112 453500                    STP3    J+1,,AUTO
         6 000153   200112 630500                    EPPR0   J+1,,AUTO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:37   
         6 000154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000155   000000 701000 xent               TSX1    XSL$CLOSE
         6 000156   000000 011000                    NOP     0

      268     7205    3              NET_ARS = 0;

   7205  6 000157   002064 450000 1                  STZ     NET_ARS

      269     7206    3              TRM_ARS = 0;

   7206  6 000160   002065 450000 1                  STZ     TRM_ARS

      270     7207    3              LINK_UP = '0'B;

   7207  6 000161   002061 450000 1                  STZ     LINK_UP
         6 000162   001020 710000 6                  TRA     s:7353

      271     7208
      272     7209    3           CASE (%TCT_CMD_DISPLAY);

      273     7210    3              IF OUT$BLK.NSUBLKS=0

   7210  6 000163   100001 221100                    LDX1    1,,PR1
         6 000164   000172 601000 6                  TNZ     s:7213

      274     7211    3              THEN CALL X$WRITE (FDS, VECTOR(DISP_FMT), VECTOR(TOGGLES),

   7211  6 000165   000024 630400 7                  EPPR0   20
         6 000166   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000167   000000 701000 xent               TSX1    X$WRITE
         6 000170   000000 011000                    NOP     0
         6 000171   001020 710000 6                  TRA     s:7353

      275     7212    3                        VECTOR(LOCAL_CHAR));
      276     7213    4              ELSE DO I=0 TO OUT$BLK.NSUBLKS-1;

   7213  6 000172   200004 450100                    STZ     I,,AUTO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:38   
         6 000173   000250 710000 6                  TRA     s:7225+1

      277     7214    4                  OUTBUFL = OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;

   7214  6 000174   200005 470500                    LDP0    P$,,AUTO
         6 000175   200004 720100                    LXL0    I,,AUTO
         6 000176   000003 471510                    LDP1    3,X0,PR0
         6 000177   100000 236100                    LDQ     0,,PR1
         6 000200   777777 376007                    ANQ     -1,DL
         6 000201   001762 756000 1                  STQ     OUTBUFL

      278     7215    5                  IF OUTBUFL<240 THEN DO;

   7215  6 000202   000360 116007                    CMPQ    240,DL
         6 000203   000226 603000 6                  TRC     s:7221

      279     7216    5                      FMT_1TG.TG = SUBSTR (DISP_FMT.TGA (OUTBUFL), 3);

   7216  6 000204   000064 402007                    MPY     52,DL
         6 000205   040000 100406                    MLR     fill='040'O
         6 000206   000237 200060 2                  ADSC9   DISP_FMT+31,Q            cn=1,n=48
         6 000207   002234 400060 1                  ADSC9   FMT_1TG+4                cn=2,n=48

      280     7217    5                      CALL X$WRITE (FDS, VECTOR(FMT_1TG),

   7217  6 000210   777640 235007                    LDA     -96,DL
         6 000211   001762 236000 1                  LDQ     OUTBUFL
         6 000212   000022 736000                    QLS     18
         6 000213   000021 036000 7                  ADLQ    17
         6 000214   200112 757100                    STAQ    J+1,,AUTO
         6 000215   200112 631500                    EPPR1   J+1,,AUTO
         6 000216   200116 451500                    STP1    J+5,,AUTO
         6 000217   000032 237000 7                  LDAQ    26
         6 000220   200114 757100                    STAQ    J+3,,AUTO
         6 000221   200114 630500                    EPPR0   J+3,,AUTO
         6 000222   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000223   000000 701000 xent               TSX1    X$WRITE
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:39   
         6 000224   000000 011000                    NOP     0

      281     7218    5                            VECTOR(TOGGLES (OUTBUFL)));
      282     7219    5                      END;

   7219  6 000225   000247 710000 6                  TRA     s:7225

      283     7220    5                  ELSE DO;

      284     7221    5                      FMT_1CH.CH = SUBSTR (DISP_FMT.CHA (OUTBUFL-240), 3);

   7221  6 000226   000023 402007                    MPY     19,DL
         6 000227   040000 100406                    MLR     fill='040'O
         6 000230   776255 200017 2                  ADSC9   RESET_BREAK-1321,Q       cn=1,n=15
         6 000231   002224 000017 1                  ADSC9   FMT_1CH+23               cn=0,n=15

      285     7222    5                      CALL X$WRITE (FDS, VECTOR(FMT_1CH),

   7222  6 000232   177640 235007                    LDA     65440,DL
         6 000233   001762 236000 1                  LDQ     OUTBUFL
         6 000234   000020 736000                    QLS     16
         6 000235   000036 036000 7                  ADLQ    30
         6 000236   200112 757100                    STAQ    J+1,,AUTO
         6 000237   200112 631500                    EPPR1   J+1,,AUTO
         6 000240   200116 451500                    STP1    J+5,,AUTO
         6 000241   000040 237000 7                  LDAQ    32
         6 000242   200114 757100                    STAQ    J+3,,AUTO
         6 000243   200114 630500                    EPPR0   J+3,,AUTO
         6 000244   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000245   000000 701000 xent               TSX1    X$WRITE
         6 000246   000000 011000                    NOP     0

      286     7223    5                            VECTOR(LOCAL_CHAR (OUTBUFL-240)));
      287     7224    5                      END;

      288     7225    4                  END;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:40   
   7225  6 000247   200004 054100                    AOS     I,,AUTO
         6 000250   200005 470500                    LDP0    P$,,AUTO
         6 000251   000001 236100                    LDQ     1,,PR0
         6 000252   000022 772000                    QRL     18
         6 000253   200004 116100                    CMPQ    I,,AUTO
         6 000254   000174 605400 6                  TPNZ    s:7214
         6 000255   001020 710000 6                  TRA     s:7353

      289     7226
      290     7227    3           CASE (%TCT_CMD_MODE);

      291     7228    3              IF MODE = OUT$BLK.SUBLK$(0)->OUT$BLK.CODE THEN EXIT;

   7228  6 000256   100003 473500                    LDP3    3,,PR1
         6 000257   300000 236100                    LDQ     0,,PR3
         6 000260   777777 376007                    ANQ     -1,DL
         6 000261   002062 116000 1                  CMPQ    MODE
         6 000262   001020 600000 6                  TZE     s:7353

      292     7229    3              MODE = OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

   7229  6 000263   002062 756000 1                  STQ     MODE

      293     7230    3              IF LINK_UP THEN GOTO SET_MODE;

   7230  6 000264   002061 235000 1                  LDA     LINK_UP
         6 000265   000457 601000 6                  TNZ     SET_MODE
         6 000266   001020 710000 6                  TRA     s:7353

      294     7231
      295     7232    3           CASE (%TCT_CMD_OPEN);

      296     7233
      297     7234    3              IF CMD_MODE<0 THEN CMD_MODE = 1; /* Quick exit mode */

   7234  6 000267   002070 235000 1                  LDA     CMD_MODE
         6 000270   000273 605000 6                  TPL     s:7235
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:41   

   7234  6 000271   000001 235007                    LDA     1,DL
         6 000272   002070 755000 1                  STA     CMD_MODE

      298     7235    3              IF OUT$BLK.NSUBLKS = 2

   7235  6 000273   100001 221100                    LDX1    1,,PR1
         6 000274   000002 101003                    CMPX1   2,DU
         6 000275   000310 601000 6                  TNZ     s:7237

      299     7236    3              THEN CALL CHARBIN(FS.S_PORT,OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);

   7236  6 000276   100004 473500                    LDP3    4,,PR1
         6 000277   300004 236100                    LDQ     4,,PR3
         6 000300   000033 772000                    QRL     27
         6 000301   000000 622006                    EAX2    0,QL
         6 000302   000100 305540                    DTB
         6 000303   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         6 000304   200112 000010                    NDSC9   J+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         6 000305   200113 236100                    LDQ     J+2,,AUTO
         6 000306   000117 756000 1                  STQ     FS+1
         6 000307   000312 710000 6                  TRA     s:7238

      300     7237    3              ELSE FS.S_PORT = %TCT_WKS_TELNET;

   7237  6 000310   000027 235007                    LDA     23,DL
         6 000311   000117 755000 1                  STA     FS+1

      301     7238    3              CALL XSL$HTONL( FS.S_PORT, FS.S_PORT);

   7238  6 000312   000042 630400 7                  EPPR0   34
         6 000313   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000314   000000 701000 xent               TSX1    XSL$HTONL
         6 000315   000000 011000                    NOP     0

      302     7239    3              HELLO3.IPNAME = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:42   
   7239  6 000316   200005 470500                    LDP0    P$,,AUTO
         6 000317   000003 471500                    LDP1    3,,PR0
         6 000320   100004 236100                    LDQ     4,,PR1
         6 000321   000033 772000                    QRL     27
         6 000322   000000 620006                    EAX0    0,QL
         6 000323   040000 100540                    MLR     fill='040'O
         6 000324   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         6 000325   002013 200050 1                  ADSC9   HELLO3+3                 cn=1,n=40

      303     7240    4              CALL XSL$INET_ADDR(FS.S_ADDR, HELLO3.IPNAME) WHENALTRETURN DO;

   7240  6 000326   000044 630400 7                  EPPR0   36
         6 000327   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000330   000000 701000 xent               TSX1    XSL$INET_ADDR
         6 000331   000333 702000 6                  TSX2    s:7241
         6 000332   000350 710000 6                  TRA     s:7245

      304     7241    4                  CALL XSL$GETHOSTBYNAME (P$,HELLO3.IPNAME) ALTRET (RETALT);

   7241  6 000333   000045 236000 7                  LDQ     37
         6 000334   200113 756100                    STQ     J+2,,AUTO
         6 000335   200005 630500                    EPPR0   P$,,AUTO
         6 000336   200112 450500                    STP0    J+1,,AUTO
         6 000337   200112 630500                    EPPR0   J+1,,AUTO
         6 000340   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000341   000000 701000 xent               TSX1    XSL$GETHOSTBYNAME
         6 000342   000422 702000 6                  TSX2    RETALT

      305     7242    4                  FS.S_ADDR = P$->XSL$HOSTENT.H_ADDR_LIST$->BASED$PTR->BASED$UBIN;

   7242  6 000343   200005 470500                    LDP0    P$,,AUTO
         6 000344   000004 471500                    LDP1    4,,PR0
         6 000345   100000 473500                    LDP3    0,,PR1
         6 000346   300000 235100                    LDA     0,,PR3
         6 000347   000120 755000 1                  STA     FS+2

      306     7243    4                  END;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:43   

      307     7244
      308     7245    3              CALL XSL$INET_NTOA (P$,FS.S_ADDR);

   7245  6 000350   000044 236000 7                  LDQ     36
         6 000351   200113 756100                    STQ     J+2,,AUTO
         6 000352   200005 630500                    EPPR0   P$,,AUTO
         6 000353   200112 450500                    STP0    J+1,,AUTO
         6 000354   200112 630500                    EPPR0   J+1,,AUTO
         6 000355   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000356   000000 701000 xent               TSX1    XSL$INET_NTOA
         6 000357   000000 011000                    NOP     0

      309     7246    3              CALL INDEX (OUTBUFL, BINASC(0), P$->CHAR31);

   7246  6 000360   200005 470500                    LDP0    P$,,AUTO
         6 000361   000000 124500                    SCM     mask='000'O
         6 000362   000000 000037                    ADSC9   0,,PR0                   cn=0,n=31
         6 000363   000046 000001 7                  ADSC9   38                       cn=0,n=1
         6 000364   001762 000000 1                  ARG     OUTBUFL

      310     7247    3              HELLO2.IP = SUBSTR(P$->CHAR31,0,OUTBUFL);

   7247  6 000365   001762 720000 1                  LXL0    OUTBUFL
         6 000366   040000 100540                    MLR     fill='040'O
         6 000367   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         6 000370   002003 200020 1                  ADSC9   HELLO2+6                 cn=1,n=16

      311     7248
      312     7249    3              WRITE_LO.BUF_ = VECTOR(HELLO2);

   7249  6 000371   000050 237000 7                  LDAQ    40
         6 000372   000772 757000 1                  STAQ    WRITE_LO+4

      313     7250    3              CALL M$WRITE (WRITE_LO);

   7250  6 000373   000766 630400 1                  EPPR0   WRITE_LO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:44   
         6 000374   040001 713400                    CLIMB   write
         6 000375   401400 401760                    pmme    nvectors=4

      314     7251
      315     7252    3              LS = '0'B;

   7252  6 000376   000000 100400                    MLR     fill='000'O
         6 000377   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 000400   000123 000022 1                  ADSC9   LS                       cn=0,n=18

      316     7253    3              FS.SA_FAMILY = %XSL_AF_INET;

   7253  6 000401   000002 235007                    LDA     2,DL
         6 000402   000116 755000 1                  STA     FS

      317     7254    3              CALL XSL$SOCKET (LCN, %XSL_AF_INET, %XSL_SOCK_STREAM, %XSL_PF_INET)

   7254  6 000403   000052 630400 7                  EPPR0   42
         6 000404   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000405   000000 701000 xent               TSX1    XSL$SOCKET
         6 000406   000422 702000 6                  TSX2    RETALT

      318     7255    3                    ALTRET (RETALT);
      319     7256    3              CALL XSL$CONNECT (I, LCN, FS, 8)

   7256  6 000407   000056 237000 7                  LDAQ    46
         6 000410   200114 757100                    STAQ    J+3,,AUTO
         6 000411   000014 236000 7                  LDQ     12
         6 000412   200113 756100                    STQ     J+2,,AUTO
         6 000413   200004 630500                    EPPR0   I,,AUTO
         6 000414   200112 450500                    STP0    J+1,,AUTO
         6 000415   200112 630500                    EPPR0   J+1,,AUTO
         6 000416   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000417   000000 701000 xent               TSX1    XSL$CONNECT
         6 000420   000422 702000 6                  TSX2    RETALT
         6 000421   000446 710000 6                  TRA     s:7268

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:45   
      320     7257    4              WHENALTRETURN DO;

   7256  6 000422                       RETALT       null
      321     7258    4   RETALT:        ;
      322     7259    4                  ERR_CODE.ERR# = XSL_ERRNO;

   7259  6 000422   000000 236000 xsym               LDQ     XSL_ERRNO
         6 000423   000003 736000                    QLS     3
         6 000424   002060 676000 1                  ERQ     ERR_CODE
         6 000425   377770 376007                    ANQ     131064,DL
         6 000426   002060 656000 1                  ERSQ    ERR_CODE

      323     7260    4                  IF XSL_ERRNO>0 THEN FPT_ERRMSG.V.SOURCE# = 0;

   7260  6 000427   000000 235000 xsym               LDA     XSL_ERRNO
         6 000430   000433 604400 6                  TMOZ    MONERR

   7260  6 000431   000047 236000 7                  LDQ     39
         6 000432   002056 356000 1                  ANSQ    FPT_ERRMSG+24

   7260  6 000433                       MONERR       null
      324     7261    4   MONERR:        ;
      325     7262    4                  CALL M$ERRMSG (FPT_ERRMSG);

   7262  6 000433   002026 630400 1                  EPPR0   FPT_ERRMSG
         6 000434   020000 713400                    CLIMB   8192
         6 000435   405000 401760                    pmme    nvectors=11

      326     7263    4                  FPT_ERRMSG.V.SOURCE# = 2;

   7263  6 000436   002056 236000 1                  LDQ     FPT_ERRMSG+24
         6 000437   000047 376000 7                  ANQ     39
         6 000440   100000 276007                    ORQ     32768,DL
         6 000441   002056 756000 1                  STQ     FPT_ERRMSG+24

      327     7264    4                  IF CMD_MODE=0 THEN GOTO NXTCMD;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:46   
   7264  6 000442   002070 235000 1                  LDA     CMD_MODE
         6 000443   000057 600000 6                  TZE     NXTCMD

      328     7265    4                  CALL M$EXIT;

   7265  6 000444   000001 713400                    CLIMB   exit
         6 000445   000000 401760                    pmme    nvectors=0

      329     7266    4                  END;

      330     7267
      331     7268    3              LINK_UP = '1'B;

   7268  6 000446   400000 236003                    LDQ     -131072,DU
         6 000447   002061 756000 1                  STQ     LINK_UP

      332     7269    3              WRITE_LO.BUF_ = VECTOR(HELLO3);

   7269  6 000450   000060 237000 7                  LDAQ    48
         6 000451   000772 757000 1                  STAQ    WRITE_LO+4

      333     7270    3              CALL M$WRITE (WRITE_LO);

   7270  6 000452   000766 630400 1                  EPPR0   WRITE_LO
         6 000453   040001 713400                    CLIMB   write
         6 000454   401400 401760                    pmme    nvectors=4

      334     7271    3              IF MODE = %TCT_OPT_CHAR THEN EXIT;

   7271  6 000455   002062 235000 1                  LDA     MODE
         6 000456   001020 600000 6                  TZE     s:7353

   7271  6 000457                       SET_MODE     null
      335     7272    3   SET_MODE:  ;
      336     7273    3              SUBSTR(OUTBUF,0,6) = %CONCAT(TELNET_IAC,TELNET_DO,BINASC(3)/*Sga*/,

   7273  6 000457   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:47   
         6 000460   000737 000006 2                  ADSC9   RESET_BREAK+9            cn=0,n=6
         6 000461   001142 000006 1                  ADSC9   OUTBUF                   cn=0,n=6

      337     7274    3                    TELNET_IAC,TELNET_DO,BINASC(1)/*Echo*/);
      338     7275    4              IF MODE = %TCT_OPT_LINE THEN DO;

   7275  6 000462   002062 235000 1                  LDA     MODE
         6 000463   000001 115007                    CMPA    1,DL
         6 000464   000471 601000 6                  TNZ     s:7279

      339     7276    4                  SUBSTR(OUTBUF,1,1) = %TELNET_DONT;

   7276  6 000465   000376 236003                    LDQ     254,DU
         6 000466   001142 552020 1                  STBQ    OUTBUF,'20'O

      340     7277    4                  SUBSTR(OUTBUF,4,1) = %TELNET_DONT;

   7277  6 000467   376000 236003                    LDQ     130048,DU
         6 000470   001143 552040 1                  STBQ    OUTBUF+1,'40'O

      341     7278    4                  END;

      342     7279    3              CALL XSL$WRITE (I, LCN, OUTBUF, 6);

   7279  6 000471   000062 237000 7                  LDAQ    50
         6 000472   200114 757100                    STAQ    J+3,,AUTO
         6 000473   000014 236000 7                  LDQ     12
         6 000474   200113 756100                    STQ     J+2,,AUTO
         6 000475   200004 630500                    EPPR0   I,,AUTO
         6 000476   200112 450500                    STP0    J+1,,AUTO
         6 000477   200112 630500                    EPPR0   J+1,,AUTO
         6 000500   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000501   000000 701000 xent               TSX1    XSL$WRITE
         6 000502   000000 011000                    NOP     0

      343     7280    3              IF TOGGLES(%TCT_OPT_ND)

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:48   
   7280  6 000503   002125 235000 1                  LDA     TOGGLES+5
         6 000504   000511 600000 6                  TZE     s:7283

      344     7281    3              THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),

   7281  6 000505   000070 630400 7                  EPPR0   56
         6 000506   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000507   000000 701000 xent               TSX1    X$WRITE
         6 000510   000000 011000                    NOP     0

      345     7282    3                        VECTOR(SUBSTR(OUTBUF,0,6)));
      346     7283    3              MODE_SENT = 4;

   7283  6 000511   000004 235007                    LDA     4,DL
         6 000512   002063 755000 1                  STA     MODE_SENT
         6 000513   001020 710000 6                  TRA     s:7353

      347     7284
      348     7285    3           CASE (%TCT_CMD_READ);

      349     7286    3              READ_YC.FID = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   7286  6 000514   100003 473500                    LDP3    3,,PR1
         6 000515   300004 236100                    LDQ     4,,PR3
         6 000516   000033 772000                    QRL     27
         6 000517   000000 621006                    EAX1    0,QL
         6 000520   040000 100540                    MLR     fill='040'O
         6 000521   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         6 000522   002100 200074 1                  ADSC9   READ_YC+3                cn=1,n=60

      350     7287    3              READ_CMD = 0;

   7287  6 000523   002074 450000 1                  STZ     READ_CMD

      351     7288    3              XUG_GETCMD.TEXT_ = VECTOR(READ_YC);

   7288  6 000524   000012 237000 7                  LDAQ    10
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:49   
         6 000525   000034 757000 1                  STAQ    XUG_GETCMD+28
         6 000526   001020 710000 6                  TRA     s:7353

      352     7289
      353     7290    3           CASE (%TCT_CMD_SEND);

      354     7291    4              IF NOT LINK_UP THEN DO;

   7291  6 000527   002061 235000 1                  LDA     LINK_UP
         6 000530   000537 601000 6                  TNZ     s:7296

      355     7292    4                  WRITE_LO.BUF_ = VECTOR (MSG_NO_LINK);

   7292  6 000531   000074 237000 7                  LDAQ    60
         6 000532   000772 757000 1                  STAQ    WRITE_LO+4

      356     7293    4                  CALL M$WRITE (WRITE_LO);

   7293  6 000533   000766 630400 1                  EPPR0   WRITE_LO
         6 000534   040001 713400                    CLIMB   write
         6 000535   401400 401760                    pmme    nvectors=4

      357     7294    4                  GOTO NXTCMD;

   7294  6 000536   000057 710000 6                  TRA     NXTCMD

      358     7295    4                  END;
      359     7296    3              SUBSTR (OUTBUF,1,1) = BINASC (OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);

   7296  6 000537   100003 473500                    LDP3    3,,PR1
         6 000540   300000 236100                    LDQ     0,,PR3
         6 000541   777777 376007                    ANQ     -1,DL
         6 000542   000033 736000                    QLS     27
         6 000543   000046 276000 7                  ORQ     38
         6 000544   000011 772000                    QRL     9
         6 000545   001142 552020 1                  STBQ    OUTBUF,'20'O

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:50   
      360     7297    4              IF SUBSTR (OUTBUF,1,1) = %BINASC(TCT_OPT_ESC) THEN DO;

   7297  6 000546   001142 236000 1                  LDQ     OUTBUF
         6 000547   000777 376003                    ANQ     511,DU
         6 000550   000400 116003                    CMPQ    256,DU
         6 000551   000557 601000 6                  TNZ     s:7301

      361     7298    4                  OUTBUFL = 1;

   7298  6 000552   000001 236007                    LDQ     1,DL
         6 000553   001762 756000 1                  STQ     OUTBUFL

      362     7299    4                  SUBSTR (OUTBUF,0,1) = LOCAL_CHAR(%TCT_OPT_ESC);

   7299  6 000554   002232 236000 1                  LDQ     FMT_1TG+2
         6 000555   001142 552040 1                  STBQ    OUTBUF,'40'O

      363     7300    4                  END;

   7300  6 000556   000636 710000 6                  TRA     s:7319

      364     7301    4              ELSE IF SUBSTR (OUTBUF,1,1) = BINASC(0) THEN DO; /* Send string */

   7301  6 000557   001142 236000 1                  LDQ     OUTBUF
         6 000560   000777 376003                    ANQ     511,DU
         6 000561   000000 116003                    CMPQ    0,DU
         6 000562   000632 601000 6                  TNZ     s:7316

      365     7302    4                      OUTBUFL = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;

   7302  6 000563   100003 473500                    LDP3    3,,PR1
         6 000564   300004 236100                    LDQ     4,,PR3
         6 000565   000033 772000                    QRL     27
         6 000566   001762 756000 1                  STQ     OUTBUFL

      366     7303    4                      ADDR(OUTBUF)->CHARN = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:51   
   7303  6 000567   100003 473500                    LDP3    3,,PR1
         6 000570   300004 236100                    LDQ     4,,PR3
         6 000571   000033 772000                    QRL     27
         6 000572   000000 620006                    EAX0    0,QL
         6 000573   001762 721000 1                  LXL1    OUTBUFL
         6 000574   040040 100540                    MLR     fill='040'O
         6 000575   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         6 000576   001142 000011 1                  ADSC9   OUTBUF                   cn=0,n=*X1

      367     7304    4                      IF OUT$BLK.NSUBLKS=1 THEN EXIT; /* all done if only a string */

   7304  6 000577   100001 220100                    LDX0    1,,PR1
         6 000600   000001 100003                    CMPX0   1,DU
         6 000601   000631 600000 6                  TZE     s:7313+1

      368     7305    5                      IF OUT$BLK.NSUBLKS~=3 THEN DO; /* 2 or 4 means cr option */

   7305  6 000602   000003 100003                    CMPX0   3,DU
         6 000603   000615 600000 6                  TZE     s:7310

      369     7306    5                          SUBSTR (OUTBUF,OUTBUFL,1) = %BINASC(13);

   7306  6 000604   001762 235000 1                  LDA     OUTBUFL
         6 000605   040005 100400                    MLR     fill='040'O
         6 000606   000076 000001 7                  ADSC9   62                       cn=0,n=1
         6 000607   001142 000001 1                  ADSC9   OUTBUF,A                 cn=0,n=1

      370     7307    5                          OUTBUFL = OUTBUFL+1;

   7307  6 000610   001762 235000 1                  LDA     OUTBUFL
         6 000611   000001 035007                    ADLA    1,DL
         6 000612   001762 755000 1                  STA     OUTBUFL

      371     7308    5                          OUT$BLK.SUBLK$(2) = OUT$BLK.SUBLK$(3);

   7308  6 000613   100006 236100                    LDQ     6,,PR1
         6 000614   100005 756100                    STQ     5,,PR1
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:52   

      372     7309    5                          END;

      373     7310    4                      IF OUT$BLK.NSUBLKS=2 THEN EXIT; /* all done if string+cr */

   7310  6 000615   200005 470500                    LDP0    P$,,AUTO
         6 000616   000001 220100                    LDX0    1,,PR0
         6 000617   000002 100003                    CMPX0   2,DU
         6 000620   000631 600000 6                  TZE     s:7313+1

      374     7311    4                      WAIT_ARS = OUTBUFL+1; /* Send it after string2 arrives */

   7311  6 000621   001762 235000 1                  LDA     OUTBUFL
         6 000622   000001 035007                    ADLA    1,DL
         6 000623   002071 755000 1                  STA     WAIT_ARS

      375     7312    4                      ADDR(TERM_BUF)->CHARN = ADDR(OUTBUF)->CHARN;

   7312  6 000624   001762 721000 1                  LXL1    OUTBUFL
         6 000625   040040 100440                    MLR     fill='040'O
         6 000626   001142 000011 1                  ADSC9   OUTBUF                   cn=0,n=*X1
         6 000627   001024 000011 1                  ADSC9   TERM_BUF                 cn=0,n=*X1

      376     7313    4                      EXIT NXTCMD;

   7313  6 000630   001022 710000 6                  TRA     s:7355
         6 000631   000636 710000 6                  TRA     s:7319

      377     7314    4                      END;
      378     7315    4                  ELSE DO;

      379     7316    4                      OUTBUFL = 2;

   7316  6 000632   000002 236007                    LDQ     2,DL
         6 000633   001762 756000 1                  STQ     OUTBUFL

      380     7317    4                      SUBSTR (OUTBUF,0,1) = %TELNET_IAC;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:53   

   7317  6 000634   377000 236003                    LDQ     130560,DU
         6 000635   001142 552040 1                  STBQ    OUTBUF,'40'O

      381     7318    4                      END;

      382     7319    3              CALL XSL$WRITE (I, LCN, OUTBUF, OUTBUFL);

   7319  6 000636   000100 237000 7                  LDAQ    64
         6 000637   200114 757100                    STAQ    J+3,,AUTO
         6 000640   000014 236000 7                  LDQ     12
         6 000641   200113 756100                    STQ     J+2,,AUTO
         6 000642   200004 630500                    EPPR0   I,,AUTO
         6 000643   200112 450500                    STP0    J+1,,AUTO
         6 000644   200112 630500                    EPPR0   J+1,,AUTO
         6 000645   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000646   000000 701000 xent               TSX1    XSL$WRITE
         6 000647   000000 011000                    NOP     0

      383     7320    3              IF TOGGLES(%TCT_OPT_ND)

   7320  6 000650   002125 235000 1                  LDA     TOGGLES+5
         6 000651   001020 600000 6                  TZE     s:7353

      384     7321    3              THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),

   7321  6 000652   001762 236000 1                  LDQ     OUTBUFL
         6 000653   000064 737000                    LLS     52
         6 000654   000140 135007                    SBLA    96,DL
         6 000655   000062 236000 7                  LDQ     50
         6 000656   200112 757100                    STAQ    J+1,,AUTO
         6 000657   200112 630500                    EPPR0   J+1,,AUTO
         6 000660   200116 450500                    STP0    J+5,,AUTO
         6 000661   000070 237000 7                  LDAQ    56
         6 000662   200114 757100                    STAQ    J+3,,AUTO
         6 000663   200114 630500                    EPPR0   J+3,,AUTO
         6 000664   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:54   
         6 000665   000000 701000 xent               TSX1    X$WRITE
         6 000666   000000 011000                    NOP     0
         6 000667   001020 710000 6                  TRA     s:7353

      385     7322    3                        VECTOR(SUBSTR(OUTBUF,0,OUTBUFL)));
      386     7323
      387     7324    3           CASE (%TCT_CMD_SET);

      388     7325    3              IF OUT$BLK.NSUBLKS < 2 THEN CMASK = %ASCBIT(CP6_BRK);

   7325  6 000670   100001 221100                    LDX1    1,,PR1
         6 000671   000002 101003                    CMPX1   2,DU
         6 000672   000676 603000 6                  TRC     s:7326

   7325  6 000673   400000 236003                    LDQ     -131072,DU
         6 000674   001763 756000 1                  STQ     CMASK
         6 000675   000727 710000 6                  TRA     s:7333

      389     7326    3              ELSE IF OUT$BLK.NSUBLKS = 2

   7326  6 000676   000002 101003                    CMPX1   2,DU
         6 000677   000707 601000 6                  TNZ     s:7329

      390     7327    3                  THEN CINIT.C = SUBSTR(OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT,0,1);

   7327  6 000700   100004 473500                    LDP3    4,,PR1
         6 000701   300004 236100                    LDQ     4,,PR3
         6 000702   000033 772000                    QRL     27
         6 000703   300004 236100                    LDQ     4,,PR3
         6 000704   000022 772000                    QRL     18
         6 000705   001763 552004 1                  STBQ    CMASK,'04'O
         6 000706   000727 710000 6                  TRA     s:7333

      391     7328    4                  ELSE DO;

      392     7329    4                      CINIT.C = SUBSTR(OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT,0,1);

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:55   
   7329  6 000707   100005 473500                    LDP3    5,,PR1
         6 000710   300004 236100                    LDQ     4,,PR3
         6 000711   000033 772000                    QRL     27
         6 000712   300004 236100                    LDQ     4,,PR3
         6 000713   000022 772000                    QRL     18
         6 000714   001763 552004 1                  STBQ    CMASK,'04'O

      393     7330    4                      IF CINIT.C = '?' THEN CBIN = 127;

   7330  6 000715   001763 236000 1                  LDQ     CMASK
         6 000716   000777 376007                    ANQ     511,DL
         6 000717   000077 116007                    CMPQ    63,DL
         6 000720   000724 601000 6                  TNZ     s:7331

   7330  6 000721   000177 236007                    LDQ     127,DL
         6 000722   001763 756000 1                  STQ     CMASK
         6 000723   000727 710000 6                  TRA     s:7333

      394     7331    4                      ELSE CBIN = MOD (CBIN, 32);

   7331  6 000724   001763 236000 1                  LDQ     CMASK
         6 000725   000037 376007                    ANQ     31,DL
         6 000726   001763 756000 1                  STQ     CMASK

      395     7332    4                      END;

      396     7333    3              LOCAL_CHAR (OUT$BLK.SUBLK$(0)->OUT$BLK.CODE-240) = CINIT.C;

   7333  6 000727   100003 473500                    LDP3    3,,PR1
         6 000730   300000 236100                    LDQ     0,,PR3
         6 000731   777777 376007                    ANQ     -1,DL
         6 000732   040006 100400                    MLR     fill='040'O
         6 000733   001763 600001 1                  ADSC9   CMASK                    cn=3,n=1
         6 000734   002036 000001 1                  ADSC9   FPT_ERRMSG+8,Q           cn=0,n=1
         6 000735   001020 710000 6                  TRA     s:7353

      397     7334
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:56   
      398     7335    3           CASE (%TCT_CMD_STATUS);

      399     7336    3              CALL X$WRITE (FDS, VECTOR(STATUS_FMT), VECTOR(LINK_UP),

   7336  6 000736   000114 630400 7                  EPPR0   76
         6 000737   000024 631400 xsym               EPPR1   B_VECTNIL+20
         6 000740   000000 701000 xent               TSX1    X$WRITE
         6 000741   000000 011000                    NOP     0
         6 000742   001020 710000 6                  TRA     s:7353

      400     7337    3                    VECTOR(HELLO3.IPNAME), VECTOR(MODE),
      401     7338    3                    VECTOR(LOCAL_CHAR(%TCT_OPT_ESC-240)));
      402     7339
      403     7340    3           CASE (%TCT_CMD_TOGGLE);

      404     7341    4              DO I=0 TO OUT$BLK.NSUBLKS-1;

   7341  6 000743   200004 450100                    STZ     I,,AUTO
         6 000744   001007 710000 6                  TRA     s:7348+1

      405     7342    4                  OUTBUFL = OUT$BLK.SUBLK$(I)->OUT$BLK.CODE;

   7342  6 000745   200005 470500                    LDP0    P$,,AUTO
         6 000746   200004 720100                    LXL0    I,,AUTO
         6 000747   000003 471510                    LDP1    3,X0,PR0
         6 000750   100000 236100                    LDQ     0,,PR1
         6 000751   777777 376007                    ANQ     -1,DL
         6 000752   001762 756000 1                  STQ     OUTBUFL

      406     7343    4                  TOGGLES (OUTBUFL) = ~TOGGLES (OUTBUFL);

   7343  6 000753   002120 236006 1                  LDQ     TOGGLES,QL
         6 000754   000027 676000 xsym               ERQ     B_VECTNIL+23
         6 000755   001762 721000 1                  LXL1    OUTBUFL
         6 000756   002120 756011 1                  STQ     TOGGLES,X1

      407     7344    4                  FMT_1TG.TG = SUBSTR (DISP_FMT.TGA (OUTBUFL), 3);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:57   

   7344  6 000757   001762 236000 1                  LDQ     OUTBUFL
         6 000760   000064 402007                    MPY     52,DL
         6 000761   040000 100406                    MLR     fill='040'O
         6 000762   000237 200060 2                  ADSC9   DISP_FMT+31,Q            cn=1,n=48
         6 000763   002234 400060 1                  ADSC9   FMT_1TG+4                cn=2,n=48

      408     7345    4                  IF OUTBUFL~=%TCT_OPT_CO OR TOGGLES (OUTBUFL)

   7345  6 000764   001762 235000 1                  LDA     OUTBUFL
         6 000765   000010 115007                    CMPA    8,DL
         6 000766   000771 601000 6                  TNZ     s:7346
         6 000767   002120 235005 1                  LDA     TOGGLES,AL
         6 000770   001006 600000 6                  TZE     s:7348

      409     7346    4                  THEN CALL X$WRITE

   7346  6 000771   777640 235007                    LDA     -96,DL
         6 000772   001762 236000 1                  LDQ     OUTBUFL
         6 000773   000022 736000                    QLS     18
         6 000774   000021 036000 7                  ADLQ    17
         6 000775   200112 757100                    STAQ    J+1,,AUTO
         6 000776   200112 631500                    EPPR1   J+1,,AUTO
         6 000777   200116 451500                    STP1    J+5,,AUTO
         6 001000   000032 237000 7                  LDAQ    26
         6 001001   200114 757100                    STAQ    J+3,,AUTO
         6 001002   200114 630500                    EPPR0   J+3,,AUTO
         6 001003   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001004   000000 701000 xent               TSX1    X$WRITE
         6 001005   000000 011000                    NOP     0

      410     7347    4                            (FDS, VECTOR(FMT_1TG), VECTOR(TOGGLES (OUTBUFL)));
      411     7348    4                  END;

   7348  6 001006   200004 054100                    AOS     I,,AUTO
         6 001007   200005 470500                    LDP0    P$,,AUTO
         6 001010   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:58   
         6 001011   000022 772000                    QRL     18
         6 001012   200004 116100                    CMPQ    I,,AUTO
         6 001013   000745 605400 6                  TPNZ    s:7342
         6 001014   001020 710000 6                  TRA     s:7353

      412     7349
      413     7350    3           CASE (ELSE);

      414     7351    3              IF CMD_MODE<0 THEN CMD_MODE = 0;

   7351  6 001015   002070 235000 1                  LDA     CMD_MODE
         6 001016   001020 605000 6                  TPL     s:7353

   7351  6 001017   002070 450000 1                  STZ     CMD_MODE

      415     7352    3              END;

      416     7353    2          END;

   7353  6 001020   002061 235000 1                  LDA     LINK_UP
         6 001021   000057 600000 6                  TZE     NXTCMD

      417     7354
      418     7355    1      SEARCH_TBL = '0'B;

   7355  6 001022   000100 100400                    MLR     fill='000'O
         6 001023   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 001024   200006 000404                    ADSC9   SEARCH_TBL,,AUTO         cn=0,n=260

      419     7356    2      DO I=0 TO %TCT_OPT_ESC-240;          /* forget eof, its just an actchr */

   7356  6 001025   200004 450100                    STZ     I,,AUTO
         6 001026   001057 710000 6                  TRA     s:7361+1

      420     7357    2          IF I=0 AND NOT TOGGLES(%TCT_OPT_LC)

   7357  6 001027   200004 235100                    LDA     I,,AUTO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:59   
         6 001030   001035 601000 6                  TNZ     s:7359
         6 001031   002123 236000 1                  LDQ     TOGGLES+3
         6 001032   001035 601000 6                  TNZ     s:7359

      421     7358    2          THEN I=%ASCBIN(TELNET_DO)-240;   /* skip to cr, or thereabouts */

   7358  6 001033   000015 235007                    LDA     13,DL
         6 001034   200004 755100                    STA     I,,AUTO

      422     7359    2          IF LOCAL_CHAR(I)~=%NC

   7359  6 001035   040000 106405                    CMPC    fill='040'O
         6 001036   002132 000001 1                  ADSC9   LOCAL_CHAR,A             cn=0,n=1
         6 001037   000077 000001 7                  ADSC9   63                       cn=0,n=1
         6 001040   001056 600000 6                  TZE     s:7361

      423     7360    2          THEN SEARCH_TBL (ASCBIN (LOCAL_CHAR(I) ) ) = BINASC (I);

   7360  6 001041   000100 101405                    MRL     fill='000'O
         6 001042   002132 000001 1                  ADSC9   LOCAL_CHAR,A             cn=0,n=1
         6 001043   200112 000004                    ADSC9   J+1,,AUTO                cn=0,n=4
         6 001044   200112 236100                    LDQ     J+1,,AUTO
         6 001045   200113 756100                    STQ     J+2,,AUTO
         6 001046   200004 236100                    LDQ     I,,AUTO
         6 001047   000033 736000                    QLS     27
         6 001050   000046 276000 7                  ORQ     38
         6 001051   200114 756100                    STQ     J+3,,AUTO
         6 001052   200113 235100                    LDA     J+2,,AUTO
         6 001053   040105 100500                    MLR     fill='040'O
         6 001054   200114 000004                    ADSC9   J+3,,AUTO                cn=0,n=4
         6 001055   200006 000001                    ADSC9   SEARCH_TBL,A,AUTO        cn=0,n=1

      424     7361    2          END;

   7361  6 001056   200004 054100                    AOS     I,,AUTO
         6 001057   200004 235100                    LDA     I,,AUTO
         6 001060   000020 115007                    CMPA    16,DL
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:60   
         6 001061   001027 604400 6                  TMOZ    s:7357

      425     7362
      426     7363    1      IF TOGGLES(%TCT_OPT_ST) THEN XLATE_TBL.HIGH = XLATE_TBL.LOW;

   7363  6 001062   002127 236000 1                  LDQ     TOGGLES+7
         6 001063   001070 600000 6                  TZE     s:7364

   7363  6 001064   000000 100400                    MLR     fill='000'O
         6 001065   002251 000200 1                  ADSC9   XLATE_TBL                cn=0,n=128
         6 001066   002311 000200 1                  ADSC9   XLATE_TBL+32             cn=0,n=128
         6 001067   001073 710000 6                  TRA     s:7366

      427     7364    1      ELSE XLATE_TBL.HIGH = XLATE_TBL_HIGH;

   7364  6 001070   000000 100400                    MLR     fill='000'O
         6 001071   000665 000200 2                  ADSC9   XLATE_TBL_HIGH           cn=0,n=128
         6 001072   002311 000200 1                  ADSC9   XLATE_TBL+32             cn=0,n=128

      428     7365
      429     7366    1      ACTCHRS = '0'B;

   7366  6 001073   000000 100400                    MLR     fill='000'O
         6 001074   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 001075   001002 000040 1                  ADSC9   ACTCHRS                  cn=0,n=32

      430     7367    1      EOMTERMINAL.V.TIMEOUT# = 1;

   7367  6 001076   001022 236000 1                  LDQ     EOMTERMINAL+8
         6 001077   000122 376000 7                  ANQ     82
         6 001100   000001 276003                    ORQ     1,DU
         6 001101   001022 756000 1                  STQ     EOMTERMINAL+8

      431     7368    1      READ_TERM.V.DVBYTE.TRANS# = '1'B;

   7368  6 001102   020000 236003                    LDQ     8192,DU
         6 001103   001137 256000 1                  ORSQ    READ_TERM+11
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:61   

      432     7369    1      FPT_WRITE.V.DVBYTE.TRANS# = '1'B;

   7369  6 001104   000765 256000 1                  ORSQ    FPT_WRITE+11

      433     7370    2      IF MODE=%TCT_OPT_LINE THEN DO;

   7370  6 001105   002062 235000 1                  LDA     MODE
         6 001106   000001 115007                    CMPA    1,DL
         6 001107   001151 601000 6                  TNZ     s:7380

      434     7371    2          ACTCHRS(1) = 4;                  /* Cr */

   7371  6 001110   000004 236003                    LDQ     4,DU
         6 001111   001002 552020 1                  STBQ    ACTCHRS,'20'O

      435     7372    2          I = ASCBIN(LOCAL_CHAR(%TCT_OPT_EOF-240));

   7372  6 001112   002136 236000 1                  LDQ     LOCAL_CHAR+4
         6 001113   000022 772000                    QRL     18
         6 001114   000777 376007                    ANQ     511,DL
         6 001115   200004 756100                    STQ     I,,AUTO

      436     7373    2          ACTCHRS(I/8) = ACTCHRS(I/8) + BITS8TO0(MOD(I,8));

   7373  6 001116   000010 506007                    DIV     8,DL
         6 001117   200112 756100                    STQ     J+1,,AUTO
         6 001120   200004 236100                    LDQ     I,,AUTO
         6 001121   000010 506007                    DIV     8,DL
         6 001122   200113 756100                    STQ     J+2,,AUTO
         6 001123   200004 236100                    LDQ     I,,AUTO
         6 001124   000010 506007                    DIV     8,DL
         6 001125   000000 620005                    EAX0    0,AL
         6 001126   200113 235100                    LDA     J+2,,AUTO
         6 001127   000100 101405                    MRL     fill='000'O
         6 001130   001002 000001 1                  ADSC9   ACTCHRS,A                cn=0,n=1
         6 001131   200114 000004                    ADSC9   J+3,,AUTO                cn=0,n=4
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:62   
         6 001132   200114 236100                    LDQ     J+3,,AUTO
         6 001133   000010 036010 2                  ADLQ    BITS8TO0,X0
         6 001134   200115 756100                    STQ     J+4,,AUTO
         6 001135   200112 235100                    LDA     J+1,,AUTO
         6 001136   000005 101500                    MRL     fill='000'O
         6 001137   200115 000004                    ADSC9   J+4,,AUTO                cn=0,n=4
         6 001140   001002 000001 1                  ADSC9   ACTCHRS,A                cn=0,n=1

      437     7374    2          EOMTERMINAL.V.TIMEOUT# = 0;

   7374  6 001141   000122 236000 7                  LDQ     82
         6 001142   001022 356000 1                  ANSQ    EOMTERMINAL+8

      438     7375    2          READ_TERM.V.DVBYTE.TRANS# = '0'B;

   7375  6 001143   000123 236000 7                  LDQ     83
         6 001144   001137 356000 1                  ANSQ    READ_TERM+11

      439     7376    2          FPT_WRITE.V.DVBYTE.TRANS# = '0'B;

   7376  6 001145   000765 356000 1                  ANSQ    FPT_WRITE+11

      440     7377    2          CALL M$PROMPT (NO_PROMPT);

   7377  6 001146   000032 630400 2                  EPPR0   NO_PROMPT
         6 001147   160002 713400                    CLIMB   57346
         6 001150   401000 401760                    pmme    nvectors=3

      441     7378    2          END;

      442     7379
      443     7380    2      IF WAIT_ARS=0 THEN DO;

   7380  6 001151   002071 235000 1                  LDA     WAIT_ARS
         6 001152   001163 601000 6                  TNZ     s:7385

      444     7381    2          IF TOGGLES(%TCT_OPT_CO) THEN GOTO NXTCMD;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:63   

   7381  6 001153   002130 236000 1                  LDQ     TOGGLES+8
         6 001154   000057 601000 6                  TNZ     NXTCMD

      445     7382    2          CALL M$EOM (EOMTERMINAL);

   7382  6 001155   001012 630400 1                  EPPR0   EOMTERMINAL
         6 001156   160003 713400                    CLIMB   57347
         6 001157   401000 401760                    pmme    nvectors=3

      446     7383    2          CALL M$READ (READ_TERM);

   7383  6 001160   001124 630400 1                  EPPR0   READ_TERM
         6 001161   040000 713400                    CLIMB   read
         6 001162   401400 401760                    pmme    nvectors=4

      447     7384    2          END;

      448     7385    1      CALL M$WRITE (WRITE_RECVRQS);

   7385  6 001163   000110 630400 2                  EPPR0   WRITE_RECVRQS
         6 001164   040001 713400                    CLIMB   write
         6 001165   401400 401760                    pmme    nvectors=4

      449     7386    1      CALL M$READ (READ_RECVRSP);

   7386  6 001166   000126 630400 2                  EPPR0   READ_RECVRSP
         6 001167   040000 713400                    CLIMB   read
         6 001170   401400 401760                    pmme    nvectors=4

      450     7387    1      GET_CMD = '0'B;

   7387  6 001171   002067 450000 1                  STZ     GET_CMD

      451     7388
      452     7389    2      DO INHIBIT;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:64   
      453     7390    3          DO WHILE(LINK_UP AND NOT GET_CMD);

   7390  6 001172   001230 710200 6                  TRA   ! s:7400

      454     7391    3              IF ESC_WAIT=0 THEN CALL M$WAIT (WAIT_FOREVER);

   7391  6 001173   002072 235200 1                  LDA   ! ESC_WAIT
         6 001174   001201 601200 6                  TNZ   ! s:7392

   7391  6 001175   000154 630600 2                  EPPR0 ! WAIT_FOREVER
         6 001176   020006 713600                    CLIMB ! 8198
         6 001177   400400 401760                    pmme    nvectors=2
         6 001200   001207 710200 6                  TRA   ! s:7395

      455     7392    4              ELSE CALL M$WAIT (WAIT_AWHILE) WHENRETURN DO;

   7392  6 001201   000162 630600 2                  EPPR0 ! WAIT_AWHILE
         6 001202   420006 713600                    CLIMB ! alt,+8198
         6 001203   400400 401760                    pmme    nvectors=2
         6 001204   001207 702200 6                  TSX2  ! s:7395

      456     7393    4                      CALL LOCAL_INPUT;

   7393  6 001205   001305 701200 6                  TSX1  ! LOCAL_INPUT
         6 001206   000000 011200                    NOP   ! 0

      457     7394    4                      END;

      458     7395    4              DO WHILE TRM_BRK+NET_ARS+TRM_ARS ~= 0;

   7395  6 001207   001224 710200 6                  TRA   ! s:7399

      459     7396    4                  IF TRM_BRK ~= 0 THEN CALL BREAK_INPUT;

   7396  6 001210   002066 235200 1                  LDA   ! TRM_BRK
         6 001211   001214 600200 6                  TZE   ! s:7397

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:65   
   7396  6 001212   001624 701200 6                  TSX1  ! BREAK_INPUT
         6 001213   000000 011200                    NOP   ! 0

      460     7397    4                  IF NET_ARS ~= 0 THEN CALL REMOTE_INPUT;

   7397  6 001214   002064 235200 1                  LDA   ! NET_ARS
         6 001215   001220 600200 6                  TZE   ! s:7398

   7397  6 001216   001646 701200 6                  TSX1  ! REMOTE_INPUT
         6 001217   000000 011200                    NOP   ! 0

      461     7398    4                  IF TRM_ARS ~= 0 THEN CALL LOCAL_INPUT;

   7398  6 001220   002065 235200 1                  LDA   ! TRM_ARS
         6 001221   001224 600200 6                  TZE   ! s:7399

   7398  6 001222   001305 701200 6                  TSX1  ! LOCAL_INPUT
         6 001223   000000 011200                    NOP   ! 0

      462     7399    4                  END;

   7399  6 001224   002066 236200 1                  LDQ   ! TRM_BRK
         6 001225   002064 036200 1                  ADLQ  ! NET_ARS
         6 001226   002065 036200 1                  ADLQ  ! TRM_ARS
         6 001227   001210 601200 6                  TNZ   ! s:7396

      463     7400    3              END;

   7400  6 001230   002061 235200 1                  LDA   ! LINK_UP
         6 001231   001234 600200 6                  TZE   ! s:7403
         6 001232   002067 236200 1                  LDQ   ! GET_CMD
         6 001233   001173 600200 6                  TZE   ! s:7391

      464     7401    2          END;

      465     7402
      466     7403    1      CALL M$TRMPRG (STOPTERMREAD);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:66   

   7403  6 001234   000070 630400 2                  EPPR0   STOPTERMREAD
         6 001235   160004 713400                    CLIMB   57348
         6 001236   400400 401760                    pmme    nvectors=2

      467     7404    1      CALL M$TRMPRG (STOPNETREAD);

   7404  6 001237   000100 630400 2                  EPPR0   STOPNETREAD
         6 001240   160004 713400                    CLIMB   57348
         6 001241   400400 401760                    pmme    nvectors=2

      468     7405    2      DO WHILE '1'B;

      469     7406    2          IF DCBADDR(DCBNUM(M$UC))->F$DCB.FCN.CNT(0) = 0

   7406  6 001242   000000 236007 xsym               LDQ     M$UC,DL
         6 001243   000006 470400 7                  LDP0    6
         6 001244   000000 471500                    LDP1    0,,PR0
         6 001245   100000 473506                    LDP3    0,QL,PR1
         6 001246   300074 236100                    LDQ     60,,PR3
         6 001247   377000 316003                    CANQ    130560,DU
         6 001250   001256 601000 6                  TNZ     s:7408
         6 001251   000000 236007 xsym               LDQ     F$XSL00,DL
         6 001252   100000 473506                    LDP3    0,QL,PR1
         6 001253   300074 236100                    LDQ     60,,PR3
         6 001254   377000 316003                    CANQ    130560,DU
         6 001255   001262 600000 6                  TZE     s:7410

      470     7407    2                AND DCBADDR(DCBNUM(F$XSL00))->F$DCB.FCN.CNT(0) = 0 THEN EXIT;
      471     7408    2          CALL M$WAIT (WAIT_FOREVER);

   7408  6 001256   000154 630400 2                  EPPR0   WAIT_FOREVER
         6 001257   020006 713400                    CLIMB   8198
         6 001260   400400 401760                    pmme    nvectors=2

      472     7409    2          END;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:67   
   7409  6 001261   001242 710000 6                  TRA     s:7406

      473     7410    1      CALL M$EOM (EOMNORMAL);

   7410  6 001262   000056 630400 2                  EPPR0   EOMNORMAL
         6 001263   160003 713400                    CLIMB   57347
         6 001264   401000 401760                    pmme    nvectors=3

      474     7411    1      CALL M$PROMPT (TELNET_PROMPT);

   7411  6 001265   000020 630400 2                  EPPR0   TELNET_PROMPT
         6 001266   160002 713400                    CLIMB   57346
         6 001267   401000 401760                    pmme    nvectors=3

      475     7412    1      IF LINK_UP THEN GOTO NXTCMD;

   7412  6 001270   002061 235000 1                  LDA     LINK_UP
         6 001271   000057 601000 6                  TNZ     NXTCMD

      476     7413    1      CALL XSL$CLOSE (I, LCN);

   7413  6 001272   000014 236000 7                  LDQ     12
         6 001273   200113 756100                    STQ     J+2,,AUTO
         6 001274   200004 630500                    EPPR0   I,,AUTO
         6 001275   200112 450500                    STP0    J+1,,AUTO
         6 001276   200112 630500                    EPPR0   J+1,,AUTO
         6 001277   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 001300   000000 701000 xent               TSX1    XSL$CLOSE
         6 001301   000000 011000                    NOP     0

      477     7414    1      XSL_ERRNO = %E$CONNRESET;

   7414  6 001302   000161 235007                    LDA     113,DL
         6 001303   000000 755000 xsym               STA     XSL_ERRNO

      478     7415    1      GOTO RETALT;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:68   
   7415  6 001304   000422 710000 6                  TRA     RETALT

      479     7416        %EJECT;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:69   
      480     7417    1   LOCAL_INPUT: PROC;

   7417  6 001305   200110 741300       LOCAL_INPUT  STX1  ! SEARCH_TBL+66,,AUTO

      481     7418        %FPT_TRMPRG (FPTN=RESET_BREAK, STCLASS=CONSTANT, RESETBREAK=YES);
      482     7447    2   DCL J SBIN;
      483     7448
      484     7449    2      OUTBUFL = ESC_WAIT;

   7449  6 001306   002072 235000 1                  LDA     ESC_WAIT
         6 001307   001762 755000 1                  STA     OUTBUFL

      485     7450    2      SUBSTR (OUTBUF,0,4) = ESC_CHRS;

   7450  6 001310   002073 236000 1                  LDQ     ESC_CHRS
         6 001311   001142 756000 1                  STQ     OUTBUF

      486     7451    2      CALL XLATE (SUBSTR(TERM_BUF,0,TRM_ARS), XLATE_TBL, TERM_BUF);

   7451  6 001312   002065 720000 1                  LXL0    TRM_ARS
         6 001313   040040 160400                    MVT     fill='040'O
         6 001314   001024 000400 1                  ADSC9   TERM_BUF                 cn=0,n=256
         6 001315   001024 000010 1                  ADSC9   TERM_BUF                 cn=0,n=*X0
         6 001316   002251 000000 1                  ARG     XLATE_TBL

      487     7452    2      I = 0;

   7452  6 001317   200004 450100                    STZ     I,,AUTO

      488     7453    3      DO UNTIL I>=TRM_ARS;

      489     7454    3          CALL SEARCH (J, CBIN, SEARCH_TBL, SUBSTR(TERM_BUF,0,TRM_ARS), I);

   7454  6 001320   002065 236000 1                  LDQ     TRM_ARS
         6 001321   200004 136100                    SBLQ    I,,AUTO
         6 001322   200112 756100                    STQ     J+1,,AUTO
         6 001323   200004 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:70   
         6 001324   200112 720100                    LXL0    J+1,,AUTO
         6 001325   000000 164446                    TCT
         6 001326   001024 000010 1                  ADSC9   TERM_BUF,Q               cn=0,n=*X0
         6 001327   200006 000100                    ARG     SEARCH_TBL,,AUTO
         6 001330   200111 000100                    ARG     J,,AUTO
         6 001331   200111 235100                    LDA     J,,AUTO
         6 001332   000033 771000                    ARL     27
         6 001333   001763 755000 1                  STA     CMASK
         6 001334   200111 551140                    STBA    J,'40'O,AUTO
         6 001335   200111 056100                    ASQ     J,,AUTO

      490     7455    4          IF J>I THEN DO;

   7455  6 001336   200111 116100                    CMPQ    J,,AUTO
         6 001337   001357 605000 6                  TPL     s:7461

      491     7456    4              J = J-I;

   7456  6 001340   200111 236100                    LDQ     J,,AUTO
         6 001341   200004 136100                    SBLQ    I,,AUTO
         6 001342   200111 756100                    STQ     J,,AUTO

      492     7457    4              SUBSTR(OUTBUF,OUTBUFL,J) = SUBSTR(TERM_BUF,I,J);

   7457  6 001343   000000 620006                    EAX0    0,QL
         6 001344   200004 236100                    LDQ     I,,AUTO
         6 001345   200111 721100                    LXL1    J,,AUTO
         6 001346   001762 235000 1                  LDA     OUTBUFL
         6 001347   040045 100446                    MLR     fill='040'O
         6 001350   001024 000010 1                  ADSC9   TERM_BUF,Q               cn=0,n=*X0
         6 001351   001142 000011 1                  ADSC9   OUTBUF,A                 cn=0,n=*X1

      493     7458    4              I = I+J;

   7458  6 001352   200111 036100                    ADLQ    J,,AUTO
         6 001353   200004 756100                    STQ     I,,AUTO

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:71   
      494     7459    4              OUTBUFL = OUTBUFL+J;

   7459  6 001354   001762 236000 1                  LDQ     OUTBUFL
         6 001355   200111 036100                    ADLQ    J,,AUTO
         6 001356   001762 756000 1                  STQ     OUTBUFL

      495     7460    4              END;

      496     7461    3          IF I>=TRM_ARS THEN EXIT;

   7461  6 001357   200004 236100                    LDQ     I,,AUTO
         6 001360   002065 116000 1                  CMPQ    TRM_ARS
         6 001361   001510 605000 6                  TPL     s:7506

   7461  6 001362                       TEST_CHAR    null
      497     7462    3   TEST_CHAR: ;
      498     7463    4          DO CASE (CBIN+240);

   7463  6 001362   001763 235000 1                  LDA     CMASK
         6 001363   000003 135007                    SBLA    3,DL
         6 001364   000016 115007                    CMPA    14,DL
         6 001365   001367 602005 6                  TNC     TEST_CHAR+5,AL
         6 001366   001505 710000 6                  TRA     s:7504
         6 001367   001431 710000 6                  TRA     s:7477
         6 001370   001417 710000 6                  TRA     s:7471
         6 001371   001405 710000 6                  TRA     s:7465
         6 001372   001412 710000 6                  TRA     s:7468
         6 001373   001424 710000 6                  TRA     s:7474
         6 001374   001436 710000 6                  TRA     s:7480
         6 001375   001505 710000 6                  TRA     s:7504
         6 001376   001505 710000 6                  TRA     s:7504
         6 001377   001505 710000 6                  TRA     s:7504
         6 001400   001505 710000 6                  TRA     s:7504
         6 001401   001505 710000 6                  TRA     s:7504
         6 001402   001450 710000 6                  TRA     s:7486
         6 001403   001443 710000 6                  TRA     s:7483
         6 001404   001473 710000 6                  TRA     s:7495
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:72   

      499     7464    4           CASE(%ASCBIN(TELNET_AO));

      500     7465    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_AO));

   7465  6 001405   001762 236000 1                  LDQ     OUTBUFL
         6 001406   040006 100400                    MLR     fill='040'O
         6 001407   000741 000002 2                  ADSC9   RESET_BREAK+11           cn=0,n=2
         6 001410   001142 000002 1                  ADSC9   OUTBUF,Q                 cn=0,n=2

      501     7466    4              GOTO INC_INO;

   7466  6 001411   001466 710000 6                  TRA     INC_INO

      502     7467    4           CASE(%ASCBIN(TELNET_AYT));

      503     7468    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_AYT));

   7468  6 001412   001762 236000 1                  LDQ     OUTBUFL
         6 001413   040006 100400                    MLR     fill='040'O
         6 001414   000742 000002 2                  ADSC9   RESET_BREAK+12           cn=0,n=2
         6 001415   001142 000002 1                  ADSC9   OUTBUF,Q                 cn=0,n=2

      504     7469    4              GOTO INC_INO;

   7469  6 001416   001466 710000 6                  TRA     INC_INO

      505     7470    4           CASE(%ASCBIN(TELNET_IP));

      506     7471    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_IP));

   7471  6 001417   001762 236000 1                  LDQ     OUTBUFL
         6 001420   040006 100400                    MLR     fill='040'O
         6 001421   000743 000002 2                  ADSC9   RESET_BREAK+13           cn=0,n=2
         6 001422   001142 000002 1                  ADSC9   OUTBUF,Q                 cn=0,n=2

      507     7472    4              GOTO INC_INO;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:73   

   7472  6 001423   001466 710000 6                  TRA     INC_INO

      508     7473    4           CASE(%ASCBIN(TELNET_EC));

      509     7474    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_EC));

   7474  6 001424   001762 236000 1                  LDQ     OUTBUFL
         6 001425   040006 100400                    MLR     fill='040'O
         6 001426   000744 000002 2                  ADSC9   RESET_BREAK+14           cn=0,n=2
         6 001427   001142 000002 1                  ADSC9   OUTBUF,Q                 cn=0,n=2

      510     7475    4              GOTO INC_INO;

   7475  6 001430   001466 710000 6                  TRA     INC_INO

      511     7476    4           CASE(%ASCBIN(TELNET_BREAK));

      512     7477    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_BREAK));

   7477  6 001431   001762 236000 1                  LDQ     OUTBUFL
         6 001432   040006 100400                    MLR     fill='040'O
         6 001433   000745 000002 2                  ADSC9   RESET_BREAK+15           cn=0,n=2
         6 001434   001142 000002 1                  ADSC9   OUTBUF,Q                 cn=0,n=2

      513     7478    4              GOTO INC_INO;

   7478  6 001435   001466 710000 6                  TRA     INC_INO

      514     7479    4           CASE(%ASCBIN(TELNET_EL));

      515     7480    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_EL));

   7480  6 001436   001762 236000 1                  LDQ     OUTBUFL
         6 001437   040006 100400                    MLR     fill='040'O
         6 001440   000746 000002 2                  ADSC9   RESET_BREAK+16           cn=0,n=2
         6 001441   001142 000002 1                  ADSC9   OUTBUF,Q                 cn=0,n=2
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:74   

      516     7481    4              GOTO INC_INO;

   7481  6 001442   001466 710000 6                  TRA     INC_INO

      517     7482    4           CASE(%ASCBIN(TELNET_IAC));

      518     7483    4              SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(TELNET_IAC,TELNET_IAC));

   7483  6 001443   001762 236000 1                  LDQ     OUTBUFL
         6 001444   040006 100400                    MLR     fill='040'O
         6 001445   000747 000002 2                  ADSC9   RESET_BREAK+17           cn=0,n=2
         6 001446   001142 000002 1                  ADSC9   OUTBUF,Q                 cn=0,n=2

      519     7484    4              GOTO INC_INO;

   7484  6 001447   001466 710000 6                  TRA     INC_INO

      520     7485    4           CASE(%ASCBIN(TELNET_DONT));     /* really a cr */

      521     7486    4              IF MODE = %TCT_OPT_CHAR

   7486  6 001450   002062 236000 1                  LDQ     MODE
         6 001451   001457 601000 6                  TNZ     s:7489

      522     7487    4              THEN SUBSTR(OUTBUF,OUTBUFL,2) = %(CONCAT(CP6_CR,BINASC(0)));

   7487  6 001452   001762 235000 1                  LDA     OUTBUFL
         6 001453   040005 100400                    MLR     fill='040'O
         6 001454   000750 000002 2                  ADSC9   RESET_BREAK+18           cn=0,n=2
         6 001455   001142 000002 1                  ADSC9   OUTBUF,A                 cn=0,n=2
         6 001456   001466 710000 6                  TRA     INC_INO

      523     7488    5              ELSE DO;

      524     7489    5                  SUBSTR(OUTBUF,OUTBUFL,1) = %CP6_LF;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:75   
   7489  6 001457   001762 235000 1                  LDA     OUTBUFL
         6 001460   040005 100400                    MLR     fill='040'O
         6 001461   000124 000001 7                  ADSC9   84                       cn=0,n=1
         6 001462   001142 000001 1                  ADSC9   OUTBUF,A                 cn=0,n=1

      525     7490    5                  OUTBUFL = OUTBUFL-1;

   7490  6 001463   001762 235000 1                  LDA     OUTBUFL
         6 001464   000001 135007                    SBLA    1,DL
         6 001465   001762 755000 1                  STA     OUTBUFL

      526     7491    5                  END;

      527     7492    4   INC_INO:   OUTBUFL = OUTBUFL+2;

   7492  6 001466   001762 235000 1     INC_INO      LDA     OUTBUFL
         6 001467   000002 035007                    ADLA    2,DL
         6 001470   001762 755000 1                  STA     OUTBUFL

      528     7493    4              I = I+1;

   7493  6 001471   200004 054100                    AOS     I,,AUTO
         6 001472   001505 710000 6                  TRA     s:7504

      529     7494    4           CASE(%TCT_OPT_ESC);

      530     7495    4              GET_CMD = '1'B;

   7495  6 001473   400000 236003                    LDQ     -131072,DU
         6 001474   002067 756000 1                  STQ     GET_CMD

      531     7496    5              IF READ_CMD>0 THEN DO;

   7496  6 001475   002074 235000 1                  LDA     READ_CMD
         6 001476   001502 604400 6                  TMOZ    s:7500

      532     7497    5                  XUG_GETCMD.TEXT_ = VECTOR(READ_YC);
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:76   

   7497  6 001477   000012 237000 7                  LDAQ    10
         6 001500   000034 757000 1                  STAQ    XUG_GETCMD+28

      533     7498    5                  READ_CMD = 0;

   7498  6 001501   002074 450000 1                  STZ     READ_CMD

      534     7499    5                  END;

      535     7500    4              WAIT_ARS = 0;

   7500  6 001502   002071 450000 1                  STZ     WAIT_ARS

      536     7501    4              I = I+1;

   7501  6 001503   200004 054100                    AOS     I,,AUTO
         6 001504   001505 710000 6                  TRA     s:7504

      537     7502    4           CASE(ELSE);

      538     7503    4              END;

      539     7504    3          END;

   7504  6 001505   200004 236100                    LDQ     I,,AUTO
         6 001506   002065 116000 1                  CMPQ    TRM_ARS
         6 001507   001320 604000 6                  TMI     s:7454

      540     7505
      541     7506    3      IF LINK_UP THEN DO;

   7506  6 001510   002061 235000 1                  LDA     LINK_UP
         6 001511   001621 600000 6                  TZE     s:7528

      542     7507    3          ESC_WAIT = 0;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:77   
   7507  6 001512   002072 450000 1                  STZ     ESC_WAIT

      543     7508    4          IF TRM_ARS>0 AND TOGGLES(%TCT_OPT_ED) THEN DO TRM_ARS=1 TO 4;

   7508  6 001513   002065 235000 1                  LDA     TRM_ARS
         6 001514   001552 604400 6                  TMOZ    s:7517
         6 001515   002131 235000 1                  LDA     TOGGLES+9
         6 001516   001552 600000 6                  TZE     s:7517

   7508  6 001517   000001 235007                    LDA     1,DL
         6 001520   002065 755000 1                  STA     TRM_ARS

      544     7509    4              IF TRM_ARS>OUTBUFL THEN EXIT;

   7509  6 001521   001762 236000 1                  LDQ     OUTBUFL
         6 001522   001525 604000 6                  TMI     s:7510
         6 001523   002065 116000 1                  CMPQ    TRM_ARS
         6 001524   001552 604000 6                  TMI     s:7517

      545     7510    5              IF SUBSTR (OUTBUF,OUTBUFL-TRM_ARS,1) = BINASC(27) THEN DO;

   7510  6 001525   002065 136000 1                  SBLQ    TRM_ARS
         6 001526   040000 106406                    CMPC    fill='040'O
         6 001527   001142 000001 1                  ADSC9   OUTBUF,Q                 cn=0,n=1
         6 001530   000125 000001 7                  ADSC9   85                       cn=0,n=1
         6 001531   001546 601000 6                  TNZ     s:7516

      546     7511    5                  ESC_CHRS = SUBSTR (OUTBUF,OUTBUFL-TRM_ARS,4);

   7511  6 001532   001762 236000 1                  LDQ     OUTBUFL
         6 001533   002065 136000 1                  SBLQ    TRM_ARS
         6 001534   040000 100406                    MLR     fill='040'O
         6 001535   001142 000004 1                  ADSC9   OUTBUF,Q                 cn=0,n=4
         6 001536   002073 000004 1                  ADSC9   ESC_CHRS                 cn=0,n=4

      547     7512    5                  ESC_WAIT = TRM_ARS;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:78   
   7512  6 001537   002065 235000 1                  LDA     TRM_ARS
         6 001540   002072 755000 1                  STA     ESC_WAIT

      548     7513    5                  OUTBUFL = OUTBUFL-TRM_ARS;

   7513  6 001541   001762 236000 1                  LDQ     OUTBUFL
         6 001542   002065 136000 1                  SBLQ    TRM_ARS
         6 001543   001762 756000 1                  STQ     OUTBUFL

      549     7514    5                  TRM_ARS = 4;

   7514  6 001544   000004 235007                    LDA     4,DL
         6 001545   002065 755000 1                  STA     TRM_ARS

      550     7515    5                  END;

      551     7516    4              END;

   7516  6 001546   002065 054000 1                  AOS     TRM_ARS
         6 001547   002065 235000 1                  LDA     TRM_ARS
         6 001550   000004 115007                    CMPA    4,DL
         6 001551   001521 604400 6                  TMOZ    s:7509

      552     7517    4          IF OUTBUFL > 0 THEN DO;

   7517  6 001552   001762 235000 1                  LDA     OUTBUFL
         6 001553   001605 600000 6                  TZE     s:7524

      553     7518    4              CALL XSL$WRITE (J, LCN, OUTBUF, OUTBUFL);

   7518  6 001554   000100 237000 7                  LDAQ    64
         6 001555   200114 757100                    STAQ    J+3,,AUTO
         6 001556   000014 236000 7                  LDQ     12
         6 001557   200113 756100                    STQ     J+2,,AUTO
         6 001560   200111 630500                    EPPR0   J,,AUTO
         6 001561   200112 450500                    STP0    J+1,,AUTO
         6 001562   200112 630500                    EPPR0   J+1,,AUTO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:79   
         6 001563   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001564   000000 701000 xent               TSX1    XSL$WRITE
         6 001565   000000 011000                    NOP     0

      554     7519    4              IF TOGGLES(%TCT_OPT_ND)

   7519  6 001566   002125 235000 1                  LDA     TOGGLES+5
         6 001567   001605 600000 6                  TZE     s:7524

      555     7520    4              THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),

   7520  6 001570   001762 236000 1                  LDQ     OUTBUFL
         6 001571   000064 737000                    LLS     52
         6 001572   000140 135007                    SBLA    96,DL
         6 001573   000062 236000 7                  LDQ     50
         6 001574   200112 757100                    STAQ    J+1,,AUTO
         6 001575   200112 630500                    EPPR0   J+1,,AUTO
         6 001576   200116 450500                    STP0    J+5,,AUTO
         6 001577   000070 237000 7                  LDAQ    56
         6 001600   200114 757100                    STAQ    J+3,,AUTO
         6 001601   200114 630500                    EPPR0   J+3,,AUTO
         6 001602   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001603   000000 701000 xent               TSX1    X$WRITE
         6 001604   000000 011000                    NOP     0

      556     7521    4                        VECTOR(SUBSTR(OUTBUF,0,OUTBUFL)));
      557     7522    4              END;

      558     7523
      559     7524    3          IF I>SIZEC(TERM_BUF) THEN RETURN;

   7524  6 001605   200004 235100                    LDA     I,,AUTO
         6 001606   000400 115007                    CMPA    256,DL
         6 001607   001612 604400 6                  TMOZ    s:7525

   7524  6 001610   200110 221300                    LDX1  ! SEARCH_TBL+66,,AUTO
         6 001611   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:80   

      560     7525    3          TRM_ARS = 0;

   7525  6 001612   002065 450000 1                  STZ     TRM_ARS

      561     7526    3          IF NOT TOGGLES(%TCT_OPT_CO) THEN CALL M$READ (READ_TERM);

   7526  6 001613   002130 236000 1                  LDQ     TOGGLES+8
         6 001614   001622 601000 6                  TNZ     s:7529

   7526  6 001615   001124 630400 1                  EPPR0   READ_TERM
         6 001616   040000 713400                    CLIMB   read
         6 001617   401400 401760                    pmme    nvectors=4

      562     7527    3          END;

   7527  6 001620   001622 710000 6                  TRA     s:7529

      563     7528    2      ELSE TRM_ARS = 0;

   7528  6 001621   002065 450000 1                  STZ     TRM_ARS

      564     7529    2      RETURN;

   7529  6 001622   200110 221300                    LDX1  ! SEARCH_TBL+66,,AUTO
         6 001623   000001 702211                    TSX2  ! 1,X1

      565     7530
      566     7531    2   BREAK_INPUT: ENTRY;

   7531  6 001624   200110 741300       BREAK_INPUT  STX1  ! SEARCH_TBL+66,,AUTO

      567     7532    2      CALL M$TRMPRG (RESET_BREAK);

   7532  6 001625   000726 630400 2                  EPPR0   RESET_BREAK
         6 001626   160004 713400                    CLIMB   57348
         6 001627   400400 401760                    pmme    nvectors=2
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:81   

      568     7533    2      TRM_BRK = 0;

   7533  6 001630   002066 450000 1                  STZ     TRM_BRK

      569     7534    2      IF SEARCH_TBL(%ASCBIN(CP6_BRK))=%NC THEN RETURN;

   7534  6 001631   200106 236100                    LDQ     SEARCH_TBL+64,,AUTO
         6 001632   777000 376003                    ANQ     -512,DU
         6 001633   777000 116003                    CMPQ    -512,DU
         6 001634   001637 601000 6                  TNZ     s:7535

   7534  6 001635   200110 221300                    LDX1  ! SEARCH_TBL+66,,AUTO
         6 001636   000001 702211                    TSX2  ! 1,X1

      570     7535    2      I = SIZEC(TERM_BUF);

   7535  6 001637   000400 235007                    LDA     256,DL
         6 001640   200004 755100                    STA     I,,AUTO

      571     7536    2      OUTBUFL = 0;

   7536  6 001641   001762 450000 1                  STZ     OUTBUFL

      572     7537    2      CINIT.C = SEARCH_TBL(%ASCBIN(CP6_BRK));

   7537  6 001642   200106 236100                    LDQ     SEARCH_TBL+64,,AUTO
         6 001643   000033 772000                    QRL     27
         6 001644   001763 552004 1                  STBQ    CMASK,'04'O

      573     7538    2      GOTO TEST_CHAR;

   7538  6 001645   001362 710000 6                  TRA     TEST_CHAR

      574     7539
      575     7540    2   END LOCAL_INPUT;
      576     7541        %EJECT;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:82   
      577     7542    1   REMOTE_INPUT: PROC;

   7542  6 001646   200110 741300       REMOTE_INPUT STX1  ! SEARCH_TBL+66,,AUTO

      578     7543
      579     7544    2   DCL 1 OPTION_REPLY STATIC,
      580     7545    2        2 IAC CHAR(1) INIT(%TELNET_IAC),
      581     7546    2        2 DODONTWONT CHAR(1) INIT(%TELNET_WONT),
      582     7547    2        2 DDW REDEF DODONTWONT UBIN BYTE UNAL,
      583     7548    2        2 OPT CHAR(1),
      584     7549    2        2 OPTN REDEF OPT UBIN BYTE UNAL;
      585     7550    2   DCL SAV_ARS STATIC SBIN INIT(1);
      586     7551    2   DCL SAV_BUF STATIC CHAR(132) INIT('@');
      587     7552
      588     7553                                                /* Scan for iac */
      589     7554    2      OUTBUFL = SAV_ARS;

   7554  6 001647   002352 235000 1                  LDA     SAV_ARS
         6 001650   001762 755000 1                  STA     OUTBUFL

      590     7555    2      SUBSTR(OUTBUF,0,SAV_ARS) = SAV_BUF;  /* Set the vfc character */

   7555  6 001651   000000 620005                    EAX0    0,AL
         6 001652   040040 100400                    MLR     fill='040'O
         6 001653   002353 000204 1                  ADSC9   SAV_BUF                  cn=0,n=132
         6 001654   001142 000010 1                  ADSC9   OUTBUF                   cn=0,n=*X0

      591     7556    2      IF WAIT_ARS>0 THEN CALL INDEX (I, OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT,

   7556  6 001655   002071 235000 1                  LDA     WAIT_ARS
         6 001656   001704 604400 6                  TMOZ    s:7562

   7556  6 001657   200005 470500                    LDP0    P$,,AUTO
         6 001660   000005 471500                    LDP1    5,,PR0
         6 001661   100004 236100                    LDQ     4,,PR1
         6 001662   000033 772000                    QRL     27
         6 001663   200112 451500                    STP1    J+1,,AUTO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:83   
         6 001664   200004 631500                    EPPR1   I,,AUTO
         6 001665   200112 473500                    LDP3    J+1,,AUTO
         6 001666   000021 220003                    LDX0    17,DU
         6 001667   300000 500510                    A9BD    0,X0,PR3
         6 001670   000000 623006                    EAX3    0,QL
         6 001671   000131 630400 1                  EPPR0   NET_BUF
         6 001672   002064 720000 1                  LXL0    NET_ARS
         6 001673   000000 236003                    LDQ     0,DU
         6 001674   000000 701000 xent               TSX1    X66_INDEX
         6 001675   001704 710000 6                  TRA     s:7562

      592     7557    3                SUBSTR (NET_BUF,0,NET_ARS)) WHENRETURN DO;

      593     7558    3              TRM_ARS = WAIT_ARS-1;

   7558  6 001676   002071 235000 1                  LDA     WAIT_ARS
         6 001677   000001 135007                    SBLA    1,DL
         6 001700   002065 755000 1                  STA     TRM_ARS

      594     7559    3              WAIT_ARS = 0;

   7559  6 001701   002071 450000 1                  STZ     WAIT_ARS

      595     7560    3              GET_CMD = '1'B;

   7560  6 001702   400000 236003                    LDQ     -131072,DU
         6 001703   002067 756000 1                  STQ     GET_CMD

      596     7561    3              END;

      597     7562    2      IF TOGGLES(%TCT_OPT_ND)

   7562  6 001704   002125 235000 1                  LDA     TOGGLES+5
         6 001705   001723 600000 6                  TZE     s:7565

      598     7563    2      THEN CALL X$WRITE(FDS, VECTOR(NETIN_FMT), VECTOR(SUBSTR(NET_BUF,0,NET_ARS)));

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:84   
   7563  6 001706   002064 236000 1                  LDQ     NET_ARS
         6 001707   000064 737000                    LLS     52
         6 001710   000140 135007                    SBLA    96,DL
         6 001711   000130 236000 7                  LDQ     88
         6 001712   200112 757100                    STAQ    J+1,,AUTO
         6 001713   200112 630500                    EPPR0   J+1,,AUTO
         6 001714   200116 450500                    STP0    J+5,,AUTO
         6 001715   000132 237000 7                  LDAQ    90
         6 001716   200114 757100                    STAQ    J+3,,AUTO
         6 001717   200114 630500                    EPPR0   J+3,,AUTO
         6 001720   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001721   000000 701000 xent               TSX1    X$WRITE
         6 001722   000000 011000                    NOP     0

      599     7564
      600     7565    3      DO I=0 TO NET_ARS-1;

   7565  6 001723   200004 450100                    STZ     I,,AUTO
         6 001724   002222 710000 6                  TRA     NXT_BYTE+1

      601     7566    3          IF REMOTE_IAC

   7566  6 001725   001765 234000 1                  SZN     REMOTE_IAC
         6 001726   002014 605000 6                  TPL     s:7587

      602     7567    4          THEN DO;

      603     7568    4              REMOTE_IAC = '0'B;

   7568  6 001727   001765 450000 1                  STZ     REMOTE_IAC

      604     7569    5              DO SELECT (SUBSTR(NET_BUF,I,1));

   7569  6 001730   200004 235100                    LDA     I,,AUTO
         6 001731   040000 106405                    CMPC    fill='040'O
         6 001732   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 001733   000134 000001 7                  ADSC9   92                       cn=0,n=1
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:85   
         6 001734   001755 602000 6                  TNC     s:7569+21
         6 001735   001772 600000 6                  TZE     s:7575
         6 001736   040000 106405                    CMPC    fill='040'O
         6 001737   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 001740   000135 000001 7                  ADSC9   93                       cn=0,n=1
         6 001741   001750 602000 6                  TNC     s:7569+16
         6 001742   002006 600000 6                  TZE     s:7579
         6 001743   040000 106405                    CMPC    fill='040'O
         6 001744   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 001745   000136 000001 7                  ADSC9   94                       cn=0,n=1
         6 001746   002013 601000 6                  TNZ     s:7585
         6 001747   001762 710000 6                  TRA     s:7571
         6 001750   040000 106405                    CMPC    fill='040'O
         6 001751   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 001752   000137 000001 7                  ADSC9   95                       cn=0,n=1
         6 001753   002013 601000 6                  TNZ     s:7585
         6 001754   002006 710000 6                  TRA     s:7579
         6 001755   040000 106405                    CMPC    fill='040'O
         6 001756   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 001757   000140 000001 7                  ADSC9   96                       cn=0,n=1
         6 001760   002013 601000 6                  TNZ     s:7585
         6 001761   001772 710000 6                  TRA     s:7575

      605     7570    5                  SELECT (%TELNET_IAC);

      606     7571    5                  SUBSTR(OUTBUF,OUTBUFL,1) = %TELNET_IAC;

   7571  6 001762   001762 236000 1                  LDQ     OUTBUFL
         6 001763   040006 100400                    MLR     fill='040'O
         6 001764   000136 000001 7                  ADSC9   94                       cn=0,n=1
         6 001765   001142 000001 1                  ADSC9   OUTBUF,Q                 cn=0,n=1

      607     7572    5                  OUTBUFL = OUTBUFL+1;

   7572  6 001766   001762 236000 1                  LDQ     OUTBUFL
         6 001767   000001 036007                    ADLQ    1,DL
         6 001770   001762 756000 1                  STQ     OUTBUFL
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:86   
         6 001771   002221 710000 6                  TRA     NXT_BYTE

      608     7573
      609     7574    5                  SELECT (%TELNET_WILL, %TELNET_WONT);

      610     7575    5                  REMOTE_OPTION = '1'B;

   7575  6 001772   400000 236003                    LDQ     -131072,DU
         6 001773   001766 756000 1                  STQ     REMOTE_OPTION

      611     7576    5                  OPTION_REPLY.DODONTWONT = BINASC(ASCBIN(SUBSTR(NET_BUF,I,1))+2);

   7576  6 001774   000100 101405                    MRL     fill='000'O
         6 001775   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 001776   200112 000004                    ADSC9   J+1,,AUTO                cn=0,n=4
         6 001777   200112 236100                    LDQ     J+1,,AUTO
         6 002000   000002 036007                    ADLQ    2,DL
         6 002001   000033 736000                    QLS     27
         6 002002   000046 276000 7                  ORQ     38
         6 002003   000011 772000                    QRL     9
         6 002004   002351 552020 1                  STBQ    OPTION_REPLY,'20'O
         6 002005   002221 710000 6                  TRA     NXT_BYTE

      612     7577
      613     7578    5                  SELECT (%TELNET_DO, %TELNET_DONT);

      614     7579    5                  REMOTE_OPTION='1'B;

   7579  6 002006   400000 236003                    LDQ     -131072,DU
         6 002007   001766 756000 1                  STQ     REMOTE_OPTION

      615     7580    5                  OPTION_REPLY.DODONTWONT = %TELNET_WONT;

   7580  6 002010   000374 236003                    LDQ     252,DU
         6 002011   002351 552020 1                  STBQ    OPTION_REPLY,'20'O
         6 002012   002221 710000 6                  TRA     NXT_BYTE

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:87   
      616     7581
      617     7582    5                  SELECT (ELSE);

      618     7583                                                /* Ignore all commands */
      619     7584    5                  END;

      620     7585    4              END;

   7585  6 002013   002221 710000 6                  TRA     NXT_BYTE

      621     7586
      622     7587    3          ELSE IF REMOTE_OPTION

   7587  6 002014   001766 234000 1                  SZN     REMOTE_OPTION
         6 002015   002101 605000 6                  TPL     s:7606

      623     7588    4              THEN DO;

      624     7589    4                  REMOTE_OPTION = '0'B;

   7589  6 002016   001766 450000 1                  STZ     REMOTE_OPTION

      625     7590    4                  OPTION_REPLY.OPT = SUBSTR(NET_BUF,I,1);

   7590  6 002017   200004 235100                    LDA     I,,AUTO
         6 002020   040000 100405                    MLR     fill='040'O
         6 002021   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 002022   002351 400001 1                  ADSC9   OPTION_REPLY             cn=2,n=1

      626     7591    4                  IF (OPTION_REPLY.OPTN = 1 OR OPTION_REPLY.OPTN = 3)

   7591  6 002023   002351 236000 1                  LDQ     OPTION_REPLY
         6 002024   777000 376007                    ANQ     -512,DL
         6 002025   001000 116007                    CMPQ    512,DL
         6 002026   002031 600000 6                  TZE     s:7591+6
         6 002027   003000 116007                    CMPQ    1536,DL
         6 002030   002066 601000 6                  TNZ     s:7600
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:88   
         6 002031   002063 235000 1                  LDA     MODE_SENT
         6 002032   000004 115007                    CMPA    4,DL
         6 002033   002041 600000 6                  TZE     s:7591+14
         6 002034   002351 236000 1                  LDQ     OPTION_REPLY
         6 002035   000011 772000                    QRL     9
         6 002036   000777 376007                    ANQ     511,DL
         6 002037   002063 116000 1                  CMPQ    MODE_SENT
         6 002040   002066 601000 6                  TNZ     s:7600
         6 002041   002351 236000 1                  LDQ     OPTION_REPLY
         6 002042   000777 376003                    ANQ     511,DU
         6 002043   000374 116003                    CMPQ    252,DU
         6 002044   002066 600000 6                  TZE     s:7600

      627     7592    4                        AND (MODE_SENT = 4 OR MODE_SENT = OPTION_REPLY.OPTN)
      628     7593    5                        AND OPTION_REPLY.DODONTWONT ~= %TELNET_WONT THEN DO;

      629     7594    5                      MODE_SENT = MODE_SENT - OPTION_REPLY.OPTN;

   7594  6 002045   002351 236000 1                  LDQ     OPTION_REPLY
         6 002046   000011 772000                    QRL     9
         6 002047   000777 376007                    ANQ     511,DL
         6 002050   200112 756100                    STQ     J+1,,AUTO
         6 002051   002063 236000 1                  LDQ     MODE_SENT
         6 002052   200112 136100                    SBLQ    J+1,,AUTO
         6 002053   002063 756000 1                  STQ     MODE_SENT

      630     7595    5                      IF OPTION_REPLY.DDW-ASCBIN(%TELNET_DO) = MODE-%TCT_OPT_CHAR

   7595  6 002054   002351 236000 1                  LDQ     OPTION_REPLY
         6 002055   000022 772000                    QRL     18
         6 002056   000777 376007                    ANQ     511,DL
         6 002057   000375 136007                    SBLQ    253,DL
         6 002060   002062 116000 1                  CMPQ    MODE
         6 002061   002221 600000 6                  TZE     NXT_BYTE

      631     7596    5                      THEN GOTO NXT_BYTE;  /* Agreement, no response needed */
      632     7597    5                      OPTION_REPLY.DDW = ASCBIN(%TELNET_DO)+MODE-%TCT_OPT_CHAR;
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:89   

   7597  6 002062   002062 236000 1                  LDQ     MODE
         6 002063   000375 036007                    ADLQ    253,DL
         6 002064   000022 736000                    QLS     18
         6 002065   002351 552020 1                  STBQ    OPTION_REPLY,'20'O

      633     7598    5                      END;

      634     7599
      635     7600    4                  CALL XSL$WRITE(FPT_WRITE.BUF_,LCN,OPTION_REPLY,3);

   7600  6 002066   000141 630400 7                  EPPR0   97
         6 002067   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 002070   000000 701000 xent               TSX1    XSL$WRITE
         6 002071   000000 011000                    NOP     0

      636     7601    4                  IF TOGGLES(%TCT_OPT_ND)

   7601  6 002072   002125 235000 1                  LDA     TOGGLES+5
         6 002073   002221 600000 6                  TZE     NXT_BYTE

      637     7602    4                  THEN CALL X$WRITE (FDS, VECTOR(NETOUT_FMT),

   7602  6 002074   000150 630400 7                  EPPR0   104
         6 002075   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 002076   000000 701000 xent               TSX1    X$WRITE
         6 002077   000000 011000                    NOP     0

      638     7603    4                            VECTOR(OPTION_REPLY));
      639     7604    4                  END;

   7604  6 002100   002221 710000 6                  TRA     NXT_BYTE

      640     7605
      641     7606    4              ELSE IF REMOTE_CR THEN DO;

   7606  6 002101   001764 234000 1                  SZN     REMOTE_CR
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:90   
         6 002102   002126 605000 6                  TPL     s:7615

      642     7607    4                      REMOTE_CR = '0'B;

   7607  6 002103   001764 450000 1                  STZ     REMOTE_CR

      643     7608    4                      IF SUBSTR(NET_BUF,I,1) = %CP6_LF

   7608  6 002104   200004 235100                    LDA     I,,AUTO
         6 002105   040000 106405                    CMPC    fill='040'O
         6 002106   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 002107   000124 000001 7                  ADSC9   84                       cn=0,n=1
         6 002110   002121 601000 6                  TNZ     s:7613
         6 002111   200003 470500                    LDP0    M$LO$,,AUTO
         6 002112   000004 236100                    LDQ     4,,PR0
         6 002113   020000 316007                    CANQ    8192,DL
         6 002114   002121 601000 6                  TNZ     s:7613

      644     7609    5                            AND NOT M$LO$->F$DCB.DDEV.UCOUT# THEN DO;

      645     7610    5                          OUTBUFL = OUTBUFL-1;

   7610  6 002115   001762 235000 1                  LDA     OUTBUFL
         6 002116   000001 135007                    SBLA    1,DL
         6 002117   001762 755000 1                  STA     OUTBUFL

      646     7611    5                          GOTO LINE_OUT;

   7611  6 002120   002160 710000 6                  TRA     LINE_OUT

      647     7612    5                          END;
      648     7613    4                      IF SUBSTR(NET_BUF,I,1) ~= BINASC(0) THEN GOTO COPY_CHR;

   7613  6 002121   040000 106405                    CMPC    fill='040'O
         6 002122   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 002123   000046 000001 7                  ADSC9   38                       cn=0,n=1
         6 002124   002211 601000 6                  TNZ     COPY_CHR
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:91   

      649     7614    4                      END;

   7614  6 002125   002221 710000 6                  TRA     NXT_BYTE

      650     7615    4                  ELSE DO SELECT (SUBSTR(NET_BUF,I,1));

   7615  6 002126   200004 235100                    LDA     I,,AUTO
         6 002127   040000 106405                    CMPC    fill='040'O
         6 002130   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 002131   000076 000001 7                  ADSC9   62                       cn=0,n=1
         6 002132   002141 602000 6                  TNC     s:7615+11
         6 002133   002151 600000 6                  TZE     s:7620
         6 002134   040000 106405                    CMPC    fill='040'O
         6 002135   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 002136   000136 000001 7                  ADSC9   94                       cn=0,n=1
         6 002137   002211 601000 6                  TNZ     COPY_CHR
         6 002140   002146 710000 6                  TRA     s:7618
         6 002141   040000 106405                    CMPC    fill='040'O
         6 002142   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 002143   000124 000001 7                  ADSC9   84                       cn=0,n=1
         6 002144   002211 601000 6                  TNZ     COPY_CHR
         6 002145   002154 710000 6                  TRA     s:7623

      651     7616
      652     7617    4                      SELECT (%TELNET_IAC);

      653     7618    4                      REMOTE_IAC = '1'B;

   7618  6 002146   400000 236003                    LDQ     -131072,DU
         6 002147   001765 756000 1                  STQ     REMOTE_IAC
         6 002150   002221 710000 6                  TRA     NXT_BYTE

      654     7619    4                      SELECT (%CP6_CR);

      655     7620    4                      REMOTE_CR = '1'B;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:92   
   7620  6 002151   400000 236003                    LDQ     -131072,DU
         6 002152   001764 756000 1                  STQ     REMOTE_CR

      656     7621    4                      GOTO COPY_CHR;

   7621  6 002153   002211 710000 6                  TRA     COPY_CHR

      657     7622    4                      SELECT (%CP6_LF);

      658     7623    5                      IF NOT M$LO$->F$DCB.DDEV.UCOUT# THEN DO;

   7623  6 002154   200003 470500                    LDP0    M$LO$,,AUTO
         6 002155   000004 236100                    LDQ     4,,PR0
         6 002156   020000 316007                    CANQ    8192,DL
         6 002157   002176 601000 6                  TNZ     s:7631

      659     7624    5   LINE_OUT:              SUBSTR(OUTBUF,0,1)='A';

   7624  6 002160   101000 236003       LINE_OUT     LDQ     33280,DU
         6 002161   001142 552040 1                  STBQ    OUTBUF,'40'O

      660     7625    5                          FPT_WRITE.BUF_ = VECTOR(ADDR(OUTBUF)->CHARN);

   7625  6 002162   001762 235000 1                  LDA     OUTBUFL
         6 002163   000020 735000                    ALS     16
         6 002164   000140 135007                    SBLA    96,DL
         6 002165   000062 236000 7                  LDQ     50
         6 002166   000756 757000 1                  STAQ    FPT_WRITE+4

      661     7626    5                          CALL M$WRITE (FPT_WRITE);

   7626  6 002167   000752 630400 1                  EPPR0   FPT_WRITE
         6 002170   040001 713400                    CLIMB   write
         6 002171   401400 401760                    pmme    nvectors=4

      662     7627    5                          OUTBUFL = 1;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:93   
   7627  6 002172   000001 235007                    LDA     1,DL
         6 002173   001762 755000 1                  STA     OUTBUFL

      663     7628    5                          SAV_ARS = 1;

   7628  6 002174   002352 755000 1                  STA     SAV_ARS

      664     7629    5                          GOTO NXT_BYTE;

   7629  6 002175   002221 710000 6                  TRA     NXT_BYTE

      665     7630    5                          END;
      666     7631    5                      IF MODE= %TCT_OPT_LINE THEN DO;

   7631  6 002176   002062 235000 1                  LDA     MODE
         6 002177   000001 115007                    CMPA    1,DL
         6 002200   002210 601000 6                  TNZ     s:7635

      667     7632    5                          SUBSTR(OUTBUF,OUTBUFL,1) = %CP6_CR;

   7632  6 002201   001762 235000 1                  LDA     OUTBUFL
         6 002202   040005 100400                    MLR     fill='040'O
         6 002203   000076 000001 7                  ADSC9   62                       cn=0,n=1
         6 002204   001142 000001 1                  ADSC9   OUTBUF,A                 cn=0,n=1

      668     7633    5                          OUTBUFL = OUTBUFL+1;

   7633  6 002205   001762 235000 1                  LDA     OUTBUFL
         6 002206   000001 035007                    ADLA    1,DL
         6 002207   001762 755000 1                  STA     OUTBUFL

      669     7634    5                          END;

      670     7635    4                      GOTO COPY_CHR;

   7635  6 002210   002211 710000 6                  TRA     COPY_CHR

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:94   
      671     7636    4                      SELECT (ELSE);

   7636  6 002211                       COPY_CHR     null
      672     7637    4   COPY_CHR:      ;
      673     7638    4                  SUBSTR(OUTBUF,OUTBUFL,1) = SUBSTR(NET_BUF,I,1);

   7638  6 002211   200004 235100                    LDA     I,,AUTO
         6 002212   001762 236000 1                  LDQ     OUTBUFL
         6 002213   040006 100405                    MLR     fill='040'O
         6 002214   000131 000001 1                  ADSC9   NET_BUF,A                cn=0,n=1
         6 002215   001142 000001 1                  ADSC9   OUTBUF,Q                 cn=0,n=1

      674     7639    4                  OUTBUFL = OUTBUFL+1;

   7639  6 002216   001762 236000 1                  LDQ     OUTBUFL
         6 002217   000001 036007                    ADLQ    1,DL
         6 002220   001762 756000 1                  STQ     OUTBUFL

      675     7640    4                      END;

   7640  6 002221                       NXT_BYTE     null
      676     7641
      677     7642    3   NXT_BYTE: ;
      678     7643    3          END;                             /* Do to EVT.ARS */

   7643  6 002221   200004 054100                    AOS     I,,AUTO
         6 002222   200004 236100                    LDQ     I,,AUTO
         6 002223   002064 116000 1                  CMPQ    NET_ARS
         6 002224   001725 604000 6                  TMI     s:7566

      679     7644
      680     7645    2      NET_ARS = 0;

   7645  6 002225   002064 450000 1                  STZ     NET_ARS

      681     7646    2      CALL M$WRITE (WRITE_RECVRQS);

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:95   
   7646  6 002226   000110 630400 2                  EPPR0   WRITE_RECVRQS
         6 002227   040001 713400                    CLIMB   write
         6 002230   401400 401760                    pmme    nvectors=4

      682     7647    2      CALL M$READ (READ_RECVRSP);

   7647  6 002231   000126 630400 2                  EPPR0   READ_RECVRSP
         6 002232   040000 713400                    CLIMB   read
         6 002233   401400 401760                    pmme    nvectors=4

      683     7648
      684     7649    2      FPT_WRITE.BUF_=VECTOR(ADDR(OUTBUF)->CHARN);

   7649  6 002234   001762 235000 1                  LDA     OUTBUFL
         6 002235   000020 735000                    ALS     16
         6 002236   000140 135007                    SBLA    96,DL
         6 002237   000062 236000 7                  LDQ     50
         6 002240   000756 757000 1                  STAQ    FPT_WRITE+4

      685     7650    3      IF OUTBUFL > 1 THEN DO;

   7650  6 002241   001762 235000 1                  LDA     OUTBUFL
         6 002242   000002 115007                    CMPA    2,DL
         6 002243   002272 602000 6                  TNC     s:7659

      686     7651    3          SAV_ARS = 1;

   7651  6 002244   000001 235007                    LDA     1,DL
         6 002245   002352 755000 1                  STA     SAV_ARS

      687     7652    4          IF NOT M$LO$->F$DCB.DDEV.UCOUT# THEN DO;

   7652  6 002246   200003 470500                    LDP0    M$LO$,,AUTO
         6 002247   000004 236100                    LDQ     4,,PR0
         6 002250   020000 316007                    CANQ    8192,DL
         6 002251   002267 601000 6                  TNZ     s:7657

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:96   
      688     7653    4              SAV_BUF = SUBSTR (OUTBUF,0,OUTBUFL);

   7653  6 002252   001762 720000 1                  LXL0    OUTBUFL
         6 002253   040000 100440                    MLR     fill='040'O
         6 002254   001142 000010 1                  ADSC9   OUTBUF                   cn=0,n=*X0
         6 002255   002353 000204 1                  ADSC9   SAV_BUF                  cn=0,n=132

      689     7654    4              SUBSTR (SAV_BUF,0,1) = '@';

   7654  6 002256   100000 236003                    LDQ     32768,DU
         6 002257   002353 552040 1                  STBQ    SAV_BUF,'40'O

      690     7655    4              SAV_ARS = MINIMUM (OUTBUFL, SIZEC(SAV_BUF));

   7655  6 002260   000204 236007                    LDQ     132,DL
         6 002261   001762 116000 1                  CMPQ    OUTBUFL
         6 002262   002265 602000 6                  TNC     s:7655+5
         6 002263   002265 600000 6                  TZE     s:7655+5
         6 002264   001762 236000 1                  LDQ     OUTBUFL
         6 002265   002352 756000 1                  STQ     SAV_ARS

      691     7656    4              END;

   7656  6 002266   002272 710000 6                  TRA     s:7659

      692     7657    3          ELSE CALL M$WRITE (FPT_WRITE);

   7657  6 002267   000752 630400 1                  EPPR0   FPT_WRITE
         6 002270   040001 713400                    CLIMB   write
         6 002271   401400 401760                    pmme    nvectors=4

      693     7658    3          END;

      694     7659    2      RETURN;

   7659  6 002272   200110 221300                    LDX1  ! SEARCH_TBL+66,,AUTO
         6 002273   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:97   

XUG_GETCMD
 Sect OctLoc
   1     000   000000 006000   000000 006014   000000 006014   000000 006014    ................
   1     004   000000 006014   000000 006014   240000 000000   04000* ***000    ............ ...
   1     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     014   000000 000000   000000 000000   000000 000000   000000 177640    ................
   1     020   000000 006014   000000 177640   000000 006014   000000 177640    ................
   1     024   000000 006014   000001 777640   000000 006000   000000 177640    ................
   1     030   000000 006014   000000 000000   000000 000000   000000 000000    ................
   1     034   000000 177640   000000 006014   000000 006014   000000 000000    ................
   1     040   000000 006014   000000 006014   000000 006014   000000 006014    ................
   1     044   000000 006014   000000 006014   000000 000000   000000 000000    ................
   1     050   000000 000000   000000 000000                                    ........

XUG_INIT
 Sect OctLoc
   1     052   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     062*  000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     066   000000 006014   000000 177640   000000 006014   000000 006014    ................
   1     072   000000 006014   000000 177640   000000 006014   000000 000454    ................
   1     076   000144 000144   000000 000000   670000 000000   000000 000000    .d.d............
   1     102   000000 000000   000000 000000   000000 000000   000000 006014    ................
   1     106   000000 006014   000000 006014   000000 006014   000000 006014    ................
   1     112   00000* ******   000000 000000   000000 000000   000000 000000    ................

FS
 Sect OctLoc
   1     116   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     122   000000 ******                                                    ....

LS
 Sect OctLoc
   1     123   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     127   000000 ******                                                    ....

NET_BUF
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:98   
 Sect OctLoc
   1     131   ****** ******   ****** ******   ****** ******   ****** ******    ................

FPT_WRITE
 Sect OctLoc
   1     752   000003 777640   000762 006000   000000 177640   000000 006014    ................
   1     756   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     762   000000 400400   000000 000000   000000 000000   120000 000000    ............P...

WRITE_LO
 Sect OctLoc
   1     766   000003 777640   000776 006000   000000 177640   000000 006014    ................
   1     772   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     776   000000 400400   000000 000000   000000 000000   000000 000000    ................

ACTCHRS
 Sect OctLoc
   1    1002   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    1006   000000 000000   000000 000000   000000 000000   000000 000000    ................

EOMTERMINAL
 Sect OctLoc
   1    1012   000003 777640   001020 006000   000000 177640   000000 006014    ................
   1    1016   000007 777640   001002 006000   000000 000000   000000 000000    ................
   1    1022   000001 000000   000000 000000                                    ........

TERM_BUF
 Sect OctLoc
   1    1024   ****** ******   ****** ******   ****** ******   ****** ******    ................

READ_TERM
 Sect OctLoc
   1    1124   000005 777640   001134 006000   000000 177640   000000 006014    .....\..........
   1    1130   000077 777640   001024 006000   000000 177640   000000 006014    .?..............
   1    1134   000000 000000   000000 000001   000000 000000   020000 000000    ................
   1    1140   000000 000000   000000 000000                                    ........

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:99   
OUTBUF
 Sect OctLoc
   1    1142   ****** ******   ****** ******   ****** ******   ****** ******    ................

FMTBUF
 Sect OctLoc
   1    1452   ****** ******   ****** ******   ****** ******   ****** ******    ................

CMASK
 Sect OctLoc
   1    1763   000000 000000                                                    ....

REMOTE_CR
 Sect OctLoc
   1    1764   0***** ******                                                    ....

REMOTE_IAC
 Sect OctLoc
   1    1765   0***** ******                                                    ....

REMOTE_OPTION
 Sect OctLoc
   1    1766   0***** ******                                                    ....

HELLO
 Sect OctLoc
   1    1767   124105 114116   105124 040166   145162 163151   157156 040060    TELNET version 0
   1    1773   056061 040040   040*** ******                                    .1   ...

HELLO2
 Sect OctLoc
   1    1775   101164 164145   155160 164151   156147 040143   157156 156145    Attempting conne
   1    2001   143164 151157   156040 164157   040*** ******   ****** ******    ction to .......
   1    2005   ****** ******   ****** ******   ****** ******                    ............

HELLO3
 Sect OctLoc
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:100  
   1    2010   103157 156156   145143 164145   144040 164157   040040 040040    Connected to
   1    2014   040040 040040   040040 040040   040040 040040   040040 040040
   1    2024*  040040 040040   040*** ******                                         ...

FPT_ERRMSG
 Sect OctLoc
   1    2026   000003 777640   002054 006000   000000 777640   002060 006000    .....,.......0..
   1    2032   000307 777640   001142 006000   000000 177640   000000 006014    .....b..........
   1    2036   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1    2052*  000000 177640   000000 006014   000000 000000   000000 000000    ................
   1    2056   371000 130001   040000 000000                                    ..X. ...

ERR_CODE
 Sect OctLoc
   1    2060   302314 000000                                                    ....

LINK_UP
 Sect OctLoc
   1    2061   000000 000000                                                    ....

MODE
 Sect OctLoc
   1    2062   000000 000000                                                    ....

MODE_SENT
 Sect OctLoc
   1    2063   000000 000000                                                    ....

NET_ARS
 Sect OctLoc
   1    2064   000000 000000                                                    ....

TRM_ARS
 Sect OctLoc
   1    2065   000000 000000                                                    ....

TRM_BRK
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:101  
 Sect OctLoc
   1    2066   000000 000000                                                    ....

GET_CMD
 Sect OctLoc
   1    2067   000000 000000                                                    ....

CMD_MODE
 Sect OctLoc
   1    2070   777777 777777                                                    ....

WAIT_ARS
 Sect OctLoc
   1    2071   000000 000000                                                    ....

ESC_WAIT
 Sect OctLoc
   1    2072   000000 000000                                                    ....

READ_CMD
 Sect OctLoc
   1    2074   777777 777777                                                    ....

READ_YC
 Sect OctLoc
   1    2075   041101 104112   125123 124040   115044 123111   040115 105040    !ADJUST M$SI ME
   1    2101   040040 040040   040040 040040   040040 040040   040040 040040
   1    2115*  040040 040040   040040 040040   040*** ******                             ...

TOGGLES
 Sect OctLoc
   1    2120   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    2124   000000 000000   000000 000000   000000 000000   777777 777777    ................
   1    2130   000000 000000   777777 777777                                    ........

LOCAL_CHAR
 Sect OctLoc
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:102  
   1    2132   777777 777777   031777 777177   030777 777777   777777 015377    ................
   1    2136   400004 777777                                                    ....

FDS
 Sect OctLoc
   1    2137   000000 177640   000000 006014   000000 000000   000000 000000    ................
   1    2143   000000 000000   000307 777640   001452 006000   000000 000001    ................
   1    2147   000000 000000   000000 000000   000000 006014   000000 101500    ..............A.
   1    2153   000000 000000   000000 000000   000000 000001   000000 000012    ................
   1    2157   000000 000000   ****** ******   ****** ******   000000 000000    ................
   1    2163   000000 000000   000000 000000   000000 000000   000000 006014    ................
   1    2167   000000 006014   000000 006014   000000 006014   000000 000000    ................
   1    2173   000000 000000   000000 000000                                    ........

FMT_1CH
 Sect OctLoc
   1    2175   133045 056071   116072 075133   136100 045065   061061 077165    [%.9N:=[^@%511?u
   1    2201   156144 145146   045061 062067   077136 077045   062065 066077    ndef%127?^?%256?
   1    2205   142162 145141   153045 077045   056043 072063   053072 065057    break%?%.#:3+:5/
   1    2211   072066 077133   136045 061056   043072 066064   053113 101045    :6?[^%1.#:64+KA%
   1    2215   061077 045061   056043 113101   045077 136045   061056 043072    1?%1.#KA%?^%1.#:
   1    2221   071066 053113   101045 135045   135135 045055   ****** ******    96+KA%]%]]%-....
   1    2225   ****** ******   ****** ******   ****** ***121                    ...........Q

FMT_1TG
 Sect OctLoc
   1    2230   045116 133167   157156 047164   040045 077167   151154 154040    %N[won't %?will
   1    2234   045135 ******   ****** ******   ****** ******   ****** ******    %]..............
   1    2250*  ****** 121***                                                    ..Q.

XLATE_TBL
 Sect OctLoc
   1    2251   000001 002003   004005 006007   010011 012013   014015 016017    ................
   1    2255   020021 022023   024025 026027   030031 032033   034035 036037    ................
   1    2261   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
   1    2265   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
   1    2271   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:103  
   1    2275   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
   1    2301   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
   1    2305   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.
   1    2345*  ****** ******   ****** ******   ****** ******   ****** ******    ................

OPTION_REPLY
 Sect OctLoc
   1    2351   377374 ******                                                    ....

SAV_ARS
 Sect OctLoc
   1    2352   000000 000001                                                    ....

SAV_BUF
 Sect OctLoc
   1    2353   100040 040040   040040 040040   040040 040040   040040 040040    @
   1    2357   040040 040040   040040 040040   040040 040040   040040 040040
   1    2413*  040040 040040

PROMPT
 Sect OctLoc
   2     000   040124 145154   156145 164076                                     Telnet>

TCT_SOCKINIT
 Sect OctLoc
   2     002   000000 000002   000000 000000   000000 001000   000000 006014    ................
   2     006   000000 000000   000002 000000                                    ........

BITS8TO0
 Sect OctLoc
   2     010   000000 000200   000000 000100   000000 000040   000000 000020    .......@... ....
   2     014   000000 000010   000000 000004   000000 000002   000000 000001    ................

TELNET_PROMPT
 Sect OctLoc
   2     020   000003 777640   000026 006000   000000 177640   000000 006014    ................
   2     024   000001 777640   000000 006000   000000 000000   000000 000000    ................
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:104  
   2     030   000000 000000   000000 000000                                    ........

NO_PROMPT
 Sect OctLoc
   2     032   000003 777640   000040 006000   000000 177640   000000 006014    ..... ..........
   2     036   000000 177640   000044 006000   000000 000000   000000 000000    .....$..........
   2     042   100000 000000   000000 000000                                    @.......

ATPROMPT
 Sect OctLoc
   2     044   100*** ******                                                    @...

ACTNORMAL
 Sect OctLoc
   2     046   010054 000057   000000 000000   000000 000000   000000 000000    .,./............
   2     052   010054 000057   000000 000000   000000 000000   000000 000000    .,./............

EOMNORMAL
 Sect OctLoc
   2     056   000003 777640   000064 006000   000000 177640   000000 006014    .....4..........
   2     062   000007 777640   000046 006000   000000 000000   000000 000000    .....&..........
   2     066   001000 000000   000000 000000                                    ........

STOPTERMREAD
 Sect OctLoc
   2     070   000003 777640   000074 006000   000000 177640   000000 006014    .....<..........
   2     074   000000 000000   000000 000000   010000 000000   000000 000000    ................

STOPNETREAD
 Sect OctLoc
   2     100   000003 777640   000104 006000   000000 177640   000000 006014    .....D..........
   2     104   000000 000000   000000 000000   010000 000000   000000 000000    ................

WRITE_RECVRQS
 Sect OctLoc
   2     110   000003 777640   000120 006000   000001 377640   000124 006000    .....P.......T..
   2     114   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:105  
   2     120   000000 400400   000000 000000   000000 000000   000000 000000    ................

XSL_RCVRQS
 Sect OctLoc
   2     124   000015 000000   003100 ******                                    .....@..

READ_RECVRSP
 Sect OctLoc
   2     126   000005 777640   000136 006000   000015 177640   002010 006000    .....^..........
   2     132   000617 777640   000131 006000   000000 177640   000000 006014    .....Y..........
   2     136   000000 000000   000000 000012   000000 000000   000000 000000    ................
   2     142   000000 000000   000000 000000                                    ........

FPT_EVENT
 Sect OctLoc
   2     144   000001 777640   000146 006000   000000 000000   000000 000000    .....f..........

FPT_INT
 Sect OctLoc
   2     150   000001 777640   000152 006000   000000 000000   000000 000000    .....j..........

WAIT_FOREVER
 Sect OctLoc
   2     154   000001 777640   000160 006000   000000 177640   000000 006014    .....p..........
   2     160   000000 013560   000000 000001                                    ........

WAIT_AWHILE
 Sect OctLoc
   2     162   000001 777640   000166 006000   000000 177640   000000 006014    .....v..........
   2     166   000000 000012   000000 000005                                    ........

MSG_NO_LINK
 Sect OctLoc
   2     170   116157 164040   143157 156156   145143 164145   144040 055040    Not connected -
   2     174   165163 145040   157160 145156   040146 151162   163164 056***    use open first..

DISP_FMT
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:106  
 Sect OctLoc
   2     200   045056 061103   045116 133167   157156 047164   040045 077167    %.1C%N[won't %?w
   2     204   151154 154040   045135 045103   045056 062103   133045 056071    ill %]%C%.2C[%.9
   2     210   116072 075133   136100 045065   061061 077165   156144 145146    N:=[^@%511?undef
   2     214   045061 062067   077136 077045   062065 066077   142162 145141    %127?^?%256?brea
   2     220   153045 077045   056043 072063   053072 065057   072066 077133    k%?%.#:3+:5/:6?[
   2     224   136045 061056   043072 066064   053113 101045   061077 045061    ^%1.#:64+KA%1?%1
   2     230   056043 113101   045077 136045   061056 043072   071066 053113    .#KA%?^%1.#:96+K
   2     234   101045 135045   135135 045055   045103 045061   103146 154165    A%]%]]%-%C%1Cflu
   2     240   163150 040157   165164 160165   164040 167150   145156 040163    sh output when s
   2     244   145156 144151   156147 040151   156164 145162   162165 160164    ending interrupt
   2     250   040143 150141   162141 143164   145162 163056   045057 045061     characters.%/%1
   2     254   103163 145156   144040 151156   164145 162162   165160 164040    Csend interrupt
   2     260   143150 141162   141143 164145   162163 040151   156040 165162    characters in ur
   2     264   147145 156164   040155 157144   145056 045060   060060 060060    gent mode.%00000
   2     270   060057 045061   103155 141160   040143 141162   162151 141147    0/%1Cmap carriag
   2     274   145040 162145   164165 162156   040157 156040   157165 164160    e return on outp
   2     300   165164 056045   060060 060060   060060 060060   060060 060060    ut.%000000000000
   2     304   060060 060060   060057 045061   103162 145143   157147 156151    00000/%1Crecogni
   2     310   172145 040143   145162 164141   151156 040143   157156 164162    ze certain contr
   2     314   157154 040143   150141 162141   143164 145162   163056 045060    ol characters.%0
   2     320   060060 060060   060060 060060   060057 045061   103160 162157    000000000/%1Cpro
   2     324   166151 144145   040144 145142   165147 147151   156147 040151    vide debugging i
   2     330   156146 157162   155141 164151   157156 056045   060060 060060    nformation.%0000
   2     334   060060 060060   060060 060060   060060 060060   060057 045061    0000000000000/%1
   2     340   103144 151163   160154 141171   040156 145164   167157 162153    Cdisplay network
   2     344   040164 162141   146146 151143   040151 156040   150145 170056     traffic in hex.
   2     350   045060 060060   060060 060060   060060 060060   060060 060060    %000000000000000
   2     354   060057 045061   103144 151163   160154 141171   040157 160164    0/%1Cdisplay opt
   2     360   151157 156040   156145 147157   164151 141164   151157 156056    ion negotiation.
   2     364   045060 060060   060060 060060   060060 060060   060060 060060    %000000000000000
   2     370   060060 060060   060057 045061   103163 164162   151160 040164    00000/%1Cstrip t
   2     374   150145 040160   141162 151164   171040 142151   164056 045060    he parity bit.%0
   2     400   060060 060060   060060 060060   060060 060060   060060 060060    0000000000000000
   2     404   060060 060060   060060 060060   060057 045061   103163 164141    000000000/%1Csta
   2     410   171040 151156   040143 157155   155141 156144   040155 157144    y in command mod
   2     414   145056 045060   060060 060060   060060 060060   060060 060060    e.%0000000000000
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:107  
   2     420   060060 060060   060060 060060   060060 060060   060057 045061    0000000000000/%1
   2     424   103144 145154   141171 040164   157040 163145   156144 040105    Cdelay to send E
   2     430   123103 040143   150141 162141   143164 145162   056045 060060    SC character.%00
   2     434   060060 060060   060060 060060   060060 060060   060060 060060    0000000000000000
   2     440   060057 045057   045060 060060   060060 060060   060060 060060    0/%/%00000000000
   2     444   060060 060061   123045 060060   060060 060060   060060 060060    0001S%0000000000
   2     450   060060 060060   060060 061123   045060 060060   060060 060060    0000001S%0000000
   2     454   060060 060060   060060 060060   060061 123045   062103 142162    0000000001S%2Cbr
   2     460   145141 153056   045060 060060   060060 060060   060057 045062    eak.%00000000/%2
   2     464   103151 156164   145162 162165   160164 056045   060060 060060    Cinterrupt.%0000
   2     470   057045 062103   141142 157162   164040 157165   164160 165164    /%2Cabort output
   2     474   056045 060057   045062 103141   162145 040171   157165 040164    .%0/%2Care you t
   2     500   150145 162145   056045 057045   062103 145162   141163 145056    here.%/%2Cerase.
   2     504   045060 060060   060060 060060   060057 045062   103153 151154    %00000000/%2Ckil
   2     510   154056 045060   060060 060060   060060 060060   057045 060060    l.%000000000/%00
   2     514   060060 060060   060060 060060   060060 060060   060060 061123    000000000000001S
   2     520   045060 060060   060060 060060   060060 060060   060060 060060    %000000000000000
   2     524   060061 123045   060060 060060   060060 060060   060060 060060    01S%000000000000
   2     530   060060 060060   061123 045060   060060 060060   060060 060060    00001S%000000000
   2     534   060060 060060   060060 060061   123045 060060   060060 060060    00000001S%000000
   2     540   060060 060060   060060 060060   060060 061123   045060 060060    00000000001S%000
   2     544   060060 060060   060060 060060   060060 060060   060061 123045    00000000000001S%
   2     550   060060 060060   060060 060060   060060 060060   060060 060060    0000000000000000
   2     554   061123 045062   103145 163143   141160 145056   045060 060060    1S%2Cescape.%000
   2     560   060060 060060   057045 062103   145157 146056   045060 060060    0000/%2Ceof.%000
   2     564   060060 060060   060060 061121                                    0000001Q

STATUS_FMT
 Sect OctLoc
   2     566   045056 061103   133045 056071   116072 075133   136100 045065    %.1C[%.9N:=[^@%5
   2     572   061061 077165   156144 145146   045061 062067   077136 077045    11?undef%127?^?%
   2     576   062065 066077   142162 145141   153045 077045   056043 072063    256?break%?%.#:3
   2     602   053072 065057   072066 077133   136045 061056   043072 066064    +:5/:6?[^%1.#:64
   2     606   053113 101045   061077 045061   056043 113101   045077 136045    +KA%1?%1.#KA%?^%
   2     612   061056 043072   071066 053113   101045 135045   135135 045103    1.#:96+KA%]%]]%C
   2     616   045056 116133   116157 164040   143157 156156   145143 164145    %.N[Not connecte
   2     622   144045 123045   077103 157156   156145 143164   145144 040164    d%S%?Connected t
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:108  
   2     626   157040 045076   101045 135056   045057 117160   145162 141164    o %>A%].%/Operat
   2     632   151156 147040   151156 040045   056116 133143   150141 162141    ing in %.N[chara
   2     636   143164 145162   045077 154151   156145 045135   040155 157144    cter%?line%] mod
   2     642   145056 045057   105163 143141   160145 040143   150141 162141    e.%/Escape chara
   2     646   143164 145162   040151 163040   045061 103056                    cter is %1C.

NETIN_FMT
 Sect OctLoc
   2     651   045126 100040   074055 040045   061050 045062   100056 070132    %V@ <- %1(%2@.8Z
   2     655   110040 045121   045061 051***                                    H %Q%1).

NETOUT_FMT
 Sect OctLoc
   2     657   045126 100040   055076 040045   061050 045062   100056 070132    %V@ -> %1(%2@.8Z
   2     663   110040 045121   045061 051***                                    H %Q%1).

XLATE_TBL_HIGH
 Sect OctLoc
   2     665   000001 002003   004005 006007   010011 012013   014015 016017    ................
   2     671   020021 022023   024025 026027   030031 032033   034035 036037    ................
   2     675   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
   2     701   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
   2     705   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
   2     711   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
   2     715   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
   2     721   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

RESET_BREAK
 Sect OctLoc
   2     726   000003 777640   000732 006000   000000 177640   000000 006014    ................
   2     732   000000 000000   000000 000000   004000 000000   000000 000000    ................

(unnamed)
 Sect OctLoc
   2     736   115105 040040   377375 003377   375001 040040   377365 040040    ME  ......  ..
   2     742   377366 040040   377364 040040   377367 040040   377363 040040    ..  ..  ..  ..
   2     746   377370 040040   377377 040040   015000 040040                    ..  ..  ..
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:109  

(unnamed)
 Sect OctLoc
   3     000   000000 000000   000000 000000   000000 000000   000000 000501    ................
   3     004   000000 000000   000000 000000   000000 006014   000000 006014    ................
   3     010   001040 040040   040040 040040   040040 040040   040040 040040    .
   3     014   040040 040040   040040 040040   040040 040040   040040 040040
   3     024*  040040 040040   040040 040040   114117 040040   040040 040040            LO
   3     030   040040 040040   000000 207015   010003 003000   000000 000000        ............
   3     034   000000 000000   000000 000000   000000 000000   000002 776003    ................
   3     040   001000 000000   000000 000002   000000 000000   000000 000000    ................
   3     044   000000 000111   040040 040040   000000 006014   000000 006014    ...I    ........
   3     050   000000 006014   000000 000000   000000 000000   000000 006014    ................
   3     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   3     060   000000 010000   000000 000000   000000 000000   000000 000000    ................
   3     064   000000 000020   000000 000000   000000 006014   000000 000000    ................
   3     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   3     074   000000 000000   000000 006014   000000 000000   000000 000000    ................
   3     100   000000 000000   000000 000000   000000 000000   000000 000000    ................
   3     104   ****** ******   ****** ******   000000 000000   ****** ******    ................
   3     110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   3     124*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   3     134*  ****** ******   ****** ******   ****** ******   000000 070707    ..............8.
   3     140   ****** ******   ****** ******                                    ........

(unnamed)
 Sect OctLoc
   7     000   000002 006000   000000 006000   000052 006000   000000 000000    .........*......
   7     004   000005 177640   001767 006000   000000 006003   000000 000000    ................
   7     010   000000 177640   000000 006014   000022 177640   002075 006000    .............=..
   7     014   000130 006000   000000 000000   000365 777640   000200 006000    .X..............
   7     020   000011 777640   002120 006000   000004 777640   002132 006000    .....P.......Z..
   7     024   002137 006000   000016 006000   000020 006000   000022 006000    ._..............
   7     030   000020 577640   002230 006000   002137 006000   000030 006000    ........._......
   7     034   000032 777640   002175 006000   002036 006000   000000 000000    .....}..........
   7     040   002137 006000   000034 006000   000117 006000   000117 006000    ._.......O...O..
   7     044   000120 006000   002013 206000   000040 040040   777777 437777    .P.......   ....
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:110  
   7     050   000012 177640   001775 006000   000130 006000   000004 006000    .........X......
   7     054   000003 006000   000004 006000   000116 006000   000012 006000    .........N......
   7     060   000015 177640   002010 006000   001142 006000   000010 006000    .........b......
   7     064   000005 577640   000657 006000   000001 377640   001142 006000    .............b..
   7     070   002137 006000   000064 006000   000066 006000   000000 000000    ._...4...6......
   7     074   000007 577640   000170 006000   015040 040040   777040 040040    .....x...   .
   7     100   001142 006000   001762 006000   000062 777640   000566 006000    .b.......2......
   7     104   000000 777640   002061 006000   000011 777640   002013 206000    .....1..........
   7     110   000000 777640   002062 006000   000000 177640   002136 006000    .....2.......^..
   7     114   002137 006000   000102 006000   000104 006000   000106 006000    ._...B...D...F..
   7     120   000110 006000   000112 006000   777400 777777   757777 777777    .H...J..........
   7     124   012040 040040   033040 040040   000005 577640   000651 006000    .   .   ........
   7     130   000131 006000   000000 000000   002137 006000   000126 006000    .Y......._...V..
   7     134   374040 040040   376040 040040   377040 040040   375040 040040    .   .   .   .
   7     140   373040 040040   000756 006000   000130 006000   002351 006000    .   .....X......
   7     144   000005 006000   000000 000000   000000 577640   002351 006000    ................
   7     150   002137 006000   000064 006000   000146 006000                    ._...4...f..
      695     7660
      696     7661    2   END REMOTE_INPUT;
      697     7662
      698     7663    1   END TELNET;
      699     7664        %EOD;

PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:111  
--  Include file information  --

   XU_FORMAT_C.:LIBRARY  is referenced.
   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   TCT_TELNET_E.:TCA2TOU  is referenced.
   XSL_INTERNAL_M.:TCA2TOU  is referenced.
   XSL_SOCKET_M.:TCA2TOU  is referenced.
   XSL_SOCKET_E.:TCA2TOU  is referenced.
   XSL_SOCKMSGS_E.:TCA2TOU  is referenced.
   XSL_PERR_C.:TCA2TOU  is referenced.
   XUG_ENTRY.:LIBRARY  cannot be made into a system file and is referenced.
   XU_MACRO_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TELNET.
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:112  

 **** Variables and constants ****

  ****  Section 001  Data  TELNET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1002-0-0/b UBIN(9)     r     1 ACTCHRS(0:31)           1763-0-0/w UBIN        r     1 CBIN
  1763-0-0/c STRC        r     1 CINIT                   1763-0-0/c BIT         r     1 CMASK
  2070-0-0/w SBIN        r     1 CMD_MODE                1012-0-0/d STRC(360)   r     1 EOMTERMINAL
  2060-0-0/w STRC        r     1 ERR_CODE                2073-0-0/c CHAR(4)     r     1 ESC_CHRS
  2072-0-0/w SBIN        r     1 ESC_WAIT                2137-0-0/w STRC(1080)  r     1 FDS
  1452-0-0/c CHAR(800)   r     1 FMTBUF                  2175-0-0/c STRC(972)   r     1 FMT_1CH
  2230-0-0/c STRC(603)   r     1 FMT_1TG                 2026-0-0/d STRC(936)   r     1 FPT_ERRMSG
   752-0-0/d STRC(432)   r     1 FPT_WRITE                116-0-0/w STRC(162)   r     1 FS
  2067-0-0/b BIT         r     1 GET_CMD                 1767-0-0/c STRC(189)   r     1 HELLO
  1775-0-0/c STRC(369)   r     1 HELLO2                  2010-0-0/c STRC(477)   r     1 HELLO3
   130-0-0/w UBIN        r     1 LCN                     2061-0-0/b BIT         r     1 LINK_UP
  2132-0-0/c CHAR        r     1 LOCAL_CHAR(0:19)
   123-0-0/w STRC(162)   r     1 LS                      2062-0-0/w SBIN        r     1 MODE
  2063-0-0/w SBIN        r     1 MODE_SENT               2064-0-0/w SBIN        r     1 NET_ARS
   131-0-0/c CHAR(1600)  r     1 NET_BUF                 2351-0-0/c STRC(27)    r     1 OPTION_REPLY
  1142-0-0/c CHAR(800)   r     1 OUTBUF                  1762-0-0/w UBIN        r     1 OUTBUFL
  2074-0-0/w SBIN        r     1 READ_CMD                1124-0-0/d STRC(504)   r     1 READ_TERM
  2075-0-0/c STRC(657)   r     1 READ_YC                 1764-0-0/b BIT         r     1 REMOTE_CR
  1765-0-0/b BIT         r     1 REMOTE_IAC              1766-0-0/b BIT         r     1 REMOTE_OPTION
  2352-0-0/w SBIN        r     1 SAV_ARS                 2353-0-0/c CHAR(132)   r     1 SAV_BUF
  1024-0-0/c CHAR(256)   r     1 TERM_BUF
  2120-0-0/b BIT         r     1 TOGGLES(0:9)
  2065-0-0/w SBIN        r     1 TRM_ARS                 2066-0-0/w SBIN        r     1 TRM_BRK
  2071-0-0/w SBIN        r     1 WAIT_ARS                 766-0-0/d STRC(432)   r     1 WRITE_LO
  2251-0-0/c STRC(2304)  r     1 XLATE_TBL                  0-0-0/d STRC(1512)  r     1 XUG_GETCMD
    52-0-0/d STRC(1296)  r     1 XUG_INIT

  ****  Section 002 RoData TELNET

  ****  Scalars and arrays  ****
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:113  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    46-0-0/d STRC(288)   r     1 ACTNORMAL                 44-0-0/c CHAR        r     1 ATPROMPT
    10-0-0/w UBIN        r     1 BITS8TO0(0:7)
   200-0-0/c STRC(8856)  r     1 DISP_FMT                  56-0-0/d STRC(360)   r     1 EOMNORMAL
   144-0-0/d STRC(144)   r     1 FPT_EVENT                150-0-0/d STRC(144)   r     1 FPT_INT
   170-0-0/c CHAR(31)    r     1 MSG_NO_LINK              651-0-0/c STRC(207)   r     1 NETIN_FMT
   657-0-0/c STRC(207)   r     1 NETOUT_FMT                32-0-0/d STRC(360)   r     1 NO_PROMPT
     0-0-0/c CHAR(8)     r     1 PROMPT                   126-0-0/d STRC(504)   r     1 READ_RECVRSP
   726-0-0/d STRC(288)   r     1 RESET_BREAK              566-0-0/c STRC(1836)  r     1 STATUS_FMT
   100-0-0/d STRC(288)   r     1 STOPNETREAD               70-0-0/d STRC(288)   r     1 STOPTERMREAD
     2-0-0/w STRC(216)   r     1 TCT_SOCKINIT              20-0-0/d STRC(360)   r     1 TELNET_PROMPT
   162-0-0/d STRC(216)   r     1 WAIT_AWHILE              154-0-0/d STRC(216)   r     1 WAIT_FOREVER
   110-0-0/d STRC(432)   r     1 WRITE_RECVRQS
   665-0-0/b BIT         r     1 XLATE_TBL_HIGH(0:31)
   124-0-0/b UBIN(18)    r     1 XSL_RCVRQS(0:2)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w SBIN        r     1 I                        111-0-0/w SBIN        r     1 J
     3-0-0/w PTR         r     1 M$LO$                      5-0-0/w PTR         r     1 P$
     6-0-0/c CHAR        r     1 SEARCH_TBL(0:259)

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c ASTR(9)     r     1 B_VERSION
     0-0-0/w SBIN        r     1 TELNET_CMD                 0-0-0/w SBIN        r     1 XSL_ERRNO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:114  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w PTR         r     1 BASED$PTR
     0-0-0/w UBIN        r     1 BASED$UBIN                 0-0-0/c CHAR(31)    r     1 CHAR31
     0-0-0/c ACHR        r     1 CHARN                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 F$XSL00                    0-0-0N  NULL        r     1 M$DO
     0-0-0/d ASTR(3528)  r     1 M$LO                       0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(180)   r     1 XSL$HOSTENT


   Procedure TELNET requires 1212 words for executable code.
   Procedure TELNET requires 80 words of local(AUTO) storage.
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:115  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:116  
          MINI XREF LISTING

ACTCHRS
      6015**DCL      6042--DCLINIT  7366<<ASSIGN   7371<<ASSIGN   7373<<ASSIGN   7373>>ASSIGN
ACTNORMAL
      6122**DCL      6148--DCLINIT
ATPROMPT
      6104**DCL      6098--DCLINIT
B$JIT.CCARS
      6599**DCL      7176>>ASSIGN
B$JIT.CCBUF
      6599**DCL      7176--ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      6605**DCL      6605--REDEF
B$JIT.ERR.MID
      6512**DCL      6512--REDEF
B$JIT.JRESPEAK
      6673**DCL      6674--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6782**DCL      6782--REDEF    6783--REDEF
B$JIT.PNR
      6686**DCL      6686--REDEF
B$JIT.PRFLAGS.LS
      6595**DCL      7175>>IF
B$JIT.PRFLAGS.OU
      6595**DCL      7175>>IF
B$JIT.TSLINE
      6780**DCL      6781--REDEF
B$JIT$
      6787**DCL      6506--IMP-PTR  7175>>IF       7175>>IF       7176>>ASSIGN   7176>>ASSIGN
BASED$PTR
      6264**DCL      7242>>ASSIGN
BASED$UBIN
      6263**DCL      7242>>ASSIGN
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:117  
BITS8TO0
      6016**DCL      7373>>ASSIGN
BREAK_INPUT IN PROCEDURE LOCAL_INPUT
      7531**ENTRY    7396--CALL
B_VERSION.L
      6407**DCL      6407--IMP-SIZ  7171>>ASSIGN
B_VERSION.T
      6407**DCL      7171>>ASSIGN
CBIN
      6271**DCL      7330<<ASSIGN   7331<<ASSIGN   7331>>ASSIGN   7454<<CALLBLT  7463>>DOCASE
CHAR31
      6265**DCL      7246>>CALLBLT  7247>>ASSIGN
CHARN
      6262**DCL      7303<<ASSIGN   7312<<ASSIGN   7312>>ASSIGN   7625--ASSIGN   7649--ASSIGN
CINIT.C
      6270**DCL      7327<<ASSIGN   7329<<ASSIGN   7330>>IF       7333>>ASSIGN   7537<<ASSIGN
CMASK
      6267**DCL      6268--REDEF    6271--REDEF    7325<<ASSIGN
CMD_MODE
      6796**DCL      7177<<ASSIGN   7184<<ASSIGN   7234>>IF       7234<<ASSIGN   7264>>IF       7351>>IF
      7351<<ASSIGN
COPY_CHR IN PROCEDURE REMOTE_INPUT
      7636**LABEL    7613--GOTO     7621--GOTO     7635--GOTO
DISP_FMT
      7088**DCL      7211--CALL
DISP_FMT.CH
      7106**DCL      7125--REDEF
DISP_FMT.CHA
      7125**DCL      7221>>ASSIGN
DISP_FMT.TG
      7094**DCL      7105--REDEF
DISP_FMT.TGA
      7105**DCL      7216>>ASSIGN   7344>>ASSIGN
EOMNORMAL
      6142**DCL      7410<>CALL
EOMNORMAL.V
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:118  
      6150**DCL      6144--DCLINIT
EOMTERMINAL
      6036**DCL      7382<>CALL
EOMTERMINAL.V
      6044**DCL      6038--DCLINIT
EOMTERMINAL.V.TIMEOUT#
      6045**DCL      7367<<ASSIGN   7374<<ASSIGN
ERR_CODE
      6462**DCL      6434--DCLINIT
ERR_CODE.ERR#
      6492**DCL      7259<<ASSIGN
ESC_CHRS
      6799**DCL      7450>>ASSIGN   7511<<ASSIGN
ESC_WAIT
      6798**DCL      7391>>IF       7449>>ASSIGN   7507<<ASSIGN   7512<<ASSIGN
EVENT_HNDLR
      5624**DCL-ENT  6355--DCLINIT
F$DCB.ACTPOS
      5851**DCL      5851--REDEF
F$DCB.ARS#
      5825**DCL      5825--REDEF
F$DCB.ATTR
      5844**DCL      5845--REDEF
F$DCB.BORROW
      5859**DCL      5859--REDEF    5859--REDEF    5859--REDEF
F$DCB.DCBNAME.L
      5873**DCL      5873--IMP-SIZ
F$DCB.DDEV.UCOUT#
      5832**DCL      7608>>IF       7623>>IF       7652>>IF
F$DCB.EOMCHAR#
      5829**DCL      5829--REDEF
F$DCB.FCN.CNT
      5864**DCL      7406>>IF       7406>>IF
F$DCB.FLDID
      5854**DCL      5854--REDEF
F$DCB.FORM$
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:119  
      5848**DCL      5848--REDEF
F$DCB.FSECT
      5864**DCL      5864--REDEF
F$DCB.FSN#
      5841**DCL      5841--REDEF    5841--REDEF    5842--REDEF
F$DCB.HEADER$
      5847**DCL      5847--REDEF
F$DCB.IXTNSIZE#
      5845**DCL      5845--REDEF
F$DCB.LASTSTA$
      5834**DCL      5834--REDEF
F$DCB.LVL
      5860**DCL      5860--REDEF
F$DCB.NAME#.C
      5835**DCL      5835--REDEF
F$DCB.NOEOF
      5857**DCL      5857--REDEF
F$DCB.NRECS#
      5846**DCL      5846--REDEF
F$DCB.NRECX
      5865**DCL      5865--REDEF
F$DCB.OHDR
      5857**DCL      5857--REDEF
F$DCB.ORG#
      5840**DCL      5840--REDEF
F$DCB.PRECNO
      5863**DCL      5863--REDEF
F$DCB.RCSZ
      5869**DCL      5869--REDEF
F$DCB.RES#
      5836**DCL      5836--REDEF
F$DCB.SETX
      5848**DCL      5848--REDEF
F$DCB.TAB$
      5848**DCL      5848--REDEF
F$DCB.TDA
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:120  
      5862**DCL      5863--REDEF
F$DCB.WSN#
      5836**DCL      5836--REDEF
F$XSL00
      6012**DCL      7406--IF
FDS
      6987**DCL      7211<>CALL     7217<>CALL     7222<>CALL     7281<>CALL     7321<>CALL     7336<>CALL
      7346<>CALL     7520<>CALL     7563<>CALL     7602<>CALL
FMTBUF
      6260**DCL      7005--DCLINIT  7007--DCLINIT
FMT_1CH
      7127**DCL      7222--CALL
FMT_1CH.CH
      7130**DCL      7221<<ASSIGN
FMT_1TG
      7132**DCL      7217--CALL     7346--CALL
FMT_1TG.TG
      7134**DCL      7216<<ASSIGN   7344<<ASSIGN
FPT_ERRMSG
      6434**DCL      7262<>CALL
FPT_ERRMSG.V
      6438**DCL      6434--DCLINIT
FPT_ERRMSG.V.SOURCE#
      6445**DCL      7260<<ASSIGN   7263<<ASSIGN
FPT_EVENT
      6355**DCL      7168<>CALL
FPT_EVENT.V
      6355**DCL      6355--DCLINIT
FPT_INT
      6369**DCL      7167<>CALL
FPT_INT.V
      6369**DCL      6369--DCLINIT
FPT_WRITE
      5967**DCL      7626<>CALL     7657<>CALL
FPT_WRITE.BUF_
      5967**DCL      7600<>CALL     7625<<ASSIGN   7649<<ASSIGN
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:121  
FPT_WRITE.STATION_
      5969**DCL      5969--REDEF
FPT_WRITE.V
      5970**DCL      5967--DCLINIT
FPT_WRITE.V.DVBYTE.TRANS#
      5977**DCL      7369<<ASSIGN   7376<<ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
      5976**DCL      5976--REDEF
FS
      5644**DCL      7256<>CALL
FS.SA_FAMILY
      5659**DCL      7253<<ASSIGN
FS.S_ADDR
      5688**DCL      7240<>CALL     7242<<ASSIGN   7245<>CALL
FS.S_PORT
      5668**DCL      7236<<CALLBLT  7237<<ASSIGN   7238<>CALL     7238<>CALL
GET_CMD
      6795**DCL      7387<<ASSIGN   7390>>DOWHILE  7495<<ASSIGN   7560<<ASSIGN
HELLO
      6404**DCL      7172--ASSIGN
HELLO.VERS
      6406**DCL      7171<<ASSIGN
HELLO2
      6409**DCL      7249--ASSIGN
HELLO2.IP
      6411**DCL      7247<<ASSIGN
HELLO3
      6413**DCL      6322--DCLINIT  6323--DCLINIT  7269--ASSIGN
HELLO3.IPNAME
      6415**DCL      7239<<ASSIGN   7240<>CALL     7241<>CALL     7336--CALL
I
      6013**DCL      7204<>CALL     7213<<DOINDEX  7214>>ASSIGN   7256<>CALL     7279<>CALL     7319<>CALL
      7341<<DOINDEX  7342>>ASSIGN   7356<<DOINDEX  7357>>IF       7358<<ASSIGN   7359>>IF       7360>>ASSIGN
      7360>>ASSIGN   7372<<ASSIGN   7373>>ASSIGN   7373>>ASSIGN   7373>>ASSIGN   7413<>CALL     7452<<ASSIGN
      7453>>DOUNTIL  7454>>CALLBLT  7455>>IF       7456>>ASSIGN   7457>>ASSIGN   7458<<ASSIGN   7458>>ASSIGN
      7461>>IF       7493<<ASSIGN   7493>>ASSIGN   7501<<ASSIGN   7501>>ASSIGN   7524>>IF       7535<<ASSIGN
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:122  
      7556<<CALLBLT  7565<<DOINDEX  7569>>DOSELCT  7576>>ASSIGN   7590>>ASSIGN   7608>>IF       7613>>IF
      7615>>DOSELCT  7638>>ASSIGN
INC_INO IN PROCEDURE LOCAL_INPUT
      7492**LABEL    7466--GOTO     7469--GOTO     7472--GOTO     7475--GOTO     7478--GOTO     7481--GOTO
      7484--GOTO
INT_HNDLR
      5625**DCL-ENT  6369--DCLINIT
J IN PROCEDURE LOCAL_INPUT
      7447**DCL      7454<<CALLBLT  7455>>IF       7456<<ASSIGN   7456>>ASSIGN   7457>>ASSIGN   7457>>ASSIGN
      7458>>ASSIGN   7459>>ASSIGN   7518<>CALL
LCN
      5816**DCL      7204<>CALL     7254<>CALL     7256<>CALL     7279<>CALL     7319<>CALL     7413<>CALL
      7518<>CALL     7600<>CALL
LINE_OUT IN PROCEDURE REMOTE_INPUT
      7624**LABEL    7611--GOTO
LINK_UP
      6789**DCL      7179>>DOUNTIL  7207<<ASSIGN   7230>>IF       7268<<ASSIGN   7291>>IF       7336--CALL
      7390>>DOWHILE  7412>>IF       7506>>IF
LOCAL_CHAR
      6806**DCL      7211--CALL     7222--CALL     7299>>ASSIGN   7333<<ASSIGN   7336--CALL     7359>>IF
      7360>>ASSIGN   7372>>ASSIGN
LOCAL_INPUT
      7417**PROC     7393--CALL     7398--CALL
LS
      5708**DCL      7252<<ASSIGN
M$EOM
        42**DCL-ENT  7382--CALL     7410--CALL
M$ERRMSG
        80**DCL-ENT  7262--CALL
M$EVENT
        72**DCL-ENT  7168--CALL
M$EXIT
        29**DCL-ENT  7183--CALL     7265--CALL
M$INT
        72**DCL-ENT  7167--CALL
M$LO
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:123  
      5876**DCL      7174--ASSIGN
M$LO.ACTPOS
      5917**DCL      5917--REDEF
M$LO.ARS#
      5876**DCL      5876--REDEF
M$LO.ATTR#
      5906**DCL      5906--REDEF    5908--REDEF
M$LO.BORROW
      5928**DCL      5928--REDEF    5928--REDEF    5928--REDEF
M$LO.DCBNAME.L
      5947**DCL      5947--IMP-SIZ  7174>>ASSIGN
M$LO.EOMCHAR#
      5883**DCL      5884--REDEF
M$LO.FLDID
      5920**DCL      5921--REDEF
M$LO.FORM$
      5912**DCL      5912--REDEF
M$LO.FSECT
      5935**DCL      5935--REDEF
M$LO.FSN#
      5902**DCL      5902--REDEF    5902--REDEF    5903--REDEF
M$LO.HEADER$
      5911**DCL      5912--REDEF
M$LO.IXTNSIZE#
      5908**DCL      5909--REDEF
M$LO.LASTSTA$
      5892**DCL      5892--REDEF
M$LO.LVL
      5929**DCL      5929--REDEF
M$LO.NAME#.C
      5892**DCL      5893--REDEF
M$LO.NOEOF
      5924**DCL      5924--REDEF
M$LO.NRECS#
      5909**DCL      5909--REDEF
M$LO.NRECX
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:124  
      5936**DCL      5936--REDEF
M$LO.OHDR
      5925**DCL      5925--REDEF
M$LO.ORG#
      5900**DCL      5901--REDEF
M$LO.PRECNO
      5933**DCL      5933--REDEF
M$LO.RCSZ
      5941**DCL      5941--REDEF
M$LO.RES#
      5894**DCL      5894--REDEF
M$LO.SETX
      5913**DCL      5913--REDEF
M$LO.TAB$
      5912**DCL      5912--REDEF
M$LO.TDA
      5932**DCL      5933--REDEF
M$LO.WSN#
      5894**DCL      5895--REDEF
M$LO$
      5949**DCL      7174<<ASSIGN   7608>>IF       7623>>IF       7652>>IF
M$PROMPT
        41**DCL-ENT  7377--CALL     7411--CALL
M$READ
        18**DCL-ENT  7383--CALL     7386--CALL     7526--CALL     7647--CALL
M$TRMPRG
        42**DCL-ENT  7403--CALL     7404--CALL     7532--CALL
M$UC
        41**DCL      7406--IF
M$WAIT
        75**DCL-ENT  7391--CALL     7392--CALL     7408--CALL
M$WRITE
        18**DCL-ENT  7173--CALL     7250--CALL     7270--CALL     7293--CALL     7385--CALL     7626--CALL
      7646--CALL     7657--CALL
MODE
      6790**DCL      7228>>IF       7229<<ASSIGN   7271>>IF       7275>>IF       7336--CALL     7370>>IF
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:125  
      7486>>IF       7595>>IF       7597>>ASSIGN   7631>>IF
MODE_SENT
      6791**DCL      7283<<ASSIGN   7591>>IF       7591>>IF       7594<<ASSIGN   7594>>ASSIGN
MONERR
      7260**LABEL    7191--GOTO
MSG_NO_LINK
      6417**DCL      7292--ASSIGN
NETIN_FMT
      7143**DCL      7563--CALL
NETOUT_FMT
      7145**DCL      7281--CALL     7321--CALL     7520--CALL     7602--CALL
NET_ARS
      6792**DCL      7205<<ASSIGN   7395>>DOWHILE  7397>>IF       7556>>CALLBLT  7563>>CALL     7565>>DOINDEX
      7645<<ASSIGN
NET_BUF
      5817**DCL      6324--DCLINIT  6325--DCLINIT  7556>>CALLBLT  7563--CALL     7569>>DOSELCT  7576>>ASSIGN
      7590>>ASSIGN   7608>>IF       7613>>IF       7615>>DOSELCT  7638>>ASSIGN
NO_PROMPT
      6092**DCL      7377<>CALL
NO_PROMPT.V
      6100**DCL      6094--DCLINIT
NXTCMD
      7179**LABEL    7197--GOTO     7264--GOTO     7294--GOTO     7313--EXIT     7381--GOTO     7412--GOTO
NXT_BYTE IN PROCEDURE REMOTE_INPUT
      7640**LABEL    7596--GOTO     7629--GOTO
OPTION_REPLY IN PROCEDURE REMOTE_INPUT
      7544**DCL      7600<>CALL     7602--CALL
OPTION_REPLY.DDW IN PROCEDURE REMOTE_INPUT
      7547**DCL      7595>>IF       7597<<ASSIGN
OPTION_REPLY.DODONTWONT IN PROCEDURE REMOTE_INPUT
      7546**DCL      7547--REDEF    7576<<ASSIGN   7580<<ASSIGN   7591>>IF
OPTION_REPLY.OPT IN PROCEDURE REMOTE_INPUT
      7548**DCL      7549--REDEF    7590<<ASSIGN
OPTION_REPLY.OPTN IN PROCEDURE REMOTE_INPUT
      7549**DCL      7591>>IF       7591>>IF       7591>>IF       7594>>ASSIGN
OUT$BLK.CODE
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:126  
      3995**DCL      7202>>DOCASE   7214>>ASSIGN   7228>>IF       7229>>ASSIGN   7296>>ASSIGN   7333>>ASSIGN
      7342>>ASSIGN
OUT$BLK.NSUBLKS
      3999**DCL      7210>>IF       7213>>DOINDEX  7235>>IF       7304>>IF       7305>>IF       7310>>IF
      7325>>IF       7326>>IF       7341>>DOINDEX
OUT$BLK.SUBLK$
      4020**DCL      7201>>ASSIGN   7214>>ASSIGN   7228>>IF       7229>>ASSIGN   7236>>CALLBLT  7236>>CALLBLT
      7239>>ASSIGN   7239>>ASSIGN   7286>>ASSIGN   7286>>ASSIGN   7296>>ASSIGN   7302>>ASSIGN   7303>>ASSIGN
      7303>>ASSIGN   7308<<ASSIGN   7308>>ASSIGN   7327>>ASSIGN   7327>>ASSIGN   7329>>ASSIGN   7329>>ASSIGN
      7333>>ASSIGN   7342>>ASSIGN   7556>>CALLBLT  7556>>CALLBLT
OUT$SYM.COUNT
      4056**DCL      4059--IMP-SIZ  7236>>CALLBLT  7239>>ASSIGN   7286>>ASSIGN   7302>>ASSIGN   7303>>ASSIGN
      7327>>ASSIGN   7329>>ASSIGN   7556>>CALLBLT
OUT$SYM.TEXT
      4059**DCL      7236>>CALLBLT  7239>>ASSIGN   7286>>ASSIGN   7303>>ASSIGN   7327>>ASSIGN   7329>>ASSIGN
      7556>>CALLBLT
OUTBUF
      6259**DCL      6435--DCLINIT  7273<<ASSIGN   7276<<ASSIGN   7277<<ASSIGN   7279<>CALL     7281--CALL
      7296<<ASSIGN   7297>>IF       7299<<ASSIGN   7301>>IF       7303--ASSIGN   7306<<ASSIGN   7312--ASSIGN
      7317<<ASSIGN   7319<>CALL     7321--CALL     7450<<ASSIGN   7457<<ASSIGN   7465<<ASSIGN   7468<<ASSIGN
      7471<<ASSIGN   7474<<ASSIGN   7477<<ASSIGN   7480<<ASSIGN   7483<<ASSIGN   7487<<ASSIGN   7489<<ASSIGN
      7510>>IF       7511>>ASSIGN   7518<>CALL     7520--CALL     7555<<ASSIGN   7571<<ASSIGN   7624<<ASSIGN
      7625--ASSIGN   7632<<ASSIGN   7638<<ASSIGN   7649--ASSIGN   7653>>ASSIGN
OUTBUFL
      6261**DCL      6262--IMP-SIZ  7214<<ASSIGN   7215>>IF       7216>>ASSIGN   7217>>CALL     7221>>ASSIGN
      7222>>CALL     7246<<CALLBLT  7247>>ASSIGN   7298<<ASSIGN   7302<<ASSIGN   7303>>ASSIGN   7306>>ASSIGN
      7307<<ASSIGN   7307>>ASSIGN   7311>>ASSIGN   7312>>ASSIGN   7312>>ASSIGN   7316<<ASSIGN   7319<>CALL
      7321>>CALL     7342<<ASSIGN   7343>>ASSIGN   7343>>ASSIGN   7344>>ASSIGN   7345>>IF       7345>>IF
      7346>>CALL     7449<<ASSIGN   7457>>ASSIGN   7459<<ASSIGN   7459>>ASSIGN   7465>>ASSIGN   7468>>ASSIGN
      7471>>ASSIGN   7474>>ASSIGN   7477>>ASSIGN   7480>>ASSIGN   7483>>ASSIGN   7487>>ASSIGN   7489>>ASSIGN
      7490<<ASSIGN   7490>>ASSIGN   7492<<ASSIGN   7492>>ASSIGN   7509>>IF       7510>>IF       7511>>ASSIGN
      7513<<ASSIGN   7513>>ASSIGN   7517>>IF       7518<>CALL     7520>>CALL     7536<<ASSIGN   7554<<ASSIGN
      7571>>ASSIGN   7572<<ASSIGN   7572>>ASSIGN   7610<<ASSIGN   7610>>ASSIGN   7625>>ASSIGN   7627<<ASSIGN
      7632>>ASSIGN   7633<<ASSIGN   7633>>ASSIGN   7638>>ASSIGN   7639<<ASSIGN   7639>>ASSIGN   7649>>ASSIGN
      7650>>IF       7653>>ASSIGN   7655>>ASSIGN
P$
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:127  
      6014**DCL      3987--IMP-PTR  7201<<ASSIGN   7202>>DOCASE   7210>>IF       7213>>DOINDEX  7214>>ASSIGN
      7228>>IF       7229>>ASSIGN   7235>>IF       7236>>CALLBLT  7236>>CALLBLT  7239>>ASSIGN   7239>>ASSIGN
      7241<>CALL     7242>>ASSIGN   7245<>CALL     7246>>CALLBLT  7247>>ASSIGN   7286>>ASSIGN   7286>>ASSIGN
      7296>>ASSIGN   7302>>ASSIGN   7303>>ASSIGN   7303>>ASSIGN   7304>>IF       7305>>IF       7308>>ASSIGN
      7308>>ASSIGN   7310>>IF       7325>>IF       7326>>IF       7327>>ASSIGN   7327>>ASSIGN   7329>>ASSIGN
      7329>>ASSIGN   7333>>ASSIGN   7341>>DOINDEX  7342>>ASSIGN   7556>>CALLBLT  7556>>CALLBLT
PROMPT
      3567**DCL      3450--DCLINIT  6070--DCLINIT
READ_CMD
      6800**DCL      7182>>IF       7186>>IF       7189<<ASSIGN   7194>>IF       7195<<ASSIGN   7196<<ASSIGN
      7196>>ASSIGN   7287<<ASSIGN   7496>>IF       7498<<ASSIGN
READ_RECVRSP
      6322**DCL      7386<>CALL     7647<>CALL
READ_RECVRSP.STATION_
      6325**DCL      6326--REDEF
READ_RECVRSP.V
      6326**DCL      6322--DCLINIT
READ_RECVRSP.V.DVBYTE.REREAD#
      6337**DCL      6337--REDEF
READ_RECVRSP.V.INDX#
      6335**DCL      6335--REDEF
READ_TERM
      6236**DCL      7383<>CALL     7526<>CALL
READ_TERM.STATION_
      6239**DCL      6240--REDEF
READ_TERM.V
      6240**DCL      6236--DCLINIT
READ_TERM.V.DVBYTE.REREAD#
      6251**DCL      6251--REDEF
READ_TERM.V.DVBYTE.TRANS#
      6252**DCL      7368<<ASSIGN   7375<<ASSIGN
READ_TERM.V.INDX#
      6249**DCL      6249--REDEF
READ_YC
      6801**DCL      7188--ASSIGN   7288--ASSIGN   7497--ASSIGN
READ_YC.FID
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:128  
      6803**DCL      7181<<ASSIGN   7195>>IF       7199<<ASSIGN   7286<<ASSIGN
REMOTE_CR
      6400**DCL      7606>>IF       7607<<ASSIGN   7620<<ASSIGN
REMOTE_IAC
      6401**DCL      7566>>IF       7568<<ASSIGN   7618<<ASSIGN
REMOTE_INPUT
      7542**PROC     7397--CALL
REMOTE_OPTION
      6402**DCL      7575<<ASSIGN   7579<<ASSIGN   7587>>IF       7589<<ASSIGN
RESET_BREAK IN PROCEDURE LOCAL_INPUT
      7434**DCL      7532<>CALL
RESET_BREAK.V IN PROCEDURE LOCAL_INPUT
      7441**DCL      7436--DCLINIT
RESET_BREAK.V.CTLFLG.RSTBRK# IN PROCEDURE LOCAL_INPUT
      7442**DCL      7443--REDEF
RETALT
      7256**LABEL    7241--CALLALT  7254--CALLALT  7415--GOTO
SAV_ARS IN PROCEDURE REMOTE_INPUT
      7550**DCL      7554>>ASSIGN   7555>>ASSIGN   7628<<ASSIGN   7651<<ASSIGN   7655<<ASSIGN
SAV_BUF IN PROCEDURE REMOTE_INPUT
      7551**DCL      7555>>ASSIGN   7653<<ASSIGN   7654<<ASSIGN   7655--ASSIGN
SEARCH_TBL
      7148**DCL      7355<<ASSIGN   7360<<ASSIGN   7454>>CALLBLT  7534>>IF       7537>>ASSIGN
SET_MODE
      7271**LABEL    7230--GOTO
STATUS_FMT
      7136**DCL      7336--CALL
STOPNETREAD
      6199**DCL      7404<>CALL
STOPNETREAD.V
      6206**DCL      6201--DCLINIT
STOPNETREAD.V.CTLFLG.RSTBRK#
      6207**DCL      6208--REDEF
STOPTERMREAD
      6170**DCL      7403<>CALL
STOPTERMREAD.V
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:129  
      6177**DCL      6172--DCLINIT
STOPTERMREAD.V.CTLFLG.RSTBRK#
      6178**DCL      6179--REDEF
TCT_SOCKINIT
      5453**DCL      7169<>CALL
TELNET_CMD
      3566**DCL      3242--DCLINIT
TELNET_PROMPT
      6064**DCL      7411<>CALL
TELNET_PROMPT.V
      6072**DCL      6066--DCLINIT
TERM_BUF
      6212**DCL      6238--DCLINIT  6239--DCLINIT  7312--ASSIGN   7451<<CALLBLT  7451>>CALLBLT  7454>>CALLBLT
      7457>>ASSIGN   7524--IF       7535--ASSIGN
TEST_CHAR IN PROCEDURE LOCAL_INPUT
      7461**LABEL    7538--GOTO
TOGGLES
      6804**DCL      7211--CALL     7217--CALL     7280>>IF       7320>>IF       7343<<ASSIGN   7343>>ASSIGN
      7345>>IF       7346--CALL     7357>>IF       7363>>IF       7381>>IF       7508>>IF       7519>>IF
      7526>>IF       7562>>IF       7601>>IF
TRM_ARS
      6793**DCL      7206<<ASSIGN   7395>>DOWHILE  7398>>IF       7451>>CALLBLT  7453>>DOUNTIL  7454>>CALLBLT
      7461>>IF       7508>>IF       7508<<DOINDEX  7509>>IF       7510>>IF       7511>>ASSIGN   7512>>ASSIGN
      7513>>ASSIGN   7514<<ASSIGN   7525<<ASSIGN   7528<<ASSIGN   7558<<ASSIGN
TRM_BRK
      6794**DCL      7395>>DOWHILE  7396>>IF       7533<<ASSIGN
WAIT_ARS
      6797**DCL      7311<<ASSIGN   7380>>IF       7500<<ASSIGN   7556>>IF       7558>>ASSIGN   7559<<ASSIGN
WAIT_AWHILE
      6397**DCL      7392<>CALL
WAIT_AWHILE.V
      6398**DCL      6397--DCLINIT
WAIT_FOREVER
      6383**DCL      7391<>CALL     7408<>CALL
WAIT_FOREVER.V
      6384**DCL      6383--DCLINIT
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:130  
WRITE_LO
      5998**DCL      7173<>CALL     7250<>CALL     7270<>CALL     7293<>CALL
WRITE_LO.BUF_
      5998**DCL      7172<<ASSIGN   7249<<ASSIGN   7269<<ASSIGN   7292<<ASSIGN
WRITE_LO.STATION_
      6000**DCL      6000--REDEF
WRITE_LO.V
      6001**DCL      5998--DCLINIT
WRITE_LO.V.DVBYTE.VFC#
      6007**DCL      6007--REDEF
WRITE_RECVRQS
      6289**DCL      7385<>CALL     7646<>CALL
WRITE_RECVRQS.STATION_
      6291**DCL      6291--REDEF
WRITE_RECVRQS.V
      6292**DCL      6289--DCLINIT
WRITE_RECVRQS.V.DVBYTE.VFC#
      6298**DCL      6298--REDEF
X$PRE_PROCESS
      3227**DCL-ENT  3686--DCLINIT
X$WRITE
      6972**DCL-ENT  7211--CALL     7217--CALL     7222--CALL     7281--CALL     7321--CALL     7336--CALL
      7346--CALL     7520--CALL     7563--CALL     7602--CALL
XLATE_TBL
      7149**DCL      7451>>CALLBLT
XLATE_TBL.HIGH
      7156**DCL      7363<<ASSIGN   7364<<ASSIGN
XLATE_TBL.LOW
      7150**DCL      7363>>ASSIGN
XLATE_TBL_HIGH
      7157**DCL      7364>>ASSIGN
XSL$CLOSE
      5559**DCL-ENT  7204--CALL     7413--CALL
XSL$CONNECT
      5560**DCL-ENT  7256--CALL
XSL$GETHOSTBYNAME
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:131  
      5561**DCL-ENT  7241--CALL
XSL$HOSTENT.H_ADDR_LIST$
      5813**DCL      7242>>ASSIGN
XSL$HTONL
      5567**DCL-ENT  7238--CALL
XSL$INET_ADDR
      5562**DCL-ENT  7240--CALL
XSL$INET_NTOA
      5563**DCL-ENT  7245--CALL
XSL$SOCKET
      5564**DCL-ENT  7254--CALL
XSL$SOCKINIT
      5566**DCL-ENT  7169--CALL
XSL$WRITE
      5565**DCL-ENT  7279--CALL     7319--CALL     7518--CALL     7600--CALL
XSL_ERRNO
      6495**DCL      7259>>ASSIGN   7260>>IF       7414<<ASSIGN
XSL_RCVRQS
      6303**DCL      6289--DCLINIT
XTX$ADAPT
      3585**DCL-ENT  3901--DCLINIT
XUG$GETCMD
      3203**DCL-ENT  7180--CALL
XUG$INIT
      3207**DCL-ENT  7170--CALL
XUG_GETCMD
      3241**DCL      7170<>CALL     7180<>CALL
XUG_GETCMD.OUT$
      3246**DCL      3252--REDEF    7201>>ASSIGN
XUG_GETCMD.TEXT_
      3504**DCL      7176<<ASSIGN   7183>>IF       7188<<ASSIGN   7193<<ASSIGN   7288<<ASSIGN   7497<<ASSIGN
XUG_INIT
      3590**DCL      7170<>CALL
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:132  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:133  
              MINI UREF LISTING

M$ACCT      34**DCL-ENT
M$ACTIVATE      37**DCL-ENT
M$ALIB      30**DCL-ENT
M$ASUSER      32**DCL-ENT
M$ATTACH      39**DCL-ENT
M$BADPP      57**DCL-ENT
M$CGCTL      38**DCL-ENT
M$CGINFO      38**DCL-ENT
M$CHECK      19**DCL-ENT
M$CHGUNIT      77**DCL-ENT
M$CLOSE      17**DCL-ENT
M$CLRSTK      75**DCL-ENT
M$CMDVAR      86**DCL-ENT
M$CONFIG      47**DCL-ENT
M$CORRES      22**DCL-ENT
M$CPEXIT      31**DCL-ENT
M$CVM      55**DCL-ENT
M$CVOL      20**DCL-ENT
M$DCLFLD      47**DCL-ENT
M$DEACTIVATE      37**DCL-ENT
M$DELREC      19**DCL-ENT
M$DEQ      84**DCL-ENT
M$DETACH      39**DCL-ENT
M$DEVICE      21**DCL-ENT
M$DISPLAY      84**DCL-ENT
M$DISPRES      24**DCL-ENT
M$DLIB      30**DCL-ENT
M$DO    6496**DCL
M$DRIBBLE      47**DCL-ENT
M$DRTN      75**DCL-ENT
M$DSUSER      32**DCL-ENT
M$ENQ      83**DCL-ENT
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:134  
M$ERASE      48**DCL-ENT
M$ERR      29**DCL-ENT
M$EXHUME      81**DCL-ENT
M$EXTEND      21**DCL-ENT
M$FDP      53**DCL-ENT
M$FDS      52**DCL-ENT
M$FEBOOT      45**DCL-ENT
M$FECTL      46**DCL-ENT
M$FEDUMP      45**DCL-ENT
M$FID      80**DCL-ENT
M$FINDPROC      34**DCL-ENT
M$FSUSER      32**DCL-ENT
M$FVP      54**DCL-ENT
M$FWCG      38**DCL-ENT
M$GBPL      58**DCL-ENT
M$GDDL      54**DCL-ENT
M$GDP      53**DCL-ENT
M$GDS      52**DCL-ENT
M$GETDCB      23**DCL-ENT
M$GETMOUSE      63**DCL-ENT
M$GETPM      64**DCL-ENT
M$GJOB      82**DCL-ENT
M$GLINEATTR      42**DCL-ENT
M$GOODPP      57**DCL-ENT
M$GPLATEN      50**DCL-ENT
M$GPROMPT      49**DCL-ENT
M$GTRMATTR      43**DCL-ENT
M$GTRMCTL      41**DCL-ENT
M$GTRMTAB      44**DCL-ENT
M$GVP      53**DCL-ENT
M$HELP      80**DCL-ENT
M$INTRTN      33**DCL-ENT
M$IOQ      68**DCL-ENT
M$JOBSTATS      82**DCL-ENT
M$KEYIN      22**DCL-ENT
M$LDEV      17**DCL-ENT
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:135  
M$LDTRC      30**DCL-ENT
M$LIMIT      23**DCL-ENT
M$LINES      22**DCL-ENT
M$LINK      29**DCL-ENT
M$MADMUCK      25**DCL-ENT
M$MAKUSER      56**DCL-ENT
M$MBS      24**DCL-ENT
M$MDFFLD      48**DCL-ENT
M$MERC      73**DCL-ENT
M$MERCS      74**DCL-ENT
M$MIRROR      68**DCL-ENT
M$MONINFO      85**DCL-ENT
M$MPL      58**DCL-ENT
M$NODEINFO      49**DCL-ENT
M$NXTUSR      83**DCL-ENT
M$OCMSG      81**DCL-ENT
M$OLAY      29**DCL-ENT
M$OPEN      17**DCL-ENT
M$PAS      58**DCL-ENT
M$PATHCON      81**DCL-ENT
M$PDS      52**DCL-ENT
M$PFIL      19**DCL-ENT
M$PLATEN      43**DCL-ENT
M$PRECORD      21**DCL-ENT
M$PROCNAME      34**DCL-ENT
M$PROFILE      45**DCL-ENT
M$RACST      25**DCL-ENT
M$RDSYSLOG      66**DCL-ENT
M$RELDCB      23**DCL-ENT
M$RELRES      24**DCL-ENT
M$RELSTARF      26**DCL-ENT
M$REM      26**DCL-ENT
M$RENV      73**DCL-ENT
M$REQUIRE      25**DCL-ENT
M$RETRY      74**DCL-ENT
M$RETRYS      74**DCL-ENT
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:136  
M$REW      20**DCL-ENT
M$RLSFLD      48**DCL-ENT
M$RPRIV      76**DCL-ENT
M$RSPP      55**DCL-ENT
M$RSWITCH      77**DCL-ENT
M$RUE      83**DCL-ENT
M$SAD      56**DCL-ENT
M$SAVE      32**DCL-ENT
M$SCON      33**DCL-ENT
M$SCREECH      31**DCL-ENT
M$SENV      73**DCL-ENT
M$SETFMA      17**DCL-ENT
M$SETFP      46**DCL-ENT
M$SINPUT      44**DCL-ENT
M$SLCFLD      49**DCL-ENT
M$SMOUSE      63**DCL-ENT
M$SMPRT      55**DCL-ENT
M$SPRIV      76**DCL-ENT
M$SSC      56**DCL-ENT
M$SSWITCH      76**DCL-ENT
M$STATE      85**DCL-ENT
M$STD      57**DCL-ENT
M$STIMER      71**DCL-ENT
M$STLPP      54**DCL-ENT
M$STRAP      71**DCL-ENT
M$STRMATTR      43**DCL-ENT
M$STRMCTL      41**DCL-ENT
M$STRMTAB      44**DCL-ENT
M$SYMBIO      82**DCL-ENT
M$SYSCON      68**DCL-ENT
M$SYSID      86**DCL-ENT
M$TDCLOSE      67**DCL-ENT
M$TDIO      67**DCL-ENT
M$TDOPEN      66**DCL-ENT
M$TDREQCPU      67**DCL-ENT
M$TEMPWROC      61**DCL-ENT
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:137  
M$TIME      84**DCL-ENT
M$TRAP      71**DCL-ENT
M$TRMISC      46**DCL-ENT
M$TRTN      75**DCL-ENT
M$TRUNC      18**DCL-ENT
M$TTIMER      71**DCL-ENT
M$UMPL      58**DCL-ENT
M$UNFID      80**DCL-ENT
M$UNLATCH      37**DCL-ENT
M$UNSHARE      34**DCL-ENT
M$USRFIELD      77**DCL-ENT
M$VIRTUAL      52**DCL-ENT
M$WEOF      20**DCL-ENT
M$WRSYSLOG      66**DCL-ENT
M$XCON      72**DCL-ENT
M$XCONRTN      33**DCL-ENT
M$XEQTIME      85**DCL-ENT
M$XFLUSH      26**DCL-ENT
M$XMOUSE      63**DCL-ENT
M$XXX      29**DCL-ENT
M$YC      31**DCL-ENT
TELNET       7**PROC
XUG$ALLMSG    3220**DCL-ENT
XUG$BLANK_PASSWORD    3223**DCL-ENT
XUG$BREAK    3213**DCL-ENT
XUG$CLOSE_DCBS    3212**DCL-ENT
XUG$CLRENABLE    3216**DCL-ENT
XUG$CORRES    3208**DCL-ENT
XUG$DISABLE    3214**DCL-ENT
XUG$ECHO    3206**DCL-ENT
XUG$ECHOIF    3205**DCL-ENT
XUG$ECHOLAST    3209**DCL-ENT
XUG$ENABLE    3215**DCL-ENT
XUG$ERRCNVRT    3225**DCL-ENT
XUG$ERRMSG    3210**DCL-ENT
XUG$ERRPTR    3204**DCL-ENT
PL6.E3A0      #001=TELNET File=TCT$TELNET.:TCA2TSI                               SUN 11/16/97 14:23 Page:138  
XUG$ERRTOLCP6    3226**DCL-ENT
XUG$FINDDCB    3221**DCL-ENT
XUG$GETDCB    3222**DCL-ENT
XUG$HELP    3218**DCL-ENT
XUG$MOREMSG    3219**DCL-ENT
XUG$OPENOUT    3224**DCL-ENT
XUG$SETERRMSG    3211**DCL-ENT
XUG$SIMULATE_BREAK    3217**DCL-ENT

PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:139  
      700        1        /*T***********************************************************/
      701        2        /*T*                                                         */
      702        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      703        4        /*T*                                                         */
      704        5        /*T***********************************************************/
      705        6        EVENT_HNDLR: PROC ASYNC;
      706        7        %INCLUDE CP_6;
      707       88        %INCLUDE CP_6_SUBS;
      708      628
      709      629    1   DCL TERM_BUF CHAR(256) SYMREF;
      710      630    1   DCL TRM_ARS SBIN SYMREF;
      711      631    1   DCL TRM_BRK SBIN SYMREF;
      712      632    1   DCL NET_ARS SBIN SYMREF;
      713      633    1   DCL LINK_UP BIT(1) SYMREF;
      714      634    1   DCL B$TCB$ PTR SYMREF READONLY;
      715      635        %B$TCB (STCLASS="BASED(B$TCB$)");
      716      638        %B$NWIO;
      717      723
      718      724    2      IF B$TCB.STK$->B$NWIO.EVID>3 THEN DO;
      719      725    2          NET_ARS = B$TCB.STK$->B$NWIO.ARS;
      720      726    2          IF NET_ARS=0 AND NOT B$TCB.STK$->B$NWIO.IOERRCODE THEN LINK_UP = '0'B;
      721      727    2          END;
      722      728    2      ELSE DO;
      723      729    2          TRM_ARS = B$TCB.STK$->B$NWIO.ARS;
      724      730    2          IF B$TCB.STK$->B$NWIO.DVE.EOMCHAR=%EOM_EOR# THEN EXIT;
      725      731    2          SUBSTR(TERM_BUF,TRM_ARS,1) = B$TCB.STK$->B$NWIO.DVE.EOMCHAR;
      726      732    2          TRM_ARS = TRM_ARS + 1;
      727      733    2          END;
      728      734    1      RETURN;
      729      735
      730      736    1   INT_HNDLR: ENTRY ASYNC;
      731      737
      732      738    1      TRM_BRK = 1;
      733      739    1      RETURN;
      734      740    1   END EVENT_HNDLR;

PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:140  
--  Include file information  --

   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure EVENT_HNDLR.

   Procedure EVENT_HNDLR requires 30 words for executable code.
   Procedure EVENT_HNDLR requires 4 words of local(AUTO) storage.

    No errors detected in file TCT$TELNET.:TCA2TSI    .

PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:141  

 Object Unit name= EVENT_HNDLR                                File name= TCT$TELNET.:TCA2TOU
 UTS= NOV 16 '97 14:26:40.32 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none    30     36  EVENT_HNDLR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes     Async       0  EVENT_HNDLR
     1     31                  yes     Async       0  INT_HNDLR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TERM_BUF                              TRM_ARS
     TRM_BRK                               NET_ARS                               LINK_UP
r    B$TCB$
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:142  


      700        1        /*T***********************************************************/
      701        2        /*T*                                                         */
      702        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      703        4        /*T*                                                         */
      704        5        /*T***********************************************************/
      705        6        EVENT_HNDLR: PROC ASYNC;

      6  1 000000   000000 700200 xent  EVENT_HNDLR  TSX0  ! X66_AAUTO
         1 000001   000004 000000                    ZERO    4,0

      706        7        %INCLUDE CP_6;
      707       88        %INCLUDE CP_6_SUBS;
      708      628
      709      629    1   DCL TERM_BUF CHAR(256) SYMREF;
      710      630    1   DCL TRM_ARS SBIN SYMREF;
      711      631    1   DCL TRM_BRK SBIN SYMREF;
      712      632    1   DCL NET_ARS SBIN SYMREF;
      713      633    1   DCL LINK_UP BIT(1) SYMREF;
      714      634    1   DCL B$TCB$ PTR SYMREF READONLY;
      715      635        %B$TCB (STCLASS="BASED(B$TCB$)");
      716      638        %B$NWIO;
      717      723
      718      724    2      IF B$TCB.STK$->B$NWIO.EVID>3 THEN DO;

    724  1 000002   000000 470400 xsym               LDP0    B$TCB$
         1 000003   000001 471500                    LDP1    1,,PR0
         1 000004   100101 235100                    LDA     65,,PR1
         1 000005   000004 115007                    CMPA    4,DL
         1 000006   000016 602000 1                  TNC     s:729

      719      725    2          NET_ARS = B$TCB.STK$->B$NWIO.ARS;

    725  1 000007   100105 235100                    LDA     69,,PR1
         1 000010   000000 755000 xsym               STA     NET_ARS

      720      726    2          IF NET_ARS=0 AND NOT B$TCB.STK$->B$NWIO.IOERRCODE THEN LINK_UP = '0'B;
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:143  

    726  1 000011   000030 601000 1                  TNZ     s:734
         1 000012   100117 235100                    LDA     79,,PR1
         1 000013   000030 601000 1                  TNZ     s:734

    726  1 000014   000000 450000 xsym               STZ     LINK_UP

      721      727    2          END;

    727  1 000015   000030 710000 1                  TRA     s:734

      722      728    2      ELSE DO;

      723      729    2          TRM_ARS = B$TCB.STK$->B$NWIO.ARS;

    729  1 000016   100105 235100                    LDA     69,,PR1
         1 000017   000000 755000 xsym               STA     TRM_ARS

      724      730    2          IF B$TCB.STK$->B$NWIO.DVE.EOMCHAR=%EOM_EOR# THEN EXIT;

    730  1 000020   100106 236100                    LDQ     70,,PR1
         1 000021   000777 376003                    ANQ     511,DU
         1 000022   000501 116003                    CMPQ    321,DU
         1 000023   000030 600000 1                  TZE     s:734

      725      731    2          SUBSTR(TERM_BUF,TRM_ARS,1) = B$TCB.STK$->B$NWIO.DVE.EOMCHAR;

    731  1 000024   040005 100500                    MLR     fill='040'O
         1 000025   100106 200001                    ADSC9   70,,PR1                  cn=1,n=1
         1 000026   000000 000001 xsym               ADSC9   TERM_BUF,A               cn=0,n=1

      726      732    2          TRM_ARS = TRM_ARS + 1;

    732  1 000027   000000 054000 xsym               AOS     TRM_ARS

      727      733    2          END;

PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:144  
      728      734    1      RETURN;

    734  1 000030   000000 702200 xent               TSX2  ! X66_AARET

      729      735
      730      736    1   INT_HNDLR: ENTRY ASYNC;

    736  1 000031   000000 700200 xent  INT_HNDLR    TSX0  ! X66_AAUTO
         1 000032   000004 000000                    ZERO    4,0

      731      737
      732      738    1      TRM_BRK = 1;

    738  1 000033   000001 235007                    LDA     1,DL
         1 000034   000000 755000 xsym               STA     TRM_BRK

      733      739    1      RETURN;

    739  1 000035   000000 702200 xent               TSX2  ! X66_AARET
      734      740    1   END EVENT_HNDLR;

PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:145  
--  Include file information  --

   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure EVENT_HNDLR.
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:146  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b BIT         r     1 LINK_UP
     0-0-0/w SBIN        r     1 NET_ARS                    0-0-0/c CHAR(256)   r     1 TERM_BUF
     0-0-0/w SBIN        r     1 TRM_ARS                    0-0-0/w SBIN        r     1 TRM_BRK

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2880)  r     1 B$NWIO                     0-0-0/w STRC(144)   r     1 B$TCB


   Procedure EVENT_HNDLR requires 30 words for executable code.
   Procedure EVENT_HNDLR requires 4 words of local(AUTO) storage.

    No errors detected in file TCT$TELNET.:TCA2TSI    .
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:147  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:148  
          MINI XREF LISTING

B$NWIO.ARS
       648**DCL       725>>ASSIGN    729>>ASSIGN
B$NWIO.CGPARM.MSGIDXT
       672**DCL       675--REDEF
B$NWIO.CODE
       641**DCL       641--REDEF     642--REDEF     642--REDEF
B$NWIO.DVE.EOMCHAR
       648**DCL       730>>IF        731>>ASSIGN
B$NWIO.ERR.ERR#
       643**DCL       643--REDEF
B$NWIO.EVID
       642**DCL       642--REDEF     642--REDEF     724>>IF
B$NWIO.IOERRCODE
       691**DCL       726>>IF
B$TCB.STK$
       636**DCL       724>>IF        725>>ASSIGN    726>>IF        729>>ASSIGN    730>>IF        731>>ASSIGN
B$TCB$
       634**DCL       636--IMP-PTR   724>>IF        725>>ASSIGN    726>>IF        729>>ASSIGN    730>>IF
       731>>ASSIGN
LINK_UP
       633**DCL       726<<ASSIGN
NET_ARS
       632**DCL       725<<ASSIGN    726>>IF
TERM_BUF
       629**DCL       731<<ASSIGN
TRM_ARS
       630**DCL       729<<ASSIGN    731>>ASSIGN    732<<ASSIGN    732>>ASSIGN
TRM_BRK
       631**DCL       738<<ASSIGN
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:149  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:150  
              MINI UREF LISTING

EVENT_HNDLR       6**PROC
INT_HNDLR     736**ENTRY
M$ACCT      33**DCL-ENT
M$ACTIVATE      36**DCL-ENT
M$ALIB      29**DCL-ENT
M$ASUSER      31**DCL-ENT
M$ATTACH      38**DCL-ENT
M$BADPP      56**DCL-ENT
M$CGCTL      37**DCL-ENT
M$CGINFO      37**DCL-ENT
M$CHECK      18**DCL-ENT
M$CHGUNIT      76**DCL-ENT
M$CLOSE      16**DCL-ENT
M$CLRSTK      74**DCL-ENT
M$CMDVAR      85**DCL-ENT
M$CONFIG      46**DCL-ENT
M$CORRES      21**DCL-ENT
M$CPEXIT      30**DCL-ENT
M$CVM      54**DCL-ENT
M$CVOL      19**DCL-ENT
M$DCLFLD      46**DCL-ENT
M$DEACTIVATE      36**DCL-ENT
M$DELREC      18**DCL-ENT
M$DEQ      83**DCL-ENT
M$DETACH      38**DCL-ENT
M$DEVICE      20**DCL-ENT
M$DISPLAY      83**DCL-ENT
M$DISPRES      23**DCL-ENT
M$DLIB      29**DCL-ENT
M$DRIBBLE      46**DCL-ENT
M$DRTN      74**DCL-ENT
M$DSUSER      31**DCL-ENT
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:151  
M$ENQ      82**DCL-ENT
M$EOM      41**DCL-ENT
M$ERASE      47**DCL-ENT
M$ERR      28**DCL-ENT
M$ERRMSG      79**DCL-ENT
M$EVENT      71**DCL-ENT
M$EXHUME      80**DCL-ENT
M$EXIT      28**DCL-ENT
M$EXTEND      20**DCL-ENT
M$FDP      52**DCL-ENT
M$FDS      51**DCL-ENT
M$FEBOOT      44**DCL-ENT
M$FECTL      45**DCL-ENT
M$FEDUMP      44**DCL-ENT
M$FID      79**DCL-ENT
M$FINDPROC      33**DCL-ENT
M$FSUSER      31**DCL-ENT
M$FVP      53**DCL-ENT
M$FWCG      37**DCL-ENT
M$GBPL      57**DCL-ENT
M$GDDL      53**DCL-ENT
M$GDP      52**DCL-ENT
M$GDS      51**DCL-ENT
M$GETDCB      22**DCL-ENT
M$GETMOUSE      62**DCL-ENT
M$GETPM      63**DCL-ENT
M$GJOB      81**DCL-ENT
M$GLINEATTR      41**DCL-ENT
M$GOODPP      56**DCL-ENT
M$GPLATEN      49**DCL-ENT
M$GPROMPT      48**DCL-ENT
M$GTRMATTR      42**DCL-ENT
M$GTRMCTL      40**DCL-ENT
M$GTRMTAB      43**DCL-ENT
M$GVP      52**DCL-ENT
M$HELP      79**DCL-ENT
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:152  
M$INT      71**DCL-ENT
M$INTRTN      32**DCL-ENT
M$IOQ      67**DCL-ENT
M$JOBSTATS      81**DCL-ENT
M$KEYIN      21**DCL-ENT
M$LDEV      16**DCL-ENT
M$LDTRC      29**DCL-ENT
M$LIMIT      22**DCL-ENT
M$LINES      21**DCL-ENT
M$LINK      28**DCL-ENT
M$MADMUCK      24**DCL-ENT
M$MAKUSER      55**DCL-ENT
M$MBS      23**DCL-ENT
M$MDFFLD      47**DCL-ENT
M$MERC      72**DCL-ENT
M$MERCS      73**DCL-ENT
M$MIRROR      67**DCL-ENT
M$MONINFO      84**DCL-ENT
M$MPL      57**DCL-ENT
M$NODEINFO      48**DCL-ENT
M$NXTUSR      82**DCL-ENT
M$OCMSG      80**DCL-ENT
M$OLAY      28**DCL-ENT
M$OPEN      16**DCL-ENT
M$PAS      57**DCL-ENT
M$PATHCON      80**DCL-ENT
M$PDS      51**DCL-ENT
M$PFIL      18**DCL-ENT
M$PLATEN      42**DCL-ENT
M$PRECORD      20**DCL-ENT
M$PROCNAME      33**DCL-ENT
M$PROFILE      44**DCL-ENT
M$PROMPT      40**DCL-ENT
M$RACST      24**DCL-ENT
M$RDSYSLOG      65**DCL-ENT
M$READ      17**DCL-ENT
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:153  
M$RELDCB      22**DCL-ENT
M$RELRES      23**DCL-ENT
M$RELSTARF      25**DCL-ENT
M$REM      25**DCL-ENT
M$RENV      72**DCL-ENT
M$REQUIRE      24**DCL-ENT
M$RETRY      73**DCL-ENT
M$RETRYS      73**DCL-ENT
M$REW      19**DCL-ENT
M$RLSFLD      47**DCL-ENT
M$RPRIV      75**DCL-ENT
M$RSPP      54**DCL-ENT
M$RSWITCH      76**DCL-ENT
M$RUE      82**DCL-ENT
M$SAD      55**DCL-ENT
M$SAVE      31**DCL-ENT
M$SCON      32**DCL-ENT
M$SCREECH      30**DCL-ENT
M$SENV      72**DCL-ENT
M$SETFMA      16**DCL-ENT
M$SETFP      45**DCL-ENT
M$SINPUT      43**DCL-ENT
M$SLCFLD      48**DCL-ENT
M$SMOUSE      62**DCL-ENT
M$SMPRT      54**DCL-ENT
M$SPRIV      75**DCL-ENT
M$SSC      55**DCL-ENT
M$SSWITCH      75**DCL-ENT
M$STATE      84**DCL-ENT
M$STD      56**DCL-ENT
M$STIMER      70**DCL-ENT
M$STLPP      53**DCL-ENT
M$STRAP      70**DCL-ENT
M$STRMATTR      42**DCL-ENT
M$STRMCTL      40**DCL-ENT
M$STRMTAB      43**DCL-ENT
PL6.E3A0      #002=EVENT_HNDLR File=TCT$TELNET.:TCA2TSI                          SUN 11/16/97 14:26 Page:154  
M$SYMBIO      81**DCL-ENT
M$SYSCON      67**DCL-ENT
M$SYSID      85**DCL-ENT
M$TDCLOSE      66**DCL-ENT
M$TDIO      66**DCL-ENT
M$TDOPEN      65**DCL-ENT
M$TDREQCPU      66**DCL-ENT
M$TEMPWROC      60**DCL-ENT
M$TIME      83**DCL-ENT
M$TRAP      70**DCL-ENT
M$TRMISC      45**DCL-ENT
M$TRMPRG      41**DCL-ENT
M$TRTN      74**DCL-ENT
M$TRUNC      17**DCL-ENT
M$TTIMER      70**DCL-ENT
M$UC      40**DCL
M$UMPL      57**DCL-ENT
M$UNFID      79**DCL-ENT
M$UNLATCH      36**DCL-ENT
M$UNSHARE      33**DCL-ENT
M$USRFIELD      76**DCL-ENT
M$VIRTUAL      51**DCL-ENT
M$WAIT      74**DCL-ENT
M$WEOF      19**DCL-ENT
M$WRITE      17**DCL-ENT
M$WRSYSLOG      65**DCL-ENT
M$XCON      71**DCL-ENT
M$XCONRTN      32**DCL-ENT
M$XEQTIME      84**DCL-ENT
M$XFLUSH      25**DCL-ENT
M$XMOUSE      62**DCL-ENT
M$XXX      28**DCL-ENT
M$YC      30**DCL-ENT
