VERSION E05

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:1    
        1        1        /*M* OCL$LISTER KEYINs routines to maintain history files */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*
       10       10
       11       11          ###    ###   #        #    #       ###    ###   #####  #####  ####
       12       12         # # #  #   #  #       ###   #        #    #   #    #    #      #   #
       13       13         # # #  #      #      # #    #        #    #        #    #      #   #
       14       14         #  ##  #      #       ###   #        #     ###     #    ####   ####
       15       15         #   #  #      #        # #  #        #        #    #    #      # #
       16       16         #   #  #   #  #       ###   #        #    #   #    #    #      #  #
       17       17          ###    ###   #####    #    #####   ###    ###     #    #####  #   #
       18       18
       19       19                                                                          */
       20       20                                                /**/
       21       21                                                /**/
       22       22        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:2    
       23       23                                                /**/
       24       24        /*M* OCL$INIT KEYINs procedure to setup and examine its history file */
       25       25                                                /**/
       26       26        /*
       27       27          ###    ###   #        #     ###   #   #   ###   #####
       28       28         # # #  #   #  #       ###     #    #   #    #      #
       29       29         # # #  #      #      # #      #    ##  #    #      #
       30       30         #  ##  #      #       ###     #    # # #    #      #
       31       31         #   #  #      #        # #    #    #  ##    #      #
       32       32         #   #  #   #  #       ###     #    #   #    #      #
       33       33          ###    ###   #####    #     ###   #   #   ###     #
       34       34                                                                          */
       35       35                                                /**/
       36       36        OCL$INIT: PROC (FROM_IND);
       37       37                                                /**/
       38       38    1   DCL FROM_IND UBIN WORD;
       39       39                                                /**/
       40       40        %INCLUDE OCI_SUBS_C;
       41      138        %INCLUDE OC_SUBS_C;
       42      869                                                /**/
       43      870        %INCLUDE CP_6;
       44      951        %INCLUDE OC_DAT_R;
       45     1112        %INCLUDE B$JIT;
       46     1402                                                /**/
       47     1403    1   DCL B$JIT$ PTR SYMREF;
       48     1404                                                /**/
       49     1405    1   DCL B$TCB$ PTR SYMREF;
       50     1406             %B$TCB;
       51     1409             %B$ALT;
       52     1417                                                /**/
       53     1418        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
       54     1419                                                /**/
       55     1420                                                /**/
       56     1421        %INCLUDE B_ERRORS_C;
       57     2548                                                /**/
       58     2549    1   DCL OCL$RLS ENTRY(2);
       59     2550                                                /**/
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:3    
       60     2551    1   DCL F$HISTFILE DCB;
       61     2552                                                /**/
       62     2553    1   DCL OCL$STATUS ENTRY(1);
       63     2554    1   DCL OCO$IWRITE ENTRY(8);
       64     2555    1   DCL MSG# UBIN HALF UNAL STATIC INIT (380 /* LISTR_MSG# */);
       65     2556    1   DCL NP# UBIN BYTE UNAL STATIC INIT(2);
       66     2557    1   DCL FROM_IND_HOLDER UBIN WORD STATIC;
       67     2558    1   DCL 1 OCL_NAME STATIC CALIGNED,
       68     2559    1            2 C UBIN BYTE CALIGNED INIT (25),
       69     2560    1            2 * CHAR(0) INIT (':OCHIST'),
       70     2561    1            2 CENTURY CHAR(2) INIT ('CC'),
       71     2562    1            2 DATE CHAR(6) INIT ('YYMMDD'),
       72     2563    1            2 TIME CHAR(4) INIT ('HHMM'),
       73     2564    1            2 * CHAR(0) INIT ('BROKEN');
       74     2565                                                /**/
       75     2566        %INCLUDE OCL_DATA_R;
       76     2591                                                /**/
       77     2592             %FPT_OPEN      (FPTN=OPEN_HISTORYE,
       78     2593                                 NAME=OCHIST,
       79     2594                                 ACCT=SYS,
       80     2595                                 ASN=FILE,
       81     2596                                 ACS=DIRECT,
       82     2597                                 DCB=F$HISTFILE,
       83     2598                                 CTG=YES,
       84     2599                                 DISP=NAMED,
       85     2600                                 ACSVEH=HIST_ACSVEH,
       86     2601                                 FUN=CREATE,
       87     2602                                 IXTNSIZE=200,
       88     2603                                 XTNSIZE=100,
       89     2604                                 EXIST=ERROR,
       90     2605                                 ORG=KEYED);
       91     2714                                                /**/
       92     2715                  %VLP_NAME (FPTN=OCHIST,
       93     2716                                 NAME=':OCHIST');
       94     2743                                                /**/
       95     2744                  %VLP_ACCT (FPTN=SYS,
       96     2745                                      ACCT=':SYSTAC');
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:4    
       97     2758                                                /**/
       98     2759             %FPT_OPEN      (FPTN=OPEN_HISTORYU,
       99     2760                                 NAME=OCHIST,
      100     2761                                 ACCT=SYS,
      101     2762                                 ASN=FILE,
      102     2763                                 ACS=DIRECT,
      103     2764                                 DCB=F$HISTFILE,
      104     2765                                 DISP=NAMED,
      105     2766                                 ACSVEH=HIST_ACSVEH,
      106     2767                                 CTG=YES,
      107     2768                                 FUN=UPDATE,
      108     2769                                 ORG=KEYED);
      109     2878                                                /**/
      110     2879             %FPT_OPEN      (FPTN=OPEN_HISTORYR,
      111     2880                                 NAME=OCHIST,
      112     2881                                 ACCT=SYS,
      113     2882                                 ASN=FILE,
      114     2883                                 ACS=DIRECT,
      115     2884                                 DCB=F$HISTFILE,
      116     2885                                 DISP=NAMED,
      117     2886                                 ACSVEH=HIST_ACSVEH,
      118     2887                                 CTG=YES,
      119     2888                                 FUN=UPDATE,
      120     2889                                 SHARE=IN,
      121     2890                                 ORG=KEYED);
      122     2999                                                /**/
      123     3000
      124     3001        %VLP_ATTR(FPTN=HIST_ACSVEH,STCLASS=CONSTANT);
      125     3015        %VLP_ACSVEH(VEHICLE='REPLAY',READ=YES,LAST=";");
      126     3032
      127     3033             %FPT_READ      (FPTN=READ_STATUS,
      128     3034                            BUF=OCL_STATUS_REC,
      129     3035                                 DCB=F$HISTFILE,
      130     3036                                 KEY=OCL_STATUS_KEY,
      131     3037                                 KEYS=YES,
      132     3038                                 WAIT=YES);
      133     3077                                                /**/
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:5    
      134     3078             %FPT_WRITE     (FPTN=WRITE_STATUS,
      135     3079                            BUF=OCL_STATUS_REC,
      136     3080                                 DCB=F$HISTFILE,
      137     3081                                 KEY=OCL_STATUS_KEY,
      138     3082                                 WAIT=YES);
      139     3113                                                /**/
      140     3114             %FPT_CLOSE     (FPTN=CLOSE_SAVE,
      141     3115                                 DCB=F$HISTFILE);
      142     3157                                                /**/
      143     3158             %FPT_PRIV      (FPTN=RESET_FMSEC,
      144     3159                                 PRIV=%PR_FMSEC#);
      145     3174
      146     3175                                                /**/
      147     3176             %FPT_PFIL      (FPTN=FIND_END,
      148     3177                                 DCB=F$HISTFILE);
      149     3192                                                /**/
      150     3193             %FPT_TIME      (FPTN=TURNOVER_TIME,
      151     3194                                 DATE=OCL_NAME.DATE,
      152     3195                                 TIME=OCL_NAME.TIME,
      153     3196                                 DEST=ANS,
      154     3197                                 SOURCE=CLOCK);
      155     3216                                                /**/
      156     3217        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:6    
      157     3218        /*
      158     3219                  S U B R O U T I N E     O C L $ O P E N
      159     3220        */
      160     3221    1   OCL$OPEN: PROC ALTRET;
      161     3222    2   BEGIN:;
      162     3223    2        OC_LIST = '0'B /*FALSE#*/;
      163     3224                                                /**/
      164     3225    2        CALL M$SPRIV (RESET_FMSEC) ALTRET (PROCEED1);
      165     3226    2   PROCEED1:;
      166     3227    2        CALL M$OPEN (OPEN_HISTORYE) ALTRET(ALREADY_HERE);
      167     3228                                                /**/
      168     3229    2        CALL M$CLOSE (CLOSE_SAVE) ALTRET (ALT_RET);
      169     3230                                                /**/
      170     3231    2   ALREADY_HERE: ;
      171     3232                                                /**/
      172     3233    2        IF OC_REPLAYS# > 0
      173     3234    2        THEN
      174     3235    2             CALL M$OPEN (OPEN_HISTORYR)
      175     3236    2                  ALTRET (ALT_RET);
      176     3237    2        ELSE
      177     3238    2             CALL M$OPEN (OPEN_HISTORYU)
      178     3239    2                  ALTRET (ALT_RET);
      179     3240                                                /**/
      180     3241    2        CALL M$RPRIV (RESET_FMSEC) ALTRET (PROCEED2);
      181     3242    2   PROCEED2:;
      182     3243                                                /**/
      183     3244    2        RETURN;
      184     3245                                                /**/
      185     3246    2   ALT_RET:;
      186     3247    2        ALTRETURN;
      187     3248    2   END OCL$OPEN;
      188     3249        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:7    
      189     3250        /*
      190     3251                  Begin   O C L $ I N I T   main
      191     3252                                                     */
      192     3253
      193     3254                                                /**/
      194     3255                                      /* Note: after a file release operation
      195     3256                                         the read will always altret because
      196     3257                                         :OCHIST is empty. */
      197     3258                                                /**/
      198     3259    1        FROM_IND_HOLDER = FROM_IND;
      199     3260    1        CALL OCL$OPEN ALTRET (NO_CAN_DO);
      200     3261    1        CALL M$READ (READ_STATUS) ALTRET(NO_SUCH_KEY);
      201     3262                                                /**/
      202     3263                                                /* SAVE TURNOVER INFORMATION */
      203     3264    1        OC_HIST_SAVE.ACTIVE = OCL_STATUS_REC.OACTIVE;
      204     3265    1        OC_HIST_SAVE.HOUR = OCL_STATUS_REC.OHOUR;
      205     3266    1        OC_HIST_SAVE.MIN = OCL_STATUS_REC.OMIN;
      206     3267    1        OC_ACCT_SAVE.ACTIVE = OCL_STATUS_REC.AACTIVE;
      207     3268    1        OC_ACCT_SAVE.HOUR = OCL_STATUS_REC.AHOUR;
      208     3269    1        OC_ACCT_SAVE.MIN = OCL_STATUS_REC.AMIN;
      209     3270    1        OCL_CONSOLE_FIELD = OCL_STATUS_REC.CONSOLE_KEY;
      210     3271                                                /**/
      211     3272                                           /* The OCL$KEYIN routines
      212     3273                                                store their own prev file.
      213     3274                                                When keyin starts, it doesnt
      214     3275                                                go through the OCLs. */
      215     3276                                                /**/
      216     3277                                      /* This section checks for broken
      217     3278                                         :OCHIST files.  If the file is
      218     3279                                         broken, KEYIN will turn it over */
      219     3280                                                /**/
      220     3281    1        FIND_END.V.BOF# = '0'B;
      221     3282    1        CALL M$PFIL (FIND_END) ALTRET (FILE_TROUBLE);
      222     3283                                                /**/
      223     3284                                                /* Put it back */
      224     3285                                                /**/
      225     3286    1        FIND_END.V.BOF# = '1'B;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:8    
      226     3287    1        CALL M$PFIL (FIND_END) ALTRET (SO_WHAT);
      227     3288    1   SO_WHAT:;
      228     3289                                                /**/
      229     3290    2        DO WHILE ('0'B);
      230     3291    2   FILE_TROUBLE:
      231     3292    2             OCL_BROKEN_FILE = '1'B;
      232     3293    3             CALL M$TIME (TURNOVER_TIME) WHENALTRETURN DO; END;
      233     3294    2             IF SUBSTR (OCL_NAME.DATE, 0, 2) < '78'
      234     3295    2             THEN
      235     3296    2                  OCL_NAME.CENTURY = '20';
      236     3297    2             ELSE
      237     3298    2                  OCL_NAME.CENTURY = '19';
      238     3299    2             OC_LIST = '1'B /*TRUE#*/;
      239     3300    2             CALL OCL$RLS ('200000'O /* M_SYS  */, OCL_NAME);
      240     3301    2             OC_LIST = '0'B /*FALSE#*/;
      241     3302    2             FROM_IND_HOLDER = 5 /* FROM_OCL_RLS# */;
      242     3303    2             CALL OCL$OPEN ALTRET (NO_CAN_DO);
      243     3304    2           END;
      244     3305                                                /**/
      245     3306                                                /**/
      246     3307    1        IF FROM_IND_HOLDER ~= 5 /* FROM_OCL_RLS# */
      247     3308    1        THEN
      248     3309    1             OCL_PREVIOUS_FILE = OCL_STATUS_REC.PREV_FILE;
      249     3310                                                /**/
      250     3311                                      /* If the previous file was broken we
      251     3312                                         just turned it over and opened a
      252     3313                                         new :OCHIST.  Reset FROM_IND_HOLDER
      253     3314                                         to continue as if there was no
      254     3315                                         file trouble. */
      255     3316                                                /**/
      256     3317    1        IF OCL_BROKEN_FILE = '1'B
      257     3318    1        THEN
      258     3319    2        DO;
      259     3320    2             OCL_BROKEN_FILE = '0'B;
      260     3321    2             FROM_IND_HOLDER = 2 /* FROM_OCP# */;
      261     3322    2           END;
      262     3323                                                /**/
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:9    
      263     3324    1        IF OCL_STATUS_REC.LSTATUS = 0
      264     3325    1             AND
      265     3326    1             FROM_IND_HOLDER = 2 /* FROM_OCP# */
      266     3327    1        THEN
      267     3328    2        DO;
      268     3329    2             OCL_MSGB.CODE = 0;
      269     3330    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      270     3331    2                  0, '        ', 0);
      271     3332    2             CALL M$CLOSE (CLOSE_SAVE) ALTRET (OOPS0);
      272     3333    2   OOPS0:    ;
      273     3334    2             CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */); /* UPDATE BOTH ACCT & HIST */
      274     3335    2             RETURN;
      275     3336    2           END;
      276     3337                                                /**/
      277     3338    1        IF OCL_STATUS_REC.LSTATUS = 1
      278     3339
      279     3340    1             AND
      280     3341    1             FROM_IND_HOLDER = 2 /* FROM_OCP# */
      281     3342    1        THEN
      282     3343    2        DO;
      283     3344    2             OC_LIST = '1'B /*TRUE#*/;
      284     3345    2             OCL_MSGB.CODE = 1;
      285     3346    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      286     3347    2                  0, '        ', 0);
      287     3348    2             CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */); /* UPDATE BOTH ACCT & HIST */
      288     3349    2             RETURN;
      289     3350    2           END;
      290     3351                                                /**/
      291     3352                                                /**/
      292     3353                                                /* SAVE TURNOVER INFORMATION */
      293     3354    1        OCL_STATUS_REC.LSTATUS = 1;
      294     3355    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;
      295     3356    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;
      296     3357    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;
      297     3358    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;
      298     3359    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;
      299     3360    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:10   
      300     3361    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;
      301     3362    1        OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;
      302     3363                                                /**/
      303     3364    1        CALL M$WRITE (WRITE_STATUS) ALTRET (NO_CAN_DO);
      304     3365                                                /**/
      305     3366    1        OC_LIST = '1'B /*TRUE#*/;
      306     3367                                                /**/
      307     3368    1        OCL_MSGB.CODE = 2;
      308     3369    1        CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      309     3370    1             0, '        ', 0);
      310     3371    1        RETURN;
      311     3372        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:11   
      312     3373                                                /**/
      313     3374    1   NO_SUCH_KEY: ;
      314     3375                                                /**/
      315     3376    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      316     3377    1             AND
      317     3378    1             FROM_IND_HOLDER = 2 /* FROM_OCP# */
      318     3379    1        THEN
      319     3380    2        DO;
      320     3381                                                /* SAVE TURNOVER INFORMATION */
      321     3382    2             OCL_STATUS_REC.LSTATUS = 1;
      322     3383    2             OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;
      323     3384    2             OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;
      324     3385    2             OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;
      325     3386    2             OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;
      326     3387    2             OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;
      327     3388    2             OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;
      328     3389    2             OCL_STATUS_REC.PREV_FILE.COUNT = 0;
      329     3390    2             OCL_STATUS_REC.PREV_FILE.TXT = ' ';
      330     3391    2             OCL_STATUS_REC.CONSOLE_KEY = 0;
      331     3392    2             OCL_CONSOLE_FIELD = 0;
      332     3393                                                /**/
      333     3394    2             CALL M$WRITE (WRITE_STATUS) ALTRET(NO_CAN_DO);
      334     3395    2             OC_LIST = '1'B /*TRUE#*/;
      335     3396    2             OCL_MSGB.CODE = 1;
      336     3397    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC,OCL_MSGB,
      337     3398    2                  0, '        ', 0);
      338     3399    2             CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */); /* UPDATE BOTH ACCT & HIST */
      339     3400    2             RETURN;
      340     3401    2           END;                            /* DO IF NOKEY AND OCP OR OCK */
      341     3402                                                /**/
      342     3403    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      343     3404    1             AND
      344     3405    1             (FROM_IND_HOLDER = 3 /* FROM_OCL# */
      345     3406    1             OR
      346     3407    1             FROM_IND_HOLDER = 5 /* FROM_OCL_RLS# */)
      347     3408    1        THEN
      348     3409    2        DO;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:12   
      349     3410    2             IF OC_TLIST
      350     3411    2             THEN
      351     3412    2                  OCL_STATUS_REC.LSTATUS = 1;
      352     3413    2             ELSE
      353     3414    2                  OCL_STATUS_REC.LSTATUS = 0;
      354     3415                                                /**/
      355     3416                                                /* SAVE TURNOVER INFORMATION */
      356     3417    2             OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;
      357     3418    2             OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;
      358     3419    2             OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;
      359     3420    2             OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;
      360     3421    2             OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;
      361     3422    2             OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;
      362     3423    2             IF FROM_IND_HOLDER = 5 THEN
      363     3424    2                  OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;
      364     3425    2             ELSE
      365     3426    3             DO;
      366     3427    3                  OCL_STATUS_REC.PREV_FILE.COUNT = 0;
      367     3428    3                  OCL_STATUS_REC.PREV_FILE.TXT = ' ';
      368     3429    3                END;
      369     3430    2             OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;
      370     3431                                                /**/
      371     3432    2             CALL M$WRITE (WRITE_STATUS) ALTRET(NO_CAN_DO);
      372     3433    2             OC_LIST = OC_TLIST;
      373     3434    2             IF ~OC_LIST
      374     3435    2             THEN
      375     3436    3             DO;
      376     3437    3                  CALL M$CLOSE (CLOSE_SAVE) ALTRET(OOPS2);
      377     3438    3   OOPS2:         ;
      378     3439    3                  OCL_MSGB.CODE = 5;
      379     3440    3                END;                       /* DO IF LISTING OFF */
      380     3441    2             ELSE
      381     3442    2                  OCL_MSGB.CODE = 4;
      382     3443                                                /**/
      383     3444    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC,OCL_MSGB,
      384     3445    2                  0, ' ', 0);
      385     3446    2             RETURN;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:13   
      386     3447    2           END;                            /* DO IF NOKEY AND FROM OCL */
      387     3448                                                /**/
      388     3449    1   NO_CAN_DO: ;
      389     3450                                                /**/
      390     3451        /* Save error code before we do anything that can clobber it        */
      391     3452    1        OCL_MSGB.CODE = 3;
      392     3453    1        OCL_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      393     3454    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PROCEED3);
      394     3455    1   PROCEED3:;
      395     3456    1        CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      396     3457    1             0, '        ', 0);
      397     3458    1        CALL M$CLOSE (CLOSE_SAVE) ALTRET (OOPS3);
      398     3459    1   OOPS3: ;
      399     3460    1        RETURN;
      400     3461    1   END OCL$INIT;
      401     3462        %EOD;

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:14   
--  Include file information  --

   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$INIT.

   Procedure OCL$INIT requires 341 words for executable code.
   Procedure OCL$INIT requires 6 words of local(AUTO) storage.

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:15   

 Object Unit name= OCL$INIT                                   File name= OCL$LISTER.:E05TOU
 UTS= JUL 30 '97 03:59:07.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  F$HISTFILE
    2   Data  even  none   264    410  OCL$INIT
    3  RoData even  UTS      9     11  OCL$INIT
    4   Proc  even  none   341    525  OCL$INIT
    5  RoData even  none    20     24  OCL$INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  OCL$INIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       8 OCO$IWRITE
         yes           Std       1 OCL$STATUS
         yes           Std       2 OCL$RLS
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:16   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     OC_LIST                               OC_TLIST                              OC_HIST_SAVE
     OC_ACCT_SAVE                          OC_REPLAYS#                           B$JIT$
     B$TCB$                                F$HISTFILE                            OCL_STATUS_REC
     OCL_PREVIOUS_FILE                     OCL_STATUS_KEY                        OCL_MSGC
     OCL_MSGB                              OCL_CONSOLE_FIELD                     OCL_BROKEN_FILE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:17   


        1        1        /*M* OCL$LISTER KEYINs routines to maintain history files */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*
       10       10
       11       11          ###    ###   #        #    #       ###    ###   #####  #####  ####
       12       12         # # #  #   #  #       ###   #        #    #   #    #    #      #   #
       13       13         # # #  #      #      # #    #        #    #        #    #      #   #
       14       14         #  ##  #      #       ###   #        #     ###     #    ####   ####
       15       15         #   #  #      #        # #  #        #        #    #    #      # #
       16       16         #   #  #   #  #       ###   #        #    #   #    #    #      #  #
       17       17          ###    ###   #####    #    #####   ###    ###     #    #####  #   #
       18       18
       19       19                                                                          */
       20       20                                                /**/
       21       21                                                /**/
       22       22        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:18   
       23       23                                                /**/
       24       24        /*M* OCL$INIT KEYINs procedure to setup and examine its history file */
       25       25                                                /**/
       26       26        /*
       27       27          ###    ###   #        #     ###   #   #   ###   #####
       28       28         # # #  #   #  #       ###     #    #   #    #      #
       29       29         # # #  #      #      # #      #    ##  #    #      #
       30       30         #  ##  #      #       ###     #    # # #    #      #
       31       31         #   #  #      #        # #    #    #  ##    #      #
       32       32         #   #  #   #  #       ###     #    #   #    #      #
       33       33          ###    ###   #####    #     ###   #   #   ###     #
       34       34                                                                          */
       35       35                                                /**/
       36       36        OCL$INIT: PROC (FROM_IND);

     36  4 000000   000000 700200 xent  OCL$INIT     TSX0  ! X66_AUTO_1
         4 000001   000006 000001                    ZERO    6,1
         4 000002   000044 710000 4                  TRA     s:3259

       37       37                                                /**/
       38       38    1   DCL FROM_IND UBIN WORD;
       39       39                                                /**/
       40       40        %INCLUDE OCI_SUBS_C;
       41      138        %INCLUDE OC_SUBS_C;
       42      869                                                /**/
       43      870        %INCLUDE CP_6;
       44      951        %INCLUDE OC_DAT_R;
       45     1112        %INCLUDE B$JIT;
       46     1402                                                /**/
       47     1403    1   DCL B$JIT$ PTR SYMREF;
       48     1404                                                /**/
       49     1405    1   DCL B$TCB$ PTR SYMREF;
       50     1406             %B$TCB;
       51     1409             %B$ALT;
       52     1417                                                /**/
       53     1418        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
       54     1419                                                /**/
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:19   
       55     1420                                                /**/
       56     1421        %INCLUDE B_ERRORS_C;
       57     2548                                                /**/
       58     2549    1   DCL OCL$RLS ENTRY(2);
       59     2550                                                /**/
       60     2551    1   DCL F$HISTFILE DCB;
       61     2552                                                /**/
       62     2553    1   DCL OCL$STATUS ENTRY(1);
       63     2554    1   DCL OCO$IWRITE ENTRY(8);
       64     2555    1   DCL MSG# UBIN HALF UNAL STATIC INIT (380 /* LISTR_MSG# */);
       65     2556    1   DCL NP# UBIN BYTE UNAL STATIC INIT(2);
       66     2557    1   DCL FROM_IND_HOLDER UBIN WORD STATIC;
       67     2558    1   DCL 1 OCL_NAME STATIC CALIGNED,
       68     2559    1            2 C UBIN BYTE CALIGNED INIT (25),
       69     2560    1            2 * CHAR(0) INIT (':OCHIST'),
       70     2561    1            2 CENTURY CHAR(2) INIT ('CC'),
       71     2562    1            2 DATE CHAR(6) INIT ('YYMMDD'),
       72     2563    1            2 TIME CHAR(4) INIT ('HHMM'),
       73     2564    1            2 * CHAR(0) INIT ('BROKEN');
       74     2565                                                /**/
       75     2566        %INCLUDE OCL_DATA_R;
       76     2591                                                /**/
       77     2592             %FPT_OPEN      (FPTN=OPEN_HISTORYE,
       78     2593                                 NAME=OCHIST,
       79     2594                                 ACCT=SYS,
       80     2595                                 ASN=FILE,
       81     2596                                 ACS=DIRECT,
       82     2597                                 DCB=F$HISTFILE,
       83     2598                                 CTG=YES,
       84     2599                                 DISP=NAMED,
       85     2600                                 ACSVEH=HIST_ACSVEH,
       86     2601                                 FUN=CREATE,
       87     2602                                 IXTNSIZE=200,
       88     2603                                 XTNSIZE=100,
       89     2604                                 EXIST=ERROR,
       90     2605                                 ORG=KEYED);
       91     2714                                                /**/
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:20   
       92     2715                  %VLP_NAME (FPTN=OCHIST,
       93     2716                                 NAME=':OCHIST');
       94     2743                                                /**/
       95     2744                  %VLP_ACCT (FPTN=SYS,
       96     2745                                      ACCT=':SYSTAC');
       97     2758                                                /**/
       98     2759             %FPT_OPEN      (FPTN=OPEN_HISTORYU,
       99     2760                                 NAME=OCHIST,
      100     2761                                 ACCT=SYS,
      101     2762                                 ASN=FILE,
      102     2763                                 ACS=DIRECT,
      103     2764                                 DCB=F$HISTFILE,
      104     2765                                 DISP=NAMED,
      105     2766                                 ACSVEH=HIST_ACSVEH,
      106     2767                                 CTG=YES,
      107     2768                                 FUN=UPDATE,
      108     2769                                 ORG=KEYED);
      109     2878                                                /**/
      110     2879             %FPT_OPEN      (FPTN=OPEN_HISTORYR,
      111     2880                                 NAME=OCHIST,
      112     2881                                 ACCT=SYS,
      113     2882                                 ASN=FILE,
      114     2883                                 ACS=DIRECT,
      115     2884                                 DCB=F$HISTFILE,
      116     2885                                 DISP=NAMED,
      117     2886                                 ACSVEH=HIST_ACSVEH,
      118     2887                                 CTG=YES,
      119     2888                                 FUN=UPDATE,
      120     2889                                 SHARE=IN,
      121     2890                                 ORG=KEYED);
      122     2999                                                /**/
      123     3000
      124     3001        %VLP_ATTR(FPTN=HIST_ACSVEH,STCLASS=CONSTANT);
      125     3015        %VLP_ACSVEH(VEHICLE='REPLAY',READ=YES,LAST=";");
      126     3032
      127     3033             %FPT_READ      (FPTN=READ_STATUS,
      128     3034                            BUF=OCL_STATUS_REC,
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:21   
      129     3035                                 DCB=F$HISTFILE,
      130     3036                                 KEY=OCL_STATUS_KEY,
      131     3037                                 KEYS=YES,
      132     3038                                 WAIT=YES);
      133     3077                                                /**/
      134     3078             %FPT_WRITE     (FPTN=WRITE_STATUS,
      135     3079                            BUF=OCL_STATUS_REC,
      136     3080                                 DCB=F$HISTFILE,
      137     3081                                 KEY=OCL_STATUS_KEY,
      138     3082                                 WAIT=YES);
      139     3113                                                /**/
      140     3114             %FPT_CLOSE     (FPTN=CLOSE_SAVE,
      141     3115                                 DCB=F$HISTFILE);
      142     3157                                                /**/
      143     3158             %FPT_PRIV      (FPTN=RESET_FMSEC,
      144     3159                                 PRIV=%PR_FMSEC#);
      145     3174
      146     3175                                                /**/
      147     3176             %FPT_PFIL      (FPTN=FIND_END,
      148     3177                                 DCB=F$HISTFILE);
      149     3192                                                /**/
      150     3193             %FPT_TIME      (FPTN=TURNOVER_TIME,
      151     3194                                 DATE=OCL_NAME.DATE,
      152     3195                                 TIME=OCL_NAME.TIME,
      153     3196                                 DEST=ANS,
      154     3197                                 SOURCE=CLOCK);
      155     3216                                                /**/
      156     3217        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:22   
      157     3218        /*
      158     3219                  S U B R O U T I N E     O C L $ O P E N
      159     3220        */
      160     3221    1   OCL$OPEN: PROC ALTRET;

   3221  4 000003   200004 741300       OCL$OPEN     STX1  ! @FROM_IND+1,,AUTO

   3221  4 000004                       BEGIN        null
      161     3222    2   BEGIN:;
      162     3223    2        OC_LIST = '0'B /*FALSE#*/;

   3223  4 000004   000000 450000 xsym               STZ     OC_LIST

      163     3224                                                /**/
      164     3225    2        CALL M$SPRIV (RESET_FMSEC) ALTRET (PROCEED1);

   3225  4 000005   000364 630400 2                  EPPR0   RESET_FMSEC
         4 000006   420012 713400                    CLIMB   alt,+8202
         4 000007   400000 401760                    pmme    nvectors=1
         4 000010   000011 702000 4                  TSX2    PROCEED1

   3223  4 000011                       PROCEED1     null
      165     3226    2   PROCEED1:;
      166     3227    2        CALL M$OPEN (OPEN_HISTORYE) ALTRET(ALREADY_HERE);

   3227  4 000011   000012 630400 2                  EPPR0   OPEN_HISTORYE
         4 000012   450000 713400                    CLIMB   alt,open
         4 000013   410400 401760                    pmme    nvectors=18
         4 000014   000021 702000 4                  TSX2    ALREADY_HERE

      167     3228                                                /**/
      168     3229    2        CALL M$CLOSE (CLOSE_SAVE) ALTRET (ALT_RET);

   3229  4 000015   000326 630400 2                  EPPR0   CLOSE_SAVE
         4 000016   450001 713400                    CLIMB   alt,close
         4 000017   406000 401760                    pmme    nvectors=13
         4 000020   000042 702000 4                  TSX2    ALT_RET
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:23   

   3223  4 000021                       ALREADY_HERE null
      169     3230                                                /**/
      170     3231    2   ALREADY_HERE: ;
      171     3232                                                /**/
      172     3233    2        IF OC_REPLAYS# > 0

   3233  4 000021   000000 235000 xsym               LDA     OC_REPLAYS#
         4 000022   000030 604400 4                  TMOZ    s:3238

      173     3234    2        THEN
      174     3235    2             CALL M$OPEN (OPEN_HISTORYR)

   3235  4 000023   000202 630400 2                  EPPR0   OPEN_HISTORYR
         4 000024   450000 713400                    CLIMB   alt,open
         4 000025   410400 401760                    pmme    nvectors=18
         4 000026   000042 702000 4                  TSX2    ALT_RET
         4 000027   000034 710000 4                  TRA     s:3241

      175     3236    2                  ALTRET (ALT_RET);
      176     3237    2        ELSE
      177     3238    2             CALL M$OPEN (OPEN_HISTORYU)

   3238  4 000030   000110 630400 2                  EPPR0   OPEN_HISTORYU
         4 000031   450000 713400                    CLIMB   alt,open
         4 000032   410400 401760                    pmme    nvectors=18
         4 000033   000042 702000 4                  TSX2    ALT_RET

      178     3239    2                  ALTRET (ALT_RET);
      179     3240                                                /**/
      180     3241    2        CALL M$RPRIV (RESET_FMSEC) ALTRET (PROCEED2);

   3241  4 000034   000364 630400 2                  EPPR0   RESET_FMSEC
         4 000035   420013 713400                    CLIMB   alt,+8203
         4 000036   400000 401760                    pmme    nvectors=1
         4 000037   000040 702000 4                  TSX2    PROCEED2

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:24   
   3233  4 000040                       PROCEED2     null
      181     3242    2   PROCEED2:;
      182     3243                                                /**/
      183     3244    2        RETURN;

   3244  4 000040   200004 221300                    LDX1  ! @FROM_IND+1,,AUTO
         4 000041   000001 702211                    TSX2  ! 1,X1

   3233  4 000042                       ALT_RET      null
      184     3245                                                /**/
      185     3246    2   ALT_RET:;
      186     3247    2        ALTRETURN;

   3247  4 000042   200004 221300                    LDX1  ! @FROM_IND+1,,AUTO
         4 000043   000000 702211                    TSX2  ! 0,X1

      187     3248    2   END OCL$OPEN;
      188     3249        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:25   
      189     3250        /*
      190     3251                  Begin   O C L $ I N I T   main
      191     3252                                                     */
      192     3253
      193     3254                                                /**/
      194     3255                                      /* Note: after a file release operation
      195     3256                                         the read will always altret because
      196     3257                                         :OCHIST is empty. */
      197     3258                                                /**/
      198     3259    1        FROM_IND_HOLDER = FROM_IND;

   3259  4 000044   200003 470500                    LDP0    @FROM_IND,,AUTO
         4 000045   000000 235100                    LDA     0,,PR0
         4 000046   000002 755000 2                  STA     FROM_IND_HOLDER

      199     3260    1        CALL OCL$OPEN ALTRET (NO_CAN_DO);

   3260  4 000047   000003 701000 4                  TSX1    OCL$OPEN
         4 000050   000502 702000 4                  TSX2    NO_CAN_DO

      200     3261    1        CALL M$READ (READ_STATUS) ALTRET(NO_SUCH_KEY);

   3261  4 000051   000274 630400 2                  EPPR0   READ_STATUS
         4 000052   440000 713400                    CLIMB   alt,read
         4 000053   401400 401760                    pmme    nvectors=4
         4 000054   000303 702000 4                  TSX2    NO_SUCH_KEY

      201     3262                                                /**/
      202     3263                                                /* SAVE TURNOVER INFORMATION */
      203     3264    1        OC_HIST_SAVE.ACTIVE = OCL_STATUS_REC.OACTIVE;

   3264  4 000055   000002 236000 xsym               LDQ     OCL_STATUS_REC+2
         4 000056   000000 676000 xsym               ERQ     OC_HIST_SAVE
         4 000057   400000 376003                    ANQ     -131072,DU
         4 000060   000000 656000 xsym               ERSQ    OC_HIST_SAVE

      204     3265    1        OC_HIST_SAVE.HOUR = OCL_STATUS_REC.OHOUR;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:26   

   3265  4 000061   000002 236000 xsym               LDQ     OCL_STATUS_REC+2
         4 000062   000000 676000 xsym               ERQ     OC_HIST_SAVE
         4 000063   377777 376003                    ANQ     131071,DU
         4 000064   000000 656000 xsym               ERSQ    OC_HIST_SAVE

      205     3266    1        OC_HIST_SAVE.MIN = OCL_STATUS_REC.OMIN;

   3266  4 000065   000002 720000 xsym               LXL0    OCL_STATUS_REC+2
         4 000066   000000 440000 xsym               SXL0    OC_HIST_SAVE

      206     3267    1        OC_ACCT_SAVE.ACTIVE = OCL_STATUS_REC.AACTIVE;

   3267  4 000067   000001 236000 xsym               LDQ     OCL_STATUS_REC+1
         4 000070   000000 676000 xsym               ERQ     OC_ACCT_SAVE
         4 000071   400000 376003                    ANQ     -131072,DU
         4 000072   000000 656000 xsym               ERSQ    OC_ACCT_SAVE

      207     3268    1        OC_ACCT_SAVE.HOUR = OCL_STATUS_REC.AHOUR;

   3268  4 000073   000001 236000 xsym               LDQ     OCL_STATUS_REC+1
         4 000074   000000 676000 xsym               ERQ     OC_ACCT_SAVE
         4 000075   377777 376003                    ANQ     131071,DU
         4 000076   000000 656000 xsym               ERSQ    OC_ACCT_SAVE

      208     3269    1        OC_ACCT_SAVE.MIN = OCL_STATUS_REC.AMIN;

   3269  4 000077   000001 721000 xsym               LXL1    OCL_STATUS_REC+1
         4 000100   000000 441000 xsym               SXL1    OC_ACCT_SAVE

      209     3270    1        OCL_CONSOLE_FIELD = OCL_STATUS_REC.CONSOLE_KEY;

   3270  4 000101   000013 235000 xsym               LDA     OCL_STATUS_REC+11
         4 000102   000000 755000 xsym               STA     OCL_CONSOLE_FIELD

      210     3271                                                /**/
      211     3272                                           /* The OCL$KEYIN routines
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:27   
      212     3273                                                store their own prev file.
      213     3274                                                When keyin starts, it doesnt
      214     3275                                                go through the OCLs. */
      215     3276                                                /**/
      216     3277                                      /* This section checks for broken
      217     3278                                         :OCHIST files.  If the file is
      218     3279                                         broken, KEYIN will turn it over */
      219     3280                                                /**/
      220     3281    1        FIND_END.V.BOF# = '0'B;

   3281  4 000103   000000 236000 5                  LDQ     0
         4 000104   000372 356000 2                  ANSQ    FIND_END+2

      221     3282    1        CALL M$PFIL (FIND_END) ALTRET (FILE_TROUBLE);

   3282  4 000105   000370 630400 2                  EPPR0   FIND_END
         4 000106   440004 713400                    CLIMB   alt,+16388
         4 000107   400000 401760                    pmme    nvectors=1
         4 000110   000120 702000 4                  TSX2    FILE_TROUBLE

      222     3283                                                /**/
      223     3284                                                /* Put it back */
      224     3285                                                /**/
      225     3286    1        FIND_END.V.BOF# = '1'B;

   3286  4 000111   400000 236007                    LDQ     -131072,DL
         4 000112   000372 256000 2                  ORSQ    FIND_END+2

      226     3287    1        CALL M$PFIL (FIND_END) ALTRET (SO_WHAT);

   3287  4 000113   000370 630400 2                  EPPR0   FIND_END
         4 000114   440004 713400                    CLIMB   alt,+16388
         4 000115   400000 401760                    pmme    nvectors=1
         4 000116   000117 702000 4                  TSX2    SO_WHAT

   3286  4 000117                       SO_WHAT      null
      227     3288    1   SO_WHAT:;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:28   
      228     3289                                                /**/
      229     3290    2        DO WHILE ('0'B);

   3290  4 000117   000152 710000 4                  TRA     s:3307

      230     3291    2   FILE_TROUBLE:
      231     3292    2             OCL_BROKEN_FILE = '1'B;

   3292  4 000120   400000 236003       FILE_TROUBLE LDQ     -131072,DU
         4 000121   000000 756000 xsym               STQ     OCL_BROKEN_FILE

      232     3293    3             CALL M$TIME (TURNOVER_TIME) WHENALTRETURN DO; END;

   3293  4 000122   000374 630400 2                  EPPR0   TURNOVER_TIME
         4 000123   420004 713400                    CLIMB   alt,+8196
         4 000124   402000 401760                    pmme    nvectors=5
         4 000125   000127 702000 4                  TSX2    s:3294
         4 000126   000127 710000 4                  TRA     s:3294

      233     3294    2             IF SUBSTR (OCL_NAME.DATE, 0, 2) < '78'

   3294  4 000127   000005 720000 2                  LXL0    OCL_NAME+2
         4 000130   000004 100000 3                  CMPX0   HIST_ACSVEH+4
         4 000131   000135 603000 4                  TRC     s:3298

      234     3295    2             THEN
      235     3296    2                  OCL_NAME.CENTURY = '20';

   3296  4 000132   000005 221000 3                  LDX1    HIST_ACSVEH+5
         4 000133   000005 741000 2                  STX1    OCL_NAME+2
         4 000134   000137 710000 4                  TRA     s:3299

      236     3297    2             ELSE
      237     3298    2                  OCL_NAME.CENTURY = '19';

   3298  4 000135   000006 221000 3                  LDX1    HIST_ACSVEH+6
         4 000136   000005 741000 2                  STX1    OCL_NAME+2
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:29   

      238     3299    2             OC_LIST = '1'B /*TRUE#*/;

   3299  4 000137   400000 236003                    LDQ     -131072,DU
         4 000140   000000 756000 xsym               STQ     OC_LIST

      239     3300    2             CALL OCL$RLS ('200000'O /* M_SYS  */, OCL_NAME);

   3300  4 000141   000002 630400 5                  EPPR0   2
         4 000142   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000143   000000 701000 xent               TSX1    OCL$RLS
         4 000144   000000 011000                    NOP     0

      240     3301    2             OC_LIST = '0'B /*FALSE#*/;

   3301  4 000145   000000 450000 xsym               STZ     OC_LIST

      241     3302    2             FROM_IND_HOLDER = 5 /* FROM_OCL_RLS# */;

   3302  4 000146   000005 235007                    LDA     5,DL
         4 000147   000002 755000 2                  STA     FROM_IND_HOLDER

      242     3303    2             CALL OCL$OPEN ALTRET (NO_CAN_DO);

   3303  4 000150   000003 701000 4                  TSX1    OCL$OPEN
         4 000151   000502 702000 4                  TSX2    NO_CAN_DO

      243     3304    2           END;

      244     3305                                                /**/
      245     3306                                                /**/
      246     3307    1        IF FROM_IND_HOLDER ~= 5 /* FROM_OCL_RLS# */

   3307  4 000152   000002 235000 2                  LDA     FROM_IND_HOLDER
         4 000153   000005 115007                    CMPA    5,DL
         4 000154   000160 600000 4                  TZE     s:3317

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:30   
      247     3308    1        THEN
      248     3309    1             OCL_PREVIOUS_FILE = OCL_STATUS_REC.PREV_FILE;

   3309  4 000155   000000 100400                    MLR     fill='000'O
         4 000156   000003 000040 xsym               ADSC9   OCL_STATUS_REC+3         cn=0,n=32
         4 000157   000000 000040 xsym               ADSC9   OCL_PREVIOUS_FILE        cn=0,n=32

      249     3310                                                /**/
      250     3311                                      /* If the previous file was broken we
      251     3312                                         just turned it over and opened a
      252     3313                                         new :OCHIST.  Reset FROM_IND_HOLDER
      253     3314                                         to continue as if there was no
      254     3315                                         file trouble. */
      255     3316                                                /**/
      256     3317    1        IF OCL_BROKEN_FILE = '1'B

   3317  4 000160   000000 234000 xsym               SZN     OCL_BROKEN_FILE
         4 000161   000165 605000 4                  TPL     s:3324

      257     3318    1        THEN
      258     3319    2        DO;

      259     3320    2             OCL_BROKEN_FILE = '0'B;

   3320  4 000162   000000 450000 xsym               STZ     OCL_BROKEN_FILE

      260     3321    2             FROM_IND_HOLDER = 2 /* FROM_OCP# */;

   3321  4 000163   000002 236007                    LDQ     2,DL
         4 000164   000002 756000 2                  STQ     FROM_IND_HOLDER

      261     3322    2           END;

      262     3323                                                /**/
      263     3324    1        IF OCL_STATUS_REC.LSTATUS = 0

   3324  4 000165   000000 235000 xsym               LDA     OCL_STATUS_REC
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:31   
         4 000166   000211 601000 4                  TNZ     s:3338
         4 000167   000002 236000 2                  LDQ     FROM_IND_HOLDER
         4 000170   000002 116007                    CMPQ    2,DL
         4 000171   000211 601000 4                  TNZ     s:3338

      264     3325    1             AND
      265     3326    1             FROM_IND_HOLDER = 2 /* FROM_OCP# */
      266     3327    1        THEN
      267     3328    2        DO;

      268     3329    2             OCL_MSGB.CODE = 0;

   3329  4 000172   000000 236003                    LDQ     0,DU
         4 000173   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      269     3330    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   3330  4 000174   000004 630400 5                  EPPR0   4
         4 000175   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000176   000000 701000 xent               TSX1    OCO$IWRITE
         4 000177   000000 011000                    NOP     0

      270     3331    2                  0, '        ', 0);
      271     3332    2             CALL M$CLOSE (CLOSE_SAVE) ALTRET (OOPS0);

   3332  4 000200   000326 630400 2                  EPPR0   CLOSE_SAVE
         4 000201   450001 713400                    CLIMB   alt,close
         4 000202   406000 401760                    pmme    nvectors=13
         4 000203   000204 702000 4                  TSX2    OOPS0

   3329  4 000204                       OOPS0        null
      272     3333    2   OOPS0:    ;
      273     3334    2             CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */); /* UPDATE BOTH ACCT & HIST */

   3334  4 000204   000011 630400 5                  EPPR0   9
         4 000205   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000206   000000 701000 xent               TSX1    OCL$STATUS
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:32   
         4 000207   000000 011000                    NOP     0

      274     3335    2             RETURN;

   3335  4 000210   000000 702200 xent               TSX2  ! X66_ARET

      275     3336    2           END;
      276     3337                                                /**/
      277     3338    1        IF OCL_STATUS_REC.LSTATUS = 1

   3338  4 000211   000001 115007                    CMPA    1,DL
         4 000212   000233 601000 4                  TNZ     s:3354
         4 000213   000002 236000 2                  LDQ     FROM_IND_HOLDER
         4 000214   000002 116007                    CMPQ    2,DL
         4 000215   000233 601000 4                  TNZ     s:3354

      278     3339
      279     3340    1             AND
      280     3341    1             FROM_IND_HOLDER = 2 /* FROM_OCP# */
      281     3342    1        THEN
      282     3343    2        DO;

      283     3344    2             OC_LIST = '1'B /*TRUE#*/;

   3344  4 000216   400000 236003                    LDQ     -131072,DU
         4 000217   000000 756000 xsym               STQ     OC_LIST

      284     3345    2             OCL_MSGB.CODE = 1;

   3345  4 000220   001000 236003                    LDQ     512,DU
         4 000221   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      285     3346    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   3346  4 000222   000004 630400 5                  EPPR0   4
         4 000223   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000224   000000 701000 xent               TSX1    OCO$IWRITE
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:33   
         4 000225   000000 011000                    NOP     0

      286     3347    2                  0, '        ', 0);
      287     3348    2             CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */); /* UPDATE BOTH ACCT & HIST */

   3348  4 000226   000011 630400 5                  EPPR0   9
         4 000227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000230   000000 701000 xent               TSX1    OCL$STATUS
         4 000231   000000 011000                    NOP     0

      288     3349    2             RETURN;

   3349  4 000232   000000 702200 xent               TSX2  ! X66_ARET

      289     3350    2           END;
      290     3351                                                /**/
      291     3352                                                /**/
      292     3353                                                /* SAVE TURNOVER INFORMATION */
      293     3354    1        OCL_STATUS_REC.LSTATUS = 1;

   3354  4 000233   000001 236007                    LDQ     1,DL
         4 000234   000000 756000 xsym               STQ     OCL_STATUS_REC

      294     3355    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;

   3355  4 000235   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000236   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000237   400000 376003                    ANQ     -131072,DU
         4 000240   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      295     3356    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;

   3356  4 000241   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000242   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000243   377777 376003                    ANQ     131071,DU
         4 000244   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:34   
      296     3357    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;

   3357  4 000245   000000 720000 xsym               LXL0    OC_HIST_SAVE
         4 000246   000002 440000 xsym               SXL0    OCL_STATUS_REC+2

      297     3358    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;

   3358  4 000247   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000250   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000251   400000 376003                    ANQ     -131072,DU
         4 000252   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      298     3359    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;

   3359  4 000253   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000254   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000255   377777 376003                    ANQ     131071,DU
         4 000256   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      299     3360    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;

   3360  4 000257   000000 721000 xsym               LXL1    OC_ACCT_SAVE
         4 000260   000001 441000 xsym               SXL1    OCL_STATUS_REC+1

      300     3361    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;

   3361  4 000261   000000 100400                    MLR     fill='000'O
         4 000262   000000 000040 xsym               ADSC9   OCL_PREVIOUS_FILE        cn=0,n=32
         4 000263   000003 000040 xsym               ADSC9   OCL_STATUS_REC+3         cn=0,n=32

      301     3362    1        OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;

   3362  4 000264   000000 235000 xsym               LDA     OCL_CONSOLE_FIELD
         4 000265   000013 755000 xsym               STA     OCL_STATUS_REC+11

      302     3363                                                /**/
      303     3364    1        CALL M$WRITE (WRITE_STATUS) ALTRET (NO_CAN_DO);
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:35   

   3364  4 000266   000312 630400 2                  EPPR0   WRITE_STATUS
         4 000267   440001 713400                    CLIMB   alt,write
         4 000270   401400 401760                    pmme    nvectors=4
         4 000271   000502 702000 4                  TSX2    NO_CAN_DO

      304     3365                                                /**/
      305     3366    1        OC_LIST = '1'B /*TRUE#*/;

   3366  4 000272   400000 236003                    LDQ     -131072,DU
         4 000273   000000 756000 xsym               STQ     OC_LIST

      306     3367                                                /**/
      307     3368    1        OCL_MSGB.CODE = 2;

   3368  4 000274   002000 236003                    LDQ     1024,DU
         4 000275   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      308     3369    1        CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   3369  4 000276   000004 630400 5                  EPPR0   4
         4 000277   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000300   000000 701000 xent               TSX1    OCO$IWRITE
         4 000301   000000 011000                    NOP     0

      309     3370    1             0, '        ', 0);
      310     3371    1        RETURN;

   3371  4 000302   000000 702200 xent               TSX2  ! X66_ARET

   3368  4 000303                       NO_SUCH_KEY  null
      311     3372        %EJECT;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:36   
      312     3373                                                /**/
      313     3374    1   NO_SUCH_KEY: ;
      314     3375                                                /**/
      315     3376    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

   3376  4 000303   000000 470400 xsym               LDP0    B$TCB$
         4 000304   000000 471500                    LDP1    0,,PR0
         4 000305   100102 236100                    LDQ     66,,PR1
         4 000306   377770 376007                    ANQ     131064,DL
         4 000307   001020 116007                    CMPQ    528,DL
         4 000310   000372 601000 4                  TNZ     s:3403
         4 000311   000002 235000 2                  LDA     FROM_IND_HOLDER
         4 000312   000002 115007                    CMPA    2,DL
         4 000313   000372 601000 4                  TNZ     s:3403

      316     3377    1             AND
      317     3378    1             FROM_IND_HOLDER = 2 /* FROM_OCP# */
      318     3379    1        THEN
      319     3380    2        DO;

      320     3381                                                /* SAVE TURNOVER INFORMATION */
      321     3382    2             OCL_STATUS_REC.LSTATUS = 1;

   3382  4 000314   000001 235007                    LDA     1,DL
         4 000315   000000 755000 xsym               STA     OCL_STATUS_REC

      322     3383    2             OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;

   3383  4 000316   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000317   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000320   400000 376003                    ANQ     -131072,DU
         4 000321   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      323     3384    2             OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;

   3384  4 000322   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000323   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:37   
         4 000324   377777 376003                    ANQ     131071,DU
         4 000325   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      324     3385    2             OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;

   3385  4 000326   000000 720000 xsym               LXL0    OC_HIST_SAVE
         4 000327   000002 440000 xsym               SXL0    OCL_STATUS_REC+2

      325     3386    2             OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;

   3386  4 000330   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000331   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000332   400000 376003                    ANQ     -131072,DU
         4 000333   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      326     3387    2             OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;

   3387  4 000334   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000335   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000336   377777 376003                    ANQ     131071,DU
         4 000337   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      327     3388    2             OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;

   3388  4 000340   000000 721000 xsym               LXL1    OC_ACCT_SAVE
         4 000341   000001 441000 xsym               SXL1    OCL_STATUS_REC+1

      328     3389    2             OCL_STATUS_REC.PREV_FILE.COUNT = 0;

   3389  4 000342   000000 236003                    LDQ     0,DU
         4 000343   000003 552040 xsym               STBQ    OCL_STATUS_REC+3,'40'O

      329     3390    2             OCL_STATUS_REC.PREV_FILE.TXT = ' ';

   3390  4 000344   040000 100400                    MLR     fill='040'O
         4 000345   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000346   000003 200037 xsym               ADSC9   OCL_STATUS_REC+3         cn=1,n=31
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:38   

      330     3391    2             OCL_STATUS_REC.CONSOLE_KEY = 0;

   3391  4 000347   000013 450000 xsym               STZ     OCL_STATUS_REC+11

      331     3392    2             OCL_CONSOLE_FIELD = 0;

   3392  4 000350   000000 450000 xsym               STZ     OCL_CONSOLE_FIELD

      332     3393                                                /**/
      333     3394    2             CALL M$WRITE (WRITE_STATUS) ALTRET(NO_CAN_DO);

   3394  4 000351   000312 630400 2                  EPPR0   WRITE_STATUS
         4 000352   440001 713400                    CLIMB   alt,write
         4 000353   401400 401760                    pmme    nvectors=4
         4 000354   000502 702000 4                  TSX2    NO_CAN_DO

      334     3395    2             OC_LIST = '1'B /*TRUE#*/;

   3395  4 000355   400000 236003                    LDQ     -131072,DU
         4 000356   000000 756000 xsym               STQ     OC_LIST

      335     3396    2             OCL_MSGB.CODE = 1;

   3396  4 000357   001000 236003                    LDQ     512,DU
         4 000360   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      336     3397    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC,OCL_MSGB,

   3397  4 000361   000004 630400 5                  EPPR0   4
         4 000362   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000363   000000 701000 xent               TSX1    OCO$IWRITE
         4 000364   000000 011000                    NOP     0

      337     3398    2                  0, '        ', 0);
      338     3399    2             CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */); /* UPDATE BOTH ACCT & HIST */

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:39   
   3399  4 000365   000011 630400 5                  EPPR0   9
         4 000366   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000367   000000 701000 xent               TSX1    OCL$STATUS
         4 000370   000000 011000                    NOP     0

      339     3400    2             RETURN;

   3400  4 000371   000000 702200 xent               TSX2  ! X66_ARET

      340     3401    2           END;                            /* DO IF NOKEY AND OCP OR OCK */
      341     3402                                                /**/
      342     3403    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

   3403  4 000372   001020 116007                    CMPQ    528,DL
         4 000373   000502 601000 4                  TNZ     NO_CAN_DO
         4 000374   000002 235000 2                  LDA     FROM_IND_HOLDER
         4 000375   000003 115007                    CMPA    3,DL
         4 000376   000401 600000 4                  TZE     s:3410
         4 000377   000005 115007                    CMPA    5,DL
         4 000400   000502 601000 4                  TNZ     NO_CAN_DO

      343     3404    1             AND
      344     3405    1             (FROM_IND_HOLDER = 3 /* FROM_OCL# */
      345     3406    1             OR
      346     3407    1             FROM_IND_HOLDER = 5 /* FROM_OCL_RLS# */)
      347     3408    1        THEN
      348     3409    2        DO;

      349     3410    2             IF OC_TLIST

   3410  4 000401   000000 234000 xsym               SZN     OC_TLIST
         4 000402   000406 605000 4                  TPL     s:3414

      350     3411    2             THEN
      351     3412    2                  OCL_STATUS_REC.LSTATUS = 1;

   3412  4 000403   000001 235007                    LDA     1,DL
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:40   
         4 000404   000000 755000 xsym               STA     OCL_STATUS_REC
         4 000405   000407 710000 4                  TRA     s:3417

      352     3413    2             ELSE
      353     3414    2                  OCL_STATUS_REC.LSTATUS = 0;

   3414  4 000406   000000 450000 xsym               STZ     OCL_STATUS_REC

      354     3415                                                /**/
      355     3416                                                /* SAVE TURNOVER INFORMATION */
      356     3417    2             OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;

   3417  4 000407   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000410   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000411   400000 376003                    ANQ     -131072,DU
         4 000412   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      357     3418    2             OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;

   3418  4 000413   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000414   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000415   377777 376003                    ANQ     131071,DU
         4 000416   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      358     3419    2             OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;

   3419  4 000417   000000 720000 xsym               LXL0    OC_HIST_SAVE
         4 000420   000002 440000 xsym               SXL0    OCL_STATUS_REC+2

      359     3420    2             OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;

   3420  4 000421   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000422   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000423   400000 376003                    ANQ     -131072,DU
         4 000424   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      360     3421    2             OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:41   

   3421  4 000425   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000426   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000427   377777 376003                    ANQ     131071,DU
         4 000430   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      361     3422    2             OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;

   3422  4 000431   000000 721000 xsym               LXL1    OC_ACCT_SAVE
         4 000432   000001 441000 xsym               SXL1    OCL_STATUS_REC+1

      362     3423    2             IF FROM_IND_HOLDER = 5 THEN

   3423  4 000433   000002 235000 2                  LDA     FROM_IND_HOLDER
         4 000434   000005 115007                    CMPA    5,DL
         4 000435   000442 601000 4                  TNZ     s:3427

      363     3424    2                  OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;

   3424  4 000436   000000 100400                    MLR     fill='000'O
         4 000437   000000 000040 xsym               ADSC9   OCL_PREVIOUS_FILE        cn=0,n=32
         4 000440   000003 000040 xsym               ADSC9   OCL_STATUS_REC+3         cn=0,n=32
         4 000441   000447 710000 4                  TRA     s:3430

      364     3425    2             ELSE
      365     3426    3             DO;

      366     3427    3                  OCL_STATUS_REC.PREV_FILE.COUNT = 0;

   3427  4 000442   000000 236003                    LDQ     0,DU
         4 000443   000003 552040 xsym               STBQ    OCL_STATUS_REC+3,'40'O

      367     3428    3                  OCL_STATUS_REC.PREV_FILE.TXT = ' ';

   3428  4 000444   040000 100400                    MLR     fill='040'O
         4 000445   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000446   000003 200037 xsym               ADSC9   OCL_STATUS_REC+3         cn=1,n=31
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:42   

      368     3429    3                END;

      369     3430    2             OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;

   3430  4 000447   000000 236000 xsym               LDQ     OCL_CONSOLE_FIELD
         4 000450   000013 756000 xsym               STQ     OCL_STATUS_REC+11

      370     3431                                                /**/
      371     3432    2             CALL M$WRITE (WRITE_STATUS) ALTRET(NO_CAN_DO);

   3432  4 000451   000312 630400 2                  EPPR0   WRITE_STATUS
         4 000452   440001 713400                    CLIMB   alt,write
         4 000453   401400 401760                    pmme    nvectors=4
         4 000454   000502 702000 4                  TSX2    NO_CAN_DO

      372     3433    2             OC_LIST = OC_TLIST;

   3433  4 000455   000000 236000 xsym               LDQ     OC_TLIST
         4 000456   400000 376003                    ANQ     -131072,DU
         4 000457   000000 756000 xsym               STQ     OC_LIST

      373     3434    2             IF ~OC_LIST

   3434  4 000460   000000 236000 xsym               LDQ     OC_LIST
         4 000461   400000 376003                    ANQ     -131072,DU
         4 000462   400000 676003                    ERQ     -131072,DU
         4 000463   000473 600000 4                  TZE     s:3442

      374     3435    2             THEN
      375     3436    3             DO;

      376     3437    3                  CALL M$CLOSE (CLOSE_SAVE) ALTRET(OOPS2);

   3437  4 000464   000326 630400 2                  EPPR0   CLOSE_SAVE
         4 000465   450001 713400                    CLIMB   alt,close
         4 000466   406000 401760                    pmme    nvectors=13
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:43   
         4 000467   000470 702000 4                  TSX2    OOPS2

   3437  4 000470                       OOPS2        null
      377     3438    3   OOPS2:         ;
      378     3439    3                  OCL_MSGB.CODE = 5;

   3439  4 000470   005000 236003                    LDQ     2560,DU
         4 000471   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      379     3440    3                END;                       /* DO IF LISTING OFF */

   3440  4 000472   000475 710000 4                  TRA     s:3444

      380     3441    2             ELSE
      381     3442    2                  OCL_MSGB.CODE = 4;

   3442  4 000473   004000 236003                    LDQ     2048,DU
         4 000474   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      382     3443                                                /**/
      383     3444    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC,OCL_MSGB,

   3444  4 000475   000014 630400 5                  EPPR0   12
         4 000476   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000477   000000 701000 xent               TSX1    OCO$IWRITE
         4 000500   000000 011000                    NOP     0

      384     3445    2                  0, ' ', 0);
      385     3446    2             RETURN;

   3446  4 000501   000000 702200 xent               TSX2  ! X66_ARET

   3437  4 000502                       NO_CAN_DO    null
      386     3447    2           END;                            /* DO IF NOKEY AND FROM OCL */
      387     3448                                                /**/
      388     3449    1   NO_CAN_DO: ;
      389     3450                                                /**/
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:44   
      390     3451        /* Save error code before we do anything that can clobber it        */
      391     3452    1        OCL_MSGB.CODE = 3;

   3452  4 000502   003000 236003                    LDQ     1536,DU
         4 000503   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      392     3453    1        OCL_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3453  4 000504   000000 470400 xsym               LDP0    B$TCB$
         4 000505   000000 471500                    LDP1    0,,PR0
         4 000506   100102 236100                    LDQ     66,,PR1
         4 000507   000000 756000 xsym               STQ     OCL_MSGB

      393     3454    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PROCEED3);

   3454  4 000510   000364 630400 2                  EPPR0   RESET_FMSEC
         4 000511   420013 713400                    CLIMB   alt,+8203
         4 000512   400000 401760                    pmme    nvectors=1
         4 000513   000514 702000 4                  TSX2    PROCEED3

   3453  4 000514                       PROCEED3     null
      394     3455    1   PROCEED3:;
      395     3456    1        CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   3456  4 000514   000004 630400 5                  EPPR0   4
         4 000515   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000516   000000 701000 xent               TSX1    OCO$IWRITE
         4 000517   000000 011000                    NOP     0

      396     3457    1             0, '        ', 0);
      397     3458    1        CALL M$CLOSE (CLOSE_SAVE) ALTRET (OOPS3);

   3458  4 000520   000326 630400 2                  EPPR0   CLOSE_SAVE
         4 000521   450001 713400                    CLIMB   alt,close
         4 000522   406000 401760                    pmme    nvectors=13
         4 000523   000524 702000 4                  TSX2    OOPS3

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:45   
   3458  4 000524                       OOPS3        null
      398     3459    1   OOPS3: ;
      399     3460    1        RETURN;

   3460  4 000524   000000 702200 xent               TSX2  ! X66_ARET
      400     3461    1   END OCL$INIT;
      401     3462        %EOD;

PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:46   
--  Include file information  --

   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$INIT.
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:47   

 **** Variables and constants ****

  ****  Section 002  Data  OCL$INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   326-0-0/d STRC(1080)  r     1 CLOSE_SAVE               370-0-0/d STRC(144)   r     1 FIND_END
     2-0-0/w UBIN        r     1 FROM_IND_HOLDER            0-0-0/b UBIN(18)    r     1 MSG#
     1-0-0/b UBIN(9)     r     1 NP#                      104-0-0/c STRC(72)    r     1 OCHIST
     3-0-0/c STRC(234)   r     1 OCL_NAME                  12-0-0/d STRC(2088)  r     1 OPEN_HISTORYE
   202-0-0/d STRC(2088)  r     1 OPEN_HISTORYR            110-0-0/d STRC(2088)  r     1 OPEN_HISTORYU
   274-0-0/d STRC(504)   r     1 READ_STATUS              364-0-0/d STRC(144)   r     1 RESET_FMSEC
   106-0-0/c STRC(72)    r     1 SYS                      374-0-0/d STRC(432)   r     1 TURNOVER_TIME
   312-0-0/d STRC(432)   r     1 WRITE_STATUS

  ****  Section 003 RoData OCL$INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(117)   r     1 HIST_ACSVEH

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FROM_IND                 *0-0-0/w UBIN        r     1 FROM_IND

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c BIT         r     1 OCL_BROKEN_FILE            0-0-0/w UBIN        r     1 OCL_CONSOLE_FIELD
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:48   
     0-0-0/b STRC(45)    r     1 OCL_MSGB                   0-0-0/b STRC(18)    r     1 OCL_MSGC
     0-0-0/c STRC(288)   r     1 OCL_PREVIOUS_FILE          0-0-0/b STRC(45)    r     1 OCL_STATUS_KEY
     0-0-0/c STRC(432)   r     1 OCL_STATUS_REC             0-0-0/b STRC        r     1 OC_ACCT_SAVE
     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/b STRC        r     1 OC_HIST_SAVE
     0-0-0/w BIT         r     1 OC_LIST                    0-0-0/w SBIN        r     1 OC_REPLAYS#
     0-0-0/w BIT         r     1 OC_TLIST

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 F$HISTFILE


   Procedure OCL$INIT requires 341 words for executable code.
   Procedure OCL$INIT requires 6 words of local(AUTO) storage.
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:49   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:50   
          MINI XREF LISTING

ALREADY_HERE IN PROCEDURE OCL$OPEN
      3223**LABEL    3227--CALLALT
ALT_RET IN PROCEDURE OCL$OPEN
      3233**LABEL    3229--CALLALT  3235--CALLALT  3238--CALLALT
B$ALT.CODE
      1411**DCL      1411--REDEF    1412--REDEF    1412--REDEF
B$ALT.ERR
      1412**DCL      3453>>ASSIGN
B$ALT.ERR.CODE
      1413**DCL      3376>>IF       3403>>IF
B$ALT.ERR.ERR#
      1413**DCL      1413--REDEF
B$ALT.EVID
      1412**DCL      1412--REDEF    1412--REDEF
B$JIT.CPFLAGS1.SLEAZE
      1220**DCL      1220--REDEF
B$JIT.ERR.MID
      1127**DCL      1127--REDEF
B$JIT.JRESPEAK
      1288**DCL      1289--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1397**DCL      1397--REDEF    1398--REDEF
B$JIT.PNR
      1301**DCL      1301--REDEF
B$JIT.TSLINE
      1395**DCL      1396--REDEF
B$JIT$
      1403**DCL      1121--IMP-PTR
B$TCB.ALT$
      1407**DCL      3376>>IF       3403>>IF       3453>>ASSIGN
B$TCB$
      1405**DCL      3376>>IF       3403>>IF       3453>>ASSIGN
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:51   
CLOSE_SAVE
      3138**DCL      3229<>CALL     3332<>CALL     3437<>CALL     3458<>CALL
CLOSE_SAVE.SN_
      3138**DCL      3138--REDEF
CLOSE_SAVE.UTL_
      3139**DCL      3139--REDEF
CLOSE_SAVE.V
      3143**DCL      3138--DCLINIT
CLOSE_SAVE.V.EXPIRE#
      3153**DCL      3153--REDEF
CLOSE_SAVE.V.TYPE#
      3151**DCL      3151--REDEF
CLOSE_SAVE.V.XTNSIZE#
      3148**DCL      3148--REDEF    3150--REDEF
FILE_TROUBLE
      3292**LABEL    3282--CALLALT
FIND_END
      3188**DCL      3282<>CALL     3287<>CALL
FIND_END.V
      3188**DCL      3188--DCLINIT
FIND_END.V.BOF#
      3189**DCL      3281<<ASSIGN   3286<<ASSIGN
FROM_IND
        38**DCL        36--PROC     3259>>ASSIGN
FROM_IND_HOLDER
      2557**DCL      3259<<ASSIGN   3302<<ASSIGN   3307>>IF       3321<<ASSIGN   3324>>IF       3338>>IF
      3376>>IF       3403>>IF       3403>>IF       3423>>IF
HIST_ACSVEH
      3012**DCL      2673--DCLINIT  2837--DCLINIT  2958--DCLINIT
HIST_ACSVEH.Q
      3013**DCL      3012--DCLINIT
M$CLOSE
       879**DCL-ENT  3229--CALL     3332--CALL     3437--CALL     3458--CALL
M$OPEN
       879**DCL-ENT  3227--CALL     3235--CALL     3238--CALL
M$PFIL
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:52   
       881**DCL-ENT  3282--CALL     3287--CALL
M$READ
       880**DCL-ENT  3261--CALL
M$RPRIV
       938**DCL-ENT  3241--CALL     3454--CALL
M$SPRIV
       938**DCL-ENT  3225--CALL
M$TIME
       946**DCL-ENT  3293--CALL
M$WRITE
       880**DCL-ENT  3364--CALL     3394--CALL     3432--CALL
MSG#
      2555**DCL      3330<>CALL     3346<>CALL     3369<>CALL     3397<>CALL     3444<>CALL     3456<>CALL
NO_CAN_DO
      3437**LABEL    3260--CALLALT  3303--CALLALT  3364--CALLALT  3394--CALLALT  3432--CALLALT
NO_SUCH_KEY
      3368**LABEL    3261--CALLALT
NP#
      2556**DCL      3330<>CALL     3346<>CALL     3369<>CALL     3397<>CALL     3444<>CALL     3456<>CALL
OCHIST
      2741**DCL      2671--DCLINIT  2835--DCLINIT  2956--DCLINIT
OCL$OPEN
      3221**PROC     3260--CALL     3303--CALL
OCL$RLS
      2549**DCL-ENT  3300--CALL
OCL$STATUS
      2553**DCL-ENT  3334--CALL     3348--CALL     3399--CALL
OCL_BROKEN_FILE
      2590**DCL      3292<<ASSIGN   3317>>IF       3320<<ASSIGN
OCL_CONSOLE_FIELD
      2589**DCL      3270<<ASSIGN   3362>>ASSIGN   3392<<ASSIGN   3430>>ASSIGN
OCL_HIST_BUF.STAT
      2584**DCL      2585--REDEF
OCL_MSGB
      2582**DCL      3330<>CALL     3346<>CALL     3369<>CALL     3397<>CALL     3444<>CALL     3456<>CALL
OCL_MSGB.CODE
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:53   
      2583**DCL      3329<<ASSIGN   3345<<ASSIGN   3368<<ASSIGN   3396<<ASSIGN   3439<<ASSIGN   3442<<ASSIGN
      3452<<ASSIGN
OCL_MSGB.ERR
      2582**DCL      2583--REDEF
OCL_MSGB.ERROR
      2583**DCL      3453<<ASSIGN
OCL_MSGC
      2582**DCL      3330<>CALL     3346<>CALL     3369<>CALL     3397<>CALL     3444<>CALL     3456<>CALL
OCL_NAME
      2558**DCL      3300<>CALL
OCL_NAME.CENTURY
      2561**DCL      3296<<ASSIGN   3298<<ASSIGN
OCL_NAME.DATE
      2562**DCL      3208--DCLINIT  3209--DCLINIT  3294>>IF
OCL_NAME.TIME
      2563**DCL      3210--DCLINIT  3211--DCLINIT
OCL_PREVIOUS_FILE
      2576**DCL      3309<<ASSIGN   3361>>ASSIGN   3424>>ASSIGN
OCL_STATUS_KEY
      2577**DCL      3055--DCLINIT  3056--DCLINIT  3099--DCLINIT
OCL_STATUS_REC
      2575**DCL      3057--DCLINIT  3058--DCLINIT  3100--DCLINIT  3101--DCLINIT
OCL_STATUS_REC.AACTIVE
      2575**DCL      3267>>ASSIGN   3358<<ASSIGN   3386<<ASSIGN   3420<<ASSIGN
OCL_STATUS_REC.AHOUR
      2575**DCL      3268>>ASSIGN   3359<<ASSIGN   3387<<ASSIGN   3421<<ASSIGN
OCL_STATUS_REC.AMIN
      2575**DCL      3269>>ASSIGN   3360<<ASSIGN   3388<<ASSIGN   3422<<ASSIGN
OCL_STATUS_REC.CONSOLE_KEY
      2576**DCL      3270>>ASSIGN   3362<<ASSIGN   3391<<ASSIGN   3430<<ASSIGN
OCL_STATUS_REC.LSTATUS
      2575**DCL      3324>>IF       3338>>IF       3354<<ASSIGN   3382<<ASSIGN   3412<<ASSIGN   3414<<ASSIGN
OCL_STATUS_REC.OACTIVE
      2575**DCL      3264>>ASSIGN   3355<<ASSIGN   3383<<ASSIGN   3417<<ASSIGN
OCL_STATUS_REC.OHOUR
      2575**DCL      3265>>ASSIGN   3356<<ASSIGN   3384<<ASSIGN   3418<<ASSIGN
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:54   
OCL_STATUS_REC.OMIN
      2576**DCL      3266>>ASSIGN   3357<<ASSIGN   3385<<ASSIGN   3419<<ASSIGN
OCL_STATUS_REC.PREV_FILE
      2576**DCL      3309>>ASSIGN   3361<<ASSIGN   3424<<ASSIGN
OCL_STATUS_REC.PREV_FILE.COUNT
      2576**DCL      3389<<ASSIGN   3427<<ASSIGN
OCL_STATUS_REC.PREV_FILE.TXT
      2576**DCL      3390<<ASSIGN   3428<<ASSIGN
OCO$IWRITE
      2554**DCL-ENT  3330--CALL     3346--CALL     3369--CALL     3397--CALL     3444--CALL     3456--CALL
OC_ACCT_SAVE.ACTIVE
      1110**DCL      3267<<ASSIGN   3358>>ASSIGN   3386>>ASSIGN   3420>>ASSIGN
OC_ACCT_SAVE.HOUR
      1110**DCL      3268<<ASSIGN   3359>>ASSIGN   3387>>ASSIGN   3421>>ASSIGN
OC_ACCT_SAVE.MIN
      1110**DCL      3269<<ASSIGN   3360>>ASSIGN   3388>>ASSIGN   3422>>ASSIGN
OC_CONSOLE.ATTR
      1065**DCL      1065--REDEF
OC_CONSOLE.ATTRO
      1066**DCL      1066--REDEF
OC_CONSOLE.CID
      1064**DCL      1065--REDEF
OC_CONSOLE.STATION
      1063**DCL      1063--REDEF
OC_CONSOLE$
      1062**DCL      1063--IMP-PTR
OC_DIR
      1105**DCL      1105--REDEF
OC_HIST_SAVE.ACTIVE
      1109**DCL      3264<<ASSIGN   3355>>ASSIGN   3383>>ASSIGN   3417>>ASSIGN
OC_HIST_SAVE.HOUR
      1109**DCL      3265<<ASSIGN   3356>>ASSIGN   3384>>ASSIGN   3418>>ASSIGN
OC_HIST_SAVE.MIN
      1109**DCL      3266<<ASSIGN   3357>>ASSIGN   3385>>ASSIGN   3419>>ASSIGN
OC_INTBIT
      1105**DCL      1106--REDEF
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:55   
OC_INTMSG
       982**DCL       995--REDEF
OC_INTMSG.FLAGS
       989**DCL       990--REDEF
OC_INTMSG.MESS
       995**DCL       995--REDEF
OC_INTMSG.MSGID
       985**DCL       986--REDEF
OC_INTMSG.WSN
       992**DCL       993--REDEF
OC_LIST
      1108**DCL      3223<<ASSIGN   3299<<ASSIGN   3301<<ASSIGN   3344<<ASSIGN   3366<<ASSIGN   3395<<ASSIGN
      3433<<ASSIGN   3434>>IF
OC_MASK
      1106**DCL      1106--REDEF
OC_MESSBUF
       997**DCL      1012--REDEF    1026--REDEF
OC_MESSBUF.FLAGS
      1004**DCL      1005--REDEF
OC_MESSBUF.MESS
      1010**DCL      1010--REDEF
OC_MESSBUF.MSGID
      1000**DCL      1001--REDEF
OC_MESSBUF.WSN
      1007**DCL      1008--REDEF
OC_MESSBUF1.FLAGS
      1019**DCL      1020--REDEF
OC_MESSBUF1.LEN
      1025**DCL      1025--REDEF
OC_MESSBUF1.MSGID
      1015**DCL      1016--REDEF
OC_MESSBUF1.WSN
      1022**DCL      1023--REDEF
OC_MSGBUFFER
      1028**DCL      1043--REDEF
OC_MSGBUFFER.FLAGS
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:56   
      1035**DCL      1036--REDEF
OC_MSGBUFFER.MESS
      1041**DCL      1041--REDEF
OC_MSGBUFFER.MSGID
      1031**DCL      1032--REDEF
OC_MSGBUFFER.WSN
      1038**DCL      1039--REDEF
OC_MSGBUFFER2.FLAGS
      1050**DCL      1051--REDEF
OC_MSGBUFFER2.MSGID
      1046**DCL      1047--REDEF
OC_MSGBUFFER2.WSN
      1053**DCL      1054--REDEF
OC_PARAM
      1061**DCL      1061--REDEF
OC_QUEUE.PARMC
      1060**DCL      1060--REDEF
OC_REPLAYS#
      1110**DCL      3233>>IF
OC_TLIST
      1108**DCL      3410>>IF       3433>>ASSIGN
OOPS0
      3329**LABEL    3332--CALLALT
OOPS2
      3437**LABEL    3437--CALLALT
OOPS3
      3458**LABEL    3458--CALLALT
OPEN_HISTORYE
      2670**DCL      3227<>CALL
OPEN_HISTORYE.ACSVEH_
      2672**DCL      2673--REDEF
OPEN_HISTORYE.ALTKEYS_
      2678**DCL      2679--REDEF    2679--REDEF
OPEN_HISTORYE.HDR_
      2677**DCL      2678--REDEF
OPEN_HISTORYE.TAB_
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:57   
      2676**DCL      2677--REDEF
OPEN_HISTORYE.UHL_
      2670**DCL      2671--REDEF    2671--REDEF
OPEN_HISTORYE.V
      2679**DCL      2670--DCLINIT
OPEN_HISTORYE.V.FSN#
      2710**DCL      2710--REDEF    2710--REDEF
OPEN_HISTORYE.WSN_
      2676**DCL      2676--REDEF
OPEN_HISTORYR
      2955**DCL      3235<>CALL
OPEN_HISTORYR.ACSVEH_
      2957**DCL      2958--REDEF
OPEN_HISTORYR.ALTKEYS_
      2963**DCL      2964--REDEF    2964--REDEF
OPEN_HISTORYR.HDR_
      2962**DCL      2963--REDEF
OPEN_HISTORYR.TAB_
      2961**DCL      2962--REDEF
OPEN_HISTORYR.UHL_
      2955**DCL      2956--REDEF    2956--REDEF
OPEN_HISTORYR.V
      2964**DCL      2955--DCLINIT
OPEN_HISTORYR.V.FSN#
      2995**DCL      2995--REDEF    2995--REDEF
OPEN_HISTORYR.WSN_
      2961**DCL      2961--REDEF
OPEN_HISTORYU
      2834**DCL      3238<>CALL
OPEN_HISTORYU.ACSVEH_
      2836**DCL      2837--REDEF
OPEN_HISTORYU.ALTKEYS_
      2842**DCL      2843--REDEF    2843--REDEF
OPEN_HISTORYU.HDR_
      2841**DCL      2842--REDEF
OPEN_HISTORYU.TAB_
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:58   
      2840**DCL      2841--REDEF
OPEN_HISTORYU.UHL_
      2834**DCL      2835--REDEF    2835--REDEF
OPEN_HISTORYU.V
      2843**DCL      2834--DCLINIT
OPEN_HISTORYU.V.FSN#
      2874**DCL      2874--REDEF    2874--REDEF
OPEN_HISTORYU.WSN_
      2840**DCL      2840--REDEF
PROCEED1 IN PROCEDURE OCL$OPEN
      3223**LABEL    3225--CALLALT
PROCEED2 IN PROCEDURE OCL$OPEN
      3233**LABEL    3241--CALLALT
PROCEED3
      3453**LABEL    3454--CALLALT
READ_STATUS
      3055**DCL      3261<>CALL
READ_STATUS.STATION_
      3058**DCL      3059--REDEF
READ_STATUS.V
      3059**DCL      3055--DCLINIT
READ_STATUS.V.DVBYTE.REREAD#
      3070**DCL      3070--REDEF
READ_STATUS.V.INDX#
      3068**DCL      3068--REDEF
RESET_FMSEC
      3170**DCL      3225<>CALL     3241<>CALL     3454<>CALL
RESET_FMSEC.V
      3170**DCL      3170--DCLINIT
SO_WHAT
      3286**LABEL    3287--CALLALT
SYS
      2756**DCL      2675--DCLINIT  2839--DCLINIT  2960--DCLINIT
TURNOVER_TIME
      3208**DCL      3293<>CALL
TURNOVER_TIME.V
PL6.E3A0      #001=OCL$INIT File=OCL$LISTER.:E05TSI                              WED 07/30/97 03:59 Page:59   
      3212**DCL      3208--DCLINIT
WRITE_STATUS
      3099**DCL      3364<>CALL     3394<>CALL     3432<>CALL
WRITE_STATUS.STATION_
      3101**DCL      3101--REDEF
WRITE_STATUS.V
      3102**DCL      3099--DCLINIT
WRITE_STATUS.V.DVBYTE.VFC#
      3108**DCL      3108--REDEF

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:60   
      402        1        /*M* OCL$KEYIN Handles keyins concerning listing file functions */
      403        2        /*T***********************************************************/
      404        3        /*T*                                                         */
      405        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      406        5        /*T*                                                         */
      407        6        /*T***********************************************************/
      408        7        %SET LISTSUB='1'B;
      409        8                                                /**/
      410        9        /*
      411       10          ###    ###   #        #    #   #  #####  #   #   ###   #   #
      412       11         # # #  #   #  #       ###   #  #   #      #   #    #    #   #
      413       12         # # #  #      #      # #    # #    #       # #     #    ##  #
      414       13         #  ##  #      #       ###   ##     ####     #      #    # # #
      415       14         #   #  #      #        # #  # #    #        #      #    #  ##
      416       15         #   #  #   #  #       ###   #  #   #        #      #    #   #
      417       16          ###    ###   #####    #    #   #  #####    #     ###   #   #
      418       17                                                                          */
      419       18        OCL$KEYIN: PROC (CADDR, TCFID, CONSOLE_FLAG, STATUS, I);
      420       19                                                /**/
      421       20        %INCLUDE OCI_SUBS_C;
      422      118        %INCLUDE OC_SUBS_C;
      423      849        %INCLUDE OCL_DATA_R;
      424      874                                                /**/
      425      875        %INCLUDE CP_6;
      426      956        %INCLUDE OC_DAT_R;
      427     1117        %INCLUDE B$JIT;
      428     1407    1   DCL B$JIT$ PTR SYMREF;
      429     1408                                                /**/
      430     1409    1   DCL B$TCB$ PTR SYMREF;
      431     1410        %B$TCB;
      432     1413        %B$ALT;
      433     1421                                                /**/
      434     1422             %FPT_CLOSE     (FPTN=WITH_RENAME,
      435     1423                                 CHGATT=YES,
      436     1424                                 DCB=F$HISTFILE,
      437     1425                                 DISP=SAVE,
      438     1426                                 RELG=YES);
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:61   
      439     1468                                                /**/
      440     1469             %FPT_WRITE          (FPTN=WRITE_STATUS,
      441     1470                       BUF=OCL_STATUS_REC,
      442     1471                                 DCB=F$HISTFILE,
      443     1472                                 KEY=OCL_STATUS_KEY,
      444     1473                                 WAIT=YES);
      445     1504                                                /**/
      446     1505             %FPT_CLOSE     (FPTN=CLOSE_SAVE,
      447     1506                                 DCB=F$HISTFILE,
      448     1507                                 DISP=SAVE);
      449     1549                                                /**/
      450     1550             %FPT_OPEN      (FPTN=OPEN_HISTORYU,
      451     1551                                 NAME=OCHIST,
      452     1552                                 ACCT=SYS,
      453     1553                                 ASN=FILE,
      454     1554                                 ACS=DIRECT,
      455     1555                                 DCB=F$HISTFILE,
      456     1556                                 DISP=NAMED,
      457     1557                                 CTG=YES,
      458     1558                                 FUN=UPDATE,
      459     1559                                 SHARE=NONE,
      460     1560                                 ORG=KEYED);
      461     1669                                                /**/
      462     1670             %FPT_OPEN      (FPTN=OPEN_HISTORYR,
      463     1671                                 NAME=OCHIST,
      464     1672                                 ACCT=SYS,
      465     1673                                 ASN=FILE,
      466     1674                                 ACS=DIRECT,
      467     1675                                 DCB=F$HISTFILE,
      468     1676                                 DISP=NAMED,
      469     1677                                 CTG=YES,
      470     1678                                 FUN=UPDATE,
      471     1679                                 SHARE=IN,
      472     1680                                 ORG=KEYED);
      473     1789                                                /**/
      474     1790                  %VLP_NAME (FPTN=OCHIST,
      475     1791                                 NAME=':OCHIST');
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:62   
      476     1818                                                /**/
      477     1819                  %VLP_ACCT (FPTN=SYS,
      478     1820                                 ACCT=':SYSTAC');
      479     1833                                                /**/
      480     1834                                                /**/
      481     1835             %FPT_TIME (FPTN=TIME_FOR_CONSOLES,
      482     1836                            SOURCE=CLOCK,
      483     1837                            DEST=UTS,
      484     1838                            TSTAMP=CONS_TIME);
      485     1857                                                /**/
      486     1858             %FPT_WRITE (FPTN=WRITE_CONSOLE_REC,
      487     1859                            BUF=OCL_CONSOLE_REC,
      488     1860                            BP=NO,
      489     1861                            DCB=F$HISTFILE,
      490     1862                            KEY=OCL_CONSOLE_KEY,
      491     1863                            NEWKEY=YES,
      492     1864                            WAIT=YES);
      493     1895                                                /**/
      494     1896             %FPT_PRIV  (FPTN=RESET_FMSEC,
      495     1897                            PRIV=%PR_FMSEC#);
      496     1912                                                /**/
      497     1913                                                /**/
      498     1914    1   DCL OCO$IWRITE ENTRY(8);
      499     1915    1   DCL OCL$INIT ENTRY(1);
      500     1916    1   DCL F$HISTFILE DCB;
      501     1917                                                /**/
      502     1918    1   DCL MSG# UBIN HALF UNAL STATIC INIT(381 /* LISTE_MSG# */);
      503     1919    1   DCL NP# UBIN BYTE UNAL STATIC INIT(2);
      504     1920    1   DCL C_INDEX UBIN WORD UNAL STATIC;
      505     1921    1   DCL KEY_PLACE UBIN WORD UNAL STATIC;
      506     1922    1   DCL CONS_TIME UBIN WORD UNAL STATIC;
      507     1923                                                /**/
      508     1924    1   DCL CADDR BIT(18) CALIGNED;             /* PASSED CADDR */
      509     1925    1   DCL 1 TCFID UNAL,
      510     1926    1            2 COUNT UBIN BYTE UNAL,
      511     1927    1            2 TXT CHAR(TCFID.COUNT) UNAL;
      512     1928    1   DCL CONSOLE_FLAG UBIN WORD;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:63   
      513     1929    1   DCL STATUS UBIN WORD;
      514     1930    1   DCL I UBIN WORD;
      515     1931                                                /**/
      516     1932
      517     1933        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:64   
      518     1934
      519     1935             /****************************************/
      520     1936             /*                                      */
      521     1937             /*        History logging on           */
      522     1938             /*          -Entry Point-               */
      523     1939             /*                                      */
      524     1940             /****************************************/
      525     1941
      526     1942    1   OCL$HON: ENTRY (CADDR);
      527     1943                                                /**/
      528     1944    1        IF OC_LIST
      529     1945    1        THEN
      530     1946    2        DO;
      531     1947    2             OCL_MSGB.CODE = 1;
      532     1948    2             CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      533     1949    2                  0, '        ', 0);
      534     1950    2             RETURN;
      535     1951    2           END;                            /* DO IF ALREADY ON */
      536     1952                                                /**/
      537     1953    1        OC_TLIST = '1'B /*TRUE#*/;
      538     1954    1        OCL_WRITE_CONSOLE_RECS = '1'B;
      539     1955    1        CALL OCL$INIT (3 /* FROM_OCL# */);
      540     1956    1        RETURN;
      541     1957                                                /**/
      542     1958        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:65   
      543     1959
      544     1960             /****************************************/
      545     1961             /*                                      */
      546     1962             /*          History logging off         */
      547     1963             /*            -Entry point-             */
      548     1964             /*                                      */
      549     1965             /****************************************/
      550     1966
      551     1967    1   OCL$HOFF: ENTRY (CADDR);
      552     1968                                                /**/
      553     1969    1        IF ~OC_LIST
      554     1970    1        THEN
      555     1971    2        DO;
      556     1972    2             OCL_MSGB.CODE = 2;
      557     1973    2             CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      558     1974    2                  0, '        ', 0);
      559     1975    2             CALL M$CLOSE (CLOSE_SAVE) ;
      560     1976    2             RETURN;
      561     1977    2           END;                            /* DO IF OFF ALREADY */
      562     1978                                                /**/
      563     1979    1        OC_LIST = '0'B /*FALSE#*/;
      564     1980    1        OCL_STATUS_REC.LSTATUS = 0;
      565     1981    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;
      566     1982    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;
      567     1983    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;
      568     1984    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;
      569     1985    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;
      570     1986    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;
      571     1987    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;
      572     1988    1        OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;
      573     1989    1        CALL M$WRITE (WRITE_STATUS) ALTRET (X);
      574     1990    1   X:   ;
      575     1991    1        CALL M$CLOSE (CLOSE_SAVE) ALTRET (WHO_CARES1);
      576     1992    1   WHO_CARES1: ;
      577     1993    1        OCL_MSGB.CODE = 4;
      578     1994    1        CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      579     1995    1             0, '        ', 0);
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:66   
      580     1996    1        RETURN;
      581     1997                                                /**/
      582     1998                                                /**/
      583     1999             /****************************************/
      584     2000             /*                                      */
      585     2001             /*          Rename history file         */
      586     2002             /*            -Entry Point-             */
      587     2003             /*                                      */
      588     2004             /****************************************/
      589     2005
      590     2006                                                /**/
      591     2007                                                /**/
      592     2008    1   OCL$RLS: ENTRY  (CADDR, TCFID);
      593     2009                                                /**/
      594     2010    1        IF OC_REPLAYS# > 0
      595     2011    1        THEN
      596     2012    1             GOTO TELL_EM;
      597     2013    1        IF OC_LIST
      598     2014    1        THEN
      599     2015    1             CALL M$CLOSE (CLOSE_SAVE) ALTRET(TELL_EM);
      600     2016                                                /**/
      601     2017    1        CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON1);
      602     2018    1   PRESS_ON1:;
      603     2019    1        CALL M$OPEN (OPEN_HISTORYU) ALTRET (TELL_EM);
      604     2020    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON2);
      605     2021    1   PRESS_ON2:;
      606     2022                                                /**/
      607     2023    1        WITH_RENAME.NAME_ = VECTOR(TCFID);
      608     2024    1        CALL M$CLOSE (WITH_RENAME) ALTRET (TELL_EM);
      609     2025    1        OCL_PREVIOUS_FILE = TCFID;
      610     2026    1        OCL_STATUS_REC.CONSOLE_KEY = 0;
      611     2027    1        OCL_CONSOLE_FIELD = 0;
      612     2028    1        OCL_WRITE_CONSOLE_RECS = '1'B;
      613     2029    1        IF OCL_BROKEN_FILE ~= '1'B
      614     2030    1        THEN
      615     2031    2        DO;
      616     2032    2             OC_TLIST = OC_LIST;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:67   
      617     2033    2             CALL OCL$INIT (5 /* FROM_OCL_RLS# */);
      618     2034    2           END;
      619     2035    1        RETURN;
      620     2036    1   TELL_EM: ;
      621     2037                                                /**/
      622     2038    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON3);
      623     2039    1   PRESS_ON3:;
      624     2040    1        IF OC_REPLAYS# > 0
      625     2041    1        THEN
      626     2042    2        DO;
      627     2043    2             OCL_MSGB.CODE = 5;
      628     2044    2           END;
      629     2045    1        ELSE
      630     2046    2        DO;
      631     2047    2             OCL_MSGB.CODE = 3;
      632     2048    2           END;
      633     2049    1        CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      634     2050    1             0, ' ', 0);
      635     2051    1        RETURN;
      636     2052                                                /**/
      637     2053                                                /**/
      638     2054        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:68   
      639     2055
      640     2056             /****************************************/
      641     2057             /*                                      */
      642     2058             /*       Write console records to       */
      643     2059             /*           to history file            */
      644     2060             /*           -Entry point-              */
      645     2061             /*                                      */
      646     2062             /****************************************/
      647     2063                                                /**/
      648     2064                                                /**/
      649     2065    1   OCL$WRITE_CONSOLE_REC: ENTRY (CADDR, TCFID, CONSOLE_FLAG, STATUS, I);
      650     2066    1        CALL M$TIME (TIME_FOR_CONSOLES) ALTRET (KEEP_GOING1);
      651     2067    1   KEEP_GOING1:;
      652     2068    1        KEY_PLACE = OCL_STATUS_REC.CONSOLE_KEY;
      653     2069    1        IF CONSOLE_FLAG = 0 /* ALL_CONSOLES# */
      654     2070    1        THEN
      655     2071    2        DO C_INDEX = 1 TO OC_MAXCONSOLE;
      656     2072    2             KEY_PLACE = KEY_PLACE + 1;
      657     2073    2             OCL_CONSOLE_REC.TERM_NAME = OC_CONSOLE.TERM_NAME (C_INDEX);
      658     2074    2             OCL_CONSOLE_REC.WSN = OC_CONSOLE.WSN (C_INDEX);
      659     2075    2             OCL_CONSOLE_REC.ATTR = OC_CONSOLE.ATTR (C_INDEX);
      660     2076    2             OCL_CONSOLE_REC.ATTRO = OC_CONSOLE.ATTRO (C_INDEX);
      661     2077    2             OCL_CONSOLE_REC.LOGON = OC_CONSOLE.LOGON (C_INDEX);
      662     2078    2             OCL_CONSOLE_REC.STATION = OC_CONSOLE.STATIONR (C_INDEX);
      663     2079    2             OCL_CONSOLE_REC.STATUS = STATUS;
      664     2080    2             OCL_CONSOLE_REC.UTS = CONS_TIME;
      665     2081    2             OCL_CONSOLE_REC.ON_AT_START = '1'B;
      666     2082    2             OCL_CONSOLE_KEY.FIELD = KEY_PLACE;
      667     2083    2             OCL_CONSOLE_FIELD = KEY_PLACE;
      668     2084    2             CALL M$WRITE (WRITE_CONSOLE_REC) ALTRET (WCR_TROUBLE1);
      669     2085    2           END;
      670     2086    1        ELSE
      671     2087    2        DO;
      672     2088    2             KEY_PLACE = OCL_STATUS_REC.CONSOLE_KEY + 1;
      673     2089    2             OCL_CONSOLE_REC.TERM_NAME = OC_CONSOLE.TERM_NAME(I);
      674     2090    2             OCL_CONSOLE_REC.WSN = OC_CONSOLE.WSN(I);
      675     2091    2             OCL_CONSOLE_REC.ATTR = OC_CONSOLE.ATTR(I);
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:69   
      676     2092    2             OCL_CONSOLE_REC.ATTRO = OC_CONSOLE.ATTRO (I);
      677     2093    2             OCL_CONSOLE_REC.LOGON = OC_CONSOLE.LOGON (I);
      678     2094    2             OCL_CONSOLE_REC.STATION = OC_CONSOLE.STATIONR (I);
      679     2095    2             OCL_CONSOLE_REC.STATUS = STATUS;
      680     2096    2             OCL_CONSOLE_REC.UTS = CONS_TIME;
      681     2097    2             OCL_CONSOLE_REC.ON_AT_START = '0'B;
      682     2098    2             OCL_CONSOLE_KEY.FIELD = KEY_PLACE;
      683     2099    2             OCL_CONSOLE_FIELD = KEY_PLACE;
      684     2100    2             CALL M$WRITE (WRITE_CONSOLE_REC) ALTRET (WCR_TROUBLE1);
      685     2101    2           END;
      686     2102    1        OCL_STATUS_REC.LSTATUS = 1;
      687     2103    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE;
      688     2104    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR;
      689     2105    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN;
      690     2106    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE;
      691     2107    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR;
      692     2108    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN;
      693     2109    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;
      694     2110    1        OCL_STATUS_REC.CONSOLE_KEY = KEY_PLACE;
      695     2111    1        CALL M$WRITE (WRITE_STATUS) ALTRET (KEEP_GOING5);
      696     2112    1   KEEP_GOING5:;
      697     2113    2        DO WHILE ('0'B);
      698     2114    2   WCR_TROUBLE1:;
      699     2115    2             OCL_MSGB.CODE = 7;
      700     2116    2             OCL_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      701     2117    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      702     2118    2                  0, '        ', 0);
      703     2119    2           END;
      704     2120    1        RETURN;
      705     2121                                                /**/
      706     2122                                                /**/
      707     2123        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:70   
      708     2124             /****************************************/
      709     2125             /*                                      */
      710     2126             /*     Open the history file shared     */
      711     2127             /*          -Entry point-               */
      712     2128             /*                                      */
      713     2129             /****************************************/
      714     2130                                                /**/
      715     2131    1   OCL$START_SHARED: ENTRY;
      716     2132    1        OC_REPLAYS# = OC_REPLAYS# + 1;
      717     2133    1        IF OC_REPLAYS# = 1 AND OC_LIST
      718     2134    1        THEN
      719     2135    2        DO;
      720     2136    2             CALL M$CLOSE (CLOSE_SAVE)
      721     2137    2                  ALTRET (SO_WHAT);
      722     2138    2   SO_WHAT:  ;
      723     2139                                                /**/
      724     2140    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON4);
      725     2141    2   PRESS_ON4:;
      726     2142    2             CALL M$OPEN (OPEN_HISTORYR)
      727     2143    2                  ALTRET (NO_CAN_DO);
      728     2144    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON5);
      729     2145    2   PRESS_ON5:;
      730     2146                                                /**/
      731     2147    2           END;
      732     2148                                                /**/
      733     2149    2        DO WHILE ('0'B);
      734     2150    2   NO_CAN_DO:;
      735     2151                                                /**/
      736     2152    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON6);
      737     2153    2   PRESS_ON6:;
      738     2154    2             OCL_MSGB.CODE = 6;
      739     2155    2             OCL_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      740     2156    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      741     2157    2                  0, '        ', 0);
      742     2158    2             CALL M$CLOSE (CLOSE_SAVE) ALTRET (TOO_BAD);
      743     2159    2           END;
      744     2160    1   TOO_BAD:;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:71   
      745     2161    1        RETURN;
      746     2162                                                /**/
      747     2163                                                /**/
      748     2164                                                /**/
      749     2165        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:72   
      750     2166             /****************************************/
      751     2167             /*                                      */
      752     2168             /*  Open the history file exclusively   */
      753     2169             /*          -Entry point-               */
      754     2170             /*                                      */
      755     2171             /****************************************/
      756     2172                                                /**/
      757     2173                                                /**/
      758     2174    1   OCL$START_EXCLU: ENTRY;
      759     2175    1        OC_REPLAYS# = OC_REPLAYS# - 1;
      760     2176    1        IF OC_REPLAYS# = 0 AND OC_LIST
      761     2177    1        THEN
      762     2178    2        DO;
      763     2179    2             CALL M$CLOSE (CLOSE_SAVE)
      764     2180    2                  ALTRET (EX_OPEN);
      765     2181    2   EX_OPEN:  ;
      766     2182                                                /**/
      767     2183    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON7);
      768     2184    2   PRESS_ON7:;
      769     2185    2             CALL M$OPEN (OPEN_HISTORYU)
      770     2186    2                  ALTRET (NO_CAN_DO2);
      771     2187    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON8);
      772     2188    2   PRESS_ON8:;
      773     2189                                                /**/
      774     2190    2           END;
      775     2191                                                /**/
      776     2192    2        DO WHILE ('0'B);
      777     2193    2   NO_CAN_DO2:;
      778     2194                                                /**/
      779     2195    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON9);
      780     2196    2   PRESS_ON9:;
      781     2197    2             CALL M$OPEN (OPEN_HISTORYR)
      782     2198    2                  ALTRET (TROUBLE);
      783     2199    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON10);
      784     2200    2   PRESS_ON10:;
      785     2201                                                /**/
      786     2202    2             GOTO TOO_BAD2;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:73   
      787     2203    2   TROUBLE:  ;
      788     2204    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON11);
      789     2205    2   PRESS_ON11:;
      790     2206    2             OCL_MSGB.CODE = 6;
      791     2207    2             OCL_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      792     2208    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,
      793     2209    2                  0, '        ', 0);
      794     2210    2             CALL OCL$HOFF ('200000'O /* M_SYS  */);
      795     2211                                                /**/
      796     2212                                           /* If :OCHIST can't be opened
      797     2213                                                exclusive, that means a
      798     2214                                                REPLAY has already re-opened
      799     2215                                                :OCHIST shared to begin
      800     2216                                                listing. This phenomenon
      801     2217                                                is caused by REPLAYs
      802     2218                                                re_opening of the file for listing
      803     2219                                                before KEYIN can process CSCG events
      804     2220                                                which close and re_open :OCHIST
      805     2221                                                exclusively. */
      806     2222                                                /**/
      807     2223    2           END;
      808     2224    1   TOO_BAD2:;
      809     2225    1        RETURN;
      810     2226                                                /**/
      811     2227    1   END OCL$KEYIN;
      812     2228        %EOD;

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:74   
--  Include file information  --

   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$KEYIN.

   Procedure OCL$KEYIN requires 454 words for executable code.
   Procedure OCL$KEYIN requires 16 words of local(AUTO) storage.

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:75   

 Object Unit name= OCL$KEYIN                                  File name= OCL$LISTER.:E05TOU
 UTS= JUL 30 '97 04:00:03.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   225    341  OCL$KEYIN
    2   DCB   even  none     0      0  F$HISTFILE
    3  RoData even  UTS      2      2  OCL$KEYIN
    4   Proc  even  none   454    706  OCL$KEYIN
    5  RoData even  none    21     25  OCL$KEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        5  OCL$KEYIN
     4      3                  yes      Std        1  OCL$HON
     4     37                  yes      Std        1  OCL$HOFF
     4    153                  yes      Std        2  OCL$RLS
     4    300                  yes      Std        5  OCL$WRITE_CONSOLE_REC
     4    542                  yes      Std        0  OCL$START_SHARED
     4    616                  yes      Std        0  OCL$START_EXCLU
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:76   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       8 OCO$IWRITE
         yes           Std       1 OCL$INIT
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     OCL_STATUS_REC                        OCL_PREVIOUS_FILE                     OCL_STATUS_KEY
     OCL_MSGC                              OCL_MSGB                              OCL_CONSOLE_KEY
     OCL_CONSOLE_REC                       OCL_CONSOLE_FIELD                     OCL_WRITE_CONSOLE_RECS
     OCL_BROKEN_FILE                       M$UC                                  OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_PARAM
     OC_CONSOLE$                           OC_MAXCONSOLE                         OC_DIR
     OC_INTBIT                             OC_MASK                               OC_LIST
     OC_TLIST                              OC_HIST_SAVE                          OC_ACCT_SAVE
     OC_REPLAYS#                           B$JIT$                                B$TCB$
     F$HISTFILE                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:77   


      402        1        /*M* OCL$KEYIN Handles keyins concerning listing file functions */
      403        2        /*T***********************************************************/
      404        3        /*T*                                                         */
      405        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      406        5        /*T*                                                         */
      407        6        /*T***********************************************************/
      408        7        %SET LISTSUB='1'B;
      409        8                                                /**/
      410        9        /*
      411       10          ###    ###   #        #    #   #  #####  #   #   ###   #   #
      412       11         # # #  #   #  #       ###   #  #   #      #   #    #    #   #
      413       12         # # #  #      #      # #    # #    #       # #     #    ##  #
      414       13         #  ##  #      #       ###   ##     ####     #      #    # # #
      415       14         #   #  #      #        # #  # #    #        #      #    #  ##
      416       15         #   #  #   #  #       ###   #  #   #        #      #    #   #
      417       16          ###    ###   #####    #    #   #  #####    #     ###   #   #
      418       17                                                                          */
      419       18        OCL$KEYIN: PROC (CADDR, TCFID, CONSOLE_FLAG, STATUS, I);

     18  4 000000   000000 700200 xent  OCL$KEYIN    TSX0  ! X66_AUTO_5
         4 000001   000020 000005                    ZERO    16,5
         4 000002   000005 710000 4                  TRA     s:1944

      420       19                                                /**/
      421       20        %INCLUDE OCI_SUBS_C;
      422      118        %INCLUDE OC_SUBS_C;
      423      849        %INCLUDE OCL_DATA_R;
      424      874                                                /**/
      425      875        %INCLUDE CP_6;
      426      956        %INCLUDE OC_DAT_R;
      427     1117        %INCLUDE B$JIT;
      428     1407    1   DCL B$JIT$ PTR SYMREF;
      429     1408                                                /**/
      430     1409    1   DCL B$TCB$ PTR SYMREF;
      431     1410        %B$TCB;
      432     1413        %B$ALT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:78   
      433     1421                                                /**/
      434     1422             %FPT_CLOSE     (FPTN=WITH_RENAME,
      435     1423                                 CHGATT=YES,
      436     1424                                 DCB=F$HISTFILE,
      437     1425                                 DISP=SAVE,
      438     1426                                 RELG=YES);
      439     1468                                                /**/
      440     1469             %FPT_WRITE          (FPTN=WRITE_STATUS,
      441     1470                       BUF=OCL_STATUS_REC,
      442     1471                                 DCB=F$HISTFILE,
      443     1472                                 KEY=OCL_STATUS_KEY,
      444     1473                                 WAIT=YES);
      445     1504                                                /**/
      446     1505             %FPT_CLOSE     (FPTN=CLOSE_SAVE,
      447     1506                                 DCB=F$HISTFILE,
      448     1507                                 DISP=SAVE);
      449     1549                                                /**/
      450     1550             %FPT_OPEN      (FPTN=OPEN_HISTORYU,
      451     1551                                 NAME=OCHIST,
      452     1552                                 ACCT=SYS,
      453     1553                                 ASN=FILE,
      454     1554                                 ACS=DIRECT,
      455     1555                                 DCB=F$HISTFILE,
      456     1556                                 DISP=NAMED,
      457     1557                                 CTG=YES,
      458     1558                                 FUN=UPDATE,
      459     1559                                 SHARE=NONE,
      460     1560                                 ORG=KEYED);
      461     1669                                                /**/
      462     1670             %FPT_OPEN      (FPTN=OPEN_HISTORYR,
      463     1671                                 NAME=OCHIST,
      464     1672                                 ACCT=SYS,
      465     1673                                 ASN=FILE,
      466     1674                                 ACS=DIRECT,
      467     1675                                 DCB=F$HISTFILE,
      468     1676                                 DISP=NAMED,
      469     1677                                 CTG=YES,
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:79   
      470     1678                                 FUN=UPDATE,
      471     1679                                 SHARE=IN,
      472     1680                                 ORG=KEYED);
      473     1789                                                /**/
      474     1790                  %VLP_NAME (FPTN=OCHIST,
      475     1791                                 NAME=':OCHIST');
      476     1818                                                /**/
      477     1819                  %VLP_ACCT (FPTN=SYS,
      478     1820                                 ACCT=':SYSTAC');
      479     1833                                                /**/
      480     1834                                                /**/
      481     1835             %FPT_TIME (FPTN=TIME_FOR_CONSOLES,
      482     1836                            SOURCE=CLOCK,
      483     1837                            DEST=UTS,
      484     1838                            TSTAMP=CONS_TIME);
      485     1857                                                /**/
      486     1858             %FPT_WRITE (FPTN=WRITE_CONSOLE_REC,
      487     1859                            BUF=OCL_CONSOLE_REC,
      488     1860                            BP=NO,
      489     1861                            DCB=F$HISTFILE,
      490     1862                            KEY=OCL_CONSOLE_KEY,
      491     1863                            NEWKEY=YES,
      492     1864                            WAIT=YES);
      493     1895                                                /**/
      494     1896             %FPT_PRIV  (FPTN=RESET_FMSEC,
      495     1897                            PRIV=%PR_FMSEC#);
      496     1912                                                /**/
      497     1913                                                /**/
      498     1914    1   DCL OCO$IWRITE ENTRY(8);
      499     1915    1   DCL OCL$INIT ENTRY(1);
      500     1916    1   DCL F$HISTFILE DCB;
      501     1917                                                /**/
      502     1918    1   DCL MSG# UBIN HALF UNAL STATIC INIT(381 /* LISTE_MSG# */);
      503     1919    1   DCL NP# UBIN BYTE UNAL STATIC INIT(2);
      504     1920    1   DCL C_INDEX UBIN WORD UNAL STATIC;
      505     1921    1   DCL KEY_PLACE UBIN WORD UNAL STATIC;
      506     1922    1   DCL CONS_TIME UBIN WORD UNAL STATIC;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:80   
      507     1923                                                /**/
      508     1924    1   DCL CADDR BIT(18) CALIGNED;             /* PASSED CADDR */
      509     1925    1   DCL 1 TCFID UNAL,
      510     1926    1            2 COUNT UBIN BYTE UNAL,
      511     1927    1            2 TXT CHAR(TCFID.COUNT) UNAL;
      512     1928    1   DCL CONSOLE_FLAG UBIN WORD;
      513     1929    1   DCL STATUS UBIN WORD;
      514     1930    1   DCL I UBIN WORD;
      515     1931                                                /**/
      516     1932
      517     1933        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:81   
      518     1934
      519     1935             /****************************************/
      520     1936             /*                                      */
      521     1937             /*        History logging on           */
      522     1938             /*          -Entry Point-               */
      523     1939             /*                                      */
      524     1940             /****************************************/
      525     1941
      526     1942    1   OCL$HON: ENTRY (CADDR);

   1942  4 000003   000000 700200 xent  OCL$HON      TSX0  ! X66_AUTO_5
         4 000004   000020 000005                    ZERO    16,5

      527     1943                                                /**/
      528     1944    1        IF OC_LIST

   1944  4 000005   000000 234000 xsym               SZN     OC_LIST
         4 000006   000027 605000 4                  TPL     s:1953

      529     1945    1        THEN
      530     1946    2        DO;

      531     1947    2             OCL_MSGB.CODE = 1;

   1947  4 000007   001000 236003                    LDQ     512,DU
         4 000010   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      532     1948    2             CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   1948  4 000011   000000 237000 5                  LDAQ    0
         4 000012   200016 757100                    STAQ    @I+7,,AUTO
         4 000013   000002 237000 5                  LDAQ    2
         4 000014   200014 757100                    STAQ    @I+5,,AUTO
         4 000015   000004 237000 5                  LDAQ    4
         4 000016   200012 757100                    STAQ    @I+3,,AUTO
         4 000017   000006 236000 5                  LDQ     6
         4 000020   200003 235100                    LDA     @CADDR,,AUTO
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:82   
         4 000021   200010 757100                    STAQ    @I+1,,AUTO
         4 000022   200010 630500                    EPPR0   @I+1,,AUTO
         4 000023   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000024   000000 701000 xent               TSX1    OCO$IWRITE
         4 000025   000000 011000                    NOP     0

      533     1949    2                  0, '        ', 0);
      534     1950    2             RETURN;

   1950  4 000026   000000 702200 xent               TSX2  ! X66_ARET

      535     1951    2           END;                            /* DO IF ALREADY ON */
      536     1952                                                /**/
      537     1953    1        OC_TLIST = '1'B /*TRUE#*/;

   1953  4 000027   400000 236003                    LDQ     -131072,DU
         4 000030   000000 756000 xsym               STQ     OC_TLIST

      538     1954    1        OCL_WRITE_CONSOLE_RECS = '1'B;

   1954  4 000031   000000 756000 xsym               STQ     OCL_WRITE_CONSOLE_RECS

      539     1955    1        CALL OCL$INIT (3 /* FROM_OCL# */);

   1955  4 000032   000007 630400 5                  EPPR0   7
         4 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000034   000000 701000 xent               TSX1    OCL$INIT
         4 000035   000000 011000                    NOP     0

      540     1956    1        RETURN;

   1956  4 000036   000000 702200 xent               TSX2  ! X66_ARET

      541     1957                                                /**/
      542     1958        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:83   
      543     1959
      544     1960             /****************************************/
      545     1961             /*                                      */
      546     1962             /*          History logging off         */
      547     1963             /*            -Entry point-             */
      548     1964             /*                                      */
      549     1965             /****************************************/
      550     1966
      551     1967    1   OCL$HOFF: ENTRY (CADDR);

   1967  4 000037   000000 700200 xent  OCL$HOFF     TSX0  ! X66_AUTO_5
         4 000040   000020 000005                    ZERO    16,5

      552     1968                                                /**/
      553     1969    1        IF ~OC_LIST

   1969  4 000041   000000 236000 xsym               LDQ     OC_LIST
         4 000042   400000 376003                    ANQ     -131072,DU
         4 000043   400000 676003                    ERQ     -131072,DU
         4 000044   000070 600000 4                  TZE     s:1979

      554     1970    1        THEN
      555     1971    2        DO;

      556     1972    2             OCL_MSGB.CODE = 2;

   1972  4 000045   002000 236003                    LDQ     1024,DU
         4 000046   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      557     1973    2             CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   1973  4 000047   000000 237000 5                  LDAQ    0
         4 000050   200016 757100                    STAQ    @I+7,,AUTO
         4 000051   000002 237000 5                  LDAQ    2
         4 000052   200014 757100                    STAQ    @I+5,,AUTO
         4 000053   000004 237000 5                  LDAQ    4
         4 000054   200012 757100                    STAQ    @I+3,,AUTO
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:84   
         4 000055   000006 236000 5                  LDQ     6
         4 000056   200003 235100                    LDA     @CADDR,,AUTO
         4 000057   200010 757100                    STAQ    @I+1,,AUTO
         4 000060   200010 630500                    EPPR0   @I+1,,AUTO
         4 000061   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000062   000000 701000 xent               TSX1    OCO$IWRITE
         4 000063   000000 011000                    NOP     0

      558     1974    2                  0, '        ', 0);
      559     1975    2             CALL M$CLOSE (CLOSE_SAVE) ;

   1975  4 000064   000052 630400 1                  EPPR0   CLOSE_SAVE
         4 000065   050001 713400                    CLIMB   close
         4 000066   406000 401760                    pmme    nvectors=13

      560     1976    2             RETURN;

   1976  4 000067   000000 702200 xent               TSX2  ! X66_ARET

      561     1977    2           END;                            /* DO IF OFF ALREADY */
      562     1978                                                /**/
      563     1979    1        OC_LIST = '0'B /*FALSE#*/;

   1979  4 000070   000000 450000 xsym               STZ     OC_LIST

      564     1980    1        OCL_STATUS_REC.LSTATUS = 0;

   1980  4 000071   000000 450000 xsym               STZ     OCL_STATUS_REC

      565     1981    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;

   1981  4 000072   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000073   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000074   400000 376003                    ANQ     -131072,DU
         4 000075   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      566     1982    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:85   

   1982  4 000076   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000077   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000100   377777 376003                    ANQ     131071,DU
         4 000101   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      567     1983    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;

   1983  4 000102   000000 720000 xsym               LXL0    OC_HIST_SAVE
         4 000103   000002 440000 xsym               SXL0    OCL_STATUS_REC+2

      568     1984    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;

   1984  4 000104   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000105   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000106   400000 376003                    ANQ     -131072,DU
         4 000107   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      569     1985    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;

   1985  4 000110   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000111   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000112   377777 376003                    ANQ     131071,DU
         4 000113   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      570     1986    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;

   1986  4 000114   000000 721000 xsym               LXL1    OC_ACCT_SAVE
         4 000115   000001 441000 xsym               SXL1    OCL_STATUS_REC+1

      571     1987    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;

   1987  4 000116   000000 100400                    MLR     fill='000'O
         4 000117   000000 000040 xsym               ADSC9   OCL_PREVIOUS_FILE        cn=0,n=32
         4 000120   000003 000040 xsym               ADSC9   OCL_STATUS_REC+3         cn=0,n=32

      572     1988    1        OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:86   

   1988  4 000121   000000 235000 xsym               LDA     OCL_CONSOLE_FIELD
         4 000122   000013 755000 xsym               STA     OCL_STATUS_REC+11

      573     1989    1        CALL M$WRITE (WRITE_STATUS) ALTRET (X);

   1989  4 000123   000036 630400 1                  EPPR0   WRITE_STATUS
         4 000124   440001 713400                    CLIMB   alt,write
         4 000125   401400 401760                    pmme    nvectors=4
         4 000126   000127 702000 4                  TSX2    X

   1988  4 000127                       X            null
      574     1990    1   X:   ;
      575     1991    1        CALL M$CLOSE (CLOSE_SAVE) ALTRET (WHO_CARES1);

   1991  4 000127   000052 630400 1                  EPPR0   CLOSE_SAVE
         4 000130   450001 713400                    CLIMB   alt,close
         4 000131   406000 401760                    pmme    nvectors=13
         4 000132   000133 702000 4                  TSX2    WHO_CARES1

   1988  4 000133                       WHO_CARES1   null
      576     1992    1   WHO_CARES1: ;
      577     1993    1        OCL_MSGB.CODE = 4;

   1993  4 000133   004000 236003                    LDQ     2048,DU
         4 000134   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      578     1994    1        CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   1994  4 000135   000000 237000 5                  LDAQ    0
         4 000136   200016 757100                    STAQ    @I+7,,AUTO
         4 000137   000002 237000 5                  LDAQ    2
         4 000140   200014 757100                    STAQ    @I+5,,AUTO
         4 000141   000004 237000 5                  LDAQ    4
         4 000142   200012 757100                    STAQ    @I+3,,AUTO
         4 000143   000006 236000 5                  LDQ     6
         4 000144   200003 235100                    LDA     @CADDR,,AUTO
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:87   
         4 000145   200010 757100                    STAQ    @I+1,,AUTO
         4 000146   200010 630500                    EPPR0   @I+1,,AUTO
         4 000147   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000150   000000 701000 xent               TSX1    OCO$IWRITE
         4 000151   000000 011000                    NOP     0

      579     1995    1             0, '        ', 0);
      580     1996    1        RETURN;

   1996  4 000152   000000 702200 xent               TSX2  ! X66_ARET

      581     1997                                                /**/
      582     1998                                                /**/
      583     1999             /****************************************/
      584     2000             /*                                      */
      585     2001             /*          Rename history file         */
      586     2002             /*            -Entry Point-             */
      587     2003             /*                                      */
      588     2004             /****************************************/
      589     2005
      590     2006                                                /**/
      591     2007                                                /**/
      592     2008    1   OCL$RLS: ENTRY  (CADDR, TCFID);

   2008  4 000153   000000 700200 xent  OCL$RLS      TSX0  ! X66_AUTO_5
         4 000154   000020 000005                    ZERO    16,5

      593     2009                                                /**/
      594     2010    1        IF OC_REPLAYS# > 0

   2010  4 000155   000000 235000 xsym               LDA     OC_REPLAYS#
         4 000156   000247 605400 4                  TPNZ    TELL_EM

      595     2011    1        THEN
      596     2012    1             GOTO TELL_EM;
      597     2013    1        IF OC_LIST

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:88   
   2013  4 000157   000000 234000 xsym               SZN     OC_LIST
         4 000160   000165 605000 4                  TPL     s:2017

      598     2014    1        THEN
      599     2015    1             CALL M$CLOSE (CLOSE_SAVE) ALTRET(TELL_EM);

   2015  4 000161   000052 630400 1                  EPPR0   CLOSE_SAVE
         4 000162   450001 713400                    CLIMB   alt,close
         4 000163   406000 401760                    pmme    nvectors=13
         4 000164   000247 702000 4                  TSX2    TELL_EM

      600     2016                                                /**/
      601     2017    1        CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON1);

   2017  4 000165   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000166   420012 713400                    CLIMB   alt,+8202
         4 000167   400000 401760                    pmme    nvectors=1
         4 000170   000171 702000 4                  TSX2    PRESS_ON1

   2013  4 000171                       PRESS_ON1    null
      602     2018    1   PRESS_ON1:;
      603     2019    1        CALL M$OPEN (OPEN_HISTORYU) ALTRET (TELL_EM);

   2019  4 000171   000110 630400 1                  EPPR0   OPEN_HISTORYU
         4 000172   450000 713400                    CLIMB   alt,open
         4 000173   410400 401760                    pmme    nvectors=18
         4 000174   000247 702000 4                  TSX2    TELL_EM

      604     2020    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON2);

   2020  4 000175   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000176   420013 713400                    CLIMB   alt,+8203
         4 000177   400000 401760                    pmme    nvectors=1
         4 000200   000201 702000 4                  TSX2    PRESS_ON2

   2013  4 000201                       PRESS_ON2    null
      605     2021    1   PRESS_ON2:;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:89   
      606     2022                                                /**/
      607     2023    1        WITH_RENAME.NAME_ = VECTOR(TCFID);

   2023  4 000201   200004 470500                    LDP0    @TCFID,,AUTO
         4 000202   000100 101500                    MRL     fill='000'O
         4 000203   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000204   200010 000002                    ADSC9   @I+1,,AUTO               cn=0,n=2
         4 000205   200010 220100                    LDX0    @I+1,,AUTO
         4 000206   000001 621010                    EAX1    1,X0
         4 000207   000000 635011                    EAA     0,X1
         4 000210   000002 771000                    ARL     2
         4 000211   000140 135007                    SBLA    96,DL
         4 000212   200004 236100                    LDQ     @TCFID,,AUTO
         4 000213   000006 757000 1                  STAQ    WITH_RENAME+6

      608     2024    1        CALL M$CLOSE (WITH_RENAME) ALTRET (TELL_EM);

   2024  4 000214   000000 630400 1                  EPPR0   WITH_RENAME
         4 000215   450001 713400                    CLIMB   alt,close
         4 000216   406000 401760                    pmme    nvectors=13
         4 000217   000247 702000 4                  TSX2    TELL_EM

      609     2025    1        OCL_PREVIOUS_FILE = TCFID;

   2025  4 000220   200004 470500                    LDP0    @TCFID,,AUTO
         4 000221   000100 101500                    MRL     fill='000'O
         4 000222   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000223   200010 000002                    ADSC9   @I+1,,AUTO               cn=0,n=2
         4 000224   200010 220100                    LDX0    @I+1,,AUTO
         4 000225   000001 621010                    EAX1    1,X0
         4 000226   000000 100540                    MLR     fill='000'O
         4 000227   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         4 000230   000000 000040 xsym               ADSC9   OCL_PREVIOUS_FILE        cn=0,n=32

      610     2026    1        OCL_STATUS_REC.CONSOLE_KEY = 0;

   2026  4 000231   000013 450000 xsym               STZ     OCL_STATUS_REC+11
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:90   

      611     2027    1        OCL_CONSOLE_FIELD = 0;

   2027  4 000232   000000 450000 xsym               STZ     OCL_CONSOLE_FIELD

      612     2028    1        OCL_WRITE_CONSOLE_RECS = '1'B;

   2028  4 000233   400000 236003                    LDQ     -131072,DU
         4 000234   000000 756000 xsym               STQ     OCL_WRITE_CONSOLE_RECS

      613     2029    1        IF OCL_BROKEN_FILE ~= '1'B

   2029  4 000235   000000 234000 xsym               SZN     OCL_BROKEN_FILE
         4 000236   000246 604000 4                  TMI     s:2035

      614     2030    1        THEN
      615     2031    2        DO;

      616     2032    2             OC_TLIST = OC_LIST;

   2032  4 000237   000000 236000 xsym               LDQ     OC_LIST
         4 000240   400000 376003                    ANQ     -131072,DU
         4 000241   000000 756000 xsym               STQ     OC_TLIST

      617     2033    2             CALL OCL$INIT (5 /* FROM_OCL_RLS# */);

   2033  4 000242   000010 630400 5                  EPPR0   8
         4 000243   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000244   000000 701000 xent               TSX1    OCL$INIT
         4 000245   000000 011000                    NOP     0

      618     2034    2           END;

      619     2035    1        RETURN;

   2035  4 000246   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:91   
   2029  4 000247                       TELL_EM      null
      620     2036    1   TELL_EM: ;
      621     2037                                                /**/
      622     2038    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON3);

   2038  4 000247   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000250   420013 713400                    CLIMB   alt,+8203
         4 000251   400000 401760                    pmme    nvectors=1
         4 000252   000253 702000 4                  TSX2    PRESS_ON3

   2029  4 000253                       PRESS_ON3    null
      623     2039    1   PRESS_ON3:;
      624     2040    1        IF OC_REPLAYS# > 0

   2040  4 000253   000000 235000 xsym               LDA     OC_REPLAYS#
         4 000254   000260 604400 4                  TMOZ    s:2047

      625     2041    1        THEN
      626     2042    2        DO;

      627     2043    2             OCL_MSGB.CODE = 5;

   2043  4 000255   005000 236003                    LDQ     2560,DU
         4 000256   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      628     2044    2           END;

   2044  4 000257   000262 710000 4                  TRA     s:2049

      629     2045    1        ELSE
      630     2046    2        DO;

      631     2047    2             OCL_MSGB.CODE = 3;

   2047  4 000260   003000 236003                    LDQ     1536,DU
         4 000261   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:92   
      632     2048    2           END;

      633     2049    1        CALL OCO$IWRITE (CADDR, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   2049  4 000262   000012 237000 5                  LDAQ    10
         4 000263   200016 757100                    STAQ    @I+7,,AUTO
         4 000264   000002 237000 5                  LDAQ    2
         4 000265   200014 757100                    STAQ    @I+5,,AUTO
         4 000266   000004 237000 5                  LDAQ    4
         4 000267   200012 757100                    STAQ    @I+3,,AUTO
         4 000270   000006 236000 5                  LDQ     6
         4 000271   200003 235100                    LDA     @CADDR,,AUTO
         4 000272   200010 757100                    STAQ    @I+1,,AUTO
         4 000273   200010 630500                    EPPR0   @I+1,,AUTO
         4 000274   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000275   000000 701000 xent               TSX1    OCO$IWRITE
         4 000276   000000 011000                    NOP     0

      634     2050    1             0, ' ', 0);
      635     2051    1        RETURN;

   2051  4 000277   000000 702200 xent               TSX2  ! X66_ARET

      636     2052                                                /**/
      637     2053                                                /**/
      638     2054        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:93   
      639     2055
      640     2056             /****************************************/
      641     2057             /*                                      */
      642     2058             /*       Write console records to       */
      643     2059             /*           to history file            */
      644     2060             /*           -Entry point-              */
      645     2061             /*                                      */
      646     2062             /****************************************/
      647     2063                                                /**/
      648     2064                                                /**/
      649     2065    1   OCL$WRITE_CONSOLE_REC: ENTRY (CADDR, TCFID, CONSOLE_FLAG, STATUS, I);

   2065  4 000300   000000 700200 xent  OCL$WRITE_C* TSX0  ! X66_AUTO_5
         4 000301   000020 000005                    ZERO    16,5

      650     2066    1        CALL M$TIME (TIME_FOR_CONSOLES) ALTRET (KEEP_GOING1);

   2066  4 000302   000300 630400 1                  EPPR0   TIME_FOR_CONSOLES
         4 000303   420004 713400                    CLIMB   alt,+8196
         4 000304   402000 401760                    pmme    nvectors=5
         4 000305   000306 702000 4                  TSX2    KEEP_GOING1

   2065  4 000306                       KEEP_GOING1  null
      651     2067    1   KEEP_GOING1:;
      652     2068    1        KEY_PLACE = OCL_STATUS_REC.CONSOLE_KEY;

   2068  4 000306   000013 235000 xsym               LDA     OCL_STATUS_REC+11
         4 000307   000337 755000 1                  STA     KEY_PLACE

      653     2069    1        IF CONSOLE_FLAG = 0 /* ALL_CONSOLES# */

   2069  4 000310   200005 470500                    LDP0    @CONSOLE_FLAG,,AUTO
         4 000311   000000 235100                    LDA     0,,PR0
         4 000312   000401 601000 4                  TNZ     s:2088

      654     2070    1        THEN
      655     2071    2        DO C_INDEX = 1 TO OC_MAXCONSOLE;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:94   

   2071  4 000313   000001 236007                    LDQ     1,DL
         4 000314   000336 756000 1                  STQ     C_INDEX
         4 000315   000374 710000 4                  TRA     s:2085+3

      656     2072    2             KEY_PLACE = KEY_PLACE + 1;

   2072  4 000316   000337 235000 1                  LDA     KEY_PLACE
         4 000317   000001 035007                    ADLA    1,DL
         4 000320   000337 755000 1                  STA     KEY_PLACE

      657     2073    2             OCL_CONSOLE_REC.TERM_NAME = OC_CONSOLE.TERM_NAME (C_INDEX);

   2073  4 000321   000336 236000 1                  LDQ     C_INDEX
         4 000322   000370 402007                    MPY     248,DL
         4 000323   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000324   040000 100506                    MLR     fill='040'O
         4 000325   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         4 000326   000000 000010 xsym               ADSC9   OCL_CONSOLE_REC          cn=0,n=8

      658     2074    2             OCL_CONSOLE_REC.WSN = OC_CONSOLE.WSN (C_INDEX);

   2074  4 000327   040000 100506                    MLR     fill='040'O
         4 000330   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         4 000331   000002 000010 xsym               ADSC9   OCL_CONSOLE_REC+2        cn=0,n=8

      659     2075    2             OCL_CONSOLE_REC.ATTR = OC_CONSOLE.ATTR (C_INDEX);

   2075  4 000332   000336 236000 1                  LDQ     C_INDEX
         4 000333   000076 402007                    MPY     62,DL
         4 000334   000013 220106                    LDX0    11,QL,PR0
         4 000335   000004 740000 xsym               STX0    OCL_CONSOLE_REC+4

      660     2076    2             OCL_CONSOLE_REC.ATTRO = OC_CONSOLE.ATTRO (C_INDEX);

   2076  4 000336   000014 221106                    LDX1    12,QL,PR0
         4 000337   000004 441000 xsym               SXL1    OCL_CONSOLE_REC+4
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:95   

      661     2077    2             OCL_CONSOLE_REC.LOGON = OC_CONSOLE.LOGON (C_INDEX);

   2077  4 000340   000336 236000 1                  LDQ     C_INDEX
         4 000341   000370 402007                    MPY     248,DL
         4 000342   040000 100506                    MLR     fill='040'O
         4 000343   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8
         4 000344   000005 000010 xsym               ADSC9   OCL_CONSOLE_REC+5        cn=0,n=8

      662     2078    2             OCL_CONSOLE_REC.STATION = OC_CONSOLE.STATIONR (C_INDEX);

   2078  4 000345   000000 100506                    MLR     fill='000'O
         4 000346   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         4 000347   000007 000010 xsym               ADSC9   OCL_CONSOLE_REC+7        cn=0,n=8

      663     2079    2             OCL_CONSOLE_REC.STATUS = STATUS;

   2079  4 000350   200006 471500                    LDP1    @STATUS,,AUTO
         4 000351   003000 060500                    CSL     bolr='003'O
         4 000352   100000 000044                    BDSC    0,,PR1                   by=0,bit=0,n=36
         4 000353   000012 010044 xsym               BDSC    OCL_CONSOLE_REC+10       by=0,bit=1,n=36

      664     2080    2             OCL_CONSOLE_REC.UTS = CONS_TIME;

   2080  4 000354   000340 235000 1                  LDA     CONS_TIME
         4 000355   000011 755000 xsym               STA     OCL_CONSOLE_REC+9

      665     2081    2             OCL_CONSOLE_REC.ON_AT_START = '1'B;

   2081  4 000356   400000 236003                    LDQ     -131072,DU
         4 000357   000012 256000 xsym               ORSQ    OCL_CONSOLE_REC+10

      666     2082    2             OCL_CONSOLE_KEY.FIELD = KEY_PLACE;

   2082  4 000360   000000 100400                    MLR     fill='000'O
         4 000361   000337 000004 1                  ADSC9   KEY_PLACE                cn=0,n=4
         4 000362   000000 200004 xsym               ADSC9   OCL_CONSOLE_KEY          cn=1,n=4
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:96   

      667     2083    2             OCL_CONSOLE_FIELD = KEY_PLACE;

   2083  4 000363   000337 235000 1                  LDA     KEY_PLACE
         4 000364   000000 755000 xsym               STA     OCL_CONSOLE_FIELD

      668     2084    2             CALL M$WRITE (WRITE_CONSOLE_REC) ALTRET (WCR_TROUBLE1);

   2084  4 000365   000314 630400 1                  EPPR0   WRITE_CONSOLE_REC
         4 000366   440001 713400                    CLIMB   alt,write
         4 000367   401400 401760                    pmme    nvectors=4
         4 000370   000527 702000 4                  TSX2    WCR_TROUBLE1

      669     2085    2           END;

   2085  4 000371   000336 235000 1                  LDA     C_INDEX
         4 000372   000001 035007                    ADLA    1,DL
         4 000373   000336 755000 1                  STA     C_INDEX
         4 000374   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000375   000022 772000                    QRL     18
         4 000376   000336 116000 1                  CMPQ    C_INDEX
         4 000377   000316 603000 4                  TRC     s:2072
         4 000400   000467 710000 4                  TRA     s:2102

      670     2086    1        ELSE
      671     2087    2        DO;

      672     2088    2             KEY_PLACE = OCL_STATUS_REC.CONSOLE_KEY + 1;

   2088  4 000401   000013 236000 xsym               LDQ     OCL_STATUS_REC+11
         4 000402   000001 036007                    ADLQ    1,DL
         4 000403   000337 756000 1                  STQ     KEY_PLACE

      673     2089    2             OCL_CONSOLE_REC.TERM_NAME = OC_CONSOLE.TERM_NAME(I);

   2089  4 000404   200007 471500                    LDP1    @I,,AUTO
         4 000405   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:97   
         4 000406   000076 402007                    MPY     62,DL
         4 000407   000002 736000                    QLS     2
         4 000410   000000 473400 xsym               LDP3    OC_CONSOLE$
         4 000411   040000 100506                    MLR     fill='040'O
         4 000412   300002 000010                    ADSC9   2,Q,PR3                  cn=0,n=8
         4 000413   000000 000010 xsym               ADSC9   OCL_CONSOLE_REC          cn=0,n=8

      674     2090    2             OCL_CONSOLE_REC.WSN = OC_CONSOLE.WSN(I);

   2090  4 000414   100000 236100                    LDQ     0,,PR1
         4 000415   000076 402007                    MPY     62,DL
         4 000416   000002 736000                    QLS     2
         4 000417   040000 100506                    MLR     fill='040'O
         4 000420   300004 000010                    ADSC9   4,Q,PR3                  cn=0,n=8
         4 000421   000002 000010 xsym               ADSC9   OCL_CONSOLE_REC+2        cn=0,n=8

      675     2091    2             OCL_CONSOLE_REC.ATTR = OC_CONSOLE.ATTR(I);

   2091  4 000422   100000 236100                    LDQ     0,,PR1
         4 000423   000076 402007                    MPY     62,DL
         4 000424   300013 220106                    LDX0    11,QL,PR3
         4 000425   000004 740000 xsym               STX0    OCL_CONSOLE_REC+4

      676     2092    2             OCL_CONSOLE_REC.ATTRO = OC_CONSOLE.ATTRO (I);

   2092  4 000426   100000 236100                    LDQ     0,,PR1
         4 000427   000076 402007                    MPY     62,DL
         4 000430   300014 221106                    LDX1    12,QL,PR3
         4 000431   000004 441000 xsym               SXL1    OCL_CONSOLE_REC+4

      677     2093    2             OCL_CONSOLE_REC.LOGON = OC_CONSOLE.LOGON (I);

   2093  4 000432   100000 236100                    LDQ     0,,PR1
         4 000433   000076 402007                    MPY     62,DL
         4 000434   000002 736000                    QLS     2
         4 000435   040000 100506                    MLR     fill='040'O
         4 000436   300006 000010                    ADSC9   6,Q,PR3                  cn=0,n=8
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:98   
         4 000437   000005 000010 xsym               ADSC9   OCL_CONSOLE_REC+5        cn=0,n=8

      678     2094    2             OCL_CONSOLE_REC.STATION = OC_CONSOLE.STATIONR (I);

   2094  4 000440   100000 236100                    LDQ     0,,PR1
         4 000441   000076 402007                    MPY     62,DL
         4 000442   000002 736000                    QLS     2
         4 000443   000000 100506                    MLR     fill='000'O
         4 000444   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=8
         4 000445   000007 000010 xsym               ADSC9   OCL_CONSOLE_REC+7        cn=0,n=8

      679     2095    2             OCL_CONSOLE_REC.STATUS = STATUS;

   2095  4 000446   200006 474500                    LDP4    @STATUS,,AUTO
         4 000447   003000 060500                    CSL     bolr='003'O
         4 000450   400000 000044                    BDSC    0,,PR4                   by=0,bit=0,n=36
         4 000451   000012 010044 xsym               BDSC    OCL_CONSOLE_REC+10       by=0,bit=1,n=36

      680     2096    2             OCL_CONSOLE_REC.UTS = CONS_TIME;

   2096  4 000452   000340 235000 1                  LDA     CONS_TIME
         4 000453   000011 755000 xsym               STA     OCL_CONSOLE_REC+9

      681     2097    2             OCL_CONSOLE_REC.ON_AT_START = '0'B;

   2097  4 000454   000031 236000 xsym               LDQ     B_VECTNIL+25
         4 000455   000012 356000 xsym               ANSQ    OCL_CONSOLE_REC+10

      682     2098    2             OCL_CONSOLE_KEY.FIELD = KEY_PLACE;

   2098  4 000456   000000 100400                    MLR     fill='000'O
         4 000457   000337 000004 1                  ADSC9   KEY_PLACE                cn=0,n=4
         4 000460   000000 200004 xsym               ADSC9   OCL_CONSOLE_KEY          cn=1,n=4

      683     2099    2             OCL_CONSOLE_FIELD = KEY_PLACE;

   2099  4 000461   000337 235000 1                  LDA     KEY_PLACE
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:99   
         4 000462   000000 755000 xsym               STA     OCL_CONSOLE_FIELD

      684     2100    2             CALL M$WRITE (WRITE_CONSOLE_REC) ALTRET (WCR_TROUBLE1);

   2100  4 000463   000314 630400 1                  EPPR0   WRITE_CONSOLE_REC
         4 000464   440001 713400                    CLIMB   alt,write
         4 000465   401400 401760                    pmme    nvectors=4
         4 000466   000527 702000 4                  TSX2    WCR_TROUBLE1

      685     2101    2           END;

      686     2102    1        OCL_STATUS_REC.LSTATUS = 1;

   2102  4 000467   000001 235007                    LDA     1,DL
         4 000470   000000 755000 xsym               STA     OCL_STATUS_REC

      687     2103    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE;

   2103  4 000471   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000472   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000473   400000 376003                    ANQ     -131072,DU
         4 000474   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      688     2104    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR;

   2104  4 000475   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000476   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         4 000477   377777 376003                    ANQ     131071,DU
         4 000500   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

      689     2105    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN;

   2105  4 000501   000000 720000 xsym               LXL0    OC_HIST_SAVE
         4 000502   000002 440000 xsym               SXL0    OCL_STATUS_REC+2

      690     2106    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE;

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:100  
   2106  4 000503   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000504   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000505   400000 376003                    ANQ     -131072,DU
         4 000506   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      691     2107    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR;

   2107  4 000507   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000510   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         4 000511   377777 376003                    ANQ     131071,DU
         4 000512   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

      692     2108    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN;

   2108  4 000513   000000 721000 xsym               LXL1    OC_ACCT_SAVE
         4 000514   000001 441000 xsym               SXL1    OCL_STATUS_REC+1

      693     2109    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;

   2109  4 000515   000000 100400                    MLR     fill='000'O
         4 000516   000000 000040 xsym               ADSC9   OCL_PREVIOUS_FILE        cn=0,n=32
         4 000517   000003 000040 xsym               ADSC9   OCL_STATUS_REC+3         cn=0,n=32

      694     2110    1        OCL_STATUS_REC.CONSOLE_KEY = KEY_PLACE;

   2110  4 000520   000337 236000 1                  LDQ     KEY_PLACE
         4 000521   000013 756000 xsym               STQ     OCL_STATUS_REC+11

      695     2111    1        CALL M$WRITE (WRITE_STATUS) ALTRET (KEEP_GOING5);

   2111  4 000522   000036 630400 1                  EPPR0   WRITE_STATUS
         4 000523   440001 713400                    CLIMB   alt,write
         4 000524   401400 401760                    pmme    nvectors=4
         4 000525   000526 702000 4                  TSX2    KEEP_GOING5

   2110  4 000526                       KEEP_GOING5  null
      696     2112    1   KEEP_GOING5:;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:101  
      697     2113    2        DO WHILE ('0'B);

   2113  4 000526   000541 710000 4                  TRA     s:2120

   2111  4 000527                       WCR_TROUBLE1 null
      698     2114    2   WCR_TROUBLE1:;
      699     2115    2             OCL_MSGB.CODE = 7;

   2115  4 000527   007000 236003                    LDQ     3584,DU
         4 000530   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      700     2116    2             OCL_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   2116  4 000531   000000 470400 xsym               LDP0    B$TCB$
         4 000532   000000 471500                    LDP1    0,,PR0
         4 000533   100102 236100                    LDQ     66,,PR1
         4 000534   000000 756000 xsym               STQ     OCL_MSGB

      701     2117    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   2117  4 000535   000015 630400 5                  EPPR0   13
         4 000536   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000537   000000 701000 xent               TSX1    OCO$IWRITE
         4 000540   000000 011000                    NOP     0

      702     2118    2                  0, '        ', 0);
      703     2119    2           END;

      704     2120    1        RETURN;

   2120  4 000541   000000 702200 xent               TSX2  ! X66_ARET

      705     2121                                                /**/
      706     2122                                                /**/
      707     2123        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:102  
      708     2124             /****************************************/
      709     2125             /*                                      */
      710     2126             /*     Open the history file shared     */
      711     2127             /*          -Entry point-               */
      712     2128             /*                                      */
      713     2129             /****************************************/
      714     2130                                                /**/
      715     2131    1   OCL$START_SHARED: ENTRY;

   2131  4 000542   000000 700200 xent  OCL$START_S* TSX0  ! X66_AUTO_5
         4 000543   000020 000005                    ZERO    16,5

      716     2132    1        OC_REPLAYS# = OC_REPLAYS# + 1;

   2132  4 000544   000000 054000 xsym               AOS     OC_REPLAYS#

      717     2133    1        IF OC_REPLAYS# = 1 AND OC_LIST

   2133  4 000545   000000 235000 xsym               LDA     OC_REPLAYS#
         4 000546   000001 115007                    CMPA    1,DL
         4 000547   000572 601000 4                  TNZ     PRESS_ON5
         4 000550   000000 234000 xsym               SZN     OC_LIST
         4 000551   000572 605000 4                  TPL     PRESS_ON5

      718     2134    1        THEN
      719     2135    2        DO;

      720     2136    2             CALL M$CLOSE (CLOSE_SAVE)

   2136  4 000552   000052 630400 1                  EPPR0   CLOSE_SAVE
         4 000553   450001 713400                    CLIMB   alt,close
         4 000554   406000 401760                    pmme    nvectors=13
         4 000555   000556 702000 4                  TSX2    SO_WHAT

      721     2137    2                  ALTRET (SO_WHAT);

   2137  4 000556                       SO_WHAT      null
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:103  
      722     2138    2   SO_WHAT:  ;
      723     2139                                                /**/
      724     2140    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON4);

   2140  4 000556   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000557   420012 713400                    CLIMB   alt,+8202
         4 000560   400000 401760                    pmme    nvectors=1
         4 000561   000562 702000 4                  TSX2    PRESS_ON4

   2137  4 000562                       PRESS_ON4    null
      725     2141    2   PRESS_ON4:;
      726     2142    2             CALL M$OPEN (OPEN_HISTORYR)

   2142  4 000562   000202 630400 1                  EPPR0   OPEN_HISTORYR
         4 000563   450000 713400                    CLIMB   alt,open
         4 000564   410400 401760                    pmme    nvectors=18
         4 000565   000573 702000 4                  TSX2    NO_CAN_DO

      727     2143    2                  ALTRET (NO_CAN_DO);
      728     2144    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON5);

   2144  4 000566   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000567   420013 713400                    CLIMB   alt,+8203
         4 000570   400000 401760                    pmme    nvectors=1
         4 000571   000572 702000 4                  TSX2    PRESS_ON5

   2137  4 000572                       PRESS_ON5    null
      729     2145    2   PRESS_ON5:;
      730     2146                                                /**/
      731     2147    2           END;

      732     2148                                                /**/
      733     2149    2        DO WHILE ('0'B);

   2149  4 000572   000615 710000 4                  TRA     TOO_BAD

   2147  4 000573                       NO_CAN_DO    null
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:104  
      734     2150    2   NO_CAN_DO:;
      735     2151                                                /**/
      736     2152    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON6);

   2152  4 000573   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000574   420013 713400                    CLIMB   alt,+8203
         4 000575   400000 401760                    pmme    nvectors=1
         4 000576   000577 702000 4                  TSX2    PRESS_ON6

   2147  4 000577                       PRESS_ON6    null
      737     2153    2   PRESS_ON6:;
      738     2154    2             OCL_MSGB.CODE = 6;

   2154  4 000577   006000 236003                    LDQ     3072,DU
         4 000600   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      739     2155    2             OCL_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   2155  4 000601   000000 470400 xsym               LDP0    B$TCB$
         4 000602   000000 471500                    LDP1    0,,PR0
         4 000603   100102 236100                    LDQ     66,,PR1
         4 000604   000000 756000 xsym               STQ     OCL_MSGB

      740     2156    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   2156  4 000605   000015 630400 5                  EPPR0   13
         4 000606   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000607   000000 701000 xent               TSX1    OCO$IWRITE
         4 000610   000000 011000                    NOP     0

      741     2157    2                  0, '        ', 0);
      742     2158    2             CALL M$CLOSE (CLOSE_SAVE) ALTRET (TOO_BAD);

   2158  4 000611   000052 630400 1                  EPPR0   CLOSE_SAVE
         4 000612   450001 713400                    CLIMB   alt,close
         4 000613   406000 401760                    pmme    nvectors=13
         4 000614   000615 702000 4                  TSX2    TOO_BAD
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:105  

      743     2159    2           END;

   2157  4 000615                       TOO_BAD      null
      744     2160    1   TOO_BAD:;
      745     2161    1        RETURN;

   2161  4 000615   000000 702200 xent               TSX2  ! X66_ARET

      746     2162                                                /**/
      747     2163                                                /**/
      748     2164                                                /**/
      749     2165        %EJECT;
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:106  
      750     2166             /****************************************/
      751     2167             /*                                      */
      752     2168             /*  Open the history file exclusively   */
      753     2169             /*          -Entry point-               */
      754     2170             /*                                      */
      755     2171             /****************************************/
      756     2172                                                /**/
      757     2173                                                /**/
      758     2174    1   OCL$START_EXCLU: ENTRY;

   2174  4 000616   000000 700200 xent  OCL$START_E* TSX0  ! X66_AUTO_5
         4 000617   000020 000005                    ZERO    16,5

      759     2175    1        OC_REPLAYS# = OC_REPLAYS# - 1;

   2175  4 000620   000001 336007                    LCQ     1,DL
         4 000621   000000 056000 xsym               ASQ     OC_REPLAYS#

      760     2176    1        IF OC_REPLAYS# = 0 AND OC_LIST

   2176  4 000622   000645 601000 4                  TNZ     PRESS_ON8
         4 000623   000000 234000 xsym               SZN     OC_LIST
         4 000624   000645 605000 4                  TPL     PRESS_ON8

      761     2177    1        THEN
      762     2178    2        DO;

      763     2179    2             CALL M$CLOSE (CLOSE_SAVE)

   2179  4 000625   000052 630400 1                  EPPR0   CLOSE_SAVE
         4 000626   450001 713400                    CLIMB   alt,close
         4 000627   406000 401760                    pmme    nvectors=13
         4 000630   000631 702000 4                  TSX2    EX_OPEN

      764     2180    2                  ALTRET (EX_OPEN);

   2180  4 000631                       EX_OPEN      null
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:107  
      765     2181    2   EX_OPEN:  ;
      766     2182                                                /**/
      767     2183    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON7);

   2183  4 000631   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000632   420012 713400                    CLIMB   alt,+8202
         4 000633   400000 401760                    pmme    nvectors=1
         4 000634   000635 702000 4                  TSX2    PRESS_ON7

   2180  4 000635                       PRESS_ON7    null
      768     2184    2   PRESS_ON7:;
      769     2185    2             CALL M$OPEN (OPEN_HISTORYU)

   2185  4 000635   000110 630400 1                  EPPR0   OPEN_HISTORYU
         4 000636   450000 713400                    CLIMB   alt,open
         4 000637   410400 401760                    pmme    nvectors=18
         4 000640   000646 702000 4                  TSX2    NO_CAN_DO2

      770     2186    2                  ALTRET (NO_CAN_DO2);
      771     2187    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON8);

   2187  4 000641   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000642   420013 713400                    CLIMB   alt,+8203
         4 000643   400000 401760                    pmme    nvectors=1
         4 000644   000645 702000 4                  TSX2    PRESS_ON8

   2180  4 000645                       PRESS_ON8    null
      772     2188    2   PRESS_ON8:;
      773     2189                                                /**/
      774     2190    2           END;

      775     2191                                                /**/
      776     2192    2        DO WHILE ('0'B);

   2192  4 000645   000705 710000 4                  TRA     TOO_BAD2

   2190  4 000646                       NO_CAN_DO2   null
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:108  
      777     2193    2   NO_CAN_DO2:;
      778     2194                                                /**/
      779     2195    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON9);

   2195  4 000646   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000647   420012 713400                    CLIMB   alt,+8202
         4 000650   400000 401760                    pmme    nvectors=1
         4 000651   000652 702000 4                  TSX2    PRESS_ON9

   2187  4 000652                       PRESS_ON9    null
      780     2196    2   PRESS_ON9:;
      781     2197    2             CALL M$OPEN (OPEN_HISTORYR)

   2197  4 000652   000202 630400 1                  EPPR0   OPEN_HISTORYR
         4 000653   450000 713400                    CLIMB   alt,open
         4 000654   410400 401760                    pmme    nvectors=18
         4 000655   000663 702000 4                  TSX2    TROUBLE

      782     2198    2                  ALTRET (TROUBLE);
      783     2199    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON10);

   2199  4 000656   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000657   420013 713400                    CLIMB   alt,+8203
         4 000660   400000 401760                    pmme    nvectors=1
         4 000661   000662 702000 4                  TSX2    PRESS_ON10

   2199  4 000662                       PRESS_ON10   null
      784     2200    2   PRESS_ON10:;
      785     2201                                                /**/
      786     2202    2             GOTO TOO_BAD2;

   2202  4 000662   000705 710000 4                  TRA     TOO_BAD2

   2199  4 000663                       TROUBLE      null
      787     2203    2   TROUBLE:  ;
      788     2204    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON11);

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:109  
   2204  4 000663   000330 630400 1                  EPPR0   RESET_FMSEC
         4 000664   420013 713400                    CLIMB   alt,+8203
         4 000665   400000 401760                    pmme    nvectors=1
         4 000666   000667 702000 4                  TSX2    PRESS_ON11

   2199  4 000667                       PRESS_ON11   null
      789     2205    2   PRESS_ON11:;
      790     2206    2             OCL_MSGB.CODE = 6;

   2206  4 000667   006000 236003                    LDQ     3072,DU
         4 000670   000001 552040 xsym               STBQ    OCL_MSGB+1,'40'O

      791     2207    2             OCL_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   2207  4 000671   000000 470400 xsym               LDP0    B$TCB$
         4 000672   000000 471500                    LDP1    0,,PR0
         4 000673   100102 236100                    LDQ     66,,PR1
         4 000674   000000 756000 xsym               STQ     OCL_MSGB

      792     2208    2             CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#, OCL_MSGC, OCL_MSGB,

   2208  4 000675   000015 630400 5                  EPPR0   13
         4 000676   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000677   000000 701000 xent               TSX1    OCO$IWRITE
         4 000700   000000 011000                    NOP     0

      793     2209    2                  0, '        ', 0);
      794     2210    2             CALL OCL$HOFF ('200000'O /* M_SYS  */);

   2210  4 000701   000015 630400 5                  EPPR0   13
         4 000702   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000703   000037 701000 4                  TSX1    s:1967
         4 000704   000000 011000                    NOP     0

      795     2211                                                /**/
      796     2212                                           /* If :OCHIST can't be opened
      797     2213                                                exclusive, that means a
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:110  
      798     2214                                                REPLAY has already re-opened
      799     2215                                                :OCHIST shared to begin
      800     2216                                                listing. This phenomenon
      801     2217                                                is caused by REPLAYs
      802     2218                                                re_opening of the file for listing
      803     2219                                                before KEYIN can process CSCG events
      804     2220                                                which close and re_open :OCHIST
      805     2221                                                exclusively. */
      806     2222                                                /**/
      807     2223    2           END;

   2210  4 000705                       TOO_BAD2     null
      808     2224    1   TOO_BAD2:;
      809     2225    1        RETURN;

   2225  4 000705   000000 702200 xent               TSX2  ! X66_ARET
      810     2226                                                /**/
      811     2227    1   END OCL$KEYIN;
      812     2228        %EOD;

PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:111  
--  Include file information  --

   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$KEYIN.
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:112  

 **** Variables and constants ****

  ****  Section 001  Data  OCL$KEYIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    52-0-0/d STRC(1080)  r     1 CLOSE_SAVE               340-0-0/b UBIN        r     1 CONS_TIME
   336-0-0/b UBIN        r     1 C_INDEX                  337-0-0/b UBIN        r     1 KEY_PLACE
   334-0-0/b UBIN(18)    r     1 MSG#                     335-0-0/b UBIN(9)     r     1 NP#
   274-0-0/c STRC(72)    r     1 OCHIST                   202-0-0/d STRC(2088)  r     1 OPEN_HISTORYR
   110-0-0/d STRC(2088)  r     1 OPEN_HISTORYU            330-0-0/d STRC(144)   r     1 RESET_FMSEC
   276-0-0/c STRC(72)    r     1 SYS                      300-0-0/d STRC(432)   r     1 TIME_FOR_CONSOLES
     0-0-0/d STRC(1080)  r     1 WITH_RENAME              314-0-0/d STRC(432)   r     1 WRITE_CONSOLE_REC
    36-0-0/d STRC(432)   r     1 WRITE_STATUS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CADDR                     5-0-0/w PTR         r     1 @CONSOLE_FLAG
     7-0-0/w PTR         r     1 @I                         6-0-0/w PTR         r     1 @STATUS
     4-0-0/w PTR         r     1 @TCFID                    *0-0-0/c BIT (18)    r     1 CADDR
    *0-0-0/w UBIN        r     1 CONSOLE_FLAG              *0-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 STATUS                    *0-0-0/c ASTR(9)     r     1 TCFID

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c BIT         r     1 OCL_BROKEN_FILE            0-0-0/w UBIN        r     1 OCL_CONSOLE_FIELD
     0-0-0/b STRC(45)    r     1 OCL_CONSOLE_KEY            0-0-0/h STRC(397)   r     1 OCL_CONSOLE_REC
     0-0-0/b STRC(45)    r     1 OCL_MSGB                   0-0-0/b STRC(18)    r     1 OCL_MSGC
     0-0-0/c STRC(288)   r     1 OCL_PREVIOUS_FILE          0-0-0/b STRC(45)    r     1 OCL_STATUS_KEY
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:113  
     0-0-0/c STRC(432)   r     1 OCL_STATUS_REC
     0-0-0/w BIT         r     1 OCL_WRITE_CONSOLE_RECS
     0-0-0/b STRC        r     1 OC_ACCT_SAVE               0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/b STRC        r     1 OC_HIST_SAVE               0-0-0/w BIT         r     1 OC_LIST
     0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE              0-0-0/w SBIN        r     1 OC_REPLAYS#
     0-0-0/w BIT         r     1 OC_TLIST

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 F$HISTFILE
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCL$KEYIN requires 454 words for executable code.
   Procedure OCL$KEYIN requires 16 words of local(AUTO) storage.
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:114  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:115  
          MINI XREF LISTING

B$ALT.CODE
      1415**DCL      1415--REDEF    1416--REDEF    1416--REDEF
B$ALT.ERR
      1416**DCL      2116>>ASSIGN   2155>>ASSIGN   2207>>ASSIGN
B$ALT.ERR.ERR#
      1417**DCL      1417--REDEF
B$ALT.EVID
      1416**DCL      1416--REDEF    1416--REDEF
B$JIT.CPFLAGS1.SLEAZE
      1225**DCL      1225--REDEF
B$JIT.ERR.MID
      1132**DCL      1132--REDEF
B$JIT.JRESPEAK
      1293**DCL      1294--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1402**DCL      1402--REDEF    1403--REDEF
B$JIT.PNR
      1306**DCL      1306--REDEF
B$JIT.TSLINE
      1400**DCL      1401--REDEF
B$JIT$
      1407**DCL      1126--IMP-PTR
B$TCB.ALT$
      1411**DCL      2116>>ASSIGN   2155>>ASSIGN   2207>>ASSIGN
B$TCB$
      1409**DCL      2116>>ASSIGN   2155>>ASSIGN   2207>>ASSIGN
CADDR
      1924**DCL        18--PROC     1942--ENTRY    1948<>CALL     1967--ENTRY    1973<>CALL     1994<>CALL
      2008--ENTRY    2049<>CALL     2065--ENTRY
CLOSE_SAVE
      1530**DCL      1975<>CALL     1991<>CALL     2015<>CALL     2136<>CALL     2158<>CALL     2179<>CALL
CLOSE_SAVE.SN_
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:116  
      1530**DCL      1530--REDEF
CLOSE_SAVE.UTL_
      1531**DCL      1531--REDEF
CLOSE_SAVE.V
      1535**DCL      1530--DCLINIT
CLOSE_SAVE.V.EXPIRE#
      1545**DCL      1545--REDEF
CLOSE_SAVE.V.TYPE#
      1543**DCL      1543--REDEF
CLOSE_SAVE.V.XTNSIZE#
      1540**DCL      1540--REDEF    1542--REDEF
CONSOLE_FLAG
      1928**DCL        18--PROC     2065--ENTRY    2069>>IF
CONS_TIME
      1922**DCL      1853--DCLINIT  2080>>ASSIGN   2096>>ASSIGN
C_INDEX
      1920**DCL      2071<<DOINDEX  2073>>ASSIGN   2074>>ASSIGN   2075>>ASSIGN   2076>>ASSIGN   2077>>ASSIGN
      2078>>ASSIGN
EX_OPEN
      2180**LABEL    2179--CALLALT
I
      1930**DCL        18--PROC     2065--ENTRY    2089>>ASSIGN   2090>>ASSIGN   2091>>ASSIGN   2092>>ASSIGN
      2093>>ASSIGN   2094>>ASSIGN
KEEP_GOING1
      2065**LABEL    2066--CALLALT
KEEP_GOING5
      2110**LABEL    2111--CALLALT
KEY_PLACE
      1921**DCL      2068<<ASSIGN   2072<<ASSIGN   2072>>ASSIGN   2082>>ASSIGN   2083>>ASSIGN   2088<<ASSIGN
      2098>>ASSIGN   2099>>ASSIGN   2110>>ASSIGN
M$CLOSE
       884**DCL-ENT  1975--CALL     1991--CALL     2015--CALL     2024--CALL     2136--CALL     2158--CALL
      2179--CALL
M$OPEN
       884**DCL-ENT  2019--CALL     2142--CALL     2185--CALL     2197--CALL
M$RPRIV
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:117  
       943**DCL-ENT  2020--CALL     2038--CALL     2144--CALL     2152--CALL     2187--CALL     2199--CALL
      2204--CALL
M$SPRIV
       943**DCL-ENT  2017--CALL     2140--CALL     2183--CALL     2195--CALL
M$TIME
       951**DCL-ENT  2066--CALL
M$WRITE
       885**DCL-ENT  1989--CALL     2084--CALL     2100--CALL     2111--CALL
MSG#
      1918**DCL      1948<>CALL     1973<>CALL     1994<>CALL     2049<>CALL     2117<>CALL     2156<>CALL
      2208<>CALL
NO_CAN_DO
      2147**LABEL    2142--CALLALT
NO_CAN_DO2
      2190**LABEL    2185--CALLALT
NP#
      1919**DCL      1948<>CALL     1973<>CALL     1994<>CALL     2049<>CALL     2117<>CALL     2156<>CALL
      2208<>CALL
OCHIST
      1816**DCL      1626--DCLINIT  1746--DCLINIT
OCL$HOFF
      1967**ENTRY    2210--CALL
OCL$INIT
      1915**DCL-ENT  1955--CALL     2033--CALL
OCL_BROKEN_FILE
       873**DCL      2029>>IF
OCL_CONSOLE_FIELD
       872**DCL      1988>>ASSIGN   2027<<ASSIGN   2083<<ASSIGN   2099<<ASSIGN
OCL_CONSOLE_KEY
       869**DCL      1881--DCLINIT
OCL_CONSOLE_KEY.FIELD
       870**DCL      2082<<ASSIGN   2098<<ASSIGN
OCL_CONSOLE_REC
       870**DCL      1882--DCLINIT  1883--DCLINIT
OCL_CONSOLE_REC.ATTR
       871**DCL      2075<<ASSIGN   2091<<ASSIGN
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:118  
OCL_CONSOLE_REC.ATTRO
       871**DCL      2076<<ASSIGN   2092<<ASSIGN
OCL_CONSOLE_REC.LOGON
       871**DCL      2077<<ASSIGN   2093<<ASSIGN
OCL_CONSOLE_REC.ON_AT_START
       872**DCL      2081<<ASSIGN   2097<<ASSIGN
OCL_CONSOLE_REC.STATION
       871**DCL      2078<<ASSIGN   2094<<ASSIGN
OCL_CONSOLE_REC.STATUS
       872**DCL      2079<<ASSIGN   2095<<ASSIGN
OCL_CONSOLE_REC.TERM_NAME
       870**DCL      2073<<ASSIGN   2089<<ASSIGN
OCL_CONSOLE_REC.UTS
       872**DCL      2080<<ASSIGN   2096<<ASSIGN
OCL_CONSOLE_REC.WSN
       870**DCL      2074<<ASSIGN   2090<<ASSIGN
OCL_HIST_BUF.STAT
       867**DCL       868--REDEF
OCL_MSGB
       865**DCL      1948<>CALL     1973<>CALL     1994<>CALL     2049<>CALL     2117<>CALL     2156<>CALL
      2208<>CALL
OCL_MSGB.CODE
       866**DCL      1947<<ASSIGN   1972<<ASSIGN   1993<<ASSIGN   2043<<ASSIGN   2047<<ASSIGN   2115<<ASSIGN
      2154<<ASSIGN   2206<<ASSIGN
OCL_MSGB.ERR
       865**DCL       866--REDEF
OCL_MSGB.ERROR
       866**DCL      2116<<ASSIGN   2155<<ASSIGN   2207<<ASSIGN
OCL_MSGC
       865**DCL      1948<>CALL     1973<>CALL     1994<>CALL     2049<>CALL     2117<>CALL     2156<>CALL
      2208<>CALL
OCL_PREVIOUS_FILE
       859**DCL      1987>>ASSIGN   2025<<ASSIGN   2109>>ASSIGN
OCL_STATUS_KEY
       860**DCL      1490--DCLINIT
OCL_STATUS_REC
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:119  
       858**DCL      1491--DCLINIT  1492--DCLINIT
OCL_STATUS_REC.AACTIVE
       858**DCL      1984<<ASSIGN   2106<<ASSIGN
OCL_STATUS_REC.AHOUR
       858**DCL      1985<<ASSIGN   2107<<ASSIGN
OCL_STATUS_REC.AMIN
       858**DCL      1986<<ASSIGN   2108<<ASSIGN
OCL_STATUS_REC.CONSOLE_KEY
       859**DCL      1988<<ASSIGN   2026<<ASSIGN   2068>>ASSIGN   2088>>ASSIGN   2110<<ASSIGN
OCL_STATUS_REC.LSTATUS
       858**DCL      1980<<ASSIGN   2102<<ASSIGN
OCL_STATUS_REC.OACTIVE
       858**DCL      1981<<ASSIGN   2103<<ASSIGN
OCL_STATUS_REC.OHOUR
       858**DCL      1982<<ASSIGN   2104<<ASSIGN
OCL_STATUS_REC.OMIN
       859**DCL      1983<<ASSIGN   2105<<ASSIGN
OCL_STATUS_REC.PREV_FILE
       859**DCL      1987<<ASSIGN   2109<<ASSIGN
OCL_WRITE_CONSOLE_RECS
       873**DCL      1954<<ASSIGN   2028<<ASSIGN
OCO$IWRITE
      1914**DCL-ENT  1948--CALL     1973--CALL     1994--CALL     2049--CALL     2117--CALL     2156--CALL
      2208--CALL
OC_ACCT_SAVE.ACTIVE
      1115**DCL      1984>>ASSIGN   2106>>ASSIGN
OC_ACCT_SAVE.HOUR
      1115**DCL      1985>>ASSIGN   2107>>ASSIGN
OC_ACCT_SAVE.MIN
      1115**DCL      1986>>ASSIGN   2108>>ASSIGN
OC_CONSOLE.ATTR
      1070**DCL      1070--REDEF    2075>>ASSIGN   2091>>ASSIGN
OC_CONSOLE.ATTRO
      1071**DCL      1071--REDEF    2076>>ASSIGN   2092>>ASSIGN
OC_CONSOLE.CID
      1069**DCL      1070--REDEF
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:120  
OC_CONSOLE.LOGON
      1069**DCL      2077>>ASSIGN   2093>>ASSIGN
OC_CONSOLE.STATION
      1068**DCL      1068--REDEF
OC_CONSOLE.STATIONR
      1068**DCL      2078>>ASSIGN   2094>>ASSIGN
OC_CONSOLE.TERM_NAME
      1069**DCL      2073>>ASSIGN   2089>>ASSIGN
OC_CONSOLE.WSN
      1069**DCL      2074>>ASSIGN   2090>>ASSIGN
OC_CONSOLE$
      1067**DCL      1068--IMP-PTR  2073>>ASSIGN   2074>>ASSIGN   2075>>ASSIGN   2076>>ASSIGN   2077>>ASSIGN
      2078>>ASSIGN   2089>>ASSIGN   2090>>ASSIGN   2091>>ASSIGN   2092>>ASSIGN   2093>>ASSIGN   2094>>ASSIGN
OC_DIR
      1110**DCL      1110--REDEF
OC_HIST_SAVE.ACTIVE
      1114**DCL      1981>>ASSIGN   2103>>ASSIGN
OC_HIST_SAVE.HOUR
      1114**DCL      1982>>ASSIGN   2104>>ASSIGN
OC_HIST_SAVE.MIN
      1114**DCL      1983>>ASSIGN   2105>>ASSIGN
OC_INTBIT
      1110**DCL      1111--REDEF
OC_INTMSG
       987**DCL      1000--REDEF
OC_INTMSG.FLAGS
       994**DCL       995--REDEF
OC_INTMSG.MESS
      1000**DCL      1000--REDEF
OC_INTMSG.MSGID
       990**DCL       991--REDEF
OC_INTMSG.WSN
       997**DCL       998--REDEF
OC_LIST
      1113**DCL      1944>>IF       1969>>IF       1979<<ASSIGN   2013>>IF       2032>>ASSIGN   2133>>IF
      2176>>IF
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:121  
OC_MASK
      1111**DCL      1111--REDEF
OC_MAXCONSOLE
      1067**DCL      2071>>DOINDEX
OC_MESSBUF
      1002**DCL      1017--REDEF    1031--REDEF
OC_MESSBUF.FLAGS
      1009**DCL      1010--REDEF
OC_MESSBUF.MESS
      1015**DCL      1015--REDEF
OC_MESSBUF.MSGID
      1005**DCL      1006--REDEF
OC_MESSBUF.WSN
      1012**DCL      1013--REDEF
OC_MESSBUF1.FLAGS
      1024**DCL      1025--REDEF
OC_MESSBUF1.LEN
      1030**DCL      1030--REDEF
OC_MESSBUF1.MSGID
      1020**DCL      1021--REDEF
OC_MESSBUF1.WSN
      1027**DCL      1028--REDEF
OC_MSGBUFFER
      1033**DCL      1048--REDEF
OC_MSGBUFFER.FLAGS
      1040**DCL      1041--REDEF
OC_MSGBUFFER.MESS
      1046**DCL      1046--REDEF
OC_MSGBUFFER.MSGID
      1036**DCL      1037--REDEF
OC_MSGBUFFER.WSN
      1043**DCL      1044--REDEF
OC_MSGBUFFER2.FLAGS
      1055**DCL      1056--REDEF
OC_MSGBUFFER2.MSGID
      1051**DCL      1052--REDEF
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:122  
OC_MSGBUFFER2.WSN
      1058**DCL      1059--REDEF
OC_PARAM
      1066**DCL      1066--REDEF
OC_QUEUE.PARMC
      1065**DCL      1065--REDEF
OC_REPLAYS#
      1115**DCL      2010>>IF       2040>>IF       2132<<ASSIGN   2132>>ASSIGN   2133>>IF       2175<<ASSIGN
      2175>>ASSIGN   2176>>IF
OC_TLIST
      1113**DCL      1953<<ASSIGN   2032<<ASSIGN
OPEN_HISTORYR
      1745**DCL      2142<>CALL     2197<>CALL
OPEN_HISTORYR.ACSVEH_
      1747**DCL      1748--REDEF
OPEN_HISTORYR.ALTKEYS_
      1753**DCL      1754--REDEF    1754--REDEF
OPEN_HISTORYR.HDR_
      1752**DCL      1753--REDEF
OPEN_HISTORYR.TAB_
      1751**DCL      1752--REDEF
OPEN_HISTORYR.UHL_
      1745**DCL      1746--REDEF    1746--REDEF
OPEN_HISTORYR.V
      1754**DCL      1745--DCLINIT
OPEN_HISTORYR.V.FSN#
      1785**DCL      1785--REDEF    1785--REDEF
OPEN_HISTORYR.WSN_
      1751**DCL      1751--REDEF
OPEN_HISTORYU
      1625**DCL      2019<>CALL     2185<>CALL
OPEN_HISTORYU.ACSVEH_
      1627**DCL      1628--REDEF
OPEN_HISTORYU.ALTKEYS_
      1633**DCL      1634--REDEF    1634--REDEF
OPEN_HISTORYU.HDR_
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:123  
      1632**DCL      1633--REDEF
OPEN_HISTORYU.TAB_
      1631**DCL      1632--REDEF
OPEN_HISTORYU.UHL_
      1625**DCL      1626--REDEF    1626--REDEF
OPEN_HISTORYU.V
      1634**DCL      1625--DCLINIT
OPEN_HISTORYU.V.FSN#
      1665**DCL      1665--REDEF    1665--REDEF
OPEN_HISTORYU.WSN_
      1631**DCL      1631--REDEF
PRESS_ON1
      2013**LABEL    2017--CALLALT
PRESS_ON10
      2199**LABEL    2199--CALLALT
PRESS_ON11
      2199**LABEL    2204--CALLALT
PRESS_ON2
      2013**LABEL    2020--CALLALT
PRESS_ON3
      2029**LABEL    2038--CALLALT
PRESS_ON4
      2137**LABEL    2140--CALLALT
PRESS_ON5
      2137**LABEL    2144--CALLALT
PRESS_ON6
      2147**LABEL    2152--CALLALT
PRESS_ON7
      2180**LABEL    2183--CALLALT
PRESS_ON8
      2180**LABEL    2187--CALLALT
PRESS_ON9
      2187**LABEL    2195--CALLALT
RESET_FMSEC
      1908**DCL      2017<>CALL     2020<>CALL     2038<>CALL     2140<>CALL     2144<>CALL     2152<>CALL
      2183<>CALL     2187<>CALL     2195<>CALL     2199<>CALL     2204<>CALL
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:124  
RESET_FMSEC.V
      1908**DCL      1908--DCLINIT
SO_WHAT
      2137**LABEL    2136--CALLALT
STATUS
      1929**DCL        18--PROC     2065--ENTRY    2079>>ASSIGN   2095>>ASSIGN
SYS
      1831**DCL      1630--DCLINIT  1750--DCLINIT
TCFID
      1925**DCL        18--PROC     2008--ENTRY    2023--ASSIGN   2025>>ASSIGN   2065--ENTRY
TCFID.COUNT
      1926**DCL      1927--IMP-SIZ  2023>>ASSIGN   2025>>ASSIGN
TELL_EM
      2029**LABEL    2012--GOTO     2015--CALLALT  2019--CALLALT  2024--CALLALT
TIME_FOR_CONSOLES
      1849**DCL      2066<>CALL
TIME_FOR_CONSOLES.V
      1853**DCL      1849--DCLINIT
TOO_BAD
      2157**LABEL    2158--CALLALT
TOO_BAD2
      2210**LABEL    2202--GOTO
TROUBLE
      2199**LABEL    2197--CALLALT
WCR_TROUBLE1
      2111**LABEL    2084--CALLALT  2100--CALLALT
WHO_CARES1
      1988**LABEL    1991--CALLALT
WITH_RENAME
      1449**DCL      2024<>CALL
WITH_RENAME.NAME_
      1450**DCL      2023<<ASSIGN
WITH_RENAME.SN_
      1449**DCL      1449--REDEF
WITH_RENAME.UTL_
      1450**DCL      1450--REDEF
PL6.E3A0      #002=OCL$KEYIN File=OCL$LISTER.:E05TSI                             WED 07/30/97 04:00 Page:125  
WITH_RENAME.V
      1454**DCL      1449--DCLINIT
WITH_RENAME.V.EXPIRE#
      1464**DCL      1464--REDEF
WITH_RENAME.V.TYPE#
      1462**DCL      1462--REDEF
WITH_RENAME.V.XTNSIZE#
      1459**DCL      1459--REDEF    1461--REDEF
WRITE_CONSOLE_REC
      1881**DCL      2084<>CALL     2100<>CALL
WRITE_CONSOLE_REC.STATION_
      1883**DCL      1883--REDEF
WRITE_CONSOLE_REC.V
      1884**DCL      1881--DCLINIT
WRITE_CONSOLE_REC.V.DVBYTE.VFC#
      1890**DCL      1890--REDEF
WRITE_STATUS
      1490**DCL      1989<>CALL     2111<>CALL
WRITE_STATUS.STATION_
      1492**DCL      1492--REDEF
WRITE_STATUS.V
      1493**DCL      1490--DCLINIT
WRITE_STATUS.V.DVBYTE.VFC#
      1499**DCL      1499--REDEF
X
      1988**LABEL    1989--CALLALT

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:126  
      813        1        /*M* OCL$LISTIT KEYINs routine for making entries in history file */
      814        2        /*T***********************************************************/
      815        3        /*T*                                                         */
      816        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      817        5        /*T*                                                         */
      818        6        /*T***********************************************************/
      819        7                                                /**/
      820        8        %SET LISTSUB='1'B;
      821        9                                                /**/
      822       10                                                                          /*
      823       11          ###    ###   #        #    #       ###    ###   #####   ###   #####
      824       12         # # #  #   #  #       ###   #        #    #   #    #      #      #
      825       13         # # #  #      #      # #    #        #    #        #      #      #
      826       14         #  ##  #      #       ###   #        #     ###     #      #      #
      827       15         #   #  #      #        # #  #        #        #    #      #      #
      828       16         #   #  #   #  #       ###   #        #    #   #    #      #      #
      829       17          ###    ###   #####    #    #####   ###    ###     #     ###     #
      830       18                                                                          */
      831       19                                                /**/
      832       20        OCL$LISTIT: PROC (CADDR, MODE_, MSG#, WSNDV, INDEX_, SIZE_, TEXT, TERM_TEXT,
                20            WSN_TEXT);
      833       21                                                /**/
      834       22    1   DCL CADDR BIT(18) CALIGNED;
      835       23    1   DCL MODE_ UBIN WORD CALIGNED;
      836       24    1   DCL MSG# UBIN HALF CALIGNED;
      837       25    1   DCL WSNDV CHAR(8) CALIGNED;
      838       26    1   DCL INDEX_ UBIN WORD ALIGNED;
      839       27    1   DCL SIZE_ UBIN WORD CALIGNED;
      840       28    1   DCL TEXT CHAR(SIZE_) UNAL;
      841       29    1   DCL TERM_TEXT CHAR(8) CALIGNED;
      842       30    1   DCL WSN_TEXT CHAR(8) CALIGNED;
      843       31                                                /**/
      844       32        %INCLUDE OCI_SUBS_C;
      845      130        %INCLUDE OC_SUBS_C;
      846      861        %INCLUDE OUT_SUBS_C;
      847      984        %INCLUDE OCM_DATA_R;
      848      997                                                /**/
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:127  
      849      998        %INCLUDE OCL_DATA_R;
      850     1023                                                /**/
      851     1024        %INCLUDE CP_6;
      852     1105        %INCLUDE B_ERRORS_C;
      853     2232    1   DCL B$TCB$ PTR SYMREF;
      854     2233        %B$TCB;
      855     2236        %B$ALT;
      856     2244        %INCLUDE OC_DAT_R;
      857     2405                                                /**/
      858     2406             %FPT_TIME      (FPTN=GET_KEY,
      859     2407                                 SOURCE=CLOCK,
      860     2408                                 DEST=UTS,
      861     2409                                 TSTAMP=OCL_NORM_KEY.UTS);
      862     2428                                                /**/
      863     2429             %FPT_WRITE     (FPTN=WRITE_ENTRY,
      864     2430                                 BUF=OCL_HIST_BUF,
      865     2431                                 BP=NO,
      866     2432                                 DCB=F$HISTFILE,
      867     2433                                 KEY=OCL_NORM_KEY,
      868     2434                                 NEWKEY=YES,
      869     2435                                 ONEWKEY=NO,
      870     2436                                 WAIT=YES);
      871     2467                                                /**/
      872     2468    1   DCL I SBIN WORD ALIGNED STATIC;
      873     2469                                                /**/
      874     2470    1   DCL OCL$WRITE_CONSOLE_REC ENTRY(5);
      875     2471    1   DCL OCL$HOFF ENTRY(1);
      876     2472                                                /**/
      877     2473    1   DCL F$HISTFILE DCB;
      878     2474                                                /**/
      879     2475        %EJECT;
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:128  
      880     2476                                                /**/
      881     2477        /*
      882     2478             Begin   O C L $ L I S T I T    main
      883     2479                                                          */
      884     2480                                                /**/
      885     2481    1        IF ~OC_LIST
      886     2482    1        THEN
      887     2483    1             RETURN;
      888     2484                                                /**/
      889     2485    1        IF MSG# ~= 1024 /* LGST_MSG# */
      890     2486    1        THEN
      891     2487    2        DO;
      892     2488    3             DO I = 0 TO 9 /* OCL_NUM# */;
      893     2489    3                  IF MSG# = OCL_BADMSG (I)
      894     2490    3                  THEN
      895     2491    3                       RETURN;
      896     2492    3                END;                       /* DO I */
      897     2493    2           END;                            /* DO IF MSG# IS CHECKABLE */
      898     2494                                                /**/
      899     2495    1        IF MODE_  ~= 0 /* OCI_OUTPUT# */           /* IS THIS A MESSAGAGE */
      900     2496    1        THEN
      901     2497    1             OCL_HIST_BUF.TYPE = 2;
      902     2498    1        ELSE
      903     2499    1             IF CADDR & OC_DIR             /* DIRECT ADDRESS */
      904     2500    1             THEN
      905     2501    1                  OCL_HIST_BUF.TYPE = 1;
      906     2502    1             ELSE
      907     2503    1                  OCL_HIST_BUF.TYPE = 0;   /* MUST BE ATTR WRITE */
      908     2504                                                /**/
      909     2505                                                /**/
      910     2506                                           /* If MSG# has no template,
      911     2507                                                indicate so by flag TEMPLATE */
      912     2508    1        IF MODE_ = 0 /* OCI_OUTPUT# */
      913     2509    1             AND MSG# = 1024 /* LGST_MSG# */
      914     2510    1        THEN
      915     2511    1             OCL_HIST_BUF.TEMPLATE = '1'B;
      916     2512    1        ELSE
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:129  
      917     2513    1             OCL_HIST_BUF.TEMPLATE = '0'B;
      918     2514                                                /**/
      919     2515                                                /**/
      920     2516                                                /**/
      921     2517    1        IF INDEX_  ~=  OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */    /* HAVE A GOOD INDEX */
      922     2518    1        THEN
      923     2519    2        DO;
      924     2520    2             OCL_HIST_BUF.LOGON = OC_CONSOLE.LOGON (INDEX_);
      925     2521    2             OCL_HIST_BUF.DEVNM = OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
      926     2522    2             OCL_HIST_BUF.STATION = OC_CONSOLE.STATIONR(INDEX_);
      927     2523    2             OCL_HIST_BUF.TERMINAL = OC_CONSOLE.TERM_NAME(INDEX_);
      928     2524    2             OCL_HIST_BUF.WSN = OC_CONSOLE.WSN(INDEX_);
      929     2525    2             IF MODE_ = 0 /* OCI_OUTPUT# */
      930     2526    2             THEN
      931     2527    2                  OCL_HIST_BUF.ATTR = OC_CONSOLE.ATTR_OUTPUT(INDEX_); /* USE OUTPUT */
      932     2528    2           END;                            /* END IF VALID INDEX */
      933     2529    1        ELSE
      934     2530    2        DO;
      935     2531    2             OCL_HIST_BUF.LOGON = ' ';
      936     2532    2             OCL_HIST_BUF.DEVNM = ' ';
      937     2533    2             OCL_HIST_BUF.STAT = WSNDV;
      938     2534    2             OCL_HIST_BUF.TERMINAL = TERM_TEXT;
      939     2535    2             OCL_HIST_BUF.WSN = WSN_TEXT;
      940     2536    2             OCL_HIST_BUF.ATTR = CADDR;    /* MUST BE ATTRIBUTE WRITE */
      941     2537    2           END;
      942     2538                                                /**/
      943     2539                                                /**/
      944     2540    1        OCL_HIST_BUF.TSTAMP = OCM_TSTAMP;
      945     2541    1        OCL_HIST_BUF.PROMPT_LENGTH = OCM_PROMPT.SIZE;
      946     2542
      947     2543    1        CALL CONCAT(OCL_HIST_BUF.MESS,SUBSTR(OCM_PROMPT.TEXT,0,OCM_PROMPT.SIZE),
      948     2544    1             TEXT);
      949     2545                                                /**/
      950     2546                                                /**/
      951     2547    1        IF OCL_WRITE_CONSOLE_RECS = '1'B
      952     2548    1        THEN
      953     2549    2        DO;
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:130  
      954     2550    2             OCL_WRITE_CONSOLE_RECS = '0'B;
      955     2551    2             CALL OCL$WRITE_CONSOLE_REC (, , 0 /* ALL_CONSOLES# */, 1
              2551                      /* CONSOLE_UPD# */,);
      956     2552    2           END;
      957     2553                                                /**/
      958     2554                                                /**/
      959     2555    1   WHAT_THE_90: ;
      960     2556    1        CALL M$TIME(GET_KEY) ALTRET(BAD_HIST);
      961     2557    1        WRITE_ENTRY.BUF_.BOUND = SIZEC(OCL_HIST_BUF) - SIZEC(OCL_HIST_BUF.MESS)
      962     2558    1             + OCM_PROMPT.SIZE + SIZE_ - 1;
      963     2559    1        CALL M$WRITE(WRITE_ENTRY) ALTRET(BAD_HIST);
      964     2560    1        RETURN;
      965     2561                                                /**/
      966     2562    1   BAD_HIST:;
      967     2563    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$OLDREC
      968     2564    1        THEN
      969     2565    1             GOTO WHAT_THE_90;
      970     2566    1        CALL OCL$HOFF('200000'O /* M_SYS  */);           /* Turn off history logging */
      971     2567    1        RETURN;
      972     2568    1   END OCL$LISTIT;
      973     2569        %EOD;

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:131  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$LISTIT.

   Procedure OCL$LISTIT requires 209 words for executable code.
   Procedure OCL$LISTIT requires 16 words of local(AUTO) storage.

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:132  

 Object Unit name= OCL$LISTIT                                 File name= OCL$LISTER.:E05TOU
 UTS= JUL 30 '97 04:01:29.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    25     31  OCL$LISTIT
    2   DCB   even  none     0      0  F$HISTFILE
    3   Proc  even  none   209    321  OCL$LISTIT
    4  RoData even  none     5      5  OCL$LISTIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        9  OCL$LISTIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 OCL$WRITE_CONSOLE_REC
         yes           Std       1 OCL$HOFF
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:133  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     OCM_PROMPT                            OCM_TSTAMP                            OCL_BADMSG
     OCL_NORM_KEY                          OCL_HIST_BUF                          OCL_WRITE_CONSOLE_RECS
     M$UC                                  B$TCB$                                OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_PARAM
     OC_CONSOLE$                           OC_MAXCONSOLE                         OC_DIR
     OC_INTBIT                             OC_MASK                               OC_LIST
     F$HISTFILE                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:134  


      813        1        /*M* OCL$LISTIT KEYINs routine for making entries in history file */
      814        2        /*T***********************************************************/
      815        3        /*T*                                                         */
      816        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      817        5        /*T*                                                         */
      818        6        /*T***********************************************************/
      819        7                                                /**/
      820        8        %SET LISTSUB='1'B;
      821        9                                                /**/
      822       10                                                                          /*
      823       11          ###    ###   #        #    #       ###    ###   #####   ###   #####
      824       12         # # #  #   #  #       ###   #        #    #   #    #      #      #
      825       13         # # #  #      #      # #    #        #    #        #      #      #
      826       14         #  ##  #      #       ###   #        #     ###     #      #      #
      827       15         #   #  #      #        # #  #        #        #    #      #      #
      828       16         #   #  #   #  #       ###   #        #    #   #    #      #      #
      829       17          ###    ###   #####    #    #####   ###    ###     #     ###     #
      830       18                                                                          */
      831       19                                                /**/
      832       20        OCL$LISTIT: PROC (CADDR, MODE_, MSG#, WSNDV, INDEX_, SIZE_, TEXT, TERM_TEXT,
                20            WSN_TEXT);

     20  3 000000   000000 700200 xent  OCL$LISTIT   TSX0  ! X66_AUTO_N
         3 000001   000020 000011                    ZERO    16,9

      833       21                                                /**/
      834       22    1   DCL CADDR BIT(18) CALIGNED;
      835       23    1   DCL MODE_ UBIN WORD CALIGNED;
      836       24    1   DCL MSG# UBIN HALF CALIGNED;
      837       25    1   DCL WSNDV CHAR(8) CALIGNED;
      838       26    1   DCL INDEX_ UBIN WORD ALIGNED;
      839       27    1   DCL SIZE_ UBIN WORD CALIGNED;
      840       28    1   DCL TEXT CHAR(SIZE_) UNAL;
      841       29    1   DCL TERM_TEXT CHAR(8) CALIGNED;
      842       30    1   DCL WSN_TEXT CHAR(8) CALIGNED;
      843       31                                                /**/
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:135  
      844       32        %INCLUDE OCI_SUBS_C;
      845      130        %INCLUDE OC_SUBS_C;
      846      861        %INCLUDE OUT_SUBS_C;
      847      984        %INCLUDE OCM_DATA_R;
      848      997                                                /**/
      849      998        %INCLUDE OCL_DATA_R;
      850     1023                                                /**/
      851     1024        %INCLUDE CP_6;
      852     1105        %INCLUDE B_ERRORS_C;
      853     2232    1   DCL B$TCB$ PTR SYMREF;
      854     2233        %B$TCB;
      855     2236        %B$ALT;
      856     2244        %INCLUDE OC_DAT_R;
      857     2405                                                /**/
      858     2406             %FPT_TIME      (FPTN=GET_KEY,
      859     2407                                 SOURCE=CLOCK,
      860     2408                                 DEST=UTS,
      861     2409                                 TSTAMP=OCL_NORM_KEY.UTS);
      862     2428                                                /**/
      863     2429             %FPT_WRITE     (FPTN=WRITE_ENTRY,
      864     2430                                 BUF=OCL_HIST_BUF,
      865     2431                                 BP=NO,
      866     2432                                 DCB=F$HISTFILE,
      867     2433                                 KEY=OCL_NORM_KEY,
      868     2434                                 NEWKEY=YES,
      869     2435                                 ONEWKEY=NO,
      870     2436                                 WAIT=YES);
      871     2467                                                /**/
      872     2468    1   DCL I SBIN WORD ALIGNED STATIC;
      873     2469                                                /**/
      874     2470    1   DCL OCL$WRITE_CONSOLE_REC ENTRY(5);
      875     2471    1   DCL OCL$HOFF ENTRY(1);
      876     2472                                                /**/
      877     2473    1   DCL F$HISTFILE DCB;
      878     2474                                                /**/
      879     2475        %EJECT;
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:136  
      880     2476                                                /**/
      881     2477        /*
      882     2478             Begin   O C L $ L I S T I T    main
      883     2479                                                          */
      884     2480                                                /**/
      885     2481    1        IF ~OC_LIST

   2481  3 000002   000000 236000 xsym               LDQ     OC_LIST
         3 000003   400000 376003                    ANQ     -131072,DU
         3 000004   400000 676003                    ERQ     -131072,DU
         3 000005   000007 600000 3                  TZE     s:2485

      886     2482    1        THEN
      887     2483    1             RETURN;

   2483  3 000006   000000 702200 xent               TSX2  ! X66_ARET

      888     2484                                                /**/
      889     2485    1        IF MSG# ~= 1024 /* LGST_MSG# */

   2485  3 000007   200005 470500                    LDP0    @MSG#,,AUTO
         3 000010   000100 101500                    MRL     fill='000'O
         3 000011   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 000012   200014 000004                    ADSC9   @WSN_TEXT+1,,AUTO        cn=0,n=4
         3 000013   200014 236100                    LDQ     @WSN_TEXT+1,,AUTO
         3 000014   002000 116007                    CMPQ    1024,DL
         3 000015   000040 600000 3                  TZE     s:2495

      890     2486    1        THEN
      891     2487    2        DO;

      892     2488    3             DO I = 0 TO 9 /* OCL_NUM# */;

   2488  3 000016   000030 450000 1                  STZ     I

      893     2489    3                  IF MSG# = OCL_BADMSG (I)

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:137  
   2489  3 000017   000030 235000 1                  LDA     I
         3 000020   000001 735000                    ALS     1
         3 000021   000100 101405                    MRL     fill='000'O
         3 000022   000000 000002 xsym               ADSC9   OCL_BADMSG,A             cn=0,n=2
         3 000023   200014 000004                    ADSC9   @WSN_TEXT+1,,AUTO        cn=0,n=4
         3 000024   200005 470500                    LDP0    @MSG#,,AUTO
         3 000025   000100 101500                    MRL     fill='000'O
         3 000026   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 000027   200015 000004                    ADSC9   @WSN_TEXT+2,,AUTO        cn=0,n=4
         3 000030   200015 236100                    LDQ     @WSN_TEXT+2,,AUTO
         3 000031   200014 116100                    CMPQ    @WSN_TEXT+1,,AUTO
         3 000032   000034 601000 3                  TNZ     s:2492

      894     2490    3                  THEN
      895     2491    3                       RETURN;

   2491  3 000033   000000 702200 xent               TSX2  ! X66_ARET

      896     2492    3                END;                       /* DO I */

   2492  3 000034   000030 054000 1                  AOS     I
         3 000035   000030 235000 1                  LDA     I
         3 000036   000011 115007                    CMPA    9,DL
         3 000037   000017 604400 3                  TMOZ    s:2489

      897     2493    2           END;                            /* DO IF MSG# IS CHECKABLE */

      898     2494                                                /**/
      899     2495    1        IF MODE_  ~= 0 /* OCI_OUTPUT# */           /* IS THIS A MESSAGAGE */

   2495  3 000040   200004 471500                    LDP1    @MODE_,,AUTO
         3 000041   000100 100500                    MLR     fill='000'O
         3 000042   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         3 000043   200014 000004                    ADSC9   @WSN_TEXT+1,,AUTO        cn=0,n=4
         3 000044   200014 236100                    LDQ     @WSN_TEXT+1,,AUTO
         3 000045   000000 116003                    CMPQ    0,DU
         3 000046   000052 600000 3                  TZE     s:2499
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:138  

      900     2496    1        THEN
      901     2497    1             OCL_HIST_BUF.TYPE = 2;

   2497  3 000047   000002 236007                    LDQ     2,DL
         3 000050   000012 552004 xsym               STBQ    OCL_HIST_BUF+10,'04'O
         3 000051   000071 710000 3                  TRA     s:2508

      902     2498    1        ELSE
      903     2499    1             IF CADDR & OC_DIR             /* DIRECT ADDRESS */

   2499  3 000052   000000 236000 xsym               LDQ     OC_DIR
         3 000053   777777 376003                    ANQ     -1,DU
         3 000054   200014 756100                    STQ     @WSN_TEXT+1,,AUTO
         3 000055   200003 473500                    LDP3    @CADDR,,AUTO
         3 000056   000100 100500                    MLR     fill='000'O
         3 000057   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         3 000060   200015 000004                    ADSC9   @WSN_TEXT+2,,AUTO        cn=0,n=4
         3 000061   200015 236100                    LDQ     @WSN_TEXT+2,,AUTO
         3 000062   200014 376100                    ANQ     @WSN_TEXT+1,,AUTO
         3 000063   000067 600000 3                  TZE     s:2503

      904     2500    1             THEN
      905     2501    1                  OCL_HIST_BUF.TYPE = 1;

   2501  3 000064   000001 236007                    LDQ     1,DL
         3 000065   000012 552004 xsym               STBQ    OCL_HIST_BUF+10,'04'O
         3 000066   000071 710000 3                  TRA     s:2508

      906     2502    1             ELSE
      907     2503    1                  OCL_HIST_BUF.TYPE = 0;   /* MUST BE ATTR WRITE */

   2503  3 000067   000000 236003                    LDQ     0,DU
         3 000070   000012 552004 xsym               STBQ    OCL_HIST_BUF+10,'04'O

      908     2504                                                /**/
      909     2505                                                /**/
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:139  
      910     2506                                           /* If MSG# has no template,
      911     2507                                                indicate so by flag TEMPLATE */
      912     2508    1        IF MODE_ = 0 /* OCI_OUTPUT# */

   2508  3 000071   000100 100500                    MLR     fill='000'O
         3 000072   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         3 000073   200014 000004                    ADSC9   @WSN_TEXT+1,,AUTO        cn=0,n=4
         3 000074   200014 236100                    LDQ     @WSN_TEXT+1,,AUTO
         3 000075   000000 116003                    CMPQ    0,DU
         3 000076   000110 601000 3                  TNZ     s:2513
         3 000077   000100 101500                    MRL     fill='000'O
         3 000100   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 000101   200015 000004                    ADSC9   @WSN_TEXT+2,,AUTO        cn=0,n=4
         3 000102   200015 236100                    LDQ     @WSN_TEXT+2,,AUTO
         3 000103   002000 116007                    CMPQ    1024,DL
         3 000104   000110 601000 3                  TNZ     s:2513

      913     2509    1             AND MSG# = 1024 /* LGST_MSG# */
      914     2510    1        THEN
      915     2511    1             OCL_HIST_BUF.TEMPLATE = '1'B;

   2511  3 000105   400000 236007                    LDQ     -131072,DL
         3 000106   000012 256000 xsym               ORSQ    OCL_HIST_BUF+10
         3 000107   000112 710000 3                  TRA     s:2517

      916     2512    1        ELSE
      917     2513    1             OCL_HIST_BUF.TEMPLATE = '0'B;

   2513  3 000110   000000 236000 4                  LDQ     0
         3 000111   000012 356000 xsym               ANSQ    OCL_HIST_BUF+10

      918     2514                                                /**/
      919     2515                                                /**/
      920     2516                                                /**/
      921     2517    1        IF INDEX_  ~=  OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */   /* HAVE A GOOD INDEX */

   2517  3 000112   200007 473500                    LDP3    @INDEX_,,AUTO
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:140  
         3 000113   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         3 000114   000022 772000                    QRL     18
         3 000115   000001 036007                    ADLQ    1,DL
         3 000116   300000 116100                    CMPQ    0,,PR3
         3 000117   000170 600000 3                  TZE     s:2531

      922     2518    1        THEN
      923     2519    2        DO;

      924     2520    2             OCL_HIST_BUF.LOGON = OC_CONSOLE.LOGON (INDEX_);

   2520  3 000120   300000 236100                    LDQ     0,,PR3
         3 000121   000076 402007                    MPY     62,DL
         3 000122   000002 736000                    QLS     2
         3 000123   000000 474400 xsym               LDP4    OC_CONSOLE$
         3 000124   040000 100506                    MLR     fill='040'O
         3 000125   400006 000010                    ADSC9   6,Q,PR4                  cn=0,n=8
         3 000126   000003 000010 xsym               ADSC9   OCL_HIST_BUF+3           cn=0,n=8

      925     2521    2             OCL_HIST_BUF.DEVNM = OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);

   2521  3 000127   300000 236100                    LDQ     0,,PR3
         3 000130   000076 402007                    MPY     62,DL
         3 000131   400000 236106                    LDQ     0,QL,PR4
         3 000132   000005 756000 xsym               STQ     OCL_HIST_BUF+5

      926     2522    2             OCL_HIST_BUF.STATION = OC_CONSOLE.STATIONR(INDEX_);

   2522  3 000133   300000 236100                    LDQ     0,,PR3
         3 000134   000076 402007                    MPY     62,DL
         3 000135   000002 736000                    QLS     2
         3 000136   000000 100506                    MLR     fill='000'O
         3 000137   400000 000010                    ADSC9   0,Q,PR4                  cn=0,n=8
         3 000140   000006 000010 xsym               ADSC9   OCL_HIST_BUF+6           cn=0,n=8

      927     2523    2             OCL_HIST_BUF.TERMINAL = OC_CONSOLE.TERM_NAME(INDEX_);

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:141  
   2523  3 000141   300000 236100                    LDQ     0,,PR3
         3 000142   000076 402007                    MPY     62,DL
         3 000143   000002 736000                    QLS     2
         3 000144   040000 100506                    MLR     fill='040'O
         3 000145   400002 000010                    ADSC9   2,Q,PR4                  cn=0,n=8
         3 000146   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8

      928     2524    2             OCL_HIST_BUF.WSN = OC_CONSOLE.WSN(INDEX_);

   2524  3 000147   300000 236100                    LDQ     0,,PR3
         3 000150   000076 402007                    MPY     62,DL
         3 000151   000002 736000                    QLS     2
         3 000152   040000 100506                    MLR     fill='040'O
         3 000153   400004 000010                    ADSC9   4,Q,PR4                  cn=0,n=8
         3 000154   000001 000010 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=8

      929     2525    2             IF MODE_ = 0 /* OCI_OUTPUT# */

   2525  3 000155   000100 100500                    MLR     fill='000'O
         3 000156   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         3 000157   200014 000004                    ADSC9   @WSN_TEXT+1,,AUTO        cn=0,n=4
         3 000160   200014 236100                    LDQ     @WSN_TEXT+1,,AUTO
         3 000161   000000 116003                    CMPQ    0,DU
         3 000162   000216 601000 3                  TNZ     s:2540

      930     2526    2             THEN
      931     2527    2                  OCL_HIST_BUF.ATTR = OC_CONSOLE.ATTR_OUTPUT(INDEX_); /* USE OUTPUT */

   2527  3 000163   300000 236100                    LDQ     0,,PR3
         3 000164   000076 402007                    MPY     62,DL
         3 000165   400014 220106                    LDX0    12,QL,PR4
         3 000166   000012 740000 xsym               STX0    OCL_HIST_BUF+10

      932     2528    2           END;                            /* END IF VALID INDEX */

   2528  3 000167   000216 710000 3                  TRA     s:2540

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:142  
      933     2529    1        ELSE
      934     2530    2        DO;

      935     2531    2             OCL_HIST_BUF.LOGON = ' ';

   2531  3 000170   000035 235000 xsym               LDA     B_VECTNIL+29
         3 000171   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000172   000003 755000 xsym               STA     OCL_HIST_BUF+3
         3 000173   000004 756000 xsym               STQ     OCL_HIST_BUF+4

      936     2532    2             OCL_HIST_BUF.DEVNM = ' ';

   2532  3 000174   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000175   000005 756000 xsym               STQ     OCL_HIST_BUF+5

      937     2533    2             OCL_HIST_BUF.STAT = WSNDV;

   2533  3 000176   200006 474500                    LDP4    @WSNDV,,AUTO
         3 000177   040000 100500                    MLR     fill='040'O
         3 000200   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         3 000201   000006 000010 xsym               ADSC9   OCL_HIST_BUF+6           cn=0,n=8

      938     2534    2             OCL_HIST_BUF.TERMINAL = TERM_TEXT;

   2534  3 000202   200012 475500                    LDP5    @TERM_TEXT,,AUTO
         3 000203   040000 100500                    MLR     fill='040'O
         3 000204   500000 000010                    ADSC9   0,,PR5                   cn=0,n=8
         3 000205   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8

      939     2535    2             OCL_HIST_BUF.WSN = WSN_TEXT;

   2535  3 000206   200013 476500                    LDP6    @WSN_TEXT,,AUTO
         3 000207   040000 100500                    MLR     fill='040'O
         3 000210   600000 000010                    ADSC9   0,,PR6                   cn=0,n=8
         3 000211   000001 000010 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=8

      940     2536    2             OCL_HIST_BUF.ATTR = CADDR;    /* MUST BE ATTRIBUTE WRITE */
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:143  

   2536  3 000212   200003 477500                    LDP7    @CADDR,,AUTO
         3 000213   000000 100500                    MLR     fill='000'O
         3 000214   700000 000002                    ADSC9   0,,PR7                   cn=0,n=2
         3 000215   000012 000002 xsym               ADSC9   OCL_HIST_BUF+10          cn=0,n=2

      941     2537    2           END;

      942     2538                                                /**/
      943     2539                                                /**/
      944     2540    1        OCL_HIST_BUF.TSTAMP = OCM_TSTAMP;

   2540  3 000216   000000 235000 xsym               LDA     OCM_TSTAMP
         3 000217   000000 755000 xsym               STA     OCL_HIST_BUF

      945     2541    1        OCL_HIST_BUF.PROMPT_LENGTH = OCM_PROMPT.SIZE;

   2541  3 000220   000000 236000 xsym               LDQ     OCM_PROMPT
         3 000221   000013 552040 xsym               STBQ    OCL_HIST_BUF+11,'40'O

      946     2542
      947     2543    1        CALL CONCAT(OCL_HIST_BUF.MESS,SUBSTR(OCM_PROMPT.TEXT,0,OCM_PROMPT.SIZE),

   2543  3 000222   000000 236000 xsym               LDQ     OCM_PROMPT
         3 000223   000033 772000                    QRL     27
         3 000224   200010 474500                    LDP4    @SIZE_,,AUTO
         3 000225   000100 101500                    MRL     fill='000'O
         3 000226   400000 000004                    ADSC9   0,,PR4                   cn=0,n=4
         3 000227   200014 000002                    ADSC9   @WSN_TEXT+1,,AUTO        cn=0,n=2
         3 000230   200014 220100                    LDX0    @WSN_TEXT+1,,AUTO
         3 000231   000000 621006                    EAX1    0,QL
         3 000232   040000 100440                    MLR     fill='040'O
         3 000233   000000 200011 xsym               ADSC9   OCM_PROMPT               cn=1,n=*X1
         3 000234   000013 200377 xsym               ADSC9   OCL_HIST_BUF+11          cn=1,n=255
         3 000235   000377 116007                    CMPQ    255,DL
         3 000236   000245 603000 3                  TRC     s:2547
         3 000237   777400 621006                    EAX1    -256,QL
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:144  
         3 000240   777777 661003                    ERX1    -1,DU
         3 000241   200011 475500                    LDP5    @TEXT,,AUTO
         3 000242   040046 100540                    MLR     fill='040'O
         3 000243   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         3 000244   000013 200011 xsym               ADSC9   OCL_HIST_BUF+11,Q        cn=1,n=*X1

      948     2544    1             TEXT);
      949     2545                                                /**/
      950     2546                                                /**/
      951     2547    1        IF OCL_WRITE_CONSOLE_RECS = '1'B

   2547  3 000245   000000 234000 xsym               SZN     OCL_WRITE_CONSOLE_RECS
         3 000246   000261 605000 3                  TPL     WHAT_THE_90

      952     2548    1        THEN
      953     2549    2        DO;

      954     2550    2             OCL_WRITE_CONSOLE_RECS = '0'B;

   2550  3 000247   000000 450000 xsym               STZ     OCL_WRITE_CONSOLE_RECS

      955     2551    2             CALL OCL$WRITE_CONSOLE_REC (, , 0 /* ALL_CONSOLES# */, 1
              2551                      /* CONSOLE_UPD# */,);

   2551  3 000250   000002 237000 4                  LDAQ    2
         3 000251   200016 757100                    STAQ    @WSN_TEXT+3,,AUTO
         3 000252   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000253   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000254   200014 757100                    STAQ    @WSN_TEXT+1,,AUTO
         3 000255   200014 630500                    EPPR0   @WSN_TEXT+1,,AUTO
         3 000256   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000257   000000 701000 xent               TSX1    OCL$WRITE_CONSOLE_REC
         3 000260   000000 011000                    NOP     0

      956     2552    2           END;

   2547  3 000261                       WHAT_THE_90  null
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:145  
      957     2553                                                /**/
      958     2554                                                /**/
      959     2555    1   WHAT_THE_90: ;
      960     2556    1        CALL M$TIME(GET_KEY) ALTRET(BAD_HIST);

   2556  3 000261   000000 630400 1                  EPPR0   GET_KEY
         3 000262   420004 713400                    CLIMB   alt,+8196
         3 000263   402000 401760                    pmme    nvectors=5
         3 000264   000306 702000 3                  TSX2    BAD_HIST

      961     2557    1        WRITE_ENTRY.BUF_.BOUND = SIZEC(OCL_HIST_BUF) - SIZEC(OCL_HIST_BUF.MESS)

   2557  3 000265   200010 470500                    LDP0    @SIZE_,,AUTO
         3 000266   000100 100500                    MLR     fill='000'O
         3 000267   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         3 000270   200014 000004                    ADSC9   @WSN_TEXT+1,,AUTO        cn=0,n=4
         3 000271   000000 236000 xsym               LDQ     OCM_PROMPT
         3 000272   000033 772000                    QRL     27
         3 000273   200014 036100                    ADLQ    @WSN_TEXT+1,,AUTO
         3 000274   000054 036007                    ADLQ    44,DL
         3 000275   000020 736000                    QLS     16
         3 000276   000020 676000 1                  ERQ     WRITE_ENTRY+4
         3 000277   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000300   000020 656000 1                  ERSQ    WRITE_ENTRY+4

      962     2558    1             + OCM_PROMPT.SIZE + SIZE_ - 1;
      963     2559    1        CALL M$WRITE(WRITE_ENTRY) ALTRET(BAD_HIST);

   2559  3 000301   000014 630400 1                  EPPR0   WRITE_ENTRY
         3 000302   440001 713400                    CLIMB   alt,write
         3 000303   401400 401760                    pmme    nvectors=4
         3 000304   000306 702000 3                  TSX2    BAD_HIST

      964     2560    1        RETURN;

   2560  3 000305   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:146  
   2557  3 000306                       BAD_HIST     null
      965     2561                                                /**/
      966     2562    1   BAD_HIST:;
      967     2563    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$OLDREC

   2563  3 000306   000000 470400 xsym               LDP0    B$TCB$
         3 000307   000000 471500                    LDP1    0,,PR0
         3 000310   100102 236100                    LDQ     66,,PR1
         3 000311   377770 376007                    ANQ     131064,DL
         3 000312   000750 116007                    CMPQ    488,DL
         3 000313   000261 600000 3                  TZE     WHAT_THE_90

      968     2564    1        THEN
      969     2565    1             GOTO WHAT_THE_90;
      970     2566    1        CALL OCL$HOFF('200000'O /* M_SYS  */);          /* Turn off history logging */

   2566  3 000314   000004 630400 4                  EPPR0   4
         3 000315   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000316   000000 701000 xent               TSX1    OCL$HOFF
         3 000317   000000 011000                    NOP     0

      971     2567    1        RETURN;

   2567  3 000320   000000 702200 xent               TSX2  ! X66_ARET
      972     2568    1   END OCL$LISTIT;
      973     2569        %EOD;

PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:147  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$LISTIT.
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:148  

 **** Variables and constants ****

  ****  Section 001  Data  OCL$LISTIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 GET_KEY                   30-0-0/w SBIN        r     1 I
    14-0-0/d STRC(432)   r     1 WRITE_ENTRY

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CADDR                     7-0-0/w PTR         r     1 @INDEX_
     4-0-0/w PTR         r     1 @MODE_                     5-0-0/w PTR         r     1 @MSG#
    10-0-0/w PTR         r     1 @SIZE_                    12-0-0/w PTR         r     1 @TERM_TEXT
    11-0-0/w PTR         r     1 @TEXT                      6-0-0/w PTR         r     1 @WSNDV
    13-0-0/w PTR         r     1 @WSN_TEXT                 *0-0-0/c BIT (18)    r     1 CADDR
    *0-0-0/w UBIN        r     1 INDEX_                    *0-0-0/c UBIN        r     1 MODE_
    *0-0-0/c UBIN(18)    r     1 MSG#                      *0-0-0/c UBIN        r     1 SIZE_
    *0-0-0/c CHAR(8)     r     1 TERM_TEXT                 *0-0-0/c ACHR        r     1 TEXT
    *0-0-0/c CHAR(8)     r     1 WSNDV                     *0-0-0/c CHAR(8)     r     1 WSN_TEXT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/b UBIN(18)    r     1 OCL_BADMSG(0:8191)
     0-0-0/w STRC(2700)  r     1 OCL_HIST_BUF               0-0-0/b STRC(45)    r     1 OCL_NORM_KEY
     0-0-0/w BIT         r     1 OCL_WRITE_CONSOLE_RECS
     0-0-0/c STRC(288)   r     1 OCM_PROMPT                 0-0-0/w UBIN        r     1 OCM_TSTAMP
     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/w BIT (18)    r     1 OC_DIR
     0-0-0/w BIT         r     1 OC_LIST                    0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:149  

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 F$HISTFILE
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCL$LISTIT requires 209 words for executable code.
   Procedure OCL$LISTIT requires 16 words of local(AUTO) storage.
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:150  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:151  
          MINI XREF LISTING

B$ALT.CODE
      2238**DCL      2238--REDEF    2239--REDEF    2239--REDEF
B$ALT.ERR.CODE
      2240**DCL      2563>>IF
B$ALT.ERR.ERR#
      2240**DCL      2240--REDEF
B$ALT.EVID
      2239**DCL      2239--REDEF    2239--REDEF
B$TCB.ALT$
      2234**DCL      2563>>IF
B$TCB$
      2232**DCL      2563>>IF
BAD_HIST
      2557**LABEL    2556--CALLALT  2559--CALLALT
CADDR
        22**DCL        20--PROC     2499>>IF       2536>>ASSIGN
GET_KEY
      2420**DCL      2556<>CALL
GET_KEY.V
      2424**DCL      2420--DCLINIT
I
      2468**DCL      2488<<DOINDEX  2489>>IF
INDEX_
        26**DCL        20--PROC     2517>>IF       2520>>ASSIGN   2521>>ASSIGN   2522>>ASSIGN   2523>>ASSIGN
      2524>>ASSIGN   2527>>ASSIGN
M$TIME
      1100**DCL-ENT  2556--CALL
M$WRITE
      1034**DCL-ENT  2559--CALL
MODE_
        23**DCL        20--PROC     2495>>IF       2508>>IF       2525>>IF
MSG#
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:152  
        24**DCL        20--PROC     2485>>IF       2489>>IF       2508>>IF
OCL$HOFF
      2471**DCL-ENT  2566--CALL
OCL$WRITE_CONSOLE_REC
      2470**DCL-ENT  2551--CALL
OCL_BADMSG
      1014**DCL      2489>>IF
OCL_HIST_BUF
      1016**DCL      2454--DCLINIT  2455--DCLINIT  2557--ASSIGN
OCL_HIST_BUF.ATTR
      1017**DCL      2527<<ASSIGN   2536<<ASSIGN
OCL_HIST_BUF.DEVNM
      1016**DCL      2521<<ASSIGN   2532<<ASSIGN
OCL_HIST_BUF.LOGON
      1016**DCL      2520<<ASSIGN   2531<<ASSIGN
OCL_HIST_BUF.MESS
      1018**DCL      2543<<CALLBLT  2557--ASSIGN
OCL_HIST_BUF.PROMPT_LENGTH
      1018**DCL      2541<<ASSIGN
OCL_HIST_BUF.STAT
      1016**DCL      1017--REDEF    2533<<ASSIGN
OCL_HIST_BUF.STATION
      1017**DCL      2522<<ASSIGN
OCL_HIST_BUF.TEMPLATE
      1018**DCL      2511<<ASSIGN   2513<<ASSIGN
OCL_HIST_BUF.TERMINAL
      1017**DCL      2523<<ASSIGN   2534<<ASSIGN
OCL_HIST_BUF.TSTAMP
      1016**DCL      2540<<ASSIGN
OCL_HIST_BUF.TYPE
      1018**DCL      2497<<ASSIGN   2501<<ASSIGN   2503<<ASSIGN
OCL_HIST_BUF.WSN
      1016**DCL      2524<<ASSIGN   2535<<ASSIGN
OCL_MSGB.ERR
      1014**DCL      1015--REDEF
OCL_NORM_KEY
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:153  
      1015**DCL      2453--DCLINIT
OCL_NORM_KEY.UTS
      1015**DCL      2424--DCLINIT
OCL_WRITE_CONSOLE_RECS
      1022**DCL      2547>>IF       2550<<ASSIGN
OCM_PROMPT.SIZE
       995**DCL      2541>>ASSIGN   2543>>CALLBLT  2557>>ASSIGN
OCM_PROMPT.TEXT
       995**DCL      2543>>CALLBLT
OCM_TSTAMP
       995**DCL      2540>>ASSIGN
OC_CONSOLE.ATTR
      2358**DCL      2358--REDEF
OC_CONSOLE.ATTRO
      2359**DCL      2359--REDEF
OC_CONSOLE.ATTR_OUTPUT
      2359**DCL      2527>>ASSIGN
OC_CONSOLE.CID
      2357**DCL      2358--REDEF
OC_CONSOLE.LOGON
      2357**DCL      2520>>ASSIGN
OC_CONSOLE.STATION
      2356**DCL      2356--REDEF
OC_CONSOLE.STATIONR
      2356**DCL      2522>>ASSIGN
OC_CONSOLE.STATIONR.FIRST_HALF
      2356**DCL      2521>>ASSIGN
OC_CONSOLE.TERM_NAME
      2357**DCL      2523>>ASSIGN
OC_CONSOLE.WSN
      2357**DCL      2524>>ASSIGN
OC_CONSOLE$
      2355**DCL      2356--IMP-PTR  2520>>ASSIGN   2521>>ASSIGN   2522>>ASSIGN   2523>>ASSIGN   2524>>ASSIGN
      2527>>ASSIGN
OC_DIR
      2398**DCL      2398--REDEF    2499>>IF
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:154  
OC_INTBIT
      2398**DCL      2399--REDEF
OC_INTMSG
      2275**DCL      2288--REDEF
OC_INTMSG.FLAGS
      2282**DCL      2283--REDEF
OC_INTMSG.MESS
      2288**DCL      2288--REDEF
OC_INTMSG.MSGID
      2278**DCL      2279--REDEF
OC_INTMSG.WSN
      2285**DCL      2286--REDEF
OC_LIST
      2401**DCL      2481>>IF
OC_MASK
      2399**DCL      2399--REDEF
OC_MAXCONSOLE
      2355**DCL      2517>>IF
OC_MESSBUF
      2290**DCL      2305--REDEF    2319--REDEF
OC_MESSBUF.FLAGS
      2297**DCL      2298--REDEF
OC_MESSBUF.MESS
      2303**DCL      2303--REDEF
OC_MESSBUF.MSGID
      2293**DCL      2294--REDEF
OC_MESSBUF.WSN
      2300**DCL      2301--REDEF
OC_MESSBUF1.FLAGS
      2312**DCL      2313--REDEF
OC_MESSBUF1.LEN
      2318**DCL      2318--REDEF
OC_MESSBUF1.MSGID
      2308**DCL      2309--REDEF
OC_MESSBUF1.WSN
      2315**DCL      2316--REDEF
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:155  
OC_MSGBUFFER
      2321**DCL      2336--REDEF
OC_MSGBUFFER.FLAGS
      2328**DCL      2329--REDEF
OC_MSGBUFFER.MESS
      2334**DCL      2334--REDEF
OC_MSGBUFFER.MSGID
      2324**DCL      2325--REDEF
OC_MSGBUFFER.WSN
      2331**DCL      2332--REDEF
OC_MSGBUFFER2.FLAGS
      2343**DCL      2344--REDEF
OC_MSGBUFFER2.MSGID
      2339**DCL      2340--REDEF
OC_MSGBUFFER2.WSN
      2346**DCL      2347--REDEF
OC_PARAM
      2354**DCL      2354--REDEF
OC_QUEUE.PARMC
      2353**DCL      2353--REDEF
SIZE_
        27**DCL        20--PROC       28--IMP-SIZ  2543>>CALLBLT  2557>>ASSIGN
TERM_TEXT
        29**DCL        20--PROC     2534>>ASSIGN
TEXT
        28**DCL        20--PROC     2543>>CALLBLT
WHAT_THE_90
      2547**LABEL    2565--GOTO
WRITE_ENTRY
      2453**DCL      2559<>CALL
WRITE_ENTRY.BUF_.BOUND
      2453**DCL      2557<<ASSIGN
WRITE_ENTRY.STATION_
      2455**DCL      2455--REDEF
WRITE_ENTRY.V
      2456**DCL      2453--DCLINIT
PL6.E3A0      #003=OCL$LISTIT File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:01 Page:156  
WRITE_ENTRY.V.DVBYTE.VFC#
      2462**DCL      2462--REDEF
WSNDV
        25**DCL        20--PROC     2533>>ASSIGN
WSN_TEXT
        30**DCL        20--PROC     2535>>ASSIGN

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:157  
      974        1        /*M* OCL$STATUS KEYINs routine to update the status record for
      975        2             the history file */
      976        3        /*T***********************************************************/
      977        4        /*T*                                                         */
      978        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      979        6        /*T*                                                         */
      980        7        /*T***********************************************************/
      981        8        %SET LISTSUB='1'B;
      982        9        %EJECT;
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:158  
      983       10        OCL$STATUS: PROC(UPDATE_IND);
      984       11                                                /* */
      985       12    1   DCL UPDATE_IND SBIN WORD;
      986       13        %INCLUDE OCI_SUBS_C;
      987      111        %INCLUDE OC_SUBS_C;
      988      842                                                /**/
      989      843        %INCLUDE CP_6;
      990      924        %INCLUDE OC_DAT_R;
      991     1085        %INCLUDE B$JIT;
      992     1375    1   DCL B$JIT$ PTR SYMREF;
      993     1376                                                /**/
      994     1377    1   DCL B$TCB$ PTR SYMREF;
      995     1378             %B$TCB;
      996     1381             %B$ALT;
      997     1389                                                /**/
      998     1390        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
      999     1391                                                /**/
     1000     1392                                                /**/
     1001     1393        %INCLUDE B_ERRORS_C;
     1002     2520                                                /**/
     1003     2521                                                /**/
     1004     2522    1   DCL F$HISTFILE DCB;
     1005     2523                                                /**/
     1006     2524    1   DCL OCO$IWRITE ENTRY(8);
     1007     2525    1   DCL MSG# UBIN HALF UNAL STATIC INIT (372 /*TURNO_MSG#*/);
     1008     2526    1   DCL NP# UBIN BYTE UNAL STATIC INIT(4);
     1009     2527                                                /**/
     1010     2528        %INCLUDE OCL_DATA_R;
     1011     2553                                                /**/
     1012     2554                                                /**/
     1013     2555                  %VLP_NAME (FPTN=OCHIST,
     1014     2556                                 NAME=':OCHIST');
     1015     2583                                                /**/
     1016     2584                  %VLP_ACCT (FPTN=SYS,
     1017     2585                                 ACCT=':SYSTAC');
     1018     2598                                                /**/
     1019     2599             %FPT_OPEN      (FPTN=OPEN_HISTORYU,
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:159  
     1020     2600                                 NAME=OCHIST,
     1021     2601                                 ACCT=SYS,
     1022     2602                                 ASN=FILE,
     1023     2603                                 ACS=DIRECT,
     1024     2604                                 DCB=F$HISTFILE,
     1025     2605                                 DISP=NAMED,
     1026     2606                                 CTG=YES,
     1027     2607                                 FUN=UPDATE,
     1028     2608                            SHARE=NONE,
     1029     2609                                 ORG=KEYED);
     1030     2718             %FPT_READ      (FPTN=READ_STAT,
     1031     2719                                 BUF=OCL_STATUS_REC,
     1032     2720                                 DCB=F$HISTFILE,
     1033     2721                                 KEY=OCL_STATUS_KEY,
     1034     2722                                 KEYS=YES,
     1035     2723                                 WAIT=YES);
     1036     2762                                                /**/
     1037     2763             %FPT_WRITE     (FPTN=WRITE_STATUS,
     1038     2764                            BUF=OCL_STATUS_REC,
     1039     2765                                 DCB=F$HISTFILE,
     1040     2766                                 KEY=OCL_STATUS_KEY,
     1041     2767                                 WAIT=YES);
     1042     2798                                                /**/
     1043     2799             %FPT_CLOSE     (FPTN=CLOSE_SAVE,
     1044     2800                                 DCB=F$HISTFILE);
     1045     2842                                                /**/
     1046     2843             %FPT_PRIV      (FPTN=RESET_FMSEC,
     1047     2844                                 PRIV=%PR_FMSEC#);
     1048     2859    1   DCL LEN(0:3) UBIN BYTE STATIC UNAL INIT(1,1,1,1);
     1049     2860    1   DCL 1 PARM,
     1050     2861    1            2 TYPE UBIN BYTE UNAL,
     1051     2862    1            2 ACTION UBIN BYTE UNAL,
     1052     2863    1            2 HOUR UBIN BYTE UNAL,
     1053     2864    1            2 MIN UBIN BYTE UNAL;
     1054     2865        %EJECT;
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:160  
     1055     2866        /*
     1056     2867                  Begin   O C L $ S T A T U S   Main
     1057     2868                                                                          */
     1058     2869
     1059     2870    1        IF ~OC_LIST
     1060     2871    1        THEN
     1061     2872    2        DO;
     1062     2873    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON1);
     1063     2874    2   PRESS_ON1:;
     1064     2875    2             CALL M$OPEN (OPEN_HISTORYU) ALTRET(NO_CAN_DO);
     1065     2876    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON2);
     1066     2877    2   PRESS_ON2:;
     1067     2878    2           END;
     1068     2879                                                /**/
     1069     2880                                                /**/
     1070     2881                                                /* SAVE TURNOVER INFORMATION */
     1071     2882    1        CALL M$READ (READ_STAT) ALTRET (TOO_BAD);
     1072     2883    1   TOO_BAD:;
     1073     2884    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;
     1074     2885    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;
     1075     2886    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;
     1076     2887    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;
     1077     2888    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;
     1078     2889    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;
     1079     2890    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;
     1080     2891    1        OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;
     1081     2892                                                /**/
     1082     2893    1        CALL M$WRITE (WRITE_STATUS) ALTRET (NO_CAN_DO);
     1083     2894                                                /**/
     1084     2895    1        IF ~OC_LIST
     1085     2896    1        THEN
     1086     2897    1             CALL M$CLOSE(CLOSE_SAVE) ALTRET(OOPS);
     1087     2898    1   OOPS: ;
     1088     2899    1        PARM.TYPE = 1;
     1089     2900    1        IF UPDATE_IND = 0 /* OCN_UPDAT_BOTH# */
     1090     2901    1             OR
     1091     2902    1             UPDATE_IND = 2 /* OCN_UPDAT_HIST# */
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:161  
     1092     2903    1        THEN
     1093     2904    2        DO;
     1094     2905    2             IF OC_HIST_SAVE.ACTIVE
     1095     2906    2             THEN
     1096     2907    3             DO;
     1097     2908    3                  PARM.HOUR = OC_HIST_SAVE.HOUR;
     1098     2909    3                  PARM.MIN = OC_HIST_SAVE.MIN;
     1099     2910    3                  PARM.ACTION = 1;
     1100     2911    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);
     1101     2912    3                END;
     1102     2913    2             ELSE
     1103     2914    3             DO;
     1104     2915    3                  PARM.ACTION = 0;
     1105     2916    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);
     1106     2917    3                END;
     1107     2918    2           END;
     1108     2919    1        IF UPDATE_IND = 0 /* OCN_UPDAT_BOTH# */
     1109     2920    1             OR
     1110     2921    1             UPDATE_IND = 1 /* OCN_UPDAT_ACCT# */
     1111     2922    1        THEN
     1112     2923    2        DO;
     1113     2924    2             PARM.TYPE = 0;
     1114     2925    2             IF OC_ACCT_SAVE.ACTIVE
     1115     2926    2             THEN
     1116     2927    3             DO;
     1117     2928    3                  PARM.ACTION = 1;
     1118     2929    3                  PARM.HOUR = OC_ACCT_SAVE.HOUR;
     1119     2930    3                  PARM.MIN = OC_ACCT_SAVE.MIN;
     1120     2931    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);
     1121     2932    3                END;
     1122     2933    2             ELSE
     1123     2934    3             DO;
     1124     2935    3                  PARM.ACTION=0;
     1125     2936    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);
     1126     2937    3                END;
     1127     2938    2           END;
     1128     2939        %EJECT;
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:162  
     1129     2940                                                /**/
     1130     2941                                                /**/
     1131     2942    1   NO_CAN_DO: ;
     1132     2943                                                /**/
     1133     2944    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON3);
     1134     2945    1   PRESS_ON3:;
     1135     2946    1        RETURN;
     1136     2947    1   END OCL$STATUS;

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:163  
--  Include file information  --

   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$STATUS.

   Procedure OCL$STATUS requires 149 words for executable code.
   Procedure OCL$STATUS requires 12 words of local(AUTO) storage.

    No errors detected in file OCL$LISTER.:E05TSI    .

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:164  

 Object Unit name= OCL$STATUS                                 File name= OCL$LISTER.:E05TOU
 UTS= JUL 30 '97 04:02:18.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  F$HISTFILE
    2   Data  even  none   125    175  OCL$STATUS
    3   Proc  even  none   149    225  OCL$STATUS
    4  RoData even  none     6      6  OCL$STATUS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  OCL$STATUS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       8 OCO$IWRITE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:165  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     OC_LIST                               OC_HIST_SAVE                          OC_ACCT_SAVE
     B$JIT$                                F$HISTFILE                            OCL_STATUS_REC
     OCL_PREVIOUS_FILE                     OCL_STATUS_KEY                        OCL_CONSOLE_FIELD
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:166  


      974        1        /*M* OCL$STATUS KEYINs routine to update the status record for
      975        2             the history file */
      976        3        /*T***********************************************************/
      977        4        /*T*                                                         */
      978        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      979        6        /*T*                                                         */
      980        7        /*T***********************************************************/
      981        8        %SET LISTSUB='1'B;
      982        9        %EJECT;
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:167  
      983       10        OCL$STATUS: PROC(UPDATE_IND);

     10  3 000000   000000 700200 xent  OCL$STATUS   TSX0  ! X66_AUTO_1
         3 000001   000014 000001                    ZERO    12,1

      984       11                                                /* */
      985       12    1   DCL UPDATE_IND SBIN WORD;
      986       13        %INCLUDE OCI_SUBS_C;
      987      111        %INCLUDE OC_SUBS_C;
      988      842                                                /**/
      989      843        %INCLUDE CP_6;
      990      924        %INCLUDE OC_DAT_R;
      991     1085        %INCLUDE B$JIT;
      992     1375    1   DCL B$JIT$ PTR SYMREF;
      993     1376                                                /**/
      994     1377    1   DCL B$TCB$ PTR SYMREF;
      995     1378             %B$TCB;
      996     1381             %B$ALT;
      997     1389                                                /**/
      998     1390        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
      999     1391                                                /**/
     1000     1392                                                /**/
     1001     1393        %INCLUDE B_ERRORS_C;
     1002     2520                                                /**/
     1003     2521                                                /**/
     1004     2522    1   DCL F$HISTFILE DCB;
     1005     2523                                                /**/
     1006     2524    1   DCL OCO$IWRITE ENTRY(8);
     1007     2525    1   DCL MSG# UBIN HALF UNAL STATIC INIT (372 /*TURNO_MSG#*/);
     1008     2526    1   DCL NP# UBIN BYTE UNAL STATIC INIT(4);
     1009     2527                                                /**/
     1010     2528        %INCLUDE OCL_DATA_R;
     1011     2553                                                /**/
     1012     2554                                                /**/
     1013     2555                  %VLP_NAME (FPTN=OCHIST,
     1014     2556                                 NAME=':OCHIST');
     1015     2583                                                /**/
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:168  
     1016     2584                  %VLP_ACCT (FPTN=SYS,
     1017     2585                                 ACCT=':SYSTAC');
     1018     2598                                                /**/
     1019     2599             %FPT_OPEN      (FPTN=OPEN_HISTORYU,
     1020     2600                                 NAME=OCHIST,
     1021     2601                                 ACCT=SYS,
     1022     2602                                 ASN=FILE,
     1023     2603                                 ACS=DIRECT,
     1024     2604                                 DCB=F$HISTFILE,
     1025     2605                                 DISP=NAMED,
     1026     2606                                 CTG=YES,
     1027     2607                                 FUN=UPDATE,
     1028     2608                            SHARE=NONE,
     1029     2609                                 ORG=KEYED);
     1030     2718             %FPT_READ      (FPTN=READ_STAT,
     1031     2719                                 BUF=OCL_STATUS_REC,
     1032     2720                                 DCB=F$HISTFILE,
     1033     2721                                 KEY=OCL_STATUS_KEY,
     1034     2722                                 KEYS=YES,
     1035     2723                                 WAIT=YES);
     1036     2762                                                /**/
     1037     2763             %FPT_WRITE     (FPTN=WRITE_STATUS,
     1038     2764                            BUF=OCL_STATUS_REC,
     1039     2765                                 DCB=F$HISTFILE,
     1040     2766                                 KEY=OCL_STATUS_KEY,
     1041     2767                                 WAIT=YES);
     1042     2798                                                /**/
     1043     2799             %FPT_CLOSE     (FPTN=CLOSE_SAVE,
     1044     2800                                 DCB=F$HISTFILE);
     1045     2842                                                /**/
     1046     2843             %FPT_PRIV      (FPTN=RESET_FMSEC,
     1047     2844                                 PRIV=%PR_FMSEC#);
     1048     2859    1   DCL LEN(0:3) UBIN BYTE STATIC UNAL INIT(1,1,1,1);
     1049     2860    1   DCL 1 PARM,
     1050     2861    1            2 TYPE UBIN BYTE UNAL,
     1051     2862    1            2 ACTION UBIN BYTE UNAL,
     1052     2863    1            2 HOUR UBIN BYTE UNAL,
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:169  
     1053     2864    1            2 MIN UBIN BYTE UNAL;
     1054     2865        %EJECT;
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:170  
     1055     2866        /*
     1056     2867                  Begin   O C L $ S T A T U S   Main
     1057     2868                                                                          */
     1058     2869
     1059     2870    1        IF ~OC_LIST

   2870  3 000002   000000 236000 xsym               LDQ     OC_LIST
         3 000003   400000 376003                    ANQ     -131072,DU
         3 000004   400000 676003                    ERQ     -131072,DU
         3 000005   000022 600000 3                  TZE     PRESS_ON2

     1060     2871    1        THEN
     1061     2872    2        DO;

     1062     2873    2             CALL M$SPRIV (RESET_FMSEC) ALTRET (PRESS_ON1);

   2873  3 000006   000170 630400 2                  EPPR0   RESET_FMSEC
         3 000007   420012 713400                    CLIMB   alt,+8202
         3 000010   400000 401760                    pmme    nvectors=1
         3 000011   000012 702000 3                  TSX2    PRESS_ON1

   2873  3 000012                       PRESS_ON1    null
     1063     2874    2   PRESS_ON1:;
     1064     2875    2             CALL M$OPEN (OPEN_HISTORYU) ALTRET(NO_CAN_DO);

   2875  3 000012   000006 630400 2                  EPPR0   OPEN_HISTORYU
         3 000013   450000 713400                    CLIMB   alt,open
         3 000014   410400 401760                    pmme    nvectors=18
         3 000015   000220 702000 3                  TSX2    NO_CAN_DO

     1065     2876    2             CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON2);

   2876  3 000016   000170 630400 2                  EPPR0   RESET_FMSEC
         3 000017   420013 713400                    CLIMB   alt,+8203
         3 000020   400000 401760                    pmme    nvectors=1
         3 000021   000022 702000 3                  TSX2    PRESS_ON2

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:171  
   2873  3 000022                       PRESS_ON2    null
     1066     2877    2   PRESS_ON2:;
     1067     2878    2           END;

     1068     2879                                                /**/
     1069     2880                                                /**/
     1070     2881                                                /* SAVE TURNOVER INFORMATION */
     1071     2882    1        CALL M$READ (READ_STAT) ALTRET (TOO_BAD);

   2882  3 000022   000100 630400 2                  EPPR0   READ_STAT
         3 000023   440000 713400                    CLIMB   alt,read
         3 000024   401400 401760                    pmme    nvectors=4
         3 000025   000026 702000 3                  TSX2    TOO_BAD

     1072     2883    1   TOO_BAD:;

   2883  3 000026                       TOO_BAD      null
     1073     2884    1        OCL_STATUS_REC.OACTIVE = OC_HIST_SAVE.ACTIVE ;

   2884  3 000026   000000 236000 xsym               LDQ     OC_HIST_SAVE
         3 000027   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         3 000030   400000 376003                    ANQ     -131072,DU
         3 000031   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

     1074     2885    1        OCL_STATUS_REC.OHOUR = OC_HIST_SAVE.HOUR ;

   2885  3 000032   000000 236000 xsym               LDQ     OC_HIST_SAVE
         3 000033   000002 676000 xsym               ERQ     OCL_STATUS_REC+2
         3 000034   377777 376003                    ANQ     131071,DU
         3 000035   000002 656000 xsym               ERSQ    OCL_STATUS_REC+2

     1075     2886    1        OCL_STATUS_REC.OMIN = OC_HIST_SAVE.MIN ;

   2886  3 000036   000000 720000 xsym               LXL0    OC_HIST_SAVE
         3 000037   000002 440000 xsym               SXL0    OCL_STATUS_REC+2

     1076     2887    1        OCL_STATUS_REC.AACTIVE = OC_ACCT_SAVE.ACTIVE ;
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:172  

   2887  3 000040   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         3 000041   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         3 000042   400000 376003                    ANQ     -131072,DU
         3 000043   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

     1077     2888    1        OCL_STATUS_REC.AHOUR = OC_ACCT_SAVE.HOUR ;

   2888  3 000044   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         3 000045   000001 676000 xsym               ERQ     OCL_STATUS_REC+1
         3 000046   377777 376003                    ANQ     131071,DU
         3 000047   000001 656000 xsym               ERSQ    OCL_STATUS_REC+1

     1078     2889    1        OCL_STATUS_REC.AMIN = OC_ACCT_SAVE.MIN ;

   2889  3 000050   000000 721000 xsym               LXL1    OC_ACCT_SAVE
         3 000051   000001 441000 xsym               SXL1    OCL_STATUS_REC+1

     1079     2890    1        OCL_STATUS_REC.PREV_FILE = OCL_PREVIOUS_FILE;

   2890  3 000052   000000 100400                    MLR     fill='000'O
         3 000053   000000 000040 xsym               ADSC9   OCL_PREVIOUS_FILE        cn=0,n=32
         3 000054   000003 000040 xsym               ADSC9   OCL_STATUS_REC+3         cn=0,n=32

     1080     2891    1        OCL_STATUS_REC.CONSOLE_KEY = OCL_CONSOLE_FIELD;

   2891  3 000055   000000 235000 xsym               LDA     OCL_CONSOLE_FIELD
         3 000056   000013 755000 xsym               STA     OCL_STATUS_REC+11

     1081     2892                                                /**/
     1082     2893    1        CALL M$WRITE (WRITE_STATUS) ALTRET (NO_CAN_DO);

   2893  3 000057   000116 630400 2                  EPPR0   WRITE_STATUS
         3 000060   440001 713400                    CLIMB   alt,write
         3 000061   401400 401760                    pmme    nvectors=4
         3 000062   000220 702000 3                  TSX2    NO_CAN_DO

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:173  
     1083     2894                                                /**/
     1084     2895    1        IF ~OC_LIST

   2895  3 000063   000000 236000 xsym               LDQ     OC_LIST
         3 000064   400000 376003                    ANQ     -131072,DU
         3 000065   400000 676003                    ERQ     -131072,DU
         3 000066   000073 600000 3                  TZE     OOPS

     1085     2896    1        THEN
     1086     2897    1             CALL M$CLOSE(CLOSE_SAVE) ALTRET(OOPS);

   2897  3 000067   000132 630400 2                  EPPR0   CLOSE_SAVE
         3 000070   450001 713400                    CLIMB   alt,close
         3 000071   406000 401760                    pmme    nvectors=13
         3 000072   000073 702000 3                  TSX2    OOPS

   2895  3 000073                       OOPS         null
     1087     2898    1   OOPS: ;
     1088     2899    1        PARM.TYPE = 1;

   2899  3 000073   001000 236003                    LDQ     512,DU
         3 000074   200004 552140                    STBQ    PARM,'40'O,AUTO

     1089     2900    1        IF UPDATE_IND = 0 /* OCN_UPDAT_BOTH# */

   2900  3 000075   200003 470500                    LDP0    @UPDATE_IND,,AUTO
         3 000076   000000 235100                    LDA     0,,PR0
         3 000077   000102 600000 3                  TZE     s:2905
         3 000100   000002 115007                    CMPA    2,DL
         3 000101   000146 601000 3                  TNZ     s:2919

     1090     2901    1             OR
     1091     2902    1             UPDATE_IND = 2 /* OCN_UPDAT_HIST# */
     1092     2903    1        THEN
     1093     2904    2        DO;

     1094     2905    2             IF OC_HIST_SAVE.ACTIVE
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:174  

   2905  3 000102   000000 234000 xsym               SZN     OC_HIST_SAVE
         3 000103   000130 605000 3                  TPL     s:2915

     1095     2906    2             THEN
     1096     2907    3             DO;

     1097     2908    3                  PARM.HOUR = OC_HIST_SAVE.HOUR;

   2908  3 000104   000000 236000 xsym               LDQ     OC_HIST_SAVE
         3 000105   000011 772000                    QRL     9
         3 000106   200004 552110                    STBQ    PARM,'10'O,AUTO

     1098     2909    3                  PARM.MIN = OC_HIST_SAVE.MIN;

   2909  3 000107   000000 236000 xsym               LDQ     OC_HIST_SAVE
         3 000110   200004 552104                    STBQ    PARM,'04'O,AUTO

     1099     2910    3                  PARM.ACTION = 1;

   2910  3 000111   000001 236003                    LDQ     1,DU
         3 000112   200004 552120                    STBQ    PARM,'20'O,AUTO

     1100     2911    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);

   2911  3 000113   000001 236000 4                  LDQ     1
         3 000114   200013 756100                    STQ     PARM+7,,AUTO
         3 000115   200004 631500                    EPPR1   PARM,,AUTO
         3 000116   200012 451500                    STP1    PARM+6,,AUTO
         3 000117   000002 237000 4                  LDAQ    2
         3 000120   200010 757100                    STAQ    PARM+4,,AUTO
         3 000121   000004 237000 4                  LDAQ    4
         3 000122   200006 757100                    STAQ    PARM+2,,AUTO
         3 000123   200006 630500                    EPPR0   PARM+2,,AUTO
         3 000124   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000125   000000 701000 xent               TSX1    OCO$IWRITE
         3 000126   000000 011000                    NOP     0
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:175  

     1101     2912    3                END;

   2912  3 000127   000146 710000 3                  TRA     s:2919

     1102     2913    2             ELSE
     1103     2914    3             DO;

     1104     2915    3                  PARM.ACTION = 0;

   2915  3 000130   000000 236003                    LDQ     0,DU
         3 000131   200004 552120                    STBQ    PARM,'20'O,AUTO

     1105     2916    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);

   2916  3 000132   000001 236000 4                  LDQ     1
         3 000133   200013 756100                    STQ     PARM+7,,AUTO
         3 000134   200004 631500                    EPPR1   PARM,,AUTO
         3 000135   200012 451500                    STP1    PARM+6,,AUTO
         3 000136   000002 237000 4                  LDAQ    2
         3 000137   200010 757100                    STAQ    PARM+4,,AUTO
         3 000140   000004 237000 4                  LDAQ    4
         3 000141   200006 757100                    STAQ    PARM+2,,AUTO
         3 000142   200006 630500                    EPPR0   PARM+2,,AUTO
         3 000143   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000144   000000 701000 xent               TSX1    OCO$IWRITE
         3 000145   000000 011000                    NOP     0

     1106     2917    3                END;

     1107     2918    2           END;

     1108     2919    1        IF UPDATE_IND = 0 /* OCN_UPDAT_BOTH# */

   2919  3 000146   200003 470500                    LDP0    @UPDATE_IND,,AUTO
         3 000147   000000 235100                    LDA     0,,PR0
         3 000150   000153 600000 3                  TZE     s:2924
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:176  
         3 000151   000001 115007                    CMPA    1,DL
         3 000152   000220 601000 3                  TNZ     NO_CAN_DO

     1109     2920    1             OR
     1110     2921    1             UPDATE_IND = 1 /* OCN_UPDAT_ACCT# */
     1111     2922    1        THEN
     1112     2923    2        DO;

     1113     2924    2             PARM.TYPE = 0;

   2924  3 000153   000000 236003                    LDQ     0,DU
         3 000154   200004 552140                    STBQ    PARM,'40'O,AUTO

     1114     2925    2             IF OC_ACCT_SAVE.ACTIVE

   2925  3 000155   000000 234000 xsym               SZN     OC_ACCT_SAVE
         3 000156   000203 605000 3                  TPL     s:2935

     1115     2926    2             THEN
     1116     2927    3             DO;

     1117     2928    3                  PARM.ACTION = 1;

   2928  3 000157   000001 236003                    LDQ     1,DU
         3 000160   200004 552120                    STBQ    PARM,'20'O,AUTO

     1118     2929    3                  PARM.HOUR = OC_ACCT_SAVE.HOUR;

   2929  3 000161   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         3 000162   000011 772000                    QRL     9
         3 000163   200004 552110                    STBQ    PARM,'10'O,AUTO

     1119     2930    3                  PARM.MIN = OC_ACCT_SAVE.MIN;

   2930  3 000164   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         3 000165   200004 552104                    STBQ    PARM,'04'O,AUTO

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:177  
     1120     2931    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);

   2931  3 000166   000001 236000 4                  LDQ     1
         3 000167   200013 756100                    STQ     PARM+7,,AUTO
         3 000170   200004 631500                    EPPR1   PARM,,AUTO
         3 000171   200012 451500                    STP1    PARM+6,,AUTO
         3 000172   000002 237000 4                  LDAQ    2
         3 000173   200010 757100                    STAQ    PARM+4,,AUTO
         3 000174   000004 237000 4                  LDAQ    4
         3 000175   200006 757100                    STAQ    PARM+2,,AUTO
         3 000176   200006 630500                    EPPR0   PARM+2,,AUTO
         3 000177   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000200   000000 701000 xent               TSX1    OCO$IWRITE
         3 000201   000000 011000                    NOP     0

     1121     2932    3                END;

   2932  3 000202   000220 710000 3                  TRA     NO_CAN_DO

     1122     2933    2             ELSE
     1123     2934    3             DO;

     1124     2935    3                  PARM.ACTION=0;

   2935  3 000203   200004 552120                    STBQ    PARM,'20'O,AUTO

     1125     2936    3                  CALL OCO$IWRITE('200000'O /* M_SYS  */,MSG#,NP#,LEN,PARM,0);

   2936  3 000204   000001 236000 4                  LDQ     1
         3 000205   200013 756100                    STQ     PARM+7,,AUTO
         3 000206   200004 631500                    EPPR1   PARM,,AUTO
         3 000207   200012 451500                    STP1    PARM+6,,AUTO
         3 000210   000002 237000 4                  LDAQ    2
         3 000211   200010 757100                    STAQ    PARM+4,,AUTO
         3 000212   000004 237000 4                  LDAQ    4
         3 000213   200006 757100                    STAQ    PARM+2,,AUTO
         3 000214   200006 630500                    EPPR0   PARM+2,,AUTO
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:178  
         3 000215   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000216   000000 701000 xent               TSX1    OCO$IWRITE
         3 000217   000000 011000                    NOP     0

     1126     2937    3                END;

     1127     2938    2           END;

   2931  3 000220                       NO_CAN_DO    null
     1128     2939        %EJECT;
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:179  
     1129     2940                                                /**/
     1130     2941                                                /**/
     1131     2942    1   NO_CAN_DO: ;
     1132     2943                                                /**/
     1133     2944    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (PRESS_ON3);

   2944  3 000220   000170 630400 2                  EPPR0   RESET_FMSEC
         3 000221   420013 713400                    CLIMB   alt,+8203
         3 000222   400000 401760                    pmme    nvectors=1
         3 000223   000224 702000 3                  TSX2    PRESS_ON3

   2944  3 000224                       PRESS_ON3    null
     1134     2945    1   PRESS_ON3:;
     1135     2946    1        RETURN;

   2946  3 000224   000000 702200 xent               TSX2  ! X66_ARET
     1136     2947    1   END OCL$STATUS;

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:180  
--  Include file information  --

   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCL$STATUS.
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:181  

 **** Variables and constants ****

  ****  Section 002  Data  OCL$STATUS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   132-0-0/d STRC(1080)  r     1 CLOSE_SAVE               174-0-0/b UBIN(9)     r     1 LEN(0:3)
     0-0-0/b UBIN(18)    r     1 MSG#                       1-0-0/b UBIN(9)     r     1 NP#
     2-0-0/c STRC(72)    r     1 OCHIST                     6-0-0/d STRC(2088)  r     1 OPEN_HISTORYU
   100-0-0/d STRC(504)   r     1 READ_STAT                170-0-0/d STRC(144)   r     1 RESET_FMSEC
     4-0-0/c STRC(72)    r     1 SYS                      116-0-0/d STRC(432)   r     1 WRITE_STATUS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @UPDATE_IND                4-0-0/b STRC        r     1 PARM
    *0-0-0/w SBIN        r     1 UPDATE_IND

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w UBIN        r     1 OCL_CONSOLE_FIELD
     0-0-0/c STRC(288)   r     1 OCL_PREVIOUS_FILE          0-0-0/b STRC(45)    r     1 OCL_STATUS_KEY
     0-0-0/c STRC(432)   r     1 OCL_STATUS_REC             0-0-0/b STRC        r     1 OC_ACCT_SAVE
     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/b STRC        r     1 OC_HIST_SAVE
     0-0-0/w BIT         r     1 OC_LIST

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:182  
     0-0-0N  NULL        r     1 F$HISTFILE


   Procedure OCL$STATUS requires 149 words for executable code.
   Procedure OCL$STATUS requires 12 words of local(AUTO) storage.

    No errors detected in file OCL$LISTER.:E05TSI    .
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:183  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:184  
          MINI XREF LISTING

B$ALT.CODE
      1383**DCL      1383--REDEF    1384--REDEF    1384--REDEF
B$ALT.ERR.ERR#
      1385**DCL      1385--REDEF
B$ALT.EVID
      1384**DCL      1384--REDEF    1384--REDEF
B$JIT.CPFLAGS1.SLEAZE
      1193**DCL      1193--REDEF
B$JIT.ERR.MID
      1100**DCL      1100--REDEF
B$JIT.JRESPEAK
      1261**DCL      1262--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1370**DCL      1370--REDEF    1371--REDEF
B$JIT.PNR
      1274**DCL      1274--REDEF
B$JIT.TSLINE
      1368**DCL      1369--REDEF
B$JIT$
      1375**DCL      1094--IMP-PTR
CLOSE_SAVE
      2823**DCL      2897<>CALL
CLOSE_SAVE.SN_
      2823**DCL      2823--REDEF
CLOSE_SAVE.UTL_
      2824**DCL      2824--REDEF
CLOSE_SAVE.V
      2828**DCL      2823--DCLINIT
CLOSE_SAVE.V.EXPIRE#
      2838**DCL      2838--REDEF
CLOSE_SAVE.V.TYPE#
      2836**DCL      2836--REDEF
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:185  
CLOSE_SAVE.V.XTNSIZE#
      2833**DCL      2833--REDEF    2835--REDEF
LEN
      2859**DCL      2911<>CALL     2916<>CALL     2931<>CALL     2936<>CALL
M$CLOSE
       852**DCL-ENT  2897--CALL
M$OPEN
       852**DCL-ENT  2875--CALL
M$READ
       853**DCL-ENT  2882--CALL
M$RPRIV
       911**DCL-ENT  2876--CALL     2944--CALL
M$SPRIV
       911**DCL-ENT  2873--CALL
M$WRITE
       853**DCL-ENT  2893--CALL
MSG#
      2525**DCL      2911<>CALL     2916<>CALL     2931<>CALL     2936<>CALL
NO_CAN_DO
      2931**LABEL    2875--CALLALT  2893--CALLALT
NP#
      2526**DCL      2911<>CALL     2916<>CALL     2931<>CALL     2936<>CALL
OCHIST
      2581**DCL      2675--DCLINIT
OCL_CONSOLE_FIELD
      2551**DCL      2891>>ASSIGN
OCL_HIST_BUF.STAT
      2546**DCL      2547--REDEF
OCL_MSGB.ERR
      2544**DCL      2545--REDEF
OCL_PREVIOUS_FILE
      2538**DCL      2890>>ASSIGN
OCL_STATUS_KEY
      2539**DCL      2740--DCLINIT  2741--DCLINIT  2784--DCLINIT
OCL_STATUS_REC
      2537**DCL      2742--DCLINIT  2743--DCLINIT  2785--DCLINIT  2786--DCLINIT
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:186  
OCL_STATUS_REC.AACTIVE
      2537**DCL      2887<<ASSIGN
OCL_STATUS_REC.AHOUR
      2537**DCL      2888<<ASSIGN
OCL_STATUS_REC.AMIN
      2537**DCL      2889<<ASSIGN
OCL_STATUS_REC.CONSOLE_KEY
      2538**DCL      2891<<ASSIGN
OCL_STATUS_REC.OACTIVE
      2537**DCL      2884<<ASSIGN
OCL_STATUS_REC.OHOUR
      2537**DCL      2885<<ASSIGN
OCL_STATUS_REC.OMIN
      2538**DCL      2886<<ASSIGN
OCL_STATUS_REC.PREV_FILE
      2538**DCL      2890<<ASSIGN
OCO$IWRITE
      2524**DCL-ENT  2911--CALL     2916--CALL     2931--CALL     2936--CALL
OC_ACCT_SAVE.ACTIVE
      1083**DCL      2887>>ASSIGN   2925>>IF
OC_ACCT_SAVE.HOUR
      1083**DCL      2888>>ASSIGN   2929>>ASSIGN
OC_ACCT_SAVE.MIN
      1083**DCL      2889>>ASSIGN   2930>>ASSIGN
OC_CONSOLE.ATTR
      1038**DCL      1038--REDEF
OC_CONSOLE.ATTRO
      1039**DCL      1039--REDEF
OC_CONSOLE.CID
      1037**DCL      1038--REDEF
OC_CONSOLE.STATION
      1036**DCL      1036--REDEF
OC_CONSOLE$
      1035**DCL      1036--IMP-PTR
OC_DIR
      1078**DCL      1078--REDEF
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:187  
OC_HIST_SAVE.ACTIVE
      1082**DCL      2884>>ASSIGN   2905>>IF
OC_HIST_SAVE.HOUR
      1082**DCL      2885>>ASSIGN   2908>>ASSIGN
OC_HIST_SAVE.MIN
      1082**DCL      2886>>ASSIGN   2909>>ASSIGN
OC_INTBIT
      1078**DCL      1079--REDEF
OC_INTMSG
       955**DCL       968--REDEF
OC_INTMSG.FLAGS
       962**DCL       963--REDEF
OC_INTMSG.MESS
       968**DCL       968--REDEF
OC_INTMSG.MSGID
       958**DCL       959--REDEF
OC_INTMSG.WSN
       965**DCL       966--REDEF
OC_LIST
      1081**DCL      2870>>IF       2895>>IF
OC_MASK
      1079**DCL      1079--REDEF
OC_MESSBUF
       970**DCL       985--REDEF     999--REDEF
OC_MESSBUF.FLAGS
       977**DCL       978--REDEF
OC_MESSBUF.MESS
       983**DCL       983--REDEF
OC_MESSBUF.MSGID
       973**DCL       974--REDEF
OC_MESSBUF.WSN
       980**DCL       981--REDEF
OC_MESSBUF1.FLAGS
       992**DCL       993--REDEF
OC_MESSBUF1.LEN
       998**DCL       998--REDEF
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:188  
OC_MESSBUF1.MSGID
       988**DCL       989--REDEF
OC_MESSBUF1.WSN
       995**DCL       996--REDEF
OC_MSGBUFFER
      1001**DCL      1016--REDEF
OC_MSGBUFFER.FLAGS
      1008**DCL      1009--REDEF
OC_MSGBUFFER.MESS
      1014**DCL      1014--REDEF
OC_MSGBUFFER.MSGID
      1004**DCL      1005--REDEF
OC_MSGBUFFER.WSN
      1011**DCL      1012--REDEF
OC_MSGBUFFER2.FLAGS
      1023**DCL      1024--REDEF
OC_MSGBUFFER2.MSGID
      1019**DCL      1020--REDEF
OC_MSGBUFFER2.WSN
      1026**DCL      1027--REDEF
OC_PARAM
      1034**DCL      1034--REDEF
OC_QUEUE.PARMC
      1033**DCL      1033--REDEF
OOPS
      2895**LABEL    2897--CALLALT
OPEN_HISTORYU
      2674**DCL      2875<>CALL
OPEN_HISTORYU.ACSVEH_
      2676**DCL      2677--REDEF
OPEN_HISTORYU.ALTKEYS_
      2682**DCL      2683--REDEF    2683--REDEF
OPEN_HISTORYU.HDR_
      2681**DCL      2682--REDEF
OPEN_HISTORYU.TAB_
      2680**DCL      2681--REDEF
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:189  
OPEN_HISTORYU.UHL_
      2674**DCL      2675--REDEF    2675--REDEF
OPEN_HISTORYU.V
      2683**DCL      2674--DCLINIT
OPEN_HISTORYU.V.FSN#
      2714**DCL      2714--REDEF    2714--REDEF
OPEN_HISTORYU.WSN_
      2680**DCL      2680--REDEF
PARM
      2860**DCL      2911<>CALL     2916<>CALL     2931<>CALL     2936<>CALL
PARM.ACTION
      2862**DCL      2910<<ASSIGN   2915<<ASSIGN   2928<<ASSIGN   2935<<ASSIGN
PARM.HOUR
      2863**DCL      2908<<ASSIGN   2929<<ASSIGN
PARM.MIN
      2864**DCL      2909<<ASSIGN   2930<<ASSIGN
PARM.TYPE
      2861**DCL      2899<<ASSIGN   2924<<ASSIGN
PRESS_ON1
      2873**LABEL    2873--CALLALT
PRESS_ON2
      2873**LABEL    2876--CALLALT
PRESS_ON3
      2944**LABEL    2944--CALLALT
READ_STAT
      2740**DCL      2882<>CALL
READ_STAT.STATION_
      2743**DCL      2744--REDEF
READ_STAT.V
      2744**DCL      2740--DCLINIT
READ_STAT.V.DVBYTE.REREAD#
      2755**DCL      2755--REDEF
READ_STAT.V.INDX#
      2753**DCL      2753--REDEF
RESET_FMSEC
      2855**DCL      2873<>CALL     2876<>CALL     2944<>CALL
PL6.E3A0      #004=OCL$STATUS File=OCL$LISTER.:E05TSI                            WED 07/30/97 04:02 Page:190  
RESET_FMSEC.V
      2855**DCL      2855--DCLINIT
SYS
      2596**DCL      2679--DCLINIT
TOO_BAD
      2883**LABEL    2882--CALLALT
UPDATE_IND
        12**DCL        10--PROC     2900>>IF       2900>>IF       2919>>IF       2919>>IF
WRITE_STATUS
      2784**DCL      2893<>CALL
WRITE_STATUS.STATION_
      2786**DCL      2786--REDEF
WRITE_STATUS.V
      2787**DCL      2784--DCLINIT
WRITE_STATUS.V.DVBYTE.VFC#
      2793**DCL      2793--REDEF
