VERSION E05

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:1    
        1        1        /*M* QXC$BLDMSG - TPCP build a message routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QXC$BLDMSG:
        9        9                PROC(P_MSGBLK);
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B$JIT;
       16      440        %INCLUDE OC_MESSHD_C;
       17      493        %INCLUDE OC$MESSHD_C;
       18      514        %INCLUDE OC_SUBS_C;
       19     1245        %INCLUDE B_ERRORS_C;
       20     2372        %INCLUDE QQ_MACROS_C;
       21     2797        %INCLUDE QQ_SUBS_C;
       22     2989        %INCLUDE QX_MACROS_C;
       23     3124        %INCLUDE QX_DATA_R;
       24     3134        %PAGE(ARG="Parameters");

              3151    1   /***************************************************************************
              3152    1    *                                                                         *
              3153    1    *                                 Parameters                              *
              3154    1    *                                                                         *
              3155    1    ***************************************************************************/
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:2    

       25     3159        %MSGBLK(FPTN=P_MSGBLK);
       26     3249        %PAGE(ARG="Externally defined routines");

              3266    1   /***************************************************************************
              3267    1    *                                                                         *
              3268    1    *                        Externally defined routines                      *
              3269    1    *                                                                         *
              3270    1    ***************************************************************************/

       27     3274    1   DCL QXC$SNDMSG ENTRY(1);
       28     3275    1   DCL QQC$CONVERT_XID ENTRY(4);
       29     3276    1   DCL QQC$CONVERT_NUM ENTRY(3);
       30     3277        %PAGE(ARG="Symrefs");

              3294    1   /***************************************************************************
              3295    1    *                                                                         *
              3296    1    *                                  Symrefs                                *
              3297    1    *                                                                         *
              3298    1    ***************************************************************************/

       31     3302    1   DCL B$TCB$ PTR SYMREF;
       32     3303    1   DCL B$JIT$ PTR SYMREF;
       33     3304        %PAGE(ARG="DCBs");

              3321    1   /***************************************************************************
              3322    1    *                                                                         *
              3323    1    *                                    DCBs                                 *
              3324    1    *                                                                         *
              3325    1    ***************************************************************************/

       34     3329    1   DCL M$DO DCB;
       35     3330        %PAGE(ARG="Based");

              3347    1   /***************************************************************************
              3348    1    *                                                                         *
              3349    1    *                                   Based                                 *
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:3    
              3350    1    *                                                                         *
              3351    1    ***************************************************************************/

       36     3355    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       37     3356
       38     3357        %B$EXCFR;
       39     3375        %B$ALT;
       40     3383        %B$TCB;
       41     3386        %F$DCB;
       42     3443        %VLP_STATION(FPTN=VLP$STATION, STCLASS=BASED);
       43     3470        %PAGE(ARG="Constant");

              3487    1   /***************************************************************************
              3488    1    *                                                                         *
              3489    1    *                                  Constant                               *
              3490    1    *                                                                         *
              3491    1    ***************************************************************************/

       44     3495        %OC_MESSHD_D(NAME=OC_MESSAGE_C, STCLASS=CONSTANT, MSG=218, NPARMS=5);
       45     3508    1         2 LEN(0:4) UBIN(9) UNAL INIT(8, 8, 1, 4, 28),
       46     3509    1         2 INSTANCE CHAR(8) UNAL,
       47     3510    1         2 STATION CHAR(8) UNAL,
       48     3511    1         2 TYPE UBIN(9) UNAL,
       49     3512    1         2 ERR BIT(36) UNAL,
       50     3513    1         2 ID CHAR(28);
       51     3514        %PAGE(ARG="Auto");

              3531    1   /***************************************************************************
              3532    1    *                                                                         *
              3533    1    *                                    Auto                                 *
              3534    1    *                                                                         *
              3535    1    ***************************************************************************/

       52     3539    1   DCL P$ PTR;
       53     3540    1   DCL TO$ PTR;
       54     3541    1   DCL FROM$ PTR;
       55     3542        %GLOBAL_PTRS;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:4    
       56     3635
       57     3636    1   DCL K UBIN WORD;
       58     3637    1   DCL I UBIN WORD;
       59     3638    1   DCL NEXT_OFFSET UBIN WORD;
       60     3639    1   DCL SPACE_USED UBIN WORD;
       61     3640    1   DCL CHAR_STRING_SIZE SBIN WORD;
       62     3641
       63     3642    1   DCL ERRBUF CHAR(714/* ERRBUF_SIZE + KEYIN_TEMPLATE_SIZE */);
       64     3643        %OC$MESSHD(NAME=OC_MESSAGE, STCLASS=);
       65     3657    1         2 LEN(0:4) UBIN(9) UNAL,
       66     3658    1         2 INSTANCE CHAR(8) UNAL,
       67     3659    1         2 STATION CHAR(8) UNAL,
       68     3660    1         2 TYPE UBIN(9) UNAL,
       69     3661    1         2 ERR BIT(36) UNAL,
       70     3662    1         2 ID CHAR(28);
       71     3663        %PAGE(ARG="G L O B A L   D A T A", PAGE=YES);

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:5    
              3680    1   /***************************************************************************
              3681    1    *                                                                         *
              3682    1    *                           G L O B A L   D A T A                         *
              3683    1    *                                                                         *
              3684    1    ***************************************************************************/

       72     3688        %GLOBAL_PTRS(FPTN=GLOBAL$PTRS, STCLASS="BASED(QX_GLOBAL.GLOBAL$PTRS$)");
       73     3781        %PAGE(ARG="FPTs");

              3798    1   /***************************************************************************
              3799    1    *                                                                         *
              3800    1    *                                    FPTs                                 *
              3801    1    *                                                                         *
              3802    1    ***************************************************************************/

       74     3806        %FPT_ERRMSG(FPTN=FPT$ERRMSG,
       75     3807        STCLASS="BASED(GLOBAL_PTRS.FPT$ERRMSG$)");
       76     3834
       77     3835        %FPT_TIME(FPTN=FPT$TIME,
       78     3836        STCLASS="BASED(GLOBAL_PTRS.FPT$TIME$)");
       79     3855        %PAGE(ARG="VLPs");

              3872    1   /***************************************************************************
              3873    1    *                                                                         *
              3874    1    *                                    VLPs                                 *
              3875    1    *                                                                         *
              3876    1    ***************************************************************************/

       80     3880    1   DCL VLP$TIME CHAR(11) BASED(GLOBAL_PTRS.VLP$TIME$);
       81     3881        %PAGE(ARG="VLRs");

              3898    1   /***************************************************************************
              3899    1    *                                                                         *
              3900    1    *                                    VLRs                                 *
              3901    1    *                                                                         *
              3902    1    ***************************************************************************/

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:6    
       82     3906        %VLR_ERRMSG(FPTN=VLR$ERRMSG,
       83     3907        STCLASS="BASED(GLOBAL_PTRS.VLR$ERRMSG$)");
       84     3929        %PAGE(ARG="QXC$BLDMSG", PAGE=YES);

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:7    
              3946    1   /***************************************************************************
              3947    1    *                                                                         *
              3948    1    *                                 QXC$BLDMSG                              *
              3949    1    *                                                                         *
              3950    1    ***************************************************************************/

       85     3954    1           GLOBAL_PTRS = GLOBAL$PTRS;
       86     3955    1           ERRBUF = ' ';
       87     3956    1           SPACE_USED = 0;
       88     3957
       89     3958    1           IF P_MSGBLK.FLAGS.HDR ~= '0'B THEN
       90     3959    2             DO;
       91     3960    2               CALL BLD_HDR;
       92     3961    2               P_MSGBLK.FLAGS.HDR = '0'B;
       93     3962    2             END;
       94     3963
       95     3964    1           IF P_MSGBLK.TEXT$ ~= ADDR(NIL) THEN
       96     3965    2             DO;
       97     3966    2               NEXT_OFFSET = (SPACE_USED +79) / 80 * 80;
       98     3967    2               CHAR_STRING_SIZE = P_MSGBLK.ARS;
       99     3968    2               PINCRC(ADDR(ERRBUF), NEXT_OFFSET) -> CHAR$STRING =
      100     3969    2                   P_MSGBLK.TEXT$ -> CHAR$STRING;
      101     3970    2               SPACE_USED = NEXT_OFFSET + CHAR_STRING_SIZE;
      102     3971    2             END;
      103     3972
      104     3973    2           DO I = 0 TO P_MSGBLK.CODECNT - 1;
      105     3974    2             IF P_MSGBLK.ERRINFO.ERR(I) = '0'B THEN
      106     3975    3               DO;
      107     3976    3                 GOTO LOOP;
      108     3977    3               END;
      109     3978
      110     3979    2             NEXT_OFFSET = (SPACE_USED + 79) / 80 * 80;
      111     3980    2             CHAR_STRING_SIZE = 960 - NEXT_OFFSET;
      112     3981    2             IF CHAR_STRING_SIZE < 0 THEN
      113     3982    3               DO;
      114     3983    3                 GOTO LOOP;
      115     3984    3               END;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:8    
      116     3985
      117     3986    2             SPACE_USED = NEXT_OFFSET;
      118     3987    2             P$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET);
      119     3988    2             FPT$ERRMSG.BUF_ = VECTOR(P$ -> CHAR$STRING);
      120     3989    2             FPT$ERRMSG.CODE_ = VECTOR(P_MSGBLK.ERRINFO.ERR(I));
      121     3990    2             FPT$ERRMSG.FIELD1_ = P_MSGBLK.ERRINFO.FIELD1(I);
      122     3991    2             FPT$ERRMSG.FIELD2_ = P_MSGBLK.ERRINFO.FIELD2(I);
      123     3992    2             FPT$ERRMSG.FIELD3_ = P_MSGBLK.ERRINFO.FIELD3(I);
      124     3993    2             FPT$ERRMSG.V.DCB# = P_MSGBLK.ERRINFO.DCB#(I);
      125     3994    2             CALL M$ERRMSG(FPT$ERRMSG);
      126     3995
      127     3996    2             IF VLR$ERRMSG.NOMSG THEN
      128     3997    3               DO;
      129     3998    3                 VLR$ERRMSG.RECCNT = 1;
      130     3999    3               END;
      131     4000
      132     4001    2             CHAR_STRING_SIZE = 80;
      133     4002    3             DO K = 1 TO VLR$ERRMSG.RECCNT;
      134     4003    3               TO$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 80 * K);
      135     4004    3               FROM$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 120 * K);
      136     4005    3               TO$ -> CHAR$STRING = FROM$ -> CHAR$STRING;
      137     4006    3             END;
      138     4007
      139     4008    2             SPACE_USED = SPACE_USED + 80 * VLR$ERRMSG.RECCNT;
      140     4009    2   LOOP:
      141     4010    2           END;
      142     4011
      143     4012    1           P_MSGBLK.CODECNT = 0;
      144     4013    1           P_MSGBLK.ARS = SPACE_USED;
      145     4014    1           P_MSGBLK.TEXT$ = ADDR(ERRBUF);
      146     4015    1           CHAR_STRING_SIZE = 74 /* KEYIN_TEMPLATE_SIZE */;
      147     4016    1           PINCRC(ADDR(ERRBUF), SPACE_USED) -> CHAR$STRING =
      148     4017    1               ADDR(OC_MESSAGE) -> CHAR$STRING;
      149     4018    1           P_MSGBLK.FLAGS.HDR = '0'B;
      150     4019    1           CALL QXC$SNDMSG(P_MSGBLK);
      151     4020    1           RETURN;
      152     4021                %PAGE(ARG="BLD_HDR", PAGE=YES);
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:9    

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:10   
              4038    1   /***************************************************************************
              4039    1    *                                                                         *
              4040    1    *                                  BLD_HDR                                *
              4041    1    *                                                                         *
              4042    1    ***************************************************************************/

      153     4046    1   BLD_HDR:
      154     4047    1           PROC;
      155     4048
      156     4049    2   DCL I SBIN WORD;
      157     4050    2   DCL OFFSET SBIN WORD;
      158     4051    2   DCL NUM SBIN WORD;
      159     4052    2   DCL SIZE SBIN WORD;
      160     4053    2   DCL XID UBIN WORD;
      161     4054    2   DCL IC UBIN(18) UNAL;
      162     4055    2   DCL THREES(0:5) REDEF IC UBIN(3) UNAL;
      163     4056
      164     4057    2   DCL M$UC$ PTR;
      165     4058
      166     4059
      167     4060    2   DCL XID_EXT BIT(36);
      168     4061    2   DCL 1 ERR,
      169     4062    2         2 FCG1 UBIN(6) UNAL,
      170     4063    2         2 FCG2 UBIN(6) UNAL,
      171     4064    2         2 MID UBIN(6) UNAL,
      172     4065    2         2 MON BIT(1) UNAL,
      173     4066    2         2 CODE UBIN(14) UNAL,
      174     4067    2         2 SEV UBIN(3) UNAL;
      175     4068
      176     4069    2   DCL 1 HEADING(0:2) CONSTANT,
      177     4070    2         2 COUNT UBIN(9) UNAL INIT(28, 12, 14),
      178     4071    2         2 TEXT CHAR(28) INIT('*Undefined Transaction Type*',
      179     4072    2       '*TPAP Abort*', '*YCPMME Abort*');
      180     4073
      181     4074    2   DCL 1 LIMIT_HEADING(0:8) CONSTANT,
      182     4075    2         2 COUNT UBIN(9) UNAL INIT(4, 5, 4, 5, 5, 2, 2, 6, 2),
      183     4076    2         2 TEXT CHAR(6) INIT ('TIME',
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:11   
      184     4077    2       'STACK',
      185     4078    2       'TAPE',
      186     4079    2       'TDISC',
      187     4080    2       'PDISC',
      188     4081    2       'DO',
      189     4082    2       'LO',
      190     4083    2       'MEMORY',
      191     4084    2       'PO');
      192     4085        %EJECT;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:12   
      193     4086    2           OC_MESSAGE = OC_MESSAGE_C;
      194     4087    2           OC_MESSAGE.INSTANCE = B$JIT.ACCN;
      195     4088    2           OC_MESSAGE.STATION = B$JIT.UNAME;
      196     4089    2           OFFSET = 0;
      197     4090    2           M$UC$ = DCBADDR(DCBNUM(M$UC));
      198     4091
      199     4092    2           IF P_MSGBLK.FLAGS.HDR.FROM# THEN
      200     4093    3             DO;
      201     4094    3               CHAR_STRING_SIZE = 5;
      202     4095    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'From=';
      203     4096    3               CHAR_STRING_SIZE = 8;
      204     4097    3               PINCRC(ADDR(ERRBUF), OFFSET + 5) -> CHAR$STRING = B$JIT.UNAME;
      205     4098    3               OFFSET = OFFSET + 14;
      206     4099    3             END;
      207     4100
      208     4101    2           IF P_MSGBLK.FLAGS.HDR.TIME# THEN
      209     4102    3             DO;
      210     4103    3               CHAR_STRING_SIZE = 5;
      211     4104    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Time=';
      212     4105    3               CALL M$TIME(FPT$TIME);
      213     4106    3               PINCRC(ADDR(ERRBUF), OFFSET + 5) -> CHAR$STRING = VLP$TIME;
      214     4107    3               OFFSET = OFFSET + 11;
      215     4108    3             END;
      216     4109
      217     4110    2           IF P_MSGBLK.FLAGS.HDR.MSG# ~= 0 THEN
      218     4111    3             DO;
      219     4112    3               OC_MESSAGE.TYPE = P_MSGBLK.FLAGS.HDR.MSG# - 1;
      220     4113    3               CHAR_STRING_SIZE = HEADING.COUNT(P_MSGBLK.FLAGS.HDR.MSG# - 1);
      221     4114    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING =
      222     4115    3                   HEADING.TEXT(P_MSGBLK.FLAGS.HDR.MSG# - 1);
      223     4116    3               OFFSET = OFFSET + CHAR_STRING_SIZE + 1;
      224     4117    3             END;
      225     4118
      226     4119    2           IF P_MSGBLK.FLAGS.HDR.TYPE# THEN
      227     4120    3             DO;
      228     4121    3               CHAR_STRING_SIZE = 17;
      229     4122    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Transaction Type=';
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:13   
      230     4123    3               CHAR_STRING_SIZE = 8;
      231     4124    3               PINCRC(ADDR(ERRBUF), OFFSET + 17) -> CHAR$STRING =
      232     4125    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGTYP#;
      233     4126    3               OFFSET = OFFSET + 26;
      234     4127    3             END;
      235     4128
      236     4129
      237     4130        /* New line */
      238     4131    2           OFFSET = 80;
      239     4132
      240     4133    2           IF P_MSGBLK.FLAGS.HDR.SOA# THEN
      241     4134    3             DO;
      242     4135    3               CHAR_STRING_SIZE = 7;
      243     4136    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Origin=';
      244     4137    3               CHAR_STRING_SIZE = 8;
      245     4138    3               PINCRC(ADDR(ERRBUF), OFFSET + 7) -> CHAR$STRING =
      246     4139    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.STATION#;
      247     4140    3               OFFSET = OFFSET + 16;
      248     4141    3             END;
      249     4142
      250     4143    2           IF P_MSGBLK.FLAGS.HDR.ID# THEN
      251     4144    3             DO;
      252     4145    3               CHAR_STRING_SIZE = 15;
      253     4146    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Transaction Id=';
      254     4147    3               OFFSET = OFFSET + 15;
      255     4148    3               XID = M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGID#;
      256     4149    3               XID_EXT = M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGIDXT;
      257     4150
      258     4151    3               CALL QQC$CONVERT_XID(SIZE, PINCRC(ADDR(ERRBUF), OFFSET), XID, XID_EXT);
      259     4152    3               OFFSET = OFFSET + SIZE + 1;
      260     4153
      261     4154    3               CALL QQC$CONVERT_XID(SIZE, ADDR(OC_MESSAGE.ID), XID, XID_EXT);
      262     4155    3               OC_MESSAGE.LEN(4) = SIZE;
      263     4156    3             END;
      264     4157
      265     4158    2           IF P_MSGBLK.FLAGS.HDR.USRERR# THEN
      266     4159    3             DO;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:14   
      267     4160    3               ERR = B$JIT.USRERR;
      268     4161    3               OC_MESSAGE.ERR = ERR;
      269     4162    3               CHAR_STRING_SIZE = 6;
      270     4163    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Error=';
      271     4164    3               OFFSET = OFFSET + 6;
      272     4165    3               CHAR_STRING_SIZE = 1;
      273     4166    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING =
      274     4167    3                   BINASC(ERR.FCG1 + ASCBIN('A') - 1);
      275     4168    3               PINCRC(ADDR(ERRBUF), OFFSET + 1) -> CHAR$STRING =
      276     4169    3                   BINASC(ERR.FCG2 + ASCBIN('A') - 1);
      277     4170    3               PINCRC(ADDR(ERRBUF), OFFSET+ 2) -> CHAR$STRING =
      278     4171    3                   BINASC(ERR.MID + ASCBIN('A') - 1);
      279     4172    3               PINCRC(ADDR(ERRBUF), OFFSET+ 3) -> CHAR$STRING = '-';
      280     4173    3               OFFSET = OFFSET + 4;
      281     4174    3               IF ERR.MON THEN
      282     4175    4                 DO;
      283     4176    4                   PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'M';
      284     4177    4                   OFFSET = OFFSET + 1;
      285     4178    4                 END;
      286     4179    3               CHAR_STRING_SIZE = 5;
      287     4180    3               NUM = ERR.CODE;
      288     4181    3               CALL BINCHAR(PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING, NUM);
      289     4182    3               OFFSET = OFFSET + 5;
      290     4183    3               CHAR_STRING_SIZE = 1;
      291     4184    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = '-';
      292     4185    3               NUM = ERR.SEV;
      293     4186    3               CALL BINCHAR(PINCRC(ADDR(ERRBUF), OFFSET + 1) -> CHAR$STRING, NUM);
      294     4187    3               OFFSET = OFFSET + 3;
      295     4188    3             END;
      296     4189
      297     4190    2           IF (P_MSGBLK.FLAGS.HDR.USRIC# AND (B$JIT.CPFLAGS1 & '100000000000'O
              4190                    /* CP_RUND# */)) THEN
      298     4191    3             DO;
      299     4192    3               IC = B$JIT.USRIC;
      300     4193    3               CHAR_STRING_SIZE = 4;
      301     4194    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'IC=.';
      302     4195    3               OFFSET = OFFSET + 4;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:15   
      303     4196    3               CHAR_STRING_SIZE = 1;
      304     4197    4               DO I = 0 TO 5;
      305     4198    4                 PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING =
      306     4199    4                     BINASC(THREES(I) + ASCBIN('0'));
      307     4200    4                 OFFSET = OFFSET + 1;
      308     4201    4               END;
      309     4202    3               OFFSET = OFFSET + 1;
      310     4203    3             END;
      311     4204
      312     4205    2           IF P_MSGBLK.FLAGS.HDR.USRDCB# AND B$JIT.USRDCB ~= 0 THEN
      313     4206    3             DO;
      314     4207    3               NUM = B$JIT.USRDCB;
      315     4208    3               CHAR_STRING_SIZE = 5;
      316     4209    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'DCB#=';
      317     4210    3               OFFSET = OFFSET + 5;
      318     4211    3               CALL QQC$CONVERT_NUM(NUM, SIZE, PINCRC(ADDR(ERRBUF), OFFSET));
      319     4212    3               OFFSET = OFFSET + SIZE + 1;
      320     4213    3             END;
      321     4214
      322     4215    2           IF P_MSGBLK.FLAGS.HDR.USRERR# AND
      323     4216    2               ERR.CODE = 254 /* E$LIMX */ AND B$JIT.XLIMFLG ~= '0'B THEN
      324     4217    3             DO;
      325     4218    3               CHAR_STRING_SIZE = 15;
      326     4219    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Limit Exceeded=';
      327     4220    4               DO I = 1 TO 9;
      328     4221    4                 IF B$JIT.XLIMFLG & BINBIT(I, 9) ~= '0'B THEN
      329     4222    5                   DO;
      330     4223    5                     CHAR_STRING_SIZE = LIMIT_HEADING.COUNT(I - 1);
      331     4224    5                     PINCRC(ADDR(ERRBUF), OFFSET + 17) -> CHAR$STRING = LIMIT_HEADING.
              4224                              TEXT(I - 1);
      332     4225    5                     OFFSET = OFFSET + 18 + CHAR_STRING_SIZE;
      333     4226    5                   END;
      334     4227    4               END;
      335     4228    3             END;
      336     4229
      337     4230    2           SPACE_USED = OFFSET;
      338     4231    2           RETURN;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:16   
      339     4232    2   END BLD_HDR;
      340     4233    1   END QXC$BLDMSG;

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:17   
--  Include file information  --

   QX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QX_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QXC$BLDMSG.

   Procedure QXC$BLDMSG requires 592 words for executable code.
   Procedure QXC$BLDMSG requires 274 words of local(AUTO) storage.

    No errors detected in file QXC$BLDMSG.:E05TSI    .

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:18   

 Object Unit name= QXC$BLDMSG                                 File name= QXC$BLDMSG.:E05TOU
 UTS= JUL 30 '97 05:54:46.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DO
    2  RoData even  UTS     82    122  QXC$BLDMSG
    3   Proc  even  none   592   1120  QXC$BLDMSG
    4  RoData even  none     7      7  QXC$BLDMSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  QXC$BLDMSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 QXC$SNDMSG
         yes           Std       4 QQC$CONVERT_XID
         yes           Std       3 QQC$CONVERT_NUM
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:19   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    QX_GLOBAL                             B$JIT$
     M$DO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:20   


        1        1        /*M* QXC$BLDMSG - TPCP build a message routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QXC$BLDMSG:
        9        9                PROC(P_MSGBLK);

      9  3 000000   000000 700200 xent  QXC$BLDMSG   TSX0  ! X66_AUTO_1
         3 000001   000422 000001                    ZERO    274,1

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B$JIT;
       16      440        %INCLUDE OC_MESSHD_C;
       17      493        %INCLUDE OC$MESSHD_C;
       18      514        %INCLUDE OC_SUBS_C;
       19     1245        %INCLUDE B_ERRORS_C;
       20     2372        %INCLUDE QQ_MACROS_C;
       21     2797        %INCLUDE QQ_SUBS_C;
       22     2989        %INCLUDE QX_MACROS_C;
       23     3124        %INCLUDE QX_DATA_R;
       24     3134        %PAGE(ARG="Parameters");

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:21   
              3151    1   /***************************************************************************
              3152    1    *                                                                         *
              3153    1    *                                 Parameters                              *
              3154    1    *                                                                         *
              3155    1    ***************************************************************************/

       25     3159        %MSGBLK(FPTN=P_MSGBLK);
       26     3249        %PAGE(ARG="Externally defined routines");

              3266    1   /***************************************************************************
              3267    1    *                                                                         *
              3268    1    *                        Externally defined routines                      *
              3269    1    *                                                                         *
              3270    1    ***************************************************************************/

       27     3274    1   DCL QXC$SNDMSG ENTRY(1);
       28     3275    1   DCL QQC$CONVERT_XID ENTRY(4);
       29     3276    1   DCL QQC$CONVERT_NUM ENTRY(3);
       30     3277        %PAGE(ARG="Symrefs");

              3294    1   /***************************************************************************
              3295    1    *                                                                         *
              3296    1    *                                  Symrefs                                *
              3297    1    *                                                                         *
              3298    1    ***************************************************************************/

       31     3302    1   DCL B$TCB$ PTR SYMREF;
       32     3303    1   DCL B$JIT$ PTR SYMREF;
       33     3304        %PAGE(ARG="DCBs");

              3321    1   /***************************************************************************
              3322    1    *                                                                         *
              3323    1    *                                    DCBs                                 *
              3324    1    *                                                                         *
              3325    1    ***************************************************************************/

       34     3329    1   DCL M$DO DCB;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:22   
       35     3330        %PAGE(ARG="Based");

              3347    1   /***************************************************************************
              3348    1    *                                                                         *
              3349    1    *                                   Based                                 *
              3350    1    *                                                                         *
              3351    1    ***************************************************************************/

       36     3355    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       37     3356
       38     3357        %B$EXCFR;
       39     3375        %B$ALT;
       40     3383        %B$TCB;
       41     3386        %F$DCB;
       42     3443        %VLP_STATION(FPTN=VLP$STATION, STCLASS=BASED);
       43     3470        %PAGE(ARG="Constant");

              3487    1   /***************************************************************************
              3488    1    *                                                                         *
              3489    1    *                                  Constant                               *
              3490    1    *                                                                         *
              3491    1    ***************************************************************************/

       44     3495        %OC_MESSHD_D(NAME=OC_MESSAGE_C, STCLASS=CONSTANT, MSG=218, NPARMS=5);
       45     3508    1         2 LEN(0:4) UBIN(9) UNAL INIT(8, 8, 1, 4, 28),
       46     3509    1         2 INSTANCE CHAR(8) UNAL,
       47     3510    1         2 STATION CHAR(8) UNAL,
       48     3511    1         2 TYPE UBIN(9) UNAL,
       49     3512    1         2 ERR BIT(36) UNAL,
       50     3513    1         2 ID CHAR(28);
       51     3514        %PAGE(ARG="Auto");

              3531    1   /***************************************************************************
              3532    1    *                                                                         *
              3533    1    *                                    Auto                                 *
              3534    1    *                                                                         *
              3535    1    ***************************************************************************/
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:23   

       52     3539    1   DCL P$ PTR;
       53     3540    1   DCL TO$ PTR;
       54     3541    1   DCL FROM$ PTR;
       55     3542        %GLOBAL_PTRS;
       56     3635
       57     3636    1   DCL K UBIN WORD;
       58     3637    1   DCL I UBIN WORD;
       59     3638    1   DCL NEXT_OFFSET UBIN WORD;
       60     3639    1   DCL SPACE_USED UBIN WORD;
       61     3640    1   DCL CHAR_STRING_SIZE SBIN WORD;
       62     3641
       63     3642    1   DCL ERRBUF CHAR(714/* ERRBUF_SIZE + KEYIN_TEMPLATE_SIZE */);
       64     3643        %OC$MESSHD(NAME=OC_MESSAGE, STCLASS=);
       65     3657    1         2 LEN(0:4) UBIN(9) UNAL,
       66     3658    1         2 INSTANCE CHAR(8) UNAL,
       67     3659    1         2 STATION CHAR(8) UNAL,
       68     3660    1         2 TYPE UBIN(9) UNAL,
       69     3661    1         2 ERR BIT(36) UNAL,
       70     3662    1         2 ID CHAR(28);
       71     3663        %PAGE(ARG="G L O B A L   D A T A", PAGE=YES);

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:24   
              3680    1   /***************************************************************************
              3681    1    *                                                                         *
              3682    1    *                           G L O B A L   D A T A                         *
              3683    1    *                                                                         *
              3684    1    ***************************************************************************/

       72     3688        %GLOBAL_PTRS(FPTN=GLOBAL$PTRS, STCLASS="BASED(QX_GLOBAL.GLOBAL$PTRS$)");
       73     3781        %PAGE(ARG="FPTs");

              3798    1   /***************************************************************************
              3799    1    *                                                                         *
              3800    1    *                                    FPTs                                 *
              3801    1    *                                                                         *
              3802    1    ***************************************************************************/

       74     3806        %FPT_ERRMSG(FPTN=FPT$ERRMSG,
       75     3807        STCLASS="BASED(GLOBAL_PTRS.FPT$ERRMSG$)");
       76     3834
       77     3835        %FPT_TIME(FPTN=FPT$TIME,
       78     3836        STCLASS="BASED(GLOBAL_PTRS.FPT$TIME$)");
       79     3855        %PAGE(ARG="VLPs");

              3872    1   /***************************************************************************
              3873    1    *                                                                         *
              3874    1    *                                    VLPs                                 *
              3875    1    *                                                                         *
              3876    1    ***************************************************************************/

       80     3880    1   DCL VLP$TIME CHAR(11) BASED(GLOBAL_PTRS.VLP$TIME$);
       81     3881        %PAGE(ARG="VLRs");

              3898    1   /***************************************************************************
              3899    1    *                                                                         *
              3900    1    *                                    VLRs                                 *
              3901    1    *                                                                         *
              3902    1    ***************************************************************************/

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:25   
       82     3906        %VLR_ERRMSG(FPTN=VLR$ERRMSG,
       83     3907        STCLASS="BASED(GLOBAL_PTRS.VLR$ERRMSG$)");
       84     3929        %PAGE(ARG="QXC$BLDMSG", PAGE=YES);

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:26   
              3946    1   /***************************************************************************
              3947    1    *                                                                         *
              3948    1    *                                 QXC$BLDMSG                              *
              3949    1    *                                                                         *
              3950    1    ***************************************************************************/

       85     3954    1           GLOBAL_PTRS = GLOBAL$PTRS;

   3954  3 000002   000000 470400 xsym               LDP0    QX_GLOBAL
         3 000003   000100 100500                    MLR     fill='000'O
         3 000004   000000 000264                    ADSC9   0,,PR0                   cn=0,n=180
         3 000005   200010 000264                    ADSC9   GLOBAL_PTRS,,AUTO        cn=0,n=180

       86     3955    1           ERRBUF = ' ';

   3955  3 000006   040100 100400                    MLR     fill='040'O
         3 000007   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000010   200073 001312                    ADSC9   ERRBUF,,AUTO             cn=0,n=714

       87     3956    1           SPACE_USED = 0;

   3956  3 000011   200071 450100                    STZ     SPACE_USED,,AUTO

       88     3957
       89     3958    1           IF P_MSGBLK.FLAGS.HDR ~= '0'B THEN

   3958  3 000012   200003 471500                    LDP1    @P_MSGBLK,,AUTO
         3 000013   100002 236100                    LDQ     2,,PR1
         3 000014   777600 316003                    CANQ    -128,DU
         3 000015   000023 600000 3                  TZE     s:3964

       90     3959    2             DO;

       91     3960    2               CALL BLD_HDR;

   3960  3 000016   000255 701000 3                  TSX1    BLD_HDR
         3 000017   000000 011000                    NOP     0
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:27   

       92     3961    2               P_MSGBLK.FLAGS.HDR = '0'B;

   3961  3 000020   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000021   000000 236000 4                  LDQ     0
         3 000022   000002 356100                    ANSQ    2,,PR0

       93     3962    2             END;

       94     3963
       95     3964    1           IF P_MSGBLK.TEXT$ ~= ADDR(NIL) THEN

   3964  3 000023   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000024   000005 236100                    LDQ     5,,PR0
         3 000025   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000026   000052 600000 3                  TZE     s:3973

       96     3965    2             DO;

       97     3966    2               NEXT_OFFSET = (SPACE_USED +79) / 80 * 80;

   3966  3 000027   200071 236100                    LDQ     SPACE_USED,,AUTO
         3 000030   000117 036007                    ADLQ    79,DL
         3 000031   000001 772000                    QRL     1
         3 000032   000050 506007                    DIV     40,DL
         3 000033   000120 402007                    MPY     80,DL
         3 000034   200070 756100                    STQ     NEXT_OFFSET,,AUTO

       98     3967    2               CHAR_STRING_SIZE = P_MSGBLK.ARS;

   3967  3 000035   000003 236100                    LDQ     3,,PR0
         3 000036   000022 772000                    QRL     18
         3 000037   200072 756100                    STQ     CHAR_STRING_SIZE,,AUTO

       99     3968    2               PINCRC(ADDR(ERRBUF), NEXT_OFFSET) -> CHAR$STRING =

   3968  3 000040   000005 471500                    LDP1    5,,PR0
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:28   
         3 000041   000000 620006                    EAX0    0,QL
         3 000042   200072 721100                    LXL1    CHAR_STRING_SIZE,,AUTO
         3 000043   200070 235100                    LDA     NEXT_OFFSET,,AUTO
         3 000044   040145 100540                    MLR     fill='040'O
         3 000045   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         3 000046   200073 000011                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X1

      100     3969    2                   P_MSGBLK.TEXT$ -> CHAR$STRING;
      101     3970    2               SPACE_USED = NEXT_OFFSET + CHAR_STRING_SIZE;

   3970  3 000047   200070 236100                    LDQ     NEXT_OFFSET,,AUTO
         3 000050   200072 036100                    ADLQ    CHAR_STRING_SIZE,,AUTO
         3 000051   200071 756100                    STQ     SPACE_USED,,AUTO

      102     3971    2             END;

      103     3972
      104     3973    2           DO I = 0 TO P_MSGBLK.CODECNT - 1;

   3973  3 000052   200067 450100                    STZ     I,,AUTO
         3 000053   000221 710000 3                  TRA     LOOP+3

      105     3974    2             IF P_MSGBLK.ERRINFO.ERR(I) = '0'B THEN

   3974  3 000054   200067 236100                    LDQ     I,,AUTO
         3 000055   000035 402007                    MPY     29,DL
         3 000056   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000057   000000 106506                    CMPC    fill='000'O
         3 000060   000006 000004                    ADSC9   6,Q,PR0                  cn=0,n=4
         3 000061   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         3 000062   000064 601000 3                  TNZ     s:3979

      106     3975    3               DO;

      107     3976    3                 GOTO LOOP;

   3976  3 000063   000216 710000 3                  TRA     LOOP
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:29   

      108     3977    3               END;
      109     3978
      110     3979    2             NEXT_OFFSET = (SPACE_USED + 79) / 80 * 80;

   3979  3 000064   200071 236100                    LDQ     SPACE_USED,,AUTO
         3 000065   000117 036007                    ADLQ    79,DL
         3 000066   000001 772000                    QRL     1
         3 000067   000050 506007                    DIV     40,DL
         3 000070   000120 402007                    MPY     80,DL
         3 000071   200070 756100                    STQ     NEXT_OFFSET,,AUTO

      111     3980    2             CHAR_STRING_SIZE = 960 - NEXT_OFFSET;

   3980  3 000072   001700 235007                    LDA     960,DL
         3 000073   200070 135100                    SBLA    NEXT_OFFSET,,AUTO
         3 000074   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      112     3981    2             IF CHAR_STRING_SIZE < 0 THEN

   3981  3 000075   000077 605000 3                  TPL     s:3986

      113     3982    3               DO;

      114     3983    3                 GOTO LOOP;

   3983  3 000076   000216 710000 3                  TRA     LOOP

      115     3984    3               END;
      116     3985
      117     3986    2             SPACE_USED = NEXT_OFFSET;

   3986  3 000077   200071 756100                    STQ     SPACE_USED,,AUTO

      118     3987    2             P$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET);

   3987  3 000100   200414 452500                    STP2    ERR+1,,AUTO
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:30   
         3 000101   000020 736000                    QLS     16
         3 000102   000073 036003                    ADLQ    59,DU
         3 000103   200414 036100                    ADLQ    ERR+1,,AUTO
         3 000104   200004 756100                    STQ     P$,,AUTO

      119     3988    2             FPT$ERRMSG.BUF_ = VECTOR(P$ -> CHAR$STRING);

   3988  3 000105   000020 735000                    ALS     16
         3 000106   000140 135007                    SBLA    96,DL
         3 000107   200055 471500                    LDP1    GLOBAL_PTRS+37,,AUTO
         3 000110   100004 757100                    STAQ    4,,PR1

      120     3989    2             FPT$ERRMSG.CODE_ = VECTOR(P_MSGBLK.ERRINFO.ERR(I));

   3989  3 000111   777640 235007                    LDA     -96,DL
         3 000112   200067 236100                    LDQ     I,,AUTO
         3 000113   200414 755100                    STA     ERR+1,,AUTO
         3 000114   000001 402000 4                  MPY     1
         3 000115   000006 036003                    ADLQ    6,DU
         3 000116   200003 036100                    ADLQ    @P_MSGBLK,,AUTO
         3 000117   200414 235100                    LDA     ERR+1,,AUTO
         3 000120   100002 757100                    STAQ    2,,PR1

      121     3990    2             FPT$ERRMSG.FIELD1_ = P_MSGBLK.ERRINFO.FIELD1(I);

   3990  3 000121   200067 236100                    LDQ     I,,AUTO
         3 000122   000035 402007                    MPY     29,DL
         3 000123   000100 100506                    MLR     fill='000'O
         3 000124   000007 200010                    ADSC9   7,Q,PR0                  cn=1,n=8
         3 000125   100014 000010                    ADSC9   12,,PR1                  cn=0,n=8

      122     3991    2             FPT$ERRMSG.FIELD2_ = P_MSGBLK.ERRINFO.FIELD2(I);

   3991  3 000126   000100 100506                    MLR     fill='000'O
         3 000127   000011 200010                    ADSC9   9,Q,PR0                  cn=1,n=8
         3 000130   100016 000010                    ADSC9   14,,PR1                  cn=0,n=8

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:31   
      123     3992    2             FPT$ERRMSG.FIELD3_ = P_MSGBLK.ERRINFO.FIELD3(I);

   3992  3 000131   000100 100506                    MLR     fill='000'O
         3 000132   000013 200010                    ADSC9   11,Q,PR0                 cn=1,n=8
         3 000133   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8

      124     3993    2             FPT$ERRMSG.V.DCB# = P_MSGBLK.ERRINFO.DCB#(I);

   3993  3 000134   000100 101506                    MRL     fill='000'O
         3 000135   000007 000001                    ADSC9   7,Q,PR0                  cn=0,n=1
         3 000136   100026 000002                    ADSC9   22,,PR1                  cn=0,n=2

      125     3994    2             CALL M$ERRMSG(FPT$ERRMSG);

   3994  3 000137   100000 630500                    EPPR0   0,,PR1
         3 000140   020000 713400                    CLIMB   8192
         3 000141   405000 401760                    pmme    nvectors=11

      126     3995
      127     3996    2             IF VLR$ERRMSG.NOMSG THEN

   3996  3 000142   200037 470500                    LDP0    GLOBAL_PTRS+23,,AUTO
         3 000143   000000 236100                    LDQ     0,,PR0
         3 000144   100000 316003                    CANQ    32768,DU
         3 000145   000150 600000 3                  TZE     s:4001

      128     3997    3               DO;

      129     3998    3                 VLR$ERRMSG.RECCNT = 1;

   3998  3 000146   000001 236007                    LDQ     1,DL
         3 000147   000000 552104                    STBQ    0,'04'O,PR0

      130     3999    3               END;

      131     4000
      132     4001    2             CHAR_STRING_SIZE = 80;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:32   

   4001  3 000150   000120 235007                    LDA     80,DL
         3 000151   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      133     4002    3             DO K = 1 TO VLR$ERRMSG.RECCNT;

   4002  3 000152   000001 236007                    LDQ     1,DL
         3 000153   200066 756100                    STQ     K,,AUTO
         3 000154   000206 710000 3                  TRA     s:4006+3

      134     4003    3               TO$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 80 * K);

   4003  3 000155   200066 236100                    LDQ     K,,AUTO
         3 000156   000120 402007                    MPY     80,DL
         3 000157   200070 036100                    ADLQ    NEXT_OFFSET,,AUTO
         3 000160   200414 452500                    STP2    ERR+1,,AUTO
         3 000161   000020 736000                    QLS     16
         3 000162   000073 036003                    ADLQ    59,DU
         3 000163   200414 036100                    ADLQ    ERR+1,,AUTO
         3 000164   200005 756100                    STQ     TO$,,AUTO

      135     4004    3               FROM$ = PINCRC(ADDR(ERRBUF), NEXT_OFFSET + 120 * K);

   4004  3 000165   200066 236100                    LDQ     K,,AUTO
         3 000166   000170 402007                    MPY     120,DL
         3 000167   200070 036100                    ADLQ    NEXT_OFFSET,,AUTO
         3 000170   200414 452500                    STP2    ERR+1,,AUTO
         3 000171   000020 736000                    QLS     16
         3 000172   000073 036003                    ADLQ    59,DU
         3 000173   200414 036100                    ADLQ    ERR+1,,AUTO
         3 000174   200006 756100                    STQ     FROM$,,AUTO

      136     4005    3               TO$ -> CHAR$STRING = FROM$ -> CHAR$STRING;

   4005  3 000175   200006 470500                    LDP0    FROM$,,AUTO
         3 000176   200072 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         3 000177   200005 471500                    LDP1    TO$,,AUTO
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:33   
         3 000200   040140 100540                    MLR     fill='040'O
         3 000201   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         3 000202   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      137     4006    3             END;

   4006  3 000203   200066 235100                    LDA     K,,AUTO
         3 000204   000001 035007                    ADLA    1,DL
         3 000205   200066 755100                    STA     K,,AUTO
         3 000206   200037 470500                    LDP0    GLOBAL_PTRS+23,,AUTO
         3 000207   000000 236100                    LDQ     0,,PR0
         3 000210   000777 376007                    ANQ     511,DL
         3 000211   200066 116100                    CMPQ    K,,AUTO
         3 000212   000155 603000 3                  TRC     s:4003

      138     4007
      139     4008    2             SPACE_USED = SPACE_USED + 80 * VLR$ERRMSG.RECCNT;

   4008  3 000213   000120 402007                    MPY     80,DL
         3 000214   200071 036100                    ADLQ    SPACE_USED,,AUTO
         3 000215   200071 756100                    STQ     SPACE_USED,,AUTO

      140     4009    2   LOOP:
      141     4010    2           END;

   4010  3 000216   200067 235100       LOOP         LDA     I,,AUTO
         3 000217   000001 035007                    ADLA    1,DL
         3 000220   200067 755100                    STA     I,,AUTO
         3 000221   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000222   000003 236100                    LDQ     3,,PR0
         3 000223   000011 772000                    QRL     9
         3 000224   000777 376007                    ANQ     511,DL
         3 000225   200067 116100                    CMPQ    I,,AUTO
         3 000226   000230 600000 3                  TZE     s:4012
         3 000227   000054 603000 3                  TRC     s:3974

      142     4011
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:34   
      143     4012    1           P_MSGBLK.CODECNT = 0;

   4012  3 000230   000000 236003                    LDQ     0,DU
         3 000231   000003 552110                    STBQ    3,'10'O,PR0

      144     4013    1           P_MSGBLK.ARS = SPACE_USED;

   4013  3 000232   200071 720100                    LXL0    SPACE_USED,,AUTO
         3 000233   000003 740100                    STX0    3,,PR0

      145     4014    1           P_MSGBLK.TEXT$ = ADDR(ERRBUF);

   4014  3 000234   200073 631500                    EPPR1   ERRBUF,,AUTO
         3 000235   000005 451500                    STP1    5,,PR0

      146     4015    1           CHAR_STRING_SIZE = 74 /* KEYIN_TEMPLATE_SIZE */;

   4015  3 000236   000112 235007                    LDA     74,DL
         3 000237   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      147     4016    1           PINCRC(ADDR(ERRBUF), SPACE_USED) -> CHAR$STRING =

   4016  3 000240   000000 621005                    EAX1    0,AL
         3 000241   200072 722100                    LXL2    CHAR_STRING_SIZE,,AUTO
         3 000242   200071 235100                    LDA     SPACE_USED,,AUTO
         3 000243   040145 100540                    MLR     fill='040'O
         3 000244   200356 000011                    ADSC9   OC_MESSAGE,,AUTO         cn=0,n=*X1
         3 000245   200073 000012                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X2

      148     4017    1               ADDR(OC_MESSAGE) -> CHAR$STRING;
      149     4018    1           P_MSGBLK.FLAGS.HDR = '0'B;

   4018  3 000246   000000 236000 4                  LDQ     0
         3 000247   000002 356100                    ANSQ    2,,PR0

      150     4019    1           CALL QXC$SNDMSG(P_MSGBLK);

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:35   
   4019  3 000250   200003 630500                    EPPR0   @P_MSGBLK,,AUTO
         3 000251   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000252   000000 701000 xent               TSX1    QXC$SNDMSG
         3 000253   000000 011000                    NOP     0

      151     4020    1           RETURN;

   4020  3 000254   000000 702200 xent               TSX2  ! X66_ARET

      152     4021                %PAGE(ARG="BLD_HDR", PAGE=YES);

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:36   
              4038    1   /***************************************************************************
              4039    1    *                                                                         *
              4040    1    *                                  BLD_HDR                                *
              4041    1    *                                                                         *
              4042    1    ***************************************************************************/

      153     4046    1   BLD_HDR:

   4046  3 000255   200402 741300       BLD_HDR      STX1  ! OC_MESSAGE+20,,AUTO

      154     4047    1           PROC;
      155     4048
      156     4049    2   DCL I SBIN WORD;
      157     4050    2   DCL OFFSET SBIN WORD;
      158     4051    2   DCL NUM SBIN WORD;
      159     4052    2   DCL SIZE SBIN WORD;
      160     4053    2   DCL XID UBIN WORD;
      161     4054    2   DCL IC UBIN(18) UNAL;
      162     4055    2   DCL THREES(0:5) REDEF IC UBIN(3) UNAL;
      163     4056
      164     4057    2   DCL M$UC$ PTR;
      165     4058
      166     4059
      167     4060    2   DCL XID_EXT BIT(36);
      168     4061    2   DCL 1 ERR,
      169     4062    2         2 FCG1 UBIN(6) UNAL,
      170     4063    2         2 FCG2 UBIN(6) UNAL,
      171     4064    2         2 MID UBIN(6) UNAL,
      172     4065    2         2 MON BIT(1) UNAL,
      173     4066    2         2 CODE UBIN(14) UNAL,
      174     4067    2         2 SEV UBIN(3) UNAL;
      175     4068
      176     4069    2   DCL 1 HEADING(0:2) CONSTANT,
      177     4070    2         2 COUNT UBIN(9) UNAL INIT(28, 12, 14),
      178     4071    2         2 TEXT CHAR(28) INIT('*Undefined Transaction Type*',
      179     4072    2       '*TPAP Abort*', '*YCPMME Abort*');
      180     4073
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:37   
      181     4074    2   DCL 1 LIMIT_HEADING(0:8) CONSTANT,
      182     4075    2         2 COUNT UBIN(9) UNAL INIT(4, 5, 4, 5, 5, 2, 2, 6, 2),
      183     4076    2         2 TEXT CHAR(6) INIT ('TIME',
      184     4077    2       'STACK',
      185     4078    2       'TAPE',
      186     4079    2       'TDISC',
      187     4080    2       'PDISC',
      188     4081    2       'DO',
      189     4082    2       'LO',
      190     4083    2       'MEMORY',
      191     4084    2       'PO');
      192     4085        %EJECT;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:38   
      193     4086    2           OC_MESSAGE = OC_MESSAGE_C;

   4086  3 000256   000100 100400                    MLR     fill='000'O
         3 000257   000000 000112 2                  ADSC9   OC_MESSAGE_C             cn=0,n=74
         3 000260   200356 000112                    ADSC9   OC_MESSAGE,,AUTO         cn=0,n=74

      194     4087    2           OC_MESSAGE.INSTANCE = B$JIT.ACCN;

   4087  3 000261   000000 470400 xsym               LDP0    B$JIT$
         3 000262   040100 100500                    MLR     fill='040'O
         3 000263   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 000264   200364 200010                    ADSC9   OC_MESSAGE+6,,AUTO       cn=1,n=8

      195     4088    2           OC_MESSAGE.STATION = B$JIT.UNAME;

   4088  3 000265   040100 100500                    MLR     fill='040'O
         3 000266   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         3 000267   200366 200010                    ADSC9   OC_MESSAGE+8,,AUTO       cn=1,n=8

      196     4089    2           OFFSET = 0;

   4089  3 000270   200404 450100                    STZ     OFFSET,,AUTO

      197     4090    2           M$UC$ = DCBADDR(DCBNUM(M$UC));

   4090  3 000271   000000 236007 xsym               LDQ     M$UC,DL
         3 000272   000002 471400 4                  LDP1    2
         3 000273   100000 473500                    LDP3    0,,PR1
         3 000274   300000 236106                    LDQ     0,QL,PR3
         3 000275   200411 756100                    STQ     M$UC$,,AUTO

      198     4091
      199     4092    2           IF P_MSGBLK.FLAGS.HDR.FROM# THEN

   4092  3 000276   200003 474500                    LDP4    @P_MSGBLK,,AUTO
         3 000277   400002 236100                    LDQ     2,,PR4
         3 000300   040000 316003                    CANQ    16384,DU
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:39   
         3 000301   000321 600000 3                  TZE     s:4101

      200     4093    3             DO;

      201     4094    3               CHAR_STRING_SIZE = 5;

   4094  3 000302   000005 235007                    LDA     5,DL
         3 000303   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      202     4095    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'From=';

   4095  3 000304   000000 620005                    EAX0    0,AL
         3 000305   200404 235100                    LDA     OFFSET,,AUTO
         3 000306   040145 100400                    MLR     fill='040'O
         3 000307   000071 000005 2                  ADSC9   LIMIT_HEADING+16         cn=0,n=5
         3 000310   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      203     4096    3               CHAR_STRING_SIZE = 8;

   4096  3 000311   000010 236007                    LDQ     8,DL
         3 000312   200072 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      204     4097    3               PINCRC(ADDR(ERRBUF), OFFSET + 5) -> CHAR$STRING = B$JIT.UNAME;

   4097  3 000313   000000 620006                    EAX0    0,QL
         3 000314   040145 100500                    MLR     fill='040'O
         3 000315   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         3 000316   200074 200010                    ADSC9   ERRBUF+1,A,AUTO          cn=1,n=*X0

      205     4098    3               OFFSET = OFFSET + 14;

   4098  3 000317   000016 236007                    LDQ     14,DL
         3 000320   200404 056100                    ASQ     OFFSET,,AUTO

      206     4099    3             END;

      207     4100
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:40   
      208     4101    2           IF P_MSGBLK.FLAGS.HDR.TIME# THEN

   4101  3 000321   400002 236100                    LDQ     2,,PR4
         3 000322   020000 316003                    CANQ    8192,DU
         3 000323   000346 600000 3                  TZE     s:4110

      209     4102    3             DO;

      210     4103    3               CHAR_STRING_SIZE = 5;

   4103  3 000324   000005 235007                    LDA     5,DL
         3 000325   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      211     4104    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Time=';

   4104  3 000326   000000 620005                    EAX0    0,AL
         3 000327   200404 235100                    LDA     OFFSET,,AUTO
         3 000330   040145 100400                    MLR     fill='040'O
         3 000331   000073 000005 2                  ADSC9   LIMIT_HEADING+18         cn=0,n=5
         3 000332   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      212     4105    3               CALL M$TIME(FPT$TIME);

   4105  3 000333   200060 470500                    LDP0    GLOBAL_PTRS+40,,AUTO
         3 000334   020004 713400                    CLIMB   8196
         3 000335   402000 401760                    pmme    nvectors=5

      213     4106    3               PINCRC(ADDR(ERRBUF), OFFSET + 5) -> CHAR$STRING = VLP$TIME;

   4106  3 000336   200035 470500                    LDP0    GLOBAL_PTRS+21,,AUTO
         3 000337   200072 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         3 000340   200404 235100                    LDA     OFFSET,,AUTO
         3 000341   040145 100500                    MLR     fill='040'O
         3 000342   000000 000013                    ADSC9   0,,PR0                   cn=0,n=11
         3 000343   200074 200010                    ADSC9   ERRBUF+1,A,AUTO          cn=1,n=*X0

      214     4107    3               OFFSET = OFFSET + 11;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:41   

   4107  3 000344   000013 236007                    LDQ     11,DL
         3 000345   200404 056100                    ASQ     OFFSET,,AUTO

      215     4108    3             END;

      216     4109
      217     4110    2           IF P_MSGBLK.FLAGS.HDR.MSG# ~= 0 THEN

   4110  3 000346   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000347   000002 236100                    LDQ     2,,PR0
         3 000350   016000 316003                    CANQ    7168,DU
         3 000351   000400 600000 3                  TZE     s:4119

      218     4111    3             DO;

      219     4112    3               OC_MESSAGE.TYPE = P_MSGBLK.FLAGS.HDR.MSG# - 1;

   4112  3 000352   000002 236100                    LDQ     2,,PR0
         3 000353   000034 772000                    QRL     28
         3 000354   000007 376007                    ANQ     7,DL
         3 000355   000001 136007                    SBLQ    1,DL
         3 000356   000022 736000                    QLS     18
         3 000357   200370 552120                    STBQ    OC_MESSAGE+10,'20'O,AUTO

      220     4113    3               CHAR_STRING_SIZE = HEADING.COUNT(P_MSGBLK.FLAGS.HDR.MSG# - 1);

   4113  3 000360   000002 236100                    LDQ     2,,PR0
         3 000361   000034 772000                    QRL     28
         3 000362   000007 376007                    ANQ     7,DL
         3 000363   000035 402007                    MPY     29,DL
         3 000364   000100 101406                    MRL     fill='000'O
         3 000365   000013 600001 2                  ADSC9   OC_MESSAGE_C+11,Q        cn=3,n=1
         3 000366   200072 000004                    ADSC9   CHAR_STRING_SIZE,,AUTO   cn=0,n=4

      221     4114    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING =

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:42   
   4114  3 000367   200072 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         3 000370   200404 235100                    LDA     OFFSET,,AUTO
         3 000371   040145 100406                    MLR     fill='040'O
         3 000372   000014 000034 2                  ADSC9   OC_MESSAGE_C+12,Q        cn=0,n=28
         3 000373   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      222     4115    3                   HEADING.TEXT(P_MSGBLK.FLAGS.HDR.MSG# - 1);
      223     4116    3               OFFSET = OFFSET + CHAR_STRING_SIZE + 1;

   4116  3 000374   200404 236100                    LDQ     OFFSET,,AUTO
         3 000375   200072 036100                    ADLQ    CHAR_STRING_SIZE,,AUTO
         3 000376   000001 036007                    ADLQ    1,DL
         3 000377   200404 756100                    STQ     OFFSET,,AUTO

      224     4117    3             END;

      225     4118
      226     4119    2           IF P_MSGBLK.FLAGS.HDR.TYPE# THEN

   4119  3 000400   000002 234100                    SZN     2,,PR0
         3 000401   000423 605000 3                  TPL     s:4131

      227     4120    3             DO;

      228     4121    3               CHAR_STRING_SIZE = 17;

   4121  3 000402   000021 235007                    LDA     17,DL
         3 000403   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      229     4122    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Transaction Type=';

   4122  3 000404   000000 620005                    EAX0    0,AL
         3 000405   200404 235100                    LDA     OFFSET,,AUTO
         3 000406   040145 100400                    MLR     fill='040'O
         3 000407   000075 000021 2                  ADSC9   LIMIT_HEADING+20         cn=0,n=17
         3 000410   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:43   
      230     4123    3               CHAR_STRING_SIZE = 8;

   4123  3 000411   000010 236007                    LDQ     8,DL
         3 000412   200072 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      231     4124    3               PINCRC(ADDR(ERRBUF), OFFSET + 17) -> CHAR$STRING =

   4124  3 000413   200411 471500                    LDP1    M$UC$,,AUTO
         3 000414   100007 473500                    LDP3    7,,PR1
         3 000415   000000 620006                    EAX0    0,QL
         3 000416   040145 100500                    MLR     fill='040'O
         3 000417   300002 000010                    ADSC9   2,,PR3                   cn=0,n=8
         3 000420   200077 200010                    ADSC9   ERRBUF+4,A,AUTO          cn=1,n=*X0

      232     4125    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGTYP#;
      233     4126    3               OFFSET = OFFSET + 26;

   4126  3 000421   000032 236007                    LDQ     26,DL
         3 000422   200404 056100                    ASQ     OFFSET,,AUTO

      234     4127    3             END;

      235     4128
      236     4129
      237     4130        /* New line */
      238     4131    2           OFFSET = 80;

   4131  3 000423   000120 235007                    LDA     80,DL
         3 000424   200404 755100                    STA     OFFSET,,AUTO

      239     4132
      240     4133    2           IF P_MSGBLK.FLAGS.HDR.SOA# THEN

   4133  3 000425   000002 236100                    LDQ     2,,PR0
         3 000426   100000 316003                    CANQ    32768,DU
         3 000427   000451 600000 3                  TZE     s:4143

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:44   
      241     4134    3             DO;

      242     4135    3               CHAR_STRING_SIZE = 7;

   4135  3 000430   000007 235007                    LDA     7,DL
         3 000431   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      243     4136    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Origin=';

   4136  3 000432   000000 620005                    EAX0    0,AL
         3 000433   200404 235100                    LDA     OFFSET,,AUTO
         3 000434   040145 100400                    MLR     fill='040'O
         3 000435   000102 000007 2                  ADSC9   LIMIT_HEADING+25         cn=0,n=7
         3 000436   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      244     4137    3               CHAR_STRING_SIZE = 8;

   4137  3 000437   000010 236007                    LDQ     8,DL
         3 000440   200072 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      245     4138    3               PINCRC(ADDR(ERRBUF), OFFSET + 7) -> CHAR$STRING =

   4138  3 000441   200411 471500                    LDP1    M$UC$,,AUTO
         3 000442   100007 473500                    LDP3    7,,PR1
         3 000443   000000 620006                    EAX0    0,QL
         3 000444   040145 100500                    MLR     fill='040'O
         3 000445   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         3 000446   200074 600010                    ADSC9   ERRBUF+1,A,AUTO          cn=3,n=*X0

      246     4139    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.STATION#;
      247     4140    3               OFFSET = OFFSET + 16;

   4140  3 000447   000020 236007                    LDQ     16,DL
         3 000450   200404 056100                    ASQ     OFFSET,,AUTO

      248     4141    3             END;

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:45   
      249     4142
      250     4143    2           IF P_MSGBLK.FLAGS.HDR.ID# THEN

   4143  3 000451   000002 236100                    LDQ     2,,PR0
         3 000452   200000 316003                    CANQ    65536,DU
         3 000453   000545 600000 3                  TZE     s:4158

      251     4144    3             DO;

      252     4145    3               CHAR_STRING_SIZE = 15;

   4145  3 000454   000017 235007                    LDA     15,DL
         3 000455   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      253     4146    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Transaction Id=';

   4146  3 000456   000000 620005                    EAX0    0,AL
         3 000457   200404 235100                    LDA     OFFSET,,AUTO
         3 000460   040145 100400                    MLR     fill='040'O
         3 000461   000104 000017 2                  ADSC9   LIMIT_HEADING+27         cn=0,n=15
         3 000462   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      254     4147    3               OFFSET = OFFSET + 15;

   4147  3 000463   000017 236007                    LDQ     15,DL
         3 000464   200404 056100                    ASQ     OFFSET,,AUTO

      255     4148    3               XID = M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGID#;

   4148  3 000465   200411 471500                    LDP1    M$UC$,,AUTO
         3 000466   100007 473500                    LDP3    7,,PR1
         3 000467   300005 235100                    LDA     5,,PR3
         3 000470   200407 755100                    STA     XID,,AUTO

      256     4149    3               XID_EXT = M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGIDXT;

   4149  3 000471   100007 473500                    LDP3    7,,PR1
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:46   
         3 000472   300006 236100                    LDQ     6,,PR3
         3 000473   200412 756100                    STQ     XID_EXT,,AUTO

      257     4150
      258     4151    3               CALL QQC$CONVERT_XID(SIZE, PINCRC(ADDR(ERRBUF), OFFSET), XID, XID_EXT);

   4151  3 000474   200415 452500                    STP2    ERR+2,,AUTO
         3 000475   200404 236100                    LDQ     OFFSET,,AUTO
         3 000476   000020 736000                    QLS     16
         3 000477   000073 036003                    ADLQ    59,DU
         3 000500   200415 036100                    ADLQ    ERR+2,,AUTO
         3 000501   200414 756100                    STQ     ERR+1,,AUTO
         3 000502   200412 633500                    EPPR3   XID_EXT,,AUTO
         3 000503   200421 453500                    STP3    ERR+6,,AUTO
         3 000504   200407 634500                    EPPR4   XID,,AUTO
         3 000505   200420 454500                    STP4    ERR+5,,AUTO
         3 000506   200414 635500                    EPPR5   ERR+1,,AUTO
         3 000507   200417 455500                    STP5    ERR+4,,AUTO
         3 000510   200406 636500                    EPPR6   SIZE,,AUTO
         3 000511   200416 456500                    STP6    ERR+3,,AUTO
         3 000512   200416 630500                    EPPR0   ERR+3,,AUTO
         3 000513   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000514   000000 701000 xent               TSX1    QQC$CONVERT_XID
         3 000515   000000 011000                    NOP     0

      259     4152    3               OFFSET = OFFSET + SIZE + 1;

   4152  3 000516   200404 236100                    LDQ     OFFSET,,AUTO
         3 000517   200406 036100                    ADLQ    SIZE,,AUTO
         3 000520   000001 036007                    ADLQ    1,DL
         3 000521   200404 756100                    STQ     OFFSET,,AUTO

      260     4153
      261     4154    3               CALL QQC$CONVERT_XID(SIZE, ADDR(OC_MESSAGE.ID), XID, XID_EXT);

   4154  3 000522   200415 452500                    STP2    ERR+2,,AUTO
         3 000523   200415 236100                    LDQ     ERR+2,,AUTO
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:47   
         3 000524   000003 036000 4                  ADLQ    3
         3 000525   200414 756100                    STQ     ERR+1,,AUTO
         3 000526   200412 630500                    EPPR0   XID_EXT,,AUTO
         3 000527   200421 450500                    STP0    ERR+6,,AUTO
         3 000530   200407 631500                    EPPR1   XID,,AUTO
         3 000531   200420 451500                    STP1    ERR+5,,AUTO
         3 000532   200414 633500                    EPPR3   ERR+1,,AUTO
         3 000533   200417 453500                    STP3    ERR+4,,AUTO
         3 000534   200406 634500                    EPPR4   SIZE,,AUTO
         3 000535   200416 454500                    STP4    ERR+3,,AUTO
         3 000536   200416 630500                    EPPR0   ERR+3,,AUTO
         3 000537   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000540   000000 701000 xent               TSX1    QQC$CONVERT_XID
         3 000541   000000 011000                    NOP     0

      262     4155    3               OC_MESSAGE.LEN(4) = SIZE;

   4155  3 000542   200406 236100                    LDQ     SIZE,,AUTO
         3 000543   000033 736000                    QLS     27
         3 000544   200364 552140                    STBQ    OC_MESSAGE+6,'40'O,AUTO

      263     4156    3             END;

      264     4157
      265     4158    2           IF P_MSGBLK.FLAGS.HDR.USRERR# THEN

   4158  3 000545   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000546   000002 430100                    FSZN    2,,PR0
         3 000547   000703 605000 3                  TPL     s:4190

      266     4159    3             DO;

      267     4160    3               ERR = B$JIT.USRERR;

   4160  3 000550   000000 471400 xsym               LDP1    B$JIT$
         3 000551   100144 236100                    LDQ     100,,PR1
         3 000552   200413 756100                    STQ     ERR,,AUTO
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:48   

      268     4161    3               OC_MESSAGE.ERR = ERR;

   4161  3 000553   000100 100500                    MLR     fill='000'O
         3 000554   200413 000004                    ADSC9   ERR,,AUTO                cn=0,n=4
         3 000555   200370 400004                    ADSC9   OC_MESSAGE+10,,AUTO      cn=2,n=4

      269     4162    3               CHAR_STRING_SIZE = 6;

   4162  3 000556   000006 235007                    LDA     6,DL
         3 000557   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      270     4163    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Error=';

   4163  3 000560   000000 620005                    EAX0    0,AL
         3 000561   200404 235100                    LDA     OFFSET,,AUTO
         3 000562   040145 100400                    MLR     fill='040'O
         3 000563   000110 000006 2                  ADSC9   LIMIT_HEADING+31         cn=0,n=6
         3 000564   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      271     4164    3               OFFSET = OFFSET + 6;

   4164  3 000565   000006 236007                    LDQ     6,DL
         3 000566   200404 056100                    ASQ     OFFSET,,AUTO

      272     4165    3               CHAR_STRING_SIZE = 1;

   4165  3 000567   000001 235007                    LDA     1,DL
         3 000570   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      273     4166    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING =

   4166  3 000571   200413 236100                    LDQ     ERR,,AUTO
         3 000572   000036 772000                    QRL     30
         3 000573   000100 036007                    ADLQ    64,DL
         3 000574   000033 736000                    QLS     27
         3 000575   000004 276000 4                  ORQ     4
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:49   
         3 000576   200414 756100                    STQ     ERR+1,,AUTO
         3 000577   000000 620005                    EAX0    0,AL
         3 000600   200404 235100                    LDA     OFFSET,,AUTO
         3 000601   040145 100500                    MLR     fill='040'O
         3 000602   200414 000004                    ADSC9   ERR+1,,AUTO              cn=0,n=4
         3 000603   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      274     4167    3                   BINASC(ERR.FCG1 + ASCBIN('A') - 1);
      275     4168    3               PINCRC(ADDR(ERRBUF), OFFSET + 1) -> CHAR$STRING =

   4168  3 000604   200413 236100                    LDQ     ERR,,AUTO
         3 000605   000030 772000                    QRL     24
         3 000606   000077 376007                    ANQ     63,DL
         3 000607   000100 036007                    ADLQ    64,DL
         3 000610   000033 736000                    QLS     27
         3 000611   000004 276000 4                  ORQ     4
         3 000612   200414 756100                    STQ     ERR+1,,AUTO
         3 000613   200072 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         3 000614   040145 100500                    MLR     fill='040'O
         3 000615   200414 000004                    ADSC9   ERR+1,,AUTO              cn=0,n=4
         3 000616   200073 200010                    ADSC9   ERRBUF,A,AUTO            cn=1,n=*X0

      276     4169    3                   BINASC(ERR.FCG2 + ASCBIN('A') - 1);
      277     4170    3               PINCRC(ADDR(ERRBUF), OFFSET+ 2) -> CHAR$STRING =

   4170  3 000617   200413 236100                    LDQ     ERR,,AUTO
         3 000620   000022 772000                    QRL     18
         3 000621   000077 376007                    ANQ     63,DL
         3 000622   000100 036007                    ADLQ    64,DL
         3 000623   000033 736000                    QLS     27
         3 000624   000004 276000 4                  ORQ     4
         3 000625   200414 756100                    STQ     ERR+1,,AUTO
         3 000626   040145 100500                    MLR     fill='040'O
         3 000627   200414 000004                    ADSC9   ERR+1,,AUTO              cn=0,n=4
         3 000630   200073 400010                    ADSC9   ERRBUF,A,AUTO            cn=2,n=*X0

      278     4171    3                   BINASC(ERR.MID + ASCBIN('A') - 1);
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:50   
      279     4172    3               PINCRC(ADDR(ERRBUF), OFFSET+ 3) -> CHAR$STRING = '-';

   4172  3 000631   040145 100400                    MLR     fill='040'O
         3 000632   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 000633   200073 600010                    ADSC9   ERRBUF,A,AUTO            cn=3,n=*X0

      280     4173    3               OFFSET = OFFSET + 4;

   4173  3 000634   000004 236007                    LDQ     4,DL
         3 000635   200404 056100                    ASQ     OFFSET,,AUTO

      281     4174    3               IF ERR.MON THEN

   4174  3 000636   200413 236100                    LDQ     ERR,,AUTO
         3 000637   400000 316007                    CANQ    -131072,DL
         3 000640   000646 600000 3                  TZE     s:4179

      282     4175    4                 DO;

      283     4176    4                   PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'M';

   4176  3 000641   200404 235100                    LDA     OFFSET,,AUTO
         3 000642   040145 100400                    MLR     fill='040'O
         3 000643   000006 000001 4                  ADSC9   6                        cn=0,n=1
         3 000644   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      284     4177    4                   OFFSET = OFFSET + 1;

   4177  3 000645   200404 054100                    AOS     OFFSET,,AUTO

      285     4178    4                 END;

      286     4179    3               CHAR_STRING_SIZE = 5;

   4179  3 000646   000005 235007                    LDA     5,DL
         3 000647   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:51   
      287     4180    3               NUM = ERR.CODE;

   4180  3 000650   200413 236100                    LDQ     ERR,,AUTO
         3 000651   000003 772000                    QRL     3
         3 000652   037777 376007                    ANQ     16383,DL
         3 000653   200405 756100                    STQ     NUM,,AUTO

      288     4181    3               CALL BINCHAR(PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING, NUM);

   4181  3 000654   000000 620005                    EAX0    0,AL
         3 000655   200404 235100                    LDA     OFFSET,,AUTO
         3 000656   000145 301500                    BTD
         3 000657   200405 000004                    NDSC9   NUM,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000660   200073 030010                    NDSC9   ERRBUF,A,AUTO            cn=0,s=nosgn,sf=0,n=*X0

      289     4182    3               OFFSET = OFFSET + 5;

   4182  3 000661   000005 236007                    LDQ     5,DL
         3 000662   200404 056100                    ASQ     OFFSET,,AUTO

      290     4183    3               CHAR_STRING_SIZE = 1;

   4183  3 000663   000001 235007                    LDA     1,DL
         3 000664   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      291     4184    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = '-';

   4184  3 000665   000000 620005                    EAX0    0,AL
         3 000666   200404 235100                    LDA     OFFSET,,AUTO
         3 000667   040145 100400                    MLR     fill='040'O
         3 000670   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 000671   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      292     4185    3               NUM = ERR.SEV;

   4185  3 000672   200413 236100                    LDQ     ERR,,AUTO
         3 000673   000007 376007                    ANQ     7,DL
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:52   
         3 000674   200405 756100                    STQ     NUM,,AUTO

      293     4186    3               CALL BINCHAR(PINCRC(ADDR(ERRBUF), OFFSET + 1) -> CHAR$STRING, NUM);

   4186  3 000675   200072 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         3 000676   000145 301500                    BTD
         3 000677   200405 000004                    NDSC9   NUM,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000700   200073 230010                    NDSC9   ERRBUF,A,AUTO            cn=1,s=nosgn,sf=0,n=*X0

      294     4187    3               OFFSET = OFFSET + 3;

   4187  3 000701   000003 236007                    LDQ     3,DL
         3 000702   200404 056100                    ASQ     OFFSET,,AUTO

      295     4188    3             END;

      296     4189
      297     4190    2           IF (P_MSGBLK.FLAGS.HDR.USRIC# AND (B$JIT.CPFLAGS1 & '100000000000'O
              4190                    /* CP_RUND# */)) THEN

   4190  3 000703   000002 236100                    LDQ     2,,PR0
         3 000704   000200 316003                    CANQ    128,DU
         3 000705   000760 600000 3                  TZE     s:4205
         3 000706   000000 471400 xsym               LDP1    B$JIT$
         3 000707   100143 236100                    LDQ     99,,PR1
         3 000710   000112 376000 2                  ANQ     LIMIT_HEADING+33
         3 000711   000760 600000 3                  TZE     s:4205

      298     4191    3             DO;

      299     4192    3               IC = B$JIT.USRIC;

   4192  3 000712   100146 720100                    LXL0    102,,PR1
         3 000713   200410 740100                    STX0    IC,,AUTO

      300     4193    3               CHAR_STRING_SIZE = 4;

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:53   
   4193  3 000714   000004 235007                    LDA     4,DL
         3 000715   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      301     4194    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'IC=.';

   4194  3 000716   000000 621005                    EAX1    0,AL
         3 000717   200404 235100                    LDA     OFFSET,,AUTO
         3 000720   040145 100400                    MLR     fill='040'O
         3 000721   000113 000004 2                  ADSC9   LIMIT_HEADING+34         cn=0,n=4
         3 000722   200073 000011                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X1

      302     4195    3               OFFSET = OFFSET + 4;

   4195  3 000723   000004 236007                    LDQ     4,DL
         3 000724   200404 056100                    ASQ     OFFSET,,AUTO

      303     4196    3               CHAR_STRING_SIZE = 1;

   4196  3 000725   000001 235007                    LDA     1,DL
         3 000726   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      304     4197    4               DO I = 0 TO 5;

   4197  3 000727   200403 450100                    STZ     I,,AUTO

      305     4198    4                 PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING =

   4198  3 000730   200403 236100                    LDQ     I,,AUTO
         3 000731   000003 402007                    MPY     3,DL
         3 000732   000000 116003                    CMPQ    0,DU
         3 000733   000735 605000 3                  TPL     s:4198+5
         3 000734   000044 036003                    ADLQ    36,DU
         3 000735   003100 061506                    CSR     bolr='003'O
         3 000736   200410 000003                    BDSC    IC,Q,AUTO                by=0,bit=0,n=3
         3 000737   200414 000044                    BDSC    ERR+1,,AUTO              by=0,bit=0,n=36
         3 000740   200414 236100                    LDQ     ERR+1,,AUTO
         3 000741   000060 036007                    ADLQ    48,DL
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:54   
         3 000742   000033 736000                    QLS     27
         3 000743   000004 276000 4                  ORQ     4
         3 000744   200415 756100                    STQ     ERR+2,,AUTO
         3 000745   200072 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         3 000746   200404 235100                    LDA     OFFSET,,AUTO
         3 000747   040145 100500                    MLR     fill='040'O
         3 000750   200415 000004                    ADSC9   ERR+2,,AUTO              cn=0,n=4
         3 000751   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      306     4199    4                     BINASC(THREES(I) + ASCBIN('0'));
      307     4200    4                 OFFSET = OFFSET + 1;

   4200  3 000752   200404 054100                    AOS     OFFSET,,AUTO

      308     4201    4               END;

   4201  3 000753   200403 054100                    AOS     I,,AUTO
         3 000754   200403 235100                    LDA     I,,AUTO
         3 000755   000005 115007                    CMPA    5,DL
         3 000756   000730 604400 3                  TMOZ    s:4198

      309     4202    3               OFFSET = OFFSET + 1;

   4202  3 000757   200404 054100                    AOS     OFFSET,,AUTO

      310     4203    3             END;

      311     4204
      312     4205    2           IF P_MSGBLK.FLAGS.HDR.USRDCB# AND B$JIT.USRDCB ~= 0 THEN

   4205  3 000760   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000761   000002 236100                    LDQ     2,,PR0
         3 000762   000400 316003                    CANQ    256,DU
         3 000763   001030 600000 3                  TZE     s:4215
         3 000764   000000 471400 xsym               LDP1    B$JIT$
         3 000765   100153 236100                    LDQ     107,,PR1
         3 000766   000777 316007                    CANQ    511,DL
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:55   
         3 000767   001030 600000 3                  TZE     s:4215

      313     4206    3             DO;

      314     4207    3               NUM = B$JIT.USRDCB;

   4207  3 000770   100153 236100                    LDQ     107,,PR1
         3 000771   000777 376007                    ANQ     511,DL
         3 000772   200405 756100                    STQ     NUM,,AUTO

      315     4208    3               CHAR_STRING_SIZE = 5;

   4208  3 000773   000005 235007                    LDA     5,DL
         3 000774   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      316     4209    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'DCB#=';

   4209  3 000775   000000 620005                    EAX0    0,AL
         3 000776   200404 235100                    LDA     OFFSET,,AUTO
         3 000777   040145 100400                    MLR     fill='040'O
         3 001000   000114 000005 2                  ADSC9   LIMIT_HEADING+35         cn=0,n=5
         3 001001   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      317     4210    3               OFFSET = OFFSET + 5;

   4210  3 001002   000005 236007                    LDQ     5,DL
         3 001003   200404 056100                    ASQ     OFFSET,,AUTO

      318     4211    3               CALL QQC$CONVERT_NUM(NUM, SIZE, PINCRC(ADDR(ERRBUF), OFFSET));

   4211  3 001004   200415 452500                    STP2    ERR+2,,AUTO
         3 001005   200404 236100                    LDQ     OFFSET,,AUTO
         3 001006   000020 736000                    QLS     16
         3 001007   000073 036003                    ADLQ    59,DU
         3 001010   200415 036100                    ADLQ    ERR+2,,AUTO
         3 001011   200414 756100                    STQ     ERR+1,,AUTO
         3 001012   200414 633500                    EPPR3   ERR+1,,AUTO
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:56   
         3 001013   200420 453500                    STP3    ERR+5,,AUTO
         3 001014   200406 634500                    EPPR4   SIZE,,AUTO
         3 001015   200417 454500                    STP4    ERR+4,,AUTO
         3 001016   200405 635500                    EPPR5   NUM,,AUTO
         3 001017   200416 455500                    STP5    ERR+3,,AUTO
         3 001020   200416 630500                    EPPR0   ERR+3,,AUTO
         3 001021   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001022   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         3 001023   000000 011000                    NOP     0

      319     4212    3               OFFSET = OFFSET + SIZE + 1;

   4212  3 001024   200404 236100                    LDQ     OFFSET,,AUTO
         3 001025   200406 036100                    ADLQ    SIZE,,AUTO
         3 001026   000001 036007                    ADLQ    1,DL
         3 001027   200404 756100                    STQ     OFFSET,,AUTO

      320     4213    3             END;

      321     4214
      322     4215    2           IF P_MSGBLK.FLAGS.HDR.USRERR# AND

   4215  3 001030   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 001031   000002 430100                    FSZN    2,,PR0
         3 001032   001114 605000 3                  TPL     s:4230
         3 001033   200413 236100                    LDQ     ERR,,AUTO
         3 001034   377770 376007                    ANQ     131064,DL
         3 001035   003760 116007                    CMPQ    2032,DL
         3 001036   001114 601000 3                  TNZ     s:4230
         3 001037   000000 471400 xsym               LDP1    B$JIT$
         3 001040   100316 236100                    LDQ     206,,PR1
         3 001041   777000 316007                    CANQ    -512,DL
         3 001042   001114 600000 3                  TZE     s:4230

      323     4216    2               ERR.CODE = 254 /* E$LIMX */ AND B$JIT.XLIMFLG ~= '0'B THEN
      324     4217    3             DO;

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:57   
      325     4218    3               CHAR_STRING_SIZE = 15;

   4218  3 001043   000017 235007                    LDA     15,DL
         3 001044   200072 755100                    STA     CHAR_STRING_SIZE,,AUTO

      326     4219    3               PINCRC(ADDR(ERRBUF), OFFSET) -> CHAR$STRING = 'Limit Exceeded=';

   4219  3 001045   000000 620005                    EAX0    0,AL
         3 001046   200404 235100                    LDA     OFFSET,,AUTO
         3 001047   040145 100400                    MLR     fill='040'O
         3 001050   000116 000017 2                  ADSC9   LIMIT_HEADING+37         cn=0,n=15
         3 001051   200073 000010                    ADSC9   ERRBUF,A,AUTO            cn=0,n=*X0

      327     4220    4               DO I = 1 TO 9;

   4220  3 001052   000001 236007                    LDQ     1,DL
         3 001053   200403 756100                    STQ     I,,AUTO

      328     4221    4                 IF B$JIT.XLIMFLG & BINBIT(I, 9) ~= '0'B THEN

   4221  3 001054   200403 236100                    LDQ     I,,AUTO
         3 001055   000033 736000                    QLS     27
         3 001056   400000 220003                    LDX0    -131072,DU
         3 001057   000000 116003                    CMPQ    0,DU
         3 001060   001062 601000 3                  TNZ     s:4221+6
         3 001061   000000 220003                    LDX0    0,DU
         3 001062   000000 470400 xsym               LDP0    B$JIT$
         3 001063   000316 236100                    LDQ     206,,PR0
         3 001064   000022 736000                    QLS     18
         3 001065   777000 376003                    ANQ     -512,DU
         3 001066   200414 756100                    STQ     ERR+1,,AUTO
         3 001067   000000 636010                    EAQ     0,X0
         3 001070   200414 376100                    ANQ     ERR+1,,AUTO
         3 001071   001110 600000 3                  TZE     s:4227

      329     4222    5                   DO;

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:58   
      330     4223    5                     CHAR_STRING_SIZE = LIMIT_HEADING.COUNT(I - 1);

   4223  3 001072   200403 236100                    LDQ     I,,AUTO
         3 001073   000007 402007                    MPY     7,DL
         3 001074   000100 101406                    MRL     fill='000'O
         3 001075   000047 200001 2                  ADSC9   HEADING+20,Q             cn=1,n=1
         3 001076   200072 000004                    ADSC9   CHAR_STRING_SIZE,,AUTO   cn=0,n=4

      331     4224    5                     PINCRC(ADDR(ERRBUF), OFFSET + 17) -> CHAR$STRING = LIMIT_HEADING.
              4224                              TEXT(I - 1);

   4224  3 001077   200072 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         3 001100   200404 235100                    LDA     OFFSET,,AUTO
         3 001101   040145 100406                    MLR     fill='040'O
         3 001102   000047 400006 2                  ADSC9   HEADING+20,Q             cn=2,n=6
         3 001103   200077 200010                    ADSC9   ERRBUF+4,A,AUTO          cn=1,n=*X0

      332     4225    5                     OFFSET = OFFSET + 18 + CHAR_STRING_SIZE;

   4225  3 001104   200404 236100                    LDQ     OFFSET,,AUTO
         3 001105   200072 036100                    ADLQ    CHAR_STRING_SIZE,,AUTO
         3 001106   000022 036007                    ADLQ    18,DL
         3 001107   200404 756100                    STQ     OFFSET,,AUTO

      333     4226    5                   END;

      334     4227    4               END;

   4227  3 001110   200403 054100                    AOS     I,,AUTO
         3 001111   200403 235100                    LDA     I,,AUTO
         3 001112   000011 115007                    CMPA    9,DL
         3 001113   001054 604400 3                  TMOZ    s:4221

      335     4228    3             END;

      336     4229
      337     4230    2           SPACE_USED = OFFSET;
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:59   

   4230  3 001114   200404 235100                    LDA     OFFSET,,AUTO
         3 001115   200071 755100                    STA     SPACE_USED,,AUTO

      338     4231    2           RETURN;

   4231  3 001116   200402 221300                    LDX1  ! OC_MESSAGE+20,,AUTO
         3 001117   000001 702211                    TSX2  ! 1,X1
      339     4232    2   END BLD_HDR;
      340     4233    1   END QXC$BLDMSG;

PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:60   
--  Include file information  --

   QX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QX_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QXC$BLDMSG.
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:61   

 **** Variables and constants ****

  ****  Section 002 RoData QXC$BLDMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    23-0-0/c STRC(261)   r     1 HEADING(0:2)
    51-0-0/c STRC(63)    r     1 LIMIT_HEADING(0:8)
     0-0-0/c STRC(666)   r     1 OC_MESSAGE_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_MSGBLK                 72-0-0/w SBIN        r     1 CHAR_STRING_SIZE
   413-0-0/b STRC        r     1 ERR                       73-0-0/c CHAR(714)   r     1 ERRBUF
     6-0-0/w PTR         r     1 FROM$                     10-0-0/d STRC(1620)  r     1 GLOBAL_PTRS
    67-0-0/w UBIN        r     1 I                        403-0-0/w SBIN        r     1 I
   410-0-0/b UBIN(18)    r     1 IC                        66-0-0/w UBIN        r     1 K
   411-0-0/w PTR         r     1 M$UC$                     70-0-0/w UBIN        r     1 NEXT_OFFSET
   405-0-0/w SBIN        r     1 NUM                      356-0-0/c STRC(666)   r     1 OC_MESSAGE
   404-0-0/w SBIN        r     1 OFFSET                     4-0-0/w PTR         r     1 P$
    *0-0-0/w STRC(738)   r     1 P_MSGBLK                 406-0-0/w SBIN        r     1 SIZE
    71-0-0/w UBIN        r     1 SPACE_USED               410-0-0/b UBIN(3)     r     1 THREES(0:5)
     5-0-0/w PTR         r     1 TO$                      407-0-0/w UBIN        r     1 XID
   412-0-0/b BIT         r     1 XID_EXT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w STRC(72)    r     1 QX_GLOBAL

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:62   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(936)   r     1 FPT$ERRMSG
     0-0-0/d STRC(432)   r     1 FPT$TIME                   0-0-0/d STRC(1620)  r     1 GLOBAL$PTRS
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(288)   r     1 VLP$STATION
     0-0-0/c CHAR(11)    r     1 VLP$TIME                   0-0-0/d STRC(144)   r     1 VLR$ERRMSG


   Procedure QXC$BLDMSG requires 592 words for executable code.
   Procedure QXC$BLDMSG requires 274 words of local(AUTO) storage.

    No errors detected in file QXC$BLDMSG.:E05TSI    .
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:63   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:64   
          MINI XREF LISTING

B$ALT.CODE
      3377**DCL      3377--REDEF    3378--REDEF    3378--REDEF
B$ALT.ERR.ERR#
      3379**DCL      3379--REDEF
B$ALT.EVID
      3378**DCL      3378--REDEF    3378--REDEF
B$EXCFR.ASL
      3358**DCL      3358--REDEF
B$EXCFR.ERR.ERR#
      3372**DCL      3372--REDEF
B$EXCFR.EVID
      3371**DCL      3371--REDEF    3372--REDEF
B$EXCFR.IR
      3359**DCL      3359--REDEF
B$EXCFR.PREVSZ
      3358**DCL      3358--REDEF
B$EXCFR.SUBC
      3370**DCL      3370--REDEF    3371--REDEF    3371--REDEF
B$JIT.ACCN
       164**DCL      4087>>ASSIGN
B$JIT.CPFLAGS1
       253**DCL      4190>>IF
B$JIT.CPFLAGS1.SLEAZE
       258**DCL       258--REDEF
B$JIT.ERR.MID
       165**DCL       165--REDEF
B$JIT.JRESPEAK
       326**DCL       327--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       435**DCL       435--REDEF     436--REDEF
B$JIT.PNR
       339**DCL       339--REDEF
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:65   
B$JIT.TSLINE
       433**DCL       434--REDEF
B$JIT.UNAME
       164**DCL      4088>>ASSIGN   4097>>ASSIGN
B$JIT.USRDCB
       313**DCL      4205>>IF       4207>>ASSIGN
B$JIT.USRERR
       300**DCL      4160>>ASSIGN
B$JIT.USRIC
       301**DCL      4192>>ASSIGN
B$JIT.XLIMFLG
       395**DCL      4215>>IF       4221>>IF
B$JIT$
      3303**DCL       159--IMP-PTR  4087>>ASSIGN   4088>>ASSIGN   4097>>ASSIGN   4160>>ASSIGN   4190>>IF
      4192>>ASSIGN   4205>>IF       4207>>ASSIGN   4215>>IF       4221>>IF
BLD_HDR
      4047**PROC     3960--CALL
CHAR$STRING
      3355**DCL      3968<<ASSIGN   3968>>ASSIGN   3988--ASSIGN   4005<<ASSIGN   4005>>ASSIGN   4016<<ASSIGN
      4016>>ASSIGN   4095<<ASSIGN   4097<<ASSIGN   4104<<ASSIGN   4106<<ASSIGN   4114<<ASSIGN   4122<<ASSIGN
      4124<<ASSIGN   4136<<ASSIGN   4138<<ASSIGN   4146<<ASSIGN   4163<<ASSIGN   4166<<ASSIGN   4168<<ASSIGN
      4170<<ASSIGN   4172<<ASSIGN   4176<<ASSIGN   4181<<CALLBLT  4184<<ASSIGN   4186<<CALLBLT  4194<<ASSIGN
      4198<<ASSIGN   4209<<ASSIGN   4219<<ASSIGN   4224<<ASSIGN
CHAR_STRING_SIZE
      3640**DCL      3355--IMP-SIZ  3967<<ASSIGN   3968>>ASSIGN   3968>>ASSIGN   3970>>ASSIGN   3980<<ASSIGN
      3981>>IF       3988>>ASSIGN   4001<<ASSIGN   4005>>ASSIGN   4005>>ASSIGN   4015<<ASSIGN   4016>>ASSIGN
      4016>>ASSIGN   4094<<ASSIGN   4095>>ASSIGN   4096<<ASSIGN   4097>>ASSIGN   4103<<ASSIGN   4104>>ASSIGN
      4106>>ASSIGN   4113<<ASSIGN   4114>>ASSIGN   4116>>ASSIGN   4121<<ASSIGN   4122>>ASSIGN   4123<<ASSIGN
      4124>>ASSIGN   4135<<ASSIGN   4136>>ASSIGN   4137<<ASSIGN   4138>>ASSIGN   4145<<ASSIGN   4146>>ASSIGN
      4162<<ASSIGN   4163>>ASSIGN   4165<<ASSIGN   4166>>ASSIGN   4168>>ASSIGN   4170>>ASSIGN   4172>>ASSIGN
      4176>>ASSIGN   4179<<ASSIGN   4181>>CALLBLT  4183<<ASSIGN   4184>>ASSIGN   4186>>CALLBLT  4193<<ASSIGN
      4194>>ASSIGN   4196<<ASSIGN   4198>>ASSIGN   4208<<ASSIGN   4209>>ASSIGN   4218<<ASSIGN   4219>>ASSIGN
      4223<<ASSIGN   4224>>ASSIGN   4225>>ASSIGN
ERR IN PROCEDURE BLD_HDR
      4061**DCL      4160<<ASSIGN   4161>>ASSIGN
ERR.CODE IN PROCEDURE BLD_HDR
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:66   
      4066**DCL      4180>>ASSIGN   4215>>IF
ERR.FCG1 IN PROCEDURE BLD_HDR
      4062**DCL      4166>>ASSIGN
ERR.FCG2 IN PROCEDURE BLD_HDR
      4063**DCL      4168>>ASSIGN
ERR.MID IN PROCEDURE BLD_HDR
      4064**DCL      4170>>ASSIGN
ERR.MON IN PROCEDURE BLD_HDR
      4065**DCL      4174>>IF
ERR.SEV IN PROCEDURE BLD_HDR
      4067**DCL      4185>>ASSIGN
ERRBUF
      3642**DCL      3955<<ASSIGN   3968--ASSIGN   3987--ASSIGN   4003--ASSIGN   4004--ASSIGN   4014--ASSIGN
      4016--ASSIGN   4095--ASSIGN   4097--ASSIGN   4104--ASSIGN   4106--ASSIGN   4114--ASSIGN   4122--ASSIGN
      4124--ASSIGN   4136--ASSIGN   4138--ASSIGN   4146--ASSIGN   4151--CALL     4163--ASSIGN   4166--ASSIGN
      4168--ASSIGN   4170--ASSIGN   4172--ASSIGN   4176--ASSIGN   4181--CALLBLT  4184--ASSIGN   4186--CALLBLT
      4194--ASSIGN   4198--ASSIGN   4209--ASSIGN   4211--CALL     4219--ASSIGN   4224--ASSIGN
F$DCB.ACTPOS
      3419**DCL      3419--REDEF
F$DCB.ARS#
      3393**DCL      3393--REDEF
F$DCB.ATTR
      3412**DCL      3413--REDEF
F$DCB.BORROW
      3427**DCL      3427--REDEF    3427--REDEF    3427--REDEF
F$DCB.DCBNAME.L
      3441**DCL      3441--IMP-SIZ
F$DCB.EOMCHAR#
      3397**DCL      3397--REDEF
F$DCB.FLDID
      3422**DCL      3422--REDEF
F$DCB.FORM$
      3416**DCL      3416--REDEF
F$DCB.FSECT
      3432**DCL      3432--REDEF
F$DCB.FSN#
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:67   
      3409**DCL      3409--REDEF    3409--REDEF    3410--REDEF
F$DCB.HEADER$
      3415**DCL      3415--REDEF
F$DCB.IXTNSIZE#
      3413**DCL      3413--REDEF
F$DCB.LASTSTA$
      3402**DCL      3402--REDEF    4124>>ASSIGN   4138>>ASSIGN   4148>>ASSIGN   4149>>ASSIGN
F$DCB.LVL
      3428**DCL      3428--REDEF
F$DCB.NAME#.C
      3403**DCL      3403--REDEF
F$DCB.NOEOF
      3425**DCL      3425--REDEF
F$DCB.NRECS#
      3414**DCL      3414--REDEF
F$DCB.NRECX
      3433**DCL      3433--REDEF
F$DCB.OHDR
      3425**DCL      3425--REDEF
F$DCB.ORG#
      3408**DCL      3408--REDEF
F$DCB.PRECNO
      3431**DCL      3431--REDEF
F$DCB.RCSZ
      3437**DCL      3437--REDEF
F$DCB.RES#
      3404**DCL      3404--REDEF
F$DCB.SETX
      3416**DCL      3416--REDEF
F$DCB.TAB$
      3416**DCL      3416--REDEF
F$DCB.TDA
      3430**DCL      3431--REDEF
F$DCB.WSN#
      3404**DCL      3404--REDEF
FPT$ERRMSG
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:68   
      3818**DCL      3994<>CALL
FPT$ERRMSG.BUF_
      3818**DCL      3988<<ASSIGN
FPT$ERRMSG.CODE_
      3818**DCL      3989<<ASSIGN
FPT$ERRMSG.FIELD1_
      3820**DCL      3990<<ASSIGN
FPT$ERRMSG.FIELD2_
      3821**DCL      3991<<ASSIGN
FPT$ERRMSG.FIELD3_
      3821**DCL      3992<<ASSIGN
FPT$ERRMSG.V.DCB#
      3822**DCL      3993<<ASSIGN
FPT$TIME
      3847**DCL      4105<>CALL
FROM$
      3541**DCL      4004<<ASSIGN   4005>>ASSIGN
GLOBAL$PTRS
      3689**DCL      3954>>ASSIGN
GLOBAL_PTRS
      3543**DCL      3954<<ASSIGN
GLOBAL_PTRS.FPT$ERRMSG$
      3618**DCL      3818--IMP-PTR  3988>>ASSIGN   3989>>ASSIGN   3990>>ASSIGN   3991>>ASSIGN   3992>>ASSIGN
      3993>>ASSIGN   3994>>CALL
GLOBAL_PTRS.FPT$TIME$
      3624**DCL      3847--IMP-PTR  4105>>CALL
GLOBAL_PTRS.VLP$TIME$
      3586**DCL      3880--IMP-PTR  4106>>ASSIGN
GLOBAL_PTRS.VLR$ERRMSG$
      3590**DCL      3918--IMP-PTR  3996>>IF       3998>>ASSIGN   4002>>DOINDEX  4008>>ASSIGN
HEADING.COUNT IN PROCEDURE BLD_HDR
      4070**DCL      4113>>ASSIGN
HEADING.TEXT IN PROCEDURE BLD_HDR
      4071**DCL      4114>>ASSIGN
I
      3637**DCL      3973<<DOINDEX  3974>>IF       3989>>ASSIGN   3990>>ASSIGN   3991>>ASSIGN   3992>>ASSIGN
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:69   
      3993>>ASSIGN
I IN PROCEDURE BLD_HDR
      4049**DCL      4197<<DOINDEX  4198>>ASSIGN   4220<<DOINDEX  4221>>IF       4223>>ASSIGN   4224>>ASSIGN
IC IN PROCEDURE BLD_HDR
      4054**DCL      4055--REDEF    4192<<ASSIGN
K
      3636**DCL      4002<<DOINDEX  4003>>ASSIGN   4004>>ASSIGN
LIMIT_HEADING.COUNT IN PROCEDURE BLD_HDR
      4075**DCL      4223>>ASSIGN
LIMIT_HEADING.TEXT IN PROCEDURE BLD_HDR
      4076**DCL      4224>>ASSIGN
LOOP
      4010**LABEL    3976--GOTO     3983--GOTO
M$ERRMSG
       141**DCL-ENT  3994--CALL
M$TIME
       145**DCL-ENT  4105--CALL
M$UC
       102**DCL      4090--ASSIGN
M$UC$ IN PROCEDURE BLD_HDR
      4057**DCL      4090<<ASSIGN   4124>>ASSIGN   4138>>ASSIGN   4148>>ASSIGN   4149>>ASSIGN
NEXT_OFFSET
      3638**DCL      3966<<ASSIGN   3968>>ASSIGN   3970>>ASSIGN   3979<<ASSIGN   3980>>ASSIGN   3986>>ASSIGN
      3987>>ASSIGN   4003>>ASSIGN   4004>>ASSIGN
NUM IN PROCEDURE BLD_HDR
      4051**DCL      4180<<ASSIGN   4181>>CALLBLT  4185<<ASSIGN   4186>>CALLBLT  4207<<ASSIGN   4211<>CALL
OC_MESSAGE
      3644**DCL      4016--ASSIGN   4086<<ASSIGN
OC_MESSAGE.ERR
      3661**DCL      4161<<ASSIGN
OC_MESSAGE.FLAGS
      3651**DCL      3652--REDEF
OC_MESSAGE.ID
      3662**DCL      4154--CALL
OC_MESSAGE.INSTANCE
      3658**DCL      4087<<ASSIGN
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:70   
OC_MESSAGE.LEN
      3657**DCL      4155<<ASSIGN
OC_MESSAGE.MSGID
      3647**DCL      3648--REDEF
OC_MESSAGE.STATION
      3659**DCL      4088<<ASSIGN
OC_MESSAGE.TYPE
      3660**DCL      4112<<ASSIGN
OC_MESSAGE.WSN
      3654**DCL      3655--REDEF
OC_MESSAGE_C
      3496**DCL      4086>>ASSIGN
OC_MESSAGE_C.FLAGS
      3503**DCL      3504--REDEF
OC_MESSAGE_C.MSGID
      3499**DCL      3500--REDEF
OFFSET IN PROCEDURE BLD_HDR
      4050**DCL      4089<<ASSIGN   4095>>ASSIGN   4097>>ASSIGN   4098<<ASSIGN   4098>>ASSIGN   4104>>ASSIGN
      4106>>ASSIGN   4107<<ASSIGN   4107>>ASSIGN   4114>>ASSIGN   4116<<ASSIGN   4116>>ASSIGN   4122>>ASSIGN
      4124>>ASSIGN   4126<<ASSIGN   4126>>ASSIGN   4131<<ASSIGN   4136>>ASSIGN   4138>>ASSIGN   4140<<ASSIGN
      4140>>ASSIGN   4146>>ASSIGN   4147<<ASSIGN   4147>>ASSIGN   4151>>CALL     4152<<ASSIGN   4152>>ASSIGN
      4163>>ASSIGN   4164<<ASSIGN   4164>>ASSIGN   4166>>ASSIGN   4168>>ASSIGN   4170>>ASSIGN   4172>>ASSIGN
      4173<<ASSIGN   4173>>ASSIGN   4176>>ASSIGN   4177<<ASSIGN   4177>>ASSIGN   4181>>CALLBLT  4182<<ASSIGN
      4182>>ASSIGN   4184>>ASSIGN   4186>>CALLBLT  4187<<ASSIGN   4187>>ASSIGN   4194>>ASSIGN   4195<<ASSIGN
      4195>>ASSIGN   4198>>ASSIGN   4200<<ASSIGN   4200>>ASSIGN   4202<<ASSIGN   4202>>ASSIGN   4209>>ASSIGN
      4210<<ASSIGN   4210>>ASSIGN   4211>>CALL     4212<<ASSIGN   4212>>ASSIGN   4219>>ASSIGN   4224>>ASSIGN
      4225<<ASSIGN   4225>>ASSIGN   4230>>ASSIGN
P$
      3539**DCL      3987<<ASSIGN   3988>>ASSIGN
P_MSGBLK
      3160**DCL         8--PROC     4019<>CALL
P_MSGBLK.ARS
      3227**DCL      3967>>ASSIGN   4013<<ASSIGN
P_MSGBLK.CODECNT
      3229**DCL      3973>>DOINDEX  4012<<ASSIGN
P_MSGBLK.ERRINFO.DCB#
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:71   
      3240**DCL      3993>>ASSIGN
P_MSGBLK.ERRINFO.ERR
      3238**DCL      3974>>IF       3989--ASSIGN
P_MSGBLK.ERRINFO.FIELD1
      3242**DCL      3990>>ASSIGN
P_MSGBLK.ERRINFO.FIELD2
      3244**DCL      3991>>ASSIGN
P_MSGBLK.ERRINFO.FIELD3
      3246**DCL      3992>>ASSIGN
P_MSGBLK.FLAGS.HDR
      3179**DCL      3958>>IF       3961<<ASSIGN   4018<<ASSIGN
P_MSGBLK.FLAGS.HDR.FROM#
      3187**DCL      4092>>IF
P_MSGBLK.FLAGS.HDR.ID#
      3183**DCL      4143>>IF
P_MSGBLK.FLAGS.HDR.MSG#
      3191**DCL      4110>>IF       4112>>ASSIGN   4113>>ASSIGN   4114>>ASSIGN
P_MSGBLK.FLAGS.HDR.SOA#
      3185**DCL      4133>>IF
P_MSGBLK.FLAGS.HDR.TIME#
      3189**DCL      4101>>IF
P_MSGBLK.FLAGS.HDR.TYPE#
      3181**DCL      4119>>IF
P_MSGBLK.FLAGS.HDR.USRDCB#
      3195**DCL      4205>>IF
P_MSGBLK.FLAGS.HDR.USRERR#
      3193**DCL      4158>>IF       4215>>IF
P_MSGBLK.FLAGS.HDR.USRIC#
      3197**DCL      4190>>IF
P_MSGBLK.TEXT$
      3234**DCL      3964>>IF       3968>>ASSIGN   4014<<ASSIGN
QQC$CONVERT_NUM
      3276**DCL-ENT  4211--CALL
QQC$CONVERT_XID
      3275**DCL-ENT  4151--CALL     4154--CALL
QXC$SNDMSG
PL6.E3A0      #001=QXC$BLDMSG File=QXC$BLDMSG.:E05TSI                            WED 07/30/97 05:54 Page:72   
      3274**DCL-ENT  4019--CALL
QX_GLOBAL.DS2$_BITS
      3132**DCL      3132--REDEF
QX_GLOBAL.DS4$_BITS
      3132**DCL      3133--REDEF
QX_GLOBAL.GLOBAL$PTRS$
      3132**DCL      3689--IMP-PTR  3954>>ASSIGN
SIZE IN PROCEDURE BLD_HDR
      4052**DCL      4151<>CALL     4152>>ASSIGN   4154<>CALL     4155>>ASSIGN   4211<>CALL     4212>>ASSIGN
SPACE_USED
      3639**DCL      3956<<ASSIGN   3966>>ASSIGN   3970<<ASSIGN   3979>>ASSIGN   3986<<ASSIGN   4008<<ASSIGN
      4008>>ASSIGN   4013>>ASSIGN   4016>>ASSIGN   4230<<ASSIGN
THREES IN PROCEDURE BLD_HDR
      4055**DCL      4198>>ASSIGN
TO$
      3540**DCL      4003<<ASSIGN   4005>>ASSIGN
VLP$STATION.MSGID#
      3465**DCL      4148>>ASSIGN
VLP$STATION.MSGIDXT
      3465**DCL      3468--REDEF    4149>>ASSIGN
VLP$STATION.MSGTYP#
      3459**DCL      4124>>ASSIGN
VLP$STATION.STATION#
      3459**DCL      4138>>ASSIGN
VLP$TIME
      3880**DCL      4106>>ASSIGN
VLR$ERRMSG.NOMSG
      3918**DCL      3996>>IF
VLR$ERRMSG.RECCNT
      3922**DCL      3998<<ASSIGN   4002>>DOINDEX  4008>>ASSIGN
XID IN PROCEDURE BLD_HDR
      4053**DCL      4148<<ASSIGN   4151<>CALL     4154<>CALL
XID_EXT IN PROCEDURE BLD_HDR
      4060**DCL      4149<<ASSIGN   4151<>CALL     4154<>CALL
