VERSION E05

PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:1    
        1        1        /*M* XUF$FORMAT - PL6 CALLABLE OUTPUT FORMATTING ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        XUF$FORMAT: PROC(FDS);
        9        9        /*P*    NAME:    XUF$FORMAT
       10       10                PURPOSE: Provide for formatted writes in PL-6.             */
       11       11        /*D*    NAME:    XUF$FORMAT
       12       12                CALL:    CALL XUF$FORMAT(F_FDS);
       13       13                            or
       14       14                         CALL X$FORMAT(F_FDS);
       15       15                            or
       16       16                         CALL X$WRITE(FDS,VECTOR(FMT)[,DV1[,DV2[,DV3[,...]]]]);
       17       17
       18       18                         For the X$WRITE call each DVn is a data vector up to
       19       19                         a maximum of DV20.  To access X$WRITE:
       20       20                         DCL X$WRITE EPTR SYMREF;
       21       21
       22       22                INPUT:   Format Data Structure (FDS) which contains the
       23       23                         parameters describing the formatting operation.
       24       24                         The FDS strucure is in the F_FDS macro in the
       25       25                         include file XU_FORMAT_C.  The FDS parameters are:
       26       26
       27       27                Parameter   FDS name           Description
       28       28                ----------- ------------------ ------------------------------
       29       29                FMT         FDS.FMT_           Vector framing the format.
       30       30                            FDS.FMT_.BOUND
       31       31                            FDS.FMT_.FMT$
       32       32                BUF         FDS.BUF_           Vector framing output buffer.
       33       33                            FDS.BUF_.BOUND
       34       34                            FDS.BUF_.BUF$
       35       35                NVECS       FDS.NVECS#         Number of data vectors.
       36       36                VECTR       FDS.VECTR$         Pointer to array of data
       37       37                                               vectors.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:2    
       38       38                DCB         FDS.DCB#           Output DCB.
       39       39                DVFC        FDS.DVFC#          Default VFC character.
       40       40                TRUNC       FDS.TRUNC#         If YES then output lines are
       41       41                                               truncated at the buffer size.
       42       42                                               If NO then the buffer is output
       43       43                                               if it fills up, then more
       44       44                                               characters are shoveled in.
       45       45                WRAPTAB     FDS.WRAPTAB#       Column to tab to after wrapping
       46       46                                               a line.
       47       47                TABDFLT     FDS.TABDFLT#       Magic number used to calculate
       48       48                                               next column to tab to for the
       49       49                                               '-' insertion code when CNT(0)=0.
       50       50                EDIT        FDS.EDIT#          ENTADDR of user supplied field
       51       51                                               editting routine.  For more
       52       52                                               information see description of
       53       53                                               %E insertion code.
       54       54                OUTPUT      FDS.OUTPUT#        ENTADDR of user supplied output
       55       55                                               routine.  This routine will be
       56       56                                               called whenever the buffer is
       57       57                                               to be output with the call:
       58       58                                               CALL OUTPUT(FPT_WRITE.BUF_,FDS);
       59       59                                               This call is made before the
       60       60                                               call to M$WRITE.  If the OUTPUT
       61       61                                               routine ALTRETURNS then the call
       62       62                                               to M$WRITE is skipped.
       63       63
       64       64                For more information on the FDS look at the F_FDS macro.
       65       65
       66       66                DESCRIPTION:   Characters are copied from the format to the
       67       67                output buffer until a % character is hit.  The formatting
       68       68                operation then proceeds based on the insertion code that
       69       69                follows.  If the insertion code requires data and all data
       70       70                has been used then the formatter returns to the user at
       71       71                this point.  If the end of the format is hit and data remains
       72       72                then the current buffer is output and formatting proceeds
       73       73                from the rescan point (see ^ insertion code).  The detailed
       74       74                operation of the formatter is described under the major
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:3    
       75       75                concepts that follow.
       76       76
       77       77                Counts
       78       78                ______
       79       79                   There are four values that are set to 0 when the %
       80       80                character is encountered and that may be specified between
       81       81                the % character and the insertion code.  If D is the insertion
       82       82                code then specifying counts would look like %n1.n2.n3.n4D
       83       83                where any n may be omitted.  The significance of the counts
       84       84                depends on the insertion code.  In the descriptions of the
       85       85                insertion codes they will be refered to as CNT(0) - CNT(3).
       86       86                In general if CNT(n) means do something that many times then
       87       87                CNT(n)=0 is the same as CNT(n)=1.
       88       88                   N  Obtain data for CNT.  If the N is preceeded by a decimal
       89       89                      number greater than 0 and less than 36 then that many
       90       90                      bits of data are obtained for the current CNT.  Other-
       91       91                      wise one word of data is obtained.
       92       92
       93       93                Flags
       94       94                -----
       95       95                   There are several flags that may be specified between the %
       96       96                character and the insertion code.  Again if D is the insertion
       97       97                code and Z is a flag then a flag would be specified as %ZD.
       98       98                The Flags are:
       99       99
      100      100                   Z  Produce leading zeroes.  This flag is significant only
      101      101                      for numeric insertion codes.  If this flag is set and
      102      102                      a number is put in a fixed width field then leading
      103      103                      zeroes will be put in the buffer instead of leading
      104      104                      blanks.
      105      105                   +  Signed number.  This flag is significant only for
      106      106                      numeric insertion codes.  If this flag is set then the
      107      107                      data obtained is interpreted as a signed number.  If
      108      108                      it is negative it will be preceeded by a '-' in the
      109      109                      field.  If this flag is not set then the data obtained
      110      110                      is interpreted as positive.
      111      111                   M  Keep most significant digits (characters).  if this
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:4    
      112      112                      flag is set and the string size exceeds the size
      113      113                      of a fixed width field the the leftmost characters of
      114      114                      the string are shoveled into the field.  If this flag
      115      115                      is not set the rightmost characters are put in the
      116      116                      field.
      117      117                   L  Left justify in field.  If this flag is set and the
      118      118                      string is smaller than the fixed width field then the
      119      119                      field will be filled on the right with blanks.  If
      120      120                      this flag is not set then the field will be filled on
      121      121                      the left with blanks.
      122      122                   <  Delete leading blanks.  If this flag is set then leading
      123      123                      blanks are deleted from the string before it is put
      124      124                      in the output buffer.
      125      125                   >  Delete trailing blanks.  If this flag is set then trailing
      126      126                      blanks are deleted from the string before it is put in
      127      127                      the output buffer.  For the '-' format this flag means
      128      128                      never tab backwards.
      129      129                   *  Insert stars on overflow.  If a numeric value exceeds the
      130      130                      specified field width then insert stars instead of the
      131      131                      truncated value.
      132      132                   &  Check field width.  If the field to be inserted will not
      133      133                      fit on the current line then dump the current line and
      134      134                      start a new one.
      135      135                   @  FEP mode.  The data processed for this insertion code is
      136      136                      assumed to be sparse L6 data with a slack bit at the top
      137      137                      of each byte.  For the S and P insertion codes this will
      138      138                      cause the specified bit values to be multiplied by 9/8.
      139      139                      For numeric insertion codes the slack bits will be
      140      140                      compressed out.  The number of bits specified should not
      141      141                      include slack bits.
      142      142
      143      143                Miscellaneous insertion codes
      144      144                -----------------------------
      145      145                   !  Skip to top of form.  The current buffer is output
      146      146                      then an M$DEVICE(PAGE=YES) is issued on DCB.
      147      147                   /  Print CNT(0) lines.  The first line is the current
      148      148                      buffer.  Subsequent lines are blank.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:5    
      149      149                   -  Tab to column CNT(0).  If CNT(0) is 0 then tab to the
      150      150                      next multiple of FDS.TABDFLT# plus 1.
      151      151                   %  Put one % character in the buffer.
      152      152                   ^  Set rescan point.  If the end of format is hit and there
      153      153                      is still data remaining then the buffer is output and
      154      154                      the format pointer is set to the rescan point.  The
      155      155                      default is the beginning of the format.  CAUTION:  If
      156      156                      the rescan point is set to be within a repeat group
      157      157                      then strange things will happen.
      158      158                   (  Begin repeat group.  Repeat this section of the format
      159      159                      CNT(0) times.  CNT(0)=0 means skip it.  May be nested
      160      160                      until you run out of auto space.
      161      161                   )  End repeat group.
      162      162                   [  Begin If-Elseif-Endif group.  Format this section if
      163      163                      CNT(0)=CNT(1), until terminated by Elseif (?) or Endif(])
      164      164                      code.  May be nested until you run out of auto space.
      165      165                   ?  Elseif function in If-Elseif-Endif group.   Format this
      166      166                      section if CNT(0) matches the CNT(1) from the corresponding
      167      167                      If-code ([).  If CNT(0) is not specified, the section is
      168      168                      formatted if no match has yet been found (Else function).
      169      169                   ]  Endif of If-Elseif-Endif group.
      170      170                   S  Skip CNT(0) bytes of data plus CNT(1) bits of data.  If
      171      171                      both CNT(0) and CNT(1) are zero and data pointer is not
      172      172                      positioned to the beginning of a data vector then skip
      173      173                      to the next data vector.  If the CNT fields exceed the
      174      174                      size of the current data vector the results are
      175      175                      unpredictable.
      176      176                   R  Reserve buffer space.  Dumps current buffer if it is not
      177      177                      empty and there are not at least CNT(0) bytes remaining
      178      178                      in the output buffer.
      179      179                   Q  Quit processing format if no data remains.
      180      180                   P  Position data pointer to word CNT(1), character CNT(2),
      181      181                      bit CNT(3) of data vector CNT(0).  If CNT(0)=0 then
      182      182                      positioning is from the beginning of the current data
      183      183                      vector.  Data vectors are numbered 1 through NVECS.
      184      184                   V  Set VFC character.  This next character in the format
      185      185                      is put in character 0 of the buffer unless it is a %
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:6    
      186      186                      character, in which case one byte of data is obtained
      187      187                      for the VFC character.
      188      188                   X  Insert a space CNT(0) times.  CNT(0) may usefully be
      189      189                      negative, which erases the end of the current output line.
      190      190                   U  Convert UTS to time and date.  CNT(0) is the field width.
      191      191                      CNT(1) is number of bits of data to aquire for UTS, default
      192      192                      is 36.  CNT(2) is output format and has the following
      193      193                      values:
      194      194                         0 - HH:MM             (Time only)
      195      195                         1 - MM/DD/YY          (Date only)
      196      196                         2 - HH:MM MM/DD/YY    (Time and date)
      197      197                         3 - MM/DD/YY HH:MM    (Date and time)
      198      198                      The values 4 - 7 correspond with 0 - 3 except the system
      199      199                      clock is used as the source of the UTS instead of aquiring
      200      200                      data.  CNT(3) is the M$TIME format and has the following
      201      201                      values:
      202      202                         0 - M$TIME LOCAL format.
      203      203                         1 - M$TIME EXT format.
      204      204                         2 - M$TIME ANS format.
      205      205                         3 - Unused.
      206      206                      Values 4 -7 correspond with 0 - 3 except HH:MM becomes
      207      207                      HH:MM:SS.  Values 8 - 11 correspond with 0 - 3 except
      208      208                      HH:MM becomes HH:MM:SS.SS.
      209      209                   J  Convert standard error code.  CNT(0) is field width.
      210      210                      CNT(1) is number of bits of data to aquire for error
      211      211                      code.
      212      212                   F  Special formats.  Format is determined by the value of
      213      213                      CNT(1).  Currently defined values are:
      214      214                         1  Aquire two words of data and format as a descriptor.
      215      215                            CNT(0) is field width.
      216      216                         2  Aquire one word of data and format as a pointer.
      217      217                            CNT(0) is field width.
      218      218                         3  Aquire one word of data and use it as a dcb number
      219      219                            in a call to M$UNFID.  The resultant fid is placed
      220      220                            in the output buffer.  CNT(0) is field width.
      221      221                         4  Aquire one word of data and use it as a dcb number.
      222      222                            The associated dcb name is placed into the output
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:7    
      223      223                            buffer.  CNT(0) is field width.
      224      224                   E  Call edit routine.  If FDS.EDIT# is not ENTADDR(NIL)
      225      225                      then CALL FDS.EDIT#(FDS,CNT).  Where FDS is the current
      226      226                      FDS and CNT is the array of counts described earlier.
      227      227                      If the edit routine altrets the formatter will remain
      228      228                      in the insertion mode.  A normal return will cause the
      229      229                      formatter to begin looking for the next % character.
      230      230                      The edit routine may wish to examine the format string
      231      231                      and possibly alter the point at which fht formatter
      232      232                      resumes scanning it.  Such a need is accomplished by means of
      233      233                      the FDS fields FMTX, FMT_.FMT$, and FMT_.BOUND or FMTSIZE.
      234      234                      SUBSTR(FMT_.FMT$->char(FMTSIZE),FMTX-1,1) is the 'E' that
      235      235                      caused the edit routine to be called.  On return, FMTX
      236      236                      should be set to index the next character to be scanned.
      237      237
      238      238                Numeric insertion codes.
      239      239                ------------------------
      240      240                   The numeric insertion codes cause data to be obtained,
      241      241                converted to a text string and placed in the output buffer.
      242      242                CNT(0) specifies the width of the field in the output buffer.
      243      243                CNT(0)=0 means a variable width field, i.e. the field will be
      244      244                wide enough to contain the text string.  CNT(1) specifies
      245      245                the number of bits of data to be obtained.  If CNT(1) is
      246      246                larger than 36 then 36 bits of data are obtained.  If CNT(1)
      247      247                is zero then 36 bits or the remainder of the current data
      248      248                vector, whichever is smaller, are obtained.
      249      249
      250      250                   D  Convert to decimal number.
      251      251                   O  Convert to octal number.
      252      252                   B  Convert to binary number.
      253      253                   H  Convert to hexidecimal number.
      254      254                   Y  Convert to hexidecimal number in 8 of 9 format.
      255      255
      256      256                Examples:
      257      257                   Data        Format          Result
      258      258                   ----------- --------------- --------------------------
      259      259                   100         .%D.            .100.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:8    
      260      260                   100         .%5D.           .  100.
      261      261                   100         .%5ZD.          .00100.
      262      262                   100         .%5LD.          .100  .
      263      263                   '777'O      .%H.            .1FF.
      264      264                   '777'O      .%Y.            .FF.
      265      265                   '777063'O   .%Y.            .FF33.
      266      266                   -100        .%D.            .68719476636.
      267      267                   -100        .%+D.           .-100.
      268      268                   -100        .%5+D.          . -100.
      269      269                   -100        .%5+LD.         .-100 .
      270      270                   -100        .%5+ZD.         .-0100.
      271      271
      272      272                Character insertion codes
      273      273                -------------------------
      274      274                   A  Insert CNT(1) characters into field CNT(0) characters
      275      275                      wide.  Default for CNT(1) is value of CNT(0).  If
      276      276                      CNT(1)=0 or exceeds the length of the current data vector
      277      277                      then the remainder of the current data vector is used.
      278      278                   T  The current data pointer is assumed to point to a
      279      279                      TEXTC string which is to be moved into a field CNT(0)
      280      280                      characters wide according to the setting of the L and
      281      281                      M flags.  CNT(0)=0 means move the entire string.
      282      282
      283      283                Note: When obtaining numeric data, bits are picked up
      284      284                      beginning at the current data pointer.  For character
      285      285                      data the data pointer is first aligned to the next
      286      286                      character boundary.
      287      287                                                                           */
      288      288        %EJECT;
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:9    
      289      289        %INCLUDE XU_FORMAT_C;
      290      451        %INCLUDE CP_6;
      291     6010        %F_FDS (NAME=FDS,STCLASS="");
      292     6123    1   DCL FMT CHAR(FDS.FMTSIZE) BASED(FDS.FMT_.FMT$);
      293     6124    1   DCL XUF$FORMAT1 ENTRY(1);
      294     6125        %FPT_DEVICE (FPTN=FPT_DEVICE,PAGE=YES,STCLASS=CONSTANT);
      295     6143        %FPT_DEVICE (FPTN=DEVICEFPT,STCLASS=AUTO);
      296     6161        %FPT_WRITE (VFC=YES,STCLASS=CONSTANT);
      297     6192        %FPT_WRITE (FPTN=WRITEFPT,STCLASS=AUTO);
      298     6223    1   DCL GLOBAL(0:99) UBIN;
      299     6224        %EJECT;
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:10   
      300     6225    1   X$FORMAT: ENTRY(FDS);
      301     6226    1           FDS.DONT_PRINT = '0'B;
      302     6227    1           FDS.FMTX=0;
      303     6228    1           FDS.FMTXMAX=0;
      304     6229    1           FDS.FMTSIZE=FDS.FMT_.BOUND+1;
      305     6230    1           FDS.BUFSIZE=FDS.BUF_.BOUND+1;
      306     6231    1           IF FDS.FMTSIZE > 1
      307     6232    2           THEN DO;
      308     6233    2              IF SUBSTR(FMT,0,2) = '%\'
      309     6234    3              THEN DO;
      310     6235    3                 FDS.DONT_PRINT = '1'B;
      311     6236    3                 FDS.FMTX = 2;
      312     6237    3                 END;
      313     6238    3              ELSE DO;
      314     6239    3                 FDS.BUFX = 1;
      315     6240    3                 FDS.BLNKBUF = '1'B;
      316     6241    3                 END;
      317     6242    2              END;
      318     6243    2           ELSE DO;
      319     6244    2              FDS.BUFX = 1;
      320     6245    2              FDS.BLNKBUF = '1'B;
      321     6246    2              END;
      322     6247    1           FDS.WRAP='0'B;
      323     6248    1           FDS.RESCAN=0;
      324     6249    1           FDS.MEMX=-1;
      325     6250    1           DEVICEFPT=FPT_DEVICE;
      326     6251    1           DEVICEFPT.V_=VECTOR(DEVICEFPT.V);
      327     6252    1           FDS.DEVICEFPT$=ADDR(DEVICEFPT);
      328     6253    1           WRITEFPT=FPT_WRITE;
      329     6254    1           WRITEFPT.V_=VECTOR(WRITEFPT.V);
      330     6255    1           FDS.WRITEFPT$=ADDR(WRITEFPT);
      331     6256    1           GLOBAL = '0'B;
      332     6257    1           FDS.GLOBAL$ = ADDR(GLOBAL);
      333     6258    1           REMEMBER XIT IN FDS.BAILOUT;
      334     6259    1           CALL XUF$FORMAT1 (FDS);
      335     6260    1   XIT:    RETURN;
      336     6261    1   END XUF$FORMAT;
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:11   
      337     6262        %EOD;

PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:12   
--  Include file information  --

   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUF$FORMAT.

   Procedure XUF$FORMAT requires 79 words for executable code.
   Procedure XUF$FORMAT requires 128 words of local(AUTO) storage.

PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:13   

 Object Unit name= XUF$FORMAT                                 File name= XUF$FORMAT.:E05TOU
 UTS= JUL 30 '97 09:15:12.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     23     27  XUF$FORMAT
    2   Proc  even  none    79    117  XUF$FORMAT
    3  RoData even  none     3      3  XUF$FORMAT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  XUF$FORMAT
     2      3                  yes      Std        1  X$FORMAT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 XUF$FORMAT1
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VECTNIL
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:14   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:15   


        1        1        /*M* XUF$FORMAT - PL6 CALLABLE OUTPUT FORMATTING ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        XUF$FORMAT: PROC(FDS);

      8  2 000000   000000 700200 xent  XUF$FORMAT   TSX0  ! X66_AUTO_1
         2 000001   000200 000001                    ZERO    128,1
         2 000002   000005 710000 2                  TRA     s:6226

        9        9        /*P*    NAME:    XUF$FORMAT
       10       10                PURPOSE: Provide for formatted writes in PL-6.             */
       11       11        /*D*    NAME:    XUF$FORMAT
       12       12                CALL:    CALL XUF$FORMAT(F_FDS);
       13       13                            or
       14       14                         CALL X$FORMAT(F_FDS);
       15       15                            or
       16       16                         CALL X$WRITE(FDS,VECTOR(FMT)[,DV1[,DV2[,DV3[,...]]]]);
       17       17
       18       18                         For the X$WRITE call each DVn is a data vector up to
       19       19                         a maximum of DV20.  To access X$WRITE:
       20       20                         DCL X$WRITE EPTR SYMREF;
       21       21
       22       22                INPUT:   Format Data Structure (FDS) which contains the
       23       23                         parameters describing the formatting operation.
       24       24                         The FDS strucure is in the F_FDS macro in the
       25       25                         include file XU_FORMAT_C.  The FDS parameters are:
       26       26
       27       27                Parameter   FDS name           Description
       28       28                ----------- ------------------ ------------------------------
       29       29                FMT         FDS.FMT_           Vector framing the format.
       30       30                            FDS.FMT_.BOUND
       31       31                            FDS.FMT_.FMT$
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:16   
       32       32                BUF         FDS.BUF_           Vector framing output buffer.
       33       33                            FDS.BUF_.BOUND
       34       34                            FDS.BUF_.BUF$
       35       35                NVECS       FDS.NVECS#         Number of data vectors.
       36       36                VECTR       FDS.VECTR$         Pointer to array of data
       37       37                                               vectors.
       38       38                DCB         FDS.DCB#           Output DCB.
       39       39                DVFC        FDS.DVFC#          Default VFC character.
       40       40                TRUNC       FDS.TRUNC#         If YES then output lines are
       41       41                                               truncated at the buffer size.
       42       42                                               If NO then the buffer is output
       43       43                                               if it fills up, then more
       44       44                                               characters are shoveled in.
       45       45                WRAPTAB     FDS.WRAPTAB#       Column to tab to after wrapping
       46       46                                               a line.
       47       47                TABDFLT     FDS.TABDFLT#       Magic number used to calculate
       48       48                                               next column to tab to for the
       49       49                                               '-' insertion code when CNT(0)=0.
       50       50                EDIT        FDS.EDIT#          ENTADDR of user supplied field
       51       51                                               editting routine.  For more
       52       52                                               information see description of
       53       53                                               %E insertion code.
       54       54                OUTPUT      FDS.OUTPUT#        ENTADDR of user supplied output
       55       55                                               routine.  This routine will be
       56       56                                               called whenever the buffer is
       57       57                                               to be output with the call:
       58       58                                               CALL OUTPUT(FPT_WRITE.BUF_,FDS);
       59       59                                               This call is made before the
       60       60                                               call to M$WRITE.  If the OUTPUT
       61       61                                               routine ALTRETURNS then the call
       62       62                                               to M$WRITE is skipped.
       63       63
       64       64                For more information on the FDS look at the F_FDS macro.
       65       65
       66       66                DESCRIPTION:   Characters are copied from the format to the
       67       67                output buffer until a % character is hit.  The formatting
       68       68                operation then proceeds based on the insertion code that
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:17   
       69       69                follows.  If the insertion code requires data and all data
       70       70                has been used then the formatter returns to the user at
       71       71                this point.  If the end of the format is hit and data remains
       72       72                then the current buffer is output and formatting proceeds
       73       73                from the rescan point (see ^ insertion code).  The detailed
       74       74                operation of the formatter is described under the major
       75       75                concepts that follow.
       76       76
       77       77                Counts
       78       78                ______
       79       79                   There are four values that are set to 0 when the %
       80       80                character is encountered and that may be specified between
       81       81                the % character and the insertion code.  If D is the insertion
       82       82                code then specifying counts would look like %n1.n2.n3.n4D
       83       83                where any n may be omitted.  The significance of the counts
       84       84                depends on the insertion code.  In the descriptions of the
       85       85                insertion codes they will be refered to as CNT(0) - CNT(3).
       86       86                In general if CNT(n) means do something that many times then
       87       87                CNT(n)=0 is the same as CNT(n)=1.
       88       88                   N  Obtain data for CNT.  If the N is preceeded by a decimal
       89       89                      number greater than 0 and less than 36 then that many
       90       90                      bits of data are obtained for the current CNT.  Other-
       91       91                      wise one word of data is obtained.
       92       92
       93       93                Flags
       94       94                -----
       95       95                   There are several flags that may be specified between the %
       96       96                character and the insertion code.  Again if D is the insertion
       97       97                code and Z is a flag then a flag would be specified as %ZD.
       98       98                The Flags are:
       99       99
      100      100                   Z  Produce leading zeroes.  This flag is significant only
      101      101                      for numeric insertion codes.  If this flag is set and
      102      102                      a number is put in a fixed width field then leading
      103      103                      zeroes will be put in the buffer instead of leading
      104      104                      blanks.
      105      105                   +  Signed number.  This flag is significant only for
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:18   
      106      106                      numeric insertion codes.  If this flag is set then the
      107      107                      data obtained is interpreted as a signed number.  If
      108      108                      it is negative it will be preceeded by a '-' in the
      109      109                      field.  If this flag is not set then the data obtained
      110      110                      is interpreted as positive.
      111      111                   M  Keep most significant digits (characters).  if this
      112      112                      flag is set and the string size exceeds the size
      113      113                      of a fixed width field the the leftmost characters of
      114      114                      the string are shoveled into the field.  If this flag
      115      115                      is not set the rightmost characters are put in the
      116      116                      field.
      117      117                   L  Left justify in field.  If this flag is set and the
      118      118                      string is smaller than the fixed width field then the
      119      119                      field will be filled on the right with blanks.  If
      120      120                      this flag is not set then the field will be filled on
      121      121                      the left with blanks.
      122      122                   <  Delete leading blanks.  If this flag is set then leading
      123      123                      blanks are deleted from the string before it is put
      124      124                      in the output buffer.
      125      125                   >  Delete trailing blanks.  If this flag is set then trailing
      126      126                      blanks are deleted from the string before it is put in
      127      127                      the output buffer.  For the '-' format this flag means
      128      128                      never tab backwards.
      129      129                   *  Insert stars on overflow.  If a numeric value exceeds the
      130      130                      specified field width then insert stars instead of the
      131      131                      truncated value.
      132      132                   &  Check field width.  If the field to be inserted will not
      133      133                      fit on the current line then dump the current line and
      134      134                      start a new one.
      135      135                   @  FEP mode.  The data processed for this insertion code is
      136      136                      assumed to be sparse L6 data with a slack bit at the top
      137      137                      of each byte.  For the S and P insertion codes this will
      138      138                      cause the specified bit values to be multiplied by 9/8.
      139      139                      For numeric insertion codes the slack bits will be
      140      140                      compressed out.  The number of bits specified should not
      141      141                      include slack bits.
      142      142
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:19   
      143      143                Miscellaneous insertion codes
      144      144                -----------------------------
      145      145                   !  Skip to top of form.  The current buffer is output
      146      146                      then an M$DEVICE(PAGE=YES) is issued on DCB.
      147      147                   /  Print CNT(0) lines.  The first line is the current
      148      148                      buffer.  Subsequent lines are blank.
      149      149                   -  Tab to column CNT(0).  If CNT(0) is 0 then tab to the
      150      150                      next multiple of FDS.TABDFLT# plus 1.
      151      151                   %  Put one % character in the buffer.
      152      152                   ^  Set rescan point.  If the end of format is hit and there
      153      153                      is still data remaining then the buffer is output and
      154      154                      the format pointer is set to the rescan point.  The
      155      155                      default is the beginning of the format.  CAUTION:  If
      156      156                      the rescan point is set to be within a repeat group
      157      157                      then strange things will happen.
      158      158                   (  Begin repeat group.  Repeat this section of the format
      159      159                      CNT(0) times.  CNT(0)=0 means skip it.  May be nested
      160      160                      until you run out of auto space.
      161      161                   )  End repeat group.
      162      162                   [  Begin If-Elseif-Endif group.  Format this section if
      163      163                      CNT(0)=CNT(1), until terminated by Elseif (?) or Endif(])
      164      164                      code.  May be nested until you run out of auto space.
      165      165                   ?  Elseif function in If-Elseif-Endif group.   Format this
      166      166                      section if CNT(0) matches the CNT(1) from the corresponding
      167      167                      If-code ([).  If CNT(0) is not specified, the section is
      168      168                      formatted if no match has yet been found (Else function).
      169      169                   ]  Endif of If-Elseif-Endif group.
      170      170                   S  Skip CNT(0) bytes of data plus CNT(1) bits of data.  If
      171      171                      both CNT(0) and CNT(1) are zero and data pointer is not
      172      172                      positioned to the beginning of a data vector then skip
      173      173                      to the next data vector.  If the CNT fields exceed the
      174      174                      size of the current data vector the results are
      175      175                      unpredictable.
      176      176                   R  Reserve buffer space.  Dumps current buffer if it is not
      177      177                      empty and there are not at least CNT(0) bytes remaining
      178      178                      in the output buffer.
      179      179                   Q  Quit processing format if no data remains.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:20   
      180      180                   P  Position data pointer to word CNT(1), character CNT(2),
      181      181                      bit CNT(3) of data vector CNT(0).  If CNT(0)=0 then
      182      182                      positioning is from the beginning of the current data
      183      183                      vector.  Data vectors are numbered 1 through NVECS.
      184      184                   V  Set VFC character.  This next character in the format
      185      185                      is put in character 0 of the buffer unless it is a %
      186      186                      character, in which case one byte of data is obtained
      187      187                      for the VFC character.
      188      188                   X  Insert a space CNT(0) times.  CNT(0) may usefully be
      189      189                      negative, which erases the end of the current output line.
      190      190                   U  Convert UTS to time and date.  CNT(0) is the field width.
      191      191                      CNT(1) is number of bits of data to aquire for UTS, default
      192      192                      is 36.  CNT(2) is output format and has the following
      193      193                      values:
      194      194                         0 - HH:MM             (Time only)
      195      195                         1 - MM/DD/YY          (Date only)
      196      196                         2 - HH:MM MM/DD/YY    (Time and date)
      197      197                         3 - MM/DD/YY HH:MM    (Date and time)
      198      198                      The values 4 - 7 correspond with 0 - 3 except the system
      199      199                      clock is used as the source of the UTS instead of aquiring
      200      200                      data.  CNT(3) is the M$TIME format and has the following
      201      201                      values:
      202      202                         0 - M$TIME LOCAL format.
      203      203                         1 - M$TIME EXT format.
      204      204                         2 - M$TIME ANS format.
      205      205                         3 - Unused.
      206      206                      Values 4 -7 correspond with 0 - 3 except HH:MM becomes
      207      207                      HH:MM:SS.  Values 8 - 11 correspond with 0 - 3 except
      208      208                      HH:MM becomes HH:MM:SS.SS.
      209      209                   J  Convert standard error code.  CNT(0) is field width.
      210      210                      CNT(1) is number of bits of data to aquire for error
      211      211                      code.
      212      212                   F  Special formats.  Format is determined by the value of
      213      213                      CNT(1).  Currently defined values are:
      214      214                         1  Aquire two words of data and format as a descriptor.
      215      215                            CNT(0) is field width.
      216      216                         2  Aquire one word of data and format as a pointer.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:21   
      217      217                            CNT(0) is field width.
      218      218                         3  Aquire one word of data and use it as a dcb number
      219      219                            in a call to M$UNFID.  The resultant fid is placed
      220      220                            in the output buffer.  CNT(0) is field width.
      221      221                         4  Aquire one word of data and use it as a dcb number.
      222      222                            The associated dcb name is placed into the output
      223      223                            buffer.  CNT(0) is field width.
      224      224                   E  Call edit routine.  If FDS.EDIT# is not ENTADDR(NIL)
      225      225                      then CALL FDS.EDIT#(FDS,CNT).  Where FDS is the current
      226      226                      FDS and CNT is the array of counts described earlier.
      227      227                      If the edit routine altrets the formatter will remain
      228      228                      in the insertion mode.  A normal return will cause the
      229      229                      formatter to begin looking for the next % character.
      230      230                      The edit routine may wish to examine the format string
      231      231                      and possibly alter the point at which fht formatter
      232      232                      resumes scanning it.  Such a need is accomplished by means of
      233      233                      the FDS fields FMTX, FMT_.FMT$, and FMT_.BOUND or FMTSIZE.
      234      234                      SUBSTR(FMT_.FMT$->char(FMTSIZE),FMTX-1,1) is the 'E' that
      235      235                      caused the edit routine to be called.  On return, FMTX
      236      236                      should be set to index the next character to be scanned.
      237      237
      238      238                Numeric insertion codes.
      239      239                ------------------------
      240      240                   The numeric insertion codes cause data to be obtained,
      241      241                converted to a text string and placed in the output buffer.
      242      242                CNT(0) specifies the width of the field in the output buffer.
      243      243                CNT(0)=0 means a variable width field, i.e. the field will be
      244      244                wide enough to contain the text string.  CNT(1) specifies
      245      245                the number of bits of data to be obtained.  If CNT(1) is
      246      246                larger than 36 then 36 bits of data are obtained.  If CNT(1)
      247      247                is zero then 36 bits or the remainder of the current data
      248      248                vector, whichever is smaller, are obtained.
      249      249
      250      250                   D  Convert to decimal number.
      251      251                   O  Convert to octal number.
      252      252                   B  Convert to binary number.
      253      253                   H  Convert to hexidecimal number.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:22   
      254      254                   Y  Convert to hexidecimal number in 8 of 9 format.
      255      255
      256      256                Examples:
      257      257                   Data        Format          Result
      258      258                   ----------- --------------- --------------------------
      259      259                   100         .%D.            .100.
      260      260                   100         .%5D.           .  100.
      261      261                   100         .%5ZD.          .00100.
      262      262                   100         .%5LD.          .100  .
      263      263                   '777'O      .%H.            .1FF.
      264      264                   '777'O      .%Y.            .FF.
      265      265                   '777063'O   .%Y.            .FF33.
      266      266                   -100        .%D.            .68719476636.
      267      267                   -100        .%+D.           .-100.
      268      268                   -100        .%5+D.          . -100.
      269      269                   -100        .%5+LD.         .-100 .
      270      270                   -100        .%5+ZD.         .-0100.
      271      271
      272      272                Character insertion codes
      273      273                -------------------------
      274      274                   A  Insert CNT(1) characters into field CNT(0) characters
      275      275                      wide.  Default for CNT(1) is value of CNT(0).  If
      276      276                      CNT(1)=0 or exceeds the length of the current data vector
      277      277                      then the remainder of the current data vector is used.
      278      278                   T  The current data pointer is assumed to point to a
      279      279                      TEXTC string which is to be moved into a field CNT(0)
      280      280                      characters wide according to the setting of the L and
      281      281                      M flags.  CNT(0)=0 means move the entire string.
      282      282
      283      283                Note: When obtaining numeric data, bits are picked up
      284      284                      beginning at the current data pointer.  For character
      285      285                      data the data pointer is first aligned to the next
      286      286                      character boundary.
      287      287                                                                           */
      288      288        %EJECT;
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:23   
      289      289        %INCLUDE XU_FORMAT_C;
      290      451        %INCLUDE CP_6;
      291     6010        %F_FDS (NAME=FDS,STCLASS="");
      292     6123    1   DCL FMT CHAR(FDS.FMTSIZE) BASED(FDS.FMT_.FMT$);
      293     6124    1   DCL XUF$FORMAT1 ENTRY(1);
      294     6125        %FPT_DEVICE (FPTN=FPT_DEVICE,PAGE=YES,STCLASS=CONSTANT);
      295     6143        %FPT_DEVICE (FPTN=DEVICEFPT,STCLASS=AUTO);
      296     6161        %FPT_WRITE (VFC=YES,STCLASS=CONSTANT);
      297     6192        %FPT_WRITE (FPTN=WRITEFPT,STCLASS=AUTO);
      298     6223    1   DCL GLOBAL(0:99) UBIN;
      299     6224        %EJECT;
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:24   
      300     6225    1   X$FORMAT: ENTRY(FDS);

   6225  2 000003   000000 700200 xent  X$FORMAT     TSX0  ! X66_AUTO_1
         2 000004   000200 000001                    ZERO    128,1

      301     6226    1           FDS.DONT_PRINT = '0'B;

   6226  2 000005   200003 470500                    LDP0    @FDS,,AUTO
         2 000006   000000 236000 3                  LDQ     0
         2 000007   000013 356100                    ANSQ    11,,PR0

      302     6227    1           FDS.FMTX=0;

   6227  2 000010   000002 450100                    STZ     2,,PR0

      303     6228    1           FDS.FMTXMAX=0;

   6228  2 000011   000003 450100                    STZ     3,,PR0

      304     6229    1           FDS.FMTSIZE=FDS.FMT_.BOUND+1;

   6229  2 000012   000000 236100                    LDQ     0,,PR0
         2 000013   000020 772000                    QRL     16
         2 000014   000001 036007                    ADLQ    1,DL
         2 000015   000004 756100                    STQ     4,,PR0

      305     6230    1           FDS.BUFSIZE=FDS.BUF_.BOUND+1;

   6230  2 000016   000005 236100                    LDQ     5,,PR0
         2 000017   000020 772000                    QRL     16
         2 000020   000001 036007                    ADLQ    1,DL
         2 000021   000010 756100                    STQ     8,,PR0

      306     6231    1           IF FDS.FMTSIZE > 1

   6231  2 000022   000004 235100                    LDA     4,,PR0
         2 000023   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:25   
         2 000024   000045 604400 2                  TMOZ    s:6244

      307     6232    2           THEN DO;

      308     6233    2              IF SUBSTR(FMT,0,2) = '%\'

   6233  2 000025   000001 471500                    LDP1    1,,PR0
         2 000026   000004 720100                    LXL0    4,,PR0
         2 000027   040000 106500                    CMPC    fill='040'O
         2 000030   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         2 000031   000026 000002 1                  ADSC9   FPT_WRITE+12             cn=0,n=2
         2 000032   000040 601000 2                  TNZ     s:6239

      309     6234    3              THEN DO;

      310     6235    3                 FDS.DONT_PRINT = '1'B;

   6235  2 000033   000040 236007                    LDQ     32,DL
         2 000034   000013 256100                    ORSQ    11,,PR0

      311     6236    3                 FDS.FMTX = 2;

   6236  2 000035   000002 235007                    LDA     2,DL
         2 000036   000002 755100                    STA     2,,PR0

      312     6237    3                 END;

   6237  2 000037   000051 710000 2                  TRA     s:6247

      313     6238    3              ELSE DO;

      314     6239    3                 FDS.BUFX = 1;

   6239  2 000040   000001 235007                    LDA     1,DL
         2 000041   000007 755100                    STA     7,,PR0

      315     6240    3                 FDS.BLNKBUF = '1'B;
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:26   

   6240  2 000042   000100 236007                    LDQ     64,DL
         2 000043   000013 256100                    ORSQ    11,,PR0

      316     6241    3                 END;

      317     6242    2              END;

   6242  2 000044   000051 710000 2                  TRA     s:6247

      318     6243    2           ELSE DO;

      319     6244    2              FDS.BUFX = 1;

   6244  2 000045   000001 235007                    LDA     1,DL
         2 000046   000007 755100                    STA     7,,PR0

      320     6245    2              FDS.BLNKBUF = '1'B;

   6245  2 000047   000100 236007                    LDQ     64,DL
         2 000050   000013 256100                    ORSQ    11,,PR0

      321     6246    2              END;

      322     6247    1           FDS.WRAP='0'B;

   6247  2 000051   000001 236000 3                  LDQ     1
         2 000052   000013 356100                    ANSQ    11,,PR0

      323     6248    1           FDS.RESCAN=0;

   6248  2 000053   000020 450100                    STZ     16,,PR0

      324     6249    1           FDS.MEMX=-1;

   6249  2 000054   000001 335007                    LCA     1,DL
         2 000055   000026 755100                    STA     22,,PR0
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:27   

      325     6250    1           DEVICEFPT=FPT_DEVICE;

   6250  2 000056   000100 100400                    MLR     fill='000'O
         2 000057   000000 000050 1                  ADSC9   FPT_DEVICE               cn=0,n=40
         2 000060   200004 000050                    ADSC9   DEVICEFPT,,AUTO          cn=0,n=40

      326     6251    1           DEVICEFPT.V_=VECTOR(DEVICEFPT.V);

   6251  2 000061   000002 235000 3                  LDA     2
         2 000062   200176 452500                    STP2    GLOBAL+100,,AUTO
         2 000063   200176 236100                    LDQ     GLOBAL+100,,AUTO
         2 000064   000012 036003                    ADLQ    10,DU
         2 000065   200004 757100                    STAQ    DEVICEFPT,,AUTO

      327     6252    1           FDS.DEVICEFPT$=ADDR(DEVICEFPT);

   6252  2 000066   200004 631500                    EPPR1   DEVICEFPT,,AUTO
         2 000067   000030 451500                    STP1    24,,PR0

      328     6253    1           WRITEFPT=FPT_WRITE;

   6253  2 000070   000100 100400                    MLR     fill='000'O
         2 000071   000012 000060 1                  ADSC9   FPT_WRITE                cn=0,n=48
         2 000072   200016 000060                    ADSC9   WRITEFPT,,AUTO           cn=0,n=48

      329     6254    1           WRITEFPT.V_=VECTOR(WRITEFPT.V);

   6254  2 000073   000002 235000 3                  LDA     2
         2 000074   200176 452500                    STP2    GLOBAL+100,,AUTO
         2 000075   200176 236100                    LDQ     GLOBAL+100,,AUTO
         2 000076   000026 036003                    ADLQ    22,DU
         2 000077   200016 757100                    STAQ    WRITEFPT,,AUTO

      330     6255    1           FDS.WRITEFPT$=ADDR(WRITEFPT);

   6255  2 000100   200016 631500                    EPPR1   WRITEFPT,,AUTO
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:28   
         2 000101   000031 451500                    STP1    25,,PR0

      331     6256    1           GLOBAL = '0'B;

   6256  2 000102   000100 100400                    MLR     fill='000'O
         2 000103   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000104   200032 000620                    ADSC9   GLOBAL,,AUTO             cn=0,n=400

      332     6257    1           FDS.GLOBAL$ = ADDR(GLOBAL);

   6257  2 000105   200032 631500                    EPPR1   GLOBAL,,AUTO
         2 000106   000032 451500                    STP1    26,,PR0

      333     6258    1           REMEMBER XIT IN FDS.BAILOUT;

   6258  2 000107   000116 635000 2                  EAA     XIT
         2 000110   000021 452500                    STP2    17,,PR0
         2 000111   000022 755100                    STA     18,,PR0

      334     6259    1           CALL XUF$FORMAT1 (FDS);

   6259  2 000112   200003 630500                    EPPR0   @FDS,,AUTO
         2 000113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000114   000000 701000 xent               TSX1    XUF$FORMAT1
         2 000115   000000 011000                    NOP     0

      335     6260    1   XIT:    RETURN;

   6260  2 000116   000000 702200 xent  XIT          TSX2  ! X66_ARET
      336     6261    1   END XUF$FORMAT;
      337     6262        %EOD;

PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:29   
--  Include file information  --

   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUF$FORMAT.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:30   

 **** Variables and constants ****

  ****  Section 001 RoData XUF$FORMAT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(360)   r     1 FPT_DEVICE                12-0-0/d STRC(432)   r     1 FPT_WRITE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FDS                       4-0-0/d STRC(360)   r     1 DEVICEFPT
    *0-0-0/w STRC(1080)  r     1 FDS                       32-0-0/w UBIN        r     1 GLOBAL(0:99)
    16-0-0/d STRC(432)   r     1 WRITEFPT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 FMT


   Procedure XUF$FORMAT requires 79 words for executable code.
   Procedure XUF$FORMAT requires 128 words of local(AUTO) storage.
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:31   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:32   
          MINI XREF LISTING

DEVICEFPT
      6154**DCL      6250<<ASSIGN   6252--ASSIGN
DEVICEFPT.V
      6155**DCL      6251--ASSIGN
DEVICEFPT.V_
      6154**DCL      6251<<ASSIGN
FDS
      6024**DCL         8--PROC     6225--ENTRY    6259<>CALL
FDS.BAILOUT
      6096**DCL      6258<<REMEMBR
FDS.BLNKBUF
      6071**DCL      6240<<ASSIGN   6245<<ASSIGN
FDS.BUFSIZE
      6050**DCL      6230<<ASSIGN
FDS.BUFX
      6048**DCL      6239<<ASSIGN   6244<<ASSIGN
FDS.BUF_.BOUND
      6042**DCL      6230>>ASSIGN
FDS.DEVICEFPT$
      6108**DCL      6252<<ASSIGN
FDS.DONT_PRINT
      6073**DCL      6226<<ASSIGN   6235<<ASSIGN
FDS.FMTSIZE
      6039**DCL      6123--IMP-SIZ  6229<<ASSIGN   6231>>IF       6233>>IF
FDS.FMTX
      6035**DCL      6227<<ASSIGN   6236<<ASSIGN
FDS.FMTXMAX
      6037**DCL      6228<<ASSIGN
FDS.FMT_.BOUND
      6029**DCL      6229>>ASSIGN
FDS.FMT_.FMT$
      6031**DCL      6123--IMP-PTR  6233>>IF
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:33   
FDS.GLOBAL$
      6112**DCL      6257<<ASSIGN
FDS.MEMX
      6104**DCL      6249<<ASSIGN
FDS.RESCAN
      6094**DCL      6248<<ASSIGN
FDS.WRAP
      6075**DCL      6247<<ASSIGN
FDS.WRITEFPT$
      6110**DCL      6255<<ASSIGN
FMT
      6123**DCL      6233>>IF
FPT_DEVICE
      6136**DCL      6250>>ASSIGN
FPT_DEVICE.V
      6137**DCL      6136--DCLINIT
FPT_WRITE
      6178**DCL      6253>>ASSIGN
FPT_WRITE.STATION_
      6180**DCL      6180--REDEF
FPT_WRITE.V
      6181**DCL      6178--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      6187**DCL      6187--REDEF
GLOBAL
      6223**DCL      6256<<ASSIGN   6257--ASSIGN
WRITEFPT
      6209**DCL      6253<<ASSIGN   6255--ASSIGN
WRITEFPT.STATION_
      6211**DCL      6211--REDEF
WRITEFPT.V
      6212**DCL      6254--ASSIGN
WRITEFPT.V.DVBYTE.VFC#
      6218**DCL      6218--REDEF
WRITEFPT.V_
      6209**DCL      6254<<ASSIGN
PL6.E3A0      #001=XUF$FORMAT File=XUF$FORMAT.:E05TSI                            WED 07/30/97 09:15 Page:34   
XIT
      6260**LABEL    6258--REMEMBR
XUF$FORMAT1
      6124**DCL-ENT  6259--CALL

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:35   
      338        1        /*T***********************************************************/
      339        2        /*T*                                                         */
      340        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      341        4        /*T*                                                         */
      342        5        /*T***********************************************************/
      343        6        XUF$FORMAT1: PROC (FDS);
      344        7
      345        8        %INCLUDE XU_FORMAT_C;
      346      170        %F_FDS (NAME=FDS,STCLASS="");
      347      283        /**/
      348      284    1   DCL XUF$DESC ENTRY(3);
      349      285    1   DCL XUF$PTR ENTRY(3);
      350      286    1   DCL XUF$ERRMSG ENTRY(3);
      351      287    1   DCL XUF$UNFID ENTRY(3);
      352      288        /**/
      353      289    1   DCL BUFFER CHAR(FDS.BUFSIZE) BASED(FDS.BUF_.BUF$);
      354      290    1   DCL FMTX SBIN;
      355      291    1   DCL SAVEFMTX SBIN;
      356      292    1   DCL FMT CHAR(FDS.FMTSIZE) BASED(FDS.FMT_.FMT$);
      357      293    1   DCL 1 MEMVEC(0:0) BASED(FDS.VECTR$),
      358      294    1         2 BOUND UBIN(20) UNAL,
      359      295    1         2 * BIT(16) UNAL,
      360      296    1         2 PTR$ PTR;
      361      297    1   DCL LOOPING BIT(1) ALIGNED;
      362      298    1   DCL FORMATTING BIT(1) ALIGNED;
      363      299    1   DCL TEMP UBIN;
      364      300    1   DCL STEMP REDEF TEMP SBIN;
      365      301    1   DCL 1 TEMPY(0:3) REDEF TEMP,
      366      302    1         2 * BIT(1),
      367      303    1         2 LH UBIN(4) UNAL,
      368      304    1         2 RH UBIN(4) UNAL;
      369      305    1   DCL 1 TEMPB REDEF TEMP,
      370      306    1         2 REST UBIN(35) UNAL,
      371      307    1         2 LSB UBIN(1) UNAL;
      372      308    1   DCL 1 TEMPO REDEF TEMP,
      373      309    1         2 REST UBIN(33) UNAL,
      374      310    1         2 LSD UBIN(3) UNAL;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:36   
      375      311    1   DCL 1 TEMPX REDEF TEMP,
      376      312    1         2 REST UBIN(32) UNAL,
      377      313    1         2 LSD UBIN(4) UNAL;
      378      314    1   DCL 1 FLAGS ALIGNED,
      379      315    1         2 LZ BIT(1),
      380      316    1         2 LJ BIT(1),
      381      317    1         2 SIGN BIT(1),
      382      318    1         2 MSD BIT(1),
      383      319    1         2 DTB BIT(1),
      384      320    1         2 DLB BIT(1),
      385      321    1         2 STAR BIT(1),
      386      322    1         2 FIELD BIT(1),
      387      323    1         2 L6 BIT(1),
      388      324    1         2 ARITH BIT(1),
      389      325    1         2 CNT1 BIT(1);
      390      326        %EQU FLG_ARITH='0004'O;
      391      327        %EQU FLG_CNT1='0002'O;
      392      328        %EQU FLG_LZ='400'O;
      393      329        %EQU FLG_LJ='200'O;
      394      330        %EQU FLG_SIGN='100'O;
      395      331        %EQU FLG_MSD='040'O;
      396      332        %EQU FLG_DTB='020'O;
      397      333        %EQU FLG_DLB='010'O;
      398      334        %EQU FLG_STAR='004'O;
      399      335        %EQU FLG_FIELD='002'O;
      400      336        %EQU FLG_L6='001'O;
      401      337    1   DCL CNT(0:3) SBIN;
      402      338    1   DCL CNTB(0:3) REDEF CNT BIT(36);
      403      339    1   DCL CNTX SBIN;
      404      340    1   DCL SAVCNT SBIN;
      405      341    1   DCL SAVCNTB REDEF SAVCNT BIT(36);
      406      342    1   DCL CODE SBIN;
      407      343    1   DCL CODEVEC CHAR(0) CONSTANT
      408      344    1   INIT('0123456789.^/-%()SQPNV!ATZL+MDYOBHEX<>UJ*F&R\@[?]:C=#K|');
      409      345        /* Unused codes are "',;GIW_abcdefghijklmnopqrstuvwxyz{}~ */
      410      346    1   DCL CONTCHARS CHAR(0) CONSTANT INIT('0123456789:N.ZL+M<>*&K#@');
      411      347    1   DCL ARTHCHARS CHAR(0) CONSTANT INIT('+-*/&|\=?<>');
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:37   
      412      348    1   DCL I SBIN;
      413      349    1   DCL PERCENT SBIN;
      414      350    1   DCL MEM$ PTR;
      415      351    1   DCL SIGNC CHAR(1) ALIGNED;
      416      352    1   DCL DBUF CHAR(80);            /* 80 and 37 is 120, big enough for M$ERRMSG */
      417      353    1   DCL NUMBUF CHAR(37) ALIGNED;
      418      354    1   DCL STARS CHAR(37) CONSTANT INIT('*************************************');
      419      355    1   DCL ZEROES CHAR(37) CONSTANT INIT('0000000000000000000000000000000000000');
      420      356    1   DCL CONTAB CHAR(0) CONSTANT INIT('0123456789ABCDEF');
      421      357    1   DCL BLANKS CHAR(4) CONSTANT ALIGNED INIT(' ');
      422      358    1   DCL X SBIN;
      423      359    1   DCL FSIG SBIN;
      424      360    1   DCL DWID SBIN;
      425      361    1   DCL TWID SBIN;
      426      362    1   DCL 1 ERRCD ALIGNED,
      427      363    1         2 FCG(0:2) UBIN(6) UNAL,
      428      364    1         2 MON BIT(1),
      429      365    1         2 CODE UBIN(14) UNAL,
      430      366    1         2 SEV UBIN(3) UNAL;
      431      367    1   DCL DSIZ SBIN;
      432      368    1   DCL 1 DESC,
      433      369    1         2 W0 UBIN,
      434      370    1         2 W1 UBIN;
      435      371    1   DCL ONECHAR CHAR(1) BASED;
      436      372    1   DCL ONEBIT BIT(1) BASED UNAL;
      437      373        /**/
      438      374        %SUB NEVER="WHILE('0'B)";
      439      375        %SUB FOREVER="WHILE('1'B)";
      440      376        %INCLUDE B$TABLES_C;
      441      484        %INCLUDE CP_6;
      442     6043        %INCLUDE CP_6_SUBS;
      443     6583        %B$SR_NON_BLANK (NAME=SEARCHNB);
      444     6587        %B$XL_ASC_DUMP (NAME=ASC_DUMP);
      445     6591        %B$XL_EBC_DUMP (NAME=EBC_DUMP);
      446     6595        %F$DCB;
      447     6652        %FPT_DEVICE (FPTN=FPT$DEVICE,STCLASS="BASED(FDS.DEVICEFPT$)");
      448     6670        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS="BASED(FDS.WRITEFPT$)");
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:38   
      449     6701        %FPT_TIME (FPTN=FPT_TIME,STCLASS=CONSTANT);
      450     6720        %FPT_TIME (FPTN=FPT$TIME,STCLASS=AUTO);
      451     6739    1   DCL DATEWIDTH(0:11) UBIN BYTE CALIGNED CONSTANT INIT(8,10,6,0,8,10,6,0,8,10,6,0);
      452     6740    1   DCL TIMEWIDTH(0:11) UBIN BYTE CALIGNED CONSTANT INIT(5,5,4,0,8,8,6,0,11,11,8,0);
      453     6741    1   DCL TIMEDEST(0:3) UBIN BYTE CALIGNED CONSTANT INIT(%LOCAL#,%EXT#,%ANS#,0);
      454     6742    1   DCL STR_DUMP(0:511) UBIN BYTE CALIGNED CONSTANT INIT (
      455     6743    1     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
      456     6744    1    20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
      457     6745    1    40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,
      458     6746    1    60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79,
      459     6747    1    80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99,
      460     6748    1   100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,
      461     6749    1   120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,
      462     6750    1   140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,
      463     6751    1   160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,
      464     6752    1   180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,
      465     6753    1   200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,
      466     6754    1   220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
      467     6755    1   240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,
      468     6756    1   260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,
      469     6757    1   280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,
      470     6758    1   300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,
      471     6759    1   320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,
      472     6760    1   340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,
      473     6761    1   360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,
      474     6762    1   380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,
      475     6763    1   400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,
      476     6764    1   420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,
      477     6765    1   440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,
      478     6766    1   460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,
      479     6767    1   480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,
      480     6768    1   500,501,502,503,504,505,506,507,508,509,510,511);
      481     6769    1   DCL TRANS$ PTR;
      482     6770    1   DCL TRANS CHAR(512) ALIGNED BASED( TRANS$);
      483     6771    1   DCL 1 G BASED(FDS.GLOBAL$) ALIGNED,
      484     6772    1         2 INDX(0:99) SBIN;           /* OFFSETS FOR SUBROUTINES AND VARIABLES */
      485     6773        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:39   
      486     6774    1           IF FDS.MEMX<0 THEN CALL SETMEM(0,0);
      487     6775    1           TRANS$ = ADDR( STR_DUMP);
      488     6776    1           FMTX=FDS.FMTX;
      489     6777    2           IF FDS.DEBUG THEN DO;
      490     6778    2              DBUF=%CONCAT(BITASC('037'O),'Level-00 Entry');
      491     6779    2              CALL BINCHAR(SUBSTR(DBUF,7,2),POFFW(ADDR(SAVEFMTX),FDS.GLOBAL$)/106);
      492     6780    2              PERCENT=FMTX+1;
      493     6781    2              CALL DEBUG_OUT;
      494     6782    2              END;
      495     6783    1           SAVEFMTX=FDS.FMTXMAX;
      496     6784    1           LOOPING='1'B;
      497     6785    2           DO WHILE(LOOPING);
      498     6786    2              FLAGS=%FLG_MSD;
      499     6787    2              SIGNC=' ';
      500     6788    2              CALL INDEX (PERCENT,'%',FMT,FMTX) ALTRET(END_FMT);
      501     6789    3              DO NEVER;
      502     6790    3   END_FMT:      PERCENT=FDS.FMTSIZE;
      503     6791    3                 LOOPING='0'B;
      504     6792    3                 END;
      505     6793    2              IF PERCENT>FMTX THEN
      506     6794    2                 CALL FIELD(SUBSTR(FMT,FMTX),PERCENT-FMTX,PERCENT-FMTX);
      507     6795    2              FORMATTING=LOOPING;
      508     6796    2              FMTX=PERCENT;
      509     6797    2              FLAGS='0'B;
      510     6798    2              CNT='0'B;
      511     6799    2              CNTX=0;
      512     6800    3              DO WHILE(FORMATTING);
      513     6801    3                 FMTX=FMTX+1;
      514     6802    3                 CALL INDEX (CODE,SUBSTR(FMT,FMTX,1),CODEVEC) ALTRET(BAD_CODE);
      515     6803    4                 DO CASE(CODE);
      516     6804    4                  CASE(0,1,2,3,4,5,6,7,8,9);
      517     6805    4                    CNT(CNTX)=CNT(CNTX)*10+CODE;
      518     6806    4   /* . */        CASE(10);
      519     6807    4                    CNTX=CNTX+1;
      520     6808    4   /* ^ */        CASE(11);
      521     6809    4                    FDS.RESCAN=FMTX+1;
      522     6810    4                    FORMATTING='0'B;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:40   
      523     6811    4   /* / */        CASE(12);
      524     6812    5                    IF FLAGS.ARITH THEN DO;
      525     6813    5                       CNT(CNTX) = SAVCNT/CNT(CNTX);
      526     6814    5                       GOTO ARITH_DONE;
      527     6815    5                       END;
      528     6816    4                    CALL BUF_OUT;
      529     6817    5                    DO I=2 TO CNT(0);
      530     6818    5                       CALL BUF_OUT;
      531     6819    5                       END;
      532     6820    4                    FORMATTING='0'B;
      533     6821    4   /* - */        CASE(13);
      534     6822    5                    IF FLAGS.ARITH THEN DO;
      535     6823    5                       CNT(CNTX) = SAVCNT-CNT(CNTX);
      536     6824    5                       GOTO ARITH_DONE;
      537     6825    5                       END;
      538     6826    4                    IF CNT(1)>0 THEN FDS.TABDFLT#=CNT(1);
      539     6827    4                    IF CNT(2)>0 THEN FDS.WRAPTAB#=CNT(2);
      540     6828    4                    IF FDS.BLNKBUF THEN CALL BLANKBUF;
      541     6829    5                    IF CNT(0)>0 THEN DO;
      542     6830    5                       IF FLAGS.DTB AND CNT(0)<FDS.BUFX THEN
      543     6831    5                          I=FDS.BUFX+1;
      544     6832    5                       ELSE
      545     6833    5                          I=CNT(0);
      546     6834    5                       END;
      547     6835    4                    ELSE I=FDS.BUFX+FDS.TABDFLT#+1-MOD(FDS.BUFX-1,FDS.TABDFLT#)-1;
      548     6836    5                    IF I>FDS.BUF_.BOUND THEN DO;
      549     6837    6                       IF FDS.TRUNC# THEN DO;
      550     6838    6                          I=FDS.BUF_.BOUND+1;
      551     6839    6                          END;
      552     6840    6                       ELSE DO;
      553     6841    6                          CALL BUF_OUT;
      554     6842    6                          I=1;
      555     6843    6                          END;
      556     6844    5                       END;
      557     6845    4                    FDS.BUFX=I;
      558     6846    4                    FORMATTING='0'B;
      559     6847    4   /* % */        CASE(14);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:41   
      560     6848    4                    CALL FIELD('%',1,1);
      561     6849    4                    FORMATTING='0'B;
      562     6850    4   /* ( */        CASE(15);
      563     6851    5                    IF CNT(0)<=0 THEN DO;
      564     6852    5                       I=1;
      565     6853    6                       DO UNTIL(I=0);
      566     6854    6                          CALL INDEX (FMTX,'%',FMT,FMTX+1) ALTRET(BAD_FMT);
      567     6855    7                          DO WHILE '1'B;
      568     6856    7                             FMTX=FMTX+1;
      569     6857    7                             IF FMTX>=FDS.FMTSIZE THEN GOTO BAD_FMT;
      570     6858    7                             IF NOT FLAGS.ARITH
      571     6859    7                             THEN CALL INDEX (X,SUBSTR(FMT,FMTX,1),CONTCHARS)
      572     6860    7                                  ALTRET(CHK_OP);
      573     6861    7                             ELSE CALL INDEX (X,SUBSTR(FMT,FMTX,1),ARTHCHARS)
      574     6862    8                                WHENRETURN DO; FLAGS.ARITH='0'B; END;
      575     6863    7                             IF X=10 THEN FLAGS.ARITH='1'B;
      576     6864    7                             END;
      577     6865    6   CHK_OP:                IF SUBSTR(FMT,FMTX,1)='(' THEN
      578     6866    6                             I=I+1;
      579     6867    6                          ELSE IF SUBSTR(FMT,FMTX,1)=')' THEN
      580     6868    6                                I=I-1;
      581     6869    6                          END;
      582     6870    5                       FDS.FMTX=FMTX;
      583     6871    5                       END;
      584     6872    5                    ELSE DO WHILE CNT(0)>0;
      585     6873    5                       FDS.FMTX=FMTX+1;
      586     6874    5                       FDS.FMTXMAX=CODE;
      587     6875    5                       CALL XUF$FORMAT1(FDS);
      588     6876    5                       IF FDS.FMTXMAX=CODE THEN CNT(0)=CNT(0)-1;
      589     6877    5                       ELSE IF FDS.FMTXMAX<=0 THEN EXIT;
      590     6878    5                       END;
      591     6879    4                    FMTX=FDS.FMTX;
      592     6880    4                    FORMATTING='0'B;
      593     6881    4   /* ) */        CASE(16);
      594     6882    4                    IF SAVEFMTX~=15 THEN GOTO BAD_FMT; /* ILLEGAL AT LEVEL 0 */
      595     6883    4                    IF FMTX=PERCENT+1 THEN FDS.FMTXMAX=SAVEFMTX;
      596     6884    4                    ELSE FDS.FMTXMAX=MINIMUM(CNT(0),1);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:42   
      597     6885    4                    FDS.FMTX=FMTX;
      598     6886    4                    GOTO DBG_RETURN;
      599     6887    4   /* S */        CASE(17);
      600     6888    5                    IF CNT='0'B OR CNT(0)*9>FDS.MEMSZ THEN DO;
      601     6889    5                       CALL SETMEM(FDS.MEMX+1,0);
      602     6890    5                       END;
      603     6891    5                    ELSE IF CNT(0)~=0 THEN DO;
      604     6892    5                          CALL GETMEM(MEM$,CNT(0));
      605     6893    5                          END;
      606     6894    5                    IF CNT(1)~=0 THEN DO;
      607     6895    5                       IF FLAGS.L6 THEN
      608     6896    5                          I=(CNT(1)*9)/8;
      609     6897    5                       ELSE
      610     6898    5                          I=CNT(1);
      611     6899    5                       CALL SKIPBITS(I);
      612     6900    5                       END;
      613     6901    4                    FORMATTING='0'B;
      614     6902    4   /* Q */        CASE(18);
      615     6903    5                    IF FDS.MEMSZ=0 OR CNT(0)>0 THEN DO;
      616     6904    5                       IF NOT FDS.BLNKBUF AND NOT FDS.DONT_PRINT THEN CALL BUF_OUT;
      617     6905    5                       UNWIND TO FDS.BAILOUT;
      618     6906    5                       END;
      619     6907    4                    FORMATTING='0'B;
      620     6908    4   /* P */        CASE(19);
      621     6909    4                    IF FLAGS.L6 THEN
      622     6910    4                       I=CNT(1)*36+CNT(2)*9+(CNT(3)*9)/8;
      623     6911    4                    ELSE
      624     6912    4                       I=CNT(1)*36+CNT(2)*9+CNT(3);
      625     6913    5                    IF CNT(0)=0 THEN DO;
      626     6914    5                       IF FDS.MEMSZ=(MEMVEC.BOUND(FDS.MEMX)+1)*9 AND FDS.MEMX>0 THEN
      627     6915    5                          CALL SETMEM(FDS.MEMX-1,I);
      628     6916    5                       ELSE IF FDS.MEMSZ=0 AND FDS.NVECS#>0 THEN
      629     6917    5                             CALL SETMEM(FDS.NVECS#-1,I);
      630     6918    5                          ELSE
      631     6919    5                             CALL SETMEM(FDS.MEMX,I);
      632     6920    5                       END;
      633     6921    4                    ELSE
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:43   
      634     6922    4                       CALL SETMEM(CNT(0)-1,I);
      635     6923    4                    FORMATTING='0'B;
      636     6924    4   /* N */        CASE(20);
      637     6925    4                    CALL GETVAL(CNT(CNTX),CNT(CNTX)) ALTRET(NO_MEM);
      638     6926    4   /* V */        CASE(21);
      639     6927    5                    IF SUBSTR(FMT,FMTX+1,1)='%' THEN DO;
      640     6928    5                       CALL GETMEM(MEM$,1);
      641     6929    5                       END;
      642     6930    5                    ELSE DO;
      643     6931    5                       MEM$=ADDR(SUBSTR(FMT,FMTX+1,1));
      644     6932    5                       END;
      645     6933    4                    FMTX=FMTX+1;
      646     6934    4                    IF FDS.BLNKBUF THEN CALL BLANKBUF;
      647     6935    4                    CALL INSERT(BUFFER,0,1,MEM$->ONECHAR);
      648     6936    4                    FORMATTING='0'B;
      649     6937    4   /* ! */        CASE(22);
      650     6938    4                    IF NOT FDS.BLNKBUF THEN CALL BUF_OUT;
      651     6939    5                    IF FDS.DCB#~=DCBNUM(NIL) THEN DO;
      652     6940    5                       FPT$DEVICE.V.DCB#=FDS.DCB#;
      653     6941    5                       CALL M$DEVICE(FPT$DEVICE);
      654     6942    5                       END;
      655     6943    4                    FORMATTING='0'B;
      656     6944    4   /* A */        CASE(23);
      657     6945    4                    IF CNTX=0 THEN CNT(1)=CNT(0);
      658     6946    5                    IF FLAGS.CNT1 THEN DO;
      659     6947    5                       I=4;
      660     6948    5                       MEM$=ADDR(CNT(1));
      661     6949    5                       END;
      662     6950    5                    ELSE DO;
      663     6951    5                       I=FDS.MEMSZ/9;
      664     6952    5                       IF CNT(1)>0 AND CNT(1)<I THEN I=CNT(1);
      665     6953    5                       CALL GETMEM(MEM$,I) ALTRET(NO_MEM);
      666     6954    5                       END;
      667     6955    4                    IF CNT(2)=1 THEN TRANS$=ADDR(ASC_DUMP);
      668     6956    4                    ELSE IF CNT(2)=2 THEN TRANS$=ADDR(EBC_DUMP);
      669     6957    4                    CALL FIELD(MEM$->ONECHAR,I,CNT(0));
      670     6958    4                    FORMATTING='0'B;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:44   
      671     6959    4                    TRANS$ = ADDR(STR_DUMP);
      672     6960    4   /* T */        CASE(24);
      673     6961    4                    CALL GETVAL(I,9) ALTRET(NO_MEM);
      674     6962    4                    CALL GETMEM(MEM$,I) ALTRET(NO_MEM);
      675     6963    4                    CALL FIELD(MEM$->ONECHAR,I,CNT(0));
      676     6964    4                    FORMATTING='0'B;
      677     6965    4   /* Z */        CASE(25);
      678     6966    4                    FLAGS.LZ='1'B;
      679     6967    4   /* L */        CASE(26);
      680     6968    4                    FLAGS.LJ='1'B;
      681     6969    4   /* + */        CASE(27);
      682     6970    5                    IF FLAGS.ARITH THEN DO;
      683     6971    5                       CNT(CNTX) = SAVCNT+CNT(CNTX);
      684     6972    5                       GOTO ARITH_DONE;
      685     6973    5                       END;
      686     6974    4                    FLAGS.SIGN='1'B;
      687     6975    4   /* M */        CASE(28);
      688     6976    4                    FLAGS.MSD='1'B;
      689     6977    4   /* D */        CASE(29);
      690     6978    4                    CALL GETVAL(TEMP,CNT(1)) ALTRET(NO_MEM);
      691     6979    5                    IF FLAGS.SIGN AND STEMP<0 THEN DO;
      692     6980    5                       SIGNC='-';
      693     6981    5                       CALL BINCHAR(NUMBUF,STEMP);
      694     6982    5                       END;
      695     6983    5                    ELSE DO;
      696     6984    5                       SIGNC=' ';
      697     6985    5                       CALL BINCHAR(NUMBUF,TEMP);
      698     6986    5                       END;
      699     6987    4                    CALL NUMERIC1;
      700     6988    4                    FORMATTING='0'B;
      701     6989    4   /* Y */        CASE(30);
      702     6990    4                    CALL GETVAL(TEMP,CNT(1)) ALTRET(NO_MEM);
      703     6991    4                    NUMBUF='0000000000000000000000000000000000000';
      704     6992    5                    DO I=0 TO 3;
      705     6993    5                       CALL INSERT(NUMBUF,29+I*2,1,SUBSTR(CONTAB,TEMPY.LH(I),1));
      706     6994    5                       CALL INSERT(NUMBUF,30+I*2,1,SUBSTR(CONTAB,TEMPY.RH(I),1));
      707     6995    5                       END;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:45   
      708     6996    4                    CALL NUMERIC1;
      709     6997    4                    FORMATTING='0'B;
      710     6998    4   /* O */        CASE(31);
      711     6999    4                    CALL NUMERIC(8) ALTRET(NO_MEM);
      712     7000    4                    FORMATTING='0'B;
      713     7001    4   /* B */        CASE(32);
      714     7002    4                    CALL NUMERIC(2) ALTRET(NO_MEM);
      715     7003    4                    FORMATTING='0'B;
      716     7004    4   /* H */        CASE(33);
      717     7005    4                    CALL NUMERIC(16) ALTRET(NO_MEM);
      718     7006    4                    FORMATTING='0'B;
      719     7007    4   /* E */        CASE(34);
      720     7008    4                    FDS.FMTX=FMTX+1;
      721     7009    4                    IF FDS.EDIT#~=ENTADDR(NIL) THEN
      722     7010    4                       CALL FDS.EDIT#(FDS,CNT) ALTRET(EDIT_ALT);
      723     7011    4                    FORMATTING='0'B;
      724     7012    4   EDIT_ALT:        ;
      725     7013    4                    FMTX=FDS.FMTX-1;
      726     7014    4   /* X */        CASE(35);
      727     7015    4                    IF CNT(0)=0 THEN CNT(0)=1;
      728     7016    4                    IF CNT(0)>0 THEN CALL FIELD(' ',1,CNT(0));
      729     7017    5                    ELSE DO;
      730     7018    5                       CNT(0) = -CNT(0);
      731     7019    5                       IF CNT(0)>FDS.BUFX-1 THEN CNT(0) = FDS.BUFX-1;
      732     7020    5                       FDS.BUFX = FDS.BUFX-CNT(0);
      733     7021    5                       CALL INSERT (BUFFER,FDS.BUFX,CNT(0),' ');
      734     7022    5                       END;
      735     7023
      736     7024    4                    FORMATTING='0'B;
      737     7025    4   /* < */        CASE(36);
      738     7026    5                    IF FLAGS.ARITH THEN DO;
      739     7027    5                       CNT(CNTX)=MINIMUM(CNT(CNTX),SAVCNT);
      740     7028    5                       GOTO ARITH_DONE;
      741     7029    5                       END;
      742     7030    4                    FLAGS.DLB='1'B;
      743     7031    4   /* > */        CASE(37);
      744     7032    5                    IF FLAGS.ARITH THEN DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:46   
      745     7033    5                       CNT(CNTX)=MAXIMUM(CNT(CNTX),SAVCNT);
      746     7034    5                       GOTO ARITH_DONE;
      747     7035    5                       END;
      748     7036    4                    FLAGS.DTB='1'B;
      749     7037    4   /* U */        CASE(38);
      750     7038    4                    DWID=DATEWIDTH(CNT(3));
      751     7039    4                    TWID=TIMEWIDTH(CNT(3));
      752     7040    4                    FPT$TIME=FPT_TIME;
      753     7041    4                    FPT$TIME.V_=VECTOR(FPT$TIME.V);
      754     7042    4                    IF CNT(2)/4=1 THEN FPT$TIME.V.SOURCE#=%CLOCK#;
      755     7043    5                    ELSE DO;
      756     7044    5                       CALL GETVAL(X,CNT(1)) ALTRET(NO_MEM);
      757     7045    5                       FPT$TIME.TSTAMP_=VECTOR(X);
      758     7046    5                       IF CNT(2)<4 THEN FPT$TIME.V.SOURCE#=%UTS#;
      759     7047    5                       ELSE FPT$TIME.V.SOURCE#=%FUTS#;
      760     7048    5                       END;
      761     7049    4                    FPT$TIME.V.DEST#=TIMEDEST(MOD(CNT(3),4));
      762     7050    5                    DO CASE(MOD(CNT(2),4));
      763     7051    5                     CASE(0);              /* HH:MM */
      764     7052    5                       FPT$TIME.TIME_=VECTOR(NUMBUF);
      765     7053    5                       TEMP=TWID;
      766     7054    5                     CASE(1);              /* MM/DD/YY */
      767     7055    5                       FPT$TIME.DATE_=VECTOR(NUMBUF);
      768     7056    5                       TEMP=DWID;
      769     7057    5                     CASE(2);              /* HH:MM MM/DD/YY */
      770     7058    5                       FPT$TIME.TIME_=VECTOR(SUBSTR(NUMBUF,0,TWID));
      771     7059    5                       FPT$TIME.DATE_=VECTOR(SUBSTR(NUMBUF,TWID+1,DWID));
      772     7060    5                       TEMP=TWID+DWID+1;
      773     7061    5                     CASE(3);              /* MM/DD/YY HH:MM */
      774     7062    5                       FPT$TIME.DATE_=VECTOR(SUBSTR(NUMBUF,0,DWID));
      775     7063    5                       FPT$TIME.TIME_=VECTOR(SUBSTR(NUMBUF,DWID+1,TWID));
      776     7064    5                       TEMP=TWID+DWID+1;
      777     7065    5                     END;
      778     7066    4                    NUMBUF=' ';
      779     7067    4                    CALL M$TIME(FPT$TIME);
      780     7068    4                    CALL FIELD(NUMBUF,TEMP,CNT(0));
      781     7069    4                    FORMATTING='0'B;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:47   
      782     7070    4   /* J */        CASE(39);
      783     7071    4                    CALL GETVAL(ERRCD,CNT(1)) ALTRET(NO_MEM);
      784     7072    5                    IF CNTX>1 THEN DO;     /* Use M$ERRMSG */
      785     7073    5                       CNTB(1)=ERRCD;      /* Pass ERRCD and CNT(2) together */
      786     7074    5                       CALL XUF$ERRMSG(CNT(1),DBUF,DSIZ);
      787     7075    5                       CALL FIELD (DBUF,DSIZ,CNT(0));
      788     7076    5                       END;
      789     7077    5                    ELSE DO;
      790     7078    5                       NUMBUF=' ';
      791     7079    6                       DO I=0 TO 2;
      792     7080    6                          IF ERRCD.FCG(I)=0 THEN
      793     7081    6                             CALL INSERT(NUMBUF,I,1,' ');
      794     7082    6                          ELSE IF ERRCD.FCG(I)>=48 THEN
      795     7083    6                                CALL INSERT(NUMBUF,I,1,BINASC(ERRCD.FCG(I)));
      796     7084    6                             ELSE
      797     7085    6                                CALL INSERT(NUMBUF,I,1,BINASC(ERRCD.FCG(I)+64));
      798     7086    6                          END;
      799     7087    5                       IF ERRCD.MON THEN
      800     7088    5                          CALL INSERT(NUMBUF,3,2,'-M');
      801     7089    5                       ELSE
      802     7090    5                          CALL INSERT(NUMBUF,3,2,'-0');
      803     7091    5                       CALL BINCHAR(SUBSTR(NUMBUF,5,5),ERRCD.CODE);
      804     7092    5                       CALL INSERT(NUMBUF,10,1,'-');
      805     7093    5                       CALL BINCHAR(SUBSTR(NUMBUF,11,1),ERRCD.SEV);
      806     7094    5                       CALL FIELD(NUMBUF,12,CNT(0));
      807     7095    5                       END;
      808     7096    4                    FORMATTING='0'B;
      809     7097    4   /* * */        CASE(40);
      810     7098    5                    IF FLAGS.ARITH THEN DO;
      811     7099    5                       CNT(CNTX)=SAVCNT*CNT(CNTX);
      812     7100    5                       GOTO ARITH_DONE;
      813     7101    5                       END;
      814     7102    4                    ELSE FLAGS.STAR='1'B;
      815     7103    4   /* F */        CASE(41);
      816     7104    5                    DO CASE(CNT(1));       /* SPECIAL FORMATS */
      817     7105    5                     CASE(1);              /* DESCRIPTOR */
      818     7106    5                       CALL GETVAL(DESC.W0,36) ALTRET(NO_MEM);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:48   
      819     7107    5                       CALL GETVAL(DESC.W1,36) ALTRET(NO_MEM);
      820     7108    5                       CALL XUF$DESC(DESC,DBUF,DSIZ);
      821     7109    5                       CALL FIELD(SUBSTR(DBUF,1),DSIZ,CNT(0));
      822     7110    5                     CASE(2);              /* PTR */
      823     7111    5                       CALL GETVAL(DESC.W0,36) ALTRET(NO_MEM);
      824     7112    5                       CALL XUF$PTR(DESC.W0,DBUF,DSIZ);
      825     7113    5                       CALL FIELD(SUBSTR(DBUF,1),DSIZ,CNT(0));
      826     7114    5                     CASE(3);              /* M$UNFID */
      827     7115    5                       CALL GETVAL (DESC.W0,36) ALTRET (NO_MEM);
      828     7116    5                       DSIZ=CNT(3);        /* Set the FORCE flag */
      829     7117    5                       CALL XUF$UNFID (DESC.W0,DBUF,DSIZ);
      830     7118    5                       CALL FIELD (DBUF,DSIZ,CNT(0));
      831     7119    5                     CASE(4);              /* DCBNAME */
      832     7120    5                       CALL GETVAL (DESC.W0,36) ALTRET (NO_MEM);
      833     7121    5                       DBUF = DCBADDR(DESC.W0)->F$DCB.DCBNAME.N;
      834     7122    5                       DSIZ = DCBADDR(DESC.W0)->F$DCB.DCBNAME.L;
      835     7123    5                       CALL FIELD (DBUF,DSIZ,CNT(0));
      836     7124    5                     END;
      837     7125    4                    FORMATTING='0'B;
      838     7126    4   /* & */        CASE(42);
      839     7127    5                    IF FLAGS.ARITH THEN DO;
      840     7128    5                       CNTB(CNTX)=SAVCNTB&CNTB(CNTX);
      841     7129    5                       GOTO ARITH_DONE;
      842     7130    5                       END;
      843     7131    4                    FLAGS.FIELD='1'B;
      844     7132    4   /* R */        CASE(43);
      845     7133    4                    IF FDS.BUFSIZE-FDS.BUFX<CNT(0)
      846     7134    5                      AND FDS.BUFX>FDS.WRAPTAB# AND NOT FDS.BLNKBUF THEN DO;
      847     7135    5                       FPT$WRITE.BUF_.BOUND=0;
      848     7136    5                       CALL BUF_WRAP;
      849     7137    5                       END;
      850     7138    4                    ELSE IF CNT(0)=0 AND FDS.BUFX>FDS.WRAPTAB#
      851     7139    4                       THEN FPT$WRITE.BUF_.BOUND=FDS.BUFX-1;
      852     7140    4                    FORMATTING='0'B;
      853     7141    4   /* \ */        CASE(44);
      854     7142    5                    IF FLAGS.ARITH THEN DO;
      855     7143    5                       CNTB(CNTX)=SAVCNTB\CNTB(CNTX);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:49   
      856     7144    5                       GOTO ARITH_DONE;
      857     7145    5                       END;
      858     7146    4                    FDS.DONT_PRINT = '1'B;
      859     7147    4                    FORMATTING = '0'B;
      860     7148    4   /* @ */        CASE(45);
      861     7149    4                    FLAGS.L6='1'B;
      862     7150    4   /* [ */        CASE(46);
      863     7151    5                    IF FDS.DEBUG THEN DO;
      864     7152    5                       DBUF=%CONCAT(BITASC('037'O),'Cnt1=');
      865     7153    5                       CALL BINXCHAR(SUBSTR(DBUF,6,12),CNT(1));
      866     7154    5                       CALL DEBUG_OUT;
      867     7155    5                       END;
      868     7156    4                    I=1;
      869     7157    4                    CNT(2)=I;
      870     7158    5                    DO UNTIL(I=0);
      871     7159    6                       IF CNT(0)=CNT(1) AND I=CNT(2) THEN DO;
      872     7160    6                          FDS.FMTX=FMTX+1;
      873     7161    6                          IF FDS.FMTX>=FDS.FMTSIZE THEN GOTO BAD_FMT;
      874     7162    6                          FDS.FMTXMAX=CODE;
      875     7163    6                          CALL XUF$FORMAT1(FDS);
      876     7164    6                          CNT(2)=0;        /* ONLY DO IT ONCE */
      877     7165    6                          FMTX=FDS.FMTX-1;
      878     7166    6                          END;
      879     7167    5                       CALL INDEX (FMTX,'%',FMT,FMTX+1) ALTRET(BAD_FMT);
      880     7168    5                       CNT(0)=0;
      881     7169    6                       DO WHILE '1'B;
      882     7170    6                          FMTX=FMTX+1;
      883     7171    6                          IF FMTX>=FDS.FMTSIZE THEN GOTO BAD_FMT;
      884     7172    6                          IF NOT FLAGS.ARITH
      885     7173    6                          THEN CALL INDEX (X,SUBSTR(FMT,FMTX,1),CONTCHARS)
      886     7174    6                               ALTRET(CHK_OP2);
      887     7175    6                          ELSE CALL INDEX (X,SUBSTR(FMT,FMTX,1),ARTHCHARS)
      888     7176    7                             WHENRETURN DO; FLAGS.ARITH='0'B; END;
      889     7177    6                          IF X<10 THEN CNT(0)=10*CNT(0)+X;
      890     7178    6                          ELSE CNT(0)=-1;
      891     7179    6                          IF X=10 THEN FLAGS.ARITH='1'B;
      892     7180    6                          END;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:50   
      893     7181    5   CHK_OP2:            IF SUBSTR(FMT,FMTX,1)~='?' THEN CNT(0)=CNT(1)-1;
      894     7182    5                       ELSE IF SUBSTR(FMT,FMTX-1,1)='%' THEN CNT(0)=CNT(1);
      895     7183    5                       IF SUBSTR(FMT,FMTX,1)='[' THEN I=I+1;
      896     7184    5                       ELSE IF SUBSTR(FMT,FMTX,1)=']' THEN I=I-1;
      897     7185    5                       END;
      898     7186    4                    FORMATTING='0'B;
      899     7187    4   /* ? */        CASE(47);
      900     7188    4                    IF NOT FLAGS.ARITH THEN GOTO CASE_48;
      901     7189    4                    CNT(CNTX)=MINIMUM(MAXIMUM(SAVCNT-CNT(CNTX),-1),1);
      902     7190    4                    GOTO ARITH_DONE;
      903     7191    4   /* ] */        CASE(48);
      904     7192    4   CASE_48:         IF SAVEFMTX~=46 THEN GOTO BAD_FMT; /* ILLEGAL AT LEVEL 0 */
      905     7193    4                    FDS.FMTX=PERCENT;
      906     7194    4                    GOTO DBG_RETURN;
      907     7195    4   /* : */        CASE(49);
      908     7196    4                    FLAGS.ARITH = '1'B;
      909     7197    4                    SAVCNT = CNT(CNTX);
      910     7198    4                    CNT(CNTX) = 0;
      911     7199    4   /* C */        CASE(50);
      912     7200    4                    FORMATTING='0'B;
      913     7201    5                    IF FMTX=PERCENT+1 THEN DO; /* %C, must be end proc */
      914     7202    5                       IF SAVEFMTX~=50 THEN GOTO BAD_FMT; /* not called */
      915     7203    6   DBG_RETURN:         IF FDS.DEBUG THEN DO;
      916     7204    6                          DBUF=%CONCAT(BITASC('037'O),'Return:');
      917     7205    6                          CALL DEBUG_OUT;
      918     7206    6                          END;
      919     7207    5                       RETURN;
      920     7208    5                       END;
      921     7209    5                    IF CNT(0)>0 THEN DO;   /* %nC, a call */
      922     7210    5                       IF CNT(0)>99 THEN GOTO BAD_CNT;
      923     7211    5                       TEMP=G.INDX(100-CNT(0));
      924     7212    5                       IF TEMP<4 OR TEMP>=FDS.FMTSIZE THEN GOTO BAD_CNT;
      925     7213    5                       FDS.FMTX=TEMP;
      926     7214    5                       FDS.FMTXMAX=50;
      927     7215    5                       CALL XUF$FORMAT1(FDS);
      928     7216    5                       END;
      929     7217    5                    ELSE DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:51   
      930     7218    5                       IF CNT(1)<=0 OR CNT(1)>99 THEN GOTO BAD_CNT;
      931     7219    5                       G.INDX(100-CNT(1))=FMTX+1;
      932     7220    5                       CALL INDEX(FMTX,'%C',FMT,FMTX+1) ALTRET(BAD_FMT);
      933     7221    5                       FMTX = FMTX+1;
      934     7222    5                       END;
      935     7223    4   /* = */        CASE(51);
      936     7224    5                    IF FLAGS.ARITH THEN DO;
      937     7225    5                       TEMP=CNT(CNTX);
      938     7226    5                       CNT(CNTX)=SAVCNT;
      939     7227    5                       FLAGS.ARITH='0'B;
      940     7228    5                       END; ELSE DO;
      941     7229    5                       TEMP=CNT(1);
      942     7230    5                       SAVCNT=CNT(0);
      943     7231    5                       FORMATTING='0'B;
      944     7232    5                       END;
      945     7233    4                    IF TEMP>99 THEN GOTO BAD_CNT;
      946     7234    5                    IF FDS.DEBUG THEN DO;
      947     7235    5                       DBUF=%CONCAT(BITASC('037'O),'Var00=');
      948     7236    5                       CALL BINCHAR(SUBSTR(DBUF,4,2),TEMP);
      949     7237    5                       CALL BINXCHAR(SUBSTR(DBUF,7,12),SAVCNT);
      950     7238    5                       CALL DEBUG_OUT;
      951     7239    5                       END;
      952     7240    4                    G.INDX(TEMP)=SAVCNT;
      953     7241    4   /* # */        CASE(52);
      954     7242    4                    TEMP=CNT(CNTX);
      955     7243    4                    IF TEMP>100+SIZEW(FDS) THEN GOTO BAD_CNT;
      956     7244    4                    IF TEMP<100 THEN CNT(CNTX)=G.INDX(TEMP);
      957     7245    4                    ELSE CNT(CNTX)=ADDR(FDS)->G.INDX(TEMP-100);
      958     7246    4   /* K */        CASE(53);
      959     7247    4                    FLAGS.CNT1='1'B;
      960     7248    4   /* | */        CASE(54);
      961     7249    4                    IF NOT FLAGS.ARITH THEN FDS.DEBUG=~FDS.DEBUG;
      962     7250    5                    ELSE DO;
      963     7251    5                       CNTB(CNTX)=SAVCNTB|CNTB(CNTX);
      964     7252    5   ARITH_DONE:         FLAGS.ARITH='0'B;
      965     7253    5                       END;
      966     7254    3                  END; /* CASE CODE */;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:52   
      967     7255    3                 END;                      /* WHILE FORMATTING */
      968     7256    2              FMTX=FMTX+1;
      969     7257    3              IF NOT LOOPING AND FDS.MEMSZ>0 THEN DO;
      970     7258    3                 IF NOT FDS.BLNKBUF AND NOT FDS.DONT_PRINT THEN CALL BUF_OUT;
      971     7259    3                 FMTX=FDS.RESCAN;
      972     7260    3                 LOOPING='1'B;
      973     7261    3                 END;
      974     7262    2              END;                         /* WHILE LOOPING */
      975     7263    1           IF NOT FDS.BLNKBUF AND NOT FDS.DONT_PRINT THEN CALL BUF_OUT;
      976     7264    1   XIT:    RETURN;
      977     7265    1   BAD_CNT:
      978     7266    1           PERCENT=-1;
      979     7267    1           GOTO BAD_CODE;
      980     7268    1   NO_MEM:
      981     7269    1           PERCENT=-2;
      982     7270    1           GOTO BAD_CODE;
      983     7271    1   BAD_FMT:
      984     7272    1           FMTX=PERCENT;
      985     7273    1   BAD_CODE: ;
      986     7274    1           CALL BUF_OUT;
      987     7275    1           IF FMTX<15 THEN X=FMTX;
      988     7276    1           ELSE X=15;
      989     7277    1           IF FMTX+15>FDS.FMTSIZE THEN I=FDS.FMTSIZE-FMTX;
      990     7278    1           ELSE I=15;
      991     7279    1           BUFFER=BITASC('037'O);          /* TRANSITION 1 VFC */
      992     7280    1           CALL INSERT(BUFFER,1,X+I,SUBSTR(FMT,FMTX-X,X+I));
      993     7281    1           FDS.BUFX=X+I+1;
      994     7282    1           FDS.BLNKBUF='0'B;
      995     7283    1           CALL BUF_OUT;
      996     7284    1           BUFFER='A';
      997     7285    1           CALL INSERT(BUFFER,X+1,1,'^');
      998     7286    1           FDS.BUFX=X+2;
      999     7287    1           FDS.BLNKBUF='0'B;
     1000     7288    1           CALL BUF_OUT;
     1001     7289    2           IF FMTX=PERCENT THEN DO;
     1002     7290    2              BUFFER='AUNBALANCED GROUP CODES - CC, (), OR [?]';
     1003     7291    2              END; ELSE IF PERCENT=-1 THEN DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:53   
     1004     7292    2                 BUFFER='ABAD NUMBER FOR VALUE OR SUBROUTINE';
     1005     7293    2                 END; ELSE IF PERCENT=-2 THEN DO;
     1006     7294    2                    BUFFER='ARAN OUT OF DATA VECTORS';
     1007     7295    2                    END; ELSE DO;
     1008     7296    2                    BUFFER='AUNKNOWN INSERTION CODE';
     1009     7297    2                    END;
     1010     7298    1           CALL INDEX(FDS.BUFX,'  ',BUFFER);
     1011     7299    1           FDS.BLNKBUF='0'B;
     1012     7300    1           CALL BUF_OUT;
     1013     7301    1           UNWIND TO FDS.BAILOUT;
     1014     7302        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:54   
     1015     7303    1   SETMEM: PROC(X,B);
     1016     7304    2   DCL X SBIN;
     1017     7305    2   DCL B SBIN;
     1018     7306    2   DCL BB SBIN;
     1019     7307    2           FDS.MEMX=X-1;
     1020     7308    2           FDS.MEMSZ=0;
     1021     7309    2           BB=B;
     1022     7310    3           DO WHILE(FDS.MEMSZ<=0);
     1023     7311    3              FDS.MEMX=FDS.MEMX+1;
     1024     7312    3              IF FDS.MEMX>=FDS.NVECS# THEN GOTO NO_MEM;
     1025     7313    4              IF MEMVEC(FDS.MEMX)~=VECTOR(NIL) THEN DO;
     1026     7314    4                 FDS.CUR$=MEMVEC.PTR$(FDS.MEMX);
     1027     7315    4                 FDS.MEMSZ=(MEMVEC.BOUND(FDS.MEMX)+1)*9;
     1028     7316    4                 FDS.MEMSZ=FDS.MEMSZ-BB;
     1029     7317    4                 FDS.CUR$=PINCRB(FDS.CUR$,BB);
     1030     7318    4                 BB=0;
     1031     7319    4                 END;
     1032     7320    3              END;
     1033     7321    2           RETURN;
     1034     7322    2   NO_MEM: FDS.MEMSZ=0;
     1035     7323    2           RETURN;
     1036     7324    2   END SETMEM;
     1037     7325        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:55   
     1038     7326    1   BUF_OUT: PROC;
     1039     7327    2           IF FDS.BLNKBUF THEN CALL BLANKBUF;
     1040     7328    2           FDS.WRAP='0'B;
     1041     7329    2           FPT$WRITE.BUF_.BOUND=FDS.BUFX-1;
     1042     7330    2   WRAPENT:;
     1043     7331    2           FPT$WRITE.BUF_.BUF$=FDS.BUF_.BUF$;
     1044     7332    3           IF FDS.OUTPUT#~=ENTADDR(NIL) THEN DO;
     1045     7333    3              CALL FDS.OUTPUT#(FPT$WRITE.BUF_,FDS) ALTRET(SKIP_WRITE);
     1046     7334    3              END;
     1047     7335    3           IF FDS.DCB#~=DCBNUM(NIL) THEN DO;
     1048     7336    3              FPT$WRITE.V.DCB#=FDS.DCB#;
     1049     7337    4              IF SUBSTR(BUFFER,0,1)='*' /* star-VFC means no VFC */ THEN DO;
     1050     7338    4                 BUFFER=SUBSTR(BUFFER,1);
     1051     7339    4                 FPT$WRITE.BUF_.BOUND=FPT$WRITE.BUF_.BOUND-1;
     1052     7340    4                 FPT$WRITE.V.DVBYTE.VFC#='0'B;
     1053     7341    4                 END;
     1054     7342    3              CALL M$WRITE(FPT$WRITE);
     1055     7343    3              FPT$WRITE.V.DVBYTE.VFC#='1'B;
     1056     7344    3              END;
     1057     7345    2   SKIP_WRITE: ;
     1058     7346    2           IF NOT FDS.WRAP THEN FDS.BLNKBUF='1'B;
     1059     7347    3           ELSE IF FDS.BUFX=0 THEN DO;
     1060     7348    3                 FDS.BUFX=FDS.WRAPTAB#;
     1061     7349    3                 BUFFER=FDS.DVFC#;
     1062     7350    3                 END; ELSE DO;
     1063     7351    3                 SUBSTR(BUFFER,0,FDS.WRAPTAB#)=FDS.DVFC#;
     1064     7352    3                 SUBSTR(BUFFER,FDS.WRAPTAB#)=SUBSTR(BUFFER,FPT$WRITE.BUF_.BOUND+1);
     1065     7353    3                 FDS.BUFX=FDS.BUFX-FPT$WRITE.BUF_.BOUND+FDS.WRAPTAB#-1;
     1066     7354    3                 END;
     1067     7355    2           FPT$WRITE.BUF_.BOUND=0;
     1068     7356    2           RETURN;
     1069     7357    2   BUF_WRAP: ENTRY;
     1070     7358    2           FDS.WRAP='1'B;
     1071     7359    3           IF FPT$WRITE.BUF_.BOUND=0 THEN DO;
     1072     7360    3              FPT$WRITE.BUF_.BOUND=FDS.BUFX-1;
     1073     7361    3              FDS.BUFX=0;
     1074     7362    3              END;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:56   
     1075     7363    2           GOTO WRAPENT;
     1076     7364    2   END BUF_OUT;
     1077     7365        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:57   
     1078     7366    1   BLANKBUF: PROC;
     1079     7367    2           BUFFER=FDS.DVFC#;
     1080     7368    2           FDS.BUFX=1;
     1081     7369    2           FDS.BLNKBUF='0'B;
     1082     7370    2           RETURN;
     1083     7371    2   END BLANKBUF;
     1084     7372        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:58   
     1085     7373    1   GETMEM: PROC(M$,B) ALTRET;
     1086     7374    2   DCL M$ PTR;
     1087     7375    2   DCL 1 M REDEF M$,
     1088     7376    2         2 BA UBIN(20) UNAL,
     1089     7377    2         2 BT UBIN(4) UNAL,
     1090     7378    2         2 SEG BIT(12) UNAL;
     1091     7379    2   DCL B SBIN;
     1092     7380    2           M$=FDS.CUR$;
     1093     7381    3           IF M.BT>0 THEN DO;
     1094     7382    3              M.BA=M.BA+1;
     1095     7383    3              FDS.MEMSZ=FDS.MEMSZ-(9-M.BT);
     1096     7384    3              M.BT=0;
     1097     7385    3              FDS.CUR$=M$;
     1098     7386    3              IF FDS.MEMSZ<=0 THEN CALL SETMEM(FDS.MEMX+1,0);
     1099     7387    3              END;
     1100     7388    3           DO WHILE(B>FDS.MEMSZ/9);
     1101     7389    3              CALL SETMEM(FDS.MEMX+1,0);
     1102     7390    3              IF FDS.MEMSZ=0 THEN ALTRETURN;
     1103     7391    3              END;
     1104     7392    2           FDS.CUR$=PINCRC(FDS.CUR$,B);
     1105     7393    2           FDS.MEMSZ=FDS.MEMSZ-(B*9);
     1106     7394    2           IF FDS.MEMSZ=0 THEN CALL SETMEM(FDS.MEMX+1,0);
     1107     7395    2           RETURN;
     1108     7396    2   END GETMEM;
     1109     7397        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:59   
     1110     7398    1   GETVAL: PROC(V,B) ALTRET;
     1111     7399    2   DCL V SBIN;
     1112     7400    2   DCL B SBIN;
     1113     7401    2   DCL BB SBIN;
     1114     7402    2   DCL VALBASE BIT(BB) BASED UNAL;
     1115     7403    2   DCL CC UBIN;
     1116     7404    2   DCL VALBASEC CHAR(CC) BASED;
     1117     7405    2   DCL V$ PTR;
     1118     7406    2   DCL M$ PTR;
     1119     7407    2   DCL 1 M REDEF M$,
     1120     7408    2         2 W UBIN HALF CALIGNED,
     1121     7409    2         2 C UBIN(2) UNAL,
     1122     7410    2         2 B UBIN(4) UNAL,
     1123     7411    2         2 SID BIT(12);
     1124     7412    3           IF FLAGS.CNT1 AND ADDR(B)=ADDR(CNT(1)) AND ADDR(B)~=ADDR(V) THEN DO;
     1125     7413    3              V=CNT(1);
     1126     7414    3              RETURN;
     1127     7415    3              END;
     1128     7416    2           IF B>36 THEN BB=36;
     1129     7417    3           ELSE IF B=0 THEN DO;
     1130     7418    3                 IF FDS.MEMSZ<36 AND FDS.MEMSZ>0 THEN BB=FDS.MEMSZ;
     1131     7419    3                 ELSE BB=36;
     1132     7420    3                 END;
     1133     7421    2              ELSE BB=B;
     1134     7422    3           DO WHILE(BB>FDS.MEMSZ);
     1135     7423    3              CALL SETMEM(FDS.MEMX+1,0);
     1136     7424    3              IF FDS.MEMSZ<=0 THEN ALTRETURN;
     1137     7425    3              END;
     1138     7426    2           M$=FDS.CUR$;
     1139     7427    3           IF FDS.DEBUG THEN DO;
     1140     7428    3              DBUF=%CONCAT(BITASC('037'O),'XX-bit fetch from VV-WWWWWW-C-B');
     1141     7429    3              CALL BINCHAR(SUBSTR(DBUF,1,2),BB);
     1142     7430    3              CC=POFFC(M$,MEMVEC.PTR$(FDS.MEMX));
     1143     7431    3              CALL BINCHAR(SUBSTR(DBUF,19,2),FDS.MEMX+1);
     1144     7432    3              CALL BINCHAR(SUBSTR(DBUF,22,6),CC/4);
     1145     7433    3              CALL BINCHAR(SUBSTR(DBUF,29,1),MOD(CC,4));
     1146     7434    3              CALL BINCHAR(SUBSTR(DBUF,31,1),M.B);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:60   
     1147     7435    3              CALL DEBUG_OUT;
     1148     7436    3              END;
     1149     7437    3           IF FLAGS.L6 THEN DO;
     1150     7438    4              IF M.B=0 THEN DO;
     1151     7439    4                 FDS.CUR$=PINCRB(FDS.CUR$,1);
     1152     7440    4                 FDS.MEMSZ=FDS.MEMSZ-1;
     1153     7441    4                 END;
     1154     7442    3              END;
     1155     7443    2           IF FLAGS.SIGN AND FDS.CUR$->ONEBIT THEN V=-1;
     1156     7444    2           ELSE V=0;
     1157     7445    3           IF FLAGS.L6 THEN DO;
     1158     7446    3              FDS.MEMSZ=FDS.MEMSZ-BB;
     1159     7447    3              V$=PINCRB(ADDR(V),36-BB);
     1160     7448    3              M$=FDS.CUR$;
     1161     7449    4              DO WHILE BB>0;
     1162     7450    5                 IF M.B=0 THEN DO;
     1163     7451    5                    M.B=1;
     1164     7452    5                    FDS.MEMSZ=FDS.MEMSZ-1;
     1165     7453    5                    END;
     1166     7454    4                 CC=MINIMUM (9-M.B, BB);
     1167     7455    4                 V$->VALBASE=M$->VALBASE;
     1168     7456    4                 V$=PINCRB(V$,CC);
     1169     7457    4                 M$=PINCRB(M$,CC);
     1170     7458    4                 BB = BB-CC;
     1171     7459    4                 END;
     1172     7460    3              FDS.CUR$=M$;
     1173     7461    3              END;
     1174     7462    3           ELSE DO;
     1175     7463    3              IF M.B = 0 AND MOD(BB,9) = 0
     1176     7464    4              THEN DO;
     1177     7465    4                 CC = BB / 9;
     1178     7466    4                 PINCRC (ADDR(V) , 4 - CC) -> VALBASEC = M$ -> VALBASEC;
     1179     7467    4                 END;
     1180     7468    3              ELSE
     1181     7469    3                 PINCRB(ADDR(V),36-BB)->VALBASE=FDS.CUR$->VALBASE;
     1182     7470    3              FDS.CUR$=PINCRB(FDS.CUR$,BB);
     1183     7471    3              FDS.MEMSZ=FDS.MEMSZ-BB;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:61   
     1184     7472    3              END;
     1185     7473    2           IF FDS.MEMSZ<=0 THEN CALL SETMEM(FDS.MEMX+1,0);
     1186     7474    2           RETURN;
     1187     7475    2   END GETVAL;
     1188     7476        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:62   
     1189     7477    1   SKIPBITS: PROC(B);
     1190     7478    2   DCL B SBIN;
     1191     7479        /**/
     1192     7480    2           IF B>FDS.MEMSZ THEN
     1193     7481    2              CALL SETMEM(FDS.MEMX+1,0);
     1194     7482    3           ELSE DO;
     1195     7483    3              FDS.CUR$=PINCRB(FDS.CUR$,B);
     1196     7484    3              FDS.MEMSZ=FDS.MEMSZ-B;
     1197     7485    3              END;
     1198     7486    2           RETURN;
     1199     7487    2   END SKIPBITS;
     1200     7488        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:63   
     1201     7489    1   FIELD:  PROC(STRING,SIZ,FLD);
     1202     7490    2   DCL STRING CHAR(1);
     1203     7491    2   DCL SIZ SBIN;
     1204     7492    2   DCL FLD SBIN;
     1205     7493    2   DCL STR$ PTR;
     1206     7494    2   DCL STR CHAR(STRSIZ) BASED(STR$);
     1207     7495    2   DCL STRSIZ SBIN;
     1208     7496    2   DCL FWIDTH SBIN;
     1209     7497    2   DCL IDX SBIN;
     1210     7498    2   DCL TABLEVAL SBIN;
     1211     7499    2           IF FDS.BLNKBUF THEN CALL BLANKBUF;
     1212     7500    2           STR$=ADDR(STRING);
     1213     7501    2           STRSIZ=SIZ;
     1214     7502    3           IF FLAGS.DLB THEN DO;
     1215     7503    3              CALL SEARCH(IDX,TABLEVAL,SEARCHNB,STR) ALTRET(ALL_BLANKS);
     1216     7504    3              STR$=PINCRC(STR$,IDX);
     1217     7505    3              STRSIZ=STRSIZ-IDX;
     1218     7506    3              END;
     1219     7507    3           IF FLAGS.DTB THEN DO;
     1220     7508    3              CALL SEARCHR(IDX,TABLEVAL,SEARCHNB,STR) ALTRET(ALL_BLANKS);
     1221     7509    3              STRSIZ=IDX+1;
     1222     7510    4              DO NEVER;
     1223     7511    4   ALL_BLANKS:   STRSIZ=0;
     1224     7512    4                 END;
     1225     7513    3              END;
     1226     7514    2           IF FLD=0 THEN FWIDTH=STRSIZ;
     1227     7515    2           ELSE FWIDTH=FLD;
     1228     7516    2           FDS.FWID=FWIDTH;
     1229     7517    3           IF NOT FDS.TRUNC# THEN DO;
     1230     7518    3              IF FLAGS.FIELD AND FWIDTH>FDS.BUFSIZE-FDS.BUFX AND
     1231     7519    3                (FDS.BUFX>FDS.WRAPTAB# OR FDS.BUFX>1 AND NOT FDS.WRAP)
     1232     7520    3              THEN CALL BUF_WRAP;
     1233     7521    4              IF NOT FLAGS.LJ THEN DO WHILE(FDS.FWID>STRSIZ);
     1234     7522    4                 IF FDS.FWID-STRSIZ>FDS.BUFSIZE-FDS.BUFX THEN X=FDS.BUFSIZE-FDS.BUFX;
     1235     7523    4                 ELSE X=FDS.FWID-STRSIZ;
     1236     7524    4                 CALL INSERT(BUFFER,FDS.BUFX,X,' ');
     1237     7525    4                 FDS.BUFX=FDS.BUFX+X;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:64   
     1238     7526    4                 IF FDS.BUFX>=FDS.BUFSIZE THEN CALL BUF_WRAP;
     1239     7527    4                 FDS.FWID=FDS.FWID-X;
     1240     7528    4                 END;
     1241     7529    4              DO WHILE(FDS.BUFX+FDS.FWID>FDS.BUFSIZE);
     1242     7530    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX),TRANS,STR);
     1243     7531    4                 X=FDS.BUFSIZE-FDS.BUFX;
     1244     7532    4                 FDS.FWID=FDS.FWID-X;
     1245     7533    4                 STRSIZ=STRSIZ-X;
     1246     7534    4                 IF STRSIZ>0 THEN STR$=PINCRC(STR$,X);
     1247     7535    5                 ELSE DO;
     1248     7536    5                    STR$=ADDR(BLANKS);
     1249     7537    5                    STRSIZ=1;
     1250     7538    5                    END;
     1251     7539    4                 FDS.BUFX=FDS.BUFSIZE;
     1252     7540    4                 CALL BUF_WRAP;
     1253     7541    4                 END;
     1254     7542    3              END;
     1255     7543    3           IF FDS.FWID<STRSIZ THEN DO;
     1256     7544    4              IF FLAGS.MSD THEN DO;
     1257     7545    4                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN FDS.FWID=FDS.BUFSIZE-FDS.BUFX;
     1258     7546    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX,FDS.FWID),TRANS,STR);
     1259     7547    4                 END;
     1260     7548    4              ELSE DO;
     1261     7549    5                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN DO;
     1262     7550    5                    STRSIZ=STRSIZ-(FDS.BUFX+FDS.FWID-FDS.BUFSIZE);
     1263     7551    5                    IF STRSIZ<0 THEN STRSIZ=0;
     1264     7552    5                    FDS.FWID=FDS.BUFSIZE-FDS.BUFX;
     1265     7553    5                    END;
     1266     7554    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX,FDS.FWID),TRANS,SUBSTR(STR,STRSIZ-
              7554                          FDS.FWID));
     1267     7555    4                 END;
     1268     7556    3              END;
     1269     7557    3           ELSE DO;
     1270     7558    4              IF FLAGS.LJ THEN DO;
     1271     7559    4                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN FDS.FWID=FDS.BUFSIZE-FDS.BUFX;
     1272     7560    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX,FDS.FWID),TRANS,STR);
     1273     7561    4                 END;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:65   
     1274     7562    4              ELSE DO;
     1275     7563    5                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN DO;
     1276     7564    5                    STRSIZ=STRSIZ-(FDS.BUFX+FDS.FWID-FDS.BUFSIZE);
     1277     7565    5                    IF STRSIZ<0 THEN STRSIZ=0;
     1278     7566    5                    FDS.FWID=FDS.BUFSIZE-FDS.BUFX;
     1279     7567    5                    END;
     1280     7568    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX+FDS.FWID-STRSIZ,STRSIZ),TRANS,STR);
     1281     7569    4                 END;
     1282     7570    3              END;
     1283     7571    2           FDS.BUFX=FDS.BUFX+FDS.FWID;
     1284     7572    2           FDS.FWID=FWIDTH;
     1285     7573    3           IF FDS.DEBUG AND PERCENT<FMTX THEN DO;
     1286     7574    3              IF FWIDTH>=FDS.BUFX THEN FWIDTH=1;
     1287     7575    3              ELSE FWIDTH=FDS.BUFX-FWIDTH;
     1288     7576    3              STRSIZ=FMTX-PERCENT+1;
     1289     7577    3              SUBSTR(DBUF,0,FDS.BUFX)=BUFFER;
     1290     7578    3              SUBSTR(DBUF,0,FWIDTH)=BITASC('037'O);
     1291     7579    4              IF STRSIZ+13<FWIDTH THEN DO;
     1292     7580    4                 IDX=FWIDTH-13-STRSIZ;
     1293     7581    4                 FWIDTH=FDS.BUFX;
     1294     7582    4                 SUBSTR(DBUF,IDX+STRSIZ,13)=' <-FMT BUF-> ';
     1295     7583    4                 END; ELSE DO;
     1296     7584    4                 IDX=FDS.BUFX+13;
     1297     7585    4                 FWIDTH=IDX+STRSIZ;
     1298     7586    4                 SUBSTR(DBUF,FDS.BUFX,13)=' <-BUF FMT-> ';
     1299     7587    4                 END;
     1300     7588    3              SUBSTR(DBUF,IDX,STRSIZ)=SUBSTR(FMT,PERCENT,STRSIZ);
     1301     7589    3   DBG_OUT:   ;
     1302     7590    3              IDX=FPT$WRITE.BUF_.BOUND;
     1303     7591    3              FPT$WRITE.BUF_.BUF$=ADDR(DBUF);
     1304     7592    3              FPT$WRITE.BUF_.BOUND=FWIDTH-1;
     1305     7593    3              FPT$WRITE.V.DCB#=FDS.DCB#;
     1306     7594    3              CALL M$WRITE(FPT$WRITE);
     1307     7595    3              FPT$WRITE.BUF_.BOUND=IDX;
     1308     7596    3              END;
     1309     7597    2           RETURN;
     1310     7598    2   DEBUG_OUT: ENTRY;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:66   
     1311     7599    2           IDX=1;
     1312     7600    3           DO UNTIL SUBSTR(DBUF,IDX,3)=' ';
     1313     7601    3              IF SUBSTR(DBUF,IDX,2)='+0' OR SUBSTR(DBUF,IDX,1)='0'
     1314     7602    3                AND SUBSTR(DBUF,IDX+1,1)>='0' AND SUBSTR(DBUF,IDX+1,1)<='9'
     1315     7603    3                AND (SUBSTR(DBUF,IDX-1,1)<'0' OR SUBSTR(DBUF,IDX-1,1)>'9')
     1316     7604    3              THEN SUBSTR(DBUF,IDX,40)=SUBSTR(DBUF,IDX+1,39);
     1317     7605    3              ELSE IDX=IDX+1;
     1318     7606    3              END;
     1319     7607    2           FWIDTH=IDX+FMTX+2-PERCENT;
     1320     7608    2           IDX=FWIDTH-IDX-1;
     1321     7609    2           SUBSTR(DBUF,FWIDTH-IDX,IDX)=SUBSTR(FMT,PERCENT,IDX);
     1322     7610    2           GOTO DBG_OUT;
     1323     7611    2   END FIELD;
     1324     7612        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:67   
     1325     7613    1   NUMERIC: PROC(RADIX) ALTRET;
     1326     7614    2   DCL RADIX SBIN;
     1327     7615    2           CALL GETVAL(TEMP,CNT(1)) ALTRET(NO_MEM);
     1328     7616    3           IF FLAGS.SIGN AND STEMP<0 THEN DO;
     1329     7617    3              SIGNC='-';
     1330     7618    3              STEMP=-STEMP;
     1331     7619    3              END;
     1332     7620    3           ELSE DO;
     1333     7621    3              SIGNC=' ';
     1334     7622    3              END;
     1335     7623    2           FSIG = 37;
     1336     7624    2           IF RADIX = 8
     1337     7625    3           THEN DO UNTIL (TEMP = 0);
     1338     7626    3              FSIG = FSIG - 1;
     1339     7627    3              CALL INSERT (NUMBUF,FSIG,1,SUBSTR(CONTAB,TEMPO.LSD,1));
     1340     7628    3              TEMP = TEMPO.REST;
     1341     7629    3              END;
     1342     7630    2           ELSE IF RADIX = 2
     1343     7631    3              THEN DO UNTIL (TEMP = 0);
     1344     7632    3                 FSIG = FSIG - 1;
     1345     7633    3                 CALL INSERT (NUMBUF,FSIG,1,SUBSTR(CONTAB,TEMPB.LSB,1));
     1346     7634    3                 TEMP = TEMPB.REST;
     1347     7635    3                 END;
     1348     7636    2              ELSE IF RADIX = 16
     1349     7637    3                 THEN DO UNTIL (TEMP = 0);
     1350     7638    3                    FSIG = FSIG - 1;
     1351     7639    3                    CALL INSERT (NUMBUF,FSIG,1,SUBSTR(CONTAB,TEMPX.LSD,1));
     1352     7640    3                    TEMP = TEMPX.REST;
     1353     7641    3                    END;
     1354     7642    2           GOTO NUMERIC2;
     1355     7643    2   NUMERIC1: ENTRY ALTRET;
     1356     7644    2           FSIG = 24;                      /*ONLY LOOK AT POSSIBLE DECIMAL DIGITS*/
     1357     7645    3           DO WHILE(SUBSTR(NUMBUF,FSIG,1)='0' AND FSIG<36);
     1358     7646    3              FSIG=FSIG+1;
     1359     7647    3              END;
     1360     7648    2   NUMERIC2:
     1361     7649    3           IF CNT(0)=0 THEN DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:68   
     1362     7650    4              IF SIGNC~=' ' THEN DO;
     1363     7651    4                 FSIG=FSIG-1;
     1364     7652    4                 CALL INSERT(NUMBUF,FSIG,1,SIGNC);
     1365     7653    4                 END;
     1366     7654    3              CALL FIELD(SUBSTR(NUMBUF,FSIG),37-FSIG,37-FSIG);
     1367     7655    3              END;
     1368     7656    3           ELSE DO;
     1369     7657    3              IF FLAGS.STAR AND CNT(0)<37-FSIG THEN NUMBUF=STARS;
     1370     7658    4              IF FLAGS.LZ AND CNT(0)>37-FSIG THEN DO;
     1371     7659    4                 IF CNT(0) > 37 THEN CNT(0) = 37;
     1372     7660    4                 CALL INSERT(NUMBUF,37-CNT(0),CNT(0)-(37-FSIG),ZEROES);
     1373     7661    4                 IF SIGNC~=' ' THEN CALL INSERT(NUMBUF,37-CNT(0),1,SIGNC);
     1374     7662    4                 CALL FIELD(SUBSTR(NUMBUF,37-CNT(0)),CNT(0),CNT(0));
     1375     7663    4                 END;
     1376     7664    4              ELSE DO;
     1377     7665    5                 IF SIGNC~=' ' THEN DO;
     1378     7666    5                    FSIG=FSIG-1;
     1379     7667    5                    CALL INSERT(NUMBUF,FSIG,1,SIGNC);
     1380     7668    5                    END;
     1381     7669    4                 CALL FIELD(SUBSTR(NUMBUF,FSIG),37-FSIG,CNT(0));
     1382     7670    4                 END;
     1383     7671    3              END;
     1384     7672    2           RETURN;
     1385     7673    2   NO_MEM: ALTRETURN;
     1386     7674    2   END NUMERIC;
     1387     7675
     1388     7676    1   END XUF$FORMAT1;
     1389     7677        %EOD;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:69   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUF$FORMAT1.

   Procedure XUF$FORMAT1 requires 2959 words for executable code.
   Procedure XUF$FORMAT1 requires 118 words of local(AUTO) storage.

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:70   

 Object Unit name= XUF$FORMAT1                                File name= XUF$FORMAT.:E05TOU
 UTS= JUL 30 '97 09:15:40.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    267    413  XUF$FORMAT1
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none  2959   5617  XUF$FORMAT1
    3  RoData even  none    43     53  XUF$FORMAT1

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  XUF$FORMAT1

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       3 XUF$ERRMSG
         yes           Std       3 XUF$PTR
         yes           Std       3 XUF$DESC
         yes           Std       3 XUF$UNFID
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:71   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    B$SR_NON_BLANK$                  r    B$XL_ASC_DUMP$
r    B$XL_EBC_DUMP$                        B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:72   


      338        1        /*T***********************************************************/
      339        2        /*T*                                                         */
      340        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      341        4        /*T*                                                         */
      342        5        /*T***********************************************************/
      343        6        XUF$FORMAT1: PROC (FDS);

      6  2 000000   000000 700200 xent  XUF$FORMAT1  TSX0  ! X66_AUTO_1
         2 000001   000166 000001                    ZERO    118,1

      344        7
      345        8        %INCLUDE XU_FORMAT_C;
      346      170        %F_FDS (NAME=FDS,STCLASS="");
      347      283        /**/
      348      284    1   DCL XUF$DESC ENTRY(3);
      349      285    1   DCL XUF$PTR ENTRY(3);
      350      286    1   DCL XUF$ERRMSG ENTRY(3);
      351      287    1   DCL XUF$UNFID ENTRY(3);
      352      288        /**/
      353      289    1   DCL BUFFER CHAR(FDS.BUFSIZE) BASED(FDS.BUF_.BUF$);
      354      290    1   DCL FMTX SBIN;
      355      291    1   DCL SAVEFMTX SBIN;
      356      292    1   DCL FMT CHAR(FDS.FMTSIZE) BASED(FDS.FMT_.FMT$);
      357      293    1   DCL 1 MEMVEC(0:0) BASED(FDS.VECTR$),
      358      294    1         2 BOUND UBIN(20) UNAL,
      359      295    1         2 * BIT(16) UNAL,
      360      296    1         2 PTR$ PTR;
      361      297    1   DCL LOOPING BIT(1) ALIGNED;
      362      298    1   DCL FORMATTING BIT(1) ALIGNED;
      363      299    1   DCL TEMP UBIN;
      364      300    1   DCL STEMP REDEF TEMP SBIN;
      365      301    1   DCL 1 TEMPY(0:3) REDEF TEMP,
      366      302    1         2 * BIT(1),
      367      303    1         2 LH UBIN(4) UNAL,
      368      304    1         2 RH UBIN(4) UNAL;
      369      305    1   DCL 1 TEMPB REDEF TEMP,
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:73   
      370      306    1         2 REST UBIN(35) UNAL,
      371      307    1         2 LSB UBIN(1) UNAL;
      372      308    1   DCL 1 TEMPO REDEF TEMP,
      373      309    1         2 REST UBIN(33) UNAL,
      374      310    1         2 LSD UBIN(3) UNAL;
      375      311    1   DCL 1 TEMPX REDEF TEMP,
      376      312    1         2 REST UBIN(32) UNAL,
      377      313    1         2 LSD UBIN(4) UNAL;
      378      314    1   DCL 1 FLAGS ALIGNED,
      379      315    1         2 LZ BIT(1),
      380      316    1         2 LJ BIT(1),
      381      317    1         2 SIGN BIT(1),
      382      318    1         2 MSD BIT(1),
      383      319    1         2 DTB BIT(1),
      384      320    1         2 DLB BIT(1),
      385      321    1         2 STAR BIT(1),
      386      322    1         2 FIELD BIT(1),
      387      323    1         2 L6 BIT(1),
      388      324    1         2 ARITH BIT(1),
      389      325    1         2 CNT1 BIT(1);
      390      326        %EQU FLG_ARITH='0004'O;
      391      327        %EQU FLG_CNT1='0002'O;
      392      328        %EQU FLG_LZ='400'O;
      393      329        %EQU FLG_LJ='200'O;
      394      330        %EQU FLG_SIGN='100'O;
      395      331        %EQU FLG_MSD='040'O;
      396      332        %EQU FLG_DTB='020'O;
      397      333        %EQU FLG_DLB='010'O;
      398      334        %EQU FLG_STAR='004'O;
      399      335        %EQU FLG_FIELD='002'O;
      400      336        %EQU FLG_L6='001'O;
      401      337    1   DCL CNT(0:3) SBIN;
      402      338    1   DCL CNTB(0:3) REDEF CNT BIT(36);
      403      339    1   DCL CNTX SBIN;
      404      340    1   DCL SAVCNT SBIN;
      405      341    1   DCL SAVCNTB REDEF SAVCNT BIT(36);
      406      342    1   DCL CODE SBIN;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:74   
      407      343    1   DCL CODEVEC CHAR(0) CONSTANT
      408      344    1   INIT('0123456789.^/-%()SQPNV!ATZL+MDYOBHEX<>UJ*F&R\@[?]:C=#K|');
      409      345        /* Unused codes are "',;GIW_abcdefghijklmnopqrstuvwxyz{}~ */
      410      346    1   DCL CONTCHARS CHAR(0) CONSTANT INIT('0123456789:N.ZL+M<>*&K#@');
      411      347    1   DCL ARTHCHARS CHAR(0) CONSTANT INIT('+-*/&|\=?<>');
      412      348    1   DCL I SBIN;
      413      349    1   DCL PERCENT SBIN;
      414      350    1   DCL MEM$ PTR;
      415      351    1   DCL SIGNC CHAR(1) ALIGNED;
      416      352    1   DCL DBUF CHAR(80);            /* 80 and 37 is 120, big enough for M$ERRMSG */
      417      353    1   DCL NUMBUF CHAR(37) ALIGNED;
      418      354    1   DCL STARS CHAR(37) CONSTANT INIT('*************************************');
      419      355    1   DCL ZEROES CHAR(37) CONSTANT INIT('0000000000000000000000000000000000000');
      420      356    1   DCL CONTAB CHAR(0) CONSTANT INIT('0123456789ABCDEF');
      421      357    1   DCL BLANKS CHAR(4) CONSTANT ALIGNED INIT(' ');
      422      358    1   DCL X SBIN;
      423      359    1   DCL FSIG SBIN;
      424      360    1   DCL DWID SBIN;
      425      361    1   DCL TWID SBIN;
      426      362    1   DCL 1 ERRCD ALIGNED,
      427      363    1         2 FCG(0:2) UBIN(6) UNAL,
      428      364    1         2 MON BIT(1),
      429      365    1         2 CODE UBIN(14) UNAL,
      430      366    1         2 SEV UBIN(3) UNAL;
      431      367    1   DCL DSIZ SBIN;
      432      368    1   DCL 1 DESC,
      433      369    1         2 W0 UBIN,
      434      370    1         2 W1 UBIN;
      435      371    1   DCL ONECHAR CHAR(1) BASED;
      436      372    1   DCL ONEBIT BIT(1) BASED UNAL;
      437      373        /**/
      438      374        %SUB NEVER="WHILE('0'B)";
      439      375        %SUB FOREVER="WHILE('1'B)";
      440      376        %INCLUDE B$TABLES_C;
      441      484        %INCLUDE CP_6;
      442     6043        %INCLUDE CP_6_SUBS;
      443     6583        %B$SR_NON_BLANK (NAME=SEARCHNB);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:75   
      444     6587        %B$XL_ASC_DUMP (NAME=ASC_DUMP);
      445     6591        %B$XL_EBC_DUMP (NAME=EBC_DUMP);
      446     6595        %F$DCB;
      447     6652        %FPT_DEVICE (FPTN=FPT$DEVICE,STCLASS="BASED(FDS.DEVICEFPT$)");
      448     6670        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS="BASED(FDS.WRITEFPT$)");
      449     6701        %FPT_TIME (FPTN=FPT_TIME,STCLASS=CONSTANT);
      450     6720        %FPT_TIME (FPTN=FPT$TIME,STCLASS=AUTO);
      451     6739    1   DCL DATEWIDTH(0:11) UBIN BYTE CALIGNED CONSTANT INIT(8,10,6,0,8,10,6,0,8,10,6,0);
      452     6740    1   DCL TIMEWIDTH(0:11) UBIN BYTE CALIGNED CONSTANT INIT(5,5,4,0,8,8,6,0,11,11,8,0);
      453     6741    1   DCL TIMEDEST(0:3) UBIN BYTE CALIGNED CONSTANT INIT(%LOCAL#,%EXT#,%ANS#,0);
      454     6742    1   DCL STR_DUMP(0:511) UBIN BYTE CALIGNED CONSTANT INIT (
      455     6743    1     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
      456     6744    1    20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
      457     6745    1    40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,
      458     6746    1    60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79,
      459     6747    1    80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99,
      460     6748    1   100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,
      461     6749    1   120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,
      462     6750    1   140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,
      463     6751    1   160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,
      464     6752    1   180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,
      465     6753    1   200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,
      466     6754    1   220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
      467     6755    1   240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,
      468     6756    1   260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,
      469     6757    1   280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,
      470     6758    1   300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,
      471     6759    1   320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,
      472     6760    1   340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,
      473     6761    1   360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,
      474     6762    1   380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,
      475     6763    1   400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,
      476     6764    1   420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,
      477     6765    1   440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,
      478     6766    1   460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,
      479     6767    1   480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,
      480     6768    1   500,501,502,503,504,505,506,507,508,509,510,511);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:76   
      481     6769    1   DCL TRANS$ PTR;
      482     6770    1   DCL TRANS CHAR(512) ALIGNED BASED( TRANS$);
      483     6771    1   DCL 1 G BASED(FDS.GLOBAL$) ALIGNED,
      484     6772    1         2 INDX(0:99) SBIN;           /* OFFSETS FOR SUBROUTINES AND VARIABLES */
      485     6773        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:77   
      486     6774    1           IF FDS.MEMX<0 THEN CALL SETMEM(0,0);

   6774  2 000002   200003 470500                    LDP0    @FDS,,AUTO
         2 000003   000026 235100                    LDA     22,,PR0
         2 000004   000012 605000 2                  TPL     s:6775

   6774  2 000005   000000 236000 3                  LDQ     0
         2 000006   200126 756100                    STQ     @STRING+1,,AUTO
         2 000007   200125 756100                    STQ     M$+3,,AUTO
         2 000010   003355 701000 2                  TSX1    SETMEM
         2 000011   000000 011000                    NOP     0

      487     6775    1           TRANS$ = ADDR( STR_DUMP);

   6775  2 000012   000001 236000 3                  LDQ     1
         2 000013   200110 756100                    STQ     TRANS$,,AUTO

      488     6776    1           FMTX=FDS.FMTX;

   6776  2 000014   200003 470500                    LDP0    @FDS,,AUTO
         2 000015   000002 235100                    LDA     2,,PR0
         2 000016   200004 755100                    STA     FMTX,,AUTO

      489     6777    2           IF FDS.DEBUG THEN DO;

   6777  2 000017   000013 236100                    LDQ     11,,PR0
         2 000020   000200 316007                    CANQ    128,DL
         2 000021   000051 600000 2                  TZE     s:6783

      490     6778    2              DBUF=%CONCAT(BITASC('037'O),'Level-00 Entry');

   6778  2 000022   040100 100400                    MLR     fill='040'O
         2 000023   000303 000017 0                  ADSC9   STR_DUMP+128             cn=0,n=15
         2 000024   200025 000120                    ADSC9   DBUF,,AUTO               cn=0,n=80

      491     6779    2              CALL BINCHAR(SUBSTR(DBUF,7,2),POFFW(ADDR(SAVEFMTX),FDS.GLOBAL$)/106);

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:78   
   6779  2 000025   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 000026   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 000027   000005 036003                    ADLQ    5,DU
         2 000030   000022 772000                    QRL     18
         2 000031   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 000032   000032 236100                    LDQ     26,,PR0
         2 000033   000022 772000                    QRL     18
         2 000034   200144 756100                    STQ     TABLEVAL+8,,AUTO
         2 000035   200143 236100                    LDQ     TABLEVAL+7,,AUTO
         2 000036   200144 136100                    SBLQ    TABLEVAL+8,,AUTO
         2 000037   000152 506007                    DIV     106,DL
         2 000040   200145 756100                    STQ     TABLEVAL+9,,AUTO
         2 000041   000100 301500                    BTD
         2 000042   200145 000004                    NDSC9   TABLEVAL+9,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         2 000043   200026 630002                    NDSC9   DBUF+1,,AUTO             cn=3,s=nosgn,sf=0,n=2

      492     6780    2              PERCENT=FMTX+1;

   6780  2 000044   200004 235100                    LDA     FMTX,,AUTO
         2 000045   000001 035007                    ADLA    1,DL
         2 000046   200022 755100                    STA     PERCENT,,AUTO

      493     6781    2              CALL DEBUG_OUT;

   6781  2 000047   005234 701000 2                  TSX1    DEBUG_OUT
         2 000050   000000 011000                    NOP     0

      494     6782    2              END;

      495     6783    1           SAVEFMTX=FDS.FMTXMAX;

   6783  2 000051   200003 470500                    LDP0    @FDS,,AUTO
         2 000052   000003 235100                    LDA     3,,PR0
         2 000053   200005 755100                    STA     SAVEFMTX,,AUTO

      496     6784    1           LOOPING='1'B;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:79   
   6784  2 000054   400000 236003                    LDQ     -131072,DU
         2 000055   200006 756100                    STQ     LOOPING,,AUTO

      497     6785    2           DO WHILE(LOOPING);

   6785  2 000056   200006 234100                    SZN     LOOPING,,AUTO
         2 000057   003140 605000 2                  TPL     s:7263

      498     6786    2              FLAGS=%FLG_MSD;

   6786  2 000060   040000 236003                    LDQ     16384,DU
         2 000061   200011 756100                    STQ     FLAGS,,AUTO

      499     6787    2              SIGNC=' ';

   6787  2 000062   200024 756100                    STQ     SIGNC,,AUTO

      500     6788    2              CALL INDEX (PERCENT,'%',FMT,FMTX) ALTRET(END_FMT);

   6788  2 000063   200003 470500                    LDP0    @FDS,,AUTO
         2 000064   000001 471500                    LDP1    1,,PR0
         2 000065   000004 720100                    LXL0    4,,PR0
         2 000066   000000 636010                    EAQ     0,X0
         2 000067   000022 732000                    QRS     18
         2 000070   200004 136100                    SBLQ    FMTX,,AUTO
         2 000071   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 000072   200004 236100                    LDQ     FMTX,,AUTO
         2 000073   200142 720100                    LXL0    TABLEVAL+6,,AUTO
         2 000074   200004 235100                    LDA     FMTX,,AUTO
         2 000075   000000 124545                    SCM     mask='000'O
         2 000076   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 000077   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000100   200022 000100                    ARG     PERCENT,,AUTO
         2 000101   200022 056100                    ASQ     PERCENT,,AUTO
         2 000102   000104 606400 2                  TTN     END_FMT

      501     6789    3              DO NEVER;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:80   

   6789  2 000103   000110 710000 2                  TRA     s:6793

      502     6790    3   END_FMT:      PERCENT=FDS.FMTSIZE;

   6790  2 000104   200003 470500       END_FMT      LDP0    @FDS,,AUTO
         2 000105   000004 235100                    LDA     4,,PR0
         2 000106   200022 755100                    STA     PERCENT,,AUTO

      503     6791    3                 LOOPING='0'B;

   6791  2 000107   200006 450100                    STZ     LOOPING,,AUTO

      504     6792    3                 END;

      505     6793    2              IF PERCENT>FMTX THEN

   6793  2 000110   200022 236100                    LDQ     PERCENT,,AUTO
         2 000111   200004 116100                    CMPQ    FMTX,,AUTO
         2 000112   000142 604400 2                  TMOZ    s:6795

      506     6794    2                 CALL FIELD(SUBSTR(FMT,FMTX),PERCENT-FMTX,PERCENT-FMTX);

   6794  2 000113   000001 471500                    LDP1    1,,PR0
         2 000114   000004 720100                    LXL0    4,,PR0
         2 000115   000000 636010                    EAQ     0,X0
         2 000116   000022 732000                    QRS     18
         2 000117   200004 136100                    SBLQ    FMTX,,AUTO
         2 000120   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 000121   200022 236100                    LDQ     PERCENT,,AUTO
         2 000122   200004 136100                    SBLQ    FMTX,,AUTO
         2 000123   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 000124   200022 236100                    LDQ     PERCENT,,AUTO
         2 000125   200004 136100                    SBLQ    FMTX,,AUTO
         2 000126   200143 235100                    LDA     TABLEVAL+7,,AUTO
         2 000127   200146 755100                    STA     TABLEVAL+10,,AUTO
         2 000130   200147 756100                    STQ     TABLEVAL+11,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:81   
         2 000131   200147 633500                    EPPR3   TABLEVAL+11,,AUTO
         2 000132   200127 453500                    STP3    @SIZ+1,,AUTO
         2 000133   200146 634500                    EPPR4   TABLEVAL+10,,AUTO
         2 000134   200126 454500                    STP4    @STRING+1,,AUTO
         2 000135   200004 235100                    LDA     FMTX,,AUTO
         2 000136   100000 500505                    A9BD    0,AL,PR1
         2 000137   200125 451500                    STP1    M$+3,,AUTO
         2 000140   004440 701000 2                  TSX1    FIELD
         2 000141   000000 011000                    NOP     0

      507     6795    2              FORMATTING=LOOPING;

   6795  2 000142   200006 236100                    LDQ     LOOPING,,AUTO
         2 000143   400000 376003                    ANQ     -131072,DU
         2 000144   200007 756100                    STQ     FORMATTING,,AUTO

      508     6796    2              FMTX=PERCENT;

   6796  2 000145   200022 235100                    LDA     PERCENT,,AUTO
         2 000146   200004 755100                    STA     FMTX,,AUTO

      509     6797    2              FLAGS='0'B;

   6797  2 000147   200011 450100                    STZ     FLAGS,,AUTO

      510     6798    2              CNT='0'B;

   6798  2 000150   000100 100400                    MLR     fill='000'O
         2 000151   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000152   200012 000020                    ADSC9   CNT,,AUTO                cn=0,n=16

      511     6799    2              CNTX=0;

   6799  2 000153   200016 450100                    STZ     CNTX,,AUTO

      512     6800    3              DO WHILE(FORMATTING);

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:82   
   6800  2 000154   200007 234100                    SZN     FORMATTING,,AUTO
         2 000155   003114 605000 2                  TPL     s:7256

      513     6801    3                 FMTX=FMTX+1;

   6801  2 000156   200004 054100                    AOS     FMTX,,AUTO

      514     6802    3                 CALL INDEX (CODE,SUBSTR(FMT,FMTX,1),CODEVEC) ALTRET(BAD_CODE);

   6802  2 000157   200003 470500                    LDP0    @FDS,,AUTO
         2 000160   000001 471500                    LDP1    1,,PR0
         2 000161   000004 720100                    LXL0    4,,PR0
         2 000162   200004 235100                    LDA     FMTX,,AUTO
         2 000163   000105 124400                    SCM     mask='000'O
         2 000164   000000 000067 0                  ADSC9   CODEVEC                  cn=0,n=55
         2 000165   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 000166   200020 000100                    ARG     CODE,,AUTO
         2 000167   003161 606400 2                  TTN     BAD_CODE

      515     6803    4                 DO CASE(CODE);

   6803  2 000170   200020 236100                    LDQ     CODE,,AUTO
         2 000171   000067 116007                    CMPQ    55,DL
         2 000172   000174 602006 2                  TNC     s:6803+4,QL
         2 000173   003112 710000 2                  TRA     s:7255
         2 000174   000263 710000 2                  TRA     s:6805
         2 000175   000263 710000 2                  TRA     s:6805
         2 000176   000263 710000 2                  TRA     s:6805
         2 000177   000263 710000 2                  TRA     s:6805
         2 000200   000263 710000 2                  TRA     s:6805
         2 000201   000263 710000 2                  TRA     s:6805
         2 000202   000263 710000 2                  TRA     s:6805
         2 000203   000263 710000 2                  TRA     s:6805
         2 000204   000263 710000 2                  TRA     s:6805
         2 000205   000263 710000 2                  TRA     s:6805
         2 000206   000271 710000 2                  TRA     s:6807
         2 000207   000273 710000 2                  TRA     s:6809
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:83   
         2 000210   000277 710000 2                  TRA     s:6812
         2 000211   000324 710000 2                  TRA     s:6822
         2 000212   000427 710000 2                  TRA     s:6848
         2 000213   000437 710000 2                  TRA     s:6851
         2 000214   000602 710000 2                  TRA     s:6882
         2 000215   000624 710000 2                  TRA     s:6888
         2 000216   000676 710000 2                  TRA     s:6903
         2 000217   000722 710000 2                  TRA     s:6909
         2 000220   001034 710000 2                  TRA     s:6925
         2 000221   001044 710000 2                  TRA     s:6927
         2 000222   001102 710000 2                  TRA     s:6938
         2 000223   001122 710000 2                  TRA     s:6945
         2 000224   001202 710000 2                  TRA     s:6961
         2 000225   001230 710000 2                  TRA     s:6966
         2 000226   001233 710000 2                  TRA     s:6968
         2 000227   001236 710000 2                  TRA     s:6970
         2 000230   001251 710000 2                  TRA     s:6976
         2 000231   001254 710000 2                  TRA     s:6978
         2 000232   001311 710000 2                  TRA     s:6990
         2 000233   001367 710000 2                  TRA     s:6999
         2 000234   001375 710000 2                  TRA     s:7002
         2 000235   001403 710000 2                  TRA     s:7005
         2 000236   001411 710000 2                  TRA     s:7008
         2 000237   001436 710000 2                  TRA     s:7015
         2 000240   001477 710000 2                  TRA     s:7026
         2 000241   001514 710000 2                  TRA     s:7032
         2 000242   001531 710000 2                  TRA     s:7038
         2 000243   001731 710000 2                  TRA     s:7071
         2 000244   002131 710000 2                  TRA     s:7098
         2 000245   002144 710000 2                  TRA     s:7104
         2 000246   002340 710000 2                  TRA     s:7127
         2 000247   002353 710000 2                  TRA     s:7133
         2 000250   002410 710000 2                  TRA     s:7142
         2 000251   002424 710000 2                  TRA     s:7149
         2 000252   002427 710000 2                  TRA     s:7151
         2 000253   002635 710000 2                  TRA     s:7188
         2 000254   002653 710000 2                  TRA     CASE_48
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:84   
         2 000255   002661 710000 2                  TRA     s:7196
         2 000256   002670 710000 2                  TRA     s:7200
         2 000257   002775 710000 2                  TRA     s:7224
         2 000260   003047 710000 2                  TRA     s:7242
         2 000261   003065 710000 2                  TRA     s:7247
         2 000262   003070 710000 2                  TRA     s:7249

      516     6804    4                  CASE(0,1,2,3,4,5,6,7,8,9);

      517     6805    4                    CNT(CNTX)=CNT(CNTX)*10+CODE;

   6805  2 000263   200016 721100                    LXL1    CNTX,,AUTO
         2 000264   200012 236111                    LDQ     CNT,X1,AUTO
         2 000265   000012 402007                    MPY     10,DL
         2 000266   200020 036100                    ADLQ    CODE,,AUTO
         2 000267   200012 756111                    STQ     CNT,X1,AUTO
         2 000270   003112 710000 2                  TRA     s:7255

      518     6806    4   /* . */        CASE(10);

      519     6807    4                    CNTX=CNTX+1;

   6807  2 000271   200016 054100                    AOS     CNTX,,AUTO
         2 000272   003112 710000 2                  TRA     s:7255

      520     6808    4   /* ^ */        CASE(11);

      521     6809    4                    FDS.RESCAN=FMTX+1;

   6809  2 000273   000001 035007                    ADLA    1,DL
         2 000274   000020 755100                    STA     16,,PR0

      522     6810    4                    FORMATTING='0'B;

   6810  2 000275   200007 450100                    STZ     FORMATTING,,AUTO
         2 000276   003112 710000 2                  TRA     s:7255

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:85   
      523     6811    4   /* / */        CASE(12);

      524     6812    5                    IF FLAGS.ARITH THEN DO;

   6812  2 000277   200011 236100                    LDQ     FLAGS,,AUTO
         2 000300   000400 316003                    CANQ    256,DU
         2 000301   000307 600000 2                  TZE     s:6816

      525     6813    5                       CNT(CNTX) = SAVCNT/CNT(CNTX);

   6813  2 000302   200016 721100                    LXL1    CNTX,,AUTO
         2 000303   200017 236100                    LDQ     SAVCNT,,AUTO
         2 000304   200012 506111                    DIV     CNT,X1,AUTO
         2 000305   200012 756111                    STQ     CNT,X1,AUTO

      526     6814    5                       GOTO ARITH_DONE;

   6814  2 000306   003110 710000 2                  TRA     ARITH_DONE

      527     6815    5                       END;
      528     6816    4                    CALL BUF_OUT;

   6816  2 000307   003441 701000 2                  TSX1    BUF_OUT
         2 000310   000000 011000                    NOP     0

      529     6817    5                    DO I=2 TO CNT(0);

   6817  2 000311   000002 235007                    LDA     2,DL
         2 000312   200021 755100                    STA     I,,AUTO
         2 000313   000317 710000 2                  TRA     s:6819+1

      530     6818    5                       CALL BUF_OUT;

   6818  2 000314   003441 701000 2                  TSX1    BUF_OUT
         2 000315   000000 011000                    NOP     0

      531     6819    5                       END;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:86   

   6819  2 000316   200021 054100                    AOS     I,,AUTO
         2 000317   200021 236100                    LDQ     I,,AUTO
         2 000320   200012 116100                    CMPQ    CNT,,AUTO
         2 000321   000314 604400 2                  TMOZ    s:6818

      532     6820    4                    FORMATTING='0'B;

   6820  2 000322   200007 450100                    STZ     FORMATTING,,AUTO
         2 000323   003112 710000 2                  TRA     s:7255

      533     6821    4   /* - */        CASE(13);

      534     6822    5                    IF FLAGS.ARITH THEN DO;

   6822  2 000324   200011 236100                    LDQ     FLAGS,,AUTO
         2 000325   000400 316003                    CANQ    256,DU
         2 000326   000334 600000 2                  TZE     s:6826

      535     6823    5                       CNT(CNTX) = SAVCNT-CNT(CNTX);

   6823  2 000327   200016 721100                    LXL1    CNTX,,AUTO
         2 000330   200017 236100                    LDQ     SAVCNT,,AUTO
         2 000331   200012 136111                    SBLQ    CNT,X1,AUTO
         2 000332   200012 756111                    STQ     CNT,X1,AUTO

      536     6824    5                       GOTO ARITH_DONE;

   6824  2 000333   003110 710000 2                  TRA     ARITH_DONE

      537     6825    5                       END;
      538     6826    4                    IF CNT(1)>0 THEN FDS.TABDFLT#=CNT(1);

   6826  2 000334   200013 235100                    LDA     CNT+1,,AUTO
         2 000335   000337 604400 2                  TMOZ    s:6827

   6826  2 000336   000017 755100                    STA     15,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:87   

      539     6827    4                    IF CNT(2)>0 THEN FDS.WRAPTAB#=CNT(2);

   6827  2 000337   200014 235100                    LDA     CNT+2,,AUTO
         2 000340   000342 604400 2                  TMOZ    s:6828

   6827  2 000341   000016 755100                    STA     14,,PR0

      540     6828    4                    IF FDS.BLNKBUF THEN CALL BLANKBUF;

   6828  2 000342   000013 236100                    LDQ     11,,PR0
         2 000343   000100 316007                    CANQ    64,DL
         2 000344   000347 600000 2                  TZE     s:6829

   6828  2 000345   003662 701000 2                  TSX1    BLANKBUF
         2 000346   000000 011000                    NOP     0

      541     6829    5                    IF CNT(0)>0 THEN DO;

   6829  2 000347   200012 235100                    LDA     CNT,,AUTO
         2 000350   000366 604400 2                  TMOZ    s:6835

      542     6830    5                       IF FLAGS.DTB AND CNT(0)<FDS.BUFX THEN

   6830  2 000351   200011 236100                    LDQ     FLAGS,,AUTO
         2 000352   020000 316003                    CANQ    8192,DU
         2 000353   000364 600000 2                  TZE     s:6833
         2 000354   200003 470500                    LDP0    @FDS,,AUTO
         2 000355   200012 236100                    LDQ     CNT,,AUTO
         2 000356   000007 116100                    CMPQ    7,,PR0
         2 000357   000364 605000 2                  TPL     s:6833

      543     6831    5                          I=FDS.BUFX+1;

   6831  2 000360   000007 235100                    LDA     7,,PR0
         2 000361   000001 035007                    ADLA    1,DL
         2 000362   200021 755100                    STA     I,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:88   
         2 000363   000401 710000 2                  TRA     s:6836

      544     6832    5                       ELSE
      545     6833    5                          I=CNT(0);

   6833  2 000364   200021 755100                    STA     I,,AUTO

      546     6834    5                       END;

   6834  2 000365   000401 710000 2                  TRA     s:6836

      547     6835    4                    ELSE I=FDS.BUFX+FDS.TABDFLT#+1-MOD(FDS.BUFX-1,FDS.TABDFLT#)-1;

   6835  2 000366   200003 470500                    LDP0    @FDS,,AUTO
         2 000367   000007 236100                    LDQ     7,,PR0
         2 000370   000017 036100                    ADLQ    15,,PR0
         2 000371   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 000372   000007 236100                    LDQ     7,,PR0
         2 000373   000001 136007                    SBLQ    1,DL
         2 000374   000017 506100                    DIV     15,,PR0
         2 000375   200143 755100                    STA     TABLEVAL+7,,AUTO
         2 000376   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 000377   200143 136100                    SBLQ    TABLEVAL+7,,AUTO
         2 000400   200021 756100                    STQ     I,,AUTO

      548     6836    5                    IF I>FDS.BUF_.BOUND THEN DO;

   6836  2 000401   200003 470500                    LDP0    @FDS,,AUTO
         2 000402   000005 236100                    LDQ     5,,PR0
         2 000403   000020 772000                    QRL     16
         2 000404   200021 116100                    CMPQ    I,,AUTO
         2 000405   000422 605000 2                  TPL     s:6845

      549     6837    6                       IF FDS.TRUNC# THEN DO;

   6837  2 000406   000013 236100                    LDQ     11,,PR0
         2 000407   000400 316007                    CANQ    256,DL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:89   
         2 000410   000416 600000 2                  TZE     s:6841

      550     6838    6                          I=FDS.BUF_.BOUND+1;

   6838  2 000411   000005 236100                    LDQ     5,,PR0
         2 000412   000020 772000                    QRL     16
         2 000413   000001 036007                    ADLQ    1,DL
         2 000414   200021 756100                    STQ     I,,AUTO

      551     6839    6                          END;

   6839  2 000415   000422 710000 2                  TRA     s:6845

      552     6840    6                       ELSE DO;

      553     6841    6                          CALL BUF_OUT;

   6841  2 000416   003441 701000 2                  TSX1    BUF_OUT
         2 000417   000000 011000                    NOP     0

      554     6842    6                          I=1;

   6842  2 000420   000001 235007                    LDA     1,DL
         2 000421   200021 755100                    STA     I,,AUTO

      555     6843    6                          END;

      556     6844    5                       END;

      557     6845    4                    FDS.BUFX=I;

   6845  2 000422   200003 470500                    LDP0    @FDS,,AUTO
         2 000423   200021 235100                    LDA     I,,AUTO
         2 000424   000007 755100                    STA     7,,PR0

      558     6846    4                    FORMATTING='0'B;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:90   
   6846  2 000425   200007 450100                    STZ     FORMATTING,,AUTO
         2 000426   003112 710000 2                  TRA     s:7255

      559     6847    4   /* % */        CASE(14);

      560     6848    4                    CALL FIELD('%',1,1);

   6848  2 000427   000004 237000 3                  LDAQ    4
         2 000430   200126 757100                    STAQ    @STRING+1,,AUTO
         2 000431   000003 236000 3                  LDQ     3
         2 000432   200125 756100                    STQ     M$+3,,AUTO
         2 000433   004440 701000 2                  TSX1    FIELD
         2 000434   000000 011000                    NOP     0

      561     6849    4                    FORMATTING='0'B;

   6849  2 000435   200007 450100                    STZ     FORMATTING,,AUTO
         2 000436   003112 710000 2                  TRA     s:7255

      562     6850    4   /* ( */        CASE(15);

      563     6851    5                    IF CNT(0)<=0 THEN DO;

   6851  2 000437   200012 235100                    LDA     CNT,,AUTO
         2 000440   000550 605400 2                  TPNZ    s:6872

      564     6852    5                       I=1;

   6852  2 000441   000001 235007                    LDA     1,DL
         2 000442   200021 755100                    STA     I,,AUTO

      565     6853    6                       DO UNTIL(I=0);

      566     6854    6                          CALL INDEX (FMTX,'%',FMT,FMTX+1) ALTRET(BAD_FMT);

   6854  2 000443   200003 470500                    LDP0    @FDS,,AUTO
         2 000444   000001 471500                    LDP1    1,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:91   
         2 000445   000004 720100                    LXL0    4,,PR0
         2 000446   000000 636010                    EAQ     0,X0
         2 000447   000022 732000                    QRS     18
         2 000450   200004 136100                    SBLQ    FMTX,,AUTO
         2 000451   777777 621006                    EAX1    -1,QL
         2 000452   200004 236100                    LDQ     FMTX,,AUTO
         2 000453   000001 036007                    ADLQ    1,DL
         2 000454   200004 235100                    LDA     FMTX,,AUTO
         2 000455   000000 124545                    SCM     mask='000'O
         2 000456   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
         2 000457   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000460   200004 000100                    ARG     FMTX,,AUTO
         2 000461   200004 056100                    ASQ     FMTX,,AUTO
         2 000462   003157 606400 2                  TTN     BAD_FMT

      567     6855    7                          DO WHILE '1'B;

      568     6856    7                             FMTX=FMTX+1;

   6856  2 000463   200004 054100                    AOS     FMTX,,AUTO

      569     6857    7                             IF FMTX>=FDS.FMTSIZE THEN GOTO BAD_FMT;

   6857  2 000464   200003 470500                    LDP0    @FDS,,AUTO
         2 000465   200004 236100                    LDQ     FMTX,,AUTO
         2 000466   000004 116100                    CMPQ    4,,PR0
         2 000467   003157 605000 2                  TPL     BAD_FMT

      570     6858    7                             IF NOT FLAGS.ARITH

   6858  2 000470   200011 236100                    LDQ     FLAGS,,AUTO
         2 000471   000400 316003                    CANQ    256,DU
         2 000472   000504 601000 2                  TNZ     s:6861

      571     6859    7                             THEN CALL INDEX (X,SUBSTR(FMT,FMTX,1),CONTCHARS)

   6859  2 000473   000001 471500                    LDP1    1,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:92   
         2 000474   000004 720100                    LXL0    4,,PR0
         2 000475   200004 235100                    LDA     FMTX,,AUTO
         2 000476   000105 124400                    SCM     mask='000'O
         2 000477   000016 000030 0                  ADSC9   CONTCHARS                cn=0,n=24
         2 000500   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 000501   200063 000100                    ARG     X,,AUTO
         2 000502   000524 606400 2                  TTN     CHK_OP
         2 000503   000516 710000 2                  TRA     s:6863

      572     6860    7                                  ALTRET(CHK_OP);
      573     6861    7                             ELSE CALL INDEX (X,SUBSTR(FMT,FMTX,1),ARTHCHARS)

   6861  2 000504   000001 471500                    LDP1    1,,PR0
         2 000505   000004 720100                    LXL0    4,,PR0
         2 000506   200004 235100                    LDA     FMTX,,AUTO
         2 000507   000105 124400                    SCM     mask='000'O
         2 000510   000024 000013 0                  ADSC9   ARTHCHARS                cn=0,n=11
         2 000511   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 000512   200063 000100                    ARG     X,,AUTO
         2 000513   000516 606400 2                  TTN     s:6863

      574     6862    8                                WHENRETURN DO; FLAGS.ARITH='0'B; END;

   6862  2 000514   000006 236000 3                  LDQ     6
         2 000515   200011 356100                    ANSQ    FLAGS,,AUTO

      575     6863    7                             IF X=10 THEN FLAGS.ARITH='1'B;

   6863  2 000516   200063 235100                    LDA     X,,AUTO
         2 000517   000012 115007                    CMPA    10,DL
         2 000520   000463 601000 2                  TNZ     s:6856

   6863  2 000521   000400 236003                    LDQ     256,DU
         2 000522   200011 256100                    ORSQ    FLAGS,,AUTO

      576     6864    7                             END;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:93   
   6864  2 000523   000463 710000 2                  TRA     s:6856

      577     6865    6   CHK_OP:                IF SUBSTR(FMT,FMTX,1)='(' THEN

   6865  2 000524   200003 470500       CHK_OP       LDP0    @FDS,,AUTO
         2 000525   000001 471500                    LDP1    1,,PR0
         2 000526   000004 720100                    LXL0    4,,PR0
         2 000527   200004 235100                    LDA     FMTX,,AUTO
         2 000530   040000 106505                    CMPC    fill='040'O
         2 000531   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 000532   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000533   000536 601000 2                  TNZ     s:6867

      578     6866    6                             I=I+1;

   6866  2 000534   200021 054100                    AOS     I,,AUTO
         2 000535   000544 710000 2                  TRA     s:6869

      579     6867    6                          ELSE IF SUBSTR(FMT,FMTX,1)=')' THEN

   6867  2 000536   040000 106505                    CMPC    fill='040'O
         2 000537   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 000540   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 000541   000544 601000 2                  TNZ     s:6869

      580     6868    6                                I=I-1;

   6868  2 000542   000001 336007                    LCQ     1,DL
         2 000543   200021 056100                    ASQ     I,,AUTO

      581     6869    6                          END;

   6869  2 000544   200021 236100                    LDQ     I,,AUTO
         2 000545   000443 601000 2                  TNZ     s:6854

      582     6870    5                       FDS.FMTX=FMTX;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:94   
   6870  2 000546   000002 755100                    STA     2,,PR0

      583     6871    5                       END;

   6871  2 000547   000576 710000 2                  TRA     s:6879

      584     6872    5                    ELSE DO WHILE CNT(0)>0;

   6872  2 000550   000576 604400 2                  TMOZ    s:6879

      585     6873    5                       FDS.FMTX=FMTX+1;

   6873  2 000551   200003 470500                    LDP0    @FDS,,AUTO
         2 000552   200004 235100                    LDA     FMTX,,AUTO
         2 000553   000001 035007                    ADLA    1,DL
         2 000554   000002 755100                    STA     2,,PR0

      586     6874    5                       FDS.FMTXMAX=CODE;

   6874  2 000555   200020 236100                    LDQ     CODE,,AUTO
         2 000556   000003 756100                    STQ     3,,PR0

      587     6875    5                       CALL XUF$FORMAT1(FDS);

   6875  2 000557   200003 630500                    EPPR0   @FDS,,AUTO
         2 000560   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000561   000000 701000 2                  TSX1    s:6
         2 000562   000000 011000                    NOP     0

      588     6876    5                       IF FDS.FMTXMAX=CODE THEN CNT(0)=CNT(0)-1;

   6876  2 000563   200003 470500                    LDP0    @FDS,,AUTO
         2 000564   000003 236100                    LDQ     3,,PR0
         2 000565   200020 116100                    CMPQ    CODE,,AUTO
         2 000566   000572 601000 2                  TNZ     s:6877

   6876  2 000567   000001 336007                    LCQ     1,DL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:95   
         2 000570   200012 056100                    ASQ     CNT,,AUTO
         2 000571   000574 710000 2                  TRA     s:6878

      589     6877    5                       ELSE IF FDS.FMTXMAX<=0 THEN EXIT;

   6877  2 000572   000000 116003                    CMPQ    0,DU
         2 000573   000576 604400 2                  TMOZ    s:6879

      590     6878    5                       END;

   6878  2 000574   200012 235100                    LDA     CNT,,AUTO
         2 000575   000551 605400 2                  TPNZ    s:6873

      591     6879    4                    FMTX=FDS.FMTX;

   6879  2 000576   000002 235100                    LDA     2,,PR0
         2 000577   200004 755100                    STA     FMTX,,AUTO

      592     6880    4                    FORMATTING='0'B;

   6880  2 000600   200007 450100                    STZ     FORMATTING,,AUTO
         2 000601   003112 710000 2                  TRA     s:7255

      593     6881    4   /* ) */        CASE(16);

      594     6882    4                    IF SAVEFMTX~=15 THEN GOTO BAD_FMT; /* ILLEGAL AT LEVEL 0 */

   6882  2 000602   200005 235100                    LDA     SAVEFMTX,,AUTO
         2 000603   000017 115007                    CMPA    15,DL
         2 000604   003157 601000 2                  TNZ     BAD_FMT

      595     6883    4                    IF FMTX=PERCENT+1 THEN FDS.FMTXMAX=SAVEFMTX;

   6883  2 000605   200022 236100                    LDQ     PERCENT,,AUTO
         2 000606   000001 036007                    ADLQ    1,DL
         2 000607   200004 116100                    CMPQ    FMTX,,AUTO
         2 000610   000613 601000 2                  TNZ     s:6884
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:96   

   6883  2 000611   000003 755100                    STA     3,,PR0
         2 000612   000621 710000 2                  TRA     s:6885

      596     6884    4                    ELSE FDS.FMTXMAX=MINIMUM(CNT(0),1);

   6884  2 000613   000001 236007                    LDQ     1,DL
         2 000614   000617 604000 2                  TMI     s:6884+4
         2 000615   200012 116100                    CMPQ    CNT,,AUTO
         2 000616   000620 604400 2                  TMOZ    s:6884+5
         2 000617   200012 236100                    LDQ     CNT,,AUTO
         2 000620   000003 756100                    STQ     3,,PR0

      597     6885    4                    FDS.FMTX=FMTX;

   6885  2 000621   200004 235100                    LDA     FMTX,,AUTO
         2 000622   000002 755100                    STA     2,,PR0

      598     6886    4                    GOTO DBG_RETURN;

   6886  2 000623   002700 710000 2                  TRA     DBG_RETURN

      599     6887    4   /* S */        CASE(17);

      600     6888    5                    IF CNT='0'B OR CNT(0)*9>FDS.MEMSZ THEN DO;

   6888  2 000624   000000 106500                    CMPC    fill='000'O
         2 000625   200012 000020                    ADSC9   CNT,,AUTO                cn=0,n=16
         2 000626   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         2 000627   000634 600000 2                  TZE     s:6889
         2 000630   200012 236100                    LDQ     CNT,,AUTO
         2 000631   000011 402007                    MPY     9,DL
         2 000632   000025 116100                    CMPQ    21,,PR0
         2 000633   000646 604400 2                  TMOZ    s:6891

      601     6889    5                       CALL SETMEM(FDS.MEMX+1,0);

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:97   
   6889  2 000634   000026 235100                    LDA     22,,PR0
         2 000635   000001 035007                    ADLA    1,DL
         2 000636   200150 755100                    STA     TABLEVAL+12,,AUTO
         2 000637   000000 236000 3                  LDQ     0
         2 000640   200126 756100                    STQ     @STRING+1,,AUTO
         2 000641   200150 631500                    EPPR1   TABLEVAL+12,,AUTO
         2 000642   200125 451500                    STP1    M$+3,,AUTO
         2 000643   003355 701000 2                  TSX1    SETMEM
         2 000644   000000 011000                    NOP     0

      602     6890    5                       END;

   6890  2 000645   000656 710000 2                  TRA     s:6894

      603     6891    5                    ELSE IF CNT(0)~=0 THEN DO;

   6891  2 000646   200012 235100                    LDA     CNT,,AUTO
         2 000647   000656 600000 2                  TZE     s:6894

      604     6892    5                          CALL GETMEM(MEM$,CNT(0));

   6892  2 000650   200012 633500                    EPPR3   CNT,,AUTO
         2 000651   200114 453500                    STP3    @RADIX+1,,AUTO
         2 000652   200023 631500                    EPPR1   MEM$,,AUTO
         2 000653   200113 451500                    STP1    TRANS$+3,,AUTO
         2 000654   003677 701000 2                  TSX1    GETMEM
         2 000655   000000 011000                    NOP     0

      605     6893    5                          END;

      606     6894    5                    IF CNT(1)~=0 THEN DO;

   6894  2 000656   200013 235100                    LDA     CNT+1,,AUTO
         2 000657   000674 600000 2                  TZE     s:6901

      607     6895    5                       IF FLAGS.L6 THEN

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:98   
   6895  2 000660   200011 430100                    FSZN    FLAGS,,AUTO
         2 000661   000667 605000 2                  TPL     s:6898

      608     6896    5                          I=(CNT(1)*9)/8;

   6896  2 000662   200013 236100                    LDQ     CNT+1,,AUTO
         2 000663   000011 402007                    MPY     9,DL
         2 000664   000010 506007                    DIV     8,DL
         2 000665   200021 756100                    STQ     I,,AUTO
         2 000666   000670 710000 2                  TRA     s:6899

      609     6897    5                       ELSE
      610     6898    5                          I=CNT(1);

   6898  2 000667   200021 755100                    STA     I,,AUTO

      611     6899    5                       CALL SKIPBITS(I);

   6899  2 000670   200021 630500                    EPPR0   I,,AUTO
         2 000671   200113 450500                    STP0    TRANS$+3,,AUTO
         2 000672   004405 701000 2                  TSX1    SKIPBITS
         2 000673   000000 011000                    NOP     0

      612     6900    5                       END;

      613     6901    4                    FORMATTING='0'B;

   6901  2 000674   200007 450100                    STZ     FORMATTING,,AUTO
         2 000675   003112 710000 2                  TRA     s:7255

      614     6902    4   /* Q */        CASE(18);

      615     6903    5                    IF FDS.MEMSZ=0 OR CNT(0)>0 THEN DO;

   6903  2 000676   000025 235100                    LDA     21,,PR0
         2 000677   000702 600000 2                  TZE     s:6904
         2 000700   200012 235100                    LDA     CNT,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:99   
         2 000701   000720 604400 2                  TMOZ    s:6907

      616     6904    5                       IF NOT FDS.BLNKBUF AND NOT FDS.DONT_PRINT THEN CALL BUF_OUT;

   6904  2 000702   000013 236100                    LDQ     11,,PR0
         2 000703   000100 316007                    CANQ    64,DL
         2 000704   000711 601000 2                  TNZ     s:6905
         2 000705   000040 316007                    CANQ    32,DL
         2 000706   000711 601000 2                  TNZ     s:6905

   6904  2 000707   003441 701000 2                  TSX1    BUF_OUT
         2 000710   000000 011000                    NOP     0

      617     6905    5                       UNWIND TO FDS.BAILOUT;

   6905  2 000711   200003 470700                    LDP0  ! @FDS,,AUTO
         2 000712   000100 100700                    MLR   ! fill='000'O
         2 000713   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         2 000714   200142 000010                    ADSC9   TABLEVAL+6,,AUTO         cn=0,n=8
         2 000715   200142 237300                    LDAQ  ! TABLEVAL+6,,AUTO
         2 000716   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 000717   000000 000200                    ZERO    0,128

      618     6906    5                       END;
      619     6907    4                    FORMATTING='0'B;

   6907  2 000720   200007 450100                    STZ     FORMATTING,,AUTO
         2 000721   003112 710000 2                  TRA     s:7255

      620     6908    4   /* P */        CASE(19);

      621     6909    4                    IF FLAGS.L6 THEN

   6909  2 000722   200011 430100                    FSZN    FLAGS,,AUTO
         2 000723   000741 605000 2                  TPL     s:6912

      622     6910    4                       I=CNT(1)*36+CNT(2)*9+(CNT(3)*9)/8;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:100  

   6910  2 000724   200013 236100                    LDQ     CNT+1,,AUTO
         2 000725   000002 736000                    QLS     2
         2 000726   200014 036100                    ADLQ    CNT+2,,AUTO
         2 000727   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 000730   200015 236100                    LDQ     CNT+3,,AUTO
         2 000731   000011 402007                    MPY     9,DL
         2 000732   000010 506007                    DIV     8,DL
         2 000733   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 000734   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 000735   000011 402007                    MPY     9,DL
         2 000736   200143 036100                    ADLQ    TABLEVAL+7,,AUTO
         2 000737   200021 756100                    STQ     I,,AUTO
         2 000740   000747 710000 2                  TRA     s:6913

      623     6911    4                    ELSE
      624     6912    4                       I=CNT(1)*36+CNT(2)*9+CNT(3);

   6912  2 000741   200013 236100                    LDQ     CNT+1,,AUTO
         2 000742   000002 736000                    QLS     2
         2 000743   200014 036100                    ADLQ    CNT+2,,AUTO
         2 000744   000011 402007                    MPY     9,DL
         2 000745   200015 036100                    ADLQ    CNT+3,,AUTO
         2 000746   200021 756100                    STQ     I,,AUTO

      625     6913    5                    IF CNT(0)=0 THEN DO;

   6913  2 000747   200012 235100                    LDA     CNT,,AUTO
         2 000750   001022 601000 2                  TNZ     s:6922

      626     6914    5                       IF FDS.MEMSZ=(MEMVEC.BOUND(FDS.MEMX)+1)*9 AND FDS.MEMX>0 THEN

   6914  2 000751   000012 471500                    LDP1    10,,PR0
         2 000752   000026 235100                    LDA     22,,PR0
         2 000753   000001 735000                    ALS     1
         2 000754   100000 236105                    LDQ     0,AL,PR1
         2 000755   000020 772000                    QRL     16
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:101  
         2 000756   000011 402007                    MPY     9,DL
         2 000757   000011 036007                    ADLQ    9,DL
         2 000760   000025 116100                    CMPQ    21,,PR0
         2 000761   000775 601000 2                  TNZ     s:6916
         2 000762   000026 235100                    LDA     22,,PR0
         2 000763   000775 604400 2                  TMOZ    s:6916

      627     6915    5                          CALL SETMEM(FDS.MEMX-1,I);

   6915  2 000764   000001 135007                    SBLA    1,DL
         2 000765   200151 755100                    STA     TABLEVAL+13,,AUTO
         2 000766   200021 631500                    EPPR1   I,,AUTO
         2 000767   200126 451500                    STP1    @STRING+1,,AUTO
         2 000770   200151 633500                    EPPR3   TABLEVAL+13,,AUTO
         2 000771   200125 453500                    STP3    M$+3,,AUTO
         2 000772   003355 701000 2                  TSX1    SETMEM
         2 000773   000000 011000                    NOP     0
         2 000774   001032 710000 2                  TRA     s:6923

      628     6916    5                       ELSE IF FDS.MEMSZ=0 AND FDS.NVECS#>0 THEN

   6916  2 000775   000025 235100                    LDA     21,,PR0
         2 000776   001012 601000 2                  TNZ     s:6919
         2 000777   000011 235100                    LDA     9,,PR0
         2 001000   001012 604400 2                  TMOZ    s:6919

      629     6917    5                             CALL SETMEM(FDS.NVECS#-1,I);

   6917  2 001001   000001 135007                    SBLA    1,DL
         2 001002   200152 755100                    STA     TABLEVAL+14,,AUTO
         2 001003   200021 631500                    EPPR1   I,,AUTO
         2 001004   200126 451500                    STP1    @STRING+1,,AUTO
         2 001005   200152 633500                    EPPR3   TABLEVAL+14,,AUTO
         2 001006   200125 453500                    STP3    M$+3,,AUTO
         2 001007   003355 701000 2                  TSX1    SETMEM
         2 001010   000000 011000                    NOP     0
         2 001011   001032 710000 2                  TRA     s:6923
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:102  

      630     6918    5                          ELSE
      631     6919    5                             CALL SETMEM(FDS.MEMX,I);

   6919  2 001012   200021 633500                    EPPR3   I,,AUTO
         2 001013   200126 453500                    STP3    @STRING+1,,AUTO
         2 001014   200003 236100                    LDQ     @FDS,,AUTO
         2 001015   000026 036003                    ADLQ    22,DU
         2 001016   200125 756100                    STQ     M$+3,,AUTO
         2 001017   003355 701000 2                  TSX1    SETMEM
         2 001020   000000 011000                    NOP     0

      632     6920    5                       END;

   6920  2 001021   001032 710000 2                  TRA     s:6923

      633     6921    4                    ELSE
      634     6922    4                       CALL SETMEM(CNT(0)-1,I);

   6922  2 001022   000001 135007                    SBLA    1,DL
         2 001023   200153 755100                    STA     TABLEVAL+15,,AUTO
         2 001024   200021 631500                    EPPR1   I,,AUTO
         2 001025   200126 451500                    STP1    @STRING+1,,AUTO
         2 001026   200153 633500                    EPPR3   TABLEVAL+15,,AUTO
         2 001027   200125 453500                    STP3    M$+3,,AUTO
         2 001030   003355 701000 2                  TSX1    SETMEM
         2 001031   000000 011000                    NOP     0

      635     6923    4                    FORMATTING='0'B;

   6923  2 001032   200007 450100                    STZ     FORMATTING,,AUTO
         2 001033   003112 710000 2                  TRA     s:7255

      636     6924    4   /* N */        CASE(20);

      637     6925    4                    CALL GETVAL(CNT(CNTX),CNT(CNTX)) ALTRET(NO_MEM);

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:103  
   6925  2 001034   200016 721100                    LXL1    CNTX,,AUTO
         2 001035   200012 633511                    EPPR3   CNT,X1,AUTO
         2 001036   200116 453500                    STP3    @V+1,,AUTO
         2 001037   200012 631511                    EPPR1   CNT,X1,AUTO
         2 001040   200115 451500                    STP1    @B+1,,AUTO
         2 001041   004021 701000 2                  TSX1    GETVAL
         2 001042   003154 702000 2                  TSX2    NO_MEM
         2 001043   003112 710000 2                  TRA     s:7255

      638     6926    4   /* V */        CASE(21);

      639     6927    5                    IF SUBSTR(FMT,FMTX+1,1)='%' THEN DO;

   6927  2 001044   040000 106505                    CMPC    fill='040'O
         2 001045   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         2 001046   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 001047   001057 601000 2                  TNZ     s:6931

      640     6928    5                       CALL GETMEM(MEM$,1);

   6928  2 001050   000004 236000 3                  LDQ     4
         2 001051   200114 756100                    STQ     @RADIX+1,,AUTO
         2 001052   200023 631500                    EPPR1   MEM$,,AUTO
         2 001053   200113 451500                    STP1    TRANS$+3,,AUTO
         2 001054   003677 701000 2                  TSX1    GETMEM
         2 001055   000000 011000                    NOP     0

      641     6929    5                       END;

   6929  2 001056   001062 710000 2                  TRA     s:6933

      642     6930    5                    ELSE DO;

      643     6931    5                       MEM$=ADDR(SUBSTR(FMT,FMTX+1,1));

   6931  2 001057   000001 035007                    ADLA    1,DL
         2 001060   100000 500505                    A9BD    0,AL,PR1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:104  
         2 001061   200023 451500                    STP1    MEM$,,AUTO

      644     6932    5                       END;

      645     6933    4                    FMTX=FMTX+1;

   6933  2 001062   200004 054100                    AOS     FMTX,,AUTO

      646     6934    4                    IF FDS.BLNKBUF THEN CALL BLANKBUF;

   6934  2 001063   200003 470500                    LDP0    @FDS,,AUTO
         2 001064   000013 236100                    LDQ     11,,PR0
         2 001065   000100 316007                    CANQ    64,DL
         2 001066   001071 600000 2                  TZE     s:6935

   6934  2 001067   003662 701000 2                  TSX1    BLANKBUF
         2 001070   000000 011000                    NOP     0

      647     6935    4                    CALL INSERT(BUFFER,0,1,MEM$->ONECHAR);

   6935  2 001071   200003 470500                    LDP0    @FDS,,AUTO
         2 001072   000006 471500                    LDP1    6,,PR0
         2 001073   000010 720100                    LXL0    8,,PR0
         2 001074   200023 473500                    LDP3    MEM$,,AUTO
         2 001075   040100 100500                    MLR     fill='040'O
         2 001076   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 001077   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      648     6936    4                    FORMATTING='0'B;

   6936  2 001100   200007 450100                    STZ     FORMATTING,,AUTO
         2 001101   003112 710000 2                  TRA     s:7255

      649     6937    4   /* ! */        CASE(22);

      650     6938    4                    IF NOT FDS.BLNKBUF THEN CALL BUF_OUT;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:105  
   6938  2 001102   000013 236100                    LDQ     11,,PR0
         2 001103   000100 316007                    CANQ    64,DL
         2 001104   001107 601000 2                  TNZ     s:6939

   6938  2 001105   003441 701000 2                  TSX1    BUF_OUT
         2 001106   000000 011000                    NOP     0

      651     6939    5                    IF FDS.DCB#~=DCBNUM(NIL) THEN DO;

   6939  2 001107   200003 470500                    LDP0    @FDS,,AUTO
         2 001110   000013 220100                    LDX0    11,,PR0
         2 001111   001120 600000 2                  TZE     s:6943

      652     6940    5                       FPT$DEVICE.V.DCB#=FDS.DCB#;

   6940  2 001112   000030 471500                    LDP1    24,,PR0
         2 001113   100006 740100                    STX0    6,,PR1

      653     6941    5                       CALL M$DEVICE(FPT$DEVICE);

   6941  2 001114   000030 471500                    LDP1    24,,PR0
         2 001115   100000 630500                    EPPR0   0,,PR1
         2 001116   050006 713400                    CLIMB   20486
         2 001117   401000 401760                    pmme    nvectors=3

      654     6942    5                       END;

      655     6943    4                    FORMATTING='0'B;

   6943  2 001120   200007 450100                    STZ     FORMATTING,,AUTO
         2 001121   003112 710000 2                  TRA     s:7255

      656     6944    4   /* A */        CASE(23);

      657     6945    4                    IF CNTX=0 THEN CNT(1)=CNT(0);

   6945  2 001122   200016 235100                    LDA     CNTX,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:106  
         2 001123   001126 601000 2                  TNZ     s:6946

   6945  2 001124   200012 235100                    LDA     CNT,,AUTO
         2 001125   200013 755100                    STA     CNT+1,,AUTO

      658     6946    5                    IF FLAGS.CNT1 THEN DO;

   6946  2 001126   200011 236100                    LDQ     FLAGS,,AUTO
         2 001127   000200 316003                    CANQ    128,DU
         2 001130   001136 600000 2                  TZE     s:6951

      659     6947    5                       I=4;

   6947  2 001131   000004 235007                    LDA     4,DL
         2 001132   200021 755100                    STA     I,,AUTO

      660     6948    5                       MEM$=ADDR(CNT(1));

   6948  2 001133   200013 631500                    EPPR1   CNT+1,,AUTO
         2 001134   200023 451500                    STP1    MEM$,,AUTO

      661     6949    5                       END;

   6949  2 001135   001154 710000 2                  TRA     s:6955

      662     6950    5                    ELSE DO;

      663     6951    5                       I=FDS.MEMSZ/9;

   6951  2 001136   000025 236100                    LDQ     21,,PR0
         2 001137   000011 506007                    DIV     9,DL
         2 001140   200021 756100                    STQ     I,,AUTO

      664     6952    5                       IF CNT(1)>0 AND CNT(1)<I THEN I=CNT(1);

   6952  2 001141   200013 235100                    LDA     CNT+1,,AUTO
         2 001142   001146 604400 2                  TMOZ    s:6953
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:107  
         2 001143   200013 116100                    CMPQ    CNT+1,,AUTO
         2 001144   001146 604400 2                  TMOZ    s:6953

   6952  2 001145   200021 755100                    STA     I,,AUTO

      665     6953    5                       CALL GETMEM(MEM$,I) ALTRET(NO_MEM);

   6953  2 001146   200021 631500                    EPPR1   I,,AUTO
         2 001147   200114 451500                    STP1    @RADIX+1,,AUTO
         2 001150   200023 633500                    EPPR3   MEM$,,AUTO
         2 001151   200113 453500                    STP3    TRANS$+3,,AUTO
         2 001152   003677 701000 2                  TSX1    GETMEM
         2 001153   003154 702000 2                  TSX2    NO_MEM

      666     6954    5                       END;

      667     6955    4                    IF CNT(2)=1 THEN TRANS$=ADDR(ASC_DUMP);

   6955  2 001154   200014 235100                    LDA     CNT+2,,AUTO
         2 001155   000001 115007                    CMPA    1,DL
         2 001156   001162 601000 2                  TNZ     s:6956

   6955  2 001157   000000 236000 xsym               LDQ     B$XL_ASC_DUMP$
         2 001160   200110 756100                    STQ     TRANS$,,AUTO
         2 001161   001166 710000 2                  TRA     s:6957

      668     6956    4                    ELSE IF CNT(2)=2 THEN TRANS$=ADDR(EBC_DUMP);

   6956  2 001162   000002 115007                    CMPA    2,DL
         2 001163   001166 601000 2                  TNZ     s:6957

   6956  2 001164   000000 236000 xsym               LDQ     B$XL_EBC_DUMP$
         2 001165   200110 756100                    STQ     TRANS$,,AUTO

      669     6957    4                    CALL FIELD(MEM$->ONECHAR,I,CNT(0));

   6957  2 001166   200012 630500                    EPPR0   CNT,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:108  
         2 001167   200127 450500                    STP0    @SIZ+1,,AUTO
         2 001170   200021 631500                    EPPR1   I,,AUTO
         2 001171   200126 451500                    STP1    @STRING+1,,AUTO
         2 001172   200023 236100                    LDQ     MEM$,,AUTO
         2 001173   200125 756100                    STQ     M$+3,,AUTO
         2 001174   004440 701000 2                  TSX1    FIELD
         2 001175   000000 011000                    NOP     0

      670     6958    4                    FORMATTING='0'B;

   6958  2 001176   200007 450100                    STZ     FORMATTING,,AUTO

      671     6959    4                    TRANS$ = ADDR(STR_DUMP);

   6959  2 001177   000001 236000 3                  LDQ     1
         2 001200   200110 756100                    STQ     TRANS$,,AUTO
         2 001201   003112 710000 2                  TRA     s:7255

      672     6960    4   /* T */        CASE(24);

      673     6961    4                    CALL GETVAL(I,9) ALTRET(NO_MEM);

   6961  2 001202   000011 236000 3                  LDQ     9
         2 001203   200116 756100                    STQ     @V+1,,AUTO
         2 001204   200021 631500                    EPPR1   I,,AUTO
         2 001205   200115 451500                    STP1    @B+1,,AUTO
         2 001206   004021 701000 2                  TSX1    GETVAL
         2 001207   003154 702000 2                  TSX2    NO_MEM

      674     6962    4                    CALL GETMEM(MEM$,I) ALTRET(NO_MEM);

   6962  2 001210   200021 630500                    EPPR0   I,,AUTO
         2 001211   200114 450500                    STP0    @RADIX+1,,AUTO
         2 001212   200023 631500                    EPPR1   MEM$,,AUTO
         2 001213   200113 451500                    STP1    TRANS$+3,,AUTO
         2 001214   003677 701000 2                  TSX1    GETMEM
         2 001215   003154 702000 2                  TSX2    NO_MEM
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:109  

      675     6963    4                    CALL FIELD(MEM$->ONECHAR,I,CNT(0));

   6963  2 001216   200012 630500                    EPPR0   CNT,,AUTO
         2 001217   200127 450500                    STP0    @SIZ+1,,AUTO
         2 001220   200021 631500                    EPPR1   I,,AUTO
         2 001221   200126 451500                    STP1    @STRING+1,,AUTO
         2 001222   200023 236100                    LDQ     MEM$,,AUTO
         2 001223   200125 756100                    STQ     M$+3,,AUTO
         2 001224   004440 701000 2                  TSX1    FIELD
         2 001225   000000 011000                    NOP     0

      676     6964    4                    FORMATTING='0'B;

   6964  2 001226   200007 450100                    STZ     FORMATTING,,AUTO
         2 001227   003112 710000 2                  TRA     s:7255

      677     6965    4   /* Z */        CASE(25);

      678     6966    4                    FLAGS.LZ='1'B;

   6966  2 001230   400000 236003                    LDQ     -131072,DU
         2 001231   200011 256100                    ORSQ    FLAGS,,AUTO
         2 001232   003112 710000 2                  TRA     s:7255

      679     6967    4   /* L */        CASE(26);

      680     6968    4                    FLAGS.LJ='1'B;

   6968  2 001233   200000 236003                    LDQ     65536,DU
         2 001234   200011 256100                    ORSQ    FLAGS,,AUTO
         2 001235   003112 710000 2                  TRA     s:7255

      681     6969    4   /* + */        CASE(27);

      682     6970    5                    IF FLAGS.ARITH THEN DO;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:110  
   6970  2 001236   200011 236100                    LDQ     FLAGS,,AUTO
         2 001237   000400 316003                    CANQ    256,DU
         2 001240   001246 600000 2                  TZE     s:6974

      683     6971    5                       CNT(CNTX) = SAVCNT+CNT(CNTX);

   6971  2 001241   200016 721100                    LXL1    CNTX,,AUTO
         2 001242   200017 236100                    LDQ     SAVCNT,,AUTO
         2 001243   200012 036111                    ADLQ    CNT,X1,AUTO
         2 001244   200012 756111                    STQ     CNT,X1,AUTO

      684     6972    5                       GOTO ARITH_DONE;

   6972  2 001245   003110 710000 2                  TRA     ARITH_DONE

      685     6973    5                       END;
      686     6974    4                    FLAGS.SIGN='1'B;

   6974  2 001246   100000 236003                    LDQ     32768,DU
         2 001247   200011 256100                    ORSQ    FLAGS,,AUTO
         2 001250   003112 710000 2                  TRA     s:7255

      687     6975    4   /* M */        CASE(28);

      688     6976    4                    FLAGS.MSD='1'B;

   6976  2 001251   040000 236003                    LDQ     16384,DU
         2 001252   200011 256100                    ORSQ    FLAGS,,AUTO
         2 001253   003112 710000 2                  TRA     s:7255

      689     6977    4   /* D */        CASE(29);

      690     6978    4                    CALL GETVAL(TEMP,CNT(1)) ALTRET(NO_MEM);

   6978  2 001254   200013 633500                    EPPR3   CNT+1,,AUTO
         2 001255   200116 453500                    STP3    @V+1,,AUTO
         2 001256   200010 631500                    EPPR1   TEMP,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:111  
         2 001257   200115 451500                    STP1    @B+1,,AUTO
         2 001260   004021 701000 2                  TSX1    GETVAL
         2 001261   003154 702000 2                  TSX2    NO_MEM

      691     6979    5                    IF FLAGS.SIGN AND STEMP<0 THEN DO;

   6979  2 001262   200011 236100                    LDQ     FLAGS,,AUTO
         2 001263   100000 316003                    CANQ    32768,DU
         2 001264   001275 600000 2                  TZE     s:6984
         2 001265   200010 235100                    LDA     TEMP,,AUTO
         2 001266   001275 605000 2                  TPL     s:6984

      692     6980    5                       SIGNC='-';

   6980  2 001267   055000 236003                    LDQ     23040,DU
         2 001270   200024 756100                    STQ     SIGNC,,AUTO

      693     6981    5                       CALL BINCHAR(NUMBUF,STEMP);

   6981  2 001271   000100 301500                    BTD
         2 001272   200010 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         2 001273   200051 030045                    NDSC9   NUMBUF,,AUTO             cn=0,s=nosgn,sf=0,n=37

      694     6982    5                       END;

   6982  2 001274   001305 710000 2                  TRA     s:6987

      695     6983    5                    ELSE DO;

      696     6984    5                       SIGNC=' ';

   6984  2 001275   040000 236003                    LDQ     16384,DU
         2 001276   200024 756100                    STQ     SIGNC,,AUTO

      697     6985    5                       CALL BINCHAR(NUMBUF,TEMP);

   6985  2 001277   200010 235100                    LDA     TEMP,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:112  
         2 001300   000044 773000                    LRL     36
         2 001301   200142 757100                    STAQ    TABLEVAL+6,,AUTO
         2 001302   000100 301500                    BTD
         2 001303   200142 000010                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 001304   200051 030045                    NDSC9   NUMBUF,,AUTO             cn=0,s=nosgn,sf=0,n=37

      698     6986    5                       END;

      699     6987    4                    CALL NUMERIC1;

   6987  2 001305   005431 701000 2                  TSX1    NUMERIC1
         2 001306   000000 011000                    NOP     0

      700     6988    4                    FORMATTING='0'B;

   6988  2 001307   200007 450100                    STZ     FORMATTING,,AUTO
         2 001310   003112 710000 2                  TRA     s:7255

      701     6989    4   /* Y */        CASE(30);

      702     6990    4                    CALL GETVAL(TEMP,CNT(1)) ALTRET(NO_MEM);

   6990  2 001311   200013 633500                    EPPR3   CNT+1,,AUTO
         2 001312   200116 453500                    STP3    @V+1,,AUTO
         2 001313   200010 631500                    EPPR1   TEMP,,AUTO
         2 001314   200115 451500                    STP1    @B+1,,AUTO
         2 001315   004021 701000 2                  TSX1    GETVAL
         2 001316   003154 702000 2                  TSX2    NO_MEM

      703     6991    4                    NUMBUF='0000000000000000000000000000000000000';

   6991  2 001317   040100 100400                    MLR     fill='040'O
         2 001320   000307 000045 0                  ADSC9   STR_DUMP+132             cn=0,n=37
         2 001321   200051 000045                    ADSC9   NUMBUF,,AUTO             cn=0,n=37

      704     6992    5                    DO I=0 TO 3;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:113  
   6992  2 001322   200021 450100                    STZ     I,,AUTO

      705     6993    5                       CALL INSERT(NUMBUF,29+I*2,1,SUBSTR(CONTAB,TEMPY.LH(I),1));

   6993  2 001323   200021 236100                    LDQ     I,,AUTO
         2 001324   000011 402007                    MPY     9,DL
         2 001325   000000 116003                    CMPQ    0,DU
         2 001326   001330 605000 2                  TPL     s:6993+5
         2 001327   000044 036003                    ADLQ    36,DU
         2 001330   003100 061506                    CSR     bolr='003'O
         2 001331   200010 010004                    BDSC    TEMP,Q,AUTO              by=0,bit=1,n=4
         2 001332   200142 000044                    BDSC    TABLEVAL+6,,AUTO         by=0,bit=0,n=36
         2 001333   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001334   200021 235100                    LDA     I,,AUTO
         2 001335   000001 735000                    ALS     1
         2 001336   040105 100406                    MLR     fill='040'O
         2 001337   000053 000001 0                  ADSC9   CONTAB,Q                 cn=0,n=1
         2 001340   200060 200001                    ADSC9   NUMBUF+7,A,AUTO          cn=1,n=1

      706     6994    5                       CALL INSERT(NUMBUF,30+I*2,1,SUBSTR(CONTAB,TEMPY.RH(I),1));

   6994  2 001341   200021 236100                    LDQ     I,,AUTO
         2 001342   000011 402007                    MPY     9,DL
         2 001343   000000 116003                    CMPQ    0,DU
         2 001344   001346 605000 2                  TPL     s:6994+5
         2 001345   000044 036003                    ADLQ    36,DU
         2 001346   003100 061506                    CSR     bolr='003'O
         2 001347   200010 050004                    BDSC    TEMP,Q,AUTO              by=0,bit=5,n=4
         2 001350   200142 000044                    BDSC    TABLEVAL+6,,AUTO         by=0,bit=0,n=36
         2 001351   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001352   200021 235100                    LDA     I,,AUTO
         2 001353   000001 735000                    ALS     1
         2 001354   040105 100406                    MLR     fill='040'O
         2 001355   000053 000001 0                  ADSC9   CONTAB,Q                 cn=0,n=1
         2 001356   200060 400001                    ADSC9   NUMBUF+7,A,AUTO          cn=2,n=1

      707     6995    5                       END;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:114  

   6995  2 001357   200021 054100                    AOS     I,,AUTO
         2 001360   200021 235100                    LDA     I,,AUTO
         2 001361   000003 115007                    CMPA    3,DL
         2 001362   001323 604400 2                  TMOZ    s:6993

      708     6996    4                    CALL NUMERIC1;

   6996  2 001363   005431 701000 2                  TSX1    NUMERIC1
         2 001364   000000 011000                    NOP     0

      709     6997    4                    FORMATTING='0'B;

   6997  2 001365   200007 450100                    STZ     FORMATTING,,AUTO
         2 001366   003112 710000 2                  TRA     s:7255

      710     6998    4   /* O */        CASE(31);

      711     6999    4                    CALL NUMERIC(8) ALTRET(NO_MEM);

   6999  2 001367   000012 236000 3                  LDQ     10
         2 001370   200113 756100                    STQ     TRANS$+3,,AUTO
         2 001371   005325 701000 2                  TSX1    NUMERIC
         2 001372   003154 702000 2                  TSX2    NO_MEM

      712     7000    4                    FORMATTING='0'B;

   7000  2 001373   200007 450100                    STZ     FORMATTING,,AUTO
         2 001374   003112 710000 2                  TRA     s:7255

      713     7001    4   /* B */        CASE(32);

      714     7002    4                    CALL NUMERIC(2) ALTRET(NO_MEM);

   7002  2 001375   000013 236000 3                  LDQ     11
         2 001376   200113 756100                    STQ     TRANS$+3,,AUTO
         2 001377   005325 701000 2                  TSX1    NUMERIC
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:115  
         2 001400   003154 702000 2                  TSX2    NO_MEM

      715     7003    4                    FORMATTING='0'B;

   7003  2 001401   200007 450100                    STZ     FORMATTING,,AUTO
         2 001402   003112 710000 2                  TRA     s:7255

      716     7004    4   /* H */        CASE(33);

      717     7005    4                    CALL NUMERIC(16) ALTRET(NO_MEM);

   7005  2 001403   000015 236000 3                  LDQ     13
         2 001404   200113 756100                    STQ     TRANS$+3,,AUTO
         2 001405   005325 701000 2                  TSX1    NUMERIC
         2 001406   003154 702000 2                  TSX2    NO_MEM

      718     7006    4                    FORMATTING='0'B;

   7006  2 001407   200007 450100                    STZ     FORMATTING,,AUTO
         2 001410   003112 710000 2                  TRA     s:7255

      719     7007    4   /* E */        CASE(34);

      720     7008    4                    FDS.FMTX=FMTX+1;

   7008  2 001411   000001 035007                    ADLA    1,DL
         2 001412   000002 755100                    STA     2,,PR0

      721     7009    4                    IF FDS.EDIT#~=ENTADDR(NIL) THEN

   7009  2 001413   000015 236100                    LDQ     13,,PR0
         2 001414   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 001415   001430 600000 2                  TZE     s:7011

      722     7010    4                       CALL FDS.EDIT#(FDS,CNT) ALTRET(EDIT_ALT);

   7010  2 001416   200012 633500                    EPPR3   CNT,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:116  
         2 001417   200143 453500                    STP3    TABLEVAL+7,,AUTO
         2 001420   200003 236100                    LDQ     @FDS,,AUTO
         2 001421   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 001422   200142 630500                    EPPR0   TABLEVAL+6,,AUTO
         2 001423   200003 471500                    LDP1    @FDS,,AUTO
         2 001424   100015 220100                    LDX0    13,,PR1
         2 001425   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001426   000000 701010                    TSX1    0,X0
         2 001427   001431 702000 2                  TSX2    EDIT_ALT

      723     7011    4                    FORMATTING='0'B;

   7011  2 001430   200007 450100                    STZ     FORMATTING,,AUTO

   7011  2 001431                       EDIT_ALT     null
      724     7012    4   EDIT_ALT:        ;
      725     7013    4                    FMTX=FDS.FMTX-1;

   7013  2 001431   200003 470500                    LDP0    @FDS,,AUTO
         2 001432   000002 235100                    LDA     2,,PR0
         2 001433   000001 135007                    SBLA    1,DL
         2 001434   200004 755100                    STA     FMTX,,AUTO
         2 001435   003112 710000 2                  TRA     s:7255

      726     7014    4   /* X */        CASE(35);

      727     7015    4                    IF CNT(0)=0 THEN CNT(0)=1;

   7015  2 001436   200012 235100                    LDA     CNT,,AUTO
         2 001437   001442 601000 2                  TNZ     s:7016

   7015  2 001440   000001 235007                    LDA     1,DL
         2 001441   200012 755100                    STA     CNT,,AUTO

      728     7016    4                    IF CNT(0)>0 THEN CALL FIELD(' ',1,CNT(0));

   7016  2 001442   001454 604400 2                  TMOZ    s:7018
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:117  

   7016  2 001443   200012 631500                    EPPR1   CNT,,AUTO
         2 001444   200127 451500                    STP1    @SIZ+1,,AUTO
         2 001445   000004 236000 3                  LDQ     4
         2 001446   200126 756100                    STQ     @STRING+1,,AUTO
         2 001447   000016 236000 3                  LDQ     14
         2 001450   200125 756100                    STQ     M$+3,,AUTO
         2 001451   004440 701000 2                  TSX1    FIELD
         2 001452   000000 011000                    NOP     0
         2 001453   001475 710000 2                  TRA     s:7024

      729     7017    5                    ELSE DO;

      730     7018    5                       CNT(0) = -CNT(0);

   7018  2 001454   000000 531000                    NEG     0
         2 001455   200012 755100                    STA     CNT,,AUTO

      731     7019    5                       IF CNT(0)>FDS.BUFX-1 THEN CNT(0) = FDS.BUFX-1;

   7019  2 001456   200012 236100                    LDQ     CNT,,AUTO
         2 001457   000007 116100                    CMPQ    7,,PR0
         2 001460   001464 604000 2                  TMI     s:7020

   7019  2 001461   000007 235100                    LDA     7,,PR0
         2 001462   000001 135007                    SBLA    1,DL
         2 001463   200012 755100                    STA     CNT,,AUTO

      732     7020    5                       FDS.BUFX = FDS.BUFX-CNT(0);

   7020  2 001464   000007 236100                    LDQ     7,,PR0
         2 001465   200012 136100                    SBLQ    CNT,,AUTO
         2 001466   000007 756100                    STQ     7,,PR0

      733     7021    5                       CALL INSERT (BUFFER,FDS.BUFX,CNT(0),' ');

   7021  2 001467   000006 471500                    LDP1    6,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:118  
         2 001470   000010 720100                    LXL0    8,,PR0
         2 001471   200012 721100                    LXL1    CNT,,AUTO
         2 001472   040146 100400                    MLR     fill='040'O
         2 001473   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001474   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1

      734     7022    5                       END;

      735     7023
      736     7024    4                    FORMATTING='0'B;

   7024  2 001475   200007 450100                    STZ     FORMATTING,,AUTO
         2 001476   003112 710000 2                  TRA     s:7255

      737     7025    4   /* < */        CASE(36);

      738     7026    5                    IF FLAGS.ARITH THEN DO;

   7026  2 001477   200011 236100                    LDQ     FLAGS,,AUTO
         2 001500   000400 316003                    CANQ    256,DU
         2 001501   001511 600000 2                  TZE     s:7030

      739     7027    5                       CNT(CNTX)=MINIMUM(CNT(CNTX),SAVCNT);

   7027  2 001502   200017 236100                    LDQ     SAVCNT,,AUTO
         2 001503   200016 721100                    LXL1    CNTX,,AUTO
         2 001504   200012 116111                    CMPQ    CNT,X1,AUTO
         2 001505   001507 604400 2                  TMOZ    s:7027+5
         2 001506   200012 236111                    LDQ     CNT,X1,AUTO
         2 001507   200012 756111                    STQ     CNT,X1,AUTO

      740     7028    5                       GOTO ARITH_DONE;

   7028  2 001510   003110 710000 2                  TRA     ARITH_DONE

      741     7029    5                       END;
      742     7030    4                    FLAGS.DLB='1'B;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:119  

   7030  2 001511   010000 236003                    LDQ     4096,DU
         2 001512   200011 256100                    ORSQ    FLAGS,,AUTO
         2 001513   003112 710000 2                  TRA     s:7255

      743     7031    4   /* > */        CASE(37);

      744     7032    5                    IF FLAGS.ARITH THEN DO;

   7032  2 001514   200011 236100                    LDQ     FLAGS,,AUTO
         2 001515   000400 316003                    CANQ    256,DU
         2 001516   001526 600000 2                  TZE     s:7036

      745     7033    5                       CNT(CNTX)=MAXIMUM(CNT(CNTX),SAVCNT);

   7033  2 001517   200017 236100                    LDQ     SAVCNT,,AUTO
         2 001520   200016 721100                    LXL1    CNTX,,AUTO
         2 001521   200012 116111                    CMPQ    CNT,X1,AUTO
         2 001522   001524 605000 2                  TPL     s:7033+5
         2 001523   200012 236111                    LDQ     CNT,X1,AUTO
         2 001524   200012 756111                    STQ     CNT,X1,AUTO

      746     7034    5                       GOTO ARITH_DONE;

   7034  2 001525   003110 710000 2                  TRA     ARITH_DONE

      747     7035    5                       END;
      748     7036    4                    FLAGS.DTB='1'B;

   7036  2 001526   020000 236003                    LDQ     8192,DU
         2 001527   200011 256100                    ORSQ    FLAGS,,AUTO
         2 001530   003112 710000 2                  TRA     s:7255

      749     7037    4   /* U */        CASE(38);

      750     7038    4                    DWID=DATEWIDTH(CNT(3));

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:120  
   7038  2 001531   200015 235100                    LDA     CNT+3,,AUTO
         2 001532   000100 101405                    MRL     fill='000'O
         2 001533   000074 000001 0                  ADSC9   DATEWIDTH,A              cn=0,n=1
         2 001534   200065 000004                    ADSC9   DWID,,AUTO               cn=0,n=4

      751     7039    4                    TWID=TIMEWIDTH(CNT(3));

   7039  2 001535   000100 101405                    MRL     fill='000'O
         2 001536   000077 000001 0                  ADSC9   TIMEWIDTH,A              cn=0,n=1
         2 001537   200066 000004                    ADSC9   TWID,,AUTO               cn=0,n=4

      752     7040    4                    FPT$TIME=FPT_TIME;

   7040  2 001540   000100 100400                    MLR     fill='000'O
         2 001541   000060 000060 0                  ADSC9   FPT_TIME                 cn=0,n=48
         2 001542   200074 000060                    ADSC9   FPT$TIME,,AUTO           cn=0,n=48

      753     7041    4                    FPT$TIME.V_=VECTOR(FPT$TIME.V);

   7041  2 001543   000017 235000 3                  LDA     15
         2 001544   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001545   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001546   000106 036003                    ADLQ    70,DU
         2 001547   200074 757100                    STAQ    FPT$TIME,,AUTO

      754     7042    4                    IF CNT(2)/4=1 THEN FPT$TIME.V.SOURCE#=%CLOCK#;

   7042  2 001550   200014 236100                    LDQ     CNT+2,,AUTO
         2 001551   000004 506007                    DIV     4,DL
         2 001552   000001 116007                    CMPQ    1,DL
         2 001553   001557 601000 2                  TNZ     s:7044

   7042  2 001554   000000 236003                    LDQ     0,DU
         2 001555   200106 552140                    STBQ    FPT$TIME+10,'40'O,AUTO
         2 001556   001602 710000 2                  TRA     s:7049

      755     7043    5                    ELSE DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:121  

      756     7044    5                       CALL GETVAL(X,CNT(1)) ALTRET(NO_MEM);

   7044  2 001557   200013 631500                    EPPR1   CNT+1,,AUTO
         2 001560   200116 451500                    STP1    @V+1,,AUTO
         2 001561   200063 633500                    EPPR3   X,,AUTO
         2 001562   200115 453500                    STP3    @B+1,,AUTO
         2 001563   004021 701000 2                  TSX1    GETVAL
         2 001564   003154 702000 2                  TSX2    NO_MEM

      757     7045    5                       FPT$TIME.TSTAMP_=VECTOR(X);

   7045  2 001565   777640 235007                    LDA     -96,DL
         2 001566   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001567   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001570   000063 036003                    ADLQ    51,DU
         2 001571   200104 757100                    STAQ    FPT$TIME+8,,AUTO

      758     7046    5                       IF CNT(2)<4 THEN FPT$TIME.V.SOURCE#=%UTS#;

   7046  2 001572   200014 235100                    LDA     CNT+2,,AUTO
         2 001573   000004 115007                    CMPA    4,DL
         2 001574   001600 605000 2                  TPL     s:7047

   7046  2 001575   004000 236003                    LDQ     2048,DU
         2 001576   200106 552140                    STBQ    FPT$TIME+10,'40'O,AUTO
         2 001577   001602 710000 2                  TRA     s:7049

      759     7047    5                       ELSE FPT$TIME.V.SOURCE#=%FUTS#;

   7047  2 001600   006000 236003                    LDQ     3072,DU
         2 001601   200106 552140                    STBQ    FPT$TIME+10,'40'O,AUTO

      760     7048    5                       END;

      761     7049    4                    FPT$TIME.V.DEST#=TIMEDEST(MOD(CNT(3),4));

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:122  
   7049  2 001602   200015 236100                    LDQ     CNT+3,,AUTO
         2 001603   000004 506007                    DIV     4,DL
         2 001604   000100 100405                    MLR     fill='000'O
         2 001605   000102 000001 0                  ADSC9   TIMEDEST,A               cn=0,n=1
         2 001606   200106 200001                    ADSC9   FPT$TIME+10,,AUTO        cn=1,n=1

      762     7050    5                    DO CASE(MOD(CNT(2),4));

   7050  2 001607   200014 236100                    LDQ     CNT+2,,AUTO
         2 001610   000004 506007                    DIV     4,DL
         2 001611   000004 115007                    CMPA    4,DL
         2 001612   001614 602005 2                  TNC     s:7050+5,AL
         2 001613   001711 710000 2                  TRA     s:7066
         2 001614   001620 710000 2                  TRA     s:7052
         2 001615   001630 710000 2                  TRA     s:7055
         2 001616   001640 710000 2                  TRA     s:7058
         2 001617   001665 710000 2                  TRA     s:7062

      763     7051    5                     CASE(0);              /* HH:MM */

      764     7052    5                       FPT$TIME.TIME_=VECTOR(NUMBUF);

   7052  2 001620   000020 235000 3                  LDA     16
         2 001621   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001622   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001623   000051 036003                    ADLQ    41,DU
         2 001624   200100 757100                    STAQ    FPT$TIME+4,,AUTO

      765     7053    5                       TEMP=TWID;

   7053  2 001625   200066 235100                    LDA     TWID,,AUTO
         2 001626   200010 755100                    STA     TEMP,,AUTO
         2 001627   001711 710000 2                  TRA     s:7066

      766     7054    5                     CASE(1);              /* MM/DD/YY */

      767     7055    5                       FPT$TIME.DATE_=VECTOR(NUMBUF);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:123  

   7055  2 001630   000020 235000 3                  LDA     16
         2 001631   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001632   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001633   000051 036003                    ADLQ    41,DU
         2 001634   200076 757100                    STAQ    FPT$TIME+2,,AUTO

      768     7056    5                       TEMP=DWID;

   7056  2 001635   200065 235100                    LDA     DWID,,AUTO
         2 001636   200010 755100                    STA     TEMP,,AUTO
         2 001637   001711 710000 2                  TRA     s:7066

      769     7057    5                     CASE(2);              /* HH:MM MM/DD/YY */

      770     7058    5                       FPT$TIME.TIME_=VECTOR(SUBSTR(NUMBUF,0,TWID));

   7058  2 001640   200066 235100                    LDA     TWID,,AUTO
         2 001641   000020 735000                    ALS     16
         2 001642   000140 135007                    SBLA    96,DL
         2 001643   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001644   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001645   000051 036003                    ADLQ    41,DU
         2 001646   200100 757100                    STAQ    FPT$TIME+4,,AUTO

      771     7059    5                       FPT$TIME.DATE_=VECTOR(SUBSTR(NUMBUF,TWID+1,DWID));

   7059  2 001647   200065 235100                    LDA     DWID,,AUTO
         2 001650   000020 735000                    ALS     16
         2 001651   000140 135007                    SBLA    96,DL
         2 001652   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001653   200066 236100                    LDQ     TWID,,AUTO
         2 001654   000020 736000                    QLS     16
         2 001655   000021 036000 3                  ADLQ    17
         2 001656   200142 036100                    ADLQ    TABLEVAL+6,,AUTO
         2 001657   200076 757100                    STAQ    FPT$TIME+2,,AUTO

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:124  
      772     7060    5                       TEMP=TWID+DWID+1;

   7060  2 001660   200066 236100                    LDQ     TWID,,AUTO
         2 001661   200065 036100                    ADLQ    DWID,,AUTO
         2 001662   000001 036007                    ADLQ    1,DL
         2 001663   200010 756100                    STQ     TEMP,,AUTO
         2 001664   001711 710000 2                  TRA     s:7066

      773     7061    5                     CASE(3);              /* MM/DD/YY HH:MM */

      774     7062    5                       FPT$TIME.DATE_=VECTOR(SUBSTR(NUMBUF,0,DWID));

   7062  2 001665   200065 235100                    LDA     DWID,,AUTO
         2 001666   000020 735000                    ALS     16
         2 001667   000140 135007                    SBLA    96,DL
         2 001670   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001671   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 001672   000051 036003                    ADLQ    41,DU
         2 001673   200076 757100                    STAQ    FPT$TIME+2,,AUTO

      775     7063    5                       FPT$TIME.TIME_=VECTOR(SUBSTR(NUMBUF,DWID+1,TWID));

   7063  2 001674   200066 235100                    LDA     TWID,,AUTO
         2 001675   000020 735000                    ALS     16
         2 001676   000140 135007                    SBLA    96,DL
         2 001677   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 001700   200065 236100                    LDQ     DWID,,AUTO
         2 001701   000020 736000                    QLS     16
         2 001702   000021 036000 3                  ADLQ    17
         2 001703   200142 036100                    ADLQ    TABLEVAL+6,,AUTO
         2 001704   200100 757100                    STAQ    FPT$TIME+4,,AUTO

      776     7064    5                       TEMP=TWID+DWID+1;

   7064  2 001705   200066 236100                    LDQ     TWID,,AUTO
         2 001706   200065 036100                    ADLQ    DWID,,AUTO
         2 001707   000001 036007                    ADLQ    1,DL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:125  
         2 001710   200010 756100                    STQ     TEMP,,AUTO

      777     7065    5                     END;

      778     7066    4                    NUMBUF=' ';

   7066  2 001711   040100 100400                    MLR     fill='040'O
         2 001712   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001713   200051 000045                    ADSC9   NUMBUF,,AUTO             cn=0,n=37

      779     7067    4                    CALL M$TIME(FPT$TIME);

   7067  2 001714   200074 630500                    EPPR0   FPT$TIME,,AUTO
         2 001715   020004 713400                    CLIMB   8196
         2 001716   402000 401760                    pmme    nvectors=5

      780     7068    4                    CALL FIELD(NUMBUF,TEMP,CNT(0));

   7068  2 001717   200012 630500                    EPPR0   CNT,,AUTO
         2 001720   200127 450500                    STP0    @SIZ+1,,AUTO
         2 001721   200010 631500                    EPPR1   TEMP,,AUTO
         2 001722   200126 451500                    STP1    @STRING+1,,AUTO
         2 001723   200051 633500                    EPPR3   NUMBUF,,AUTO
         2 001724   200125 453500                    STP3    M$+3,,AUTO
         2 001725   004440 701000 2                  TSX1    FIELD
         2 001726   000000 011000                    NOP     0

      781     7069    4                    FORMATTING='0'B;

   7069  2 001727   200007 450100                    STZ     FORMATTING,,AUTO
         2 001730   003112 710000 2                  TRA     s:7255

      782     7070    4   /* J */        CASE(39);

      783     7071    4                    CALL GETVAL(ERRCD,CNT(1)) ALTRET(NO_MEM);

   7071  2 001731   200013 633500                    EPPR3   CNT+1,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:126  
         2 001732   200116 453500                    STP3    @V+1,,AUTO
         2 001733   200067 631500                    EPPR1   ERRCD,,AUTO
         2 001734   200115 451500                    STP1    @B+1,,AUTO
         2 001735   004021 701000 2                  TSX1    GETVAL
         2 001736   003154 702000 2                  TSX2    NO_MEM

      784     7072    5                    IF CNTX>1 THEN DO;     /* Use M$ERRMSG */

   7072  2 001737   200016 235100                    LDA     CNTX,,AUTO
         2 001740   000001 115007                    CMPA    1,DL
         2 001741   001767 604400 2                  TMOZ    s:7078

      785     7073    5                       CNTB(1)=ERRCD;      /* Pass ERRCD and CNT(2) together */

   7073  2 001742   200067 236100                    LDQ     ERRCD,,AUTO
         2 001743   200013 756100                    STQ     CNT+1,,AUTO

      786     7074    5                       CALL XUF$ERRMSG(CNT(1),DBUF,DSIZ);

   7074  2 001744   200070 630500                    EPPR0   DSIZ,,AUTO
         2 001745   200144 450500                    STP0    TABLEVAL+8,,AUTO
         2 001746   200025 631500                    EPPR1   DBUF,,AUTO
         2 001747   200143 451500                    STP1    TABLEVAL+7,,AUTO
         2 001750   200013 633500                    EPPR3   CNT+1,,AUTO
         2 001751   200142 453500                    STP3    TABLEVAL+6,,AUTO
         2 001752   200142 630500                    EPPR0   TABLEVAL+6,,AUTO
         2 001753   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001754   000000 701000 xent               TSX1    XUF$ERRMSG
         2 001755   000000 011000                    NOP     0

      787     7075    5                       CALL FIELD (DBUF,DSIZ,CNT(0));

   7075  2 001756   200012 630500                    EPPR0   CNT,,AUTO
         2 001757   200127 450500                    STP0    @SIZ+1,,AUTO
         2 001760   200070 631500                    EPPR1   DSIZ,,AUTO
         2 001761   200126 451500                    STP1    @STRING+1,,AUTO
         2 001762   200025 633500                    EPPR3   DBUF,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:127  
         2 001763   200125 453500                    STP3    M$+3,,AUTO
         2 001764   004440 701000 2                  TSX1    FIELD
         2 001765   000000 011000                    NOP     0

      788     7076    5                       END;

   7076  2 001766   002127 710000 2                  TRA     s:7096

      789     7077    5                    ELSE DO;

      790     7078    5                       NUMBUF=' ';

   7078  2 001767   040100 100400                    MLR     fill='040'O
         2 001770   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001771   200051 000045                    ADSC9   NUMBUF,,AUTO             cn=0,n=37

      791     7079    6                       DO I=0 TO 2;

   7079  2 001772   200021 450100                    STZ     I,,AUTO

      792     7080    6                          IF ERRCD.FCG(I)=0 THEN

   7080  2 001773   200021 235100                    LDA     I,,AUTO
         2 001774   001776 605000 2                  TPL     s:7080+3
         2 001775   000006 035003                    ADLA    6,DU
         2 001776   000100 101505                    MRL     fill='000'O
         2 001777   200067 020001                    ADSC6   ERRCD,A,AUTO             cn=0,n=1
         2 002000   200142 020006                    ADSC6   TABLEVAL+6,,AUTO         cn=0,n=6
         2 002001   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 002002   000000 116003                    CMPQ    0,DU
         2 002003   002011 601000 2                  TNZ     s:7082

      793     7081    6                             CALL INSERT(NUMBUF,I,1,' ');

   7081  2 002004   200021 235100                    LDA     I,,AUTO
         2 002005   040105 100400                    MLR     fill='040'O
         2 002006   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:128  
         2 002007   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1
         2 002010   002060 710000 2                  TRA     s:7086

      794     7082    6                          ELSE IF ERRCD.FCG(I)>=48 THEN

   7082  2 002011   200021 235100                    LDA     I,,AUTO
         2 002012   002014 605000 2                  TPL     s:7082+3
         2 002013   000006 035003                    ADLA    6,DU
         2 002014   000100 101505                    MRL     fill='000'O
         2 002015   200067 020001                    ADSC6   ERRCD,A,AUTO             cn=0,n=1
         2 002016   200142 020006                    ADSC6   TABLEVAL+6,,AUTO         cn=0,n=6
         2 002017   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 002020   000060 116007                    CMPQ    48,DL
         2 002021   002041 604000 2                  TMI     s:7085

      795     7083    6                                CALL INSERT(NUMBUF,I,1,BINASC(ERRCD.FCG(I)));

   7083  2 002022   200021 235100                    LDA     I,,AUTO
         2 002023   002025 605000 2                  TPL     s:7083+3
         2 002024   000006 035003                    ADLA    6,DU
         2 002025   000100 101505                    MRL     fill='000'O
         2 002026   200067 020001                    ADSC6   ERRCD,A,AUTO             cn=0,n=1
         2 002027   200142 020006                    ADSC6   TABLEVAL+6,,AUTO         cn=0,n=6
         2 002030   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 002031   000033 736000                    QLS     27
         2 002032   000022 276000 3                  ORQ     18
         2 002033   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 002034   200021 235100                    LDA     I,,AUTO
         2 002035   040105 100500                    MLR     fill='040'O
         2 002036   200143 000004                    ADSC9   TABLEVAL+7,,AUTO         cn=0,n=4
         2 002037   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1
         2 002040   002060 710000 2                  TRA     s:7086

      796     7084    6                             ELSE
      797     7085    6                                CALL INSERT(NUMBUF,I,1,BINASC(ERRCD.FCG(I)+64));

   7085  2 002041   200021 235100                    LDA     I,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:129  
         2 002042   002044 605000 2                  TPL     s:7085+3
         2 002043   000006 035003                    ADLA    6,DU
         2 002044   000100 101505                    MRL     fill='000'O
         2 002045   200067 020001                    ADSC6   ERRCD,A,AUTO             cn=0,n=1
         2 002046   200142 020006                    ADSC6   TABLEVAL+6,,AUTO         cn=0,n=6
         2 002047   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 002050   000100 036007                    ADLQ    64,DL
         2 002051   000033 736000                    QLS     27
         2 002052   000022 276000 3                  ORQ     18
         2 002053   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 002054   200021 235100                    LDA     I,,AUTO
         2 002055   040105 100500                    MLR     fill='040'O
         2 002056   200143 000004                    ADSC9   TABLEVAL+7,,AUTO         cn=0,n=4
         2 002057   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1

      798     7086    6                          END;

   7086  2 002060   200021 054100                    AOS     I,,AUTO
         2 002061   200021 235100                    LDA     I,,AUTO
         2 002062   000002 115007                    CMPA    2,DL
         2 002063   001773 604400 2                  TMOZ    s:7080

      799     7087    5                       IF ERRCD.MON THEN

   7087  2 002064   200067 236100                    LDQ     ERRCD,,AUTO
         2 002065   400000 316007                    CANQ    -131072,DL
         2 002066   002073 600000 2                  TZE     s:7090

      800     7088    5                          CALL INSERT(NUMBUF,3,2,'-M');

   7088  2 002067   040100 100400                    MLR     fill='040'O
         2 002070   000321 000002 0                  ADSC9   STR_DUMP+142             cn=0,n=2
         2 002071   200051 600002                    ADSC9   NUMBUF,,AUTO             cn=3,n=2
         2 002072   002076 710000 2                  TRA     s:7091

      801     7089    5                       ELSE
      802     7090    5                          CALL INSERT(NUMBUF,3,2,'-0');
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:130  

   7090  2 002073   040100 100400                    MLR     fill='040'O
         2 002074   000322 000002 0                  ADSC9   STR_DUMP+143             cn=0,n=2
         2 002075   200051 600002                    ADSC9   NUMBUF,,AUTO             cn=3,n=2

      803     7091    5                       CALL BINCHAR(SUBSTR(NUMBUF,5,5),ERRCD.CODE);

   7091  2 002076   200067 236100                    LDQ     ERRCD,,AUTO
         2 002077   000003 772000                    QRL     3
         2 002100   037777 376007                    ANQ     16383,DL
         2 002101   000000 235003                    LDA     0,DU
         2 002102   200142 757100                    STAQ    TABLEVAL+6,,AUTO
         2 002103   000100 301500                    BTD
         2 002104   200142 000010                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 002105   200052 230005                    NDSC9   NUMBUF+1,,AUTO           cn=1,s=nosgn,sf=0,n=5

      804     7092    5                       CALL INSERT(NUMBUF,10,1,'-');

   7092  2 002106   055000 236007                    LDQ     23040,DL
         2 002107   200053 552110                    STBQ    NUMBUF+2,'10'O,AUTO

      805     7093    5                       CALL BINCHAR(SUBSTR(NUMBUF,11,1),ERRCD.SEV);

   7093  2 002110   200067 236100                    LDQ     ERRCD,,AUTO
         2 002111   000007 376007                    ANQ     7,DL
         2 002112   000000 235003                    LDA     0,DU
         2 002113   200142 757100                    STAQ    TABLEVAL+6,,AUTO
         2 002114   000100 301500                    BTD
         2 002115   200142 000010                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 002116   200053 630001                    NDSC9   NUMBUF+2,,AUTO           cn=3,s=nosgn,sf=0,n=1

      806     7094    5                       CALL FIELD(NUMBUF,12,CNT(0));

   7094  2 002117   200012 630500                    EPPR0   CNT,,AUTO
         2 002120   200127 450500                    STP0    @SIZ+1,,AUTO
         2 002121   000024 236000 3                  LDQ     20
         2 002122   200126 756100                    STQ     @STRING+1,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:131  
         2 002123   200051 631500                    EPPR1   NUMBUF,,AUTO
         2 002124   200125 451500                    STP1    M$+3,,AUTO
         2 002125   004440 701000 2                  TSX1    FIELD
         2 002126   000000 011000                    NOP     0

      807     7095    5                       END;

      808     7096    4                    FORMATTING='0'B;

   7096  2 002127   200007 450100                    STZ     FORMATTING,,AUTO
         2 002130   003112 710000 2                  TRA     s:7255

      809     7097    4   /* * */        CASE(40);

      810     7098    5                    IF FLAGS.ARITH THEN DO;

   7098  2 002131   200011 236100                    LDQ     FLAGS,,AUTO
         2 002132   000400 316003                    CANQ    256,DU
         2 002133   002141 600000 2                  TZE     s:7102

      811     7099    5                       CNT(CNTX)=SAVCNT*CNT(CNTX);

   7099  2 002134   200016 721100                    LXL1    CNTX,,AUTO
         2 002135   200017 236100                    LDQ     SAVCNT,,AUTO
         2 002136   200012 402111                    MPY     CNT,X1,AUTO
         2 002137   200012 756111                    STQ     CNT,X1,AUTO

      812     7100    5                       GOTO ARITH_DONE;

   7100  2 002140   003110 710000 2                  TRA     ARITH_DONE

      813     7101    5                       END;
      814     7102    4                    ELSE FLAGS.STAR='1'B;

   7102  2 002141   004000 236003                    LDQ     2048,DU
         2 002142   200011 256100                    ORSQ    FLAGS,,AUTO
         2 002143   003112 710000 2                  TRA     s:7255
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:132  

      815     7103    4   /* F */        CASE(41);

      816     7104    5                    DO CASE(CNT(1));       /* SPECIAL FORMATS */

   7104  2 002144   200013 235100                    LDA     CNT+1,,AUTO
         2 002145   000005 115007                    CMPA    5,DL
         2 002146   002150 602005 2                  TNC     s:7104+4,AL
         2 002147   002336 710000 2                  TRA     s:7125
         2 002150   002336 710000 2                  TRA     s:7125
         2 002151   002155 710000 2                  TRA     s:7106
         2 002152   002216 710000 2                  TRA     s:7111
         2 002153   002251 710000 2                  TRA     s:7115
         2 002154   002304 710000 2                  TRA     s:7120

      817     7105    5                     CASE(1);              /* DESCRIPTOR */

      818     7106    5                       CALL GETVAL(DESC.W0,36) ALTRET(NO_MEM);

   7106  2 002155   000026 236000 3                  LDQ     22
         2 002156   200116 756100                    STQ     @V+1,,AUTO
         2 002157   200071 631500                    EPPR1   DESC,,AUTO
         2 002160   200115 451500                    STP1    @B+1,,AUTO
         2 002161   004021 701000 2                  TSX1    GETVAL
         2 002162   003154 702000 2                  TSX2    NO_MEM

      819     7107    5                       CALL GETVAL(DESC.W1,36) ALTRET(NO_MEM);

   7107  2 002163   000026 236000 3                  LDQ     22
         2 002164   200116 756100                    STQ     @V+1,,AUTO
         2 002165   200072 630500                    EPPR0   DESC+1,,AUTO
         2 002166   200115 450500                    STP0    @B+1,,AUTO
         2 002167   004021 701000 2                  TSX1    GETVAL
         2 002170   003154 702000 2                  TSX2    NO_MEM

      820     7108    5                       CALL XUF$DESC(DESC,DBUF,DSIZ);

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:133  
   7108  2 002171   200070 630500                    EPPR0   DSIZ,,AUTO
         2 002172   200144 450500                    STP0    TABLEVAL+8,,AUTO
         2 002173   200025 631500                    EPPR1   DBUF,,AUTO
         2 002174   200143 451500                    STP1    TABLEVAL+7,,AUTO
         2 002175   200071 633500                    EPPR3   DESC,,AUTO
         2 002176   200142 453500                    STP3    TABLEVAL+6,,AUTO
         2 002177   200142 630500                    EPPR0   TABLEVAL+6,,AUTO
         2 002200   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002201   000000 701000 xent               TSX1    XUF$DESC
         2 002202   000000 011000                    NOP     0

      821     7109    5                       CALL FIELD(SUBSTR(DBUF,1),DSIZ,CNT(0));

   7109  2 002203   200012 630500                    EPPR0   CNT,,AUTO
         2 002204   200127 450500                    STP0    @SIZ+1,,AUTO
         2 002205   200070 631500                    EPPR1   DSIZ,,AUTO
         2 002206   200126 451500                    STP1    @STRING+1,,AUTO
         2 002207   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 002210   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 002211   000027 036000 3                  ADLQ    23
         2 002212   200125 756100                    STQ     M$+3,,AUTO
         2 002213   004440 701000 2                  TSX1    FIELD
         2 002214   000000 011000                    NOP     0
         2 002215   002336 710000 2                  TRA     s:7125

      822     7110    5                     CASE(2);              /* PTR */

      823     7111    5                       CALL GETVAL(DESC.W0,36) ALTRET(NO_MEM);

   7111  2 002216   000026 236000 3                  LDQ     22
         2 002217   200116 756100                    STQ     @V+1,,AUTO
         2 002220   200071 631500                    EPPR1   DESC,,AUTO
         2 002221   200115 451500                    STP1    @B+1,,AUTO
         2 002222   004021 701000 2                  TSX1    GETVAL
         2 002223   003154 702000 2                  TSX2    NO_MEM

      824     7112    5                       CALL XUF$PTR(DESC.W0,DBUF,DSIZ);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:134  

   7112  2 002224   200070 630500                    EPPR0   DSIZ,,AUTO
         2 002225   200144 450500                    STP0    TABLEVAL+8,,AUTO
         2 002226   200025 631500                    EPPR1   DBUF,,AUTO
         2 002227   200143 451500                    STP1    TABLEVAL+7,,AUTO
         2 002230   200071 633500                    EPPR3   DESC,,AUTO
         2 002231   200142 453500                    STP3    TABLEVAL+6,,AUTO
         2 002232   200142 630500                    EPPR0   TABLEVAL+6,,AUTO
         2 002233   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002234   000000 701000 xent               TSX1    XUF$PTR
         2 002235   000000 011000                    NOP     0

      825     7113    5                       CALL FIELD(SUBSTR(DBUF,1),DSIZ,CNT(0));

   7113  2 002236   200012 630500                    EPPR0   CNT,,AUTO
         2 002237   200127 450500                    STP0    @SIZ+1,,AUTO
         2 002240   200070 631500                    EPPR1   DSIZ,,AUTO
         2 002241   200126 451500                    STP1    @STRING+1,,AUTO
         2 002242   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 002243   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 002244   000027 036000 3                  ADLQ    23
         2 002245   200125 756100                    STQ     M$+3,,AUTO
         2 002246   004440 701000 2                  TSX1    FIELD
         2 002247   000000 011000                    NOP     0
         2 002250   002336 710000 2                  TRA     s:7125

      826     7114    5                     CASE(3);              /* M$UNFID */

      827     7115    5                       CALL GETVAL (DESC.W0,36) ALTRET (NO_MEM);

   7115  2 002251   000026 236000 3                  LDQ     22
         2 002252   200116 756100                    STQ     @V+1,,AUTO
         2 002253   200071 631500                    EPPR1   DESC,,AUTO
         2 002254   200115 451500                    STP1    @B+1,,AUTO
         2 002255   004021 701000 2                  TSX1    GETVAL
         2 002256   003154 702000 2                  TSX2    NO_MEM

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:135  
      828     7116    5                       DSIZ=CNT(3);        /* Set the FORCE flag */

   7116  2 002257   200015 235100                    LDA     CNT+3,,AUTO
         2 002260   200070 755100                    STA     DSIZ,,AUTO

      829     7117    5                       CALL XUF$UNFID (DESC.W0,DBUF,DSIZ);

   7117  2 002261   200070 630500                    EPPR0   DSIZ,,AUTO
         2 002262   200144 450500                    STP0    TABLEVAL+8,,AUTO
         2 002263   200025 631500                    EPPR1   DBUF,,AUTO
         2 002264   200143 451500                    STP1    TABLEVAL+7,,AUTO
         2 002265   200071 633500                    EPPR3   DESC,,AUTO
         2 002266   200142 453500                    STP3    TABLEVAL+6,,AUTO
         2 002267   200142 630500                    EPPR0   TABLEVAL+6,,AUTO
         2 002270   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002271   000000 701000 xent               TSX1    XUF$UNFID
         2 002272   000000 011000                    NOP     0

      830     7118    5                       CALL FIELD (DBUF,DSIZ,CNT(0));

   7118  2 002273   200012 630500                    EPPR0   CNT,,AUTO
         2 002274   200127 450500                    STP0    @SIZ+1,,AUTO
         2 002275   200070 631500                    EPPR1   DSIZ,,AUTO
         2 002276   200126 451500                    STP1    @STRING+1,,AUTO
         2 002277   200025 633500                    EPPR3   DBUF,,AUTO
         2 002300   200125 453500                    STP3    M$+3,,AUTO
         2 002301   004440 701000 2                  TSX1    FIELD
         2 002302   000000 011000                    NOP     0
         2 002303   002336 710000 2                  TRA     s:7125

      831     7119    5                     CASE(4);              /* DCBNAME */

      832     7120    5                       CALL GETVAL (DESC.W0,36) ALTRET (NO_MEM);

   7120  2 002304   000026 236000 3                  LDQ     22
         2 002305   200116 756100                    STQ     @V+1,,AUTO
         2 002306   200071 631500                    EPPR1   DESC,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:136  
         2 002307   200115 451500                    STP1    @B+1,,AUTO
         2 002310   004021 701000 2                  TSX1    GETVAL
         2 002311   003154 702000 2                  TSX2    NO_MEM

      833     7121    5                       DBUF = DCBADDR(DESC.W0)->F$DCB.DCBNAME.N;

   7121  2 002312   000030 470400 3                  LDP0    24
         2 002313   000000 471500                    LDP1    0,,PR0
         2 002314   200071 720100                    LXL0    DESC,,AUTO
         2 002315   100000 473510                    LDP3    0,X0,PR1
         2 002316   300140 236100                    LDQ     96,,PR3
         2 002317   000033 772000                    QRL     27
         2 002320   000037 376007                    ANQ     31,DL
         2 002321   000000 621006                    EAX1    0,QL
         2 002322   040100 100540                    MLR     fill='040'O
         2 002323   300140 200011                    ADSC9   96,,PR3                  cn=1,n=*X1
         2 002324   200025 000120                    ADSC9   DBUF,,AUTO               cn=0,n=80

      834     7122    5                       DSIZ = DCBADDR(DESC.W0)->F$DCB.DCBNAME.L;

   7122  2 002325   200070 756100                    STQ     DSIZ,,AUTO

      835     7123    5                       CALL FIELD (DBUF,DSIZ,CNT(0));

   7123  2 002326   200012 634500                    EPPR4   CNT,,AUTO
         2 002327   200127 454500                    STP4    @SIZ+1,,AUTO
         2 002330   200070 635500                    EPPR5   DSIZ,,AUTO
         2 002331   200126 455500                    STP5    @STRING+1,,AUTO
         2 002332   200025 636500                    EPPR6   DBUF,,AUTO
         2 002333   200125 456500                    STP6    M$+3,,AUTO
         2 002334   004440 701000 2                  TSX1    FIELD
         2 002335   000000 011000                    NOP     0

      836     7124    5                     END;

      837     7125    4                    FORMATTING='0'B;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:137  
   7125  2 002336   200007 450100                    STZ     FORMATTING,,AUTO
         2 002337   003112 710000 2                  TRA     s:7255

      838     7126    4   /* & */        CASE(42);

      839     7127    5                    IF FLAGS.ARITH THEN DO;

   7127  2 002340   200011 236100                    LDQ     FLAGS,,AUTO
         2 002341   000400 316003                    CANQ    256,DU
         2 002342   002350 600000 2                  TZE     s:7131

      840     7128    5                       CNTB(CNTX)=SAVCNTB&CNTB(CNTX);

   7128  2 002343   200016 721100                    LXL1    CNTX,,AUTO
         2 002344   200017 236100                    LDQ     SAVCNT,,AUTO
         2 002345   200012 376111                    ANQ     CNT,X1,AUTO
         2 002346   200012 756111                    STQ     CNT,X1,AUTO

      841     7129    5                       GOTO ARITH_DONE;

   7129  2 002347   003110 710000 2                  TRA     ARITH_DONE

      842     7130    5                       END;
      843     7131    4                    FLAGS.FIELD='1'B;

   7131  2 002350   002000 236003                    LDQ     1024,DU
         2 002351   200011 256100                    ORSQ    FLAGS,,AUTO
         2 002352   003112 710000 2                  TRA     s:7255

      844     7132    4   /* R */        CASE(43);

      845     7133    4                    IF FDS.BUFSIZE-FDS.BUFX<CNT(0)

   7133  2 002353   000010 236100                    LDQ     8,,PR0
         2 002354   000007 136100                    SBLQ    7,,PR0
         2 002355   200012 116100                    CMPQ    CNT,,AUTO
         2 002356   002373 605000 2                  TPL     s:7138
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:138  
         2 002357   000007 236100                    LDQ     7,,PR0
         2 002360   000016 116100                    CMPQ    14,,PR0
         2 002361   002373 604400 2                  TMOZ    s:7138
         2 002362   000013 236100                    LDQ     11,,PR0
         2 002363   000100 316007                    CANQ    64,DL
         2 002364   002373 601000 2                  TNZ     s:7138

      846     7134    5                      AND FDS.BUFX>FDS.WRAPTAB# AND NOT FDS.BLNKBUF THEN DO;

      847     7135    5                       FPT$WRITE.BUF_.BOUND=0;

   7135  2 002365   000031 473500                    LDP3    25,,PR0
         2 002366   177777 236007                    LDQ     65535,DL
         2 002367   300004 356100                    ANSQ    4,,PR3

      848     7136    5                       CALL BUF_WRAP;

   7136  2 002370   003642 701000 2                  TSX1    BUF_WRAP
         2 002371   000000 011000                    NOP     0

      849     7137    5                       END;

   7137  2 002372   002406 710000 2                  TRA     s:7140

      850     7138    4                    ELSE IF CNT(0)=0 AND FDS.BUFX>FDS.WRAPTAB#

   7138  2 002373   200012 236100                    LDQ     CNT,,AUTO
         2 002374   002406 601000 2                  TNZ     s:7140
         2 002375   000007 236100                    LDQ     7,,PR0
         2 002376   000016 116100                    CMPQ    14,,PR0
         2 002377   002406 604400 2                  TMOZ    s:7140

      851     7139    4                       THEN FPT$WRITE.BUF_.BOUND=FDS.BUFX-1;

   7139  2 002400   000031 473500                    LDP3    25,,PR0
         2 002401   000001 136007                    SBLQ    1,DL
         2 002402   000020 736000                    QLS     16
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:139  
         2 002403   300004 676100                    ERQ     4,,PR3
         2 002404   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002405   300004 656100                    ERSQ    4,,PR3

      852     7140    4                    FORMATTING='0'B;

   7140  2 002406   200007 450100                    STZ     FORMATTING,,AUTO
         2 002407   003112 710000 2                  TRA     s:7255

      853     7141    4   /* \ */        CASE(44);

      854     7142    5                    IF FLAGS.ARITH THEN DO;

   7142  2 002410   200011 236100                    LDQ     FLAGS,,AUTO
         2 002411   000400 316003                    CANQ    256,DU
         2 002412   002420 600000 2                  TZE     s:7146

      855     7143    5                       CNTB(CNTX)=SAVCNTB\CNTB(CNTX);

   7143  2 002413   200016 721100                    LXL1    CNTX,,AUTO
         2 002414   200017 236100                    LDQ     SAVCNT,,AUTO
         2 002415   200012 676111                    ERQ     CNT,X1,AUTO
         2 002416   200012 756111                    STQ     CNT,X1,AUTO

      856     7144    5                       GOTO ARITH_DONE;

   7144  2 002417   003110 710000 2                  TRA     ARITH_DONE

      857     7145    5                       END;
      858     7146    4                    FDS.DONT_PRINT = '1'B;

   7146  2 002420   000040 236007                    LDQ     32,DL
         2 002421   000013 256100                    ORSQ    11,,PR0

      859     7147    4                    FORMATTING = '0'B;

   7147  2 002422   200007 450100                    STZ     FORMATTING,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:140  
         2 002423   003112 710000 2                  TRA     s:7255

      860     7148    4   /* @ */        CASE(45);

      861     7149    4                    FLAGS.L6='1'B;

   7149  2 002424   001000 236003                    LDQ     512,DU
         2 002425   200011 256100                    ORSQ    FLAGS,,AUTO
         2 002426   003112 710000 2                  TRA     s:7255

      862     7150    4   /* [ */        CASE(46);

      863     7151    5                    IF FDS.DEBUG THEN DO;

   7151  2 002427   000013 236100                    LDQ     11,,PR0
         2 002430   000200 316007                    CANQ    128,DL
         2 002431   002442 600000 2                  TZE     s:7156

      864     7152    5                       DBUF=%CONCAT(BITASC('037'O),'Cnt1=');

   7152  2 002432   040100 100400                    MLR     fill='040'O
         2 002433   000323 000006 0                  ADSC9   STR_DUMP+144             cn=0,n=6
         2 002434   200025 000120                    ADSC9   DBUF,,AUTO               cn=0,n=80

      865     7153    5                       CALL BINXCHAR(SUBSTR(DBUF,6,12),CNT(1));

   7153  2 002435   000100 301500                    BTD
         2 002436   200013 000004                    NDSC9   CNT+1,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         2 002437   200026 410014                    NDSC9   DBUF+1,,AUTO             cn=2,s=lsgns,sf=0,n=12

      866     7154    5                       CALL DEBUG_OUT;

   7154  2 002440   005234 701000 2                  TSX1    DEBUG_OUT
         2 002441   000000 011000                    NOP     0

      867     7155    5                       END;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:141  
      868     7156    4                    I=1;

   7156  2 002442   000001 235007                    LDA     1,DL
         2 002443   200021 755100                    STA     I,,AUTO

      869     7157    4                    CNT(2)=I;

   7157  2 002444   200014 755100                    STA     CNT+2,,AUTO

      870     7158    5                    DO UNTIL(I=0);

      871     7159    6                       IF CNT(0)=CNT(1) AND I=CNT(2) THEN DO;

   7159  2 002445   200012 236100                    LDQ     CNT,,AUTO
         2 002446   200013 116100                    CMPQ    CNT+1,,AUTO
         2 002447   002475 601000 2                  TNZ     s:7167
         2 002450   200021 236100                    LDQ     I,,AUTO
         2 002451   200014 116100                    CMPQ    CNT+2,,AUTO
         2 002452   002475 601000 2                  TNZ     s:7167

      872     7160    6                          FDS.FMTX=FMTX+1;

   7160  2 002453   200003 470500                    LDP0    @FDS,,AUTO
         2 002454   200004 235100                    LDA     FMTX,,AUTO
         2 002455   000001 035007                    ADLA    1,DL
         2 002456   000002 755100                    STA     2,,PR0

      873     7161    6                          IF FDS.FMTX>=FDS.FMTSIZE THEN GOTO BAD_FMT;

   7161  2 002457   000002 236100                    LDQ     2,,PR0
         2 002460   000004 116100                    CMPQ    4,,PR0
         2 002461   003157 605000 2                  TPL     BAD_FMT

      874     7162    6                          FDS.FMTXMAX=CODE;

   7162  2 002462   200020 235100                    LDA     CODE,,AUTO
         2 002463   000003 755100                    STA     3,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:142  

      875     7163    6                          CALL XUF$FORMAT1(FDS);

   7163  2 002464   200003 630500                    EPPR0   @FDS,,AUTO
         2 002465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002466   000000 701000 2                  TSX1    s:6
         2 002467   000000 011000                    NOP     0

      876     7164    6                          CNT(2)=0;        /* ONLY DO IT ONCE */

   7164  2 002470   200014 450100                    STZ     CNT+2,,AUTO

      877     7165    6                          FMTX=FDS.FMTX-1;

   7165  2 002471   200003 470500                    LDP0    @FDS,,AUTO
         2 002472   000002 235100                    LDA     2,,PR0
         2 002473   000001 135007                    SBLA    1,DL
         2 002474   200004 755100                    STA     FMTX,,AUTO

      878     7166    6                          END;

      879     7167    5                       CALL INDEX (FMTX,'%',FMT,FMTX+1) ALTRET(BAD_FMT);

   7167  2 002475   200003 470500                    LDP0    @FDS,,AUTO
         2 002476   000001 471500                    LDP1    1,,PR0
         2 002477   000004 720100                    LXL0    4,,PR0
         2 002500   000000 636010                    EAQ     0,X0
         2 002501   000022 732000                    QRS     18
         2 002502   200004 136100                    SBLQ    FMTX,,AUTO
         2 002503   777777 621006                    EAX1    -1,QL
         2 002504   200004 236100                    LDQ     FMTX,,AUTO
         2 002505   000001 036007                    ADLQ    1,DL
         2 002506   200004 235100                    LDA     FMTX,,AUTO
         2 002507   000000 124545                    SCM     mask='000'O
         2 002510   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
         2 002511   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 002512   200004 000100                    ARG     FMTX,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:143  
         2 002513   200004 056100                    ASQ     FMTX,,AUTO
         2 002514   003157 606400 2                  TTN     BAD_FMT

      880     7168    5                       CNT(0)=0;

   7168  2 002515   200012 450100                    STZ     CNT,,AUTO

      881     7169    6                       DO WHILE '1'B;

      882     7170    6                          FMTX=FMTX+1;

   7170  2 002516   200004 054100                    AOS     FMTX,,AUTO

      883     7171    6                          IF FMTX>=FDS.FMTSIZE THEN GOTO BAD_FMT;

   7171  2 002517   200003 470500                    LDP0    @FDS,,AUTO
         2 002520   200004 236100                    LDQ     FMTX,,AUTO
         2 002521   000004 116100                    CMPQ    4,,PR0
         2 002522   003157 605000 2                  TPL     BAD_FMT

      884     7172    6                          IF NOT FLAGS.ARITH

   7172  2 002523   200011 236100                    LDQ     FLAGS,,AUTO
         2 002524   000400 316003                    CANQ    256,DU
         2 002525   002537 601000 2                  TNZ     s:7175

      885     7173    6                          THEN CALL INDEX (X,SUBSTR(FMT,FMTX,1),CONTCHARS)

   7173  2 002526   000001 471500                    LDP1    1,,PR0
         2 002527   000004 720100                    LXL0    4,,PR0
         2 002530   200004 235100                    LDA     FMTX,,AUTO
         2 002531   000105 124400                    SCM     mask='000'O
         2 002532   000016 000030 0                  ADSC9   CONTCHARS                cn=0,n=24
         2 002533   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 002534   200063 000100                    ARG     X,,AUTO
         2 002535   002571 606400 2                  TTN     CHK_OP2
         2 002536   002551 710000 2                  TRA     s:7177
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:144  

      886     7174    6                               ALTRET(CHK_OP2);
      887     7175    6                          ELSE CALL INDEX (X,SUBSTR(FMT,FMTX,1),ARTHCHARS)

   7175  2 002537   000001 471500                    LDP1    1,,PR0
         2 002540   000004 720100                    LXL0    4,,PR0
         2 002541   200004 235100                    LDA     FMTX,,AUTO
         2 002542   000105 124400                    SCM     mask='000'O
         2 002543   000024 000013 0                  ADSC9   ARTHCHARS                cn=0,n=11
         2 002544   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 002545   200063 000100                    ARG     X,,AUTO
         2 002546   002551 606400 2                  TTN     s:7177

      888     7176    7                             WHENRETURN DO; FLAGS.ARITH='0'B; END;

   7176  2 002547   000006 236000 3                  LDQ     6
         2 002550   200011 356100                    ANSQ    FLAGS,,AUTO

      889     7177    6                          IF X<10 THEN CNT(0)=10*CNT(0)+X;

   7177  2 002551   200063 235100                    LDA     X,,AUTO
         2 002552   000012 115007                    CMPA    10,DL
         2 002553   002561 605000 2                  TPL     s:7178

   7177  2 002554   200012 236100                    LDQ     CNT,,AUTO
         2 002555   000012 402007                    MPY     10,DL
         2 002556   200063 036100                    ADLQ    X,,AUTO
         2 002557   200012 756100                    STQ     CNT,,AUTO
         2 002560   002563 710000 2                  TRA     s:7179

      890     7178    6                          ELSE CNT(0)=-1;

   7178  2 002561   000001 336007                    LCQ     1,DL
         2 002562   200012 756100                    STQ     CNT,,AUTO

      891     7179    6                          IF X=10 THEN FLAGS.ARITH='1'B;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:145  
   7179  2 002563   200063 235100                    LDA     X,,AUTO
         2 002564   000012 115007                    CMPA    10,DL
         2 002565   002516 601000 2                  TNZ     s:7170

   7179  2 002566   000400 236003                    LDQ     256,DU
         2 002567   200011 256100                    ORSQ    FLAGS,,AUTO

      892     7180    6                          END;

   7180  2 002570   002516 710000 2                  TRA     s:7170

      893     7181    5   CHK_OP2:            IF SUBSTR(FMT,FMTX,1)~='?' THEN CNT(0)=CNT(1)-1;

   7181  2 002571   200003 470500       CHK_OP2      LDP0    @FDS,,AUTO
         2 002572   000001 471500                    LDP1    1,,PR0
         2 002573   000004 720100                    LXL0    4,,PR0
         2 002574   200004 235100                    LDA     FMTX,,AUTO
         2 002575   040000 106505                    CMPC    fill='040'O
         2 002576   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 002577   000031 000001 3                  ADSC9   25                       cn=0,n=1
         2 002600   002605 600000 2                  TZE     s:7182

   7181  2 002601   200013 236100                    LDQ     CNT+1,,AUTO
         2 002602   000001 136007                    SBLQ    1,DL
         2 002603   200012 756100                    STQ     CNT,,AUTO
         2 002604   002613 710000 2                  TRA     s:7183

      894     7182    5                       ELSE IF SUBSTR(FMT,FMTX-1,1)='%' THEN CNT(0)=CNT(1);

   7182  2 002605   040000 106505                    CMPC    fill='040'O
         2 002606   177777 600001                    ADSC9   -1,A,PR1                 cn=3,n=1
         2 002607   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 002610   002613 601000 2                  TNZ     s:7183

   7182  2 002611   200013 236100                    LDQ     CNT+1,,AUTO
         2 002612   200012 756100                    STQ     CNT,,AUTO

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:146  
      895     7183    5                       IF SUBSTR(FMT,FMTX,1)='[' THEN I=I+1;

   7183  2 002613   000001 471500                    LDP1    1,,PR0
         2 002614   000004 720100                    LXL0    4,,PR0
         2 002615   040000 106505                    CMPC    fill='040'O
         2 002616   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 002617   000032 000001 3                  ADSC9   26                       cn=0,n=1
         2 002620   002623 601000 2                  TNZ     s:7184

   7183  2 002621   200021 054100                    AOS     I,,AUTO
         2 002622   002631 710000 2                  TRA     s:7185

      896     7184    5                       ELSE IF SUBSTR(FMT,FMTX,1)=']' THEN I=I-1;

   7184  2 002623   040000 106505                    CMPC    fill='040'O
         2 002624   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 002625   000033 000001 3                  ADSC9   27                       cn=0,n=1
         2 002626   002631 601000 2                  TNZ     s:7185

   7184  2 002627   000001 336007                    LCQ     1,DL
         2 002630   200021 056100                    ASQ     I,,AUTO

      897     7185    5                       END;

   7185  2 002631   200021 236100                    LDQ     I,,AUTO
         2 002632   002445 601000 2                  TNZ     s:7159

      898     7186    4                    FORMATTING='0'B;

   7186  2 002633   200007 450100                    STZ     FORMATTING,,AUTO
         2 002634   003112 710000 2                  TRA     s:7255

      899     7187    4   /* ? */        CASE(47);

      900     7188    4                    IF NOT FLAGS.ARITH THEN GOTO CASE_48;

   7188  2 002635   200011 236100                    LDQ     FLAGS,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:147  
         2 002636   000400 316003                    CANQ    256,DU
         2 002637   002653 600000 2                  TZE     CASE_48

      901     7189    4                    CNT(CNTX)=MINIMUM(MAXIMUM(SAVCNT-CNT(CNTX),-1),1);

   7189  2 002640   200016 721100                    LXL1    CNTX,,AUTO
         2 002641   200017 236100                    LDQ     SAVCNT,,AUTO
         2 002642   200012 136111                    SBLQ    CNT,X1,AUTO
         2 002643   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 002644   002646 605000 2                  TPL     s:7189+6
         2 002645   000001 336007                    LCQ     1,DL
         2 002646   000001 116007                    CMPQ    1,DL
         2 002647   002651 604400 2                  TMOZ    s:7189+9
         2 002650   000001 236007                    LDQ     1,DL
         2 002651   200012 756111                    STQ     CNT,X1,AUTO

      902     7190    4                    GOTO ARITH_DONE;

   7190  2 002652   003110 710000 2                  TRA     ARITH_DONE

      903     7191    4   /* ] */        CASE(48);

      904     7192    4   CASE_48:         IF SAVEFMTX~=46 THEN GOTO BAD_FMT; /* ILLEGAL AT LEVEL 0 */

   7192  2 002653   200005 236100       CASE_48      LDQ     SAVEFMTX,,AUTO
         2 002654   000056 116007                    CMPQ    46,DL
         2 002655   003157 601000 2                  TNZ     BAD_FMT

      905     7193    4                    FDS.FMTX=PERCENT;

   7193  2 002656   200022 235100                    LDA     PERCENT,,AUTO
         2 002657   000002 755100                    STA     2,,PR0

      906     7194    4                    GOTO DBG_RETURN;

   7194  2 002660   002700 710000 2                  TRA     DBG_RETURN

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:148  
      907     7195    4   /* : */        CASE(49);

      908     7196    4                    FLAGS.ARITH = '1'B;

   7196  2 002661   000400 236003                    LDQ     256,DU
         2 002662   200011 256100                    ORSQ    FLAGS,,AUTO

      909     7197    4                    SAVCNT = CNT(CNTX);

   7197  2 002663   200016 721100                    LXL1    CNTX,,AUTO
         2 002664   200012 235111                    LDA     CNT,X1,AUTO
         2 002665   200017 755100                    STA     SAVCNT,,AUTO

      910     7198    4                    CNT(CNTX) = 0;

   7198  2 002666   200012 450111                    STZ     CNT,X1,AUTO
         2 002667   003112 710000 2                  TRA     s:7255

      911     7199    4   /* C */        CASE(50);

      912     7200    4                    FORMATTING='0'B;

   7200  2 002670   200007 450100                    STZ     FORMATTING,,AUTO

      913     7201    5                    IF FMTX=PERCENT+1 THEN DO; /* %C, must be end proc */

   7201  2 002671   200022 236100                    LDQ     PERCENT,,AUTO
         2 002672   000001 036007                    ADLQ    1,DL
         2 002673   200004 116100                    CMPQ    FMTX,,AUTO
         2 002674   002711 601000 2                  TNZ     s:7209

      914     7202    5                       IF SAVEFMTX~=50 THEN GOTO BAD_FMT; /* not called */

   7202  2 002675   200005 235100                    LDA     SAVEFMTX,,AUTO
         2 002676   000062 115007                    CMPA    50,DL
         2 002677   003157 601000 2                  TNZ     BAD_FMT

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:149  
      915     7203    6   DBG_RETURN:         IF FDS.DEBUG THEN DO;

   7203  2 002700   000013 236100       DBG_RETURN   LDQ     11,,PR0
         2 002701   000200 316007                    CANQ    128,DL
         2 002702   002710 600000 2                  TZE     s:7207

      916     7204    6                          DBUF=%CONCAT(BITASC('037'O),'Return:');

   7204  2 002703   040100 100400                    MLR     fill='040'O
         2 002704   000325 000010 0                  ADSC9   STR_DUMP+146             cn=0,n=8
         2 002705   200025 000120                    ADSC9   DBUF,,AUTO               cn=0,n=80

      917     7205    6                          CALL DEBUG_OUT;

   7205  2 002706   005234 701000 2                  TSX1    DEBUG_OUT
         2 002707   000000 011000                    NOP     0

      918     7206    6                          END;

      919     7207    5                       RETURN;

   7207  2 002710   000000 702200 xent               TSX2  ! X66_ARET

      920     7208    5                       END;
      921     7209    5                    IF CNT(0)>0 THEN DO;   /* %nC, a call */

   7209  2 002711   200012 235100                    LDA     CNT,,AUTO
         2 002712   002740 604400 2                  TMOZ    s:7218

      922     7210    5                       IF CNT(0)>99 THEN GOTO BAD_CNT;

   7210  2 002713   000143 115007                    CMPA    99,DL
         2 002714   003151 605400 2                  TPNZ    BAD_CNT

      923     7211    5                       TEMP=G.INDX(100-CNT(0));

   7211  2 002715   000032 473500                    LDP3    26,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:150  
         2 002716   777777 621005                    EAX1    -1,AL
         2 002717   777777 661003                    ERX1    -1,DU
         2 002720   300144 235111                    LDA     100,X1,PR3
         2 002721   200010 755100                    STA     TEMP,,AUTO

      924     7212    5                       IF TEMP<4 OR TEMP>=FDS.FMTSIZE THEN GOTO BAD_CNT;

   7212  2 002722   000004 115007                    CMPA    4,DL
         2 002723   003151 602000 2                  TNC     BAD_CNT
         2 002724   200010 236100                    LDQ     TEMP,,AUTO
         2 002725   003151 604000 2                  TMI     BAD_CNT
         2 002726   000004 116100                    CMPQ    4,,PR0
         2 002727   003151 605000 2                  TPL     BAD_CNT

      925     7213    5                       FDS.FMTX=TEMP;

   7213  2 002730   000002 756100                    STQ     2,,PR0

      926     7214    5                       FDS.FMTXMAX=50;

   7214  2 002731   000062 235007                    LDA     50,DL
         2 002732   000003 755100                    STA     3,,PR0

      927     7215    5                       CALL XUF$FORMAT1(FDS);

   7215  2 002733   200003 630500                    EPPR0   @FDS,,AUTO
         2 002734   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002735   000000 701000 2                  TSX1    s:6
         2 002736   000000 011000                    NOP     0

      928     7216    5                       END;

   7216  2 002737   003112 710000 2                  TRA     s:7255

      929     7217    5                    ELSE DO;

      930     7218    5                       IF CNT(1)<=0 OR CNT(1)>99 THEN GOTO BAD_CNT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:151  

   7218  2 002740   200013 235100                    LDA     CNT+1,,AUTO
         2 002741   003151 604400 2                  TMOZ    BAD_CNT
         2 002742   000143 115007                    CMPA    99,DL
         2 002743   003151 605400 2                  TPNZ    BAD_CNT

      931     7219    5                       G.INDX(100-CNT(1))=FMTX+1;

   7219  2 002744   000032 473500                    LDP3    26,,PR0
         2 002745   777777 621005                    EAX1    -1,AL
         2 002746   777777 661003                    ERX1    -1,DU
         2 002747   200004 235100                    LDA     FMTX,,AUTO
         2 002750   000001 035007                    ADLA    1,DL
         2 002751   300144 755111                    STA     100,X1,PR3

      932     7220    5                       CALL INDEX(FMTX,'%C',FMT,FMTX+1) ALTRET(BAD_FMT);

   7220  2 002752   000001 471500                    LDP1    1,,PR0
         2 002753   000004 720100                    LXL0    4,,PR0
         2 002754   000000 636010                    EAQ     0,X0
         2 002755   000022 732000                    QRS     18
         2 002756   200004 136100                    SBLQ    FMTX,,AUTO
         2 002757   777777 621006                    EAX1    -1,QL
         2 002760   200004 236100                    LDQ     FMTX,,AUTO
         2 002761   000001 036007                    ADLQ    1,DL
         2 002762   200004 235100                    LDA     FMTX,,AUTO
         2 002763   000000 120545                    SCD
         2 002764   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
         2 002765   000327 000002 0                  ADSC9   STR_DUMP+148             cn=0,n=2
         2 002766   200004 000100                    ARG     FMTX,,AUTO
         2 002767   200004 056100                    ASQ     FMTX,,AUTO
         2 002770   002773 607000 2                  TTF     s:7221
         2 002771   200004 054100                    AOS     FMTX,,AUTO
         2 002772   003157 710000 2                  TRA     BAD_FMT

      933     7221    5                       FMTX = FMTX+1;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:152  
   7221  2 002773   200004 054100                    AOS     FMTX,,AUTO

      934     7222    5                       END;

   7222  2 002774   003112 710000 2                  TRA     s:7255

      935     7223    4   /* = */        CASE(51);

      936     7224    5                    IF FLAGS.ARITH THEN DO;

   7224  2 002775   200011 236100                    LDQ     FLAGS,,AUTO
         2 002776   000400 316003                    CANQ    256,DU
         2 002777   003010 600000 2                  TZE     s:7229

      937     7225    5                       TEMP=CNT(CNTX);

   7225  2 003000   200016 721100                    LXL1    CNTX,,AUTO
         2 003001   200012 235111                    LDA     CNT,X1,AUTO
         2 003002   200010 755100                    STA     TEMP,,AUTO

      938     7226    5                       CNT(CNTX)=SAVCNT;

   7226  2 003003   200017 235100                    LDA     SAVCNT,,AUTO
         2 003004   200012 755111                    STA     CNT,X1,AUTO

      939     7227    5                       FLAGS.ARITH='0'B;

   7227  2 003005   000006 236000 3                  LDQ     6
         2 003006   200011 356100                    ANSQ    FLAGS,,AUTO

      940     7228    5                       END; ELSE DO;

   7228  2 003007   003015 710000 2                  TRA     s:7233

      941     7229    5                       TEMP=CNT(1);

   7229  2 003010   200013 235100                    LDA     CNT+1,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:153  
         2 003011   200010 755100                    STA     TEMP,,AUTO

      942     7230    5                       SAVCNT=CNT(0);

   7230  2 003012   200012 235100                    LDA     CNT,,AUTO
         2 003013   200017 755100                    STA     SAVCNT,,AUTO

      943     7231    5                       FORMATTING='0'B;

   7231  2 003014   200007 450100                    STZ     FORMATTING,,AUTO

      944     7232    5                       END;

      945     7233    4                    IF TEMP>99 THEN GOTO BAD_CNT;

   7233  2 003015   200010 236100                    LDQ     TEMP,,AUTO
         2 003016   000144 116007                    CMPQ    100,DL
         2 003017   003151 603000 2                  TRC     BAD_CNT

      946     7234    5                    IF FDS.DEBUG THEN DO;

   7234  2 003020   000013 236100                    LDQ     11,,PR0
         2 003021   000200 316007                    CANQ    128,DL
         2 003022   003041 600000 2                  TZE     s:7240

      947     7235    5                       DBUF=%CONCAT(BITASC('037'O),'Var00=');

   7235  2 003023   040100 100400                    MLR     fill='040'O
         2 003024   000330 000007 0                  ADSC9   STR_DUMP+149             cn=0,n=7
         2 003025   200025 000120                    ADSC9   DBUF,,AUTO               cn=0,n=80

      948     7236    5                       CALL BINCHAR(SUBSTR(DBUF,4,2),TEMP);

   7236  2 003026   200010 236100                    LDQ     TEMP,,AUTO
         2 003027   000000 235003                    LDA     0,DU
         2 003030   200142 757100                    STAQ    TABLEVAL+6,,AUTO
         2 003031   000100 301500                    BTD
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:154  
         2 003032   200142 000010                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 003033   200026 030002                    NDSC9   DBUF+1,,AUTO             cn=0,s=nosgn,sf=0,n=2

      949     7237    5                       CALL BINXCHAR(SUBSTR(DBUF,7,12),SAVCNT);

   7237  2 003034   000100 301500                    BTD
         2 003035   200017 000004                    NDSC9   SAVCNT,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 003036   200026 610014                    NDSC9   DBUF+1,,AUTO             cn=3,s=lsgns,sf=0,n=12

      950     7238    5                       CALL DEBUG_OUT;

   7238  2 003037   005234 701000 2                  TSX1    DEBUG_OUT
         2 003040   000000 011000                    NOP     0

      951     7239    5                       END;

      952     7240    4                    G.INDX(TEMP)=SAVCNT;

   7240  2 003041   200003 470500                    LDP0    @FDS,,AUTO
         2 003042   000032 471500                    LDP1    26,,PR0
         2 003043   200010 720100                    LXL0    TEMP,,AUTO
         2 003044   200017 235100                    LDA     SAVCNT,,AUTO
         2 003045   100000 755110                    STA     0,X0,PR1
         2 003046   003112 710000 2                  TRA     s:7255

      953     7241    4   /* # */        CASE(52);

      954     7242    4                    TEMP=CNT(CNTX);

   7242  2 003047   200016 721100                    LXL1    CNTX,,AUTO
         2 003050   200012 235111                    LDA     CNT,X1,AUTO
         2 003051   200010 755100                    STA     TEMP,,AUTO

      955     7243    4                    IF TEMP>100+SIZEW(FDS) THEN GOTO BAD_CNT;

   7243  2 003052   000203 115007                    CMPA    131,DL
         2 003053   003151 603000 2                  TRC     BAD_CNT
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:155  

      956     7244    4                    IF TEMP<100 THEN CNT(CNTX)=G.INDX(TEMP);

   7244  2 003054   000144 115007                    CMPA    100,DL
         2 003055   003062 603000 2                  TRC     s:7245

   7244  2 003056   000032 471500                    LDP1    26,,PR0
         2 003057   100000 235105                    LDA     0,AL,PR1
         2 003060   200012 755111                    STA     CNT,X1,AUTO
         2 003061   003112 710000 2                  TRA     s:7255

      957     7245    4                    ELSE CNT(CNTX)=ADDR(FDS)->G.INDX(TEMP-100);

   7245  2 003062   077634 235105                    LDA     -100,AL,PR0
         2 003063   200012 755111                    STA     CNT,X1,AUTO
         2 003064   003112 710000 2                  TRA     s:7255

      958     7246    4   /* K */        CASE(53);

      959     7247    4                    FLAGS.CNT1='1'B;

   7247  2 003065   000200 236003                    LDQ     128,DU
         2 003066   200011 256100                    ORSQ    FLAGS,,AUTO
         2 003067   003112 710000 2                  TRA     s:7255

      960     7248    4   /* | */        CASE(54);

      961     7249    4                    IF NOT FLAGS.ARITH THEN FDS.DEBUG=~FDS.DEBUG;

   7249  2 003070   200011 236100                    LDQ     FLAGS,,AUTO
         2 003071   000400 316003                    CANQ    256,DU
         2 003072   003104 601000 2                  TNZ     s:7251

   7249  2 003073   000013 236100                    LDQ     11,,PR0
         2 003074   000034 736000                    QLS     28
         2 003075   400000 376003                    ANQ     -131072,DU
         2 003076   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:156  
         2 003077   000034 772000                    QRL     28
         2 003100   000013 676100                    ERQ     11,,PR0
         2 003101   000200 376007                    ANQ     128,DL
         2 003102   000013 656100                    ERSQ    11,,PR0
         2 003103   003112 710000 2                  TRA     s:7255

      962     7250    5                    ELSE DO;

      963     7251    5                       CNTB(CNTX)=SAVCNTB|CNTB(CNTX);

   7251  2 003104   200016 721100                    LXL1    CNTX,,AUTO
         2 003105   200017 236100                    LDQ     SAVCNT,,AUTO
         2 003106   200012 276111                    ORQ     CNT,X1,AUTO
         2 003107   200012 756111                    STQ     CNT,X1,AUTO

      964     7252    5   ARITH_DONE:         FLAGS.ARITH='0'B;

   7252  2 003110   000006 236000 3     ARITH_DONE   LDQ     6
         2 003111   200011 356100                    ANSQ    FLAGS,,AUTO

      965     7253    5                       END;

      966     7254    3                  END; /* CASE CODE */;

      967     7255    3                 END;                      /* WHILE FORMATTING */

   7255  2 003112   200007 234100                    SZN     FORMATTING,,AUTO
         2 003113   000156 604000 2                  TMI     s:6801

      968     7256    2              FMTX=FMTX+1;

   7256  2 003114   200004 054100                    AOS     FMTX,,AUTO

      969     7257    3              IF NOT LOOPING AND FDS.MEMSZ>0 THEN DO;

   7257  2 003115   200006 234100                    SZN     LOOPING,,AUTO
         2 003116   003136 604000 2                  TMI     s:7262
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:157  
         2 003117   200003 470500                    LDP0    @FDS,,AUTO
         2 003120   000025 235100                    LDA     21,,PR0
         2 003121   003136 604400 2                  TMOZ    s:7262

      970     7258    3                 IF NOT FDS.BLNKBUF AND NOT FDS.DONT_PRINT THEN CALL BUF_OUT;

   7258  2 003122   000013 236100                    LDQ     11,,PR0
         2 003123   000100 316007                    CANQ    64,DL
         2 003124   003131 601000 2                  TNZ     s:7259
         2 003125   000040 316007                    CANQ    32,DL
         2 003126   003131 601000 2                  TNZ     s:7259

   7258  2 003127   003441 701000 2                  TSX1    BUF_OUT
         2 003130   000000 011000                    NOP     0

      971     7259    3                 FMTX=FDS.RESCAN;

   7259  2 003131   200003 470500                    LDP0    @FDS,,AUTO
         2 003132   000020 235100                    LDA     16,,PR0
         2 003133   200004 755100                    STA     FMTX,,AUTO

      972     7260    3                 LOOPING='1'B;

   7260  2 003134   400000 236003                    LDQ     -131072,DU
         2 003135   200006 756100                    STQ     LOOPING,,AUTO

      973     7261    3                 END;

      974     7262    2              END;                         /* WHILE LOOPING */

   7262  2 003136   200006 234100                    SZN     LOOPING,,AUTO
         2 003137   000060 604000 2                  TMI     s:6786

      975     7263    1           IF NOT FDS.BLNKBUF AND NOT FDS.DONT_PRINT THEN CALL BUF_OUT;

   7263  2 003140   200003 470500                    LDP0    @FDS,,AUTO
         2 003141   000013 236100                    LDQ     11,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:158  
         2 003142   000100 316007                    CANQ    64,DL
         2 003143   003150 601000 2                  TNZ     XIT
         2 003144   000040 316007                    CANQ    32,DL
         2 003145   003150 601000 2                  TNZ     XIT

   7263  2 003146   003441 701000 2                  TSX1    BUF_OUT
         2 003147   000000 011000                    NOP     0

      976     7264    1   XIT:    RETURN;

   7264  2 003150   000000 702200 xent  XIT          TSX2  ! X66_ARET

      977     7265    1   BAD_CNT:
      978     7266    1           PERCENT=-1;

   7266  2 003151   000001 335007       BAD_CNT      LCA     1,DL
         2 003152   200022 755100                    STA     PERCENT,,AUTO

      979     7267    1           GOTO BAD_CODE;

   7267  2 003153   003161 710000 2                  TRA     BAD_CODE

      980     7268    1   NO_MEM:
      981     7269    1           PERCENT=-2;

   7269  2 003154   000002 335007       NO_MEM       LCA     2,DL
         2 003155   200022 755100                    STA     PERCENT,,AUTO

      982     7270    1           GOTO BAD_CODE;

   7270  2 003156   003161 710000 2                  TRA     BAD_CODE

      983     7271    1   BAD_FMT:
      984     7272    1           FMTX=PERCENT;

   7272  2 003157   200022 235100       BAD_FMT      LDA     PERCENT,,AUTO
         2 003160   200004 755100                    STA     FMTX,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:159  

   7263  2 003161                       BAD_CODE     null
      985     7273    1   BAD_CODE: ;
      986     7274    1           CALL BUF_OUT;

   7274  2 003161   003441 701000 2                  TSX1    BUF_OUT
         2 003162   000000 011000                    NOP     0

      987     7275    1           IF FMTX<15 THEN X=FMTX;

   7275  2 003163   200004 235100                    LDA     FMTX,,AUTO
         2 003164   000017 115007                    CMPA    15,DL
         2 003165   003170 605000 2                  TPL     s:7276

   7275  2 003166   200063 755100                    STA     X,,AUTO
         2 003167   003172 710000 2                  TRA     s:7277

      988     7276    1           ELSE X=15;

   7276  2 003170   000017 236007                    LDQ     15,DL
         2 003171   200063 756100                    STQ     X,,AUTO

      989     7277    1           IF FMTX+15>FDS.FMTSIZE THEN I=FDS.FMTSIZE-FMTX;

   7277  2 003172   200003 470500                    LDP0    @FDS,,AUTO
         2 003173   200004 236100                    LDQ     FMTX,,AUTO
         2 003174   000017 036007                    ADLQ    15,DL
         2 003175   000004 116100                    CMPQ    4,,PR0
         2 003176   003203 604400 2                  TMOZ    s:7278

   7277  2 003177   000004 236100                    LDQ     4,,PR0
         2 003200   200004 136100                    SBLQ    FMTX,,AUTO
         2 003201   200021 756100                    STQ     I,,AUTO
         2 003202   003205 710000 2                  TRA     s:7279

      990     7278    1           ELSE I=15;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:160  
   7278  2 003203   000017 235007                    LDA     15,DL
         2 003204   200021 755100                    STA     I,,AUTO

      991     7279    1           BUFFER=BITASC('037'O);          /* TRANSITION 1 VFC */

   7279  2 003205   000006 471500                    LDP1    6,,PR0
         2 003206   000010 720100                    LXL0    8,,PR0
         2 003207   040140 100400                    MLR     fill='040'O
         2 003210   000034 000001 3                  ADSC9   28                       cn=0,n=1
         2 003211   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      992     7280    1           CALL INSERT(BUFFER,1,X+I,SUBSTR(FMT,FMTX-X,X+I));

   7280  2 003212   000006 471500                    LDP1    6,,PR0
         2 003213   000010 720100                    LXL0    8,,PR0
         2 003214   200063 236100                    LDQ     X,,AUTO
         2 003215   200021 036100                    ADLQ    I,,AUTO
         2 003216   000001 473500                    LDP3    1,,PR0
         2 003217   000004 721100                    LXL1    4,,PR0
         2 003220   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 003221   200004 236100                    LDQ     FMTX,,AUTO
         2 003222   200063 136100                    SBLQ    X,,AUTO
         2 003223   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 003224   200063 236100                    LDQ     X,,AUTO
         2 003225   200021 036100                    ADLQ    I,,AUTO
         2 003226   000000 620006                    EAX0    0,QL
         2 003227   200143 235100                    LDA     TABLEVAL+7,,AUTO
         2 003230   200142 721100                    LXL1    TABLEVAL+6,,AUTO
         2 003231   040140 100545                    MLR     fill='040'O
         2 003232   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0
         2 003233   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1

      993     7281    1           FDS.BUFX=X+I+1;

   7281  2 003234   200063 236100                    LDQ     X,,AUTO
         2 003235   200021 036100                    ADLQ    I,,AUTO
         2 003236   000001 036007                    ADLQ    1,DL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:161  
         2 003237   000007 756100                    STQ     7,,PR0

      994     7282    1           FDS.BLNKBUF='0'B;

   7282  2 003240   000035 236000 3                  LDQ     29
         2 003241   000013 356100                    ANSQ    11,,PR0

      995     7283    1           CALL BUF_OUT;

   7283  2 003242   003441 701000 2                  TSX1    BUF_OUT
         2 003243   000000 011000                    NOP     0

      996     7284    1           BUFFER='A';

   7284  2 003244   200003 470500                    LDP0    @FDS,,AUTO
         2 003245   000006 471500                    LDP1    6,,PR0
         2 003246   000010 720100                    LXL0    8,,PR0
         2 003247   040140 100400                    MLR     fill='040'O
         2 003250   000036 000001 3                  ADSC9   30                       cn=0,n=1
         2 003251   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      997     7285    1           CALL INSERT(BUFFER,X+1,1,'^');

   7285  2 003252   000006 471500                    LDP1    6,,PR0
         2 003253   000010 720100                    LXL0    8,,PR0
         2 003254   200063 235100                    LDA     X,,AUTO
         2 003255   040105 100400                    MLR     fill='040'O
         2 003256   000037 000001 3                  ADSC9   31                       cn=0,n=1
         2 003257   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1

      998     7286    1           FDS.BUFX=X+2;

   7286  2 003260   200063 235100                    LDA     X,,AUTO
         2 003261   000002 035007                    ADLA    2,DL
         2 003262   000007 755100                    STA     7,,PR0

      999     7287    1           FDS.BLNKBUF='0'B;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:162  

   7287  2 003263   000035 236000 3                  LDQ     29
         2 003264   000013 356100                    ANSQ    11,,PR0

     1000     7288    1           CALL BUF_OUT;

   7288  2 003265   003441 701000 2                  TSX1    BUF_OUT
         2 003266   000000 011000                    NOP     0

     1001     7289    2           IF FMTX=PERCENT THEN DO;

   7289  2 003267   200004 236100                    LDQ     FMTX,,AUTO
         2 003270   200022 116100                    CMPQ    PERCENT,,AUTO
         2 003271   003301 601000 2                  TNZ     s:7291+1

     1002     7290    2              BUFFER='AUNBALANCED GROUP CODES - CC, (), OR [?]';

   7290  2 003272   200003 470500                    LDP0    @FDS,,AUTO
         2 003273   000006 471500                    LDP1    6,,PR0
         2 003274   000010 720100                    LXL0    8,,PR0
         2 003275   040140 100400                    MLR     fill='040'O
         2 003276   000332 000050 0                  ADSC9   STR_DUMP+151             cn=0,n=40
         2 003277   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1003     7291    2              END; ELSE IF PERCENT=-1 THEN DO;

   7291  2 003300   003332 710000 2                  TRA     s:7298

   7291  2 003301   200022 235100                    LDA     PERCENT,,AUTO
         2 003302   000027 115000 xsym               CMPA    B_VECTNIL+23
         2 003303   003313 601000 2                  TNZ     s:7293+1

     1004     7292    2                 BUFFER='ABAD NUMBER FOR VALUE OR SUBROUTINE';

   7292  2 003304   200003 470500                    LDP0    @FDS,,AUTO
         2 003305   000006 471500                    LDP1    6,,PR0
         2 003306   000010 720100                    LXL0    8,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:163  
         2 003307   040140 100400                    MLR     fill='040'O
         2 003310   000344 000043 0                  ADSC9   STR_DUMP+161             cn=0,n=35
         2 003311   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1005     7293    2                 END; ELSE IF PERCENT=-2 THEN DO;

   7293  2 003312   003332 710000 2                  TRA     s:7298

   7293  2 003313   000040 115000 3                  CMPA    32
         2 003314   003324 601000 2                  TNZ     s:7296

     1006     7294    2                    BUFFER='ARAN OUT OF DATA VECTORS';

   7294  2 003315   200003 470500                    LDP0    @FDS,,AUTO
         2 003316   000006 471500                    LDP1    6,,PR0
         2 003317   000010 720100                    LXL0    8,,PR0
         2 003320   040140 100400                    MLR     fill='040'O
         2 003321   000355 000030 0                  ADSC9   STR_DUMP+170             cn=0,n=24
         2 003322   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1007     7295    2                    END; ELSE DO;

   7295  2 003323   003332 710000 2                  TRA     s:7298

     1008     7296    2                    BUFFER='AUNKNOWN INSERTION CODE';

   7296  2 003324   200003 470500                    LDP0    @FDS,,AUTO
         2 003325   000006 471500                    LDP1    6,,PR0
         2 003326   000010 720100                    LXL0    8,,PR0
         2 003327   040140 100400                    MLR     fill='040'O
         2 003330   000363 000027 0                  ADSC9   STR_DUMP+176             cn=0,n=23
         2 003331   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1009     7297    2                    END;

     1010     7298    1           CALL INDEX(FDS.BUFX,'  ',BUFFER);

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:164  
   7298  2 003332   000006 471500                    LDP1    6,,PR0
         2 003333   000010 720100                    LXL0    8,,PR0
         2 003334   000000 120540                    SCD
         2 003335   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 003336   000371 000002 0                  ADSC9   STR_DUMP+182             cn=0,n=2
         2 003337   000007 000100                    ARG     7,,PR0
         2 003340   003342 607000 2                  TTF     s:7299
         2 003341   000007 054100                    AOS     7,,PR0

     1011     7299    1           FDS.BLNKBUF='0'B;

   7299  2 003342   000035 236000 3                  LDQ     29
         2 003343   000013 356100                    ANSQ    11,,PR0

     1012     7300    1           CALL BUF_OUT;

   7300  2 003344   003441 701000 2                  TSX1    BUF_OUT
         2 003345   000000 011000                    NOP     0

     1013     7301    1           UNWIND TO FDS.BAILOUT;

   7301  2 003346   200003 470700                    LDP0  ! @FDS,,AUTO
         2 003347   000100 100700                    MLR   ! fill='000'O
         2 003350   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         2 003351   200142 000010                    ADSC9   TABLEVAL+6,,AUTO         cn=0,n=8
         2 003352   200142 237300                    LDAQ  ! TABLEVAL+6,,AUTO
         2 003353   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 003354   000000 000200                    ZERO    0,128

     1014     7302        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:165  
     1015     7303    1   SETMEM: PROC(X,B);

   7303  2 003355   200124 741300       SETMEM       STX1  ! M$+2,,AUTO

     1016     7304    2   DCL X SBIN;
     1017     7305    2   DCL B SBIN;
     1018     7306    2   DCL BB SBIN;
     1019     7307    2           FDS.MEMX=X-1;

   7307  2 003356   200125 470500                    LDP0    @X,,AUTO
         2 003357   200003 471500                    LDP1    @FDS,,AUTO
         2 003360   000000 235100                    LDA     0,,PR0
         2 003361   000001 135007                    SBLA    1,DL
         2 003362   100026 755100                    STA     22,,PR1

     1020     7308    2           FDS.MEMSZ=0;

   7308  2 003363   100025 450100                    STZ     21,,PR1

     1021     7309    2           BB=B;

   7309  2 003364   200126 473500                    LDP3    @B,,AUTO
         2 003365   300000 235100                    LDA     0,,PR3
         2 003366   200127 755100                    STA     BB,,AUTO

     1022     7310    3           DO WHILE(FDS.MEMSZ<=0);

   7310  2 003367   100025 235100                    LDA     21,,PR1
         2 003370   003434 605400 2                  TPNZ    s:7321

     1023     7311    3              FDS.MEMX=FDS.MEMX+1;

   7311  2 003371   200003 470500                    LDP0    @FDS,,AUTO
         2 003372   000026 054100                    AOS     22,,PR0

     1024     7312    3              IF FDS.MEMX>=FDS.NVECS# THEN GOTO NO_MEM;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:166  
   7312  2 003373   000026 236100                    LDQ     22,,PR0
         2 003374   000011 116100                    CMPQ    9,,PR0
         2 003375   003436 605000 2                  TPL     NO_MEM

     1025     7313    4              IF MEMVEC(FDS.MEMX)~=VECTOR(NIL) THEN DO;

   7313  2 003376   000012 471500                    LDP1    10,,PR0
         2 003377   000026 235100                    LDA     22,,PR0
         2 003400   000001 735000                    ALS     1
         2 003401   000002 735000                    ALS     2
         2 003402   000000 106505                    CMPC    fill='000'O
         2 003403   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         2 003404   000042 000010 3                  ADSC9   34                       cn=0,n=8
         2 003405   003432 600000 2                  TZE     s:7320

     1026     7314    4                 FDS.CUR$=MEMVEC.PTR$(FDS.MEMX);

   7314  2 003406   000026 235100                    LDA     22,,PR0
         2 003407   000001 735000                    ALS     1
         2 003410   100001 236105                    LDQ     1,AL,PR1
         2 003411   000027 756100                    STQ     23,,PR0

     1027     7315    4                 FDS.MEMSZ=(MEMVEC.BOUND(FDS.MEMX)+1)*9;

   7315  2 003412   000026 235100                    LDA     22,,PR0
         2 003413   000001 735000                    ALS     1
         2 003414   100000 236105                    LDQ     0,AL,PR1
         2 003415   000020 772000                    QRL     16
         2 003416   000011 402007                    MPY     9,DL
         2 003417   000011 036007                    ADLQ    9,DL
         2 003420   000025 756100                    STQ     21,,PR0

     1028     7316    4                 FDS.MEMSZ=FDS.MEMSZ-BB;

   7316  2 003421   200127 136100                    SBLQ    BB,,AUTO
         2 003422   000025 756100                    STQ     21,,PR0

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:167  
     1029     7317    4                 FDS.CUR$=PINCRB(FDS.CUR$,BB);

   7317  2 003423   000027 473500                    LDP3    23,,PR0
         2 003424   200127 235100                    LDA     BB,,AUTO
         2 003425   003427 605000 2                  TPL     s:7317+4
         2 003426   000044 035003                    ADLA    36,DU
         2 003427   300000 503505                    ABD     0,AL,PR3
         2 003430   000027 453500                    STP3    23,,PR0

     1030     7318    4                 BB=0;

   7318  2 003431   200127 450100                    STZ     BB,,AUTO

     1031     7319    4                 END;

     1032     7320    3              END;

   7320  2 003432   000025 235100                    LDA     21,,PR0
         2 003433   003371 604400 2                  TMOZ    s:7311

     1033     7321    2           RETURN;

   7321  2 003434   200124 221300                    LDX1  ! M$+2,,AUTO
         2 003435   000001 702211                    TSX2  ! 1,X1

     1034     7322    2   NO_MEM: FDS.MEMSZ=0;

   7322  2 003436   000025 450100       NO_MEM       STZ     21,,PR0

     1035     7323    2           RETURN;

   7323  2 003437   200124 221300                    LDX1  ! M$+2,,AUTO
         2 003440   000001 702211                    TSX2  ! 1,X1

     1036     7324    2   END SETMEM;
     1037     7325        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:168  
     1038     7326    1   BUF_OUT: PROC;

   7326  2 003441   200136 741300       BUF_OUT      STX1  ! TABLEVAL+2,,AUTO

     1039     7327    2           IF FDS.BLNKBUF THEN CALL BLANKBUF;

   7327  2 003442   200003 470500                    LDP0    @FDS,,AUTO
         2 003443   000013 236100                    LDQ     11,,PR0
         2 003444   000100 316007                    CANQ    64,DL
         2 003445   003450 600000 2                  TZE     s:7328

   7327  2 003446   003662 701000 2                  TSX1    BLANKBUF
         2 003447   000000 011000                    NOP     0

     1040     7328    2           FDS.WRAP='0'B;

   7328  2 003450   200003 470500                    LDP0    @FDS,,AUTO
         2 003451   000041 236000 3                  LDQ     33
         2 003452   000013 356100                    ANSQ    11,,PR0

     1041     7329    2           FPT$WRITE.BUF_.BOUND=FDS.BUFX-1;

   7329  2 003453   000031 471500                    LDP1    25,,PR0
         2 003454   000007 236100                    LDQ     7,,PR0
         2 003455   000001 136007                    SBLQ    1,DL
         2 003456   000020 736000                    QLS     16
         2 003457   100004 676100                    ERQ     4,,PR1
         2 003460   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003461   100004 656100                    ERSQ    4,,PR1

   7329  2 003462                       WRAPENT      null
     1042     7330    2   WRAPENT:;
     1043     7331    2           FPT$WRITE.BUF_.BUF$=FDS.BUF_.BUF$;

   7331  2 003462   200003 470500                    LDP0    @FDS,,AUTO
         2 003463   000031 471500                    LDP1    25,,PR0
         2 003464   000006 236100                    LDQ     6,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:169  
         2 003465   100005 756100                    STQ     5,,PR1

     1044     7332    3           IF FDS.OUTPUT#~=ENTADDR(NIL) THEN DO;

   7332  2 003466   000014 236100                    LDQ     12,,PR0
         2 003467   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 003470   003504 600000 2                  TZE     s:7335

     1045     7333    3              CALL FDS.OUTPUT#(FPT$WRITE.BUF_,FDS) ALTRET(SKIP_WRITE);

   7333  2 003471   000031 471500                    LDP1    25,,PR0
         2 003472   200003 236100                    LDQ     @FDS,,AUTO
         2 003473   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 003474   100004 633500                    EPPR3   4,,PR1
         2 003475   200142 453500                    STP3    TABLEVAL+6,,AUTO
         2 003476   200142 630500                    EPPR0   TABLEVAL+6,,AUTO
         2 003477   200003 471500                    LDP1    @FDS,,AUTO
         2 003500   100014 220100                    LDX0    12,,PR1
         2 003501   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003502   000000 701010                    TSX1    0,X0
         2 003503   003546 702000 2                  TSX2    SKIP_WRITE

     1046     7334    3              END;

     1047     7335    3           IF FDS.DCB#~=DCBNUM(NIL) THEN DO;

   7335  2 003504   200003 470500                    LDP0    @FDS,,AUTO
         2 003505   000013 220100                    LDX0    11,,PR0
         2 003506   003546 600000 2                  TZE     SKIP_WRITE

     1048     7336    3              FPT$WRITE.V.DCB#=FDS.DCB#;

   7336  2 003507   000031 471500                    LDP1    25,,PR0
         2 003510   100010 740100                    STX0    8,,PR1

     1049     7337    4              IF SUBSTR(BUFFER,0,1)='*' /* star-VFC means no VFC */ THEN DO;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:170  
   7337  2 003511   000006 471500                    LDP1    6,,PR0
         2 003512   000010 720100                    LXL0    8,,PR0
         2 003513   040000 106500                    CMPC    fill='040'O
         2 003514   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 003515   000044 000001 3                  ADSC9   36                       cn=0,n=1
         2 003516   003536 601000 2                  TNZ     s:7342

     1050     7338    4                 BUFFER=SUBSTR(BUFFER,1);

   7338  2 003517   777777 621010                    EAX1    -1,X0
         2 003520   040140 100540                    MLR     fill='040'O
         2 003521   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         2 003522   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1051     7339    4                 FPT$WRITE.BUF_.BOUND=FPT$WRITE.BUF_.BOUND-1;

   7339  2 003523   000031 471500                    LDP1    25,,PR0
         2 003524   100004 236100                    LDQ     4,,PR1
         2 003525   000020 772000                    QRL     16
         2 003526   000001 136007                    SBLQ    1,DL
         2 003527   000020 736000                    QLS     16
         2 003530   100004 676100                    ERQ     4,,PR1
         2 003531   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003532   100004 656100                    ERSQ    4,,PR1

     1052     7340    4                 FPT$WRITE.V.DVBYTE.VFC#='0'B;

   7340  2 003533   000031 471500                    LDP1    25,,PR0
         2 003534   000045 236000 3                  LDQ     37
         2 003535   100013 356100                    ANSQ    11,,PR1

     1053     7341    4                 END;

     1054     7342    3              CALL M$WRITE(FPT$WRITE);

   7342  2 003536   000031 471500                    LDP1    25,,PR0
         2 003537   100000 630500                    EPPR0   0,,PR1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:171  
         2 003540   040001 713400                    CLIMB   write
         2 003541   401400 401760                    pmme    nvectors=4

     1055     7343    3              FPT$WRITE.V.DVBYTE.VFC#='1'B;

   7343  2 003542   200003 470500                    LDP0    @FDS,,AUTO
         2 003543   000031 471500                    LDP1    25,,PR0
         2 003544   100000 236003                    LDQ     32768,DU
         2 003545   100013 256100                    ORSQ    11,,PR1

     1056     7344    3              END;

   7339  2 003546                       SKIP_WRITE   null
     1057     7345    2   SKIP_WRITE: ;
     1058     7346    2           IF NOT FDS.WRAP THEN FDS.BLNKBUF='1'B;

   7346  2 003546   200003 470500                    LDP0    @FDS,,AUTO
         2 003547   000013 236100                    LDQ     11,,PR0
         2 003550   000020 316007                    CANQ    16,DL
         2 003551   003555 601000 2                  TNZ     s:7347

   7346  2 003552   000100 236007                    LDQ     64,DL
         2 003553   000013 256100                    ORSQ    11,,PR0
         2 003554   003635 710000 2                  TRA     s:7355

     1059     7347    3           ELSE IF FDS.BUFX=0 THEN DO;

   7347  2 003555   000007 235100                    LDA     7,,PR0
         2 003556   003567 601000 2                  TNZ     s:7351

     1060     7348    3                 FDS.BUFX=FDS.WRAPTAB#;

   7348  2 003557   000016 235100                    LDA     14,,PR0
         2 003560   000007 755100                    STA     7,,PR0

     1061     7349    3                 BUFFER=FDS.DVFC#;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:172  
   7349  2 003561   000006 471500                    LDP1    6,,PR0
         2 003562   000010 720100                    LXL0    8,,PR0
         2 003563   040140 100500                    MLR     fill='040'O
         2 003564   000013 400001                    ADSC9   11,,PR0                  cn=2,n=1
         2 003565   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1062     7350    3                 END; ELSE DO;

   7350  2 003566   003635 710000 2                  TRA     s:7355

     1063     7351    3                 SUBSTR(BUFFER,0,FDS.WRAPTAB#)=FDS.DVFC#;

   7351  2 003567   000006 471500                    LDP1    6,,PR0
         2 003570   000010 720100                    LXL0    8,,PR0
         2 003571   000016 721100                    LXL1    14,,PR0
         2 003572   040140 100500                    MLR     fill='040'O
         2 003573   000013 400001                    ADSC9   11,,PR0                  cn=2,n=1
         2 003574   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1064     7352    3                 SUBSTR(BUFFER,FDS.WRAPTAB#)=SUBSTR(BUFFER,FPT$WRITE.BUF_.BOUND+1);

   7352  2 003575   000006 471500                    LDP1    6,,PR0
         2 003576   000010 720100                    LXL0    8,,PR0
         2 003577   000000 636010                    EAQ     0,X0
         2 003600   000022 732000                    QRS     18
         2 003601   000016 136100                    SBLQ    14,,PR0
         2 003602   000016 235100                    LDA     14,,PR0
         2 003603   000031 473500                    LDP3    25,,PR0
         2 003604   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 003605   300004 236100                    LDQ     4,,PR3
         2 003606   000020 772000                    QRL     16
         2 003607   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 003610   000000 636010                    EAQ     0,X0
         2 003611   000022 732000                    QRS     18
         2 003612   200143 136100                    SBLQ    TABLEVAL+7,,AUTO
         2 003613   200144 756100                    STQ     TABLEVAL+8,,AUTO
         2 003614   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:173  
         2 003615   000020 772000                    QRL     16
         2 003616   200144 720100                    LXL0    TABLEVAL+8,,AUTO
         2 003617   777777 621010                    EAX1    -1,X0
         2 003620   200142 722100                    LXL2    TABLEVAL+6,,AUTO
         2 003621   040145 100546                    MLR     fill='040'O
         2 003622   100000 200011                    ADSC9   0,Q,PR1                  cn=1,n=*X1
         2 003623   100000 000012                    ADSC9   0,A,PR1                  cn=0,n=*X2

     1065     7353    3                 FDS.BUFX=FDS.BUFX-FPT$WRITE.BUF_.BOUND+FDS.WRAPTAB#-1;

   7353  2 003624   000031 471500                    LDP1    25,,PR0
         2 003625   100004 236100                    LDQ     4,,PR1
         2 003626   000020 772000                    QRL     16
         2 003627   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 003630   000007 236100                    LDQ     7,,PR0
         2 003631   200142 136100                    SBLQ    TABLEVAL+6,,AUTO
         2 003632   000016 036100                    ADLQ    14,,PR0
         2 003633   000001 136007                    SBLQ    1,DL
         2 003634   000007 756100                    STQ     7,,PR0

     1066     7354    3                 END;

     1067     7355    2           FPT$WRITE.BUF_.BOUND=0;

   7355  2 003635   000031 471500                    LDP1    25,,PR0
         2 003636   177777 236007                    LDQ     65535,DL
         2 003637   100004 356100                    ANSQ    4,,PR1

     1068     7356    2           RETURN;

   7356  2 003640   200136 221300                    LDX1  ! TABLEVAL+2,,AUTO
         2 003641   000001 702211                    TSX2  ! 1,X1

     1069     7357    2   BUF_WRAP: ENTRY;

   7357  2 003642   200136 741300       BUF_WRAP     STX1  ! TABLEVAL+2,,AUTO

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:174  
     1070     7358    2           FDS.WRAP='1'B;

   7358  2 003643   200003 470500                    LDP0    @FDS,,AUTO
         2 003644   000020 236007                    LDQ     16,DL
         2 003645   000013 256100                    ORSQ    11,,PR0

     1071     7359    3           IF FPT$WRITE.BUF_.BOUND=0 THEN DO;

   7359  2 003646   000031 471500                    LDP1    25,,PR0
         2 003647   100004 236100                    LDQ     4,,PR1
         2 003650   000034 316000 xsym               CANQ    B_VECTNIL+28
         2 003651   003661 601000 2                  TNZ     s:7363

     1072     7360    3              FPT$WRITE.BUF_.BOUND=FDS.BUFX-1;

   7360  2 003652   000007 236100                    LDQ     7,,PR0
         2 003653   000001 136007                    SBLQ    1,DL
         2 003654   000020 736000                    QLS     16
         2 003655   100004 676100                    ERQ     4,,PR1
         2 003656   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003657   100004 656100                    ERSQ    4,,PR1

     1073     7361    3              FDS.BUFX=0;

   7361  2 003660   000007 450100                    STZ     7,,PR0

     1074     7362    3              END;

     1075     7363    2           GOTO WRAPENT;

   7363  2 003661   003462 710000 2                  TRA     WRAPENT

     1076     7364    2   END BUF_OUT;
     1077     7365        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:175  
     1078     7366    1   BLANKBUF: PROC;

   7366  2 003662   200140 741300       BLANKBUF     STX1  ! TABLEVAL+4,,AUTO

     1079     7367    2           BUFFER=FDS.DVFC#;

   7367  2 003663   200003 470500                    LDP0    @FDS,,AUTO
         2 003664   000006 471500                    LDP1    6,,PR0
         2 003665   000010 720100                    LXL0    8,,PR0
         2 003666   040140 100500                    MLR     fill='040'O
         2 003667   000013 400001                    ADSC9   11,,PR0                  cn=2,n=1
         2 003670   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1080     7368    2           FDS.BUFX=1;

   7368  2 003671   000001 235007                    LDA     1,DL
         2 003672   000007 755100                    STA     7,,PR0

     1081     7369    2           FDS.BLNKBUF='0'B;

   7369  2 003673   000035 236000 3                  LDQ     29
         2 003674   000013 356100                    ANSQ    11,,PR0

     1082     7370    2           RETURN;

   7370  2 003675   200140 221300                    LDX1  ! TABLEVAL+4,,AUTO
         2 003676   000001 702211                    TSX2  ! 1,X1

     1083     7371    2   END BLANKBUF;
     1084     7372        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:176  
     1085     7373    1   GETMEM: PROC(M$,B) ALTRET;

   7373  2 003677   200112 741300       GETMEM       STX1  ! TRANS$+2,,AUTO

     1086     7374    2   DCL M$ PTR;
     1087     7375    2   DCL 1 M REDEF M$,
     1088     7376    2         2 BA UBIN(20) UNAL,
     1089     7377    2         2 BT UBIN(4) UNAL,
     1090     7378    2         2 SEG BIT(12) UNAL;
     1091     7379    2   DCL B SBIN;
     1092     7380    2           M$=FDS.CUR$;

   7380  2 003700   200003 470500                    LDP0    @FDS,,AUTO
         2 003701   000027 236100                    LDQ     23,,PR0
         2 003702   200113 471500                    LDP1    @M$,,AUTO
         2 003703   100000 756100                    STQ     0,,PR1

     1093     7381    3           IF M.BT>0 THEN DO;

   7381  2 003704   100000 236100                    LDQ     0,,PR1
         2 003705   170000 316007                    CANQ    61440,DL
         2 003706   003743 600000 2                  TZE     s:7388

     1094     7382    3              M.BA=M.BA+1;

   7382  2 003707   100000 236100                    LDQ     0,,PR1
         2 003710   000020 772000                    QRL     16
         2 003711   000001 036007                    ADLQ    1,DL
         2 003712   000020 736000                    QLS     16
         2 003713   100000 676100                    ERQ     0,,PR1
         2 003714   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003715   100000 656100                    ERSQ    0,,PR1

     1095     7383    3              FDS.MEMSZ=FDS.MEMSZ-(9-M.BT);

   7383  2 003716   100000 236100                    LDQ     0,,PR1
         2 003717   000014 772000                    QRL     12
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:177  
         2 003720   000017 376007                    ANQ     15,DL
         2 003721   000025 036100                    ADLQ    21,,PR0
         2 003722   000011 136007                    SBLQ    9,DL
         2 003723   000025 756100                    STQ     21,,PR0

     1096     7384    3              M.BT=0;

   7384  2 003724   000046 236000 3                  LDQ     38
         2 003725   100000 356100                    ANSQ    0,,PR1

     1097     7385    3              FDS.CUR$=M$;

   7385  2 003726   100000 236100                    LDQ     0,,PR1
         2 003727   000027 756100                    STQ     23,,PR0

     1098     7386    3              IF FDS.MEMSZ<=0 THEN CALL SETMEM(FDS.MEMX+1,0);

   7386  2 003730   000025 235100                    LDA     21,,PR0
         2 003731   003743 605400 2                  TPNZ    s:7388

   7386  2 003732   000026 235100                    LDA     22,,PR0
         2 003733   000001 035007                    ADLA    1,DL
         2 003734   200154 755100                    STA     TABLEVAL+16,,AUTO
         2 003735   000000 236000 3                  LDQ     0
         2 003736   200126 756100                    STQ     @B,,AUTO
         2 003737   200154 633500                    EPPR3   TABLEVAL+16,,AUTO
         2 003740   200125 453500                    STP3    @X,,AUTO
         2 003741   003355 701000 2                  TSX1    SETMEM
         2 003742   000000 011000                    NOP     0

     1099     7387    3              END;

     1100     7388    3           DO WHILE(B>FDS.MEMSZ/9);

   7388  2 003743   003763 710000 2                  TRA     s:7391

     1101     7389    3              CALL SETMEM(FDS.MEMX+1,0);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:178  

   7389  2 003744   200003 470500                    LDP0    @FDS,,AUTO
         2 003745   000026 235100                    LDA     22,,PR0
         2 003746   000001 035007                    ADLA    1,DL
         2 003747   200155 755100                    STA     TABLEVAL+17,,AUTO
         2 003750   000000 236000 3                  LDQ     0
         2 003751   200126 756100                    STQ     @B,,AUTO
         2 003752   200155 631500                    EPPR1   TABLEVAL+17,,AUTO
         2 003753   200125 451500                    STP1    @X,,AUTO
         2 003754   003355 701000 2                  TSX1    SETMEM
         2 003755   000000 011000                    NOP     0

     1102     7390    3              IF FDS.MEMSZ=0 THEN ALTRETURN;

   7390  2 003756   200003 470500                    LDP0    @FDS,,AUTO
         2 003757   000025 235100                    LDA     21,,PR0
         2 003760   003763 601000 2                  TNZ     s:7391

   7390  2 003761   200112 221300                    LDX1  ! TRANS$+2,,AUTO
         2 003762   000000 702211                    TSX2  ! 0,X1

     1103     7391    3              END;

   7391  2 003763   200003 470500                    LDP0    @FDS,,AUTO
         2 003764   000025 236100                    LDQ     21,,PR0
         2 003765   000011 506007                    DIV     9,DL
         2 003766   200114 471500                    LDP1    @B,,AUTO
         2 003767   100000 116100                    CMPQ    0,,PR1
         2 003770   003744 604000 2                  TMI     s:7389

     1104     7392    2           FDS.CUR$=PINCRC(FDS.CUR$,B);

   7392  2 003771   100000 236100                    LDQ     0,,PR1
         2 003772   000027 473500                    LDP3    23,,PR0
         2 003773   000011 402007                    MPY     9,DL
         2 003774   000000 116003                    CMPQ    0,DU
         2 003775   003777 605000 2                  TPL     s:7392+6
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:179  
         2 003776   000044 036003                    ADLQ    36,DU
         2 003777   300000 503506                    ABD     0,QL,PR3
         2 004000   000027 453500                    STP3    23,,PR0

     1105     7393    2           FDS.MEMSZ=FDS.MEMSZ-(B*9);

   7393  2 004001   100000 236100                    LDQ     0,,PR1
         2 004002   000047 402000 3                  MPY     39
         2 004003   000025 036100                    ADLQ    21,,PR0
         2 004004   000025 756100                    STQ     21,,PR0

     1106     7394    2           IF FDS.MEMSZ=0 THEN CALL SETMEM(FDS.MEMX+1,0);

   7394  2 004005   004017 601000 2                  TNZ     s:7395

   7394  2 004006   000026 235100                    LDA     22,,PR0
         2 004007   000001 035007                    ADLA    1,DL
         2 004010   200156 755100                    STA     TABLEVAL+18,,AUTO
         2 004011   000000 236000 3                  LDQ     0
         2 004012   200126 756100                    STQ     @B,,AUTO
         2 004013   200156 633500                    EPPR3   TABLEVAL+18,,AUTO
         2 004014   200125 453500                    STP3    @X,,AUTO
         2 004015   003355 701000 2                  TSX1    SETMEM
         2 004016   000000 011000                    NOP     0

     1107     7395    2           RETURN;

   7395  2 004017   200112 221300                    LDX1  ! TRANS$+2,,AUTO
         2 004020   000001 702211                    TSX2  ! 1,X1

     1108     7396    2   END GETMEM;
     1109     7397        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:180  
     1110     7398    1   GETVAL: PROC(V,B) ALTRET;

   7398  2 004021   200114 741300       GETVAL       STX1  ! @B,,AUTO

     1111     7399    2   DCL V SBIN;
     1112     7400    2   DCL B SBIN;
     1113     7401    2   DCL BB SBIN;
     1114     7402    2   DCL VALBASE BIT(BB) BASED UNAL;
     1115     7403    2   DCL CC UBIN;
     1116     7404    2   DCL VALBASEC CHAR(CC) BASED;
     1117     7405    2   DCL V$ PTR;
     1118     7406    2   DCL M$ PTR;
     1119     7407    2   DCL 1 M REDEF M$,
     1120     7408    2         2 W UBIN HALF CALIGNED,
     1121     7409    2         2 C UBIN(2) UNAL,
     1122     7410    2         2 B UBIN(4) UNAL,
     1123     7411    2         2 SID BIT(12);
     1124     7412    3           IF FLAGS.CNT1 AND ADDR(B)=ADDR(CNT(1)) AND ADDR(B)~=ADDR(V) THEN DO;

   7412  2 004022   200011 236100                    LDQ     FLAGS,,AUTO
         2 004023   000200 316003                    CANQ    128,DU
         2 004024   004042 600000 2                  TZE     s:7416
         2 004025   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 004026   200142 236100                    LDQ     TABLEVAL+6,,AUTO
         2 004027   000013 036003                    ADLQ    11,DU
         2 004030   200116 116100                    CMPQ    @B,,AUTO
         2 004031   004042 601000 2                  TNZ     s:7416
         2 004032   200116 236100                    LDQ     @B,,AUTO
         2 004033   200115 116100                    CMPQ    @V,,AUTO
         2 004034   004042 600000 2                  TZE     s:7416

     1125     7413    3              V=CNT(1);

   7413  2 004035   200115 470500                    LDP0    @V,,AUTO
         2 004036   200013 235100                    LDA     CNT+1,,AUTO
         2 004037   000000 755100                    STA     0,,PR0

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:181  
     1126     7414    3              RETURN;

   7414  2 004040   200114 221300                    LDX1  ! @B,,AUTO
         2 004041   000001 702211                    TSX2  ! 1,X1

     1127     7415    3              END;
     1128     7416    2           IF B>36 THEN BB=36;

   7416  2 004042   200116 470500                    LDP0    @B,,AUTO
         2 004043   000000 235100                    LDA     0,,PR0
         2 004044   000044 115007                    CMPA    36,DL
         2 004045   004051 604400 2                  TMOZ    s:7417

   7416  2 004046   000044 236007                    LDQ     36,DL
         2 004047   200117 756100                    STQ     BB,,AUTO
         2 004050   004067 710000 2                  TRA     s:7422

     1129     7417    3           ELSE IF B=0 THEN DO;

   7417  2 004051   000000 115003                    CMPA    0,DU
         2 004052   004066 601000 2                  TNZ     s:7421

     1130     7418    3                 IF FDS.MEMSZ<36 AND FDS.MEMSZ>0 THEN BB=FDS.MEMSZ;

   7418  2 004053   200003 471500                    LDP1    @FDS,,AUTO
         2 004054   100025 235100                    LDA     21,,PR1
         2 004055   000044 115007                    CMPA    36,DL
         2 004056   004063 605000 2                  TPL     s:7419
         2 004057   000000 115003                    CMPA    0,DU
         2 004060   004063 604400 2                  TMOZ    s:7419

   7418  2 004061   200117 755100                    STA     BB,,AUTO
         2 004062   004067 710000 2                  TRA     s:7422

     1131     7419    3                 ELSE BB=36;

   7419  2 004063   000044 236007                    LDQ     36,DL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:182  
         2 004064   200117 756100                    STQ     BB,,AUTO

     1132     7420    3                 END;

   7420  2 004065   004067 710000 2                  TRA     s:7422

     1133     7421    2              ELSE BB=B;

   7421  2 004066   200117 755100                    STA     BB,,AUTO

     1134     7422    3           DO WHILE(BB>FDS.MEMSZ);

   7422  2 004067   200003 471500                    LDP1    @FDS,,AUTO
         2 004070   200117 236100                    LDQ     BB,,AUTO
         2 004071   100025 116100                    CMPQ    21,,PR1
         2 004072   004115 604400 2                  TMOZ    s:7426

     1135     7423    3              CALL SETMEM(FDS.MEMX+1,0);

   7423  2 004073   200003 470500                    LDP0    @FDS,,AUTO
         2 004074   000026 235100                    LDA     22,,PR0
         2 004075   000001 035007                    ADLA    1,DL
         2 004076   200157 755100                    STA     TABLEVAL+19,,AUTO
         2 004077   000000 236000 3                  LDQ     0
         2 004100   200126 756100                    STQ     @B,,AUTO
         2 004101   200157 631500                    EPPR1   TABLEVAL+19,,AUTO
         2 004102   200125 451500                    STP1    @X,,AUTO
         2 004103   003355 701000 2                  TSX1    SETMEM
         2 004104   000000 011000                    NOP     0

     1136     7424    3              IF FDS.MEMSZ<=0 THEN ALTRETURN;

   7424  2 004105   200003 470500                    LDP0    @FDS,,AUTO
         2 004106   000025 235100                    LDA     21,,PR0
         2 004107   004112 605400 2                  TPNZ    s:7425

   7424  2 004110   200114 221300                    LDX1  ! @B,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:183  
         2 004111   000000 702211                    TSX2  ! 0,X1

     1137     7425    3              END;

   7425  2 004112   200117 236100                    LDQ     BB,,AUTO
         2 004113   000025 116100                    CMPQ    21,,PR0
         2 004114   004073 605400 2                  TPNZ    s:7423

     1138     7426    2           M$=FDS.CUR$;

   7426  2 004115   200003 470500                    LDP0    @FDS,,AUTO
         2 004116   000027 236100                    LDQ     23,,PR0
         2 004117   200122 756100                    STQ     M$,,AUTO

     1139     7427    3           IF FDS.DEBUG THEN DO;

   7427  2 004120   000013 236100                    LDQ     11,,PR0
         2 004121   000200 316007                    CANQ    128,DL
         2 004122   004200 600000 2                  TZE     s:7437

     1140     7428    3              DBUF=%CONCAT(BITASC('037'O),'XX-bit fetch from VV-WWWWWW-C-B');

   7428  2 004123   040100 100400                    MLR     fill='040'O
         2 004124   000372 000040 0                  ADSC9   STR_DUMP+183             cn=0,n=32
         2 004125   200025 000120                    ADSC9   DBUF,,AUTO               cn=0,n=80

     1141     7429    3              CALL BINCHAR(SUBSTR(DBUF,1,2),BB);

   7429  2 004126   000100 301500                    BTD
         2 004127   200117 000004                    NDSC9   BB,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
         2 004130   200025 230002                    NDSC9   DBUF,,AUTO               cn=1,s=nosgn,sf=0,n=2

     1142     7430    3              CC=POFFC(M$,MEMVEC.PTR$(FDS.MEMX));

   7430  2 004131   000012 471500                    LDP1    10,,PR0
         2 004132   000026 235100                    LDA     22,,PR0
         2 004133   000001 735000                    ALS     1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:184  
         2 004134   100001 236105                    LDQ     1,AL,PR1
         2 004135   000020 772000                    QRL     16
         2 004136   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 004137   200122 236100                    LDQ     M$,,AUTO
         2 004140   000020 772000                    QRL     16
         2 004141   200142 136100                    SBLQ    TABLEVAL+6,,AUTO
         2 004142   200120 756100                    STQ     CC,,AUTO

     1143     7431    3              CALL BINCHAR(SUBSTR(DBUF,19,2),FDS.MEMX+1);

   7431  2 004143   000026 235100                    LDA     22,,PR0
         2 004144   000001 035007                    ADLA    1,DL
         2 004145   200142 755100                    STA     TABLEVAL+6,,AUTO
         2 004146   000100 301500                    BTD
         2 004147   200142 000004                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         2 004150   200031 630002                    NDSC9   DBUF+4,,AUTO             cn=3,s=nosgn,sf=0,n=2

     1144     7432    3              CALL BINCHAR(SUBSTR(DBUF,22,6),CC/4);

   7432  2 004151   000002 772000                    QRL     2
         2 004152   000000 235003                    LDA     0,DU
         2 004153   200142 757100                    STAQ    TABLEVAL+6,,AUTO
         2 004154   000100 301500                    BTD
         2 004155   200142 000010                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 004156   200032 430006                    NDSC9   DBUF+5,,AUTO             cn=2,s=nosgn,sf=0,n=6

     1145     7433    3              CALL BINCHAR(SUBSTR(DBUF,29,1),MOD(CC,4));

   7433  2 004157   200120 236100                    LDQ     CC,,AUTO
         2 004160   000003 376007                    ANQ     3,DL
         2 004161   000000 235003                    LDA     0,DU
         2 004162   200142 757100                    STAQ    TABLEVAL+6,,AUTO
         2 004163   000100 301500                    BTD
         2 004164   200142 000010                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 004165   200034 230001                    NDSC9   DBUF+7,,AUTO             cn=1,s=nosgn,sf=0,n=1

     1146     7434    3              CALL BINCHAR(SUBSTR(DBUF,31,1),M.B);
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:185  

   7434  2 004166   200122 236100                    LDQ     M$,,AUTO
         2 004167   000014 772000                    QRL     12
         2 004170   000017 376007                    ANQ     15,DL
         2 004171   000000 235003                    LDA     0,DU
         2 004172   200142 757100                    STAQ    TABLEVAL+6,,AUTO
         2 004173   000100 301500                    BTD
         2 004174   200142 000010                    NDSC9   TABLEVAL+6,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 004175   200034 630001                    NDSC9   DBUF+7,,AUTO             cn=3,s=nosgn,sf=0,n=1

     1147     7435    3              CALL DEBUG_OUT;

   7435  2 004176   005234 701000 2                  TSX1    DEBUG_OUT
         2 004177   000000 011000                    NOP     0

     1148     7436    3              END;

     1149     7437    3           IF FLAGS.L6 THEN DO;

   7437  2 004200   200011 430100                    FSZN    FLAGS,,AUTO
         2 004201   004214 605000 2                  TPL     s:7443

     1150     7438    4              IF M.B=0 THEN DO;

   7438  2 004202   200122 236100                    LDQ     M$,,AUTO
         2 004203   170000 316007                    CANQ    61440,DL
         2 004204   004214 601000 2                  TNZ     s:7443

     1151     7439    4                 FDS.CUR$=PINCRB(FDS.CUR$,1);

   7439  2 004205   200003 470500                    LDP0    @FDS,,AUTO
         2 004206   000027 471500                    LDP1    23,,PR0
         2 004207   000001 220003                    LDX0    1,DU
         2 004210   100000 503510                    ABD     0,X0,PR1
         2 004211   000027 451500                    STP1    23,,PR0

     1152     7440    4                 FDS.MEMSZ=FDS.MEMSZ-1;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:186  

   7440  2 004212   000001 336007                    LCQ     1,DL
         2 004213   000025 056100                    ASQ     21,,PR0

     1153     7441    4                 END;

     1154     7442    3              END;

     1155     7443    2           IF FLAGS.SIGN AND FDS.CUR$->ONEBIT THEN V=-1;

   7443  2 004214   200011 236100                    LDQ     FLAGS,,AUTO
         2 004215   100000 316003                    CANQ    32768,DU
         2 004216   004231 600000 2                  TZE     s:7444
         2 004217   200003 470500                    LDP0    @FDS,,AUTO
         2 004220   000027 471500                    LDP1    23,,PR0
         2 004221   000000 066500                    CMPB    filb='0'B
         2 004222   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         2 004223   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 004224   004231 600000 2                  TZE     s:7444

   7443  2 004225   000001 335007                    LCA     1,DL
         2 004226   200115 473500                    LDP3    @V,,AUTO
         2 004227   300000 755100                    STA     0,,PR3
         2 004230   004233 710000 2                  TRA     s:7445

     1156     7444    2           ELSE V=0;

   7444  2 004231   200115 470500                    LDP0    @V,,AUTO
         2 004232   000000 450100                    STZ     0,,PR0

     1157     7445    3           IF FLAGS.L6 THEN DO;

   7445  2 004233   200011 430100                    FSZN    FLAGS,,AUTO
         2 004234   004317 605000 2                  TPL     s:7463

     1158     7446    3              FDS.MEMSZ=FDS.MEMSZ-BB;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:187  
   7446  2 004235   200003 470500                    LDP0    @FDS,,AUTO
         2 004236   000025 236100                    LDQ     21,,PR0
         2 004237   200117 136100                    SBLQ    BB,,AUTO
         2 004240   000025 756100                    STQ     21,,PR0

     1159     7447    3              V$=PINCRB(ADDR(V),36-BB);

   7447  2 004241   200115 471500                    LDP1    @V,,AUTO
         2 004242   200117 335100                    LCA     BB,,AUTO
         2 004243   004245 605000 2                  TPL     s:7447+4
         2 004244   000044 035003                    ADLA    36,DU
         2 004245   100001 503505                    ABD     1,AL,PR1
         2 004246   200121 451500                    STP1    V$,,AUTO

     1160     7448    3              M$=FDS.CUR$;

   7448  2 004247   000027 236100                    LDQ     23,,PR0
         2 004250   200122 756100                    STQ     M$,,AUTO

     1161     7449    4              DO WHILE BB>0;

   7449  2 004251   200117 235100                    LDA     BB,,AUTO
         2 004252   004313 604400 2                  TMOZ    s:7460

     1162     7450    5                 IF M.B=0 THEN DO;

   7450  2 004253   200122 236100                    LDQ     M$,,AUTO
         2 004254   170000 316007                    CANQ    61440,DL
         2 004255   004264 601000 2                  TNZ     s:7454

     1163     7451    5                    M.B=1;

   7451  2 004256   000046 376000 3                  ANQ     38
         2 004257   010000 276007                    ORQ     4096,DL
         2 004260   200122 756100                    STQ     M$,,AUTO

     1164     7452    5                    FDS.MEMSZ=FDS.MEMSZ-1;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:188  

   7452  2 004261   200003 470500                    LDP0    @FDS,,AUTO
         2 004262   000001 336007                    LCQ     1,DL
         2 004263   000025 056100                    ASQ     21,,PR0

     1165     7453    5                    END;

     1166     7454    4                 CC=MINIMUM (9-M.B, BB);

   7454  2 004264   200122 236100                    LDQ     M$,,AUTO
         2 004265   000014 772000                    QRL     12
         2 004266   000017 376007                    ANQ     15,DL
         2 004267   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 004270   000012 036007                    ADLQ    10,DL
         2 004271   200117 116100                    CMPQ    BB,,AUTO
         2 004272   004274 604400 2                  TMOZ    s:7454+8
         2 004273   200117 236100                    LDQ     BB,,AUTO
         2 004274   200120 756100                    STQ     CC,,AUTO

     1167     7455    4                 V$->VALBASE=M$->VALBASE;

   7455  2 004275   200122 470500                    LDP0    M$,,AUTO
         2 004276   200117 720100                    LXL0    BB,,AUTO
         2 004277   200121 471500                    LDP1    V$,,AUTO
         2 004300   003140 060540                    CSL     bolr='003'O
         2 004301   000000 000010                    BDSC    0,,PR0                   by=0,bit=0,n=*X0
         2 004302   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=*X0

     1168     7456    4                 V$=PINCRB(V$,CC);

   7456  2 004303   100000 503506                    ABD     0,QL,PR1
         2 004304   200121 451500                    STP1    V$,,AUTO

     1169     7457    4                 M$=PINCRB(M$,CC);

   7457  2 004305   000000 503506                    ABD     0,QL,PR0
         2 004306   200122 450500                    STP0    M$,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:189  

     1170     7458    4                 BB = BB-CC;

   7458  2 004307   200117 236100                    LDQ     BB,,AUTO
         2 004310   200120 136100                    SBLQ    CC,,AUTO
         2 004311   200117 756100                    STQ     BB,,AUTO

     1171     7459    4                 END;

   7459  2 004312   004253 605400 2                  TPNZ    s:7450

     1172     7460    3              FDS.CUR$=M$;

   7460  2 004313   200122 236100                    LDQ     M$,,AUTO
         2 004314   200003 470500                    LDP0    @FDS,,AUTO
         2 004315   000027 756100                    STQ     23,,PR0

     1173     7461    3              END;

   7461  2 004316   004370 710000 2                  TRA     s:7473

     1174     7462    3           ELSE DO;

     1175     7463    3              IF M.B = 0 AND MOD(BB,9) = 0

   7463  2 004317   200122 236100                    LDQ     M$,,AUTO
         2 004320   170000 316007                    CANQ    61440,DL
         2 004321   004344 601000 2                  TNZ     s:7469
         2 004322   200117 236100                    LDQ     BB,,AUTO
         2 004323   000011 506007                    DIV     9,DL
         2 004324   000044 733000                    LRS     36
         2 004325   000000 116003                    CMPQ    0,DU
         2 004326   004344 601000 2                  TNZ     s:7469

     1176     7464    4              THEN DO;

     1177     7465    4                 CC = BB / 9;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:190  

   7465  2 004327   200117 236100                    LDQ     BB,,AUTO
         2 004330   000011 506007                    DIV     9,DL
         2 004331   200120 756100                    STQ     CC,,AUTO

     1178     7466    4                 PINCRC (ADDR(V) , 4 - CC) -> VALBASEC = M$ -> VALBASEC;

   7466  2 004332   000000 235003                    LDA     0,DU
         2 004333   200120 135100                    SBLA    CC,,AUTO
         2 004334   200122 470500                    LDP0    M$,,AUTO
         2 004335   000000 620006                    EAX0    0,QL
         2 004336   200115 471500                    LDP1    @V,,AUTO
         2 004337   200120 721100                    LXL1    CC,,AUTO
         2 004340   040145 100540                    MLR     fill='040'O
         2 004341   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 004342   100001 000011                    ADSC9   1,A,PR1                  cn=0,n=*X1

     1179     7467    4                 END;

   7467  2 004343   004356 710000 2                  TRA     s:7470

     1180     7468    3              ELSE
     1181     7469    3                 PINCRB(ADDR(V),36-BB)->VALBASE=FDS.CUR$->VALBASE;

   7469  2 004344   200003 470500                    LDP0    @FDS,,AUTO
         2 004345   000027 471500                    LDP1    23,,PR0
         2 004346   200117 335100                    LCA     BB,,AUTO
         2 004347   004351 605000 2                  TPL     s:7469+5
         2 004350   000044 035003                    ADLA    36,DU
         2 004351   200117 720100                    LXL0    BB,,AUTO
         2 004352   200115 473500                    LDP3    @V,,AUTO
         2 004353   003145 060540                    CSL     bolr='003'O
         2 004354   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=*X0
         2 004355   300001 000010                    BDSC    1,A,PR3                  by=0,bit=0,n=*X0

     1182     7470    3              FDS.CUR$=PINCRB(FDS.CUR$,BB);

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:191  
   7470  2 004356   200003 470500                    LDP0    @FDS,,AUTO
         2 004357   000027 471500                    LDP1    23,,PR0
         2 004360   200117 235100                    LDA     BB,,AUTO
         2 004361   004363 605000 2                  TPL     s:7470+5
         2 004362   000044 035003                    ADLA    36,DU
         2 004363   100000 503505                    ABD     0,AL,PR1
         2 004364   000027 451500                    STP1    23,,PR0

     1183     7471    3              FDS.MEMSZ=FDS.MEMSZ-BB;

   7471  2 004365   000025 236100                    LDQ     21,,PR0
         2 004366   200117 136100                    SBLQ    BB,,AUTO
         2 004367   000025 756100                    STQ     21,,PR0

     1184     7472    3              END;

     1185     7473    2           IF FDS.MEMSZ<=0 THEN CALL SETMEM(FDS.MEMX+1,0);

   7473  2 004370   000025 235100                    LDA     21,,PR0
         2 004371   004403 605400 2                  TPNZ    s:7474

   7473  2 004372   000026 235100                    LDA     22,,PR0
         2 004373   000001 035007                    ADLA    1,DL
         2 004374   200160 755100                    STA     TABLEVAL+20,,AUTO
         2 004375   000000 236000 3                  LDQ     0
         2 004376   200126 756100                    STQ     @B,,AUTO
         2 004377   200160 631500                    EPPR1   TABLEVAL+20,,AUTO
         2 004400   200125 451500                    STP1    @X,,AUTO
         2 004401   003355 701000 2                  TSX1    SETMEM
         2 004402   000000 011000                    NOP     0

     1186     7474    2           RETURN;

   7474  2 004403   200114 221300                    LDX1  ! @B,,AUTO
         2 004404   000001 702211                    TSX2  ! 1,X1

     1187     7475    2   END GETVAL;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:192  
     1188     7476        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:193  
     1189     7477    1   SKIPBITS: PROC(B);

   7477  2 004405   200112 741300       SKIPBITS     STX1  ! TRANS$+2,,AUTO

     1190     7478    2   DCL B SBIN;
     1191     7479        /**/
     1192     7480    2           IF B>FDS.MEMSZ THEN

   7480  2 004406   200113 470500                    LDP0    @B,,AUTO
         2 004407   200003 471500                    LDP1    @FDS,,AUTO
         2 004410   000000 236100                    LDQ     0,,PR0
         2 004411   100025 116100                    CMPQ    21,,PR1
         2 004412   004425 604400 2                  TMOZ    s:7483

     1193     7481    2              CALL SETMEM(FDS.MEMX+1,0);

   7481  2 004413   100026 235100                    LDA     22,,PR1
         2 004414   000001 035007                    ADLA    1,DL
         2 004415   200161 755100                    STA     TABLEVAL+21,,AUTO
         2 004416   000000 236000 3                  LDQ     0
         2 004417   200126 756100                    STQ     @B,,AUTO
         2 004420   200161 633500                    EPPR3   TABLEVAL+21,,AUTO
         2 004421   200125 453500                    STP3    @X,,AUTO
         2 004422   003355 701000 2                  TSX1    SETMEM
         2 004423   000000 011000                    NOP     0
         2 004424   004436 710000 2                  TRA     s:7486

     1194     7482    3           ELSE DO;

     1195     7483    3              FDS.CUR$=PINCRB(FDS.CUR$,B);

   7483  2 004425   100027 473500                    LDP3    23,,PR1
         2 004426   000000 116003                    CMPQ    0,DU
         2 004427   004431 605000 2                  TPL     s:7483+4
         2 004430   000044 036003                    ADLQ    36,DU
         2 004431   300000 503506                    ABD     0,QL,PR3
         2 004432   100027 453500                    STP3    23,,PR1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:194  

     1196     7484    3              FDS.MEMSZ=FDS.MEMSZ-B;

   7484  2 004433   100025 236100                    LDQ     21,,PR1
         2 004434   000000 136100                    SBLQ    0,,PR0
         2 004435   100025 756100                    STQ     21,,PR1

     1197     7485    3              END;

     1198     7486    2           RETURN;

   7486  2 004436   200112 221300                    LDX1  ! TRANS$+2,,AUTO
         2 004437   000001 702211                    TSX2  ! 1,X1

     1199     7487    2   END SKIPBITS;
     1200     7488        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:195  
     1201     7489    1   FIELD:  PROC(STRING,SIZ,FLD);

   7489  2 004440   200124 741300       FIELD        STX1  ! M$+2,,AUTO

     1202     7490    2   DCL STRING CHAR(1);
     1203     7491    2   DCL SIZ SBIN;
     1204     7492    2   DCL FLD SBIN;
     1205     7493    2   DCL STR$ PTR;
     1206     7494    2   DCL STR CHAR(STRSIZ) BASED(STR$);
     1207     7495    2   DCL STRSIZ SBIN;
     1208     7496    2   DCL FWIDTH SBIN;
     1209     7497    2   DCL IDX SBIN;
     1210     7498    2   DCL TABLEVAL SBIN;
     1211     7499    2           IF FDS.BLNKBUF THEN CALL BLANKBUF;

   7499  2 004441   200003 470500                    LDP0    @FDS,,AUTO
         2 004442   000013 236100                    LDQ     11,,PR0
         2 004443   000100 316007                    CANQ    64,DL
         2 004444   004447 600000 2                  TZE     s:7500

   7499  2 004445   003662 701000 2                  TSX1    BLANKBUF
         2 004446   000000 011000                    NOP     0

     1212     7500    2           STR$=ADDR(STRING);

   7500  2 004447   200125 236100                    LDQ     @STRING,,AUTO
         2 004450   200130 756100                    STQ     STR$,,AUTO

     1213     7501    2           STRSIZ=SIZ;

   7501  2 004451   200126 470500                    LDP0    @SIZ,,AUTO
         2 004452   000000 235100                    LDA     0,,PR0
         2 004453   200131 755100                    STA     STRSIZ,,AUTO

     1214     7502    3           IF FLAGS.DLB THEN DO;

   7502  2 004454   200011 236100                    LDQ     FLAGS,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:196  
         2 004455   010000 316003                    CANQ    4096,DU
         2 004456   004502 600000 2                  TZE     s:7507

     1215     7503    3              CALL SEARCH(IDX,TABLEVAL,SEARCHNB,STR) ALTRET(ALL_BLANKS);

   7503  2 004457   000000 471400 xsym               LDP1    B$SR_NON_BLANK$
         2 004460   200130 473500                    LDP3    STR$,,AUTO
         2 004461   000000 620005                    EAX0    0,AL
         2 004462   000000 164540                    TCT
         2 004463   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 004464   100000 000100                    ARG     0,,PR1
         2 004465   200133 000100                    ARG     IDX,,AUTO
         2 004466   200133 235100                    LDA     IDX,,AUTO
         2 004467   000033 771000                    ARL     27
         2 004470   200134 755100                    STA     TABLEVAL,,AUTO
         2 004471   200133 551140                    STBA    IDX,'40'O,AUTO
         2 004472   004530 606400 2                  TTN     ALL_BLANKS

     1216     7504    3              STR$=PINCRC(STR$,IDX);

   7504  2 004473   200133 236100                    LDQ     IDX,,AUTO
         2 004474   000020 736000                    QLS     16
         2 004475   200130 036100                    ADLQ    STR$,,AUTO
         2 004476   200130 756100                    STQ     STR$,,AUTO

     1217     7505    3              STRSIZ=STRSIZ-IDX;

   7505  2 004477   200131 236100                    LDQ     STRSIZ,,AUTO
         2 004500   200133 136100                    SBLQ    IDX,,AUTO
         2 004501   200131 756100                    STQ     STRSIZ,,AUTO

     1218     7506    3              END;

     1219     7507    3           IF FLAGS.DTB THEN DO;

   7507  2 004502   200011 236100                    LDQ     FLAGS,,AUTO
         2 004503   020000 316003                    CANQ    8192,DU
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:197  
         2 004504   004531 600000 2                  TZE     s:7514

     1220     7508    3              CALL SEARCHR(IDX,TABLEVAL,SEARCHNB,STR) ALTRET(ALL_BLANKS);

   7508  2 004505   200131 236100                    LDQ     STRSIZ,,AUTO
         2 004506   000000 471400 xsym               LDP1    B$SR_NON_BLANK$
         2 004507   200130 473500                    LDP3    STR$,,AUTO
         2 004510   000000 620006                    EAX0    0,QL
         2 004511   000000 165540                    TCTR
         2 004512   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 004513   100000 000100                    ARG     0,,PR1
         2 004514   200133 000100                    ARG     IDX,,AUTO
         2 004515   200133 235100                    LDA     IDX,,AUTO
         2 004516   000033 771000                    ARL     27
         2 004517   200134 755100                    STA     TABLEVAL,,AUTO
         2 004520   200133 551140                    STBA    IDX,'40'O,AUTO
         2 004521   004530 606400 2                  TTN     ALL_BLANKS
         2 004522   200133 054100                    AOS     IDX,,AUTO
         2 004523   200133 156100                    SSQ     IDX,,AUTO

     1221     7509    3              STRSIZ=IDX+1;

   7509  2 004524   200133 235100                    LDA     IDX,,AUTO
         2 004525   000001 035007                    ADLA    1,DL
         2 004526   200131 755100                    STA     STRSIZ,,AUTO

     1222     7510    4              DO NEVER;

   7510  2 004527   004531 710000 2                  TRA     s:7514

     1223     7511    4   ALL_BLANKS:   STRSIZ=0;

   7511  2 004530   200131 450100       ALL_BLANKS   STZ     STRSIZ,,AUTO

     1224     7512    4                 END;

     1225     7513    3              END;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:198  

     1226     7514    2           IF FLD=0 THEN FWIDTH=STRSIZ;

   7514  2 004531   200127 470500                    LDP0    @FLD,,AUTO
         2 004532   000000 235100                    LDA     0,,PR0
         2 004533   004537 601000 2                  TNZ     s:7515

   7514  2 004534   200131 236100                    LDQ     STRSIZ,,AUTO
         2 004535   200132 756100                    STQ     FWIDTH,,AUTO
         2 004536   004540 710000 2                  TRA     s:7516

     1227     7515    2           ELSE FWIDTH=FLD;

   7515  2 004537   200132 755100                    STA     FWIDTH,,AUTO

     1228     7516    2           FDS.FWID=FWIDTH;

   7516  2 004540   200003 471500                    LDP1    @FDS,,AUTO
         2 004541   200132 236100                    LDQ     FWIDTH,,AUTO
         2 004542   100024 756100                    STQ     20,,PR1

     1229     7517    3           IF NOT FDS.TRUNC# THEN DO;

   7517  2 004543   100013 236100                    LDQ     11,,PR1
         2 004544   000400 316007                    CANQ    256,DL
         2 004545   004715 601000 2                  TNZ     s:7543

     1230     7518    3              IF FLAGS.FIELD AND FWIDTH>FDS.BUFSIZE-FDS.BUFX AND

   7518  2 004546   200011 236100                    LDQ     FLAGS,,AUTO
         2 004547   002000 316003                    CANQ    1024,DU
         2 004550   004567 600000 2                  TZE     s:7521
         2 004551   100010 236100                    LDQ     8,,PR1
         2 004552   100007 136100                    SBLQ    7,,PR1
         2 004553   200132 116100                    CMPQ    FWIDTH,,AUTO
         2 004554   004567 605000 2                  TPL     s:7521
         2 004555   100007 236100                    LDQ     7,,PR1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:199  
         2 004556   100016 116100                    CMPQ    14,,PR1
         2 004557   004565 605400 2                  TPNZ    s:7520
         2 004560   000001 116007                    CMPQ    1,DL
         2 004561   004567 604400 2                  TMOZ    s:7521
         2 004562   100013 236100                    LDQ     11,,PR1
         2 004563   000020 316007                    CANQ    16,DL
         2 004564   004567 601000 2                  TNZ     s:7521

     1231     7519    3                (FDS.BUFX>FDS.WRAPTAB# OR FDS.BUFX>1 AND NOT FDS.WRAP)
     1232     7520    3              THEN CALL BUF_WRAP;

   7520  2 004565   003642 701000 2                  TSX1    BUF_WRAP
         2 004566   000000 011000                    NOP     0

     1233     7521    4              IF NOT FLAGS.LJ THEN DO WHILE(FDS.FWID>STRSIZ);

   7521  2 004567   200011 236100                    LDQ     FLAGS,,AUTO
         2 004570   200000 316003                    CANQ    65536,DU
         2 004571   004641 601000 2                  TNZ     s:7529

   7521  2 004572   200003 470500                    LDP0    @FDS,,AUTO
         2 004573   000024 236100                    LDQ     20,,PR0
         2 004574   200131 116100                    CMPQ    STRSIZ,,AUTO
         2 004575   004641 604400 2                  TMOZ    s:7529

     1234     7522    4                 IF FDS.FWID-STRSIZ>FDS.BUFSIZE-FDS.BUFX THEN X=FDS.BUFSIZE-FDS.BUFX;

   7522  2 004576   200003 470500                    LDP0    @FDS,,AUTO
         2 004577   000024 236100                    LDQ     20,,PR0
         2 004600   200131 136100                    SBLQ    STRSIZ,,AUTO
         2 004601   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 004602   000010 236100                    LDQ     8,,PR0
         2 004603   000007 136100                    SBLQ    7,,PR0
         2 004604   200142 116100                    CMPQ    TABLEVAL+6,,AUTO
         2 004605   004612 605000 2                  TPL     s:7523

   7522  2 004606   000010 236100                    LDQ     8,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:200  
         2 004607   000007 136100                    SBLQ    7,,PR0
         2 004610   200063 756100                    STQ     X,,AUTO
         2 004611   004615 710000 2                  TRA     s:7524

     1235     7523    4                 ELSE X=FDS.FWID-STRSIZ;

   7523  2 004612   000024 236100                    LDQ     20,,PR0
         2 004613   200131 136100                    SBLQ    STRSIZ,,AUTO
         2 004614   200063 756100                    STQ     X,,AUTO

     1236     7524    4                 CALL INSERT(BUFFER,FDS.BUFX,X,' ');

   7524  2 004615   000006 471500                    LDP1    6,,PR0
         2 004616   000010 720100                    LXL0    8,,PR0
         2 004617   000007 235100                    LDA     7,,PR0
         2 004620   000000 621006                    EAX1    0,QL
         2 004621   040145 100400                    MLR     fill='040'O
         2 004622   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004623   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1

     1237     7525    4                 FDS.BUFX=FDS.BUFX+X;

   7525  2 004624   000007 236100                    LDQ     7,,PR0
         2 004625   200063 036100                    ADLQ    X,,AUTO
         2 004626   000007 756100                    STQ     7,,PR0

     1238     7526    4                 IF FDS.BUFX>=FDS.BUFSIZE THEN CALL BUF_WRAP;

   7526  2 004627   000010 116100                    CMPQ    8,,PR0
         2 004630   004633 604000 2                  TMI     s:7527

   7526  2 004631   003642 701000 2                  TSX1    BUF_WRAP
         2 004632   000000 011000                    NOP     0

     1239     7527    4                 FDS.FWID=FDS.FWID-X;

   7527  2 004633   200003 470500                    LDP0    @FDS,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:201  
         2 004634   000024 236100                    LDQ     20,,PR0
         2 004635   200063 136100                    SBLQ    X,,AUTO
         2 004636   000024 756100                    STQ     20,,PR0

     1240     7528    4                 END;

   7528  2 004637   200131 116100                    CMPQ    STRSIZ,,AUTO
         2 004640   004576 605400 2                  TPNZ    s:7522

     1241     7529    4              DO WHILE(FDS.BUFX+FDS.FWID>FDS.BUFSIZE);

   7529  2 004641   004710 710000 2                  TRA     s:7541

     1242     7530    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX),TRANS,STR);

   7530  2 004642   200003 470500                    LDP0    @FDS,,AUTO
         2 004643   000006 471500                    LDP1    6,,PR0
         2 004644   000010 720100                    LXL0    8,,PR0
         2 004645   000000 636010                    EAQ     0,X0
         2 004646   000022 732000                    QRS     18
         2 004647   000007 136100                    SBLQ    7,,PR0
         2 004650   000007 235100                    LDA     7,,PR0
         2 004651   200130 473500                    LDP3    STR$,,AUTO
         2 004652   200131 721100                    LXL1    STRSIZ,,AUTO
         2 004653   200110 474500                    LDP4    TRANS$,,AUTO
         2 004654   000000 622006                    EAX2    0,QL
         2 004655   040145 160540                    MVT     fill='040'O
         2 004656   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         2 004657   100000 000012                    ADSC9   0,A,PR1                  cn=0,n=*X2
         2 004660   400000 000100                    ARG     0,,PR4

     1243     7531    4                 X=FDS.BUFSIZE-FDS.BUFX;

   7531  2 004661   000010 236100                    LDQ     8,,PR0
         2 004662   000007 136100                    SBLQ    7,,PR0
         2 004663   200063 756100                    STQ     X,,AUTO

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:202  
     1244     7532    4                 FDS.FWID=FDS.FWID-X;

   7532  2 004664   000024 236100                    LDQ     20,,PR0
         2 004665   200063 136100                    SBLQ    X,,AUTO
         2 004666   000024 756100                    STQ     20,,PR0

     1245     7533    4                 STRSIZ=STRSIZ-X;

   7533  2 004667   200131 236100                    LDQ     STRSIZ,,AUTO
         2 004670   200063 136100                    SBLQ    X,,AUTO
         2 004671   200131 756100                    STQ     STRSIZ,,AUTO

     1246     7534    4                 IF STRSIZ>0 THEN STR$=PINCRC(STR$,X);

   7534  2 004672   004700 604400 2                  TMOZ    s:7536

   7534  2 004673   200063 236100                    LDQ     X,,AUTO
         2 004674   000020 736000                    QLS     16
         2 004675   200130 036100                    ADLQ    STR$,,AUTO
         2 004676   200130 756100                    STQ     STR$,,AUTO
         2 004677   004704 710000 2                  TRA     s:7539

     1247     7535    5                 ELSE DO;

     1248     7536    5                    STR$=ADDR(BLANKS);

   7536  2 004700   000050 236000 3                  LDQ     40
         2 004701   200130 756100                    STQ     STR$,,AUTO

     1249     7537    5                    STRSIZ=1;

   7537  2 004702   000001 235007                    LDA     1,DL
         2 004703   200131 755100                    STA     STRSIZ,,AUTO

     1250     7538    5                    END;

     1251     7539    4                 FDS.BUFX=FDS.BUFSIZE;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:203  

   7539  2 004704   000010 235100                    LDA     8,,PR0
         2 004705   000007 755100                    STA     7,,PR0

     1252     7540    4                 CALL BUF_WRAP;

   7540  2 004706   003642 701000 2                  TSX1    BUF_WRAP
         2 004707   000000 011000                    NOP     0

     1253     7541    4                 END;

   7541  2 004710   200003 470500                    LDP0    @FDS,,AUTO
         2 004711   000007 236100                    LDQ     7,,PR0
         2 004712   000024 036100                    ADLQ    20,,PR0
         2 004713   000010 116100                    CMPQ    8,,PR0
         2 004714   004642 605400 2                  TPNZ    s:7530

     1254     7542    3              END;

     1255     7543    3           IF FDS.FWID<STRSIZ THEN DO;

   7543  2 004715   200003 470500                    LDP0    @FDS,,AUTO
         2 004716   000024 236100                    LDQ     20,,PR0
         2 004717   200131 116100                    CMPQ    STRSIZ,,AUTO
         2 004720   005012 605000 2                  TPL     s:7558

     1256     7544    4              IF FLAGS.MSD THEN DO;

   7544  2 004721   200011 236100                    LDQ     FLAGS,,AUTO
         2 004722   040000 316003                    CANQ    16384,DU
         2 004723   004747 600000 2                  TZE     s:7549

     1257     7545    4                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN FDS.FWID=FDS.BUFSIZE-FDS.BUFX;

   7545  2 004724   000007 236100                    LDQ     7,,PR0
         2 004725   000024 036100                    ADLQ    20,,PR0
         2 004726   000010 116100                    CMPQ    8,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:204  
         2 004727   004733 604400 2                  TMOZ    s:7546

   7545  2 004730   000010 236100                    LDQ     8,,PR0
         2 004731   000007 136100                    SBLQ    7,,PR0
         2 004732   000024 756100                    STQ     20,,PR0

     1258     7546    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX,FDS.FWID),TRANS,STR);

   7546  2 004733   000006 471500                    LDP1    6,,PR0
         2 004734   000010 720100                    LXL0    8,,PR0
         2 004735   000007 235100                    LDA     7,,PR0
         2 004736   000024 721100                    LXL1    20,,PR0
         2 004737   200130 473500                    LDP3    STR$,,AUTO
         2 004740   200131 722100                    LXL2    STRSIZ,,AUTO
         2 004741   200110 474500                    LDP4    TRANS$,,AUTO
         2 004742   040145 160540                    MVT     fill='040'O
         2 004743   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
         2 004744   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
         2 004745   400000 000100                    ARG     0,,PR4

     1259     7547    4                 END;

   7547  2 004746   005074 710000 2                  TRA     s:7571

     1260     7548    4              ELSE DO;

     1261     7549    5                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN DO;

   7549  2 004747   000007 236100                    LDQ     7,,PR0
         2 004750   000024 036100                    ADLQ    20,,PR0
         2 004751   000010 116100                    CMPQ    8,,PR0
         2 004752   004767 604400 2                  TMOZ    s:7554

     1262     7550    5                    STRSIZ=STRSIZ-(FDS.BUFX+FDS.FWID-FDS.BUFSIZE);

   7550  2 004753   000007 236100                    LDQ     7,,PR0
         2 004754   000024 036100                    ADLQ    20,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:205  
         2 004755   000010 136100                    SBLQ    8,,PR0
         2 004756   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 004757   200131 236100                    LDQ     STRSIZ,,AUTO
         2 004760   200142 136100                    SBLQ    TABLEVAL+6,,AUTO
         2 004761   200131 756100                    STQ     STRSIZ,,AUTO

     1263     7551    5                    IF STRSIZ<0 THEN STRSIZ=0;

   7551  2 004762   004764 605000 2                  TPL     s:7552

   7551  2 004763   200131 450100                    STZ     STRSIZ,,AUTO

     1264     7552    5                    FDS.FWID=FDS.BUFSIZE-FDS.BUFX;

   7552  2 004764   000010 236100                    LDQ     8,,PR0
         2 004765   000007 136100                    SBLQ    7,,PR0
         2 004766   000024 756100                    STQ     20,,PR0

     1265     7553    5                    END;

     1266     7554    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX,FDS.FWID),TRANS,SUBSTR(STR,STRSIZ-
              7554                          FDS.FWID));

   7554  2 004767   000006 471500                    LDP1    6,,PR0
         2 004770   000010 720100                    LXL0    8,,PR0
         2 004771   000007 235100                    LDA     7,,PR0
         2 004772   000024 721100                    LXL1    20,,PR0
         2 004773   200131 236100                    LDQ     STRSIZ,,AUTO
         2 004774   000024 136100                    SBLQ    20,,PR0
         2 004775   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 004776   200143 756100                    STQ     TABLEVAL+7,,AUTO
         2 004777   200131 236100                    LDQ     STRSIZ,,AUTO
         2 005000   200142 136100                    SBLQ    TABLEVAL+6,,AUTO
         2 005001   200130 473500                    LDP3    STR$,,AUTO
         2 005002   000000 620006                    EAX0    0,QL
         2 005003   200143 236100                    LDQ     TABLEVAL+7,,AUTO
         2 005004   200110 474500                    LDP4    TRANS$,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:206  
         2 005005   040145 160546                    MVT     fill='040'O
         2 005006   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=*X0
         2 005007   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
         2 005010   400000 000100                    ARG     0,,PR4

     1267     7555    4                 END;

     1268     7556    3              END;

   7556  2 005011   005074 710000 2                  TRA     s:7571

     1269     7557    3           ELSE DO;

     1270     7558    4              IF FLAGS.LJ THEN DO;

   7558  2 005012   200011 236100                    LDQ     FLAGS,,AUTO
         2 005013   200000 316003                    CANQ    65536,DU
         2 005014   005040 600000 2                  TZE     s:7563

     1271     7559    4                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN FDS.FWID=FDS.BUFSIZE-FDS.BUFX;

   7559  2 005015   000007 236100                    LDQ     7,,PR0
         2 005016   000024 036100                    ADLQ    20,,PR0
         2 005017   000010 116100                    CMPQ    8,,PR0
         2 005020   005024 604400 2                  TMOZ    s:7560

   7559  2 005021   000010 236100                    LDQ     8,,PR0
         2 005022   000007 136100                    SBLQ    7,,PR0
         2 005023   000024 756100                    STQ     20,,PR0

     1272     7560    4                 CALL XLATE (SUBSTR(BUFFER,FDS.BUFX,FDS.FWID),TRANS,STR);

   7560  2 005024   000006 471500                    LDP1    6,,PR0
         2 005025   000010 720100                    LXL0    8,,PR0
         2 005026   000007 235100                    LDA     7,,PR0
         2 005027   000024 721100                    LXL1    20,,PR0
         2 005030   200130 473500                    LDP3    STR$,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:207  
         2 005031   200131 722100                    LXL2    STRSIZ,,AUTO
         2 005032   200110 474500                    LDP4    TRANS$,,AUTO
         2 005033   040145 160540                    MVT     fill='040'O
         2 005034   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
         2 005035   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
         2 005036   400000 000100                    ARG     0,,PR4

     1273     7561    4                 END;

   7561  2 005037   005074 710000 2                  TRA     s:7571

     1274     7562    4              ELSE DO;

     1275     7563    5                 IF FDS.BUFX+FDS.FWID>FDS.BUFSIZE THEN DO;

   7563  2 005040   000007 236100                    LDQ     7,,PR0
         2 005041   000024 036100                    ADLQ    20,,PR0
         2 005042   000010 116100                    CMPQ    8,,PR0
         2 005043   005060 604400 2                  TMOZ    s:7568

     1276     7564    5                    STRSIZ=STRSIZ-(FDS.BUFX+FDS.FWID-FDS.BUFSIZE);

   7564  2 005044   000007 236100                    LDQ     7,,PR0
         2 005045   000024 036100                    ADLQ    20,,PR0
         2 005046   000010 136100                    SBLQ    8,,PR0
         2 005047   200142 756100                    STQ     TABLEVAL+6,,AUTO
         2 005050   200131 236100                    LDQ     STRSIZ,,AUTO
         2 005051   200142 136100                    SBLQ    TABLEVAL+6,,AUTO
         2 005052   200131 756100                    STQ     STRSIZ,,AUTO

     1277     7565    5                    IF STRSIZ<0 THEN STRSIZ=0;

   7565  2 005053   005055 605000 2                  TPL     s:7566

   7565  2 005054   200131 450100                    STZ     STRSIZ,,AUTO

     1278     7566    5                    FDS.FWID=FDS.BUFSIZE-FDS.BUFX;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:208  

   7566  2 005055   000010 236100                    LDQ     8,,PR0
         2 005056   000007 136100                    SBLQ    7,,PR0
         2 005057   000024 756100                    STQ     20,,PR0

     1279     7567    5                    END;

     1280     7568    4                CALL XLATE (SUBSTR(BUFFER,FDS.BUFX+FDS.FWID-STRSIZ,STRSIZ),TRANS,STR);

   7568  2 005060   000006 471500                    LDP1    6,,PR0
         2 005061   000010 720100                    LXL0    8,,PR0
         2 005062   000007 236100                    LDQ     7,,PR0
         2 005063   000024 036100                    ADLQ    20,,PR0
         2 005064   200131 136100                    SBLQ    STRSIZ,,AUTO
         2 005065   200130 473500                    LDP3    STR$,,AUTO
         2 005066   200131 721100                    LXL1    STRSIZ,,AUTO
         2 005067   200110 474500                    LDP4    TRANS$,,AUTO
         2 005070   040146 160540                    MVT     fill='040'O
         2 005071   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         2 005072   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
         2 005073   400000 000100                    ARG     0,,PR4

     1281     7569    4                 END;

     1282     7570    3              END;

     1283     7571    2           FDS.BUFX=FDS.BUFX+FDS.FWID;

   7571  2 005074   000007 236100                    LDQ     7,,PR0
         2 005075   000024 036100                    ADLQ    20,,PR0
         2 005076   000007 756100                    STQ     7,,PR0

     1284     7572    2           FDS.FWID=FWIDTH;

   7572  2 005077   200132 235100                    LDA     FWIDTH,,AUTO
         2 005100   000024 755100                    STA     20,,PR0

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:209  
     1285     7573    3           IF FDS.DEBUG AND PERCENT<FMTX THEN DO;

   7573  2 005101   000013 236100                    LDQ     11,,PR0
         2 005102   000200 316007                    CANQ    128,DL
         2 005103   005232 600000 2                  TZE     s:7597
         2 005104   200022 236100                    LDQ     PERCENT,,AUTO
         2 005105   200004 116100                    CMPQ    FMTX,,AUTO
         2 005106   005232 605000 2                  TPL     s:7597

     1286     7574    3              IF FWIDTH>=FDS.BUFX THEN FWIDTH=1;

   7574  2 005107   200132 236100                    LDQ     FWIDTH,,AUTO
         2 005110   000007 116100                    CMPQ    7,,PR0
         2 005111   005115 604000 2                  TMI     s:7575

   7574  2 005112   000001 235007                    LDA     1,DL
         2 005113   200132 755100                    STA     FWIDTH,,AUTO
         2 005114   005120 710000 2                  TRA     s:7576

     1287     7575    3              ELSE FWIDTH=FDS.BUFX-FWIDTH;

   7575  2 005115   000007 236100                    LDQ     7,,PR0
         2 005116   200132 136100                    SBLQ    FWIDTH,,AUTO
         2 005117   200132 756100                    STQ     FWIDTH,,AUTO

     1288     7576    3              STRSIZ=FMTX-PERCENT+1;

   7576  2 005120   200004 236100                    LDQ     FMTX,,AUTO
         2 005121   200022 136100                    SBLQ    PERCENT,,AUTO
         2 005122   000001 036007                    ADLQ    1,DL
         2 005123   200131 756100                    STQ     STRSIZ,,AUTO

     1289     7577    3              SUBSTR(DBUF,0,FDS.BUFX)=BUFFER;

   7577  2 005124   000007 720100                    LXL0    7,,PR0
         2 005125   000006 471500                    LDP1    6,,PR0
         2 005126   000010 721100                    LXL1    8,,PR0
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:210  
         2 005127   040140 100540                    MLR     fill='040'O
         2 005130   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         2 005131   200025 000010                    ADSC9   DBUF,,AUTO               cn=0,n=*X0

     1290     7578    3              SUBSTR(DBUF,0,FWIDTH)=BITASC('037'O);

   7578  2 005132   200132 720100                    LXL0    FWIDTH,,AUTO
         2 005133   040140 100400                    MLR     fill='040'O
         2 005134   000034 000001 3                  ADSC9   28                       cn=0,n=1
         2 005135   200025 000010                    ADSC9   DBUF,,AUTO               cn=0,n=*X0

     1291     7579    4              IF STRSIZ+13<FWIDTH THEN DO;

   7579  2 005136   000015 036007                    ADLQ    13,DL
         2 005137   200132 116100                    CMPQ    FWIDTH,,AUTO
         2 005140   005154 605000 2                  TPL     s:7584

     1292     7580    4                 IDX=FWIDTH-13-STRSIZ;

   7580  2 005141   200132 236100                    LDQ     FWIDTH,,AUTO
         2 005142   200131 136100                    SBLQ    STRSIZ,,AUTO
         2 005143   000015 136007                    SBLQ    13,DL
         2 005144   200133 756100                    STQ     IDX,,AUTO

     1293     7581    4                 FWIDTH=FDS.BUFX;

   7581  2 005145   000007 235100                    LDA     7,,PR0
         2 005146   200132 755100                    STA     FWIDTH,,AUTO

     1294     7582    4                 SUBSTR(DBUF,IDX+STRSIZ,13)=' <-FMT BUF-> ';

   7582  2 005147   200131 036100                    ADLQ    STRSIZ,,AUTO
         2 005150   040106 100400                    MLR     fill='040'O
         2 005151   000402 000015 0                  ADSC9   STR_DUMP+191             cn=0,n=13
         2 005152   200025 000015                    ADSC9   DBUF,Q,AUTO              cn=0,n=13

     1295     7583    4                 END; ELSE DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:211  

   7583  2 005153   005166 710000 2                  TRA     s:7588

     1296     7584    4                 IDX=FDS.BUFX+13;

   7584  2 005154   000007 235100                    LDA     7,,PR0
         2 005155   000015 035007                    ADLA    13,DL
         2 005156   200133 755100                    STA     IDX,,AUTO

     1297     7585    4                 FWIDTH=IDX+STRSIZ;

   7585  2 005157   200133 236100                    LDQ     IDX,,AUTO
         2 005160   200131 036100                    ADLQ    STRSIZ,,AUTO
         2 005161   200132 756100                    STQ     FWIDTH,,AUTO

     1298     7586    4                 SUBSTR(DBUF,FDS.BUFX,13)=' <-BUF FMT-> ';

   7586  2 005162   000007 235100                    LDA     7,,PR0
         2 005163   040105 100400                    MLR     fill='040'O
         2 005164   000406 000015 0                  ADSC9   STR_DUMP+195             cn=0,n=13
         2 005165   200025 000015                    ADSC9   DBUF,A,AUTO              cn=0,n=13

     1299     7587    4                 END;

     1300     7588    3              SUBSTR(DBUF,IDX,STRSIZ)=SUBSTR(FMT,PERCENT,STRSIZ);

   7588  2 005166   000001 471500                    LDP1    1,,PR0
         2 005167   000004 720100                    LXL0    4,,PR0
         2 005170   200131 721100                    LXL1    STRSIZ,,AUTO
         2 005171   200022 235100                    LDA     PERCENT,,AUTO
         2 005172   200133 236100                    LDQ     IDX,,AUTO
         2 005173   040146 100545                    MLR     fill='040'O
         2 005174   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
         2 005175   200025 000011                    ADSC9   DBUF,Q,AUTO              cn=0,n=*X1

   7588  2 005176                       DBG_OUT      null
     1301     7589    3   DBG_OUT:   ;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:212  
     1302     7590    3              IDX=FPT$WRITE.BUF_.BOUND;

   7590  2 005176   200003 470500                    LDP0    @FDS,,AUTO
         2 005177   000031 471500                    LDP1    25,,PR0
         2 005200   100004 236100                    LDQ     4,,PR1
         2 005201   000020 772000                    QRL     16
         2 005202   200133 756100                    STQ     IDX,,AUTO

     1303     7591    3              FPT$WRITE.BUF_.BUF$=ADDR(DBUF);

   7591  2 005203   200025 633500                    EPPR3   DBUF,,AUTO
         2 005204   100005 453500                    STP3    5,,PR1

     1304     7592    3              FPT$WRITE.BUF_.BOUND=FWIDTH-1;

   7592  2 005205   000031 471500                    LDP1    25,,PR0
         2 005206   200132 236100                    LDQ     FWIDTH,,AUTO
         2 005207   000001 136007                    SBLQ    1,DL
         2 005210   000020 736000                    QLS     16
         2 005211   100004 676100                    ERQ     4,,PR1
         2 005212   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 005213   100004 656100                    ERSQ    4,,PR1

     1305     7593    3              FPT$WRITE.V.DCB#=FDS.DCB#;

   7593  2 005214   000031 471500                    LDP1    25,,PR0
         2 005215   000013 220100                    LDX0    11,,PR0
         2 005216   100010 740100                    STX0    8,,PR1

     1306     7594    3              CALL M$WRITE(FPT$WRITE);

   7594  2 005217   000031 471500                    LDP1    25,,PR0
         2 005220   100000 630500                    EPPR0   0,,PR1
         2 005221   040001 713400                    CLIMB   write
         2 005222   401400 401760                    pmme    nvectors=4

     1307     7595    3              FPT$WRITE.BUF_.BOUND=IDX;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:213  

   7595  2 005223   200003 470500                    LDP0    @FDS,,AUTO
         2 005224   000031 471500                    LDP1    25,,PR0
         2 005225   200133 236100                    LDQ     IDX,,AUTO
         2 005226   000020 736000                    QLS     16
         2 005227   100004 676100                    ERQ     4,,PR1
         2 005230   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 005231   100004 656100                    ERSQ    4,,PR1

     1308     7596    3              END;

     1309     7597    2           RETURN;

   7597  2 005232   200124 221300                    LDX1  ! M$+2,,AUTO
         2 005233   000001 702211                    TSX2  ! 1,X1

     1310     7598    2   DEBUG_OUT: ENTRY;

   7598  2 005234   200124 741300       DEBUG_OUT    STX1  ! M$+2,,AUTO

     1311     7599    2           IDX=1;

   7599  2 005235   000001 235007                    LDA     1,DL
         2 005236   200133 755100                    STA     IDX,,AUTO

     1312     7600    3           DO UNTIL SUBSTR(DBUF,IDX,3)=' ';

     1313     7601    3              IF SUBSTR(DBUF,IDX,2)='+0' OR SUBSTR(DBUF,IDX,1)='0'

   7601  2 005237   200133 235100                    LDA     IDX,,AUTO
         2 005240   040000 106505                    CMPC    fill='040'O
         2 005241   200025 000002                    ADSC9   DBUF,A,AUTO              cn=0,n=2
         2 005242   000412 000002 0                  ADSC9   STR_DUMP+199             cn=0,n=2
         2 005243   005270 600000 2                  TZE     s:7604
         2 005244   040000 106505                    CMPC    fill='040'O
         2 005245   200025 000001                    ADSC9   DBUF,A,AUTO              cn=0,n=1
         2 005246   000051 000001 3                  ADSC9   41                       cn=0,n=1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:214  
         2 005247   005274 601000 2                  TNZ     s:7605
         2 005250   040000 106505                    CMPC    fill='040'O
         2 005251   200025 200001                    ADSC9   DBUF,A,AUTO              cn=1,n=1
         2 005252   000051 000001 3                  ADSC9   41                       cn=0,n=1
         2 005253   005274 602000 2                  TNC     s:7605
         2 005254   040105 106400                    CMPC    fill='040'O
         2 005255   000052 000001 3                  ADSC9   42                       cn=0,n=1
         2 005256   200025 200001                    ADSC9   DBUF,A,AUTO              cn=1,n=1
         2 005257   005274 602000 2                  TNC     s:7605
         2 005260   040000 106505                    CMPC    fill='040'O
         2 005261   200024 600001                    ADSC9   SIGNC,A,AUTO             cn=3,n=1
         2 005262   000051 000001 3                  ADSC9   41                       cn=0,n=1
         2 005263   005270 602000 2                  TNC     s:7604
         2 005264   040105 106400                    CMPC    fill='040'O
         2 005265   000052 000001 3                  ADSC9   42                       cn=0,n=1
         2 005266   200024 600001                    ADSC9   SIGNC,A,AUTO             cn=3,n=1
         2 005267   005274 603000 2                  TRC     s:7605

     1314     7602    3                AND SUBSTR(DBUF,IDX+1,1)>='0' AND SUBSTR(DBUF,IDX+1,1)<='9'
     1315     7603    3                AND (SUBSTR(DBUF,IDX-1,1)<'0' OR SUBSTR(DBUF,IDX-1,1)>'9')
     1316     7604    3              THEN SUBSTR(DBUF,IDX,40)=SUBSTR(DBUF,IDX+1,39);

   7604  2 005270   040105 100505                    MLR     fill='040'O
         2 005271   200025 200047                    ADSC9   DBUF,A,AUTO              cn=1,n=39
         2 005272   200025 000050                    ADSC9   DBUF,A,AUTO              cn=0,n=40
         2 005273   005275 710000 2                  TRA     s:7606

     1317     7605    3              ELSE IDX=IDX+1;

   7605  2 005274   200133 054100                    AOS     IDX,,AUTO

     1318     7606    3              END;

   7606  2 005275   200133 235100                    LDA     IDX,,AUTO
         2 005276   040000 106505                    CMPC    fill='040'O
         2 005277   200025 000003                    ADSC9   DBUF,A,AUTO              cn=0,n=3
         2 005300   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:215  
         2 005301   005237 601000 2                  TNZ     s:7601

     1319     7607    2           FWIDTH=IDX+FMTX+2-PERCENT;

   7607  2 005302   200133 236100                    LDQ     IDX,,AUTO
         2 005303   200004 036100                    ADLQ    FMTX,,AUTO
         2 005304   200022 136100                    SBLQ    PERCENT,,AUTO
         2 005305   000002 036007                    ADLQ    2,DL
         2 005306   200132 756100                    STQ     FWIDTH,,AUTO

     1320     7608    2           IDX=FWIDTH-IDX-1;

   7608  2 005307   200133 136100                    SBLQ    IDX,,AUTO
         2 005310   000001 136007                    SBLQ    1,DL
         2 005311   200133 756100                    STQ     IDX,,AUTO

     1321     7609    2           SUBSTR(DBUF,FWIDTH-IDX,IDX)=SUBSTR(FMT,PERCENT,IDX);

   7609  2 005312   200132 236100                    LDQ     FWIDTH,,AUTO
         2 005313   200133 136100                    SBLQ    IDX,,AUTO
         2 005314   200003 470500                    LDP0    @FDS,,AUTO
         2 005315   000001 471500                    LDP1    1,,PR0
         2 005316   000004 720100                    LXL0    4,,PR0
         2 005317   200133 721100                    LXL1    IDX,,AUTO
         2 005320   200022 235100                    LDA     PERCENT,,AUTO
         2 005321   040146 100545                    MLR     fill='040'O
         2 005322   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
         2 005323   200025 000011                    ADSC9   DBUF,Q,AUTO              cn=0,n=*X1

     1322     7610    2           GOTO DBG_OUT;

   7610  2 005324   005176 710000 2                  TRA     DBG_OUT

     1323     7611    2   END FIELD;
     1324     7612        %EJECT;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:216  
     1325     7613    1   NUMERIC: PROC(RADIX) ALTRET;

   7613  2 005325   200112 741300       NUMERIC      STX1  ! TRANS$+2,,AUTO

     1326     7614    2   DCL RADIX SBIN;
     1327     7615    2           CALL GETVAL(TEMP,CNT(1)) ALTRET(NO_MEM);

   7615  2 005326   200013 630500                    EPPR0   CNT+1,,AUTO
         2 005327   200116 450500                    STP0    @B,,AUTO
         2 005330   200010 631500                    EPPR1   TEMP,,AUTO
         2 005331   200115 451500                    STP1    @V,,AUTO
         2 005332   004021 701000 2                  TSX1    GETVAL
         2 005333   005615 702000 2                  TSX2    NO_MEM

     1328     7616    3           IF FLAGS.SIGN AND STEMP<0 THEN DO;

   7616  2 005334   200011 236100                    LDQ     FLAGS,,AUTO
         2 005335   100000 316003                    CANQ    32768,DU
         2 005336   005346 600000 2                  TZE     s:7621
         2 005337   200010 235100                    LDA     TEMP,,AUTO
         2 005340   005346 605000 2                  TPL     s:7621

     1329     7617    3              SIGNC='-';

   7617  2 005341   055000 236003                    LDQ     23040,DU
         2 005342   200024 756100                    STQ     SIGNC,,AUTO

     1330     7618    3              STEMP=-STEMP;

   7618  2 005343   000000 531000                    NEG     0
         2 005344   200010 755100                    STA     TEMP,,AUTO

     1331     7619    3              END;

   7619  2 005345   005350 710000 2                  TRA     s:7623

     1332     7620    3           ELSE DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:217  

     1333     7621    3              SIGNC=' ';

   7621  2 005346   040000 236003                    LDQ     16384,DU
         2 005347   200024 756100                    STQ     SIGNC,,AUTO

     1334     7622    3              END;

     1335     7623    2           FSIG = 37;

   7623  2 005350   000045 235007                    LDA     37,DL
         2 005351   200064 755100                    STA     FSIG,,AUTO

     1336     7624    2           IF RADIX = 8

   7624  2 005352   200113 470500                    LDP0    @RADIX,,AUTO
         2 005353   000000 235100                    LDA     0,,PR0
         2 005354   000010 115007                    CMPA    8,DL
         2 005355   005373 601000 2                  TNZ     s:7630

     1337     7625    3           THEN DO UNTIL (TEMP = 0);

     1338     7626    3              FSIG = FSIG - 1;

   7626  2 005356   000001 336007                    LCQ     1,DL
         2 005357   200064 056100                    ASQ     FSIG,,AUTO

     1339     7627    3              CALL INSERT (NUMBUF,FSIG,1,SUBSTR(CONTAB,TEMPO.LSD,1));

   7627  2 005360   200010 236100                    LDQ     TEMP,,AUTO
         2 005361   000007 376007                    ANQ     7,DL
         2 005362   200064 235100                    LDA     FSIG,,AUTO
         2 005363   040105 100406                    MLR     fill='040'O
         2 005364   000053 000001 0                  ADSC9   CONTAB,Q                 cn=0,n=1
         2 005365   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1

     1340     7628    3              TEMP = TEMPO.REST;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:218  

   7628  2 005366   200010 236100                    LDQ     TEMP,,AUTO
         2 005367   000003 772000                    QRL     3
         2 005370   200010 756100                    STQ     TEMP,,AUTO

     1341     7629    3              END;

   7629  2 005371   005356 601000 2                  TNZ     s:7626
         2 005372   005430 710000 2                  TRA     s:7642

     1342     7630    2           ELSE IF RADIX = 2

   7630  2 005373   000002 115007                    CMPA    2,DL
         2 005374   005412 601000 2                  TNZ     s:7636

     1343     7631    3              THEN DO UNTIL (TEMP = 0);

     1344     7632    3                 FSIG = FSIG - 1;

   7632  2 005375   000001 336007                    LCQ     1,DL
         2 005376   200064 056100                    ASQ     FSIG,,AUTO

     1345     7633    3                 CALL INSERT (NUMBUF,FSIG,1,SUBSTR(CONTAB,TEMPB.LSB,1));

   7633  2 005377   200010 236100                    LDQ     TEMP,,AUTO
         2 005400   000001 376007                    ANQ     1,DL
         2 005401   200064 235100                    LDA     FSIG,,AUTO
         2 005402   040105 100406                    MLR     fill='040'O
         2 005403   000053 000001 0                  ADSC9   CONTAB,Q                 cn=0,n=1
         2 005404   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1

     1346     7634    3                 TEMP = TEMPB.REST;

   7634  2 005405   200010 236100                    LDQ     TEMP,,AUTO
         2 005406   000001 772000                    QRL     1
         2 005407   200010 756100                    STQ     TEMP,,AUTO

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:219  
     1347     7635    3                 END;

   7635  2 005410   005375 601000 2                  TNZ     s:7632
         2 005411   005430 710000 2                  TRA     s:7642

     1348     7636    2              ELSE IF RADIX = 16

   7636  2 005412   000020 115007                    CMPA    16,DL
         2 005413   005430 601000 2                  TNZ     s:7642

     1349     7637    3                 THEN DO UNTIL (TEMP = 0);

     1350     7638    3                    FSIG = FSIG - 1;

   7638  2 005414   000001 336007                    LCQ     1,DL
         2 005415   200064 056100                    ASQ     FSIG,,AUTO

     1351     7639    3                    CALL INSERT (NUMBUF,FSIG,1,SUBSTR(CONTAB,TEMPX.LSD,1));

   7639  2 005416   200010 236100                    LDQ     TEMP,,AUTO
         2 005417   000017 376007                    ANQ     15,DL
         2 005420   200064 235100                    LDA     FSIG,,AUTO
         2 005421   040105 100406                    MLR     fill='040'O
         2 005422   000053 000001 0                  ADSC9   CONTAB,Q                 cn=0,n=1
         2 005423   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1

     1352     7640    3                    TEMP = TEMPX.REST;

   7640  2 005424   200010 236100                    LDQ     TEMP,,AUTO
         2 005425   000004 772000                    QRL     4
         2 005426   200010 756100                    STQ     TEMP,,AUTO

     1353     7641    3                    END;

   7641  2 005427   005414 601000 2                  TNZ     s:7638

     1354     7642    2           GOTO NUMERIC2;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:220  

   7642  2 005430   005445 710000 2                  TRA     NUMERIC2

     1355     7643    2   NUMERIC1: ENTRY ALTRET;

   7643  2 005431   200112 741300       NUMERIC1     STX1  ! TRANS$+2,,AUTO

     1356     7644    2           FSIG = 24;                      /*ONLY LOOK AT POSSIBLE DECIMAL DIGITS*/

   7644  2 005432   000030 235007                    LDA     24,DL
         2 005433   200064 755100                    STA     FSIG,,AUTO

     1357     7645    3           DO WHILE(SUBSTR(NUMBUF,FSIG,1)='0' AND FSIG<36);

   7645  2 005434   005436 710000 2                  TRA     s:7647

     1358     7646    3              FSIG=FSIG+1;

   7646  2 005435   200064 054100                    AOS     FSIG,,AUTO

     1359     7647    3              END;

   7647  2 005436   200064 235100                    LDA     FSIG,,AUTO
         2 005437   040000 106505                    CMPC    fill='040'O
         2 005440   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1
         2 005441   000051 000001 3                  ADSC9   41                       cn=0,n=1
         2 005442   005445 601000 2                  TNZ     NUMERIC2
         2 005443   000044 115007                    CMPA    36,DL
         2 005444   005435 604000 2                  TMI     s:7646

     1360     7648    2   NUMERIC2:
     1361     7649    3           IF CNT(0)=0 THEN DO;

   7649  2 005445   200012 235100       NUMERIC2     LDA     CNT,,AUTO
         2 005446   005502 601000 2                  TNZ     s:7657

     1362     7650    4              IF SIGNC~=' ' THEN DO;
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:221  

   7650  2 005447   200024 236100                    LDQ     SIGNC,,AUTO
         2 005450   777000 376003                    ANQ     -512,DU
         2 005451   040000 116003                    CMPQ    16384,DU
         2 005452   005461 600000 2                  TZE     s:7654

     1363     7651    4                 FSIG=FSIG-1;

   7651  2 005453   000001 336007                    LCQ     1,DL
         2 005454   200064 056100                    ASQ     FSIG,,AUTO

     1364     7652    4                 CALL INSERT(NUMBUF,FSIG,1,SIGNC);

   7652  2 005455   200064 235100                    LDA     FSIG,,AUTO
         2 005456   040105 100500                    MLR     fill='040'O
         2 005457   200024 000001                    ADSC9   SIGNC,,AUTO              cn=0,n=1
         2 005460   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1

     1365     7653    4                 END;

     1366     7654    3              CALL FIELD(SUBSTR(NUMBUF,FSIG),37-FSIG,37-FSIG);

   7654  2 005461   000045 235007                    LDA     37,DL
         2 005462   200064 135100                    SBLA    FSIG,,AUTO
         2 005463   200162 755100                    STA     TABLEVAL+22,,AUTO
         2 005464   200163 755100                    STA     TABLEVAL+23,,AUTO
         2 005465   200163 630500                    EPPR0   TABLEVAL+23,,AUTO
         2 005466   200127 450500                    STP0    @FLD,,AUTO
         2 005467   200162 631500                    EPPR1   TABLEVAL+22,,AUTO
         2 005470   200126 451500                    STP1    @SIZ,,AUTO
         2 005471   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 005472   200064 236100                    LDQ     FSIG,,AUTO
         2 005473   000020 736000                    QLS     16
         2 005474   000051 036003                    ADLQ    41,DU
         2 005475   200142 036100                    ADLQ    TABLEVAL+6,,AUTO
         2 005476   200125 756100                    STQ     @STRING,,AUTO
         2 005477   004440 701000 2                  TSX1    FIELD
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:222  
         2 005500   000000 011000                    NOP     0

     1367     7655    3              END;

   7655  2 005501   005613 710000 2                  TRA     s:7672

     1368     7656    3           ELSE DO;

     1369     7657    3              IF FLAGS.STAR AND CNT(0)<37-FSIG THEN NUMBUF=STARS;

   7657  2 005502   200011 236100                    LDQ     FLAGS,,AUTO
         2 005503   004000 316003                    CANQ    2048,DU
         2 005504   005514 600000 2                  TZE     s:7658
         2 005505   000045 236007                    LDQ     37,DL
         2 005506   200064 136100                    SBLQ    FSIG,,AUTO
         2 005507   200012 116100                    CMPQ    CNT,,AUTO
         2 005510   005514 604400 2                  TMOZ    s:7658

   7657  2 005511   040100 100400                    MLR     fill='040'O
         2 005512   000027 000045 0                  ADSC9   STARS                    cn=0,n=37
         2 005513   200051 000045                    ADSC9   NUMBUF,,AUTO             cn=0,n=37

     1370     7658    4              IF FLAGS.LZ AND CNT(0)>37-FSIG THEN DO;

   7658  2 005514   200011 234100                    SZN     FLAGS,,AUTO
         2 005515   005562 605000 2                  TPL     s:7665
         2 005516   000045 236007                    LDQ     37,DL
         2 005517   200064 136100                    SBLQ    FSIG,,AUTO
         2 005520   200012 116100                    CMPQ    CNT,,AUTO
         2 005521   005562 605000 2                  TPL     s:7665

     1371     7659    4                 IF CNT(0) > 37 THEN CNT(0) = 37;

   7659  2 005522   000045 115007                    CMPA    37,DL
         2 005523   005526 604400 2                  TMOZ    s:7660

   7659  2 005524   000045 235007                    LDA     37,DL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:223  
         2 005525   200012 755100                    STA     CNT,,AUTO

     1372     7660    4                 CALL INSERT(NUMBUF,37-CNT(0),CNT(0)-(37-FSIG),ZEROES);

   7660  2 005526   200012 236100                    LDQ     CNT,,AUTO
         2 005527   200064 036100                    ADLQ    FSIG,,AUTO
         2 005530   777733 620006                    EAX0    -37,QL
         2 005531   000000 531000                    NEG     0
         2 005532   040145 100400                    MLR     fill='040'O
         2 005533   000041 000045 0                  ADSC9   ZEROES                   cn=0,n=37
         2 005534   200062 200010                    ADSC9   NUMBUF+9,A,AUTO          cn=1,n=*X0

     1373     7661    4                 IF SIGNC~=' ' THEN CALL INSERT(NUMBUF,37-CNT(0),1,SIGNC);

   7661  2 005535   200024 236100                    LDQ     SIGNC,,AUTO
         2 005536   777000 376003                    ANQ     -512,DU
         2 005537   040000 116003                    CMPQ    16384,DU
         2 005540   005545 600000 2                  TZE     s:7662

   7661  2 005541   200012 335100                    LCA     CNT,,AUTO
         2 005542   040105 100500                    MLR     fill='040'O
         2 005543   200024 000001                    ADSC9   SIGNC,,AUTO              cn=0,n=1
         2 005544   200062 200001                    ADSC9   NUMBUF+9,A,AUTO          cn=1,n=1

     1374     7662    4                 CALL FIELD(SUBSTR(NUMBUF,37-CNT(0)),CNT(0),CNT(0));

   7662  2 005545   200012 630500                    EPPR0   CNT,,AUTO
         2 005546   200127 450500                    STP0    @FLD,,AUTO
         2 005547   200012 631500                    EPPR1   CNT,,AUTO
         2 005550   200126 451500                    STP1    @SIZ,,AUTO
         2 005551   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 005552   000311 236007                    LDQ     201,DL
         2 005553   200012 136100                    SBLQ    CNT,,AUTO
         2 005554   000020 736000                    QLS     16
         2 005555   200142 036100                    ADLQ    TABLEVAL+6,,AUTO
         2 005556   200125 756100                    STQ     @STRING,,AUTO
         2 005557   004440 701000 2                  TSX1    FIELD
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:224  
         2 005560   000000 011000                    NOP     0

     1375     7663    4                 END;

   7663  2 005561   005613 710000 2                  TRA     s:7672

     1376     7664    4              ELSE DO;

     1377     7665    5                 IF SIGNC~=' ' THEN DO;

   7665  2 005562   200024 236100                    LDQ     SIGNC,,AUTO
         2 005563   777000 376003                    ANQ     -512,DU
         2 005564   040000 116003                    CMPQ    16384,DU
         2 005565   005574 600000 2                  TZE     s:7669

     1378     7666    5                    FSIG=FSIG-1;

   7666  2 005566   000001 336007                    LCQ     1,DL
         2 005567   200064 056100                    ASQ     FSIG,,AUTO

     1379     7667    5                    CALL INSERT(NUMBUF,FSIG,1,SIGNC);

   7667  2 005570   200064 235100                    LDA     FSIG,,AUTO
         2 005571   040105 100500                    MLR     fill='040'O
         2 005572   200024 000001                    ADSC9   SIGNC,,AUTO              cn=0,n=1
         2 005573   200051 000001                    ADSC9   NUMBUF,A,AUTO            cn=0,n=1

     1380     7668    5                    END;

     1381     7669    4                 CALL FIELD(SUBSTR(NUMBUF,FSIG),37-FSIG,CNT(0));

   7669  2 005574   000045 235007                    LDA     37,DL
         2 005575   200064 135100                    SBLA    FSIG,,AUTO
         2 005576   200164 755100                    STA     TABLEVAL+24,,AUTO
         2 005577   200012 630500                    EPPR0   CNT,,AUTO
         2 005600   200127 450500                    STP0    @FLD,,AUTO
         2 005601   200164 631500                    EPPR1   TABLEVAL+24,,AUTO
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:225  
         2 005602   200126 451500                    STP1    @SIZ,,AUTO
         2 005603   200142 452500                    STP2    TABLEVAL+6,,AUTO
         2 005604   200064 236100                    LDQ     FSIG,,AUTO
         2 005605   000020 736000                    QLS     16
         2 005606   000051 036003                    ADLQ    41,DU
         2 005607   200142 036100                    ADLQ    TABLEVAL+6,,AUTO
         2 005610   200125 756100                    STQ     @STRING,,AUTO
         2 005611   004440 701000 2                  TSX1    FIELD
         2 005612   000000 011000                    NOP     0

     1382     7670    4                 END;

     1383     7671    3              END;

     1384     7672    2           RETURN;

   7672  2 005613   200112 221300                    LDX1  ! TRANS$+2,,AUTO
         2 005614   000001 702211                    TSX2  ! 1,X1

     1385     7673    2   NO_MEM: ALTRETURN;

   7673  2 005615   200112 221300       NO_MEM       LDX1  ! TRANS$+2,,AUTO
         2 005616   000000 702211                    TSX2  ! 0,X1
     1386     7674    2   END NUMERIC;
     1387     7675
     1388     7676    1   END XUF$FORMAT1;
     1389     7677        %EOD;

PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:226  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUF$FORMAT1.
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:227  

 **** Variables and constants ****

  ****  Section 000 RoData XUF$FORMAT1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/c CHAR(11)    r     1 ARTHCHARS                 57-0-0/w CHAR(4)     r     1 BLANKS
     0-0-0/c CHAR(55)    r     1 CODEVEC                   53-0-0/c CHAR(16)    r     1 CONTAB
    16-0-0/c CHAR(24)    r     1 CONTCHARS
    74-0-0/c UBIN(9)     r     1 DATEWIDTH(0:11)
    60-0-0/d STRC(432)   r     1 FPT_TIME                  27-0-0/c CHAR(37)    r     1 STARS
   103-0-0/c UBIN(9)     r     1 STR_DUMP(0:511)
   102-0-0/c UBIN(9)     r     1 TIMEDEST(0:3)
    77-0-0/c UBIN(9)     r     1 TIMEWIDTH(0:11)
    41-0-0/c CHAR(37)    r     1 ZEROES

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   126-0-0/w PTR         r     1 @B                       114-0-0/w PTR         r     1 @B
   116-0-0/w PTR         r     1 @B                       113-0-0/w PTR         r     1 @B
     3-0-0/w PTR         r     1 @FDS                     127-0-0/w PTR         r     1 @FLD
   113-0-0/w PTR         r     1 @M$                      113-0-0/w PTR         r     1 @RADIX
   126-0-0/w PTR         r     1 @SIZ                     125-0-0/w PTR         r     1 @STRING
   115-0-0/w PTR         r     1 @V                       125-0-0/w PTR         r     1 @X
    *0-0-0/w SBIN        r     1 B                         *0-0-0/w SBIN        r     1 B
    *0-0-0/w SBIN        r     1 B                         *0-0-0/w SBIN        r     1 B
   127-0-0/w SBIN        r     1 BB                       117-0-0/w SBIN        r     1 BB
   120-0-0/w UBIN        r     1 CC                        12-0-0/w SBIN        r     1 CNT(0:3)
    12-0-0/w BIT         r     1 CNTB(0:3)                 16-0-0/w SBIN        r     1 CNTX
    20-0-0/w SBIN        r     1 CODE                      25-0-0/c CHAR(80)    r     1 DBUF
    71-0-0/w STRC(72)    r     1 DESC                      70-0-0/w SBIN        r     1 DSIZ
    65-0-0/w SBIN        r     1 DWID                      67-0-0/w STRC        r     1 ERRCD
    *0-0-0/w STRC(1080)  r     1 FDS                       11-0-0/w STRC(11)    r     1 FLAGS
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:228  
    *0-0-0/w SBIN        r     1 FLD                        4-0-0/w SBIN        r     1 FMTX
     7-0-0/w BIT         r     1 FORMATTING                74-0-0/d STRC(432)   r     1 FPT$TIME
    64-0-0/w SBIN        r     1 FSIG                     132-0-0/w SBIN        r     1 FWIDTH
    21-0-0/w SBIN        r     1 I                        133-0-0/w SBIN        r     1 IDX
     6-0-0/w BIT         r     1 LOOPING                   *0-0-0/w STRC        r     1 M
   122-0-0/w STRC        r     1 M                         *0-0-0/w PTR         r     1 M$
   122-0-0/w PTR         r     1 M$                        23-0-0/w PTR         r     1 MEM$
    51-0-0/w CHAR(37)    r     1 NUMBUF                    22-0-0/w SBIN        r     1 PERCENT
    *0-0-0/w SBIN        r     1 RADIX                     17-0-0/w SBIN        r     1 SAVCNT
    17-0-0/w BIT         r     1 SAVCNTB                    5-0-0/w SBIN        r     1 SAVEFMTX
    24-0-0/w CHAR        r     1 SIGNC                     *0-0-0/w SBIN        r     1 SIZ
    10-0-0/w SBIN        r     1 STEMP                    130-0-0/w PTR         r     1 STR$
    *0-0-0/c CHAR        r     1 STRING                   131-0-0/w SBIN        r     1 STRSIZ
   134-0-0/w SBIN        r     1 TABLEVAL                  10-0-0/w UBIN        r     1 TEMP
    10-0-0/w STRC        r     1 TEMPB                     10-0-0/w STRC        r     1 TEMPO
    10-0-0/w STRC        r     1 TEMPX                     10-0-0/w STRC(9)     r     1 TEMPY(0:3)
   110-0-0/w PTR         r     1 TRANS$                    66-0-0/w SBIN        r     1 TWID
    *0-0-0/w SBIN        r     1 V                        121-0-0/w PTR         r     1 V$
    63-0-0/w SBIN        r     1 X                         *0-0-0/w SBIN        r     1 X

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$SR_NON_BLANK$            0-0-0/w PTR         r     1 B$XL_ASC_DUMP$
     0-0-0/w PTR         r     1 B$XL_EBC_DUMP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4608)  r     1 ASC_DUMP                   0-0-0/c ACHR        r     1 BUFFER
     0-0-0/d STRC(4608)  r     1 EBC_DUMP                   0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/c ACHR        r     1 FMT                        0-0-0/d STRC(360)   r     1 FPT$DEVICE
     0-0-0/d STRC(432)   r     1 FPT$WRITE                  0-0-0/w STRC(3600)  r     1 G
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:229  
     0-0-0/w STRC(72)    r     1 MEMVEC(0:0)                0-0-0/b BIT         r     1 ONEBIT
     0-0-0/c CHAR        r     1 ONECHAR                    0-0-0/d STRC(4608)  r     1 SEARCHNB
     0-0-0/c ACHR        r     1 STR                        0-0-0/w CHAR(512)   r     1 TRANS
     0-0-0/b ABIT        r     1 VALBASE                    0-0-0/c ACHR        r     1 VALBASEC


   Procedure XUF$FORMAT1 requires 2959 words for executable code.
   Procedure XUF$FORMAT1 requires 118 words of local(AUTO) storage.
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:230  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:231  
          MINI XREF LISTING

ALL_BLANKS IN PROCEDURE FIELD
      7511**LABEL    7503--CALLALT  7508--CALLALT
ARITH_DONE
      7252**LABEL    6814--GOTO     6824--GOTO     6972--GOTO     7028--GOTO     7034--GOTO     7100--GOTO
      7129--GOTO     7144--GOTO     7190--GOTO
ARTHCHARS
       347**DCL      6861>>CALLBLT  7175>>CALLBLT
ASC_DUMP
      6589**DCL      6955--ASSIGN
B IN PROCEDURE GETMEM
      7379**DCL      7373--PROC     7388>>DOWHILE  7392>>ASSIGN   7393>>ASSIGN
B IN PROCEDURE GETVAL
      7400**DCL      7398--PROC     7412--IF       7412--IF       7416>>IF       7417>>IF       7421>>ASSIGN
B IN PROCEDURE SETMEM
      7305**DCL      7303--PROC     7309>>ASSIGN
B IN PROCEDURE SKIPBITS
      7478**DCL      7477--PROC     7480>>IF       7483>>ASSIGN   7484>>ASSIGN
B$SR_NON_BLANK$
      6584**DCL      6585--IMP-PTR  7503>>CALLBLT  7508>>CALLBLT
B$XL_ASC_DUMP$
      6588**DCL      6589--IMP-PTR  6955>>ASSIGN
B$XL_EBC_DUMP$
      6592**DCL      6593--IMP-PTR  6956>>ASSIGN
BAD_CNT
      7266**LABEL    7210--GOTO     7212--GOTO     7218--GOTO     7233--GOTO     7243--GOTO
BAD_CODE
      7263**LABEL    6802--CALLALT  7267--GOTO     7270--GOTO
BAD_FMT
      7272**LABEL    6854--CALLALT  6857--GOTO     6882--GOTO     7161--GOTO     7167--CALLALT  7171--GOTO
      7192--GOTO     7202--GOTO     7220--CALLALT
BB IN PROCEDURE GETVAL
      7401**DCL      7402--IMP-SIZ  7416<<ASSIGN   7418<<ASSIGN   7419<<ASSIGN   7421<<ASSIGN   7422>>DOWHILE
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:232  
      7429>>CALLBLT  7446>>ASSIGN   7447>>ASSIGN   7449>>DOWHILE  7454>>ASSIGN   7455>>ASSIGN   7455>>ASSIGN
      7458<<ASSIGN   7458>>ASSIGN   7463>>IF       7465>>ASSIGN   7469>>ASSIGN   7469>>ASSIGN   7469>>ASSIGN
      7470>>ASSIGN   7471>>ASSIGN
BB IN PROCEDURE SETMEM
      7306**DCL      7309<<ASSIGN   7316>>ASSIGN   7317>>ASSIGN   7318<<ASSIGN
BLANKBUF
      7366**PROC     6828--CALL     6934--CALL     7327--CALL     7499--CALL
BLANKS
       357**DCL      7536--ASSIGN
BUFFER
       289**DCL      6935<<CALLBLT  7021<<CALLBLT  7279<<ASSIGN   7280<<CALLBLT  7284<<ASSIGN   7285<<CALLBLT
      7290<<ASSIGN   7292<<ASSIGN   7294<<ASSIGN   7296<<ASSIGN   7298>>CALLBLT  7337>>IF       7338<<ASSIGN
      7338>>ASSIGN   7349<<ASSIGN   7351<<ASSIGN   7352<<ASSIGN   7352>>ASSIGN   7367<<ASSIGN   7524<<CALLBLT
      7530<<CALLBLT  7546<<CALLBLT  7554<<CALLBLT  7560<<CALLBLT  7568<<CALLBLT  7577>>ASSIGN
BUF_OUT
      7326**PROC     6816--CALL     6818--CALL     6841--CALL     6904--CALL     6938--CALL     7258--CALL
      7263--CALL     7274--CALL     7283--CALL     7288--CALL     7300--CALL
BUF_WRAP IN PROCEDURE BUF_OUT
      7357**ENTRY    7136--CALL     7520--CALL     7526--CALL     7540--CALL
CASE_48
      7192**LABEL    7188--GOTO
CC IN PROCEDURE GETVAL
      7403**DCL      7404--IMP-SIZ  7430<<ASSIGN   7432>>CALLBLT  7433>>CALLBLT  7454<<ASSIGN   7456>>ASSIGN
      7457>>ASSIGN   7458>>ASSIGN   7465<<ASSIGN   7466>>ASSIGN   7466>>ASSIGN   7466>>ASSIGN
CHK_OP
      6865**LABEL    6859--CALLALT
CHK_OP2
      7181**LABEL    7173--CALLALT
CNT
       337**DCL       338--REDEF    6798<<ASSIGN   6805<<ASSIGN   6805>>ASSIGN   6813<<ASSIGN   6813>>ASSIGN
      6817>>DOINDEX  6823<<ASSIGN   6823>>ASSIGN   6826>>IF       6826>>ASSIGN   6827>>IF       6827>>ASSIGN
      6829>>IF       6830>>IF       6833>>ASSIGN   6851>>IF       6872>>DOWHILE  6876<<ASSIGN   6876>>ASSIGN
      6884>>ASSIGN   6888>>IF       6888>>IF       6891>>IF       6892<>CALL     6894>>IF       6896>>ASSIGN
      6898>>ASSIGN   6903>>IF       6910>>ASSIGN   6910>>ASSIGN   6910>>ASSIGN   6912>>ASSIGN   6912>>ASSIGN
      6912>>ASSIGN   6913>>IF       6922>>CALL     6925<>CALL     6925<>CALL     6945<<ASSIGN   6945>>ASSIGN
      6948--ASSIGN   6952>>IF       6952>>IF       6952>>ASSIGN   6955>>IF       6956>>IF       6957<>CALL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:233  
      6963<>CALL     6971<<ASSIGN   6971>>ASSIGN   6978<>CALL     6990<>CALL     7010<>CALL     7015>>IF
      7015<<ASSIGN   7016>>IF       7016<>CALL     7018<<ASSIGN   7018>>ASSIGN   7019>>IF       7019<<ASSIGN
      7020>>ASSIGN   7021>>CALLBLT  7027<<ASSIGN   7027>>ASSIGN   7033<<ASSIGN   7033>>ASSIGN   7038>>ASSIGN
      7039>>ASSIGN   7042>>IF       7044<>CALL     7046>>IF       7049>>ASSIGN   7050>>DOCASE   7068<>CALL
      7071<>CALL     7074<>CALL     7075<>CALL     7094<>CALL     7099<<ASSIGN   7099>>ASSIGN   7104>>DOCASE
      7109<>CALL     7113<>CALL     7116>>ASSIGN   7118<>CALL     7123<>CALL     7133>>IF       7138>>IF
      7153>>CALLBLT  7157<<ASSIGN   7159>>IF       7159>>IF       7159>>IF       7164<<ASSIGN   7168<<ASSIGN
      7177<<ASSIGN   7177>>ASSIGN   7178<<ASSIGN   7181<<ASSIGN   7181>>ASSIGN   7182<<ASSIGN   7182>>ASSIGN
      7189<<ASSIGN   7189>>ASSIGN   7197>>ASSIGN   7198<<ASSIGN   7209>>IF       7210>>IF       7211>>ASSIGN
      7218>>IF       7218>>IF       7219>>ASSIGN   7225>>ASSIGN   7226<<ASSIGN   7229>>ASSIGN   7230>>ASSIGN
      7242>>ASSIGN   7244<<ASSIGN   7245<<ASSIGN   7412--IF       7413>>ASSIGN   7615<>CALL     7649>>IF
      7657>>IF       7658>>IF       7659>>IF       7659<<ASSIGN   7660>>CALLBLT  7660>>CALLBLT  7661>>CALLBLT
      7662>>CALL     7662<>CALL     7662<>CALL     7669<>CALL
CNTB
       338**DCL      7073<<ASSIGN   7128<<ASSIGN   7128>>ASSIGN   7143<<ASSIGN   7143>>ASSIGN   7251<<ASSIGN
      7251>>ASSIGN
CNTX
       339**DCL      6799<<ASSIGN   6805>>ASSIGN   6805>>ASSIGN   6807<<ASSIGN   6807>>ASSIGN   6813>>ASSIGN
      6813>>ASSIGN   6823>>ASSIGN   6823>>ASSIGN   6925>>CALL     6925>>CALL     6945>>IF       6971>>ASSIGN
      6971>>ASSIGN   7027>>ASSIGN   7027>>ASSIGN   7033>>ASSIGN   7033>>ASSIGN   7072>>IF       7099>>ASSIGN
      7099>>ASSIGN   7128>>ASSIGN   7128>>ASSIGN   7143>>ASSIGN   7143>>ASSIGN   7189>>ASSIGN   7189>>ASSIGN
      7197>>ASSIGN   7198>>ASSIGN   7225>>ASSIGN   7226>>ASSIGN   7242>>ASSIGN   7244>>ASSIGN   7245>>ASSIGN
      7251>>ASSIGN   7251>>ASSIGN
CODE
       342**DCL      6802<<CALLBLT  6803>>DOCASE   6805>>ASSIGN   6874>>ASSIGN   6876>>IF       7162>>ASSIGN
CODEVEC
       343**DCL      6802>>CALLBLT
CONTAB
       356**DCL      6993>>CALLBLT  6994>>CALLBLT  7627>>CALLBLT  7633>>CALLBLT  7639>>CALLBLT
CONTCHARS
       346**DCL      6859>>CALLBLT  7173>>CALLBLT
DATEWIDTH
      6739**DCL      7038>>ASSIGN
DBG_OUT IN PROCEDURE FIELD
      7588**LABEL    7610--GOTO
DBG_RETURN
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:234  
      7203**LABEL    6886--GOTO     7194--GOTO
DBUF
       352**DCL      6778<<ASSIGN   6779<<CALLBLT  7074<>CALL     7075<>CALL     7108<>CALL     7109<>CALL
      7112<>CALL     7113<>CALL     7117<>CALL     7118<>CALL     7121<<ASSIGN   7123<>CALL     7152<<ASSIGN
      7153<<CALLBLT  7204<<ASSIGN   7235<<ASSIGN   7236<<CALLBLT  7237<<CALLBLT  7428<<ASSIGN   7429<<CALLBLT
      7431<<CALLBLT  7432<<CALLBLT  7433<<CALLBLT  7434<<CALLBLT  7577<<ASSIGN   7578<<ASSIGN   7582<<ASSIGN
      7586<<ASSIGN   7588<<ASSIGN   7591--ASSIGN   7600>>DOUNTIL  7601>>IF       7601>>IF       7601>>IF
      7601>>IF       7601>>IF       7601>>IF       7604<<ASSIGN   7604>>ASSIGN   7609<<ASSIGN
DEBUG_OUT IN PROCEDURE FIELD
      7598**ENTRY    6781--CALL     7154--CALL     7205--CALL     7238--CALL     7435--CALL
DESC
       368**DCL      7108<>CALL
DESC.W0
       369**DCL      7106<>CALL     7111<>CALL     7112<>CALL     7115<>CALL     7117<>CALL     7120<>CALL
      7121--ASSIGN   7121--ASSIGN   7122--ASSIGN
DESC.W1
       370**DCL      7107<>CALL
DSIZ
       367**DCL      7074<>CALL     7075<>CALL     7108<>CALL     7109<>CALL     7112<>CALL     7113<>CALL
      7116<<ASSIGN   7117<>CALL     7118<>CALL     7122<<ASSIGN   7123<>CALL
DWID
       360**DCL      7038<<ASSIGN   7056>>ASSIGN   7059>>ASSIGN   7060>>ASSIGN   7062>>ASSIGN   7063>>ASSIGN
      7064>>ASSIGN
EBC_DUMP
      6593**DCL      6956--ASSIGN
EDIT_ALT
      7011**LABEL    7010--CALLALT
END_FMT
      6790**LABEL    6788--CALLALT
ERRCD
       362**DCL      7071<>CALL     7073>>ASSIGN
ERRCD.CODE
       365**DCL      7091>>CALLBLT
ERRCD.FCG
       363**DCL      7080>>IF       7082>>IF       7083>>CALLBLT  7085>>CALLBLT
ERRCD.MON
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:235  
       364**DCL      7087>>IF
ERRCD.SEV
       366**DCL      7093>>CALLBLT
F$DCB.ACTPOS
      6628**DCL      6628--REDEF
F$DCB.ARS#
      6602**DCL      6602--REDEF
F$DCB.ATTR
      6621**DCL      6622--REDEF
F$DCB.BORROW
      6636**DCL      6636--REDEF    6636--REDEF    6636--REDEF
F$DCB.DCBNAME.L
      6650**DCL      6650--IMP-SIZ  7121>>ASSIGN   7122>>ASSIGN
F$DCB.DCBNAME.N
      6650**DCL      7121>>ASSIGN
F$DCB.EOMCHAR#
      6606**DCL      6606--REDEF
F$DCB.FLDID
      6631**DCL      6631--REDEF
F$DCB.FORM$
      6625**DCL      6625--REDEF
F$DCB.FSECT
      6641**DCL      6641--REDEF
F$DCB.FSN#
      6618**DCL      6618--REDEF    6618--REDEF    6619--REDEF
F$DCB.HEADER$
      6624**DCL      6624--REDEF
F$DCB.IXTNSIZE#
      6622**DCL      6622--REDEF
F$DCB.LASTSTA$
      6611**DCL      6611--REDEF
F$DCB.LVL
      6637**DCL      6637--REDEF
F$DCB.NAME#.C
      6612**DCL      6612--REDEF
F$DCB.NOEOF
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:236  
      6634**DCL      6634--REDEF
F$DCB.NRECS#
      6623**DCL      6623--REDEF
F$DCB.NRECX
      6642**DCL      6642--REDEF
F$DCB.OHDR
      6634**DCL      6634--REDEF
F$DCB.ORG#
      6617**DCL      6617--REDEF
F$DCB.PRECNO
      6640**DCL      6640--REDEF
F$DCB.RCSZ
      6646**DCL      6646--REDEF
F$DCB.RES#
      6613**DCL      6613--REDEF
F$DCB.SETX
      6625**DCL      6625--REDEF
F$DCB.TAB$
      6625**DCL      6625--REDEF
F$DCB.TDA
      6639**DCL      6640--REDEF
F$DCB.WSN#
      6613**DCL      6613--REDEF
FDS
       184**DCL         6--PROC     6875<>CALL     7010<>CALL     7163<>CALL     7215<>CALL     7243--IF
      7245--ASSIGN   7333<>CALL
FDS.BAILOUT
       256**DCL      6905>>UNWIND   7301>>UNWIND
FDS.BLNKBUF
       231**DCL      6828>>IF       6904>>IF       6934>>IF       6938>>IF       7133>>IF       7258>>IF
      7263>>IF       7282<<ASSIGN   7287<<ASSIGN   7299<<ASSIGN   7327>>IF       7346<<ASSIGN   7369<<ASSIGN
      7499>>IF
FDS.BUFSIZE
       210**DCL       289--IMP-SIZ  6935>>CALLBLT  7021>>CALLBLT  7133>>IF       7279>>ASSIGN   7280>>CALLBLT
      7284>>ASSIGN   7285>>CALLBLT  7290>>ASSIGN   7292>>ASSIGN   7294>>ASSIGN   7296>>ASSIGN   7298>>CALLBLT
      7337>>IF       7338>>ASSIGN   7338>>ASSIGN   7349>>ASSIGN   7351>>ASSIGN   7352>>ASSIGN   7352>>ASSIGN
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:237  
      7367>>ASSIGN   7518>>IF       7522>>IF       7522>>ASSIGN   7524>>CALLBLT  7526>>IF       7529>>DOWHILE
      7530>>CALLBLT  7531>>ASSIGN   7539>>ASSIGN   7545>>IF       7545>>ASSIGN   7546>>CALLBLT  7549>>IF
      7550>>ASSIGN   7552>>ASSIGN   7554>>CALLBLT  7559>>IF       7559>>ASSIGN   7560>>CALLBLT  7563>>IF
      7564>>ASSIGN   7566>>ASSIGN   7568>>CALLBLT  7577>>ASSIGN
FDS.BUFX
       208**DCL      6830>>IF       6831>>ASSIGN   6835>>ASSIGN   6835>>ASSIGN   6845<<ASSIGN   7019>>IF
      7019>>ASSIGN   7020<<ASSIGN   7020>>ASSIGN   7021>>CALLBLT  7133>>IF       7133>>IF       7138>>IF
      7139>>ASSIGN   7281<<ASSIGN   7286<<ASSIGN   7298<<CALLBLT  7329>>ASSIGN   7347>>IF       7348<<ASSIGN
      7353<<ASSIGN   7353>>ASSIGN   7360>>ASSIGN   7361<<ASSIGN   7368<<ASSIGN   7518>>IF       7518>>IF
      7518>>IF       7522>>IF       7522>>ASSIGN   7524>>CALLBLT  7525<<ASSIGN   7525>>ASSIGN   7526>>IF
      7529>>DOWHILE  7530>>CALLBLT  7531>>ASSIGN   7539<<ASSIGN   7545>>IF       7545>>ASSIGN   7546>>CALLBLT
      7549>>IF       7550>>ASSIGN   7552>>ASSIGN   7554>>CALLBLT  7559>>IF       7559>>ASSIGN   7560>>CALLBLT
      7563>>IF       7564>>ASSIGN   7566>>ASSIGN   7568>>CALLBLT  7571<<ASSIGN   7571>>ASSIGN   7574>>IF
      7575>>ASSIGN   7577>>ASSIGN   7581>>ASSIGN   7584>>ASSIGN   7586>>ASSIGN
FDS.BUF_.BOUND
       202**DCL      6836>>IF       6838>>ASSIGN
FDS.BUF_.BUF$
       204**DCL       289--IMP-PTR  6935>>CALLBLT  7021>>CALLBLT  7279>>ASSIGN   7280>>CALLBLT  7284>>ASSIGN
      7285>>CALLBLT  7290>>ASSIGN   7292>>ASSIGN   7294>>ASSIGN   7296>>ASSIGN   7298>>CALLBLT  7331>>ASSIGN
      7337>>IF       7338>>ASSIGN   7338>>ASSIGN   7349>>ASSIGN   7351>>ASSIGN   7352>>ASSIGN   7352>>ASSIGN
      7367>>ASSIGN   7524>>CALLBLT  7530>>CALLBLT  7546>>CALLBLT  7554>>CALLBLT  7560>>CALLBLT  7568>>CALLBLT
      7577>>ASSIGN
FDS.CUR$
       266**DCL      7314<<ASSIGN   7317<<ASSIGN   7317>>ASSIGN   7380>>ASSIGN   7385<<ASSIGN   7392<<ASSIGN
      7392>>ASSIGN   7426>>ASSIGN   7439<<ASSIGN   7439>>ASSIGN   7443>>IF       7448>>ASSIGN   7460<<ASSIGN
      7469>>ASSIGN   7470<<ASSIGN   7470>>ASSIGN   7483<<ASSIGN   7483>>ASSIGN
FDS.DCB#
       217**DCL      6939>>IF       6940>>ASSIGN   7335>>IF       7336>>ASSIGN   7593>>ASSIGN
FDS.DEBUG
       229**DCL      6777>>IF       7151>>IF       7203>>IF       7234>>IF       7249<<ASSIGN   7249>>ASSIGN
      7427>>IF       7573>>IF
FDS.DEVICEFPT$
       268**DCL      6663--IMP-PTR  6940>>ASSIGN   6941>>CALL
FDS.DONT_PRINT
       233**DCL      6904>>IF       7146<<ASSIGN   7258>>IF       7263>>IF
FDS.DVFC#
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:238  
       220**DCL      7349>>ASSIGN   7351>>ASSIGN   7367>>ASSIGN
FDS.EDIT#
       243**DCL      7009>>IF       7010>>CALL
FDS.FMTSIZE
       199**DCL       292--IMP-SIZ  6788>>CALLBLT  6790>>ASSIGN   6794>>CALL     6802>>CALLBLT  6854>>CALLBLT
      6857>>IF       6859>>CALLBLT  6861>>CALLBLT  6865>>IF       6867>>IF       6927>>IF       6931>>ASSIGN
      7161>>IF       7167>>CALLBLT  7171>>IF       7173>>CALLBLT  7175>>CALLBLT  7181>>IF       7182>>IF
      7183>>IF       7184>>IF       7212>>IF       7220>>CALLBLT  7277>>IF       7277>>ASSIGN   7280>>CALLBLT
      7588>>ASSIGN   7609>>ASSIGN
FDS.FMTX
       195**DCL      6776>>ASSIGN   6870<<ASSIGN   6873<<ASSIGN   6879>>ASSIGN   6885<<ASSIGN   7008<<ASSIGN
      7013>>ASSIGN   7160<<ASSIGN   7161>>IF       7165>>ASSIGN   7193<<ASSIGN   7213<<ASSIGN
FDS.FMTXMAX
       197**DCL      6783>>ASSIGN   6874<<ASSIGN   6876>>IF       6877>>IF       6883<<ASSIGN   6884<<ASSIGN
      7162<<ASSIGN   7214<<ASSIGN
FDS.FMT_.FMT$
       191**DCL       292--IMP-PTR  6788>>CALLBLT  6794>>CALL     6802>>CALLBLT  6854>>CALLBLT  6859>>CALLBLT
      6861>>CALLBLT  6865>>IF       6867>>IF       6927>>IF       6931>>ASSIGN   7167>>CALLBLT  7173>>CALLBLT
      7175>>CALLBLT  7181>>IF       7182>>IF       7183>>IF       7184>>IF       7220>>CALLBLT  7280>>CALLBLT
      7588>>ASSIGN   7609>>ASSIGN
FDS.FWID
       260**DCL      7516<<ASSIGN   7521>>DOWHILE  7522>>IF       7523>>ASSIGN   7527<<ASSIGN   7527>>ASSIGN
      7529>>DOWHILE  7532<<ASSIGN   7532>>ASSIGN   7543>>IF       7545>>IF       7545<<ASSIGN   7546>>CALLBLT
      7549>>IF       7550>>ASSIGN   7552<<ASSIGN   7554>>CALLBLT  7554>>CALLBLT  7559>>IF       7559<<ASSIGN
      7560>>CALLBLT  7563>>IF       7564>>ASSIGN   7566<<ASSIGN   7568>>CALLBLT  7571>>ASSIGN   7572<<ASSIGN
FDS.GLOBAL$
       272**DCL      6771--IMP-PTR  6779>>CALLBLT  7211>>ASSIGN   7219>>ASSIGN   7240>>ASSIGN   7244>>ASSIGN
FDS.MEMSZ
       262**DCL      6888>>IF       6903>>IF       6914>>IF       6916>>IF       6951>>ASSIGN   7257>>IF
      7308<<ASSIGN   7310>>DOWHILE  7315<<ASSIGN   7316<<ASSIGN   7316>>ASSIGN   7322<<ASSIGN   7383<<ASSIGN
      7383>>ASSIGN   7386>>IF       7388>>DOWHILE  7390>>IF       7393<<ASSIGN   7393>>ASSIGN   7394>>IF
      7418>>IF       7418>>IF       7418>>ASSIGN   7422>>DOWHILE  7424>>IF       7440<<ASSIGN   7440>>ASSIGN
      7446<<ASSIGN   7446>>ASSIGN   7452<<ASSIGN   7452>>ASSIGN   7471<<ASSIGN   7471>>ASSIGN   7473>>IF
      7480>>IF       7484<<ASSIGN   7484>>ASSIGN
FDS.MEMX
       264**DCL      6774>>IF       6889>>CALL     6914>>IF       6914>>IF       6915>>CALL     6919<>CALL
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:239  
      7307<<ASSIGN   7311<<ASSIGN   7311>>ASSIGN   7312>>IF       7313>>IF       7314>>ASSIGN   7315>>ASSIGN
      7386>>CALL     7389>>CALL     7394>>CALL     7423>>CALL     7430>>ASSIGN   7431>>CALLBLT  7473>>CALL
      7481>>CALL
FDS.NVECS#
       212**DCL      6916>>IF       6917>>CALL     7312>>IF
FDS.OUTPUT#
       238**DCL      7332>>IF       7333>>CALL
FDS.RESCAN
       254**DCL      6809<<ASSIGN   7259>>ASSIGN
FDS.TABDFLT#
       250**DCL      6826<<ASSIGN   6835>>ASSIGN   6835>>ASSIGN
FDS.TRUNC#
       224**DCL      6837>>IF       7517>>IF
FDS.VECTR$
       214**DCL       293--IMP-PTR  6914>>IF       7313>>IF       7314>>ASSIGN   7315>>ASSIGN   7430>>ASSIGN
FDS.WRAP
       235**DCL      7328<<ASSIGN   7346>>IF       7358<<ASSIGN   7518>>IF
FDS.WRAPTAB#
       247**DCL      6827<<ASSIGN   7133>>IF       7138>>IF       7348>>ASSIGN   7351>>ASSIGN   7352>>ASSIGN
      7353>>ASSIGN   7518>>IF
FDS.WRITEFPT$
       270**DCL      6687--IMP-PTR  7135>>ASSIGN   7139>>ASSIGN   7329>>ASSIGN   7331>>ASSIGN   7333>>CALL
      7336>>ASSIGN   7339>>ASSIGN   7339>>ASSIGN   7340>>ASSIGN   7342>>CALL     7343>>ASSIGN   7352>>ASSIGN
      7353>>ASSIGN   7355>>ASSIGN   7359>>IF       7360>>ASSIGN   7590>>ASSIGN   7591>>ASSIGN   7592>>ASSIGN
      7593>>ASSIGN   7594>>CALL     7595>>ASSIGN
FIELD
      7489**PROC     6794--CALL     6848--CALL     6957--CALL     6963--CALL     7016--CALL     7068--CALL
      7075--CALL     7094--CALL     7109--CALL     7113--CALL     7118--CALL     7123--CALL     7654--CALL
      7662--CALL     7669--CALL
FLAGS
       314**DCL      6786<<ASSIGN   6797<<ASSIGN
FLAGS.ARITH
       324**DCL      6812>>IF       6822>>IF       6858>>IF       6862<<ASSIGN   6863<<ASSIGN   6970>>IF
      7026>>IF       7032>>IF       7098>>IF       7127>>IF       7142>>IF       7172>>IF       7176<<ASSIGN
      7179<<ASSIGN   7188>>IF       7196<<ASSIGN   7224>>IF       7227<<ASSIGN   7249>>IF       7252<<ASSIGN
FLAGS.CNT1
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:240  
       325**DCL      6946>>IF       7247<<ASSIGN   7412>>IF
FLAGS.DLB
       320**DCL      7030<<ASSIGN   7502>>IF
FLAGS.DTB
       319**DCL      6830>>IF       7036<<ASSIGN   7507>>IF
FLAGS.FIELD
       322**DCL      7131<<ASSIGN   7518>>IF
FLAGS.L6
       323**DCL      6895>>IF       6909>>IF       7149<<ASSIGN   7437>>IF       7445>>IF
FLAGS.LJ
       316**DCL      6968<<ASSIGN   7521>>IF       7558>>IF
FLAGS.LZ
       315**DCL      6966<<ASSIGN   7658>>IF
FLAGS.MSD
       318**DCL      6976<<ASSIGN   7544>>IF
FLAGS.SIGN
       317**DCL      6974<<ASSIGN   6979>>IF       7443>>IF       7616>>IF
FLAGS.STAR
       321**DCL      7102<<ASSIGN   7657>>IF
FLD IN PROCEDURE FIELD
      7492**DCL      7489--PROC     7514>>IF       7515>>ASSIGN
FMT
       292**DCL      6788>>CALLBLT  6794<>CALL     6802>>CALLBLT  6854>>CALLBLT  6859>>CALLBLT  6861>>CALLBLT
      6865>>IF       6867>>IF       6927>>IF       6931--ASSIGN   7167>>CALLBLT  7173>>CALLBLT  7175>>CALLBLT
      7181>>IF       7182>>IF       7183>>IF       7184>>IF       7220>>CALLBLT  7280>>CALLBLT  7588>>ASSIGN
      7609>>ASSIGN
FMTX
       290**DCL      6776<<ASSIGN   6780>>ASSIGN   6788>>CALLBLT  6793>>IF       6794>>CALL     6794>>CALL
      6794>>CALL     6796<<ASSIGN   6801<<ASSIGN   6801>>ASSIGN   6802>>CALLBLT  6809>>ASSIGN   6854<<CALLBLT
      6854>>CALLBLT  6856<<ASSIGN   6856>>ASSIGN   6857>>IF       6859>>CALLBLT  6861>>CALLBLT  6865>>IF
      6867>>IF       6870>>ASSIGN   6873>>ASSIGN   6879<<ASSIGN   6883>>IF       6885>>ASSIGN   6927>>IF
      6931>>ASSIGN   6933<<ASSIGN   6933>>ASSIGN   7008>>ASSIGN   7013<<ASSIGN   7160>>ASSIGN   7165<<ASSIGN
      7167<<CALLBLT  7167>>CALLBLT  7170<<ASSIGN   7170>>ASSIGN   7171>>IF       7173>>CALLBLT  7175>>CALLBLT
      7181>>IF       7182>>IF       7183>>IF       7184>>IF       7201>>IF       7219>>ASSIGN   7220<<CALLBLT
      7220>>CALLBLT  7221<<ASSIGN   7221>>ASSIGN   7256<<ASSIGN   7256>>ASSIGN   7259<<ASSIGN   7272<<ASSIGN
      7275>>IF       7275>>ASSIGN   7277>>IF       7277>>ASSIGN   7280>>CALLBLT  7289>>IF       7573>>IF
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:241  
      7576>>ASSIGN   7607>>ASSIGN
FORMATTING
       298**DCL      6795<<ASSIGN   6800>>DOWHILE  6810<<ASSIGN   6820<<ASSIGN   6846<<ASSIGN   6849<<ASSIGN
      6880<<ASSIGN   6901<<ASSIGN   6907<<ASSIGN   6923<<ASSIGN   6936<<ASSIGN   6943<<ASSIGN   6958<<ASSIGN
      6964<<ASSIGN   6988<<ASSIGN   6997<<ASSIGN   7000<<ASSIGN   7003<<ASSIGN   7006<<ASSIGN   7011<<ASSIGN
      7024<<ASSIGN   7069<<ASSIGN   7096<<ASSIGN   7125<<ASSIGN   7140<<ASSIGN   7147<<ASSIGN   7186<<ASSIGN
      7200<<ASSIGN   7231<<ASSIGN
FPT$DEVICE
      6663**DCL      6941<>CALL
FPT$DEVICE.V.DCB#
      6664**DCL      6940<<ASSIGN
FPT$TIME
      6731**DCL      7040<<ASSIGN   7067<>CALL
FPT$TIME.DATE_
      6731**DCL      7055<<ASSIGN   7059<<ASSIGN   7062<<ASSIGN
FPT$TIME.TIME_
      6733**DCL      7052<<ASSIGN   7058<<ASSIGN   7063<<ASSIGN
FPT$TIME.TSTAMP_
      6734**DCL      7045<<ASSIGN
FPT$TIME.V
      6735**DCL      7041--ASSIGN
FPT$TIME.V.DEST#
      6735**DCL      7049<<ASSIGN
FPT$TIME.V.SOURCE#
      6735**DCL      7042<<ASSIGN   7046<<ASSIGN   7047<<ASSIGN
FPT$TIME.V_
      6731**DCL      7041<<ASSIGN
FPT$WRITE
      6687**DCL      7342<>CALL     7594<>CALL
FPT$WRITE.BUF_
      6687**DCL      7333<>CALL
FPT$WRITE.BUF_.BOUND
      6687**DCL      7135<<ASSIGN   7139<<ASSIGN   7329<<ASSIGN   7339<<ASSIGN   7339>>ASSIGN   7352>>ASSIGN
      7353>>ASSIGN   7355<<ASSIGN   7359>>IF       7360<<ASSIGN   7590>>ASSIGN   7592<<ASSIGN   7595<<ASSIGN
FPT$WRITE.BUF_.BUF$
      6689**DCL      7331<<ASSIGN   7591<<ASSIGN
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:242  
FPT$WRITE.STATION_
      6689**DCL      6689--REDEF
FPT$WRITE.V.DCB#
      6690**DCL      7336<<ASSIGN   7593<<ASSIGN
FPT$WRITE.V.DVBYTE.VFC#
      6696**DCL      6696--REDEF    7340<<ASSIGN   7343<<ASSIGN
FPT_TIME
      6712**DCL      7040>>ASSIGN
FPT_TIME.V
      6716**DCL      6712--DCLINIT
FSIG
       359**DCL      7623<<ASSIGN   7626<<ASSIGN   7626>>ASSIGN   7627>>CALLBLT  7632<<ASSIGN   7632>>ASSIGN
      7633>>CALLBLT  7638<<ASSIGN   7638>>ASSIGN   7639>>CALLBLT  7644<<ASSIGN   7645>>DOWHILE  7645>>DOWHILE
      7646<<ASSIGN   7646>>ASSIGN   7651<<ASSIGN   7651>>ASSIGN   7652>>CALLBLT  7654>>CALL     7654>>CALL
      7654>>CALL     7657>>IF       7658>>IF       7660>>CALLBLT  7666<<ASSIGN   7666>>ASSIGN   7667>>CALLBLT
      7669>>CALL     7669>>CALL
FWIDTH IN PROCEDURE FIELD
      7496**DCL      7514<<ASSIGN   7515<<ASSIGN   7516>>ASSIGN   7518>>IF       7572>>ASSIGN   7574>>IF
      7574<<ASSIGN   7575<<ASSIGN   7575>>ASSIGN   7578>>ASSIGN   7579>>IF       7580>>ASSIGN   7581<<ASSIGN
      7585<<ASSIGN   7592>>ASSIGN   7607<<ASSIGN   7608>>ASSIGN   7609>>ASSIGN
G.INDX
      6772**DCL      7211>>ASSIGN   7219<<ASSIGN   7240<<ASSIGN   7244>>ASSIGN   7245>>ASSIGN
GETMEM
      7373**PROC     6892--CALL     6928--CALL     6953--CALL     6962--CALL
GETVAL
      7398**PROC     6925--CALL     6961--CALL     6978--CALL     6990--CALL     7044--CALL     7071--CALL
      7106--CALL     7107--CALL     7111--CALL     7115--CALL     7120--CALL     7615--CALL
I
       348**DCL      6817<<DOINDEX  6831<<ASSIGN   6833<<ASSIGN   6835<<ASSIGN   6836>>IF       6838<<ASSIGN
      6842<<ASSIGN   6845>>ASSIGN   6852<<ASSIGN   6853>>DOUNTIL  6866<<ASSIGN   6866>>ASSIGN   6868<<ASSIGN
      6868>>ASSIGN   6896<<ASSIGN   6898<<ASSIGN   6899<>CALL     6910<<ASSIGN   6912<<ASSIGN   6915<>CALL
      6917<>CALL     6919<>CALL     6922<>CALL     6947<<ASSIGN   6951<<ASSIGN   6952>>IF       6952<<ASSIGN
      6953<>CALL     6957<>CALL     6961<>CALL     6962<>CALL     6963<>CALL     6992<<DOINDEX  6993>>CALLBLT
      6993>>CALLBLT  6994>>CALLBLT  6994>>CALLBLT  7079<<DOINDEX  7080>>IF       7081>>CALLBLT  7082>>IF
      7083>>CALLBLT  7083>>CALLBLT  7085>>CALLBLT  7085>>CALLBLT  7156<<ASSIGN   7157>>ASSIGN   7158>>DOUNTIL
      7159>>IF       7183<<ASSIGN   7183>>ASSIGN   7184<<ASSIGN   7184>>ASSIGN   7277<<ASSIGN   7278<<ASSIGN
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:243  
      7280>>CALLBLT  7280>>CALLBLT  7281>>ASSIGN
IDX IN PROCEDURE FIELD
      7497**DCL      7503<<CALLBLT  7504>>ASSIGN   7505>>ASSIGN   7508<<CALLBLT  7509>>ASSIGN   7580<<ASSIGN
      7582>>ASSIGN   7584<<ASSIGN   7585>>ASSIGN   7588>>ASSIGN   7590<<ASSIGN   7595>>ASSIGN   7599<<ASSIGN
      7600>>DOUNTIL  7601>>IF       7601>>IF       7601>>IF       7601>>IF       7601>>IF       7601>>IF
      7604>>ASSIGN   7604>>ASSIGN   7605<<ASSIGN   7605>>ASSIGN   7607>>ASSIGN   7608<<ASSIGN   7608>>ASSIGN
      7609>>ASSIGN   7609>>ASSIGN   7609>>ASSIGN
LOOPING
       297**DCL      6784<<ASSIGN   6785>>DOWHILE  6791<<ASSIGN   6795>>ASSIGN   7257>>IF       7260<<ASSIGN
M.BA IN PROCEDURE GETMEM
      7376**DCL      7382<<ASSIGN   7382>>ASSIGN
M.BT IN PROCEDURE GETMEM
      7377**DCL      7381>>IF       7383>>ASSIGN   7384<<ASSIGN
M.B IN PROCEDURE GETVAL
      7410**DCL      7434>>CALLBLT  7438>>IF       7450>>IF       7451<<ASSIGN   7454>>ASSIGN   7463>>IF
M$ IN PROCEDURE GETMEM
      7374**DCL      7373--PROC     7375--REDEF    7380<<ASSIGN   7385>>ASSIGN
M$ IN PROCEDURE GETVAL
      7406**DCL      7407--REDEF    7426<<ASSIGN   7430>>ASSIGN   7448<<ASSIGN   7455>>ASSIGN   7457<<ASSIGN
      7457>>ASSIGN   7460>>ASSIGN   7466>>ASSIGN
M$DEVICE
      5975**DCL-ENT  6941--CALL
M$TIME
      6038**DCL-ENT  7067--CALL
M$WRITE
      5972**DCL-ENT  7342--CALL     7594--CALL
MEM$
       350**DCL      6892<>CALL     6928<>CALL     6931<<ASSIGN   6935>>CALLBLT  6948<<ASSIGN   6953<>CALL
      6957>>CALL     6962<>CALL     6963>>CALL
MEMVEC
       293**DCL      7313>>IF
MEMVEC.BOUND
       294**DCL      6914>>IF       7315>>ASSIGN
MEMVEC.PTR$
       296**DCL      7314>>ASSIGN   7430>>ASSIGN
NO_MEM
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:244  
      7269**LABEL    6925--CALLALT  6953--CALLALT  6961--CALLALT  6962--CALLALT  6978--CALLALT  6990--CALLALT
      6999--CALLALT  7002--CALLALT  7005--CALLALT  7044--CALLALT  7071--CALLALT  7106--CALLALT  7107--CALLALT
      7111--CALLALT  7115--CALLALT  7120--CALLALT
NO_MEM IN PROCEDURE NUMERIC
      7673**LABEL    7615--CALLALT
NO_MEM IN PROCEDURE SETMEM
      7322**LABEL    7312--GOTO
NUMBUF
       353**DCL      6981<<CALLBLT  6985<<CALLBLT  6991<<ASSIGN   6993<<CALLBLT  6994<<CALLBLT  7052--ASSIGN
      7055--ASSIGN   7058--ASSIGN   7059--ASSIGN   7062--ASSIGN   7063--ASSIGN   7066<<ASSIGN   7068<>CALL
      7078<<ASSIGN   7081<<CALLBLT  7083<<CALLBLT  7085<<CALLBLT  7088<<CALLBLT  7090<<CALLBLT  7091<<CALLBLT
      7092<<CALLBLT  7093<<CALLBLT  7094<>CALL     7627<<CALLBLT  7633<<CALLBLT  7639<<CALLBLT  7645>>DOWHILE
      7652<<CALLBLT  7654<>CALL     7657<<ASSIGN   7660<<CALLBLT  7661<<CALLBLT  7662<>CALL     7667<<CALLBLT
      7669<>CALL
NUMERIC
      7613**PROC     6999--CALL     7002--CALL     7005--CALL
NUMERIC1 IN PROCEDURE NUMERIC
      7643**ENTRY    6987--CALL     6996--CALL
NUMERIC2 IN PROCEDURE NUMERIC
      7649**LABEL    7642--GOTO
ONEBIT
       372**DCL      7443>>IF
ONECHAR
       371**DCL      6935>>CALLBLT  6957<>CALL     6963<>CALL
PERCENT
       349**DCL      6780<<ASSIGN   6788<<CALLBLT  6790<<ASSIGN   6793>>IF       6794>>CALL     6794>>CALL
      6796>>ASSIGN   6883>>IF       7193>>ASSIGN   7201>>IF       7266<<ASSIGN   7269<<ASSIGN   7272>>ASSIGN
      7289>>IF       7291>>IF       7293>>IF       7573>>IF       7576>>ASSIGN   7588>>ASSIGN   7607>>ASSIGN
      7609>>ASSIGN
RADIX IN PROCEDURE NUMERIC
      7614**DCL      7613--PROC     7624>>IF       7630>>IF       7636>>IF
SAVCNT
       340**DCL       341--REDEF    6813>>ASSIGN   6823>>ASSIGN   6971>>ASSIGN   7027>>ASSIGN   7033>>ASSIGN
      7099>>ASSIGN   7189>>ASSIGN   7197<<ASSIGN   7226>>ASSIGN   7230<<ASSIGN   7237>>CALLBLT  7240>>ASSIGN
SAVCNTB
       341**DCL      7128>>ASSIGN   7143>>ASSIGN   7251>>ASSIGN
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:245  
SAVEFMTX
       291**DCL      6779--CALLBLT  6783<<ASSIGN   6882>>IF       6883>>ASSIGN   7192>>IF       7202>>IF
SEARCHNB
      6585**DCL      7503>>CALLBLT  7508>>CALLBLT
SETMEM
      7303**PROC     6774--CALL     6889--CALL     6915--CALL     6917--CALL     6919--CALL     6922--CALL
      7386--CALL     7389--CALL     7394--CALL     7423--CALL     7473--CALL     7481--CALL
SIGNC
       351**DCL      6787<<ASSIGN   6980<<ASSIGN   6984<<ASSIGN   7617<<ASSIGN   7621<<ASSIGN   7650>>IF
      7652>>CALLBLT  7661>>IF       7661>>CALLBLT  7665>>IF       7667>>CALLBLT
SIZ IN PROCEDURE FIELD
      7491**DCL      7489--PROC     7501>>ASSIGN
SKIPBITS
      7477**PROC     6899--CALL
SKIP_WRITE IN PROCEDURE BUF_OUT
      7339**LABEL    7333--CALLALT
STARS
       354**DCL      7657>>ASSIGN
STEMP
       300**DCL      6979>>IF       6981>>CALLBLT  7616>>IF       7618<<ASSIGN   7618>>ASSIGN
STR IN PROCEDURE FIELD
      7494**DCL      7503>>CALLBLT  7508>>CALLBLT  7530>>CALLBLT  7546>>CALLBLT  7554>>CALLBLT  7560>>CALLBLT
      7568>>CALLBLT
STR$ IN PROCEDURE FIELD
      7493**DCL      7494--IMP-PTR  7500<<ASSIGN   7503>>CALLBLT  7504<<ASSIGN   7504>>ASSIGN   7508>>CALLBLT
      7530>>CALLBLT  7534<<ASSIGN   7534>>ASSIGN   7536<<ASSIGN   7546>>CALLBLT  7554>>CALLBLT  7560>>CALLBLT
      7568>>CALLBLT
STRING IN PROCEDURE FIELD
      7490**DCL      7489--PROC     7500--ASSIGN
STRSIZ IN PROCEDURE FIELD
      7495**DCL      7494--IMP-SIZ  7501<<ASSIGN   7503>>CALLBLT  7505<<ASSIGN   7505>>ASSIGN   7508>>CALLBLT
      7509<<ASSIGN   7511<<ASSIGN   7514>>ASSIGN   7521>>DOWHILE  7522>>IF       7523>>ASSIGN   7530>>CALLBLT
      7533<<ASSIGN   7533>>ASSIGN   7534>>IF       7537<<ASSIGN   7543>>IF       7546>>CALLBLT  7550<<ASSIGN
      7550>>ASSIGN   7551>>IF       7551<<ASSIGN   7554>>CALLBLT  7554>>CALLBLT  7560>>CALLBLT  7564<<ASSIGN
      7564>>ASSIGN   7565>>IF       7565<<ASSIGN   7568>>CALLBLT  7568>>CALLBLT  7568>>CALLBLT  7576<<ASSIGN
      7579>>IF       7580>>ASSIGN   7582>>ASSIGN   7585>>ASSIGN   7588>>ASSIGN   7588>>ASSIGN
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:246  
STR_DUMP
      6742**DCL      6775--ASSIGN   6959--ASSIGN
TABLEVAL IN PROCEDURE FIELD
      7498**DCL      7503<<CALLBLT  7508<<CALLBLT
TEMP
       299**DCL       300--REDEF     301--REDEF     305--REDEF     308--REDEF     311--REDEF    6978<>CALL
      6985>>CALLBLT  6990<>CALL     7053<<ASSIGN   7056<<ASSIGN   7060<<ASSIGN   7064<<ASSIGN   7068<>CALL
      7211<<ASSIGN   7212>>IF       7212>>IF       7213>>ASSIGN   7225<<ASSIGN   7229<<ASSIGN   7233>>IF
      7236>>CALLBLT  7240>>ASSIGN   7242<<ASSIGN   7243>>IF       7244>>IF       7244>>ASSIGN   7245>>ASSIGN
      7615<>CALL     7625>>DOUNTIL  7628<<ASSIGN   7631>>DOUNTIL  7634<<ASSIGN   7637>>DOUNTIL  7640<<ASSIGN
TEMPB.LSB
       307**DCL      7633>>CALLBLT
TEMPB.REST
       306**DCL      7634>>ASSIGN
TEMPO.LSD
       310**DCL      7627>>CALLBLT
TEMPO.REST
       309**DCL      7628>>ASSIGN
TEMPX.LSD
       313**DCL      7639>>CALLBLT
TEMPX.REST
       312**DCL      7640>>ASSIGN
TEMPY.LH
       303**DCL      6993>>CALLBLT
TEMPY.RH
       304**DCL      6994>>CALLBLT
TIMEDEST
      6741**DCL      7049>>ASSIGN
TIMEWIDTH
      6740**DCL      7039>>ASSIGN
TRANS
      6770**DCL      7530>>CALLBLT  7546>>CALLBLT  7554>>CALLBLT  7560>>CALLBLT  7568>>CALLBLT
TRANS$
      6769**DCL      6770--IMP-PTR  6775<<ASSIGN   6955<<ASSIGN   6956<<ASSIGN   6959<<ASSIGN   7530>>CALLBLT
      7546>>CALLBLT  7554>>CALLBLT  7560>>CALLBLT  7568>>CALLBLT
TWID
PL6.E3A0      #002=XUF$FORMAT1 File=XUF$FORMAT.:E05TSI                           WED 07/30/97 09:15 Page:247  
       361**DCL      7039<<ASSIGN   7053>>ASSIGN   7058>>ASSIGN   7059>>ASSIGN   7060>>ASSIGN   7063>>ASSIGN
      7064>>ASSIGN
V IN PROCEDURE GETVAL
      7399**DCL      7398--PROC     7412--IF       7413<<ASSIGN   7443<<ASSIGN   7444<<ASSIGN   7447--ASSIGN
      7466--ASSIGN   7469--ASSIGN
V$ IN PROCEDURE GETVAL
      7405**DCL      7447<<ASSIGN   7455>>ASSIGN   7456<<ASSIGN   7456>>ASSIGN
VALBASE IN PROCEDURE GETVAL
      7402**DCL      7455<<ASSIGN   7455>>ASSIGN   7469<<ASSIGN   7469>>ASSIGN
VALBASEC IN PROCEDURE GETVAL
      7404**DCL      7466<<ASSIGN   7466>>ASSIGN
WRAPENT IN PROCEDURE BUF_OUT
      7329**LABEL    7363--GOTO
X
       358**DCL      6859<<CALLBLT  6861<<CALLBLT  6863>>IF       7044<>CALL     7045--ASSIGN   7173<<CALLBLT
      7175<<CALLBLT  7177>>IF       7177>>ASSIGN   7179>>IF       7275<<ASSIGN   7276<<ASSIGN   7280>>CALLBLT
      7280>>CALLBLT  7280>>CALLBLT  7281>>ASSIGN   7285>>CALLBLT  7286>>ASSIGN   7522<<ASSIGN   7523<<ASSIGN
      7524>>CALLBLT  7525>>ASSIGN   7527>>ASSIGN   7531<<ASSIGN   7532>>ASSIGN   7533>>ASSIGN   7534>>ASSIGN
X IN PROCEDURE SETMEM
      7304**DCL      7303--PROC     7307>>ASSIGN
XUF$DESC
       284**DCL-ENT  7108--CALL
XUF$ERRMSG
       286**DCL-ENT  7074--CALL
XUF$FORMAT1
         6**PROC     6875--CALL     7163--CALL     7215--CALL
XUF$PTR
       285**DCL-ENT  7112--CALL
XUF$UNFID
       287**DCL-ENT  7117--CALL
ZEROES
       355**DCL      7660>>CALLBLT

PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:248  
     1390        1        /*T***********************************************************/
     1391        2        /*T*                                                         */
     1392        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1393        4        /*T*                                                         */
     1394        5        /*T***********************************************************/
     1395        6        XUF$DESC: PROC(DESC,BUF,SIZ);
     1396        7    1   DCL DESC VECTOR;
     1397        8    1   DCL 1 DCB# REDEF DESC,
     1398        9    1         2 N UBIN,
     1399       10    1         2 * UBIN;
     1400       11    1   DCL 1 ERRCD REDEF DESC,
     1401       12    1         2 CODE# BIT(36),
     1402       13    1         2 DCB# SBIN;
     1403       14    1   DCL BUF CHAR(120);
     1404       15    1   DCL SIZ SBIN;
     1405       16        /**/
     1406       17    1   DCL XUF$FORMAT ENTRY(1);
     1407       18        /**/
     1408       19    1   DCL 1 DFMT CONSTANT,
     1409       20    1         2 * CHAR(0) INIT('.%.1P%.34O-%.2O,BD=.%P%.18O-%.2O,'),
     1410       21    1         2 * CHAR(0) INIT('%12N=%0.3N[WSR=%.#:7&KD%#:8/='),
     1411       22    1         2 * CHAR(0) INIT('%1?WSQ=%.#:511&KD%#:512/='),
     1412       23    1         2 * CHAR(0) INIT('%?$?%%#!%],FL=.%.#KO,TY=%...32P%.4D%2P%Q');
     1413       24    1   DCL PFMT CHAR(0) CONSTANT
     1414       25    1   INIT('.%.18O-%.2D-%.4D,$%.2N[P%2?A%3?L%??%]S%.10D%2P%Q');
     1415       26
     1416       27        %INCLUDE CP_6;
     1417     5586              %FPT_UNFID (FPTN=FPT_UNFID_CONSTANT,
     1418     5587                          STCLASS=CONSTANT);
     1419     5605
     1420     5606              %FPT_UNFID (STCLASS=AUTO);
     1421     5624              %FPT_ERRMSG (FPTN=FPT_ERRMSG_CONSTANT,
     1422     5625                           STCLASS=CONSTANT, SUBMESS=YES, INCLCODE=NO);
     1423     5652
     1424     5653              %FPT_ERRMSG (STCLASS=AUTO);
     1425     5680
     1426     5681    1   DCL BVEC VECTOR BASED ALIGNED;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:249  
     1427     5682        /**/
     1428     5683        %INCLUDE XU_FORMAT_C;
     1429     5845        %F_FDS (NAME=CFDS,NVECS=1,TRUNC=YES,STCLASS=CONSTANT);
     1430     5958        %F_FDS (NAME=AFDS,STCLASS=AUTO);
     1431     6071    1   DCL VECTR BIT(72);
     1432     6072        %EJECT;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:250  
     1433     6073    1           VECTR=VECTOR(DFMT);
     1434     6074    1           GOTO FMTDP;
     1435     6075    1   XUF$PTR: ENTRY(DESC,BUF,SIZ);
     1436     6076    1           VECTR=VECTOR(PFMT);
     1437     6077    1   FMTDP:  ;
     1438     6078    1           AFDS=CFDS;
     1439     6079    1           AFDS.VECTR$=ADDR(VECTR);
     1440     6080    1           AFDS.FMT_=VECTR;
     1441     6081    1           VECTR=VECTOR(DESC);
     1442     6082    1           AFDS.BUF_=VECTOR(BUF);
     1443     6083    1           CALL XUF$FORMAT(AFDS);
     1444     6084    1           SIZ=AFDS.BUFX-1;
     1445     6085    1           RETURN;
     1446     6086        %EJECT;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:251  
     1447     6087    1   XUF$UNFID: ENTRY (DESC, BUF, SIZ);
     1448     6088        /*
     1449     6089        **    Perform an M$UNFID of DCB# into BUF & SIZ.
     1450     6090        */
     1451     6091    1           FPT_UNFID = FPT_UNFID_CONSTANT;
     1452     6092    1           VBASE(ADDR(FPT_UNFID.V_)->BVEC) = ADDR(FPT_UNFID.V);
     1453     6093    1           FPT_UNFID.V.DCB# = DCB#.N;
     1454     6094    1           IF SIZ = 1 THEN FPT_UNFID.V.FORCE# = '1'B;
     1455     6095    1           FPT_UNFID.TEXTFID_ = VECTOR(BUF);
     1456     6096    1           FPT_UNFID.LEN_ = VECTOR(SIZ);
     1457     6097    2           CALL M$UNFID (FPT_UNFID) WHENALTRETURN DO; END;
     1458     6098    1           RETURN;
     1459     6099        %EJECT;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:252  
     1460     6100    1   XUF$ERRMSG: ENTRY (DESC, BUF, SIZ);
     1461     6101    1           FPT_ERRMSG = FPT_ERRMSG_CONSTANT;
     1462     6102    1           VBASE(ADDR(FPT_ERRMSG.V_)->BVEC) = ADDR(FPT_ERRMSG.V);
     1463     6103    1           FPT_ERRMSG.CODE_ = VECTOR (ERRCD.CODE#);
     1464     6104    1           FPT_ERRMSG.V.DCB# = ERRCD.DCB#;
     1465     6105    1           FPT_ERRMSG.BUF_ = VECTOR (BUF);
     1466     6106    1           BUF = ' ';
     1467     6107    2           CALL M$ERRMSG (FPT_ERRMSG) WHENALTRETURN DO;
     1468     6108    2              BUF = ' ';
     1469     6109    2              END;
     1470     6110    1           SIZ = -1;
     1471     6111    2           DO UNTIL SUBSTR(BUF,SIZ)=' ';
     1472     6112    3              CALL INDEX (SIZ, ' ', BUF,SIZ+1) WHENALTRETURN DO;
     1473     6113    3                 RETURN;
     1474     6114    3                 END;
     1475     6115    2              END;
     1476     6116    1           RETURN;
     1477     6117    1   END XUF$DESC;
     1478     6118        %EOD;

PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:253  
--  Include file information  --

   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUF$DESC.

   Procedure XUF$DESC requires 125 words for executable code.
   Procedure XUF$DESC requires 88 words of local(AUTO) storage.

PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:254  

 Object Unit name= XUF$DESC                                   File name= XUF$FORMAT.:E05TOU
 UTS= JUL 30 '97 09:17:09.36 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    122    172  XUF$DESC
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   125    175  XUF$DESC
    3  RoData even  none     6      6  XUF$DESC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        3  XUF$DESC
     2      5                  yes      Std        3  XUF$PTR
     2     42                  yes      Std        3  XUF$UNFID
     2     76                  yes      Std        3  XUF$ERRMSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 XUF$FORMAT
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:255  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:256  


     1390        1        /*T***********************************************************/
     1391        2        /*T*                                                         */
     1392        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1393        4        /*T*                                                         */
     1394        5        /*T***********************************************************/
     1395        6        XUF$DESC: PROC(DESC,BUF,SIZ);

      6  2 000000   000000 700200 xent  XUF$DESC     TSX0  ! X66_AUTO_3
         2 000001   000130 000003                    ZERO    88,3

     1396        7    1   DCL DESC VECTOR;
     1397        8    1   DCL 1 DCB# REDEF DESC,
     1398        9    1         2 N UBIN,
     1399       10    1         2 * UBIN;
     1400       11    1   DCL 1 ERRCD REDEF DESC,
     1401       12    1         2 CODE# BIT(36),
     1402       13    1         2 DCB# SBIN;
     1403       14    1   DCL BUF CHAR(120);
     1404       15    1   DCL SIZ SBIN;
     1405       16        /**/
     1406       17    1   DCL XUF$FORMAT ENTRY(1);
     1407       18        /**/
     1408       19    1   DCL 1 DFMT CONSTANT,
     1409       20    1         2 * CHAR(0) INIT('.%.1P%.34O-%.2O,BD=.%P%.18O-%.2O,'),
     1410       21    1         2 * CHAR(0) INIT('%12N=%0.3N[WSR=%.#:7&KD%#:8/='),
     1411       22    1         2 * CHAR(0) INIT('%1?WSQ=%.#:511&KD%#:512/='),
     1412       23    1         2 * CHAR(0) INIT('%?$?%%#!%],FL=.%.#KO,TY=%...32P%.4D%2P%Q');
     1413       24    1   DCL PFMT CHAR(0) CONSTANT
     1414       25    1   INIT('.%.18O-%.2D-%.4D,$%.2N[P%2?A%3?L%??%]S%.10D%2P%Q');
     1415       26
     1416       27        %INCLUDE CP_6;
     1417     5586              %FPT_UNFID (FPTN=FPT_UNFID_CONSTANT,
     1418     5587                          STCLASS=CONSTANT);
     1419     5605
     1420     5606              %FPT_UNFID (STCLASS=AUTO);
     1421     5624              %FPT_ERRMSG (FPTN=FPT_ERRMSG_CONSTANT,
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:257  
     1422     5625                           STCLASS=CONSTANT, SUBMESS=YES, INCLCODE=NO);
     1423     5652
     1424     5653              %FPT_ERRMSG (STCLASS=AUTO);
     1425     5680
     1426     5681    1   DCL BVEC VECTOR BASED ALIGNED;
     1427     5682        /**/
     1428     5683        %INCLUDE XU_FORMAT_C;
     1429     5845        %F_FDS (NAME=CFDS,NVECS=1,TRUNC=YES,STCLASS=CONSTANT);
     1430     5958        %F_FDS (NAME=AFDS,STCLASS=AUTO);
     1431     6071    1   DCL VECTR BIT(72);
     1432     6072        %EJECT;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:258  
     1433     6073    1           VECTR=VECTOR(DFMT);

   6073  2 000002   000000 237000 3                  LDAQ    0
         2 000003   200124 757100                    STAQ    VECTR,,AUTO

     1434     6074    1           GOTO FMTDP;

   6074  2 000004   000011 710000 2                  TRA     FMTDP

     1435     6075    1   XUF$PTR: ENTRY(DESC,BUF,SIZ);

   6075  2 000005   000000 700200 xent  XUF$PTR      TSX0  ! X66_AUTO_3
         2 000006   000130 000003                    ZERO    88,3

     1436     6076    1           VECTR=VECTOR(PFMT);

   6076  2 000007   000002 237000 3                  LDAQ    2
         2 000010   200124 757100                    STAQ    VECTR,,AUTO

   6076  2 000011                       FMTDP        null
     1437     6077    1   FMTDP:  ;
     1438     6078    1           AFDS=CFDS;

   6078  2 000011   000100 100400                    MLR     fill='000'O
         2 000012   000134 000170 0                  ADSC9   CFDS                     cn=0,n=120
         2 000013   200066 000170                    ADSC9   AFDS,,AUTO               cn=0,n=120

     1439     6079    1           AFDS.VECTR$=ADDR(VECTR);

   6079  2 000014   200124 630500                    EPPR0   VECTR,,AUTO
         2 000015   200100 450500                    STP0    AFDS+10,,AUTO

     1440     6080    1           AFDS.FMT_=VECTR;

   6080  2 000016   200124 237100                    LDAQ    VECTR,,AUTO
         2 000017   200066 757100                    STAQ    AFDS,,AUTO

PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:259  
     1441     6081    1           VECTR=VECTOR(DESC);

   6081  2 000020   000004 235000 3                  LDA     4
         2 000021   200003 236100                    LDQ     @DESC,,AUTO
         2 000022   200124 757100                    STAQ    VECTR,,AUTO

     1442     6082    1           AFDS.BUF_=VECTOR(BUF);

   6082  2 000023   000005 235000 3                  LDA     5
         2 000024   200004 236100                    LDQ     @BUF,,AUTO
         2 000025   200073 755100                    STA     AFDS+5,,AUTO
         2 000026   200074 756100                    STQ     AFDS+6,,AUTO

     1443     6083    1           CALL XUF$FORMAT(AFDS);

   6083  2 000027   200066 631500                    EPPR1   AFDS,,AUTO
         2 000030   200126 451500                    STP1    VECTR+2,,AUTO
         2 000031   200126 630500                    EPPR0   VECTR+2,,AUTO
         2 000032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000033   000000 701000 xent               TSX1    XUF$FORMAT
         2 000034   000000 011000                    NOP     0

     1444     6084    1           SIZ=AFDS.BUFX-1;

   6084  2 000035   200005 470500                    LDP0    @SIZ,,AUTO
         2 000036   200075 235100                    LDA     AFDS+7,,AUTO
         2 000037   000001 135007                    SBLA    1,DL
         2 000040   000000 755100                    STA     0,,PR0

     1445     6085    1           RETURN;

   6085  2 000041   000000 702200 xent               TSX2  ! X66_ARET

     1446     6086        %EJECT;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:260  
     1447     6087    1   XUF$UNFID: ENTRY (DESC, BUF, SIZ);

   6087  2 000042   000000 700200 xent  XUF$UNFID    TSX0  ! X66_AUTO_3
         2 000043   000130 000003                    ZERO    88,3

     1448     6088        /*
     1449     6089        **    Perform an M$UNFID of DCB# into BUF & SIZ.
     1450     6090        */
     1451     6091    1           FPT_UNFID = FPT_UNFID_CONSTANT;

   6091  2 000044   000100 100400                    MLR     fill='000'O
         2 000045   000054 000130 0                  ADSC9   FPT_UNFID_CONSTANT       cn=0,n=88
         2 000046   200006 000130                    ADSC9   FPT_UNFID,,AUTO          cn=0,n=88

     1452     6092    1           VBASE(ADDR(FPT_UNFID.V_)->BVEC) = ADDR(FPT_UNFID.V);

   6092  2 000047   200032 630500                    EPPR0   FPT_UNFID+20,,AUTO
         2 000050   200007 450500                    STP0    FPT_UNFID+1,,AUTO

     1453     6093    1           FPT_UNFID.V.DCB# = DCB#.N;

   6093  2 000051   200003 471500                    LDP1    @DESC,,AUTO
         2 000052   100000 720100                    LXL0    0,,PR1
         2 000053   200032 740100                    STX0    FPT_UNFID+20,,AUTO

     1454     6094    1           IF SIZ = 1 THEN FPT_UNFID.V.FORCE# = '1'B;

   6094  2 000054   200005 473500                    LDP3    @SIZ,,AUTO
         2 000055   300000 235100                    LDA     0,,PR3
         2 000056   000001 115007                    CMPA    1,DL
         2 000057   000062 601000 2                  TNZ     s:6095

   6094  2 000060   400000 236007                    LDQ     -131072,DL
         2 000061   200032 256100                    ORSQ    FPT_UNFID+20,,AUTO

     1455     6095    1           FPT_UNFID.TEXTFID_ = VECTOR(BUF);

PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:261  
   6095  2 000062   000005 235000 3                  LDA     5
         2 000063   200004 236100                    LDQ     @BUF,,AUTO
         2 000064   200010 757100                    STAQ    FPT_UNFID+2,,AUTO

     1456     6096    1           FPT_UNFID.LEN_ = VECTOR(SIZ);

   6096  2 000065   777640 235007                    LDA     -96,DL
         2 000066   200005 236100                    LDQ     @SIZ,,AUTO
         2 000067   200030 757100                    STAQ    FPT_UNFID+18,,AUTO

     1457     6097    2           CALL M$UNFID (FPT_UNFID) WHENALTRETURN DO; END;

   6097  2 000070   200006 630500                    EPPR0   FPT_UNFID,,AUTO
         2 000071   420021 713400                    CLIMB   alt,+8209
         2 000072   404400 401760                    pmme    nvectors=10
         2 000073   000075 702000 2                  TSX2    s:6098
         2 000074   000075 710000 2                  TRA     s:6098

     1458     6098    1           RETURN;

   6098  2 000075   000000 702200 xent               TSX2  ! X66_ARET

     1459     6099        %EJECT;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:262  
     1460     6100    1   XUF$ERRMSG: ENTRY (DESC, BUF, SIZ);

   6100  2 000076   000000 700200 xent  XUF$ERRMSG   TSX0  ! X66_AUTO_3
         2 000077   000130 000003                    ZERO    88,3

     1461     6101    1           FPT_ERRMSG = FPT_ERRMSG_CONSTANT;

   6101  2 000100   000100 100400                    MLR     fill='000'O
         2 000101   000102 000150 0                  ADSC9   FPT_ERRMSG_CONSTANT      cn=0,n=104
         2 000102   200034 000150                    ADSC9   FPT_ERRMSG,,AUTO         cn=0,n=104

     1462     6102    1           VBASE(ADDR(FPT_ERRMSG.V_)->BVEC) = ADDR(FPT_ERRMSG.V);

   6102  2 000103   200062 630500                    EPPR0   FPT_ERRMSG+22,,AUTO
         2 000104   200035 450500                    STP0    FPT_ERRMSG+1,,AUTO

     1463     6103    1           FPT_ERRMSG.CODE_ = VECTOR (ERRCD.CODE#);

   6103  2 000105   777640 235007                    LDA     -96,DL
         2 000106   200003 236100                    LDQ     @DESC,,AUTO
         2 000107   200036 757100                    STAQ    FPT_ERRMSG+2,,AUTO

     1464     6104    1           FPT_ERRMSG.V.DCB# = ERRCD.DCB#;

   6104  2 000110   200003 471500                    LDP1    @DESC,,AUTO
         2 000111   100001 720100                    LXL0    1,,PR1
         2 000112   200062 740100                    STX0    FPT_ERRMSG+22,,AUTO

     1465     6105    1           FPT_ERRMSG.BUF_ = VECTOR (BUF);

   6105  2 000113   000005 235000 3                  LDA     5
         2 000114   200004 236100                    LDQ     @BUF,,AUTO
         2 000115   200040 757100                    STAQ    FPT_ERRMSG+4,,AUTO

     1466     6106    1           BUF = ' ';

   6106  2 000116   200004 473500                    LDP3    @BUF,,AUTO
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:263  
         2 000117   040100 100400                    MLR     fill='040'O
         2 000120   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000121   300000 000170                    ADSC9   0,,PR3                   cn=0,n=120

     1467     6107    2           CALL M$ERRMSG (FPT_ERRMSG) WHENALTRETURN DO;

   6107  2 000122   200034 630500                    EPPR0   FPT_ERRMSG,,AUTO
         2 000123   420000 713400                    CLIMB   alt,+8192
         2 000124   405000 401760                    pmme    nvectors=11
         2 000125   000127 702000 2                  TSX2    s:6108
         2 000126   000133 710000 2                  TRA     s:6110

     1468     6108    2              BUF = ' ';

   6108  2 000127   200004 470500                    LDP0    @BUF,,AUTO
         2 000130   040100 100400                    MLR     fill='040'O
         2 000131   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000132   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120

     1469     6109    2              END;

     1470     6110    1           SIZ = -1;

   6110  2 000133   000001 335007                    LCA     1,DL
         2 000134   200005 470500                    LDP0    @SIZ,,AUTO
         2 000135   000000 755100                    STA     0,,PR0

     1471     6111    2           DO UNTIL SUBSTR(BUF,SIZ)=' ';

     1472     6112    3              CALL INDEX (SIZ, ' ', BUF,SIZ+1) WHENALTRETURN DO;

   6112  2 000136   200005 470500                    LDP0    @SIZ,,AUTO
         2 000137   000000 235100                    LDA     0,,PR0
         2 000140   200126 755100                    STA     VECTR+2,,AUTO
         2 000141   000000 235100                    LDA     0,,PR0
         2 000142   000027 675000 xsym               ERA     B_VECTNIL+23
         2 000143   000170 035007                    ADLA    120,DL
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:264  
         2 000144   000000 236100                    LDQ     0,,PR0
         2 000145   000001 036007                    ADLQ    1,DL
         2 000146   200004 471500                    LDP1    @BUF,,AUTO
         2 000147   000000 620005                    EAX0    0,AL
         2 000150   200126 235100                    LDA     VECTR+2,,AUTO
         2 000151   000000 124545                    SCM     mask='000'O
         2 000152   100000 200010                    ADSC9   0,A,PR1                  cn=1,n=*X0
         2 000153   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000154   000000 000100                    ARG     0,,PR0
         2 000155   000000 056100                    ASQ     0,,PR0
         2 000156   000160 606400 2                  TTN     s:6113
         2 000157   000161 710000 2                  TRA     s:6115

     1473     6113    3                 RETURN;

   6113  2 000160   000000 702200 xent               TSX2  ! X66_ARET

     1474     6114    3                 END;
     1475     6115    2              END;

   6115  2 000161   000000 235100                    LDA     0,,PR0
         2 000162   200126 755100                    STA     VECTR+2,,AUTO
         2 000163   000000 235100                    LDA     0,,PR0
         2 000164   000027 675000 xsym               ERA     B_VECTNIL+23
         2 000165   000171 035007                    ADLA    121,DL
         2 000166   000000 620005                    EAX0    0,AL
         2 000167   200126 235100                    LDA     VECTR+2,,AUTO
         2 000170   040000 106545                    CMPC    fill='040'O
         2 000171   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 000172   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000173   000136 601000 2                  TNZ     s:6112

     1476     6116    1           RETURN;

   6116  2 000174   000000 702200 xent               TSX2  ! X66_ARET
     1477     6117    1   END XUF$DESC;
     1478     6118        %EOD;
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:265  

PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:266  
--  Include file information  --

   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUF$DESC.
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:267  

 **** Variables and constants ****

  ****  Section 000 RoData XUF$DESC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   134-0-0/w STRC(1080)  r     1 CFDS                       0-0-0/c STRC(1143)  r     1 DFMT
   102-0-0/d STRC(936)   r     1 FPT_ERRMSG_CONSTANT       54-0-0/d STRC(792)   r     1 FPT_UNFID_CONSTANT
    40-0-0/c CHAR(48)    r     1 PFMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF                       3-0-0/w PTR         r     1 @DESC
     5-0-0/w PTR         r     1 @SIZ                      66-0-0/w STRC(1080)  r     1 AFDS
    *0-0-0/c CHAR(120)   r     1 BUF                       *0-0-0/d STRC(72)    r     1 DCB#
    *0-0-0/d VECT        r     1 DESC                      *0-0-0/d STRC(72)    r     1 ERRCD
    34-0-0/d STRC(936)   r     1 FPT_ERRMSG                 6-0-0/d STRC(792)   r     1 FPT_UNFID
    *0-0-0/w SBIN        r     1 SIZ                      124-0-0/b BIT (72)    r     1 VECTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w VECT        r     1 BVEC


   Procedure XUF$DESC requires 125 words for executable code.
   Procedure XUF$DESC requires 88 words of local(AUTO) storage.
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:268  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:269  
          MINI XREF LISTING

AFDS
      5972**DCL      6078<<ASSIGN   6083<>CALL
AFDS.BUFX
      5996**DCL      6084>>ASSIGN
AFDS.BUF_
      5989**DCL      6082<<ASSIGN
AFDS.FMT_
      5976**DCL      6080<<ASSIGN
AFDS.VECTR$
      6002**DCL      6079<<ASSIGN
BUF
        14**DCL         6--PROC     6075--ENTRY    6082--ASSIGN   6087--ENTRY    6095--ASSIGN   6100--ENTRY
      6105--ASSIGN   6106<<ASSIGN   6108<<ASSIGN   6111>>DOUNTIL  6112>>CALLBLT
BVEC
      5681**DCL      6092<<ASSIGN   6102<<ASSIGN
CFDS
      5859**DCL      6078>>ASSIGN
DCB#.N
         9**DCL      6093>>ASSIGN
DESC
         7**DCL         6--PROC        8--REDEF      11--REDEF    6075--ENTRY    6081--ASSIGN   6087--ENTRY
      6100--ENTRY
DFMT
        19**DCL      6073--ASSIGN
ERRCD.CODE#
        12**DCL      6103--ASSIGN
ERRCD.DCB#
        13**DCL      6104>>ASSIGN
FMTDP
      6076**LABEL    6074--GOTO
FPT_ERRMSG
      5664**DCL      6101<<ASSIGN   6107<>CALL
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:270  
FPT_ERRMSG.BUF_
      5664**DCL      6105<<ASSIGN
FPT_ERRMSG.CODE_
      5664**DCL      6103<<ASSIGN
FPT_ERRMSG.V
      5668**DCL      6102--ASSIGN
FPT_ERRMSG.V.DCB#
      5668**DCL      6104<<ASSIGN
FPT_ERRMSG.V_
      5664**DCL      6102--ASSIGN
FPT_ERRMSG_CONSTANT
      5636**DCL      6101>>ASSIGN
FPT_ERRMSG_CONSTANT.V
      5640**DCL      5636--DCLINIT
FPT_UNFID
      5617**DCL      6091<<ASSIGN   6097<>CALL
FPT_UNFID.LEN_
      5620**DCL      6096<<ASSIGN
FPT_UNFID.TEXTFID_
      5617**DCL      6095<<ASSIGN
FPT_UNFID.V
      5621**DCL      6092--ASSIGN
FPT_UNFID.V.DCB#
      5621**DCL      6093<<ASSIGN
FPT_UNFID.V.FORCE#
      5621**DCL      6094<<ASSIGN
FPT_UNFID.V_
      5617**DCL      6092--ASSIGN
FPT_UNFID_CONSTANT
      5598**DCL      6091>>ASSIGN
FPT_UNFID_CONSTANT.V
      5602**DCL      5598--DCLINIT
M$ERRMSG
      5577**DCL-ENT  6107--CALL
M$UNFID
      5577**DCL-ENT  6097--CALL
PL6.E3A0      #003=XUF$DESC File=XUF$FORMAT.:E05TSI                              WED 07/30/97 09:17 Page:271  
PFMT
        24**DCL      6076--ASSIGN
SIZ
        15**DCL         6--PROC     6075--ENTRY    6084<<ASSIGN   6087--ENTRY    6094>>IF       6096--ASSIGN
      6100--ENTRY    6110<<ASSIGN   6111>>DOUNTIL  6112<<CALLBLT  6112>>CALLBLT
VECTR
      6071**DCL      6073<<ASSIGN   6076<<ASSIGN   6079--ASSIGN   6080>>ASSIGN   6081<<ASSIGN
XUF$FORMAT
        17**DCL-ENT  6083--CALL

PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:272  
     1479        1        /*T***********************************************************/
     1480        2        /*T*                                                         */
     1481        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1482        4        /*T*                                                         */
     1483        5        /*T***********************************************************/
     1484        6        XUF$WRITE: PROC(FDS,FMTVEC,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16,
                 6            P17,P18,P19,P20);
     1485        7        /*P*    NAME:    XUF$WRITE
     1486        8                PURPOSE: MAKE IT EASIER TO CALL X$FORMAT
     1487        9        */
     1488       10        /*D*    NAME:    XUF$WRITE
     1489       11                CALL:    CALL XUF$WRITE(FDS,FMTVEC[,VEC1[,VEC2[,...,VEC20]]]);
     1490       12                         CALL X$WRITE(the same thing);
     1491       13                         NOTE:  DCL X$WRITE EPTR SYMREF
     1492       14                                (This is a trick so it can have a variable
     1493       15                                 number of arguments.)
     1494       16                INPUT:
     1495       17                         FDS - AN FDS WITH EVERYTHING BUT FMT_, VECTR$ AND
     1496       18                               NVECS# SPECIFIED.
     1497       19                         FMTVEC - VECTOR FRAMING FORMAT.
     1498       20                         VECn - A VECTOR FRAMING SOME DATA
     1499       21                DESCRIPTION:
     1500       22                   Builds an array of data vectors from VECn,  points
     1501       23                   FDS.VECTR$ to it,  fills in FDS.NVECS# and FDS.FMT_,
     1502       24                   and calls X$FORMAT.
     1503       25        */
     1504       26        %EJECT;
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:273  
     1505       27    1   DCL FMTVEC BIT(72) ALIGNED;
     1506       28    1   DCL P1 BIT(72) ALIGNED;
     1507       29    1   DCL P2 BIT(72) ALIGNED;
     1508       30    1   DCL P3 BIT(72) ALIGNED;
     1509       31    1   DCL P4 BIT(72) ALIGNED;
     1510       32    1   DCL P5 BIT(72) ALIGNED;
     1511       33    1   DCL P6 BIT(72) ALIGNED;
     1512       34    1   DCL P7 BIT(72) ALIGNED;
     1513       35    1   DCL P8 BIT(72) ALIGNED;
     1514       36    1   DCL P9 BIT(72) ALIGNED;
     1515       37    1   DCL P10 BIT(72) ALIGNED;
     1516       38    1   DCL P11 BIT(72) ALIGNED;
     1517       39    1   DCL P12 BIT(72) ALIGNED;
     1518       40    1   DCL P13 BIT(72) ALIGNED;
     1519       41    1   DCL P14 BIT(72) ALIGNED;
     1520       42    1   DCL P15 BIT(72) ALIGNED;
     1521       43    1   DCL P16 BIT(72) ALIGNED;
     1522       44    1   DCL P17 BIT(72) ALIGNED;
     1523       45    1   DCL P18 BIT(72) ALIGNED;
     1524       46    1   DCL P19 BIT(72) ALIGNED;
     1525       47    1   DCL P20 BIT(72) ALIGNED;
     1526       48        /**/
     1527       49        %INCLUDE XU_FORMAT_C;
     1528      211        %F_FDS (NAME=FDS,STCLASS="");
     1529      324    1   DCL X$FORMAT ENTRY(1);
     1530      325        /**/
     1531      326        %INCLUDE B_SEGIDS_C;
     1532      865    1   DCL 1 X1$ CONSTANT ALIGNED,
     1533      866    1         2 ADR BIT(24) INIT('0'B),
     1534      867    1         2 SEGID BIT(12) INIT(%AUTOSID);
     1535      868    1   DCL AUTO$ REDEF X1$ PTR;
     1536      869    1   DCL 1 STK BASED(AUTO$) ALIGNED,
     1537      870    1         2 * SBIN HALF UNAL,
     1538      871    1         2 OFFSET SBIN HALF UNAL;
     1539      872    1   DCL ARG$ PTR;
     1540      873    1   DCL P$ PTR BASED;
     1541      874    1   DCL DATAPTR$(0:19) PTR BASED(ARG$);
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:274  
     1542      875    1   DCL DATAVEC BIT(72) BASED ALIGNED;
     1543      876    1   DCL I SBIN;
     1544      877    1   DCL VECTR(0:19) BIT(72);
     1545      878        %EJECT;
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:275  
     1546      879    1   X$WRITE: ENTRY(FDS,FMTVEC,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16,P17
               879            ,P18,P19,P20);
     1547      880    1           ARG$=PINCRW(AUTO$,4-STK.OFFSET);
     1548      881    1           FDS.FMT_=FMTVEC;
     1549      882    1           I=0;
     1550      883    2           DO WHILE(I<20 AND DATAPTR$(I)~=ADDR(NIL));
     1551      884    2              VECTR(I)=DATAPTR$(I)->DATAVEC;
     1552      885    2              I=I+1;
     1553      886    2              END;
     1554      887    1           FDS.VECTR$=ADDR(VECTR);
     1555      888    1           FDS.NVECS#=I;
     1556      889    1           CALL X$FORMAT(FDS);
     1557      890    1           RETURN;
     1558      891    1   END XUF$WRITE;

PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:276  
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUF$WRITE.

   Procedure XUF$WRITE requires 45 words for executable code.
   Procedure XUF$WRITE requires 68 words of local(AUTO) storage.

    No errors detected in file XUF$FORMAT.:E05TSI    .

PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:277  

 Object Unit name= XUF$WRITE                                  File name= XUF$FORMAT.:E05TOU
 UTS= JUL 30 '97 09:17:31.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  XUF$WRITE
    1   Proc  even  none    45     55  XUF$WRITE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std       22  XUF$WRITE
     1      3                  yes      Std       22  X$WRITE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:278  


     1479        1        /*T***********************************************************/
     1480        2        /*T*                                                         */
     1481        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1482        4        /*T*                                                         */
     1483        5        /*T***********************************************************/
     1484        6        XUF$WRITE: PROC(FDS,FMTVEC,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16,
                 6            P17,P18,P19,P20);

      6  1 000000   000000 700200 xent  XUF$WRITE    TSX0  ! X66_AUTO_N
         1 000001   000104 000026                    ZERO    68,22
         1 000002   000005 710000 1                  TRA     s:880

     1485        7        /*P*    NAME:    XUF$WRITE
     1486        8                PURPOSE: MAKE IT EASIER TO CALL X$FORMAT
     1487        9        */
     1488       10        /*D*    NAME:    XUF$WRITE
     1489       11                CALL:    CALL XUF$WRITE(FDS,FMTVEC[,VEC1[,VEC2[,...,VEC20]]]);
     1490       12                         CALL X$WRITE(the same thing);
     1491       13                         NOTE:  DCL X$WRITE EPTR SYMREF
     1492       14                                (This is a trick so it can have a variable
     1493       15                                 number of arguments.)
     1494       16                INPUT:
     1495       17                         FDS - AN FDS WITH EVERYTHING BUT FMT_, VECTR$ AND
     1496       18                               NVECS# SPECIFIED.
     1497       19                         FMTVEC - VECTOR FRAMING FORMAT.
     1498       20                         VECn - A VECTOR FRAMING SOME DATA
     1499       21                DESCRIPTION:
     1500       22                   Builds an array of data vectors from VECn,  points
     1501       23                   FDS.VECTR$ to it,  fills in FDS.NVECS# and FDS.FMT_,
     1502       24                   and calls X$FORMAT.
     1503       25        */
     1504       26        %EJECT;
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:279  
     1505       27    1   DCL FMTVEC BIT(72) ALIGNED;
     1506       28    1   DCL P1 BIT(72) ALIGNED;
     1507       29    1   DCL P2 BIT(72) ALIGNED;
     1508       30    1   DCL P3 BIT(72) ALIGNED;
     1509       31    1   DCL P4 BIT(72) ALIGNED;
     1510       32    1   DCL P5 BIT(72) ALIGNED;
     1511       33    1   DCL P6 BIT(72) ALIGNED;
     1512       34    1   DCL P7 BIT(72) ALIGNED;
     1513       35    1   DCL P8 BIT(72) ALIGNED;
     1514       36    1   DCL P9 BIT(72) ALIGNED;
     1515       37    1   DCL P10 BIT(72) ALIGNED;
     1516       38    1   DCL P11 BIT(72) ALIGNED;
     1517       39    1   DCL P12 BIT(72) ALIGNED;
     1518       40    1   DCL P13 BIT(72) ALIGNED;
     1519       41    1   DCL P14 BIT(72) ALIGNED;
     1520       42    1   DCL P15 BIT(72) ALIGNED;
     1521       43    1   DCL P16 BIT(72) ALIGNED;
     1522       44    1   DCL P17 BIT(72) ALIGNED;
     1523       45    1   DCL P18 BIT(72) ALIGNED;
     1524       46    1   DCL P19 BIT(72) ALIGNED;
     1525       47    1   DCL P20 BIT(72) ALIGNED;
     1526       48        /**/
     1527       49        %INCLUDE XU_FORMAT_C;
     1528      211        %F_FDS (NAME=FDS,STCLASS="");
     1529      324    1   DCL X$FORMAT ENTRY(1);
     1530      325        /**/
     1531      326        %INCLUDE B_SEGIDS_C;
     1532      865    1   DCL 1 X1$ CONSTANT ALIGNED,
     1533      866    1         2 ADR BIT(24) INIT('0'B),
     1534      867    1         2 SEGID BIT(12) INIT(%AUTOSID);
     1535      868    1   DCL AUTO$ REDEF X1$ PTR;
     1536      869    1   DCL 1 STK BASED(AUTO$) ALIGNED,
     1537      870    1         2 * SBIN HALF UNAL,
     1538      871    1         2 OFFSET SBIN HALF UNAL;
     1539      872    1   DCL ARG$ PTR;
     1540      873    1   DCL P$ PTR BASED;
     1541      874    1   DCL DATAPTR$(0:19) PTR BASED(ARG$);
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:280  
     1542      875    1   DCL DATAVEC BIT(72) BASED ALIGNED;
     1543      876    1   DCL I SBIN;
     1544      877    1   DCL VECTR(0:19) BIT(72);
     1545      878        %EJECT;
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:281  
     1546      879    1  X$WRITE: ENTRY(FDS,FMTVEC,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16,P17
               879            ,P18,P19,P20);

    879  1 000003   000000 700200 xent  X$WRITE      TSX0  ! X66_AUTO_N
         1 000004   000104 000026                    ZERO    68,22

     1547      880    1           ARG$=PINCRW(AUTO$,4-STK.OFFSET);

    880  1 000005   000000 470400 0                  LDP0    X1$
         1 000006   000000 720100                    LXL0    0,,PR0
         1 000007   777773 636010                    EAQ     -5,X0
         1 000010   777777 676003                    ERQ     -1,DU
         1 000011   000000 036000 0                  ADLQ    X1$
         1 000012   200031 756100                    STQ     ARG$,,AUTO

     1548      881    1           FDS.FMT_=FMTVEC;

    881  1 000013   200004 471500                    LDP1    @FMTVEC,,AUTO
         1 000014   200003 473500                    LDP3    @FDS,,AUTO
         1 000015   000100 100500                    MLR     fill='000'O
         1 000016   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000017   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8

     1549      882    1           I=0;

    882  1 000020   200032 450100                    STZ     I,,AUTO

     1550      883    2           DO WHILE(I<20 AND DATAPTR$(I)~=ADDR(NIL));

    883  1 000021   000034 710000 1                  TRA     s:886

     1551      884    2              VECTR(I)=DATAPTR$(I)->DATAVEC;

    884  1 000022   200032 235100                    LDA     I,,AUTO
         1 000023   000001 735000                    ALS     1
         1 000024   200031 470500                    LDP0    ARG$,,AUTO
         1 000025   200032 720100                    LXL0    I,,AUTO
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:282  
         1 000026   000000 471510                    LDP1    0,X0,PR0
         1 000027   000002 735000                    ALS     2
         1 000030   000105 100500                    MLR     fill='000'O
         1 000031   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000032   200033 000010                    ADSC9   VECTR,A,AUTO             cn=0,n=8

     1552      885    2              I=I+1;

    885  1 000033   200032 054100                    AOS     I,,AUTO

     1553      886    2              END;

    886  1 000034   200032 235100                    LDA     I,,AUTO
         1 000035   000024 115007                    CMPA    20,DL
         1 000036   000043 605000 1                  TPL     s:887
         1 000037   200031 470500                    LDP0    ARG$,,AUTO
         1 000040   000000 236105                    LDQ     0,AL,PR0
         1 000041   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000042   000022 601000 1                  TNZ     s:884

     1554      887    1           FDS.VECTR$=ADDR(VECTR);

    887  1 000043   200033 630500                    EPPR0   VECTR,,AUTO
         1 000044   200003 471500                    LDP1    @FDS,,AUTO
         1 000045   100012 450500                    STP0    10,,PR1

     1555      888    1           FDS.NVECS#=I;

    888  1 000046   200032 235100                    LDA     I,,AUTO
         1 000047   100011 755100                    STA     9,,PR1

     1556      889    1           CALL X$FORMAT(FDS);

    889  1 000050   200003 630500                    EPPR0   @FDS,,AUTO
         1 000051   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000052   000000 701000 xent               TSX1    X$FORMAT
         1 000053   000000 011000                    NOP     0
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:283  

     1557      890    1           RETURN;

    890  1 000054   000000 702200 xent               TSX2  ! X66_ARET
     1558      891    1   END XUF$WRITE;

PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:284  
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUF$WRITE.
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:285  

 **** Variables and constants ****

  ****  Section 000 RoData XUF$WRITE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 AUTO$                      0-0-0/w STRC        r     1 X1$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FDS                       4-0-0/w PTR         r     1 @FMTVEC
     5-0-0/w PTR         r     1 @P1                       16-0-0/w PTR         r     1 @P10
    17-0-0/w PTR         r     1 @P11                      20-0-0/w PTR         r     1 @P12
    21-0-0/w PTR         r     1 @P13                      22-0-0/w PTR         r     1 @P14
    23-0-0/w PTR         r     1 @P15                      24-0-0/w PTR         r     1 @P16
    25-0-0/w PTR         r     1 @P17                      26-0-0/w PTR         r     1 @P18
    27-0-0/w PTR         r     1 @P19                       6-0-0/w PTR         r     1 @P2
    30-0-0/w PTR         r     1 @P20                       7-0-0/w PTR         r     1 @P3
    10-0-0/w PTR         r     1 @P4                       11-0-0/w PTR         r     1 @P5
    12-0-0/w PTR         r     1 @P6                       13-0-0/w PTR         r     1 @P7
    14-0-0/w PTR         r     1 @P8                       15-0-0/w PTR         r     1 @P9
    31-0-0/w PTR         r     1 ARG$                      *0-0-0/w STRC(1080)  r     1 FDS
    *0-0-0/w BIT (72)    r     1 FMTVEC                    32-0-0/w SBIN        r     1 I
    *0-0-0/w BIT (72)    r     1 P1                        *0-0-0/w BIT (72)    r     1 P10
    *0-0-0/w BIT (72)    r     1 P11                       *0-0-0/w BIT (72)    r     1 P12
    *0-0-0/w BIT (72)    r     1 P13                       *0-0-0/w BIT (72)    r     1 P14
    *0-0-0/w BIT (72)    r     1 P15                       *0-0-0/w BIT (72)    r     1 P16
    *0-0-0/w BIT (72)    r     1 P17                       *0-0-0/w BIT (72)    r     1 P18
    *0-0-0/w BIT (72)    r     1 P19                       *0-0-0/w BIT (72)    r     1 P2
    *0-0-0/w BIT (72)    r     1 P20                       *0-0-0/w BIT (72)    r     1 P3
    *0-0-0/w BIT (72)    r     1 P4                        *0-0-0/w BIT (72)    r     1 P5
    *0-0-0/w BIT (72)    r     1 P6                        *0-0-0/w BIT (72)    r     1 P7
    *0-0-0/w BIT (72)    r     1 P8                        *0-0-0/w BIT (72)    r     1 P9
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:286  
    33-0-0/b BIT (72)    r     1 VECTR(0:19)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DATAPTR$(0:19)
     0-0-0/w BIT (72)    r     1 DATAVEC                    0-0-0/w STRC        r     1 STK


   Procedure XUF$WRITE requires 45 words for executable code.
   Procedure XUF$WRITE requires 68 words of local(AUTO) storage.

    No errors detected in file XUF$FORMAT.:E05TSI    .
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:287  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:288  
          MINI XREF LISTING

ARG$
       872**DCL       874--IMP-PTR   880<<ASSIGN    883>>DOWHILE   884>>ASSIGN
AUTO$
       868**DCL       869--IMP-PTR   880>>ASSIGN    880>>ASSIGN
DATAPTR$
       874**DCL       883>>DOWHILE   884>>ASSIGN
DATAVEC
       875**DCL       884>>ASSIGN
FDS
       225**DCL         6--PROC      879--ENTRY     889<>CALL
FDS.FMT_
       229**DCL       881<<ASSIGN
FDS.NVECS#
       253**DCL       888<<ASSIGN
FDS.VECTR$
       255**DCL       887<<ASSIGN
FMTVEC
        27**DCL         6--PROC      879--ENTRY     881>>ASSIGN
I
       876**DCL       882<<ASSIGN    883>>DOWHILE   883>>DOWHILE   884>>ASSIGN    884>>ASSIGN    885<<ASSIGN
       885>>ASSIGN    888>>ASSIGN
P1
        28**DCL         6--PROC      879--ENTRY
P10
        37**DCL         6--PROC      879--ENTRY
P11
        38**DCL         6--PROC      879--ENTRY
P12
        39**DCL         6--PROC      879--ENTRY
P13
        40**DCL         6--PROC      879--ENTRY
P14
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:289  
        41**DCL         6--PROC      879--ENTRY
P15
        42**DCL         6--PROC      879--ENTRY
P16
        43**DCL         6--PROC      879--ENTRY
P17
        44**DCL         6--PROC      879--ENTRY
P18
        45**DCL         6--PROC      879--ENTRY
P19
        46**DCL         6--PROC      879--ENTRY
P2
        29**DCL         6--PROC      879--ENTRY
P20
        47**DCL         6--PROC      879--ENTRY
P3
        30**DCL         6--PROC      879--ENTRY
P4
        31**DCL         6--PROC      879--ENTRY
P5
        32**DCL         6--PROC      879--ENTRY
P6
        33**DCL         6--PROC      879--ENTRY
P7
        34**DCL         6--PROC      879--ENTRY
P8
        35**DCL         6--PROC      879--ENTRY
P9
        36**DCL         6--PROC      879--ENTRY
STK.OFFSET
       871**DCL       880>>ASSIGN
VECTR
       877**DCL       884<<ASSIGN    887--ASSIGN
X$FORMAT
       324**DCL-ENT   889--CALL
X1$
PL6.E3A0      #004=XUF$WRITE File=XUF$FORMAT.:E05TSI                             WED 07/30/97 09:17 Page:290  
       865**DCL       868--REDEF
