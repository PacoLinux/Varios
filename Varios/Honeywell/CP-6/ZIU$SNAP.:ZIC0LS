
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZIU$SNAP: PROC ALTRET;
        7        7        %INCLUDE ZI$GLOBAL;
        8      493         %GLOBALS(STCLASS=AUTO);
        9      801         %STATS;
       10      817         %STATS(NAME=LSTATS,STCLASS=STATIC);
       11      833        %INCLUDE ZI$DIR;
       12      990         %DIR;
       13     1134        %INCLUDE ZI_GLOBAL_DBUTIL;
       14     1312         %SYS_FUNC;
       15     1404         %MISC_DCLS;
       16     1457        %INCLUDE B_MICROPS_C;
       17     1629    1   DCL 1 MICRO_DEC12 CONSTANT,
       18     1630    1         2 * BIT(9) UNAL INIT(%MVZB11),
       19     1631    1         2 * BIT(9) UNAL INIT(%MVC1);
       20     1632        %INCLUDE B$USER;
       21     1848        %INCLUDE B$P;
       22     1932        %INCLUDE CP_6;
       23     2013         %FPT_WAIT(FPTN=FPT_WAIT,STCLASS=STATIC);
       24     2027         %FPT_MONINFO(STCLASS=CONSTANT,MONPTRS=VLR_MONPTRS);
       25     2042         %VLR_MONPTRS(STCLASS=STATIC);
       26     2057         %B$TCB;
       27     2060         %B$ALT;
       28     2068        %INCLUDE CP_6_SUBS;
       29     2608        %INCLUDE ZI_ERRORS_SUBS;
       30     3128        %INCLUDE B_STRINGS_C;
       31     3257        %INCLUDE B_SEGIDS_C;
       32     3796    1   DCL ZERO_SUP ENTRY(3);
       33     3797    1   DCL DAM$INIT ENTRY ALTRET;
       34     3798    1   DCL DAM$MAP ENTRY(5) ALTRET;
       35     3799    1   DCL DA_MAPERR BIT(36) SYMREF;
       36     3800    1   DCL 1 IP CONSTANT,
       37     3801    1         2 * BIT(24) INIT('0'B),
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:2    
       38     3802    1         2 * BIT(12) INIT(%COMMONSID);
       39     3803    1   DCL IP$ REDEF IP PTR;
       40     3804    1   DCL GLOBAL_ VECTOR;
       41     3805    1   DCL DA_MUAIS UBIN WORD SYMREF;
       42     3806    1   DCL 1 USER_SYSID SYMREF,
       43     3807    1         2 COUNT UBIN(9) UNAL,
       44     3808    1         2 TEXT CHAR(7) UNAL;
       45     3809    1   DCL 1 ASLNAME,
       46     3810    1         2 COUNT UBIN BYTE UNAL,
       47     3811    1         2 TEXT CHAR(31) UNAL;
       48     3812    1   DCL 1 PRINTBUF,
       49     3813    1         2 BUFFER CHAR(132);
       50     3814    1   DCL 1 TIME,
       51     3815    1         2 DATE CHAR(10),
       52     3816    1         2 TIME CHAR(11),
       53     3817    1         2 DAY CHAR(3);
       54     3818    1   DCL B$USRT$ PTR SYMREF;
       55     3819    1   DCL TSTAMP UBIN(36);
       56     3820    1   DCL WAIT_TIME UBIN WORD;
       57     3821    1   DCL ASLDOMAIN UBIN WORD CONSTANT INIT(%ASLWSR);
       58     3822    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       59     3823    1   DCL SYS_FUNC_TSTAMP ENTRY ALTRET;
       60     3824    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       61     3825    1   DCL HEADING_FLAG BIT(1);
       62     3826    1   DCL USER SBIN WORD;
       63     3827    1   DCL SYSID SBIN WORD;
       64     3828    1   DCL STATS$ PTR;
       65     3829    1   DCL BUFSTAT$ PTR;
       66     3830    1   DCL BUFSTAT CHAR(12) BASED(BUFSTAT$) CALIGNED;
       67     3831    1   DCL STRING3 CHAR(3) BASED CALIGNED;
       68     3832
       69     3833    1   DCL GETSEGSIZ ENTRY;
       70     3834    1   DCL STRING30 CHAR(30) BASED;
       71     3835    1   DCL H1 CONSTANT CHAR(73) INIT(
       72     3836    1    'A*   *   *   *   *   *   *  SERVICE STATISTICS  *   *   *   *   *   *   *');
       73     3837    1   DCL H2 CONSTANT CHAR(73) INIT(
       74     3838    1    'BFunction           Calls       Reads      Writes        Enqs   Deadlocks');
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:3    
       75     3839    1   DCL 1 FCN (0:50) CONSTANT,
       76     3840    1         2 NAME CHAR(12) INIT(
       77     3841    1    '            ',
       78     3842    1    'ROLLBACK    ',
       79     3843    1    'HERE-I-AM   ',
       80     3844    1    'READY       ',
       81     3845    1    'FINISH      ',
       82     3846    1    'STORE       ',
       83     3847    1    'ERASE       ',
       84     3848    1    'MODIFY      ',
       85     3849    1    'CONNECT     ',
       86     3850    1    'DISCONNECT  ',
       87     3851    1    'ACCEPT AREA ',
       88     3852    1    'ACCEPT CURR ',
       89     3853    1    'IF TENANT   ',
       90     3854    1    'IF SET      ',
       91     3855    1    'IF MEMBER   ',
       92     3856    1    'FND U/KY    ',
       93     3857    1    'FND U/KY CUR',
       94     3858    1    'FND DUP     ',
       95     3859    1    'FND CALC    ',
       96     3860    1    'FND DUP CLAC',
       97     3861    1    'FND OWNER   ',
       98     3862    1    'FND CUR TYPE',
       99     3863    1    'FND CUR RUN ',
      100     3864    1    'FND ABS SET ',
      101     3865    1    'FND ABS AREA',
      102     3866    1    'FND REL SET ',
      103     3867    1    'FND REL AREA',
      104     3868    1    'FND DIRECT  ',
      105     3869    1    'FND U/INDEX ',
      106     3870    1    'FND REL INDX',
      107     3871    1    'GET RECORD  ',
      108     3872    1    'GET FIELDS  ',
      109     3873    1    'CHECKPOINT  ',
      110     3874    1    'TRACE ON    ',
      111     3875    1    'TRACE OFF   ',
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:4    
      112     3876    1    'STATS ON    ',
      113     3877    1    'STATS OFF   ',
      114     3878    1    'SHARE IN    ',
      115     3879    1    'SHARE ALL   ',
      116     3880    1    'SHARE NONE  ',
      117     3881    1    'ENCRIPTION  ',
      118     3882    1    'REPORT STATS',
      119     3883    1    'SHARE CUR   ',
      120     3884    1    'BUFFERS     ',
      121     3885    1    'PRIVACY     ',
      122     3886    1    'INITIALIZE  ',
      123     3887    1    'SHARE ANY   ',
      124     3888    1    'CALC        ',
      125     3889    1    'KEEP        ',
      126     3890    1    'REDUCEQ     ',
      127     3891    1    'SHAREIN CUR ');
      128     3892        %EJECT;
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:5    
      129     3893        /*E*     ERROR:   ZIU-DBU#BADSYSID-C
      130     3894                 MESSAGE: User/Sysid %U1 does not exist or is illegal. */
      131     3895        /*E*     ERROR:   ZIU-DBU#NOASL-C
      132     3896                 MESSAGE: User/Sysid %U1 not associated with an ASL. */
      133     3897        /*E*     ERROR:   ZIU-DBU#NOTIDS-C
      134     3898                 MESSAGE: User/Sysid %U1 not associated with IDS ASL. */
      135     3899        /*
      136     3900                 VALIDATE USER/SYSID AND MAP ALS GLOBAL SEGMENT
      137     3901                 INPUT:   ZI$DIR.SYSID  AND  ZI$DIR.WAIT
      138     3902        */
      139     3903    1       CALL DAM$INIT ALTRET(ER_INIT);
      140     3904    1       CALL M$MONINFO(FPT_MONINFO) ALTRET(ER_MON);
      141     3905    1       CALL DAM$MAP(VLR_MONPTRS.B$P$,B$P$,0,%MONWSR) ALTRET(ER_MAP);
      142     3906    1       IF ZI$DIR.SYSID<0 THEN /* SNAP BY USER# */
      143     3907    2       DO;
      144     3908    2           USER = -1 * ZI$DIR.SYSID;
      145     3909    2           SYSID = B$USRT$->B$USER.SYSID(USER);
      146     3910    2           END; /* BOTH USER# AND SYSID KNOWN */
      147     3911    1       ELSE
      148     3912    2       DO;
      149     3913    2           SYSID = ZI$DIR.SYSID;
      150     3914    3           DO USER=0 TO DA_MUAIS-1;
      151     3915    3               IF B$USRT$->B$USER.SYSID(USER) = SYSID THEN
      152     3916    3                   GOTO FSYSID;
      153     3917    3               END;
      154     3918    2           ERRCODESF.ERR# = DBU#BADSYSID;
      155     3919    2           GOTO ER_DBU;
      156     3920    2           END;
      157     3921    1   FSYSID: ERRCODESF.ERR# = DBU#NOASL;
      158     3922    1       IF B$USRT$->B$USER.ASL(USER)=0 THEN
      159     3923    1           GOTO ER_DBU; /* NOT ASSOCIATED WITH ALT LIB */
      160     3924
      161     3925    1       ASLNAME=B$P$->B$P.NAME(B$USRT$->B$USER.ASL(USER));
      162     3926    1       ERRCODESF.ERR# = DBU#NOTIDS;
      163     3927    1       IF ASLNAME.COUNT<3 OR SUBSTR(ASLNAME.TEXT,0,3)~='IDS' THEN
      164     3928    1           GOTO ER_DBU; /* THE ALT IS NOT IDS */
      165     3929        %EJECT;
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:6    
      166     3930    1       LSTATS='0'B;
      167     3931    1       FPT_WAIT.V.UNITS#=ZI$DIR.WAIT;
      168     3932    1       DESTSF=%EXT#;
      169     3933    1       DATESF=VECTOR(TIME.DATE);
      170     3934    1       TIMESF=VECTOR(TIME.TIME);
      171     3935    1       TSTAMPSF=VECTOR(TSTAMP);
      172     3936    1       BUFSF=VECTOR(PRINTBUF.BUFFER);
      173     3937    1       BUFLNSF=LENGTHC(PRINTBUF.BUFFER);
      174     3938    1       VFCSF=%YES#;
      175     3939    1       GLOBAL_ = VECTOR( IP$->GLOBAL );
      176     3940
      177     3941    1   WAKEUP:
      178     3942    1       CALL DAM$MAP(IP$,GLOBAL$,SYSID,ASLDOMAIN,GLOBAL_) ALTRET(ER_MAP);
      179     3943    1       REC$ = GLOBAL$;
      180     3944    1       CALL GETSEGSIZ; /* SEG SIZE RETURNED IN X */
      181     3945    1       IF B$USRT$->B$USER.ASL(USER)=0 THEN
      182     3946    2       DO;
      183     3947    2           FPT_WAIT.V.UNITS#=0; /* STOP LOOPING */
      184     3948    2           PRINTBUF.BUFFER='B  User has dis-associated with IDS.';
      185     3949    2           CALL SYS_FUNC_WRIT ALTRET(ALT);
      186     3950    2           END;
      187     3951    1       ELSE
      188     3952    1           IF X < 8 THEN /* MUST BE NULL SEG */
      189     3953    2           DO;
      190     3954    2               PRINTBUF.BUFFER='B  IDS not active, HIA not invoked yet.';
      191     3955    2               CALL SYS_FUNC_WRIT ALTRET(ALT);
      192     3956    2               END;
      193     3957    1           ELSE
      194     3958    2           DO;
      195     3959    2               STATS$ = ADDR(GLOBAL.STATS.DBCS);
      196     3960    2               TSTAMP = STATS.TSTAMP;
      197     3961    2               PRINTBUF.BUFFER='0DBCS SNAPSHOT STATISTICS';
      198     3962    2               SOURCESF=%UTS#;
      199     3963    2               CALL SYS_FUNC_TSTAMP ALTRET(ER_MON);
      200     3964    2               CALL INSERT(PRINTBUF.BUFFER,28,5,SUBSTR(TIME.TIME,0,5));
      201     3965    2               CALL INSERT(PRINTBUF.BUFFER,34,10,TIME.DATE);
      202     3966    2               CALL INSERT(PRINTBUF.BUFFER,45,1,'-');
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:7    
      203     3967    2               SOURCESF=%CLOCK#;
      204     3968    2               CALL SYS_FUNC_TSTAMP ALTRET(ALT);
      205     3969    2               CALL INSERT(PRINTBUF.BUFFER,47,5,SUBSTR(TIME.TIME,0,5));
      206     3970    2               CALL INSERT(PRINTBUF.BUFFER,53,10,TIME.DATE);
      207     3971    2               CALL SYS_FUNC_WRIT ALTRET(ALT);
      208     3972    2               PRINTBUF.BUFFER='C';
      209     3973    2               CALL SYS_FUNC_WRIT ALTRET(ALT);
      210     3974    2               BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),14);
      211     3975    2               BUFSTAT$->STRING30 = 'page hits with XXX buffers.';
      212     3976    2               BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),29);
      213     3977    2               CALL BINCHAR(BUFSTAT$->STRING3,GLOBAL.BCB.COUNT);
      214     3978    2               BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),1);
      215     3979    2               CALL BINCHAR(BUFSTAT,STATS.HITS-LSTATS.HITS);
      216     3980    2               CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);
      217     3981    2               CALL SYS_FUNC_WRIT ALTRET(ALT);
      218     3982    2               BUFSTAT$=PINCRC(ADDR(PRINTBUF.BUFFER),14);
      219     3983    2               BUFSTAT$->STRING30='I/O attempts.';
      220     3984    2               BUFSTAT$=PINCRC(ADDR(PRINTBUF.BUFFER),1);
      221     3985    2               CALL BINCHAR(BUFSTAT,STATS.REQS-LSTATS.REQS);
      222     3986    2               CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);
      223     3987    2               CALL SYS_FUNC_WRIT ALTRET(ALT);
      224     3988    2               HEADING_FLAG=%YES#;
      225     3989    3               DO J = 0 TO LAST#RPT#FCN;
      226     3990    3                   IF STATS.COUNT.CALLS(J)-LSTATS.COUNT.CALLS(J)>0 THEN
      227     3991    4                   DO;
      228     3992    4                       IF BREAK_FLAG>0 THEN RETURN;
      229     3993    4                       IF HEADING_FLAG THEN
      230     3994    5                       DO;
      231     3995    5                           HEADING_FLAG=%NO#;
      232     3996    5                           PRINTBUF.BUFFER=H1;
      233     3997    5                           CALL SYS_FUNC_WRIT ALTRET(ALT);
      234     3998    5                           PRINTBUF.BUFFER=H2;
      235     3999    5                           CALL SYS_FUNC_WRIT ALTRET(ALT);
      236     4000    5                           PRINTBUF.BUFFER = ' ';
      237     4001    5                           PRINTBUF.BUFFER='A';
      238     4002    5                           END;
      239     4003    4                       BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),1);
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:8    
      240     4004    4                       BUFSTAT = FCN.NAME(J);
      241     4005    4                       BUFSTAT$ = PINCRC(BUFSTAT$,12);
      242     4006    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.CALLS(J)-
      243     4007    4                          LSTATS.COUNT.CALLS(J));
      244     4008    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);
      245     4009    4                       BUFSTAT$ = PINCRC(BUFSTAT$,12);
      246     4010    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.READS(J)-
      247     4011    4                          LSTATS.COUNT.READS(J));
      248     4012    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);
      249     4013    4                       BUFSTAT$ = PINCRC(BUFSTAT$,12);
      250     4014    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.WRITES(J)-
      251     4015    4                          LSTATS.COUNT.WRITES(J));
      252     4016    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);
      253     4017    4                       BUFSTAT$=PINCRC(BUFSTAT$,12);
      254     4018    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.ENQS(J)-
      255     4019    4                          LSTATS.COUNT.ENQS(J));
      256     4020    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);
      257     4021    4                       BUFSTAT$=PINCRC(BUFSTAT$,12);
      258     4022    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.LOCKS(J)-
      259     4023    4                          LSTATS.COUNT.LOCKS(J));
      260     4024    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);
      261     4025    4                       CALL SYS_FUNC_WRIT ALTRET(ALT);
      262     4026    4                       END;
      263     4027    3                   END;
      264     4028    2               LSTATS=STATS;
      265     4029    2               END;
      266     4030    1       CALL M$WAIT(FPT_WAIT);
      267     4031    1       IF FPT_WAIT.V.UNITS#>0 AND BREAK_FLAG=0 THEN
      268     4032    1           GOTO WAKEUP;
      269     4033    1       RETURN;
      270     4034    1   ER_MON: MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      271     4035    1       GOTO ERRMSG;
      272     4036    1   ER_DBU: MSGCODE=ERRCODE_RDEF;
      273     4037    1       IF ZI$DIR.SYSID<0 THEN
      274     4038    2       DO;
      275     4039    2           CALL CONCAT(ERR_INSERT.TEXT(0),'.',USER_SYSID.TEXT);
      276     4040    2           ERR_INSERT.CNT(0)=USER_SYSID.COUNT+1;
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:9    
      277     4041    2           END;
      278     4042    1       ELSE
      279     4043    1           ERR_INSERT(0) = USER_SYSID;
      280     4044    1       GOTO ERRMSG;
      281     4045    1   ER_INIT: ;
      282     4046    1   ER_MAP: ;
      283     4047    1       MONITOR_ERR=DA_MAPERR;
      284     4048    1   ERRMSG: CALL SYS_FUNC_ERRMSG ALTRET(ALT);
      285     4049    1   ALT: ALTRETURN;
      286     4050    1   END ZIU$SNAP;
      287     4051        %EOD;

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:10   
--  Include file information  --

   B_SEGIDS_C.:LIB_E05  is referenced.
   B_STRINGS_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$P.:LIB_E05  cannot be made into a system file and is referenced.
   B$USER.:LIB_E05  cannot be made into a system file and is referenced.
   B_MICROPS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$SNAP.

   Procedure ZIU$SNAP requires 437 words for executable code.
   Procedure ZIU$SNAP requires 66 words of local(AUTO) storage.

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:11   

 Object Unit name= ZIU$SNAP                                   File name= ZIU$SNAP.:ZIC0TOU
 UTS= SEP 05 '97 13:32:10.12 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   330    512  ZIU$SNAP
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS    245    365  ZIU$SNAP
    3   DCB   even  none     0      0  M$UC
    4   Proc  even  none   437    665  ZIU$SNAP
    5  RoData even  none    21     25  ZIU$SNAP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        0  ZIU$SNAP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 DAM$INIT
         yes           Std       0 GETSEGSIZ
 yes     yes           Std       5 DAM$MAP
 yes     yes           Std       0 SYS_FUNC_TSTAMP
 yes     yes           Std       0 SYS_FUNC_WRIT
 yes     yes           Std       0 SYS_FUNC_ERRMSG
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:12   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ZI$DIR                                SCHEMA_ACTIVE                         RECORD_LIST
     SET_LIST                              RETAIN_LIST                           DUMP_FID
     ALTKY                                 INIT_RG                               KEY_RNG
     ITEM_LIST                             BLKLSF                                KEYLSF
     KEYXSF                                DCBSF                                 ORGSF
     KEYSF                                 KEYVSF                                ACSSF
     NOTIMESF                              FUNSF                                 ASNSF
     TESTSF                                XTENSIZESF                            DISPSF
     WAITSF                                VFCSF                                 FULLSF
     BKUPSF                                BUFLNSF                               BUFSF
     SOURCESF                              DESTSF                                DATESF
     TIMESF                                UTSSF                                 DAYSF
     TSTAMPSF                              ENCRP_SEEDSF                          ERRCODESF
     MSGCODE                               INCL_ERR                              ERR_INSERT
     FIDSF_RD                              ACNT                                  EXISTSF
     SHARESF                               DCBNMSF                               KEYRSF
     NO_KEYSF                              REASGNSF                              CARRY_ATTRIBUTESF
     SUBMESSF                              SPKY_OPNSF                            POSSF
     ERRFLGSF                              MERGESF                               FSA_FLAG
     RELGSF                                UNUSED                                HELPCODE
     COUNTSF                               INDEXSF                               GAP
     PSNSF                                 ACNTSF                                KEY_SHADWSF
     REC$                                  RB                                    RE
     IE                                    IB                                    CNT
     ICNT                                  RCNT                                  SCNT
     FIRST_SET                             RETCNT                                DMPCNT
     KCNT                                  ACNT_IDX                              I
     J                                     K                                     X
     STEPCC                                I_O_BUF$                              OUT_INDX
     I_O_SIZE                              REC_DATA_LN                           M$LO
     B$TCB$                                B$ROS$                                B$JIT$
     KEYFID                                I_O_KEY                               RESTART
     BREAK_FLAG                            ICHKSUM                               ITMCNT
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:13   
     GAP1                                  P_NPROCS                              P_MAXPROCS
     P_AUTO_START                          P_LAST_AUTO                           P_AUTOSPACE
     P_USED_AUTO                           P_MAX_LOOKUP                          B$P$
     B$LOOKUP$                             M$UC                                  DA_MAPERR
     DA_MUAIS                              USER_SYSID                            B$USRT$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:14   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZIU$SNAP: PROC ALTRET;

      6  4 000000   000000 700200 xent  ZIU$SNAP     TSX0  ! X66_AUTO_0
         4 000001   000102 000000                    ZERO    66,0

        7        7        %INCLUDE ZI$GLOBAL;
        8      493         %GLOBALS(STCLASS=AUTO);
        9      801         %STATS;
       10      817         %STATS(NAME=LSTATS,STCLASS=STATIC);
       11      833        %INCLUDE ZI$DIR;
       12      990         %DIR;
       13     1134        %INCLUDE ZI_GLOBAL_DBUTIL;
       14     1312         %SYS_FUNC;
       15     1404         %MISC_DCLS;
       16     1457        %INCLUDE B_MICROPS_C;
       17     1629    1   DCL 1 MICRO_DEC12 CONSTANT,
       18     1630    1         2 * BIT(9) UNAL INIT(%MVZB11),
       19     1631    1         2 * BIT(9) UNAL INIT(%MVC1);
       20     1632        %INCLUDE B$USER;
       21     1848        %INCLUDE B$P;
       22     1932        %INCLUDE CP_6;
       23     2013         %FPT_WAIT(FPTN=FPT_WAIT,STCLASS=STATIC);
       24     2027         %FPT_MONINFO(STCLASS=CONSTANT,MONPTRS=VLR_MONPTRS);
       25     2042         %VLR_MONPTRS(STCLASS=STATIC);
       26     2057         %B$TCB;
       27     2060         %B$ALT;
       28     2068        %INCLUDE CP_6_SUBS;
       29     2608        %INCLUDE ZI_ERRORS_SUBS;
       30     3128        %INCLUDE B_STRINGS_C;
       31     3257        %INCLUDE B_SEGIDS_C;
       32     3796    1   DCL ZERO_SUP ENTRY(3);
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:15   
       33     3797    1   DCL DAM$INIT ENTRY ALTRET;
       34     3798    1   DCL DAM$MAP ENTRY(5) ALTRET;
       35     3799    1   DCL DA_MAPERR BIT(36) SYMREF;
       36     3800    1   DCL 1 IP CONSTANT,
       37     3801    1         2 * BIT(24) INIT('0'B),
       38     3802    1         2 * BIT(12) INIT(%COMMONSID);
       39     3803    1   DCL IP$ REDEF IP PTR;
       40     3804    1   DCL GLOBAL_ VECTOR;
       41     3805    1   DCL DA_MUAIS UBIN WORD SYMREF;
       42     3806    1   DCL 1 USER_SYSID SYMREF,
       43     3807    1         2 COUNT UBIN(9) UNAL,
       44     3808    1         2 TEXT CHAR(7) UNAL;
       45     3809    1   DCL 1 ASLNAME,
       46     3810    1         2 COUNT UBIN BYTE UNAL,
       47     3811    1         2 TEXT CHAR(31) UNAL;
       48     3812    1   DCL 1 PRINTBUF,
       49     3813    1         2 BUFFER CHAR(132);
       50     3814    1   DCL 1 TIME,
       51     3815    1         2 DATE CHAR(10),
       52     3816    1         2 TIME CHAR(11),
       53     3817    1         2 DAY CHAR(3);
       54     3818    1   DCL B$USRT$ PTR SYMREF;
       55     3819    1   DCL TSTAMP UBIN(36);
       56     3820    1   DCL WAIT_TIME UBIN WORD;
       57     3821    1   DCL ASLDOMAIN UBIN WORD CONSTANT INIT(%ASLWSR);
       58     3822    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       59     3823    1   DCL SYS_FUNC_TSTAMP ENTRY ALTRET;
       60     3824    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       61     3825    1   DCL HEADING_FLAG BIT(1);
       62     3826    1   DCL USER SBIN WORD;
       63     3827    1   DCL SYSID SBIN WORD;
       64     3828    1   DCL STATS$ PTR;
       65     3829    1   DCL BUFSTAT$ PTR;
       66     3830    1   DCL BUFSTAT CHAR(12) BASED(BUFSTAT$) CALIGNED;
       67     3831    1   DCL STRING3 CHAR(3) BASED CALIGNED;
       68     3832
       69     3833    1   DCL GETSEGSIZ ENTRY;
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:16   
       70     3834    1   DCL STRING30 CHAR(30) BASED;
       71     3835    1   DCL H1 CONSTANT CHAR(73) INIT(
       72     3836    1    'A*   *   *   *   *   *   *  SERVICE STATISTICS  *   *   *   *   *   *   *');
       73     3837    1   DCL H2 CONSTANT CHAR(73) INIT(
       74     3838    1    'BFunction           Calls       Reads      Writes        Enqs   Deadlocks');
       75     3839    1   DCL 1 FCN (0:50) CONSTANT,
       76     3840    1         2 NAME CHAR(12) INIT(
       77     3841    1    '            ',
       78     3842    1    'ROLLBACK    ',
       79     3843    1    'HERE-I-AM   ',
       80     3844    1    'READY       ',
       81     3845    1    'FINISH      ',
       82     3846    1    'STORE       ',
       83     3847    1    'ERASE       ',
       84     3848    1    'MODIFY      ',
       85     3849    1    'CONNECT     ',
       86     3850    1    'DISCONNECT  ',
       87     3851    1    'ACCEPT AREA ',
       88     3852    1    'ACCEPT CURR ',
       89     3853    1    'IF TENANT   ',
       90     3854    1    'IF SET      ',
       91     3855    1    'IF MEMBER   ',
       92     3856    1    'FND U/KY    ',
       93     3857    1    'FND U/KY CUR',
       94     3858    1    'FND DUP     ',
       95     3859    1    'FND CALC    ',
       96     3860    1    'FND DUP CLAC',
       97     3861    1    'FND OWNER   ',
       98     3862    1    'FND CUR TYPE',
       99     3863    1    'FND CUR RUN ',
      100     3864    1    'FND ABS SET ',
      101     3865    1    'FND ABS AREA',
      102     3866    1    'FND REL SET ',
      103     3867    1    'FND REL AREA',
      104     3868    1    'FND DIRECT  ',
      105     3869    1    'FND U/INDEX ',
      106     3870    1    'FND REL INDX',
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:17   
      107     3871    1    'GET RECORD  ',
      108     3872    1    'GET FIELDS  ',
      109     3873    1    'CHECKPOINT  ',
      110     3874    1    'TRACE ON    ',
      111     3875    1    'TRACE OFF   ',
      112     3876    1    'STATS ON    ',
      113     3877    1    'STATS OFF   ',
      114     3878    1    'SHARE IN    ',
      115     3879    1    'SHARE ALL   ',
      116     3880    1    'SHARE NONE  ',
      117     3881    1    'ENCRIPTION  ',
      118     3882    1    'REPORT STATS',
      119     3883    1    'SHARE CUR   ',
      120     3884    1    'BUFFERS     ',
      121     3885    1    'PRIVACY     ',
      122     3886    1    'INITIALIZE  ',
      123     3887    1    'SHARE ANY   ',
      124     3888    1    'CALC        ',
      125     3889    1    'KEEP        ',
      126     3890    1    'REDUCEQ     ',
      127     3891    1    'SHAREIN CUR ');
      128     3892        %EJECT;
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:18   
      129     3893        /*E*     ERROR:   ZIU-DBU#BADSYSID-C
      130     3894                 MESSAGE: User/Sysid %U1 does not exist or is illegal. */
      131     3895        /*E*     ERROR:   ZIU-DBU#NOASL-C
      132     3896                 MESSAGE: User/Sysid %U1 not associated with an ASL. */
      133     3897        /*E*     ERROR:   ZIU-DBU#NOTIDS-C
      134     3898                 MESSAGE: User/Sysid %U1 not associated with IDS ASL. */
      135     3899        /*
      136     3900                 VALIDATE USER/SYSID AND MAP ALS GLOBAL SEGMENT
      137     3901                 INPUT:   ZI$DIR.SYSID  AND  ZI$DIR.WAIT
      138     3902        */
      139     3903    1       CALL DAM$INIT ALTRET(ER_INIT);

   3903  4 000002   000000 631400 5                  EPPR1   0
         4 000003   000000 701000 xent               TSX1    DAM$INIT
         4 000004   000657 702000 4                  TSX2    ER_INIT

      140     3904    1       CALL M$MONINFO(FPT_MONINFO) ALTRET(ER_MON);

   3904  4 000005   000002 630400 2                  EPPR0   FPT_MONINFO
         4 000006   420023 713400                    CLIMB   alt,+8211
         4 000007   402400 401760                    pmme    nvectors=6
         4 000010   000627 702000 4                  TSX2    ER_MON

      141     3905    1       CALL DAM$MAP(VLR_MONPTRS.B$P$,B$P$,0,%MONWSR) ALTRET(ER_MAP);

   3905  4 000011   000002 630400 5                  EPPR0   2
         4 000012   000001 631400 5                  EPPR1   1
         4 000013   000000 701000 xent               TSX1    DAM$MAP
         4 000014   000657 702000 4                  TSX2    ER_INIT

      142     3906    1       IF ZI$DIR.SYSID<0 THEN /* SNAP BY USER# */

   3906  4 000015   000027 235000 xsym               LDA     ZI$DIR+23
         4 000016   000027 605000 4                  TPL     s:3913

      143     3907    2       DO;

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:19   
      144     3908    2           USER = -1 * ZI$DIR.SYSID;

   3908  4 000017   000000 531000                    NEG     0
         4 000020   200070 755100                    STA     USER,,AUTO

      145     3909    2           SYSID = B$USRT$->B$USER.SYSID(USER);

   3909  4 000021   000004 735000                    ALS     4
         4 000022   000000 470400 xsym               LDP0    B$USRT$
         4 000023   000014 236105                    LDQ     12,AL,PR0
         4 000024   777777 376007                    ANQ     -1,DL
         4 000025   200071 756100                    STQ     SYSID,,AUTO

      146     3910    2           END; /* BOTH USER# AND SYSID KNOWN */

   3910  4 000026   000053 710000 4                  TRA     FSYSID

      147     3911    1       ELSE
      148     3912    2       DO;

      149     3913    2           SYSID = ZI$DIR.SYSID;

   3913  4 000027   200071 755100                    STA     SYSID,,AUTO

      150     3914    3           DO USER=0 TO DA_MUAIS-1;

   3914  4 000030   200070 450100                    STZ     USER,,AUTO
         4 000031   000042 710000 4                  TRA     s:3917+1

      151     3915    3               IF B$USRT$->B$USER.SYSID(USER) = SYSID THEN

   3915  4 000032   200070 235100                    LDA     USER,,AUTO
         4 000033   000004 735000                    ALS     4
         4 000034   000000 470400 xsym               LDP0    B$USRT$
         4 000035   000014 236105                    LDQ     12,AL,PR0
         4 000036   777777 376007                    ANQ     -1,DL
         4 000037   200071 116100                    CMPQ    SYSID,,AUTO
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:20   
         4 000040   000053 600000 4                  TZE     FSYSID

      152     3916    3                   GOTO FSYSID;
      153     3917    3               END;

   3917  4 000041   200070 054100                    AOS     USER,,AUTO
         4 000042   200070 236100                    LDQ     USER,,AUTO
         4 000043   000032 604000 4                  TMI     s:3915
         4 000044   000000 116000 xsym               CMPQ    DA_MUAIS
         4 000045   000032 602000 4                  TNC     s:3915

      154     3918    2           ERRCODESF.ERR# = DBU#BADSYSID;

   3918  4 000046   000000 236000 xsym               LDQ     ERRCODESF
         4 000047   000006 376000 5                  ANQ     6
         4 000050   215520 276007                    ORQ     72528,DL
         4 000051   000000 756000 xsym               STQ     ERRCODESF

      155     3919    2           GOTO ER_DBU;

   3919  4 000052   000634 710000 4                  TRA     ER_DBU

      156     3920    2           END;
      157     3921    1   FSYSID: ERRCODESF.ERR# = DBU#NOASL;

   3921  4 000053   000000 236000 xsym  FSYSID       LDQ     ERRCODESF
         4 000054   000006 376000 5                  ANQ     6
         4 000055   215530 276007                    ORQ     72536,DL
         4 000056   000000 756000 xsym               STQ     ERRCODESF

      158     3922    1       IF B$USRT$->B$USER.ASL(USER)=0 THEN

   3922  4 000057   000006 236105                    LDQ     6,AL,PR0
         4 000060   000777 316007                    CANQ    511,DL
         4 000061   000634 600000 4                  TZE     ER_DBU

      159     3923    1           GOTO ER_DBU; /* NOT ASSOCIATED WITH ALT LIB */
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:21   
      160     3924
      161     3925    1       ASLNAME=B$P$->B$P.NAME(B$USRT$->B$USER.ASL(USER));

   3925  4 000062   000006 236105                    LDQ     6,AL,PR0
         4 000063   000777 376007                    ANQ     511,DL
         4 000064   000021 402007                    MPY     17,DL
         4 000065   000003 736000                    QLS     3
         4 000066   000000 471400 xsym               LDP1    B$P$
         4 000067   000100 100506                    MLR     fill='000'O
         4 000070   100032 000040                    ADSC9   26,Q,PR1                 cn=0,n=32
         4 000071   200006 000040                    ADSC9   ASLNAME,,AUTO            cn=0,n=32

      162     3926    1       ERRCODESF.ERR# = DBU#NOTIDS;

   3926  4 000072   000000 236000 xsym               LDQ     ERRCODESF
         4 000073   000006 376000 5                  ANQ     6
         4 000074   215540 276007                    ORQ     72544,DL
         4 000075   000000 756000 xsym               STQ     ERRCODESF

      163     3927    1       IF ASLNAME.COUNT<3 OR SUBSTR(ASLNAME.TEXT,0,3)~='IDS' THEN

   3927  4 000076   200006 236100                    LDQ     ASLNAME,,AUTO
         4 000077   777000 376003                    ANQ     -512,DU
         4 000100   003000 116003                    CMPQ    1536,DU
         4 000101   000634 602000 4                  TNC     ER_DBU
         4 000102   040000 106500                    CMPC    fill='040'O
         4 000103   200006 200003                    ADSC9   ASLNAME,,AUTO            cn=1,n=3
         4 000104   000317 000003 2                  ADSC9   FCN+153                  cn=0,n=3
         4 000105   000634 601000 4                  TNZ     ER_DBU

      164     3928    1           GOTO ER_DBU; /* THE ALT IS NOT IDS */
      165     3929        %EJECT;
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:22   
      166     3930    1       LSTATS='0'B;

   3930  4 000106   000000 100400                    MLR     fill='000'O
         4 000107   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000110   000000 002324 0                  ADSC9   LSTATS                   cn=0,n=1236

      167     3931    1       FPT_WAIT.V.UNITS#=ZI$DIR.WAIT;

   3931  4 000111   000030 235000 xsym               LDA     ZI$DIR+24
         4 000112   000472 755000 0                  STA     FPT_WAIT+4

      168     3932    1       DESTSF=%EXT#;

   3932  4 000113   000001 235007                    LDA     1,DL
         4 000114   000000 755000 xsym               STA     DESTSF

      169     3933    1       DATESF=VECTOR(TIME.DATE);

   3933  4 000115   000007 235000 5                  LDA     7
         4 000116   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000117   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000120   000057 036003                    ADLQ    47,DU
         4 000121   000000 755000 xsym               STA     DATESF
         4 000122   000001 756000 xsym               STQ     DATESF+1

      170     3934    1       TIMESF=VECTOR(TIME.TIME);

   3934  4 000123   000010 235000 5                  LDA     8
         4 000124   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000125   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000126   000011 036000 5                  ADLQ    9
         4 000127   000000 755000 xsym               STA     TIMESF
         4 000130   000001 756000 xsym               STQ     TIMESF+1

      171     3935    1       TSTAMPSF=VECTOR(TSTAMP);

   3935  4 000131   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:23   
         4 000132   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000133   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000134   000065 036003                    ADLQ    53,DU
         4 000135   000000 755000 xsym               STA     TSTAMPSF
         4 000136   000001 756000 xsym               STQ     TSTAMPSF+1

      172     3936    1       BUFSF=VECTOR(PRINTBUF.BUFFER);

   3936  4 000137   000012 235000 5                  LDA     10
         4 000140   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000141   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000142   000016 036003                    ADLQ    14,DU
         4 000143   000000 755000 xsym               STA     BUFSF
         4 000144   000001 756000 xsym               STQ     BUFSF+1

      173     3937    1       BUFLNSF=LENGTHC(PRINTBUF.BUFFER);

   3937  4 000145   000204 235007                    LDA     132,DL
         4 000146   000000 755000 xsym               STA     BUFLNSF

      174     3938    1       VFCSF=%YES#;

   3938  4 000147   400000 236003                    LDQ     -131072,DU
         4 000150   000000 756000 xsym               STQ     VFCSF

      175     3939    1       GLOBAL_ = VECTOR( IP$->GLOBAL );

   3939  4 000151   000013 235000 5                  LDA     11
         4 000152   000016 236000 2                  LDQ     IP
         4 000153   200004 757100                    STAQ    GLOBAL_,,AUTO

      176     3940
      177     3941    1   WAKEUP:
      178     3942    1       CALL DAM$MAP(IP$,GLOBAL$,SYSID,ASLDOMAIN,GLOBAL_) ALTRET(ER_MAP);

   3942  4 000154   200004 630500       WAKEUP       EPPR0   GLOBAL_,,AUTO
         4 000155   200100 450500                    STP0    BUFSTAT$+5,,AUTO
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:24   
         4 000156   000015 236000 5                  LDQ     13
         4 000157   200077 756100                    STQ     BUFSTAT$+4,,AUTO
         4 000160   200071 631500                    EPPR1   SYSID,,AUTO
         4 000161   200076 451500                    STP1    BUFSTAT$+3,,AUTO
         4 000162   200003 633500                    EPPR3   GLOBAL$,,AUTO
         4 000163   200075 453500                    STP3    BUFSTAT$+2,,AUTO
         4 000164   000016 236000 5                  LDQ     14
         4 000165   200074 756100                    STQ     BUFSTAT$+1,,AUTO
         4 000166   200074 630500                    EPPR0   BUFSTAT$+1,,AUTO
         4 000167   000014 631400 5                  EPPR1   12
         4 000170   000000 701000 xent               TSX1    DAM$MAP
         4 000171   000657 702000 4                  TSX2    ER_INIT

      179     3943    1       REC$ = GLOBAL$;

   3943  4 000172   200003 236100                    LDQ     GLOBAL$,,AUTO
         4 000173   000000 756000 xsym               STQ     REC$

      180     3944    1       CALL GETSEGSIZ; /* SEG SIZE RETURNED IN X */

   3944  4 000174   000000 631400 5                  EPPR1   0
         4 000175   000000 701000 xent               TSX1    GETSEGSIZ
         4 000176   000000 011000                    NOP     0

      181     3945    1       IF B$USRT$->B$USER.ASL(USER)=0 THEN

   3945  4 000177   200070 235100                    LDA     USER,,AUTO
         4 000200   000004 735000                    ALS     4
         4 000201   000000 470400 xsym               LDP0    B$USRT$
         4 000202   000006 236105                    LDQ     6,AL,PR0
         4 000203   000777 316007                    CANQ    511,DL
         4 000204   000215 601000 4                  TNZ     s:3952

      182     3946    2       DO;

      183     3947    2           FPT_WAIT.V.UNITS#=0; /* STOP LOOPING */

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:25   
   3947  4 000205   000472 450000 0                  STZ     FPT_WAIT+4

      184     3948    2           PRINTBUF.BUFFER='B  User has dis-associated with IDS.';

   3948  4 000206   040100 100400                    MLR     fill='040'O
         4 000207   000320 000044 2                  ADSC9   FCN+154                  cn=0,n=36
         4 000210   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132

      185     3949    2           CALL SYS_FUNC_WRIT ALTRET(ALT);

   3949  4 000211   000000 631400 5                  EPPR1   0
         4 000212   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000213   000664 702000 4                  TSX2    ALT

      186     3950    2           END;

   3950  4 000214   000617 710000 4                  TRA     s:4030

      187     3951    1       ELSE
      188     3952    1           IF X < 8 THEN /* MUST BE NULL SEG */

   3952  4 000215   000000 235000 xsym               LDA     X
         4 000216   000010 115007                    CMPA    8,DL
         4 000217   000227 605000 4                  TPL     s:3959

      189     3953    2           DO;

      190     3954    2               PRINTBUF.BUFFER='B  IDS not active, HIA not invoked yet.';

   3954  4 000220   040100 100400                    MLR     fill='040'O
         4 000221   000331 000047 2                  ADSC9   FCN+163                  cn=0,n=39
         4 000222   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132

      191     3955    2               CALL SYS_FUNC_WRIT ALTRET(ALT);

   3955  4 000223   000000 631400 5                  EPPR1   0
         4 000224   000000 701000 xent               TSX1    SYS_FUNC_WRIT
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:26   
         4 000225   000664 702000 4                  TSX2    ALT

      192     3956    2               END;

   3956  4 000226   000617 710000 4                  TRA     s:4030

      193     3957    1           ELSE
      194     3958    2           DO;

      195     3959    2               STATS$ = ADDR(GLOBAL.STATS.DBCS);

   3959  4 000227   200003 236100                    LDQ     GLOBAL$,,AUTO
         4 000230   001431 036003                    ADLQ    793,DU
         4 000231   200072 756100                    STQ     STATS$,,AUTO

      196     3960    2               TSTAMP = STATS.TSTAMP;

   3960  4 000232   200072 471500                    LDP1    STATS$,,AUTO
         4 000233   100000 235100                    LDA     0,,PR1
         4 000234   200065 755100                    STA     TSTAMP,,AUTO

      197     3961    2               PRINTBUF.BUFFER='0DBCS SNAPSHOT STATISTICS';

   3961  4 000235   040100 100400                    MLR     fill='040'O
         4 000236   000343 000031 2                  ADSC9   FCN+173                  cn=0,n=25
         4 000237   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132

      198     3962    2               SOURCESF=%UTS#;

   3962  4 000240   000004 235007                    LDA     4,DL
         4 000241   000000 755000 xsym               STA     SOURCESF

      199     3963    2               CALL SYS_FUNC_TSTAMP ALTRET(ER_MON);

   3963  4 000242   000000 631400 5                  EPPR1   0
         4 000243   000000 701000 xent               TSX1    SYS_FUNC_TSTAMP
         4 000244   000627 702000 4                  TSX2    ER_MON
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:27   

      200     3964    2               CALL INSERT(PRINTBUF.BUFFER,28,5,SUBSTR(TIME.TIME,0,5));

   3964  4 000245   040100 100500                    MLR     fill='040'O
         4 000246   200061 400005                    ADSC9   TIME+2,,AUTO             cn=2,n=5
         4 000247   200025 000005                    ADSC9   PRINTBUF+7,,AUTO         cn=0,n=5

      201     3965    2               CALL INSERT(PRINTBUF.BUFFER,34,10,TIME.DATE);

   3965  4 000250   040100 100500                    MLR     fill='040'O
         4 000251   200057 000012                    ADSC9   TIME,,AUTO               cn=0,n=10
         4 000252   200026 400012                    ADSC9   PRINTBUF+8,,AUTO         cn=2,n=10

      202     3966    2               CALL INSERT(PRINTBUF.BUFFER,45,1,'-');

   3966  4 000253   000055 236003                    LDQ     45,DU
         4 000254   200031 552120                    STBQ    PRINTBUF+11,'20'O,AUTO

      203     3967    2               SOURCESF=%CLOCK#;

   3967  4 000255   000000 450000 xsym               STZ     SOURCESF

      204     3968    2               CALL SYS_FUNC_TSTAMP ALTRET(ALT);

   3968  4 000256   000000 631400 5                  EPPR1   0
         4 000257   000000 701000 xent               TSX1    SYS_FUNC_TSTAMP
         4 000260   000664 702000 4                  TSX2    ALT

      205     3969    2               CALL INSERT(PRINTBUF.BUFFER,47,5,SUBSTR(TIME.TIME,0,5));

   3969  4 000261   040100 100500                    MLR     fill='040'O
         4 000262   200061 400005                    ADSC9   TIME+2,,AUTO             cn=2,n=5
         4 000263   200031 600005                    ADSC9   PRINTBUF+11,,AUTO        cn=3,n=5

      206     3970    2               CALL INSERT(PRINTBUF.BUFFER,53,10,TIME.DATE);

   3970  4 000264   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:28   
         4 000265   200057 000012                    ADSC9   TIME,,AUTO               cn=0,n=10
         4 000266   200033 200012                    ADSC9   PRINTBUF+13,,AUTO        cn=1,n=10

      207     3971    2               CALL SYS_FUNC_WRIT ALTRET(ALT);

   3971  4 000267   000000 631400 5                  EPPR1   0
         4 000270   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000271   000664 702000 4                  TSX2    ALT

      208     3972    2               PRINTBUF.BUFFER='C';

   3972  4 000272   040100 100400                    MLR     fill='040'O
         4 000273   000017 000001 5                  ADSC9   15                       cn=0,n=1
         4 000274   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132

      209     3973    2               CALL SYS_FUNC_WRIT ALTRET(ALT);

   3973  4 000275   000000 631400 5                  EPPR1   0
         4 000276   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000277   000664 702000 4                  TSX2    ALT

      210     3974    2               BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),14);

   3974  4 000300   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000301   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000302   000020 036000 5                  ADLQ    16
         4 000303   200073 756100                    STQ     BUFSTAT$,,AUTO

      211     3975    2               BUFSTAT$->STRING30 = 'page hits with XXX buffers.';

   3975  4 000304   200073 470500                    LDP0    BUFSTAT$,,AUTO
         4 000305   040100 100400                    MLR     fill='040'O
         4 000306   000352 000033 2                  ADSC9   FCN+180                  cn=0,n=27
         4 000307   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30

      212     3976    2               BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),29);

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:29   
   3976  4 000310   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000311   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000312   000021 036000 5                  ADLQ    17
         4 000313   200073 756100                    STQ     BUFSTAT$,,AUTO

      213     3977    2               CALL BINCHAR(BUFSTAT$->STRING3,GLOBAL.BCB.COUNT);

   3977  4 000314   200003 470500                    LDP0    GLOBAL$,,AUTO
         4 000315   000177 235100                    LDA     127,,PR0
         4 000316   000044 773000                    LRL     36
         4 000317   200074 757100                    STAQ    BUFSTAT$+1,,AUTO
         4 000320   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000321   000100 301500                    BTD
         4 000322   200074 000010                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 000323   100000 030003                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=3

      214     3978    2               BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),1);

   3978  4 000324   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000325   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000326   000022 036000 5                  ADLQ    18
         4 000327   200073 756100                    STQ     BUFSTAT$,,AUTO

      215     3979    2               CALL BINCHAR(BUFSTAT,STATS.HITS-LSTATS.HITS);

   3979  4 000330   200072 470500                    LDP0    STATS$,,AUTO
         4 000331   000003 236100                    LDQ     3,,PR0
         4 000332   000003 136000 0                  SBLQ    LSTATS+3
         4 000333   200074 756100                    STQ     BUFSTAT$+1,,AUTO
         4 000334   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000335   000100 301500                    BTD
         4 000336   200074 000004                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         4 000337   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

      216     3980    2               CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);

   3980  4 000340   100000 024500                    MVNE
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:30   
         4 000341   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
         4 000342   000000 000002 2                  ADSC9   MICRO_DEC12              cn=0,n=2
         4 000343   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      217     3981    2               CALL SYS_FUNC_WRIT ALTRET(ALT);

   3981  4 000344   000000 631400 5                  EPPR1   0
         4 000345   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000346   000664 702000 4                  TSX2    ALT

      218     3982    2               BUFSTAT$=PINCRC(ADDR(PRINTBUF.BUFFER),14);

   3982  4 000347   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000350   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000351   000020 036000 5                  ADLQ    16
         4 000352   200073 756100                    STQ     BUFSTAT$,,AUTO

      219     3983    2               BUFSTAT$->STRING30='I/O attempts.';

   3983  4 000353   200073 470500                    LDP0    BUFSTAT$,,AUTO
         4 000354   040100 100400                    MLR     fill='040'O
         4 000355   000361 000015 2                  ADSC9   FCN+187                  cn=0,n=13
         4 000356   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30

      220     3984    2               BUFSTAT$=PINCRC(ADDR(PRINTBUF.BUFFER),1);

   3984  4 000357   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000360   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000361   000022 036000 5                  ADLQ    18
         4 000362   200073 756100                    STQ     BUFSTAT$,,AUTO

      221     3985    2               CALL BINCHAR(BUFSTAT,STATS.REQS-LSTATS.REQS);

   3985  4 000363   200072 470500                    LDP0    STATS$,,AUTO
         4 000364   000002 236100                    LDQ     2,,PR0
         4 000365   000002 136000 0                  SBLQ    LSTATS+2
         4 000366   200074 756100                    STQ     BUFSTAT$+1,,AUTO
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:31   
         4 000367   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000370   000100 301500                    BTD
         4 000371   200074 000004                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         4 000372   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

      222     3986    2               CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);

   3986  4 000373   100000 024500                    MVNE
         4 000374   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
         4 000375   000000 000002 2                  ADSC9   MICRO_DEC12              cn=0,n=2
         4 000376   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      223     3987    2               CALL SYS_FUNC_WRIT ALTRET(ALT);

   3987  4 000377   000000 631400 5                  EPPR1   0
         4 000400   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000401   000664 702000 4                  TSX2    ALT

      224     3988    2               HEADING_FLAG=%YES#;

   3988  4 000402   400000 236003                    LDQ     -131072,DU
         4 000403   200067 756100                    STQ     HEADING_FLAG,,AUTO

      225     3989    3               DO J = 0 TO LAST#RPT#FCN;

   3989  4 000404   000000 450000 xsym               STZ     J

      226     3990    3                   IF STATS.COUNT.CALLS(J)-LSTATS.COUNT.CALLS(J)>0 THEN

   3990  4 000405   000000 236000 xsym               LDQ     J
         4 000406   000005 402007                    MPY     5,DL
         4 000407   000000 620006                    EAX0    0,QL
         4 000410   200072 470500                    LDP0    STATS$,,AUTO
         4 000411   000004 236110                    LDQ     4,X0,PR0
         4 000412   000004 136010 0                  SBLQ    LSTATS+4,X0
         4 000413   000607 604400 4                  TMOZ    s:4027

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:32   
      227     3991    4                   DO;

      228     3992    4                       IF BREAK_FLAG>0 THEN RETURN;

   3992  4 000414   000000 235000 xsym               LDA     BREAK_FLAG
         4 000415   000417 604400 4                  TMOZ    s:3993

   3992  4 000416   000000 702200 xent               TSX2  ! X66_ARET

      229     3993    4                       IF HEADING_FLAG THEN

   3993  4 000417   200067 234100                    SZN     HEADING_FLAG,,AUTO
         4 000420   000444 605000 4                  TPL     s:4003

      230     3994    5                       DO;

      231     3995    5                           HEADING_FLAG=%NO#;

   3995  4 000421   200067 450100                    STZ     HEADING_FLAG,,AUTO

      232     3996    5                           PRINTBUF.BUFFER=H1;

   3996  4 000422   040100 100400                    MLR     fill='040'O
         4 000423   000020 000111 2                  ADSC9   H1                       cn=0,n=73
         4 000424   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132

      233     3997    5                           CALL SYS_FUNC_WRIT ALTRET(ALT);

   3997  4 000425   000000 631400 5                  EPPR1   0
         4 000426   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000427   000664 702000 4                  TSX2    ALT

      234     3998    5                           PRINTBUF.BUFFER=H2;

   3998  4 000430   040100 100400                    MLR     fill='040'O
         4 000431   000043 000111 2                  ADSC9   H2                       cn=0,n=73
         4 000432   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:33   

      235     3999    5                           CALL SYS_FUNC_WRIT ALTRET(ALT);

   3999  4 000433   000000 631400 5                  EPPR1   0
         4 000434   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000435   000664 702000 4                  TSX2    ALT

      236     4000    5                           PRINTBUF.BUFFER = ' ';

   4000  4 000436   040100 100400                    MLR     fill='040'O
         4 000437   000023 000001 5                  ADSC9   19                       cn=0,n=1
         4 000440   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132

      237     4001    5                           PRINTBUF.BUFFER='A';

   4001  4 000441   040100 100400                    MLR     fill='040'O
         4 000442   000024 000001 5                  ADSC9   20                       cn=0,n=1
         4 000443   200016 000204                    ADSC9   PRINTBUF,,AUTO           cn=0,n=132

      238     4002    5                           END;

      239     4003    4                       BUFSTAT$ = PINCRC(ADDR(PRINTBUF.BUFFER),1);

   4003  4 000444   200074 452500                    STP2    BUFSTAT$+1,,AUTO
         4 000445   200074 236100                    LDQ     BUFSTAT$+1,,AUTO
         4 000446   000022 036000 5                  ADLQ    18
         4 000447   200073 756100                    STQ     BUFSTAT$,,AUTO

      240     4004    4                       BUFSTAT = FCN.NAME(J);

   4004  4 000450   000000 236000 xsym               LDQ     J
         4 000451   000014 402007                    MPY     12,DL
         4 000452   200073 470500                    LDP0    BUFSTAT$,,AUTO
         4 000453   040100 100406                    MLR     fill='040'O
         4 000454   000066 000014 2                  ADSC9   FCN,Q                    cn=0,n=12
         4 000455   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:34   
      241     4005    4                       BUFSTAT$ = PINCRC(BUFSTAT$,12);

   4005  4 000456   200073 236100                    LDQ     BUFSTAT$,,AUTO
         4 000457   000003 036003                    ADLQ    3,DU
         4 000460   200073 756100                    STQ     BUFSTAT$,,AUTO

      242     4006    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.CALLS(J)-

   4006  4 000461   000000 236000 xsym               LDQ     J
         4 000462   000005 402007                    MPY     5,DL
         4 000463   000000 620006                    EAX0    0,QL
         4 000464   200072 470500                    LDP0    STATS$,,AUTO
         4 000465   000004 236110                    LDQ     4,X0,PR0
         4 000466   000004 136010 0                  SBLQ    LSTATS+4,X0
         4 000467   200074 756100                    STQ     BUFSTAT$+1,,AUTO
         4 000470   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000471   000100 301500                    BTD
         4 000472   200074 000004                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         4 000473   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

      243     4007    4                          LSTATS.COUNT.CALLS(J));
      244     4008    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);

   4008  4 000474   100000 024500                    MVNE
         4 000475   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
         4 000476   000000 000002 2                  ADSC9   MICRO_DEC12              cn=0,n=2
         4 000477   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      245     4009    4                       BUFSTAT$ = PINCRC(BUFSTAT$,12);

   4009  4 000500   200073 236100                    LDQ     BUFSTAT$,,AUTO
         4 000501   000003 036003                    ADLQ    3,DU
         4 000502   200073 756100                    STQ     BUFSTAT$,,AUTO

      246     4010    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.READS(J)-

   4010  4 000503   000000 236000 xsym               LDQ     J
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:35   
         4 000504   000005 402007                    MPY     5,DL
         4 000505   000000 620006                    EAX0    0,QL
         4 000506   000005 236110                    LDQ     5,X0,PR0
         4 000507   000005 136010 0                  SBLQ    LSTATS+5,X0
         4 000510   200074 756100                    STQ     BUFSTAT$+1,,AUTO
         4 000511   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000512   000100 301500                    BTD
         4 000513   200074 000004                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         4 000514   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

      247     4011    4                          LSTATS.COUNT.READS(J));
      248     4012    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);

   4012  4 000515   100000 024500                    MVNE
         4 000516   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
         4 000517   000000 000002 2                  ADSC9   MICRO_DEC12              cn=0,n=2
         4 000520   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      249     4013    4                       BUFSTAT$ = PINCRC(BUFSTAT$,12);

   4013  4 000521   200073 236100                    LDQ     BUFSTAT$,,AUTO
         4 000522   000003 036003                    ADLQ    3,DU
         4 000523   200073 756100                    STQ     BUFSTAT$,,AUTO

      250     4014    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.WRITES(J)-

   4014  4 000524   000000 236000 xsym               LDQ     J
         4 000525   000005 402007                    MPY     5,DL
         4 000526   000000 620006                    EAX0    0,QL
         4 000527   000006 236110                    LDQ     6,X0,PR0
         4 000530   000006 136010 0                  SBLQ    LSTATS+6,X0
         4 000531   200074 756100                    STQ     BUFSTAT$+1,,AUTO
         4 000532   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000533   000100 301500                    BTD
         4 000534   200074 000004                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         4 000535   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:36   
      251     4015    4                          LSTATS.COUNT.WRITES(J));
      252     4016    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);

   4016  4 000536   100000 024500                    MVNE
         4 000537   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
         4 000540   000000 000002 2                  ADSC9   MICRO_DEC12              cn=0,n=2
         4 000541   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      253     4017    4                       BUFSTAT$=PINCRC(BUFSTAT$,12);

   4017  4 000542   200073 236100                    LDQ     BUFSTAT$,,AUTO
         4 000543   000003 036003                    ADLQ    3,DU
         4 000544   200073 756100                    STQ     BUFSTAT$,,AUTO

      254     4018    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.ENQS(J)-

   4018  4 000545   000000 236000 xsym               LDQ     J
         4 000546   000005 402007                    MPY     5,DL
         4 000547   000000 620006                    EAX0    0,QL
         4 000550   000007 236110                    LDQ     7,X0,PR0
         4 000551   000007 136010 0                  SBLQ    LSTATS+7,X0
         4 000552   200074 756100                    STQ     BUFSTAT$+1,,AUTO
         4 000553   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000554   000100 301500                    BTD
         4 000555   200074 000004                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         4 000556   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

      255     4019    4                          LSTATS.COUNT.ENQS(J));
      256     4020    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);

   4020  4 000557   100000 024500                    MVNE
         4 000560   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
         4 000561   000000 000002 2                  ADSC9   MICRO_DEC12              cn=0,n=2
         4 000562   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      257     4021    4                       BUFSTAT$=PINCRC(BUFSTAT$,12);

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:37   
   4021  4 000563   200073 236100                    LDQ     BUFSTAT$,,AUTO
         4 000564   000003 036003                    ADLQ    3,DU
         4 000565   200073 756100                    STQ     BUFSTAT$,,AUTO

      258     4022    4                       CALL BINCHAR(BUFSTAT,STATS.COUNT.LOCKS(J)-

   4022  4 000566   000000 236000 xsym               LDQ     J
         4 000567   000005 402007                    MPY     5,DL
         4 000570   000000 620006                    EAX0    0,QL
         4 000571   000010 236110                    LDQ     8,X0,PR0
         4 000572   000010 136010 0                  SBLQ    LSTATS+8,X0
         4 000573   200074 756100                    STQ     BUFSTAT$+1,,AUTO
         4 000574   200073 471500                    LDP1    BUFSTAT$,,AUTO
         4 000575   000100 301500                    BTD
         4 000576   200074 000004                    NDSC9   BUFSTAT$+1,,AUTO         cn=0,s=lsgnf,sf=0,n=4
         4 000577   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12

      259     4023    4                          LSTATS.COUNT.LOCKS(J));
      260     4024    4                       CALL EDITCHAR(BUFSTAT,,,MICRO_DEC12,BUFSTAT);

   4024  4 000600   100000 024500                    MVNE
         4 000601   100000 030014                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=12
         4 000602   000000 000002 2                  ADSC9   MICRO_DEC12              cn=0,n=2
         4 000603   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      261     4025    4                       CALL SYS_FUNC_WRIT ALTRET(ALT);

   4025  4 000604   000000 631400 5                  EPPR1   0
         4 000605   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000606   000664 702000 4                  TSX2    ALT

      262     4026    4                       END;

      263     4027    3                   END;

   4027  4 000607   000000 054000 xsym               AOS     J
         4 000610   000000 235000 xsym               LDA     J
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:38   
         4 000611   000062 115007                    CMPA    50,DL
         4 000612   000405 604400 4                  TMOZ    s:3990

      264     4028    2               LSTATS=STATS;

   4028  4 000613   200072 470500                    LDP0    STATS$,,AUTO
         4 000614   000000 100500                    MLR     fill='000'O
         4 000615   000000 002324                    ADSC9   0,,PR0                   cn=0,n=1236
         4 000616   000000 002324 0                  ADSC9   LSTATS                   cn=0,n=1236

      265     4029    2               END;

      266     4030    1       CALL M$WAIT(FPT_WAIT);

   4030  4 000617   000466 630400 0                  EPPR0   FPT_WAIT
         4 000620   020006 713400                    CLIMB   8198
         4 000621   400400 401760                    pmme    nvectors=2

      267     4031    1       IF FPT_WAIT.V.UNITS#>0 AND BREAK_FLAG=0 THEN

   4031  4 000622   000472 235000 0                  LDA     FPT_WAIT+4
         4 000623   000626 600000 4                  TZE     s:4033
         4 000624   000000 236000 xsym               LDQ     BREAK_FLAG
         4 000625   000154 600000 4                  TZE     WAKEUP

      268     4032    1           GOTO WAKEUP;
      269     4033    1       RETURN;

   4033  4 000626   000000 702200 xent               TSX2  ! X66_ARET

      270     4034    1   ER_MON: MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4034  4 000627   000000 470400 xsym  ER_MON       LDP0    B$TCB$
         4 000630   000000 471500                    LDP1    0,,PR0
         4 000631   100102 236100                    LDQ     66,,PR1
         4 000632   000000 756000 xsym               STQ     MSGCODE

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:39   
      271     4035    1       GOTO ERRMSG;

   4035  4 000633   000661 710000 4                  TRA     ERRMSG

      272     4036    1   ER_DBU: MSGCODE=ERRCODE_RDEF;

   4036  4 000634   000000 235000 xsym  ER_DBU       LDA     ERRCODESF
         4 000635   000000 755000 xsym               STA     MSGCODE

      273     4037    1       IF ZI$DIR.SYSID<0 THEN

   4037  4 000636   000027 236000 xsym               LDQ     ZI$DIR+23
         4 000637   000653 605000 4                  TPL     s:4043

      274     4038    2       DO;

      275     4039    2           CALL CONCAT(ERR_INSERT.TEXT(0),'.',USER_SYSID.TEXT);

   4039  4 000640   000056 236003                    LDQ     46,DU
         4 000641   000000 552020 xsym               STBQ    ERR_INSERT,'20'O
         4 000642   040000 100400                    MLR     fill='040'O
         4 000643   000000 200007 xsym               ADSC9   USER_SYSID               cn=1,n=7
         4 000644   000000 400035 xsym               ADSC9   ERR_INSERT               cn=2,n=29

      276     4040    2           ERR_INSERT.CNT(0)=USER_SYSID.COUNT+1;

   4040  4 000645   000000 236000 xsym               LDQ     USER_SYSID
         4 000646   000033 772000                    QRL     27
         4 000647   000001 036007                    ADLQ    1,DL
         4 000650   000033 736000                    QLS     27
         4 000651   000000 552040 xsym               STBQ    ERR_INSERT,'40'O

      277     4041    2           END;

   4041  4 000652   000656 710000 4                  TRA     s:4044

      278     4042    1       ELSE
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:40   
      279     4043    1           ERR_INSERT(0) = USER_SYSID;

   4043  4 000653   000000 100400                    MLR     fill='000'O
         4 000654   000000 000010 xsym               ADSC9   USER_SYSID               cn=0,n=8
         4 000655   000000 000037 xsym               ADSC9   ERR_INSERT               cn=0,n=31

      280     4044    1       GOTO ERRMSG;

   4044  4 000656   000661 710000 4                  TRA     ERRMSG

      281     4045    1   ER_INIT: ;

   4045  4 000657                       ER_INIT      null
   4045  4 000657                       ER_MAP       null
      282     4046    1   ER_MAP: ;
      283     4047    1       MONITOR_ERR=DA_MAPERR;

   4047  4 000657   000000 236000 xsym               LDQ     DA_MAPERR
         4 000660   000000 756000 xsym               STQ     MSGCODE

      284     4048    1   ERRMSG: CALL SYS_FUNC_ERRMSG ALTRET(ALT);

   4048  4 000661   000000 631400 5     ERRMSG       EPPR1   0
         4 000662   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 000663   000664 702000 4                  TSX2    ALT

      285     4049    1   ALT: ALTRETURN;

   4049  4 000664   000000 702200 xent  ALT          TSX2  ! X66_AALT

LSTATS
 Sect OctLoc
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

FPT_WAIT
 Sect OctLoc
   0     466   000001 777640   000472 006000   000000 177640   000000 006014    ................
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:41   
   0     472   000000 000000   000000 000001                                    ........

VLR_MONPTRS
 Sect OctLoc
   0     474   000000 006014   000000 006014   000000 006014   000000 006014    ................
   0     510*  000000 006014                                                    ....

MICRO_DEC12
 Sect OctLoc
   2     000   113321 ******                                                    K...

FPT_MONINFO
 Sect OctLoc
   2     002   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     006   000015 777640   000474 006000   000000 177640   000000 006014    ................
   2     012   000000 177640   000000 006014   000000 177640   000000 006014    ................

IP
 Sect OctLoc
   2     016   000000 006005                                                    ....

ASLDOMAIN
 Sect OctLoc
   2     017   000000 000006                                                    ....

H1
 Sect OctLoc
   2     020   101052 040040   040052 040040   040052 040040   040052 040040    A*   *   *   *
   2     024   040052 040040   040052 040040   040052 040040   123105 122126     *   *   *  SERV
   2     030   111103 105040   123124 101124   111123 124111   103123 040040    ICE STATISTICS
   2     034   052040 040040   052040 040040   052040 040040   052040 040040    *   *   *   *
   2     040   052040 040040   052040 040040   052*** ******                    *   *   *...

H2
 Sect OctLoc
   2     043   102106 165156   143164 151157   156040 040040   040040 040040    BFunction
   2     047   040040 040040   103141 154154   163040 040040   040040 040040        Calls
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:42   
   2     053   122145 141144   163040 040040   040040 040127   162151 164145    Reads      Write
   2     057   163040 040040   040040 040040   040105 156161   163040 040040    s        Enqs
   2     063   104145 141144   154157 143153   163*** ******                    Deadlocks...

FCN
 Sect OctLoc
   2     066   040040 040040   040040 040040   040040 040040   122117 114114                ROLL
   2     072   102101 103113   040040 040040   110105 122105   055111 055101    BACK    HERE-I-A
   2     076   115040 040040   122105 101104   131040 040040   040040 040040    M   READY
   2     102   106111 116111   123110 040040   040040 040040   123124 117122    FINISH      STOR
   2     106   105040 040040   040040 040040   105122 101123   105040 040040    E       ERASE
   2     112   040040 040040   115117 104111   106131 040040   040040 040040        MODIFY
   2     116   103117 116116   105103 124040   040040 040040   104111 123103    CONNECT     DISC
   2     122   117116 116105   103124 040040   101103 103105   120124 040101    ONNECT  ACCEPT A
   2     126   122105 101040   101103 103105   120124 040103   125122 122040    REA ACCEPT CURR
   2     132   111106 040124   105116 101116   124040 040040   111106 040123    IF TENANT   IF S
   2     136   105124 040040   040040 040040   111106 040115   105115 102105    ET      IF MEMBE
   2     142   122040 040040   106116 104040   125057 113131   040040 040040    R   FND U/KY
   2     146   106116 104040   125057 113131   040103 125122   106116 104040    FND U/KY CURFND
   2     152   104125 120040   040040 040040   106116 104040   103101 114103    DUP     FND CALC
   2     156   040040 040040   106116 104040   104125 120040   103114 101103        FND DUP CLAC
   2     162   106116 104040   117127 116105   122040 040040   106116 104040    FND OWNER   FND
   2     166   103125 122040   124131 120105   106116 104040   103125 122040    CUR TYPEFND CUR
   2     172   122125 116040   106116 104040   101102 123040   123105 124040    RUN FND ABS SET
   2     176   106116 104040   101102 123040   101122 105101   106116 104040    FND ABS AREAFND
   2     202   122105 114040   123105 124040   106116 104040   122105 114040    REL SET FND REL
   2     206   101122 105101   106116 104040   104111 122105   103124 040040    AREAFND DIRECT
   2     212   106116 104040   125057 111116   104105 130040   106116 104040    FND U/INDEX FND
   2     216   122105 114040   111116 104130   107105 124040   122105 103117    REL INDXGET RECO
   2     222   122104 040040   107105 124040   106111 105114   104123 040040    RD  GET FIELDS
   2     226   103110 105103   113120 117111   116124 040040   124122 101103    CHECKPOINT  TRAC
   2     232   105040 117116   040040 040040   124122 101103   105040 117106    E ON    TRACE OF
   2     236   106040 040040   123124 101124   123040 117116   040040 040040    F   STATS ON
   2     242   123124 101124   123040 117106   106040 040040   123110 101122    STATS OFF   SHAR
   2     246   105040 111116   040040 040040   123110 101122   105040 101114    E IN    SHARE AL
   2     252   114040 040040   123110 101122   105040 116117   116105 040040    L   SHARE NONE
   2     256   105116 103122   111120 124111   117116 040040   122105 120117    ENCRIPTION  REPO
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:43   
   2     262   122124 040123   124101 124123   123110 101122   105040 103125    RT STATSSHARE CU
   2     266   122040 040040   102125 106106   105122 123040   040040 040040    R   BUFFERS
   2     272   120122 111126   101103 131040   040040 040040   111116 111124    PRIVACY     INIT
   2     276   111101 114111   132105 040040   123110 101122   105040 101116    IALIZE  SHARE AN
   2     302   131040 040040   103101 114103   040040 040040   040040 040040    Y   CALC
   2     306   113105 105120   040040 040040   040040 040040   122105 104125    KEEP        REDU
   2     312   103105 121040   040040 040040   123110 101122   105111 116040    CEQ     SHAREIN
   2     316   103125 122040                                                    CUR

(unnamed)
 Sect OctLoc
   2     317   111104 123040   102040 040125   163145 162040   150141 163040    IDS B  User has
   2     323   144151 163055   141163 163157   143151 141164   145144 040167    dis-associated w
   2     327   151164 150040   111104 123056   102040 040111   104123 040156    ith IDS.B  IDS n
   2     333   157164 040141   143164 151166   145054 040110   111101 040156    ot active, HIA n
   2     337   157164 040151   156166 157153   145144 040171   145164 056040    ot invoked yet.
   2     343   060104 102103   123040 123116   101120 123110   117124 040123    0DBCS SNAPSHOT S
   2     347   124101 124111   123124 111103   123040 040040   160141 147145    TATISTICS   page
   2     353   040150 151164   163040 167151   164150 040130   130130 040142     hits with XXX b
   2     357   165146 146145   162163 056040   111057 117040   141164 164145    uffers. I/O atte
   2     363   155160 164163   056040 040040                                    mpts.

(unnamed)
 Sect OctLoc
   5     000   000000 000000   000004 000000   000500 006000   000000 006000    ................
   5     004   000000 006000   000000 006000   777777 400007   000002 377640    ................
   5     010   000002 577640   000061 400000   000040 777640   005153 777640    .....1... ...k..
   5     014   000005 000000   000017 006000   000016 006000   103040 040040    ............C
   5     020   000021 400000   000025 200000   000016 200000   040040 040040    ............
   5     024   101040 040040                                                    A
      286     4050    1   END ZIU$SNAP;
      287     4051        %EOD;

PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:44   
--  Include file information  --

   B_SEGIDS_C.:LIB_E05  is referenced.
   B_STRINGS_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$P.:LIB_E05  cannot be made into a system file and is referenced.
   B$USER.:LIB_E05  cannot be made into a system file and is referenced.
   B_MICROPS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$SNAP.

   Procedure ZIU$SNAP requires 437 words for executable code.
   Procedure ZIU$SNAP requires 66 words of local(AUTO) storage.
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:45   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:46   
          MINI XREF LISTING

ALT
      4049**LABEL    3949--CALLALT  3955--CALLALT  3968--CALLALT  3971--CALLALT  3973--CALLALT  3981--CALLALT
      3987--CALLALT  3997--CALLALT  3999--CALLALT  4025--CALLALT  4048--CALLALT
ASLDOMAIN
      3821**DCL      3942<>CALL
ASLNAME
      3809**DCL      3925<<ASSIGN
ASLNAME.COUNT
      3810**DCL      3927>>IF
ASLNAME.TEXT
      3811**DCL      3927>>IF
B$ALT.CODE
      2062**DCL      2062--REDEF    2063--REDEF    2063--REDEF
B$ALT.ERR
      2063**DCL      4034>>ASSIGN
B$ALT.ERR.ERR#
      2064**DCL      2064--REDEF
B$ALT.EVID
      2063**DCL      2063--REDEF    2063--REDEF
B$DO.ECCINFO
      1783**DCL      1784--REDEF
B$P.NAME
      1880**DCL      3925>>ASSIGN
B$P$
      1910**DCL      3905<>CALL     3925>>ASSIGN
B$TCB.ALT$
      2058**DCL      4034>>ASSIGN
B$TCB$
      1441**DCL      4034>>ASSIGN
B$U.MISC
      1762**DCL      1763--REDEF
B$USER.ASL
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:47   
      1817**DCL      3922>>IF       3925>>ASSIGN   3945>>IF
B$USER.MISC
      1838**DCL      1839--REDEF
B$USER.SYSID
      1833**DCL      3909>>ASSIGN   3915>>IF
B$USRT$
      3818**DCL      3909>>ASSIGN   3915>>IF       3922>>IF       3925>>ASSIGN   3945>>IF
BREAK_FLAG
      1451**DCL      3992>>IF       4031>>IF
BUFLNSF
      1342**DCL      3937<<ASSIGN
BUFSF
      1343**DCL      3936<<ASSIGN
BUFSTAT
      3830**DCL      3979<<CALLBLT  3980<<CALLBLT  3980>>CALLBLT  3985<<CALLBLT  3986<<CALLBLT  3986>>CALLBLT
      4004<<ASSIGN   4006<<CALLBLT  4008<<CALLBLT  4008>>CALLBLT  4010<<CALLBLT  4012<<CALLBLT  4012>>CALLBLT
      4014<<CALLBLT  4016<<CALLBLT  4016>>CALLBLT  4018<<CALLBLT  4020<<CALLBLT  4020>>CALLBLT  4022<<CALLBLT
      4024<<CALLBLT  4024>>CALLBLT
BUFSTAT$
      3829**DCL      3830--IMP-PTR  3974<<ASSIGN   3975>>ASSIGN   3976<<ASSIGN   3977>>CALLBLT  3978<<ASSIGN
      3979>>CALLBLT  3980>>CALLBLT  3980>>CALLBLT  3982<<ASSIGN   3983>>ASSIGN   3984<<ASSIGN   3985>>CALLBLT
      3986>>CALLBLT  3986>>CALLBLT  4003<<ASSIGN   4004>>ASSIGN   4005<<ASSIGN   4005>>ASSIGN   4006>>CALLBLT
      4008>>CALLBLT  4008>>CALLBLT  4009<<ASSIGN   4009>>ASSIGN   4010>>CALLBLT  4012>>CALLBLT  4012>>CALLBLT
      4013<<ASSIGN   4013>>ASSIGN   4014>>CALLBLT  4016>>CALLBLT  4016>>CALLBLT  4017<<ASSIGN   4017>>ASSIGN
      4018>>CALLBLT  4020>>CALLBLT  4020>>CALLBLT  4021<<ASSIGN   4021>>ASSIGN   4022>>CALLBLT  4024>>CALLBLT
      4024>>CALLBLT
COUNTSF
      1393**DCL      1394--REDEF
DAM$INIT
      3797**DCL-ENT  3903--CALL
DAM$MAP
      3798**DCL-ENT  3905--CALL     3942--CALL
DATESF
      1346**DCL      3933<<ASSIGN
DA_MAPERR
      3799**DCL      4047>>ASSIGN
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:48   
DA_MUAIS
      3805**DCL      3914>>DOINDEX
DESTSF
      1345**DCL      3932<<ASSIGN
ENCRP_SEEDSF
      1351**DCL      1352--REDEF
ERRCODESF
      1353**DCL      1358--REDEF
ERRCODESF.ERR#
      1356**DCL      3918<<ASSIGN   3921<<ASSIGN   3926<<ASSIGN
ERRCODE_RDEF
      1358**DCL      4036>>ASSIGN
ERRMSG
      4048**LABEL    4035--GOTO     4044--GOTO
ERR_INSERT
      1366**DCL      4043<<ASSIGN
ERR_INSERT.CNT
      1367**DCL      4040<<ASSIGN
ERR_INSERT.TEXT
      1368**DCL      4039<<CALLBLT
ER_DBU
      4036**LABEL    3919--GOTO     3923--GOTO     3928--GOTO
ER_INIT
      4045**LABEL    3903--CALLALT
ER_MAP
      4045**LABEL    3905--CALLALT  3942--CALLALT
ER_MON
      4034**LABEL    3904--CALLALT  3963--CALLALT
FCN.NAME
      3840**DCL      4004>>ASSIGN
FIDSF_RD
      1369**DCL      1370--REDEF
FPT_MONINFO
      2038**DCL      3904<>CALL
FPT_WAIT
      2024**DCL      4030<>CALL
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:49   
FPT_WAIT.V
      2025**DCL      2024--DCLINIT
FPT_WAIT.V.UNITS#
      2025**DCL      3931<<ASSIGN   3947<<ASSIGN   4031>>IF
FSYSID
      3921**LABEL    3916--GOTO
GETSEGSIZ
      3833**DCL-ENT  3944--CALL
GLOBAL
       494**DCL      3939--ASSIGN
GLOBAL.ACTIVE.DBCB$
       500**DCL       501--REDEF
GLOBAL.ACTIVE.SSS$
       496**DCL       497--REDEF
GLOBAL.BCB.COUNT
       603**DCL      3977>>CALLBLT
GLOBAL.KEY
       704**DCL       707--REDEF
GLOBAL.PARAN.TRACE.MODE
       579**DCL       586--REDEF
GLOBAL.PRINTBUF.BUFFER
       738**DCL       739--REDEF     740--REDEF     741--REDEF
GLOBAL.PRINTBUF.ERR.V
       743**DCL       746--REDEF     747--REDEF     748--REDEF
GLOBAL.STATS.DBCS
       658**DCL      3959--ASSIGN
GLOBAL$
       798**DCL       494--IMP-PTR  3942<>CALL     3943>>ASSIGN   3959>>ASSIGN   3977>>CALLBLT
GLOBAL_
      3804**DCL      3939<<ASSIGN   3942<>CALL
H1
      3835**DCL      3996>>ASSIGN
H2
      3837**DCL      3998>>ASSIGN
HEADING_FLAG
      3825**DCL      3988<<ASSIGN   3993>>IF       3995<<ASSIGN
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:50   
HELPCODE
      1387**DCL      1392--REDEF
ICHKSUM
      1452**DCL      1453--REDEF
IP
      3800**DCL      3803--REDEF
IP$
      3803**DCL      3939>>ASSIGN   3942<>CALL
I_O_BUF$
      1430**DCL      1431--IMP-PTR
J
      1426**DCL      3989<<DOINDEX  3990>>IF       3990>>IF       4004>>ASSIGN   4006>>CALLBLT  4006>>CALLBLT
      4010>>CALLBLT  4010>>CALLBLT  4014>>CALLBLT  4014>>CALLBLT  4018>>CALLBLT  4018>>CALLBLT  4022>>CALLBLT
      4022>>CALLBLT
KEYVSF
      1325**DCL      1330--REDEF
KEYVSF.WD_ONE
      1327**DCL      1328--REDEF
LSTATS
       821**DCL      3930<<ASSIGN   4028<<ASSIGN
LSTATS.COUNT.CALLS
       827**DCL      3990>>IF       4006>>CALLBLT
LSTATS.COUNT.ENQS
       830**DCL      4018>>CALLBLT
LSTATS.COUNT.LOCKS
       831**DCL      4022>>CALLBLT
LSTATS.COUNT.READS
       828**DCL      4010>>CALLBLT
LSTATS.COUNT.WRITES
       829**DCL      4014>>CALLBLT
LSTATS.HITS
       825**DCL      3979>>CALLBLT
LSTATS.REQS
       824**DCL      3985>>CALLBLT
M$MONINFO
      2009**DCL-ENT  3904--CALL
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:51   
M$WAIT
      1999**DCL-ENT  4030--CALL
MICRO_DEC12
      1629**DCL      3980>>CALLBLT  3986>>CALLBLT  4008>>CALLBLT  4012>>CALLBLT  4016>>CALLBLT  4020>>CALLBLT
      4024>>CALLBLT
MONITOR_ERR
      1360**DCL      4034<<ASSIGN   4047<<ASSIGN
MSGCODE
      1359**DCL      1360--REDEF    4036<<ASSIGN
PRINTBUF.BUFFER
      3813**DCL      3936--ASSIGN   3937--ASSIGN   3948<<ASSIGN   3954<<ASSIGN   3961<<ASSIGN   3964<<CALLBLT
      3965<<CALLBLT  3966<<CALLBLT  3969<<CALLBLT  3970<<CALLBLT  3972<<ASSIGN   3974--ASSIGN   3976--ASSIGN
      3978--ASSIGN   3982--ASSIGN   3984--ASSIGN   3996<<ASSIGN   3998<<ASSIGN   4000<<ASSIGN   4001<<ASSIGN
      4003--ASSIGN
REC$
      1411**DCL      1434--IMP-PTR  3943<<ASSIGN
REC_DATA_LN
      1439**DCL      1438--IMP-SIZ
SOURCESF
      1344**DCL      3962<<ASSIGN   3967<<ASSIGN
STATS
       805**DCL      4028>>ASSIGN
STATS.COUNT.CALLS
       811**DCL      3990>>IF       4006>>CALLBLT
STATS.COUNT.ENQS
       814**DCL      4018>>CALLBLT
STATS.COUNT.LOCKS
       815**DCL      4022>>CALLBLT
STATS.COUNT.READS
       812**DCL      4010>>CALLBLT
STATS.COUNT.WRITES
       813**DCL      4014>>CALLBLT
STATS.HITS
       809**DCL      3979>>CALLBLT
STATS.REQS
       808**DCL      3985>>CALLBLT
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:52   
STATS.TSTAMP
       806**DCL      3960>>ASSIGN
STATS$
      3828**DCL       805--IMP-PTR  3959<<ASSIGN   3960>>ASSIGN   3979>>CALLBLT  3985>>CALLBLT  3990>>IF
      4006>>CALLBLT  4010>>CALLBLT  4014>>CALLBLT  4018>>CALLBLT  4022>>CALLBLT  4028>>ASSIGN
STRING3
      3831**DCL      3977<<CALLBLT
STRING30
      3834**DCL      3975<<ASSIGN   3983<<ASSIGN
SYSID
      3827**DCL      3909<<ASSIGN   3913<<ASSIGN   3915>>IF       3942<>CALL
SYS_FUNC_ERRMSG
      3824**DCL-ENT  4048--CALL
SYS_FUNC_TSTAMP
      3823**DCL-ENT  3963--CALL     3968--CALL
SYS_FUNC_WRIT
      3822**DCL-ENT  3949--CALL     3955--CALL     3971--CALL     3973--CALL     3981--CALL     3987--CALL
      3997--CALL     3999--CALL     4025--CALL
TIME.DATE
      3815**DCL      3933--ASSIGN   3965>>CALLBLT  3970>>CALLBLT
TIME.TIME
      3816**DCL      3934--ASSIGN   3964>>CALLBLT  3969>>CALLBLT
TIMESF
      1347**DCL      3934<<ASSIGN
TSTAMP
      3819**DCL      3935--ASSIGN   3960<<ASSIGN
TSTAMPSF
      1350**DCL      3935<<ASSIGN
USER
      3826**DCL      3908<<ASSIGN   3909>>ASSIGN   3914<<DOINDEX  3915>>IF       3922>>IF       3925>>ASSIGN
      3945>>IF
USER_SYSID
      3806**DCL      4043>>ASSIGN
USER_SYSID.COUNT
      3807**DCL      4040>>ASSIGN
USER_SYSID.TEXT
PL6.E3A0      #001=ZIU$SNAP File=ZIU$SNAP.:ZIC0TSI                               FRI 09/05/97 13:32 Page:53   
      3808**DCL      4039>>CALLBLT
VFCSF
      1339**DCL      3938<<ASSIGN
VLR_MONPTRS
      2053**DCL      2039--DCLINIT
VLR_MONPTRS.B$P$
      2054**DCL      3905<>CALL
WAKEUP
      3942**LABEL    4032--GOTO
X
      1428**DCL      3952>>IF
ZI$DIR.ALTKEY
      1062**DCL      1063--REDEF    1064--REDEF
ZI$DIR.AREAFID
      1028**DCL      1029--REDEF
ZI$DIR.DATE
      1067**DCL      1071--REDEF
ZI$DIR.DEST_SEED
      1023**DCL      1024--REDEF    1025--REDEF
ZI$DIR.ENCP_SEED
      1020**DCL      1021--REDEF    1022--REDEF
ZI$DIR.REPRT_ZERO
      1054**DCL      1055--REDEF
ZI$DIR.SCHFID
      1026**DCL      1027--REDEF
ZI$DIR.SYSID
      1022**DCL      3906>>IF       3908>>ASSIGN   3913>>ASSIGN   4037>>IF
ZI$DIR.TIME
      1072**DCL      1077--REDEF
ZI$DIR.WAIT
      1025**DCL      3931>>ASSIGN

PL6.E3A0      #002=ZIU$SNAP_D File=ZIU$SNAP.:ZIC0TSI                             FRI 09/05/97 13:32 Page:54   
      288        1        /*T***********************************************************/
      289        2        /*T*                                                         */
      290        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      291        4        /*T*                                                         */
      292        5        /*T***********************************************************/
      293        6        ZIU$SNAP_D: PROC;
      294        7    1   DCL B$P$ PTR STATIC SYMDEF;
      295        8    1   DCL B$LOOKUP$ PTR STATIC SYMDEF;
      296        9    1   DCL P_MAXPROCS UBIN WORD STATIC SYMDEF;
      297       10    1   DCL P_NPROCS UBIN WORD STATIC SYMDEF;
      298       11    1   DCL P_AUTOSPACE UBIN WORD STATIC SYMDEF;
      299       12    1   DCL P_AUTO_START UBIN WORD STATIC SYMDEF;
      300       13    1   DCL P_LAST_AUTO UBIN WORD STATIC SYMDEF;
      301       14    1   DCL P_MAX_LOOKUP UBIN WORD STATIC SYMDEF;
      302       15    1   DCL P_USED_AUTO UBIN WORD STATIC SYMDEF;
      303       16    1   END ZIU$SNAP_D;

PL6.E3A0      #002=ZIU$SNAP_D File=ZIU$SNAP.:ZIC0TSI                             FRI 09/05/97 13:32 Page:55   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIU$SNAP_D.

   No code generated for procedure ZIU$SNAP_D .
   Procedure ZIU$SNAP_D requires 4 words of local(AUTO) storage.

    No errors detected in file ZIU$SNAP.:ZIC0TSI    .

PL6.E3A0      #002=ZIU$SNAP_D File=ZIU$SNAP.:ZIC0TSI                             FRI 09/05/97 13:32 Page:56   

 Object Unit name= ZIU$SNAP_D                                 File name= ZIU$SNAP.:ZIC0TOU
 UTS= SEP 05 '97 13:32:27.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     9     11  ZIU$SNAP_D
    1   Proc  even  none     0      0  ZIU$SNAP_D

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes     ~proc       0  ZIU$SNAP_D

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  B$P$                               0      1  B$LOOKUP$
    0      2  P_MAXPROCS                         0      3  P_NPROCS
    0      4  P_AUTOSPACE                        0      5  P_AUTO_START
    0      6  P_LAST_AUTO                        0      7  P_MAX_LOOKUP
    0     10  P_USED_AUTO
PL6.E3A0      #002=ZIU$SNAP_D File=ZIU$SNAP.:ZIC0TSI                             FRI 09/05/97 13:32 Page:57   

      288        1        /*T***********************************************************/
      289        2        /*T*                                                         */
      290        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      291        4        /*T*                                                         */
      292        5        /*T***********************************************************/
      293        6        ZIU$SNAP_D: PROC;
      294        7    1   DCL B$P$ PTR STATIC SYMDEF;
      295        8    1   DCL B$LOOKUP$ PTR STATIC SYMDEF;
      296        9    1   DCL P_MAXPROCS UBIN WORD STATIC SYMDEF;
      297       10    1   DCL P_NPROCS UBIN WORD STATIC SYMDEF;
      298       11    1   DCL P_AUTOSPACE UBIN WORD STATIC SYMDEF;
      299       12    1   DCL P_AUTO_START UBIN WORD STATIC SYMDEF;
      300       13    1   DCL P_LAST_AUTO UBIN WORD STATIC SYMDEF;
      301       14    1   DCL P_MAX_LOOKUP UBIN WORD STATIC SYMDEF;
      302       15    1   DCL P_USED_AUTO UBIN WORD STATIC SYMDEF;
      303       16    1   END ZIU$SNAP_D;

PL6.E3A0      #002=ZIU$SNAP_D File=ZIU$SNAP.:ZIC0TSI                             FRI 09/05/97 13:32 Page:58   
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIU$SNAP_D.

   No code generated for procedure ZIU$SNAP_D .
   Procedure ZIU$SNAP_D requires 4 words of local(AUTO) storage.

    No errors detected in file ZIU$SNAP.:ZIC0TSI    .
PL6.E3A0      #002=ZIU$SNAP_D File=ZIU$SNAP.:ZIC0TSI                             FRI 09/05/97 13:32 Page:59   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ZIU$SNAP_D File=ZIU$SNAP.:ZIC0TSI                             FRI 09/05/97 13:32 Page:60   
          MINI XREF LISTING

