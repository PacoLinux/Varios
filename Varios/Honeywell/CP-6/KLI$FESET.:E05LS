VERSION E05

PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:1    
        1        1        /*M* KLI$FESET Routines to control and report FEP condition*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        /**/
        9        9        /**/
       10       10        KLI$FESET: PROC;
       11       11        /**/
       12       12        /**/
       13       13        %INCLUDE CP_6;
       14       94        %INCLUDE JC_SCODE_C;
       15      110        %INCLUDE KL_DATA_R;
       16      574        %INCLUDE KL_MACRO_C;
       17     3926        %INCLUDE KL_AFCN_C;
       18     4027        /**/
       19     4028    1   DCL FOI$CRASH ENTRY(3) ALTRET;
       20     4029    1   DCL FOI$CRASHGO ENTRY(3) ALTRET;
       21     4030    1   DCL KLH$OPFILS ENTRY ALTRET;
       22     4031        /**/
       23     4032        /**/
       24     4033        %FPT_OPEN (FPTN=OPNCG,STCLASS=CONSTANT,DCB=M$HLP,NAME=HLPCG,CTG=YES,
       25     4034                   ASN=COMGROUP,FUN=CREATE,EXIST=NEWFILE,AU=YES,
       26     4035                   SHARE=ALL,SETSTA=CSST,IXTNSIZE=100,ACSVEH=HLPCG_ACSVEH);
       27     4144        %VLP_ATTR (FPTN=HLPCG_ACSVEH);
       28     4158        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='SLUG');
       29     4175        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='NETCON?');
       30     4192        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='STATS?',LAST=";");
       31     4209        %FPT_CGCTL (FPTN=HLPCTL,STCLASS=CONSTANT,DCB=M$HLP,CGCP=HLPPRM);
       32     4232        %VLP_CGCP (FPTN=HLPPRM,STCLASS=CONSTANT,CONMSG=YES,
       33     4233                   TERMCONAU=NO,DCBCONAU=YES,TERMCONNAU=NO,DCBCONNAU=NO,
       34     4234                   AUCONTERM=NC,AUCONDCB=DEACTIVATE,AUDCONTERM=NC,
       35     4235                   AUDCONDCB=DEACTIVATE,XSTALGL=YES,WAS=NO,RAS=NO,SMD=NO,XTYPLGL=YES,
       36     4236                   MAXMC=4096,DCBCONLGL=YES,TERMCONLGL=YES,INPUT=YES,OUTPUT=YES,
       37     4237        /* DRML=YES is required to keep SLUG from being SQA'd when a FEP is hung */
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:2    
       38     4238                   TRMRDSIZ=2048,DRML=YES,MINPG=3,DATAPGS=67,
       39     4239                  MAXPG=50,
       40     4240                   SECURE=NO);
       41     4283        %FPT_READ (FPTN=KL_RDHLP,STCLASS=SYMREF);
       42     4322        %VLP_NAME (FPTN=HLPCG,NAME='HLPCG',STCLASS=CONSTANT);
       43     4349        %VLP_SETSTA (FPTN=CSST,STCLASS=CONSTANT,MYSTATION='HLPADMIN');
       44     4377        /**/
       45     4378        %SUB F_KL='1314'O;
       46     4379        %SUB M_I='11'O;
       47     4380        /**/
       48     4381    1   REOPN:;
       49     4382    1        CALL M$OPEN (OPNCG) ALTRET (SC1);
       50     4383    1        CALL M$CGCTL (HLPCTL) ALTRET (SC1);
       51     4384    1        CALL M$READ (KL_RDHLP) ALTRET (SC2);
       52     4385    1        RETURN;
       53     4386        /**/
       54     4387    1   SC1: ;
       55     4388    1        CALL FOI$CRASHGO (%S$NOPHLP,F_KL,M_I);
       56     4389        /*S*  SCREECH_CODE: KLI-S$NOPHLP
       57     4390              TYPE:    Screech
       58     4391              MESSAGE: SLUG unable to open the HLPCG comgroup
       59     4392              REMARKS: SLUG communicates with the administrators of FEPs via the
       60     4393                       HLPCG comgroup.  This screech occurs when he gets an ALTRET
       61     4394                       on his M$OPEN to that CG.                                     */
       62     4395    1        GOTO REOPN;
       63     4396        /**/
       64     4397    1   SC2: ;
       65     4398    1        CALL FOI$CRASH (%S$NRDHLP,F_KL,M_I);
       66     4399        /*S*  SCREECH_CODE: KLI-S$NRDHLP
       67     4400              TYPE:    Screech
       68     4401              MESSAGE: SLUG got ALTRET reading HLPCG
       69     4402              REMARKS: Due to the nature of comgroups, SLUG should never get an
       70     4403                       ALTRET on his anonomous M$READ to HLPCG.  This screech
       71     4404                       occurs on the exception to that rule.                         */
       72     4405        /**/
       73     4406    1   END;
       74     4407        /**/
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:3    
       75     4408        /**/
       76     4409        %EOD;

PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:4    
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$FESET.

   Procedure KLI$FESET requires 25 words for executable code.
   Procedure KLI$FESET requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:5    

 Object Unit name= KLI$FESET                                  File name= KLI$FESET.:E05TOU
 UTS= JUL 30 '97 00:49:28.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$HLP
    2  RoData even  UTS    144    220  KLI$FESET
    3   Data  even  none     8     10  KLI$FESET
    4   Proc  even  none    25     31  KLI$FESET
    5  RoData even  none    10     12  KLI$FESET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  KLI$FESET

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 FOI$CRASHGO
 yes     yes           Std       3 FOI$CRASH
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:6    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$HLP                                 KL_RDHLP
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:7    


        1        1        /*M* KLI$FESET Routines to control and report FEP condition*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        /**/
        9        9        /**/
       10       10        KLI$FESET: PROC;

     10  4 000000   000000 700200 xent  KLI$FESET    TSX0  ! X66_AUTO_0
         4 000001   000004 000000                    ZERO    4,0

       11       11        /**/
       12       12        /**/
       13       13        %INCLUDE CP_6;
       14       94        %INCLUDE JC_SCODE_C;
       15      110        %INCLUDE KL_DATA_R;
       16      574        %INCLUDE KL_MACRO_C;
       17     3926        %INCLUDE KL_AFCN_C;
       18     4027        /**/
       19     4028    1   DCL FOI$CRASH ENTRY(3) ALTRET;
       20     4029    1   DCL FOI$CRASHGO ENTRY(3) ALTRET;
       21     4030    1   DCL KLH$OPFILS ENTRY ALTRET;
       22     4031        /**/
       23     4032        /**/
       24     4033        %FPT_OPEN (FPTN=OPNCG,STCLASS=CONSTANT,DCB=M$HLP,NAME=HLPCG,CTG=YES,
       25     4034                   ASN=COMGROUP,FUN=CREATE,EXIST=NEWFILE,AU=YES,
       26     4035                   SHARE=ALL,SETSTA=CSST,IXTNSIZE=100,ACSVEH=HLPCG_ACSVEH);
       27     4144        %VLP_ATTR (FPTN=HLPCG_ACSVEH);
       28     4158        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='SLUG');
       29     4175        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='NETCON?');
       30     4192        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='STATS?',LAST=";");
       31     4209        %FPT_CGCTL (FPTN=HLPCTL,STCLASS=CONSTANT,DCB=M$HLP,CGCP=HLPPRM);
       32     4232        %VLP_CGCP (FPTN=HLPPRM,STCLASS=CONSTANT,CONMSG=YES,
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:8    
       33     4233                   TERMCONAU=NO,DCBCONAU=YES,TERMCONNAU=NO,DCBCONNAU=NO,
       34     4234                   AUCONTERM=NC,AUCONDCB=DEACTIVATE,AUDCONTERM=NC,
       35     4235                   AUDCONDCB=DEACTIVATE,XSTALGL=YES,WAS=NO,RAS=NO,SMD=NO,XTYPLGL=YES,
       36     4236                   MAXMC=4096,DCBCONLGL=YES,TERMCONLGL=YES,INPUT=YES,OUTPUT=YES,
       37     4237        /* DRML=YES is required to keep SLUG from being SQA'd when a FEP is hung */
       38     4238                   TRMRDSIZ=2048,DRML=YES,MINPG=3,DATAPGS=67,
       39     4239                  MAXPG=50,
       40     4240                   SECURE=NO);
       41     4283        %FPT_READ (FPTN=KL_RDHLP,STCLASS=SYMREF);
       42     4322        %VLP_NAME (FPTN=HLPCG,NAME='HLPCG',STCLASS=CONSTANT);
       43     4349        %VLP_SETSTA (FPTN=CSST,STCLASS=CONSTANT,MYSTATION='HLPADMIN');

   4374  4 000002                       REOPN        null
       44     4377        /**/
       45     4378        %SUB F_KL='1314'O;
       46     4379        %SUB M_I='11'O;
       47     4380        /**/
       48     4381    1   REOPN:;
       49     4382    1        CALL M$OPEN (OPNCG) ALTRET (SC1);

   4382  4 000002   000000 630400 2                  EPPR0   OPNCG
         4 000003   450000 713400                    CLIMB   alt,open
         4 000004   410400 401760                    pmme    nvectors=18
         4 000005   000017 702000 4                  TSX2    SC1

       50     4383    1        CALL M$CGCTL (HLPCTL) ALTRET (SC1);

   4383  4 000006   000072 630400 2                  EPPR0   HLPCTL
         4 000007   500003 713400                    CLIMB   alt,+32771
         4 000010   411400 401760                    pmme    nvectors=20
         4 000011   000017 702000 4                  TSX2    SC1

       51     4384    1        CALL M$READ (KL_RDHLP) ALTRET (SC2);

   4384  4 000012   000000 630400 xsym               EPPR0   KL_RDHLP
         4 000013   440000 713400                    CLIMB   alt,read
         4 000014   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:9    
         4 000015   000024 702000 4                  TSX2    SC2

       52     4385    1        RETURN;

   4385  4 000016   000000 702200 xent               TSX2  ! X66_ARET

       53     4386        /**/
       54     4387    1   SC1: ;

   4387  4 000017                       SC1          null
       55     4388    1        CALL FOI$CRASHGO (%S$NOPHLP,F_KL,M_I);

   4388  4 000017   000003 630400 5                  EPPR0   3
         4 000020   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000021   000000 701000 xent               TSX1    FOI$CRASHGO
         4 000022   000000 011000                    NOP     0

       56     4389        /*S*  SCREECH_CODE: KLI-S$NOPHLP
       57     4390              TYPE:    Screech
       58     4391              MESSAGE: SLUG unable to open the HLPCG comgroup
       59     4392              REMARKS: SLUG communicates with the administrators of FEPs via the
       60     4393                       HLPCG comgroup.  This screech occurs when he gets an ALTRET
       61     4394                       on his M$OPEN to that CG.                                     */
       62     4395    1        GOTO REOPN;

   4395  4 000023   000002 710000 4                  TRA     REOPN

   4387  4 000024                       SC2          null
       63     4396        /**/
       64     4397    1   SC2: ;
       65     4398    1        CALL FOI$CRASH (%S$NRDHLP,F_KL,M_I);

   4398  4 000024   000007 630400 5                  EPPR0   7
         4 000025   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000026   000000 701000 xent               TSX1    FOI$CRASH
         4 000027   000000 011000                    NOP     0

PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:10   
       66     4399        /*S*  SCREECH_CODE: KLI-S$NRDHLP
       67     4400              TYPE:    Screech
       68     4401              MESSAGE: SLUG got ALTRET reading HLPCG
       69     4402              REMARKS: Due to the nature of comgroups, SLUG should never get an
       70     4403                       ALTRET on his anonomous M$READ to HLPCG.  This screech
       71     4404                       occurs on the exception to that rule.                         */
       72     4405        /**/
       73     4406    1   END;

   4406  4 000030   000000 702200 xent               TSX2  ! X66_ARET
       74     4407        /**/
       75     4408        /**/
       76     4409        %EOD;

PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:11   
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$FESET.
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:12   

 **** Variables and constants ****

  ****  Section 002 RoData KLI$FESET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   204-0-0/w STRC(432)   r     1 CSST                     202-0-0/c STRC(54)    r     1 HLPCG
    72-0-0/d STRC(1872)  r     1 HLPCTL                   156-0-0/d STRC(720)   r     1 HLPPRM
     0-0-0/d STRC(2088)  r     1 OPNCG

  ****  Section 003  Data  KLI$FESET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(270)   r     1 HLPCG_ACSVEH

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(504)   r     1 KL_RDHLP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$HLP


   Procedure KLI$FESET requires 25 words for executable code.
   Procedure KLI$FESET requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:13   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:14   
          MINI XREF LISTING

CSST
      4361**DCL      4101--DCLINIT
FOI$CRASH
      4028**DCL-ENT  4398--CALL
FOI$CRASHGO
      4029**DCL-ENT  4388--CALL
HLPCG
      4347**DCL      4101--DCLINIT
HLPCG_ACSVEH
      4155**DCL      4103--DCLINIT
HLPCG_ACSVEH.Q
      4156**DCL      4155--DCLINIT
HLPCTL
      4220**DCL      4383<>CALL
HLPCTL.V
      4225**DCL      4220--DCLINIT
HLPPRM
      4252**DCL      4221--DCLINIT
HLPPRM.DVBYTE.REREAD#
      4266**DCL      4267--REDEF
KL_AUTOFAIL.FLAGS
       414**DCL       415--REDEF
KL_AUTOFAIL.MSGID
       410**DCL       411--REDEF
KL_AUTOFAIL.WSN
       417**DCL       418--REDEF
KL_FEMSG.FLAGS
       364**DCL       365--REDEF
KL_FEMSG.MSGID
       360**DCL       361--REDEF
KL_FEMSG.WSN
       367**DCL       368--REDEF
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:15   
KL_NETWORK_BUF.TERMINAL_ID.TERM
       554**DCL       563--REDEF
KL_NETWORK_KEY.KEY.TERMID.TERM
       480**DCL       489--REDEF
KL_RDBF.FEL#
       323**DCL       324--REDEF
KL_RDHLP
      4300**DCL      4384<>CALL
KL_RDHLP.STATION_
      4303**DCL      4304--REDEF
KL_RDHLP.V.DVBYTE.REREAD#
      4315**DCL      4315--REDEF
KL_RDHLP.V.INDX#
      4313**DCL      4313--REDEF
KL_TMSG.FLAGS
       386**DCL       387--REDEF
KL_TMSG.MSGID
       382**DCL       383--REDEF
KL_TMSG.WSN
       389**DCL       390--REDEF
M$CGCTL
        43**DCL-ENT  4383--CALL
M$OPEN
        22**DCL-ENT  4382--CALL
M$READ
        23**DCL-ENT  4384--CALL
OPNCG
      4100**DCL      4382<>CALL
OPNCG.ACSVEH_
      4102**DCL      4103--REDEF
OPNCG.ALTKEYS_
      4108**DCL      4109--REDEF    4109--REDEF
OPNCG.HDR_
      4107**DCL      4108--REDEF
OPNCG.TAB_
      4106**DCL      4107--REDEF
PL6.E3A0      #001=KLI$FESET File=KLI$FESET.:E05TSI                              WED 07/30/97 00:49 Page:16   
OPNCG.UHL_
      4100**DCL      4101--REDEF    4101--REDEF
OPNCG.V
      4109**DCL      4100--DCLINIT
OPNCG.V.FSN#
      4140**DCL      4140--REDEF    4140--REDEF
OPNCG.WSN_
      4106**DCL      4106--REDEF
REOPN
      4374**LABEL    4395--GOTO
SC1
      4387**LABEL    4382--CALLALT  4383--CALLALT
SC2
      4387**LABEL    4384--CALLALT

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:17   
       77        1        /*T***********************************************************/
       78        2        /*T*                                                         */
       79        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       80        4        /*T*                                                         */
       81        5        /*T***********************************************************/
       82        6        /**/
       83        7        /**/
       84        8        KLI$FEEV: PROC;
       85        9        /**/
       86       10        /**/
       87       11 S      %INCLUDE B$JIT_C;
       88       12        %INCLUDE CP_6;
       89       93        %INCLUDE KL_AFCN_C;
       90      194        %INCLUDE KL_CONFIG_M;
       91      956        %INCLUDE KL_MACRO_C;
       92     4308        %INCLUDE KL_DATA_R;
       93     4772        %INCLUDE CP_6_SUBS;
       94     5312        %INCLUDE KI_SUBS_C;
       95     5448        %INCLUDE OC_SUBS_C;
       96     6179        %INCLUDE KL_SUBS_C;
       97     6233        %INCLUDE K_ADDRESS_M;
       98     6736        %INCLUDE B_SEGIDS_C;
       99     7275        /**/
      100     7276        %B$JIT0(STCLASS=BASED);
      101     7365        %U$JIT1;
      102     7439        %M$JIT2X;
      103     7442        %F$JIT3X;
      104     7445        %S$JIT4X;
      105     7448        %J$JIT5X;
      106     7451        %A$JIT6X;
      107     7454        %B$CGAURD (FPTN=BF);
      108     7473        %KL_FEPST(FPTN=KL$FEPST,STCLASS=BASED);
      109     7508        %KL$NODEINFO;
      110     7525        %KL$NETWORK (STCLASS="BASED(KL_EXTRSP_BUF$)");
      111     7552        %KL_FROG (STCLASS=SYMREF);
      112     7570        %EQU_CG;
      113     7618        /**/
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:18   
      114     7619        /**/
      115     7620    1   DCL FEX UBIN WORD;
      116     7621    1   DCL PROB UBIN WORD;
      117     7622    1   DCL NODETYPE UBIN;
      118     7623    1   DCL STATE UBIN WORD;
      119     7624    1   DCL I SBIN;
      120     7625        %KL_NODECHG (FPTN=NODECHG,STCLASS=AUTO);
      121     7649        %KL_UPDOSI(FPTN=UPDOSI,STCLASS=AUTO);
      122     7858        %KL_UPDOSI(FPTN=KL$UPDOSI,STCLASS="BASED(KL_RDBF$)");
      123     8067    1   DCL B$PTR PTR BASED;
      124     8068    1   DCL B$UBIN UBIN BASED;
      125     8069        %KL_SETNODE (FPTN=SETNODE,STCLASS=AUTO);
      126     8115    1   DCL 1 VEVNT BASED ALIGNED,
      127     8116    1            2 PROB UBIN HALF UNAL,
      128     8117    1            2 STATE UBIN HALF UNAL;
      129     8118    1   DCL VJIT$ PTR;
      130     8119    1   DCL VM_UC$ PTR;
      131     8120    1   DCL VROSEG$ PTR;
      132     8121    1   DCL PP (0:2) UBIN WORD;
      133     8122    1   DCL PPTR$ PTR;
      134     8123        /**/
      135     8124    1   DCL KI_OSIMAX# UBIN SYMREF;             /* monitor data, # of osiroutes */
      136     8125    1   DCL KI_OSIROUTE$$ PTR SYMREF;      /* ditto- ptr to ptr array of osiroutes */
      137     8126    1   DCL KI_MXFE UBIN SYMREF;           /* number of feis defined on this system*/
      138     8127    1   DCL JC_ZIP SBIN WORD SYMREF;
      139     8128    1   DCL KL_STATION CHAR(8) SYMREF;
      140     8129    1   DCL KLX$CONV_NODE ENTRY(3) ALTRET;
      141     8130    1   DCL KLI$FEGO ENTRY(1);
      142     8131    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
      143     8132    1   DCL KLI$RECOVERY ENTRY;
      144     8133    1   DCL KLI$GETOSIROUTES ENTRY(1);
      145     8134    1   DCL JMU$SETSEG ENTRY(2);
      146     8135        /**/
      147     8136        %KL$NODEINFO_KEY (STCLASS=CONSTANT);
      148     8153        %KL$NETWORK_KEY (STCLASS=CONSTANT);
      149     8170        %FPT_READ (FPTN=KL_RD_NETCON,STCLASS=SYMREF);
      150     8209        %FPT_WRITE (FPTN=KL_WKYN,STCLASS=SYMREF);
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:19   
      151     8240        %FPT_WRITE (FPTN=WRT_FROG,STCLASS="SYMREF");
      152     8271        %VLP_STATION (FPTN=FROG_STA,STATION='FROG');
      153     8298        %FPT_SAD(FPTN=SADTIGR,USERSID=%SPCL2SID,MONSID=%TIGRSID);
      154     8313        /**/
      155     8314        /**/
      156     8315    1        IF KL_STATION = 'BABOON'
      157     8316    2        THEN DO;
      158     8317    2             IF ADDR(KL_RDBF)->BF.EVENT = %CG_DOPN#
      159     8318    3             THEN DO;
      160     8319    3                  KL_RD_NETCON.BUF_ = VECTOR(ADDR(KL_RDBF)->KL$NODEINFO);
      161     8320    3                  KL_RD_NETCON.KEY_ = VECTOR(KL$NODEINFO_KEY);
      162     8321    3                  SETNODE.FCN = IGA_SETNODE;
      163     8322    3                  CALL M$READ(KL_RD_NETCON)
      164     8323    4                  WHENRETURN DO;
      165     8324    4                       SETNODE.NODE# = ADDR(KL_RDBF)->KL$NODEINFO.NODE#;
      166     8325    4                       SETNODE.NODE_NAME = ADDR(KL_RDBF)->KL$NODEINFO.NODENAME;
      167     8326    4                       SETNODE.MY_NODE = '1'B;
      168     8327    4                       KL_NODENAME = SETNODE.NODE_NAME;
      169     8328    4                       KL_NODE = SETNODE.NODE#;
      170     8329    4                       KL_NMNODE = KL_NODE;
      171     8330    4                       CALL KLX$WRHLPNODE (SETNODE,SIZEC(SETNODE),KL_NODE);
      172     8331    4                     END;
      173     8332    3                  CALL KLI$GETOSIROUTES(KL_NODE);
      174     8333    3                  CALL UPDATE;
      175     8334        /* Set the node name for all the nodes in the network */
      176     8335
      177     8336    3                  KL_FETBL.HOST_NODE(KL_NODE) = '1'B;
      178     8337    3                  KL_FETBL.ACTIVE(KL_NODE) = '1'B;
      179     8338    3                  CALL M$SAD(SADTIGR)
      180     8339    4                  WHENRETURN DO;
      181     8340    4                       PPTR$ = ADDR(KI_OSIMAX#);
      182     8341    4                       CALL JMU$SETSEG(PPTR$,%SPCL1SID);
      183     8342    4                       KL_OSIMAX# = PPTR$->B$UBIN;
      184     8343    4                       PPTR$ = ADDR(KI_MXFE);
      185     8344    4                       CALL JMU$SETSEG(PPTR$,%SPCL1SID);
      186     8345    4                       KL_MAXFEI# = PPTR$->B$UBIN;
      187     8346    4                       PPTR$ = ADDR(KI_OSIROUTE$$);
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:20   
      188     8347    4                       CALL JMU$SETSEG(PPTR$,%SPCL1SID);
      189     8348    4                       KL_OSIROUTE$ = PPTR$->B$PTR;
      190     8349    4                     END;
      191     8350    4                  WHENALTRETURN DO;
      192     8351                                                /* gotta screech */
      193     8352    4                     END;
      194     8353    3                END;
      195     8354    2             RETURN;
      196     8355    2           END;
      197     8356    1        CALL CHARBIN(FEX,SUBSTR(ADDR(KL_RDBF)->BF.STATION,4,4));
      198     8357    1        IF FEX > KL_NODES THEN RETURN;     /*dont let too big of feps thru*/
      199     8358    1        KL_FEMSG.FEX = FEX;
      200     8359    1        CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,I)
      201     8360    2        WHENALTRETURN DO;
      202     8361    2             KL_FEMSG.NAME = ' ';
      203     8362    2           END;
      204     8363    2        DO CASE (ADDR(KL_RDBF)->BF.EVENT);
      205     8364    2        CASE (%CG_TDSC#);                  /* REMOTE DISCONNECTING */
      206     8365    2           KL_FETBL.ACTIVE(FEX) = '0'B;
      207     8366    2           CALL KLI$RECOVERY;
      208     8367    2           KL_FEMSG.MSG# = FEDN_MSG#;
      209     8368    3           CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;
      210     8369    3              END;
      211     8370    2        CASE (%CG_TCON#);
      212     8371    2           KL_FETBL.ACTIVE(FEX) = '1'B;
      213     8372    2           KL_FEMSG.MSG#=FEUP_MSG#;
      214     8373    2           KL_FEMSG.STATE = 0;
      215     8374    2           KL_FEMSG.PROB = 0;
      216     8375    2           IF FEX>KL_MXFE THEN KL_MXFE=FEX;
      217     8376    2           CALL KLI$FEGO (FEX);
      218     8377    3           CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;
      219     8378    3              END;
      220     8379    2        CASE (%CG_TBRK#);
      221     8380    2           KL_FETBL.KTYP(FEX)=%KLKT_NONE#;
      222     8381    2        END;
      223     8382    1        RETURN;
      224     8383        /**/
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:21   
      225     8384        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:22   
      226     8385    1   KLI$FEPCHANGE: ENTRY;
      227     8386
      228     8387    1        FEX = ADDR(KL_RDBF)->KL$FEPST.FEP;
      229     8388    1        PROB=ADDR(KL_RDBF)->KL$FEPST.PROB;
      230     8389    1        STATE=ADDR(KL_RDBF)->KL$FEPST.STATE;
      231     8390    1        IF PROB ~= KIER_QOSCHG
      232     8391    2        THEN DO;
      233     8392    2             KL_FETBL.LINK_CONNECT(FEX) = '1'B;
      234     8393    2             KL_FETBL.LINK_ACTIVE(FEX) = '0'B;
      235     8394    2           END;
      236     8395    1        IF JC_ZIP~=0
      237     8396    1        THEN
      238     8397    1             RETURN;
      239     8398    1        KL_FEMSG.FEX=FEX;
      240     8399    1        CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,I)
      241     8400    2        WHENALTRETURN DO;
      242     8401    2             KL_FEMSG.NAME = ' ';
      243     8402    2           END;
      244     8403    1        KL_FEMSG.PROB=PROB;
      245     8404    1        KL_FEMSG.STATE = STATE;
      246     8405    1        IF STATE = KIST_BT                 /* Was booting */
      247     8406    2        THEN DO;
      248     8407    2             KL_FROG.FEX = FEX;
      249     8408    2             KL_FROG.FUNCTION = %KLFR_BTDN;
      250     8409    3             CALL M$WRITE (WRT_FROG) WHENALTRETURN DO;
      251     8410    3                END;
      252     8411    2           END;
      253     8412    2        DO CASE (PROB);
      254     8413    2        CASE (KIER_OK);
      255     8414    2           KL_FETBL.LINK_ACTIVE(FEX) = '1'B;
      256     8415    2           KL_FETBL.KTYP(FEX) = %KLKT_NONE#;
      257     8416    2           RETURN;
      258     8417    2        CASE (KIER_QOSCHG);
      259     8418    2           IF KL_FETBL.HOST_NODE(FEX)
      260     8419    2           THEN
      261     8420    2                IF ADDR(KL_RDBF)->KL$FEPST.QOS = 255
      262     8421    3                THEN DO;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:23   
      263     8422    3                     KL_FETBL.ACTIVE(FEX) = '0'B;
      264     8423    3                     KL_FEMSG.PROB = 3;
      265     8424    3                     KL_FEMSG.FEX = FEX;
      266     8425    3   TELL_FEP_MSG:     ;
      267     8426    3                     KL_FEMSG.MSG# = FEUP_MSG#;
      268     8427    3                     CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,NODETYPE);
      269     8428    3                     KL_FEMSG.STATE = 1;
      270     8429    3                     CALL M$WRITE(KL_WKYN)
      271     8430    4                     WHENALTRETURN DO;
      272     8431    4                        END;
      273     8432    3                   END;
      274     8433    3                ELSE DO;
      275     8434    3                     KL_FETBL.ACTIVE(FEX) ='1'B;
      276     8435    3                     KL_FEMSG.PROB = 0;
      277     8436    3                     GOTO TELL_FEP_MSG;
      278     8437    3                   END;
      279     8438    3           DO I = 0 TO KL_NODES;
      280     8439    3                IF I ~= KL_NODE            /* Not this node */
      281     8440    3                     AND KL_FETBL.LINK_ACTIVE(I)
      282     8441    3                     AND I ~= FEX          /* Do not tell him about himself */
      283     8442    3                     AND KL_FETBL.LINK_CONNECT(I)
              8442                              /* dont stuff it down everyones throats */
      284     8443    4                THEN DO;
      285     8444    4                     NODECHG.FCN = IGA_NODECHG;
      286     8445    4                     NODECHG.MYNODE = KL_NODE;
      287     8446    4                     NODECHG.NODE = FEX;
      288     8447    4                     IF I = ADDR(KL_RDBF)->KL$FEPST.LNK_NODE
      289     8448    4                     THEN
      290     8449    4                          NODECHG.QOS = ADDR(KL_RDBF)->KL$FEPST.ALT_QOS;
      291     8450    4                     ELSE
      292     8451    4                          NODECHG.QOS = ADDR(KL_RDBF)->KL$FEPST.QOS;
      293     8452    4                     IF NODECHG.QOS + KL_HOPCOST > 255
      294     8453    4                     THEN
      295     8454    4                          NODECHG.QOS = 255;
      296     8455    4                     ELSE
      297     8456    4                          NODECHG.QOS = NODECHG.QOS + KL_HOPCOST;
      298     8457    4                     IF KL_FETBL.HOST_NODE(FEX)
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:24   
      299     8458    5                     THEN DO;
      300     8459    5                          NODECHG.HOSTNODE = 1;
      301     8460    5                        END;
      302     8461    4                     ELSE
      303     8462    4                          NODECHG.HOSTNODE = 0;
      304     8463    4                     CALL KLX$WRHLPNODE(NODECHG,SIZEC(NODECHG),I);
      305     8464    4                   END;
      306     8465    3              END;
      307     8466    2           KL_FETBL.QOS(FEX) = ADDR(KL_RDBF)->KL$FEPST.QOS;
      308     8467    2           RETURN;
      309     8468    2        CASE (KIER_STOP,KIER_PART,KIER_UPRT);
      310     8469    2           KL_FEMSG.MSG#=FESP_MSG#;
      311     8470    3           CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;
      312     8471    3              END;
      313     8472    2           KL_FETBL.KTYP(FEX) = %KLKT_NONE#;
      314     8473    2           RETURN;
      315     8474    2        CASE (KIER_TO);
      316     8475    2           IF STATE ~= KIST_BT AND STATE ~= KIST_DMP
      317     8476    2           THEN
      318     8477    2                GOTO PROBS;
      319     8478
      320     8479    2        CASE (KIER_BCMD);
      321     8480    2           IF KL_FETBL.KTYP(FEX) ~= %KLKT_NONE#
      322     8481    3           THEN DO;
      323     8482    3                IF KL_FETBL.KTYP(FEX) = %KLKT_DUMP#
      324     8483    3                THEN
      325     8484    3                     KL_FROG.FUNCTION = %KLFR_DMP;
      326     8485    3                IF KL_FETBL.KTYP(FEX) = %KLKT_BOOT#
      327     8486    3                THEN
      328     8487    3                     KL_FROG.FUNCTION = %KLFR_BT;
      329     8488    3                IF KL_FETBL.KTYP(FEX) = %KLKT_CRASH#
      330     8489    3                THEN
      331     8490    3                     KL_FROG.FUNCTION = %KLFR_DMPBT;
      332     8491    3                KL_FROG.FEX = FEX;
      333     8492    4                CALL M$WRITE (WRT_FROG) WHENALTRETURN DO;
      334     8493    4                   END;
      335     8494    3              END;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:25   
      336     8495    2        CASE (KIER_FREQ);
      337     8496    2           IF STATE = KIST_BT
      338     8497    3           THEN DO;
      339     8498    3                KL_FETBL.KTYP(FEX) = %KLKT_NONE#;
      340     8499    3                RETURN;
      341     8500    3              END;
      342     8501    2        CASE (ELSE);
      343     8502    2   PROBS:  ;
      344     8503    2           IF STATE ~= KIST_BT AND STATE ~= KIST_DMP
      345     8504    2                AND NOT KL_FETBL.DEBUG(FEX)
      346     8505    2                AND KL_FETBL.BOSS(FEX)
      347     8506    3           THEN DO;
      348     8507    3                KL_FROG.FEX = FEX;
      349     8508    3                KL_FROG.FUNCTION = %KLFR_DMPBT;
      350     8509    4                CALL M$WRITE (WRT_FROG) WHENALTRETURN DO;
      351     8510    4                   END;
      352     8511    3              END;
      353     8512    2        END;
      354     8513    1        KL_FETBL.KTYP(FEX)=%KLKT_NONE#;
      355     8514    1        KL_FEMSG.MSG#=FECR_MSG#;
      356     8515    2        CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;
      357     8516    2           END;
      358     8517        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:26   
      359     8518    1   KLI$UPDATE: ENTRY;
      360     8519    1        CALL UPDATE;
      361     8520    1        RETURN;
      362     8521        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:27   
      363     8522        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:28   
      364     8523    1   UPDATE: PROC;
      365     8524
      366     8525        /* Set the node name for all the nodes in the network */
      367     8526    2        KL_NETWORK_VALID = '0'B;
      368     8527    2        SETNODE.FCN = IGA_SETNODE;
      369     8528    2        KL_RD_NETCON.BUF_ = VECTOR(KL_EXTRSP_BUF);
      370     8529    2        KL_RD_NETCON.KEY_ = VECTOR(KL$NETWORK_KEY);
      371     8530    2        CALL M$READ (KL_RD_NETCON)
      372     8531    3        WHENRETURN DO;
      373     8532    4             DO I = 0 TO KL$NETWORK.NODE#;
      374     8533    4                  SETNODE.NODE# = I;
      375     8534    4                  SETNODE.NODE_NAME = KL$NETWORK.NODE.NODE(I);
      376     8535    4                  SETNODE.MY_NODE = '0'B;
      377     8536    5                  DO CASE (KL$NETWORK.NODE.TYPE(I));
      378     8537
      379     8538    5                  CASE (%KL_NODETYPE_HOST,%KL_NODETYPE_ME);
      380     8539    5                     KL_FETBL.HOST_NODE(I) = '1'B;
      381     8540    5                     SETNODE.HOST_NODE = '1'B;
      382     8541    5                  CASE (%KL_NODETYPE_FEP);
      383     8542    5                     SETNODE.HOST_NODE = '0'B;
      384     8543    5                     KL_FETBL.DEBUG(I) = '0'B;
      385     8544
      386     8545    5                  CASE (%KL_NODETYPE_DEBUG);
      387     8546    5                     SETNODE.HOST_NODE = '0'B;
      388     8547    5                     KL_FETBL.DEBUG(I) = '1'B;
      389     8548    5                     KL_FETBL.LINK_CONNECT(I) = '1'B;
      390     8549
      391     8550    5                  CASE (%KL_NODETYPE_UNDEF);
      392     8551    5                     SETNODE.NODE_NAME = ' ';
      393     8552
      394     8553    5                  END;
      395     8554    4                  CALL KLX$WRHLPNODE (SETNODE,SIZEC(SETNODE),KL_NODE);
      396     8555    4                  IF KL$NETWORK.NODE.CONTROL_NODE(I) = KL_NODENAME OR
      397     8556    4                       KL$NETWORK.NODE.CONTROL_NODE(I) = ' '
      398     8557    4                  THEN
      399     8558    4                       KL_FETBL.BOSS(I) = '1'B;
      400     8559    4                  ELSE
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:29   
      401     8560    4                       KL_FETBL.BOSS(I) = '0'B;
      402     8561    4                END;
      403     8562    3           END;
      404     8563    2        SETNODE = '0'B;
      405     8564    3        DO FEX = 0 TO KL$NETWORK.NODE#;
      406     8565    3             IF KL_FETBL.BOSS(FEX) AND KL_FETBL.ACTIVE(FEX) AND NOT KL_FETBL.HOST_NODE(
              8565                      FEX) THEN
      407     8566    4             DO;
      408     8567    5                  DO I = 0 TO KL$NETWORK.NODE#;
      409     8568    5                       SETNODE.FCN = IGA_NODETBL;
      410     8569    5                       SETNODE.NODE# = I;
      411     8570    5                       SETNODE.NODE_NAME = KL$NETWORK.NODE.NODE(I);
      412     8571    5                       IF KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_HOST OR
      413     8572    5                            KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_ME THEN
      414     8573    5                            SETNODE.HOST_NODE = '1'B;
      415     8574    5                       ELSE
      416     8575    5                            SETNODE.HOST_NODE = '0'B;
      417     8576    5                       CALL KLX$WRHLPNODE(SETNODE,SIZEC(SETNODE),FEX);
      418     8577    5                     END;
      419     8578    4                END;
      420     8579    3           END;
      421     8580    2        RETURN;
      422     8581
      423     8582    2   END UPDATE;
      424     8583    1   END KLI$FEEV;
      425     8584        /**/
      426     8585        /**/
      427     8586        %EOD;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:30   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$FEEV.

   Procedure KLI$FEEV requires 623 words for executable code.
   Procedure KLI$FEEV requires 42 words of local(AUTO) storage.

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:31   

 Object Unit name= KLI$FEEV                                   File name= KLI$FESET.:E05TOU
 UTS= JUL 30 '97 00:50:03.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$HLP
    2  RoData even  UTS      4      4  KLI$FEEV
    3   Data  even  none    12     14  KLI$FEEV
    4   Proc  even  none   623   1157  KLI$FEEV
    5  RoData even  none    26     32  KLI$FEEV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  KLI$FEEV
     4    256                  yes      Std        0  KLI$FEPCHANGE
     4    717                  yes      Std        0  KLI$UPDATE
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:32   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 KLX$WRHLPNODE
         yes           Std       1 KLI$GETOSIROUTES
         yes           Std       2 JMU$SETSEG
 yes     yes           Std       3 KLX$CONV_NODE
         yes           Std       0 KLI$RECOVERY
         yes           Std       1 KLI$FEGO
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$HLP                                 KL_MXFE
     KL_FETBL                              KL_MAXFEI#                            KL_OSIMAX#
     KL_OSIROUTE$                          KL_RDBF                               KL_RDBF$
     KL_NODES                              KL_HOPCOST                            KL_NETWORK_VALID
     KL_NODENAME                           KL_NODE                               KL_NMNODE
     KL_FEMSG                              KL_EXTRSP_BUF                         KL_EXTRSP_BUF$
     KL_FROG                               KI_OSIMAX#                            KI_OSIROUTE$$
     KI_MXFE                               JC_ZIP                                KL_STATION
     KL_RD_NETCON                          KL_WKYN                               WRT_FROG
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:33   


       77        1        /*T***********************************************************/
       78        2        /*T*                                                         */
       79        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       80        4        /*T*                                                         */
       81        5        /*T***********************************************************/
       82        6        /**/
       83        7        /**/
       84        8        KLI$FEEV: PROC;

      8  4 000000   000000 700200 xent  KLI$FEEV     TSX0  ! X66_AUTO_0
         4 000001   000052 000000                    ZERO    42,0

       85        9        /**/
       86       10        /**/
       87       11 S      %INCLUDE B$JIT_C;
       88       12        %INCLUDE CP_6;
       89       93        %INCLUDE KL_AFCN_C;
       90      194        %INCLUDE KL_CONFIG_M;
       91      956        %INCLUDE KL_MACRO_C;
       92     4308        %INCLUDE KL_DATA_R;
       93     4772        %INCLUDE CP_6_SUBS;
       94     5312        %INCLUDE KI_SUBS_C;
       95     5448        %INCLUDE OC_SUBS_C;
       96     6179        %INCLUDE KL_SUBS_C;
       97     6233        %INCLUDE K_ADDRESS_M;
       98     6736        %INCLUDE B_SEGIDS_C;
       99     7275        /**/
      100     7276        %B$JIT0(STCLASS=BASED);
      101     7365        %U$JIT1;
      102     7439        %M$JIT2X;
      103     7442        %F$JIT3X;
      104     7445        %S$JIT4X;
      105     7448        %J$JIT5X;
      106     7451        %A$JIT6X;
      107     7454        %B$CGAURD (FPTN=BF);
      108     7473        %KL_FEPST(FPTN=KL$FEPST,STCLASS=BASED);
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:34   
      109     7508        %KL$NODEINFO;
      110     7525        %KL$NETWORK (STCLASS="BASED(KL_EXTRSP_BUF$)");
      111     7552        %KL_FROG (STCLASS=SYMREF);
      112     7570        %EQU_CG;
      113     7618        /**/
      114     7619        /**/
      115     7620    1   DCL FEX UBIN WORD;
      116     7621    1   DCL PROB UBIN WORD;
      117     7622    1   DCL NODETYPE UBIN;
      118     7623    1   DCL STATE UBIN WORD;
      119     7624    1   DCL I SBIN;
      120     7625        %KL_NODECHG (FPTN=NODECHG,STCLASS=AUTO);
      121     7649        %KL_UPDOSI(FPTN=UPDOSI,STCLASS=AUTO);
      122     7858        %KL_UPDOSI(FPTN=KL$UPDOSI,STCLASS="BASED(KL_RDBF$)");
      123     8067    1   DCL B$PTR PTR BASED;
      124     8068    1   DCL B$UBIN UBIN BASED;
      125     8069        %KL_SETNODE (FPTN=SETNODE,STCLASS=AUTO);
      126     8115    1   DCL 1 VEVNT BASED ALIGNED,
      127     8116    1            2 PROB UBIN HALF UNAL,
      128     8117    1            2 STATE UBIN HALF UNAL;
      129     8118    1   DCL VJIT$ PTR;
      130     8119    1   DCL VM_UC$ PTR;
      131     8120    1   DCL VROSEG$ PTR;
      132     8121    1   DCL PP (0:2) UBIN WORD;
      133     8122    1   DCL PPTR$ PTR;
      134     8123        /**/
      135     8124    1   DCL KI_OSIMAX# UBIN SYMREF;             /* monitor data, # of osiroutes */
      136     8125    1   DCL KI_OSIROUTE$$ PTR SYMREF;      /* ditto- ptr to ptr array of osiroutes */
      137     8126    1   DCL KI_MXFE UBIN SYMREF;           /* number of feis defined on this system*/
      138     8127    1   DCL JC_ZIP SBIN WORD SYMREF;
      139     8128    1   DCL KL_STATION CHAR(8) SYMREF;
      140     8129    1   DCL KLX$CONV_NODE ENTRY(3) ALTRET;
      141     8130    1   DCL KLI$FEGO ENTRY(1);
      142     8131    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
      143     8132    1   DCL KLI$RECOVERY ENTRY;
      144     8133    1   DCL KLI$GETOSIROUTES ENTRY(1);
      145     8134    1   DCL JMU$SETSEG ENTRY(2);
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:35   
      146     8135        /**/
      147     8136        %KL$NODEINFO_KEY (STCLASS=CONSTANT);
      148     8153        %KL$NETWORK_KEY (STCLASS=CONSTANT);
      149     8170        %FPT_READ (FPTN=KL_RD_NETCON,STCLASS=SYMREF);
      150     8209        %FPT_WRITE (FPTN=KL_WKYN,STCLASS=SYMREF);
      151     8240        %FPT_WRITE (FPTN=WRT_FROG,STCLASS="SYMREF");
      152     8271        %VLP_STATION (FPTN=FROG_STA,STATION='FROG');
      153     8298        %FPT_SAD(FPTN=SADTIGR,USERSID=%SPCL2SID,MONSID=%TIGRSID);
      154     8313        /**/
      155     8314        /**/
      156     8315    1        IF KL_STATION = 'BABOON'

   8315  4 000002   040000 106400                    CMPC    fill='040'O
         4 000003   000000 000010 xsym               ADSC9   KL_STATION               cn=0,n=8
         4 000004   000002 000006 2                  ADSC9   KL$NETWORK_KEY+1         cn=0,n=6
         4 000005   000140 601000 4                  TNZ     s:8356

      157     8316    2        THEN DO;

      158     8317    2             IF ADDR(KL_RDBF)->BF.EVENT = %CG_DOPN#

   8317  4 000006   000000 235000 xsym               LDA     KL_RDBF
         4 000007   000137 601000 4                  TNZ     s:8354

      159     8318    3             THEN DO;

      160     8319    3                  KL_RD_NETCON.BUF_ = VECTOR(ADDR(KL_RDBF)->KL$NODEINFO);

   8319  4 000010   000000 237000 5                  LDAQ    0
         4 000011   000004 757000 xsym               STAQ    KL_RD_NETCON+4

      161     8320    3                  KL_RD_NETCON.KEY_ = VECTOR(KL$NODEINFO_KEY);

   8320  4 000012   000002 237000 5                  LDAQ    2
         4 000013   000002 757000 xsym               STAQ    KL_RD_NETCON+2

      162     8321    3                  SETNODE.FCN = IGA_SETNODE;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:36   

   8321  4 000014   045000 236003                    LDQ     18944,DU
         4 000015   200031 552140                    STBQ    SETNODE,'40'O,AUTO

      163     8322    3                  CALL M$READ(KL_RD_NETCON)

   8322  4 000016   000000 630400 xsym               EPPR0   KL_RD_NETCON
         4 000017   440000 713400                    CLIMB   alt,read
         4 000020   401400 401760                    pmme    nvectors=4
         4 000021   000050 702000 4                  TSX2    s:8332

      164     8323    4                  WHENRETURN DO;

      165     8324    4                       SETNODE.NODE# = ADDR(KL_RDBF)->KL$NODEINFO.NODE#;

   8324  4 000022   000000 235000 xsym               LDA     KL_RDBF
         4 000023   200032 755100                    STA     SETNODE+1,,AUTO

      166     8325    4                       SETNODE.NODE_NAME = ADDR(KL_RDBF)->KL$NODEINFO.NODENAME;

   8325  4 000024   040100 100400                    MLR     fill='040'O
         4 000025   000001 000010 xsym               ADSC9   KL_RDBF+1                cn=0,n=8
         4 000026   200033 000010                    ADSC9   SETNODE+2,,AUTO          cn=0,n=8

      167     8326    4                       SETNODE.MY_NODE = '1'B;

   8326  4 000027   000200 236007                    LDQ     128,DL
         4 000030   200031 256100                    ORSQ    SETNODE,,AUTO

      168     8327    4                       KL_NODENAME = SETNODE.NODE_NAME;

   8327  4 000031   040000 100500                    MLR     fill='040'O
         4 000032   200033 000010                    ADSC9   SETNODE+2,,AUTO          cn=0,n=8
         4 000033   000000 000010 xsym               ADSC9   KL_NODENAME              cn=0,n=8

      169     8328    4                       KL_NODE = SETNODE.NODE#;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:37   
   8328  4 000034   000000 755000 xsym               STA     KL_NODE

      170     8329    4                       KL_NMNODE = KL_NODE;

   8329  4 000035   000000 755000 xsym               STA     KL_NMNODE

      171     8330    4                       CALL KLX$WRHLPNODE (SETNODE,SIZEC(SETNODE),KL_NODE);

   8330  4 000036   000005 236000 5                  LDQ     5
         4 000037   200050 756100                    STQ     PPTR$+5,,AUTO
         4 000040   000006 236000 5                  LDQ     6
         4 000041   200047 756100                    STQ     PPTR$+4,,AUTO
         4 000042   200031 630500                    EPPR0   SETNODE,,AUTO
         4 000043   200046 450500                    STP0    PPTR$+3,,AUTO
         4 000044   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000045   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000046   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000047   000000 011000                    NOP     0

      172     8331    4                     END;

      173     8332    3                  CALL KLI$GETOSIROUTES(KL_NODE);

   8332  4 000050   000005 630400 5                  EPPR0   5
         4 000051   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000052   000000 701000 xent               TSX1    KLI$GETOSIROUTES
         4 000053   000000 011000                    NOP     0

      174     8333    3                  CALL UPDATE;

   8333  4 000054   000724 701000 4                  TSX1    UPDATE
         4 000055   000000 011000                    NOP     0

      175     8334        /* Set the node name for all the nodes in the network */
      176     8335
      177     8336    3                  KL_FETBL.HOST_NODE(KL_NODE) = '1'B;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:38   
   8336  4 000056   000000 720000 xsym               LXL0    KL_NODE
         4 000057   400000 236003                    LDQ     -131072,DU
         4 000060   000000 256010 xsym               ORSQ    KL_FETBL,X0

      178     8337    3                  KL_FETBL.ACTIVE(KL_NODE) = '1'B;

   8337  4 000061   100000 236003                    LDQ     32768,DU
         4 000062   000000 256010 xsym               ORSQ    KL_FETBL,X0

      179     8338    3                  CALL M$SAD(SADTIGR)

   8338  4 000063   000010 630400 3                  EPPR0   SADTIGR
         4 000064   430015 713400                    CLIMB   alt,+12301
         4 000065   400000 401760                    pmme    nvectors=1
         4 000066   000137 702000 4                  TSX2    s:8354

      180     8339    4                  WHENRETURN DO;

      181     8340    4                       PPTR$ = ADDR(KI_OSIMAX#);

   8340  4 000067   000007 236000 5                  LDQ     7
         4 000070   200043 756100                    STQ     PPTR$,,AUTO

      182     8341    4                       CALL JMU$SETSEG(PPTR$,%SPCL1SID);

   8341  4 000071   000011 236000 5                  LDQ     9
         4 000072   200047 756100                    STQ     PPTR$+4,,AUTO
         4 000073   200043 630500                    EPPR0   PPTR$,,AUTO
         4 000074   200046 450500                    STP0    PPTR$+3,,AUTO
         4 000075   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000076   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000077   000000 701000 xent               TSX1    JMU$SETSEG
         4 000100   000000 011000                    NOP     0

      183     8342    4                       KL_OSIMAX# = PPTR$->B$UBIN;

   8342  4 000101   200043 470500                    LDP0    PPTR$,,AUTO
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:39   
         4 000102   000000 235100                    LDA     0,,PR0
         4 000103   000000 755000 xsym               STA     KL_OSIMAX#

      184     8343    4                       PPTR$ = ADDR(KI_MXFE);

   8343  4 000104   000012 236000 5                  LDQ     10
         4 000105   200043 756100                    STQ     PPTR$,,AUTO

      185     8344    4                       CALL JMU$SETSEG(PPTR$,%SPCL1SID);

   8344  4 000106   000011 236000 5                  LDQ     9
         4 000107   200047 756100                    STQ     PPTR$+4,,AUTO
         4 000110   200043 630500                    EPPR0   PPTR$,,AUTO
         4 000111   200046 450500                    STP0    PPTR$+3,,AUTO
         4 000112   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000114   000000 701000 xent               TSX1    JMU$SETSEG
         4 000115   000000 011000                    NOP     0

      186     8345    4                       KL_MAXFEI# = PPTR$->B$UBIN;

   8345  4 000116   200043 470500                    LDP0    PPTR$,,AUTO
         4 000117   000000 235100                    LDA     0,,PR0
         4 000120   000000 755000 xsym               STA     KL_MAXFEI#

      187     8346    4                       PPTR$ = ADDR(KI_OSIROUTE$$);

   8346  4 000121   000013 236000 5                  LDQ     11
         4 000122   200043 756100                    STQ     PPTR$,,AUTO

      188     8347    4                       CALL JMU$SETSEG(PPTR$,%SPCL1SID);

   8347  4 000123   000011 236000 5                  LDQ     9
         4 000124   200047 756100                    STQ     PPTR$+4,,AUTO
         4 000125   200043 630500                    EPPR0   PPTR$,,AUTO
         4 000126   200046 450500                    STP0    PPTR$+3,,AUTO
         4 000127   200046 630500                    EPPR0   PPTR$+3,,AUTO
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:40   
         4 000130   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000131   000000 701000 xent               TSX1    JMU$SETSEG
         4 000132   000000 011000                    NOP     0

      189     8348    4                       KL_OSIROUTE$ = PPTR$->B$PTR;

   8348  4 000133   200043 470500                    LDP0    PPTR$,,AUTO
         4 000134   000000 236100                    LDQ     0,,PR0
         4 000135   000000 756000 xsym               STQ     KL_OSIROUTE$

      190     8349    4                     END;

   8349  4 000136   000137 710000 4                  TRA     s:8354

      191     8350    4                  WHENALTRETURN DO;

      192     8351                                                /* gotta screech */
      193     8352    4                     END;

      194     8353    3                END;

      195     8354    2             RETURN;

   8354  4 000137   000000 702200 xent               TSX2  ! X66_ARET

      196     8355    2           END;
      197     8356    1        CALL CHARBIN(FEX,SUBSTR(ADDR(KL_RDBF)->BF.STATION,4,4));

   8356  4 000140   000100 305400                    DTB
         4 000141   000002 030004 xsym               NDSC9   KL_RDBF+2                cn=0,s=nosgn,sf=0,n=4
         4 000142   200046 000010                    NDSC9   PPTR$+3,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000143   200047 235100                    LDA     PPTR$+4,,AUTO
         4 000144   200003 755100                    STA     FEX,,AUTO

      198     8357    1        IF FEX > KL_NODES THEN RETURN;     /*dont let too big of feps thru*/

   8357  4 000145   000000 236000 xsym               LDQ     KL_NODES
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:41   
         4 000146   200003 116100                    CMPQ    FEX,,AUTO
         4 000147   000151 603000 4                  TRC     s:8358

   8357  4 000150   000000 702200 xent               TSX2  ! X66_ARET

      199     8358    1        KL_FEMSG.FEX = FEX;

   8358  4 000151   200003 236100                    LDQ     FEX,,AUTO
         4 000152   000033 736000                    QLS     27
         4 000153   000006 552040 xsym               STBQ    KL_FEMSG+6,'40'O

      200     8359    1        CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,I)

   8359  4 000154   200007 630500                    EPPR0   I,,AUTO
         4 000155   200050 450500                    STP0    PPTR$+5,,AUTO
         4 000156   200003 631500                    EPPR1   FEX,,AUTO
         4 000157   200047 451500                    STP1    PPTR$+4,,AUTO
         4 000160   000014 236000 5                  LDQ     12
         4 000161   200046 756100                    STQ     PPTR$+3,,AUTO
         4 000162   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000163   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000164   000000 701000 xent               TSX1    KLX$CONV_NODE
         4 000165   000167 702000 4                  TSX2    s:8361
         4 000166   000172 710000 4                  TRA     s:8363

      201     8360    2        WHENALTRETURN DO;

      202     8361    2             KL_FEMSG.NAME = ' ';

   8361  4 000167   040000 100400                    MLR     fill='040'O
         4 000170   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000171   000006 600010 xsym               ADSC9   KL_FEMSG+6               cn=3,n=8

      203     8362    2           END;

      204     8363    2        DO CASE (ADDR(KL_RDBF)->BF.EVENT);

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:42   
   8363  4 000172   000000 235000 xsym               LDA     KL_RDBF
         4 000173   000005 115007                    CMPA    5,DL
         4 000174   000176 602005 4                  TNC     s:8363+4,AL
         4 000175   000255 710000 4                  TRA     s:8382
         4 000176   000255 710000 4                  TRA     s:8382
         4 000177   000255 710000 4                  TRA     s:8382
         4 000200   000221 710000 4                  TRA     s:8371
         4 000201   000203 710000 4                  TRA     s:8365
         4 000202   000252 710000 4                  TRA     s:8380

      205     8364    2        CASE (%CG_TDSC#);                  /* REMOTE DISCONNECTING */

      206     8365    2           KL_FETBL.ACTIVE(FEX) = '0'B;

   8365  4 000203   200003 720100                    LXL0    FEX,,AUTO
         4 000204   000015 236000 5                  LDQ     13
         4 000205   000000 356010 xsym               ANSQ    KL_FETBL,X0

      207     8366    2           CALL KLI$RECOVERY;

   8366  4 000206   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000207   000000 701000 xent               TSX1    KLI$RECOVERY
         4 000210   000000 011000                    NOP     0

      208     8367    2           KL_FEMSG.MSG# = FEDN_MSG#;

   8367  4 000211   000013 220003                    LDX0    11,DU
         4 000212   000000 440000 xsym               SXL0    KL_FEMSG

      209     8368    3           CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;

   8368  4 000213   000000 630400 xsym               EPPR0   KL_WKYN
         4 000214   440001 713400                    CLIMB   alt,write
         4 000215   401400 401760                    pmme    nvectors=4
         4 000216   000220 702000 4                  TSX2    s:8369
         4 000217   000220 710000 4                  TRA     s:8369

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:43   
      210     8369    3              END;

   8369  4 000220   000255 710000 4                  TRA     s:8382

      211     8370    2        CASE (%CG_TCON#);

      212     8371    2           KL_FETBL.ACTIVE(FEX) = '1'B;

   8371  4 000221   200003 720100                    LXL0    FEX,,AUTO
         4 000222   100000 236003                    LDQ     32768,DU
         4 000223   000000 256010 xsym               ORSQ    KL_FETBL,X0

      213     8372    2           KL_FEMSG.MSG#=FEUP_MSG#;

   8372  4 000224   000010 221003                    LDX1    8,DU
         4 000225   000000 441000 xsym               SXL1    KL_FEMSG

      214     8373    2           KL_FEMSG.STATE = 0;

   8373  4 000226   000000 236003                    LDQ     0,DU
         4 000227   000006 552010 xsym               STBQ    KL_FEMSG+6,'10'O

      215     8374    2           KL_FEMSG.PROB = 0;

   8374  4 000230   000006 552020 xsym               STBQ    KL_FEMSG+6,'20'O

      216     8375    2           IF FEX>KL_MXFE THEN KL_MXFE=FEX;

   8375  4 000231   000000 236000 xsym               LDQ     KL_MXFE
         4 000232   200003 116100                    CMPQ    FEX,,AUTO
         4 000233   000236 603000 4                  TRC     s:8376

   8375  4 000234   200003 235100                    LDA     FEX,,AUTO
         4 000235   000000 755000 xsym               STA     KL_MXFE

      217     8376    2           CALL KLI$FEGO (FEX);

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:44   
   8376  4 000236   200003 630500                    EPPR0   FEX,,AUTO
         4 000237   200046 450500                    STP0    PPTR$+3,,AUTO
         4 000240   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000241   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000242   000000 701000 xent               TSX1    KLI$FEGO
         4 000243   000000 011000                    NOP     0

      218     8377    3           CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;

   8377  4 000244   000000 630400 xsym               EPPR0   KL_WKYN
         4 000245   440001 713400                    CLIMB   alt,write
         4 000246   401400 401760                    pmme    nvectors=4
         4 000247   000251 702000 4                  TSX2    s:8378
         4 000250   000251 710000 4                  TRA     s:8378

      219     8378    3              END;

   8378  4 000251   000255 710000 4                  TRA     s:8382

      220     8379    2        CASE (%CG_TBRK#);

      221     8380    2           KL_FETBL.KTYP(FEX)=%KLKT_NONE#;

   8380  4 000252   200003 720100                    LXL0    FEX,,AUTO
         4 000253   000016 236000 5                  LDQ     14
         4 000254   000000 356010 xsym               ANSQ    KL_FETBL,X0

      222     8381    2        END;

      223     8382    1        RETURN;

   8382  4 000255   000000 702200 xent               TSX2  ! X66_ARET

      224     8383        /**/
      225     8384        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:45   
      226     8385    1   KLI$FEPCHANGE: ENTRY;

   8385  4 000256   000000 700200 xent  KLI$FEPCHAN* TSX0  ! X66_AUTO_0
         4 000257   000052 000000                    ZERO    42,0

      227     8386
      228     8387    1        FEX = ADDR(KL_RDBF)->KL$FEPST.FEP;

   8387  4 000260   000000 236000 xsym               LDQ     KL_RDBF
         4 000261   000022 772000                    QRL     18
         4 000262   000777 376007                    ANQ     511,DL
         4 000263   200003 756100                    STQ     FEX,,AUTO

      229     8388    1        PROB=ADDR(KL_RDBF)->KL$FEPST.PROB;

   8388  4 000264   000000 236000 xsym               LDQ     KL_RDBF
         4 000265   777777 376007                    ANQ     -1,DL
         4 000266   200004 756100                    STQ     PROB,,AUTO

      230     8389    1        STATE=ADDR(KL_RDBF)->KL$FEPST.STATE;

   8389  4 000267   000001 235000 xsym               LDA     KL_RDBF+1
         4 000270   000022 771000                    ARL     18
         4 000271   200006 755100                    STA     STATE,,AUTO

      231     8390    1        IF PROB ~= KIER_QOSCHG

   8390  4 000272   000023 116007                    CMPQ    19,DL
         4 000273   000301 600000 4                  TZE     s:8395

      232     8391    2        THEN DO;

      233     8392    2             KL_FETBL.LINK_CONNECT(FEX) = '1'B;

   8392  4 000274   200003 720100                    LXL0    FEX,,AUTO
         4 000275   200000 236003                    LDQ     65536,DU
         4 000276   000000 256010 xsym               ORSQ    KL_FETBL,X0
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:46   

      234     8393    2             KL_FETBL.LINK_ACTIVE(FEX) = '0'B;

   8393  4 000277   000017 236000 5                  LDQ     15
         4 000300   000000 356010 xsym               ANSQ    KL_FETBL,X0

      235     8394    2           END;

      236     8395    1        IF JC_ZIP~=0

   8395  4 000301   000000 236000 xsym               LDQ     JC_ZIP
         4 000302   000304 600000 4                  TZE     s:8398

      237     8396    1        THEN
      238     8397    1             RETURN;

   8397  4 000303   000000 702200 xent               TSX2  ! X66_ARET

      239     8398    1        KL_FEMSG.FEX=FEX;

   8398  4 000304   200003 236100                    LDQ     FEX,,AUTO
         4 000305   000033 736000                    QLS     27
         4 000306   000006 552040 xsym               STBQ    KL_FEMSG+6,'40'O

      240     8399    1        CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,I)

   8399  4 000307   200007 630500                    EPPR0   I,,AUTO
         4 000310   200050 450500                    STP0    PPTR$+5,,AUTO
         4 000311   200003 631500                    EPPR1   FEX,,AUTO
         4 000312   200047 451500                    STP1    PPTR$+4,,AUTO
         4 000313   000014 236000 5                  LDQ     12
         4 000314   200046 756100                    STQ     PPTR$+3,,AUTO
         4 000315   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000316   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000317   000000 701000 xent               TSX1    KLX$CONV_NODE
         4 000320   000322 702000 4                  TSX2    s:8401
         4 000321   000325 710000 4                  TRA     s:8403
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:47   

      241     8400    2        WHENALTRETURN DO;

      242     8401    2             KL_FEMSG.NAME = ' ';

   8401  4 000322   040000 100400                    MLR     fill='040'O
         4 000323   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000324   000006 600010 xsym               ADSC9   KL_FEMSG+6               cn=3,n=8

      243     8402    2           END;

      244     8403    1        KL_FEMSG.PROB=PROB;

   8403  4 000325   200004 236100                    LDQ     PROB,,AUTO
         4 000326   000022 736000                    QLS     18
         4 000327   000006 552020 xsym               STBQ    KL_FEMSG+6,'20'O

      245     8404    1        KL_FEMSG.STATE = STATE;

   8404  4 000330   200006 236100                    LDQ     STATE,,AUTO
         4 000331   000011 736000                    QLS     9
         4 000332   000006 552010 xsym               STBQ    KL_FEMSG+6,'10'O

      246     8405    1        IF STATE = KIST_BT                 /* Was booting */

   8405  4 000333   200006 235100                    LDA     STATE,,AUTO
         4 000334   000006 115007                    CMPA    6,DL
         4 000335   000347 601000 4                  TNZ     s:8412

      247     8406    2        THEN DO;

      248     8407    2             KL_FROG.FEX = FEX;

   8407  4 000336   200003 236100                    LDQ     FEX,,AUTO
         4 000337   000000 552004 xsym               STBQ    KL_FROG,'04'O

      249     8408    2             KL_FROG.FUNCTION = %KLFR_BTDN;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:48   

   8408  4 000340   004000 236007                    LDQ     2048,DL
         4 000341   000000 552010 xsym               STBQ    KL_FROG,'10'O

      250     8409    3             CALL M$WRITE (WRT_FROG) WHENALTRETURN DO;

   8409  4 000342   000000 630400 xsym               EPPR0   WRT_FROG
         4 000343   440001 713400                    CLIMB   alt,write
         4 000344   401400 401760                    pmme    nvectors=4
         4 000345   000347 702000 4                  TSX2    s:8412
         4 000346   000347 710000 4                  TRA     s:8412

      251     8410    3                END;

      252     8411    2           END;

      253     8412    2        DO CASE (PROB);

   8412  4 000347   200004 235100                    LDA     PROB,,AUTO
         4 000350   000024 115007                    CMPA    20,DL
         4 000351   000353 602005 4                  TNC     s:8412+4,AL
         4 000352   000660 710000 4                  TRA     PROBS
         4 000353   000377 710000 4                  TRA     s:8414
         4 000354   000605 710000 4                  TRA     s:8475
         4 000355   000660 710000 4                  TRA     PROBS
         4 000356   000660 710000 4                  TRA     PROBS
         4 000357   000660 710000 4                  TRA     PROBS
         4 000360   000660 710000 4                  TRA     PROBS
         4 000361   000660 710000 4                  TRA     PROBS
         4 000362   000660 710000 4                  TRA     PROBS
         4 000363   000660 710000 4                  TRA     PROBS
         4 000364   000660 710000 4                  TRA     PROBS
         4 000365   000660 710000 4                  TRA     PROBS
         4 000366   000613 710000 4                  TRA     s:8480
         4 000367   000660 710000 4                  TRA     PROBS
         4 000370   000572 710000 4                  TRA     s:8469
         4 000371   000572 710000 4                  TRA     s:8469
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:49   
         4 000372   000572 710000 4                  TRA     s:8469
         4 000373   000651 710000 4                  TRA     s:8496
         4 000374   000660 710000 4                  TRA     PROBS
         4 000375   000660 710000 4                  TRA     PROBS
         4 000376   000405 710000 4                  TRA     s:8418

      254     8413    2        CASE (KIER_OK);

      255     8414    2           KL_FETBL.LINK_ACTIVE(FEX) = '1'B;

   8414  4 000377   200003 720100                    LXL0    FEX,,AUTO
         4 000400   010000 236003                    LDQ     4096,DU
         4 000401   000000 256010 xsym               ORSQ    KL_FETBL,X0

      256     8415    2           KL_FETBL.KTYP(FEX) = %KLKT_NONE#;

   8415  4 000402   000016 236000 5                  LDQ     14
         4 000403   000000 356010 xsym               ANSQ    KL_FETBL,X0

      257     8416    2           RETURN;

   8416  4 000404   000000 702200 xent               TSX2  ! X66_ARET

      258     8417    2        CASE (KIER_QOSCHG);

      259     8418    2           IF KL_FETBL.HOST_NODE(FEX)

   8418  4 000405   200003 720100                    LXL0    FEX,,AUTO
         4 000406   000000 234010 xsym               SZN     KL_FETBL,X0
         4 000407   000453 605000 4                  TPL     s:8438

      260     8419    2           THEN
      261     8420    2                IF ADDR(KL_RDBF)->KL$FEPST.QOS = 255

   8420  4 000410   000001 721000 xsym               LXL1    KL_RDBF+1
         4 000411   000377 101003                    CMPX1   255,DU
         4 000412   000446 601000 4                  TNZ     s:8434
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:50   

      262     8421    3                THEN DO;

      263     8422    3                     KL_FETBL.ACTIVE(FEX) = '0'B;

   8422  4 000413   000015 236000 5                  LDQ     13
         4 000414   000000 356010 xsym               ANSQ    KL_FETBL,X0

      264     8423    3                     KL_FEMSG.PROB = 3;

   8423  4 000415   000003 236003                    LDQ     3,DU
         4 000416   000006 552020 xsym               STBQ    KL_FEMSG+6,'20'O

      265     8424    3                     KL_FEMSG.FEX = FEX;

   8424  4 000417   200003 236100                    LDQ     FEX,,AUTO
         4 000420   000033 736000                    QLS     27
         4 000421   000006 552040 xsym               STBQ    KL_FEMSG+6,'40'O

   8424  4 000422                       TELL_FEP_MSG null
      266     8425    3   TELL_FEP_MSG:     ;
      267     8426    3                     KL_FEMSG.MSG# = FEUP_MSG#;

   8426  4 000422   000010 220003                    LDX0    8,DU
         4 000423   000000 440000 xsym               SXL0    KL_FEMSG

      268     8427    3                     CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,NODETYPE);

   8427  4 000424   200005 630500                    EPPR0   NODETYPE,,AUTO
         4 000425   200050 450500                    STP0    PPTR$+5,,AUTO
         4 000426   200003 631500                    EPPR1   FEX,,AUTO
         4 000427   200047 451500                    STP1    PPTR$+4,,AUTO
         4 000430   000014 236000 5                  LDQ     12
         4 000431   200046 756100                    STQ     PPTR$+3,,AUTO
         4 000432   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000433   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000434   000000 701000 xent               TSX1    KLX$CONV_NODE
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:51   
         4 000435   000000 011000                    NOP     0

      269     8428    3                     KL_FEMSG.STATE = 1;

   8428  4 000436   001000 236007                    LDQ     512,DL
         4 000437   000006 552010 xsym               STBQ    KL_FEMSG+6,'10'O

      270     8429    3                     CALL M$WRITE(KL_WKYN)

   8429  4 000440   000000 630400 xsym               EPPR0   KL_WKYN
         4 000441   440001 713400                    CLIMB   alt,write
         4 000442   401400 401760                    pmme    nvectors=4
         4 000443   000445 702000 4                  TSX2    s:8432
         4 000444   000445 710000 4                  TRA     s:8432

      271     8430    4                     WHENALTRETURN DO;

      272     8431    4                        END;

      273     8432    3                   END;

   8432  4 000445   000453 710000 4                  TRA     s:8438

      274     8433    3                ELSE DO;

      275     8434    3                     KL_FETBL.ACTIVE(FEX) ='1'B;

   8434  4 000446   100000 236003                    LDQ     32768,DU
         4 000447   000000 256010 xsym               ORSQ    KL_FETBL,X0

      276     8435    3                     KL_FEMSG.PROB = 0;

   8435  4 000450   000000 236003                    LDQ     0,DU
         4 000451   000006 552020 xsym               STBQ    KL_FEMSG+6,'20'O

      277     8436    3                     GOTO TELL_FEP_MSG;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:52   
   8436  4 000452   000422 710000 4                  TRA     TELL_FEP_MSG

      278     8437    3                   END;
      279     8438    3           DO I = 0 TO KL_NODES;

   8438  4 000453   200007 450100                    STZ     I,,AUTO
         4 000454   000557 710000 4                  TRA     s:8465+1

      280     8439    3                IF I ~= KL_NODE            /* Not this node */

   8439  4 000455   200007 236100                    LDQ     I,,AUTO
         4 000456   000461 604000 4                  TMI     s:8439+4
         4 000457   000000 116000 xsym               CMPQ    KL_NODE
         4 000460   000556 600000 4                  TZE     s:8465
         4 000461   000000 236006 xsym               LDQ     KL_FETBL,QL
         4 000462   010000 316003                    CANQ    4096,DU
         4 000463   000556 600000 4                  TZE     s:8465
         4 000464   200007 236100                    LDQ     I,,AUTO
         4 000465   000470 604000 4                  TMI     s:8439+11
         4 000466   200003 116100                    CMPQ    FEX,,AUTO
         4 000467   000556 600000 4                  TZE     s:8465
         4 000470   000000 236006 xsym               LDQ     KL_FETBL,QL
         4 000471   200000 316003                    CANQ    65536,DU
         4 000472   000556 600000 4                  TZE     s:8465

      281     8440    3                     AND KL_FETBL.LINK_ACTIVE(I)
      282     8441    3                     AND I ~= FEX          /* Do not tell him about himself */
      283     8442    3                     AND KL_FETBL.LINK_CONNECT(I)
              8442                              /* dont stuff it down everyones throats */
      284     8443    4                THEN DO;

      285     8444    4                     NODECHG.FCN = IGA_NODECHG;

   8444  4 000473   051000 236003                    LDQ     20992,DU
         4 000474   200010 552140                    STBQ    NODECHG,'40'O,AUTO

      286     8445    4                     NODECHG.MYNODE = KL_NODE;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:53   

   8445  4 000475   000000 236000 xsym               LDQ     KL_NODE
         4 000476   200010 552104                    STBQ    NODECHG,'04'O,AUTO

      287     8446    4                     NODECHG.NODE = FEX;

   8446  4 000477   200003 236100                    LDQ     FEX,,AUTO
         4 000500   000033 736000                    QLS     27
         4 000501   200011 552140                    STBQ    NODECHG+1,'40'O,AUTO

      288     8447    4                     IF I = ADDR(KL_RDBF)->KL$FEPST.LNK_NODE

   8447  4 000502   000002 236000 xsym               LDQ     KL_RDBF+2
         4 000503   000022 772000                    QRL     18
         4 000504   200007 116100                    CMPQ    I,,AUTO
         4 000505   000512 601000 4                  TNZ     s:8451

      289     8448    4                     THEN
      290     8449    4                          NODECHG.QOS = ADDR(KL_RDBF)->KL$FEPST.ALT_QOS;

   8449  4 000506   000002 236000 xsym               LDQ     KL_RDBF+2
         4 000507   000011 736000                    QLS     9
         4 000510   200011 552110                    STBQ    NODECHG+1,'10'O,AUTO
         4 000511   000515 710000 4                  TRA     s:8452

      291     8450    4                     ELSE
      292     8451    4                          NODECHG.QOS = ADDR(KL_RDBF)->KL$FEPST.QOS;

   8451  4 000512   000001 236000 xsym               LDQ     KL_RDBF+1
         4 000513   000011 736000                    QLS     9
         4 000514   200011 552110                    STBQ    NODECHG+1,'10'O,AUTO

      293     8452    4                     IF NODECHG.QOS + KL_HOPCOST > 255

   8452  4 000515   200011 236100                    LDQ     NODECHG+1,,AUTO
         4 000516   000011 772000                    QRL     9
         4 000517   000777 376007                    ANQ     511,DL
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:54   
         4 000520   000000 036000 xsym               ADLQ    KL_HOPCOST
         4 000521   000400 116007                    CMPQ    256,DL
         4 000522   000526 602000 4                  TNC     s:8456

      294     8453    4                     THEN
      295     8454    4                          NODECHG.QOS = 255;

   8454  4 000523   377000 236007                    LDQ     130560,DL
         4 000524   200011 552110                    STBQ    NODECHG+1,'10'O,AUTO
         4 000525   000534 710000 4                  TRA     s:8457

      296     8455    4                     ELSE
      297     8456    4                          NODECHG.QOS = NODECHG.QOS + KL_HOPCOST;

   8456  4 000526   200011 236100                    LDQ     NODECHG+1,,AUTO
         4 000527   000011 772000                    QRL     9
         4 000530   000777 376007                    ANQ     511,DL
         4 000531   000000 036000 xsym               ADLQ    KL_HOPCOST
         4 000532   000011 736000                    QLS     9
         4 000533   200011 552110                    STBQ    NODECHG+1,'10'O,AUTO

      298     8457    4                     IF KL_FETBL.HOST_NODE(FEX)

   8457  4 000534   200003 720100                    LXL0    FEX,,AUTO
         4 000535   000000 234010 xsym               SZN     KL_FETBL,X0
         4 000536   000542 605000 4                  TPL     s:8462

      299     8458    5                     THEN DO;

      300     8459    5                          NODECHG.HOSTNODE = 1;

   8459  4 000537   000001 236003                    LDQ     1,DU
         4 000540   200011 552120                    STBQ    NODECHG+1,'20'O,AUTO

      301     8460    5                        END;

   8460  4 000541   000544 710000 4                  TRA     s:8463
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:55   

      302     8461    4                     ELSE
      303     8462    4                          NODECHG.HOSTNODE = 0;

   8462  4 000542   000000 236003                    LDQ     0,DU
         4 000543   200011 552120                    STBQ    NODECHG+1,'20'O,AUTO

      304     8463    4                     CALL KLX$WRHLPNODE(NODECHG,SIZEC(NODECHG),I);

   8463  4 000544   200007 630500                    EPPR0   I,,AUTO
         4 000545   200050 450500                    STP0    PPTR$+5,,AUTO
         4 000546   000020 236000 5                  LDQ     16
         4 000547   200047 756100                    STQ     PPTR$+4,,AUTO
         4 000550   200010 631500                    EPPR1   NODECHG,,AUTO
         4 000551   200046 451500                    STP1    PPTR$+3,,AUTO
         4 000552   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 000553   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000554   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000555   000000 011000                    NOP     0

      305     8464    4                   END;

      306     8465    3              END;

   8465  4 000556   200007 054100                    AOS     I,,AUTO
         4 000557   000000 236000 xsym               LDQ     KL_NODES
         4 000560   000455 604000 4                  TMI     s:8439
         4 000561   200007 116100                    CMPQ    I,,AUTO
         4 000562   000455 605000 4                  TPL     s:8439

      307     8466    2           KL_FETBL.QOS(FEX) = ADDR(KL_RDBF)->KL$FEPST.QOS;

   8466  4 000563   200003 720100                    LXL0    FEX,,AUTO
         4 000564   000001 236000 xsym               LDQ     KL_RDBF+1
         4 000565   000022 736000                    QLS     18
         4 000566   000000 676010 xsym               ERQ     KL_FETBL,X0
         4 000567   000777 376003                    ANQ     511,DU
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:56   
         4 000570   000000 656010 xsym               ERSQ    KL_FETBL,X0

      308     8467    2           RETURN;

   8467  4 000571   000000 702200 xent               TSX2  ! X66_ARET

      309     8468    2        CASE (KIER_STOP,KIER_PART,KIER_UPRT);

      310     8469    2           KL_FEMSG.MSG#=FESP_MSG#;

   8469  4 000572   000007 220003                    LDX0    7,DU
         4 000573   000000 440000 xsym               SXL0    KL_FEMSG

      311     8470    3           CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;

   8470  4 000574   000000 630400 xsym               EPPR0   KL_WKYN
         4 000575   440001 713400                    CLIMB   alt,write
         4 000576   401400 401760                    pmme    nvectors=4
         4 000577   000601 702000 4                  TSX2    s:8472
         4 000600   000601 710000 4                  TRA     s:8472

      312     8471    3              END;

      313     8472    2           KL_FETBL.KTYP(FEX) = %KLKT_NONE#;

   8472  4 000601   200003 720100                    LXL0    FEX,,AUTO
         4 000602   000016 236000 5                  LDQ     14
         4 000603   000000 356010 xsym               ANSQ    KL_FETBL,X0

      314     8473    2           RETURN;

   8473  4 000604   000000 702200 xent               TSX2  ! X66_ARET

      315     8474    2        CASE (KIER_TO);

      316     8475    2           IF STATE ~= KIST_BT AND STATE ~= KIST_DMP

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:57   
   8475  4 000605   200006 236100                    LDQ     STATE,,AUTO
         4 000606   000006 116007                    CMPQ    6,DL
         4 000607   000612 600000 4                  TZE     s:8475+5
         4 000610   000005 116007                    CMPQ    5,DL
         4 000611   000660 601000 4                  TNZ     PROBS
         4 000612   000704 710000 4                  TRA     s:8513

      317     8476    2           THEN
      318     8477    2                GOTO PROBS;
      319     8478
      320     8479    2        CASE (KIER_BCMD);

      321     8480    2           IF KL_FETBL.KTYP(FEX) ~= %KLKT_NONE#

   8480  4 000613   200003 720100                    LXL0    FEX,,AUTO
         4 000614   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000615   007000 316003                    CANQ    3584,DU
         4 000616   000704 600000 4                  TZE     s:8513

      322     8481    3           THEN DO;

      323     8482    3                IF KL_FETBL.KTYP(FEX) = %KLKT_DUMP#

   8482  4 000617   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000620   007000 376003                    ANQ     3584,DU
         4 000621   002000 116003                    CMPQ    1024,DU
         4 000622   000625 601000 4                  TNZ     s:8485

      324     8483    3                THEN
      325     8484    3                     KL_FROG.FUNCTION = %KLFR_DMP;

   8484  4 000623   002000 236007                    LDQ     1024,DL
         4 000624   000000 552010 xsym               STBQ    KL_FROG,'10'O

      326     8485    3                IF KL_FETBL.KTYP(FEX) = %KLKT_BOOT#

   8485  4 000625   000000 236010 xsym               LDQ     KL_FETBL,X0
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:58   
         4 000626   007000 376003                    ANQ     3584,DU
         4 000627   001000 116003                    CMPQ    512,DU
         4 000630   000633 601000 4                  TNZ     s:8488

      327     8486    3                THEN
      328     8487    3                     KL_FROG.FUNCTION = %KLFR_BT;

   8487  4 000631   001000 236007                    LDQ     512,DL
         4 000632   000000 552010 xsym               STBQ    KL_FROG,'10'O

      329     8488    3                IF KL_FETBL.KTYP(FEX) = %KLKT_CRASH#

   8488  4 000633   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000634   007000 376003                    ANQ     3584,DU
         4 000635   004000 116003                    CMPQ    2048,DU
         4 000636   000641 601000 4                  TNZ     s:8491

      330     8489    3                THEN
      331     8490    3                     KL_FROG.FUNCTION = %KLFR_DMPBT;

   8490  4 000637   003000 236007                    LDQ     1536,DL
         4 000640   000000 552010 xsym               STBQ    KL_FROG,'10'O

      332     8491    3                KL_FROG.FEX = FEX;

   8491  4 000641   200003 236100                    LDQ     FEX,,AUTO
         4 000642   000000 552004 xsym               STBQ    KL_FROG,'04'O

      333     8492    4                CALL M$WRITE (WRT_FROG) WHENALTRETURN DO;

   8492  4 000643   000000 630400 xsym               EPPR0   WRT_FROG
         4 000644   440001 713400                    CLIMB   alt,write
         4 000645   401400 401760                    pmme    nvectors=4
         4 000646   000650 702000 4                  TSX2    s:8494
         4 000647   000650 710000 4                  TRA     s:8494

      334     8493    4                   END;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:59   

      335     8494    3              END;

   8494  4 000650   000704 710000 4                  TRA     s:8513

      336     8495    2        CASE (KIER_FREQ);

      337     8496    2           IF STATE = KIST_BT

   8496  4 000651   200006 236100                    LDQ     STATE,,AUTO
         4 000652   000006 116007                    CMPQ    6,DL
         4 000653   000704 601000 4                  TNZ     s:8513

      338     8497    3           THEN DO;

      339     8498    3                KL_FETBL.KTYP(FEX) = %KLKT_NONE#;

   8498  4 000654   200003 720100                    LXL0    FEX,,AUTO
         4 000655   000016 236000 5                  LDQ     14
         4 000656   000000 356010 xsym               ANSQ    KL_FETBL,X0

      340     8499    3                RETURN;

   8499  4 000657   000000 702200 xent               TSX2  ! X66_ARET

      341     8500    3              END;
      342     8501    2        CASE (ELSE);

   8496  4 000660                       PROBS        null
      343     8502    2   PROBS:  ;
      344     8503    2           IF STATE ~= KIST_BT AND STATE ~= KIST_DMP

   8503  4 000660   200006 236100                    LDQ     STATE,,AUTO
         4 000661   000006 116007                    CMPQ    6,DL
         4 000662   000704 600000 4                  TZE     s:8513
         4 000663   000005 116007                    CMPQ    5,DL
         4 000664   000704 600000 4                  TZE     s:8513
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:60   
         4 000665   200003 720100                    LXL0    FEX,,AUTO
         4 000666   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000667   020000 316003                    CANQ    8192,DU
         4 000670   000704 601000 4                  TNZ     s:8513
         4 000671   040000 316003                    CANQ    16384,DU
         4 000672   000704 600000 4                  TZE     s:8513

      345     8504    2                AND NOT KL_FETBL.DEBUG(FEX)
      346     8505    2                AND KL_FETBL.BOSS(FEX)
      347     8506    3           THEN DO;

      348     8507    3                KL_FROG.FEX = FEX;

   8507  4 000673   200003 236100                    LDQ     FEX,,AUTO
         4 000674   000000 552004 xsym               STBQ    KL_FROG,'04'O

      349     8508    3                KL_FROG.FUNCTION = %KLFR_DMPBT;

   8508  4 000675   003000 236007                    LDQ     1536,DL
         4 000676   000000 552010 xsym               STBQ    KL_FROG,'10'O

      350     8509    4                CALL M$WRITE (WRT_FROG) WHENALTRETURN DO;

   8509  4 000677   000000 630400 xsym               EPPR0   WRT_FROG
         4 000700   440001 713400                    CLIMB   alt,write
         4 000701   401400 401760                    pmme    nvectors=4
         4 000702   000704 702000 4                  TSX2    s:8513
         4 000703   000704 710000 4                  TRA     s:8513

      351     8510    4                   END;

      352     8511    3              END;

      353     8512    2        END;

      354     8513    1        KL_FETBL.KTYP(FEX)=%KLKT_NONE#;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:61   
   8513  4 000704   200003 720100                    LXL0    FEX,,AUTO
         4 000705   000016 236000 5                  LDQ     14
         4 000706   000000 356010 xsym               ANSQ    KL_FETBL,X0

      355     8514    1        KL_FEMSG.MSG#=FECR_MSG#;

   8514  4 000707   000006 221003                    LDX1    6,DU
         4 000710   000000 441000 xsym               SXL1    KL_FEMSG

      356     8515    2        CALL M$WRITE (KL_WKYN) WHENALTRETURN DO;

   8515  4 000711   000000 630400 xsym               EPPR0   KL_WKYN
         4 000712   440001 713400                    CLIMB   alt,write
         4 000713   401400 401760                    pmme    nvectors=4
         4 000714   000716 702000 4                  TSX2    s:8516
         4 000715   000716 710000 4                  TRA     s:8516

      357     8516    2           END;

   8516  4 000716   000721 710000 4                  TRA     s:8519

      358     8517        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:62   
      359     8518    1   KLI$UPDATE: ENTRY;

   8518  4 000717   000000 700200 xent  KLI$UPDATE   TSX0  ! X66_AUTO_0
         4 000720   000052 000000                    ZERO    42,0

      360     8519    1        CALL UPDATE;

   8519  4 000721   000724 701000 4                  TSX1    UPDATE
         4 000722   000000 011000                    NOP     0

      361     8520    1        RETURN;

   8520  4 000723   000000 702200 xent               TSX2  ! X66_ARET

      362     8521        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:63   
      363     8522        %EJECT;
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:64   
      364     8523    1   UPDATE: PROC;

   8523  4 000724   200044 741300       UPDATE       STX1  ! PPTR$+1,,AUTO

      365     8524
      366     8525        /* Set the node name for all the nodes in the network */
      367     8526    2        KL_NETWORK_VALID = '0'B;

   8526  4 000725   000000 450000 xsym               STZ     KL_NETWORK_VALID

      368     8527    2        SETNODE.FCN = IGA_SETNODE;

   8527  4 000726   045000 236003                    LDQ     18944,DU
         4 000727   200031 552140                    STBQ    SETNODE,'40'O,AUTO

      369     8528    2        KL_RD_NETCON.BUF_ = VECTOR(KL_EXTRSP_BUF);

   8528  4 000730   000022 237000 5                  LDAQ    18
         4 000731   000004 757000 xsym               STAQ    KL_RD_NETCON+4

      370     8529    2        KL_RD_NETCON.KEY_ = VECTOR(KL$NETWORK_KEY);

   8529  4 000732   000024 237000 5                  LDAQ    20
         4 000733   000002 757000 xsym               STAQ    KL_RD_NETCON+2

      371     8530    2        CALL M$READ (KL_RD_NETCON)

   8530  4 000734   000000 630400 xsym               EPPR0   KL_RD_NETCON
         4 000735   440000 713400                    CLIMB   alt,read
         4 000736   401400 401760                    pmme    nvectors=4
         4 000737   001061 702000 4                  TSX2    s:8563

      372     8531    3        WHENRETURN DO;

      373     8532    4             DO I = 0 TO KL$NETWORK.NODE#;

   8532  4 000740   200007 450100                    STZ     I,,AUTO
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:65   
         4 000741   001054 710000 4                  TRA     s:8561+1

      374     8533    4                  SETNODE.NODE# = I;

   8533  4 000742   200007 235100                    LDA     I,,AUTO
         4 000743   200032 755100                    STA     SETNODE+1,,AUTO

      375     8534    4                  SETNODE.NODE_NAME = KL$NETWORK.NODE.NODE(I);

   8534  4 000744   200007 236100                    LDQ     I,,AUTO
         4 000745   000024 402007                    MPY     20,DL
         4 000746   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 000747   040100 100506                    MLR     fill='040'O
         4 000750   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         4 000751   200033 000010                    ADSC9   SETNODE+2,,AUTO          cn=0,n=8

      376     8535    4                  SETNODE.MY_NODE = '0'B;

   8535  4 000752   000026 236000 5                  LDQ     22
         4 000753   200031 356100                    ANSQ    SETNODE,,AUTO

      377     8536    5                  DO CASE (KL$NETWORK.NODE.TYPE(I));

   8536  4 000754   200007 236100                    LDQ     I,,AUTO
         4 000755   000005 402007                    MPY     5,DL
         4 000756   000001 235106                    LDA     1,QL,PR0
         4 000757   000005 115007                    CMPA    5,DL
         4 000760   000762 602005 4                  TNC     s:8536+6,AL
         4 000761   001017 710000 4                  TRA     s:8554
         4 000762   001013 710000 4                  TRA     s:8551
         4 000763   000767 710000 4                  TRA     s:8539
         4 000764   000775 710000 4                  TRA     s:8542
         4 000765   000767 710000 4                  TRA     s:8539
         4 000766   001003 710000 4                  TRA     s:8546

      378     8537
      379     8538    5                  CASE (%KL_NODETYPE_HOST,%KL_NODETYPE_ME);
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:66   

      380     8539    5                     KL_FETBL.HOST_NODE(I) = '1'B;

   8539  4 000767   200007 720100                    LXL0    I,,AUTO
         4 000770   400000 236003                    LDQ     -131072,DU
         4 000771   000000 256010 xsym               ORSQ    KL_FETBL,X0

      381     8540    5                     SETNODE.HOST_NODE = '1'B;

   8540  4 000772   000100 236007                    LDQ     64,DL
         4 000773   200031 256100                    ORSQ    SETNODE,,AUTO
         4 000774   001017 710000 4                  TRA     s:8554

      382     8541    5                  CASE (%KL_NODETYPE_FEP);

      383     8542    5                     SETNODE.HOST_NODE = '0'B;

   8542  4 000775   000027 236000 5                  LDQ     23
         4 000776   200031 356100                    ANSQ    SETNODE,,AUTO

      384     8543    5                     KL_FETBL.DEBUG(I) = '0'B;

   8543  4 000777   200007 720100                    LXL0    I,,AUTO
         4 001000   000030 236000 5                  LDQ     24
         4 001001   000000 356010 xsym               ANSQ    KL_FETBL,X0
         4 001002   001017 710000 4                  TRA     s:8554

      385     8544
      386     8545    5                  CASE (%KL_NODETYPE_DEBUG);

      387     8546    5                     SETNODE.HOST_NODE = '0'B;

   8546  4 001003   000027 236000 5                  LDQ     23
         4 001004   200031 356100                    ANSQ    SETNODE,,AUTO

      388     8547    5                     KL_FETBL.DEBUG(I) = '1'B;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:67   
   8547  4 001005   200007 720100                    LXL0    I,,AUTO
         4 001006   020000 236003                    LDQ     8192,DU
         4 001007   000000 256010 xsym               ORSQ    KL_FETBL,X0

      389     8548    5                     KL_FETBL.LINK_CONNECT(I) = '1'B;

   8548  4 001010   200000 236003                    LDQ     65536,DU
         4 001011   000000 256010 xsym               ORSQ    KL_FETBL,X0
         4 001012   001017 710000 4                  TRA     s:8554

      390     8549
      391     8550    5                  CASE (%KL_NODETYPE_UNDEF);

      392     8551    5                     SETNODE.NODE_NAME = ' ';

   8551  4 001013   000035 235000 xsym               LDA     B_VECTNIL+29
         4 001014   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 001015   200033 755100                    STA     SETNODE+2,,AUTO
         4 001016   200034 756100                    STQ     SETNODE+3,,AUTO

      393     8552
      394     8553    5                  END;

      395     8554    4                  CALL KLX$WRHLPNODE (SETNODE,SIZEC(SETNODE),KL_NODE);

   8554  4 001017   000005 236000 5                  LDQ     5
         4 001020   200050 756100                    STQ     PPTR$+5,,AUTO
         4 001021   000006 236000 5                  LDQ     6
         4 001022   200047 756100                    STQ     PPTR$+4,,AUTO
         4 001023   200031 631500                    EPPR1   SETNODE,,AUTO
         4 001024   200046 451500                    STP1    PPTR$+3,,AUTO
         4 001025   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 001026   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001027   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 001030   000000 011000                    NOP     0

      396     8555    4                  IF KL$NETWORK.NODE.CONTROL_NODE(I) = KL_NODENAME OR
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:68   

   8555  4 001031   200007 236100                    LDQ     I,,AUTO
         4 001032   000024 402007                    MPY     20,DL
         4 001033   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 001034   040000 106506                    CMPC    fill='040'O
         4 001035   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         4 001036   000000 000010 xsym               ADSC9   KL_NODENAME              cn=0,n=8
         4 001037   001044 600000 4                  TZE     s:8558
         4 001040   040000 106506                    CMPC    fill='040'O
         4 001041   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         4 001042   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001043   001050 601000 4                  TNZ     s:8560

      397     8556    4                       KL$NETWORK.NODE.CONTROL_NODE(I) = ' '
      398     8557    4                  THEN
      399     8558    4                       KL_FETBL.BOSS(I) = '1'B;

   8558  4 001044   200007 720100                    LXL0    I,,AUTO
         4 001045   040000 236003                    LDQ     16384,DU
         4 001046   000000 256010 xsym               ORSQ    KL_FETBL,X0
         4 001047   001053 710000 4                  TRA     s:8561

      400     8559    4                  ELSE
      401     8560    4                       KL_FETBL.BOSS(I) = '0'B;

   8560  4 001050   200007 720100                    LXL0    I,,AUTO
         4 001051   000031 236000 5                  LDQ     25
         4 001052   000000 356010 xsym               ANSQ    KL_FETBL,X0

      402     8561    4                END;

   8561  4 001053   200007 054100                    AOS     I,,AUTO
         4 001054   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 001055   000000 236100                    LDQ     0,,PR0
         4 001056   000742 604000 4                  TMI     s:8533
         4 001057   200007 116100                    CMPQ    I,,AUTO
         4 001060   000742 605000 4                  TPL     s:8533
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:69   

      403     8562    3           END;

      404     8563    2        SETNODE = '0'B;

   8563  4 001061   000100 100400                    MLR     fill='000'O
         4 001062   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001063   200031 000020                    ADSC9   SETNODE,,AUTO            cn=0,n=16

      405     8564    3        DO FEX = 0 TO KL$NETWORK.NODE#;

   8564  4 001064   200003 450100                    STZ     FEX,,AUTO
         4 001065   001151 710000 4                  TRA     s:8579+3

      406     8565    3            IF KL_FETBL.BOSS(FEX) AND KL_FETBL.ACTIVE(FEX) AND NOT KL_FETBL.HOST_NODE(
              8565                      FEX) THEN

   8565  4 001066   200003 720100                    LXL0    FEX,,AUTO
         4 001067   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 001070   040000 316003                    CANQ    16384,DU
         4 001071   001146 600000 4                  TZE     s:8579
         4 001072   100000 316003                    CANQ    32768,DU
         4 001073   001146 600000 4                  TZE     s:8579
         4 001074   000000 234010 xsym               SZN     KL_FETBL,X0
         4 001075   001146 604000 4                  TMI     s:8579

      407     8566    4             DO;

      408     8567    5                  DO I = 0 TO KL$NETWORK.NODE#;

   8567  4 001076   200007 450100                    STZ     I,,AUTO
         4 001077   001141 710000 4                  TRA     s:8577+1

      409     8568    5                       SETNODE.FCN = IGA_NODETBL;

   8568  4 001100   121000 236003                    LDQ     41472,DU
         4 001101   200031 552140                    STBQ    SETNODE,'40'O,AUTO
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:70   

      410     8569    5                       SETNODE.NODE# = I;

   8569  4 001102   200007 235100                    LDA     I,,AUTO
         4 001103   200032 755100                    STA     SETNODE+1,,AUTO

      411     8570    5                       SETNODE.NODE_NAME = KL$NETWORK.NODE.NODE(I);

   8570  4 001104   200007 236100                    LDQ     I,,AUTO
         4 001105   000024 402007                    MPY     20,DL
         4 001106   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 001107   040100 100506                    MLR     fill='040'O
         4 001110   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         4 001111   200033 000010                    ADSC9   SETNODE+2,,AUTO          cn=0,n=8

      412     8571    5                       IF KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_HOST OR

   8571  4 001112   200007 236100                    LDQ     I,,AUTO
         4 001113   000005 402007                    MPY     5,DL
         4 001114   000001 235106                    LDA     1,QL,PR0
         4 001115   000001 115007                    CMPA    1,DL
         4 001116   001121 600000 4                  TZE     s:8573
         4 001117   000003 115007                    CMPA    3,DL
         4 001120   001124 601000 4                  TNZ     s:8575

      413     8572    5                            KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_ME THEN
      414     8573    5                            SETNODE.HOST_NODE = '1'B;

   8573  4 001121   000100 236007                    LDQ     64,DL
         4 001122   200031 256100                    ORSQ    SETNODE,,AUTO
         4 001123   001126 710000 4                  TRA     s:8576

      415     8574    5                       ELSE
      416     8575    5                            SETNODE.HOST_NODE = '0'B;

   8575  4 001124   000027 236000 5                  LDQ     23
         4 001125   200031 356100                    ANSQ    SETNODE,,AUTO
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:71   

      417     8576    5                       CALL KLX$WRHLPNODE(SETNODE,SIZEC(SETNODE),FEX);

   8576  4 001126   200003 631500                    EPPR1   FEX,,AUTO
         4 001127   200050 451500                    STP1    PPTR$+5,,AUTO
         4 001130   000006 236000 5                  LDQ     6
         4 001131   200047 756100                    STQ     PPTR$+4,,AUTO
         4 001132   200031 633500                    EPPR3   SETNODE,,AUTO
         4 001133   200046 453500                    STP3    PPTR$+3,,AUTO
         4 001134   200046 630500                    EPPR0   PPTR$+3,,AUTO
         4 001135   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001136   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 001137   000000 011000                    NOP     0

      418     8577    5                     END;

   8577  4 001140   200007 054100                    AOS     I,,AUTO
         4 001141   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 001142   000000 236100                    LDQ     0,,PR0
         4 001143   001100 604000 4                  TMI     s:8568
         4 001144   200007 116100                    CMPQ    I,,AUTO
         4 001145   001100 605000 4                  TPL     s:8568

      419     8578    4                END;

      420     8579    3           END;

   8579  4 001146   200003 235100                    LDA     FEX,,AUTO
         4 001147   000001 035007                    ADLA    1,DL
         4 001150   200003 755100                    STA     FEX,,AUTO
         4 001151   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 001152   000000 236100                    LDQ     0,,PR0
         4 001153   200003 116100                    CMPQ    FEX,,AUTO
         4 001154   001066 603000 4                  TRC     s:8565

      421     8580    2        RETURN;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:72   
   8580  4 001155   200044 221300                    LDX1  ! PPTR$+1,,AUTO
         4 001156   000001 702211                    TSX2  ! 1,X1
      422     8581
      423     8582    2   END UPDATE;
      424     8583    1   END KLI$FEEV;
      425     8584        /**/
      426     8585        /**/
      427     8586        %EOD;

PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:73   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$FEEV.
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:74   

 **** Variables and constants ****

  ****  Section 002 RoData KLI$FEEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w STRC(18)    r     1 KL$NETWORK_KEY             0-0-0/w STRC(18)    r     1 KL$NODEINFO_KEY

  ****  Section 003  Data  KLI$FEEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/d STRC(144)   r     1 SADTIGR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 FEX                        7-0-0/w SBIN        r     1 I
    10-0-0/w STRC(63)    r     1 NODECHG                    5-0-0/w UBIN        r     1 NODETYPE
    43-0-0/w PTR         r     1 PPTR$                      4-0-0/w UBIN        r     1 PROB
    31-0-0/w STRC(144)   r     1 SETNODE                    6-0-0/w UBIN        r     1 STATE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 JC_ZIP                     0-0-0/w UBIN        r     1 KI_MXFE
     0-0-0/w UBIN        r     1 KI_OSIMAX#                 0-0-0/w PTR         r     1 KI_OSIROUTE$$
     0-0-0/w UBIN        r     1 KL_EXTRSP_BUF(0:1499)
     0-0-0/w PTR         r     1 KL_EXTRSP_BUF$             0-0-0/w STRC(315)   r     1 KL_FEMSG
     0-0-0/w STRC        r     1 KL_FETBL(0:0)
     0-0-0/w STRC        r     1 KL_FROG                    0-0-0/w UBIN        r     1 KL_HOPCOST
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:75   
     0-0-0/w UBIN        r     1 KL_MAXFEI#                 0-0-0/w UBIN        r     1 KL_MXFE
     0-0-0/b BIT         r     1 KL_NETWORK_VALID           0-0-0/w UBIN        r     1 KL_NMNODE
     0-0-0/w UBIN        r     1 KL_NODE                    0-0-0/c CHAR(8)     r     1 KL_NODENAME
     0-0-0/w UBIN        r     1 KL_NODES                   0-0-0/w UBIN        r     1 KL_OSIMAX#
     0-0-0/w PTR         r     1 KL_OSIROUTE$               0-0-0/w STRC(1260)  r     1 KL_RDBF
     0-0-0/w PTR         r     1 KL_RDBF$                   0-0-0/d STRC(504)   r     1 KL_RD_NETCON
     0-0-0/c CHAR(8)     r     1 KL_STATION                 0-0-0/d STRC(432)   r     1 KL_WKYN
     0-0-0/d STRC(432)   r     1 WRT_FROG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$PTR                      0-0-0/w UBIN        r     1 B$UBIN
     0-0-0/w STRC(144)   r     1 BF                         0-0-0/w STRC(126)   r     1 KL$FEPST
     0-0-0/w STRC(216)   r     1 KL$NETWORK                 0-0-0/w STRC(108)   r     1 KL$NODEINFO


   Procedure KLI$FEEV requires 623 words for executable code.
   Procedure KLI$FEEV requires 42 words of local(AUTO) storage.
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:76   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:77   
          MINI XREF LISTING

B$JIT.CPFLAGS1.SLEAZE
      7376**DCL      7376--REDEF
B$JIT.ERR.MID
      7283**DCL      7283--REDEF
B$PTR
      8067**DCL      8348>>ASSIGN
B$UBIN
      8068**DCL      8342>>ASSIGN   8345>>ASSIGN
BF.EVENT
      7470**DCL      8317>>IF       8363>>DOCASE
BF.STATION
      7470**DCL      7470--REDEF    8356>>CALLBLT
FEX
      7620**DCL      8356<<CALLBLT  8357>>IF       8358>>ASSIGN   8359<>CALL     8365>>ASSIGN   8371>>ASSIGN
      8375>>IF       8375>>ASSIGN   8376<>CALL     8380>>ASSIGN   8387<<ASSIGN   8392>>ASSIGN   8393>>ASSIGN
      8398>>ASSIGN   8399<>CALL     8407>>ASSIGN   8414>>ASSIGN   8415>>ASSIGN   8418>>IF       8422>>ASSIGN
      8424>>ASSIGN   8427<>CALL     8434>>ASSIGN   8439>>IF       8446>>ASSIGN   8457>>IF       8466>>ASSIGN
      8472>>ASSIGN   8480>>IF       8482>>IF       8485>>IF       8488>>IF       8491>>ASSIGN   8498>>ASSIGN
      8503>>IF       8503>>IF       8507>>ASSIGN   8513>>ASSIGN   8564<<DOINDEX  8565>>IF       8565>>IF
      8565>>IF       8576<>CALL
FROG_STA.MSGIDXT
      8293**DCL      8296--REDEF
I
      7624**DCL      8359<>CALL     8399<>CALL     8438<<DOINDEX  8439>>IF       8439>>IF       8439>>IF
      8439>>IF       8447>>IF       8463<>CALL     8532<<DOINDEX  8533>>ASSIGN   8534>>ASSIGN   8536>>DOCASE
      8539>>ASSIGN   8543>>ASSIGN   8547>>ASSIGN   8548>>ASSIGN   8555>>IF       8555>>IF       8558>>ASSIGN
      8560>>ASSIGN   8567<<DOINDEX  8569>>ASSIGN   8570>>ASSIGN   8571>>IF       8571>>IF
JC_ZIP
      8127**DCL      8395>>IF
JMU$SETSEG
      8134**DCL-ENT  8341--CALL     8344--CALL     8347--CALL
KI_MXFE
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:78   
      8126**DCL      8343--ASSIGN
KI_OSIMAX#
      8124**DCL      8340--ASSIGN
KI_OSIROUTE$$
      8125**DCL      8346--ASSIGN
KL$FEPST.ALT_QOS
      7504**DCL      8449>>ASSIGN
KL$FEPST.FEP
      7489**DCL      8387>>ASSIGN
KL$FEPST.LNK_NODE
      7503**DCL      8447>>IF
KL$FEPST.PROB
      7500**DCL      8388>>ASSIGN
KL$FEPST.QOS
      7502**DCL      8420>>IF       8451>>ASSIGN   8466>>ASSIGN
KL$FEPST.STATE
      7501**DCL      8389>>ASSIGN
KL$NETWORK.NODE.CONTROL_NODE
      7548**DCL      8555>>IF       8555>>IF
KL$NETWORK.NODE.NODE
      7547**DCL      8534>>ASSIGN   8570>>ASSIGN
KL$NETWORK.NODE.TYPE
      7544**DCL      8536>>DOCASE   8571>>IF       8571>>IF
KL$NETWORK.NODE#
      7539**DCL      8532>>DOINDEX  8564>>DOINDEX  8567>>DOINDEX
KL$NETWORK_KEY
      8166**DCL      8529--ASSIGN
KL$NODEINFO
      7521**DCL      8319--ASSIGN
KL$NODEINFO.NODE#
      7522**DCL      8324>>ASSIGN
KL$NODEINFO.NODENAME
      7523**DCL      8325>>ASSIGN
KL$NODEINFO_KEY
      8149**DCL      8320--ASSIGN
KL$UPDOSI.LNSAP.ADDRESS_N
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:79   
      8029**DCL      8030--REDEF
KL$UPDOSI.MYNODE#
      7910**DCL      7912--REDEF
KL$UPDOSI.NODE#
      7913**DCL      7915--REDEF
KL$UPDOSI.NSAP.ADDRESS_N
      7973**DCL      7974--REDEF
KLI$FEGO
      8130**DCL-ENT  8376--CALL
KLI$GETOSIROUTES
      8133**DCL-ENT  8332--CALL
KLI$RECOVERY
      8132**DCL-ENT  8366--CALL
KLX$CONV_NODE
      8129**DCL-ENT  8359--CALL     8399--CALL     8427--CALL
KLX$WRHLPNODE
      8131**DCL-ENT  8330--CALL     8463--CALL     8554--CALL     8576--CALL
KL_AUTOFAIL.FLAGS
      4612**DCL      4613--REDEF
KL_AUTOFAIL.MSGID
      4608**DCL      4609--REDEF
KL_AUTOFAIL.WSN
      4615**DCL      4616--REDEF
KL_EXTRSP_BUF
      4768**DCL      8528--ASSIGN
KL_EXTRSP_BUF$
      4769**DCL      7538--IMP-PTR  8532>>DOINDEX  8534>>ASSIGN   8536>>DOCASE   8555>>IF       8555>>IF
      8564>>DOINDEX  8567>>DOINDEX  8570>>ASSIGN   8571>>IF       8571>>IF
KL_FEMSG.FEX
      4572**DCL      8358<<ASSIGN   8398<<ASSIGN   8424<<ASSIGN
KL_FEMSG.FLAGS
      4562**DCL      4563--REDEF
KL_FEMSG.MSG#
      4557**DCL      8367<<ASSIGN   8372<<ASSIGN   8426<<ASSIGN   8469<<ASSIGN   8514<<ASSIGN
KL_FEMSG.MSGID
      4558**DCL      4559--REDEF
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:80   
KL_FEMSG.NAME
      4575**DCL      8359<>CALL     8361<<ASSIGN   8399<>CALL     8401<<ASSIGN   8427<>CALL
KL_FEMSG.PROB
      4573**DCL      8374<<ASSIGN   8403<<ASSIGN   8423<<ASSIGN   8435<<ASSIGN
KL_FEMSG.STATE
      4574**DCL      8373<<ASSIGN   8404<<ASSIGN   8428<<ASSIGN
KL_FEMSG.WSN
      4565**DCL      4566--REDEF
KL_FETBL.ACTIVE
      4504**DCL      8337<<ASSIGN   8365<<ASSIGN   8371<<ASSIGN   8422<<ASSIGN   8434<<ASSIGN   8565>>IF
KL_FETBL.BOSS
      4505**DCL      8503>>IF       8558<<ASSIGN   8560<<ASSIGN   8565>>IF
KL_FETBL.DEBUG
      4506**DCL      8503>>IF       8543<<ASSIGN   8547<<ASSIGN
KL_FETBL.HOST_NODE
      4502**DCL      8336<<ASSIGN   8418>>IF       8457>>IF       8539<<ASSIGN   8565>>IF
KL_FETBL.KTYP
      4508**DCL      8380<<ASSIGN   8415<<ASSIGN   8472<<ASSIGN   8480>>IF       8482>>IF       8485>>IF
      8488>>IF       8498<<ASSIGN   8513<<ASSIGN
KL_FETBL.LINK_ACTIVE
      4507**DCL      8393<<ASSIGN   8414<<ASSIGN   8439>>IF
KL_FETBL.LINK_CONNECT
      4503**DCL      8392<<ASSIGN   8439>>IF       8548<<ASSIGN
KL_FETBL.QOS
      4509**DCL      8466<<ASSIGN
KL_FROG.FEX
      7568**DCL      8407<<ASSIGN   8491<<ASSIGN   8507<<ASSIGN
KL_FROG.FUNCTION
      7567**DCL      8408<<ASSIGN   8484<<ASSIGN   8487<<ASSIGN   8490<<ASSIGN   8508<<ASSIGN
KL_HOPCOST
      4540**DCL      8452>>IF       8456>>ASSIGN
KL_MAXFEI#
      4513**DCL      8345<<ASSIGN
KL_MXFE
      4500**DCL      8375>>IF       8375<<ASSIGN
KL_NETWORK_BUF.TERMINAL_ID.TERM
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:81   
      4752**DCL      4761--REDEF
KL_NETWORK_KEY.KEY.TERMID.TERM
      4678**DCL      4687--REDEF
KL_NETWORK_VALID
      4541**DCL      8526<<ASSIGN
KL_NMNODE
      4544**DCL      8329<<ASSIGN
KL_NODE
      4543**DCL      8328<<ASSIGN   8329>>ASSIGN   8330<>CALL     8332<>CALL     8336>>ASSIGN   8337>>ASSIGN
      8439>>IF       8445>>ASSIGN   8554<>CALL
KL_NODENAME
      4542**DCL      8327<<ASSIGN   8555>>IF
KL_NODES
      4539**DCL      8357>>IF       8438>>DOINDEX
KL_OSIMAX#
      4514**DCL      8342<<ASSIGN
KL_OSIROUTE$
      4515**DCL      8348<<ASSIGN
KL_RDBF
      4518**DCL      8317--IF       8319--ASSIGN   8324--ASSIGN   8325--ASSIGN   8356--CALLBLT  8363--DOCASE
      8387--ASSIGN   8388--ASSIGN   8389--ASSIGN   8420--IF       8447--IF       8449--ASSIGN   8451--ASSIGN
      8466--ASSIGN
KL_RDBF.FEL#
      4521**DCL      4522--REDEF
KL_RDBF$
      4533**DCL      7875--IMP-PTR
KL_RD_NETCON
      8187**DCL      8322<>CALL     8530<>CALL
KL_RD_NETCON.BUF_
      8189**DCL      8319<<ASSIGN   8528<<ASSIGN
KL_RD_NETCON.KEY_
      8187**DCL      8320<<ASSIGN   8529<<ASSIGN
KL_RD_NETCON.STATION_
      8190**DCL      8191--REDEF
KL_RD_NETCON.V.DVBYTE.REREAD#
      8202**DCL      8202--REDEF
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:82   
KL_RD_NETCON.V.INDX#
      8200**DCL      8200--REDEF
KL_STATION
      8128**DCL      8315>>IF
KL_TMSG.FLAGS
      4584**DCL      4585--REDEF
KL_TMSG.MSGID
      4580**DCL      4581--REDEF
KL_TMSG.WSN
      4587**DCL      4588--REDEF
KL_WKYN
      8226**DCL      8368<>CALL     8377<>CALL     8429<>CALL     8470<>CALL     8515<>CALL
KL_WKYN.STATION_
      8228**DCL      8228--REDEF
KL_WKYN.V.DVBYTE.VFC#
      8235**DCL      8235--REDEF
M$READ
        22**DCL-ENT  8322--CALL     8530--CALL
M$SAD
        60**DCL-ENT  8338--CALL
M$WRITE
        22**DCL-ENT  8368--CALL     8377--CALL     8409--CALL     8429--CALL     8470--CALL     8492--CALL
      8509--CALL     8515--CALL
NODECHG
      7640**DCL      8463<>CALL     8463--CALL
NODECHG.FCN
      7641**DCL      8444<<ASSIGN
NODECHG.HOSTNODE
      7646**DCL      8459<<ASSIGN   8462<<ASSIGN
NODECHG.MYNODE
      7644**DCL      8445<<ASSIGN
NODECHG.NODE
      7645**DCL      8446<<ASSIGN
NODECHG.QOS
      7647**DCL      8449<<ASSIGN   8451<<ASSIGN   8452>>IF       8454<<ASSIGN   8456<<ASSIGN   8456>>ASSIGN
NODETYPE
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:83   
      7622**DCL      8427<>CALL
PPTR$
      8122**DCL      8340<<ASSIGN   8341<>CALL     8342>>ASSIGN   8343<<ASSIGN   8344<>CALL     8345>>ASSIGN
      8346<<ASSIGN   8347<>CALL     8348>>ASSIGN
PROB
      7621**DCL      8388<<ASSIGN   8390>>IF       8403>>ASSIGN   8412>>DOCASE
PROBS
      8496**LABEL    8477--GOTO
SADTIGR
      8309**DCL      8338<>CALL
SADTIGR.V
      8309**DCL      8309--DCLINIT
SETNODE
      8084**DCL      8330<>CALL     8330--CALL     8554<>CALL     8554--CALL     8563<<ASSIGN   8576<>CALL
      8576--CALL
SETNODE.FCN
      8085**DCL      8321<<ASSIGN   8527<<ASSIGN   8568<<ASSIGN
SETNODE.HOST_NODE
      8096**DCL      8540<<ASSIGN   8542<<ASSIGN   8546<<ASSIGN   8573<<ASSIGN   8575<<ASSIGN
SETNODE.MY_NODE
      8091**DCL      8326<<ASSIGN   8535<<ASSIGN
SETNODE.NODE#
      8108**DCL      8324<<ASSIGN   8328>>ASSIGN   8533<<ASSIGN   8569<<ASSIGN
SETNODE.NODE_NAME
      8112**DCL      8325<<ASSIGN   8327>>ASSIGN   8534<<ASSIGN   8551<<ASSIGN   8570<<ASSIGN
STATE
      7623**DCL      8389<<ASSIGN   8404>>ASSIGN   8405>>IF       8475>>IF       8475>>IF       8496>>IF
      8503>>IF       8503>>IF
TELL_FEP_MSG
      8424**LABEL    8436--GOTO
UPDATE
      8523**PROC     8333--CALL     8519--CALL
UPDOSI.LNSAP.ADDRESS_N
      7820**DCL      7821--REDEF
UPDOSI.MYNODE#
      7701**DCL      7703--REDEF
PL6.E3A0      #002=KLI$FEEV File=KLI$FESET.:E05TSI                               WED 07/30/97 00:50 Page:84   
UPDOSI.NODE#
      7704**DCL      7706--REDEF
UPDOSI.NSAP.ADDRESS_N
      7764**DCL      7765--REDEF
WRT_FROG
      8257**DCL      8409<>CALL     8492<>CALL     8509<>CALL
WRT_FROG.STATION_
      8259**DCL      8259--REDEF
WRT_FROG.V.DVBYTE.VFC#
      8266**DCL      8266--REDEF

PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:85   
      428        1        /*T***********************************************************/
      429        2        /*T*                                                         */
      430        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      431        4        /*T*                                                         */
      432        5        /*T***********************************************************/
      433        6        /*
      434        7             This routine reads the :routes file and forwards the information
      435        8             to the specified node.
      436        9             This module exists because at some time in the future the :route
      437       10             file will give way to a real network layer directory server.  At that
      438       11             time the module will have to be rewitten to accomidate the new file
      439       12             structure.
      440       13        */
      441       14        KLI$GETOSIROUTES: PROC(NODE#);
      442       15
      443       16             %INCLUDE CP_6;
      444       97             %INCLUDE KL_AFCN_C;
      445      198             %INCLUDE KL_MACRO_C;
      446     3550             %INCLUDE K_ADDRESS_M;
      447     4053             %INCLUDE KL_DATA_R;
      448     4517
      449     4518    1   DCL KLH$OPFILS_ROUTE ENTRY ALTRET;
      450     4519    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
      451     4520
      452     4521        /*
      453     4522             constant data.
      454     4523        */
      455     4524             %KL_NSAP_KEY(FPTN=NSAP_KEY_C,STCLASS=CONSTANT,ALGN=DALIGNED);
      456     4543
      457     4544    1   DCL M$ROUTE DCB;
      458     4545
      459     4546             %FPT_READ(FPTN=READ_ROUTE,
      460     4547                  DCB=M$ROUTE,
      461     4548                  KEY=NSAP_KEY,
      462     4549                  KEYS=YES,
      463     4550                  BUF=NSAP_BUF,
      464     4551                  STCLASS=STATIC);
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:86   
      465     4590
      466     4591             %FPT_PRECORD(FPTN=PRECORD_ROUTE,
      467     4592                   KEYS=YES,
      468     4593                   KEYR=YES,
      469     4594                   KEY=NSAP_KEY,
      470     4595                   DCB=M$ROUTE,
      471     4596                   N=1,
      472     4597                   STCLASS=STATIC);
      473     4618             %FPT_PRECORD(FPTN=KL_PR_NETWORK,STCLASS=SYMREF);
      474     4639             %FPT_READ(FPTN=KL_RD_NETWORK,STCLASS=SYMREF);
      475     4678        /*
      476     4679             auto
      477     4680        */
      478     4681             %KL_NSAP_KEY(FPTN=NSAP_KEY,STCLASS=STATIC,ALGN=DALIGNED);
      479     4700
      480     4701             %KL_UPDOSI(FPTN=NSAP_BUF,STCLASS=STATIC);
      481     4910             %KL_UPDOSI(FPTN=UPDOSI,STCLASS="REDEF NSAP_BUF");
      482     5119
      483     5120             %KL_OSILINK_REC(FPTN=OSILINK_REC,STCLASS=AUTO);
      484     5168             %KL_OSILINKCHG(FPTN=OSILINKCHG,STCLASS=AUTO);
      485     5291             %KL_LINE_KEY(FPTN=OSILINK_KEY,STCLASS=AUTO);
      486     5341        %B$CGAURD (FPTN=BF);
      487     5360    1   DCL NODE# UBIN;
      488     5361        /*
      489     5362          if the :routes file is not already open, try to open it.
      490     5363          if it can't be opened dont worry about it.
      491     5364        */
      492     5365
      493     5366    1        NSAP_BUF = '0'B;
      494     5367    2        IF KL_ROUTEOPEN = 0 THEN DO;
      495     5368    2             CALL KLH$OPFILS_ROUTE;
      496     5369    2             IF KL_ROUTEOPEN = 0 THEN      /* could not open :routes */
      497     5370    2                  GOTO SEND_SNPA;          /* no routes */
      498     5371    2           END;
      499     5372
      500     5373    1        PRECORD_ROUTE.V.N# = 0;
      501     5374    1        NSAP_KEY = '0'B;
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:87   
      502     5375    1        NSAP_KEY.CNT = NSAP_KEY_C.CNT;
      503     5376    2        CALL M$PRECORD(PRECORD_ROUTE) WHENALTRETURN DO;
      504     5377               /* expected*/
      505     5378    2           END;
      506     5379    1        PRECORD_ROUTE.V.N# = 1;
      507     5380
      508     5381        /*
      509     5382          read the nsap records.  function and type are all ready set just forward
      510     5383          to the specified node.
      511     5384        */
      512     5385
      513     5386    2        DO WHILE ('1'B);
      514     5387    3             CALL M$READ(READ_ROUTE) WHENALTRETURN DO;
      515     5388    3                  GOTO SEND_SNPA;
      516     5389    3                END;
      517     5390    2             CALL KLX$WRHLPNODE(NSAP_BUF,SIZEC(NSAP_BUF),NODE#);
      518     5391    3             CALL M$PRECORD(PRECORD_ROUTE) WHENALTRETURN DO;
      519     5392    3                  GOTO SEND_SNPA;
      520     5393    3                END;
      521     5394    2           END;                            /* do while */
      522     5395
      523     5396    1   KLI$GETSNPA: ENTRY(NODE#);
      524     5397    1   SEND_SNPA:;
      525     5398    1        OSILINK_KEY = '0'B;
      526     5399    1        OSILINK_KEY.SIZE = LENGTHC(OSILINK_KEY.KEY);
      527     5400    1        OSILINK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_OSILINK;
      528     5401    1        KL_PR_NETWORK.KEY_ = VECTOR(OSILINK_KEY);
      529     5402    1        KL_RD_NETWORK.KEY_ = VECTOR(OSILINK_KEY);
      530     5403    1        KL_RD_NETWORK.BUF_ = VECTOR(OSILINK_REC);
      531     5404    2        CALL M$PRECORD(KL_PR_NETWORK) WHENALTRETURN DO;
      532     5405             /* expected */
      533     5406    2           END;
      534     5407    1        OSILINKCHG.MYNODE# = KL_NODE;
      535     5408    1        OSILINKCHG.FCN = IGA_OSILINKCHG_DF; /* _DF is dont forward */
      536     5409    1        OSILINKCHG.TYPE = IGA_OSILINKUP;
      537     5410
      538     5411    2        DO WHILE ('1'B);
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:88   
      539     5412    3             CALL M$READ(KL_RD_NETWORK) WHENALTRETURN DO;
      540     5413                /* not expected */
      541     5414    3                  GOTO RESTOR_RET;
      542     5415    3                END;
      543     5416    2             IF OSILINK_KEY.KEY.KEYTYP ~= %KL_NETWORK_KEYTYP_OSILINK THEN
      544     5417    2                  GOTO RESTOR_RET;
      545     5418
      546     5419    3             IF OSILINK_KEY.KEY.NODE ~= NODE# THEN DO;
      547     5420    3                  OSILINKCHG.NODE# = OSILINK_KEY.KEY.NODE;
      548     5421    3                  OSILINKCHG.SNPA = OSILINK_REC.SNPA;
      549     5422    3                  IF (SUBSTR(ADDR(KL_RDBF)->BF.STATION,0,4) ~= 'FEPA') THEN RETURN;
      550     5423    3                  OSILINKCHG.QOS = OSILINK_REC.QOS;
      551     5424    3                  CALL KLX$WRHLPNODE(OSILINKCHG,SIZEC(OSILINKCHG),NODE#);
      552     5425    3                END;
      553     5426    3             CALL M$PRECORD(KL_PR_NETWORK) WHENALTRETURN DO;
      554     5427    3                  GOTO RESTOR_RET;
      555     5428    3                END;
      556     5429    2           END;
      557     5430
      558     5431    1   RESTOR_RET:;                  /* restore RD_NETWORK.BUF_ and .KEY_ and return */
      559     5432    1        KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
      560     5433    1        KL_RD_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);
      561     5434    1        KL_PR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
      562     5435    1   END KLI$GETOSIROUTES;
      563     5436        %EOD;

PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:89   
--  Include file information  --

   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$GETOSIROUTES.

   Procedure KLI$GETOSIROUTES requires 134 words for executable code.
   Procedure KLI$GETOSIROUTES requires 24 words of local(AUTO) storage.

PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:90   

 Object Unit name= KLI$GETOSIROUTES                           File name= KLI$FESET.:E05TOU
 UTS= JUL 30 '97 00:51:16.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$HLP
    2  RoData even  UTS      5      5  KLI$GETOSIROUTES
    3   DCB   even  none     0      0  M$ROUTE
    4   Data  even  none    43     53  KLI$GETOSIROUTES
    5   Proc  even  none   134    206  KLI$GETOSIROUTES
    6  RoData even  none    12     14  KLI$GETOSIROUTES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        1  KLI$GETOSIROUTES
     5     56                  yes      Std        1  KLI$GETSNPA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 KLH$OPFILS_ROUTE
 yes     yes           Std       4 KLX$WRHLPNODE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:91   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$HLP                                 KL_ROUTEOPEN
     KL_RDBF                               KL_NODE                               KL_NETWORK_KEY
     KL_NETWORK_BUF                        M$ROUTE                               KL_PR_NETWORK
     KL_RD_NETWORK                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:92   


      428        1        /*T***********************************************************/
      429        2        /*T*                                                         */
      430        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      431        4        /*T*                                                         */
      432        5        /*T***********************************************************/
      433        6        /*
      434        7             This routine reads the :routes file and forwards the information
      435        8             to the specified node.
      436        9             This module exists because at some time in the future the :route
      437       10             file will give way to a real network layer directory server.  At that
      438       11             time the module will have to be rewitten to accomidate the new file
      439       12             structure.
      440       13        */
      441       14        KLI$GETOSIROUTES: PROC(NODE#);

     14  5 000000   000000 700200 xent  KLI$GETOSIR* TSX0  ! X66_AUTO_1
         5 000001   000030 000001                    ZERO    24,1

      442       15
      443       16             %INCLUDE CP_6;
      444       97             %INCLUDE KL_AFCN_C;
      445      198             %INCLUDE KL_MACRO_C;
      446     3550             %INCLUDE K_ADDRESS_M;
      447     4053             %INCLUDE KL_DATA_R;
      448     4517
      449     4518    1   DCL KLH$OPFILS_ROUTE ENTRY ALTRET;
      450     4519    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
      451     4520
      452     4521        /*
      453     4522             constant data.
      454     4523        */
      455     4524             %KL_NSAP_KEY(FPTN=NSAP_KEY_C,STCLASS=CONSTANT,ALGN=DALIGNED);
      456     4543
      457     4544    1   DCL M$ROUTE DCB;
      458     4545
      459     4546             %FPT_READ(FPTN=READ_ROUTE,
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:93   
      460     4547                  DCB=M$ROUTE,
      461     4548                  KEY=NSAP_KEY,
      462     4549                  KEYS=YES,
      463     4550                  BUF=NSAP_BUF,
      464     4551                  STCLASS=STATIC);
      465     4590
      466     4591             %FPT_PRECORD(FPTN=PRECORD_ROUTE,
      467     4592                   KEYS=YES,
      468     4593                   KEYR=YES,
      469     4594                   KEY=NSAP_KEY,
      470     4595                   DCB=M$ROUTE,
      471     4596                   N=1,
      472     4597                   STCLASS=STATIC);
      473     4618             %FPT_PRECORD(FPTN=KL_PR_NETWORK,STCLASS=SYMREF);
      474     4639             %FPT_READ(FPTN=KL_RD_NETWORK,STCLASS=SYMREF);
      475     4678        /*
      476     4679             auto
      477     4680        */
      478     4681             %KL_NSAP_KEY(FPTN=NSAP_KEY,STCLASS=STATIC,ALGN=DALIGNED);
      479     4700
      480     4701             %KL_UPDOSI(FPTN=NSAP_BUF,STCLASS=STATIC);
      481     4910             %KL_UPDOSI(FPTN=UPDOSI,STCLASS="REDEF NSAP_BUF");
      482     5119
      483     5120             %KL_OSILINK_REC(FPTN=OSILINK_REC,STCLASS=AUTO);
      484     5168             %KL_OSILINKCHG(FPTN=OSILINKCHG,STCLASS=AUTO);
      485     5291             %KL_LINE_KEY(FPTN=OSILINK_KEY,STCLASS=AUTO);
      486     5341        %B$CGAURD (FPTN=BF);
      487     5360    1   DCL NODE# UBIN;
      488     5361        /*
      489     5362          if the :routes file is not already open, try to open it.
      490     5363          if it can't be opened dont worry about it.
      491     5364        */
      492     5365
      493     5366    1        NSAP_BUF = '0'B;

   5366  5 000002   000000 100400                    MLR     fill='000'O
         5 000003   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:94   
         5 000004   000034 000074 4                  ADSC9   NSAP_BUF                 cn=0,n=60

      494     5367    2        IF KL_ROUTEOPEN = 0 THEN DO;

   5367  5 000005   000000 235000 xsym               LDA     KL_ROUTEOPEN
         5 000006   000014 601000 5                  TNZ     s:5373

      495     5368    2             CALL KLH$OPFILS_ROUTE;

   5368  5 000007   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000010   000000 701000 xent               TSX1    KLH$OPFILS_ROUTE
         5 000011   000000 011000                    NOP     0

      496     5369    2             IF KL_ROUTEOPEN = 0 THEN      /* could not open :routes */

   5369  5 000012   000000 235000 xsym               LDA     KL_ROUTEOPEN
         5 000013   000060 600000 5                  TZE     SEND_SNPA

      497     5370    2                  GOTO SEND_SNPA;          /* no routes */
      498     5371    2           END;

      499     5372
      500     5373    1        PRECORD_ROUTE.V.N# = 0;

   5373  5 000014   000025 450000 4                  STZ     PRECORD_ROUTE+7

      501     5374    1        NSAP_KEY = '0'B;

   5374  5 000015   000000 100400                    MLR     fill='000'O
         5 000016   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000017   000030 000011 4                  ADSC9   NSAP_KEY                 cn=0,n=9

      502     5375    1        NSAP_KEY.CNT = NSAP_KEY_C.CNT;

   5375  5 000020   000000 236000 2                  LDQ     NSAP_KEY_C
         5 000021   000030 552040 4                  STBQ    NSAP_KEY,'40'O

PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:95   
      503     5376    2        CALL M$PRECORD(PRECORD_ROUTE) WHENALTRETURN DO;

   5376  5 000022   000016 630400 4                  EPPR0   PRECORD_ROUTE
         5 000023   440003 713400                    CLIMB   alt,+16387
         5 000024   401000 401760                    pmme    nvectors=3
         5 000025   000027 702000 5                  TSX2    s:5379
         5 000026   000027 710000 5                  TRA     s:5379

      504     5377               /* expected*/
      505     5378    2           END;

      506     5379    1        PRECORD_ROUTE.V.N# = 1;

   5379  5 000027   000001 235007                    LDA     1,DL
         5 000030   000025 755000 4                  STA     PRECORD_ROUTE+7

      507     5380
      508     5381        /*
      509     5382          read the nsap records.  function and type are all ready set just forward
      510     5383          to the specified node.
      511     5384        */
      512     5385
      513     5386    2        DO WHILE ('1'B);

      514     5387    3             CALL M$READ(READ_ROUTE) WHENALTRETURN DO;

   5387  5 000031   000000 630400 4                  EPPR0   READ_ROUTE
         5 000032   440000 713400                    CLIMB   alt,read
         5 000033   401400 401760                    pmme    nvectors=4
         5 000034   000036 702000 5                  TSX2    s:5388
         5 000035   000037 710000 5                  TRA     s:5390

      515     5388    3                  GOTO SEND_SNPA;

   5388  5 000036   000060 710000 5                  TRA     SEND_SNPA

      516     5389    3                END;
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:96   
      517     5390    2             CALL KLX$WRHLPNODE(NSAP_BUF,SIZEC(NSAP_BUF),NODE#);

   5390  5 000037   200003 236100                    LDQ     @NODE#,,AUTO
         5 000040   200026 756100                    STQ     OSILINK_KEY+7,,AUTO
         5 000041   000002 237000 6                  LDAQ    2
         5 000042   200024 757100                    STAQ    OSILINK_KEY+5,,AUTO
         5 000043   200024 630500                    EPPR0   OSILINK_KEY+5,,AUTO
         5 000044   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000045   000000 701000 xent               TSX1    KLX$WRHLPNODE
         5 000046   000000 011000                    NOP     0

      518     5391    3             CALL M$PRECORD(PRECORD_ROUTE) WHENALTRETURN DO;

   5391  5 000047   000016 630400 4                  EPPR0   PRECORD_ROUTE
         5 000050   440003 713400                    CLIMB   alt,+16387
         5 000051   401000 401760                    pmme    nvectors=3
         5 000052   000054 702000 5                  TSX2    s:5392
         5 000053   000055 710000 5                  TRA     s:5394

      519     5392    3                  GOTO SEND_SNPA;

   5392  5 000054   000060 710000 5                  TRA     SEND_SNPA

      520     5393    3                END;
      521     5394    2           END;                            /* do while */

   5394  5 000055   000031 710000 5                  TRA     s:5387

      522     5395
      523     5396    1   KLI$GETSNPA: ENTRY(NODE#);

   5396  5 000056   000000 700200 xent  KLI$GETSNPA  TSX0  ! X66_AUTO_1
         5 000057   000030 000001                    ZERO    24,1

   5387  5 000060                       SEND_SNPA    null
      524     5397    1   SEND_SNPA:;
      525     5398    1        OSILINK_KEY = '0'B;
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:97   

   5398  5 000060   000100 100400                    MLR     fill='000'O
         5 000061   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000062   200017 000023                    ADSC9   OSILINK_KEY,,AUTO        cn=0,n=19

      526     5399    1        OSILINK_KEY.SIZE = LENGTHC(OSILINK_KEY.KEY);

   5399  5 000063   022000 236003                    LDQ     9216,DU
         5 000064   200017 552140                    STBQ    OSILINK_KEY,'40'O,AUTO

      527     5400    1        OSILINK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_OSILINK;

   5400  5 000065   000002 236003                    LDQ     2,DU
         5 000066   200017 552120                    STBQ    OSILINK_KEY,'20'O,AUTO

      528     5401    1        KL_PR_NETWORK.KEY_ = VECTOR(OSILINK_KEY);

   5401  5 000067   000001 235000 6                  LDA     1
         5 000070   200024 452500                    STP2    OSILINK_KEY+5,,AUTO
         5 000071   200024 236100                    LDQ     OSILINK_KEY+5,,AUTO
         5 000072   000017 036003                    ADLQ    15,DU
         5 000073   000002 757000 xsym               STAQ    KL_PR_NETWORK+2

      529     5402    1        KL_RD_NETWORK.KEY_ = VECTOR(OSILINK_KEY);

   5402  5 000074   000001 235000 6                  LDA     1
         5 000075   200024 452500                    STP2    OSILINK_KEY+5,,AUTO
         5 000076   200024 236100                    LDQ     OSILINK_KEY+5,,AUTO
         5 000077   000017 036003                    ADLQ    15,DU
         5 000100   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

      530     5403    1        KL_RD_NETWORK.BUF_ = VECTOR(OSILINK_REC);

   5403  5 000101   000004 235000 6                  LDA     4
         5 000102   200024 452500                    STP2    OSILINK_KEY+5,,AUTO
         5 000103   200024 236100                    LDQ     OSILINK_KEY+5,,AUTO
         5 000104   000004 036003                    ADLQ    4,DU
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:98   
         5 000105   000004 757000 xsym               STAQ    KL_RD_NETWORK+4

      531     5404    2        CALL M$PRECORD(KL_PR_NETWORK) WHENALTRETURN DO;

   5404  5 000106   000000 630400 xsym               EPPR0   KL_PR_NETWORK
         5 000107   440003 713400                    CLIMB   alt,+16387
         5 000110   401000 401760                    pmme    nvectors=3
         5 000111   000113 702000 5                  TSX2    s:5407
         5 000112   000113 710000 5                  TRA     s:5407

      532     5405             /* expected */
      533     5406    2           END;

      534     5407    1        OSILINKCHG.MYNODE# = KL_NODE;

   5407  5 000113   000000 236000 xsym               LDQ     KL_NODE
         5 000114   000011 736000                    QLS     9
         5 000115   200007 552110                    STBQ    OSILINKCHG,'10'O,AUTO

      535     5408    1        OSILINKCHG.FCN = IGA_OSILINKCHG_DF; /* _DF is dont forward */

   5408  5 000116   133000 236003                    LDQ     46592,DU
         5 000117   200007 552140                    STBQ    OSILINKCHG,'40'O,AUTO

      536     5409    1        OSILINKCHG.TYPE = IGA_OSILINKUP;

   5409  5 000120   000130 236003                    LDQ     88,DU
         5 000121   200007 552120                    STBQ    OSILINKCHG,'20'O,AUTO

      537     5410
      538     5411    2        DO WHILE ('1'B);

      539     5412    3             CALL M$READ(KL_RD_NETWORK) WHENALTRETURN DO;

   5412  5 000122   000000 630400 xsym               EPPR0   KL_RD_NETWORK
         5 000123   440000 713400                    CLIMB   alt,read
         5 000124   401400 401760                    pmme    nvectors=4
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:99   
         5 000125   000127 702000 5                  TSX2    s:5414
         5 000126   000130 710000 5                  TRA     s:5416

      540     5413                /* not expected */
      541     5414    3                  GOTO RESTOR_RET;

   5414  5 000127   000177 710000 5                  TRA     RESTOR_RET

      542     5415    3                END;
      543     5416    2             IF OSILINK_KEY.KEY.KEYTYP ~= %KL_NETWORK_KEYTYP_OSILINK THEN

   5416  5 000130   200017 236100                    LDQ     OSILINK_KEY,,AUTO
         5 000131   000777 376003                    ANQ     511,DU
         5 000132   000002 116003                    CMPQ    2,DU
         5 000133   000177 601000 5                  TNZ     RESTOR_RET

      544     5417    2                  GOTO RESTOR_RET;
      545     5418
      546     5419    3             IF OSILINK_KEY.KEY.NODE ~= NODE# THEN DO;

   5419  5 000134   200003 470500                    LDP0    @NODE#,,AUTO
         5 000135   200017 236100                    LDQ     OSILINK_KEY,,AUTO
         5 000136   000011 772000                    QRL     9
         5 000137   000777 376007                    ANQ     511,DL
         5 000140   000000 116100                    CMPQ    0,,PR0
         5 000141   000170 600000 5                  TZE     s:5426

      547     5420    3                  OSILINKCHG.NODE# = OSILINK_KEY.KEY.NODE;

   5420  5 000142   200017 236100                    LDQ     OSILINK_KEY,,AUTO
         5 000143   000011 772000                    QRL     9
         5 000144   200007 552104                    STBQ    OSILINKCHG,'04'O,AUTO

      548     5421    3                  OSILINKCHG.SNPA = OSILINK_REC.SNPA;

   5421  5 000145   200004 237100                    LDAQ    OSILINK_REC,,AUTO
         5 000146   200011 755100                    STA     OSILINKCHG+2,,AUTO
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:100  
         5 000147   200012 756100                    STQ     OSILINKCHG+3,,AUTO

      549     5422    3                  IF (SUBSTR(ADDR(KL_RDBF)->BF.STATION,0,4) ~= 'FEPA') THEN RETURN;

   5422  5 000150   000001 236000 xsym               LDQ     KL_RDBF+1
         5 000151   000004 116000 2                  CMPQ    NSAP_KEY_C+4
         5 000152   000154 600000 5                  TZE     s:5423

   5422  5 000153   000000 702200 xent               TSX2  ! X66_ARET

      550     5423    3                  OSILINKCHG.QOS = OSILINK_REC.QOS;

   5423  5 000154   200006 236100                    LDQ     OSILINK_REC+2,,AUTO
         5 000155   200010 552140                    STBQ    OSILINKCHG+1,'40'O,AUTO

      551     5424    3                  CALL KLX$WRHLPNODE(OSILINKCHG,SIZEC(OSILINKCHG),NODE#);

   5424  5 000156   200003 236100                    LDQ     @NODE#,,AUTO
         5 000157   200026 756100                    STQ     OSILINK_KEY+7,,AUTO
         5 000160   000006 236000 6                  LDQ     6
         5 000161   200025 756100                    STQ     OSILINK_KEY+6,,AUTO
         5 000162   200007 631500                    EPPR1   OSILINKCHG,,AUTO
         5 000163   200024 451500                    STP1    OSILINK_KEY+5,,AUTO
         5 000164   200024 630500                    EPPR0   OSILINK_KEY+5,,AUTO
         5 000165   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000166   000000 701000 xent               TSX1    KLX$WRHLPNODE
         5 000167   000000 011000                    NOP     0

      552     5425    3                END;

      553     5426    3             CALL M$PRECORD(KL_PR_NETWORK) WHENALTRETURN DO;

   5426  5 000170   000000 630400 xsym               EPPR0   KL_PR_NETWORK
         5 000171   440003 713400                    CLIMB   alt,+16387
         5 000172   401000 401760                    pmme    nvectors=3
         5 000173   000175 702000 5                  TSX2    s:5427
         5 000174   000176 710000 5                  TRA     s:5429
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:101  

      554     5427    3                  GOTO RESTOR_RET;

   5427  5 000175   000177 710000 5                  TRA     RESTOR_RET

      555     5428    3                END;
      556     5429    2           END;

   5429  5 000176   000122 710000 5                  TRA     s:5412

   5426  5 000177                       RESTOR_RET   null
      557     5430
      558     5431    1   RESTOR_RET:;                  /* restore RD_NETWORK.BUF_ and .KEY_ and return */
      559     5432    1        KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

   5432  5 000177   000010 237000 6                  LDAQ    8
         5 000200   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

      560     5433    1        KL_RD_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);

   5433  5 000201   000012 237000 6                  LDAQ    10
         5 000202   000004 757000 xsym               STAQ    KL_RD_NETWORK+4

      561     5434    1        KL_PR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

   5434  5 000203   000010 237000 6                  LDAQ    8
         5 000204   000002 757000 xsym               STAQ    KL_PR_NETWORK+2

      562     5435    1   END KLI$GETOSIROUTES;

   5435  5 000205   000000 702200 xent               TSX2  ! X66_ARET
      563     5436        %EOD;

PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:102  
--  Include file information  --

   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$GETOSIROUTES.
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:103  

 **** Variables and constants ****

  ****  Section 002 RoData KLI$GETOSIROUTES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(81)    r     1 NSAP_KEY_C

  ****  Section 004  Data  KLI$GETOSIROUTES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    34-0-0/w STRC(540)   r     1 NSAP_BUF                  30-0-0/d STRC(81)    r     1 NSAP_KEY
    16-0-0/d STRC(360)   r     1 PRECORD_ROUTE              0-0-0/d STRC(504)   r     1 READ_ROUTE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @NODE#                    *0-0-0/w UBIN        r     1 NODE#
     7-0-0/w STRC(288)   r     1 OSILINKCHG                17-0-0/w STRC(171)   r     1 OSILINK_KEY
     4-0-0/w STRC(81)    r     1 OSILINK_REC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(711)   r     1 KL_NETWORK_BUF             0-0-0/w STRC(171)   r     1 KL_NETWORK_KEY
     0-0-0/w UBIN        r     1 KL_NODE                    0-0-0/d STRC(360)   r     1 KL_PR_NETWORK
     0-0-0/w STRC(1260)  r     1 KL_RDBF                    0-0-0/d STRC(504)   r     1 KL_RD_NETWORK
     0-0-0/w UBIN        r     1 KL_ROUTEOPEN

  ****  BASED and DCB variables  ****
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:104  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 BF                         0-0-0N  NULL        r     1 M$ROUTE


   Procedure KLI$GETOSIROUTES requires 134 words for executable code.
   Procedure KLI$GETOSIROUTES requires 24 words of local(AUTO) storage.
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:105  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:106  
          MINI XREF LISTING

BF.STATION
      5357**DCL      5357--REDEF    5422>>IF
KLH$OPFILS_ROUTE
      4518**DCL-ENT  5368--CALL
KLX$WRHLPNODE
      4519**DCL-ENT  5390--CALL     5424--CALL
KL_AUTOFAIL.FLAGS
      4357**DCL      4358--REDEF
KL_AUTOFAIL.MSGID
      4353**DCL      4354--REDEF
KL_AUTOFAIL.WSN
      4360**DCL      4361--REDEF
KL_FEMSG.FLAGS
      4307**DCL      4308--REDEF
KL_FEMSG.MSGID
      4303**DCL      4304--REDEF
KL_FEMSG.WSN
      4310**DCL      4311--REDEF
KL_NETWORK_BUF
      4471**DCL      5433--ASSIGN
KL_NETWORK_BUF.TERMINAL_ID.TERM
      4497**DCL      4506--REDEF
KL_NETWORK_KEY
      4400**DCL      5432--ASSIGN   5434--ASSIGN
KL_NETWORK_KEY.KEY.TERMID.TERM
      4423**DCL      4432--REDEF
KL_NODE
      4288**DCL      5407>>ASSIGN
KL_PR_NETWORK
      4629**DCL      5404<>CALL     5426<>CALL
KL_PR_NETWORK.KEY_
      4629**DCL      5401<<ASSIGN   5434<<ASSIGN
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:107  
KL_RDBF
      4263**DCL      5422--IF
KL_RDBF.FEL#
      4266**DCL      4267--REDEF
KL_RD_NETWORK
      4656**DCL      5412<>CALL
KL_RD_NETWORK.BUF_
      4658**DCL      5403<<ASSIGN   5433<<ASSIGN
KL_RD_NETWORK.KEY_
      4656**DCL      5402<<ASSIGN   5432<<ASSIGN
KL_RD_NETWORK.STATION_
      4659**DCL      4660--REDEF
KL_RD_NETWORK.V.DVBYTE.REREAD#
      4671**DCL      4671--REDEF
KL_RD_NETWORK.V.INDX#
      4669**DCL      4669--REDEF
KL_ROUTEOPEN
      4257**DCL      5367>>IF       5369>>IF
KL_TMSG.FLAGS
      4329**DCL      4330--REDEF
KL_TMSG.MSGID
      4325**DCL      4326--REDEF
KL_TMSG.WSN
      4332**DCL      4333--REDEF
M$PRECORD
        29**DCL-ENT  5376--CALL     5391--CALL     5404--CALL     5426--CALL
M$READ
        26**DCL-ENT  5387--CALL     5412--CALL
NODE#
      5360**DCL        14--PROC     5390<>CALL     5396--ENTRY    5419>>IF       5424<>CALL
NSAP_BUF
      4718**DCL      4570--DCLINIT  4571--DCLINIT  4927--REDEF    5366<<ASSIGN   5390<>CALL     5390--CALL
NSAP_BUF.LNSAP.ADDRESS_N
      4872**DCL      4873--REDEF
NSAP_BUF.MYNODE#
      4753**DCL      4755--REDEF
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:108  
NSAP_BUF.NODE#
      4756**DCL      4758--REDEF
NSAP_BUF.NSAP.ADDRESS_N
      4816**DCL      4817--REDEF
NSAP_KEY
      4696**DCL      4568--DCLINIT  4569--DCLINIT  4608--DCLINIT  4609--DCLINIT  5374<<ASSIGN
NSAP_KEY.CNT
      4697**DCL      5375<<ASSIGN
NSAP_KEY.NSAPNAME
      4698**DCL      4697--DCLINIT
NSAP_KEY_C.CNT
      4540**DCL      5375>>ASSIGN
NSAP_KEY_C.NSAPNAME
      4541**DCL      4540--DCLINIT
OSILINKCHG
      5185**DCL      5424<>CALL     5424--CALL
OSILINKCHG.FCN
      5196**DCL      5408<<ASSIGN
OSILINKCHG.MYNODE#
      5216**DCL      5407<<ASSIGN
OSILINKCHG.NODE#
      5218**DCL      5420<<ASSIGN
OSILINKCHG.QOS
      5220**DCL      5423<<ASSIGN
OSILINKCHG.SNPA
      5246**DCL      5421<<ASSIGN
OSILINKCHG.TERMID.TERM
      5277**DCL      5286--REDEF
OSILINKCHG.TYPE
      5207**DCL      5409<<ASSIGN
OSILINK_KEY
      5306**DCL      5398<<ASSIGN   5401--ASSIGN   5402--ASSIGN
OSILINK_KEY.KEY
      5308**DCL      5399--ASSIGN
OSILINK_KEY.KEY.KEYTYP
      5309**DCL      5400<<ASSIGN   5416>>IF
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:109  
OSILINK_KEY.KEY.NODE
      5310**DCL      5419>>IF       5420>>ASSIGN
OSILINK_KEY.KEY.TERMID.TERM
      5329**DCL      5338--REDEF
OSILINK_KEY.SIZE
      5307**DCL      5399<<ASSIGN
OSILINK_REC
      5135**DCL      5403--ASSIGN
OSILINK_REC.QOS
      5166**DCL      5423>>ASSIGN
OSILINK_REC.SNPA
      5154**DCL      5421>>ASSIGN
PRECORD_ROUTE
      4608**DCL      5376<>CALL     5391<>CALL
PRECORD_ROUTE.V
      4610**DCL      4608--DCLINIT
PRECORD_ROUTE.V.N#
      4614**DCL      5373<<ASSIGN   5379<<ASSIGN
READ_ROUTE
      4568**DCL      5387<>CALL
READ_ROUTE.STATION_
      4571**DCL      4572--REDEF
READ_ROUTE.V
      4572**DCL      4568--DCLINIT
READ_ROUTE.V.DVBYTE.REREAD#
      4583**DCL      4583--REDEF
READ_ROUTE.V.INDX#
      4581**DCL      4581--REDEF
RESTOR_RET
      5426**LABEL    5414--GOTO     5417--GOTO     5427--GOTO
SEND_SNPA
      5387**LABEL    5370--GOTO     5388--GOTO     5392--GOTO
UPDOSI.LNSAP.ADDRESS_N
      5081**DCL      5082--REDEF
UPDOSI.MYNODE#
      4962**DCL      4964--REDEF
PL6.E3A0      #003=KLI$GETOSIROUTES File=KLI$FESET.:E05TSI                       WED 07/30/97 00:51 Page:110  
UPDOSI.NODE#
      4965**DCL      4967--REDEF
UPDOSI.NSAP.ADDRESS_N
      5025**DCL      5026--REDEF

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:111  
      564        1        /*T***********************************************************/
      565        2        /*T*                                                         */
      566        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      567        4        /*T*                                                         */
      568        5        /*T***********************************************************/
      569        6        /**/
      570        7        /**/
      571        8        KLI$FEGO: PROC (FEX);
      572        9        /**/
      573       10        /**/
      574       11        %INCLUDE KL_AFCN_C;
      575      112        %INCLUDE KL_ERRORS_C;
      576      154        %INCLUDE KL_MACRO_C;
      577     3506        %INCLUDE CP_6;
      578     3587        %INCLUDE KL_DATA_R;
      579     4051        %INCLUDE KL_CONFIG_M;
      580     4813        /**/
      581     4814        /**/
      582     4815    1   DCL FEX UBIN WORD;
      583     4816    1   DCL 1 VTXTC BASED ALIGNED,
      584     4817    1            2 C UBIN BYTE UNAL,
      585     4818    1            2 T CHAR(VTXTC.C);
      586     4819    1   DCL KL_BROADSZ UBIN WORD STATIC SYMDEF INIT(0);
      587     4820    1   DCL  UTSBUF UBIN STATIC;
      588     4821    1   DCL FUTS UBIN(36);
      589     4822    1   DCL SIZE UBIN;
      590     4823        %KL_SGNRSP(FPTN=SGNRSP,STCLASS=AUTO,RSPSIZ=80);
      591     4958        %KL_SETNODE(FPTN=SETNODE,STCLASS=STATIC,FCN=IGA_NODETBL);
      592     5004        %KL$NETWORK_KEY (STCLASS=CONSTANT);
      593     5021        %KL$NETWORK (STCLASS="BASED(KL_EXTRSP_BUF$)");
      594     5048    1   DCL ERR UBIN;
      595     5049    1   DCL KLH$SGNTXT ENTRY(2);
      596     5050    1   DCL I UBIN;
      597     5051    1   DCL KLX$9TO8 ENTRY(3);
      598     5052    1   DCL KLH$ERRMSG ENTRY(3);
      599     5053    1   DCL KLI$GETROUTES ENTRY;
      600     5054    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:112  
      601     5055    1   DCL KLI$GETOSIROUTES ENTRY(1);
      602     5056    1   DCL KLI$GETFEPERA ENTRY(2);
      603     5057        /**/
      604     5058        /**/
      605     5059        %KL$ADMES (NAME=SALUTE,CODE=IGA_SSAL,STCLASS=CONSTANT,
      606     5060                   MSG=' ***CP-6 AT YOUR SERVICE! ');
      607     5066        %KL$ADMES (NAME=GO,CODE=IGA_GO,MSG='    ',STCLASS=CONSTANT);
      608     5072        %VLP_ERRCODE (FPTN=ERR_HDM,FCG=KL,MID=I,MON='1'B,ERR#=%E$HOSTDWNMSG,SEV=0,STCLASS=
              5072            CONSTANT);
      609     5117        /*E* ERROR: KLI-E$HOSTDWNMSG-0
      610     5118              MESSAGE: ** Host recovery in progress - Please stand by **
      611     5119         */
      612     5120        %VLP_ERRCODE (FPTN=ERR_LDM,FCG=KL,MID=I,MON='1'B,ERR#=%E$LINKDWNMSG,SEV=0,STCLASS=
              5120            CONSTANT);
      613     5165        /*E* ERROR: KLI-E$LINKDWNMSG-0
      614     5166              MESSAGE: ** Link recovery in progress - Please stand by **
      615     5167         */
      616     5168        %VLP_ERRCODE (FPTN=ERR_LPRMPT,FCG=KL,MID=I,MON='1'B,ERR#=%E$LOGONPRMT,SEV=0,STCLASS=
              5168            CONSTANT);
      617     5213        /*E* ERROR: KLI-E$LOGONPRMT-0
      618     5214             MESSAGE:Logon Please:
      619     5215         */
      620     5216        %VLP_ERRCODE (FPTN=ERR_HOSTRESUMED,FCG=KL,MID=I,MON='1'B,ERR#=%E$HOSTRESUMED,SEV=0,
              5216            STCLASS=CONSTANT);
      621     5261        /*E* ERROR: KLI-E$HOSTRESUMED-0
      622     5262             MESSAGE:*** Host service has been resumed ***
      623     5263         */
      624     5264        %VLP_ERRCODE (FPTN=ERR_LGNTIMEDOUT,FCG=KL,MID=I,MON='1'B,ERR#=%E$LGNTIMEDOUT,SEV=0,
              5264            STCLASS=CONSTANT);
      625     5309        /*E* ERROR: KLI-E$LGNTIMEDOUT-0
      626     5310             MESSAGE:Logon timed out
      627     5311         */
      628     5312        %VLP_ERRCODE (FPTN=ERR_NOLOGONMSG,FCG=KL,MID=I,MON='1'B,ERR#=%E$NOLOGONMSG,SEV=0,
              5312            STCLASS=CONSTANT);
      629     5357        /*E* ERROR: KLI-E$NOLOGONMSG-0
      630     5358             MESSAGE:Sorry, unable to log you on.
      631     5359         */
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:113  
      632     5360        %VLP_ERRCODE (FPTN=ERR_HOSTNA,FCG=KL,MID=I,MON='1'B,ERR#=%E$NOHOST,SEV=0,STCLASS=
              5360            CONSTANT);
      633     5405        /*E* ERROR: KLI-E$NOHOST-0
      634     5406             MESSAGE: That host is currently not available.
      635     5407        */
      636     5408        %KL$ADMES (NAME=FEPW,CODE=IGA_SSPW,MSG='88888888',STCLASS=STATIC);
      637     5414        %KL_ADMES (NAME=USAL,STCLASS=STATIC,CODE=IGA_SSAL);
      638     5420        %KL_ADMES (NAME=KL_HDRMSG,STCLASS="STATIC SYMDEF",CODE=IGA_HDR,TYP=IGAT_SEND);
      639     5426        %KL_NODEINFO(FPTN=NODEINFO,STCLASS=STATIC,NODETYPE=HOST);
      640     5450        %KL_TIME (FPTN=TIME,STCLASS=STATIC);
      641     5474        /**/
      642     5475        /**/
      643     5476        %FPT_READ (FPTN=KL_RD_NETCON,STCLASS=SYMREF);
      644     5515    1   DCL KL_STATION CHAR(8) SYMREF;
      645     5516        %FPT_ACTIVATE (FPTN=FEACT,STCLASS=CONSTANT,DCB=M$HLP,STATION=KL_STATION);
      646     5539        %FPT_MONINFO (FPTN=GSAL,STCLASS=CONSTANT,SITEINFO=MSAL);
      647     5554        %VLR_SITEINFO (FPTN=MSAL,STCLASS=STATIC);
      648     5573        %FPT_TIME (SOURCE=CLOCK,TSTAMP=UTSBUF);
      649     5592        /**/
      650     5593        /**/
      651     5594    1        CALL M$ACTIVATE(FEACT)
      652     5595    2        WHENALTRETURN DO;
      653     5596    2             RETURN;
      654     5597    2           END;
      655     5598    1        IF KL_FETBL.BOSS(FEX)
      656     5599    2        THEN DO;
      657     5600    2             USAL.CODE_ = IGA_SSAL;
      658     5601    2             CALL M$MONINFO (GSAL) ALTRET (STDSAL);
      659     5602    2             USAL.MSG_=ADDR(MSAL.SALUTATION#)->VTXTC.T;
      660     5603    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL),FEX);
      661     5604    2   WRSAL:    ;
      662     5605    2             SIZE = SIZEC(USAL.MSG_);
      663     5606    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_HDM);
      664     5607    2             USAL.CODE_ = IGA_SHDM;
      665     5608    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);
      666     5609    2             SIZE = SIZEC(USAL.MSG_);
      667     5610    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_LDM);
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:114  
      668     5611    2             USAL.CODE_ = IGA_LNKDWNMSG;
      669     5612    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);
      670     5613    2             SIZE = SIZEC(USAL.MSG_);
      671     5614    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_LPRMPT);
      672     5615    2             USAL.CODE_ = IGA_LGNPRMPT;
      673     5616    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);
      674     5617    2             SIZE = SIZEC(USAL.MSG_);
      675     5618    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_HOSTRESUMED);
      676     5619    2             USAL.CODE_ = IGA_HOSTRESUMED;
      677     5620    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);
      678     5621    2             SIZE = SIZEC(USAL.MSG_);
      679     5622    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_LGNTIMEDOUT);
      680     5623    2             USAL.CODE_ = IGA_LGNTIMEDOUT;
      681     5624    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);
      682     5625    2             SIZE = SIZEC(USAL.MSG_);
      683     5626    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_NOLOGONMSG);
      684     5627    2             USAL.CODE_ = IGA_NOLOGONMSG;
      685     5628    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);
      686     5629    2             SIZE = SIZEC(USAL.MSG_);
      687     5630    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_HOSTNA);
      688     5631    2             USAL.CODE_ = IGA_HOSTNA;
      689     5632    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);
      690     5633
      691     5634    2             ERR = %E$SGSYN;
      692     5635    2             CALL KLH$SGNTXT(SGNRSP,ERR);
      693     5636    2             USAL.CODE_ = IGA_SGSYN;
      694     5637    2             USAL.MSG_ = SGNRSP.MESSAGE.RSPTXT;
      695     5638    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SGNRSP.MESSAGE.RSPSIZ
              5638                      ,FEX);
      696     5639    2             ERR = %E$UDHOST;
      697     5640    2             CALL KLH$SGNTXT(SGNRSP,ERR);
      698     5641    2             USAL.CODE_ = IGA_UDHOST;
      699     5642    2             USAL.MSG_ = SGNRSP.MESSAGE.RSPTXT;
      700     5643    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SGNRSP.MESSAGE.RSPSIZ
              5643                      ,FEX);
      701     5644    2             ERR = %E$BDID;
      702     5645    2             CALL KLH$SGNTXT(SGNRSP,ERR);
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:115  
      703     5646    2             USAL.CODE_ = IGA_BDID;
      704     5647    2             USAL.MSG_ = SGNRSP.MESSAGE.RSPTXT;
      705     5648    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SGNRSP.MESSAGE.RSPSIZ
              5648                      ,FEX);
      706     5649    2             SETNODE.FCN = IGA_NODETBL;
      707     5650    2             KL_NETWORK_VALID = '0'B;
      708     5651    2             KL_RD_NETCON.BUF_ = VECTOR(KL_EXTRSP_BUF);
      709     5652    2             KL_RD_NETCON.KEY_ = VECTOR(KL$NETWORK_KEY);
      710     5653    2             CALL M$READ (KL_RD_NETCON)
      711     5654    3             WHENRETURN DO;
      712     5655    4                  DO I = 0 TO KL$NETWORK.NODE#;
      713     5656    4                       SETNODE.NODE# = I;
      714     5657    4                       SETNODE.NODE_NAME = KL$NETWORK.NODE.NODE(I);
      715     5658    4                       SETNODE.MY_NODE = '0'B;
      716     5659    5                       DO CASE (KL$NETWORK.NODE.TYPE(I));
      717     5660
      718     5661    5                       CASE (%KL_NODETYPE_HOST,%KL_NODETYPE_ME);
      719     5662    5                          SETNODE.HOST_NODE = '1'B;
      720     5663
      721     5664    5                       CASE (%KL_NODETYPE_FEP,%KL_NODETYPE_DEBUG);
      722     5665    5                          SETNODE.HOST_NODE = '0'B;
      723     5666
      724     5667    5                       CASE (%KL_NODETYPE_UNDEF);
      725     5668    5                          SETNODE.NODE_NAME = ' ';
      726     5669
      727     5670    5                       END;
      728     5671    4                       IF KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_HOST OR
      729     5672    4                            KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_ME THEN
      730     5673    4                            CALL KLX$WRHLPNODE(SETNODE,SIZEC(SETNODE),FEX);
      731     5674    4                     END;
      732     5675    3                END;                       /* end whenreturn*/
      733     5676    3             WHENALTRETURN DO;
      734     5677    3                  SETNODE.INVALID = '1'B;
      735     5678    3                  CALL KLX$WRHLPNODE(SETNODE,SIZEC(SETNODE),FEX);
      736     5679    3                END;
      737     5680    2             CALL KLI$GETOSIROUTES(FEX);
      738     5681    2             CALL KLX$WRHLPNODE(FEPW,SIZEC(FEPW),FEX);
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:116  
      739     5682    2             CALL KLX$WRHLPNODE(KL_HDRMSG,KL_BROADSZ+LENGTHC(KL_HDRMSG)-LENGTHC(
              5682                      KL_HDRMSG.MSG_),FEX);
      740     5683    2           END;
      741     5684    1        NODEINFO.MYNODE = KL_NODE;
      742     5685    1        NODEINFO.MYNAME = KL_NODENAME;
      743     5686    1        IF KL_FETBL.BOSS(FEX)
      744     5687    1        THEN
      745     5688    1             NODEINFO.BOSS = 1;
      746     5689    1        ELSE
      747     5690    1             NODEINFO.BOSS = 0;
      748     5691    1        CALL KLX$WRHLPNODE (NODEINFO,SIZEC(NODEINFO),FEX);
      749     5692    1        IF KL_FETBL.LINK_CONNECT(FEX) THEN
      750     5693    1             CALL KLI$GETROUTES;
      751     5694    1        IF KL_FETBL.BOSS(FEX) THEN
      752     5695    2        DO;
      753     5696    2             CALL M$TIME (FPT_TIME);
      754     5697                 /*
      755     5698                 **convert time to 1/25 uts
      756     5699                 **convert 1/25s uts to feputs
      757     5700                 */
      758     5701    2             CALL KLI$GETFEPERA(UTSBUF,FUTS);
      759     5702                 /*
      760     5703                 **move era bits(2,3) into 32 bit range.  reduces resolution
      761     5704                 **but avoids having to use two field to send value to fep.
      762     5705                 */
      763     5706    2             FUTS = (FUTS+2)/4;
      764     5707    2             CALL KLX$9TO8(FUTS,TIME.UTS,4);
      765     5708    2             CALL KLX$WRHLPNODE (TIME,SIZEC(TIME),FEX);
      766     5709    2             CALL KLX$WRHLPNODE (GO,SIZEC(GO),FEX);
      767     5710    2           END;
      768     5711    1   WDN: ;
      769     5712    1        RETURN;
      770     5713    1   STDSAL:;
      771     5714    1        CALL KLX$WRHLPNODE(SALUTE,SIZEC(SALUTE),FEX);
      772     5715    1        GOTO WRSAL;
      773     5716        /**/
      774     5717    1   END;
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:117  
      775     5718        /**/
      776     5719        /**/
      777     5720        %EOD;

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:118  
--  Include file information  --

   KL_CONFIG_M.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_ERRORS_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$FEGO.

   Procedure KLI$FEGO requires 498 words for executable code.
   Procedure KLI$FEGO requires 40 words of local(AUTO) storage.

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:119  

 Object Unit name= KLI$FEGO                                   File name= KLI$FESET.:E05TOU
 UTS= JUL 30 '97 00:51:45.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$HLP
    2   Data  even  none   152    230  KLI$FEGO
    3  RoData even  UTS     46     56  KLI$FEGO
    4   Proc  even  none   498    762  KLI$FEGO
    5  RoData even  none    38     46  KLI$FEGO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  KLI$FEGO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      0  KL_BROADSZ                         2     50  KL_HDRMSG
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:120  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 KLX$WRHLPNODE
         yes           Std       2 KLH$SGNTXT
         yes           Std       1 KLI$GETOSIROUTES
         yes           Std       0 KLI$GETROUTES
         yes           Std       3 KLH$ERRMSG
         yes           Std       3 KLX$9TO8
         yes           Std       2 KLI$GETFEPERA
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$HLP                                 KL_FETBL
     KL_NETWORK_VALID                      KL_NODENAME                           KL_NODE
     KL_EXTRSP_BUF                         KL_EXTRSP_BUF$                        KL_RD_NETCON
     KL_STATION                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:121  


      564        1        /*T***********************************************************/
      565        2        /*T*                                                         */
      566        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      567        4        /*T*                                                         */
      568        5        /*T***********************************************************/
      569        6        /**/
      570        7        /**/
      571        8        KLI$FEGO: PROC (FEX);

      8  4 000000   000000 700200 xent  KLI$FEGO     TSX0  ! X66_AUTO_1
         4 000001   000050 000001                    ZERO    40,1

      572        9        /**/
      573       10        /**/
      574       11        %INCLUDE KL_AFCN_C;
      575      112        %INCLUDE KL_ERRORS_C;
      576      154        %INCLUDE KL_MACRO_C;
      577     3506        %INCLUDE CP_6;
      578     3587        %INCLUDE KL_DATA_R;
      579     4051        %INCLUDE KL_CONFIG_M;
      580     4813        /**/
      581     4814        /**/
      582     4815    1   DCL FEX UBIN WORD;
      583     4816    1   DCL 1 VTXTC BASED ALIGNED,
      584     4817    1            2 C UBIN BYTE UNAL,
      585     4818    1            2 T CHAR(VTXTC.C);
      586     4819    1   DCL KL_BROADSZ UBIN WORD STATIC SYMDEF INIT(0);
      587     4820    1   DCL  UTSBUF UBIN STATIC;
      588     4821    1   DCL FUTS UBIN(36);
      589     4822    1   DCL SIZE UBIN;
      590     4823        %KL_SGNRSP(FPTN=SGNRSP,STCLASS=AUTO,RSPSIZ=80);
      591     4958        %KL_SETNODE(FPTN=SETNODE,STCLASS=STATIC,FCN=IGA_NODETBL);
      592     5004        %KL$NETWORK_KEY (STCLASS=CONSTANT);
      593     5021        %KL$NETWORK (STCLASS="BASED(KL_EXTRSP_BUF$)");
      594     5048    1   DCL ERR UBIN;
      595     5049    1   DCL KLH$SGNTXT ENTRY(2);
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:122  
      596     5050    1   DCL I UBIN;
      597     5051    1   DCL KLX$9TO8 ENTRY(3);
      598     5052    1   DCL KLH$ERRMSG ENTRY(3);
      599     5053    1   DCL KLI$GETROUTES ENTRY;
      600     5054    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
      601     5055    1   DCL KLI$GETOSIROUTES ENTRY(1);
      602     5056    1   DCL KLI$GETFEPERA ENTRY(2);
      603     5057        /**/
      604     5058        /**/
      605     5059        %KL$ADMES (NAME=SALUTE,CODE=IGA_SSAL,STCLASS=CONSTANT,
      606     5060                   MSG=' ***CP-6 AT YOUR SERVICE! ');
      607     5066        %KL$ADMES (NAME=GO,CODE=IGA_GO,MSG='    ',STCLASS=CONSTANT);
      608     5072        %VLP_ERRCODE (FPTN=ERR_HDM,FCG=KL,MID=I,MON='1'B,ERR#=%E$HOSTDWNMSG,SEV=0,STCLASS=
              5072            CONSTANT);
      609     5117        /*E* ERROR: KLI-E$HOSTDWNMSG-0
      610     5118              MESSAGE: ** Host recovery in progress - Please stand by **
      611     5119         */
      612     5120        %VLP_ERRCODE (FPTN=ERR_LDM,FCG=KL,MID=I,MON='1'B,ERR#=%E$LINKDWNMSG,SEV=0,STCLASS=
              5120            CONSTANT);
      613     5165        /*E* ERROR: KLI-E$LINKDWNMSG-0
      614     5166              MESSAGE: ** Link recovery in progress - Please stand by **
      615     5167         */
      616     5168       %VLP_ERRCODE (FPTN=ERR_LPRMPT,FCG=KL,MID=I,MON='1'B,ERR#=%E$LOGONPRMT,SEV=0,STCLASS=
              5168            CONSTANT);
      617     5213        /*E* ERROR: KLI-E$LOGONPRMT-0
      618     5214             MESSAGE:Logon Please:
      619     5215         */
      620     5216        %VLP_ERRCODE (FPTN=ERR_HOSTRESUMED,FCG=KL,MID=I,MON='1'B,ERR#=%E$HOSTRESUMED,SEV=0,
              5216            STCLASS=CONSTANT);
      621     5261        /*E* ERROR: KLI-E$HOSTRESUMED-0
      622     5262             MESSAGE:*** Host service has been resumed ***
      623     5263         */
      624     5264        %VLP_ERRCODE (FPTN=ERR_LGNTIMEDOUT,FCG=KL,MID=I,MON='1'B,ERR#=%E$LGNTIMEDOUT,SEV=0,
              5264            STCLASS=CONSTANT);
      625     5309        /*E* ERROR: KLI-E$LGNTIMEDOUT-0
      626     5310             MESSAGE:Logon timed out
      627     5311         */
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:123  
      628     5312        %VLP_ERRCODE (FPTN=ERR_NOLOGONMSG,FCG=KL,MID=I,MON='1'B,ERR#=%E$NOLOGONMSG,SEV=0,
              5312            STCLASS=CONSTANT);
      629     5357        /*E* ERROR: KLI-E$NOLOGONMSG-0
      630     5358             MESSAGE:Sorry, unable to log you on.
      631     5359         */
      632     5360        %VLP_ERRCODE (FPTN=ERR_HOSTNA,FCG=KL,MID=I,MON='1'B,ERR#=%E$NOHOST,SEV=0,STCLASS=
              5360            CONSTANT);
      633     5405        /*E* ERROR: KLI-E$NOHOST-0
      634     5406             MESSAGE: That host is currently not available.
      635     5407        */
      636     5408        %KL$ADMES (NAME=FEPW,CODE=IGA_SSPW,MSG='88888888',STCLASS=STATIC);
      637     5414        %KL_ADMES (NAME=USAL,STCLASS=STATIC,CODE=IGA_SSAL);
      638     5420        %KL_ADMES (NAME=KL_HDRMSG,STCLASS="STATIC SYMDEF",CODE=IGA_HDR,TYP=IGAT_SEND);
      639     5426        %KL_NODEINFO(FPTN=NODEINFO,STCLASS=STATIC,NODETYPE=HOST);
      640     5450        %KL_TIME (FPTN=TIME,STCLASS=STATIC);
      641     5474        /**/
      642     5475        /**/
      643     5476        %FPT_READ (FPTN=KL_RD_NETCON,STCLASS=SYMREF);
      644     5515    1   DCL KL_STATION CHAR(8) SYMREF;
      645     5516        %FPT_ACTIVATE (FPTN=FEACT,STCLASS=CONSTANT,DCB=M$HLP,STATION=KL_STATION);
      646     5539        %FPT_MONINFO (FPTN=GSAL,STCLASS=CONSTANT,SITEINFO=MSAL);
      647     5554        %VLR_SITEINFO (FPTN=MSAL,STCLASS=STATIC);
      648     5573        %FPT_TIME (SOURCE=CLOCK,TSTAMP=UTSBUF);
      649     5592        /**/
      650     5593        /**/
      651     5594    1        CALL M$ACTIVATE(FEACT)

   5594  4 000002   000022 630400 3                  EPPR0   FEACT
         4 000003   500000 713400                    CLIMB   alt,+32768
         4 000004   401400 401760                    pmme    nvectors=4
         4 000005   000007 702000 4                  TSX2    s:5596
         4 000006   000010 710000 4                  TRA     s:5598

      652     5595    2        WHENALTRETURN DO;

      653     5596    2             RETURN;

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:124  
   5596  4 000007   000000 702200 xent               TSX2  ! X66_ARET

      654     5597    2           END;
      655     5598    1        IF KL_FETBL.BOSS(FEX)

   5598  4 000010   200003 470500                    LDP0    @FEX,,AUTO
         4 000011   000000 720100                    LXL0    0,,PR0
         4 000012   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000013   040000 316003                    CANQ    16384,DU
         4 000014   000632 600000 4                  TZE     s:5684

      656     5599    2        THEN DO;

      657     5600    2             USAL.CODE_ = IGA_SSAL;

   5600  4 000015   001000 236003                    LDQ     512,DU
         4 000016   000011 552040 2                  STBQ    USAL,'40'O

      658     5601    2             CALL M$MONINFO (GSAL) ALTRET (STDSAL);

   5601  4 000017   000042 630400 3                  EPPR0   GSAL
         4 000020   420023 713400                    CLIMB   alt,+8211
         4 000021   402400 401760                    pmme    nvectors=6
         4 000022   000751 702000 4                  TSX2    STDSAL

      659     5602    2             USAL.MSG_=ADDR(MSAL.SALUTATION#)->VTXTC.T;

   5602  4 000023   000155 236000 2                  LDQ     MSAL+31
         4 000024   000033 772000                    QRL     27
         4 000025   000000 620006                    EAX0    0,QL
         4 000026   040000 100440                    MLR     fill='040'O
         4 000027   000155 200010 2                  ADSC9   MSAL+31                  cn=1,n=*X0
         4 000030   000011 400172 2                  ADSC9   USAL                     cn=2,n=122

      660     5603    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL),FEX);

   5603  4 000031   200003 236100                    LDQ     @FEX,,AUTO
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:125  
         4 000032   200046 756100                    STQ     I+3,,AUTO
         4 000033   000002 237000 5                  LDAQ    2
         4 000034   200044 757100                    STAQ    I+1,,AUTO
         4 000035   200044 630500                    EPPR0   I+1,,AUTO
         4 000036   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000037   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000040   000000 011000                    NOP     0

   5602  4 000041                       WRSAL        null
      661     5604    2   WRSAL:    ;
      662     5605    2             SIZE = SIZEC(USAL.MSG_);

   5605  4 000041   000172 235007                    LDA     122,DL
         4 000042   200005 755100                    STA     SIZE,,AUTO

      663     5606    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_HDM);

   5606  4 000043   000001 236000 5                  LDQ     1
         4 000044   200046 756100                    STQ     I+3,,AUTO
         4 000045   200005 630500                    EPPR0   SIZE,,AUTO
         4 000046   200045 450500                    STP0    I+2,,AUTO
         4 000047   000004 236000 5                  LDQ     4
         4 000050   200044 756100                    STQ     I+1,,AUTO
         4 000051   200044 630500                    EPPR0   I+1,,AUTO
         4 000052   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000053   000000 701000 xent               TSX1    KLH$ERRMSG
         4 000054   000000 011000                    NOP     0

      664     5607    2             USAL.CODE_ = IGA_SHDM;

   5607  4 000055   005000 236003                    LDQ     2560,DU
         4 000056   000011 552040 2                  STBQ    USAL,'40'O

      665     5608    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);

   5608  4 000057   200005 235100                    LDA     SIZE,,AUTO
         4 000060   000002 035007                    ADLA    2,DL
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:126  
         4 000061   200044 755100                    STA     I+1,,AUTO
         4 000062   200003 236100                    LDQ     @FEX,,AUTO
         4 000063   200047 756100                    STQ     I+4,,AUTO
         4 000064   200044 630500                    EPPR0   I+1,,AUTO
         4 000065   200046 450500                    STP0    I+3,,AUTO
         4 000066   000002 236000 5                  LDQ     2
         4 000067   200045 756100                    STQ     I+2,,AUTO
         4 000070   200045 630500                    EPPR0   I+2,,AUTO
         4 000071   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000072   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000073   000000 011000                    NOP     0

      666     5609    2             SIZE = SIZEC(USAL.MSG_);

   5609  4 000074   000172 235007                    LDA     122,DL
         4 000075   200005 755100                    STA     SIZE,,AUTO

      667     5610    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_LDM);

   5610  4 000076   000005 236000 5                  LDQ     5
         4 000077   200046 756100                    STQ     I+3,,AUTO
         4 000100   200005 630500                    EPPR0   SIZE,,AUTO
         4 000101   200045 450500                    STP0    I+2,,AUTO
         4 000102   000004 236000 5                  LDQ     4
         4 000103   200044 756100                    STQ     I+1,,AUTO
         4 000104   200044 630500                    EPPR0   I+1,,AUTO
         4 000105   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000106   000000 701000 xent               TSX1    KLH$ERRMSG
         4 000107   000000 011000                    NOP     0

      668     5611    2             USAL.CODE_ = IGA_LNKDWNMSG;

   5611  4 000110   030000 236003                    LDQ     12288,DU
         4 000111   000011 552040 2                  STBQ    USAL,'40'O

      669     5612    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:127  
   5612  4 000112   200005 235100                    LDA     SIZE,,AUTO
         4 000113   000002 035007                    ADLA    2,DL
         4 000114   200044 755100                    STA     I+1,,AUTO
         4 000115   200003 236100                    LDQ     @FEX,,AUTO
         4 000116   200047 756100                    STQ     I+4,,AUTO
         4 000117   200044 630500                    EPPR0   I+1,,AUTO
         4 000120   200046 450500                    STP0    I+3,,AUTO
         4 000121   000002 236000 5                  LDQ     2
         4 000122   200045 756100                    STQ     I+2,,AUTO
         4 000123   200045 630500                    EPPR0   I+2,,AUTO
         4 000124   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000125   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000126   000000 011000                    NOP     0

      670     5613    2             SIZE = SIZEC(USAL.MSG_);

   5613  4 000127   000172 235007                    LDA     122,DL
         4 000130   200005 755100                    STA     SIZE,,AUTO

      671     5614    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_LPRMPT);

   5614  4 000131   000006 236000 5                  LDQ     6
         4 000132   200046 756100                    STQ     I+3,,AUTO
         4 000133   200005 630500                    EPPR0   SIZE,,AUTO
         4 000134   200045 450500                    STP0    I+2,,AUTO
         4 000135   000004 236000 5                  LDQ     4
         4 000136   200044 756100                    STQ     I+1,,AUTO
         4 000137   200044 630500                    EPPR0   I+1,,AUTO
         4 000140   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000141   000000 701000 xent               TSX1    KLH$ERRMSG
         4 000142   000000 011000                    NOP     0

      672     5615    2             USAL.CODE_ = IGA_LGNPRMPT;

   5615  4 000143   031000 236003                    LDQ     12800,DU
         4 000144   000011 552040 2                  STBQ    USAL,'40'O

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:128  
      673     5616    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);

   5616  4 000145   200005 235100                    LDA     SIZE,,AUTO
         4 000146   000002 035007                    ADLA    2,DL
         4 000147   200044 755100                    STA     I+1,,AUTO
         4 000150   200003 236100                    LDQ     @FEX,,AUTO
         4 000151   200047 756100                    STQ     I+4,,AUTO
         4 000152   200044 630500                    EPPR0   I+1,,AUTO
         4 000153   200046 450500                    STP0    I+3,,AUTO
         4 000154   000002 236000 5                  LDQ     2
         4 000155   200045 756100                    STQ     I+2,,AUTO
         4 000156   200045 630500                    EPPR0   I+2,,AUTO
         4 000157   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000160   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000161   000000 011000                    NOP     0

      674     5617    2             SIZE = SIZEC(USAL.MSG_);

   5617  4 000162   000172 235007                    LDA     122,DL
         4 000163   200005 755100                    STA     SIZE,,AUTO

      675     5618    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_HOSTRESUMED);

   5618  4 000164   000007 236000 5                  LDQ     7
         4 000165   200046 756100                    STQ     I+3,,AUTO
         4 000166   200005 630500                    EPPR0   SIZE,,AUTO
         4 000167   200045 450500                    STP0    I+2,,AUTO
         4 000170   000004 236000 5                  LDQ     4
         4 000171   200044 756100                    STQ     I+1,,AUTO
         4 000172   200044 630500                    EPPR0   I+1,,AUTO
         4 000173   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000174   000000 701000 xent               TSX1    KLH$ERRMSG
         4 000175   000000 011000                    NOP     0

      676     5619    2             USAL.CODE_ = IGA_HOSTRESUMED;

   5619  4 000176   007000 236003                    LDQ     3584,DU
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:129  
         4 000177   000011 552040 2                  STBQ    USAL,'40'O

      677     5620    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);

   5620  4 000200   200005 235100                    LDA     SIZE,,AUTO
         4 000201   000002 035007                    ADLA    2,DL
         4 000202   200044 755100                    STA     I+1,,AUTO
         4 000203   200003 236100                    LDQ     @FEX,,AUTO
         4 000204   200047 756100                    STQ     I+4,,AUTO
         4 000205   200044 630500                    EPPR0   I+1,,AUTO
         4 000206   200046 450500                    STP0    I+3,,AUTO
         4 000207   000002 236000 5                  LDQ     2
         4 000210   200045 756100                    STQ     I+2,,AUTO
         4 000211   200045 630500                    EPPR0   I+2,,AUTO
         4 000212   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000213   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000214   000000 011000                    NOP     0

      678     5621    2             SIZE = SIZEC(USAL.MSG_);

   5621  4 000215   000172 235007                    LDA     122,DL
         4 000216   200005 755100                    STA     SIZE,,AUTO

      679     5622    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_LGNTIMEDOUT);

   5622  4 000217   000010 236000 5                  LDQ     8
         4 000220   200046 756100                    STQ     I+3,,AUTO
         4 000221   200005 630500                    EPPR0   SIZE,,AUTO
         4 000222   200045 450500                    STP0    I+2,,AUTO
         4 000223   000004 236000 5                  LDQ     4
         4 000224   200044 756100                    STQ     I+1,,AUTO
         4 000225   200044 630500                    EPPR0   I+1,,AUTO
         4 000226   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000227   000000 701000 xent               TSX1    KLH$ERRMSG
         4 000230   000000 011000                    NOP     0

      680     5623    2             USAL.CODE_ = IGA_LGNTIMEDOUT;
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:130  

   5623  4 000231   004000 236003                    LDQ     2048,DU
         4 000232   000011 552040 2                  STBQ    USAL,'40'O

      681     5624    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);

   5624  4 000233   200005 235100                    LDA     SIZE,,AUTO
         4 000234   000002 035007                    ADLA    2,DL
         4 000235   200044 755100                    STA     I+1,,AUTO
         4 000236   200003 236100                    LDQ     @FEX,,AUTO
         4 000237   200047 756100                    STQ     I+4,,AUTO
         4 000240   200044 630500                    EPPR0   I+1,,AUTO
         4 000241   200046 450500                    STP0    I+3,,AUTO
         4 000242   000002 236000 5                  LDQ     2
         4 000243   200045 756100                    STQ     I+2,,AUTO
         4 000244   200045 630500                    EPPR0   I+2,,AUTO
         4 000245   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000246   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000247   000000 011000                    NOP     0

      682     5625    2             SIZE = SIZEC(USAL.MSG_);

   5625  4 000250   000172 235007                    LDA     122,DL
         4 000251   200005 755100                    STA     SIZE,,AUTO

      683     5626    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_NOLOGONMSG);

   5626  4 000252   000011 236000 5                  LDQ     9
         4 000253   200046 756100                    STQ     I+3,,AUTO
         4 000254   200005 630500                    EPPR0   SIZE,,AUTO
         4 000255   200045 450500                    STP0    I+2,,AUTO
         4 000256   000004 236000 5                  LDQ     4
         4 000257   200044 756100                    STQ     I+1,,AUTO
         4 000260   200044 630500                    EPPR0   I+1,,AUTO
         4 000261   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000262   000000 701000 xent               TSX1    KLH$ERRMSG
         4 000263   000000 011000                    NOP     0
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:131  

      684     5627    2             USAL.CODE_ = IGA_NOLOGONMSG;

   5627  4 000264   012000 236003                    LDQ     5120,DU
         4 000265   000011 552040 2                  STBQ    USAL,'40'O

      685     5628    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);

   5628  4 000266   200005 235100                    LDA     SIZE,,AUTO
         4 000267   000002 035007                    ADLA    2,DL
         4 000270   200044 755100                    STA     I+1,,AUTO
         4 000271   200003 236100                    LDQ     @FEX,,AUTO
         4 000272   200047 756100                    STQ     I+4,,AUTO
         4 000273   200044 630500                    EPPR0   I+1,,AUTO
         4 000274   200046 450500                    STP0    I+3,,AUTO
         4 000275   000002 236000 5                  LDQ     2
         4 000276   200045 756100                    STQ     I+2,,AUTO
         4 000277   200045 630500                    EPPR0   I+2,,AUTO
         4 000300   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000301   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000302   000000 011000                    NOP     0

      686     5629    2             SIZE = SIZEC(USAL.MSG_);

   5629  4 000303   000172 235007                    LDA     122,DL
         4 000304   200005 755100                    STA     SIZE,,AUTO

      687     5630    2             CALL KLH$ERRMSG(USAL.MSG_,SIZE,ERR_HOSTNA);

   5630  4 000305   000012 236000 5                  LDQ     10
         4 000306   200046 756100                    STQ     I+3,,AUTO
         4 000307   200005 630500                    EPPR0   SIZE,,AUTO
         4 000310   200045 450500                    STP0    I+2,,AUTO
         4 000311   000004 236000 5                  LDQ     4
         4 000312   200044 756100                    STQ     I+1,,AUTO
         4 000313   200044 630500                    EPPR0   I+1,,AUTO
         4 000314   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:132  
         4 000315   000000 701000 xent               TSX1    KLH$ERRMSG
         4 000316   000000 011000                    NOP     0

      688     5631    2             USAL.CODE_ = IGA_HOSTNA;

   5631  4 000317   115000 236003                    LDQ     39424,DU
         4 000320   000011 552040 2                  STBQ    USAL,'40'O

      689     5632    2             CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SIZE,FEX);

   5632  4 000321   200005 235100                    LDA     SIZE,,AUTO
         4 000322   000002 035007                    ADLA    2,DL
         4 000323   200044 755100                    STA     I+1,,AUTO
         4 000324   200003 236100                    LDQ     @FEX,,AUTO
         4 000325   200047 756100                    STQ     I+4,,AUTO
         4 000326   200044 630500                    EPPR0   I+1,,AUTO
         4 000327   200046 450500                    STP0    I+3,,AUTO
         4 000330   000002 236000 5                  LDQ     2
         4 000331   200045 756100                    STQ     I+2,,AUTO
         4 000332   200045 630500                    EPPR0   I+2,,AUTO
         4 000333   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000334   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000335   000000 011000                    NOP     0

      690     5633
      691     5634    2             ERR = %E$SGSYN;

   5634  4 000336   002275 235007                    LDA     1213,DL
         4 000337   200042 755100                    STA     ERR,,AUTO

      692     5635    2             CALL KLH$SGNTXT(SGNRSP,ERR);

   5635  4 000340   200042 630500                    EPPR0   ERR,,AUTO
         4 000341   200045 450500                    STP0    I+2,,AUTO
         4 000342   200006 631500                    EPPR1   SGNRSP,,AUTO
         4 000343   200044 451500                    STP1    I+1,,AUTO
         4 000344   200044 630500                    EPPR0   I+1,,AUTO
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:133  
         4 000345   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000346   000000 701000 xent               TSX1    KLH$SGNTXT
         4 000347   000000 011000                    NOP     0

      693     5636    2             USAL.CODE_ = IGA_SGSYN;

   5636  4 000350   122000 236003                    LDQ     41984,DU
         4 000351   000011 552040 2                  STBQ    USAL,'40'O

      694     5637    2             USAL.MSG_ = SGNRSP.MESSAGE.RSPTXT;

   5637  4 000352   040000 100500                    MLR     fill='040'O
         4 000353   200016 000120                    ADSC9   SGNRSP+8,,AUTO           cn=0,n=80
         4 000354   000011 400172 2                  ADSC9   USAL                     cn=2,n=122

      695     5638    2            CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SGNRSP.MESSAGE.RSPSIZ
              5638                      ,FEX);

   5638  4 000355   200015 236100                    LDQ     SGNRSP+7,,AUTO
         4 000356   000777 376007                    ANQ     511,DL
         4 000357   000002 036007                    ADLQ    2,DL
         4 000360   200044 756100                    STQ     I+1,,AUTO
         4 000361   200003 236100                    LDQ     @FEX,,AUTO
         4 000362   200047 756100                    STQ     I+4,,AUTO
         4 000363   200044 630500                    EPPR0   I+1,,AUTO
         4 000364   200046 450500                    STP0    I+3,,AUTO
         4 000365   000002 236000 5                  LDQ     2
         4 000366   200045 756100                    STQ     I+2,,AUTO
         4 000367   200045 630500                    EPPR0   I+2,,AUTO
         4 000370   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000371   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000372   000000 011000                    NOP     0

      696     5639    2             ERR = %E$UDHOST;

   5639  4 000373   002304 235007                    LDA     1220,DL
         4 000374   200042 755100                    STA     ERR,,AUTO
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:134  

      697     5640    2             CALL KLH$SGNTXT(SGNRSP,ERR);

   5640  4 000375   200042 630500                    EPPR0   ERR,,AUTO
         4 000376   200045 450500                    STP0    I+2,,AUTO
         4 000377   200006 631500                    EPPR1   SGNRSP,,AUTO
         4 000400   200044 451500                    STP1    I+1,,AUTO
         4 000401   200044 630500                    EPPR0   I+1,,AUTO
         4 000402   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000403   000000 701000 xent               TSX1    KLH$SGNTXT
         4 000404   000000 011000                    NOP     0

      698     5641    2             USAL.CODE_ = IGA_UDHOST;

   5641  4 000405   124000 236003                    LDQ     43008,DU
         4 000406   000011 552040 2                  STBQ    USAL,'40'O

      699     5642    2             USAL.MSG_ = SGNRSP.MESSAGE.RSPTXT;

   5642  4 000407   040000 100500                    MLR     fill='040'O
         4 000410   200016 000120                    ADSC9   SGNRSP+8,,AUTO           cn=0,n=80
         4 000411   000011 400172 2                  ADSC9   USAL                     cn=2,n=122

      700     5643    2            CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SGNRSP.MESSAGE.RSPSIZ
              5643                      ,FEX);

   5643  4 000412   200015 236100                    LDQ     SGNRSP+7,,AUTO
         4 000413   000777 376007                    ANQ     511,DL
         4 000414   000002 036007                    ADLQ    2,DL
         4 000415   200044 756100                    STQ     I+1,,AUTO
         4 000416   200003 236100                    LDQ     @FEX,,AUTO
         4 000417   200047 756100                    STQ     I+4,,AUTO
         4 000420   200044 630500                    EPPR0   I+1,,AUTO
         4 000421   200046 450500                    STP0    I+3,,AUTO
         4 000422   000002 236000 5                  LDQ     2
         4 000423   200045 756100                    STQ     I+2,,AUTO
         4 000424   200045 630500                    EPPR0   I+2,,AUTO
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:135  
         4 000425   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000426   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000427   000000 011000                    NOP     0

      701     5644    2             ERR = %E$BDID;

   5644  4 000430   002267 235007                    LDA     1207,DL
         4 000431   200042 755100                    STA     ERR,,AUTO

      702     5645    2             CALL KLH$SGNTXT(SGNRSP,ERR);

   5645  4 000432   200042 630500                    EPPR0   ERR,,AUTO
         4 000433   200045 450500                    STP0    I+2,,AUTO
         4 000434   200006 631500                    EPPR1   SGNRSP,,AUTO
         4 000435   200044 451500                    STP1    I+1,,AUTO
         4 000436   200044 630500                    EPPR0   I+1,,AUTO
         4 000437   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000440   000000 701000 xent               TSX1    KLH$SGNTXT
         4 000441   000000 011000                    NOP     0

      703     5646    2             USAL.CODE_ = IGA_BDID;

   5646  4 000442   125000 236003                    LDQ     43520,DU
         4 000443   000011 552040 2                  STBQ    USAL,'40'O

      704     5647    2             USAL.MSG_ = SGNRSP.MESSAGE.RSPTXT;

   5647  4 000444   040000 100500                    MLR     fill='040'O
         4 000445   200016 000120                    ADSC9   SGNRSP+8,,AUTO           cn=0,n=80
         4 000446   000011 400172 2                  ADSC9   USAL                     cn=2,n=122

      705     5648    2            CALL KLX$WRHLPNODE(USAL,SIZEC(USAL)-SIZEC(USAL.MSG_)+SGNRSP.MESSAGE.RSPSIZ
              5648                      ,FEX);

   5648  4 000447   200015 236100                    LDQ     SGNRSP+7,,AUTO
         4 000450   000777 376007                    ANQ     511,DL
         4 000451   000002 036007                    ADLQ    2,DL
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:136  
         4 000452   200044 756100                    STQ     I+1,,AUTO
         4 000453   200003 236100                    LDQ     @FEX,,AUTO
         4 000454   200047 756100                    STQ     I+4,,AUTO
         4 000455   200044 630500                    EPPR0   I+1,,AUTO
         4 000456   200046 450500                    STP0    I+3,,AUTO
         4 000457   000002 236000 5                  LDQ     2
         4 000460   200045 756100                    STQ     I+2,,AUTO
         4 000461   200045 630500                    EPPR0   I+2,,AUTO
         4 000462   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000463   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000464   000000 011000                    NOP     0

      706     5649    2             SETNODE.FCN = IGA_NODETBL;

   5649  4 000465   121000 236003                    LDQ     41472,DU
         4 000466   000002 552040 2                  STBQ    SETNODE,'40'O

      707     5650    2             KL_NETWORK_VALID = '0'B;

   5650  4 000467   000000 450000 xsym               STZ     KL_NETWORK_VALID

      708     5651    2             KL_RD_NETCON.BUF_ = VECTOR(KL_EXTRSP_BUF);

   5651  4 000470   000014 237000 5                  LDAQ    12
         4 000471   000004 757000 xsym               STAQ    KL_RD_NETCON+4

      709     5652    2             KL_RD_NETCON.KEY_ = VECTOR(KL$NETWORK_KEY);

   5652  4 000472   000016 237000 5                  LDAQ    14
         4 000473   000002 757000 xsym               STAQ    KL_RD_NETCON+2

      710     5653    2             CALL M$READ (KL_RD_NETCON)

   5653  4 000474   000000 630400 xsym               EPPR0   KL_RD_NETCON
         4 000475   440000 713400                    CLIMB   alt,read
         4 000476   401400 401760                    pmme    nvectors=4
         4 000477   000567 702000 4                  TSX2    s:5677
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:137  

      711     5654    3             WHENRETURN DO;

      712     5655    4                  DO I = 0 TO KL$NETWORK.NODE#;

   5655  4 000500   200043 450100                    STZ     I,,AUTO
         4 000501   000562 710000 4                  TRA     s:5674+3

      713     5656    4                       SETNODE.NODE# = I;

   5656  4 000502   200043 235100                    LDA     I,,AUTO
         4 000503   000003 755000 2                  STA     SETNODE+1

      714     5657    4                       SETNODE.NODE_NAME = KL$NETWORK.NODE.NODE(I);

   5657  4 000504   200043 236100                    LDQ     I,,AUTO
         4 000505   000024 402007                    MPY     20,DL
         4 000506   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 000507   040000 100506                    MLR     fill='040'O
         4 000510   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         4 000511   000004 000010 2                  ADSC9   SETNODE+2                cn=0,n=8

      715     5658    4                       SETNODE.MY_NODE = '0'B;

   5658  4 000512   000020 236000 5                  LDQ     16
         4 000513   000002 356000 2                  ANSQ    SETNODE

      716     5659    5                       DO CASE (KL$NETWORK.NODE.TYPE(I));

   5659  4 000514   200043 236100                    LDQ     I,,AUTO
         4 000515   000005 402007                    MPY     5,DL
         4 000516   000001 235106                    LDA     1,QL,PR0
         4 000517   000005 115007                    CMPA    5,DL
         4 000520   000522 602005 4                  TNC     s:5659+6,AL
         4 000521   000540 710000 4                  TRA     s:5671
         4 000522   000535 710000 4                  TRA     s:5668
         4 000523   000527 710000 4                  TRA     s:5662
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:138  
         4 000524   000532 710000 4                  TRA     s:5665
         4 000525   000527 710000 4                  TRA     s:5662
         4 000526   000532 710000 4                  TRA     s:5665

      717     5660
      718     5661    5                       CASE (%KL_NODETYPE_HOST,%KL_NODETYPE_ME);

      719     5662    5                          SETNODE.HOST_NODE = '1'B;

   5662  4 000527   000100 236007                    LDQ     64,DL
         4 000530   000002 256000 2                  ORSQ    SETNODE
         4 000531   000540 710000 4                  TRA     s:5671

      720     5663
      721     5664    5                       CASE (%KL_NODETYPE_FEP,%KL_NODETYPE_DEBUG);

      722     5665    5                          SETNODE.HOST_NODE = '0'B;

   5665  4 000532   000021 236000 5                  LDQ     17
         4 000533   000002 356000 2                  ANSQ    SETNODE
         4 000534   000540 710000 4                  TRA     s:5671

      723     5666
      724     5667    5                       CASE (%KL_NODETYPE_UNDEF);

      725     5668    5                          SETNODE.NODE_NAME = ' ';

   5668  4 000535   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000536   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000537   000004 757000 2                  STAQ    SETNODE+2

      726     5669
      727     5670    5                       END;

      728     5671    4                       IF KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_HOST OR

   5671  4 000540   200043 236100                    LDQ     I,,AUTO
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:139  
         4 000541   000005 402007                    MPY     5,DL
         4 000542   000001 235106                    LDA     1,QL,PR0
         4 000543   000001 115007                    CMPA    1,DL
         4 000544   000547 600000 4                  TZE     s:5673
         4 000545   000003 115007                    CMPA    3,DL
         4 000546   000557 601000 4                  TNZ     s:5674

      729     5672    4                            KL$NETWORK.NODE.TYPE(I) = %KL_NODETYPE_ME THEN
      730     5673    4                            CALL KLX$WRHLPNODE(SETNODE,SIZEC(SETNODE),FEX);

   5673  4 000547   200003 236100                    LDQ     @FEX,,AUTO
         4 000550   200046 756100                    STQ     I+3,,AUTO
         4 000551   000024 237000 5                  LDAQ    20
         4 000552   200044 757100                    STAQ    I+1,,AUTO
         4 000553   200044 630500                    EPPR0   I+1,,AUTO
         4 000554   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000555   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000556   000000 011000                    NOP     0

      731     5674    4                     END;

   5674  4 000557   200043 235100                    LDA     I,,AUTO
         4 000560   000001 035007                    ADLA    1,DL
         4 000561   200043 755100                    STA     I,,AUTO
         4 000562   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 000563   000000 236100                    LDQ     0,,PR0
         4 000564   200043 116100                    CMPQ    I,,AUTO
         4 000565   000502 603000 4                  TRC     s:5656

      732     5675    3                END;                       /* end whenreturn*/

   5675  4 000566   000601 710000 4                  TRA     s:5680

      733     5676    3             WHENALTRETURN DO;

      734     5677    3                  SETNODE.INVALID = '1'B;

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:140  
   5677  4 000567   000040 236007                    LDQ     32,DL
         4 000570   000002 256000 2                  ORSQ    SETNODE

      735     5678    3                  CALL KLX$WRHLPNODE(SETNODE,SIZEC(SETNODE),FEX);

   5678  4 000571   200003 236100                    LDQ     @FEX,,AUTO
         4 000572   200046 756100                    STQ     I+3,,AUTO
         4 000573   000024 237000 5                  LDAQ    20
         4 000574   200044 757100                    STAQ    I+1,,AUTO
         4 000575   200044 630500                    EPPR0   I+1,,AUTO
         4 000576   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000577   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000600   000000 011000                    NOP     0

      736     5679    3                END;

      737     5680    2             CALL KLI$GETOSIROUTES(FEX);

   5680  4 000601   200003 630500                    EPPR0   @FEX,,AUTO
         4 000602   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000603   000000 701000 xent               TSX1    KLI$GETOSIROUTES
         4 000604   000000 011000                    NOP     0

      738     5681    2             CALL KLX$WRHLPNODE(FEPW,SIZEC(FEPW),FEX);

   5681  4 000605   200003 236100                    LDQ     @FEX,,AUTO
         4 000606   200046 756100                    STQ     I+3,,AUTO
         4 000607   000026 237000 5                  LDAQ    22
         4 000610   200044 757100                    STAQ    I+1,,AUTO
         4 000611   200044 630500                    EPPR0   I+1,,AUTO
         4 000612   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000613   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000614   000000 011000                    NOP     0

      739     5682    2             CALL KLX$WRHLPNODE(KL_HDRMSG,KL_BROADSZ+LENGTHC(KL_HDRMSG)-LENGTHC(
              5682                      KL_HDRMSG.MSG_),FEX);

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:141  
   5682  4 000615   000000 235000 2                  LDA     KL_BROADSZ
         4 000616   000002 035007                    ADLA    2,DL
         4 000617   200044 755100                    STA     I+1,,AUTO
         4 000620   200003 236100                    LDQ     @FEX,,AUTO
         4 000621   200047 756100                    STQ     I+4,,AUTO
         4 000622   200044 630500                    EPPR0   I+1,,AUTO
         4 000623   200046 450500                    STP0    I+3,,AUTO
         4 000624   000023 236000 5                  LDQ     19
         4 000625   200045 756100                    STQ     I+2,,AUTO
         4 000626   200045 630500                    EPPR0   I+2,,AUTO
         4 000627   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000630   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000631   000000 011000                    NOP     0

      740     5683    2           END;

      741     5684    1        NODEINFO.MYNODE = KL_NODE;

   5684  4 000632   000000 236000 xsym               LDQ     KL_NODE
         4 000633   000033 736000                    QLS     27
         4 000634   000110 552040 2                  STBQ    NODEINFO+1,'40'O

      742     5685    1        NODEINFO.MYNAME = KL_NODENAME;

   5685  4 000635   040000 100400                    MLR     fill='040'O
         4 000636   000000 000010 xsym               ADSC9   KL_NODENAME              cn=0,n=8
         4 000637   000110 200010 2                  ADSC9   NODEINFO+1               cn=1,n=8

      743     5686    1        IF KL_FETBL.BOSS(FEX)

   5686  4 000640   200003 470500                    LDP0    @FEX,,AUTO
         4 000641   000000 720100                    LXL0    0,,PR0
         4 000642   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000643   040000 316003                    CANQ    16384,DU
         4 000644   000650 600000 4                  TZE     s:5690

      744     5687    1        THEN
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:142  
      745     5688    1             NODEINFO.BOSS = 1;

   5688  4 000645   001000 236007                    LDQ     512,DL
         4 000646   000107 552010 2                  STBQ    NODEINFO,'10'O
         4 000647   000652 710000 4                  TRA     s:5691

      746     5689    1        ELSE
      747     5690    1             NODEINFO.BOSS = 0;

   5690  4 000650   000000 236003                    LDQ     0,DU
         4 000651   000107 552010 2                  STBQ    NODEINFO,'10'O

      748     5691    1        CALL KLX$WRHLPNODE (NODEINFO,SIZEC(NODEINFO),FEX);

   5691  4 000652   200003 236100                    LDQ     @FEX,,AUTO
         4 000653   200046 756100                    STQ     I+3,,AUTO
         4 000654   000030 237000 5                  LDAQ    24
         4 000655   200044 757100                    STAQ    I+1,,AUTO
         4 000656   200044 630500                    EPPR0   I+1,,AUTO
         4 000657   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000660   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000661   000000 011000                    NOP     0

      749     5692    1        IF KL_FETBL.LINK_CONNECT(FEX) THEN

   5692  4 000662   200003 470500                    LDP0    @FEX,,AUTO
         4 000663   000000 720100                    LXL0    0,,PR0
         4 000664   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000665   200000 316003                    CANQ    65536,DU
         4 000666   000672 600000 4                  TZE     s:5694

      750     5693    1             CALL KLI$GETROUTES;

   5693  4 000667   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000670   000000 701000 xent               TSX1    KLI$GETROUTES
         4 000671   000000 011000                    NOP     0

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:143  
      751     5694    1        IF KL_FETBL.BOSS(FEX) THEN

   5694  4 000672   200003 470500                    LDP0    @FEX,,AUTO
         4 000673   000000 720100                    LXL0    0,,PR0
         4 000674   000000 236010 xsym               LDQ     KL_FETBL,X0
         4 000675   040000 316003                    CANQ    16384,DU
         4 000676   000750 600000 4                  TZE     WDN

      752     5695    2        DO;

      753     5696    2             CALL M$TIME (FPT_TIME);

   5696  4 000677   000214 630400 2                  EPPR0   FPT_TIME
         4 000700   020004 713400                    CLIMB   8196
         4 000701   402000 401760                    pmme    nvectors=5

      754     5697                 /*
      755     5698                 **convert time to 1/25 uts
      756     5699                 **convert 1/25s uts to feputs
      757     5700                 */
      758     5701    2             CALL KLI$GETFEPERA(UTSBUF,FUTS);

   5701  4 000702   200004 630500                    EPPR0   FUTS,,AUTO
         4 000703   200045 450500                    STP0    I+2,,AUTO
         4 000704   000032 236000 5                  LDQ     26
         4 000705   200044 756100                    STQ     I+1,,AUTO
         4 000706   200044 630500                    EPPR0   I+1,,AUTO
         4 000707   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000710   000000 701000 xent               TSX1    KLI$GETFEPERA
         4 000711   000000 011000                    NOP     0

      759     5702                 /*
      760     5703                 **move era bits(2,3) into 32 bit range.  reduces resolution
      761     5704                 **but avoids having to use two field to send value to fep.
      762     5705                 */
      763     5706    2             FUTS = (FUTS+2)/4;

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:144  
   5706  4 000712   200004 236100                    LDQ     FUTS,,AUTO
         4 000713   000002 036007                    ADLQ    2,DL
         4 000714   000002 772000                    QRL     2
         4 000715   200004 756100                    STQ     FUTS,,AUTO

      764     5707    2             CALL KLX$9TO8(FUTS,TIME.UTS,4);

   5707  4 000716   000033 236000 5                  LDQ     27
         4 000717   200046 756100                    STQ     I+3,,AUTO
         4 000720   000034 236000 5                  LDQ     28
         4 000721   200045 756100                    STQ     I+2,,AUTO
         4 000722   200004 630500                    EPPR0   FUTS,,AUTO
         4 000723   200044 450500                    STP0    I+1,,AUTO
         4 000724   200044 630500                    EPPR0   I+1,,AUTO
         4 000725   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000726   000000 701000 xent               TSX1    KLX$9TO8
         4 000727   000000 011000                    NOP     0

      765     5708    2             CALL KLX$WRHLPNODE (TIME,SIZEC(TIME),FEX);

   5708  4 000730   200003 236100                    LDQ     @FEX,,AUTO
         4 000731   200046 756100                    STQ     I+3,,AUTO
         4 000732   000036 237000 5                  LDAQ    30
         4 000733   200044 757100                    STAQ    I+1,,AUTO
         4 000734   200044 630500                    EPPR0   I+1,,AUTO
         4 000735   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000736   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000737   000000 011000                    NOP     0

      766     5709    2             CALL KLX$WRHLPNODE (GO,SIZEC(GO),FEX);

   5709  4 000740   200003 236100                    LDQ     @FEX,,AUTO
         4 000741   200046 756100                    STQ     I+3,,AUTO
         4 000742   000040 237000 5                  LDAQ    32
         4 000743   200044 757100                    STAQ    I+1,,AUTO
         4 000744   200044 630500                    EPPR0   I+1,,AUTO
         4 000745   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:145  
         4 000746   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000747   000000 011000                    NOP     0

      767     5710    2           END;

   5708  4 000750                       WDN          null
      768     5711    1   WDN: ;
      769     5712    1        RETURN;

   5712  4 000750   000000 702200 xent               TSX2  ! X66_ARET

   5708  4 000751                       STDSAL       null
      770     5713    1   STDSAL:;
      771     5714    1        CALL KLX$WRHLPNODE(SALUTE,SIZEC(SALUTE),FEX);

   5714  4 000751   200003 236100                    LDQ     @FEX,,AUTO
         4 000752   200046 756100                    STQ     I+3,,AUTO
         4 000753   000044 237000 5                  LDAQ    36
         4 000754   200044 757100                    STAQ    I+1,,AUTO
         4 000755   200044 630500                    EPPR0   I+1,,AUTO
         4 000756   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000757   000000 701000 xent               TSX1    KLX$WRHLPNODE
         4 000760   000000 011000                    NOP     0

      772     5715    1        GOTO WRSAL;

   5715  4 000761   000041 710000 4                  TRA     WRSAL
      773     5716        /**/
      774     5717    1   END;
      775     5718        /**/
      776     5719        /**/
      777     5720        %EOD;

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:146  
--  Include file information  --

   KL_CONFIG_M.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_ERRORS_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$FEGO.
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:147  

 **** Variables and constants ****

  ****  Section 002  Data  KLI$FEGO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/c STRC(90)    r     1 FEPW                     214-0-0/d STRC(432)   r     1 FPT_TIME
     0-0-0/w UBIN        r     1 KL_BROADSZ                50-0-0/w STRC(1116)  r     1 KL_HDRMSG
   116-0-0/d STRC(2232)  r     1 MSAL                     107-0-0/w STRC(117)   r     1 NODEINFO
     2-0-0/w STRC(144)   r     1 SETNODE                  113-0-0/w STRC(45)    r     1 TIME
    11-0-0/w STRC(1116)  r     1 USAL                       1-0-0/w UBIN        r     1 UTSBUF

  ****  Section 003 RoData KLI$FEGO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w STRC        r     1 ERR_HDM                   20-0-0/w STRC        r     1 ERR_HOSTNA
    15-0-0/w STRC        r     1 ERR_HOSTRESUMED           13-0-0/w STRC        r     1 ERR_LDM
    16-0-0/w STRC        r     1 ERR_LGNTIMEDOUT           14-0-0/w STRC        r     1 ERR_LPRMPT
    17-0-0/w STRC        r     1 ERR_NOLOGONMSG            22-0-0/d STRC(576)   r     1 FEACT
    10-0-0/c STRC(54)    r     1 GO                        42-0-0/d STRC(432)   r     1 GSAL
     0-0-0/w STRC(18)    r     1 KL$NETWORK_KEY             1-0-0/c STRC(252)   r     1 SALUTE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FEX                      42-0-0/w UBIN        r     1 ERR
    *0-0-0/w UBIN        r     1 FEX                        4-0-0/w UBIN        r     1 FUTS
    43-0-0/w UBIN        r     1 I                          6-0-0/w STRC(1008)  r     1 SGNRSP
     5-0-0/w UBIN        r     1 SIZE

  ****  SYMREF variables  ****

PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:148  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 KL_EXTRSP_BUF(0:1499)
     0-0-0/w PTR         r     1 KL_EXTRSP_BUF$
     0-0-0/w STRC        r     1 KL_FETBL(0:0)
     0-0-0/b BIT         r     1 KL_NETWORK_VALID           0-0-0/w UBIN        r     1 KL_NODE
     0-0-0/c CHAR(8)     r     1 KL_NODENAME                0-0-0/d STRC(504)   r     1 KL_RD_NETCON
     0-0-0/c CHAR(8)     r     1 KL_STATION

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(216)   r     1 KL$NETWORK                 0-0-0N  NULL        r     1 M$HLP
     0-0-0/w ASTR(9)     r     1 VTXTC


   Procedure KLI$FEGO requires 498 words for executable code.
   Procedure KLI$FEGO requires 40 words of local(AUTO) storage.
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:149  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:150  
          MINI XREF LISTING

ERR
      5048**DCL      5634<<ASSIGN   5635<>CALL     5639<<ASSIGN   5640<>CALL     5644<<ASSIGN   5645<>CALL
ERR_HDM
      5084**DCL      5606<>CALL
ERR_HOSTNA
      5372**DCL      5630<>CALL
ERR_HOSTRESUMED
      5228**DCL      5618<>CALL
ERR_LDM
      5132**DCL      5610<>CALL
ERR_LGNTIMEDOUT
      5276**DCL      5622<>CALL
ERR_LPRMPT
      5180**DCL      5614<>CALL
ERR_NOLOGONMSG
      5324**DCL      5626<>CALL
FEACT
      5527**DCL      5594<>CALL
FEACT.V
      5528**DCL      5527--DCLINIT
FEACT.V.DVBYTE.REREAD#
      5530**DCL      5530--REDEF
FEPW
      5409**DCL      5681<>CALL     5681--CALL
FEX
      4815**DCL         8--PROC     5598>>IF       5603<>CALL     5608<>CALL     5612<>CALL     5616<>CALL
      5620<>CALL     5624<>CALL     5628<>CALL     5632<>CALL     5638<>CALL     5643<>CALL     5648<>CALL
      5673<>CALL     5678<>CALL     5680<>CALL     5681<>CALL     5682<>CALL     5686>>IF       5691<>CALL
      5692>>IF       5694>>IF       5708<>CALL     5709<>CALL     5714<>CALL
FPT_TIME
      5584**DCL      5696<>CALL
FPT_TIME.V
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:151  
      5588**DCL      5584--DCLINIT
FUTS
      4821**DCL      5701<>CALL     5706<<ASSIGN   5706>>ASSIGN   5707<>CALL
GO
      5067**DCL      5709<>CALL     5709--CALL
GSAL
      5550**DCL      5601<>CALL
I
      5050**DCL      5655<<DOINDEX  5656>>ASSIGN   5657>>ASSIGN   5659>>DOCASE   5671>>IF       5671>>IF
KL$NETWORK.NODE.NODE
      5043**DCL      5657>>ASSIGN
KL$NETWORK.NODE.TYPE
      5040**DCL      5659>>DOCASE   5671>>IF       5671>>IF
KL$NETWORK.NODE#
      5035**DCL      5655>>DOINDEX
KL$NETWORK_KEY
      5017**DCL      5652--ASSIGN
KLH$ERRMSG
      5052**DCL-ENT  5606--CALL     5610--CALL     5614--CALL     5618--CALL     5622--CALL     5626--CALL
      5630--CALL
KLH$SGNTXT
      5049**DCL-ENT  5635--CALL     5640--CALL     5645--CALL
KLI$GETFEPERA
      5056**DCL-ENT  5701--CALL
KLI$GETOSIROUTES
      5055**DCL-ENT  5680--CALL
KLI$GETROUTES
      5053**DCL-ENT  5693--CALL
KLX$9TO8
      5051**DCL-ENT  5707--CALL
KLX$WRHLPNODE
      5054**DCL-ENT  5603--CALL     5608--CALL     5612--CALL     5616--CALL     5620--CALL     5624--CALL
      5628--CALL     5632--CALL     5638--CALL     5643--CALL     5648--CALL     5673--CALL     5678--CALL
      5681--CALL     5682--CALL     5691--CALL     5708--CALL     5709--CALL     5714--CALL
KL_AUTOFAIL.FLAGS
      3891**DCL      3892--REDEF
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:152  
KL_AUTOFAIL.MSGID
      3887**DCL      3888--REDEF
KL_AUTOFAIL.WSN
      3894**DCL      3895--REDEF
KL_BROADSZ
      4819**DCL      5682>>CALL
KL_EXTRSP_BUF
      4047**DCL      5651--ASSIGN
KL_EXTRSP_BUF$
      4048**DCL      5034--IMP-PTR  5655>>DOINDEX  5657>>ASSIGN   5659>>DOCASE   5671>>IF       5671>>IF
KL_FEMSG.FLAGS
      3841**DCL      3842--REDEF
KL_FEMSG.MSGID
      3837**DCL      3838--REDEF
KL_FEMSG.WSN
      3844**DCL      3845--REDEF
KL_FETBL.BOSS
      3784**DCL      5598>>IF       5686>>IF       5694>>IF
KL_FETBL.LINK_CONNECT
      3782**DCL      5692>>IF
KL_HDRMSG
      5421**DCL      5682<>CALL     5682--CALL
KL_HDRMSG.MSG_
      5424**DCL      5682--CALL
KL_NETWORK_BUF.TERMINAL_ID.TERM
      4031**DCL      4040--REDEF
KL_NETWORK_KEY.KEY.TERMID.TERM
      3957**DCL      3966--REDEF
KL_NETWORK_VALID
      3820**DCL      5650<<ASSIGN
KL_NODE
      3822**DCL      5684>>ASSIGN
KL_NODENAME
      3821**DCL      5685>>ASSIGN
KL_RDBF.FEL#
      3800**DCL      3801--REDEF
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:153  
KL_RD_NETCON
      5493**DCL      5653<>CALL
KL_RD_NETCON.BUF_
      5495**DCL      5651<<ASSIGN
KL_RD_NETCON.KEY_
      5493**DCL      5652<<ASSIGN
KL_RD_NETCON.STATION_
      5496**DCL      5497--REDEF
KL_RD_NETCON.V.DVBYTE.REREAD#
      5508**DCL      5508--REDEF
KL_RD_NETCON.V.INDX#
      5506**DCL      5506--REDEF
KL_STATION
      5515**DCL      5527--DCLINIT
KL_TMSG.FLAGS
      3863**DCL      3864--REDEF
KL_TMSG.MSGID
      3859**DCL      3860--REDEF
KL_TMSG.WSN
      3866**DCL      3867--REDEF
M$ACTIVATE
      3535**DCL-ENT  5594--CALL
M$MONINFO
      3583**DCL-ENT  5601--CALL
M$READ
      3516**DCL-ENT  5653--CALL
M$TIME
      3582**DCL-ENT  5696--CALL
MSAL
      5565**DCL      5550--DCLINIT
MSAL.SALUTATION#
      5566**DCL      5602--ASSIGN   5602--ASSIGN
NODEINFO
      5441**DCL      5691<>CALL     5691--CALL
NODEINFO.BOSS
      5445**DCL      5688<<ASSIGN   5690<<ASSIGN
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:154  
NODEINFO.MYNAME
      5448**DCL      5685<<ASSIGN
NODEINFO.MYNODE
      5447**DCL      5684<<ASSIGN
SALUTE
      5061**DCL      5714<>CALL     5714--CALL
SETNODE
      4973**DCL      5673<>CALL     5673--CALL     5678<>CALL     5678--CALL
SETNODE.FCN
      4974**DCL      5649<<ASSIGN
SETNODE.HOST_NODE
      4985**DCL      5662<<ASSIGN   5665<<ASSIGN
SETNODE.INVALID
      4989**DCL      5677<<ASSIGN
SETNODE.MY_NODE
      4980**DCL      5658<<ASSIGN
SETNODE.NODE#
      4997**DCL      5656<<ASSIGN
SETNODE.NODE_NAME
      5001**DCL      5657<<ASSIGN   5668<<ASSIGN
SGNRSP
      4838**DCL      5635<>CALL     5640<>CALL     5645<>CALL
SGNRSP.MESSAGE.RSPSIZ
      4955**DCL      5638>>CALL     5643>>CALL     5648>>CALL
SGNRSP.MESSAGE.RSPTXT
      4956**DCL      5637>>ASSIGN   5642>>ASSIGN   5647>>ASSIGN
SGNRSP.NMID
      4851**DCL      4854--REDEF
SGNRSP.TERMID.TERM
      4941**DCL      4950--REDEF
SIZE
      4822**DCL      5605<<ASSIGN   5606<>CALL     5608>>CALL     5609<<ASSIGN   5610<>CALL     5612>>CALL
      5613<<ASSIGN   5614<>CALL     5616>>CALL     5617<<ASSIGN   5618<>CALL     5620>>CALL     5621<<ASSIGN
      5622<>CALL     5624>>CALL     5625<<ASSIGN   5626<>CALL     5628>>CALL     5629<<ASSIGN   5630<>CALL
      5632>>CALL
STDSAL
PL6.E3A0      #004=KLI$FEGO File=KLI$FESET.:E05TSI                               WED 07/30/97 00:51 Page:155  
      5708**LABEL    5601--CALLALT
TIME
      5465**DCL      5708<>CALL     5708--CALL
TIME.UTS
      5470**DCL      5707<>CALL
USAL
      5415**DCL      5603<>CALL     5603--CALL     5608<>CALL     5608--CALL     5612<>CALL     5612--CALL
      5616<>CALL     5616--CALL     5620<>CALL     5620--CALL     5624<>CALL     5624--CALL     5628<>CALL
      5628--CALL     5632<>CALL     5632--CALL     5638<>CALL     5638--CALL     5643<>CALL     5643--CALL
      5648<>CALL     5648--CALL
USAL.CODE_
      5416**DCL      5600<<ASSIGN   5607<<ASSIGN   5611<<ASSIGN   5615<<ASSIGN   5619<<ASSIGN   5623<<ASSIGN
      5627<<ASSIGN   5631<<ASSIGN   5636<<ASSIGN   5641<<ASSIGN   5646<<ASSIGN
USAL.MSG_
      5418**DCL      5602<<ASSIGN   5605--ASSIGN   5606<>CALL     5608--CALL     5609--ASSIGN   5610<>CALL
      5612--CALL     5613--ASSIGN   5614<>CALL     5616--CALL     5617--ASSIGN   5618<>CALL     5620--CALL
      5621--ASSIGN   5622<>CALL     5624--CALL     5625--ASSIGN   5626<>CALL     5628--CALL     5629--ASSIGN
      5630<>CALL     5632--CALL     5637<<ASSIGN   5638--CALL     5642<<ASSIGN   5643--CALL     5647<<ASSIGN
      5648--CALL
UTSBUF
      4820**DCL      5588--DCLINIT  5701<>CALL
VTXTC.C
      4817**DCL      4818--IMP-SIZ  5602>>ASSIGN
VTXTC.T
      4818**DCL      5602>>ASSIGN
WRSAL
      5602**LABEL    5715--GOTO

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:156  
      778        1        /*T***********************************************************/
      779        2        /*T*                                                         */
      780        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      781        4        /*T*                                                         */
      782        5        /*T***********************************************************/
      783        6        /**/
      784        7        /**/
      785        8        KLI$KBOOT: PROC;
      786        9
      787       10        %INCLUDE AZ_MACRO_C;
      788     2597        %INCLUDE B$JIT;
      789     2887        %INCLUDE CP_6;
      790     2968        %INCLUDE CP_6_SUBS;
      791     3508        %INCLUDE F$DCB;
      792     3557        %INCLUDE OC_MESSHD_C;
      793     3610        %INCLUDE EL$TABLES;
      794     3933        %INCLUDE EL_SUBS_C;
      795     4017        %INCLUDE GH_SCHD_E;
      796     4113        %INCLUDE G_JIT_M;
      797     4378        %INCLUDE IR_DATA_M;
      798     4542        %INCLUDE KC$CGBLK;
      799     4590        %INCLUDE KL_SUPER_C;
      800     7492        %INCLUDE KL_MACRO_C;
      801    10844        %INCLUDE KL_AFCN_C;
      802    10945        %INCLUDE KL_DATA_R;
      803    11409        %INCLUDE KI_ERRORS_C;
      804    11494        %INCLUDE OC_SUBS_C;
      805    12225        %INCLUDE KI_SUBS_C;
      806    12361        %INCLUDE KL_SUBS_C;
      807    12415        %INCLUDE KL_CONFIG_M;
      808    13177        %INCLUDE KL_CONTROL_C;
      809    13557        %INCLUDE K_ID_E;
      810    13607        %INCLUDE KHA_FNC_E;
      811    13707        %INCLUDE KL_ERRORS_C;
      812    13749        %INCLUDE PC_SUBS_C;
      813    14081        %INCLUDE B_SEGIDS_C;
      814    14620        %INCLUDE ES_TABLES_M;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:157  
      815    15014        %INCLUDE ES_SUBS_E;
      816    15040        %INCLUDE K_ADDRESS_M;
      817    15543        /**/
      818    15544        %B$TCB;
      819    15547        %B$ALT;
      820    15555    1   DCL KL_STATION CHAR(8) SYMREF;
      821    15556        %KL_FROG (STCLASS=SYMREF);
      822    15574        /**/
      823    15575        %K#LYRID_E;
      824    15582        %K#ENTID_E;
      825    15601        %GI_RCVR_EQU;
      826    15613        /**/
      827    15614    1   DCL M$CSCG DCB;
      828    15615    1   DCL M$PROF DCB;
      829    15616    1   DCL M$ACCTLG DCB;
      830    15617    1   DCL M$NETCON DCB;
      831    15618    1   DCL M$NETWORK DCB;
      832    15619    1   DCL RDBF$ PTR;
      833    15620    1   DCL JC_MARS UBIN SYMREF;
      834    15621
      835    15622        /* The following is the definitions for the keyins  */
      836    15623    1   DCL JC_CSMBF CHAR(300) SYMREF;
      837    15624    1   DCL 1 KMSG REDEF JC_CSMBF,
      838    15625    1            2 KIN# UBIN(18) UNAL,
      839    15626    1            2 CADDR BIT(18) UNAL,
      840    15627    1            2 FEX UBIN WORD,
      841    15628    1            2 NAME CHAR(8) UNAL,
      842    15629    1            2 FID UNAL,
      843    15630    1                 3 CNT UBIN BYTE UNAL,
      844    15631    1                 3 TXT CHAR(60) UNAL,
      845    15632    1            2 * CHAR(223) UNAL;
      846    15633    1   DCL 1 KMPW REDEF JC_CSMBF,
      847    15634    1            2 KIN# UBIN(18) UNAL,
      848    15635    1            2 CADDR BIT(18) UNAL,
      849    15636    1            2 FEX UBIN WORD,
      850    15637    1            2 FEPW,
      851    15638    1                 3 CNT UBIN BYTE UNAL,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:158  
      852    15639    1                 3 TXT CHAR(7) UNAL,
      853    15640    1            2 FEPWT REDEF FEPW CHAR(8),
      854    15641    1            2 * CHAR(284) UNAL;
      855    15642    1   DCL 1 KBCHS REDEF JC_CSMBF,
      856    15643    1            2 KIN# UBIN(18) UNAL,
      857    15644    1            2 CADDR BIT(18) UNAL,
      858    15645    1            2 FEP# UBIN WORD UNAL,
      859    15646    1            2 FEPNAME CHAR(8) UNAL,
      860    15647    1            2 CNT UBIN(9) UNAL,
      861    15648    1            2 MSG CHAR(283);
      862    15649    1   DCL 1 DVCKYN REDEF JC_CSMBF,
      863    15650    1            2 KIN# UBIN HALF UNAL,
      864    15651    1            2 CADDR BIT(18) UNAL,
      865    15652    1            2 DEVNM CHAR(4) UNAL,
      866    15653    1            2 TWSN CHAR(4) UNAL,
      867    15654    1            2 * CHAR(288) UNAL;
      868    15655    1   DCL 1 DVCKYN_FRWD REDEF JC_CSMBF,
      869    15656    1            2 RTN# UBIN BYTE UNAL,
      870    15657    1            2 * CHAR(299) UNAL;
      871    15658    1   DCL 1 ENABLE_KEYIN REDEF JC_CSMBF,
      872    15659    1            2 KEYIN# UBIN HALF HALIGNED,
      873    15660    1            2 CADDR UBIN HALF HALIGNED,
      874    15661    1            2 FEP# UBIN ALIGNED,
      875    15662    1            2 NAME CHAR(8) UNAL,
      876    15663    1            2 LINE_LOW# UBIN HALF HALIGNED,
      877    15664    1            2 LINE_HI# UBIN HALF HALIGNED,
      878    15665    1            2 * CHAR(280) CALIGNED;
      879    15666    1   DCL 1 TWSN_KEY STATIC ALIGNED,
      880    15667    1            2 CNT UBIN BYTE UNAL INIT(8),
      881    15668    1            2 * CHAR(4) UNAL INIT('TWSN'),
      882    15669    1            2 TWSN CHAR(4) UNAL INIT('0000');
      883    15670    1   DCL M$HLPF DCB;
      884    15671    1   DCL M$DO DCB;
      885    15672        %KL_PHDR (NAME=KL_PROBUF,STCLASS="SYMREF ALIGNED");
      886    15713        %FPT_READ (FPTN=READ_HLPF,
      887    15714                   DCB=M$HLPF,
      888    15715                   KEY=TWSN_KEY,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:159  
      889    15716                   BUF=KL_HLPR,
      890    15717                   KEYS=YES);
      891    15756        %KL_TWSNREC (NAME=TWSN_REC,
      892    15757                     STCLASS="BASED(KL_HLPR$)");
      893    15782    1   DCL DEVNM CHAR(4);
      894    15783    1   DCL DEVNM_TWSN CHAR(8);
      895    15784    1   DCL 1 DVCERRCTX BASED(CTX$) ALIGNED,
      896    15785    1            2 LNK$ PTR,
      897    15786    1            2 MSG# UBIN HALF UNAL,
      898    15787    1            2 MSGID UBIN HALF UNAL,
      899    15788              %B$TERMINAL_ID (FPTN=TERMID,STCLASS=BASED,LVL=2,LAST=",");
      900    15817    1            2 FEX UBIN(9) UNAL,
      901    15818    1            2 DEVNM CHAR(8) UNAL,
      902    15819    1            2 KEYIN_REQ BIT(1) UNAL,
      903    15820    1            2 * BIT(8) UNAL;
      904    15821        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:160  
      905    15822        /* Local variables */
      906    15823    1   DCL LEN UBIN;
      907    15824    1   DCL I UBIN;
      908    15825    1   DCL J SBIN;
      909    15826    1   DCL K SBIN;
      910    15827    1   DCL OFFSET UBIN(18) HALIGNED;
      911    15828    1   DCL OUT$ PTR;
      912    15829    1   DCL IPARAM$ PTR;
      913    15830    1   DCL IN$ PTR;
      914    15831    1   DCL ARRAY_BYSZ UBIN;
      915    15832    1   DCL ARRAY_WDSZ UBIN;
      916    15833    1   DCL B$PARAMI(0:0) UBIN HALF BASED UNAL;
      917    15834    1   DCL B$BYTE UBIN BYTE BASED;
      918    15835    1   DCL B$HALF UBIN(18)  BASED;
      919    15836    1   DCL CTXHD$ PTR STATIC INIT(ADDR(NIL));
      920    15837    1   DCL CTX$ PTR;
      921    15838    1   DCL PREV$ PTR;
      922    15839    1   DCL FOUND BIT(1);
      923    15840    1   DCL MSGID UBIN WORD STATIC INIT(50);
      924    15841    1   DCL SIZE UBIN;
      925    15842    1   DCL FEX UBIN WORD;
      926    15843    1   DCL NODETYPE UBIN;
      927    15844    1   DCL PSIZ UBIN(18);
      928    15845    1   DCL CHR$PSIZ CHAR(PSIZ) BASED;
      929    15846    1   DCL FEPNAME CHAR(8);
      930    15847    1   DCL ERRC UBIN WORD;
      931    15848    1   DCL MESS$ PTR;
      932    15849    1   DCL PARM$ PTR;
      933    15850    1   DCL CNT UBIN BYTE UNAL BASED(PARM$);
      934    15851    1   DCL PARM CHAR(SIZE) UNAL BASED(PARM$);
      935    15852    1   DCL CNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
      936    15853    1   DCL CNFG$ PTR STATIC INIT(ADDR(CNFG_BUF));
      937    15854    1   DCL 1 VTXTC BASED,
      938    15855    1            2 CNT UBIN BYTE UNAL,
      939    15856    1            2 TXT CHAR(VTXTC.CNT) UNAL;
      940    15857    1   DCL ACCT CHAR(8);
      941    15858    1   DCL 1 UNAME ALIGNED,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:161  
      942    15859    1            2 C UBIN BYTE UNAL,
      943    15860    1            2 T CHAR(12) UNAL;
      944    15861    1   DCL PASS CHAR(8);
      945    15862    1   DCL 1 PRO ALIGNED,
      946    15863    1            2 C UBIN BYTE UNAL,
      947    15864    1            2 L CHAR(11) UNAL;
      948    15865    1   DCL ERR UBIN;
      949    15866    1   DCL HOSTNAME CHAR(8);
      950    15867    1   DCL NOSETUP BIT (1) ALIGNED;
      951    15868    1   DCL NOHEADER BIT (1) ALIGNED;
      952    15869        %KL$CONFIG_KEY (NAME=TCONFIG_KEY,STCLASS=AUTO);
      953    15916        %KL$DEFAULT_KEY (NAME=TDEFAULT_KEY,STCLASS=AUTO);
      954    15935        %KL$HNDLR_KEY (NAME=KL_HNDLR_KEY,
      955    15936                       STCLASS=STATIC);
      956    15955        %KL$HNDLR (NAME=KL_HNDLR,NUM=%KL_FIXED_HI,NUMI=4,LAST=NO,STCLASS=STATIC);
      957    16018    1        2 BLOCK(0:15) UBIN(18) UNAL,
      958    16019    1             2 UNBLOCK(0:15) UBIN(18) UNAL,
      959    16020    1             2 USRPARM1(0:7) UBIN(18) UNAL,
      960    16021    1             2 USRPARM2(0:7) UBIN(18) UNAL;
      961    16022        %KL$FEPCTL_KEY (NAME=KL_FEPCTL_KEY,
      962    16023                        STCLASS=STATIC);
      963    16041        %KL$FEPCTL (NAME=KL_FEPCTL,
      964    16042                    STCLASS=STATIC);
      965    16062        %KL$TERM (NAME=TERM_REC,
      966    16063                  STCLASS=STATIC);
      967    16112        %KL$TERM_KEY (NAME=TERM_KEY,
      968    16113                      STCLASS=STATIC);
      969    16159        %KL_HNDCMN_INFO (FPTN=KHA_C,
      970    16160                         STCLASS=CONSTANT);
      971    16240        %KL_NA_INFO (FPTN=NA_C,
      972    16241                     STCLASS=CONSTANT);
      973    16290        %KL$NETWORK_KEY(STCLASS=CONSTANT);
      974    16307        %KL$NETWORK (STCLASS="BASED(KL_EXTRSP_BUF$)");
      975    16334    1   DCL KL_BROADSZ UBIN WORD SYMREF;
      976    16335    1   DCL B$TCB$ PTR SYMREF;
      977    16336    1   DCL B$JIT$ PTR SYMREF;
      978    16337    1   DCL DATASIZE UBIN HALF;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:162  
      979    16338    1   DCL UBIN_HALF_BASE UBIN HALF CALIGNED BASED;
      980    16339    1   DCL LOGSYSACCT UBIN BASED;
      981    16340        /**/
      982    16341        %FPT_WRITE (FPTN=WRT_ACCTLG,DCB=M$ACCTLG);
      983    16372        %FPT_TIME (TSTAMP=TSTAMP, SOURCE=FUTS, DEST=UTS);
      984    16391    1   DCL TSTAMP UBIN STATIC;
      985    16392        %G$ACC_HDR (FPTN=G$ACC_UNPK,STCLASS="BASED(KL_RDBF$)",LAST=NO);
      986    16414        %G$ACC (HOST_TYPE=UNPACKED,LVL=2);
      987    16484        %AZ_LCP6_JSP (NAME=G@ACC_PKD,INCLUDE_GJIT=NO,STCLASS=AUTO);
      988    16962        %LOGOFF$PARAM (STCLASS=AUTO);
      989    17003        %G$ACC (FPTN=G$ACC,STCLASS=BASED,HOST_TYPE=PACKED);
      990    17073        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:163  
      991    17074        /* FPTs and such */
      992    17075        %FPT_PRECORD (FPTN=STARTNETWORK,KEYS=YES,KEY=CNFG_BUF,DCB=M$NETWORK);
      993    17096        %FPT_READ (FPTN=KL_RDHLPR,STCLASS=SYMREF);
      994    17135        %FPT_READ (FPTN=KL_RDPROR,STCLASS=SYMREF);
      995    17174        %FPT_WRSYSLOG (FPTN=FPT_WRSYSLOG,SIZE="SIZEW(KL_PCD.ADDD)",
      996    17175                 ENTRY=KL_PCD,TYPE=EL_CONN,FILENUM=ACCOUNTING);
      997    17190        %FPT_WRSYSLOG (FPTN=FPT_WRFEPERR,STCLASS=STATIC,
      998    17191                 TYPE=EL_FEPERR,FILENUM=ERRLOG);
      999    17206        %FPT_WAIT (FPTN=FPT_WAIT,STCLASS=CONSTANT,UNITS=1);
     1000    17220        %FPT_READ (FPTN=KL_RD_NETCON,STCLASS=SYMREF);
     1001    17259        %FPT_WRITE (FPTN=KL_WR_NETCON,STCLASS=SYMREF);
     1002    17290        %VLP_NAME (FPTN=NETCON,
     1003    17291                   NAME=':NETCON');
     1004    17318        %VLP_ACCT (FPTN=SYSACCT,
     1005    17319                   ACCT=':SYS');
     1006    17332        %VLP_ERRCODE (FPTN=NOFPRG,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$NFPRG,SEV
             17332            =4);
     1007    17377        %VLP_ERRCODE (FPTN=ILGL,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$ILGL,SEV=4)
             17377            ;
     1008    17422        %VLP_ERRCODE (FPTN=ELGL,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$ELGL,SEV=4)
             17422            ;
     1009    17467        %VLP_ERRCODE (FPTN=NODENA,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$NODENA,
             17467            SEV=4);
     1010    17512        %VLP_ERRCODE (FPTN=NOFE,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$NOFE,SEV=4)
             17512            ;
     1011    17557        %FPT_WRITE (FPTN=WRT_FROG,STCLASS=SYMREF);
     1012    17588        %FPT_WRITE (FPTN=WRITE_MONKEY,
     1013    17589                    DCB=M$CSCG,
     1014    17590                    BUF=JC_CSMBF,
     1015    17591                    STATION=MONKEY);
     1016    17622        %VLP_STATION (FPTN=MONKEY,
     1017    17623                      STATION='MONKEY');
     1018    17650        %FPT_READ (FPTN=KL_RD_NETWORK,STCLASS=SYMREF);
     1019    17689        %FPT_WRITE (FPTN=KL_WR_NETWORK,STCLASS=SYMREF);
     1020    17720        %FPT_TIME (FPTN=KL_NETWORK_TIME,STCLASS=SYMREF);
     1021    17739        %FPT_DELREC (FPTN=KL_DR_NETWORK,STCLASS=SYMREF);
     1022    17758        %FPT_PRECORD (FPTN=KL_PR_NETWORK,STCLASS=SYMREF);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:164  
     1023    17779        %FPT_READ (FPTN=RD_NETCON,KEYR=YES,DCB=M$NETCON,BUF=CNFG_BUF);
     1024    17818        %FPT_PRECORD (DCB=M$NETCON,KEYS=YES,KEY=CONFIG_KEY);
     1025    17839        %FPT_WRITE (FPTN=WRT_NA2FROG,STCLASS=SYMREF);
     1026    17870        %FPT_FECTL (FPTN=HLTFEP,HALT=YES,STCLASS=STATIC);
     1027    17885        %FPT_FECTL (FPTN=GOFEP,STCLASS=STATIC,START=YES);
     1028    17900        %FPT_FECTL (FPTN=STOPFEP,STCLASS=STATIC,STOP=YES);
     1029    17915        %FPT_WRITE (FPTN=WKBER,DCB=M$CSCG);
     1030    17946        %FPT_WRITE (FPTN=WBHS,STCLASS=STATIC,DCB=M$HLP,STATION=FESTA);
     1031    17977        %VLP_STATION (FPTN=FESTA,STCLASS=STATIC);
     1032    18004        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:165  
     1033    18005        /* File structures */
     1034    18006        %KL_LINE_KEY (FPTN=KL$LINE_KEY,STCLASS="BASED(CNFG$)");
     1035    18056        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:166  
     1036    18057        /* Administrative message structures */
     1037    18058        %KL$ADMES (NAME=FEPW,CODE=IGA_SSPW,MSG='88888888',STCLASS=STATIC);
     1038    18064        %KL$ADMES (NAME=BOOTMSG,CODE=IGA_BOOTFEP,MSG=' ',STCLASS=STATIC);
     1039    18070        %VLP_ERRCODE(FPTN=E$DEFSTP,STCLASS=CONSTANT,FCG=KL,MID=H,MON='1'B,ERR#=%E$FEPSTOPPED
             18070            );
     1040    18115        %KL$CONFIG_KEY (NAME=CONFIG_KEY,STCLASS=STATIC);
     1041    18162        %KL$DEFAULT_KEY (NAME=DEFAULT_KEY,STCLASS=STATIC);
     1042    18181        %KL_HNDCMN_INFO (FPTN=HNDCMN,STCLASS=BASED);
     1043    18261        %KL$LINCNFG (NAME=LINCNFG,STCLASS="BASED(CNFG$)",LGNSIZ=100);
     1044    18419        %KL_CHNRSP (FPTN=KL_CHNRSPC,STCLASS=CONSTANT);
     1045    18639        %KL_ACCTNG (NAME=KL$ACCTNG,STCLASS=BASED);
     1046    18653        %KL_CHNRSP (FPTN=CHNRSP,STCLASS="BASED(KL_EXTRSP_BUF$)",MSGSIZE=PSIZ);
     1047    18873        %KL_CHNRSP (FPTN=KL$CHNRSP,STCLASS="BASED(KL_EXTRSP_BUF$)",MSGSIZE=2);
     1048    19093        %KL_ADMES (NAME=STPMSG,CODE=IGA_STOPFEP,STCLASS=STATIC,TYP=1);
     1049    19099        %KL_MES (FPTN=CRASHFEP_BF,CODE=IGA_CRASHFEP_BF,STCLASS=STATIC);
     1050    19122        %KL_ADMES (NAME=BCHS,STCLASS=STATIC,CODE=IGA_BCST,TYP=IGAT_SEND);
     1051    19128        %KL_ADMSR (NAME=KL_HDRMSG,STCLASS=SYMREF);
     1052    19134        %KL_STRTU (FPTN=KL$STRTU,STCLASS="BASED(RDBF$)");
     1053    19307        %KL_AFD (FPTN=KL$AFD,STCLASS="BASED(RDBF$)");
     1054    19347        %KL_CWNAK (FPTN=KL$CWNAK,STCLASS="BASED(RDBF$)");
     1055    19412        %KL_CWNAK (FPTN=CWNAK,STCLASS=AUTO);
     1056    19477        %KL_RQSCHN (FPTN=KL$RQSCHN,STCLASS="BASED(RDBF$)");
     1057    19580        %KL_ADMIN (FPTN=KL$ADMIN,STCLASS="BASED(RDBF$)");
     1058    19740        %KL_RUE (FPTN=KL$RUE,STCLASS="BASED(RDBF$)");
     1059    19843        %KL_REQSTATS (NAME=KL$REQSTATS,STCLASS="BASED(RDBF$)");
     1060    20136
     1061    20137        %KL_CONTROL_INIT (FPTN=KL$CONTROL_INIT,NUM_FIXED=%KL_FIXED_HI,NUM_INDXD=4,STCLASS=
             20137            "BASED(RDBF$)",LAST=NO);
     1062    20262    1        2 BLOCK(0:15) UBIN(18) UNAL,
     1063    20263    1             2 UNBLOCK(0:15) UBIN(18) UNAL,
     1064    20264    1             2 USRPARM1(0:7) UBIN(18) UNAL,
     1065    20265    1             2 USRPARM2(0:7) UBIN(18) UNAL;
     1066    20266
     1067    20267        %KL_CONTROL_INIT (FPTN=KL$$CONTROL_INIT,STCLASS=BASED,NUM_FIXED=%KL_FIXED_HI);
             20267            /*fixed portion only */
     1068    20392
     1069    20393        %KL_CONTROL (FPTN=KL$CONTROL,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:167  
     1070    20394                     STCLASS="BASED(RDBF$)");
     1071    20530        %KL_CNFG_MSG (FPTN=KL$CNFG_MSG,
     1072    20531                      STCLASS="BASED(RDBF$)");
     1073    20814        %KL_KEYMES (FPTN=KL$KEYMES,STCLASS="BASED(KL_RDBF$)",NPARMS=1);
     1074    20953        %KL_DVCERRRSP (FPTN=KL_DVCERRRSP,STCLASS=STATIC);
     1075    21006        %KL_ADMIN (FPTN=ADMIN,STCLASS=STATIC);
     1076    21166        %KL_RUE (FPTN=RUE,STCLASS=STATIC);
     1077    21269        %KL_PCD (FPTN=KL_PCD,CG=1,STCLASS=SYMREF);
     1078    21434        %KL_NODEINFO (FPTN=KL$NODEINFO,STCLASS="BASED(KL_RDBF$)");
     1079    21458        %KL_NODECHG (FPTN=KL$NODECHG,STCLASS="BASED(KL_RDBF$)");
     1080    21482        %KL_SYSLOG (FPTN=KL$SYSLOG,STCLASS="BASED(KL_RDBF$)",LAST=",");
     1081    21506        %KL_ERRLOG (FPTN=ERRLOG,STCLASS=BASED,LAST=",",LVL=2);
     1082    21613    1        3 DATA CHAR(SIZE) CALIGNED;
     1083    21614        %KL_UPDOSI(FPTN=KL$UPDOSI,STCLASS="BASED(KL_RDBF$)");
     1084    21823        %KL_OSILINKCHG(FPTN=KL$OSILINKCHG,STCLASS="BASED(KL_RDBF$)");
     1085    21946        %KL_ERRMSG_RQS (FPTN=KL$ERRMSG_RQS,FILE_PARAMS=YES,STCLASS="BASED(KL_RDBF$)");
     1086    22031        %KL_ERRMSG_RSP (FPTN=KL$ERRMSG_RSP,LONG=NO,STCLASS=BASED);
     1087    22107        %KL_ERRMSG_RSP (FPTN=KL@ERRMSG_RSP,STCLASS=AUTO,LONG=YES);
     1088    22183        %KL_LINE_KEY (FPTN=OSILINK_KEY,STCLASS=AUTO); /* key for snpa records in :network*/
     1089    22233        %KL_OSILINK_REC(FPTN=OSILINK_BUF,STCLASS=AUTO);
     1090    22281        %KL_OSILINKCHG(FPTN=OSILINKCHG,STCLASS=AUTO);
     1091    22404        %FPT_ERRMSG (FPTN=FPT@ERRMSG,STCLASS=AUTO);
     1092    22431        %VLR_ERRMSG (FPTN=VLR@ERRMSG,STCLASS=AUTO);
     1093    22453        %FPT_ERRMSG (STCLASS=CONSTANT,L6_CODE=YES);
     1094    22480        %KL_TIME (FPTN=KL$TIME,STCLASS="BASED(KL_RDBF$)");
     1095    22504        %KL_CONFIGRSP (FPTN=KL$CONFIGRSP,STCLASS="BASED(KL_RDBF$)");
     1096    22595        %KL_RSPPND (FPTN=KL$RSPPND,STCLASS="BASED(CTX$)");
     1097    22626        %KL_DUMPMSG (FPTN=KL$DUMPMSG,STCLASS="BASED(RDBF$)",DSIZE=DATASIZE);
     1098    22667        %KL_DUMPMSG (FPTN=KL$DUMPABORT,STCLASS=AUTO,DSIZE=1);
     1099    22708        %EL$FEPERR (NAME=FEPERR,STCLASS=AUTO);
     1100    22787        %KL_DREC (NAME=KL$DREC,STCLASS="BASED(PARM$)",LAST=",");
     1101    22900        %KL_FEBLK (NAME=FEBLK,STCLASS=BASED,LVL=2,LAST=",");
     1102    22949        %KL_GJOB (NAME="GJOB REDEF FEBLK",STCLASS=BASED,LVL=2,LAST=",");
     1103    22973    1                 3 * CHAR(188);
     1104    22974        %KL_NODECHG (FPTN=NODECHG,STCLASS=AUTO);
     1105    22998        %KL_FEPST(FPTN=KL$FEPST,STCLASS="BASED(KL_RDBF$)");
     1106    23033        %KL_DREC (NAME=KL_HLPR,STCLASS=SYMREF,LAST=",");
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:168  
     1107    23146        %KC$CGID (FPTN=CGID,STCLASS=SYMREF,LVL=2,LAST=",");
     1108    23172    1            2 INFO(0:31) UBIN WORD UNAL;
     1109    23173        %ES$SECLOG(NAME=ES$SECLOG,STCLASS=STATIC);
     1110    23450        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
     1111    23451                  ENTRY=ES$SECLOG,
     1112    23452                  FILENUM=EL_SEC,
     1113    23453                  SIZE="SIZEW(ES$SECLOG)",
     1114    23454                  TYPE=EL_SYS_ACCESS);
     1115    23469    1   DCL ES_LOGSYSACC UBIN WORD SYMREF;      /* Symdefed in ES_CNTRL_D             */
     1116    23470    1   DCL ES$ PTR STATIC INIT(ADDR(ES_LOGSYSACC));
     1117    23471        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:169  
     1118    23472        /* Keyin templates */
     1119    23473        %OC_MESSHD_W (NAME=FEPACCTL,STCLASS="CONSTANT ALIGNED",NPARMS=1,ATR=M_SYS,
     1120    23474                      MSG=OWALG_MSG#);
     1121    23487    1        2 MCNT UBIN(9) UNAL INIT(LENGTHC(FEPACCTL.MESS#)),
     1122    23488    1             2 MESS# UBIN(9) UNAL INIT(5); /* cant write fep accounting records */
     1123    23489        %OC_MESSHD_W (NAME=CKBR,STCLASS="CONSTANT ALIGNED",NPARMS=5);
     1124    23502    1            2 FCNT UBIN(9) UNAL INIT(LENGTHC(KBERR.FEX)),
     1125    23503    1            2 ECNT UBIN(9) UNAL INIT(LENGTHC(KBERR.ERR)),
     1126    23504    1            2 PCNT UBIN(9) UNAL INIT(LENGTHC(KBERR.PORT)),
     1127    23505    1            2 P2CNT UBIN(9) UNAL INIT(LENGTHC(KBERR.PORT_HI)),
     1128    23506    1            2 NCNT UBIN(9) UNAL INIT(LENGTHC(KBERR.NAME)),
     1129    23507    1            2 FEX UBIN(9) UNAL INIT(0),
     1130    23508    1            2 ERR UBIN(9) UNAL INIT(0),
     1131    23509    1            2 PORT,
     1132    23510    1                 3 T UBIN(10) UNAL INIT(0),
     1133    23511    1                 3 B UBIN(8) UNAL INIT(0),
     1134    23512    1            2 PORT_HI,
     1135    23513    1                 3 T UBIN(10) UNAL INIT(0),
     1136    23514    1                 3 B UBIN(8) UNAL INIT(0),
     1137    23515    1            2 NAME CHAR(8) UNAL INIT(' ');
     1138    23516        %OC$MESSHD (NAME=FEPMES,STCLASS="",ALGN=ALIGNED);
     1139    23530    1            2 FCNT UBIN BYTE UNAL,
     1140    23531    1            2 FNCNT UBIN BYTE UNAL,
     1141    23532    1            2 MSG CHAR(80) UNAL;
     1142    23533        %OC$MESSHD (NAME=KBERR,STCLASS="");
     1143    23547    1            2 FCNT UBIN(9) UNAL,
     1144    23548    1            2 ECNT UBIN(9) UNAL,
     1145    23549    1            2 PCNT UBIN(9) UNAL,
     1146    23550    1            2 P2CNT UBIN(9) UNAL,
     1147    23551    1            2 NCNT UBIN(9) UNAL,
     1148    23552    1            2 FEX UBIN(9) UNAL,
     1149    23553    1            2 ERR UBIN(9) UNAL,
     1150    23554    1            2 PORT,
     1151    23555    1                 3 T UBIN(10) UNAL,
     1152    23556    1                 3 B UBIN(8) UNAL,
     1153    23557    1            2 PORT_HI,
     1154    23558    1                 3 T UBIN(10) UNAL,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:170  
     1155    23559    1                 3 B UBIN(8) UNAL,
     1156    23560    1            2 NAME CHAR(8) UNAL;
     1157    23561    1   DCL 1 PSEUDO BASED,
     1158    23562    1            2 NAME CHAR(8) UNAL,
     1159    23563    1            2 MAX(0:3) UBIN HALF UNAL;
     1160    23564        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:171  
     1161    23565        /* Based local structures */
     1162    23566    1   DCL 1 CADDR BASED UNAL,
     1163    23567    1            2 TOP BIT(8) UNAL,
     1164    23568    1            2 MID BIT(8) UNAL,
     1165    23569    1            2 BOT BIT(8) UNAL;
     1166    23570    1   DCL B$TERMNAME CHAR(8) BASED;
     1167    23571    1   DCL 1 TEXT$C BASED,
     1168    23572    1            2 L UBIN BYTE UNAL,
     1169    23573    1            2 C CHAR(TEXT$C.L);
     1170    23574        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:172  
     1171    23575        /* Entry references */
     1172    23576    1   DCL AZA$FEPACCTNG ENTRY(1) ALTRET;
     1173    23577    1   DCL JGG$TGJOB ENTRY(4);
     1174    23578    1   DCL KLC$CONFIG ENTRY;
     1175    23579    1   DCL KLI$LINEPRO ENTRY(3);
     1176    23580    1   DCL KLI$UPDATE ENTRY;
     1177    23581    1   DCL KLH$SGSCAN ENTRY(9) ALTRET;
     1178    23582    1   DCL KLX$CONV_NODENAME ENTRY(3) ALTRET;
     1179    23583    1   DCL KLX$CONV_NODE ENTRY(3) ALTRET;
     1180    23584    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
     1181    23585    1   DCL KLX$WRHLPSTA  ENTRY(4) ALTRET;
     1182    23586    1   DCL KLX$8TO9 ENTRY(3);
     1183    23587    1   DCL KLX$9TO8 ENTRY(3);
     1184    23588    1   DCL KLX$ERR2NETERR ENTRY(2);
     1185    23589    1   DCL KLB$GET ENTRY(2) ALTRET;
     1186    23590    1   DCL KLB$REL ENTRY(1) ALTRET;
     1187    23591    1   DCL XUR$ERRCNVRT ENTRY(2);
     1188    23592    1   DCL XUR$ERRTOLCP6 ENTRY(2);
     1189    23593    1   DCL JMU$SETSEG ENTRY(2);
     1190    23594    1   DCL KLH$ERRMSG ENTRY(3);
     1191    23595    1   DCL KLI$GETSNPA ENTRY(1);
     1192    23596    1   DCL KLI$GETFEPERA ENTRY(2);
     1193    23597        /**/
     1194    23598        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:173  
     1195    23599        /**/
     1196    23600    1        RDBF$=ADDR(KL_RDBF);
     1197    23601    1        KBERR=CKBR;
     1198    23602    2        DO CASE (KMSG.KIN#);
     1199    23603
     1200    23604    2        CASE (KEY_FEPS#);
     1201    23605    2           I = %KL_NODETYPE_FEP;
     1202    23606    2   DO_DISP_NODES: ;
     1203    23607    2           CALL KCHK ALTRET(KBD);
     1204    23608    2           KL_FEMSG.MSG# = FEUP_MSG#;
     1205    23609    2           KL_FEMSG.CADDR = KMSG.CADDR;
     1206    23610    2           WKBER.BUF_ = VECTOR(KL_FEMSG);
     1207    23611    3           DO FEX = FEX TO KL_MXFE;
     1208    23612    3                CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,NODETYPE)
     1209    23613    4                WHENRETURN DO;
     1210    23614    4                     IF KL_FETBL.HOST_NODE(FEX)
     1211    23615    4                     THEN
     1212    23616    4                          KL_FEMSG.STATE = 1;
     1213    23617    4                     ELSE
     1214    23618    4                          KL_FEMSG.STATE = 0;
     1215    23619    4                     IF KL_FETBL.ACTIVE(FEX)
     1216    23620    4                     THEN
     1217    23621    4                          KL_FEMSG.PROB = 1;
     1218    23622    4                     ELSE
     1219    23623    4                          KL_FEMSG.PROB = 2;
     1220    23624    4                     KL_FEMSG.FEX = FEX;
     1221    23625    4                     IF I = 0 OR NODETYPE = I OR (I = %KL_NODETYPE_HOST AND NODETYPE =
             23625                              %KL_NODETYPE_ME)
     1222    23626    4                          AND KL_FEMSG.NAME ~= ' '
     1223    23627    4                     THEN
     1224    23628    4                          CALL M$WRITE(WKBER)
     1225    23629    5                          WHENALTRETURN DO;
     1226    23630    5                             END;
     1227    23631    4                   END;
     1228    23632    3                IF KMSG.FEX ~= 0
     1229    23633    3                THEN
     1230    23634    3                     EXIT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:174  
     1231    23635    3              END;
     1232    23636    2           KL_FEMSG.CADDR = M_COMM;
     1233    23637
     1234    23638    2        CASE(KEY_NODES#);
     1235    23639    2           I = 0;
     1236    23640    2           GOTO DO_DISP_NODES;
     1237    23641
     1238    23642    2        CASE(KEY_HOSTS#);
     1239    23643    2           I = %KL_NODETYPE_HOST;
     1240    23644    2           GOTO DO_DISP_NODES;
     1241    23645
     1242    23646    2        CASE (KEY_FEPW#);
     1243    23647    2           IF KMPW.FEPW.CNT>7 THEN KMPW.FEPW.CNT=7;
     1244    23648    2           KL_FEPW=KMPW.FEPWT;
     1245    23649    2           FEPW.MSG_=KL_FEPW;
     1246    23650    3           DO FEX=1 TO KL_MXFE;
     1247    23651    3                CALL KLX$WRHLPNODE(FEPW,SIZEC(FEPW),FEX);
     1248    23652    3   PWON:        ;
     1249    23653    3              END;
     1250    23654
     1251    23655    2        CASE (KEY_XFEP#);
     1252    23656    2           RUE.EVENT# = %GH_EVABRT;
     1253    23657    2   DOKEYX: ;
     1254    23658    2           CALL KCHK ALTRET(KBD);
     1255    23659    2           RUE.ORIGIN = 'KEYIN';
     1256    23660    2           RUE.SYSID# = ENABLE_KEYIN.LINE_LOW#/256 * 512 + MOD(ENABLE_KEYIN.LINE_LOW#,
             23660                    256);
     1257    23661    2           CALL KLX$WRHLPNODE (RUE,SIZEC(RUE),FEX) ALTRET(FEPK_ERR);
     1258    23662
     1259    23663    2        CASE(KEY_EFEP#);
     1260    23664    2           RUE.EVENT# = %GH_EVERR;
     1261    23665    2           GOTO DOKEYX;
     1262    23666
     1263    23667    2        CASE (KEY_BOOTFEP#);
     1264    23668    2           CALL KCHK ALTRET (KBD);
     1265    23669    2           ERRC=KL_FETBL.KTYP(FEX);
     1266    23670    2           KL_FETBL.KTYP(FEX)=%KLKT_BOOT#;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:175  
     1267    23671    2           CALL BDSET ALTRET (ERRORK);
     1268    23672    2        CASE (KEY_DUMPFEP#);
     1269    23673    2           CALL KCHK ALTRET (KBD);
     1270    23674    2           CALL LOCAL_CHECK
     1271    23675    3           WHENRETURN DO;
     1272    23676    3                ERRC=KL_FETBL.KTYP(FEX);
     1273    23677    3                KL_FETBL.KTYP(FEX)=%KLKT_DUMP#;
     1274    23678    3                CALL BDSET ALTRET (ERRORK);
     1275    23679    3              END;
     1276    23680
     1277    23681
     1278    23682    2        CASE (KEY_CRASHFEP#);
     1279    23683    2           CALL KCHK ALTRET (KBD);
     1280    23684    2           ERRC=KL_FETBL.KTYP(FEX);
     1281    23685    2           KL_FETBL.KTYP(FEX)=%KLKT_CRASH#;
     1282    23686    2           CALL BDSET ALTRET (ERRORK);
     1283    23687
     1284    23688
     1285    23689    2        CASE (KEY_STARTFEP#);
     1286    23690    2           CALL KCHK ALTRET(KBD);
     1287    23691    2           IF FEX>KL_MXFE THEN GOTO BDFEX;
     1288    23692    2           IF FEX~=0
     1289    23693    2           THEN
     1290    23694    2                CALL LOCAL_CHECK
     1291    23695    3                WHENRETURN DO;
     1292    23696    3                     CALL STFEP ALTRET(ERROR);
     1293    23697    3                   END;
     1294    23698    2           ELSE
     1295    23699    3           DO FEX=1 TO KL_MXFE;
     1296    23700    3                IF KL_FETBL.LINK_CONNECT(FEX) AND NOT KL_FETBL.HOST_NODE(FEX)
     1297    23701    3                THEN
     1298    23702    3                     CALL STFEP;
     1299    23703    3              END;
     1300    23704
     1301    23705
     1302    23706    2        CASE (KEY_STOPFEP#);
     1303    23707    2           CALL KCHK ALTRET (KBD);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:176  
     1304    23708    2           IF KMSG.FID.CNT = 0
     1305    23709    3           THEN DO;
     1306    23710    3                LEN = SIZEC(KMSG.FID.TXT);
     1307    23711    3                CALL KLH$ERRMSG(STPMSG.MSG_,LEN,E$DEFSTP);
     1308    23712    3                KMSG.FID.CNT = LEN; /* actual size of errmsg and so well send message*/
     1309    23713    3              END;
     1310    23714    2           IF FEX ~= 0
     1311    23715    2           THEN
     1312    23716    2                CALL LOCAL_CHECK
     1313    23717    3                WHENRETURN DO;
     1314    23718    3                     IF KL_FETBL.QOS ( FEX ) = 255 THEN
     1315    23719    3                          CALL STFEPNM ALTRET ( STPERR ) ;
     1316    23720    3                     ELSE CALL STPFEP ALTRET (STPERR);
     1317    23721    3                   END;
     1318    23722    2           ELSE
     1319    23723    3           DO FEX=1 TO KL_MXFE;
     1320    23724    3                IF KL_FETBL.LINK_CONNECT(FEX) AND NOT KL_FETBL.HOST_NODE(FEX)
     1321    23725    3                     AND KL_FETBL.BOSS(FEX)
     1322    23726    3                THEN
     1323    23727    3                     CALL STPFEP;
     1324    23728    3              END;
     1325    23729
     1326    23730
     1327    23731    2        CASE (KEY_HARDSTP#);
     1328    23732    2           CALL KCHK ALTRET (KBD);
     1329    23733    2           IF FEX ~= 0
     1330    23734    2           THEN
     1331    23735    2                CALL LOCAL_CHECK
     1332    23736    3                WHENRETURN DO;
     1333    23737    3                     CALL STFEPNM ALTRET(STPERR);
     1334    23738    3                   END;
     1335    23739    2           ELSE
     1336    23740    3           DO FEX=1 TO KL_MXFE;
     1337    23741    3                IF KL_FETBL.LINK_CONNECT(FEX) AND NOT KL_FETBL.HOST_NODE(FEX)
     1338    23742    3                THEN
     1339    23743    3                     CALL STFEPNM;
     1340    23744    3              END;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:177  
     1341    23745
     1342    23746
     1343    23747    2        CASE (KEY_HEAD#);
     1344    23748    2           BCHS.CODE_=IGA_HDR;
     1345    23749    2           GOTO BCST;
     1346    23750
     1347    23751
     1348    23752    2        CASE (KEY_BROAD#);
     1349    23753    2           BCHS.CODE_=IGA_BCST;
     1350    23754    2   BCST:   ;
     1351    23755    2           KL_BROADSZ=KBCHS.CNT;
     1352    23756    2           KL_HDRMSG.MSG_=KBCHS.MSG;
     1353    23757    2           GOTO SALL;
     1354    23758
     1355    23759
     1356    23760    2        CASE (KEY_SALL#);
     1357    23761    2           BCHS.CODE_=IGA_SALL;
     1358    23762    2   SALL:   ;
     1359    23763    2           BCHS.TYP_ = 0;
     1360    23764    2           BCHS.MSG_=KBCHS.MSG;
     1361    23765    2           LEN=LENGTHC(BCHS)-LENGTHC(BCHS.MSG_)+KBCHS.CNT;
     1362    23766    3           DO FEX=0 TO KL_MXFE;
     1363    23767    3                IF KL_FETBL.BOSS(FEX) AND NOT KL_FETBL.DEBUG(FEX)
     1364    23768    3                THEN
     1365    23769    3                     CALL KLX$WRHLPNODE(BCHS,LEN,FEX) ALTRET (BHSON);
     1366    23770    3   BHSON:       ;
     1367    23771    3              END;
     1368    23772
     1369    23773
     1370    23774    2        CASE (KEY_SENDFEP#);
     1371    23775    2           CALL KCHK ALTRET(KBD);
     1372    23776    2           BCHS.CODE_=IGA_SALL;
     1373    23777    2           BCHS.TYP_ = FEX;
     1374    23778    2           BCHS.MSG_=KBCHS.MSG;
     1375    23779    2           LEN=LENGTHC(BCHS)-LENGTHC(BCHS.MSG_)+KBCHS.CNT;
     1376    23780    2           CALL KLX$WRHLPNODE(BCHS,LEN,FEX) ALTRET (BHSON1);
     1377    23781        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:178  
     1378    23782    2           CALL KLX$WRHLPNODE(BCHS,LEN,KL_NODE) ALTRET (BHSON1);
     1379    23783
     1380    23784    2        CASE(KEY_FIRMLOAD#);
     1381    23785    2   FRWD:   ;                               /* Forward this to MONKEY */
     1382    23786    2           DVCKYN_FRWD.RTN# = 2;  /*N* RTNX OF NIK$KEYIN SHOULD BE A SUB */
     1383    23787    2           WRITE_MONKEY.BUF_.BOUND = 11;   /* Valid part of message */
     1384    23788    2           CALL M$WRITE(WRITE_MONKEY) ALTRET(DVCERR);
     1385    23789        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:179  
     1386    23790    2        CASE(KEY_DEVS#);
     1387    23791    2           WKBER.BUF_ = VECTOR(FEPMES);
     1388    23792    2           FEPMES.CADDR = DVCKYN.CADDR;
     1389    23793    2           KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     1390    23794    2           IF DVCKYN.DEVNM ~= ' ' THEN
     1391    23795    3           DO;
     1392    23796        /*
     1393    23797             a device name was specified
     1394    23798        */
     1395    23799    3                KL_NETWORK_KEY.KEY = '0'B;
     1396    23800    3                KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     1397    23801    3                CALL M$PRECORD(KL_PR_NETWORK)
     1398    23802    3                WHENRETURN
     1399    23803    4                DO;
     1400    23804    4                     CALL M$READ (KL_RD_NETWORK) ALTRET(FRWD);
     1401    23805    4                   END;
     1402    23806    3                WHENALTRETURN
     1403    23807    4                DO;                        /* it is expected */
     1404    23808    4                     CALL M$READ (KL_RD_NETWORK)
     1405    23809    4                     WHENALTRETURN
     1406    23810        /*
     1407    23811             no devices exist forward the keyin to monkey
     1408    23812        */
     1409    23813    5                     DO;
     1410    23814    5                          GOTO FRWD;
     1411    23815    5                        END;
     1412    23816    4                   END;
     1413    23817    4                DO WHILE '1'B;
     1414    23818    4                     IF SUBSTR(KL_NETWORK_BUF.DEVNM,0,4) = DVCKYN.DEVNM THEN
     1415    23819    5                     DO;
     1416    23820    5                          IF CTXHD$ = ADDR(NIL) THEN
     1417    23821    5                               GOTO NOKEYINS;
     1418    23822    5                          ELSE
     1419    23823    5                               GOTO KEYINS;
     1420    23824    5                        END;
     1421    23825    4                     CALL M$PRECORD(KL_PR_NETWORK) ALTRET(FRWD);
     1422    23826    4                     CALL M$READ(KL_RD_NETWORK) ALTRET(FRWD);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:180  
     1423    23827    4                   END;
     1424    23828    3              END;                         /* if twsn ~= ' ' */
     1425    23829
     1426    23830    2           IF CTXHD$ = ADDR(NIL) THEN
     1427    23831    3   NOKEYINS: DO;
     1428    23832    3                FEPMES.MSG# = NFEPKIPND_MSG#;
     1429    23833    3                FEPMES.NPARAMS = 0;
     1430    23834    3                FEPMES.FCN = OC_WR;
     1431    23835    4                CALL M$WRITE(WKBER) WHENALTRETURN DO;
     1432    23836    4                   END;                    /* WHENALTRETURN */
     1433    23837    3              END;                         /* IF CTXHD$ = ADDR(NIL) */
     1434    23838    2           ELSE
     1435    23839    3   KEYINS: DO;
     1436    23840    3                CTX$ = CTXHD$;
     1437    23841    4                DO WHILE(CTX$ ~= ADDR(NIL));
     1438    23842    4                     FEPMES.DEVNM = DVCERRCTX.DEVNM;
     1439    23843    4                     FEPMES.MSG# = KIPND_MSG#;
     1440    23844    4                     FEPMES.FCN = OC_WR;
     1441    23845    4                     FEPMES.NPARAMS = 1;
     1442    23846    4                     FEPMES.FCNT = 1;
     1443    23847    4                     IF DVCERRCTX.KEYIN_REQ
     1444    23848    4                     THEN
     1445    23849    4                          FEPMES.FNCNT = 4;
     1446    23850    4                     ELSE
     1447    23851    4                          FEPMES.FNCNT = 3;
     1448    23852    4                     IF SUBSTR(DVCERRCTX.DEVNM,4,4) = DVCKYN.TWSN
     1449    23853    4                     THEN
     1450    23854    5                          CALL M$WRITE(WKBER) WHENALTRETURN DO;
     1451    23855    5                             END;          /* WHENALTRETURN */
     1452    23856    4                     CTX$ = DVCERRCTX.LNK$;
     1453    23857    4                   END;                    /* DO WHILE */
     1454    23858    3              END;                         /* ELSE */
     1455    23859    2           IF DVCKYN.DEVNM = ' ' THEN
     1456    23860    2                GOTO FRWD;
     1457    23861    2           KL_NETWORK_KEY.KEY = '0'B;      /* reset the key */
     1458    23862    2           KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     1459    23863    2           RETURN;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:181  
     1460    23864        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:182  
     1461    23865    2        CASE(KEY_QUIET#,KEY_RETRY#,KEY_ERROR#,KEY_PROCEED#);
     1462    23866    2           TWSN_KEY.TWSN = DVCKYN.TWSN;
     1463    23867    2           READ_HLPF.BUF_.BOUND = 2047;
     1464    23868    2           CALL M$READ(READ_HLPF) ALTRET(FRWD);
     1465    23869    3           DO I = 0 TO TWSN_REC.NDEV - 1;
     1466    23870    3                CALL CONCAT(DEVNM,TWSN_REC.DEVS.TYP(I),TWSN_REC.DEVS.NUM(I));
     1467    23871    4                IF DEVNM = DVCKYN.DEVNM THEN DO;
     1468    23872    4                     IF TWSN_REC.DEVS.TDEV(I) THEN GOTO DVCERR;
     1469    23873    4                     IF TWSN_REC.DEVS.IOM_CONNECTED(I) THEN GOTO FRWD;
     1470    23874                            /* If we get here its a KEYIN for a FEP connected device */
     1471    23875    5                     DO CASE(DVCKYN.KIN#);
     1472    23876    5                     CASE(KEY_ERROR#,KEY_PROCEED#,KEY_RETRY#,KEY_QUIET#);
     1473    23877    5                        CALL CONCAT(DEVNM_TWSN,DEVNM,DVCKYN.TWSN);
     1474    23878    5                        CTX$ = CTXHD$;
     1475    23879    6                        DO WHILE(CTX$ ~= ADDR(NIL));
     1476    23880    7                             IF DVCERRCTX.DEVNM = DEVNM_TWSN THEN DO;
     1477    23881    7                                  FEPMES.DEVNM = DEVNM_TWSN;
     1478    23882    7                                  FEPMES.FCN = OC_STTM;
     1479    23883    7                                  FEPMES.CADDR = M_DEVC;
     1480    23884    7                                  FEPMES.MSGID = DVCERRCTX.MSGID;
     1481    23885    7                                  FEPMES.NPARAMS = 0;
     1482    23886    7                                  WKBER.BUF_ = VECTOR(FEPMES);
     1483    23887    8                                  CALL M$WRITE(WKBER) WHENALTRETURN DO;
     1484    23888    8                                     END;  /* WHENALTRETURN */
     1485    23889    7                                  KL_DVCERRRSP.KYN# = DVCKYN.KIN#;
     1486    23890    7                                  KL_DVCERRRSP.TERMID = DVCERRCTX.TERMID;
     1487    23891    7                                  FEX = DVCERRCTX.FEX;
     1488    23892    7                                  LEN = SIZEC(KL_DVCERRRSP);
     1489    23893    8                                  CALL KLX$WRHLPNODE(KL_DVCERRRSP,LEN,FEX)
             23893                                           WHENALTRETURN DO;
     1490    23894    8                                       GOTO DVCERR;
     1491    23895    8                                     END;  /* WHENALTRETURN */
     1492    23896    7                                  GOTO RTN;
     1493    23897    7                                END;       /* IF */
     1494    23898    6                             CTX$ = DVCERRCTX.LNK$;
     1495    23899    6                           END;            /* DO WHILE */
     1496    23900        /* If we got here the spec'd device was not expecting a KEYIN */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:183  
     1497    23901    5                        FEPMES.DEVNM = DEVNM_TWSN;
     1498    23902    5                        FEPMES.MSG# = URPS_NKEYIN_MSG#;
     1499    23903    5                        FEPMES.CADDR = M_DEVC;
     1500    23904    5                        FEPMES.NPARAMS = 1;
     1501    23905    5                        FEPMES.FCNT = 1;
     1502    23906    5                        FEPMES.FCN = OC_WR;
     1503    23907    5                        PARM$ = ADDR(FEPMES.MSG);
     1504    23908    5                        CNT = FEX;
     1505    23909    5                        WKBER.BUF_ = VECTOR(FEPMES);
     1506    23910    6                        CALL M$WRITE(WKBER) WHENALTRETURN DO;
     1507    23911    6                           END;            /* WHENALTRETURN */
     1508    23912    5                        GOTO RTN;
     1509    23913    5                     END;                  /* DO CASE(DVCKYN.KIN#) */
     1510    23914    4                   END;                    /* IF DEVNM = DVCKYN.DEVNM */
     1511    23915    3              END;                         /* DO I */
     1512    23916    2           GOTO FRWD;
     1513    23917    2   DVCERR: ;                               /* If we got here there was an error */
     1514    23918                   /*N* Print an error message */
     1515    23919        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:184  
     1516    23920    2        CASE (KEY_DISABLE#);
     1517    23921    2           ADMIN.FNC = %KHA_FNC_DISABLE;
     1518    23922    2   FEP_KEYIN: ;
     1519    23923    2           ADMIN.TERMID_LO.LEV = %TERMINAL_ID_LEV_CHAN#;
     1520    23924    2           ADMIN.TERMID_LO.TERM.CHANNEL.BYT(0) = ENABLE_KEYIN.LINE_LOW#/256;
     1521    23925    2           ADMIN.TERMID_LO.TERM.CHANNEL.BYT(1) = MOD(ENABLE_KEYIN.LINE_LOW#,256);
     1522    23926    2           ADMIN.TERMID_HI = ADMIN.TERMID_LO;
     1523    23927    2           IF ENABLE_KEYIN.LINE_HI# ~= 0
     1524    23928    3           THEN DO;
     1525    23929    3                ADMIN.TERMID_HI.LEV = %TERMINAL_ID_LEV_CHAN#;
     1526    23930    3                ADMIN.TERMID_HI.TERM.CHANNEL.BYT(0) = ENABLE_KEYIN.LINE_HI#/256;
     1527    23931    3                ADMIN.TERMID_HI.TERM.CHANNEL.BYT(1) = MOD(ENABLE_KEYIN.LINE_HI#,256);
     1528    23932    3              END;
     1529    23933    2           ADMIN.ORIGIN = 'KEYIN';
     1530    23934    2           ADMIN.SRCE_NODE = KL_NODE;
     1531    23935    2           FEX = ENABLE_KEYIN.FEP#;
     1532    23936    2           IF FEX = 0
     1533    23937    2           THEN
     1534    23938    2                CALL KLX$CONV_NODENAME(KMSG.NAME,FEX,NODETYPE) ALTRET(FEPK_ERR);
     1535    23939    2           ELSE
     1536    23940    2                CALL KLX$CONV_NODE(KMSG.NAME,FEX,NODETYPE) ALTRET(FEPK_ERR);
     1537    23941    2           CALL KLX$WRHLPNODE (ADMIN,SIZEC(ADMIN),FEX)
     1538    23942    3           WHENALTRETURN DO;
     1539    23943    3   FEPK_ERR:    ;
     1540    23944    3                KBERR = CKBR;
     1541    23945    3                KBERR.MSG# = NNFND_MSG#;
     1542    23946    3                KBERR.FEX = FEX;
     1543    23947    3                KBERR.NAME = KMSG.NAME;
     1544    23948    3                KBERR.CADDR = KMSG.CADDR;
     1545    23949    3                WKBER.BUF_ = VECTOR(KBERR);
     1546    23950    3                CALL M$WRITE (WKBER)
     1547    23951    4                WHENALTRETURN DO;
     1548    23952    4                   END;
     1549    23953
     1550    23954    3              END;
     1551    23955
     1552    23956    2        CASE (KEY_ENABLE#);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:185  
     1553    23957    2           ADMIN.FNC = %KHA_FNC_ENABLE;
     1554    23958    2           GOTO FEP_KEYIN;
     1555    23959
     1556    23960    2        CASE (KEY_KILL#);
     1557    23961    2           ADMIN.FNC = %KHA_FNC_KILL;
     1558    23962    2           GOTO FEP_KEYIN;
     1559    23963
     1560    23964
     1561    23965    2        CASE (KEY_DISCC#);
     1562    23966    2           ADMIN.FNC = %KHA_FNC_DISCONNECT_RQS;
     1563    23967    2           GOTO FEP_KEYIN;
     1564    23968
     1565    23969
     1566    23970    2        CASE (KEY_DISCT#);
     1567    23971    2           KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.KEY);
     1568    23972    2           KL_NETWORK_TERMKEY.KEY.TERMNAME = ENABLE_KEYIN.NAME;
     1569    23973    2           KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);
     1570    23974    2           CALL M$READ (KL_RD_NETWORK)
     1571    23975    3           WHENALTRETURN DO;
     1572    23976    3                FEPMES.MSG# = NTRM_MSG#;
     1573    23977    3                FEPMES.NPARAMS = 2;
     1574    23978    3                FEPMES.CADDR = DVCKYN.CADDR;
     1575    23979    3                FEPMES.FCNT = 8;
     1576    23980    3                FEPMES.FCN = OC_WR;
     1577    23981    3                FEPMES.FNCNT = 1;
     1578    23982    3                ADDR(FEPMES.MSG)->B$TERMNAME = ENABLE_KEYIN.NAME;
     1579    23983    3                WKBER.BUF_ = VECTOR(FEPMES);
     1580    23984    3                CALL M$WRITE (WKBER)
     1581    23985    4                WHENALTRETURN DO;
     1582    23986    4                   END;
     1583    23987    3                RETURN;
     1584    23988    3              END;
     1585    23989    2           ENABLE_KEYIN.LINE_LOW# = KL_NETWORK_BUF.TERMINAL_ID.TERM.CHANNEL.BYT(0)*256
             23989                    +
     1586    23990    2                KL_NETWORK_BUF.TERMINAL_ID.TERM.CHANNEL.BYT(1);
     1587    23991    2           ENABLE_KEYIN.FEP# = KL_NETWORK_BUF.NODE;
     1588    23992    2           ENABLE_KEYIN.LINE_HI# = ENABLE_KEYIN.LINE_LOW#;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:186  
     1589    23993    2           ADMIN.FNC = %KHA_FNC_DISCONNECT_RQS;
     1590    23994    2           GOTO FEP_KEYIN;
     1591    23995
     1592    23996
     1593    23997    2        CASE(KEY_FROG2NA);
     1594    23998    2           KMSG.KIN#=IGA_DUMPMSG*512;
     1595    23999    2           FEX=ADDR(ADDR(JC_CSMBF)->KL$DUMPMSG.FEX)->UBIN_HALF_BASE;
     1596    24000    2           CALL KLX$WRHLPNODE(KMSG,JC_MARS,FEX);
     1597    24001
     1598    24002    2   BHSON1: ;
     1599    24003    2        END;                               /* DO CASE */
     1600    24004    1   RTN: ;
     1601    24005    1        RETURN;
     1602    24006        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:187  
     1603    24007    1   KLI$AMSG: ENTRY;
     1604    24008        /**/
     1605    24009    1        IF KL_STATION = 'BABOON'
     1606    24010    1        THEN
     1607    24011    1             FEX = KL_NODE;
     1608    24012    1        ELSE
     1609    24013    1             IF SUBSTR(KL_STATION,0,4) = 'FEPA'
     1610    24014    1             THEN
     1611    24015    1                  CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4));
     1612    24016    1        RDBF$=ADDR(KL_RDBF);
     1613    24017    1        KBERR=CKBR;
     1614    24018    2        DO CASE(KL_RDBF.CODE);
     1615    24019
     1616    24020
     1617    24021    2        CASE(IGA_STOK);
     1618    24022    2           IF KL_FETBL.KTYP(FEX)~=%KLKT_STOP# THEN RETURN;
     1619    24023    2           CALL STFEPNM;
     1620    24024
     1621    24025        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:188  
     1622    24026    2        CASE (IGA_UPDATE);
     1623    24027
     1624    24028    2           CALL KLI$UPDATE;
     1625    24029        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:189  
     1626    24030    2        CASE(IGA_KMSG);
     1627    24031    2           KL_NETWORK_BUF.DEVNM = ' ';
     1628    24032
     1629    24033    3           DO CASE(KL$KEYMES.CNSFNC);
     1630    24034
     1631    24035    3           CASE(OC_WR);
     1632    24036    3   /* DO NOTHING */;
     1633    24037
     1634    24038    3           CASE(OC_WRTM);
     1635    24039    3              CALL FIND_ERRCTX(KL$KEYMES.TERMID)
     1636    24040    4              WHENRETURN DO;
     1637    24041    4                   FEPMES.NPARAMS = 0;
     1638    24042    4                   FEPMES.FCN = OC_STTM;
     1639    24043    4                   FEPMES.MSGID = DVCERRCTX.MSGID;
     1640    24044    4                   WKBER.BUF_ = VECTOR(FEPMES);
     1641    24045    4                   CALL M$WRITE(WKBER)
     1642    24046    5                   WHENALTRETURN DO;
     1643    24047    5                      END;
     1644    24048    4                   PREV$->DVCERRCTX.LNK$ = DVCERRCTX.LNK$;
     1645    24049    4                   CALL KLB$REL(CTX$);
     1646    24050    4                 END;
     1647    24051    4              WHENALTRETURN DO;
     1648    24052    4                   IF KL_NETWORK_BUF.DEVNM = ' '
     1649    24053    4                   THEN
     1650    24054    4                        RETURN;
     1651    24055    4                 END;
     1652    24056    4              CALL KLB$GET(CTX$,SIZEC(DVCERRCTX)) WHENALTRETURN DO;
     1653    24057                             /*N* We're screwed if we get here */
     1654    24058    4                 END;                      /* WHENALTRETURN */
     1655    24059    3              DVCERRCTX.TERMID = KL$KEYMES.TERMID;
     1656    24060                        /*N* SLEAZY WAY TO GET A MSGID */
     1657    24061    3              MSGID = MSGID + 1;
     1658    24062    3              DVCERRCTX.MSGID = MSGID;
     1659    24063    3              FEPMES.MSGID = MSGID;
     1660    24064    3              DVCERRCTX.MSG# = DVCKYN.KIN#;
     1661    24065    3              DVCERRCTX.FEX = FEX;
     1662    24066    3              DVCERRCTX.KEYIN_REQ = KL$KEYMES.KEYIN_REQ;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:190  
     1663    24067    3              DVCERRCTX.DEVNM = KL_NETWORK_BUF.DEVNM;
     1664    24068    3              DVCERRCTX.LNK$ = CTXHD$;
     1665    24069    3              CTXHD$ = CTX$;
     1666    24070
     1667    24071    3           CASE(OC_STTM);
     1668    24072    3              CALL FIND_ERRCTX(KL$KEYMES.TERMID)
     1669    24073    4              WHENRETURN DO;
     1670    24074    4                   FEPMES.MSGID = DVCERRCTX.MSGID;
     1671    24075    4                   PREV$->DVCERRCTX.LNK$ = DVCERRCTX.LNK$;
     1672    24076    4                   CALL KLB$REL(CTX$);
     1673    24077    4                 END;
     1674    24078    4              WHENALTRETURN DO;
     1675    24079    4                   RETURN;
     1676    24080    4                 END;
     1677    24081    3           END;                            /* DO CASE KEYMES.CNSFNC */
     1678    24082        /* Now forward to KEYIN */
     1679    24083    2           CALL KLX$8TO9(KL$KEYMES.MSG#,FEPMES.MSG#,SIZEC(FEPMES.MSG#));
     1680    24084    2           FEPMES.DEVNM = KL_NETWORK_BUF.DEVNM;
     1681    24085    2           FEPMES.NPARAMS = KL$KEYMES.NPARMS + 2;
     1682    24086    2           ADDR(FEPMES.CADDR)->CADDR.TOP = KL$KEYMES.CADDR.TOP;
     1683    24087    2           ADDR(FEPMES.CADDR)->CADDR.MID = KL$KEYMES.CADDR.MID;
     1684    24088    2           ADDR(FEPMES.CADDR)->CADDR.BOT = KL$KEYMES.CADDR.BOT;
     1685    24089    2           FEPMES.FCN = KL$KEYMES.CNSFNC;
     1686    24090    2           FEPMES.FCNT=1;
     1687    24091    2           FEPMES.FNCNT=8;
     1688    24092    2           PARM$ = ADDR(FEPMES.MSG);
     1689    24093    3           DO I = 0 TO KL$KEYMES.NPARMS-1;
     1690    24094    3                CNT = KL$KEYMES.PARMS.SIZE(I);
     1691    24095    3                PARM$ = PINCRC(PARM$,SIZEC(CNT));
     1692    24096    3              END;
     1693    24097    2           MESS$ = PINCRC(ADDR(KL$KEYMES.PARMS),LENGTHC(KL$KEYMES.PARMS(0))*KL$KEYMES.
             24097                    NPARMS);
     1694    24098    2           CNT = FEX;
     1695    24099    2           PARM$ = PINCRC(PARM$,LENGTHC(CNT));
     1696    24100    2           SIZE = 8;
     1697    24101    2           CALL KLX$CONV_NODE(HOSTNAME,FEX,NODETYPE);
     1698    24102    2           PARM$->PARM = HOSTNAME;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:191  
     1699    24103    2           PARM$ = PINCRC(PARM$,SIZEC(HOSTNAME));
     1700    24104
     1701    24105    3           DO I = 0 TO KL$KEYMES.NPARMS-1;
     1702    24106    3                SIZE = KL$KEYMES.PARMS.SIZE(I);
     1703    24107    3                IF KL$KEYMES.PARMS.TYPE(I) = %KL_TYPE_NORM
     1704    24108    3                THEN
     1705    24109    3                     PARM$->PARM = MESS$->PARM;
     1706    24110    3                ELSE
     1707    24111    3                     CALL KLX$8TO9(MESS$->PARM,PARM$->PARM,SIZE);
     1708    24112    3                MESS$ = PINCRC(MESS$,SIZE);
     1709    24113    3                PARM$ = PINCRC(PARM$,SIZE);
     1710    24114    3              END;
     1711    24115    2           WKBER.BUF_ = VECTOR(FEPMES);
     1712    24116    3           CALL M$WRITE(WKBER) WHENALTRETURN DO;
     1713    24117    3              END;
     1714    24118    2           RETURN;
     1715    24119        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:192  
     1716    24120    2        CASE(IGA_STRTU);
     1717    24121    2           IF KL_NODE=KL_NMNODE
     1718    24122    3           THEN DO;                   /* Obtain info from :HLP if we are the NM */
     1719    24123    3                KL_HLPKEY.ACCT = KL$STRTU.ACCT;
     1720    24124    3                KL_HLPKEY.NAME = KL$STRTU.UNAME;
     1721    24125    3                CALL INDEX(SIZE,' ',KL$STRTU.UNAME);
     1722    24126    3                KL_HLPKEY.CNT = SIZEC(KL_HLPKEY.ACCT) + SIZE;
     1723    24127    3                CALL M$READ (KL_RDHLPR)
     1724    24128    4                WHENALTRETURN DO;
     1725    24129    4                     CALL SENDCWNAK (KL$STRTU.NETADR_FROM,ELGL);
     1726    24130    4                     RETURN;
     1727    24131    4                   END;
     1728    24132        /*E* ERROR: KLI-E$ELGL-4
     1729    24133             MESSAGE: Can't start FPRG.  No authorization record for that ACCT,NAME.
     1730    24134        */
     1731    24135    3                PARM$ = ADDR(KL_HLPR);
     1732    24136    3                I = KL$STRTU.MODE - 1;
     1733    24137        /* Convert host UTS units to L6 UTS units. */
     1734    24138    3                CALL KLX$9TO8(KL$DREC.FEBLK.MTIME(I)*6/5,KL$STRTU.MRT,4);
     1735    24139    3                KL$STRTU.PRIV = KL$DREC.FEBLK.PRIV(I);
     1736    24140    3                KL$STRTU.PPRIV = KL$DREC.FEBLK.PPRIV(I);
     1737    24141    3                KL$STRTU.FLAGS.STEPACCT = KL$DREC.FEBLK.FLAGS.STEPACCT;
     1738    24142    3                CALL KLX$9TO8(KL$DREC.FEBLK.MMEM(I),KL$STRTU.MEM,2);
     1739    24143    3                KL$STRTU.INTS = KL$DREC.FEBLK.MINTS(I);
     1740    24144    3                KL$STRTU.MACCTFPRG = KL$DREC.FEBLK.MFPRG;
     1741    24145    3                IF ~KL$DREC.FLAGS.FEOK AND KL$DREC.FEBLK.MFPRG ~= 0
     1742    24146    4                THEN DO;
     1743    24147    4                     CALL SENDCWNAK(KL$STRTU.NETADR_FROM,NOFPRG);
     1744    24148    4                     RETURN;
     1745    24149    4                   END;
     1746    24150        /*E* ERROR: KLI-E$NFPRG-4
     1747    24151             MESSAGE: Your ACCT,UNAME is not authorized to start an FPRG.
     1748    24152        */
     1749    24153    3                CALL KLX$9TO8(KL$DREC.FEBLK.MACCTMEM,KL$STRTU.MACCTMEM,2);
     1750    24154    3                KL$STRTU.BILL = KL$DREC.FEBLK.BILL(I);
     1751    24155    3                KL$STRTU.DB_ACCT = KL$DREC.FEBLK.DBACCN;
     1752    24156    4                DO LEN = 0 TO 7;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:193  
     1753    24157    4                     KL$STRTU.PSEUDO_NAME(LEN) = KL$DREC.FEBLK.PSDOL.PSDO_NAME(CNT);
     1754    24158    4                     CALL KLX$9TO8(ADDR(KL$DREC.FEBLK.PSDOL)->PSEUDO.MAX(I),KL$STRTU.
             24158                              MAX(LEN),2);
     1755    24159    4                   END;
     1756    24160    3                IF KL$STRTU.MRT='0'B THEN
     1757    24161    3                     KL$STRTU.MRT='177777777777'O;
     1758    24162    3                IF KL$STRTU.MEM='0'B THEN
     1759    24163    3                     KL$STRTU.MEM='777777'O; /* From :NLP record */
     1760    24164    3                FEX=KL$STRTU.NODE;
     1761    24165    3              END;
     1762    24166    2           ELSE FEX=KL_NMNODE;
     1763    24167    2           LEN=SIZEC(KL$STRTU);
     1764    24168    3           CALL KLX$WRHLPNODE(KL$STRTU,LEN,FEX) WHENALTRETURN DO;
     1765    24169    3   SEND_CWNAK:  ;
     1766    24170    3                CALL SENDCWNAK (KL$AFD.NETADR_FROM,B$TCB$->B$TCB.ALT$->B$ALT.ERR);
     1767    24171    3              END;
     1768    24172        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:194  
     1769    24173    2        CASE(IGA_AFD);
     1770    24174    2           IF KL_NODE=KL_NMNODE
     1771    24175    2           THEN FEX=KL$AFD.NODE;
     1772    24176    2           ELSE FEX=KL_NMNODE;
     1773    24177    2           LEN=SIZEC(KL$AFD);
     1774    24178    3           CALL KLX$WRHLPNODE(KL$AFD,LEN,FEX) WHENALTRETURN DO;
     1775    24179    3                CALL SENDCWNAK (KL$AFD.NETADR_FROM,B$TCB$->B$TCB.ALT$->B$ALT.ERR);
     1776    24180    3              END;
     1777    24181
     1778    24182
     1779    24183    2        CASE(IGA_CWNAK);
     1780    24184    2           LEN=SIZEC(KL$CWNAK);
     1781    24185    2           FEX=KL$CWNAK.NETADR.NODE;
     1782    24186    2           IF FEX=KL_NODE
     1783    24187    2           THEN CALL KLX$WRHLPSTA(KL$CWNAK,LEN,'BABOON ');
     1784    24188    2           ELSE CALL KLX$WRHLPNODE(KL$CWNAK,LEN,FEX);
     1785    24189    2        CASE(IGA_CRASHFEP_BF);
     1786    24190    2           LEN=SIZEC(CRASHFEP_BF);
     1787    24191    2           FEX=KL$FEPST.FEP;
     1788    24192    2           CALL KLX$WRHLPNODE(CRASHFEP_BF,LEN,FEX);
     1789    24193        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:195  
     1790    24194    2        CASE(IGA_RQSCHN);
     1791    24195    2           IF KL$RQSCHN.DFLTHND
     1792    24196    3           THEN DO;
     1793    24197    3                PSIZ=0;
     1794    24198    3                KL_NETWORK_VALID = '0'B;
     1795    24199    3                CHNRSP = KL_CHNRSPC;
     1796    24200    3                CHNRSP.HANDLER = KL$RQSCHN.HANDLER;
     1797    24201    3                CHNRSP.DFLTHND = '1'B;
     1798    24202    3                CHNRSP.NAK = '1'B;
     1799    24203    3                DEFAULT_KEY.NODE = FEX;
     1800    24204    3                DEFAULT_KEY.HNDLR = KL$RQSCHN.HANDLER;
     1801    24205    3                KL_RD_NETCON.KEY_ = VECTOR(DEFAULT_KEY);
     1802    24206    3                KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);
     1803    24207    3                CALL M$READ(KL_RD_NETCON) ALTRET (DFLT_CHN);
     1804    24208    3                CHNRSP.NAK = '0'B;
     1805    24209    3                CHNRSP.NA = '0'B;
     1806    24210    3                CHNRSP.HNDCMN = '0'B;
     1807    24211    3                IF LINCNFG.PRO.PROSIZE > 0
     1808    24212    4                THEN DO;
     1809    24213    4                     KL_PROKEY = LINCNFG.PRO;
     1810    24214    4                     CALL M$READ (KL_RDPROR)
     1811    24215    5                     WHENRETURN DO;
     1812    24216    5                          PSIZ = DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS-SIZEC(KL_PROBUF);
     1813    24217    5                          CALL KLX$9TO8(PSIZ,CHNRSP.MESSAGE.MSGSIZE,2);
     1814    24218    5                          ADDR(CHNRSP.MESSAGE.MESSAGE)->CHR$PSIZ = PINCRC(ADDR(
             24218                                   KL_PROBUF),SIZEC(KL_PROBUF))->CHR$PSIZ;
     1815    24219    5                        END;
     1816    24220    4                   END;
     1817    24221    3                GOTO DFLT_CHN;
     1818    24222    3              END;
     1819    24223    3           IF KL$RQSCHN.DFLTCHN THEN DO;
     1820    24224    3                IF KL$RQSCHN.SCNDCNFG THEN
     1821    24225    3                     CHNRSP.SCNDCNFG = '1'B;
     1822    24226    3                CONFIG_KEY.NODE = FEX;
     1823    24227    3                IF KL$RQSCHN.TERMINAL_ID.TERM.CHANNEL = '0'B /* All configs */
     1824    24228    4                THEN DO;
     1825    24229    4                     CALL GETCONFIGS;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:196  
     1826    24230    4                     RETURN;
     1827    24231    4                   END;
     1828    24232    3                CONFIG_KEY.TERMID = KL$RQSCHN.TERMINAL_ID;
     1829    24233    3                IF CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' '
     1830    24234    4                THEN DO;
     1831    24235    4                     CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;
     1832    24236    4                     CONFIG_KEY.NODE = 0;
     1833    24237    4                   END;
     1834    24238    3                CONFIG_KEY.TERMID.TTYP = 0;
     1835    24239    3                PSIZ = 0;
     1836    24240    3                KL_NETWORK_VALID = '0'B;
     1837    24241    3                CHNRSP = KL_CHNRSPC;
     1838    24242    3                CHNRSP.CONFIG = '1'B;
     1839    24243    3                CHNRSP.NA.SNDSLT = '10'B;
     1840    24244    3                CHNRSP.TERMINAL_ID = KL$RQSCHN.TERMINAL_ID;
     1841    24245    3                KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);
     1842    24246    3                KL_RD_NETCON.KEY_ = VECTOR(CONFIG_KEY);
     1843    24247    3                CALL M$READ(KL_RD_NETCON) ALTRET(DFLT_CHN);
     1844    24248    3                CHNRSP.NA = LINCNFG.NA;
     1845    24249    3                CHNRSP.NA.CNFG_EXISTS = '1'B;
     1846    24250    3                CHNRSP.HNDCMN = LINCNFG.KHA;
     1847    24251    3   DFLT_CHN:    CALL KLX$WRHLPNODE(CHNRSP,SIZEC(CHNRSP),FEX);
     1848    24252    3              END;                         /* IF RQSCHN.DFLTCHN */
     1849    24253    3           ELSE DO;
     1850    24254    3                KL_NETWORK_VALID = '0'B;
     1851    24255    3                KL$CHNRSP = KL_CHNRSPC;
     1852    24256    3                KL$CHNRSP.HANDLER = KL$RQSCHN.HANDLER;
     1853    24257    3                KL$CHNRSP.TERMINAL_ID = KL$RQSCHN.TERMINAL_ID;
     1854    24258    3                KL$RQSCHN.TERMINAL_ID.TTYP = 0;
     1855    24259    3                KL$CHNRSP.NAK = '0'B;
     1856    24260    3                KL$CHNRSP.LINE_PROFILE = '1'B;
     1857    24261    4                IF KL$RQSCHN.SGN.L ~= 0 THEN DO;
     1858    24262    4                     CALL KLH$SGSCAN(KL$RQSCHN.SGN,ACCT,UNAME,PASS,PRO,ERR,HOSTNAME,
             24262                              NOSETUP,NOHEADER) ALTRET(CHNNAK);
     1859    24263    4                     IF HOSTNAME = ' '
     1860    24264    4                     THEN
     1861    24265    4                          HOSTNAME = KL_NODENAME;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:197  
     1862    24266    4                     LINCNFG.FLAGS.REMOTE = '1'B;
     1863    24267    4                     LINCNFG.NA = NA_C;
     1864    24268    4                     LINCNFG.KHA = KHA_C;
     1865    24269    4                     LINCNFG.PRO.PROSIZE = 0;
     1866    24270    4                     LINCNFG.PRO.PROTXT = ' ';
     1867    24271    4                     LINCNFG.LGN.LGNSIZE = KL$RQSCHN.SGN.L;
     1868    24272    4                     LINCNFG.LGN.LGNSTRING = KL$RQSCHN.SGN.TXT;
     1869    24273    4                     TERM_KEY.TERMID.TERM.TERM_NAME = ACCT;
     1870    24274    4                     KL_RD_NETCON.BUF_ = VECTOR(TERM_REC);
     1871    24275    4                     KL_RD_NETCON.KEY_ = VECTOR(TERM_KEY);
     1872    24276    5                     CALL M$READ(KL_RD_NETCON) WHENALTRETURN DO;
     1873    24277    5   CHNNAK:                KL$CHNRSP.NAK = '1'B;
     1874    24278    5                          SIZE = SIZEC(KL$CHNRSP) - SIZEC(KL$CHNRSP.MESSAGE.MESSAGE) +
             24278                                   1;
     1875    24279    5                          CALL KLX$WRHLPNODE(KL$CHNRSP,SIZE,FEX);
     1876    24280    5                          RETURN;
     1877    24281    5                        END;               /* WHENALTRETURN */
     1878    24282        /*N*            Right here we should make some kind of check as to whether
     1879    24283                         or not the specified terminal is active.  If it is, we
     1880    24284                         should send a NAK */
     1881    24285    4                   END;
     1882    24286    4                ELSE DO;                   /* Not a REMOTE signon */
     1883    24287    4                     CONFIG_KEY.NODE=FEX;
     1884    24288    4                     CONFIG_KEY.TERMID = KL$RQSCHN.TERMINAL_ID;
     1885    24289    4                     KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);
     1886    24290    4                     KL_RD_NETCON.KEY_ = VECTOR(CONFIG_KEY);
     1887    24291    4                     CALL M$READ(KL_RD_NETCON) ALTRET(CHNNAK);
     1888    24292    4                     CALL KLH$SGSCAN(LINCNFG.LGN,ACCT,UNAME,PASS,PRO,ERR,HOSTNAME,
             24292                              NOSETUP,NOHEADER) ALTRET(CHNNAK);
     1889    24293    4                     IF HOSTNAME = ' '
     1890    24294    4                     THEN
     1891    24295    4                          HOSTNAME = KL_NODENAME;
     1892    24296    4                   END;
     1893    24297    3                CALL KLI$LINEPRO(ACCT,UNAME,PASS);
     1894    24298    3                IF KL$CHNRSP.NAK THEN GOTO CHNNAK;
     1895    24299    3                KL$CHNRSP.TERMINAL_ID.TERM.TERM_NAME = ACCT;
     1896    24300    3                IF LINCNFG.FLAGS.REMOTE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:198  
     1897    24301    4                THEN DO;
     1898    24302    4                     TERM_REC = CONFIG_KEY;
     1899    24303    4                     KL_WR_NETCON.BUF_ = VECTOR(TERM_REC);
     1900    24304    4                     KL_WR_NETCON.KEY_ = VECTOR(TERM_KEY);
     1901    24305    4                     CALL M$WRITE(KL_WR_NETCON); /* SCREECH on ALTRET */
     1902    24306    4                   END;                    /* IF LINCNFG.FLAGS.REMOTE */
     1903    24307    3                SIZE = KL$CHNRSP.MESSAGE.MSGSIZE.BYT(0) * 256 + KL$CHNRSP.MESSAGE.
             24307                         MSGSIZE.BYT(1);
     1904    24308    3                SIZE = SIZE + SIZEC(KL$CHNRSP) - SIZEC(KL$CHNRSP.MESSAGE.MESSAGE);
     1905    24309    3                CALL KLX$WRHLPNODE(KL$CHNRSP,SIZE,FEX);
     1906    24310
     1907    24311             /* Save the terminal name in :NETWORK */
     1908    24312    3                KL_NETWORK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_LINE;
     1909    24313    3                KL_NETWORK_KEY.KEY.NODE = FEX;
     1910    24314    3                KL_NETWORK_KEY.KEY.TERMID = KL$RQSCHN.TERMINAL_ID;
     1911    24315    3                KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;
     1912    24316    3                KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     1913    24317    3                CALL M$TIME(KL_NETWORK_TIME);
     1914    24318    3                KL_NETWORK_BUF.DEVNM = ACCT;
     1915    24319    3                KL_NETWORK_BUF.TERMNAME = ACCT;
     1916    24320    3                KL_NETWORK_BUF.ACCT = ACCT;
     1917    24321    3                KL_NETWORK_BUF.HLPKEY = KL_HLPKEY;
     1918    24322    3                KL_NETWORK_BUF.ATYP = KL_HLPR.ATYP;
     1919    24323    3                KL_NETWORK_BUF.TERMINAL_ID = KL$RQSCHN.TERMINAL_ID;
     1920    24324    3                KL_NETWORK_BUF.NODE = FEX;
     1921    24325    3                KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     1922    24326    3                CALL M$WRITE (KL_WR_NETWORK)
     1923    24327    4                WHENALTRETURN DO;
     1924    24328    4                   END;
     1925    24329    3                KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.KEY);
     1926    24330    3                KL_NETWORK_TERMKEY.KEY.TERMNAME = ACCT;
     1927    24331    3                KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);
     1928    24332    3                CALL M$WRITE (KL_WR_NETWORK)
     1929    24333    4                WHENALTRETURN DO;
     1930    24334    4                   END;
     1931    24335
     1932    24336             /* Inform ELF about the device going active */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:199  
     1933    24337    3                KL_PCD = '0'B;
     1934    24338    3                KL_PCD.ADDD.FEX = FEX;
     1935    24339    3                KL_PCD.ADDD.TERMID.LEV = KL$CHNRSP.TERMINAL_ID.LEV;
     1936    24340    3                CALL KLX$8TO9(KL$CHNRSP.TERMINAL_ID.TERM.CHANNEL,KL_PCD.ADDD.TERMID.
             24340                         CHAN,2);
     1937    24341    3                CALL KLX$8TO9(KL$CHNRSP.TERMINAL_ID.TERM.SUBDEVICE,KL_PCD.ADDD.TERMID.
             24341                         SUB,2);
     1938    24342    3                CALL KLX$8TO9(KL$CHNRSP.TERMINAL_ID.TERM.SUBSUBDEVICE,KL_PCD.ADDD.
             24342                         TERMID.SUBSUB,2);
     1939    24343    3                CALL KLX$CONV_NODE(KL_PCD.ADDD.FEPNAME,FEX,NODETYPE);
     1940    24344    3                KL_PCD.ADDD.ACTYP = %KLAC_TRM;
     1941    24345    3                KL_PCD.ADDD.ASSOCTRM = ACCT;
     1942    24346    3                KL_PCD.ADDD.TNAME = KL_HLPR.TNAME;
     1943    24347    3                KL_PCD.ADDD.TWSN = KL_HLPR.TWSN#;
     1944    24348    3                KL_PCD.ADDD.ATYP = KL_HLPR.ATYP;
     1945    24349    3                KL_PCD.ADDD.DEVNM = ACCT;
     1946    24350    3                FPT_WRSYSLOG.V.TYPE# = EL_CONN;
     1947    24351    3   WRTSYSLOG:   ;
     1948    24352    3                CALL M$WRSYSLOG (FPT_WRSYSLOG)
     1949    24353    4                WHENALTRETURN DO;
     1950    24354    4                     CALL M$WAIT (FPT_WAIT);
     1951    24355    4                     GOTO WRTSYSLOG;
     1952    24356    4                   END;
     1953    24357    3              END;                         /* ELSE */
     1954    24358    2           FEPERR='0'B;
     1955    24359
     1956    24360        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:200  
     1957    24361    2        CASE (IGA_SYSLOG);                 /* Syslog request */
     1958    24362    3           DO CASE (KL$SYSLOG.FILENUM);
     1959    24363    3           CASE(EL_ACCT);                  /*account logging*/
     1960    24364        /* move all character data at once.
     1961    24365        */
     1962    24366    3              CTX$ = ADDR(G$ACC_UNPK.CODE);
     1963    24367    3              G@ACC_PKD = CTX$->G$ACC;
     1964    24368
     1965    24369        /* now pack up the binary values.
     1966    24370        */
     1967    24371    3              CALL I$8TO9(G$ACC_UNPK.SYSID,G@ACC_PKD.SYSID,2,1);
     1968    24372    3              CALL I$8TO9(G$ACC_UNPK.START,G@ACC_PKD.START,4,8);
     1969    24373        /* START, STOP, USER_EX, USER_SV, UMEM, PROC_EX, PROC_SV, PROC_MEM */
     1970    24374    3              CALL I$8TO9(G$ACC_UNPK.PEAK_MEM,G@ACC_PKD.PEAK_MEM,2,8);
     1971    24375        /* PK_MEM, PK_LVLS, MCLS, FEP#, STEPUNIT(0:3) */
     1972    24376    3              CALL I$8TO9(G$ACC_UNPK.READS_HOST,G@ACC_PKD.READS_HOST,4,4);
     1973    24377        /* READS_HOST, WRITES_HOST, READS_UC, WRITES_UC */
     1974    24378    3              CALL I$8TO9(G$ACC_UNPK.STEP,G@ACC_PKD.STEP,2,1);
     1975    24379
     1976    24380        /* convert FEP UTSs to Host UTSs.
     1977    24381        */
     1978    24382    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.START);
     1979    24383    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;
     1980    24384
     1981    24385    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.STOP);
     1982    24386    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;
     1983    24387
     1984    24388    3              G@ACC_PKD.USER_EXTIME = (G@ACC_PKD.USER_EXTIME * 5) / 6;
     1985    24389
     1986    24390    3              G@ACC_PKD.USER_SVTIME = (G@ACC_PKD.USER_SVTIME * 5) / 6;
     1987    24391
     1988    24392    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.USER_MEMTIME);
     1989    24393    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;
     1990    24394
     1991    24395    3              G@ACC_PKD.PROC_EXTIME = (G@ACC_PKD.PROC_EXTIME * 5) / 6;
     1992    24396
     1993    24397    3              G@ACC_PKD.PROC_SVTIME = (G@ACC_PKD.PROC_SVTIME * 5) / 6;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:201  
     1994    24398
     1995    24399    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.PROC_MEMTIME);
     1996    24400    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;
     1997    24401
     1998    24402        /* Convert the error code.
     1999    24403        */
     2000    24404    3              CALL XUR$ERRCNVRT(G$ACC_UNPK.ERR,G@ACC_PKD.ERR);
     2001    24405    3              LOGOFF$PARAM.CODE = G@ACC_PKD.TYPE;
     2002    24406    3              LOGOFF$PARAM.DCB1 = DCBNUM(M$DO);
     2003    24407    3              LOGOFF$PARAM.DCB_LL = 0;
     2004    24408    3              LOGOFF$PARAM.ACCUM_CHG = 0;
     2005    24409    3              LOGOFF$PARAM.JIT$ = ADDR(G@ACC_PKD);
     2006    24410    3              CALL AZA$FEPACCTNG (LOGOFF$PARAM);
     2007    24411    3              G@ACC_PKD.CHG = LOGOFF$PARAM.ACCUM_CHG;
     2008    24412    3              WRT_ACCTLG.BUF_ = VECTOR(G@ACC_PKD);
     2009    24413    4              CALL M$WRITE(WRT_ACCTLG) WHENALTRETURN DO;
     2010    24414    4                   WKBER.BUF_ = VECTOR(FEPACCTL);
     2011    24415    5                   CALL M$WRITE(WKBER) WHENALTRETURN DO;
     2012    24416    5                      END;
     2013    24417    4                 END;
     2014    24418    3           CASE(EL_ERR);                   /* error logging*/
     2015    24419    3              FEPERR.STATDATA.NODE = FEX;
     2016    24420    3              FEPERR.STATDATA.VALUES = KL$SYSLOG.ERRLOG.VALUES;
     2017    24421    3              FEPERR.STATDATA.TERMID = KL$SYSLOG.ERRLOG.TERMID;
     2018    24422    3              FEPERR.STATDATA.UTS = KL$SYSLOG.ERRLOG.UTS;
     2019    24423    3              SIZE = KL$SYSLOG.ERRLOG.DATA_SIZE;
     2020    24424    3              FEPERR.X.DYMDATA = KL$SYSLOG.ERRLOG.DATA;
     2021    24425    3              CALL XUR$ERRCNVRT (KL$SYSLOG.ERRLOG.ERRCODE,FEPERR.STATDATA.ERRCODE);
     2022    24426    3              FPT_WRFEPERR.V.SIZE# = MINIMUM((KL$SYSLOG.ERRLOG.DATA_SIZE+3)/4,SIZEW(
             24426                       FEPERR.X.DYMDATA)) +
     2023    24427    3                   SIZEW(FEPERR) - SIZEW(FEPERR.X.DYMDATA);
     2024    24428    3              FPT_WRFEPERR.ENTRY_ = VECTOR(FEPERR);
     2025    24429    4              CALL M$WRSYSLOG (FPT_WRFEPERR) WHENALTRETURN DO; END;
     2026    24430    3           CASE(EL_SEC);
     2027    24431    3              CALL JMU$SETSEG(ES$,%SPCL1SID);
     2028    24432    3              IF ES$->LOGSYSACCT >= %PC_ES_FAILED# THEN
     2029    24433    4              DO;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:202  
     2030    24434
     2031    24435    4                   ES$SECLOG.REASON=%ES_JUNK_LOGON#;
     2032    24436    4                   ES$SECLOG.GRANTED='0'B;
     2033    24437    4                   ES$SECLOG.MODE=0;
     2034    24438    4                   ES$SECLOG.ACCN = ' ';
     2035    24439    4                   ES$SECLOG.UNAME = ' ';
     2036    24440    4                   ES$SECLOG.PASSWORD = ' ';
     2037    24441    4                   ES$SECLOG.PRIV='0'B;
     2038    24442    4                   ES$SECLOG.PPRIV='0'B;
     2039    24443    4                   ES$SECLOG.LOGON.L = 0;
     2040    24444    4                   ES$SECLOG.LOGON.C = ' ';
     2041    24445
     2042    24446    4                   ES$SECLOG.LOGON.L=KL$SYSLOG.ERRLOG.DATA_SIZE;
     2043    24447    4                   SIZE = KL$SYSLOG.ERRLOG.DATA_SIZE;
     2044    24448    4                   IF ES$SECLOG.LOGON.L > LENGTHC(ES$SECLOG.LOGON.C) THEN
     2045    24449    4                        ES$SECLOG.LOGON.L=LENGTHC(ES$SECLOG.LOGON.C);
     2046    24450    4                   ES$SECLOG.LOGON.C=KL$SYSLOG.ERRLOG.DATA;
     2047    24451    4                   ES$SECLOG.TSLINE.FEX=KL$SYSLOG.ERRLOG.VALUES(0);
     2048    24452    4                   ES$SECLOG.TSLINE.LEV=KL$SYSLOG.ERRLOG.TERMID.LEV;
     2049    24453    4                   CALL KLX$8TO9(KL$SYSLOG.ERRLOG.TERMID.TERM.CHANNEL,
     2050    24454    4                        ES$SECLOG.TSLINE.PORT,2);
     2051    24455    4                   CALL KLX$8TO9(KL$SYSLOG.ERRLOG.TERMID.TERM.SUBDEVICE,
     2052    24456    4                        ES$SECLOG.TSLINE.SUBDEVICE,2);
     2053    24457    4                   CALL KLX$8TO9(KL$SYSLOG.ERRLOG.TERMID.TERM.SUBSUBDEVICE,
     2054    24458    4                        ES$SECLOG.TSLINE.SUBSUBDEVICE,2);
     2055    24459    4                   CALL M$WRSYSLOG(WR_SECLOG);
     2056    24460    4                 END;
     2057    24461    3           END;
     2058    24462
     2059    24463        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:203  
     2060    24464    2        CASE(IGA_ERRMSG_RQS);
     2061    24465    2           FPT@ERRMSG = FPT_ERRMSG;
     2062    24466    2           FPT@ERRMSG.V_ = VECTOR(FPT@ERRMSG.V);
     2063    24467    2           FPT@ERRMSG.CODE_ = VECTOR(KL$ERRMSG_RQS.ERR);
     2064    24468    2           FPT@ERRMSG.BUF_ = VECTOR(KL@ERRMSG_RSP.MESSAGE);
     2065    24469    2           FPT@ERRMSG.RESULTS_ = VECTOR(VLR@ERRMSG);
     2066    24470    2           FPT@ERRMSG.V.L6_CODE# = '1'B;
     2067    24471    2           FPT@ERRMSG.V.INCLCODE# = KL$ERRMSG_RQS.INCLCODE;
     2068    24472    2           FPT@ERRMSG.V.SUBMESS# = KL$ERRMSG_RQS.SUBMESS;
     2069    24473    2           FPT@ERRMSG.V.SUBFILE# = KL$ERRMSG_RQS.SUBFILE;
     2070    24474    2           FPT@ERRMSG.V.SUBLANG# = KL$ERRMSG_RQS.SUBLANG;
     2071    24475    2           FPT@ERRMSG.V.LEAVETOKEN# = KL$ERRMSG_RQS.LEAVE_TOKEN;
     2072    24476
     2073    24477    2           IF KL$ERRMSG_RQS.ALTCODE_EXISTS
     2074    24478    3           THEN DO;
     2075    24479    3                FPT@ERRMSG.ALTCODE_ = VECTOR(KL$ERRMSG_RQS.ALTERR);
     2076    24480    3                FPT@ERRMSG.V.L6_ALTCODE# = '1'B;
     2077    24481    3              END;
     2078    24482
     2079    24483    2           IF KL$ERRMSG_RQS.LANG ~= B$JIT$->B$JIT.LANG
     2080    24484    3           THEN DO;
     2081    24485    3                FPT@ERRMSG.V.MY_LANG# = '0'B;
     2082    24486    3                FPT@ERRMSG.V.LANG# = KL$ERRMSG_RQS.LANG;
     2083    24487    3              END;
     2084    24488
     2085    24489    2           IF KL$ERRMSG_RQS.FID_EXISTS
     2086    24490    3           THEN DO;
     2087    24491    3                FPT@ERRMSG.FILENAME_ = VECTOR(KL$ERRMSG_RQS.FILENAME);
     2088    24492    3                IF KL$ERRMSG_RQS.FILEACCT ~= ' '
     2089    24493    3                THEN FPT@ERRMSG.FILEACCT_ = VECTOR(KL$ERRMSG_RQS.FILEACCT);
     2090    24494    3                IF KL$ERRMSG_RQS.FILEPASS ~= ' '
     2091    24495    3                THEN FPT@ERRMSG.FILEPASS_ = VECTOR(KL$ERRMSG_RQS.FILEPASS);
     2092    24496    3              END;
     2093    24497
     2094    24498    2           CALL M$ERRMSG(FPT@ERRMSG)
     2095    24499    3           WHENALTRETURN DO;
     2096    24500
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:204  
     2097    24501    3              END;
     2098    24502
     2099    24503    2           KL@ERRMSG_RSP.FCN = IGA_ERRMSG_RSP;
     2100    24504    2           KL@ERRMSG_RSP.USR# = KL$ERRMSG_RQS.USR#;
     2101    24505    2           KL@ERRMSG_RSP.CTX$ = KL$ERRMSG_RQS.CTX$;
     2102    24506    2           KL@ERRMSG_RSP.NOFILE = VLR@ERRMSG.NOFILE;
     2103    24507    2           KL@ERRMSG_RSP.NOMSG = VLR@ERRMSG.NOMSG;
     2104    24508    2           KL@ERRMSG_RSP.ALTMSG = VLR@ERRMSG.ALTMSG;
     2105    24509    2           KL@ERRMSG_RSP.MSGCOMP = VLR@ERRMSG.MSGCOMP;
     2106    24510    2           KL@ERRMSG_RSP.NNATIVE = VLR@ERRMSG.NNATIVE;
     2107    24511    2           KL@ERRMSG_RSP.INERR = VLR@ERRMSG.INERR;
     2108    24512
     2109    24513    3           DO J=119 DOWNTO 0;
     2110    24514    3                IF KL@ERRMSG_RSP.MESSAGE(J) ~= ' ' THEN EXIT;
     2111    24515    3              END;
     2112    24516    2           KL@ERRMSG_RSP.MESSAGE_SZ = J+1;
     2113    24517    2           LEN = SIZEC(KL$ERRMSG_RSP) + J+1;
     2114    24518
     2115    24519    2           CALL KLX$WRHLPNODE(KL@ERRMSG_RSP, LEN, FEX)
     2116    24520    3           WHENALTRETURN DO;
     2117    24521                    /*N*   */
     2118    24522    3              END;
     2119    24523
     2120    24524        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:205  
     2121    24525    2        CASE(IGA_CONTROL_INIT);
     2122    24526    2           CALL BINCHAR(FEPNAME,FEX);
     2123    24527    3           IF KL$CONTROL_INIT.HANDLER = 'BABOON' THEN DO;
     2124    24528    3                KL_FEPCTL_KEY.NODE = FEX;
     2125    24529    3                KL_RD_NETCON.KEY_ = VECTOR(KL_FEPCTL_KEY);
     2126    24530    3                KL_RD_NETCON.BUF_ = VECTOR(KL_FEPCTL);
     2127    24531    3                CALL M$READ(KL_RD_NETCON) ALTRET(NETCON_ALT);
     2128    24532    3                IF KL_FEPCTL.NPARAMS = 0
     2129    24533    3                THEN
     2130    24534    3                     GOTO NETCON_ALT;
     2131    24535    3                KL$CONTROL_INIT.NUM_FPARAM = KL_FEPCTL.NPARAMS;
     2132    24536    3                KL$CONTROL_INIT.NUM_IPARAM = 0;
     2133    24537    4                DO I = 0 TO KL$CONTROL_INIT.NUM_FPARAM;
     2134    24538    4                     CALL KLX$9TO8(KL_FEPCTL.PARAMS(I),KL$CONTROL_INIT.FPARAM(I),2);
     2135    24539    4                   END;                    /* DO I */
     2136    24540    3              END;                         /* HANDLER = 'BABOON' */
     2137    24541    3           ELSE DO;
     2138    24542    3                KL_HNDLR_KEY.NODE = FEX;
     2139    24543    3                KL_HNDLR_KEY.HNDLR = KL$CONTROL_INIT.HANDLER;
     2140    24544    3                KL_RD_NETCON.KEY_ = VECTOR(KL_HNDLR_KEY);
     2141    24545    3                KL_RD_NETCON.BUF_ = VECTOR(KL_HNDLR);
     2142    24546    3                CALL M$READ(KL_RD_NETCON) ALTRET(NETCON_ALT);
     2143    24547    3                KL$CONTROL_INIT.CODE = IGA_CONTROL_INIT;
     2144    24548    3                IF KL_HNDLR.NPARAMS ~= 0
     2145    24549    4                THEN DO;
     2146    24550    4                     KL$CONTROL_INIT.TYPE = KL_HNDLR.TYPE; /* ?? */
     2147    24551    4                     KL$CONTROL_INIT.NUM_FPARAM = KL_HNDLR.NPARAMS;
     2148    24552    4                     KL$CONTROL_INIT.NUM_IPARAM = KL_HNDLR.NPARAMI;
     2149    24553    5                     DO K = 0 TO KL_HNDLR.NPARAMS - 1;
     2150    24554    5                          IF K = %KL_HNDLRPARM_RES
     2151    24555    5                          THEN
     2152    24556    5                               KL$CONTROL_INIT.FPARAM(K) = KL_HNDLR.PARAMS(K);
     2153    24557    5                          ELSE
     2154    24558    5                               CALL KLX$9TO8(KL_HNDLR.PARAMS(K),
     2155    24559    5                                    KL$CONTROL_INIT.FPARAM(K),
     2156    24560    5                                    2);
     2157    24561    5                        END;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:206  
     2158    24562
     2159    24563    4                     IF KL_HNDLR.NPARAMI ~= 0
     2160    24564    5                     THEN DO;
     2161    24565    5                          IPARAM$ = ADDR(KL$CONTROL_INIT.FPARAM(0));
     2162    24566    5                          IPARAM$ = PINCRC(IPARAM$,KL_HNDLR.NPARAMS*2);
     2163    24567    5                          OUT$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM(0))*
     2164    24568    5                               KL_HNDLR.NPARAMI);
     2165    24569
     2166    24570    6                          DO J=0 TO KL_HNDLR.NPARAMI - 1;
     2167    24571    6                               OFFSET = POFFC(OUT$,ADDR(KL$CONTROL_INIT));
     2168    24572    6                               IN$ = PINCRW(ADDR(KL_HNDLR),
     2169    24573    6                                    KL_HNDLR.IPARAM.OFFSET(J));
     2170    24574
     2171    24575    6                               ARRAY_WDSZ = (((KL_HNDLR.IPARAM.ARRAY_SZ(J)+1)*2)+3)/4;
     2172    24576
     2173    24577    6                               CALL KLX$9TO8(KL_HNDLR.IPARAM.ARRAY_SZ(J),
     2174    24578    6                                    IPARAM$->B$BYTE,
     2175    24579    6                                    1);
     2176    24580    6                               IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM.
     2177    24581    6                                    ARRAY_SZ(0)));
     2178    24582
     2179    24583    6                               CALL KLX$9TO8(KL_HNDLR.IPARAM.PARAM_SZ(J),
     2180    24584    6                                    IPARAM$->B$BYTE,
     2181    24585    6                                    1);
     2182    24586    6                               IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM.
     2183    24587    6                                    PARAM_SZ(0)));
     2184    24588
     2185    24589    6                               CALL KLX$9TO8(OFFSET,
     2186    24590    6                                    IPARAM$->B$HALF,
     2187    24591    6                                    2);
     2188    24592
     2189    24593    6                               IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM.
     2190    24594    6                                    OFFSET(0)));
     2191    24595
     2192    24596    7                               DO K=0 TO KL_HNDLR.IPARAM.ARRAY_SZ(J);
     2193    24597    7                                    CALL KLX$9TO8(IN$->B$PARAMI(K),
     2194    24598    7                                         OUT$->B$PARAMI(K),
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:207  
     2195    24599    7                                         2);
     2196    24600    7                                  END;
     2197    24601
     2198    24602    6                               OUT$ = PINCRW(OUT$,ARRAY_WDSZ);
     2199    24603
     2200    24604    6                             END /*do J=0 to .NPARAMI-1*/;
     2201    24605    5                        END/* do if NPARAMI ~= 0*/;
     2202    24606    4                   END/* do if NPARAMS ~= 0*/;
     2203    24607    3              END;                         /* ELSE */
     2204    24608    2           KL$CONTROL_INIT.TYPE = 1;       /* ACK */
     2205    24609    3           DO WHILE('0'B);
     2206    24610    3   NETCON_ALT:  KL$CONTROL_INIT.TYPE = 0;  /* NAK */
     2207    24611    3              END;                         /* DO NEVER */
     2208    24612    2           SIZE = SIZEC(KL$CONTROL_INIT);
     2209    24613    2           CALL KLX$WRHLPNODE(KL$CONTROL_INIT,SIZE,FEX);
     2210    24614        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:208  
     2211    24615    2        CASE(IGA_CONTROL);
     2212    24616    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */
     2213    24617    4                CALL KLX$CONV_NODENAME(KL$CONTROL.NODE,FEX,NODETYPE) WHENALTRETURN DO;
     2214    24618    4                     CALL XUR$ERRTOLCP6(KL$CONTROL.RESULTS,NOFE);
     2215    24619    4                     GOTO CONT_ERR;
     2216    24620    4                   END;
     2217    24621    3                KL$CONTROL.SRCE_NODE = KL_NODE;
     2218    24622    4                CALL KLX$WRHLPNODE(KL$CONTROL,SIZEC(KL$CONTROL),FEX) WHENALTRETURN DO;
     2219    24623    4                     CALL XUR$ERRTOLCP6(KL$CONTROL.RESULTS,NODENA);
     2220    24624    4   CONT_ERR:         ;
     2221    24625    4                     KL$CONTROL.TYPE = 0;  /* NAK */
     2222    24626    5                     CALL KLX$WRHLPSTA(KL$CONTROL,SIZEC(KL$CONTROL),KL$CONTROL.ORIGIN)
             24626                              WHENALTRETURN DO;
     2223    24627                         /*N* WHAT DO WE DO? */
     2224    24628    5                        END;               /* WHENALTRETURN */
     2225    24629    4                   END;                    /* WHENALTRETURN */
     2226    24630    3              END;                         /* IF */
     2227    24631    3           ELSE DO;                        /* Msg is from FEP */
     2228    24632    4                CALL KLX$WRHLPSTA(KL$CONTROL,SIZEC(KL$CONTROL),KL$CONTROL.ORIGIN)
             24632                         WHENALTRETURN DO;
     2229    24633                            /*N* WHAT DO WE DO?  */
     2230    24634    4                   END;                    /* WHENALTRETURN */
     2231    24635    3              END;                         /* ELSE */
     2232    24636        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:209  
     2233    24637    2        CASE(IGA_RESET);
     2234    24638    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */
     2235    24639    3                CALL KLX$CONV_NODENAME (KL$CNFG_MSG.NODE,FEX,NODETYPE)
     2236    24640    3                WHENRETURN
     2237    24641    4                DO;
     2238    24642    4                     IF NODETYPE ~= %KL_NODETYPE_FEP
     2239    24643    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2240    24644    4                     THEN
     2241    24645    4                          GOTO SEND_RESET_ERR;
     2242    24646    4                     KL$CNFG_MSG.SRCE_NODE = KL_NODE;
     2243    24647    4                     CALL KLX$WRHLPNODE(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),FEX)
     2244    24648    4                     WHENALTRETURN
     2245    24649    5                     DO;
     2246    24650    5                          CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NODENA);
     2247    24651                             /*E* ERROR: KLI-E$NODENA-4
     2248    24652                               MESSAGE: That node is not currently available.
     2249    24653                             */
     2250    24654    5                          CALL KLX$WRHLPSTA (KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG
             24654                                   .ORIGIN);
     2251    24655    5                        END;
     2252    24656    4                   END;
     2253    24657    3                WHENALTRETURN
     2254    24658    4                DO;
     2255    24659    4   SEND_RESET_ERR:   ;
     2256    24660    4                     CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NOFE);
     2257    24661                             /*E* ERROR: KLI-E$NOFE-4
     2258    24662                                  MESSAGE: That FEP does not exist.
     2259    24663                             */
     2260    24664    4                     CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.
             24664                              ORIGIN);
     2261    24665    4                   END;
     2262    24666    3              END;                         /* IF */
     2263    24667    2           ELSE
     2264    24668    3           DO;
     2265    24669    4                CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.ORIGIN)
             24669                         WHENALTRETURN DO;
     2266    24670                            /*N* WHAT DO WE DO?  */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:210  
     2267    24671    4                   END;                    /* WHENALTRETURN */
     2268    24672    3              END;
     2269    24673        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:211  
     2270    24674    2        CASE(IGA_CHNDISP);
     2271    24675    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */
     2272    24676    3                CALL KLX$CONV_NODENAME (KL$ADMIN.NODE,FEX,NODETYPE)
     2273    24677    4                WHENRETURN DO;
     2274    24678    4                     IF NODETYPE ~= %KL_NODETYPE_FEP
     2275    24679    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2276    24680    4                     THEN
     2277    24681    4                          GOTO SEND_CHNDISP_ERR;
     2278    24682    4                     KL$ADMIN.SRCE_NODE = KL_NODE;
     2279    24683    4                     CALL KLX$WRHLPNODE(KL$ADMIN,SIZEC(KL$ADMIN),FEX)
     2280    24684    5                     WHENALTRETURN DO;
     2281    24685    5                          CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NODENA);
     2282    24686                       /*   ERROR: KLI-E$NODENA-4
     2283    24687                            MESSAGE: That node is not currently available.
     2284    24688                             */
     2285    24689    5                          CALL KLX$WRHLPSTA (KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);
     2286    24690    5                        END;
     2287    24691    4                   END;
     2288    24692    4                WHENALTRETURN DO;
     2289    24693    4   SEND_CHNDISP_ERR: ;
     2290    24694    4                     CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NOFE);
     2291    24695                  /*   ERROR: KLI-E$NOFE-4
     2292    24696                       MESSAGE: That FEP does not exist.
     2293    24697                        */
     2294    24698    4                     CALL KLX$WRHLPSTA(KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);
     2295    24699    4                   END;
     2296    24700    3              END;                         /* IF */
     2297    24701    2           ELSE
     2298    24702    2                CALL KLX$WRHLPSTA(KL$ADMIN,KL_MARS,KL$ADMIN.ORIGIN);
     2299    24703        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:212  
     2300    24704    2        CASE(IGA_ADMIN);
     2301    24705    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */
     2302    24706    3                CALL KLX$CONV_NODENAME (KL$ADMIN.NODE,FEX,NODETYPE)
     2303    24707    4                WHENRETURN DO;
     2304    24708    4                     IF NODETYPE ~= %KL_NODETYPE_FEP
     2305    24709    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2306    24710    4                     THEN
     2307    24711    4                          GOTO SEND_ADMIN_ERR;
     2308    24712    4                     KL$ADMIN.SRCE_NODE = KL_NODE;
     2309    24713    4                     CALL KLX$WRHLPNODE(KL$ADMIN,SIZEC(KL$ADMIN),FEX)
     2310    24714    5                     WHENALTRETURN DO;
     2311    24715    5                          CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NODENA);
     2312    24716                       /*   ERROR: KLI-E$NODENA-4
     2313    24717                            MESSAGE: That node is not currently available.
     2314    24718                             */
     2315    24719    5                          CALL KLX$WRHLPSTA (KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);
     2316    24720    5                        END;
     2317    24721    4                   END;
     2318    24722    4                WHENALTRETURN DO;
     2319    24723    4   SEND_ADMIN_ERR:   ;
     2320    24724    4                     CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NOFE);
     2321    24725                  /*   ERROR: KLI-E$NOFE-4
     2322    24726                       MESSAGE: That FEP does not exist.
     2323    24727                        */
     2324    24728    4                     CALL KLX$WRHLPSTA(KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);
     2325    24729    4                   END;
     2326    24730    3              END;                         /* IF */
     2327    24731    2           ELSE
     2328    24732    2                IF KL$ADMIN.ORIGIN = 'KHA$ADMN' /* Fep telling us change */
     2329    24733    2                THEN
     2330    24734    3                DO CASE (KL$ADMIN.FNC);
     2331    24735
     2332    24736    3                CASE (%KHA_FNC_DISCONNECT_EVT);
     2333    24737    3                   FPT_WRSYSLOG.V.TYPE# = EL_DISC;
     2334    24738    3                   KL_NETWORK_KEY.KEY.NODE = FEX;
     2335    24739    3                   KL_NETWORK_KEY.KEY.TERMID = KL$ADMIN.TERMID_LO;
     2336    24740    3                   KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:213  
     2337    24741    3                   KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;
     2338    24742    3                   KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     2339    24743    3                   CALL M$READ (KL_RD_NETWORK)
     2340    24744    4                   WHENRETURN DO;
     2341    24745                                                /* Tell ELF */
     2342    24746    4                        KL_PCD = '0'B;
     2343    24747    4                        ADDR(KL_PCD)->KL$ACCTNG.DEVNM = KL_NETWORK_BUF.DEVNM;
     2344    24748    4                        ADDR(KL_PCD)->KL$ACCTNG.FEX = FEX;
     2345    24749    4                        ADDR(KL_PCD)->KL$ACCTNG.REASON = %KLDR_LINE;
     2346    24750    4                        KL_DR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     2347    24751    4                        CALL M$DELREC (KL_DR_NETWORK)
     2348    24752    5                        WHENALTRETURN DO;
     2349    24753    5                           END;
     2350    24754    4                        KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.KEY);
     2351    24755    4                        KL_NETWORK_TERMKEY.KEY.TERMNAME = KL_NETWORK_BUF.TERMNAME;
     2352    24756    4                        KL_DR_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);
     2353    24757    4                        CALL M$DELREC (KL_DR_NETWORK)
     2354    24758    5                        WHENALTRETURN DO;
     2355    24759    5                           END;
     2356    24760    4                        IF KL$ADMIN.TERMID_LO.LEV = %TERMINAL_ID_LEV_CHAN#
     2357    24761    4                        THEN
     2358    24762    4                             GOTO WRTSYSLOG;
     2359    24763    4                      END;
     2360    24764
     2361    24765    3                CASE (%KHA_FNC_ACTIVE);
     2362    24766    3                   FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE;
     2363    24767
     2364    24768    3   TELL_ELF:       ;
     2365    24769    3                   KL_NETWORK_KEY.KEY.NODE = FEX;
     2366    24770    3                   KL_NETWORK_KEY.KEY.TERMID = KL$ADMIN.TERMID_LO;
     2367    24771    3                   KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;
     2368    24772    3                   KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     2369    24773    3                   KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     2370    24774    3                   CALL M$READ (KL_RD_NETWORK)
     2371    24775    4                   WHENRETURN DO;
     2372    24776    4                        KL_PCD = '0'B;
     2373    24777    4                        ADDR(KL_PCD)->KL$ACCTNG.DEVNM = KL_NETWORK_BUF.DEVNM;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:214  
     2374    24778    4                        ADDR(KL_PCD)->KL$ACCTNG.FEX = FEX;
     2375    24779    4                        IF FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE
     2376    24780    5                        THEN DO;
     2377    24781    5                             KL_HLPKEY = KL_NETWORK_BUF.HLPKEY;
     2378    24782    5                             CALL M$READ (KL_RDHLPR)
     2379    24783    6                             WHENRETURN DO;
     2380    24784    6                                  IF KL_HLPR.FLAGS.GJOB
     2381    24785    6                                  THEN
     2382    24786    7                                  DO;
     2383    24787    7                                       PARM$ = ADDR(KL_HLPR);
     2384    24788    7                                       CALL INDEX (I,' ',KL$DREC.GJOB.UNAME);
     2385    24789    7                                       UNAME.C = I;
     2386    24790    7                                       UNAME.T = KL$DREC.GJOB.UNAME;
     2387    24791    7                                       CALL JGG$TGJOB (UNAME,KL$DREC.GJOB.ACCT,
     2388    24792        /*
     2389    24793                gjob.cmdcnt is a word count field and tgjob expects a textc
     2390    24794                string.  pincrc to use last byte of cmdcnt field.
     2391    24795        */
     2392    24796    7                                            KL$DREC.GJOB.PASS,PINCRC(ADDR(KL$DREC.GJOB.
             24796                                                     CMDCNT),3)->TEXT$C);
     2393    24797    7                                     END;  /* if gjob */
     2394    24798    6                                END;
     2395    24799    5                           END;
     2396    24800    4                        GOTO WRTSYSLOG;
     2397    24801    4                      END;
     2398    24802    4                   WHENALTRETURN DO;
     2399    24803    4                        IF (KL$ADMIN.TERMID_LO.TTYP = %KLTY_CONT# OR
     2400    24804    4                             KL$ADMIN.TERMID_LO.TTYP = %KLTY_LINK# OR
     2401    24805    4                             KL$ADMIN.TERMID_LO.TTYP = %KLTY_VIRCIR#) AND
     2402    24806    5                             FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE THEN DO;
     2403    24807    6                             IF KL$ADMIN.TERMID_LO.TTYP = %KLTY_LINK# THEN DO;
     2404    24808    6                                  CONFIG_KEY.NODE=FEX;
     2405    24809    6                                  CONFIG_KEY.TERMID = KL$ADMIN.TERMID_LO;
     2406    24810    6                                  CONFIG_KEY.TERMID.TTYP = 0;
     2407    24811    6                                  CONFIG_KEY.TERMID.TERM.TERM_NAME = ' ';
     2408    24812    6                                  KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);
     2409    24813    6                                  KL_RD_NETCON.KEY_ = VECTOR(CONFIG_KEY);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:215  
     2410    24814    6                                END;
     2411    24815    6                             ELSE DO;
     2412    24816                                           /* use the termname as the logon string */
     2413    24817    6                                  LINCNFG.LGN.LGNSIZE = LENGTHC(KL$ADMIN.TERMID_LO.TERM
             24817                                           .TERM_NAME);
     2414    24818    6                                  LINCNFG.LGN.LGNSTRING = KL$ADMIN.TERMID_LO.TERM.
             24818                                           TERM_NAME;
     2415    24819    6                                  GOTO DOSGSCAN;
             24819                                           /* as skip the config since there isn't one */
     2416    24820    6                                END;
     2417    24821    6                             CALL M$READ(KL_RD_NETCON) WHENRETURN DO;
     2418    24822    7   DOSGSCAN:                      CALL KLH$SGSCAN(LINCNFG.LGN,ACCT,UNAME,PASS,PRO,ERR,
             24822            HOSTNAME,NOSETUP,NOHEADER) WHENRETURN DO;
     2419    24823    7                                       IF HOSTNAME = ' ' THEN
     2420    24824    7                                            HOSTNAME = KL_NODENAME;
     2421    24825    7                                     END;
     2422    24826    6                                  KL_NETWORK_VALID = '0'B;
     2423    24827    6                                  KL_HLPKEY.ACCT=ACCT;
     2424    24828    6                                  KL_HLPKEY.NAME=UNAME.T;
     2425    24829    6                                  KL_HLPKEY.CNT=8+UNAME.C;
     2426    24830    7                                  CALL M$READ(KL_RDHLPR) WHENALTRETURN DO;
     2427    24831    7                                       RETURN;
     2428    24832    7                                     END;
     2429    24833                                                /* active without a :network record */
     2430    24834                                      /* stuff a record into :network for this device */
     2431    24835                                                /* Save the terminal name in :NETWORK */
     2432    24836    6                                  KL_NETWORK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_LINE;
     2433    24837    6                                  KL_NETWORK_KEY.KEY.NODE = FEX;
     2434    24838    6                                  KL_NETWORK_KEY.KEY.TERMID = KL$ADMIN.TERMID_LO;
     2435    24839    6                                  KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;
     2436    24840    6                                  KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     2437    24841    6                                  CALL M$TIME(KL_NETWORK_TIME);
     2438    24842    6                                  KL_NETWORK_BUF.DEVNM = ACCT;
     2439    24843    6                                  KL_NETWORK_BUF.TERMNAME = ACCT;
     2440    24844    6                                  KL_NETWORK_BUF.ACCT = ACCT;
     2441    24845    6                                  KL_NETWORK_BUF.HLPKEY = KL_HLPKEY;
     2442    24846    6                                  KL_NETWORK_BUF.ATYP = KL_HLPR.ATYP;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:216  
     2443    24847    6                                  KL_NETWORK_BUF.TERMINAL_ID = KL$ADMIN.TERMID_LO;
     2444    24848    6                                  KL_NETWORK_BUF.NODE = FEX;
     2445    24849    6                                  KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     2446    24850    6                                  KL_WR_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);
     2447    24851    7                                  CALL M$WRITE (KL_WR_NETWORK) WHENALTRETURN DO;
     2448    24852    7                                       RETURN;
     2449    24853    7                                     END;
     2450    24854    6                                  KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.
             24854                                           KEY);
     2451    24855    6                                  KL_NETWORK_TERMKEY.KEY.TERMNAME = ACCT;
     2452    24856    6                                  KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);
     2453    24857    7                                  CALL M$WRITE (KL_WR_NETWORK) WHENALTRETURN DO;
     2454    24858    7                                     END;
     2455    24859
     2456    24860                                      /* Inform ELF about the device going active */
     2457    24861    6                                  KL_PCD = '0'B;
     2458    24862    6                                  KL_PCD.ADDD.FEX = FEX;
     2459    24863    6                                  KL_PCD.ADDD.TERMID.LEV = KL$ADMIN.TERMID_LO.LEV;
     2460    24864    6                                  CALL KLX$8TO9(KL$ADMIN.TERMID_LO.TERM.CHANNEL,KL_PCD.
             24864                                           ADDD.TERMID.CHAN,2);
     2461    24865    6                                  CALL KLX$8TO9(KL$ADMIN.TERMID_LO.TERM.SUBDEVICE,
             24865                                           KL_PCD.ADDD.TERMID.SUB,2);
     2462    24866    6                                  CALL KLX$8TO9(KL$ADMIN.TERMID_LO.TERM.SUBSUBDEVICE,
             24866                                           KL_PCD.ADDD.TERMID.SUBSUB,2);
     2463    24867    6                                  CALL KLX$CONV_NODE(KL_PCD.ADDD.FEPNAME,FEX,NODETYPE);
     2464    24868    6                                  KL_PCD.ADDD.ACTYP = %KLAC_TRM;
     2465    24869    6                                  KL_PCD.ADDD.ASSOCTRM = ACCT;
     2466    24870    6                                  KL_PCD.ADDD.TNAME = KL_HLPR.TNAME;
     2467    24871    6                                  KL_PCD.ADDD.TWSN = KL_HLPR.TWSN#;
     2468    24872    6                                  KL_PCD.ADDD.ATYP = KL_HLPR.ATYP;
     2469    24873    6                                  KL_PCD.ADDD.DEVNM = ACCT;
     2470    24874    6                                  FPT_WRSYSLOG.V.TYPE# = EL_CONN;
     2471    24875    6   WRTSYSLOG2:                    ;
     2472    24876    7                                  CALL M$WRSYSLOG (FPT_WRSYSLOG) WHENALTRETURN DO;
     2473    24877    7                                       CALL M$WAIT (FPT_WAIT);
     2474    24878    7                                       GOTO WRTSYSLOG2;
     2475    24879    7                                     END;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:217  
     2476    24880    6                                  FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE;
     2477    24881    6                                  KL$ADMIN.TERMID_LO.TTYP = 0;
             24881                                           /* so we dont loop if this fails */
     2478    24882    6                                  GOTO TELL_ELF;
     2479    24883    6                                END;       /* whenreturn klh$sgscan */
     2480    24884    5                           END;            /* cont or link or vircir */
     2481    24885    4                      END;                 /* whenaltreturn */
     2482    24886
     2483    24887    3                CASE (%KHA_FNC_NOTACTIVE);
     2484    24888    3                   FPT_WRSYSLOG.V.TYPE# = EL_NOTACTIVE;
     2485    24889    3                   GOTO TELL_ELF;
     2486    24890
     2487    24891    3                END;                       /* End cases */
     2488    24892    3                ELSE DO;                   /* Msg is from FEP */
     2489    24893    3                     IF KL$ADMIN.ORIGIN ~= 'KEYIN'
     2490    24894    3                     THEN
     2491    24895    4                          CALL KLX$WRHLPSTA(KL$ADMIN,KL_MARS,KL$ADMIN.ORIGIN)
             24895                                   WHENALTRETURN DO;
     2492    24896                            /*N* WHAT DO WE DO?  */
     2493    24897    4                             END;          /* WHENALTRETURN */
     2494    24898    4                     ELSE DO;
     2495    24899    4                          KBERR = CKBR;
     2496    24900    4                          KBERR.FEX = FEX;
     2497    24901    4                          KBERR.PORT.B = KL$ADMIN.TERMID_LO.TERM.CHANNEL.BYT(1);
     2498    24902    4                          KBERR.PORT.T = KL$ADMIN.TERMID_LO.TERM.CHANNEL.BYT(0);
     2499    24903    4                          KBERR.PORT_HI.B = KL$ADMIN.TERMID_HI.TERM.CHANNEL.BYT(1);
     2500    24904    4                          KBERR.PORT_HI.T = KL$ADMIN.TERMID_HI.TERM.CHANNEL.BYT(0);
     2501    24905    4                          KBERR.ERR = KL$ADMIN.FNC;
     2502    24906    4                          WKBER.BUF_ = VECTOR(KBERR);
     2503    24907    4                          IF KL$ADMIN.RESULTS = '0'B
     2504    24908    4                          THEN
     2505    24909    4                               KBERR.MSG# = NABL_MSG#;
     2506    24910    4                          ELSE
     2507    24911    4                               KBERR.MSG# = NABLERR_MSG#;
     2508    24912    4                          KBERR.CADDR = M_COMM;
     2509    24913    5                          CALL M$WRITE(WKBER) WHENALTRETURN DO;
     2510    24914    5                             END;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:218  
     2511    24915    4                        END;
     2512    24916    3                   END;                    /* ELSE */
     2513    24917        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:219  
     2514    24918    2        CASE(IGA_RUE);
     2515    24919    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */
     2516    24920    3                CALL KLX$CONV_NODENAME (KL$RUE.NODE,FEX,NODETYPE)
     2517    24921    4                WHENRETURN DO;
     2518    24922    4                     IF NODETYPE ~= %KL_NODETYPE_FEP
     2519    24923    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2520    24924    4                     THEN
     2521    24925    4                          GOTO SEND_RUE_ERR;
     2522    24926    4                     CALL KLX$WRHLPNODE(KL$RUE,SIZEC(KL$RUE),FEX)
     2523    24927    5                     WHENALTRETURN DO;
     2524    24928    5                          CALL XUR$ERRTOLCP6(KL$RUE.RESULTS,NODENA);
     2525    24929    5                          CALL KLX$WRHLPSTA (KL$RUE,SIZEC(KL$RUE),KL$RUE.ORIGIN);
     2526    24930    5                        END;
     2527    24931    4                   END;
     2528    24932    4                WHENALTRETURN DO;
     2529    24933    4   SEND_RUE_ERR:     ;
     2530    24934    4                     CALL XUR$ERRTOLCP6(KL$RUE.RESULTS,NOFE);
     2531    24935    4                     CALL KLX$WRHLPSTA(KL$RUE,SIZEC(KL$RUE),KL$RUE.ORIGIN);
     2532    24936    4                   END;
     2533    24937    3              END;                         /* IF */
     2534    24938    3           ELSE DO;                        /* Msg is from FEP */
     2535    24939    3                IF KL$RUE.ORIGIN ~= 'KEYIN'
     2536    24940    3                THEN
     2537    24941    4                     CALL KLX$WRHLPSTA(KL$RUE,SIZEC(KL$RUE),KL$RUE.ORIGIN)
             24941                              WHENALTRETURN DO;
     2538    24942                            /*N* WHAT DO WE DO?  */
     2539    24943    4                        END;               /* WHENALTRETURN */
     2540    24944    4                ELSE DO;
     2541    24945    4                     KBERR = CKBR;
     2542    24946    4                     CALL KLX$CONV_NODE(KBERR.NAME,FEX,NODETYPE);
     2543    24947    4                     KBERR.FEX = FEX;
     2544    24948    4                     KBERR.PORT.B = MOD(KL$RUE.SYSID#,256);
     2545    24949    4                     KBERR.PORT.T = KL$RUE.SYSID#/512;
     2546    24950    4                     WKBER.BUF_ = VECTOR(KBERR);
     2547    24951    4                     IF KL$RUE.RESULTS = '0'B
     2548    24952    4                     THEN
     2549    24953    4                          KBERR.ERR = 0;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:220  
     2550    24954    4                     ELSE
     2551    24955    4                          KBERR.ERR = 1;
     2552    24956    4                     KBERR.MSG# = X_MSG#;
     2553    24957    4                     KBERR.CADDR = M_COMM;
     2554    24958    5                     CALL M$WRITE(WKBER) WHENALTRETURN DO;
     2555    24959    5                        END;
     2556    24960    4                   END;
     2557    24961    3              END;                         /* ELSE */
     2558    24962        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:221  
     2559    24963    2        CASE(IGA_REQSTATS);
     2560    24964    3           IF SUBSTR(KL_STATION,0,2) = 'ST' THEN DO; /* Msg is from STATS */
     2561    24965    3                FEX = KL$REQSTATS.NODE_NUM;
     2562    24966    3                CALL KLX$CONV_NODE (KL$REQSTATS.FEPNAME,FEX,NODETYPE)
     2563    24967    4                WHENRETURN DO;
     2564    24968    4                     IF NODETYPE ~= %KL_NODETYPE_FEP
     2565    24969    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2566    24970    4                     THEN
     2567    24971    4                          GOTO SEND_REQSTATS_ERR;
     2568    24972    4                     KL$REQSTATS.SRCE_NODE = KL_NODE;
     2569    24973    4                     CALL KLX$WRHLPNODE(KL$REQSTATS,SIZEC(KL$REQSTATS),FEX)
     2570    24974    5                     WHENALTRETURN DO;
     2571    24975    5                          CALL XUR$ERRTOLCP6(KL$REQSTATS.ERRCODE,NODENA);
     2572    24976                       /*   ERROR: KLI-E$NODENA-4
     2573    24977                            MESSAGE: That node is not currently available.
     2574    24978                             */
     2575    24979    5                          CALL KLX$WRHLPSTA (KL$REQSTATS,SIZEC(KL$REQSTATS),KL$REQSTATS
             24979                                   .STATSSTA);
     2576    24980    5                        END;
     2577    24981    4                   END;
     2578    24982    4                WHENALTRETURN DO;
     2579    24983    4   SEND_REQSTATS_ERR: ;
     2580    24984    4                     CALL XUR$ERRTOLCP6(KL$REQSTATS.ERRCODE,NOFE);
     2581    24985                  /*   ERROR: KLI-E$NOFE-4
     2582    24986                       MESSAGE: That FEP does not exist.
     2583    24987                        */
     2584    24988    4                     CALL KLX$WRHLPSTA(KL$REQSTATS,SIZEC(KL$REQSTATS),KL$REQSTATS.
             24988                              STATSSTA);
     2585    24989    4                   END;
     2586    24990    3              END;                         /* IF */
     2587    24991    3           ELSE DO;                        /* Msg is from FEP */
     2588    24992    4                CALL KLX$WRHLPSTA(KL$REQSTATS,KL_MARS,KL$REQSTATS.STATSSTA)
             24992                         WHENALTRETURN DO;
     2589    24993                            /*N* WHAT DO WE DO?  */
     2590    24994    4                   END;                    /* WHENALTRETURN */
     2591    24995    3              END;                         /* ELSE */
     2592    24996        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:222  
     2593    24997    2        CASE(IGA_CNFG_MSG);
     2594    24998    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */
     2595    24999    3                CALL KLX$CONV_NODENAME (KL$CNFG_MSG.NODE,FEX,NODETYPE)
     2596    25000    4                WHENRETURN DO;
     2597    25001    4                     IF NODETYPE ~= %KL_NODETYPE_FEP
     2598    25002    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2599    25003    4                     THEN
     2600    25004    4                          GOTO SEND_CNFG_MSG_ERR;
     2601    25005    4                     CALL KLX$WRHLPNODE(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),FEX)
     2602    25006    5                     WHENALTRETURN DO;
     2603    25007    5                          CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NODENA);
     2604    25008                       /*   ERROR: KLI-E$NODENA-4
     2605    25009                            MESSAGE: That node is not currently available.
     2606    25010                             */
     2607    25011    5                          CALL KLX$WRHLPSTA (KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG
             25011                                   .ORIGIN);
     2608    25012    5                        END;
     2609    25013    4                   END;
     2610    25014    4                WHENALTRETURN DO;
     2611    25015    4   SEND_CNFG_MSG_ERR: ;
     2612    25016    4                     CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NOFE);
     2613    25017                  /*   ERROR: KLI-E$NOFE-4
     2614    25018                       MESSAGE: That FEP does not exist.
     2615    25019                        */
     2616    25020    4                     CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.
             25020                              ORIGIN);
     2617    25021    4                   END;
     2618    25022    3              END;                         /* IF */
     2619    25023    3           ELSE DO;                        /* Msg is from FEP */
     2620    25024    4                CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.ORIGIN)
             25024                         WHENALTRETURN DO;
     2621    25025                            /*N* WHAT DO WE DO?  */
     2622    25026    4                   END;                    /* WHENALTRETURN */
     2623    25027    3              END;                         /* ELSE */
     2624    25028        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:223  
     2625    25029    2        CASE (IGA_NODEINFO);
     2626    25030    2           CALL KLX$WRHLPNODE(KL$NODEINFO,SIZEC(KL$NODEINFO),KL_NODE);
     2627    25031
     2628    25032    2        CASE (IGA_NODECHG);
     2629    25033    2           CALL KLX$WRHLPNODE (KL$NODECHG,SIZEC(KL$NODECHG),KL_NODE);
     2630    25034
     2631    25035    2        CASE(IGA_TIME);                    /* The time has changed */
     2632    25036    2           LEN = BITBIN(KL$TIME.UTS);      /* get it into an aligned variable. */
     2633    25037    2           CALL KLI$GETFEPERA(LEN,I);
     2634    25038    2           I = (I + 2)/4;
     2635    25039    2           CALL KLX$9TO8(I,KL$TIME.UTS,4);
     2636    25040    3           DO FEX = 0 TO KL_MXFE;
     2637    25041    3                IF KL_FETBL.BOSS(FEX) OR FEX = KL_NODE THEN
     2638    25042        /*
     2639    25043                         me or my nodes then set the time
     2640    25044        */
     2641    25045
     2642    25046    3                     CALL KLX$WRHLPNODE(KL$TIME,SIZEC(KL$TIME),FEX);
     2643    25047    3              END;
     2644    25048
     2645    25049    2        CASE(IGA_DUMPMSG);                 /* Dump message for FROG */
     2646    25050    2           CALL KLX$8TO9(KL$DUMPMSG.DATASIZE,DATASIZE,2);
     2647    25051    2           KL$DUMPMSG.CSHDR.KEY#=0;
     2648    25052    2           KL$DUMPMSG.CSHDR.FUNCTION=%KLFR_NA2FROG;
     2649    25053    2           WRT_NA2FROG.BUF_=VECTOR(KL$DUMPMSG);
     2650    25054    3           CALL M$WRITE(WRT_NA2FROG) WHENALTRETURN DO; END;
     2651    25055
     2652    25056    2        CASE(IGA_UPDOSI,IGA_DELOSI);
     2653    25057    2           KL_NETWORK_VALID = '0'B;
     2654    25058    2           KL_RD_NETCON.BUF_ = VECTOR(KL_EXTRSP_BUF);
     2655    25059    2           KL_RD_NETCON.KEY_ = VECTOR(KL$NETWORK_KEY);
     2656    25060    3           CALL M$READ (KL_RD_NETCON) WHENRETURN DO;
     2657    25061    4                DO I = 0 TO KL$NETWORK.NODE#;
     2658    25062    4                     IF (KL_FETBL.BOSS(I) AND KL_FETBL.ACTIVE(I) AND NOT KL_FETBL.
             25062                              HOST_NODE(I))
     2659    25063    4                          OR I = KL_NODE THEN
     2660    25064    4                          CALL KLX$WRHLPNODE(KL$UPDOSI,SIZEC(KL$UPDOSI),I);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:224  
     2661    25065    4                     CALL KLI$GETSNPA(I);  /* update new entrys link info */
     2662    25066    4                   END;                    /* do i */
     2663    25067    3              END;                         /* when return */
     2664    25068        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:225  
     2665    25069        /*
     2666    25070                iga_osilinkchg
     2667    25071                   an osi link has changed state(up / down).
     2668    25072                      down:delete the record from :network.
     2669    25073                      up:write new info toe :network.
     2670    25074                      forward the message to kub$baboon to modify the tables on this node.
     2671    25075                      update mynode and forward the message to any linkconnected nodes
     2672    25076                         except the one that sent us this message
     2673    25077        */
     2674    25078    2        CASE (IGA_OSILINKCHG,IGA_OSILINKCHG_DF);
     2675    25079    2           OSILINK_KEY = '0'B;
     2676    25080    2           OSILINK_KEY.SIZE = LENGTHC(OSILINK_KEY.KEY);
     2677    25081    2           OSILINK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_OSILINK;
     2678    25082    2           OSILINK_KEY.KEY.NODE = FEX;
     2679    25083    2           OSILINK_KEY.KEY.TERMID.LEV = %TERMINAL_ID_LEV_CHAN#;
     2680    25084    2           OSILINK_KEY.KEY.TERMID.TERM = KL$OSILINKCHG.TERMID.TERM;
     2681    25085    3           IF KL$OSILINKCHG.TYPE = IGA_OSILINKDOWN THEN DO;
     2682    25086    3                KL_DR_NETWORK.KEY_ = VECTOR(OSILINK_KEY);
     2683    25087    4                CALL M$DELREC(KL_DR_NETWORK) WHENALTRETURN DO;
     2684    25088                      /*  should errlog this, but until then...
     2685    25089                          just assume we dropped the original write and go ahead and
     2686    25090                          forward the message as if nothing happened.  who us?*/
     2687    25091    4                   END;
     2688    25092    3              END;                         /* if iga_osilinkdown */
     2689    25093    3           ELSE DO;
     2690    25094    3                KL_WR_NETWORK.KEY_ = VECTOR(OSILINK_KEY);
     2691    25095    3                OSILINK_BUF.QOS = KL$OSILINKCHG.QOS;
     2692    25096    3                OSILINK_BUF.SNPA = KL$OSILINKCHG.SNPA;
     2693    25097    3                KL_WR_NETWORK.BUF_ = VECTOR(OSILINK_BUF);
     2694    25098    4                CALL M$WRITE(KL_WR_NETWORK) WHENALTRETURN DO;
     2695    25099    4                     KL_NWF = KL_NWF + 1;  /* number of Network Write Failures*/
     2696    25100    4                     KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     2697    25101    4                     KL_WR_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);
     2698    25102    4                     RETURN;
     2699    25103    4                   END;                    /* whenaltreturn */
     2700    25104    3                KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     2701    25105    3                KL_WR_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:226  
     2702    25106    3              END;                         /* else osilinkup */
     2703    25107                   /*
     2704    25108                         tell baboon.
     2705    25109                   */
     2706    25110                /*
     2707    25111                   return on _df because we will get another linkchg to propagate
     2708    25112                   this message is from a remote connected fep
     2709    25113                   */
     2710    25114    2           IF KL$OSILINKCHG.FCN = IGA_OSILINKCHG_DF THEN RETURN;
     2711    25115    2           CALL KLX$WRHLPNODE(KL$OSILINKCHG,SIZEC(KL$OSILINKCHG),KL_NODE);
     2712    25116
     2713    25117                /*
     2714    25118                   forward to the other nodes
     2715    25119                */
     2716    25120    2           OSILINKCHG = KL$OSILINKCHG;
     2717    25121    2           OSILINKCHG.MYNODE# = KL_NODE;   /* but change mynode to our node# */
     2718    25122    3           DO I = 0 TO KL_NODES;
     2719    25123    3                IF KL_FETBL.LINK_CONNECT(I) AND KL_FETBL.BOSS(I)
     2720    25124    4                     AND KL_FETBL.ACTIVE(I) AND I ~= KL$OSILINKCHG.MYNODE# THEN DO;
     2721    25125    4                     CALL KLX$WRHLPNODE(OSILINKCHG,SIZEC(OSILINKCHG),I);
     2722    25126    4                   END;
     2723    25127    3              END;                         /* do i */
     2724    25128    2        END;                               /*CASE*/
     2725    25129    1        RETURN;
     2726    25130        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:227  
     2727    25131    1   KLI$GETROUTES: ENTRY;
     2728    25132    1        CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4));
     2729    25133    2        DO I = 0 TO KL_NODES;
     2730    25134    2             IF FEX ~= KL_NODE             /* Not this node */
     2731    25135    3             THEN DO;
     2732    25136    3                  NODECHG.FCN = IGA_NODECHG;
     2733    25137    3                  NODECHG.MYNODE = KL_NODE;
     2734    25138    3                  NODECHG.NODE = I;
     2735    25139    3                  NODECHG.QOS = MINIMUM(KL_FETBL.QOS(I) + KL_HOPCOST,255);
     2736    25140    3                  IF KL_FETBL.HOST_NODE(I)
     2737    25141    3                  THEN
     2738    25142    3                       NODECHG.HOSTNODE = 1;
     2739    25143    3                  ELSE
     2740    25144    3                       NODECHG.HOSTNODE = 0;
     2741    25145    3                  CALL KLX$WRHLPNODE(NODECHG,SIZEC(NODECHG),FEX);
     2742    25146    3                END;
     2743    25147    2           END;
     2744    25148    1        RETURN;
     2745    25149        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:228  
     2746    25150    1   KLI$RECOVERY: ENTRY;
     2747    25151
     2748    25152    1        CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4)); /* Fex recovery is in station */
     2749    25153    1        CTX$ = CTXHD$;
     2750    25154    1        PREV$ = CTX$;
     2751    25155
     2752    25156    2        DO WHILE(CTX$ ~= ADDR(NIL));
     2753    25157    2             IF CTX$->DVCERRCTX.FEX = FEX  /* Need to get rid of this one */
     2754    25158    3             THEN DO;
     2755    25159    3                  FEPMES.DEVNM = CTX$->DVCERRCTX.DEVNM;
     2756    25160    3                  FEPMES.MSGID = CTX$->DVCERRCTX.MSGID;
     2757    25161    3                  FEPMES.NPARAMS = 0;
     2758    25162    3                  FEPMES.FCN = OC_STTM;
     2759    25163    3                  FEPMES.CADDR = M_DEVC;
     2760    25164    3                  WKBER.BUF_ = VECTOR(FEPMES);
     2761    25165    3                  CALL M$WRITE (WKBER)
     2762    25166    4                  WHENALTRETURN DO;
     2763    25167    4                     END;
     2764    25168    3                  IF CTX$ = CTXHD$
     2765    25169    3                  THEN
     2766    25170    3                       CTXHD$ = CTX$->DVCERRCTX.LNK$;
     2767    25171    3                  ELSE
     2768    25172    3                       PREV$->DVCERRCTX.LNK$ = CTX$->DVCERRCTX.LNK$;
     2769    25173    3                  MESS$ = CTX$;
     2770    25174    3                  CTX$ = CTX$->DVCERRCTX.LNK$;
     2771    25175    3                  CALL KLB$REL(MESS$);
     2772    25176    3                END;
     2773    25177    3             ELSE DO;
     2774    25178    3                  PREV$ = CTX$;
     2775    25179    3                  CTX$ = CTX$->DVCERRCTX.LNK$;
     2776    25180    3                END;
     2777    25181    2           END;
     2778    25182
     2779    25183        /* Send configuration response for all pending configs */
     2780    25184    1        CTX$ = KL_RSPPND$;
     2781    25185
     2782    25186    2        DO WHILE (CTX$ ~= ADDR(NIL));
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:229  
     2783    25187    2             KL$CONFIGRSP='0'B;
     2784    25188    2             KL$CONFIGRSP.FCN = IGA_CONFIGRSP;
     2785    25189    2             KL$CONFIGRSP.MSGID = KL$RSPPND.MSGID;
     2786    25190    2             KL$CONFIGRSP.NODE = KL_NODE;
     2787    25191    2             CALL KLX$ERR2NETERR(NODENA,KL$CONFIGRSP.NETERR);
     2788    25192    2             IF KL$RSPPND.NODE = FEX
     2789    25193    3             THEN DO;
     2790    25194    3                  CTX$ = KL$RSPPND.LNK$;
     2791    25195    3                  CALL KLC$CONFIG;
     2792    25196    3                END;
     2793    25197    2             ELSE
     2794    25198    2                  CTX$ = KL$RSPPND.LNK$;
     2795    25199    2           END;
     2796    25200    1        KL$DUMPABORT.CSHDR.KEY#=0;
     2797    25201    1        KL$DUMPABORT.CSHDR.FUNCTION=%KLFR_NA2FROG;
     2798    25202    1        KL$DUMPABORT.TYPE=%GI_DUMP_ABORT;
     2799    25203    1        KL$DUMPABORT.FEX=FEX;
     2800    25204    1        WRT_NA2FROG.BUF_=VECTOR(KL$DUMPABORT);
     2801    25205    2        CALL M$WRITE(WRT_NA2FROG) WHENALTRETURN DO; END;
     2802    25206
     2803    25207        /* Clear out :NETWORK */
     2804    25208        /*
     2805    25209             kl$line_key is based on CNFG_BUF which is used to
     2806    25210             precord to the beginning of the :network file.
     2807    25211        */
     2808    25212    1        KL$LINE_KEY = '0'B;
     2809    25213    1        KL$LINE_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     2810    25214    1        CALL M$PRECORD (STARTNETWORK)
     2811    25215    2        WHENALTRETURN DO;
     2812    25216    2           END;
     2813    25217    1        ERR = 0;
     2814    25218    1        KL_RD_NETWORK.V.KEYS# = '0'B;
     2815    25219    1        KL_RD_NETWORK.KEY_ = VECTOR(CNFG_BUF);
     2816    25220    1        KL_DR_NETWORK.KEY_ = VECTOR(CNFG_BUF);
     2817    25221    1        KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;
     2818    25222    1        KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     2819    25223    1        KL$LINE_KEY = KL_NETWORK_KEY;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:230  
     2820    25224
     2821    25225    2        DO WHILE (ERR = 0);
     2822    25226    2             CALL M$READ (KL_RD_NETWORK)
     2823    25227    3             WHENRETURN DO;
     2824    25228
     2825    25229    4                  DO CASE(KL$LINE_KEY.KEY.KEYTYP);
     2826    25230
     2827    25231    4                  CASE (%KL_NETWORK_KEYTYP_LINE,%KL_NETWORK_KEYTYP_OSILINK);
     2828    25232    4                     IF CNFG$->KL$LINE_KEY.KEY.NODE = FEX
     2829    25233    4                     THEN
     2830    25234    4                          CALL M$DELREC (KL_DR_NETWORK)
     2831    25235    5                          WHENALTRETURN DO;
     2832    25236    5                             END;
     2833    25237
     2834    25238    4                  CASE (%KL_NETWORK_KEYTYP_TERM);
     2835    25239
     2836    25240    4                     IF KL_NETWORK_BUF.NODE = FEX
     2837    25241    4                     THEN
     2838    25242    4                          CALL M$DELREC (KL_DR_NETWORK);
     2839    25243
     2840    25244    4                  END;                     /* end cases */
     2841    25245
     2842    25246    3                END;
     2843    25247    3             WHENALTRETURN DO;
     2844    25248    3                  ERR = 1;
     2845    25249    3                END;
     2846    25250
     2847    25251    2           END;                            /* End DO WHILE */
     2848    25252
     2849    25253    1        KL_RD_NETWORK.V.KEYS# = '1'B;
     2850    25254
     2851    25255
     2852    25256    1        RETURN;
     2853    25257        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:231  
     2854    25258    1   GETCONFIGS: PROC;
     2855    25259    2        IF SUBSTR(KL_STATION,0,4) = 'FEPA'
     2856    25260    2        THEN
     2857    25261    2             CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4));
     2858    25262
     2859    25263    2        KL_FROG.FUNCTION = %KLFR_UP;
     2860    25264    2        KL_FROG.FEX = FEX;
     2861    25265    2        CALL M$WRITE (WRT_FROG);
     2862    25266    2        KL_NETWORK_VALID = '0'B;
     2863    25267        /* Get the default handler records */
     2864    25268    2        DEFAULT_KEY.NODE = FEX;
     2865    25269    2        DEFAULT_KEY.HNDLR = ' ';
     2866    25270    2        FPT_PRECORD.KEY_ = VECTOR(DEFAULT_KEY);
     2867    25271    2        CALL M$PRECORD (FPT_PRECORD)
     2868    25272    3        WHENALTRETURN DO;
     2869    25273                                                /* It is expected */
     2870    25274    3           END;
     2871    25275    2        RD_NETCON.KEY_ = VECTOR(TDEFAULT_KEY);
     2872    25276
     2873    25277    2        CALL M$READ(RD_NETCON)
     2874    25278    3        WHENALTRETURN DO;
     2875    25279    3             TDEFAULT_KEY.TYP = 0;
     2876    25280    3           END;
     2877    25281    3        DO WHILE(TDEFAULT_KEY.TYP = %KL_KEYTYP_DEFAULT AND TDEFAULT_KEY.NODE = FEX);
     2878    25282    3             PSIZ = 0;
     2879    25283    3             CHNRSP = KL_CHNRSPC;
     2880    25284    3             CHNRSP.DFLTHND = '1'B;
     2881    25285    3             CHNRSP.TERMINAL_ID = '0'B;
     2882    25286    3             CHNRSP.HANDLER = TDEFAULT_KEY.HNDLR;
     2883    25287    3             CHNRSP.NA = LINCNFG.NA;
     2884    25288    3             CHNRSP.NA.CNFG_EXISTS = '0'B;
     2885    25289    3             CHNRSP.NA.AUTLGN = '0'B;
     2886    25290    3             CHNRSP.NA.PROFILE = '0'B;
     2887    25291    3             CHNRSP.HNDCMN = LINCNFG.KHA;
     2888    25292    3             CALL KLX$9TO8(PSIZ,CHNRSP.MESSAGE.MSGSIZE,2);
     2889    25293    3             IF LINCNFG.PRO.PROSIZE > 0
     2890    25294    4             THEN DO;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:232  
     2891    25295    4                  KL_PROKEY = LINCNFG.PRO;
     2892    25296    4                  CALL M$READ (KL_RDPROR)
     2893    25297    5                  WHENRETURN DO;
     2894    25298    5                       PSIZ = DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS-SIZEC(KL_PROBUF);
     2895    25299    5                       CALL KLX$9TO8(PSIZ,CHNRSP.MESSAGE.MSGSIZE,2);
     2896    25300    5                       ADDR(CHNRSP.MESSAGE.MESSAGE)->CHR$PSIZ = PINCRC(ADDR(KL_PROBUF),
             25300                                SIZEC(KL_PROBUF))->CHR$PSIZ;
     2897    25301    5                     END;
     2898    25302    4                END;
     2899    25303    3             ELSE
     2900    25304    3                  PSIZ = 0;
     2901    25305    3             CALL KLX$WRHLPNODE (CHNRSP,SIZEC(CHNRSP),FEX);
     2902    25306    3             CALL M$READ(RD_NETCON)
     2903    25307    4             WHENALTRETURN DO;
     2904    25308    4                  TDEFAULT_KEY.TYP = 0;
     2905    25309    4                END;
     2906    25310    3           END;
     2907    25311    2        CONFIG_KEY.NODE = FEX;
     2908    25312    2        CONFIG_KEY.TERMID.TTYP = 0;
     2909    25313    2        CONFIG_KEY.TERMID.LEV = 0;
     2910    25314    2        FPT_PRECORD.KEY_ = VECTOR(CONFIG_KEY);
     2911    25315    2        PSIZ=0;
     2912    25316    2        CALL M$PRECORD (FPT_PRECORD)
     2913    25317    3        WHENALTRETURN DO;
     2914    25318                                                /* It is expected */
     2915    25319    3           END;
     2916    25320    2        RD_NETCON.KEY_ = VECTOR(TCONFIG_KEY);
     2917    25321
     2918    25322    2        CALL M$READ(RD_NETCON)
     2919    25323    3        WHENALTRETURN DO;
     2920    25324    3             TCONFIG_KEY.TYP = 0;
     2921    25325    3           END;
     2922    25326    3        DO WHILE(TCONFIG_KEY.TYP = %KL_KEYTYP_CONFIG AND TCONFIG_KEY.NODE = FEX);
     2923    25327    3             CHNRSP = KL_CHNRSPC;
     2924    25328    3             CHNRSP.CONFIG = '1'B;
     2925    25329    3             CHNRSP.TERMINAL_ID = TCONFIG_KEY.TERMID;
     2926    25330    3             CHNRSP.NA = LINCNFG.NA;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:233  
     2927    25331    3             CHNRSP.NA.CNFG_EXISTS = '1'B;
     2928    25332    3             CHNRSP.HNDCMN = LINCNFG.KHA;
     2929    25333    3             CALL KLX$WRHLPNODE (CHNRSP,SIZEC(CHNRSP),FEX);
     2930    25334    3             CALL M$READ(RD_NETCON)
     2931    25335    4             WHENALTRETURN DO;
     2932    25336    4                  TCONFIG_KEY.TYP = 0;
     2933    25337    4                END;
     2934    25338    3           END;
     2935    25339
     2936    25340    2        CHNRSP = KL_CHNRSPC;
     2937    25341        /* Send a CHNRSP with a channel of 0 to get NA going */
     2938    25342    2        CHNRSP.TERMINAL_ID = '0'B;
     2939    25343    2        CALL KLX$WRHLPNODE (CHNRSP,SIZEC(CHNRSP),FEX);
     2940    25344
     2941    25345
     2942    25346    2        RETURN;
     2943    25347    2   END GETCONFIGS;
     2944    25348        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:234  
     2945    25349        /**/
     2946    25350    1   KBD: ;
     2947    25351    1        IF FEX>KL_MXFE THEN GOTO BDFEX;
     2948    25352    1        IF FEX = 0 OR KMSG.NAME = ' '      /* Undefined node */
     2949    25353    1        THEN
     2950    25354    1             GOTO BDFEX;
     2951    25355    1        ELSE GOTO KYERR;
     2952    25356    1   ERRORK:;
     2953    25357    1        KL_FETBL.KTYP(FEX)=ERRC;
     2954    25358    1   ERROR:;
     2955    25359    1        ERRC=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
     2956    25360    2        IF ERRC=%E$BADFEX THEN DO;
     2957    25361    2   BDFEX:    ;
     2958    25362    2             KBERR.MSG#=NOFE_MSG#;
     2959    25363    2             GOTO WTERR;
     2960    25364    2           END;
     2961    25365    2        IF ERRC=%E$FEPART THEN DO;
     2962    25366    2             KBERR.MSG#=FESP_MSG#;
     2963    25367    2             KBERR.ERR=KIER_PART;
     2964    25368    2             GOTO WTERR;
     2965    25369    2           END;
     2966    25370    1        IF ERRC=%E$CURBOOT THEN KBERR.ERR=%KLKT_BOOT#;
     2967    25371    1        ELSE IF ERRC=%E$FEPRUN THEN KBERR.ERR=%KLKT_NONE#;
     2968    25372    2             ELSE DO;
     2969    25373    2   STPERR:        ;
     2970    25374    2                  KBERR.ERR=%KLKT_STOP#;
     2971    25375    2                END;
     2972    25376    1   KYERR: ;
     2973    25377    1        KBERR.MSG#=FKER_MSG#;
     2974    25378    1   WTERR:;
     2975    25379    1        KBERR.CADDR=KMSG.CADDR;
     2976    25380    1   WRTKYN:;
     2977    25381    1        KBERR.NAME = KMSG.NAME;
     2978    25382    1        KBERR.FEX=FEX;
     2979    25383    1        WKBER.BUF_=VECTOR(KBERR);
     2980    25384    1        CALL M$WRITE (WKBER) ALTRET (RTN);
     2981    25385    1        RETURN;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:235  
     2982    25386        /**/
     2983    25387        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:236  
     2984    25388    1   BDSET: PROC ALTRET;
     2985    25389        /**/
     2986    25390    2        IF KL_FETBL.LINK_CONNECT(FEX)
     2987    25391    3        THEN DO;
     2988    25392    3             HLTFEP.V.FEP#=FEX;
     2989    25393    4             CALL M$FECTL (HLTFEP) WHENALTRETURN DO ;
     2990    25394    4                  ALTRETURN ;
     2991    25395    4                END ;
     2992    25396    3           END;
     2993    25397    3        ELSE DO;
     2994    25398    3             KL_FETBL.KTYP(FEX) = %KLKT_NONE#;
     2995    25399    3             IF KMSG.KIN# = KEY_CRASHFEP#
     2996    25400    3             THEN
     2997    25401    3                  BOOTMSG.CODE_ = IGA_CRASHFEP;
     2998    25402    3             ELSE
     2999    25403    3                  BOOTMSG.CODE_ = IGA_BOOTFEP;
     3000    25404    3             CALL KLX$WRHLPNODE (BOOTMSG,SIZEC(BOOTMSG),FEX)
     3001    25405    4             WHENALTRETURN DO;
     3002    25406    4                  ALTRETURN;
     3003    25407    4                END;
     3004    25408    3           END;
     3005    25409    2        RETURN;
     3006    25410        /**/
     3007    25411        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:237  
     3008    25412    2   STFEP: ENTRY ALTRET;
     3009    25413        /**/
     3010    25414    2        GOFEP.V.FEP#=FEX;
     3011    25415    3        CALL M$FECTL (GOFEP) WHENALTRETURN DO ;
     3012    25416    3             ALTRETURN ;
     3013    25417    3           END ;
     3014    25418    2        RETURN;
     3015    25419        /**/
     3016    25420    2   STPFEP: ENTRY ALTRET;
     3017    25421        /**/
     3018    25422    2        KL_FETBL.KTYP(FEX)=%KLKT_NONE#;
     3019    25423    3        IF KMSG.FID.CNT~=0 THEN DO;
     3020    25424    3             CALL KLX$WRHLPNODE(STPMSG,SIZEC(STPMSG),FEX);
     3021    25425    3             CALL M$WAIT (FPT_WAIT) ;      /* WAIT A SEC */
     3022    25426    3             KL_FETBL.KTYP(FEX)=%KLKT_STOP#;
     3023    25427    3             RETURN;
     3024    25428    3           END;
     3025    25429        /**/
     3026    25430    2   STFEPNM: ENTRY ALTRET ;
     3027    25431
     3028    25432    2        STOPFEP.V.FEP# = FEX ;
     3029    25433    2        KL_FETBL.KTYP ( FEX ) = %KLKT_STOP# ;
     3030    25434    3        CALL M$FECTL ( STOPFEP ) WHENALTRETURN DO ;
     3031    25435    3             KL_FETBL.KTYP ( FEX ) = %KLKT_NONE# ;
     3032    25436    3             ALTRETURN ;
     3033    25437    3           END ;
     3034    25438    2        RETURN ;
     3035    25439
     3036    25440        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:238  
     3037    25441    2   KCHK: ENTRY ALTRET;
     3038    25442        /**/
     3039    25443    2        FEX=KMSG.FEX;
     3040    25444    2        IF FEX = 0 AND KMSG.NAME = ' '
     3041    25445    2        THEN
     3042    25446    2             RETURN;
     3043    25447    2        IF FEX = 0
     3044    25448    2        THEN
     3045    25449    2             CALL KLX$CONV_NODENAME(KMSG.NAME,FEX,NODETYPE)
     3046    25450    3             WHENALTRETURN DO;
     3047    25451    3                  ALTRETURN;
     3048    25452    3                END;
     3049    25453    2        ELSE
     3050    25454    2             CALL KLX$CONV_NODE (KMSG.NAME,FEX,NODETYPE)
     3051    25455    3             WHENALTRETURN DO;
     3052    25456    3                  ALTRETURN;
     3053    25457    3                END;
     3054    25458    2        KMSG.FEX = FEX;
     3055    25459    2        IF (KL_FETBL.KTYP(FEX)=%KLKT_BOOT# OR KL_FETBL.KTYP(FEX)=%KLKT_DUMP#
     3056    25460    2             OR KL_FETBL.KTYP(FEX) = %KLKT_CRASH#) AND KMSG.KIN# < KEY_CRASHFEP#
     3057    25461    3        THEN DO;
     3058    25462    3             KBERR.ERR=KL_FETBL.KTYP(FEX);
     3059    25463    3             ALTRETURN;
     3060    25464    3           END;
     3061    25465    2        RETURN;
     3062    25466    2   END;
     3063    25467        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:239  
     3064    25468    1   LOCAL_CHECK: PROC ALTRET;
     3065    25469    2        IF KL_FETBL.LINK_CONNECT(FEX)
     3066    25470    2        THEN
     3067    25471    2             RETURN;
     3068    25472    2        KBERR=CKBR;
     3069    25473    2        KBERR.CADDR = KMSG.CADDR;
     3070    25474    2        KBERR.FEX = FEX;
     3071    25475    2        KBERR.NAME = KMSG.NAME;
     3072    25476    2        KBERR.MSG# = NLCL_MSG#;
     3073    25477    2        WKBER.BUF_ = VECTOR(KBERR);
     3074    25478    2        CALL M$WRITE (WKBER)
     3075    25479    3        WHENALTRETURN DO;
     3076    25480    3           END;
     3077    25481    2        ALTRETURN;
     3078    25482
     3079    25483    2   END LOCAL_CHECK;
     3080    25484        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:240  
     3081    25485    1   SENDCWNAK: PROC (NETADDR,ERR);
     3082    25486
     3083    25487    2   DCL 1 NETADDR UNAL,
     3084    25488    2            2 NODE UBIN BYTE CALIGNED,
     3085    25489    2            2 GENERATION UBIN BYTE CALIGNED,
     3086    25490    2            2 LDCTX UBIN(18) HALIGNED;
     3087    25491    2   DCL ERR BIT(36) UNAL;
     3088    25492
     3089    25493    2        CWNAK = '0'B;
     3090    25494    2        CWNAK.FCN = IGA_CWNAK;
     3091    25495    2        CWNAK.NETADR = NETADDR;
     3092    25496    2        CALL KLX$ERR2NETERR(ERR,CWNAK.NETERR);
     3093    25497    2        FEX = CWNAK.NETADR.NODE;
     3094    25498    2        IF FEX = KL_NODE
     3095    25499    2        THEN
     3096    25500    2             CALL KLX$WRHLPSTA(CWNAK,SIZEC(CWNAK),'BABOON  ');
     3097    25501    2        ELSE
     3098    25502    2             CALL KLX$WRHLPNODE(CWNAK,SIZEC(CWNAK),FEX);
     3099    25503
     3100    25504    2        RETURN;
     3101    25505
     3102    25506    2   END SENDCWNAK;
     3103    25507        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:241  
     3104    25508        /*I* NAME: I$8TO9
     3105    25509             PURPOSE: To pack up a series of L6 bytes &/ words.
     3106    25510        */
     3107    25511
     3108    25512    1   I$8TO9: PROC(SOURCE,DEST,BYTES,REPS);
     3109    25513
     3110    25514    2   DCL SOURCE(0:0) UBIN BYTE CALIGNED;
     3111    25515    2   DCL DEST(0:0) UBIN BYTE CALIGNED;
     3112    25516    2   DCL BYTES UBIN;
     3113    25517    2   DCL REPS UBIN;
     3114    25518
     3115    25519    2   DCL TEMP UBIN;
     3116    25520    2   DCL TEMP2 UBIN;
     3117    25521    2   DCL SRC$ PTR;
     3118    25522    2   DCL DST$ PTR;
     3119    25523    2   DCL T$ PTR;
     3120    25524    2   DCL BYT$8(0:0) UBIN(8) UNAL BASED;
     3121    25525    2   DCL BYT$9(0:0) UBIN BYTE CALIGNED BASED;
     3122    25526    2   DCL BIT$S BIT(BYTES) UNAL BASED;
     3123    25527
     3124    25528    2        DST$=ADDR(DEST);
     3125    25529    2        SRC$=ADDR(SOURCE);
     3126    25530    3        DO TEMP2=0 TO REPS-1;
     3127    25531    3             DST$->BIT$S='0'B;
     3128    25532    3             T$=PINCRB(DST$,BYTES);
     3129    25533    4             DO TEMP=0 TO BYTES-1;
     3130    25534    4                  T$->BYT$8(TEMP)=SRC$->BYT$9(TEMP);
     3131    25535    4                END;
     3132    25536    3             DST$=PINCRC(DST$,BYTES);
     3133    25537    3             SRC$=PINCRC(SRC$,BYTES);
     3134    25538    3           END;
     3135    25539    2        RETURN;
     3136    25540
     3137    25541    2   END I$8TO9;
     3138    25542    1   FIND_ERRCTX: PROC(TERMID) ALTRET;
     3139    25543
     3140    25544        %B$TERMINAL_ID(FPTN=TERMID,STCLASS=PARAM);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:242  
     3141    25573
     3142    25574    2        KL_NETWORK_KEY.KEY.NODE = FEX;
     3143    25575    2        KL_NETWORK_KEY.KEY.TERMID = TERMID;
     3144    25576    2        KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;
     3145    25577    2        KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);
     3146    25578    2        KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);
     3147    25579    2        KL_NETWORK_BUF.DEVNM = ' ';
     3148    25580    2        CALL M$READ(KL_RD_NETWORK)
     3149    25581    3        WHENALTRETURN DO;
     3150    25582    3             ALTRETURN;
     3151    25583    3           END;                            /* WHENALTRETURN */
     3152    25584    2        PREV$ = ADDR(CTXHD$);
     3153    25585    2        CTX$ = CTXHD$;
     3154    25586    3        DO WHILE(CTX$ ~= ADDR(NIL));
     3155    25587    3             IF DVCERRCTX.DEVNM = KL_NETWORK_BUF.DEVNM
     3156    25588    4             THEN DO;
     3157    25589    4                  RETURN;
     3158    25590    4                END;                       /* IF */
     3159    25591    4             ELSE DO;
     3160    25592    4                  PREV$ = CTX$;
     3161    25593    4                  CTX$ = DVCERRCTX.LNK$;
     3162    25594    4                END;                       /* ELSE */
     3163    25595    3           END;                            /* DO WHILE */
     3164    25596
     3165    25597    2        ALTRETURN;
     3166    25598
     3167    25599    2   END FIND_ERRCTX;
     3168    25600    1   END KLI$KBOOT;
     3169    25601        %EOD;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:243  
--  Include file information  --

   K_ADDRESS_M.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   KL_ERRORS_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   GH_SCHD_E.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:244  
      No diagnostics issued in procedure KLI$KBOOT.

   Procedure KLI$KBOOT requires 5047 words for executable code.
   Procedure KLI$KBOOT requires 288 words of local(AUTO) storage.

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:245  

 Object Unit name= KLI$KBOOT                                  File name= KLI$FESET.:E05TOU
 UTS= JUL 30 '97 00:52:28.96 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$HLP
    2   DCB   even  none     0      0  M$CSCG
    3   DCB   even  none     0      0  M$PROF
    4   DCB   even  none     0      0  M$ACCTLG
    5   DCB   even  none     0      0  M$NETCON
    6   DCB   even  none     0      0  M$NETWORK
    7   Data  even  none   471    727  KLI$KBOOT
    8   DCB   even  none     0      0  M$HLPF
    9   DCB   even  none     0      0  M$DO
   10  RoData even  UTS    150    226  KLI$KBOOT
   11   Proc  even  none  5047  11667  KLI$KBOOT
   12  RoData even  none   139    213  KLI$KBOOT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        0  KLI$KBOOT
    11   1540                  yes      Std        0  KLI$AMSG
    11  10046                  yes      Std        0  KLI$GETROUTES
    11  10134                  yes      Std        0  KLI$RECOVERY
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:246  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 KLX$WRHLPNODE
         yes           Std       0 KLI$UPDATE
 yes     yes           Std       4 KLX$WRHLPSTA
         yes           Std       3 KLI$LINEPRO
 yes     yes           Std       3 KLX$CONV_NODE
         yes           Std       2 JMU$SETSEG
 yes     yes           Std       2 KLB$GET
         yes           Std       0 KLC$CONFIG
         yes           Std       3 KLH$ERRMSG
         yes           Std       2 XUR$ERRCNVRT
         yes           Std       2 XUR$ERRTOLCP6
         yes           Std       4 JGG$TGJOB
         yes           Std       2 KLX$ERR2NETERR
         yes           Std       3 KLX$9TO8
 yes     yes           Std       9 KLH$SGSCAN
 yes     yes           Std       3 KLX$CONV_NODENAME
         yes           Std       3 KLX$8TO9
 yes     yes           Std       1 AZA$FEPACCTNG
         yes           Std       1 KLI$GETSNPA
 yes     yes           Std       1 KLB$REL
         yes           Std       2 KLI$GETFEPERA
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:247  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$HLP                                 KL_MXFE
     KL_FETBL                              KL_NWF                                KL_RDBF
     KL_RDBF$                              KL_FEPW                               KL_MARS
     KL_NODES                              KL_HOPCOST                            KL_NETWORK_VALID
     KL_NODENAME                           KL_NODE                               KL_NMNODE
     KL_RSPPND$                            KL_FEMSG                              KL_HLPKEY
     KL_PROKEY                             KL_NETWORK_KEY                        KL_NETWORK_TERMKEY
     KL_NETWORK_BUF                        KL_EXTRSP_BUF                         KL_EXTRSP_BUF$
     KL_HLPR$                              KL_STATION                            KL_FROG
     M$CSCG                                M$PROF                                M$ACCTLG
     M$NETCON                              M$NETWORK                             JC_MARS
     JC_CSMBF                              M$HLPF                                M$DO
     KL_PROBUF                             KL_BROADSZ                            B$TCB$
     B$JIT$                                KL_RDHLPR                             KL_RDPROR
     KL_RD_NETCON                          KL_WR_NETCON                          WRT_FROG
     KL_RD_NETWORK                         KL_WR_NETWORK                         KL_NETWORK_TIME
     KL_DR_NETWORK                         KL_PR_NETWORK                         WRT_NA2FROG
     KL_HDRMSG                             KL_PCD                                KL_HLPR
     ES_LOGSYSACC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:248  


      778        1        /*T***********************************************************/
      779        2        /*T*                                                         */
      780        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      781        4        /*T*                                                         */
      782        5        /*T***********************************************************/
      783        6        /**/
      784        7        /**/
      785        8        KLI$KBOOT: PROC;

      8 11 000000   000000 700200 xent  KLI$KBOOT    TSX0  ! X66_AUTO_0
        11 000001   000440 000000                    ZERO    288,0

      786        9
      787       10        %INCLUDE AZ_MACRO_C;
      788     2597        %INCLUDE B$JIT;
      789     2887        %INCLUDE CP_6;
      790     2968        %INCLUDE CP_6_SUBS;
      791     3508        %INCLUDE F$DCB;
      792     3557        %INCLUDE OC_MESSHD_C;
      793     3610        %INCLUDE EL$TABLES;
      794     3933        %INCLUDE EL_SUBS_C;
      795     4017        %INCLUDE GH_SCHD_E;
      796     4113        %INCLUDE G_JIT_M;
      797     4378        %INCLUDE IR_DATA_M;
      798     4542        %INCLUDE KC$CGBLK;
      799     4590        %INCLUDE KL_SUPER_C;
      800     7492        %INCLUDE KL_MACRO_C;
      801    10844        %INCLUDE KL_AFCN_C;
      802    10945        %INCLUDE KL_DATA_R;
      803    11409        %INCLUDE KI_ERRORS_C;
      804    11494        %INCLUDE OC_SUBS_C;
      805    12225        %INCLUDE KI_SUBS_C;
      806    12361        %INCLUDE KL_SUBS_C;
      807    12415        %INCLUDE KL_CONFIG_M;
      808    13177        %INCLUDE KL_CONTROL_C;
      809    13557        %INCLUDE K_ID_E;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:249  
      810    13607        %INCLUDE KHA_FNC_E;
      811    13707        %INCLUDE KL_ERRORS_C;
      812    13749        %INCLUDE PC_SUBS_C;
      813    14081        %INCLUDE B_SEGIDS_C;
      814    14620        %INCLUDE ES_TABLES_M;
      815    15014        %INCLUDE ES_SUBS_E;
      816    15040        %INCLUDE K_ADDRESS_M;
      817    15543        /**/
      818    15544        %B$TCB;
      819    15547        %B$ALT;
      820    15555    1   DCL KL_STATION CHAR(8) SYMREF;
      821    15556        %KL_FROG (STCLASS=SYMREF);
      822    15574        /**/
      823    15575        %K#LYRID_E;
      824    15582        %K#ENTID_E;
      825    15601        %GI_RCVR_EQU;
      826    15613        /**/
      827    15614    1   DCL M$CSCG DCB;
      828    15615    1   DCL M$PROF DCB;
      829    15616    1   DCL M$ACCTLG DCB;
      830    15617    1   DCL M$NETCON DCB;
      831    15618    1   DCL M$NETWORK DCB;
      832    15619    1   DCL RDBF$ PTR;
      833    15620    1   DCL JC_MARS UBIN SYMREF;
      834    15621
      835    15622        /* The following is the definitions for the keyins  */
      836    15623    1   DCL JC_CSMBF CHAR(300) SYMREF;
      837    15624    1   DCL 1 KMSG REDEF JC_CSMBF,
      838    15625    1            2 KIN# UBIN(18) UNAL,
      839    15626    1            2 CADDR BIT(18) UNAL,
      840    15627    1            2 FEX UBIN WORD,
      841    15628    1            2 NAME CHAR(8) UNAL,
      842    15629    1            2 FID UNAL,
      843    15630    1                 3 CNT UBIN BYTE UNAL,
      844    15631    1                 3 TXT CHAR(60) UNAL,
      845    15632    1            2 * CHAR(223) UNAL;
      846    15633    1   DCL 1 KMPW REDEF JC_CSMBF,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:250  
      847    15634    1            2 KIN# UBIN(18) UNAL,
      848    15635    1            2 CADDR BIT(18) UNAL,
      849    15636    1            2 FEX UBIN WORD,
      850    15637    1            2 FEPW,
      851    15638    1                 3 CNT UBIN BYTE UNAL,
      852    15639    1                 3 TXT CHAR(7) UNAL,
      853    15640    1            2 FEPWT REDEF FEPW CHAR(8),
      854    15641    1            2 * CHAR(284) UNAL;
      855    15642    1   DCL 1 KBCHS REDEF JC_CSMBF,
      856    15643    1            2 KIN# UBIN(18) UNAL,
      857    15644    1            2 CADDR BIT(18) UNAL,
      858    15645    1            2 FEP# UBIN WORD UNAL,
      859    15646    1            2 FEPNAME CHAR(8) UNAL,
      860    15647    1            2 CNT UBIN(9) UNAL,
      861    15648    1            2 MSG CHAR(283);
      862    15649    1   DCL 1 DVCKYN REDEF JC_CSMBF,
      863    15650    1            2 KIN# UBIN HALF UNAL,
      864    15651    1            2 CADDR BIT(18) UNAL,
      865    15652    1            2 DEVNM CHAR(4) UNAL,
      866    15653    1            2 TWSN CHAR(4) UNAL,
      867    15654    1            2 * CHAR(288) UNAL;
      868    15655    1   DCL 1 DVCKYN_FRWD REDEF JC_CSMBF,
      869    15656    1            2 RTN# UBIN BYTE UNAL,
      870    15657    1            2 * CHAR(299) UNAL;
      871    15658    1   DCL 1 ENABLE_KEYIN REDEF JC_CSMBF,
      872    15659    1            2 KEYIN# UBIN HALF HALIGNED,
      873    15660    1            2 CADDR UBIN HALF HALIGNED,
      874    15661    1            2 FEP# UBIN ALIGNED,
      875    15662    1            2 NAME CHAR(8) UNAL,
      876    15663    1            2 LINE_LOW# UBIN HALF HALIGNED,
      877    15664    1            2 LINE_HI# UBIN HALF HALIGNED,
      878    15665    1            2 * CHAR(280) CALIGNED;
      879    15666    1   DCL 1 TWSN_KEY STATIC ALIGNED,
      880    15667    1            2 CNT UBIN BYTE UNAL INIT(8),
      881    15668    1            2 * CHAR(4) UNAL INIT('TWSN'),
      882    15669    1            2 TWSN CHAR(4) UNAL INIT('0000');
      883    15670    1   DCL M$HLPF DCB;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:251  
      884    15671    1   DCL M$DO DCB;
      885    15672        %KL_PHDR (NAME=KL_PROBUF,STCLASS="SYMREF ALIGNED");
      886    15713        %FPT_READ (FPTN=READ_HLPF,
      887    15714                   DCB=M$HLPF,
      888    15715                   KEY=TWSN_KEY,
      889    15716                   BUF=KL_HLPR,
      890    15717                   KEYS=YES);
      891    15756        %KL_TWSNREC (NAME=TWSN_REC,
      892    15757                     STCLASS="BASED(KL_HLPR$)");
      893    15782    1   DCL DEVNM CHAR(4);
      894    15783    1   DCL DEVNM_TWSN CHAR(8);
      895    15784    1   DCL 1 DVCERRCTX BASED(CTX$) ALIGNED,
      896    15785    1            2 LNK$ PTR,
      897    15786    1            2 MSG# UBIN HALF UNAL,
      898    15787    1            2 MSGID UBIN HALF UNAL,
      899    15788              %B$TERMINAL_ID (FPTN=TERMID,STCLASS=BASED,LVL=2,LAST=",");
      900    15817    1            2 FEX UBIN(9) UNAL,
      901    15818    1            2 DEVNM CHAR(8) UNAL,
      902    15819    1            2 KEYIN_REQ BIT(1) UNAL,
      903    15820    1            2 * BIT(8) UNAL;
      904    15821        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:252  
      905    15822        /* Local variables */
      906    15823    1   DCL LEN UBIN;
      907    15824    1   DCL I UBIN;
      908    15825    1   DCL J SBIN;
      909    15826    1   DCL K SBIN;
      910    15827    1   DCL OFFSET UBIN(18) HALIGNED;
      911    15828    1   DCL OUT$ PTR;
      912    15829    1   DCL IPARAM$ PTR;
      913    15830    1   DCL IN$ PTR;
      914    15831    1   DCL ARRAY_BYSZ UBIN;
      915    15832    1   DCL ARRAY_WDSZ UBIN;
      916    15833    1   DCL B$PARAMI(0:0) UBIN HALF BASED UNAL;
      917    15834    1   DCL B$BYTE UBIN BYTE BASED;
      918    15835    1   DCL B$HALF UBIN(18)  BASED;
      919    15836    1   DCL CTXHD$ PTR STATIC INIT(ADDR(NIL));
      920    15837    1   DCL CTX$ PTR;
      921    15838    1   DCL PREV$ PTR;
      922    15839    1   DCL FOUND BIT(1);
      923    15840    1   DCL MSGID UBIN WORD STATIC INIT(50);
      924    15841    1   DCL SIZE UBIN;
      925    15842    1   DCL FEX UBIN WORD;
      926    15843    1   DCL NODETYPE UBIN;
      927    15844    1   DCL PSIZ UBIN(18);
      928    15845    1   DCL CHR$PSIZ CHAR(PSIZ) BASED;
      929    15846    1   DCL FEPNAME CHAR(8);
      930    15847    1   DCL ERRC UBIN WORD;
      931    15848    1   DCL MESS$ PTR;
      932    15849    1   DCL PARM$ PTR;
      933    15850    1   DCL CNT UBIN BYTE UNAL BASED(PARM$);
      934    15851    1   DCL PARM CHAR(SIZE) UNAL BASED(PARM$);
      935    15852    1   DCL CNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
      936    15853    1   DCL CNFG$ PTR STATIC INIT(ADDR(CNFG_BUF));
      937    15854    1   DCL 1 VTXTC BASED,
      938    15855    1            2 CNT UBIN BYTE UNAL,
      939    15856    1            2 TXT CHAR(VTXTC.CNT) UNAL;
      940    15857    1   DCL ACCT CHAR(8);
      941    15858    1   DCL 1 UNAME ALIGNED,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:253  
      942    15859    1            2 C UBIN BYTE UNAL,
      943    15860    1            2 T CHAR(12) UNAL;
      944    15861    1   DCL PASS CHAR(8);
      945    15862    1   DCL 1 PRO ALIGNED,
      946    15863    1            2 C UBIN BYTE UNAL,
      947    15864    1            2 L CHAR(11) UNAL;
      948    15865    1   DCL ERR UBIN;
      949    15866    1   DCL HOSTNAME CHAR(8);
      950    15867    1   DCL NOSETUP BIT (1) ALIGNED;
      951    15868    1   DCL NOHEADER BIT (1) ALIGNED;
      952    15869        %KL$CONFIG_KEY (NAME=TCONFIG_KEY,STCLASS=AUTO);
      953    15916        %KL$DEFAULT_KEY (NAME=TDEFAULT_KEY,STCLASS=AUTO);
      954    15935        %KL$HNDLR_KEY (NAME=KL_HNDLR_KEY,
      955    15936                       STCLASS=STATIC);
      956    15955        %KL$HNDLR (NAME=KL_HNDLR,NUM=%KL_FIXED_HI,NUMI=4,LAST=NO,STCLASS=STATIC);
      957    16018    1        2 BLOCK(0:15) UBIN(18) UNAL,
      958    16019    1             2 UNBLOCK(0:15) UBIN(18) UNAL,
      959    16020    1             2 USRPARM1(0:7) UBIN(18) UNAL,
      960    16021    1             2 USRPARM2(0:7) UBIN(18) UNAL;
      961    16022        %KL$FEPCTL_KEY (NAME=KL_FEPCTL_KEY,
      962    16023                        STCLASS=STATIC);
      963    16041        %KL$FEPCTL (NAME=KL_FEPCTL,
      964    16042                    STCLASS=STATIC);
      965    16062        %KL$TERM (NAME=TERM_REC,
      966    16063                  STCLASS=STATIC);
      967    16112        %KL$TERM_KEY (NAME=TERM_KEY,
      968    16113                      STCLASS=STATIC);
      969    16159        %KL_HNDCMN_INFO (FPTN=KHA_C,
      970    16160                         STCLASS=CONSTANT);
      971    16240        %KL_NA_INFO (FPTN=NA_C,
      972    16241                     STCLASS=CONSTANT);
      973    16290        %KL$NETWORK_KEY(STCLASS=CONSTANT);
      974    16307        %KL$NETWORK (STCLASS="BASED(KL_EXTRSP_BUF$)");
      975    16334    1   DCL KL_BROADSZ UBIN WORD SYMREF;
      976    16335    1   DCL B$TCB$ PTR SYMREF;
      977    16336    1   DCL B$JIT$ PTR SYMREF;
      978    16337    1   DCL DATASIZE UBIN HALF;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:254  
      979    16338    1   DCL UBIN_HALF_BASE UBIN HALF CALIGNED BASED;
      980    16339    1   DCL LOGSYSACCT UBIN BASED;
      981    16340        /**/
      982    16341        %FPT_WRITE (FPTN=WRT_ACCTLG,DCB=M$ACCTLG);
      983    16372        %FPT_TIME (TSTAMP=TSTAMP, SOURCE=FUTS, DEST=UTS);
      984    16391    1   DCL TSTAMP UBIN STATIC;
      985    16392        %G$ACC_HDR (FPTN=G$ACC_UNPK,STCLASS="BASED(KL_RDBF$)",LAST=NO);
      986    16414        %G$ACC (HOST_TYPE=UNPACKED,LVL=2);
      987    16484        %AZ_LCP6_JSP (NAME=G@ACC_PKD,INCLUDE_GJIT=NO,STCLASS=AUTO);
      988    16962        %LOGOFF$PARAM (STCLASS=AUTO);
      989    17003        %G$ACC (FPTN=G$ACC,STCLASS=BASED,HOST_TYPE=PACKED);
      990    17073        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:255  
      991    17074        /* FPTs and such */
      992    17075        %FPT_PRECORD (FPTN=STARTNETWORK,KEYS=YES,KEY=CNFG_BUF,DCB=M$NETWORK);
      993    17096        %FPT_READ (FPTN=KL_RDHLPR,STCLASS=SYMREF);
      994    17135        %FPT_READ (FPTN=KL_RDPROR,STCLASS=SYMREF);
      995    17174        %FPT_WRSYSLOG (FPTN=FPT_WRSYSLOG,SIZE="SIZEW(KL_PCD.ADDD)",
      996    17175                 ENTRY=KL_PCD,TYPE=EL_CONN,FILENUM=ACCOUNTING);
      997    17190        %FPT_WRSYSLOG (FPTN=FPT_WRFEPERR,STCLASS=STATIC,
      998    17191                 TYPE=EL_FEPERR,FILENUM=ERRLOG);
      999    17206        %FPT_WAIT (FPTN=FPT_WAIT,STCLASS=CONSTANT,UNITS=1);
     1000    17220        %FPT_READ (FPTN=KL_RD_NETCON,STCLASS=SYMREF);
     1001    17259        %FPT_WRITE (FPTN=KL_WR_NETCON,STCLASS=SYMREF);
     1002    17290        %VLP_NAME (FPTN=NETCON,
     1003    17291                   NAME=':NETCON');
     1004    17318        %VLP_ACCT (FPTN=SYSACCT,
     1005    17319                   ACCT=':SYS');
     1006    17332       %VLP_ERRCODE (FPTN=NOFPRG,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$NFPRG,SEV
             17332            =4);
     1007    17377       %VLP_ERRCODE (FPTN=ILGL,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$ILGL,SEV=4)
             17377            ;
     1008    17422       %VLP_ERRCODE (FPTN=ELGL,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$ELGL,SEV=4)
             17422            ;
     1009    17467        %VLP_ERRCODE (FPTN=NODENA,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$NODENA,
             17467            SEV=4);
     1010    17512       %VLP_ERRCODE (FPTN=NOFE,STCLASS=CONSTANT,FCG=KL,MID=I,MON="'1'B",ERR#=%E$NOFE,SEV=4)
             17512            ;
     1011    17557        %FPT_WRITE (FPTN=WRT_FROG,STCLASS=SYMREF);
     1012    17588        %FPT_WRITE (FPTN=WRITE_MONKEY,
     1013    17589                    DCB=M$CSCG,
     1014    17590                    BUF=JC_CSMBF,
     1015    17591                    STATION=MONKEY);
     1016    17622        %VLP_STATION (FPTN=MONKEY,
     1017    17623                      STATION='MONKEY');
     1018    17650        %FPT_READ (FPTN=KL_RD_NETWORK,STCLASS=SYMREF);
     1019    17689        %FPT_WRITE (FPTN=KL_WR_NETWORK,STCLASS=SYMREF);
     1020    17720        %FPT_TIME (FPTN=KL_NETWORK_TIME,STCLASS=SYMREF);
     1021    17739        %FPT_DELREC (FPTN=KL_DR_NETWORK,STCLASS=SYMREF);
     1022    17758        %FPT_PRECORD (FPTN=KL_PR_NETWORK,STCLASS=SYMREF);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:256  
     1023    17779        %FPT_READ (FPTN=RD_NETCON,KEYR=YES,DCB=M$NETCON,BUF=CNFG_BUF);
     1024    17818        %FPT_PRECORD (DCB=M$NETCON,KEYS=YES,KEY=CONFIG_KEY);
     1025    17839        %FPT_WRITE (FPTN=WRT_NA2FROG,STCLASS=SYMREF);
     1026    17870        %FPT_FECTL (FPTN=HLTFEP,HALT=YES,STCLASS=STATIC);
     1027    17885        %FPT_FECTL (FPTN=GOFEP,STCLASS=STATIC,START=YES);
     1028    17900        %FPT_FECTL (FPTN=STOPFEP,STCLASS=STATIC,STOP=YES);
     1029    17915        %FPT_WRITE (FPTN=WKBER,DCB=M$CSCG);
     1030    17946        %FPT_WRITE (FPTN=WBHS,STCLASS=STATIC,DCB=M$HLP,STATION=FESTA);
     1031    17977        %VLP_STATION (FPTN=FESTA,STCLASS=STATIC);
     1032    18004        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:257  
     1033    18005        /* File structures */
     1034    18006        %KL_LINE_KEY (FPTN=KL$LINE_KEY,STCLASS="BASED(CNFG$)");
     1035    18056        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:258  
     1036    18057        /* Administrative message structures */
     1037    18058        %KL$ADMES (NAME=FEPW,CODE=IGA_SSPW,MSG='88888888',STCLASS=STATIC);
     1038    18064        %KL$ADMES (NAME=BOOTMSG,CODE=IGA_BOOTFEP,MSG=' ',STCLASS=STATIC);
     1039    18070       %VLP_ERRCODE(FPTN=E$DEFSTP,STCLASS=CONSTANT,FCG=KL,MID=H,MON='1'B,ERR#=%E$FEPSTOPPED
             18070            );
     1040    18115        %KL$CONFIG_KEY (NAME=CONFIG_KEY,STCLASS=STATIC);
     1041    18162        %KL$DEFAULT_KEY (NAME=DEFAULT_KEY,STCLASS=STATIC);
     1042    18181        %KL_HNDCMN_INFO (FPTN=HNDCMN,STCLASS=BASED);
     1043    18261        %KL$LINCNFG (NAME=LINCNFG,STCLASS="BASED(CNFG$)",LGNSIZ=100);
     1044    18419        %KL_CHNRSP (FPTN=KL_CHNRSPC,STCLASS=CONSTANT);
     1045    18639        %KL_ACCTNG (NAME=KL$ACCTNG,STCLASS=BASED);
     1046    18653        %KL_CHNRSP (FPTN=CHNRSP,STCLASS="BASED(KL_EXTRSP_BUF$)",MSGSIZE=PSIZ);
     1047    18873        %KL_CHNRSP (FPTN=KL$CHNRSP,STCLASS="BASED(KL_EXTRSP_BUF$)",MSGSIZE=2);
     1048    19093        %KL_ADMES (NAME=STPMSG,CODE=IGA_STOPFEP,STCLASS=STATIC,TYP=1);
     1049    19099        %KL_MES (FPTN=CRASHFEP_BF,CODE=IGA_CRASHFEP_BF,STCLASS=STATIC);
     1050    19122        %KL_ADMES (NAME=BCHS,STCLASS=STATIC,CODE=IGA_BCST,TYP=IGAT_SEND);
     1051    19128        %KL_ADMSR (NAME=KL_HDRMSG,STCLASS=SYMREF);
     1052    19134        %KL_STRTU (FPTN=KL$STRTU,STCLASS="BASED(RDBF$)");
     1053    19307        %KL_AFD (FPTN=KL$AFD,STCLASS="BASED(RDBF$)");
     1054    19347        %KL_CWNAK (FPTN=KL$CWNAK,STCLASS="BASED(RDBF$)");
     1055    19412        %KL_CWNAK (FPTN=CWNAK,STCLASS=AUTO);
     1056    19477        %KL_RQSCHN (FPTN=KL$RQSCHN,STCLASS="BASED(RDBF$)");
     1057    19580        %KL_ADMIN (FPTN=KL$ADMIN,STCLASS="BASED(RDBF$)");
     1058    19740        %KL_RUE (FPTN=KL$RUE,STCLASS="BASED(RDBF$)");
     1059    19843        %KL_REQSTATS (NAME=KL$REQSTATS,STCLASS="BASED(RDBF$)");
     1060    20136
     1061    20137        %KL_CONTROL_INIT (FPTN=KL$CONTROL_INIT,NUM_FIXED=%KL_FIXED_HI,NUM_INDXD=4,STCLASS=
             20137            "BASED(RDBF$)",LAST=NO);
     1062    20262    1        2 BLOCK(0:15) UBIN(18) UNAL,
     1063    20263    1             2 UNBLOCK(0:15) UBIN(18) UNAL,
     1064    20264    1             2 USRPARM1(0:7) UBIN(18) UNAL,
     1065    20265    1             2 USRPARM2(0:7) UBIN(18) UNAL;
     1066    20266
     1067    20267        %KL_CONTROL_INIT (FPTN=KL$$CONTROL_INIT,STCLASS=BASED,NUM_FIXED=%KL_FIXED_HI);
             20267            /*fixed portion only */
     1068    20392
     1069    20393        %KL_CONTROL (FPTN=KL$CONTROL,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:259  
     1070    20394                     STCLASS="BASED(RDBF$)");
     1071    20530        %KL_CNFG_MSG (FPTN=KL$CNFG_MSG,
     1072    20531                      STCLASS="BASED(RDBF$)");
     1073    20814        %KL_KEYMES (FPTN=KL$KEYMES,STCLASS="BASED(KL_RDBF$)",NPARMS=1);
     1074    20953        %KL_DVCERRRSP (FPTN=KL_DVCERRRSP,STCLASS=STATIC);
     1075    21006        %KL_ADMIN (FPTN=ADMIN,STCLASS=STATIC);
     1076    21166        %KL_RUE (FPTN=RUE,STCLASS=STATIC);
     1077    21269        %KL_PCD (FPTN=KL_PCD,CG=1,STCLASS=SYMREF);
     1078    21434        %KL_NODEINFO (FPTN=KL$NODEINFO,STCLASS="BASED(KL_RDBF$)");
     1079    21458        %KL_NODECHG (FPTN=KL$NODECHG,STCLASS="BASED(KL_RDBF$)");
     1080    21482        %KL_SYSLOG (FPTN=KL$SYSLOG,STCLASS="BASED(KL_RDBF$)",LAST=",");
     1081    21506        %KL_ERRLOG (FPTN=ERRLOG,STCLASS=BASED,LAST=",",LVL=2);
     1082    21613    1        3 DATA CHAR(SIZE) CALIGNED;
     1083    21614        %KL_UPDOSI(FPTN=KL$UPDOSI,STCLASS="BASED(KL_RDBF$)");
     1084    21823        %KL_OSILINKCHG(FPTN=KL$OSILINKCHG,STCLASS="BASED(KL_RDBF$)");
     1085    21946        %KL_ERRMSG_RQS (FPTN=KL$ERRMSG_RQS,FILE_PARAMS=YES,STCLASS="BASED(KL_RDBF$)");
     1086    22031        %KL_ERRMSG_RSP (FPTN=KL$ERRMSG_RSP,LONG=NO,STCLASS=BASED);
     1087    22107        %KL_ERRMSG_RSP (FPTN=KL@ERRMSG_RSP,STCLASS=AUTO,LONG=YES);
     1088    22183        %KL_LINE_KEY (FPTN=OSILINK_KEY,STCLASS=AUTO); /* key for snpa records in :network*/
     1089    22233        %KL_OSILINK_REC(FPTN=OSILINK_BUF,STCLASS=AUTO);
     1090    22281        %KL_OSILINKCHG(FPTN=OSILINKCHG,STCLASS=AUTO);
     1091    22404        %FPT_ERRMSG (FPTN=FPT@ERRMSG,STCLASS=AUTO);
     1092    22431        %VLR_ERRMSG (FPTN=VLR@ERRMSG,STCLASS=AUTO);
     1093    22453        %FPT_ERRMSG (STCLASS=CONSTANT,L6_CODE=YES);
     1094    22480        %KL_TIME (FPTN=KL$TIME,STCLASS="BASED(KL_RDBF$)");
     1095    22504        %KL_CONFIGRSP (FPTN=KL$CONFIGRSP,STCLASS="BASED(KL_RDBF$)");
     1096    22595        %KL_RSPPND (FPTN=KL$RSPPND,STCLASS="BASED(CTX$)");
     1097    22626        %KL_DUMPMSG (FPTN=KL$DUMPMSG,STCLASS="BASED(RDBF$)",DSIZE=DATASIZE);
     1098    22667        %KL_DUMPMSG (FPTN=KL$DUMPABORT,STCLASS=AUTO,DSIZE=1);
     1099    22708        %EL$FEPERR (NAME=FEPERR,STCLASS=AUTO);
     1100    22787        %KL_DREC (NAME=KL$DREC,STCLASS="BASED(PARM$)",LAST=",");
     1101    22900        %KL_FEBLK (NAME=FEBLK,STCLASS=BASED,LVL=2,LAST=",");
     1102    22949        %KL_GJOB (NAME="GJOB REDEF FEBLK",STCLASS=BASED,LVL=2,LAST=",");
     1103    22973    1                 3 * CHAR(188);
     1104    22974        %KL_NODECHG (FPTN=NODECHG,STCLASS=AUTO);
     1105    22998        %KL_FEPST(FPTN=KL$FEPST,STCLASS="BASED(KL_RDBF$)");
     1106    23033        %KL_DREC (NAME=KL_HLPR,STCLASS=SYMREF,LAST=",");
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:260  
     1107    23146        %KC$CGID (FPTN=CGID,STCLASS=SYMREF,LVL=2,LAST=",");
     1108    23172    1            2 INFO(0:31) UBIN WORD UNAL;
     1109    23173        %ES$SECLOG(NAME=ES$SECLOG,STCLASS=STATIC);
     1110    23450        %FPT_WRSYSLOG(FPTN=WR_SECLOG,
     1111    23451                  ENTRY=ES$SECLOG,
     1112    23452                  FILENUM=EL_SEC,
     1113    23453                  SIZE="SIZEW(ES$SECLOG)",
     1114    23454                  TYPE=EL_SYS_ACCESS);
     1115    23469    1   DCL ES_LOGSYSACC UBIN WORD SYMREF;      /* Symdefed in ES_CNTRL_D             */
     1116    23470    1   DCL ES$ PTR STATIC INIT(ADDR(ES_LOGSYSACC));
     1117    23471        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:261  
     1118    23472        /* Keyin templates */
     1119    23473        %OC_MESSHD_W (NAME=FEPACCTL,STCLASS="CONSTANT ALIGNED",NPARMS=1,ATR=M_SYS,
     1120    23474                      MSG=OWALG_MSG#);
     1121    23487    1        2 MCNT UBIN(9) UNAL INIT(LENGTHC(FEPACCTL.MESS#)),
     1122    23488    1             2 MESS# UBIN(9) UNAL INIT(5); /* cant write fep accounting records */
     1123    23489        %OC_MESSHD_W (NAME=CKBR,STCLASS="CONSTANT ALIGNED",NPARMS=5);
     1124    23502    1            2 FCNT UBIN(9) UNAL INIT(LENGTHC(KBERR.FEX)),
     1125    23503    1            2 ECNT UBIN(9) UNAL INIT(LENGTHC(KBERR.ERR)),
     1126    23504    1            2 PCNT UBIN(9) UNAL INIT(LENGTHC(KBERR.PORT)),
     1127    23505    1            2 P2CNT UBIN(9) UNAL INIT(LENGTHC(KBERR.PORT_HI)),
     1128    23506    1            2 NCNT UBIN(9) UNAL INIT(LENGTHC(KBERR.NAME)),
     1129    23507    1            2 FEX UBIN(9) UNAL INIT(0),
     1130    23508    1            2 ERR UBIN(9) UNAL INIT(0),
     1131    23509    1            2 PORT,
     1132    23510    1                 3 T UBIN(10) UNAL INIT(0),
     1133    23511    1                 3 B UBIN(8) UNAL INIT(0),
     1134    23512    1            2 PORT_HI,
     1135    23513    1                 3 T UBIN(10) UNAL INIT(0),
     1136    23514    1                 3 B UBIN(8) UNAL INIT(0),
     1137    23515    1            2 NAME CHAR(8) UNAL INIT(' ');
     1138    23516        %OC$MESSHD (NAME=FEPMES,STCLASS="",ALGN=ALIGNED);
     1139    23530    1            2 FCNT UBIN BYTE UNAL,
     1140    23531    1            2 FNCNT UBIN BYTE UNAL,
     1141    23532    1            2 MSG CHAR(80) UNAL;
     1142    23533        %OC$MESSHD (NAME=KBERR,STCLASS="");
     1143    23547    1            2 FCNT UBIN(9) UNAL,
     1144    23548    1            2 ECNT UBIN(9) UNAL,
     1145    23549    1            2 PCNT UBIN(9) UNAL,
     1146    23550    1            2 P2CNT UBIN(9) UNAL,
     1147    23551    1            2 NCNT UBIN(9) UNAL,
     1148    23552    1            2 FEX UBIN(9) UNAL,
     1149    23553    1            2 ERR UBIN(9) UNAL,
     1150    23554    1            2 PORT,
     1151    23555    1                 3 T UBIN(10) UNAL,
     1152    23556    1                 3 B UBIN(8) UNAL,
     1153    23557    1            2 PORT_HI,
     1154    23558    1                 3 T UBIN(10) UNAL,
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:262  
     1155    23559    1                 3 B UBIN(8) UNAL,
     1156    23560    1            2 NAME CHAR(8) UNAL;
     1157    23561    1   DCL 1 PSEUDO BASED,
     1158    23562    1            2 NAME CHAR(8) UNAL,
     1159    23563    1            2 MAX(0:3) UBIN HALF UNAL;
     1160    23564        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:263  
     1161    23565        /* Based local structures */
     1162    23566    1   DCL 1 CADDR BASED UNAL,
     1163    23567    1            2 TOP BIT(8) UNAL,
     1164    23568    1            2 MID BIT(8) UNAL,
     1165    23569    1            2 BOT BIT(8) UNAL;
     1166    23570    1   DCL B$TERMNAME CHAR(8) BASED;
     1167    23571    1   DCL 1 TEXT$C BASED,
     1168    23572    1            2 L UBIN BYTE UNAL,
     1169    23573    1            2 C CHAR(TEXT$C.L);
     1170    23574        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:264  
     1171    23575        /* Entry references */
     1172    23576    1   DCL AZA$FEPACCTNG ENTRY(1) ALTRET;
     1173    23577    1   DCL JGG$TGJOB ENTRY(4);
     1174    23578    1   DCL KLC$CONFIG ENTRY;
     1175    23579    1   DCL KLI$LINEPRO ENTRY(3);
     1176    23580    1   DCL KLI$UPDATE ENTRY;
     1177    23581    1   DCL KLH$SGSCAN ENTRY(9) ALTRET;
     1178    23582    1   DCL KLX$CONV_NODENAME ENTRY(3) ALTRET;
     1179    23583    1   DCL KLX$CONV_NODE ENTRY(3) ALTRET;
     1180    23584    1   DCL KLX$WRHLPNODE ENTRY(4) ALTRET;
     1181    23585    1   DCL KLX$WRHLPSTA  ENTRY(4) ALTRET;
     1182    23586    1   DCL KLX$8TO9 ENTRY(3);
     1183    23587    1   DCL KLX$9TO8 ENTRY(3);
     1184    23588    1   DCL KLX$ERR2NETERR ENTRY(2);
     1185    23589    1   DCL KLB$GET ENTRY(2) ALTRET;
     1186    23590    1   DCL KLB$REL ENTRY(1) ALTRET;
     1187    23591    1   DCL XUR$ERRCNVRT ENTRY(2);
     1188    23592    1   DCL XUR$ERRTOLCP6 ENTRY(2);
     1189    23593    1   DCL JMU$SETSEG ENTRY(2);
     1190    23594    1   DCL KLH$ERRMSG ENTRY(3);
     1191    23595    1   DCL KLI$GETSNPA ENTRY(1);
     1192    23596    1   DCL KLI$GETFEPERA ENTRY(2);
     1193    23597        /**/
     1194    23598        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:265  
     1195    23599        /**/
     1196    23600    1        RDBF$=ADDR(KL_RDBF);

  23600 11 000002   000000 236000 12                 LDQ     0
        11 000003   200003 756100                    STQ     RDBF$,,AUTO

     1197    23601    1        KBERR=CKBR;

  23601 11 000004   000100 100400                    MLR     fill='000'O
        11 000005   000202 000047 10                 ADSC9   CKBR                     cn=0,n=39
        11 000006   200402 000047                    ADSC9   KBERR,,AUTO              cn=0,n=39

     1198    23602    2        DO CASE (KMSG.KIN#);

  23602 11 000007   000000 235000 xsym               LDA     JC_CSMBF
        11 000010   000022 771000                    ARL     18
        11 000011   000005 135007                    SBLA    5,DL
        11 000012   000037 115007                    CMPA    31,DL
        11 000013   000015 602005 11                 TNC     s:23602+6,AL
        11 000014   001537 710000 11                 TRA     BHSON1
        11 000015   000264 710000 11                 TRA     s:23668
        11 000016   000302 710000 11                 TRA     s:23673
        11 000017   000376 710000 11                 TRA     s:23707
        11 000020   000340 710000 11                 TRA     s:23690
        11 000021   000166 710000 11                 TRA     s:23647
        11 000022   000523 710000 11                 TRA     s:23753
        11 000023   000520 710000 11                 TRA     s:23748
        11 000024   000534 710000 11                 TRA     s:23761
        11 000025   001537 710000 11                 TRA     BHSON1
        11 000026   000600 710000 11                 TRA     s:23775
        11 000027   001537 710000 11                 TRA     BHSON1
        11 000030   001537 710000 11                 TRA     BHSON1
        11 000031   000465 710000 11                 TRA     s:23732
        11 000032   001033 710000 11                 TRA     s:23866
        11 000033   001033 710000 11                 TRA     s:23866
        11 000034   001033 710000 11                 TRA     s:23866
        11 000035   001033 710000 11                 TRA     s:23866
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:266  
        11 000036   000643 710000 11                 TRA     FRWD
        11 000037   000656 710000 11                 TRA     s:23791
        11 000040   000322 710000 11                 TRA     s:23683
        11 000041   001421 710000 11                 TRA     s:23957
        11 000042   001424 710000 11                 TRA     s:23961
        11 000043   001255 710000 11                 TRA     s:23921
        11 000044   000054 710000 11                 TRA     s:23605
        11 000045   000161 710000 11                 TRA     s:23639
        11 000046   000163 710000 11                 TRA     s:23643
        11 000047   001522 710000 11                 TRA     s:23998
        11 000050   001432 710000 11                 TRA     s:23971
        11 000051   001427 710000 11                 TRA     s:23966
        11 000052   000224 710000 11                 TRA     s:23656
        11 000053   000261 710000 11                 TRA     s:23664

     1199    23603
     1200    23604    2        CASE (KEY_FEPS#);

     1201    23605    2           I = %KL_NODETYPE_FEP;

  23605 11 000054   000002 235007                    LDA     2,DL
        11 000055   200010 755100                    STA     I,,AUTO

  23605 11 000056                       DO_DISP_NOD* null
     1202    23606    2   DO_DISP_NODES: ;
     1203    23607    2           CALL KCHK ALTRET(KBD);

  23607 11 000056   011312 701000 11                 TSX1    KCHK
        11 000057   011051 702000 11                 TSX2    KBD

     1204    23608    2           KL_FEMSG.MSG# = FEUP_MSG#;

  23608 11 000060   000010 220003                    LDX0    8,DU
        11 000061   000000 440000 xsym               SXL0    KL_FEMSG

     1205    23609    2           KL_FEMSG.CADDR = KMSG.CADDR;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:267  
  23609 11 000062   000000 721000 xsym               LXL1    JC_CSMBF
        11 000063   000000 741000 xsym               STX1    KL_FEMSG

     1206    23610    2           WKBER.BUF_ = VECTOR(KL_FEMSG);

  23610 11 000064   000002 237000 12                 LDAQ    2
        11 000065   000426 757000 7                  STAQ    WKBER+4

     1207    23611    3           DO FEX = FEX TO KL_MXFE;

  23611 11 000066   000153 710000 11                 TRA     s:23635+3

     1208    23612    3                CALL KLX$CONV_NODE(KL_FEMSG.NAME,FEX,NODETYPE)

  23612 11 000067   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 000070   200430 450500                    STP0    T$+3,,AUTO
        11 000071   200025 631500                    EPPR1   FEX,,AUTO
        11 000072   200427 451500                    STP1    T$+2,,AUTO
        11 000073   000004 236000 12                 LDQ     4
        11 000074   200426 756100                    STQ     T$+1,,AUTO
        11 000075   200426 630500                    EPPR0   T$+1,,AUTO
        11 000076   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000077   000000 701000 xent               TSX1    KLX$CONV_NODE
        11 000100   000146 702000 11                 TSX2    s:23632

     1209    23613    4                WHENRETURN DO;

     1210    23614    4                     IF KL_FETBL.HOST_NODE(FEX)

  23614 11 000101   200025 720100                    LXL0    FEX,,AUTO
        11 000102   000000 234010 xsym               SZN     KL_FETBL,X0
        11 000103   000107 605000 11                 TPL     s:23618

     1211    23615    4                     THEN
     1212    23616    4                          KL_FEMSG.STATE = 1;

  23616 11 000104   001000 236007                    LDQ     512,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:268  
        11 000105   000006 552010 xsym               STBQ    KL_FEMSG+6,'10'O
        11 000106   000111 710000 11                 TRA     s:23619

     1213    23617    4                     ELSE
     1214    23618    4                          KL_FEMSG.STATE = 0;

  23618 11 000107   000000 236003                    LDQ     0,DU
        11 000110   000006 552010 xsym               STBQ    KL_FEMSG+6,'10'O

     1215    23619    4                     IF KL_FETBL.ACTIVE(FEX)

  23619 11 000111   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000112   100000 316003                    CANQ    32768,DU
        11 000113   000117 600000 11                 TZE     s:23623

     1216    23620    4                     THEN
     1217    23621    4                          KL_FEMSG.PROB = 1;

  23621 11 000114   000001 236003                    LDQ     1,DU
        11 000115   000006 552020 xsym               STBQ    KL_FEMSG+6,'20'O
        11 000116   000121 710000 11                 TRA     s:23624

     1218    23622    4                     ELSE
     1219    23623    4                          KL_FEMSG.PROB = 2;

  23623 11 000117   000002 236003                    LDQ     2,DU
        11 000120   000006 552020 xsym               STBQ    KL_FEMSG+6,'20'O

     1220    23624    4                     KL_FEMSG.FEX = FEX;

  23624 11 000121   200025 236100                    LDQ     FEX,,AUTO
        11 000122   000033 736000                    QLS     27
        11 000123   000006 552040 xsym               STBQ    KL_FEMSG+6,'40'O

     1221    23625    4                     IF I = 0 OR NODETYPE = I OR (I = %KL_NODETYPE_HOST AND NODETYPE =
             23625                              %KL_NODETYPE_ME)

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:269  
  23625 11 000124   200010 235100                    LDA     I,,AUTO
        11 000125   000141 600000 11                 TZE     s:23628
        11 000126   200026 236100                    LDQ     NODETYPE,,AUTO
        11 000127   200010 116100                    CMPQ    I,,AUTO
        11 000130   000141 600000 11                 TZE     s:23628
        11 000131   000001 115007                    CMPA    1,DL
        11 000132   000146 601000 11                 TNZ     s:23632
        11 000133   000003 116007                    CMPQ    3,DL
        11 000134   000146 601000 11                 TNZ     s:23632
        11 000135   040000 106400                    CMPC    fill='040'O
        11 000136   000006 600010 xsym               ADSC9   KL_FEMSG+6               cn=3,n=8
        11 000137   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 000140   000146 600000 11                 TZE     s:23632

     1222    23626    4                          AND KL_FEMSG.NAME ~= ' '
     1223    23627    4                     THEN
     1224    23628    4                          CALL M$WRITE(WKBER)

  23628 11 000141   000422 630400 7                  EPPR0   WKBER
        11 000142   440001 713400                    CLIMB   alt,write
        11 000143   401400 401760                    pmme    nvectors=4
        11 000144   000146 702000 11                 TSX2    s:23632
        11 000145   000146 710000 11                 TRA     s:23632

     1225    23629    5                          WHENALTRETURN DO;

     1226    23630    5                             END;

     1227    23631    4                   END;

     1228    23632    3                IF KMSG.FEX ~= 0

  23632 11 000146   000001 235000 xsym               LDA     JC_CSMBF+1
        11 000147   000156 601000 11                 TNZ     s:23636

     1229    23633    3                THEN
     1230    23634    3                     EXIT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:270  
     1231    23635    3              END;

  23635 11 000150   200025 236100                    LDQ     FEX,,AUTO
        11 000151   000001 036007                    ADLQ    1,DL
        11 000152   200025 756100                    STQ     FEX,,AUTO
        11 000153   000000 236000 xsym               LDQ     KL_MXFE
        11 000154   200025 116100                    CMPQ    FEX,,AUTO
        11 000155   000067 603000 11                 TRC     s:23612

     1232    23636    2           KL_FEMSG.CADDR = M_COMM;

  23636 11 000156   004000 220003                    LDX0    2048,DU
        11 000157   000000 740000 xsym               STX0    KL_FEMSG
        11 000160   001537 710000 11                 TRA     BHSON1

     1233    23637
     1234    23638    2        CASE(KEY_NODES#);

     1235    23639    2           I = 0;

  23639 11 000161   200010 450100                    STZ     I,,AUTO

     1236    23640    2           GOTO DO_DISP_NODES;

  23640 11 000162   000056 710000 11                 TRA     DO_DISP_NODES

     1237    23641
     1238    23642    2        CASE(KEY_HOSTS#);

     1239    23643    2           I = %KL_NODETYPE_HOST;

  23643 11 000163   000001 235007                    LDA     1,DL
        11 000164   200010 755100                    STA     I,,AUTO

     1240    23644    2           GOTO DO_DISP_NODES;

  23644 11 000165   000056 710000 11                 TRA     DO_DISP_NODES
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:271  

     1241    23645
     1242    23646    2        CASE (KEY_FEPW#);

     1243    23647    2           IF KMPW.FEPW.CNT>7 THEN KMPW.FEPW.CNT=7;

  23647 11 000166   000002 236000 xsym               LDQ     JC_CSMBF+2
        11 000167   777000 376003                    ANQ     -512,DU
        11 000170   010000 116003                    CMPQ    4096,DU
        11 000171   000174 602000 11                 TNC     s:23648

  23647 11 000172   007000 236003                    LDQ     3584,DU
        11 000173   000002 552040 xsym               STBQ    JC_CSMBF+2,'40'O

     1244    23648    2           KL_FEPW=KMPW.FEPWT;

  23648 11 000174   040000 100400                    MLR     fill='040'O
        11 000175   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
        11 000176   000000 000010 xsym               ADSC9   KL_FEPW                  cn=0,n=8

     1245    23649    2           FEPW.MSG_=KL_FEPW;

  23649 11 000177   040000 100400                    MLR     fill='040'O
        11 000200   000000 000010 xsym               ADSC9   KL_FEPW                  cn=0,n=8
        11 000201   000462 400010 7                  ADSC9   FEPW                     cn=2,n=8

     1246    23650    3           DO FEX=1 TO KL_MXFE;

  23650 11 000202   000001 236007                    LDQ     1,DL
        11 000203   200025 756100                    STQ     FEX,,AUTO
        11 000204   000220 710000 11                 TRA     PWON+3

     1247    23651    3                CALL KLX$WRHLPNODE(FEPW,SIZEC(FEPW),FEX);

  23651 11 000205   200025 630500                    EPPR0   FEX,,AUTO
        11 000206   200430 450500                    STP0    T$+3,,AUTO
        11 000207   000006 237000 12                 LDAQ    6
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:272  
        11 000210   200426 757100                    STAQ    T$+1,,AUTO
        11 000211   200426 630500                    EPPR0   T$+1,,AUTO
        11 000212   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000213   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 000214   000000 011000                    NOP     0

  23651 11 000215                       PWON         null
     1248    23652    3   PWON:        ;
     1249    23653    3              END;

  23653 11 000215   200025 235100                    LDA     FEX,,AUTO
        11 000216   000001 035007                    ADLA    1,DL
        11 000217   200025 755100                    STA     FEX,,AUTO
        11 000220   000000 236000 xsym               LDQ     KL_MXFE
        11 000221   200025 116100                    CMPQ    FEX,,AUTO
        11 000222   000205 603000 11                 TRC     s:23651
        11 000223   001537 710000 11                 TRA     BHSON1

     1250    23654
     1251    23655    2        CASE (KEY_XFEP#);

     1252    23656    2           RUE.EVENT# = %GH_EVABRT;

  23656 11 000224   045000 236003                    LDQ     18944,DU
        11 000225   000634 552040 7                  STBQ    RUE+9,'40'O

  23656 11 000226                       DOKEYX       null
     1253    23657    2   DOKEYX: ;
     1254    23658    2           CALL KCHK ALTRET(KBD);

  23658 11 000226   011312 701000 11                 TSX1    KCHK
        11 000227   011051 702000 11                 TSX2    KBD

     1255    23659    2           RUE.ORIGIN = 'KEYIN';

  23659 11 000230   040000 100400                    MLR     fill='040'O
        11 000231   000214 000005 10                 ADSC9   CKBR+10                  cn=0,n=5
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:273  
        11 000232   000626 000010 7                  ADSC9   RUE+3                    cn=0,n=8

     1256    23660    2           RUE.SYSID# = ENABLE_KEYIN.LINE_LOW#/256 * 512 + MOD(ENABLE_KEYIN.LINE_LOW#,
             23660                    256);

  23660 11 000233   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 000234   000022 772000                    QRL     18
        11 000235   000010 772000                    QRL     8
        11 000236   200426 756100                    STQ     T$+1,,AUTO
        11 000237   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 000240   000022 772000                    QRL     18
        11 000241   000377 376007                    ANQ     255,DL
        11 000242   200427 756100                    STQ     T$+2,,AUTO
        11 000243   200426 236100                    LDQ     T$+1,,AUTO
        11 000244   000011 736000                    QLS     9
        11 000245   200427 036100                    ADLQ    T$+2,,AUTO
        11 000246   000000 620006                    EAX0    0,QL
        11 000247   000633 440000 7                  SXL0    RUE+8

     1257    23661    2           CALL KLX$WRHLPNODE (RUE,SIZEC(RUE),FEX) ALTRET(FEPK_ERR);

  23661 11 000250   200025 630500                    EPPR0   FEX,,AUTO
        11 000251   200430 450500                    STP0    T$+3,,AUTO
        11 000252   000012 237000 12                 LDAQ    10
        11 000253   200426 757100                    STAQ    T$+1,,AUTO
        11 000254   200426 630500                    EPPR0   T$+1,,AUTO
        11 000255   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000256   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 000257   001371 702000 11                 TSX2    FEPK_ERR
        11 000260   001537 710000 11                 TRA     BHSON1

     1258    23662
     1259    23663    2        CASE(KEY_EFEP#);

     1260    23664    2           RUE.EVENT# = %GH_EVERR;

  23664 11 000261   043000 236003                    LDQ     17920,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:274  
        11 000262   000634 552040 7                  STBQ    RUE+9,'40'O

     1261    23665    2           GOTO DOKEYX;

  23665 11 000263   000226 710000 11                 TRA     DOKEYX

     1262    23666
     1263    23667    2        CASE (KEY_BOOTFEP#);

     1264    23668    2           CALL KCHK ALTRET (KBD);

  23668 11 000264   011312 701000 11                 TSX1    KCHK
        11 000265   011051 702000 11                 TSX2    KBD

     1265    23669    2           ERRC=KL_FETBL.KTYP(FEX);

  23669 11 000266   200025 720100                    LXL0    FEX,,AUTO
        11 000267   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000270   000033 772000                    QRL     27
        11 000271   000007 376007                    ANQ     7,DL
        11 000272   200032 756100                    STQ     ERRC,,AUTO

     1266    23670    2           KL_FETBL.KTYP(FEX)=%KLKT_BOOT#;

  23670 11 000273   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000274   000011 376000 12                 ANQ     9
        11 000275   001000 276003                    ORQ     512,DU
        11 000276   000000 756010 xsym               STQ     KL_FETBL,X0

     1267    23671    2           CALL BDSET ALTRET (ERRORK);

  23671 11 000277   011153 701000 11                 TSX1    BDSET
        11 000300   011063 702000 11                 TSX2    ERRORK
        11 000301   001537 710000 11                 TRA     BHSON1

     1268    23672    2        CASE (KEY_DUMPFEP#);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:275  
     1269    23673    2           CALL KCHK ALTRET (KBD);

  23673 11 000302   011312 701000 11                 TSX1    KCHK
        11 000303   011051 702000 11                 TSX2    KBD

     1270    23674    2           CALL LOCAL_CHECK

  23674 11 000304   011411 701000 11                 TSX1    LOCAL_CHECK
        11 000305   000321 702000 11                 TSX2    s:23679

     1271    23675    3           WHENRETURN DO;

     1272    23676    3                ERRC=KL_FETBL.KTYP(FEX);

  23676 11 000306   200025 720100                    LXL0    FEX,,AUTO
        11 000307   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000310   000033 772000                    QRL     27
        11 000311   000007 376007                    ANQ     7,DL
        11 000312   200032 756100                    STQ     ERRC,,AUTO

     1273    23677    3                KL_FETBL.KTYP(FEX)=%KLKT_DUMP#;

  23677 11 000313   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000314   000011 376000 12                 ANQ     9
        11 000315   002000 276003                    ORQ     1024,DU
        11 000316   000000 756010 xsym               STQ     KL_FETBL,X0

     1274    23678    3                CALL BDSET ALTRET (ERRORK);

  23678 11 000317   011153 701000 11                 TSX1    BDSET
        11 000320   011063 702000 11                 TSX2    ERRORK

     1275    23679    3              END;

  23679 11 000321   001537 710000 11                 TRA     BHSON1

     1276    23680
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:276  
     1277    23681
     1278    23682    2        CASE (KEY_CRASHFEP#);

     1279    23683    2           CALL KCHK ALTRET (KBD);

  23683 11 000322   011312 701000 11                 TSX1    KCHK
        11 000323   011051 702000 11                 TSX2    KBD

     1280    23684    2           ERRC=KL_FETBL.KTYP(FEX);

  23684 11 000324   200025 720100                    LXL0    FEX,,AUTO
        11 000325   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000326   000033 772000                    QRL     27
        11 000327   000007 376007                    ANQ     7,DL
        11 000330   200032 756100                    STQ     ERRC,,AUTO

     1281    23685    2           KL_FETBL.KTYP(FEX)=%KLKT_CRASH#;

  23685 11 000331   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000332   000011 376000 12                 ANQ     9
        11 000333   004000 276003                    ORQ     2048,DU
        11 000334   000000 756010 xsym               STQ     KL_FETBL,X0

     1282    23686    2           CALL BDSET ALTRET (ERRORK);

  23686 11 000335   011153 701000 11                 TSX1    BDSET
        11 000336   011063 702000 11                 TSX2    ERRORK
        11 000337   001537 710000 11                 TRA     BHSON1

     1283    23687
     1284    23688
     1285    23689    2        CASE (KEY_STARTFEP#);

     1286    23690    2           CALL KCHK ALTRET(KBD);

  23690 11 000340   011312 701000 11                 TSX1    KCHK
        11 000341   011051 702000 11                 TSX2    KBD
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:277  

     1287    23691    2           IF FEX>KL_MXFE THEN GOTO BDFEX;

  23691 11 000342   000000 236000 xsym               LDQ     KL_MXFE
        11 000343   200025 116100                    CMPQ    FEX,,AUTO
        11 000344   011101 602000 11                 TNC     BDFEX

     1288    23692    2           IF FEX~=0

  23692 11 000345   200025 235100                    LDA     FEX,,AUTO
        11 000346   000354 600000 11                 TZE     s:23699

     1289    23693    2           THEN
     1290    23694    2                CALL LOCAL_CHECK

  23694 11 000347   011411 701000 11                 TSX1    LOCAL_CHECK
        11 000350   000353 702000 11                 TSX2    s:23697

     1291    23695    3                WHENRETURN DO;

     1292    23696    3                     CALL STFEP ALTRET(ERROR);

  23696 11 000351   011221 701000 11                 TSX1    STFEP
        11 000352   011071 702000 11                 TSX2    ERROR

     1293    23697    3                   END;

  23697 11 000353   001537 710000 11                 TRA     BHSON1

     1294    23698    2           ELSE
     1295    23699    3           DO FEX=1 TO KL_MXFE;

  23699 11 000354   000001 235007                    LDA     1,DL
        11 000355   200025 755100                    STA     FEX,,AUTO
        11 000356   000372 710000 11                 TRA     s:23703+3

     1296    23700    3                IF KL_FETBL.LINK_CONNECT(FEX) AND NOT KL_FETBL.HOST_NODE(FEX)
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:278  

  23700 11 000357   200025 720100                    LXL0    FEX,,AUTO
        11 000360   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000361   200000 316003                    CANQ    65536,DU
        11 000362   000367 600000 11                 TZE     s:23703
        11 000363   000000 234010 xsym               SZN     KL_FETBL,X0
        11 000364   000367 604000 11                 TMI     s:23703

     1297    23701    3                THEN
     1298    23702    3                     CALL STFEP;

  23702 11 000365   011221 701000 11                 TSX1    STFEP
        11 000366   000000 011000                    NOP     0

     1299    23703    3              END;

  23703 11 000367   200025 235100                    LDA     FEX,,AUTO
        11 000370   000001 035007                    ADLA    1,DL
        11 000371   200025 755100                    STA     FEX,,AUTO
        11 000372   000000 236000 xsym               LDQ     KL_MXFE
        11 000373   200025 116100                    CMPQ    FEX,,AUTO
        11 000374   000357 603000 11                 TRC     s:23700
        11 000375   001537 710000 11                 TRA     BHSON1

     1300    23704
     1301    23705
     1302    23706    2        CASE (KEY_STOPFEP#);

     1303    23707    2           CALL KCHK ALTRET (KBD);

  23707 11 000376   011312 701000 11                 TSX1    KCHK
        11 000377   011051 702000 11                 TSX2    KBD

     1304    23708    2           IF KMSG.FID.CNT = 0

  23708 11 000400   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 000401   777000 316003                    CANQ    -512,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:279  
        11 000402   000422 601000 11                 TNZ     s:23714

     1305    23709    3           THEN DO;

     1306    23710    3                LEN = SIZEC(KMSG.FID.TXT);

  23710 11 000403   000074 235007                    LDA     60,DL
        11 000404   200007 755100                    STA     LEN,,AUTO

     1307    23711    3                CALL KLH$ERRMSG(STPMSG.MSG_,LEN,E$DEFSTP);

  23711 11 000405   000014 236000 12                 LDQ     12
        11 000406   200430 756100                    STQ     T$+3,,AUTO
        11 000407   200007 630500                    EPPR0   LEN,,AUTO
        11 000410   200427 450500                    STP0    T$+2,,AUTO
        11 000411   000015 236000 12                 LDQ     13
        11 000412   200426 756100                    STQ     T$+1,,AUTO
        11 000413   200426 630500                    EPPR0   T$+1,,AUTO
        11 000414   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000415   000000 701000 xent               TSX1    KLH$ERRMSG
        11 000416   000000 011000                    NOP     0

     1308    23712    3               KMSG.FID.CNT = LEN; /* actual size of errmsg and so well send message*/

  23712 11 000417   200007 236100                    LDQ     LEN,,AUTO
        11 000420   000033 736000                    QLS     27
        11 000421   000004 552040 xsym               STBQ    JC_CSMBF+4,'40'O

     1309    23713    3              END;

     1310    23714    2           IF FEX ~= 0

  23714 11 000422   200025 235100                    LDA     FEX,,AUTO
        11 000423   000441 600000 11                 TZE     s:23723

     1311    23715    2           THEN
     1312    23716    2                CALL LOCAL_CHECK
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:280  

  23716 11 000424   011411 701000 11                 TSX1    LOCAL_CHECK
        11 000425   000440 702000 11                 TSX2    s:23721

     1313    23717    3                WHENRETURN DO;

     1314    23718    3                     IF KL_FETBL.QOS ( FEX ) = 255 THEN

  23718 11 000426   200025 720100                    LXL0    FEX,,AUTO
        11 000427   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000430   000777 376003                    ANQ     511,DU
        11 000431   000377 116003                    CMPQ    255,DU
        11 000432   000436 601000 11                 TNZ     s:23720

     1315    23719    3                          CALL STFEPNM ALTRET ( STPERR ) ;

  23719 11 000433   011267 701000 11                 TSX1    STFEPNM
        11 000434   011125 702000 11                 TSX2    STPERR
        11 000435   000440 710000 11                 TRA     s:23721

     1316    23720    3                     ELSE CALL STPFEP ALTRET (STPERR);

  23720 11 000436   011235 701000 11                 TSX1    STPFEP
        11 000437   011125 702000 11                 TSX2    STPERR

     1317    23721    3                   END;

  23721 11 000440   001537 710000 11                 TRA     BHSON1

     1318    23722    2           ELSE
     1319    23723    3           DO FEX=1 TO KL_MXFE;

  23723 11 000441   000001 236007                    LDQ     1,DL
        11 000442   200025 756100                    STQ     FEX,,AUTO
        11 000443   000461 710000 11                 TRA     s:23728+3

     1320    23724    3                IF KL_FETBL.LINK_CONNECT(FEX) AND NOT KL_FETBL.HOST_NODE(FEX)
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:281  

  23724 11 000444   200025 720100                    LXL0    FEX,,AUTO
        11 000445   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000446   200000 316003                    CANQ    65536,DU
        11 000447   000456 600000 11                 TZE     s:23728
        11 000450   000000 234010 xsym               SZN     KL_FETBL,X0
        11 000451   000456 604000 11                 TMI     s:23728
        11 000452   040000 316003                    CANQ    16384,DU
        11 000453   000456 600000 11                 TZE     s:23728

     1321    23725    3                     AND KL_FETBL.BOSS(FEX)
     1322    23726    3                THEN
     1323    23727    3                     CALL STPFEP;

  23727 11 000454   011235 701000 11                 TSX1    STPFEP
        11 000455   000000 011000                    NOP     0

     1324    23728    3              END;

  23728 11 000456   200025 235100                    LDA     FEX,,AUTO
        11 000457   000001 035007                    ADLA    1,DL
        11 000460   200025 755100                    STA     FEX,,AUTO
        11 000461   000000 236000 xsym               LDQ     KL_MXFE
        11 000462   200025 116100                    CMPQ    FEX,,AUTO
        11 000463   000444 603000 11                 TRC     s:23724
        11 000464   001537 710000 11                 TRA     BHSON1

     1325    23729
     1326    23730
     1327    23731    2        CASE (KEY_HARDSTP#);

     1328    23732    2           CALL KCHK ALTRET (KBD);

  23732 11 000465   011312 701000 11                 TSX1    KCHK
        11 000466   011051 702000 11                 TSX2    KBD

     1329    23733    2           IF FEX ~= 0
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:282  

  23733 11 000467   200025 235100                    LDA     FEX,,AUTO
        11 000470   000476 600000 11                 TZE     s:23740

     1330    23734    2           THEN
     1331    23735    2                CALL LOCAL_CHECK

  23735 11 000471   011411 701000 11                 TSX1    LOCAL_CHECK
        11 000472   000475 702000 11                 TSX2    s:23738

     1332    23736    3                WHENRETURN DO;

     1333    23737    3                     CALL STFEPNM ALTRET(STPERR);

  23737 11 000473   011267 701000 11                 TSX1    STFEPNM
        11 000474   011125 702000 11                 TSX2    STPERR

     1334    23738    3                   END;

  23738 11 000475   001537 710000 11                 TRA     BHSON1

     1335    23739    2           ELSE
     1336    23740    3           DO FEX=1 TO KL_MXFE;

  23740 11 000476   000001 236007                    LDQ     1,DL
        11 000477   200025 756100                    STQ     FEX,,AUTO
        11 000500   000514 710000 11                 TRA     s:23744+3

     1337    23741    3                IF KL_FETBL.LINK_CONNECT(FEX) AND NOT KL_FETBL.HOST_NODE(FEX)

  23741 11 000501   200025 720100                    LXL0    FEX,,AUTO
        11 000502   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000503   200000 316003                    CANQ    65536,DU
        11 000504   000511 600000 11                 TZE     s:23744
        11 000505   000000 234010 xsym               SZN     KL_FETBL,X0
        11 000506   000511 604000 11                 TMI     s:23744

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:283  
     1338    23742    3                THEN
     1339    23743    3                     CALL STFEPNM;

  23743 11 000507   011267 701000 11                 TSX1    STFEPNM
        11 000510   000000 011000                    NOP     0

     1340    23744    3              END;

  23744 11 000511   200025 235100                    LDA     FEX,,AUTO
        11 000512   000001 035007                    ADLA    1,DL
        11 000513   200025 755100                    STA     FEX,,AUTO
        11 000514   000000 236000 xsym               LDQ     KL_MXFE
        11 000515   200025 116100                    CMPQ    FEX,,AUTO
        11 000516   000501 603000 11                 TRC     s:23741
        11 000517   001537 710000 11                 TRA     BHSON1

     1341    23745
     1342    23746
     1343    23747    2        CASE (KEY_HEAD#);

     1344    23748    2           BCHS.CODE_=IGA_HDR;

  23748 11 000520   017000 236003                    LDQ     7680,DU
        11 000521   000536 552040 7                  STBQ    BCHS,'40'O

     1345    23749    2           GOTO BCST;

  23749 11 000522   000525 710000 11                 TRA     BCST

     1346    23750
     1347    23751
     1348    23752    2        CASE (KEY_BROAD#);

     1349    23753    2           BCHS.CODE_=IGA_BCST;

  23753 11 000523   013000 236003                    LDQ     5632,DU
        11 000524   000536 552040 7                  STBQ    BCHS,'40'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:284  

  23753 11 000525                       BCST         null
     1350    23754    2   BCST:   ;
     1351    23755    2           KL_BROADSZ=KBCHS.CNT;

  23755 11 000525   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 000526   000033 772000                    QRL     27
        11 000527   000000 756000 xsym               STQ     KL_BROADSZ

     1352    23756    2           KL_HDRMSG.MSG_=KBCHS.MSG;

  23756 11 000530   040000 100400                    MLR     fill='040'O
        11 000531   000004 200170 xsym               ADSC9   JC_CSMBF+4               cn=1,n=120
        11 000532   000000 400170 xsym               ADSC9   KL_HDRMSG                cn=2,n=120

     1353    23757    2           GOTO SALL;

  23757 11 000533   000536 710000 11                 TRA     SALL

     1354    23758
     1355    23759
     1356    23760    2        CASE (KEY_SALL#);

     1357    23761    2           BCHS.CODE_=IGA_SALL;

  23761 11 000534   011000 236003                    LDQ     4608,DU
        11 000535   000536 552040 7                  STBQ    BCHS,'40'O

  23761 11 000536                       SALL         null
     1358    23762    2   SALL:   ;
     1359    23763    2           BCHS.TYP_ = 0;

  23763 11 000536   000000 236003                    LDQ     0,DU
        11 000537   000536 552020 7                  STBQ    BCHS,'20'O

     1360    23764    2           BCHS.MSG_=KBCHS.MSG;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:285  
  23764 11 000540   040000 100400                    MLR     fill='040'O
        11 000541   000004 200172 xsym               ADSC9   JC_CSMBF+4               cn=1,n=122
        11 000542   000536 400172 7                  ADSC9   BCHS                     cn=2,n=122

     1361    23765    2           LEN=LENGTHC(BCHS)-LENGTHC(BCHS.MSG_)+KBCHS.CNT;

  23765 11 000543   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 000544   000033 772000                    QRL     27
        11 000545   000002 036007                    ADLQ    2,DL
        11 000546   200007 756100                    STQ     LEN,,AUTO

     1362    23766    3           DO FEX=0 TO KL_MXFE;

  23766 11 000547   200025 450100                    STZ     FEX,,AUTO
        11 000550   000574 710000 11                 TRA     BHSON+3

     1363    23767    3                IF KL_FETBL.BOSS(FEX) AND NOT KL_FETBL.DEBUG(FEX)

  23767 11 000551   200025 720100                    LXL0    FEX,,AUTO
        11 000552   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 000553   040000 316003                    CANQ    16384,DU
        11 000554   000571 600000 11                 TZE     BHSON
        11 000555   020000 316003                    CANQ    8192,DU
        11 000556   000571 601000 11                 TNZ     BHSON

     1364    23768    3                THEN
     1365    23769    3                     CALL KLX$WRHLPNODE(BCHS,LEN,FEX) ALTRET (BHSON);

  23769 11 000557   200025 630500                    EPPR0   FEX,,AUTO
        11 000560   200430 450500                    STP0    T$+3,,AUTO
        11 000561   200007 631500                    EPPR1   LEN,,AUTO
        11 000562   200427 451500                    STP1    T$+2,,AUTO
        11 000563   000016 236000 12                 LDQ     14
        11 000564   200426 756100                    STQ     T$+1,,AUTO
        11 000565   200426 630500                    EPPR0   T$+1,,AUTO
        11 000566   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000567   000000 701000 xent               TSX1    KLX$WRHLPNODE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:286  
        11 000570   000571 702000 11                 TSX2    BHSON

  23768 11 000571                       BHSON        null
     1366    23770    3   BHSON:       ;
     1367    23771    3              END;

  23771 11 000571   200025 235100                    LDA     FEX,,AUTO
        11 000572   000001 035007                    ADLA    1,DL
        11 000573   200025 755100                    STA     FEX,,AUTO
        11 000574   000000 236000 xsym               LDQ     KL_MXFE
        11 000575   200025 116100                    CMPQ    FEX,,AUTO
        11 000576   000551 603000 11                 TRC     s:23767
        11 000577   001537 710000 11                 TRA     BHSON1

     1368    23772
     1369    23773
     1370    23774    2        CASE (KEY_SENDFEP#);

     1371    23775    2           CALL KCHK ALTRET(KBD);

  23775 11 000600   011312 701000 11                 TSX1    KCHK
        11 000601   011051 702000 11                 TSX2    KBD

     1372    23776    2           BCHS.CODE_=IGA_SALL;

  23776 11 000602   011000 236003                    LDQ     4608,DU
        11 000603   000536 552040 7                  STBQ    BCHS,'40'O

     1373    23777    2           BCHS.TYP_ = FEX;

  23777 11 000604   200025 236100                    LDQ     FEX,,AUTO
        11 000605   000022 736000                    QLS     18
        11 000606   000536 552020 7                  STBQ    BCHS,'20'O

     1374    23778    2           BCHS.MSG_=KBCHS.MSG;

  23778 11 000607   040000 100400                    MLR     fill='040'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:287  
        11 000610   000004 200172 xsym               ADSC9   JC_CSMBF+4               cn=1,n=122
        11 000611   000536 400172 7                  ADSC9   BCHS                     cn=2,n=122

     1375    23779    2           LEN=LENGTHC(BCHS)-LENGTHC(BCHS.MSG_)+KBCHS.CNT;

  23779 11 000612   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 000613   000033 772000                    QRL     27
        11 000614   000002 036007                    ADLQ    2,DL
        11 000615   200007 756100                    STQ     LEN,,AUTO

     1376    23780    2           CALL KLX$WRHLPNODE(BCHS,LEN,FEX) ALTRET (BHSON1);

  23780 11 000616   200025 630500                    EPPR0   FEX,,AUTO
        11 000617   200430 450500                    STP0    T$+3,,AUTO
        11 000620   200007 631500                    EPPR1   LEN,,AUTO
        11 000621   200427 451500                    STP1    T$+2,,AUTO
        11 000622   000016 236000 12                 LDQ     14
        11 000623   200426 756100                    STQ     T$+1,,AUTO
        11 000624   200426 630500                    EPPR0   T$+1,,AUTO
        11 000625   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000626   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 000627   001537 702000 11                 TSX2    BHSON1

     1377    23781        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:288  
     1378    23782    2           CALL KLX$WRHLPNODE(BCHS,LEN,KL_NODE) ALTRET (BHSON1);

  23782 11 000630   000017 236000 12                 LDQ     15
        11 000631   200430 756100                    STQ     T$+3,,AUTO
        11 000632   200007 630500                    EPPR0   LEN,,AUTO
        11 000633   200427 450500                    STP0    T$+2,,AUTO
        11 000634   000016 236000 12                 LDQ     14
        11 000635   200426 756100                    STQ     T$+1,,AUTO
        11 000636   200426 630500                    EPPR0   T$+1,,AUTO
        11 000637   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000640   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 000641   001537 702000 11                 TSX2    BHSON1
        11 000642   001537 710000 11                 TRA     BHSON1

     1379    23783
     1380    23784    2        CASE(KEY_FIRMLOAD#);

     1381    23785    2   FRWD:   ;                               /* Forward this to MONKEY */

  23785 11 000643                       FRWD         null
     1382    23786    2           DVCKYN_FRWD.RTN# = 2;  /*N* RTNX OF NIK$KEYIN SHOULD BE A SUB */

  23786 11 000643   002000 236003                    LDQ     1024,DU
        11 000644   000000 552040 xsym               STBQ    JC_CSMBF,'40'O

     1383    23787    2           WRITE_MONKEY.BUF_.BOUND = 11;   /* Valid part of message */

  23787 11 000645   000314 236000 7                  LDQ     WRITE_MONKEY+4
        11 000646   177777 376007                    ANQ     65535,DL
        11 000647   000020 276000 12                 ORQ     16
        11 000650   000314 756000 7                  STQ     WRITE_MONKEY+4

     1384    23788    2           CALL M$WRITE(WRITE_MONKEY) ALTRET(DVCERR);

  23788 11 000651   000310 630400 7                  EPPR0   WRITE_MONKEY
        11 000652   440001 713400                    CLIMB   alt,write
        11 000653   401400 401760                    pmme    nvectors=4
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:289  
        11 000654   001254 702000 11                 TSX2    DVCERR
        11 000655   001537 710000 11                 TRA     BHSON1

     1385    23789        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:290  
     1386    23790    2        CASE(KEY_DEVS#);

     1387    23791    2           WKBER.BUF_ = VECTOR(FEPMES);

  23791 11 000656   000021 235000 12                 LDA     17
        11 000657   200426 452500                    STP2    T$+1,,AUTO
        11 000660   200426 236100                    LDQ     T$+1,,AUTO
        11 000661   000350 036003                    ADLQ    232,DU
        11 000662   000426 757000 7                  STAQ    WKBER+4

     1388    23792    2           FEPMES.CADDR = DVCKYN.CADDR;

  23792 11 000663   000000 720000 xsym               LXL0    JC_CSMBF
        11 000664   200350 740100                    STX0    FEPMES,,AUTO

     1389    23793    2           KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  23793 11 000665   000022 237000 12                 LDAQ    18
        11 000666   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

     1390    23794    2           IF DVCKYN.DEVNM ~= ' ' THEN

  23794 11 000667   000001 236000 xsym               LDQ     JC_CSMBF+1
        11 000670   000035 116000 xsym               CMPQ    B_VECTNIL+29
        11 000671   000737 600000 11                 TZE     s:23830

     1391    23795    3           DO;

     1392    23796        /*
     1393    23797             a device name was specified
     1394    23798        */
     1395    23799    3                KL_NETWORK_KEY.KEY = '0'B;

  23799 11 000672   000000 100400                    MLR     fill='000'O
        11 000673   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 000674   000000 200022 xsym               ADSC9   KL_NETWORK_KEY           cn=1,n=18

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:291  
     1396    23800    3                KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  23800 11 000675   022000 236003                    LDQ     9216,DU
        11 000676   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     1397    23801    3                CALL M$PRECORD(KL_PR_NETWORK)

  23801 11 000677   000000 630400 xsym               EPPR0   KL_PR_NETWORK
        11 000700   440003 713400                    CLIMB   alt,+16387
        11 000701   401000 401760                    pmme    nvectors=3
        11 000702   000710 702000 11                 TSX2    s:23808

     1398    23802    3                WHENRETURN
     1399    23803    4                DO;

     1400    23804    4                     CALL M$READ (KL_RD_NETWORK) ALTRET(FRWD);

  23804 11 000703   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 000704   440000 713400                    CLIMB   alt,read
        11 000705   401400 401760                    pmme    nvectors=4
        11 000706   000643 702000 11                 TSX2    FRWD

     1401    23805    4                   END;

  23805 11 000707   000716 710000 11                 TRA     s:23818

     1402    23806    3                WHENALTRETURN
     1403    23807    4                DO;                        /* it is expected */

     1404    23808    4                     CALL M$READ (KL_RD_NETWORK)

  23808 11 000710   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 000711   440000 713400                    CLIMB   alt,read
        11 000712   401400 401760                    pmme    nvectors=4
        11 000713   000715 702000 11                 TSX2    s:23814
        11 000714   000716 710000 11                 TRA     s:23818

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:292  
     1405    23809    4                     WHENALTRETURN
     1406    23810        /*
     1407    23811             no devices exist forward the keyin to monkey
     1408    23812        */
     1409    23813    5                     DO;

     1410    23814    5                          GOTO FRWD;

  23814 11 000715   000643 710000 11                 TRA     FRWD

     1411    23815    5                        END;
     1412    23816    4                   END;

     1413    23817    4                DO WHILE '1'B;

     1414    23818    4                     IF SUBSTR(KL_NETWORK_BUF.DEVNM,0,4) = DVCKYN.DEVNM THEN

  23818 11 000716   040000 106400                    CMPC    fill='040'O
        11 000717   000003 400004 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=4
        11 000720   000001 000004 xsym               ADSC9   JC_CSMBF+1               cn=0,n=4
        11 000721   000726 601000 11                 TNZ     s:23825

     1415    23819    5                     DO;

     1416    23820    5                          IF CTXHD$ = ADDR(NIL) THEN

  23820 11 000722   000022 236000 7                  LDQ     CTXHD$
        11 000723   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 000724   000742 600000 11                 TZE     NOKEYINS

     1417    23821    5                               GOTO NOKEYINS;
     1418    23822    5                          ELSE
     1419    23823    5                               GOTO KEYINS;

  23823 11 000725   000756 710000 11                 TRA     KEYINS

     1420    23824    5                        END;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:293  
     1421    23825    4                     CALL M$PRECORD(KL_PR_NETWORK) ALTRET(FRWD);

  23825 11 000726   000000 630400 xsym               EPPR0   KL_PR_NETWORK
        11 000727   440003 713400                    CLIMB   alt,+16387
        11 000730   401000 401760                    pmme    nvectors=3
        11 000731   000643 702000 11                 TSX2    FRWD

     1422    23826    4                     CALL M$READ(KL_RD_NETWORK) ALTRET(FRWD);

  23826 11 000732   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 000733   440000 713400                    CLIMB   alt,read
        11 000734   401400 401760                    pmme    nvectors=4
        11 000735   000643 702000 11                 TSX2    FRWD

     1423    23827    4                   END;

  23827 11 000736   000716 710000 11                 TRA     s:23818

     1424    23828    3              END;                         /* if twsn ~= ' ' */
     1425    23829
     1426    23830    2           IF CTXHD$ = ADDR(NIL) THEN

  23830 11 000737   000022 236000 7                  LDQ     CTXHD$
        11 000740   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 000741   000756 601000 11                 TNZ     KEYINS

     1427    23831    3   NOKEYINS: DO;

  23831 11 000742                       NOKEYINS     null
     1428    23832    3                FEPMES.MSG# = NFEPKIPND_MSG#;

  23832 11 000742   000257 220003                    LDX0    175,DU
        11 000743   200350 440100                    SXL0    FEPMES,,AUTO

     1429    23833    3                FEPMES.NPARAMS = 0;

  23833 11 000744   000000 236003                    LDQ     0,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:294  
        11 000745   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     1430    23834    3                FEPMES.FCN = OC_WR;

  23834 11 000746   000003 236007                    LDQ     3,DL
        11 000747   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

     1431    23835    4                CALL M$WRITE(WKBER) WHENALTRETURN DO;

  23835 11 000750   000422 630400 7                  EPPR0   WKBER
        11 000751   440001 713400                    CLIMB   alt,write
        11 000752   401400 401760                    pmme    nvectors=4
        11 000753   000755 702000 11                 TSX2    s:23837
        11 000754   000755 710000 11                 TRA     s:23837

     1432    23836    4                   END;                    /* WHENALTRETURN */

     1433    23837    3              END;                         /* IF CTXHD$ = ADDR(NIL) */

  23837 11 000755   001022 710000 11                 TRA     s:23859

     1434    23838    2           ELSE
     1435    23839    3   KEYINS: DO;

  23839 11 000756                       KEYINS       null
     1436    23840    3                CTX$ = CTXHD$;

  23840 11 000756   200021 756100                    STQ     CTX$,,AUTO

     1437    23841    4                DO WHILE(CTX$ ~= ADDR(NIL));

  23841 11 000757   001020 710000 11                 TRA     s:23857

     1438    23842    4                     FEPMES.DEVNM = DVCERRCTX.DEVNM;

  23842 11 000760   200021 470500                    LDP0    CTX$,,AUTO
        11 000761   040100 100500                    MLR     fill='040'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:295  
        11 000762   000006 200010                    ADSC9   6,,PR0                   cn=1,n=8
        11 000763   200353 000010                    ADSC9   FEPMES+3,,AUTO           cn=0,n=8

     1439    23843    4                     FEPMES.MSG# = KIPND_MSG#;

  23843 11 000764   000227 220003                    LDX0    151,DU
        11 000765   200350 440100                    SXL0    FEPMES,,AUTO

     1440    23844    4                     FEPMES.FCN = OC_WR;

  23844 11 000766   000003 236007                    LDQ     3,DL
        11 000767   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

     1441    23845    4                     FEPMES.NPARAMS = 1;

  23845 11 000770   001000 236007                    LDQ     512,DL
        11 000771   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     1442    23846    4                     FEPMES.FCNT = 1;

  23846 11 000772   001000 236003                    LDQ     512,DU
        11 000773   200355 552140                    STBQ    FEPMES+5,'40'O,AUTO

     1443    23847    4                     IF DVCERRCTX.KEYIN_REQ

  23847 11 000774   000010 236100                    LDQ     8,,PR0
        11 000775   000400 316003                    CANQ    256,DU
        11 000776   001002 600000 11                 TZE     s:23851

     1444    23848    4                     THEN
     1445    23849    4                          FEPMES.FNCNT = 4;

  23849 11 000777   000004 236003                    LDQ     4,DU
        11 001000   200355 552120                    STBQ    FEPMES+5,'20'O,AUTO
        11 001001   001004 710000 11                 TRA     s:23852

     1446    23850    4                     ELSE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:296  
     1447    23851    4                          FEPMES.FNCNT = 3;

  23851 11 001002   000003 236003                    LDQ     3,DU
        11 001003   200355 552120                    STBQ    FEPMES+5,'20'O,AUTO

     1448    23852    4                     IF SUBSTR(DVCERRCTX.DEVNM,4,4) = DVCKYN.TWSN

  23852 11 001004   040000 106500                    CMPC    fill='040'O
        11 001005   000007 200004                    ADSC9   7,,PR0                   cn=1,n=4
        11 001006   000002 000004 xsym               ADSC9   JC_CSMBF+2               cn=0,n=4
        11 001007   001015 601000 11                 TNZ     s:23856

     1449    23853    4                     THEN
     1450    23854    5                          CALL M$WRITE(WKBER) WHENALTRETURN DO;

  23854 11 001010   000422 630400 7                  EPPR0   WKBER
        11 001011   440001 713400                    CLIMB   alt,write
        11 001012   401400 401760                    pmme    nvectors=4
        11 001013   001015 702000 11                 TSX2    s:23856
        11 001014   001015 710000 11                 TRA     s:23856

     1451    23855    5                             END;          /* WHENALTRETURN */

     1452    23856    4                     CTX$ = DVCERRCTX.LNK$;

  23856 11 001015   200021 470500                    LDP0    CTX$,,AUTO
        11 001016   000000 236100                    LDQ     0,,PR0
        11 001017   200021 756100                    STQ     CTX$,,AUTO

     1453    23857    4                   END;                    /* DO WHILE */

  23857 11 001020   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 001021   000760 601000 11                 TNZ     s:23842

     1454    23858    3              END;                         /* ELSE */

     1455    23859    2           IF DVCKYN.DEVNM = ' ' THEN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:297  

  23859 11 001022   000001 236000 xsym               LDQ     JC_CSMBF+1
        11 001023   000035 116000 xsym               CMPQ    B_VECTNIL+29
        11 001024   000643 600000 11                 TZE     FRWD

     1456    23860    2                GOTO FRWD;
     1457    23861    2           KL_NETWORK_KEY.KEY = '0'B;      /* reset the key */

  23861 11 001025   000000 100400                    MLR     fill='000'O
        11 001026   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 001027   000000 200022 xsym               ADSC9   KL_NETWORK_KEY           cn=1,n=18

     1458    23862    2           KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  23862 11 001030   022000 236003                    LDQ     9216,DU
        11 001031   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     1459    23863    2           RETURN;

  23863 11 001032   000000 702200 xent               TSX2  ! X66_ARET

     1460    23864        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:298  
     1461    23865    2        CASE(KEY_QUIET#,KEY_RETRY#,KEY_ERROR#,KEY_PROCEED#);

     1462    23866    2           TWSN_KEY.TWSN = DVCKYN.TWSN;

  23866 11 001033   040000 100400                    MLR     fill='040'O
        11 001034   000002 000004 xsym               ADSC9   JC_CSMBF+2               cn=0,n=4
        11 001035   000001 200004 7                  ADSC9   TWSN_KEY+1               cn=1,n=4

     1463    23867    2           READ_HLPF.BUF_.BOUND = 2047;

  23867 11 001036   000010 236000 7                  LDQ     READ_HLPF+4
        11 001037   177777 376007                    ANQ     65535,DL
        11 001040   000024 276000 12                 ORQ     20
        11 001041   000010 756000 7                  STQ     READ_HLPF+4

     1464    23868    2           CALL M$READ(READ_HLPF) ALTRET(FRWD);

  23868 11 001042   000004 630400 7                  EPPR0   READ_HLPF
        11 001043   440000 713400                    CLIMB   alt,read
        11 001044   401400 401760                    pmme    nvectors=4
        11 001045   000643 702000 11                 TSX2    FRWD

     1465    23869    3           DO I = 0 TO TWSN_REC.NDEV - 1;

  23869 11 001046   200010 450100                    STZ     I,,AUTO
        11 001047   001247 710000 11                 TRA     s:23915+3

     1466    23870    3                CALL CONCAT(DEVNM,TWSN_REC.DEVS.TYP(I),TWSN_REC.DEVS.NUM(I));

  23870 11 001050   200010 236100                    LDQ     I,,AUTO
        11 001051   000013 402007                    MPY     11,DL
        11 001052   000000 470400 xsym               LDP0    KL_HLPR$
        11 001053   000005 220106                    LDX0    5,QL,PR0
        11 001054   200004 740100                    STX0    DEVNM,,AUTO
        11 001055   000005 721106                    LXL1    5,QL,PR0
        11 001056   200004 441100                    SXL1    DEVNM,,AUTO

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:299  
     1467    23871    4                IF DEVNM = DVCKYN.DEVNM THEN DO;

  23871 11 001057   200004 236100                    LDQ     DEVNM,,AUTO
        11 001060   000001 116000 xsym               CMPQ    JC_CSMBF+1
        11 001061   001244 601000 11                 TNZ     s:23915

     1468    23872    4                     IF TWSN_REC.DEVS.TDEV(I) THEN GOTO DVCERR;

  23872 11 001062   200010 236100                    LDQ     I,,AUTO
        11 001063   000013 402007                    MPY     11,DL
        11 001064   000000 470400 xsym               LDP0    KL_HLPR$
        11 001065   000006 236106                    LDQ     6,QL,PR0
        11 001066   000100 316007                    CANQ    64,DL
        11 001067   001254 601000 11                 TNZ     DVCERR

     1469    23873    4                     IF TWSN_REC.DEVS.IOM_CONNECTED(I) THEN GOTO FRWD;

  23873 11 001070   200010 236100                    LDQ     I,,AUTO
        11 001071   000013 402007                    MPY     11,DL
        11 001072   000006 236106                    LDQ     6,QL,PR0
        11 001073   000040 316007                    CANQ    32,DL
        11 001074   000643 601000 11                 TNZ     FRWD

     1470    23874                            /* If we get here its a KEYIN for a FEP connected device */
     1471    23875    5                     DO CASE(DVCKYN.KIN#);

  23875 11 001075   000000 235000 xsym               LDA     JC_CSMBF
        11 001076   000022 771000                    ARL     18
        11 001077   000022 135007                    SBLA    18,DL
        11 001100   000004 115007                    CMPA    4,DL
        11 001101   001103 602005 11                 TNC     s:23875+6,AL
        11 001102   001244 710000 11                 TRA     s:23915
        11 001103   001107 710000 11                 TRA     s:23877
        11 001104   001107 710000 11                 TRA     s:23877
        11 001105   001107 710000 11                 TRA     s:23877
        11 001106   001107 710000 11                 TRA     s:23877

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:300  
     1472    23876    5                     CASE(KEY_ERROR#,KEY_PROCEED#,KEY_RETRY#,KEY_QUIET#);

     1473    23877    5                        CALL CONCAT(DEVNM_TWSN,DEVNM,DVCKYN.TWSN);

  23877 11 001107   200004 236100                    LDQ     DEVNM,,AUTO
        11 001110   200005 756100                    STQ     DEVNM_TWSN,,AUTO
        11 001111   000002 236000 xsym               LDQ     JC_CSMBF+2
        11 001112   200006 756100                    STQ     DEVNM_TWSN+1,,AUTO

     1474    23878    5                        CTX$ = CTXHD$;

  23878 11 001113   000022 236000 7                  LDQ     CTXHD$
        11 001114   200021 756100                    STQ     CTX$,,AUTO

     1475    23879    6                        DO WHILE(CTX$ ~= ADDR(NIL));

  23879 11 001115   001202 710000 11                 TRA     s:23899

     1476    23880    7                             IF DVCERRCTX.DEVNM = DEVNM_TWSN THEN DO;

  23880 11 001116   200021 470500                    LDP0    CTX$,,AUTO
        11 001117   040100 106500                    CMPC    fill='040'O
        11 001120   000006 200010                    ADSC9   6,,PR0                   cn=1,n=8
        11 001121   200005 000010                    ADSC9   DEVNM_TWSN,,AUTO         cn=0,n=8
        11 001122   001200 601000 11                 TNZ     s:23898

     1477    23881    7                                  FEPMES.DEVNM = DEVNM_TWSN;

  23881 11 001123   040100 100500                    MLR     fill='040'O
        11 001124   200005 000010                    ADSC9   DEVNM_TWSN,,AUTO         cn=0,n=8
        11 001125   200353 000010                    ADSC9   FEPMES+3,,AUTO           cn=0,n=8

     1478    23882    7                                  FEPMES.FCN = OC_STTM;

  23882 11 001126   000001 236007                    LDQ     1,DL
        11 001127   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:301  
     1479    23883    7                                  FEPMES.CADDR = M_DEVC;

  23883 11 001130   100000 220003                    LDX0    32768,DU
        11 001131   200350 740100                    STX0    FEPMES,,AUTO

     1480    23884    7                                  FEPMES.MSGID = DVCERRCTX.MSGID;

  23884 11 001132   000001 721100                    LXL1    1,,PR0
        11 001133   200351 741100                    STX1    FEPMES+1,,AUTO

     1481    23885    7                                  FEPMES.NPARAMS = 0;

  23885 11 001134   000000 236003                    LDQ     0,DU
        11 001135   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     1482    23886    7                                  WKBER.BUF_ = VECTOR(FEPMES);

  23886 11 001136   000021 235000 12                 LDA     17
        11 001137   200426 452500                    STP2    T$+1,,AUTO
        11 001140   200426 236100                    LDQ     T$+1,,AUTO
        11 001141   000350 036003                    ADLQ    232,DU
        11 001142   000426 757000 7                  STAQ    WKBER+4

     1483    23887    8                                  CALL M$WRITE(WKBER) WHENALTRETURN DO;

  23887 11 001143   000422 630400 7                  EPPR0   WKBER
        11 001144   440001 713400                    CLIMB   alt,write
        11 001145   401400 401760                    pmme    nvectors=4
        11 001146   001150 702000 11                 TSX2    s:23889
        11 001147   001150 710000 11                 TRA     s:23889

     1484    23888    8                                     END;  /* WHENALTRETURN */

     1485    23889    7                                  KL_DVCERRRSP.KYN# = DVCKYN.KIN#;

  23889 11 001150   000000 220000 xsym               LDX0    JC_CSMBF
        11 001151   000575 440000 7                  SXL0    KL_DVCERRRSP
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:302  

     1486    23890    7                                  KL_DVCERRRSP.TERMID = DVCERRCTX.TERMID;

  23890 11 001152   200021 470500                    LDP0    CTX$,,AUTO
        11 001153   000000 100500                    MLR     fill='000'O
        11 001154   000002 000020                    ADSC9   2,,PR0                   cn=0,n=16
        11 001155   000576 000020 7                  ADSC9   KL_DVCERRRSP+1           cn=0,n=16

     1487    23891    7                                  FEX = DVCERRCTX.FEX;

  23891 11 001156   000006 236100                    LDQ     6,,PR0
        11 001157   000033 772000                    QRL     27
        11 001160   200025 756100                    STQ     FEX,,AUTO

     1488    23892    7                                  LEN = SIZEC(KL_DVCERRRSP);

  23892 11 001161   000024 235007                    LDA     20,DL
        11 001162   200007 755100                    STA     LEN,,AUTO

     1489    23893    8                                  CALL KLX$WRHLPNODE(KL_DVCERRRSP,LEN,FEX)
             23893                                           WHENALTRETURN DO;

  23893 11 001163   200025 631500                    EPPR1   FEX,,AUTO
        11 001164   200430 451500                    STP1    T$+3,,AUTO
        11 001165   200007 633500                    EPPR3   LEN,,AUTO
        11 001166   200427 453500                    STP3    T$+2,,AUTO
        11 001167   000025 236000 12                 LDQ     21
        11 001170   200426 756100                    STQ     T$+1,,AUTO
        11 001171   200426 630500                    EPPR0   T$+1,,AUTO
        11 001172   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 001173   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 001174   001176 702000 11                 TSX2    s:23894
        11 001175   001177 710000 11                 TRA     s:23896

     1490    23894    8                                       GOTO DVCERR;

  23894 11 001176   001254 710000 11                 TRA     DVCERR
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:303  

     1491    23895    8                                     END;  /* WHENALTRETURN */
     1492    23896    7                                  GOTO RTN;

  23896 11 001177   001537 710000 11                 TRA     BHSON1

     1493    23897    7                                END;       /* IF */
     1494    23898    6                             CTX$ = DVCERRCTX.LNK$;

  23898 11 001200   000000 236100                    LDQ     0,,PR0
        11 001201   200021 756100                    STQ     CTX$,,AUTO

     1495    23899    6                           END;            /* DO WHILE */

  23899 11 001202   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 001203   001116 601000 11                 TNZ     s:23880

     1496    23900        /* If we got here the spec'd device was not expecting a KEYIN */
     1497    23901    5                        FEPMES.DEVNM = DEVNM_TWSN;

  23901 11 001204   040100 100500                    MLR     fill='040'O
        11 001205   200005 000010                    ADSC9   DEVNM_TWSN,,AUTO         cn=0,n=8
        11 001206   200353 000010                    ADSC9   FEPMES+3,,AUTO           cn=0,n=8

     1498    23902    5                        FEPMES.MSG# = URPS_NKEYIN_MSG#;

  23902 11 001207   000255 220003                    LDX0    173,DU
        11 001210   200350 440100                    SXL0    FEPMES,,AUTO

     1499    23903    5                        FEPMES.CADDR = M_DEVC;

  23903 11 001211   100000 221003                    LDX1    32768,DU
        11 001212   200350 741100                    STX1    FEPMES,,AUTO

     1500    23904    5                        FEPMES.NPARAMS = 1;

  23904 11 001213   001000 236007                    LDQ     512,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:304  
        11 001214   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     1501    23905    5                        FEPMES.FCNT = 1;

  23905 11 001215   001000 236003                    LDQ     512,DU
        11 001216   200355 552140                    STBQ    FEPMES+5,'40'O,AUTO

     1502    23906    5                        FEPMES.FCN = OC_WR;

  23906 11 001217   000003 236007                    LDQ     3,DL
        11 001220   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

     1503    23907    5                        PARM$ = ADDR(FEPMES.MSG);

  23907 11 001221   200426 452500                    STP2    T$+1,,AUTO
        11 001222   200426 236100                    LDQ     T$+1,,AUTO
        11 001223   000026 036000 12                 ADLQ    22
        11 001224   200034 756100                    STQ     PARM$,,AUTO

     1504    23908    5                        CNT = FEX;

  23908 11 001225   200034 470500                    LDP0    PARM$,,AUTO
        11 001226   003100 061500                    CSR     bolr='003'O
        11 001227   200025 000044                    BDSC    FEX,,AUTO                by=0,bit=0,n=36
        11 001230   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

     1505    23909    5                        WKBER.BUF_ = VECTOR(FEPMES);

  23909 11 001231   000021 235000 12                 LDA     17
        11 001232   200426 452500                    STP2    T$+1,,AUTO
        11 001233   200426 236100                    LDQ     T$+1,,AUTO
        11 001234   000350 036003                    ADLQ    232,DU
        11 001235   000426 757000 7                  STAQ    WKBER+4

     1506    23910    6                        CALL M$WRITE(WKBER) WHENALTRETURN DO;

  23910 11 001236   000422 630400 7                  EPPR0   WKBER
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:305  
        11 001237   440001 713400                    CLIMB   alt,write
        11 001240   401400 401760                    pmme    nvectors=4
        11 001241   001243 702000 11                 TSX2    s:23912
        11 001242   001243 710000 11                 TRA     s:23912

     1507    23911    6                           END;            /* WHENALTRETURN */

     1508    23912    5                        GOTO RTN;

  23912 11 001243   001537 710000 11                 TRA     BHSON1

     1509    23913    5                     END;                  /* DO CASE(DVCKYN.KIN#) */

     1510    23914    4                   END;                    /* IF DEVNM = DVCKYN.DEVNM */
     1511    23915    3              END;                         /* DO I */

  23915 11 001244   200010 235100                    LDA     I,,AUTO
        11 001245   000001 035007                    ADLA    1,DL
        11 001246   200010 755100                    STA     I,,AUTO
        11 001247   000000 470400 xsym               LDP0    KL_HLPR$
        11 001250   200010 236100                    LDQ     I,,AUTO
        11 001251   000004 116100                    CMPQ    4,,PR0
        11 001252   001050 602000 11                 TNC     s:23870

     1512    23916    2           GOTO FRWD;

  23916 11 001253   000643 710000 11                 TRA     FRWD

     1513    23917    2   DVCERR: ;                               /* If we got here there was an error */

  23917 11 001254   001537 710000 11    DVCERR       TRA     BHSON1

     1514    23918                   /*N* Print an error message */
     1515    23919        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:306  
     1516    23920    2        CASE (KEY_DISABLE#);

     1517    23921    2           ADMIN.FNC = %KHA_FNC_DISABLE;

  23921 11 001255   000002 220003                    LDX0    2,DU
        11 001256   000612 440000 7                  SXL0    ADMIN+8

  23921 11 001257                       FEP_KEYIN    null
     1518    23922    2   FEP_KEYIN: ;
     1519    23923    2           ADMIN.TERMID_LO.LEV = %TERMINAL_ID_LEV_CHAN#;

  23923 11 001257   000001 236003                    LDQ     1,DU
        11 001260   000613 552020 7                  STBQ    ADMIN+9,'20'O

     1520    23924    2           ADMIN.TERMID_LO.TERM.CHANNEL.BYT(0) = ENABLE_KEYIN.LINE_LOW#/256;

  23924 11 001261   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 001262   000022 772000                    QRL     18
        11 001263   000010 772000                    QRL     8
        11 001264   000011 736000                    QLS     9
        11 001265   000613 676000 7                  ERQ     ADMIN+9
        11 001266   377000 376007                    ANQ     130560,DL
        11 001267   000613 656000 7                  ERSQ    ADMIN+9

     1521    23925    2           ADMIN.TERMID_LO.TERM.CHANNEL.BYT(1) = MOD(ENABLE_KEYIN.LINE_LOW#,256);

  23925 11 001270   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 001271   000022 772000                    QRL     18
        11 001272   000377 376007                    ANQ     255,DL
        11 001273   000613 676000 7                  ERQ     ADMIN+9
        11 001274   000377 376007                    ANQ     255,DL
        11 001275   000613 656000 7                  ERSQ    ADMIN+9

     1522    23926    2           ADMIN.TERMID_HI = ADMIN.TERMID_LO;

  23926 11 001276   000000 100400                    MLR     fill='000'O
        11 001277   000613 000020 7                  ADSC9   ADMIN+9                  cn=0,n=16
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:307  
        11 001300   000617 000020 7                  ADSC9   ADMIN+13                 cn=0,n=16

     1523    23927    2           IF ENABLE_KEYIN.LINE_HI# ~= 0

  23927 11 001301   000004 720000 xsym               LXL0    JC_CSMBF+4
        11 001302   001322 600000 11                 TZE     s:23933

     1524    23928    3           THEN DO;

     1525    23929    3                ADMIN.TERMID_HI.LEV = %TERMINAL_ID_LEV_CHAN#;

  23929 11 001303   000001 236003                    LDQ     1,DU
        11 001304   000617 552020 7                  STBQ    ADMIN+13,'20'O

     1526    23930    3                ADMIN.TERMID_HI.TERM.CHANNEL.BYT(0) = ENABLE_KEYIN.LINE_HI#/256;

  23930 11 001305   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 001306   777777 376007                    ANQ     -1,DL
        11 001307   000010 772000                    QRL     8
        11 001310   000011 736000                    QLS     9
        11 001311   000617 676000 7                  ERQ     ADMIN+13
        11 001312   377000 376007                    ANQ     130560,DL
        11 001313   000617 656000 7                  ERSQ    ADMIN+13

     1527    23931    3                ADMIN.TERMID_HI.TERM.CHANNEL.BYT(1) = MOD(ENABLE_KEYIN.LINE_HI#,256);

  23931 11 001314   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 001315   777777 376007                    ANQ     -1,DL
        11 001316   000377 376007                    ANQ     255,DL
        11 001317   000617 676000 7                  ERQ     ADMIN+13
        11 001320   000377 376007                    ANQ     255,DL
        11 001321   000617 656000 7                  ERSQ    ADMIN+13

     1528    23932    3              END;

     1529    23933    2           ADMIN.ORIGIN = 'KEYIN';

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:308  
  23933 11 001322   040000 100400                    MLR     fill='040'O
        11 001323   000214 000005 10                 ADSC9   CKBR+10                  cn=0,n=5
        11 001324   000605 000010 7                  ADSC9   ADMIN+3                  cn=0,n=8

     1530    23934    2           ADMIN.SRCE_NODE = KL_NODE;

  23934 11 001325   000000 236000 xsym               LDQ     KL_NODE
        11 001326   000011 736000                    QLS     9
        11 001327   000602 552010 7                  STBQ    ADMIN,'10'O

     1531    23935    2           FEX = ENABLE_KEYIN.FEP#;

  23935 11 001330   000001 235000 xsym               LDA     JC_CSMBF+1
        11 001331   200025 755100                    STA     FEX,,AUTO

     1532    23936    2           IF FEX = 0

  23936 11 001332   001346 601000 11                 TNZ     s:23940

     1533    23937    2           THEN
     1534    23938    2                CALL KLX$CONV_NODENAME(KMSG.NAME,FEX,NODETYPE) ALTRET(FEPK_ERR);

  23938 11 001333   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 001334   200430 450500                    STP0    T$+3,,AUTO
        11 001335   200025 631500                    EPPR1   FEX,,AUTO
        11 001336   200427 451500                    STP1    T$+2,,AUTO
        11 001337   000027 236000 12                 LDQ     23
        11 001340   200426 756100                    STQ     T$+1,,AUTO
        11 001341   200426 630500                    EPPR0   T$+1,,AUTO
        11 001342   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 001343   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 001344   001371 702000 11                 TSX2    FEPK_ERR
        11 001345   001360 710000 11                 TRA     s:23941

     1535    23939    2           ELSE
     1536    23940    2                CALL KLX$CONV_NODE(KMSG.NAME,FEX,NODETYPE) ALTRET(FEPK_ERR);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:309  
  23940 11 001346   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 001347   200430 450500                    STP0    T$+3,,AUTO
        11 001350   200025 631500                    EPPR1   FEX,,AUTO
        11 001351   200427 451500                    STP1    T$+2,,AUTO
        11 001352   000027 236000 12                 LDQ     23
        11 001353   200426 756100                    STQ     T$+1,,AUTO
        11 001354   200426 630500                    EPPR0   T$+1,,AUTO
        11 001355   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 001356   000000 701000 xent               TSX1    KLX$CONV_NODE
        11 001357   001371 702000 11                 TSX2    FEPK_ERR

     1537    23941    2           CALL KLX$WRHLPNODE (ADMIN,SIZEC(ADMIN),FEX)

  23941 11 001360   200025 630500                    EPPR0   FEX,,AUTO
        11 001361   200430 450500                    STP0    T$+3,,AUTO
        11 001362   000032 237000 12                 LDAQ    26
        11 001363   200426 757100                    STAQ    T$+1,,AUTO
        11 001364   200426 630500                    EPPR0   T$+1,,AUTO
        11 001365   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 001366   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 001367   001371 702000 11                 TSX2    FEPK_ERR
        11 001370   001420 710000 11                 TRA     s:23954

     1538    23942    3           WHENALTRETURN DO;

  23940 11 001371                       FEPK_ERR     null
     1539    23943    3   FEPK_ERR:    ;
     1540    23944    3                KBERR = CKBR;

  23944 11 001371   000100 100400                    MLR     fill='000'O
        11 001372   000202 000047 10                 ADSC9   CKBR                     cn=0,n=39
        11 001373   200402 000047                    ADSC9   KBERR,,AUTO              cn=0,n=39

     1541    23945    3                KBERR.MSG# = NNFND_MSG#;

  23945 11 001374   000271 220003                    LDX0    185,DU
        11 001375   200402 440100                    SXL0    KBERR,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:310  

     1542    23946    3                KBERR.FEX = FEX;

  23946 11 001376   200025 236100                    LDQ     FEX,,AUTO
        11 001377   000022 736000                    QLS     18
        11 001400   200410 552120                    STBQ    KBERR+6,'20'O,AUTO

     1543    23947    3                KBERR.NAME = KMSG.NAME;

  23947 11 001401   040100 100400                    MLR     fill='040'O
        11 001402   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
        11 001403   200411 600010                    ADSC9   KBERR+7,,AUTO            cn=3,n=8

     1544    23948    3                KBERR.CADDR = KMSG.CADDR;

  23948 11 001404   000000 721000 xsym               LXL1    JC_CSMBF
        11 001405   200402 741100                    STX1    KBERR,,AUTO

     1545    23949    3                WKBER.BUF_ = VECTOR(KBERR);

  23949 11 001406   000031 235000 12                 LDA     25
        11 001407   200426 452500                    STP2    T$+1,,AUTO
        11 001410   200426 236100                    LDQ     T$+1,,AUTO
        11 001411   000402 036003                    ADLQ    258,DU
        11 001412   000426 757000 7                  STAQ    WKBER+4

     1546    23950    3                CALL M$WRITE (WKBER)

  23950 11 001413   000422 630400 7                  EPPR0   WKBER
        11 001414   440001 713400                    CLIMB   alt,write
        11 001415   401400 401760                    pmme    nvectors=4
        11 001416   001420 702000 11                 TSX2    s:23954
        11 001417   001420 710000 11                 TRA     s:23954

     1547    23951    4                WHENALTRETURN DO;

     1548    23952    4                   END;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:311  

     1549    23953
     1550    23954    3              END;

  23954 11 001420   001537 710000 11                 TRA     BHSON1

     1551    23955
     1552    23956    2        CASE (KEY_ENABLE#);

     1553    23957    2           ADMIN.FNC = %KHA_FNC_ENABLE;

  23957 11 001421   000001 220003                    LDX0    1,DU
        11 001422   000612 440000 7                  SXL0    ADMIN+8

     1554    23958    2           GOTO FEP_KEYIN;

  23958 11 001423   001257 710000 11                 TRA     FEP_KEYIN

     1555    23959
     1556    23960    2        CASE (KEY_KILL#);

     1557    23961    2           ADMIN.FNC = %KHA_FNC_KILL;

  23961 11 001424   000003 220003                    LDX0    3,DU
        11 001425   000612 440000 7                  SXL0    ADMIN+8

     1558    23962    2           GOTO FEP_KEYIN;

  23962 11 001426   001257 710000 11                 TRA     FEP_KEYIN

     1559    23963
     1560    23964
     1561    23965    2        CASE (KEY_DISCC#);

     1562    23966    2           ADMIN.FNC = %KHA_FNC_DISCONNECT_RQS;

  23966 11 001427   000015 220003                    LDX0    13,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:312  
        11 001430   000612 440000 7                  SXL0    ADMIN+8

     1563    23967    2           GOTO FEP_KEYIN;

  23967 11 001431   001257 710000 11                 TRA     FEP_KEYIN

     1564    23968
     1565    23969
     1566    23970    2        CASE (KEY_DISCT#);

     1567    23971    2           KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.KEY);

  23971 11 001432   011000 236003                    LDQ     4608,DU
        11 001433   000000 552040 xsym               STBQ    KL_NETWORK_TERMKEY,'40'O

     1568    23972    2           KL_NETWORK_TERMKEY.KEY.TERMNAME = ENABLE_KEYIN.NAME;

  23972 11 001434   040000 100400                    MLR     fill='040'O
        11 001435   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
        11 001436   000000 400010 xsym               ADSC9   KL_NETWORK_TERMKEY       cn=2,n=8

     1569    23973    2           KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);

  23973 11 001437   000034 237000 12                 LDAQ    28
        11 001440   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

     1570    23974    2           CALL M$READ (KL_RD_NETWORK)

  23974 11 001441   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 001442   440000 713400                    CLIMB   alt,read
        11 001443   401400 401760                    pmme    nvectors=4
        11 001444   001446 702000 11                 TSX2    s:23976
        11 001445   001500 710000 11                 TRA     s:23989

     1571    23975    3           WHENALTRETURN DO;

     1572    23976    3                FEPMES.MSG# = NTRM_MSG#;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:313  

  23976 11 001446   000050 220003                    LDX0    40,DU
        11 001447   200350 440100                    SXL0    FEPMES,,AUTO

     1573    23977    3                FEPMES.NPARAMS = 2;

  23977 11 001450   002000 236007                    LDQ     1024,DL
        11 001451   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     1574    23978    3                FEPMES.CADDR = DVCKYN.CADDR;

  23978 11 001452   000000 721000 xsym               LXL1    JC_CSMBF
        11 001453   200350 741100                    STX1    FEPMES,,AUTO

     1575    23979    3                FEPMES.FCNT = 8;

  23979 11 001454   010000 236003                    LDQ     4096,DU
        11 001455   200355 552140                    STBQ    FEPMES+5,'40'O,AUTO

     1576    23980    3                FEPMES.FCN = OC_WR;

  23980 11 001456   000003 236007                    LDQ     3,DL
        11 001457   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

     1577    23981    3                FEPMES.FNCNT = 1;

  23981 11 001460   000001 236003                    LDQ     1,DU
        11 001461   200355 552120                    STBQ    FEPMES+5,'20'O,AUTO

     1578    23982    3                ADDR(FEPMES.MSG)->B$TERMNAME = ENABLE_KEYIN.NAME;

  23982 11 001462   040100 100400                    MLR     fill='040'O
        11 001463   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
        11 001464   200355 400010                    ADSC9   FEPMES+5,,AUTO           cn=2,n=8

     1579    23983    3                WKBER.BUF_ = VECTOR(FEPMES);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:314  
  23983 11 001465   000021 235000 12                 LDA     17
        11 001466   200426 452500                    STP2    T$+1,,AUTO
        11 001467   200426 236100                    LDQ     T$+1,,AUTO
        11 001470   000350 036003                    ADLQ    232,DU
        11 001471   000426 757000 7                  STAQ    WKBER+4

     1580    23984    3                CALL M$WRITE (WKBER)

  23984 11 001472   000422 630400 7                  EPPR0   WKBER
        11 001473   440001 713400                    CLIMB   alt,write
        11 001474   401400 401760                    pmme    nvectors=4
        11 001475   001477 702000 11                 TSX2    s:23987
        11 001476   001477 710000 11                 TRA     s:23987

     1581    23985    4                WHENALTRETURN DO;

     1582    23986    4                   END;

     1583    23987    3                RETURN;

  23987 11 001477   000000 702200 xent               TSX2  ! X66_ARET

     1584    23988    3              END;
     1585    23989    2           ENABLE_KEYIN.LINE_LOW# = KL_NETWORK_BUF.TERMINAL_ID.TERM.CHANNEL.BYT(0)*256
             23989                    +

  23989 11 001500   000010 236000 xsym               LDQ     KL_NETWORK_BUF+8
        11 001501   000011 772000                    QRL     9
        11 001502   000377 376007                    ANQ     255,DL
        11 001503   200426 756100                    STQ     T$+1,,AUTO
        11 001504   000010 236000 xsym               LDQ     KL_NETWORK_BUF+8
        11 001505   000012 772000                    QRL     10
        11 001506   177400 376007                    ANQ     65280,DL
        11 001507   200426 036100                    ADLQ    T$+1,,AUTO
        11 001510   000000 620006                    EAX0    0,QL
        11 001511   000004 740000 xsym               STX0    JC_CSMBF+4

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:315  
     1586    23990    2                KL_NETWORK_BUF.TERMINAL_ID.TERM.CHANNEL.BYT(1);
     1587    23991    2           ENABLE_KEYIN.FEP# = KL_NETWORK_BUF.NODE;

  23991 11 001512   000005 236000 xsym               LDQ     KL_NETWORK_BUF+5
        11 001513   000011 772000                    QRL     9
        11 001514   000777 376007                    ANQ     511,DL
        11 001515   000001 756000 xsym               STQ     JC_CSMBF+1

     1588    23992    2           ENABLE_KEYIN.LINE_HI# = ENABLE_KEYIN.LINE_LOW#;

  23992 11 001516   000004 440000 xsym               SXL0    JC_CSMBF+4

     1589    23993    2           ADMIN.FNC = %KHA_FNC_DISCONNECT_RQS;

  23993 11 001517   000015 221003                    LDX1    13,DU
        11 001520   000612 441000 7                  SXL1    ADMIN+8

     1590    23994    2           GOTO FEP_KEYIN;

  23994 11 001521   001257 710000 11                 TRA     FEP_KEYIN

     1591    23995
     1592    23996
     1593    23997    2        CASE(KEY_FROG2NA);

     1594    23998    2           KMSG.KIN#=IGA_DUMPMSG*512;

  23998 11 001522   052000 220003                    LDX0    21504,DU
        11 001523   000000 740000 xsym               STX0    JC_CSMBF

     1595    23999    2           FEX=ADDR(ADDR(JC_CSMBF)->KL$DUMPMSG.FEX)->UBIN_HALF_BASE;

  23999 11 001524   000001 236000 xsym               LDQ     JC_CSMBF+1
        11 001525   777777 376007                    ANQ     -1,DL
        11 001526   200025 756100                    STQ     FEX,,AUTO

     1596    24000    2           CALL KLX$WRHLPNODE(KMSG,JC_MARS,FEX);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:316  

  24000 11 001527   200025 630500                    EPPR0   FEX,,AUTO
        11 001530   200430 450500                    STP0    T$+3,,AUTO
        11 001531   000036 237000 12                 LDAQ    30
        11 001532   200426 757100                    STAQ    T$+1,,AUTO
        11 001533   200426 630500                    EPPR0   T$+1,,AUTO
        11 001534   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 001535   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 001536   000000 011000                    NOP     0

  23999 11 001537                       BHSON1       null
     1597    24001
     1598    24002    2   BHSON1: ;
     1599    24003    2        END;                               /* DO CASE */

  23999 11 001537                       RTN          null
     1600    24004    1   RTN: ;
     1601    24005    1        RETURN;

  24005 11 001537   000000 702200 xent               TSX2  ! X66_ARET

     1602    24006        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:317  
     1603    24007    1   KLI$AMSG: ENTRY;

  24007 11 001540   000000 700200 xent  KLI$AMSG     TSX0  ! X66_AUTO_0
        11 001541   000440 000000                    ZERO    288,0

     1604    24008        /**/
     1605    24009    1        IF KL_STATION = 'BABOON'

  24009 11 001542   040000 106400                    CMPC    fill='040'O
        11 001543   000000 000010 xsym               ADSC9   KL_STATION               cn=0,n=8
        11 001544   000216 000006 10                 ADSC9   CKBR+12                  cn=0,n=6
        11 001545   001551 601000 11                 TNZ     s:24013

     1606    24010    1        THEN
     1607    24011    1             FEX = KL_NODE;

  24011 11 001546   000000 235000 xsym               LDA     KL_NODE
        11 001547   200025 755100                    STA     FEX,,AUTO
        11 001550   001561 710000 11                 TRA     s:24016

     1608    24012    1        ELSE
     1609    24013    1             IF SUBSTR(KL_STATION,0,4) = 'FEPA'

  24013 11 001551   000000 236000 xsym               LDQ     KL_STATION
        11 001552   000220 116000 10                 CMPQ    CKBR+14
        11 001553   001561 601000 11                 TNZ     s:24016

     1610    24014    1             THEN
     1611    24015    1                  CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4));

  24015 11 001554   000100 305400                    DTB
        11 001555   000001 030004 xsym               NDSC9   KL_STATION+1             cn=0,s=nosgn,sf=0,n=4
        11 001556   200426 000010                    NDSC9   T$+1,,AUTO               cn=0,s=lsgnf,sf=0,n=8
        11 001557   200427 235100                    LDA     T$+2,,AUTO
        11 001560   200025 755100                    STA     FEX,,AUTO

     1612    24016    1        RDBF$=ADDR(KL_RDBF);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:318  

  24016 11 001561   000000 236000 12                 LDQ     0
        11 001562   200003 756100                    STQ     RDBF$,,AUTO

     1613    24017    1        KBERR=CKBR;

  24017 11 001563   000100 100400                    MLR     fill='000'O
        11 001564   000202 000047 10                 ADSC9   CKBR                     cn=0,n=39
        11 001565   200402 000047                    ADSC9   KBERR,,AUTO              cn=0,n=39

     1614    24018    2        DO CASE(KL_RDBF.CODE);

  24018 11 001566   000000 236000 xsym               LDQ     KL_RDBF
        11 001567   000033 772000                    QRL     27
        11 001570   000015 136007                    SBLQ    13,DL
        11 001571   000117 116007                    CMPQ    79,DL
        11 001572   001574 602006 11                 TNC     s:24018+6,QL
        11 001573   010045 710000 11                 TRA     s:25129
        11 001574   001713 710000 11                 TRA     s:24022
        11 001575   001730 710000 11                 TRA     s:24031
        11 001576   010045 710000 11                 TRA     s:25129
        11 001577   010045 710000 11                 TRA     s:25129
        11 001600   007460 710000 11                 TRA     s:25036
        11 001601   010045 710000 11                 TRA     s:25129
        11 001602   010045 710000 11                 TRA     s:25129
        11 001603   010045 710000 11                 TRA     s:25129
        11 001604   006744 710000 11                 TRA     s:24919
        11 001605   001724 710000 11                 TRA     s:24028
        11 001606   010045 710000 11                 TRA     s:25129
        11 001607   010045 710000 11                 TRA     s:25129
        11 001610   010045 710000 11                 TRA     s:25129
        11 001611   010045 710000 11                 TRA     s:25129
        11 001612   002350 710000 11                 TRA     s:24121
        11 001613   002725 710000 11                 TRA     s:24184
        11 001614   010045 710000 11                 TRA     s:25129
        11 001615   010045 710000 11                 TRA     s:25129
        11 001616   010045 710000 11                 TRA     s:25129
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:319  
        11 001617   010045 710000 11                 TRA     s:25129
        11 001620   005337 710000 11                 TRA     s:24616
        11 001621   004747 710000 11                 TRA     s:24526
        11 001622   005723 710000 11                 TRA     s:24705
        11 001623   007161 710000 11                 TRA     s:24964
        11 001624   010045 710000 11                 TRA     s:25129
        11 001625   007313 710000 11                 TRA     s:24998
        11 001626   004000 710000 11                 TRA     s:24362
        11 001627   007434 710000 11                 TRA     s:25030
        11 001630   007446 710000 11                 TRA     s:25033
        11 001631   007545 710000 11                 TRA     s:25050
        11 001632   010045 710000 11                 TRA     s:25129
        11 001633   010045 710000 11                 TRA     s:25129
        11 001634   004504 710000 11                 TRA     s:24465
        11 001635   010045 710000 11                 TRA     s:25129
        11 001636   010045 710000 11                 TRA     s:25129
        11 001637   010045 710000 11                 TRA     s:25129
        11 001640   010045 710000 11                 TRA     s:25129
        11 001641   010045 710000 11                 TRA     s:25129
        11 001642   010045 710000 11                 TRA     s:25129
        11 001643   010045 710000 11                 TRA     s:25129
        11 001644   010045 710000 11                 TRA     s:25129
        11 001645   010045 710000 11                 TRA     s:25129
        11 001646   010045 710000 11                 TRA     s:25129
        11 001647   010045 710000 11                 TRA     s:25129
        11 001650   010045 710000 11                 TRA     s:25129
        11 001651   010045 710000 11                 TRA     s:25129
        11 001652   010045 710000 11                 TRA     s:25129
        11 001653   010045 710000 11                 TRA     s:25129
        11 001654   003006 710000 11                 TRA     s:24195
        11 001655   010045 710000 11                 TRA     s:25129
        11 001656   010045 710000 11                 TRA     s:25129
        11 001657   010045 710000 11                 TRA     s:25129
        11 001660   010045 710000 11                 TRA     s:25129
        11 001661   010045 710000 11                 TRA     s:25129
        11 001662   010045 710000 11                 TRA     s:25129
        11 001663   010045 710000 11                 TRA     s:25129
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:320  
        11 001664   010045 710000 11                 TRA     s:25129
        11 001665   010045 710000 11                 TRA     s:25129
        11 001666   010045 710000 11                 TRA     s:25129
        11 001667   010045 710000 11                 TRA     s:25129
        11 001670   010045 710000 11                 TRA     s:25129
        11 001671   010045 710000 11                 TRA     s:25129
        11 001672   002663 710000 11                 TRA     s:24174
        11 001673   010045 710000 11                 TRA     s:25129
        11 001674   010045 710000 11                 TRA     s:25129
        11 001675   005452 710000 11                 TRA     s:24638
        11 001676   005577 710000 11                 TRA     s:24675
        11 001677   002764 710000 11                 TRA     s:24190
        11 001700   010045 710000 11                 TRA     s:25129
        11 001701   010045 710000 11                 TRA     s:25129
        11 001702   010045 710000 11                 TRA     s:25129
        11 001703   010045 710000 11                 TRA     s:25129
        11 001704   010045 710000 11                 TRA     s:25129
        11 001705   007601 710000 11                 TRA     s:25057
        11 001706   007601 710000 11                 TRA     s:25057
        11 001707   010045 710000 11                 TRA     s:25129
        11 001710   010045 710000 11                 TRA     s:25129
        11 001711   007656 710000 11                 TRA     s:25079
        11 001712   007656 710000 11                 TRA     s:25079

     1615    24019
     1616    24020
     1617    24021    2        CASE(IGA_STOK);

     1618    24022    2           IF KL_FETBL.KTYP(FEX)~=%KLKT_STOP# THEN RETURN;

  24022 11 001713   200025 720100                    LXL0    FEX,,AUTO
        11 001714   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 001715   007000 376003                    ANQ     3584,DU
        11 001716   003000 116003                    CMPQ    1536,DU
        11 001717   001721 600000 11                 TZE     s:24023

  24022 11 001720   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:321  

     1619    24023    2           CALL STFEPNM;

  24023 11 001721   011267 701000 11                 TSX1    STFEPNM
        11 001722   000000 011000                    NOP     0
        11 001723   010045 710000 11                 TRA     s:25129

     1620    24024
     1621    24025        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:322  
     1622    24026    2        CASE (IGA_UPDATE);

     1623    24027
     1624    24028    2           CALL KLI$UPDATE;

  24028 11 001724   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 001725   000000 701000 xent               TSX1    KLI$UPDATE
        11 001726   000000 011000                    NOP     0
        11 001727   010045 710000 11                 TRA     s:25129

     1625    24029        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:323  
     1626    24030    2        CASE(IGA_KMSG);

     1627    24031    2           KL_NETWORK_BUF.DEVNM = ' ';

  24031 11 001730   040000 100400                    MLR     fill='040'O
        11 001731   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 001732   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8

     1628    24032
     1629    24033    3           DO CASE(KL$KEYMES.CNSFNC);

  24033 11 001733   000000 470400 xsym               LDP0    KL_RDBF$
        11 001734   000001 720100                    LXL0    1,,PR0
        11 001735   000777 360003                    ANX0    511,DU
        11 001736   000003 100003                    CMPX0   3,DU
        11 001737   001741 602010 11                 TNC     s:24033+6,X0
        11 001740   002112 710000 11                 TRA     s:24083
        11 001741   002112 710000 11                 TRA     s:24083
        11 001742   002067 710000 11                 TRA     s:24072
        11 001743   001744 710000 11                 TRA     s:24039

     1630    24034
     1631    24035    3           CASE(OC_WR);

     1632    24036    3   /* DO NOTHING */;
     1633    24037
     1634    24038    3           CASE(OC_WRTM);

     1635    24039    3              CALL FIND_ERRCTX(KL$KEYMES.TERMID)

  24039 11 001744   000000 236000 xsym               LDQ     KL_RDBF$
        11 001745   000002 036003                    ADLQ    2,DU
        11 001746   200415 756100                    STQ     KBERR+11,,AUTO
        11 001747   011613 701000 11                 TSX1    FIND_ERRCTX
        11 001750   002005 702000 11                 TSX2    s:24052

     1636    24040    4              WHENRETURN DO;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:324  

     1637    24041    4                   FEPMES.NPARAMS = 0;

  24041 11 001751   000000 236003                    LDQ     0,DU
        11 001752   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     1638    24042    4                   FEPMES.FCN = OC_STTM;

  24042 11 001753   000001 236007                    LDQ     1,DL
        11 001754   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

     1639    24043    4                   FEPMES.MSGID = DVCERRCTX.MSGID;

  24043 11 001755   200021 470500                    LDP0    CTX$,,AUTO
        11 001756   000001 720100                    LXL0    1,,PR0
        11 001757   200351 740100                    STX0    FEPMES+1,,AUTO

     1640    24044    4                   WKBER.BUF_ = VECTOR(FEPMES);

  24044 11 001760   000021 235000 12                 LDA     17
        11 001761   200426 452500                    STP2    T$+1,,AUTO
        11 001762   200426 236100                    LDQ     T$+1,,AUTO
        11 001763   000350 036003                    ADLQ    232,DU
        11 001764   000426 757000 7                  STAQ    WKBER+4

     1641    24045    4                   CALL M$WRITE(WKBER)

  24045 11 001765   000422 630400 7                  EPPR0   WKBER
        11 001766   440001 713400                    CLIMB   alt,write
        11 001767   401400 401760                    pmme    nvectors=4
        11 001770   001772 702000 11                 TSX2    s:24048
        11 001771   001772 710000 11                 TRA     s:24048

     1642    24046    5                   WHENALTRETURN DO;

     1643    24047    5                      END;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:325  
     1644    24048    4                   PREV$->DVCERRCTX.LNK$ = DVCERRCTX.LNK$;

  24048 11 001772   200021 470500                    LDP0    CTX$,,AUTO
        11 001773   000000 236100                    LDQ     0,,PR0
        11 001774   200022 471500                    LDP1    PREV$,,AUTO
        11 001775   100000 756100                    STQ     0,,PR1

     1645    24049    4                   CALL KLB$REL(CTX$);

  24049 11 001776   200021 630500                    EPPR0   CTX$,,AUTO
        11 001777   200426 450500                    STP0    T$+1,,AUTO
        11 002000   200426 630500                    EPPR0   T$+1,,AUTO
        11 002001   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 002002   000000 701000 xent               TSX1    KLB$REL
        11 002003   000000 011000                    NOP     0

     1646    24050    4                 END;

  24050 11 002004   002012 710000 11                 TRA     s:24056

     1647    24051    4              WHENALTRETURN DO;

     1648    24052    4                   IF KL_NETWORK_BUF.DEVNM = ' '

  24052 11 002005   040000 106400                    CMPC    fill='040'O
        11 002006   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8
        11 002007   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 002010   002012 601000 11                 TNZ     s:24056

     1649    24053    4                   THEN
     1650    24054    4                        RETURN;

  24054 11 002011   000000 702200 xent               TSX2  ! X66_ARET

     1651    24055    4                 END;
     1652    24056    4              CALL KLB$GET(CTX$,SIZEC(DVCERRCTX)) WHENALTRETURN DO;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:326  
  24056 11 002012   000041 236000 12                 LDQ     33
        11 002013   200427 756100                    STQ     T$+2,,AUTO
        11 002014   200021 630500                    EPPR0   CTX$,,AUTO
        11 002015   200426 450500                    STP0    T$+1,,AUTO
        11 002016   200426 630500                    EPPR0   T$+1,,AUTO
        11 002017   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 002020   000000 701000 xent               TSX1    KLB$GET
        11 002021   002023 702000 11                 TSX2    s:24059
        11 002022   002023 710000 11                 TRA     s:24059

     1653    24057                             /*N* We're screwed if we get here */
     1654    24058    4                 END;                      /* WHENALTRETURN */

     1655    24059    3              DVCERRCTX.TERMID = KL$KEYMES.TERMID;

  24059 11 002023   000000 470400 xsym               LDP0    KL_RDBF$
        11 002024   200021 471500                    LDP1    CTX$,,AUTO
        11 002025   000100 100500                    MLR     fill='000'O
        11 002026   000002 000020                    ADSC9   2,,PR0                   cn=0,n=16
        11 002027   100002 000020                    ADSC9   2,,PR1                   cn=0,n=16

     1656    24060                        /*N* SLEAZY WAY TO GET A MSGID */
     1657    24061    3              MSGID = MSGID + 1;

  24061 11 002030   000023 235000 7                  LDA     MSGID
        11 002031   000001 035007                    ADLA    1,DL
        11 002032   000023 755000 7                  STA     MSGID

     1658    24062    3              DVCERRCTX.MSGID = MSGID;

  24062 11 002033   000000 620005                    EAX0    0,AL
        11 002034   200021 471500                    LDP1    CTX$,,AUTO
        11 002035   100001 440100                    SXL0    1,,PR1

     1659    24063    3              FEPMES.MSGID = MSGID;

  24063 11 002036   000023 720000 7                  LXL0    MSGID
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:327  
        11 002037   200351 740100                    STX0    FEPMES+1,,AUTO

     1660    24064    3              DVCERRCTX.MSG# = DVCKYN.KIN#;

  24064 11 002040   000000 221000 xsym               LDX1    JC_CSMBF
        11 002041   200021 471500                    LDP1    CTX$,,AUTO
        11 002042   100001 741100                    STX1    1,,PR1

     1661    24065    3              DVCERRCTX.FEX = FEX;

  24065 11 002043   200021 471500                    LDP1    CTX$,,AUTO
        11 002044   200025 236100                    LDQ     FEX,,AUTO
        11 002045   000033 736000                    QLS     27
        11 002046   100006 552140                    STBQ    6,'40'O,PR1

     1662    24066    3              DVCERRCTX.KEYIN_REQ = KL$KEYMES.KEYIN_REQ;

  24066 11 002047   200021 471500                    LDP1    CTX$,,AUTO
        11 002050   000001 236100                    LDQ     1,,PR0
        11 002051   000014 736000                    QLS     12
        11 002052   100010 676100                    ERQ     8,,PR1
        11 002053   000400 376003                    ANQ     256,DU
        11 002054   100010 656100                    ERSQ    8,,PR1

     1663    24067    3              DVCERRCTX.DEVNM = KL_NETWORK_BUF.DEVNM;

  24067 11 002055   200021 471500                    LDP1    CTX$,,AUTO
        11 002056   040100 100400                    MLR     fill='040'O
        11 002057   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8
        11 002060   100006 200010                    ADSC9   6,,PR1                   cn=1,n=8

     1664    24068    3              DVCERRCTX.LNK$ = CTXHD$;

  24068 11 002061   000022 236000 7                  LDQ     CTXHD$
        11 002062   200021 471500                    LDP1    CTX$,,AUTO
        11 002063   100000 756100                    STQ     0,,PR1

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:328  
     1665    24069    3              CTXHD$ = CTX$;

  24069 11 002064   200021 236100                    LDQ     CTX$,,AUTO
        11 002065   000022 756000 7                  STQ     CTXHD$
        11 002066   002112 710000 11                 TRA     s:24083

     1666    24070
     1667    24071    3           CASE(OC_STTM);

     1668    24072    3              CALL FIND_ERRCTX(KL$KEYMES.TERMID)

  24072 11 002067   000000 236000 xsym               LDQ     KL_RDBF$
        11 002070   000002 036003                    ADLQ    2,DU
        11 002071   200415 756100                    STQ     KBERR+11,,AUTO
        11 002072   011613 701000 11                 TSX1    FIND_ERRCTX
        11 002073   002111 702000 11                 TSX2    s:24079

     1669    24073    4              WHENRETURN DO;

     1670    24074    4                   FEPMES.MSGID = DVCERRCTX.MSGID;

  24074 11 002074   200021 470500                    LDP0    CTX$,,AUTO
        11 002075   000001 720100                    LXL0    1,,PR0
        11 002076   200351 740100                    STX0    FEPMES+1,,AUTO

     1671    24075    4                   PREV$->DVCERRCTX.LNK$ = DVCERRCTX.LNK$;

  24075 11 002077   000000 236100                    LDQ     0,,PR0
        11 002100   200022 471500                    LDP1    PREV$,,AUTO
        11 002101   100000 756100                    STQ     0,,PR1

     1672    24076    4                   CALL KLB$REL(CTX$);

  24076 11 002102   200021 630500                    EPPR0   CTX$,,AUTO
        11 002103   200426 450500                    STP0    T$+1,,AUTO
        11 002104   200426 630500                    EPPR0   T$+1,,AUTO
        11 002105   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:329  
        11 002106   000000 701000 xent               TSX1    KLB$REL
        11 002107   000000 011000                    NOP     0

     1673    24077    4                 END;

  24077 11 002110   002112 710000 11                 TRA     s:24083

     1674    24078    4              WHENALTRETURN DO;

     1675    24079    4                   RETURN;

  24079 11 002111   000000 702200 xent               TSX2  ! X66_ARET

     1676    24080    4                 END;
     1677    24081    3           END;                            /* DO CASE KEYMES.CNSFNC */

     1678    24082        /* Now forward to KEYIN */
     1679    24083    2           CALL KLX$8TO9(KL$KEYMES.MSG#,FEPMES.MSG#,SIZEC(FEPMES.MSG#));

  24083 11 002112   000042 236000 12                 LDQ     34
        11 002113   200430 756100                    STQ     T$+3,,AUTO
        11 002114   200431 452500                    STP2    T$+4,,AUTO
        11 002115   200431 236100                    LDQ     T$+4,,AUTO
        11 002116   000043 036000 12                 ADLQ    35
        11 002117   200427 756100                    STQ     T$+2,,AUTO
        11 002120   000000 236000 xsym               LDQ     KL_RDBF$
        11 002121   400000 036007                    ADLQ    -131072,DL
        11 002122   200426 756100                    STQ     T$+1,,AUTO
        11 002123   200426 630500                    EPPR0   T$+1,,AUTO
        11 002124   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002125   000000 701000 xent               TSX1    KLX$8TO9
        11 002126   000000 011000                    NOP     0

     1680    24084    2           FEPMES.DEVNM = KL_NETWORK_BUF.DEVNM;

  24084 11 002127   040100 100400                    MLR     fill='040'O
        11 002130   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:330  
        11 002131   200353 000010                    ADSC9   FEPMES+3,,AUTO           cn=0,n=8

     1681    24085    2           FEPMES.NPARAMS = KL$KEYMES.NPARMS + 2;

  24085 11 002132   000000 470400 xsym               LDP0    KL_RDBF$
        11 002133   000006 236100                    LDQ     6,,PR0
        11 002134   000033 772000                    QRL     27
        11 002135   000002 036007                    ADLQ    2,DL
        11 002136   000011 736000                    QLS     9
        11 002137   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     1682    24086    2           ADDR(FEPMES.CADDR)->CADDR.TOP = KL$KEYMES.CADDR.TOP;

  24086 11 002140   000001 236100                    LDQ     1,,PR0
        11 002141   000001 736000                    QLS     1
        11 002142   200350 676100                    ERQ     FEPMES,,AUTO
        11 002143   776000 376003                    ANQ     -1024,DU
        11 002144   200350 656100                    ERSQ    FEPMES,,AUTO

     1683    24087    2           ADDR(FEPMES.CADDR)->CADDR.MID = KL$KEYMES.CADDR.MID;

  24087 11 002145   000001 236100                    LDQ     1,,PR0
        11 002146   000002 736000                    QLS     2
        11 002147   200350 676100                    ERQ     FEPMES,,AUTO
        11 002150   001774 376003                    ANQ     1020,DU
        11 002151   200350 656100                    ERSQ    FEPMES,,AUTO

     1684    24088    2           ADDR(FEPMES.CADDR)->CADDR.BOT = KL$KEYMES.CADDR.BOT;

  24088 11 002152   000001 236100                    LDQ     1,,PR0
        11 002153   300000 376007                    ANQ     98304,DL
        11 002154   000003 736000                    QLS     3
        11 002155   200350 676100                    ERQ     FEPMES,,AUTO
        11 002156   000044 376000 12                 ANQ     36
        11 002157   200350 656100                    ERSQ    FEPMES,,AUTO

     1685    24089    2           FEPMES.FCN = KL$KEYMES.CNSFNC;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:331  

  24089 11 002160   000001 236100                    LDQ     1,,PR0
        11 002161   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

     1686    24090    2           FEPMES.FCNT=1;

  24090 11 002162   001000 236003                    LDQ     512,DU
        11 002163   200355 552140                    STBQ    FEPMES+5,'40'O,AUTO

     1687    24091    2           FEPMES.FNCNT=8;

  24091 11 002164   000010 236003                    LDQ     8,DU
        11 002165   200355 552120                    STBQ    FEPMES+5,'20'O,AUTO

     1688    24092    2           PARM$ = ADDR(FEPMES.MSG);

  24092 11 002166   200426 452500                    STP2    T$+1,,AUTO
        11 002167   200426 236100                    LDQ     T$+1,,AUTO
        11 002170   000026 036000 12                 ADLQ    22
        11 002171   200034 756100                    STQ     PARM$,,AUTO

     1689    24093    3           DO I = 0 TO KL$KEYMES.NPARMS-1;

  24093 11 002172   200010 450100                    STZ     I,,AUTO
        11 002173   002211 710000 11                 TRA     s:24096+3

     1690    24094    3                CNT = KL$KEYMES.PARMS.SIZE(I);

  24094 11 002174   200010 236100                    LDQ     I,,AUTO
        11 002175   000022 402007                    MPY     18,DL
        11 002176   000000 470400 xsym               LDP0    KL_RDBF$
        11 002177   200034 471500                    LDP1    PARM$,,AUTO
        11 002200   003100 060506                    CSL     bolr='003'O
        11 002201   000006 400011                    BDSC    6,Q,PR0                  by=2,bit=0,n=9
        11 002202   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9

     1691    24095    3                PARM$ = PINCRC(PARM$,SIZEC(CNT));
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:332  

  24095 11 002203   200034 236100                    LDQ     PARM$,,AUTO
        11 002204   200000 036007                    ADLQ    65536,DL
        11 002205   200034 756100                    STQ     PARM$,,AUTO

     1692    24096    3              END;

  24096 11 002206   200010 235100                    LDA     I,,AUTO
        11 002207   000001 035007                    ADLA    1,DL
        11 002210   200010 755100                    STA     I,,AUTO
        11 002211   000000 470400 xsym               LDP0    KL_RDBF$
        11 002212   000006 236100                    LDQ     6,,PR0
        11 002213   000033 772000                    QRL     27
        11 002214   200010 116100                    CMPQ    I,,AUTO
        11 002215   002217 600000 11                 TZE     s:24097
        11 002216   002174 603000 11                 TRC     s:24094

     1693    24097    2           MESS$ = PINCRC(ADDR(KL$KEYMES.PARMS),LENGTHC(KL$KEYMES.PARMS(0))*KL$KEYMES.
             24097                    NPARMS);

  24097 11 002217   000021 736000                    QLS     17
        11 002220   000045 036000 12                 ADLQ    37
        11 002221   000000 036000 xsym               ADLQ    KL_RDBF$
        11 002222   200033 756100                    STQ     MESS$,,AUTO

     1694    24098    2           CNT = FEX;

  24098 11 002223   200034 471500                    LDP1    PARM$,,AUTO
        11 002224   003100 061500                    CSR     bolr='003'O
        11 002225   200025 000044                    BDSC    FEX,,AUTO                by=0,bit=0,n=36
        11 002226   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9

     1695    24099    2           PARM$ = PINCRC(PARM$,LENGTHC(CNT));

  24099 11 002227   200034 236100                    LDQ     PARM$,,AUTO
        11 002230   200000 036007                    ADLQ    65536,DL
        11 002231   200034 756100                    STQ     PARM$,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:333  

     1696    24100    2           SIZE = 8;

  24100 11 002232   000010 235007                    LDA     8,DL
        11 002233   200024 755100                    STA     SIZE,,AUTO

     1697    24101    2           CALL KLX$CONV_NODE(HOSTNAME,FEX,NODETYPE);

  24101 11 002234   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 002235   200430 450500                    STP0    T$+3,,AUTO
        11 002236   200025 631500                    EPPR1   FEX,,AUTO
        11 002237   200427 451500                    STP1    T$+2,,AUTO
        11 002240   200051 633500                    EPPR3   HOSTNAME,,AUTO
        11 002241   200426 453500                    STP3    T$+1,,AUTO
        11 002242   200426 630500                    EPPR0   T$+1,,AUTO
        11 002243   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002244   000000 701000 xent               TSX1    KLX$CONV_NODE
        11 002245   000000 011000                    NOP     0

     1698    24102    2           PARM$->PARM = HOSTNAME;

  24102 11 002246   200034 470500                    LDP0    PARM$,,AUTO
        11 002247   200024 720100                    LXL0    SIZE,,AUTO
        11 002250   040140 100500                    MLR     fill='040'O
        11 002251   200051 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8
        11 002252   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1699    24103    2           PARM$ = PINCRC(PARM$,SIZEC(HOSTNAME));

  24103 11 002253   200034 236100                    LDQ     PARM$,,AUTO
        11 002254   000002 036003                    ADLQ    2,DU
        11 002255   200034 756100                    STQ     PARM$,,AUTO

     1700    24104
     1701    24105    3           DO I = 0 TO KL$KEYMES.NPARMS-1;

  24105 11 002256   200010 450100                    STZ     I,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:334  
        11 002257   002327 710000 11                 TRA     s:24114+3

     1702    24106    3                SIZE = KL$KEYMES.PARMS.SIZE(I);

  24106 11 002260   200010 235100                    LDA     I,,AUTO
        11 002261   000001 735000                    ALS     1
        11 002262   000000 470400 xsym               LDP0    KL_RDBF$
        11 002263   000100 101505                    MRL     fill='000'O
        11 002264   000006 400001                    ADSC9   6,A,PR0                  cn=2,n=1
        11 002265   200024 000004                    ADSC9   SIZE,,AUTO               cn=0,n=4

     1703    24107    3                IF KL$KEYMES.PARMS.TYPE(I) = %KL_TYPE_NORM

  24107 11 002266   000100 101505                    MRL     fill='000'O
        11 002267   000006 200001                    ADSC9   6,A,PR0                  cn=1,n=1
        11 002270   200426 000004                    ADSC9   T$+1,,AUTO               cn=0,n=4
        11 002271   200426 236100                    LDQ     T$+1,,AUTO
        11 002272   000000 116003                    CMPQ    0,DU
        11 002273   002303 601000 11                 TNZ     s:24111

     1704    24108    3                THEN
     1705    24109    3                     PARM$->PARM = MESS$->PARM;

  24109 11 002274   200033 471500                    LDP1    MESS$,,AUTO
        11 002275   200024 720100                    LXL0    SIZE,,AUTO
        11 002276   200034 473500                    LDP3    PARM$,,AUTO
        11 002277   040140 100540                    MLR     fill='040'O
        11 002300   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        11 002301   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
        11 002302   002314 710000 11                 TRA     s:24112

     1706    24110    3                ELSE
     1707    24111    3                     CALL KLX$8TO9(MESS$->PARM,PARM$->PARM,SIZE);

  24111 11 002303   200024 631500                    EPPR1   SIZE,,AUTO
        11 002304   200430 451500                    STP1    T$+3,,AUTO
        11 002305   200034 236100                    LDQ     PARM$,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:335  
        11 002306   200033 235100                    LDA     MESS$,,AUTO
        11 002307   200426 757100                    STAQ    T$+1,,AUTO
        11 002310   200426 630500                    EPPR0   T$+1,,AUTO
        11 002311   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002312   000000 701000 xent               TSX1    KLX$8TO9
        11 002313   000000 011000                    NOP     0

     1708    24112    3                MESS$ = PINCRC(MESS$,SIZE);

  24112 11 002314   200024 236100                    LDQ     SIZE,,AUTO
        11 002315   000020 736000                    QLS     16
        11 002316   200033 036100                    ADLQ    MESS$,,AUTO
        11 002317   200033 756100                    STQ     MESS$,,AUTO

     1709    24113    3                PARM$ = PINCRC(PARM$,SIZE);

  24113 11 002320   200024 236100                    LDQ     SIZE,,AUTO
        11 002321   000020 736000                    QLS     16
        11 002322   200034 036100                    ADLQ    PARM$,,AUTO
        11 002323   200034 756100                    STQ     PARM$,,AUTO

     1710    24114    3              END;

  24114 11 002324   200010 235100                    LDA     I,,AUTO
        11 002325   000001 035007                    ADLA    1,DL
        11 002326   200010 755100                    STA     I,,AUTO
        11 002327   000000 470400 xsym               LDP0    KL_RDBF$
        11 002330   000006 236100                    LDQ     6,,PR0
        11 002331   000033 772000                    QRL     27
        11 002332   200010 116100                    CMPQ    I,,AUTO
        11 002333   002335 600000 11                 TZE     s:24115
        11 002334   002260 603000 11                 TRC     s:24106

     1711    24115    2           WKBER.BUF_ = VECTOR(FEPMES);

  24115 11 002335   000021 235000 12                 LDA     17
        11 002336   200426 452500                    STP2    T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:336  
        11 002337   200426 236100                    LDQ     T$+1,,AUTO
        11 002340   000350 036003                    ADLQ    232,DU
        11 002341   000426 757000 7                  STAQ    WKBER+4

     1712    24116    3           CALL M$WRITE(WKBER) WHENALTRETURN DO;

  24116 11 002342   000422 630400 7                  EPPR0   WKBER
        11 002343   440001 713400                    CLIMB   alt,write
        11 002344   401400 401760                    pmme    nvectors=4
        11 002345   002347 702000 11                 TSX2    s:24118
        11 002346   002347 710000 11                 TRA     s:24118

     1713    24117    3              END;

     1714    24118    2           RETURN;

  24118 11 002347   000000 702200 xent               TSX2  ! X66_ARET

     1715    24119        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:337  
     1716    24120    2        CASE(IGA_STRTU);

     1717    24121    2           IF KL_NODE=KL_NMNODE

  24121 11 002350   000000 236000 xsym               LDQ     KL_NODE
        11 002351   000000 116000 xsym               CMPQ    KL_NMNODE
        11 002352   002632 601000 11                 TNZ     s:24166

     1718    24122    3           THEN DO;                   /* Obtain info from :HLP if we are the NM */

     1719    24123    3                KL_HLPKEY.ACCT = KL$STRTU.ACCT;

  24123 11 002353   200003 470500                    LDP0    RDBF$,,AUTO
        11 002354   040000 100500                    MLR     fill='040'O
        11 002355   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
        11 002356   000000 200010 xsym               ADSC9   KL_HLPKEY                cn=1,n=8

     1720    24124    3                KL_HLPKEY.NAME = KL$STRTU.UNAME;

  24124 11 002357   040000 100500                    MLR     fill='040'O
        11 002360   000002 400014                    ADSC9   2,,PR0                   cn=2,n=12
        11 002361   000002 200014 xsym               ADSC9   KL_HLPKEY+2              cn=1,n=12

     1721    24125    3                CALL INDEX(SIZE,' ',KL$STRTU.UNAME);

  24125 11 002362   000000 124500                    SCM     mask='000'O
        11 002363   000002 400014                    ADSC9   2,,PR0                   cn=2,n=12
        11 002364   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 002365   200024 000100                    ARG     SIZE,,AUTO

     1722    24126    3                KL_HLPKEY.CNT = SIZEC(KL_HLPKEY.ACCT) + SIZE;

  24126 11 002366   200024 236100                    LDQ     SIZE,,AUTO
        11 002367   000010 036007                    ADLQ    8,DL
        11 002370   000033 736000                    QLS     27
        11 002371   000000 552040 xsym               STBQ    KL_HLPKEY,'40'O

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:338  
     1723    24127    3                CALL M$READ (KL_RDHLPR)

  24127 11 002372   000000 630400 xsym               EPPR0   KL_RDHLPR
        11 002373   440000 713400                    CLIMB   alt,read
        11 002374   401400 401760                    pmme    nvectors=4
        11 002375   002377 702000 11                 TSX2    s:24129
        11 002376   002407 710000 11                 TRA     s:24135

     1724    24128    4                WHENALTRETURN DO;

     1725    24129    4                     CALL SENDCWNAK (KL$STRTU.NETADR_FROM,ELGL);

  24129 11 002377   000046 236000 12                 LDQ     38
        11 002400   200416 756100                    STQ     @TERMID+1,,AUTO
        11 002401   200003 236100                    LDQ     RDBF$,,AUTO
        11 002402   400000 036007                    ADLQ    -131072,DL
        11 002403   200415 756100                    STQ     KBERR+11,,AUTO
        11 002404   011450 701000 11                 TSX1    SENDCWNAK
        11 002405   000000 011000                    NOP     0

     1726    24130    4                     RETURN;

  24130 11 002406   000000 702200 xent               TSX2  ! X66_ARET

     1727    24131    4                   END;
     1728    24132        /*E* ERROR: KLI-E$ELGL-4
     1729    24133             MESSAGE: Can't start FPRG.  No authorization record for that ACCT,NAME.
     1730    24134        */
     1731    24135    3                PARM$ = ADDR(KL_HLPR);

  24135 11 002407   000047 236000 12                 LDQ     39
        11 002410   200034 756100                    STQ     PARM$,,AUTO

     1732    24136    3                I = KL$STRTU.MODE - 1;

  24136 11 002411   200003 470500                    LDP0    RDBF$,,AUTO
        11 002412   000011 236100                    LDQ     9,,PR0
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:339  
        11 002413   000011 772000                    QRL     9
        11 002414   000777 376007                    ANQ     511,DL
        11 002415   000001 136007                    SBLQ    1,DL
        11 002416   200010 756100                    STQ     I,,AUTO

     1733    24137        /* Convert host UTS units to L6 UTS units. */
     1734    24138    3                CALL KLX$9TO8(KL$DREC.FEBLK.MTIME(I)*6/5,KL$STRTU.MRT,4);

  24138 11 002417   200034 471500                    LDP1    PARM$,,AUTO
        11 002420   100042 236106                    LDQ     34,QL,PR1
        11 002421   000006 402007                    MPY     6,DL
        11 002422   000005 506007                    DIV     5,DL
        11 002423   200426 756100                    STQ     T$+1,,AUTO
        11 002424   000050 236000 12                 LDQ     40
        11 002425   200431 756100                    STQ     T$+4,,AUTO
        11 002426   200003 236100                    LDQ     RDBF$,,AUTO
        11 002427   000012 036003                    ADLQ    10,DU
        11 002430   200430 756100                    STQ     T$+3,,AUTO
        11 002431   200426 633500                    EPPR3   T$+1,,AUTO
        11 002432   200427 453500                    STP3    T$+2,,AUTO
        11 002433   200427 630500                    EPPR0   T$+2,,AUTO
        11 002434   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002435   000000 701000 xent               TSX1    KLX$9TO8
        11 002436   000000 011000                    NOP     0

     1735    24139    3                KL$STRTU.PRIV = KL$DREC.FEBLK.PRIV(I);

  24139 11 002437   200034 470500                    LDP0    PARM$,,AUTO
        11 002440   200010 720100                    LXL0    I,,AUTO
        11 002441   000032 236110                    LDQ     26,X0,PR0
        11 002442   200003 471500                    LDP1    RDBF$,,AUTO
        11 002443   100013 756100                    STQ     11,,PR1

     1736    24140    3                KL$STRTU.PPRIV = KL$DREC.FEBLK.PPRIV(I);

  24140 11 002444   000036 236110                    LDQ     30,X0,PR0
        11 002445   100014 756100                    STQ     12,,PR1
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:340  

     1737    24141    3                KL$STRTU.FLAGS.STEPACCT = KL$DREC.FEBLK.FLAGS.STEPACCT;

  24141 11 002446   000031 236100                    LDQ     25,,PR0
        11 002447   000021 736000                    QLS     17
        11 002450   100054 676100                    ERQ     44,,PR1
        11 002451   000200 376003                    ANQ     128,DU
        11 002452   100054 656100                    ERSQ    44,,PR1

     1738    24142    3                CALL KLX$9TO8(KL$DREC.FEBLK.MMEM(I),KL$STRTU.MEM,2);

  24142 11 002453   000042 236000 12                 LDQ     34
        11 002454   200430 756100                    STQ     T$+3,,AUTO
        11 002455   200003 236100                    LDQ     RDBF$,,AUTO
        11 002456   000015 036003                    ADLQ    13,DU
        11 002457   200427 756100                    STQ     T$+2,,AUTO
        11 002460   200010 236100                    LDQ     I,,AUTO
        11 002461   000021 736000                    QLS     17
        11 002462   000046 036003                    ADLQ    38,DU
        11 002463   200034 036100                    ADLQ    PARM$,,AUTO
        11 002464   200426 756100                    STQ     T$+1,,AUTO
        11 002465   200426 630500                    EPPR0   T$+1,,AUTO
        11 002466   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002467   000000 701000 xent               TSX1    KLX$9TO8
        11 002470   000000 011000                    NOP     0

     1739    24143    3                KL$STRTU.INTS = KL$DREC.FEBLK.MINTS(I);

  24143 11 002471   200034 470500                    LDP0    PARM$,,AUTO
        11 002472   200010 235100                    LDA     I,,AUTO
        11 002473   200003 471500                    LDP1    RDBF$,,AUTO
        11 002474   000100 100505                    MLR     fill='000'O
        11 002475   000030 000001                    ADSC9   24,A,PR0                 cn=0,n=1
        11 002476   100015 400001                    ADSC9   13,,PR1                  cn=2,n=1

     1740    24144    3                KL$STRTU.MACCTFPRG = KL$DREC.FEBLK.MFPRG;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:341  
  24144 11 002477   000031 236100                    LDQ     25,,PR0
        11 002500   000033 772000                    QRL     27
        11 002501   100015 552104                    STBQ    13,'04'O,PR1

     1741    24145    3                IF ~KL$DREC.FLAGS.FEOK AND KL$DREC.FEBLK.MFPRG ~= 0

  24145 11 002502   000000 236100                    LDQ     0,,PR0
        11 002503   000022 736000                    QLS     18
        11 002504   400000 376003                    ANQ     -131072,DU
        11 002505   400000 676003                    ERQ     -131072,DU
        11 002506   002522 600000 11                 TZE     s:24153
        11 002507   000031 236100                    LDQ     25,,PR0
        11 002510   777000 316003                    CANQ    -512,DU
        11 002511   002522 600000 11                 TZE     s:24153

     1742    24146    4                THEN DO;

     1743    24147    4                     CALL SENDCWNAK(KL$STRTU.NETADR_FROM,NOFPRG);

  24147 11 002512   000051 236000 12                 LDQ     41
        11 002513   200416 756100                    STQ     @TERMID+1,,AUTO
        11 002514   200003 236100                    LDQ     RDBF$,,AUTO
        11 002515   400000 036007                    ADLQ    -131072,DL
        11 002516   200415 756100                    STQ     KBERR+11,,AUTO
        11 002517   011450 701000 11                 TSX1    SENDCWNAK
        11 002520   000000 011000                    NOP     0

     1744    24148    4                     RETURN;

  24148 11 002521   000000 702200 xent               TSX2  ! X66_ARET

     1745    24149    4                   END;
     1746    24150        /*E* ERROR: KLI-E$NFPRG-4
     1747    24151             MESSAGE: Your ACCT,UNAME is not authorized to start an FPRG.
     1748    24152        */
     1749    24153    3                CALL KLX$9TO8(KL$DREC.FEBLK.MACCTMEM,KL$STRTU.MACCTMEM,2);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:342  
  24153 11 002522   000042 236000 12                 LDQ     34
        11 002523   200430 756100                    STQ     T$+3,,AUTO
        11 002524   200003 236100                    LDQ     RDBF$,,AUTO
        11 002525   000016 036003                    ADLQ    14,DU
        11 002526   200427 756100                    STQ     T$+2,,AUTO
        11 002527   200034 236100                    LDQ     PARM$,,AUTO
        11 002530   000052 036000 12                 ADLQ    42
        11 002531   200426 756100                    STQ     T$+1,,AUTO
        11 002532   200426 630500                    EPPR0   T$+1,,AUTO
        11 002533   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002534   000000 701000 xent               TSX1    KLX$9TO8
        11 002535   000000 011000                    NOP     0

     1750    24154    3                KL$STRTU.BILL = KL$DREC.FEBLK.BILL(I);

  24154 11 002536   200010 236100                    LDQ     I,,AUTO
        11 002537   000006 402007                    MPY     6,DL
        11 002540   200034 470500                    LDP0    PARM$,,AUTO
        11 002541   200003 471500                    LDP1    RDBF$,,AUTO
        11 002542   040100 100506                    MLR     fill='040'O
        11 002543   000020 000006                    ADSC9   16,Q,PR0                 cn=0,n=6
        11 002544   100042 400006                    ADSC9   34,,PR1                  cn=2,n=6

     1751    24155    3                KL$STRTU.DB_ACCT = KL$DREC.FEBLK.DBACCN;

  24155 11 002545   040100 100500                    MLR     fill='040'O
        11 002546   000026 000010                    ADSC9   22,,PR0                  cn=0,n=8
        11 002547   100007 400010                    ADSC9   7,,PR1                   cn=2,n=8

     1752    24156    4                DO LEN = 0 TO 7;

  24156 11 002550   200007 450100                    STZ     LEN,,AUTO

     1753    24157    4                     KL$STRTU.PSEUDO_NAME(LEN) = KL$DREC.FEBLK.PSDOL.PSDO_NAME(CNT);

  24157 11 002551   200007 235100                    LDA     LEN,,AUTO
        11 002552   000001 735000                    ALS     1
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:343  
        11 002553   200034 470500                    LDP0    PARM$,,AUTO
        11 002554   003100 061500                    CSR     bolr='003'O
        11 002555   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
        11 002556   200426 000044                    BDSC    T$+1,,AUTO               by=0,bit=0,n=36
        11 002557   200426 236100                    LDQ     T$+1,,AUTO
        11 002560   000002 736000                    QLS     2
        11 002561   000002 736000                    QLS     2
        11 002562   000002 735000                    ALS     2
        11 002563   200003 471500                    LDP1    RDBF$,,AUTO
        11 002564   040105 100506                    MLR     fill='040'O
        11 002565   000070 000010                    ADSC9   56,Q,PR0                 cn=0,n=8
        11 002566   100016 400010                    ADSC9   14,A,PR1                 cn=2,n=8

     1754    24158    4                     CALL KLX$9TO8(ADDR(KL$DREC.FEBLK.PSDOL)->PSEUDO.MAX(I),KL$STRTU.
             24158                              MAX(LEN),2);

  24158 11 002567   000042 236000 12                 LDQ     34
        11 002570   200430 756100                    STQ     T$+3,,AUTO
        11 002571   200007 236100                    LDQ     LEN,,AUTO
        11 002572   000021 736000                    QLS     17
        11 002573   000053 036000 12                 ADLQ    43
        11 002574   200003 036100                    ADLQ    RDBF$,,AUTO
        11 002575   200427 756100                    STQ     T$+2,,AUTO
        11 002576   200010 236100                    LDQ     I,,AUTO
        11 002577   000021 736000                    QLS     17
        11 002600   000072 036003                    ADLQ    58,DU
        11 002601   200034 036100                    ADLQ    PARM$,,AUTO
        11 002602   200426 756100                    STQ     T$+1,,AUTO
        11 002603   200426 630500                    EPPR0   T$+1,,AUTO
        11 002604   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002605   000000 701000 xent               TSX1    KLX$9TO8
        11 002606   000000 011000                    NOP     0

     1755    24159    4                   END;

  24159 11 002607   200007 235100                    LDA     LEN,,AUTO
        11 002610   000001 035007                    ADLA    1,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:344  
        11 002611   200007 755100                    STA     LEN,,AUTO
        11 002612   000010 115007                    CMPA    8,DL
        11 002613   002551 602000 11                 TNC     s:24157

     1756    24160    3                IF KL$STRTU.MRT='0'B THEN

  24160 11 002614   200003 470500                    LDP0    RDBF$,,AUTO
        11 002615   000012 235100                    LDA     10,,PR0
        11 002616   002621 601000 11                 TNZ     s:24162

     1757    24161    3                     KL$STRTU.MRT='177777777777'O;

  24161 11 002617   000221 236000 10                 LDQ     CKBR+15
        11 002620   000012 756100                    STQ     10,,PR0

     1758    24162    3                IF KL$STRTU.MEM='0'B THEN

  24162 11 002621   000015 220100                    LDX0    13,,PR0
        11 002622   002625 601000 11                 TNZ     s:24164

     1759    24163    3                     KL$STRTU.MEM='777777'O; /* From :NLP record */

  24163 11 002623   777777 221003                    LDX1    -1,DU
        11 002624   000015 741100                    STX1    13,,PR0

     1760    24164    3                FEX=KL$STRTU.NODE;

  24164 11 002625   000000 236100                    LDQ     0,,PR0
        11 002626   000022 772000                    QRL     18
        11 002627   000777 376007                    ANQ     511,DL
        11 002630   200025 756100                    STQ     FEX,,AUTO

     1761    24165    3              END;

  24165 11 002631   002634 710000 11                 TRA     s:24167

     1762    24166    2           ELSE FEX=KL_NMNODE;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:345  

  24166 11 002632   000000 235000 xsym               LDA     KL_NMNODE
        11 002633   200025 755100                    STA     FEX,,AUTO

     1763    24167    2           LEN=SIZEC(KL$STRTU);

  24167 11 002634   000264 235007                    LDA     180,DL
        11 002635   200007 755100                    STA     LEN,,AUTO

     1764    24168    3           CALL KLX$WRHLPNODE(KL$STRTU,LEN,FEX) WHENALTRETURN DO;

  24168 11 002636   200025 630500                    EPPR0   FEX,,AUTO
        11 002637   200430 450500                    STP0    T$+3,,AUTO
        11 002640   200007 631500                    EPPR1   LEN,,AUTO
        11 002641   200427 451500                    STP1    T$+2,,AUTO
        11 002642   200003 236100                    LDQ     RDBF$,,AUTO
        11 002643   200426 756100                    STQ     T$+1,,AUTO
        11 002644   200426 630500                    EPPR0   T$+1,,AUTO
        11 002645   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002646   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 002647   002651 702000 11                 TSX2    SEND_CWNAK
        11 002650   002662 710000 11                 TRA     s:24171

  24165 11 002651                       SEND_CWNAK   null
     1765    24169    3   SEND_CWNAK:  ;
     1766    24170    3                CALL SENDCWNAK (KL$AFD.NETADR_FROM,B$TCB$->B$TCB.ALT$->B$ALT.ERR);

  24170 11 002651   000000 470400 xsym               LDP0    B$TCB$
        11 002652   000000 471500                    LDP1    0,,PR0
        11 002653   100102 633500                    EPPR3   66,,PR1
        11 002654   200416 453500                    STP3    @TERMID+1,,AUTO
        11 002655   200003 236100                    LDQ     RDBF$,,AUTO
        11 002656   400000 036007                    ADLQ    -131072,DL
        11 002657   200415 756100                    STQ     KBERR+11,,AUTO
        11 002660   011450 701000 11                 TSX1    SENDCWNAK
        11 002661   000000 011000                    NOP     0

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:346  
     1767    24171    3              END;

  24171 11 002662   010045 710000 11                 TRA     s:25129

     1768    24172        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:347  
     1769    24173    2        CASE(IGA_AFD);

     1770    24174    2           IF KL_NODE=KL_NMNODE

  24174 11 002663   000000 236000 xsym               LDQ     KL_NODE
        11 002664   000000 116000 xsym               CMPQ    KL_NMNODE
        11 002665   002674 601000 11                 TNZ     s:24176

     1771    24175    2           THEN FEX=KL$AFD.NODE;

  24175 11 002666   200003 470500                    LDP0    RDBF$,,AUTO
        11 002667   000000 236100                    LDQ     0,,PR0
        11 002670   000022 772000                    QRL     18
        11 002671   000777 376007                    ANQ     511,DL
        11 002672   200025 756100                    STQ     FEX,,AUTO
        11 002673   002676 710000 11                 TRA     s:24177

     1772    24176    2           ELSE FEX=KL_NMNODE;

  24176 11 002674   000000 235000 xsym               LDA     KL_NMNODE
        11 002675   200025 755100                    STA     FEX,,AUTO

     1773    24177    2           LEN=SIZEC(KL$AFD);

  24177 11 002676   000020 235007                    LDA     16,DL
        11 002677   200007 755100                    STA     LEN,,AUTO

     1774    24178    3           CALL KLX$WRHLPNODE(KL$AFD,LEN,FEX) WHENALTRETURN DO;

  24178 11 002700   200025 630500                    EPPR0   FEX,,AUTO
        11 002701   200430 450500                    STP0    T$+3,,AUTO
        11 002702   200007 631500                    EPPR1   LEN,,AUTO
        11 002703   200427 451500                    STP1    T$+2,,AUTO
        11 002704   200003 236100                    LDQ     RDBF$,,AUTO
        11 002705   200426 756100                    STQ     T$+1,,AUTO
        11 002706   200426 630500                    EPPR0   T$+1,,AUTO
        11 002707   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:348  
        11 002710   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 002711   002713 702000 11                 TSX2    s:24179
        11 002712   002724 710000 11                 TRA     s:24180

     1775    24179    3                CALL SENDCWNAK (KL$AFD.NETADR_FROM,B$TCB$->B$TCB.ALT$->B$ALT.ERR);

  24179 11 002713   000000 470400 xsym               LDP0    B$TCB$
        11 002714   000000 471500                    LDP1    0,,PR0
        11 002715   100102 633500                    EPPR3   66,,PR1
        11 002716   200416 453500                    STP3    @TERMID+1,,AUTO
        11 002717   200003 236100                    LDQ     RDBF$,,AUTO
        11 002720   400000 036007                    ADLQ    -131072,DL
        11 002721   200415 756100                    STQ     KBERR+11,,AUTO
        11 002722   011450 701000 11                 TSX1    SENDCWNAK
        11 002723   000000 011000                    NOP     0

     1776    24180    3              END;

  24180 11 002724   010045 710000 11                 TRA     s:25129

     1777    24181
     1778    24182
     1779    24183    2        CASE(IGA_CWNAK);

     1780    24184    2           LEN=SIZEC(KL$CWNAK);

  24184 11 002725   000014 235007                    LDA     12,DL
        11 002726   200007 755100                    STA     LEN,,AUTO

     1781    24185    2           FEX=KL$CWNAK.NETADR.NODE;

  24185 11 002727   200003 470500                    LDP0    RDBF$,,AUTO
        11 002730   000000 236100                    LDQ     0,,PR0
        11 002731   000011 772000                    QRL     9
        11 002732   000777 376007                    ANQ     511,DL
        11 002733   200025 756100                    STQ     FEX,,AUTO

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:349  
     1782    24186    2           IF FEX=KL_NODE

  24186 11 002734   000000 116000 xsym               CMPQ    KL_NODE
        11 002735   002751 601000 11                 TNZ     s:24188

     1783    24187    2           THEN CALL KLX$WRHLPSTA(KL$CWNAK,LEN,'BABOON ');

  24187 11 002736   000054 236000 12                 LDQ     44
        11 002737   200430 756100                    STQ     T$+3,,AUTO
        11 002740   200007 631500                    EPPR1   LEN,,AUTO
        11 002741   200427 451500                    STP1    T$+2,,AUTO
        11 002742   200003 236100                    LDQ     RDBF$,,AUTO
        11 002743   200426 756100                    STQ     T$+1,,AUTO
        11 002744   200426 630500                    EPPR0   T$+1,,AUTO
        11 002745   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002746   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 002747   000000 011000                    NOP     0
        11 002750   010045 710000 11                 TRA     s:25129

     1784    24188    2           ELSE CALL KLX$WRHLPNODE(KL$CWNAK,LEN,FEX);

  24188 11 002751   200025 631500                    EPPR1   FEX,,AUTO
        11 002752   200430 451500                    STP1    T$+3,,AUTO
        11 002753   200007 633500                    EPPR3   LEN,,AUTO
        11 002754   200427 453500                    STP3    T$+2,,AUTO
        11 002755   200003 236100                    LDQ     RDBF$,,AUTO
        11 002756   200426 756100                    STQ     T$+1,,AUTO
        11 002757   200426 630500                    EPPR0   T$+1,,AUTO
        11 002760   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 002761   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 002762   000000 011000                    NOP     0
        11 002763   010045 710000 11                 TRA     s:25129

     1785    24189    2        CASE(IGA_CRASHFEP_BF);

     1786    24190    2           LEN=SIZEC(CRASHFEP_BF);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:350  
  24190 11 002764   000004 235007                    LDA     4,DL
        11 002765   200007 755100                    STA     LEN,,AUTO

     1787    24191    2           FEX=KL$FEPST.FEP;

  24191 11 002766   000000 470400 xsym               LDP0    KL_RDBF$
        11 002767   000000 236100                    LDQ     0,,PR0
        11 002770   000022 772000                    QRL     18
        11 002771   000777 376007                    ANQ     511,DL
        11 002772   200025 756100                    STQ     FEX,,AUTO

     1788    24192    2           CALL KLX$WRHLPNODE(CRASHFEP_BF,LEN,FEX);

  24192 11 002773   200025 631500                    EPPR1   FEX,,AUTO
        11 002774   200430 451500                    STP1    T$+3,,AUTO
        11 002775   200007 633500                    EPPR3   LEN,,AUTO
        11 002776   200427 453500                    STP3    T$+2,,AUTO
        11 002777   000055 236000 12                 LDQ     45
        11 003000   200426 756100                    STQ     T$+1,,AUTO
        11 003001   200426 630500                    EPPR0   T$+1,,AUTO
        11 003002   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003003   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 003004   000000 011000                    NOP     0
        11 003005   010045 710000 11                 TRA     s:25129

     1789    24193        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:351  
     1790    24194    2        CASE(IGA_RQSCHN);

     1791    24195    2           IF KL$RQSCHN.DFLTHND

  24195 11 003006   200003 470500                    LDP0    RDBF$,,AUTO
        11 003007   000000 236100                    LDQ     0,,PR0
        11 003010   000040 316003                    CANQ    32,DU
        11 003011   003127 600000 11                 TZE     s:24223

     1792    24196    3           THEN DO;

     1793    24197    3                PSIZ=0;

  24197 11 003012   000000 220003                    LDX0    0,DU
        11 003013   200027 740100                    STX0    PSIZ,,AUTO

     1794    24198    3                KL_NETWORK_VALID = '0'B;

  24198 11 003014   000000 450000 xsym               STZ     KL_NETWORK_VALID

     1795    24199    3                CHNRSP = KL_CHNRSPC;

  24199 11 003015   000066 621010                    EAX1    54,X0
        11 003016   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003017   000140 100400                    MLR     fill='000'O
        11 003020   000024 000465 10                 ADSC9   KL_CHNRSPC               cn=0,n=309
        11 003021   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1796    24200    3                CHNRSP.HANDLER = KL$RQSCHN.HANDLER;

  24200 11 003022   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003023   040100 100500                    MLR     fill='040'O
        11 003024   000000 400010                    ADSC9   0,,PR0                   cn=2,n=8
        11 003025   100000 400010                    ADSC9   0,,PR1                   cn=2,n=8

     1797    24201    3                CHNRSP.DFLTHND = '1'B;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:352  
  24201 11 003026   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003027   000040 236003                    LDQ     32,DU
        11 003030   100000 256100                    ORSQ    0,,PR1

     1798    24202    3                CHNRSP.NAK = '1'B;

  24202 11 003031   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003032   000020 236003                    LDQ     16,DU
        11 003033   100000 256100                    ORSQ    0,,PR1

     1799    24203    3                DEFAULT_KEY.NODE = FEX;

  24203 11 003034   200025 236100                    LDQ     FEX,,AUTO
        11 003035   000011 736000                    QLS     9
        11 003036   000473 552010 7                  STBQ    DEFAULT_KEY,'10'O

     1800    24204    3                DEFAULT_KEY.HNDLR = KL$RQSCHN.HANDLER;

  24204 11 003037   040000 100500                    MLR     fill='040'O
        11 003040   000000 400010                    ADSC9   0,,PR0                   cn=2,n=8
        11 003041   000473 600010 7                  ADSC9   DEFAULT_KEY              cn=3,n=8

     1801    24205    3                KL_RD_NETCON.KEY_ = VECTOR(DEFAULT_KEY);

  24205 11 003042   000056 237000 12                 LDAQ    46
        11 003043   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     1802    24206    3                KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);

  24206 11 003044   000060 237000 12                 LDAQ    48
        11 003045   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     1803    24207    3                CALL M$READ(KL_RD_NETCON) ALTRET (DFLT_CHN);

  24207 11 003046   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 003047   440000 713400                    CLIMB   alt,read
        11 003050   401400 401760                    pmme    nvectors=4
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:353  
        11 003051   003227 702000 11                 TSX2    DFLT_CHN

     1804    24208    3                CHNRSP.NAK = '0'B;

  24208 11 003052   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 003053   000062 236000 12                 LDQ     50
        11 003054   000000 356100                    ANSQ    0,,PR0

     1805    24209    3                CHNRSP.NA = '0'B;

  24209 11 003055   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 003056   000100 100400                    MLR     fill='000'O
        11 003057   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 003060   000006 400010                    ADSC9   6,,PR0                   cn=2,n=8

     1806    24210    3                CHNRSP.HNDCMN = '0'B;

  24210 11 003061   000100 100400                    MLR     fill='000'O
        11 003062   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 003063   000010 400022                    ADSC9   8,,PR0                   cn=2,n=18

     1807    24211    3                IF LINCNFG.PRO.PROSIZE > 0

  24211 11 003064   000106 471400 7                  LDP1    CNFG$
        11 003065   100007 236100                    LDQ     7,,PR1
        11 003066   777000 316007                    CANQ    -512,DL
        11 003067   003126 600000 11                 TZE     s:24221

     1808    24212    4                THEN DO;

     1809    24213    4                     KL_PROKEY = LINCNFG.PRO;

  24213 11 003070   000000 100500                    MLR     fill='000'O
        11 003071   100007 400014                    ADSC9   7,,PR1                   cn=2,n=12
        11 003072   000000 000015 xsym               ADSC9   KL_PROKEY                cn=0,n=13

     1810    24214    4                     CALL M$READ (KL_RDPROR)
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:354  

  24214 11 003073   000000 630400 xsym               EPPR0   KL_RDPROR
        11 003074   440000 713400                    CLIMB   alt,read
        11 003075   401400 401760                    pmme    nvectors=4
        11 003076   003126 702000 11                 TSX2    s:24221

     1811    24215    5                     WHENRETURN DO;

     1812    24216    5                          PSIZ = DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS-SIZEC(KL_PROBUF);

  24216 11 003077   000000 236007 xsym               LDQ     M$PROF,DL
        11 003100   000063 470400 12                 LDP0    51
        11 003101   000000 471500                    LDP1    0,,PR0
        11 003102   100000 473506                    LDP3    0,QL,PR1
        11 003103   300000 720100                    LXL0    0,,PR3
        11 003104   777660 621010                    EAX1    -80,X0
        11 003105   200027 741100                    STX1    PSIZ,,AUTO

     1813    24217    5                          CALL KLX$9TO8(PSIZ,CHNRSP.MESSAGE.MSGSIZE,2);

  24217 11 003106   000042 236000 12                 LDQ     34
        11 003107   200430 756100                    STQ     T$+3,,AUTO
        11 003110   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 003111   000015 036003                    ADLQ    13,DU
        11 003112   200427 756100                    STQ     T$+2,,AUTO
        11 003113   200027 633500                    EPPR3   PSIZ,,AUTO
        11 003114   200426 453500                    STP3    T$+1,,AUTO
        11 003115   200426 630500                    EPPR0   T$+1,,AUTO
        11 003116   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003117   000000 701000 xent               TSX1    KLX$9TO8
        11 003120   000000 011000                    NOP     0

     1814    24218    5                          ADDR(CHNRSP.MESSAGE.MESSAGE)->CHR$PSIZ = PINCRC(ADDR(
             24218                                   KL_PROBUF),SIZEC(KL_PROBUF))->CHR$PSIZ;

  24218 11 003121   200027 220100                    LDX0    PSIZ,,AUTO
        11 003122   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:355  
        11 003123   040140 100440                    MLR     fill='040'O
        11 003124   000024 000010 xsym               ADSC9   KL_PROBUF+20             cn=0,n=*X0
        11 003125   000015 400010                    ADSC9   13,,PR0                  cn=2,n=*X0

     1815    24219    5                        END;

     1816    24220    4                   END;

     1817    24221    3                GOTO DFLT_CHN;

  24221 11 003126   003227 710000 11                 TRA     DFLT_CHN

     1818    24222    3              END;
     1819    24223    3           IF KL$RQSCHN.DFLTCHN THEN DO;

  24223 11 003127   000020 316003                    CANQ    16,DU
        11 003130   003251 600000 11                 TZE     s:24254

     1820    24224    3                IF KL$RQSCHN.SCNDCNFG THEN

  24224 11 003131   000010 316003                    CANQ    8,DU
        11 003132   003136 600000 11                 TZE     s:24226

     1821    24225    3                     CHNRSP.SCNDCNFG = '1'B;

  24225 11 003133   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003134   000010 236003                    LDQ     8,DU
        11 003135   100000 256100                    ORSQ    0,,PR1

     1822    24226    3                CONFIG_KEY.NODE = FEX;

  24226 11 003136   200025 236100                    LDQ     FEX,,AUTO
        11 003137   000011 736000                    QLS     9
        11 003140   000466 552010 7                  STBQ    CONFIG_KEY,'10'O

     1823    24227    3                IF KL$RQSCHN.TERMINAL_ID.TERM.CHANNEL = '0'B /* All configs */

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:356  
  24227 11 003141   000003 220100                    LDX0    3,,PR0
        11 003142   003146 601000 11                 TNZ     s:24232

     1824    24228    4                THEN DO;

     1825    24229    4                     CALL GETCONFIGS;

  24229 11 003143   010436 701000 11                 TSX1    GETCONFIGS
        11 003144   000000 011000                    NOP     0

     1826    24230    4                     RETURN;

  24230 11 003145   000000 702200 xent               TSX2  ! X66_ARET

     1827    24231    4                   END;
     1828    24232    3                CONFIG_KEY.TERMID = KL$RQSCHN.TERMINAL_ID;

  24232 11 003146   000000 100500                    MLR     fill='000'O
        11 003147   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16
        11 003150   000466 600020 7                  ADSC9   CONFIG_KEY               cn=3,n=16

     1829    24233    3                IF CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' '

  24233 11 003151   040000 106400                    CMPC    fill='040'O
        11 003152   000470 600010 7                  ADSC9   CONFIG_KEY+2             cn=3,n=8
        11 003153   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 003154   003160 600000 11                 TZE     s:24238

     1830    24234    4                THEN DO;

     1831    24235    4                     CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;

  24235 11 003155   000000 236003                    LDQ     0,DU
        11 003156   000467 552030 7                  STBQ    CONFIG_KEY+1,'30'O

     1832    24236    4                     CONFIG_KEY.NODE = 0;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:357  
  24236 11 003157   000466 552010 7                  STBQ    CONFIG_KEY,'10'O

     1833    24237    4                   END;

     1834    24238    3                CONFIG_KEY.TERMID.TTYP = 0;

  24238 11 003160   000000 236003                    LDQ     0,DU
        11 003161   000466 552004 7                  STBQ    CONFIG_KEY,'04'O

     1835    24239    3                PSIZ = 0;

  24239 11 003162   000000 220003                    LDX0    0,DU
        11 003163   200027 740100                    STX0    PSIZ,,AUTO

     1836    24240    3                KL_NETWORK_VALID = '0'B;

  24240 11 003164   000000 450000 xsym               STZ     KL_NETWORK_VALID

     1837    24241    3                CHNRSP = KL_CHNRSPC;

  24241 11 003165   000066 621010                    EAX1    54,X0
        11 003166   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003167   000140 100400                    MLR     fill='000'O
        11 003170   000024 000465 10                 ADSC9   KL_CHNRSPC               cn=0,n=309
        11 003171   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1838    24242    3                CHNRSP.CONFIG = '1'B;

  24242 11 003172   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003173   000100 236003                    LDQ     64,DU
        11 003174   100000 256100                    ORSQ    0,,PR1

     1839    24243    3                CHNRSP.NA.SNDSLT = '10'B;

  24243 11 003175   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003176   100006 236100                    LDQ     6,,PR1
        11 003177   000064 376000 12                 ANQ     52
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:358  
        11 003200   200000 276007                    ORQ     65536,DL
        11 003201   100006 756100                    STQ     6,,PR1

     1840    24244    3                CHNRSP.TERMINAL_ID = KL$RQSCHN.TERMINAL_ID;

  24244 11 003202   000100 100500                    MLR     fill='000'O
        11 003203   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16
        11 003204   100002 400020                    ADSC9   2,,PR1                   cn=2,n=16

     1841    24245    3                KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);

  24245 11 003205   000060 237000 12                 LDAQ    48
        11 003206   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     1842    24246    3                KL_RD_NETCON.KEY_ = VECTOR(CONFIG_KEY);

  24246 11 003207   000066 237000 12                 LDAQ    54
        11 003210   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     1843    24247    3                CALL M$READ(KL_RD_NETCON) ALTRET(DFLT_CHN);

  24247 11 003211   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 003212   440000 713400                    CLIMB   alt,read
        11 003213   401400 401760                    pmme    nvectors=4
        11 003214   003227 702000 11                 TSX2    DFLT_CHN

     1844    24248    3                CHNRSP.NA = LINCNFG.NA;

  24248 11 003215   000106 470400 7                  LDP0    CNFG$
        11 003216   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003217   000100 100500                    MLR     fill='000'O
        11 003220   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8
        11 003221   100006 400010                    ADSC9   6,,PR1                   cn=2,n=8

     1845    24249    3                CHNRSP.NA.CNFG_EXISTS = '1'B;

  24249 11 003222   000002 236007                    LDQ     2,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:359  
        11 003223   100006 256100                    ORSQ    6,,PR1

     1846    24250    3                CHNRSP.HNDCMN = LINCNFG.KHA;

  24250 11 003224   000100 100500                    MLR     fill='000'O
        11 003225   000000 000022                    ADSC9   0,,PR0                   cn=0,n=18
        11 003226   100010 400022                    ADSC9   8,,PR1                   cn=2,n=18

     1847    24251    3   DFLT_CHN:    CALL KLX$WRHLPNODE(CHNRSP,SIZEC(CHNRSP),FEX);

  24251 11 003227   200027 236100       DFLT_CHN     LDQ     PSIZ,,AUTO
        11 003230   000022 772000                    QRL     18
        11 003231   000011 402007                    MPY     9,DL
        11 003232   001011 036007                    ADLQ    521,DL
        11 003233   000044 506007                    DIV     36,DL
        11 003234   000002 736000                    QLS     2
        11 003235   200426 756100                    STQ     T$+1,,AUTO
        11 003236   200025 630500                    EPPR0   FEX,,AUTO
        11 003237   200431 450500                    STP0    T$+4,,AUTO
        11 003240   200426 631500                    EPPR1   T$+1,,AUTO
        11 003241   200430 451500                    STP1    T$+3,,AUTO
        11 003242   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 003243   200427 756100                    STQ     T$+2,,AUTO
        11 003244   200427 630500                    EPPR0   T$+2,,AUTO
        11 003245   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003246   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 003247   000000 011000                    NOP     0

     1848    24252    3              END;                         /* IF RQSCHN.DFLTCHN */

  24252 11 003250   003774 710000 11                 TRA     s:24358

     1849    24253    3           ELSE DO;

     1850    24254    3                KL_NETWORK_VALID = '0'B;

  24254 11 003251   000000 450000 xsym               STZ     KL_NETWORK_VALID
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:360  

     1851    24255    3                KL$CHNRSP = KL_CHNRSPC;

  24255 11 003252   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003253   000100 100400                    MLR     fill='000'O
        11 003254   000024 000070 10                 ADSC9   KL_CHNRSPC               cn=0,n=56
        11 003255   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

     1852    24256    3                KL$CHNRSP.HANDLER = KL$RQSCHN.HANDLER;

  24256 11 003256   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003257   040100 100500                    MLR     fill='040'O
        11 003260   000000 400010                    ADSC9   0,,PR0                   cn=2,n=8
        11 003261   100000 400010                    ADSC9   0,,PR1                   cn=2,n=8

     1853    24257    3                KL$CHNRSP.TERMINAL_ID = KL$RQSCHN.TERMINAL_ID;

  24257 11 003262   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003263   000100 100500                    MLR     fill='000'O
        11 003264   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16
        11 003265   100002 400020                    ADSC9   2,,PR1                   cn=2,n=16

     1854    24258    3                KL$RQSCHN.TERMINAL_ID.TTYP = 0;

  24258 11 003266   000000 236003                    LDQ     0,DU
        11 003267   000002 552110                    STBQ    2,'10'O,PR0

     1855    24259    3                KL$CHNRSP.NAK = '0'B;

  24259 11 003270   000062 236000 12                 LDQ     50
        11 003271   100000 356100                    ANSQ    0,,PR1

     1856    24260    3                KL$CHNRSP.LINE_PROFILE = '1'B;

  24260 11 003272   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 003273   000200 236003                    LDQ     128,DU
        11 003274   100000 256100                    ORSQ    0,,PR1
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:361  

     1857    24261    4                IF KL$RQSCHN.SGN.L ~= 0 THEN DO;

  24261 11 003275   000006 236100                    LDQ     6,,PR0
        11 003276   777000 316007                    CANQ    -512,DL
        11 003277   003423 600000 11                 TZE     s:24287

     1858    24262    4                     CALL KLH$SGSCAN(KL$RQSCHN.SGN,ACCT,UNAME,PASS,PRO,ERR,HOSTNAME,
             24262                              NOSETUP,NOHEADER) ALTRET(CHNNAK);

  24262 11 003300   200054 631500                    EPPR1   NOHEADER,,AUTO
        11 003301   200436 451500                    STP1    T$+9,,AUTO
        11 003302   200053 633500                    EPPR3   NOSETUP,,AUTO
        11 003303   200435 453500                    STP3    T$+8,,AUTO
        11 003304   200051 634500                    EPPR4   HOSTNAME,,AUTO
        11 003305   200434 454500                    STP4    T$+7,,AUTO
        11 003306   200050 635500                    EPPR5   ERR,,AUTO
        11 003307   200433 455500                    STP5    T$+6,,AUTO
        11 003310   200045 636500                    EPPR6   PRO,,AUTO
        11 003311   200432 456500                    STP6    T$+5,,AUTO
        11 003312   200043 637500                    EPPR7   PASS,,AUTO
        11 003313   200431 457500                    STP7    T$+4,,AUTO
        11 003314   200037 630500                    EPPR0   UNAME,,AUTO
        11 003315   200430 450500                    STP0    T$+3,,AUTO
        11 003316   200035 630500                    EPPR0   ACCT,,AUTO
        11 003317   200427 450500                    STP0    T$+2,,AUTO
        11 003320   200003 236100                    LDQ     RDBF$,,AUTO
        11 003321   000070 036000 12                 ADLQ    56
        11 003322   200426 756100                    STQ     T$+1,,AUTO
        11 003323   200426 630500                    EPPR0   T$+1,,AUTO
        11 003324   000065 631400 12                 EPPR1   53
        11 003325   000000 701000 xent               TSX1    KLH$SGSCAN
        11 003326   003402 702000 11                 TSX2    CHNNAK

     1859    24263    4                     IF HOSTNAME = ' '

  24263 11 003327   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:362  
        11 003330   200051 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8
        11 003331   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 003332   003336 601000 11                 TNZ     s:24266

     1860    24264    4                     THEN
     1861    24265    4                          HOSTNAME = KL_NODENAME;

  24265 11 003333   040100 100400                    MLR     fill='040'O
        11 003334   000000 000010 xsym               ADSC9   KL_NODENAME              cn=0,n=8
        11 003335   200051 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8

     1862    24266    4                     LINCNFG.FLAGS.REMOTE = '1'B;

  24266 11 003336   000106 470400 7                  LDP0    CNFG$
        11 003337   400000 236007                    LDQ     -131072,DL
        11 003340   000006 256100                    ORSQ    6,,PR0

     1863    24267    4                     LINCNFG.NA = NA_C;

  24267 11 003341   000100 100400                    MLR     fill='000'O
        11 003342   000005 000010 10                 ADSC9   NA_C                     cn=0,n=8
        11 003343   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8

     1864    24268    4                     LINCNFG.KHA = KHA_C;

  24268 11 003344   000100 100400                    MLR     fill='000'O
        11 003345   000000 000022 10                 ADSC9   KHA_C                    cn=0,n=18
        11 003346   000000 000022                    ADSC9   0,,PR0                   cn=0,n=18

     1865    24269    4                     LINCNFG.PRO.PROSIZE = 0;

  24269 11 003347   000000 236003                    LDQ     0,DU
        11 003350   000007 552110                    STBQ    7,'10'O,PR0

     1866    24270    4                     LINCNFG.PRO.PROTXT = ' ';

  24270 11 003351   040100 100400                    MLR     fill='040'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:363  
        11 003352   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 003353   000007 600013                    ADSC9   7,,PR0                   cn=3,n=11

     1867    24271    4                     LINCNFG.LGN.LGNSIZE = KL$RQSCHN.SGN.L;

  24271 11 003354   200003 471500                    LDP1    RDBF$,,AUTO
        11 003355   100006 236100                    LDQ     6,,PR1
        11 003356   000012 552110                    STBQ    10,'10'O,PR0

     1868    24272    4                     LINCNFG.LGN.LGNSTRING = KL$RQSCHN.SGN.TXT;

  24272 11 003357   100006 236100                    LDQ     6,,PR1
        11 003360   000011 772000                    QRL     9
        11 003361   000777 376007                    ANQ     511,DL
        11 003362   000000 620006                    EAX0    0,QL
        11 003363   040100 100540                    MLR     fill='040'O
        11 003364   100006 600010                    ADSC9   6,,PR1                   cn=3,n=*X0
        11 003365   000012 600144                    ADSC9   10,,PR0                  cn=3,n=100

     1869    24273    4                     TERM_KEY.TERMID.TERM.TERM_NAME = ACCT;

  24273 11 003366   040000 100500                    MLR     fill='040'O
        11 003367   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003370   000214 400010 7                  ADSC9   TERM_KEY+2               cn=2,n=8

     1870    24274    4                     KL_RD_NETCON.BUF_ = VECTOR(TERM_REC);

  24274 11 003371   000072 237000 12                 LDAQ    58
        11 003372   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     1871    24275    4                     KL_RD_NETCON.KEY_ = VECTOR(TERM_KEY);

  24275 11 003373   000074 237000 12                 LDAQ    60
        11 003374   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     1872    24276    5                     CALL M$READ(KL_RD_NETCON) WHENALTRETURN DO;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:364  
  24276 11 003375   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 003376   440000 713400                    CLIMB   alt,read
        11 003377   401400 401760                    pmme    nvectors=4
        11 003400   003402 702000 11                 TSX2    CHNNAK
        11 003401   003422 710000 11                 TRA     s:24285

     1873    24277    5   CHNNAK:                KL$CHNRSP.NAK = '1'B;

  24277 11 003402   000000 470400 xsym  CHNNAK       LDP0    KL_EXTRSP_BUF$
        11 003403   000020 236003                    LDQ     16,DU
        11 003404   000000 256100                    ORSQ    0,,PR0

     1874    24278    5                          SIZE = SIZEC(KL$CHNRSP) - SIZEC(KL$CHNRSP.MESSAGE.MESSAGE) +
             24278                                   1;

  24278 11 003405   000067 235007                    LDA     55,DL
        11 003406   200024 755100                    STA     SIZE,,AUTO

     1875    24279    5                          CALL KLX$WRHLPNODE(KL$CHNRSP,SIZE,FEX);

  24279 11 003407   200025 630500                    EPPR0   FEX,,AUTO
        11 003410   200430 450500                    STP0    T$+3,,AUTO
        11 003411   200024 631500                    EPPR1   SIZE,,AUTO
        11 003412   200427 451500                    STP1    T$+2,,AUTO
        11 003413   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 003414   200426 756100                    STQ     T$+1,,AUTO
        11 003415   200426 630500                    EPPR0   T$+1,,AUTO
        11 003416   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003417   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 003420   000000 011000                    NOP     0

     1876    24280    5                          RETURN;

  24280 11 003421   000000 702200 xent               TSX2  ! X66_ARET

     1877    24281    5                        END;               /* WHENALTRETURN */
     1878    24282        /*N*            Right here we should make some kind of check as to whether
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:365  
     1879    24283                         or not the specified terminal is active.  If it is, we
     1880    24284                         should send a NAK */
     1881    24285    4                   END;

  24285 11 003422   003477 710000 11                 TRA     s:24297

     1882    24286    4                ELSE DO;                   /* Not a REMOTE signon */

     1883    24287    4                     CONFIG_KEY.NODE=FEX;

  24287 11 003423   200025 236100                    LDQ     FEX,,AUTO
        11 003424   000011 736000                    QLS     9
        11 003425   000466 552010 7                  STBQ    CONFIG_KEY,'10'O

     1884    24288    4                     CONFIG_KEY.TERMID = KL$RQSCHN.TERMINAL_ID;

  24288 11 003426   000000 100500                    MLR     fill='000'O
        11 003427   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16
        11 003430   000466 600020 7                  ADSC9   CONFIG_KEY               cn=3,n=16

     1885    24289    4                     KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);

  24289 11 003431   000060 237000 12                 LDAQ    48
        11 003432   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     1886    24290    4                     KL_RD_NETCON.KEY_ = VECTOR(CONFIG_KEY);

  24290 11 003433   000066 237000 12                 LDAQ    54
        11 003434   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     1887    24291    4                     CALL M$READ(KL_RD_NETCON) ALTRET(CHNNAK);

  24291 11 003435   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 003436   440000 713400                    CLIMB   alt,read
        11 003437   401400 401760                    pmme    nvectors=4
        11 003440   003402 702000 11                 TSX2    CHNNAK

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:366  
     1888    24292    4                     CALL KLH$SGSCAN(LINCNFG.LGN,ACCT,UNAME,PASS,PRO,ERR,HOSTNAME,
             24292                              NOSETUP,NOHEADER) ALTRET(CHNNAK);

  24292 11 003441   200054 630500                    EPPR0   NOHEADER,,AUTO
        11 003442   200436 450500                    STP0    T$+9,,AUTO
        11 003443   200053 631500                    EPPR1   NOSETUP,,AUTO
        11 003444   200435 451500                    STP1    T$+8,,AUTO
        11 003445   200051 633500                    EPPR3   HOSTNAME,,AUTO
        11 003446   200434 453500                    STP3    T$+7,,AUTO
        11 003447   200050 634500                    EPPR4   ERR,,AUTO
        11 003450   200433 454500                    STP4    T$+6,,AUTO
        11 003451   200045 635500                    EPPR5   PRO,,AUTO
        11 003452   200432 455500                    STP5    T$+5,,AUTO
        11 003453   200043 636500                    EPPR6   PASS,,AUTO
        11 003454   200431 456500                    STP6    T$+4,,AUTO
        11 003455   200037 637500                    EPPR7   UNAME,,AUTO
        11 003456   200430 457500                    STP7    T$+3,,AUTO
        11 003457   200035 630500                    EPPR0   ACCT,,AUTO
        11 003460   200427 450500                    STP0    T$+2,,AUTO
        11 003461   000106 236000 7                  LDQ     CNFG$
        11 003462   000071 036000 12                 ADLQ    57
        11 003463   200426 756100                    STQ     T$+1,,AUTO
        11 003464   200426 630500                    EPPR0   T$+1,,AUTO
        11 003465   000065 631400 12                 EPPR1   53
        11 003466   000000 701000 xent               TSX1    KLH$SGSCAN
        11 003467   003402 702000 11                 TSX2    CHNNAK

     1889    24293    4                     IF HOSTNAME = ' '

  24293 11 003470   040000 106500                    CMPC    fill='040'O
        11 003471   200051 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8
        11 003472   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 003473   003477 601000 11                 TNZ     s:24297

     1890    24294    4                     THEN
     1891    24295    4                          HOSTNAME = KL_NODENAME;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:367  
  24295 11 003474   040100 100400                    MLR     fill='040'O
        11 003475   000000 000010 xsym               ADSC9   KL_NODENAME              cn=0,n=8
        11 003476   200051 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8

     1892    24296    4                   END;

     1893    24297    3                CALL KLI$LINEPRO(ACCT,UNAME,PASS);

  24297 11 003477   200043 630500                    EPPR0   PASS,,AUTO
        11 003500   200430 450500                    STP0    T$+3,,AUTO
        11 003501   200037 631500                    EPPR1   UNAME,,AUTO
        11 003502   200427 451500                    STP1    T$+2,,AUTO
        11 003503   200035 633500                    EPPR3   ACCT,,AUTO
        11 003504   200426 453500                    STP3    T$+1,,AUTO
        11 003505   200426 630500                    EPPR0   T$+1,,AUTO
        11 003506   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003507   000000 701000 xent               TSX1    KLI$LINEPRO
        11 003510   000000 011000                    NOP     0

     1894    24298    3                IF KL$CHNRSP.NAK THEN GOTO CHNNAK;

  24298 11 003511   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 003512   000000 236100                    LDQ     0,,PR0
        11 003513   000020 316003                    CANQ    16,DU
        11 003514   003402 601000 11                 TNZ     CHNNAK

     1895    24299    3                KL$CHNRSP.TERMINAL_ID.TERM.TERM_NAME = ACCT;

  24299 11 003515   040100 100500                    MLR     fill='040'O
        11 003516   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003517   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8

     1896    24300    3                IF LINCNFG.FLAGS.REMOTE

  24300 11 003520   000106 471400 7                  LDP1    CNFG$
        11 003521   100006 236100                    LDQ     6,,PR1
        11 003522   400000 316007                    CANQ    -131072,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:368  
        11 003523   003536 600000 11                 TZE     s:24307

     1897    24301    4                THEN DO;

     1898    24302    4                     TERM_REC = CONFIG_KEY;

  24302 11 003524   000000 100400                    MLR     fill='000'O
        11 003525   000466 000023 7                  ADSC9   CONFIG_KEY               cn=0,n=19
        11 003526   000205 000023 7                  ADSC9   TERM_REC                 cn=0,n=19

     1899    24303    4                     KL_WR_NETCON.BUF_ = VECTOR(TERM_REC);

  24303 11 003527   000072 237000 12                 LDAQ    58
        11 003530   000004 757000 xsym               STAQ    KL_WR_NETCON+4

     1900    24304    4                     KL_WR_NETCON.KEY_ = VECTOR(TERM_KEY);

  24304 11 003531   000074 237000 12                 LDAQ    60
        11 003532   000002 757000 xsym               STAQ    KL_WR_NETCON+2

     1901    24305    4                     CALL M$WRITE(KL_WR_NETCON); /* SCREECH on ALTRET */

  24305 11 003533   000000 630400 xsym               EPPR0   KL_WR_NETCON
        11 003534   040001 713400                    CLIMB   write
        11 003535   401400 401760                    pmme    nvectors=4

     1902    24306    4                   END;                    /* IF LINCNFG.FLAGS.REMOTE */

     1903    24307    3                SIZE = KL$CHNRSP.MESSAGE.MSGSIZE.BYT(0) * 256 + KL$CHNRSP.MESSAGE.
             24307                         MSGSIZE.BYT(1);

  24307 11 003536   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 003537   000015 236100                    LDQ     13,,PR0
        11 003540   000022 772000                    QRL     18
        11 003541   000377 376007                    ANQ     255,DL
        11 003542   200426 756100                    STQ     T$+1,,AUTO
        11 003543   000015 236100                    LDQ     13,,PR0
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:369  
        11 003544   000023 772000                    QRL     19
        11 003545   177400 376007                    ANQ     65280,DL
        11 003546   200426 036100                    ADLQ    T$+1,,AUTO
        11 003547   200024 756100                    STQ     SIZE,,AUTO

     1904    24308    3                SIZE = SIZE + SIZEC(KL$CHNRSP) - SIZEC(KL$CHNRSP.MESSAGE.MESSAGE);

  24308 11 003550   000066 036007                    ADLQ    54,DL
        11 003551   200024 756100                    STQ     SIZE,,AUTO

     1905    24309    3                CALL KLX$WRHLPNODE(KL$CHNRSP,SIZE,FEX);

  24309 11 003552   200025 631500                    EPPR1   FEX,,AUTO
        11 003553   200430 451500                    STP1    T$+3,,AUTO
        11 003554   200024 633500                    EPPR3   SIZE,,AUTO
        11 003555   200427 453500                    STP3    T$+2,,AUTO
        11 003556   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 003557   200426 756100                    STQ     T$+1,,AUTO
        11 003560   200426 630500                    EPPR0   T$+1,,AUTO
        11 003561   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003562   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 003563   000000 011000                    NOP     0

     1906    24310
     1907    24311             /* Save the terminal name in :NETWORK */
     1908    24312    3                KL_NETWORK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_LINE;

  24312 11 003564   000000 236003                    LDQ     0,DU
        11 003565   000000 552020 xsym               STBQ    KL_NETWORK_KEY,'20'O

     1909    24313    3                KL_NETWORK_KEY.KEY.NODE = FEX;

  24313 11 003566   200025 236100                    LDQ     FEX,,AUTO
        11 003567   000011 736000                    QLS     9
        11 003570   000000 552010 xsym               STBQ    KL_NETWORK_KEY,'10'O

     1910    24314    3                KL_NETWORK_KEY.KEY.TERMID = KL$RQSCHN.TERMINAL_ID;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:370  

  24314 11 003571   200003 470500                    LDP0    RDBF$,,AUTO
        11 003572   000000 100500                    MLR     fill='000'O
        11 003573   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16
        11 003574   000000 600020 xsym               ADSC9   KL_NETWORK_KEY           cn=3,n=16

     1911    24315    3                KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;

  24315 11 003575   000000 236003                    LDQ     0,DU
        11 003576   000000 552004 xsym               STBQ    KL_NETWORK_KEY,'04'O

     1912    24316    3                KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  24316 11 003577   022000 236003                    LDQ     9216,DU
        11 003600   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     1913    24317    3                CALL M$TIME(KL_NETWORK_TIME);

  24317 11 003601   000000 630400 xsym               EPPR0   KL_NETWORK_TIME
        11 003602   020004 713400                    CLIMB   8196
        11 003603   402000 401760                    pmme    nvectors=5

     1914    24318    3                KL_NETWORK_BUF.DEVNM = ACCT;

  24318 11 003604   040000 100500                    MLR     fill='040'O
        11 003605   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003606   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8

     1915    24319    3                KL_NETWORK_BUF.TERMNAME = ACCT;

  24319 11 003607   040000 100500                    MLR     fill='040'O
        11 003610   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003611   000005 600010 xsym               ADSC9   KL_NETWORK_BUF+5         cn=3,n=8

     1916    24320    3                KL_NETWORK_BUF.ACCT = ACCT;

  24320 11 003612   040000 100500                    MLR     fill='040'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:371  
        11 003613   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003614   000001 400010 xsym               ADSC9   KL_NETWORK_BUF+1         cn=2,n=8

     1917    24321    3                KL_NETWORK_BUF.HLPKEY = KL_HLPKEY;

  24321 11 003615   000000 100400                    MLR     fill='000'O
        11 003616   000000 000025 xsym               ADSC9   KL_HLPKEY                cn=0,n=21
        11 003617   000013 600040 xsym               ADSC9   KL_NETWORK_BUF+11        cn=3,n=32

     1918    24322    3                KL_NETWORK_BUF.ATYP = KL_HLPR.ATYP;

  24322 11 003620   000000 236000 xsym               LDQ     KL_HLPR
        11 003621   000001 552040 xsym               STBQ    KL_NETWORK_BUF+1,'40'O

     1919    24323    3                KL_NETWORK_BUF.TERMINAL_ID = KL$RQSCHN.TERMINAL_ID;

  24323 11 003622   200003 470500                    LDP0    RDBF$,,AUTO
        11 003623   000000 100500                    MLR     fill='000'O
        11 003624   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16
        11 003625   000007 600020 xsym               ADSC9   KL_NETWORK_BUF+7         cn=3,n=16

     1920    24324    3                KL_NETWORK_BUF.NODE = FEX;

  24324 11 003626   200025 236100                    LDQ     FEX,,AUTO
        11 003627   000011 736000                    QLS     9
        11 003630   000005 552010 xsym               STBQ    KL_NETWORK_BUF+5,'10'O

     1921    24325    3                KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  24325 11 003631   000022 237000 12                 LDAQ    18
        11 003632   000002 757000 xsym               STAQ    KL_WR_NETWORK+2

     1922    24326    3                CALL M$WRITE (KL_WR_NETWORK)

  24326 11 003633   000000 630400 xsym               EPPR0   KL_WR_NETWORK
        11 003634   440001 713400                    CLIMB   alt,write
        11 003635   401400 401760                    pmme    nvectors=4
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:372  
        11 003636   003640 702000 11                 TSX2    s:24329
        11 003637   003640 710000 11                 TRA     s:24329

     1923    24327    4                WHENALTRETURN DO;

     1924    24328    4                   END;

     1925    24329    3                KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.KEY);

  24329 11 003640   011000 236003                    LDQ     4608,DU
        11 003641   000000 552040 xsym               STBQ    KL_NETWORK_TERMKEY,'40'O

     1926    24330    3                KL_NETWORK_TERMKEY.KEY.TERMNAME = ACCT;

  24330 11 003642   040000 100500                    MLR     fill='040'O
        11 003643   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003644   000000 400010 xsym               ADSC9   KL_NETWORK_TERMKEY       cn=2,n=8

     1927    24331    3                KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);

  24331 11 003645   000034 237000 12                 LDAQ    28
        11 003646   000002 757000 xsym               STAQ    KL_WR_NETWORK+2

     1928    24332    3                CALL M$WRITE (KL_WR_NETWORK)

  24332 11 003647   000000 630400 xsym               EPPR0   KL_WR_NETWORK
        11 003650   440001 713400                    CLIMB   alt,write
        11 003651   401400 401760                    pmme    nvectors=4
        11 003652   003654 702000 11                 TSX2    s:24337
        11 003653   003654 710000 11                 TRA     s:24337

     1929    24333    4                WHENALTRETURN DO;

     1930    24334    4                   END;

     1931    24335
     1932    24336             /* Inform ELF about the device going active */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:373  
     1933    24337    3                KL_PCD = '0'B;

  24337 11 003654   000000 100400                    MLR     fill='000'O
        11 003655   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 003656   000000 000420 xsym               ADSC9   KL_PCD                   cn=0,n=272

     1934    24338    3                KL_PCD.ADDD.FEX = FEX;

  24338 11 003657   200025 236100                    LDQ     FEX,,AUTO
        11 003660   000000 552004 xsym               STBQ    KL_PCD,'04'O

     1935    24339    3                KL_PCD.ADDD.TERMID.LEV = KL$CHNRSP.TERMINAL_ID.LEV;

  24339 11 003661   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 003662   000002 236100                    LDQ     2,,PR0
        11 003663   000011 736000                    QLS     9
        11 003664   000003 552010 xsym               STBQ    KL_PCD+3,'10'O

     1936    24340    3                CALL KLX$8TO9(KL$CHNRSP.TERMINAL_ID.TERM.CHANNEL,KL_PCD.ADDD.TERMID.
             24340                         CHAN,2);

  24340 11 003665   000042 236000 12                 LDQ     34
        11 003666   200430 756100                    STQ     T$+3,,AUTO
        11 003667   000076 236000 12                 LDQ     62
        11 003670   200427 756100                    STQ     T$+2,,AUTO
        11 003671   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 003672   000003 036003                    ADLQ    3,DU
        11 003673   200426 756100                    STQ     T$+1,,AUTO
        11 003674   200426 630500                    EPPR0   T$+1,,AUTO
        11 003675   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003676   000000 701000 xent               TSX1    KLX$8TO9
        11 003677   000000 011000                    NOP     0

     1937    24341    3                CALL KLX$8TO9(KL$CHNRSP.TERMINAL_ID.TERM.SUBDEVICE,KL_PCD.ADDD.TERMID.
             24341                         SUB,2);

  24341 11 003700   000042 236000 12                 LDQ     34
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:374  
        11 003701   200430 756100                    STQ     T$+3,,AUTO
        11 003702   000077 236000 12                 LDQ     63
        11 003703   200427 756100                    STQ     T$+2,,AUTO
        11 003704   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 003705   000100 036000 12                 ADLQ    64
        11 003706   200426 756100                    STQ     T$+1,,AUTO
        11 003707   200426 630500                    EPPR0   T$+1,,AUTO
        11 003710   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003711   000000 701000 xent               TSX1    KLX$8TO9
        11 003712   000000 011000                    NOP     0

     1938    24342    3                CALL KLX$8TO9(KL$CHNRSP.TERMINAL_ID.TERM.SUBSUBDEVICE,KL_PCD.ADDD.
             24342                         TERMID.SUBSUB,2);

  24342 11 003713   000042 236000 12                 LDQ     34
        11 003714   200430 756100                    STQ     T$+3,,AUTO
        11 003715   000101 236000 12                 LDQ     65
        11 003716   200427 756100                    STQ     T$+2,,AUTO
        11 003717   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 003720   000004 036003                    ADLQ    4,DU
        11 003721   200426 756100                    STQ     T$+1,,AUTO
        11 003722   200426 630500                    EPPR0   T$+1,,AUTO
        11 003723   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003724   000000 701000 xent               TSX1    KLX$8TO9
        11 003725   000000 011000                    NOP     0

     1939    24343    3                CALL KLX$CONV_NODE(KL_PCD.ADDD.FEPNAME,FEX,NODETYPE);

  24343 11 003726   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 003727   200430 450500                    STP0    T$+3,,AUTO
        11 003730   200025 631500                    EPPR1   FEX,,AUTO
        11 003731   200427 451500                    STP1    T$+2,,AUTO
        11 003732   000102 236000 12                 LDQ     66
        11 003733   200426 756100                    STQ     T$+1,,AUTO
        11 003734   200426 630500                    EPPR0   T$+1,,AUTO
        11 003735   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 003736   000000 701000 xent               TSX1    KLX$CONV_NODE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:375  
        11 003737   000000 011000                    NOP     0

     1940    24344    3                KL_PCD.ADDD.ACTYP = %KLAC_TRM;

  24344 11 003740   002000 236003                    LDQ     1024,DU
        11 003741   000000 552040 xsym               STBQ    KL_PCD,'40'O

     1941    24345    3                KL_PCD.ADDD.ASSOCTRM = ACCT;

  24345 11 003742   040000 100500                    MLR     fill='040'O
        11 003743   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003744   000011 400010 xsym               ADSC9   KL_PCD+9                 cn=2,n=8

     1942    24346    3                KL_PCD.ADDD.TNAME = KL_HLPR.TNAME;

  24346 11 003745   040000 100400                    MLR     fill='040'O
        11 003746   000013 000010 xsym               ADSC9   KL_HLPR+11               cn=0,n=8
        11 003747   000007 400010 xsym               ADSC9   KL_PCD+7                 cn=2,n=8

     1943    24347    3                KL_PCD.ADDD.TWSN = KL_HLPR.TWSN#;

  24347 11 003750   040000 100400                    MLR     fill='040'O
        11 003751   000001 000004 xsym               ADSC9   KL_HLPR+1                cn=0,n=4
        11 003752   000013 400004 xsym               ADSC9   KL_PCD+11                cn=2,n=4

     1944    24348    3                KL_PCD.ADDD.ATYP = KL_HLPR.ATYP;

  24348 11 003753   000000 236000 xsym               LDQ     KL_HLPR
        11 003754   000011 772000                    QRL     9
        11 003755   000000 552020 xsym               STBQ    KL_PCD,'20'O

     1945    24349    3                KL_PCD.ADDD.DEVNM = ACCT;

  24349 11 003756   040000 100500                    MLR     fill='040'O
        11 003757   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 003760   000005 400010 xsym               ADSC9   KL_PCD+5                 cn=2,n=8

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:376  
     1946    24350    3                FPT_WRSYSLOG.V.TYPE# = EL_CONN;

  24350 11 003761   000001 235007                    LDA     1,DL
        11 003762   000271 755000 7                  STA     FPT_WRSYSLOG+5

  24350 11 003763                       WRTSYSLOG    null
     1947    24351    3   WRTSYSLOG:   ;
     1948    24352    3                CALL M$WRSYSLOG (FPT_WRSYSLOG)

  24352 11 003763   000264 630400 7                  EPPR0   FPT_WRSYSLOG
        11 003764   470001 713400                    CLIMB   alt,+28673
        11 003765   400400 401760                    pmme    nvectors=2
        11 003766   003770 702000 11                 TSX2    s:24354
        11 003767   003774 710000 11                 TRA     s:24358

     1949    24353    4                WHENALTRETURN DO;

     1950    24354    4                     CALL M$WAIT (FPT_WAIT);

  24354 11 003770   000010 630400 10                 EPPR0   FPT_WAIT
        11 003771   020006 713400                    CLIMB   8198
        11 003772   400400 401760                    pmme    nvectors=2

     1951    24355    4                     GOTO WRTSYSLOG;

  24355 11 003773   003763 710000 11                 TRA     WRTSYSLOG

     1952    24356    4                   END;
     1953    24357    3              END;                         /* ELSE */

     1954    24358    2           FEPERR='0'B;

  24358 11 003774   000100 100400                    MLR     fill='000'O
        11 003775   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 003776   200304 000210                    ADSC9   FEPERR,,AUTO             cn=0,n=136
        11 003777   010045 710000 11                 TRA     s:25129

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:377  
     1955    24359
     1956    24360        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:378  
     1957    24361    2        CASE (IGA_SYSLOG);                 /* Syslog request */

     1958    24362    3           DO CASE (KL$SYSLOG.FILENUM);

  24362 11 004000   000000 470400 xsym               LDP0    KL_RDBF$
        11 004001   000000 720100                    LXL0    0,,PR0
        11 004002   000777 360003                    ANX0    511,DU
        11 004003   000004 100003                    CMPX0   4,DU
        11 004004   004006 602010 11                 TNC     s:24362+6,X0
        11 004005   010045 710000 11                 TRA     s:25129
        11 004006   004503 710000 11                 TRA     s:24461
        11 004007   004264 710000 11                 TRA     s:24419
        11 004010   004012 710000 11                 TRA     s:24366
        11 004011   004352 710000 11                 TRA     s:24431

     1959    24363    3           CASE(EL_ACCT);                  /*account logging*/

     1960    24364        /* move all character data at once.
     1961    24365        */
     1962    24366    3              CTX$ = ADDR(G$ACC_UNPK.CODE);

  24366 11 004012   000000 236000 xsym               LDQ     KL_RDBF$
        11 004013   000001 036003                    ADLQ    1,DU
        11 004014   200021 756100                    STQ     CTX$,,AUTO

     1963    24367    3              G@ACC_PKD = CTX$->G$ACC;

  24367 11 004015   200021 471500                    LDP1    CTX$,,AUTO
        11 004016   000100 100500                    MLR     fill='000'O
        11 004017   100000 000304                    ADSC9   0,,PR1                   cn=0,n=196
        11 004020   200066 000310                    ADSC9   G@ACC_PKD,,AUTO          cn=0,n=200

     1964    24368
     1965    24369        /* now pack up the binary values.
     1966    24370        */
     1967    24371    3              CALL I$8TO9(G$ACC_UNPK.SYSID,G@ACC_PKD.SYSID,2,1);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:379  
  24371 11 004021   000103 236000 12                 LDQ     67
        11 004022   200420 756100                    STQ     @BYTES+1,,AUTO
        11 004023   000042 236000 12                 LDQ     34
        11 004024   200417 756100                    STQ     @DEST+1,,AUTO
        11 004025   200426 452500                    STP2    T$+1,,AUTO
        11 004026   200426 236100                    LDQ     T$+1,,AUTO
        11 004027   000104 036000 12                 ADLQ    68
        11 004030   200416 756100                    STQ     @TERMID+1,,AUTO
        11 004031   000000 236000 xsym               LDQ     KL_RDBF$
        11 004032   000105 036000 12                 ADLQ    69
        11 004033   200415 756100                    STQ     KBERR+11,,AUTO
        11 004034   011530 701000 11                 TSX1    I$8TO9
        11 004035   000000 011000                    NOP     0

     1968    24372    3              CALL I$8TO9(G$ACC_UNPK.START,G@ACC_PKD.START,4,8);

  24372 11 004036   000106 236000 12                 LDQ     70
        11 004037   200420 756100                    STQ     @BYTES+1,,AUTO
        11 004040   000050 236000 12                 LDQ     40
        11 004041   200417 756100                    STQ     @DEST+1,,AUTO
        11 004042   200105 630500                    EPPR0   G@ACC_PKD+15,,AUTO
        11 004043   200416 450500                    STP0    @TERMID+1,,AUTO
        11 004044   000000 236000 xsym               LDQ     KL_RDBF$
        11 004045   000020 036003                    ADLQ    16,DU
        11 004046   200415 756100                    STQ     KBERR+11,,AUTO
        11 004047   011530 701000 11                 TSX1    I$8TO9
        11 004050   000000 011000                    NOP     0

     1969    24373        /* START, STOP, USER_EX, USER_SV, UMEM, PROC_EX, PROC_SV, PROC_MEM */
     1970    24374    3              CALL I$8TO9(G$ACC_UNPK.PEAK_MEM,G@ACC_PKD.PEAK_MEM,2,8);

  24374 11 004051   000106 236000 12                 LDQ     70
        11 004052   200420 756100                    STQ     @BYTES+1,,AUTO
        11 004053   000042 236000 12                 LDQ     34
        11 004054   200417 756100                    STQ     @DEST+1,,AUTO
        11 004055   200117 630500                    EPPR0   G@ACC_PKD+25,,AUTO
        11 004056   200416 450500                    STP0    @TERMID+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:380  
        11 004057   000000 236000 xsym               LDQ     KL_RDBF$
        11 004060   000032 036003                    ADLQ    26,DU
        11 004061   200415 756100                    STQ     KBERR+11,,AUTO
        11 004062   011530 701000 11                 TSX1    I$8TO9
        11 004063   000000 011000                    NOP     0

     1971    24375        /* PK_MEM, PK_LVLS, MCLS, FEP#, STEPUNIT(0:3) */
     1972    24376    3              CALL I$8TO9(G$ACC_UNPK.READS_HOST,G@ACC_PKD.READS_HOST,4,4);

  24376 11 004064   000050 236000 12                 LDQ     40
        11 004065   200420 756100                    STQ     @BYTES+1,,AUTO
        11 004066   200417 756100                    STQ     @DEST+1,,AUTO
        11 004067   200125 630500                    EPPR0   G@ACC_PKD+31,,AUTO
        11 004070   200416 450500                    STP0    @TERMID+1,,AUTO
        11 004071   000000 236000 xsym               LDQ     KL_RDBF$
        11 004072   000040 036003                    ADLQ    32,DU
        11 004073   200415 756100                    STQ     KBERR+11,,AUTO
        11 004074   011530 701000 11                 TSX1    I$8TO9
        11 004075   000000 011000                    NOP     0

     1973    24377        /* READS_HOST, WRITES_HOST, READS_UC, WRITES_UC */
     1974    24378    3              CALL I$8TO9(G$ACC_UNPK.STEP,G@ACC_PKD.STEP,2,1);

  24378 11 004076   000103 236000 12                 LDQ     67
        11 004077   200420 756100                    STQ     @BYTES+1,,AUTO
        11 004100   000042 236000 12                 LDQ     34
        11 004101   200417 756100                    STQ     @DEST+1,,AUTO
        11 004102   200142 630500                    EPPR0   G@ACC_PKD+44,,AUTO
        11 004103   200416 450500                    STP0    @TERMID+1,,AUTO
        11 004104   000000 236000 xsym               LDQ     KL_RDBF$
        11 004105   000055 036003                    ADLQ    45,DU
        11 004106   200415 756100                    STQ     KBERR+11,,AUTO
        11 004107   011530 701000 11                 TSX1    I$8TO9
        11 004110   000000 011000                    NOP     0

     1975    24379
     1976    24380        /* convert FEP UTSs to Host UTSs.
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:381  
     1977    24381        */
     1978    24382    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.START);

  24382 11 004111   777640 235007                    LDA     -96,DL
        11 004112   200426 452500                    STP2    T$+1,,AUTO
        11 004113   200426 236100                    LDQ     T$+1,,AUTO
        11 004114   000105 036003                    ADLQ    69,DU
        11 004115   000244 757000 7                  STAQ    FPT_TIME+8

     1979    24383    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;

  24383 11 004116   000234 630400 7                  EPPR0   FPT_TIME
        11 004117   420004 713400                    CLIMB   alt,+8196
        11 004120   402000 401760                    pmme    nvectors=5
        11 004121   004123 702000 11                 TSX2    s:24385
        11 004122   004123 710000 11                 TRA     s:24385

     1980    24384
     1981    24385    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.STOP);

  24385 11 004123   777640 235007                    LDA     -96,DL
        11 004124   200426 452500                    STP2    T$+1,,AUTO
        11 004125   200426 236100                    LDQ     T$+1,,AUTO
        11 004126   000106 036003                    ADLQ    70,DU
        11 004127   000244 757000 7                  STAQ    FPT_TIME+8

     1982    24386    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;

  24386 11 004130   000234 630400 7                  EPPR0   FPT_TIME
        11 004131   420004 713400                    CLIMB   alt,+8196
        11 004132   402000 401760                    pmme    nvectors=5
        11 004133   004135 702000 11                 TSX2    s:24388
        11 004134   004135 710000 11                 TRA     s:24388

     1983    24387
     1984    24388    3              G@ACC_PKD.USER_EXTIME = (G@ACC_PKD.USER_EXTIME * 5) / 6;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:382  
  24388 11 004135   200107 236100                    LDQ     G@ACC_PKD+17,,AUTO
        11 004136   000005 402007                    MPY     5,DL
        11 004137   000001 772000                    QRL     1
        11 004140   000003 506007                    DIV     3,DL
        11 004141   200107 756100                    STQ     G@ACC_PKD+17,,AUTO

     1985    24389
     1986    24390    3              G@ACC_PKD.USER_SVTIME = (G@ACC_PKD.USER_SVTIME * 5) / 6;

  24390 11 004142   200110 236100                    LDQ     G@ACC_PKD+18,,AUTO
        11 004143   000005 402007                    MPY     5,DL
        11 004144   000001 772000                    QRL     1
        11 004145   000003 506007                    DIV     3,DL
        11 004146   200110 756100                    STQ     G@ACC_PKD+18,,AUTO

     1987    24391
     1988    24392    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.USER_MEMTIME);

  24392 11 004147   777640 235007                    LDA     -96,DL
        11 004150   200426 452500                    STP2    T$+1,,AUTO
        11 004151   200426 236100                    LDQ     T$+1,,AUTO
        11 004152   000111 036003                    ADLQ    73,DU
        11 004153   000244 757000 7                  STAQ    FPT_TIME+8

     1989    24393    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;

  24393 11 004154   000234 630400 7                  EPPR0   FPT_TIME
        11 004155   420004 713400                    CLIMB   alt,+8196
        11 004156   402000 401760                    pmme    nvectors=5
        11 004157   004161 702000 11                 TSX2    s:24395
        11 004160   004161 710000 11                 TRA     s:24395

     1990    24394
     1991    24395    3              G@ACC_PKD.PROC_EXTIME = (G@ACC_PKD.PROC_EXTIME * 5) / 6;

  24395 11 004161   200112 236100                    LDQ     G@ACC_PKD+20,,AUTO
        11 004162   000005 402007                    MPY     5,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:383  
        11 004163   000001 772000                    QRL     1
        11 004164   000003 506007                    DIV     3,DL
        11 004165   200112 756100                    STQ     G@ACC_PKD+20,,AUTO

     1992    24396
     1993    24397    3              G@ACC_PKD.PROC_SVTIME = (G@ACC_PKD.PROC_SVTIME * 5) / 6;

  24397 11 004166   200113 236100                    LDQ     G@ACC_PKD+21,,AUTO
        11 004167   000005 402007                    MPY     5,DL
        11 004170   000001 772000                    QRL     1
        11 004171   000003 506007                    DIV     3,DL
        11 004172   200113 756100                    STQ     G@ACC_PKD+21,,AUTO

     1994    24398
     1995    24399    3              FPT_TIME.TSTAMP_ = VECTOR(G@ACC_PKD.PROC_MEMTIME);

  24399 11 004173   777640 235007                    LDA     -96,DL
        11 004174   200426 452500                    STP2    T$+1,,AUTO
        11 004175   200426 236100                    LDQ     T$+1,,AUTO
        11 004176   000114 036003                    ADLQ    76,DU
        11 004177   000244 757000 7                  STAQ    FPT_TIME+8

     1996    24400    4              CALL M$TIME(FPT_TIME) WHENALTRETURN DO; END;

  24400 11 004200   000234 630400 7                  EPPR0   FPT_TIME
        11 004201   420004 713400                    CLIMB   alt,+8196
        11 004202   402000 401760                    pmme    nvectors=5
        11 004203   004205 702000 11                 TSX2    s:24404
        11 004204   004205 710000 11                 TRA     s:24404

     1997    24401
     1998    24402        /* Convert the error code.
     1999    24403        */
     2000    24404    3              CALL XUR$ERRCNVRT(G$ACC_UNPK.ERR,G@ACC_PKD.ERR);

  24404 11 004205   200123 630500                    EPPR0   G@ACC_PKD+29,,AUTO
        11 004206   200427 450500                    STP0    T$+2,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:384  
        11 004207   000000 236000 xsym               LDQ     KL_RDBF$
        11 004210   000036 036003                    ADLQ    30,DU
        11 004211   200426 756100                    STQ     T$+1,,AUTO
        11 004212   200426 630500                    EPPR0   T$+1,,AUTO
        11 004213   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 004214   000000 701000 xent               TSX1    XUR$ERRCNVRT
        11 004215   000000 011000                    NOP     0

     2001    24405    3              LOGOFF$PARAM.CODE = G@ACC_PKD.TYPE;

  24405 11 004216   200066 236100                    LDQ     G@ACC_PKD,,AUTO
        11 004217   000022 772000                    QRL     18
        11 004220   000777 376007                    ANQ     511,DL
        11 004221   200150 756100                    STQ     LOGOFF$PARAM,,AUTO

     2002    24406    3              LOGOFF$PARAM.DCB1 = DCBNUM(M$DO);

  24406 11 004222   000000 236007 xsym               LDQ     M$DO,DL
        11 004223   000000 620006                    EAX0    0,QL
        11 004224   200152 740100                    STX0    LOGOFF$PARAM+2,,AUTO

     2003    24407    3              LOGOFF$PARAM.DCB_LL = 0;

  24407 11 004225   000000 221003                    LDX1    0,DU
        11 004226   200152 441100                    SXL1    LOGOFF$PARAM+2,,AUTO

     2004    24408    3              LOGOFF$PARAM.ACCUM_CHG = 0;

  24408 11 004227   200155 450100                    STZ     LOGOFF$PARAM+5,,AUTO

     2005    24409    3              LOGOFF$PARAM.JIT$ = ADDR(G@ACC_PKD);

  24409 11 004230   200066 630500                    EPPR0   G@ACC_PKD,,AUTO
        11 004231   200154 450500                    STP0    LOGOFF$PARAM+4,,AUTO

     2006    24410    3              CALL AZA$FEPACCTNG (LOGOFF$PARAM);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:385  
  24410 11 004232   200150 631500                    EPPR1   LOGOFF$PARAM,,AUTO
        11 004233   200426 451500                    STP1    T$+1,,AUTO
        11 004234   200426 630500                    EPPR0   T$+1,,AUTO
        11 004235   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 004236   000000 701000 xent               TSX1    AZA$FEPACCTNG
        11 004237   000000 011000                    NOP     0

     2007    24411    3              G@ACC_PKD.CHG = LOGOFF$PARAM.ACCUM_CHG;

  24411 11 004240   200155 235100                    LDA     LOGOFF$PARAM+5,,AUTO
        11 004241   200147 755100                    STA     G@ACC_PKD+49,,AUTO

     2008    24412    3              WRT_ACCTLG.BUF_ = VECTOR(G@ACC_PKD);

  24412 11 004242   000060 235000 12                 LDA     48
        11 004243   200426 452500                    STP2    T$+1,,AUTO
        11 004244   200426 236100                    LDQ     T$+1,,AUTO
        11 004245   000066 036003                    ADLQ    54,DU
        11 004246   000224 757000 7                  STAQ    WRT_ACCTLG+4

     2009    24413    4              CALL M$WRITE(WRT_ACCTLG) WHENALTRETURN DO;

  24413 11 004247   000220 630400 7                  EPPR0   WRT_ACCTLG
        11 004250   440001 713400                    CLIMB   alt,write
        11 004251   401400 401760                    pmme    nvectors=4
        11 004252   004254 702000 11                 TSX2    s:24414
        11 004253   004263 710000 11                 TRA     s:24417

     2010    24414    4                   WKBER.BUF_ = VECTOR(FEPACCTL);

  24414 11 004254   000110 237000 12                 LDAQ    72
        11 004255   000426 757000 7                  STAQ    WKBER+4

     2011    24415    5                   CALL M$WRITE(WKBER) WHENALTRETURN DO;

  24415 11 004256   000422 630400 7                  EPPR0   WKBER
        11 004257   440001 713400                    CLIMB   alt,write
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:386  
        11 004260   401400 401760                    pmme    nvectors=4
        11 004261   004263 702000 11                 TSX2    s:24417
        11 004262   004263 710000 11                 TRA     s:24417

     2012    24416    5                      END;

     2013    24417    4                 END;

  24417 11 004263   010045 710000 11                 TRA     s:25129

     2014    24418    3           CASE(EL_ERR);                   /* error logging*/

     2015    24419    3              FEPERR.STATDATA.NODE = FEX;

  24419 11 004264   200025 236100                    LDQ     FEX,,AUTO
        11 004265   000024 736000                    QLS     20
        11 004266   200304 676100                    ERQ     FEPERR,,AUTO
        11 004267   777774 376003                    ANQ     -4,DU
        11 004270   200304 656100                    ERSQ    FEPERR,,AUTO

     2016    24420    3              FEPERR.STATDATA.VALUES = KL$SYSLOG.ERRLOG.VALUES;

  24420 11 004271   000100 100500                    MLR     fill='000'O
        11 004272   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
        11 004273   200307 000010                    ADSC9   FEPERR+3,,AUTO           cn=0,n=8

     2017    24421    3              FEPERR.STATDATA.TERMID = KL$SYSLOG.ERRLOG.TERMID;

  24421 11 004274   000100 100500                    MLR     fill='000'O
        11 004275   000003 000020                    ADSC9   3,,PR0                   cn=0,n=16
        11 004276   200311 000020                    ADSC9   FEPERR+5,,AUTO           cn=0,n=16

     2018    24422    3              FEPERR.STATDATA.UTS = KL$SYSLOG.ERRLOG.UTS;

  24422 11 004277   000002 236100                    LDQ     2,,PR0
        11 004300   000004 736000                    QLS     4
        11 004301   200306 676100                    ERQ     FEPERR+2,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:387  
        11 004302   000112 376000 12                 ANQ     74
        11 004303   200306 656100                    ERSQ    FEPERR+2,,AUTO

     2019    24423    3              SIZE = KL$SYSLOG.ERRLOG.DATA_SIZE;

  24423 11 004304   000011 236100                    LDQ     9,,PR0
        11 004305   000033 772000                    QRL     27
        11 004306   200024 756100                    STQ     SIZE,,AUTO

     2020    24424    3              FEPERR.X.DYMDATA = KL$SYSLOG.ERRLOG.DATA;

  24424 11 004307   000000 620006                    EAX0    0,QL
        11 004310   040100 100540                    MLR     fill='040'O
        11 004311   000011 200010                    ADSC9   9,,PR0                   cn=1,n=*X0
        11 004312   200315 000144                    ADSC9   FEPERR+9,,AUTO           cn=0,n=100

     2021    24425    3              CALL XUR$ERRCNVRT (KL$SYSLOG.ERRLOG.ERRCODE,FEPERR.STATDATA.ERRCODE);

  24425 11 004313   200305 631500                    EPPR1   FEPERR+1,,AUTO
        11 004314   200427 451500                    STP1    T$+2,,AUTO
        11 004315   000000 236000 xsym               LDQ     KL_RDBF$
        11 004316   000001 036003                    ADLQ    1,DU
        11 004317   200426 756100                    STQ     T$+1,,AUTO
        11 004320   200426 630500                    EPPR0   T$+1,,AUTO
        11 004321   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 004322   000000 701000 xent               TSX1    XUR$ERRCNVRT
        11 004323   000000 011000                    NOP     0

     2022    24426    3              FPT_WRFEPERR.V.SIZE# = MINIMUM((KL$SYSLOG.ERRLOG.DATA_SIZE+3)/4,SIZEW(
             24426                       FEPERR.X.DYMDATA)) +

  24426 11 004324   000000 470400 xsym               LDP0    KL_RDBF$
        11 004325   000011 236100                    LDQ     9,,PR0
        11 004326   000033 772000                    QRL     27
        11 004327   000003 036007                    ADLQ    3,DL
        11 004330   000002 772000                    QRL     2
        11 004331   000031 116007                    CMPQ    25,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:388  
        11 004332   004335 602000 11                 TNC     s:24426+9
        11 004333   004335 600000 11                 TZE     s:24426+9
        11 004334   000031 236007                    LDQ     25,DL
        11 004335   000011 036007                    ADLQ    9,DL
        11 004336   000302 756000 7                  STQ     FPT_WRFEPERR+6

     2023    24427    3                   SIZEW(FEPERR) - SIZEW(FEPERR.X.DYMDATA);
     2024    24428    3              FPT_WRFEPERR.ENTRY_ = VECTOR(FEPERR);

  24428 11 004337   000113 235000 12                 LDA     75
        11 004340   200426 452500                    STP2    T$+1,,AUTO
        11 004341   200426 236100                    LDQ     T$+1,,AUTO
        11 004342   000304 036003                    ADLQ    196,DU
        11 004343   000276 757000 7                  STAQ    FPT_WRFEPERR+2

     2025    24429    4              CALL M$WRSYSLOG (FPT_WRFEPERR) WHENALTRETURN DO; END;

  24429 11 004344   000274 630400 7                  EPPR0   FPT_WRFEPERR
        11 004345   470001 713400                    CLIMB   alt,+28673
        11 004346   400400 401760                    pmme    nvectors=2
        11 004347   004351 702000 11                 TSX2    s:24429+5
        11 004350   004351 710000 11                 TRA     s:24429+5

  24429 11 004351   010045 710000 11                 TRA     s:25129

     2026    24430    3           CASE(EL_SEC);

     2027    24431    3              CALL JMU$SETSEG(ES$,%SPCL1SID);

  24431 11 004352   000115 630400 12                 EPPR0   77
        11 004353   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 004354   000000 701000 xent               TSX1    JMU$SETSEG
        11 004355   000000 011000                    NOP     0

     2028    24432    3              IF ES$->LOGSYSACCT >= %PC_ES_FAILED# THEN

  24432 11 004356   000726 470400 7                  LDP0    ES$
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:389  
        11 004357   000000 235100                    LDA     0,,PR0
        11 004360   000003 115007                    CMPA    3,DL
        11 004361   010045 602000 11                 TNC     s:25129

     2029    24433    4              DO;

     2030    24434
     2031    24435    4                   ES$SECLOG.REASON=%ES_JUNK_LOGON#;

  24435 11 004362   004000 236003                    LDQ     2048,DU
        11 004363   000635 552040 7                  STBQ    ES$SECLOG,'40'O

     2032    24436    4                   ES$SECLOG.GRANTED='0'B;

  24436 11 004364   000117 236000 12                 LDQ     79
        11 004365   000635 356000 7                  ANSQ    ES$SECLOG

     2033    24437    4                   ES$SECLOG.MODE=0;

  24437 11 004366   000120 236000 12                 LDQ     80
        11 004367   000636 356000 7                  ANSQ    ES$SECLOG+1

     2034    24438    4                   ES$SECLOG.ACCN = ' ';

  24438 11 004370   000035 235000 xsym               LDA     B_VECTNIL+29
        11 004371   000035 236000 xsym               LDQ     B_VECTNIL+29
        11 004372   000637 755000 7                  STA     ES$SECLOG+2
        11 004373   000640 756000 7                  STQ     ES$SECLOG+3

     2035    24439    4                   ES$SECLOG.UNAME = ' ';

  24439 11 004374   040000 100400                    MLR     fill='040'O
        11 004375   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 004376   000641 000014 7                  ADSC9   ES$SECLOG+4              cn=0,n=12

     2036    24440    4                   ES$SECLOG.PASSWORD = ' ';

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:390  
  24440 11 004377   000035 235000 xsym               LDA     B_VECTNIL+29
        11 004400   000035 236000 xsym               LDQ     B_VECTNIL+29
        11 004401   000644 757000 7                  STAQ    ES$SECLOG+7

     2037    24441    4                   ES$SECLOG.PRIV='0'B;

  24441 11 004402   000651 450000 7                  STZ     ES$SECLOG+12

     2038    24442    4                   ES$SECLOG.PPRIV='0'B;

  24442 11 004403   000652 450000 7                  STZ     ES$SECLOG+13

     2039    24443    4                   ES$SECLOG.LOGON.L = 0;

  24443 11 004404   000000 236003                    LDQ     0,DU
        11 004405   000655 552040 7                  STBQ    ES$SECLOG+16,'40'O

     2040    24444    4                   ES$SECLOG.LOGON.C = ' ';

  24444 11 004406   040000 100400                    MLR     fill='040'O
        11 004407   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 004410   000655 200037 7                  ADSC9   ES$SECLOG+16             cn=1,n=31

     2041    24445
     2042    24446    4                   ES$SECLOG.LOGON.L=KL$SYSLOG.ERRLOG.DATA_SIZE;

  24446 11 004411   000000 471400 xsym               LDP1    KL_RDBF$
        11 004412   100011 236100                    LDQ     9,,PR1
        11 004413   000655 552040 7                  STBQ    ES$SECLOG+16,'40'O

     2043    24447    4                   SIZE = KL$SYSLOG.ERRLOG.DATA_SIZE;

  24447 11 004414   100011 236100                    LDQ     9,,PR1
        11 004415   000033 772000                    QRL     27
        11 004416   200024 756100                    STQ     SIZE,,AUTO

     2044    24448    4                   IF ES$SECLOG.LOGON.L > LENGTHC(ES$SECLOG.LOGON.C) THEN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:391  

  24448 11 004417   000655 236000 7                  LDQ     ES$SECLOG+16
        11 004420   777000 376003                    ANQ     -512,DU
        11 004421   040000 116003                    CMPQ    16384,DU
        11 004422   004425 602000 11                 TNC     s:24450

     2045    24449    4                        ES$SECLOG.LOGON.L=LENGTHC(ES$SECLOG.LOGON.C);

  24449 11 004423   037000 236003                    LDQ     15872,DU
        11 004424   000655 552040 7                  STBQ    ES$SECLOG+16,'40'O

     2046    24450    4                   ES$SECLOG.LOGON.C=KL$SYSLOG.ERRLOG.DATA;

  24450 11 004425   200024 720100                    LXL0    SIZE,,AUTO
        11 004426   040000 100540                    MLR     fill='040'O
        11 004427   100011 200010                    ADSC9   9,,PR1                   cn=1,n=*X0
        11 004430   000655 200037 7                  ADSC9   ES$SECLOG+16             cn=1,n=31

     2047    24451    4                   ES$SECLOG.TSLINE.FEX=KL$SYSLOG.ERRLOG.VALUES(0);

  24451 11 004431   100007 236100                    LDQ     7,,PR1
        11 004432   000011 736000                    QLS     9
        11 004433   000671 552040 7                  STBQ    ES$SECLOG+28,'40'O

     2048    24452    4                   ES$SECLOG.TSLINE.LEV=KL$SYSLOG.ERRLOG.TERMID.LEV;

  24452 11 004434   100003 236100                    LDQ     3,,PR1
        11 004435   000022 772000                    QRL     18
        11 004436   000671 552004 7                  STBQ    ES$SECLOG+28,'04'O

     2049    24453    4                   CALL KLX$8TO9(KL$SYSLOG.ERRLOG.TERMID.TERM.CHANNEL,

  24453 11 004437   000042 236000 12                 LDQ     34
        11 004440   200430 756100                    STQ     T$+3,,AUTO
        11 004441   000121 236000 12                 LDQ     81
        11 004442   200427 756100                    STQ     T$+2,,AUTO
        11 004443   000000 236000 xsym               LDQ     KL_RDBF$
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:392  
        11 004444   000100 036000 12                 ADLQ    64
        11 004445   200426 756100                    STQ     T$+1,,AUTO
        11 004446   200426 630500                    EPPR0   T$+1,,AUTO
        11 004447   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 004450   000000 701000 xent               TSX1    KLX$8TO9
        11 004451   000000 011000                    NOP     0

     2050    24454    4                        ES$SECLOG.TSLINE.PORT,2);
     2051    24455    4                   CALL KLX$8TO9(KL$SYSLOG.ERRLOG.TERMID.TERM.SUBDEVICE,

  24455 11 004452   000042 236000 12                 LDQ     34
        11 004453   200430 756100                    STQ     T$+3,,AUTO
        11 004454   000122 236000 12                 LDQ     82
        11 004455   200427 756100                    STQ     T$+2,,AUTO
        11 004456   000000 236000 xsym               LDQ     KL_RDBF$
        11 004457   000004 036003                    ADLQ    4,DU
        11 004460   200426 756100                    STQ     T$+1,,AUTO
        11 004461   200426 630500                    EPPR0   T$+1,,AUTO
        11 004462   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 004463   000000 701000 xent               TSX1    KLX$8TO9
        11 004464   000000 011000                    NOP     0

     2052    24456    4                        ES$SECLOG.TSLINE.SUBDEVICE,2);
     2053    24457    4                   CALL KLX$8TO9(KL$SYSLOG.ERRLOG.TERMID.TERM.SUBSUBDEVICE,

  24457 11 004465   000042 236000 12                 LDQ     34
        11 004466   200430 756100                    STQ     T$+3,,AUTO
        11 004467   000123 236000 12                 LDQ     83
        11 004470   200427 756100                    STQ     T$+2,,AUTO
        11 004471   000000 236000 xsym               LDQ     KL_RDBF$
        11 004472   000124 036000 12                 ADLQ    84
        11 004473   200426 756100                    STQ     T$+1,,AUTO
        11 004474   200426 630500                    EPPR0   T$+1,,AUTO
        11 004475   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 004476   000000 701000 xent               TSX1    KLX$8TO9
        11 004477   000000 011000                    NOP     0

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:393  
     2054    24458    4                        ES$SECLOG.TSLINE.SUBSUBDEVICE,2);
     2055    24459    4                   CALL M$WRSYSLOG(WR_SECLOG);

  24459 11 004500   000716 630400 7                  EPPR0   WR_SECLOG
        11 004501   070001 713400                    CLIMB   28673
        11 004502   400400 401760                    pmme    nvectors=2

     2056    24460    4                 END;

     2057    24461    3           END;

  24461 11 004503   010045 710000 11                 TRA     s:25129

     2058    24462
     2059    24463        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:394  
     2060    24464    2        CASE(IGA_ERRMSG_RQS);

     2061    24465    2           FPT@ERRMSG = FPT_ERRMSG;

  24465 11 004504   000100 100400                    MLR     fill='000'O
        11 004505   000142 000150 10                 ADSC9   FPT_ERRMSG               cn=0,n=104
        11 004506   200242 000150                    ADSC9   FPT@ERRMSG,,AUTO         cn=0,n=104

     2062    24466    2           FPT@ERRMSG.V_ = VECTOR(FPT@ERRMSG.V);

  24466 11 004507   000125 235000 12                 LDA     85
        11 004510   200426 452500                    STP2    T$+1,,AUTO
        11 004511   200426 236100                    LDQ     T$+1,,AUTO
        11 004512   000270 036003                    ADLQ    184,DU
        11 004513   200242 757100                    STAQ    FPT@ERRMSG,,AUTO

     2063    24467    2           FPT@ERRMSG.CODE_ = VECTOR(KL$ERRMSG_RQS.ERR);

  24467 11 004514   777640 235007                    LDA     -96,DL
        11 004515   000000 236000 xsym               LDQ     KL_RDBF$
        11 004516   000002 036003                    ADLQ    2,DU
        11 004517   200244 757100                    STAQ    FPT@ERRMSG+2,,AUTO

     2064    24468    2           FPT@ERRMSG.BUF_ = VECTOR(KL@ERRMSG_RSP.MESSAGE);

  24468 11 004520   000126 235000 12                 LDA     86
        11 004521   200426 452500                    STP2    T$+1,,AUTO
        11 004522   200426 236100                    LDQ     T$+1,,AUTO
        11 004523   000163 036003                    ADLQ    115,DU
        11 004524   200246 757100                    STAQ    FPT@ERRMSG+4,,AUTO

     2065    24469    2           FPT@ERRMSG.RESULTS_ = VECTOR(VLR@ERRMSG);

  24469 11 004525   000125 235000 12                 LDA     85
        11 004526   200426 452500                    STP2    T$+1,,AUTO
        11 004527   200426 236100                    LDQ     T$+1,,AUTO
        11 004530   000274 036003                    ADLQ    188,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:395  
        11 004531   200264 757100                    STAQ    FPT@ERRMSG+18,,AUTO

     2066    24470    2           FPT@ERRMSG.V.L6_CODE# = '1'B;

  24470 11 004532   000004 236007                    LDQ     4,DL
        11 004533   200272 256100                    ORSQ    FPT@ERRMSG+24,,AUTO

     2067    24471    2           FPT@ERRMSG.V.INCLCODE# = KL$ERRMSG_RQS.INCLCODE;

  24471 11 004534   000000 470400 xsym               LDP0    KL_RDBF$
        11 004535   000000 236100                    LDQ     0,,PR0
        11 004536   000033 736000                    QLS     27
        11 004537   200272 676100                    ERQ     FPT@ERRMSG+24,,AUTO
        11 004540   004000 376003                    ANQ     2048,DU
        11 004541   200272 656100                    ERSQ    FPT@ERRMSG+24,,AUTO

     2068    24472    2           FPT@ERRMSG.V.SUBMESS# = KL$ERRMSG_RQS.SUBMESS;

  24472 11 004542   000000 236100                    LDQ     0,,PR0
        11 004543   000030 736000                    QLS     24
        11 004544   200272 676100                    ERQ     FPT@ERRMSG+24,,AUTO
        11 004545   001000 376003                    ANQ     512,DU
        11 004546   200272 656100                    ERSQ    FPT@ERRMSG+24,,AUTO

     2069    24473    2           FPT@ERRMSG.V.SUBFILE# = KL$ERRMSG_RQS.SUBFILE;

  24473 11 004547   000000 236100                    LDQ     0,,PR0
        11 004550   000036 736000                    QLS     30
        11 004551   200272 676100                    ERQ     FPT@ERRMSG+24,,AUTO
        11 004552   200000 376003                    ANQ     65536,DU
        11 004553   200272 656100                    ERSQ    FPT@ERRMSG+24,,AUTO

     2070    24474    2           FPT@ERRMSG.V.SUBLANG# = KL$ERRMSG_RQS.SUBLANG;

  24474 11 004554   000000 236100                    LDQ     0,,PR0
        11 004555   000010 736000                    QLS     8
        11 004556   200272 676100                    ERQ     FPT@ERRMSG+24,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:396  
        11 004557   020000 376007                    ANQ     8192,DL
        11 004560   200272 656100                    ERSQ    FPT@ERRMSG+24,,AUTO

     2071    24475    2           FPT@ERRMSG.V.LEAVETOKEN# = KL$ERRMSG_RQS.LEAVE_TOKEN;

  24475 11 004561   000000 236100                    LDQ     0,,PR0
        11 004562   000035 736000                    QLS     29
        11 004563   200272 676100                    ERQ     FPT@ERRMSG+24,,AUTO
        11 004564   400000 376003                    ANQ     -131072,DU
        11 004565   200272 656100                    ERSQ    FPT@ERRMSG+24,,AUTO

     2072    24476
     2073    24477    2           IF KL$ERRMSG_RQS.ALTCODE_EXISTS

  24477 11 004566   000000 236100                    LDQ     0,,PR0
        11 004567   000002 316007                    CANQ    2,DL
        11 004570   004577 600000 11                 TZE     s:24483

     2074    24478    3           THEN DO;

     2075    24479    3                FPT@ERRMSG.ALTCODE_ = VECTOR(KL$ERRMSG_RQS.ALTERR);

  24479 11 004571   777640 235007                    LDA     -96,DL
        11 004572   000000 236000 xsym               LDQ     KL_RDBF$
        11 004573   000003 036003                    ADLQ    3,DU
        11 004574   200266 757100                    STAQ    FPT@ERRMSG+20,,AUTO

     2076    24480    3                FPT@ERRMSG.V.L6_ALTCODE# = '1'B;

  24480 11 004575   000002 236007                    LDQ     2,DL
        11 004576   200272 256100                    ORSQ    FPT@ERRMSG+24,,AUTO

     2077    24481    3              END;

     2078    24482
     2079    24483    2           IF KL$ERRMSG_RQS.LANG ~= B$JIT$->B$JIT.LANG

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:397  
  24483 11 004577   000000 471400 xsym               LDP1    B$JIT$
        11 004600   040100 106500                    CMPC    fill='040'O
        11 004601   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
        11 004602   100145 600001                    ADSC9   101,,PR1                 cn=3,n=1
        11 004603   004611 600000 11                 TZE     s:24489

     2080    24484    3           THEN DO;

     2081    24485    3                FPT@ERRMSG.V.MY_LANG# = '0'B;

  24485 11 004604   000127 236000 12                 LDQ     87
        11 004605   200272 356100                    ANSQ    FPT@ERRMSG+24,,AUTO

     2082    24486    3                FPT@ERRMSG.V.LANG# = KL$ERRMSG_RQS.LANG;

  24486 11 004606   000000 236100                    LDQ     0,,PR0
        11 004607   000022 736000                    QLS     18
        11 004610   200273 552140                    STBQ    FPT@ERRMSG+25,'40'O,AUTO

     2083    24487    3              END;

     2084    24488
     2085    24489    2           IF KL$ERRMSG_RQS.FID_EXISTS

  24489 11 004611   000000 236100                    LDQ     0,,PR0
        11 004612   000001 316007                    CANQ    1,DL
        11 004613   004640 600000 11                 TZE     s:24498

     2086    24490    3           THEN DO;

     2087    24491    3                FPT@ERRMSG.FILENAME_ = VECTOR(KL$ERRMSG_RQS.FILENAME);

  24491 11 004614   000130 235000 12                 LDA     88
        11 004615   000000 236000 xsym               LDQ     KL_RDBF$
        11 004616   000004 036003                    ADLQ    4,DU
        11 004617   200250 757100                    STAQ    FPT@ERRMSG+6,,AUTO

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:398  
     2088    24492    3                IF KL$ERRMSG_RQS.FILEACCT ~= ' '

  24492 11 004620   040000 106500                    CMPC    fill='040'O
        11 004621   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8
        11 004622   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 004623   004630 600000 11                 TZE     s:24494

     2089    24493    3                THEN FPT@ERRMSG.FILEACCT_ = VECTOR(KL$ERRMSG_RQS.FILEACCT);

  24493 11 004624   000131 235000 12                 LDA     89
        11 004625   000000 236000 xsym               LDQ     KL_RDBF$
        11 004626   000014 036003                    ADLQ    12,DU
        11 004627   200252 757100                    STAQ    FPT@ERRMSG+8,,AUTO

     2090    24494    3                IF KL$ERRMSG_RQS.FILEPASS ~= ' '

  24494 11 004630   040000 106500                    CMPC    fill='040'O
        11 004631   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
        11 004632   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 004633   004640 600000 11                 TZE     s:24498

     2091    24495    3                THEN FPT@ERRMSG.FILEPASS_ = VECTOR(KL$ERRMSG_RQS.FILEPASS);

  24495 11 004634   000132 235000 12                 LDA     90
        11 004635   000000 236000 xsym               LDQ     KL_RDBF$
        11 004636   000016 036003                    ADLQ    14,DU
        11 004637   200254 757100                    STAQ    FPT@ERRMSG+10,,AUTO

     2092    24496    3              END;

     2093    24497
     2094    24498    2           CALL M$ERRMSG(FPT@ERRMSG)

  24498 11 004640   200242 630500                    EPPR0   FPT@ERRMSG,,AUTO
        11 004641   420000 713400                    CLIMB   alt,+8192
        11 004642   405000 401760                    pmme    nvectors=11
        11 004643   004645 702000 11                 TSX2    s:24503
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:399  
        11 004644   004645 710000 11                 TRA     s:24503

     2095    24499    3           WHENALTRETURN DO;

     2096    24500
     2097    24501    3              END;

     2098    24502
     2099    24503    2           KL@ERRMSG_RSP.FCN = IGA_ERRMSG_RSP;

  24503 11 004645   056000 236003                    LDQ     23552,DU
        11 004646   200161 552140                    STBQ    KL@ERRMSG_RSP,'40'O,AUTO

     2100    24504    2           KL@ERRMSG_RSP.USR# = KL$ERRMSG_RQS.USR#;

  24504 11 004647   000000 470400 xsym               LDP0    KL_RDBF$
        11 004650   000000 236100                    LDQ     0,,PR0
        11 004651   200161 552120                    STBQ    KL@ERRMSG_RSP,'20'O,AUTO

     2101    24505    2           KL@ERRMSG_RSP.CTX$ = KL$ERRMSG_RQS.CTX$;

  24505 11 004652   000001 236100                    LDQ     1,,PR0
        11 004653   200162 756100                    STQ     KL@ERRMSG_RSP+1,,AUTO

     2102    24506    2           KL@ERRMSG_RSP.NOFILE = VLR@ERRMSG.NOFILE;

  24506 11 004654   200274 236100                    LDQ     VLR@ERRMSG,,AUTO
        11 004655   000034 772000                    QRL     28
        11 004656   200161 676100                    ERQ     KL@ERRMSG_RSP,,AUTO
        11 004657   000100 376007                    ANQ     64,DL
        11 004660   200161 656100                    ERSQ    KL@ERRMSG_RSP,,AUTO

     2103    24507    2           KL@ERRMSG_RSP.NOMSG = VLR@ERRMSG.NOMSG;

  24507 11 004661   200274 236100                    LDQ     VLR@ERRMSG,,AUTO
        11 004662   000034 772000                    QRL     28
        11 004663   200161 676100                    ERQ     KL@ERRMSG_RSP,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:400  
        11 004664   000040 376007                    ANQ     32,DL
        11 004665   200161 656100                    ERSQ    KL@ERRMSG_RSP,,AUTO

     2104    24508    2           KL@ERRMSG_RSP.ALTMSG = VLR@ERRMSG.ALTMSG;

  24508 11 004666   200274 236100                    LDQ     VLR@ERRMSG,,AUTO
        11 004667   000034 772000                    QRL     28
        11 004670   200161 676100                    ERQ     KL@ERRMSG_RSP,,AUTO
        11 004671   000020 376007                    ANQ     16,DL
        11 004672   200161 656100                    ERSQ    KL@ERRMSG_RSP,,AUTO

     2105    24509    2           KL@ERRMSG_RSP.MSGCOMP = VLR@ERRMSG.MSGCOMP;

  24509 11 004673   200274 236100                    LDQ     VLR@ERRMSG,,AUTO
        11 004674   000034 772000                    QRL     28
        11 004675   200161 676100                    ERQ     KL@ERRMSG_RSP,,AUTO
        11 004676   000010 376007                    ANQ     8,DL
        11 004677   200161 656100                    ERSQ    KL@ERRMSG_RSP,,AUTO

     2106    24510    2           KL@ERRMSG_RSP.NNATIVE = VLR@ERRMSG.NNATIVE;

  24510 11 004700   200274 236100                    LDQ     VLR@ERRMSG,,AUTO
        11 004701   000032 772000                    QRL     26
        11 004702   200161 676100                    ERQ     KL@ERRMSG_RSP,,AUTO
        11 004703   000004 376007                    ANQ     4,DL
        11 004704   200161 656100                    ERSQ    KL@ERRMSG_RSP,,AUTO

     2107    24511    2           KL@ERRMSG_RSP.INERR = VLR@ERRMSG.INERR;

  24511 11 004705   200274 236100                    LDQ     VLR@ERRMSG,,AUTO
        11 004706   000032 772000                    QRL     26
        11 004707   200161 676100                    ERQ     KL@ERRMSG_RSP,,AUTO
        11 004710   000001 376007                    ANQ     1,DL
        11 004711   200161 656100                    ERSQ    KL@ERRMSG_RSP,,AUTO

     2108    24512
     2109    24513    3           DO J=119 DOWNTO 0;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:401  

  24513 11 004712   000167 235007                    LDA     119,DL
        11 004713   200011 755100                    STA     J,,AUTO

     2110    24514    3                IF KL@ERRMSG_RSP.MESSAGE(J) ~= ' ' THEN EXIT;

  24514 11 004714   200011 235100                    LDA     J,,AUTO
        11 004715   040000 106505                    CMPC    fill='040'O
        11 004716   200163 000001                    ADSC9   KL@ERRMSG_RSP+2,A,AUTO   cn=0,n=1
        11 004717   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 004720   004724 601000 11                 TNZ     s:24516

     2111    24515    3              END;

  24515 11 004721   000001 336007                    LCQ     1,DL
        11 004722   200011 056100                    ASQ     J,,AUTO
        11 004723   004714 605000 11                 TPL     s:24514

     2112    24516    2           KL@ERRMSG_RSP.MESSAGE_SZ = J+1;

  24516 11 004724   200011 236100                    LDQ     J,,AUTO
        11 004725   000001 036007                    ADLQ    1,DL
        11 004726   000011 736000                    QLS     9
        11 004727   200161 552110                    STBQ    KL@ERRMSG_RSP,'10'O,AUTO

     2113    24517    2           LEN = SIZEC(KL$ERRMSG_RSP) + J+1;

  24517 11 004730   200011 235100                    LDA     J,,AUTO
        11 004731   000011 035007                    ADLA    9,DL
        11 004732   200007 755100                    STA     LEN,,AUTO

     2114    24518
     2115    24519    2           CALL KLX$WRHLPNODE(KL@ERRMSG_RSP, LEN, FEX)

  24519 11 004733   200025 630500                    EPPR0   FEX,,AUTO
        11 004734   200430 450500                    STP0    T$+3,,AUTO
        11 004735   200007 631500                    EPPR1   LEN,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:402  
        11 004736   200427 451500                    STP1    T$+2,,AUTO
        11 004737   200161 633500                    EPPR3   KL@ERRMSG_RSP,,AUTO
        11 004740   200426 453500                    STP3    T$+1,,AUTO
        11 004741   200426 630500                    EPPR0   T$+1,,AUTO
        11 004742   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 004743   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 004744   004746 702000 11                 TSX2    s:24522
        11 004745   004746 710000 11                 TRA     s:24522

     2116    24520    3           WHENALTRETURN DO;

     2117    24521                    /*N*   */
     2118    24522    3              END;

  24522 11 004746   010045 710000 11                 TRA     s:25129

     2119    24523
     2120    24524        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:403  
     2121    24525    2        CASE(IGA_CONTROL_INIT);

     2122    24526    2           CALL BINCHAR(FEPNAME,FEX);

  24526 11 004747   200025 235100                    LDA     FEX,,AUTO
        11 004750   000044 773000                    LRL     36
        11 004751   200426 757100                    STAQ    T$+1,,AUTO
        11 004752   000100 301500                    BTD
        11 004753   200426 000010                    NDSC9   T$+1,,AUTO               cn=0,s=lsgnf,sf=0,n=8
        11 004754   200030 030010                    NDSC9   FEPNAME,,AUTO            cn=0,s=nosgn,sf=0,n=8

     2123    24527    3           IF KL$CONTROL_INIT.HANDLER = 'BABOON' THEN DO;

  24527 11 004755   200003 470500                    LDP0    RDBF$,,AUTO
        11 004756   040000 106500                    CMPC    fill='040'O
        11 004757   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        11 004760   000216 000006 10                 ADSC9   CKBR+12                  cn=0,n=6
        11 004761   005035 601000 11                 TNZ     s:24542

     2124    24528    3                KL_FEPCTL_KEY.NODE = FEX;

  24528 11 004762   200025 236100                    LDQ     FEX,,AUTO
        11 004763   000011 736000                    QLS     9
        11 004764   000202 552010 7                  STBQ    KL_FEPCTL_KEY,'10'O

     2125    24529    3                KL_RD_NETCON.KEY_ = VECTOR(KL_FEPCTL_KEY);

  24529 11 004765   000134 237000 12                 LDAQ    92
        11 004766   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     2126    24530    3                KL_RD_NETCON.BUF_ = VECTOR(KL_FEPCTL);

  24530 11 004767   000136 237000 12                 LDAQ    94
        11 004770   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     2127    24531    3                CALL M$READ(KL_RD_NETCON) ALTRET(NETCON_ALT);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:404  
  24531 11 004771   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 004772   440000 713400                    CLIMB   alt,read
        11 004773   401400 401760                    pmme    nvectors=4
        11 004774   005317 702000 11                 TSX2    NETCON_ALT

     2128    24532    3                IF KL_FEPCTL.NPARAMS = 0

  24532 11 004775   000203 235000 7                  LDA     KL_FEPCTL
        11 004776   005317 600000 11                 TZE     NETCON_ALT

     2129    24533    3                THEN
     2130    24534    3                     GOTO NETCON_ALT;
     2131    24535    3                KL$CONTROL_INIT.NUM_FPARAM = KL_FEPCTL.NPARAMS;

  24535 11 004777   000000 620005                    EAX0    0,AL
        11 005000   200003 470500                    LDP0    RDBF$,,AUTO
        11 005001   000011 740100                    STX0    9,,PR0

     2132    24536    3                KL$CONTROL_INIT.NUM_IPARAM = 0;

  24536 11 005002   000000 221003                    LDX1    0,DU
        11 005003   000011 441100                    SXL1    9,,PR0

     2133    24537    4                DO I = 0 TO KL$CONTROL_INIT.NUM_FPARAM;

  24537 11 005004   200010 450100                    STZ     I,,AUTO
        11 005005   005027 710000 11                 TRA     s:24539+3

     2134    24538    4                     CALL KLX$9TO8(KL_FEPCTL.PARAMS(I),KL$CONTROL_INIT.FPARAM(I),2);

  24538 11 005006   000042 236000 12                 LDQ     34
        11 005007   200430 756100                    STQ     T$+3,,AUTO
        11 005010   200010 236100                    LDQ     I,,AUTO
        11 005011   000021 736000                    QLS     17
        11 005012   000012 036003                    ADLQ    10,DU
        11 005013   200003 036100                    ADLQ    RDBF$,,AUTO
        11 005014   200427 756100                    STQ     T$+2,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:405  
        11 005015   200010 720100                    LXL0    I,,AUTO
        11 005016   000204 630410 7                  EPPR0   KL_FEPCTL+1,X0
        11 005017   200426 450500                    STP0    T$+1,,AUTO
        11 005020   200426 630500                    EPPR0   T$+1,,AUTO
        11 005021   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005022   000000 701000 xent               TSX1    KLX$9TO8
        11 005023   000000 011000                    NOP     0

     2135    24539    4                   END;                    /* DO I */

  24539 11 005024   200010 235100                    LDA     I,,AUTO
        11 005025   000001 035007                    ADLA    1,DL
        11 005026   200010 755100                    STA     I,,AUTO
        11 005027   200003 470500                    LDP0    RDBF$,,AUTO
        11 005030   000011 236100                    LDQ     9,,PR0
        11 005031   000022 772000                    QRL     18
        11 005032   200010 116100                    CMPQ    I,,AUTO
        11 005033   005006 603000 11                 TRC     s:24538

     2136    24540    3              END;                         /* HANDLER = 'BABOON' */

  24540 11 005034   005313 710000 11                 TRA     s:24608

     2137    24541    3           ELSE DO;

     2138    24542    3                KL_HNDLR_KEY.NODE = FEX;

  24542 11 005035   200025 236100                    LDQ     FEX,,AUTO
        11 005036   000011 736000                    QLS     9
        11 005037   000107 552010 7                  STBQ    KL_HNDLR_KEY,'10'O

     2139    24543    3                KL_HNDLR_KEY.HNDLR = KL$CONTROL_INIT.HANDLER;

  24543 11 005040   040000 100500                    MLR     fill='040'O
        11 005041   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        11 005042   000107 600010 7                  ADSC9   KL_HNDLR_KEY             cn=3,n=8

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:406  
     2140    24544    3                KL_RD_NETCON.KEY_ = VECTOR(KL_HNDLR_KEY);

  24544 11 005043   000140 237000 12                 LDAQ    96
        11 005044   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     2141    24545    3                KL_RD_NETCON.BUF_ = VECTOR(KL_HNDLR);

  24545 11 005045   000142 237000 12                 LDAQ    98
        11 005046   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     2142    24546    3                CALL M$READ(KL_RD_NETCON) ALTRET(NETCON_ALT);

  24546 11 005047   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 005050   440000 713400                    CLIMB   alt,read
        11 005051   401400 401760                    pmme    nvectors=4
        11 005052   005317 702000 11                 TSX2    NETCON_ALT

     2143    24547    3                KL$CONTROL_INIT.CODE = IGA_CONTROL_INIT;

  24547 11 005053   200003 470500                    LDP0    RDBF$,,AUTO
        11 005054   042000 236003                    LDQ     17408,DU
        11 005055   000000 552140                    STBQ    0,'40'O,PR0

     2144    24548    3                IF KL_HNDLR.NPARAMS ~= 0

  24548 11 005056   000126 236000 7                  LDQ     KL_HNDLR+12
        11 005057   777000 316007                    CANQ    -512,DL
        11 005060   005313 600000 11                 TZE     s:24608

     2145    24549    4                THEN DO;

     2146    24550    4                     KL$CONTROL_INIT.TYPE = KL_HNDLR.TYPE; /* ?? */

  24550 11 005061   000011 772000                    QRL     9
        11 005062   000000 552120                    STBQ    0,'20'O,PR0

     2147    24551    4                     KL$CONTROL_INIT.NUM_FPARAM = KL_HNDLR.NPARAMS;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:407  

  24551 11 005063   000126 236000 7                  LDQ     KL_HNDLR+12
        11 005064   000011 772000                    QRL     9
        11 005065   000777 376007                    ANQ     511,DL
        11 005066   000000 620006                    EAX0    0,QL
        11 005067   000011 740100                    STX0    9,,PR0

     2148    24552    4                     KL$CONTROL_INIT.NUM_IPARAM = KL_HNDLR.NPARAMI;

  24552 11 005070   000126 721000 7                  LXL1    KL_HNDLR+12
        11 005071   000777 361003                    ANX1    511,DU
        11 005072   000011 441100                    SXL1    9,,PR0

     2149    24553    5                     DO K = 0 TO KL_HNDLR.NPARAMS - 1;

  24553 11 005073   200012 450100                    STZ     K,,AUTO
        11 005074   005126 710000 11                 TRA     s:24561+1

     2150    24554    5                          IF K = %KL_HNDLRPARM_RES

  24554 11 005075   200012 235100                    LDA     K,,AUTO
        11 005076   000003 115007                    CMPA    3,DL
        11 005077   005106 601000 11                 TNZ     s:24558

     2151    24555    5                          THEN
     2152    24556    5                               KL$CONTROL_INIT.FPARAM(K) = KL_HNDLR.PARAMS(K);

  24556 11 005100   000001 735000                    ALS     1
        11 005101   200003 470500                    LDP0    RDBF$,,AUTO
        11 005102   000105 100405                    MLR     fill='000'O
        11 005103   000127 000002 7                  ADSC9   KL_HNDLR+13,A            cn=0,n=2
        11 005104   000012 000002                    ADSC9   10,A,PR0                 cn=0,n=2
        11 005105   005125 710000 11                 TRA     s:24561

     2153    24557    5                          ELSE
     2154    24558    5                               CALL KLX$9TO8(KL_HNDLR.PARAMS(K),

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:408  
  24558 11 005106   000042 236000 12                 LDQ     34
        11 005107   200430 756100                    STQ     T$+3,,AUTO
        11 005110   200012 236100                    LDQ     K,,AUTO
        11 005111   000021 736000                    QLS     17
        11 005112   000012 036003                    ADLQ    10,DU
        11 005113   200003 036100                    ADLQ    RDBF$,,AUTO
        11 005114   200427 756100                    STQ     T$+2,,AUTO
        11 005115   200012 236100                    LDQ     K,,AUTO
        11 005116   000021 736000                    QLS     17
        11 005117   000133 036000 12                 ADLQ    91
        11 005120   200426 756100                    STQ     T$+1,,AUTO
        11 005121   200426 630500                    EPPR0   T$+1,,AUTO
        11 005122   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005123   000000 701000 xent               TSX1    KLX$9TO8
        11 005124   000000 011000                    NOP     0

     2155    24559    5                                    KL$CONTROL_INIT.FPARAM(K),
     2156    24560    5                                    2);
     2157    24561    5                        END;

  24561 11 005125   200012 054100                    AOS     K,,AUTO
        11 005126   000126 236000 7                  LDQ     KL_HNDLR+12
        11 005127   000011 772000                    QRL     9
        11 005130   000777 376007                    ANQ     511,DL
        11 005131   200012 116100                    CMPQ    K,,AUTO
        11 005132   005075 605400 11                 TPNZ    s:24554

     2158    24562
     2159    24563    4                     IF KL_HNDLR.NPARAMI ~= 0

  24563 11 005133   000126 236000 7                  LDQ     KL_HNDLR+12
        11 005134   000777 316007                    CANQ    511,DL
        11 005135   005313 600000 11                 TZE     s:24608

     2160    24564    5                     THEN DO;

     2161    24565    5                          IPARAM$ = ADDR(KL$CONTROL_INIT.FPARAM(0));
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:409  

  24565 11 005136   200003 236100                    LDQ     RDBF$,,AUTO
        11 005137   000012 036003                    ADLQ    10,DU
        11 005140   200015 756100                    STQ     IPARAM$,,AUTO

     2162    24566    5                          IPARAM$ = PINCRC(IPARAM$,KL_HNDLR.NPARAMS*2);

  24566 11 005141   000126 236000 7                  LDQ     KL_HNDLR+12
        11 005142   000011 772000                    QRL     9
        11 005143   000777 376007                    ANQ     511,DL
        11 005144   000021 736000                    QLS     17
        11 005145   200015 036100                    ADLQ    IPARAM$,,AUTO
        11 005146   200015 756100                    STQ     IPARAM$,,AUTO

     2163    24567    5                          OUT$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM(0))*

  24567 11 005147   000126 720000 7                  LXL0    KL_HNDLR+12
        11 005150   000777 360003                    ANX0    511,DU
        11 005151   000000 636010                    EAQ     0,X0
        11 005152   200015 036100                    ADLQ    IPARAM$,,AUTO
        11 005153   200014 756100                    STQ     OUT$,,AUTO

     2164    24568    5                               KL_HNDLR.NPARAMI);
     2165    24569
     2166    24570    6                          DO J=0 TO KL_HNDLR.NPARAMI - 1;

  24570 11 005154   200011 450100                    STZ     J,,AUTO
        11 005155   005307 710000 11                 TRA     s:24604+1

     2167    24571    6                               OFFSET = POFFC(OUT$,ADDR(KL$CONTROL_INIT));

  24571 11 005156   200003 236100                    LDQ     RDBF$,,AUTO
        11 005157   000020 772000                    QRL     16
        11 005160   200426 756100                    STQ     T$+1,,AUTO
        11 005161   200014 236100                    LDQ     OUT$,,AUTO
        11 005162   000020 772000                    QRL     16
        11 005163   200426 136100                    SBLQ    T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:410  
        11 005164   000000 620006                    EAX0    0,QL
        11 005165   200013 740100                    STX0    OFFSET,,AUTO

     2168    24572    6                               IN$ = PINCRW(ADDR(KL_HNDLR),

  24572 11 005166   200011 721100                    LXL1    J,,AUTO
        11 005167   000146 222011 7                  LDX2    KL_HNDLR+28,X1
        11 005170   000112 630412 7                  EPPR0   KL_HNDLR,X2
        11 005171   200016 450500                    STP0    IN$,,AUTO

     2169    24573    6                                    KL_HNDLR.IPARAM.OFFSET(J));
     2170    24574
     2171    24575    6                               ARRAY_WDSZ = (((KL_HNDLR.IPARAM.ARRAY_SZ(J)+1)*2)+3)/4;

  24575 11 005172   000145 236011 7                  LDQ     KL_HNDLR+27,X1
        11 005173   000010 772000                    QRL     8
        11 005174   001776 376007                    ANQ     1022,DL
        11 005175   000005 036007                    ADLQ    5,DL
        11 005176   000002 772000                    QRL     2
        11 005177   200020 756100                    STQ     ARRAY_WDSZ,,AUTO

     2172    24576
     2173    24577    6                               CALL KLX$9TO8(KL_HNDLR.IPARAM.ARRAY_SZ(J),

  24577 11 005200   000103 236000 12                 LDQ     67
        11 005201   200430 756100                    STQ     T$+3,,AUTO
        11 005202   200015 236100                    LDQ     IPARAM$,,AUTO
        11 005203   200427 756100                    STQ     T$+2,,AUTO
        11 005204   200011 236100                    LDQ     J,,AUTO
        11 005205   000022 736000                    QLS     18
        11 005206   000144 036000 12                 ADLQ    100
        11 005207   200426 756100                    STQ     T$+1,,AUTO
        11 005210   200426 630500                    EPPR0   T$+1,,AUTO
        11 005211   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005212   000000 701000 xent               TSX1    KLX$9TO8
        11 005213   000000 011000                    NOP     0

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:411  
     2174    24578    6                                    IPARAM$->B$BYTE,
     2175    24579    6                                    1);
     2176    24580    6                               IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM.

  24580 11 005214   200015 236100                    LDQ     IPARAM$,,AUTO
        11 005215   200000 036007                    ADLQ    65536,DL
        11 005216   200015 756100                    STQ     IPARAM$,,AUTO

     2177    24581    6                                    ARRAY_SZ(0)));
     2178    24582
     2179    24583    6                               CALL KLX$9TO8(KL_HNDLR.IPARAM.PARAM_SZ(J),

  24583 11 005217   000103 236000 12                 LDQ     67
        11 005220   200430 756100                    STQ     T$+3,,AUTO
        11 005221   200015 236100                    LDQ     IPARAM$,,AUTO
        11 005222   200427 756100                    STQ     T$+2,,AUTO
        11 005223   200011 236100                    LDQ     J,,AUTO
        11 005224   000022 736000                    QLS     18
        11 005225   000145 036000 12                 ADLQ    101
        11 005226   200426 756100                    STQ     T$+1,,AUTO
        11 005227   200426 630500                    EPPR0   T$+1,,AUTO
        11 005230   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005231   000000 701000 xent               TSX1    KLX$9TO8
        11 005232   000000 011000                    NOP     0

     2180    24584    6                                    IPARAM$->B$BYTE,
     2181    24585    6                                    1);
     2182    24586    6                               IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM.

  24586 11 005233   200015 236100                    LDQ     IPARAM$,,AUTO
        11 005234   200000 036007                    ADLQ    65536,DL
        11 005235   200015 756100                    STQ     IPARAM$,,AUTO

     2183    24587    6                                    PARAM_SZ(0)));
     2184    24588
     2185    24589    6                               CALL KLX$9TO8(OFFSET,

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:412  
  24589 11 005236   000042 236000 12                 LDQ     34
        11 005237   200430 756100                    STQ     T$+3,,AUTO
        11 005240   200015 236100                    LDQ     IPARAM$,,AUTO
        11 005241   200427 756100                    STQ     T$+2,,AUTO
        11 005242   200013 630500                    EPPR0   OFFSET,,AUTO
        11 005243   200426 450500                    STP0    T$+1,,AUTO
        11 005244   200426 630500                    EPPR0   T$+1,,AUTO
        11 005245   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005246   000000 701000 xent               TSX1    KLX$9TO8
        11 005247   000000 011000                    NOP     0

     2186    24590    6                                    IPARAM$->B$HALF,
     2187    24591    6                                    2);
     2188    24592
     2189    24593    6                               IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM.

  24593 11 005250   200015 236100                    LDQ     IPARAM$,,AUTO
        11 005251   400000 036007                    ADLQ    -131072,DL
        11 005252   200015 756100                    STQ     IPARAM$,,AUTO

     2190    24594    6                                    OFFSET(0)));
     2191    24595
     2192    24596    7                               DO K=0 TO KL_HNDLR.IPARAM.ARRAY_SZ(J);

  24596 11 005253   200012 450100                    STZ     K,,AUTO
        11 005254   005274 710000 11                 TRA     s:24600+1

     2193    24597    7                                    CALL KLX$9TO8(IN$->B$PARAMI(K),

  24597 11 005255   000042 236000 12                 LDQ     34
        11 005256   200430 756100                    STQ     T$+3,,AUTO
        11 005257   200012 236100                    LDQ     K,,AUTO
        11 005260   000021 736000                    QLS     17
        11 005261   200014 036100                    ADLQ    OUT$,,AUTO
        11 005262   200427 756100                    STQ     T$+2,,AUTO
        11 005263   200012 236100                    LDQ     K,,AUTO
        11 005264   000021 736000                    QLS     17
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:413  
        11 005265   200016 036100                    ADLQ    IN$,,AUTO
        11 005266   200426 756100                    STQ     T$+1,,AUTO
        11 005267   200426 630500                    EPPR0   T$+1,,AUTO
        11 005270   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005271   000000 701000 xent               TSX1    KLX$9TO8
        11 005272   000000 011000                    NOP     0

     2194    24598    7                                         OUT$->B$PARAMI(K),
     2195    24599    7                                         2);
     2196    24600    7                                  END;

  24600 11 005273   200012 054100                    AOS     K,,AUTO
        11 005274   200011 720100                    LXL0    J,,AUTO
        11 005275   000145 236010 7                  LDQ     KL_HNDLR+27,X0
        11 005276   000011 772000                    QRL     9
        11 005277   000777 376007                    ANQ     511,DL
        11 005300   200012 116100                    CMPQ    K,,AUTO
        11 005301   005255 605000 11                 TPL     s:24597

     2197    24601
     2198    24602    6                               OUT$ = PINCRW(OUT$,ARRAY_WDSZ);

  24602 11 005302   200020 236100                    LDQ     ARRAY_WDSZ,,AUTO
        11 005303   000022 736000                    QLS     18
        11 005304   200014 036100                    ADLQ    OUT$,,AUTO
        11 005305   200014 756100                    STQ     OUT$,,AUTO

     2199    24603
     2200    24604    6                             END /*do J=0 to .NPARAMI-1*/;

  24604 11 005306   200011 054100                    AOS     J,,AUTO
        11 005307   000126 236000 7                  LDQ     KL_HNDLR+12
        11 005310   000777 376007                    ANQ     511,DL
        11 005311   200011 116100                    CMPQ    J,,AUTO
        11 005312   005156 605400 11                 TPNZ    s:24571

     2201    24605    5                        END/* do if NPARAMI ~= 0*/;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:414  

     2202    24606    4                   END/* do if NPARAMS ~= 0*/;

     2203    24607    3              END;                         /* ELSE */

     2204    24608    2           KL$CONTROL_INIT.TYPE = 1;       /* ACK */

  24608 11 005313   200003 470500                    LDP0    RDBF$,,AUTO
        11 005314   000001 236003                    LDQ     1,DU
        11 005315   000000 552120                    STBQ    0,'20'O,PR0

     2205    24609    3           DO WHILE('0'B);

  24609 11 005316   005322 710000 11                 TRA     s:24612

     2206    24610    3   NETCON_ALT:  KL$CONTROL_INIT.TYPE = 0;  /* NAK */

  24610 11 005317   200003 470500       NETCON_ALT   LDP0    RDBF$,,AUTO
        11 005320   000000 236003                    LDQ     0,DU
        11 005321   000000 552120                    STBQ    0,'20'O,PR0

     2207    24611    3              END;                         /* DO NEVER */

     2208    24612    2           SIZE = SIZEC(KL$CONTROL_INIT);

  24612 11 005322   000324 235007                    LDA     212,DL
        11 005323   200024 755100                    STA     SIZE,,AUTO

     2209    24613    2           CALL KLX$WRHLPNODE(KL$CONTROL_INIT,SIZE,FEX);

  24613 11 005324   200025 631500                    EPPR1   FEX,,AUTO
        11 005325   200430 451500                    STP1    T$+3,,AUTO
        11 005326   200024 633500                    EPPR3   SIZE,,AUTO
        11 005327   200427 453500                    STP3    T$+2,,AUTO
        11 005330   200003 236100                    LDQ     RDBF$,,AUTO
        11 005331   200426 756100                    STQ     T$+1,,AUTO
        11 005332   200426 630500                    EPPR0   T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:415  
        11 005333   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005334   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 005335   000000 011000                    NOP     0
        11 005336   010045 710000 11                 TRA     s:25129

     2210    24614        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:416  
     2211    24615    2        CASE(IGA_CONTROL);

     2212    24616    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */

  24616 11 005337   000000 220000 xsym               LDX0    KL_STATION
        11 005340   000222 100000 10                 CMPX0   CKBR+16
        11 005341   005436 601000 11                 TNZ     s:24632

     2213    24617    4                CALL KLX$CONV_NODENAME(KL$CONTROL.NODE,FEX,NODETYPE) WHENALTRETURN DO;

  24617 11 005342   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 005343   200430 450500                    STP0    T$+3,,AUTO
        11 005344   200025 631500                    EPPR1   FEX,,AUTO
        11 005345   200427 451500                    STP1    T$+2,,AUTO
        11 005346   200003 236100                    LDQ     RDBF$,,AUTO
        11 005347   000005 036003                    ADLQ    5,DU
        11 005350   200426 756100                    STQ     T$+1,,AUTO
        11 005351   200426 630500                    EPPR0   T$+1,,AUTO
        11 005352   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005353   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 005354   005356 702000 11                 TSX2    s:24618
        11 005355   005370 710000 11                 TRA     s:24621

     2214    24618    4                     CALL XUR$ERRTOLCP6(KL$CONTROL.RESULTS,NOFE);

  24618 11 005356   000146 236000 12                 LDQ     102
        11 005357   200427 756100                    STQ     T$+2,,AUTO
        11 005360   200003 236100                    LDQ     RDBF$,,AUTO
        11 005361   000007 036003                    ADLQ    7,DU
        11 005362   200426 756100                    STQ     T$+1,,AUTO
        11 005363   200426 630500                    EPPR0   T$+1,,AUTO
        11 005364   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 005365   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 005366   000000 011000                    NOP     0

     2215    24619    4                     GOTO CONT_ERR;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:417  
  24619 11 005367   005417 710000 11                 TRA     CONT_ERR

     2216    24620    4                   END;
     2217    24621    3                KL$CONTROL.SRCE_NODE = KL_NODE;

  24621 11 005370   200003 470500                    LDP0    RDBF$,,AUTO
        11 005371   000000 236000 xsym               LDQ     KL_NODE
        11 005372   000011 736000                    QLS     9
        11 005373   000000 552110                    STBQ    0,'10'O,PR0

     2218    24622    4                CALL KLX$WRHLPNODE(KL$CONTROL,SIZEC(KL$CONTROL),FEX) WHENALTRETURN DO;

  24622 11 005374   200025 631500                    EPPR1   FEX,,AUTO
        11 005375   200430 451500                    STP1    T$+3,,AUTO
        11 005376   000150 236000 12                 LDQ     104
        11 005377   200003 235100                    LDA     RDBF$,,AUTO
        11 005400   200426 757100                    STAQ    T$+1,,AUTO
        11 005401   200426 630500                    EPPR0   T$+1,,AUTO
        11 005402   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005403   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 005404   005406 702000 11                 TSX2    s:24623
        11 005405   005435 710000 11                 TRA     s:24630

     2219    24623    4                     CALL XUR$ERRTOLCP6(KL$CONTROL.RESULTS,NODENA);

  24623 11 005406   000151 236000 12                 LDQ     105
        11 005407   200427 756100                    STQ     T$+2,,AUTO
        11 005410   200003 236100                    LDQ     RDBF$,,AUTO
        11 005411   000007 036003                    ADLQ    7,DU
        11 005412   200426 756100                    STQ     T$+1,,AUTO
        11 005413   200426 630500                    EPPR0   T$+1,,AUTO
        11 005414   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 005415   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 005416   000000 011000                    NOP     0

  24623 11 005417                       CONT_ERR     null
     2220    24624    4   CONT_ERR:         ;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:418  
     2221    24625    4                     KL$CONTROL.TYPE = 0;  /* NAK */

  24625 11 005417   200003 470500                    LDP0    RDBF$,,AUTO
        11 005420   000000 236003                    LDQ     0,DU
        11 005421   000000 552120                    STBQ    0,'20'O,PR0

     2222    24626    5                     CALL KLX$WRHLPSTA(KL$CONTROL,SIZEC(KL$CONTROL),KL$CONTROL.ORIGIN)
             24626                              WHENALTRETURN DO;

  24626 11 005422   200003 236100                    LDQ     RDBF$,,AUTO
        11 005423   000003 036003                    ADLQ    3,DU
        11 005424   200430 756100                    STQ     T$+3,,AUTO
        11 005425   000150 236000 12                 LDQ     104
        11 005426   200003 235100                    LDA     RDBF$,,AUTO
        11 005427   200426 757100                    STAQ    T$+1,,AUTO
        11 005430   200426 630500                    EPPR0   T$+1,,AUTO
        11 005431   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005432   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005433   005435 702000 11                 TSX2    s:24630
        11 005434   005435 710000 11                 TRA     s:24630

     2223    24627                         /*N* WHAT DO WE DO? */
     2224    24628    5                        END;               /* WHENALTRETURN */

     2225    24629    4                   END;                    /* WHENALTRETURN */

     2226    24630    3              END;                         /* IF */

  24630 11 005435   010045 710000 11                 TRA     s:25129

     2227    24631    3           ELSE DO;                        /* Msg is from FEP */

     2228    24632    4                CALL KLX$WRHLPSTA(KL$CONTROL,SIZEC(KL$CONTROL),KL$CONTROL.ORIGIN)
             24632                         WHENALTRETURN DO;

  24632 11 005436   200003 236100                    LDQ     RDBF$,,AUTO
        11 005437   000003 036003                    ADLQ    3,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:419  
        11 005440   200430 756100                    STQ     T$+3,,AUTO
        11 005441   000150 236000 12                 LDQ     104
        11 005442   200003 235100                    LDA     RDBF$,,AUTO
        11 005443   200426 757100                    STAQ    T$+1,,AUTO
        11 005444   200426 630500                    EPPR0   T$+1,,AUTO
        11 005445   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005446   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005447   005451 702000 11                 TSX2    s:24635
        11 005450   005451 710000 11                 TRA     s:24635

     2229    24633                            /*N* WHAT DO WE DO?  */
     2230    24634    4                   END;                    /* WHENALTRETURN */

     2231    24635    3              END;                         /* ELSE */

  24635 11 005451   010045 710000 11                 TRA     s:25129

     2232    24636        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:420  
     2233    24637    2        CASE(IGA_RESET);

     2234    24638    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */

  24638 11 005452   000000 220000 xsym               LDX0    KL_STATION
        11 005453   000222 100000 10                 CMPX0   CKBR+16
        11 005454   005563 601000 11                 TNZ     s:24669

     2235    24639    3                CALL KLX$CONV_NODENAME (KL$CNFG_MSG.NODE,FEX,NODETYPE)

  24639 11 005455   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 005456   200430 450500                    STP0    T$+3,,AUTO
        11 005457   200025 631500                    EPPR1   FEX,,AUTO
        11 005460   200427 451500                    STP1    T$+2,,AUTO
        11 005461   200003 236100                    LDQ     RDBF$,,AUTO
        11 005462   000005 036003                    ADLQ    5,DU
        11 005463   200426 756100                    STQ     T$+1,,AUTO
        11 005464   200426 630500                    EPPR0   T$+1,,AUTO
        11 005465   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005466   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 005467   005537 702000 11                 TSX2    SEND_RESET_ERR

     2236    24640    3                WHENRETURN
     2237    24641    4                DO;

     2238    24642    4                     IF NODETYPE ~= %KL_NODETYPE_FEP

  24642 11 005470   200026 235100                    LDA     NODETYPE,,AUTO
        11 005471   000002 115007                    CMPA    2,DL
        11 005472   005475 600000 11                 TZE     s:24646
        11 005473   000004 115007                    CMPA    4,DL
        11 005474   005537 601000 11                 TNZ     SEND_RESET_ERR

     2239    24643    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2240    24644    4                     THEN
     2241    24645    4                          GOTO SEND_RESET_ERR;
     2242    24646    4                     KL$CNFG_MSG.SRCE_NODE = KL_NODE;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:421  

  24646 11 005475   200003 470500                    LDP0    RDBF$,,AUTO
        11 005476   000000 236000 xsym               LDQ     KL_NODE
        11 005477   000011 736000                    QLS     9
        11 005500   000000 552110                    STBQ    0,'10'O,PR0

     2243    24647    4                     CALL KLX$WRHLPNODE(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),FEX)

  24647 11 005501   200025 631500                    EPPR1   FEX,,AUTO
        11 005502   200430 451500                    STP1    T$+3,,AUTO
        11 005503   000153 236000 12                 LDQ     107
        11 005504   200003 235100                    LDA     RDBF$,,AUTO
        11 005505   200426 757100                    STAQ    T$+1,,AUTO
        11 005506   200426 630500                    EPPR0   T$+1,,AUTO
        11 005507   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005510   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 005511   005513 702000 11                 TSX2    s:24650
        11 005512   005536 710000 11                 TRA     s:24656

     2244    24648    4                     WHENALTRETURN
     2245    24649    5                     DO;

     2246    24650    5                          CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NODENA);

  24650 11 005513   000151 236000 12                 LDQ     105
        11 005514   200427 756100                    STQ     T$+2,,AUTO
        11 005515   200003 236100                    LDQ     RDBF$,,AUTO
        11 005516   000007 036003                    ADLQ    7,DU
        11 005517   200426 756100                    STQ     T$+1,,AUTO
        11 005520   200426 630500                    EPPR0   T$+1,,AUTO
        11 005521   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 005522   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 005523   000000 011000                    NOP     0

     2247    24651                             /*E* ERROR: KLI-E$NODENA-4
     2248    24652                               MESSAGE: That node is not currently available.
     2249    24653                             */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:422  
     2250    24654    5                         CALL KLX$WRHLPSTA (KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG
             24654                                   .ORIGIN);

  24654 11 005524   200003 236100                    LDQ     RDBF$,,AUTO
        11 005525   000003 036003                    ADLQ    3,DU
        11 005526   200430 756100                    STQ     T$+3,,AUTO
        11 005527   000153 236000 12                 LDQ     107
        11 005530   200003 235100                    LDA     RDBF$,,AUTO
        11 005531   200426 757100                    STAQ    T$+1,,AUTO
        11 005532   200426 630500                    EPPR0   T$+1,,AUTO
        11 005533   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005534   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005535   000000 011000                    NOP     0

     2251    24655    5                        END;

     2252    24656    4                   END;

  24656 11 005536   005562 710000 11                 TRA     s:24666

     2253    24657    3                WHENALTRETURN
     2254    24658    4                DO;

     2255    24659    4   SEND_RESET_ERR:   ;

  24659 11 005537                       SEND_RESET_* null
     2256    24660    4                     CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NOFE);

  24660 11 005537   000146 236000 12                 LDQ     102
        11 005540   200427 756100                    STQ     T$+2,,AUTO
        11 005541   200003 236100                    LDQ     RDBF$,,AUTO
        11 005542   000007 036003                    ADLQ    7,DU
        11 005543   200426 756100                    STQ     T$+1,,AUTO
        11 005544   200426 630500                    EPPR0   T$+1,,AUTO
        11 005545   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 005546   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 005547   000000 011000                    NOP     0
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:423  

     2257    24661                             /*E* ERROR: KLI-E$NOFE-4
     2258    24662                                  MESSAGE: That FEP does not exist.
     2259    24663                             */
     2260    24664    4                     CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.
             24664                              ORIGIN);

  24664 11 005550   200003 236100                    LDQ     RDBF$,,AUTO
        11 005551   000003 036003                    ADLQ    3,DU
        11 005552   200430 756100                    STQ     T$+3,,AUTO
        11 005553   000153 236000 12                 LDQ     107
        11 005554   200003 235100                    LDA     RDBF$,,AUTO
        11 005555   200426 757100                    STAQ    T$+1,,AUTO
        11 005556   200426 630500                    EPPR0   T$+1,,AUTO
        11 005557   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005560   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005561   000000 011000                    NOP     0

     2261    24665    4                   END;

     2262    24666    3              END;                         /* IF */

  24666 11 005562   010045 710000 11                 TRA     s:25129

     2263    24667    2           ELSE
     2264    24668    3           DO;

     2265    24669    4                CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.ORIGIN)
             24669                         WHENALTRETURN DO;

  24669 11 005563   200003 236100                    LDQ     RDBF$,,AUTO
        11 005564   000003 036003                    ADLQ    3,DU
        11 005565   200430 756100                    STQ     T$+3,,AUTO
        11 005566   000153 236000 12                 LDQ     107
        11 005567   200003 235100                    LDA     RDBF$,,AUTO
        11 005570   200426 757100                    STAQ    T$+1,,AUTO
        11 005571   200426 630500                    EPPR0   T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:424  
        11 005572   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005573   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005574   005576 702000 11                 TSX2    s:24672
        11 005575   005576 710000 11                 TRA     s:24672

     2266    24670                            /*N* WHAT DO WE DO?  */
     2267    24671    4                   END;                    /* WHENALTRETURN */

     2268    24672    3              END;

  24672 11 005576   010045 710000 11                 TRA     s:25129

     2269    24673        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:425  
     2270    24674    2        CASE(IGA_CHNDISP);

     2271    24675    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */

  24675 11 005577   000000 220000 xsym               LDX0    KL_STATION
        11 005600   000222 100000 10                 CMPX0   CKBR+16
        11 005601   005710 601000 11                 TNZ     s:24702

     2272    24676    3                CALL KLX$CONV_NODENAME (KL$ADMIN.NODE,FEX,NODETYPE)

  24676 11 005602   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 005603   200430 450500                    STP0    T$+3,,AUTO
        11 005604   200025 631500                    EPPR1   FEX,,AUTO
        11 005605   200427 451500                    STP1    T$+2,,AUTO
        11 005606   200003 236100                    LDQ     RDBF$,,AUTO
        11 005607   000005 036003                    ADLQ    5,DU
        11 005610   200426 756100                    STQ     T$+1,,AUTO
        11 005611   200426 630500                    EPPR0   T$+1,,AUTO
        11 005612   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005613   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 005614   005664 702000 11                 TSX2    SEND_CHNDISP_ERR

     2273    24677    4                WHENRETURN DO;

     2274    24678    4                     IF NODETYPE ~= %KL_NODETYPE_FEP

  24678 11 005615   200026 235100                    LDA     NODETYPE,,AUTO
        11 005616   000002 115007                    CMPA    2,DL
        11 005617   005622 600000 11                 TZE     s:24682
        11 005620   000004 115007                    CMPA    4,DL
        11 005621   005664 601000 11                 TNZ     SEND_CHNDISP_ERR

     2275    24679    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2276    24680    4                     THEN
     2277    24681    4                          GOTO SEND_CHNDISP_ERR;
     2278    24682    4                     KL$ADMIN.SRCE_NODE = KL_NODE;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:426  
  24682 11 005622   200003 470500                    LDP0    RDBF$,,AUTO
        11 005623   000000 236000 xsym               LDQ     KL_NODE
        11 005624   000011 736000                    QLS     9
        11 005625   000000 552110                    STBQ    0,'10'O,PR0

     2279    24683    4                     CALL KLX$WRHLPNODE(KL$ADMIN,SIZEC(KL$ADMIN),FEX)

  24683 11 005626   200025 631500                    EPPR1   FEX,,AUTO
        11 005627   200430 451500                    STP1    T$+3,,AUTO
        11 005630   000033 236000 12                 LDQ     27
        11 005631   200003 235100                    LDA     RDBF$,,AUTO
        11 005632   200426 757100                    STAQ    T$+1,,AUTO
        11 005633   200426 630500                    EPPR0   T$+1,,AUTO
        11 005634   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005635   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 005636   005640 702000 11                 TSX2    s:24685
        11 005637   005663 710000 11                 TRA     s:24691

     2280    24684    5                     WHENALTRETURN DO;

     2281    24685    5                          CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NODENA);

  24685 11 005640   000151 236000 12                 LDQ     105
        11 005641   200427 756100                    STQ     T$+2,,AUTO
        11 005642   200003 236100                    LDQ     RDBF$,,AUTO
        11 005643   000007 036003                    ADLQ    7,DU
        11 005644   200426 756100                    STQ     T$+1,,AUTO
        11 005645   200426 630500                    EPPR0   T$+1,,AUTO
        11 005646   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 005647   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 005650   000000 011000                    NOP     0

     2282    24686                       /*   ERROR: KLI-E$NODENA-4
     2283    24687                            MESSAGE: That node is not currently available.
     2284    24688                             */
     2285    24689    5                         CALL KLX$WRHLPSTA (KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:427  
  24689 11 005651   200003 236100                    LDQ     RDBF$,,AUTO
        11 005652   000003 036003                    ADLQ    3,DU
        11 005653   200430 756100                    STQ     T$+3,,AUTO
        11 005654   000033 236000 12                 LDQ     27
        11 005655   200003 235100                    LDA     RDBF$,,AUTO
        11 005656   200426 757100                    STAQ    T$+1,,AUTO
        11 005657   200426 630500                    EPPR0   T$+1,,AUTO
        11 005660   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005661   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005662   000000 011000                    NOP     0

     2286    24690    5                        END;

     2287    24691    4                   END;

  24691 11 005663   005707 710000 11                 TRA     s:24700

     2288    24692    4                WHENALTRETURN DO;

     2289    24693    4   SEND_CHNDISP_ERR: ;

  24693 11 005664                       SEND_CHNDIS* null
     2290    24694    4                     CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NOFE);

  24694 11 005664   000146 236000 12                 LDQ     102
        11 005665   200427 756100                    STQ     T$+2,,AUTO
        11 005666   200003 236100                    LDQ     RDBF$,,AUTO
        11 005667   000007 036003                    ADLQ    7,DU
        11 005670   200426 756100                    STQ     T$+1,,AUTO
        11 005671   200426 630500                    EPPR0   T$+1,,AUTO
        11 005672   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 005673   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 005674   000000 011000                    NOP     0

     2291    24695                  /*   ERROR: KLI-E$NOFE-4
     2292    24696                       MESSAGE: That FEP does not exist.
     2293    24697                        */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:428  
     2294    24698    4                     CALL KLX$WRHLPSTA(KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);

  24698 11 005675   200003 236100                    LDQ     RDBF$,,AUTO
        11 005676   000003 036003                    ADLQ    3,DU
        11 005677   200430 756100                    STQ     T$+3,,AUTO
        11 005700   000033 236000 12                 LDQ     27
        11 005701   200003 235100                    LDA     RDBF$,,AUTO
        11 005702   200426 757100                    STAQ    T$+1,,AUTO
        11 005703   200426 630500                    EPPR0   T$+1,,AUTO
        11 005704   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005705   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005706   000000 011000                    NOP     0

     2295    24699    4                   END;

     2296    24700    3              END;                         /* IF */

  24700 11 005707   010045 710000 11                 TRA     s:25129

     2297    24701    2           ELSE
     2298    24702    2                CALL KLX$WRHLPSTA(KL$ADMIN,KL_MARS,KL$ADMIN.ORIGIN);

  24702 11 005710   200003 236100                    LDQ     RDBF$,,AUTO
        11 005711   000003 036003                    ADLQ    3,DU
        11 005712   200430 756100                    STQ     T$+3,,AUTO
        11 005713   000154 236000 12                 LDQ     108
        11 005714   200003 235100                    LDA     RDBF$,,AUTO
        11 005715   200426 757100                    STAQ    T$+1,,AUTO
        11 005716   200426 630500                    EPPR0   T$+1,,AUTO
        11 005717   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005720   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 005721   000000 011000                    NOP     0
        11 005722   010045 710000 11                 TRA     s:25129

     2299    24703        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:429  
     2300    24704    2        CASE(IGA_ADMIN);

     2301    24705    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */

  24705 11 005723   000000 220000 xsym               LDX0    KL_STATION
        11 005724   000222 100000 10                 CMPX0   CKBR+16
        11 005725   006034 601000 11                 TNZ     s:24732

     2302    24706    3                CALL KLX$CONV_NODENAME (KL$ADMIN.NODE,FEX,NODETYPE)

  24706 11 005726   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 005727   200430 450500                    STP0    T$+3,,AUTO
        11 005730   200025 631500                    EPPR1   FEX,,AUTO
        11 005731   200427 451500                    STP1    T$+2,,AUTO
        11 005732   200003 236100                    LDQ     RDBF$,,AUTO
        11 005733   000005 036003                    ADLQ    5,DU
        11 005734   200426 756100                    STQ     T$+1,,AUTO
        11 005735   200426 630500                    EPPR0   T$+1,,AUTO
        11 005736   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005737   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 005740   006010 702000 11                 TSX2    SEND_ADMIN_ERR

     2303    24707    4                WHENRETURN DO;

     2304    24708    4                     IF NODETYPE ~= %KL_NODETYPE_FEP

  24708 11 005741   200026 235100                    LDA     NODETYPE,,AUTO
        11 005742   000002 115007                    CMPA    2,DL
        11 005743   005746 600000 11                 TZE     s:24712
        11 005744   000004 115007                    CMPA    4,DL
        11 005745   006010 601000 11                 TNZ     SEND_ADMIN_ERR

     2305    24709    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2306    24710    4                     THEN
     2307    24711    4                          GOTO SEND_ADMIN_ERR;
     2308    24712    4                     KL$ADMIN.SRCE_NODE = KL_NODE;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:430  
  24712 11 005746   200003 470500                    LDP0    RDBF$,,AUTO
        11 005747   000000 236000 xsym               LDQ     KL_NODE
        11 005750   000011 736000                    QLS     9
        11 005751   000000 552110                    STBQ    0,'10'O,PR0

     2309    24713    4                     CALL KLX$WRHLPNODE(KL$ADMIN,SIZEC(KL$ADMIN),FEX)

  24713 11 005752   200025 631500                    EPPR1   FEX,,AUTO
        11 005753   200430 451500                    STP1    T$+3,,AUTO
        11 005754   000033 236000 12                 LDQ     27
        11 005755   200003 235100                    LDA     RDBF$,,AUTO
        11 005756   200426 757100                    STAQ    T$+1,,AUTO
        11 005757   200426 630500                    EPPR0   T$+1,,AUTO
        11 005760   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005761   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 005762   005764 702000 11                 TSX2    s:24715
        11 005763   006007 710000 11                 TRA     s:24721

     2310    24714    5                     WHENALTRETURN DO;

     2311    24715    5                          CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NODENA);

  24715 11 005764   000151 236000 12                 LDQ     105
        11 005765   200427 756100                    STQ     T$+2,,AUTO
        11 005766   200003 236100                    LDQ     RDBF$,,AUTO
        11 005767   000007 036003                    ADLQ    7,DU
        11 005770   200426 756100                    STQ     T$+1,,AUTO
        11 005771   200426 630500                    EPPR0   T$+1,,AUTO
        11 005772   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 005773   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 005774   000000 011000                    NOP     0

     2312    24716                       /*   ERROR: KLI-E$NODENA-4
     2313    24717                            MESSAGE: That node is not currently available.
     2314    24718                             */
     2315    24719    5                         CALL KLX$WRHLPSTA (KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:431  
  24719 11 005775   200003 236100                    LDQ     RDBF$,,AUTO
        11 005776   000003 036003                    ADLQ    3,DU
        11 005777   200430 756100                    STQ     T$+3,,AUTO
        11 006000   000033 236000 12                 LDQ     27
        11 006001   200003 235100                    LDA     RDBF$,,AUTO
        11 006002   200426 757100                    STAQ    T$+1,,AUTO
        11 006003   200426 630500                    EPPR0   T$+1,,AUTO
        11 006004   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006005   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 006006   000000 011000                    NOP     0

     2316    24720    5                        END;

     2317    24721    4                   END;

  24721 11 006007   006033 710000 11                 TRA     s:24730

     2318    24722    4                WHENALTRETURN DO;

     2319    24723    4   SEND_ADMIN_ERR:   ;

  24723 11 006010                       SEND_ADMIN_* null
     2320    24724    4                     CALL XUR$ERRTOLCP6(KL$ADMIN.RESULTS,NOFE);

  24724 11 006010   000146 236000 12                 LDQ     102
        11 006011   200427 756100                    STQ     T$+2,,AUTO
        11 006012   200003 236100                    LDQ     RDBF$,,AUTO
        11 006013   000007 036003                    ADLQ    7,DU
        11 006014   200426 756100                    STQ     T$+1,,AUTO
        11 006015   200426 630500                    EPPR0   T$+1,,AUTO
        11 006016   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 006017   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 006020   000000 011000                    NOP     0

     2321    24725                  /*   ERROR: KLI-E$NOFE-4
     2322    24726                       MESSAGE: That FEP does not exist.
     2323    24727                        */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:432  
     2324    24728    4                     CALL KLX$WRHLPSTA(KL$ADMIN,SIZEC(KL$ADMIN),KL$ADMIN.ORIGIN);

  24728 11 006021   200003 236100                    LDQ     RDBF$,,AUTO
        11 006022   000003 036003                    ADLQ    3,DU
        11 006023   200430 756100                    STQ     T$+3,,AUTO
        11 006024   000033 236000 12                 LDQ     27
        11 006025   200003 235100                    LDA     RDBF$,,AUTO
        11 006026   200426 757100                    STAQ    T$+1,,AUTO
        11 006027   200426 630500                    EPPR0   T$+1,,AUTO
        11 006030   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006031   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 006032   000000 011000                    NOP     0

     2325    24729    4                   END;

     2326    24730    3              END;                         /* IF */

  24730 11 006033   010045 710000 11                 TRA     s:25129

     2327    24731    2           ELSE
     2328    24732    2                IF KL$ADMIN.ORIGIN = 'KHA$ADMN' /* Fep telling us change */

  24732 11 006034   200003 470500                    LDP0    RDBF$,,AUTO
        11 006035   040000 106500                    CMPC    fill='040'O
        11 006036   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
        11 006037   000223 000010 10                 ADSC9   CKBR+17                  cn=0,n=8
        11 006040   006644 601000 11                 TNZ     s:24893

     2329    24733    2                THEN
     2330    24734    3                DO CASE (KL$ADMIN.FNC);

  24734 11 006041   000010 236100                    LDQ     8,,PR0
        11 006042   777777 376007                    ANQ     -1,DL
        11 006043   000014 136007                    SBLQ    12,DL
        11 006044   000022 116007                    CMPQ    18,DL
        11 006045   006047 602006 11                 TNC     s:24734+6,QL
        11 006046   010045 710000 11                 TRA     s:25129
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:433  
        11 006047   006071 710000 11                 TRA     s:24737
        11 006050   006643 710000 11                 TRA     s:24891
        11 006051   006643 710000 11                 TRA     s:24891
        11 006052   006643 710000 11                 TRA     s:24891
        11 006053   006643 710000 11                 TRA     s:24891
        11 006054   006643 710000 11                 TRA     s:24891
        11 006055   006643 710000 11                 TRA     s:24891
        11 006056   006643 710000 11                 TRA     s:24891
        11 006057   006643 710000 11                 TRA     s:24891
        11 006060   006643 710000 11                 TRA     s:24891
        11 006061   006643 710000 11                 TRA     s:24891
        11 006062   006643 710000 11                 TRA     s:24891
        11 006063   006643 710000 11                 TRA     s:24891
        11 006064   006643 710000 11                 TRA     s:24891
        11 006065   006643 710000 11                 TRA     s:24891
        11 006066   006643 710000 11                 TRA     s:24891
        11 006067   006157 710000 11                 TRA     s:24766
        11 006070   006640 710000 11                 TRA     s:24888

     2331    24735
     2332    24736    3                CASE (%KHA_FNC_DISCONNECT_EVT);

     2333    24737    3                   FPT_WRSYSLOG.V.TYPE# = EL_DISC;

  24737 11 006071   000002 235007                    LDA     2,DL
        11 006072   000271 755000 7                  STA     FPT_WRSYSLOG+5

     2334    24738    3                   KL_NETWORK_KEY.KEY.NODE = FEX;

  24738 11 006073   200025 236100                    LDQ     FEX,,AUTO
        11 006074   000011 736000                    QLS     9
        11 006075   000000 552010 xsym               STBQ    KL_NETWORK_KEY,'10'O

     2335    24739    3                   KL_NETWORK_KEY.KEY.TERMID = KL$ADMIN.TERMID_LO;

  24739 11 006076   000000 100500                    MLR     fill='000'O
        11 006077   000011 000020                    ADSC9   9,,PR0                   cn=0,n=16
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:434  
        11 006100   000000 600020 xsym               ADSC9   KL_NETWORK_KEY           cn=3,n=16

     2336    24740    3                   KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  24740 11 006101   000022 237000 12                 LDAQ    18
        11 006102   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

     2337    24741    3                   KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;

  24741 11 006103   000000 236003                    LDQ     0,DU
        11 006104   000000 552004 xsym               STBQ    KL_NETWORK_KEY,'04'O

     2338    24742    3                   KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  24742 11 006105   022000 236003                    LDQ     9216,DU
        11 006106   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     2339    24743    3                   CALL M$READ (KL_RD_NETWORK)

  24743 11 006107   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 006110   440000 713400                    CLIMB   alt,read
        11 006111   401400 401760                    pmme    nvectors=4
        11 006112   006156 702000 11                 TSX2    s:24763

     2340    24744    4                   WHENRETURN DO;

     2341    24745                                                /* Tell ELF */
     2342    24746    4                        KL_PCD = '0'B;

  24746 11 006113   000000 100400                    MLR     fill='000'O
        11 006114   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 006115   000000 000420 xsym               ADSC9   KL_PCD                   cn=0,n=272

     2343    24747    4                        ADDR(KL_PCD)->KL$ACCTNG.DEVNM = KL_NETWORK_BUF.DEVNM;

  24747 11 006116   040000 100400                    MLR     fill='040'O
        11 006117   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:435  
        11 006120   000001 000010 xsym               ADSC9   KL_PCD+1                 cn=0,n=8

     2344    24748    4                        ADDR(KL_PCD)->KL$ACCTNG.FEX = FEX;

  24748 11 006121   200025 236100                    LDQ     FEX,,AUTO
        11 006122   000033 736000                    QLS     27
        11 006123   000000 552040 xsym               STBQ    KL_PCD,'40'O

     2345    24749    4                        ADDR(KL_PCD)->KL$ACCTNG.REASON = %KLDR_LINE;

  24749 11 006124   000001 236003                    LDQ     1,DU
        11 006125   000000 552020 xsym               STBQ    KL_PCD,'20'O

     2346    24750    4                        KL_DR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  24750 11 006126   000022 237000 12                 LDAQ    18
        11 006127   000002 757000 xsym               STAQ    KL_DR_NETWORK+2

     2347    24751    4                        CALL M$DELREC (KL_DR_NETWORK)

  24751 11 006130   000000 630400 xsym               EPPR0   KL_DR_NETWORK
        11 006131   440002 713400                    CLIMB   alt,+16386
        11 006132   401400 401760                    pmme    nvectors=4
        11 006133   006135 702000 11                 TSX2    s:24754
        11 006134   006135 710000 11                 TRA     s:24754

     2348    24752    5                        WHENALTRETURN DO;

     2349    24753    5                           END;

     2350    24754    4                        KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.KEY);

  24754 11 006135   011000 236003                    LDQ     4608,DU
        11 006136   000000 552040 xsym               STBQ    KL_NETWORK_TERMKEY,'40'O

     2351    24755    4                        KL_NETWORK_TERMKEY.KEY.TERMNAME = KL_NETWORK_BUF.TERMNAME;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:436  
  24755 11 006137   040000 100400                    MLR     fill='040'O
        11 006140   000005 600010 xsym               ADSC9   KL_NETWORK_BUF+5         cn=3,n=8
        11 006141   000000 400010 xsym               ADSC9   KL_NETWORK_TERMKEY       cn=2,n=8

     2352    24756    4                        KL_DR_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);

  24756 11 006142   000034 237000 12                 LDAQ    28
        11 006143   000002 757000 xsym               STAQ    KL_DR_NETWORK+2

     2353    24757    4                        CALL M$DELREC (KL_DR_NETWORK)

  24757 11 006144   000000 630400 xsym               EPPR0   KL_DR_NETWORK
        11 006145   440002 713400                    CLIMB   alt,+16386
        11 006146   401400 401760                    pmme    nvectors=4
        11 006147   006151 702000 11                 TSX2    s:24760
        11 006150   006151 710000 11                 TRA     s:24760

     2354    24758    5                        WHENALTRETURN DO;

     2355    24759    5                           END;

     2356    24760    4                        IF KL$ADMIN.TERMID_LO.LEV = %TERMINAL_ID_LEV_CHAN#

  24760 11 006151   200003 470500                    LDP0    RDBF$,,AUTO
        11 006152   000011 236100                    LDQ     9,,PR0
        11 006153   000777 376003                    ANQ     511,DU
        11 006154   000001 116003                    CMPQ    1,DU
        11 006155   003763 600000 11                 TZE     WRTSYSLOG

     2357    24761    4                        THEN
     2358    24762    4                             GOTO WRTSYSLOG;
     2359    24763    4                      END;

  24763 11 006156   010045 710000 11                 TRA     s:25129

     2360    24764
     2361    24765    3                CASE (%KHA_FNC_ACTIVE);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:437  

     2362    24766    3                   FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE;

  24766 11 006157   000012 235007                    LDA     10,DL
        11 006160   000271 755000 7                  STA     FPT_WRSYSLOG+5

  24766 11 006161                       TELL_ELF     null
     2363    24767
     2364    24768    3   TELL_ELF:       ;
     2365    24769    3                   KL_NETWORK_KEY.KEY.NODE = FEX;

  24769 11 006161   200025 236100                    LDQ     FEX,,AUTO
        11 006162   000011 736000                    QLS     9
        11 006163   000000 552010 xsym               STBQ    KL_NETWORK_KEY,'10'O

     2366    24770    3                   KL_NETWORK_KEY.KEY.TERMID = KL$ADMIN.TERMID_LO;

  24770 11 006164   200003 470500                    LDP0    RDBF$,,AUTO
        11 006165   000000 100500                    MLR     fill='000'O
        11 006166   000011 000020                    ADSC9   9,,PR0                   cn=0,n=16
        11 006167   000000 600020 xsym               ADSC9   KL_NETWORK_KEY           cn=3,n=16

     2367    24771    3                   KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;

  24771 11 006170   000000 236003                    LDQ     0,DU
        11 006171   000000 552004 xsym               STBQ    KL_NETWORK_KEY,'04'O

     2368    24772    3                   KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  24772 11 006172   022000 236003                    LDQ     9216,DU
        11 006173   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     2369    24773    3                   KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  24773 11 006174   000022 237000 12                 LDAQ    18
        11 006175   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:438  
     2370    24774    3                   CALL M$READ (KL_RD_NETWORK)

  24774 11 006176   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 006177   440000 713400                    CLIMB   alt,read
        11 006200   401400 401760                    pmme    nvectors=4
        11 006201   006265 702000 11                 TSX2    s:24803

     2371    24775    4                   WHENRETURN DO;

     2372    24776    4                        KL_PCD = '0'B;

  24776 11 006202   000000 100400                    MLR     fill='000'O
        11 006203   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 006204   000000 000420 xsym               ADSC9   KL_PCD                   cn=0,n=272

     2373    24777    4                        ADDR(KL_PCD)->KL$ACCTNG.DEVNM = KL_NETWORK_BUF.DEVNM;

  24777 11 006205   040000 100400                    MLR     fill='040'O
        11 006206   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8
        11 006207   000001 000010 xsym               ADSC9   KL_PCD+1                 cn=0,n=8

     2374    24778    4                        ADDR(KL_PCD)->KL$ACCTNG.FEX = FEX;

  24778 11 006210   200025 236100                    LDQ     FEX,,AUTO
        11 006211   000033 736000                    QLS     27
        11 006212   000000 552040 xsym               STBQ    KL_PCD,'40'O

     2375    24779    4                        IF FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE

  24779 11 006213   000271 235000 7                  LDA     FPT_WRSYSLOG+5
        11 006214   000012 115007                    CMPA    10,DL
        11 006215   006264 601000 11                 TNZ     s:24800

     2376    24780    5                        THEN DO;

     2377    24781    5                             KL_HLPKEY = KL_NETWORK_BUF.HLPKEY;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:439  
  24781 11 006216   000000 100400                    MLR     fill='000'O
        11 006217   000013 600025 xsym               ADSC9   KL_NETWORK_BUF+11        cn=3,n=21
        11 006220   000000 000025 xsym               ADSC9   KL_HLPKEY                cn=0,n=21

     2378    24782    5                             CALL M$READ (KL_RDHLPR)

  24782 11 006221   000000 630400 xsym               EPPR0   KL_RDHLPR
        11 006222   440000 713400                    CLIMB   alt,read
        11 006223   401400 401760                    pmme    nvectors=4
        11 006224   006264 702000 11                 TSX2    s:24800

     2379    24783    6                             WHENRETURN DO;

     2380    24784    6                                  IF KL_HLPR.FLAGS.GJOB

  24784 11 006225   000000 236000 xsym               LDQ     KL_HLPR
        11 006226   000020 316003                    CANQ    16,DU
        11 006227   006264 600000 11                 TZE     s:24800

     2381    24785    6                                  THEN
     2382    24786    7                                  DO;

     2383    24787    7                                       PARM$ = ADDR(KL_HLPR);

  24787 11 006230   000047 236000 12                 LDQ     39
        11 006231   200034 756100                    STQ     PARM$,,AUTO

     2384    24788    7                                       CALL INDEX (I,' ',KL$DREC.GJOB.UNAME);

  24788 11 006232   200034 470500                    LDP0    PARM$,,AUTO
        11 006233   000000 124500                    SCM     mask='000'O
        11 006234   000022 000014                    ADSC9   18,,PR0                  cn=0,n=12
        11 006235   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 006236   200010 000100                    ARG     I,,AUTO

     2385    24789    7                                       UNAME.C = I;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:440  
  24789 11 006237   200010 236100                    LDQ     I,,AUTO
        11 006240   000033 736000                    QLS     27
        11 006241   200037 552140                    STBQ    UNAME,'40'O,AUTO

     2386    24790    7                                       UNAME.T = KL$DREC.GJOB.UNAME;

  24790 11 006242   040100 100500                    MLR     fill='040'O
        11 006243   000022 000014                    ADSC9   18,,PR0                  cn=0,n=12
        11 006244   200037 200014                    ADSC9   UNAME,,AUTO              cn=1,n=12

     2387    24791    7                                       CALL JGG$TGJOB (UNAME,KL$DREC.GJOB.ACCT,

  24791 11 006245   200034 236100                    LDQ     PARM$,,AUTO
        11 006246   000155 036000 12                 ADLQ    109
        11 006247   200431 756100                    STQ     T$+4,,AUTO
        11 006250   200034 236100                    LDQ     PARM$,,AUTO
        11 006251   000025 036003                    ADLQ    21,DU
        11 006252   200430 756100                    STQ     T$+3,,AUTO
        11 006253   200034 236100                    LDQ     PARM$,,AUTO
        11 006254   000020 036003                    ADLQ    16,DU
        11 006255   200427 756100                    STQ     T$+2,,AUTO
        11 006256   200037 631500                    EPPR1   UNAME,,AUTO
        11 006257   200426 451500                    STP1    T$+1,,AUTO
        11 006260   200426 630500                    EPPR0   T$+1,,AUTO
        11 006261   000022 631400 xsym               EPPR1   B_VECTNIL+18
        11 006262   000000 701000 xent               TSX1    JGG$TGJOB
        11 006263   000000 011000                    NOP     0

     2388    24792        /*
     2389    24793                gjob.cmdcnt is a word count field and tgjob expects a textc
     2390    24794                string.  pincrc to use last byte of cmdcnt field.
     2391    24795        */
     2392    24796    7                                           KL$DREC.GJOB.PASS,PINCRC(ADDR(KL$DREC.GJOB.
             24796                                                     CMDCNT),3)->TEXT$C);
     2393    24797    7                                     END;  /* if gjob */

     2394    24798    6                                END;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:441  

     2395    24799    5                           END;

     2396    24800    4                        GOTO WRTSYSLOG;

  24800 11 006264   003763 710000 11                 TRA     WRTSYSLOG

     2397    24801    4                      END;
     2398    24802    4                   WHENALTRETURN DO;

     2399    24803    4                        IF (KL$ADMIN.TERMID_LO.TTYP = %KLTY_CONT# OR

  24803 11 006265   200003 470500                    LDP0    RDBF$,,AUTO
        11 006266   000011 236100                    LDQ     9,,PR0
        11 006267   777000 376003                    ANQ     -512,DU
        11 006270   011000 116003                    CMPQ    4608,DU
        11 006271   006276 600000 11                 TZE     s:24803+9
        11 006272   004000 116003                    CMPQ    2048,DU
        11 006273   006276 600000 11                 TZE     s:24803+9
        11 006274   010000 116003                    CMPQ    4096,DU
        11 006275   006637 601000 11                 TNZ     s:24885
        11 006276   000271 235000 7                  LDA     FPT_WRSYSLOG+5
        11 006277   000012 115007                    CMPA    10,DL
        11 006300   006637 601000 11                 TNZ     s:24885

     2400    24804    4                             KL$ADMIN.TERMID_LO.TTYP = %KLTY_LINK# OR
     2401    24805    4                             KL$ADMIN.TERMID_LO.TTYP = %KLTY_VIRCIR#) AND
     2402    24806    5                             FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE THEN DO;

     2403    24807    6                             IF KL$ADMIN.TERMID_LO.TTYP = %KLTY_LINK# THEN DO;

  24807 11 006301   004000 116003                    CMPQ    2048,DU
        11 006302   006323 601000 11                 TNZ     s:24817

     2404    24808    6                                  CONFIG_KEY.NODE=FEX;

  24808 11 006303   200025 236100                    LDQ     FEX,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:442  
        11 006304   000011 736000                    QLS     9
        11 006305   000466 552010 7                  STBQ    CONFIG_KEY,'10'O

     2405    24809    6                                  CONFIG_KEY.TERMID = KL$ADMIN.TERMID_LO;

  24809 11 006306   000000 100500                    MLR     fill='000'O
        11 006307   000011 000020                    ADSC9   9,,PR0                   cn=0,n=16
        11 006310   000466 600020 7                  ADSC9   CONFIG_KEY               cn=3,n=16

     2406    24810    6                                  CONFIG_KEY.TERMID.TTYP = 0;

  24810 11 006311   000000 236003                    LDQ     0,DU
        11 006312   000466 552004 7                  STBQ    CONFIG_KEY,'04'O

     2407    24811    6                                  CONFIG_KEY.TERMID.TERM.TERM_NAME = ' ';

  24811 11 006313   040000 100400                    MLR     fill='040'O
        11 006314   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 006315   000470 600010 7                  ADSC9   CONFIG_KEY+2             cn=3,n=8

     2408    24812    6                                  KL_RD_NETCON.BUF_ = VECTOR(CNFG_BUF);

  24812 11 006316   000060 237000 12                 LDAQ    48
        11 006317   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     2409    24813    6                                  KL_RD_NETCON.KEY_ = VECTOR(CONFIG_KEY);

  24813 11 006320   000066 237000 12                 LDAQ    54
        11 006321   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     2410    24814    6                                END;

  24814 11 006322   006332 710000 11                 TRA     s:24821

     2411    24815    6                             ELSE DO;

     2412    24816                                           /* use the termname as the logon string */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:443  
     2413    24817    6                                 LINCNFG.LGN.LGNSIZE = LENGTHC(KL$ADMIN.TERMID_LO.TERM
             24817                                           .TERM_NAME);

  24817 11 006323   000106 471400 7                  LDP1    CNFG$
        11 006324   010000 236007                    LDQ     4096,DL
        11 006325   100012 552110                    STBQ    10,'10'O,PR1

     2414    24818    6                                  LINCNFG.LGN.LGNSTRING = KL$ADMIN.TERMID_LO.TERM.
             24818                                           TERM_NAME;

  24818 11 006326   040100 100500                    MLR     fill='040'O
        11 006327   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
        11 006330   100012 600144                    ADSC9   10,,PR1                  cn=3,n=100

     2415    24819    6                                  GOTO DOSGSCAN;
             24819                                           /* as skip the config since there isn't one */

  24819 11 006331   006336 710000 11                 TRA     DOSGSCAN

     2416    24820    6                                END;
     2417    24821    6                             CALL M$READ(KL_RD_NETCON) WHENRETURN DO;

  24821 11 006332   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 006333   440000 713400                    CLIMB   alt,read
        11 006334   401400 401760                    pmme    nvectors=4
        11 006335   006637 702000 11                 TSX2    s:24885

     2418    24822    7   DOSGSCAN:                      CALL KLH$SGSCAN(LINCNFG.LGN,ACCT,UNAME,PASS,PRO,ERR,
             24822            HOSTNAME,NOSETUP,NOHEADER) WHENRETURN DO;

  24822 11 006336   200054 630500       DOSGSCAN     EPPR0   NOHEADER,,AUTO
        11 006337   200436 450500                    STP0    T$+9,,AUTO
        11 006340   200053 631500                    EPPR1   NOSETUP,,AUTO
        11 006341   200435 451500                    STP1    T$+8,,AUTO
        11 006342   200051 633500                    EPPR3   HOSTNAME,,AUTO
        11 006343   200434 453500                    STP3    T$+7,,AUTO
        11 006344   200050 634500                    EPPR4   ERR,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:444  
        11 006345   200433 454500                    STP4    T$+6,,AUTO
        11 006346   200045 635500                    EPPR5   PRO,,AUTO
        11 006347   200432 455500                    STP5    T$+5,,AUTO
        11 006350   200043 636500                    EPPR6   PASS,,AUTO
        11 006351   200431 456500                    STP6    T$+4,,AUTO
        11 006352   200037 637500                    EPPR7   UNAME,,AUTO
        11 006353   200430 457500                    STP7    T$+3,,AUTO
        11 006354   200035 630500                    EPPR0   ACCT,,AUTO
        11 006355   200427 450500                    STP0    T$+2,,AUTO
        11 006356   000106 236000 7                  LDQ     CNFG$
        11 006357   000071 036000 12                 ADLQ    57
        11 006360   200426 756100                    STQ     T$+1,,AUTO
        11 006361   200426 630500                    EPPR0   T$+1,,AUTO
        11 006362   000065 631400 12                 EPPR1   53
        11 006363   000000 701000 xent               TSX1    KLH$SGSCAN
        11 006364   006374 702000 11                 TSX2    s:24826

     2419    24823    7                                       IF HOSTNAME = ' ' THEN

  24823 11 006365   040000 106500                    CMPC    fill='040'O
        11 006366   200051 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8
        11 006367   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 006370   006374 601000 11                 TNZ     s:24826

     2420    24824    7                                            HOSTNAME = KL_NODENAME;

  24824 11 006371   040100 100400                    MLR     fill='040'O
        11 006372   000000 000010 xsym               ADSC9   KL_NODENAME              cn=0,n=8
        11 006373   200051 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8

     2421    24825    7                                     END;

     2422    24826    6                                  KL_NETWORK_VALID = '0'B;

  24826 11 006374   000000 450000 xsym               STZ     KL_NETWORK_VALID

     2423    24827    6                                  KL_HLPKEY.ACCT=ACCT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:445  

  24827 11 006375   040000 100500                    MLR     fill='040'O
        11 006376   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 006377   000000 200010 xsym               ADSC9   KL_HLPKEY                cn=1,n=8

     2424    24828    6                                  KL_HLPKEY.NAME=UNAME.T;

  24828 11 006400   040000 100500                    MLR     fill='040'O
        11 006401   200037 200014                    ADSC9   UNAME,,AUTO              cn=1,n=12
        11 006402   000002 200014 xsym               ADSC9   KL_HLPKEY+2              cn=1,n=12

     2425    24829    6                                  KL_HLPKEY.CNT=8+UNAME.C;

  24829 11 006403   200037 236100                    LDQ     UNAME,,AUTO
        11 006404   000033 772000                    QRL     27
        11 006405   000010 036007                    ADLQ    8,DL
        11 006406   000033 736000                    QLS     27
        11 006407   000000 552040 xsym               STBQ    KL_HLPKEY,'40'O

     2426    24830    7                                  CALL M$READ(KL_RDHLPR) WHENALTRETURN DO;

  24830 11 006410   000000 630400 xsym               EPPR0   KL_RDHLPR
        11 006411   440000 713400                    CLIMB   alt,read
        11 006412   401400 401760                    pmme    nvectors=4
        11 006413   006415 702000 11                 TSX2    s:24831
        11 006414   006416 710000 11                 TRA     s:24836

     2427    24831    7                                       RETURN;

  24831 11 006415   000000 702200 xent               TSX2  ! X66_ARET

     2428    24832    7                                     END;
     2429    24833                                                /* active without a :network record */
     2430    24834                                      /* stuff a record into :network for this device */
     2431    24835                                                /* Save the terminal name in :NETWORK */
     2432    24836    6                                  KL_NETWORK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_LINE;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:446  
  24836 11 006416   000000 236003                    LDQ     0,DU
        11 006417   000000 552020 xsym               STBQ    KL_NETWORK_KEY,'20'O

     2433    24837    6                                  KL_NETWORK_KEY.KEY.NODE = FEX;

  24837 11 006420   200025 236100                    LDQ     FEX,,AUTO
        11 006421   000011 736000                    QLS     9
        11 006422   000000 552010 xsym               STBQ    KL_NETWORK_KEY,'10'O

     2434    24838    6                                  KL_NETWORK_KEY.KEY.TERMID = KL$ADMIN.TERMID_LO;

  24838 11 006423   200003 470500                    LDP0    RDBF$,,AUTO
        11 006424   000000 100500                    MLR     fill='000'O
        11 006425   000011 000020                    ADSC9   9,,PR0                   cn=0,n=16
        11 006426   000000 600020 xsym               ADSC9   KL_NETWORK_KEY           cn=3,n=16

     2435    24839    6                                  KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;

  24839 11 006427   000000 236003                    LDQ     0,DU
        11 006430   000000 552004 xsym               STBQ    KL_NETWORK_KEY,'04'O

     2436    24840    6                                  KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  24840 11 006431   022000 236003                    LDQ     9216,DU
        11 006432   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     2437    24841    6                                  CALL M$TIME(KL_NETWORK_TIME);

  24841 11 006433   000000 630400 xsym               EPPR0   KL_NETWORK_TIME
        11 006434   020004 713400                    CLIMB   8196
        11 006435   402000 401760                    pmme    nvectors=5

     2438    24842    6                                  KL_NETWORK_BUF.DEVNM = ACCT;

  24842 11 006436   040000 100500                    MLR     fill='040'O
        11 006437   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 006440   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:447  

     2439    24843    6                                  KL_NETWORK_BUF.TERMNAME = ACCT;

  24843 11 006441   040000 100500                    MLR     fill='040'O
        11 006442   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 006443   000005 600010 xsym               ADSC9   KL_NETWORK_BUF+5         cn=3,n=8

     2440    24844    6                                  KL_NETWORK_BUF.ACCT = ACCT;

  24844 11 006444   040000 100500                    MLR     fill='040'O
        11 006445   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 006446   000001 400010 xsym               ADSC9   KL_NETWORK_BUF+1         cn=2,n=8

     2441    24845    6                                  KL_NETWORK_BUF.HLPKEY = KL_HLPKEY;

  24845 11 006447   000000 100400                    MLR     fill='000'O
        11 006450   000000 000025 xsym               ADSC9   KL_HLPKEY                cn=0,n=21
        11 006451   000013 600040 xsym               ADSC9   KL_NETWORK_BUF+11        cn=3,n=32

     2442    24846    6                                  KL_NETWORK_BUF.ATYP = KL_HLPR.ATYP;

  24846 11 006452   000000 236000 xsym               LDQ     KL_HLPR
        11 006453   000001 552040 xsym               STBQ    KL_NETWORK_BUF+1,'40'O

     2443    24847    6                                  KL_NETWORK_BUF.TERMINAL_ID = KL$ADMIN.TERMID_LO;

  24847 11 006454   200003 470500                    LDP0    RDBF$,,AUTO
        11 006455   000000 100500                    MLR     fill='000'O
        11 006456   000011 000020                    ADSC9   9,,PR0                   cn=0,n=16
        11 006457   000007 600020 xsym               ADSC9   KL_NETWORK_BUF+7         cn=3,n=16

     2444    24848    6                                  KL_NETWORK_BUF.NODE = FEX;

  24848 11 006460   200025 236100                    LDQ     FEX,,AUTO
        11 006461   000011 736000                    QLS     9
        11 006462   000005 552010 xsym               STBQ    KL_NETWORK_BUF+5,'10'O

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:448  
     2445    24849    6                                  KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  24849 11 006463   000022 237000 12                 LDAQ    18
        11 006464   000002 757000 xsym               STAQ    KL_WR_NETWORK+2

     2446    24850    6                                  KL_WR_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);

  24850 11 006465   000156 237000 12                 LDAQ    110
        11 006466   000004 757000 xsym               STAQ    KL_WR_NETWORK+4

     2447    24851    7                                  CALL M$WRITE (KL_WR_NETWORK) WHENALTRETURN DO;

  24851 11 006467   000000 630400 xsym               EPPR0   KL_WR_NETWORK
        11 006470   440001 713400                    CLIMB   alt,write
        11 006471   401400 401760                    pmme    nvectors=4
        11 006472   006474 702000 11                 TSX2    s:24852
        11 006473   006475 710000 11                 TRA     s:24854

     2448    24852    7                                       RETURN;

  24852 11 006474   000000 702200 xent               TSX2  ! X66_ARET

     2449    24853    7                                     END;
     2450    24854    6                                 KL_NETWORK_TERMKEY.SIZE = LENGTHC(KL_NETWORK_TERMKEY.
             24854                                           KEY);

  24854 11 006475   011000 236003                    LDQ     4608,DU
        11 006476   000000 552040 xsym               STBQ    KL_NETWORK_TERMKEY,'40'O

     2451    24855    6                                  KL_NETWORK_TERMKEY.KEY.TERMNAME = ACCT;

  24855 11 006477   040000 100500                    MLR     fill='040'O
        11 006500   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 006501   000000 400010 xsym               ADSC9   KL_NETWORK_TERMKEY       cn=2,n=8

     2452    24856    6                                  KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_TERMKEY);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:449  
  24856 11 006502   000034 237000 12                 LDAQ    28
        11 006503   000002 757000 xsym               STAQ    KL_WR_NETWORK+2

     2453    24857    7                                  CALL M$WRITE (KL_WR_NETWORK) WHENALTRETURN DO;

  24857 11 006504   000000 630400 xsym               EPPR0   KL_WR_NETWORK
        11 006505   440001 713400                    CLIMB   alt,write
        11 006506   401400 401760                    pmme    nvectors=4
        11 006507   006511 702000 11                 TSX2    s:24861
        11 006510   006511 710000 11                 TRA     s:24861

     2454    24858    7                                     END;

     2455    24859
     2456    24860                                      /* Inform ELF about the device going active */
     2457    24861    6                                  KL_PCD = '0'B;

  24861 11 006511   000000 100400                    MLR     fill='000'O
        11 006512   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 006513   000000 000420 xsym               ADSC9   KL_PCD                   cn=0,n=272

     2458    24862    6                                  KL_PCD.ADDD.FEX = FEX;

  24862 11 006514   200025 236100                    LDQ     FEX,,AUTO
        11 006515   000000 552004 xsym               STBQ    KL_PCD,'04'O

     2459    24863    6                                  KL_PCD.ADDD.TERMID.LEV = KL$ADMIN.TERMID_LO.LEV;

  24863 11 006516   200003 470500                    LDP0    RDBF$,,AUTO
        11 006517   000011 236100                    LDQ     9,,PR0
        11 006520   000011 772000                    QRL     9
        11 006521   000003 552010 xsym               STBQ    KL_PCD+3,'10'O

     2460    24864    6                                 CALL KLX$8TO9(KL$ADMIN.TERMID_LO.TERM.CHANNEL,KL_PCD.
             24864                                           ADDD.TERMID.CHAN,2);

  24864 11 006522   000042 236000 12                 LDQ     34
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:450  
        11 006523   200430 756100                    STQ     T$+3,,AUTO
        11 006524   000076 236000 12                 LDQ     62
        11 006525   200427 756100                    STQ     T$+2,,AUTO
        11 006526   200003 236100                    LDQ     RDBF$,,AUTO
        11 006527   000160 036000 12                 ADLQ    112
        11 006530   200426 756100                    STQ     T$+1,,AUTO
        11 006531   200426 630500                    EPPR0   T$+1,,AUTO
        11 006532   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006533   000000 701000 xent               TSX1    KLX$8TO9
        11 006534   000000 011000                    NOP     0

     2461    24865    6                                  CALL KLX$8TO9(KL$ADMIN.TERMID_LO.TERM.SUBDEVICE,
             24865                                           KL_PCD.ADDD.TERMID.SUB,2);

  24865 11 006535   000042 236000 12                 LDQ     34
        11 006536   200430 756100                    STQ     T$+3,,AUTO
        11 006537   000077 236000 12                 LDQ     63
        11 006540   200427 756100                    STQ     T$+2,,AUTO
        11 006541   200003 236100                    LDQ     RDBF$,,AUTO
        11 006542   000012 036003                    ADLQ    10,DU
        11 006543   200426 756100                    STQ     T$+1,,AUTO
        11 006544   200426 630500                    EPPR0   T$+1,,AUTO
        11 006545   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006546   000000 701000 xent               TSX1    KLX$8TO9
        11 006547   000000 011000                    NOP     0

     2462    24866    6                                  CALL KLX$8TO9(KL$ADMIN.TERMID_LO.TERM.SUBSUBDEVICE,
             24866                                           KL_PCD.ADDD.TERMID.SUBSUB,2);

  24866 11 006550   000042 236000 12                 LDQ     34
        11 006551   200430 756100                    STQ     T$+3,,AUTO
        11 006552   000101 236000 12                 LDQ     65
        11 006553   200427 756100                    STQ     T$+2,,AUTO
        11 006554   200003 236100                    LDQ     RDBF$,,AUTO
        11 006555   000071 036000 12                 ADLQ    57
        11 006556   200426 756100                    STQ     T$+1,,AUTO
        11 006557   200426 630500                    EPPR0   T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:451  
        11 006560   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006561   000000 701000 xent               TSX1    KLX$8TO9
        11 006562   000000 011000                    NOP     0

     2463    24867    6                                 CALL KLX$CONV_NODE(KL_PCD.ADDD.FEPNAME,FEX,NODETYPE);

  24867 11 006563   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 006564   200430 450500                    STP0    T$+3,,AUTO
        11 006565   200025 631500                    EPPR1   FEX,,AUTO
        11 006566   200427 451500                    STP1    T$+2,,AUTO
        11 006567   000102 236000 12                 LDQ     66
        11 006570   200426 756100                    STQ     T$+1,,AUTO
        11 006571   200426 630500                    EPPR0   T$+1,,AUTO
        11 006572   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006573   000000 701000 xent               TSX1    KLX$CONV_NODE
        11 006574   000000 011000                    NOP     0

     2464    24868    6                                  KL_PCD.ADDD.ACTYP = %KLAC_TRM;

  24868 11 006575   002000 236003                    LDQ     1024,DU
        11 006576   000000 552040 xsym               STBQ    KL_PCD,'40'O

     2465    24869    6                                  KL_PCD.ADDD.ASSOCTRM = ACCT;

  24869 11 006577   040000 100500                    MLR     fill='040'O
        11 006600   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 006601   000011 400010 xsym               ADSC9   KL_PCD+9                 cn=2,n=8

     2466    24870    6                                  KL_PCD.ADDD.TNAME = KL_HLPR.TNAME;

  24870 11 006602   040000 100400                    MLR     fill='040'O
        11 006603   000013 000010 xsym               ADSC9   KL_HLPR+11               cn=0,n=8
        11 006604   000007 400010 xsym               ADSC9   KL_PCD+7                 cn=2,n=8

     2467    24871    6                                  KL_PCD.ADDD.TWSN = KL_HLPR.TWSN#;

  24871 11 006605   040000 100400                    MLR     fill='040'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:452  
        11 006606   000001 000004 xsym               ADSC9   KL_HLPR+1                cn=0,n=4
        11 006607   000013 400004 xsym               ADSC9   KL_PCD+11                cn=2,n=4

     2468    24872    6                                  KL_PCD.ADDD.ATYP = KL_HLPR.ATYP;

  24872 11 006610   000000 236000 xsym               LDQ     KL_HLPR
        11 006611   000011 772000                    QRL     9
        11 006612   000000 552020 xsym               STBQ    KL_PCD,'20'O

     2469    24873    6                                  KL_PCD.ADDD.DEVNM = ACCT;

  24873 11 006613   040000 100500                    MLR     fill='040'O
        11 006614   200035 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
        11 006615   000005 400010 xsym               ADSC9   KL_PCD+5                 cn=2,n=8

     2470    24874    6                                  FPT_WRSYSLOG.V.TYPE# = EL_CONN;

  24874 11 006616   000001 235007                    LDA     1,DL
        11 006617   000271 755000 7                  STA     FPT_WRSYSLOG+5

  24874 11 006620                       WRTSYSLOG2   null
     2471    24875    6   WRTSYSLOG2:                    ;
     2472    24876    7                                  CALL M$WRSYSLOG (FPT_WRSYSLOG) WHENALTRETURN DO;

  24876 11 006620   000264 630400 7                  EPPR0   FPT_WRSYSLOG
        11 006621   470001 713400                    CLIMB   alt,+28673
        11 006622   400400 401760                    pmme    nvectors=2
        11 006623   006625 702000 11                 TSX2    s:24877
        11 006624   006631 710000 11                 TRA     s:24880

     2473    24877    7                                       CALL M$WAIT (FPT_WAIT);

  24877 11 006625   000010 630400 10                 EPPR0   FPT_WAIT
        11 006626   020006 713400                    CLIMB   8198
        11 006627   400400 401760                    pmme    nvectors=2

     2474    24878    7                                       GOTO WRTSYSLOG2;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:453  

  24878 11 006630   006620 710000 11                 TRA     WRTSYSLOG2

     2475    24879    7                                     END;
     2476    24880    6                                  FPT_WRSYSLOG.V.TYPE# = EL_ACTIVE;

  24880 11 006631   000012 235007                    LDA     10,DL
        11 006632   000271 755000 7                  STA     FPT_WRSYSLOG+5

     2477    24881    6                                  KL$ADMIN.TERMID_LO.TTYP = 0;
             24881                                           /* so we dont loop if this fails */

  24881 11 006633   200003 470500                    LDP0    RDBF$,,AUTO
        11 006634   000000 236003                    LDQ     0,DU
        11 006635   000011 552140                    STBQ    9,'40'O,PR0

     2478    24882    6                                  GOTO TELL_ELF;

  24882 11 006636   006161 710000 11                 TRA     TELL_ELF

     2479    24883    6                                END;       /* whenreturn klh$sgscan */
     2480    24884    5                           END;            /* cont or link or vircir */

     2481    24885    4                      END;                 /* whenaltreturn */

  24885 11 006637   010045 710000 11                 TRA     s:25129

     2482    24886
     2483    24887    3                CASE (%KHA_FNC_NOTACTIVE);

     2484    24888    3                   FPT_WRSYSLOG.V.TYPE# = EL_NOTACTIVE;

  24888 11 006640   000013 235007                    LDA     11,DL
        11 006641   000271 755000 7                  STA     FPT_WRSYSLOG+5

     2485    24889    3                   GOTO TELL_ELF;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:454  
  24889 11 006642   006161 710000 11                 TRA     TELL_ELF

     2486    24890
     2487    24891    3                END;                       /* End cases */

  24891 11 006643   010045 710000 11                 TRA     s:25129

     2488    24892    3                ELSE DO;                   /* Msg is from FEP */

     2489    24893    3                     IF KL$ADMIN.ORIGIN ~= 'KEYIN'

  24893 11 006644   040000 106500                    CMPC    fill='040'O
        11 006645   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
        11 006646   000214 000005 10                 ADSC9   CKBR+10                  cn=0,n=5
        11 006647   006664 600000 11                 TZE     s:24899

     2490    24894    3                     THEN
     2491    24895    4                          CALL KLX$WRHLPSTA(KL$ADMIN,KL_MARS,KL$ADMIN.ORIGIN)
             24895                                   WHENALTRETURN DO;

  24895 11 006650   200003 236100                    LDQ     RDBF$,,AUTO
        11 006651   000003 036003                    ADLQ    3,DU
        11 006652   200430 756100                    STQ     T$+3,,AUTO
        11 006653   000154 236000 12                 LDQ     108
        11 006654   200003 235100                    LDA     RDBF$,,AUTO
        11 006655   200426 757100                    STAQ    T$+1,,AUTO
        11 006656   200426 630500                    EPPR0   T$+1,,AUTO
        11 006657   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006660   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 006661   006663 702000 11                 TSX2    s:24897
        11 006662   006663 710000 11                 TRA     s:24897

     2492    24896                            /*N* WHAT DO WE DO?  */
     2493    24897    4                             END;          /* WHENALTRETURN */

  24897 11 006663   010045 710000 11                 TRA     s:25129

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:455  
     2494    24898    4                     ELSE DO;

     2495    24899    4                          KBERR = CKBR;

  24899 11 006664   000100 100400                    MLR     fill='000'O
        11 006665   000202 000047 10                 ADSC9   CKBR                     cn=0,n=39
        11 006666   200402 000047                    ADSC9   KBERR,,AUTO              cn=0,n=39

     2496    24900    4                          KBERR.FEX = FEX;

  24900 11 006667   200025 236100                    LDQ     FEX,,AUTO
        11 006670   000022 736000                    QLS     18
        11 006671   200410 552120                    STBQ    KBERR+6,'20'O,AUTO

     2497    24901    4                          KBERR.PORT.B = KL$ADMIN.TERMID_LO.TERM.CHANNEL.BYT(1);

  24901 11 006672   000011 236100                    LDQ     9,,PR0
        11 006673   000033 736000                    QLS     27
        11 006674   200411 676100                    ERQ     KBERR+7,,AUTO
        11 006675   377000 376003                    ANQ     130560,DU
        11 006676   200411 656100                    ERSQ    KBERR+7,,AUTO

     2498    24902    4                          KBERR.PORT.T = KL$ADMIN.TERMID_LO.TERM.CHANNEL.BYT(0);

  24902 11 006677   003100 061500                    CSR     bolr='003'O
        11 006700   000011 410010                    BDSC    9,,PR0                   by=2,bit=1,n=8
        11 006701   200410 600012                    BDSC    KBERR+6,,AUTO            by=3,bit=0,n=10

     2499    24903    4                          KBERR.PORT_HI.B = KL$ADMIN.TERMID_HI.TERM.CHANNEL.BYT(1);

  24903 11 006702   000015 236100                    LDQ     13,,PR0
        11 006703   000011 736000                    QLS     9
        11 006704   200411 676100                    ERQ     KBERR+7,,AUTO
        11 006705   377000 376007                    ANQ     130560,DL
        11 006706   200411 656100                    ERSQ    KBERR+7,,AUTO

     2500    24904    4                          KBERR.PORT_HI.T = KL$ADMIN.TERMID_HI.TERM.CHANNEL.BYT(0);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:456  

  24904 11 006707   000015 236100                    LDQ     13,,PR0
        11 006710   377000 376007                    ANQ     130560,DL
        11 006711   000010 736000                    QLS     8
        11 006712   200411 676100                    ERQ     KBERR+7,,AUTO
        11 006713   000161 376000 12                 ANQ     113
        11 006714   200411 656100                    ERSQ    KBERR+7,,AUTO

     2501    24905    4                          KBERR.ERR = KL$ADMIN.FNC;

  24905 11 006715   000010 236100                    LDQ     8,,PR0
        11 006716   000011 736000                    QLS     9
        11 006717   200410 552110                    STBQ    KBERR+6,'10'O,AUTO

     2502    24906    4                          WKBER.BUF_ = VECTOR(KBERR);

  24906 11 006720   000031 235000 12                 LDA     25
        11 006721   200426 452500                    STP2    T$+1,,AUTO
        11 006722   200426 236100                    LDQ     T$+1,,AUTO
        11 006723   000402 036003                    ADLQ    258,DU
        11 006724   000426 757000 7                  STAQ    WKBER+4

     2503    24907    4                          IF KL$ADMIN.RESULTS = '0'B

  24907 11 006725   000007 235100                    LDA     7,,PR0
        11 006726   006732 601000 11                 TNZ     s:24911

     2504    24908    4                          THEN
     2505    24909    4                               KBERR.MSG# = NABL_MSG#;

  24909 11 006727   000272 221003                    LDX1    186,DU
        11 006730   200402 441100                    SXL1    KBERR,,AUTO
        11 006731   006734 710000 11                 TRA     s:24912

     2506    24910    4                          ELSE
     2507    24911    4                               KBERR.MSG# = NABLERR_MSG#;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:457  
  24911 11 006732   000273 221003                    LDX1    187,DU
        11 006733   200402 441100                    SXL1    KBERR,,AUTO

     2508    24912    4                          KBERR.CADDR = M_COMM;

  24912 11 006734   004000 222003                    LDX2    2048,DU
        11 006735   200402 742100                    STX2    KBERR,,AUTO

     2509    24913    5                          CALL M$WRITE(WKBER) WHENALTRETURN DO;

  24913 11 006736   000422 630400 7                  EPPR0   WKBER
        11 006737   440001 713400                    CLIMB   alt,write
        11 006740   401400 401760                    pmme    nvectors=4
        11 006741   006743 702000 11                 TSX2    s:24916
        11 006742   006743 710000 11                 TRA     s:24916

     2510    24914    5                             END;

     2511    24915    4                        END;

     2512    24916    3                   END;                    /* ELSE */

  24916 11 006743   010045 710000 11                 TRA     s:25129

     2513    24917        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:458  
     2514    24918    2        CASE(IGA_RUE);

     2515    24919    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */

  24919 11 006744   000000 220000 xsym               LDX0    KL_STATION
        11 006745   000222 100000 10                 CMPX0   CKBR+16
        11 006746   007051 601000 11                 TNZ     s:24939

     2516    24920    3                CALL KLX$CONV_NODENAME (KL$RUE.NODE,FEX,NODETYPE)

  24920 11 006747   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 006750   200430 450500                    STP0    T$+3,,AUTO
        11 006751   200025 631500                    EPPR1   FEX,,AUTO
        11 006752   200427 451500                    STP1    T$+2,,AUTO
        11 006753   200003 236100                    LDQ     RDBF$,,AUTO
        11 006754   000005 036003                    ADLQ    5,DU
        11 006755   200426 756100                    STQ     T$+1,,AUTO
        11 006756   200426 630500                    EPPR0   T$+1,,AUTO
        11 006757   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006760   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 006761   007025 702000 11                 TSX2    SEND_RUE_ERR

     2517    24921    4                WHENRETURN DO;

     2518    24922    4                     IF NODETYPE ~= %KL_NODETYPE_FEP

  24922 11 006762   200026 235100                    LDA     NODETYPE,,AUTO
        11 006763   000002 115007                    CMPA    2,DL
        11 006764   006767 600000 11                 TZE     s:24926
        11 006765   000004 115007                    CMPA    4,DL
        11 006766   007025 601000 11                 TNZ     SEND_RUE_ERR

     2519    24923    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2520    24924    4                     THEN
     2521    24925    4                          GOTO SEND_RUE_ERR;
     2522    24926    4                     CALL KLX$WRHLPNODE(KL$RUE,SIZEC(KL$RUE),FEX)

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:459  
  24926 11 006767   200025 630500                    EPPR0   FEX,,AUTO
        11 006770   200430 450500                    STP0    T$+3,,AUTO
        11 006771   000013 236000 12                 LDQ     11
        11 006772   200003 235100                    LDA     RDBF$,,AUTO
        11 006773   200426 757100                    STAQ    T$+1,,AUTO
        11 006774   200426 630500                    EPPR0   T$+1,,AUTO
        11 006775   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 006776   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 006777   007001 702000 11                 TSX2    s:24928
        11 007000   007024 710000 11                 TRA     s:24931

     2523    24927    5                     WHENALTRETURN DO;

     2524    24928    5                          CALL XUR$ERRTOLCP6(KL$RUE.RESULTS,NODENA);

  24928 11 007001   000151 236000 12                 LDQ     105
        11 007002   200427 756100                    STQ     T$+2,,AUTO
        11 007003   200003 236100                    LDQ     RDBF$,,AUTO
        11 007004   000007 036003                    ADLQ    7,DU
        11 007005   200426 756100                    STQ     T$+1,,AUTO
        11 007006   200426 630500                    EPPR0   T$+1,,AUTO
        11 007007   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 007010   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 007011   000000 011000                    NOP     0

     2525    24929    5                          CALL KLX$WRHLPSTA (KL$RUE,SIZEC(KL$RUE),KL$RUE.ORIGIN);

  24929 11 007012   200003 236100                    LDQ     RDBF$,,AUTO
        11 007013   000003 036003                    ADLQ    3,DU
        11 007014   200430 756100                    STQ     T$+3,,AUTO
        11 007015   000013 236000 12                 LDQ     11
        11 007016   200003 235100                    LDA     RDBF$,,AUTO
        11 007017   200426 757100                    STAQ    T$+1,,AUTO
        11 007020   200426 630500                    EPPR0   T$+1,,AUTO
        11 007021   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007022   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007023   000000 011000                    NOP     0
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:460  

     2526    24930    5                        END;

     2527    24931    4                   END;

  24931 11 007024   007050 710000 11                 TRA     s:24937

     2528    24932    4                WHENALTRETURN DO;

     2529    24933    4   SEND_RUE_ERR:     ;

  24933 11 007025                       SEND_RUE_ERR null
     2530    24934    4                     CALL XUR$ERRTOLCP6(KL$RUE.RESULTS,NOFE);

  24934 11 007025   000146 236000 12                 LDQ     102
        11 007026   200427 756100                    STQ     T$+2,,AUTO
        11 007027   200003 236100                    LDQ     RDBF$,,AUTO
        11 007030   000007 036003                    ADLQ    7,DU
        11 007031   200426 756100                    STQ     T$+1,,AUTO
        11 007032   200426 630500                    EPPR0   T$+1,,AUTO
        11 007033   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 007034   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 007035   000000 011000                    NOP     0

     2531    24935    4                     CALL KLX$WRHLPSTA(KL$RUE,SIZEC(KL$RUE),KL$RUE.ORIGIN);

  24935 11 007036   200003 236100                    LDQ     RDBF$,,AUTO
        11 007037   000003 036003                    ADLQ    3,DU
        11 007040   200430 756100                    STQ     T$+3,,AUTO
        11 007041   000013 236000 12                 LDQ     11
        11 007042   200003 235100                    LDA     RDBF$,,AUTO
        11 007043   200426 757100                    STAQ    T$+1,,AUTO
        11 007044   200426 630500                    EPPR0   T$+1,,AUTO
        11 007045   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007046   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007047   000000 011000                    NOP     0

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:461  
     2532    24936    4                   END;

     2533    24937    3              END;                         /* IF */

  24937 11 007050   010045 710000 11                 TRA     s:25129

     2534    24938    3           ELSE DO;                        /* Msg is from FEP */

     2535    24939    3                IF KL$RUE.ORIGIN ~= 'KEYIN'

  24939 11 007051   200003 470500                    LDP0    RDBF$,,AUTO
        11 007052   040000 106500                    CMPC    fill='040'O
        11 007053   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
        11 007054   000214 000005 10                 ADSC9   CKBR+10                  cn=0,n=5
        11 007055   007072 600000 11                 TZE     s:24945

     2536    24940    3                THEN
     2537    24941    4                     CALL KLX$WRHLPSTA(KL$RUE,SIZEC(KL$RUE),KL$RUE.ORIGIN)
             24941                              WHENALTRETURN DO;

  24941 11 007056   200003 236100                    LDQ     RDBF$,,AUTO
        11 007057   000003 036003                    ADLQ    3,DU
        11 007060   200430 756100                    STQ     T$+3,,AUTO
        11 007061   000013 236000 12                 LDQ     11
        11 007062   200003 235100                    LDA     RDBF$,,AUTO
        11 007063   200426 757100                    STAQ    T$+1,,AUTO
        11 007064   200426 630500                    EPPR0   T$+1,,AUTO
        11 007065   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007066   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007067   007071 702000 11                 TSX2    s:24943
        11 007070   007071 710000 11                 TRA     s:24943

     2538    24942                            /*N* WHAT DO WE DO?  */
     2539    24943    4                        END;               /* WHENALTRETURN */

  24943 11 007071   010045 710000 11                 TRA     s:25129

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:462  
     2540    24944    4                ELSE DO;

     2541    24945    4                     KBERR = CKBR;

  24945 11 007072   000100 100400                    MLR     fill='000'O
        11 007073   000202 000047 10                 ADSC9   CKBR                     cn=0,n=39
        11 007074   200402 000047                    ADSC9   KBERR,,AUTO              cn=0,n=39

     2542    24946    4                     CALL KLX$CONV_NODE(KBERR.NAME,FEX,NODETYPE);

  24946 11 007075   200026 631500                    EPPR1   NODETYPE,,AUTO
        11 007076   200430 451500                    STP1    T$+3,,AUTO
        11 007077   200025 633500                    EPPR3   FEX,,AUTO
        11 007100   200427 453500                    STP3    T$+2,,AUTO
        11 007101   200431 452500                    STP2    T$+4,,AUTO
        11 007102   200431 236100                    LDQ     T$+4,,AUTO
        11 007103   000162 036000 12                 ADLQ    114
        11 007104   200426 756100                    STQ     T$+1,,AUTO
        11 007105   200426 630500                    EPPR0   T$+1,,AUTO
        11 007106   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007107   000000 701000 xent               TSX1    KLX$CONV_NODE
        11 007110   000000 011000                    NOP     0

     2543    24947    4                     KBERR.FEX = FEX;

  24947 11 007111   200025 236100                    LDQ     FEX,,AUTO
        11 007112   000022 736000                    QLS     18
        11 007113   200410 552120                    STBQ    KBERR+6,'20'O,AUTO

     2544    24948    4                     KBERR.PORT.B = MOD(KL$RUE.SYSID#,256);

  24948 11 007114   200003 470500                    LDP0    RDBF$,,AUTO
        11 007115   000010 236100                    LDQ     8,,PR0
        11 007116   777777 376007                    ANQ     -1,DL
        11 007117   000377 376007                    ANQ     255,DL
        11 007120   000033 736000                    QLS     27
        11 007121   200411 676100                    ERQ     KBERR+7,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:463  
        11 007122   377000 376003                    ANQ     130560,DU
        11 007123   200411 656100                    ERSQ    KBERR+7,,AUTO

     2545    24949    4                     KBERR.PORT.T = KL$RUE.SYSID#/512;

  24949 11 007124   000010 236100                    LDQ     8,,PR0
        11 007125   777777 376007                    ANQ     -1,DL
        11 007126   000011 772000                    QRL     9
        11 007127   200426 756100                    STQ     T$+1,,AUTO
        11 007130   003100 061500                    CSR     bolr='003'O
        11 007131   200426 000044                    BDSC    T$+1,,AUTO               by=0,bit=0,n=36
        11 007132   200410 600012                    BDSC    KBERR+6,,AUTO            by=3,bit=0,n=10

     2546    24950    4                     WKBER.BUF_ = VECTOR(KBERR);

  24950 11 007133   000031 235000 12                 LDA     25
        11 007134   200426 452500                    STP2    T$+1,,AUTO
        11 007135   200426 236100                    LDQ     T$+1,,AUTO
        11 007136   000402 036003                    ADLQ    258,DU
        11 007137   000426 757000 7                  STAQ    WKBER+4

     2547    24951    4                     IF KL$RUE.RESULTS = '0'B

  24951 11 007140   000007 235100                    LDA     7,,PR0
        11 007141   007145 601000 11                 TNZ     s:24955

     2548    24952    4                     THEN
     2549    24953    4                          KBERR.ERR = 0;

  24953 11 007142   000000 236003                    LDQ     0,DU
        11 007143   200410 552110                    STBQ    KBERR+6,'10'O,AUTO
        11 007144   007147 710000 11                 TRA     s:24956

     2550    24954    4                     ELSE
     2551    24955    4                          KBERR.ERR = 1;

  24955 11 007145   001000 236007                    LDQ     512,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:464  
        11 007146   200410 552110                    STBQ    KBERR+6,'10'O,AUTO

     2552    24956    4                     KBERR.MSG# = X_MSG#;

  24956 11 007147   000275 220003                    LDX0    189,DU
        11 007150   200402 440100                    SXL0    KBERR,,AUTO

     2553    24957    4                     KBERR.CADDR = M_COMM;

  24957 11 007151   004000 221003                    LDX1    2048,DU
        11 007152   200402 741100                    STX1    KBERR,,AUTO

     2554    24958    5                     CALL M$WRITE(WKBER) WHENALTRETURN DO;

  24958 11 007153   000422 630400 7                  EPPR0   WKBER
        11 007154   440001 713400                    CLIMB   alt,write
        11 007155   401400 401760                    pmme    nvectors=4
        11 007156   007160 702000 11                 TSX2    s:24961
        11 007157   007160 710000 11                 TRA     s:24961

     2555    24959    5                        END;

     2556    24960    4                   END;

     2557    24961    3              END;                         /* ELSE */

  24961 11 007160   010045 710000 11                 TRA     s:25129

     2558    24962        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:465  
     2559    24963    2        CASE(IGA_REQSTATS);

     2560    24964    3           IF SUBSTR(KL_STATION,0,2) = 'ST' THEN DO; /* Msg is from STATS */

  24964 11 007161   000000 220000 xsym               LDX0    KL_STATION
        11 007162   000225 100000 10                 CMPX0   CKBR+19
        11 007163   007277 601000 11                 TNZ     s:24992

     2561    24965    3                FEX = KL$REQSTATS.NODE_NUM;

  24965 11 007164   200003 470500                    LDP0    RDBF$,,AUTO
        11 007165   000000 236100                    LDQ     0,,PR0
        11 007166   000022 772000                    QRL     18
        11 007167   000777 376007                    ANQ     511,DL
        11 007170   200025 756100                    STQ     FEX,,AUTO

     2562    24966    3                CALL KLX$CONV_NODE (KL$REQSTATS.FEPNAME,FEX,NODETYPE)

  24966 11 007171   200026 631500                    EPPR1   NODETYPE,,AUTO
        11 007172   200430 451500                    STP1    T$+3,,AUTO
        11 007173   200025 633500                    EPPR3   FEX,,AUTO
        11 007174   200427 453500                    STP3    T$+2,,AUTO
        11 007175   200003 236100                    LDQ     RDBF$,,AUTO
        11 007176   000004 036003                    ADLQ    4,DU
        11 007177   200426 756100                    STQ     T$+1,,AUTO
        11 007200   200426 630500                    EPPR0   T$+1,,AUTO
        11 007201   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007202   000000 701000 xent               TSX1    KLX$CONV_NODE
        11 007203   007253 702000 11                 TSX2    SEND_REQSTATS_ERR

     2563    24967    4                WHENRETURN DO;

     2564    24968    4                     IF NODETYPE ~= %KL_NODETYPE_FEP

  24968 11 007204   200026 235100                    LDA     NODETYPE,,AUTO
        11 007205   000002 115007                    CMPA    2,DL
        11 007206   007211 600000 11                 TZE     s:24972
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:466  
        11 007207   000004 115007                    CMPA    4,DL
        11 007210   007253 601000 11                 TNZ     SEND_REQSTATS_ERR

     2565    24969    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2566    24970    4                     THEN
     2567    24971    4                          GOTO SEND_REQSTATS_ERR;
     2568    24972    4                     KL$REQSTATS.SRCE_NODE = KL_NODE;

  24972 11 007211   200003 470500                    LDP0    RDBF$,,AUTO
        11 007212   000000 236000 xsym               LDQ     KL_NODE
        11 007213   000011 736000                    QLS     9
        11 007214   000000 552110                    STBQ    0,'10'O,PR0

     2569    24973    4                     CALL KLX$WRHLPNODE(KL$REQSTATS,SIZEC(KL$REQSTATS),FEX)

  24973 11 007215   200025 631500                    EPPR1   FEX,,AUTO
        11 007216   200430 451500                    STP1    T$+3,,AUTO
        11 007217   000013 236000 12                 LDQ     11
        11 007220   200003 235100                    LDA     RDBF$,,AUTO
        11 007221   200426 757100                    STAQ    T$+1,,AUTO
        11 007222   200426 630500                    EPPR0   T$+1,,AUTO
        11 007223   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007224   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 007225   007227 702000 11                 TSX2    s:24975
        11 007226   007252 710000 11                 TRA     s:24981

     2570    24974    5                     WHENALTRETURN DO;

     2571    24975    5                          CALL XUR$ERRTOLCP6(KL$REQSTATS.ERRCODE,NODENA);

  24975 11 007227   000151 236000 12                 LDQ     105
        11 007230   200427 756100                    STQ     T$+2,,AUTO
        11 007231   200003 236100                    LDQ     RDBF$,,AUTO
        11 007232   000001 036003                    ADLQ    1,DU
        11 007233   200426 756100                    STQ     T$+1,,AUTO
        11 007234   200426 630500                    EPPR0   T$+1,,AUTO
        11 007235   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:467  
        11 007236   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 007237   000000 011000                    NOP     0

     2572    24976                       /*   ERROR: KLI-E$NODENA-4
     2573    24977                            MESSAGE: That node is not currently available.
     2574    24978                             */
     2575    24979    5                         CALL KLX$WRHLPSTA (KL$REQSTATS,SIZEC(KL$REQSTATS),KL$REQSTATS
             24979                                   .STATSSTA);

  24979 11 007240   200003 236100                    LDQ     RDBF$,,AUTO
        11 007241   000002 036003                    ADLQ    2,DU
        11 007242   200430 756100                    STQ     T$+3,,AUTO
        11 007243   000013 236000 12                 LDQ     11
        11 007244   200003 235100                    LDA     RDBF$,,AUTO
        11 007245   200426 757100                    STAQ    T$+1,,AUTO
        11 007246   200426 630500                    EPPR0   T$+1,,AUTO
        11 007247   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007250   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007251   000000 011000                    NOP     0

     2576    24980    5                        END;

     2577    24981    4                   END;

  24981 11 007252   007276 710000 11                 TRA     s:24990

     2578    24982    4                WHENALTRETURN DO;

     2579    24983    4   SEND_REQSTATS_ERR: ;

  24983 11 007253                       SEND_REQSTA* null
     2580    24984    4                     CALL XUR$ERRTOLCP6(KL$REQSTATS.ERRCODE,NOFE);

  24984 11 007253   000146 236000 12                 LDQ     102
        11 007254   200427 756100                    STQ     T$+2,,AUTO
        11 007255   200003 236100                    LDQ     RDBF$,,AUTO
        11 007256   000001 036003                    ADLQ    1,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:468  
        11 007257   200426 756100                    STQ     T$+1,,AUTO
        11 007260   200426 630500                    EPPR0   T$+1,,AUTO
        11 007261   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 007262   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 007263   000000 011000                    NOP     0

     2581    24985                  /*   ERROR: KLI-E$NOFE-4
     2582    24986                       MESSAGE: That FEP does not exist.
     2583    24987                        */
     2584    24988    4                     CALL KLX$WRHLPSTA(KL$REQSTATS,SIZEC(KL$REQSTATS),KL$REQSTATS.
             24988                              STATSSTA);

  24988 11 007264   200003 236100                    LDQ     RDBF$,,AUTO
        11 007265   000002 036003                    ADLQ    2,DU
        11 007266   200430 756100                    STQ     T$+3,,AUTO
        11 007267   000013 236000 12                 LDQ     11
        11 007270   200003 235100                    LDA     RDBF$,,AUTO
        11 007271   200426 757100                    STAQ    T$+1,,AUTO
        11 007272   200426 630500                    EPPR0   T$+1,,AUTO
        11 007273   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007274   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007275   000000 011000                    NOP     0

     2585    24989    4                   END;

     2586    24990    3              END;                         /* IF */

  24990 11 007276   010045 710000 11                 TRA     s:25129

     2587    24991    3           ELSE DO;                        /* Msg is from FEP */

     2588    24992    4                CALL KLX$WRHLPSTA(KL$REQSTATS,KL_MARS,KL$REQSTATS.STATSSTA)
             24992                         WHENALTRETURN DO;

  24992 11 007277   200003 236100                    LDQ     RDBF$,,AUTO
        11 007300   000002 036003                    ADLQ    2,DU
        11 007301   200430 756100                    STQ     T$+3,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:469  
        11 007302   000154 236000 12                 LDQ     108
        11 007303   200003 235100                    LDA     RDBF$,,AUTO
        11 007304   200426 757100                    STAQ    T$+1,,AUTO
        11 007305   200426 630500                    EPPR0   T$+1,,AUTO
        11 007306   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007307   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007310   007312 702000 11                 TSX2    s:24995
        11 007311   007312 710000 11                 TRA     s:24995

     2589    24993                            /*N* WHAT DO WE DO?  */
     2590    24994    4                   END;                    /* WHENALTRETURN */

     2591    24995    3              END;                         /* ELSE */

  24995 11 007312   010045 710000 11                 TRA     s:25129

     2592    24996        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:470  
     2593    24997    2        CASE(IGA_CNFG_MSG);

     2594    24998    3           IF SUBSTR(KL_STATION,0,2) = 'NE' THEN DO; /* Msg is from NETCON */

  24998 11 007313   000000 220000 xsym               LDX0    KL_STATION
        11 007314   000222 100000 10                 CMPX0   CKBR+16
        11 007315   007420 601000 11                 TNZ     s:25024

     2595    24999    3                CALL KLX$CONV_NODENAME (KL$CNFG_MSG.NODE,FEX,NODETYPE)

  24999 11 007316   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 007317   200430 450500                    STP0    T$+3,,AUTO
        11 007320   200025 631500                    EPPR1   FEX,,AUTO
        11 007321   200427 451500                    STP1    T$+2,,AUTO
        11 007322   200003 236100                    LDQ     RDBF$,,AUTO
        11 007323   000005 036003                    ADLQ    5,DU
        11 007324   200426 756100                    STQ     T$+1,,AUTO
        11 007325   200426 630500                    EPPR0   T$+1,,AUTO
        11 007326   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007327   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 007330   007374 702000 11                 TSX2    SEND_CNFG_MSG_ERR

     2596    25000    4                WHENRETURN DO;

     2597    25001    4                     IF NODETYPE ~= %KL_NODETYPE_FEP

  25001 11 007331   200026 235100                    LDA     NODETYPE,,AUTO
        11 007332   000002 115007                    CMPA    2,DL
        11 007333   007336 600000 11                 TZE     s:25005
        11 007334   000004 115007                    CMPA    4,DL
        11 007335   007374 601000 11                 TNZ     SEND_CNFG_MSG_ERR

     2598    25002    4                          AND NODETYPE ~= %KL_NODETYPE_DEBUG
     2599    25003    4                     THEN
     2600    25004    4                          GOTO SEND_CNFG_MSG_ERR;
     2601    25005    4                     CALL KLX$WRHLPNODE(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),FEX)

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:471  
  25005 11 007336   200025 630500                    EPPR0   FEX,,AUTO
        11 007337   200430 450500                    STP0    T$+3,,AUTO
        11 007340   000153 236000 12                 LDQ     107
        11 007341   200003 235100                    LDA     RDBF$,,AUTO
        11 007342   200426 757100                    STAQ    T$+1,,AUTO
        11 007343   200426 630500                    EPPR0   T$+1,,AUTO
        11 007344   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007345   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 007346   007350 702000 11                 TSX2    s:25007
        11 007347   007373 710000 11                 TRA     s:25013

     2602    25006    5                     WHENALTRETURN DO;

     2603    25007    5                          CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NODENA);

  25007 11 007350   000151 236000 12                 LDQ     105
        11 007351   200427 756100                    STQ     T$+2,,AUTO
        11 007352   200003 236100                    LDQ     RDBF$,,AUTO
        11 007353   000007 036003                    ADLQ    7,DU
        11 007354   200426 756100                    STQ     T$+1,,AUTO
        11 007355   200426 630500                    EPPR0   T$+1,,AUTO
        11 007356   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 007357   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 007360   000000 011000                    NOP     0

     2604    25008                       /*   ERROR: KLI-E$NODENA-4
     2605    25009                            MESSAGE: That node is not currently available.
     2606    25010                             */
     2607    25011    5                         CALL KLX$WRHLPSTA (KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG
             25011                                   .ORIGIN);

  25011 11 007361   200003 236100                    LDQ     RDBF$,,AUTO
        11 007362   000003 036003                    ADLQ    3,DU
        11 007363   200430 756100                    STQ     T$+3,,AUTO
        11 007364   000153 236000 12                 LDQ     107
        11 007365   200003 235100                    LDA     RDBF$,,AUTO
        11 007366   200426 757100                    STAQ    T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:472  
        11 007367   200426 630500                    EPPR0   T$+1,,AUTO
        11 007370   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007371   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007372   000000 011000                    NOP     0

     2608    25012    5                        END;

     2609    25013    4                   END;

  25013 11 007373   007417 710000 11                 TRA     s:25022

     2610    25014    4                WHENALTRETURN DO;

     2611    25015    4   SEND_CNFG_MSG_ERR: ;

  25015 11 007374                       SEND_CNFG_M* null
     2612    25016    4                     CALL XUR$ERRTOLCP6(KL$CNFG_MSG.RESULTS,NOFE);

  25016 11 007374   000146 236000 12                 LDQ     102
        11 007375   200427 756100                    STQ     T$+2,,AUTO
        11 007376   200003 236100                    LDQ     RDBF$,,AUTO
        11 007377   000007 036003                    ADLQ    7,DU
        11 007400   200426 756100                    STQ     T$+1,,AUTO
        11 007401   200426 630500                    EPPR0   T$+1,,AUTO
        11 007402   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 007403   000000 701000 xent               TSX1    XUR$ERRTOLCP6
        11 007404   000000 011000                    NOP     0

     2613    25017                  /*   ERROR: KLI-E$NOFE-4
     2614    25018                       MESSAGE: That FEP does not exist.
     2615    25019                        */
     2616    25020    4                     CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.
             25020                              ORIGIN);

  25020 11 007405   200003 236100                    LDQ     RDBF$,,AUTO
        11 007406   000003 036003                    ADLQ    3,DU
        11 007407   200430 756100                    STQ     T$+3,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:473  
        11 007410   000153 236000 12                 LDQ     107
        11 007411   200003 235100                    LDA     RDBF$,,AUTO
        11 007412   200426 757100                    STAQ    T$+1,,AUTO
        11 007413   200426 630500                    EPPR0   T$+1,,AUTO
        11 007414   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007415   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007416   000000 011000                    NOP     0

     2617    25021    4                   END;

     2618    25022    3              END;                         /* IF */

  25022 11 007417   010045 710000 11                 TRA     s:25129

     2619    25023    3           ELSE DO;                        /* Msg is from FEP */

     2620    25024    4                CALL KLX$WRHLPSTA(KL$CNFG_MSG,SIZEC(KL$CNFG_MSG),KL$CNFG_MSG.ORIGIN)
             25024                         WHENALTRETURN DO;

  25024 11 007420   200003 236100                    LDQ     RDBF$,,AUTO
        11 007421   000003 036003                    ADLQ    3,DU
        11 007422   200430 756100                    STQ     T$+3,,AUTO
        11 007423   000153 236000 12                 LDQ     107
        11 007424   200003 235100                    LDA     RDBF$,,AUTO
        11 007425   200426 757100                    STAQ    T$+1,,AUTO
        11 007426   200426 630500                    EPPR0   T$+1,,AUTO
        11 007427   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007430   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 007431   007433 702000 11                 TSX2    s:25027
        11 007432   007433 710000 11                 TRA     s:25027

     2621    25025                            /*N* WHAT DO WE DO?  */
     2622    25026    4                   END;                    /* WHENALTRETURN */

     2623    25027    3              END;                         /* ELSE */

  25027 11 007433   010045 710000 11                 TRA     s:25129
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:474  

     2624    25028        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:475  
     2625    25029    2        CASE (IGA_NODEINFO);

     2626    25030    2           CALL KLX$WRHLPNODE(KL$NODEINFO,SIZEC(KL$NODEINFO),KL_NODE);

  25030 11 007434   000017 236000 12                 LDQ     15
        11 007435   200430 756100                    STQ     T$+3,,AUTO
        11 007436   000164 236000 12                 LDQ     116
        11 007437   000000 235000 xsym               LDA     KL_RDBF$
        11 007440   200426 757100                    STAQ    T$+1,,AUTO
        11 007441   200426 630500                    EPPR0   T$+1,,AUTO
        11 007442   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007443   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 007444   000000 011000                    NOP     0
        11 007445   010045 710000 11                 TRA     s:25129

     2627    25031
     2628    25032    2        CASE (IGA_NODECHG);

     2629    25033    2           CALL KLX$WRHLPNODE (KL$NODECHG,SIZEC(KL$NODECHG),KL_NODE);

  25033 11 007446   000017 236000 12                 LDQ     15
        11 007447   200430 756100                    STQ     T$+3,,AUTO
        11 007450   000106 236000 12                 LDQ     70
        11 007451   000000 235000 xsym               LDA     KL_RDBF$
        11 007452   200426 757100                    STAQ    T$+1,,AUTO
        11 007453   200426 630500                    EPPR0   T$+1,,AUTO
        11 007454   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007455   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 007456   000000 011000                    NOP     0
        11 007457   010045 710000 11                 TRA     s:25129

     2630    25034
     2631    25035    2        CASE(IGA_TIME);                    /* The time has changed */

     2632    25036    2           LEN = BITBIN(KL$TIME.UTS);      /* get it into an aligned variable. */

  25036 11 007460   000000 470400 xsym               LDP0    KL_RDBF$
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:476  
        11 007461   000000 235100                    LDA     0,,PR0
        11 007462   000001 236100                    LDQ     1,,PR0
        11 007463   000033 773000                    LRL     27
        11 007464   200007 756100                    STQ     LEN,,AUTO

     2633    25037    2           CALL KLI$GETFEPERA(LEN,I);

  25037 11 007465   200010 631500                    EPPR1   I,,AUTO
        11 007466   200427 451500                    STP1    T$+2,,AUTO
        11 007467   200007 633500                    EPPR3   LEN,,AUTO
        11 007470   200426 453500                    STP3    T$+1,,AUTO
        11 007471   200426 630500                    EPPR0   T$+1,,AUTO
        11 007472   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 007473   000000 701000 xent               TSX1    KLI$GETFEPERA
        11 007474   000000 011000                    NOP     0

     2634    25038    2           I = (I + 2)/4;

  25038 11 007475   200010 236100                    LDQ     I,,AUTO
        11 007476   000002 036007                    ADLQ    2,DL
        11 007477   000002 772000                    QRL     2
        11 007500   200010 756100                    STQ     I,,AUTO

     2635    25039    2           CALL KLX$9TO8(I,KL$TIME.UTS,4);

  25039 11 007501   000050 236000 12                 LDQ     40
        11 007502   200430 756100                    STQ     T$+3,,AUTO
        11 007503   000000 236000 xsym               LDQ     KL_RDBF$
        11 007504   200000 036007                    ADLQ    65536,DL
        11 007505   200427 756100                    STQ     T$+2,,AUTO
        11 007506   200010 630500                    EPPR0   I,,AUTO
        11 007507   200426 450500                    STP0    T$+1,,AUTO
        11 007510   200426 630500                    EPPR0   T$+1,,AUTO
        11 007511   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007512   000000 701000 xent               TSX1    KLX$9TO8
        11 007513   000000 011000                    NOP     0

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:477  
     2636    25040    3           DO FEX = 0 TO KL_MXFE;

  25040 11 007514   200025 450100                    STZ     FEX,,AUTO
        11 007515   007541 710000 11                 TRA     s:25047+3

     2637    25041    3                IF KL_FETBL.BOSS(FEX) OR FEX = KL_NODE THEN

  25041 11 007516   200025 720100                    LXL0    FEX,,AUTO
        11 007517   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 007520   040000 316003                    CANQ    16384,DU
        11 007521   007525 601000 11                 TNZ     s:25046
        11 007522   200025 236100                    LDQ     FEX,,AUTO
        11 007523   000000 116000 xsym               CMPQ    KL_NODE
        11 007524   007536 601000 11                 TNZ     s:25047

     2638    25042        /*
     2639    25043                         me or my nodes then set the time
     2640    25044        */
     2641    25045
     2642    25046    3                     CALL KLX$WRHLPNODE(KL$TIME,SIZEC(KL$TIME),FEX);

  25046 11 007525   200025 630500                    EPPR0   FEX,,AUTO
        11 007526   200430 450500                    STP0    T$+3,,AUTO
        11 007527   000106 236000 12                 LDQ     70
        11 007530   000000 235000 xsym               LDA     KL_RDBF$
        11 007531   200426 757100                    STAQ    T$+1,,AUTO
        11 007532   200426 630500                    EPPR0   T$+1,,AUTO
        11 007533   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007534   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 007535   000000 011000                    NOP     0

     2643    25047    3              END;

  25047 11 007536   200025 235100                    LDA     FEX,,AUTO
        11 007537   000001 035007                    ADLA    1,DL
        11 007540   200025 755100                    STA     FEX,,AUTO
        11 007541   000000 236000 xsym               LDQ     KL_MXFE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:478  
        11 007542   200025 116100                    CMPQ    FEX,,AUTO
        11 007543   007516 603000 11                 TRC     s:25041
        11 007544   010045 710000 11                 TRA     s:25129

     2644    25048
     2645    25049    2        CASE(IGA_DUMPMSG);                 /* Dump message for FROG */

     2646    25050    2           CALL KLX$8TO9(KL$DUMPMSG.DATASIZE,DATASIZE,2);

  25050 11 007545   000042 236000 12                 LDQ     34
        11 007546   200430 756100                    STQ     T$+3,,AUTO
        11 007547   200065 630500                    EPPR0   DATASIZE,,AUTO
        11 007550   200427 450500                    STP0    T$+2,,AUTO
        11 007551   200003 236100                    LDQ     RDBF$,,AUTO
        11 007552   000002 036003                    ADLQ    2,DU
        11 007553   200426 756100                    STQ     T$+1,,AUTO
        11 007554   200426 630500                    EPPR0   T$+1,,AUTO
        11 007555   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007556   000000 701000 xent               TSX1    KLX$8TO9
        11 007557   000000 011000                    NOP     0

     2647    25051    2           KL$DUMPMSG.CSHDR.KEY#=0;

  25051 11 007560   000000 220003                    LDX0    0,DU
        11 007561   200003 470500                    LDP0    RDBF$,,AUTO
        11 007562   000000 740100                    STX0    0,,PR0

     2648    25052    2           KL$DUMPMSG.CSHDR.FUNCTION=%KLFR_NA2FROG;

  25052 11 007563   005000 236007                    LDQ     2560,DL
        11 007564   000000 552110                    STBQ    0,'10'O,PR0

     2649    25053    2           WRT_NA2FROG.BUF_=VECTOR(KL$DUMPMSG);

  25053 11 007565   200065 235100                    LDA     DATASIZE,,AUTO
        11 007566   777777 375003                    ANA     -1,DU
        11 007567   000002 771000                    ARL     2
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:479  
        11 007570   000034 035000 12                 ADLA    28
        11 007571   200003 236100                    LDQ     RDBF$,,AUTO
        11 007572   000004 757000 xsym               STAQ    WRT_NA2FROG+4

     2650    25054    3           CALL M$WRITE(WRT_NA2FROG) WHENALTRETURN DO; END;

  25054 11 007573   000000 630400 xsym               EPPR0   WRT_NA2FROG
        11 007574   440001 713400                    CLIMB   alt,write
        11 007575   401400 401760                    pmme    nvectors=4
        11 007576   007600 702000 11                 TSX2    s:25054+5
        11 007577   007600 710000 11                 TRA     s:25054+5

  25054 11 007600   010045 710000 11                 TRA     s:25129

     2651    25055
     2652    25056    2        CASE(IGA_UPDOSI,IGA_DELOSI);

     2653    25057    2           KL_NETWORK_VALID = '0'B;

  25057 11 007601   000000 450000 xsym               STZ     KL_NETWORK_VALID

     2654    25058    2           KL_RD_NETCON.BUF_ = VECTOR(KL_EXTRSP_BUF);

  25058 11 007602   000166 237000 12                 LDAQ    118
        11 007603   000004 757000 xsym               STAQ    KL_RD_NETCON+4

     2655    25059    2           KL_RD_NETCON.KEY_ = VECTOR(KL$NETWORK_KEY);

  25059 11 007604   000170 237000 12                 LDAQ    120
        11 007605   000002 757000 xsym               STAQ    KL_RD_NETCON+2

     2656    25060    3           CALL M$READ (KL_RD_NETCON) WHENRETURN DO;

  25060 11 007606   000000 630400 xsym               EPPR0   KL_RD_NETCON
        11 007607   440000 713400                    CLIMB   alt,read
        11 007610   401400 401760                    pmme    nvectors=4
        11 007611   007655 702000 11                 TSX2    s:25067
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:480  

     2657    25061    4                DO I = 0 TO KL$NETWORK.NODE#;

  25061 11 007612   200010 450100                    STZ     I,,AUTO
        11 007613   007651 710000 11                 TRA     s:25066+3

     2658    25062    4                     IF (KL_FETBL.BOSS(I) AND KL_FETBL.ACTIVE(I) AND NOT KL_FETBL.
             25062                              HOST_NODE(I))

  25062 11 007614   200010 720100                    LXL0    I,,AUTO
        11 007615   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 007616   040000 316003                    CANQ    16384,DU
        11 007617   007624 600000 11                 TZE     s:25062+8
        11 007620   100000 316003                    CANQ    32768,DU
        11 007621   007624 600000 11                 TZE     s:25062+8
        11 007622   000000 234010 xsym               SZN     KL_FETBL,X0
        11 007623   007627 605000 11                 TPL     s:25064
        11 007624   200010 236100                    LDQ     I,,AUTO
        11 007625   000000 116000 xsym               CMPQ    KL_NODE
        11 007626   007640 601000 11                 TNZ     s:25065

     2659    25063    4                          OR I = KL_NODE THEN
     2660    25064    4                          CALL KLX$WRHLPNODE(KL$UPDOSI,SIZEC(KL$UPDOSI),I);

  25064 11 007627   200010 630500                    EPPR0   I,,AUTO
        11 007630   200430 450500                    STP0    T$+3,,AUTO
        11 007631   000173 236000 12                 LDQ     123
        11 007632   000000 235000 xsym               LDA     KL_RDBF$
        11 007633   200426 757100                    STAQ    T$+1,,AUTO
        11 007634   200426 630500                    EPPR0   T$+1,,AUTO
        11 007635   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007636   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 007637   000000 011000                    NOP     0

     2661    25065    4                     CALL KLI$GETSNPA(I);  /* update new entrys link info */

  25065 11 007640   200010 630500                    EPPR0   I,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:481  
        11 007641   200426 450500                    STP0    T$+1,,AUTO
        11 007642   200426 630500                    EPPR0   T$+1,,AUTO
        11 007643   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 007644   000000 701000 xent               TSX1    KLI$GETSNPA
        11 007645   000000 011000                    NOP     0

     2662    25066    4                   END;                    /* do i */

  25066 11 007646   200010 235100                    LDA     I,,AUTO
        11 007647   000001 035007                    ADLA    1,DL
        11 007650   200010 755100                    STA     I,,AUTO
        11 007651   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 007652   000000 236100                    LDQ     0,,PR0
        11 007653   200010 116100                    CMPQ    I,,AUTO
        11 007654   007614 603000 11                 TRC     s:25062

     2663    25067    3              END;                         /* when return */

  25067 11 007655   010045 710000 11                 TRA     s:25129

     2664    25068        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:482  
     2665    25069        /*
     2666    25070                iga_osilinkchg
     2667    25071                   an osi link has changed state(up / down).
     2668    25072                      down:delete the record from :network.
     2669    25073                      up:write new info toe :network.
     2670    25074                      forward the message to kub$baboon to modify the tables on this node.
     2671    25075                      update mynode and forward the message to any linkconnected nodes
     2672    25076                         except the one that sent us this message
     2673    25077        */
     2674    25078    2        CASE (IGA_OSILINKCHG,IGA_OSILINKCHG_DF);

     2675    25079    2           OSILINK_KEY = '0'B;

  25079 11 007656   000100 100400                    MLR     fill='000'O
        11 007657   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 007660   200221 000023                    ADSC9   OSILINK_KEY,,AUTO        cn=0,n=19

     2676    25080    2           OSILINK_KEY.SIZE = LENGTHC(OSILINK_KEY.KEY);

  25080 11 007661   022000 236003                    LDQ     9216,DU
        11 007662   200221 552140                    STBQ    OSILINK_KEY,'40'O,AUTO

     2677    25081    2           OSILINK_KEY.KEY.KEYTYP = %KL_NETWORK_KEYTYP_OSILINK;

  25081 11 007663   000002 236003                    LDQ     2,DU
        11 007664   200221 552120                    STBQ    OSILINK_KEY,'20'O,AUTO

     2678    25082    2           OSILINK_KEY.KEY.NODE = FEX;

  25082 11 007665   200025 236100                    LDQ     FEX,,AUTO
        11 007666   000011 736000                    QLS     9
        11 007667   200221 552110                    STBQ    OSILINK_KEY,'10'O,AUTO

     2679    25083    2           OSILINK_KEY.KEY.TERMID.LEV = %TERMINAL_ID_LEV_CHAN#;

  25083 11 007670   001000 236003                    LDQ     512,DU
        11 007671   200222 552140                    STBQ    OSILINK_KEY+1,'40'O,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:483  

     2680    25084    2           OSILINK_KEY.KEY.TERMID.TERM = KL$OSILINKCHG.TERMID.TERM;

  25084 11 007672   000000 470400 xsym               LDP0    KL_RDBF$
        11 007673   000100 100500                    MLR     fill='000'O
        11 007674   000004 400016                    ADSC9   4,,PR0                   cn=2,n=14
        11 007675   200222 200016                    ADSC9   OSILINK_KEY+1,,AUTO      cn=1,n=14

     2681    25085    3           IF KL$OSILINKCHG.TYPE = IGA_OSILINKDOWN THEN DO;

  25085 11 007676   000000 236100                    LDQ     0,,PR0
        11 007677   000777 376003                    ANQ     511,DU
        11 007700   000131 116003                    CMPQ    89,DU
        11 007701   007715 601000 11                 TNZ     s:25094

     2682    25086    3                KL_DR_NETWORK.KEY_ = VECTOR(OSILINK_KEY);

  25086 11 007702   000022 235000 12                 LDA     18
        11 007703   200426 452500                    STP2    T$+1,,AUTO
        11 007704   200426 236100                    LDQ     T$+1,,AUTO
        11 007705   000221 036003                    ADLQ    145,DU
        11 007706   000002 757000 xsym               STAQ    KL_DR_NETWORK+2

     2683    25087    4                CALL M$DELREC(KL_DR_NETWORK) WHENALTRETURN DO;

  25087 11 007707   000000 630400 xsym               EPPR0   KL_DR_NETWORK
        11 007710   440002 713400                    CLIMB   alt,+16386
        11 007711   401400 401760                    pmme    nvectors=4
        11 007712   007714 702000 11                 TSX2    s:25092
        11 007713   007714 710000 11                 TRA     s:25092

     2684    25088                      /*  should errlog this, but until then...
     2685    25089                          just assume we dropped the original write and go ahead and
     2686    25090                          forward the message as if nothing happened.  who us?*/
     2687    25091    4                   END;

     2688    25092    3              END;                         /* if iga_osilinkdown */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:484  

  25092 11 007714   007757 710000 11                 TRA     s:25114

     2689    25093    3           ELSE DO;

     2690    25094    3                KL_WR_NETWORK.KEY_ = VECTOR(OSILINK_KEY);

  25094 11 007715   000022 235000 12                 LDA     18
        11 007716   200426 452500                    STP2    T$+1,,AUTO
        11 007717   200426 236100                    LDQ     T$+1,,AUTO
        11 007720   000221 036003                    ADLQ    145,DU
        11 007721   000002 757000 xsym               STAQ    KL_WR_NETWORK+2

     2691    25095    3                OSILINK_BUF.QOS = KL$OSILINKCHG.QOS;

  25095 11 007722   000001 236100                    LDQ     1,,PR0
        11 007723   000033 772000                    QRL     27
        11 007724   000033 736000                    QLS     27
        11 007725   200230 756100                    STQ     OSILINK_BUF+2,,AUTO

     2692    25096    3                OSILINK_BUF.SNPA = KL$OSILINKCHG.SNPA;

  25096 11 007726   000100 100500                    MLR     fill='000'O
        11 007727   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
        11 007730   200226 000010                    ADSC9   OSILINK_BUF,,AUTO        cn=0,n=8

     2693    25097    3                KL_WR_NETWORK.BUF_ = VECTOR(OSILINK_BUF);

  25097 11 007731   000034 235000 12                 LDA     28
        11 007732   200426 452500                    STP2    T$+1,,AUTO
        11 007733   200426 236100                    LDQ     T$+1,,AUTO
        11 007734   000226 036003                    ADLQ    150,DU
        11 007735   000004 757000 xsym               STAQ    KL_WR_NETWORK+4

     2694    25098    4                CALL M$WRITE(KL_WR_NETWORK) WHENALTRETURN DO;

  25098 11 007736   000000 630400 xsym               EPPR0   KL_WR_NETWORK
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:485  
        11 007737   440001 713400                    CLIMB   alt,write
        11 007740   401400 401760                    pmme    nvectors=4
        11 007741   007743 702000 11                 TSX2    s:25099
        11 007742   007753 710000 11                 TRA     s:25104

     2695    25099    4                     KL_NWF = KL_NWF + 1;  /* number of Network Write Failures*/

  25099 11 007743   000000 235000 xsym               LDA     KL_NWF
        11 007744   000001 035007                    ADLA    1,DL
        11 007745   000000 755000 xsym               STA     KL_NWF

     2696    25100    4                     KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  25100 11 007746   000022 237000 12                 LDAQ    18
        11 007747   000002 757000 xsym               STAQ    KL_WR_NETWORK+2

     2697    25101    4                     KL_WR_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);

  25101 11 007750   000156 237000 12                 LDAQ    110
        11 007751   000004 757000 xsym               STAQ    KL_WR_NETWORK+4

     2698    25102    4                     RETURN;

  25102 11 007752   000000 702200 xent               TSX2  ! X66_ARET

     2699    25103    4                   END;                    /* whenaltreturn */
     2700    25104    3                KL_WR_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  25104 11 007753   000022 237000 12                 LDAQ    18
        11 007754   000002 757000 xsym               STAQ    KL_WR_NETWORK+2

     2701    25105    3                KL_WR_NETWORK.BUF_ = VECTOR(KL_NETWORK_BUF);

  25105 11 007755   000156 237000 12                 LDAQ    110
        11 007756   000004 757000 xsym               STAQ    KL_WR_NETWORK+4

     2702    25106    3              END;                         /* else osilinkup */
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:486  

     2703    25107                   /*
     2704    25108                         tell baboon.
     2705    25109                   */
     2706    25110                /*
     2707    25111                   return on _df because we will get another linkchg to propagate
     2708    25112                   this message is from a remote connected fep
     2709    25113                   */
     2710    25114    2           IF KL$OSILINKCHG.FCN = IGA_OSILINKCHG_DF THEN RETURN;

  25114 11 007757   000000 470400 xsym               LDP0    KL_RDBF$
        11 007760   000000 236100                    LDQ     0,,PR0
        11 007761   777000 376003                    ANQ     -512,DU
        11 007762   133000 116003                    CMPQ    46592,DU
        11 007763   007765 601000 11                 TNZ     s:25115

  25114 11 007764   000000 702200 xent               TSX2  ! X66_ARET

     2711    25115    2           CALL KLX$WRHLPNODE(KL$OSILINKCHG,SIZEC(KL$OSILINKCHG),KL_NODE);

  25115 11 007765   000017 236000 12                 LDQ     15
        11 007766   200430 756100                    STQ     T$+3,,AUTO
        11 007767   000175 236000 12                 LDQ     125
        11 007770   000000 235000 xsym               LDA     KL_RDBF$
        11 007771   200426 757100                    STAQ    T$+1,,AUTO
        11 007772   200426 630500                    EPPR0   T$+1,,AUTO
        11 007773   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 007774   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 007775   000000 011000                    NOP     0

     2712    25116
     2713    25117                /*
     2714    25118                   forward to the other nodes
     2715    25119                */
     2716    25120    2           OSILINKCHG = KL$OSILINKCHG;

  25120 11 007776   000000 470400 xsym               LDP0    KL_RDBF$
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:487  
        11 007777   000100 100500                    MLR     fill='000'O
        11 010000   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
        11 010001   200231 000040                    ADSC9   OSILINKCHG,,AUTO         cn=0,n=32

     2717    25121    2           OSILINKCHG.MYNODE# = KL_NODE;   /* but change mynode to our node# */

  25121 11 010002   000000 236000 xsym               LDQ     KL_NODE
        11 010003   000011 736000                    QLS     9
        11 010004   200231 552110                    STBQ    OSILINKCHG,'10'O,AUTO

     2718    25122    3           DO I = 0 TO KL_NODES;

  25122 11 010005   200010 450100                    STZ     I,,AUTO
        11 010006   010042 710000 11                 TRA     s:25127+3

     2719    25123    3                IF KL_FETBL.LINK_CONNECT(I) AND KL_FETBL.BOSS(I)

  25123 11 010007   200010 720100                    LXL0    I,,AUTO
        11 010010   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 010011   200000 316003                    CANQ    65536,DU
        11 010012   010037 600000 11                 TZE     s:25127
        11 010013   040000 316003                    CANQ    16384,DU
        11 010014   010037 600000 11                 TZE     s:25127
        11 010015   100000 316003                    CANQ    32768,DU
        11 010016   010037 600000 11                 TZE     s:25127
        11 010017   000000 470400 xsym               LDP0    KL_RDBF$
        11 010020   000000 236100                    LDQ     0,,PR0
        11 010021   000011 772000                    QRL     9
        11 010022   000777 376007                    ANQ     511,DL
        11 010023   200010 116100                    CMPQ    I,,AUTO
        11 010024   010037 600000 11                 TZE     s:25127

     2720    25124    4                     AND KL_FETBL.ACTIVE(I) AND I ~= KL$OSILINKCHG.MYNODE# THEN DO;

     2721    25125    4                     CALL KLX$WRHLPNODE(OSILINKCHG,SIZEC(OSILINKCHG),I);

  25125 11 010025   200010 631500                    EPPR1   I,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:488  
        11 010026   200430 451500                    STP1    T$+3,,AUTO
        11 010027   000175 236000 12                 LDQ     125
        11 010030   200427 756100                    STQ     T$+2,,AUTO
        11 010031   200231 633500                    EPPR3   OSILINKCHG,,AUTO
        11 010032   200426 453500                    STP3    T$+1,,AUTO
        11 010033   200426 630500                    EPPR0   T$+1,,AUTO
        11 010034   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 010035   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 010036   000000 011000                    NOP     0

     2722    25126    4                   END;

     2723    25127    3              END;                         /* do i */

  25127 11 010037   200010 235100                    LDA     I,,AUTO
        11 010040   000001 035007                    ADLA    1,DL
        11 010041   200010 755100                    STA     I,,AUTO
        11 010042   000000 236000 xsym               LDQ     KL_NODES
        11 010043   200010 116100                    CMPQ    I,,AUTO
        11 010044   010007 603000 11                 TRC     s:25123

     2724    25128    2        END;                               /*CASE*/

     2725    25129    1        RETURN;

  25129 11 010045   000000 702200 xent               TSX2  ! X66_ARET

     2726    25130        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:489  
     2727    25131    1   KLI$GETROUTES: ENTRY;

  25131 11 010046   000000 700200 xent  KLI$GETROUT* TSX0  ! X66_AUTO_0
        11 010047   000440 000000                    ZERO    288,0

     2728    25132    1        CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4));

  25132 11 010050   000100 305400                    DTB
        11 010051   000001 030004 xsym               NDSC9   KL_STATION+1             cn=0,s=nosgn,sf=0,n=4
        11 010052   200426 000010                    NDSC9   T$+1,,AUTO               cn=0,s=lsgnf,sf=0,n=8
        11 010053   200427 235100                    LDA     T$+2,,AUTO
        11 010054   200025 755100                    STA     FEX,,AUTO

     2729    25133    2        DO I = 0 TO KL_NODES;

  25133 11 010055   200010 450100                    STZ     I,,AUTO
        11 010056   010130 710000 11                 TRA     s:25147+3

     2730    25134    2             IF FEX ~= KL_NODE             /* Not this node */

  25134 11 010057   200025 236100                    LDQ     FEX,,AUTO
        11 010060   000000 116000 xsym               CMPQ    KL_NODE
        11 010061   010125 600000 11                 TZE     s:25147

     2731    25135    3             THEN DO;

     2732    25136    3                  NODECHG.FCN = IGA_NODECHG;

  25136 11 010062   051000 236003                    LDQ     20992,DU
        11 010063   200346 552140                    STBQ    NODECHG,'40'O,AUTO

     2733    25137    3                  NODECHG.MYNODE = KL_NODE;

  25137 11 010064   000000 236000 xsym               LDQ     KL_NODE
        11 010065   200346 552104                    STBQ    NODECHG,'04'O,AUTO

     2734    25138    3                  NODECHG.NODE = I;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:490  

  25138 11 010066   200010 236100                    LDQ     I,,AUTO
        11 010067   000033 736000                    QLS     27
        11 010070   200347 552140                    STBQ    NODECHG+1,'40'O,AUTO

     2735    25139    3                  NODECHG.QOS = MINIMUM(KL_FETBL.QOS(I) + KL_HOPCOST,255);

  25139 11 010071   200010 720100                    LXL0    I,,AUTO
        11 010072   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 010073   000022 772000                    QRL     18
        11 010074   000777 376007                    ANQ     511,DL
        11 010075   000000 036000 xsym               ADLQ    KL_HOPCOST
        11 010076   000377 116007                    CMPQ    255,DL
        11 010077   010102 602000 11                 TNC     s:25139+9
        11 010100   010102 600000 11                 TZE     s:25139+9
        11 010101   000377 236007                    LDQ     255,DL
        11 010102   000011 736000                    QLS     9
        11 010103   200347 552110                    STBQ    NODECHG+1,'10'O,AUTO

     2736    25140    3                  IF KL_FETBL.HOST_NODE(I)

  25140 11 010104   000000 234010 xsym               SZN     KL_FETBL,X0
        11 010105   010111 605000 11                 TPL     s:25144

     2737    25141    3                  THEN
     2738    25142    3                       NODECHG.HOSTNODE = 1;

  25142 11 010106   000001 236003                    LDQ     1,DU
        11 010107   200347 552120                    STBQ    NODECHG+1,'20'O,AUTO
        11 010110   010113 710000 11                 TRA     s:25145

     2739    25143    3                  ELSE
     2740    25144    3                       NODECHG.HOSTNODE = 0;

  25144 11 010111   000000 236003                    LDQ     0,DU
        11 010112   200347 552120                    STBQ    NODECHG+1,'20'O,AUTO

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:491  
     2741    25145    3                  CALL KLX$WRHLPNODE(NODECHG,SIZEC(NODECHG),FEX);

  25145 11 010113   200025 630500                    EPPR0   FEX,,AUTO
        11 010114   200430 450500                    STP0    T$+3,,AUTO
        11 010115   000106 236000 12                 LDQ     70
        11 010116   200427 756100                    STQ     T$+2,,AUTO
        11 010117   200346 631500                    EPPR1   NODECHG,,AUTO
        11 010120   200426 451500                    STP1    T$+1,,AUTO
        11 010121   200426 630500                    EPPR0   T$+1,,AUTO
        11 010122   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 010123   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 010124   000000 011000                    NOP     0

     2742    25146    3                END;

     2743    25147    2           END;

  25147 11 010125   200010 235100                    LDA     I,,AUTO
        11 010126   000001 035007                    ADLA    1,DL
        11 010127   200010 755100                    STA     I,,AUTO
        11 010130   000000 236000 xsym               LDQ     KL_NODES
        11 010131   200010 116100                    CMPQ    I,,AUTO
        11 010132   010057 603000 11                 TRC     s:25134

     2744    25148    1        RETURN;

  25148 11 010133   000000 702200 xent               TSX2  ! X66_ARET

     2745    25149        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:492  
     2746    25150    1   KLI$RECOVERY: ENTRY;

  25150 11 010134   000000 700200 xent  KLI$RECOVERY TSX0  ! X66_AUTO_0
        11 010135   000440 000000                    ZERO    288,0

     2747    25151
     2748    25152    1        CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4)); /* Fex recovery is in station */

  25152 11 010136   000100 305400                    DTB
        11 010137   000001 030004 xsym               NDSC9   KL_STATION+1             cn=0,s=nosgn,sf=0,n=4
        11 010140   200426 000010                    NDSC9   T$+1,,AUTO               cn=0,s=lsgnf,sf=0,n=8
        11 010141   200427 235100                    LDA     T$+2,,AUTO
        11 010142   200025 755100                    STA     FEX,,AUTO

     2749    25153    1        CTX$ = CTXHD$;

  25153 11 010143   000022 236000 7                  LDQ     CTXHD$
        11 010144   200021 756100                    STQ     CTX$,,AUTO

     2750    25154    1        PREV$ = CTX$;

  25154 11 010145   200022 756100                    STQ     PREV$,,AUTO

     2751    25155
     2752    25156    2        DO WHILE(CTX$ ~= ADDR(NIL));

  25156 11 010146   010234 710000 11                 TRA     s:25181

     2753    25157    2             IF CTX$->DVCERRCTX.FEX = FEX  /* Need to get rid of this one */

  25157 11 010147   200021 470500                    LDP0    CTX$,,AUTO
        11 010150   000006 236100                    LDQ     6,,PR0
        11 010151   000033 772000                    QRL     27
        11 010152   200025 116100                    CMPQ    FEX,,AUTO
        11 010153   010230 601000 11                 TNZ     s:25178

     2754    25158    3             THEN DO;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:493  

     2755    25159    3                  FEPMES.DEVNM = CTX$->DVCERRCTX.DEVNM;

  25159 11 010154   040100 100500                    MLR     fill='040'O
        11 010155   000006 200010                    ADSC9   6,,PR0                   cn=1,n=8
        11 010156   200353 000010                    ADSC9   FEPMES+3,,AUTO           cn=0,n=8

     2756    25160    3                  FEPMES.MSGID = CTX$->DVCERRCTX.MSGID;

  25160 11 010157   000001 720100                    LXL0    1,,PR0
        11 010160   200351 740100                    STX0    FEPMES+1,,AUTO

     2757    25161    3                  FEPMES.NPARAMS = 0;

  25161 11 010161   000000 236003                    LDQ     0,DU
        11 010162   200351 552110                    STBQ    FEPMES+1,'10'O,AUTO

     2758    25162    3                  FEPMES.FCN = OC_STTM;

  25162 11 010163   000001 236007                    LDQ     1,DL
        11 010164   200351 552104                    STBQ    FEPMES+1,'04'O,AUTO

     2759    25163    3                  FEPMES.CADDR = M_DEVC;

  25163 11 010165   100000 220003                    LDX0    32768,DU
        11 010166   200350 740100                    STX0    FEPMES,,AUTO

     2760    25164    3                  WKBER.BUF_ = VECTOR(FEPMES);

  25164 11 010167   000021 235000 12                 LDA     17
        11 010170   200426 452500                    STP2    T$+1,,AUTO
        11 010171   200426 236100                    LDQ     T$+1,,AUTO
        11 010172   000350 036003                    ADLQ    232,DU
        11 010173   000426 757000 7                  STAQ    WKBER+4

     2761    25165    3                  CALL M$WRITE (WKBER)

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:494  
  25165 11 010174   000422 630400 7                  EPPR0   WKBER
        11 010175   440001 713400                    CLIMB   alt,write
        11 010176   401400 401760                    pmme    nvectors=4
        11 010177   010201 702000 11                 TSX2    s:25168
        11 010200   010201 710000 11                 TRA     s:25168

     2762    25166    4                  WHENALTRETURN DO;

     2763    25167    4                     END;

     2764    25168    3                  IF CTX$ = CTXHD$

  25168 11 010201   200021 236100                    LDQ     CTX$,,AUTO
        11 010202   000022 116000 7                  CMPQ    CTXHD$
        11 010203   010210 601000 11                 TNZ     s:25172

     2765    25169    3                  THEN
     2766    25170    3                       CTXHD$ = CTX$->DVCERRCTX.LNK$;

  25170 11 010204   200021 470500                    LDP0    CTX$,,AUTO
        11 010205   000000 236100                    LDQ     0,,PR0
        11 010206   000022 756000 7                  STQ     CTXHD$
        11 010207   010214 710000 11                 TRA     s:25173

     2767    25171    3                  ELSE
     2768    25172    3                       PREV$->DVCERRCTX.LNK$ = CTX$->DVCERRCTX.LNK$;

  25172 11 010210   200021 470500                    LDP0    CTX$,,AUTO
        11 010211   000000 236100                    LDQ     0,,PR0
        11 010212   200022 471500                    LDP1    PREV$,,AUTO
        11 010213   100000 756100                    STQ     0,,PR1

     2769    25173    3                  MESS$ = CTX$;

  25173 11 010214   200021 236100                    LDQ     CTX$,,AUTO
        11 010215   200033 756100                    STQ     MESS$,,AUTO

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:495  
     2770    25174    3                  CTX$ = CTX$->DVCERRCTX.LNK$;

  25174 11 010216   200021 470500                    LDP0    CTX$,,AUTO
        11 010217   000000 236100                    LDQ     0,,PR0
        11 010220   200021 756100                    STQ     CTX$,,AUTO

     2771    25175    3                  CALL KLB$REL(MESS$);

  25175 11 010221   200033 630500                    EPPR0   MESS$,,AUTO
        11 010222   200426 450500                    STP0    T$+1,,AUTO
        11 010223   200426 630500                    EPPR0   T$+1,,AUTO
        11 010224   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 010225   000000 701000 xent               TSX1    KLB$REL
        11 010226   000000 011000                    NOP     0

     2772    25176    3                END;

  25176 11 010227   010234 710000 11                 TRA     s:25181

     2773    25177    3             ELSE DO;

     2774    25178    3                  PREV$ = CTX$;

  25178 11 010230   200021 236100                    LDQ     CTX$,,AUTO
        11 010231   200022 756100                    STQ     PREV$,,AUTO

     2775    25179    3                  CTX$ = CTX$->DVCERRCTX.LNK$;

  25179 11 010232   000000 236100                    LDQ     0,,PR0
        11 010233   200021 756100                    STQ     CTX$,,AUTO

     2776    25180    3                END;

     2777    25181    2           END;

  25181 11 010234   200021 236100                    LDQ     CTX$,,AUTO
        11 010235   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:496  
        11 010236   010147 601000 11                 TNZ     s:25157

     2778    25182
     2779    25183        /* Send configuration response for all pending configs */
     2780    25184    1        CTX$ = KL_RSPPND$;

  25184 11 010237   000000 236000 xsym               LDQ     KL_RSPPND$
        11 010240   200021 756100                    STQ     CTX$,,AUTO

     2781    25185
     2782    25186    2        DO WHILE (CTX$ ~= ADDR(NIL));

  25186 11 010241   010305 710000 11                 TRA     s:25199

     2783    25187    2             KL$CONFIGRSP='0'B;

  25187 11 010242   000000 470400 xsym               LDP0    KL_RDBF$
        11 010243   000100 100400                    MLR     fill='000'O
        11 010244   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 010245   000000 000030                    ADSC9   0,,PR0                   cn=0,n=24

     2784    25188    2             KL$CONFIGRSP.FCN = IGA_CONFIGRSP;

  25188 11 010246   000000 470400 xsym               LDP0    KL_RDBF$
        11 010247   104000 236003                    LDQ     34816,DU
        11 010250   000000 552140                    STBQ    0,'40'O,PR0

     2785    25189    2             KL$CONFIGRSP.MSGID = KL$RSPPND.MSGID;

  25189 11 010251   200021 470500                    LDP0    CTX$,,AUTO
        11 010252   000006 236100                    LDQ     6,,PR0
        11 010253   000000 471400 xsym               LDP1    KL_RDBF$
        11 010254   100001 756100                    STQ     1,,PR1

     2786    25190    2             KL$CONFIGRSP.NODE = KL_NODE;

  25190 11 010255   000000 236000 xsym               LDQ     KL_NODE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:497  
        11 010256   000033 736000                    QLS     27
        11 010257   100002 552140                    STBQ    2,'40'O,PR1

     2787    25191    2             CALL KLX$ERR2NETERR(NODENA,KL$CONFIGRSP.NETERR);

  25191 11 010260   000000 236000 xsym               LDQ     KL_RDBF$
        11 010261   000124 036000 12                 ADLQ    84
        11 010262   000151 235000 12                 LDA     105
        11 010263   200426 757100                    STAQ    T$+1,,AUTO
        11 010264   200426 630500                    EPPR0   T$+1,,AUTO
        11 010265   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 010266   000000 701000 xent               TSX1    KLX$ERR2NETERR
        11 010267   000000 011000                    NOP     0

     2788    25192    2             IF KL$RSPPND.NODE = FEX

  25192 11 010270   200021 470500                    LDP0    CTX$,,AUTO
        11 010271   000001 236100                    LDQ     1,,PR0
        11 010272   000033 772000                    QRL     27
        11 010273   200025 116100                    CMPQ    FEX,,AUTO
        11 010274   010303 601000 11                 TNZ     s:25198

     2789    25193    3             THEN DO;

     2790    25194    3                  CTX$ = KL$RSPPND.LNK$;

  25194 11 010275   000000 236100                    LDQ     0,,PR0
        11 010276   200021 756100                    STQ     CTX$,,AUTO

     2791    25195    3                  CALL KLC$CONFIG;

  25195 11 010277   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 010300   000000 701000 xent               TSX1    KLC$CONFIG
        11 010301   000000 011000                    NOP     0

     2792    25196    3                END;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:498  
  25196 11 010302   010305 710000 11                 TRA     s:25199

     2793    25197    2             ELSE
     2794    25198    2                  CTX$ = KL$RSPPND.LNK$;

  25198 11 010303   000000 236100                    LDQ     0,,PR0
        11 010304   200021 756100                    STQ     CTX$,,AUTO

     2795    25199    2           END;

  25199 11 010305   200021 236100                    LDQ     CTX$,,AUTO
        11 010306   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 010307   010242 601000 11                 TNZ     s:25187

     2796    25200    1        KL$DUMPABORT.CSHDR.KEY#=0;

  25200 11 010310   000000 220003                    LDX0    0,DU
        11 010311   200300 740100                    STX0    KL$DUMPABORT,,AUTO

     2797    25201    1        KL$DUMPABORT.CSHDR.FUNCTION=%KLFR_NA2FROG;

  25201 11 010312   005000 236007                    LDQ     2560,DL
        11 010313   200300 552110                    STBQ    KL$DUMPABORT,'10'O,AUTO

     2798    25202    1        KL$DUMPABORT.TYPE=%GI_DUMP_ABORT;

  25202 11 010314   007000 236003                    LDQ     3584,DU
        11 010315   200301 552140                    STBQ    KL$DUMPABORT+1,'40'O,AUTO

     2799    25203    1        KL$DUMPABORT.FEX=FEX;

  25203 11 010316   200025 721100                    LXL1    FEX,,AUTO
        11 010317   200301 441100                    SXL1    KL$DUMPABORT+1,,AUTO

     2800    25204    1        WRT_NA2FROG.BUF_=VECTOR(KL$DUMPABORT);

  25204 11 010320   000125 235000 12                 LDA     85
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:499  
        11 010321   200426 452500                    STP2    T$+1,,AUTO
        11 010322   200426 236100                    LDQ     T$+1,,AUTO
        11 010323   000300 036003                    ADLQ    192,DU
        11 010324   000004 757000 xsym               STAQ    WRT_NA2FROG+4

     2801    25205    2        CALL M$WRITE(WRT_NA2FROG) WHENALTRETURN DO; END;

  25205 11 010325   000000 630400 xsym               EPPR0   WRT_NA2FROG
        11 010326   440001 713400                    CLIMB   alt,write
        11 010327   401400 401760                    pmme    nvectors=4
        11 010330   010332 702000 11                 TSX2    s:25212
        11 010331   010332 710000 11                 TRA     s:25212

     2802    25206
     2803    25207        /* Clear out :NETWORK */
     2804    25208        /*
     2805    25209             kl$line_key is based on CNFG_BUF which is used to
     2806    25210             precord to the beginning of the :network file.
     2807    25211        */
     2808    25212    1        KL$LINE_KEY = '0'B;

  25212 11 010332   000106 470400 7                  LDP0    CNFG$
        11 010333   000100 100400                    MLR     fill='000'O
        11 010334   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 010335   000000 000023                    ADSC9   0,,PR0                   cn=0,n=19

     2809    25213    1        KL$LINE_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  25213 11 010336   022000 236003                    LDQ     9216,DU
        11 010337   000000 552140                    STBQ    0,'40'O,PR0

     2810    25214    1        CALL M$PRECORD (STARTNETWORK)

  25214 11 010340   000252 630400 7                  EPPR0   STARTNETWORK
        11 010341   440003 713400                    CLIMB   alt,+16387
        11 010342   401000 401760                    pmme    nvectors=3
        11 010343   010345 702000 11                 TSX2    s:25217
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:500  
        11 010344   010345 710000 11                 TRA     s:25217

     2811    25215    2        WHENALTRETURN DO;

     2812    25216    2           END;

     2813    25217    1        ERR = 0;

  25217 11 010345   200050 450100                    STZ     ERR,,AUTO

     2814    25218    1        KL_RD_NETWORK.V.KEYS# = '0'B;

  25218 11 010346   000176 236000 12                 LDQ     126
        11 010347   000010 356000 xsym               ANSQ    KL_RD_NETWORK+8

     2815    25219    1        KL_RD_NETWORK.KEY_ = VECTOR(CNFG_BUF);

  25219 11 010350   000060 237000 12                 LDAQ    48
        11 010351   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

     2816    25220    1        KL_DR_NETWORK.KEY_ = VECTOR(CNFG_BUF);

  25220 11 010352   000060 237000 12                 LDAQ    48
        11 010353   000002 757000 xsym               STAQ    KL_DR_NETWORK+2

     2817    25221    1        KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;

  25221 11 010354   000000 236003                    LDQ     0,DU
        11 010355   000000 552004 xsym               STBQ    KL_NETWORK_KEY,'04'O

     2818    25222    1        KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  25222 11 010356   022000 236003                    LDQ     9216,DU
        11 010357   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     2819    25223    1        KL$LINE_KEY = KL_NETWORK_KEY;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:501  
  25223 11 010360   000106 470400 7                  LDP0    CNFG$
        11 010361   000100 100400                    MLR     fill='000'O
        11 010362   000000 000023 xsym               ADSC9   KL_NETWORK_KEY           cn=0,n=19
        11 010363   000000 000023                    ADSC9   0,,PR0                   cn=0,n=19

     2820    25224
     2821    25225    2        DO WHILE (ERR = 0);

  25225 11 010364   200050 235100                    LDA     ERR,,AUTO
        11 010365   010433 601000 11                 TNZ     s:25253

     2822    25226    2             CALL M$READ (KL_RD_NETWORK)

  25226 11 010366   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 010367   440000 713400                    CLIMB   alt,read
        11 010370   401400 401760                    pmme    nvectors=4
        11 010371   010427 702000 11                 TSX2    s:25248

     2823    25227    3             WHENRETURN DO;

     2824    25228
     2825    25229    4                  DO CASE(KL$LINE_KEY.KEY.KEYTYP);

  25229 11 010372   000106 470400 7                  LDP0    CNFG$
        11 010373   000000 220100                    LDX0    0,,PR0
        11 010374   000777 360003                    ANX0    511,DU
        11 010375   000003 100003                    CMPX0   3,DU
        11 010376   010400 602010 11                 TNC     s:25229+6,X0
        11 010377   010426 710000 11                 TRA     s:25246
        11 010400   010403 710000 11                 TRA     s:25232
        11 010401   010416 710000 11                 TRA     s:25240
        11 010402   010403 710000 11                 TRA     s:25232

     2826    25230
     2827    25231    4                  CASE (%KL_NETWORK_KEYTYP_LINE,%KL_NETWORK_KEYTYP_OSILINK);

     2828    25232    4                     IF CNFG$->KL$LINE_KEY.KEY.NODE = FEX
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:502  

  25232 11 010403   000000 236100                    LDQ     0,,PR0
        11 010404   000011 772000                    QRL     9
        11 010405   000777 376007                    ANQ     511,DL
        11 010406   200025 116100                    CMPQ    FEX,,AUTO
        11 010407   010426 601000 11                 TNZ     s:25246

     2829    25233    4                     THEN
     2830    25234    4                          CALL M$DELREC (KL_DR_NETWORK)

  25234 11 010410   000000 630400 xsym               EPPR0   KL_DR_NETWORK
        11 010411   440002 713400                    CLIMB   alt,+16386
        11 010412   401400 401760                    pmme    nvectors=4
        11 010413   010415 702000 11                 TSX2    s:25236
        11 010414   010415 710000 11                 TRA     s:25236

     2831    25235    5                          WHENALTRETURN DO;

     2832    25236    5                             END;

  25236 11 010415   010426 710000 11                 TRA     s:25246

     2833    25237
     2834    25238    4                  CASE (%KL_NETWORK_KEYTYP_TERM);

     2835    25239
     2836    25240    4                     IF KL_NETWORK_BUF.NODE = FEX

  25240 11 010416   000005 236000 xsym               LDQ     KL_NETWORK_BUF+5
        11 010417   000011 772000                    QRL     9
        11 010420   000777 376007                    ANQ     511,DL
        11 010421   200025 116100                    CMPQ    FEX,,AUTO
        11 010422   010426 601000 11                 TNZ     s:25246

     2837    25241    4                     THEN
     2838    25242    4                          CALL M$DELREC (KL_DR_NETWORK);

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:503  
  25242 11 010423   000000 630400 xsym               EPPR0   KL_DR_NETWORK
        11 010424   040002 713400                    CLIMB   16386
        11 010425   401400 401760                    pmme    nvectors=4

     2839    25243
     2840    25244    4                  END;                     /* end cases */

     2841    25245
     2842    25246    3                END;

  25246 11 010426   010431 710000 11                 TRA     s:25251

     2843    25247    3             WHENALTRETURN DO;

     2844    25248    3                  ERR = 1;

  25248 11 010427   000001 235007                    LDA     1,DL
        11 010430   200050 755100                    STA     ERR,,AUTO

     2845    25249    3                END;

     2846    25250
     2847    25251    2           END;                            /* End DO WHILE */

  25251 11 010431   200050 235100                    LDA     ERR,,AUTO
        11 010432   010366 600000 11                 TZE     s:25226

     2848    25252
     2849    25253    1        KL_RD_NETWORK.V.KEYS# = '1'B;

  25253 11 010433   200000 236007                    LDQ     65536,DL
        11 010434   000010 256000 xsym               ORSQ    KL_RD_NETWORK+8

     2850    25254
     2851    25255
     2852    25256    1        RETURN;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:504  
  25256 11 010435   000000 702200 xent               TSX2  ! X66_ARET

     2853    25257        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:505  
     2854    25258    1   GETCONFIGS: PROC;

  25258 11 010436   200414 741300       GETCONFIGS   STX1  ! KBERR+10,,AUTO

     2855    25259    2        IF SUBSTR(KL_STATION,0,4) = 'FEPA'

  25259 11 010437   000000 236000 xsym               LDQ     KL_STATION
        11 010440   000220 116000 10                 CMPQ    CKBR+14
        11 010441   010447 601000 11                 TNZ     s:25263

     2856    25260    2        THEN
     2857    25261    2             CALL CHARBIN(FEX,SUBSTR(KL_STATION,4,4));

  25261 11 010442   000100 305400                    DTB
        11 010443   000001 030004 xsym               NDSC9   KL_STATION+1             cn=0,s=nosgn,sf=0,n=4
        11 010444   200426 000010                    NDSC9   T$+1,,AUTO               cn=0,s=lsgnf,sf=0,n=8
        11 010445   200427 235100                    LDA     T$+2,,AUTO
        11 010446   200025 755100                    STA     FEX,,AUTO

     2858    25262
     2859    25263    2        KL_FROG.FUNCTION = %KLFR_UP;

  25263 11 010447   006000 236007                    LDQ     3072,DL
        11 010450   000000 552010 xsym               STBQ    KL_FROG,'10'O

     2860    25264    2        KL_FROG.FEX = FEX;

  25264 11 010451   200025 236100                    LDQ     FEX,,AUTO
        11 010452   000000 552004 xsym               STBQ    KL_FROG,'04'O

     2861    25265    2        CALL M$WRITE (WRT_FROG);

  25265 11 010453   000000 630400 xsym               EPPR0   WRT_FROG
        11 010454   040001 713400                    CLIMB   write
        11 010455   401400 401760                    pmme    nvectors=4

     2862    25266    2        KL_NETWORK_VALID = '0'B;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:506  

  25266 11 010456   000000 450000 xsym               STZ     KL_NETWORK_VALID

     2863    25267        /* Get the default handler records */
     2864    25268    2        DEFAULT_KEY.NODE = FEX;

  25268 11 010457   200025 236100                    LDQ     FEX,,AUTO
        11 010460   000011 736000                    QLS     9
        11 010461   000473 552010 7                  STBQ    DEFAULT_KEY,'10'O

     2865    25269    2        DEFAULT_KEY.HNDLR = ' ';

  25269 11 010462   040000 100400                    MLR     fill='040'O
        11 010463   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 010464   000473 600010 7                  ADSC9   DEFAULT_KEY              cn=3,n=8

     2866    25270    2        FPT_PRECORD.KEY_ = VECTOR(DEFAULT_KEY);

  25270 11 010465   000056 237000 12                 LDAQ    46
        11 010466   000354 757000 7                  STAQ    FPT_PRECORD+2

     2867    25271    2        CALL M$PRECORD (FPT_PRECORD)

  25271 11 010467   000352 630400 7                  EPPR0   FPT_PRECORD
        11 010470   440003 713400                    CLIMB   alt,+16387
        11 010471   401000 401760                    pmme    nvectors=3
        11 010472   010474 702000 11                 TSX2    s:25275
        11 010473   010474 710000 11                 TRA     s:25275

     2868    25272    3        WHENALTRETURN DO;

     2869    25273                                                /* It is expected */
     2870    25274    3           END;

     2871    25275    2        RD_NETCON.KEY_ = VECTOR(TDEFAULT_KEY);

  25275 11 010474   000034 235000 12                 LDA     28
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:507  
        11 010475   200426 452500                    STP2    T$+1,,AUTO
        11 010476   200426 236100                    LDQ     T$+1,,AUTO
        11 010477   000062 036003                    ADLQ    50,DU
        11 010500   000336 757000 7                  STAQ    RD_NETCON+2

     2872    25276
     2873    25277    2        CALL M$READ(RD_NETCON)

  25277 11 010501   000334 630400 7                  EPPR0   RD_NETCON
        11 010502   440000 713400                    CLIMB   alt,read
        11 010503   401400 401760                    pmme    nvectors=4
        11 010504   010506 702000 11                 TSX2    s:25279
        11 010505   010510 710000 11                 TRA     s:25281

     2874    25278    3        WHENALTRETURN DO;

     2875    25279    3             TDEFAULT_KEY.TYP = 0;

  25279 11 010506   000000 236003                    LDQ     0,DU
        11 010507   200062 552120                    STBQ    TDEFAULT_KEY,'20'O,AUTO

     2876    25280    3           END;

     2877    25281    3        DO WHILE(TDEFAULT_KEY.TYP = %KL_KEYTYP_DEFAULT AND TDEFAULT_KEY.NODE = FEX);

  25281 11 010510   010660 710000 11                 TRA     s:25310

     2878    25282    3             PSIZ = 0;

  25282 11 010511   000000 220003                    LDX0    0,DU
        11 010512   200027 740100                    STX0    PSIZ,,AUTO

     2879    25283    3             CHNRSP = KL_CHNRSPC;

  25283 11 010513   000066 621010                    EAX1    54,X0
        11 010514   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 010515   000140 100400                    MLR     fill='000'O
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:508  
        11 010516   000024 000465 10                 ADSC9   KL_CHNRSPC               cn=0,n=309
        11 010517   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     2880    25284    3             CHNRSP.DFLTHND = '1'B;

  25284 11 010520   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 010521   000040 236003                    LDQ     32,DU
        11 010522   000000 256100                    ORSQ    0,,PR0

     2881    25285    3             CHNRSP.TERMINAL_ID = '0'B;

  25285 11 010523   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 010524   000100 100400                    MLR     fill='000'O
        11 010525   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 010526   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16

     2882    25286    3             CHNRSP.HANDLER = TDEFAULT_KEY.HNDLR;

  25286 11 010527   040100 100500                    MLR     fill='040'O
        11 010530   200062 600010                    ADSC9   TDEFAULT_KEY,,AUTO       cn=3,n=8
        11 010531   000000 400010                    ADSC9   0,,PR0                   cn=2,n=8

     2883    25287    3             CHNRSP.NA = LINCNFG.NA;

  25287 11 010532   000106 470400 7                  LDP0    CNFG$
        11 010533   000000 471400 xsym               LDP1    KL_EXTRSP_BUF$
        11 010534   000100 100500                    MLR     fill='000'O
        11 010535   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8
        11 010536   100006 400010                    ADSC9   6,,PR1                   cn=2,n=8

     2884    25288    3             CHNRSP.NA.CNFG_EXISTS = '0'B;

  25288 11 010537   000177 236000 12                 LDQ     127
        11 010540   100006 356100                    ANSQ    6,,PR1

     2885    25289    3             CHNRSP.NA.AUTLGN = '0'B;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:509  
  25289 11 010541   000200 236000 12                 LDQ     128
        11 010542   100006 356100                    ANSQ    6,,PR1

     2886    25290    3             CHNRSP.NA.PROFILE = '0'B;

  25290 11 010543   000201 236000 12                 LDQ     129
        11 010544   100006 356100                    ANSQ    6,,PR1

     2887    25291    3             CHNRSP.HNDCMN = LINCNFG.KHA;

  25291 11 010545   000100 100500                    MLR     fill='000'O
        11 010546   000000 000022                    ADSC9   0,,PR0                   cn=0,n=18
        11 010547   100010 400022                    ADSC9   8,,PR1                   cn=2,n=18

     2888    25292    3             CALL KLX$9TO8(PSIZ,CHNRSP.MESSAGE.MSGSIZE,2);

  25292 11 010550   000042 236000 12                 LDQ     34
        11 010551   200430 756100                    STQ     T$+3,,AUTO
        11 010552   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 010553   000015 036003                    ADLQ    13,DU
        11 010554   200427 756100                    STQ     T$+2,,AUTO
        11 010555   200027 633500                    EPPR3   PSIZ,,AUTO
        11 010556   200426 453500                    STP3    T$+1,,AUTO
        11 010557   200426 630500                    EPPR0   T$+1,,AUTO
        11 010560   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 010561   000000 701000 xent               TSX1    KLX$9TO8
        11 010562   000000 011000                    NOP     0

     2889    25293    3             IF LINCNFG.PRO.PROSIZE > 0

  25293 11 010563   000106 470400 7                  LDP0    CNFG$
        11 010564   000007 236100                    LDQ     7,,PR0
        11 010565   777000 316007                    CANQ    -512,DL
        11 010566   010626 600000 11                 TZE     s:25304

     2890    25294    4             THEN DO;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:510  
     2891    25295    4                  KL_PROKEY = LINCNFG.PRO;

  25295 11 010567   000000 100500                    MLR     fill='000'O
        11 010570   000007 400014                    ADSC9   7,,PR0                   cn=2,n=12
        11 010571   000000 000015 xsym               ADSC9   KL_PROKEY                cn=0,n=13

     2892    25296    4                  CALL M$READ (KL_RDPROR)

  25296 11 010572   000000 630400 xsym               EPPR0   KL_RDPROR
        11 010573   440000 713400                    CLIMB   alt,read
        11 010574   401400 401760                    pmme    nvectors=4
        11 010575   010625 702000 11                 TSX2    s:25302

     2893    25297    5                  WHENRETURN DO;

     2894    25298    5                       PSIZ = DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS-SIZEC(KL_PROBUF);

  25298 11 010576   000000 236007 xsym               LDQ     M$PROF,DL
        11 010577   000063 470400 12                 LDP0    51
        11 010600   000000 471500                    LDP1    0,,PR0
        11 010601   100000 473506                    LDP3    0,QL,PR1
        11 010602   300000 720100                    LXL0    0,,PR3
        11 010603   777660 621010                    EAX1    -80,X0
        11 010604   200027 741100                    STX1    PSIZ,,AUTO

     2895    25299    5                       CALL KLX$9TO8(PSIZ,CHNRSP.MESSAGE.MSGSIZE,2);

  25299 11 010605   000042 236000 12                 LDQ     34
        11 010606   200430 756100                    STQ     T$+3,,AUTO
        11 010607   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 010610   000015 036003                    ADLQ    13,DU
        11 010611   200427 756100                    STQ     T$+2,,AUTO
        11 010612   200027 633500                    EPPR3   PSIZ,,AUTO
        11 010613   200426 453500                    STP3    T$+1,,AUTO
        11 010614   200426 630500                    EPPR0   T$+1,,AUTO
        11 010615   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 010616   000000 701000 xent               TSX1    KLX$9TO8
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:511  
        11 010617   000000 011000                    NOP     0

     2896    25300    5                      ADDR(CHNRSP.MESSAGE.MESSAGE)->CHR$PSIZ = PINCRC(ADDR(KL_PROBUF),
             25300                                SIZEC(KL_PROBUF))->CHR$PSIZ;

  25300 11 010620   200027 220100                    LDX0    PSIZ,,AUTO
        11 010621   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 010622   040140 100440                    MLR     fill='040'O
        11 010623   000024 000010 xsym               ADSC9   KL_PROBUF+20             cn=0,n=*X0
        11 010624   000015 400010                    ADSC9   13,,PR0                  cn=2,n=*X0

     2897    25301    5                     END;

     2898    25302    4                END;

  25302 11 010625   010630 710000 11                 TRA     s:25305

     2899    25303    3             ELSE
     2900    25304    3                  PSIZ = 0;

  25304 11 010626   000000 220003                    LDX0    0,DU
        11 010627   200027 740100                    STX0    PSIZ,,AUTO

     2901    25305    3             CALL KLX$WRHLPNODE (CHNRSP,SIZEC(CHNRSP),FEX);

  25305 11 010630   200027 236100                    LDQ     PSIZ,,AUTO
        11 010631   000022 772000                    QRL     18
        11 010632   000011 402007                    MPY     9,DL
        11 010633   001011 036007                    ADLQ    521,DL
        11 010634   000044 506007                    DIV     36,DL
        11 010635   000002 736000                    QLS     2
        11 010636   200426 756100                    STQ     T$+1,,AUTO
        11 010637   200025 630500                    EPPR0   FEX,,AUTO
        11 010640   200431 450500                    STP0    T$+4,,AUTO
        11 010641   200426 631500                    EPPR1   T$+1,,AUTO
        11 010642   200430 451500                    STP1    T$+3,,AUTO
        11 010643   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:512  
        11 010644   200427 756100                    STQ     T$+2,,AUTO
        11 010645   200427 630500                    EPPR0   T$+2,,AUTO
        11 010646   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 010647   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 010650   000000 011000                    NOP     0

     2902    25306    3             CALL M$READ(RD_NETCON)

  25306 11 010651   000334 630400 7                  EPPR0   RD_NETCON
        11 010652   440000 713400                    CLIMB   alt,read
        11 010653   401400 401760                    pmme    nvectors=4
        11 010654   010656 702000 11                 TSX2    s:25308
        11 010655   010660 710000 11                 TRA     s:25310

     2903    25307    4             WHENALTRETURN DO;

     2904    25308    4                  TDEFAULT_KEY.TYP = 0;

  25308 11 010656   000000 236003                    LDQ     0,DU
        11 010657   200062 552120                    STBQ    TDEFAULT_KEY,'20'O,AUTO

     2905    25309    4                END;

     2906    25310    3           END;

  25310 11 010660   200062 236100                    LDQ     TDEFAULT_KEY,,AUTO
        11 010661   000777 376003                    ANQ     511,DU
        11 010662   000003 116003                    CMPQ    3,DU
        11 010663   010671 601000 11                 TNZ     s:25311
        11 010664   200062 236100                    LDQ     TDEFAULT_KEY,,AUTO
        11 010665   000011 772000                    QRL     9
        11 010666   000777 376007                    ANQ     511,DL
        11 010667   200025 116100                    CMPQ    FEX,,AUTO
        11 010670   010511 600000 11                 TZE     s:25282

     2907    25311    2        CONFIG_KEY.NODE = FEX;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:513  
  25311 11 010671   200025 236100                    LDQ     FEX,,AUTO
        11 010672   000011 736000                    QLS     9
        11 010673   000466 552010 7                  STBQ    CONFIG_KEY,'10'O

     2908    25312    2        CONFIG_KEY.TERMID.TTYP = 0;

  25312 11 010674   000000 236003                    LDQ     0,DU
        11 010675   000466 552004 7                  STBQ    CONFIG_KEY,'04'O

     2909    25313    2        CONFIG_KEY.TERMID.LEV = 0;

  25313 11 010676   000467 552040 7                  STBQ    CONFIG_KEY+1,'40'O

     2910    25314    2        FPT_PRECORD.KEY_ = VECTOR(CONFIG_KEY);

  25314 11 010677   000066 237000 12                 LDAQ    54
        11 010700   000354 757000 7                  STAQ    FPT_PRECORD+2

     2911    25315    2        PSIZ=0;

  25315 11 010701   000000 220003                    LDX0    0,DU
        11 010702   200027 740100                    STX0    PSIZ,,AUTO

     2912    25316    2        CALL M$PRECORD (FPT_PRECORD)

  25316 11 010703   000352 630400 7                  EPPR0   FPT_PRECORD
        11 010704   440003 713400                    CLIMB   alt,+16387
        11 010705   401000 401760                    pmme    nvectors=3
        11 010706   010710 702000 11                 TSX2    s:25320
        11 010707   010710 710000 11                 TRA     s:25320

     2913    25317    3        WHENALTRETURN DO;

     2914    25318                                                /* It is expected */
     2915    25319    3           END;

     2916    25320    2        RD_NETCON.KEY_ = VECTOR(TCONFIG_KEY);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:514  

  25320 11 010710   000066 235000 12                 LDA     54
        11 010711   200426 452500                    STP2    T$+1,,AUTO
        11 010712   200426 236100                    LDQ     T$+1,,AUTO
        11 010713   000055 036003                    ADLQ    45,DU
        11 010714   000336 757000 7                  STAQ    RD_NETCON+2

     2917    25321
     2918    25322    2        CALL M$READ(RD_NETCON)

  25322 11 010715   000334 630400 7                  EPPR0   RD_NETCON
        11 010716   440000 713400                    CLIMB   alt,read
        11 010717   401400 401760                    pmme    nvectors=4
        11 010720   010722 702000 11                 TSX2    s:25324
        11 010721   010724 710000 11                 TRA     s:25326

     2919    25323    3        WHENALTRETURN DO;

     2920    25324    3             TCONFIG_KEY.TYP = 0;

  25324 11 010722   000000 236003                    LDQ     0,DU
        11 010723   200055 552120                    STBQ    TCONFIG_KEY,'20'O,AUTO

     2921    25325    3           END;

     2922    25326    3        DO WHILE(TCONFIG_KEY.TYP = %KL_KEYTYP_CONFIG AND TCONFIG_KEY.NODE = FEX);

  25326 11 010724   011003 710000 11                 TRA     s:25338

     2923    25327    3             CHNRSP = KL_CHNRSPC;

  25327 11 010725   200027 220100                    LDX0    PSIZ,,AUTO
        11 010726   000066 621010                    EAX1    54,X0
        11 010727   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 010730   000140 100400                    MLR     fill='000'O
        11 010731   000024 000465 10                 ADSC9   KL_CHNRSPC               cn=0,n=309
        11 010732   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:515  

     2924    25328    3             CHNRSP.CONFIG = '1'B;

  25328 11 010733   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 010734   000100 236003                    LDQ     64,DU
        11 010735   000000 256100                    ORSQ    0,,PR0

     2925    25329    3             CHNRSP.TERMINAL_ID = TCONFIG_KEY.TERMID;

  25329 11 010736   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 010737   000100 100500                    MLR     fill='000'O
        11 010740   200055 600020                    ADSC9   TCONFIG_KEY,,AUTO        cn=3,n=16
        11 010741   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16

     2926    25330    3             CHNRSP.NA = LINCNFG.NA;

  25330 11 010742   000106 471400 7                  LDP1    CNFG$
        11 010743   000100 100500                    MLR     fill='000'O
        11 010744   100004 400010                    ADSC9   4,,PR1                   cn=2,n=8
        11 010745   000006 400010                    ADSC9   6,,PR0                   cn=2,n=8

     2927    25331    3             CHNRSP.NA.CNFG_EXISTS = '1'B;

  25331 11 010746   000002 236007                    LDQ     2,DL
        11 010747   000006 256100                    ORSQ    6,,PR0

     2928    25332    3             CHNRSP.HNDCMN = LINCNFG.KHA;

  25332 11 010750   000100 100500                    MLR     fill='000'O
        11 010751   100000 000022                    ADSC9   0,,PR1                   cn=0,n=18
        11 010752   000010 400022                    ADSC9   8,,PR0                   cn=2,n=18

     2929    25333    3             CALL KLX$WRHLPNODE (CHNRSP,SIZEC(CHNRSP),FEX);

  25333 11 010753   200027 236100                    LDQ     PSIZ,,AUTO
        11 010754   000022 772000                    QRL     18
        11 010755   000011 402007                    MPY     9,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:516  
        11 010756   001011 036007                    ADLQ    521,DL
        11 010757   000044 506007                    DIV     36,DL
        11 010760   000002 736000                    QLS     2
        11 010761   200426 756100                    STQ     T$+1,,AUTO
        11 010762   200025 633500                    EPPR3   FEX,,AUTO
        11 010763   200431 453500                    STP3    T$+4,,AUTO
        11 010764   200426 634500                    EPPR4   T$+1,,AUTO
        11 010765   200430 454500                    STP4    T$+3,,AUTO
        11 010766   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 010767   200427 756100                    STQ     T$+2,,AUTO
        11 010770   200427 630500                    EPPR0   T$+2,,AUTO
        11 010771   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 010772   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 010773   000000 011000                    NOP     0

     2930    25334    3             CALL M$READ(RD_NETCON)

  25334 11 010774   000334 630400 7                  EPPR0   RD_NETCON
        11 010775   440000 713400                    CLIMB   alt,read
        11 010776   401400 401760                    pmme    nvectors=4
        11 010777   011001 702000 11                 TSX2    s:25336
        11 011000   011003 710000 11                 TRA     s:25338

     2931    25335    4             WHENALTRETURN DO;

     2932    25336    4                  TCONFIG_KEY.TYP = 0;

  25336 11 011001   000000 236003                    LDQ     0,DU
        11 011002   200055 552120                    STBQ    TCONFIG_KEY,'20'O,AUTO

     2933    25337    4                END;

     2934    25338    3           END;

  25338 11 011003   200055 236100                    LDQ     TCONFIG_KEY,,AUTO
        11 011004   000777 376003                    ANQ     511,DU
        11 011005   000002 116003                    CMPQ    2,DU
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:517  
        11 011006   011014 601000 11                 TNZ     s:25340
        11 011007   200055 236100                    LDQ     TCONFIG_KEY,,AUTO
        11 011010   000011 772000                    QRL     9
        11 011011   000777 376007                    ANQ     511,DL
        11 011012   200025 116100                    CMPQ    FEX,,AUTO
        11 011013   010725 600000 11                 TZE     s:25327

     2935    25339
     2936    25340    2        CHNRSP = KL_CHNRSPC;

  25340 11 011014   200027 220100                    LDX0    PSIZ,,AUTO
        11 011015   000066 621010                    EAX1    54,X0
        11 011016   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 011017   000140 100400                    MLR     fill='000'O
        11 011020   000024 000465 10                 ADSC9   KL_CHNRSPC               cn=0,n=309
        11 011021   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     2937    25341        /* Send a CHNRSP with a channel of 0 to get NA going */
     2938    25342    2        CHNRSP.TERMINAL_ID = '0'B;

  25342 11 011022   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
        11 011023   000100 100400                    MLR     fill='000'O
        11 011024   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 011025   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16

     2939    25343    2        CALL KLX$WRHLPNODE (CHNRSP,SIZEC(CHNRSP),FEX);

  25343 11 011026   200027 236100                    LDQ     PSIZ,,AUTO
        11 011027   000022 772000                    QRL     18
        11 011030   000011 402007                    MPY     9,DL
        11 011031   001011 036007                    ADLQ    521,DL
        11 011032   000044 506007                    DIV     36,DL
        11 011033   000002 736000                    QLS     2
        11 011034   200426 756100                    STQ     T$+1,,AUTO
        11 011035   200025 631500                    EPPR1   FEX,,AUTO
        11 011036   200431 451500                    STP1    T$+4,,AUTO
        11 011037   200426 633500                    EPPR3   T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:518  
        11 011040   200430 453500                    STP3    T$+3,,AUTO
        11 011041   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
        11 011042   200427 756100                    STQ     T$+2,,AUTO
        11 011043   200427 630500                    EPPR0   T$+2,,AUTO
        11 011044   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 011045   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 011046   000000 011000                    NOP     0

     2940    25344
     2941    25345
     2942    25346    2        RETURN;

  25346 11 011047   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011050   000001 702211                    TSX2  ! 1,X1

  25346 11 011051                       KBD          null
     2943    25347    2   END GETCONFIGS;
     2944    25348        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:519  
     2945    25349        /**/
     2946    25350    1   KBD: ;
     2947    25351    1        IF FEX>KL_MXFE THEN GOTO BDFEX;

  25351 11 011051   000000 236000 xsym               LDQ     KL_MXFE
        11 011052   200025 116100                    CMPQ    FEX,,AUTO
        11 011053   011101 602000 11                 TNC     BDFEX

     2948    25352    1        IF FEX = 0 OR KMSG.NAME = ' '      /* Undefined node */

  25352 11 011054   200025 235100                    LDA     FEX,,AUTO
        11 011055   011101 600000 11                 TZE     BDFEX
        11 011056   040000 106400                    CMPC    fill='040'O
        11 011057   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
        11 011060   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 011061   011101 600000 11                 TZE     BDFEX

     2949    25353    1        THEN
     2950    25354    1             GOTO BDFEX;
     2951    25355    1        ELSE GOTO KYERR;

  25355 11 011062   011127 710000 11                 TRA     KYERR

  25352 11 011063                       ERRORK       null
     2952    25356    1   ERRORK:;
     2953    25357    1        KL_FETBL.KTYP(FEX)=ERRC;

  25357 11 011063   200025 720100                    LXL0    FEX,,AUTO
        11 011064   200032 236100                    LDQ     ERRC,,AUTO
        11 011065   000033 736000                    QLS     27
        11 011066   000000 676010 xsym               ERQ     KL_FETBL,X0
        11 011067   007000 376003                    ANQ     3584,DU
        11 011070   000000 656010 xsym               ERSQ    KL_FETBL,X0

  25357 11 011071                       ERROR        null
     2954    25358    1   ERROR:;
     2955    25359    1        ERRC=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:520  

  25359 11 011071   000000 470400 xsym               LDP0    B$TCB$
        11 011072   000000 471500                    LDP1    0,,PR0
        11 011073   100102 236100                    LDQ     66,,PR1
        11 011074   000003 772000                    QRL     3
        11 011075   037777 376007                    ANQ     16383,DL
        11 011076   200032 756100                    STQ     ERRC,,AUTO

     2956    25360    2        IF ERRC=%E$BADFEX THEN DO;

  25360 11 011077   002042 116007                    CMPQ    1058,DL
        11 011100   011104 601000 11                 TNZ     s:25365

  25357 11 011101                       BDFEX        null
     2957    25361    2   BDFEX:    ;
     2958    25362    2             KBERR.MSG#=NOFE_MSG#;

  25362 11 011101   000014 220003                    LDX0    12,DU
        11 011102   200402 440100                    SXL0    KBERR,,AUTO

     2959    25363    2             GOTO WTERR;

  25363 11 011103   011131 710000 11                 TRA     WTERR

     2960    25364    2           END;
     2961    25365    2        IF ERRC=%E$FEPART THEN DO;

  25365 11 011104   002051 116007                    CMPQ    1065,DL
        11 011105   011113 601000 11                 TNZ     s:25370

     2962    25366    2             KBERR.MSG#=FESP_MSG#;

  25366 11 011106   000007 220003                    LDX0    7,DU
        11 011107   200402 440100                    SXL0    KBERR,,AUTO

     2963    25367    2             KBERR.ERR=KIER_PART;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:521  
  25367 11 011110   016000 236007                    LDQ     7168,DL
        11 011111   200410 552110                    STBQ    KBERR+6,'10'O,AUTO

     2964    25368    2             GOTO WTERR;

  25368 11 011112   011131 710000 11                 TRA     WTERR

     2965    25369    2           END;
     2966    25370    1        IF ERRC=%E$CURBOOT THEN KBERR.ERR=%KLKT_BOOT#;

  25370 11 011113   002041 116007                    CMPQ    1057,DL
        11 011114   011120 601000 11                 TNZ     s:25371

  25370 11 011115   001000 236007                    LDQ     512,DL
        11 011116   200410 552110                    STBQ    KBERR+6,'10'O,AUTO
        11 011117   011127 710000 11                 TRA     KYERR

     2967    25371    1        ELSE IF ERRC=%E$FEPRUN THEN KBERR.ERR=%KLKT_NONE#;

  25371 11 011120   002045 116007                    CMPQ    1061,DL
        11 011121   011125 601000 11                 TNZ     STPERR

  25371 11 011122   000000 236003                    LDQ     0,DU
        11 011123   200410 552110                    STBQ    KBERR+6,'10'O,AUTO
        11 011124   011127 710000 11                 TRA     KYERR

     2968    25372    2             ELSE DO;

  25370 11 011125                       STPERR       null
     2969    25373    2   STPERR:        ;
     2970    25374    2                  KBERR.ERR=%KLKT_STOP#;

  25374 11 011125   003000 236007                    LDQ     1536,DL
        11 011126   200410 552110                    STBQ    KBERR+6,'10'O,AUTO

     2971    25375    2                END;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:522  
  25370 11 011127                       KYERR        null
     2972    25376    1   KYERR: ;
     2973    25377    1        KBERR.MSG#=FKER_MSG#;

  25377 11 011127   000012 220003                    LDX0    10,DU
        11 011130   200402 440100                    SXL0    KBERR,,AUTO

  25377 11 011131                       WTERR        null
     2974    25378    1   WTERR:;
     2975    25379    1        KBERR.CADDR=KMSG.CADDR;

  25379 11 011131   000000 721000 xsym               LXL1    JC_CSMBF
        11 011132   200402 741100                    STX1    KBERR,,AUTO

  25379 11 011133                       WRTKYN       null
     2976    25380    1   WRTKYN:;
     2977    25381    1        KBERR.NAME = KMSG.NAME;

  25381 11 011133   040100 100400                    MLR     fill='040'O
        11 011134   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
        11 011135   200411 600010                    ADSC9   KBERR+7,,AUTO            cn=3,n=8

     2978    25382    1        KBERR.FEX=FEX;

  25382 11 011136   200025 236100                    LDQ     FEX,,AUTO
        11 011137   000022 736000                    QLS     18
        11 011140   200410 552120                    STBQ    KBERR+6,'20'O,AUTO

     2979    25383    1        WKBER.BUF_=VECTOR(KBERR);

  25383 11 011141   000031 235000 12                 LDA     25
        11 011142   200426 452500                    STP2    T$+1,,AUTO
        11 011143   200426 236100                    LDQ     T$+1,,AUTO
        11 011144   000402 036003                    ADLQ    258,DU
        11 011145   000426 757000 7                  STAQ    WKBER+4

     2980    25384    1        CALL M$WRITE (WKBER) ALTRET (RTN);
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:523  

  25384 11 011146   000422 630400 7                  EPPR0   WKBER
        11 011147   440001 713400                    CLIMB   alt,write
        11 011150   401400 401760                    pmme    nvectors=4
        11 011151   001537 702000 11                 TSX2    BHSON1

     2981    25385    1        RETURN;

  25385 11 011152   000000 702200 xent               TSX2  ! X66_ARET

     2982    25386        /**/
     2983    25387        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:524  
     2984    25388    1   BDSET: PROC ALTRET;

  25388 11 011153   200414 741300       BDSET        STX1  ! KBERR+10,,AUTO

     2985    25389        /**/
     2986    25390    2        IF KL_FETBL.LINK_CONNECT(FEX)

  25390 11 011154   200025 720100                    LXL0    FEX,,AUTO
        11 011155   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 011156   200000 316003                    CANQ    65536,DU
        11 011157   011172 600000 11                 TZE     s:25398

     2987    25391    3        THEN DO;

     2988    25392    3             HLTFEP.V.FEP#=FEX;

  25392 11 011160   200025 235100                    LDA     FEX,,AUTO
        11 011161   000373 755000 7                  STA     HLTFEP+7

     2989    25393    4             CALL M$FECTL (HLTFEP) WHENALTRETURN DO ;

  25393 11 011162   000364 630400 7                  EPPR0   HLTFEP
        11 011163   560017 713400                    CLIMB   alt,+57359
        11 011164   401000 401760                    pmme    nvectors=3
        11 011165   011167 702000 11                 TSX2    s:25394
        11 011166   011171 710000 11                 TRA     s:25396

     2990    25394    4                  ALTRETURN ;

  25394 11 011167   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011170   000000 702211                    TSX2  ! 0,X1

     2991    25395    4                END ;
     2992    25396    3           END;

  25396 11 011171   011217 710000 11                 TRA     s:25409

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:525  
     2993    25397    3        ELSE DO;

     2994    25398    3             KL_FETBL.KTYP(FEX) = %KLKT_NONE#;

  25398 11 011172   000011 236000 12                 LDQ     9
        11 011173   000000 356010 xsym               ANSQ    KL_FETBL,X0

     2995    25399    3             IF KMSG.KIN# = KEY_CRASHFEP#

  25399 11 011174   000000 222000 xsym               LDX2    JC_CSMBF
        11 011175   000030 102003                    CMPX2   24,DU
        11 011176   011202 601000 11                 TNZ     s:25403

     2996    25400    3             THEN
     2997    25401    3                  BOOTMSG.CODE_ = IGA_CRASHFEP;

  25401 11 011177   023000 236003                    LDQ     9728,DU
        11 011200   000465 552040 7                  STBQ    BOOTMSG,'40'O
        11 011201   011204 710000 11                 TRA     s:25404

     2998    25402    3             ELSE
     2999    25403    3                  BOOTMSG.CODE_ = IGA_BOOTFEP;

  25403 11 011202   022000 236003                    LDQ     9216,DU
        11 011203   000465 552040 7                  STBQ    BOOTMSG,'40'O

     3000    25404    3             CALL KLX$WRHLPNODE (BOOTMSG,SIZEC(BOOTMSG),FEX)

  25404 11 011204   200025 630500                    EPPR0   FEX,,AUTO
        11 011205   200430 450500                    STP0    T$+3,,AUTO
        11 011206   000202 237000 12                 LDAQ    130
        11 011207   200426 757100                    STAQ    T$+1,,AUTO
        11 011210   200426 630500                    EPPR0   T$+1,,AUTO
        11 011211   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 011212   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 011213   011215 702000 11                 TSX2    s:25406
        11 011214   011217 710000 11                 TRA     s:25409
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:526  

     3001    25405    4             WHENALTRETURN DO;

     3002    25406    4                  ALTRETURN;

  25406 11 011215   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011216   000000 702211                    TSX2  ! 0,X1

     3003    25407    4                END;
     3004    25408    3           END;

     3005    25409    2        RETURN;

  25409 11 011217   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011220   000001 702211                    TSX2  ! 1,X1

     3006    25410        /**/
     3007    25411        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:527  
     3008    25412    2   STFEP: ENTRY ALTRET;

  25412 11 011221   200414 741300       STFEP        STX1  ! KBERR+10,,AUTO

     3009    25413        /**/
     3010    25414    2        GOFEP.V.FEP#=FEX;

  25414 11 011222   200025 235100                    LDA     FEX,,AUTO
        11 011223   000405 755000 7                  STA     GOFEP+7

     3011    25415    3        CALL M$FECTL (GOFEP) WHENALTRETURN DO ;

  25415 11 011224   000376 630400 7                  EPPR0   GOFEP
        11 011225   560017 713400                    CLIMB   alt,+57359
        11 011226   401000 401760                    pmme    nvectors=3
        11 011227   011231 702000 11                 TSX2    s:25416
        11 011230   011233 710000 11                 TRA     s:25418

     3012    25416    3             ALTRETURN ;

  25416 11 011231   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011232   000000 702211                    TSX2  ! 0,X1

     3013    25417    3           END ;
     3014    25418    2        RETURN;

  25418 11 011233   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011234   000001 702211                    TSX2  ! 1,X1

     3015    25419        /**/
     3016    25420    2   STPFEP: ENTRY ALTRET;

  25420 11 011235   200414 741300       STPFEP       STX1  ! KBERR+10,,AUTO

     3017    25421        /**/
     3018    25422    2        KL_FETBL.KTYP(FEX)=%KLKT_NONE#;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:528  
  25422 11 011236   200025 720100                    LXL0    FEX,,AUTO
        11 011237   000011 236000 12                 LDQ     9
        11 011240   000000 356010 xsym               ANSQ    KL_FETBL,X0

     3019    25423    3        IF KMSG.FID.CNT~=0 THEN DO;

  25423 11 011241   000004 236000 xsym               LDQ     JC_CSMBF+4
        11 011242   777000 316003                    CANQ    -512,DU
        11 011243   011266 600000 11                 TZE     s:25427+2

     3020    25424    3             CALL KLX$WRHLPNODE(STPMSG,SIZEC(STPMSG),FEX);

  25424 11 011244   200025 630500                    EPPR0   FEX,,AUTO
        11 011245   200430 450500                    STP0    T$+3,,AUTO
        11 011246   000206 237000 12                 LDAQ    134
        11 011247   200426 757100                    STAQ    T$+1,,AUTO
        11 011250   200426 630500                    EPPR0   T$+1,,AUTO
        11 011251   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 011252   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 011253   000000 011000                    NOP     0

     3021    25425    3             CALL M$WAIT (FPT_WAIT) ;      /* WAIT A SEC */

  25425 11 011254   000010 630400 10                 EPPR0   FPT_WAIT
        11 011255   020006 713400                    CLIMB   8198
        11 011256   400400 401760                    pmme    nvectors=2

     3022    25426    3             KL_FETBL.KTYP(FEX)=%KLKT_STOP#;

  25426 11 011257   200025 720100                    LXL0    FEX,,AUTO
        11 011260   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 011261   000011 376000 12                 ANQ     9
        11 011262   003000 276003                    ORQ     1536,DU
        11 011263   000000 756010 xsym               STQ     KL_FETBL,X0

     3023    25427    3             RETURN;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:529  
  25427 11 011264   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011265   000001 702211                    TSX2  ! 1,X1
        11 011266   011270 710000 11                 TRA     s:25432

     3024    25428    3           END;
     3025    25429        /**/
     3026    25430    2   STFEPNM: ENTRY ALTRET ;

  25430 11 011267   200414 741300       STFEPNM      STX1  ! KBERR+10,,AUTO

     3027    25431
     3028    25432    2        STOPFEP.V.FEP# = FEX ;

  25432 11 011270   200025 235100                    LDA     FEX,,AUTO
        11 011271   000417 755000 7                  STA     STOPFEP+7

     3029    25433    2        KL_FETBL.KTYP ( FEX ) = %KLKT_STOP# ;

  25433 11 011272   000000 236005 xsym               LDQ     KL_FETBL,AL
        11 011273   000011 376000 12                 ANQ     9
        11 011274   003000 276003                    ORQ     1536,DU
        11 011275   000000 756005 xsym               STQ     KL_FETBL,AL

     3030    25434    3        CALL M$FECTL ( STOPFEP ) WHENALTRETURN DO ;

  25434 11 011276   000410 630400 7                  EPPR0   STOPFEP
        11 011277   560017 713400                    CLIMB   alt,+57359
        11 011300   401000 401760                    pmme    nvectors=3
        11 011301   011303 702000 11                 TSX2    s:25435
        11 011302   011310 710000 11                 TRA     s:25438

     3031    25435    3             KL_FETBL.KTYP ( FEX ) = %KLKT_NONE# ;

  25435 11 011303   200025 720100                    LXL0    FEX,,AUTO
        11 011304   000011 236000 12                 LDQ     9
        11 011305   000000 356010 xsym               ANSQ    KL_FETBL,X0

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:530  
     3032    25436    3             ALTRETURN ;

  25436 11 011306   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011307   000000 702211                    TSX2  ! 0,X1

     3033    25437    3           END ;
     3034    25438    2        RETURN ;

  25438 11 011310   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011311   000001 702211                    TSX2  ! 1,X1

     3035    25439
     3036    25440        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:531  
     3037    25441    2   KCHK: ENTRY ALTRET;

  25441 11 011312   200414 741300       KCHK         STX1  ! KBERR+10,,AUTO

     3038    25442        /**/
     3039    25443    2        FEX=KMSG.FEX;

  25443 11 011313   000001 235000 xsym               LDA     JC_CSMBF+1
        11 011314   200025 755100                    STA     FEX,,AUTO

     3040    25444    2        IF FEX = 0 AND KMSG.NAME = ' '

  25444 11 011315   011323 601000 11                 TNZ     s:25447
        11 011316   040000 106400                    CMPC    fill='040'O
        11 011317   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
        11 011320   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 011321   011323 601000 11                 TNZ     s:25447

     3041    25445    2        THEN
     3042    25446    2             RETURN;

  25446 11 011322   000001 702211                    TSX2  ! 1,X1

     3043    25447    2        IF FEX = 0

  25447 11 011323   000000 115003                    CMPA    0,DU
        11 011324   011343 601000 11                 TNZ     s:25454

     3044    25448    2        THEN
     3045    25449    2             CALL KLX$CONV_NODENAME(KMSG.NAME,FEX,NODETYPE)

  25449 11 011325   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 011326   200430 450500                    STP0    T$+3,,AUTO
        11 011327   200025 631500                    EPPR1   FEX,,AUTO
        11 011330   200427 451500                    STP1    T$+2,,AUTO
        11 011331   000027 236000 12                 LDQ     23
        11 011332   200426 756100                    STQ     T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:532  
        11 011333   200426 630500                    EPPR0   T$+1,,AUTO
        11 011334   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 011335   000000 701000 xent               TSX1    KLX$CONV_NODENAME
        11 011336   011340 702000 11                 TSX2    s:25451
        11 011337   011342 710000 11                 TRA     s:25451+2

     3046    25450    3             WHENALTRETURN DO;

     3047    25451    3                  ALTRETURN;

  25451 11 011340   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011341   000000 702211                    TSX2  ! 0,X1
        11 011342   011360 710000 11                 TRA     s:25458

     3048    25452    3                END;
     3049    25453    2        ELSE
     3050    25454    2             CALL KLX$CONV_NODE (KMSG.NAME,FEX,NODETYPE)

  25454 11 011343   200026 630500                    EPPR0   NODETYPE,,AUTO
        11 011344   200430 450500                    STP0    T$+3,,AUTO
        11 011345   200025 631500                    EPPR1   FEX,,AUTO
        11 011346   200427 451500                    STP1    T$+2,,AUTO
        11 011347   000027 236000 12                 LDQ     23
        11 011350   200426 756100                    STQ     T$+1,,AUTO
        11 011351   200426 630500                    EPPR0   T$+1,,AUTO
        11 011352   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 011353   000000 701000 xent               TSX1    KLX$CONV_NODE
        11 011354   011356 702000 11                 TSX2    s:25456
        11 011355   011360 710000 11                 TRA     s:25458

     3051    25455    3             WHENALTRETURN DO;

     3052    25456    3                  ALTRETURN;

  25456 11 011356   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011357   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:533  
     3053    25457    3                END;
     3054    25458    2        KMSG.FEX = FEX;

  25458 11 011360   200025 235100                    LDA     FEX,,AUTO
        11 011361   000001 755000 xsym               STA     JC_CSMBF+1

     3055    25459    2        IF (KL_FETBL.KTYP(FEX)=%KLKT_BOOT# OR KL_FETBL.KTYP(FEX)=%KLKT_DUMP#

  25459 11 011362   000000 236005 xsym               LDQ     KL_FETBL,AL
        11 011363   007000 376003                    ANQ     3584,DU
        11 011364   001000 116003                    CMPQ    512,DU
        11 011365   011375 600000 11                 TZE     s:25459+11
        11 011366   200025 720100                    LXL0    FEX,,AUTO
        11 011367   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 011370   007000 376003                    ANQ     3584,DU
        11 011371   002000 116003                    CMPQ    1024,DU
        11 011372   011375 600000 11                 TZE     s:25459+11
        11 011373   004000 116003                    CMPQ    2048,DU
        11 011374   011407 601000 11                 TNZ     s:25465
        11 011375   000000 220000 xsym               LDX0    JC_CSMBF
        11 011376   000030 100003                    CMPX0   24,DU
        11 011377   011407 603000 11                 TRC     s:25465

     3056    25460    2             OR KL_FETBL.KTYP(FEX) = %KLKT_CRASH#) AND KMSG.KIN# < KEY_CRASHFEP#
     3057    25461    3        THEN DO;

     3058    25462    3             KBERR.ERR=KL_FETBL.KTYP(FEX);

  25462 11 011400   200025 721100                    LXL1    FEX,,AUTO
        11 011401   000000 236011 xsym               LDQ     KL_FETBL,X1
        11 011402   007000 376003                    ANQ     3584,DU
        11 011403   000022 772000                    QRL     18
        11 011404   200410 552110                    STBQ    KBERR+6,'10'O,AUTO

     3059    25463    3             ALTRETURN;

  25463 11 011405   200414 221300                    LDX1  ! KBERR+10,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:534  
        11 011406   000000 702211                    TSX2  ! 0,X1

     3060    25464    3           END;
     3061    25465    2        RETURN;

  25465 11 011407   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011410   000001 702211                    TSX2  ! 1,X1

     3062    25466    2   END;
     3063    25467        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:535  
     3064    25468    1   LOCAL_CHECK: PROC ALTRET;

  25468 11 011411   200414 741300       LOCAL_CHECK  STX1  ! KBERR+10,,AUTO

     3065    25469    2        IF KL_FETBL.LINK_CONNECT(FEX)

  25469 11 011412   200025 720100                    LXL0    FEX,,AUTO
        11 011413   000000 236010 xsym               LDQ     KL_FETBL,X0
        11 011414   200000 316003                    CANQ    65536,DU
        11 011415   011417 600000 11                 TZE     s:25472

     3066    25470    2        THEN
     3067    25471    2             RETURN;

  25471 11 011416   000001 702211                    TSX2  ! 1,X1

     3068    25472    2        KBERR=CKBR;

  25472 11 011417   000100 100400                    MLR     fill='000'O
        11 011420   000202 000047 10                 ADSC9   CKBR                     cn=0,n=39
        11 011421   200402 000047                    ADSC9   KBERR,,AUTO              cn=0,n=39

     3069    25473    2        KBERR.CADDR = KMSG.CADDR;

  25473 11 011422   000000 722000 xsym               LXL2    JC_CSMBF
        11 011423   200402 742100                    STX2    KBERR,,AUTO

     3070    25474    2        KBERR.FEX = FEX;

  25474 11 011424   200025 236100                    LDQ     FEX,,AUTO
        11 011425   000022 736000                    QLS     18
        11 011426   200410 552120                    STBQ    KBERR+6,'20'O,AUTO

     3071    25475    2        KBERR.NAME = KMSG.NAME;

  25475 11 011427   040100 100400                    MLR     fill='040'O
        11 011430   000002 000010 xsym               ADSC9   JC_CSMBF+2               cn=0,n=8
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:536  
        11 011431   200411 600010                    ADSC9   KBERR+7,,AUTO            cn=3,n=8

     3072    25476    2        KBERR.MSG# = NLCL_MSG#;

  25476 11 011432   000017 223003                    LDX3    15,DU
        11 011433   200402 443100                    SXL3    KBERR,,AUTO

     3073    25477    2        WKBER.BUF_ = VECTOR(KBERR);

  25477 11 011434   000031 235000 12                 LDA     25
        11 011435   200426 452500                    STP2    T$+1,,AUTO
        11 011436   200426 236100                    LDQ     T$+1,,AUTO
        11 011437   000402 036003                    ADLQ    258,DU
        11 011440   000426 757000 7                  STAQ    WKBER+4

     3074    25478    2        CALL M$WRITE (WKBER)

  25478 11 011441   000422 630400 7                  EPPR0   WKBER
        11 011442   440001 713400                    CLIMB   alt,write
        11 011443   401400 401760                    pmme    nvectors=4
        11 011444   011446 702000 11                 TSX2    s:25481
        11 011445   011446 710000 11                 TRA     s:25481

     3075    25479    3        WHENALTRETURN DO;

     3076    25480    3           END;

     3077    25481    2        ALTRETURN;

  25481 11 011446   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011447   000000 702211                    TSX2  ! 0,X1

     3078    25482
     3079    25483    2   END LOCAL_CHECK;
     3080    25484        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:537  
     3081    25485    1   SENDCWNAK: PROC (NETADDR,ERR);

  25485 11 011450   200414 741300       SENDCWNAK    STX1  ! KBERR+10,,AUTO

     3082    25486
     3083    25487    2   DCL 1 NETADDR UNAL,
     3084    25488    2            2 NODE UBIN BYTE CALIGNED,
     3085    25489    2            2 GENERATION UBIN BYTE CALIGNED,
     3086    25490    2            2 LDCTX UBIN(18) HALIGNED;
     3087    25491    2   DCL ERR BIT(36) UNAL;
     3088    25492
     3089    25493    2        CWNAK = '0'B;

  25493 11 011451   000100 100400                    MLR     fill='000'O
        11 011452   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 011453   200156 000014                    ADSC9   CWNAK,,AUTO              cn=0,n=12

     3090    25494    2        CWNAK.FCN = IGA_CWNAK;

  25494 11 011454   034000 236003                    LDQ     14336,DU
        11 011455   200156 552140                    STBQ    CWNAK,'40'O,AUTO

     3091    25495    2        CWNAK.NETADR = NETADDR;

  25495 11 011456   200415 470500                    LDP0    @NETADDR,,AUTO
        11 011457   000100 100500                    MLR     fill='000'O
        11 011460   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        11 011461   200156 400004                    ADSC9   CWNAK,,AUTO              cn=2,n=4

     3092    25496    2        CALL KLX$ERR2NETERR(ERR,CWNAK.NETERR);

  25496 11 011462   200430 452500                    STP2    T$+3,,AUTO
        11 011463   200430 236100                    LDQ     T$+3,,AUTO
        11 011464   000205 036000 12                 ADLQ    133
        11 011465   200416 235100                    LDA     @ERR,,AUTO
        11 011466   200426 757100                    STAQ    T$+1,,AUTO
        11 011467   200426 630500                    EPPR0   T$+1,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:538  
        11 011470   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 011471   000000 701000 xent               TSX1    KLX$ERR2NETERR
        11 011472   000000 011000                    NOP     0

     3093    25497    2        FEX = CWNAK.NETADR.NODE;

  25497 11 011473   200156 236100                    LDQ     CWNAK,,AUTO
        11 011474   000011 772000                    QRL     9
        11 011475   000777 376007                    ANQ     511,DL
        11 011476   200025 756100                    STQ     FEX,,AUTO

     3094    25498    2        IF FEX = KL_NODE

  25498 11 011477   000000 116000 xsym               CMPQ    KL_NODE
        11 011500   011514 601000 11                 TNZ     s:25502

     3095    25499    2        THEN
     3096    25500    2             CALL KLX$WRHLPSTA(CWNAK,SIZEC(CWNAK),'BABOON  ');

  25500 11 011501   000054 236000 12                 LDQ     44
        11 011502   200430 756100                    STQ     T$+3,,AUTO
        11 011503   000211 236000 12                 LDQ     137
        11 011504   200427 756100                    STQ     T$+2,,AUTO
        11 011505   200156 630500                    EPPR0   CWNAK,,AUTO
        11 011506   200426 450500                    STP0    T$+1,,AUTO
        11 011507   200426 630500                    EPPR0   T$+1,,AUTO
        11 011510   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 011511   000000 701000 xent               TSX1    KLX$WRHLPSTA
        11 011512   000000 011000                    NOP     0
        11 011513   011526 710000 11                 TRA     s:25504

     3097    25501    2        ELSE
     3098    25502    2             CALL KLX$WRHLPNODE(CWNAK,SIZEC(CWNAK),FEX);

  25502 11 011514   200025 630500                    EPPR0   FEX,,AUTO
        11 011515   200430 450500                    STP0    T$+3,,AUTO
        11 011516   000211 236000 12                 LDQ     137
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:539  
        11 011517   200427 756100                    STQ     T$+2,,AUTO
        11 011520   200156 631500                    EPPR1   CWNAK,,AUTO
        11 011521   200426 451500                    STP1    T$+1,,AUTO
        11 011522   200426 630500                    EPPR0   T$+1,,AUTO
        11 011523   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 011524   000000 701000 xent               TSX1    KLX$WRHLPNODE
        11 011525   000000 011000                    NOP     0

     3099    25503
     3100    25504    2        RETURN;

  25504 11 011526   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011527   000001 702211                    TSX2  ! 1,X1

     3101    25505
     3102    25506    2   END SENDCWNAK;
     3103    25507        %EJECT;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:540  
     3104    25508        /*I* NAME: I$8TO9
     3105    25509             PURPOSE: To pack up a series of L6 bytes &/ words.
     3106    25510        */
     3107    25511
     3108    25512    1   I$8TO9: PROC(SOURCE,DEST,BYTES,REPS);

  25512 11 011530   200414 741300       I$8TO9       STX1  ! KBERR+10,,AUTO

     3109    25513
     3110    25514    2   DCL SOURCE(0:0) UBIN BYTE CALIGNED;
     3111    25515    2   DCL DEST(0:0) UBIN BYTE CALIGNED;
     3112    25516    2   DCL BYTES UBIN;
     3113    25517    2   DCL REPS UBIN;
     3114    25518
     3115    25519    2   DCL TEMP UBIN;
     3116    25520    2   DCL TEMP2 UBIN;
     3117    25521    2   DCL SRC$ PTR;
     3118    25522    2   DCL DST$ PTR;
     3119    25523    2   DCL T$ PTR;
     3120    25524    2   DCL BYT$8(0:0) UBIN(8) UNAL BASED;
     3121    25525    2   DCL BYT$9(0:0) UBIN BYTE CALIGNED BASED;
     3122    25526    2   DCL BIT$S BIT(BYTES) UNAL BASED;
     3123    25527
     3124    25528    2        DST$=ADDR(DEST);

  25528 11 011531   200416 236100                    LDQ     @DEST,,AUTO
        11 011532   200424 756100                    STQ     DST$,,AUTO

     3125    25529    2        SRC$=ADDR(SOURCE);

  25529 11 011533   200415 236100                    LDQ     @SOURCE,,AUTO
        11 011534   200423 756100                    STQ     SRC$,,AUTO

     3126    25530    3        DO TEMP2=0 TO REPS-1;

  25530 11 011535   200422 450100                    STZ     TEMP2,,AUTO
        11 011536   011605 710000 11                 TRA     s:25538+3
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:541  

     3127    25531    3             DST$->BIT$S='0'B;

  25531 11 011537   200417 470500                    LDP0    @BYTES,,AUTO
        11 011540   000000 720100                    LXL0    0,,PR0
        11 011541   200424 471500                    LDP1    DST$,,AUTO
        11 011542   003140 060400                    CSL     bolr='003'O
        11 011543   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
        11 011544   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=*X0

     3128    25532    3             T$=PINCRB(DST$,BYTES);

  25532 11 011545   000000 236100                    LDQ     0,,PR0
        11 011546   100000 503506                    ABD     0,QL,PR1
        11 011547   200425 451500                    STP1    T$,,AUTO

     3129    25533    4             DO TEMP=0 TO BYTES-1;

  25533 11 011550   200421 450100                    STZ     TEMP,,AUTO
        11 011551   011566 710000 11                 TRA     s:25535+3

     3130    25534    4                  T$->BYT$8(TEMP)=SRC$->BYT$9(TEMP);

  25534 11 011552   200421 236100                    LDQ     TEMP,,AUTO
        11 011553   000011 402007                    MPY     9,DL
        11 011554   200421 235100                    LDA     TEMP,,AUTO
        11 011555   000003 735000                    ALS     3
        11 011556   200423 470500                    LDP0    SRC$,,AUTO
        11 011557   200425 471500                    LDP1    T$,,AUTO
        11 011560   003105 061506                    CSR     bolr='003'O
        11 011561   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
        11 011562   100000 000010                    BDSC    0,A,PR1                  by=0,bit=0,n=8

     3131    25535    4                END;

  25535 11 011563   200421 235100                    LDA     TEMP,,AUTO
        11 011564   000001 035007                    ADLA    1,DL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:542  
        11 011565   200421 755100                    STA     TEMP,,AUTO
        11 011566   200417 470500                    LDP0    @BYTES,,AUTO
        11 011567   200421 236100                    LDQ     TEMP,,AUTO
        11 011570   000000 116100                    CMPQ    0,,PR0
        11 011571   011552 602000 11                 TNC     s:25534

     3132    25536    3             DST$=PINCRC(DST$,BYTES);

  25536 11 011572   000000 236100                    LDQ     0,,PR0
        11 011573   000020 736000                    QLS     16
        11 011574   200424 036100                    ADLQ    DST$,,AUTO
        11 011575   200424 756100                    STQ     DST$,,AUTO

     3133    25537    3             SRC$=PINCRC(SRC$,BYTES);

  25537 11 011576   000000 236100                    LDQ     0,,PR0
        11 011577   000020 736000                    QLS     16
        11 011600   200423 036100                    ADLQ    SRC$,,AUTO
        11 011601   200423 756100                    STQ     SRC$,,AUTO

     3134    25538    3           END;

  25538 11 011602   200422 235100                    LDA     TEMP2,,AUTO
        11 011603   000001 035007                    ADLA    1,DL
        11 011604   200422 755100                    STA     TEMP2,,AUTO
        11 011605   200420 470500                    LDP0    @REPS,,AUTO
        11 011606   200422 236100                    LDQ     TEMP2,,AUTO
        11 011607   000000 116100                    CMPQ    0,,PR0
        11 011610   011537 602000 11                 TNC     s:25531

     3135    25539    2        RETURN;

  25539 11 011611   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011612   000001 702211                    TSX2  ! 1,X1

     3136    25540
     3137    25541    2   END I$8TO9;
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:543  
     3138    25542    1   FIND_ERRCTX: PROC(TERMID) ALTRET;

  25542 11 011613   200414 741300       FIND_ERRCTX  STX1  ! KBERR+10,,AUTO

     3139    25543
     3140    25544        %B$TERMINAL_ID(FPTN=TERMID,STCLASS=PARAM);
     3141    25573
     3142    25574    2        KL_NETWORK_KEY.KEY.NODE = FEX;

  25574 11 011614   200025 236100                    LDQ     FEX,,AUTO
        11 011615   000011 736000                    QLS     9
        11 011616   000000 552010 xsym               STBQ    KL_NETWORK_KEY,'10'O

     3143    25575    2        KL_NETWORK_KEY.KEY.TERMID = TERMID;

  25575 11 011617   200415 470500                    LDP0    @TERMID,,AUTO
        11 011620   000000 100500                    MLR     fill='000'O
        11 011621   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16
        11 011622   000000 600020 xsym               ADSC9   KL_NETWORK_KEY           cn=3,n=16

     3144    25576    2        KL_NETWORK_KEY.KEY.TERMID.TTYP = 0;

  25576 11 011623   000000 236003                    LDQ     0,DU
        11 011624   000000 552004 xsym               STBQ    KL_NETWORK_KEY,'04'O

     3145    25577    2        KL_NETWORK_KEY.SIZE = LENGTHC(KL_NETWORK_KEY.KEY);

  25577 11 011625   022000 236003                    LDQ     9216,DU
        11 011626   000000 552040 xsym               STBQ    KL_NETWORK_KEY,'40'O

     3146    25578    2        KL_RD_NETWORK.KEY_ = VECTOR(KL_NETWORK_KEY);

  25578 11 011627   000022 237000 12                 LDAQ    18
        11 011630   000002 757000 xsym               STAQ    KL_RD_NETWORK+2

     3147    25579    2        KL_NETWORK_BUF.DEVNM = ' ';

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:544  
  25579 11 011631   040000 100400                    MLR     fill='040'O
        11 011632   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 011633   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8

     3148    25580    2        CALL M$READ(KL_RD_NETWORK)

  25580 11 011634   000000 630400 xsym               EPPR0   KL_RD_NETWORK
        11 011635   440000 713400                    CLIMB   alt,read
        11 011636   401400 401760                    pmme    nvectors=4
        11 011637   011641 702000 11                 TSX2    s:25582
        11 011640   011643 710000 11                 TRA     s:25584

     3149    25581    3        WHENALTRETURN DO;

     3150    25582    3             ALTRETURN;

  25582 11 011641   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011642   000000 702211                    TSX2  ! 0,X1

     3151    25583    3           END;                            /* WHENALTRETURN */
     3152    25584    2        PREV$ = ADDR(CTXHD$);

  25584 11 011643   000212 236000 12                 LDQ     138
        11 011644   200022 756100                    STQ     PREV$,,AUTO

     3153    25585    2        CTX$ = CTXHD$;

  25585 11 011645   000022 236000 7                  LDQ     CTXHD$
        11 011646   200021 756100                    STQ     CTX$,,AUTO

     3154    25586    3        DO WHILE(CTX$ ~= ADDR(NIL));

  25586 11 011647   011663 710000 11                 TRA     s:25595

     3155    25587    3             IF DVCERRCTX.DEVNM = KL_NETWORK_BUF.DEVNM

  25587 11 011650   200021 470500                    LDP0    CTX$,,AUTO
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:545  
        11 011651   040000 106500                    CMPC    fill='040'O
        11 011652   000006 200010                    ADSC9   6,,PR0                   cn=1,n=8
        11 011653   000003 400010 xsym               ADSC9   KL_NETWORK_BUF+3         cn=2,n=8
        11 011654   011657 601000 11                 TNZ     s:25592

     3156    25588    4             THEN DO;

     3157    25589    4                  RETURN;

  25589 11 011655   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011656   000001 702211                    TSX2  ! 1,X1

     3158    25590    4                END;                       /* IF */
     3159    25591    4             ELSE DO;

     3160    25592    4                  PREV$ = CTX$;

  25592 11 011657   200021 236100                    LDQ     CTX$,,AUTO
        11 011660   200022 756100                    STQ     PREV$,,AUTO

     3161    25593    4                  CTX$ = DVCERRCTX.LNK$;

  25593 11 011661   000000 236100                    LDQ     0,,PR0
        11 011662   200021 756100                    STQ     CTX$,,AUTO

     3162    25594    4                END;                       /* ELSE */

     3163    25595    3           END;                            /* DO WHILE */

  25595 11 011663   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 011664   011650 601000 11                 TNZ     s:25587

     3164    25596
     3165    25597    2        ALTRETURN;

  25597 11 011665   200414 221300                    LDX1  ! KBERR+10,,AUTO
        11 011666   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:546  
     3166    25598
     3167    25599    2   END FIND_ERRCTX;
     3168    25600    1   END KLI$KBOOT;
     3169    25601        %EOD;

PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:547  
--  Include file information  --

   K_ADDRESS_M.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   KL_ERRORS_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   GH_SCHD_E.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:548  
      No diagnostics issued in procedure KLI$KBOOT.
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:549  

 **** Variables and constants ****

  ****  Section 007  Data  KLI$KBOOT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   602-0-0/w STRC(612)   r     1 ADMIN                    536-0-0/w STRC(1116)  r     1 BCHS
   465-0-0/c STRC(27)    r     1 BOOTMSG                  106-0-0/w PTR         r     1 CNFG$
    24-0-0/w UBIN        r     1 CNFG_BUF(0:49)
   466-0-0/c STRC(171)   r     1 CONFIG_KEY               535-0-0/w STRC(18)    r     1 CRASHFEP_BF
    22-0-0/w PTR         r     1 CTXHD$                   473-0-0/w STRC(99)    r     1 DEFAULT_KEY
   726-0-0/w PTR         r     1 ES$                      635-0-0/w STRC(1764)  r     1 ES$SECLOG
   462-0-0/c STRC(90)    r     1 FEPW                     452-0-0/w STRC(288)   r     1 FESTA
   352-0-0/d STRC(360)   r     1 FPT_PRECORD              234-0-0/d STRC(432)   r     1 FPT_TIME
   274-0-0/d STRC(288)   r     1 FPT_WRFEPERR             264-0-0/d STRC(288)   r     1 FPT_WRSYSLOG
   376-0-0/d STRC(360)   r     1 GOFEP                    364-0-0/d STRC(360)   r     1 HLTFEP
   575-0-0/w STRC(180)   r     1 KL_DVCERRRSP             203-0-0/w STRC(72)    r     1 KL_FEPCTL
   202-0-0/w STRC(27)    r     1 KL_FEPCTL_KEY            112-0-0/w STRC(1998)  r     1 KL_HNDLR
   107-0-0/w STRC(99)    r     1 KL_HNDLR_KEY             324-0-0/w STRC(288)   r     1 MONKEY
    23-0-0/w UBIN        r     1 MSGID                    334-0-0/d STRC(504)   r     1 RD_NETCON
     4-0-0/d STRC(504)   r     1 READ_HLPF                623-0-0/w STRC(360)   r     1 RUE
   252-0-0/d STRC(360)   r     1 STARTNETWORK             410-0-0/d STRC(360)   r     1 STOPFEP
   476-0-0/w STRC(1116)  r     1 STPMSG                   212-0-0/w STRC(162)   r     1 TERM_KEY
   205-0-0/c STRC(171)   r     1 TERM_REC                 250-0-0/w UBIN        r     1 TSTAMP
     0-0-0/w STRC(81)    r     1 TWSN_KEY                 436-0-0/d STRC(432)   r     1 WBHS
   422-0-0/d STRC(432)   r     1 WKBER                    310-0-0/d STRC(432)   r     1 WRITE_MONKEY
   220-0-0/d STRC(432)   r     1 WRT_ACCTLG               716-0-0/d STRC(288)   r     1 WR_SECLOG

  ****  Section 010 RoData KLI$KBOOT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   202-0-0/w STRC(351)   r     1 CKBR                      23-0-0/w STRC        r     1 E$DEFSTP
    20-0-0/w STRC        r     1 ELGL                     174-0-0/w STRC(198)   r     1 FEPACCTL
   142-0-0/d STRC(936)   r     1 FPT_ERRMSG                10-0-0/d STRC(216)   r     1 FPT_WAIT
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:550  
     0-0-0/c STRC(162)   r     1 KHA_C                      7-0-0/w STRC(18)    r     1 KL$NETWORK_KEY
    24-0-0/w STRC(2781)  r     1 KL_CHNRSPC                 5-0-0/c STRC(72)    r     1 NA_C
    21-0-0/w STRC        r     1 NODENA                    22-0-0/w STRC        r     1 NOFE
    16-0-0/w STRC        r     1 NOFPRG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   417-0-0/w PTR         r     1 @BYTES                   416-0-0/w PTR         r     1 @DEST
   416-0-0/w PTR         r     1 @ERR                     415-0-0/w PTR         r     1 @NETADDR
   420-0-0/w PTR         r     1 @REPS                    415-0-0/w PTR         r     1 @SOURCE
   415-0-0/w PTR         r     1 @TERMID                   35-0-0/c CHAR(8)     r     1 ACCT
    20-0-0/w UBIN        r     1 ARRAY_WDSZ                *0-0-0/w UBIN        r     1 BYTES
    21-0-0/w PTR         r     1 CTX$                     156-0-0/w STRC(108)   r     1 CWNAK
    65-0-0/w UBIN(18)    r     1 DATASIZE                  *0-0-0/c UBIN(9)     r     1 DEST(0:0)
     4-0-0/c CHAR(4)     r     1 DEVNM                      5-0-0/c CHAR(8)     r     1 DEVNM_TWSN
   424-0-0/w PTR         r     1 DST$                      50-0-0/w UBIN        r     1 ERR
    *0-0-0/b BIT         r     1 ERR                       32-0-0/w UBIN        r     1 ERRC
   304-0-0/w STRC(1224)  r     1 FEPERR                   350-0-0/w STRC(918)   r     1 FEPMES
    30-0-0/c CHAR(8)     r     1 FEPNAME                   25-0-0/w UBIN        r     1 FEX
   242-0-0/d STRC(936)   r     1 FPT@ERRMSG                66-0-0/w STRC(1800)  r     1 G@ACC_PKD
    51-0-0/c CHAR(8)     r     1 HOSTNAME                  10-0-0/w UBIN        r     1 I
    16-0-0/w PTR         r     1 IN$                       15-0-0/w PTR         r     1 IPARAM$
    11-0-0/w SBIN        r     1 J                         12-0-0/w SBIN        r     1 K
   402-0-0/c STRC(351)   r     1 KBERR                    300-0-0/w STRC(117)   r     1 KL$DUMPABORT
   161-0-0/w STRC(1152)  r     1 KL@ERRMSG_RSP              7-0-0/w UBIN        r     1 LEN
   150-0-0/w STRC(216)   r     1 LOGOFF$PARAM              33-0-0/w PTR         r     1 MESS$
    *0-0-0/h STRC        r     1 NETADDR                  346-0-0/w STRC(63)    r     1 NODECHG
    26-0-0/w UBIN        r     1 NODETYPE                  54-0-0/w BIT         r     1 NOHEADER
    53-0-0/w BIT         r     1 NOSETUP                   13-0-0/h UBIN(18)    r     1 OFFSET
   231-0-0/w STRC(288)   r     1 OSILINKCHG               226-0-0/w STRC(81)    r     1 OSILINK_BUF
   221-0-0/w STRC(171)   r     1 OSILINK_KEY               14-0-0/w PTR         r     1 OUT$
    34-0-0/w PTR         r     1 PARM$                     43-0-0/c CHAR(8)     r     1 PASS
    22-0-0/w PTR         r     1 PREV$                     45-0-0/w STRC(108)   r     1 PRO
    27-0-0/w UBIN(18)    r     1 PSIZ                       3-0-0/w PTR         r     1 RDBF$
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:551  
    *0-0-0/w UBIN        r     1 REPS                      24-0-0/w UBIN        r     1 SIZE
    *0-0-0/c UBIN(9)     r     1 SOURCE(0:0)              423-0-0/w PTR         r     1 SRC$
   425-0-0/w PTR         r     1 T$                        55-0-0/c STRC(171)   r     1 TCONFIG_KEY
    62-0-0/w STRC(99)    r     1 TDEFAULT_KEY             421-0-0/w UBIN        r     1 TEMP
   422-0-0/w UBIN        r     1 TEMP2                     *0-0-0/c STRC(144)   r     1 TERMID
    37-0-0/w STRC(117)   r     1 UNAME                    274-0-0/d STRC(144)   r     1 VLR@ERRMSG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c STRC(2700)  r     1 DVCKYN                     0-0-0/c STRC(2700)  r     1 DVCKYN_FRWD
     0-0-0/w STRC(2700)  r     1 ENABLE_KEYIN               0-0-0/w UBIN        r     1 ES_LOGSYSACC
     0-0-0/w CHAR(300)   r     1 JC_CSMBF                   0-0-0/w UBIN        r     1 JC_MARS
     0-0-0/c STRC(2700)  r     1 KBCHS                      0-0-0/w UBIN        r     1 KL_BROADSZ
     0-0-0/d STRC(360)   r     1 KL_DR_NETWORK
     0-0-0/w UBIN        r     1 KL_EXTRSP_BUF(0:1499)
     0-0-0/w PTR         r     1 KL_EXTRSP_BUF$             0-0-0/w STRC(315)   r     1 KL_FEMSG
     0-0-0/c CHAR(8)     r     1 KL_FEPW
     0-0-0/w STRC        r     1 KL_FETBL(0:0)
     0-0-0/w STRC        r     1 KL_FROG                    0-0-0/w STRC(1098)  r     1 KL_HDRMSG
     0-0-0/d STRC(189)   r     1 KL_HLPKEY                  0-0-0/w STRC(2160)  r     1 KL_HLPR
     0-0-0/w PTR         r     1 KL_HLPR$                   0-0-0/w UBIN        r     1 KL_HOPCOST
     0-0-0/w UBIN        r     1 KL_MARS                    0-0-0/w UBIN        r     1 KL_MXFE
     0-0-0/w STRC(711)   r     1 KL_NETWORK_BUF             0-0-0/w STRC(171)   r     1 KL_NETWORK_KEY
     0-0-0/w STRC(90)    r     1 KL_NETWORK_TERMKEY         0-0-0/d STRC(432)   r     1 KL_NETWORK_TIME
     0-0-0/b BIT         r     1 KL_NETWORK_VALID           0-0-0/w UBIN        r     1 KL_NMNODE
     0-0-0/w UBIN        r     1 KL_NODE                    0-0-0/c CHAR(8)     r     1 KL_NODENAME
     0-0-0/w UBIN        r     1 KL_NODES                   0-0-0/w UBIN        r     1 KL_NWF
     0-0-0/w STRC(2448)  r     1 KL_PCD                     0-0-0/w STRC(720)   r     1 KL_PROBUF
     0-0-0/d STRC(117)   r     1 KL_PROKEY                  0-0-0/d STRC(360)   r     1 KL_PR_NETWORK
     0-0-0/w STRC(1260)  r     1 KL_RDBF                    0-0-0/w PTR         r     1 KL_RDBF$
     0-0-0/d STRC(504)   r     1 KL_RDHLPR                  0-0-0/d STRC(504)   r     1 KL_RDPROR
     0-0-0/d STRC(504)   r     1 KL_RD_NETCON               0-0-0/d STRC(504)   r     1 KL_RD_NETWORK
     0-0-0/w PTR         r     1 KL_RSPPND$                 0-0-0/c CHAR(8)     r     1 KL_STATION
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:552  
     0-0-0/d STRC(432)   r     1 KL_WR_NETCON               0-0-0/d STRC(432)   r     1 KL_WR_NETWORK
     0-0-0/w STRC(2700)  r     1 KMPW                       0-0-0/w STRC(2700)  r     1 KMSG
     0-0-0/d STRC(432)   r     1 WRT_FROG                   0-0-0/d STRC(432)   r     1 WRT_NA2FROG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w UBIN(9)     r     1 B$BYTE
     0-0-0/w UBIN(18)    r     1 B$HALF                     0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/b UBIN(18)    r     1 B$PARAMI(0:0)
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c CHAR(8)     r     1 B$TERMNAME
     0-0-0/b ABIT        r     1 BIT$S                      0-0-0/b UBIN(8)     r     1 BYT$8(0:0)
     0-0-0/c UBIN(9)     r     1 BYT$9(0:0)                 0-0-0/b STRC(24)    r     1 CADDR
     0-0-0/w ASTR(486)   r     1 CHNRSP                     0-0-0/c ACHR        r     1 CHR$PSIZ
     0-0-0/b UBIN(9)     r     1 CNT                        0-0-0/w STRC(306)   r     1 DVCERRCTX
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(1764)  r     1 G$ACC
     0-0-0/w STRC(1800)  r     1 G$ACC_UNPK                 0-0-0/w STRC(252)   r     1 KL$ACCTNG
     0-0-0/w STRC(612)   r     1 KL$ADMIN                   0-0-0/w STRC(144)   r     1 KL$AFD
     0-0-0/w STRC(504)   r     1 KL$CHNRSP                  0-0-0/w STRC(828)   r     1 KL$CNFG_MSG
     0-0-0/w STRC(216)   r     1 KL$CONFIGRSP               0-0-0/w STRC(396)   r     1 KL$CONTROL
     0-0-0/w STRC(1908)  r     1 KL$CONTROL_INIT            0-0-0/w STRC(108)   r     1 KL$CWNAK
     0-0-0/w STRC(3276)  r     1 KL$DREC                    0-0-0/w ASTR(108)   r     1 KL$DUMPMSG
     0-0-0/w STRC(558)   r     1 KL$ERRMSG_RQS              0-0-0/w STRC(72)    r     1 KL$ERRMSG_RSP
     0-0-0/w STRC(126)   r     1 KL$FEPST                   0-0-0/w STRC(243)   r     1 KL$KEYMES
     0-0-0/w STRC(171)   r     1 KL$LINE_KEY                0-0-0/w STRC(216)   r     1 KL$NETWORK
     0-0-0/w STRC(63)    r     1 KL$NODECHG                 0-0-0/w STRC(117)   r     1 KL$NODEINFO
     0-0-0/w STRC(288)   r     1 KL$OSILINKCHG              0-0-0/w STRC(360)   r     1 KL$REQSTATS
     0-0-0/w ASTR(243)   r     1 KL$RQSCHN                  0-0-0/w STRC(252)   r     1 KL$RSPPND
     0-0-0/w STRC(360)   r     1 KL$RUE                     0-0-0/w STRC(1620)  r     1 KL$STRTU
     0-0-0/w ASTR(360)   r     1 KL$SYSLOG                  0-0-0/w STRC(45)    r     1 KL$TIME
     0-0-0/w STRC(540)   r     1 KL$UPDOSI                  0-0-0/w STRC(1287)  r     1 LINCNFG
     0-0-0/w UBIN        r     1 LOGSYSACCT                 0-0-0N  NULL        r     1 M$ACCTLG
     0-0-0N  NULL        r     1 M$CSCG                     0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$HLP                      0-0-0N  NULL        r     1 M$HLPF
     0-0-0N  NULL        r     1 M$NETCON                   0-0-0N  NULL        r     1 M$NETWORK
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:553  
     0-0-0N  NULL        r     1 M$PROF                     0-0-0/c ACHR        r     1 PARM
     0-0-0/c STRC(144)   r     1 PSEUDO                     0-0-0/c ASTR(9)     r     1 TEXT$C
     0-0-0/w STRC(576)   r     1 TWSN_REC                   0-0-0/c UBIN(18)    r     1 UBIN_HALF_BASE
     0-0-0/c ASTR(9)     r     1 VTXTC


   Procedure KLI$KBOOT requires 5047 words for executable code.
   Procedure KLI$KBOOT requires 288 words of local(AUTO) storage.
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:554  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:555  
          MINI XREF LISTING

ACCT
     15857**DCL     24262<>CALL    24273>>ASSIGN  24292<>CALL    24297<>CALL    24299>>ASSIGN  24318>>ASSIGN
     24319>>ASSIGN  24320>>ASSIGN  24330>>ASSIGN  24345>>ASSIGN  24349>>ASSIGN  24822<>CALL    24827>>ASSIGN
     24842>>ASSIGN  24843>>ASSIGN  24844>>ASSIGN  24855>>ASSIGN  24869>>ASSIGN  24873>>ASSIGN
ADMIN
     21038**DCL     23941<>CALL    23941--CALL
ADMIN.FNC
     21105**DCL     23921<<ASSIGN  23957<<ASSIGN  23961<<ASSIGN  23966<<ASSIGN  23993<<ASSIGN
ADMIN.ORIGIN
     21048**DCL     23933<<ASSIGN
ADMIN.SRCE_NODE
     21045**DCL     23934<<ASSIGN
ADMIN.TERMID_HI
     21152**DCL     23926<<ASSIGN
ADMIN.TERMID_HI.LEV
     21154**DCL     23929<<ASSIGN
ADMIN.TERMID_HI.TERM
     21154**DCL     21163--REDEF
ADMIN.TERMID_HI.TERM.CHANNEL.BYT
     21156**DCL     23930<<ASSIGN  23931<<ASSIGN
ADMIN.TERMID_LO
     21123**DCL     23926>>ASSIGN
ADMIN.TERMID_LO.LEV
     21125**DCL     23923<<ASSIGN
ADMIN.TERMID_LO.TERM
     21125**DCL     21134--REDEF
ADMIN.TERMID_LO.TERM.CHANNEL.BYT
     21127**DCL     23924<<ASSIGN  23925<<ASSIGN
ARRAY_WDSZ
     15832**DCL     24575<<ASSIGN  24602>>ASSIGN
AZA$FEPACCTNG
     23576**DCL-ENT 24410--CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:556  
B$ALT.CODE
     15549**DCL     15549--REDEF   15550--REDEF   15550--REDEF
B$ALT.ERR
     15550**DCL     24170<>CALL    24179<>CALL
B$ALT.ERR.CODE
     15551**DCL     25359>>ASSIGN
B$ALT.ERR.ERR#
     15551**DCL     15551--REDEF
B$ALT.EVID
     15550**DCL     15550--REDEF   15550--REDEF
B$BYTE
     15834**DCL     24577<>CALL    24583<>CALL
B$HALF
     15835**DCL     24589<>CALL
B$JIT.CPFLAGS1.SLEAZE
      2705**DCL      2705--REDEF
B$JIT.ERR.MID
      2612**DCL      2612--REDEF
B$JIT.JRESPEAK
      2773**DCL      2774--REDEF
B$JIT.LANG
      2747**DCL     24483>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      2882**DCL      2882--REDEF    2883--REDEF
B$JIT.PNR
      2786**DCL      2786--REDEF
B$JIT.TSLINE
      2880**DCL      2881--REDEF
B$JIT$
     16336**DCL      2606--IMP-PTR 24483>>IF
B$PARAMI
     15833**DCL     24597<>CALL    24597<>CALL
B$TCB.ALT$
     15545**DCL     24170>>CALL    24179>>CALL    25359>>ASSIGN
B$TCB$
     16335**DCL     24170>>CALL    24179>>CALL    25359>>ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:557  
B$TERMNAME
     23570**DCL     23982<<ASSIGN
BCHS
     19123**DCL     23765--ASSIGN  23769<>CALL    23779--ASSIGN  23780<>CALL    23782<>CALL
BCHS.CODE_
     19124**DCL     23748<<ASSIGN  23753<<ASSIGN  23761<<ASSIGN  23776<<ASSIGN
BCHS.MSG_
     19126**DCL     23764<<ASSIGN  23765--ASSIGN  23778<<ASSIGN  23779--ASSIGN
BCHS.TYP_
     19125**DCL     23763<<ASSIGN  23777<<ASSIGN
BCST
     23753**LABEL   23749--GOTO
BDFEX
     25357**LABEL   23691--GOTO    25351--GOTO    25354--GOTO
BDSET
     25388**PROC    23671--CALL    23678--CALL    23686--CALL
BHSON
     23768**LABEL   23769--CALLALT
BHSON1
     23999**LABEL   23780--CALLALT 23782--CALLALT
BIT$S IN PROCEDURE I$8TO9
     25526**DCL     25531<<ASSIGN
BOOTMSG
     18065**DCL     25404<>CALL    25404--CALL
BOOTMSG.CODE_
     18066**DCL     25401<<ASSIGN  25403<<ASSIGN
BYT$8 IN PROCEDURE I$8TO9
     25524**DCL     25534<<ASSIGN
BYT$9 IN PROCEDURE I$8TO9
     25525**DCL     25534>>ASSIGN
BYTES IN PROCEDURE I$8TO9
     25516**DCL     25512--PROC    25526--IMP-SIZ 25531>>ASSIGN  25532>>ASSIGN  25533>>DOINDEX 25536>>ASSIGN
     25537>>ASSIGN
CADDR.BOT
     23569**DCL     24088<<ASSIGN
CADDR.MID
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:558  
     23568**DCL     24087<<ASSIGN
CADDR.TOP
     23567**DCL     24086<<ASSIGN
CHNNAK
     24277**LABEL   24262--CALLALT 24291--CALLALT 24292--CALLALT 24298--GOTO
CHNRSP
     18668**DCL     24199<<ASSIGN  24241<<ASSIGN  24251<>CALL    24251--CALL    25283<<ASSIGN  25305<>CALL
     25305--CALL    25327<<ASSIGN  25333<>CALL    25333--CALL    25340<<ASSIGN  25343<>CALL    25343--CALL
CHNRSP.CONFIG
     18679**DCL     24242<<ASSIGN  25328<<ASSIGN
CHNRSP.DFLTHND
     18683**DCL     24201<<ASSIGN  25284<<ASSIGN
CHNRSP.HANDLER
     18697**DCL     24200<<ASSIGN  25286<<ASSIGN
CHNRSP.HNDCMN
     18797**DCL     24210<<ASSIGN  24250<<ASSIGN  25291<<ASSIGN  25332<<ASSIGN
CHNRSP.MESSAGE.MESSAGE
     18869**DCL     24218--ASSIGN  25300--ASSIGN
CHNRSP.MESSAGE.MSGSIZE
     18861**DCL     24217<>CALL    25292<>CALL    25299<>CALL
CHNRSP.NA
     18748**DCL     24209<<ASSIGN  24248<<ASSIGN  25287<<ASSIGN  25330<<ASSIGN
CHNRSP.NA.AUTLGN
     18755**DCL     25289<<ASSIGN
CHNRSP.NA.CNFG_EXISTS
     18764**DCL     24249<<ASSIGN  25288<<ASSIGN  25331<<ASSIGN
CHNRSP.NA.PROFILE
     18763**DCL     25290<<ASSIGN
CHNRSP.NA.SNDSLT
     18753**DCL     24243<<ASSIGN
CHNRSP.NAK
     18687**DCL     24202<<ASSIGN  24208<<ASSIGN
CHNRSP.SCNDCNFG
     18691**DCL     24225<<ASSIGN
CHNRSP.TERMINAL_ID
     18717**DCL     24244<<ASSIGN  25285<<ASSIGN  25329<<ASSIGN  25342<<ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:559  
CHNRSP.TERMINAL_ID.TERM
     18719**DCL     18728--REDEF
CHR$PSIZ
     15845**DCL     24218<<ASSIGN  24218>>ASSIGN  25300<<ASSIGN  25300>>ASSIGN
CKBR
     23490**DCL     23601>>ASSIGN  23944>>ASSIGN  24017>>ASSIGN  24899>>ASSIGN  24945>>ASSIGN  25472>>ASSIGN
CKBR.FLAGS
     23497**DCL     23498--REDEF
CKBR.MSGID
     23493**DCL     23494--REDEF
CNFG$
     15853**DCL     18021--IMP-PTR 18279--IMP-PTR 24211>>IF      24213>>ASSIGN  24248>>ASSIGN  24250>>ASSIGN
     24266>>ASSIGN  24267>>ASSIGN  24268>>ASSIGN  24269>>ASSIGN  24270>>ASSIGN  24271>>ASSIGN  24272>>ASSIGN
     24292>>CALL    24300>>IF      24817>>ASSIGN  24818>>ASSIGN  24822>>CALL    25212>>ASSIGN  25213>>ASSIGN
     25223>>ASSIGN  25229>>DOCASE  25232>>IF      25287>>ASSIGN  25291>>ASSIGN  25293>>IF      25295>>ASSIGN
     25330>>ASSIGN  25332>>ASSIGN
CNFG_BUF
     15852**DCL     15853--DCLINIT 17086--DCLINIT 17087--DCLINIT 17798--DCLINIT 17799--DCLINIT 24206--ASSIGN
     24245--ASSIGN  24289--ASSIGN  24812--ASSIGN  25219--ASSIGN  25220--ASSIGN
CNT
     15850**DCL     23908<<ASSIGN  24094<<ASSIGN  24095--ASSIGN  24098<<ASSIGN  24099--ASSIGN  24157>>ASSIGN
CONFIG_KEY
     18128**DCL     17829--DCLINIT 17830--DCLINIT 24246--ASSIGN  24290--ASSIGN  24302>>ASSIGN  24813--ASSIGN
     25314--ASSIGN
CONFIG_KEY.NODE
     18131**DCL     24226<<ASSIGN  24236<<ASSIGN  24287<<ASSIGN  24808<<ASSIGN  25311<<ASSIGN
CONFIG_KEY.TERMID
     18148**DCL     24232<<ASSIGN  24288<<ASSIGN  24809<<ASSIGN
CONFIG_KEY.TERMID.LEV
     18150**DCL     25313<<ASSIGN
CONFIG_KEY.TERMID.TERM
     18150**DCL     18159--REDEF
CONFIG_KEY.TERMID.TERM.CHANNEL
     18152**DCL     24235<<ASSIGN
CONFIG_KEY.TERMID.TERM.TERM_NAME
     18159**DCL     24233>>IF      24811<<ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:560  
CONFIG_KEY.TERMID.TTYP
     18150**DCL     24238<<ASSIGN  24810<<ASSIGN  25312<<ASSIGN
CONT_ERR
     24623**LABEL   24619--GOTO
CRASHFEP_BF
     19115**DCL     24190--ASSIGN  24192<>CALL
CTX$
     15837**DCL     15784--IMP-PTR 22608--IMP-PTR 23840<<ASSIGN  23841>>DOWHILE 23842>>ASSIGN  23847>>IF
     23852>>IF      23856<<ASSIGN  23856>>ASSIGN  23878<<ASSIGN  23879>>DOWHILE 23880>>IF      23884>>ASSIGN
     23890>>ASSIGN  23891>>ASSIGN  23898<<ASSIGN  23898>>ASSIGN  24043>>ASSIGN  24048>>ASSIGN  24049<>CALL
     24056<>CALL    24059>>ASSIGN  24062>>ASSIGN  24064>>ASSIGN  24065>>ASSIGN  24066>>ASSIGN  24067>>ASSIGN
     24068>>ASSIGN  24069>>ASSIGN  24074>>ASSIGN  24075>>ASSIGN  24076<>CALL    24366<<ASSIGN  24367>>ASSIGN
     25153<<ASSIGN  25154>>ASSIGN  25156>>DOWHILE 25157>>IF      25159>>ASSIGN  25160>>ASSIGN  25168>>IF
     25170>>ASSIGN  25172>>ASSIGN  25173>>ASSIGN  25174<<ASSIGN  25174>>ASSIGN  25178>>ASSIGN  25179<<ASSIGN
     25179>>ASSIGN  25184<<ASSIGN  25186>>DOWHILE 25189>>ASSIGN  25192>>IF      25194<<ASSIGN  25194>>ASSIGN
     25198<<ASSIGN  25198>>ASSIGN  25585<<ASSIGN  25586>>DOWHILE 25587>>IF      25592>>ASSIGN  25593<<ASSIGN
     25593>>ASSIGN
CTXHD$
     15836**DCL     23820>>IF      23830>>IF      23840>>ASSIGN  23878>>ASSIGN  24068>>ASSIGN  24069<<ASSIGN
     25153>>ASSIGN  25168>>IF      25170<<ASSIGN  25584--ASSIGN  25585>>ASSIGN
CWNAK
     19425**DCL     25493<<ASSIGN  25500<>CALL    25500--CALL    25502<>CALL    25502--CALL
CWNAK.FCN
     19426**DCL     25494<<ASSIGN
CWNAK.NETADR
     19429**DCL     25495<<ASSIGN
CWNAK.NETADR.NODE
     19430**DCL     25497>>ASSIGN
CWNAK.NETERR
     19455**DCL     25496<>CALL
DATASIZE
     16337**DCL     22665--IMP-SIZ 25050<>CALL    25053>>ASSIGN
DEFAULT_KEY
     18175**DCL     24205--ASSIGN  25270--ASSIGN
DEFAULT_KEY.HNDLR
     18179**DCL     24204<<ASSIGN  25269<<ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:561  
DEFAULT_KEY.NODE
     18178**DCL     24203<<ASSIGN  25268<<ASSIGN
DEST IN PROCEDURE I$8TO9
     25515**DCL     25512--PROC    25528--ASSIGN
DEVNM
     15782**DCL     23870<<CALLBLT 23871>>IF      23877>>CALLBLT
DEVNM_TWSN
     15783**DCL     23877<<CALLBLT 23880>>IF      23881>>ASSIGN  23901>>ASSIGN
DFLT_CHN
     24251**LABEL   24207--CALLALT 24221--GOTO    24247--CALLALT
DOKEYX
     23656**LABEL   23665--GOTO
DOSGSCAN
     24822**LABEL   24819--GOTO
DO_DISP_NODES
     23605**LABEL   23640--GOTO    23644--GOTO
DST$ IN PROCEDURE I$8TO9
     25522**DCL     25528<<ASSIGN  25531>>ASSIGN  25532>>ASSIGN  25536<<ASSIGN  25536>>ASSIGN
DVCERR
     23917**LABEL   23788--CALLALT 23872--GOTO    23894--GOTO
DVCERRCTX
     15784**DCL     24056--CALL
DVCERRCTX.DEVNM
     15818**DCL     23842>>ASSIGN  23852>>IF      23880>>IF      24067<<ASSIGN  25159>>ASSIGN  25587>>IF
DVCERRCTX.FEX
     15817**DCL     23891>>ASSIGN  24065<<ASSIGN  25157>>IF
DVCERRCTX.KEYIN_REQ
     15819**DCL     23847>>IF      24066<<ASSIGN
DVCERRCTX.LNK$
     15785**DCL     23856>>ASSIGN  23898>>ASSIGN  24048<<ASSIGN  24048>>ASSIGN  24068<<ASSIGN  24075<<ASSIGN
     24075>>ASSIGN  25170>>ASSIGN  25172<<ASSIGN  25172>>ASSIGN  25174>>ASSIGN  25179>>ASSIGN  25593>>ASSIGN
DVCERRCTX.MSG#
     15786**DCL     24064<<ASSIGN
DVCERRCTX.MSGID
     15787**DCL     23884>>ASSIGN  24043>>ASSIGN  24062<<ASSIGN  24074>>ASSIGN  25160>>ASSIGN
DVCERRCTX.TERMID
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:562  
     15804**DCL     23890>>ASSIGN  24059<<ASSIGN
DVCERRCTX.TERMID.TERM
     15806**DCL     15815--REDEF
DVCKYN.CADDR
     15651**DCL     23792>>ASSIGN  23978>>ASSIGN
DVCKYN.DEVNM
     15652**DCL     23794>>IF      23818>>IF      23859>>IF      23871>>IF
DVCKYN.KIN#
     15650**DCL     23875>>DOCASE  23889>>ASSIGN  24064>>ASSIGN
DVCKYN.TWSN
     15653**DCL     23852>>IF      23866>>ASSIGN  23877>>CALLBLT
DVCKYN_FRWD.RTN#
     15656**DCL     23786<<ASSIGN
E$DEFSTP
     18082**DCL     23711<>CALL
ELGL
     17434**DCL     24129<>CALL
ENABLE_KEYIN.FEP#
     15661**DCL     23935>>ASSIGN  23991<<ASSIGN
ENABLE_KEYIN.LINE_HI#
     15664**DCL     23927>>IF      23930>>ASSIGN  23931>>ASSIGN  23992<<ASSIGN
ENABLE_KEYIN.LINE_LOW#
     15663**DCL     23660>>ASSIGN  23660>>ASSIGN  23924>>ASSIGN  23925>>ASSIGN  23989<<ASSIGN  23992>>ASSIGN
ENABLE_KEYIN.NAME
     15662**DCL     23972>>ASSIGN  23982>>ASSIGN
ERR
     15865**DCL     24262<>CALL    24292<>CALL    24822<>CALL    25217<<ASSIGN  25225>>DOWHILE 25248<<ASSIGN
ERR IN PROCEDURE SENDCWNAK
     25491**DCL     25485--PROC    25496<>CALL
ERRC
     15847**DCL     23669<<ASSIGN  23676<<ASSIGN  23684<<ASSIGN  25357>>ASSIGN  25359<<ASSIGN  25360>>IF
     25365>>IF      25370>>IF      25371>>IF
ERROR
     25357**LABEL   23696--CALLALT
ERRORK
     25352**LABEL   23671--CALLALT 23678--CALLALT 23686--CALLALT
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:563  
ES$
     23470**DCL     24431<>CALL    24432>>IF
ES$SECLOG
     23187**DCL     23465--DCLINIT 23467--DCLINIT
ES$SECLOG.ACCN
     23220**DCL     24438<<ASSIGN
ES$SECLOG.FACCN
     23228**DCL     23232--REDEF
ES$SECLOG.FILE
     23388**DCL     23419--REDEF
ES$SECLOG.GRANTED
     23194**DCL     24436<<ASSIGN
ES$SECLOG.LOGON
     23277**DCL     23289--REDEF
ES$SECLOG.LOGON.C
     23286**DCL     24444<<ASSIGN  24448--IF      24449--ASSIGN  24450<<ASSIGN
ES$SECLOG.LOGON.L
     23283**DCL     24443<<ASSIGN  24446<<ASSIGN  24448>>IF      24449<<ASSIGN
ES$SECLOG.MODE
     23198**DCL     24437<<ASSIGN
ES$SECLOG.PASSWORD
     23232**DCL     24440<<ASSIGN
ES$SECLOG.PPRIV
     23263**DCL     24442<<ASSIGN
ES$SECLOG.PRIV
     23256**DCL     24441<<ASSIGN
ES$SECLOG.REASON
     23189**DCL     24435<<ASSIGN
ES$SECLOG.TSLINE.FEX
     23329**DCL     24451<<ASSIGN
ES$SECLOG.TSLINE.LEV
     23335**DCL     24452<<ASSIGN
ES$SECLOG.TSLINE.PORT
     23332**DCL     24453<>CALL
ES$SECLOG.TSLINE.SUBDEVICE
     23338**DCL     24455<>CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:564  
ES$SECLOG.TSLINE.SUBSUBDEVICE
     23341**DCL     24457<>CALL
ES$SECLOG.UNAME
     23224**DCL     24439<<ASSIGN
ES_LOGSYSACC
     23469**DCL     23470--DCLINIT
F$DCB.ACTPOS
      3534**DCL      3534--REDEF
F$DCB.ARS
      3509**DCL      3509--REDEF   24216>>ASSIGN  25298>>ASSIGN
F$DCB.ATTR
      3527**DCL      3528--REDEF
F$DCB.BORROW
      3542**DCL      3542--REDEF    3542--REDEF    3542--REDEF
F$DCB.DCBNAME.L
      3556**DCL      3556--IMP-SIZ
F$DCB.EOMCHAR
      3513**DCL      3513--REDEF
F$DCB.FLDID
      3537**DCL      3537--REDEF
F$DCB.FORM$
      3531**DCL      3531--REDEF
F$DCB.FSECT
      3547**DCL      3547--REDEF
F$DCB.FSN
      3524**DCL      3524--REDEF    3524--REDEF    3525--REDEF
F$DCB.HEADER$
      3530**DCL      3530--REDEF
F$DCB.IXTNSIZE
      3528**DCL      3528--REDEF
F$DCB.LASTSTA$
      3518**DCL      3518--REDEF
F$DCB.LVL
      3543**DCL      3543--REDEF
F$DCB.NAME.C
      3518**DCL      3518--REDEF
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:565  
F$DCB.NOEOF
      3539**DCL      3539--REDEF
F$DCB.NRECS
      3529**DCL      3529--REDEF
F$DCB.NRECX
      3548**DCL      3548--REDEF
F$DCB.OHDR
      3540**DCL      3540--REDEF
F$DCB.ORG
      3523**DCL      3523--REDEF
F$DCB.PRECNO
      3546**DCL      3546--REDEF
F$DCB.RCSZ
      3551**DCL      3551--REDEF
F$DCB.RES
      3519**DCL      3519--REDEF
F$DCB.SETX
      3531**DCL      3531--REDEF
F$DCB.TAB$
      3530**DCL      3531--REDEF
F$DCB.TDA
      3545**DCL      3545--REDEF
F$DCB.WSN
      3520**DCL      3520--REDEF
FEPACCTL
     23475**DCL     24414--ASSIGN
FEPACCTL.FLAGS
     23482**DCL     23483--REDEF
FEPACCTL.MESS#
     23488**DCL     23487--DCLINIT
FEPACCTL.MSGID
     23478**DCL     23479--REDEF
FEPERR
     22709**DCL     24358<<ASSIGN  24426--ASSIGN  24428--ASSIGN
FEPERR.STATDATA.ERRCODE
     22724**DCL     24425<>CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:566  
FEPERR.STATDATA.NODE
     22709**DCL     24419<<ASSIGN
FEPERR.STATDATA.TERMID
     22772**DCL     24421<<ASSIGN
FEPERR.STATDATA.TERMID.TERM
     22774**DCL     22783--REDEF
FEPERR.STATDATA.UTS
     22755**DCL     24422<<ASSIGN
FEPERR.STATDATA.VALUES
     22755**DCL     24420<<ASSIGN
FEPERR.X.DYMDATA
     22785**DCL     24424<<ASSIGN  24426--ASSIGN  24426--ASSIGN
FEPK_ERR
     23940**LABEL   23661--CALLALT 23938--CALLALT 23940--CALLALT
FEPMES
     23517**DCL     23791--ASSIGN  23886--ASSIGN  23909--ASSIGN  23983--ASSIGN  24044--ASSIGN  24115--ASSIGN
     25164--ASSIGN
FEPMES.CADDR
     23518**DCL     23792<<ASSIGN  23883<<ASSIGN  23903<<ASSIGN  23978<<ASSIGN  24086--ASSIGN  24087--ASSIGN
     24088--ASSIGN  25163<<ASSIGN
FEPMES.DEVNM
     23528**DCL     23842<<ASSIGN  23881<<ASSIGN  23901<<ASSIGN  24084<<ASSIGN  25159<<ASSIGN
FEPMES.FCN
     23523**DCL     23834<<ASSIGN  23844<<ASSIGN  23882<<ASSIGN  23906<<ASSIGN  23980<<ASSIGN  24042<<ASSIGN
     24089<<ASSIGN  25162<<ASSIGN
FEPMES.FCNT
     23530**DCL     23846<<ASSIGN  23905<<ASSIGN  23979<<ASSIGN  24090<<ASSIGN
FEPMES.FLAGS
     23524**DCL     23525--REDEF
FEPMES.FNCNT
     23531**DCL     23849<<ASSIGN  23851<<ASSIGN  23981<<ASSIGN  24091<<ASSIGN
FEPMES.MSG
     23532**DCL     23907--ASSIGN  23982--ASSIGN  24092--ASSIGN
FEPMES.MSG#
     23519**DCL     23832<<ASSIGN  23843<<ASSIGN  23902<<ASSIGN  23976<<ASSIGN  24083<>CALL    24083--CALL
FEPMES.MSGID
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:567  
     23520**DCL     23521--REDEF   23884<<ASSIGN  24043<<ASSIGN  24063<<ASSIGN  24074<<ASSIGN  25160<<ASSIGN
FEPMES.NPARAMS
     23522**DCL     23833<<ASSIGN  23845<<ASSIGN  23885<<ASSIGN  23904<<ASSIGN  23977<<ASSIGN  24041<<ASSIGN
     24085<<ASSIGN  25161<<ASSIGN
FEPMES.WSN
     23527**DCL     23528--REDEF
FEPNAME
     15846**DCL     24526<<CALLBLT
FEPW
     18059**DCL     23651<>CALL    23651--CALL
FEPW.MSG_
     18062**DCL     23649<<ASSIGN
FEP_KEYIN
     23921**LABEL   23958--GOTO    23962--GOTO    23967--GOTO    23994--GOTO
FESTA
     17989**DCL     17965--DCLINIT
FESTA.MSGIDXT
     17999**DCL     18002--REDEF
FEX
     15842**DCL     23611<<DOINDEX 23611>>DOINDEX 23612<>CALL    23614>>IF      23619>>IF      23624>>ASSIGN
     23650<<DOINDEX 23651<>CALL    23661<>CALL    23669>>ASSIGN  23670>>ASSIGN  23676>>ASSIGN  23677>>ASSIGN
     23684>>ASSIGN  23685>>ASSIGN  23691>>IF      23692>>IF      23699<<DOINDEX 23700>>IF      23700>>IF
     23714>>IF      23718>>IF      23723<<DOINDEX 23724>>IF      23724>>IF      23724>>IF      23733>>IF
     23740<<DOINDEX 23741>>IF      23741>>IF      23766<<DOINDEX 23767>>IF      23767>>IF      23769<>CALL
     23777>>ASSIGN  23780<>CALL    23891<<ASSIGN  23893<>CALL    23908>>ASSIGN  23935<<ASSIGN  23936>>IF
     23938<>CALL    23940<>CALL    23941<>CALL    23946>>ASSIGN  23999<<ASSIGN  24000<>CALL    24011<<ASSIGN
     24015<<CALLBLT 24022>>IF      24065>>ASSIGN  24098>>ASSIGN  24101<>CALL    24164<<ASSIGN  24166<<ASSIGN
     24168<>CALL    24175<<ASSIGN  24176<<ASSIGN  24178<>CALL    24185<<ASSIGN  24186>>IF      24188<>CALL
     24191<<ASSIGN  24192<>CALL    24203>>ASSIGN  24226>>ASSIGN  24251<>CALL    24279<>CALL    24287>>ASSIGN
     24309<>CALL    24313>>ASSIGN  24324>>ASSIGN  24338>>ASSIGN  24343<>CALL    24419>>ASSIGN  24519<>CALL
     24526>>CALLBLT 24528>>ASSIGN  24542>>ASSIGN  24613<>CALL    24617<>CALL    24622<>CALL    24639<>CALL
     24647<>CALL    24676<>CALL    24683<>CALL    24706<>CALL    24713<>CALL    24738>>ASSIGN  24748>>ASSIGN
     24769>>ASSIGN  24778>>ASSIGN  24808>>ASSIGN  24837>>ASSIGN  24848>>ASSIGN  24862>>ASSIGN  24867<>CALL
     24900>>ASSIGN  24920<>CALL    24926<>CALL    24946<>CALL    24947>>ASSIGN  24965<<ASSIGN  24966<>CALL
     24973<>CALL    24999<>CALL    25005<>CALL    25040<<DOINDEX 25041>>IF      25041>>IF      25046<>CALL
     25082>>ASSIGN  25132<<CALLBLT 25134>>IF      25145<>CALL    25152<<CALLBLT 25157>>IF      25192>>IF
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:568  
     25203>>ASSIGN  25232>>IF      25240>>IF      25261<<CALLBLT 25264>>ASSIGN  25268>>ASSIGN  25281>>DOWHILE
     25305<>CALL    25311>>ASSIGN  25326>>DOWHILE 25333<>CALL    25343<>CALL    25351>>IF      25352>>IF
     25357>>ASSIGN  25382>>ASSIGN  25390>>IF      25392>>ASSIGN  25398>>ASSIGN  25404<>CALL    25414>>ASSIGN
     25422>>ASSIGN  25424<>CALL    25426>>ASSIGN  25432>>ASSIGN  25433>>ASSIGN  25435>>ASSIGN  25443<<ASSIGN
     25444>>IF      25447>>IF      25449<>CALL    25454<>CALL    25458>>ASSIGN  25459>>IF      25459>>IF
     25459>>IF      25462>>ASSIGN  25469>>IF      25474>>ASSIGN  25497<<ASSIGN  25498>>IF      25502<>CALL
     25574>>ASSIGN
FIND_ERRCTX
     25542**PROC    24039--CALL    24072--CALL
FPT@ERRMSG
     22415**DCL     24465<<ASSIGN  24498<>CALL
FPT@ERRMSG.ALTCODE_
     22419**DCL     24479<<ASSIGN
FPT@ERRMSG.BUF_
     22415**DCL     24468<<ASSIGN
FPT@ERRMSG.CODE_
     22415**DCL     24467<<ASSIGN
FPT@ERRMSG.FILEACCT_
     22416**DCL     24493<<ASSIGN
FPT@ERRMSG.FILENAME_
     22416**DCL     24491<<ASSIGN
FPT@ERRMSG.FILEPASS_
     22417**DCL     24495<<ASSIGN
FPT@ERRMSG.RESULTS_
     22418**DCL     24469<<ASSIGN
FPT@ERRMSG.V
     22419**DCL     24466--ASSIGN
FPT@ERRMSG.V.INCLCODE#
     22424**DCL     24471<<ASSIGN
FPT@ERRMSG.V.L6_ALTCODE#
     22427**DCL     24480<<ASSIGN
FPT@ERRMSG.V.L6_CODE#
     22427**DCL     24470<<ASSIGN
FPT@ERRMSG.V.LANG#
     22428**DCL     24486<<ASSIGN
FPT@ERRMSG.V.LEAVETOKEN#
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:569  
     22422**DCL     24475<<ASSIGN
FPT@ERRMSG.V.MY_LANG#
     22428**DCL     24485<<ASSIGN
FPT@ERRMSG.V.SUBFILE#
     22422**DCL     24473<<ASSIGN
FPT@ERRMSG.V.SUBLANG#
     22426**DCL     24474<<ASSIGN
FPT@ERRMSG.V.SUBMESS#
     22425**DCL     24472<<ASSIGN
FPT@ERRMSG.V_
     22415**DCL     24466<<ASSIGN
FPT_ERRMSG
     22464**DCL     24465>>ASSIGN
FPT_ERRMSG.V
     22468**DCL     22464--DCLINIT
FPT_PRECORD
     17829**DCL     25271<>CALL    25316<>CALL
FPT_PRECORD.KEY_
     17829**DCL     25270<<ASSIGN  25314<<ASSIGN
FPT_PRECORD.V
     17831**DCL     17829--DCLINIT
FPT_TIME
     16383**DCL     24383<>CALL    24386<>CALL    24393<>CALL    24400<>CALL
FPT_TIME.TSTAMP_
     16386**DCL     24382<<ASSIGN  24385<<ASSIGN  24392<<ASSIGN  24399<<ASSIGN
FPT_TIME.V
     16387**DCL     16383--DCLINIT
FPT_WAIT
     17217**DCL     24354<>CALL    24877<>CALL    25425<>CALL
FPT_WAIT.V
     17218**DCL     17217--DCLINIT
FPT_WRFEPERR
     17202**DCL     24429<>CALL
FPT_WRFEPERR.ENTRY_
     17202**DCL     24428<<ASSIGN
FPT_WRFEPERR.V
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:570  
     17202**DCL     17202--DCLINIT
FPT_WRFEPERR.V.SIZE#
     17204**DCL     24426<<ASSIGN
FPT_WRSYSLOG
     17186**DCL     24352<>CALL    24876<>CALL
FPT_WRSYSLOG.V
     17186**DCL     17186--DCLINIT
FPT_WRSYSLOG.V.TYPE#
     17187**DCL     24350<<ASSIGN  24737<<ASSIGN  24766<<ASSIGN  24779>>IF      24803>>IF      24874<<ASSIGN
     24880<<ASSIGN  24888<<ASSIGN
FRWD
     23785**LABEL   23804--CALLALT 23814--GOTO    23825--CALLALT 23826--CALLALT 23860--GOTO    23868--CALLALT
     23873--GOTO    23916--GOTO
G$ACC
     17026**DCL     24367>>ASSIGN
G$ACC.JSUNIT
     17044**DCL     17045--REDEF
G$ACC.MCLS
     17043**DCL     17043--REDEF
G$ACC.USER_EXTIME
     17036**DCL     17037--REDEF
G$ACC.USER_MEMTIME
     17039**DCL     17039--REDEF
G$ACC.USER_SVTIME
     17038**DCL     17038--REDEF
G$ACC_UNPK.CODE
     16442**DCL     24366--ASSIGN
G$ACC_UNPK.ERR
     16460**DCL     24404<>CALL
G$ACC_UNPK.JSUNIT
     16455**DCL     16456--REDEF
G$ACC_UNPK.MCLS
     16454**DCL     16454--REDEF
G$ACC_UNPK.PEAK_MEM
     16453**DCL     24374<>CALL
G$ACC_UNPK.READS_HOST
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:571  
     16478**DCL     24376<>CALL
G$ACC_UNPK.START
     16446**DCL     24372<>CALL
G$ACC_UNPK.STEP
     16481**DCL     24378<>CALL
G$ACC_UNPK.SYSID
     16444**DCL     24371<>CALL
G$ACC_UNPK.USER_EXTIME
     16447**DCL     16448--REDEF
G$ACC_UNPK.USER_MEMTIME
     16450**DCL     16450--REDEF
G$ACC_UNPK.USER_SVTIME
     16449**DCL     16449--REDEF
G@ACC_PKD
     16778**DCL     24367<<ASSIGN  24409--ASSIGN  24412--ASSIGN
G@ACC_PKD.CHG
     16956**DCL     24411<<ASSIGN
G@ACC_PKD.ERR
     16801**DCL     24404<>CALL
G@ACC_PKD.JSUNIT
     16796**DCL     16797--REDEF
G@ACC_PKD.MCLS
     16795**DCL     16795--REDEF
G@ACC_PKD.PEAK_MEM
     16794**DCL     24374<>CALL
G@ACC_PKD.PROC_EXTIME
     16792**DCL     24395<<ASSIGN  24395>>ASSIGN
G@ACC_PKD.PROC_MEMTIME
     16793**DCL     24399--ASSIGN
G@ACC_PKD.PROC_SVTIME
     16792**DCL     24397<<ASSIGN  24397>>ASSIGN
G@ACC_PKD.READS_HOST
     16819**DCL     24376<>CALL
G@ACC_PKD.START
     16787**DCL     24372<>CALL    24382--ASSIGN
G@ACC_PKD.STEP
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:572  
     16822**DCL     24378<>CALL
G@ACC_PKD.STOP
     16788**DCL     24385--ASSIGN
G@ACC_PKD.SYSID
     16785**DCL     24371<>CALL
G@ACC_PKD.TYPE
     16783**DCL     24405>>ASSIGN
G@ACC_PKD.USER_EXTIME
     16788**DCL     16789--REDEF   24388<<ASSIGN  24388>>ASSIGN
G@ACC_PKD.USER_MEMTIME
     16791**DCL     16791--REDEF   24392--ASSIGN
G@ACC_PKD.USER_SVTIME
     16790**DCL     16790--REDEF   24390<<ASSIGN  24390>>ASSIGN
GETCONFIGS
     25258**PROC    24229--CALL
GOFEP
     17894**DCL     25415<>CALL
GOFEP.V
     17895**DCL     17894--DCLINIT
GOFEP.V.DMPSTART#
     17895**DCL     17896--REDEF
GOFEP.V.FEP#
     17896**DCL     25414<<ASSIGN
HLTFEP
     17879**DCL     25393<>CALL
HLTFEP.V
     17880**DCL     17879--DCLINIT
HLTFEP.V.DMPSTART#
     17880**DCL     17881--REDEF
HLTFEP.V.FEP#
     17881**DCL     25392<<ASSIGN
HOSTNAME
     15866**DCL     24101<>CALL    24102>>ASSIGN  24103--ASSIGN  24262<>CALL    24263>>IF      24265<<ASSIGN
     24292<>CALL    24293>>IF      24295<<ASSIGN  24822<>CALL    24823>>IF      24824<<ASSIGN
I
     15824**DCL     23605<<ASSIGN  23625>>IF      23625>>IF      23625>>IF      23639<<ASSIGN  23643<<ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:573  
     23869<<DOINDEX 23870>>CALLBLT 23870>>CALLBLT 23872>>IF      23873>>IF      24093<<DOINDEX 24094>>ASSIGN
     24105<<DOINDEX 24106>>ASSIGN  24107>>IF      24136<<ASSIGN  24138>>CALL    24139>>ASSIGN  24140>>ASSIGN
     24142>>CALL    24143>>ASSIGN  24154>>ASSIGN  24158>>CALL    24537<<DOINDEX 24538>>CALL    24538>>CALL
     24788<<CALLBLT 24789>>ASSIGN  25037<>CALL    25038<<ASSIGN  25038>>ASSIGN  25039<>CALL    25061<<DOINDEX
     25062>>IF      25062>>IF      25062>>IF      25062>>IF      25064<>CALL    25065<>CALL    25122<<DOINDEX
     25123>>IF      25123>>IF      25123>>IF      25123>>IF      25125<>CALL    25133<<DOINDEX 25138>>ASSIGN
     25139>>ASSIGN  25140>>IF
I$8TO9
     25512**PROC    24371--CALL    24372--CALL    24374--CALL    24376--CALL    24378--CALL
IN$
     15830**DCL     24572<<ASSIGN  24597>>CALL
IPARAM$
     15829**DCL     24565<<ASSIGN  24566<<ASSIGN  24566>>ASSIGN  24567>>ASSIGN  24577>>CALL    24580<<ASSIGN
     24580>>ASSIGN  24583>>CALL    24586<<ASSIGN  24586>>ASSIGN  24589>>CALL    24593<<ASSIGN  24593>>ASSIGN
J
     15825**DCL     24513<<DOINDEX 24514>>IF      24516>>ASSIGN  24517>>ASSIGN  24570<<DOINDEX 24572>>ASSIGN
     24575>>ASSIGN  24577>>CALL    24583>>CALL    24596>>DOINDEX
JC_CSMBF
     15623**DCL     15624--REDEF   15633--REDEF   15642--REDEF   15649--REDEF   15655--REDEF   15658--REDEF
     17609--DCLINIT 17610--DCLINIT 23999--ASSIGN
JC_MARS
     15620**DCL     24000<>CALL
JGG$TGJOB
     23577**DCL-ENT 24791--CALL
JMU$SETSEG
     23593**DCL-ENT 24431--CALL
K
     15826**DCL     24553<<DOINDEX 24554>>IF      24556>>ASSIGN  24556>>ASSIGN  24558>>CALL    24558>>CALL
     24596<<DOINDEX 24597>>CALL    24597>>CALL
KBCHS.CNT
     15647**DCL     23755>>ASSIGN  23765>>ASSIGN  23779>>ASSIGN
KBCHS.MSG
     15648**DCL     23756>>ASSIGN  23764>>ASSIGN  23778>>ASSIGN
KBD
     25346**LABEL   23607--CALLALT 23658--CALLALT 23668--CALLALT 23673--CALLALT 23683--CALLALT 23690--CALLALT
     23707--CALLALT 23732--CALLALT 23775--CALLALT
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:574  
KBERR
     23534**DCL     23601<<ASSIGN  23944<<ASSIGN  23949--ASSIGN  24017<<ASSIGN  24899<<ASSIGN  24906--ASSIGN
     24945<<ASSIGN  24950--ASSIGN  25383--ASSIGN  25472<<ASSIGN  25477--ASSIGN
KBERR.CADDR
     23535**DCL     23948<<ASSIGN  24912<<ASSIGN  24957<<ASSIGN  25379<<ASSIGN  25473<<ASSIGN
KBERR.ERR
     23553**DCL     23503--DCLINIT 24905<<ASSIGN  24953<<ASSIGN  24955<<ASSIGN  25367<<ASSIGN  25370<<ASSIGN
     25371<<ASSIGN  25374<<ASSIGN  25462<<ASSIGN
KBERR.FEX
     23552**DCL     23502--DCLINIT 23946<<ASSIGN  24900<<ASSIGN  24947<<ASSIGN  25382<<ASSIGN  25474<<ASSIGN
KBERR.FLAGS
     23541**DCL     23542--REDEF
KBERR.MSG#
     23536**DCL     23945<<ASSIGN  24909<<ASSIGN  24911<<ASSIGN  24956<<ASSIGN  25362<<ASSIGN  25366<<ASSIGN
     25377<<ASSIGN  25476<<ASSIGN
KBERR.MSGID
     23537**DCL     23538--REDEF
KBERR.NAME
     23560**DCL     23506--DCLINIT 23947<<ASSIGN  24946<>CALL    25381<<ASSIGN  25475<<ASSIGN
KBERR.PORT
     23554**DCL     23504--DCLINIT
KBERR.PORT.B
     23556**DCL     24901<<ASSIGN  24948<<ASSIGN
KBERR.PORT.T
     23555**DCL     24902<<ASSIGN  24949<<ASSIGN
KBERR.PORT_HI
     23557**DCL     23505--DCLINIT
KBERR.PORT_HI.B
     23559**DCL     24903<<ASSIGN
KBERR.PORT_HI.T
     23558**DCL     24904<<ASSIGN
KBERR.WSN
     23544**DCL     23545--REDEF
KCHK IN PROCEDURE BDSET
     25441**ENTRY   23607--CALL    23658--CALL    23668--CALL    23673--CALL    23683--CALL    23690--CALL
     23707--CALL    23732--CALL    23775--CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:575  
KEYINS
     23839**LABEL   23823--GOTO
KHA_C
     16176**DCL     24268>>ASSIGN
KL$ACCTNG.DEVNM
     18644**DCL     18645--REDEF   24747<<ASSIGN  24777<<ASSIGN
KL$ACCTNG.FEX
     18641**DCL     24748<<ASSIGN  24778<<ASSIGN
KL$ACCTNG.REASON
     18642**DCL     24749<<ASSIGN
KL$ADMIN
     19612**DCL     24683<>CALL    24683--CALL    24689<>CALL    24689--CALL    24698<>CALL    24698--CALL
     24702<>CALL    24713<>CALL    24713--CALL    24719<>CALL    24719--CALL    24728<>CALL    24728--CALL
     24895<>CALL
KL$ADMIN.FNC
     19679**DCL     24734>>DOCASE  24905>>ASSIGN
KL$ADMIN.NODE
     19623**DCL     24676<>CALL    24706<>CALL
KL$ADMIN.ORIGIN
     19622**DCL     24689<>CALL    24698<>CALL    24702<>CALL    24719<>CALL    24728<>CALL    24732>>IF
     24893>>IF      24895<>CALL
KL$ADMIN.RESULTS
     19642**DCL     24685<>CALL    24694<>CALL    24715<>CALL    24724<>CALL    24907>>IF
KL$ADMIN.SRCE_NODE
     19619**DCL     24682<<ASSIGN  24712<<ASSIGN
KL$ADMIN.TERMID_HI.TERM
     19728**DCL     19737--REDEF
KL$ADMIN.TERMID_HI.TERM.CHANNEL.BYT
     19730**DCL     24903>>ASSIGN  24904>>ASSIGN
KL$ADMIN.TERMID_LO
     19697**DCL     24739>>ASSIGN  24770>>ASSIGN  24809>>ASSIGN  24838>>ASSIGN  24847>>ASSIGN
KL$ADMIN.TERMID_LO.LEV
     19699**DCL     24760>>IF      24863>>ASSIGN
KL$ADMIN.TERMID_LO.TERM
     19699**DCL     19708--REDEF
KL$ADMIN.TERMID_LO.TERM.CHANNEL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:576  
     19701**DCL     24864<>CALL
KL$ADMIN.TERMID_LO.TERM.CHANNEL.BYT
     19701**DCL     24901>>ASSIGN  24902>>ASSIGN
KL$ADMIN.TERMID_LO.TERM.SUBDEVICE
     19701**DCL     24865<>CALL
KL$ADMIN.TERMID_LO.TERM.SUBSUBDEVICE
     19702**DCL     24866<>CALL
KL$ADMIN.TERMID_LO.TERM.TERM_NAME
     19708**DCL     24817--ASSIGN  24818>>ASSIGN
KL$ADMIN.TERMID_LO.TTYP
     19699**DCL     24803>>IF      24803>>IF      24803>>IF      24807>>IF      24881<<ASSIGN
KL$AFD
     19320**DCL     24177--ASSIGN  24178<>CALL
KL$AFD.NETADR_FROM
     19325**DCL     24170<>CALL    24179<>CALL
KL$AFD.NODE
     19323**DCL     24175>>ASSIGN
KL$CHNRSP
     18888**DCL     24255<<ASSIGN  24278--ASSIGN  24279<>CALL    24308--ASSIGN  24309<>CALL
KL$CHNRSP.HANDLER
     18917**DCL     24256<<ASSIGN
KL$CHNRSP.LINE_PROFILE
     18895**DCL     24260<<ASSIGN
KL$CHNRSP.MESSAGE.MESSAGE
     19089**DCL     24278--ASSIGN  24308--ASSIGN
KL$CHNRSP.MESSAGE.MSGSIZE.BYT
     19083**DCL     24307>>ASSIGN  24307>>ASSIGN
KL$CHNRSP.NAK
     18907**DCL     24259<<ASSIGN  24277<<ASSIGN  24298>>IF
KL$CHNRSP.TERMINAL_ID
     18937**DCL     24257<<ASSIGN
KL$CHNRSP.TERMINAL_ID.LEV
     18939**DCL     24339>>ASSIGN
KL$CHNRSP.TERMINAL_ID.TERM
     18939**DCL     18948--REDEF
KL$CHNRSP.TERMINAL_ID.TERM.CHANNEL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:577  
     18941**DCL     24340<>CALL
KL$CHNRSP.TERMINAL_ID.TERM.SUBDEVICE
     18941**DCL     24341<>CALL
KL$CHNRSP.TERMINAL_ID.TERM.SUBSUBDEVICE
     18942**DCL     24342<>CALL
KL$CHNRSP.TERMINAL_ID.TERM.TERM_NAME
     18948**DCL     24299<<ASSIGN
KL$CNFG_MSG
     20562**DCL     24647<>CALL    24647--CALL    24654<>CALL    24654--CALL    24664<>CALL    24664--CALL
     24669<>CALL    24669--CALL    25005<>CALL    25005--CALL    25011<>CALL    25011--CALL    25020<>CALL
     25020--CALL    25024<>CALL    25024--CALL
KL$CNFG_MSG.NODE
     20573**DCL     24639<>CALL    24999<>CALL
KL$CNFG_MSG.ORIGIN
     20572**DCL     24654<>CALL    24664<>CALL    24669<>CALL    25011<>CALL    25020<>CALL    25024<>CALL
KL$CNFG_MSG.RESULTS
     20592**DCL     24650<>CALL    24660<>CALL    25007<>CALL    25016<>CALL
KL$CNFG_MSG.SRCE_NODE
     20569**DCL     24646<<ASSIGN
KL$CNFG_MSG.TERMID_HI.TERM
     20673**DCL     20682--REDEF
KL$CNFG_MSG.TERMID_LO.TERM
     20644**DCL     20653--REDEF
KL$CONFIGRSP
     22519**DCL     25187<<ASSIGN
KL$CONFIGRSP.FCN
     22520**DCL     25188<<ASSIGN
KL$CONFIGRSP.MSGID
     22524**DCL     25189<<ASSIGN
KL$CONFIGRSP.NETERR
     22573**DCL     25191<>CALL
KL$CONFIGRSP.NODE
     22532**DCL     25190<<ASSIGN
KL$CONTROL
     20425**DCL     24622<>CALL    24622--CALL    24626<>CALL    24626--CALL    24632<>CALL    24632--CALL
KL$CONTROL.NODE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:578  
     20436**DCL     24617<>CALL
KL$CONTROL.ORIGIN
     20435**DCL     24626<>CALL    24632<>CALL
KL$CONTROL.RESULTS
     20455**DCL     24618<>CALL    24623<>CALL
KL$CONTROL.SRCE_NODE
     20432**DCL     24621<<ASSIGN
KL$CONTROL.TYPE
     20431**DCL     24625<<ASSIGN
KL$CONTROL_INIT
     20170**DCL     24571--ASSIGN  24612--ASSIGN  24613<>CALL
KL$CONTROL_INIT.CODE
     20175**DCL     24547<<ASSIGN
KL$CONTROL_INIT.FPARAM
     20249**DCL     24538<>CALL    24556<<ASSIGN  24558<>CALL    24565--ASSIGN
KL$CONTROL_INIT.HANDLER
     20179**DCL     24527>>IF      24543>>ASSIGN
KL$CONTROL_INIT.IPARAM
     20251**DCL     24567--ASSIGN
KL$CONTROL_INIT.IPARAM.ARRAY_SZ
     20257**DCL     24580--ASSIGN
KL$CONTROL_INIT.IPARAM.OFFSET
     20259**DCL     24593--ASSIGN
KL$CONTROL_INIT.IPARAM.PARAM_SZ
     20258**DCL     24586--ASSIGN
KL$CONTROL_INIT.NUM_FPARAM
     20243**DCL     24535<<ASSIGN  24537>>DOINDEX 24551<<ASSIGN
KL$CONTROL_INIT.NUM_IPARAM
     20244**DCL     24536<<ASSIGN  24552<<ASSIGN
KL$CONTROL_INIT.TYPE
     20176**DCL     24550<<ASSIGN  24608<<ASSIGN  24610<<ASSIGN
KL$CWNAK
     19360**DCL     24184--ASSIGN  24187<>CALL    24188<>CALL
KL$CWNAK.NETADR.NODE
     19365**DCL     24185>>ASSIGN
KL$DREC.FEBLK
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:579  
     22916**DCL     22965--REDEF
KL$DREC.FEBLK.BILL
     22918**DCL     24154>>ASSIGN
KL$DREC.FEBLK.DBACCN
     22919**DCL     24155>>ASSIGN
KL$DREC.FEBLK.FLAGS.STEPACCT
     22924**DCL     24141>>ASSIGN
KL$DREC.FEBLK.MACCTMEM
     22922**DCL     24153<>CALL
KL$DREC.FEBLK.MFPRG
     22921**DCL     24144>>ASSIGN  24145>>IF
KL$DREC.FEBLK.MINTS
     22920**DCL     24143>>ASSIGN
KL$DREC.FEBLK.MMEM
     22929**DCL     24142<>CALL
KL$DREC.FEBLK.MTIME
     22928**DCL     24138>>CALL
KL$DREC.FEBLK.PPRIV
     22927**DCL     24140>>ASSIGN
KL$DREC.FEBLK.PRIV
     22926**DCL     24139>>ASSIGN
KL$DREC.FEBLK.PSDOL
     22935**DCL     24158--CALL
KL$DREC.FEBLK.PSDOL.PSDO_NAME
     22936**DCL     24157>>ASSIGN
KL$DREC.FLAGS.FEOK
     22846**DCL     24145>>IF
KL$DREC.GJOB.ACCT
     22967**DCL     24791<>CALL
KL$DREC.GJOB.CMDCNT
     22970**DCL     24791--CALL    24791--CALL
KL$DREC.GJOB.PASS
     22969**DCL     24791<>CALL
KL$DREC.GJOB.UNAME
     22968**DCL     24788>>CALLBLT 24790>>ASSIGN
KL$DREC.PASSWORD
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:580  
     22858**DCL     22862--REDEF
KL$DREC.RENAME
     22881**DCL     22882--REDEF
KL$DUMPABORT
     22687**DCL     25204--ASSIGN
KL$DUMPABORT.CSHDR.FUNCTION
     22691**DCL     25201<<ASSIGN
KL$DUMPABORT.CSHDR.KEY#
     22690**DCL     25200<<ASSIGN
KL$DUMPABORT.FEX
     22703**DCL     25203<<ASSIGN
KL$DUMPABORT.TYPE
     22699**DCL     25202<<ASSIGN
KL$DUMPMSG
     22646**DCL     25053--ASSIGN
KL$DUMPMSG.CSHDR.FUNCTION
     22650**DCL     25052<<ASSIGN
KL$DUMPMSG.CSHDR.KEY#
     22649**DCL     25051<<ASSIGN
KL$DUMPMSG.DATASIZE
     22663**DCL     25050<>CALL
KL$DUMPMSG.FEX
     22662**DCL     23999--ASSIGN
KL$ERRMSG_RQS.ALTCODE_EXISTS
     21987**DCL     24477>>IF
KL$ERRMSG_RQS.ALTERR
     22017**DCL     24479--ASSIGN
KL$ERRMSG_RQS.CTX$
     21993**DCL     24505>>ASSIGN
KL$ERRMSG_RQS.ERR
     22001**DCL     24467--ASSIGN
KL$ERRMSG_RQS.FID_EXISTS
     21988**DCL     24489>>IF
KL$ERRMSG_RQS.FILEACCT
     22027**DCL     24492>>IF      24493--ASSIGN
KL$ERRMSG_RQS.FILENAME
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:581  
     22024**DCL     24491--ASSIGN
KL$ERRMSG_RQS.FILEPASS
     22028**DCL     24494>>IF      24495--ASSIGN
KL$ERRMSG_RQS.INCLCODE
     21982**DCL     24471>>ASSIGN
KL$ERRMSG_RQS.LANG
     21973**DCL     24483>>IF      24486>>ASSIGN
KL$ERRMSG_RQS.LEAVE_TOKEN
     21978**DCL     24475>>ASSIGN
KL$ERRMSG_RQS.SUBFILE
     21980**DCL     24473>>ASSIGN
KL$ERRMSG_RQS.SUBLANG
     21979**DCL     24474>>ASSIGN
KL$ERRMSG_RQS.SUBMESS
     21981**DCL     24472>>ASSIGN
KL$ERRMSG_RQS.USR#
     21968**DCL     24504>>ASSIGN
KL$ERRMSG_RSP
     22046**DCL     24517--ASSIGN
KL$FEPST.FEP
     23014**DCL     24191>>ASSIGN
KL$KEYMES.CADDR.BOT
     20867**DCL     24088>>ASSIGN
KL$KEYMES.CADDR.MID
     20865**DCL     24087>>ASSIGN
KL$KEYMES.CADDR.TOP
     20863**DCL     24086>>ASSIGN
KL$KEYMES.CNSFNC
     20887**DCL     24033>>DOCASE  24089>>ASSIGN
KL$KEYMES.KEYIN_REQ
     20868**DCL     24066>>ASSIGN
KL$KEYMES.MSG#
     20844**DCL     24083<>CALL
KL$KEYMES.NPARMS
     20929**DCL     24085>>ASSIGN  24093>>DOINDEX 24097>>ASSIGN  24105>>DOINDEX
KL$KEYMES.PARMS
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:582  
     20930**DCL     24097--ASSIGN  24097--ASSIGN
KL$KEYMES.PARMS.SIZE
     20932**DCL     24094>>ASSIGN  24106>>ASSIGN
KL$KEYMES.PARMS.TYPE
     20931**DCL     24107>>IF
KL$KEYMES.TERMID
     20913**DCL     24039<>CALL    24059>>ASSIGN  24072<>CALL
KL$KEYMES.TERMID.TERM
     20915**DCL     20924--REDEF
KL$LINE_KEY
     18021**DCL     25212<<ASSIGN  25223<<ASSIGN
KL$LINE_KEY.KEY.KEYTYP
     18024**DCL     25229>>DOCASE
KL$LINE_KEY.KEY.NODE
     18025**DCL     25232>>IF
KL$LINE_KEY.KEY.TERMID.TERM
     18044**DCL     18053--REDEF
KL$LINE_KEY.SIZE
     18022**DCL     25213<<ASSIGN
KL$NETWORK.NODE#
     16321**DCL     25061>>DOINDEX
KL$NETWORK_KEY
     16303**DCL     25059--ASSIGN
KL$NODECHG
     21473**DCL     25033<>CALL    25033--CALL
KL$NODEINFO
     21449**DCL     25030<>CALL    25030--CALL
KL$OSILINKCHG
     21840**DCL     25115<>CALL    25115--CALL    25120>>ASSIGN
KL$OSILINKCHG.FCN
     21851**DCL     25114>>IF
KL$OSILINKCHG.MYNODE#
     21871**DCL     25123>>IF
KL$OSILINKCHG.QOS
     21875**DCL     25095>>ASSIGN
KL$OSILINKCHG.SNPA
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:583  
     21901**DCL     25096>>ASSIGN
KL$OSILINKCHG.TERMID.TERM
     21932**DCL     21941--REDEF   25084>>ASSIGN
KL$OSILINKCHG.TYPE
     21862**DCL     25085>>IF
KL$REQSTATS
     19995**DCL     24973<>CALL    24973--CALL    24979<>CALL    24979--CALL    24988<>CALL    24988--CALL
     24992<>CALL
KL$REQSTATS.DSPMSK
     20084**DCL     20090--REDEF
KL$REQSTATS.ERRCODE
     20027**DCL     24975<>CALL    24984<>CALL
KL$REQSTATS.FEPNAME
     20065**DCL     24966<>CALL
KL$REQSTATS.NODE_NUM
     20008**DCL     24965>>ASSIGN
KL$REQSTATS.SLCMSK
     20125**DCL     20132--REDEF
KL$REQSTATS.SRCE_NODE
     20009**DCL     24972<<ASSIGN
KL$REQSTATS.STATSSTA
     20061**DCL     24979<>CALL    24988<>CALL    24992<>CALL
KL$RQSCHN.DFLTCHN
     19511**DCL     24223>>IF
KL$RQSCHN.DFLTHND
     19507**DCL     24195>>IF
KL$RQSCHN.HANDLER
     19524**DCL     24200>>ASSIGN  24204>>ASSIGN  24256>>ASSIGN
KL$RQSCHN.SCNDCNFG
     19516**DCL     24224>>IF
KL$RQSCHN.SGN
     19557**DCL     24262<>CALL
KL$RQSCHN.SGN.L
     19566**DCL     19574--IMP-SIZ 24261>>IF      24262>>CALL    24271>>ASSIGN  24272>>ASSIGN
KL$RQSCHN.SGN.TXT
     19574**DCL     24272>>ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:584  
KL$RQSCHN.TERMINAL_ID
     19544**DCL     24232>>ASSIGN  24244>>ASSIGN  24257>>ASSIGN  24288>>ASSIGN  24314>>ASSIGN  24323>>ASSIGN
KL$RQSCHN.TERMINAL_ID.TERM
     19546**DCL     19555--REDEF
KL$RQSCHN.TERMINAL_ID.TERM.CHANNEL
     19548**DCL     24227>>IF
KL$RQSCHN.TERMINAL_ID.TTYP
     19546**DCL     24258<<ASSIGN
KL$RSPPND.LNK$
     22609**DCL     25194>>ASSIGN  25198>>ASSIGN
KL$RSPPND.MSGID
     22620**DCL     25189>>ASSIGN
KL$RSPPND.NODE
     22611**DCL     25192>>IF
KL$RUE
     19771**DCL     24926<>CALL    24926--CALL    24929<>CALL    24929--CALL    24935<>CALL    24935--CALL
     24941<>CALL    24941--CALL
KL$RUE.NODE
     19782**DCL     24920<>CALL
KL$RUE.ORIGIN
     19781**DCL     24929<>CALL    24935<>CALL    24939>>IF      24941<>CALL
KL$RUE.RESULTS
     19801**DCL     24928<>CALL    24934<>CALL    24951>>IF
KL$RUE.SYSID#
     19838**DCL     24948>>ASSIGN  24949>>ASSIGN
KL$STRTU
     19149**DCL     24167--ASSIGN  24168<>CALL
KL$STRTU.ACCT
     19190**DCL     24123>>ASSIGN
KL$STRTU.BILL
     19282**DCL     24154<<ASSIGN
KL$STRTU.DB_ACCT
     19194**DCL     24155<<ASSIGN
KL$STRTU.FLAGS.STEPACCT
     19300**DCL     24141<<ASSIGN
KL$STRTU.INTS
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:585  
     19247**DCL     24143<<ASSIGN
KL$STRTU.MACCTFPRG
     19251**DCL     24144<<ASSIGN
KL$STRTU.MACCTMEM
     19256**DCL     24153<>CALL
KL$STRTU.MAX
     19271**DCL     24158<>CALL
KL$STRTU.MEM
     19238**DCL     24142<>CALL    24162>>IF      24163<<ASSIGN
KL$STRTU.MODE
     19198**DCL     24136>>ASSIGN
KL$STRTU.MRT
     19207**DCL     24138<>CALL    24160>>IF      24161<<ASSIGN
KL$STRTU.NETADR_FROM
     19160**DCL     24129<>CALL    24147<>CALL
KL$STRTU.NODE
     19156**DCL     24164>>ASSIGN
KL$STRTU.PPRIV
     19228**DCL     24140<<ASSIGN
KL$STRTU.PRIV
     19218**DCL     24139<<ASSIGN
KL$STRTU.PSEUDO_NAME
     19265**DCL     24157<<ASSIGN
KL$STRTU.UNAME
     19186**DCL     24124>>ASSIGN  24125>>CALLBLT
KL$SYSLOG.ERRLOG.DATA
     21613**DCL     24424>>ASSIGN  24450>>ASSIGN
KL$SYSLOG.ERRLOG.DATA_SIZE
     21611**DCL     24423>>ASSIGN  24426>>ASSIGN  24446>>ASSIGN  24447>>ASSIGN
KL$SYSLOG.ERRLOG.ERRCODE
     21541**DCL     24425<>CALL
KL$SYSLOG.ERRLOG.TERMID
     21593**DCL     24421>>ASSIGN
KL$SYSLOG.ERRLOG.TERMID.LEV
     21595**DCL     24452>>ASSIGN
KL$SYSLOG.ERRLOG.TERMID.TERM
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:586  
     21595**DCL     21604--REDEF
KL$SYSLOG.ERRLOG.TERMID.TERM.CHANNEL
     21597**DCL     24453<>CALL
KL$SYSLOG.ERRLOG.TERMID.TERM.SUBDEVICE
     21597**DCL     24455<>CALL
KL$SYSLOG.ERRLOG.TERMID.TERM.SUBSUBDEVICE
     21598**DCL     24457<>CALL
KL$SYSLOG.ERRLOG.UTS
     21575**DCL     24422>>ASSIGN
KL$SYSLOG.ERRLOG.VALUES
     21609**DCL     24420>>ASSIGN  24451>>ASSIGN
KL$SYSLOG.FILENUM
     21501**DCL     24362>>DOCASE
KL$TIME
     22495**DCL     25046<>CALL    25046--CALL
KL$TIME.UTS
     22500**DCL     25036>>ASSIGN  25039<>CALL
KL$UPDOSI
     21631**DCL     25064<>CALL    25064--CALL
KL$UPDOSI.LNSAP.ADDRESS_N
     21785**DCL     21786--REDEF
KL$UPDOSI.MYNODE#
     21666**DCL     21668--REDEF
KL$UPDOSI.NODE#
     21669**DCL     21671--REDEF
KL$UPDOSI.NSAP.ADDRESS_N
     21729**DCL     21730--REDEF
KL@ERRMSG_RSP
     22122**DCL     24519<>CALL
KL@ERRMSG_RSP.ALTMSG
     22151**DCL     24508<<ASSIGN
KL@ERRMSG_RSP.CTX$
     22175**DCL     24505<<ASSIGN
KL@ERRMSG_RSP.FCN
     22123**DCL     24503<<ASSIGN
KL@ERRMSG_RSP.INERR
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:587  
     22168**DCL     24511<<ASSIGN
KL@ERRMSG_RSP.MESSAGE
     22180**DCL     24468--ASSIGN  24514>>IF
KL@ERRMSG_RSP.MESSAGE_SZ
     22134**DCL     24516<<ASSIGN
KL@ERRMSG_RSP.MSGCOMP
     22156**DCL     24509<<ASSIGN
KL@ERRMSG_RSP.NNATIVE
     22160**DCL     24510<<ASSIGN
KL@ERRMSG_RSP.NOFILE
     22142**DCL     24506<<ASSIGN
KL@ERRMSG_RSP.NOMSG
     22146**DCL     24507<<ASSIGN
KL@ERRMSG_RSP.USR#
     22129**DCL     24504<<ASSIGN
KLB$GET
     23589**DCL-ENT 24056--CALL
KLB$REL
     23590**DCL-ENT 24049--CALL    24076--CALL    25175--CALL
KLC$CONFIG
     23578**DCL-ENT 25195--CALL
KLH$ERRMSG
     23594**DCL-ENT 23711--CALL
KLH$SGSCAN
     23581**DCL-ENT 24262--CALL    24292--CALL    24822--CALL
KLI$GETFEPERA
     23596**DCL-ENT 25037--CALL
KLI$GETSNPA
     23595**DCL-ENT 25065--CALL
KLI$LINEPRO
     23579**DCL-ENT 24297--CALL
KLI$UPDATE
     23580**DCL-ENT 24028--CALL
KLX$8TO9
     23586**DCL-ENT 24083--CALL    24111--CALL    24340--CALL    24341--CALL    24342--CALL    24453--CALL
     24455--CALL    24457--CALL    24864--CALL    24865--CALL    24866--CALL    25050--CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:588  
KLX$9TO8
     23587**DCL-ENT 24138--CALL    24142--CALL    24153--CALL    24158--CALL    24217--CALL    24538--CALL
     24558--CALL    24577--CALL    24583--CALL    24589--CALL    24597--CALL    25039--CALL    25292--CALL
     25299--CALL
KLX$CONV_NODE
     23583**DCL-ENT 23612--CALL    23940--CALL    24101--CALL    24343--CALL    24867--CALL    24946--CALL
     24966--CALL    25454--CALL
KLX$CONV_NODENAME
     23582**DCL-ENT 23938--CALL    24617--CALL    24639--CALL    24676--CALL    24706--CALL    24920--CALL
     24999--CALL    25449--CALL
KLX$ERR2NETERR
     23588**DCL-ENT 25191--CALL    25496--CALL
KLX$WRHLPNODE
     23584**DCL-ENT 23651--CALL    23661--CALL    23769--CALL    23780--CALL    23782--CALL    23893--CALL
     23941--CALL    24000--CALL    24168--CALL    24178--CALL    24188--CALL    24192--CALL    24251--CALL
     24279--CALL    24309--CALL    24519--CALL    24613--CALL    24622--CALL    24647--CALL    24683--CALL
     24713--CALL    24926--CALL    24973--CALL    25005--CALL    25030--CALL    25033--CALL    25046--CALL
     25064--CALL    25115--CALL    25125--CALL    25145--CALL    25305--CALL    25333--CALL    25343--CALL
     25404--CALL    25424--CALL    25502--CALL
KLX$WRHLPSTA
     23585**DCL-ENT 24187--CALL    24626--CALL    24632--CALL    24654--CALL    24664--CALL    24669--CALL
     24689--CALL    24698--CALL    24702--CALL    24719--CALL    24728--CALL    24895--CALL    24929--CALL
     24935--CALL    24941--CALL    24979--CALL    24988--CALL    24992--CALL    25011--CALL    25020--CALL
     25024--CALL    25500--CALL
KL_AUTOFAIL.FLAGS
     11249**DCL     11250--REDEF
KL_AUTOFAIL.MSGID
     11245**DCL     11246--REDEF
KL_AUTOFAIL.WSN
     11252**DCL     11253--REDEF
KL_BROADSZ
     16334**DCL     23755<<ASSIGN
KL_CHNRSPC
     18434**DCL     24199>>ASSIGN  24241>>ASSIGN  24255>>ASSIGN  25283>>ASSIGN  25327>>ASSIGN  25340>>ASSIGN
KL_CHNRSPC.TERMINAL_ID.TERM
     18485**DCL     18494--REDEF
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:589  
KL_DR_NETWORK
     17750**DCL     24751<>CALL    24757<>CALL    25087<>CALL    25234<>CALL    25242<>CALL
KL_DR_NETWORK.KEY_
     17750**DCL     24750<<ASSIGN  24756<<ASSIGN  25086<<ASSIGN  25220<<ASSIGN
KL_DVCERRRSP
     20968**DCL     23892--ASSIGN  23893<>CALL
KL_DVCERRRSP.KYN#
     20972**DCL     23889<<ASSIGN
KL_DVCERRRSP.TERMID
     20992**DCL     23890<<ASSIGN
KL_DVCERRRSP.TERMID.TERM
     20994**DCL     21003--REDEF
KL_EXTRSP_BUF
     11405**DCL     25058--ASSIGN
KL_EXTRSP_BUF$
     11406**DCL     16320--IMP-PTR 18668--IMP-PTR 18888--IMP-PTR 24199>>ASSIGN  24200>>ASSIGN  24201>>ASSIGN
     24202>>ASSIGN  24208>>ASSIGN  24209>>ASSIGN  24210>>ASSIGN  24217>>CALL    24218>>ASSIGN  24225>>ASSIGN
     24241>>ASSIGN  24242>>ASSIGN  24243>>ASSIGN  24244>>ASSIGN  24248>>ASSIGN  24249>>ASSIGN  24250>>ASSIGN
     24251>>CALL    24255>>ASSIGN  24256>>ASSIGN  24257>>ASSIGN  24259>>ASSIGN  24260>>ASSIGN  24277>>ASSIGN
     24279>>CALL    24298>>IF      24299>>ASSIGN  24307>>ASSIGN  24307>>ASSIGN  24309>>CALL    24339>>ASSIGN
     24340>>CALL    24341>>CALL    24342>>CALL    25061>>DOINDEX 25283>>ASSIGN  25284>>ASSIGN  25285>>ASSIGN
     25286>>ASSIGN  25287>>ASSIGN  25288>>ASSIGN  25289>>ASSIGN  25290>>ASSIGN  25291>>ASSIGN  25292>>CALL
     25299>>CALL    25300>>ASSIGN  25305>>CALL    25327>>ASSIGN  25328>>ASSIGN  25329>>ASSIGN  25330>>ASSIGN
     25331>>ASSIGN  25332>>ASSIGN  25333>>CALL    25340>>ASSIGN  25342>>ASSIGN  25343>>CALL
KL_FEMSG
     11192**DCL     23610--ASSIGN
KL_FEMSG.CADDR
     11193**DCL     23609<<ASSIGN  23636<<ASSIGN
KL_FEMSG.FEX
     11209**DCL     23624<<ASSIGN
KL_FEMSG.FLAGS
     11199**DCL     11200--REDEF
KL_FEMSG.MSG#
     11194**DCL     23608<<ASSIGN
KL_FEMSG.MSGID
     11195**DCL     11196--REDEF
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:590  
KL_FEMSG.NAME
     11212**DCL     23612<>CALL    23625>>IF
KL_FEMSG.PROB
     11210**DCL     23621<<ASSIGN  23623<<ASSIGN
KL_FEMSG.STATE
     11211**DCL     23616<<ASSIGN  23618<<ASSIGN
KL_FEMSG.WSN
     11202**DCL     11203--REDEF
KL_FEPCTL
     16055**DCL     24530--ASSIGN
KL_FEPCTL.NPARAMS
     16056**DCL     24532>>IF      24535>>ASSIGN
KL_FEPCTL.PARAMS
     16058**DCL     24538<>CALL
KL_FEPCTL_KEY
     16036**DCL     24529--ASSIGN
KL_FEPCTL_KEY.NODE
     16039**DCL     24528<<ASSIGN
KL_FEPW
     11171**DCL     23648<<ASSIGN  23649>>ASSIGN
KL_FETBL.ACTIVE
     11141**DCL     23619>>IF      25062>>IF      25123>>IF
KL_FETBL.BOSS
     11142**DCL     23724>>IF      23767>>IF      25041>>IF      25062>>IF      25123>>IF
KL_FETBL.DEBUG
     11143**DCL     23767>>IF
KL_FETBL.HOST_NODE
     11139**DCL     23614>>IF      23700>>IF      23724>>IF      23741>>IF      25062>>IF      25140>>IF
KL_FETBL.KTYP
     11145**DCL     23669>>ASSIGN  23670<<ASSIGN  23676>>ASSIGN  23677<<ASSIGN  23684>>ASSIGN  23685<<ASSIGN
     24022>>IF      25357<<ASSIGN  25398<<ASSIGN  25422<<ASSIGN  25426<<ASSIGN  25433<<ASSIGN  25435<<ASSIGN
     25459>>IF      25459>>IF      25459>>IF      25462>>ASSIGN
KL_FETBL.LINK_CONNECT
     11140**DCL     23700>>IF      23724>>IF      23741>>IF      25123>>IF      25390>>IF      25469>>IF
KL_FETBL.QOS
     11146**DCL     23718>>IF      25139>>ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:591  
KL_FROG.FEX
     15572**DCL     25264<<ASSIGN
KL_FROG.FUNCTION
     15571**DCL     25263<<ASSIGN
KL_HDRMSG.MSG_
     19132**DCL     23756<<ASSIGN
KL_HLPKEY
     11269**DCL     24321>>ASSIGN  24781<<ASSIGN  24845>>ASSIGN
KL_HLPKEY.ACCT
     11271**DCL     24123<<ASSIGN  24126--ASSIGN  24827<<ASSIGN
KL_HLPKEY.CNT
     11270**DCL     24126<<ASSIGN  24829<<ASSIGN
KL_HLPKEY.NAME
     11272**DCL     24124<<ASSIGN  24828<<ASSIGN
KL_HLPR
     23046**DCL     15736--DCLINIT 15737--DCLINIT 24135--ASSIGN  24787--ASSIGN
KL_HLPR.ATYP
     23051**DCL     24322>>ASSIGN  24348>>ASSIGN  24846>>ASSIGN  24872>>ASSIGN
KL_HLPR.FLAGS.GJOB
     23072**DCL     24784>>IF
KL_HLPR.PASSWORD
     23104**DCL     23108--REDEF
KL_HLPR.RENAME
     23127**DCL     23128--REDEF
KL_HLPR.TNAME
     23137**DCL     24346>>ASSIGN  24870>>ASSIGN
KL_HLPR.TWSN#
     23101**DCL     24347>>ASSIGN  24871>>ASSIGN
KL_HLPR$
     11407**DCL     15758--IMP-PTR 23869>>DOINDEX 23870>>CALLBLT 23870>>CALLBLT 23872>>IF      23873>>IF
KL_HNDLR
     15970**DCL     24545--ASSIGN  24572--ASSIGN
KL_HNDLR.IPARAM.ARRAY_SZ
     16003**DCL     24575>>ASSIGN  24577<>CALL    24596>>DOINDEX
KL_HNDLR.IPARAM.OFFSET
     16012**DCL     24572>>ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:592  
KL_HNDLR.IPARAM.PARAM_SZ
     16008**DCL     24583<>CALL
KL_HNDLR.NPARAMI
     15992**DCL     24552>>ASSIGN  24563>>IF      24567>>ASSIGN  24570>>DOINDEX
KL_HNDLR.NPARAMS
     15987**DCL     24548>>IF      24551>>ASSIGN  24553>>DOINDEX 24566>>ASSIGN
KL_HNDLR.PARAMS
     15997**DCL     24556>>ASSIGN  24558<>CALL
KL_HNDLR.TYPE
     15978**DCL     24550>>ASSIGN
KL_HNDLR_KEY
     15949**DCL     24544--ASSIGN
KL_HNDLR_KEY.HNDLR
     15953**DCL     24543<<ASSIGN
KL_HNDLR_KEY.NODE
     15952**DCL     24542<<ASSIGN
KL_HOPCOST
     11177**DCL     25139>>ASSIGN
KL_MARS
     11172**DCL     24702<>CALL    24895<>CALL    24992<>CALL
KL_MXFE
     11137**DCL     23611>>DOINDEX 23650>>DOINDEX 23691>>IF      23699>>DOINDEX 23723>>DOINDEX 23740>>DOINDEX
     23766>>DOINDEX 25040>>DOINDEX 25351>>IF
KL_NETWORK_BUF
     11363**DCL     24850--ASSIGN  25101--ASSIGN  25105--ASSIGN
KL_NETWORK_BUF.ACCT
     11367**DCL     24320<<ASSIGN  24844<<ASSIGN
KL_NETWORK_BUF.ATYP
     11365**DCL     24322<<ASSIGN  24846<<ASSIGN
KL_NETWORK_BUF.DEVNM
     11368**DCL     23818>>IF      24031<<ASSIGN  24052>>IF      24067>>ASSIGN  24084>>ASSIGN  24318<<ASSIGN
     24747>>ASSIGN  24777>>ASSIGN  24842<<ASSIGN  25579<<ASSIGN  25587>>IF
KL_NETWORK_BUF.HLPKEY
     11400**DCL     24321<<ASSIGN  24781>>ASSIGN  24845<<ASSIGN
KL_NETWORK_BUF.NODE
     11369**DCL     23991>>ASSIGN  24324<<ASSIGN  24848<<ASSIGN  25240>>IF
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:593  
KL_NETWORK_BUF.TERMINAL_ID
     11387**DCL     24323<<ASSIGN  24847<<ASSIGN
KL_NETWORK_BUF.TERMINAL_ID.TERM
     11389**DCL     11398--REDEF
KL_NETWORK_BUF.TERMINAL_ID.TERM.CHANNEL.BYT
     11391**DCL     23989>>ASSIGN  23989>>ASSIGN
KL_NETWORK_BUF.TERMNAME
     11370**DCL     24319<<ASSIGN  24755>>ASSIGN  24843<<ASSIGN
KL_NETWORK_KEY
     11292**DCL     23793--ASSIGN  24325--ASSIGN  24740--ASSIGN  24750--ASSIGN  24773--ASSIGN  24849--ASSIGN
     25100--ASSIGN  25104--ASSIGN  25223>>ASSIGN  25578--ASSIGN
KL_NETWORK_KEY.KEY
     11294**DCL     23799<<ASSIGN  23800--ASSIGN  23861<<ASSIGN  23862--ASSIGN  24316--ASSIGN  24742--ASSIGN
     24772--ASSIGN  24840--ASSIGN  25213--ASSIGN  25222--ASSIGN  25577--ASSIGN
KL_NETWORK_KEY.KEY.KEYTYP
     11295**DCL     24312<<ASSIGN  24836<<ASSIGN
KL_NETWORK_KEY.KEY.NODE
     11296**DCL     24313<<ASSIGN  24738<<ASSIGN  24769<<ASSIGN  24837<<ASSIGN  25574<<ASSIGN
KL_NETWORK_KEY.KEY.TERMID
     11313**DCL     24314<<ASSIGN  24739<<ASSIGN  24770<<ASSIGN  24838<<ASSIGN  25575<<ASSIGN
KL_NETWORK_KEY.KEY.TERMID.TERM
     11315**DCL     11324--REDEF
KL_NETWORK_KEY.KEY.TERMID.TTYP
     11315**DCL     24315<<ASSIGN  24741<<ASSIGN  24771<<ASSIGN  24839<<ASSIGN  25221<<ASSIGN  25576<<ASSIGN
KL_NETWORK_KEY.SIZE
     11293**DCL     23800<<ASSIGN  23862<<ASSIGN  24316<<ASSIGN  24742<<ASSIGN  24772<<ASSIGN  24840<<ASSIGN
     25222<<ASSIGN  25577<<ASSIGN
KL_NETWORK_TERMKEY
     11342**DCL     23973--ASSIGN  24331--ASSIGN  24756--ASSIGN  24856--ASSIGN
KL_NETWORK_TERMKEY.KEY
     11344**DCL     23971--ASSIGN  24329--ASSIGN  24754--ASSIGN  24854--ASSIGN
KL_NETWORK_TERMKEY.KEY.TERMNAME
     11346**DCL     23972<<ASSIGN  24330<<ASSIGN  24755<<ASSIGN  24855<<ASSIGN
KL_NETWORK_TERMKEY.SIZE
     11343**DCL     23971<<ASSIGN  24329<<ASSIGN  24754<<ASSIGN  24854<<ASSIGN
KL_NETWORK_TIME
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:594  
     17731**DCL     24317<>CALL    24841<>CALL
KL_NETWORK_VALID
     11178**DCL     24198<<ASSIGN  24240<<ASSIGN  24254<<ASSIGN  24826<<ASSIGN  25057<<ASSIGN  25266<<ASSIGN
KL_NMNODE
     11181**DCL     24121>>IF      24166>>ASSIGN  24174>>IF      24176>>ASSIGN
KL_NODE
     11180**DCL     23782<>CALL    23934>>ASSIGN  24011>>ASSIGN  24121>>IF      24174>>IF      24186>>IF
     24621>>ASSIGN  24646>>ASSIGN  24682>>ASSIGN  24712>>ASSIGN  24972>>ASSIGN  25030<>CALL    25033<>CALL
     25041>>IF      25062>>IF      25115<>CALL    25121>>ASSIGN  25134>>IF      25137>>ASSIGN  25190>>ASSIGN
     25498>>IF
KL_NODENAME
     11179**DCL     24265>>ASSIGN  24295>>ASSIGN  24824>>ASSIGN
KL_NODES
     11176**DCL     25122>>DOINDEX 25133>>DOINDEX
KL_NWF
     11153**DCL     25099<<ASSIGN  25099>>ASSIGN
KL_PCD
     21284**DCL     17186--DCLINIT 24337<<ASSIGN  24746<<ASSIGN  24747--ASSIGN  24748--ASSIGN  24749--ASSIGN
     24776<<ASSIGN  24777--ASSIGN  24778--ASSIGN  24861<<ASSIGN
KL_PCD.ADDD
     21306**DCL     17188--DCLINIT
KL_PCD.ADDD.ACTYP
     21308**DCL     24344<<ASSIGN  24868<<ASSIGN
KL_PCD.ADDD.ASSOCTRM
     21332**DCL     24345<<ASSIGN  24869<<ASSIGN
KL_PCD.ADDD.ATYP
     21309**DCL     24348<<ASSIGN  24872<<ASSIGN
KL_PCD.ADDD.CINFO
     21334**DCL     21338--REDEF
KL_PCD.ADDD.DEVNM
     21327**DCL     21328--REDEF   24349<<ASSIGN  24873<<ASSIGN
KL_PCD.ADDD.FEPNAME
     21312**DCL     24343<>CALL    24867<>CALL
KL_PCD.ADDD.FEX
     21311**DCL     24338<<ASSIGN  24862<<ASSIGN
KL_PCD.ADDD.NMID
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:595  
     21341**DCL     21342--REDEF
KL_PCD.ADDD.TERMID.CHAN
     21324**DCL     24340<>CALL    24864<>CALL
KL_PCD.ADDD.TERMID.LEV
     21322**DCL     24339<<ASSIGN  24863<<ASSIGN
KL_PCD.ADDD.TERMID.SUB
     21325**DCL     24341<>CALL    24865<>CALL
KL_PCD.ADDD.TERMID.SUBSUB
     21326**DCL     24342<>CALL    24866<>CALL
KL_PCD.ADDD.TNAME
     21331**DCL     24346<<ASSIGN  24870<<ASSIGN
KL_PCD.ADDD.TWSN
     21333**DCL     24347<<ASSIGN  24871<<ASSIGN
KL_PCD.CGINFO.ATTR
     21393**DCL     21393--REDEF
KL_PCD.CGINFO.XTRAINFO
     21396**DCL     21398--REDEF
KL_PROBUF
     15685**DCL     24216--ASSIGN  24218--ASSIGN  24218--ASSIGN  25298--ASSIGN  25300--ASSIGN  25300--ASSIGN
KL_PROKEY
     11273**DCL     24213<<ASSIGN  25295<<ASSIGN
KL_PR_NETWORK
     17769**DCL     23801<>CALL    23825<>CALL
KL_RDBF
     11155**DCL     23600--ASSIGN  24016--ASSIGN
KL_RDBF.CODE
     11156**DCL     24018>>DOCASE
KL_RDBF.FEL#
     11158**DCL     11159--REDEF
KL_RDBF$
     11170**DCL     16406--IMP-PTR 20833--IMP-PTR 21449--IMP-PTR 21473--IMP-PTR 21497--IMP-PTR 21631--IMP-PTR
     21840--IMP-PTR 21961--IMP-PTR 22495--IMP-PTR 22519--IMP-PTR 23011--IMP-PTR 24033>>DOCASE  24039>>CALL
     24059>>ASSIGN  24066>>ASSIGN  24072>>CALL    24083>>CALL    24085>>ASSIGN  24086>>ASSIGN  24087>>ASSIGN
     24088>>ASSIGN  24089>>ASSIGN  24093>>DOINDEX 24094>>ASSIGN  24097>>ASSIGN  24097>>ASSIGN  24105>>DOINDEX
     24106>>ASSIGN  24107>>IF      24191>>ASSIGN  24362>>DOCASE  24366>>ASSIGN  24371>>CALL    24372>>CALL
     24374>>CALL    24376>>CALL    24378>>CALL    24404>>CALL    24420>>ASSIGN  24421>>ASSIGN  24422>>ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:596  
     24423>>ASSIGN  24424>>ASSIGN  24425>>CALL    24426>>ASSIGN  24446>>ASSIGN  24447>>ASSIGN  24450>>ASSIGN
     24451>>ASSIGN  24452>>ASSIGN  24453>>CALL    24455>>CALL    24457>>CALL    24467>>ASSIGN  24471>>ASSIGN
     24472>>ASSIGN  24473>>ASSIGN  24474>>ASSIGN  24475>>ASSIGN  24477>>IF      24479>>ASSIGN  24483>>IF
     24486>>ASSIGN  24489>>IF      24491>>ASSIGN  24492>>IF      24493>>ASSIGN  24494>>IF      24495>>ASSIGN
     24504>>ASSIGN  24505>>ASSIGN  25030>>CALL    25033>>CALL    25036>>ASSIGN  25039>>CALL    25046>>CALL
     25064>>CALL    25084>>ASSIGN  25085>>IF      25095>>ASSIGN  25096>>ASSIGN  25114>>IF      25115>>CALL
     25120>>ASSIGN  25123>>IF      25187>>ASSIGN  25188>>ASSIGN  25189>>ASSIGN  25190>>ASSIGN  25191>>CALL
KL_RDHLPR
     17113**DCL     24127<>CALL    24782<>CALL    24830<>CALL
KL_RDHLPR.STATION_
     17116**DCL     17117--REDEF
KL_RDHLPR.V.DVBYTE.REREAD#
     17128**DCL     17128--REDEF
KL_RDHLPR.V.INDX#
     17126**DCL     17126--REDEF
KL_RDPROR
     17152**DCL     24214<>CALL    25296<>CALL
KL_RDPROR.STATION_
     17155**DCL     17156--REDEF
KL_RDPROR.V.DVBYTE.REREAD#
     17167**DCL     17167--REDEF
KL_RDPROR.V.INDX#
     17165**DCL     17165--REDEF
KL_RD_NETCON
     17237**DCL     24207<>CALL    24247<>CALL    24276<>CALL    24291<>CALL    24531<>CALL    24546<>CALL
     24821<>CALL    25060<>CALL
KL_RD_NETCON.BUF_
     17239**DCL     24206<<ASSIGN  24245<<ASSIGN  24274<<ASSIGN  24289<<ASSIGN  24530<<ASSIGN  24545<<ASSIGN
     24812<<ASSIGN  25058<<ASSIGN
KL_RD_NETCON.KEY_
     17237**DCL     24205<<ASSIGN  24246<<ASSIGN  24275<<ASSIGN  24290<<ASSIGN  24529<<ASSIGN  24544<<ASSIGN
     24813<<ASSIGN  25059<<ASSIGN
KL_RD_NETCON.STATION_
     17240**DCL     17241--REDEF
KL_RD_NETCON.V.DVBYTE.REREAD#
     17252**DCL     17252--REDEF
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:597  
KL_RD_NETCON.V.INDX#
     17250**DCL     17250--REDEF
KL_RD_NETWORK
     17667**DCL     23804<>CALL    23808<>CALL    23826<>CALL    23974<>CALL    24743<>CALL    24774<>CALL
     25226<>CALL    25580<>CALL
KL_RD_NETWORK.KEY_
     17667**DCL     23793<<ASSIGN  23973<<ASSIGN  24740<<ASSIGN  24773<<ASSIGN  25219<<ASSIGN  25578<<ASSIGN
KL_RD_NETWORK.STATION_
     17670**DCL     17671--REDEF
KL_RD_NETWORK.V.DVBYTE.REREAD#
     17682**DCL     17682--REDEF
KL_RD_NETWORK.V.INDX#
     17680**DCL     17680--REDEF
KL_RD_NETWORK.V.KEYS#
     17672**DCL     25218<<ASSIGN  25253<<ASSIGN
KL_RSPPND$
     11187**DCL     25184>>ASSIGN
KL_STATION
     15555**DCL     24009>>IF      24013>>IF      24015>>CALLBLT 24616>>IF      24638>>IF      24675>>IF
     24705>>IF      24919>>IF      24964>>IF      24998>>IF      25132>>CALLBLT 25152>>CALLBLT 25259>>IF
     25261>>CALLBLT
KL_TMSG.FLAGS
     11221**DCL     11222--REDEF
KL_TMSG.MSGID
     11217**DCL     11218--REDEF
KL_TMSG.WSN
     11224**DCL     11225--REDEF
KL_WR_NETCON
     17276**DCL     24305<>CALL
KL_WR_NETCON.BUF_
     17276**DCL     24303<<ASSIGN
KL_WR_NETCON.KEY_
     17276**DCL     24304<<ASSIGN
KL_WR_NETCON.STATION_
     17278**DCL     17278--REDEF
KL_WR_NETCON.V.DVBYTE.VFC#
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:598  
     17285**DCL     17285--REDEF
KL_WR_NETWORK
     17706**DCL     24326<>CALL    24332<>CALL    24851<>CALL    24857<>CALL    25098<>CALL
KL_WR_NETWORK.BUF_
     17706**DCL     24850<<ASSIGN  25097<<ASSIGN  25101<<ASSIGN  25105<<ASSIGN
KL_WR_NETWORK.KEY_
     17706**DCL     24325<<ASSIGN  24331<<ASSIGN  24849<<ASSIGN  24856<<ASSIGN  25094<<ASSIGN  25100<<ASSIGN
     25104<<ASSIGN
KL_WR_NETWORK.STATION_
     17708**DCL     17708--REDEF
KL_WR_NETWORK.V.DVBYTE.VFC#
     17715**DCL     17715--REDEF
KMPW.FEPW
     15637**DCL     15640--REDEF
KMPW.FEPW.CNT
     15638**DCL     23647>>IF      23647<<ASSIGN
KMPW.FEPWT
     15640**DCL     23648>>ASSIGN
KMSG
     15624**DCL     24000<>CALL
KMSG.CADDR
     15626**DCL     23609>>ASSIGN  23948>>ASSIGN  25379>>ASSIGN  25473>>ASSIGN
KMSG.FEX
     15627**DCL     23632>>IF      25443>>ASSIGN  25458<<ASSIGN
KMSG.FID.CNT
     15630**DCL     23708>>IF      23712<<ASSIGN  25423>>IF
KMSG.FID.TXT
     15631**DCL     23710--ASSIGN
KMSG.KIN#
     15625**DCL     23602>>DOCASE  23998<<ASSIGN  25399>>IF      25459>>IF
KMSG.NAME
     15628**DCL     23938<>CALL    23940<>CALL    23947>>ASSIGN  25352>>IF      25381>>ASSIGN  25444>>IF
     25449<>CALL    25454<>CALL    25475>>ASSIGN
KYERR
     25370**LABEL   25355--GOTO
LEN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:599  
     15823**DCL     23710<<ASSIGN  23711<>CALL    23712>>ASSIGN  23765<<ASSIGN  23769<>CALL    23779<<ASSIGN
     23780<>CALL    23782<>CALL    23892<<ASSIGN  23893<>CALL    24156<<DOINDEX 24157>>ASSIGN  24158>>CALL
     24167<<ASSIGN  24168<>CALL    24177<<ASSIGN  24178<>CALL    24184<<ASSIGN  24187<>CALL    24188<>CALL
     24190<<ASSIGN  24192<>CALL    24517<<ASSIGN  24519<>CALL    25036<<ASSIGN  25037<>CALL
LINCNFG.FLAGS.REMOTE
     18410**DCL     24266<<ASSIGN  24300>>IF
LINCNFG.KHA
     18298**DCL     24250>>ASSIGN  24268<<ASSIGN  25291>>ASSIGN  25332>>ASSIGN
LINCNFG.LGN
     18415**DCL     24292<>CALL    24822<>CALL
LINCNFG.LGN.LGNSIZE
     18416**DCL     24271<<ASSIGN  24817<<ASSIGN
LINCNFG.LGN.LGNSTRING
     18417**DCL     24272<<ASSIGN  24818<<ASSIGN
LINCNFG.NA
     18378**DCL     24248>>ASSIGN  24267<<ASSIGN  25287>>ASSIGN  25330>>ASSIGN
LINCNFG.PRO
     18412**DCL     24213>>ASSIGN  25295>>ASSIGN
LINCNFG.PRO.PROSIZE
     18413**DCL     24211>>IF      24269<<ASSIGN  25293>>IF
LINCNFG.PRO.PROTXT
     18414**DCL     24270<<ASSIGN
LOCAL_CHECK
     25468**PROC    23674--CALL    23694--CALL    23716--CALL    23735--CALL
LOGOFF$PARAM
     16967**DCL     24410<>CALL
LOGOFF$PARAM.ACCUM_CHG
     16997**DCL     24408<<ASSIGN  24411>>ASSIGN
LOGOFF$PARAM.CODE
     16968**DCL     24405<<ASSIGN
LOGOFF$PARAM.DCB1
     16979**DCL     24406<<ASSIGN
LOGOFF$PARAM.DCB_LL
     16983**DCL     24407<<ASSIGN
LOGOFF$PARAM.JIT$
     16993**DCL     24409<<ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:600  
LOGSYSACCT
     16339**DCL     24432>>IF
M$DELREC
      2898**DCL-ENT 24751--CALL    24757--CALL    25087--CALL    25234--CALL    25242--CALL
M$DO
     15671**DCL     24406>>ASSIGN
M$ERRMSG
      2959**DCL-ENT 24498--CALL
M$FECTL
      2925**DCL-ENT 25393--CALL    25415--CALL    25434--CALL
M$PRECORD
      2900**DCL-ENT 23801--CALL    23825--CALL    25214--CALL    25271--CALL    25316--CALL
M$PROF
     15615**DCL     24216--ASSIGN  25298--ASSIGN
M$READ
      2897**DCL-ENT 23804--CALL    23808--CALL    23826--CALL    23868--CALL    23974--CALL    24127--CALL
     24207--CALL    24214--CALL    24247--CALL    24276--CALL    24291--CALL    24531--CALL    24546--CALL
     24743--CALL    24774--CALL    24782--CALL    24821--CALL    24830--CALL    25060--CALL    25226--CALL
     25277--CALL    25296--CALL    25306--CALL    25322--CALL    25334--CALL    25580--CALL
M$TIME
      2963**DCL-ENT 24317--CALL    24383--CALL    24386--CALL    24393--CALL    24400--CALL    24841--CALL
M$WAIT
      2954**DCL-ENT 24354--CALL    24877--CALL    25425--CALL
M$WRITE
      2897**DCL-ENT 23628--CALL    23788--CALL    23835--CALL    23854--CALL    23887--CALL    23910--CALL
     23950--CALL    23984--CALL    24045--CALL    24116--CALL    24305--CALL    24326--CALL    24332--CALL
     24413--CALL    24415--CALL    24851--CALL    24857--CALL    24913--CALL    24958--CALL    25054--CALL
     25098--CALL    25165--CALL    25205--CALL    25265--CALL    25384--CALL    25478--CALL
M$WRSYSLOG
      2945**DCL-ENT 24352--CALL    24429--CALL    24459--CALL    24876--CALL
MESS$
     15848**DCL     24097<<ASSIGN  24109>>ASSIGN  24111>>CALL    24112<<ASSIGN  24112>>ASSIGN  25173<<ASSIGN
     25175<>CALL
MONKEY
     17635**DCL     17610--DCLINIT
MONKEY.MSGIDXT
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:601  
     17645**DCL     17648--REDEF
MSGID
     15840**DCL     24061<<ASSIGN  24061>>ASSIGN  24062>>ASSIGN  24063>>ASSIGN
NA_C
     16257**DCL     24267>>ASSIGN
NETADDR IN PROCEDURE SENDCWNAK
     25487**DCL     25485--PROC    25495>>ASSIGN
NETCON_ALT
     24610**LABEL   24531--CALLALT 24534--GOTO    24546--CALLALT
NODECHG
     22989**DCL     25145<>CALL    25145--CALL
NODECHG.FCN
     22990**DCL     25136<<ASSIGN
NODECHG.HOSTNODE
     22995**DCL     25142<<ASSIGN  25144<<ASSIGN
NODECHG.MYNODE
     22993**DCL     25137<<ASSIGN
NODECHG.NODE
     22994**DCL     25138<<ASSIGN
NODECHG.QOS
     22996**DCL     25139<<ASSIGN
NODENA
     17479**DCL     24623<>CALL    24650<>CALL    24685<>CALL    24715<>CALL    24928<>CALL    24975<>CALL
     25007<>CALL    25191<>CALL
NODETYPE
     15843**DCL     23612<>CALL    23625>>IF      23625>>IF      23938<>CALL    23940<>CALL    24101<>CALL
     24343<>CALL    24617<>CALL    24639<>CALL    24642>>IF      24642>>IF      24676<>CALL    24678>>IF
     24678>>IF      24706<>CALL    24708>>IF      24708>>IF      24867<>CALL    24920<>CALL    24922>>IF
     24922>>IF      24946<>CALL    24966<>CALL    24968>>IF      24968>>IF      24999<>CALL    25001>>IF
     25001>>IF      25449<>CALL    25454<>CALL
NOFE
     17524**DCL     24618<>CALL    24660<>CALL    24694<>CALL    24724<>CALL    24934<>CALL    24984<>CALL
     25016<>CALL
NOFPRG
     17344**DCL     24147<>CALL
NOHEADER
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:602  
     15868**DCL     24262<>CALL    24292<>CALL    24822<>CALL
NOKEYINS
     23831**LABEL   23821--GOTO
NOSETUP
     15867**DCL     24262<>CALL    24292<>CALL    24822<>CALL
OFFSET
     15827**DCL     24571<<ASSIGN  24589<>CALL
OSILINKCHG
     22298**DCL     25120<<ASSIGN  25125<>CALL    25125--CALL
OSILINKCHG.MYNODE#
     22329**DCL     25121<<ASSIGN
OSILINKCHG.TERMID.TERM
     22390**DCL     22399--REDEF
OSILINK_BUF
     22248**DCL     25097--ASSIGN
OSILINK_BUF.QOS
     22279**DCL     25095<<ASSIGN
OSILINK_BUF.SNPA
     22267**DCL     25096<<ASSIGN
OSILINK_KEY
     22198**DCL     25079<<ASSIGN  25086--ASSIGN  25094--ASSIGN
OSILINK_KEY.KEY
     22200**DCL     25080--ASSIGN
OSILINK_KEY.KEY.KEYTYP
     22201**DCL     25081<<ASSIGN
OSILINK_KEY.KEY.NODE
     22202**DCL     25082<<ASSIGN
OSILINK_KEY.KEY.TERMID.LEV
     22221**DCL     25083<<ASSIGN
OSILINK_KEY.KEY.TERMID.TERM
     22221**DCL     22230--REDEF   25084<<ASSIGN
OSILINK_KEY.SIZE
     22199**DCL     25080<<ASSIGN
OUT$
     15828**DCL     24567<<ASSIGN  24571>>ASSIGN  24597>>CALL    24602<<ASSIGN  24602>>ASSIGN
PARM
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:603  
     15851**DCL     24102<<ASSIGN  24109<<ASSIGN  24109>>ASSIGN  24111<>CALL    24111<>CALL
PARM$
     15849**DCL     15850--IMP-PTR 15851--IMP-PTR 22800--IMP-PTR 23907<<ASSIGN  23908>>ASSIGN  24092<<ASSIGN
     24094>>ASSIGN  24095<<ASSIGN  24095>>ASSIGN  24098>>ASSIGN  24099<<ASSIGN  24099>>ASSIGN  24102>>ASSIGN
     24103<<ASSIGN  24103>>ASSIGN  24109>>ASSIGN  24111>>CALL    24113<<ASSIGN  24113>>ASSIGN  24135<<ASSIGN
     24138>>CALL    24139>>ASSIGN  24140>>ASSIGN  24141>>ASSIGN  24142>>CALL    24143>>ASSIGN  24144>>ASSIGN
     24145>>IF      24145>>IF      24153>>CALL    24154>>ASSIGN  24155>>ASSIGN  24157>>ASSIGN  24157>>ASSIGN
     24158>>CALL    24787<<ASSIGN  24788>>CALLBLT 24790>>ASSIGN  24791>>CALL    24791>>CALL    24791>>CALL
     24791>>CALL
PASS
     15861**DCL     24262<>CALL    24292<>CALL    24297<>CALL    24822<>CALL
PREV$
     15838**DCL     24048>>ASSIGN  24075>>ASSIGN  25154<<ASSIGN  25172>>ASSIGN  25178<<ASSIGN  25584<<ASSIGN
     25592<<ASSIGN
PRO
     15862**DCL     24262<>CALL    24292<>CALL    24822<>CALL
PSEUDO.MAX
     23563**DCL     24158<>CALL
PSIZ
     15844**DCL     15845--IMP-SIZ 18869--IMP-SIZ 24197<<ASSIGN  24199>>ASSIGN  24216<<ASSIGN  24217<>CALL
     24218>>ASSIGN  24218>>ASSIGN  24239<<ASSIGN  24241>>ASSIGN  24251>>CALL    24251>>CALL    25282<<ASSIGN
     25283>>ASSIGN  25292<>CALL    25298<<ASSIGN  25299<>CALL    25300>>ASSIGN  25300>>ASSIGN  25304<<ASSIGN
     25305>>CALL    25305>>CALL    25315<<ASSIGN  25327>>ASSIGN  25333>>CALL    25333>>CALL    25340>>ASSIGN
     25343>>CALL    25343>>CALL
RDBF$
     15619**DCL     19149--IMP-PTR 19320--IMP-PTR 19360--IMP-PTR 19492--IMP-PTR 19612--IMP-PTR 19771--IMP-PTR
     19995--IMP-PTR 20170--IMP-PTR 20425--IMP-PTR 20562--IMP-PTR 22646--IMP-PTR 23600<<ASSIGN  24016<<ASSIGN
     24123>>ASSIGN  24124>>ASSIGN  24125>>CALLBLT 24129>>CALL    24136>>ASSIGN  24138>>CALL    24139>>ASSIGN
     24140>>ASSIGN  24141>>ASSIGN  24142>>CALL    24143>>ASSIGN  24144>>ASSIGN  24147>>CALL    24153>>CALL
     24154>>ASSIGN  24155>>ASSIGN  24157>>ASSIGN  24158>>CALL    24160>>IF      24161>>ASSIGN  24162>>IF
     24163>>ASSIGN  24164>>ASSIGN  24168>>CALL    24170>>CALL    24175>>ASSIGN  24178>>CALL    24179>>CALL
     24185>>ASSIGN  24187>>CALL    24188>>CALL    24195>>IF      24200>>ASSIGN  24204>>ASSIGN  24223>>IF
     24224>>IF      24227>>IF      24232>>ASSIGN  24244>>ASSIGN  24256>>ASSIGN  24257>>ASSIGN  24258>>ASSIGN
     24261>>IF      24262>>CALL    24262>>CALL    24271>>ASSIGN  24272>>ASSIGN  24272>>ASSIGN  24288>>ASSIGN
     24314>>ASSIGN  24323>>ASSIGN  24527>>IF      24535>>ASSIGN  24536>>ASSIGN  24537>>DOINDEX 24538>>CALL
     24543>>ASSIGN  24547>>ASSIGN  24550>>ASSIGN  24551>>ASSIGN  24552>>ASSIGN  24556>>ASSIGN  24558>>CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:604  
     24565>>ASSIGN  24571>>ASSIGN  24608>>ASSIGN  24610>>ASSIGN  24613>>CALL    24617>>CALL    24618>>CALL
     24621>>ASSIGN  24622>>CALL    24623>>CALL    24625>>ASSIGN  24626>>CALL    24626>>CALL    24632>>CALL
     24632>>CALL    24639>>CALL    24646>>ASSIGN  24647>>CALL    24650>>CALL    24654>>CALL    24654>>CALL
     24660>>CALL    24664>>CALL    24664>>CALL    24669>>CALL    24669>>CALL    24676>>CALL    24682>>ASSIGN
     24683>>CALL    24685>>CALL    24689>>CALL    24689>>CALL    24694>>CALL    24698>>CALL    24698>>CALL
     24702>>CALL    24702>>CALL    24706>>CALL    24712>>ASSIGN  24713>>CALL    24715>>CALL    24719>>CALL
     24719>>CALL    24724>>CALL    24728>>CALL    24728>>CALL    24732>>IF      24734>>DOCASE  24739>>ASSIGN
     24760>>IF      24770>>ASSIGN  24803>>IF      24803>>IF      24803>>IF      24807>>IF      24809>>ASSIGN
     24818>>ASSIGN  24838>>ASSIGN  24847>>ASSIGN  24863>>ASSIGN  24864>>CALL    24865>>CALL    24866>>CALL
     24881>>ASSIGN  24893>>IF      24895>>CALL    24895>>CALL    24901>>ASSIGN  24902>>ASSIGN  24903>>ASSIGN
     24904>>ASSIGN  24905>>ASSIGN  24907>>IF      24920>>CALL    24926>>CALL    24928>>CALL    24929>>CALL
     24929>>CALL    24934>>CALL    24935>>CALL    24935>>CALL    24939>>IF      24941>>CALL    24941>>CALL
     24948>>ASSIGN  24949>>ASSIGN  24951>>IF      24965>>ASSIGN  24966>>CALL    24972>>ASSIGN  24973>>CALL
     24975>>CALL    24979>>CALL    24979>>CALL    24984>>CALL    24988>>CALL    24988>>CALL    24992>>CALL
     24992>>CALL    24999>>CALL    25005>>CALL    25007>>CALL    25011>>CALL    25011>>CALL    25016>>CALL
     25020>>CALL    25020>>CALL    25024>>CALL    25024>>CALL    25050>>CALL    25051>>ASSIGN  25052>>ASSIGN
     25053>>ASSIGN
RD_NETCON
     17796**DCL     25277<>CALL    25306<>CALL    25322<>CALL    25334<>CALL
RD_NETCON.KEY_
     17796**DCL     25275<<ASSIGN  25320<<ASSIGN
RD_NETCON.STATION_
     17799**DCL     17800--REDEF
RD_NETCON.V
     17800**DCL     17796--DCLINIT
RD_NETCON.V.DVBYTE.REREAD#
     17811**DCL     17811--REDEF
RD_NETCON.V.INDX#
     17809**DCL     17809--REDEF
READ_HLPF
     15734**DCL     23868<>CALL
READ_HLPF.BUF_.BOUND
     15736**DCL     23867<<ASSIGN
READ_HLPF.STATION_
     15737**DCL     15738--REDEF
READ_HLPF.V
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:605  
     15738**DCL     15734--DCLINIT
READ_HLPF.V.DVBYTE.REREAD#
     15749**DCL     15749--REDEF
READ_HLPF.V.INDX#
     15747**DCL     15747--REDEF
REPS IN PROCEDURE I$8TO9
     25517**DCL     25512--PROC    25530>>DOINDEX
RTN
     23999**LABEL   23896--GOTO    23912--GOTO    25384--CALLALT
RUE
     21197**DCL     23661<>CALL    23661--CALL
RUE.EVENT#
     21266**DCL     23656<<ASSIGN  23664<<ASSIGN
RUE.ORIGIN
     21207**DCL     23659<<ASSIGN
RUE.SYSID#
     21264**DCL     23660<<ASSIGN
SALL
     23761**LABEL   23757--GOTO
SENDCWNAK
     25485**PROC    24129--CALL    24147--CALL    24170--CALL    24179--CALL
SEND_ADMIN_ERR
     24723**LABEL   24711--GOTO
SEND_CHNDISP_ERR
     24693**LABEL   24681--GOTO
SEND_CNFG_MSG_ERR
     25015**LABEL   25004--GOTO
SEND_REQSTATS_ERR
     24983**LABEL   24971--GOTO
SEND_RESET_ERR
     24659**LABEL   24645--GOTO
SEND_RUE_ERR
     24933**LABEL   24925--GOTO
SIZE
     15841**DCL     15851--IMP-SIZ 21613--IMP-SIZ 24100<<ASSIGN  24102>>ASSIGN  24106<<ASSIGN  24109>>ASSIGN
     24109>>ASSIGN  24111>>CALL    24111>>CALL    24111<>CALL    24112>>ASSIGN  24113>>ASSIGN  24125<<CALLBLT
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:606  
     24126>>ASSIGN  24278<<ASSIGN  24279<>CALL    24307<<ASSIGN  24308<<ASSIGN  24308>>ASSIGN  24309<>CALL
     24423<<ASSIGN  24424>>ASSIGN  24447<<ASSIGN  24450>>ASSIGN  24612<<ASSIGN  24613<>CALL
SOURCE IN PROCEDURE I$8TO9
     25514**DCL     25512--PROC    25529--ASSIGN
SRC$ IN PROCEDURE I$8TO9
     25521**DCL     25529<<ASSIGN  25534>>ASSIGN  25537<<ASSIGN  25537>>ASSIGN
STARTNETWORK
     17086**DCL     25214<>CALL
STARTNETWORK.V
     17088**DCL     17086--DCLINIT
STFEP IN PROCEDURE BDSET
     25412**ENTRY   23696--CALL    23702--CALL
STFEPNM IN PROCEDURE BDSET
     25430**ENTRY   23719--CALL    23737--CALL    23743--CALL    24023--CALL
STOPFEP
     17909**DCL     25434<>CALL
STOPFEP.V
     17910**DCL     17909--DCLINIT
STOPFEP.V.DMPSTART#
     17910**DCL     17911--REDEF
STOPFEP.V.FEP#
     17911**DCL     25432<<ASSIGN
STPERR
     25370**LABEL   23719--CALLALT 23720--CALLALT 23737--CALLALT
STPFEP IN PROCEDURE BDSET
     25420**ENTRY   23720--CALL    23727--CALL
STPMSG
     19094**DCL     25424<>CALL    25424--CALL
STPMSG.MSG_
     19097**DCL     23711<>CALL
T$ IN PROCEDURE I$8TO9
     25523**DCL     25532<<ASSIGN  25534>>ASSIGN
TCONFIG_KEY
     15882**DCL     25320--ASSIGN
TCONFIG_KEY.NODE
     15885**DCL     25326>>DOWHILE
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:607  
TCONFIG_KEY.TERMID
     15902**DCL     25329>>ASSIGN
TCONFIG_KEY.TERMID.TERM
     15904**DCL     15913--REDEF
TCONFIG_KEY.TYP
     15884**DCL     25324<<ASSIGN  25326>>DOWHILE 25336<<ASSIGN
TDEFAULT_KEY
     15929**DCL     25275--ASSIGN
TDEFAULT_KEY.HNDLR
     15933**DCL     25286>>ASSIGN
TDEFAULT_KEY.NODE
     15932**DCL     25281>>DOWHILE
TDEFAULT_KEY.TYP
     15931**DCL     25279<<ASSIGN  25281>>DOWHILE 25308<<ASSIGN
TELL_ELF
     24766**LABEL   24882--GOTO    24889--GOTO
TEMP IN PROCEDURE I$8TO9
     25519**DCL     25533<<DOINDEX 25534>>ASSIGN  25534>>ASSIGN
TEMP2 IN PROCEDURE I$8TO9
     25520**DCL     25530<<DOINDEX
TERMID IN PROCEDURE FIND_ERRCTX
     25558**DCL     25542--PROC    25575>>ASSIGN
TERMID.TERM IN PROCEDURE FIND_ERRCTX
     25562**DCL     25571--REDEF
TERM_KEY
     16126**DCL     24275--ASSIGN  24304--ASSIGN
TERM_KEY.TERMID.TERM
     16147**DCL     16156--REDEF
TERM_KEY.TERMID.TERM.TERM_NAME
     16156**DCL     24273<<ASSIGN
TERM_REC
     16077**DCL     24274--ASSIGN  24302<<ASSIGN  24303--ASSIGN
TERM_REC.TERMID.TERM
     16099**DCL     16108--REDEF
TEXT$C
     23571**DCL     24791<>CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:608  
TEXT$C.L
     23572**DCL     23573--IMP-SIZ 24791>>CALL
TSTAMP
     16391**DCL     16387--DCLINIT
TWSN_KEY
     15666**DCL     15734--DCLINIT 15735--DCLINIT
TWSN_KEY.TWSN
     15669**DCL     23866<<ASSIGN
TWSN_REC.DEVS.IOM_CONNECTED
     15771**DCL     23873>>IF
TWSN_REC.DEVS.NUM
     15764**DCL     23870>>CALLBLT
TWSN_REC.DEVS.TDEV
     15770**DCL     23872>>IF
TWSN_REC.DEVS.TYP
     15763**DCL     23870>>CALLBLT
TWSN_REC.NDEV
     15761**DCL     23869>>DOINDEX
UBIN_HALF_BASE
     16338**DCL     23999>>ASSIGN
UNAME
     15858**DCL     24262<>CALL    24292<>CALL    24297<>CALL    24791<>CALL    24822<>CALL
UNAME.C
     15859**DCL     24789<<ASSIGN  24829>>ASSIGN
UNAME.T
     15860**DCL     24790<<ASSIGN  24828>>ASSIGN
VLR@ERRMSG
     22442**DCL     24469--ASSIGN
VLR@ERRMSG.ALTMSG
     22443**DCL     24508>>ASSIGN
VLR@ERRMSG.INERR
     22445**DCL     24511>>ASSIGN
VLR@ERRMSG.MSGCOMP
     22443**DCL     24509>>ASSIGN
VLR@ERRMSG.NNATIVE
     22444**DCL     24510>>ASSIGN
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:609  
VLR@ERRMSG.NOFILE
     22442**DCL     24506>>ASSIGN
VLR@ERRMSG.NOMSG
     22442**DCL     24507>>ASSIGN
VTXTC.CNT
     15855**DCL     15856--IMP-SIZ
WBHS.STATION_
     17965**DCL     17965--REDEF
WBHS.V
     17966**DCL     17963--DCLINIT
WBHS.V.DVBYTE.VFC#
     17972**DCL     17972--REDEF
WKBER
     17932**DCL     23628<>CALL    23835<>CALL    23854<>CALL    23887<>CALL    23910<>CALL    23950<>CALL
     23984<>CALL    24045<>CALL    24116<>CALL    24415<>CALL    24913<>CALL    24958<>CALL    25165<>CALL
     25384<>CALL    25478<>CALL
WKBER.BUF_
     17932**DCL     23610<<ASSIGN  23791<<ASSIGN  23886<<ASSIGN  23909<<ASSIGN  23949<<ASSIGN  23983<<ASSIGN
     24044<<ASSIGN  24115<<ASSIGN  24414<<ASSIGN  24906<<ASSIGN  24950<<ASSIGN  25164<<ASSIGN  25383<<ASSIGN
     25477<<ASSIGN
WKBER.STATION_
     17934**DCL     17934--REDEF
WKBER.V
     17935**DCL     17932--DCLINIT
WKBER.V.DVBYTE.VFC#
     17941**DCL     17941--REDEF
WRITE_MONKEY
     17608**DCL     23788<>CALL
WRITE_MONKEY.BUF_.BOUND
     17608**DCL     23787<<ASSIGN
WRITE_MONKEY.STATION_
     17610**DCL     17610--REDEF
WRITE_MONKEY.V
     17611**DCL     17608--DCLINIT
WRITE_MONKEY.V.DVBYTE.VFC#
     17617**DCL     17617--REDEF
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:610  
WRTSYSLOG
     24350**LABEL   24355--GOTO    24762--GOTO    24800--GOTO
WRTSYSLOG2
     24874**LABEL   24878--GOTO
WRT_ACCTLG
     16358**DCL     24413<>CALL
WRT_ACCTLG.BUF_
     16358**DCL     24412<<ASSIGN
WRT_ACCTLG.STATION_
     16360**DCL     16360--REDEF
WRT_ACCTLG.V
     16361**DCL     16358--DCLINIT
WRT_ACCTLG.V.DVBYTE.VFC#
     16367**DCL     16367--REDEF
WRT_FROG
     17574**DCL     25265<>CALL
WRT_FROG.STATION_
     17576**DCL     17576--REDEF
WRT_FROG.V.DVBYTE.VFC#
     17583**DCL     17583--REDEF
WRT_NA2FROG
     17856**DCL     25054<>CALL    25205<>CALL
WRT_NA2FROG.BUF_
     17856**DCL     25053<<ASSIGN  25204<<ASSIGN
WRT_NA2FROG.STATION_
     17858**DCL     17858--REDEF
WRT_NA2FROG.V.DVBYTE.VFC#
     17865**DCL     17865--REDEF
WR_SECLOG
     23465**DCL     24459<>CALL
WR_SECLOG.V
     23465**DCL     23465--DCLINIT
WTERR
     25377**LABEL   25363--GOTO    25368--GOTO
XUR$ERRCNVRT
     23591**DCL-ENT 24404--CALL    24425--CALL
PL6.E3A0      #005=KLI$KBOOT File=KLI$FESET.:E05TSI                              WED 07/30/97 00:52 Page:611  
XUR$ERRTOLCP6
     23592**DCL-ENT 24618--CALL    24623--CALL    24650--CALL    24660--CALL    24685--CALL    24694--CALL
     24715--CALL    24724--CALL    24928--CALL    24934--CALL    24975--CALL    24984--CALL    25007--CALL
     25016--CALL

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:612  
     3170        1        /*T***********************************************************/
     3171        2        /*T*                                                         */
     3172        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3173        4        /*T*                                                         */
     3174        5        /*T***********************************************************/
     3175        6        /*D* NAME:        KLI$LINEPRO
     3176        7             PURPOSE:     To fill in a KL_CHNRSP buffer for a line profile request
     3177        8             CALL:        CALL KLI$LINEPRO(ACCT,UNAME,PASS);
     3178        9             INPUT:       ACCT - Account (terminal name) of the line
     3179       10                          UNAME - User name of the line
     3180       11                          PASS - Password of the line
     3181       12                          KL_EXTRSP_BUF - Partially filled in
     3182       13             OUTPUT:      KL_EXTRSP_BUF - Completed being filled in especially
     3183       14                             KL$CHNRSP.NAK which is set if KLI$LINEPRO failed
     3184       15             DESCRIPTION: KLI$LINEPRO uses ACCT and UNAME to build a key into
     3185       16                          :HLP.:SYS and reads the supposed HASP, 3270 or LINK
     3186       17                          record. If the record does not exist, is the wrong
     3187       18                          kind of record, or the password is wrong, we set
     3188       19                          KL$CHNRSP.NAK and RETURN.
     3189       20                          The :HLP record is expanded with the appropriate
     3190       21                          PROFILE records from :PRO.:SYS and placed at the
     3191       22                          end of KL$CHNRSP. If any of the specified profiles
     3192       23                          are not available, we again set KL$CHNRSP.NAK
     3193       24                          and RETURN.
     3194       25
     3195       26                          If everything goes as planned, a line profile record
     3196       27                          complete with embedded profile records will have
     3197       28                          been built and tacked onto the end of KL$CHNRSP.
     3198       29                          This information is now used by KLI$AMSG, the
     3199       30                          caller, to send back to the requesting handler in
     3200       31                          some FEP. This information is used by said handler
     3201       32                          to build up context for a given line.
     3202       33        */
     3203       34        /**/
     3204       35        /**/
     3205       36        KLI$LINEPRO: PROC(ACCT,UNAME,PASS);
     3206       37        /**/
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:613  
     3207       38        /**/
     3208       39    1   DCL ACCT CHAR(8);
     3209       40    1   DCL 1 UNAME,
     3210       41    1            2 C UBIN BYTE UNAL,
     3211       42    1            2 T CHAR(12);
     3212       43    1   DCL PASS CHAR(8);
     3213       44        %INCLUDE CP_6;
     3214      125        %INCLUDE KL_DATA_R;
     3215      589        %INCLUDE KL_MACRO_C;
     3216     3941        %INCLUDE KL_SUPER_C;
     3217     6843    1   DCL M$HLPF DCB;
     3218     6844    1   DCL M$PROF DCB;
     3219     6845    1   DCL PW CHAR(8);
     3220     6846    1   DCL I UBIN;
     3221     6847    1   DCL TEMP UBIN HALF;
     3222     6848    1   DCL MSGSIZE UBIN HALF;
     3223     6849    1   DCL SIZELEFT UBIN;
     3224     6850    1   DCL CHR$SIZELEFT CHAR(SIZELEFT) BASED;
     3225     6851    1   DCL INBLKHDR$ PTR;
     3226     6852    1   DCL OUTBLKHDR$ PTR;
     3227     6853    1   DCL OUT$ PTR;
     3228     6854    1   DCL IN$ PTR;
     3229     6855        %KL_BLKHDR (NAME=KL$BLKHDR,STCLASS="BASED(INBLKHDR$)",ALGN=CALIGNED);
     3230     6950        %KL_HASP   (NAME=KL$HASP,STCLASS="BASED(INBLKHDR$)");
     3231     7100        %KL_LN3270 (NAME=KL$LN3270,STCLASS="BASED(INBLKHDR$)");
     3232     7242        %KL_LNK    (NAME=KL$LNK,STCLASS="BASED(INBLKHDR$)");
     3233     7466        %KL_LNKVC  (NAME=KL$LNKVC,STCLASS="BASED(INBLKHDR$)");
     3234     7690        %KL_LINKDEV (NAME=KL$LINKDEV,STCLASS="BASED(INBLKHDR$)");
     3235     7861        %KL_PHDR   (NAME=KL$PHDR,STCLASS=BASED);
     3236     7902        %KL_DREC   (NAME=KL_HLPR,STCLASS=SYMREF,LAST=",");
     3237     8015        %KL_GJOB   (NAME=GJOB_OR_REST,STCLASS=SYMREF,LVL=2,LAST=",");
     3238     8039    1            2 REST CHAR(1);
     3239     8040        %KL_CHNRSP (FPTN=KL$CHNRSP,STCLASS="BASED(KL_EXTRSP_BUF$)");
     3240     8260        %F$DCB;
     3241     8317        %KL_PHDR  (NAME=KL_PROBUF,STCLASS="SYMREF ALIGNED");
     3242     8358        %FPT_READ (FPTN=KL_RDHLPR,STCLASS=SYMREF);
     3243     8397        %FPT_READ (FPTN=KL_RDPROR,STCLASS=SYMREF);
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:614  
     3244     8436    1   DCL ASZ$SCRAMBLE ENTRY(1);
     3245     8437    1   DCL KLX$8TO9 ENTRY(3);
     3246     8438    1   DCL KLX$9TO8 ENTRY(3);
     3247     8439
     3248     8440    1        KL_NETWORK_VALID = '0'B;
     3249     8441    1        KL_HLPKEY.ACCT=ACCT;
     3250     8442    1        KL_HLPKEY.NAME=UNAME.T;
     3251     8443    1        KL_HLPKEY.CNT=8+UNAME.C;
     3252     8444    2        CALL M$READ(KL_RDHLPR) WHENALTRETURN DO;
     3253     8445    2   ALTOUT:   KL$CHNRSP.NAK='1'B;
     3254     8446    2             KL$CHNRSP.MESSAGE.MSGSIZE='0'B;
     3255     8447    2             RETURN;
     3256     8448    2           END;
     3257     8449    1        PW=PASS;
     3258     8450    1        CALL ASZ$SCRAMBLE(PW);
     3259     8451    1        IF PW~=KL_HLPR.PASSWORD THEN GOTO ALTOUT;
     3260     8452    2        DO CASE(KL_HLPR.ATYP);
     3261     8453    2        CASE(ELSE);
     3262     8454    2           GOTO ALTOUT;
     3263     8455    2        CASE(%KLAT_TRM#);
     3264     8456    2           INBLKHDR$=ADDR(KL_HLPR.REST);
     3265     8457    2        CASE(%KLAT_LINE#);
     3266     8458    2           INBLKHDR$=ADDR(KL_HLPR.GJOB_OR_REST);
     3267     8459    2        CASE(%KLAT_LNKLINE#);
     3268     8460    2           INBLKHDR$=ADDR(KL_HLPR.GJOB_OR_REST);
     3269     8461    2        END;                               /* CASE KL_HLPR.ATYP */
     3270     8462    1        OUT$=ADDR(KL$CHNRSP.MESSAGE.MESSAGE);
     3271     8463    1        IN$=INBLKHDR$;
     3272     8464    1        MSGSIZE=DCBADDR(DCBNUM(M$HLPF))->F$DCB.ARS#
     3273     8465    1             -POFFC(INBLKHDR$,ADDR(KL_HLPR));
     3274     8466    2        DO CASE(KL$BLKHDR.BLKTYP);
     3275     8467    2        CASE(ELSE);
     3276     8468    2           GOTO ALTOUT;
     3277     8469    2        CASE(%KLTY_STRM#);
     3278     8470    2           OUT$->KL$HASP=KL$HASP;
     3279     8471    2           SIZELEFT=MSGSIZE-SIZEC(KL$HASP);
     3280     8472    2           IN$=PINCRC(IN$,SIZEC(KL$HASP));
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:615  
     3281     8473    2           OUTBLKHDR$=OUT$;
     3282     8474    2           OUT$=PINCRC(OUT$,SIZEC(KL$HASP));
     3283     8475    2           CALL GETPRO(KL_HLPR.PNAME,OUTBLKHDR$->KL$BLKHDR) ALTRET(ALTOUT);
     3284     8476    2           OUT$->CHR$SIZELEFT=IN$->CHR$SIZELEFT;
     3285     8477    2        CASE(%KLTY_3270#);
     3286     8478    2           OUT$->KL$LN3270=KL$LN3270;
     3287     8479    2           SIZELEFT=MSGSIZE-SIZEC(KL$LN3270);
     3288     8480    2           IN$=PINCRC(IN$,SIZEC(KL$LN3270));
     3289     8481    2           OUTBLKHDR$=OUT$;
     3290     8482    2           OUT$=PINCRC(OUT$,SIZEC(KL$LN3270));
     3291     8483    2           CALL GETPRO(KL_HLPR.PNAME,OUTBLKHDR$->KL$BLKHDR) ALTRET(ALTOUT);
     3292     8484    2           OUT$->CHR$SIZELEFT=IN$->CHR$SIZELEFT;
     3293     8485    2        CASE(%KLTY_LINK#);
     3294     8486    2           OUT$->KL$LNK=KL$LNK;
     3295     8487    2           CALL KLX$9TO8(KL$LNK.LIC,OUT$->KL$LNK.LIC,2);
     3296     8488    2           CALL KLX$9TO8(KL$LNK.HIC,OUT$->KL$LNK.HIC,2);
     3297     8489    2           CALL KLX$9TO8(KL$LNK.LOC,OUT$->KL$LNK.LOC,2);
     3298     8490    2           CALL KLX$9TO8(KL$LNK.HOC,OUT$->KL$LNK.HOC,2);
     3299     8491    2           CALL KLX$8TO9(KL$LNK.BLKHDR.LEN,TEMP,2);
     3300     8492    2           IN$ = PINCRC(IN$,TEMP);
     3301     8493    2           OUTBLKHDR$=OUT$;
     3302     8494    2           OUT$=PINCRC(OUT$,TEMP);
     3303     8495    2           CALL GETPRO(KL_HLPR.PNAME,OUTBLKHDR$->KL$BLKHDR) ALTRET(ALTOUT);
     3304     8496    2           TEMP = OUTBLKHDR$->KL$BLKHDR.PROOFFSET; /* set proofile offset*/
     3305     8497    2           CALL GETPRO(KL$LNK.DFLTVCPRO,OUTBLKHDR$->KL$BLKHDR);
     3306     8498    2           OUTBLKHDR$->KL$BLKHDR.PROOFFSET = TEMP;
     3307     8499    2           IF KL$LNK.BLKHDR.NSUBS>0 THEN
     3308     8500    3           DO I=0 TO KL$LNK.BLKHDR.NSUBS-1;
     3309     8501    4                IF IN$->KL$LNK.BLKHDR.BLKTYP = %KLTY_LINKDEV# THEN DO;
     3310     8502    4                     OUT$->KL$LINKDEV = IN$->KL$LINKDEV;
     3311     8503    4                     CALL KLX$9TO8(IN$->KL$LINKDEV.CIRCUITS#,OUT$->KL$LINKDEV.CIRCUITS#
              8503                              ,2);
     3312     8504    4                     IN$ = PINCRC(IN$,SIZEC(KL$LINKDEV));
     3313     8505    4                     OUT$ = PINCRC(OUT$,SIZEC(KL$LINKDEV));
     3314     8506    4                   END;
     3315     8507    4                ELSE DO;
     3316     8508    4                     OUT$->KL$LNKVC=IN$->KL$LNKVC;
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:616  
     3317     8509    4                     IN$=PINCRC(IN$,SIZEC(KL$LNKVC));
     3318     8510    4                     OUTBLKHDR$=OUT$;
     3319     8511    4                     OUT$=PINCRC(OUT$,SIZEC(KL$LNKVC));
     3320     8512    4                     CALL GETPRO(OUTBLKHDR$->KL$LNKVC.PRONM,OUTBLKHDR$->KL$BLKHDR)
     3321     8513    4                          ALTRET(ALTOUT);
     3322     8514    4                   END;
     3323     8515    3              END;
     3324     8516    2        END;                               /* CASE KL$BLKHDR.BLKTYP */
     3325     8517    1        CALL KLX$9TO8(MSGSIZE,KL$CHNRSP.MESSAGE.MSGSIZE,2);
     3326     8518    1        RETURN;
     3327     8519        %EJECT;
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:617  
     3328     8520    1   GETPRO: PROC(PRO,BLKHDR) ALTRET;
     3329     8521    2   DCL 1 PRO CALIGNED,
     3330     8522    2            2 LEN UBIN BYTE UNAL,
     3331     8523    2            2 TXT CHAR(11);
     3332     8524        %KL_BLKHDR(NAME=BLKHDR,STCLASS=PARAM,ALGN=CALIGNED);
     3333     8619    2   DCL PSIZ UBIN;
     3334     8620    2   DCL TEMP UBIN HALF;
     3335     8621    2   DCL CHR$PSIZ CHAR(PSIZ) BASED;
     3336     8622
     3337     8623    2        IF PRO.LEN=0 THEN RETURN;
     3338     8624    2        KL_PROKEY=PRO;
     3339     8625    3        CALL M$READ(KL_RDPROR) WHENALTRETURN DO;
     3340     8626    3             ALTRETURN;
     3341     8627    3           END;
     3342     8628    2        PSIZ=DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS#-SIZEC(KL$PHDR);
     3343     8629    2        OUT$->CHR$PSIZ=PINCRC(ADDR(KL_PROBUF),SIZEC(KL$PHDR))->CHR$PSIZ;
     3344     8630    2        MSGSIZE=MSGSIZE+PSIZ;
     3345     8631    2        CALL KLX$8TO9(BLKHDR.LEN,TEMP,2);
     3346     8632    2        TEMP=TEMP+PSIZ;
     3347     8633    2        CALL KLX$9TO8(TEMP,BLKHDR.LEN,2);
     3348     8634    2        BLKHDR.PROOFFSET=POFFC(OUT$,ADDR(BLKHDR));
     3349     8635    2        OUT$=PINCRC(OUT$,PSIZ);
     3350     8636    2        RETURN;
     3351     8637    2   END GETPRO;
     3352     8638    1   END KLI$LINEPRO;

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:618  
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$LINEPRO.

   Procedure KLI$LINEPRO requires 405 words for executable code.
   Procedure KLI$LINEPRO requires 26 words of local(AUTO) storage.

    No errors detected in file KLI$FESET.:E05TSI    .

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:619  

 Object Unit name= KLI$LINEPRO                                File name= KLI$FESET.:E05TOU
 UTS= JUL 30 '97 00:57:33.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$HLP
    2   DCB   even  none     0      0  M$HLPF
    3   DCB   even  none     0      0  M$PROF
    4   Proc  even  none   405    625  KLI$LINEPRO
    5  RoData even  none    10     12  KLI$LINEPRO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        3  KLI$LINEPRO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 ASZ$SCRAMBLE
         yes           Std       3 KLX$9TO8
         yes           Std       3 KLX$8TO9
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:620  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$HLP                                 KL_NETWORK_VALID
     KL_HLPKEY                             KL_PROKEY                             KL_EXTRSP_BUF$
     M$HLPF                                M$PROF                                KL_HLPR
     KL_PROBUF                             KL_RDHLPR                             KL_RDPROR
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:621  


     3170        1        /*T***********************************************************/
     3171        2        /*T*                                                         */
     3172        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3173        4        /*T*                                                         */
     3174        5        /*T***********************************************************/
     3175        6        /*D* NAME:        KLI$LINEPRO
     3176        7             PURPOSE:     To fill in a KL_CHNRSP buffer for a line profile request
     3177        8             CALL:        CALL KLI$LINEPRO(ACCT,UNAME,PASS);
     3178        9             INPUT:       ACCT - Account (terminal name) of the line
     3179       10                          UNAME - User name of the line
     3180       11                          PASS - Password of the line
     3181       12                          KL_EXTRSP_BUF - Partially filled in
     3182       13             OUTPUT:      KL_EXTRSP_BUF - Completed being filled in especially
     3183       14                             KL$CHNRSP.NAK which is set if KLI$LINEPRO failed
     3184       15             DESCRIPTION: KLI$LINEPRO uses ACCT and UNAME to build a key into
     3185       16                          :HLP.:SYS and reads the supposed HASP, 3270 or LINK
     3186       17                          record. If the record does not exist, is the wrong
     3187       18                          kind of record, or the password is wrong, we set
     3188       19                          KL$CHNRSP.NAK and RETURN.
     3189       20                          The :HLP record is expanded with the appropriate
     3190       21                          PROFILE records from :PRO.:SYS and placed at the
     3191       22                          end of KL$CHNRSP. If any of the specified profiles
     3192       23                          are not available, we again set KL$CHNRSP.NAK
     3193       24                          and RETURN.
     3194       25
     3195       26                          If everything goes as planned, a line profile record
     3196       27                          complete with embedded profile records will have
     3197       28                          been built and tacked onto the end of KL$CHNRSP.
     3198       29                          This information is now used by KLI$AMSG, the
     3199       30                          caller, to send back to the requesting handler in
     3200       31                          some FEP. This information is used by said handler
     3201       32                          to build up context for a given line.
     3202       33        */
     3203       34        /**/
     3204       35        /**/
     3205       36        KLI$LINEPRO: PROC(ACCT,UNAME,PASS);
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:622  

     36  4 000000   000000 700200 xent  KLI$LINEPRO  TSX0  ! X66_AUTO_3
         4 000001   000032 000003                    ZERO    26,3

     3206       37        /**/
     3207       38        /**/
     3208       39    1   DCL ACCT CHAR(8);
     3209       40    1   DCL 1 UNAME,
     3210       41    1            2 C UBIN BYTE UNAL,
     3211       42    1            2 T CHAR(12);
     3212       43    1   DCL PASS CHAR(8);
     3213       44        %INCLUDE CP_6;
     3214      125        %INCLUDE KL_DATA_R;
     3215      589        %INCLUDE KL_MACRO_C;
     3216     3941        %INCLUDE KL_SUPER_C;
     3217     6843    1   DCL M$HLPF DCB;
     3218     6844    1   DCL M$PROF DCB;
     3219     6845    1   DCL PW CHAR(8);
     3220     6846    1   DCL I UBIN;
     3221     6847    1   DCL TEMP UBIN HALF;
     3222     6848    1   DCL MSGSIZE UBIN HALF;
     3223     6849    1   DCL SIZELEFT UBIN;
     3224     6850    1   DCL CHR$SIZELEFT CHAR(SIZELEFT) BASED;
     3225     6851    1   DCL INBLKHDR$ PTR;
     3226     6852    1   DCL OUTBLKHDR$ PTR;
     3227     6853    1   DCL OUT$ PTR;
     3228     6854    1   DCL IN$ PTR;
     3229     6855        %KL_BLKHDR (NAME=KL$BLKHDR,STCLASS="BASED(INBLKHDR$)",ALGN=CALIGNED);
     3230     6950        %KL_HASP   (NAME=KL$HASP,STCLASS="BASED(INBLKHDR$)");
     3231     7100        %KL_LN3270 (NAME=KL$LN3270,STCLASS="BASED(INBLKHDR$)");
     3232     7242        %KL_LNK    (NAME=KL$LNK,STCLASS="BASED(INBLKHDR$)");
     3233     7466        %KL_LNKVC  (NAME=KL$LNKVC,STCLASS="BASED(INBLKHDR$)");
     3234     7690        %KL_LINKDEV (NAME=KL$LINKDEV,STCLASS="BASED(INBLKHDR$)");
     3235     7861        %KL_PHDR   (NAME=KL$PHDR,STCLASS=BASED);
     3236     7902        %KL_DREC   (NAME=KL_HLPR,STCLASS=SYMREF,LAST=",");
     3237     8015        %KL_GJOB   (NAME=GJOB_OR_REST,STCLASS=SYMREF,LVL=2,LAST=",");
     3238     8039    1            2 REST CHAR(1);
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:623  
     3239     8040        %KL_CHNRSP (FPTN=KL$CHNRSP,STCLASS="BASED(KL_EXTRSP_BUF$)");
     3240     8260        %F$DCB;
     3241     8317        %KL_PHDR  (NAME=KL_PROBUF,STCLASS="SYMREF ALIGNED");
     3242     8358        %FPT_READ (FPTN=KL_RDHLPR,STCLASS=SYMREF);
     3243     8397        %FPT_READ (FPTN=KL_RDPROR,STCLASS=SYMREF);
     3244     8436    1   DCL ASZ$SCRAMBLE ENTRY(1);
     3245     8437    1   DCL KLX$8TO9 ENTRY(3);
     3246     8438    1   DCL KLX$9TO8 ENTRY(3);
     3247     8439
     3248     8440    1        KL_NETWORK_VALID = '0'B;

   8440  4 000002   000000 450000 xsym               STZ     KL_NETWORK_VALID

     3249     8441    1        KL_HLPKEY.ACCT=ACCT;

   8441  4 000003   200003 470500                    LDP0    @ACCT,,AUTO
         4 000004   040000 100500                    MLR     fill='040'O
         4 000005   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000006   000000 200010 xsym               ADSC9   KL_HLPKEY                cn=1,n=8

     3250     8442    1        KL_HLPKEY.NAME=UNAME.T;

   8442  4 000007   200004 471500                    LDP1    @UNAME,,AUTO
         4 000010   040000 100500                    MLR     fill='040'O
         4 000011   100000 200014                    ADSC9   0,,PR1                   cn=1,n=12
         4 000012   000002 200014 xsym               ADSC9   KL_HLPKEY+2              cn=1,n=12

     3251     8443    1        KL_HLPKEY.CNT=8+UNAME.C;

   8443  4 000013   000100 101500                    MRL     fill='000'O
         4 000014   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 000015   200026 000004                    ADSC9   TEMP+2,,AUTO             cn=0,n=4
         4 000016   200026 236100                    LDQ     TEMP+2,,AUTO
         4 000017   000010 036007                    ADLQ    8,DL
         4 000020   000033 736000                    QLS     27
         4 000021   000000 552040 xsym               STBQ    KL_HLPKEY,'40'O

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:624  
     3252     8444    2        CALL M$READ(KL_RDHLPR) WHENALTRETURN DO;

   8444  4 000022   000000 630400 xsym               EPPR0   KL_RDHLPR
         4 000023   440000 713400                    CLIMB   alt,read
         4 000024   401400 401760                    pmme    nvectors=4
         4 000025   000027 702000 4                  TSX2    ALTOUT
         4 000026   000036 710000 4                  TRA     s:8449

     3253     8445    2   ALTOUT:   KL$CHNRSP.NAK='1'B;

   8445  4 000027   000000 470400 xsym  ALTOUT       LDP0    KL_EXTRSP_BUF$
         4 000030   000020 236003                    LDQ     16,DU
         4 000031   000000 256100                    ORSQ    0,,PR0

     3254     8446    2             KL$CHNRSP.MESSAGE.MSGSIZE='0'B;

   8446  4 000032   000000 220003                    LDX0    0,DU
         4 000033   000000 470400 xsym               LDP0    KL_EXTRSP_BUF$
         4 000034   000015 740100                    STX0    13,,PR0

     3255     8447    2             RETURN;

   8447  4 000035   000000 702200 xent               TSX2  ! X66_ARET

     3256     8448    2           END;
     3257     8449    1        PW=PASS;

   8449  4 000036   200005 470500                    LDP0    @PASS,,AUTO
         4 000037   040100 100500                    MLR     fill='040'O
         4 000040   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000041   200006 000010                    ADSC9   PW,,AUTO                 cn=0,n=8

     3258     8450    1        CALL ASZ$SCRAMBLE(PW);

   8450  4 000042   200006 631500                    EPPR1   PW,,AUTO
         4 000043   200026 451500                    STP1    TEMP+2,,AUTO
         4 000044   200026 630500                    EPPR0   TEMP+2,,AUTO
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:625  
         4 000045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000046   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 000047   000000 011000                    NOP     0

     3259     8451    1        IF PW~=KL_HLPR.PASSWORD THEN GOTO ALTOUT;

   8451  4 000050   040000 106500                    CMPC    fill='040'O
         4 000051   200006 000010                    ADSC9   PW,,AUTO                 cn=0,n=8
         4 000052   000002 000010 xsym               ADSC9   KL_HLPR+2                cn=0,n=8
         4 000053   000027 601000 4                  TNZ     ALTOUT

     3260     8452    2        DO CASE(KL_HLPR.ATYP);

   8452  4 000054   000000 236000 xsym               LDQ     KL_HLPR
         4 000055   000033 772000                    QRL     27
         4 000056   000004 136007                    SBLQ    4,DL
         4 000057   000003 116007                    CMPQ    3,DL
         4 000060   000062 602006 4                  TNC     s:8452+6,QL
         4 000061   000065 710000 4                  TRA     s:8454
         4 000062   000066 710000 4                  TRA     s:8456
         4 000063   000071 710000 4                  TRA     s:8458
         4 000064   000074 710000 4                  TRA     s:8460

     3261     8453    2        CASE(ELSE);

     3262     8454    2           GOTO ALTOUT;

   8454  4 000065   000027 710000 4                  TRA     ALTOUT

     3263     8455    2        CASE(%KLAT_TRM#);

     3264     8456    2           INBLKHDR$=ADDR(KL_HLPR.REST);

   8456  4 000066   000000 236000 5                  LDQ     0
         4 000067   200014 756100                    STQ     INBLKHDR$,,AUTO
         4 000070   000076 710000 4                  TRA     s:8462

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:626  
     3265     8457    2        CASE(%KLAT_LINE#);

     3266     8458    2           INBLKHDR$=ADDR(KL_HLPR.GJOB_OR_REST);

   8458  4 000071   000001 236000 5                  LDQ     1
         4 000072   200014 756100                    STQ     INBLKHDR$,,AUTO
         4 000073   000076 710000 4                  TRA     s:8462

     3267     8459    2        CASE(%KLAT_LNKLINE#);

     3268     8460    2           INBLKHDR$=ADDR(KL_HLPR.GJOB_OR_REST);

   8460  4 000074   000001 236000 5                  LDQ     1
         4 000075   200014 756100                    STQ     INBLKHDR$,,AUTO

     3269     8461    2        END;                               /* CASE KL_HLPR.ATYP */

     3270     8462    1        OUT$=ADDR(KL$CHNRSP.MESSAGE.MESSAGE);

   8462  4 000076   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
         4 000077   000002 036000 5                  ADLQ    2
         4 000100   200016 756100                    STQ     OUT$,,AUTO

     3271     8463    1        IN$=INBLKHDR$;

   8463  4 000101   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000102   200017 756100                    STQ     IN$,,AUTO

     3272     8464    1        MSGSIZE=DCBADDR(DCBNUM(M$HLPF))->F$DCB.ARS#

   8464  4 000103   000000 236007 xsym               LDQ     M$HLPF,DL
         4 000104   000003 470400 5                  LDP0    3
         4 000105   000000 471500                    LDP1    0,,PR0
         4 000106   100000 473506                    LDP3    0,QL,PR1
         4 000107   000004 236000 5                  LDQ     4
         4 000110   000020 772000                    QRL     16
         4 000111   200026 756100                    STQ     TEMP+2,,AUTO
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:627  
         4 000112   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000113   000020 772000                    QRL     16
         4 000114   200026 136100                    SBLQ    TEMP+2,,AUTO
         4 000115   200027 756100                    STQ     TEMP+3,,AUTO
         4 000116   300000 236100                    LDQ     0,,PR3
         4 000117   200027 136100                    SBLQ    TEMP+3,,AUTO
         4 000120   000000 620006                    EAX0    0,QL
         4 000121   200012 740100                    STX0    MSGSIZE,,AUTO

     3273     8465    1             -POFFC(INBLKHDR$,ADDR(KL_HLPR));
     3274     8466    2        DO CASE(KL$BLKHDR.BLKTYP);

   8466  4 000122   200014 473500                    LDP3    INBLKHDR$,,AUTO
         4 000123   000100 101500                    MRL     fill='000'O
         4 000124   300001 000001                    ADSC9   1,,PR3                   cn=0,n=1
         4 000125   200026 000002                    ADSC9   TEMP+2,,AUTO             cn=0,n=2
         4 000126   200026 221100                    LDX1    TEMP+2,,AUTO
         4 000127   000010 101003                    CMPX1   8,DU
         4 000130   000132 602011 4                  TNC     s:8466+8,X1
         4 000131   000142 710000 4                  TRA     s:8468
         4 000132   000142 710000 4                  TRA     s:8468
         4 000133   000142 710000 4                  TRA     s:8468
         4 000134   000142 710000 4                  TRA     s:8468
         4 000135   000143 710000 4                  TRA     s:8470
         4 000136   000233 710000 4                  TRA     s:8486
         4 000137   000142 710000 4                  TRA     s:8468
         4 000140   000142 710000 4                  TRA     s:8468
         4 000141   000177 710000 4                  TRA     s:8478

     3275     8467    2        CASE(ELSE);

     3276     8468    2           GOTO ALTOUT;

   8468  4 000142   000027 710000 4                  TRA     ALTOUT

     3277     8469    2        CASE(%KLTY_STRM#);

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:628  
     3278     8470    2           OUT$->KL$HASP=KL$HASP;

   8470  4 000143   200016 474500                    LDP4    OUT$,,AUTO
         4 000144   000100 100500                    MLR     fill='000'O
         4 000145   300000 000134                    ADSC9   0,,PR3                   cn=0,n=92
         4 000146   400000 000134                    ADSC9   0,,PR4                   cn=0,n=92

     3279     8471    2           SIZELEFT=MSGSIZE-SIZEC(KL$HASP);

   8471  4 000147   200012 235100                    LDA     MSGSIZE,,AUTO
         4 000150   000022 771000                    ARL     18
         4 000151   000134 135007                    SBLA    92,DL
         4 000152   200013 755100                    STA     SIZELEFT,,AUTO

     3280     8472    2           IN$=PINCRC(IN$,SIZEC(KL$HASP));

   8472  4 000153   200017 236100                    LDQ     IN$,,AUTO
         4 000154   000027 036003                    ADLQ    23,DU
         4 000155   200017 756100                    STQ     IN$,,AUTO

     3281     8473    2           OUTBLKHDR$=OUT$;

   8473  4 000156   200016 236100                    LDQ     OUT$,,AUTO
         4 000157   200015 756100                    STQ     OUTBLKHDR$,,AUTO

     3282     8474    2           OUT$=PINCRC(OUT$,SIZEC(KL$HASP));

   8474  4 000160   000027 036003                    ADLQ    23,DU
         4 000161   200016 756100                    STQ     OUT$,,AUTO

     3283     8475    2           CALL GETPRO(KL_HLPR.PNAME,OUTBLKHDR$->KL$BLKHDR) ALTRET(ALTOUT);

   8475  4 000162   200015 236100                    LDQ     OUTBLKHDR$,,AUTO
         4 000163   200022 756100                    STQ     @PRO+1,,AUTO
         4 000164   000005 236000 5                  LDQ     5
         4 000165   200021 756100                    STQ     IN$+2,,AUTO
         4 000166   000504 701000 4                  TSX1    GETPRO
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:629  
         4 000167   000027 702000 4                  TSX2    ALTOUT

     3284     8476    2           OUT$->CHR$SIZELEFT=IN$->CHR$SIZELEFT;

   8476  4 000170   200017 470500                    LDP0    IN$,,AUTO
         4 000171   200013 720100                    LXL0    SIZELEFT,,AUTO
         4 000172   200016 471500                    LDP1    OUT$,,AUTO
         4 000173   040140 100540                    MLR     fill='040'O
         4 000174   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 000175   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         4 000176   000470 710000 4                  TRA     s:8517

     3285     8477    2        CASE(%KLTY_3270#);

     3286     8478    2           OUT$->KL$LN3270=KL$LN3270;

   8478  4 000177   200016 474500                    LDP4    OUT$,,AUTO
         4 000200   000100 100500                    MLR     fill='000'O
         4 000201   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
         4 000202   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

     3287     8479    2           SIZELEFT=MSGSIZE-SIZEC(KL$LN3270);

   8479  4 000203   200012 235100                    LDA     MSGSIZE,,AUTO
         4 000204   000022 771000                    ARL     18
         4 000205   000014 135007                    SBLA    12,DL
         4 000206   200013 755100                    STA     SIZELEFT,,AUTO

     3288     8480    2           IN$=PINCRC(IN$,SIZEC(KL$LN3270));

   8480  4 000207   200017 236100                    LDQ     IN$,,AUTO
         4 000210   000003 036003                    ADLQ    3,DU
         4 000211   200017 756100                    STQ     IN$,,AUTO

     3289     8481    2           OUTBLKHDR$=OUT$;

   8481  4 000212   200016 236100                    LDQ     OUT$,,AUTO
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:630  
         4 000213   200015 756100                    STQ     OUTBLKHDR$,,AUTO

     3290     8482    2           OUT$=PINCRC(OUT$,SIZEC(KL$LN3270));

   8482  4 000214   000003 036003                    ADLQ    3,DU
         4 000215   200016 756100                    STQ     OUT$,,AUTO

     3291     8483    2           CALL GETPRO(KL_HLPR.PNAME,OUTBLKHDR$->KL$BLKHDR) ALTRET(ALTOUT);

   8483  4 000216   200015 236100                    LDQ     OUTBLKHDR$,,AUTO
         4 000217   200022 756100                    STQ     @PRO+1,,AUTO
         4 000220   000005 236000 5                  LDQ     5
         4 000221   200021 756100                    STQ     IN$+2,,AUTO
         4 000222   000504 701000 4                  TSX1    GETPRO
         4 000223   000027 702000 4                  TSX2    ALTOUT

     3292     8484    2           OUT$->CHR$SIZELEFT=IN$->CHR$SIZELEFT;

   8484  4 000224   200017 470500                    LDP0    IN$,,AUTO
         4 000225   200013 720100                    LXL0    SIZELEFT,,AUTO
         4 000226   200016 471500                    LDP1    OUT$,,AUTO
         4 000227   040140 100540                    MLR     fill='040'O
         4 000230   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 000231   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         4 000232   000470 710000 4                  TRA     s:8517

     3293     8485    2        CASE(%KLTY_LINK#);

     3294     8486    2           OUT$->KL$LNK=KL$LNK;

   8486  4 000233   200016 474500                    LDP4    OUT$,,AUTO
         4 000234   000100 100500                    MLR     fill='000'O
         4 000235   300000 000060                    ADSC9   0,,PR3                   cn=0,n=48
         4 000236   400000 000060                    ADSC9   0,,PR4                   cn=0,n=48

     3295     8487    2           CALL KLX$9TO8(KL$LNK.LIC,OUT$->KL$LNK.LIC,2);

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:631  
   8487  4 000237   000006 236000 5                  LDQ     6
         4 000240   200030 756100                    STQ     TEMP+4,,AUTO
         4 000241   200016 236100                    LDQ     OUT$,,AUTO
         4 000242   000004 036003                    ADLQ    4,DU
         4 000243   200027 756100                    STQ     TEMP+3,,AUTO
         4 000244   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000245   000004 036003                    ADLQ    4,DU
         4 000246   200026 756100                    STQ     TEMP+2,,AUTO
         4 000247   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000250   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000251   000000 701000 xent               TSX1    KLX$9TO8
         4 000252   000000 011000                    NOP     0

     3296     8488    2           CALL KLX$9TO8(KL$LNK.HIC,OUT$->KL$LNK.HIC,2);

   8488  4 000253   000006 236000 5                  LDQ     6
         4 000254   200030 756100                    STQ     TEMP+4,,AUTO
         4 000255   200016 236100                    LDQ     OUT$,,AUTO
         4 000256   000007 036000 5                  ADLQ    7
         4 000257   200027 756100                    STQ     TEMP+3,,AUTO
         4 000260   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000261   000007 036000 5                  ADLQ    7
         4 000262   200026 756100                    STQ     TEMP+2,,AUTO
         4 000263   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000264   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000265   000000 701000 xent               TSX1    KLX$9TO8
         4 000266   000000 011000                    NOP     0

     3297     8489    2           CALL KLX$9TO8(KL$LNK.LOC,OUT$->KL$LNK.LOC,2);

   8489  4 000267   000006 236000 5                  LDQ     6
         4 000270   200030 756100                    STQ     TEMP+4,,AUTO
         4 000271   200016 236100                    LDQ     OUT$,,AUTO
         4 000272   000005 036003                    ADLQ    5,DU
         4 000273   200027 756100                    STQ     TEMP+3,,AUTO
         4 000274   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000275   000005 036003                    ADLQ    5,DU
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:632  
         4 000276   200026 756100                    STQ     TEMP+2,,AUTO
         4 000277   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000300   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000301   000000 701000 xent               TSX1    KLX$9TO8
         4 000302   000000 011000                    NOP     0

     3298     8490    2           CALL KLX$9TO8(KL$LNK.HOC,OUT$->KL$LNK.HOC,2);

   8490  4 000303   000006 236000 5                  LDQ     6
         4 000304   200030 756100                    STQ     TEMP+4,,AUTO
         4 000305   200016 236100                    LDQ     OUT$,,AUTO
         4 000306   000010 036000 5                  ADLQ    8
         4 000307   200027 756100                    STQ     TEMP+3,,AUTO
         4 000310   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000311   000010 036000 5                  ADLQ    8
         4 000312   200026 756100                    STQ     TEMP+2,,AUTO
         4 000313   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000314   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000315   000000 701000 xent               TSX1    KLX$9TO8
         4 000316   000000 011000                    NOP     0

     3299     8491    2           CALL KLX$8TO9(KL$LNK.BLKHDR.LEN,TEMP,2);

   8491  4 000317   000006 236000 5                  LDQ     6
         4 000320   200030 756100                    STQ     TEMP+4,,AUTO
         4 000321   200011 630500                    EPPR0   TEMP,,AUTO
         4 000322   200027 450500                    STP0    TEMP+3,,AUTO
         4 000323   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000324   400000 036007                    ADLQ    -131072,DL
         4 000325   200026 756100                    STQ     TEMP+2,,AUTO
         4 000326   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000327   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000330   000000 701000 xent               TSX1    KLX$8TO9
         4 000331   000000 011000                    NOP     0

     3300     8492    2           IN$ = PINCRC(IN$,TEMP);

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:633  
   8492  4 000332   200011 236100                    LDQ     TEMP,,AUTO
         4 000333   777777 376003                    ANQ     -1,DU
         4 000334   000002 772000                    QRL     2
         4 000335   200017 036100                    ADLQ    IN$,,AUTO
         4 000336   200017 756100                    STQ     IN$,,AUTO

     3301     8493    2           OUTBLKHDR$=OUT$;

   8493  4 000337   200016 236100                    LDQ     OUT$,,AUTO
         4 000340   200015 756100                    STQ     OUTBLKHDR$,,AUTO

     3302     8494    2           OUT$=PINCRC(OUT$,TEMP);

   8494  4 000341   200011 236100                    LDQ     TEMP,,AUTO
         4 000342   777777 376003                    ANQ     -1,DU
         4 000343   000002 772000                    QRL     2
         4 000344   200016 036100                    ADLQ    OUT$,,AUTO
         4 000345   200016 756100                    STQ     OUT$,,AUTO

     3303     8495    2           CALL GETPRO(KL_HLPR.PNAME,OUTBLKHDR$->KL$BLKHDR) ALTRET(ALTOUT);

   8495  4 000346   200015 236100                    LDQ     OUTBLKHDR$,,AUTO
         4 000347   200022 756100                    STQ     @PRO+1,,AUTO
         4 000350   000005 236000 5                  LDQ     5
         4 000351   200021 756100                    STQ     IN$+2,,AUTO
         4 000352   000504 701000 4                  TSX1    GETPRO
         4 000353   000027 702000 4                  TSX2    ALTOUT

     3304     8496    2           TEMP = OUTBLKHDR$->KL$BLKHDR.PROOFFSET; /* set proofile offset*/

   8496  4 000354   200015 470500                    LDP0    OUTBLKHDR$,,AUTO
         4 000355   000100 101500                    MRL     fill='000'O
         4 000356   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         4 000357   200011 000002                    ADSC9   TEMP,,AUTO               cn=0,n=2

     3305     8497    2           CALL GETPRO(KL$LNK.DFLTVCPRO,OUTBLKHDR$->KL$BLKHDR);

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:634  
   8497  4 000360   200015 236100                    LDQ     OUTBLKHDR$,,AUTO
         4 000361   200022 756100                    STQ     @PRO+1,,AUTO
         4 000362   200014 236100                    LDQ     INBLKHDR$,,AUTO
         4 000363   000011 036000 5                  ADLQ    9
         4 000364   200021 756100                    STQ     IN$+2,,AUTO
         4 000365   000504 701000 4                  TSX1    GETPRO
         4 000366   000000 011000                    NOP     0

     3306     8498    2           OUTBLKHDR$->KL$BLKHDR.PROOFFSET = TEMP;

   8498  4 000367   200015 470500                    LDP0    OUTBLKHDR$,,AUTO
         4 000370   000100 101500                    MRL     fill='000'O
         4 000371   200011 000002                    ADSC9   TEMP,,AUTO               cn=0,n=2
         4 000372   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1

     3307     8499    2           IF KL$LNK.BLKHDR.NSUBS>0 THEN

   8499  4 000373   200014 471500                    LDP1    INBLKHDR$,,AUTO
         4 000374   100000 236100                    LDQ     0,,PR1
         4 000375   000777 316003                    CANQ    511,DU
         4 000376   000470 600000 4                  TZE     s:8517

     3308     8500    3           DO I=0 TO KL$LNK.BLKHDR.NSUBS-1;

   8500  4 000377   200010 450100                    STZ     I,,AUTO
         4 000400   000461 710000 4                  TRA     s:8515+3

     3309     8501    4                IF IN$->KL$LNK.BLKHDR.BLKTYP = %KLTY_LINKDEV# THEN DO;

   8501  4 000401   200017 470500                    LDP0    IN$,,AUTO
         4 000402   000001 236100                    LDQ     1,,PR0
         4 000403   777000 376003                    ANQ     -512,DU
         4 000404   013000 116003                    CMPQ    5632,DU
         4 000405   000435 601000 4                  TNZ     s:8508

     3310     8502    4                     OUT$->KL$LINKDEV = IN$->KL$LINKDEV;

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:635  
   8502  4 000406   200016 471500                    LDP1    OUT$,,AUTO
         4 000407   000100 100500                    MLR     fill='000'O
         4 000410   000000 000030                    ADSC9   0,,PR0                   cn=0,n=24
         4 000411   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24

     3311     8503    4                    CALL KLX$9TO8(IN$->KL$LINKDEV.CIRCUITS#,OUT$->KL$LINKDEV.CIRCUITS#
              8503                              ,2);

   8503  4 000412   000006 236000 5                  LDQ     6
         4 000413   200030 756100                    STQ     TEMP+4,,AUTO
         4 000414   200016 236100                    LDQ     OUT$,,AUTO
         4 000415   000002 036003                    ADLQ    2,DU
         4 000416   200027 756100                    STQ     TEMP+3,,AUTO
         4 000417   200017 236100                    LDQ     IN$,,AUTO
         4 000420   000002 036003                    ADLQ    2,DU
         4 000421   200026 756100                    STQ     TEMP+2,,AUTO
         4 000422   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000423   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000424   000000 701000 xent               TSX1    KLX$9TO8
         4 000425   000000 011000                    NOP     0

     3312     8504    4                     IN$ = PINCRC(IN$,SIZEC(KL$LINKDEV));

   8504  4 000426   200017 236100                    LDQ     IN$,,AUTO
         4 000427   000006 036003                    ADLQ    6,DU
         4 000430   200017 756100                    STQ     IN$,,AUTO

     3313     8505    4                     OUT$ = PINCRC(OUT$,SIZEC(KL$LINKDEV));

   8505  4 000431   200016 236100                    LDQ     OUT$,,AUTO
         4 000432   000006 036003                    ADLQ    6,DU
         4 000433   200016 756100                    STQ     OUT$,,AUTO

     3314     8506    4                   END;

   8506  4 000434   000456 710000 4                  TRA     s:8515

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:636  
     3315     8507    4                ELSE DO;

     3316     8508    4                     OUT$->KL$LNKVC=IN$->KL$LNKVC;

   8508  4 000435   200016 471500                    LDP1    OUT$,,AUTO
         4 000436   000100 100500                    MLR     fill='000'O
         4 000437   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48
         4 000440   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

     3317     8509    4                     IN$=PINCRC(IN$,SIZEC(KL$LNKVC));

   8509  4 000441   200017 236100                    LDQ     IN$,,AUTO
         4 000442   000014 036003                    ADLQ    12,DU
         4 000443   200017 756100                    STQ     IN$,,AUTO

     3318     8510    4                     OUTBLKHDR$=OUT$;

   8510  4 000444   200016 236100                    LDQ     OUT$,,AUTO
         4 000445   200015 756100                    STQ     OUTBLKHDR$,,AUTO

     3319     8511    4                     OUT$=PINCRC(OUT$,SIZEC(KL$LNKVC));

   8511  4 000446   000014 036003                    ADLQ    12,DU
         4 000447   200016 756100                    STQ     OUT$,,AUTO

     3320     8512    4                     CALL GETPRO(OUTBLKHDR$->KL$LNKVC.PRONM,OUTBLKHDR$->KL$BLKHDR)

   8512  4 000450   200015 236100                    LDQ     OUTBLKHDR$,,AUTO
         4 000451   200022 756100                    STQ     @PRO+1,,AUTO
         4 000452   000007 036003                    ADLQ    7,DU
         4 000453   200021 756100                    STQ     IN$+2,,AUTO
         4 000454   000504 701000 4                  TSX1    GETPRO
         4 000455   000027 702000 4                  TSX2    ALTOUT

     3321     8513    4                          ALTRET(ALTOUT);
     3322     8514    4                   END;

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:637  
     3323     8515    3              END;

   8515  4 000456   200010 235100                    LDA     I,,AUTO
         4 000457   000001 035007                    ADLA    1,DL
         4 000460   200010 755100                    STA     I,,AUTO
         4 000461   200014 470500                    LDP0    INBLKHDR$,,AUTO
         4 000462   000000 236100                    LDQ     0,,PR0
         4 000463   000022 772000                    QRL     18
         4 000464   000777 376007                    ANQ     511,DL
         4 000465   200010 116100                    CMPQ    I,,AUTO
         4 000466   000470 600000 4                  TZE     s:8517
         4 000467   000401 603000 4                  TRC     s:8501

     3324     8516    2        END;                               /* CASE KL$BLKHDR.BLKTYP */

     3325     8517    1        CALL KLX$9TO8(MSGSIZE,KL$CHNRSP.MESSAGE.MSGSIZE,2);

   8517  4 000470   000006 236000 5                  LDQ     6
         4 000471   200030 756100                    STQ     TEMP+4,,AUTO
         4 000472   000000 236000 xsym               LDQ     KL_EXTRSP_BUF$
         4 000473   000015 036003                    ADLQ    13,DU
         4 000474   200027 756100                    STQ     TEMP+3,,AUTO
         4 000475   200012 630500                    EPPR0   MSGSIZE,,AUTO
         4 000476   200026 450500                    STP0    TEMP+2,,AUTO
         4 000477   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000500   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000501   000000 701000 xent               TSX1    KLX$9TO8
         4 000502   000000 011000                    NOP     0

     3326     8518    1        RETURN;

   8518  4 000503   000000 702200 xent               TSX2  ! X66_ARET

     3327     8519        %EJECT;
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:638  
     3328     8520    1   GETPRO: PROC(PRO,BLKHDR) ALTRET;

   8520  4 000504   200020 741300       GETPRO       STX1  ! IN$+1,,AUTO

     3329     8521    2   DCL 1 PRO CALIGNED,
     3330     8522    2            2 LEN UBIN BYTE UNAL,
     3331     8523    2            2 TXT CHAR(11);
     3332     8524        %KL_BLKHDR(NAME=BLKHDR,STCLASS=PARAM,ALGN=CALIGNED);
     3333     8619    2   DCL PSIZ UBIN;
     3334     8620    2   DCL TEMP UBIN HALF;
     3335     8621    2   DCL CHR$PSIZ CHAR(PSIZ) BASED;
     3336     8622
     3337     8623    2        IF PRO.LEN=0 THEN RETURN;

   8623  4 000505   200021 470500                    LDP0    @PRO,,AUTO
         4 000506   000100 101500                    MRL     fill='000'O
         4 000507   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000510   200026 000004                    ADSC9   TEMP+2,,AUTO             cn=0,n=4
         4 000511   200026 236100                    LDQ     TEMP+2,,AUTO
         4 000512   000000 116003                    CMPQ    0,DU
         4 000513   000515 601000 4                  TNZ     s:8624

   8623  4 000514   000001 702211                    TSX2  ! 1,X1

     3338     8624    2        KL_PROKEY=PRO;

   8624  4 000515   000000 100500                    MLR     fill='000'O
         4 000516   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
         4 000517   000000 000015 xsym               ADSC9   KL_PROKEY                cn=0,n=13

     3339     8625    3        CALL M$READ(KL_RDPROR) WHENALTRETURN DO;

   8625  4 000520   000000 630400 xsym               EPPR0   KL_RDPROR
         4 000521   440000 713400                    CLIMB   alt,read
         4 000522   401400 401760                    pmme    nvectors=4
         4 000523   000525 702000 4                  TSX2    s:8626
         4 000524   000527 710000 4                  TRA     s:8628
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:639  

     3340     8626    3             ALTRETURN;

   8626  4 000525   200020 221300                    LDX1  ! IN$+1,,AUTO
         4 000526   000000 702211                    TSX2  ! 0,X1

     3341     8627    3           END;
     3342     8628    2        PSIZ=DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS#-SIZEC(KL$PHDR);

   8628  4 000527   000000 236007 xsym               LDQ     M$PROF,DL
         4 000530   000003 470400 5                  LDP0    3
         4 000531   000000 471500                    LDP1    0,,PR0
         4 000532   100000 473506                    LDP3    0,QL,PR1
         4 000533   300000 235100                    LDA     0,,PR3
         4 000534   000120 135007                    SBLA    80,DL
         4 000535   200023 755100                    STA     PSIZ,,AUTO

     3343     8629    2        OUT$->CHR$PSIZ=PINCRC(ADDR(KL_PROBUF),SIZEC(KL$PHDR))->CHR$PSIZ;

   8629  4 000536   000000 620005                    EAX0    0,AL
         4 000537   200016 473500                    LDP3    OUT$,,AUTO
         4 000540   200023 721100                    LXL1    PSIZ,,AUTO
         4 000541   040140 100440                    MLR     fill='040'O
         4 000542   000024 000010 xsym               ADSC9   KL_PROBUF+20             cn=0,n=*X0
         4 000543   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     3344     8630    2        MSGSIZE=MSGSIZE+PSIZ;

   8630  4 000544   200012 236100                    LDQ     MSGSIZE,,AUTO
         4 000545   000022 772000                    QRL     18
         4 000546   200023 036100                    ADLQ    PSIZ,,AUTO
         4 000547   000000 620006                    EAX0    0,QL
         4 000550   200012 740100                    STX0    MSGSIZE,,AUTO

     3345     8631    2        CALL KLX$8TO9(BLKHDR.LEN,TEMP,2);

   8631  4 000551   000006 236000 5                  LDQ     6
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:640  
         4 000552   200030 756100                    STQ     TEMP+4,,AUTO
         4 000553   200024 634500                    EPPR4   TEMP,,AUTO
         4 000554   200027 454500                    STP4    TEMP+3,,AUTO
         4 000555   200022 236100                    LDQ     @BLKHDR,,AUTO
         4 000556   400000 036007                    ADLQ    -131072,DL
         4 000557   200026 756100                    STQ     TEMP+2,,AUTO
         4 000560   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000561   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000562   000000 701000 xent               TSX1    KLX$8TO9
         4 000563   000000 011000                    NOP     0

     3346     8632    2        TEMP=TEMP+PSIZ;

   8632  4 000564   200024 236100                    LDQ     TEMP,,AUTO
         4 000565   000022 772000                    QRL     18
         4 000566   200023 036100                    ADLQ    PSIZ,,AUTO
         4 000567   000000 620006                    EAX0    0,QL
         4 000570   200024 740100                    STX0    TEMP,,AUTO

     3347     8633    2        CALL KLX$9TO8(TEMP,BLKHDR.LEN,2);

   8633  4 000571   000006 236000 5                  LDQ     6
         4 000572   200030 756100                    STQ     TEMP+4,,AUTO
         4 000573   200022 236100                    LDQ     @BLKHDR,,AUTO
         4 000574   400000 036007                    ADLQ    -131072,DL
         4 000575   200027 756100                    STQ     TEMP+3,,AUTO
         4 000576   200024 630500                    EPPR0   TEMP,,AUTO
         4 000577   200026 450500                    STP0    TEMP+2,,AUTO
         4 000600   200026 630500                    EPPR0   TEMP+2,,AUTO
         4 000601   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000602   000000 701000 xent               TSX1    KLX$9TO8
         4 000603   000000 011000                    NOP     0

     3348     8634    2        BLKHDR.PROOFFSET=POFFC(OUT$,ADDR(BLKHDR));

   8634  4 000604   200022 236100                    LDQ     @BLKHDR,,AUTO
         4 000605   000020 772000                    QRL     16
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:641  
         4 000606   200026 756100                    STQ     TEMP+2,,AUTO
         4 000607   200016 236100                    LDQ     OUT$,,AUTO
         4 000610   000020 772000                    QRL     16
         4 000611   200026 136100                    SBLQ    TEMP+2,,AUTO
         4 000612   200027 756100                    STQ     TEMP+3,,AUTO
         4 000613   200022 470500                    LDP0    @BLKHDR,,AUTO
         4 000614   000100 101500                    MRL     fill='000'O
         4 000615   200027 000004                    ADSC9   TEMP+3,,AUTO             cn=0,n=4
         4 000616   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1

     3349     8635    2        OUT$=PINCRC(OUT$,PSIZ);

   8635  4 000617   200023 236100                    LDQ     PSIZ,,AUTO
         4 000620   000020 736000                    QLS     16
         4 000621   200016 036100                    ADLQ    OUT$,,AUTO
         4 000622   200016 756100                    STQ     OUT$,,AUTO

     3350     8636    2        RETURN;

   8636  4 000623   200020 221300                    LDX1  ! IN$+1,,AUTO
         4 000624   000001 702211                    TSX2  ! 1,X1
     3351     8637    2   END GETPRO;
     3352     8638    1   END KLI$LINEPRO;

PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:642  
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_NETWORK_M.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   KL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KLI$LINEPRO.
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:643  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ACCT                     22-0-0/w PTR         r     1 @BLKHDR
     5-0-0/w PTR         r     1 @PASS                     21-0-0/w PTR         r     1 @PRO
     4-0-0/w PTR         r     1 @UNAME                    *0-0-0/c CHAR(8)     r     1 ACCT
    *0-0-0/c STRC(72)    r     1 BLKHDR                    10-0-0/w UBIN        r     1 I
    17-0-0/w PTR         r     1 IN$                       14-0-0/w PTR         r     1 INBLKHDR$
    12-0-0/w UBIN(18)    r     1 MSGSIZE                   16-0-0/w PTR         r     1 OUT$
    15-0-0/w PTR         r     1 OUTBLKHDR$                *0-0-0/c CHAR(8)     r     1 PASS
    *0-0-0/c STRC(108)   r     1 PRO                       23-0-0/w UBIN        r     1 PSIZ
     6-0-0/c CHAR(8)     r     1 PW                        13-0-0/w UBIN        r     1 SIZELEFT
    11-0-0/w UBIN(18)    r     1 TEMP                      24-0-0/w UBIN(18)    r     1 TEMP
    *0-0-0/c STRC(117)   r     1 UNAME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KL_EXTRSP_BUF$             0-0-0/d STRC(189)   r     1 KL_HLPKEY
     0-0-0/w STRC(1593)  r     1 KL_HLPR                    0-0-0/b BIT         r     1 KL_NETWORK_VALID
     0-0-0/w STRC(720)   r     1 KL_PROBUF                  0-0-0/d STRC(117)   r     1 KL_PROKEY
     0-0-0/d STRC(504)   r     1 KL_RDHLPR                  0-0-0/d STRC(504)   r     1 KL_RDPROR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 CHR$PSIZ                   0-0-0/c ACHR        r     1 CHR$SIZELEFT
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/c STRC(72)    r     1 KL$BLKHDR
     0-0-0/w STRC(2781)  r     1 KL$CHNRSP                  0-0-0/w STRC(828)   r     1 KL$HASP
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:644  
     0-0-0/c STRC(216)   r     1 KL$LINKDEV                 0-0-0/w STRC(108)   r     1 KL$LN3270
     0-0-0/w STRC(432)   r     1 KL$LNK                     0-0-0/w STRC(432)   r     1 KL$LNKVC
     0-0-0/c STRC(720)   r     1 KL$PHDR                    0-0-0N  NULL        r     1 M$HLPF
     0-0-0N  NULL        r     1 M$PROF


   Procedure KLI$LINEPRO requires 405 words for executable code.
   Procedure KLI$LINEPRO requires 26 words of local(AUTO) storage.

    No errors detected in file KLI$FESET.:E05TSI    .
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:645  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:646  
          MINI XREF LISTING

ACCT
        39**DCL        36--PROC     8441>>ASSIGN
ALTOUT
      8445**LABEL    8451--GOTO     8454--GOTO     8468--GOTO     8475--CALLALT  8483--CALLALT  8495--CALLALT
      8512--CALLALT
ASZ$SCRAMBLE
      8436**DCL-ENT  8450--CALL
BLKHDR IN PROCEDURE GETPRO
      8538**DCL      8520--PROC     8634--ASSIGN
BLKHDR.LEN IN PROCEDURE GETPRO
      8557**DCL      8631<>CALL     8633<>CALL
BLKHDR.PROOFFSET IN PROCEDURE GETPRO
      8589**DCL      8634<<ASSIGN
CHR$PSIZ IN PROCEDURE GETPRO
      8621**DCL      8629<<ASSIGN   8629>>ASSIGN
CHR$SIZELEFT
      6850**DCL      8476<<ASSIGN   8476>>ASSIGN   8484<<ASSIGN   8484>>ASSIGN
F$DCB.ACTPOS
      8293**DCL      8293--REDEF
F$DCB.ARS#
      8267**DCL      8267--REDEF    8464>>ASSIGN   8628>>ASSIGN
F$DCB.ATTR
      8286**DCL      8287--REDEF
F$DCB.BORROW
      8301**DCL      8301--REDEF    8301--REDEF    8301--REDEF
F$DCB.DCBNAME.L
      8315**DCL      8315--IMP-SIZ
F$DCB.EOMCHAR#
      8271**DCL      8271--REDEF
F$DCB.FLDID
      8296**DCL      8296--REDEF
F$DCB.FORM$
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:647  
      8290**DCL      8290--REDEF
F$DCB.FSECT
      8306**DCL      8306--REDEF
F$DCB.FSN#
      8283**DCL      8283--REDEF    8283--REDEF    8284--REDEF
F$DCB.HEADER$
      8289**DCL      8289--REDEF
F$DCB.IXTNSIZE#
      8287**DCL      8287--REDEF
F$DCB.LASTSTA$
      8276**DCL      8276--REDEF
F$DCB.LVL
      8302**DCL      8302--REDEF
F$DCB.NAME#.C
      8277**DCL      8277--REDEF
F$DCB.NOEOF
      8299**DCL      8299--REDEF
F$DCB.NRECS#
      8288**DCL      8288--REDEF
F$DCB.NRECX
      8307**DCL      8307--REDEF
F$DCB.OHDR
      8299**DCL      8299--REDEF
F$DCB.ORG#
      8282**DCL      8282--REDEF
F$DCB.PRECNO
      8305**DCL      8305--REDEF
F$DCB.RCSZ
      8311**DCL      8311--REDEF
F$DCB.RES#
      8278**DCL      8278--REDEF
F$DCB.SETX
      8290**DCL      8290--REDEF
F$DCB.TAB$
      8290**DCL      8290--REDEF
F$DCB.TDA
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:648  
      8304**DCL      8305--REDEF
F$DCB.WSN#
      8278**DCL      8278--REDEF
GETPRO
      8520**PROC     8475--CALL     8483--CALL     8495--CALL     8497--CALL     8512--CALL
I
      6846**DCL      8500<<DOINDEX
IN$
      6854**DCL      8463<<ASSIGN   8472<<ASSIGN   8472>>ASSIGN   8476>>ASSIGN   8480<<ASSIGN   8480>>ASSIGN
      8484>>ASSIGN   8492<<ASSIGN   8492>>ASSIGN   8501>>IF       8502>>ASSIGN   8503>>CALL     8504<<ASSIGN
      8504>>ASSIGN   8508>>ASSIGN   8509<<ASSIGN   8509>>ASSIGN
INBLKHDR$
      6851**DCL      6869--IMP-PTR  6965--IMP-PTR  7115--IMP-PTR  7259--IMP-PTR  7481--IMP-PTR  7707--IMP-PTR
      8456<<ASSIGN   8458<<ASSIGN   8460<<ASSIGN   8463>>ASSIGN   8464>>ASSIGN   8466>>DOCASE   8470>>ASSIGN
      8478>>ASSIGN   8486>>ASSIGN   8487>>CALL     8488>>CALL     8489>>CALL     8490>>CALL     8491>>CALL
      8497>>CALL     8499>>IF       8500>>DOINDEX
KL$BLKHDR
      6869**DCL      8475<>CALL     8483<>CALL     8495<>CALL     8497<>CALL     8512<>CALL
KL$BLKHDR.BLKTYP
      6897**DCL      8466>>DOCASE
KL$BLKHDR.PROOFFSET
      6920**DCL      8496>>ASSIGN   8498<<ASSIGN
KL$CHNRSP.MESSAGE.MESSAGE
      8256**DCL      8462--ASSIGN
KL$CHNRSP.MESSAGE.MSGSIZE
      8248**DCL      8446<<ASSIGN   8517<>CALL
KL$CHNRSP.NAK
      8074**DCL      8445<<ASSIGN
KL$CHNRSP.TERMINAL_ID.TERM
      8106**DCL      8115--REDEF
KL$HASP
      6965**DCL      8470<<ASSIGN   8470>>ASSIGN   8471--ASSIGN   8472--ASSIGN   8474--ASSIGN
KL$LINKDEV
      7707**DCL      8502<<ASSIGN   8502>>ASSIGN   8504--ASSIGN   8505--ASSIGN
KL$LINKDEV.CIRCUITS#
      7825**DCL      8503<>CALL     8503<>CALL
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:649  
KL$LN3270
      7115**DCL      8478<<ASSIGN   8478>>ASSIGN   8479--ASSIGN   8480--ASSIGN   8482--ASSIGN
KL$LNK
      7259**DCL      8486<<ASSIGN   8486>>ASSIGN
KL$LNK.BLKHDR.BLKTYP
      7305**DCL      8501>>IF
KL$LNK.BLKHDR.LEN
      7296**DCL      8491<>CALL
KL$LNK.BLKHDR.NSUBS
      7292**DCL      8499>>IF       8500>>DOINDEX
KL$LNK.DFLTVCPRO
      7424**DCL      8497<>CALL
KL$LNK.HIC
      7397**DCL      8488<>CALL     8488<>CALL
KL$LNK.HOC
      7407**DCL      8490<>CALL     8490<>CALL
KL$LNK.LIC
      7392**DCL      8487<>CALL     8487<>CALL
KL$LNK.LOC
      7402**DCL      8489<>CALL     8489<>CALL
KL$LNKVC
      7481**DCL      8508<<ASSIGN   8508>>ASSIGN   8509--ASSIGN   8511--ASSIGN
KL$LNKVC.CUG
      7580**DCL      7624--REDEF
KL$LNKVC.PRONM
      7651**DCL      8512<>CALL
KL$PHDR
      7874**DCL      8628--ASSIGN   8629--ASSIGN
KLX$8TO9
      8437**DCL-ENT  8491--CALL     8631--CALL
KLX$9TO8
      8438**DCL-ENT  8487--CALL     8488--CALL     8489--CALL     8490--CALL     8503--CALL     8517--CALL
      8633--CALL
KL_AUTOFAIL.FLAGS
       429**DCL       430--REDEF
KL_AUTOFAIL.MSGID
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:650  
       425**DCL       426--REDEF
KL_AUTOFAIL.WSN
       432**DCL       433--REDEF
KL_EXTRSP_BUF$
       586**DCL      8055--IMP-PTR  8445>>ASSIGN   8446>>ASSIGN   8462>>ASSIGN   8517>>CALL
KL_FEMSG.FLAGS
       379**DCL       380--REDEF
KL_FEMSG.MSGID
       375**DCL       376--REDEF
KL_FEMSG.WSN
       382**DCL       383--REDEF
KL_HLPKEY.ACCT
       451**DCL      8441<<ASSIGN
KL_HLPKEY.CNT
       450**DCL      8443<<ASSIGN
KL_HLPKEY.NAME
       452**DCL      8442<<ASSIGN
KL_HLPR
      7915**DCL      8464--ASSIGN
KL_HLPR.ATYP
      7920**DCL      8452>>DOCASE
KL_HLPR.GJOB_OR_REST
      8031**DCL      8458--ASSIGN   8460--ASSIGN
KL_HLPR.PASSWORD
      7973**DCL      7977--REDEF    8451>>IF
KL_HLPR.PNAME
      7979**DCL      8475<>CALL     8483<>CALL     8495<>CALL
KL_HLPR.RENAME
      7996**DCL      7997--REDEF
KL_HLPR.REST
      8039**DCL      8456--ASSIGN
KL_NETWORK_BUF.TERMINAL_ID.TERM
       569**DCL       578--REDEF
KL_NETWORK_KEY.KEY.TERMID.TERM
       495**DCL       504--REDEF
KL_NETWORK_VALID
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:651  
       358**DCL      8440<<ASSIGN
KL_PROBUF
      8330**DCL      8629--ASSIGN
KL_PROKEY
       453**DCL      8624<<ASSIGN
KL_RDBF.FEL#
       338**DCL       339--REDEF
KL_RDHLPR
      8375**DCL      8444<>CALL
KL_RDHLPR.STATION_
      8378**DCL      8379--REDEF
KL_RDHLPR.V.DVBYTE.REREAD#
      8390**DCL      8390--REDEF
KL_RDHLPR.V.INDX#
      8388**DCL      8388--REDEF
KL_RDPROR
      8414**DCL      8625<>CALL
KL_RDPROR.STATION_
      8417**DCL      8418--REDEF
KL_RDPROR.V.DVBYTE.REREAD#
      8429**DCL      8429--REDEF
KL_RDPROR.V.INDX#
      8427**DCL      8427--REDEF
KL_TMSG.FLAGS
       401**DCL       402--REDEF
KL_TMSG.MSGID
       397**DCL       398--REDEF
KL_TMSG.WSN
       404**DCL       405--REDEF
M$HLPF
      6843**DCL      8464--ASSIGN
M$PROF
      6844**DCL      8628--ASSIGN
M$READ
        54**DCL-ENT  8444--CALL     8625--CALL
MSGSIZE
PL6.E3A0      #006=KLI$LINEPRO File=KLI$FESET.:E05TSI                            WED 07/30/97 00:57 Page:652  
      6848**DCL      8464<<ASSIGN   8471>>ASSIGN   8479>>ASSIGN   8517<>CALL     8630<<ASSIGN   8630>>ASSIGN
OUT$
      6853**DCL      8462<<ASSIGN   8470>>ASSIGN   8473>>ASSIGN   8474<<ASSIGN   8474>>ASSIGN   8476>>ASSIGN
      8478>>ASSIGN   8481>>ASSIGN   8482<<ASSIGN   8482>>ASSIGN   8484>>ASSIGN   8486>>ASSIGN   8487>>CALL
      8488>>CALL     8489>>CALL     8490>>CALL     8493>>ASSIGN   8494<<ASSIGN   8494>>ASSIGN   8502>>ASSIGN
      8503>>CALL     8505<<ASSIGN   8505>>ASSIGN   8508>>ASSIGN   8510>>ASSIGN   8511<<ASSIGN   8511>>ASSIGN
      8629>>ASSIGN   8634>>ASSIGN   8635<<ASSIGN   8635>>ASSIGN
OUTBLKHDR$
      6852**DCL      8473<<ASSIGN   8475>>CALL     8481<<ASSIGN   8483>>CALL     8493<<ASSIGN   8495>>CALL
      8496>>ASSIGN   8497>>CALL     8498>>ASSIGN   8510<<ASSIGN   8512>>CALL     8512>>CALL
PASS
        43**DCL        36--PROC     8449>>ASSIGN
PRO IN PROCEDURE GETPRO
      8521**DCL      8520--PROC     8624>>ASSIGN
PRO.LEN IN PROCEDURE GETPRO
      8522**DCL      8623>>IF
PSIZ IN PROCEDURE GETPRO
      8619**DCL      8621--IMP-SIZ  8628<<ASSIGN   8629>>ASSIGN   8629>>ASSIGN   8630>>ASSIGN   8632>>ASSIGN
      8635>>ASSIGN
PW
      6845**DCL      8449<<ASSIGN   8450<>CALL     8451>>IF
SIZELEFT
      6849**DCL      6850--IMP-SIZ  8471<<ASSIGN   8476>>ASSIGN   8476>>ASSIGN   8479<<ASSIGN   8484>>ASSIGN
      8484>>ASSIGN
TEMP
      6847**DCL      8491<>CALL     8492>>ASSIGN   8494>>ASSIGN   8496<<ASSIGN   8498>>ASSIGN
TEMP IN PROCEDURE GETPRO
      8620**DCL      8631<>CALL     8632<<ASSIGN   8632>>ASSIGN   8633<>CALL
UNAME
        40**DCL        36--PROC
UNAME.C
        41**DCL      8443>>ASSIGN
UNAME.T
        42**DCL      8442>>ASSIGN
