VERSION E05

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:1    
        1        1        /*M* FXH$RECON - Reconstruct a packset's free extent list */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9        FXH$RECON:PROC(PARM)ALTRET;
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE FM$MACROS;
       12      466        %INCLUDE FX_PERR_C;
       13      525        %INCLUDE F_ERRORS_C;
       14      765        %INCLUDE F$JIT_C;
       15      882        %INCLUDE JG_GHOSTS_C;
       16      972    1   DCL B$JIT$ PTR SYMREF;
       17      973    1   DCL B$TCB$ PTR SYMREF;
       18      974        %B$TCB(STCLASS="BASED(B$TCB$)");
       19      977        %B$ALT;
       20      985        %CODE01(BASED="BASED(XTN$)");
       21      989        %CODE03(BASED="BASED(XTN$)");
       22      996        %CODE04(BASED="BASED(XTN$)");
       23     1004        %CODE14(BASED="BASED(XTN$)");
       24     1014        %SUB VID=VIDBUF;
       25     1015        %SUB FCG#='0630'O;
       26     1016        %SUB MID#='10'O;
       27     1017        %FM$VID(BASED=SYMREF,FM$VID=VID);
       28     1023        %FM$FIT(FM$FIT=FIT,BASED="REDEF VID,2 *(0:4)UBIN",N=1018);
       29     1026        %FM$GRAN(BASED=REDEF VID,FLINK="FLINK UBIN,2 *(0:1018)");
       30     1030    1   DCL 1 MSG REDEF VID,
       31     1031    1         2 WD(0:510) UBIN,
       32     1032    1         2 I UBIN,
       33     1033    1         2 L UBIN(9)UNAL,
       34     1034    1         2 T CHAR(2047);
       35     1035        %FM$GP(FM$GP=VXH,BASED="BASED(XTN$)");
       36     1039        %FPT_GDS(FPTN=MAPSEG,RESULTS=MAP_,SEGSIZE=1024);
       37     1055        %VLP_VECTOR(FPTN=MAP_,SEGID='0'B);
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:2    
       38     1070        %FPT_TIME(FPTN=GETTIME,STCLASS=CONSTANT,DEST=UTS,TSTAMP=I);
       39     1089        %FPT_OPEN(FPTN=NXTFPT,
       40     1090                 DCB=M$EI,
       41     1091                 FPARAM=FIT,
       42     1092                 SN=RCNSN,
       43     1093                 ACS=BLOCK,
       44     1094                 TEST=YES,
       45     1095                 FUN=IN,
       46     1096                 ANYF=YES,
       47     1097                 ASN=FILE);
       48     1206        %FPT_OPEN(FPTN=UPD04,
       49     1207                 DCB=M$EI,
       50     1208                 IFPARAM=FIT.CODES,
       51     1209                 ACCT=PAD_FIT,
       52     1210                 SN=RCNSN,
       53     1211                 RES='DP',
       54     1212                 STCLASS=CONSTANT,
       55     1213                 ASN=DEVICE);
       56     1322        %FM_FITCODE(NAME=FIT1CODE,CODE=1,NAW=2);
       57     1325        %VLP_ACCT(FPTN=PAD_FIT,STCLASS=CONSTANT,ACCT="BINASC(0)");
       58     1338        %FPT_ERRMSG(FPTN=EFPT,CODE=I);
       59     1365    1   DCL BREAK UBIN SYMREF;
       60     1366    1   DCL 1 RCNSN STATIC SYMDEF,
       61     1367    1         2 * UBIN INIT(1),
       62     1368    1         2 SN CHAR(6);
       63     1369    1   DCL GPBUF(0:6)UBIN SYMREF;
       64     1370        %FPT_READ(FPTN=READFD,
       65     1371                 STCLASS=CONSTANT,
       66     1372                 DCB=M$DP,
       67     1373                 BUF=FIT,
       68     1374                 KEYS=YES,
       69     1375                 KEY=GRANULE);
       70     1414        %FPT_WRITE(FPTN=WRITEFD,
       71     1415                 STCLASS=CONSTANT,
       72     1416                 DCB=M$DP,
       73     1417                 KEY=GRANULE,
       74     1418                 BUF=FIT);
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:3    
       75     1449        %FPT_WRITE(DCB=M$LO,
       76     1450                 FPTN=LOFPT,
       77     1451                 BUF=DISTH);
       78     1482        %FPT_CLOSE(FPTN=CLSDP,
       79     1483        DCB=M$DP);
       80     1525    1   DCL M$EI DCB;
       81     1526    1   DCL M$LO DCB;
       82     1527    1   DCL M$DP DCB;
       83     1528        %MACRO F$DCB#(BASED=BASED);
       84     1529        %INCLUDE F$DCB;
       85     1578        %MEND;
       86     1579        %F$DCB#(BASED="BASED(EIDCB$)");
       87     1629    1   DCL BAD$ PTR STATIC; /* Must be static - see FXH$RECONT */
       88     1630    1   DCL PARM UBIN ALIGNED;
       89     1631    1   DCL M$DP$ PTR STATIC SYMDEF;
       90     1632    1   DCL SGRANS UBIN STATIC SYMDEF;
       91     1633    1   DCL I UBIN STATIC;
       92     1634    1   DCL GRANULE SBIN STATIC;
       93     1635    1   DCL ERRCODE BIT(36)SYMREF;
       94     1636    1   DCL MAXERR UBIN STATIC INIT(20);
       95     1637    1   DCL SPARE UBIN STATIC INIT(200);/* SPARE SPACE TO LEAVE IN GP GRANS*/
       96     1638        %ERRCODE(NAME=FXH$E$MAXERR,COD#=E$MAXERR);
       97     1642        %ERRCODE(NAME=FXH$E$FILECNT,COD#=E$FILECNT);
       98     1646    1   DCL MAPX SBIN;
       99     1647    1   DCL BITX UBIN;
      100     1648    1   DCL BITS(0:35)BIT(36)INIT('4'O,'2'O,'1'O,'04'O,'02'O,'01'O,'004'O,'002'O,'001'O,
      101     1649    1   '0004'O,'0002'O,'0001'O,'00004'O,'00002'O,'00001'O,'000004'O,'000002'O,'000001'O,
      102     1650    1   '0000004'O,'0000002'O,'0000001'O,'00000004'O,'00000002'O,'00000001'O,
      103     1651    1   '000000004'O,'000000002'O,'000000001'O,'0000000004'O,'0000000002'O,'0000000001'O,
      104     1652    1   '00000000004'O,'00000000002'O,'00000000001'O,
      105     1653    1   '000000000004'O,'000000000002'O,'000000000001'O)CONSTANT;
      106     1654    1   DCL EIDCB$ PTR;
      107     1655    1   DCL BAD1$ PTR;
      108     1656    1   DCL XTN$ PTR;
      109     1657    1   DCL SETMAX UBIN;
      110     1658    1   DCL NXTNS SBIN;
      111     1659    1   DCL AGRANS SBIN;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:4    
      112     1660    1   DCL FGRANS UBIN;
      113     1661    1   DCL XTNSIZE UBIN;
      114     1662    1   DCL FDFDA UBIN;
      115     1663    1   DCL COUNTONLY UBIN; /* FLAG FOR COUNT ONLY OPERATION */
      116     1664    1   DCL BADFILES UBIN;
      117     1665    1   DCL FILES SBIN;
      118     1666    1   DCL AFILES SBIN;
      119     1667    1   DCL ACCTS SBIN;
      120     1668    1   DCL MAXGRAN(0:19) UBIN;
      121     1669    1   DCL VOLGRAN(0:19)UBIN;
      122     1670    1   DCL 1 XTNDIST,
      123     1671    1         2 OLDC(0:18)UBIN,
      124     1672    1         2 NEWC(0:18)UBIN;
      125     1673    1   DCL SHR_GAC BIT(1);
      126     1674    1   DCL FM_SRZERO UBIN CONSTANT INIT(67174400);
      127     1675    1   DCL FM_MADSDA UBIN CONSTANT INIT(67174403);
      128     1676    1   DCL FM_PADSDA UBIN CONSTANT INIT(67174402);
      129     1677    1   DCL FM_GPSDA UBIN CONSTANT INIT(67174401);
      130     1678    1   DCL SPTXTS(0:4)CONSTANT CHAR(4)INIT('VID.','GP.','PAD.','MAD.','FND.');
      131     1679    1   DCL MSGVEC(0:15)PTR CONSTANT INIT(
      132     1680    1   ADDR(DISTH),ADDR(NUMBUF),
      133     1681    1   ADDR(VOLH),ADDR(VOLBUF),
      134     1682    1   ADDR(BADFM),ADDR(DISTH1),
      135     1683    1   ADDR(MSG.L),
      136     1684    1   ADDR(ACHDR),ADDR(ACSUM),
      137     1685    1   ADDR(NIL)*0);
      138     1686        %MACRO TXC(TT=*,N=,T=);
      139     1687        DCL 1 N STATIC,
      140     1688              2 * UBIN(9)INIT(SIZEC(T))UNAL,
      141     1689              2 TT CHAR(0)INIT(T);
      142     1690        %MEND;
      143     1691        %TXC(N=BADFM,T="'00000 FILES, 00000 ERRORS'");
      144     1696        %TXC(N=DISTH1,T='FREE EXTENTS: N/2<SIZE<=N');
      145     1701        %TXC(N=DISTH,T='XTNTS<=N    OLD    NEW');
      146     1706        %TXC(N=NUMBUF,TT=TX,T='1234567812345671234567');
      147     1711        %TXC(N=VOLH,T='FREE GRANULES BY VOLUME');
      148     1716        %TXC(N=VOLBUF,TT=TX,T='VVVVV1234567 OF1234567');
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:5    
      149     1721        %TXC(N=ACSUM,TT=TX,T='12345 12345 12345 ABCDEFGH');
      150     1726        %TXC(N=ACHDR,T="'NAMES GRANS  (FD) ACCOUNT'");
      151     1731        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:6    
      152     1732    1   DCL 1 BADS BASED(BAD$)ALIGNED,
      153     1733    1         2 FDA UBIN,
      154     1734    1         2 NAME,
      155     1735    1           3 L UBIN BYTE UNAL,
      156     1736    1           3 C CHAR(31),
      157     1737    1         2 ACCT CHAR(8),
      158     1738    1         2 NXTNS SBIN,
      159     1739    1         2 XTNT(0:0),
      160     1740    1           3 XTNSIZE UBIN BYTE UNAL,
      161     1741    1           3 XTNSDA UBIN(27) UNAL;
      162     1742    1   DCL MAP(0:0)BASED(MAP_.PTR$)BIT(36)ALIGNED;
      163     1743        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:7    
      164     1744    1   DCL GAC SBIN STATIC SYMDEF INIT(0);
      165     1745    1   DCL FGG$START ENTRY(2)ALTRET;
      166     1746    1   DCL FGG$PROCESS_FIT ENTRY(1)ALTRET;
      167     1747    1   DCL FGG$DONE ENTRY ALTRET;
      168     1748    1   DCL FGG$QUIT ENTRY ALTRET;
      169     1749    1      COUNTONLY=0;
      170     1750    1      GOTO NOTCOUNT;
      171     1751    1   FXH$COUNT: ENTRY ALTRET;
      172     1752    1   FXH$TIME: ENTRY(PARM)ALTRET;
      173     1753    1      COUNTONLY=1;
      174     1754    1   NOTCOUNT:;
      175     1755    1      EIDCB$=DCBADDR(DCBNUM(M$EI));
      176     1756    1      GOTO NOTGPSUM;
      177     1757    1   FXH$GPSUM: ENTRY ALTRET;
      178     1758    1      EIDCB$=ADDR(NIL);
      179     1759    1   NOTGPSUM:;
      180     1760    1      BADFILES=0;
      181     1761    1      ERRCODE='0'B;
      182     1762    1      FILES=0;
      183     1763    1      MAXGRAN(0)=0;
      184     1764    1      RCNSN.SN=M$DP$->F$DCB.PSN;
      185     1765    1      SHR_GAC='0'B;
      186     1766    1      IF GAC~=0 AND NOT M$DP$->F$DCB.OWNER THEN SHR_GAC='1'B;
      187     1767    1      IF ADDR(PARM)~=ADDR(NIL)
      188     1768    2      THEN IF COUNTONLY~=0 THEN DO;
      189     1769                    /* MUST BE TIME ENTRY */
      190     1770    2            CALL SETTIME(PARM);
      191     1771    2            RETURN;
      192     1772    2            END;
      193     1773    1         ELSE MAXERR=PARM;
      194     1774    1      ELSE MAXERR=20;
      195     1775    1      GRANULE=0;
      196     1776    1      CALL M$READ(READFD)ALTRET(RETALT);
      197     1777    1      SETMAX=0;
      198     1778    2      DO I=0 TO VID.VOLCNT-1;
      199     1779    2         SETMAX=SETMAX+VID.SNLIST.SIZE(I);
      200     1780    2         MAXGRAN(I+1)=SETMAX;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:8    
      201     1781    2         END;
      202     1782    2      IF EIDCB$=ADDR(NIL) THEN DO;
      203     1783    2         IF B$JIT.SYSID~=JG_SLUG#
      204     1784    2         THEN FILES=1;/* FORCE PRINTING*/
      205     1785    2         CALL GPDIST;
      206     1786    2         XTNDIST.OLDC=XTNDIST.NEWC;
      207     1787    2         NUMBUF.TX=' ';
      208     1788    2         CALL PRINT(20);
      209     1789    2         SGRANS=0;
      210     1790    2         GOTO GPSUMENT;
      211     1791    2         END;
      212     1792    1      GRANULE=(SETMAX+1+2*SIZEB(BADS))/36; /* SPACE FOR A BIT MAP */
      213     1793    2      DO WHILE (GRANULE>MAP_.W1.VSIZE#/4);
      214     1794    2         CALL M$GDS(MAPSEG)ALTRET(RETALT);
      215     1795    2         END;
      216     1796    2      DO I=0 TO GRANULE;
      217     1797    2         MAP(I)='0'B;
      218     1798    2         END;
      219     1799    1      BAD$=PINCRW(MAP_.PTR$,GRANULE+1-2*SIZEW(BADS));
      220     1800    1      BAD1$=BAD$;
      221     1801    1      SGRANS=VID.VOLCNT+1;
      222     1802    1      GRANULE=0;
      223     1803    1      FDFDA=FM_SRZERO;
      224     1804    2      DO I=0 TO VID.VOLCNT-1;
      225     1805    2         CALL M$READ(READFD)ALTRET(RETALT);
      226     1806    2         CALL SETBIT;
      227     1807    2         IF VID.SNLIST.VSN.S(I)=0 THEN ACCTS=0;
      228     1808    2         ELSE ACCTS=VID.SECTSTRT(VID.SNLIST.VSN.S(I)-1);
      229     1809    3         DO NXTNS=0 TO 62;
      230     1810    3            AGRANS=VIDBUF.DGT.FGRAN(NXTNS);
      231     1811    3            IF VIDBUF.DTT(NXTNS)~=262143
      232     1812    4            THEN DO WHILE(AGRANS<=VIDBUF.DGT.LGRAN(NXTNS));
      233     1813    4               XTNSIZE=AGRANS-ACCTS;
      234     1814    5               IF XTNSIZE<VID.SNLIST.SIZE(I) THEN DO;
      235     1815    5                  GRANULE=XTNSIZE+MAXGRAN(I);
      236     1816    5                  CALL SETBIT;
      237     1817    5                  SGRANS=SGRANS+1;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:9    
      238     1818    5                  END;
      239     1819    4               AGRANS=AGRANS+1;
      240     1820    4               END;
      241     1821    3            END;
      242     1822    2         GRANULE=MAXGRAN(I+1);
      243     1823    2         END;
      244     1824    1      CALL SETBIT; /* SET LAST BIT TO TERMINATE XTN BUILD */
      245     1825    1      GRANULE=FM_GPSDA;
      246     1826    1      FDFDA=FM_GPSDA;
      247     1827    1      CALL SETBIT; /* RELEASE EXTENT POOL,PAD,MAD START */
      248     1828    1      FDFDA=FM_MADSDA;
      249     1829    1      IF VIDBUF.PSN='SYS' THEN CALL RELDIR;
      250     1830    1      FDFDA=FM_PADSDA;
      251     1831    1      CALL RELDIR;
      252     1832    1      ACCTS=AFILES;
      253     1833    1      NXTFPT.ACCT_=VECTOR(ERASE);
      254     1834    1   NXTA:;
      255     1835    1      NXTFPT.NAME_=VECTOR(ERASE);
      256     1836    1      AGRANS=0;
      257     1837    1      NXTFPT.V.OPER.NXTA#='1'B;
      258     1838    1      NXTFPT.V.OPER.NXTF#='0'B;
      259     1839    1      CALL M$OPEN(NXTFPT)ALTRET(NONXTA);
      260     1840    1      GOTO NONXTA; /* WE'RE IN TROUBLE IF IT WORKED */
      261     1841    1   NXTF:;
      262     1842    1      IF BREAK~=0 THEN ALTRETURN;
      263     1843    1   FXH$RECONT:ENTRY ALTRET;
      264     1844    1      IF EIDCB$=ADDR(NIL) THEN GOTO ALLDONE;
      265     1845    1      FGRANS=0;
      266     1846    1      CALL M$OPEN(NXTFPT)ALTRET(NONXTF);
      267     1847    1      IF AFILES>MAXERR+BITBIN(SHR_GAC)*MAXERR THEN GOTO FDCNTERR;
      268     1848    1      AFILES=AFILES+1;
      269     1849    1      IF NOT F$DCB.FFLG THEN GOTO NXTF;
      270     1850    1      FILES=FILES+1;
      271     1851    1      XTN$=ADDR(FIT.CODES(FIT.CODES.ITEMX(1)));
      272     1852    2      IF CODE01.XTNT.XTNSDA(0)~=F$DCB.BFR.DA(1) THEN DO;
      273     1853    2         GRANULE=F$DCB.BFR.DA(1);
      274     1854    2         CALL SETBIT ALTRET(RETALT);
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:10   
      275     1855    2         SGRANS=SGRANS+1;
      276     1856    2         END;
      277     1857    1      NXTNS=FIT.CODES.NDW(1)-2;
      278     1858    2      DO I=0 TO NXTNS;
      279     1859    2         GRANULE=CODE01.XTNT.XTNSDA(I);
      280     1860    2         XTNSIZE=CODE01.XTNT.XTNSIZE(I);
      281     1861    3         IF XTNSIZE=0 THEN DO;
      282     1862    3            XTNSIZE=CODE01.EXTNT.XTNSIZE(I);
      283     1863    3            IF XTNSIZE>SETMAX THEN XTNSIZE=SETMAX;
      284     1864    3            I=I+1;
      285     1865    3            END;
      286     1866    2         FGRANS=FGRANS+XTNSIZE;
      287     1867    3         DO WHILE (XTNSIZE>0);
      288     1868    3            CALL SETBIT ALTRET(RETALT);
      289     1869    3            XTNSIZE=XTNSIZE-1;
      290     1870    3            GRANULE=GRANULE+1;
      291     1871    3            END;
      292     1872    2         END;
      293     1873    1      CALL LOCCODT(3)ALTRET(NO3);
      294     1874    2      IF CODE03.UGRANS+CODE03.NGAVAL~=FGRANS THEN DO;
      295     1875    2         IF CODE03.UGRANS>FGRANS THEN CODE03.UGRANS=FGRANS;
      296     1876    2         CODE03.NGAVAL=FGRANS-CODE03.UGRANS;
      297     1877    2         GRANULE=F$DCB.BFR.DA(1);
      298     1878    2         CALL M$WRITEFD;
      299     1879    2         END;
      300     1880    1   NO3:;
      301     1881    1      AGRANS=AGRANS+FGRANS;
      302     1882    1      IF GAC~=0 THEN CALL FGG$PROCESS_FIT(ADDR(FIT.CODES));
      303     1883    1      GOTO NXTF;
      304     1884        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:11   
      305     1885    1   NONXTF:;
      306     1886    1      IF B$TCB.ALT$->B$ALT.ERR.CODE~=%E$FDEOF
      307     1887    2      THEN IF F$DCB.NAME~=BADS.NAME OR F$DCB.ACCT~=BADS.ACCT THEN DO;
      308     1888    2            AFILES=AFILES+1;
      309     1889    2            GRANULE=BITBIN(B$TCB.ALT$->B$ALT.ERR);
      310     1890    2            CALL SETBIT ALTRET(RETALT);
      311     1891    2            BADS.XTNT(0)=BINBIT(BADS.FDA,36);
      312     1892    2            BADS.FDA=GRANULE;
      313     1893    2            IF F$DCB.NAME.C~=' ' THEN GOTO NXTF;
      314     1894    2            END;
      315     1895    1      SGRANS=SGRANS+AGRANS;
      316     1896    2      IF AFILES~=0 THEN DO;
      317     1897    2   FDCNTERR: ERRCODE=FXH$E$FILECNT;
      318     1898                    /*E*     ERROR: FXH-E$FILECNT-E
      319     1899                    *        MESSAGE:Directory error - reconstruct aborted.
      320     1900                    *        MESSAGE1:An account or file directory has a different
      321     1901                    *        number of key entries than can be accessed by open next.
      322     1902                    *        Reconstruct continues for information only. If the error
      323     1903                    *        is not in the account directory, it can be fixed by DELETE
      324     1904                    *        of the offending account in PIG. If this is the system set
      325     1905                    *        and this reconstruct was not requested, the set must be
      326     1906                    *        accessed from a different system set to accomplish this.
      327     1907                    *        Also if this is #SYS, the cause of this error has not been
      328     1908                    *        printed, and must be determined via an online reconstruct
      329     1909                    *        command executed after the system has been brought up -
      330     1910                    *        either with no reconstruct or on a different system set.
      331     1911                    *        The alternative solution is to forget these files and use
      332     1912                    *        whatever backup measures are available.
      333     1913                    */
      334     1914    2         GRANULE=BITBIN(ERRCODE);
      335     1915    2         CALL SETBIT ALTRET(RETALT);
      336     1916    3         IF BADS.XTNT.XTNSIZE(0)~=0 THEN DO;
      337     1917    3            BADS.XTNT(0)=BINBIT(FDFDA,36);
      338     1918    3            BADS.FDA=BITBIN(ERRCODE);
      339     1919    3            END;
      340     1920    2         END;
      341     1921    2      ELSE IF AGRANS~=0 THEN DO;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:12   
      342     1922    2            GRANULE=FDFDA;
      343     1923    2            CALL M$READ(READFD)ALTRET(NXTA);
      344     1924    2            CALL LOCCODT(14)ALTRET(NXTA);
      345     1925    2            CODE14.CGRANS=CODE14.CGRANS+AGRANS;
      346     1926    2            CALL M$WRITEFD;
      347     1927    3            IF B$JIT.SYSID~=JG_SLUG# THEN DO;
      348     1928    3               CALL INSERT(ACSUM.TX,0,18,' ');
      349     1929    3               CALL DECOUT(ACSUM.TX,6,5,CODE14.CGRANS);
      350     1930    3               CALL PRINT(23);
      351     1931    3               END;
      352     1932    2            END;
      353     1933    1      GOTO NXTA;
      354     1934        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:13   
      355     1935    1   NONXTA:;
      356     1936    1      FDFDA=F$DCB.BFR.DA(1);
      357     1937    1      NXTFPT.NAME_=VECTOR(NIL);
      358     1938    1      NXTFPT.V.OPER.NXTF#='1'B;
      359     1939    1      NXTFPT.V.OPER.NXTA#='0'B;
      360     1940    2      IF F$DCB.ACCT=BADS.ACCT OR ACCTS>MAXERR THEN DO;/* WE'RE STUCK */
      361     1941    2         GRANULE=BITBIN(B$TCB.ALT$->B$ALT.ERR);
      362     1942    2         CALL SETBIT ALTRET(RETALT);
      363     1943    2         BADS.XTNT(0)=BINBIT(FDFDA,36);
      364     1944    2         BADS.FDA=GRANULE;
      365     1945    2         END;
      366     1946    2      ELSE IF F$DCB.ACCT~=' ' THEN DO;
      367     1947    2            AGRANS=B$TCB.ALT$->B$ALT.ERR.CODE;
      368     1948    2            IF AGRANS~=%E$NOKEY THEN CALL RELDIR;
      369     1949    3            IF B$JIT.SYSID~=JG_SLUG# OR COUNTONLY~=0 THEN DO;
      370     1950    4               IF FILES=0 THEN DO;
      371     1951    5                  IF GAC~=0 THEN CALL FGG$START(EIDCB$,GAC) WHENALTRETURN DO;
      372     1952    5                        SHR_GAC='0'B;
      373     1953    5                        GOTO RETALT;
      374     1954    5                        END;
      375     1955    4                  FILES=1;
      376     1956    4                  CALL PRINT(22);
      377     1957    4                  END;
      378     1958    3               IF AGRANS>0 THEN ACSUM.TX='* D E L E T E D *';
      379     1959    4               ELSE DO;
      380     1960    4                  CALL DECOUT(ACSUM.TX,0,5,-AFILES);
      381     1961    4                  CALL DECOUT(ACSUM.TX,6,5,-AGRANS);
      382     1962    4                  CALL DECOUT(ACSUM.TX,12,5,FGRANS);
      383     1963    4                  END;
      384     1964    3               CALL INSERT(ACSUM.TX,18,8,F$DCB.ACCT);
      385     1965    3               CALL PRINT(23);
      386     1966    3               END;
      387     1967    2            NXTFPT.ACCT_=VECTOR(NIL);
      388     1968    2            ACCTS=ACCTS+1;
      389     1969    2            IF COUNTONLY=0 AND AGRANS<=0 THEN GOTO NXTF;
      390     1970    2            IF BREAK~=0 THEN ALTRETURN;
      391     1971    2            GOTO NXTA;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:14   
      392     1972    2            END;
      393     1973    1      IF FILES~=0 THEN FILES=FILES-1;
      394     1974    1      IF ACCTS~=0 THEN ERRCODE=FXH$E$FILECNT;
      395     1975    1      FDFDA=4;
      396     1976    1      CALL GPDIST;
      397     1977    1      XTNDIST.OLDC=XTNDIST.NEWC;
      398     1978    1      XTNDIST.NEWC='0'B;
      399     1979    1      FDFDA=FM_GPSDA; /* FIRST GRANULE TO WRITE */
      400     1980    1      XTNSIZE=0; /* FLINK GRANULE */
      401     1981    1      FIT=GPBUF;
      402     1982    1      XTN$=ADDR(FIT.CODES);
      403     1983    1      I=1;
      404     1984    1   NXTVOL:;
      405     1985    1      VXH='0'B;
      406     1986    1      VXH.VOL=I;
      407     1987    1      VXH.XTNS=1024-SPARE-POFFW(XTN$,ADDR(FIT));
      408     1988    1      NXTNS=-1;
      409     1989    1      AGRANS=0;
      410     1990    1      VOLGRAN(I)=0;
      411     1991    1      FGRANS=MAXGRAN(I-1);
      412     1992    1      GRANULE=FGRANS-1;
      413     1993    2      DO WHILE (GRANULE<MAXGRAN(I)); /* DO ONE VOL AT A TIME */
      414     1994    2         GRANULE=GRANULE+1;
      415     1995    2         MAPX=GRANULE/36;
      416     1996    2         BITX=MOD(GRANULE,36);
      417     1997    3         IF AGRANS=0 THEN DO;
      418     1998    3            IF MAP(MAPX)=BINBIT(-1,36) THEN GRANULE=MAPX*36+35;
      419     1999    4            IF NOT MAP(MAPX)&BITS(BITX) THEN DO;
      420     2000    5               IF XTNSIZE~=0 THEN DO;
      421     2001    5                  NXTNS=NXTNS+1;
      422     2002    5                  VXH.XTN.ADR(NXTNS)=GRANULE-FGRANS;
      423     2003    6                  IF NXTNS+1=VXH.XTNS THEN DO; /* WRITE IT OUT */
      424     2004    6                     VXH.XTN.EADR(NXTNS)=GRANULE-FGRANS;
      425     2005    6                     VXH.N='1'B;
      426     2006    6                     CALL WRITEGP;
      427     2007    6                     VXH='0'B;
      428     2008    6                     VXH.VOL=I;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:15   
      429     2009    6                     VXH.XTNS=1019-SPARE;
      430     2010    6                     VXH.P='1'B;
      431     2011    6                     NXTNS=-1;
      432     2012    6                     END;
      433     2013    5                  ELSE AGRANS=1; /* SET IN EXTENT FLAG */
      434     2014    5                  END;
      435     2015    5               IF XTNSIZE=0 THEN DO;
      436     2016    5                  XTNSIZE=GRANULE+FM_SRZERO;
      437     2017    5                  SGRANS=SGRANS+1;
      438     2018    5                  END;
      439     2019    4               END;
      440     2020    3            END;
      441     2021    3         ELSE DO;
      442     2022    3            IF MAP(MAPX)='0'B THEN GRANULE=MAPX*36+35;
      443     2023    4            IF MAP(MAPX)&BITS(BITX) THEN DO; /* END OF AN EXTENT */
      444     2024    4               AGRANS=0;
      445     2025    4               VXH.XTN.EADR(NXTNS)=GRANULE-FGRANS;
      446     2026    4               MAPX=VXH.XTN.EADR(NXTNS)-VXH.XTN.ADR(NXTNS);
      447     2027    4               VOLGRAN(I)=VOLGRAN(I)+MAPX;
      448     2028    4               BITX=18;
      449     2029    5               DO WHILE(MAPX<=BITBIN(BITS(BITX)) AND BITX<36);
      450     2030    5                  BITX=BITX+1;
      451     2031    5                  END;
      452     2032    4               XTNDIST.NEWC(BITX-18)=XTNDIST.NEWC(BITX-18)+1;
      453     2033    4               END;
      454     2034    3            END;
      455     2035    2         END;
      456     2036    1      NXTNS=NXTNS+1;
      457     2037    1      VXH.XTNS=NXTNS+1;
      458     2038    1      VXH.XTN(NXTNS)=BINBIT(-1,36);
      459     2039    2      IF GRANULE<SETMAX THEN DO;
      460     2040    2         CALL WRITEGP;
      461     2041    2         I=I+1;
      462     2042    2         GOTO NXTVOL;
      463     2043    2         END;
      464     2044    1      CALL WRITEGP;
      465     2045    1      IF NOT ERRCODE AND DCBADDR(DCBNUM(M$DP))->F$DCB.FFLG.WNEW
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:16   
      466     2046    1      THEN CALL SETTIME(POFFW(ADDR(CODE04.MODIFY),ADDR(CODE04)));
      467     2047    1      IF B$JIT.SYSID=JG_SLUG# THEN CALL M$CLOSE(CLSDP)ALTRET(CLSERR);
      468     2048    1   CLSERR:;
      469     2049    1      CALL DECOUT(BADFM,1,5,FILES);
      470     2050    1      CALL DECOUT(BADFM,14,5,BADFILES);
      471     2051    1      CALL PRINT(19);
      472     2052        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:17   
      473     2053                    /* NOW LOOK AT THE ERROR REPORTS */
      474     2054    1      XTN$=BAD$;
      475     2055    1      BAD$=BAD1$;
      476     2056    2      DO WHILE(BAD$<XTN$);
      477     2057    2         BAD$=PINCRW(BAD$,SIZEW(BADS)-1+BADS.NXTNS);
      478     2058    3         IF BADS.FDA=BITBIN(FXH$E$FILECNT) THEN DO;
      479     2059    3            MSG.T='FILES MISSED IN ACCOUNT';
      480     2060    3            I=24;
      481     2061    3            END;
      482     2062    3         ELSE DO;
      483     2063    3            IF BADS.XTNT.XTNSIZE(0)=0 THEN MSG.T='ERROR OPENING NEXT';
      484     2064    3            ELSE MSG.T='DUAL ALLOCATION IN';
      485     2065    3            CALL INSERT(MSG.T,19,31,BADS.NAME.C);
      486     2066    3            I=19+BADS.NAME.L;
      487     2067    3            END;
      488     2068    2         CALL INSERT(MSG.T,I,9,'.',BADS.ACCT);
      489     2069    2         CALL INDEX1(I,' ',MSG.T,I);
      490     2070    3         IF BADS.XTNT(0) THEN DO;
      491     2071    3            CALL INSERT(MSG.T,I,4,' DA=');
      492     2072    3            I=I+4;
      493     2073    3            IF BADS.XTNT.XTNSIZE(0)>0 THEN CALL OCTOUTRD(MSG.T,I,9,BADS.FDA);
      494     2074    3            ELSE CALL OCTOUTRD(MSG.T,I,9,BADS.XTNT(0));
      495     2075    3            MSG.L=I+9;
      496     2076    3            END;
      497     2077    3         ELSE DO;
      498     2078    3            CALL INSERT(MSG.T,,19,'Accounting abort:  ');
      499     2079    3            MSG.L=I;
      500     2080    3            END;
      501     2081    2         CALL PRINT(21);
      502     2082    2         IF BADS.FDA~=BITBIN(FXH$E$FILECNT)
      503     2083    3         THEN IF BADS.XTNT.XTNSIZE(0)=0 THEN DO;
      504     2084    3               EFPT.BUF_=VECTOR(SUBSTR(MSG.T,0,120));
      505     2085    3               I=BADS.FDA/8*8;
      506     2086    3               CALL M$ERRMSG(EFPT)ALTRET(NOEMSG);
      507     2087    3   NOEMSG:     MSG.L=120;
      508     2088    3               CALL PRINT(21);
      509     2089    3               IF BADS.XTNT(0) THEN CALL DUMP5;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:18   
      510     2090    3               END;
      511     2091    3            ELSE DO I=0 TO BADS.NXTNS-1;
      512     2092    3               IF I=0 AND GRANULE~=BADS.XTNT.XTNSDA(0) THEN CALL DUMP5;
      513     2093    3               MAPX=BADS.XTNT.XTNSIZE(I);
      514     2094    3               CALL DECOUT(MSG.T,0,8,MAPX);
      515     2095    3               CALL INSERT(MSG.T,8,13,' GRANULES AT ');
      516     2096    3               CALL OCTOUT(MSG.T,21,9,BADS.XTNT(I));
      517     2097    3               MSG.L=30;
      518     2098    3               CALL PRINT(21);
      519     2099    3               GRANULE=BADS.XTNT.XTNSDA(I);
      520     2100    4               DO WHILE(GRANULE<BADS.XTNT.XTNSDA(I)+BADS.XTNT.XTNSIZE(I));
      521     2101    4                  CALL DUMP5;
      522     2102    4                  GRANULE=GRANULE+1;
      523     2103    4                  END;
      524     2104    3               END;
      525     2105    2         IF BREAK=1 AND B$JIT.SYSID~=JG_PIG# THEN XTN$=BAD$;
      526     2106    2         END;
      527     2107    1      CALL PRINT(15); /*XTNS<=N OLD  NEW */
      528     2108    1      SGRANS=SETMAX-SGRANS;
      529     2109    1   GPSUMENT:;
      530     2110    1      I=0;
      531     2111    2      DO WHILE(I<18 AND XTNDIST.OLDC(I)+XTNDIST.NEWC(I)=0);
      532     2112    2         I=I+1;
      533     2113    2         END;
      534     2114    2      DO WHILE(I<19);
      535     2115    2         CALL DECOUT(NUMBUF,1,8,BITBIN(BITS(I+17)));
      536     2116    2         CALL DECOUT(NUMBUF,9,7,XTNDIST.OLDC(I));
      537     2117    3         IF EIDCB$~=ADDR(NIL) THEN DO;
      538     2118    3            CALL DECOUT(NUMBUF,16,7,XTNDIST.NEWC(I));
      539     2119    3            END;
      540     2120    2         ELSE CALL DECOUT(NUMBUF,16,8,0);
      541     2121    2         I=I+1;
      542     2122    2         CALL PRINT(16);
      543     2123    2         END;
      544     2124    1      CALL PRINT(17);
      545     2125    1      I=0;
      546     2126    1   DNXTVOL:;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:19   
      547     2127    1      I=I+1;
      548     2128    1      CALL DECOUT(VOLBUF,1,5,I);
      549     2129    1      CALL DECOUT(VOLBUF,6,7,VOLGRAN(I));
      550     2130    1      CALL DECOUT(VOLBUF,16,7,MAXGRAN(I)-MAXGRAN(I-1));
      551     2131    1      IF EIDCB$=ADDR(NIL) THEN SGRANS=SGRANS+VOLGRAN(I);
      552     2132    1      CALL PRINT(18);
      553     2133    1      IF MAXGRAN(I)<SETMAX THEN GOTO DNXTVOL;
      554     2134    2      IF I>1 THEN DO;
      555     2135    2         SUBSTR(VOLBUF.TX,0,5)='TOTAL';
      556     2136    2         CALL DECOUT(VOLBUF,6,7,SGRANS);
      557     2137    2         CALL DECOUT(VOLBUF,16,7,SETMAX);
      558     2138    2         CALL PRINT(18);
      559     2139    2         END;
      560     2140    1      EIDCB$=ADDR(NIL); /* SET FLAG THAT WERE FINISHED */
      561     2141    1   ALLDONE:;
      562     2142    1      IF SHR_GAC AND GAC~=0 THEN ERRCODE='0'B;
      563     2143    1      IF ERRCODE='0'B THEN RETURN;
      564     2144    1      BREAK=0;
      565     2145    1      ALTRETURN;
      566     2146    1   RETALT:;
      567     2147    1      IF ERRCODE='0'B THEN ERRCODE=B$TCB.ALT$->B$ALT.ERR;
      568     2148    1      IF FILES=0 THEN GOTO ALLDONE;
      569     2149    1      GOTO CLSERR;
      570     2150        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:20   
      571     2151    1   DUMP5: PROC;
      572     2152    2      IF BREAK~=0 OR SHR_GAC THEN RETURN;
      573     2153    2      MSG='777777777777'O;
      574     2154    2      CALL M$READ(READFD)ALTRET(DMPANYWAY);
      575     2155    2   DMPANYWAY:;
      576     2156    2      MSG.T=' ';
      577     2157    2      MSG.L=66;
      578     2158    3      DO MSG.I=0 TO 4;
      579     2159    3         CALL OCTOUT(MSG.T,MSG.I*13+1,6,MSG.WD(MSG.I)/262144);
      580     2160    3         CALL OCTOUT(MSG.T,MSG.I*13+7,6,MOD(MSG.WD(MSG.I),262144));
      581     2161    3         END;
      582     2162    2      CALL PRINT(21);
      583     2163    2      IF BREAK~=0 THEN BREAK=4;
      584     2164    2      RETURN;
      585     2165    2   END DUMP5;
      586     2166        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:21   
      587     2167    1   GPDIST: PROC(MSGNUM)ALTRET;
      588     2168    2   DCL MSGNUM UBIN ALIGNED;
      589     2169    2   DCL MSGSZ UBIN(9)ALIGNED BASED;
      590     2170    2   DCL WRD(0:0)BASED ALIGNED UBIN;
      591     2171    2      FGRANS=0;
      592     2172    2      I=0;
      593     2173    2      FM$GRAN.BLINK=0;
      594     2174    2      GRANULE=1+FM_SRZERO;
      595     2175    2      XTNDIST.NEWC='0'B;
      596     2176    2      VOLGRAN='0'B;
      597     2177    3      DO WHILE (GRANULE~=0);
      598     2178    3         CALL M$READ(READFD)ALTRET(GPDERR);
      599     2179    3         IF I~=FM$GRAN.BLINK AND I~=0 THEN GOTO GPDERR;
      600     2180    3         XTN$=ADDR(FIT.CODES);
      601     2181    4         DO WHILE (FM$GRAN.NAVX>POFFW(XTN$,ADDR(FIT)));
      602     2182    5            IF VXH.XTNS<FM$GRAN.NAVX-POFFW(XTN$,ADDR(FIT)) THEN DO;
      603     2183    5               I=MOD(VXH.VOL,SIZEW(VOLGRAN));
      604     2184    5               VOLGRAN(I)=VOLGRAN(I)-FGRANS;
      605     2185    6               DO I=0 TO VXH.XTNS-2;
      606     2186    6                  AGRANS=VXH.XTN.EADR(I)-VXH.XTN.ADR(I);
      607     2187    6                  IF AGRANS>0 THEN FGRANS=FGRANS+AGRANS;
      608     2188    6                  BITX=18;
      609     2189    7                  DO WHILE (AGRANS<=BITBIN(BITS(BITX)) AND BITX<36);
      610     2190    7                     BITX=BITX+1;
      611     2191    7                     END;
      612     2192    6                  XTNDIST.NEWC(BITX-18)=XTNDIST.NEWC(BITX-18)+1;
      613     2193    6                  END;
      614     2194    5               I=MOD(VXH.VOL,SIZEW(VOLGRAN));
      615     2195    5               VOLGRAN(I)=VOLGRAN(I)+FGRANS;
      616     2196    5               XTN$=PINCRW(XTN$,VXH.XTNS+1);
      617     2197    5               END;
      618     2198    4            ELSE XTN$=ADDR(FIT.CODES(FM$GRAN.NAVX));
      619     2199    4            END;
      620     2200    3         I=GRANULE;
      621     2201    3         GRANULE=FM$GRAN.FLINK;
      622     2202    3         END;
      623     2203    2   GPDERR:;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:22   
      624     2204    2      RETURN;
      625     2205        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:23   
      626     2206    2   PRINT: ENTRY(MSGNUM) ALTRET;
      627     2207    2      IF FILES=0 THEN RETURN;/* NO PRINT IF EMPTY SET*/
      628     2208    2      LOFPT.BUF_.BUF$=PINCRC(MSGVEC(MSGNUM-15),1);
      629     2209    2      LOFPT.BUF_.BOUND=MSGVEC(MSGNUM-15)->MSGSZ-1;
      630     2210    2      CALL M$WRITE(LOFPT);
      631     2211    2      RETURN;
      632     2212        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:24   
      633     2213    2   SETTIME: ENTRY(MSGNUM) ALTRET;
      634     2214    2      GRANULE=FM_PADSDA; /* SET PAD MODIFICATION TIME */
      635     2215    2      CALL M$READ(READFD)ALTRET(GPDERR);
      636     2216    2      CALL LOCCODT(4)ALTRET(GPDERR);
      637     2217    2      FIT.CODES(0)=FIT1CODE;
      638     2218    2      FIT.CODES(1)=FIT.CODES(I);
      639     2219    2      CALL M$TIME(GETTIME);
      640     2220    2      ADDR(CODE04)->WRD(MSGNUM)=I;
      641     2221    2      CALL M$OPEN(UPD04)ALTRET(GPDERR);
      642     2222    2      RETURN;
      643     2223        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:25   
      644     2224    2   RELDIR: ENTRY ALTRET;
      645     2225    2   RLDIR:;
      646     2226    2      GRANULE=FDFDA;
      647     2227    2      FM$GRAN.BLINK=0;
      648     2228    2      I=0;
      649     2229    2      AFILES=0;
      650     2230    2      FGRANS=0;
      651     2231    2      AGRANS=0;
      652     2232    3      DO WHILE (GRANULE~=0);
      653     2233    3         CALL M$READ(READFD)ALTRET(FDERR);
      654     2234    3         IF FM$GRAN.BLINK~=I THEN GOTO LNKERR;
      655     2235    4         IF I=0 AND FM$GRAN.LVL~=FMGTMAD THEN DO;
      656     2236    4            CALL LOCCODT(14)ALTRET(NO14);
      657     2237    4            IF FM$GRAN.LVL=FMGTFD AND CODE14.CGRANS>=0 THEN AGRANS=-CODE14.CGRANS;
      658     2238    5            ELSE DO;
      659     2239    5               CODE14.CGRANS=0;
      660     2240    5               CALL M$WRITEFD;
      661     2241    5               END;
      662     2242    4   NO14:    ;
      663     2243    4            END;
      664     2244    3         AFILES=AFILES-FM$GRAN.KEYCNT;
      665     2245    3         CALL SETBIT ALTRET(FDERR);
      666     2246    3         FGRANS=FGRANS+1;
      667     2247    3         I=GRANULE;
      668     2248    3         GRANULE=FM$GRAN.FLINK;
      669     2249    3         END;
      670     2250    2      IF AGRANS>0 THEN AGRANS=-SETMAX;
      671     2251    2      SGRANS=SGRANS-AGRANS+FGRANS;
      672     2252    2      RETURN;
      673     2253    3   LNKERR: IF I=0 THEN DO WHILE(GRANULE~=0);
      674     2254    3         I=GRANULE;
      675     2255    3         GRANULE=FM$GRAN.BLINK;
      676     2256    3         CALL M$READ(READFD)ALTRET(FDERR);
      677     2257    3         IF FM$GRAN.FLINK~=I THEN GRANULE=0;
      678     2258    4         IF FM$GRAN.BLINK=0 THEN DO; /* FOUND THE REAL START */
      679     2259    4            FDFDA=GRANULE;
      680     2260    4            GOTO RLDIR;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:26   
      681     2261    4            END;
      682     2262    3         END;
      683     2263    2   FDERR:;
      684     2264    2      AFILES=1; /* FORCE A DIRECTORY ERROR */
      685     2265    2      ALTRETURN;
      686     2266        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:27   
      687     2267    2   WRITEGP: ENTRY ALTRET;
      688     2268    2      FM$GRAN.NAVX=VXH.XTNS+1+POFFW(XTN$,ADDR(FM$GRAN));
      689     2269    2      FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;
      690     2270    2      FM$GRAN.STAMP.GMOD=FDFDA;
      691     2271    2      NXTNS=GRANULE;
      692     2272    2      GRANULE=FDFDA;
      693     2273    2      IF NXTNS=SETMAX THEN FM$GRAN.FLINK=0;
      694     2274    3      ELSE DO;
      695     2275    3         FM$GRAN.FLINK=XTNSIZE;
      696     2276    3         FDFDA=XTNSIZE;
      697     2277    3         XTNSIZE=0;
      698     2278    3         END;
      699     2279    2      CALL M$WRITEFD;
      700     2280    2      FM$GRAN.BLINK=GRANULE;
      701     2281    2      GRANULE=NXTNS;
      702     2282    2      XTN$=ADDR(FIT.CODES);
      703     2283    2      RETURN;
      704     2284    2   END GPDIST;
      705     2285        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:28   
      706     2286    1   DECOUT: PROC(T,S,C,V)ALTRET;
      707     2287                    /*D*     NAME: DECOUT
      708     2288                             CALL: CALL DECOUT(T,S,C,V);
      709     2289                             DESCRIPTION: T,S,C IS SUBSTR TO STORE OUTPUT STRING.
      710     2290                                 V IS INPUT VALUE. STORES RIGHT ADJUSTED, NO LEADING
      711     2291                                 ZERO DECIMAL CONVERTED VALUE.          */
      712     2292    2   DCL T CHAR(200);
      713     2293    2   DCL 1 TN REDEF T ALIGNED,
      714     2294    2         2 N UBIN,
      715     2295    2         2 * CHAR(196);
      716     2296    2   DCL S UBIN ALIGNED;
      717     2297    2   DCL C UBIN ALIGNED;
      718     2298    2   DCL V UBIN ALIGNED;
      719     2299    2      CALL BINCHAR(SUBSTR(T,S,C),V);
      720     2300    2      CALL EDITSTR(T,S,C-1,BINBIT(C+63,9),SUBSTR(T,S,C));
      721     2301    2      RETURN;
      722     2302    2   OCTOUTRD: ENTRY(T,S,C,V)ALTRET;
      723     2303    2      GRANULE=V;
      724     2304    2   SOKAY:;
      725     2305    2   OCTOUT: ENTRY(T,S,C,V)ALTRET;
      726     2306    2      BITX=V;
      727     2307    2      NXTNS=1;
      728     2308    2      FDFDA=0;
      729     2309    3      DO MAPX=0 TO C-1;
      730     2310    3         FDFDA=FDFDA+NXTNS*MOD(BITX,8);
      731     2311    3         NXTNS=NXTNS*10;
      732     2312    3         BITX=BITX/8;
      733     2313    3         END;
      734     2314    2      CALL BINCHAR(SUBSTR(T,S,C),FDFDA);
      735     2315    2      RETURN;
      736     2316        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:29   
      737     2317    2   LOCCODT: ENTRY(T)ALTRET;
      738     2318    3      DO I=1 TO FIT.CODES.CODE(0);
      739     2319    4         IF FIT.CODES.CODE(I)=TN.N AND FIT.CODES.NDW(I)~=0 THEN DO;
      740     2320    4            XTN$=ADDR(FIT.CODES(FIT.CODES.ITEMX(I)));
      741     2321    4            RETURN;
      742     2322    4            END;
      743     2323    3         END;
      744     2324    2      ALTRETURN;
      745     2325        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:30   
      746     2326    2   SETBIT: ENTRY ALTRET;
      747     2327    2      MAPX=GRANULE;
      748     2328    2      IF MAPX>FM_SRZERO THEN MAPX=MAPX-FM_SRZERO;
      749     2329    3      IF MAPX<=SETMAX THEN DO;
      750     2330    3         BITX=MOD(MAPX,36);
      751     2331    3         MAPX=MAPX/36;
      752     2332    4         IF NOT MAP(MAPX)&BITS(BITX) THEN DO;
      753     2333    4            MAP(MAPX)=MAP(MAPX)|BITS(BITX);
      754     2334    4            RETURN;
      755     2335    4            END;
      756     2336    3         ELSE SGRANS=SGRANS-1;
      757     2337    3         END;
      758     2338    2      IF GRANULE<FM_SRZERO THEN RETURN;
      759     2339    3      IF BADS.FDA~=F$DCB.BFR.DA(1) AND BADS.FDA~=FDFDA THEN DO;
      760     2340    3         BAD$=PINCRW(BAD$,BADS.NXTNS+SIZEW(BADS)-1);
      761     2341    3         BADS.FDA=F$DCB.BFR.DA(1);
      762     2342    3         BADS.NXTNS=0;
      763     2343    3         BADS.NAME=F$DCB.NAME;
      764     2344    3         BADS.ACCT=F$DCB.ACCT;
      765     2345    4         IF FDFDA<=FM_MADSDA THEN DO;
      766     2346    4            BADS.NAME='0'B;
      767     2347    4            BADS.ACCT=SPTXTS(FDFDA-FM_SRZERO);
      768     2348    4            BADS.FDA=FDFDA;
      769     2349    4            END;
      770     2350    3         BADS.XTNT(0)='0'B;
      771     2351    3         BADFILES=BADFILES+1;
      772     2352    3         IF BADFILES=MAXERR THEN ERRCODE=FXH$E$MAXERR;
      773     2353                    /*E*     ERROR:   FXH-E$MAXERR-E
      774     2354                    *        MESSAGE:Too many errors occurred - reconstruct aborted.
      775     2355                    *        MESSAGE1:More than 20 errors occurred during reconstruct,
      776     2356                    *        indicating that this packset is probably in more trouble
      777     2357                    *        than reconstruct can repair. File access (e.g. for backup)
      778     2358                    *        will not do any more damage, but updating or creating files
      779     2359                    *        should be avoided. A rebuild of the packset is suggested.
      780     2360                    *        If there is a lot of dual allocation and the first or
      781     2361                    *        second such file listed has many granules so indicated,
      782     2362                    *        it may be expedient to delete that file and try again.
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:31   
      783     2363                    */
      784     2364    3         END;
      785     2365                    /* ADD TO BAD EXTENT LIST */
      786     2366    2      MAPX=BADS.XTNT.XTNSIZE(BADS.NXTNS-1);
      787     2367    3      IF MAPX<511 AND GRANULE=BADS.XTNT.XTNSDA(BADS.NXTNS-1)+MAPX THEN DO;
      788     2368    3         BADS.XTNT.XTNSIZE(BADS.NXTNS-1)=MAPX+1;
      789     2369    3         RETURN;
      790     2370    3         END;
      791     2371    2      IF PINCRW(BAD$,BADS.NXTNS+2*SIZEW(BADS))>PINCRW(MAP_.PTR$,MAP_.W1.VSIZE#/4)
      792     2372    2      THEN CALL M$GDS(MAPSEG)ALTRET(SBITALT);
      793     2373    2      BADS.XTNT.XTNSDA(BADS.NXTNS)=GRANULE;
      794     2374    2      BADS.XTNT.XTNSIZE(BADS.NXTNS)=1;
      795     2375    2      BADS.NXTNS=BADS.NXTNS+1;
      796     2376    2      RETURN;
      797     2377    2   SBITALT:;
      798     2378    2      ERRCODE=B$TCB.ALT$->B$ALT.ERR;
      799     2379    2      ALTRETURN;
      800     2380        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:32   
      801     2381    2   M$WRITEFD:ENTRY ALTRET;
      802     2382    2      IF ERRCODE OR COUNTONLY~=0 THEN RETURN;
      803     2383    2      CALL M$WRITE(WRITEFD)ALTRET(NOWRITEFD);
      804     2384    2      RETURN;
      805     2385    2   NOWRITEFD:;
      806     2386    2      RETURN;
      807     2387    2   END DECOUT;
      808     2388    1   END FXH$RECON;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:33   
--  Include file information  --

   F$DCB.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXH$RECON.

   Procedure FXH$RECON requires 1889 words for executable code.
   Procedure FXH$RECON requires 122 words of local(AUTO) storage.

    No errors detected in file FXH$RECON.:E05TSI    .

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:34   

 Object Unit name= FXH$RECON                                  File name= FXH$RECON.:E05TOU
 UTS= JUL 29 '97 18:06:57.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   198    306  FXH$RECON
    2  RoData even  UTS    197    305  FXH$RECON
    3   DCB   even  none     0      0  M$EI
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$DP
    6   Proc  even  none  1889   3541  FXH$RECON
    7  RoData even  none    71    107  FXH$RECON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        1  FXH$RECON
     6      4          yes     yes      Std        0  FXH$COUNT
     6      7          yes     yes      Std        1  FXH$TIME
     6     21          yes     yes      Std        0  FXH$GPSUM
     6    367          yes     yes      Std        0  FXH$RECONT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1    134  RCNSN                              1    213  M$DP$
    1    214  SGRANS                             1    305  GAC
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:35   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FGG$PROCESS_FIT
 yes     yes           Std       2 FGG$START
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$JIT$                                B$TCB$
     VIDBUF                                BREAK                                 GPBUF
     M$EI                                  M$LO                                  M$DP
     ERRCODE                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:36   


        1        1        /*M* FXH$RECON - Reconstruct a packset's free extent list */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9        FXH$RECON:PROC(PARM)ALTRET;

      9  6 000000   000000 700200 xent  FXH$RECON    TSX0  ! X66_AUTO_1
         6 000001   000172 000001                    ZERO    122,1

       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE FM$MACROS;
       12      466        %INCLUDE FX_PERR_C;
       13      525        %INCLUDE F_ERRORS_C;
       14      765        %INCLUDE F$JIT_C;
       15      882        %INCLUDE JG_GHOSTS_C;
       16      972    1   DCL B$JIT$ PTR SYMREF;
       17      973    1   DCL B$TCB$ PTR SYMREF;
       18      974        %B$TCB(STCLASS="BASED(B$TCB$)");
       19      977        %B$ALT;
       20      985        %CODE01(BASED="BASED(XTN$)");
       21      989        %CODE03(BASED="BASED(XTN$)");
       22      996        %CODE04(BASED="BASED(XTN$)");
       23     1004        %CODE14(BASED="BASED(XTN$)");
       24     1014        %SUB VID=VIDBUF;
       25     1015        %SUB FCG#='0630'O;
       26     1016        %SUB MID#='10'O;
       27     1017        %FM$VID(BASED=SYMREF,FM$VID=VID);
       28     1023        %FM$FIT(FM$FIT=FIT,BASED="REDEF VID,2 *(0:4)UBIN",N=1018);
       29     1026        %FM$GRAN(BASED=REDEF VID,FLINK="FLINK UBIN,2 *(0:1018)");
       30     1030    1   DCL 1 MSG REDEF VID,
       31     1031    1         2 WD(0:510) UBIN,
       32     1032    1         2 I UBIN,
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:37   
       33     1033    1         2 L UBIN(9)UNAL,
       34     1034    1         2 T CHAR(2047);
       35     1035        %FM$GP(FM$GP=VXH,BASED="BASED(XTN$)");
       36     1039        %FPT_GDS(FPTN=MAPSEG,RESULTS=MAP_,SEGSIZE=1024);
       37     1055        %VLP_VECTOR(FPTN=MAP_,SEGID='0'B);
       38     1070        %FPT_TIME(FPTN=GETTIME,STCLASS=CONSTANT,DEST=UTS,TSTAMP=I);
       39     1089        %FPT_OPEN(FPTN=NXTFPT,
       40     1090                 DCB=M$EI,
       41     1091                 FPARAM=FIT,
       42     1092                 SN=RCNSN,
       43     1093                 ACS=BLOCK,
       44     1094                 TEST=YES,
       45     1095                 FUN=IN,
       46     1096                 ANYF=YES,
       47     1097                 ASN=FILE);
       48     1206        %FPT_OPEN(FPTN=UPD04,
       49     1207                 DCB=M$EI,
       50     1208                 IFPARAM=FIT.CODES,
       51     1209                 ACCT=PAD_FIT,
       52     1210                 SN=RCNSN,
       53     1211                 RES='DP',
       54     1212                 STCLASS=CONSTANT,
       55     1213                 ASN=DEVICE);
       56     1322        %FM_FITCODE(NAME=FIT1CODE,CODE=1,NAW=2);
       57     1325        %VLP_ACCT(FPTN=PAD_FIT,STCLASS=CONSTANT,ACCT="BINASC(0)");
       58     1338        %FPT_ERRMSG(FPTN=EFPT,CODE=I);
       59     1365    1   DCL BREAK UBIN SYMREF;
       60     1366    1   DCL 1 RCNSN STATIC SYMDEF,
       61     1367    1         2 * UBIN INIT(1),
       62     1368    1         2 SN CHAR(6);
       63     1369    1   DCL GPBUF(0:6)UBIN SYMREF;
       64     1370        %FPT_READ(FPTN=READFD,
       65     1371                 STCLASS=CONSTANT,
       66     1372                 DCB=M$DP,
       67     1373                 BUF=FIT,
       68     1374                 KEYS=YES,
       69     1375                 KEY=GRANULE);
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:38   
       70     1414        %FPT_WRITE(FPTN=WRITEFD,
       71     1415                 STCLASS=CONSTANT,
       72     1416                 DCB=M$DP,
       73     1417                 KEY=GRANULE,
       74     1418                 BUF=FIT);
       75     1449        %FPT_WRITE(DCB=M$LO,
       76     1450                 FPTN=LOFPT,
       77     1451                 BUF=DISTH);
       78     1482        %FPT_CLOSE(FPTN=CLSDP,
       79     1483        DCB=M$DP);
       80     1525    1   DCL M$EI DCB;
       81     1526    1   DCL M$LO DCB;
       82     1527    1   DCL M$DP DCB;
       83     1528        %MACRO F$DCB#(BASED=BASED);
       84     1529        %INCLUDE F$DCB;
       85     1578        %MEND;
       86     1579        %F$DCB#(BASED="BASED(EIDCB$)");
       87     1629    1   DCL BAD$ PTR STATIC; /* Must be static - see FXH$RECONT */
       88     1630    1   DCL PARM UBIN ALIGNED;
       89     1631    1   DCL M$DP$ PTR STATIC SYMDEF;
       90     1632    1   DCL SGRANS UBIN STATIC SYMDEF;
       91     1633    1   DCL I UBIN STATIC;
       92     1634    1   DCL GRANULE SBIN STATIC;
       93     1635    1   DCL ERRCODE BIT(36)SYMREF;
       94     1636    1   DCL MAXERR UBIN STATIC INIT(20);
       95     1637    1   DCL SPARE UBIN STATIC INIT(200);/* SPARE SPACE TO LEAVE IN GP GRANS*/
       96     1638        %ERRCODE(NAME=FXH$E$MAXERR,COD#=E$MAXERR);
       97     1642        %ERRCODE(NAME=FXH$E$FILECNT,COD#=E$FILECNT);
       98     1646    1   DCL MAPX SBIN;
       99     1647    1   DCL BITX UBIN;
      100     1648    1   DCL BITS(0:35)BIT(36)INIT('4'O,'2'O,'1'O,'04'O,'02'O,'01'O,'004'O,'002'O,'001'O,
      101     1649    1   '0004'O,'0002'O,'0001'O,'00004'O,'00002'O,'00001'O,'000004'O,'000002'O,'000001'O,
      102     1650    1   '0000004'O,'0000002'O,'0000001'O,'00000004'O,'00000002'O,'00000001'O,
      103     1651    1   '000000004'O,'000000002'O,'000000001'O,'0000000004'O,'0000000002'O,'0000000001'O,
      104     1652    1   '00000000004'O,'00000000002'O,'00000000001'O,
      105     1653    1   '000000000004'O,'000000000002'O,'000000000001'O)CONSTANT;
      106     1654    1   DCL EIDCB$ PTR;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:39   
      107     1655    1   DCL BAD1$ PTR;
      108     1656    1   DCL XTN$ PTR;
      109     1657    1   DCL SETMAX UBIN;
      110     1658    1   DCL NXTNS SBIN;
      111     1659    1   DCL AGRANS SBIN;
      112     1660    1   DCL FGRANS UBIN;
      113     1661    1   DCL XTNSIZE UBIN;
      114     1662    1   DCL FDFDA UBIN;
      115     1663    1   DCL COUNTONLY UBIN; /* FLAG FOR COUNT ONLY OPERATION */
      116     1664    1   DCL BADFILES UBIN;
      117     1665    1   DCL FILES SBIN;
      118     1666    1   DCL AFILES SBIN;
      119     1667    1   DCL ACCTS SBIN;
      120     1668    1   DCL MAXGRAN(0:19) UBIN;
      121     1669    1   DCL VOLGRAN(0:19)UBIN;
      122     1670    1   DCL 1 XTNDIST,
      123     1671    1         2 OLDC(0:18)UBIN,
      124     1672    1         2 NEWC(0:18)UBIN;
      125     1673    1   DCL SHR_GAC BIT(1);
      126     1674    1   DCL FM_SRZERO UBIN CONSTANT INIT(67174400);
      127     1675    1   DCL FM_MADSDA UBIN CONSTANT INIT(67174403);
      128     1676    1   DCL FM_PADSDA UBIN CONSTANT INIT(67174402);
      129     1677    1   DCL FM_GPSDA UBIN CONSTANT INIT(67174401);
      130     1678    1   DCL SPTXTS(0:4)CONSTANT CHAR(4)INIT('VID.','GP.','PAD.','MAD.','FND.');
      131     1679    1   DCL MSGVEC(0:15)PTR CONSTANT INIT(
      132     1680    1   ADDR(DISTH),ADDR(NUMBUF),
      133     1681    1   ADDR(VOLH),ADDR(VOLBUF),
      134     1682    1   ADDR(BADFM),ADDR(DISTH1),
      135     1683    1   ADDR(MSG.L),
      136     1684    1   ADDR(ACHDR),ADDR(ACSUM),
      137     1685    1   ADDR(NIL)*0);
      138     1686        %MACRO TXC(TT=*,N=,T=);
      139     1687        DCL 1 N STATIC,
      140     1688              2 * UBIN(9)INIT(SIZEC(T))UNAL,
      141     1689              2 TT CHAR(0)INIT(T);
      142     1690        %MEND;
      143     1691        %TXC(N=BADFM,T="'00000 FILES, 00000 ERRORS'");
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:40   
      144     1696        %TXC(N=DISTH1,T='FREE EXTENTS: N/2<SIZE<=N');
      145     1701        %TXC(N=DISTH,T='XTNTS<=N    OLD    NEW');
      146     1706        %TXC(N=NUMBUF,TT=TX,T='1234567812345671234567');
      147     1711        %TXC(N=VOLH,T='FREE GRANULES BY VOLUME');
      148     1716        %TXC(N=VOLBUF,TT=TX,T='VVVVV1234567 OF1234567');
      149     1721        %TXC(N=ACSUM,TT=TX,T='12345 12345 12345 ABCDEFGH');
      150     1726        %TXC(N=ACHDR,T="'NAMES GRANS  (FD) ACCOUNT'");
      151     1731        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:41   
      152     1732    1   DCL 1 BADS BASED(BAD$)ALIGNED,
      153     1733    1         2 FDA UBIN,
      154     1734    1         2 NAME,
      155     1735    1           3 L UBIN BYTE UNAL,
      156     1736    1           3 C CHAR(31),
      157     1737    1         2 ACCT CHAR(8),
      158     1738    1         2 NXTNS SBIN,
      159     1739    1         2 XTNT(0:0),
      160     1740    1           3 XTNSIZE UBIN BYTE UNAL,
      161     1741    1           3 XTNSDA UBIN(27) UNAL;
      162     1742    1   DCL MAP(0:0)BASED(MAP_.PTR$)BIT(36)ALIGNED;
      163     1743        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:42   
      164     1744    1   DCL GAC SBIN STATIC SYMDEF INIT(0);
      165     1745    1   DCL FGG$START ENTRY(2)ALTRET;
      166     1746    1   DCL FGG$PROCESS_FIT ENTRY(1)ALTRET;
      167     1747    1   DCL FGG$DONE ENTRY ALTRET;
      168     1748    1   DCL FGG$QUIT ENTRY ALTRET;
      169     1749    1      COUNTONLY=0;

   1749  6 000002   200017 450100                    STZ     COUNTONLY,,AUTO

      170     1750    1      GOTO NOTCOUNT;

   1750  6 000003   000013 710000 6                  TRA     NOTCOUNT

      171     1751    1   FXH$COUNT: ENTRY ALTRET;

   1751  6 000004   000000 700200 xent  FXH$COUNT    TSX0  ! X66_AUTO_1
         6 000005   000172 000001                    ZERO    122,1
         6 000006   000011 710000 6                  TRA     s:1753

      172     1752    1   FXH$TIME: ENTRY(PARM)ALTRET;

   1752  6 000007   000000 700200 xent  FXH$TIME     TSX0  ! X66_AUTO_1
         6 000010   000172 000001                    ZERO    122,1

      173     1753    1      COUNTONLY=1;

   1753  6 000011   000001 235007                    LDA     1,DL
         6 000012   200017 755100                    STA     COUNTONLY,,AUTO

   1753  6 000013                       NOTCOUNT     null
      174     1754    1   NOTCOUNT:;
      175     1755    1      EIDCB$=DCBADDR(DCBNUM(M$EI));

   1755  6 000013   000000 236007 xsym               LDQ     M$EI,DL
         6 000014   000000 470400 7                  LDP0    0
         6 000015   000000 471500                    LDP1    0,,PR0
         6 000016   100000 236106                    LDQ     0,QL,PR1
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:43   
         6 000017   200006 756100                    STQ     EIDCB$,,AUTO

      176     1756    1      GOTO NOTGPSUM;

   1756  6 000020   000025 710000 6                  TRA     NOTGPSUM

      177     1757    1   FXH$GPSUM: ENTRY ALTRET;

   1757  6 000021   000000 700200 xent  FXH$GPSUM    TSX0  ! X66_AUTO_1
         6 000022   000172 000001                    ZERO    122,1

      178     1758    1      EIDCB$=ADDR(NIL);

   1758  6 000023   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000024   200006 756100                    STQ     EIDCB$,,AUTO

   1758  6 000025                       NOTGPSUM     null
      179     1759    1   NOTGPSUM:;
      180     1760    1      BADFILES=0;

   1760  6 000025   200020 450100                    STZ     BADFILES,,AUTO

      181     1761    1      ERRCODE='0'B;

   1761  6 000026   000000 450000 xsym               STZ     ERRCODE

      182     1762    1      FILES=0;

   1762  6 000027   200021 450100                    STZ     FILES,,AUTO

      183     1763    1      MAXGRAN(0)=0;

   1763  6 000030   200024 450100                    STZ     MAXGRAN,,AUTO

      184     1764    1      RCNSN.SN=M$DP$->F$DCB.PSN;

   1764  6 000031   000213 470400 1                  LDP0    M$DP$
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:44   
         6 000032   040000 100500                    MLR     fill='040'O
         6 000033   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         6 000034   000135 000006 1                  ADSC9   RCNSN+1                  cn=0,n=6

      185     1765    1      SHR_GAC='0'B;

   1765  6 000035   200142 450100                    STZ     SHR_GAC,,AUTO

      186     1766    1      IF GAC~=0 AND NOT M$DP$->F$DCB.OWNER THEN SHR_GAC='1'B;

   1766  6 000036   000305 235000 1                  LDA     GAC
         6 000037   000045 600000 6                  TZE     s:1767
         6 000040   000064 236100                    LDQ     52,,PR0
         6 000041   040000 316007                    CANQ    16384,DL
         6 000042   000045 601000 6                  TNZ     s:1767

   1766  6 000043   400000 236003                    LDQ     -131072,DU
         6 000044   200142 756100                    STQ     SHR_GAC,,AUTO

      187     1767    1      IF ADDR(PARM)~=ADDR(NIL)

   1767  6 000045   200003 236100                    LDQ     @PARM,,AUTO
         6 000046   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000047   000062 600000 6                  TZE     s:1774

      188     1768    2      THEN IF COUNTONLY~=0 THEN DO;

   1768  6 000050   200017 235100                    LDA     COUNTONLY,,AUTO
         6 000051   000056 600000 6                  TZE     s:1773

      189     1769                    /* MUST BE TIME ENTRY */
      190     1770    2            CALL SETTIME(PARM);

   1770  6 000052   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 000053   002651 701000 6                  TSX1    SETTIME
         6 000054   000000 011000                    NOP     0

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:45   
      191     1771    2            RETURN;

   1771  6 000055   000000 702200 xent               TSX2  ! X66_ARET

      192     1772    2            END;
      193     1773    1         ELSE MAXERR=PARM;

   1773  6 000056   200003 471500                    LDP1    @PARM,,AUTO
         6 000057   100000 235100                    LDA     0,,PR1
         6 000060   000217 755000 1                  STA     MAXERR
         6 000061   000064 710000 6                  TRA     s:1775

      194     1774    1      ELSE MAXERR=20;

   1774  6 000062   000024 235007                    LDA     20,DL
         6 000063   000217 755000 1                  STA     MAXERR

      195     1775    1      GRANULE=0;

   1775  6 000064   000216 450000 1                  STZ     GRANULE

      196     1776    1      CALL M$READ(READFD)ALTRET(RETALT);

   1776  6 000065   000112 630400 2                  EPPR0   READFD
         6 000066   440000 713400                    CLIMB   alt,read
         6 000067   401400 401760                    pmme    nvectors=4
         6 000070   002300 702000 6                  TSX2    RETALT

      197     1777    1      SETMAX=0;

   1777  6 000071   200011 450100                    STZ     SETMAX,,AUTO

      198     1778    2      DO I=0 TO VID.VOLCNT-1;

   1778  6 000072   000215 450000 1                  STZ     I
         6 000073   000106 710000 6                  TRA     s:1781+3

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:46   
      199     1779    2         SETMAX=SETMAX+VID.SNLIST.SIZE(I);

   1779  6 000074   000215 235000 1                  LDA     I
         6 000075   000002 735000                    ALS     2
         6 000076   200011 236100                    LDQ     SETMAX,,AUTO
         6 000077   000501 036005 xsym               ADLQ    VIDBUF+321,AL
         6 000100   200011 756100                    STQ     SETMAX,,AUTO

      200     1780    2         MAXGRAN(I+1)=SETMAX;

   1780  6 000101   000215 720000 1                  LXL0    I
         6 000102   200025 756110                    STQ     MAXGRAN+1,X0,AUTO

      201     1781    2         END;

   1781  6 000103   000215 235000 1                  LDA     I
         6 000104   000001 035007                    ADLA    1,DL
         6 000105   000215 755000 1                  STA     I
         6 000106   000004 236000 xsym               LDQ     VIDBUF+4
         6 000107   777777 376007                    ANQ     -1,DL
         6 000110   000215 116000 1                  CMPQ    I
         6 000111   000113 600000 6                  TZE     s:1782
         6 000112   000074 603000 6                  TRC     s:1779

      202     1782    2      IF EIDCB$=ADDR(NIL) THEN DO;

   1782  6 000113   200006 236100                    LDQ     EIDCB$,,AUTO
         6 000114   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000115   000144 601000 6                  TNZ     s:1792

      203     1783    2         IF B$JIT.SYSID~=JG_SLUG#

   1783  6 000116   000000 470400 xsym               LDP0    B$JIT$
         6 000117   000000 720100                    LXL0    0,,PR0
         6 000120   000001 100003                    CMPX0   1,DU
         6 000121   000124 600000 6                  TZE     s:1785

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:47   
      204     1784    2         THEN FILES=1;/* FORCE PRINTING*/

   1784  6 000122   000001 235007                    LDA     1,DL
         6 000123   200021 755100                    STA     FILES,,AUTO

      205     1785    2         CALL GPDIST;

   1785  6 000124   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000125   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 000126   002424 701000 6                  TSX1    GPDIST
         6 000127   000000 011000                    NOP     0

      206     1786    2         XTNDIST.OLDC=XTNDIST.NEWC;

   1786  6 000130   000100 100500                    MLR     fill='000'O
         6 000131   200117 000114                    ADSC9   XTNDIST+19,,AUTO         cn=0,n=76
         6 000132   200074 000114                    ADSC9   XTNDIST,,AUTO            cn=0,n=76

      207     1787    2         NUMBUF.TX=' ';

   1787  6 000133   040000 100400                    MLR     fill='040'O
         6 000134   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000135   000245 200026 1                  ADSC9   NUMBUF                   cn=1,n=22

      208     1788    2         CALL PRINT(20);

   1788  6 000136   000002 236000 7                  LDQ     2
         6 000137   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 000140   002622 701000 6                  TSX1    PRINT
         6 000141   000000 011000                    NOP     0

      209     1789    2         SGRANS=0;

   1789  6 000142   000214 450000 1                  STZ     SGRANS

      210     1790    2         GOTO GPSUMENT;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:48   
   1790  6 000143   002046 710000 6                  TRA     GPSUMENT

      211     1791    2         END;
      212     1792    1      GRANULE=(SETMAX+1+2*SIZEB(BADS))/36; /* SPACE FOR A BIT MAP */

   1792  6 000144   200011 236100                    LDQ     SETMAX,,AUTO
         6 000145   001651 036007                    ADLQ    937,DL
         6 000146   000001 772000                    QRL     1
         6 000147   000022 506007                    DIV     18,DL
         6 000150   000216 756000 1                  STQ     GRANULE

      213     1793    2      DO WHILE (GRANULE>MAP_.W1.VSIZE#/4);

   1793  6 000151   000156 710000 6                  TRA     s:1795

      214     1794    2         CALL M$GDS(MAPSEG)ALTRET(RETALT);

   1794  6 000152   000000 630400 1                  EPPR0   MAPSEG
         6 000153   430001 713400                    CLIMB   alt,gds
         6 000154   400400 401760                    pmme    nvectors=2
         6 000155   002300 702000 6                  TSX2    RETALT

      215     1795    2         END;

   1795  6 000156   000006 236000 1                  LDQ     MAP_
         6 000157   000020 772000                    QRL     16
         6 000160   000002 772000                    QRL     2
         6 000161   000164 604000 6                  TMI     s:1796
         6 000162   000216 116000 1                  CMPQ    GRANULE
         6 000163   000152 604000 6                  TMI     s:1794

      216     1796    2      DO I=0 TO GRANULE;

   1796  6 000164   000215 450000 1                  STZ     I
         6 000165   000174 710000 6                  TRA     s:1798+3

      217     1797    2         MAP(I)='0'B;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:49   

   1797  6 000166   000007 470400 1                  LDP0    MAP_+1
         6 000167   000215 720000 1                  LXL0    I
         6 000170   000000 450110                    STZ     0,X0,PR0

      218     1798    2         END;

   1798  6 000171   000215 235000 1                  LDA     I
         6 000172   000001 035007                    ADLA    1,DL
         6 000173   000215 755000 1                  STA     I
         6 000174   000215 236000 1                  LDQ     I
         6 000175   000200 604000 6                  TMI     s:1799
         6 000176   000216 116000 1                  CMPQ    GRANULE
         6 000177   000166 604400 6                  TMOZ    s:1797

      219     1799    1      BAD$=PINCRW(MAP_.PTR$,GRANULE+1-2*SIZEW(BADS));

   1799  6 000200   000216 236000 1                  LDQ     GRANULE
         6 000201   000022 736000                    QLS     18
         6 000202   000031 136003                    SBLQ    25,DU
         6 000203   000007 036000 1                  ADLQ    MAP_+1
         6 000204   000212 756000 1                  STQ     BAD$

      220     1800    1      BAD1$=BAD$;

   1800  6 000205   200007 756100                    STQ     BAD1$,,AUTO

      221     1801    1      SGRANS=VID.VOLCNT+1;

   1801  6 000206   000004 236000 xsym               LDQ     VIDBUF+4
         6 000207   777777 376007                    ANQ     -1,DL
         6 000210   000001 036007                    ADLQ    1,DL
         6 000211   000214 756000 1                  STQ     SGRANS

      222     1802    1      GRANULE=0;

   1802  6 000212   000216 450000 1                  STZ     GRANULE
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:50   

      223     1803    1      FDFDA=FM_SRZERO;

   1803  6 000213   000212 235000 2                  LDA     FM_SRZERO
         6 000214   200016 755100                    STA     FDFDA,,AUTO

      224     1804    2      DO I=0 TO VID.VOLCNT-1;

   1804  6 000215   000215 450000 1                  STZ     I
         6 000216   000313 710000 6                  TRA     s:1823+3

      225     1805    2         CALL M$READ(READFD)ALTRET(RETALT);

   1805  6 000217   000112 630400 2                  EPPR0   READFD
         6 000220   440000 713400                    CLIMB   alt,read
         6 000221   401400 401760                    pmme    nvectors=4
         6 000222   002300 702000 6                  TSX2    RETALT

      226     1806    2         CALL SETBIT;

   1806  6 000223   003275 701000 6                  TSX1    SETBIT
         6 000224   000000 011000                    NOP     0

      227     1807    2         IF VID.SNLIST.VSN.S(I)=0 THEN ACCTS=0;

   1807  6 000225   000215 235000 1                  LDA     I
         6 000226   000002 735000                    ALS     2
         6 000227   000500 236005 xsym               LDQ     VIDBUF+320,AL
         6 000230   777000 316003                    CANQ    -512,DU
         6 000231   000234 601000 6                  TNZ     s:1808

   1807  6 000232   200023 450100                    STZ     ACCTS,,AUTO
         6 000233   000240 710000 6                  TRA     s:1809

      228     1808    2         ELSE ACCTS=VID.SECTSTRT(VID.SNLIST.VSN.S(I)-1);

   1808  6 000234   000500 236005 xsym               LDQ     VIDBUF+320,AL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:51   
         6 000235   000033 772000                    QRL     27
         6 000236   000007 235006 xsym               LDA     VIDBUF+7,QL
         6 000237   200023 755100                    STA     ACCTS,,AUTO

      229     1809    3         DO NXTNS=0 TO 62;

   1809  6 000240   200012 450100                    STZ     NXTNS,,AUTO

      230     1810    3            AGRANS=VIDBUF.DGT.FGRAN(NXTNS);

   1810  6 000241   200012 720100                    LXL0    NXTNS,,AUTO
         6 000242   000300 236010 xsym               LDQ     VIDBUF+192,X0
         6 000243   000022 772000                    QRL     18
         6 000244   200013 756100                    STQ     AGRANS,,AUTO

      231     1811    3            IF VIDBUF.DTT(NXTNS)~=262143

   1811  6 000245   000400 221010 xsym               LDX1    VIDBUF+256,X0
         6 000246   777777 101003                    CMPX1   -1,DU
         6 000247   000301 600000 6                  TZE     s:1821

      232     1812    4            THEN DO WHILE(AGRANS<=VIDBUF.DGT.LGRAN(NXTNS));

   1812  6 000250   000300 236010 xsym               LDQ     VIDBUF+192,X0
         6 000251   777777 376007                    ANQ     -1,DL
         6 000252   200013 116100                    CMPQ    AGRANS,,AUTO
         6 000253   000301 604000 6                  TMI     s:1821

      233     1813    4               XTNSIZE=AGRANS-ACCTS;

   1813  6 000254   200013 236100                    LDQ     AGRANS,,AUTO
         6 000255   200023 136100                    SBLQ    ACCTS,,AUTO
         6 000256   200015 756100                    STQ     XTNSIZE,,AUTO

      234     1814    5               IF XTNSIZE<VID.SNLIST.SIZE(I) THEN DO;

   1814  6 000257   000215 235000 1                  LDA     I
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:52   
         6 000260   000002 735000                    ALS     2
         6 000261   000501 116005 xsym               CMPQ    VIDBUF+321,AL
         6 000262   000273 603000 6                  TRC     s:1819

      235     1815    5                  GRANULE=XTNSIZE+MAXGRAN(I);

   1815  6 000263   000215 720000 1                  LXL0    I
         6 000264   200024 036110                    ADLQ    MAXGRAN,X0,AUTO
         6 000265   000216 756000 1                  STQ     GRANULE

      236     1816    5                  CALL SETBIT;

   1816  6 000266   003275 701000 6                  TSX1    SETBIT
         6 000267   000000 011000                    NOP     0

      237     1817    5                  SGRANS=SGRANS+1;

   1817  6 000270   000214 235000 1                  LDA     SGRANS
         6 000271   000001 035007                    ADLA    1,DL
         6 000272   000214 755000 1                  STA     SGRANS

      238     1818    5                  END;

      239     1819    4               AGRANS=AGRANS+1;

   1819  6 000273   200013 054100                    AOS     AGRANS,,AUTO

      240     1820    4               END;

   1820  6 000274   200012 720100                    LXL0    NXTNS,,AUTO
         6 000275   000300 236010 xsym               LDQ     VIDBUF+192,X0
         6 000276   777777 376007                    ANQ     -1,DL
         6 000277   200013 116100                    CMPQ    AGRANS,,AUTO
         6 000300   000254 605000 6                  TPL     s:1813

      241     1821    3            END;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:53   
   1821  6 000301   200012 054100                    AOS     NXTNS,,AUTO
         6 000302   200012 235100                    LDA     NXTNS,,AUTO
         6 000303   000076 115007                    CMPA    62,DL
         6 000304   000241 604400 6                  TMOZ    s:1810

      242     1822    2         GRANULE=MAXGRAN(I+1);

   1822  6 000305   000215 720000 1                  LXL0    I
         6 000306   200025 235110                    LDA     MAXGRAN+1,X0,AUTO
         6 000307   000216 755000 1                  STA     GRANULE

      243     1823    2         END;

   1823  6 000310   000215 236000 1                  LDQ     I
         6 000311   000001 036007                    ADLQ    1,DL
         6 000312   000215 756000 1                  STQ     I
         6 000313   000004 236000 xsym               LDQ     VIDBUF+4
         6 000314   777777 376007                    ANQ     -1,DL
         6 000315   000215 116000 1                  CMPQ    I
         6 000316   000320 600000 6                  TZE     s:1824
         6 000317   000217 603000 6                  TRC     s:1805

      244     1824    1      CALL SETBIT; /* SET LAST BIT TO TERMINATE XTN BUILD */

   1824  6 000320   003275 701000 6                  TSX1    SETBIT
         6 000321   000000 011000                    NOP     0

      245     1825    1      GRANULE=FM_GPSDA;

   1825  6 000322   000215 235000 2                  LDA     FM_GPSDA
         6 000323   000216 755000 1                  STA     GRANULE

      246     1826    1      FDFDA=FM_GPSDA;

   1826  6 000324   200016 755100                    STA     FDFDA,,AUTO

      247     1827    1      CALL SETBIT; /* RELEASE EXTENT POOL,PAD,MAD START */
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:54   

   1827  6 000325   003275 701000 6                  TSX1    SETBIT
         6 000326   000000 011000                    NOP     0

      248     1828    1      FDFDA=FM_MADSDA;

   1828  6 000327   000213 235000 2                  LDA     FM_MADSDA
         6 000330   200016 755100                    STA     FDFDA,,AUTO

      249     1829    1      IF VIDBUF.PSN='SYS' THEN CALL RELDIR;

   1829  6 000331   040000 106400                    CMPC    fill='040'O
         6 000332   000003 000006 xsym               ADSC9   VIDBUF+3                 cn=0,n=6
         6 000333   000243 000003 2                  ADSC9   MSGVEC+16                cn=0,n=3
         6 000334   000337 601000 6                  TNZ     s:1830

   1829  6 000335   002707 701000 6                  TSX1    RELDIR
         6 000336   000000 011000                    NOP     0

      250     1830    1      FDFDA=FM_PADSDA;

   1830  6 000337   000214 235000 2                  LDA     FM_PADSDA
         6 000340   200016 755100                    STA     FDFDA,,AUTO

      251     1831    1      CALL RELDIR;

   1831  6 000341   002707 701000 6                  TSX1    RELDIR
         6 000342   000000 011000                    NOP     0

      252     1832    1      ACCTS=AFILES;

   1832  6 000343   200022 235100                    LDA     AFILES,,AUTO
         6 000344   200023 755100                    STA     ACCTS,,AUTO

      253     1833    1      NXTFPT.ACCT_=VECTOR(ERASE);

   1833  6 000345   000004 237000 7                  LDAQ    4
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:55   
         6 000346   000034 757000 1                  STAQ    NXTFPT+20

   1833  6 000347                       NXTA         null
      254     1834    1   NXTA:;
      255     1835    1      NXTFPT.NAME_=VECTOR(ERASE);

   1835  6 000347   000004 237000 7                  LDAQ    4
         6 000350   000016 757000 1                  STAQ    NXTFPT+6

      256     1836    1      AGRANS=0;

   1836  6 000351   200013 450100                    STZ     AGRANS,,AUTO

      257     1837    1      NXTFPT.V.OPER.NXTA#='1'B;

   1837  6 000352   010000 236007                    LDQ     4096,DL
         6 000353   000054 256000 1                  ORSQ    NXTFPT+36

      258     1838    1      NXTFPT.V.OPER.NXTF#='0'B;

   1838  6 000354   000006 236000 7                  LDQ     6
         6 000355   000054 356000 1                  ANSQ    NXTFPT+36

      259     1839    1      CALL M$OPEN(NXTFPT)ALTRET(NONXTA);

   1839  6 000356   000010 630400 1                  EPPR0   NXTFPT
         6 000357   450000 713400                    CLIMB   alt,open
         6 000360   410400 401760                    pmme    nvectors=18
         6 000361   000722 702000 6                  TSX2    NONXTA

      260     1840    1      GOTO NONXTA; /* WE'RE IN TROUBLE IF IT WORKED */

   1840  6 000362   000722 710000 6                  TRA     NONXTA

   1838  6 000363                       NXTF         null
      261     1841    1   NXTF:;
      262     1842    1      IF BREAK~=0 THEN ALTRETURN;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:56   

   1842  6 000363   000000 235000 xsym               LDA     BREAK
         6 000364   000366 600000 6                  TZE     s:1842+1

   1842  6 000365   000000 702200 xent               TSX2  ! X66_AALT
         6 000366   000371 710000 6                  TRA     s:1844

      263     1843    1   FXH$RECONT:ENTRY ALTRET;

   1843  6 000367   000000 700200 xent  FXH$RECONT   TSX0  ! X66_AUTO_1
         6 000370   000172 000001                    ZERO    122,1

      264     1844    1      IF EIDCB$=ADDR(NIL) THEN GOTO ALLDONE;

   1844  6 000371   200006 236100                    LDQ     EIDCB$,,AUTO
         6 000372   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000373   002266 600000 6                  TZE     ALLDONE

      265     1845    1      FGRANS=0;

   1845  6 000374   200014 450100                    STZ     FGRANS,,AUTO

      266     1846    1      CALL M$OPEN(NXTFPT)ALTRET(NONXTF);

   1846  6 000375   000010 630400 1                  EPPR0   NXTFPT
         6 000376   450000 713400                    CLIMB   alt,open
         6 000377   410400 401760                    pmme    nvectors=18
         6 000400   000570 702000 6                  TSX2    NONXTF

      267     1847    1      IF AFILES>MAXERR+BITBIN(SHR_GAC)*MAXERR THEN GOTO FDCNTERR;

   1847  6 000401   200142 236100                    LDQ     SHR_GAC,,AUTO
         6 000402   000043 772000                    QRL     35
         6 000403   000217 402000 1                  MPY     MAXERR
         6 000404   000217 036000 1                  ADLQ    MAXERR
         6 000405   000410 604000 6                  TMI     s:1848
         6 000406   200022 116100                    CMPQ    AFILES,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:57   
         6 000407   000634 604000 6                  TMI     FDCNTERR

      268     1848    1      AFILES=AFILES+1;

   1848  6 000410   200022 054100                    AOS     AFILES,,AUTO

      269     1849    1      IF NOT F$DCB.FFLG THEN GOTO NXTF;

   1849  6 000411   200006 470500                    LDP0    EIDCB$,,AUTO
         6 000412   000004 220100                    LDX0    4,,PR0
         6 000413   000363 600000 6                  TZE     NXTF

      270     1850    1      FILES=FILES+1;

   1850  6 000414   200021 054100                    AOS     FILES,,AUTO

      271     1851    1      XTN$=ADDR(FIT.CODES(FIT.CODES.ITEMX(1)));

   1851  6 000415   000006 720000 xsym               LXL0    VIDBUF+6
         6 000416   001777 360003                    ANX0    1023,DU
         6 000417   000005 631410 xsym               EPPR1   VIDBUF+5,X0
         6 000420   200010 451500                    STP1    XTN$,,AUTO

      272     1852    2      IF CODE01.XTNT.XTNSDA(0)~=F$DCB.BFR.DA(1) THEN DO;

   1852  6 000421   100001 236100                    LDQ     1,,PR1
         6 000422   000116 676100                    ERQ     78,,PR0
         6 000423   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000424   000435 600000 6                  TZE     s:1857

      273     1853    2         GRANULE=F$DCB.BFR.DA(1);

   1853  6 000425   000116 236100                    LDQ     78,,PR0
         6 000426   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000427   000216 756000 1                  STQ     GRANULE

      274     1854    2         CALL SETBIT ALTRET(RETALT);
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:58   

   1854  6 000430   003275 701000 6                  TSX1    SETBIT
         6 000431   002300 702000 6                  TSX2    RETALT

      275     1855    2         SGRANS=SGRANS+1;

   1855  6 000432   000214 235000 1                  LDA     SGRANS
         6 000433   000001 035007                    ADLA    1,DL
         6 000434   000214 755000 1                  STA     SGRANS

      276     1856    2         END;

      277     1857    1      NXTNS=FIT.CODES.NDW(1)-2;

   1857  6 000435   000006 236000 xsym               LDQ     VIDBUF+6
         6 000436   000012 772000                    QRL     10
         6 000437   001777 376007                    ANQ     1023,DL
         6 000440   000002 136007                    SBLQ    2,DL
         6 000441   200012 756100                    STQ     NXTNS,,AUTO

      278     1858    2      DO I=0 TO NXTNS;

   1858  6 000442   000215 450000 1                  STZ     I
         6 000443   000506 710000 6                  TRA     s:1872+3

      279     1859    2         GRANULE=CODE01.XTNT.XTNSDA(I);

   1859  6 000444   200010 470500                    LDP0    XTN$,,AUTO
         6 000445   000215 720000 1                  LXL0    I
         6 000446   000001 236110                    LDQ     1,X0,PR0
         6 000447   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000450   000216 756000 1                  STQ     GRANULE

      280     1860    2         XTNSIZE=CODE01.XTNT.XTNSIZE(I);

   1860  6 000451   000001 236110                    LDQ     1,X0,PR0
         6 000452   000033 772000                    QRL     27
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:59   
         6 000453   200015 756100                    STQ     XTNSIZE,,AUTO

      281     1861    3         IF XTNSIZE=0 THEN DO;

   1861  6 000454   000466 601000 6                  TNZ     s:1866

      282     1862    3            XTNSIZE=CODE01.EXTNT.XTNSIZE(I);

   1862  6 000455   000002 235110                    LDA     2,X0,PR0
         6 000456   200015 755100                    STA     XTNSIZE,,AUTO

      283     1863    3            IF XTNSIZE>SETMAX THEN XTNSIZE=SETMAX;

   1863  6 000457   200011 236100                    LDQ     SETMAX,,AUTO
         6 000460   200015 116100                    CMPQ    XTNSIZE,,AUTO
         6 000461   000463 603000 6                  TRC     s:1864

   1863  6 000462   200015 756100                    STQ     XTNSIZE,,AUTO

      284     1864    3            I=I+1;

   1864  6 000463   000215 235000 1                  LDA     I
         6 000464   000001 035007                    ADLA    1,DL
         6 000465   000215 755000 1                  STA     I

      285     1865    3            END;

      286     1866    2         FGRANS=FGRANS+XTNSIZE;

   1866  6 000466   200014 236100                    LDQ     FGRANS,,AUTO
         6 000467   200015 036100                    ADLQ    XTNSIZE,,AUTO
         6 000470   200014 756100                    STQ     FGRANS,,AUTO

      287     1867    3         DO WHILE (XTNSIZE>0);

   1867  6 000471   200015 235100                    LDA     XTNSIZE,,AUTO
         6 000472   000503 600000 6                  TZE     s:1872
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:60   

      288     1868    3            CALL SETBIT ALTRET(RETALT);

   1868  6 000473   003275 701000 6                  TSX1    SETBIT
         6 000474   002300 702000 6                  TSX2    RETALT

      289     1869    3            XTNSIZE=XTNSIZE-1;

   1869  6 000475   200015 235100                    LDA     XTNSIZE,,AUTO
         6 000476   000001 135007                    SBLA    1,DL
         6 000477   200015 755100                    STA     XTNSIZE,,AUTO

      290     1870    3            GRANULE=GRANULE+1;

   1870  6 000500   000216 054000 1                  AOS     GRANULE

      291     1871    3            END;

   1871  6 000501   000000 115003                    CMPA    0,DU
         6 000502   000473 601000 6                  TNZ     s:1868

      292     1872    2         END;

   1872  6 000503   000215 236000 1                  LDQ     I
         6 000504   000001 036007                    ADLQ    1,DL
         6 000505   000215 756000 1                  STQ     I
         6 000506   000215 236000 1                  LDQ     I
         6 000507   000512 604000 6                  TMI     s:1873
         6 000510   200012 116100                    CMPQ    NXTNS,,AUTO
         6 000511   000444 604400 6                  TMOZ    s:1859

      293     1873    1      CALL LOCCODT(3)ALTRET(NO3);

   1873  6 000512   000007 236000 7                  LDQ     7
         6 000513   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 000514   003241 701000 6                  TSX1    LOCCODT
         6 000515   000552 702000 6                  TSX2    NO3
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:61   

      294     1874    2      IF CODE03.UGRANS+CODE03.NGAVAL~=FGRANS THEN DO;

   1874  6 000516   200010 470500                    LDP0    XTN$,,AUTO
         6 000517   000003 236100                    LDQ     3,,PR0
         6 000520   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000521   200156 756100                    STQ     @V+2,,AUTO
         6 000522   000000 236100                    LDQ     0,,PR0
         6 000523   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000524   200156 036100                    ADLQ    @V+2,,AUTO
         6 000525   200014 116100                    CMPQ    FGRANS,,AUTO
         6 000526   000552 600000 6                  TZE     NO3

      295     1875    2         IF CODE03.UGRANS>FGRANS THEN CODE03.UGRANS=FGRANS;

   1875  6 000527   000000 236100                    LDQ     0,,PR0
         6 000530   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000531   200014 116100                    CMPQ    FGRANS,,AUTO
         6 000532   000536 602000 6                  TNC     s:1876
         6 000533   000536 600000 6                  TZE     s:1876

   1875  6 000534   200014 236100                    LDQ     FGRANS,,AUTO
         6 000535   000000 552134                    STBQ    0,'34'O,PR0

      296     1876    2         CODE03.NGAVAL=FGRANS-CODE03.UGRANS;

   1876  6 000536   000000 236100                    LDQ     0,,PR0
         6 000537   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000540   200156 756100                    STQ     @V+2,,AUTO
         6 000541   200014 236100                    LDQ     FGRANS,,AUTO
         6 000542   200156 136100                    SBLQ    @V+2,,AUTO
         6 000543   000003 552134                    STBQ    3,'34'O,PR0

      297     1877    2         GRANULE=F$DCB.BFR.DA(1);

   1877  6 000544   200006 471500                    LDP1    EIDCB$,,AUTO
         6 000545   100116 236100                    LDQ     78,,PR1
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:62   
         6 000546   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000547   000216 756000 1                  STQ     GRANULE

      298     1878    2         CALL M$WRITEFD;

   1878  6 000550   003523 701000 6                  TSX1    M$WRITEFD
         6 000551   000000 011000                    NOP     0

      299     1879    2         END;

      300     1880    1   NO3:;

   1880  6 000552                       NO3          null
      301     1881    1      AGRANS=AGRANS+FGRANS;

   1881  6 000552   200013 236100                    LDQ     AGRANS,,AUTO
         6 000553   200014 036100                    ADLQ    FGRANS,,AUTO
         6 000554   200013 756100                    STQ     AGRANS,,AUTO

      302     1882    1      IF GAC~=0 THEN CALL FGG$PROCESS_FIT(ADDR(FIT.CODES));

   1882  6 000555   000305 235000 1                  LDA     GAC
         6 000556   000567 600000 6                  TZE     s:1883

   1882  6 000557   000010 236000 7                  LDQ     8
         6 000560   200156 756100                    STQ     @V+2,,AUTO
         6 000561   200156 630500                    EPPR0   @V+2,,AUTO
         6 000562   200157 450500                    STP0    @V+3,,AUTO
         6 000563   200157 630500                    EPPR0   @V+3,,AUTO
         6 000564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000565   000000 701000 xent               TSX1    FGG$PROCESS_FIT
         6 000566   000000 011000                    NOP     0

      303     1883    1      GOTO NXTF;

   1883  6 000567   000363 710000 6                  TRA     NXTF

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:63   
   1882  6 000570                       NONXTF       null
      304     1884        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:64   
      305     1885    1   NONXTF:;
      306     1886    1      IF B$TCB.ALT$->B$ALT.ERR.CODE~=%E$FDEOF

   1886  6 000570   000000 470400 xsym               LDP0    B$TCB$
         6 000571   000000 471500                    LDP1    0,,PR0
         6 000572   100102 236100                    LDQ     66,,PR1
         6 000573   377770 376007                    ANQ     131064,DL
         6 000574   001540 116007                    CMPQ    864,DL
         6 000575   000627 600000 6                  TZE     s:1895

      307     1887    2      THEN IF F$DCB.NAME~=BADS.NAME OR F$DCB.ACCT~=BADS.ACCT THEN DO;

   1887  6 000576   200006 473500                    LDP3    EIDCB$,,AUTO
         6 000577   000212 474400 1                  LDP4    BAD$
         6 000600   000100 106500                    CMPC    fill='000'O
         6 000601   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         6 000602   400001 000040                    ADSC9   1,,PR4                   cn=0,n=32
         6 000603   000610 601000 6                  TNZ     s:1888
         6 000604   040100 106500                    CMPC    fill='040'O
         6 000605   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8
         6 000606   400011 000010                    ADSC9   9,,PR4                   cn=0,n=8
         6 000607   000627 600000 6                  TZE     s:1895

      308     1888    2            AFILES=AFILES+1;

   1888  6 000610   200022 054100                    AOS     AFILES,,AUTO

      309     1889    2            GRANULE=BITBIN(B$TCB.ALT$->B$ALT.ERR);

   1889  6 000611   100102 235100                    LDA     66,,PR1
         6 000612   000216 755000 1                  STA     GRANULE

      310     1890    2            CALL SETBIT ALTRET(RETALT);

   1890  6 000613   003275 701000 6                  TSX1    SETBIT
         6 000614   002300 702000 6                  TSX2    RETALT

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:65   
      311     1891    2            BADS.XTNT(0)=BINBIT(BADS.FDA,36);

   1891  6 000615   000212 470400 1                  LDP0    BAD$
         6 000616   000000 236100                    LDQ     0,,PR0
         6 000617   000014 756100                    STQ     12,,PR0

      312     1892    2            BADS.FDA=GRANULE;

   1892  6 000620   000216 235000 1                  LDA     GRANULE
         6 000621   000000 755100                    STA     0,,PR0

      313     1893    2            IF F$DCB.NAME.C~=' ' THEN GOTO NXTF;

   1893  6 000622   200006 471500                    LDP1    EIDCB$,,AUTO
         6 000623   040000 106500                    CMPC    fill='040'O
         6 000624   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31
         6 000625   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000626   000363 601000 6                  TNZ     NXTF

      314     1894    2            END;

      315     1895    1      SGRANS=SGRANS+AGRANS;

   1895  6 000627   000214 236000 1                  LDQ     SGRANS
         6 000630   200013 036100                    ADLQ    AGRANS,,AUTO
         6 000631   000214 756000 1                  STQ     SGRANS

      316     1896    2      IF AFILES~=0 THEN DO;

   1896  6 000632   200022 235100                    LDA     AFILES,,AUTO
         6 000633   000653 600000 6                  TZE     s:1921

      317     1897    2   FDCNTERR: ERRCODE=FXH$E$FILECNT;

   1897  6 000634   000145 236000 2     FDCNTERR     LDQ     FXH$E$FILECNT
         6 000635   000000 756000 xsym               STQ     ERRCODE

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:66   
      318     1898                    /*E*     ERROR: FXH-E$FILECNT-E
      319     1899                    *        MESSAGE:Directory error - reconstruct aborted.
      320     1900                    *        MESSAGE1:An account or file directory has a different
      321     1901                    *        number of key entries than can be accessed by open next.
      322     1902                    *        Reconstruct continues for information only. If the error
      323     1903                    *        is not in the account directory, it can be fixed by DELETE
      324     1904                    *        of the offending account in PIG. If this is the system set
      325     1905                    *        and this reconstruct was not requested, the set must be
      326     1906                    *        accessed from a different system set to accomplish this.
      327     1907                    *        Also if this is #SYS, the cause of this error has not been
      328     1908                    *        printed, and must be determined via an online reconstruct
      329     1909                    *        command executed after the system has been brought up -
      330     1910                    *        either with no reconstruct or on a different system set.
      331     1911                    *        The alternative solution is to forget these files and use
      332     1912                    *        whatever backup measures are available.
      333     1913                    */
      334     1914    2         GRANULE=BITBIN(ERRCODE);

   1914  6 000636   000000 235000 xsym               LDA     ERRCODE
         6 000637   000216 755000 1                  STA     GRANULE

      335     1915    2         CALL SETBIT ALTRET(RETALT);

   1915  6 000640   003275 701000 6                  TSX1    SETBIT
         6 000641   002300 702000 6                  TSX2    RETALT

      336     1916    3         IF BADS.XTNT.XTNSIZE(0)~=0 THEN DO;

   1916  6 000642   000212 470400 1                  LDP0    BAD$
         6 000643   000014 236100                    LDQ     12,,PR0
         6 000644   777000 316003                    CANQ    -512,DU
         6 000645   000721 600000 6                  TZE     s:1933

      337     1917    3            BADS.XTNT(0)=BINBIT(FDFDA,36);

   1917  6 000646   200016 236100                    LDQ     FDFDA,,AUTO
         6 000647   000014 756100                    STQ     12,,PR0
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:67   

      338     1918    3            BADS.FDA=BITBIN(ERRCODE);

   1918  6 000650   000000 235000 xsym               LDA     ERRCODE
         6 000651   000000 755100                    STA     0,,PR0

      339     1919    3            END;

      340     1920    2         END;

   1920  6 000652   000721 710000 6                  TRA     s:1933

      341     1921    2      ELSE IF AGRANS~=0 THEN DO;

   1921  6 000653   200013 235100                    LDA     AGRANS,,AUTO
         6 000654   000721 600000 6                  TZE     s:1933

      342     1922    2            GRANULE=FDFDA;

   1922  6 000655   200016 235100                    LDA     FDFDA,,AUTO
         6 000656   000216 755000 1                  STA     GRANULE

      343     1923    2            CALL M$READ(READFD)ALTRET(NXTA);

   1923  6 000657   000112 630400 2                  EPPR0   READFD
         6 000660   440000 713400                    CLIMB   alt,read
         6 000661   401400 401760                    pmme    nvectors=4
         6 000662   000347 702000 6                  TSX2    NXTA

      344     1924    2            CALL LOCCODT(14)ALTRET(NXTA);

   1924  6 000663   000012 236000 7                  LDQ     10
         6 000664   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 000665   003241 701000 6                  TSX1    LOCCODT
         6 000666   000347 702000 6                  TSX2    NXTA

      345     1925    2            CODE14.CGRANS=CODE14.CGRANS+AGRANS;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:68   

   1925  6 000667   200010 470500                    LDP0    XTN$,,AUTO
         6 000670   000002 236100                    LDQ     2,,PR0
         6 000671   200013 036100                    ADLQ    AGRANS,,AUTO
         6 000672   000002 756100                    STQ     2,,PR0

      346     1926    2            CALL M$WRITEFD;

   1926  6 000673   003523 701000 6                  TSX1    M$WRITEFD
         6 000674   000000 011000                    NOP     0

      347     1927    3            IF B$JIT.SYSID~=JG_SLUG# THEN DO;

   1927  6 000675   000000 470400 xsym               LDP0    B$JIT$
         6 000676   000000 720100                    LXL0    0,,PR0
         6 000677   000001 100003                    CMPX0   1,DU
         6 000700   000721 600000 6                  TZE     s:1933

      348     1928    3               CALL INSERT(ACSUM.TX,0,18,' ');

   1928  6 000701   040000 100400                    MLR     fill='040'O
         6 000702   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000703   000267 200022 1                  ADSC9   ACSUM                    cn=1,n=18

      349     1929    3               CALL DECOUT(ACSUM.TX,6,5,CODE14.CGRANS);

   1929  6 000704   200010 236100                    LDQ     XTN$,,AUTO
         6 000705   000002 036003                    ADLQ    2,DU
         6 000706   200154 756100                    STQ     @C+1,,AUTO
         6 000707   000014 237000 7                  LDAQ    12
         6 000710   200152 757100                    STAQ    @T+1,,AUTO
         6 000711   000016 236000 7                  LDQ     14
         6 000712   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 000713   003127 701000 6                  TSX1    DECOUT
         6 000714   000000 011000                    NOP     0

      350     1930    3               CALL PRINT(23);
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:69   

   1930  6 000715   000020 236000 7                  LDQ     16
         6 000716   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 000717   002622 701000 6                  TSX1    PRINT
         6 000720   000000 011000                    NOP     0

      351     1931    3               END;

      352     1932    2            END;

      353     1933    1      GOTO NXTA;

   1933  6 000721   000347 710000 6                  TRA     NXTA

   1930  6 000722                       NONXTA       null
      354     1934        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:70   
      355     1935    1   NONXTA:;
      356     1936    1      FDFDA=F$DCB.BFR.DA(1);

   1936  6 000722   200006 470500                    LDP0    EIDCB$,,AUTO
         6 000723   000116 236100                    LDQ     78,,PR0
         6 000724   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000725   200016 756100                    STQ     FDFDA,,AUTO

      357     1937    1      NXTFPT.NAME_=VECTOR(NIL);

   1937  6 000726   000022 237000 7                  LDAQ    18
         6 000727   000016 757000 1                  STAQ    NXTFPT+6

      358     1938    1      NXTFPT.V.OPER.NXTF#='1'B;

   1938  6 000730   004000 236007                    LDQ     2048,DL
         6 000731   000054 256000 1                  ORSQ    NXTFPT+36

      359     1939    1      NXTFPT.V.OPER.NXTA#='0'B;

   1939  6 000732   000024 236000 7                  LDQ     20
         6 000733   000054 356000 1                  ANSQ    NXTFPT+36

      360     1940    2      IF F$DCB.ACCT=BADS.ACCT OR ACCTS>MAXERR THEN DO;/* WE'RE STUCK */

   1940  6 000734   000212 471400 1                  LDP1    BAD$
         6 000735   040100 106500                    CMPC    fill='040'O
         6 000736   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         6 000737   100011 000010                    ADSC9   9,,PR1                   cn=0,n=8
         6 000740   000745 600000 6                  TZE     s:1941
         6 000741   000217 236000 1                  LDQ     MAXERR
         6 000742   000761 604000 6                  TMI     s:1946
         6 000743   200023 116100                    CMPQ    ACCTS,,AUTO
         6 000744   000761 605000 6                  TPL     s:1946

      361     1941    2         GRANULE=BITBIN(B$TCB.ALT$->B$ALT.ERR);

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:71   
   1941  6 000745   000000 473400 xsym               LDP3    B$TCB$
         6 000746   300000 474500                    LDP4    0,,PR3
         6 000747   400102 235100                    LDA     66,,PR4
         6 000750   000216 755000 1                  STA     GRANULE

      362     1942    2         CALL SETBIT ALTRET(RETALT);

   1942  6 000751   003275 701000 6                  TSX1    SETBIT
         6 000752   002300 702000 6                  TSX2    RETALT

      363     1943    2         BADS.XTNT(0)=BINBIT(FDFDA,36);

   1943  6 000753   200016 236100                    LDQ     FDFDA,,AUTO
         6 000754   000212 470400 1                  LDP0    BAD$
         6 000755   000014 756100                    STQ     12,,PR0

      364     1944    2         BADS.FDA=GRANULE;

   1944  6 000756   000216 235000 1                  LDA     GRANULE
         6 000757   000000 755100                    STA     0,,PR0

      365     1945    2         END;

   1945  6 000760   001116 710000 6                  TRA     s:1973

      366     1946    2      ELSE IF F$DCB.ACCT~=' ' THEN DO;

   1946  6 000761   000020 237100                    LDAQ    16,,PR0
         6 000762   000026 117000 7                  CMPAQ   22
         6 000763   001116 600000 6                  TZE     s:1973

      367     1947    2            AGRANS=B$TCB.ALT$->B$ALT.ERR.CODE;

   1947  6 000764   000000 473400 xsym               LDP3    B$TCB$
         6 000765   300000 474500                    LDP4    0,,PR3
         6 000766   400102 236100                    LDQ     66,,PR4
         6 000767   000003 772000                    QRL     3
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:72   
         6 000770   037777 376007                    ANQ     16383,DL
         6 000771   200013 756100                    STQ     AGRANS,,AUTO

      368     1948    2            IF AGRANS~=%E$NOKEY THEN CALL RELDIR;

   1948  6 000772   000102 116007                    CMPQ    66,DL
         6 000773   000776 600000 6                  TZE     s:1949

   1948  6 000774   002707 701000 6                  TSX1    RELDIR
         6 000775   000000 011000                    NOP     0

      369     1949    3            IF B$JIT.SYSID~=JG_SLUG# OR COUNTONLY~=0 THEN DO;

   1949  6 000776   000000 470400 xsym               LDP0    B$JIT$
         6 000777   000000 720100                    LXL0    0,,PR0
         6 001000   000001 100003                    CMPX0   1,DU
         6 001001   001004 601000 6                  TNZ     s:1950
         6 001002   200017 235100                    LDA     COUNTONLY,,AUTO
         6 001003   001103 600000 6                  TZE     s:1967

      370     1950    4               IF FILES=0 THEN DO;

   1950  6 001004   200021 235100                    LDA     FILES,,AUTO
         6 001005   001031 601000 6                  TNZ     s:1958

      371     1951    5                  IF GAC~=0 THEN CALL FGG$START(EIDCB$,GAC) WHENALTRETURN DO;

   1951  6 001006   000305 236000 1                  LDQ     GAC
         6 001007   001023 600000 6                  TZE     s:1955

   1951  6 001010   000025 236000 7                  LDQ     21
         6 001011   200157 756100                    STQ     @V+3,,AUTO
         6 001012   200006 631500                    EPPR1   EIDCB$,,AUTO
         6 001013   200156 451500                    STP1    @V+2,,AUTO
         6 001014   200156 630500                    EPPR0   @V+2,,AUTO
         6 001015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 001016   000000 701000 xent               TSX1    FGG$START
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:73   
         6 001017   001021 702000 6                  TSX2    s:1952
         6 001020   001023 710000 6                  TRA     s:1955

      372     1952    5                        SHR_GAC='0'B;

   1952  6 001021   200142 450100                    STZ     SHR_GAC,,AUTO

      373     1953    5                        GOTO RETALT;

   1953  6 001022   002300 710000 6                  TRA     RETALT

      374     1954    5                        END;
      375     1955    4                  FILES=1;

   1955  6 001023   000001 235007                    LDA     1,DL
         6 001024   200021 755100                    STA     FILES,,AUTO

      376     1956    4                  CALL PRINT(22);

   1956  6 001025   000031 236000 7                  LDQ     25
         6 001026   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 001027   002622 701000 6                  TSX1    PRINT
         6 001030   000000 011000                    NOP     0

      377     1957    4                  END;

      378     1958    3               IF AGRANS>0 THEN ACSUM.TX='* D E L E T E D *';

   1958  6 001031   200013 235100                    LDA     AGRANS,,AUTO
         6 001032   001037 604400 6                  TMOZ    s:1960

   1958  6 001033   040000 100400                    MLR     fill='040'O
         6 001034   000244 000021 2                  ADSC9   MSGVEC+17                cn=0,n=17
         6 001035   000267 200032 1                  ADSC9   ACSUM                    cn=1,n=26
         6 001036   001073 710000 6                  TRA     s:1964

      379     1959    4               ELSE DO;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:74   

      380     1960    4                  CALL DECOUT(ACSUM.TX,0,5,-AFILES);

   1960  6 001037   200022 336100                    LCQ     AFILES,,AUTO
         6 001040   200162 756100                    STQ     @V+6,,AUTO
         6 001041   200162 630500                    EPPR0   @V+6,,AUTO
         6 001042   200154 450500                    STP0    @C+1,,AUTO
         6 001043   000032 237000 7                  LDAQ    26
         6 001044   200152 757100                    STAQ    @T+1,,AUTO
         6 001045   000016 236000 7                  LDQ     14
         6 001046   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001047   003127 701000 6                  TSX1    DECOUT
         6 001050   000000 011000                    NOP     0

      381     1961    4                  CALL DECOUT(ACSUM.TX,6,5,-AGRANS);

   1961  6 001051   200013 335100                    LCA     AGRANS,,AUTO
         6 001052   200163 755100                    STA     @V+7,,AUTO
         6 001053   200163 630500                    EPPR0   @V+7,,AUTO
         6 001054   200154 450500                    STP0    @C+1,,AUTO
         6 001055   000014 237000 7                  LDAQ    12
         6 001056   200152 757100                    STAQ    @T+1,,AUTO
         6 001057   000016 236000 7                  LDQ     14
         6 001060   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001061   003127 701000 6                  TSX1    DECOUT
         6 001062   000000 011000                    NOP     0

      382     1962    4                  CALL DECOUT(ACSUM.TX,12,5,FGRANS);

   1962  6 001063   200014 630500                    EPPR0   FGRANS,,AUTO
         6 001064   200154 450500                    STP0    @C+1,,AUTO
         6 001065   000036 237000 7                  LDAQ    30
         6 001066   200152 757100                    STAQ    @T+1,,AUTO
         6 001067   000016 236000 7                  LDQ     14
         6 001070   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001071   003127 701000 6                  TSX1    DECOUT
         6 001072   000000 011000                    NOP     0
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:75   

      383     1963    4                  END;

      384     1964    3               CALL INSERT(ACSUM.TX,18,8,F$DCB.ACCT);

   1964  6 001073   200006 470500                    LDP0    EIDCB$,,AUTO
         6 001074   040000 100500                    MLR     fill='040'O
         6 001075   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         6 001076   000273 600010 1                  ADSC9   ACSUM+4                  cn=3,n=8

      385     1965    3               CALL PRINT(23);

   1965  6 001077   000020 236000 7                  LDQ     16
         6 001100   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 001101   002622 701000 6                  TSX1    PRINT
         6 001102   000000 011000                    NOP     0

      386     1966    3               END;

      387     1967    2            NXTFPT.ACCT_=VECTOR(NIL);

   1967  6 001103   000022 237000 7                  LDAQ    18
         6 001104   000034 757000 1                  STAQ    NXTFPT+20

      388     1968    2            ACCTS=ACCTS+1;

   1968  6 001105   200023 054100                    AOS     ACCTS,,AUTO

      389     1969    2            IF COUNTONLY=0 AND AGRANS<=0 THEN GOTO NXTF;

   1969  6 001106   200017 235100                    LDA     COUNTONLY,,AUTO
         6 001107   001112 601000 6                  TNZ     s:1970
         6 001110   200013 235100                    LDA     AGRANS,,AUTO
         6 001111   000363 604400 6                  TMOZ    NXTF

      390     1970    2            IF BREAK~=0 THEN ALTRETURN;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:76   
   1970  6 001112   000000 235000 xsym               LDA     BREAK
         6 001113   001115 600000 6                  TZE     s:1971

   1970  6 001114   000000 702200 xent               TSX2  ! X66_AALT

      391     1971    2            GOTO NXTA;

   1971  6 001115   000347 710000 6                  TRA     NXTA

      392     1972    2            END;
      393     1973    1      IF FILES~=0 THEN FILES=FILES-1;

   1973  6 001116   200021 235100                    LDA     FILES,,AUTO
         6 001117   001122 600000 6                  TZE     s:1974

   1973  6 001120   000001 336007                    LCQ     1,DL
         6 001121   200021 056100                    ASQ     FILES,,AUTO

      394     1974    1      IF ACCTS~=0 THEN ERRCODE=FXH$E$FILECNT;

   1974  6 001122   200023 235100                    LDA     ACCTS,,AUTO
         6 001123   001126 600000 6                  TZE     s:1975

   1974  6 001124   000145 236000 2                  LDQ     FXH$E$FILECNT
         6 001125   000000 756000 xsym               STQ     ERRCODE

      395     1975    1      FDFDA=4;

   1975  6 001126   000004 236007                    LDQ     4,DL
         6 001127   200016 756100                    STQ     FDFDA,,AUTO

      396     1976    1      CALL GPDIST;

   1976  6 001130   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001131   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 001132   002424 701000 6                  TSX1    GPDIST
         6 001133   000000 011000                    NOP     0
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:77   

      397     1977    1      XTNDIST.OLDC=XTNDIST.NEWC;

   1977  6 001134   000100 100500                    MLR     fill='000'O
         6 001135   200117 000114                    ADSC9   XTNDIST+19,,AUTO         cn=0,n=76
         6 001136   200074 000114                    ADSC9   XTNDIST,,AUTO            cn=0,n=76

      398     1978    1      XTNDIST.NEWC='0'B;

   1978  6 001137   000100 100400                    MLR     fill='000'O
         6 001140   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 001141   200117 000114                    ADSC9   XTNDIST+19,,AUTO         cn=0,n=76

      399     1979    1      FDFDA=FM_GPSDA; /* FIRST GRANULE TO WRITE */

   1979  6 001142   000215 235000 2                  LDA     FM_GPSDA
         6 001143   200016 755100                    STA     FDFDA,,AUTO

      400     1980    1      XTNSIZE=0; /* FLINK GRANULE */

   1980  6 001144   200015 450100                    STZ     XTNSIZE,,AUTO

      401     1981    1      FIT=GPBUF;

   1981  6 001145   010000 220003                    LDX0    4096,DU
         6 001146   000040 100400                    MLR     fill='000'O
         6 001147   000000 000034 xsym               ADSC9   GPBUF                    cn=0,n=28
         6 001150   000000 000010 xsym               ADSC9   VIDBUF                   cn=0,n=*X0

      402     1982    1      XTN$=ADDR(FIT.CODES);

   1982  6 001151   000010 236000 7                  LDQ     8
         6 001152   200010 756100                    STQ     XTN$,,AUTO

      403     1983    1      I=1;

   1983  6 001153   000001 235007                    LDA     1,DL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:78   
         6 001154   000215 755000 1                  STA     I

   1983  6 001155                       NXTVOL       null
      404     1984    1   NXTVOL:;
      405     1985    1      VXH='0'B;

   1985  6 001155   200010 470500                    LDP0    XTN$,,AUTO
         6 001156   000000 450100                    STZ     0,,PR0
         6 001157   000001 450100                    STZ     1,,PR0

      406     1986    1      VXH.VOL=I;

   1986  6 001160   000215 236000 1                  LDQ     I
         6 001161   000033 736000                    QLS     27
         6 001162   000000 552140                    STBQ    0,'40'O,PR0

      407     1987    1      VXH.XTNS=1024-SPARE-POFFW(XTN$,ADDR(FIT));

   1987  6 001163   000035 236000 7                  LDQ     29
         6 001164   000022 772000                    QRL     18
         6 001165   200156 756100                    STQ     @V+2,,AUTO
         6 001166   200010 236100                    LDQ     XTN$,,AUTO
         6 001167   000022 772000                    QRL     18
         6 001170   200156 136100                    SBLQ    @V+2,,AUTO
         6 001171   000220 036000 1                  ADLQ    SPARE
         6 001172   775777 620006                    EAX0    -1025,QL
         6 001173   777777 660003                    ERX0    -1,DU
         6 001174   000000 440100                    SXL0    0,,PR0

      408     1988    1      NXTNS=-1;

   1988  6 001175   000001 335007                    LCA     1,DL
         6 001176   200012 755100                    STA     NXTNS,,AUTO

      409     1989    1      AGRANS=0;

   1989  6 001177   200013 450100                    STZ     AGRANS,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:79   

      410     1990    1      VOLGRAN(I)=0;

   1990  6 001200   000215 721000 1                  LXL1    I
         6 001201   200050 450111                    STZ     VOLGRAN,X1,AUTO

      411     1991    1      FGRANS=MAXGRAN(I-1);

   1991  6 001202   200023 235111                    LDA     ACCTS,X1,AUTO
         6 001203   200014 755100                    STA     FGRANS,,AUTO

      412     1992    1      GRANULE=FGRANS-1;

   1992  6 001204   000001 135007                    SBLA    1,DL
         6 001205   000216 755000 1                  STA     GRANULE

      413     1993    2      DO WHILE (GRANULE<MAXGRAN(I)); /* DO ONE VOL AT A TIME */

   1993  6 001206   000216 236000 1                  LDQ     GRANULE
         6 001207   001212 604000 6                  TMI     s:1994
         6 001210   200024 116111                    CMPQ    MAXGRAN,X1,AUTO
         6 001211   001405 603000 6                  TRC     s:2036

      414     1994    2         GRANULE=GRANULE+1;

   1994  6 001212   000216 054000 1                  AOS     GRANULE

      415     1995    2         MAPX=GRANULE/36;

   1995  6 001213   000216 236000 1                  LDQ     GRANULE
         6 001214   000044 506007                    DIV     36,DL
         6 001215   200004 756100                    STQ     MAPX,,AUTO

      416     1996    2         BITX=MOD(GRANULE,36);

   1996  6 001216   000216 236000 1                  LDQ     GRANULE
         6 001217   000044 506007                    DIV     36,DL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:80   
         6 001220   200005 755100                    STA     BITX,,AUTO

      417     1997    3         IF AGRANS=0 THEN DO;

   1997  6 001221   200013 236100                    LDQ     AGRANS,,AUTO
         6 001222   001322 601000 6                  TNZ     s:2022

      418     1998    3            IF MAP(MAPX)=BINBIT(-1,36) THEN GRANULE=MAPX*36+35;

   1998  6 001223   000001 336007                    LCQ     1,DL
         6 001224   000007 470400 1                  LDP0    MAP_+1
         6 001225   200004 720100                    LXL0    MAPX,,AUTO
         6 001226   000000 116110                    CMPQ    0,X0,PR0
         6 001227   001234 601000 6                  TNZ     s:1999

   1998  6 001230   200004 236100                    LDQ     MAPX,,AUTO
         6 001231   000044 402007                    MPY     36,DL
         6 001232   000043 036007                    ADLQ    35,DL
         6 001233   000216 756000 1                  STQ     GRANULE

      419     1999    4            IF NOT MAP(MAPX)&BITS(BITX) THEN DO;

   1999  6 001234   200005 721100                    LXL1    BITX,,AUTO
         6 001235   000000 236110                    LDQ     0,X0,PR0
         6 001236   000146 376011 2                  ANQ     BITS,X1
         6 001237   001400 601000 6                  TNZ     s:2035

      420     2000    5               IF XTNSIZE~=0 THEN DO;

   2000  6 001240   200015 235100                    LDA     XTNSIZE,,AUTO
         6 001241   001311 600000 6                  TZE     s:2015

      421     2001    5                  NXTNS=NXTNS+1;

   2001  6 001242   200012 054100                    AOS     NXTNS,,AUTO

      422     2002    5                  VXH.XTN.ADR(NXTNS)=GRANULE-FGRANS;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:81   

   2002  6 001243   000216 236000 1                  LDQ     GRANULE
         6 001244   200014 136100                    SBLQ    FGRANS,,AUTO
         6 001245   000000 622006                    EAX2    0,QL
         6 001246   200010 471500                    LDP1    XTN$,,AUTO
         6 001247   200012 723100                    LXL3    NXTNS,,AUTO
         6 001250   100001 742113                    STX2    1,X3,PR1

      423     2003    6                  IF NXTNS+1=VXH.XTNS THEN DO; /* WRITE IT OUT */

   2003  6 001251   100000 236100                    LDQ     0,,PR1
         6 001252   777777 376007                    ANQ     -1,DL
         6 001253   200156 756100                    STQ     @V+2,,AUTO
         6 001254   200012 236100                    LDQ     NXTNS,,AUTO
         6 001255   000001 036007                    ADLQ    1,DL
         6 001256   200156 116100                    CMPQ    @V+2,,AUTO
         6 001257   001307 601000 6                  TNZ     s:2013

      424     2004    6                     VXH.XTN.EADR(NXTNS)=GRANULE-FGRANS;

   2004  6 001260   000216 236000 1                  LDQ     GRANULE
         6 001261   200014 136100                    SBLQ    FGRANS,,AUTO
         6 001262   000000 620006                    EAX0    0,QL
         6 001263   100001 440113                    SXL0    1,X3,PR1

      425     2005    6                     VXH.N='1'B;

   2005  6 001264   000400 236003                    LDQ     256,DU
         6 001265   100000 256100                    ORSQ    0,,PR1

      426     2006    6                     CALL WRITEGP;

   2006  6 001266   003047 701000 6                  TSX1    WRITEGP
         6 001267   000000 011000                    NOP     0

      427     2007    6                     VXH='0'B;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:82   
   2007  6 001270   200010 470500                    LDP0    XTN$,,AUTO
         6 001271   000000 450100                    STZ     0,,PR0
         6 001272   000001 450100                    STZ     1,,PR0

      428     2008    6                     VXH.VOL=I;

   2008  6 001273   000215 236000 1                  LDQ     I
         6 001274   000033 736000                    QLS     27
         6 001275   000000 552140                    STBQ    0,'40'O,PR0

      429     2009    6                     VXH.XTNS=1019-SPARE;

   2009  6 001276   000220 720000 1                  LXL0    SPARE
         6 001277   776004 620010                    EAX0    -1020,X0
         6 001300   777777 660003                    ERX0    -1,DU
         6 001301   000000 440100                    SXL0    0,,PR0

      430     2010    6                     VXH.P='1'B;

   2010  6 001302   000200 236003                    LDQ     128,DU
         6 001303   000000 256100                    ORSQ    0,,PR0

      431     2011    6                     NXTNS=-1;

   2011  6 001304   000001 335007                    LCA     1,DL
         6 001305   200012 755100                    STA     NXTNS,,AUTO

      432     2012    6                     END;

   2012  6 001306   001311 710000 6                  TRA     s:2015

      433     2013    5                  ELSE AGRANS=1; /* SET IN EXTENT FLAG */

   2013  6 001307   000001 235007                    LDA     1,DL
         6 001310   200013 755100                    STA     AGRANS,,AUTO

      434     2014    5                  END;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:83   

      435     2015    5               IF XTNSIZE=0 THEN DO;

   2015  6 001311   200015 235100                    LDA     XTNSIZE,,AUTO
         6 001312   001400 601000 6                  TNZ     s:2035

      436     2016    5                  XTNSIZE=GRANULE+FM_SRZERO;

   2016  6 001313   000216 236000 1                  LDQ     GRANULE
         6 001314   000212 036000 2                  ADLQ    FM_SRZERO
         6 001315   200015 756100                    STQ     XTNSIZE,,AUTO

      437     2017    5                  SGRANS=SGRANS+1;

   2017  6 001316   000214 235000 1                  LDA     SGRANS
         6 001317   000001 035007                    ADLA    1,DL
         6 001320   000214 755000 1                  STA     SGRANS

      438     2018    5                  END;

      439     2019    4               END;

      440     2020    3            END;

   2020  6 001321   001400 710000 6                  TRA     s:2035

      441     2021    3         ELSE DO;

      442     2022    3            IF MAP(MAPX)='0'B THEN GRANULE=MAPX*36+35;

   2022  6 001322   000007 470400 1                  LDP0    MAP_+1
         6 001323   200004 720100                    LXL0    MAPX,,AUTO
         6 001324   000000 235110                    LDA     0,X0,PR0
         6 001325   001332 601000 6                  TNZ     s:2023

   2022  6 001326   200004 236100                    LDQ     MAPX,,AUTO
         6 001327   000044 402007                    MPY     36,DL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:84   
         6 001330   000043 036007                    ADLQ    35,DL
         6 001331   000216 756000 1                  STQ     GRANULE

      443     2023    4            IF MAP(MAPX)&BITS(BITX) THEN DO; /* END OF AN EXTENT */

   2023  6 001332   200005 721100                    LXL1    BITX,,AUTO
         6 001333   000000 236110                    LDQ     0,X0,PR0
         6 001334   000146 376011 2                  ANQ     BITS,X1
         6 001335   001400 600000 6                  TZE     s:2035

      444     2024    4               AGRANS=0;

   2024  6 001336   200013 450100                    STZ     AGRANS,,AUTO

      445     2025    4               VXH.XTN.EADR(NXTNS)=GRANULE-FGRANS;

   2025  6 001337   000216 236000 1                  LDQ     GRANULE
         6 001340   200014 136100                    SBLQ    FGRANS,,AUTO
         6 001341   000000 622006                    EAX2    0,QL
         6 001342   200010 471500                    LDP1    XTN$,,AUTO
         6 001343   200012 723100                    LXL3    NXTNS,,AUTO
         6 001344   100001 442113                    SXL2    1,X3,PR1

      446     2026    4               MAPX=VXH.XTN.EADR(NXTNS)-VXH.XTN.ADR(NXTNS);

   2026  6 001345   100001 236113                    LDQ     1,X3,PR1
         6 001346   000022 772000                    QRL     18
         6 001347   200156 756100                    STQ     @V+2,,AUTO
         6 001350   100001 236113                    LDQ     1,X3,PR1
         6 001351   777777 376007                    ANQ     -1,DL
         6 001352   200156 136100                    SBLQ    @V+2,,AUTO
         6 001353   200004 756100                    STQ     MAPX,,AUTO

      447     2027    4               VOLGRAN(I)=VOLGRAN(I)+MAPX;

   2027  6 001354   000215 720000 1                  LXL0    I
         6 001355   200050 036110                    ADLQ    VOLGRAN,X0,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:85   
         6 001356   200050 756110                    STQ     VOLGRAN,X0,AUTO

      448     2028    4               BITX=18;

   2028  6 001357   000022 235007                    LDA     18,DL
         6 001360   200005 755100                    STA     BITX,,AUTO

      449     2029    5               DO WHILE(MAPX<=BITBIN(BITS(BITX)) AND BITX<36);

   2029  6 001361   001365 710000 6                  TRA     s:2031

      450     2030    5                  BITX=BITX+1;

   2030  6 001362   200005 235100                    LDA     BITX,,AUTO
         6 001363   000001 035007                    ADLA    1,DL
         6 001364   200005 755100                    STA     BITX,,AUTO

      451     2031    5                  END;

   2031  6 001365   000146 236005 2                  LDQ     BITS,AL
         6 001366   001371 604000 6                  TMI     s:2031+4
         6 001367   200004 116100                    CMPQ    MAPX,,AUTO
         6 001370   001374 604000 6                  TMI     s:2032
         6 001371   200005 235100                    LDA     BITX,,AUTO
         6 001372   000044 115007                    CMPA    36,DL
         6 001373   001362 602000 6                  TNC     s:2030

      452     2032    4               XTNDIST.NEWC(BITX-18)=XTNDIST.NEWC(BITX-18)+1;

   2032  6 001374   200005 720100                    LXL0    BITX,,AUTO
         6 001375   200075 235110                    LDA     XTNDIST+1,X0,AUTO
         6 001376   000001 035007                    ADLA    1,DL
         6 001377   200075 755110                    STA     XTNDIST+1,X0,AUTO

      453     2033    4               END;

      454     2034    3            END;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:86   

      455     2035    2         END;

   2035  6 001400   000215 720000 1                  LXL0    I
         6 001401   000216 236000 1                  LDQ     GRANULE
         6 001402   001212 604000 6                  TMI     s:1994
         6 001403   200024 116110                    CMPQ    MAXGRAN,X0,AUTO
         6 001404   001212 602000 6                  TNC     s:1994

      456     2036    1      NXTNS=NXTNS+1;

   2036  6 001405   200012 054100                    AOS     NXTNS,,AUTO

      457     2037    1      VXH.XTNS=NXTNS+1;

   2037  6 001406   200012 720100                    LXL0    NXTNS,,AUTO
         6 001407   000001 621010                    EAX1    1,X0
         6 001410   200010 470500                    LDP0    XTN$,,AUTO
         6 001411   000000 441100                    SXL1    0,,PR0

      458     2038    1      VXH.XTN(NXTNS)=BINBIT(-1,36);

   2038  6 001412   000001 336007                    LCQ     1,DL
         6 001413   200012 722100                    LXL2    NXTNS,,AUTO
         6 001414   000001 756112                    STQ     1,X2,PR0

      459     2039    2      IF GRANULE<SETMAX THEN DO;

   2039  6 001415   000216 236000 1                  LDQ     GRANULE
         6 001416   001421 604000 6                  TMI     s:2040
         6 001417   200011 116100                    CMPQ    SETMAX,,AUTO
         6 001420   001427 603000 6                  TRC     s:2044

      460     2040    2         CALL WRITEGP;

   2040  6 001421   003047 701000 6                  TSX1    WRITEGP
         6 001422   000000 011000                    NOP     0
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:87   

      461     2041    2         I=I+1;

   2041  6 001423   000215 235000 1                  LDA     I
         6 001424   000001 035007                    ADLA    1,DL
         6 001425   000215 755000 1                  STA     I

      462     2042    2         GOTO NXTVOL;

   2042  6 001426   001155 710000 6                  TRA     NXTVOL

      463     2043    2         END;
      464     2044    1      CALL WRITEGP;

   2044  6 001427   003047 701000 6                  TSX1    WRITEGP
         6 001430   000000 011000                    NOP     0

      465     2045    1      IF NOT ERRCODE AND DCBADDR(DCBNUM(M$DP))->F$DCB.FFLG.WNEW

   2045  6 001431   000000 235000 xsym               LDA     ERRCODE
         6 001432   001456 601000 6                  TNZ     s:2047
         6 001433   000000 236007 xsym               LDQ     M$DP,DL
         6 001434   000000 470400 7                  LDP0    0
         6 001435   000000 471500                    LDP1    0,,PR0
         6 001436   100000 473506                    LDP3    0,QL,PR1
         6 001437   300004 236100                    LDQ     4,,PR3
         6 001440   100000 316003                    CANQ    32768,DU
         6 001441   001456 600000 6                  TZE     s:2047

      466     2046    1      THEN CALL SETTIME(POFFW(ADDR(CODE04.MODIFY),ADDR(CODE04)));

   2046  6 001442   200010 236100                    LDQ     XTN$,,AUTO
         6 001443   000022 772000                    QRL     18
         6 001444   200156 756100                    STQ     @V+2,,AUTO
         6 001445   200010 236100                    LDQ     XTN$,,AUTO
         6 001446   000001 036003                    ADLQ    1,DU
         6 001447   000022 772000                    QRL     18
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:88   
         6 001450   200156 136100                    SBLQ    @V+2,,AUTO
         6 001451   200164 756100                    STQ     @V+8,,AUTO
         6 001452   200164 633500                    EPPR3   @V+8,,AUTO
         6 001453   200147 453500                    STP3    SHR_GAC+5,,AUTO
         6 001454   002651 701000 6                  TSX1    SETTIME
         6 001455   000000 011000                    NOP     0

      467     2047    1      IF B$JIT.SYSID=JG_SLUG# THEN CALL M$CLOSE(CLSDP)ALTRET(CLSERR);

   2047  6 001456   000000 470400 xsym               LDP0    B$JIT$
         6 001457   000000 720100                    LXL0    0,,PR0
         6 001460   000001 100003                    CMPX0   1,DU
         6 001461   001466 601000 6                  TNZ     CLSERR

   2047  6 001462   000154 630400 1                  EPPR0   CLSDP
         6 001463   450001 713400                    CLIMB   alt,close
         6 001464   406000 401760                    pmme    nvectors=13
         6 001465   001466 702000 6                  TSX2    CLSERR

   2047  6 001466                       CLSERR       null
      468     2048    1   CLSERR:;
      469     2049    1      CALL DECOUT(BADFM,1,5,FILES);

   2049  6 001466   200021 630500                    EPPR0   FILES,,AUTO
         6 001467   200154 450500                    STP0    @C+1,,AUTO
         6 001470   000040 237000 7                  LDAQ    32
         6 001471   200152 757100                    STAQ    @T+1,,AUTO
         6 001472   000042 236000 7                  LDQ     34
         6 001473   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001474   003127 701000 6                  TSX1    DECOUT
         6 001475   000000 011000                    NOP     0

      470     2050    1      CALL DECOUT(BADFM,14,5,BADFILES);

   2050  6 001476   200020 630500                    EPPR0   BADFILES,,AUTO
         6 001477   200154 450500                    STP0    @C+1,,AUTO
         6 001500   000012 237000 7                  LDAQ    10
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:89   
         6 001501   200152 757100                    STAQ    @T+1,,AUTO
         6 001502   000042 236000 7                  LDQ     34
         6 001503   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001504   003127 701000 6                  TSX1    DECOUT
         6 001505   000000 011000                    NOP     0

      471     2051    1      CALL PRINT(19);

   2051  6 001506   000044 236000 7                  LDQ     36
         6 001507   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 001510   002622 701000 6                  TSX1    PRINT
         6 001511   000000 011000                    NOP     0

      472     2052        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:90   
      473     2053                    /* NOW LOOK AT THE ERROR REPORTS */
      474     2054    1      XTN$=BAD$;

   2054  6 001512   000212 236000 1                  LDQ     BAD$
         6 001513   200010 756100                    STQ     XTN$,,AUTO

      475     2055    1      BAD$=BAD1$;

   2055  6 001514   200007 236100                    LDQ     BAD1$,,AUTO
         6 001515   000212 756000 1                  STQ     BAD$

      476     2056    2      DO WHILE(BAD$<XTN$);

   2056  6 001516   200010 116100                    CMPQ    XTN$,,AUTO
         6 001517   002037 603000 6                  TRC     s:2107

      477     2057    2         BAD$=PINCRW(BAD$,SIZEW(BADS)-1+BADS.NXTNS);

   2057  6 001520   000212 470400 1                  LDP0    BAD$
         6 001521   000013 236100                    LDQ     11,,PR0
         6 001522   000022 736000                    QLS     18
         6 001523   000014 036003                    ADLQ    12,DU
         6 001524   000212 036000 1                  ADLQ    BAD$
         6 001525   000212 756000 1                  STQ     BAD$

      478     2058    3         IF BADS.FDA=BITBIN(FXH$E$FILECNT) THEN DO;

   2058  6 001526   000212 470400 1                  LDP0    BAD$
         6 001527   000000 236100                    LDQ     0,,PR0
         6 001530   000145 116000 2                  CMPQ    FXH$E$FILECNT
         6 001531   001540 601000 6                  TNZ     s:2063

      479     2059    3            MSG.T='FILES MISSED IN ACCOUNT';

   2059  6 001532   040000 100400                    MLR     fill='040'O
         6 001533   000251 000027 2                  ADSC9   MSGVEC+22                cn=0,n=23
         6 001534   001000 203777 xsym               ADSC9   VIDBUF+512               cn=1,n=2047
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:91   

      480     2060    3            I=24;

   2060  6 001535   000030 235007                    LDA     24,DL
         6 001536   000215 755000 1                  STA     I

      481     2061    3            END;

   2061  6 001537   001561 710000 6                  TRA     s:2068

      482     2062    3         ELSE DO;

      483     2063    3            IF BADS.XTNT.XTNSIZE(0)=0 THEN MSG.T='ERROR OPENING NEXT';

   2063  6 001540   000014 236100                    LDQ     12,,PR0
         6 001541   777000 316003                    CANQ    -512,DU
         6 001542   001547 601000 6                  TNZ     s:2064

   2063  6 001543   040000 100400                    MLR     fill='040'O
         6 001544   000257 000022 2                  ADSC9   MSGVEC+28                cn=0,n=18
         6 001545   001000 203777 xsym               ADSC9   VIDBUF+512               cn=1,n=2047
         6 001546   001552 710000 6                  TRA     s:2065

      484     2064    3            ELSE MSG.T='DUAL ALLOCATION IN';

   2064  6 001547   040000 100400                    MLR     fill='040'O
         6 001550   000264 000022 2                  ADSC9   MSGVEC+33                cn=0,n=18
         6 001551   001000 203777 xsym               ADSC9   VIDBUF+512               cn=1,n=2047

      485     2065    3            CALL INSERT(MSG.T,19,31,BADS.NAME.C);

   2065  6 001552   040000 100500                    MLR     fill='040'O
         6 001553   000001 200037                    ADSC9   1,,PR0                   cn=1,n=31
         6 001554   001005 000037 xsym               ADSC9   VIDBUF+517               cn=0,n=31

      486     2066    3            I=19+BADS.NAME.L;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:92   
   2066  6 001555   000001 236100                    LDQ     1,,PR0
         6 001556   000033 772000                    QRL     27
         6 001557   000023 036007                    ADLQ    19,DL
         6 001560   000215 756000 1                  STQ     I

      487     2067    3            END;

      488     2068    2         CALL INSERT(MSG.T,I,9,'.',BADS.ACCT);

   2068  6 001561   000215 235000 1                  LDA     I
         6 001562   040005 100400                    MLR     fill='040'O
         6 001563   000045 000001 7                  ADSC9   37                       cn=0,n=1
         6 001564   001000 200001 xsym               ADSC9   VIDBUF+512,A             cn=1,n=1
         6 001565   040005 100500                    MLR     fill='040'O
         6 001566   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         6 001567   001000 400010 xsym               ADSC9   VIDBUF+512,A             cn=2,n=8

      489     2069    2         CALL INDEX1(I,' ',MSG.T,I);

   2069  6 001570   000215 720000 1                  LXL0    I
         6 001571   774000 620010                    EAX0    -2048,X0
         6 001572   777777 660003                    ERX0    -1,DU
         6 001573   000215 236000 1                  LDQ     I
         6 001574   000215 235000 1                  LDA     I
         6 001575   000000 124445                    SCM     mask='000'O
         6 001576   001000 200010 xsym               ADSC9   VIDBUF+512,A             cn=1,n=*X0
         6 001577   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001600   000215 000000 1                  ARG     I
         6 001601   000215 056000 1                  ASQ     I

      490     2070    3         IF BADS.XTNT(0) THEN DO;

   2070  6 001602   000212 470400 1                  LDP0    BAD$
         6 001603   000014 235100                    LDA     12,,PR0
         6 001604   001645 600000 6                  TZE     s:2078

      491     2071    3            CALL INSERT(MSG.T,I,4,' DA=');
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:93   

   2071  6 001605   000215 236000 1                  LDQ     I
         6 001606   040006 100400                    MLR     fill='040'O
         6 001607   000271 000004 2                  ADSC9   MSGVEC+38                cn=0,n=4
         6 001610   001000 200004 xsym               ADSC9   VIDBUF+512,Q             cn=1,n=4

      492     2072    3            I=I+4;

   2072  6 001611   000004 036007                    ADLQ    4,DL
         6 001612   000215 756000 1                  STQ     I

      493     2073    3            IF BADS.XTNT.XTNSIZE(0)>0 THEN CALL OCTOUTRD(MSG.T,I,9,BADS.FDA);

   2073  6 001613   000014 236100                    LDQ     12,,PR0
         6 001614   777000 316003                    CANQ    -512,DU
         6 001615   001627 600000 6                  TZE     s:2074

   2073  6 001616   000212 236000 1                  LDQ     BAD$
         6 001617   200154 756100                    STQ     @C+1,,AUTO
         6 001620   000046 237000 7                  LDAQ    38
         6 001621   200152 757100                    STAQ    @T+1,,AUTO
         6 001622   000050 236000 7                  LDQ     40
         6 001623   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001624   003164 701000 6                  TSX1    OCTOUTRD
         6 001625   000000 011000                    NOP     0
         6 001626   001640 710000 6                  TRA     s:2075

      494     2074    3            ELSE CALL OCTOUTRD(MSG.T,I,9,BADS.XTNT(0));

   2074  6 001627   000212 236000 1                  LDQ     BAD$
         6 001630   000014 036003                    ADLQ    12,DU
         6 001631   200154 756100                    STQ     @C+1,,AUTO
         6 001632   000046 237000 7                  LDAQ    38
         6 001633   200152 757100                    STAQ    @T+1,,AUTO
         6 001634   000050 236000 7                  LDQ     40
         6 001635   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001636   003164 701000 6                  TSX1    OCTOUTRD
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:94   
         6 001637   000000 011000                    NOP     0

      495     2075    3            MSG.L=I+9;

   2075  6 001640   000215 236000 1                  LDQ     I
         6 001641   000011 036007                    ADLQ    9,DL
         6 001642   000033 736000                    QLS     27
         6 001643   001000 552040 xsym               STBQ    VIDBUF+512,'40'O

      496     2076    3            END;

   2076  6 001644   001653 710000 6                  TRA     s:2081

      497     2077    3         ELSE DO;

      498     2078    3            CALL INSERT(MSG.T,,19,'Accounting abort:  ');

   2078  6 001645   040000 100400                    MLR     fill='040'O
         6 001646   000272 000023 2                  ADSC9   MSGVEC+39                cn=0,n=19
         6 001647   001000 200023 xsym               ADSC9   VIDBUF+512               cn=1,n=19

      499     2079    3            MSG.L=I;

   2079  6 001650   000215 236000 1                  LDQ     I
         6 001651   000033 736000                    QLS     27
         6 001652   001000 552040 xsym               STBQ    VIDBUF+512,'40'O

      500     2080    3            END;

      501     2081    2         CALL PRINT(21);

   2081  6 001653   000052 236000 7                  LDQ     42
         6 001654   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 001655   002622 701000 6                  TSX1    PRINT
         6 001656   000000 011000                    NOP     0

      502     2082    2         IF BADS.FDA~=BITBIN(FXH$E$FILECNT)
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:95   

   2082  6 001657   000212 470400 1                  LDP0    BAD$
         6 001660   000000 236100                    LDQ     0,,PR0
         6 001661   000145 116000 2                  CMPQ    FXH$E$FILECNT
         6 001662   002023 600000 6                  TZE     s:2105

      503     2083    3         THEN IF BADS.XTNT.XTNSIZE(0)=0 THEN DO;

   2083  6 001663   000014 236100                    LDQ     12,,PR0
         6 001664   777000 316003                    CANQ    -512,DU
         6 001665   001714 601000 6                  TNZ     s:2091

      504     2084    3               EFPT.BUF_=VECTOR(SUBSTR(MSG.T,0,120));

   2084  6 001666   000054 237000 7                  LDAQ    44
         6 001667   000106 757000 1                  STAQ    EFPT+4

      505     2085    3               I=BADS.FDA/8*8;

   2085  6 001670   000000 236100                    LDQ     0,,PR0
         6 001671   000003 772000                    QRL     3
         6 001672   000003 736000                    QLS     3
         6 001673   000215 756000 1                  STQ     I

      506     2086    3               CALL M$ERRMSG(EFPT)ALTRET(NOEMSG);

   2086  6 001674   000102 630400 1                  EPPR0   EFPT
         6 001675   420000 713400                    CLIMB   alt,+8192
         6 001676   405000 401760                    pmme    nvectors=11
         6 001677   001700 702000 6                  TSX2    NOEMSG

      507     2087    3   NOEMSG:     MSG.L=120;

   2087  6 001700   170000 236003       NOEMSG       LDQ     61440,DU
         6 001701   001000 552040 xsym               STBQ    VIDBUF+512,'40'O

      508     2088    3               CALL PRINT(21);
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:96   

   2088  6 001702   000052 236000 7                  LDQ     42
         6 001703   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 001704   002622 701000 6                  TSX1    PRINT
         6 001705   000000 011000                    NOP     0

      509     2089    3               IF BADS.XTNT(0) THEN CALL DUMP5;

   2089  6 001706   000212 470400 1                  LDP0    BAD$
         6 001707   000014 235100                    LDA     12,,PR0
         6 001710   002023 600000 6                  TZE     s:2105

   2089  6 001711   002311 701000 6                  TSX1    DUMP5
         6 001712   000000 011000                    NOP     0

      510     2090    3               END;

   2090  6 001713   002023 710000 6                  TRA     s:2105

      511     2091    3            ELSE DO I=0 TO BADS.NXTNS-1;

   2091  6 001714   000215 450000 1                  STZ     I
         6 001715   002017 710000 6                  TRA     s:2104+3

      512     2092    3               IF I=0 AND GRANULE~=BADS.XTNT.XTNSDA(0) THEN CALL DUMP5;

   2092  6 001716   000215 235000 1                  LDA     I
         6 001717   001727 601000 6                  TNZ     s:2093
         6 001720   000212 470400 1                  LDP0    BAD$
         6 001721   000014 236100                    LDQ     12,,PR0
         6 001722   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 001723   000216 116000 1                  CMPQ    GRANULE
         6 001724   001727 600000 6                  TZE     s:2093

   2092  6 001725   002311 701000 6                  TSX1    DUMP5
         6 001726   000000 011000                    NOP     0

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:97   
      513     2093    3               MAPX=BADS.XTNT.XTNSIZE(I);

   2093  6 001727   000212 470400 1                  LDP0    BAD$
         6 001730   000215 720000 1                  LXL0    I
         6 001731   000014 236110                    LDQ     12,X0,PR0
         6 001732   000033 772000                    QRL     27
         6 001733   200004 756100                    STQ     MAPX,,AUTO

      514     2094    3               CALL DECOUT(MSG.T,0,8,MAPX);

   2094  6 001734   200004 631500                    EPPR1   MAPX,,AUTO
         6 001735   200154 451500                    STP1    @C+1,,AUTO
         6 001736   000056 237000 7                  LDAQ    46
         6 001737   200152 757100                    STAQ    @T+1,,AUTO
         6 001740   000050 236000 7                  LDQ     40
         6 001741   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001742   003127 701000 6                  TSX1    DECOUT
         6 001743   000000 011000                    NOP     0

      515     2095    3               CALL INSERT(MSG.T,8,13,' GRANULES AT ');

   2095  6 001744   040000 100400                    MLR     fill='040'O
         6 001745   000277 000015 2                  ADSC9   MSGVEC+44                cn=0,n=13
         6 001746   001002 200015 xsym               ADSC9   VIDBUF+514               cn=1,n=13

      516     2096    3               CALL OCTOUT(MSG.T,21,9,BADS.XTNT(I));

   2096  6 001747   000215 236000 1                  LDQ     I
         6 001750   000022 736000                    QLS     18
         6 001751   000014 036003                    ADLQ    12,DU
         6 001752   000212 036000 1                  ADLQ    BAD$
         6 001753   200154 756100                    STQ     @C+1,,AUTO
         6 001754   000052 237000 7                  LDAQ    42
         6 001755   200152 757100                    STAQ    @T+1,,AUTO
         6 001756   000050 236000 7                  LDQ     40
         6 001757   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 001760   003171 701000 6                  TSX1    OCTOUT
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:98   
         6 001761   000000 011000                    NOP     0

      517     2097    3               MSG.L=30;

   2097  6 001762   036000 236003                    LDQ     15360,DU
         6 001763   001000 552040 xsym               STBQ    VIDBUF+512,'40'O

      518     2098    3               CALL PRINT(21);

   2098  6 001764   000052 236000 7                  LDQ     42
         6 001765   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 001766   002622 701000 6                  TSX1    PRINT
         6 001767   000000 011000                    NOP     0

      519     2099    3               GRANULE=BADS.XTNT.XTNSDA(I);

   2099  6 001770   000212 470400 1                  LDP0    BAD$
         6 001771   000215 720000 1                  LXL0    I
         6 001772   000014 236110                    LDQ     12,X0,PR0
         6 001773   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 001774   000216 756000 1                  STQ     GRANULE

      520     2100    4               DO WHILE(GRANULE<BADS.XTNT.XTNSDA(I)+BADS.XTNT.XTNSIZE(I));

   2100  6 001775   002001 710000 6                  TRA     s:2103

      521     2101    4                  CALL DUMP5;

   2101  6 001776   002311 701000 6                  TSX1    DUMP5
         6 001777   000000 011000                    NOP     0

      522     2102    4                  GRANULE=GRANULE+1;

   2102  6 002000   000216 054000 1                  AOS     GRANULE

      523     2103    4                  END;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:99   
   2103  6 002001   000212 470400 1                  LDP0    BAD$
         6 002002   000215 720000 1                  LXL0    I
         6 002003   000014 236110                    LDQ     12,X0,PR0
         6 002004   000033 772000                    QRL     27
         6 002005   200156 756100                    STQ     @V+2,,AUTO
         6 002006   000014 236110                    LDQ     12,X0,PR0
         6 002007   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 002010   200156 036100                    ADLQ    @V+2,,AUTO
         6 002011   001776 604000 6                  TMI     s:2101
         6 002012   000216 116000 1                  CMPQ    GRANULE
         6 002013   001776 605400 6                  TPNZ    s:2101

      524     2104    3               END;

   2104  6 002014   000215 235000 1                  LDA     I
         6 002015   000001 035007                    ADLA    1,DL
         6 002016   000215 755000 1                  STA     I
         6 002017   000215 236000 1                  LDQ     I
         6 002020   002023 604000 6                  TMI     s:2105
         6 002021   000013 116100                    CMPQ    11,,PR0
         6 002022   001716 604000 6                  TMI     s:2092

      525     2105    2         IF BREAK=1 AND B$JIT.SYSID~=JG_PIG# THEN XTN$=BAD$;

   2105  6 002023   000000 235000 xsym               LDA     BREAK
         6 002024   000001 115007                    CMPA    1,DL
         6 002025   002034 601000 6                  TNZ     s:2106
         6 002026   000000 470400 xsym               LDP0    B$JIT$
         6 002027   000000 720100                    LXL0    0,,PR0
         6 002030   000007 100003                    CMPX0   7,DU
         6 002031   002034 600000 6                  TZE     s:2106

   2105  6 002032   000212 236000 1                  LDQ     BAD$
         6 002033   200010 756100                    STQ     XTN$,,AUTO

      526     2106    2         END;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:100  
   2106  6 002034   000212 236000 1                  LDQ     BAD$
         6 002035   200010 116100                    CMPQ    XTN$,,AUTO
         6 002036   001520 602000 6                  TNC     s:2057

      527     2107    1      CALL PRINT(15); /*XTNS<=N OLD  NEW */

   2107  6 002037   000061 236000 7                  LDQ     49
         6 002040   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 002041   002622 701000 6                  TSX1    PRINT
         6 002042   000000 011000                    NOP     0

      528     2108    1      SGRANS=SETMAX-SGRANS;

   2108  6 002043   200011 236100                    LDQ     SETMAX,,AUTO
         6 002044   000214 136000 1                  SBLQ    SGRANS
         6 002045   000214 756000 1                  STQ     SGRANS

   2108  6 002046                       GPSUMENT     null
      529     2109    1   GPSUMENT:;
      530     2110    1      I=0;

   2110  6 002046   000215 450000 1                  STZ     I

      531     2111    2      DO WHILE(I<18 AND XTNDIST.OLDC(I)+XTNDIST.NEWC(I)=0);

   2111  6 002047   002053 710000 6                  TRA     s:2113

      532     2112    2         I=I+1;

   2112  6 002050   000215 235000 1                  LDA     I
         6 002051   000001 035007                    ADLA    1,DL
         6 002052   000215 755000 1                  STA     I

      533     2113    2         END;

   2113  6 002053   000215 235000 1                  LDA     I
         6 002054   000022 115007                    CMPA    18,DL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:101  
         6 002055   002062 603000 6                  TRC     s:2114
         6 002056   000215 720000 1                  LXL0    I
         6 002057   200074 236110                    LDQ     XTNDIST,X0,AUTO
         6 002060   200117 036105                    ADLQ    XTNDIST+19,AL,AUTO
         6 002061   002050 600000 6                  TZE     s:2112

      534     2114    2      DO WHILE(I<19);

   2114  6 002062   000215 235000 1                  LDA     I
         6 002063   000023 115007                    CMPA    19,DL
         6 002064   002146 603000 6                  TRC     s:2124

      535     2115    2         CALL DECOUT(NUMBUF,1,8,BITBIN(BITS(I+17)));

   2115  6 002065   000215 720000 1                  LXL0    I
         6 002066   000167 630410 2                  EPPR0   BITS+17,X0
         6 002067   200154 450500                    STP0    @C+1,,AUTO
         6 002070   000062 237000 7                  LDAQ    50
         6 002071   200152 757100                    STAQ    @T+1,,AUTO
         6 002072   000064 236000 7                  LDQ     52
         6 002073   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002074   003127 701000 6                  TSX1    DECOUT
         6 002075   000000 011000                    NOP     0

      536     2116    2         CALL DECOUT(NUMBUF,9,7,XTNDIST.OLDC(I));

   2116  6 002076   000215 720000 1                  LXL0    I
         6 002077   200074 630510                    EPPR0   XTNDIST,X0,AUTO
         6 002100   200154 450500                    STP0    @C+1,,AUTO
         6 002101   000066 237000 7                  LDAQ    54
         6 002102   200152 757100                    STAQ    @T+1,,AUTO
         6 002103   000064 236000 7                  LDQ     52
         6 002104   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002105   003127 701000 6                  TSX1    DECOUT
         6 002106   000000 011000                    NOP     0

      537     2117    3         IF EIDCB$~=ADDR(NIL) THEN DO;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:102  

   2117  6 002107   200006 236100                    LDQ     EIDCB$,,AUTO
         6 002110   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 002111   002124 600000 6                  TZE     s:2120

      538     2118    3            CALL DECOUT(NUMBUF,16,7,XTNDIST.NEWC(I));

   2118  6 002112   000215 720000 1                  LXL0    I
         6 002113   200117 630510                    EPPR0   XTNDIST+19,X0,AUTO
         6 002114   200154 450500                    STP0    @C+1,,AUTO
         6 002115   000072 237000 7                  LDAQ    58
         6 002116   200152 757100                    STAQ    @T+1,,AUTO
         6 002117   000064 236000 7                  LDQ     52
         6 002120   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002121   003127 701000 6                  TSX1    DECOUT
         6 002122   000000 011000                    NOP     0

      539     2119    3            END;

   2119  6 002123   002134 710000 6                  TRA     s:2121

      540     2120    2         ELSE CALL DECOUT(NUMBUF,16,8,0);

   2120  6 002124   000032 236000 7                  LDQ     26
         6 002125   200154 756100                    STQ     @C+1,,AUTO
         6 002126   000074 237000 7                  LDAQ    60
         6 002127   200152 757100                    STAQ    @T+1,,AUTO
         6 002130   000064 236000 7                  LDQ     52
         6 002131   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002132   003127 701000 6                  TSX1    DECOUT
         6 002133   000000 011000                    NOP     0

      541     2121    2         I=I+1;

   2121  6 002134   000215 235000 1                  LDA     I
         6 002135   000001 035007                    ADLA    1,DL
         6 002136   000215 755000 1                  STA     I
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:103  

      542     2122    2         CALL PRINT(16);

   2122  6 002137   000072 236000 7                  LDQ     58
         6 002140   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 002141   002622 701000 6                  TSX1    PRINT
         6 002142   000000 011000                    NOP     0

      543     2123    2         END;

   2123  6 002143   000215 235000 1                  LDA     I
         6 002144   000023 115007                    CMPA    19,DL
         6 002145   002065 602000 6                  TNC     s:2115

      544     2124    1      CALL PRINT(17);

   2124  6 002146   000076 236000 7                  LDQ     62
         6 002147   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 002150   002622 701000 6                  TSX1    PRINT
         6 002151   000000 011000                    NOP     0

      545     2125    1      I=0;

   2125  6 002152   000215 450000 1                  STZ     I

   2125  6 002153                       DNXTVOL      null
      546     2126    1   DNXTVOL:;
      547     2127    1      I=I+1;

   2127  6 002153   000215 235000 1                  LDA     I
         6 002154   000001 035007                    ADLA    1,DL
         6 002155   000215 755000 1                  STA     I

      548     2128    1      CALL DECOUT(VOLBUF,1,5,I);

   2128  6 002156   000046 236000 7                  LDQ     38
         6 002157   200154 756100                    STQ     @C+1,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:104  
         6 002160   000040 237000 7                  LDAQ    32
         6 002161   200152 757100                    STAQ    @T+1,,AUTO
         6 002162   000077 236000 7                  LDQ     63
         6 002163   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002164   003127 701000 6                  TSX1    DECOUT
         6 002165   000000 011000                    NOP     0

      549     2129    1      CALL DECOUT(VOLBUF,6,7,VOLGRAN(I));

   2129  6 002166   000215 720000 1                  LXL0    I
         6 002167   200050 630510                    EPPR0   VOLGRAN,X0,AUTO
         6 002170   200154 450500                    STP0    @C+1,,AUTO
         6 002171   000100 237000 7                  LDAQ    64
         6 002172   200152 757100                    STAQ    @T+1,,AUTO
         6 002173   000077 236000 7                  LDQ     63
         6 002174   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002175   003127 701000 6                  TSX1    DECOUT
         6 002176   000000 011000                    NOP     0

      550     2130    1      CALL DECOUT(VOLBUF,16,7,MAXGRAN(I)-MAXGRAN(I-1));

   2130  6 002177   000215 720000 1                  LXL0    I
         6 002200   200024 236110                    LDQ     MAXGRAN,X0,AUTO
         6 002201   200023 136110                    SBLQ    ACCTS,X0,AUTO
         6 002202   200165 756100                    STQ     @V+9,,AUTO
         6 002203   200165 630500                    EPPR0   @V+9,,AUTO
         6 002204   200154 450500                    STP0    @C+1,,AUTO
         6 002205   000072 237000 7                  LDAQ    58
         6 002206   200152 757100                    STAQ    @T+1,,AUTO
         6 002207   000077 236000 7                  LDQ     63
         6 002210   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002211   003127 701000 6                  TSX1    DECOUT
         6 002212   000000 011000                    NOP     0

      551     2131    1      IF EIDCB$=ADDR(NIL) THEN SGRANS=SGRANS+VOLGRAN(I);

   2131  6 002213   200006 236100                    LDQ     EIDCB$,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:105  
         6 002214   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 002215   002222 601000 6                  TNZ     s:2132

   2131  6 002216   000215 720000 1                  LXL0    I
         6 002217   000214 236000 1                  LDQ     SGRANS
         6 002220   200050 036110                    ADLQ    VOLGRAN,X0,AUTO
         6 002221   000214 756000 1                  STQ     SGRANS

      552     2132    1      CALL PRINT(18);

   2132  6 002222   000103 236000 7                  LDQ     67
         6 002223   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 002224   002622 701000 6                  TSX1    PRINT
         6 002225   000000 011000                    NOP     0

      553     2133    1      IF MAXGRAN(I)<SETMAX THEN GOTO DNXTVOL;

   2133  6 002226   000215 720000 1                  LXL0    I
         6 002227   200024 236110                    LDQ     MAXGRAN,X0,AUTO
         6 002230   200011 116100                    CMPQ    SETMAX,,AUTO
         6 002231   002153 602000 6                  TNC     DNXTVOL

      554     2134    2      IF I>1 THEN DO;

   2134  6 002232   000215 235000 1                  LDA     I
         6 002233   000002 115007                    CMPA    2,DL
         6 002234   002264 602000 6                  TNC     s:2140

      555     2135    2         SUBSTR(VOLBUF.TX,0,5)='TOTAL';

   2135  6 002235   040000 100400                    MLR     fill='040'O
         6 002236   000303 000005 2                  ADSC9   MSGVEC+48                cn=0,n=5
         6 002237   000261 200005 1                  ADSC9   VOLBUF                   cn=1,n=5

      556     2136    2         CALL DECOUT(VOLBUF,6,7,SGRANS);

   2136  6 002240   000104 236000 7                  LDQ     68
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:106  
         6 002241   200154 756100                    STQ     @C+1,,AUTO
         6 002242   000100 237000 7                  LDAQ    64
         6 002243   200152 757100                    STAQ    @T+1,,AUTO
         6 002244   000077 236000 7                  LDQ     63
         6 002245   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002246   003127 701000 6                  TSX1    DECOUT
         6 002247   000000 011000                    NOP     0

      557     2137    2         CALL DECOUT(VOLBUF,16,7,SETMAX);

   2137  6 002250   200011 630500                    EPPR0   SETMAX,,AUTO
         6 002251   200154 450500                    STP0    @C+1,,AUTO
         6 002252   000072 237000 7                  LDAQ    58
         6 002253   200152 757100                    STAQ    @T+1,,AUTO
         6 002254   000077 236000 7                  LDQ     63
         6 002255   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002256   003127 701000 6                  TSX1    DECOUT
         6 002257   000000 011000                    NOP     0

      558     2138    2         CALL PRINT(18);

   2138  6 002260   000103 236000 7                  LDQ     67
         6 002261   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 002262   002622 701000 6                  TSX1    PRINT
         6 002263   000000 011000                    NOP     0

      559     2139    2         END;

      560     2140    1      EIDCB$=ADDR(NIL); /* SET FLAG THAT WERE FINISHED */

   2140  6 002264   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002265   200006 756100                    STQ     EIDCB$,,AUTO

   2140  6 002266                       ALLDONE      null
      561     2141    1   ALLDONE:;
      562     2142    1      IF SHR_GAC AND GAC~=0 THEN ERRCODE='0'B;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:107  
   2142  6 002266   200142 234100                    SZN     SHR_GAC,,AUTO
         6 002267   002273 605000 6                  TPL     s:2143
         6 002270   000305 235000 1                  LDA     GAC
         6 002271   002273 600000 6                  TZE     s:2143

   2142  6 002272   000000 450000 xsym               STZ     ERRCODE

      563     2143    1      IF ERRCODE='0'B THEN RETURN;

   2143  6 002273   000000 235000 xsym               LDA     ERRCODE
         6 002274   002276 601000 6                  TNZ     s:2144

   2143  6 002275   000000 702200 xent               TSX2  ! X66_ARET

      564     2144    1      BREAK=0;

   2144  6 002276   000000 450000 xsym               STZ     BREAK

      565     2145    1      ALTRETURN;

   2145  6 002277   000000 702200 xent               TSX2  ! X66_AALT

   2144  6 002300                       RETALT       null
      566     2146    1   RETALT:;
      567     2147    1      IF ERRCODE='0'B THEN ERRCODE=B$TCB.ALT$->B$ALT.ERR;

   2147  6 002300   000000 235000 xsym               LDA     ERRCODE
         6 002301   002306 601000 6                  TNZ     s:2148

   2147  6 002302   000000 470400 xsym               LDP0    B$TCB$
         6 002303   000000 471500                    LDP1    0,,PR0
         6 002304   100102 236100                    LDQ     66,,PR1
         6 002305   000000 756000 xsym               STQ     ERRCODE

      568     2148    1      IF FILES=0 THEN GOTO ALLDONE;

   2148  6 002306   200021 235100                    LDA     FILES,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:108  
         6 002307   002266 600000 6                  TZE     ALLDONE

      569     2149    1      GOTO CLSERR;

   2149  6 002310   001466 710000 6                  TRA     CLSERR

      570     2150        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:109  
      571     2151    1   DUMP5: PROC;

   2151  6 002311   200144 741300       DUMP5        STX1  ! SHR_GAC+2,,AUTO

      572     2152    2      IF BREAK~=0 OR SHR_GAC THEN RETURN;

   2152  6 002312   000000 235000 xsym               LDA     BREAK
         6 002313   002316 601000 6                  TNZ     s:2152+4
         6 002314   200142 234100                    SZN     SHR_GAC,,AUTO
         6 002315   002317 605000 6                  TPL     s:2153

   2152  6 002316   000001 702211                    TSX2  ! 1,X1

      573     2153    2      MSG='777777777777'O;

   2153  6 002317   010000 220003                    LDX0    4096,DU
         6 002320   000040 100400                    MLR     fill='000'O
         6 002321   000027 000004 xsym               ADSC9   B_VECTNIL+23             cn=0,n=4
         6 002322   000000 000010 xsym               ADSC9   VIDBUF                   cn=0,n=*X0

      574     2154    2      CALL M$READ(READFD)ALTRET(DMPANYWAY);

   2154  6 002323   000112 630400 2                  EPPR0   READFD
         6 002324   440000 713400                    CLIMB   alt,read
         6 002325   401400 401760                    pmme    nvectors=4
         6 002326   002327 702000 6                  TSX2    DMPANYWAY

   2153  6 002327                       DMPANYWAY    null
      575     2155    2   DMPANYWAY:;
      576     2156    2      MSG.T=' ';

   2156  6 002327   040000 100400                    MLR     fill='040'O
         6 002330   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002331   001000 203777 xsym               ADSC9   VIDBUF+512               cn=1,n=2047

      577     2157    2      MSG.L=66;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:110  
   2157  6 002332   102000 236003                    LDQ     33792,DU
         6 002333   001000 552040 xsym               STBQ    VIDBUF+512,'40'O

      578     2158    3      DO MSG.I=0 TO 4;

   2158  6 002334   000777 450000 xsym               STZ     VIDBUF+511

      579     2159    3         CALL OCTOUT(MSG.T,MSG.I*13+1,6,MSG.WD(MSG.I)/262144);

   2159  6 002335   000777 720000 xsym               LXL0    VIDBUF+511
         6 002336   000000 236010 xsym               LDQ     VIDBUF,X0
         6 002337   000022 772000                    QRL     18
         6 002340   200156 756100                    STQ     @V+2,,AUTO
         6 002341   000777 236000 xsym               LDQ     VIDBUF+511
         6 002342   000015 402007                    MPY     13,DL
         6 002343   000001 036007                    ADLQ    1,DL
         6 002344   200166 756100                    STQ     @V+10,,AUTO
         6 002345   200156 235100                    LDA     @V+2,,AUTO
         6 002346   200167 755100                    STA     @V+11,,AUTO
         6 002347   200167 630500                    EPPR0   @V+11,,AUTO
         6 002350   200154 450500                    STP0    @C+1,,AUTO
         6 002351   000014 236000 7                  LDQ     12
         6 002352   200153 756100                    STQ     @S+1,,AUTO
         6 002353   200166 631500                    EPPR1   @V+10,,AUTO
         6 002354   200152 451500                    STP1    @T+1,,AUTO
         6 002355   000050 236000 7                  LDQ     40
         6 002356   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002357   003171 701000 6                  TSX1    OCTOUT
         6 002360   000000 011000                    NOP     0

      580     2160    3         CALL OCTOUT(MSG.T,MSG.I*13+7,6,MOD(MSG.WD(MSG.I),262144));

   2160  6 002361   000777 720000 xsym               LXL0    VIDBUF+511
         6 002362   000000 236010 xsym               LDQ     VIDBUF,X0
         6 002363   777777 376007                    ANQ     -1,DL
         6 002364   200156 756100                    STQ     @V+2,,AUTO
         6 002365   000777 236000 xsym               LDQ     VIDBUF+511
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:111  
         6 002366   000015 402007                    MPY     13,DL
         6 002367   000007 036007                    ADLQ    7,DL
         6 002370   200170 756100                    STQ     @V+12,,AUTO
         6 002371   200156 235100                    LDA     @V+2,,AUTO
         6 002372   200171 755100                    STA     @V+13,,AUTO
         6 002373   200171 630500                    EPPR0   @V+13,,AUTO
         6 002374   200154 450500                    STP0    @C+1,,AUTO
         6 002375   000014 236000 7                  LDQ     12
         6 002376   200153 756100                    STQ     @S+1,,AUTO
         6 002377   200170 631500                    EPPR1   @V+12,,AUTO
         6 002400   200152 451500                    STP1    @T+1,,AUTO
         6 002401   000050 236000 7                  LDQ     40
         6 002402   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002403   003171 701000 6                  TSX1    OCTOUT
         6 002404   000000 011000                    NOP     0

      581     2161    3         END;

   2161  6 002405   000777 235000 xsym               LDA     VIDBUF+511
         6 002406   000001 035007                    ADLA    1,DL
         6 002407   000777 755000 xsym               STA     VIDBUF+511
         6 002410   000005 115007                    CMPA    5,DL
         6 002411   002335 602000 6                  TNC     s:2159

      582     2162    2      CALL PRINT(21);

   2162  6 002412   000052 236000 7                  LDQ     42
         6 002413   200147 756100                    STQ     SHR_GAC+5,,AUTO
         6 002414   002622 701000 6                  TSX1    PRINT
         6 002415   000000 011000                    NOP     0

      583     2163    2      IF BREAK~=0 THEN BREAK=4;

   2163  6 002416   000000 235000 xsym               LDA     BREAK
         6 002417   002422 600000 6                  TZE     s:2164

   2163  6 002420   000004 236007                    LDQ     4,DL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:112  
         6 002421   000000 756000 xsym               STQ     BREAK

      584     2164    2      RETURN;

   2164  6 002422   200144 221300                    LDX1  ! SHR_GAC+2,,AUTO
         6 002423   000001 702211                    TSX2  ! 1,X1

      585     2165    2   END DUMP5;
      586     2166        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:113  
      587     2167    1   GPDIST: PROC(MSGNUM)ALTRET;

   2167  6 002424   200146 741300       GPDIST       STX1  ! SHR_GAC+4,,AUTO

      588     2168    2   DCL MSGNUM UBIN ALIGNED;
      589     2169    2   DCL MSGSZ UBIN(9)ALIGNED BASED;
      590     2170    2   DCL WRD(0:0)BASED ALIGNED UBIN;
      591     2171    2      FGRANS=0;

   2171  6 002425   200014 450100                    STZ     FGRANS,,AUTO

      592     2172    2      I=0;

   2172  6 002426   000215 450000 1                  STZ     I

      593     2173    2      FM$GRAN.BLINK=0;

   2173  6 002427   000003 450000 xsym               STZ     VIDBUF+3

      594     2174    2      GRANULE=1+FM_SRZERO;

   2174  6 002430   000212 235000 2                  LDA     FM_SRZERO
         6 002431   000001 035007                    ADLA    1,DL
         6 002432   000216 755000 1                  STA     GRANULE

      595     2175    2      XTNDIST.NEWC='0'B;

   2175  6 002433   000100 100400                    MLR     fill='000'O
         6 002434   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 002435   200117 000114                    ADSC9   XTNDIST+19,,AUTO         cn=0,n=76

      596     2176    2      VOLGRAN='0'B;

   2176  6 002436   000100 100400                    MLR     fill='000'O
         6 002437   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 002440   200050 000120                    ADSC9   VOLGRAN,,AUTO            cn=0,n=80

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:114  
      597     2177    3      DO WHILE (GRANULE~=0);

   2177  6 002441   002620 600000 6                  TZE     GPDERR

      598     2178    3         CALL M$READ(READFD)ALTRET(GPDERR);

   2178  6 002442   000112 630400 2                  EPPR0   READFD
         6 002443   440000 713400                    CLIMB   alt,read
         6 002444   401400 401760                    pmme    nvectors=4
         6 002445   002620 702000 6                  TSX2    GPDERR

      599     2179    3         IF I~=FM$GRAN.BLINK AND I~=0 THEN GOTO GPDERR;

   2179  6 002446   000215 236000 1                  LDQ     I
         6 002447   002452 604000 6                  TMI     s:2179+4
         6 002450   000003 116000 xsym               CMPQ    VIDBUF+3
         6 002451   002454 600000 6                  TZE     s:2180
         6 002452   000000 116003                    CMPQ    0,DU
         6 002453   002620 601000 6                  TNZ     GPDERR

      600     2180    3         XTN$=ADDR(FIT.CODES);

   2180  6 002454   000010 236000 7                  LDQ     8
         6 002455   200010 756100                    STQ     XTN$,,AUTO

      601     2181    4         DO WHILE (FM$GRAN.NAVX>POFFW(XTN$,ADDR(FIT)));

   2181  6 002456   002600 710000 6                  TRA     s:2199

      602     2182    5            IF VXH.XTNS<FM$GRAN.NAVX-POFFW(XTN$,ADDR(FIT)) THEN DO;

   2182  6 002457   000035 236000 7                  LDQ     29
         6 002460   000022 772000                    QRL     18
         6 002461   200156 756100                    STQ     @V+2,,AUTO
         6 002462   200010 236100                    LDQ     XTN$,,AUTO
         6 002463   000022 772000                    QRL     18
         6 002464   200156 136100                    SBLQ    @V+2,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:115  
         6 002465   200157 756100                    STQ     @V+3,,AUTO
         6 002466   000001 236000 xsym               LDQ     VIDBUF+1
         6 002467   000022 772000                    QRL     18
         6 002470   200157 136100                    SBLQ    @V+3,,AUTO
         6 002471   200160 756100                    STQ     @V+4,,AUTO
         6 002472   200010 470500                    LDP0    XTN$,,AUTO
         6 002473   000000 236100                    LDQ     0,,PR0
         6 002474   777777 376007                    ANQ     -1,DL
         6 002475   200160 116100                    CMPQ    @V+4,,AUTO
         6 002476   002575 605000 6                  TPL     s:2198

      603     2183    5               I=MOD(VXH.VOL,SIZEW(VOLGRAN));

   2183  6 002477   000000 236100                    LDQ     0,,PR0
         6 002500   000033 772000                    QRL     27
         6 002501   000024 506007                    DIV     20,DL
         6 002502   000215 755000 1                  STA     I

      604     2184    5               VOLGRAN(I)=VOLGRAN(I)-FGRANS;

   2184  6 002503   200050 236105                    LDQ     VOLGRAN,AL,AUTO
         6 002504   200014 136100                    SBLQ    FGRANS,,AUTO
         6 002505   000215 720000 1                  LXL0    I
         6 002506   200050 756110                    STQ     VOLGRAN,X0,AUTO

      605     2185    6               DO I=0 TO VXH.XTNS-2;

   2185  6 002507   000215 450000 1                  STZ     I
         6 002510   002551 710000 6                  TRA     s:2193+3

      606     2186    6                  AGRANS=VXH.XTN.EADR(I)-VXH.XTN.ADR(I);

   2186  6 002511   200010 470500                    LDP0    XTN$,,AUTO
         6 002512   000215 720000 1                  LXL0    I
         6 002513   000001 236110                    LDQ     1,X0,PR0
         6 002514   000022 772000                    QRL     18
         6 002515   200156 756100                    STQ     @V+2,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:116  
         6 002516   000001 236110                    LDQ     1,X0,PR0
         6 002517   777777 376007                    ANQ     -1,DL
         6 002520   200156 136100                    SBLQ    @V+2,,AUTO
         6 002521   200013 756100                    STQ     AGRANS,,AUTO

      607     2187    6                  IF AGRANS>0 THEN FGRANS=FGRANS+AGRANS;

   2187  6 002522   002525 604400 6                  TMOZ    s:2188

   2187  6 002523   200014 036100                    ADLQ    FGRANS,,AUTO
         6 002524   200014 756100                    STQ     FGRANS,,AUTO

      608     2188    6                  BITX=18;

   2188  6 002525   000022 235007                    LDA     18,DL
         6 002526   200005 755100                    STA     BITX,,AUTO

      609     2189    7                  DO WHILE (AGRANS<=BITBIN(BITS(BITX)) AND BITX<36);

   2189  6 002527   002533 710000 6                  TRA     s:2191

      610     2190    7                     BITX=BITX+1;

   2190  6 002530   200005 235100                    LDA     BITX,,AUTO
         6 002531   000001 035007                    ADLA    1,DL
         6 002532   200005 755100                    STA     BITX,,AUTO

      611     2191    7                     END;

   2191  6 002533   000146 236005 2                  LDQ     BITS,AL
         6 002534   002537 604000 6                  TMI     s:2191+4
         6 002535   200013 116100                    CMPQ    AGRANS,,AUTO
         6 002536   002542 604000 6                  TMI     s:2192
         6 002537   200005 235100                    LDA     BITX,,AUTO
         6 002540   000044 115007                    CMPA    36,DL
         6 002541   002530 602000 6                  TNC     s:2190

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:117  
      612     2192    6                  XTNDIST.NEWC(BITX-18)=XTNDIST.NEWC(BITX-18)+1;

   2192  6 002542   200005 720100                    LXL0    BITX,,AUTO
         6 002543   200075 235110                    LDA     XTNDIST+1,X0,AUTO
         6 002544   000001 035007                    ADLA    1,DL
         6 002545   200075 755110                    STA     XTNDIST+1,X0,AUTO

      613     2193    6                  END;

   2193  6 002546   000215 236000 1                  LDQ     I
         6 002547   000001 036007                    ADLQ    1,DL
         6 002550   000215 756000 1                  STQ     I
         6 002551   200010 470500                    LDP0    XTN$,,AUTO
         6 002552   000000 236100                    LDQ     0,,PR0
         6 002553   777777 376007                    ANQ     -1,DL
         6 002554   000002 136007                    SBLQ    2,DL
         6 002555   002560 604000 6                  TMI     s:2194
         6 002556   000215 116000 1                  CMPQ    I
         6 002557   002511 603000 6                  TRC     s:2186

      614     2194    5               I=MOD(VXH.VOL,SIZEW(VOLGRAN));

   2194  6 002560   000000 236100                    LDQ     0,,PR0
         6 002561   000033 772000                    QRL     27
         6 002562   000024 506007                    DIV     20,DL
         6 002563   000215 755000 1                  STA     I

      615     2195    5               VOLGRAN(I)=VOLGRAN(I)+FGRANS;

   2195  6 002564   200050 236105                    LDQ     VOLGRAN,AL,AUTO
         6 002565   200014 036100                    ADLQ    FGRANS,,AUTO
         6 002566   000215 720000 1                  LXL0    I
         6 002567   200050 756110                    STQ     VOLGRAN,X0,AUTO

      616     2196    5               XTN$=PINCRW(XTN$,VXH.XTNS+1);

   2196  6 002570   000000 721100                    LXL1    0,,PR0
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:118  
         6 002571   000001 636011                    EAQ     1,X1
         6 002572   200010 036100                    ADLQ    XTN$,,AUTO
         6 002573   200010 756100                    STQ     XTN$,,AUTO

      617     2197    5               END;

   2197  6 002574   002600 710000 6                  TRA     s:2199

      618     2198    4            ELSE XTN$=ADDR(FIT.CODES(FM$GRAN.NAVX));

   2198  6 002575   000001 220000 xsym               LDX0    VIDBUF+1
         6 002576   000005 631410 xsym               EPPR1   VIDBUF+5,X0
         6 002577   200010 451500                    STP1    XTN$,,AUTO

      619     2199    4            END;

   2199  6 002600   000035 236000 7                  LDQ     29
         6 002601   000022 772000                    QRL     18
         6 002602   200156 756100                    STQ     @V+2,,AUTO
         6 002603   200010 236100                    LDQ     XTN$,,AUTO
         6 002604   000022 772000                    QRL     18
         6 002605   200156 136100                    SBLQ    @V+2,,AUTO
         6 002606   200157 756100                    STQ     @V+3,,AUTO
         6 002607   000001 236000 xsym               LDQ     VIDBUF+1
         6 002610   000022 772000                    QRL     18
         6 002611   200157 116100                    CMPQ    @V+3,,AUTO
         6 002612   002457 605400 6                  TPNZ    s:2182

      620     2200    3         I=GRANULE;

   2200  6 002613   000216 235000 1                  LDA     GRANULE
         6 002614   000215 755000 1                  STA     I

      621     2201    3         GRANULE=FM$GRAN.FLINK;

   2201  6 002615   000004 235000 xsym               LDA     VIDBUF+4
         6 002616   000216 755000 1                  STA     GRANULE
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:119  

      622     2202    3         END;

   2202  6 002617   002442 601000 6                  TNZ     s:2178

   2201  6 002620                       GPDERR       null
      623     2203    2   GPDERR:;
      624     2204    2      RETURN;

   2204  6 002620   200146 221300                    LDX1  ! SHR_GAC+4,,AUTO
         6 002621   000001 702211                    TSX2  ! 1,X1

      625     2205        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:120  
      626     2206    2   PRINT: ENTRY(MSGNUM) ALTRET;

   2206  6 002622   200146 741300       PRINT        STX1  ! SHR_GAC+4,,AUTO

      627     2207    2      IF FILES=0 THEN RETURN;/* NO PRINT IF EMPTY SET*/

   2207  6 002623   200021 235100                    LDA     FILES,,AUTO
         6 002624   002626 601000 6                  TNZ     s:2208

   2207  6 002625   000001 702211                    TSX2  ! 1,X1

      628     2208    2      LOFPT.BUF_.BUF$=PINCRC(MSGVEC(MSGNUM-15),1);

   2208  6 002626   200147 470500                    LDP0    @MSGNUM,,AUTO
         6 002627   000000 720100                    LXL0    0,,PR0
         6 002630   000204 236010 2                  LDQ     BITS+30,X0
         6 002631   200000 036007                    ADLQ    65536,DL
         6 002632   000145 756000 1                  STQ     LOFPT+5

      629     2209    2      LOFPT.BUF_.BOUND=MSGVEC(MSGNUM-15)->MSGSZ-1;

   2209  6 002633   000000 720100                    LXL0    0,,PR0
         6 002634   000204 471410 2                  LDP1    BITS+30,X0
         6 002635   100000 236100                    LDQ     0,,PR1
         6 002636   000033 772000                    QRL     27
         6 002637   000001 136007                    SBLQ    1,DL
         6 002640   000020 736000                    QLS     16
         6 002641   000144 676000 1                  ERQ     LOFPT+4
         6 002642   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 002643   000144 656000 1                  ERSQ    LOFPT+4

      630     2210    2      CALL M$WRITE(LOFPT);

   2210  6 002644   000140 630400 1                  EPPR0   LOFPT
         6 002645   040001 713400                    CLIMB   write
         6 002646   401400 401760                    pmme    nvectors=4

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:121  
      631     2211    2      RETURN;

   2211  6 002647   200146 221300                    LDX1  ! SHR_GAC+4,,AUTO
         6 002650   000001 702211                    TSX2  ! 1,X1

      632     2212        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:122  
      633     2213    2   SETTIME: ENTRY(MSGNUM) ALTRET;

   2213  6 002651   200146 741300       SETTIME      STX1  ! SHR_GAC+4,,AUTO

      634     2214    2      GRANULE=FM_PADSDA; /* SET PAD MODIFICATION TIME */

   2214  6 002652   000214 235000 2                  LDA     FM_PADSDA
         6 002653   000216 755000 1                  STA     GRANULE

      635     2215    2      CALL M$READ(READFD)ALTRET(GPDERR);

   2215  6 002654   000112 630400 2                  EPPR0   READFD
         6 002655   440000 713400                    CLIMB   alt,read
         6 002656   401400 401760                    pmme    nvectors=4
         6 002657   002620 702000 6                  TSX2    GPDERR

      636     2216    2      CALL LOCCODT(4)ALTRET(GPDERR);

   2216  6 002660   000105 236000 7                  LDQ     69
         6 002661   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002662   003241 701000 6                  TSX1    LOCCODT
         6 002663   002620 702000 6                  TSX2    GPDERR

      637     2217    2      FIT.CODES(0)=FIT1CODE;

   2217  6 002664   000106 236000 2                  LDQ     FIT1CODE
         6 002665   000005 756000 xsym               STQ     VIDBUF+5

      638     2218    2      FIT.CODES(1)=FIT.CODES(I);

   2218  6 002666   000215 720000 1                  LXL0    I
         6 002667   000005 236010 xsym               LDQ     VIDBUF+5,X0
         6 002670   000006 756000 xsym               STQ     VIDBUF+6

      639     2219    2      CALL M$TIME(GETTIME);

   2219  6 002671   000000 630400 2                  EPPR0   GETTIME
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:123  
         6 002672   020004 713400                    CLIMB   8196
         6 002673   402000 401760                    pmme    nvectors=5

      640     2220    2      ADDR(CODE04)->WRD(MSGNUM)=I;

   2220  6 002674   200147 470500                    LDP0    @MSGNUM,,AUTO
         6 002675   000000 720100                    LXL0    0,,PR0
         6 002676   200010 471500                    LDP1    XTN$,,AUTO
         6 002677   000215 235000 1                  LDA     I
         6 002700   100000 755110                    STA     0,X0,PR1

      641     2221    2      CALL M$OPEN(UPD04)ALTRET(GPDERR);

   2221  6 002701   000014 630400 2                  EPPR0   UPD04
         6 002702   450000 713400                    CLIMB   alt,open
         6 002703   410400 401760                    pmme    nvectors=18
         6 002704   002620 702000 6                  TSX2    GPDERR

      642     2222    2      RETURN;

   2222  6 002705   200146 221300                    LDX1  ! SHR_GAC+4,,AUTO
         6 002706   000001 702211                    TSX2  ! 1,X1

      643     2223        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:124  
      644     2224    2   RELDIR: ENTRY ALTRET;

   2224  6 002707   200146 741300       RELDIR       STX1  ! SHR_GAC+4,,AUTO

   2220  6 002710                       RLDIR        null
      645     2225    2   RLDIR:;
      646     2226    2      GRANULE=FDFDA;

   2226  6 002710   200016 235100                    LDA     FDFDA,,AUTO
         6 002711   000216 755000 1                  STA     GRANULE

      647     2227    2      FM$GRAN.BLINK=0;

   2227  6 002712   000003 450000 xsym               STZ     VIDBUF+3

      648     2228    2      I=0;

   2228  6 002713   000215 450000 1                  STZ     I

      649     2229    2      AFILES=0;

   2229  6 002714   200022 450100                    STZ     AFILES,,AUTO

      650     2230    2      FGRANS=0;

   2230  6 002715   200014 450100                    STZ     FGRANS,,AUTO

      651     2231    2      AGRANS=0;

   2231  6 002716   200013 450100                    STZ     AGRANS,,AUTO

      652     2232    3      DO WHILE (GRANULE~=0);

   2232  6 002717   003001 600000 6                  TZE     s:2250

      653     2233    3         CALL M$READ(READFD)ALTRET(FDERR);

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:125  
   2233  6 002720   000112 630400 2                  EPPR0   READFD
         6 002721   440000 713400                    CLIMB   alt,read
         6 002722   401400 401760                    pmme    nvectors=4
         6 002723   003043 702000 6                  TSX2    FDERR

      654     2234    3         IF FM$GRAN.BLINK~=I THEN GOTO LNKERR;

   2234  6 002724   000003 236000 xsym               LDQ     VIDBUF+3
         6 002725   003014 604000 6                  TMI     LNKERR
         6 002726   000215 116000 1                  CMPQ    I
         6 002727   003014 601000 6                  TNZ     LNKERR

      655     2235    4         IF I=0 AND FM$GRAN.LVL~=FMGTMAD THEN DO;

   2235  6 002730   000215 235000 1                  LDA     I
         6 002731   002761 601000 6                  TNZ     NO14
         6 002732   000001 236000 xsym               LDQ     VIDBUF+1
         6 002733   340000 376007                    ANQ     114688,DL
         6 002734   100000 116007                    CMPQ    32768,DL
         6 002735   002761 600000 6                  TZE     NO14

      656     2236    4            CALL LOCCODT(14)ALTRET(NO14);

   2236  6 002736   000012 236000 7                  LDQ     10
         6 002737   200151 756100                    STQ     @MSGNUM+2,,AUTO
         6 002740   003241 701000 6                  TSX1    LOCCODT
         6 002741   002761 702000 6                  TSX2    NO14

      657     2237    4            IF FM$GRAN.LVL=FMGTFD AND CODE14.CGRANS>=0 THEN AGRANS=-CODE14.CGRANS;

   2237  6 002742   000001 236000 xsym               LDQ     VIDBUF+1
         6 002743   340000 376007                    ANQ     114688,DL
         6 002744   200000 116007                    CMPQ    65536,DL
         6 002745   002755 601000 6                  TNZ     s:2239
         6 002746   200010 470500                    LDP0    XTN$,,AUTO
         6 002747   000002 235100                    LDA     2,,PR0
         6 002750   002755 604000 6                  TMI     s:2239
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:126  

   2237  6 002751   000002 235100                    LDA     2,,PR0
         6 002752   000000 531000                    NEG     0
         6 002753   200013 755100                    STA     AGRANS,,AUTO
         6 002754   002761 710000 6                  TRA     NO14

      658     2238    5            ELSE DO;

      659     2239    5               CODE14.CGRANS=0;

   2239  6 002755   200010 470500                    LDP0    XTN$,,AUTO
         6 002756   000002 450100                    STZ     2,,PR0

      660     2240    5               CALL M$WRITEFD;

   2240  6 002757   003523 701000 6                  TSX1    M$WRITEFD
         6 002760   000000 011000                    NOP     0

      661     2241    5               END;

   2237  6 002761                       NO14         null
      662     2242    4   NO14:    ;
      663     2243    4            END;

      664     2244    3         AFILES=AFILES-FM$GRAN.KEYCNT;

   2244  6 002761   000002 236000 xsym               LDQ     VIDBUF+2
         6 002762   000777 376007                    ANQ     511,DL
         6 002763   200156 756100                    STQ     @V+2,,AUTO
         6 002764   200022 236100                    LDQ     AFILES,,AUTO
         6 002765   200156 136100                    SBLQ    @V+2,,AUTO
         6 002766   200022 756100                    STQ     AFILES,,AUTO

      665     2245    3         CALL SETBIT ALTRET(FDERR);

   2245  6 002767   003275 701000 6                  TSX1    SETBIT
         6 002770   003043 702000 6                  TSX2    FDERR
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:127  

      666     2246    3         FGRANS=FGRANS+1;

   2246  6 002771   200014 235100                    LDA     FGRANS,,AUTO
         6 002772   000001 035007                    ADLA    1,DL
         6 002773   200014 755100                    STA     FGRANS,,AUTO

      667     2247    3         I=GRANULE;

   2247  6 002774   000216 236000 1                  LDQ     GRANULE
         6 002775   000215 756000 1                  STQ     I

      668     2248    3         GRANULE=FM$GRAN.FLINK;

   2248  6 002776   000004 235000 xsym               LDA     VIDBUF+4
         6 002777   000216 755000 1                  STA     GRANULE

      669     2249    3         END;

   2249  6 003000   002720 601000 6                  TNZ     s:2233

      670     2250    2      IF AGRANS>0 THEN AGRANS=-SETMAX;

   2250  6 003001   200013 236100                    LDQ     AGRANS,,AUTO
         6 003002   003006 604400 6                  TMOZ    s:2251

   2250  6 003003   000000 235003                    LDA     0,DU
         6 003004   200011 135100                    SBLA    SETMAX,,AUTO
         6 003005   200013 755100                    STA     AGRANS,,AUTO

      671     2251    2      SGRANS=SGRANS-AGRANS+FGRANS;

   2251  6 003006   000214 236000 1                  LDQ     SGRANS
         6 003007   200013 136100                    SBLQ    AGRANS,,AUTO
         6 003010   200014 036100                    ADLQ    FGRANS,,AUTO
         6 003011   000214 756000 1                  STQ     SGRANS

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:128  
      672     2252    2      RETURN;

   2252  6 003012   200146 221300                    LDX1  ! SHR_GAC+4,,AUTO
         6 003013   000001 702211                    TSX2  ! 1,X1

      673     2253    3   LNKERR: IF I=0 THEN DO WHILE(GRANULE~=0);

   2253  6 003014   000215 235000 1     LNKERR       LDA     I
         6 003015   003043 601000 6                  TNZ     FDERR

   2253  6 003016   000216 235000 1                  LDA     GRANULE
         6 003017   003043 600000 6                  TZE     FDERR

      674     2254    3         I=GRANULE;

   2254  6 003020   000216 235000 1                  LDA     GRANULE
         6 003021   000215 755000 1                  STA     I

      675     2255    3         GRANULE=FM$GRAN.BLINK;

   2255  6 003022   000003 236000 xsym               LDQ     VIDBUF+3
         6 003023   000216 756000 1                  STQ     GRANULE

      676     2256    3         CALL M$READ(READFD)ALTRET(FDERR);

   2256  6 003024   000112 630400 2                  EPPR0   READFD
         6 003025   440000 713400                    CLIMB   alt,read
         6 003026   401400 401760                    pmme    nvectors=4
         6 003027   003043 702000 6                  TSX2    FDERR

      677     2257    3         IF FM$GRAN.FLINK~=I THEN GRANULE=0;

   2257  6 003030   000004 236000 xsym               LDQ     VIDBUF+4
         6 003031   000215 116000 1                  CMPQ    I
         6 003032   003034 600000 6                  TZE     s:2258

   2257  6 003033   000216 450000 1                  STZ     GRANULE
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:129  

      678     2258    4         IF FM$GRAN.BLINK=0 THEN DO; /* FOUND THE REAL START */

   2258  6 003034   000003 235000 xsym               LDA     VIDBUF+3
         6 003035   003041 601000 6                  TNZ     s:2262

      679     2259    4            FDFDA=GRANULE;

   2259  6 003036   000216 235000 1                  LDA     GRANULE
         6 003037   200016 755100                    STA     FDFDA,,AUTO

      680     2260    4            GOTO RLDIR;

   2260  6 003040   002710 710000 6                  TRA     RLDIR

      681     2261    4            END;
      682     2262    3         END;

   2262  6 003041   000216 235000 1                  LDA     GRANULE
         6 003042   003020 601000 6                  TNZ     s:2254

   2258  6 003043                       FDERR        null
      683     2263    2   FDERR:;
      684     2264    2      AFILES=1; /* FORCE A DIRECTORY ERROR */

   2264  6 003043   000001 235007                    LDA     1,DL
         6 003044   200022 755100                    STA     AFILES,,AUTO

      685     2265    2      ALTRETURN;

   2265  6 003045   200146 221300                    LDX1  ! SHR_GAC+4,,AUTO
         6 003046   000000 702211                    TSX2  ! 0,X1

      686     2266        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:130  
      687     2267    2   WRITEGP: ENTRY ALTRET;

   2267  6 003047   200146 741300       WRITEGP      STX1  ! SHR_GAC+4,,AUTO

      688     2268    2      FM$GRAN.NAVX=VXH.XTNS+1+POFFW(XTN$,ADDR(FM$GRAN));

   2268  6 003050   000035 236000 7                  LDQ     29
         6 003051   000022 772000                    QRL     18
         6 003052   200156 756100                    STQ     @V+2,,AUTO
         6 003053   200010 236100                    LDQ     XTN$,,AUTO
         6 003054   000022 772000                    QRL     18
         6 003055   200156 136100                    SBLQ    @V+2,,AUTO
         6 003056   200010 470500                    LDP0    XTN$,,AUTO
         6 003057   200157 756100                    STQ     @V+3,,AUTO
         6 003060   000000 236100                    LDQ     0,,PR0
         6 003061   777777 376007                    ANQ     -1,DL
         6 003062   200160 756100                    STQ     @V+4,,AUTO
         6 003063   200157 236100                    LDQ     @V+3,,AUTO
         6 003064   200160 036100                    ADLQ    @V+4,,AUTO
         6 003065   000001 620006                    EAX0    1,QL
         6 003066   000001 740000 xsym               STX0    VIDBUF+1

      689     2269    2      FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;

   2269  6 003067   000001 236000 xsym               LDQ     VIDBUF+1
         6 003070   000022 772000                    QRL     18
         6 003071   000027 676000 xsym               ERQ     B_VECTNIL+23
         6 003072   002001 036007                    ADLQ    1025,DL
         6 003073   000001 676000 xsym               ERQ     VIDBUF+1
         6 003074   001777 376007                    ANQ     1023,DL
         6 003075   000001 656000 xsym               ERSQ    VIDBUF+1

      690     2270    2      FM$GRAN.STAMP.GMOD=FDFDA;

   2270  6 003076   200016 236100                    LDQ     FDFDA,,AUTO
         6 003077   000000 552004 xsym               STBQ    VIDBUF,'04'O

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:131  
      691     2271    2      NXTNS=GRANULE;

   2271  6 003100   000216 235000 1                  LDA     GRANULE
         6 003101   200012 755100                    STA     NXTNS,,AUTO

      692     2272    2      GRANULE=FDFDA;

   2272  6 003102   000216 756000 1                  STQ     GRANULE

      693     2273    2      IF NXTNS=SETMAX THEN FM$GRAN.FLINK=0;

   2273  6 003103   200012 236100                    LDQ     NXTNS,,AUTO
         6 003104   003111 604000 6                  TMI     s:2275
         6 003105   200011 116100                    CMPQ    SETMAX,,AUTO
         6 003106   003111 601000 6                  TNZ     s:2275

   2273  6 003107   000004 450000 xsym               STZ     VIDBUF+4
         6 003110   003115 710000 6                  TRA     s:2279

      694     2274    3      ELSE DO;

      695     2275    3         FM$GRAN.FLINK=XTNSIZE;

   2275  6 003111   200015 235100                    LDA     XTNSIZE,,AUTO
         6 003112   000004 755000 xsym               STA     VIDBUF+4

      696     2276    3         FDFDA=XTNSIZE;

   2276  6 003113   200016 755100                    STA     FDFDA,,AUTO

      697     2277    3         XTNSIZE=0;

   2277  6 003114   200015 450100                    STZ     XTNSIZE,,AUTO

      698     2278    3         END;

      699     2279    2      CALL M$WRITEFD;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:132  

   2279  6 003115   003523 701000 6                  TSX1    M$WRITEFD
         6 003116   000000 011000                    NOP     0

      700     2280    2      FM$GRAN.BLINK=GRANULE;

   2280  6 003117   000216 235000 1                  LDA     GRANULE
         6 003120   000003 755000 xsym               STA     VIDBUF+3

      701     2281    2      GRANULE=NXTNS;

   2281  6 003121   200012 236100                    LDQ     NXTNS,,AUTO
         6 003122   000216 756000 1                  STQ     GRANULE

      702     2282    2      XTN$=ADDR(FIT.CODES);

   2282  6 003123   000010 236000 7                  LDQ     8
         6 003124   200010 756100                    STQ     XTN$,,AUTO

      703     2283    2      RETURN;

   2283  6 003125   200146 221300                    LDX1  ! SHR_GAC+4,,AUTO
         6 003126   000001 702211                    TSX2  ! 1,X1

      704     2284    2   END GPDIST;
      705     2285        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:133  
      706     2286    1   DECOUT: PROC(T,S,C,V)ALTRET;

   2286  6 003127   200150 741300       DECOUT       STX1  ! @MSGNUM+1,,AUTO

      707     2287                    /*D*     NAME: DECOUT
      708     2288                             CALL: CALL DECOUT(T,S,C,V);
      709     2289                             DESCRIPTION: T,S,C IS SUBSTR TO STORE OUTPUT STRING.
      710     2290                                 V IS INPUT VALUE. STORES RIGHT ADJUSTED, NO LEADING
      711     2291                                 ZERO DECIMAL CONVERTED VALUE.          */
      712     2292    2   DCL T CHAR(200);
      713     2293    2   DCL 1 TN REDEF T ALIGNED,
      714     2294    2         2 N UBIN,
      715     2295    2         2 * CHAR(196);
      716     2296    2   DCL S UBIN ALIGNED;
      717     2297    2   DCL C UBIN ALIGNED;
      718     2298    2   DCL V UBIN ALIGNED;
      719     2299    2      CALL BINCHAR(SUBSTR(T,S,C),V);

   2299  6 003130   200152 470500                    LDP0    @S,,AUTO
         6 003131   000000 235100                    LDA     0,,PR0
         6 003132   200153 471500                    LDP1    @C,,AUTO
         6 003133   100000 720100                    LXL0    0,,PR1
         6 003134   200154 473500                    LDP3    @V,,AUTO
         6 003135   200156 755100                    STA     @V+2,,AUTO
         6 003136   300000 235100                    LDA     0,,PR3
         6 003137   000044 773000                    LRL     36
         6 003140   200160 757100                    STAQ    @V+4,,AUTO
         6 003141   200151 474500                    LDP4    @T,,AUTO
         6 003142   200156 235100                    LDA     @V+2,,AUTO
         6 003143   000145 301500                    BTD
         6 003144   200160 000010                    NDSC9   @V+4,,AUTO               cn=0,s=lsgnf,sf=0,n=8
         6 003145   400000 030010                    NDSC9   0,A,PR4                  cn=0,s=nosgn,sf=0,n=*X0

      720     2300    2      CALL EDITSTR(T,S,C-1,BINBIT(C+63,9),SUBSTR(T,S,C));

   2300  6 003146   100000 236100                    LDQ     0,,PR1
         6 003147   000077 036007                    ADLQ    63,DL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:134  
         6 003150   000033 736000                    QLS     27
         6 003151   000000 235100                    LDA     0,,PR0
         6 003152   100000 720100                    LXL0    0,,PR1
         6 003153   100000 721100                    LXL1    0,,PR1
         6 003154   777777 622011                    EAX2    -1,X1
         6 003155   200156 756100                    STQ     @V+2,,AUTO
         6 003156   145100 020545                    MVE
         6 003157   400000 000010                    ADSC9   0,A,PR4                  cn=0,n=*X0
         6 003160   200156 000001                    ADSC9   @V+2,,AUTO               cn=0,n=1
         6 003161   400000 000012                    ADSC9   0,A,PR4                  cn=0,n=*X2

      721     2301    2      RETURN;

   2301  6 003162   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003163   000001 702211                    TSX2  ! 1,X1

      722     2302    2   OCTOUTRD: ENTRY(T,S,C,V)ALTRET;

   2302  6 003164   200150 741300       OCTOUTRD     STX1  ! @MSGNUM+1,,AUTO

      723     2303    2      GRANULE=V;

   2303  6 003165   200154 470500                    LDP0    @V,,AUTO
         6 003166   000000 235100                    LDA     0,,PR0
         6 003167   000216 755000 1                  STA     GRANULE

   2303  6 003170   003172 710000 6     SOKAY        TRA     s:2306

      724     2304    2   SOKAY:;
      725     2305    2   OCTOUT: ENTRY(T,S,C,V)ALTRET;

   2305  6 003171   200150 741300       OCTOUT       STX1  ! @MSGNUM+1,,AUTO

      726     2306    2      BITX=V;

   2306  6 003172   200154 470500                    LDP0    @V,,AUTO
         6 003173   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:135  
         6 003174   200005 755100                    STA     BITX,,AUTO

      727     2307    2      NXTNS=1;

   2307  6 003175   000001 236007                    LDQ     1,DL
         6 003176   200012 756100                    STQ     NXTNS,,AUTO

      728     2308    2      FDFDA=0;

   2308  6 003177   200016 450100                    STZ     FDFDA,,AUTO

      729     2309    3      DO MAPX=0 TO C-1;

   2309  6 003200   200004 450100                    STZ     MAPX,,AUTO
         6 003201   003216 710000 6                  TRA     s:2313+1

      730     2310    3         FDFDA=FDFDA+NXTNS*MOD(BITX,8);

   2310  6 003202   200005 236100                    LDQ     BITX,,AUTO
         6 003203   000007 376007                    ANQ     7,DL
         6 003204   200012 402100                    MPY     NXTNS,,AUTO
         6 003205   200016 036100                    ADLQ    FDFDA,,AUTO
         6 003206   200016 756100                    STQ     FDFDA,,AUTO

      731     2311    3         NXTNS=NXTNS*10;

   2311  6 003207   200012 236100                    LDQ     NXTNS,,AUTO
         6 003210   000012 402007                    MPY     10,DL
         6 003211   200012 756100                    STQ     NXTNS,,AUTO

      732     2312    3         BITX=BITX/8;

   2312  6 003212   200005 236100                    LDQ     BITX,,AUTO
         6 003213   000003 772000                    QRL     3
         6 003214   200005 756100                    STQ     BITX,,AUTO

      733     2313    3         END;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:136  

   2313  6 003215   200004 054100                    AOS     MAPX,,AUTO
         6 003216   200153 470500                    LDP0    @C,,AUTO
         6 003217   200004 236100                    LDQ     MAPX,,AUTO
         6 003220   003202 604000 6                  TMI     s:2310
         6 003221   000000 116100                    CMPQ    0,,PR0
         6 003222   003202 602000 6                  TNC     s:2310

      734     2314    2      CALL BINCHAR(SUBSTR(T,S,C),FDFDA);

   2314  6 003223   200152 471500                    LDP1    @S,,AUTO
         6 003224   100000 235100                    LDA     0,,PR1
         6 003225   000000 720100                    LXL0    0,,PR0
         6 003226   200016 236100                    LDQ     FDFDA,,AUTO
         6 003227   200156 755100                    STA     @V+2,,AUTO
         6 003230   000000 235003                    LDA     0,DU
         6 003231   200160 757100                    STAQ    @V+4,,AUTO
         6 003232   200151 473500                    LDP3    @T,,AUTO
         6 003233   200156 235100                    LDA     @V+2,,AUTO
         6 003234   000145 301500                    BTD
         6 003235   200160 000010                    NDSC9   @V+4,,AUTO               cn=0,s=lsgnf,sf=0,n=8
         6 003236   300000 030010                    NDSC9   0,A,PR3                  cn=0,s=nosgn,sf=0,n=*X0

      735     2315    2      RETURN;

   2315  6 003237   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003240   000001 702211                    TSX2  ! 1,X1

      736     2316        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:137  
      737     2317    2   LOCCODT: ENTRY(T)ALTRET;

   2317  6 003241   200150 741300       LOCCODT      STX1  ! @MSGNUM+1,,AUTO

      738     2318    3      DO I=1 TO FIT.CODES.CODE(0);

   2318  6 003242   000001 235007                    LDA     1,DL
         6 003243   000215 755000 1                  STA     I
         6 003244   003267 710000 6                  TRA     s:2323+3

      739     2319    4         IF FIT.CODES.CODE(I)=TN.N AND FIT.CODES.NDW(I)~=0 THEN DO;

   2319  6 003245   200151 470500                    LDP0    @T,,AUTO
         6 003246   000215 720000 1                  LXL0    I
         6 003247   000005 236010 xsym               LDQ     VIDBUF+5,X0
         6 003250   000037 772000                    QRL     31
         6 003251   000000 116100                    CMPQ    0,,PR0
         6 003252   003264 601000 6                  TNZ     s:2323
         6 003253   000005 236010 xsym               LDQ     VIDBUF+5,X0
         6 003254   000106 316000 7                  CANQ    70
         6 003255   003264 600000 6                  TZE     s:2323

      740     2320    4            XTN$=ADDR(FIT.CODES(FIT.CODES.ITEMX(I)));

   2320  6 003256   000005 721010 xsym               LXL1    VIDBUF+5,X0
         6 003257   001777 361003                    ANX1    1023,DU
         6 003260   000005 631411 xsym               EPPR1   VIDBUF+5,X1
         6 003261   200010 451500                    STP1    XTN$,,AUTO

      741     2321    4            RETURN;

   2321  6 003262   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003263   000001 702211                    TSX2  ! 1,X1

      742     2322    4            END;
      743     2323    3         END;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:138  
   2323  6 003264   000215 235000 1                  LDA     I
         6 003265   000001 035007                    ADLA    1,DL
         6 003266   000215 755000 1                  STA     I
         6 003267   000005 236000 xsym               LDQ     VIDBUF+5
         6 003270   000037 772000                    QRL     31
         6 003271   000215 116000 1                  CMPQ    I
         6 003272   003245 603000 6                  TRC     s:2319

      744     2324    2      ALTRETURN;

   2324  6 003273   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003274   000000 702211                    TSX2  ! 0,X1

      745     2325        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:139  
      746     2326    2   SETBIT: ENTRY ALTRET;

   2326  6 003275   200150 741300       SETBIT       STX1  ! @MSGNUM+1,,AUTO

      747     2327    2      MAPX=GRANULE;

   2327  6 003276   000216 235000 1                  LDA     GRANULE
         6 003277   200004 755100                    STA     MAPX,,AUTO

      748     2328    2      IF MAPX>FM_SRZERO THEN MAPX=MAPX-FM_SRZERO;

   2328  6 003300   000212 236000 2                  LDQ     FM_SRZERO
         6 003301   003307 604000 6                  TMI     s:2329
         6 003302   200004 116100                    CMPQ    MAPX,,AUTO
         6 003303   003307 605000 6                  TPL     s:2329

   2328  6 003304   200004 236100                    LDQ     MAPX,,AUTO
         6 003305   000212 136000 2                  SBLQ    FM_SRZERO
         6 003306   200004 756100                    STQ     MAPX,,AUTO

      749     2329    3      IF MAPX<=SETMAX THEN DO;

   2329  6 003307   200011 236100                    LDQ     SETMAX,,AUTO
         6 003310   003313 604000 6                  TMI     s:2330
         6 003311   200004 116100                    CMPQ    MAPX,,AUTO
         6 003312   003337 604000 6                  TMI     s:2338

      750     2330    3         BITX=MOD(MAPX,36);

   2330  6 003313   200004 236100                    LDQ     MAPX,,AUTO
         6 003314   000044 506007                    DIV     36,DL
         6 003315   200005 755100                    STA     BITX,,AUTO

      751     2331    3         MAPX=MAPX/36;

   2331  6 003316   200004 236100                    LDQ     MAPX,,AUTO
         6 003317   000044 506007                    DIV     36,DL
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:140  
         6 003320   200004 756100                    STQ     MAPX,,AUTO

      752     2332    4         IF NOT MAP(MAPX)&BITS(BITX) THEN DO;

   2332  6 003321   200005 720100                    LXL0    BITX,,AUTO
         6 003322   000007 470400 1                  LDP0    MAP_+1
         6 003323   000000 236106                    LDQ     0,QL,PR0
         6 003324   000146 376010 2                  ANQ     BITS,X0
         6 003325   003334 601000 6                  TNZ     s:2336

      753     2333    4            MAP(MAPX)=MAP(MAPX)|BITS(BITX);

   2333  6 003326   200004 722100                    LXL2    MAPX,,AUTO
         6 003327   000000 236112                    LDQ     0,X2,PR0
         6 003330   000146 276010 2                  ORQ     BITS,X0
         6 003331   000000 756112                    STQ     0,X2,PR0

      754     2334    4            RETURN;

   2334  6 003332   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003333   000001 702211                    TSX2  ! 1,X1

      755     2335    4            END;
      756     2336    3         ELSE SGRANS=SGRANS-1;

   2336  6 003334   000214 235000 1                  LDA     SGRANS
         6 003335   000001 135007                    SBLA    1,DL
         6 003336   000214 755000 1                  STA     SGRANS

      757     2337    3         END;

      758     2338    2      IF GRANULE<FM_SRZERO THEN RETURN;

   2338  6 003337   000216 236000 1                  LDQ     GRANULE
         6 003340   003343 604000 6                  TMI     s:2338+4
         6 003341   000212 116000 2                  CMPQ    FM_SRZERO
         6 003342   003344 603000 6                  TRC     s:2339
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:141  

   2338  6 003343   000001 702211                    TSX2  ! 1,X1

      759     2339    3      IF BADS.FDA~=F$DCB.BFR.DA(1) AND BADS.FDA~=FDFDA THEN DO;

   2339  6 003344   000212 470400 1                  LDP0    BAD$
         6 003345   200006 471500                    LDP1    EIDCB$,,AUTO
         6 003346   100116 236100                    LDQ     78,,PR1
         6 003347   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 003350   000000 116100                    CMPQ    0,,PR0
         6 003351   003426 600000 6                  TZE     s:2366
         6 003352   000000 236100                    LDQ     0,,PR0
         6 003353   200016 116100                    CMPQ    FDFDA,,AUTO
         6 003354   003426 600000 6                  TZE     s:2366

      760     2340    3         BAD$=PINCRW(BAD$,BADS.NXTNS+SIZEW(BADS)-1);

   2340  6 003355   000013 236100                    LDQ     11,,PR0
         6 003356   000022 736000                    QLS     18
         6 003357   000014 036003                    ADLQ    12,DU
         6 003360   000212 036000 1                  ADLQ    BAD$
         6 003361   000212 756000 1                  STQ     BAD$

      761     2341    3         BADS.FDA=F$DCB.BFR.DA(1);

   2341  6 003362   000212 470400 1                  LDP0    BAD$
         6 003363   100116 236100                    LDQ     78,,PR1
         6 003364   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 003365   000000 756100                    STQ     0,,PR0

      762     2342    3         BADS.NXTNS=0;

   2342  6 003366   000013 450100                    STZ     11,,PR0

      763     2343    3         BADS.NAME=F$DCB.NAME;

   2343  6 003367   200006 471500                    LDP1    EIDCB$,,AUTO
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:142  
         6 003370   000100 100500                    MLR     fill='000'O
         6 003371   100010 000040                    ADSC9   8,,PR1                   cn=0,n=32
         6 003372   000001 000040                    ADSC9   1,,PR0                   cn=0,n=32

      764     2344    3         BADS.ACCT=F$DCB.ACCT;

   2344  6 003373   200006 471500                    LDP1    EIDCB$,,AUTO
         6 003374   100020 237100                    LDAQ    16,,PR1
         6 003375   000011 755100                    STA     9,,PR0
         6 003376   000012 756100                    STQ     10,,PR0

      765     2345    4         IF FDFDA<=FM_MADSDA THEN DO;

   2345  6 003377   000213 236000 2                  LDQ     FM_MADSDA
         6 003400   200016 116100                    CMPQ    FDFDA,,AUTO
         6 003401   003415 602000 6                  TNC     s:2350

      766     2346    4            BADS.NAME='0'B;

   2346  6 003402   000100 100400                    MLR     fill='000'O
         6 003403   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 003404   000001 000040                    ADSC9   1,,PR0                   cn=0,n=32

      767     2347    4            BADS.ACCT=SPTXTS(FDFDA-FM_SRZERO);

   2347  6 003405   200016 236100                    LDQ     FDFDA,,AUTO
         6 003406   000212 136000 2                  SBLQ    FM_SRZERO
         6 003407   000002 736000                    QLS     2
         6 003410   040100 100406                    MLR     fill='040'O
         6 003411   000216 000004 2                  ADSC9   SPTXTS,Q                 cn=0,n=4
         6 003412   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8

      768     2348    4            BADS.FDA=FDFDA;

   2348  6 003413   200016 235100                    LDA     FDFDA,,AUTO
         6 003414   000000 755100                    STA     0,,PR0

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:143  
      769     2349    4            END;

      770     2350    3         BADS.XTNT(0)='0'B;

   2350  6 003415   000014 450100                    STZ     12,,PR0

      771     2351    3         BADFILES=BADFILES+1;

   2351  6 003416   200020 235100                    LDA     BADFILES,,AUTO
         6 003417   000001 035007                    ADLA    1,DL
         6 003420   200020 755100                    STA     BADFILES,,AUTO

      772     2352    3         IF BADFILES=MAXERR THEN ERRCODE=FXH$E$MAXERR;

   2352  6 003421   200020 236100                    LDQ     BADFILES,,AUTO
         6 003422   000217 116000 1                  CMPQ    MAXERR
         6 003423   003426 601000 6                  TNZ     s:2366

   2352  6 003424   000144 236000 2                  LDQ     FXH$E$MAXERR
         6 003425   000000 756000 xsym               STQ     ERRCODE

      773     2353                    /*E*     ERROR:   FXH-E$MAXERR-E
      774     2354                    *        MESSAGE:Too many errors occurred - reconstruct aborted.
      775     2355                    *        MESSAGE1:More than 20 errors occurred during reconstruct,
      776     2356                    *        indicating that this packset is probably in more trouble
      777     2357                    *        than reconstruct can repair. File access (e.g. for backup)
      778     2358                    *        will not do any more damage, but updating or creating files
      779     2359                    *        should be avoided. A rebuild of the packset is suggested.
      780     2360                    *        If there is a lot of dual allocation and the first or
      781     2361                    *        second such file listed has many granules so indicated,
      782     2362                    *        it may be expedient to delete that file and try again.
      783     2363                    */
      784     2364    3         END;

      785     2365                    /* ADD TO BAD EXTENT LIST */
      786     2366    2      MAPX=BADS.XTNT.XTNSIZE(BADS.NXTNS-1);

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:144  
   2366  6 003426   000013 235100                    LDA     11,,PR0
         6 003427   000013 236105                    LDQ     11,AL,PR0
         6 003430   000033 772000                    QRL     27
         6 003431   200004 756100                    STQ     MAPX,,AUTO

      787     2367    3      IF MAPX<511 AND GRANULE=BADS.XTNT.XTNSDA(BADS.NXTNS-1)+MAPX THEN DO;

   2367  6 003432   000777 116007                    CMPQ    511,DL
         6 003433   003453 605000 6                  TPL     s:2371
         6 003434   000013 235100                    LDA     11,,PR0
         6 003435   000013 236105                    LDQ     11,AL,PR0
         6 003436   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 003437   200004 036100                    ADLQ    MAPX,,AUTO
         6 003440   000216 116000 1                  CMPQ    GRANULE
         6 003441   003453 601000 6                  TNZ     s:2371

      788     2368    3         BADS.XTNT.XTNSIZE(BADS.NXTNS-1)=MAPX+1;

   2368  6 003442   000013 235100                    LDA     11,,PR0
         6 003443   200004 236100                    LDQ     MAPX,,AUTO
         6 003444   000001 036007                    ADLQ    1,DL
         6 003445   000033 736000                    QLS     27
         6 003446   000013 676105                    ERQ     11,AL,PR0
         6 003447   777000 376003                    ANQ     -512,DU
         6 003450   000013 656105                    ERSQ    11,AL,PR0

      789     2369    3         RETURN;

   2369  6 003451   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003452   000001 702211                    TSX2  ! 1,X1

      790     2370    3         END;
      791     2371    2      IF PINCRW(BAD$,BADS.NXTNS+2*SIZEW(BADS))>PINCRW(MAP_.PTR$,MAP_.W1.VSIZE#/4)

   2371  6 003453   000013 236100                    LDQ     11,,PR0
         6 003454   200156 756100                    STQ     @V+2,,AUTO
         6 003455   000006 236000 1                  LDQ     MAP_
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:145  
         6 003456   000020 772000                    QRL     16
         6 003457   000002 772000                    QRL     2
         6 003460   200157 756100                    STQ     @V+3,,AUTO
         6 003461   200156 236100                    LDQ     @V+2,,AUTO
         6 003462   000022 736000                    QLS     18
         6 003463   000032 036003                    ADLQ    26,DU
         6 003464   000212 036000 1                  ADLQ    BAD$
         6 003465   200160 756100                    STQ     @V+4,,AUTO
         6 003466   200157 236100                    LDQ     @V+3,,AUTO
         6 003467   000022 736000                    QLS     18
         6 003470   000007 036000 1                  ADLQ    MAP_+1
         6 003471   200160 116100                    CMPQ    @V+4,,AUTO
         6 003472   003477 603000 6                  TRC     s:2373

      792     2372    2      THEN CALL M$GDS(MAPSEG)ALTRET(SBITALT);

   2372  6 003473   000000 630400 1                  EPPR0   MAPSEG
         6 003474   430001 713400                    CLIMB   alt,gds
         6 003475   400400 401760                    pmme    nvectors=2
         6 003476   003515 702000 6                  TSX2    SBITALT

      793     2373    2      BADS.XTNT.XTNSDA(BADS.NXTNS)=GRANULE;

   2373  6 003477   000212 470400 1                  LDP0    BAD$
         6 003500   000013 235100                    LDA     11,,PR0
         6 003501   000216 236000 1                  LDQ     GRANULE
         6 003502   000014 676105                    ERQ     12,AL,PR0
         6 003503   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 003504   000014 656105                    ERSQ    12,AL,PR0

      794     2374    2      BADS.XTNT.XTNSIZE(BADS.NXTNS)=1;

   2374  6 003505   000013 235100                    LDA     11,,PR0
         6 003506   000014 236105                    LDQ     12,AL,PR0
         6 003507   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 003510   001000 276003                    ORQ     512,DU
         6 003511   000014 756105                    STQ     12,AL,PR0
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:146  

      795     2375    2      BADS.NXTNS=BADS.NXTNS+1;

   2375  6 003512   000013 054100                    AOS     11,,PR0

      796     2376    2      RETURN;

   2376  6 003513   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003514   000001 702211                    TSX2  ! 1,X1

   2375  6 003515                       SBITALT      null
      797     2377    2   SBITALT:;
      798     2378    2      ERRCODE=B$TCB.ALT$->B$ALT.ERR;

   2378  6 003515   000000 470400 xsym               LDP0    B$TCB$
         6 003516   000000 471500                    LDP1    0,,PR0
         6 003517   100102 236100                    LDQ     66,,PR1
         6 003520   000000 756000 xsym               STQ     ERRCODE

      799     2379    2      ALTRETURN;

   2379  6 003521   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003522   000000 702211                    TSX2  ! 0,X1

      800     2380        %EJECT;
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:147  
      801     2381    2   M$WRITEFD:ENTRY ALTRET;

   2381  6 003523   200150 741300       M$WRITEFD    STX1  ! @MSGNUM+1,,AUTO

      802     2382    2      IF ERRCODE OR COUNTONLY~=0 THEN RETURN;

   2382  6 003524   000000 235000 xsym               LDA     ERRCODE
         6 003525   003530 601000 6                  TNZ     s:2382+4
         6 003526   200017 236100                    LDQ     COUNTONLY,,AUTO
         6 003527   003531 600000 6                  TZE     s:2383

   2382  6 003530   000001 702211                    TSX2  ! 1,X1

      803     2383    2      CALL M$WRITE(WRITEFD)ALTRET(NOWRITEFD);

   2383  6 003531   000130 630400 2                  EPPR0   WRITEFD
         6 003532   440001 713400                    CLIMB   alt,write
         6 003533   401400 401760                    pmme    nvectors=4
         6 003534   003537 702000 6                  TSX2    NOWRITEFD

      804     2384    2      RETURN;

   2384  6 003535   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003536   000001 702211                    TSX2  ! 1,X1

   2382  6 003537                       NOWRITEFD    null
      805     2385    2   NOWRITEFD:;
      806     2386    2      RETURN;

   2386  6 003537   200150 221300                    LDX1  ! @MSGNUM+1,,AUTO
         6 003540   000001 702211                    TSX2  ! 1,X1
      807     2387    2   END DECOUT;
      808     2388    1   END FXH$RECON;

PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:148  
--  Include file information  --

   F$DCB.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXH$RECON.
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:149  

 **** Variables and constants ****

  ****  Section 001  Data  FXH$RECON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   276-0-0/c STRC(234)   r     1 ACHDR                    267-0-0/c STRC(243)   r     1 ACSUM
   212-0-0/w PTR         r     1 BAD$                     221-0-0/c STRC(234)   r     1 BADFM
   154-0-0/d STRC(1080)  r     1 CLSDP                    237-0-0/c STRC(207)   r     1 DISTH
   230-0-0/c STRC(234)   r     1 DISTH1                   102-0-0/d STRC(936)   r     1 EFPT
   305-0-0/w SBIN        r     1 GAC                      216-0-0/w SBIN        r     1 GRANULE
   215-0-0/w UBIN        r     1 I                        140-0-0/d STRC(432)   r     1 LOFPT
   213-0-0/w PTR         r     1 M$DP$                      0-0-0/d STRC(216)   r     1 MAPSEG
     6-0-0/d STRC(72)    r     1 MAP_                     217-0-0/w UBIN        r     1 MAXERR
   245-0-0/c STRC(207)   r     1 NUMBUF                    10-0-0/d STRC(2088)  r     1 NXTFPT
   134-0-0/w STRC(90)    r     1 RCNSN                    214-0-0/w UBIN        r     1 SGRANS
   220-0-0/w UBIN        r     1 SPARE                    261-0-0/c STRC(207)   r     1 VOLBUF
   253-0-0/c STRC(216)   r     1 VOLH

  ****  Section 002 RoData FXH$RECON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   146-0-0/b BIT         r     1 BITS(0:35)               106-0-0/b STRC        r     1 FIT1CODE
   215-0-0/w UBIN        r     1 FM_GPSDA                 213-0-0/w UBIN        r     1 FM_MADSDA
   214-0-0/w UBIN        r     1 FM_PADSDA                212-0-0/w UBIN        r     1 FM_SRZERO
   145-0-0/b STRC        r     1 FXH$E$FILECNT            144-0-0/b STRC        r     1 FXH$E$MAXERR
     0-0-0/d STRC(432)   r     1 GETTIME                  223-0-0/w PTR         r     1 MSGVEC(0:15)
   107-0-0/c STRC(72)    r     1 PAD_FIT                  112-0-0/d STRC(504)   r     1 READFD
   216-0-0/c CHAR(4)     r     1 SPTXTS(0:4)               14-0-0/d STRC(2088)  r     1 UPD04
   130-0-0/d STRC(432)   r     1 WRITEFD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:150  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   153-0-0/w PTR         r     1 @C                       147-0-0/w PTR         r     1 @MSGNUM
     3-0-0/w PTR         r     1 @PARM                    152-0-0/w PTR         r     1 @S
   151-0-0/w PTR         r     1 @T                       154-0-0/w PTR         r     1 @V
    23-0-0/w SBIN        r     1 ACCTS                     22-0-0/w SBIN        r     1 AFILES
    13-0-0/w SBIN        r     1 AGRANS                     7-0-0/w PTR         r     1 BAD1$
    20-0-0/w UBIN        r     1 BADFILES                   5-0-0/w UBIN        r     1 BITX
    *0-0-0/w UBIN        r     1 C                         17-0-0/w UBIN        r     1 COUNTONLY
     6-0-0/w PTR         r     1 EIDCB$                    16-0-0/w UBIN        r     1 FDFDA
    14-0-0/w UBIN        r     1 FGRANS                    21-0-0/w SBIN        r     1 FILES
     4-0-0/w SBIN        r     1 MAPX                      24-0-0/w UBIN        r     1 MAXGRAN(0:19)
    *0-0-0/w UBIN        r     1 MSGNUM                    12-0-0/w SBIN        r     1 NXTNS
    *0-0-0/w UBIN        r     1 PARM                      *0-0-0/w UBIN        r     1 S
    11-0-0/w UBIN        r     1 SETMAX                   142-0-0/b BIT         r     1 SHR_GAC
    *0-0-0/w CHAR(200)   r     1 T                         *0-0-0/w STRC(1800)  r     1 TN
    *0-0-0/w UBIN        r     1 V                         50-0-0/w UBIN        r     1 VOLGRAN(0:19)
    10-0-0/w PTR         r     1 XTN$                      74-0-0/w STRC(1368)  r     1 XTNDIST
    15-0-0/w UBIN        r     1 XTNSIZE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w UBIN        r     1 BREAK                      0-0-0/b BIT         r     1 ERRCODE
     0-0-0/w STRC(36864) r     1 FIT                        0-0-0/w STRC(36864) r     1 FM$GRAN
     0-0-0/w UBIN        r     1 GPBUF(0:6)                 0-0-0/w STRC(36864) r     1 MSG
     0-0-0/w STRC(36864) r     1 VIDBUF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:151  
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(468)   r     1 BADS
     0-0-0/w STRC(576)   r     1 CODE01                     0-0-0/w STRC(324)   r     1 CODE03
     0-0-0/w STRC(396)   r     1 CODE04                     0-0-0/w STRC(288)   r     1 CODE14
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DP
     0-0-0N  NULL        r     1 M$EI                       0-0-0N  NULL        r     1 M$LO
     0-0-0/w BIT         r     1 MAP(0:0)                   0-0-0/w UBIN(9)     r     1 MSGSZ
     0-0-0/w STRC(72)    r     1 VXH                        0-0-0/w UBIN        r     1 WRD(0:0)


   Procedure FXH$RECON requires 1889 words for executable code.
   Procedure FXH$RECON requires 122 words of local(AUTO) storage.

    No errors detected in file FXH$RECON.:E05TSI    .
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:152  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:153  
          MINI XREF LISTING

ACCTS
      1667**DCL      1807<<ASSIGN   1808<<ASSIGN   1813>>ASSIGN   1832<<ASSIGN   1940>>IF       1968<<ASSIGN
      1968>>ASSIGN   1974>>IF
ACHDR
      1727**DCL      1684--DCLINIT
ACSUM
      1722**DCL      1684--DCLINIT
ACSUM.TX
      1724**DCL      1928<<CALLBLT  1929<>CALL     1958<<ASSIGN   1960<>CALL     1961<>CALL     1962<>CALL
      1964<<CALLBLT
AFILES
      1666**DCL      1832>>ASSIGN   1847>>IF       1848<<ASSIGN   1848>>ASSIGN   1888<<ASSIGN   1888>>ASSIGN
      1896>>IF       1960<>CALL     2229<<ASSIGN   2244<<ASSIGN   2244>>ASSIGN   2264<<ASSIGN
AGRANS
      1659**DCL      1810<<ASSIGN   1812>>DOWHILE  1813>>ASSIGN   1819<<ASSIGN   1819>>ASSIGN   1836<<ASSIGN
      1881<<ASSIGN   1881>>ASSIGN   1895>>ASSIGN   1921>>IF       1925>>ASSIGN   1947<<ASSIGN   1948>>IF
      1958>>IF       1961<>CALL     1969>>IF       1989<<ASSIGN   1997>>IF       2013<<ASSIGN   2024<<ASSIGN
      2186<<ASSIGN   2187>>IF       2187>>ASSIGN   2189>>DOWHILE  2231<<ASSIGN   2237<<ASSIGN   2250>>IF
      2250<<ASSIGN   2251>>ASSIGN
ALLDONE
      2140**LABEL    1844--GOTO     2148--GOTO
B$ALT.CODE
       979**DCL       979--REDEF     980--REDEF     980--REDEF
B$ALT.ERR
       980**DCL      1889>>ASSIGN   1941>>ASSIGN   2147>>ASSIGN   2378>>ASSIGN
B$ALT.ERR.CODE
       981**DCL      1886>>IF       1947>>ASSIGN
B$ALT.ERR.ERR#
       981**DCL       981--REDEF
B$ALT.EVID
       980**DCL       980--REDEF     980--REDEF
B$JIT.ERR.MID
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:154  
       780**DCL       780--REDEF
B$JIT.SYSID
       779**DCL      1783>>IF       1927>>IF       1949>>IF       2047>>IF       2105>>IF
B$JIT$
       972**DCL       774--IMP-PTR  1783>>IF       1927>>IF       1949>>IF       2047>>IF       2105>>IF
B$TCB.ALT$
       975**DCL      1886>>IF       1889>>ASSIGN   1941>>ASSIGN   1947>>ASSIGN   2147>>ASSIGN   2378>>ASSIGN
B$TCB$
       973**DCL       975--IMP-PTR  1886>>IF       1889>>ASSIGN   1941>>ASSIGN   1947>>ASSIGN   2147>>ASSIGN
      2378>>ASSIGN
BAD$
      1629**DCL      1732--IMP-PTR  1799<<ASSIGN   1800>>ASSIGN   1887>>IF       1887>>IF       1891>>ASSIGN
      1891>>ASSIGN   1892>>ASSIGN   1916>>IF       1917>>ASSIGN   1918>>ASSIGN   1940>>IF       1943>>ASSIGN
      1944>>ASSIGN   2054>>ASSIGN   2055<<ASSIGN   2056>>DOWHILE  2057<<ASSIGN   2057>>ASSIGN   2057>>ASSIGN
      2058>>IF       2063>>IF       2065>>CALLBLT  2066>>ASSIGN   2068>>CALLBLT  2070>>IF       2073>>IF
      2073>>CALL     2074>>CALL     2082>>IF       2083>>IF       2085>>ASSIGN   2089>>IF       2091>>DOINDEX
      2092>>IF       2093>>ASSIGN   2096>>CALL     2099>>ASSIGN   2100>>DOWHILE  2100>>DOWHILE  2105>>ASSIGN
      2339>>IF       2339>>IF       2340<<ASSIGN   2340>>ASSIGN   2340>>ASSIGN   2341>>ASSIGN   2342>>ASSIGN
      2343>>ASSIGN   2344>>ASSIGN   2346>>ASSIGN   2347>>ASSIGN   2348>>ASSIGN   2350>>ASSIGN   2366>>ASSIGN
      2366>>ASSIGN   2367>>IF       2367>>IF       2368>>ASSIGN   2368>>ASSIGN   2371>>IF       2371>>IF
      2373>>ASSIGN   2373>>ASSIGN   2374>>ASSIGN   2374>>ASSIGN   2375>>ASSIGN   2375>>ASSIGN
BAD1$
      1655**DCL      1800<<ASSIGN   2055>>ASSIGN
BADFILES
      1664**DCL      1760<<ASSIGN   2050<>CALL     2351<<ASSIGN   2351>>ASSIGN   2352>>IF
BADFM
      1692**DCL      1682--DCLINIT  2049<>CALL     2050<>CALL
BADS
      1732**DCL      1792--ASSIGN   1799--ASSIGN   2057--ASSIGN   2340--ASSIGN   2371--IF
BADS.ACCT
      1737**DCL      1887>>IF       1940>>IF       2068>>CALLBLT  2344<<ASSIGN   2347<<ASSIGN
BADS.FDA
      1733**DCL      1891>>ASSIGN   1892<<ASSIGN   1918<<ASSIGN   1944<<ASSIGN   2058>>IF       2073<>CALL
      2082>>IF       2085>>ASSIGN   2339>>IF       2339>>IF       2341<<ASSIGN   2348<<ASSIGN
BADS.NAME
      1734**DCL      1887>>IF       2343<<ASSIGN   2346<<ASSIGN
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:155  
BADS.NAME.C
      1736**DCL      2065>>CALLBLT
BADS.NAME.L
      1735**DCL      2066>>ASSIGN
BADS.NXTNS
      1738**DCL      2057>>ASSIGN   2091>>DOINDEX  2340>>ASSIGN   2342<<ASSIGN   2366>>ASSIGN   2367>>IF
      2368>>ASSIGN   2371>>IF       2373>>ASSIGN   2374>>ASSIGN   2375<<ASSIGN   2375>>ASSIGN
BADS.XTNT
      1739**DCL      1891<<ASSIGN   1917<<ASSIGN   1943<<ASSIGN   2070>>IF       2074<>CALL     2089>>IF
      2096<>CALL     2350<<ASSIGN
BADS.XTNT.XTNSDA
      1741**DCL      2092>>IF       2099>>ASSIGN   2100>>DOWHILE  2367>>IF       2373<<ASSIGN
BADS.XTNT.XTNSIZE
      1740**DCL      1916>>IF       2063>>IF       2073>>IF       2083>>IF       2093>>ASSIGN   2100>>DOWHILE
      2366>>ASSIGN   2368<<ASSIGN   2374<<ASSIGN
BITS
      1648**DCL      1999>>IF       2023>>IF       2029>>DOWHILE  2115<>CALL     2189>>DOWHILE  2332>>IF
      2333>>ASSIGN
BITX
      1647**DCL      1996<<ASSIGN   1999>>IF       2023>>IF       2028<<ASSIGN   2029>>DOWHILE  2029>>DOWHILE
      2030<<ASSIGN   2030>>ASSIGN   2032>>ASSIGN   2032>>ASSIGN   2188<<ASSIGN   2189>>DOWHILE  2189>>DOWHILE
      2190<<ASSIGN   2190>>ASSIGN   2192>>ASSIGN   2192>>ASSIGN   2306<<ASSIGN   2310>>ASSIGN   2312<<ASSIGN
      2312>>ASSIGN   2330<<ASSIGN   2332>>IF       2333>>ASSIGN
BREAK
      1365**DCL      1842>>IF       1970>>IF       2105>>IF       2144<<ASSIGN   2152>>IF       2163>>IF
      2163<<ASSIGN
C IN PROCEDURE DECOUT
      2297**DCL      2286--PROC     2299>>CALLBLT  2300>>CALLBLT  2300>>CALLBLT  2300>>CALLBLT  2302--ENTRY
      2305--ENTRY    2309>>DOINDEX  2314>>CALLBLT
CLSDP
      1506**DCL      2047<>CALL
CLSDP.SN_
      1506**DCL      1506--REDEF
CLSDP.UTL_
      1507**DCL      1507--REDEF
CLSDP.V
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:156  
      1511**DCL      1506--DCLINIT
CLSDP.V.EXPIRE#
      1521**DCL      1521--REDEF
CLSDP.V.TYPE#
      1519**DCL      1519--REDEF
CLSDP.V.XTNSIZE#
      1516**DCL      1516--REDEF    1518--REDEF
CLSERR
      2047**LABEL    2047--CALLALT  2149--GOTO
CODE01.EXTNT.XTNSIZE
       987**DCL      1862>>ASSIGN
CODE01.XTNT
       986**DCL       987--REDEF
CODE01.XTNT.XTNSDA
       986**DCL      1852>>IF       1859>>ASSIGN
CODE01.XTNT.XTNSIZE
       986**DCL      1860>>ASSIGN
CODE03.NGAVAL
       992**DCL      1874>>IF       1876<<ASSIGN
CODE03.UGRANS
       990**DCL      1874>>IF       1875>>IF       1875<<ASSIGN   1876>>ASSIGN
CODE04
       999**DCL      2046--CALL     2220--ASSIGN
CODE04.MODIFY
      1001**DCL      2046--CALL
CODE14.CGRANS
      1012**DCL      1925<<ASSIGN   1925>>ASSIGN   1929<>CALL     2237>>IF       2237>>ASSIGN   2239<<ASSIGN
COUNTONLY
      1663**DCL      1749<<ASSIGN   1753<<ASSIGN   1768>>IF       1949>>IF       1969>>IF       2382>>IF
DECOUT
      2286**PROC     1929--CALL     1960--CALL     1961--CALL     1962--CALL     2049--CALL     2050--CALL
      2094--CALL     2115--CALL     2116--CALL     2118--CALL     2120--CALL     2128--CALL     2129--CALL
      2130--CALL     2136--CALL     2137--CALL
DISTH
      1702**DCL      1469--DCLINIT  1470--DCLINIT  1680--DCLINIT
DISTH1
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:157  
      1697**DCL      1682--DCLINIT
DMPANYWAY IN PROCEDURE DUMP5
      2153**LABEL    2154--CALLALT
DNXTVOL
      2125**LABEL    2133--GOTO
DUMP5
      2151**PROC     2089--CALL     2092--CALL     2101--CALL
EFPT
      1349**DCL      2086<>CALL
EFPT.BUF_
      1349**DCL      2084<<ASSIGN
EFPT.V
      1353**DCL      1349--DCLINIT
EIDCB$
      1654**DCL      1580--IMP-PTR  1755<<ASSIGN   1758<<ASSIGN   1782>>IF       1844>>IF       1849>>IF
      1852>>IF       1853>>ASSIGN   1877>>ASSIGN   1887>>IF       1887>>IF       1893>>IF       1936>>ASSIGN
      1940>>IF       1946>>IF       1951<>CALL     1964>>CALLBLT  2117>>IF       2131>>IF       2140<<ASSIGN
      2339>>IF       2341>>ASSIGN   2343>>ASSIGN   2344>>ASSIGN
ERRCODE
      1635**DCL      1761<<ASSIGN   1897<<ASSIGN   1914>>ASSIGN   1918>>ASSIGN   1974<<ASSIGN   2045>>IF
      2142<<ASSIGN   2143>>IF       2147>>IF       2147<<ASSIGN   2352<<ASSIGN   2378<<ASSIGN   2382>>IF
F$DCB.ACCT
      1590**DCL      1887>>IF       1940>>IF       1946>>IF       1964>>CALLBLT  2344>>ASSIGN
F$DCB.ACTPOS
      1605**DCL      1605--REDEF
F$DCB.ARS
      1580**DCL      1580--REDEF
F$DCB.ATTR
      1598**DCL      1599--REDEF
F$DCB.BFR.DA
      1625**DCL      1852>>IF       1853>>ASSIGN   1877>>ASSIGN   1936>>ASSIGN   2339>>IF       2341>>ASSIGN
F$DCB.BORROW
      1613**DCL      1613--REDEF    1613--REDEF    1613--REDEF
F$DCB.DCBNAME.L
      1627**DCL      1627--IMP-SIZ
F$DCB.EOMCHAR
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:158  
      1584**DCL      1584--REDEF
F$DCB.FFLG
      1584**DCL      1849>>IF
F$DCB.FFLG.WNEW
      1585**DCL      2045>>IF
F$DCB.FLDID
      1608**DCL      1608--REDEF
F$DCB.FORM$
      1602**DCL      1602--REDEF
F$DCB.FSECT
      1618**DCL      1618--REDEF
F$DCB.FSN
      1595**DCL      1595--REDEF    1595--REDEF    1596--REDEF
F$DCB.HEADER$
      1601**DCL      1601--REDEF
F$DCB.IXTNSIZE
      1599**DCL      1599--REDEF
F$DCB.LASTSTA$
      1589**DCL      1589--REDEF
F$DCB.LVL
      1614**DCL      1614--REDEF
F$DCB.NAME
      1589**DCL      1887>>IF       2343>>ASSIGN
F$DCB.NAME.C
      1589**DCL      1589--REDEF    1893>>IF
F$DCB.NOEOF
      1610**DCL      1610--REDEF
F$DCB.NRECS
      1600**DCL      1600--REDEF
F$DCB.NRECX
      1619**DCL      1619--REDEF
F$DCB.OHDR
      1611**DCL      1611--REDEF
F$DCB.ORG
      1594**DCL      1594--REDEF
F$DCB.OWNER
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:159  
      1611**DCL      1766>>IF
F$DCB.PRECNO
      1617**DCL      1617--REDEF
F$DCB.PSN
      1590**DCL      1764>>ASSIGN
F$DCB.RCSZ
      1622**DCL      1622--REDEF
F$DCB.RES
      1590**DCL      1590--REDEF
F$DCB.SETX
      1602**DCL      1602--REDEF
F$DCB.TAB$
      1601**DCL      1602--REDEF
F$DCB.TDA
      1616**DCL      1616--REDEF
F$DCB.WSN
      1591**DCL      1591--REDEF
FDCNTERR
      1897**LABEL    1847--GOTO
FDERR IN PROCEDURE GPDIST
      2258**LABEL    2233--CALLALT  2245--CALLALT  2256--CALLALT
FDFDA
      1662**DCL      1803<<ASSIGN   1826<<ASSIGN   1828<<ASSIGN   1830<<ASSIGN   1917>>ASSIGN   1922>>ASSIGN
      1936<<ASSIGN   1943>>ASSIGN   1975<<ASSIGN   1979<<ASSIGN   2226>>ASSIGN   2259<<ASSIGN   2270>>ASSIGN
      2272>>ASSIGN   2276<<ASSIGN   2308<<ASSIGN   2310<<ASSIGN   2310>>ASSIGN   2314>>CALLBLT  2339>>IF
      2345>>IF       2347>>ASSIGN   2348>>ASSIGN
FGG$PROCESS_FIT
      1746**DCL-ENT  1882--CALL
FGG$START
      1745**DCL-ENT  1951--CALL
FGRANS
      1660**DCL      1845<<ASSIGN   1866<<ASSIGN   1866>>ASSIGN   1874>>IF       1875>>IF       1875>>ASSIGN
      1876>>ASSIGN   1881>>ASSIGN   1962<>CALL     1991<<ASSIGN   1992>>ASSIGN   2002>>ASSIGN   2004>>ASSIGN
      2025>>ASSIGN   2171<<ASSIGN   2184>>ASSIGN   2187<<ASSIGN   2187>>ASSIGN   2195>>ASSIGN   2230<<ASSIGN
      2246<<ASSIGN   2246>>ASSIGN   2251>>ASSIGN
FILES
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:160  
      1665**DCL      1762<<ASSIGN   1784<<ASSIGN   1850<<ASSIGN   1850>>ASSIGN   1950>>IF       1955<<ASSIGN
      1973>>IF       1973<<ASSIGN   1973>>ASSIGN   2049<>CALL     2148>>IF       2207>>IF
FIT
      1024**DCL      1167--DCLINIT  1394--DCLINIT  1395--DCLINIT  1436--DCLINIT  1437--DCLINIT  1981<<ASSIGN
      1987--ASSIGN   2181--DOWHILE  2182--IF
FIT.CODES
      1024**DCL      1283--DCLINIT  1851--ASSIGN   1882--CALL     1982--ASSIGN   2180--ASSIGN   2198--ASSIGN
      2217<<ASSIGN   2218<<ASSIGN   2218>>ASSIGN   2282--ASSIGN   2320--ASSIGN
FIT.CODES.CODE
      1024**DCL      2318>>DOINDEX  2319>>IF
FIT.CODES.ITEMX
      1024**DCL      1851>>ASSIGN   2320>>ASSIGN
FIT.CODES.NDW
      1024**DCL      1857>>ASSIGN   2319>>IF
FIT1CODE
      1323**DCL      2217>>ASSIGN
FM$GRAN
      1027**DCL      2268--ASSIGN
FM$GRAN.AVAIL
      1028**DCL      2269<<ASSIGN
FM$GRAN.BLINK
      1028**DCL      2173<<ASSIGN   2179>>IF       2227<<ASSIGN   2234>>IF       2255>>ASSIGN   2258>>IF
      2280<<ASSIGN
FM$GRAN.FLINK
      1028**DCL      2201>>ASSIGN   2248>>ASSIGN   2257>>IF       2273<<ASSIGN   2275<<ASSIGN
FM$GRAN.KEYCNT
      1028**DCL      2244>>ASSIGN
FM$GRAN.LVL
      1027**DCL      2235>>IF       2237>>IF
FM$GRAN.NAVX
      1027**DCL      2181>>DOWHILE  2182>>IF       2198>>ASSIGN   2268<<ASSIGN   2269>>ASSIGN
FM$GRAN.STAMP.GMOD
      1027**DCL      2270<<ASSIGN
FM_GPSDA
      1677**DCL      1825>>ASSIGN   1826>>ASSIGN   1979>>ASSIGN
FM_MADSDA
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:161  
      1675**DCL      1828>>ASSIGN   2345>>IF
FM_PADSDA
      1676**DCL      1830>>ASSIGN   2214>>ASSIGN
FM_SRZERO
      1674**DCL      1803>>ASSIGN   2016>>ASSIGN   2174>>ASSIGN   2328>>IF       2328>>ASSIGN   2338>>IF
      2347>>ASSIGN
FXH$E$FILECNT
      1643**DCL      1897>>ASSIGN   1974>>ASSIGN   2058>>IF       2082>>IF
FXH$E$MAXERR
      1639**DCL      2352>>ASSIGN
GAC
      1744**DCL      1766>>IF       1882>>IF       1951>>IF       1951<>CALL     2142>>IF
GETTIME
      1081**DCL      2219<>CALL
GETTIME.V
      1085**DCL      1081--DCLINIT
GPBUF
      1369**DCL      1981>>ASSIGN
GPDERR IN PROCEDURE GPDIST
      2201**LABEL    2178--CALLALT  2179--GOTO     2215--CALLALT  2216--CALLALT  2221--CALLALT
GPDIST
      2167**PROC     1785--CALL     1976--CALL
GPSUMENT
      2108**LABEL    1790--GOTO
GRANULE
      1634**DCL      1392--DCLINIT  1393--DCLINIT  1435--DCLINIT  1775<<ASSIGN   1792<<ASSIGN   1793>>DOWHILE
      1796>>DOINDEX  1799>>ASSIGN   1802<<ASSIGN   1815<<ASSIGN   1822<<ASSIGN   1825<<ASSIGN   1853<<ASSIGN
      1859<<ASSIGN   1870<<ASSIGN   1870>>ASSIGN   1877<<ASSIGN   1889<<ASSIGN   1892>>ASSIGN   1914<<ASSIGN
      1922<<ASSIGN   1941<<ASSIGN   1944>>ASSIGN   1992<<ASSIGN   1993>>DOWHILE  1994<<ASSIGN   1994>>ASSIGN
      1995>>ASSIGN   1996>>ASSIGN   1998<<ASSIGN   2002>>ASSIGN   2004>>ASSIGN   2016>>ASSIGN   2022<<ASSIGN
      2025>>ASSIGN   2039>>IF       2092>>IF       2099<<ASSIGN   2100>>DOWHILE  2102<<ASSIGN   2102>>ASSIGN
      2174<<ASSIGN   2177>>DOWHILE  2200>>ASSIGN   2201<<ASSIGN   2214<<ASSIGN   2226<<ASSIGN   2232>>DOWHILE
      2247>>ASSIGN   2248<<ASSIGN   2253>>DOWHILE  2254>>ASSIGN   2255<<ASSIGN   2257<<ASSIGN   2259>>ASSIGN
      2271>>ASSIGN   2272<<ASSIGN   2280>>ASSIGN   2281<<ASSIGN   2303<<ASSIGN   2327>>ASSIGN   2338>>IF
      2367>>IF       2373>>ASSIGN
I
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:162  
      1633**DCL      1085--DCLINIT  1349--DCLINIT  1778<<DOINDEX  1779>>ASSIGN   1780>>ASSIGN   1796<<DOINDEX
      1797>>ASSIGN   1804<<DOINDEX  1807>>IF       1808>>ASSIGN   1814>>IF       1815>>ASSIGN   1822>>ASSIGN
      1858<<DOINDEX  1859>>ASSIGN   1860>>ASSIGN   1862>>ASSIGN   1864<<ASSIGN   1864>>ASSIGN   1983<<ASSIGN
      1986>>ASSIGN   1990>>ASSIGN   1991>>ASSIGN   1993>>DOWHILE  2008>>ASSIGN   2027>>ASSIGN   2027>>ASSIGN
      2041<<ASSIGN   2041>>ASSIGN   2060<<ASSIGN   2066<<ASSIGN   2068>>CALLBLT  2069<<CALLBLT  2069>>CALLBLT
      2071>>CALLBLT  2072<<ASSIGN   2072>>ASSIGN   2073<>CALL     2074<>CALL     2075>>ASSIGN   2079>>ASSIGN
      2085<<ASSIGN   2091<<DOINDEX  2092>>IF       2093>>ASSIGN   2096>>CALL     2099>>ASSIGN   2100>>DOWHILE
      2100>>DOWHILE  2110<<ASSIGN   2111>>DOWHILE  2111>>DOWHILE  2111>>DOWHILE  2112<<ASSIGN   2112>>ASSIGN
      2114>>DOWHILE  2115>>CALL     2116>>CALL     2118>>CALL     2121<<ASSIGN   2121>>ASSIGN   2125<<ASSIGN
      2127<<ASSIGN   2127>>ASSIGN   2128<>CALL     2129>>CALL     2130>>CALL     2130>>CALL     2131>>ASSIGN
      2133>>IF       2134>>IF       2172<<ASSIGN   2179>>IF       2179>>IF       2183<<ASSIGN   2184>>ASSIGN
      2184>>ASSIGN   2185<<DOINDEX  2186>>ASSIGN   2186>>ASSIGN   2194<<ASSIGN   2195>>ASSIGN   2195>>ASSIGN
      2200<<ASSIGN   2218>>ASSIGN   2220>>ASSIGN   2228<<ASSIGN   2234>>IF       2235>>IF       2247<<ASSIGN
      2253>>IF       2254<<ASSIGN   2257>>IF       2318<<DOINDEX  2319>>IF       2319>>IF       2320>>ASSIGN
LNKERR IN PROCEDURE GPDIST
      2253**LABEL    2234--GOTO
LOCCODT IN PROCEDURE DECOUT
      2317**ENTRY    1873--CALL     1924--CALL     2216--CALL     2236--CALL
LOFPT
      1468**DCL      2210<>CALL
LOFPT.BUF_.BOUND
      1468**DCL      2209<<ASSIGN
LOFPT.BUF_.BUF$
      1470**DCL      2208<<ASSIGN
LOFPT.STATION_
      1470**DCL      1470--REDEF
LOFPT.V
      1471**DCL      1468--DCLINIT
LOFPT.V.DVBYTE.VFC#
      1477**DCL      1477--REDEF
M$CLOSE
        19**DCL-ENT  2047--CALL
M$DP
      1527**DCL      2045--IF
M$DP$
      1631**DCL      1764>>ASSIGN   1766>>IF
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:163  
M$EI
      1525**DCL      1755--ASSIGN
M$ERRMSG
        82**DCL-ENT  2086--CALL
M$GDS
        54**DCL-ENT  1794--CALL     2372--CALL
M$OPEN
        19**DCL-ENT  1839--CALL     1846--CALL     2221--CALL
M$READ
        20**DCL-ENT  1776--CALL     1805--CALL     1923--CALL     2154--CALL     2178--CALL     2215--CALL
      2233--CALL     2256--CALL
M$TIME
        86**DCL-ENT  2219--CALL
M$WRITE
        20**DCL-ENT  2210--CALL     2383--CALL
M$WRITEFD IN PROCEDURE DECOUT
      2381**ENTRY    1878--CALL     1926--CALL     2240--CALL     2279--CALL
MAP
      1742**DCL      1797<<ASSIGN   1998>>IF       1999>>IF       2022>>IF       2023>>IF       2332>>IF
      2333<<ASSIGN   2333>>ASSIGN
MAPSEG
      1050**DCL      1794<>CALL     2372<>CALL
MAPSEG.V
      1050**DCL      1050--DCLINIT
MAPX
      1646**DCL      1995<<ASSIGN   1998>>IF       1998>>ASSIGN   1999>>IF       2022>>IF       2022>>ASSIGN
      2023>>IF       2026<<ASSIGN   2027>>ASSIGN   2029>>DOWHILE  2093<<ASSIGN   2094<>CALL     2309<<DOINDEX
      2327<<ASSIGN   2328>>IF       2328<<ASSIGN   2328>>ASSIGN   2329>>IF       2330>>ASSIGN   2331<<ASSIGN
      2331>>ASSIGN   2332>>IF       2333>>ASSIGN   2333>>ASSIGN   2366<<ASSIGN   2367>>IF       2367>>IF
      2368>>ASSIGN
MAP_
      1066**DCL      1050--DCLINIT
MAP_.PTR$
      1068**DCL      1742--IMP-PTR  1797>>ASSIGN   1799>>ASSIGN   1998>>IF       1999>>IF       2022>>IF
      2023>>IF       2332>>IF       2333>>ASSIGN   2333>>ASSIGN   2371>>IF
MAP_.W1.VSIZE#
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:164  
      1066**DCL      1793>>DOWHILE  2371>>IF
MAP_.W2
      1067**DCL      1068--REDEF
MAXERR
      1636**DCL      1773<<ASSIGN   1774<<ASSIGN   1847>>IF       1847>>IF       1940>>IF       2352>>IF
MAXGRAN
      1668**DCL      1763<<ASSIGN   1780<<ASSIGN   1815>>ASSIGN   1822>>ASSIGN   1991>>ASSIGN   1993>>DOWHILE
      2130>>CALL     2130>>CALL     2133>>IF
MSG
      1030**DCL      2153<<ASSIGN
MSG.I
      1032**DCL      2158<<DOINDEX  2159>>CALL     2159>>CALL     2160>>CALL     2160>>CALL
MSG.L
      1033**DCL      1683--DCLINIT  2075<<ASSIGN   2079<<ASSIGN   2087<<ASSIGN   2097<<ASSIGN   2157<<ASSIGN
MSG.T
      1034**DCL      2059<<ASSIGN   2063<<ASSIGN   2064<<ASSIGN   2065<<CALLBLT  2068<<CALLBLT  2069>>CALLBLT
      2071<<CALLBLT  2073<>CALL     2074<>CALL     2078<<CALLBLT  2084--ASSIGN   2094<>CALL     2095<<CALLBLT
      2096<>CALL     2156<<ASSIGN   2159<>CALL     2160<>CALL
MSG.WD
      1031**DCL      2159>>CALL     2160>>CALL
MSGNUM IN PROCEDURE GPDIST
      2168**DCL      2167--PROC     2206--ENTRY    2208>>ASSIGN   2209>>ASSIGN   2213--ENTRY    2220>>ASSIGN
MSGSZ IN PROCEDURE GPDIST
      2169**DCL      2209>>ASSIGN
MSGVEC
      1679**DCL      2208>>ASSIGN   2209>>ASSIGN
NO14 IN PROCEDURE GPDIST
      2237**LABEL    2236--CALLALT
NO3
      1880**LABEL    1873--CALLALT
NOEMSG
      2087**LABEL    2086--CALLALT
NONXTA
      1930**LABEL    1839--CALLALT  1840--GOTO
NONXTF
      1882**LABEL    1846--CALLALT
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:165  
NOTCOUNT
      1753**LABEL    1750--GOTO
NOTGPSUM
      1758**LABEL    1756--GOTO
NOWRITEFD IN PROCEDURE DECOUT
      2382**LABEL    2383--CALLALT
NUMBUF
      1707**DCL      1680--DCLINIT  2115<>CALL     2116<>CALL     2118<>CALL     2120<>CALL
NUMBUF.TX
      1709**DCL      1787<<ASSIGN
NXTA
      1833**LABEL    1923--CALLALT  1924--CALLALT  1933--GOTO     1971--GOTO
NXTF
      1838**LABEL    1849--GOTO     1883--GOTO     1893--GOTO     1969--GOTO
NXTFPT
      1162**DCL      1839<>CALL     1846<>CALL
NXTFPT.ACCT_
      1166**DCL      1833<<ASSIGN   1967<<ASSIGN
NXTFPT.ACSVEH_
      1164**DCL      1165--REDEF
NXTFPT.ALTKEYS_
      1170**DCL      1171--REDEF    1171--REDEF
NXTFPT.HDR_
      1169**DCL      1170--REDEF
NXTFPT.NAME_
      1163**DCL      1835<<ASSIGN   1937<<ASSIGN
NXTFPT.TAB_
      1168**DCL      1169--REDEF
NXTFPT.UHL_
      1162**DCL      1163--REDEF    1163--REDEF
NXTFPT.V
      1171**DCL      1162--DCLINIT
NXTFPT.V.FSN#
      1202**DCL      1202--REDEF    1202--REDEF
NXTFPT.V.OPER.NXTA#
      1174**DCL      1837<<ASSIGN   1939<<ASSIGN
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:166  
NXTFPT.V.OPER.NXTF#
      1174**DCL      1838<<ASSIGN   1938<<ASSIGN
NXTFPT.WSN_
      1168**DCL      1168--REDEF
NXTNS
      1658**DCL      1809<<DOINDEX  1810>>ASSIGN   1811>>IF       1812>>DOWHILE  1857<<ASSIGN   1858>>DOINDEX
      1988<<ASSIGN   2001<<ASSIGN   2001>>ASSIGN   2002>>ASSIGN   2003>>IF       2004>>ASSIGN   2011<<ASSIGN
      2025>>ASSIGN   2026>>ASSIGN   2026>>ASSIGN   2036<<ASSIGN   2036>>ASSIGN   2037>>ASSIGN   2038>>ASSIGN
      2271<<ASSIGN   2273>>IF       2281>>ASSIGN   2307<<ASSIGN   2310>>ASSIGN   2311<<ASSIGN   2311>>ASSIGN
NXTVOL
      1983**LABEL    2042--GOTO
OCTOUT IN PROCEDURE DECOUT
      2305**ENTRY    2096--CALL     2159--CALL     2160--CALL
OCTOUTRD IN PROCEDURE DECOUT
      2302**ENTRY    2073--CALL     2074--CALL
PAD_FIT
      1336**DCL      1283--DCLINIT
PARM
      1630**DCL         9--PROC     1752--ENTRY    1767--IF       1770<>CALL     1773>>ASSIGN
PRINT IN PROCEDURE GPDIST
      2206**ENTRY    1788--CALL     1930--CALL     1956--CALL     1965--CALL     2051--CALL     2081--CALL
      2088--CALL     2098--CALL     2107--CALL     2122--CALL     2124--CALL     2132--CALL     2138--CALL
      2162--CALL
RCNSN
      1366**DCL      1162--DCLINIT  1278--DCLINIT
RCNSN.SN
      1368**DCL      1764<<ASSIGN
READFD
      1392**DCL      1776<>CALL     1805<>CALL     1923<>CALL     2154<>CALL     2178<>CALL     2215<>CALL
      2233<>CALL     2256<>CALL
READFD.STATION_
      1395**DCL      1396--REDEF
READFD.V
      1396**DCL      1392--DCLINIT
READFD.V.DVBYTE.REREAD#
      1407**DCL      1407--REDEF
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:167  
READFD.V.INDX#
      1405**DCL      1405--REDEF
RELDIR IN PROCEDURE GPDIST
      2224**ENTRY    1829--CALL     1831--CALL     1948--CALL
RETALT
      2144**LABEL    1776--CALLALT  1794--CALLALT  1805--CALLALT  1854--CALLALT  1868--CALLALT  1890--CALLALT
      1915--CALLALT  1942--CALLALT  1953--GOTO
RLDIR IN PROCEDURE GPDIST
      2220**LABEL    2260--GOTO
S IN PROCEDURE DECOUT
      2296**DCL      2286--PROC     2299>>CALLBLT  2300>>CALLBLT  2300>>CALLBLT  2302--ENTRY    2305--ENTRY
      2314>>CALLBLT
SBITALT IN PROCEDURE DECOUT
      2375**LABEL    2372--CALLALT
SETBIT IN PROCEDURE DECOUT
      2326**ENTRY    1806--CALL     1816--CALL     1824--CALL     1827--CALL     1854--CALL     1868--CALL
      1890--CALL     1915--CALL     1942--CALL     2245--CALL
SETMAX
      1657**DCL      1777<<ASSIGN   1779<<ASSIGN   1779>>ASSIGN   1780>>ASSIGN   1792>>ASSIGN   1863>>IF
      1863>>ASSIGN   2039>>IF       2108>>ASSIGN   2133>>IF       2137<>CALL     2250>>ASSIGN   2273>>IF
      2329>>IF
SETTIME IN PROCEDURE GPDIST
      2213**ENTRY    1770--CALL     2046--CALL
SGRANS
      1632**DCL      1789<<ASSIGN   1801<<ASSIGN   1817<<ASSIGN   1817>>ASSIGN   1855<<ASSIGN   1855>>ASSIGN
      1895<<ASSIGN   1895>>ASSIGN   2017<<ASSIGN   2017>>ASSIGN   2108<<ASSIGN   2108>>ASSIGN   2131<<ASSIGN
      2131>>ASSIGN   2136<>CALL     2251<<ASSIGN   2251>>ASSIGN   2336<<ASSIGN   2336>>ASSIGN
SHR_GAC
      1673**DCL      1765<<ASSIGN   1766<<ASSIGN   1847>>IF       1952<<ASSIGN   2142>>IF       2152>>IF
SPARE
      1637**DCL      1987>>ASSIGN   2009>>ASSIGN
SPTXTS
      1678**DCL      2347>>ASSIGN
T IN PROCEDURE DECOUT
      2292**DCL      2286--PROC     2293--REDEF    2299<<CALLBLT  2300<<CALLBLT  2300>>CALLBLT  2302--ENTRY
      2305--ENTRY    2314<<CALLBLT  2317--ENTRY
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:168  
TN.N IN PROCEDURE DECOUT
      2294**DCL      2319>>IF
UPD04
      1278**DCL      2221<>CALL
UPD04.ACSVEH_
      1280**DCL      1281--REDEF
UPD04.ALTKEYS_
      1286**DCL      1287--REDEF    1287--REDEF
UPD04.HDR_
      1285**DCL      1286--REDEF
UPD04.TAB_
      1284**DCL      1285--REDEF
UPD04.UHL_
      1278**DCL      1279--REDEF    1279--REDEF
UPD04.V
      1287**DCL      1278--DCLINIT
UPD04.V.FSN#
      1318**DCL      1318--REDEF    1318--REDEF
UPD04.WSN_
      1284**DCL      1284--REDEF
V IN PROCEDURE DECOUT
      2298**DCL      2286--PROC     2299>>CALLBLT  2302--ENTRY    2303>>ASSIGN   2305--ENTRY    2306>>ASSIGN
VIDBUF
      1018**DCL      1024--REDEF    1027--REDEF    1030--REDEF
VIDBUF.DGT.FGRAN
      1020**DCL      1810>>ASSIGN
VIDBUF.DGT.LGRAN
      1020**DCL      1812>>DOWHILE
VIDBUF.DTT
      1020**DCL      1020--REDEF    1811>>IF
VIDBUF.PSN
      1018**DCL      1829>>IF
VIDBUF.SECTSTRT
      1019**DCL      1808>>ASSIGN
VIDBUF.SNLIST.SIZE
      1021**DCL      1779>>ASSIGN   1814>>IF
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:169  
VIDBUF.SNLIST.VSN.S
      1021**DCL      1807>>IF       1808>>ASSIGN
VIDBUF.VOLCNT
      1018**DCL      1778>>DOINDEX  1801>>ASSIGN   1804>>DOINDEX
VOLBUF
      1717**DCL      1681--DCLINIT  2128<>CALL     2129<>CALL     2130<>CALL     2136<>CALL     2137<>CALL
VOLBUF.TX
      1719**DCL      2135<<ASSIGN
VOLGRAN
      1669**DCL      1990<<ASSIGN   2027<<ASSIGN   2027>>ASSIGN   2129<>CALL     2131>>ASSIGN   2176<<ASSIGN
      2183--ASSIGN   2184<<ASSIGN   2184>>ASSIGN   2194--ASSIGN   2195<<ASSIGN   2195>>ASSIGN
VOLH
      1712**DCL      1681--DCLINIT
VXH
      1036**DCL      1985<<ASSIGN   2007<<ASSIGN
VXH.N
      1036**DCL      2005<<ASSIGN
VXH.P
      1036**DCL      2010<<ASSIGN
VXH.VOL
      1036**DCL      1986<<ASSIGN   2008<<ASSIGN   2183>>ASSIGN   2194>>ASSIGN
VXH.XTN
      1036**DCL      2038<<ASSIGN
VXH.XTN.ADR
      1036**DCL      2002<<ASSIGN   2026>>ASSIGN   2186>>ASSIGN
VXH.XTN.EADR
      1036**DCL      2004<<ASSIGN   2025<<ASSIGN   2026>>ASSIGN   2186>>ASSIGN
VXH.XTNS
      1036**DCL      1987<<ASSIGN   2003>>IF       2009<<ASSIGN   2037<<ASSIGN   2182>>IF       2185>>DOINDEX
      2196>>ASSIGN   2268>>ASSIGN
WRD IN PROCEDURE GPDIST
      2170**DCL      2220<<ASSIGN
WRITEFD
      1435**DCL      2383<>CALL
WRITEFD.STATION_
      1437**DCL      1437--REDEF
PL6.E3A0      #001=FXH$RECON File=FXH$RECON.:E05TSI                              TUE 07/29/97 18:06 Page:170  
WRITEFD.V
      1438**DCL      1435--DCLINIT
WRITEFD.V.DVBYTE.VFC#
      1444**DCL      1444--REDEF
WRITEGP IN PROCEDURE GPDIST
      2267**ENTRY    2006--CALL     2040--CALL     2044--CALL
XTN$
      1656**DCL       986--IMP-PTR   990--IMP-PTR   999--IMP-PTR  1007--IMP-PTR  1036--IMP-PTR  1851<<ASSIGN
      1852>>IF       1859>>ASSIGN   1860>>ASSIGN   1862>>ASSIGN   1874>>IF       1874>>IF       1875>>IF
      1875>>ASSIGN   1876>>ASSIGN   1876>>ASSIGN   1925>>ASSIGN   1925>>ASSIGN   1929>>CALL     1982<<ASSIGN
      1985>>ASSIGN   1986>>ASSIGN   1987>>ASSIGN   1987>>ASSIGN   2002>>ASSIGN   2003>>IF       2004>>ASSIGN
      2005>>ASSIGN   2007>>ASSIGN   2008>>ASSIGN   2009>>ASSIGN   2010>>ASSIGN   2025>>ASSIGN   2026>>ASSIGN
      2026>>ASSIGN   2037>>ASSIGN   2038>>ASSIGN   2046>>CALL     2046>>CALL     2054<<ASSIGN   2056>>DOWHILE
      2105<<ASSIGN   2180<<ASSIGN   2181>>DOWHILE  2182>>IF       2182>>IF       2183>>ASSIGN   2185>>DOINDEX
      2186>>ASSIGN   2186>>ASSIGN   2194>>ASSIGN   2196<<ASSIGN   2196>>ASSIGN   2196>>ASSIGN   2198<<ASSIGN
      2220>>ASSIGN   2237>>IF       2237>>ASSIGN   2239>>ASSIGN   2268>>ASSIGN   2268>>ASSIGN   2282<<ASSIGN
      2320<<ASSIGN
XTNDIST.NEWC
      1672**DCL      1786>>ASSIGN   1977>>ASSIGN   1978<<ASSIGN   2032<<ASSIGN   2032>>ASSIGN   2111>>DOWHILE
      2118<>CALL     2175<<ASSIGN   2192<<ASSIGN   2192>>ASSIGN
XTNDIST.OLDC
      1671**DCL      1786<<ASSIGN   1977<<ASSIGN   2111>>DOWHILE  2116<>CALL
XTNSIZE
      1661**DCL      1813<<ASSIGN   1814>>IF       1815>>ASSIGN   1860<<ASSIGN   1861>>IF       1862<<ASSIGN
      1863>>IF       1863<<ASSIGN   1866>>ASSIGN   1867>>DOWHILE  1869<<ASSIGN   1869>>ASSIGN   1980<<ASSIGN
      2000>>IF       2015>>IF       2016<<ASSIGN   2275>>ASSIGN   2276>>ASSIGN   2277<<ASSIGN
