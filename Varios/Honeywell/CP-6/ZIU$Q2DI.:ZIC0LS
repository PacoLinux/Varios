
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:1    
        1        1        /*M*         ZIU$Q2DI       I-D-S/II      UTILITY DIRECTIVE PARSER*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME: ZIU$Q2DI
        9        9        PURPOSE: PARSER AND SET SWITCHES ACCORDING TO OPTIONS SPECIFIED IN
       10       10                  THE DIRECTIVE
       11       11        *************************************************************************/
       12       12        ZIU$Q2DI: PROC ALTRET;
       13       13
       14       14    1   DCL SYN_ERR CHAR(0) CONSTANT INIT('SYNTAX ERROR');
       15       15    1   DCL NULL_ROOT CHAR(0) CONSTANT INIT('MISSING TREE');
       16       16    1   DCL BAD_NODE CHAR(0) CONSTANT INIT('ILLEGAL NODE');
       17       17    1   DCL OVER_FLOW CHAR(0) CONSTANT INIT('OVERFLOW');
       18       18    1   DCL SMALL_WORK CHAR(0) CONSTANT INIT('INSUFFICIENT WORK AREA');
       19       19    1   DCL NULL_U$$ CHAR(0) CONSTANT INIT('MISSING U$$ ROUTINE');
       20       20    1   DCL UNKN_ERR CHAR(0) CONSTANT INIT('UNKNOWN ERR..HOLDING');
       21       21    1   DCL INTERPRTR_ERR CHAR(0) CONSTANT INIT('INTERPRTR     ERROR');
       22       22    1   DCL FLAG CHAR(0) STATIC INIT('FALSE');
       23       23    1   DCL RBUF CHAR(256) SYMREF CALIGNED;
       24       24    1   DCL PLACE_BUF (0:131) CHAR(1) STATIC INIT(' '*132);
       25       25    1   DCL PLACE_OUT REDEF PLACE_BUF CHAR(132);
       26       26    1   DCL PLACE_INDX SBIN(36) STATIC ;
       27       27    1   DCL INDX_PTR$ PTR STATIC;
       28       28    1   DCL WRITE_BUF CHAR(PLACE_INDX) BASED(INDX_PTR$);
       29       29    1   DCL READ_SW UBIN(36) SYMREF;
       30       30    1   DCL WK(0:1023) SBIN(36) STATIC ALIGNED;
       31       31    1   DCL PPG# UBIN(36) SYMREF;
       32       32    1   DCL 1 EX_RPT_HDR SYMREF,
       33       33    1         2 * BIT(9) UNAL,
       34       34    1         2 * CHAR(60) UNAL,
       35       35    1         2 HDR_DATE CHAR(8) UNAL,
       36       36    1         2 * CHAR(6) UNAL,
       37       37    1         2 PG# CHAR(4) UNAL,
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:2    
       38       38    1         2 * CHAR(53) UNAL;
       39       39    1   DCL DIR_PRNT CHAR(132) SYMREF;
       40       40    1   DCL 1 ERR_BUFF STATIC,
       41       41    1         2 * CHAR(6) UNAL INIT('* * * '),
       42       42    1         2 TEXT CHAR(126) UNAL;
       43       43    1   DCL 1 PRMPT_CHAR STATIC SYMDEF,
       44       44    1         2 CAR_CTL BIT(9) INIT('001110000'B) UNAL,
       45       45    1         2 PMPT CHAR(1) INIT('-') UNAL;
       46       46    1   DCL SYS_FUNC_DATE ENTRY ALTRET;
       47       47    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       48       48    1   DCL SYS_FUNC_CORRES ENTRY(2) ALTRET;
       49       49    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       50       50
       51       51    1   DCL SI_DCB UBIN HALF SYMREF;
       52       52    1   DCL LO_DCB UBIN HALF SYMREF;
       53       53    1   DCL UC_DCB UBIN HALF SYMREF;
       54       54    1   DCL M$SI DCB;
       55       55    1   DCL CCBUF_ON BIT(1) UNAL SYMREF;
       56       56
       57       57         %INCLUDE XU_MACRO_C;
       58     3163         %INCLUDE XU_PERR_C;
       59     3354         %INCLUDE CP_6;
       60     3435         %INCLUDE B$JIT;
       61     3725         %INCLUDE CP_6_SUBS;
       62     4265        %INCLUDE ZI_GLOBAL_DBUTIL;
       63     4443         %SYS_FUNC;
       64     4535         %MISC_DCLS;
       65     4588         %P_PCB(NAME=PCB,T=RBUF,R=UTIL_CMD,W=WK,WSZ=1024);
       66     4787         %F$DCB(DCBN=F$DCB);
       67     4844         %PARSE$OUT(STCLASS=BASED);
       68     4889         %FPT_PROMPT(PROMPT=PRMPT_CHAR,VFC=YES,DCB=M$UC);
       69     4917        %INCLUDE ZI$DIR;
       70     5074         %DIR;
       71     5218         %DIR(STCLASS=CONSTANT,DIRNAME=ZI_DIR); /* GEN A CONSTANT COPY */
       72     5362
       73     5363    1   DCL X$PARSE ENTRY(1) ALTRET;
       74     5364    1   DCL INTERPRTR ENTRY(1) ALTRET;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:3    
       75     5365        /* Dcl sucfail ENTRY(1); */
       76     5366    1   DCL UTIL_CMD UBIN SYMREF; /*Root of the command syntax tree*/
       77     5367    1   DCL READDIR ENTRY ALTRET; /*   Proc to read in the directive*/
       78     5368    1   DCL PRINT_HDR BIT(1) UNAL SYMREF;
       79     5369    1   DCL BLANK BIT(9) SYMREF;
       80     5370        %EJECT;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:4    
       81     5371
       82     5372    1   READ:
       83     5373    1       ICNT=-1;
       84     5374    1       KCNT=-1;
       85     5375    1       RCNT=-1;
       86     5376    1       ITMCNT = -1;
       87     5377    1       ACNT_IDX = -1;
       88     5378    1       ZI$DIR = ZI_DIR; /* INITIAL ZI$DIR TABLE */
       89     5379    1       IF B$JIT.CCARS ~= B$JIT.CCDISP THEN
       90     5380    2       DO;
       91     5381    2           CCBUF_ON = %YES#;
       92     5382    2           RBUF = SUBSTR(B$JIT.CCBUF,B$JIT.CCDISP+1,
       93     5383    2              B$JIT.CCARS-B$JIT.CCDISP-2);
       94     5384    2           CNT = B$JIT.CCARS - B$JIT.CCDISP -1;
       95     5385    2           END;
       96     5386    2       ELSE DO;
       97     5387    2           CCBUF_ON = %NO#;
       98     5388    2           CALL M$PROMPT(FPT_PROMPT);
       99     5389    2           CALL READDIR ALTRET(ALT_ZIU$Q2DI);
      100     5390    2           END;
      101     5391    1   /**/ BUFLNSF = 0;
      102     5392    1   /**/ DCBSF = DCBNUM(M$LO);
      103     5393    1   /**/ VFCSF = %NO#;
      104     5394    1       CALL SYS_FUNC_WRIT; /* line feeed one space */
      105     5395    1       PCB.NCHARS=CNT; /*Character count for parser*/
      106     5396    1       CALL X$PARSE(PCB) ALTRET(PARSERR); /*Call sys parser*/
      107     5397
      108     5398    1       CALL INTERPRTR(PCB.OUT$->OUT$BLK) ALTRET(TEST_ERR);
      109     5399    1       RETURN;
      110     5400
      111     5401    1   PARSERR:
      112     5402    1       STEPCC = 4;
      113     5403    1       DCBSF=DCBNUM(M$LO);
      114     5404    2       DO CASE(PCB.ERROR.CODE);
      115     5405    2       CASE(%E$SYNERR);
      116     5406    2           ERR_BUFF.TEXT = SYN_ERR;
      117     5407    2       CASE(%E$NULLROOT);
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:5    
      118     5408    2           ERR_BUFF.TEXT = NULL_ROOT;
      119     5409    2       CASE(%E$BADNODE);
      120     5410    2           ERR_BUFF.TEXT = BAD_NODE;
      121     5411    2       CASE(%E$WKOVERFLOW);
      122     5412    2           ERR_BUFF.TEXT = OVER_FLOW;
      123     5413    2       CASE(%E$SMALLWORK);
      124     5414    2           ERR_BUFF.TEXT=SMALL_WORK;
      125     5415    2       CASE(%E$NULLU$$);
      126     5416    2           ERR_BUFF.TEXT = NULL_U$$;
      127     5417    2       CASE(ELSE);
      128     5418    2           ERR_BUFF.TEXT = UNKN_ERR;
      129     5419    2           END;
      130     5420        /*
      131     5421           Print header only if source in is from a file or list out
      132     5422           is to a file.
      133     5423        */
      134     5424    1       IF PRINT_HDR THEN
      135     5425    2       DO;
      136     5426    2    /**/   DATESF=VECTOR(EX_RPT_HDR.HDR_DATE);
      137     5427    2    /**/   UTSSF = VECTOR(NIL);
      138     5428    2    /**/   SOURCESF = %CLOCK#;
      139     5429    2    /**/   DESTSF = %LOCAL#;
      140     5430    2           CALL SYS_FUNC_DATE;
      141     5431    2           PPG#=PPG#+1;
      142     5432    2           CALL BINCHAR(EX_RPT_HDR.PG#,PPG#);
      143     5433    2    /**/   DCBSF = DCBNUM(M$LO);
      144     5434    2    /**/   BUFSF = VECTOR(EX_RPT_HDR);
      145     5435    2    /**/   BUFLNSF = 82;
      146     5436    2           CALL SYS_FUNC_WRIT;
      147     5437    2           END;
      148     5438    1   /**/ BUFSF = VECTOR(DIR_PRNT);
      149     5439    1   /**/ VFCSF= %YES#;
      150     5440    1   /**/ BUFLNSF = 40;
      151     5441    1       CALL SYS_FUNC_WRIT;
      152     5442    1   /**/ BUFSF = VECTOR(RBUF);
      153     5443    1   /**/ BUFLNSF = 256;
      154     5444    1   /**/ VFCSF = %NO#;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:6    
      155     5445    1       CALL SYS_FUNC_WRIT;
      156     5446    1       IF PCB.HI_CHAR = 0 THEN
      157     5447    1           PLACE_INDX = 0;
      158     5448    1       ELSE IF PCB.HI_CHAR > 131 THEN
      159     5449    1               PLACE_INDX = PCB.NCHARS - PCB.HI_CHAR - 1;
      160     5450    1           ELSE
      161     5451    1               PLACE_INDX=PCB.HI_CHAR - 1; /* Set error position indicator */
      162     5452         /* And set fpt parameters */
      163     5453    1       PLACE_BUF(PLACE_INDX)='^';
      164     5454
      165     5455    1       INDX_PTR$=ADDR(PLACE_OUT);
      166     5456    1   /**/ BUFSF = VECTOR(PLACE_OUT);
      167     5457    1   /**/ VFCSF =%NO#;
      168     5458    1   /**/ BUFLNSF = PLACE_INDX + 1;
      169     5459    1       CALL SYS_FUNC_WRIT;
      170     5460    1       PLACE_OUT = ' '; /* Blank out error indicator for reuse */
      171     5461    1   /**/ BUFSF = VECTOR(ERR_BUFF);
      172     5462    1   /**/ BUFLNSF = 132;
      173     5463    1   /**/ VFCSF = %NO#;
      174     5464    1       CALL SYS_FUNC_WRIT; /* Write parse error */
      175     5465    1       PLACE_OUT = '     Type HELP for help.';
      176     5466    1   /**/ BUFSF = VECTOR(PLACE_OUT);
      177     5467    1   /**/ VFCSF = %NO#;
      178     5468    1   /**/ CALL SYS_FUNC_WRIT;
      179     5469    1       PLACE_OUT = '  ';
      180     5470    1   CHK_CCBUF: IF CCBUF_ON THEN /* NO MORE INPUT, SIMULATE A 'END' */
      181     5471    2       DO;
      182     5472    2           READ_SW = 3;
      183     5473    2           RETURN;
      184     5474    2           END;
      185     5475    1       GOTO READ; /* TAKE ANOTHER DIRECTIVE */
      186     5476
      187     5477    1   TEST_ERR: ;
      188     5478        /*
      189     5479           Print header only if source in is from a file or list out
      190     5480           is to a file.
      191     5481        */
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:7    
      192     5482    1       IF PRINT_HDR THEN
      193     5483    2       DO;
      194     5484    2    /**/   DATESF=VECTOR(EX_RPT_HDR.HDR_DATE);
      195     5485    2    /**/   UTSSF = VECTOR(NIL);
      196     5486    2    /**/   SOURCESF = %CLOCK#;
      197     5487    2    /**/   DESTSF = %LOCAL#;
      198     5488    2           CALL SYS_FUNC_DATE;
      199     5489    2           PPG#=PPG#+1;
      200     5490    2           CALL BINCHAR(EX_RPT_HDR.PG#,PPG#);
      201     5491    2    /**/   DCBSF=DCBNUM(M$LO);
      202     5492    2    /**/   BUFSF = VECTOR(EX_RPT_HDR);
      203     5493    2    /**/   BUFLNSF = 82;
      204     5494    2    /**/   VFCSF =%NO#;
      205     5495    2           CALL SYS_FUNC_WRIT;
      206     5496    2           END;
      207     5497    1   /**/ BUFSF = VECTOR(DIR_PRNT);
      208     5498    1   /**/ VFCSF= %YES#;
      209     5499    1   /**/ BUFLNSF = 20;
      210     5500    1       CALL SYS_FUNC_WRIT;
      211     5501    1   /**/ BUFSF = VECTOR(RBUF);
      212     5502    1   /**/ BUFLNSF = 256;
      213     5503    1   /**/ VFCSF = %NO#;
      214     5504    1       CALL SYS_FUNC_WRIT;
      215     5505    1       SUBMESSF = %YES#;
      216     5506    1       CALL SYS_FUNC_ERRMSG; /* Parameters were set by interprtr */
      217     5507    1       GOTO CHK_CCBUF;
      218     5508
      219     5509    1   ALT_ZIU$Q2DI:
      220     5510    1       IF READ_SW = 2 THEN
      221     5511    2       DO;
      222     5512    2           ERR_BUFF.TEXT = 'COMMAND TO LARGE - UNABLE TO CONCATENATE ';
      223     5513    2           RETURN;
      224     5514    2           END;
      225     5515    1       ELSE
      226     5516    1           IF READ_SW = 1 THEN ALTRETURN; /* Eof */
      227     5517    1   /**/ DCBSF=DCBNUM(M$LO);
      228     5518    1   /**/ BUFSF = VECTOR(ERR_BUFF);
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:8    
      229     5519    1   /**/ BUFLNSF = 132;
      230     5520    1   /**/ VFCSF = %NO#;
      231     5521    1       CALL SYS_FUNC_WRIT;
      232     5522    1       ALTRETURN;
      233     5523
      234     5524    1   END ZIU$Q2DI;
      235     5525        %EOD;

PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:9    
--  Include file information  --

   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   XU_PERR_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$Q2DI.

   Procedure ZIU$Q2DI requires 309 words for executable code.
   Procedure ZIU$Q2DI requires 6 words of local(AUTO) storage.

PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:10   

 Object Unit name= ZIU$Q2DI                                   File name= ZIU$Q2DI.:ZIC0TOU
 UTS= SEP 05 '97 13:20:32.48 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    232    350  ZIU$Q2DI
    1   Data  even  none  1120   2140  ZIU$Q2DI
    2   DCB   even  none     0      0  M$SI
    3   DCB   even  none     0      0  M$UC
    4   DCB   even  none     0      0  M$LO
    5   Proc  even  none   309    465  ZIU$Q2DI
    6  RoData even  none    22     26  ZIU$Q2DI

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        0  ZIU$Q2DI

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1   2106  PRMPT_CHAR                         1   2107  PCB
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:11   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 SYS_FUNC_DATE
 yes     yes           Std       0 READDIR
 yes     yes           Std       0 SYS_FUNC_WRIT
 yes     yes           Std       1 INTERPRTR
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       0 SYS_FUNC_ERRMSG
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RBUF                                  READ_SW                               PPG#
     EX_RPT_HDR                            DIR_PRNT                              SI_DCB
     LO_DCB                                UC_DCB                                M$SI
     CCBUF_ON                              M$UC                                  BLKLSF
     KEYLSF                                KEYXSF                                DCBSF
     ORGSF                                 KEYSF                                 KEYVSF
     ACSSF                                 NOTIMESF                              FUNSF
     ASNSF                                 TESTSF                                XTENSIZESF
     DISPSF                                WAITSF                                VFCSF
     FULLSF                                BKUPSF                                BUFLNSF
     BUFSF                                 SOURCESF                              DESTSF
     DATESF                                TIMESF                                UTSSF
     DAYSF                                 TSTAMPSF                              ENCRP_SEEDSF
     ERRCODESF                             MSGCODE                               INCL_ERR
     ERR_INSERT                            FIDSF_RD                              ACNT
     EXISTSF                               SHARESF                               DCBNMSF
     KEYRSF                                NO_KEYSF                              REASGNSF
     CARRY_ATTRIBUTESF                     SUBMESSF                              SPKY_OPNSF
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:12   
     POSSF                                 ERRFLGSF                              MERGESF
     FSA_FLAG                              RELGSF                                UNUSED
     HELPCODE                              COUNTSF                               INDEXSF
     GAP                                   PSNSF                                 ACNTSF
     KEY_SHADWSF                           REC$                                  RB
     RE                                    IE                                    IB
     CNT                                   ICNT                                  RCNT
     SCNT                                  FIRST_SET                             RETCNT
     DMPCNT                                KCNT                                  ACNT_IDX
     I                                     J                                     K
     X                                     STEPCC                                I_O_BUF$
     OUT_INDX                              I_O_SIZE                              REC_DATA_LN
     M$LO                                  B$TCB$                                B$ROS$
     B$JIT$                                KEYFID                                I_O_KEY
     RESTART                               BREAK_FLAG                            ICHKSUM
     ITMCNT                                GAP1                                  ZI$DIR
     SCHEMA_ACTIVE                         RECORD_LIST                           SET_LIST
     RETAIN_LIST                           DUMP_FID                              ALTKY
     INIT_RG                               KEY_RNG                               ITEM_LIST
     UTIL_CMD                              PRINT_HDR                             BLANK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:13   


        1        1        /*M*         ZIU$Q2DI       I-D-S/II      UTILITY DIRECTIVE PARSER*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME: ZIU$Q2DI
        9        9        PURPOSE: PARSER AND SET SWITCHES ACCORDING TO OPTIONS SPECIFIED IN
       10       10                  THE DIRECTIVE
       11       11        *************************************************************************/
       12       12        ZIU$Q2DI: PROC ALTRET;

     12  5 000000   000000 700200 xent  ZIU$Q2DI     TSX0  ! X66_AUTO_0
         5 000001   000006 000000                    ZERO    6,0

       13       13
       14       14    1   DCL SYN_ERR CHAR(0) CONSTANT INIT('SYNTAX ERROR');
       15       15    1   DCL NULL_ROOT CHAR(0) CONSTANT INIT('MISSING TREE');
       16       16    1   DCL BAD_NODE CHAR(0) CONSTANT INIT('ILLEGAL NODE');
       17       17    1   DCL OVER_FLOW CHAR(0) CONSTANT INIT('OVERFLOW');
       18       18    1   DCL SMALL_WORK CHAR(0) CONSTANT INIT('INSUFFICIENT WORK AREA');
       19       19    1   DCL NULL_U$$ CHAR(0) CONSTANT INIT('MISSING U$$ ROUTINE');
       20       20    1   DCL UNKN_ERR CHAR(0) CONSTANT INIT('UNKNOWN ERR..HOLDING');
       21       21    1   DCL INTERPRTR_ERR CHAR(0) CONSTANT INIT('INTERPRTR     ERROR');
       22       22    1   DCL FLAG CHAR(0) STATIC INIT('FALSE');
       23       23    1   DCL RBUF CHAR(256) SYMREF CALIGNED;
       24       24    1   DCL PLACE_BUF (0:131) CHAR(1) STATIC INIT(' '*132);
       25       25    1   DCL PLACE_OUT REDEF PLACE_BUF CHAR(132);
       26       26    1   DCL PLACE_INDX SBIN(36) STATIC ;
       27       27    1   DCL INDX_PTR$ PTR STATIC;
       28       28    1   DCL WRITE_BUF CHAR(PLACE_INDX) BASED(INDX_PTR$);
       29       29    1   DCL READ_SW UBIN(36) SYMREF;
       30       30    1   DCL WK(0:1023) SBIN(36) STATIC ALIGNED;
       31       31    1   DCL PPG# UBIN(36) SYMREF;
       32       32    1   DCL 1 EX_RPT_HDR SYMREF,
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:14   
       33       33    1         2 * BIT(9) UNAL,
       34       34    1         2 * CHAR(60) UNAL,
       35       35    1         2 HDR_DATE CHAR(8) UNAL,
       36       36    1         2 * CHAR(6) UNAL,
       37       37    1         2 PG# CHAR(4) UNAL,
       38       38    1         2 * CHAR(53) UNAL;
       39       39    1   DCL DIR_PRNT CHAR(132) SYMREF;
       40       40    1   DCL 1 ERR_BUFF STATIC,
       41       41    1         2 * CHAR(6) UNAL INIT('* * * '),
       42       42    1         2 TEXT CHAR(126) UNAL;
       43       43    1   DCL 1 PRMPT_CHAR STATIC SYMDEF,
       44       44    1         2 CAR_CTL BIT(9) INIT('001110000'B) UNAL,
       45       45    1         2 PMPT CHAR(1) INIT('-') UNAL;
       46       46    1   DCL SYS_FUNC_DATE ENTRY ALTRET;
       47       47    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       48       48    1   DCL SYS_FUNC_CORRES ENTRY(2) ALTRET;
       49       49    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       50       50
       51       51    1   DCL SI_DCB UBIN HALF SYMREF;
       52       52    1   DCL LO_DCB UBIN HALF SYMREF;
       53       53    1   DCL UC_DCB UBIN HALF SYMREF;
       54       54    1   DCL M$SI DCB;
       55       55    1   DCL CCBUF_ON BIT(1) UNAL SYMREF;
       56       56
       57       57         %INCLUDE XU_MACRO_C;
       58     3163         %INCLUDE XU_PERR_C;
       59     3354         %INCLUDE CP_6;
       60     3435         %INCLUDE B$JIT;
       61     3725         %INCLUDE CP_6_SUBS;
       62     4265        %INCLUDE ZI_GLOBAL_DBUTIL;
       63     4443         %SYS_FUNC;
       64     4535         %MISC_DCLS;
       65     4588         %P_PCB(NAME=PCB,T=RBUF,R=UTIL_CMD,W=WK,WSZ=1024);
       66     4787         %F$DCB(DCBN=F$DCB);
       67     4844         %PARSE$OUT(STCLASS=BASED);
       68     4889         %FPT_PROMPT(PROMPT=PRMPT_CHAR,VFC=YES,DCB=M$UC);
       69     4917        %INCLUDE ZI$DIR;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:15   
       70     5074         %DIR;
       71     5218         %DIR(STCLASS=CONSTANT,DIRNAME=ZI_DIR); /* GEN A CONSTANT COPY */
       72     5362
       73     5363    1   DCL X$PARSE ENTRY(1) ALTRET;
       74     5364    1   DCL INTERPRTR ENTRY(1) ALTRET;
       75     5365        /* Dcl sucfail ENTRY(1); */
       76     5366    1   DCL UTIL_CMD UBIN SYMREF; /*Root of the command syntax tree*/
       77     5367    1   DCL READDIR ENTRY ALTRET; /*   Proc to read in the directive*/
       78     5368    1   DCL PRINT_HDR BIT(1) UNAL SYMREF;
       79     5369    1   DCL BLANK BIT(9) SYMREF;
       80     5370        %EJECT;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:16   
       81     5371
       82     5372    1   READ:
       83     5373    1       ICNT=-1;

   5373  5 000002   000001 335007       READ         LCA     1,DL
         5 000003   000000 755000 xsym               STA     ICNT

       84     5374    1       KCNT=-1;

   5374  5 000004   000000 755000 xsym               STA     KCNT

       85     5375    1       RCNT=-1;

   5375  5 000005   000000 755000 xsym               STA     RCNT

       86     5376    1       ITMCNT = -1;

   5376  5 000006   000000 755000 xsym               STA     ITMCNT

       87     5377    1       ACNT_IDX = -1;

   5377  5 000007   000000 755000 xsym               STA     ACNT_IDX

       88     5378    1       ZI$DIR = ZI_DIR; /* INITIAL ZI$DIR TABLE */

   5378  5 000010   000000 100400                    MLR     fill='000'O
         5 000011   000040 001334 0                  ADSC9   ZI_DIR                   cn=0,n=732
         5 000012   000000 001334 xsym               ADSC9   ZI$DIR                   cn=0,n=732

       89     5379    1       IF B$JIT.CCARS ~= B$JIT.CCDISP THEN

   5379  5 000013   000000 470400 xsym               LDP0    B$JIT$
         5 000014   000032 720100                    LXL0    26,,PR0
         5 000015   000032 100100                    CMPX0   26,,PR0
         5 000016   000053 600000 5                  TZE     s:5387

       90     5380    2       DO;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:17   

       91     5381    2           CCBUF_ON = %YES#;

   5381  5 000017   400000 236003                    LDQ     -131072,DU
         5 000020   000000 756000 xsym               STQ     CCBUF_ON

       92     5382    2           RBUF = SUBSTR(B$JIT.CCBUF,B$JIT.CCDISP+1,

   5382  5 000021   000032 236100                    LDQ     26,,PR0
         5 000022   000022 736000                    QLS     18
         5 000023   000022 732000                    QRS     18
         5 000024   200004 756100                    STQ     4,,AUTO
         5 000025   000032 236100                    LDQ     26,,PR0
         5 000026   000022 732000                    QRS     18
         5 000027   200004 136100                    SBLQ    4,,AUTO
         5 000030   200005 756100                    STQ     5,,AUTO
         5 000031   000032 236100                    LDQ     26,,PR0
         5 000032   000022 736000                    QLS     18
         5 000033   000022 732000                    QRS     18
         5 000034   200005 721100                    LXL1    5,,AUTO
         5 000035   777776 622011                    EAX2    -2,X1
         5 000036   040000 100546                    MLR     fill='040'O
         5 000037   000033 200012                    ADSC9   27,Q,PR0                 cn=1,n=*X2
         5 000040   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256

       93     5383    2              B$JIT.CCARS-B$JIT.CCDISP-2);
       94     5384    2           CNT = B$JIT.CCARS - B$JIT.CCDISP -1;

   5384  5 000041   000032 236100                    LDQ     26,,PR0
         5 000042   000022 736000                    QLS     18
         5 000043   000022 732000                    QRS     18
         5 000044   200004 756100                    STQ     4,,AUTO
         5 000045   000032 236100                    LDQ     26,,PR0
         5 000046   000022 732000                    QRS     18
         5 000047   200004 136100                    SBLQ    4,,AUTO
         5 000050   000001 136007                    SBLQ    1,DL
         5 000051   000000 756000 xsym               STQ     CNT
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:18   

       95     5385    2           END;

   5385  5 000052   000062 710000 5                  TRA     s:5391

       96     5386    2       ELSE DO;

       97     5387    2           CCBUF_ON = %NO#;

   5387  5 000053   000000 450000 xsym               STZ     CCBUF_ON

       98     5388    2           CALL M$PROMPT(FPT_PROMPT);

   5388  5 000054   002126 630400 1                  EPPR0   FPT_PROMPT
         5 000055   160002 713400                    CLIMB   57346
         5 000056   401000 401760                    pmme    nvectors=3

       99     5389    2           CALL READDIR ALTRET(ALT_ZIU$Q2DI);

   5389  5 000057   000000 631400 6                  EPPR1   0
         5 000060   000000 701000 xent               TSX1    READDIR
         5 000061   000436 702000 5                  TSX2    ALT_ZIU$Q2DI

      100     5390    2           END;

      101     5391    1   /**/ BUFLNSF = 0;

   5391  5 000062   000000 450000 xsym               STZ     BUFLNSF

      102     5392    1   /**/ DCBSF = DCBNUM(M$LO);

   5392  5 000063   000000 236007 xsym               LDQ     M$LO,DL
         5 000064   000000 620006                    EAX0    0,QL
         5 000065   000000 740000 xsym               STX0    DCBSF

      103     5393    1   /**/ VFCSF = %NO#;

PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:19   
   5393  5 000066   000000 450000 xsym               STZ     VFCSF

      104     5394    1       CALL SYS_FUNC_WRIT; /* line feeed one space */

   5394  5 000067   000000 631400 6                  EPPR1   0
         5 000070   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000071   000000 011000                    NOP     0

      105     5395    1       PCB.NCHARS=CNT; /*Character count for parser*/

   5395  5 000072   000000 235000 xsym               LDA     CNT
         5 000073   002120 755000 1                  STA     PCB+9

      106     5396    1       CALL X$PARSE(PCB) ALTRET(PARSERR); /*Call sys parser*/

   5396  5 000074   000002 630400 6                  EPPR0   2
         5 000075   000001 631400 6                  EPPR1   1
         5 000076   000000 701000 xent               TSX1    X$PARSE
         5 000077   000105 702000 5                  TSX2    PARSERR

      107     5397
      108     5398    1       CALL INTERPRTR(PCB.OUT$->OUT$BLK) ALTRET(TEST_ERR);

   5398  5 000100   002112 630400 1                  EPPR0   PCB+3
         5 000101   000001 631400 6                  EPPR1   1
         5 000102   000000 701000 xent               TSX1    INTERPRTR
         5 000103   000343 702000 5                  TSX2    TEST_ERR

      109     5399    1       RETURN;

   5399  5 000104   000000 702200 xent               TSX2  ! X66_ARET

      110     5400
      111     5401    1   PARSERR:
      112     5402    1       STEPCC = 4;

   5402  5 000105   000004 235007       PARSERR      LDA     4,DL
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:20   
         5 000106   000000 755000 xsym               STA     STEPCC

      113     5403    1       DCBSF=DCBNUM(M$LO);

   5403  5 000107   000000 236007 xsym               LDQ     M$LO,DL
         5 000110   000000 620006                    EAX0    0,QL
         5 000111   000000 740000 xsym               STX0    DCBSF

      114     5404    2       DO CASE(PCB.ERROR.CODE);

   5404  5 000112   002115 236000 1                  LDQ     PCB+6
         5 000113   000003 772000                    QRL     3
         5 000114   037777 376007                    ANQ     16383,DL
         5 000115   000010 116007                    CMPQ    8,DL
         5 000116   000120 602006 5                  TNC     s:5404+6,QL
         5 000117   000160 710000 5                  TRA     s:5418
         5 000120   000160 710000 5                  TRA     s:5418
         5 000121   000130 710000 5                  TRA     s:5406
         5 000122   000134 710000 5                  TRA     s:5408
         5 000123   000140 710000 5                  TRA     s:5410
         5 000124   000144 710000 5                  TRA     s:5412
         5 000125   000150 710000 5                  TRA     s:5414
         5 000126   000160 710000 5                  TRA     s:5418
         5 000127   000154 710000 5                  TRA     s:5416

      115     5405    2       CASE(%E$SYNERR);

      116     5406    2           ERR_BUFF.TEXT = SYN_ERR;

   5406  5 000130   040000 100400                    MLR     fill='040'O
         5 000131   000000 000014 0                  ADSC9   SYN_ERR                  cn=0,n=12
         5 000132   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126
         5 000133   000163 710000 5                  TRA     s:5424

      117     5407    2       CASE(%E$NULLROOT);

      118     5408    2           ERR_BUFF.TEXT = NULL_ROOT;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:21   

   5408  5 000134   040000 100400                    MLR     fill='040'O
         5 000135   000003 000014 0                  ADSC9   NULL_ROOT                cn=0,n=12
         5 000136   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126
         5 000137   000163 710000 5                  TRA     s:5424

      119     5409    2       CASE(%E$BADNODE);

      120     5410    2           ERR_BUFF.TEXT = BAD_NODE;

   5410  5 000140   040000 100400                    MLR     fill='040'O
         5 000141   000006 000014 0                  ADSC9   BAD_NODE                 cn=0,n=12
         5 000142   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126
         5 000143   000163 710000 5                  TRA     s:5424

      121     5411    2       CASE(%E$WKOVERFLOW);

      122     5412    2           ERR_BUFF.TEXT = OVER_FLOW;

   5412  5 000144   040000 100400                    MLR     fill='040'O
         5 000145   000011 000010 0                  ADSC9   OVER_FLOW                cn=0,n=8
         5 000146   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126
         5 000147   000163 710000 5                  TRA     s:5424

      123     5413    2       CASE(%E$SMALLWORK);

      124     5414    2           ERR_BUFF.TEXT=SMALL_WORK;

   5414  5 000150   040000 100400                    MLR     fill='040'O
         5 000151   000013 000026 0                  ADSC9   SMALL_WORK               cn=0,n=22
         5 000152   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126
         5 000153   000163 710000 5                  TRA     s:5424

      125     5415    2       CASE(%E$NULLU$$);

      126     5416    2           ERR_BUFF.TEXT = NULL_U$$;

PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:22   
   5416  5 000154   040000 100400                    MLR     fill='040'O
         5 000155   000021 000023 0                  ADSC9   NULL_U$$                 cn=0,n=19
         5 000156   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126
         5 000157   000163 710000 5                  TRA     s:5424

      127     5417    2       CASE(ELSE);

      128     5418    2           ERR_BUFF.TEXT = UNKN_ERR;

   5418  5 000160   040000 100400                    MLR     fill='040'O
         5 000161   000026 000024 0                  ADSC9   UNKN_ERR                 cn=0,n=20
         5 000162   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126

      129     5419    2           END;

      130     5420        /*
      131     5421           Print header only if source in is from a file or list out
      132     5422           is to a file.
      133     5423        */
      134     5424    1       IF PRINT_HDR THEN

   5424  5 000163   000000 234000 xsym               SZN     PRINT_HDR
         5 000164   000224 605000 5                  TPL     s:5438

      135     5425    2       DO;

      136     5426    2    /**/   DATESF=VECTOR(EX_RPT_HDR.HDR_DATE);

   5426  5 000165   000004 237000 6                  LDAQ    4
         5 000166   000000 755000 xsym               STA     DATESF
         5 000167   000001 756000 xsym               STQ     DATESF+1

      137     5427    2    /**/   UTSSF = VECTOR(NIL);

   5427  5 000170   000006 237000 6                  LDAQ    6
         5 000171   000000 755000 xsym               STA     UTSSF
         5 000172   000001 756000 xsym               STQ     UTSSF+1
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:23   

      138     5428    2    /**/   SOURCESF = %CLOCK#;

   5428  5 000173   000000 450000 xsym               STZ     SOURCESF

      139     5429    2    /**/   DESTSF = %LOCAL#;

   5429  5 000174   000003 235007                    LDA     3,DL
         5 000175   000000 755000 xsym               STA     DESTSF

      140     5430    2           CALL SYS_FUNC_DATE;

   5430  5 000176   000000 631400 6                  EPPR1   0
         5 000177   000000 701000 xent               TSX1    SYS_FUNC_DATE
         5 000200   000000 011000                    NOP     0

      141     5431    2           PPG#=PPG#+1;

   5431  5 000201   000000 235000 xsym               LDA     PPG#
         5 000202   000001 035007                    ADLA    1,DL
         5 000203   000000 755000 xsym               STA     PPG#

      142     5432    2           CALL BINCHAR(EX_RPT_HDR.PG#,PPG#);

   5432  5 000204   000044 773000                    LRL     36
         5 000205   200004 757100                    STAQ    4,,AUTO
         5 000206   000000 301500                    BTD
         5 000207   200004 000010                    NDSC9   4,,AUTO                  cn=0,s=lsgnf,sf=0,n=8
         5 000210   000022 630004 xsym               NDSC9   EX_RPT_HDR+18            cn=3,s=nosgn,sf=0,n=4

      143     5433    2    /**/   DCBSF = DCBNUM(M$LO);

   5433  5 000211   000000 236007 xsym               LDQ     M$LO,DL
         5 000212   000000 620006                    EAX0    0,QL
         5 000213   000000 740000 xsym               STX0    DCBSF

      144     5434    2    /**/   BUFSF = VECTOR(EX_RPT_HDR);
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:24   

   5434  5 000214   000010 237000 6                  LDAQ    8
         5 000215   000000 755000 xsym               STA     BUFSF
         5 000216   000001 756000 xsym               STQ     BUFSF+1

      145     5435    2    /**/   BUFLNSF = 82;

   5435  5 000217   000122 235007                    LDA     82,DL
         5 000220   000000 755000 xsym               STA     BUFLNSF

      146     5436    2           CALL SYS_FUNC_WRIT;

   5436  5 000221   000000 631400 6                  EPPR1   0
         5 000222   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000223   000000 011000                    NOP     0

      147     5437    2           END;

      148     5438    1   /**/ BUFSF = VECTOR(DIR_PRNT);

   5438  5 000224   000012 237000 6                  LDAQ    10
         5 000225   000000 755000 xsym               STA     BUFSF
         5 000226   000001 756000 xsym               STQ     BUFSF+1

      149     5439    1   /**/ VFCSF= %YES#;

   5439  5 000227   400000 236003                    LDQ     -131072,DU
         5 000230   000000 756000 xsym               STQ     VFCSF

      150     5440    1   /**/ BUFLNSF = 40;

   5440  5 000231   000050 235007                    LDA     40,DL
         5 000232   000000 755000 xsym               STA     BUFLNSF

      151     5441    1       CALL SYS_FUNC_WRIT;

   5441  5 000233   000000 631400 6                  EPPR1   0
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:25   
         5 000234   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000235   000000 011000                    NOP     0

      152     5442    1   /**/ BUFSF = VECTOR(RBUF);

   5442  5 000236   000014 237000 6                  LDAQ    12
         5 000237   000000 755000 xsym               STA     BUFSF
         5 000240   000001 756000 xsym               STQ     BUFSF+1

      153     5443    1   /**/ BUFLNSF = 256;

   5443  5 000241   000400 235007                    LDA     256,DL
         5 000242   000000 755000 xsym               STA     BUFLNSF

      154     5444    1   /**/ VFCSF = %NO#;

   5444  5 000243   000000 450000 xsym               STZ     VFCSF

      155     5445    1       CALL SYS_FUNC_WRIT;

   5445  5 000244   000000 631400 6                  EPPR1   0
         5 000245   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000246   000000 011000                    NOP     0

      156     5446    1       IF PCB.HI_CHAR = 0 THEN

   5446  5 000247   002121 235000 1                  LDA     PCB+10
         5 000250   000253 601000 5                  TNZ     s:5448

      157     5447    1           PLACE_INDX = 0;

   5447  5 000251   000043 450000 1                  STZ     PLACE_INDX
         5 000252   000264 710000 5                  TRA     s:5453

      158     5448    1       ELSE IF PCB.HI_CHAR > 131 THEN

   5448  5 000253   000204 115007                    CMPA    132,DL
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:26   
         5 000254   000262 602000 5                  TNC     s:5451

      159     5449    1               PLACE_INDX = PCB.NCHARS - PCB.HI_CHAR - 1;

   5449  5 000255   002120 236000 1                  LDQ     PCB+9
         5 000256   002121 136000 1                  SBLQ    PCB+10
         5 000257   000001 136007                    SBLQ    1,DL
         5 000260   000043 756000 1                  STQ     PLACE_INDX
         5 000261   000264 710000 5                  TRA     s:5453

      160     5450    1           ELSE
      161     5451    1               PLACE_INDX=PCB.HI_CHAR - 1; /* Set error position indicator */

   5451  5 000262   000001 135007                    SBLA    1,DL
         5 000263   000043 755000 1                  STA     PLACE_INDX

      162     5452         /* And set fpt parameters */
      163     5453    1       PLACE_BUF(PLACE_INDX)='^';

   5453  5 000264   000043 235000 1                  LDA     PLACE_INDX
         5 000265   040005 100400                    MLR     fill='040'O
         5 000266   000016 000001 6                  ADSC9   14                       cn=0,n=1
         5 000267   000002 000001 1                  ADSC9   PLACE_BUF,A              cn=0,n=1

      164     5454
      165     5455    1       INDX_PTR$=ADDR(PLACE_OUT);

   5455  5 000270   000017 236000 6                  LDQ     15
         5 000271   000044 756000 1                  STQ     INDX_PTR$

      166     5456    1   /**/ BUFSF = VECTOR(PLACE_OUT);

   5456  5 000272   000020 237000 6                  LDAQ    16
         5 000273   000000 755000 xsym               STA     BUFSF
         5 000274   000001 756000 xsym               STQ     BUFSF+1

      167     5457    1   /**/ VFCSF =%NO#;
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:27   

   5457  5 000275   000000 450000 xsym               STZ     VFCSF

      168     5458    1   /**/ BUFLNSF = PLACE_INDX + 1;

   5458  5 000276   000043 235000 1                  LDA     PLACE_INDX
         5 000277   000001 035007                    ADLA    1,DL
         5 000300   000000 755000 xsym               STA     BUFLNSF

      169     5459    1       CALL SYS_FUNC_WRIT;

   5459  5 000301   000000 631400 6                  EPPR1   0
         5 000302   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000303   000000 011000                    NOP     0

      170     5460    1       PLACE_OUT = ' '; /* Blank out error indicator for reuse */

   5460  5 000304   040000 100400                    MLR     fill='040'O
         5 000305   000022 000001 6                  ADSC9   18                       cn=0,n=1
         5 000306   000002 000204 1                  ADSC9   PLACE_BUF                cn=0,n=132

      171     5461    1   /**/ BUFSF = VECTOR(ERR_BUFF);

   5461  5 000307   000024 237000 6                  LDAQ    20
         5 000310   000000 755000 xsym               STA     BUFSF
         5 000311   000001 756000 xsym               STQ     BUFSF+1

      172     5462    1   /**/ BUFLNSF = 132;

   5462  5 000312   000204 235007                    LDA     132,DL
         5 000313   000000 755000 xsym               STA     BUFLNSF

      173     5463    1   /**/ VFCSF = %NO#;

   5463  5 000314   000000 450000 xsym               STZ     VFCSF

      174     5464    1       CALL SYS_FUNC_WRIT; /* Write parse error */
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:28   

   5464  5 000315   000000 631400 6                  EPPR1   0
         5 000316   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000317   000000 011000                    NOP     0

      175     5465    1       PLACE_OUT = '     Type HELP for help.';

   5465  5 000320   040000 100400                    MLR     fill='040'O
         5 000321   000327 000030 0                  ADSC9   ZI_DIR+183               cn=0,n=24
         5 000322   000002 000204 1                  ADSC9   PLACE_BUF                cn=0,n=132

      176     5466    1   /**/ BUFSF = VECTOR(PLACE_OUT);

   5466  5 000323   000020 237000 6                  LDAQ    16
         5 000324   000000 755000 xsym               STA     BUFSF
         5 000325   000001 756000 xsym               STQ     BUFSF+1

      177     5467    1   /**/ VFCSF = %NO#;

   5467  5 000326   000000 450000 xsym               STZ     VFCSF

      178     5468    1   /**/ CALL SYS_FUNC_WRIT;

   5468  5 000327   000000 631400 6                  EPPR1   0
         5 000330   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000331   000000 011000                    NOP     0

      179     5469    1       PLACE_OUT = '  ';

   5469  5 000332   040000 100400                    MLR     fill='040'O
         5 000333   000327 000002 0                  ADSC9   ZI_DIR+183               cn=0,n=2
         5 000334   000002 000204 1                  ADSC9   PLACE_BUF                cn=0,n=132

      180     5470    1   CHK_CCBUF: IF CCBUF_ON THEN /* NO MORE INPUT, SIMULATE A 'END' */

   5470  5 000335   000000 234000 xsym  CHK_CCBUF    SZN     CCBUF_ON
         5 000336   000342 605000 5                  TPL     s:5475
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:29   

      181     5471    2       DO;

      182     5472    2           READ_SW = 3;

   5472  5 000337   000003 235007                    LDA     3,DL
         5 000340   000000 755000 xsym               STA     READ_SW

      183     5473    2           RETURN;

   5473  5 000341   000000 702200 xent               TSX2  ! X66_ARET

      184     5474    2           END;
      185     5475    1       GOTO READ; /* TAKE ANOTHER DIRECTIVE */

   5475  5 000342   000002 710000 5                  TRA     READ

   5470  5 000343                       TEST_ERR     null
      186     5476
      187     5477    1   TEST_ERR: ;
      188     5478        /*
      189     5479           Print header only if source in is from a file or list out
      190     5480           is to a file.
      191     5481        */
      192     5482    1       IF PRINT_HDR THEN

   5482  5 000343   000000 234000 xsym               SZN     PRINT_HDR
         5 000344   000405 605000 5                  TPL     s:5497

      193     5483    2       DO;

      194     5484    2    /**/   DATESF=VECTOR(EX_RPT_HDR.HDR_DATE);

   5484  5 000345   000004 237000 6                  LDAQ    4
         5 000346   000000 755000 xsym               STA     DATESF
         5 000347   000001 756000 xsym               STQ     DATESF+1

PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:30   
      195     5485    2    /**/   UTSSF = VECTOR(NIL);

   5485  5 000350   000006 237000 6                  LDAQ    6
         5 000351   000000 755000 xsym               STA     UTSSF
         5 000352   000001 756000 xsym               STQ     UTSSF+1

      196     5486    2    /**/   SOURCESF = %CLOCK#;

   5486  5 000353   000000 450000 xsym               STZ     SOURCESF

      197     5487    2    /**/   DESTSF = %LOCAL#;

   5487  5 000354   000003 235007                    LDA     3,DL
         5 000355   000000 755000 xsym               STA     DESTSF

      198     5488    2           CALL SYS_FUNC_DATE;

   5488  5 000356   000000 631400 6                  EPPR1   0
         5 000357   000000 701000 xent               TSX1    SYS_FUNC_DATE
         5 000360   000000 011000                    NOP     0

      199     5489    2           PPG#=PPG#+1;

   5489  5 000361   000000 235000 xsym               LDA     PPG#
         5 000362   000001 035007                    ADLA    1,DL
         5 000363   000000 755000 xsym               STA     PPG#

      200     5490    2           CALL BINCHAR(EX_RPT_HDR.PG#,PPG#);

   5490  5 000364   000044 773000                    LRL     36
         5 000365   200004 757100                    STAQ    4,,AUTO
         5 000366   000000 301500                    BTD
         5 000367   200004 000010                    NDSC9   4,,AUTO                  cn=0,s=lsgnf,sf=0,n=8
         5 000370   000022 630004 xsym               NDSC9   EX_RPT_HDR+18            cn=3,s=nosgn,sf=0,n=4

      201     5491    2    /**/   DCBSF=DCBNUM(M$LO);

PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:31   
   5491  5 000371   000000 236007 xsym               LDQ     M$LO,DL
         5 000372   000000 620006                    EAX0    0,QL
         5 000373   000000 740000 xsym               STX0    DCBSF

      202     5492    2    /**/   BUFSF = VECTOR(EX_RPT_HDR);

   5492  5 000374   000010 237000 6                  LDAQ    8
         5 000375   000000 755000 xsym               STA     BUFSF
         5 000376   000001 756000 xsym               STQ     BUFSF+1

      203     5493    2    /**/   BUFLNSF = 82;

   5493  5 000377   000122 235007                    LDA     82,DL
         5 000400   000000 755000 xsym               STA     BUFLNSF

      204     5494    2    /**/   VFCSF =%NO#;

   5494  5 000401   000000 450000 xsym               STZ     VFCSF

      205     5495    2           CALL SYS_FUNC_WRIT;

   5495  5 000402   000000 631400 6                  EPPR1   0
         5 000403   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000404   000000 011000                    NOP     0

      206     5496    2           END;

      207     5497    1   /**/ BUFSF = VECTOR(DIR_PRNT);

   5497  5 000405   000012 237000 6                  LDAQ    10
         5 000406   000000 755000 xsym               STA     BUFSF
         5 000407   000001 756000 xsym               STQ     BUFSF+1

      208     5498    1   /**/ VFCSF= %YES#;

   5498  5 000410   400000 236003                    LDQ     -131072,DU
         5 000411   000000 756000 xsym               STQ     VFCSF
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:32   

      209     5499    1   /**/ BUFLNSF = 20;

   5499  5 000412   000024 235007                    LDA     20,DL
         5 000413   000000 755000 xsym               STA     BUFLNSF

      210     5500    1       CALL SYS_FUNC_WRIT;

   5500  5 000414   000000 631400 6                  EPPR1   0
         5 000415   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000416   000000 011000                    NOP     0

      211     5501    1   /**/ BUFSF = VECTOR(RBUF);

   5501  5 000417   000014 237000 6                  LDAQ    12
         5 000420   000000 755000 xsym               STA     BUFSF
         5 000421   000001 756000 xsym               STQ     BUFSF+1

      212     5502    1   /**/ BUFLNSF = 256;

   5502  5 000422   000400 235007                    LDA     256,DL
         5 000423   000000 755000 xsym               STA     BUFLNSF

      213     5503    1   /**/ VFCSF = %NO#;

   5503  5 000424   000000 450000 xsym               STZ     VFCSF

      214     5504    1       CALL SYS_FUNC_WRIT;

   5504  5 000425   000000 631400 6                  EPPR1   0
         5 000426   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000427   000000 011000                    NOP     0

      215     5505    1       SUBMESSF = %YES#;

   5505  5 000430   400000 236003                    LDQ     -131072,DU
         5 000431   000000 756000 xsym               STQ     SUBMESSF
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:33   

      216     5506    1       CALL SYS_FUNC_ERRMSG; /* Parameters were set by interprtr */

   5506  5 000432   000000 631400 6                  EPPR1   0
         5 000433   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         5 000434   000000 011000                    NOP     0

      217     5507    1       GOTO CHK_CCBUF;

   5507  5 000435   000335 710000 5                  TRA     CHK_CCBUF

      218     5508
      219     5509    1   ALT_ZIU$Q2DI:
      220     5510    1       IF READ_SW = 2 THEN

   5510  5 000436   000000 235000 xsym  ALT_ZIU$Q2DI LDA     READ_SW
         5 000437   000002 115007                    CMPA    2,DL
         5 000440   000445 601000 5                  TNZ     s:5516

      221     5511    2       DO;

      222     5512    2           ERR_BUFF.TEXT = 'COMMAND TO LARGE - UNABLE TO CONCATENATE ';

   5512  5 000441   040000 100400                    MLR     fill='040'O
         5 000442   000335 000051 0                  ADSC9   ZI_DIR+189               cn=0,n=41
         5 000443   002046 400176 1                  ADSC9   ERR_BUFF+1               cn=2,n=126

      223     5513    2           RETURN;

   5513  5 000444   000000 702200 xent               TSX2  ! X66_ARET

      224     5514    2           END;
      225     5515    1       ELSE
      226     5516    1           IF READ_SW = 1 THEN ALTRETURN; /* Eof */

   5516  5 000445   000001 115007                    CMPA    1,DL
         5 000446   000450 601000 5                  TNZ     s:5517
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:34   

   5516  5 000447   000000 702200 xent               TSX2  ! X66_AALT

      227     5517    1   /**/ DCBSF=DCBNUM(M$LO);

   5517  5 000450   000000 236007 xsym               LDQ     M$LO,DL
         5 000451   000000 620006                    EAX0    0,QL
         5 000452   000000 740000 xsym               STX0    DCBSF

      228     5518    1   /**/ BUFSF = VECTOR(ERR_BUFF);

   5518  5 000453   000024 237000 6                  LDAQ    20
         5 000454   000000 755000 xsym               STA     BUFSF
         5 000455   000001 756000 xsym               STQ     BUFSF+1

      229     5519    1   /**/ BUFLNSF = 132;

   5519  5 000456   000204 235007                    LDA     132,DL
         5 000457   000000 755000 xsym               STA     BUFLNSF

      230     5520    1   /**/ VFCSF = %NO#;

   5520  5 000460   000000 450000 xsym               STZ     VFCSF

      231     5521    1       CALL SYS_FUNC_WRIT;

   5521  5 000461   000000 631400 6                  EPPR1   0
         5 000462   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000463   000000 011000                    NOP     0

      232     5522    1       ALTRETURN;

   5522  5 000464   000000 702200 xent               TSX2  ! X66_AALT

SYN_ERR
 Sect OctLoc
   0     000   123131 116124   101130 040105   122122 117122                    SYNTAX ERROR
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:35   

NULL_ROOT
 Sect OctLoc
   0     003   115111 123123   111116 107040   124122 105105                    MISSING TREE

BAD_NODE
 Sect OctLoc
   0     006   111114 114105   107101 114040   116117 104105                    ILLEGAL NODE

OVER_FLOW
 Sect OctLoc
   0     011   117126 105122   106114 117127                                    OVERFLOW

SMALL_WORK
 Sect OctLoc
   0     013   111116 123125   106106 111103   111105 116124   040127 117122    INSUFFICIENT WOR
   0     017   113040 101122   105101 ******                                    K AREA..

NULL_U$$
 Sect OctLoc
   0     021   115111 123123   111116 107040   125044 044040   122117 125124    MISSING U$$ ROUT
   0     025   111116 105***                                                    INE.

UNKN_ERR
 Sect OctLoc
   0     026   125116 113116   117127 116040   105122 122056   056110 117114    UNKNOWN ERR..HOL
   0     032   104111 116107                                                    DING

INTERPRTR_ERR
 Sect OctLoc
   0     033   111116 124105   122120 122124   122040 040040   040040 105122    INTERPRTR     ER
   0     037   122117 122***                                                    ROR.

ZI_DIR
 Sect OctLoc
   0     040   000340 000000   000000 000000   00000* 040040   040040 040040    ..........
   0     044   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:36   
   0     064*  040040 040040   040040 040040   040040 0*****   000000 000000              ......
   0     070   000000 000000   ****** ******   ****** ******   ****** ******    ................
   0     164*  ****** ******   010040 140000   000040 040040   040040 040040    ..... `..
   0     170   040040 040040   040040 040040   040040 040040   040040 040040
   0     200*  040040 040040   040000 0*****   040040 040040   040040 040040         ...
   0     204   040040 040040   040040 040040   040040 040040   040040 040040
   0     260*  000000 000000   000000 000000   000000 000000   000040 040040    .............
   0     264   040040 040040   040040 040040   040040 040040   040040 040040
   0     270   040040 040040   040040 040040   040040 040***   000000 ******               .....
   0     274   000040 040040   040040 040040   040040 040040   040040 040040    .
   0     300   040040 040040   040040 040040   040040 040040   040040 040***                   .
   0     304   000000 ******   000040 040040   040040 040040   040040 040040    .....
   0     310   040040 040040   040040 040040   040040 040040   040040 040040
   0     314   040040 040***   000000 ******   000040 040040   040040 040040       ......
   0     320   040040 040040   040040 040040   040040 040040   040040 040040
   0     324   040040 040040   040040 040***   000000 ******                           .....

(unnamed)
 Sect OctLoc
   0     327   040040 040040   040124 171160   145040 110105   114120 040146         Type HELP f
   0     333   157162 040150   145154 160056   103117 115115   101116 104040    or help.COMMAND
   0     337   124117 040114   101122 107105   040055 040125   116101 102114    TO LARGE - UNABL
   0     343   105040 124117   040103 117116   103101 124105   116101 124105    E TO CONCATENATE
   0     347   040040 040040

FLAG
 Sect OctLoc
   1     000   106101 114123   105*** ******                                    FALSE...

PLACE_BUF
 Sect OctLoc
   1     002   040040 040040   040040 040040   040040 040040   040040 040040
   1     042*  040040 040040

WK
 Sect OctLoc
   1     045   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:37   

ERR_BUFF
 Sect OctLoc
   1    2045   052040 052040   052040 ******   ****** ******   ****** ******    * * * ..........
   1    2105*  ****** ******                                                    ....

PRMPT_CHAR
 Sect OctLoc
   1    2106   160055 ******                                                    p-..

PCB
 Sect OctLoc
   1    2107   000000 006000   000000 006000   000045 006000   000000 006014    .........%......
   1    2113   000000 000000   002000 600000   000000 000000   040042 040042    ............ " "
   1    2117   000000 040000   000000 000000   000000 000000   000000 006014    .. .............
   1    2123   000000 006014   000000 000000                                    ........

FPT_PROMPT
 Sect OctLoc
   1    2126   000003 777640   002134 006000   000000 177640   000000 006014    .....\..........
   1    2132   000000 377640   002106 006000   000000 000000   000000 000000    .....F..........
   1    2136   100000 000000   000000 000000                                    @.......

(unnamed)
 Sect OctLoc
   6     000   000000 000000   000001 000000   002107 006000   000000 000000    .........G......
   6     004   000001 777640   000017 206000   000000 177640   000000 006014    ................
   6     010   000040 777640   000000 006000   000040 777640   000000 006000    . ....... ......
   6     014   000077 777640   000000 006000   136040 040040   000002 006000    .?......^   ....
   6     020   000040 777640   000002 006000   040040 040040   000000 000000    . ......    ....
   6     024   000040 777640   002045 006000                                    . ...%..
      233     5523
      234     5524    1   END ZIU$Q2DI;
      235     5525        %EOD;

PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:38   
--  Include file information  --

   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   XU_PERR_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$Q2DI.

   Procedure ZIU$Q2DI requires 309 words for executable code.
   Procedure ZIU$Q2DI requires 6 words of local(AUTO) storage.
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:39   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:40   
          MINI XREF LISTING

ACNT_IDX
      4555**DCL      5377<<ASSIGN
ALT_ZIU$Q2DI
      5510**LABEL    5389--CALLALT
B$JIT.CCARS
      3537**DCL      5379>>IF       5382>>ASSIGN   5384>>ASSIGN
B$JIT.CCBUF
      3537**DCL      5382>>ASSIGN
B$JIT.CCDISP
      3537**DCL      5379>>IF       5382>>ASSIGN   5382>>ASSIGN   5384>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      3543**DCL      3543--REDEF
B$JIT.ERR.MID
      3450**DCL      3450--REDEF
B$JIT.JRESPEAK
      3611**DCL      3612--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      3720**DCL      3720--REDEF    3721--REDEF
B$JIT.PNR
      3624**DCL      3624--REDEF
B$JIT.TSLINE
      3718**DCL      3719--REDEF
B$JIT$
      4574**DCL      3444--IMP-PTR  5379>>IF       5379>>IF       5382>>ASSIGN   5382>>ASSIGN   5382>>ASSIGN
      5382>>ASSIGN   5384>>ASSIGN   5384>>ASSIGN
BAD_NODE
        16**DCL      5410>>ASSIGN
BUFLNSF
      4473**DCL      5391<<ASSIGN   5435<<ASSIGN   5440<<ASSIGN   5443<<ASSIGN   5458<<ASSIGN   5462<<ASSIGN
      5493<<ASSIGN   5499<<ASSIGN   5502<<ASSIGN   5519<<ASSIGN
BUFSF
      4474**DCL      5434<<ASSIGN   5438<<ASSIGN   5442<<ASSIGN   5456<<ASSIGN   5461<<ASSIGN   5466<<ASSIGN
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:41   
      5492<<ASSIGN   5497<<ASSIGN   5501<<ASSIGN   5518<<ASSIGN
CCBUF_ON
        55**DCL      5381<<ASSIGN   5387<<ASSIGN   5470>>IF
CHK_CCBUF
      5470**LABEL    5507--GOTO
CNT
      4547**DCL      5384<<ASSIGN   5395>>ASSIGN
COUNTSF
      4524**DCL      4525--REDEF
DATESF
      4477**DCL      5426<<ASSIGN   5484<<ASSIGN
DCBSF
      4453**DCL      5392<<ASSIGN   5403<<ASSIGN   5433<<ASSIGN   5491<<ASSIGN   5517<<ASSIGN
DESTSF
      4476**DCL      5429<<ASSIGN   5487<<ASSIGN
DIR_PRNT
        39**DCL      5438--ASSIGN   5497--ASSIGN
ENCRP_SEEDSF
      4482**DCL      4483--REDEF
ERRCODESF
      4484**DCL      4489--REDEF
ERR_BUFF
        40**DCL      5461--ASSIGN   5518--ASSIGN
ERR_BUFF.TEXT
        42**DCL      5406<<ASSIGN   5408<<ASSIGN   5410<<ASSIGN   5412<<ASSIGN   5414<<ASSIGN   5416<<ASSIGN
      5418<<ASSIGN   5512<<ASSIGN
EX_RPT_HDR
        32**DCL      5434--ASSIGN   5492--ASSIGN
EX_RPT_HDR.HDR_DATE
        35**DCL      5426--ASSIGN   5484--ASSIGN
EX_RPT_HDR.PG#
        37**DCL      5432<<CALLBLT  5490<<CALLBLT
F$DCB.ACTPOS
      4820**DCL      4820--REDEF
F$DCB.ARS#
      4794**DCL      4794--REDEF
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:42   
F$DCB.ATTR
      4813**DCL      4814--REDEF
F$DCB.BORROW
      4828**DCL      4828--REDEF    4828--REDEF    4828--REDEF
F$DCB.DCBNAME.L
      4842**DCL      4842--IMP-SIZ
F$DCB.EOMCHAR#
      4798**DCL      4798--REDEF
F$DCB.FLDID
      4823**DCL      4823--REDEF
F$DCB.FORM$
      4817**DCL      4817--REDEF
F$DCB.FSECT
      4833**DCL      4833--REDEF
F$DCB.FSN#
      4810**DCL      4810--REDEF    4810--REDEF    4811--REDEF
F$DCB.HEADER$
      4816**DCL      4816--REDEF
F$DCB.IXTNSIZE#
      4814**DCL      4814--REDEF
F$DCB.LASTSTA$
      4803**DCL      4803--REDEF
F$DCB.LVL
      4829**DCL      4829--REDEF
F$DCB.NAME#.C
      4804**DCL      4804--REDEF
F$DCB.NOEOF
      4826**DCL      4826--REDEF
F$DCB.NRECS#
      4815**DCL      4815--REDEF
F$DCB.NRECX
      4834**DCL      4834--REDEF
F$DCB.OHDR
      4826**DCL      4826--REDEF
F$DCB.ORG#
      4809**DCL      4809--REDEF
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:43   
F$DCB.PRECNO
      4832**DCL      4832--REDEF
F$DCB.RCSZ
      4838**DCL      4838--REDEF
F$DCB.RES#
      4805**DCL      4805--REDEF
F$DCB.SETX
      4817**DCL      4817--REDEF
F$DCB.TAB$
      4817**DCL      4817--REDEF
F$DCB.TDA
      4831**DCL      4832--REDEF
F$DCB.WSN#
      4805**DCL      4805--REDEF
FIDSF_RD
      4500**DCL      4501--REDEF
FPT_PROMPT
      4905**DCL      5388<>CALL
FPT_PROMPT.V
      4913**DCL      4907--DCLINIT
HELPCODE
      4518**DCL      4523--REDEF
ICHKSUM
      4583**DCL      4584--REDEF
ICNT
      4548**DCL      5373<<ASSIGN
INDX_PTR$
        27**DCL        28--IMP-PTR  5455<<ASSIGN
INTERPRTR
      5364**DCL-ENT  5398--CALL
ITMCNT
      4585**DCL      5376<<ASSIGN
I_O_BUF$
      4561**DCL      4562--IMP-PTR
KCNT
      4554**DCL      5374<<ASSIGN
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:44   
KEYVSF
      4456**DCL      4461--REDEF
KEYVSF.WD_ONE
      4458**DCL      4459--REDEF
M$LO
      4571**DCL      5392>>ASSIGN   5403>>ASSIGN   5433>>ASSIGN   5491>>ASSIGN   5517>>ASSIGN
M$PROMPT
      3387**DCL-ENT  5388--CALL
MSGCODE
      4490**DCL      4491--REDEF
NULL_ROOT
        15**DCL      5408>>ASSIGN
NULL_U$$
        19**DCL      5416>>ASSIGN
OUT$BLK
      4850**DCL      5398<>CALL
OVER_FLOW
        17**DCL      5412>>ASSIGN
PARSERR
      5402**LABEL    5396--CALLALT
PCB
      4606**DCL      5396<>CALL
PCB.ERROR.CODE
      4718**DCL      5404>>DOCASE
PCB.HI_CHAR
      4757**DCL      5446>>IF       5448>>IF       5449>>ASSIGN   5451>>ASSIGN
PCB.NCHARS
      4753**DCL      5395<<ASSIGN   5449>>ASSIGN
PCB.OUT$
      4619**DCL      5398>>CALL
PLACE_BUF
        24**DCL        25--REDEF    5453<<ASSIGN
PLACE_INDX
        26**DCL        28--IMP-SIZ  5447<<ASSIGN   5449<<ASSIGN   5451<<ASSIGN   5453>>ASSIGN   5458>>ASSIGN
PLACE_OUT
        25**DCL      5455--ASSIGN   5456--ASSIGN   5460<<ASSIGN   5465<<ASSIGN   5466--ASSIGN   5469<<ASSIGN
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:45   
PPG#
        31**DCL      5431<<ASSIGN   5431>>ASSIGN   5432>>CALLBLT  5489<<ASSIGN   5489>>ASSIGN   5490>>CALLBLT
PRINT_HDR
      5368**DCL      5424>>IF       5482>>IF
PRMPT_CHAR
        43**DCL      4911--DCLINIT
RBUF
        23**DCL      4607--DCLINIT  5382<<ASSIGN   5442--ASSIGN   5501--ASSIGN
RCNT
      4549**DCL      5375<<ASSIGN
READ
      5373**LABEL    5475--GOTO
READDIR
      5367**DCL-ENT  5389--CALL
READ_SW
        29**DCL      5472<<ASSIGN   5510>>IF       5516>>IF
REC$
      4542**DCL      4565--IMP-PTR
REC_DATA_LN
      4570**DCL      4569--IMP-SIZ
SMALL_WORK
        18**DCL      5414>>ASSIGN
SOURCESF
      4475**DCL      5428<<ASSIGN   5486<<ASSIGN
STEPCC
      4560**DCL      5402<<ASSIGN
SUBMESSF
      4510**DCL      5505<<ASSIGN
SYN_ERR
        14**DCL      5406>>ASSIGN
SYS_FUNC_DATE
        46**DCL-ENT  5430--CALL     5488--CALL
SYS_FUNC_ERRMSG
        49**DCL-ENT  5506--CALL
SYS_FUNC_WRIT
        47**DCL-ENT  5394--CALL     5436--CALL     5441--CALL     5445--CALL     5459--CALL     5464--CALL
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:46   
      5468--CALL     5495--CALL     5500--CALL     5504--CALL     5521--CALL
TEST_ERR
      5470**LABEL    5398--CALLALT
UNKN_ERR
        20**DCL      5418>>ASSIGN
UTIL_CMD
      5366**DCL      4611--DCLINIT
UTSSF
      4479**DCL      5427<<ASSIGN   5485<<ASSIGN
VFCSF
      4470**DCL      5393<<ASSIGN   5439<<ASSIGN   5444<<ASSIGN   5457<<ASSIGN   5463<<ASSIGN   5467<<ASSIGN
      5494<<ASSIGN   5498<<ASSIGN   5503<<ASSIGN   5520<<ASSIGN
WK
        30**DCL      4615--DCLINIT
X$PARSE
      5363**DCL-ENT  5396--CALL
ZI$DIR
      5080**DCL      5378<<ASSIGN
ZI$DIR.ALTKEY
      5146**DCL      5147--REDEF    5148--REDEF
ZI$DIR.AREAFID
      5112**DCL      5113--REDEF
ZI$DIR.DATE
      5151**DCL      5155--REDEF
ZI$DIR.DEST_SEED
      5107**DCL      5108--REDEF    5109--REDEF
ZI$DIR.ENCP_SEED
      5104**DCL      5105--REDEF    5106--REDEF
ZI$DIR.REPRT_ZERO
      5138**DCL      5139--REDEF
ZI$DIR.SCHFID
      5110**DCL      5111--REDEF
ZI$DIR.TIME
      5156**DCL      5161--REDEF
ZI_DIR
      5224**DCL      5378>>ASSIGN
PL6.E3A0      #001=ZIU$Q2DI File=ZIU$Q2DI.:ZIC0TSI                               FRI 09/05/97 13:20 Page:47   
ZI_DIR.ALTKEY
      5290**DCL      5291--REDEF    5292--REDEF
ZI_DIR.AREAFID
      5256**DCL      5257--REDEF
ZI_DIR.DATE
      5295**DCL      5299--REDEF
ZI_DIR.DEST_SEED
      5251**DCL      5252--REDEF    5253--REDEF
ZI_DIR.ENCP_SEED
      5248**DCL      5249--REDEF    5250--REDEF
ZI_DIR.REPRT_ZERO
      5282**DCL      5283--REDEF
ZI_DIR.SCHFID
      5254**DCL      5255--REDEF
ZI_DIR.TIME
      5300**DCL      5305--REDEF

PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:48   
      236        1        /*T***********************************************************/
      237        2        /*T*                                                         */
      238        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      239        4        /*T*                                                         */
      240        5        /*T***********************************************************/
      241        6        READDIR : PROC ALTRET;
      242        7    1   DCL 1 RBUF SYMREF,
      243        8    1         2 TEXT CHAR(256) UNAL;
      244        9    1   DCL TEMP_BUF CHAR(132) STATIC ALIGNED;
      245       10
      246       11    1   DCL CAT$ PTR STATIC INIT(ADDR(TEMP_BUF));
      247       12    1   DCL CONCAT_BUF CHAR(CNT) BASED(CAT$);
      248       13
      249       14    1   DCL READ_SW SBIN SYMREF ALIGNED;
      250       15    1   DCL LEN SBIN STATIC ALIGNED;
      251       16    1   DCL 1 PRMPT_CHAR SYMREF,
      252       17    1         2 CAR_CTL BIT(9),
      253       18    1         2 PMPT CHAR(1);
      254       19    1   DCL M$SI DCB;
      255       20    1   DCL SYS_FUNC_READ ENTRY ALTRET;
      256       21
      257       22        %INCLUDE CP_6;
      258      103        %INCLUDE CP_6_SUBS;
      259      643        %INCLUDE ZI_GLOBAL_DBUTIL;
      260      821         %SYS_FUNC;
      261      913         %MISC_DCLS;
      262      966        %INCLUDE ZI_PRSE_SUBS;
      263     1122        %F$DCB;
      264     1179        %FPT_PROMPT(PROMPT=PRMPT_CHAR.PMPT,VFC=NO,DCB=M$UC);
      265     1207
      266     1208    1       TEMP_BUF = ' ';
      267     1209    1   /**/ DCBSF=DCBNUM(M$SI);
      268     1210    1   /**/ BUFSF = VECTOR(TEMP_BUF);
      269     1211    1   /**/ BUFLNSF = 132;
      270     1212    1   READ_DI:
      271     1213    1       CALL SYS_FUNC_READ ALTRET(ALT_READDIR);
      272     1214    1       CNT=DCBADDR(DCBSF)->F$DCB.ARS# ;
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:49   
      273     1215    1       IF CNT = 0 OR TEMP_BUF = ' ' THEN
      274     1216    1           GOTO READ_DI;
      275     1217    1       LEN = CNT-1; /* Initialize length of input */
      276     1218    1       RBUF.TEXT=TEMP_BUF;
      277     1219
      278     1220         /*     Look for and handle continuation of input apart from parser */
      279     1221    2       DO WHILE (SUBSTR(TEMP_BUF,CNT-1,1) = ';');
      280     1222    2           TEMP_BUF = ' '; /* Prepare to read next line in temp storage */
      281     1223    2           CALL M$PROMPT(FPT_PROMPT);
      282     1224    2           CALL SYS_FUNC_READ ALTRET(ALT_READDIR);
      283     1225    2           CNT = DCBADDR(DCBSF)->F$DCB.ARS# ;/* Set counter = input size */
      284     1226    2           IF CNT = 0 THEN
      285     1227    3           DO; /*  Handle null input as a continuation */
      286     1228    3               TEMP_BUF = ';';
      287     1229    3               CNT = 1;
      288     1230    3               END;
      289     1231    2           CALL INSERT(RBUF.TEXT,LEN,CNT+1,' ',CONCAT_BUF) ALTRET (ALT_INSRT);
      290     1232    2           LEN = LEN + CNT ;
      291     1233    2           IF LEN > 256 THEN /* Prevent overfill of buffer*/
      292     1234    3           DO;
      293     1235    3               READ_SW=2;
      294     1236    3               ALTRETURN;
      295     1237    3               END;
      296     1238    2           END;
      297     1239    1       CNT = LEN + 1; /* Reset cnt for use by parser */
      298     1240    1       READ_SW = 0;
      299     1241    1       RETURN;
      300     1242
      301     1243    1   ALT_READDIR:
      302     1244    1       READ_SW=1;
      303     1245    1       ALTRETURN;
      304     1246    1   ALT_INSRT:
      305     1247    1       READ_SW=2;
      306     1248    1       ALTRETURN;
      307     1249    1   END READDIR;
      308     1250        %EOD;

PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:50   
--  Include file information  --

   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure READDIR.

   Procedure READDIR requires 98 words for executable code.
   Procedure READDIR requires 6 words of local(AUTO) storage.

PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:51   

 Object Unit name= READDIR                                    File name= ZIU$Q2DI.:ZIC0TOU
 UTS= SEP 05 '97 13:20:50.84 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    46     56  READDIR
    1   DCB   even  none     0      0  M$SI
    2   DCB   even  none     0      0  M$UC
    3   DCB   even  none     0      0  M$LO
    4   Proc  even  none    98    142  READDIR
    5  RoData even  none     6      6  READDIR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        0  READDIR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 SYS_FUNC_READ
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:52   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RBUF                                  READ_SW                               PRMPT_CHAR
     M$SI                                  M$UC                                  BLKLSF
     KEYLSF                                KEYXSF                                DCBSF
     ORGSF                                 KEYSF                                 KEYVSF
     ACSSF                                 NOTIMESF                              FUNSF
     ASNSF                                 TESTSF                                XTENSIZESF
     DISPSF                                WAITSF                                VFCSF
     FULLSF                                BKUPSF                                BUFLNSF
     BUFSF                                 SOURCESF                              DESTSF
     DATESF                                TIMESF                                UTSSF
     DAYSF                                 TSTAMPSF                              ENCRP_SEEDSF
     ERRCODESF                             MSGCODE                               INCL_ERR
     ERR_INSERT                            FIDSF_RD                              ACNT
     EXISTSF                               SHARESF                               DCBNMSF
     KEYRSF                                NO_KEYSF                              REASGNSF
     CARRY_ATTRIBUTESF                     SUBMESSF                              SPKY_OPNSF
     POSSF                                 ERRFLGSF                              MERGESF
     FSA_FLAG                              RELGSF                                UNUSED
     HELPCODE                              COUNTSF                               INDEXSF
     GAP                                   PSNSF                                 ACNTSF
     KEY_SHADWSF                           REC$                                  RB
     RE                                    IE                                    IB
     CNT                                   ICNT                                  RCNT
     SCNT                                  FIRST_SET                             RETCNT
     DMPCNT                                KCNT                                  ACNT_IDX
     I                                     J                                     K
     X                                     STEPCC                                I_O_BUF$
     OUT_INDX                              I_O_SIZE                              REC_DATA_LN
     M$LO                                  B$TCB$                                B$ROS$
     B$JIT$                                KEYFID                                I_O_KEY
     RESTART                               BREAK_FLAG                            ICHKSUM
     ITMCNT                                GAP1
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:53   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:54   


      236        1        /*T***********************************************************/
      237        2        /*T*                                                         */
      238        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      239        4        /*T*                                                         */
      240        5        /*T***********************************************************/
      241        6        READDIR : PROC ALTRET;

      6  4 000000   000000 700200 xent  READDIR      TSX0  ! X66_AUTO_0
         4 000001   000006 000000                    ZERO    6,0

      242        7    1   DCL 1 RBUF SYMREF,
      243        8    1         2 TEXT CHAR(256) UNAL;
      244        9    1   DCL TEMP_BUF CHAR(132) STATIC ALIGNED;
      245       10
      246       11    1   DCL CAT$ PTR STATIC INIT(ADDR(TEMP_BUF));
      247       12    1   DCL CONCAT_BUF CHAR(CNT) BASED(CAT$);
      248       13
      249       14    1   DCL READ_SW SBIN SYMREF ALIGNED;
      250       15    1   DCL LEN SBIN STATIC ALIGNED;
      251       16    1   DCL 1 PRMPT_CHAR SYMREF,
      252       17    1         2 CAR_CTL BIT(9),
      253       18    1         2 PMPT CHAR(1);
      254       19    1   DCL M$SI DCB;
      255       20    1   DCL SYS_FUNC_READ ENTRY ALTRET;
      256       21
      257       22        %INCLUDE CP_6;
      258      103        %INCLUDE CP_6_SUBS;
      259      643        %INCLUDE ZI_GLOBAL_DBUTIL;
      260      821         %SYS_FUNC;
      261      913         %MISC_DCLS;
      262      966        %INCLUDE ZI_PRSE_SUBS;
      263     1122        %F$DCB;
      264     1179        %FPT_PROMPT(PROMPT=PRMPT_CHAR.PMPT,VFC=NO,DCB=M$UC);
      265     1207
      266     1208    1       TEMP_BUF = ' ';

PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:55   
   1208  4 000002   040000 100400                    MLR     fill='040'O
         4 000003   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000004   000000 000204 0                  ADSC9   TEMP_BUF                 cn=0,n=132

      267     1209    1   /**/ DCBSF=DCBNUM(M$SI);

   1209  4 000005   000000 236007 xsym               LDQ     M$SI,DL
         4 000006   000000 620006                    EAX0    0,QL
         4 000007   000000 740000 xsym               STX0    DCBSF

      268     1210    1   /**/ BUFSF = VECTOR(TEMP_BUF);

   1210  4 000010   000002 237000 5                  LDAQ    2
         4 000011   000000 755000 xsym               STA     BUFSF
         4 000012   000001 756000 xsym               STQ     BUFSF+1

      269     1211    1   /**/ BUFLNSF = 132;

   1211  4 000013   000204 235007                    LDA     132,DL
         4 000014   000000 755000 xsym               STA     BUFLNSF

      270     1212    1   READ_DI:
      271     1213    1       CALL SYS_FUNC_READ ALTRET(ALT_READDIR);

   1213  4 000015   000001 631400 5     READ_DI      EPPR1   1
         4 000016   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 000017   000134 702000 4                  TSX2    ALT_READDIR

      272     1214    1       CNT=DCBADDR(DCBSF)->F$DCB.ARS# ;

   1214  4 000020   000004 470400 5                  LDP0    4
         4 000021   000000 471500                    LDP1    0,,PR0
         4 000022   000000 220000 xsym               LDX0    DCBSF
         4 000023   100000 473510                    LDP3    0,X0,PR1
         4 000024   300000 235100                    LDA     0,,PR3
         4 000025   000000 755000 xsym               STA     CNT

PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:56   
      273     1215    1       IF CNT = 0 OR TEMP_BUF = ' ' THEN

   1215  4 000026   000015 600000 4                  TZE     READ_DI
         4 000027   040000 106400                    CMPC    fill='040'O
         4 000030   000000 000204 0                  ADSC9   TEMP_BUF                 cn=0,n=132
         4 000031   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000032   000015 600000 4                  TZE     READ_DI

      274     1216    1           GOTO READ_DI;
      275     1217    1       LEN = CNT-1; /* Initialize length of input */

   1217  4 000033   000001 135007                    SBLA    1,DL
         4 000034   000042 755000 0                  STA     LEN

      276     1218    1       RBUF.TEXT=TEMP_BUF;

   1218  4 000035   040000 100400                    MLR     fill='040'O
         4 000036   000000 000204 0                  ADSC9   TEMP_BUF                 cn=0,n=132
         4 000037   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256

      277     1219
      278     1220         /*     Look for and handle continuation of input apart from parser */
      279     1221    2       DO WHILE (SUBSTR(TEMP_BUF,CNT-1,1) = ';');

   1221  4 000040   000122 710000 4                  TRA     s:1238

      280     1222    2           TEMP_BUF = ' '; /* Prepare to read next line in temp storage */

   1222  4 000041   040000 100400                    MLR     fill='040'O
         4 000042   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000043   000000 000204 0                  ADSC9   TEMP_BUF                 cn=0,n=132

      281     1223    2           CALL M$PROMPT(FPT_PROMPT);

   1223  4 000044   000044 630400 0                  EPPR0   FPT_PROMPT
         4 000045   160002 713400                    CLIMB   57346
         4 000046   401000 401760                    pmme    nvectors=3
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:57   

      282     1224    2           CALL SYS_FUNC_READ ALTRET(ALT_READDIR);

   1224  4 000047   000001 631400 5                  EPPR1   1
         4 000050   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 000051   000134 702000 4                  TSX2    ALT_READDIR

      283     1225    2           CNT = DCBADDR(DCBSF)->F$DCB.ARS# ;/* Set counter = input size */

   1225  4 000052   000004 470400 5                  LDP0    4
         4 000053   000000 471500                    LDP1    0,,PR0
         4 000054   000000 220000 xsym               LDX0    DCBSF
         4 000055   100000 473510                    LDP3    0,X0,PR1
         4 000056   300000 235100                    LDA     0,,PR3
         4 000057   000000 755000 xsym               STA     CNT

      284     1226    2           IF CNT = 0 THEN

   1226  4 000060   000066 601000 4                  TNZ     s:1231

      285     1227    3           DO; /*  Handle null input as a continuation */

      286     1228    3               TEMP_BUF = ';';

   1228  4 000061   040000 100400                    MLR     fill='040'O
         4 000062   000005 000001 5                  ADSC9   5                        cn=0,n=1
         4 000063   000000 000204 0                  ADSC9   TEMP_BUF                 cn=0,n=132

      287     1229    3               CNT = 1;

   1229  4 000064   000001 236007                    LDQ     1,DL
         4 000065   000000 756000 xsym               STQ     CNT

      288     1230    3               END;

      289     1231    2           CALL INSERT(RBUF.TEXT,LEN,CNT+1,' ',CONCAT_BUF) ALTRET (ALT_INSRT);

PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:58   
   1231  4 000066   000000 721000 xsym               LXL1    CNT
         4 000067   000001 622011                    EAX2    1,X1
         4 000070   000042 235000 0                  LDA     LEN
         4 000071   040045 100400                    MLR     fill='040'O
         4 000072   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000073   000000 000012 xsym               ADSC9   RBUF,A                   cn=0,n=*X2
         4 000074   000000 236000 xsym               LDQ     CNT
         4 000075   000000 116003                    CMPQ    0,DU
         4 000076   000137 604400 4                  TMOZ    ALT_INSRT
         4 000077   000041 474400 0                  LDP4    CAT$
         4 000100   000000 623006                    EAX3    0,QL
         4 000101   000000 724000 xsym               LXL4    CNT
         4 000102   040045 100540                    MLR     fill='040'O
         4 000103   400000 000013                    ADSC9   0,,PR4                   cn=0,n=*X3
         4 000104   000000 200014 xsym               ADSC9   RBUF,A                   cn=1,n=*X4
         4 000105   000000 236000 xsym               LDQ     CNT
         4 000106   000011 402007                    MPY     9,DL
         4 000107   200004 756100                    STQ     4,,AUTO
         4 000110   200004 116100                    CMPQ    4,,AUTO
         4 000111   000137 604000 4                  TMI     ALT_INSRT

      290     1232    2           LEN = LEN + CNT ;

   1232  4 000112   000042 236000 0                  LDQ     LEN
         4 000113   000000 036000 xsym               ADLQ    CNT
         4 000114   000042 756000 0                  STQ     LEN

      291     1233    2           IF LEN > 256 THEN /* Prevent overfill of buffer*/

   1233  4 000115   000400 116007                    CMPQ    256,DL
         4 000116   000122 604400 4                  TMOZ    s:1238

      292     1234    3           DO;

      293     1235    3               READ_SW=2;

   1235  4 000117   000002 235007                    LDA     2,DL
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:59   
         4 000120   000000 755000 xsym               STA     READ_SW

      294     1236    3               ALTRETURN;

   1236  4 000121   000000 702200 xent               TSX2  ! X66_AALT

      295     1237    3               END;
      296     1238    2           END;

   1238  4 000122   000000 235000 xsym               LDA     CNT
         4 000123   040000 106405                    CMPC    fill='040'O
         4 000124   777777 600001 0                  ADSC9   FPT_PROMPT-37,A          cn=3,n=1
         4 000125   000005 000001 5                  ADSC9   5                        cn=0,n=1
         4 000126   000041 600000 4                  TZE     s:1222

      297     1239    1       CNT = LEN + 1; /* Reset cnt for use by parser */

   1239  4 000127   000042 236000 0                  LDQ     LEN
         4 000130   000001 036007                    ADLQ    1,DL
         4 000131   000000 756000 xsym               STQ     CNT

      298     1240    1       READ_SW = 0;

   1240  4 000132   000000 450000 xsym               STZ     READ_SW

      299     1241    1       RETURN;

   1241  4 000133   000000 702200 xent               TSX2  ! X66_ARET

      300     1242
      301     1243    1   ALT_READDIR:
      302     1244    1       READ_SW=1;

   1244  4 000134   000001 235007       ALT_READDIR  LDA     1,DL
         4 000135   000000 755000 xsym               STA     READ_SW

      303     1245    1       ALTRETURN;
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:60   

   1245  4 000136   000000 702200 xent               TSX2  ! X66_AALT

      304     1246    1   ALT_INSRT:
      305     1247    1       READ_SW=2;

   1247  4 000137   000002 235007       ALT_INSRT    LDA     2,DL
         4 000140   000000 755000 xsym               STA     READ_SW

      306     1248    1       ALTRETURN;

   1248  4 000141   000000 702200 xent               TSX2  ! X66_AALT

TEMP_BUF
 Sect OctLoc
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

CAT$
 Sect OctLoc
   0     041   000000 006000                                                    ....

FPT_PROMPT
 Sect OctLoc
   0     044   000003 777640   000052 006000   000000 177640   000000 006014    .....*..........
   0     050   000000 177640   000000 206000   000000 000000   000000 000000    ................
   0     054   000000 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   5     000   040040 040040   000000 000000   000040 777640   000000 006000        ..... ......
   5     004   000000 006003   073040 040040                                    ....;
      307     1249    1   END READDIR;
      308     1250        %EOD;

PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:61   
--  Include file information  --

   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure READDIR.

   Procedure READDIR requires 98 words for executable code.
   Procedure READDIR requires 6 words of local(AUTO) storage.
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:62   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:63   
          MINI XREF LISTING

ALT_INSRT
      1247**LABEL    1231--CALLALT
ALT_READDIR
      1244**LABEL    1213--CALLALT  1224--CALLALT
BUFLNSF
       851**DCL      1211<<ASSIGN
BUFSF
       852**DCL      1210<<ASSIGN
CAT$
        11**DCL        12--IMP-PTR  1231>>CALLBLT
CNT
       925**DCL        12--IMP-SIZ  1214<<ASSIGN   1215>>IF       1217>>ASSIGN   1221>>DOWHILE  1225<<ASSIGN
      1226>>IF       1229<<ASSIGN   1231>>CALLBLT  1231>>CALLBLT  1232>>ASSIGN   1239<<ASSIGN
CONCAT_BUF
        12**DCL      1231>>CALLBLT
COUNTSF
       902**DCL       903--REDEF
DCBSF
       831**DCL      1209<<ASSIGN   1214--ASSIGN   1225--ASSIGN
ENCRP_SEEDSF
       860**DCL       861--REDEF
ERRCODESF
       862**DCL       867--REDEF
F$DCB.ACTPOS
      1155**DCL      1155--REDEF
F$DCB.ARS#
      1129**DCL      1129--REDEF    1214>>ASSIGN   1225>>ASSIGN
F$DCB.ATTR
      1148**DCL      1149--REDEF
F$DCB.BORROW
      1163**DCL      1163--REDEF    1163--REDEF    1163--REDEF
F$DCB.DCBNAME.L
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:64   
      1177**DCL      1177--IMP-SIZ
F$DCB.EOMCHAR#
      1133**DCL      1133--REDEF
F$DCB.FLDID
      1158**DCL      1158--REDEF
F$DCB.FORM$
      1152**DCL      1152--REDEF
F$DCB.FSECT
      1168**DCL      1168--REDEF
F$DCB.FSN#
      1145**DCL      1145--REDEF    1145--REDEF    1146--REDEF
F$DCB.HEADER$
      1151**DCL      1151--REDEF
F$DCB.IXTNSIZE#
      1149**DCL      1149--REDEF
F$DCB.LASTSTA$
      1138**DCL      1138--REDEF
F$DCB.LVL
      1164**DCL      1164--REDEF
F$DCB.NAME#.C
      1139**DCL      1139--REDEF
F$DCB.NOEOF
      1161**DCL      1161--REDEF
F$DCB.NRECS#
      1150**DCL      1150--REDEF
F$DCB.NRECX
      1169**DCL      1169--REDEF
F$DCB.OHDR
      1161**DCL      1161--REDEF
F$DCB.ORG#
      1144**DCL      1144--REDEF
F$DCB.PRECNO
      1167**DCL      1167--REDEF
F$DCB.RCSZ
      1173**DCL      1173--REDEF
F$DCB.RES#
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:65   
      1140**DCL      1140--REDEF
F$DCB.SETX
      1152**DCL      1152--REDEF
F$DCB.TAB$
      1152**DCL      1152--REDEF
F$DCB.TDA
      1166**DCL      1167--REDEF
F$DCB.WSN#
      1140**DCL      1140--REDEF
FIDSF_RD
       878**DCL       879--REDEF
FPT_PROMPT
      1195**DCL      1223<>CALL
FPT_PROMPT.V
      1203**DCL      1197--DCLINIT
HELPCODE
       896**DCL       901--REDEF
ICHKSUM
       961**DCL       962--REDEF
I_O_BUF$
       939**DCL       940--IMP-PTR
KEYVSF
       834**DCL       839--REDEF
KEYVSF.WD_ONE
       836**DCL       837--REDEF
LEN
        15**DCL      1217<<ASSIGN   1231>>CALLBLT  1232<<ASSIGN   1232>>ASSIGN   1233>>IF       1239>>ASSIGN
M$PROMPT
        55**DCL-ENT  1223--CALL
M$SI
        19**DCL      1209>>ASSIGN
MSGCODE
       868**DCL       869--REDEF
PRMPT_CHAR.PMPT
        18**DCL      1201--DCLINIT
RBUF.TEXT
PL6.E3A0      #002=READDIR File=ZIU$Q2DI.:ZIC0TSI                                FRI 09/05/97 13:20 Page:66   
         8**DCL      1218<<ASSIGN   1231<<CALLBLT
READ_DI
      1213**LABEL    1216--GOTO
READ_SW
        14**DCL      1235<<ASSIGN   1240<<ASSIGN   1244<<ASSIGN   1247<<ASSIGN
REC$
       920**DCL       943--IMP-PTR
REC_DATA_LN
       948**DCL       947--IMP-SIZ
SYS_FUNC_READ
        20**DCL-ENT  1213--CALL     1224--CALL
TEMP_BUF
         9**DCL        11--DCLINIT  1208<<ASSIGN   1210--ASSIGN   1215>>IF       1218>>ASSIGN   1221>>DOWHILE
      1222<<ASSIGN   1228<<ASSIGN

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:67   
      309        1        /*T***********************************************************/
      310        2        /*T*                                                         */
      311        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      312        4        /*T*                                                         */
      313        5        /*T***********************************************************/
      314        6        INTERPRTR: PROC(OUT$BLK) ALTRET;
      315        7        /* Interprtrting procedure called upon successful return from */
      316        8        /* Parse.  Displays ininterprtrion in PARSE.OUT->OUT$BLK     */
      317        9
      318       10    1   DCL Q UBIN WORD;
      319       11        %INCLUDE ZI$DIR;
      320      168        %DIR;
      321      312        %SUB ZI_DIR=ZI$DIR; /* TEMP SOLUTION CKL */
      322      313        %INCLUDE ZI_GLOBAL_DBUTIL;
      323      491         %SYS_FUNC;
      324      583         %MISC_DCLS;
      325      636         %INCLUDE XU_MACRO_C;
      326     3742         %INCLUDE XU_SUBS_C;
      327     3834         %INCLUDE B$JIT;
      328     4124         %INCLUDE CP_6;
      329     4205         %VLP_NAME(FPTN=DBUTILX,
      330     4206         NAME='DBUTIL');
      331     4233         %INCLUDE CP_6_SUBS;
      332     4773         %INCLUDE ZI_PRSE_SUBS;
      333     4929         %INCLUDE ZI_ERRORS_SUBS;
      334     5449         %INCLUDE XUH_MACRO_C;
      335     5533         %XUH_PARAM(NAME=HELP_PARAM,
      336     5534         PROCNAME=DBUTILX,
      337     5535         OUTDCB1=M$LO);
      338     5596
      339     5597         %PARSE$OUT(STCLASS=" ");
      340     5642    1   DCL X$HELP ENTRY(1) ALTRET;
      341     5643    1   DCL ACCTNAME CHAR(8) STATIC INIT(':SYS');
      342     5644    1   DCL READDIR ENTRY ALTRET;
      343     5645    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      344     5646    1   DCL READ_SW UBIN(36) SYMREF;
      345     5647    1   DCL INIT_RG_TEMP UBIN(36) STATIC ALIGNED;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:68   
      346     5648    1   DCL KEY_RNG_TEMP UBIN(36) STATIC ALIGNED;
      347     5649    1   DCL
      348     5650    1    1 USER_SYSID SYMREF ALIGNED,
      349     5651    1    2 CNT UBIN BYTE UNAL,
      350     5652    1    2 TEXT CHAR(7) UNAL;
      351     5653
      352     5654    1   DCL 1 IDS_STATEMENT CONSTANT ALIGNED,
      353     5655    1         2 * UBIN BYTE INIT(16) UNAL,
      354     5656    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 0 */
      355     5657    1         2 * UBIN BYTE INIT(6) UNAL,
      356     5658    1         2 * CHAR(19) INIT('ACCEPT') UNAL, /* 1 */
      357     5659    1         2 * UBIN BYTE INIT(7) UNAL,
      358     5660    1         2 * CHAR(19) INIT('CONNECT') UNAL, /* 2 */
      359     5661    1         2 * UBIN BYTE INIT(10) UNAL,
      360     5662    1         2 * CHAR(19) INIT('DISCONNECT') UNAL, /* 3 */
      361     5663    1         2 * UBIN BYTE INIT(5) UNAL,
      362     5664    1         2 * CHAR(19) INIT('ERASE') UNAL, /* 4 */
      363     5665    1         2 * UBIN BYTE INIT(4) UNAL,
      364     5666    1         2 * CHAR(19) INIT('FIND') UNAL, /* 5 */
      365     5667    1         2 * UBIN BYTE INIT(6) UNAL,
      366     5668    1         2 * CHAR(19) INIT('FINISH') UNAL, /* 6 */
      367     5669    1         2 * UBIN BYTE INIT(16) UNAL,
      368     5670    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 7 */
      369     5671    1         2 * UBIN BYTE INIT(3) UNAL,
      370     5672    1         2 * CHAR(19) INIT('GET') UNAL, /* 8 */
      371     5673    1         2 * UBIN BYTE INIT(2) UNAL,
      372     5674    1         2 * CHAR(19) INIT('IF') UNAL, /* 9 */
      373     5675    1         2 * UBIN BYTE INIT(16) UNAL,
      374     5676    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 10 */
      375     5677    1         2 * UBIN BYTE INIT(6) UNAL,
      376     5678    1         2 * CHAR(19) INIT('MODIFY') UNAL, /* 11 */
      377     5679    1         2 * UBIN BYTE INIT(16) UNAL,
      378     5680    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 12 */
      379     5681    1         2 * UBIN BYTE INIT(5) UNAL,
      380     5682    1         2 * CHAR(19) INIT('READY') UNAL, /* 13 */
      381     5683    1         2 * UBIN BYTE INIT(16) UNAL,
      382     5684    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 14 */
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:69   
      383     5685    1         2 * UBIN BYTE INIT(5) UNAL,
      384     5686    1         2 * CHAR(19) INIT('STORE') UNAL, /* 15 */
      385     5687    1         2 * UBIN BYTE INIT(16) UNAL,
      386     5688    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 16 */
      387     5689    1         2 * UBIN BYTE INIT(16) UNAL,
      388     5690    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 17 */
      389     5691    1         2 * UBIN BYTE INIT(3) UNAL,
      390     5692    1         2 * CHAR(19) INIT('HIA') UNAL, /* 18 */
      391     5693    1         2 * UBIN BYTE INIT(9) UNAL,
      392     5694    1         2 * CHAR(19) INIT('ROLL BACK') UNAL; /* 19 */
      393     5695    1   DCL 1 IDS_STMT(0:19) REDEF IDS_STATEMENT ALIGNED,
      394     5696    1         2 * UBIN BYTE UNAL, /* TEXT CNT */
      395     5697    1         2 * CHAR(19) UNAL; /* TEXT OF STATEMENT */
      396     5698
      397     5699         %PARSE$OUT(NAME=OUT$BLKX,STCLASS=BASED);
      398     5744         %PARSE$SYM(STCLASS=BASED);
      399     5782        %EJECT;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:70   
      400     5783        /*
      401     5784            ***       Begin procedure
      402     5785        */
      403     5786    1       IF OUT$BLK.CODE > 1 AND
      404     5787    1          OUT$BLK.CODE <= 30 THEN
      405     5788    1           ZI_DIR.CODE = OUT$BLK.CODE; /* Store utility called for*/
      406     5789    2       DO CASE(OUT$BLK.CODE);
      407     5790    2       CASE(#STOP); /* End or quit directive */
      408     5791    2           READ_SW = 3; /* 3 = end to ziu$q2ut routine */
      409     5792    2       CASE(#INIT); /* Initialize */
      410     5793    2           ZI_DIR.INITL = '1'B;
      411     5794    2           ZI_DIR.SCHEMA_NEEDED = '1'B;
      412     5795
      413     5796    2       CASE(#CRPT_SEED); /* Extract encrpt seed if any */
      414     5797    2           CALL OCTBIN(ADDR(OUT$BLK) -> OUT$SYM.COUNT);
      415     5798    2           ZI_DIR.ENCP_SEED_RD = KEY_RNG_TEMP;
      416     5799
      417     5800    2       CASE(#DEST_SEED); /* Extract destination seed */
      418     5801    2           CALL OCTBIN(ADDR(OUT$BLK) -> OUT$SYM.COUNT);
      419     5802    2           ZI_DIR.DEST_SEED_RD = KEY_RNG_TEMP;
      420     5803
      421     5804    2       CASE(#AREADCB); /* Extract area dcb name */
      422     5805    2           ZI_DIR.AREA_NM.NAME.TEXT=ADDR(OUT$BLK)->OUT$SYM.TEXT;
      423     5806    2           ZI_DIR.AREAFID = ' '; /* Blank out fid name in case of
      424     5807         non-use (same for ZI$DIR.SCHFID) */
      425     5808    2           IF ZI_DIR.AREA_NM.NAME.TEXT = 'ALL' THEN
      426     5809    3           DO;
      427     5810    3               ZI_DIR.AUTODUMP = '1'B;
      428     5811    3               ZI_DIR.SCHEMA_NEEDED = '1'B;
      429     5812    3               ZI$DIR.CHECK_ALL = '1'B;
      430     5813    3               END;
      431     5814
      432     5815    2       CASE(#SCHEDCB); /*  Extract schema dcb name */
      433     5816    2           ZI_DIR.SCHEMA_NM.NAME.TEXT=ADDR(OUT$BLK)->OUT$SYM.TEXT;
      434     5817    2           ZI_DIR.SCHFID = ' '; /* blanked in case of non-use */
      435     5818    2           ZI_DIR.SCHEMA_NEEDED = '1'B;
      436     5819
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:71   
      437     5820    2       CASE(#RNGLIST); /* Range list specified ?? */
      438     5821    2           ZI_DIR.RNG_LIST='1'B;
      439     5822         /*        ICNT=ICNT+1; */
      440     5823
      441     5824    2       CASE(#LOW_RNG); /* Extract low range (RNG1)*/
      442     5825    2           ICNT=ICNT+1;
      443     5826    2           CALL CHARBIN(INIT_RG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);
      444     5827    2           INIT_RG.FIRNG(ICNT)=INIT_RG_TEMP;
      445     5828    2           INIT_RG.SECRNG(ICNT)=INIT_RG_TEMP;
      446     5829
      447     5830    2       CASE(#HI_RNGE); /* Extract upper range (RNG2) */
      448     5831    2           CALL CHARBIN(INIT_RG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);
      449     5832    2           INIT_RG.SECRNG(ICNT)=INIT_RG_TEMP;
      450     5833         /*        ICNT=ICNT+1; */
      451     5834
      452     5835    2       CASE(#ENCRPT); /* Is encrpt specified ? ? */
      453     5836    2           ZI_DIR.ENCRPT='1'B;
      454     5837
      455     5838    2       CASE(#TMLT_KYS); /*Allocate n keys for template area*/
      456     5839    2           CALL CHARBIN(ZI_DIR.INIT_TMPLT_KEY,ADDR(OUT$BLK)->OUT$SYM.TEXT);
      457     5840
      458     5841    2       CASE(#PRINT); /*  Print command block */
      459     5842    2           ZI_DIR.PRINT='1'B;
      460     5843    2           ZI_DIR.SCHEMA_NEEDED = '1'B;
      461     5844
      462     5845    2       CASE(#REC_OPT); /*  Are print options in effect?? */
      463     5846    2           ZI_DIR.PRNT_OPT='1'B;
      464     5847
      465     5848    2       CASE(#KEY_LST); /*  key list specified */
      466     5849    2           ZI_DIR.PRNT_OPT ='1'B;
      467     5850
      468     5851    2       CASE(#LOW_KEY); /* Find first key specified */
      469     5852    2           KCNT=KCNT+1;
      470     5853    2           IF OUT$BLK.NDTYPE = %OCT# THEN
      471     5854    2               CALL OCTBIN(ADDR(OUT$BLK)->OUT$SYM.COUNT);
      472     5855    2           ELSE
      473     5856    2               CALL CHARBIN(KEY_RNG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:72   
      474     5857    2           KEY_RNG.FIR(KCNT)=KEY_RNG_TEMP;
      475     5858    2           KEY_RNG.SEC(KCNT)=KEY_RNG_TEMP;
      476     5859
      477     5860    2       CASE(#HI_KEY); /*  extract high key and check it */
      478     5861    2           IF OUT$BLK.NDTYPE = %OCT# THEN
      479     5862    2               CALL OCTBIN(ADDR(OUT$BLK)->OUT$SYM.COUNT);
      480     5863    2           ELSE
      481     5864    2               CALL CHARBIN(KEY_RNG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);
      482     5865    2           KEY_RNG.SEC(KCNT)=KEY_RNG_TEMP;
      483     5866    2       CASE(#REC_LST);
      484     5867    2           RCNT=RCNT+1;
      485     5868    2           RECORD_LIST.NAME(RCNT)=ADDR(OUT$BLK)->OUT$SYM.TEXT;
      486     5869    2       CASE(#SET_LST);
      487     5870    2           SCNT = SCNT+1;
      488     5871    2           SET_LIST.NAME(SCNT) = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      489     5872
      490     5873    2       CASE(#REP_OVER);
      491     5874    2           ZI_DIR.REP_OVER = '1'B;
      492     5875    2       CASE(#RELOC);
      493     5876    2           ZI_DIR.RELOC = '1'B;
      494     5877    2       CASE(#RETLST);
      495     5878    2           RETCNT = RETCNT +1;
      496     5879    2           RETAIN_LIST.NAME(RETCNT) = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      497     5880    2       CASE(#VIA,#CALC,#ALL);
      498     5881    2           ZI_DIR.RELOC_FUNC = OUT$BLK.CODE;
      499     5882    2       CASE(#RESTR);
      500     5883    2           ZI_DIR.RESTR = '1'B;
      501     5884    2       CASE(#DMPID);
      502     5885    2           DMPCNT = DMPCNT + 1;
      503     5886    2           DUMP_FID.NAME(DMPCNT) = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      504     5887
      505     5888    2       CASE(#ITM_LST);
      506     5889    2           ITMCNT = ITMCNT +1;
      507     5890    2           ITEM_LIST.NAME(ITMCNT) = ADDR(OUT$BLK) -> OUT$SYM.TEXT;
      508     5891    2           ITEM_LIST.TYPE(ITMCNT) = RCNT; /* Store owner rec num */
      509     5892
      510     5893    2       CASE(#INV_RBD) /*Inventory page rebuild*/;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:73   
      511     5894    2           ZI_DIR.INVREBLD = '1'B;
      512     5895
      513     5896    2       CASE(#DUMP); /* Dump command block */
      514     5897    2           ZI_DIR.UNLOAD = '1'B; /* Set dump flag on */
      515     5898
      516     5899    2       CASE(#SRCEDCB); /*  Extract the source file for command */
      517     5900    2           ZI_DIR.SRCE_NM.NAME.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      518     5901    2           ZI_DIR.SRCEFID = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      519     5902
      520     5903    2       CASE(#DESTDCB); /* Extract the destination file */
      521     5904    2           ZI_DIR.DEST_NM.NAME.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      522     5905    2           ZI_DIR.DESTFID = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      523     5906
      524     5907    2       CASE(#ON_OPT); /* Copy option = 'TO',on */
      525     5908    2           ZI_DIR.OPEN_MODE = %ERROR#;
      526     5909    2       CASE(#IN_OPT);
      527     5910    2           IF ZI_DIR.UNLOAD THEN
      528     5911    3           DO;
      529     5912         /*E* ERROR: ZIU-02026-C
      530     5913                  MESSAGE: INTO option not permitted in DUMP directive. */
      531     5914    3    /**/       ERRCODESF.ERR#=2026;
      532     5915    3    /**/       MSGCODE = ERRCODE_RDEF;
      533     5916    3               ALTRETURN;
      534     5917    3               END;
      535     5918    2           ZI_DIR.OPEN_MODE = %OLDFILE#;
      536     5919
      537     5920    2       CASE(#OV_OPT); /* Copy option = 'OVER' */
      538     5921    2           ZI_DIR.OPEN_MODE = %NEWFILE#;
      539     5922
      540     5923
      541     5924    2       CASE(#LOAD); /* Load data base comnd */
      542     5925    2           ZI_DIR.LOAD = '1'B; /*Set load flag */
      543     5926
      544     5927    2       CASE(#KEYRBLD); /*Rebuild key file command*/
      545     5928    2           ZI_DIR.KEYBLD = '1'B;
      546     5929    2           ZI_DIR.SCHEMA_NEEDED = '1'B;
      547     5930
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:74   
      548     5931    2       CASE(#HELP_IDS);
      549     5932    2           CALL CHARBIN(INIT_RG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);
      550     5933    2           X=INIT_RG_TEMP/100000; /* GET THE STATEMENT CODE */
      551     5934    2           IF X>19 THEN X=0; /* IN CASE ILLEGAL STATEMENT CODE */
      552     5935    2           ERR_INSERT(1)=IDS_STMT(X); /* TEXTC OF STATMENT */
      553     5936    2           X=MOD(INIT_RG_TEMP,100000); /* GET LAST 5 DIGITS */
      554     5937    2           X=X/10000; /* GET THE 1ST DIGIT IN THE LAST 5 DIGITS */
      555     5938    2           ERRCODESF.ERR#=MOD(INIT_RG_TEMP,10000); /* LAST 4 DIGIT */
      556     5939    2           ERRFLGSF = 0; /* NO NEED OF STARS */
      557     5940    2           INCL_ERR='0'B;
      558     5941    2           MSGCODE = ERRCODE_RDEF;
      559     5942    2           MONITOR_ERR.FN_CODE=%BITBIN('321160'O)+X;
      560     5943    2           SUBMESSF='0'B;
      561     5944    2           CALL SYS_FUNC_ERRMSG ALTRET(NO_IDS_MSG);
      562     5945
      563     5946    2       CASE(#ACNTLIST);
      564     5947    2           ZI_DIR.ACNTLIST = '1'B;
      565     5948
      566     5949    2       CASE(#HELP);
      567     5950    2           HELP_PARAM.PROCACCT_ = VECTOR(ACCTNAME);
      568     5951    2           HELP_PARAM.HELP$ = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;
      569     5952    2           CALL X$HELP(HELP_PARAM) ALTRET(ALT_HELP);
      570     5953    2       CASE(#QUES);
      571     5954    2           HELP_PARAM.MORE# = '1'B;
      572     5955    2           CALL X$HELP(HELP_PARAM) ALTRET(ALT_HELP);
      573     5956    2       CASE(#DQUES);
      574     5957    2           HELP_PARAM.ALL# = '1'B;
      575     5958    2           CALL X$HELP(HELP_PARAM) ALTRET(ALT_HELP);
      576     5959
      577     5960    2       CASE(#ACCNTS);
      578     5961    2           ACNT_IDX = ACNT_IDX +1;
      579     5962    2           ZI_DIR.ACNT(ACNT_IDX) = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      580     5963
      581     5964    2       CASE(#DATE);
      582     5965    2           ZI_DIR.DATEFLG = '1'B;
      583     5966    2           ZI_DIR.DATEIN = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      584     5967    2           ZI_DIR.TIMEIN = '00000000';
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:75   
      585     5968    2           IF ZI_DIR.DATE.YR < '00' OR ZI_DIR.DATE.YR > '99' THEN
      586     5969    2               ZI_DIR.DATEFLG = '0'B;
      587     5970    2           IF ZI_DIR.DATE.MO < '01' OR ZI_DIR.DATE.MO > '12' THEN
      588     5971    2               ZI_DIR.DATEFLG = '0'B;
      589     5972    2           IF ZI_DIR.DATE.DY < '01' OR ZI_DIR.DATE.DY > '31' THEN
      590     5973    2               ZI_DIR.DATEFLG = '0'B;
      591     5974    2           IF ZI_DIR.DATEFLG = '0'B THEN
      592     5975    3           DO;
      593     5976         /*E* ERROR: ZIU-02002-C
      594     5977              MESSAGE: Improper date specification; format= "yymmdd". */
      595     5978    3    /**/       ERRCODESF.ERR#=2002;
      596     5979    3    /**/       MSGCODE = ERRCODE_RDEF;
      597     5980    3               ALTRETURN;
      598     5981    3               END;
      599     5982
      600     5983    2       CASE(#HOUR);
      601     5984    2           ZI_DIR.TIMEIN = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      602     5985    2           IF ZI_DIR.TIME.HR > '23' OR ZI_DIR.TIME.HR < '00' THEN
      603     5986    2               ZI_DIR.DATEFLG = '0'B;
      604     5987    2           IF ZI_DIR.TIME.MIN > '59' OR ZI_DIR.TIME.MIN < '00' THEN
      605     5988    2               ZI_DIR.DATEFLG = '0'B;
      606     5989    2           IF ZI_DIR.TIME.SEC > '59' OR ZI_DIR.TIME.SEC < '00' THEN
      607     5990    2               ZI_DIR.DATEFLG = '0'B;
      608     5991    2           ZI_DIR.TIME.MIL = '00';
      609     5992    2           IF ZI_DIR.DATEFLG = '0'B THEN
      610     5993    3           DO;
      611     5994         /*E* ERROR: ZIU-02001-C
      612     5995               MESSAGE: Improper time specification; format= "hhmmss". */
      613     5996    3    /**/       ERRCODESF.ERR#=2001;
      614     5997    3    /**/       MSGCODE = ERRCODE_RDEF;
      615     5998    3               ALTRETURN;
      616     5999    3               END;
      617     6000    2       CASE(#NKEY);
      618     6001    2           ZI_DIR.NOKEYS = '1'B;
      619     6002    2       CASE(#NPNT);
      620     6003    2           ZI_DIR.NOPRNT = '1'B;
      621     6004    2       CASE(#ITEM);
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:76   
      622     6005    2           ZI_DIR.PITEM = '0'B;
      623     6006    2       CASE(#NSET);
      624     6007    2           ZI_DIR.PSETS = '0'B;
      625     6008    2       CASE(#PHEAD);
      626     6009    2           ZI_DIR.PHEAD2 = '0'B;
      627     6010    2       CASE(#FSET);
      628     6011    2           IF KCNT = -1 THEN /* NO DBK SPECIFIED IN FSET */
      629     6012    3           DO;
      630     6013         /*E* ERROR: ZIU-02028-C
      631     6014                           MESSAGE: At least one DBK must be specified
      632     6015                                   when using the FOLLOW SET option. */
      633     6016    3    /**/       ERRCODESF.ERR# = 2028;
      634     6017    3    /**/       MSGCODE = ERRCODE_RDEF;
      635     6018    3               ALTRETURN;
      636     6019    3               END;
      637     6020    2           ZI_DIR.FSET = '1'B;
      638     6021    2           ZI_DIR.SET_NM = OUT$BLK.SUBLK$(0)-> OUT$SYM.TEXT;
      639     6022    2       CASE(#LOCALKEY);
      640     6023    2           ZI_DIR.LOCALKEY = '1'B;
      641     6024    2       CASE(#ROLL);
      642     6025    2           ZI_DIR.ROLL = '1'B;
      643     6026    2       CASE(#REM);
      644     6027    2           ZI_DIR.POS = %REM#;
      645     6028    2       CASE(#REL);
      646     6029    2           ZI_DIR.POS = %REL#;
      647     6030    2       CASE(#REW);
      648     6031    2           ZI_DIR.POS = %PTV#;
      649     6032
      650     6033    2       CASE(#IBEX_SET,#IBEX_RESET,#IBEX_DISPLAY);
      651     6034    2           ZI_DIR.SYSCTL = '1'B;
      652     6035
      653     6036    2       CASE(#LOCKOPT);
      654     6037    2           ZI_DIR.LOCKCODE = 2; /* SET LOCK OR UNLOCK OPTION ON */
      655     6038    2       CASE(#CHECK,#LOCK,#UNLOCK,#TESTLOCK);
      656     6039    2           ZI_DIR.SCHEMA_NEEDED = '1'B;
      657     6040    2       CASE(#USEROPT);
      658     6041    2           USER_SYSID.CNT = ADDR(OUT$BLK)->OUT$SYM.COUNT;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:77   
      659     6042    2           USER_SYSID.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      660     6043    2           CALL OCTBIN(ADDR(OUT$BLK)->OUT$SYM.COUNT);
      661     6044    2           INIT_RG.FIRNG(0) = KEY_RNG_TEMP * -1;
      662     6045    2           ZI_DIR.SYSID = INIT_RG.FIRNG(0);
      663     6046    2       CASE(#SYSOPT);
      664     6047    2           USER_SYSID.CNT = ADDR(OUT$BLK)->OUT$SYM.COUNT;
      665     6048    2           USER_SYSID.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      666     6049    2           CALL CHARBIN(ZI_DIR.SYSID,ADDR(OUT$BLK)->OUT$SYM.TEXT);
      667     6050    2       CASE(#EVRYOPT);
      668     6051    2           CALL CHARBIN(ZI_DIR.WAIT,ADDR(OUT$BLK)->OUT$SYM.TEXT);
      669     6052    2       CASE(#CHKOPT);
      670     6053    2           ZI_DIR.CHECK = '1'B; /* Turn on check option */
      671     6054    2           ZI_DIR.SCHEMA_NEEDED = '1'B;
      672     6055    2       CASE(#REP_REC);
      673     6056    2           ZI_DIR.REPRT_REC = %YES#;
      674     6057    2       CASE(#REP_AREA);
      675     6058    2           ZI_DIR.REPRT_AREA= %YES#;
      676     6059    2       CASE(#REPORT);
      677     6060    2           ZI_DIR.SCHEMA_NEEDED = %YES#;
      678     6061    2       CASE(#REP_ALL);
      679     6062    2           ZI_DIR.REPRT_ALL = %YES#;
      680     6063    2       CASE(#REP_PG);
      681     6064    2           ZI_DIR.REPRT_PG = %YES#;
      682     6065    2       CASE(#REP_ERRS);
      683     6066    2           ZI_DIR.REPRT_ERRS = %YES#;
      684     6067    2       CASE(#REP_ZERO);
      685     6068    2           ZI_DIR.REPRT_ZERO = %YES#;
      686     6069    2       CASE(#VALIDATE);
      687     6070    2           ZI_DIR.AUTODUMP = '1'B;
      688     6071        /*        CASE(#VAL_LST);
      689     6072                         RCNT = RCNT+1;
      690     6073                         RECORD_LIST.NAME(RCNT) = ADDR(OUT$BLK) -> OUT$SYM.TEXT;
      691     6074
      692     6075                  CASE(#NVAL_LST);
      693     6076                         ITMCNT = ITMCNT+1;
      694     6077                         ITEM_LIST.NAME(ITMCNT) = ADDR(OUT$BLK) ->  OUT$SYM.TEXT;
      695     6078                                                                    */
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:78   
      696     6079
      697     6080    2       CASE(#ALTKEY_OPT,#REP_PA);
      698     6081    2           ZI_DIR.ALTKEY = '1'B;
      699     6082    2       CASE(#ALTKEY);
      700     6083    2           ALTKY.VALUE = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      701     6084    2       CASE(#KEYNAME);
      702     6085    2           ALTKY.KEYNAME = ADDR(OUT$BLK)->OUT$SYM.TEXT;
      703     6086    2       CASE(#CALCKEY_OPT);
      704     6087    2           ZI_DIR.CALCKEY = %YES#;
      705     6088    2       CASE(#INV);
      706     6089    2           ZI_DIR.PRNT_INV = %YES#;
      707     6090    2       CASE(ELSE);
      708     6091    2           END;
      709     6092    1       IF OUT$BLK.NSUBLKS=0 THEN RETURN;
      710     6093    2       DO CASE(OUT$BLK.NDTYPE);
      711     6094    2       CASE(%DSTRING#,%NULL#,%OCT#,%DEC#,%ALPHA#,%ALNUM#,
      712     6095    2          %SYM#,%ASYM#,%FID#);
      713     6096    2           RETURN;
      714     6097    2       CASE(ELSE);
      715     6098    2           Q=0;
      716     6099    3           DO WHILE(Q < OUT$BLK.NSUBLKS);
      717     6100    3               CALL INTERPRTR(OUT$BLK.SUBLK$(Q)->OUT$BLKX) ALTRET(ALT_INTERP);
      718     6101    3               Q=Q+1;
      719     6102    3               END;
      720     6103    2           END;
      721     6104    1       RETURN;
      722     6105        %EJECT;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:79   
      723     6106    1   OCTBIN: PROC(TXTC);
      724     6107    2   DCL 1 TXTC UNAL,
      725     6108    2         2 SZ UBIN BYTE UNAL,
      726     6109    2         2 TX CHAR(TXTC.SZ) UNAL;
      727     6110    2   DCL OCHRS CHAR(8) CONSTANT INIT('01234567');
      728     6111
      729     6112    2       KEY_RNG_TEMP = 0;
      730     6113    3       DO I = 0 TO TXTC.SZ-1;
      731     6114
      732     6115    3           CALL INDEX1(X,SUBSTR(TXTC.TX,I,1),SUBSTR(OCHRS,0,8));
      733     6116    3           KEY_RNG_TEMP = (KEY_RNG_TEMP * 8) + X;
      734     6117    3           END;
      735     6118    2       RETURN;
      736     6119    2   END OCTBIN;
      737     6120    1   NO_IDS_MSG: ERRCODESF.ERR#=DBU#NO_IDS_MSG;
      738     6121    1       ERRFLGSF = 0;
      739     6122    1       MSGCODE = ERRCODE_RDEF;
      740     6123    1       ERR_INSERT.CNT(0)=ADDR(OUT$BLK)->OUT$SYM.COUNT;
      741     6124    1       ERR_INSERT.TEXT(0)=ADDR(OUT$BLK)->OUT$SYM.TEXT;
      742     6125    1       CALL SYS_FUNC_ERRMSG;
      743     6126    1       RETURN; /* TAKE NORMAL RETURN */
      744     6127        /*E*  ERROR: ZIU-DBU#NO_IDS_MSG-C
      745     6128        MESSAGE: The value %U1 is not a legal IDS status code.
      746     6129                 Check the value again to make sure you have the correct one.
      747     6130                       */
      748     6131    1   ALT_HELP:
      749     6132    1       HELPCODE = HELP_PARAM.ERR;
      750     6133    1       MSGCODE = HELPCODE_RDEF;
      751     6134    1   ALT_INTERP:
      752     6135    1       ALTRETURN;
      753     6136    1   END INTERPRTR;

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:80   
--  Include file information  --

   XUH_MACRO_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure INTERPRTR.

   Procedure INTERPRTR requires 845 words for executable code.
   Procedure INTERPRTR requires 10 words of local(AUTO) storage.

    No errors detected in file ZIU$Q2DI.:ZIC0TSI    .

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:81   

 Object Unit name= INTERPRTR                                  File name= ZIU$Q2DI.:ZIC0TOU
 UTS= SEP 05 '97 13:20:58.32 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$UC
    2   Data  even  none    64    100  INTERPRTR
    3  RoData even  UTS    111    157  INTERPRTR
    4   Proc  even  none   845   1515  INTERPRTR
    5  RoData even  none    15     17  INTERPRTR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  INTERPRTR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 SYS_FUNC_ERRMSG
 yes     yes           Std       1 X$HELP
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:82   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ZI$DIR                                SCHEMA_ACTIVE                         RECORD_LIST
     SET_LIST                              RETAIN_LIST                           DUMP_FID
     ALTKY                                 INIT_RG                               KEY_RNG
     ITEM_LIST                             BLKLSF                                KEYLSF
     KEYXSF                                DCBSF                                 ORGSF
     KEYSF                                 KEYVSF                                ACSSF
     NOTIMESF                              FUNSF                                 ASNSF
     TESTSF                                XTENSIZESF                            DISPSF
     WAITSF                                VFCSF                                 FULLSF
     BKUPSF                                BUFLNSF                               BUFSF
     SOURCESF                              DESTSF                                DATESF
     TIMESF                                UTSSF                                 DAYSF
     TSTAMPSF                              ENCRP_SEEDSF                          ERRCODESF
     MSGCODE                               INCL_ERR                              ERR_INSERT
     FIDSF_RD                              ACNT                                  EXISTSF
     SHARESF                               DCBNMSF                               KEYRSF
     NO_KEYSF                              REASGNSF                              CARRY_ATTRIBUTESF
     SUBMESSF                              SPKY_OPNSF                            POSSF
     ERRFLGSF                              MERGESF                               FSA_FLAG
     RELGSF                                UNUSED                                HELPCODE
     COUNTSF                               INDEXSF                               GAP
     PSNSF                                 ACNTSF                                KEY_SHADWSF
     REC$                                  RB                                    RE
     IE                                    IB                                    CNT
     ICNT                                  RCNT                                  SCNT
     FIRST_SET                             RETCNT                                DMPCNT
     KCNT                                  ACNT_IDX                              I
     J                                     K                                     X
     STEPCC                                I_O_BUF$                              OUT_INDX
     I_O_SIZE                              REC_DATA_LN                           M$LO
     B$TCB$                                B$ROS$                                B$JIT$
     KEYFID                                I_O_KEY                               RESTART
     BREAK_FLAG                            ICHKSUM                               ITMCNT
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:83   
     GAP1                                  M$UC                                  READ_SW
     USER_SYSID

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:84   


      309        1        /*T***********************************************************/
      310        2        /*T*                                                         */
      311        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      312        4        /*T*                                                         */
      313        5        /*T***********************************************************/
      314        6        INTERPRTR: PROC(OUT$BLK) ALTRET;

      6  4 000000   000000 700200 xent  INTERPRTR    TSX0  ! X66_AUTO_1
         4 000001   000012 000001                    ZERO    10,1

      315        7        /* Interprtrting procedure called upon successful return from */
      316        8        /* Parse.  Displays ininterprtrion in PARSE.OUT->OUT$BLK     */
      317        9
      318       10    1   DCL Q UBIN WORD;
      319       11        %INCLUDE ZI$DIR;
      320      168        %DIR;
      321      312        %SUB ZI_DIR=ZI$DIR; /* TEMP SOLUTION CKL */
      322      313        %INCLUDE ZI_GLOBAL_DBUTIL;
      323      491         %SYS_FUNC;
      324      583         %MISC_DCLS;
      325      636         %INCLUDE XU_MACRO_C;
      326     3742         %INCLUDE XU_SUBS_C;
      327     3834         %INCLUDE B$JIT;
      328     4124         %INCLUDE CP_6;
      329     4205         %VLP_NAME(FPTN=DBUTILX,
      330     4206         NAME='DBUTIL');
      331     4233         %INCLUDE CP_6_SUBS;
      332     4773         %INCLUDE ZI_PRSE_SUBS;
      333     4929         %INCLUDE ZI_ERRORS_SUBS;
      334     5449         %INCLUDE XUH_MACRO_C;
      335     5533         %XUH_PARAM(NAME=HELP_PARAM,
      336     5534         PROCNAME=DBUTILX,
      337     5535         OUTDCB1=M$LO);
      338     5596
      339     5597         %PARSE$OUT(STCLASS=" ");
      340     5642    1   DCL X$HELP ENTRY(1) ALTRET;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:85   
      341     5643    1   DCL ACCTNAME CHAR(8) STATIC INIT(':SYS');
      342     5644    1   DCL READDIR ENTRY ALTRET;
      343     5645    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      344     5646    1   DCL READ_SW UBIN(36) SYMREF;
      345     5647    1   DCL INIT_RG_TEMP UBIN(36) STATIC ALIGNED;
      346     5648    1   DCL KEY_RNG_TEMP UBIN(36) STATIC ALIGNED;
      347     5649    1   DCL
      348     5650    1    1 USER_SYSID SYMREF ALIGNED,
      349     5651    1    2 CNT UBIN BYTE UNAL,
      350     5652    1    2 TEXT CHAR(7) UNAL;
      351     5653
      352     5654    1   DCL 1 IDS_STATEMENT CONSTANT ALIGNED,
      353     5655    1         2 * UBIN BYTE INIT(16) UNAL,
      354     5656    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 0 */
      355     5657    1         2 * UBIN BYTE INIT(6) UNAL,
      356     5658    1         2 * CHAR(19) INIT('ACCEPT') UNAL, /* 1 */
      357     5659    1         2 * UBIN BYTE INIT(7) UNAL,
      358     5660    1         2 * CHAR(19) INIT('CONNECT') UNAL, /* 2 */
      359     5661    1         2 * UBIN BYTE INIT(10) UNAL,
      360     5662    1         2 * CHAR(19) INIT('DISCONNECT') UNAL, /* 3 */
      361     5663    1         2 * UBIN BYTE INIT(5) UNAL,
      362     5664    1         2 * CHAR(19) INIT('ERASE') UNAL, /* 4 */
      363     5665    1         2 * UBIN BYTE INIT(4) UNAL,
      364     5666    1         2 * CHAR(19) INIT('FIND') UNAL, /* 5 */
      365     5667    1         2 * UBIN BYTE INIT(6) UNAL,
      366     5668    1         2 * CHAR(19) INIT('FINISH') UNAL, /* 6 */
      367     5669    1         2 * UBIN BYTE INIT(16) UNAL,
      368     5670    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 7 */
      369     5671    1         2 * UBIN BYTE INIT(3) UNAL,
      370     5672    1         2 * CHAR(19) INIT('GET') UNAL, /* 8 */
      371     5673    1         2 * UBIN BYTE INIT(2) UNAL,
      372     5674    1         2 * CHAR(19) INIT('IF') UNAL, /* 9 */
      373     5675    1         2 * UBIN BYTE INIT(16) UNAL,
      374     5676    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 10 */
      375     5677    1         2 * UBIN BYTE INIT(6) UNAL,
      376     5678    1         2 * CHAR(19) INIT('MODIFY') UNAL, /* 11 */
      377     5679    1         2 * UBIN BYTE INIT(16) UNAL,
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:86   
      378     5680    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 12 */
      379     5681    1         2 * UBIN BYTE INIT(5) UNAL,
      380     5682    1         2 * CHAR(19) INIT('READY') UNAL, /* 13 */
      381     5683    1         2 * UBIN BYTE INIT(16) UNAL,
      382     5684    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 14 */
      383     5685    1         2 * UBIN BYTE INIT(5) UNAL,
      384     5686    1         2 * CHAR(19) INIT('STORE') UNAL, /* 15 */
      385     5687    1         2 * UBIN BYTE INIT(16) UNAL,
      386     5688    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 16 */
      387     5689    1         2 * UBIN BYTE INIT(16) UNAL,
      388     5690    1         2 * CHAR(19) INIT('NOT A VALID CODE') UNAL, /* 17 */
      389     5691    1         2 * UBIN BYTE INIT(3) UNAL,
      390     5692    1         2 * CHAR(19) INIT('HIA') UNAL, /* 18 */
      391     5693    1         2 * UBIN BYTE INIT(9) UNAL,
      392     5694    1         2 * CHAR(19) INIT('ROLL BACK') UNAL; /* 19 */
      393     5695    1   DCL 1 IDS_STMT(0:19) REDEF IDS_STATEMENT ALIGNED,
      394     5696    1         2 * UBIN BYTE UNAL, /* TEXT CNT */
      395     5697    1         2 * CHAR(19) UNAL; /* TEXT OF STATEMENT */
      396     5698
      397     5699         %PARSE$OUT(NAME=OUT$BLKX,STCLASS=BASED);
      398     5744         %PARSE$SYM(STCLASS=BASED);
      399     5782        %EJECT;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:87   
      400     5783        /*
      401     5784            ***       Begin procedure
      402     5785        */
      403     5786    1       IF OUT$BLK.CODE > 1 AND

   5786  4 000002   200003 470500                    LDP0    @OUT$BLK,,AUTO
         4 000003   000000 720100                    LXL0    0,,PR0
         4 000004   000002 100003                    CMPX0   2,DU
         4 000005   000015 602000 4                  TNC     s:5789
         4 000006   000037 100003                    CMPX0   31,DU
         4 000007   000015 603000 4                  TRC     s:5789

      404     5787    1          OUT$BLK.CODE <= 30 THEN
      405     5788    1           ZI_DIR.CODE = OUT$BLK.CODE; /* Store utility called for*/

   5788  4 000010   000000 236100                    LDQ     0,,PR0
         4 000011   000020 736000                    QLS     16
         4 000012   000125 676000 xsym               ERQ     ZI$DIR+85
         4 000013   000000 376000 5                  ANQ     0
         4 000014   000125 656000 xsym               ERSQ    ZI$DIR+85

      406     5789    2       DO CASE(OUT$BLK.CODE);

   5789  4 000015   000000 720100                    LXL0    0,,PR0
         4 000016   000151 100003                    CMPX0   105,DU
         4 000017   000021 602010 4                  TNC     s:5789+4,X0
         4 000020   001342 710000 4                  TRA     s:6092
         4 000021   001342 710000 4                  TRA     s:6092
         4 000022   001342 710000 4                  TRA     s:6092
         4 000023   000172 710000 4                  TRA     s:5791
         4 000024   000175 710000 4                  TRA     s:5793
         4 000025   000333 710000 4                  TRA     s:5842
         4 000026   000531 710000 4                  TRA     s:5894
         4 000027   000617 710000 4                  TRA     s:5925
         4 000030   000534 710000 4                  TRA     s:5897
         4 000031   000622 710000 4                  TRA     s:5928
         4 000032   001161 710000 4                  TRA     s:6025
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:88   
         4 000033   001205 710000 4                  TRA     s:6039
         4 000034   001205 710000 4                  TRA     s:6039
         4 000035   001175 710000 4                  TRA     s:6034
         4 000036   001342 710000 4                  TRA     s:6092
         4 000037   001205 710000 4                  TRA     s:6039
         4 000040   001307 710000 4                  TRA     s:6070
         4 000041   001342 710000 4                  TRA     s:6092
         4 000042   001270 710000 4                  TRA     s:6060
         4 000043   001342 710000 4                  TRA     s:6092
         4 000044   001342 710000 4                  TRA     s:6092
         4 000045   001342 710000 4                  TRA     s:6092
         4 000046   001342 710000 4                  TRA     s:6092
         4 000047   001342 710000 4                  TRA     s:6092
         4 000050   001175 710000 4                  TRA     s:6034
         4 000051   001175 710000 4                  TRA     s:6034
         4 000052   001342 710000 4                  TRA     s:6092
         4 000053   000452 710000 4                  TRA     s:5874
         4 000054   000455 710000 4                  TRA     s:5876
         4 000055   000476 710000 4                  TRA     s:5883
         4 000056   001342 710000 4                  TRA     s:6092
         4 000057   001205 710000 4                  TRA     s:6039
         4 000060   000246 710000 4                  TRA     s:5816
         4 000061   000262 710000 4                  TRA     s:5821
         4 000062   000265 710000 4                  TRA     s:5825
         4 000063   000303 710000 4                  TRA     s:5831
         4 000064   000317 710000 4                  TRA     s:5836
         4 000065   000202 710000 4                  TRA     s:5797
         4 000066   000322 710000 4                  TRA     s:5839
         4 000067   000340 710000 4                  TRA     s:5846
         4 000070   000343 710000 4                  TRA     s:5849
         4 000071   000346 710000 4                  TRA     s:5852
         4 000072   000377 710000 4                  TRA     s:5861
         4 000073   000426 710000 4                  TRA     s:5867
         4 000074   000537 710000 4                  TRA     s:5900
         4 000075   000554 710000 4                  TRA     s:5904
         4 000076   000571 710000 4                  TRA     s:5908
         4 000077   000614 710000 4                  TRA     s:5921
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:89   
         4 000100   000576 710000 4                  TRA     s:5910
         4 000101   000703 710000 4                  TRA     s:5947
         4 000102   000736 710000 4                  TRA     s:5961
         4 000103   000212 710000 4                  TRA     s:5801
         4 000104   000752 710000 4                  TRA     s:5965
         4 000105   001034 710000 4                  TRA     s:5984
         4 000106   000706 710000 4                  TRA     s:5950
         4 000107   000720 710000 4                  TRA     s:5954
         4 000110   001342 710000 4                  TRA     s:6092
         4 000111   000727 710000 4                  TRA     s:5957
         4 000112   001114 710000 4                  TRA     s:6001
         4 000113   001342 710000 4                  TRA     s:6092
         4 000114   001117 710000 4                  TRA     s:6003
         4 000115   001156 710000 4                  TRA     s:6023
         4 000116   000472 710000 4                  TRA     s:5881
         4 000117   001342 710000 4                  TRA     s:6092
         4 000120   001122 710000 4                  TRA     s:6005
         4 000121   001133 710000 4                  TRA     s:6011
         4 000122   001164 710000 4                  TRA     s:6027
         4 000123   001167 710000 4                  TRA     s:6029
         4 000124   001172 710000 4                  TRA     s:6031
         4 000125   000513 710000 4                  TRA     s:5889
         4 000126   001125 710000 4                  TRA     s:6007
         4 000127   001200 710000 4                  TRA     s:6037
         4 000130   001246 710000 4                  TRA     s:6051
         4 000131   001210 710000 4                  TRA     s:6041
         4 000132   001232 710000 4                  TRA     s:6047
         4 000133   001255 710000 4                  TRA     s:6053
         4 000134   001342 710000 4                  TRA     s:6092
         4 000135   001342 710000 4                  TRA     s:6092
         4 000136   001262 710000 4                  TRA     s:6056
         4 000137   001265 710000 4                  TRA     s:6058
         4 000140   001276 710000 4                  TRA     s:6064
         4 000141   001273 710000 4                  TRA     s:6062
         4 000142   001301 710000 4                  TRA     s:6066
         4 000143   001304 710000 4                  TRA     s:6068
         4 000144   001312 710000 4                  TRA     s:6081
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:90   
         4 000145   001315 710000 4                  TRA     s:6083
         4 000146   001325 710000 4                  TRA     s:6085
         4 000147   001334 710000 4                  TRA     s:6087
         4 000150   001312 710000 4                  TRA     s:6081
         4 000151   001337 710000 4                  TRA     s:6089
         4 000152   000626 710000 4                  TRA     s:5932
         4 000153   000222 710000 4                  TRA     s:5805
         4 000154   001342 710000 4                  TRA     s:6092
         4 000155   000440 710000 4                  TRA     s:5870
         4 000156   001342 710000 4                  TRA     s:6092
         4 000157   000501 710000 4                  TRA     s:5885
         4 000160   001130 710000 4                  TRA     s:6009
         4 000161   001342 710000 4                  TRA     s:6092
         4 000162   001342 710000 4                  TRA     s:6092
         4 000163   001342 710000 4                  TRA     s:6092
         4 000164   001342 710000 4                  TRA     s:6092
         4 000165   001342 710000 4                  TRA     s:6092
         4 000166   000460 710000 4                  TRA     s:5878
         4 000167   000472 710000 4                  TRA     s:5881
         4 000170   001342 710000 4                  TRA     s:6092
         4 000171   000472 710000 4                  TRA     s:5881

      407     5790    2       CASE(#STOP); /* End or quit directive */

      408     5791    2           READ_SW = 3; /* 3 = end to ziu$q2ut routine */

   5791  4 000172   000003 235007                    LDA     3,DL
         4 000173   000000 755000 xsym               STA     READ_SW
         4 000174   001342 710000 4                  TRA     s:6092

      409     5792    2       CASE(#INIT); /* Initialize */

      410     5793    2           ZI_DIR.INITL = '1'B;

   5793  4 000175   200000 236003                    LDQ     65536,DU
         4 000176   000000 256000 xsym               ORSQ    ZI$DIR

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:91   
      411     5794    2           ZI_DIR.SCHEMA_NEEDED = '1'B;

   5794  4 000177   004000 236003                    LDQ     2048,DU
         4 000200   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000201   001342 710000 4                  TRA     s:6092

      412     5795
      413     5796    2       CASE(#CRPT_SEED); /* Extract encrpt seed if any */

      414     5797    2           CALL OCTBIN(ADDR(OUT$BLK) -> OUT$SYM.COUNT);

   5797  4 000202   200003 236100                    LDQ     @OUT$BLK,,AUTO
         4 000203   000004 036003                    ADLQ    4,DU
         4 000204   200007 756100                    STQ     Q+3,,AUTO
         4 000205   001431 701000 4                  TSX1    OCTBIN
         4 000206   000000 011000                    NOP     0

      415     5798    2           ZI_DIR.ENCP_SEED_RD = KEY_RNG_TEMP;

   5798  4 000207   000077 235000 2                  LDA     KEY_RNG_TEMP
         4 000210   000027 755000 xsym               STA     ZI$DIR+23
         4 000211   001342 710000 4                  TRA     s:6092

      416     5799
      417     5800    2       CASE(#DEST_SEED); /* Extract destination seed */

      418     5801    2           CALL OCTBIN(ADDR(OUT$BLK) -> OUT$SYM.COUNT);

   5801  4 000212   200003 236100                    LDQ     @OUT$BLK,,AUTO
         4 000213   000004 036003                    ADLQ    4,DU
         4 000214   200007 756100                    STQ     Q+3,,AUTO
         4 000215   001431 701000 4                  TSX1    OCTBIN
         4 000216   000000 011000                    NOP     0

      419     5802    2           ZI_DIR.DEST_SEED_RD = KEY_RNG_TEMP;

   5802  4 000217   000077 235000 2                  LDA     KEY_RNG_TEMP
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:92   
         4 000220   000030 755000 xsym               STA     ZI$DIR+24
         4 000221   001342 710000 4                  TRA     s:6092

      420     5803
      421     5804    2       CASE(#AREADCB); /* Extract area dcb name */

      422     5805    2           ZI_DIR.AREA_NM.NAME.TEXT=ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5805  4 000222   000004 236100                    LDQ     4,,PR0
         4 000223   000033 772000                    QRL     27
         4 000224   000000 621006                    EAX1    0,QL
         4 000225   040000 100540                    MLR     fill='040'O
         4 000226   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         4 000227   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30

      423     5806    2           ZI_DIR.AREAFID = ' '; /* Blank out fid name in case of

   5806  4 000230   040000 100400                    MLR     fill='040'O
         4 000231   000001 000001 5                  ADSC9   1                        cn=0,n=1
         4 000232   000067 000170 xsym               ADSC9   ZI$DIR+55                cn=0,n=120

      424     5807         non-use (same for ZI$DIR.SCHFID) */
      425     5808    2           IF ZI_DIR.AREA_NM.NAME.TEXT = 'ALL' THEN

   5808  4 000233   040000 106400                    CMPC    fill='040'O
         4 000234   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30
         4 000235   000146 000003 3                  ADSC9   OCHRS+2                  cn=0,n=3
         4 000236   001342 601000 4                  TNZ     s:6092

      426     5809    3           DO;

      427     5810    3               ZI_DIR.AUTODUMP = '1'B;

   5810  4 000237   400000 236007                    LDQ     -131072,DL
         4 000240   000026 256000 xsym               ORSQ    ZI$DIR+22

      428     5811    3               ZI_DIR.SCHEMA_NEEDED = '1'B;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:93   

   5811  4 000241   004000 236003                    LDQ     2048,DU
         4 000242   000125 256000 xsym               ORSQ    ZI$DIR+85

      429     5812    3               ZI$DIR.CHECK_ALL = '1'B;

   5812  4 000243   400000 236007                    LDQ     -131072,DL
         4 000244   000141 256000 xsym               ORSQ    ZI$DIR+97

      430     5813    3               END;

   5813  4 000245   001342 710000 4                  TRA     s:6092

      431     5814
      432     5815    2       CASE(#SCHEDCB); /*  Extract schema dcb name */

      433     5816    2           ZI_DIR.SCHEMA_NM.NAME.TEXT=ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5816  4 000246   000004 236100                    LDQ     4,,PR0
         4 000247   000033 772000                    QRL     27
         4 000250   000000 621006                    EAX1    0,QL
         4 000251   040000 100540                    MLR     fill='040'O
         4 000252   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         4 000253   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30

      434     5817    2           ZI_DIR.SCHFID = ' '; /* blanked in case of non-use */

   5817  4 000254   040000 100400                    MLR     fill='040'O
         4 000255   000001 000001 5                  ADSC9   1                        cn=0,n=1
         4 000256   000031 000170 xsym               ADSC9   ZI$DIR+25                cn=0,n=120

      435     5818    2           ZI_DIR.SCHEMA_NEEDED = '1'B;

   5818  4 000257   004000 236003                    LDQ     2048,DU
         4 000260   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000261   001342 710000 4                  TRA     s:6092

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:94   
      436     5819
      437     5820    2       CASE(#RNGLIST); /* Range list specified ?? */

      438     5821    2           ZI_DIR.RNG_LIST='1'B;

   5821  4 000262   400000 236003                    LDQ     -131072,DU
         4 000263   000000 256000 xsym               ORSQ    ZI$DIR
         4 000264   001342 710000 4                  TRA     s:6092

      439     5822         /*        ICNT=ICNT+1; */
      440     5823
      441     5824    2       CASE(#LOW_RNG); /* Extract low range (RNG1)*/

      442     5825    2           ICNT=ICNT+1;

   5825  4 000265   000000 054000 xsym               AOS     ICNT

      443     5826    2           CALL CHARBIN(INIT_RG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);

   5826  4 000266   000004 236100                    LDQ     4,,PR0
         4 000267   000033 772000                    QRL     27
         4 000270   000000 620006                    EAX0    0,QL
         4 000271   000100 305540                    DTB
         4 000272   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         4 000273   200010 000010                    NDSC9   @TXTC+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000274   200011 235100                    LDA     @TXTC+2,,AUTO
         4 000275   000076 755000 2                  STA     INIT_RG_TEMP

      444     5827    2           INIT_RG.FIRNG(ICNT)=INIT_RG_TEMP;

   5827  4 000276   000000 236000 xsym               LDQ     ICNT
         4 000277   000001 736000                    QLS     1
         4 000300   000000 755006 xsym               STA     INIT_RG,QL

      445     5828    2           INIT_RG.SECRNG(ICNT)=INIT_RG_TEMP;

   5828  4 000301   000001 755006 xsym               STA     INIT_RG+1,QL
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:95   
         4 000302   001342 710000 4                  TRA     s:6092

      446     5829
      447     5830    2       CASE(#HI_RNGE); /* Extract upper range (RNG2) */

      448     5831    2           CALL CHARBIN(INIT_RG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);

   5831  4 000303   000004 236100                    LDQ     4,,PR0
         4 000304   000033 772000                    QRL     27
         4 000305   000000 621006                    EAX1    0,QL
         4 000306   000100 305540                    DTB
         4 000307   000004 230011                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X1
         4 000310   200010 000010                    NDSC9   @TXTC+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000311   200011 235100                    LDA     @TXTC+2,,AUTO
         4 000312   000076 755000 2                  STA     INIT_RG_TEMP

      449     5832    2           INIT_RG.SECRNG(ICNT)=INIT_RG_TEMP;

   5832  4 000313   000000 236000 xsym               LDQ     ICNT
         4 000314   000001 736000                    QLS     1
         4 000315   000001 755006 xsym               STA     INIT_RG+1,QL
         4 000316   001342 710000 4                  TRA     s:6092

      450     5833         /*        ICNT=ICNT+1; */
      451     5834
      452     5835    2       CASE(#ENCRPT); /* Is encrpt specified ? ? */

      453     5836    2           ZI_DIR.ENCRPT='1'B;

   5836  4 000317   002000 236003                    LDQ     1024,DU
         4 000320   000000 256000 xsym               ORSQ    ZI$DIR
         4 000321   001342 710000 4                  TRA     s:6092

      454     5837
      455     5838    2       CASE(#TMLT_KYS); /*Allocate n keys for template area*/

      456     5839    2           CALL CHARBIN(ZI_DIR.INIT_TMPLT_KEY,ADDR(OUT$BLK)->OUT$SYM.TEXT);
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:96   

   5839  4 000322   000004 236100                    LDQ     4,,PR0
         4 000323   000033 772000                    QRL     27
         4 000324   000000 621006                    EAX1    0,QL
         4 000325   000100 305540                    DTB
         4 000326   000004 230011                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X1
         4 000327   200010 000010                    NDSC9   @TXTC+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000330   200011 235100                    LDA     @TXTC+2,,AUTO
         4 000331   000221 755000 xsym               STA     ZI$DIR+145
         4 000332   001342 710000 4                  TRA     s:6092

      457     5840
      458     5841    2       CASE(#PRINT); /*  Print command block */

      459     5842    2           ZI_DIR.PRINT='1'B;

   5842  4 000333   010000 236003                    LDQ     4096,DU
         4 000334   000000 256000 xsym               ORSQ    ZI$DIR

      460     5843    2           ZI_DIR.SCHEMA_NEEDED = '1'B;

   5843  4 000335   004000 236003                    LDQ     2048,DU
         4 000336   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000337   001342 710000 4                  TRA     s:6092

      461     5844
      462     5845    2       CASE(#REC_OPT); /*  Are print options in effect?? */

      463     5846    2           ZI_DIR.PRNT_OPT='1'B;

   5846  4 000340   001000 236003                    LDQ     512,DU
         4 000341   000000 256000 xsym               ORSQ    ZI$DIR
         4 000342   001342 710000 4                  TRA     s:6092

      464     5847
      465     5848    2       CASE(#KEY_LST); /*  key list specified */

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:97   
      466     5849    2           ZI_DIR.PRNT_OPT ='1'B;

   5849  4 000343   001000 236003                    LDQ     512,DU
         4 000344   000000 256000 xsym               ORSQ    ZI$DIR
         4 000345   001342 710000 4                  TRA     s:6092

      467     5850
      468     5851    2       CASE(#LOW_KEY); /* Find first key specified */

      469     5852    2           KCNT=KCNT+1;

   5852  4 000346   000000 054000 xsym               AOS     KCNT

      470     5853    2           IF OUT$BLK.NDTYPE = %OCT# THEN

   5853  4 000347   000000 236100                    LDQ     0,,PR0
         4 000350   000077 376003                    ANQ     63,DU
         4 000351   000021 116003                    CMPQ    17,DU
         4 000352   000361 601000 4                  TNZ     s:5856

      471     5854    2               CALL OCTBIN(ADDR(OUT$BLK)->OUT$SYM.COUNT);

   5854  4 000353   200003 236100                    LDQ     @OUT$BLK,,AUTO
         4 000354   000004 036003                    ADLQ    4,DU
         4 000355   200007 756100                    STQ     Q+3,,AUTO
         4 000356   001431 701000 4                  TSX1    OCTBIN
         4 000357   000000 011000                    NOP     0
         4 000360   000371 710000 4                  TRA     s:5857

      472     5855    2           ELSE
      473     5856    2               CALL CHARBIN(KEY_RNG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);

   5856  4 000361   000004 236100                    LDQ     4,,PR0
         4 000362   000033 772000                    QRL     27
         4 000363   000000 620006                    EAX0    0,QL
         4 000364   000100 305540                    DTB
         4 000365   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:98   
         4 000366   200010 000010                    NDSC9   @TXTC+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000367   200011 235100                    LDA     @TXTC+2,,AUTO
         4 000370   000077 755000 2                  STA     KEY_RNG_TEMP

      474     5857    2           KEY_RNG.FIR(KCNT)=KEY_RNG_TEMP;

   5857  4 000371   000000 235000 xsym               LDA     KCNT
         4 000372   000001 735000                    ALS     1
         4 000373   000077 236000 2                  LDQ     KEY_RNG_TEMP
         4 000374   000000 756005 xsym               STQ     KEY_RNG,AL

      475     5858    2           KEY_RNG.SEC(KCNT)=KEY_RNG_TEMP;

   5858  4 000375   000001 756005 xsym               STQ     KEY_RNG+1,AL
         4 000376   001342 710000 4                  TRA     s:6092

      476     5859
      477     5860    2       CASE(#HI_KEY); /*  extract high key and check it */

      478     5861    2           IF OUT$BLK.NDTYPE = %OCT# THEN

   5861  4 000377   000000 236100                    LDQ     0,,PR0
         4 000400   000077 376003                    ANQ     63,DU
         4 000401   000021 116003                    CMPQ    17,DU
         4 000402   000411 601000 4                  TNZ     s:5864

      479     5862    2               CALL OCTBIN(ADDR(OUT$BLK)->OUT$SYM.COUNT);

   5862  4 000403   200003 236100                    LDQ     @OUT$BLK,,AUTO
         4 000404   000004 036003                    ADLQ    4,DU
         4 000405   200007 756100                    STQ     Q+3,,AUTO
         4 000406   001431 701000 4                  TSX1    OCTBIN
         4 000407   000000 011000                    NOP     0
         4 000410   000421 710000 4                  TRA     s:5865

      480     5863    2           ELSE
      481     5864    2               CALL CHARBIN(KEY_RNG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:99   

   5864  4 000411   000004 236100                    LDQ     4,,PR0
         4 000412   000033 772000                    QRL     27
         4 000413   000000 621006                    EAX1    0,QL
         4 000414   000100 305540                    DTB
         4 000415   000004 230011                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X1
         4 000416   200010 000010                    NDSC9   @TXTC+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000417   200011 235100                    LDA     @TXTC+2,,AUTO
         4 000420   000077 755000 2                  STA     KEY_RNG_TEMP

      482     5865    2           KEY_RNG.SEC(KCNT)=KEY_RNG_TEMP;

   5865  4 000421   000000 235000 xsym               LDA     KCNT
         4 000422   000001 735000                    ALS     1
         4 000423   000077 236000 2                  LDQ     KEY_RNG_TEMP
         4 000424   000001 756005 xsym               STQ     KEY_RNG+1,AL
         4 000425   001342 710000 4                  TRA     s:6092

      483     5866    2       CASE(#REC_LST);

      484     5867    2           RCNT=RCNT+1;

   5867  4 000426   000000 054000 xsym               AOS     RCNT

      485     5868    2           RECORD_LIST.NAME(RCNT)=ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5868  4 000427   000004 236100                    LDQ     4,,PR0
         4 000430   000033 772000                    QRL     27
         4 000431   000000 235000 xsym               LDA     RCNT
         4 000432   000005 735000                    ALS     5
         4 000433   000000 620006                    EAX0    0,QL
         4 000434   040005 100540                    MLR     fill='040'O
         4 000435   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000436   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 000437   001342 710000 4                  TRA     s:6092

      486     5869    2       CASE(#SET_LST);
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:100  

      487     5870    2           SCNT = SCNT+1;

   5870  4 000440   000000 054000 xsym               AOS     SCNT

      488     5871    2           SET_LIST.NAME(SCNT) = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5871  4 000441   000004 236100                    LDQ     4,,PR0
         4 000442   000033 772000                    QRL     27
         4 000443   000000 235000 xsym               LDA     SCNT
         4 000444   000005 735000                    ALS     5
         4 000445   000000 620006                    EAX0    0,QL
         4 000446   040005 100540                    MLR     fill='040'O
         4 000447   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000450   000000 000036 xsym               ADSC9   SET_LIST,A               cn=0,n=30
         4 000451   001342 710000 4                  TRA     s:6092

      489     5872
      490     5873    2       CASE(#REP_OVER);

      491     5874    2           ZI_DIR.REP_OVER = '1'B;

   5874  4 000452   000010 236007                    LDQ     8,DL
         4 000453   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000454   001342 710000 4                  TRA     s:6092

      492     5875    2       CASE(#RELOC);

      493     5876    2           ZI_DIR.RELOC = '1'B;

   5876  4 000455   000004 236007                    LDQ     4,DL
         4 000456   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000457   001342 710000 4                  TRA     s:6092

      494     5877    2       CASE(#RETLST);

      495     5878    2           RETCNT = RETCNT +1;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:101  

   5878  4 000460   000000 054000 xsym               AOS     RETCNT

      496     5879    2           RETAIN_LIST.NAME(RETCNT) = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5879  4 000461   000004 236100                    LDQ     4,,PR0
         4 000462   000033 772000                    QRL     27
         4 000463   000000 235000 xsym               LDA     RETCNT
         4 000464   000005 735000                    ALS     5
         4 000465   000000 620006                    EAX0    0,QL
         4 000466   040005 100540                    MLR     fill='040'O
         4 000467   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000470   000000 000036 xsym               ADSC9   RETAIN_LIST,A            cn=0,n=30
         4 000471   001342 710000 4                  TRA     s:6092

      497     5880    2       CASE(#VIA,#CALC,#ALL);

      498     5881    2           ZI_DIR.RELOC_FUNC = OUT$BLK.CODE;

   5881  4 000472   000000 236100                    LDQ     0,,PR0
         4 000473   777777 376007                    ANQ     -1,DL
         4 000474   000222 756000 xsym               STQ     ZI$DIR+146
         4 000475   001342 710000 4                  TRA     s:6092

      499     5882    2       CASE(#RESTR);

      500     5883    2           ZI_DIR.RESTR = '1'B;

   5883  4 000476   000002 236007                    LDQ     2,DL
         4 000477   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000500   001342 710000 4                  TRA     s:6092

      501     5884    2       CASE(#DMPID);

      502     5885    2           DMPCNT = DMPCNT + 1;

   5885  4 000501   000000 054000 xsym               AOS     DMPCNT
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:102  

      503     5886    2           DUMP_FID.NAME(DMPCNT) = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5886  4 000502   000004 236100                    LDQ     4,,PR0
         4 000503   000033 772000                    QRL     27
         4 000504   000000 235000 xsym               LDA     DMPCNT
         4 000505   000005 735000                    ALS     5
         4 000506   000000 620006                    EAX0    0,QL
         4 000507   040005 100540                    MLR     fill='040'O
         4 000510   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000511   000000 000036 xsym               ADSC9   DUMP_FID,A               cn=0,n=30
         4 000512   001342 710000 4                  TRA     s:6092

      504     5887
      505     5888    2       CASE(#ITM_LST);

      506     5889    2           ITMCNT = ITMCNT +1;

   5889  4 000513   000000 054000 xsym               AOS     ITMCNT

      507     5890    2           ITEM_LIST.NAME(ITMCNT) = ADDR(OUT$BLK) -> OUT$SYM.TEXT;

   5890  4 000514   000004 236100                    LDQ     4,,PR0
         4 000515   000033 772000                    QRL     27
         4 000516   000000 235000 xsym               LDA     ITMCNT
         4 000517   000005 735000                    ALS     5
         4 000520   000000 620006                    EAX0    0,QL
         4 000521   040005 100540                    MLR     fill='040'O
         4 000522   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000523   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30

      508     5891    2           ITEM_LIST.TYPE(ITMCNT) = RCNT; /* Store owner rec num */

   5891  4 000524   000000 236000 xsym               LDQ     ITMCNT
         4 000525   000003 736000                    QLS     3
         4 000526   000000 720000 xsym               LXL0    RCNT
         4 000527   000007 440006 xsym               SXL0    ITEM_LIST+7,QL
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:103  
         4 000530   001342 710000 4                  TRA     s:6092

      509     5892
      510     5893    2       CASE(#INV_RBD) /*Inventory page rebuild*/;

      511     5894    2           ZI_DIR.INVREBLD = '1'B;

   5894  4 000531   100000 236003                    LDQ     32768,DU
         4 000532   000000 256000 xsym               ORSQ    ZI$DIR
         4 000533   001342 710000 4                  TRA     s:6092

      512     5895
      513     5896    2       CASE(#DUMP); /* Dump command block */

      514     5897    2           ZI_DIR.UNLOAD = '1'B; /* Set dump flag on */

   5897  4 000534   020000 236003                    LDQ     8192,DU
         4 000535   000000 256000 xsym               ORSQ    ZI$DIR
         4 000536   001342 710000 4                  TRA     s:6092

      515     5898
      516     5899    2       CASE(#SRCEDCB); /*  Extract the source file for command */

      517     5900    2           ZI_DIR.SRCE_NM.NAME.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5900  4 000537   000004 236100                    LDQ     4,,PR0
         4 000540   000033 772000                    QRL     27
         4 000541   000000 621006                    EAX1    0,QL
         4 000542   040000 100540                    MLR     fill='040'O
         4 000543   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         4 000544   000245 200036 xsym               ADSC9   ZI$DIR+165               cn=1,n=30

      518     5901    2           ZI_DIR.SRCEFID = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5901  4 000545   000004 236100                    LDQ     4,,PR0
         4 000546   000033 772000                    QRL     27
         4 000547   000000 620006                    EAX0    0,QL
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:104  
         4 000550   040000 100540                    MLR     fill='040'O
         4 000551   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000552   000067 000170 xsym               ADSC9   ZI$DIR+55                cn=0,n=120
         4 000553   001342 710000 4                  TRA     s:6092

      519     5902
      520     5903    2       CASE(#DESTDCB); /* Extract the destination file */

      521     5904    2           ZI_DIR.DEST_NM.NAME.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5904  4 000554   000004 236100                    LDQ     4,,PR0
         4 000555   000033 772000                    QRL     27
         4 000556   000000 621006                    EAX1    0,QL
         4 000557   040000 100540                    MLR     fill='040'O
         4 000560   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         4 000561   000256 200036 xsym               ADSC9   ZI$DIR+174               cn=1,n=30

      522     5905    2           ZI_DIR.DESTFID = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5905  4 000562   000004 236100                    LDQ     4,,PR0
         4 000563   000033 772000                    QRL     27
         4 000564   000000 620006                    EAX0    0,QL
         4 000565   040000 100540                    MLR     fill='040'O
         4 000566   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000567   000031 000170 xsym               ADSC9   ZI$DIR+25                cn=0,n=120
         4 000570   001342 710000 4                  TRA     s:6092

      523     5906
      524     5907    2       CASE(#ON_OPT); /* Copy option = 'TO',on */

      525     5908    2           ZI_DIR.OPEN_MODE = %ERROR#;

   5908  4 000571   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000572   000002 376000 5                  ANQ     2
         4 000573   040000 276003                    ORQ     16384,DU
         4 000574   000125 756000 xsym               STQ     ZI$DIR+85
         4 000575   001342 710000 4                  TRA     s:6092
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:105  

      526     5909    2       CASE(#IN_OPT);

      527     5910    2           IF ZI_DIR.UNLOAD THEN

   5910  4 000576   000000 236000 xsym               LDQ     ZI$DIR
         4 000577   020000 316003                    CANQ    8192,DU
         4 000600   000607 600000 4                  TZE     s:5918

      528     5911    3           DO;

      529     5912         /*E* ERROR: ZIU-02026-C
      530     5913                  MESSAGE: INTO option not permitted in DUMP directive. */
      531     5914    3    /**/       ERRCODESF.ERR#=2026;

   5914  4 000601   000000 236000 xsym               LDQ     ERRCODESF
         4 000602   000003 376000 5                  ANQ     3
         4 000603   037520 276007                    ORQ     16208,DL
         4 000604   000000 756000 xsym               STQ     ERRCODESF

      532     5915    3    /**/       MSGCODE = ERRCODE_RDEF;

   5915  4 000605   000000 756000 xsym               STQ     MSGCODE

      533     5916    3               ALTRETURN;

   5916  4 000606   000000 702200 xent               TSX2  ! X66_AALT

      534     5917    3               END;
      535     5918    2           ZI_DIR.OPEN_MODE = %OLDFILE#;

   5918  4 000607   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000610   000002 376000 5                  ANQ     2
         4 000611   100000 276003                    ORQ     32768,DU
         4 000612   000125 756000 xsym               STQ     ZI$DIR+85
         4 000613   001342 710000 4                  TRA     s:6092

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:106  
      536     5919
      537     5920    2       CASE(#OV_OPT); /* Copy option = 'OVER' */

      538     5921    2           ZI_DIR.OPEN_MODE = %NEWFILE#;

   5921  4 000614   140000 236003                    LDQ     49152,DU
         4 000615   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000616   001342 710000 4                  TRA     s:6092

      539     5922
      540     5923
      541     5924    2       CASE(#LOAD); /* Load data base comnd */

      542     5925    2           ZI_DIR.LOAD = '1'B; /*Set load flag */

   5925  4 000617   040000 236003                    LDQ     16384,DU
         4 000620   000000 256000 xsym               ORSQ    ZI$DIR
         4 000621   001342 710000 4                  TRA     s:6092

      543     5926
      544     5927    2       CASE(#KEYRBLD); /*Rebuild key file command*/

      545     5928    2           ZI_DIR.KEYBLD = '1'B;

   5928  4 000622   004000 236003                    LDQ     2048,DU
         4 000623   000000 256000 xsym               ORSQ    ZI$DIR

      546     5929    2           ZI_DIR.SCHEMA_NEEDED = '1'B;

   5929  4 000624   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000625   001342 710000 4                  TRA     s:6092

      547     5930
      548     5931    2       CASE(#HELP_IDS);

      549     5932    2           CALL CHARBIN(INIT_RG_TEMP,ADDR(OUT$BLK)->OUT$SYM.TEXT);

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:107  
   5932  4 000626   000004 236100                    LDQ     4,,PR0
         4 000627   000033 772000                    QRL     27
         4 000630   000000 621006                    EAX1    0,QL
         4 000631   000100 305540                    DTB
         4 000632   000004 230011                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X1
         4 000633   200010 000010                    NDSC9   @TXTC+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000634   200011 235100                    LDA     @TXTC+2,,AUTO
         4 000635   000076 755000 2                  STA     INIT_RG_TEMP

      550     5933    2           X=INIT_RG_TEMP/100000; /* GET THE STATEMENT CODE */

   5933  4 000636   000076 236000 2                  LDQ     INIT_RG_TEMP
         4 000637   000001 772000                    QRL     1
         4 000640   141520 506007                    DIV     50000,DL
         4 000641   000000 756000 xsym               STQ     X

      551     5934    2           IF X>19 THEN X=0; /* IN CASE ILLEGAL STATEMENT CODE */

   5934  4 000642   000023 116007                    CMPQ    19,DL
         4 000643   000645 604400 4                  TMOZ    s:5935

   5934  4 000644   000000 450000 xsym               STZ     X

      552     5935    2           ERR_INSERT(1)=IDS_STMT(X); /* TEXTC OF STATMENT */

   5935  4 000645   000000 236000 xsym               LDQ     X
         4 000646   000024 402007                    MPY     20,DL
         4 000647   000000 100406                    MLR     fill='000'O
         4 000650   000000 000024 3                  ADSC9   IDS_STATEMENT,Q          cn=0,n=20
         4 000651   000010 000037 xsym               ADSC9   ERR_INSERT+8             cn=0,n=31

      553     5936    2           X=MOD(INIT_RG_TEMP,100000); /* GET LAST 5 DIGITS */

   5936  4 000652   000076 235000 2                  LDA     INIT_RG_TEMP
         4 000653   000043 773000                    LRL     35
         4 000654   303240 507007                    DVF     100000,DL
         4 000655   000000 756000 xsym               STQ     X
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:108  

      554     5937    2           X=X/10000; /* GET THE 1ST DIGIT IN THE LAST 5 DIGITS */

   5937  4 000656   023420 506007                    DIV     10000,DL
         4 000657   000000 756000 xsym               STQ     X

      555     5938    2           ERRCODESF.ERR#=MOD(INIT_RG_TEMP,10000); /* LAST 4 DIGIT */

   5938  4 000660   000076 235000 2                  LDA     INIT_RG_TEMP
         4 000661   000043 773000                    LRL     35
         4 000662   023420 507007                    DVF     10000,DL
         4 000663   000003 736000                    QLS     3
         4 000664   000000 676000 xsym               ERQ     ERRCODESF
         4 000665   377770 376007                    ANQ     131064,DL
         4 000666   000000 656000 xsym               ERSQ    ERRCODESF

      556     5939    2           ERRFLGSF = 0; /* NO NEED OF STARS */

   5939  4 000667   000000 450000 xsym               STZ     ERRFLGSF

      557     5940    2           INCL_ERR='0'B;

   5940  4 000670   000000 450000 xsym               STZ     INCL_ERR

      558     5941    2           MSGCODE = ERRCODE_RDEF;

   5941  4 000671   000000 235000 xsym               LDA     ERRCODESF
         4 000672   000000 755000 xsym               STA     MSGCODE

      559     5942    2           MONITOR_ERR.FN_CODE=%BITBIN('321160'O)+X;

   5942  4 000673   000000 720000 xsym               LXL0    X
         4 000674   321160 621010                    EAX1    107120,X0
         4 000675   000000 741000 xsym               STX1    MSGCODE

      560     5943    2           SUBMESSF='0'B;

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:109  
   5943  4 000676   000000 450000 xsym               STZ     SUBMESSF

      561     5944    2           CALL SYS_FUNC_ERRMSG ALTRET(NO_IDS_MSG);

   5944  4 000677   000004 631400 5                  EPPR1   4
         4 000700   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 000701   001465 702000 4                  TSX2    NO_IDS_MSG
         4 000702   001342 710000 4                  TRA     s:6092

      562     5945
      563     5946    2       CASE(#ACNTLIST);

      564     5947    2           ZI_DIR.ACNTLIST = '1'B;

   5947  4 000703   400000 236003                    LDQ     -131072,DU
         4 000704   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 000705   001342 710000 4                  TRA     s:6092

      565     5948
      566     5949    2       CASE(#HELP);

      567     5950    2           HELP_PARAM.PROCACCT_ = VECTOR(ACCTNAME);

   5950  4 000706   000006 237000 5                  LDAQ    6
         4 000707   000004 757000 2                  STAQ    HELP_PARAM+2

      568     5951    2           HELP_PARAM.HELP$ = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;

   5951  4 000710   000003 471500                    LDP1    3,,PR0
         4 000711   100003 236100                    LDQ     3,,PR1
         4 000712   000013 756000 2                  STQ     HELP_PARAM+9

      569     5952    2           CALL X$HELP(HELP_PARAM) ALTRET(ALT_HELP);

   5952  4 000713   000010 630400 5                  EPPR0   8
         4 000714   000005 631400 5                  EPPR1   5
         4 000715   000000 701000 xent               TSX1    X$HELP
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:110  
         4 000716   001510 702000 4                  TSX2    ALT_HELP
         4 000717   001342 710000 4                  TRA     s:6092

      570     5953    2       CASE(#QUES);

      571     5954    2           HELP_PARAM.MORE# = '1'B;

   5954  4 000720   000200 236003                    LDQ     128,DU
         4 000721   000014 256000 2                  ORSQ    HELP_PARAM+10

      572     5955    2           CALL X$HELP(HELP_PARAM) ALTRET(ALT_HELP);

   5955  4 000722   000010 630400 5                  EPPR0   8
         4 000723   000005 631400 5                  EPPR1   5
         4 000724   000000 701000 xent               TSX1    X$HELP
         4 000725   001510 702000 4                  TSX2    ALT_HELP
         4 000726   001342 710000 4                  TRA     s:6092

      573     5956    2       CASE(#DQUES);

      574     5957    2           HELP_PARAM.ALL# = '1'B;

   5957  4 000727   000400 236003                    LDQ     256,DU
         4 000730   000014 256000 2                  ORSQ    HELP_PARAM+10

      575     5958    2           CALL X$HELP(HELP_PARAM) ALTRET(ALT_HELP);

   5958  4 000731   000010 630400 5                  EPPR0   8
         4 000732   000005 631400 5                  EPPR1   5
         4 000733   000000 701000 xent               TSX1    X$HELP
         4 000734   001510 702000 4                  TSX2    ALT_HELP
         4 000735   001342 710000 4                  TRA     s:6092

      576     5959
      577     5960    2       CASE(#ACCNTS);

      578     5961    2           ACNT_IDX = ACNT_IDX +1;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:111  

   5961  4 000736   000000 054000 xsym               AOS     ACNT_IDX

      579     5962    2           ZI_DIR.ACNT(ACNT_IDX) = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   5962  4 000737   000000 235000 xsym               LDA     ACNT_IDX
         4 000740   000001 735000                    ALS     1
         4 000741   000003 471500                    LDP1    3,,PR0
         4 000742   100004 236100                    LDQ     4,,PR1
         4 000743   000033 772000                    QRL     27
         4 000744   000002 735000                    ALS     2
         4 000745   000000 620006                    EAX0    0,QL
         4 000746   040005 100540                    MLR     fill='040'O
         4 000747   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 000750   000002 400010 xsym               ADSC9   ZI$DIR+2,A               cn=2,n=8
         4 000751   001342 710000 4                  TRA     s:6092

      580     5963
      581     5964    2       CASE(#DATE);

      582     5965    2           ZI_DIR.DATEFLG = '1'B;

   5965  4 000752   200000 236003                    LDQ     65536,DU
         4 000753   000125 256000 xsym               ORSQ    ZI$DIR+85

      583     5966    2           ZI_DIR.DATEIN = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5966  4 000754   000004 236100                    LDQ     4,,PR0
         4 000755   000033 772000                    QRL     27
         4 000756   000000 620006                    EAX0    0,QL
         4 000757   040000 100540                    MLR     fill='040'O
         4 000760   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000761   000126 200006 xsym               ADSC9   ZI$DIR+86                cn=1,n=6

      584     5967    2           ZI_DIR.TIMEIN = '00000000';

   5967  4 000762   040000 100400                    MLR     fill='040'O
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:112  
         4 000763   000147 000010 3                  ADSC9   OCHRS+3                  cn=0,n=8
         4 000764   000127 600010 xsym               ADSC9   ZI$DIR+87                cn=3,n=8

      585     5968    2           IF ZI_DIR.DATE.YR < '00' OR ZI_DIR.DATE.YR > '99' THEN

   5968  4 000765   040000 106400                    CMPC    fill='040'O
         4 000766   000126 200002 xsym               ADSC9   ZI$DIR+86                cn=1,n=2
         4 000767   000147 000002 3                  ADSC9   OCHRS+3                  cn=0,n=2
         4 000770   000775 602000 4                  TNC     s:5969
         4 000771   040000 106400                    CMPC    fill='040'O
         4 000772   000151 000002 3                  ADSC9   OCHRS+5                  cn=0,n=2
         4 000773   000126 200002 xsym               ADSC9   ZI$DIR+86                cn=1,n=2
         4 000774   000777 603000 4                  TRC     s:5970

      586     5969    2               ZI_DIR.DATEFLG = '0'B;

   5969  4 000775   000011 236000 5                  LDQ     9
         4 000776   000125 356000 xsym               ANSQ    ZI$DIR+85

      587     5970    2           IF ZI_DIR.DATE.MO < '01' OR ZI_DIR.DATE.MO > '12' THEN

   5970  4 000777   040000 106400                    CMPC    fill='040'O
         4 001000   000126 600002 xsym               ADSC9   ZI$DIR+86                cn=3,n=2
         4 001001   000152 000002 3                  ADSC9   OCHRS+6                  cn=0,n=2
         4 001002   001007 602000 4                  TNC     s:5971
         4 001003   040000 106400                    CMPC    fill='040'O
         4 001004   000153 000002 3                  ADSC9   OCHRS+7                  cn=0,n=2
         4 001005   000126 600002 xsym               ADSC9   ZI$DIR+86                cn=3,n=2
         4 001006   001011 603000 4                  TRC     s:5972

      588     5971    2               ZI_DIR.DATEFLG = '0'B;

   5971  4 001007   000011 236000 5                  LDQ     9
         4 001010   000125 356000 xsym               ANSQ    ZI$DIR+85

      589     5972    2           IF ZI_DIR.DATE.DY < '01' OR ZI_DIR.DATE.DY > '31' THEN

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:113  
   5972  4 001011   040000 106400                    CMPC    fill='040'O
         4 001012   000127 200002 xsym               ADSC9   ZI$DIR+87                cn=1,n=2
         4 001013   000152 000002 3                  ADSC9   OCHRS+6                  cn=0,n=2
         4 001014   001021 602000 4                  TNC     s:5973
         4 001015   040000 106400                    CMPC    fill='040'O
         4 001016   000154 000002 3                  ADSC9   OCHRS+8                  cn=0,n=2
         4 001017   000127 200002 xsym               ADSC9   ZI$DIR+87                cn=1,n=2
         4 001020   001023 603000 4                  TRC     s:5974

      590     5973    2               ZI_DIR.DATEFLG = '0'B;

   5973  4 001021   000011 236000 5                  LDQ     9
         4 001022   000125 356000 xsym               ANSQ    ZI$DIR+85

      591     5974    2           IF ZI_DIR.DATEFLG = '0'B THEN

   5974  4 001023   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001024   200000 316003                    CANQ    65536,DU
         4 001025   001342 601000 4                  TNZ     s:6092

      592     5975    3           DO;

      593     5976         /*E* ERROR: ZIU-02002-C
      594     5977              MESSAGE: Improper date specification; format= "yymmdd". */
      595     5978    3    /**/       ERRCODESF.ERR#=2002;

   5978  4 001026   000000 236000 xsym               LDQ     ERRCODESF
         4 001027   000003 376000 5                  ANQ     3
         4 001030   037220 276007                    ORQ     16016,DL
         4 001031   000000 756000 xsym               STQ     ERRCODESF

      596     5979    3    /**/       MSGCODE = ERRCODE_RDEF;

   5979  4 001032   000000 756000 xsym               STQ     MSGCODE

      597     5980    3               ALTRETURN;

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:114  
   5980  4 001033   000000 702200 xent               TSX2  ! X66_AALT

      598     5981    3               END;
      599     5982
      600     5983    2       CASE(#HOUR);

      601     5984    2           ZI_DIR.TIMEIN = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   5984  4 001034   000004 236100                    LDQ     4,,PR0
         4 001035   000033 772000                    QRL     27
         4 001036   000000 621006                    EAX1    0,QL
         4 001037   040000 100540                    MLR     fill='040'O
         4 001040   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         4 001041   000127 600010 xsym               ADSC9   ZI$DIR+87                cn=3,n=8

      602     5985    2           IF ZI_DIR.TIME.HR > '23' OR ZI_DIR.TIME.HR < '00' THEN

   5985  4 001042   040000 106400                    CMPC    fill='040'O
         4 001043   000155 000002 3                  ADSC9   OCHRS+9                  cn=0,n=2
         4 001044   000127 600002 xsym               ADSC9   ZI$DIR+87                cn=3,n=2
         4 001045   001052 602000 4                  TNC     s:5986
         4 001046   040000 106400                    CMPC    fill='040'O
         4 001047   000127 600002 xsym               ADSC9   ZI$DIR+87                cn=3,n=2
         4 001050   000147 000002 3                  ADSC9   OCHRS+3                  cn=0,n=2
         4 001051   001054 603000 4                  TRC     s:5987

      603     5986    2               ZI_DIR.DATEFLG = '0'B;

   5986  4 001052   000011 236000 5                  LDQ     9
         4 001053   000125 356000 xsym               ANSQ    ZI$DIR+85

      604     5987    2           IF ZI_DIR.TIME.MIN > '59' OR ZI_DIR.TIME.MIN < '00' THEN

   5987  4 001054   040000 106400                    CMPC    fill='040'O
         4 001055   000156 000002 3                  ADSC9   OCHRS+10                 cn=0,n=2
         4 001056   000130 200002 xsym               ADSC9   ZI$DIR+88                cn=1,n=2
         4 001057   001064 602000 4                  TNC     s:5988
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:115  
         4 001060   040000 106400                    CMPC    fill='040'O
         4 001061   000130 200002 xsym               ADSC9   ZI$DIR+88                cn=1,n=2
         4 001062   000147 000002 3                  ADSC9   OCHRS+3                  cn=0,n=2
         4 001063   001066 603000 4                  TRC     s:5989

      605     5988    2               ZI_DIR.DATEFLG = '0'B;

   5988  4 001064   000011 236000 5                  LDQ     9
         4 001065   000125 356000 xsym               ANSQ    ZI$DIR+85

      606     5989    2           IF ZI_DIR.TIME.SEC > '59' OR ZI_DIR.TIME.SEC < '00' THEN

   5989  4 001066   040000 106400                    CMPC    fill='040'O
         4 001067   000156 000002 3                  ADSC9   OCHRS+10                 cn=0,n=2
         4 001070   000130 600002 xsym               ADSC9   ZI$DIR+88                cn=3,n=2
         4 001071   001076 602000 4                  TNC     s:5990
         4 001072   040000 106400                    CMPC    fill='040'O
         4 001073   000130 600002 xsym               ADSC9   ZI$DIR+88                cn=3,n=2
         4 001074   000147 000002 3                  ADSC9   OCHRS+3                  cn=0,n=2
         4 001075   001100 603000 4                  TRC     s:5991

      607     5990    2               ZI_DIR.DATEFLG = '0'B;

   5990  4 001076   000011 236000 5                  LDQ     9
         4 001077   000125 356000 xsym               ANSQ    ZI$DIR+85

      608     5991    2           ZI_DIR.TIME.MIL = '00';

   5991  4 001100   000147 236000 3                  LDQ     OCHRS+3
         4 001101   000011 772000                    QRL     9
         4 001102   000131 552030 xsym               STBQ    ZI$DIR+89,'30'O

      609     5992    2           IF ZI_DIR.DATEFLG = '0'B THEN

   5992  4 001103   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001104   200000 316003                    CANQ    65536,DU
         4 001105   001342 601000 4                  TNZ     s:6092
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:116  

      610     5993    3           DO;

      611     5994         /*E* ERROR: ZIU-02001-C
      612     5995               MESSAGE: Improper time specification; format= "hhmmss". */
      613     5996    3    /**/       ERRCODESF.ERR#=2001;

   5996  4 001106   000000 236000 xsym               LDQ     ERRCODESF
         4 001107   000003 376000 5                  ANQ     3
         4 001110   037210 276007                    ORQ     16008,DL
         4 001111   000000 756000 xsym               STQ     ERRCODESF

      614     5997    3    /**/       MSGCODE = ERRCODE_RDEF;

   5997  4 001112   000000 756000 xsym               STQ     MSGCODE

      615     5998    3               ALTRETURN;

   5998  4 001113   000000 702200 xent               TSX2  ! X66_AALT

      616     5999    3               END;
      617     6000    2       CASE(#NKEY);

      618     6001    2           ZI_DIR.NOKEYS = '1'B;

   6001  4 001114   020000 236003                    LDQ     8192,DU
         4 001115   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001116   001342 710000 4                  TRA     s:6092

      619     6002    2       CASE(#NPNT);

      620     6003    2           ZI_DIR.NOPRNT = '1'B;

   6003  4 001117   000400 236003                    LDQ     256,DU
         4 001120   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001121   001342 710000 4                  TRA     s:6092

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:117  
      621     6004    2       CASE(#ITEM);

      622     6005    2           ZI_DIR.PITEM = '0'B;

   6005  4 001122   000012 236000 5                  LDQ     10
         4 001123   000125 356000 xsym               ANSQ    ZI$DIR+85
         4 001124   001342 710000 4                  TRA     s:6092

      623     6006    2       CASE(#NSET);

      624     6007    2           ZI_DIR.PSETS = '0'B;

   6007  4 001125   000013 236000 5                  LDQ     11
         4 001126   000125 356000 xsym               ANSQ    ZI$DIR+85
         4 001127   001342 710000 4                  TRA     s:6092

      625     6008    2       CASE(#PHEAD);

      626     6009    2           ZI_DIR.PHEAD2 = '0'B;

   6009  4 001130   000014 236000 5                  LDQ     12
         4 001131   000125 356000 xsym               ANSQ    ZI$DIR+85
         4 001132   001342 710000 4                  TRA     s:6092

      627     6010    2       CASE(#FSET);

      628     6011    2           IF KCNT = -1 THEN /* NO DBK SPECIFIED IN FSET */

   6011  4 001133   000000 235000 xsym               LDA     KCNT
         4 001134   000015 115000 5                  CMPA    13
         4 001135   001144 601000 4                  TNZ     s:6020

      629     6012    3           DO;

      630     6013         /*E* ERROR: ZIU-02028-C
      631     6014                           MESSAGE: At least one DBK must be specified
      632     6015                                   when using the FOLLOW SET option. */
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:118  
      633     6016    3    /**/       ERRCODESF.ERR# = 2028;

   6016  4 001136   000000 236000 xsym               LDQ     ERRCODESF
         4 001137   000003 376000 5                  ANQ     3
         4 001140   037540 276007                    ORQ     16224,DL
         4 001141   000000 756000 xsym               STQ     ERRCODESF

      634     6017    3    /**/       MSGCODE = ERRCODE_RDEF;

   6017  4 001142   000000 756000 xsym               STQ     MSGCODE

      635     6018    3               ALTRETURN;

   6018  4 001143   000000 702200 xent               TSX2  ! X66_AALT

      636     6019    3               END;
      637     6020    2           ZI_DIR.FSET = '1'B;

   6020  4 001144   000010 236003                    LDQ     8,DU
         4 001145   000125 256000 xsym               ORSQ    ZI$DIR+85

      638     6021    2           ZI_DIR.SET_NM = OUT$BLK.SUBLK$(0)-> OUT$SYM.TEXT;

   6021  4 001146   000003 471500                    LDP1    3,,PR0
         4 001147   100004 236100                    LDQ     4,,PR1
         4 001150   000033 772000                    QRL     27
         4 001151   000000 620006                    EAX0    0,QL
         4 001152   040000 100540                    MLR     fill='040'O
         4 001153   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 001154   000131 600036 xsym               ADSC9   ZI$DIR+89                cn=3,n=30
         4 001155   001342 710000 4                  TRA     s:6092

      639     6022    2       CASE(#LOCALKEY);

      640     6023    2           ZI_DIR.LOCALKEY = '1'B;

   6023  4 001156   002000 236003                    LDQ     1024,DU
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:119  
         4 001157   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001160   001342 710000 4                  TRA     s:6092

      641     6024    2       CASE(#ROLL);

      642     6025    2           ZI_DIR.ROLL = '1'B;

   6025  4 001161   000200 236003                    LDQ     128,DU
         4 001162   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001163   001342 710000 4                  TRA     s:6092

      643     6026    2       CASE(#REM);

      644     6027    2           ZI_DIR.POS = %REM#;

   6027  4 001164   000002 236003                    LDQ     2,DU
         4 001165   000141 552020 xsym               STBQ    ZI$DIR+97,'20'O
         4 001166   001342 710000 4                  TRA     s:6092

      645     6028    2       CASE(#REL);

      646     6029    2           ZI_DIR.POS = %REL#;

   6029  4 001167   000003 236003                    LDQ     3,DU
         4 001170   000141 552020 xsym               STBQ    ZI$DIR+97,'20'O
         4 001171   001342 710000 4                  TRA     s:6092

      647     6030    2       CASE(#REW);

      648     6031    2           ZI_DIR.POS = %PTV#;

   6031  4 001172   000004 236003                    LDQ     4,DU
         4 001173   000141 552020 xsym               STBQ    ZI$DIR+97,'20'O
         4 001174   001342 710000 4                  TRA     s:6092

      649     6032
      650     6033    2       CASE(#IBEX_SET,#IBEX_RESET,#IBEX_DISPLAY);
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:120  

      651     6034    2           ZI_DIR.SYSCTL = '1'B;

   6034  4 001175   020000 236007                    LDQ     8192,DL
         4 001176   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001177   001342 710000 4                  TRA     s:6092

      652     6035
      653     6036    2       CASE(#LOCKOPT);

      654     6037    2           ZI_DIR.LOCKCODE = 2; /* SET LOCK OR UNLOCK OPTION ON */

   6037  4 001200   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001201   000016 376000 5                  ANQ     14
         4 001202   004000 276007                    ORQ     2048,DL
         4 001203   000125 756000 xsym               STQ     ZI$DIR+85
         4 001204   001342 710000 4                  TRA     s:6092

      655     6038    2       CASE(#CHECK,#LOCK,#UNLOCK,#TESTLOCK);

      656     6039    2           ZI_DIR.SCHEMA_NEEDED = '1'B;

   6039  4 001205   004000 236003                    LDQ     2048,DU
         4 001206   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001207   001342 710000 4                  TRA     s:6092

      657     6040    2       CASE(#USEROPT);

      658     6041    2           USER_SYSID.CNT = ADDR(OUT$BLK)->OUT$SYM.COUNT;

   6041  4 001210   000004 236100                    LDQ     4,,PR0
         4 001211   000000 552040 xsym               STBQ    USER_SYSID,'40'O

      659     6042    2           USER_SYSID.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   6042  4 001212   000004 236100                    LDQ     4,,PR0
         4 001213   000033 772000                    QRL     27
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:121  
         4 001214   000000 620006                    EAX0    0,QL
         4 001215   040000 100540                    MLR     fill='040'O
         4 001216   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 001217   000000 200007 xsym               ADSC9   USER_SYSID               cn=1,n=7

      660     6043    2           CALL OCTBIN(ADDR(OUT$BLK)->OUT$SYM.COUNT);

   6043  4 001220   200003 236100                    LDQ     @OUT$BLK,,AUTO
         4 001221   000004 036003                    ADLQ    4,DU
         4 001222   200007 756100                    STQ     Q+3,,AUTO
         4 001223   001431 701000 4                  TSX1    OCTBIN
         4 001224   000000 011000                    NOP     0

      661     6044    2           INIT_RG.FIRNG(0) = KEY_RNG_TEMP * -1;

   6044  4 001225   000000 235003                    LDA     0,DU
         4 001226   000077 135000 2                  SBLA    KEY_RNG_TEMP
         4 001227   000000 755000 xsym               STA     INIT_RG

      662     6045    2           ZI_DIR.SYSID = INIT_RG.FIRNG(0);

   6045  4 001230   000027 755000 xsym               STA     ZI$DIR+23
         4 001231   001342 710000 4                  TRA     s:6092

      663     6046    2       CASE(#SYSOPT);

      664     6047    2           USER_SYSID.CNT = ADDR(OUT$BLK)->OUT$SYM.COUNT;

   6047  4 001232   000004 236100                    LDQ     4,,PR0
         4 001233   000000 552040 xsym               STBQ    USER_SYSID,'40'O

      665     6048    2           USER_SYSID.TEXT = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   6048  4 001234   000004 236100                    LDQ     4,,PR0
         4 001235   000033 772000                    QRL     27
         4 001236   000000 620006                    EAX0    0,QL
         4 001237   040000 100540                    MLR     fill='040'O
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:122  
         4 001240   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 001241   000000 200007 xsym               ADSC9   USER_SYSID               cn=1,n=7

      666     6049    2           CALL CHARBIN(ZI_DIR.SYSID,ADDR(OUT$BLK)->OUT$SYM.TEXT);

   6049  4 001242   000000 305540                    DTB
         4 001243   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         4 001244   000027 000004 xsym               NDSC9   ZI$DIR+23                cn=0,s=lsgnf,sf=0,n=4
         4 001245   001342 710000 4                  TRA     s:6092

      667     6050    2       CASE(#EVRYOPT);

      668     6051    2           CALL CHARBIN(ZI_DIR.WAIT,ADDR(OUT$BLK)->OUT$SYM.TEXT);

   6051  4 001246   000004 236100                    LDQ     4,,PR0
         4 001247   000033 772000                    QRL     27
         4 001250   000000 621006                    EAX1    0,QL
         4 001251   000000 305540                    DTB
         4 001252   000004 230011                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X1
         4 001253   000030 000004 xsym               NDSC9   ZI$DIR+24                cn=0,s=lsgnf,sf=0,n=4
         4 001254   001342 710000 4                  TRA     s:6092

      669     6052    2       CASE(#CHKOPT);

      670     6053    2           ZI_DIR.CHECK = '1'B; /* Turn on check option */

   6053  4 001255   001000 236003                    LDQ     512,DU
         4 001256   000125 256000 xsym               ORSQ    ZI$DIR+85

      671     6054    2           ZI_DIR.SCHEMA_NEEDED = '1'B;

   6054  4 001257   004000 236003                    LDQ     2048,DU
         4 001260   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001261   001342 710000 4                  TRA     s:6092

      672     6055    2       CASE(#REP_REC);

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:123  
      673     6056    2           ZI_DIR.REPRT_REC = %YES#;

   6056  4 001262   000400 236007                    LDQ     256,DL
         4 001263   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001264   001342 710000 4                  TRA     s:6092

      674     6057    2       CASE(#REP_AREA);

      675     6058    2           ZI_DIR.REPRT_AREA= %YES#;

   6058  4 001265   000100 236007                    LDQ     64,DL
         4 001266   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001267   001342 710000 4                  TRA     s:6092

      676     6059    2       CASE(#REPORT);

      677     6060    2           ZI_DIR.SCHEMA_NEEDED = %YES#;

   6060  4 001270   004000 236003                    LDQ     2048,DU
         4 001271   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001272   001342 710000 4                  TRA     s:6092

      678     6061    2       CASE(#REP_ALL);

      679     6062    2           ZI_DIR.REPRT_ALL = %YES#;

   6062  4 001273   001000 236007                    LDQ     512,DL
         4 001274   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001275   001342 710000 4                  TRA     s:6092

      680     6063    2       CASE(#REP_PG);

      681     6064    2           ZI_DIR.REPRT_PG = %YES#;

   6064  4 001276   000200 236007                    LDQ     128,DL
         4 001277   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001300   001342 710000 4                  TRA     s:6092
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:124  

      682     6065    2       CASE(#REP_ERRS);

      683     6066    2           ZI_DIR.REPRT_ERRS = %YES#;

   6066  4 001301   000040 236007                    LDQ     32,DL
         4 001302   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001303   001342 710000 4                  TRA     s:6092

      684     6067    2       CASE(#REP_ZERO);

      685     6068    2           ZI_DIR.REPRT_ZERO = %YES#;

   6068  4 001304   000020 236007                    LDQ     16,DL
         4 001305   000125 256000 xsym               ORSQ    ZI$DIR+85
         4 001306   001342 710000 4                  TRA     s:6092

      686     6069    2       CASE(#VALIDATE);

      687     6070    2           ZI_DIR.AUTODUMP = '1'B;

   6070  4 001307   400000 236007                    LDQ     -131072,DL
         4 001310   000026 256000 xsym               ORSQ    ZI$DIR+22
         4 001311   001342 710000 4                  TRA     s:6092

      688     6071        /*        CASE(#VAL_LST);
      689     6072                         RCNT = RCNT+1;
      690     6073                         RECORD_LIST.NAME(RCNT) = ADDR(OUT$BLK) -> OUT$SYM.TEXT;
      691     6074
      692     6075                  CASE(#NVAL_LST);
      693     6076                         ITMCNT = ITMCNT+1;
      694     6077                         ITEM_LIST.NAME(ITMCNT) = ADDR(OUT$BLK) ->  OUT$SYM.TEXT;
      695     6078                                                                    */
      696     6079
      697     6080    2       CASE(#ALTKEY_OPT,#REP_PA);

      698     6081    2           ZI_DIR.ALTKEY = '1'B;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:125  

   6081  4 001312   100000 236003                    LDQ     32768,DU
         4 001313   000126 256000 xsym               ORSQ    ZI$DIR+86
         4 001314   001342 710000 4                  TRA     s:6092

      699     6082    2       CASE(#ALTKEY);

      700     6083    2           ALTKY.VALUE = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   6083  4 001315   000003 471500                    LDP1    3,,PR0
         4 001316   100004 236100                    LDQ     4,,PR1
         4 001317   000033 772000                    QRL     27
         4 001320   000000 621006                    EAX1    0,QL
         4 001321   040000 100540                    MLR     fill='040'O
         4 001322   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 001323   000000 000202 xsym               ADSC9   ALTKY                    cn=0,n=130
         4 001324   001342 710000 4                  TRA     s:6092

      701     6084    2       CASE(#KEYNAME);

      702     6085    2           ALTKY.KEYNAME = ADDR(OUT$BLK)->OUT$SYM.TEXT;

   6085  4 001325   000004 236100                    LDQ     4,,PR0
         4 001326   000033 772000                    QRL     27
         4 001327   000000 621006                    EAX1    0,QL
         4 001330   040000 100540                    MLR     fill='040'O
         4 001331   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         4 001332   000040 400036 xsym               ADSC9   ALTKY+32                 cn=2,n=30
         4 001333   001342 710000 4                  TRA     s:6092

      703     6086    2       CASE(#CALCKEY_OPT);

      704     6087    2           ZI_DIR.CALCKEY = %YES#;

   6087  4 001334   040000 236003                    LDQ     16384,DU
         4 001335   000126 256000 xsym               ORSQ    ZI$DIR+86
         4 001336   001342 710000 4                  TRA     s:6092
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:126  

      705     6088    2       CASE(#INV);

      706     6089    2           ZI_DIR.PRNT_INV = %YES#;

   6089  4 001337   020000 236003                    LDQ     8192,DU
         4 001340   000126 256000 xsym               ORSQ    ZI$DIR+86
         4 001341   001342 710000 4                  TRA     s:6092

      707     6090    2       CASE(ELSE);

      708     6091    2           END;

      709     6092    1       IF OUT$BLK.NSUBLKS=0 THEN RETURN;

   6092  4 001342   200003 470500                    LDP0    @OUT$BLK,,AUTO
         4 001343   000001 220100                    LDX0    1,,PR0
         4 001344   001346 601000 4                  TNZ     s:6093

   6092  4 001345   000000 702200 xent               TSX2  ! X66_ARET

      710     6093    2       DO CASE(OUT$BLK.NDTYPE);

   6093  4 001346   000000 236100                    LDQ     0,,PR0
         4 001347   000022 772000                    QRL     18
         4 001350   000077 376007                    ANQ     63,DL
         4 001351   000005 136007                    SBLQ    5,DL
         4 001352   000023 116007                    CMPQ    19,DL
         4 001353   001355 602006 4                  TNC     s:6093+7,QL
         4 001354   001401 710000 4                  TRA     s:6098
         4 001355   001400 710000 4                  TRA     s:6096
         4 001356   001401 710000 4                  TRA     s:6098
         4 001357   001401 710000 4                  TRA     s:6098
         4 001360   001401 710000 4                  TRA     s:6098
         4 001361   001401 710000 4                  TRA     s:6098
         4 001362   001401 710000 4                  TRA     s:6098
         4 001363   001401 710000 4                  TRA     s:6098
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:127  
         4 001364   001401 710000 4                  TRA     s:6098
         4 001365   001401 710000 4                  TRA     s:6098
         4 001366   001401 710000 4                  TRA     s:6098
         4 001367   001401 710000 4                  TRA     s:6098
         4 001370   001400 710000 4                  TRA     s:6096
         4 001371   001400 710000 4                  TRA     s:6096
         4 001372   001400 710000 4                  TRA     s:6096
         4 001373   001400 710000 4                  TRA     s:6096
         4 001374   001400 710000 4                  TRA     s:6096
         4 001375   001400 710000 4                  TRA     s:6096
         4 001376   001400 710000 4                  TRA     s:6096
         4 001377   001400 710000 4                  TRA     s:6096

      711     6094    2       CASE(%DSTRING#,%NULL#,%OCT#,%DEC#,%ALPHA#,%ALNUM#,

      712     6095    2          %SYM#,%ASYM#,%FID#);
      713     6096    2           RETURN;

   6096  4 001400   000000 702200 xent               TSX2  ! X66_ARET

      714     6097    2       CASE(ELSE);

      715     6098    2           Q=0;

   6098  4 001401   200004 450100                    STZ     Q,,AUTO

      716     6099    3           DO WHILE(Q < OUT$BLK.NSUBLKS);

   6099  4 001402   000001 236100                    LDQ     1,,PR0
         4 001403   000022 772000                    QRL     18
         4 001404   200004 116100                    CMPQ    Q,,AUTO
         4 001405   001430 602000 4                  TNC     s:6104
         4 001406   001430 600000 4                  TZE     s:6104

      717     6100    3               CALL INTERPRTR(OUT$BLK.SUBLK$(Q)->OUT$BLKX) ALTRET(ALT_INTERP);

   6100  4 001407   200003 470500                    LDP0    @OUT$BLK,,AUTO
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:128  
         4 001410   200004 720100                    LXL0    Q,,AUTO
         4 001411   000003 471510                    LDP1    3,X0,PR0
         4 001412   200010 451500                    STP1    @TXTC+1,,AUTO
         4 001413   200010 630500                    EPPR0   @TXTC+1,,AUTO
         4 001414   000005 631400 5                  EPPR1   5
         4 001415   000000 701000 4                  TSX1    s:6
         4 001416   001514 702000 4                  TSX2    ALT_INTERP

      718     6101    3               Q=Q+1;

   6101  4 001417   200004 235100                    LDA     Q,,AUTO
         4 001420   000001 035007                    ADLA    1,DL
         4 001421   200004 755100                    STA     Q,,AUTO

      719     6102    3               END;

   6102  4 001422   200003 470500                    LDP0    @OUT$BLK,,AUTO
         4 001423   000001 236100                    LDQ     1,,PR0
         4 001424   000022 772000                    QRL     18
         4 001425   200004 116100                    CMPQ    Q,,AUTO
         4 001426   001430 600000 4                  TZE     s:6104
         4 001427   001407 603000 4                  TRC     s:6100

      720     6103    2           END;

      721     6104    1       RETURN;

   6104  4 001430   000000 702200 xent               TSX2  ! X66_ARET

      722     6105        %EJECT;
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:129  
      723     6106    1   OCTBIN: PROC(TXTC);

   6106  4 001431   200006 741300       OCTBIN       STX1  ! Q+2,,AUTO

      724     6107    2   DCL 1 TXTC UNAL,
      725     6108    2         2 SZ UBIN BYTE UNAL,
      726     6109    2         2 TX CHAR(TXTC.SZ) UNAL;
      727     6110    2   DCL OCHRS CHAR(8) CONSTANT INIT('01234567');
      728     6111
      729     6112    2       KEY_RNG_TEMP = 0;

   6112  4 001432   000077 450000 2                  STZ     KEY_RNG_TEMP

      730     6113    3       DO I = 0 TO TXTC.SZ-1;

   6113  4 001433   000000 450000 xsym               STZ     I
         4 001434   001454 710000 4                  TRA     s:6117+1

      731     6114
      732     6115    3           CALL INDEX1(X,SUBSTR(TXTC.TX,I,1),SUBSTR(OCHRS,0,8));

   6115  4 001435   200007 470500                    LDP0    @TXTC,,AUTO
         4 001436   000100 101500                    MRL     fill='000'O
         4 001437   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 001440   200010 000002                    ADSC9   @TXTC+1,,AUTO            cn=0,n=2
         4 001441   200010 220100                    LDX0    @TXTC+1,,AUTO
         4 001442   000000 235000 xsym               LDA     I
         4 001443   000105 124400                    SCM     mask='000'O
         4 001444   000144 000010 3                  ADSC9   OCHRS                    cn=0,n=8
         4 001445   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         4 001446   000000 000000 xsym               ARG     X

      733     6116    3           KEY_RNG_TEMP = (KEY_RNG_TEMP * 8) + X;

   6116  4 001447   000077 236000 2                  LDQ     KEY_RNG_TEMP
         4 001450   000003 736000                    QLS     3
         4 001451   000000 036000 xsym               ADLQ    X
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:130  
         4 001452   000077 756000 2                  STQ     KEY_RNG_TEMP

      734     6117    3           END;

   6117  4 001453   000000 054000 xsym               AOS     I
         4 001454   200007 470500                    LDP0    @TXTC,,AUTO
         4 001455   000100 101500                    MRL     fill='000'O
         4 001456   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 001457   200010 000004                    ADSC9   @TXTC+1,,AUTO            cn=0,n=4
         4 001460   200010 236100                    LDQ     @TXTC+1,,AUTO
         4 001461   000000 116000 xsym               CMPQ    I
         4 001462   001435 605400 4                  TPNZ    s:6115

      735     6118    2       RETURN;

   6118  4 001463   200006 221300                    LDX1  ! Q+2,,AUTO
         4 001464   000001 702211                    TSX2  ! 1,X1

      736     6119    2   END OCTBIN;
      737     6120    1   NO_IDS_MSG: ERRCODESF.ERR#=DBU#NO_IDS_MSG;

   6120  4 001465   000000 236000 xsym  NO_IDS_MSG   LDQ     ERRCODESF
         4 001466   000003 376000 5                  ANQ     3
         4 001467   220070 276007                    ORQ     73784,DL
         4 001470   000000 756000 xsym               STQ     ERRCODESF

      738     6121    1       ERRFLGSF = 0;

   6121  4 001471   000000 450000 xsym               STZ     ERRFLGSF

      739     6122    1       MSGCODE = ERRCODE_RDEF;

   6122  4 001472   000000 756000 xsym               STQ     MSGCODE

      740     6123    1       ERR_INSERT.CNT(0)=ADDR(OUT$BLK)->OUT$SYM.COUNT;

   6123  4 001473   200003 470500                    LDP0    @OUT$BLK,,AUTO
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:131  
         4 001474   000004 236100                    LDQ     4,,PR0
         4 001475   000000 552040 xsym               STBQ    ERR_INSERT,'40'O

      741     6124    1       ERR_INSERT.TEXT(0)=ADDR(OUT$BLK)->OUT$SYM.TEXT;

   6124  4 001476   000004 236100                    LDQ     4,,PR0
         4 001477   000033 772000                    QRL     27
         4 001500   000000 620006                    EAX0    0,QL
         4 001501   040000 100540                    MLR     fill='040'O
         4 001502   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 001503   000000 200036 xsym               ADSC9   ERR_INSERT               cn=1,n=30

      742     6125    1       CALL SYS_FUNC_ERRMSG;

   6125  4 001504   000004 631400 5                  EPPR1   4
         4 001505   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 001506   000000 011000                    NOP     0

      743     6126    1       RETURN; /* TAKE NORMAL RETURN */

   6126  4 001507   000000 702200 xent               TSX2  ! X66_ARET

      744     6127        /*E*  ERROR: ZIU-DBU#NO_IDS_MSG-C
      745     6128        MESSAGE: The value %U1 is not a legal IDS status code.
      746     6129                 Check the value again to make sure you have the correct one.
      747     6130                       */
      748     6131    1   ALT_HELP:
      749     6132    1       HELPCODE = HELP_PARAM.ERR;

   6132  4 001510   000015 236000 2     ALT_HELP     LDQ     HELP_PARAM+11
         4 001511   000000 756000 xsym               STQ     HELPCODE

      750     6133    1       MSGCODE = HELPCODE_RDEF;

   6133  4 001512   000000 235000 xsym               LDA     HELPCODE
         4 001513   000000 755000 xsym               STA     MSGCODE

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:132  
      751     6134    1   ALT_INTERP:
      752     6135    1       ALTRETURN;

   6135  4 001514   000000 702200 xent  ALT_INTERP   TSX2  ! X66_AALT

DBUTILX
 Sect OctLoc
   2     000   006104 102125   124111 114***                                    .DBUTIL.

HELP_PARAM
 Sect OctLoc
   2     002   000001 577640   000000 006000   000000 177640   000000 006014    ................
   2     006   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     012   000000 000000   000000 006014   000000 000000   0***** ******    ................
   2     016   000000 000000   000000 000000   003040 040040   040040 040040    .........
   2     022   040040 040040   040040 040040   040040 040040   040040 040040
   2     026   040040 040040   040040 040040   040040 040000   040040 040040               .
   2     032   040040 040040   040040 040040   040040 040040   040040 040040
   2     046*  040*** ******   ****** ******   000000 177640   000000 006014     ...............
   2     052   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     056   000000 177640   000000 006014   000000 361101   000000 000000    ...........A....
   2     062   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     072*  000000 000000                                                    ....

ACCTNAME
 Sect OctLoc
   2     074   072123 131123   040040 040040                                    :SYS

IDS_STATEMENT
 Sect OctLoc
   3     000   020116 117124   040101 040126   101114 111104   040103 117104    .NOT A VALID COD
   3     004   105040 040040   006101 103103   105120 124040   040040 040040    E   .ACCEPT
   3     010   040040 040040   040040 040040   007103 117116   116105 103124            .CONNECT
   3     014   040040 040040   040040 040040   040040 040040   012104 111123                .DIS
   3     020   103117 116116   105103 124040   040040 040040   040040 040040    CONNECT
   3     024   005105 122101   123105 040040   040040 040040   040040 040040    .ERASE
   3     030   040040 040040   004106 111116   104040 040040   040040 040040        .FIND
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:133  
   3     034   040040 040040   040040 040040   006106 111116   111123 110040            .FINISH
   3     040   040040 040040   040040 040040   040040 040040   020116 117124                .NOT
   3     044   040101 040126   101114 111104   040103 117104   105040 040040     A VALID CODE
   3     050   003107 105124   040040 040040   040040 040040   040040 040040    .GET
   3     054   040040 040040   002111 106040   040040 040040   040040 040040        .IF
   3     060   040040 040040   040040 040040   020116 117124   040101 040126            .NOT A V
   3     064   101114 111104   040103 117104   105040 040040   006115 117104    ALID CODE   .MOD
   3     070   111106 131040   040040 040040   040040 040040   040040 040040    IFY
   3     074   020116 117124   040101 040126   101114 111104   040103 117104    .NOT A VALID COD
   3     100   105040 040040   005122 105101   104131 040040   040040 040040    E   .READY
   3     104   040040 040040   040040 040040   020116 117124   040101 040126            .NOT A V
   3     110   101114 111104   040103 117104   105040 040040   005123 124117    ALID CODE   .STO
   3     114   122105 040040   040040 040040   040040 040040   040040 040040    RE
   3     120   020116 117124   040101 040126   101114 111104   040103 117104    .NOT A VALID COD
   3     124   105040 040040   020116 117124   040101 040126   101114 111104    E   .NOT A VALID
   3     130   040103 117104   105040 040040   003110 111101   040040 040040     CODE   .HIA
   3     134   040040 040040   040040 040040   040040 040040   011122 117114                .ROL
   3     140   114040 102101   103113 040040   040040 040040   040040 040040    L BACK

OCHRS
 Sect OctLoc
   3     144   060061 062063   064065 066067                                    01234567

(unnamed)
 Sect OctLoc
   3     146   101114 114040   060060 060060   060060 060060   071071 040040    ALL 0000000099
   3     152   060061 040040   061062 040040   063061 040040   062063 040040    01  12  31  23
   3     156   065071 040040                                                    59

(unnamed)
 Sect OctLoc
   5     000   000007 600000   040040 040040   637777 777777   777777 400007    ....    ........
   5     004   000000 000000   000001 000000   000001 777640   000074 006000    .............<..
   5     010   000002 006000   577777 777777   777737 777777   777777 677777    ................
   5     014   777777 737777   777777 777777   777777 761777                    ............
      753     6136    1   END INTERPRTR;

PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:134  
--  Include file information  --

   XUH_MACRO_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure INTERPRTR.

   Procedure INTERPRTR requires 845 words for executable code.
   Procedure INTERPRTR requires 10 words of local(AUTO) storage.

    No errors detected in file ZIU$Q2DI.:ZIC0TSI    .
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:135  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:136  
          MINI XREF LISTING

ACCTNAME
      5643**DCL      5950--ASSIGN
ACNT_IDX
       603**DCL      5961<<ASSIGN   5961>>ASSIGN   5962>>ASSIGN
ALTKY.KEYNAME
       299**DCL      6085<<ASSIGN
ALTKY.VALUE
       298**DCL      6083<<ASSIGN
ALT_HELP
      6132**LABEL    5952--CALLALT  5955--CALLALT  5958--CALLALT
ALT_INTERP
      6135**LABEL    6100--CALLALT
B$JIT.CPFLAGS1.SLEAZE
      3942**DCL      3942--REDEF
B$JIT.ERR.MID
      3849**DCL      3849--REDEF
B$JIT.JRESPEAK
      4010**DCL      4011--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      4119**DCL      4119--REDEF    4120--REDEF
B$JIT.PNR
      4023**DCL      4023--REDEF
B$JIT.TSLINE
      4117**DCL      4118--REDEF
B$JIT$
       622**DCL      3843--IMP-PTR
COUNTSF
       572**DCL       573--REDEF
DBUTILX
      4231**DCL      5559--DCLINIT
DMPCNT
       601**DCL      5885<<ASSIGN   5885>>ASSIGN   5886>>ASSIGN
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:137  
DUMP_FID.NAME
       296**DCL      5886<<ASSIGN
ENCRP_SEEDSF
       530**DCL       531--REDEF
ERRCODESF
       532**DCL       537--REDEF
ERRCODESF.ERR#
       535**DCL      5914<<ASSIGN   5938<<ASSIGN   5978<<ASSIGN   5996<<ASSIGN   6016<<ASSIGN   6120<<ASSIGN
ERRCODE_RDEF
       537**DCL      5915>>ASSIGN   5941>>ASSIGN   5979>>ASSIGN   5997>>ASSIGN   6017>>ASSIGN   6122>>ASSIGN
ERRFLGSF
       561**DCL      5939<<ASSIGN   6121<<ASSIGN
ERR_INSERT
       545**DCL      5935<<ASSIGN
ERR_INSERT.CNT
       546**DCL      6123<<ASSIGN
ERR_INSERT.TEXT
       547**DCL      6124<<ASSIGN
FIDSF_RD
       548**DCL       549--REDEF
HELPCODE
       566**DCL       571--REDEF    6132<<ASSIGN
HELPCODE_RDEF
       571**DCL      6133>>ASSIGN
HELP_PARAM
      5555**DCL      5952<>CALL     5955<>CALL     5958<>CALL
HELP_PARAM.ALL#
      5567**DCL      5957<<ASSIGN
HELP_PARAM.ERR
      5572**DCL      6132>>ASSIGN
HELP_PARAM.HELP$
      5565**DCL      5951<<ASSIGN
HELP_PARAM.MORE#
      5568**DCL      5954<<ASSIGN
HELP_PARAM.PROCACCT_
      5560**DCL      5950<<ASSIGN
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:138  
I
       604**DCL      6113<<DOINDEX  6115>>CALLBLT
ICHKSUM
       631**DCL       632--REDEF
ICNT
       596**DCL      5825<<ASSIGN   5825>>ASSIGN   5827>>ASSIGN   5828>>ASSIGN   5832>>ASSIGN
IDS_STATEMENT
      5654**DCL      5695--REDEF
IDS_STMT
      5695**DCL      5935>>ASSIGN
INCL_ERR
       544**DCL      5940<<ASSIGN
INIT_RG.FIRNG
       302**DCL      5827<<ASSIGN   6044<<ASSIGN   6045>>ASSIGN
INIT_RG.SECRNG
       303**DCL      5828<<ASSIGN   5832<<ASSIGN
INIT_RG_TEMP
      5647**DCL      5826<<CALLBLT  5827>>ASSIGN   5828>>ASSIGN   5831<<CALLBLT  5832>>ASSIGN   5932<<CALLBLT
      5933>>ASSIGN   5936>>ASSIGN   5938>>ASSIGN
INTERPRTR
         6**PROC     6100--CALL
ITEM_LIST.NAME
       308**DCL      5890<<ASSIGN
ITEM_LIST.TYPE
       309**DCL      5891<<ASSIGN
ITMCNT
       633**DCL      5889<<ASSIGN   5889>>ASSIGN   5890>>ASSIGN   5891>>ASSIGN
I_O_BUF$
       609**DCL       610--IMP-PTR
KCNT
       602**DCL      5852<<ASSIGN   5852>>ASSIGN   5857>>ASSIGN   5858>>ASSIGN   5865>>ASSIGN   6011>>IF
KEYVSF
       504**DCL       509--REDEF
KEYVSF.WD_ONE
       506**DCL       507--REDEF
KEY_RNG.FIR
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:139  
       305**DCL      5857<<ASSIGN
KEY_RNG.SEC
       306**DCL      5858<<ASSIGN   5865<<ASSIGN
KEY_RNG_TEMP
      5648**DCL      5798>>ASSIGN   5802>>ASSIGN   5856<<CALLBLT  5857>>ASSIGN   5858>>ASSIGN   5864<<CALLBLT
      5865>>ASSIGN   6044>>ASSIGN   6112<<ASSIGN   6116<<ASSIGN   6116>>ASSIGN
MONITOR_ERR.FN_CODE
       540**DCL      5942<<ASSIGN
MSGCODE
       538**DCL       539--REDEF    5915<<ASSIGN   5941<<ASSIGN   5979<<ASSIGN   5997<<ASSIGN   6017<<ASSIGN
      6122<<ASSIGN   6133<<ASSIGN
NO_IDS_MSG
      6120**LABEL    5944--CALLALT
OCHRS IN PROCEDURE OCTBIN
      6110**DCL      6115>>CALLBLT
OCTBIN
      6106**PROC     5797--CALL     5801--CALL     5854--CALL     5862--CALL     6043--CALL
OUT$BLK
      5603**DCL         6--PROC     5797--CALL     5801--CALL     5805--ASSIGN   5805--ASSIGN   5816--ASSIGN
      5816--ASSIGN   5826--CALLBLT  5826--CALLBLT  5831--CALLBLT  5831--CALLBLT  5839--CALLBLT  5839--CALLBLT
      5854--CALL     5856--CALLBLT  5856--CALLBLT  5862--CALL     5864--CALLBLT  5864--CALLBLT  5868--ASSIGN
      5868--ASSIGN   5871--ASSIGN   5871--ASSIGN   5879--ASSIGN   5879--ASSIGN   5886--ASSIGN   5886--ASSIGN
      5890--ASSIGN   5890--ASSIGN   5900--ASSIGN   5900--ASSIGN   5901--ASSIGN   5901--ASSIGN   5904--ASSIGN
      5904--ASSIGN   5905--ASSIGN   5905--ASSIGN   5932--CALLBLT  5932--CALLBLT  5966--ASSIGN   5966--ASSIGN
      5984--ASSIGN   5984--ASSIGN   6041--ASSIGN   6042--ASSIGN   6042--ASSIGN   6043--CALL     6047--ASSIGN
      6048--ASSIGN   6048--ASSIGN   6049--CALLBLT  6049--CALLBLT  6051--CALLBLT  6051--CALLBLT  6085--ASSIGN
      6085--ASSIGN   6123--ASSIGN   6124--ASSIGN   6124--ASSIGN
OUT$BLK.CODE
      5611**DCL      5786>>IF       5786>>IF       5788>>ASSIGN   5789>>DOCASE   5881>>ASSIGN
OUT$BLK.NDTYPE
      5606**DCL      5853>>IF       5861>>IF       6093>>DOCASE
OUT$BLK.NSUBLKS
      5615**DCL      6092>>IF       6099>>DOWHILE
OUT$BLK.SUBLK$
      5636**DCL      5951>>ASSIGN   5962>>ASSIGN   5962>>ASSIGN   6021>>ASSIGN   6021>>ASSIGN   6083>>ASSIGN
      6083>>ASSIGN   6100>>CALL
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:140  
OUT$BLKX
      5705**DCL      6100<>CALL
OUT$SYM.COUNT
      5774**DCL      5777--IMP-SIZ  5797<>CALL     5801<>CALL     5805>>ASSIGN   5816>>ASSIGN   5826>>CALLBLT
      5831>>CALLBLT  5839>>CALLBLT  5854<>CALL     5856>>CALLBLT  5862<>CALL     5864>>CALLBLT  5868>>ASSIGN
      5871>>ASSIGN   5879>>ASSIGN   5886>>ASSIGN   5890>>ASSIGN   5900>>ASSIGN   5901>>ASSIGN   5904>>ASSIGN
      5905>>ASSIGN   5932>>CALLBLT  5962>>ASSIGN   5966>>ASSIGN   5984>>ASSIGN   6021>>ASSIGN   6041>>ASSIGN
      6042>>ASSIGN   6043<>CALL     6047>>ASSIGN   6048>>ASSIGN   6049>>CALLBLT  6051>>CALLBLT  6083>>ASSIGN
      6085>>ASSIGN   6123>>ASSIGN   6124>>ASSIGN
OUT$SYM.TEXT
      5777**DCL      5805>>ASSIGN   5816>>ASSIGN   5826>>CALLBLT  5831>>CALLBLT  5839>>CALLBLT  5856>>CALLBLT
      5864>>CALLBLT  5868>>ASSIGN   5871>>ASSIGN   5879>>ASSIGN   5886>>ASSIGN   5890>>ASSIGN   5900>>ASSIGN
      5901>>ASSIGN   5904>>ASSIGN   5905>>ASSIGN   5932>>CALLBLT  5962>>ASSIGN   5966>>ASSIGN   5984>>ASSIGN
      6021>>ASSIGN   6042>>ASSIGN   6048>>ASSIGN   6049>>CALLBLT  6051>>CALLBLT  6083>>ASSIGN   6085>>ASSIGN
      6124>>ASSIGN
OUT$SYM.TEXTC$
      5769**DCL      5951>>ASSIGN
Q
        10**DCL      6098<<ASSIGN   6099>>DOWHILE  6100>>CALL     6101<<ASSIGN   6101>>ASSIGN
RCNT
       597**DCL      5867<<ASSIGN   5867>>ASSIGN   5868>>ASSIGN   5891>>ASSIGN
READ_SW
      5646**DCL      5791<<ASSIGN
REC$
       590**DCL       613--IMP-PTR
RECORD_LIST.NAME
       287**DCL      5868<<ASSIGN
REC_DATA_LN
       618**DCL       617--IMP-SIZ
RETAIN_LIST.NAME
       293**DCL      5879<<ASSIGN
RETCNT
       600**DCL      5878<<ASSIGN   5878>>ASSIGN   5879>>ASSIGN
SCNT
       598**DCL      5870<<ASSIGN   5870>>ASSIGN   5871>>ASSIGN
SET_LIST.NAME
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:141  
       290**DCL      5871<<ASSIGN
SUBMESSF
       558**DCL      5943<<ASSIGN
SYS_FUNC_ERRMSG
      5645**DCL-ENT  5944--CALL     6125--CALL
TXTC IN PROCEDURE OCTBIN
      6107**DCL      6106--PROC
TXTC.SZ IN PROCEDURE OCTBIN
      6108**DCL      6109--IMP-SIZ  6113>>DOINDEX  6115>>CALLBLT
TXTC.TX IN PROCEDURE OCTBIN
      6109**DCL      6115>>CALLBLT
USER_SYSID.CNT
      5651**DCL      6041<<ASSIGN   6047<<ASSIGN
USER_SYSID.TEXT
      5652**DCL      6042<<ASSIGN   6048<<ASSIGN
X
       607**DCL      5933<<ASSIGN   5934>>IF       5934<<ASSIGN   5935>>ASSIGN   5936<<ASSIGN   5937<<ASSIGN
      5937>>ASSIGN   5942>>ASSIGN   6115<<CALLBLT  6116>>ASSIGN
X$HELP
      5642**DCL-ENT  5952--CALL     5955--CALL     5958--CALL
ZI$DIR.ACNT
       192**DCL      5962<<ASSIGN
ZI$DIR.ACNTLIST
       208**DCL      5947<<ASSIGN
ZI$DIR.ALTKEY
       240**DCL       241--REDEF     242--REDEF    6081<<ASSIGN
ZI$DIR.AREAFID
       206**DCL       207--REDEF    5806<<ASSIGN
ZI$DIR.AREA_NM.NAME.TEXT
       272**DCL      5805<<ASSIGN   5808>>IF
ZI$DIR.AUTODUMP
       193**DCL      5810<<ASSIGN   6070<<ASSIGN
ZI$DIR.CALCKEY
       243**DCL      6087<<ASSIGN
ZI$DIR.CHECK
       215**DCL      6053<<ASSIGN
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:142  
ZI$DIR.CHECK_ALL
       258**DCL      5812<<ASSIGN
ZI$DIR.CODE
       222**DCL      5788<<ASSIGN
ZI$DIR.DATE
       245**DCL       249--REDEF
ZI$DIR.DATE.DY
       248**DCL      5972>>IF       5972>>IF
ZI$DIR.DATE.MO
       247**DCL      5970>>IF       5970>>IF
ZI$DIR.DATE.YR
       246**DCL      5968>>IF       5968>>IF
ZI$DIR.DATEFLG
       209**DCL      5965<<ASSIGN   5969<<ASSIGN   5971<<ASSIGN   5973<<ASSIGN   5974>>IF       5986<<ASSIGN
      5988<<ASSIGN   5990<<ASSIGN   5992>>IF
ZI$DIR.DATEIN
       249**DCL      5966<<ASSIGN
ZI$DIR.DESTFID
       205**DCL      5905<<ASSIGN
ZI$DIR.DEST_NM.NAME.TEXT
       282**DCL      5904<<ASSIGN
ZI$DIR.DEST_SEED
       201**DCL       202--REDEF     203--REDEF
ZI$DIR.DEST_SEED_RD
       202**DCL      5802<<ASSIGN
ZI$DIR.ENCP_SEED
       198**DCL       199--REDEF     200--REDEF
ZI$DIR.ENCP_SEED_RD
       199**DCL      5798<<ASSIGN
ZI$DIR.ENCRPT
       184**DCL      5836<<ASSIGN
ZI$DIR.FSET
       221**DCL      6020<<ASSIGN
ZI$DIR.INITL
       176**DCL      5793<<ASSIGN
ZI$DIR.INIT_TMPLT_KEY
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:143  
       262**DCL      5839<<CALLBLT
ZI$DIR.INVREBLD
       177**DCL      5894<<ASSIGN
ZI$DIR.KEYBLD
       183**DCL      5928<<ASSIGN
ZI$DIR.LOAD
       180**DCL      5925<<ASSIGN
ZI$DIR.LOCALKEY
       214**DCL      6023<<ASSIGN
ZI$DIR.LOCKCODE
       226**DCL      6037<<ASSIGN
ZI$DIR.NOKEYS
       211**DCL      6001<<ASSIGN
ZI$DIR.NOPRNT
       216**DCL      6003<<ASSIGN
ZI$DIR.OPEN_MODE
       210**DCL      5908<<ASSIGN   5918<<ASSIGN   5921<<ASSIGN
ZI$DIR.PHEAD2
       224**DCL      6009<<ASSIGN
ZI$DIR.PITEM
       219**DCL      6005<<ASSIGN
ZI$DIR.POS
       257**DCL      6027<<ASSIGN   6029<<ASSIGN   6031<<ASSIGN
ZI$DIR.PRINT
       182**DCL      5842<<ASSIGN
ZI$DIR.PRNT_INV
       244**DCL      6089<<ASSIGN
ZI$DIR.PRNT_OPT
       185**DCL      5846<<ASSIGN   5849<<ASSIGN
ZI$DIR.PSETS
       223**DCL      6007<<ASSIGN
ZI$DIR.RELOC
       235**DCL      5876<<ASSIGN
ZI$DIR.RELOC_FUNC
       263**DCL      5881<<ASSIGN
ZI$DIR.REPRT_ALL
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:144  
       227**DCL      6062<<ASSIGN
ZI$DIR.REPRT_AREA
       230**DCL      6058<<ASSIGN
ZI$DIR.REPRT_ERRS
       231**DCL      6066<<ASSIGN
ZI$DIR.REPRT_PG
       229**DCL      6064<<ASSIGN
ZI$DIR.REPRT_REC
       228**DCL      6056<<ASSIGN
ZI$DIR.REPRT_ZERO
       232**DCL       233--REDEF    6068<<ASSIGN
ZI$DIR.REP_OVER
       234**DCL      5874<<ASSIGN
ZI$DIR.RESTR
       236**DCL      5883<<ASSIGN
ZI$DIR.RNG_LIST
       175**DCL      5821<<ASSIGN
ZI$DIR.ROLL
       217**DCL      6025<<ASSIGN
ZI$DIR.SCHEMA_NEEDED
       213**DCL      5794<<ASSIGN   5811<<ASSIGN   5818<<ASSIGN   5843<<ASSIGN   5929<<ASSIGN   6039<<ASSIGN
      6054<<ASSIGN   6060<<ASSIGN
ZI$DIR.SCHEMA_NM.NAME.TEXT
       267**DCL      5816<<ASSIGN
ZI$DIR.SCHFID
       204**DCL       205--REDEF    5817<<ASSIGN
ZI$DIR.SET_NM
       256**DCL      6021<<ASSIGN
ZI$DIR.SRCEFID
       207**DCL      5901<<ASSIGN
ZI$DIR.SRCE_NM.NAME.TEXT
       277**DCL      5900<<ASSIGN
ZI$DIR.SYSCTL
       225**DCL      6034<<ASSIGN
ZI$DIR.SYSID
       200**DCL      6045<<ASSIGN   6049<<CALLBLT
PL6.E3A0      #003=INTERPRTR File=ZIU$Q2DI.:ZIC0TSI                              FRI 09/05/97 13:20 Page:145  
ZI$DIR.TIME
       250**DCL       255--REDEF
ZI$DIR.TIME.HR
       251**DCL      5985>>IF       5985>>IF
ZI$DIR.TIME.MIL
       254**DCL      5991<<ASSIGN
ZI$DIR.TIME.MIN
       252**DCL      5987>>IF       5987>>IF
ZI$DIR.TIME.SEC
       253**DCL      5989>>IF       5989>>IF
ZI$DIR.TIMEIN
       255**DCL      5967<<ASSIGN   5984<<ASSIGN
ZI$DIR.UNLOAD
       181**DCL      5897<<ASSIGN   5910>>IF
ZI$DIR.WAIT
       203**DCL      6051<<CALLBLT
