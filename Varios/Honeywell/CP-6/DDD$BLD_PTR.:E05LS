VERSION E05

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:1    
        1        1        /*M*  DDD$BLD_PTR - BUILDS DATA DESCRIPTOR ITEMS FOR A POINTER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DDD$BLD_PTR
       10       10             PURPOSE: BUILDS DATA DESCRIPTOR ITEMS FOR A POINTER
       11       11             DESCRIPTION: OPERATES ON M$PARSE OUTPUT TREE TO PRODUCE
       12       12                            DATA DESCRIPTOR ITEMS TO DESCRIBE ONE
       13       13                            POINTER OF A POINTER QUALIFICATION LIST (PQLIST) */
       14       14        /*D* NAME: DDD$BLD_PTR
       15       15             CALL: DDD$BLD_PTR(ROOT$) ALTRET(SEMANTIC_ERROR)
       16       16             INTERFACE: CALLS DDD$SUBREF, DDD$SIMEXP, DDS$SP_SRCH,
       17       17                            DDS$D_SRCH, DDS$SD_SRCH, DDS$ED_SRCH, DDS$IE_SRCH,
       18       18                            DDS$ST_SRCH, DDS$V_SRCH, DDS$UD_SRCH.
       19       19             INPUT: ROOT$ - PARM1 - PTR TO NODE IN PARSE TREE WHICH
       20       20                                    IS ROOT OF POINTER SPECIFICATION.
       21       21                                    THIS MUST BE VAREXP_CODE OR
       22       22                                    SIMEXP_CODE TYPE NODE.
       23       23                    S_D - GLOBAL DATA - DESC$, DESCL$, D$
       24       24                                      PTRS IN VARCOM WHERE DATA
       25       25                                      DESCRIPTORS ARE TO BE BUILT.
       26       26             OUTPUT: @ S_D.DESC$ - BUILDS DATA DESCRIPTOR ITEMS.
       27       27                         S_D.ERROR - ERROR CODE IF ALTRETURN.
       28       28                                                                           */
       29       29        DDD$BLD_PTR: PROC(ROOT$,BASED_FLAG) ALTRET;
       30       30                                                /* PARAMETERS */
       31       31    1   DCL ROOT$ PTR;
       32       32    1   DCL BASED_FLAG BIT(1) ALIGNED;          /* SET IF WE'RE BASED */
       33       33                                                /* LOCAL TEMPS */
       34       34    1   DCL ARRAY_FLAG BIT(1);                  /* SET IF SUBSCRIPT REFERENCE FOUND */
       35       35    1   DCL ADDREXP_FLAG BIT(1);
       36       36    1   DCL DIM_CNT SBIN;                  /* SET BY SUBREF TO NUMBER OF SUBS FOUND */
       37       37    1   DCL DIMS UBIN;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:2    
       38       38    1   DCL STRUCT UBIN;
       39       39    1   DCL MULT(0:6) PTR;
       40       40    1   DCL ARRAYTYP UBIN;
       41       41    1   DCL TEMP$ PTR;
       42       42    1   DCL SYM$ PTR;
       43       43    1   DCL SYM2$ PTR;
       44       44    1   DCL ENTRY$ PTR;
       45       45    1   DCL HIGH_ENTRY# UBIN;
       46       46    1   DCL RANGE_FLAG BIT(1) ALIGNED;          /* SET BY SUBREF IF INDEX RANGE FOUND */
       47       47    1   DCL NQFLAG BIT(1);
       48       48    1   DCL XQUAL BIT(1);
       49       49    1   DCL EXPR_IDX SBIN;
       50       50    1   DCL I SBIN;
       51       51    1   DCL IENTRY# SBIN;
       52       52    1   DCL T$ PTR;
       53       53    1   DCL IPTR$ PTR;
       54       54    1   DCL IENTRY$ PTR;
       55       55    1   DCL TATYP UBIN;
       56       56    1   DCL UBIN36 UBIN(36) BASED;
       57       57    1   DCL TEMP1 SBIN;
       58       58    1   DCL 1 SITEM_VAL REDEF TEMP1,
       59       59    1         2 ID UBIN(9) UNAL,
       60       60    1         2 * BIT(27);
       61       61    1   DCL DESC_VAL REDEF TEMP1 BIT(36);
       62       62    1   DCL ATYP REDEF TEMP1 SBIN;
       63       63    1   DCL TEMP2 SBIN;
       64       64    1   DCL 1 TEXTC BASED,
       65       65    1         2 SZ UBIN(9) UNAL,
       66       66    1         2 TXT CHAR(TEXTC.SZ);
       67       67    1   DCL 1 TXTC BASED,
       68       68    1         2 * UBIN(9) UNAL,
       69       69    1         2 TXT CHAR(31);
       70       70                                                /* EXTERNAL ROUTINES */
       71       71    1   DCL DDD$ADDREXP ENTRY(2) ALTRET;        /* BUILD ADDRESS EXPRESSION */
       72       72    1   DCL DDD$SUBREF ENTRY(4) ALTRET;         /* BUILD SUBSCRIPT REFERENCE */
       73       73    1   DCL DDD$SIMEXP ENTRY(3) ALTRET;         /* BUILD SIMPLE EXPRESSION */
       74       74    1   DCL DDD$MULT ENTRY(4) ALTRET;           /* STUFF NAME PTR LINKS */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:3    
       75       75    1   DCL DDS$SP_SRCH ENTRY(2) ALTRET;        /* SPECIAL SYMBOL SEARCH */
       76       76    1   DCL DDS$D_SRCH ENTRY(2) ALTRET;         /* SPECIAL DESC/PTR SEARCH */
       77       77    1   DCL DDS$SD_SRCH ENTRY(2) ALTRET;        /* SYMDEF SEARCH */
       78       78    1   DCL DDS$V_SRCH ENTRY(3) ALTRET;         /* VARIABLE SEARCH */
       79       79    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;        /* USER DEFINED SYMBOLS */
       80       80    1   DCL DDS$SET_Q2T ENTRY ALTRET;
       81       81    1   DCL DDS$SET_X2Q ENTRY ALTRET;
       82       82    1   DCL DDS$SET_T2Q ENTRY ALTRET;
       83       83    1   DCL DDF$VREBL_# ENTRY(2) ALTRET;
       84       84                                                /* MISC */
       85       85             %INCLUDE XU_MACRO_C;
       86     3191             %PARSE$OUT(NAME=O,SCRITCH=SCRATCH,STCLASS=BASED);
       87     3236             %INCLUDE XUH_MACRO_C;
       88     3320             %INCLUDE DD_SD_M;
       89     4656             %S_D;
       90     5974             %INCLUDE DD_ERR_C;
       91     6371             %INCLUDE DD_PSUBS_C;
       92     6846             %INCLUDE B$OBJECT_C;
       93    10276             %B$VREBL(STCLASS="BASED(ENTRY$)");
       94    10440             %VREBLSUBS;
       95    10448             %B$SDEF;
       96    10502             %INCLUDE DD$DITEM;
       12+   10605             %LIST;
       13+   10606    1        DCL SDD$ PTR;
       14+   10607    1        DCL ZITEM$ PTR;
       15+   10608    1        DCL SDD_L6$ PTR;
       16+   10609    1        DCL ZITEM_L6$ PTR;
       97    11183             %ZITEM;
       98    11255             %DITEM;
       99    11335             %INCLUDE DD$BASED;
      100    12638             %DD$VENTRY;
      101    12643             %INCLUDE DD_DESC_R;
      102    12693    1   DCL 1 DUMPTR_ITEM CONSTANT,
      103    12694    1         2 * UBIN(18) UNAL INIT(0),
      104    12695    1         2 * UBIN(9) UNAL INIT(0),
      105    12696    1         2 * UBIN(9) UNAL INIT(%PTR_ICODE), /* PTR_ICODE */
      106    12697    1         2 * UBIN(36) UNAL INIT(0);
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:4    
      107    12698                                                /**/
      108    12699    1        SDD$ = S_D.D$;
      109    12700    1        ZITEM$ = S_D.DESC$;
      110    12701    1        IF ROOT$ -> O.CODE = 40   /* VAREXP_CODE */
      111    12702    2        THEN DO;                           /* BUILD VARIABLE REFERENCE */
      112    12703    2             ARRAY_FLAG = '0'B;
      113    12704    2             DIM_CNT = 0;
      114    12705    2             IPTR$ = SDD$;                 /* Remember for implied PTR */
      115    12706    2             ADDREXP_FLAG = '0'B;
      116    12707    2             IF ROOT$ -> O.NSUBLKS > 1
      117    12708    3             THEN DO;                      /* PROCESS SUBREF / ADDREXP */
      118    12709    3                  TEMP$ = ROOT$ -> O.SUBLK$(1);
      119    12710    3                  IF TEMP$ -> O.CODE = 44 /* SUBREF_CODE */
      120    12711    4                  THEN DO;                 /* BUILD SUBSCRIPT REFERENCE */
      121    12712    4                       ARRAY_FLAG = '1'B;
      122    12713    4                       CALL DDD$SUBREF(TEMP$, RANGE_FLAG, DIM_CNT, MULT)
      123    12714    4                         ALTRET(PERR);
      124    12715    4                       SDD$ = S_D.D$;
      125    12716    4                       IF RANGE_FLAG
      126    12717    5                       THEN DO;
      127    12718    5                            S_D.ERROR = 1; /* E@RANGE_SPEC */
      128    12719    5                            GOTO PERR;
      129    12720    5                          END;
      130    12721    4                     END;                  /* BUILD SUBSCRIPT REFERENCE */
      131    12722    3                  EXPR_IDX = 1 + BITBIN(ARRAY_FLAG);
      132    12723    3                  IF ROOT$ -> O.NSUBLKS > EXPR_IDX
      133    12724    4                  THEN DO;                 /* BUILD ADDRESS EXPRESSION MODIFIER */
      134    12725    4                       IF BASED_FLAG
      135    12726    5                       THEN DO;
      136    12727    5                            S_D.ERROR = 2; /* E@ADDREXP */
      137    12728    5                            GOTO PERR;
      138    12729    5                          END;
      139    12730    4                       CALL DDD$ADDREXP(ROOT$, EXPR_IDX) ALTRET(PERR);
      140    12731    4                       SDD$ = S_D.D$;
      141    12732    4                       ADDREXP_FLAG = '1'B;
      142    12733    4                     END;                  /* BUILD ADDRESS EXPRESSION MODIFIER */
      143    12734    3                END;                       /* PROCESS SUBREF / ADDREXP */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:5    
      144    12735                                                /**/
      145    12736                                                /* TIME TO BUILD THE ACTUAL POINTER ITEM
      146    12737                                                */
      147    12738    2             TEMP$ = ROOT$ -> O.SUBLK$(0);
      148    12739    2             IF TEMP$ -> O.NSUBLKS = 1
      149    12740    2             THEN NQFLAG = '1'B;
      150    12741    2             ELSE NQFLAG = '0'B;
      151    12742    2             SYM2$ = TEMP$ -> O.SUBLK$(0); /* 1ST SYM OR QTSTRING OF LIST */
      152    12743    2             SYM$ = SYM2$ -> O.SUBLK$(0);  /* ACTUAL TEXTC */
      153    12744    2             IF SYM2$ -> O.CODE ~= 15 /* QTSTRING_CODE */
      154    12745    3             THEN DO;
      155    12746    3                  IF NQFLAG
      156    12747    4                  THEN DO;
      157    12748    4                       CALL DDS$D_SRCH(SYM$,DESC_VAL)
      158    12749    4                         ALTRET(GOT_DESC);
      159    12750    4                       CALL DDS$SP_SRCH(SYM$,SITEM_VAL)
      160    12751    4                         ALTRET(GOT_SPEC);
      161    12752    4                     END;
      162    12753    3                  ELSE GOTO SEARCH_VAR;
      163    12754    3                END;
      164    12755    2             IF NQFLAG
      165    12756    2             THEN CALL DDS$UD_SRCH(SYM$,TEMP1) ALTRET(GOT_UDEF);
      166    12757    2   SEARCH_VAR:
      167    12758    2             XQUAL = '0'B;
      168    12759    2             CALL DDS$V_SRCH(TEMP$,ENTRY$,ENTRY#) ALTRET(GOT_VAR);
      169    12760    2             HIGH_ENTRY# = ENTRY#.C;
      170    12761    2             IF S_D.XSCH.OK
      171    12762    3             THEN DO;
      172    12763    3                  CALL DDS$SET_Q2T;
      173    12764    3                  CALL DDS$SET_X2Q ALTRET( BADSCHEMA );
      174    12765    3                  XQUAL = '1'B;
      175    12766    3                  CALL DDS$V_SRCH(TEMP$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);
      176    12767    3                  IF ENTRY#.C > HIGH_ENTRY#
      177    12768    3                  THEN HIGH_ENTRY# = ENTRY#.C;
      178    12769    3                  CALL DDS$SET_T2Q ALTRET( BADSCHEMA );
      179    12770    3                END;
      180    12771    2             IF NQFLAG
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:6    
      181    12772    2             THEN CALL DDS$SD_SRCH(SYM$,ENTRY$) ALTRET(GOT_SDEF);
      182    12773    2             ELSE SYM$ = TEMP$ -> O.SUBLK$(HIGH_ENTRY#) -> O.SUBLK$(0);
      183    12774                                                /* NOT FOUND, MUST BE AN ERROR */
      184    12775    2             S_D.ERROR = 3;   /* E@SYM_NOTFOUND */
      185    12776    2             S_D.ERROR_SYM$ = SYM$;
      186    12777    2             ALTRETURN;
      187    12778    2   BADSCHEMA:
      188    12779    2             S_D.ERROR = 22;         /* E@UERR11 */
      189    12780    2             ALTRETURN;
      190    12781    2           END;                            /* BUILD VARIABLE REFERENCE */
      191    12782    2        ELSE DO;                           /* BUILD SIMPLE EXPRESSION PTR ITEM */
      192    12783    2             DITEM = '0'B;
      193    12784    2             DITEM.TYPE_CODE = %PTR_ICODE; /* PTR_ICODE */
      194    12785    2             CALL DDD$SIMEXP(ROOT$, TEMP1, DITEM.FLAGS.OFLAG) ALTRET(PERR);
      195    12786    2             DITEM.VALUE = TEMP1;
      196    12787    2             IF BASED_FLAG
      197    12788    2             THEN DITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */
      198    12789    2             ELSE DITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */
      199    12790    2             CALL BUMPD$ ALTRET(PERR);
      200    12791    2           END;
      201    12792    1        RETURN;
      202    12793                                                /*
      203    12794                                      COME HERE TO BUILD DESC/PTR SPECIAL SYMBOL ENTRY
      204    12795                                      */
      205    12796    1   GOT_DESC:
      206    12797    1        IF BASED_FLAG OR ARRAY_FLAG
      207    12798    2        THEN DO;
      208    12799    2             S_D.ERROR = 4;     /* E@INVLD_SPEC */
      209    12800    2             S_D.ERROR_SYM$ = SYM$;
      210    12801    2           END;
      211    12802    1        IF ADDREXP_FLAG
      212    12803    2        THEN DO;
      213    12804    2             S_D.ERROR = 87;    /* E@EXPNOTVALID */
      214    12805    2             ALTRETURN;
      215    12806    2           END;
      216    12807    1        ZITEM.FLAGS.MDSE.S = ZITEM.FLAGS.MDSE.S
      217    12808    1          | DITEM.SP.MDSE.S;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:7    
      218    12809    1        DITEM.VALUEB = DESC_VAL;
      219    12810    1        DITEM.ADDR_TYPE = %DESC_ACODE;     /* DESC_ACODE */
      220    12811    1        DITEM.TYPE_CODE = %PTR_ICODE;      /* PTR_ICODE */
      221    12812    1        GOTO DONE;
      222    12813                                                /*
      223    12814                                                 COME HERE TO BUILD SPECIAL SYMBOL ENTRY
      224    12815                                                 */
      225    12816    1   GOT_SPEC:
      226    12817                                 /* THE ONLY ALLOWABLE SPECIAL SYMBOL FOR PTRS IS $L */
      227    12818    1        IF (ADDR(SITEM_VAL) -> DITEM.SP.VS.ID ~= %L_RTN /* L_RTN */
      228    12819    1          AND ADDR(SITEM_VAL)->DITEM.SP.VS.ID ~= %O_RTN /* O_RTN */ )
      229    12820    1          OR BASED_FLAG OR ARRAY_FLAG
      230    12821    2        THEN DO;
      231    12822    2             S_D.ERROR = 4;     /* E@INVLD_SPEC */
      232    12823    2             S_D.ERROR_SYM$ = SYM$;
      233    12824    2             ALTRETURN;
      234    12825    2           END;
      235    12826    1        IF ADDREXP_FLAG AND NOT
             12826                 /* Address expression and not $O, $I, $L, @, @@, #, ##, $NA */
      236    12827    1          (SITEM_VAL.ID = %O_RTN OR        /* O_RTN */
      237    12828    1          SITEM_VAL.ID = %I_RTN OR         /* I_RTN */
      238    12829    1          SITEM_VAL.ID = %L_RTN OR         /* L_RTN */
      239    12830    1          SITEM_VAL.ID = %@_RTN OR         /* @_RTN */
      240    12831    1          SITEM_VAL.ID = %@@_RTN OR        /* @@_RTN */
      241    12832    1          SITEM_VAL.ID = %#_RTN OR         /* #_RTN */
      242    12833    1          SITEM_VAL.ID = %##_RTN OR        /* ##_RTN */
      243    12834    1          SITEM_VAL.ID = %NA_RTN)          /* NA_RTN */
      244    12835    2        THEN DO;
      245    12836    2             S_D.ERROR = 87;    /* E@EXPNOTVALID */
      246    12837    2             ALTRETURN;
      247    12838    2           END;
      248    12839    1        DITEM.VALUEB = SITEM_VAL;
      249    12840    1        DITEM.ADDR_TYPE = %SPEC_ACODE;     /* SPEC_ACODE */
      250    12841    1        DITEM.TYPE_CODE = %PTR_ICODE;      /* PTR_ICODE */
      251    12842    1        GOTO DONE;
      252    12843                                                /*
      253    12844                                           COME HERE TO BUILD USER DEFINED SYMBOL ENTRY
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:8    
      254    12845                                           */
      255    12846    1   GOT_UDEF:
      256    12847    1        IF ARRAY_FLAG
      257    12848    2        THEN DO;
      258    12849    2             S_D.ERROR = 6;      /* E@SUBSCRIPT */
      259    12850    2             S_D.ERROR_SYM$ = SYM$;
      260    12851    2             ALTRETURN;
      261    12852    2           END;
      262    12853    1        DITEM = DUMPTR_ITEM;
      263    12854    1        IF BASED_FLAG
      264    12855    1        THEN DITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */
      265    12856    1        ELSE DITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */
      266    12857    1        GOTO DONE;
      267    12858                                                /*
      268    12859                                                 COME HERE TO BUILD SYMDEF TYPE ENTRY
      269    12860                                                 */
      270    12861    1   GOT_SDEF:
      271    12862    1        IF ARRAY_FLAG
      272    12863    2        THEN DO;
      273    12864    2             S_D.ERROR = 5;           /* E@SDEF */
      274    12865    2             S_D.ERROR_SYM$ = SYM$;
      275    12866    2             ALTRETURN;
      276    12867    2           END;
      277    12868    1        DITEM = DUMPTR_ITEM;
      278    12869    1        TEMP1 = ENTRY$ -> B$SDEF.AD.OU.OFFSET;
      279    12870    1        DITEM.ADDRESS.W = TEMP1;
      280    12871    1        IF ENTRY$ -> B$SDEF.CONSTNT
      281    12872    1        THEN IF ~ BASED_FLAG
      282    12873    1             THEN IF ENTRY$ -> B$SDEF.LFLAGS.IS_DCB
      283    12874    2                  THEN DO;                 /* Stick in $DCBn PTR */
      284    12875    2                       DITEM.VALUEB = DESC.ITEM( %DCB_DESC ); /* DCB_DESC */
      285    12876    2                       DITEM.SP.VD.DISP = ENTRY$ -> B$SDEF.VALUE;
      286    12877    2                       DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      287    12878    2                     END;
      288    12879    2                  ELSE DO;
      289    12880    2                       S_D.ERROR = 5;
             12880                                /* E@SDEF - ADD ERROR FOR INVALID USE OF CONSTANT SYMDEF */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:9    
      290    12881    2                       S_D.ERROR_SYM$ = SYM$;
      291    12882    2                       ALTRETURN;
      292    12883    2                     END;
      293    12884    1             ELSE DITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */
      294    12885    1        ELSE IF BASED_FLAG
      295    12886    2             THEN DO;
      296    12887    2                  S_D.ERROR = 5;      /* E@SDEF */
      297    12888    2                  S_D.ERROR_SYM$ = SYM$;
      298    12889    2                  ALTRETURN;
      299    12890    2                END;
      300    12891    1             ELSE DITEM.ADDR_TYPE = %STATIC_ACODE; /* STATIC_ACODE */
      301    12892    1        GOTO DONE;
      302    12893                                                /*
      303    12894                                                 COME HERE TO BUILD VARIABLE TYPE ENTRY
      304    12895                                                 */
      305    12896    1   GOT_VAR:
      306    12897                                                /*
      307    12898                                                 MAKE VARIOUS CONSISTENCY CHECKS
      308    12899                                                 */
      309    12900    1        DIMS = 0;
      310    12901    2        DO I = 1 TO ENTRY#.C;
      311    12902    2             STRUCT = ENTRY#.C - I +1;
      312    12903    2             IF ENTRY#.C ~= 1
      313    12904    2             THEN CALL DDF$VREBL_#(ENTRY#.E(STRUCT), ENTRY$) ALTRET(BADSCHEMA);
      314    12905    2             ARRAYTYP = B$VREBL.ARRAYTYP;
      315    12906    3             DO CASE( ARRAYTYP );
      316    12907    3               CASE( %SCALAR_ARRAY );
      317    12908                                                /* Do nothing */
      318    12909    3               CASE( %VECTOR0_ARRAY, %VECTOR1_ARRAY );
      319    12910    3                  DIMS = DIMS + 1;
      320    12911    3               CASE( %REAL_ARRAY, %VIRTUAL_ARRAY, %ADJUSTABLE_ARRAY );
      321    12912    3                  DIMS = DIMS + B$VREBL.DIMS ;
      322    12913    3               CASE( ELSE );
      323    12914    3                  S_D.ERROR_SYM$ = SYM$;
      324    12915    3                  S_D.ERROR = 187; /* E@NOTIMPLARRAY */
      325    12916    3                  ALTRETURN;
      326    12917    3               END;                        /* DO CASE( ARRAYTYP ) */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:10   
      327    12918    2           END;                            /* DO I = 1 TO ENTRY#.C */
      328    12919    1        IF ENTRY#.C > 1
      329    12920    1        THEN CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);
      330    12921    1        IF DIM_CNT ~= DIMS
      331    12922    2        THEN DO;
      332    12923    2             S_D.ERROR_SYM$ = SYM$;
      333    12924    2             S_D.ERROR_HICHAR = DIMS;
      334    12925    2             S_D.ERROR = 188;     /* E@WRONG#SUBS */
      335    12926    2             ALTRETURN;
      336    12927    2           END;
      337    12928    1        ATYP = B$VREBL.ADDRTYP - 1;
      338    12929    1        IF BASED_FLAG AND NOT (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             12929                 PARM_ACODE OR
      339    12930    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      340    12931         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      341    12932    2        THEN DO;
      342    12933    2             S_D.ERROR_SYM$ = SYM$;
      343    12934    2             S_D.ERROR = 9;        /* E@VAR_REF */
      344    12935    2             ALTRETURN;
      345    12936    2           END;
      346    12937    1        IF B$VREBL.DATATYP ~= 13           /* PTR */
      347    12938    1          AND (ATYP ~= 3 OR B$VREBL.LEVEL ~= 1) /* DCB */
      348    12939    1          AND NOT ADDREXP_FLAG        /* Allow variable with address expression */
      349    12940    2        THEN DO;
      350    12941    2             S_D.ERROR_SYM$ = SYM$;
      351    12942    2             S_D.ERROR = 7;      /* E@INVLD_PTR */
      352    12943    2             ALTRETURN;
      353    12944    2           END;
      354    12945    1        IF NOT BASED_FLAG AND (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             12945                 PARM_ACODE OR
      355    12946    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      356    12947         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      357    12948    2        THEN DO;
      358    12949    2             IENTRY# = B$VREBL.IMPTR;
      359    12950    2             IF ATYP = %BASED_ACODE  /* BASED_ACODE */ AND IENTRY# < 0
      360    12951    3             THEN DO;
      361    12952    3                  S_D.ERROR_SYM$ = SYM$;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:11   
      362    12953    3                  S_D.ERROR = 99;     /* E@NOPTR */
      363    12954    3                  ALTRETURN;
      364    12955    3                END;
      365    12956    2             IF ATYP = %DCB_ACODE  /* DCB_ACODE */ AND B$VREBL.LEVEL = 1
      366    12957    3             THEN DO;                      /* DCBNAME ->    */
      367    12958    3                  DITEM.VALUEB = DESC.ITEM( %DCB_DESC ); /* DCB_DESC */
      368    12959    3                  DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      369    12960    3                  DITEM.SP.VD.DISP = IENTRY#;
      370    12961    3                  DITEM.TYPE_CODE = %PTR_ICODE; /* PTR_ICODE */
      371    12962    3                  GOTO DONE;
      372    12963    3                END;                       /* DCBNAME ->   */
      373    12964    2             T$ = SDD$;
      374    12965    2             CALL BUMPD$ ALTRET(PERR);
      375    12966    3             DO WHILE( T$ >= IPTR$ );
      376    12967    3                  PINCRW(T$,SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;
      377    12968    3                  T$ = PINCRW(T$, -1);
      378    12969    3                END;                       /* DO WHILE (T$ >= IPTR$ ) */
      379    12970    3             DO I = 0 TO DIM_CNT - 1;
      380    12971    3                  MULT( I ) = PINCRW(MULT( I ), SIZEW(DITEM));
      381    12972    3                END;
      382    12973    2             IF ATYP = %BASED_ACODE        /* BASED_ACODE */
      383    12974    3             THEN DO;                      /* Based variable */
      384    12975    3                  IPTR$ -> DITEM = DUMPTR_ITEM;
      385    12976    3                  CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);
      386    12977    4                  DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      387    12978    4                    CASE (%HOST);
      388    12979    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR.W;
      389    12980    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR.C;
      390    12981    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR.B;
      391    12982    4                    CASE (%L6);
      392    12983    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR6.W;
      393    12984    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR6.C;
      394    12985    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR6.B;
      395    12986    4                    CASE (ELSE);
      396    12987    4                       S_D.ERROR = 502; /* E@DELBUG */
      397    12988    4                       ALTRETURN;
      398    12989    4                    END;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:12   
      399    12990    3                  TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;
      400    12991    3                  IF TATYP = %PARM_ACODE OR TATYP = %SPARM_ACODE OR TATYP = %
             12991                           AREADEF_ACODE /* PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      401    12992    4                  THEN DO;       /* Implicit pointer is a parameter or areadef */
      402    12993    4                       IPTR$ -> DITEM.ADDR_TYPE = %PARM_ACODE; /* PARM_ACODE */
      403    12994    4                       T$ = SDD$;
      404    12995    4                       CALL BUMPD$ ALTRET(PERR);
      405    12996    5                       DO WHILE (T$ >= IPTR$ );
      406    12997    5                            PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;
      407    12998    5                            T$ = PINCRW(T$, -1);
      408    12999    5                          END;             /* DO WHILE (T$ >= IPTR$) */
      409    13000    5                       DO I = 0 TO DIM_CNT - 1;
      410    13001    5                            MULT(I) = PINCRW(MULT(I), SIZEW(DITEM));
      411    13002    5                          END;
      412    13003    4                       IF TATYP = %PARM_ACODE /* PARM_ACODE */
      413    13004    5                       THEN DO;            /* Auto parameter */
      414    13005    5                            IPTR$ -> DITEM.VALUEB = DESC.ITEM( %PARM_DESC );
             13005                                     /* PARM_DESC */
      415    13006    5                            IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      416    13007    5                            IPTR$ -> DITEM.SP.VP.N = IENTRY$ -> B$VREBL.IMPTR - 2;
      417    13008    5                            ZITEM.FLAGS.MDSE.S = '1'B; /* Need SS frame */
      418    13009    5                          END;             /* Auto parameter */
      419    13010    4                       ELSE IF TATYP = %SPARM_ACODE
             13010                                /* SPARM_ACODE - Static parameter */
      420    13011    5                            THEN DO;
      421    13012    5                                 IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.IMPTR;
      422    13013    5                                 IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE;
             13013                                          /* SPARM_ACODE */
      423    13014    5                               END;        /* Static parameter */
      424    13015    5                            ELSE DO;       /* TATYP = AREADEF_ACODE */
      425    13016    5                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             13016                                          /* CONST_ACODE */
      426    13017    5                                 IPTR$ -> DITEM.VALUE = PINCRW(IENTRY$, POFFW(ADDR(
             13017                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;
      427    13018    5                               END;
      428    13019    4                     END;        /* Implicit pointer is a parameter or areadef */
      429    13020    3                  ELSE IPTR$ -> DITEM.ADDR_TYPE = TATYP;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:13   
      430    13021    3                  CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);
      431    13022    3                END;                       /* Based variable */
      432    13023    2             ELSE IF ATYP = %PARM_ACODE    /* PARM_ACODE - auto parameter */
      433    13024    3                  THEN DO;
      434    13025    3                       IPTR$ -> DITEM = DUMPTR_ITEM;
      435    13026    3                       IPTR$ -> DITEM.VALUEB = DESC.ITEM( %PARM_DESC ); /* PARM_DESC */
      436    13027    3                       IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      437    13028    3                       IPTR$ -> DITEM.SP.VP.N = IENTRY# - 2;
      438    13029    3                       ZITEM.FLAGS.MDSE.S = '1'B; /* Need SS frame */
      439    13030    3                     END;                  /* Parameter */
      440    13031    2                  ELSE IF ATYP = %SPARM_ACODE /* SPARM_ACODE - Static parameter */
      441    13032    3                       THEN DO;
      442    13033    3                            IPTR$ -> DITEM = DUMPTR_ITEM;
      443    13034    3                            IPTR$ -> DITEM.ADDRESS.W = IENTRY#;
      444    13035    3                            IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE; /* SPARM_ACODE */
      445    13036    3                          END;             /* Static parameter */
      446    13037    2                       ELSE IF ATYP = %DCB_ACODE
             13037                                /* DCB_ACODE - DCB variable needs implicit PTR */
      447    13038    3                            THEN DO;
      448    13039    3                                 IPTR$ -> DITEM = DUMPTR_ITEM;
      449    13040    3                                 IPTR$ -> DITEM.VALUEB = DESC.ITEM ( %DCB_DESC );
             13040                                          /* DCB_DESC */
      450    13041    3                                 IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13041                                          /* DESC_ACODE */
      451    13042    3                                 IPTR$ -> DITEM.SP.VD.DISP = IENTRY#;
      452    13043    3                               END;        /* DCB variable */
      453    13044    3                            ELSE DO;       /* ATYP = AREADEF_ACODE */
      454    13045    3                                 IPTR$ -> DITEM = DUMPTR_ITEM;
      455    13046    3                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             13046                                          /* CONST_ACODE */
      456    13047    3                                 IPTR$ -> DITEM.VALUE = PINCRW(ENTRY$, POFFW(ADDR(
             13047                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;
      457    13048    3                               END;        /* ATYP = AREADEF_ACODE */
      458    13049    2             ATYP = %BASED_ACODE;          /* BASED_ACODE */
      459    13050    2           END;                            /* NOT BASED_FLAG AND (ATYP = 2 ..... */
      460    13051    1        IF BASED_FLAG
      461    13052    1        THEN ATYP = %BASED_ACODE;          /* BASED_ACODE */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:14   
      462    13053    1        DITEM = DUMPTR_ITEM;
      463    13054    1        DITEM.ADDR_TYPE = ATYP;
      464    13055    2        DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      465    13056    2          CASE (%HOST);
      466    13057    2             DITEM.ADDRESS.W = B$VREBL.ADR.W;
      467    13058    2             DITEM.ADDRESS.C = B$VREBL.ADR.C;
      468    13059    2             DITEM.ADDRESS.B = B$VREBL.ADR.B;
      469    13060    2          CASE (%L6);
      470    13061    2             DITEM.ADDRESS.W = B$VREBL.ADR6.W;
      471    13062    2             DITEM.ADDRESS.C = B$VREBL.ADR6.C;
      472    13063    2             DITEM.ADDRESS.B = B$VREBL.ADR6.B;
      473    13064    2          CASE (ELSE);
      474    13065    2             S_D.ERROR = 502;         /* E@DELBUG */
      475    13066    2             ALTRETURN;
      476    13067    2          END;
      477    13068    1        IF ARRAY_FLAG
      478    13069    1        THEN CALL DDD$MULT(DIM_CNT, MULT, ENTRY$, ENTRY#) ALTRET(PERR);
      479    13070    1        IF XQUAL
      480    13071    1        THEN CALL DDS$SET_T2Q ALTRET( BADSCHEMA );
      481    13072    1   DONE:
      482    13073    1        CALL BUMPD$ ALTRET(PERR);
      483    13074    1        RETURN;
      484    13075    1   PERR:
      485    13076    1        ALTRETURN;
      486    13077             %EJECT;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:15   
      487    13078             %BUMPD$;
             13079             %LIST;
             13080    1   BUMPD$: PROC(PCNT) ALTRET;
             13081    2   DCL PCNT UBIN;
             13082    2   DCL CNT UBIN;
             13083    2   DCL DD_VARCOM$ PTR SYMREF;
             13084    2   DCL DDM$GETMEM ENTRY(3) ALTRET;
             13085    2        IF ADDR(PCNT) = ADDR(NIL)
             13086    2        THEN CNT = SIZEW(DITEM);
             13087    2        ELSE CNT = PCNT;
             13088    2        SDD$ = PINCRW(SDD$,CNT);
             13089    2        IF SDD$ > S_D.DESCL$
             13090    3        THEN DO;
             13091    3             IF S_D.STORED ~= 0
             13092    4             THEN DO;
             13093    5                  DO WHILE (SDD$ > PINCRW(S_D.DESCL$, 1));
             13094    5                       CALL DDM$GETMEM(DD_VARCOM$, 1024);
             13095    5                       S_D.VARCOM_HIGH$ = PINCRW(S_D.VARCOM_HIGH$, 1024);
             13096    5                       S_D.DESCL$ = S_D.VARCOM_HIGH$;
             13097    5                     END;
             13098    4                END;
             13099    4             ELSE DO;
             13100    4                  S_D.ERROR = 8; /* E@NOROOM */
             13101    4                  ALTRETURN;
             13102    4                END;
             13103    3           END;
             13104    2        S_D.D$ = SDD$;
             13105    2        RETURN;
             13106    2        END BUMPD$;
      488    13109    1   END DDD$BLD_PTR;

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:16   
--  Include file information  --

   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDD$BLD_PTR.

   Procedure DDD$BLD_PTR requires 935 words for executable code.
   Procedure DDD$BLD_PTR requires 98 words of local(AUTO) storage.

    No errors detected in file DDD$BLD_PTR.:E05TSI    .

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:17   

 Object Unit name= DDD$BLD_PTR                                File name= DDD$BLD_PTR.:E05TOU
 UTS= JUL 29 '97 13:51:20.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  DDD$BLD_PTR
    1   Proc  even  none   935   1647  DDD$BLD_PTR
    2  RoData even  none     4      4  DDD$BLD_PTR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  DDD$BLD_PTR
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:18   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 DDD$SUBREF
 yes     yes           Std       2 DDD$ADDREXP
 yes     yes           Std       3 DDS$V_SRCH
 yes     yes           Std       4 DDD$MULT
 yes     yes           Std       2 DDS$D_SRCH
 yes     yes           Std       2 DDS$SP_SRCH
 yes     yes           Std       0 DDS$SET_T2Q
 yes     yes           Std       2 DDS$UD_SRCH
 yes     yes           Std       2 DDS$SD_SRCH
 yes     yes           Std       0 DDS$SET_X2Q
 yes     yes           Std       3 DDD$SIMEXP
 yes     yes           Std       0 DDS$SET_Q2T
 yes     yes           Std       2 DDF$VREBL_#
 yes     yes           Std       3 DDM$GETMEM
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  DESC                                  DD_VARCOM$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:19   


        1        1        /*M*  DDD$BLD_PTR - BUILDS DATA DESCRIPTOR ITEMS FOR A POINTER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DDD$BLD_PTR
       10       10             PURPOSE: BUILDS DATA DESCRIPTOR ITEMS FOR A POINTER
       11       11             DESCRIPTION: OPERATES ON M$PARSE OUTPUT TREE TO PRODUCE
       12       12                            DATA DESCRIPTOR ITEMS TO DESCRIBE ONE
       13       13                            POINTER OF A POINTER QUALIFICATION LIST (PQLIST) */
       14       14        /*D* NAME: DDD$BLD_PTR
       15       15             CALL: DDD$BLD_PTR(ROOT$) ALTRET(SEMANTIC_ERROR)
       16       16             INTERFACE: CALLS DDD$SUBREF, DDD$SIMEXP, DDS$SP_SRCH,
       17       17                            DDS$D_SRCH, DDS$SD_SRCH, DDS$ED_SRCH, DDS$IE_SRCH,
       18       18                            DDS$ST_SRCH, DDS$V_SRCH, DDS$UD_SRCH.
       19       19             INPUT: ROOT$ - PARM1 - PTR TO NODE IN PARSE TREE WHICH
       20       20                                    IS ROOT OF POINTER SPECIFICATION.
       21       21                                    THIS MUST BE VAREXP_CODE OR
       22       22                                    SIMEXP_CODE TYPE NODE.
       23       23                    S_D - GLOBAL DATA - DESC$, DESCL$, D$
       24       24                                      PTRS IN VARCOM WHERE DATA
       25       25                                      DESCRIPTORS ARE TO BE BUILT.
       26       26             OUTPUT: @ S_D.DESC$ - BUILDS DATA DESCRIPTOR ITEMS.
       27       27                         S_D.ERROR - ERROR CODE IF ALTRETURN.
       28       28                                                                           */
       29       29        DDD$BLD_PTR: PROC(ROOT$,BASED_FLAG) ALTRET;

     29  1 000000   000000 700200 xent  DDD$BLD_PTR  TSX0  ! X66_AUTO_2
         1 000001   000142 000002                    ZERO    98,2

       30       30                                                /* PARAMETERS */
       31       31    1   DCL ROOT$ PTR;
       32       32    1   DCL BASED_FLAG BIT(1) ALIGNED;          /* SET IF WE'RE BASED */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:20   
       33       33                                                /* LOCAL TEMPS */
       34       34    1   DCL ARRAY_FLAG BIT(1);                  /* SET IF SUBSCRIPT REFERENCE FOUND */
       35       35    1   DCL ADDREXP_FLAG BIT(1);
       36       36    1   DCL DIM_CNT SBIN;                  /* SET BY SUBREF TO NUMBER OF SUBS FOUND */
       37       37    1   DCL DIMS UBIN;
       38       38    1   DCL STRUCT UBIN;
       39       39    1   DCL MULT(0:6) PTR;
       40       40    1   DCL ARRAYTYP UBIN;
       41       41    1   DCL TEMP$ PTR;
       42       42    1   DCL SYM$ PTR;
       43       43    1   DCL SYM2$ PTR;
       44       44    1   DCL ENTRY$ PTR;
       45       45    1   DCL HIGH_ENTRY# UBIN;
       46       46    1   DCL RANGE_FLAG BIT(1) ALIGNED;          /* SET BY SUBREF IF INDEX RANGE FOUND */
       47       47    1   DCL NQFLAG BIT(1);
       48       48    1   DCL XQUAL BIT(1);
       49       49    1   DCL EXPR_IDX SBIN;
       50       50    1   DCL I SBIN;
       51       51    1   DCL IENTRY# SBIN;
       52       52    1   DCL T$ PTR;
       53       53    1   DCL IPTR$ PTR;
       54       54    1   DCL IENTRY$ PTR;
       55       55    1   DCL TATYP UBIN;
       56       56    1   DCL UBIN36 UBIN(36) BASED;
       57       57    1   DCL TEMP1 SBIN;
       58       58    1   DCL 1 SITEM_VAL REDEF TEMP1,
       59       59    1         2 ID UBIN(9) UNAL,
       60       60    1         2 * BIT(27);
       61       61    1   DCL DESC_VAL REDEF TEMP1 BIT(36);
       62       62    1   DCL ATYP REDEF TEMP1 SBIN;
       63       63    1   DCL TEMP2 SBIN;
       64       64    1   DCL 1 TEXTC BASED,
       65       65    1         2 SZ UBIN(9) UNAL,
       66       66    1         2 TXT CHAR(TEXTC.SZ);
       67       67    1   DCL 1 TXTC BASED,
       68       68    1         2 * UBIN(9) UNAL,
       69       69    1         2 TXT CHAR(31);
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:21   
       70       70                                                /* EXTERNAL ROUTINES */
       71       71    1   DCL DDD$ADDREXP ENTRY(2) ALTRET;        /* BUILD ADDRESS EXPRESSION */
       72       72    1   DCL DDD$SUBREF ENTRY(4) ALTRET;         /* BUILD SUBSCRIPT REFERENCE */
       73       73    1   DCL DDD$SIMEXP ENTRY(3) ALTRET;         /* BUILD SIMPLE EXPRESSION */
       74       74    1   DCL DDD$MULT ENTRY(4) ALTRET;           /* STUFF NAME PTR LINKS */
       75       75    1   DCL DDS$SP_SRCH ENTRY(2) ALTRET;        /* SPECIAL SYMBOL SEARCH */
       76       76    1   DCL DDS$D_SRCH ENTRY(2) ALTRET;         /* SPECIAL DESC/PTR SEARCH */
       77       77    1   DCL DDS$SD_SRCH ENTRY(2) ALTRET;        /* SYMDEF SEARCH */
       78       78    1   DCL DDS$V_SRCH ENTRY(3) ALTRET;         /* VARIABLE SEARCH */
       79       79    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;        /* USER DEFINED SYMBOLS */
       80       80    1   DCL DDS$SET_Q2T ENTRY ALTRET;
       81       81    1   DCL DDS$SET_X2Q ENTRY ALTRET;
       82       82    1   DCL DDS$SET_T2Q ENTRY ALTRET;
       83       83    1   DCL DDF$VREBL_# ENTRY(2) ALTRET;
       84       84                                                /* MISC */
       85       85             %INCLUDE XU_MACRO_C;
       86     3191             %PARSE$OUT(NAME=O,SCRITCH=SCRATCH,STCLASS=BASED);
       87     3236             %INCLUDE XUH_MACRO_C;
       88     3320             %INCLUDE DD_SD_M;
       89     4656             %S_D;
       90     5974             %INCLUDE DD_ERR_C;
       91     6371             %INCLUDE DD_PSUBS_C;
       92     6846             %INCLUDE B$OBJECT_C;
       93    10276             %B$VREBL(STCLASS="BASED(ENTRY$)");
       94    10440             %VREBLSUBS;
       95    10448             %B$SDEF;
       96    10502             %INCLUDE DD$DITEM;
       12+   10605             %LIST;
       13+   10606    1        DCL SDD$ PTR;
       14+   10607    1        DCL ZITEM$ PTR;
       15+   10608    1        DCL SDD_L6$ PTR;
       16+   10609    1        DCL ZITEM_L6$ PTR;
       97    11183             %ZITEM;
       98    11255             %DITEM;
       99    11335             %INCLUDE DD$BASED;
      100    12638             %DD$VENTRY;
      101    12643             %INCLUDE DD_DESC_R;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:22   
      102    12693    1   DCL 1 DUMPTR_ITEM CONSTANT,
      103    12694    1         2 * UBIN(18) UNAL INIT(0),
      104    12695    1         2 * UBIN(9) UNAL INIT(0),
      105    12696    1         2 * UBIN(9) UNAL INIT(%PTR_ICODE), /* PTR_ICODE */
      106    12697    1         2 * UBIN(36) UNAL INIT(0);
      107    12698                                                /**/
      108    12699    1        SDD$ = S_D.D$;

  12699  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   000044 236100                    LDQ     36,,PR0
         1 000004   200043 756100                    STQ     SDD$,,AUTO

      109    12700    1        ZITEM$ = S_D.DESC$;

  12700  1 000005   000041 236100                    LDQ     33,,PR0
         1 000006   200044 756100                    STQ     ZITEM$,,AUTO

      110    12701    1        IF ROOT$ -> O.CODE = 40   /* VAREXP_CODE */

  12701  1 000007   200003 471500                    LDP1    @ROOT$,,AUTO
         1 000010   100000 473500                    LDP3    0,,PR1
         1 000011   300000 720100                    LXL0    0,,PR3
         1 000012   000050 100003                    CMPX0   40,DU
         1 000013   000303 601000 1                  TNZ     s:12783

      111    12702    2        THEN DO;                           /* BUILD VARIABLE REFERENCE */

      112    12703    2             ARRAY_FLAG = '0'B;

  12703  1 000014   200005 450100                    STZ     ARRAY_FLAG,,AUTO

      113    12704    2             DIM_CNT = 0;

  12704  1 000015   200007 450100                    STZ     DIM_CNT,,AUTO

      114    12705    2             IPTR$ = SDD$;                 /* Remember for implied PTR */

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:23   
  12705  1 000016   200043 236100                    LDQ     SDD$,,AUTO
         1 000017   200036 756100                    STQ     IPTR$,,AUTO

      115    12706    2             ADDREXP_FLAG = '0'B;

  12706  1 000020   200006 450100                    STZ     ADDREXP_FLAG,,AUTO

      116    12707    2             IF ROOT$ -> O.NSUBLKS > 1

  12707  1 000021   100000 473500                    LDP3    0,,PR1
         1 000022   300001 220100                    LDX0    1,,PR3
         1 000023   000002 100003                    CMPX0   2,DU
         1 000024   000116 602000 1                  TNC     s:12738

      117    12708    3             THEN DO;                      /* PROCESS SUBREF / ADDREXP */

      118    12709    3                  TEMP$ = ROOT$ -> O.SUBLK$(1);

  12709  1 000025   300004 236100                    LDQ     4,,PR3
         1 000026   200022 756100                    STQ     TEMP$,,AUTO

      119    12710    3                  IF TEMP$ -> O.CODE = 44 /* SUBREF_CODE */

  12710  1 000027   200022 473500                    LDP3    TEMP$,,AUTO
         1 000030   300000 720100                    LXL0    0,,PR3
         1 000031   000054 100003                    CMPX0   44,DU
         1 000032   000061 601000 1                  TNZ     s:12722

      120    12711    4                  THEN DO;                 /* BUILD SUBSCRIPT REFERENCE */

      121    12712    4                       ARRAY_FLAG = '1'B;

  12712  1 000033   400000 236003                    LDQ     -131072,DU
         1 000034   200005 756100                    STQ     ARRAY_FLAG,,AUTO

      122    12713    4                       CALL DDD$SUBREF(TEMP$, RANGE_FLAG, DIM_CNT, MULT)

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:24   
  12713  1 000035   200012 634500                    EPPR4   MULT,,AUTO
         1 000036   200141 454500                    STP4    CNT+5,,AUTO
         1 000037   200007 635500                    EPPR5   DIM_CNT,,AUTO
         1 000040   200140 455500                    STP5    CNT+4,,AUTO
         1 000041   200027 636500                    EPPR6   RANGE_FLAG,,AUTO
         1 000042   200137 456500                    STP6    CNT+3,,AUTO
         1 000043   200022 637500                    EPPR7   TEMP$,,AUTO
         1 000044   200136 457500                    STP7    CNT+2,,AUTO
         1 000045   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000046   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000047   000000 701000 xent               TSX1    DDD$SUBREF
         1 000050   001573 702000 1                  TSX2    PERR

      123    12714    4                         ALTRET(PERR);
      124    12715    4                       SDD$ = S_D.D$;

  12715  1 000051   000000 470400 xsym               LDP0    S_D$
         1 000052   000044 236100                    LDQ     36,,PR0
         1 000053   200043 756100                    STQ     SDD$,,AUTO

      125    12716    4                       IF RANGE_FLAG

  12716  1 000054   200027 234100                    SZN     RANGE_FLAG,,AUTO
         1 000055   000061 605000 1                  TPL     s:12722

      126    12717    5                       THEN DO;

      127    12718    5                            S_D.ERROR = 1; /* E@RANGE_SPEC */

  12718  1 000056   000001 235007                    LDA     1,DL
         1 000057   000013 755100                    STA     11,,PR0

      128    12719    5                            GOTO PERR;

  12719  1 000060   001573 710000 1                  TRA     PERR

      129    12720    5                          END;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:25   
      130    12721    4                     END;                  /* BUILD SUBSCRIPT REFERENCE */
      131    12722    3                  EXPR_IDX = 1 + BITBIN(ARRAY_FLAG);

  12722  1 000061   200005 236100                    LDQ     ARRAY_FLAG,,AUTO
         1 000062   000043 772000                    QRL     35
         1 000063   000001 036007                    ADLQ    1,DL
         1 000064   200032 756100                    STQ     EXPR_IDX,,AUTO

      132    12723    3                  IF ROOT$ -> O.NSUBLKS > EXPR_IDX

  12723  1 000065   200003 471500                    LDP1    @ROOT$,,AUTO
         1 000066   100000 473500                    LDP3    0,,PR1
         1 000067   300001 236100                    LDQ     1,,PR3
         1 000070   000022 772000                    QRL     18
         1 000071   200032 116100                    CMPQ    EXPR_IDX,,AUTO
         1 000072   000116 604400 1                  TMOZ    s:12738

      133    12724    4                  THEN DO;                 /* BUILD ADDRESS EXPRESSION MODIFIER */

      134    12725    4                       IF BASED_FLAG

  12725  1 000073   200004 474500                    LDP4    @BASED_FLAG,,AUTO
         1 000074   400000 234100                    SZN     0,,PR4
         1 000075   000101 605000 1                  TPL     s:12730

      135    12726    5                       THEN DO;

      136    12727    5                            S_D.ERROR = 2; /* E@ADDREXP */

  12727  1 000076   000002 235007                    LDA     2,DL
         1 000077   000013 755100                    STA     11,,PR0

      137    12728    5                            GOTO PERR;

  12728  1 000100   001573 710000 1                  TRA     PERR

      138    12729    5                          END;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:26   
      139    12730    4                       CALL DDD$ADDREXP(ROOT$, EXPR_IDX) ALTRET(PERR);

  12730  1 000101   200032 635500                    EPPR5   EXPR_IDX,,AUTO
         1 000102   200137 455500                    STP5    CNT+3,,AUTO
         1 000103   200003 236100                    LDQ     @ROOT$,,AUTO
         1 000104   200136 756100                    STQ     CNT+2,,AUTO
         1 000105   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000107   000000 701000 xent               TSX1    DDD$ADDREXP
         1 000110   001573 702000 1                  TSX2    PERR

      140    12731    4                       SDD$ = S_D.D$;

  12731  1 000111   000000 470400 xsym               LDP0    S_D$
         1 000112   000044 236100                    LDQ     36,,PR0
         1 000113   200043 756100                    STQ     SDD$,,AUTO

      141    12732    4                       ADDREXP_FLAG = '1'B;

  12732  1 000114   400000 236003                    LDQ     -131072,DU
         1 000115   200006 756100                    STQ     ADDREXP_FLAG,,AUTO

      142    12733    4                     END;                  /* BUILD ADDRESS EXPRESSION MODIFIER */

      143    12734    3                END;                       /* PROCESS SUBREF / ADDREXP */

      144    12735                                                /**/
      145    12736                                                /* TIME TO BUILD THE ACTUAL POINTER ITEM
      146    12737                                                */
      147    12738    2             TEMP$ = ROOT$ -> O.SUBLK$(0);

  12738  1 000116   200003 471500                    LDP1    @ROOT$,,AUTO
         1 000117   100000 473500                    LDP3    0,,PR1
         1 000120   300003 236100                    LDQ     3,,PR3
         1 000121   200022 756100                    STQ     TEMP$,,AUTO

      148    12739    2             IF TEMP$ -> O.NSUBLKS = 1
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:27   

  12739  1 000122   200022 473500                    LDP3    TEMP$,,AUTO
         1 000123   300001 220100                    LDX0    1,,PR3
         1 000124   000001 100003                    CMPX0   1,DU
         1 000125   000131 601000 1                  TNZ     s:12741

      149    12740    2             THEN NQFLAG = '1'B;

  12740  1 000126   400000 236003                    LDQ     -131072,DU
         1 000127   200030 756100                    STQ     NQFLAG,,AUTO
         1 000130   000132 710000 1                  TRA     s:12742

      150    12741    2             ELSE NQFLAG = '0'B;

  12741  1 000131   200030 450100                    STZ     NQFLAG,,AUTO

      151    12742    2             SYM2$ = TEMP$ -> O.SUBLK$(0); /* 1ST SYM OR QTSTRING OF LIST */

  12742  1 000132   300003 236100                    LDQ     3,,PR3
         1 000133   200024 756100                    STQ     SYM2$,,AUTO

      152    12743    2             SYM$ = SYM2$ -> O.SUBLK$(0);  /* ACTUAL TEXTC */

  12743  1 000134   200024 474500                    LDP4    SYM2$,,AUTO
         1 000135   400003 236100                    LDQ     3,,PR4
         1 000136   200023 756100                    STQ     SYM$,,AUTO

      153    12744    2             IF SYM2$ -> O.CODE ~= 15 /* QTSTRING_CODE */

  12744  1 000137   400000 720100                    LXL0    0,,PR4
         1 000140   000017 100003                    CMPX0   15,DU
         1 000141   000165 600000 1                  TZE     s:12755

      154    12745    3             THEN DO;

      155    12746    3                  IF NQFLAG

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:28   
  12746  1 000142   200030 234100                    SZN     NQFLAG,,AUTO
         1 000143   000177 605000 1                  TPL     SEARCH_VAR

      156    12747    4                  THEN DO;

      157    12748    4                       CALL DDS$D_SRCH(SYM$,DESC_VAL)

  12748  1 000144   200041 635500                    EPPR5   TEMP1,,AUTO
         1 000145   200137 455500                    STP5    CNT+3,,AUTO
         1 000146   200023 636500                    EPPR6   SYM$,,AUTO
         1 000147   200136 456500                    STP6    CNT+2,,AUTO
         1 000150   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000151   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000152   000000 701000 xent               TSX1    DDS$D_SRCH
         1 000153   000344 702000 1                  TSX2    GOT_DESC

      158    12749    4                         ALTRET(GOT_DESC);
      159    12750    4                       CALL DDS$SP_SRCH(SYM$,SITEM_VAL)

  12750  1 000154   200041 630500                    EPPR0   TEMP1,,AUTO
         1 000155   200137 450500                    STP0    CNT+3,,AUTO
         1 000156   200023 631500                    EPPR1   SYM$,,AUTO
         1 000157   200136 451500                    STP1    CNT+2,,AUTO
         1 000160   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000162   000000 701000 xent               TSX1    DDS$SP_SRCH
         1 000163   000411 702000 1                  TSX2    GOT_SPEC

      160    12751    4                         ALTRET(GOT_SPEC);
      161    12752    4                     END;

  12752  1 000164   000165 710000 1                  TRA     s:12755

      162    12753    3                  ELSE GOTO SEARCH_VAR;
      163    12754    3                END;
      164    12755    2             IF NQFLAG

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:29   
  12755  1 000165   200030 234100                    SZN     NQFLAG,,AUTO
         1 000166   000177 605000 1                  TPL     SEARCH_VAR

      165    12756    2             THEN CALL DDS$UD_SRCH(SYM$,TEMP1) ALTRET(GOT_UDEF);

  12756  1 000167   200041 630500                    EPPR0   TEMP1,,AUTO
         1 000170   200137 450500                    STP0    CNT+3,,AUTO
         1 000171   200023 631500                    EPPR1   SYM$,,AUTO
         1 000172   200136 451500                    STP1    CNT+2,,AUTO
         1 000173   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000174   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000175   000000 701000 xent               TSX1    DDS$UD_SRCH
         1 000176   000474 702000 1                  TSX2    GOT_UDEF

      166    12757    2   SEARCH_VAR:
      167    12758    2             XQUAL = '0'B;

  12758  1 000177   200031 450100       SEARCH_VAR   STZ     XQUAL,,AUTO

      168    12759    2             CALL DDS$V_SRCH(TEMP$,ENTRY$,ENTRY#) ALTRET(GOT_VAR);

  12759  1 000200   200047 630500                    EPPR0   ENTRY#,,AUTO
         1 000201   200140 450500                    STP0    CNT+4,,AUTO
         1 000202   200025 631500                    EPPR1   ENTRY$,,AUTO
         1 000203   200137 451500                    STP1    CNT+3,,AUTO
         1 000204   200022 633500                    EPPR3   TEMP$,,AUTO
         1 000205   200136 453500                    STP3    CNT+2,,AUTO
         1 000206   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000207   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000210   000000 701000 xent               TSX1    DDS$V_SRCH
         1 000211   000617 702000 1                  TSX2    GOT_VAR

      169    12760    2             HIGH_ENTRY# = ENTRY#.C;

  12760  1 000212   200047 235100                    LDA     ENTRY#,,AUTO
         1 000213   200026 755100                    STA     HIGH_ENTRY#,,AUTO

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:30   
      170    12761    2             IF S_D.XSCH.OK

  12761  1 000214   000000 470400 xsym               LDP0    S_D$
         1 000215   000751 234100                    SZN     489,,PR0
         1 000216   000251 605000 1                  TPL     s:12771

      171    12762    3             THEN DO;

      172    12763    3                  CALL DDS$SET_Q2T;

  12763  1 000217   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000220   000000 701000 xent               TSX1    DDS$SET_Q2T
         1 000221   000000 011000                    NOP     0

      173    12764    3                  CALL DDS$SET_X2Q ALTRET( BADSCHEMA );

  12764  1 000222   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000223   000000 701000 xent               TSX1    DDS$SET_X2Q
         1 000224   000277 702000 1                  TSX2    BADSCHEMA

      174    12765    3                  XQUAL = '1'B;

  12765  1 000225   400000 236003                    LDQ     -131072,DU
         1 000226   200031 756100                    STQ     XQUAL,,AUTO

      175    12766    3                  CALL DDS$V_SRCH(TEMP$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);

  12766  1 000227   200047 630500                    EPPR0   ENTRY#,,AUTO
         1 000230   200140 450500                    STP0    CNT+4,,AUTO
         1 000231   200025 631500                    EPPR1   ENTRY$,,AUTO
         1 000232   200137 451500                    STP1    CNT+3,,AUTO
         1 000233   200022 633500                    EPPR3   TEMP$,,AUTO
         1 000234   200136 453500                    STP3    CNT+2,,AUTO
         1 000235   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000236   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000237   000000 701000 xent               TSX1    DDS$V_SRCH
         1 000240   000617 702000 1                  TSX2    GOT_VAR
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:31   

      176    12767    3                  IF ENTRY#.C > HIGH_ENTRY#

  12767  1 000241   200026 236100                    LDQ     HIGH_ENTRY#,,AUTO
         1 000242   200047 116100                    CMPQ    ENTRY#,,AUTO
         1 000243   000246 603000 1                  TRC     s:12769

      177    12768    3                  THEN HIGH_ENTRY# = ENTRY#.C;

  12768  1 000244   200047 235100                    LDA     ENTRY#,,AUTO
         1 000245   200026 755100                    STA     HIGH_ENTRY#,,AUTO

      178    12769    3                  CALL DDS$SET_T2Q ALTRET( BADSCHEMA );

  12769  1 000246   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000247   000000 701000 xent               TSX1    DDS$SET_T2Q
         1 000250   000277 702000 1                  TSX2    BADSCHEMA

      179    12770    3                END;

      180    12771    2             IF NQFLAG

  12771  1 000251   200030 234100                    SZN     NQFLAG,,AUTO
         1 000252   000264 605000 1                  TPL     s:12773

      181    12772    2             THEN CALL DDS$SD_SRCH(SYM$,ENTRY$) ALTRET(GOT_SDEF);

  12772  1 000253   200025 630500                    EPPR0   ENTRY$,,AUTO
         1 000254   200137 450500                    STP0    CNT+3,,AUTO
         1 000255   200023 631500                    EPPR1   SYM$,,AUTO
         1 000256   200136 451500                    STP1    CNT+2,,AUTO
         1 000257   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000260   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000261   000000 701000 xent               TSX1    DDS$SD_SRCH
         1 000262   000521 702000 1                  TSX2    GOT_SDEF
         1 000263   000271 710000 1                  TRA     s:12775

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:32   
      182    12773    2             ELSE SYM$ = TEMP$ -> O.SUBLK$(HIGH_ENTRY#) -> O.SUBLK$(0);

  12773  1 000264   200022 470500                    LDP0    TEMP$,,AUTO
         1 000265   200026 720100                    LXL0    HIGH_ENTRY#,,AUTO
         1 000266   000003 471510                    LDP1    3,X0,PR0
         1 000267   100003 236100                    LDQ     3,,PR1
         1 000270   200023 756100                    STQ     SYM$,,AUTO

      183    12774                                                /* NOT FOUND, MUST BE AN ERROR */
      184    12775    2             S_D.ERROR = 3;   /* E@SYM_NOTFOUND */

  12775  1 000271   000003 235007                    LDA     3,DL
         1 000272   000000 470400 xsym               LDP0    S_D$
         1 000273   000013 755100                    STA     11,,PR0

      185    12776    2             S_D.ERROR_SYM$ = SYM$;

  12776  1 000274   200023 236100                    LDQ     SYM$,,AUTO
         1 000275   000032 756100                    STQ     26,,PR0

      186    12777    2             ALTRETURN;

  12777  1 000276   000000 702200 xent               TSX2  ! X66_AALT

      187    12778    2   BADSCHEMA:
      188    12779    2             S_D.ERROR = 22;         /* E@UERR11 */

  12779  1 000277   000026 235007       BADSCHEMA    LDA     22,DL
         1 000300   000000 470400 xsym               LDP0    S_D$
         1 000301   000013 755100                    STA     11,,PR0

      189    12780    2             ALTRETURN;

  12780  1 000302   000000 702200 xent               TSX2  ! X66_AALT

      190    12781    2           END;                            /* BUILD VARIABLE REFERENCE */
      191    12782    2        ELSE DO;                           /* BUILD SIMPLE EXPRESSION PTR ITEM */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:33   

      192    12783    2             DITEM = '0'B;

  12783  1 000303   200043 474500                    LDP4    SDD$,,AUTO
         1 000304   000100 100400                    MLR     fill='000'O
         1 000305   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000306   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      193    12784    2             DITEM.TYPE_CODE = %PTR_ICODE; /* PTR_ICODE */

  12784  1 000307   000001 236007                    LDQ     1,DL
         1 000310   400000 552104                    STBQ    0,'04'O,PR4

      194    12785    2             CALL DDD$SIMEXP(ROOT$, TEMP1, DITEM.FLAGS.OFLAG) ALTRET(PERR);

  12785  1 000311   200043 236100                    LDQ     SDD$,,AUTO
         1 000312   200000 036007                    ADLQ    65536,DL
         1 000313   200140 756100                    STQ     CNT+4,,AUTO
         1 000314   200041 633500                    EPPR3   TEMP1,,AUTO
         1 000315   200137 453500                    STP3    CNT+3,,AUTO
         1 000316   200003 236100                    LDQ     @ROOT$,,AUTO
         1 000317   200136 756100                    STQ     CNT+2,,AUTO
         1 000320   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000321   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000322   000000 701000 xent               TSX1    DDD$SIMEXP
         1 000323   001573 702000 1                  TSX2    PERR

      195    12786    2             DITEM.VALUE = TEMP1;

  12786  1 000324   200041 235100                    LDA     TEMP1,,AUTO
         1 000325   200043 470500                    LDP0    SDD$,,AUTO
         1 000326   000001 755100                    STA     1,,PR0

      196    12787    2             IF BASED_FLAG

  12787  1 000327   200004 471500                    LDP1    @BASED_FLAG,,AUTO
         1 000330   100000 234100                    SZN     0,,PR1
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:34   
         1 000331   000335 605000 1                  TPL     s:12789

      197    12788    2             THEN DITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */

  12788  1 000332   103000 236007                    LDQ     34304,DL
         1 000333   000000 552110                    STBQ    0,'10'O,PR0
         1 000334   000337 710000 1                  TRA     s:12790

      198    12789    2             ELSE DITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */

  12789  1 000335   104000 236007                    LDQ     34816,DL
         1 000336   000000 552110                    STBQ    0,'10'O,PR0

      199    12790    2             CALL BUMPD$ ALTRET(PERR);

  12790  1 000337   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000340   200133 756100                    STQ     ENTRY#+52,,AUTO
         1 000341   001574 701000 1                  TSX1    BUMPD$
         1 000342   001573 702000 1                  TSX2    PERR

      200    12791    2           END;

      201    12792    1        RETURN;

  12792  1 000343   000000 702200 xent               TSX2  ! X66_ARET

      202    12793                                                /*
      203    12794                                      COME HERE TO BUILD DESC/PTR SPECIAL SYMBOL ENTRY
      204    12795                                      */
      205    12796    1   GOT_DESC:
      206    12797    1        IF BASED_FLAG OR ARRAY_FLAG

  12797  1 000344   200004 470500       GOT_DESC     LDP0    @BASED_FLAG,,AUTO
         1 000345   000000 234100                    SZN     0,,PR0
         1 000346   000351 604000 1                  TMI     s:12799
         1 000347   200005 234100                    SZN     ARRAY_FLAG,,AUTO
         1 000350   000356 605000 1                  TPL     s:12802
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:35   

      207    12798    2        THEN DO;

      208    12799    2             S_D.ERROR = 4;     /* E@INVLD_SPEC */

  12799  1 000351   000004 235007                    LDA     4,DL
         1 000352   000000 471400 xsym               LDP1    S_D$
         1 000353   100013 755100                    STA     11,,PR1

      209    12800    2             S_D.ERROR_SYM$ = SYM$;

  12800  1 000354   200023 236100                    LDQ     SYM$,,AUTO
         1 000355   100032 756100                    STQ     26,,PR1

      210    12801    2           END;

      211    12802    1        IF ADDREXP_FLAG

  12802  1 000356   200006 234100                    SZN     ADDREXP_FLAG,,AUTO
         1 000357   000364 605000 1                  TPL     s:12807

      212    12803    2        THEN DO;

      213    12804    2             S_D.ERROR = 87;    /* E@EXPNOTVALID */

  12804  1 000360   000127 235007                    LDA     87,DL
         1 000361   000000 471400 xsym               LDP1    S_D$
         1 000362   100013 755100                    STA     11,,PR1

      214    12805    2             ALTRETURN;

  12805  1 000363   000000 702200 xent               TSX2  ! X66_AALT

      215    12806    2           END;
      216    12807    1        ZITEM.FLAGS.MDSE.S = ZITEM.FLAGS.MDSE.S

  12807  1 000364   200043 471500                    LDP1    SDD$,,AUTO
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:36   
         1 000365   100001 236100                    LDQ     1,,PR1
         1 000366   000032 736000                    QLS     26
         1 000367   400000 376003                    ANQ     -131072,DU
         1 000370   200136 756100                    STQ     CNT+2,,AUTO
         1 000371   200044 473500                    LDP3    ZITEM$,,AUTO
         1 000372   300001 236100                    LDQ     1,,PR3
         1 000373   000002 736000                    QLS     2
         1 000374   400000 376003                    ANQ     -131072,DU
         1 000375   200136 276100                    ORQ     CNT+2,,AUTO
         1 000376   000002 772000                    QRL     2
         1 000377   300001 676100                    ERQ     1,,PR3
         1 000400   100000 376003                    ANQ     32768,DU
         1 000401   300001 656100                    ERSQ    1,,PR3

      217    12808    1          | DITEM.SP.MDSE.S;
      218    12809    1        DITEM.VALUEB = DESC_VAL;

  12809  1 000402   200041 236100                    LDQ     TEMP1,,AUTO
         1 000403   100001 756100                    STQ     1,,PR1

      219    12810    1        DITEM.ADDR_TYPE = %DESC_ACODE;     /* DESC_ACODE */

  12810  1 000404   100000 236007                    LDQ     32768,DL
         1 000405   100000 552110                    STBQ    0,'10'O,PR1

      220    12811    1        DITEM.TYPE_CODE = %PTR_ICODE;      /* PTR_ICODE */

  12811  1 000406   000001 236007                    LDQ     1,DL
         1 000407   100000 552104                    STBQ    0,'04'O,PR1

      221    12812    1        GOTO DONE;

  12812  1 000410   001566 710000 1                  TRA     DONE

      222    12813                                                /*
      223    12814                                                 COME HERE TO BUILD SPECIAL SYMBOL ENTRY
      224    12815                                                 */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:37   
      225    12816    1   GOT_SPEC:
      226    12817                                 /* THE ONLY ALLOWABLE SPECIAL SYMBOL FOR PTRS IS $L */
      227    12818    1        IF (ADDR(SITEM_VAL) -> DITEM.SP.VS.ID ~= %L_RTN /* L_RTN */

  12818  1 000411   200042 236100       GOT_SPEC     LDQ     TEMP1+1,,AUTO
         1 000412   777000 376003                    ANQ     -512,DU
         1 000413   002000 116003                    CMPQ    1024,DU
         1 000414   000420 600000 1                  TZE     GOT_SPEC+7
         1 000415   200042 236100                    LDQ     TEMP1+1,,AUTO
         1 000416   777000 316003                    CANQ    -512,DU
         1 000417   000425 601000 1                  TNZ     s:12822
         1 000420   200004 470500                    LDP0    @BASED_FLAG,,AUTO
         1 000421   000000 234100                    SZN     0,,PR0
         1 000422   000425 604000 1                  TMI     s:12822
         1 000423   200005 234100                    SZN     ARRAY_FLAG,,AUTO
         1 000424   000433 605000 1                  TPL     s:12826

      228    12819    1          AND ADDR(SITEM_VAL)->DITEM.SP.VS.ID ~= %O_RTN /* O_RTN */ )
      229    12820    1          OR BASED_FLAG OR ARRAY_FLAG
      230    12821    2        THEN DO;

      231    12822    2             S_D.ERROR = 4;     /* E@INVLD_SPEC */

  12822  1 000425   000004 235007                    LDA     4,DL
         1 000426   000000 470400 xsym               LDP0    S_D$
         1 000427   000013 755100                    STA     11,,PR0

      232    12823    2             S_D.ERROR_SYM$ = SYM$;

  12823  1 000430   200023 236100                    LDQ     SYM$,,AUTO
         1 000431   000032 756100                    STQ     26,,PR0

      233    12824    2             ALTRETURN;

  12824  1 000432   000000 702200 xent               TSX2  ! X66_AALT

      234    12825    2           END;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:38   
      235    12826    1        IF ADDREXP_FLAG AND NOT
             12826                 /* Address expression and not $O, $I, $L, @, @@, #, ##, $NA */

  12826  1 000433   200006 234100                    SZN     ADDREXP_FLAG,,AUTO
         1 000434   000464 605000 1                  TPL     s:12839
         1 000435   200041 236100                    LDQ     TEMP1,,AUTO
         1 000436   777000 316003                    CANQ    -512,DU
         1 000437   000464 600000 1                  TZE     s:12839
         1 000440   200041 236100                    LDQ     TEMP1,,AUTO
         1 000441   777000 376003                    ANQ     -512,DU
         1 000442   001000 116003                    CMPQ    512,DU
         1 000443   000464 600000 1                  TZE     s:12839
         1 000444   002000 116003                    CMPQ    1024,DU
         1 000445   000464 600000 1                  TZE     s:12839
         1 000446   040000 116003                    CMPQ    16384,DU
         1 000447   000464 600000 1                  TZE     s:12839
         1 000450   041000 116003                    CMPQ    16896,DU
         1 000451   000464 600000 1                  TZE     s:12839
         1 000452   042000 116003                    CMPQ    17408,DU
         1 000453   000464 600000 1                  TZE     s:12839
         1 000454   043000 116003                    CMPQ    17920,DU
         1 000455   000464 600000 1                  TZE     s:12839
         1 000456   037000 116003                    CMPQ    15872,DU
         1 000457   000464 600000 1                  TZE     s:12839

      236    12827    1          (SITEM_VAL.ID = %O_RTN OR        /* O_RTN */
      237    12828    1          SITEM_VAL.ID = %I_RTN OR         /* I_RTN */
      238    12829    1          SITEM_VAL.ID = %L_RTN OR         /* L_RTN */
      239    12830    1          SITEM_VAL.ID = %@_RTN OR         /* @_RTN */
      240    12831    1          SITEM_VAL.ID = %@@_RTN OR        /* @@_RTN */
      241    12832    1          SITEM_VAL.ID = %#_RTN OR         /* #_RTN */
      242    12833    1          SITEM_VAL.ID = %##_RTN OR        /* ##_RTN */
      243    12834    1          SITEM_VAL.ID = %NA_RTN)          /* NA_RTN */
      244    12835    2        THEN DO;

      245    12836    2             S_D.ERROR = 87;    /* E@EXPNOTVALID */

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:39   
  12836  1 000460   000127 235007                    LDA     87,DL
         1 000461   000000 471400 xsym               LDP1    S_D$
         1 000462   100013 755100                    STA     11,,PR1

      246    12837    2             ALTRETURN;

  12837  1 000463   000000 702200 xent               TSX2  ! X66_AALT

      247    12838    2           END;
      248    12839    1        DITEM.VALUEB = SITEM_VAL;

  12839  1 000464   200041 236100                    LDQ     TEMP1,,AUTO
         1 000465   200043 471500                    LDP1    SDD$,,AUTO
         1 000466   100001 756100                    STQ     1,,PR1

      249    12840    1        DITEM.ADDR_TYPE = %SPEC_ACODE;     /* SPEC_ACODE */

  12840  1 000467   101000 236007                    LDQ     33280,DL
         1 000470   100000 552110                    STBQ    0,'10'O,PR1

      250    12841    1        DITEM.TYPE_CODE = %PTR_ICODE;      /* PTR_ICODE */

  12841  1 000471   000001 236007                    LDQ     1,DL
         1 000472   100000 552104                    STBQ    0,'04'O,PR1

      251    12842    1        GOTO DONE;

  12842  1 000473   001566 710000 1                  TRA     DONE

      252    12843                                                /*
      253    12844                                           COME HERE TO BUILD USER DEFINED SYMBOL ENTRY
      254    12845                                           */
      255    12846    1   GOT_UDEF:
      256    12847    1        IF ARRAY_FLAG

  12847  1 000474   200005 234100       GOT_UDEF     SZN     ARRAY_FLAG,,AUTO
         1 000475   000504 605000 1                  TPL     s:12853
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:40   

      257    12848    2        THEN DO;

      258    12849    2             S_D.ERROR = 6;      /* E@SUBSCRIPT */

  12849  1 000476   000006 235007                    LDA     6,DL
         1 000477   000000 470400 xsym               LDP0    S_D$
         1 000500   000013 755100                    STA     11,,PR0

      259    12850    2             S_D.ERROR_SYM$ = SYM$;

  12850  1 000501   200023 236100                    LDQ     SYM$,,AUTO
         1 000502   000032 756100                    STQ     26,,PR0

      260    12851    2             ALTRETURN;

  12851  1 000503   000000 702200 xent               TSX2  ! X66_AALT

      261    12852    2           END;
      262    12853    1        DITEM = DUMPTR_ITEM;

  12853  1 000504   200043 470500                    LDP0    SDD$,,AUTO
         1 000505   000100 100400                    MLR     fill='000'O
         1 000506   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 000507   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      263    12854    1        IF BASED_FLAG

  12854  1 000510   200004 471500                    LDP1    @BASED_FLAG,,AUTO
         1 000511   100000 234100                    SZN     0,,PR1
         1 000512   000516 605000 1                  TPL     s:12856

      264    12855    1        THEN DITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */

  12855  1 000513   103000 236007                    LDQ     34304,DL
         1 000514   000000 552110                    STBQ    0,'10'O,PR0
         1 000515   000520 710000 1                  TRA     s:12857
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:41   

      265    12856    1        ELSE DITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */

  12856  1 000516   104000 236007                    LDQ     34816,DL
         1 000517   000000 552110                    STBQ    0,'10'O,PR0

      266    12857    1        GOTO DONE;

  12857  1 000520   001566 710000 1                  TRA     DONE

      267    12858                                                /*
      268    12859                                                 COME HERE TO BUILD SYMDEF TYPE ENTRY
      269    12860                                                 */
      270    12861    1   GOT_SDEF:
      271    12862    1        IF ARRAY_FLAG

  12862  1 000521   200005 234100       GOT_SDEF     SZN     ARRAY_FLAG,,AUTO
         1 000522   000531 605000 1                  TPL     s:12868

      272    12863    2        THEN DO;

      273    12864    2             S_D.ERROR = 5;           /* E@SDEF */

  12864  1 000523   000005 235007                    LDA     5,DL
         1 000524   000000 470400 xsym               LDP0    S_D$
         1 000525   000013 755100                    STA     11,,PR0

      274    12865    2             S_D.ERROR_SYM$ = SYM$;

  12865  1 000526   200023 236100                    LDQ     SYM$,,AUTO
         1 000527   000032 756100                    STQ     26,,PR0

      275    12866    2             ALTRETURN;

  12866  1 000530   000000 702200 xent               TSX2  ! X66_AALT

      276    12867    2           END;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:42   
      277    12868    1        DITEM = DUMPTR_ITEM;

  12868  1 000531   200043 470500                    LDP0    SDD$,,AUTO
         1 000532   000100 100400                    MLR     fill='000'O
         1 000533   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 000534   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      278    12869    1        TEMP1 = ENTRY$ -> B$SDEF.AD.OU.OFFSET;

  12869  1 000535   200025 471500                    LDP1    ENTRY$,,AUTO
         1 000536   100000 236100                    LDQ     0,,PR1
         1 000537   777777 376007                    ANQ     -1,DL
         1 000540   200041 756100                    STQ     TEMP1,,AUTO

      279    12870    1        DITEM.ADDRESS.W = TEMP1;

  12870  1 000541   000014 736000                    QLS     12
         1 000542   000001 752174                    STCQ    1,'74'O,PR0

      280    12871    1        IF ENTRY$ -> B$SDEF.CONSTNT

  12871  1 000543   200025 471500                    LDP1    ENTRY$,,AUTO
         1 000544   100001 236100                    LDQ     1,,PR1
         1 000545   400000 316007                    CANQ    -131072,DL
         1 000546   000603 600000 1                  TZE     s:12885

      281    12872    1        THEN IF ~ BASED_FLAG

  12872  1 000547   200004 473500                    LDP3    @BASED_FLAG,,AUTO
         1 000550   300000 236100                    LDQ     0,,PR3
         1 000551   400000 376003                    ANQ     -131072,DU
         1 000552   400000 676003                    ERQ     -131072,DU
         1 000553   000600 600000 1                  TZE     s:12884

      282    12873    1             THEN IF ENTRY$ -> B$SDEF.LFLAGS.IS_DCB

  12873  1 000554   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:43   
         1 000555   002000 316007                    CANQ    1024,DL
         1 000556   000572 600000 1                  TZE     s:12880

      283    12874    2                  THEN DO;                 /* Stick in $DCBn PTR */

      284    12875    2                       DITEM.VALUEB = DESC.ITEM( %DCB_DESC ); /* DCB_DESC */

  12875  1 000557   000071 236000 xsym               LDQ     DESC+57
         1 000560   000001 756100                    STQ     1,,PR0

      285    12876    2                       DITEM.SP.VD.DISP = ENTRY$ -> B$SDEF.VALUE;

  12876  1 000561   200025 471500                    LDP1    ENTRY$,,AUTO
         1 000562   100000 236100                    LDQ     0,,PR1
         1 000563   000014 736000                    QLS     12
         1 000564   000001 676100                    ERQ     1,,PR0
         1 000565   000000 376000 2                  ANQ     0
         1 000566   000001 656100                    ERSQ    1,,PR0

      286    12877    2                       DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  12877  1 000567   100000 236007                    LDQ     32768,DL
         1 000570   000000 552110                    STBQ    0,'10'O,PR0

      287    12878    2                     END;

  12878  1 000571   000616 710000 1                  TRA     s:12892

      288    12879    2                  ELSE DO;

      289    12880    2                       S_D.ERROR = 5;
             12880                                /* E@SDEF - ADD ERROR FOR INVALID USE OF CONSTANT SYMDEF */

  12880  1 000572   000005 235007                    LDA     5,DL
         1 000573   000000 474400 xsym               LDP4    S_D$
         1 000574   400013 755100                    STA     11,,PR4

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:44   
      290    12881    2                       S_D.ERROR_SYM$ = SYM$;

  12881  1 000575   200023 236100                    LDQ     SYM$,,AUTO
         1 000576   400032 756100                    STQ     26,,PR4

      291    12882    2                       ALTRETURN;

  12882  1 000577   000000 702200 xent               TSX2  ! X66_AALT

      292    12883    2                     END;
      293    12884    1             ELSE DITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */

  12884  1 000600   002000 236007                    LDQ     1024,DL
         1 000601   000000 552110                    STBQ    0,'10'O,PR0
         1 000602   000616 710000 1                  TRA     s:12892

      294    12885    1        ELSE IF BASED_FLAG

  12885  1 000603   200004 473500                    LDP3    @BASED_FLAG,,AUTO
         1 000604   300000 234100                    SZN     0,,PR3
         1 000605   000614 605000 1                  TPL     s:12891

      295    12886    2             THEN DO;

      296    12887    2                  S_D.ERROR = 5;      /* E@SDEF */

  12887  1 000606   000005 235007                    LDA     5,DL
         1 000607   000000 474400 xsym               LDP4    S_D$
         1 000610   400013 755100                    STA     11,,PR4

      297    12888    2                  S_D.ERROR_SYM$ = SYM$;

  12888  1 000611   200023 236100                    LDQ     SYM$,,AUTO
         1 000612   400032 756100                    STQ     26,,PR4

      298    12889    2                  ALTRETURN;

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:45   
  12889  1 000613   000000 702200 xent               TSX2  ! X66_AALT

      299    12890    2                END;
      300    12891    1             ELSE DITEM.ADDR_TYPE = %STATIC_ACODE; /* STATIC_ACODE */

  12891  1 000614   000000 236003                    LDQ     0,DU
         1 000615   000000 552110                    STBQ    0,'10'O,PR0

      301    12892    1        GOTO DONE;

  12892  1 000616   001566 710000 1                  TRA     DONE

      302    12893                                                /*
      303    12894                                                 COME HERE TO BUILD VARIABLE TYPE ENTRY
      304    12895                                                 */
      305    12896    1   GOT_VAR:
      306    12897                                                /*
      307    12898                                                 MAKE VARIOUS CONSISTENCY CHECKS
      308    12899                                                 */
      309    12900    1        DIMS = 0;

  12900  1 000617   200010 450100       GOT_VAR      STZ     DIMS,,AUTO

      310    12901    2        DO I = 1 TO ENTRY#.C;

  12901  1 000620   000001 235007                    LDA     1,DL
         1 000621   200033 755100                    STA     I,,AUTO
         1 000622   000700 710000 1                  TRA     s:12918+1

      311    12902    2             STRUCT = ENTRY#.C - I +1;

  12902  1 000623   200047 236100                    LDQ     ENTRY#,,AUTO
         1 000624   200033 136100                    SBLQ    I,,AUTO
         1 000625   000001 036007                    ADLQ    1,DL
         1 000626   200011 756100                    STQ     STRUCT,,AUTO

      312    12903    2             IF ENTRY#.C ~= 1
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:46   

  12903  1 000627   200047 235100                    LDA     ENTRY#,,AUTO
         1 000630   000001 115007                    CMPA    1,DL
         1 000631   000642 600000 1                  TZE     s:12905

      313    12904    2             THEN CALL DDF$VREBL_#(ENTRY#.E(STRUCT), ENTRY$) ALTRET(BADSCHEMA);

  12904  1 000632   200025 630500                    EPPR0   ENTRY$,,AUTO
         1 000633   200137 450500                    STP0    CNT+3,,AUTO
         1 000634   200050 631506                    EPPR1   ENTRY#+1,QL,AUTO
         1 000635   200136 451500                    STP1    CNT+2,,AUTO
         1 000636   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000637   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000640   000000 701000 xent               TSX1    DDF$VREBL_#
         1 000641   000277 702000 1                  TSX2    BADSCHEMA

      314    12905    2             ARRAYTYP = B$VREBL.ARRAYTYP;

  12905  1 000642   200025 470500                    LDP0    ENTRY$,,AUTO
         1 000643   000001 236100                    LDQ     1,,PR0
         1 000644   000004 772000                    QRL     4
         1 000645   000017 376007                    ANQ     15,DL
         1 000646   200021 756100                    STQ     ARRAYTYP,,AUTO

      315    12906    3             DO CASE( ARRAYTYP );

  12906  1 000647   000006 116007                    CMPQ    6,DL
         1 000650   000652 602006 1                  TNC     s:12906+3,QL
         1 000651   000671 710000 1                  TRA     s:12914
         1 000652   000677 710000 1                  TRA     s:12918
         1 000653   000660 710000 1                  TRA     s:12910
         1 000654   000660 710000 1                  TRA     s:12910
         1 000655   000664 710000 1                  TRA     s:12912
         1 000656   000664 710000 1                  TRA     s:12912
         1 000657   000664 710000 1                  TRA     s:12912

      316    12907    3               CASE( %SCALAR_ARRAY );
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:47   

      317    12908                                                /* Do nothing */
      318    12909    3               CASE( %VECTOR0_ARRAY, %VECTOR1_ARRAY );

      319    12910    3                  DIMS = DIMS + 1;

  12910  1 000660   200010 235100                    LDA     DIMS,,AUTO
         1 000661   000001 035007                    ADLA    1,DL
         1 000662   200010 755100                    STA     DIMS,,AUTO
         1 000663   000677 710000 1                  TRA     s:12918

      320    12911    3               CASE( %REAL_ARRAY, %VIRTUAL_ARRAY, %ADJUSTABLE_ARRAY );

      321    12912    3                  DIMS = DIMS + B$VREBL.DIMS ;

  12912  1 000664   000004 236100                    LDQ     4,,PR0
         1 000665   000022 772000                    QRL     18
         1 000666   200010 036100                    ADLQ    DIMS,,AUTO
         1 000667   200010 756100                    STQ     DIMS,,AUTO
         1 000670   000677 710000 1                  TRA     s:12918

      322    12913    3               CASE( ELSE );

      323    12914    3                  S_D.ERROR_SYM$ = SYM$;

  12914  1 000671   200023 236100                    LDQ     SYM$,,AUTO
         1 000672   000000 471400 xsym               LDP1    S_D$
         1 000673   100032 756100                    STQ     26,,PR1

      324    12915    3                  S_D.ERROR = 187; /* E@NOTIMPLARRAY */

  12915  1 000674   000273 235007                    LDA     187,DL
         1 000675   100013 755100                    STA     11,,PR1

      325    12916    3                  ALTRETURN;

  12916  1 000676   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:48   

      326    12917    3               END;                        /* DO CASE( ARRAYTYP ) */

      327    12918    2           END;                            /* DO I = 1 TO ENTRY#.C */

  12918  1 000677   200033 054100                    AOS     I,,AUTO
         1 000700   200047 236100                    LDQ     ENTRY#,,AUTO
         1 000701   000623 604000 1                  TMI     s:12902
         1 000702   200033 116100                    CMPQ    I,,AUTO
         1 000703   000623 605000 1                  TPL     s:12902

      328    12919    1        IF ENTRY#.C > 1

  12919  1 000704   000002 116007                    CMPQ    2,DL
         1 000705   000716 602000 1                  TNC     s:12921

      329    12920    1        THEN CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);

  12920  1 000706   200025 630500                    EPPR0   ENTRY$,,AUTO
         1 000707   200137 450500                    STP0    CNT+3,,AUTO
         1 000710   200050 631506                    EPPR1   ENTRY#+1,QL,AUTO
         1 000711   200136 451500                    STP1    CNT+2,,AUTO
         1 000712   200136 630500                    EPPR0   CNT+2,,AUTO
         1 000713   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000714   000000 701000 xent               TSX1    DDF$VREBL_#
         1 000715   000277 702000 1                  TSX2    BADSCHEMA

      330    12921    1        IF DIM_CNT ~= DIMS

  12921  1 000716   200007 236100                    LDQ     DIM_CNT,,AUTO
         1 000717   000722 604000 1                  TMI     s:12923
         1 000720   200010 116100                    CMPQ    DIMS,,AUTO
         1 000721   000732 600000 1                  TZE     s:12928

      331    12922    2        THEN DO;

      332    12923    2             S_D.ERROR_SYM$ = SYM$;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:49   

  12923  1 000722   200023 236100                    LDQ     SYM$,,AUTO
         1 000723   000000 470400 xsym               LDP0    S_D$
         1 000724   000032 756100                    STQ     26,,PR0

      333    12924    2             S_D.ERROR_HICHAR = DIMS;

  12924  1 000725   200010 235100                    LDA     DIMS,,AUTO
         1 000726   004753 755100                    STA     2539,,PR0

      334    12925    2             S_D.ERROR = 188;     /* E@WRONG#SUBS */

  12925  1 000727   000274 235007                    LDA     188,DL
         1 000730   000013 755100                    STA     11,,PR0

      335    12926    2             ALTRETURN;

  12926  1 000731   000000 702200 xent               TSX2  ! X66_AALT

      336    12927    2           END;
      337    12928    1        ATYP = B$VREBL.ADDRTYP - 1;

  12928  1 000732   200025 470500                    LDP0    ENTRY$,,AUTO
         1 000733   000000 236100                    LDQ     0,,PR0
         1 000734   000010 772000                    QRL     8
         1 000735   000017 376007                    ANQ     15,DL
         1 000736   000001 136007                    SBLQ    1,DL
         1 000737   200041 756100                    STQ     TEMP1,,AUTO

      338    12929    1        IF BASED_FLAG AND NOT (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             12929                 PARM_ACODE OR

  12929  1 000740   200004 471500                    LDP1    @BASED_FLAG,,AUTO
         1 000741   100000 234100                    SZN     0,,PR1
         1 000742   000763 605000 1                  TPL     s:12937
         1 000743   000002 116007                    CMPQ    2,DL
         1 000744   000763 600000 1                  TZE     s:12937
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:50   
         1 000745   000003 116007                    CMPQ    3,DL
         1 000746   000763 600000 1                  TZE     s:12937
         1 000747   000004 116007                    CMPQ    4,DL
         1 000750   000763 600000 1                  TZE     s:12937
         1 000751   000006 116007                    CMPQ    6,DL
         1 000752   000763 600000 1                  TZE     s:12937
         1 000753   000007 116007                    CMPQ    7,DL
         1 000754   000763 600000 1                  TZE     s:12937

      339    12930    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      340    12931         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      341    12932    2        THEN DO;

      342    12933    2             S_D.ERROR_SYM$ = SYM$;

  12933  1 000755   200023 236100                    LDQ     SYM$,,AUTO
         1 000756   000000 473400 xsym               LDP3    S_D$
         1 000757   300032 756100                    STQ     26,,PR3

      343    12934    2             S_D.ERROR = 9;        /* E@VAR_REF */

  12934  1 000760   000011 235007                    LDA     9,DL
         1 000761   300013 755100                    STA     11,,PR3

      344    12935    2             ALTRETURN;

  12935  1 000762   000000 702200 xent               TSX2  ! X66_AALT

      345    12936    2           END;
      346    12937    1        IF B$VREBL.DATATYP ~= 13           /* PTR */

  12937  1 000763   000000 236100                    LDQ     0,,PR0
         1 000764   000374 376007                    ANQ     252,DL
         1 000765   000064 116007                    CMPQ    52,DL
         1 000766   001006 600000 1                  TZE     s:12945
         1 000767   200041 235100                    LDA     TEMP1,,AUTO
         1 000770   000003 115007                    CMPA    3,DL
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:51   
         1 000771   000776 601000 1                  TNZ     s:12937+11
         1 000772   000001 236100                    LDQ     1,,PR0
         1 000773   770000 376007                    ANQ     -4096,DL
         1 000774   010000 116007                    CMPQ    4096,DL
         1 000775   001006 600000 1                  TZE     s:12945
         1 000776   200006 234100                    SZN     ADDREXP_FLAG,,AUTO
         1 000777   001006 604000 1                  TMI     s:12945

      347    12938    1          AND (ATYP ~= 3 OR B$VREBL.LEVEL ~= 1) /* DCB */
      348    12939    1          AND NOT ADDREXP_FLAG        /* Allow variable with address expression */
      349    12940    2        THEN DO;

      350    12941    2             S_D.ERROR_SYM$ = SYM$;

  12941  1 001000   200023 236100                    LDQ     SYM$,,AUTO
         1 001001   000000 473400 xsym               LDP3    S_D$
         1 001002   300032 756100                    STQ     26,,PR3

      351    12942    2             S_D.ERROR = 7;      /* E@INVLD_PTR */

  12942  1 001003   000007 235007                    LDA     7,DL
         1 001004   300013 755100                    STA     11,,PR3

      352    12943    2             ALTRETURN;

  12943  1 001005   000000 702200 xent               TSX2  ! X66_AALT

      353    12944    2           END;
      354    12945    1        IF NOT BASED_FLAG AND (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             12945                 PARM_ACODE OR

  12945  1 001006   100000 234100                    SZN     0,,PR1
         1 001007   001454 604000 1                  TMI     s:13051
         1 001010   200041 235100                    LDA     TEMP1,,AUTO
         1 001011   000002 115007                    CMPA    2,DL
         1 001012   001023 600000 1                  TZE     s:12949
         1 001013   000003 115007                    CMPA    3,DL
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:52   
         1 001014   001023 600000 1                  TZE     s:12949
         1 001015   000004 115007                    CMPA    4,DL
         1 001016   001023 600000 1                  TZE     s:12949
         1 001017   000006 115007                    CMPA    6,DL
         1 001020   001023 600000 1                  TZE     s:12949
         1 001021   000007 115007                    CMPA    7,DL
         1 001022   001454 601000 1                  TNZ     s:13051

      355    12946    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      356    12947         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      357    12948    2        THEN DO;

      358    12949    2             IENTRY# = B$VREBL.IMPTR;

  12949  1 001023   000002 236100                    LDQ     2,,PR0
         1 001024   000022 732000                    QRS     18
         1 001025   200034 756100                    STQ     IENTRY#,,AUTO

      359    12950    2             IF ATYP = %BASED_ACODE  /* BASED_ACODE */ AND IENTRY# < 0

  12950  1 001026   000002 115007                    CMPA    2,DL
         1 001027   001040 601000 1                  TNZ     s:12956
         1 001030   000000 116003                    CMPQ    0,DU
         1 001031   001040 605000 1                  TPL     s:12956

      360    12951    3             THEN DO;

      361    12952    3                  S_D.ERROR_SYM$ = SYM$;

  12952  1 001032   200023 236100                    LDQ     SYM$,,AUTO
         1 001033   000000 473400 xsym               LDP3    S_D$
         1 001034   300032 756100                    STQ     26,,PR3

      362    12953    3                  S_D.ERROR = 99;     /* E@NOPTR */

  12953  1 001035   000143 235007                    LDA     99,DL
         1 001036   300013 755100                    STA     11,,PR3
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:53   

      363    12954    3                  ALTRETURN;

  12954  1 001037   000000 702200 xent               TSX2  ! X66_AALT

      364    12955    3                END;
      365    12956    2             IF ATYP = %DCB_ACODE  /* DCB_ACODE */ AND B$VREBL.LEVEL = 1

  12956  1 001040   000003 115007                    CMPA    3,DL
         1 001041   001063 601000 1                  TNZ     s:12964
         1 001042   000001 236100                    LDQ     1,,PR0
         1 001043   770000 376007                    ANQ     -4096,DL
         1 001044   010000 116007                    CMPQ    4096,DL
         1 001045   001063 601000 1                  TNZ     s:12964

      366    12957    3             THEN DO;                      /* DCBNAME ->    */

      367    12958    3                  DITEM.VALUEB = DESC.ITEM( %DCB_DESC ); /* DCB_DESC */

  12958  1 001046   000071 236000 xsym               LDQ     DESC+57
         1 001047   200043 473500                    LDP3    SDD$,,AUTO
         1 001050   300001 756100                    STQ     1,,PR3

      368    12959    3                  DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  12959  1 001051   100000 236007                    LDQ     32768,DL
         1 001052   300000 552110                    STBQ    0,'10'O,PR3

      369    12960    3                  DITEM.SP.VD.DISP = IENTRY#;

  12960  1 001053   200034 236100                    LDQ     IENTRY#,,AUTO
         1 001054   000014 736000                    QLS     12
         1 001055   300001 676100                    ERQ     1,,PR3
         1 001056   000000 376000 2                  ANQ     0
         1 001057   300001 656100                    ERSQ    1,,PR3

      370    12961    3                  DITEM.TYPE_CODE = %PTR_ICODE; /* PTR_ICODE */
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:54   

  12961  1 001060   000001 236007                    LDQ     1,DL
         1 001061   300000 552104                    STBQ    0,'04'O,PR3

      371    12962    3                  GOTO DONE;

  12962  1 001062   001566 710000 1                  TRA     DONE

      372    12963    3                END;                       /* DCBNAME ->   */
      373    12964    2             T$ = SDD$;

  12964  1 001063   200043 236100                    LDQ     SDD$,,AUTO
         1 001064   200035 756100                    STQ     T$,,AUTO

      374    12965    2             CALL BUMPD$ ALTRET(PERR);

  12965  1 001065   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001066   200133 756100                    STQ     ENTRY#+52,,AUTO
         1 001067   001574 701000 1                  TSX1    BUMPD$
         1 001070   001573 702000 1                  TSX2    PERR

      375    12966    3             DO WHILE( T$ >= IPTR$ );

  12966  1 001071   200035 236100                    LDQ     T$,,AUTO
         1 001072   200036 116100                    CMPQ    IPTR$,,AUTO
         1 001073   001104 602000 1                  TNC     s:12970

      376    12967    3                  PINCRW(T$,SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;

  12967  1 001074   200035 470500                    LDP0    T$,,AUTO
         1 001075   000000 235100                    LDA     0,,PR0
         1 001076   000003 755100                    STA     3,,PR0

      377    12968    3                  T$ = PINCRW(T$, -1);

  12968  1 001077   200035 236100                    LDQ     T$,,AUTO
         1 001100   777777 036003                    ADLQ    -1,DU
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:55   
         1 001101   200035 756100                    STQ     T$,,AUTO

      378    12969    3                END;                       /* DO WHILE (T$ >= IPTR$ ) */

  12969  1 001102   200036 116100                    CMPQ    IPTR$,,AUTO
         1 001103   001074 603000 1                  TRC     s:12967

      379    12970    3             DO I = 0 TO DIM_CNT - 1;

  12970  1 001104   200033 450100                    STZ     I,,AUTO
         1 001105   001113 710000 1                  TRA     s:12972+1

      380    12971    3                  MULT( I ) = PINCRW(MULT( I ), SIZEW(DITEM));

  12971  1 001106   200033 720100                    LXL0    I,,AUTO
         1 001107   200012 236110                    LDQ     MULT,X0,AUTO
         1 001110   000003 036003                    ADLQ    3,DU
         1 001111   200012 756110                    STQ     MULT,X0,AUTO

      381    12972    3                END;

  12972  1 001112   200033 054100                    AOS     I,,AUTO
         1 001113   200033 236100                    LDQ     I,,AUTO
         1 001114   200007 116100                    CMPQ    DIM_CNT,,AUTO
         1 001115   001106 604000 1                  TMI     s:12971

      382    12973    2             IF ATYP = %BASED_ACODE        /* BASED_ACODE */

  12973  1 001116   200041 235100                    LDA     TEMP1,,AUTO
         1 001117   000002 115007                    CMPA    2,DL
         1 001120   001354 601000 1                  TNZ     s:13023

      383    12974    3             THEN DO;                      /* Based variable */

      384    12975    3                  IPTR$ -> DITEM = DUMPTR_ITEM;

  12975  1 001121   200036 470500                    LDP0    IPTR$,,AUTO
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:56   
         1 001122   000100 100400                    MLR     fill='000'O
         1 001123   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 001124   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      385    12976    3                  CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);

  12976  1 001125   200037 631500                    EPPR1   IENTRY$,,AUTO
         1 001126   200137 451500                    STP1    CNT+3,,AUTO
         1 001127   200034 633500                    EPPR3   IENTRY#,,AUTO
         1 001130   200136 453500                    STP3    CNT+2,,AUTO
         1 001131   200136 630500                    EPPR0   CNT+2,,AUTO
         1 001132   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001133   000000 701000 xent               TSX1    DDF$VREBL_#
         1 001134   000277 702000 1                  TSX2    BADSCHEMA

      386    12977    4                  DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  12977  1 001135   000000 470400 xsym               LDP0    S_D$
         1 001136   006714 235100                    LDA     3532,,PR0
         1 001137   000003 115007                    CMPA    3,DL
         1 001140   001142 602005 1                  TNC     s:12977+5,AL
         1 001141   001207 710000 1                  TRA     s:12987
         1 001142   001207 710000 1                  TRA     s:12987
         1 001143   001145 710000 1                  TRA     s:12979
         1 001144   001166 710000 1                  TRA     s:12983

      387    12978    4                    CASE (%HOST);

      388    12979    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR.W;

  12979  1 001145   200036 471500                    LDP1    IPTR$,,AUTO
         1 001146   200037 473500                    LDP3    IENTRY$,,AUTO
         1 001147   300000 236100                    LDQ     0,,PR3
         1 001150   777777 376003                    ANQ     -1,DU
         1 001151   000006 772000                    QRL     6
         1 001152   100001 752174                    STCQ    1,'74'O,PR1

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:57   
      389    12980    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR.C;

  12980  1 001153   200037 473500                    LDP3    IENTRY$,,AUTO
         1 001154   300000 236100                    LDQ     0,,PR3
         1 001155   600000 376007                    ANQ     -65536,DL
         1 001156   000012 772000                    QRL     10
         1 001157   100001 752102                    STCQ    1,'02'O,PR1

      390    12981    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR.B;

  12981  1 001160   200037 473500                    LDP3    IENTRY$,,AUTO
         1 001161   300000 236100                    LDQ     0,,PR3
         1 001162   170000 376007                    ANQ     61440,DL
         1 001163   000014 772000                    QRL     12
         1 001164   100001 752101                    STCQ    1,'01'O,PR1
         1 001165   001212 710000 1                  TRA     s:12990

      391    12982    4                    CASE (%L6);

      392    12983    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR6.W;

  12983  1 001166   200037 471500                    LDP1    IENTRY$,,AUTO
         1 001167   200036 473500                    LDP3    IPTR$,,AUTO
         1 001170   100000 236100                    LDQ     0,,PR1
         1 001171   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 001172   000004 772000                    QRL     4
         1 001173   300001 752174                    STCQ    1,'74'O,PR3

      393    12984    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR6.C;

  12984  1 001174   200037 471500                    LDP1    IENTRY$,,AUTO
         1 001175   100000 236100                    LDQ     0,,PR1
         1 001176   100000 376007                    ANQ     32768,DL
         1 001177   000011 772000                    QRL     9
         1 001200   300001 752102                    STCQ    1,'02'O,PR3

      394    12985    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR6.B;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:58   

  12985  1 001201   200037 471500                    LDP1    IENTRY$,,AUTO
         1 001202   100000 236100                    LDQ     0,,PR1
         1 001203   070000 376007                    ANQ     28672,DL
         1 001204   000014 772000                    QRL     12
         1 001205   300001 752101                    STCQ    1,'01'O,PR3
         1 001206   001212 710000 1                  TRA     s:12990

      395    12986    4                    CASE (ELSE);

      396    12987    4                       S_D.ERROR = 502; /* E@DELBUG */

  12987  1 001207   000766 236007                    LDQ     502,DL
         1 001210   000013 756100                    STQ     11,,PR0

      397    12988    4                       ALTRETURN;

  12988  1 001211   000000 702200 xent               TSX2  ! X66_AALT

      398    12989    4                    END;

      399    12990    3                  TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;

  12990  1 001212   200037 471500                    LDP1    IENTRY$,,AUTO
         1 001213   100000 236100                    LDQ     0,,PR1
         1 001214   000010 772000                    QRL     8
         1 001215   000017 376007                    ANQ     15,DL
         1 001216   000001 136007                    SBLQ    1,DL
         1 001217   200040 756100                    STQ     TATYP,,AUTO

      400    12991    3                  IF TATYP = %PARM_ACODE OR TATYP = %SPARM_ACODE OR TATYP = %
             12991                           AREADEF_ACODE /* PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */

  12991  1 001220   000004 116007                    CMPQ    4,DL
         1 001221   001226 600000 1                  TZE     s:12993
         1 001222   000006 116007                    CMPQ    6,DL
         1 001223   001226 600000 1                  TZE     s:12993
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:59   
         1 001224   000007 116007                    CMPQ    7,DL
         1 001225   001337 601000 1                  TNZ     s:13020

      401    12992    4                  THEN DO;       /* Implicit pointer is a parameter or areadef */

      402    12993    4                       IPTR$ -> DITEM.ADDR_TYPE = %PARM_ACODE; /* PARM_ACODE */

  12993  1 001226   200036 473500                    LDP3    IPTR$,,AUTO
         1 001227   004000 236007                    LDQ     2048,DL
         1 001230   300000 552110                    STBQ    0,'10'O,PR3

      403    12994    4                       T$ = SDD$;

  12994  1 001231   200043 236100                    LDQ     SDD$,,AUTO
         1 001232   200035 756100                    STQ     T$,,AUTO

      404    12995    4                       CALL BUMPD$ ALTRET(PERR);

  12995  1 001233   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001234   200133 756100                    STQ     ENTRY#+52,,AUTO
         1 001235   001574 701000 1                  TSX1    BUMPD$
         1 001236   001573 702000 1                  TSX2    PERR

      405    12996    5                       DO WHILE (T$ >= IPTR$ );

  12996  1 001237   200035 236100                    LDQ     T$,,AUTO
         1 001240   200036 116100                    CMPQ    IPTR$,,AUTO
         1 001241   001252 602000 1                  TNC     s:13000

      406    12997    5                            PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;

  12997  1 001242   200035 470500                    LDP0    T$,,AUTO
         1 001243   000000 235100                    LDA     0,,PR0
         1 001244   000003 755100                    STA     3,,PR0

      407    12998    5                            T$ = PINCRW(T$, -1);

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:60   
  12998  1 001245   200035 236100                    LDQ     T$,,AUTO
         1 001246   777777 036003                    ADLQ    -1,DU
         1 001247   200035 756100                    STQ     T$,,AUTO

      408    12999    5                          END;             /* DO WHILE (T$ >= IPTR$) */

  12999  1 001250   200036 116100                    CMPQ    IPTR$,,AUTO
         1 001251   001242 603000 1                  TRC     s:12997

      409    13000    5                       DO I = 0 TO DIM_CNT - 1;

  13000  1 001252   200033 450100                    STZ     I,,AUTO
         1 001253   001261 710000 1                  TRA     s:13002+1

      410    13001    5                            MULT(I) = PINCRW(MULT(I), SIZEW(DITEM));

  13001  1 001254   200033 720100                    LXL0    I,,AUTO
         1 001255   200012 236110                    LDQ     MULT,X0,AUTO
         1 001256   000003 036003                    ADLQ    3,DU
         1 001257   200012 756110                    STQ     MULT,X0,AUTO

      411    13002    5                          END;

  13002  1 001260   200033 054100                    AOS     I,,AUTO
         1 001261   200033 236100                    LDQ     I,,AUTO
         1 001262   200007 116100                    CMPQ    DIM_CNT,,AUTO
         1 001263   001254 604000 1                  TMI     s:13001

      412    13003    4                       IF TATYP = %PARM_ACODE /* PARM_ACODE */

  13003  1 001264   200040 235100                    LDA     TATYP,,AUTO
         1 001265   000004 115007                    CMPA    4,DL
         1 001266   001306 601000 1                  TNZ     s:13010

      413    13004    5                       THEN DO;            /* Auto parameter */

      414    13005    5                            IPTR$ -> DITEM.VALUEB = DESC.ITEM( %PARM_DESC );
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:61   
             13005                                     /* PARM_DESC */

  13005  1 001267   000067 236000 xsym               LDQ     DESC+55
         1 001270   200036 470500                    LDP0    IPTR$,,AUTO
         1 001271   000001 756100                    STQ     1,,PR0

      415    13006    5                            IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  13006  1 001272   100000 236007                    LDQ     32768,DL
         1 001273   000000 552110                    STBQ    0,'10'O,PR0

      416    13007    5                            IPTR$ -> DITEM.SP.VP.N = IENTRY$ -> B$VREBL.IMPTR - 2;

  13007  1 001274   200037 471500                    LDP1    IENTRY$,,AUTO
         1 001275   100002 236100                    LDQ     2,,PR1
         1 001276   000022 732000                    QRS     18
         1 001277   000002 136007                    SBLQ    2,DL
         1 001300   000014 736000                    QLS     12
         1 001301   000001 752134                    STCQ    1,'34'O,PR0

      417    13008    5                            ZITEM.FLAGS.MDSE.S = '1'B; /* Need SS frame */

  13008  1 001302   200044 471500                    LDP1    ZITEM$,,AUTO
         1 001303   100000 236003                    LDQ     32768,DU
         1 001304   100001 256100                    ORSQ    1,,PR1

      418    13009    5                          END;             /* Auto parameter */

  13009  1 001305   001342 710000 1                  TRA     s:13021

      419    13010    4                       ELSE IF TATYP = %SPARM_ACODE
             13010                                /* SPARM_ACODE - Static parameter */

  13010  1 001306   000006 115007                    CMPA    6,DL
         1 001307   001321 601000 1                  TNZ     s:13016

      420    13011    5                            THEN DO;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:62   

      421    13012    5                                 IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.IMPTR;

  13012  1 001310   200036 470500                    LDP0    IPTR$,,AUTO
         1 001311   200037 471500                    LDP1    IENTRY$,,AUTO
         1 001312   100002 236100                    LDQ     2,,PR1
         1 001313   000022 732000                    QRS     18
         1 001314   000014 736000                    QLS     12
         1 001315   000001 752174                    STCQ    1,'74'O,PR0

      422    13013    5                                 IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE;
             13013                                          /* SPARM_ACODE */

  13013  1 001316   006000 236007                    LDQ     3072,DL
         1 001317   000000 552110                    STBQ    0,'10'O,PR0

      423    13014    5                               END;        /* Static parameter */

  13014  1 001320   001342 710000 1                  TRA     s:13021

      424    13015    5                            ELSE DO;       /* TATYP = AREADEF_ACODE */

      425    13016    5                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             13016                                          /* CONST_ACODE */

  13016  1 001321   200036 470500                    LDP0    IPTR$,,AUTO
         1 001322   102000 236007                    LDQ     33792,DL
         1 001323   000000 552110                    STBQ    0,'10'O,PR0

      426    13017    5                                 IPTR$ -> DITEM.VALUE = PINCRW(IENTRY$, POFFW(ADDR(
             13017                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;

  13017  1 001324   200025 236100                    LDQ     ENTRY$,,AUTO
         1 001325   000022 772000                    QRL     18
         1 001326   200136 756100                    STQ     CNT+2,,AUTO
         1 001327   200025 236100                    LDQ     ENTRY$,,AUTO
         1 001330   000002 036003                    ADLQ    2,DU
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:63   
         1 001331   000022 772000                    QRL     18
         1 001332   200136 136100                    SBLQ    CNT+2,,AUTO
         1 001333   200037 471500                    LDP1    IENTRY$,,AUTO
         1 001334   100000 235106                    LDA     0,QL,PR1
         1 001335   000001 755100                    STA     1,,PR0

      427    13018    5                               END;

      428    13019    4                     END;        /* Implicit pointer is a parameter or areadef */

  13019  1 001336   001342 710000 1                  TRA     s:13021

      429    13020    3                  ELSE IPTR$ -> DITEM.ADDR_TYPE = TATYP;

  13020  1 001337   200036 473500                    LDP3    IPTR$,,AUTO
         1 001340   000011 736000                    QLS     9
         1 001341   300000 552110                    STBQ    0,'10'O,PR3

      430    13021    3                  CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);

  13021  1 001342   200025 630500                    EPPR0   ENTRY$,,AUTO
         1 001343   200137 450500                    STP0    CNT+3,,AUTO
         1 001344   200047 720100                    LXL0    ENTRY#,,AUTO
         1 001345   200050 631510                    EPPR1   ENTRY#+1,X0,AUTO
         1 001346   200136 451500                    STP1    CNT+2,,AUTO
         1 001347   200136 630500                    EPPR0   CNT+2,,AUTO
         1 001350   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001351   000000 701000 xent               TSX1    DDF$VREBL_#
         1 001352   000277 702000 1                  TSX2    BADSCHEMA

      431    13022    3                END;                       /* Based variable */

  13022  1 001353   001452 710000 1                  TRA     s:13049

      432    13023    2             ELSE IF ATYP = %PARM_ACODE    /* PARM_ACODE - auto parameter */

  13023  1 001354   000004 115007                    CMPA    4,DL
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:64   
         1 001355   001376 601000 1                  TNZ     s:13031

      433    13024    3                  THEN DO;

      434    13025    3                       IPTR$ -> DITEM = DUMPTR_ITEM;

  13025  1 001356   200036 470500                    LDP0    IPTR$,,AUTO
         1 001357   000100 100400                    MLR     fill='000'O
         1 001360   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 001361   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      435    13026    3                      IPTR$ -> DITEM.VALUEB = DESC.ITEM( %PARM_DESC ); /* PARM_DESC */

  13026  1 001362   000067 236000 xsym               LDQ     DESC+55
         1 001363   000001 756100                    STQ     1,,PR0

      436    13027    3                       IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  13027  1 001364   100000 236007                    LDQ     32768,DL
         1 001365   000000 552110                    STBQ    0,'10'O,PR0

      437    13028    3                       IPTR$ -> DITEM.SP.VP.N = IENTRY# - 2;

  13028  1 001366   200034 236100                    LDQ     IENTRY#,,AUTO
         1 001367   000002 136007                    SBLQ    2,DL
         1 001370   000014 736000                    QLS     12
         1 001371   000001 752134                    STCQ    1,'34'O,PR0

      438    13029    3                       ZITEM.FLAGS.MDSE.S = '1'B; /* Need SS frame */

  13029  1 001372   200044 471500                    LDP1    ZITEM$,,AUTO
         1 001373   100000 236003                    LDQ     32768,DU
         1 001374   100001 256100                    ORSQ    1,,PR1

      439    13030    3                     END;                  /* Parameter */

  13030  1 001375   001452 710000 1                  TRA     s:13049
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:65   

      440    13031    2                  ELSE IF ATYP = %SPARM_ACODE /* SPARM_ACODE - Static parameter */

  13031  1 001376   000006 115007                    CMPA    6,DL
         1 001377   001412 601000 1                  TNZ     s:13037

      441    13032    3                       THEN DO;

      442    13033    3                            IPTR$ -> DITEM = DUMPTR_ITEM;

  13033  1 001400   200036 470500                    LDP0    IPTR$,,AUTO
         1 001401   000100 100400                    MLR     fill='000'O
         1 001402   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 001403   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      443    13034    3                            IPTR$ -> DITEM.ADDRESS.W = IENTRY#;

  13034  1 001404   200034 236100                    LDQ     IENTRY#,,AUTO
         1 001405   000014 736000                    QLS     12
         1 001406   000001 752174                    STCQ    1,'74'O,PR0

      444    13035    3                            IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE; /* SPARM_ACODE */

  13035  1 001407   006000 236007                    LDQ     3072,DL
         1 001410   000000 552110                    STBQ    0,'10'O,PR0

      445    13036    3                          END;             /* Static parameter */

  13036  1 001411   001452 710000 1                  TRA     s:13049

      446    13037    2                       ELSE IF ATYP = %DCB_ACODE
             13037                                /* DCB_ACODE - DCB variable needs implicit PTR */

  13037  1 001412   000003 115007                    CMPA    3,DL
         1 001413   001432 601000 1                  TNZ     s:13045

      447    13038    3                            THEN DO;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:66   

      448    13039    3                                 IPTR$ -> DITEM = DUMPTR_ITEM;

  13039  1 001414   200036 470500                    LDP0    IPTR$,,AUTO
         1 001415   000100 100400                    MLR     fill='000'O
         1 001416   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 001417   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      449    13040    3                                 IPTR$ -> DITEM.VALUEB = DESC.ITEM ( %DCB_DESC );
             13040                                          /* DCB_DESC */

  13040  1 001420   000071 236000 xsym               LDQ     DESC+57
         1 001421   000001 756100                    STQ     1,,PR0

      450    13041    3                                 IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13041                                          /* DESC_ACODE */

  13041  1 001422   100000 236007                    LDQ     32768,DL
         1 001423   000000 552110                    STBQ    0,'10'O,PR0

      451    13042    3                                 IPTR$ -> DITEM.SP.VD.DISP = IENTRY#;

  13042  1 001424   200034 236100                    LDQ     IENTRY#,,AUTO
         1 001425   000014 736000                    QLS     12
         1 001426   000001 676100                    ERQ     1,,PR0
         1 001427   000000 376000 2                  ANQ     0
         1 001430   000001 656100                    ERSQ    1,,PR0

      452    13043    3                               END;        /* DCB variable */

  13043  1 001431   001452 710000 1                  TRA     s:13049

      453    13044    3                            ELSE DO;       /* ATYP = AREADEF_ACODE */

      454    13045    3                                 IPTR$ -> DITEM = DUMPTR_ITEM;

  13045  1 001432   200036 470500                    LDP0    IPTR$,,AUTO
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:67   
         1 001433   000100 100400                    MLR     fill='000'O
         1 001434   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 001435   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      455    13046    3                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             13046                                          /* CONST_ACODE */

  13046  1 001436   102000 236007                    LDQ     33792,DL
         1 001437   000000 552110                    STBQ    0,'10'O,PR0

      456    13047    3                                 IPTR$ -> DITEM.VALUE = PINCRW(ENTRY$, POFFW(ADDR(
             13047                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;

  13047  1 001440   200025 236100                    LDQ     ENTRY$,,AUTO
         1 001441   000022 772000                    QRL     18
         1 001442   200136 756100                    STQ     CNT+2,,AUTO
         1 001443   200025 236100                    LDQ     ENTRY$,,AUTO
         1 001444   000002 036003                    ADLQ    2,DU
         1 001445   000022 772000                    QRL     18
         1 001446   200136 136100                    SBLQ    CNT+2,,AUTO
         1 001447   200025 471500                    LDP1    ENTRY$,,AUTO
         1 001450   100000 235106                    LDA     0,QL,PR1
         1 001451   000001 755100                    STA     1,,PR0

      457    13048    3                               END;        /* ATYP = AREADEF_ACODE */

      458    13049    2             ATYP = %BASED_ACODE;          /* BASED_ACODE */

  13049  1 001452   000002 235007                    LDA     2,DL
         1 001453   200041 755100                    STA     TEMP1,,AUTO

      459    13050    2           END;                            /* NOT BASED_FLAG AND (ATYP = 2 ..... */

      460    13051    1        IF BASED_FLAG

  13051  1 001454   200004 470500                    LDP0    @BASED_FLAG,,AUTO
         1 001455   000000 234100                    SZN     0,,PR0
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:68   
         1 001456   001461 605000 1                  TPL     s:13053

      461    13052    1        THEN ATYP = %BASED_ACODE;          /* BASED_ACODE */

  13052  1 001457   000002 235007                    LDA     2,DL
         1 001460   200041 755100                    STA     TEMP1,,AUTO

      462    13053    1        DITEM = DUMPTR_ITEM;

  13053  1 001461   200043 471500                    LDP1    SDD$,,AUTO
         1 001462   000100 100400                    MLR     fill='000'O
         1 001463   000000 000010 0                  ADSC9   DUMPTR_ITEM              cn=0,n=8
         1 001464   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      463    13054    1        DITEM.ADDR_TYPE = ATYP;

  13054  1 001465   200041 236100                    LDQ     TEMP1,,AUTO
         1 001466   000011 736000                    QLS     9
         1 001467   100000 552110                    STBQ    0,'10'O,PR1

      464    13055    2        DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  13055  1 001470   000000 473400 xsym               LDP3    S_D$
         1 001471   306714 235100                    LDA     3532,,PR3
         1 001472   000003 115007                    CMPA    3,DL
         1 001473   001475 602005 1                  TNC     s:13055+5,AL
         1 001474   001540 710000 1                  TRA     s:13065
         1 001475   001540 710000 1                  TRA     s:13065
         1 001476   001500 710000 1                  TRA     s:13057
         1 001477   001520 710000 1                  TRA     s:13061

      465    13056    2          CASE (%HOST);

      466    13057    2             DITEM.ADDRESS.W = B$VREBL.ADR.W;

  13057  1 001500   200025 474500                    LDP4    ENTRY$,,AUTO
         1 001501   400000 236100                    LDQ     0,,PR4
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:69   
         1 001502   777777 376003                    ANQ     -1,DU
         1 001503   000006 772000                    QRL     6
         1 001504   100001 752174                    STCQ    1,'74'O,PR1

      467    13058    2             DITEM.ADDRESS.C = B$VREBL.ADR.C;

  13058  1 001505   200025 474500                    LDP4    ENTRY$,,AUTO
         1 001506   400000 236100                    LDQ     0,,PR4
         1 001507   600000 376007                    ANQ     -65536,DL
         1 001510   000012 772000                    QRL     10
         1 001511   100001 752102                    STCQ    1,'02'O,PR1

      468    13059    2             DITEM.ADDRESS.B = B$VREBL.ADR.B;

  13059  1 001512   200025 474500                    LDP4    ENTRY$,,AUTO
         1 001513   400000 236100                    LDQ     0,,PR4
         1 001514   170000 376007                    ANQ     61440,DL
         1 001515   000014 772000                    QRL     12
         1 001516   100001 752101                    STCQ    1,'01'O,PR1
         1 001517   001543 710000 1                  TRA     s:13068

      469    13060    2          CASE (%L6);

      470    13061    2             DITEM.ADDRESS.W = B$VREBL.ADR6.W;

  13061  1 001520   200025 474500                    LDP4    ENTRY$,,AUTO
         1 001521   400000 236100                    LDQ     0,,PR4
         1 001522   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 001523   000004 772000                    QRL     4
         1 001524   100001 752174                    STCQ    1,'74'O,PR1

      471    13062    2             DITEM.ADDRESS.C = B$VREBL.ADR6.C;

  13062  1 001525   200025 474500                    LDP4    ENTRY$,,AUTO
         1 001526   400000 236100                    LDQ     0,,PR4
         1 001527   100000 376007                    ANQ     32768,DL
         1 001530   000011 772000                    QRL     9
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:70   
         1 001531   100001 752102                    STCQ    1,'02'O,PR1

      472    13063    2             DITEM.ADDRESS.B = B$VREBL.ADR6.B;

  13063  1 001532   200025 474500                    LDP4    ENTRY$,,AUTO
         1 001533   400000 236100                    LDQ     0,,PR4
         1 001534   070000 376007                    ANQ     28672,DL
         1 001535   000014 772000                    QRL     12
         1 001536   100001 752101                    STCQ    1,'01'O,PR1
         1 001537   001543 710000 1                  TRA     s:13068

      473    13064    2          CASE (ELSE);

      474    13065    2             S_D.ERROR = 502;         /* E@DELBUG */

  13065  1 001540   000766 236007                    LDQ     502,DL
         1 001541   300013 756100                    STQ     11,,PR3

      475    13066    2             ALTRETURN;

  13066  1 001542   000000 702200 xent               TSX2  ! X66_AALT

      476    13067    2          END;

      477    13068    1        IF ARRAY_FLAG

  13068  1 001543   200005 234100                    SZN     ARRAY_FLAG,,AUTO
         1 001544   001561 605000 1                  TPL     s:13070

      478    13069    1        THEN CALL DDD$MULT(DIM_CNT, MULT, ENTRY$, ENTRY#) ALTRET(PERR);

  13069  1 001545   200047 634500                    EPPR4   ENTRY#,,AUTO
         1 001546   200141 454500                    STP4    CNT+5,,AUTO
         1 001547   200025 635500                    EPPR5   ENTRY$,,AUTO
         1 001550   200140 455500                    STP5    CNT+4,,AUTO
         1 001551   200012 636500                    EPPR6   MULT,,AUTO
         1 001552   200137 456500                    STP6    CNT+3,,AUTO
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:71   
         1 001553   200007 637500                    EPPR7   DIM_CNT,,AUTO
         1 001554   200136 457500                    STP7    CNT+2,,AUTO
         1 001555   200136 630500                    EPPR0   CNT+2,,AUTO
         1 001556   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001557   000000 701000 xent               TSX1    DDD$MULT
         1 001560   001573 702000 1                  TSX2    PERR

      479    13070    1        IF XQUAL

  13070  1 001561   200031 234100                    SZN     XQUAL,,AUTO
         1 001562   001566 605000 1                  TPL     DONE

      480    13071    1        THEN CALL DDS$SET_T2Q ALTRET( BADSCHEMA );

  13071  1 001563   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001564   000000 701000 xent               TSX1    DDS$SET_T2Q
         1 001565   000277 702000 1                  TSX2    BADSCHEMA

      481    13072    1   DONE:
      482    13073    1        CALL BUMPD$ ALTRET(PERR);

  13073  1 001566   000001 236000 xsym  DONE         LDQ     B_VECTNIL+1
         1 001567   200133 756100                    STQ     ENTRY#+52,,AUTO
         1 001570   001574 701000 1                  TSX1    BUMPD$
         1 001571   001573 702000 1                  TSX2    PERR

      483    13074    1        RETURN;

  13074  1 001572   000000 702200 xent               TSX2  ! X66_ARET

      484    13075    1   PERR:
      485    13076    1        ALTRETURN;

  13076  1 001573   000000 702200 xent  PERR         TSX2  ! X66_AALT

      486    13077             %EJECT;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:72   
      487    13078             %BUMPD$;
             13079             %LIST;
             13080    1   BUMPD$: PROC(PCNT) ALTRET;

  13080  1 001574   200132 741300       BUMPD$       STX1  ! ENTRY#+51,,AUTO

             13081    2   DCL PCNT UBIN;
             13082    2   DCL CNT UBIN;
             13083    2   DCL DD_VARCOM$ PTR SYMREF;
             13084    2   DCL DDM$GETMEM ENTRY(3) ALTRET;
             13085    2        IF ADDR(PCNT) = ADDR(NIL)

  13085  1 001575   200133 236100                    LDQ     @PCNT,,AUTO
         1 001576   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001577   001603 601000 1                  TNZ     s:13087

             13086    2        THEN CNT = SIZEW(DITEM);

  13086  1 001600   000003 235007                    LDA     3,DL
         1 001601   200134 755100                    STA     CNT,,AUTO
         1 001602   001606 710000 1                  TRA     s:13088

             13087    2        ELSE CNT = PCNT;

  13087  1 001603   200133 470500                    LDP0    @PCNT,,AUTO
         1 001604   000000 235100                    LDA     0,,PR0
         1 001605   200134 755100                    STA     CNT,,AUTO

             13088    2        SDD$ = PINCRW(SDD$,CNT);

  13088  1 001606   200134 236100                    LDQ     CNT,,AUTO
         1 001607   000022 736000                    QLS     18
         1 001610   200043 036100                    ADLQ    SDD$,,AUTO
         1 001611   200043 756100                    STQ     SDD$,,AUTO

             13089    2        IF SDD$ > S_D.DESCL$

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:73   
  13089  1 001612   000000 470400 xsym               LDP0    S_D$
         1 001613   000042 116100                    CMPQ    34,,PR0
         1 001614   001643 602000 1                  TNC     s:13104
         1 001615   001643 600000 1                  TZE     s:13104

             13090    3        THEN DO;

             13091    3             IF S_D.STORED ~= 0

  13091  1 001616   000135 235100                    LDA     93,,PR0
         1 001617   001637 600000 1                  TZE     s:13100

             13092    4             THEN DO;

             13093    5                  DO WHILE (SDD$ > PINCRW(S_D.DESCL$, 1));

  13093  1 001620   001632 710000 1                  TRA     s:13097

             13094    5                       CALL DDM$GETMEM(DD_VARCOM$, 1024);

  13094  1 001621   000002 630400 2                  EPPR0   2
         1 001622   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001623   000000 701000 xent               TSX1    DDM$GETMEM
         1 001624   000000 011000                    NOP     0

             13095    5                       S_D.VARCOM_HIGH$ = PINCRW(S_D.VARCOM_HIGH$, 1024);

  13095  1 001625   000000 470400 xsym               LDP0    S_D$
         1 001626   004623 236100                    LDQ     2451,,PR0
         1 001627   002000 036003                    ADLQ    1024,DU
         1 001630   004623 756100                    STQ     2451,,PR0

             13096    5                       S_D.DESCL$ = S_D.VARCOM_HIGH$;

  13096  1 001631   000042 756100                    STQ     34,,PR0

             13097    5                     END;
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:74   

  13097  1 001632   000042 236100                    LDQ     34,,PR0
         1 001633   000001 036003                    ADLQ    1,DU
         1 001634   200043 116100                    CMPQ    SDD$,,AUTO
         1 001635   001621 602000 1                  TNC     s:13094

             13098    4                END;

  13098  1 001636   001643 710000 1                  TRA     s:13104

             13099    4             ELSE DO;

             13100    4                  S_D.ERROR = 8; /* E@NOROOM */

  13100  1 001637   000010 235007                    LDA     8,DL
         1 001640   000013 755100                    STA     11,,PR0

             13101    4                  ALTRETURN;

  13101  1 001641   200132 221300                    LDX1  ! ENTRY#+51,,AUTO
         1 001642   000000 702211                    TSX2  ! 0,X1

             13102    4                END;
             13103    3           END;
             13104    2        S_D.D$ = SDD$;

  13104  1 001643   200043 236100                    LDQ     SDD$,,AUTO
         1 001644   000044 756100                    STQ     36,,PR0

             13105    2        RETURN;

  13105  1 001645   200132 221300                    LDX1  ! ENTRY#+51,,AUTO
         1 001646   000001 702211                    TSX2  ! 1,X1

DUMPTR_ITEM
 Sect OctLoc
   0     000   000000 000001   000000 000000                                    ........
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:75   

(unnamed)
 Sect OctLoc
   2     000   000007 770000   000000 002000   000000 006000   000001 006000    ................
             13106    2        END BUMPD$;
      488    13109    1   END DDD$BLD_PTR;

PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:76   
--  Include file information  --

   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDD$BLD_PTR.

   Procedure DDD$BLD_PTR requires 935 words for executable code.
   Procedure DDD$BLD_PTR requires 98 words of local(AUTO) storage.

    No errors detected in file DDD$BLD_PTR.:E05TSI    .
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:77   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:78   
          MINI XREF LISTING

ADDREXP_FLAG
        35**DCL     12706<<ASSIGN  12732<<ASSIGN  12802>>IF      12826>>IF      12937>>IF
ARRAYTYP
        40**DCL     12905<<ASSIGN  12906>>DOCASE
ARRAY_FLAG
        34**DCL     12703<<ASSIGN  12712<<ASSIGN  12722>>ASSIGN  12797>>IF      12818>>IF      12847>>IF
     12862>>IF      13068>>IF
ATYP
        62**DCL     12928<<ASSIGN  12929>>IF      12929>>IF      12929>>IF      12929>>IF      12929>>IF
     12937>>IF      12945>>IF      12945>>IF      12945>>IF      12945>>IF      12945>>IF      12950>>IF
     12956>>IF      12973>>IF      13023>>IF      13031>>IF      13037>>IF      13049<<ASSIGN  13052<<ASSIGN
     13054>>ASSIGN
B$SDEF.AD.OU
     10469**DCL     10475--REDEF
B$SDEF.AD.OU.OFFSET
     10473**DCL     12869>>ASSIGN
B$SDEF.CONSTNT
     10480**DCL     12871>>IF
B$SDEF.LFLAGS.IS_DCB
     10495**DCL     12873>>IF
B$SDEF.VALUE
     10450**DCL     10453--REDEF   12876>>ASSIGN
B$VREBL
     10277**DCL     13017--ASSIGN  13047--ASSIGN
B$VREBL.ADDRTYP
     10304**DCL     12928>>ASSIGN  12990>>ASSIGN
B$VREBL.ADR
     10278**DCL     10290--REDEF
B$VREBL.ADR.B
     10288**DCL     12981>>ASSIGN  13059>>ASSIGN
B$VREBL.ADR.C
     10286**DCL     12980>>ASSIGN  13058>>ASSIGN
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:79   
B$VREBL.ADR.W
     10284**DCL     12979>>ASSIGN  13057>>ASSIGN
B$VREBL.ADR6.B
     10302**DCL     12985>>ASSIGN  13063>>ASSIGN
B$VREBL.ADR6.C
     10300**DCL     12984>>ASSIGN  13062>>ASSIGN
B$VREBL.ADR6.W
     10298**DCL     12983>>ASSIGN  13061>>ASSIGN
B$VREBL.ARRAYTYP
     10365**DCL     12905>>ASSIGN
B$VREBL.DATATYP
     10328**DCL     12937>>IF
B$VREBL.DIMS
     10431**DCL     12912>>ASSIGN
B$VREBL.IMPTR
     10395**DCL     12949>>ASSIGN  13007>>ASSIGN  13012>>ASSIGN  13017--ASSIGN  13047--ASSIGN
B$VREBL.LEVEL
     10347**DCL     12937>>IF      12956>>IF
BADSCHEMA
     12779**LABEL   12764--CALLALT 12769--CALLALT 12904--CALLALT 12920--CALLALT 12976--CALLALT 13021--CALLALT
     13071--CALLALT
BASED_FLAG
        32**DCL        29--PROC    12725>>IF      12787>>IF      12797>>IF      12818>>IF      12854>>IF
     12872>>IF      12885>>IF      12929>>IF      12945>>IF      13051>>IF
BUMPD$
     13080**PROC    12790--CALL    12965--CALL    12995--CALL    13073--CALL
CNT IN PROCEDURE BUMPD$
     13082**DCL     13086<<ASSIGN  13087<<ASSIGN  13088>>ASSIGN
DDD$ADDREXP
        71**DCL-ENT 12730--CALL
DDD$MULT
        74**DCL-ENT 13069--CALL
DDD$SIMEXP
        73**DCL-ENT 12785--CALL
DDD$SUBREF
        72**DCL-ENT 12713--CALL
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:80   
DDF$VREBL_#
        83**DCL-ENT 12904--CALL    12920--CALL    12976--CALL    13021--CALL
DDM$GETMEM IN PROCEDURE BUMPD$
     13084**DCL-ENT 13094--CALL
DDS$D_SRCH
        76**DCL-ENT 12748--CALL
DDS$SD_SRCH
        77**DCL-ENT 12772--CALL
DDS$SET_Q2T
        80**DCL-ENT 12763--CALL
DDS$SET_T2Q
        82**DCL-ENT 12769--CALL    13071--CALL
DDS$SET_X2Q
        81**DCL-ENT 12764--CALL
DDS$SP_SRCH
        75**DCL-ENT 12750--CALL
DDS$UD_SRCH
        79**DCL-ENT 12756--CALL
DDS$V_SRCH
        78**DCL-ENT 12759--CALL    12766--CALL
DD_VARCOM$ IN PROCEDURE BUMPD$
     13083**DCL     13094<>CALL
DESC.ITEM
     12692**DCL     12875>>ASSIGN  12958>>ASSIGN  13005>>ASSIGN  13026>>ASSIGN  13040>>ASSIGN
DESC_VAL
        61**DCL     12748<>CALL    12809>>ASSIGN
DIMS
        37**DCL     12900<<ASSIGN  12910<<ASSIGN  12910>>ASSIGN  12912<<ASSIGN  12912>>ASSIGN  12921>>IF
     12924>>ASSIGN
DIM_CNT
        36**DCL     12704<<ASSIGN  12713<>CALL    12921>>IF      12970>>DOINDEX 13000>>DOINDEX 13069<>CALL
DITEM
     11256**DCL     12783<<ASSIGN  12853<<ASSIGN  12868<<ASSIGN  12967--ASSIGN  12971--ASSIGN  12975<<ASSIGN
     12997--ASSIGN  13001--ASSIGN  13025<<ASSIGN  13033<<ASSIGN  13039<<ASSIGN  13045<<ASSIGN  13053<<ASSIGN
     13086--ASSIGN
DITEM.ADDRESS
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:81   
     11277**DCL     11282--REDEF   11283--REDEF   11284--REDEF
DITEM.ADDRESS.B
     11281**DCL     12981<<ASSIGN  12985<<ASSIGN  13059<<ASSIGN  13063<<ASSIGN
DITEM.ADDRESS.C
     11280**DCL     12980<<ASSIGN  12984<<ASSIGN  13058<<ASSIGN  13062<<ASSIGN
DITEM.ADDRESS.W
     11279**DCL     12870<<ASSIGN  12979<<ASSIGN  12983<<ASSIGN  13012<<ASSIGN  13034<<ASSIGN  13057<<ASSIGN
     13061<<ASSIGN
DITEM.ADDR_TYPE
     11272**DCL     12788<<ASSIGN  12789<<ASSIGN  12810<<ASSIGN  12840<<ASSIGN  12855<<ASSIGN  12856<<ASSIGN
     12877<<ASSIGN  12884<<ASSIGN  12891<<ASSIGN  12959<<ASSIGN  12993<<ASSIGN  13006<<ASSIGN  13013<<ASSIGN
     13016<<ASSIGN  13020<<ASSIGN  13027<<ASSIGN  13035<<ASSIGN  13041<<ASSIGN  13046<<ASSIGN  13054<<ASSIGN
DITEM.FLAGS.OFLAG
     11260**DCL     12785<>CALL
DITEM.SP.MDSE.S
     11301**DCL     12807>>ASSIGN
DITEM.SP.VD
     11285**DCL     11289--REDEF   11292--REDEF
DITEM.SP.VD.DISP
     11288**DCL     12876<<ASSIGN  12960<<ASSIGN  13042<<ASSIGN
DITEM.SP.VP.N
     11291**DCL     13007<<ASSIGN  13028<<ASSIGN
DITEM.SP.VS.ID
     11293**DCL     12818>>IF      12818>>IF
DITEM.TYPE_CODE
     11275**DCL     12784<<ASSIGN  12811<<ASSIGN  12841<<ASSIGN  12961<<ASSIGN
DITEM.VALUE
     11282**DCL     12786<<ASSIGN  13017<<ASSIGN  13047<<ASSIGN
DITEM.VALUEB
     11283**DCL     12809<<ASSIGN  12839<<ASSIGN  12875<<ASSIGN  12958<<ASSIGN  13005<<ASSIGN  13026<<ASSIGN
     13040<<ASSIGN
DONE
     13073**LABEL   12812--GOTO    12842--GOTO    12857--GOTO    12892--GOTO    12962--GOTO
DUMPTR_ITEM
     12693**DCL     12853>>ASSIGN  12868>>ASSIGN  12975>>ASSIGN  13025>>ASSIGN  13033>>ASSIGN  13039>>ASSIGN
     13045>>ASSIGN  13053>>ASSIGN
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:82   
ENTRY#
     12639**DCL     12759<>CALL    12766<>CALL    13069<>CALL
ENTRY#.C
     12640**DCL     12760>>ASSIGN  12767>>IF      12768>>ASSIGN  12901>>DOINDEX 12902>>ASSIGN  12903>>IF
     12919>>IF      12920>>CALL    13021>>CALL
ENTRY#.E
     12641**DCL     12904<>CALL    12920<>CALL    13021<>CALL
ENTRY$
        44**DCL     10277--IMP-PTR 12759<>CALL    12766<>CALL    12772<>CALL    12869>>ASSIGN  12871>>IF
     12873>>IF      12876>>ASSIGN  12904<>CALL    12905>>ASSIGN  12912>>ASSIGN  12920<>CALL    12928>>ASSIGN
     12937>>IF      12937>>IF      12949>>ASSIGN  12956>>IF      13017>>ASSIGN  13017>>ASSIGN  13021<>CALL
     13047>>ASSIGN  13047>>ASSIGN  13047>>ASSIGN  13057>>ASSIGN  13058>>ASSIGN  13059>>ASSIGN  13061>>ASSIGN
     13062>>ASSIGN  13063>>ASSIGN  13069<>CALL
EXPR_IDX
        49**DCL     12722<<ASSIGN  12723>>IF      12730<>CALL
GOT_DESC
     12797**LABEL   12748--CALLALT
GOT_SDEF
     12862**LABEL   12772--CALLALT
GOT_SPEC
     12818**LABEL   12750--CALLALT
GOT_UDEF
     12847**LABEL   12756--CALLALT
GOT_VAR
     12900**LABEL   12759--CALLALT 12766--CALLALT
HIGH_ENTRY#
        45**DCL     12760<<ASSIGN  12767>>IF      12768<<ASSIGN  12773>>ASSIGN
I
        50**DCL     12901<<DOINDEX 12902>>ASSIGN  12970<<DOINDEX 12971>>ASSIGN  12971>>ASSIGN  13000<<DOINDEX
     13001>>ASSIGN  13001>>ASSIGN
IENTRY#
        51**DCL     12949<<ASSIGN  12950>>IF      12960>>ASSIGN  12976<>CALL    13028>>ASSIGN  13034>>ASSIGN
     13042>>ASSIGN
IENTRY$
        54**DCL     12976<>CALL    12979>>ASSIGN  12980>>ASSIGN  12981>>ASSIGN  12983>>ASSIGN  12984>>ASSIGN
     12985>>ASSIGN  12990>>ASSIGN  13007>>ASSIGN  13012>>ASSIGN  13017>>ASSIGN
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:83   
IPTR$
        53**DCL     12705<<ASSIGN  12966>>DOWHILE 12975>>ASSIGN  12979>>ASSIGN  12980>>ASSIGN  12981>>ASSIGN
     12983>>ASSIGN  12984>>ASSIGN  12985>>ASSIGN  12993>>ASSIGN  12996>>DOWHILE 13005>>ASSIGN  13006>>ASSIGN
     13007>>ASSIGN  13012>>ASSIGN  13013>>ASSIGN  13016>>ASSIGN  13017>>ASSIGN  13020>>ASSIGN  13025>>ASSIGN
     13026>>ASSIGN  13027>>ASSIGN  13028>>ASSIGN  13033>>ASSIGN  13034>>ASSIGN  13035>>ASSIGN  13039>>ASSIGN
     13040>>ASSIGN  13041>>ASSIGN  13042>>ASSIGN  13045>>ASSIGN  13046>>ASSIGN  13047>>ASSIGN
MULT
        39**DCL     12713<>CALL    12971<<ASSIGN  12971>>ASSIGN  13001<<ASSIGN  13001>>ASSIGN  13069<>CALL
NQFLAG
        47**DCL     12740<<ASSIGN  12741<<ASSIGN  12746>>IF      12755>>IF      12771>>IF
O.CODE
      3205**DCL     12701>>IF      12710>>IF      12744>>IF
O.NSUBLKS
      3209**DCL     12707>>IF      12723>>IF      12739>>IF
O.SUBLK$
      3230**DCL     12709>>ASSIGN  12738>>ASSIGN  12742>>ASSIGN  12743>>ASSIGN  12773>>ASSIGN  12773>>ASSIGN
PCNT IN PROCEDURE BUMPD$
     13081**DCL     13080--PROC    13085--IF      13087>>ASSIGN
PERR
     13076**LABEL   12713--CALLALT 12719--GOTO    12728--GOTO    12730--CALLALT 12785--CALLALT 12790--CALLALT
     12965--CALLALT 12995--CALLALT 13069--CALLALT 13073--CALLALT
RANGE_FLAG
        46**DCL     12713<>CALL    12716>>IF
ROOT$
        31**DCL        29--PROC    12701>>IF      12707>>IF      12709>>ASSIGN  12723>>IF      12730<>CALL
     12738>>ASSIGN  12785<>CALL
SDD$
     10606**DCL     11256--IMP-PTR 12699<<ASSIGN  12705>>ASSIGN  12715<<ASSIGN  12731<<ASSIGN  12783>>ASSIGN
     12784>>ASSIGN  12785>>CALL    12786>>ASSIGN  12788>>ASSIGN  12789>>ASSIGN  12807>>ASSIGN  12809>>ASSIGN
     12810>>ASSIGN  12811>>ASSIGN  12839>>ASSIGN  12840>>ASSIGN  12841>>ASSIGN  12853>>ASSIGN  12855>>ASSIGN
     12856>>ASSIGN  12868>>ASSIGN  12870>>ASSIGN  12875>>ASSIGN  12876>>ASSIGN  12877>>ASSIGN  12884>>ASSIGN
     12891>>ASSIGN  12958>>ASSIGN  12959>>ASSIGN  12960>>ASSIGN  12961>>ASSIGN  12964>>ASSIGN  12994>>ASSIGN
     13053>>ASSIGN  13054>>ASSIGN  13057>>ASSIGN  13058>>ASSIGN  13059>>ASSIGN  13061>>ASSIGN  13062>>ASSIGN
     13063>>ASSIGN  13088<<ASSIGN  13088>>ASSIGN  13089>>IF      13093>>DOWHILE 13104>>ASSIGN
SEARCH_VAR
     12758**LABEL   12753--GOTO
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:84   
SITEM_VAL
        58**DCL     12750<>CALL    12818--IF      12818--IF      12839>>ASSIGN
SITEM_VAL.ID
        59**DCL     12826>>IF      12826>>IF      12826>>IF      12826>>IF      12826>>IF      12826>>IF
     12826>>IF      12826>>IF
STRUCT
        38**DCL     12902<<ASSIGN  12904>>CALL
SYM$
        42**DCL     12743<<ASSIGN  12748<>CALL    12750<>CALL    12756<>CALL    12772<>CALL    12773<<ASSIGN
     12776>>ASSIGN  12800>>ASSIGN  12823>>ASSIGN  12850>>ASSIGN  12865>>ASSIGN  12881>>ASSIGN  12888>>ASSIGN
     12914>>ASSIGN  12923>>ASSIGN  12933>>ASSIGN  12941>>ASSIGN  12952>>ASSIGN
SYM2$
        43**DCL     12742<<ASSIGN  12743>>ASSIGN  12744>>IF
S_D.CURRENT_CHANNEL
      5608**DCL      5610--REDEF
S_D.D$
      4746**DCL     12699>>ASSIGN  12715>>ASSIGN  12731>>ASSIGN  13104<<ASSIGN
S_D.DEBUGA
      4760**DCL      4762--REDEF
S_D.DESC$
      4740**DCL     12700>>ASSIGN
S_D.DESCL$
      4742**DCL     13089>>IF      13093>>DOWHILE 13096<<ASSIGN
S_D.EIS
      5718**DCL      5747--REDEF
S_D.ERROR
      4689**DCL     12718<<ASSIGN  12727<<ASSIGN  12775<<ASSIGN  12779<<ASSIGN  12799<<ASSIGN  12804<<ASSIGN
     12822<<ASSIGN  12836<<ASSIGN  12849<<ASSIGN  12864<<ASSIGN  12880<<ASSIGN  12887<<ASSIGN  12915<<ASSIGN
     12925<<ASSIGN  12934<<ASSIGN  12942<<ASSIGN  12953<<ASSIGN  12987<<ASSIGN  13065<<ASSIGN  13100<<ASSIGN
S_D.ERROR_HICHAR
      5302**DCL     12924<<ASSIGN
S_D.ERROR_SYM$
      4713**DCL     12776<<ASSIGN  12800<<ASSIGN  12823<<ASSIGN  12850<<ASSIGN  12865<<ASSIGN  12881<<ASSIGN
     12888<<ASSIGN  12914<<ASSIGN  12923<<ASSIGN  12933<<ASSIGN  12941<<ASSIGN  12952<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      5651**DCL      5652--REDEF    5666--REDEF
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:85   
S_D.JDE
      5265**DCL      5266--REDEF
S_D.L$.VALUE
      4818**DCL      4824--REDEF    4832--REDEF    4835--REDEF    4838--REDEF    4841--REDEF
S_D.L$.VALUE.L
      4819**DCL      4820--REDEF    4821--REDEF
S_D.L6_MESSAGE_BUF
      5672**DCL      5674--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      5683**DCL     12977>>DOCASE  13055>>DOCASE
S_D.OUTPUT
      5638**DCL      5640--REDEF
S_D.REMOTE_MSG.FNCC
      5657**DCL      5658--REDEF
S_D.REMOTE_MSG.STXC
      5653**DCL      5654--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5661**DCL      5662--REDEF
S_D.STORED
      4854**DCL     13091>>IF
S_D.SV
      4717**DCL      4738--REDEF
S_D.VARCOM_HIGH$
      5131**DCL     13095<<ASSIGN  13095>>ASSIGN  13096>>ASSIGN
S_D.XSCH.OK
      4996**DCL     12761>>IF
S_D$
      5969**DCL      4665--IMP-PTR 12699>>ASSIGN  12700>>ASSIGN  12715>>ASSIGN  12718>>ASSIGN  12727>>ASSIGN
     12731>>ASSIGN  12761>>IF      12775>>ASSIGN  12776>>ASSIGN  12779>>ASSIGN  12799>>ASSIGN  12800>>ASSIGN
     12804>>ASSIGN  12822>>ASSIGN  12823>>ASSIGN  12836>>ASSIGN  12849>>ASSIGN  12850>>ASSIGN  12864>>ASSIGN
     12865>>ASSIGN  12880>>ASSIGN  12881>>ASSIGN  12887>>ASSIGN  12888>>ASSIGN  12914>>ASSIGN  12915>>ASSIGN
     12923>>ASSIGN  12924>>ASSIGN  12925>>ASSIGN  12933>>ASSIGN  12934>>ASSIGN  12941>>ASSIGN  12942>>ASSIGN
     12952>>ASSIGN  12953>>ASSIGN  12977>>DOCASE  12987>>ASSIGN  13055>>DOCASE  13065>>ASSIGN  13089>>IF
     13091>>IF      13093>>DOWHILE 13095>>ASSIGN  13095>>ASSIGN  13096>>ASSIGN  13096>>ASSIGN  13100>>ASSIGN
     13104>>ASSIGN
T$
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:86   
        52**DCL     12964<<ASSIGN  12966>>DOWHILE 12967>>ASSIGN  12967>>ASSIGN  12968<<ASSIGN  12968>>ASSIGN
     12994<<ASSIGN  12996>>DOWHILE 12997>>ASSIGN  12997>>ASSIGN  12998<<ASSIGN  12998>>ASSIGN
TATYP
        55**DCL     12990<<ASSIGN  12991>>IF      12991>>IF      12991>>IF      13003>>IF      13010>>IF
     13020>>ASSIGN
TEMP$
        41**DCL     12709<<ASSIGN  12710>>IF      12713<>CALL    12738<<ASSIGN  12739>>IF      12742>>ASSIGN
     12759<>CALL    12766<>CALL    12773>>ASSIGN
TEMP1
        57**DCL        58--REDEF      61--REDEF      62--REDEF   12756<>CALL    12785<>CALL    12786>>ASSIGN
     12869<<ASSIGN  12870>>ASSIGN
TEXTC.SZ
        65**DCL        66--IMP-SIZ
UBIN36
        56**DCL     12967<<ASSIGN  12967>>ASSIGN  12997<<ASSIGN  12997>>ASSIGN  13017>>ASSIGN  13047>>ASSIGN
XQUAL
        48**DCL     12758<<ASSIGN  12765<<ASSIGN  13070>>IF
ZITEM.ADDRESS
     11218**DCL     11223--REDEF   11224--REDEF   11225--REDEF
ZITEM.FLAGS.MDSE.S
     11193**DCL     12807<<ASSIGN  12807>>ASSIGN  13008<<ASSIGN  13029<<ASSIGN
ZITEM.SP.VD
     11226**DCL     11230--REDEF   11233--REDEF
ZITEM$
     10607**DCL     11184--IMP-PTR 12700<<ASSIGN  12807>>ASSIGN  12807>>ASSIGN  13008>>ASSIGN  13029>>ASSIGN
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:87   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDD$BLD_PTR File=DDD$BLD_PTR.:E05TSI                          TUE 07/29/97 13:51 Page:88   
              MINI UREF LISTING

DDD$BLD_PTR      29**PROC
SDD_L6$   10608**DCL
TEMP2      63**DCL
TXTC      67**DCL
ZITEM_L6$   10609**DCL
