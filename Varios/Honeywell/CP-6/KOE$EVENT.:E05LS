VERSION E05

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:1    
        1        1        /*M* KOE$EVENT - Code to process events for PIGLET                            */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        KOE$HOST_EVENT: PROC ALTRET;
        8        8        /**/
        9        9        /*  KOE$HOST_EVENT                                                            */
       10       10        /*   This routine is called when a host input event is detected.              */
       11       11        /**/
       12       12        /**/
       13       13        /*  INCLUDE FILES  */
       14       14        /**/
       15       15        %INCLUDE KO_DATA_R;
       16     3762        %INCLUDE KP_PERR_C;                     /* Error/status codes, FEP to host    */
       17     3827        /**/
       18     3828        /*  ENTRY DCLS  */
       19     3829        /**/
       20     3830        %KO_ENTRIES (OMIT=KOE$HOST_EVENT);
       21     3886        /**/
       22     3887        /*  AUTO  */
       23     3888        /**/
       24     3889    1   DCL I SBIN;
       25     3890    1   DCL MSG_DSIZE UBIN(16) UNAL;
       26     3891    1   DCL 1 MSG_DSIZE_ REDEF MSG_DSIZE,
       27     3892    1         2 HOB UBIN(8) UNAL,
       28     3893    1         2 LOB UBIN(8) UNAL;
       29     3894    1   DCL PACK UBIN(16) UNAL;
       30     3895    1   DCL 1 PACK_ REDEF PACK,
       31     3896    1         2 HOB UBIN(8) UNAL,
       32     3897    1         2 LOB UBIN(8) UNAL;
       33     3898        %KO_DEVICE_STATUS (NAME=STATUS,STCLASS="REDEF PACK");
       34     3948    1   DCL J SBIN WORD;
       35     3949    1   DCL NUM_SECTORS SBIN WORD;
       36     3950    1   DCL FIRST_SECTOR SBIN;
       37     3951    1   DCL CURR_TRACK SBIN WORD;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:2    
       38     3952    1   DCL CURR_SIDE SBIN WORD;
       39     3953    1   DCL LO_TRACK SBIN WORD;
       40     3954    1   DCL LO_SIDE SBIN WORD;
       41     3955        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:3    
       42     3956        /**/
       43     3957        /*  BASED  */
       44     3958        /**/
       45     3959    1   DCL 1 IN$DATA BASED(IN_DISK_BUF$) ALIGNED,
       46     3960    1         2 DUBIN(0:0) UBIN BYTE CALIGNED,
       47     3961    1         2 DCHAR REDEF DUBIN CHAR(IN_DISK_MES_LEN) CALIGNED;
       48     3962    1   DCL 1 OUT$DATA BASED(OUT_DISK_BUF$) ALIGNED,
       49     3963    1         2 DUBIN(0:0) UBIN BYTE CALIGNED,
       50     3964    1         2 DCHAR REDEF DUBIN CHAR(OUT_DISK_MES_LEN) CALIGNED;
       51     3965    1   DCL TEST_DATA$$ EPTR CONSTANT INIT(ENTADDR(KOE$HOST_EVENT));
       52     3966    1   DCL TEST_DATA$ REDEF TEST_DATA$$ PTR;
       53     3967    1   DCL 1 TEST$DATA BASED(TEST_DATA$) ALIGNED,
       54     3968    1         2 DCHAR CHAR(OUT_DISK_MES_LEN);
       55     3969        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:4    
       56     3970        /**/
       57     3971        /*  CONSTANT  */
       58     3972        /**/
       59     3973    1   DCL READ_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       60     3974    1               %OP_SETSEC#,
       61     3975    1               %OP_SETTRKSID#,
       62     3976    1               %OP_SEEK#,
       63     3977    1               %OP_SETIRANGEADDR#,
       64     3978    1               %OP_NOTHING#,0,0,0,0,0);
       65     3979    1   DCL VINIT_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       66     3980    1               %OP_SETSEC#,
       67     3981    1               %OP_SETTRKSID#,
       68     3982    1               %OP_SEEK#,
       69     3983    1               %OP_SETORANGEADDR#,
       70     3984    1               %OP_EXVINIT#,
       71     3985    1               %OP_NOTHING#,0,0,0,0);
       72     3986    1   DCL WRITE_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       73     3987    1               %OP_SETSEC#,
       74     3988    1               %OP_SETTRKSID#,
       75     3989    1               %OP_SEEK#,
       76     3990    1               %OP_SETORANGEADDR#,
       77     3991    1               %OP_EXWRITE#,
       78     3992    1               %OP_NOTHING#,0,0,0,0);
       79     3993    1   DCL VERFY_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       80     3994    1               %OP_SETSEC#,
       81     3995    1               %OP_SETTRKSID#,
       82     3996    1               %OP_SEEK#,
       83     3997    1               %OP_SETIRANGEADDR#,
       84     3998    1               %OP_EXVERIFY#,
       85     3999    1               %OP_NOTHING#,0,0,0,0);
       86     4000        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:5    
       87     4001    1             DISK_RETRIES = 0;
       88     4002        /**/
       89     4003        /*  Almost everyone uses the data in the message itself for an I/O            */
       90     4004        /*  buffer.  Set up parameters accordingly.                                   */
       91     4005        /**/
       92     4006    1             MSG_DSIZE_ = KP_MSG.HEAD.NUM_BYTES;
       93     4007    1             DISK_LEN = MSG_DSIZE;
       94     4008    1             DISK_BUF$ = ADDR(KP_MSG.TDATA);
       95     4009        /**/
       96     4010        /*  Almost everyone uses the drive in the message head.  */
       97     4011        /**/
       98     4012    1             KO_DRIVE = KP_MSG.HEAD.DRIVE_NO;
       99     4013        /**/
      100     4014        /*  Set up default physical I/O parameters.  */
      101     4015        /**/
      102     4016    1             DISK_SECTOR_NO = KP_MSG.HEAD.SECTOR_NO;
      103     4017    1             DISK_SEC_SIZE = KP_MSG.HEAD.SEC_SIZE;
      104     4018    1             DISK_TRACK_NO = KP_MSG.HEAD.TRACK_NO;
      105     4019    1             DISK_SIDE = KP_MSG.HEAD.SIDE;
      106     4020    1             KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;
      107     4021        /**/
      108     4022        /*  Do the requested command.                                                 */
      109     4023        /**/
      110     4024    2             DO CASE(KP_MSG.HEAD.MSG_TYPE);
      111     4025        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:6    
      112     4026    2                CASE(%KP_VINIT_RQS#);
      113     4027    2                  KP_MSG.HEAD.MSG_TYPE = %KP_VINIT_STT#;
      114     4028    2                  MSG_DSIZE = 0;           /* Response has no data area          */
      115     4029    2                  IF NOT KO_OPENED THEN
      116     4030    2                     GOTO NOT_OPENED;
      117     4031    2                  FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;
      118     4032    2                  NUM_SECTORS = KP_MSG.CRTFY_RQS.SECTOR_HI - FIRST_SECTOR +1;
      119     4033    3                  DO DISK_TRACK_NO = DISK_TRACK_NO TO KP_MSG.VINIT_RQS.TRACK_HI;
      120     4034    4                     DO DISK_SIDE = KP_MSG.HEAD.SIDE TO KP_MSG.VINIT_RQS.SIDE_HI;
      121     4035    4                        KP_MSG.HEAD.TRACK_NO = DISK_TRACK_NO; /* For status info */
      122     4036    4                        CALL DO_VINIT ALTRET(SEND_STATUS_ONLY);
      123     4037    4                        DISK_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;
      124     4038    4                        DISK_BUF$ = OUT_DISK_BUF$;
      125     4039    4                        CALL DO_VERFY ALTRET(SEND_STATUS_ONLY);
      126     4040    4                        END;               /* END CURR_SIDE                      */
      127     4041    3                     CALL SEND_MSG;
      128     4042    3                     END;                  /* END CURR_TRACK                     */
      129     4043    2                  KP_MSG.HEAD.MSG_TYPE = %KP_VINIT_RSP#;
      130     4044    2                  GOTO GOOD_COMPLETION;
      131     4045        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:7    
      132     4046    2                CASE(%KP_CERTIFY_RQS#);
      133     4047    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CERTIFY_RSP#;
      134     4048    2                  MSG_DSIZE = SIZEC(KP_MSG.CRTFY_RSP) - SIZEC(KP_MSG.CRTFY_RSP.SPARE);
      135     4049    2                  KP_MSG.CRTFY_RSP = '0'B;
      136     4050    2                  IF NOT KO_OPENED THEN
      137     4051    2                     GOTO NOT_OPENED;
      138     4052        /* VOLINIT THE TRACK */
      139     4053    2                  FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;
      140     4054    2                  NUM_SECTORS = KP_MSG.CRTFY_RQS.SECTOR_HI - FIRST_SECTOR +1;
      141     4055    2                  CALL DO_VINIT ALTRET(CERTERR_V);
      142     4056    2                  KP_MSG.CRTFY_RSP.VINIT_RETRIES = DISK_RETRIES;
      143     4057    2                  DISK_RETRIES = 0;
      144     4058        /* WRITE TEST DATA */
      145     4059    2                  OUT_DISK_MES_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;
      146     4060    2                  DISK_BUF$ = TEST_DATA$;
      147     4061    2                  DISK_LEN = OUT_DISK_MES_LEN;
      148     4062    2                  CALL DO_WRITE ALTRET(CERTERR_W);
      149     4063    2                  KP_MSG.CRTFY_RSP.WRITE_RETRIES = DISK_RETRIES;
      150     4064    2                  DISK_RETRIES = 0;
      151     4065        /* READ TEST DATA */
      152     4066    2                  IN_DISK_MES_LEN = OUT_DISK_MES_LEN;
      153     4067    2                  DISK_BUF$ = OUT_DISK_BUF$;
      154     4068    2                  DISK_LEN = IN_DISK_MES_LEN;
      155     4069    3                  DO I = 1 TO 100;
      156     4070    3                     CALL DO_VERFY ALTRET(CERTERR_R);
      157     4071    3                     IF TEST$DATA.DCHAR ~= OUT$DATA.DCHAR THEN
      158     4072    4                        DO;
      159     4073    4                          KP_MSG.CRTFY_RSP.READ_DATA_ERRORS = DISK_RETRIES +1;
      160     4074    4                          END;
      161     4075    3                     END;                  /* END DO I                           */
      162     4076    2                  KP_MSG.CRTFY_RSP.READ_RETRIES = DISK_RETRIES;
      163     4077    2                  DISK_RETRIES = 0;
      164     4078    2                  GOTO GOOD_COMPLETION;
      165     4079    2   CERTERR_V:     ;
      166     4080    2   CERTERR_W:     ;
      167     4081    2   CERTERR_R:     ;
      168     4082    2                  GOTO DEV_ERR;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:8    
      169     4083        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:9    
      170     4084    2                CASE(%KP_CLONE_RQS#);
      171     4085    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CLONE_STT#;
      172     4086    2                  MSG_DSIZE = 0;
      173     4087    2                  IF NOT KO_OPENED THEN
      174     4088    2                     GOTO NOT_OPENED;
      175     4089    2                  FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;
      176     4090    2                  NUM_SECTORS = KP_MSG.CLONE_RQS.SECTOR_HI - FIRST_SECTOR +1;
      177     4091    2                  DISK_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;
      178     4092    2                  DISK_BUF$ = OUT_DISK_BUF$;
      179     4093    3                  DO DISK_TRACK_NO = DISK_TRACK_NO TO KP_MSG.CLONE_RQS.TRACK_HI;
      180     4094    4                     DO DISK_SIDE = KP_MSG.HEAD.SIDE TO KP_MSG.CLONE_RQS.SIDE_HI;
      181     4095    4                        KP_MSG.HEAD.TRACK_NO = DISK_TRACK_NO;
      182     4096    4                        KO_DRIVE = KP_MSG.HEAD.DRIVE_NO;
      183     4097    4                        CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);
      184     4098    4                        CALL PERFORM_SEQUENCE (READ_LIST) ALTRET(DEV_ERR);
      185     4099    4                        CALL KOP$PHYS_IO(KO_CHANNEL,
      186     4100    4                                         %OP_EXREAD#,,
      187     4101    4                                         KP_MSG.HEAD.DEV_STATUS)
      188     4102    4                                         ALTRET(DEV_ERR);
      189     4103    4                        KO_DRIVE = KP_MSG.CLONE_RQS.DEST_DRIVE;
      190     4104    4                        CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);
      191     4105    4                        CALL DO_WRITE ALTRET(DEV_ERR);
      192     4106    4                        END;                  /* END DISK_SIDE                      */
      193     4107    3                     CALL SEND_MSG;
      194     4108    3                     END;                  /* END DISK_TRACK_NO                  */
      195     4109    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CLONE_RSP#;
      196     4110    2                  GOTO GOOD_COMPLETION;
      197     4111        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:10   
      198     4112    2                CASE(%KP_CER2_RQS#);
      199     4113    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CER2_RSP#;
      200     4114    2                  MSG_DSIZE = SIZEC(KP_MSG.CER2_RSP) - SIZEC(KP_MSG.CER2_RSP.SPARE);
      201     4115    2                  KP_MSG.CER2_RSP = '0'B;
      202     4116    2                  IF NOT KO_OPENED THEN
      203     4117    2                     GOTO NOT_OPENED;
      204     4118    2                  LO_TRACK = KP_MSG.HEAD.TRACK_NO;
      205     4119    2                  LO_SIDE = KP_MSG.HEAD.SIDE;
      206     4120        /* TEXT FOR CROSSTALK BY WRITING EACH TRACK IN SEQUENCE, AND THEN READING.    */
      207     4121    3                  DO DISK_SIDE = LO_SIDE TO KP_MSG.CER2_RQS.SIDE_HI;
      208     4122    4                     DO DISK_TRACK_NO = LO_TRACK TO KP_MSG.CER2_RQS.TRACK_HI;
      209     4123                             /* VOLINIT THE TRACK */
      210     4124    4                        FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;
      211     4125    4                        NUM_SECTORS = KP_MSG.CER2_RQS.SECTOR_HI - FIRST_SECTOR +1;
      212     4126    4                        CALL DO_VINIT ALTRET(UNINTENTIONAL);
      213     4127                             /* WRITE TEST DATA */
      214     4128    4                        OUT_DISK_MES_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) *
              4128                                 128;
      215     4129    4                        DISK_BUF$ = TEST_DATA$;
      216     4130    4                        DISK_LEN = OUT_DISK_MES_LEN;
      217     4131    4                        CALL DO_WRITE ALTRET(FROBOZZ);
      218     4132    4                        END;               /* END DISK_TRACK_NO                     */
      219     4133    4                     DO DISK_TRACK_NO = LO_TRACK TO KP_MSG.CER2_RQS.TRACK_HI;
      220     4134                             /* READ TEST DATA */
      221     4135    4                        IN_DISK_MES_LEN = OUT_DISK_MES_LEN;
      222     4136    4                        DISK_BUF$ = OUT_DISK_BUF$;
      223     4137    4                        DISK_LEN = IN_DISK_MES_LEN;
      224     4138    4                        CALL DO_VERFY ALTRET(FROBOZZ);
      225     4139    4                        IF TEST$DATA.DCHAR ~= OUT$DATA.DCHAR THEN
      226     4140    5                           DO;
      227     4141    5   FROBOZZ:                  ;
      228     4142    5                             KP_MSG.CER2_RSP.CROSSTALK = KP_MSG.CER2_RSP.CROSSTALK +1;
      229     4143    5                             END;
      230     4144    4                        END;               /* END DISK_TRACK_NO                     */
      231     4145    3                     END;                  /* END DISK_SIDE                      */
      232     4146    2                  IF (KP_MSG.CER2_RQS.SIDE_HI - LO_SIDE +1) ~= 2 THEN
      233     4147    2                     GOTO GOOD_COMPLETION;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:11   
      234     4148        /* TEST FOR PRINTTHROUGH.  WE DO THIS BY WRITING A GOOD TRACK, WRITING        */
      235     4149        /* ANYTHING ON THE OTHER SIDE OF THE DISKETTE, AND SEEING IF THE FIRST SIDE   */
      236     4150        /* IS STILL OK.                                                               */
      237     4151    3                  DO DISK_TRACK_NO = LO_TRACK TO KP_MSG.CER2_RQS.TRACK_HI;
      238     4152    3                     DISK_SIDE = LO_SIDE;
      239     4153                          /* VOLINIT THE TRACK */
      240     4154    3                     FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;
      241     4155    3                     NUM_SECTORS = KP_MSG.CER2_RQS.SECTOR_HI - FIRST_SECTOR +1;
      242     4156    3                     CALL DO_VINIT ALTRET(UNINTENTIONAL);
      243     4157                          /* WRITE TEST DATA */
      244     4158    3                     OUT_DISK_MES_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;
      245     4159    3                     DISK_BUF$ = TEST_DATA$;
      246     4160    3                     DISK_LEN = OUT_DISK_MES_LEN;
      247     4161    3                     CALL DO_WRITE ALTRET(BOZZ);
      248     4162    3                     DISK_SIDE = KP_MSG.CER2_RQS.SIDE_HI;
      249     4163                          /* VOLINIT THE TRACK */
      250     4164    3                     FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;
      251     4165    3                     NUM_SECTORS = KP_MSG.CER2_RQS.SECTOR_HI - FIRST_SECTOR +1;
      252     4166    3                     CALL DO_VINIT ALTRET(UNINTENTIONAL);
      253     4167    3                     DISK_SIDE = LO_SIDE;
      254     4168                          /* READ TEST DATA */
      255     4169    3                     IN_DISK_MES_LEN = OUT_DISK_MES_LEN;
      256     4170    3                     DISK_BUF$ = OUT_DISK_BUF$;
      257     4171    3                     DISK_LEN = IN_DISK_MES_LEN;
      258     4172    3                     CALL DO_VERFY ALTRET(BOZZ);
      259     4173    3                     IF TEST$DATA.DCHAR ~= OUT$DATA.DCHAR THEN
      260     4174    4                        DO;
      261     4175    4   BOZZ:                  ;
      262     4176    4                          KP_MSG.CER2_RSP.PRINTTHROUGH = KP_MSG.CER2_RSP.PRINTTHROUGH +
              4176                                   1;
      263     4177    4                          END;
      264     4178    3                     END;                  /* END DISK_TRACK_NO                     */
      265     4179    2                  GOTO GOOD_COMPLETION;
      266     4180    2   UNINTENTIONAL: ;                        /* Unexpected error                   */
      267     4181    2                  GOTO SEND_STATUS;
      268     4182        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:12   
      269     4183    2                CASE(%KP_WRITE_RQS#);
      270     4184    2                  KP_MSG.HEAD.MSG_TYPE = %KP_WRITE_RSP#;
      271     4185    2                  IF NOT KO_OPENED THEN
      272     4186    2                     GOTO NOT_OPENED;
      273     4187    2                  CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);
      274     4188    2                  CALL DO_WRITE ALTRET(SEND_STATUS);
      275     4189    2                  OUT_DISK_MES_LEN = DISK_LEN;
      276     4190    2                  IN_DISK_MES_LEN = DISK_LEN;
      277     4191    2                  DISK_BUF$ = IN_DISK_BUF$;
      278     4192    2                  CALL DO_VERFY ALTRET(SEND_STATUS);
      279     4193    2                  IF IN$DATA.DCHAR = ADDR(KP_MSG.TDATA) -> OUT$DATA.DCHAR THEN
      280     4194    3                     DO;
      281     4195    3                       KP_MSG.HEAD.MSG_TYPE = %KP_VERFD_RSP#;
      282     4196    3                       MSG_DSIZE = 0;
      283     4197    3                       END;
      284     4198    2                  GOTO GOOD_COMPLETION;
      285     4199        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:13   
      286     4200    2                CASE(%KP_READ_RQS#);
      287     4201    2                  KP_MSG.HEAD.MSG_TYPE = %KP_READ_RSP#;
      288     4202    2                  IF NOT KO_OPENED THEN
      289     4203    2                     GOTO NOT_OPENED;
      290     4204    2                  CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);
      291     4205    2                  CALL PERFORM_SEQUENCE(READ_LIST)
      292     4206    2                                    ALTRET(DEV_ERR);
      293     4207    3                  DO CASE(KP_MSG.HEAD.IOTYPE);
      294     4208    3                     CASE(1);              /* DIAGNOSTIC READ                    */
      295     4209    3                       CALL KOP$PHYS_IO(KO_CHANNEL,
      296     4210    3                                        %OP_EXDREAD#,,
      297     4211    3                                        KP_MSG.HEAD.DEV_STATUS)
      298     4212    3                                        ALTRET(DEV_ERR);
      299     4213    3                     CASE(2);              /* DELETED DATA                       */
      300     4214    3                       CALL KOP$PHYS_IO(KO_CHANNEL,
      301     4215    3                                        %OP_EXKREAD#,,
      302     4216    3                                        KP_MSG.HEAD.DEV_STATUS)
      303     4217    3                                        ALTRET(DEV_ERR);
      304     4218    3                     CASE(0);              /* NORMAL READ                        */
      305     4219    3                       CALL KOP$PHYS_IO(KO_CHANNEL,
      306     4220    3                                        %OP_EXREAD#,,
      307     4221    3                                        KP_MSG.HEAD.DEV_STATUS)
      308     4222    3                                        ALTRET(DEV_ERR);
      309     4223    3                     END;                  /* END CASE                           */
      310     4224    2                  GOTO GOOD_COMPLETION;
      311     4225        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:14   
      312     4226    2                CASE(%KP_CHECK_RQS#);
      313     4227    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CHECK_RSP#;
      314     4228    2                  MSG_DSIZE = SIZEC(KP_MSG.CHECK_RSP) - SIZEC(KP_MSG.CHECK_RSP.SPARE);
      315     4229    2                  KP_MSG.CHECK_RSP = '0'B;
      316     4230    3                  DO I = 0 TO TOP_DEVICE;
      317     4231    3                     KP_MSG.CHECK_RSP.DRIVE.NUMBER(I) = DEVICE_TABLE.DEV_ENTRY.DRIVE_NO
              4231                              (I);
      318     4232    3                     PACK = DEVICE_TABLE.DEV_ENTRY.DEVICE_TYPE(I);
      319     4233    3                     KP_MSG.CHECK_RSP.DRIVE.TYPE(I) = PACK_;
      320     4234    3                     PACK = DEVICE_TABLE.DEV_ENTRY.CHAN_ADDR(I) *64;
      321     4235    3                     KP_MSG.CHECK_RSP.DRIVE.CHAN(I) = PACK_;
      322     4236    3                     KP_MSG.CHECK_RSP.DRIVE.OPERATION_STATUS(I) = %E$KP_ALLOK;
      323     4237    3                     CALL KOP$GET_STATUS (
      324     4238    3                            DEVICE_TABLE.DEV_ENTRY.CHAN_ADDR(I),
      325     4239    3                            KP_MSG.CHECK_RSP.DRIVE.DEV_STATUS(I))
      326     4240    4                          WHENALTRETURN DO;
      327     4241    4                             KP_MSG.CHECK_RSP.DRIVE.OPERATION_STATUS(I) = %E$KP_DEV_ERR
              4241                                      ;
      328     4242    4                             END;
      329     4243    3                     END;
      330     4244    2                  KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;
      331     4245    2                  GOTO SENDIT;
      332     4246        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:15   
      333     4247    2                CASE(%KP_CLOSE_RQS#);
      334     4248    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CLOSE_RSP#;
      335     4249    2                  IF NOT KO_OPENED THEN
      336     4250    3                     DO;
      337     4251    3   NOT_OPENED:         ;
      338     4252    3                       KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DRIVE_NOT_OPEN;
      339     4253    3                       GOTO SEND_HEAD_ONLY;
      340     4254    3                       END;
      341     4255    2                  CALL KOP$GET_STATUS(KO_CHANNEL,KP_MSG.HEAD.DEV_STATUS) ALTRET(
              4255                           NO_CLS_STAT);
      342     4256    2   NO_CLS_STAT:   ;
      343     4257    2                  KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;
      344     4258    2                  KO_OPENED = '0'B;
      345     4259    2                  GOTO SEND_HEAD_ONLY;
      346     4260        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:16   
      347     4261    2                CASE(%KP_OPEN_RQS#);
      348     4262    2                  KP_MSG.HEAD.MSG_TYPE = %KP_OPEN_RSP#;
      349     4263    2                  CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);
      350     4264    2                  CALL KOP$INITIALIZE(KO_CHANNEL) ALTRET(CANT_INITIALIZE);
      351     4265    2                  CALL KOP$GET_STATUS(KO_CHANNEL,KP_MSG.HEAD.DEV_STATUS) ALTRET(
              4265                           CANT_INITIALIZE);
      352     4266    2                  KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;
      353     4267    2                  CALL KOP$CHECK_STATUS (KP_MSG.HEAD.DEV_STATUS)
      354     4268    3                     WHENALTRETURN DO;
      355     4269    3   CANT_INITIALIZE:     ;
      356     4270    3                        KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DEV_ERR;
      357     4271    3                        END;
      358     4272    2                  KO_OPENED = '1'B;
      359     4273    2                  GOTO SEND_HEAD_ONLY;
      360     4274        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:17   
      361     4275    2                CASE(%KP_DIE_RQS#);
      362     4276    2                  THINGS_ARE_ROSY = '0'B;
      363     4277    2                END;                       /* END DO CASE                        */
      364     4278    1             GOTO FINIS;
      365     4279        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:18   
      366     4280        /**/
      367     4281        /*  Various stubs used to terminate this operation.                           */
      368     4282        /**/
      369     4283    1   SEND_HEAD_ONLY: ;                       /* Send only the header               */
      370     4284    1             KP_MSG.HEAD.NUM_BYTES = '0'B;
      371     4285    1             MSG_DSIZE = 0;
      372     4286    1             GOTO SENDIT;
      373     4287        /**/
      374     4288    1   DEV_ERR:  ;                             /* Device I/O error                   */
      375     4289    1             KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DEV_ERR;
      376     4290    1             GOTO SEND_STATUS_ONLY;
      377     4291        /**/
      378     4292    1   GOOD_COMPLETION:  ;
      379     4293    1             KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;
      380     4294    1   SEND_STATUS:   ;                   /* Get/send status, variable data size*/
      381     4295    2             DO WHILE ('0'B);
      382     4296    2   SEND_STATUS_ONLY: ;
      383     4297    2                MSG_DSIZE = 0;
      384     4298    2                END;
      385     4299    1             CALL KOP$CHECK_STATUS (KP_MSG.HEAD.DEV_STATUS)
      386     4300    2                WHENALTRETURN DO;
      387     4301    2                   KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DEV_ERR;
      388     4302    2                   END;
      389     4303    1   SENDIT:   ;
      390     4304    1             CALL SEND_MSG ALTRET(TROUBLE);
      391     4305        /**/
      392     4306        /*  This request from the host is taken care of.  Reset the process by        */
      393     4307        /*  initiating another nowait read on the host.                               */
      394     4308        /**/
      395     4309    1   FINIS:    ;
      396     4310        /*N*      CALL KOH$HOST_IO (%KOH_NWREAD_HOST#) ALTRET(TROUBLE);               */
      397     4311        /**/
      398     4312    1             RETURN;
      399     4313        /**/
      400     4314    1   TROUBLE:  ;
      401     4315    1             ALTRETURN;
      402     4316        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:19   
      403     4317    1   SEND_MSG: PROC ALTRET;
      404     4318    2             KP_MSG.HEAD.RETRIES = DISK_RETRIES;
      405     4319    2             KP_MSG.HEAD.NUM_BYTES = MSG_DSIZE_;
      406     4320    2             HOST_MES_LEN = SIZEC(KP_MSG.HEAD) + MSG_DSIZE;
      407     4321    2             CALL KOH$HOST_IO(%KOH_WRITE_HOST#)
      408     4322    3                WHENALTRETURN DO; ALTRETURN; END;
      409     4323    2             RETURN;
      410     4324    2             END SEND_MSG;
      411     4325        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:20   
      412     4326    1   DO_VINIT: PROC ALTRET;
      413     4327    2             OUT_DISK_MES_LEN = NUM_SECTORS *4;
      414     4328    3             DO J = FIRST_SECTOR TO FIRST_SECTOR + NUM_SECTORS -1;
      415     4329    3                I = (J-FIRST_SECTOR) *4;   /* Make zero-based BYTE index         */
      416     4330    3                OUT$DATA.DUBIN (I+0) = DISK_TRACK_NO;
      417     4331    3                OUT$DATA.DUBIN (I+1) = DISK_SIDE;
      418     4332    3                OUT$DATA.DUBIN (I+2) = J;
      419     4333    3                OUT$DATA.DUBIN (I+3) = DISK_SEC_SIZE;
      420     4334    3                END;                   /* END DO J                           */
      421     4335    2             DISK_BUF$ = OUT_DISK_BUF$;
      422     4336    2             DISK_LEN = OUT_DISK_MES_LEN;
      423     4337    2             CALL PERFORM_SEQUENCE (VINIT_LIST)
      424     4338    2                                    ALTRET(OOPS);
      425     4339    2             RETURN;
      426     4340        /**/
      427     4341    2   OOPS:     ;
      428     4342    2             ALTRETURN;
      429     4343        /**/
      430     4344    2             END DO_VINIT;
      431     4345        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:21   
      432     4346    1   DO_WRITE: PROC ALTRET;
      433     4347    2             CALL PERFORM_SEQUENCE (WRITE_LIST)
      434     4348    2                                   ALTRET(OOPS);
      435     4349    2             RETURN;
      436     4350        /**/
      437     4351    2   OOPS:     ;
      438     4352    2             ALTRETURN;
      439     4353        /**/
      440     4354    2             END DO_WRITE;
      441     4355        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:22   
      442     4356    1   PICK_DRIVE: PROC ALTRET;
      443     4357        /**/
      444     4358        /*  This routine selects the drive with a drive number equal to KO_DRIVE.     */
      445     4359        /**/
      446     4360    3           DO I = 0 TO TOP_DEVICE;
      447     4361    3              IF DEVICE_TABLE.DEV_ENTRY.DRIVE_NO(I) = KP_MSG.HEAD.DRIVE_NO
      448     4362    3               THEN
      449     4363    4                 DO;
      450     4364    4                   KO_CHANNEL = DEVICE_TABLE.DEV_ENTRY.CHAN_ADDR(I);
      451     4365    4                   RETURN;
      452     4366    4                   END;
      453     4367    3              END;
      454     4368    2           KP_MSG.HEAD.OPERATION_STATUS = %E$KP_NO_DRIVE;
      455     4369    2           ALTRETURN;
      456     4370        /**/
      457     4371    2           END PICK_DRIVE;
      458     4372        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:23   
      459     4373    1   PERFORM_SEQUENCE: PROC(OP_LIST) ALTRET;
      460     4374    2   DCL OP_LIST(0:9) SBIN WORD ALIGNED PARAM;
      461     4375    2   DCL I SBIN WORD;
      462     4376    2           I = 0;
      463     4377    3           DO WHILE (OP_LIST(I) ~= %OP_NOTHING#);
      464     4378    3              CALL KOP$PHYS_IO(KO_CHANNEL,
      465     4379    3                               OP_LIST(I),,
      466     4380    3                               KP_MSG.HEAD.DEV_STATUS)
      467     4381    3                               ALTRET(OOPS);
      468     4382    3              I = I +1;
      469     4383    3              END;
      470     4384    2           RETURN;
      471     4385        /**/
      472     4386    2   OOPS:   ;
      473     4387    2           ALTRETURN;
      474     4388        /**/
      475     4389    2           END PERFORM_SEQUENCE;
      476     4390        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:24   
      477     4391    1   DO_VERFY:  PROC ALTRET;
      478     4392    2             CALL PERFORM_SEQUENCE (VERFY_LIST)
      479     4393    2                                   ALTRET(OOPS);
      480     4394    2             RETURN;
      481     4395        /**/
      482     4396    2   OOPS:     ;
      483     4397    2             ALTRETURN;
      484     4398        /**/
      485     4399    2             END DO_VERFY;
      486     4400        /**/
      487     4401    1             END KOE$HOST_EVENT;
      488     4402        %EOD;

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:25   
--  Include file information  --

   KP_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH_CHN.:E05TOU  is referenced.
   KP_MSG.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KO_SUBS.:E05TOU  is referenced.
   KO_MACRO_C.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KOE$HOST_EVENT.

   Procedure KOE$HOST_EVENT requires 1629 words for executable code.
   Procedure KOE$HOST_EVENT requires 30 words of local(AUTO) storage.

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:26   

 Object Unit name= KOE$HOST_EVENT                             File name= KOE$EVENT.:E05TOU
 UTS= JUL 30 '97 01:13:47.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$HOST
    1  RoData even  UTS     42     2A  KOE$HOST_EVENT
    2   Proc  even  none  1629    65D  KOE$HOST_EVENT
    3  RoData even  none     6      6  KOE$HOST_EVENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        0  KOE$HOST_EVENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KOP$CHECK_STATUS
 yes     yes           Std       2 KOP$INITIALIZE
 yes     yes           Std       4 KOP$PHYS_IO
 yes     yes           Std       2 KOP$GET_STATUS
 yes     yes           Std       1 KOH$HOST_IO
 yes     yes           Std       0 KOE$HOST_EVENT
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6C_ALRZ
                       nStd      0 X6C_ACM
                       nStd      0 X6A_ARET
                       nStd      0 X6A_AALT
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:27   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KO_CHANNEL                            KO_DRIVE                              KO_OPENED
     KH_CHNHI                              KH_CHNLOW                             HOST_MES_LEN
     HOST_BUF$                             DISK_LEN                              DISK_BUF$
     DISK_SECTOR_NO                        DISK_SEC_SIZE                         DISK_TRACK_NO
     DISK_SIDE                             DISK_RETRIES                          IN_DISK_MES_LEN
     IN_DISK_BUF$                          OUT_DISK_MES_LEN                      OUT_DISK_BUF$
     THINGS_ARE_ROSY                       DEVICE_TABLE                          TOP_DEVICE
     M$HOST                           r    G$ROS$
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:28   


        1        1        /*M* KOE$EVENT - Code to process events for PIGLET                            */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        KOE$HOST_EVENT: PROC ALTRET;

      7   2 000000  D380 0000 0000  xent KOE$HOST_EVENT  LNJ,B5   X6A_AUTO_0
          2 000003       001E 0000                       DC       30,0

        8        8        /**/
        9        9        /*  KOE$HOST_EVENT                                                            */
       10       10        /*   This routine is called when a host input event is detected.              */
       11       11        /**/
       12       12        /**/
       13       13        /*  INCLUDE FILES  */
       14       14        /**/
       15       15        %INCLUDE KO_DATA_R;
       16     3762        %INCLUDE KP_PERR_C;                     /* Error/status codes, FEP to host    */
       17     3827        /**/
       18     3828        /*  ENTRY DCLS  */
       19     3829        /**/
       20     3830        %KO_ENTRIES (OMIT=KOE$HOST_EVENT);
       21     3886        /**/
       22     3887        /*  AUTO  */
       23     3888        /**/
       24     3889    1   DCL I SBIN;
       25     3890    1   DCL MSG_DSIZE UBIN(16) UNAL;
       26     3891    1   DCL 1 MSG_DSIZE_ REDEF MSG_DSIZE,
       27     3892    1         2 HOB UBIN(8) UNAL,
       28     3893    1         2 LOB UBIN(8) UNAL;
       29     3894    1   DCL PACK UBIN(16) UNAL;
       30     3895    1   DCL 1 PACK_ REDEF PACK,
       31     3896    1         2 HOB UBIN(8) UNAL,
       32     3897    1         2 LOB UBIN(8) UNAL;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:29   
       33     3898        %KO_DEVICE_STATUS (NAME=STATUS,STCLASS="REDEF PACK");
       34     3948    1   DCL J SBIN WORD;
       35     3949    1   DCL NUM_SECTORS SBIN WORD;
       36     3950    1   DCL FIRST_SECTOR SBIN;
       37     3951    1   DCL CURR_TRACK SBIN WORD;
       38     3952    1   DCL CURR_SIDE SBIN WORD;
       39     3953    1   DCL LO_TRACK SBIN WORD;
       40     3954    1   DCL LO_SIDE SBIN WORD;
       41     3955        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:30   
       42     3956        /**/
       43     3957        /*  BASED  */
       44     3958        /**/
       45     3959    1   DCL 1 IN$DATA BASED(IN_DISK_BUF$) ALIGNED,
       46     3960    1         2 DUBIN(0:0) UBIN BYTE CALIGNED,
       47     3961    1         2 DCHAR REDEF DUBIN CHAR(IN_DISK_MES_LEN) CALIGNED;
       48     3962    1   DCL 1 OUT$DATA BASED(OUT_DISK_BUF$) ALIGNED,
       49     3963    1         2 DUBIN(0:0) UBIN BYTE CALIGNED,
       50     3964    1         2 DCHAR REDEF DUBIN CHAR(OUT_DISK_MES_LEN) CALIGNED;
       51     3965    1   DCL TEST_DATA$$ EPTR CONSTANT INIT(ENTADDR(KOE$HOST_EVENT));
       52     3966    1   DCL TEST_DATA$ REDEF TEST_DATA$$ PTR;
       53     3967    1   DCL 1 TEST$DATA BASED(TEST_DATA$) ALIGNED,
       54     3968    1         2 DCHAR CHAR(OUT_DISK_MES_LEN);
       55     3969        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:31   
       56     3970        /**/
       57     3971        /*  CONSTANT  */
       58     3972        /**/
       59     3973    1   DCL READ_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       60     3974    1               %OP_SETSEC#,
       61     3975    1               %OP_SETTRKSID#,
       62     3976    1               %OP_SEEK#,
       63     3977    1               %OP_SETIRANGEADDR#,
       64     3978    1               %OP_NOTHING#,0,0,0,0,0);
       65     3979    1   DCL VINIT_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       66     3980    1               %OP_SETSEC#,
       67     3981    1               %OP_SETTRKSID#,
       68     3982    1               %OP_SEEK#,
       69     3983    1               %OP_SETORANGEADDR#,
       70     3984    1               %OP_EXVINIT#,
       71     3985    1               %OP_NOTHING#,0,0,0,0);
       72     3986    1   DCL WRITE_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       73     3987    1               %OP_SETSEC#,
       74     3988    1               %OP_SETTRKSID#,
       75     3989    1               %OP_SEEK#,
       76     3990    1               %OP_SETORANGEADDR#,
       77     3991    1               %OP_EXWRITE#,
       78     3992    1               %OP_NOTHING#,0,0,0,0);
       79     3993    1   DCL VERFY_LIST(0:9) SBIN WORD ALIGNED CONSTANT INIT(
       80     3994    1               %OP_SETSEC#,
       81     3995    1               %OP_SETTRKSID#,
       82     3996    1               %OP_SEEK#,
       83     3997    1               %OP_SETIRANGEADDR#,
       84     3998    1               %OP_EXVERIFY#,
       85     3999    1               %OP_NOTHING#,0,0,0,0);
       86     4000        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:32   
       87     4001    1             DISK_RETRIES = 0;

   4001   2 000005  8700 0000 0000  xsym                 CL       DISK_RETRIES

       88     4002        /**/
       89     4003        /*  Almost everyone uses the data in the message itself for an I/O            */
       90     4004        /*  buffer.  Set up parameters accordingly.                                   */
       91     4005        /**/
       92     4006    1             MSG_DSIZE_ = KP_MSG.HEAD.NUM_BYTES;

   4006   2 000008  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00000B  E846 0003                            LDR,R6   3,B6
          2 00000D  EF47 0005                            STR,R6   MSG_DSIZE,AUTO

       93     4007    1             DISK_LEN = MSG_DSIZE;

   4007   2 00000F  D847 0005                            LDR,R5   MSG_DSIZE,AUTO
          2 000011  DF00 0000 0000  xsym                 STR,R5   DISK_LEN

       94     4008    1             DISK_BUF$ = ADDR(KP_MSG.TDATA);

   4008   2 000014  DBC6 0009                            LAB,B5   9,B6
          2 000016  DF80 0000 0000  xsym                 STB,B5   DISK_BUF$

       95     4009        /**/
       96     4010        /*  Almost everyone uses the drive in the message head.  */
       97     4011        /**/
       98     4012    1             KO_DRIVE = KP_MSG.HEAD.DRIVE_NO;

   4012   2 000019  C806                                 LDR,R4   ,B6
          2 00001A  C570 00FF                            AND,R4   255,IMO
          2 00001C  CF00 0000 0000  xsym                 STR,R4   KO_DRIVE

       99     4013        /**/
      100     4014        /*  Set up default physical I/O parameters.  */
      101     4015        /**/
      102     4016    1             DISK_SECTOR_NO = KP_MSG.HEAD.SECTOR_NO;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:33   

   4016   2 00001F  B2C6 0005                            LLH,R3   5,B6
          2 000021  BF00 0000 0000  xsym                 STR,R3   DISK_SECTOR_NO

      103     4017    1             DISK_SEC_SIZE = KP_MSG.HEAD.SEC_SIZE;

   4017   2 000024  A846 0005                            LDR,R2   5,B6
          2 000026  A570 00FF                            AND,R2   255,IMO
          2 000028  AF00 0000 0000  xsym                 STR,R2   DISK_SEC_SIZE

      104     4018    1             DISK_TRACK_NO = KP_MSG.HEAD.TRACK_NO;

   4018   2 00002B  9846 0004                            LDR,R1   4,B6
          2 00002D  9570 00FF                            AND,R1   255,IMO
          2 00002F  9F00 0000 0000  xsym                 STR,R1   DISK_TRACK_NO

      105     4019    1             DISK_SIDE = KP_MSG.HEAD.SIDE;

   4019   2 000032  E2C6 0004                            LLH,R6   4,B6
          2 000034  EF00 0000 0000  xsym                 STR,R6   DISK_SIDE

      106     4020    1             KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;

   4020   2 000037  E870 00C8                            LDR,R6   200,IMO
          2 000039  EAC6 0001                            SRM,R6,'00FF'X    1,B6
          2 00003B       00FF

      107     4021        /**/
      108     4022        /*  Do the requested command.                                                 */
      109     4023        /**/
      110     4024    2             DO CASE(KP_MSG.HEAD.MSG_TYPE);

   4024   2 00003C  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00003F  B286                                 LLH,R3   ,B6
          2 000040  3D16                                 CMV,R3   22
          2 000041  0281 04C5                            BGE      s:4278,PREL
          2 000043  A830 0000 0049  02                   LDR,R2   s:4024+13,R3
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:34   
          2 000046  83A0 0000 005F  02                   JMP      s:4027,R2
          2 000049       04A8                            DC       s:4278,PREL
          2 00004A       0000                            DC       s:4027,PREL
          2 00004B       02F1                            DC       s:4184,PREL
          2 00004C       032C                            DC       s:4201,PREL
          2 00004D       045C                            DC       s:4262,PREL
          2 00004E       042A                            DC       s:4248,PREL
          2 00004F       04A8                            DC       s:4278,PREL
          2 000050       04A5                            DC       s:4276,PREL
          2 000051       04A8                            DC       s:4278,PREL
          2 000052       04A8                            DC       s:4278,PREL
          2 000053       006D                            DC       s:4047,PREL
          2 000054       04A8                            DC       s:4278,PREL
          2 000055       04A8                            DC       s:4278,PREL
          2 000056       04A8                            DC       s:4278,PREL
          2 000057       04A8                            DC       s:4278,PREL
          2 000058       04A8                            DC       s:4278,PREL
          2 000059       04A8                            DC       s:4278,PREL
          2 00005A       03A3                            DC       s:4227,PREL
          2 00005B       04A8                            DC       s:4278,PREL
          2 00005C       01AA                            DC       s:4113,PREL
          2 00005D       04A8                            DC       s:4278,PREL
          2 00005E       0108                            DC       s:4085,PREL

      111     4025        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:35   
      112     4026    2                CASE(%KP_VINIT_RQS#);

      113     4027    2                  KP_MSG.HEAD.MSG_TYPE = %KP_VINIT_STT#;

   4027   2 00005F  6C18                                 LDV,R6   24
          2 000060  E786                                 STH,R6   ,B6

      114     4028    2                  MSG_DSIZE = 0;           /* Response has no data area          */

   4028   2 000061  8747 0005                            CL       MSG_DSIZE,AUTO

      115     4029    2                  IF NOT KO_OPENED THEN

   4029   2 000063  8980 0000 0000  xsym                 CMZ      KO_OPENED
          2 000066  0881 0429                            BAGE     s:4250,PREL

      116     4030    2                     GOTO NOT_OPENED;
      117     4031    2                  FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;

   4031   2 000068  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00006B  D2C6 0005                            LLH,R5   5,B6
          2 00006D  DF47 0009                            STR,R5   FIRST_SECTOR,AUTO

      118     4032    2                  NUM_SECTORS = KP_MSG.CRTFY_RQS.SECTOR_HI - FIRST_SECTOR +1;

   4032   2 00006F  C2C6 0009                            LLH,R4   9,B6
          2 000071  C255                                 SUB,R4   R5
          2 000072  4E01                                 ADV,R4   1
          2 000073  CF47 0008                            STR,R4   NUM_SECTORS,AUTO

      119     4033    3                  DO DISK_TRACK_NO = DISK_TRACK_NO TO KP_MSG.VINIT_RQS.TRACK_HI;

   4033   2 000075  B800 0000 0000  xsym                 LDR,R3   DISK_TRACK_NO
          2 000078  BF00 0000 0000  xsym                 STR,R3   DISK_TRACK_NO
          2 00007B  0F81 0040                            B        s:4042+3,PREL

      120     4034    4                     DO DISK_SIDE = KP_MSG.HEAD.SIDE TO KP_MSG.VINIT_RQS.SIDE_HI;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:36   

   4034   2 00007D  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000080  E2C6 0004                            LLH,R6   4,B6
          2 000082  EF00 0000 0000  xsym                 STR,R6   DISK_SIDE
          2 000085  0F81 0027                            B        s:4040+3,PREL

      121     4035    4                        KP_MSG.HEAD.TRACK_NO = DISK_TRACK_NO; /* For status info */

   4035   2 000087  E800 0000 0000  xsym                 LDR,R6   DISK_TRACK_NO
          2 00008A  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00008D  EAC6 0004                            SRM,R6,'00FF'X    4,B6
          2 00008F       00FF

      122     4036    4                        CALL DO_VINIT ALTRET(SEND_STATUS_ONLY);

   4036   2 000090  E3C0 04E0                            LNJ,B6   s:0,PREL
          2 000092       0494                            DC       s:4284,PREL

      123     4037    4                        DISK_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;

   4037   2 000093  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000096  E846 0005                            LDR,R6   5,B6
          2 000098  E570 00FF                            AND,R6   255,IMO
          2 00009A  6E01                                 ADV,R6   1
          2 00009B  EB47 0008                            MUL,R6   NUM_SECTORS,AUTO
          2 00009D  6007                                 SOL,R6   7
          2 00009E  EF00 0000 0000  xsym                 STR,R6   DISK_LEN

      124     4038    4                        DISK_BUF$ = OUT_DISK_BUF$;

   4038   2 0000A1  DC80 0000 0000  xsym                 LDB,B5   OUT_DISK_BUF$
          2 0000A4  DF80 0000 0000  xsym                 STB,B5   DISK_BUF$

      125     4039    4                        CALL DO_VERFY ALTRET(SEND_STATUS_ONLY);

   4039   2 0000A7  E3C0 05A3                            LNJ,B6   s:0,PREL
          2 0000A9       047D                            DC       s:4284,PREL
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:37   

      126     4040    4                        END;               /* END CURR_SIDE                      */

   4040   2 0000AA  8A80 0000 0000  xsym                 INC      DISK_SIDE
          2 0000AD  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0000B0  E2C6 000A                            LLH,R6   10,B6
          2 0000B2  E900 0000 0000  xsym                 CMR,R6   DISK_SIDE
          2 0000B5  08D2                                 BAGE     s:4035,SPREL

      127     4041    3                     CALL SEND_MSG;

   4041   2 0000B6  E3C0 0493                            LNJ,B6   s:0,PREL
          2 0000B8       0001                            DC       s:4042,PREL

      128     4042    3                     END;                  /* END CURR_TRACK                     */

   4042   2 0000B9  8A80 0000 0000  xsym                 INC      DISK_TRACK_NO
          2 0000BC  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0000BF  E846 0009                            LDR,R6   9,B6
          2 0000C1  E570 00FF                            AND,R6   255,IMO
          2 0000C3  E900 0000 0000  xsym                 CMR,R6   DISK_TRACK_NO
          2 0000C6  0881 FFB6                            BAGE     s:4034,PREL

      129     4043    2                  KP_MSG.HEAD.MSG_TYPE = %KP_VINIT_RSP#;

   4043   2 0000C8  5C0D                                 LDV,R5   13
          2 0000C9  D786                                 STH,R5   ,B6

      130     4044    2                  GOTO GOOD_COMPLETION;

   4044   2 0000CA  0F81 0451                            B        s:4289,PREL

      131     4045        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:38   
      132     4046    2                CASE(%KP_CERTIFY_RQS#);

      133     4047    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CERTIFY_RSP#;

   4047   2 0000CC  6C0B                                 LDV,R6   11
          2 0000CD  E786                                 STH,R6   ,B6

      134     4048    2                  MSG_DSIZE = SIZEC(KP_MSG.CRTFY_RSP) - SIZEC(KP_MSG.CRTFY_RSP.SPARE);

   4048   2 0000CE  5C04                                 LDV,R5   4
          2 0000CF  DF47 0005                            STR,R5   MSG_DSIZE,AUTO

      135     4049    2                  KP_MSG.CRTFY_RSP = '0'B;

   4049   2 0000D1  AB80 0000 0000  03                   LAB,B2   0
          2 0000D4  2C00                                 LDV,R2   0
          2 0000D5  6C01                                 LDV,R6   1
          2 0000D6  BC80 0000 0000  xsym                 LDB,B3   HOST_BUF$
          2 0000D9  3C12                                 LDV,R3   18
          2 0000DA  F870 0800                            LDR,R7   2048,IMO
          2 0000DC  D380 0000 0000  xent                 LNJ,B5   X6C_ALRZ

      136     4050    2                  IF NOT KO_OPENED THEN

   4050   2 0000DF  8980 0000 0000  xsym                 CMZ      KO_OPENED
          2 0000E2  0881 03AD                            BAGE     s:4250,PREL

      137     4051    2                     GOTO NOT_OPENED;
      138     4052        /* VOLINIT THE TRACK */
      139     4053    2                  FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;

   4053   2 0000E4  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0000E7  E2C6 0005                            LLH,R6   5,B6
          2 0000E9  EF47 0009                            STR,R6   FIRST_SECTOR,AUTO

      140     4054    2                  NUM_SECTORS = KP_MSG.CRTFY_RQS.SECTOR_HI - FIRST_SECTOR +1;

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:39   
   4054   2 0000EB  D2C6 0009                            LLH,R5   9,B6
          2 0000ED  D256                                 SUB,R5   R6
          2 0000EE  5E01                                 ADV,R5   1
          2 0000EF  DF47 0008                            STR,R5   NUM_SECTORS,AUTO

      141     4055    2                  CALL DO_VINIT ALTRET(CERTERR_V);

   4055   2 0000F1  E3C0 047F                            LNJ,B6   s:0,PREL
          2 0000F3       0072                            DC       s:4077,PREL

      142     4056    2                  KP_MSG.CRTFY_RSP.VINIT_RETRIES = DISK_RETRIES;

   4056   2 0000F4  E800 0000 0000  xsym                 LDR,R6   DISK_RETRIES
          2 0000F7  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0000FA  E7C6 0009                            STH,R6   9,B6

      143     4057    2                  DISK_RETRIES = 0;

   4057   2 0000FC  8700 0000 0000  xsym                 CL       DISK_RETRIES

      144     4058        /* WRITE TEST DATA */
      145     4059    2                  OUT_DISK_MES_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;

   4059   2 0000FF  E846 0005                            LDR,R6   5,B6
          2 000101  E570 00FF                            AND,R6   255,IMO
          2 000103  6E01                                 ADV,R6   1
          2 000104  EB47 0008                            MUL,R6   NUM_SECTORS,AUTO
          2 000106  6007                                 SOL,R6   7
          2 000107  EF00 0000 0000  xsym                 STR,R6   OUT_DISK_MES_LEN

      146     4060    2                  DISK_BUF$ = TEST_DATA$;

   4060   2 00010A  DC80 0000 0000  01                   LDB,B5   TEST_DATA$$
          2 00010D  DF80 0000 0000  xsym                 STB,B5   DISK_BUF$

      147     4061    2                  DISK_LEN = OUT_DISK_MES_LEN;

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:40   
   4061   2 000110  EF00 0000 0000  xsym                 STR,R6   DISK_LEN

      148     4062    2                  CALL DO_WRITE ALTRET(CERTERR_W);

   4062   2 000113  E3C0 04B8                            LNJ,B6   s:0,PREL
          2 000115       0050                            DC       s:4077,PREL

      149     4063    2                  KP_MSG.CRTFY_RSP.WRITE_RETRIES = DISK_RETRIES;

   4063   2 000116  E800 0000 0000  xsym                 LDR,R6   DISK_RETRIES
          2 000119  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00011C  EAC6 0009                            SRM,R6,'00FF'X    9,B6
          2 00011E       00FF

      150     4064    2                  DISK_RETRIES = 0;

   4064   2 00011F  8700 0000 0000  xsym                 CL       DISK_RETRIES

      151     4065        /* READ TEST DATA */
      152     4066    2                  IN_DISK_MES_LEN = OUT_DISK_MES_LEN;

   4066   2 000122  E800 0000 0000  xsym                 LDR,R6   OUT_DISK_MES_LEN
          2 000125  EF00 0000 0000  xsym                 STR,R6   IN_DISK_MES_LEN

      153     4067    2                  DISK_BUF$ = OUT_DISK_BUF$;

   4067   2 000128  DC80 0000 0000  xsym                 LDB,B5   OUT_DISK_BUF$
          2 00012B  DF80 0000 0000  xsym                 STB,B5   DISK_BUF$

      154     4068    2                  DISK_LEN = IN_DISK_MES_LEN;

   4068   2 00012E  EF00 0000 0000  xsym                 STR,R6   DISK_LEN

      155     4069    3                  DO I = 1 TO 100;

   4069   2 000131  5C01                                 LDV,R5   1
          2 000132  DF47 0004                            STR,R5   I,AUTO
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:41   

      156     4070    3                     CALL DO_VERFY ALTRET(CERTERR_R);

   4070   2 000134  E3C0 0516                            LNJ,B6   s:0,PREL
          2 000136       002F                            DC       s:4077,PREL

      157     4071    3                     IF TEST$DATA.DCHAR ~= OUT$DATA.DCHAR THEN

   4071   2 000137  AC80 0000 0000  01                   LDB,B2   TEST_DATA$$
          2 00013A  2C00                                 LDV,R2   0
          2 00013B  E800 0000 0000  xsym                 LDR,R6   OUT_DISK_MES_LEN
          2 00013E  BC80 0000 0000  xsym                 LDB,B3   OUT_DISK_BUF$
          2 000141  3C00                                 LDV,R3   0
          2 000142  F856                                 LDR,R7   R6
          2 000143  D380 0000 0000  xent                 LNJ,B5   X6C_ACM
          2 000146  5381 000B                            CBE      s:4075,PREL

      158     4072    4                        DO;

      159     4073    4                          KP_MSG.CRTFY_RSP.READ_DATA_ERRORS = DISK_RETRIES +1;

   4073   2 000148  E800 0000 0000  xsym                 LDR,R6   DISK_RETRIES
          2 00014B  6E01                                 ADV,R6   1
          2 00014C  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00014F  EAC6 000A                            SRM,R6,'00FF'X    10,B6
          2 000151       00FF

      160     4074    4                          END;

      161     4075    3                     END;                  /* END DO I                           */

   4075   2 000152  8AC7 0004                            INC      I,AUTO
          2 000154  E847 0004                            LDR,R6   I,AUTO
          2 000156  6D64                                 CMV,R6   100
          2 000157  0ADD                                 BALE     s:4070,SPREL

      162     4076    2                  KP_MSG.CRTFY_RSP.READ_RETRIES = DISK_RETRIES;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:42   

   4076   2 000158  D800 0000 0000  xsym                 LDR,R5   DISK_RETRIES
          2 00015B  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00015E  D7C6 000A                            STH,R5   10,B6

      163     4077    2                  DISK_RETRIES = 0;

   4077   2 000160  8700 0000 0000  xsym                 CL       DISK_RETRIES

      164     4078    2                  GOTO GOOD_COMPLETION;

   4078   2 000163  0F81 03B8                            B        s:4289,PREL

   4077   2                              CERTERR_V       null
   4077   2                              CERTERR_W       null
   4077   2                              CERTERR_R       null
      165     4079    2   CERTERR_V:     ;
      166     4080    2   CERTERR_W:     ;
      167     4081    2   CERTERR_R:     ;
      168     4082    2                  GOTO DEV_ERR;

   4082   2 000165  0F81 03AC            CERTERR_R       B        s:4285,PREL

      169     4083        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:43   
      170     4084    2                CASE(%KP_CLONE_RQS#);

      171     4085    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CLONE_STT#;

   4085   2 000167  6C17                                 LDV,R6   23
          2 000168  E786                                 STH,R6   ,B6

      172     4086    2                  MSG_DSIZE = 0;

   4086   2 000169  8747 0005                            CL       MSG_DSIZE,AUTO

      173     4087    2                  IF NOT KO_OPENED THEN

   4087   2 00016B  8980 0000 0000  xsym                 CMZ      KO_OPENED
          2 00016E  0881 0321                            BAGE     s:4250,PREL

      174     4088    2                     GOTO NOT_OPENED;
      175     4089    2                  FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;

   4089   2 000170  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000173  D2C6 0005                            LLH,R5   5,B6
          2 000175  DF47 0009                            STR,R5   FIRST_SECTOR,AUTO

      176     4090    2                  NUM_SECTORS = KP_MSG.CLONE_RQS.SECTOR_HI - FIRST_SECTOR +1;

   4090   2 000177  C2C6 0009                            LLH,R4   9,B6
          2 000179  C255                                 SUB,R4   R5
          2 00017A  4E01                                 ADV,R4   1
          2 00017B  CF47 0008                            STR,R4   NUM_SECTORS,AUTO

      177     4091    2                  DISK_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;

   4091   2 00017D  B846 0005                            LDR,R3   5,B6
          2 00017F  B570 00FF                            AND,R3   255,IMO
          2 000181  3E01                                 ADV,R3   1
          2 000182  BB54                                 MUL,R3   R4
          2 000183  3007                                 SOL,R3   7
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:44   
          2 000184  BF00 0000 0000  xsym                 STR,R3   DISK_LEN

      178     4092    2                  DISK_BUF$ = OUT_DISK_BUF$;

   4092   2 000187  DC80 0000 0000  xsym                 LDB,B5   OUT_DISK_BUF$
          2 00018A  DF80 0000 0000  xsym                 STB,B5   DISK_BUF$

      179     4093    3                  DO DISK_TRACK_NO = DISK_TRACK_NO TO KP_MSG.CLONE_RQS.TRACK_HI;

   4093   2 00018D  A800 0000 0000  xsym                 LDR,R2   DISK_TRACK_NO
          2 000190  AF00 0000 0000  xsym                 STR,R2   DISK_TRACK_NO
          2 000193  0F81 0067                            B        s:4108+3,PREL

      180     4094    4                     DO DISK_SIDE = KP_MSG.HEAD.SIDE TO KP_MSG.CLONE_RQS.SIDE_HI;

   4094   2 000195  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000198  E2C6 0004                            LLH,R6   4,B6
          2 00019A  EF00 0000 0000  xsym                 STR,R6   DISK_SIDE
          2 00019D  0F81 004B                            B        s:4106+3,PREL

      181     4095    4                        KP_MSG.HEAD.TRACK_NO = DISK_TRACK_NO;

   4095   2 00019F  E800 0000 0000  xsym                 LDR,R6   DISK_TRACK_NO
          2 0001A2  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0001A5  EAC6 0004                            SRM,R6,'00FF'X    4,B6
          2 0001A7       00FF

      182     4096    4                        KO_DRIVE = KP_MSG.HEAD.DRIVE_NO;

   4096   2 0001A8  D806                                 LDR,R5   ,B6
          2 0001A9  D570 00FF                            AND,R5   255,IMO
          2 0001AB  DF00 0000 0000  xsym                 STR,R5   KO_DRIVE

      183     4097    4                        CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);

   4097   2 0001AE  E3C0 042F                            LNJ,B6   s:0,PREL
          2 0001B0       0359                            DC       s:4277,PREL
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:45   

      184     4098    4                        CALL PERFORM_SEQUENCE (READ_LIST) ALTRET(DEV_ERR);

   4098   2 0001B1  EB80 0000 0002  01                   LAB,B6   READ_LIST
          2 0001B4  EFC7 0012                            STB,B6   LO_SIDE+5,AUTO
          2 0001B6  E3C0 0459                            LNJ,B6   s:0,PREL
          2 0001B8       035A                            DC       s:4285,PREL

      185     4099    4                        CALL KOP$PHYS_IO(KO_CHANNEL,

   4099   2 0001B9  EBF0 0006                            LAB,B6   6,IMO
          2 0001BB  DC80 0000 0000  xsym                 LDB,B5   HOST_BUF$
          2 0001BE  CBC5 0002                            LAB,B4   2,B5
          2 0001C0  CFC7 001C                            STB,B4   I+8,AUTO
          2 0001C2  BB80 0000 0000                       LAB,B3   0
          2 0001C5  BFC7 001A                            STB,B3   I+6,AUTO
          2 0001C7  EFC7 0018                            STB,B6   I+4,AUTO
          2 0001C9  AB80 0000 0000  xsym                 LAB,B2   KO_CHANNEL
          2 0001CC  AFC7 0016                            STB,B2   I+2,AUTO
          2 0001CE  BBC7 0016                            LAB,B3   I+2,AUTO
          2 0001D0  CBF0 0400                            LAB,B4   1024,IMO
          2 0001D2  E380 0000 0000  xent                 LNJ,B6   KOP$PHYS_IO
          2 0001D5       033D                            DC       s:4285,PREL

      186     4100    4                                         %OP_EXREAD#,,
      187     4101    4                                         KP_MSG.HEAD.DEV_STATUS)
      188     4102    4                                         ALTRET(DEV_ERR);
      189     4103    4                        KO_DRIVE = KP_MSG.CLONE_RQS.DEST_DRIVE;

   4103   2 0001D6  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0001D9  E846 000A                            LDR,R6   10,B6
          2 0001DB  E570 00FF                            AND,R6   255,IMO
          2 0001DD  EF00 0000 0000  xsym                 STR,R6   KO_DRIVE

      190     4104    4                        CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);

   4104   2 0001E0  E3C0 03FD                            LNJ,B6   s:0,PREL
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:46   
          2 0001E2       0327                            DC       s:4277,PREL

      191     4105    4                        CALL DO_WRITE ALTRET(DEV_ERR);

   4105   2 0001E3  E3C0 03E8                            LNJ,B6   s:0,PREL
          2 0001E5       032D                            DC       s:4285,PREL

      192     4106    4                        END;                  /* END DISK_SIDE                      */

   4106   2 0001E6  8A80 0000 0000  xsym                 INC      DISK_SIDE
          2 0001E9  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0001EC  E846 0009                            LDR,R6   9,B6
          2 0001EE  E570 00FF                            AND,R6   255,IMO
          2 0001F0  E900 0000 0000  xsym                 CMR,R6   DISK_SIDE
          2 0001F3  0881 FFAB                            BAGE     s:4095,PREL

      193     4107    3                     CALL SEND_MSG;

   4107   2 0001F5  E3C0 0354                            LNJ,B6   s:0,PREL
          2 0001F7       0001                            DC       s:4108,PREL

      194     4108    3                     END;                  /* END DISK_TRACK_NO                  */

   4108   2 0001F8  8A80 0000 0000  xsym                 INC      DISK_TRACK_NO
          2 0001FB  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0001FE  E2C6 000A                            LLH,R6   10,B6
          2 000200  E900 0000 0000  xsym                 CMR,R6   DISK_TRACK_NO
          2 000203  0881 FF91                            BAGE     s:4094,PREL

      195     4109    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CLONE_RSP#;

   4109   2 000205  5C16                                 LDV,R5   22
          2 000206  D786                                 STH,R5   ,B6

      196     4110    2                  GOTO GOOD_COMPLETION;

   4110   2 000207  0F81 0314                            B        s:4289,PREL
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:47   

      197     4111        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:48   
      198     4112    2                CASE(%KP_CER2_RQS#);

      199     4113    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CER2_RSP#;

   4113   2 000209  6C14                                 LDV,R6   20
          2 00020A  E786                                 STH,R6   ,B6

      200     4114    2                  MSG_DSIZE = SIZEC(KP_MSG.CER2_RSP) - SIZEC(KP_MSG.CER2_RSP.SPARE);

   4114   2 00020B  5C02                                 LDV,R5   2
          2 00020C  DF47 0005                            STR,R5   MSG_DSIZE,AUTO

      201     4115    2                  KP_MSG.CER2_RSP = '0'B;

   4115   2 00020E  AB80 0000 0000  03                   LAB,B2   0
          2 000211  2C00                                 LDV,R2   0
          2 000212  6C01                                 LDV,R6   1
          2 000213  BC80 0000 0000  xsym                 LDB,B3   HOST_BUF$
          2 000216  3C12                                 LDV,R3   18
          2 000217  F870 0800                            LDR,R7   2048,IMO
          2 000219  D380 0000 0000  xent                 LNJ,B5   X6C_ALRZ

      202     4116    2                  IF NOT KO_OPENED THEN

   4116   2 00021C  8980 0000 0000  xsym                 CMZ      KO_OPENED
          2 00021F  0881 0270                            BAGE     s:4250,PREL

      203     4117    2                     GOTO NOT_OPENED;
      204     4118    2                  LO_TRACK = KP_MSG.HEAD.TRACK_NO;

   4118   2 000221  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000224  E846 0004                            LDR,R6   4,B6
          2 000226  E570 00FF                            AND,R6   255,IMO
          2 000228  EF47 000C                            STR,R6   LO_TRACK,AUTO

      205     4119    2                  LO_SIDE = KP_MSG.HEAD.SIDE;

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:49   
   4119   2 00022A  D2C6 0004                            LLH,R5   4,B6
          2 00022C  DF47 000D                            STR,R5   LO_SIDE,AUTO

      206     4120        /* TEXT FOR CROSSTALK BY WRITING EACH TRACK IN SEQUENCE, AND THEN READING.    */
      207     4121    3                  DO DISK_SIDE = LO_SIDE TO KP_MSG.CER2_RQS.SIDE_HI;

   4121   2 00022E  DF00 0000 0000  xsym                 STR,R5   DISK_SIDE
          2 000231  0F81 0081                            B        s:4145+3,PREL

      208     4122    4                     DO DISK_TRACK_NO = LO_TRACK TO KP_MSG.CER2_RQS.TRACK_HI;

   4122   2 000233  E847 000C                            LDR,R6   LO_TRACK,AUTO
          2 000235  EF00 0000 0000  xsym                 STR,R6   DISK_TRACK_NO
          2 000238  0F81 002E                            B        s:4132+3,PREL

      209     4123                             /* VOLINIT THE TRACK */
      210     4124    4                        FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;

   4124   2 00023A  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00023D  E2C6 0005                            LLH,R6   5,B6
          2 00023F  EF47 0009                            STR,R6   FIRST_SECTOR,AUTO

      211     4125    4                        NUM_SECTORS = KP_MSG.CER2_RQS.SECTOR_HI - FIRST_SECTOR +1;

   4125   2 000241  D2C6 0009                            LLH,R5   9,B6
          2 000243  D256                                 SUB,R5   R6
          2 000244  5E01                                 ADV,R5   1
          2 000245  DF47 0008                            STR,R5   NUM_SECTORS,AUTO

      212     4126    4                        CALL DO_VINIT ALTRET(UNINTENTIONAL);

   4126   2 000247  E3C0 0329                            LNJ,B6   s:0,PREL
          2 000249       0105                            DC       s:4179,PREL

      213     4127                             /* WRITE TEST DATA */
      214     4128    4                        OUT_DISK_MES_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) *
              4128                                 128;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:50   

   4128   2 00024A  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00024D  E846 0005                            LDR,R6   5,B6
          2 00024F  E570 00FF                            AND,R6   255,IMO
          2 000251  6E01                                 ADV,R6   1
          2 000252  EB47 0008                            MUL,R6   NUM_SECTORS,AUTO
          2 000254  6007                                 SOL,R6   7
          2 000255  EF00 0000 0000  xsym                 STR,R6   OUT_DISK_MES_LEN

      215     4129    4                        DISK_BUF$ = TEST_DATA$;

   4129   2 000258  DC80 0000 0000  01                   LDB,B5   TEST_DATA$$
          2 00025B  DF80 0000 0000  xsym                 STB,B5   DISK_BUF$

      216     4130    4                        DISK_LEN = OUT_DISK_MES_LEN;

   4130   2 00025E  EF00 0000 0000  xsym                 STR,R6   DISK_LEN

      217     4131    4                        CALL DO_WRITE ALTRET(FROBOZZ);

   4131   2 000261  E3C0 036A                            LNJ,B6   s:0,PREL
          2 000263       0037                            DC       s:4140,PREL

      218     4132    4                        END;               /* END DISK_TRACK_NO                     */

   4132   2 000264  8A80 0000 0000  xsym                 INC      DISK_TRACK_NO
          2 000267  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00026A  E2C6 000A                            LLH,R6   10,B6
          2 00026C  E900 0000 0000  xsym                 CMR,R6   DISK_TRACK_NO
          2 00026F  08CB                                 BAGE     s:4124,SPREL

      219     4133    4                     DO DISK_TRACK_NO = LO_TRACK TO KP_MSG.CER2_RQS.TRACK_HI;

   4133   2 000270  D847 000C                            LDR,R5   LO_TRACK,AUTO
          2 000272  DF00 0000 0000  xsym                 STR,R5   DISK_TRACK_NO
          2 000275  0F81 0031                            B        s:4144+3,PREL

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:51   
      220     4134                             /* READ TEST DATA */
      221     4135    4                        IN_DISK_MES_LEN = OUT_DISK_MES_LEN;

   4135   2 000277  E800 0000 0000  xsym                 LDR,R6   OUT_DISK_MES_LEN
          2 00027A  EF00 0000 0000  xsym                 STR,R6   IN_DISK_MES_LEN

      222     4136    4                        DISK_BUF$ = OUT_DISK_BUF$;

   4136   2 00027D  EC80 0000 0000  xsym                 LDB,B6   OUT_DISK_BUF$
          2 000280  EF80 0000 0000  xsym                 STB,B6   DISK_BUF$

      223     4137    4                        DISK_LEN = IN_DISK_MES_LEN;

   4137   2 000283  EF00 0000 0000  xsym                 STR,R6   DISK_LEN

      224     4138    4                        CALL DO_VERFY ALTRET(FROBOZZ);

   4138   2 000286  E3C0 03C4                            LNJ,B6   s:0,PREL
          2 000288       0012                            DC       s:4140,PREL

      225     4139    4                        IF TEST$DATA.DCHAR ~= OUT$DATA.DCHAR THEN

   4139   2 000289  AC80 0000 0000  01                   LDB,B2   TEST_DATA$$
          2 00028C  2C00                                 LDV,R2   0
          2 00028D  E800 0000 0000  xsym                 LDR,R6   OUT_DISK_MES_LEN
          2 000290  BC80 0000 0000  xsym                 LDB,B3   OUT_DISK_BUF$
          2 000293  3C00                                 LDV,R3   0
          2 000294  F856                                 LDR,R7   R6
          2 000295  D380 0000 0000  xent                 LNJ,B5   X6C_ACM
          2 000298  5381 000B                            CBE      s:4144,PREL

      226     4140    5                           DO;

      227     4141    5   FROBOZZ:                  ;

   4141   2                              FROBOZZ         null
      228     4142    5                             KP_MSG.CER2_RSP.CROSSTALK = KP_MSG.CER2_RSP.CROSSTALK +1;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:52   

   4142   2 00029A  EC80 0000 0000  xsym FROBOZZ         LDB,B6   HOST_BUF$
          2 00029D  E846 0009                            LDR,R6   9,B6
          2 00029F  EA70 0001                            ADD,R6   1,IMO
          2 0002A1  EAC6 0009                            SRM,R6,'00FF'X    9,B6
          2 0002A3       00FF

      229     4143    5                             END;

      230     4144    4                        END;               /* END DISK_TRACK_NO                     */

   4144   2 0002A4  8A80 0000 0000  xsym                 INC      DISK_TRACK_NO
          2 0002A7  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0002AA  E2C6 000A                            LLH,R6   10,B6
          2 0002AC  E900 0000 0000  xsym                 CMR,R6   DISK_TRACK_NO
          2 0002AF  08C8                                 BAGE     s:4135,SPREL

      231     4145    3                     END;                  /* END DISK_SIDE                      */

   4145   2 0002B0  8A80 0000 0000  xsym                 INC      DISK_SIDE
          2 0002B3  E846 0009                            LDR,R6   9,B6
          2 0002B5  E570 00FF                            AND,R6   255,IMO
          2 0002B7  E900 0000 0000  xsym                 CMR,R6   DISK_SIDE
          2 0002BA  0881 FF78                            BAGE     s:4122,PREL

      232     4146    2                  IF (KP_MSG.CER2_RQS.SIDE_HI - LO_SIDE +1) ~= 2 THEN

   4146   2 0002BC  E247 000D                            SUB,R6   LO_SIDE,AUTO
          2 0002BE  6E01                                 ADV,R6   1
          2 0002BF  6D02                                 CMV,R6   2
          2 0002C0  0981 025B                            BNE      s:4289,PREL

      233     4147    2                     GOTO GOOD_COMPLETION;
      234     4148        /* TEST FOR PRINTTHROUGH.  WE DO THIS BY WRITING A GOOD TRACK, WRITING        */
      235     4149        /* ANYTHING ON THE OTHER SIDE OF THE DISKETTE, AND SEEING IF THE FIRST SIDE   */
      236     4150        /* IS STILL OK.                                                               */
      237     4151    3                  DO DISK_TRACK_NO = LO_TRACK TO KP_MSG.CER2_RQS.TRACK_HI;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:53   

   4151   2 0002C2  E847 000C                            LDR,R6   LO_TRACK,AUTO
          2 0002C4  EF00 0000 0000  xsym                 STR,R6   DISK_TRACK_NO
          2 0002C7  0F81 007A                            B        s:4178+3,PREL

      238     4152    3                     DISK_SIDE = LO_SIDE;

   4152   2 0002C9  E847 000D                            LDR,R6   LO_SIDE,AUTO
          2 0002CB  EF00 0000 0000  xsym                 STR,R6   DISK_SIDE

      239     4153                          /* VOLINIT THE TRACK */
      240     4154    3                     FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;

   4154   2 0002CE  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0002D1  D2C6 0005                            LLH,R5   5,B6
          2 0002D3  DF47 0009                            STR,R5   FIRST_SECTOR,AUTO

      241     4155    3                     NUM_SECTORS = KP_MSG.CER2_RQS.SECTOR_HI - FIRST_SECTOR +1;

   4155   2 0002D5  C2C6 0009                            LLH,R4   9,B6
          2 0002D7  C255                                 SUB,R4   R5
          2 0002D8  4E01                                 ADV,R4   1
          2 0002D9  CF47 0008                            STR,R4   NUM_SECTORS,AUTO

      242     4156    3                     CALL DO_VINIT ALTRET(UNINTENTIONAL);

   4156   2 0002DB  E3C0 0295                            LNJ,B6   s:0,PREL
          2 0002DD       0071                            DC       s:4179,PREL

      243     4157                          /* WRITE TEST DATA */
      244     4158    3                     OUT_DISK_MES_LEN = NUM_SECTORS * (KP_MSG.HEAD.SEC_SIZE +1) * 128;

   4158   2 0002DE  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0002E1  E846 0005                            LDR,R6   5,B6
          2 0002E3  E570 00FF                            AND,R6   255,IMO
          2 0002E5  6E01                                 ADV,R6   1
          2 0002E6  EB47 0008                            MUL,R6   NUM_SECTORS,AUTO
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:54   
          2 0002E8  6007                                 SOL,R6   7
          2 0002E9  EF00 0000 0000  xsym                 STR,R6   OUT_DISK_MES_LEN

      245     4159    3                     DISK_BUF$ = TEST_DATA$;

   4159   2 0002EC  DC80 0000 0000  01                   LDB,B5   TEST_DATA$$
          2 0002EF  DF80 0000 0000  xsym                 STB,B5   DISK_BUF$

      246     4160    3                     DISK_LEN = OUT_DISK_MES_LEN;

   4160   2 0002F2  EF00 0000 0000  xsym                 STR,R6   DISK_LEN

      247     4161    3                     CALL DO_WRITE ALTRET(BOZZ);

   4161   2 0002F5  E3C0 02D6                            LNJ,B6   s:0,PREL
          2 0002F7       0040                            DC       s:4174,PREL

      248     4162    3                     DISK_SIDE = KP_MSG.CER2_RQS.SIDE_HI;

   4162   2 0002F8  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0002FB  E846 0009                            LDR,R6   9,B6
          2 0002FD  E570 00FF                            AND,R6   255,IMO
          2 0002FF  EF00 0000 0000  xsym                 STR,R6   DISK_SIDE

      249     4163                          /* VOLINIT THE TRACK */
      250     4164    3                     FIRST_SECTOR = KP_MSG.HEAD.SECTOR_NO;

   4164   2 000302  D2C6 0005                            LLH,R5   5,B6
          2 000304  DF47 0009                            STR,R5   FIRST_SECTOR,AUTO

      251     4165    3                     NUM_SECTORS = KP_MSG.CER2_RQS.SECTOR_HI - FIRST_SECTOR +1;

   4165   2 000306  C2C6 0009                            LLH,R4   9,B6
          2 000308  C255                                 SUB,R4   R5
          2 000309  4E01                                 ADV,R4   1
          2 00030A  CF47 0008                            STR,R4   NUM_SECTORS,AUTO

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:55   
      252     4166    3                     CALL DO_VINIT ALTRET(UNINTENTIONAL);

   4166   2 00030C  E3C0 0264                            LNJ,B6   s:0,PREL
          2 00030E       0040                            DC       s:4179,PREL

      253     4167    3                     DISK_SIDE = LO_SIDE;

   4167   2 00030F  E847 000D                            LDR,R6   LO_SIDE,AUTO
          2 000311  EF00 0000 0000  xsym                 STR,R6   DISK_SIDE

      254     4168                          /* READ TEST DATA */
      255     4169    3                     IN_DISK_MES_LEN = OUT_DISK_MES_LEN;

   4169   2 000314  D800 0000 0000  xsym                 LDR,R5   OUT_DISK_MES_LEN
          2 000317  DF00 0000 0000  xsym                 STR,R5   IN_DISK_MES_LEN

      256     4170    3                     DISK_BUF$ = OUT_DISK_BUF$;

   4170   2 00031A  EC80 0000 0000  xsym                 LDB,B6   OUT_DISK_BUF$
          2 00031D  EF80 0000 0000  xsym                 STB,B6   DISK_BUF$

      257     4171    3                     DISK_LEN = IN_DISK_MES_LEN;

   4171   2 000320  DF00 0000 0000  xsym                 STR,R5   DISK_LEN

      258     4172    3                     CALL DO_VERFY ALTRET(BOZZ);

   4172   2 000323  E3C0 0327                            LNJ,B6   s:0,PREL
          2 000325       0012                            DC       s:4174,PREL

      259     4173    3                     IF TEST$DATA.DCHAR ~= OUT$DATA.DCHAR THEN

   4173   2 000326  AC80 0000 0000  01                   LDB,B2   TEST_DATA$$
          2 000329  2C00                                 LDV,R2   0
          2 00032A  E800 0000 0000  xsym                 LDR,R6   OUT_DISK_MES_LEN
          2 00032D  BC80 0000 0000  xsym                 LDB,B3   OUT_DISK_BUF$
          2 000330  3C00                                 LDV,R3   0
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:56   
          2 000331  F856                                 LDR,R7   R6
          2 000332  D380 0000 0000  xent                 LNJ,B5   X6C_ACM
          2 000335  5381 0009                            CBE      s:4178,PREL

      260     4174    4                        DO;

   4167   2                              BOZZ            null
      261     4175    4   BOZZ:                  ;
      262     4176    4                         KP_MSG.CER2_RSP.PRINTTHROUGH = KP_MSG.CER2_RSP.PRINTTHROUGH +
              4176                                   1;

   4176   2 000337  EC80 0000 0000  xsym BOZZ            LDB,B6   HOST_BUF$
          2 00033A  E2C6 0009                            LLH,R6   9,B6
          2 00033C  6E01                                 ADV,R6   1
          2 00033D  E7C6 0009                            STH,R6   9,B6

      263     4177    4                          END;

      264     4178    3                     END;                  /* END DISK_TRACK_NO                     */

   4178   2 00033F  8A80 0000 0000  xsym                 INC      DISK_TRACK_NO
          2 000342  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000345  E2C6 000A                            LLH,R6   10,B6
          2 000347  E900 0000 0000  xsym                 CMR,R6   DISK_TRACK_NO
          2 00034A  0881 FF7E                            BAGE     s:4152,PREL

      265     4179    2                  GOTO GOOD_COMPLETION;

   4179   2 00034C  0F81 01CF                            B        s:4289,PREL

   4179   2                              UNINTENTIONAL   null
      266     4180    2   UNINTENTIONAL: ;                        /* Unexpected error                   */
      267     4181    2                  GOTO SEND_STATUS;

   4181   2 00034E  0F81 01D5            UNINTENTIONAL   B        s:4293,PREL

      268     4182        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:57   
      269     4183    2                CASE(%KP_WRITE_RQS#);

      270     4184    2                  KP_MSG.HEAD.MSG_TYPE = %KP_WRITE_RSP#;

   4184   2 000350  6C0E                                 LDV,R6   14
          2 000351  E786                                 STH,R6   ,B6

      271     4185    2                  IF NOT KO_OPENED THEN

   4185   2 000352  8980 0000 0000  xsym                 CMZ      KO_OPENED
          2 000355  0881 013A                            BAGE     s:4250,PREL

      272     4186    2                     GOTO NOT_OPENED;
      273     4187    2                  CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);

   4187   2 000357  E3C0 0286                            LNJ,B6   s:0,PREL
          2 000359       01B0                            DC       s:4277,PREL

      274     4188    2                  CALL DO_WRITE ALTRET(SEND_STATUS);

   4188   2 00035A  E3C0 0271                            LNJ,B6   s:0,PREL
          2 00035C       01C8                            DC       s:4293,PREL

      275     4189    2                  OUT_DISK_MES_LEN = DISK_LEN;

   4189   2 00035D  E800 0000 0000  xsym                 LDR,R6   DISK_LEN
          2 000360  EF00 0000 0000  xsym                 STR,R6   OUT_DISK_MES_LEN

      276     4190    2                  IN_DISK_MES_LEN = DISK_LEN;

   4190   2 000363  EF00 0000 0000  xsym                 STR,R6   IN_DISK_MES_LEN

      277     4191    2                  DISK_BUF$ = IN_DISK_BUF$;

   4191   2 000366  EC80 0000 0000  xsym                 LDB,B6   IN_DISK_BUF$
          2 000369  EF80 0000 0000  xsym                 STB,B6   DISK_BUF$

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:58   
      278     4192    2                  CALL DO_VERFY ALTRET(SEND_STATUS);

   4192   2 00036C  E3C0 02DE                            LNJ,B6   s:0,PREL
          2 00036E       01B6                            DC       s:4293,PREL

      279     4193    2                  IF IN$DATA.DCHAR = ADDR(KP_MSG.TDATA) -> OUT$DATA.DCHAR THEN

   4193   2 00036F  AC80 0000 0000  xsym                 LDB,B2   IN_DISK_BUF$
          2 000372  2C00                                 LDV,R2   0
          2 000373  E800 0000 0000  xsym                 LDR,R6   IN_DISK_MES_LEN
          2 000376  BC80 0000 0000  xsym                 LDB,B3   HOST_BUF$
          2 000379  3C12                                 LDV,R3   18
          2 00037A  F800 0000 0000  xsym                 LDR,R7   OUT_DISK_MES_LEN
          2 00037D  D380 0000 0000  xent                 LNJ,B5   X6C_ACM
          2 000380  5301 0008                            CBNE     s:4198,PREL

      280     4194    3                     DO;

      281     4195    3                       KP_MSG.HEAD.MSG_TYPE = %KP_VERFD_RSP#;

   4195   2 000382  6C09                                 LDV,R6   9
          2 000383  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000386  E786                                 STH,R6   ,B6

      282     4196    3                       MSG_DSIZE = 0;

   4196   2 000387  8747 0005                            CL       MSG_DSIZE,AUTO

      283     4197    3                       END;

      284     4198    2                  GOTO GOOD_COMPLETION;

   4198   2 000389  0F81 0192                            B        s:4289,PREL

      285     4199        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:59   
      286     4200    2                CASE(%KP_READ_RQS#);

      287     4201    2                  KP_MSG.HEAD.MSG_TYPE = %KP_READ_RSP#;

   4201   2 00038B  6C08                                 LDV,R6   8
          2 00038C  E786                                 STH,R6   ,B6

      288     4202    2                  IF NOT KO_OPENED THEN

   4202   2 00038D  8980 0000 0000  xsym                 CMZ      KO_OPENED
          2 000390  0881 00FF                            BAGE     s:4250,PREL

      289     4203    2                     GOTO NOT_OPENED;
      290     4204    2                  CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);

   4204   2 000392  E3C0 024B                            LNJ,B6   s:0,PREL
          2 000394       0175                            DC       s:4277,PREL

      291     4205    2                  CALL PERFORM_SEQUENCE(READ_LIST)

   4205   2 000395  EB80 0000 0002  01                   LAB,B6   READ_LIST
          2 000398  EFC7 0012                            STB,B6   LO_SIDE+5,AUTO
          2 00039A  E3C0 0275                            LNJ,B6   s:0,PREL
          2 00039C       0176                            DC       s:4285,PREL

      292     4206    2                                    ALTRET(DEV_ERR);
      293     4207    3                  DO CASE(KP_MSG.HEAD.IOTYPE);

   4207   2 00039D  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0003A0  B2C6 0001                            LLH,R3   1,B6
          2 0003A2  3D03                                 CMV,R3   3
          2 0003A3  0281 005C                            BGE      s:4224,PREL
          2 0003A5  A830 0000 03AB  02                   LDR,R2   s:4207+14,R3
          2 0003A8  83A0 0000 03AE  02                   JMP      s:4209,R2
          2 0003AB       0038                            DC       s:4219,PREL
          2 0003AC       0000                            DC       s:4209,PREL
          2 0003AD       001C                            DC       s:4214,PREL
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:60   

      294     4208    3                     CASE(1);              /* DIAGNOSTIC READ                    */

      295     4209    3                       CALL KOP$PHYS_IO(KO_CHANNEL,

   4209   2 0003AE  DBF0 000D                            LAB,B5   13,IMO
          2 0003B0  CBC6 0002                            LAB,B4   2,B6
          2 0003B2  CFC7 001C                            STB,B4   I+8,AUTO
          2 0003B4  BB80 0000 0000                       LAB,B3   0
          2 0003B7  BFC7 001A                            STB,B3   I+6,AUTO
          2 0003B9  DFC7 0018                            STB,B5   I+4,AUTO
          2 0003BB  AB80 0000 0000  xsym                 LAB,B2   KO_CHANNEL
          2 0003BE  AFC7 0016                            STB,B2   I+2,AUTO
          2 0003C0  BBC7 0016                            LAB,B3   I+2,AUTO
          2 0003C2  CBF0 0400                            LAB,B4   1024,IMO
          2 0003C4  E380 0000 0000  xent                 LNJ,B6   KOP$PHYS_IO
          2 0003C7       014B                            DC       s:4285,PREL
          2 0003C8  0F81 0037                            B        s:4224,PREL

      296     4210    3                                        %OP_EXDREAD#,,
      297     4211    3                                        KP_MSG.HEAD.DEV_STATUS)
      298     4212    3                                        ALTRET(DEV_ERR);
      299     4213    3                     CASE(2);              /* DELETED DATA                       */

      300     4214    3                       CALL KOP$PHYS_IO(KO_CHANNEL,

   4214   2 0003CA  DBF0 000E                            LAB,B5   14,IMO
          2 0003CC  CBC6 0002                            LAB,B4   2,B6
          2 0003CE  CFC7 001C                            STB,B4   I+8,AUTO
          2 0003D0  BB80 0000 0000                       LAB,B3   0
          2 0003D3  BFC7 001A                            STB,B3   I+6,AUTO
          2 0003D5  DFC7 0018                            STB,B5   I+4,AUTO
          2 0003D7  AB80 0000 0000  xsym                 LAB,B2   KO_CHANNEL
          2 0003DA  AFC7 0016                            STB,B2   I+2,AUTO
          2 0003DC  BBC7 0016                            LAB,B3   I+2,AUTO
          2 0003DE  CBF0 0400                            LAB,B4   1024,IMO
          2 0003E0  E380 0000 0000  xent                 LNJ,B6   KOP$PHYS_IO
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:61   
          2 0003E3       012F                            DC       s:4285,PREL
          2 0003E4  0F81 001B                            B        s:4224,PREL

      301     4215    3                                        %OP_EXKREAD#,,
      302     4216    3                                        KP_MSG.HEAD.DEV_STATUS)
      303     4217    3                                        ALTRET(DEV_ERR);
      304     4218    3                     CASE(0);              /* NORMAL READ                        */

      305     4219    3                       CALL KOP$PHYS_IO(KO_CHANNEL,

   4219   2 0003E6  DBF0 0006                            LAB,B5   6,IMO
          2 0003E8  CBC6 0002                            LAB,B4   2,B6
          2 0003EA  CFC7 001C                            STB,B4   I+8,AUTO
          2 0003EC  BB80 0000 0000                       LAB,B3   0
          2 0003EF  BFC7 001A                            STB,B3   I+6,AUTO
          2 0003F1  DFC7 0018                            STB,B5   I+4,AUTO
          2 0003F3  AB80 0000 0000  xsym                 LAB,B2   KO_CHANNEL
          2 0003F6  AFC7 0016                            STB,B2   I+2,AUTO
          2 0003F8  BBC7 0016                            LAB,B3   I+2,AUTO
          2 0003FA  CBF0 0400                            LAB,B4   1024,IMO
          2 0003FC  E380 0000 0000                       LNJ,B6   0
          2 0003FF       0113                            DC       s:4285,PREL

      306     4220    3                                        %OP_EXREAD#,,
      307     4221    3                                        KP_MSG.HEAD.DEV_STATUS)
      308     4222    3                                        ALTRET(DEV_ERR);
      309     4223    3                     END;                  /* END CASE                           */

      310     4224    2                  GOTO GOOD_COMPLETION;

   4224   2 000400  0F81 011B                            B        s:4289,PREL

      311     4225        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:62   
      312     4226    2                CASE(%KP_CHECK_RQS#);

      313     4227    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CHECK_RSP#;

   4227   2 000402  6C12                                 LDV,R6   18
          2 000403  E786                                 STH,R6   ,B6

      314     4228    2                  MSG_DSIZE = SIZEC(KP_MSG.CHECK_RSP) - SIZEC(KP_MSG.CHECK_RSP.SPARE);

   4228   2 000404  5C30                                 LDV,R5   48
          2 000405  DF47 0005                            STR,R5   MSG_DSIZE,AUTO

      315     4229    2                  KP_MSG.CHECK_RSP = '0'B;

   4229   2 000407  AB80 0000 0000  03                   LAB,B2   0
          2 00040A  2C00                                 LDV,R2   0
          2 00040B  6C01                                 LDV,R6   1
          2 00040C  BC80 0000 0000  xsym                 LDB,B3   HOST_BUF$
          2 00040F  3C12                                 LDV,R3   18
          2 000410  F870 0800                            LDR,R7   2048,IMO
          2 000412  D380 0000 0000  xent                 LNJ,B5   X6C_ALRZ

      316     4230    3                  DO I = 0 TO TOP_DEVICE;

   4230   2 000415  8747 0004                            CL       I,AUTO
          2 000417  0F81 0060                            B        s:4243+2,PREL

      317     4231    3                    KP_MSG.CHECK_RSP.DRIVE.NUMBER(I) = DEVICE_TABLE.DEV_ENTRY.DRIVE_NO
              4231                              (I);

   4231   2 000419  B847 0004                            LDR,R3   I,AUTO
          2 00041B  3F09                                 MLV,R3   9
          2 00041C  E830 0000 0004  xsym                 LDR,R6   DEVICE_TABLE+4,R3
          2 00041F  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000422  A847 0004                            LDR,R2   I,AUTO
          2 000424  2003                                 SOL,R2   3
          2 000425  2E12                                 ADV,R2   18
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:63   
          2 000426  E7A6                                 STH,R6   ,B6,R2

      318     4232    3                     PACK = DEVICE_TABLE.DEV_ENTRY.DEVICE_TYPE(I);

   4232   2 000427  E830 0000 0001  xsym                 LDR,R6   DEVICE_TABLE+1,R3
          2 00042A  EF47 0006                            STR,R6   PACK,AUTO

      319     4233    3                     KP_MSG.CHECK_RSP.DRIVE.TYPE(I) = PACK_;

   4233   2 00042C  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00042F  9847 0004                            LDR,R1   I,AUTO
          2 000431  1002                                 SOL,R1   2
          2 000432  1E0B                                 ADV,R1   11
          2 000433  D847 0006                            LDR,R5   PACK,AUTO
          2 000435  DF16                                 STR,R5   ,B6,R1

      320     4234    3                     PACK = DEVICE_TABLE.DEV_ENTRY.CHAN_ADDR(I) *64;

   4234   2 000436  E830 0000 0000  xsym                 LDR,R6   DEVICE_TABLE,R3
          2 000439  6006                                 SOL,R6   6
          2 00043A  EF47 0006                            STR,R6   PACK,AUTO

      321     4235    3                     KP_MSG.CHECK_RSP.DRIVE.CHAN(I) = PACK_;

   4235   2 00043C  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00043F  B847 0004                            LDR,R3   I,AUTO
          2 000441  3002                                 SOL,R3   2
          2 000442  3E0C                                 ADV,R3   12
          2 000443  D847 0006                            LDR,R5   PACK,AUTO
          2 000445  DF36                                 STR,R5   ,B6,R3

      322     4236    3                     KP_MSG.CHECK_RSP.DRIVE.OPERATION_STATUS(I) = %E$KP_ALLOK;

   4236   2 000446  C870 00C8                            LDR,R4   200,IMO
          2 000448  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00044B  B847 0004                            LDR,R3   I,AUTO
          2 00044D  3003                                 SOL,R3   3
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:64   
          2 00044E  3E13                                 ADV,R3   19
          2 00044F  C7B6                                 STH,R4   ,B6,R3

      323     4237    3                     CALL KOP$GET_STATUS (

   4237   2 000450  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000453  B847 0004                            LDR,R3   I,AUTO
          2 000455  3002                                 SOL,R3   2
          2 000456  3E0A                                 ADV,R3   10
          2 000457  DBB6                                 LAB,B5   ,B6,R3
          2 000458  DFC7 0018                            STB,B5   I+4,AUTO
          2 00045A  B847 0004                            LDR,R3   I,AUTO
          2 00045C  3F09                                 MLV,R3   9
          2 00045D  CBB0 0000 0000  xsym                 LAB,B4   DEVICE_TABLE,R3
          2 000460  CFC7 0016                            STB,B4   I+2,AUTO
          2 000462  BBC7 0016                            LAB,B3   I+2,AUTO
          2 000464  CBF0 0200                            LAB,B4   512,IMO
          2 000466  E380 0000 0000  xent                 LNJ,B6   KOP$GET_STATUS
          2 000469       0003                            DC       s:4241,PREL
          2 00046A  0F81 000B                            B        s:4243,PREL

      324     4238    3                            DEVICE_TABLE.DEV_ENTRY.CHAN_ADDR(I),
      325     4239    3                            KP_MSG.CHECK_RSP.DRIVE.DEV_STATUS(I))
      326     4240    4                          WHENALTRETURN DO;

      327     4241    4                            KP_MSG.CHECK_RSP.DRIVE.OPERATION_STATUS(I) = %E$KP_DEV_ERR
              4241                                      ;

   4241   2 00046C  E870 00CB                            LDR,R6   203,IMO
          2 00046E  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000471  B847 0004                            LDR,R3   I,AUTO
          2 000473  3003                                 SOL,R3   3
          2 000474  3E13                                 ADV,R3   19
          2 000475  E7B6                                 STH,R6   ,B6,R3

      328     4242    4                             END;

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:65   
      329     4243    3                     END;

   4243   2 000476  8AC7 0004                            INC      I,AUTO
          2 000478  E847 0004                            LDR,R6   I,AUTO
          2 00047A  E900 0000 0000  xsym                 CMR,R6   TOP_DEVICE
          2 00047D  0A81 FF9B                            BALE     s:4231,PREL

      330     4244    2                  KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;

   4244   2 00047F  D870 00C8                            LDR,R5   200,IMO
          2 000481  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000484  DAC6 0001                            SRM,R5,'00FF'X    1,B6
          2 000486       00FF

      331     4245    2                  GOTO SENDIT;

   4245   2 000487  0F81 00B9                            B        s:4302,PREL

      332     4246        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:66   
      333     4247    2                CASE(%KP_CLOSE_RQS#);

      334     4248    2                  KP_MSG.HEAD.MSG_TYPE = %KP_CLOSE_RSP#;

   4248   2 000489  6C10                                 LDV,R6   16
          2 00048A  E786                                 STH,R6   ,B6

      335     4249    2                  IF NOT KO_OPENED THEN

   4249   2 00048B  8980 0000 0000  xsym                 CMZ      KO_OPENED
          2 00048E  0801 000B                            BAL      s:4255,PREL

      336     4250    3                     DO;

      337     4251    3   NOT_OPENED:         ;

   4251   2                              NOT_OPENED      null
      338     4252    3                       KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DRIVE_NOT_OPEN;

   4252   2 000490  E870 00CD            NOT_OPENED      LDR,R6   205,IMO
          2 000492  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000495  EAC6 0001                            SRM,R6,'00FF'X    1,B6
          2 000497       00FF

      339     4253    3                       GOTO SEND_HEAD_ONLY;

   4253   2 000498  0F81 0070                            B        s:4277,PREL

      340     4254    3                       END;
      341     4255    2                  CALL KOP$GET_STATUS(KO_CHANNEL,KP_MSG.HEAD.DEV_STATUS) ALTRET(
              4255                           NO_CLS_STAT);

   4255   2 00049A  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00049D  DBC6 0002                            LAB,B5   2,B6
          2 00049F  DFC7 0018                            STB,B5   I+4,AUTO
          2 0004A1  CB80 0000 0000  xsym                 LAB,B4   KO_CHANNEL
          2 0004A4  CFC7 0016                            STB,B4   I+2,AUTO
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:67   
          2 0004A6  BBC7 0016                            LAB,B3   I+2,AUTO
          2 0004A8  CBF0 0200                            LAB,B4   512,IMO
          2 0004AA  E380 0000 0000  xent                 LNJ,B6   KOP$GET_STATUS
          2 0004AD       0001                            DC       s:4249,PREL

   4249   2                              NO_CLS_STAT     null
      342     4256    2   NO_CLS_STAT:   ;
      343     4257    2                  KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;

   4257   2 0004AE  E870 00C8            NO_CLS_STAT     LDR,R6   200,IMO
          2 0004B0  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0004B3  EAC6 0001                            SRM,R6,'00FF'X    1,B6
          2 0004B5       00FF

      344     4258    2                  KO_OPENED = '0'B;

   4258   2 0004B6  8700 0000 0000  xsym                 CL       KO_OPENED

      345     4259    2                  GOTO SEND_HEAD_ONLY;

   4259   2 0004B9  0F81 004F                            B        s:4277,PREL

      346     4260        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:68   
      347     4261    2                CASE(%KP_OPEN_RQS#);

      348     4262    2                  KP_MSG.HEAD.MSG_TYPE = %KP_OPEN_RSP#;

   4262   2 0004BB  6C0F                                 LDV,R6   15
          2 0004BC  E786                                 STH,R6   ,B6

      349     4263    2                  CALL PICK_DRIVE ALTRET(SEND_HEAD_ONLY);

   4263   2 0004BD  E3C0 0120                            LNJ,B6   s:0,PREL
          2 0004BF       004A                            DC       s:4277,PREL

      350     4264    2                  CALL KOP$INITIALIZE(KO_CHANNEL) ALTRET(CANT_INITIALIZE);

   4264   2 0004C0  BB80 0000 0001  03                   LAB,B3   +1
          2 0004C3  CBF0 0100                            LAB,B4   256,IMO
          2 0004C5  E380 0000 0000  xent                 LNJ,B6   KOP$INITIALIZE
          2 0004C8       002E                            DC       s:4268,PREL

      351     4265    2                  CALL KOP$GET_STATUS(KO_CHANNEL,KP_MSG.HEAD.DEV_STATUS) ALTRET(
              4265                           CANT_INITIALIZE);

   4265   2 0004C9  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0004CC  DBC6 0002                            LAB,B5   2,B6
          2 0004CE  DFC7 0018                            STB,B5   I+4,AUTO
          2 0004D0  CB80 0000 0000  xsym                 LAB,B4   KO_CHANNEL
          2 0004D3  CFC7 0016                            STB,B4   I+2,AUTO
          2 0004D5  BBC7 0016                            LAB,B3   I+2,AUTO
          2 0004D7  CBF0 0200                            LAB,B4   512,IMO
          2 0004D9  E380 0000 0000  xent                 LNJ,B6   KOP$GET_STATUS
          2 0004DC       001A                            DC       s:4268,PREL

      352     4266    2                  KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;

   4266   2 0004DD  E870 00C8                            LDR,R6   200,IMO
          2 0004DF  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0004E2  EAC6 0001                            SRM,R6,'00FF'X    1,B6
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:69   
          2 0004E4       00FF

      353     4267    2                  CALL KOP$CHECK_STATUS (KP_MSG.HEAD.DEV_STATUS)

   4267   2 0004E5  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0004E8  DBC6 0002                            LAB,B5   2,B6
          2 0004EA  DFC7 0016                            STB,B5   I+2,AUTO
          2 0004EC  BBC7 0016                            LAB,B3   I+2,AUTO
          2 0004EE  CBF0 0100                            LAB,B4   256,IMO
          2 0004F0  E380 0000 0000  xent                 LNJ,B6   KOP$CHECK_STATUS
          2 0004F3       0003                            DC       s:4268,PREL
          2 0004F4  0F81 0009                            B        s:4272,PREL

      354     4268    3                     WHENALTRETURN DO;

   4267   2                              CANT_INITIALIZE null
      355     4269    3   CANT_INITIALIZE:     ;
      356     4270    3                        KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DEV_ERR;

   4270   2 0004F6  E870 00CB            CANT_INITIALIZE LDR,R6   203,IMO
          2 0004F8  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0004FB  EAC6 0001                            SRM,R6,'00FF'X    1,B6
          2 0004FD       00FF

      357     4271    3                        END;

      358     4272    2                  KO_OPENED = '1'B;

   4272   2 0004FE  8900 0000 0000  xsym                 LBT,'8000'X       KO_OPENED
   4272   2 000501       8000

      359     4273    2                  GOTO SEND_HEAD_ONLY;

   4273   2 000502  0F81 0006                            B        s:4277,PREL

      360     4274        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:70   
      361     4275    2                CASE(%KP_DIE_RQS#);

      362     4276    2                  THINGS_ARE_ROSY = '0'B;

   4276   2 000504  8700 0000 0000  xsym                 CL       THINGS_ARE_ROSY

      363     4277    2                END;                       /* END DO CASE                        */

      364     4278    1             GOTO FINIS;

   4278   2 000507  0F81 003C                            B        s:4296,PREL

   4277   2                              SEND_HEAD_ONLY  null
      365     4279        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:71   
      366     4280        /**/
      367     4281        /*  Various stubs used to terminate this operation.                           */
      368     4282        /**/
      369     4283    1   SEND_HEAD_ONLY: ;                       /* Send only the header               */
      370     4284    1             KP_MSG.HEAD.NUM_BYTES = '0'B;

   4284   2 000509  EC80 0000 0000  xsym SEND_HEAD_ONLY  LDB,B6   HOST_BUF$
          2 00050C  8746 0003                            CL       3,B6

      371     4285    1             MSG_DSIZE = 0;

   4285   2 00050E  8747 0005                            CL       MSG_DSIZE,AUTO

      372     4286    1             GOTO SENDIT;

   4286   2 000510  0F81 0030                            B        s:4302,PREL

   4285   2                              DEV_ERR         null
      373     4287        /**/
      374     4288    1   DEV_ERR:  ;                             /* Device I/O error                   */
      375     4289    1             KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DEV_ERR;

   4289   2 000512  E870 00CB            DEV_ERR         LDR,R6   203,IMO
          2 000514  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000517  EAC6 0001                            SRM,R6,'00FF'X    1,B6
          2 000519       00FF

      376     4290    1             GOTO SEND_STATUS_ONLY;

   4290   2 00051A  0F81 000B                            B        s:4284,PREL

   4289   2                              GOOD_COMPLETION null
      377     4291        /**/
      378     4292    1   GOOD_COMPLETION:  ;
      379     4293    1             KP_MSG.HEAD.OPERATION_STATUS = %E$KP_ALLOK;

   4293   2 00051C  E870 00C8            GOOD_COMPLETION LDR,R6   200,IMO
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:72   
          2 00051E  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000521  EAC6 0001                            SRM,R6,'00FF'X    1,B6
          2 000523       00FF

   4293   2                              SEND_STATUS     null
      380     4294    1   SEND_STATUS:   ;                   /* Get/send status, variable data size*/
      381     4295    2             DO WHILE ('0'B);

   4295   2 000524  0F81 0003            SEND_STATUS     B        s:4299,PREL

   4284   2                              SEND_STATUS_ONLYnull
      382     4296    2   SEND_STATUS_ONLY: ;
      383     4297    2                MSG_DSIZE = 0;

   4297   2 000526  8747 0005            SEND_STATUS_ONLYCL       MSG_DSIZE,AUTO

      384     4298    2                END;

      385     4299    1             CALL KOP$CHECK_STATUS (KP_MSG.HEAD.DEV_STATUS)

   4299   2 000528  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00052B  DBC6 0002                            LAB,B5   2,B6
          2 00052D  DFC7 0016                            STB,B5   I+2,AUTO
          2 00052F  BBC7 0016                            LAB,B3   I+2,AUTO
          2 000531  CBF0 0100                            LAB,B4   256,IMO
          2 000533  E380 0000 0000  xent                 LNJ,B6   KOP$CHECK_STATUS
          2 000536       0003                            DC       s:4301,PREL
          2 000537  0F81 0009                            B        s:4302,PREL

      386     4300    2                WHENALTRETURN DO;

      387     4301    2                   KP_MSG.HEAD.OPERATION_STATUS = %E$KP_DEV_ERR;

   4301   2 000539  E870 00CB                            LDR,R6   203,IMO
          2 00053B  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00053E  EAC6 0001                            SRM,R6,'00FF'X    1,B6
          2 000540       00FF
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:73   

      388     4302    2                   END;

   4296   2                              SENDIT          null
      389     4303    1   SENDIT:   ;
      390     4304    1             CALL SEND_MSG ALTRET(TROUBLE);

   4304   2 000541  E3C0 0008            SENDIT          LNJ,B6   s:0,PREL
          2 000543       0004                            DC       s:4296,PREL

   4296   2                              FINIS           null
      391     4305        /**/
      392     4306        /*  This request from the host is taken care of.  Reset the process by        */
      393     4307        /*  initiating another nowait read on the host.                               */
      394     4308        /**/
      395     4309    1   FINIS:    ;
      396     4310        /*N*      CALL KOH$HOST_IO (%KOH_NWREAD_HOST#) ALTRET(TROUBLE);               */
      397     4311        /**/
      398     4312    1             RETURN;

   4312   2 000544  C380 0000 0000  xent FINIS           LNJ,B4   X6A_ARET

   4296   2                              TROUBLE         null
      399     4313        /**/
      400     4314    1   TROUBLE:  ;
      401     4315    1             ALTRETURN;

   4315   2 000547  C380 0000 0000  xent TROUBLE         LNJ,B4   X6A_AALT

      402     4316        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:74   
      403     4317    1   SEND_MSG: PROC ALTRET;

   4317   2 00054A  EFC7 000E            SEND_MSG        STB,B6   LO_SIDE+1,AUTO

      404     4318    2             KP_MSG.HEAD.RETRIES = DISK_RETRIES;

   4318   2 00054C  E800 0000 0000  xsym                 LDR,R6   DISK_RETRIES
          2 00054F  DC80 0000 0000  xsym                 LDB,B5   HOST_BUF$
          2 000552  E7C5 0006                            STH,R6   6,B5

      405     4319    2             KP_MSG.HEAD.NUM_BYTES = MSG_DSIZE_;

   4319   2 000554  D847 0005                            LDR,R5   MSG_DSIZE,AUTO
          2 000556  DF45 0003                            STR,R5   3,B5

      406     4320    2             HOST_MES_LEN = SIZEC(KP_MSG.HEAD) + MSG_DSIZE;

   4320   2 000558  C847 0005                            LDR,R4   MSG_DSIZE,AUTO
          2 00055A  4E12                                 ADV,R4   18
          2 00055B  CF00 0000 0000  xsym                 STR,R4   HOST_MES_LEN

      407     4321    2             CALL KOH$HOST_IO(%KOH_WRITE_HOST#)

   4321   2 00055E  BB80 0000 0004  03                   LAB,B3   +4
          2 000561  CBF0 0100                            LAB,B4   256,IMO
          2 000563  E380 0000 0000  xent                 LNJ,B6   KOH$HOST_IO
          2 000566       0003                            DC       s:4322,PREL
          2 000567  0F81 0005                            B        s:4323,PREL

      408     4322    3                WHENALTRETURN DO; ALTRETURN; END;

   4322   2 000569  ECC7 000E                            LDB,B6   LO_SIDE+1,AUTO
          2 00056B  B806                                 LDR,R3   ,B6
          2 00056C  C3B6                                 LNJ,B4   ,B6,R3

      409     4323    2             RETURN;

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:75   
   4323   2 00056D  ECC7 000E                            LDB,B6   LO_SIDE+1,AUTO
          2 00056F  C3C6 0001                            LNJ,B4   1,B6

      410     4324    2             END SEND_MSG;
      411     4325        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:76   
      412     4326    1   DO_VINIT: PROC ALTRET;

   4326   2 000571  EFC7 000E            DO_VINIT        STB,B6   LO_SIDE+1,AUTO

      413     4327    2             OUT_DISK_MES_LEN = NUM_SECTORS *4;

   4327   2 000573  E847 0008                            LDR,R6   NUM_SECTORS,AUTO
          2 000575  6002                                 SOL,R6   2
          2 000576  EF00 0000 0000  xsym                 STR,R6   OUT_DISK_MES_LEN

      414     4328    3             DO J = FIRST_SECTOR TO FIRST_SECTOR + NUM_SECTORS -1;

   4328   2 000579  D847 0009                            LDR,R5   FIRST_SECTOR,AUTO
          2 00057B  DF47 0007                            STR,R5   J,AUTO
          2 00057D  0F81 002B                            B        s:4334+2,PREL

      415     4329    3                I = (J-FIRST_SECTOR) *4;   /* Make zero-based BYTE index         */

   4329   2 00057F  E847 0007                            LDR,R6   J,AUTO
          2 000581  E247 0009                            SUB,R6   FIRST_SECTOR,AUTO
          2 000583  6002                                 SOL,R6   2
          2 000584  EF47 0004                            STR,R6   I,AUTO

      416     4330    3                OUT$DATA.DUBIN (I+0) = DISK_TRACK_NO;

   4330   2 000586  D800 0000 0000  xsym                 LDR,R5   DISK_TRACK_NO
          2 000589  EC80 0000 0000  xsym                 LDB,B6   OUT_DISK_BUF$
          2 00058C  B856                                 LDR,R3   R6
          2 00058D  D7B6                                 STH,R5   ,B6,R3

      417     4331    3                OUT$DATA.DUBIN (I+1) = DISK_SIDE;

   4331   2 00058E  D800 0000 0000  xsym                 LDR,R5   DISK_SIDE
          2 000591  EC80 0000 0000  xsym                 LDB,B6   OUT_DISK_BUF$
          2 000594  3E01                                 ADV,R3   1
          2 000595  D7B6                                 STH,R5   ,B6,R3

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:77   
      418     4332    3                OUT$DATA.DUBIN (I+2) = J;

   4332   2 000596  D847 0007                            LDR,R5   J,AUTO
          2 000598  EC80 0000 0000  xsym                 LDB,B6   OUT_DISK_BUF$
          2 00059B  A856                                 LDR,R2   R6
          2 00059C  2E02                                 ADV,R2   2
          2 00059D  D7A6                                 STH,R5   ,B6,R2

      419     4333    3                OUT$DATA.DUBIN (I+3) = DISK_SEC_SIZE;

   4333   2 00059E  C800 0000 0000  xsym                 LDR,R4   DISK_SEC_SIZE
          2 0005A1  EC80 0000 0000  xsym                 LDB,B6   OUT_DISK_BUF$
          2 0005A4  9856                                 LDR,R1   R6
          2 0005A5  1E03                                 ADV,R1   3
          2 0005A6  C796                                 STH,R4   ,B6,R1

      420     4334    3                END;                   /* END DO J                           */

   4334   2 0005A7  8AC7 0007                            INC      J,AUTO
          2 0005A9  E847 0009                            LDR,R6   FIRST_SECTOR,AUTO
          2 0005AB  EA47 0008                            ADD,R6   NUM_SECTORS,AUTO
          2 0005AD  E947 0007                            CMR,R6   J,AUTO
          2 0005AF  0A50                                 BAG      s:4329,SPREL

      421     4335    2             DISK_BUF$ = OUT_DISK_BUF$;

   4335   2 0005B0  EC80 0000 0000  xsym                 LDB,B6   OUT_DISK_BUF$
          2 0005B3  EF80 0000 0000  xsym                 STB,B6   DISK_BUF$

      422     4336    2             DISK_LEN = OUT_DISK_MES_LEN;

   4336   2 0005B6  E800 0000 0000  xsym                 LDR,R6   OUT_DISK_MES_LEN
          2 0005B9  EF00 0000 0000  xsym                 STR,R6   DISK_LEN

      423     4337    2             CALL PERFORM_SEQUENCE (VINIT_LIST)

   4337   2 0005BC  DB80 0000 000C  01                   LAB,B5   VINIT_LIST
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:78   
          2 0005BF  DFC7 0012                            STB,B5   LO_SIDE+5,AUTO
          2 0005C1  E3C0 004E                            LNJ,B6   s:0,PREL
          2 0005C3       0005                            DC       s:4336,PREL

      424     4338    2                                    ALTRET(OOPS);
      425     4339    2             RETURN;

   4339   2 0005C4  ECC7 000E                            LDB,B6   LO_SIDE+1,AUTO
          2 0005C6  C3C6 0001                            LNJ,B4   1,B6

   4336   2                              OOPS            null
      426     4340        /**/
      427     4341    2   OOPS:     ;
      428     4342    2             ALTRETURN;

   4342   2 0005C8  ECC7 000E            OOPS            LDB,B6   LO_SIDE+1,AUTO
          2 0005CA  B806                                 LDR,R3   ,B6
          2 0005CB  C3B6                                 LNJ,B4   ,B6,R3

      429     4343        /**/
      430     4344    2             END DO_VINIT;
      431     4345        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:79   
      432     4346    1   DO_WRITE: PROC ALTRET;

   4346   2 0005CC  EFC7 000E            DO_WRITE        STB,B6   LO_SIDE+1,AUTO

      433     4347    2             CALL PERFORM_SEQUENCE (WRITE_LIST)

   4347   2 0005CE  DB80 0000 0016  01                   LAB,B5   WRITE_LIST
          2 0005D1  DFC7 0012                            STB,B5   LO_SIDE+5,AUTO
          2 0005D3  E3C0 003C                            LNJ,B6   s:0,PREL
          2 0005D5       0005                            DC       s:4348,PREL

      434     4348    2                                   ALTRET(OOPS);
      435     4349    2             RETURN;

   4349   2 0005D6  ECC7 000E                            LDB,B6   LO_SIDE+1,AUTO
          2 0005D8  C3C6 0001                            LNJ,B4   1,B6

   4348   2                              OOPS            null
      436     4350        /**/
      437     4351    2   OOPS:     ;
      438     4352    2             ALTRETURN;

   4352   2 0005DA  ECC7 000E            OOPS            LDB,B6   LO_SIDE+1,AUTO
          2 0005DC  B806                                 LDR,R3   ,B6
          2 0005DD  C3B6                                 LNJ,B4   ,B6,R3

      439     4353        /**/
      440     4354    2             END DO_WRITE;
      441     4355        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:80   
      442     4356    1   PICK_DRIVE: PROC ALTRET;

   4356   2 0005DE  EFC7 000E            PICK_DRIVE      STB,B6   LO_SIDE+1,AUTO

      443     4357        /**/
      444     4358        /*  This routine selects the drive with a drive number equal to KO_DRIVE.     */
      445     4359        /**/
      446     4360    3           DO I = 0 TO TOP_DEVICE;

   4360   2 0005E0  8747 0004                            CL       I,AUTO
          2 0005E2  0F81 001B                            B        s:4367+2,PREL

      447     4361    3              IF DEVICE_TABLE.DEV_ENTRY.DRIVE_NO(I) = KP_MSG.HEAD.DRIVE_NO

   4361   2 0005E4  B847 0004                            LDR,R3   I,AUTO
          2 0005E6  3F09                                 MLV,R3   9
          2 0005E7  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 0005EA  E806                                 LDR,R6   ,B6
          2 0005EB  E570 00FF                            AND,R6   255,IMO
          2 0005ED  E930 0000 0004  xsym                 CMR,R6   DEVICE_TABLE+4,R3
          2 0005F0  0981 000B                            BNE      s:4367,PREL

      448     4362    3               THEN
      449     4363    4                 DO;

      450     4364    4                   KO_CHANNEL = DEVICE_TABLE.DEV_ENTRY.CHAN_ADDR(I);

   4364   2 0005F2  D830 0000 0000  xsym                 LDR,R5   DEVICE_TABLE,R3
          2 0005F5  DF00 0000 0000  xsym                 STR,R5   KO_CHANNEL

      451     4365    4                   RETURN;

   4365   2 0005F8  ECC7 000E                            LDB,B6   LO_SIDE+1,AUTO
          2 0005FA  C3C6 0001                            LNJ,B4   1,B6

      452     4366    4                   END;
      453     4367    3              END;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:81   

   4367   2 0005FC  8AC7 0004                            INC      I,AUTO
          2 0005FE  E847 0004                            LDR,R6   I,AUTO
          2 000600  E900 0000 0000  xsym                 CMR,R6   TOP_DEVICE
          2 000603  0AE1                                 BALE     s:4361,SPREL

      454     4368    2           KP_MSG.HEAD.OPERATION_STATUS = %E$KP_NO_DRIVE;

   4368   2 000604  D870 00CA                            LDR,R5   202,IMO
          2 000606  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 000609  DAC6 0001                            SRM,R5,'00FF'X    1,B6
          2 00060B       00FF

      455     4369    2           ALTRETURN;

   4369   2 00060C  ECC7 000E                            LDB,B6   LO_SIDE+1,AUTO
          2 00060E  B806                                 LDR,R3   ,B6
          2 00060F  C3B6                                 LNJ,B4   ,B6,R3

      456     4370        /**/
      457     4371    2           END PICK_DRIVE;
      458     4372        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:82   
      459     4373    1   PERFORM_SEQUENCE: PROC(OP_LIST) ALTRET;

   4373   2 000610  EFC7 0010            PERFORM_SEQUENCESTB,B6   LO_SIDE+3,AUTO

      460     4374    2   DCL OP_LIST(0:9) SBIN WORD ALIGNED PARAM;
      461     4375    2   DCL I SBIN WORD;
      462     4376    2           I = 0;

   4376   2 000612  8747 0014                            CL       I,AUTO

      463     4377    3           DO WHILE (OP_LIST(I) ~= %OP_NOTHING#);

   4377   2 000614  DCC7 0012                            LDB,B5   @OP_LIST,AUTO
          2 000616  B847 0014                            LDR,R3   I,AUTO
          2 000618  E835                                 LDR,R6   ,B5,R3
          2 000619  6901 0029                            BEZ,R6   s:4384,PREL

      464     4378    3              CALL KOP$PHYS_IO(KO_CHANNEL,

   4378   2 00061B  EC80 0000 0000  xsym                 LDB,B6   HOST_BUF$
          2 00061E  DBC6 0002                            LAB,B5   2,B6
          2 000620  DFC7 001C                            STB,B5   I+8,AUTO
          2 000622  CB80 0000 0000                       LAB,B4   0
          2 000625  CFC7 001A                            STB,B4   I+6,AUTO
          2 000627  BCC7 0012                            LDB,B3   @OP_LIST,AUTO
          2 000629  B847 0014                            LDR,R3   I,AUTO
          2 00062B  ABB3                                 LAB,B2   ,B3,R3
          2 00062C  AFC7 0018                            STB,B2   I+4,AUTO
          2 00062E  9B80 0000 0000  xsym                 LAB,B1   KO_CHANNEL
          2 000631  9FC7 0016                            STB,B1   I+2,AUTO
          2 000633  BBC7 0016                            LAB,B3   I+2,AUTO
          2 000635  CBF0 0400                            LAB,B4   1024,IMO
          2 000637  E380 0000 0000  xent                 LNJ,B6   KOP$PHYS_IO
          2 00063A       000D                            DC       s:4378,PREL

      465     4379    3                               OP_LIST(I),,
      466     4380    3                               KP_MSG.HEAD.DEV_STATUS)
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:83   
      467     4381    3                               ALTRET(OOPS);
      468     4382    3              I = I +1;

   4382   2 00063B  8AC7 0014                            INC      I,AUTO

      469     4383    3              END;

   4383   2 00063D  ECC7 0012                            LDB,B6   @OP_LIST,AUTO
          2 00063F  B847 0014                            LDR,R3   I,AUTO
          2 000641  E836                                 LDR,R6   ,B6,R3
          2 000642  69D9                                 BNEZ,R6  s:4378,SPREL

      470     4384    2           RETURN;

   4384   2 000643  ECC7 0010                            LDB,B6   LO_SIDE+3,AUTO
          2 000645  C3C6 0001                            LNJ,B4   1,B6

   4378   2                              OOPS            null
      471     4385        /**/
      472     4386    2   OOPS:   ;
      473     4387    2           ALTRETURN;

   4387   2 000647  ECC7 0010            OOPS            LDB,B6   LO_SIDE+3,AUTO
          2 000649  B806                                 LDR,R3   ,B6
          2 00064A  C3B6                                 LNJ,B4   ,B6,R3

      474     4388        /**/
      475     4389    2           END PERFORM_SEQUENCE;
      476     4390        %EJECT;
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:84   
      477     4391    1   DO_VERFY:  PROC ALTRET;

   4391   2 00064B  EFC7 000E            DO_VERFY        STB,B6   LO_SIDE+1,AUTO

      478     4392    2             CALL PERFORM_SEQUENCE (VERFY_LIST)

   4392   2 00064D  DB80 0000 0020  01                   LAB,B5   VERFY_LIST
          2 000650  DFC7 0012                            STB,B5   @OP_LIST,AUTO
          2 000652  E3C0 FFBD                            LNJ,B6   s:0,PREL
          2 000654       0005                            DC       s:4393,PREL

      479     4393    2                                   ALTRET(OOPS);
      480     4394    2             RETURN;

   4394   2 000655  ECC7 000E                            LDB,B6   LO_SIDE+1,AUTO
          2 000657  C3C6 0001                            LNJ,B4   1,B6

   4393   2                              OOPS            null
      481     4395        /**/
      482     4396    2   OOPS:     ;
      483     4397    2             ALTRETURN;

   4397   2 000659  ECC7 000E            OOPS            LDB,B6   LO_SIDE+1,AUTO
          2 00065B  B806                                 LDR,R3   ,B6
          2 00065C  C3B6                                 LNJ,B4   ,B6,R3
      484     4398        /**/
      485     4399    2             END DO_VERFY;
      486     4400        /**/
      487     4401    1             END KOE$HOST_EVENT;
      488     4402        %EOD;

PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:85   
--  Include file information  --

   KP_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH_CHN.:E05TOU  is referenced.
   KP_MSG.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KO_SUBS.:E05TOU  is referenced.
   KO_MACRO_C.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KOE$HOST_EVENT.
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:86   

 **** Variables and constants ****

  ****  Section 001 RoData KOE$HOST_EVENT

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/w SBIN(16)    r     1 READ_LIST(0:9)
     0-0-0/w PTR         r     1 TEST_DATA$                 0-0-0/w EPTR        r     1 TEST_DATA$$
    20-0-0/w SBIN(16)    r     1 VERFY_LIST(0:9)
     C-0-0/w SBIN(16)    r     1 VINIT_LIST(0:9)
    16-0-0/w SBIN(16)    r     1 WRITE_LIST(0:9)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w PTR         r     1 @OP_LIST                   9-0-0/w SBIN(16)    r     1 FIRST_SECTOR
     4-0-0/w SBIN(16)    r     1 I                         14-0-0/w SBIN(16)    r     1 I
     7-0-0/w SBIN(16)    r     1 J                          D-0-0/w SBIN(16)    r     1 LO_SIDE
     C-0-0/w SBIN(16)    r     1 LO_TRACK                   5-0-0/b UBIN(16)    r     1 MSG_DSIZE
     5-0-0/b STRC(16)    r     1 MSG_DSIZE_                 8-0-0/w SBIN(16)    r     1 NUM_SECTORS
    *0-0-0/w SBIN(16)    r     1 OP_LIST(0:9)
     6-0-0/w UBIN(16)    r     1 PACK                       6-0-0/b STRC(16)    r     1 PACK_

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(896)   r     1 DEVICE_TABLE               0-0-0/w PTR         r     1 DISK_BUF$
     0-0-0/w SBIN(16)    r     1 DISK_LEN                   0-0-0/w SBIN(16)    r     1 DISK_RETRIES
     0-0-0/w SBIN(16)    r     1 DISK_SECTOR_NO             0-0-0/w SBIN(16)    r     1 DISK_SEC_SIZE
     0-0-0/w SBIN(16)    r     1 DISK_SIDE                  0-0-0/w SBIN(16)    r     1 DISK_TRACK_NO
     0-0-0/w PTR         r     1 HOST_BUF$                  0-0-0/w SBIN(16)    r     1 HOST_MES_LEN
     0-0-0/w PTR         r     1 IN_DISK_BUF$               0-0-0/w SBIN(16)    r     1 IN_DISK_MES_LEN
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:87   
     0-0-0/w UBIN(16)    r     1 KO_CHANNEL                 0-0-0/w UBIN(16)    r     1 KO_DRIVE
     0-0-0/b BIT         r     1 KO_OPENED                  0-0-0/w PTR         r     1 OUT_DISK_BUF$
     0-0-0/w SBIN(16)    r     1 OUT_DISK_MES_LEN           0-0-0/b BIT         r     1 THINGS_ARE_ROSY
     0-0-0/w SBIN(16)    r     1 TOP_DEVICE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(0)     r     1 IN$DATA                    0-0-0/w STRC(16528) r     1 KP_MSG
     0-0-0/w ASTR(0)     r     1 OUT$DATA                   0-0-0/w ASTR(0)     r     1 TEST$DATA


   Procedure KOE$HOST_EVENT requires 1629 words for executable code.
   Procedure KOE$HOST_EVENT requires 30 words of local(AUTO) storage.
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:88   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:89   
          MINI XREF LISTING

BOZZ
      4167**LABEL    4161--CALLALT  4172--CALLALT
CANT_INITIALIZE
      4267**LABEL    4264--CALLALT  4265--CALLALT
CERTERR_R
      4077**LABEL    4070--CALLALT
CERTERR_V
      4077**LABEL    4055--CALLALT
CERTERR_W
      4077**LABEL    4062--CALLALT
DEVICE_TABLE.DEV_ENTRY.CHAN_ADDR
      3695**DCL      4234>>ASSIGN   4237<>CALL     4364>>ASSIGN
DEVICE_TABLE.DEV_ENTRY.DEVICE_TYPE
      3697**DCL      4232>>ASSIGN
DEVICE_TABLE.DEV_ENTRY.DRIVE_NO
      3755**DCL      4231>>ASSIGN   4361>>IF
DEV_ERR
      4285**LABEL    4082--GOTO     4098--CALLALT  4099--CALLALT  4105--CALLALT  4205--CALLALT  4209--CALLALT
      4214--CALLALT  4219--CALLALT
DISK_BUF$
      3388**DCL      4008<<ASSIGN   4038<<ASSIGN   4060<<ASSIGN   4067<<ASSIGN   4092<<ASSIGN   4129<<ASSIGN
      4136<<ASSIGN   4159<<ASSIGN   4170<<ASSIGN   4191<<ASSIGN   4335<<ASSIGN
DISK_LEN
      3388**DCL      4007<<ASSIGN   4037<<ASSIGN   4061<<ASSIGN   4068<<ASSIGN   4091<<ASSIGN   4130<<ASSIGN
      4137<<ASSIGN   4160<<ASSIGN   4171<<ASSIGN   4189>>ASSIGN   4190>>ASSIGN   4336<<ASSIGN
DISK_RETRIES
      3389**DCL      4001<<ASSIGN   4056>>ASSIGN   4057<<ASSIGN   4063>>ASSIGN   4064<<ASSIGN   4073>>ASSIGN
      4076>>ASSIGN   4077<<ASSIGN   4318>>ASSIGN
DISK_SECTOR_NO
      3388**DCL      4016<<ASSIGN
DISK_SEC_SIZE
      3389**DCL      4017<<ASSIGN   4333>>ASSIGN
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:90   
DISK_SIDE
      3389**DCL      4019<<ASSIGN   4034<<DOINDEX  4094<<DOINDEX  4121<<DOINDEX  4152<<ASSIGN   4162<<ASSIGN
      4167<<ASSIGN   4331>>ASSIGN
DISK_TRACK_NO
      3389**DCL      4018<<ASSIGN   4033<<DOINDEX  4033>>DOINDEX  4035>>ASSIGN   4093<<DOINDEX  4093>>DOINDEX
      4095>>ASSIGN   4122<<DOINDEX  4133<<DOINDEX  4151<<DOINDEX  4330>>ASSIGN
DO_VERFY
      4391**PROC     4039--CALL     4070--CALL     4138--CALL     4172--CALL     4192--CALL
DO_VINIT
      4326**PROC     4036--CALL     4055--CALL     4126--CALL     4156--CALL     4166--CALL
DO_WRITE
      4346**PROC     4062--CALL     4105--CALL     4131--CALL     4161--CALL     4188--CALL
FINIS
      4296**LABEL    4278--GOTO
FIRST_SECTOR
      3950**DCL      4031<<ASSIGN   4032>>ASSIGN   4053<<ASSIGN   4054>>ASSIGN   4089<<ASSIGN   4090>>ASSIGN
      4124<<ASSIGN   4125>>ASSIGN   4154<<ASSIGN   4155>>ASSIGN   4164<<ASSIGN   4165>>ASSIGN   4328>>DOINDEX
      4328>>DOINDEX  4329>>ASSIGN
FROBOZZ
      4141**LABEL    4131--CALLALT  4138--CALLALT
GOOD_COMPLETION
      4289**LABEL    4044--GOTO     4078--GOTO     4110--GOTO     4147--GOTO     4179--GOTO     4198--GOTO
      4224--GOTO
HOST_BUF$
      3388**DCL      3588--IMP-PTR  4006>>ASSIGN   4008>>ASSIGN   4012>>ASSIGN   4016>>ASSIGN   4017>>ASSIGN
      4018>>ASSIGN   4019>>ASSIGN   4020>>ASSIGN   4024>>DOCASE   4027>>ASSIGN   4031>>ASSIGN   4032>>ASSIGN
      4033>>DOINDEX  4034>>DOINDEX  4034>>DOINDEX  4035>>ASSIGN   4037>>ASSIGN   4043>>ASSIGN   4047>>ASSIGN
      4049>>ASSIGN   4053>>ASSIGN   4054>>ASSIGN   4056>>ASSIGN   4059>>ASSIGN   4063>>ASSIGN   4073>>ASSIGN
      4076>>ASSIGN   4085>>ASSIGN   4089>>ASSIGN   4090>>ASSIGN   4091>>ASSIGN   4093>>DOINDEX  4094>>DOINDEX
      4094>>DOINDEX  4095>>ASSIGN   4096>>ASSIGN   4099>>CALL     4103>>ASSIGN   4109>>ASSIGN   4113>>ASSIGN
      4115>>ASSIGN   4118>>ASSIGN   4119>>ASSIGN   4121>>DOINDEX  4122>>DOINDEX  4124>>ASSIGN   4125>>ASSIGN
      4128>>ASSIGN   4133>>DOINDEX  4142>>ASSIGN   4142>>ASSIGN   4146>>IF       4151>>DOINDEX  4154>>ASSIGN
      4155>>ASSIGN   4158>>ASSIGN   4162>>ASSIGN   4164>>ASSIGN   4165>>ASSIGN   4176>>ASSIGN   4176>>ASSIGN
      4184>>ASSIGN   4193>>IF       4195>>ASSIGN   4201>>ASSIGN   4207>>DOCASE   4209>>CALL     4214>>CALL
      4219>>CALL     4227>>ASSIGN   4229>>ASSIGN   4231>>ASSIGN   4233>>ASSIGN   4235>>ASSIGN   4236>>ASSIGN
      4237>>CALL     4241>>ASSIGN   4244>>ASSIGN   4248>>ASSIGN   4252>>ASSIGN   4255>>CALL     4257>>ASSIGN
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:91   
      4262>>ASSIGN   4265>>CALL     4266>>ASSIGN   4267>>CALL     4270>>ASSIGN   4284>>ASSIGN   4289>>ASSIGN
      4293>>ASSIGN   4299>>CALL     4301>>ASSIGN   4318>>ASSIGN   4319>>ASSIGN   4361>>IF       4368>>ASSIGN
      4378>>CALL
HOST_MES_LEN
      3388**DCL      4320<<ASSIGN
I
      3889**DCL      4069<<DOINDEX  4230<<DOINDEX  4231>>ASSIGN   4231>>ASSIGN   4232>>ASSIGN   4233>>ASSIGN
      4234>>ASSIGN   4235>>ASSIGN   4236>>ASSIGN   4237>>CALL     4237>>CALL     4241>>ASSIGN   4329<<ASSIGN
      4330>>ASSIGN   4331>>ASSIGN   4332>>ASSIGN   4333>>ASSIGN   4360<<DOINDEX  4361>>IF       4364>>ASSIGN
I IN PROCEDURE PERFORM_SEQUENCE
      4375**DCL      4376<<ASSIGN   4377>>DOWHILE  4378>>CALL     4382<<ASSIGN   4382>>ASSIGN
IN$DATA.DCHAR
      3961**DCL      4193>>IF
IN$DATA.DUBIN
      3960**DCL      3961--REDEF
IN_DISK_BUF$
      3390**DCL      3959--IMP-PTR  4191>>ASSIGN   4193>>IF
IN_DISK_MES_LEN
      3390**DCL      3961--IMP-SIZ  4066<<ASSIGN   4068>>ASSIGN   4135<<ASSIGN   4137>>ASSIGN   4169<<ASSIGN
      4171>>ASSIGN   4190<<ASSIGN   4193>>IF
J
      3948**DCL      4328<<DOINDEX  4329>>ASSIGN   4332>>ASSIGN
KH_CHNHI
      3171**DCL      3172--REDEF
KH_CHNLOW
      3172**DCL      3173--REDEF
KOE$HOST_EVENT
         7**PROC     3965--DCLINIT
KOH$HOST_IO
      3848**DCL-ENT  4321--CALL
KOP$CHECK_STATUS
      3857**DCL-ENT  4267--CALL     4299--CALL
KOP$GET_STATUS
      3860**DCL-ENT  4237--CALL     4255--CALL     4265--CALL
KOP$INITIALIZE
      3866**DCL-ENT  4264--CALL
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:92   
KOP$PHYS_IO
      3869**DCL-ENT  4099--CALL     4209--CALL     4214--CALL     4219--CALL     4378--CALL
KO_CHANNEL
      3157**DCL      4099<>CALL     4209<>CALL     4214<>CALL     4219<>CALL     4255<>CALL     4264<>CALL
      4265<>CALL     4364<<ASSIGN   4378<>CALL
KO_DRIVE
      3157**DCL      4012<<ASSIGN   4096<<ASSIGN   4103<<ASSIGN
KO_OPENED
      3157**DCL      4029>>IF       4050>>IF       4087>>IF       4116>>IF       4185>>IF       4202>>IF
      4249>>IF       4258<<ASSIGN   4272<<ASSIGN
KP_MSG.CER2_RQS.SECTOR_HI
      3636**DCL      4125>>ASSIGN   4155>>ASSIGN   4165>>ASSIGN
KP_MSG.CER2_RQS.SIDE_HI
      3637**DCL      4121>>DOINDEX  4146>>IF       4162>>ASSIGN
KP_MSG.CER2_RQS.TRACK_HI
      3638**DCL      4122>>DOINDEX  4133>>DOINDEX  4151>>DOINDEX
KP_MSG.CER2_RSP
      3640**DCL      4114--ASSIGN   4115<<ASSIGN
KP_MSG.CER2_RSP.CROSSTALK
      3642**DCL      4142<<ASSIGN   4142>>ASSIGN
KP_MSG.CER2_RSP.PRINTTHROUGH
      3641**DCL      4176<<ASSIGN   4176>>ASSIGN
KP_MSG.CER2_RSP.SPARE
      3643**DCL      4114--ASSIGN
KP_MSG.CHECK_RSP
      3621**DCL      4228--ASSIGN   4229<<ASSIGN
KP_MSG.CHECK_RSP.DRIVE.CHAN
      3631**DCL      4235<<ASSIGN
KP_MSG.CHECK_RSP.DRIVE.DEV_STATUS
      3625**DCL      4237<>CALL
KP_MSG.CHECK_RSP.DRIVE.NUMBER
      3623**DCL      4231<<ASSIGN
KP_MSG.CHECK_RSP.DRIVE.OPERATION_STATUS
      3624**DCL      4236<<ASSIGN   4241<<ASSIGN
KP_MSG.CHECK_RSP.DRIVE.TYPE
      3628**DCL      4233<<ASSIGN
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:93   
KP_MSG.CHECK_RSP.SPARE
      3634**DCL      4228--ASSIGN
KP_MSG.CLONE_RQS.DEST_DRIVE
      3648**DCL      4103>>ASSIGN
KP_MSG.CLONE_RQS.SECTOR_HI
      3645**DCL      4090>>ASSIGN
KP_MSG.CLONE_RQS.SIDE_HI
      3646**DCL      4094>>DOINDEX
KP_MSG.CLONE_RQS.TRACK_HI
      3647**DCL      4093>>DOINDEX
KP_MSG.CRTFY_RQS.SECTOR_HI
      3651**DCL      4032>>ASSIGN   4054>>ASSIGN
KP_MSG.CRTFY_RSP
      3653**DCL      4048--ASSIGN   4049<<ASSIGN
KP_MSG.CRTFY_RSP.READ_DATA_ERRORS
      3657**DCL      4073<<ASSIGN
KP_MSG.CRTFY_RSP.READ_RETRIES
      3656**DCL      4076<<ASSIGN
KP_MSG.CRTFY_RSP.SPARE
      3658**DCL      4048--ASSIGN
KP_MSG.CRTFY_RSP.VINIT_RETRIES
      3654**DCL      4056<<ASSIGN
KP_MSG.CRTFY_RSP.WRITE_RETRIES
      3655**DCL      4063<<ASSIGN
KP_MSG.HEAD
      3589**DCL      4320--ASSIGN
KP_MSG.HEAD.DEV_STATUS
      3594**DCL      4099<>CALL     4209<>CALL     4214<>CALL     4219<>CALL     4255<>CALL     4265<>CALL
      4267<>CALL     4299<>CALL     4378<>CALL
KP_MSG.HEAD.DRIVE_NO
      3591**DCL      4012>>ASSIGN   4096>>ASSIGN   4361>>IF
KP_MSG.HEAD.IOTYPE
      3592**DCL      4207>>DOCASE
KP_MSG.HEAD.MSG_TYPE
      3590**DCL      4024>>DOCASE   4027<<ASSIGN   4043<<ASSIGN   4047<<ASSIGN   4085<<ASSIGN   4109<<ASSIGN
      4113<<ASSIGN   4184<<ASSIGN   4195<<ASSIGN   4201<<ASSIGN   4227<<ASSIGN   4248<<ASSIGN   4262<<ASSIGN
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:94   
KP_MSG.HEAD.NUM_BYTES
      3597**DCL      4006>>ASSIGN   4284<<ASSIGN   4319<<ASSIGN
KP_MSG.HEAD.OPERATION_STATUS
      3593**DCL      4020<<ASSIGN   4244<<ASSIGN   4252<<ASSIGN   4257<<ASSIGN   4266<<ASSIGN   4270<<ASSIGN
      4289<<ASSIGN   4293<<ASSIGN   4301<<ASSIGN   4368<<ASSIGN
KP_MSG.HEAD.RETRIES
      3608**DCL      4318<<ASSIGN
KP_MSG.HEAD.SECTOR_NO
      3606**DCL      4016>>ASSIGN   4031>>ASSIGN   4053>>ASSIGN   4089>>ASSIGN   4124>>ASSIGN   4154>>ASSIGN
      4164>>ASSIGN
KP_MSG.HEAD.SEC_SIZE
      3607**DCL      4017>>ASSIGN   4037>>ASSIGN   4059>>ASSIGN   4091>>ASSIGN   4128>>ASSIGN   4158>>ASSIGN
KP_MSG.HEAD.SIDE
      3604**DCL      4019>>ASSIGN   4034>>DOINDEX  4094>>DOINDEX  4119>>ASSIGN
KP_MSG.HEAD.TRACK_NO
      3605**DCL      4018>>ASSIGN   4035<<ASSIGN   4095<<ASSIGN   4118>>ASSIGN
KP_MSG.TDATA
      3614**DCL      3615--REDEF    3616--REDEF    3621--REDEF    3635--REDEF    3640--REDEF    3644--REDEF
      3650--REDEF    3653--REDEF    4008--ASSIGN   4193--IF
KP_MSG.VINIT_RQS.SIDE_HI
      3619**DCL      4034>>DOINDEX
KP_MSG.VINIT_RQS.TRACK_HI
      3618**DCL      4033>>DOINDEX
LO_SIDE
      3954**DCL      4119<<ASSIGN   4121>>DOINDEX  4146>>IF       4152>>ASSIGN   4167>>ASSIGN
LO_TRACK
      3953**DCL      4118<<ASSIGN   4122>>DOINDEX  4133>>DOINDEX  4151>>DOINDEX
MSG_DSIZE
      3890**DCL      3891--REDEF    4007>>ASSIGN   4028<<ASSIGN   4048<<ASSIGN   4086<<ASSIGN   4114<<ASSIGN
      4196<<ASSIGN   4228<<ASSIGN   4285<<ASSIGN   4297<<ASSIGN   4320>>ASSIGN
MSG_DSIZE_
      3891**DCL      4006<<ASSIGN   4319>>ASSIGN
NOT_OPENED
      4251**LABEL    4030--GOTO     4051--GOTO     4088--GOTO     4117--GOTO     4186--GOTO     4203--GOTO
NO_CLS_STAT
      4249**LABEL    4255--CALLALT
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:95   
NUM_SECTORS
      3949**DCL      4032<<ASSIGN   4037>>ASSIGN   4054<<ASSIGN   4059>>ASSIGN   4090<<ASSIGN   4091>>ASSIGN
      4125<<ASSIGN   4128>>ASSIGN   4155<<ASSIGN   4158>>ASSIGN   4165<<ASSIGN   4327>>ASSIGN   4328>>DOINDEX
OOPS IN PROCEDURE DO_VERFY
      4393**LABEL    4392--CALLALT
OOPS IN PROCEDURE DO_VINIT
      4336**LABEL    4337--CALLALT
OOPS IN PROCEDURE DO_WRITE
      4348**LABEL    4347--CALLALT
OOPS IN PROCEDURE PERFORM_SEQUENCE
      4378**LABEL    4378--CALLALT
OP_LIST IN PROCEDURE PERFORM_SEQUENCE
      4374**DCL      4373--PROC     4377>>DOWHILE  4378<>CALL
OUT$DATA.DCHAR
      3964**DCL      4071>>IF       4139>>IF       4173>>IF       4193>>IF
OUT$DATA.DUBIN
      3963**DCL      3964--REDEF    4330<<ASSIGN   4331<<ASSIGN   4332<<ASSIGN   4333<<ASSIGN
OUT_DISK_BUF$
      3391**DCL      3962--IMP-PTR  4038>>ASSIGN   4067>>ASSIGN   4071>>IF       4092>>ASSIGN   4136>>ASSIGN
      4139>>IF       4170>>ASSIGN   4173>>IF       4330>>ASSIGN   4331>>ASSIGN   4332>>ASSIGN   4333>>ASSIGN
      4335>>ASSIGN
OUT_DISK_MES_LEN
      3390**DCL      3964--IMP-SIZ  3968--IMP-SIZ  4059<<ASSIGN   4061>>ASSIGN   4066>>ASSIGN   4071>>IF
      4071>>IF       4128<<ASSIGN   4130>>ASSIGN   4135>>ASSIGN   4139>>IF       4139>>IF       4158<<ASSIGN
      4160>>ASSIGN   4169>>ASSIGN   4173>>IF       4173>>IF       4189<<ASSIGN   4193>>IF       4327<<ASSIGN
      4336>>ASSIGN
PACK
      3894**DCL      3895--REDEF    3923--REDEF    4232<<ASSIGN   4234<<ASSIGN
PACK_
      3895**DCL      4233>>ASSIGN   4235>>ASSIGN
PERFORM_SEQUENCE
      4373**PROC     4098--CALL     4205--CALL     4337--CALL     4347--CALL     4392--CALL
PICK_DRIVE
      4356**PROC     4097--CALL     4104--CALL     4187--CALL     4204--CALL     4263--CALL
PIGLET_SEGMENT.BASE
      3508**DCL      3508--REDEF
PL6.E3A0      #001=KOE$HOST_EVENT File=KOE$EVENT.:E05TSI                         WED 07/30/97 01:13 Page:96   
READ_LIST
      3973**DCL      4098<>CALL     4205<>CALL
SENDIT
      4296**LABEL    4245--GOTO     4286--GOTO
SEND_HEAD_ONLY
      4277**LABEL    4097--CALLALT  4104--CALLALT  4187--CALLALT  4204--CALLALT  4253--GOTO     4259--GOTO
      4263--CALLALT  4273--GOTO
SEND_MSG
      4317**PROC     4041--CALL     4107--CALL     4304--CALL
SEND_STATUS
      4293**LABEL    4181--GOTO     4188--CALLALT  4192--CALLALT
SEND_STATUS_ONLY
      4284**LABEL    4036--CALLALT  4039--CALLALT  4290--GOTO
TEST$DATA.DCHAR
      3968**DCL      4071>>IF       4139>>IF       4173>>IF
TEST_DATA$
      3966**DCL      3967--IMP-PTR  4060>>ASSIGN   4071>>IF       4129>>ASSIGN   4139>>IF       4159>>ASSIGN
      4173>>IF
TEST_DATA$$
      3965**DCL      3966--REDEF
THINGS_ARE_ROSY
      3443**DCL      4276<<ASSIGN
TOP_DEVICE
      3761**DCL      4230>>DOINDEX  4360>>DOINDEX
TROUBLE
      4296**LABEL    4304--CALLALT
UNINTENTIONAL
      4179**LABEL    4126--CALLALT  4156--CALLALT  4166--CALLALT
VERFY_LIST
      3993**DCL      4392<>CALL
VINIT_LIST
      3979**DCL      4337<>CALL
WRITE_LIST
      3986**DCL      4347<>CALL

PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:97   
      489        1        /*T***********************************************************/
      490        2        /*T*                                                         */
      491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      492        4        /*T*                                                         */
      493        5        /*T***********************************************************/
      494        6        KOE$DEVICE_EVENT: PROC ALTRET;
      495        7        /**/
      496        8        /*  KOE$DEVICE_EVENT                                                          */
      497        9        /*   This routine is called when a device event is detected.                  */
      498       10        /**/
      499       11        /**/
      500       12        /*  INCLUDE FILES  */
      501       13        /**/
      502       14        %INCLUDE KO_DATA_R;
      503     3761        /**/
      504     3762        /*  ENTRY DCLS  */
      505     3763        /**/
      506     3764        %KO_ENTRIES (OMIT=KOE$DEVICE_EVENT);
      507     3820        /**/
      508     3821        /*  AUTO DATA  */
      509     3822        /**/
      510     3823        /**/
      511     3824        /*  THE CODE  */
      512     3825        /**/
      513     3826        %EJECT;
PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:98   
      514     3827    1             RETURN;
      515     3828        /**/
      516     3829    1             END KOE$DEVICE_EVENT;
      517     3830        %EOD;

PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:99   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH_CHN.:E05TOU  is referenced.
   KP_MSG.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KO_SUBS.:E05TOU  is referenced.
   KO_MACRO_C.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KOE$DEVICE_EVENT.

   Procedure KOE$DEVICE_EVENT requires 8 words for executable code.
   Procedure KOE$DEVICE_EVENT requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:100  

 Object Unit name= KOE$DEVICE_EVENT                           File name= KOE$EVENT.:E05TOU
 UTS= JUL 30 '97 01:14:37.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$HOST
    1   Proc  even  none     8      8  KOE$DEVICE_EVENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  KOE$DEVICE_EVENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KH_CHNHI                              KH_CHNLOW                             HOST_BUF$
     M$HOST                           r    G$ROS$
PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:101  


      489        1        /*T***********************************************************/
      490        2        /*T*                                                         */
      491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      492        4        /*T*                                                         */
      493        5        /*T***********************************************************/
      494        6        KOE$DEVICE_EVENT: PROC ALTRET;

      6   1 000000  D380 0000 0000  xent KOE$DEVICE_EVENTLNJ,B5   X6A_AUTO_0
          1 000003       0004 0000                       DC       4,0

      495        7        /**/
      496        8        /*  KOE$DEVICE_EVENT                                                          */
      497        9        /*   This routine is called when a device event is detected.                  */
      498       10        /**/
      499       11        /**/
      500       12        /*  INCLUDE FILES  */
      501       13        /**/
      502       14        %INCLUDE KO_DATA_R;
      503     3761        /**/
      504     3762        /*  ENTRY DCLS  */
      505     3763        /**/
      506     3764        %KO_ENTRIES (OMIT=KOE$DEVICE_EVENT);
      507     3820        /**/
      508     3821        /*  AUTO DATA  */
      509     3822        /**/
      510     3823        /**/
      511     3824        /*  THE CODE  */
      512     3825        /**/
      513     3826        %EJECT;
PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:102  
      514     3827    1             RETURN;

   3827   1 000005  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      515     3828        /**/
      516     3829    1             END KOE$DEVICE_EVENT;
      517     3830        %EOD;

PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:103  
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH_CHN.:E05TOU  is referenced.
   KP_MSG.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KO_SUBS.:E05TOU  is referenced.
   KO_MACRO_C.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KOE$DEVICE_EVENT.
PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:104  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HOST_BUF$


   Procedure KOE$DEVICE_EVENT requires 8 words for executable code.
   Procedure KOE$DEVICE_EVENT requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:105  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KOE$DEVICE_EVENT File=KOE$EVENT.:E05TSI                       WED 07/30/97 01:14 Page:106  
          MINI XREF LISTING

HOST_BUF$
      3387**DCL      3587--IMP-PTR
KH_CHNHI
      3170**DCL      3171--REDEF
KH_CHNLOW
      3171**DCL      3172--REDEF
KP_MSG.TDATA
      3613**DCL      3614--REDEF    3615--REDEF    3620--REDEF    3634--REDEF    3639--REDEF    3643--REDEF
      3649--REDEF    3652--REDEF
PIGLET_SEGMENT.BASE
      3507**DCL      3507--REDEF

PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:107  
      518        1        /*T***********************************************************/
      519        2        /*T*                                                         */
      520        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      521        4        /*T*                                                         */
      522        5        /*T***********************************************************/
      523        6        KOE$NA_EVENT: PROC(ADMIN_FPT) ALTRET;
      524        7        /**/
      525        8        /*  KOE$NA_EVENT                                                              */
      526        9        /*   This routine is called for events from Node-Admin.                       */
      527       10        /**/
      528       11        /**/
      529       12        /*  INCLUDE FILES  */
      530       13        /**/
      531       14        %INCLUDE KO_DATA_R;
      532     3761        %INCLUDE KHA_FNC_E;
      533     3861        /**/
      534     3862        /*  ENTRY DCLS  */
      535     3863        /**/
      536     3864        %KO_ENTRIES (OMIT=KOE$NA_EVENT);
      537     3920        /**/
      538     3921        /*  PARAMETERS  */
      539     3922        /**/
      540     3923        %KH$ADMIN_FPT (FPTN=ADMIN_FPT,STCLASS=PARAM);
      541     4134        %EJECT;
PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:108  
      542     4135        /**/
      543     4136        /*  ADMIN_FPT.CHN$->KH$CHN is channel context                                 */
      544     4137        /*  ADMIN_FPT.FNC is the function code from Node-Admin                        */
      545     4138        /**/
      546     4139    2          DO CASE(ADMIN_FPT.FNC);
      547     4140    2             CASE(%KHA_FNC_ENABLE);
      548     4141    2                ;                          /* ENABLE request                     */
      549     4142    2             CASE(%KHA_FNC_DISABLE,%KHA_FNC_KILL,%KHA_FNC_DISCONNECT_RQS);
      550     4143    2                ;                          /* Some flavor of DISCONNECT          */
      551     4144    2             CASE(%KHA_FNC_REQSTATS);
      552     4145    2                GOTO ALT;                  /* Request for STATS                  */
      553     4146    2             CASE(%KHA_FNC_DVCERRRSP);
      554     4147    2                ;                          /* Device error, tell operator?       */
      555     4148    2             END;                          /* CASE CODE */
      556     4149    1          RETURN;
      557     4150        /**/
      558     4151    1   ALT:   ;
      559     4152               /*N* ADMIN_FPT.RESULTS = error code; */
      560     4153    1          ALTRETURN;
      561     4154        /**/
      562     4155    1          END KOE$NA_EVENT;

PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:109  
--  Include file information  --

   KHA_FNC_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH_CHN.:E05TOU  is referenced.
   KP_MSG.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KO_SUBS.:E05TOU  is referenced.
   KO_MACRO_C.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KOE$NA_EVENT.

   Procedure KOE$NA_EVENT requires 30 words for executable code.
   Procedure KOE$NA_EVENT requires 6 words of local(AUTO) storage.

    No errors detected in file KOE$EVENT.:E05TSI    .

PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:110  

 Object Unit name= KOE$NA_EVENT                               File name= KOE$EVENT.:E05TOU
 UTS= JUL 30 '97 01:14:59.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$HOST
    1   Proc  even  none    30     1E  KOE$NA_EVENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KOE$NA_EVENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
                       nStd      0 X6A_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KH_CHNHI                              KH_CHNLOW                             HOST_BUF$
     M$HOST                           r    G$ROS$
PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:111  


      518        1        /*T***********************************************************/
      519        2        /*T*                                                         */
      520        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      521        4        /*T*                                                         */
      522        5        /*T***********************************************************/
      523        6        KOE$NA_EVENT: PROC(ADMIN_FPT) ALTRET;

      6   1 000000  D380 0000 0000  xent KOE$NA_EVENT    LNJ,B5   X6A_AUTO_1
          1 000003       0006 0001                       DC       6,1

      524        7        /**/
      525        8        /*  KOE$NA_EVENT                                                              */
      526        9        /*   This routine is called for events from Node-Admin.                       */
      527       10        /**/
      528       11        /**/
      529       12        /*  INCLUDE FILES  */
      530       13        /**/
      531       14        %INCLUDE KO_DATA_R;
      532     3761        %INCLUDE KHA_FNC_E;
      533     3861        /**/
      534     3862        /*  ENTRY DCLS  */
      535     3863        /**/
      536     3864        %KO_ENTRIES (OMIT=KOE$NA_EVENT);
      537     3920        /**/
      538     3921        /*  PARAMETERS  */
      539     3922        /**/
      540     3923        %KH$ADMIN_FPT (FPTN=ADMIN_FPT,STCLASS=PARAM);
      541     4134        %EJECT;
PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:112  
      542     4135        /**/
      543     4136        /*  ADMIN_FPT.CHN$->KH$CHN is channel context                                 */
      544     4137        /*  ADMIN_FPT.FNC is the function code from Node-Admin                        */
      545     4138        /**/
      546     4139    2          DO CASE(ADMIN_FPT.FNC);

   4139   1 000005  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 000007  B806                                 LDR,R3   ,B6
          1 000008  3D05                                 CMV,R3   5
          1 000009  0281 000E                            BGE      s:4149,PREL
          1 00000B  A830 0000 0011  01                   LDR,R2   s:4139+12,R3
          1 00000E  83A0 0000 0016  01                   JMP      s:4145,R2
          1 000011       0002                            DC       s:4149,PREL
          1 000012       0002                            DC       s:4149,PREL
          1 000013       0002                            DC       s:4149,PREL
          1 000014       0002                            DC       s:4149,PREL
          1 000015       0000                            DC       s:4145,PREL

      547     4140    2             CASE(%KHA_FNC_ENABLE);

      548     4141    2                ;                          /* ENABLE request                     */
      549     4142    2             CASE(%KHA_FNC_DISABLE,%KHA_FNC_KILL,%KHA_FNC_DISCONNECT_RQS);

      550     4143    2                ;                          /* Some flavor of DISCONNECT          */
      551     4144    2             CASE(%KHA_FNC_REQSTATS);

      552     4145    2                GOTO ALT;                  /* Request for STATS                  */

   4145   1 000016  0F81 0004                            B        s:4139,PREL

      553     4146    2             CASE(%KHA_FNC_DVCERRRSP);

      554     4147    2                ;                          /* Device error, tell operator?       */
      555     4148    2             END;                          /* CASE CODE */

      556     4149    1          RETURN;

PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:113  
   4149   1 000018  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

   4139   1                              ALT             null
      557     4150        /**/
      558     4151    1   ALT:   ;
      559     4152               /*N* ADMIN_FPT.RESULTS = error code; */
      560     4153    1          ALTRETURN;

   4153   1 00001B  C380 0000 0000  xent ALT             LNJ,B4   X6A_AALT
      561     4154        /**/
      562     4155    1          END KOE$NA_EVENT;

PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:114  
--  Include file information  --

   KHA_FNC_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH_CHN.:E05TOU  is referenced.
   KP_MSG.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KO_SUBS.:E05TOU  is referenced.
   KO_MACRO_C.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KOE$NA_EVENT.
PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:115  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ADMIN_FPT                *0-0-0/w STRC(288)   r     1 ADMIN_FPT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HOST_BUF$


   Procedure KOE$NA_EVENT requires 30 words for executable code.
   Procedure KOE$NA_EVENT requires 6 words of local(AUTO) storage.

    No errors detected in file KOE$EVENT.:E05TSI    .
PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:116  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KOE$NA_EVENT File=KOE$EVENT.:E05TSI                           WED 07/30/97 01:14 Page:117  
          MINI XREF LISTING

ADMIN_FPT
      3938**DCL         6--PROC
ADMIN_FPT.FNC
      3939**DCL      4139>>DOCASE
ADMIN_FPT.TERMID.TERM
      3962**DCL      3971--REDEF
ALT
      4139**LABEL    4145--GOTO
HOST_BUF$
      3387**DCL      3587--IMP-PTR
KH_CHNHI
      3170**DCL      3171--REDEF
KH_CHNLOW
      3171**DCL      3172--REDEF
KP_MSG.TDATA
      3613**DCL      3614--REDEF    3615--REDEF    3620--REDEF    3634--REDEF    3639--REDEF    3643--REDEF
      3649--REDEF    3652--REDEF
PIGLET_SEGMENT.BASE
      3507**DCL      3507--REDEF
