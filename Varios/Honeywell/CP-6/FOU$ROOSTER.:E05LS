VERSION E05

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:1    
        1        1        /*M* FOU$ROOSTER Device route routines for OUTSYM ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:        FOU$ROOSTER
       10       10             PURPOSE:     To handle route operations for OUTSYM
       11       11             DESCRIPTION: FOU$ROOSTER (ROute Output Symbiont TERminals)
       12       12                          handles all route specific code used to set up
       13       13                          alternate print paths. */
       14       14        /**/
       15       15        /**/
       16       16        FOU$ROOSTER: PROC (EVENT,DINFO) ALTRET;
       17       17
       18       18
       19       19
       20       20        /**/
       21       21        /* PARAMETERS */
       22       22        /**/
       23       23    1   DCL EVENT UBIN WORD;
       24       24    1   DCL DINFO UBIN WORD;
       25       25    1   DCL KEYIN$ REDEF DINFO PTR;
       26       26        /**/
       27       27        /* INCLUDES */
       28       28        /**/
       29       29        %INCLUDE CP_6;
       30      110        %INCLUDE FO_ERRORS_C;
       31      142        %INCLUDE KL_SUPER_C;
       32     3044        %INCLUDE OC_SUBS_C;
       33     3775        %INCLUDE FS$FIT;
       34     3818        %INCLUDE FOO_SUBS_C;
       35     4054        %INCLUDE FOO_MAC_C;
       36     4802        %INCLUDE FOO_DATA_R;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:2    
       37     5968        %INCLUDE FO_SCODE_C;
       38     5996        %INCLUDE OC_MESSHD_C;
       39     6049        %INCLUDE F_ERRORS_C;
       40     6289
       41     6290    1   DCL FOI$GBUF ENTRY(2) ALTRET;
       42     6291    1   DCL FOD$AVAIL ENTRY   ALTRET;
       43     6292
       44     6293        /**/
       45     6294        /* BASED STRUCTURES */
       46     6295        /**/
       47     6296        %B$TCB (STCLASS="BASED(B$TCB$)");
       48     6299        %B$ALT;
       49     6307        /**/
       50     6308        /**/
       51     6309        /* REFS */
       52     6310    1   DCL B$TCB$ PTR SYMREF;
       53     6311    1   DCL B$JIT$ PTR SYMREF;
       54     6312        /* AUTO */
       55     6313        /**/
       56     6314    1   DCL I UBIN WORD;
       57     6315    1   DCL J UBIN WORD;
       58     6316    1   DCL K SBIN WORD;
       59     6317    1   DCL ROUTE_TALLY UBIN WORD;
       60     6318    1   DCL ROUTE_COMPLETE BIT(1);
       61     6319    1   DCL BLOCK_TYPE BIT(1);
       62     6320    1   DCL WSN$ PTR;
       63     6321    1   DCL WSNLNK$ PTR;
       64     6322    1   DCL FROM_WSN$ PTR;
       65     6323    1   DCL TO_WSN$ PTR;
       66     6324    1   DCL NEW_BLOCK$ PTR;
       67     6325    1   DCL K$ PTR;
       68     6326    1   DCL P$ PTR;
       69     6327    1   DCL P_WSN$ PTR;
       70     6328    1   DCL PP$ PTR;
       71     6329    1   DCL PP_WSN$ PTR;
       72     6330    1   DCL SAV$ PTR;
       73     6331    1   DCL 1 ERROR ALIGNED STATIC,
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:3    
       74     6332    1         2 FCG BIT(18),
       75     6333    1         2 MON BIT(1) UNAL,
       76     6334    1         2 ERR# UBIN(14) UNAL,
       77     6335    1         2 SEV UBIN(3) UNAL;
       78     6336        /**/
       79     6337        /* STATIC */
       80     6338    1   DCL KEY_BUF UBIN WORD STATIC INIT(0);
       81     6339    1   DCL KEY_ZERO UBIN WORD STATIC INIT(0);
       82     6340
       83     6341    1   DCL M$OSYMB DCB;
       84     6342    1   DCL M$CSCG DCB;
       85     6343
       86     6344        %OC_MESSHD_D                  (NAME=OPMSG_ROUTE,
       87     6345                 NPARMS= 5,
       88     6346                 ATR=M_UR,
       89     6347                 MSG=FO_RTE_MSG#,
       90     6348                 STCLASS=STATIC);
       91     6361    1         2 * UBIN BYTE UNAL INIT(1),
       92     6362    1         2 * UBIN BYTE UNAL INIT(2),
       93     6363    1         2 * UBIN BYTE UNAL INIT(2),
       94     6364    1         2 * UBIN BYTE UNAL INIT(8),
       95     6365    1         2 * UBIN BYTE UNAL INIT(8),
       96     6366    1         2 SUBC UBIN BYTE UNAL,
       97     6367    1         2 TYP1 CHAR(2) UNAL,
       98     6368    1         2 NUM1 CHAR(2) UNAL,
       99     6369    1         2 TNAME1 CHAR(8) UNAL,
      100     6370    1         2 WSN CHAR(8) UNAL;
      101     6371
      102     6372           %FPT_WRITE                      (FPTN = OCMSG_ROUTE,
      103     6373                STCLASS = CONSTANT,
      104     6374                DCB = M$CSCG,
      105     6375                BUF = OPMSG_ROUTE );
      106     6406           %FPT_WRITE                      (FPTN = WRITE_OSYMB,
      107     6407                STCLASS = STATIC,
      108     6408                DCB     = M$OSYMB,
      109     6409                KEY     = FO_OSYMBKEY,
      110     6410                BUF     = FO_OSYMBUF,
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:4    
      111     6411                ONEWKEY = YES );
      112     6442
      113     6443           %FPT_READ                      ( FPTN = READ_OSYMB,
      114     6444                STCLASS = CONSTANT,
      115     6445                DCB     = M$OSYMB,
      116     6446                KEY     = FO_OSYMBKEY,
      117     6447                KEYS    = NO,
      118     6448                BUF     = FO_OSYMBUF,
      119     6449                KEYR    = YES );
      120     6488           %FPT_TRUNC                     ( FPTN = TRUNC_OSYMB,
      121     6489                DCB     = M$OSYMB,
      122     6490                STCLASS = CONSTANT );
      123     6504           %FPT_PFIL                      ( FPTN = FIRST_RECORD,
      124     6505                DCB     = M$OSYMB,
      125     6506                BOF     = YES,
      126     6507                STCLASS = CONSTANT );
      127     6522
      128     6523        %SUB DEV$=FO_DEV$;
      129     6524        %SUB FIL$=FO_FIL$;
      130     6525        /*F* NAME:          FOU$ROUTE
      131     6526             PURPOSE:       To schedule output symbiont route changes
      132     6527             DESCRIPTION:   FOU$EVENT takes the form of an event reporting
      133     6528                            routine.  All events applicable to output routing
      134     6529                            are reported here, with the result that the
      135     6530                            appropriate routing functions are performed.
      136     6531
      137     6532                            The parameters are the event code (EVENT) and
      138     6533                            information specific to events (DINFO).  For
      139     6534                            example, DINFO will generally be the pointer
      140     6535                            to the route keyin block.  */
      141     6536
      142     6537    1   FOU$EVENT: ENTRY (EVENT,DINFO) ALTRET;
      143     6538
      144     6539        /**
      145     6540         **
      146     6541         **     ROUTE KEYIN EVENT
      147     6542         **
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:5    
      148     6543         **/
      149     6544        /*   Order: Route,
      150     6545                    Unroute */
      151     6546        /**/
      152     6547    1         OPMSG_ROUTE.CADDR = KEYIN$ -> FO$RKEYIN.CADDR;
      153     6548
      154     6549    1         CALL M$PFIL (FIRST_RECORD)
      155     6550    2         WHENALTRETURN DO;
      156     6551    2           ALTRETURN;
      157     6552    2           END;
      158     6553
      159     6554    2           DO CASE (KEYIN$ -> FO$RKEYIN.KIN#);
      160     6555        /**
      161     6556         **
      162     6557         **   Route
      163     6558         **
      164     6559         **/
      165     6560    2             CASE (KEY_ROUTE#);
      166     6561
      167     6562
      168     6563
      169     6564
      170     6565    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '
      171     6566    2               THEN
      172     6567    2                KEYIN$ -> FO$RKEYIN.FTNAME = KEYIN$ -> FO$RKEYIN.CTNAME;
      173     6568
      174     6569    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '
      175     6570    2               AND KEYIN$ -> FO$RKEYIN.CTNAME = FOMI_SCTNAME#
      176     6571    3               THEN DO;
      177     6572    3                 KEYIN$ -> FO$RKEYIN.FTNAME = 'LOCAL';
      178     6573    3                 END;
      179     6574
      180     6575    2               OPMSG_ROUTE.TYP1 = KEYIN$ -> FO$RKEYIN.DTW1.TYP;
      181     6576    2               OPMSG_ROUTE.TNAME1 = KEYIN$ -> FO$RKEYIN.FTNAME;
      182     6577
      183     6578    2               ROUTE_COMPLETE = '0'B;
      184     6579
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:6    
      185     6580
      186     6581    3                 DO WHILE ('1'B);
      187     6582
      188     6583    3                 CALL M$READ (READ_OSYMB) ALTRET (NO_MORE);
      189     6584
      190     6585
      191     6586    3                 IF KEYIN$ -> FO$RKEYIN.DTW1.TYP = FO_OSYMBUF.FO_OSYMBDEV.NAMER.TYP
      192     6587    3                 AND KEYIN$ -> FO$RKEYIN.FTNAME = FO_OSYMBUF.FO_OSYMBDEV.TNAME
      193     6588    3                 AND (KEYIN$ -> FO$RKEYIN.DTW1.NUM = ' '
      194     6589    3                 OR KEYIN$ -> FO$RKEYIN.DTW1.NUM = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM)
      195     6590    4                 THEN DO;
      196     6591    4                   CALL CHECK_WSN ALTRET (INCOMPAT);
      197     6592    4                   OPMSG_ROUTE.NUM1 = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM;
      198     6593    4                   CALL ROUTE_FROM
      199     6594    5                   WHENRETURN DO;
      200     6595    5                     END;
      201     6596    5                   WHENALTRETURN DO;
      202     6597    5                     END;
      203     6598    4                   ROUTE_COMPLETE = '1'B;
      204     6599    4                   END;
      205     6600    3                 END;
      206     6601
      207     6602    2   NO_MORE:    ;
      208     6603    2               FO_OSYMBKEY.LEN = 8;
      209     6604
      210     6605    2               SAV$ = DEV$;
      211     6606    3                 DO I = 0 TO FOPR_MAX#;
      212     6607    3                 FIL$ = FO_Q.FILHD$(I);
      213     6608    4                   DO WHILE (FIL$ ~= ADDR(NIL));
      214     6609    4                   CALL FOD$AVAIL;
      215     6610    4                   FIL$ = FIL$ -> FO$FIL.LNK$;
      216     6611    4                   END;
      217     6612    3                 END;
      218     6613    2               DEV$ = SAV$;
      219     6614
      220     6615    2               OPMSG_ROUTE.NUM1 = KEYIN$ -> FO$RKEYIN.DTW1.NUM;
      221     6616    2               IF ROUTE_COMPLETE = '0'B
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:7    
      222     6617    2               THEN
      223     6618    3                 DO;
      224     6619             /* No devs match the "from" criteria;
      225     6620                                    */
      226     6621    3                 OPMSG_ROUTE.SUBC = FORT_NOMATCH#;
      227     6622    3                 END;
      228     6623    2               ELSE
      229     6624    3                 DO;
      230     6625             /* Route complete */
      231     6626    3                 OPMSG_ROUTE.SUBC = FORT_DONE#;
      232     6627    3                 END;
      233     6628
      234     6629    2               CALL WRITE_OCMSG_ROUTE;
      235     6630    2   INCOMPAT:   ;
      236     6631    2               RETURN;
      237     6632
      238     6633
      239     6634    2             CASE (KEY_UNROUTE#);
      240     6635
      241     6636    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '
      242     6637    2               THEN
      243     6638    2                KEYIN$ -> FO$RKEYIN.FTNAME = KEYIN$ -> FO$RKEYIN.CTNAME;
      244     6639
      245     6640    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '
      246     6641    2               AND KEYIN$ -> FO$RKEYIN.CTNAME = FOMI_SCTNAME#
      247     6642    3               THEN DO;
      248     6643    3                 KEYIN$ -> FO$RKEYIN.FTNAME = 'LOCAL';
      249     6644    3                 END;
      250     6645
      251     6646    2               OPMSG_ROUTE.TYP1 = KEYIN$ -> FO$RKEYIN.DTW1.TYP;
      252     6647    2               OPMSG_ROUTE.TNAME1 = KEYIN$ -> FO$RKEYIN.FTNAME;
      253     6648
      254     6649
      255     6650    3                 DO WHILE ('1'B);
      256     6651
      257     6652    3                 CALL M$READ (READ_OSYMB) ALTRET (NO_MORE_2);
      258     6653
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:8    
      259     6654    3                 IF KEYIN$ -> FO$RKEYIN.DTW1.TYP = FO_OSYMBUF.FO_OSYMBDEV.NAMER.TYP
      260     6655    3                 AND KEYIN$ -> FO$RKEYIN.FTNAME = FO_OSYMBUF.FO_OSYMBDEV.TNAME
      261     6656    3                 AND (KEYIN$ -> FO$RKEYIN.DTW1.NUM = ' '
      262     6657    3                 OR KEYIN$ -> FO$RKEYIN.DTW1.NUM = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM)
      263     6658    4                 THEN DO;
      264     6659    4                   OPMSG_ROUTE.NUM1 = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM;
      265     6660    4                   CALL UNROUTE_FROM;
      266     6661    4                   END;
      267     6662
      268     6663    3                 END;
      269     6664
      270     6665    2   NO_MORE_2:  ;
      271     6666    2               FO_OSYMBKEY.LEN = 8;
      272     6667
      273     6668    2               SAV$ = DEV$;
      274     6669    3                 DO I = 0 TO FOPR_MAX#;
      275     6670    3                 FIL$ = FO_Q.FILHD$(I);
      276     6671    4                   DO WHILE (FIL$ ~= ADDR(NIL));
      277     6672    4                   CALL FOD$AVAIL;
      278     6673    4                   FIL$ = FIL$ -> FO$FIL.LNK$;
      279     6674    4                   END;
      280     6675    3                 END;
      281     6676    2               DEV$ = SAV$;
      282     6677
      283     6678    2               OPMSG_ROUTE.NUM1 = KEYIN$ -> FO$RKEYIN.DTW1.NUM;
      284     6679    2               ERROR = B$TCB.ALT$ -> B$ALT.ERR;
      285     6680
      286     6681    2               IF ERROR.ERR# ~= %E$EOF
      287     6682    3               THEN DO;
      288     6683    3                 OPMSG_ROUTE.SUBC = FORT_NOTTHERE#;
      289     6684    3                 CALL WRITE_OCMSG_ROUTE;
      290     6685    3                 ALTRETURN;
      291     6686    3                 END;
      292     6687    2               OPMSG_ROUTE.SUBC = FORT_UCMPL#;
      293     6688    2               CALL WRITE_OCMSG_ROUTE;
      294     6689    2               RETURN;
      295     6690
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:9    
      296     6691           /* Unroute complete */
      297     6692
      298     6693    2             CASE (KEY_ROUTEADD#);
      299     6694
      300     6695    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '
      301     6696    2               THEN
      302     6697    2                KEYIN$ -> FO$RKEYIN.FTNAME = KEYIN$ -> FO$RKEYIN.CTNAME;
      303     6698
      304     6699
      305     6700    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '
      306     6701    2               AND KEYIN$ -> FO$RKEYIN.CTNAME = FOMI_SCTNAME#
      307     6702    3               THEN DO;
      308     6703    3                 KEYIN$ -> FO$RKEYIN.FTNAME = 'LOCAL';
      309     6704    3                 END;
      310     6705
      311     6706    2               OPMSG_ROUTE.TYP1 = KEYIN$ -> FO$RKEYIN.DTW1.TYP;
      312     6707    2               OPMSG_ROUTE.TNAME1 = KEYIN$ -> FO$RKEYIN.FTNAME;
      313     6708
      314     6709    3                 DO WHILE ('1'B);
      315     6710    3                 CALL M$READ (READ_OSYMB) ALTRET (NO_MORE_3);
      316     6711
      317     6712    3                 IF KEYIN$ -> FO$RKEYIN.DTW1.TYP = FO_OSYMBUF.FO_OSYMBDEV.NAMER.TYP
      318     6713    3                 AND KEYIN$ -> FO$RKEYIN.FTNAME = FO_OSYMBUF.FO_OSYMBDEV.TNAME
      319     6714    3                 AND (KEYIN$ -> FO$RKEYIN.DTW1.NUM = ' '
      320     6715    3                 OR KEYIN$ -> FO$RKEYIN.DTW1.NUM = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM)
      321     6716    4                 THEN DO;
      322     6717    4                   OPMSG_ROUTE.NUM1 = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM;
      323     6718    4                   CALL ROUTE_ADD;
      324     6719    4                   END;
      325     6720    3                 END;
      326     6721
      327     6722    2   NO_MORE_3:  ;
      328     6723    2               FO_OSYMBKEY.LEN = 8;
      329     6724
      330     6725    2               SAV$ = DEV$;
      331     6726    3                 DO I = 0 TO FOPR_MAX#;
      332     6727    3                 FIL$ = FO_Q.FILHD$(I);
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:10   
      333     6728    4                   DO WHILE (FIL$ ~= ADDR(NIL));
      334     6729    4                   CALL FOD$AVAIL;
      335     6730    4                   FIL$ = FIL$ -> FO$FIL.LNK$;
      336     6731    4                   END;
      337     6732    3                 END;
      338     6733    2               DEV$ = SAV$;
      339     6734
      340     6735    2               OPMSG_ROUTE.NUM1 = KEYIN$ -> FO$RKEYIN.DTW1.NUM;
      341     6736    2               ERROR = B$TCB.ALT$ -> B$ALT.ERR;
      342     6737
      343     6738    2               IF ERROR.ERR# ~= %E$EOF
      344     6739    3               THEN DO;
      345     6740    3                 OPMSG_ROUTE.SUBC = FORT_NOTTHERE#;
      346     6741    3                 CALL WRITE_OCMSG_ROUTE;
      347     6742    3                 ALTRETURN;
      348     6743    3                 END;
      349     6744
      350     6745    2               OPMSG_ROUTE.SUBC = FORT_ADDCMP#;
      351     6746    2               CALL WRITE_OCMSG_ROUTE;
      352     6747    2               RETURN;
      353     6748
      354     6749    2           END; /* END CASE */
      355     6750
      356     6751
      357     6752    1   CHECK_WSN: PROC ALTRET;
      358     6753        /* IF DEV$ -> FO$DEV.FLG.COMPATABLE_WSNS
      359     6754           THEN
      360     6755             RETURN;
      361     6756           ELSE
      362     6757             ALTRETURN; */
      363     6758    2   END CHECK_WSN;
      364     6759
      365     6760        /****************************************
      366     6761         ****************************************
      367     6762                   WRITE_OCMSG_ROUTE
      368     6763         ****************************************
      369     6764         ****************************************/
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:11   
      370     6765    1   WRITE_OCMSG_ROUTE: PROC;
      371     6766    2         IF EVENT ~= FORE_KEYN#
      372     6767    3         THEN DO;
      373     6768    3           CALL M$WRITE (OCMSG_ROUTE);
      374     6769    3           END;
      375     6770    2   END WRITE_OCMSG_ROUTE;
      376     6771
      377     6772
      378     6773
      379     6774        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:12   
      380     6775        /******************************************
      381     6776         ******************************************
      382     6777                       ROUTE_FROM
      383     6778         ******************************************
      384     6779         ******************************************/
      385     6780
      386     6781    1   ROUTE_FROM: PROC ALTRET;
      387     6782
      388     6783    2         ROUTE_TALLY = 0;
      389     6784    3           DO I = 0 TO FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1;
      390     6785
      391     6786    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B
      392     6787    3           THEN
      393     6788    3            GOTO NEXT_FROM_WSN;
      394     6789
      395     6790
      396     6791    3           IF ((KEYIN$ -> FO$RKEYIN.WSN = ' '
      397     6792    3           OR KEYIN$ -> FO$RKEYIN.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
      398     6793    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 0)
      399     6794    3           OR
      400     6795    3           (KEYIN$ -> FO$RKEYIN.WSN ~= FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      401     6796    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 1)
      402     6797    4           THEN DO;
      403     6798    4             ROUTE_TALLY = ROUTE_TALLY + 1;
      404     6799    4             CALL FIND_DEV
      405     6800    5             WHENRETURN DO;
      406     6801    5               IF DEV$ -> FO$DEV.RWSNL > 0
      407     6802    6               THEN DO;
      408     6803    6                 IF DEV$ -> FO$DEV.RWSN
      409     6804    6                 = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      410     6805    7                 THEN DO;
      411     6806    7                   OPMSG_ROUTE.SUBC = FORT_NOPE#;
      412     6807    7                   OPMSG_ROUTE.WSN = DEV$ -> FO$DEV.RWSN;
      413     6808    7                   CALL WRITE_OCMSG_ROUTE;
      414     6809    7                   GOTO NEXT_FROM_WSN;
      415     6810    7                   END;
      416     6811    6                 END;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:13   
      417     6812    5               END;
      418     6813    5             WHENALTRETURN DO;
      419     6814    5               IF FO_OSYMBUF.FO_OSYMBDEV.RWSNL > 0
      420     6815    6               THEN DO;
      421     6816    6                 IF FO_OSYMBUF.FO_OSYMBDEV.RWSN
      422     6817    6                 = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      423     6818    7                 THEN DO;
      424     6819    7                   OPMSG_ROUTE.SUBC = FORT_NOPE#;
      425     6820    7                   OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
      426     6821    7                   CALL WRITE_OCMSG_ROUTE;
      427     6822    7                   GOTO NEXT_FROM_WSN;
      428     6823    7                   END;
      429     6824    6                 END;
      430     6825    5               END;
      431     6826
      432     6827    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '0'B
      433     6828    4             AND FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL (I) = '1'B
      434     6829    5             THEN DO;
      435     6830    5               FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '1'B;
      436     6831    5               FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '0'B;
      437     6832    5               WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)
      438     6833    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      439     6834    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      440     6835    5               + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      441     6836    5               CALL M$WRITE (WRITE_OSYMB);
      442     6837    5               CALL M$TRUNC (TRUNC_OSYMB);
      443     6838
      444     6839                         /* WSN X for lp01@tname routed to lp02@tname */
      445     6840    5               OPMSG_ROUTE.SUBC = FORT_ROK#;
      446     6841    5               OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
      447     6842    5               CALL WRITE_OCMSG_ROUTE;
      448     6843    5               END;
      449     6844    5             ELSE DO;
      450     6845    5               IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(I) = '0'B
      451     6846    6               THEN DO;
      452     6847                       /* Cannot route to a routed wsn */
      453     6848                       /* WSN X not originally associated with lp01@local.
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:14   
      454     6849                          No route done. */
      455     6850    6                 OPMSG_ROUTE.SUBC = FORT_NOTORIG#;
      456     6851    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
      457     6852    6                 CALL WRITE_OCMSG_ROUTE;
      458     6853    6                 END;
      459     6854    5               ELSE
      460     6855    6                 DO;
      461     6856                       /* Already routed */
      462     6857                       /* WSN X FOR LP01@LOCAL is already routed to lp01@zzz.
      463     6858                          No route done. */
      464     6859    6                 OPMSG_ROUTE.SUBC = FORT_TOOLATE#;
      465     6860    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
      466     6861    6                 CALL WRITE_OCMSG_ROUTE;
      467     6862    6                 END;
      468     6863    5               END;
      469     6864    4             END;
      470     6865    3   NEXT_FROM_WSN:;
      471     6866    3           END;
      472     6867
      473     6868    2         IF ROUTE_TALLY ~= 0
      474     6869    3         THEN DO;
      475     6870    3           CALL OSYMB_TO_DEV
      476     6871    4           WHENALTRETURN DO;
      477     6872                       /* None of the specified devices were able to accept
      478     6873                          wsn x from dev$.  This wsn has not been routed. */
      479     6874    4             OPMSG_ROUTE.SUBC = FORT_NOROUTE#;
      480     6875    4             OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
      481     6876    4             CALL WRITE_OCMSG_ROUTE;
      482     6877    4             END;
      483     6878    3           END;
      484     6879    2         ELSE
      485     6880    3           DO;
      486     6881    3           OPMSG_ROUTE.SUBC = FORT_NOWSN#;
      487     6882    3           CALL WRITE_OCMSG_ROUTE;
      488     6883    3           END;
      489     6884    2         RETURN;
      490     6885
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:15   
      491     6886    2   END ROUTE_FROM;
      492     6887
      493     6888        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:16   
      494     6889        /**************************************
      495     6890         **************************************
      496     6891                    ROUTE_ADD
      497     6892         **************************************
      498     6893         **************************************/
      499     6894
      500     6895    1   ROUTE_ADD: PROC;
      501     6896
      502     6897    2         K = -1;
      503     6898    3           DO I = 0 TO (FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1);
      504     6899
      505     6900    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      506     6901    3           = KEYIN$ -> FO$RKEYIN.WSN
      507     6902    4           THEN DO;
      508     6903    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '1'B
      509     6904    5             THEN DO;
      510     6905    5               OPMSG_ROUTE.SUBC = FORT_OUT#;
      511     6906    5               OPMSG_ROUTE.WSN = KEYIN$ -> FO$RKEYIN.WSN;
      512     6907    5               CALL WRITE_OCMSG_ROUTE;
      513     6908    5               RETURN;
      514     6909    5               END;
      515     6910    4             IF (FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(I) = '1'B
      516     6911    4             OR FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '1'B)
      517     6912    4             AND
      518     6913    4             FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '0'B
      519     6914    5             THEN DO;
      520     6915    5               OPMSG_ROUTE.SUBC = FORT_HERE#;
      521     6916    5               OPMSG_ROUTE.WSN = KEYIN$ -> FO$RKEYIN.WSN;
      522     6917    5               CALL WRITE_OCMSG_ROUTE;
      523     6918    5               RETURN;
      524     6919    5               END;
      525     6920
      526     6921    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B
      527     6922    4             AND K = -1
      528     6923    5             THEN DO;
      529     6924    5               K = I;
      530     6925    5               END;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:17   
      531     6926    4             END;
      532     6927    3           END;
      533     6928    2         IF K = -1
      534     6929    3         THEN DO;
      535     6930    3           K = FO_OSYMBUF.FO_OSYMBWSN.NWSNS;
      536     6931    3           FO_OSYMBUF.FO_OSYMBWSN.NWSNS = FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1;
      537     6932    3           END;
      538     6933
      539     6934    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(K) = '0'B;
      540     6935    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(K) = '0'B;
      541     6936    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(K) = '1'B;
      542     6937    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(K) = '0'B;
      543     6938    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(K) =
      544     6939    2         KEYIN$ -> FO$RKEYIN.WSN;
      545     6940    2         WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)
      546     6941    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      547     6942    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      548     6943    2         + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      549     6944    2         CALL M$WRITE (WRITE_OSYMB);
      550     6945    2         CALL M$TRUNC (TRUNC_OSYMB);
      551     6946
      552     6947
      553     6948    2         CALL OSYMB_TO_DEV
      554     6949    3         WHENRETURN DO;
      555     6950
      556     6951    3           OPMSG_ROUTE.SUBC = FORT_ADDON#;
      557     6952    3           OPMSG_ROUTE.WSN = KEYIN$ -> FO$RKEYIN.WSN;
      558     6953    3           CALL WRITE_OCMSG_ROUTE;
      559     6954    3           END;
      560     6955    3         WHENALTRETURN DO;
      561     6956    3           OPMSG_ROUTE.SUBC = FORT_NOROUTE#;
      562     6957    3           CALL WRITE_OCMSG_ROUTE;
      563     6958    3           END;
      564     6959
      565     6960    2   END ROUTE_ADD;
      566     6961
      567     6962
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:18   
      568     6963        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:19   
      569     6964
      570     6965        /***************************************
      571     6966         ***************************************
      572     6967                     UNROUTE_FROM
      573     6968         ***************************************
      574     6969         ***************************************/
      575     6970
      576     6971    1   UNROUTE_FROM: PROC;
      577     6972
      578     6973    2         ROUTE_TALLY = 0;
      579     6974
      580     6975    3           DO I = 0 TO (FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1);
      581     6976
      582     6977    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B
      583     6978    3           THEN
      584     6979    3            GOTO NEXT_WSN_2;
      585     6980
      586     6981    3           IF ((KEYIN$ -> FO$RKEYIN.WSN = ' '
      587     6982    3           OR KEYIN$ -> FO$RKEYIN.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
      588     6983    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 0)
      589     6984    3           OR
      590     6985    3           (KEYIN$ -> FO$RKEYIN.WSN ~= FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      591     6986    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 1)
      592     6987    4           THEN DO;
      593     6988    4             ROUTE_TALLY = ROUTE_TALLY + 1;
      594     6989    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(I) = '1'B
      595     6990    4             AND FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '1'B
      596     6991    5             THEN DO;
      597     6992    5               FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '0'B;
      598     6993    5               WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)
      599     6994    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      600     6995    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      601     6996    5               + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      602     6997    5               CALL M$WRITE (WRITE_OSYMB);
      603     6998    5               CALL M$TRUNC (TRUNC_OSYMB);
      604     6999    5               OPMSG_ROUTE.SUBC = FORT_UCMP#;
      605     7000    5               OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:20   
      606     7001    5               CALL WRITE_OCMSG_ROUTE;
      607     7002    5               END;
      608     7003    4             ELSE
      609     7004    5               DO;
      610     7005    5               IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '1'B
      611     7006    6               THEN DO;
      612     7007                       /* WSN not asociated with this device */
      613     7008    6                 FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '0'B;
      614     7009    6                 FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B;
      615     7010    6                 WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)
      616     7011    6                 + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      617     7012    6                 + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      618     7013    6                 + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      619     7014    6                 CALL M$WRITE (WRITE_OSYMB);
      620     7015    6                 CALL M$TRUNC (TRUNC_OSYMB);
      621     7016    6                 OPMSG_ROUTE.SUBC = FORT_UACMP#;
      622     7017    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
      623     7018    6                 CALL WRITE_OCMSG_ROUTE;
      624     7019    6                 END;
      625     7020    5               ELSE
      626     7021    6                 DO;
      627     7022                       /* WSN not routed out */
      628     7023    6                 OPMSG_ROUTE.SUBC = FORT_NORTE#;
      629     7024    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);
      630     7025    6                 CALL WRITE_OCMSG_ROUTE;
      631     7026    6                 END;
      632     7027    5               END;
      633     7028    4             END;
      634     7029    3   NEXT_WSN_2:;
      635     7030    3           END;
      636     7031
      637     7032    2         IF ROUTE_TALLY ~= 0
      638     7033    3         THEN DO;
      639     7034    3           CALL OSYMB_TO_DEV;
      640     7035    3           END;
      641     7036    2         ELSE
      642     7037    3           DO;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:21   
      643     7038    3           OPMSG_ROUTE.SUBC = FORT_NOWSN#;
      644     7039    3           CALL WRITE_OCMSG_ROUTE;
      645     7040    3           END;
      646     7041
      647     7042    2         RETURN;
      648     7043    2   END UNROUTE_FROM;
      649     7044        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:22   
      650     7045        /****************************************
      651     7046         ****************************************
      652     7047                   OSYMB_TO_DEV
      653     7048         ****************************************
      654     7049         ****************************************/
      655     7050    1   OSYMB_TO_DEV: PROC ALTRET;
      656     7051
      657     7052    2         CALL FIND_DEV
      658     7053    3         WHENALTRETURN DO;
      659     7054    3           RETURN;
      660     7055    3           END;
      661     7056
      662     7057    3           DO I = 0 TO (FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1);
      663     7058
      664     7059
      665     7060    3           WSN$ = DEV$ -> FO$DEV.WSN$;
      666     7061    4             DO WHILE (WSN$ ~= ADDR(NIL));
      667     7062    5               DO J = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);
      668     7063    5               IF (WSN$ -> FO$WSN.WSN.WSN_NAME(J)
      669     7064    5               = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
      670     7065    6               THEN DO;
      671     7066    6                 WSN$ -> FO$WSN.WSN(J) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);
      672     7067    6                 GOTO NEXT_WSN;
      673     7068    6                 END;
      674     7069
      675     7070    5               END;
      676     7071    4             WSNLNK$ = WSN$;
      677     7072    4             WSN$ = WSN$ -> FO$WSN.LNK$;
      678     7073    4             END;
      679     7074
      680     7075    3           WSN$ = WSNLNK$;
      681     7076    3           IF WSN$ -> FO$WSN.NWSNS < 4
      682     7077    4           THEN DO;
      683     7078    4             WSN$ -> FO$WSN.NWSNS = WSN$ -> FO$WSN.NWSNS + 1;
      684     7079    4             WSN$ -> FO$WSN.WSN(J) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);
      685     7080    4             END;
      686     7081    3           ELSE
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:23   
      687     7082    4             DO;
      688     7083    4             WSNLNK$ = WSN$;
      689     7084    4             CALL FOI$GBUF (FO_DEVSCB, WSN$)
      690     7085    5             WHENALTRETURN DO;
      691     7086    5               ALTRETURN;
      692     7087    5               END;
      693     7088    4             WSNLNK$ -> FO$WSN.LNK$ = WSN$;
      694     7089    4             WSN$ -> FO$WSN.LNK$ = ADDR(NIL);
      695     7090    4             WSN$ -> FO$WSN.NWSNS = 1;
      696     7091    4             WSN$ -> FO$WSN.WSN(WSN$ -> FO$WSN.NWSNS - 1)
      697     7092    4             = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);
      698     7093    4             END;
      699     7094    3   NEXT_WSN:;
      700     7095    3           END;
      701     7096    2         RETURN;
      702     7097    2   END OSYMB_TO_DEV;
      703     7098
      704     7099        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:24   
      705     7100        /****************************************
      706     7101         ****************************************
      707     7102                        FIND_DEV
      708     7103         ****************************************
      709     7104         ****************************************/
      710     7105    1   FIND_DEV: PROC ALTRET;
      711     7106
      712     7107    2         DEV$ = FO_Q.DEVHD$;
      713     7108    3           DO WHILE (DEV$ ~= ADDR(NIL));
      714     7109    3           IF FO_OSYMBKEY.NAME = DEV$ -> FO$DEV.NAME
      715     7110    3           THEN
      716     7111    3            RETURN;
      717     7112    3           DEV$ = DEV$ -> FO$DEV.LNK$;
      718     7113    3           END;
      719     7114    2         ALTRETURN;
      720     7115    2   END FIND_DEV;
      721     7116        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:25   
      722     7117    1   END FOU$ROOSTER;

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:26   
--  Include file information  --

   F_ERRORS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   FO_SCODE_C.:E05TOU  is referenced.
   FOO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FOU$ROOSTER.

   Procedure FOU$ROOSTER requires 921 words for executable code.
   Procedure FOU$ROOSTER requires 30 words of local(AUTO) storage.

    No errors detected in file FOU$ROOSTER.:E05TSI    .

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:27   

 Object Unit name= FOU$ROOSTER                                File name= FOU$ROOSTER.:E05TOU
 UTS= JUL 29 '97 17:15:49.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    28     34  FOU$ROOSTER
    2   DCB   even  none     0      0  M$OSYMB
    3   DCB   even  none     0      0  M$CSCG
    4  RoData even  UTS     36     44  FOU$ROOSTER
    5   Proc  even  none   921   1631  FOU$ROOSTER
    6  RoData even  none     1      1  FOU$ROOSTER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        2  FOU$ROOSTER
     5      3          yes     yes      Std        2  FOU$EVENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 FOD$AVAIL
 yes     yes           Std       2 FOI$GBUF
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:28   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  FO_FIL$                               FO_DEV$
     FO_OSYMBKEY                           FO_OSYMBUF                            FO_Q
     FO_DEVSCB                             B$TCB$                                M$OSYMB
     M$CSCG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:29   


        1        1        /*M* FOU$ROOSTER Device route routines for OUTSYM ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:        FOU$ROOSTER
       10       10             PURPOSE:     To handle route operations for OUTSYM
       11       11             DESCRIPTION: FOU$ROOSTER (ROute Output Symbiont TERminals)
       12       12                          handles all route specific code used to set up
       13       13                          alternate print paths. */
       14       14        /**/
       15       15        /**/
       16       16        FOU$ROOSTER: PROC (EVENT,DINFO) ALTRET;

     16  5 000000   000000 700200 xent  FOU$ROOSTER  TSX0  ! X66_AUTO_2
         5 000001   000036 000002                    ZERO    30,2
         5 000002   000005 710000 5                  TRA     s:6547

       17       17
       18       18
       19       19
       20       20        /**/
       21       21        /* PARAMETERS */
       22       22        /**/
       23       23    1   DCL EVENT UBIN WORD;
       24       24    1   DCL DINFO UBIN WORD;
       25       25    1   DCL KEYIN$ REDEF DINFO PTR;
       26       26        /**/
       27       27        /* INCLUDES */
       28       28        /**/
       29       29        %INCLUDE CP_6;
       30      110        %INCLUDE FO_ERRORS_C;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:30   
       31      142        %INCLUDE KL_SUPER_C;
       32     3044        %INCLUDE OC_SUBS_C;
       33     3775        %INCLUDE FS$FIT;
       34     3818        %INCLUDE FOO_SUBS_C;
       35     4054        %INCLUDE FOO_MAC_C;
       36     4802        %INCLUDE FOO_DATA_R;
       37     5968        %INCLUDE FO_SCODE_C;
       38     5996        %INCLUDE OC_MESSHD_C;
       39     6049        %INCLUDE F_ERRORS_C;
       40     6289
       41     6290    1   DCL FOI$GBUF ENTRY(2) ALTRET;
       42     6291    1   DCL FOD$AVAIL ENTRY   ALTRET;
       43     6292
       44     6293        /**/
       45     6294        /* BASED STRUCTURES */
       46     6295        /**/
       47     6296        %B$TCB (STCLASS="BASED(B$TCB$)");
       48     6299        %B$ALT;
       49     6307        /**/
       50     6308        /**/
       51     6309        /* REFS */
       52     6310    1   DCL B$TCB$ PTR SYMREF;
       53     6311    1   DCL B$JIT$ PTR SYMREF;
       54     6312        /* AUTO */
       55     6313        /**/
       56     6314    1   DCL I UBIN WORD;
       57     6315    1   DCL J UBIN WORD;
       58     6316    1   DCL K SBIN WORD;
       59     6317    1   DCL ROUTE_TALLY UBIN WORD;
       60     6318    1   DCL ROUTE_COMPLETE BIT(1);
       61     6319    1   DCL BLOCK_TYPE BIT(1);
       62     6320    1   DCL WSN$ PTR;
       63     6321    1   DCL WSNLNK$ PTR;
       64     6322    1   DCL FROM_WSN$ PTR;
       65     6323    1   DCL TO_WSN$ PTR;
       66     6324    1   DCL NEW_BLOCK$ PTR;
       67     6325    1   DCL K$ PTR;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:31   
       68     6326    1   DCL P$ PTR;
       69     6327    1   DCL P_WSN$ PTR;
       70     6328    1   DCL PP$ PTR;
       71     6329    1   DCL PP_WSN$ PTR;
       72     6330    1   DCL SAV$ PTR;
       73     6331    1   DCL 1 ERROR ALIGNED STATIC,
       74     6332    1         2 FCG BIT(18),
       75     6333    1         2 MON BIT(1) UNAL,
       76     6334    1         2 ERR# UBIN(14) UNAL,
       77     6335    1         2 SEV UBIN(3) UNAL;
       78     6336        /**/
       79     6337        /* STATIC */
       80     6338    1   DCL KEY_BUF UBIN WORD STATIC INIT(0);
       81     6339    1   DCL KEY_ZERO UBIN WORD STATIC INIT(0);
       82     6340
       83     6341    1   DCL M$OSYMB DCB;
       84     6342    1   DCL M$CSCG DCB;
       85     6343
       86     6344        %OC_MESSHD_D                  (NAME=OPMSG_ROUTE,
       87     6345                 NPARMS= 5,
       88     6346                 ATR=M_UR,
       89     6347                 MSG=FO_RTE_MSG#,
       90     6348                 STCLASS=STATIC);
       91     6361    1         2 * UBIN BYTE UNAL INIT(1),
       92     6362    1         2 * UBIN BYTE UNAL INIT(2),
       93     6363    1         2 * UBIN BYTE UNAL INIT(2),
       94     6364    1         2 * UBIN BYTE UNAL INIT(8),
       95     6365    1         2 * UBIN BYTE UNAL INIT(8),
       96     6366    1         2 SUBC UBIN BYTE UNAL,
       97     6367    1         2 TYP1 CHAR(2) UNAL,
       98     6368    1         2 NUM1 CHAR(2) UNAL,
       99     6369    1         2 TNAME1 CHAR(8) UNAL,
      100     6370    1         2 WSN CHAR(8) UNAL;
      101     6371
      102     6372           %FPT_WRITE                      (FPTN = OCMSG_ROUTE,
      103     6373                STCLASS = CONSTANT,
      104     6374                DCB = M$CSCG,
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:32   
      105     6375                BUF = OPMSG_ROUTE );
      106     6406           %FPT_WRITE                      (FPTN = WRITE_OSYMB,
      107     6407                STCLASS = STATIC,
      108     6408                DCB     = M$OSYMB,
      109     6409                KEY     = FO_OSYMBKEY,
      110     6410                BUF     = FO_OSYMBUF,
      111     6411                ONEWKEY = YES );
      112     6442
      113     6443           %FPT_READ                      ( FPTN = READ_OSYMB,
      114     6444                STCLASS = CONSTANT,
      115     6445                DCB     = M$OSYMB,
      116     6446                KEY     = FO_OSYMBKEY,
      117     6447                KEYS    = NO,
      118     6448                BUF     = FO_OSYMBUF,
      119     6449                KEYR    = YES );
      120     6488           %FPT_TRUNC                     ( FPTN = TRUNC_OSYMB,
      121     6489                DCB     = M$OSYMB,
      122     6490                STCLASS = CONSTANT );
      123     6504           %FPT_PFIL                      ( FPTN = FIRST_RECORD,
      124     6505                DCB     = M$OSYMB,
      125     6506                BOF     = YES,
      126     6507                STCLASS = CONSTANT );
      127     6522
      128     6523        %SUB DEV$=FO_DEV$;
      129     6524        %SUB FIL$=FO_FIL$;
      130     6525        /*F* NAME:          FOU$ROUTE
      131     6526             PURPOSE:       To schedule output symbiont route changes
      132     6527             DESCRIPTION:   FOU$EVENT takes the form of an event reporting
      133     6528                            routine.  All events applicable to output routing
      134     6529                            are reported here, with the result that the
      135     6530                            appropriate routing functions are performed.
      136     6531
      137     6532                            The parameters are the event code (EVENT) and
      138     6533                            information specific to events (DINFO).  For
      139     6534                            example, DINFO will generally be the pointer
      140     6535                            to the route keyin block.  */
      141     6536
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:33   
      142     6537    1   FOU$EVENT: ENTRY (EVENT,DINFO) ALTRET;

   6537  5 000003   000000 700200 xent  FOU$EVENT    TSX0  ! X66_AUTO_2
         5 000004   000036 000002                    ZERO    30,2

      143     6538
      144     6539        /**
      145     6540         **
      146     6541         **     ROUTE KEYIN EVENT
      147     6542         **
      148     6543         **/
      149     6544        /*   Order: Route,
      150     6545                    Unroute */
      151     6546        /**/
      152     6547    1         OPMSG_ROUTE.CADDR = KEYIN$ -> FO$RKEYIN.CADDR;

   6547  5 000005   200004 470500                    LDP0    @DINFO,,AUTO
         5 000006   000000 471500                    LDP1    0,,PR0
         5 000007   100000 720100                    LXL0    0,,PR1
         5 000010   000003 740000 1                  STX0    OPMSG_ROUTE

      153     6548
      154     6549    1         CALL M$PFIL (FIRST_RECORD)

   6549  5 000011   000036 630400 4                  EPPR0   FIRST_RECORD
         5 000012   440004 713400                    CLIMB   alt,+16388
         5 000013   400000 401760                    pmme    nvectors=1
         5 000014   000016 702000 5                  TSX2    s:6551
         5 000015   000017 710000 5                  TRA     s:6554

      155     6550    2         WHENALTRETURN DO;

      156     6551    2           ALTRETURN;

   6551  5 000016   000000 702200 xent               TSX2  ! X66_AALT

      157     6552    2           END;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:34   
      158     6553
      159     6554    2           DO CASE (KEYIN$ -> FO$RKEYIN.KIN#);

   6554  5 000017   200004 470500                    LDP0    @DINFO,,AUTO
         5 000020   000000 471500                    LDP1    0,,PR0
         5 000021   100000 236100                    LDQ     0,,PR1
         5 000022   000022 772000                    QRL     18
         5 000023   000032 136007                    SBLQ    26,DL
         5 000024   000003 116007                    CMPQ    3,DL
         5 000025   000027 602006 5                  TNC     s:6554+8,QL
         5 000026   000523 710000 5                  TRA     s:6749
         5 000027   000032 710000 5                  TRA     s:6565
         5 000030   000352 710000 5                  TRA     s:6695
         5 000031   000201 710000 5                  TRA     s:6636

      160     6555        /**
      161     6556         **
      162     6557         **   Route
      163     6558         **
      164     6559         **/
      165     6560    2             CASE (KEY_ROUTE#);

      166     6561
      167     6562
      168     6563
      169     6564
      170     6565    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '

   6565  5 000032   040000 106500                    CMPC    fill='040'O
         5 000033   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000034   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000035   000041 601000 5                  TNZ     s:6569

      171     6566    2               THEN
      172     6567    2                KEYIN$ -> FO$RKEYIN.FTNAME = KEYIN$ -> FO$RKEYIN.CTNAME;

   6567  5 000036   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:35   
         5 000037   100007 200010                    ADSC9   7,,PR1                   cn=1,n=8
         5 000040   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8

      173     6568
      174     6569    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '

   6569  5 000041   000000 471500                    LDP1    0,,PR0
         5 000042   040000 106500                    CMPC    fill='040'O
         5 000043   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000044   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000045   000055 601000 5                  TNZ     s:6575
         5 000046   040000 106500                    CMPC    fill='040'O
         5 000047   100007 200010                    ADSC9   7,,PR1                   cn=1,n=8
         5 000050   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000051   000055 601000 5                  TNZ     s:6575

      175     6570    2               AND KEYIN$ -> FO$RKEYIN.CTNAME = FOMI_SCTNAME#
      176     6571    3               THEN DO;

      177     6572    3                 KEYIN$ -> FO$RKEYIN.FTNAME = 'LOCAL';

   6572  5 000052   040100 100400                    MLR     fill='040'O
         5 000053   000042 000005 4                  ADSC9   FIRST_RECORD+4           cn=0,n=5
         5 000054   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8

      178     6573    3                 END;

      179     6574
      180     6575    2               OPMSG_ROUTE.TYP1 = KEYIN$ -> FO$RKEYIN.DTW1.TYP;

   6575  5 000055   000000 471500                    LDP1    0,,PR0
         5 000056   040100 100500                    MLR     fill='040'O
         5 000057   100003 200002                    ADSC9   3,,PR1                   cn=1,n=2
         5 000060   200034 000004                    ADSC9   SAV$+7,,AUTO             cn=0,n=4
         5 000061   200034 220100                    LDX0    SAV$+7,,AUTO
         5 000062   000011 440000 1                  SXL0    OPMSG_ROUTE+6

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:36   
      181     6576    2               OPMSG_ROUTE.TNAME1 = KEYIN$ -> FO$RKEYIN.FTNAME;

   6576  5 000063   000000 471500                    LDP1    0,,PR0
         5 000064   040000 100500                    MLR     fill='040'O
         5 000065   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000066   000012 400010 1                  ADSC9   OPMSG_ROUTE+7            cn=2,n=8

      182     6577
      183     6578    2               ROUTE_COMPLETE = '0'B;

   6578  5 000067   200011 450100                    STZ     ROUTE_COMPLETE,,AUTO

      184     6579
      185     6580
      186     6581    3                 DO WHILE ('1'B);

      187     6582
      188     6583    3                 CALL M$READ (READ_OSYMB) ALTRET (NO_MORE);

   6583  5 000070   000014 630400 4                  EPPR0   READ_OSYMB
         5 000071   440000 713400                    CLIMB   alt,read
         5 000072   401400 401760                    pmme    nvectors=4
         5 000073   000130 702000 5                  TSX2    NO_MORE

      189     6584
      190     6585
      191     6586    3                 IF KEYIN$ -> FO$RKEYIN.DTW1.TYP = FO_OSYMBUF.FO_OSYMBDEV.NAMER.TYP

   6586  5 000074   200004 470500                    LDP0    @DINFO,,AUTO
         5 000075   000000 471500                    LDP1    0,,PR0
         5 000076   040000 106500                    CMPC    fill='040'O
         5 000077   100003 200002                    ADSC9   3,,PR1                   cn=1,n=2
         5 000100   000005 000002 xsym               ADSC9   FO_OSYMBUF+5             cn=0,n=2
         5 000101   000070 601000 5                  TNZ     s:6583
         5 000102   040000 106500                    CMPC    fill='040'O
         5 000103   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000104   000007 000010 xsym               ADSC9   FO_OSYMBUF+7             cn=0,n=8
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:37   
         5 000105   000070 601000 5                  TNZ     s:6583
         5 000106   040000 106500                    CMPC    fill='040'O
         5 000107   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000110   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000111   000116 600000 5                  TZE     s:6591
         5 000112   040000 106500                    CMPC    fill='040'O
         5 000113   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000114   000005 400002 xsym               ADSC9   FO_OSYMBUF+5             cn=2,n=2
         5 000115   000070 601000 5                  TNZ     s:6583

      192     6587    3                 AND KEYIN$ -> FO$RKEYIN.FTNAME = FO_OSYMBUF.FO_OSYMBDEV.TNAME
      193     6588    3                 AND (KEYIN$ -> FO$RKEYIN.DTW1.NUM = ' '
      194     6589    3                 OR KEYIN$ -> FO$RKEYIN.DTW1.NUM = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM)
      195     6590    4                 THEN DO;

      196     6591    4                   CALL CHECK_WSN ALTRET (INCOMPAT);

   6591  5 000116   000524 701000 5                  TSX1    CHECK_WSN
         5 000117   000200 702000 5                  TSX2    INCOMPAT

      197     6592    4                   OPMSG_ROUTE.NUM1 = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM;

   6592  5 000120   000005 720000 xsym               LXL0    FO_OSYMBUF+5
         5 000121   000012 740000 1                  STX0    OPMSG_ROUTE+7

      198     6593    4                   CALL ROUTE_FROM

   6593  5 000122   000540 701000 5                  TSX1    ROUTE_FROM
         5 000123   000125 702000 5                  TSX2    s:6598

      199     6594    5                   WHENRETURN DO;

      200     6595    5                     END;

   6595  5 000124   000125 710000 5                  TRA     s:6598

      201     6596    5                   WHENALTRETURN DO;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:38   

      202     6597    5                     END;

      203     6598    4                   ROUTE_COMPLETE = '1'B;

   6598  5 000125   400000 236003                    LDQ     -131072,DU
         5 000126   200011 756100                    STQ     ROUTE_COMPLETE,,AUTO

      204     6599    4                   END;

      205     6600    3                 END;

   6600  5 000127   000070 710000 5                  TRA     s:6583

   6598  5 000130                       NO_MORE      null
      206     6601
      207     6602    2   NO_MORE:    ;
      208     6603    2               FO_OSYMBKEY.LEN = 8;

   6603  5 000130   010000 236003                    LDQ     4096,DU
         5 000131   000000 552040 xsym               STBQ    FO_OSYMBKEY,'40'O

      209     6604
      210     6605    2               SAV$ = DEV$;

   6605  5 000132   000000 236000 xsym               LDQ     FO_DEV$
         5 000133   200025 756100                    STQ     SAV$,,AUTO

      211     6606    3                 DO I = 0 TO FOPR_MAX#;

   6606  5 000134   200005 450100                    STZ     I,,AUTO

      212     6607    3                 FIL$ = FO_Q.FILHD$(I);

   6607  5 000135   200005 720100                    LXL0    I,,AUTO
         5 000136   000004 236010 xsym               LDQ     FO_Q+4,X0
         5 000137   000000 756000 xsym               STQ     FO_FIL$
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:39   

      213     6608    4                   DO WHILE (FIL$ ~= ADDR(NIL));

   6608  5 000140   000147 710000 5                  TRA     s:6611

      214     6609    4                   CALL FOD$AVAIL;

   6609  5 000141   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000142   000000 701000 xent               TSX1    FOD$AVAIL
         5 000143   000000 011000                    NOP     0

      215     6610    4                   FIL$ = FIL$ -> FO$FIL.LNK$;

   6610  5 000144   000000 470400 xsym               LDP0    FO_FIL$
         5 000145   000000 236100                    LDQ     0,,PR0
         5 000146   000000 756000 xsym               STQ     FO_FIL$

      216     6611    4                   END;

   6611  5 000147   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000150   000141 601000 5                  TNZ     s:6609

      217     6612    3                 END;

   6612  5 000151   200005 235100                    LDA     I,,AUTO
         5 000152   000001 035007                    ADLA    1,DL
         5 000153   200005 755100                    STA     I,,AUTO
         5 000154   000023 115007                    CMPA    19,DL
         5 000155   000135 602000 5                  TNC     s:6607

      218     6613    2               DEV$ = SAV$;

   6613  5 000156   200025 236100                    LDQ     SAV$,,AUTO
         5 000157   000000 756000 xsym               STQ     FO_DEV$

      219     6614
      220     6615    2               OPMSG_ROUTE.NUM1 = KEYIN$ -> FO$RKEYIN.DTW1.NUM;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:40   

   6615  5 000160   200004 470500                    LDP0    @DINFO,,AUTO
         5 000161   000000 471500                    LDP1    0,,PR0
         5 000162   040100 100500                    MLR     fill='040'O
         5 000163   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000164   200034 000004                    ADSC9   SAV$+7,,AUTO             cn=0,n=4
         5 000165   200034 220100                    LDX0    SAV$+7,,AUTO
         5 000166   000012 740000 1                  STX0    OPMSG_ROUTE+7

      221     6616    2               IF ROUTE_COMPLETE = '0'B

   6616  5 000167   200011 234100                    SZN     ROUTE_COMPLETE,,AUTO
         5 000170   000174 604000 5                  TMI     s:6626

      222     6617    2               THEN
      223     6618    3                 DO;

      224     6619             /* No devs match the "from" criteria;
      225     6620                                    */
      226     6621    3                 OPMSG_ROUTE.SUBC = FORT_NOMATCH#;

   6621  5 000171   000000 236003                    LDQ     0,DU
         5 000172   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      227     6622    3                 END;

   6622  5 000173   000176 710000 5                  TRA     s:6629

      228     6623    2               ELSE
      229     6624    3                 DO;

      230     6625             /* Route complete */
      231     6626    3                 OPMSG_ROUTE.SUBC = FORT_DONE#;

   6626  5 000174   000001 236003                    LDQ     1,DU
         5 000175   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:41   
      232     6627    3                 END;

      233     6628
      234     6629    2               CALL WRITE_OCMSG_ROUTE;

   6629  5 000176   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000177   000000 011000                    NOP     0

   6616  5 000200                       INCOMPAT     null
      235     6630    2   INCOMPAT:   ;
      236     6631    2               RETURN;

   6631  5 000200   000000 702200 xent               TSX2  ! X66_ARET

      237     6632
      238     6633
      239     6634    2             CASE (KEY_UNROUTE#);

      240     6635
      241     6636    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '

   6636  5 000201   040000 106500                    CMPC    fill='040'O
         5 000202   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000203   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000204   000210 601000 5                  TNZ     s:6640

      242     6637    2               THEN
      243     6638    2                KEYIN$ -> FO$RKEYIN.FTNAME = KEYIN$ -> FO$RKEYIN.CTNAME;

   6638  5 000205   040100 100500                    MLR     fill='040'O
         5 000206   100007 200010                    ADSC9   7,,PR1                   cn=1,n=8
         5 000207   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8

      244     6639
      245     6640    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '

   6640  5 000210   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:42   
         5 000211   040000 106500                    CMPC    fill='040'O
         5 000212   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000213   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000214   000224 601000 5                  TNZ     s:6646
         5 000215   040000 106500                    CMPC    fill='040'O
         5 000216   100007 200010                    ADSC9   7,,PR1                   cn=1,n=8
         5 000217   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000220   000224 601000 5                  TNZ     s:6646

      246     6641    2               AND KEYIN$ -> FO$RKEYIN.CTNAME = FOMI_SCTNAME#
      247     6642    3               THEN DO;

      248     6643    3                 KEYIN$ -> FO$RKEYIN.FTNAME = 'LOCAL';

   6643  5 000221   040100 100400                    MLR     fill='040'O
         5 000222   000042 000005 4                  ADSC9   FIRST_RECORD+4           cn=0,n=5
         5 000223   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8

      249     6644    3                 END;

      250     6645
      251     6646    2               OPMSG_ROUTE.TYP1 = KEYIN$ -> FO$RKEYIN.DTW1.TYP;

   6646  5 000224   000000 471500                    LDP1    0,,PR0
         5 000225   040100 100500                    MLR     fill='040'O
         5 000226   100003 200002                    ADSC9   3,,PR1                   cn=1,n=2
         5 000227   200034 000004                    ADSC9   SAV$+7,,AUTO             cn=0,n=4
         5 000230   200034 220100                    LDX0    SAV$+7,,AUTO
         5 000231   000011 440000 1                  SXL0    OPMSG_ROUTE+6

      252     6647    2               OPMSG_ROUTE.TNAME1 = KEYIN$ -> FO$RKEYIN.FTNAME;

   6647  5 000232   000000 471500                    LDP1    0,,PR0
         5 000233   040000 100500                    MLR     fill='040'O
         5 000234   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000235   000012 400010 1                  ADSC9   OPMSG_ROUTE+7            cn=2,n=8

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:43   
      253     6648
      254     6649
      255     6650    3                 DO WHILE ('1'B);

      256     6651
      257     6652    3                 CALL M$READ (READ_OSYMB) ALTRET (NO_MORE_2);

   6652  5 000236   000014 630400 4                  EPPR0   READ_OSYMB
         5 000237   440000 713400                    CLIMB   alt,read
         5 000240   401400 401760                    pmme    nvectors=4
         5 000241   000271 702000 5                  TSX2    NO_MORE_2

      258     6653
      259     6654    3                 IF KEYIN$ -> FO$RKEYIN.DTW1.TYP = FO_OSYMBUF.FO_OSYMBDEV.NAMER.TYP

   6654  5 000242   200004 470500                    LDP0    @DINFO,,AUTO
         5 000243   000000 471500                    LDP1    0,,PR0
         5 000244   040000 106500                    CMPC    fill='040'O
         5 000245   100003 200002                    ADSC9   3,,PR1                   cn=1,n=2
         5 000246   000005 000002 xsym               ADSC9   FO_OSYMBUF+5             cn=0,n=2
         5 000247   000236 601000 5                  TNZ     s:6652
         5 000250   040000 106500                    CMPC    fill='040'O
         5 000251   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000252   000007 000010 xsym               ADSC9   FO_OSYMBUF+7             cn=0,n=8
         5 000253   000236 601000 5                  TNZ     s:6652
         5 000254   040000 106500                    CMPC    fill='040'O
         5 000255   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000256   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000257   000264 600000 5                  TZE     s:6659
         5 000260   040000 106500                    CMPC    fill='040'O
         5 000261   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000262   000005 400002 xsym               ADSC9   FO_OSYMBUF+5             cn=2,n=2
         5 000263   000236 601000 5                  TNZ     s:6652

      260     6655    3                 AND KEYIN$ -> FO$RKEYIN.FTNAME = FO_OSYMBUF.FO_OSYMBDEV.TNAME
      261     6656    3                 AND (KEYIN$ -> FO$RKEYIN.DTW1.NUM = ' '
      262     6657    3                 OR KEYIN$ -> FO$RKEYIN.DTW1.NUM = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM)
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:44   
      263     6658    4                 THEN DO;

      264     6659    4                   OPMSG_ROUTE.NUM1 = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM;

   6659  5 000264   000005 720000 xsym               LXL0    FO_OSYMBUF+5
         5 000265   000012 740000 1                  STX0    OPMSG_ROUTE+7

      265     6660    4                   CALL UNROUTE_FROM;

   6660  5 000266   001232 701000 5                  TSX1    UNROUTE_FROM
         5 000267   000000 011000                    NOP     0

      266     6661    4                   END;

      267     6662
      268     6663    3                 END;

   6663  5 000270   000236 710000 5                  TRA     s:6652

   6657  5 000271                       NO_MORE_2    null
      269     6664
      270     6665    2   NO_MORE_2:  ;
      271     6666    2               FO_OSYMBKEY.LEN = 8;

   6666  5 000271   010000 236003                    LDQ     4096,DU
         5 000272   000000 552040 xsym               STBQ    FO_OSYMBKEY,'40'O

      272     6667
      273     6668    2               SAV$ = DEV$;

   6668  5 000273   000000 236000 xsym               LDQ     FO_DEV$
         5 000274   200025 756100                    STQ     SAV$,,AUTO

      274     6669    3                 DO I = 0 TO FOPR_MAX#;

   6669  5 000275   200005 450100                    STZ     I,,AUTO

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:45   
      275     6670    3                 FIL$ = FO_Q.FILHD$(I);

   6670  5 000276   200005 720100                    LXL0    I,,AUTO
         5 000277   000004 236010 xsym               LDQ     FO_Q+4,X0
         5 000300   000000 756000 xsym               STQ     FO_FIL$

      276     6671    4                   DO WHILE (FIL$ ~= ADDR(NIL));

   6671  5 000301   000310 710000 5                  TRA     s:6674

      277     6672    4                   CALL FOD$AVAIL;

   6672  5 000302   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000303   000000 701000 xent               TSX1    FOD$AVAIL
         5 000304   000000 011000                    NOP     0

      278     6673    4                   FIL$ = FIL$ -> FO$FIL.LNK$;

   6673  5 000305   000000 470400 xsym               LDP0    FO_FIL$
         5 000306   000000 236100                    LDQ     0,,PR0
         5 000307   000000 756000 xsym               STQ     FO_FIL$

      279     6674    4                   END;

   6674  5 000310   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000311   000302 601000 5                  TNZ     s:6672

      280     6675    3                 END;

   6675  5 000312   200005 235100                    LDA     I,,AUTO
         5 000313   000001 035007                    ADLA    1,DL
         5 000314   200005 755100                    STA     I,,AUTO
         5 000315   000023 115007                    CMPA    19,DL
         5 000316   000276 602000 5                  TNC     s:6670

      281     6676    2               DEV$ = SAV$;

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:46   
   6676  5 000317   200025 236100                    LDQ     SAV$,,AUTO
         5 000320   000000 756000 xsym               STQ     FO_DEV$

      282     6677
      283     6678    2               OPMSG_ROUTE.NUM1 = KEYIN$ -> FO$RKEYIN.DTW1.NUM;

   6678  5 000321   200004 470500                    LDP0    @DINFO,,AUTO
         5 000322   000000 471500                    LDP1    0,,PR0
         5 000323   040100 100500                    MLR     fill='040'O
         5 000324   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000325   200034 000004                    ADSC9   SAV$+7,,AUTO             cn=0,n=4
         5 000326   200034 220100                    LDX0    SAV$+7,,AUTO
         5 000327   000012 740000 1                  STX0    OPMSG_ROUTE+7

      284     6679    2               ERROR = B$TCB.ALT$ -> B$ALT.ERR;

   6679  5 000330   000000 471400 xsym               LDP1    B$TCB$
         5 000331   100000 473500                    LDP3    0,,PR1
         5 000332   300102 236100                    LDQ     66,,PR3
         5 000333   000000 756000 1                  STQ     ERROR

      285     6680
      286     6681    2               IF ERROR.ERR# ~= %E$EOF

   6681  5 000334   000000 236000 1                  LDQ     ERROR
         5 000335   377770 376007                    ANQ     131064,DL
         5 000336   000060 116007                    CMPQ    48,DL
         5 000337   000345 600000 5                  TZE     s:6687

      287     6682    3               THEN DO;

      288     6683    3                 OPMSG_ROUTE.SUBC = FORT_NOTTHERE#;

   6683  5 000340   000011 236003                    LDQ     9,DU
         5 000341   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      289     6684    3                 CALL WRITE_OCMSG_ROUTE;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:47   

   6684  5 000342   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000343   000000 011000                    NOP     0

      290     6685    3                 ALTRETURN;

   6685  5 000344   000000 702200 xent               TSX2  ! X66_AALT

      291     6686    3                 END;
      292     6687    2               OPMSG_ROUTE.SUBC = FORT_UCMPL#;

   6687  5 000345   000015 236003                    LDQ     13,DU
         5 000346   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      293     6688    2               CALL WRITE_OCMSG_ROUTE;

   6688  5 000347   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000350   000000 011000                    NOP     0

      294     6689    2               RETURN;

   6689  5 000351   000000 702200 xent               TSX2  ! X66_ARET

      295     6690
      296     6691           /* Unroute complete */
      297     6692
      298     6693    2             CASE (KEY_ROUTEADD#);

      299     6694
      300     6695    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '

   6695  5 000352   040000 106500                    CMPC    fill='040'O
         5 000353   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000354   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000355   000361 601000 5                  TNZ     s:6700

      301     6696    2               THEN
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:48   
      302     6697    2                KEYIN$ -> FO$RKEYIN.FTNAME = KEYIN$ -> FO$RKEYIN.CTNAME;

   6697  5 000356   040100 100500                    MLR     fill='040'O
         5 000357   100007 200010                    ADSC9   7,,PR1                   cn=1,n=8
         5 000360   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8

      303     6698
      304     6699
      305     6700    2               IF KEYIN$ -> FO$RKEYIN.FTNAME = ' '

   6700  5 000361   000000 471500                    LDP1    0,,PR0
         5 000362   040000 106500                    CMPC    fill='040'O
         5 000363   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000364   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000365   000375 601000 5                  TNZ     s:6706
         5 000366   040000 106500                    CMPC    fill='040'O
         5 000367   100007 200010                    ADSC9   7,,PR1                   cn=1,n=8
         5 000370   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000371   000375 601000 5                  TNZ     s:6706

      306     6701    2               AND KEYIN$ -> FO$RKEYIN.CTNAME = FOMI_SCTNAME#
      307     6702    3               THEN DO;

      308     6703    3                 KEYIN$ -> FO$RKEYIN.FTNAME = 'LOCAL';

   6703  5 000372   040100 100400                    MLR     fill='040'O
         5 000373   000042 000005 4                  ADSC9   FIRST_RECORD+4           cn=0,n=5
         5 000374   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8

      309     6704    3                 END;

      310     6705
      311     6706    2               OPMSG_ROUTE.TYP1 = KEYIN$ -> FO$RKEYIN.DTW1.TYP;

   6706  5 000375   000000 471500                    LDP1    0,,PR0
         5 000376   040100 100500                    MLR     fill='040'O
         5 000377   100003 200002                    ADSC9   3,,PR1                   cn=1,n=2
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:49   
         5 000400   200034 000004                    ADSC9   SAV$+7,,AUTO             cn=0,n=4
         5 000401   200034 220100                    LDX0    SAV$+7,,AUTO
         5 000402   000011 440000 1                  SXL0    OPMSG_ROUTE+6

      312     6707    2               OPMSG_ROUTE.TNAME1 = KEYIN$ -> FO$RKEYIN.FTNAME;

   6707  5 000403   000000 471500                    LDP1    0,,PR0
         5 000404   040000 100500                    MLR     fill='040'O
         5 000405   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000406   000012 400010 1                  ADSC9   OPMSG_ROUTE+7            cn=2,n=8

      313     6708
      314     6709    3                 DO WHILE ('1'B);

      315     6710    3                 CALL M$READ (READ_OSYMB) ALTRET (NO_MORE_3);

   6710  5 000407   000014 630400 4                  EPPR0   READ_OSYMB
         5 000410   440000 713400                    CLIMB   alt,read
         5 000411   401400 401760                    pmme    nvectors=4
         5 000412   000442 702000 5                  TSX2    NO_MORE_3

      316     6711
      317     6712    3                 IF KEYIN$ -> FO$RKEYIN.DTW1.TYP = FO_OSYMBUF.FO_OSYMBDEV.NAMER.TYP

   6712  5 000413   200004 470500                    LDP0    @DINFO,,AUTO
         5 000414   000000 471500                    LDP1    0,,PR0
         5 000415   040000 106500                    CMPC    fill='040'O
         5 000416   100003 200002                    ADSC9   3,,PR1                   cn=1,n=2
         5 000417   000005 000002 xsym               ADSC9   FO_OSYMBUF+5             cn=0,n=2
         5 000420   000407 601000 5                  TNZ     s:6710
         5 000421   040000 106500                    CMPC    fill='040'O
         5 000422   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         5 000423   000007 000010 xsym               ADSC9   FO_OSYMBUF+7             cn=0,n=8
         5 000424   000407 601000 5                  TNZ     s:6710
         5 000425   040000 106500                    CMPC    fill='040'O
         5 000426   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000427   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:50   
         5 000430   000435 600000 5                  TZE     s:6717
         5 000431   040000 106500                    CMPC    fill='040'O
         5 000432   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000433   000005 400002 xsym               ADSC9   FO_OSYMBUF+5             cn=2,n=2
         5 000434   000407 601000 5                  TNZ     s:6710

      318     6713    3                 AND KEYIN$ -> FO$RKEYIN.FTNAME = FO_OSYMBUF.FO_OSYMBDEV.TNAME
      319     6714    3                 AND (KEYIN$ -> FO$RKEYIN.DTW1.NUM = ' '
      320     6715    3                 OR KEYIN$ -> FO$RKEYIN.DTW1.NUM = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM)
      321     6716    4                 THEN DO;

      322     6717    4                   OPMSG_ROUTE.NUM1 = FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM;

   6717  5 000435   000005 720000 xsym               LXL0    FO_OSYMBUF+5
         5 000436   000012 740000 1                  STX0    OPMSG_ROUTE+7

      323     6718    4                   CALL ROUTE_ADD;

   6718  5 000437   001013 701000 5                  TSX1    ROUTE_ADD
         5 000440   000000 011000                    NOP     0

      324     6719    4                   END;

      325     6720    3                 END;

   6720  5 000441   000407 710000 5                  TRA     s:6710

   6715  5 000442                       NO_MORE_3    null
      326     6721
      327     6722    2   NO_MORE_3:  ;
      328     6723    2               FO_OSYMBKEY.LEN = 8;

   6723  5 000442   010000 236003                    LDQ     4096,DU
         5 000443   000000 552040 xsym               STBQ    FO_OSYMBKEY,'40'O

      329     6724
      330     6725    2               SAV$ = DEV$;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:51   

   6725  5 000444   000000 236000 xsym               LDQ     FO_DEV$
         5 000445   200025 756100                    STQ     SAV$,,AUTO

      331     6726    3                 DO I = 0 TO FOPR_MAX#;

   6726  5 000446   200005 450100                    STZ     I,,AUTO

      332     6727    3                 FIL$ = FO_Q.FILHD$(I);

   6727  5 000447   200005 720100                    LXL0    I,,AUTO
         5 000450   000004 236010 xsym               LDQ     FO_Q+4,X0
         5 000451   000000 756000 xsym               STQ     FO_FIL$

      333     6728    4                   DO WHILE (FIL$ ~= ADDR(NIL));

   6728  5 000452   000461 710000 5                  TRA     s:6731

      334     6729    4                   CALL FOD$AVAIL;

   6729  5 000453   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000454   000000 701000 xent               TSX1    FOD$AVAIL
         5 000455   000000 011000                    NOP     0

      335     6730    4                   FIL$ = FIL$ -> FO$FIL.LNK$;

   6730  5 000456   000000 470400 xsym               LDP0    FO_FIL$
         5 000457   000000 236100                    LDQ     0,,PR0
         5 000460   000000 756000 xsym               STQ     FO_FIL$

      336     6731    4                   END;

   6731  5 000461   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000462   000453 601000 5                  TNZ     s:6729

      337     6732    3                 END;

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:52   
   6732  5 000463   200005 235100                    LDA     I,,AUTO
         5 000464   000001 035007                    ADLA    1,DL
         5 000465   200005 755100                    STA     I,,AUTO
         5 000466   000023 115007                    CMPA    19,DL
         5 000467   000447 602000 5                  TNC     s:6727

      338     6733    2               DEV$ = SAV$;

   6733  5 000470   200025 236100                    LDQ     SAV$,,AUTO
         5 000471   000000 756000 xsym               STQ     FO_DEV$

      339     6734
      340     6735    2               OPMSG_ROUTE.NUM1 = KEYIN$ -> FO$RKEYIN.DTW1.NUM;

   6735  5 000472   200004 470500                    LDP0    @DINFO,,AUTO
         5 000473   000000 471500                    LDP1    0,,PR0
         5 000474   040100 100500                    MLR     fill='040'O
         5 000475   100003 600002                    ADSC9   3,,PR1                   cn=3,n=2
         5 000476   200034 000004                    ADSC9   SAV$+7,,AUTO             cn=0,n=4
         5 000477   200034 220100                    LDX0    SAV$+7,,AUTO
         5 000500   000012 740000 1                  STX0    OPMSG_ROUTE+7

      341     6736    2               ERROR = B$TCB.ALT$ -> B$ALT.ERR;

   6736  5 000501   000000 471400 xsym               LDP1    B$TCB$
         5 000502   100000 473500                    LDP3    0,,PR1
         5 000503   300102 236100                    LDQ     66,,PR3
         5 000504   000000 756000 1                  STQ     ERROR

      342     6737
      343     6738    2               IF ERROR.ERR# ~= %E$EOF

   6738  5 000505   000000 236000 1                  LDQ     ERROR
         5 000506   377770 376007                    ANQ     131064,DL
         5 000507   000060 116007                    CMPQ    48,DL
         5 000510   000516 600000 5                  TZE     s:6745

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:53   
      344     6739    3               THEN DO;

      345     6740    3                 OPMSG_ROUTE.SUBC = FORT_NOTTHERE#;

   6740  5 000511   000011 236003                    LDQ     9,DU
         5 000512   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      346     6741    3                 CALL WRITE_OCMSG_ROUTE;

   6741  5 000513   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000514   000000 011000                    NOP     0

      347     6742    3                 ALTRETURN;

   6742  5 000515   000000 702200 xent               TSX2  ! X66_AALT

      348     6743    3                 END;
      349     6744
      350     6745    2               OPMSG_ROUTE.SUBC = FORT_ADDCMP#;

   6745  5 000516   000016 236003                    LDQ     14,DU
         5 000517   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      351     6746    2               CALL WRITE_OCMSG_ROUTE;

   6746  5 000520   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000521   000000 011000                    NOP     0

      352     6747    2               RETURN;

   6747  5 000522   000000 702200 xent               TSX2  ! X66_ARET

      353     6748
      354     6749    2           END; /* END CASE */

   6749  5 000523   001630 710000 5                  TRA     s:7117

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:54   
      355     6750
      356     6751
      357     6752    1   CHECK_WSN: PROC ALTRET;

   6752  5 000524   200026 741300       CHECK_WSN    STX1  ! SAV$+1,,AUTO

      358     6753        /* IF DEV$ -> FO$DEV.FLG.COMPATABLE_WSNS
      359     6754           THEN
      360     6755             RETURN;
      361     6756           ELSE
      362     6757             ALTRETURN; */
      363     6758    2   END CHECK_WSN;

   6758  5 000525   000001 702211                    TSX2  ! 1,X1

      364     6759
      365     6760        /****************************************
      366     6761         ****************************************
      367     6762                   WRITE_OCMSG_ROUTE
      368     6763         ****************************************
      369     6764         ****************************************/
      370     6765    1   WRITE_OCMSG_ROUTE: PROC;

   6765  5 000526   200030 741300       WRITE_OCMSG* STX1  ! SAV$+3,,AUTO

      371     6766    2         IF EVENT ~= FORE_KEYN#

   6766  5 000527   200003 470500                    LDP0    @EVENT,,AUTO
         5 000530   000000 235100                    LDA     0,,PR0
         5 000531   000001 115007                    CMPA    1,DL
         5 000532   000536 600000 5                  TZE     s:6770

      372     6767    3         THEN DO;

      373     6768    3           CALL M$WRITE (OCMSG_ROUTE);

   6768  5 000533   000000 630400 4                  EPPR0   OCMSG_ROUTE
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:55   
         5 000534   040001 713400                    CLIMB   write
         5 000535   401400 401760                    pmme    nvectors=4

      374     6769    3           END;

      375     6770    2   END WRITE_OCMSG_ROUTE;

   6770  5 000536   200030 221300                    LDX1  ! SAV$+3,,AUTO
         5 000537   000001 702211                    TSX2  ! 1,X1

      376     6771
      377     6772
      378     6773
      379     6774        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:56   
      380     6775        /******************************************
      381     6776         ******************************************
      382     6777                       ROUTE_FROM
      383     6778         ******************************************
      384     6779         ******************************************/
      385     6780
      386     6781    1   ROUTE_FROM: PROC ALTRET;

   6781  5 000540   200026 741300       ROUTE_FROM   STX1  ! SAV$+1,,AUTO

      387     6782
      388     6783    2         ROUTE_TALLY = 0;

   6783  5 000541   200010 450100                    STZ     ROUTE_TALLY,,AUTO

      389     6784    3           DO I = 0 TO FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1;

   6784  5 000542   200005 450100                    STZ     I,,AUTO
         5 000543   000763 710000 5                  TRA     NEXT_FROM_WSN+3

      390     6785
      391     6786    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B

   6786  5 000544   200005 236100                    LDQ     I,,AUTO
         5 000545   000121 402007                    MPY     81,DL
         5 000546   000000 066406                    CMPB    filb='0'B
         5 000547   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1
         5 000550   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000551   000760 601000 5                  TNZ     NEXT_FROM_WSN

      392     6787    3           THEN
      393     6788    3            GOTO NEXT_FROM_WSN;
      394     6789
      395     6790
      396     6791    3           IF ((KEYIN$ -> FO$RKEYIN.WSN = ' '

   6791  5 000552   200004 470500                    LDP0    @DINFO,,AUTO
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:57   
         5 000553   000000 471500                    LDP1    0,,PR0
         5 000554   040000 106500                    CMPC    fill='040'O
         5 000555   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 000556   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000557   000566 600000 5                  TZE     s:6791+12
         5 000560   200005 236100                    LDQ     I,,AUTO
         5 000561   000011 402007                    MPY     9,DL
         5 000562   040006 106500                    CMPC    fill='040'O
         5 000563   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 000564   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 000565   000571 601000 5                  TNZ     s:6791+15
         5 000566   100001 236100                    LDQ     1,,PR1
         5 000567   777000 316003                    CANQ    -512,DU
         5 000570   000603 600000 5                  TZE     s:6798
         5 000571   200005 236100                    LDQ     I,,AUTO
         5 000572   000011 402007                    MPY     9,DL
         5 000573   040006 106500                    CMPC    fill='040'O
         5 000574   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 000575   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 000576   000760 600000 5                  TZE     NEXT_FROM_WSN
         5 000577   100001 236100                    LDQ     1,,PR1
         5 000600   777000 376003                    ANQ     -512,DU
         5 000601   001000 116003                    CMPQ    512,DU
         5 000602   000760 601000 5                  TNZ     NEXT_FROM_WSN

      397     6792    3           OR KEYIN$ -> FO$RKEYIN.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
      398     6793    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 0)
      399     6794    3           OR
      400     6795    3           (KEYIN$ -> FO$RKEYIN.WSN ~= FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      401     6796    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 1)
      402     6797    4           THEN DO;

      403     6798    4             ROUTE_TALLY = ROUTE_TALLY + 1;

   6798  5 000603   200010 235100                    LDA     ROUTE_TALLY,,AUTO
         5 000604   000001 035007                    ADLA    1,DL
         5 000605   200010 755100                    STA     ROUTE_TALLY,,AUTO
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:58   

      404     6799    4             CALL FIND_DEV

   6799  5 000606   001607 701000 5                  TSX1    FIND_DEV
         5 000607   000635 702000 5                  TSX2    s:6814

      405     6800    5             WHENRETURN DO;

      406     6801    5               IF DEV$ -> FO$DEV.RWSNL > 0

   6801  5 000610   000000 470400 xsym               LDP0    FO_DEV$
         5 000611   000014 236100                    LDQ     12,,PR0
         5 000612   000033 736000                    QLS     27
         5 000613   000033 732000                    QRS     27
         5 000614   000000 116003                    CMPQ    0,DU
         5 000615   000634 604400 5                  TMOZ    s:6809+1

      407     6802    6               THEN DO;

      408     6803    6                 IF DEV$ -> FO$DEV.RWSN

   6803  5 000616   200005 236100                    LDQ     I,,AUTO
         5 000617   000011 402007                    MPY     9,DL
         5 000620   040006 106500                    CMPC    fill='040'O
         5 000621   000020 200010                    ADSC9   16,,PR0                  cn=1,n=8
         5 000622   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 000623   000634 601000 5                  TNZ     s:6809+1

      409     6804    6                 = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      410     6805    7                 THEN DO;

      411     6806    7                   OPMSG_ROUTE.SUBC = FORT_NOPE#;

   6806  5 000624   000020 236003                    LDQ     16,DU
         5 000625   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      412     6807    7                   OPMSG_ROUTE.WSN = DEV$ -> FO$DEV.RWSN;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:59   

   6807  5 000626   040000 100500                    MLR     fill='040'O
         5 000627   000020 200010                    ADSC9   16,,PR0                  cn=1,n=8
         5 000630   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      413     6808    7                   CALL WRITE_OCMSG_ROUTE;

   6808  5 000631   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000632   000000 011000                    NOP     0

      414     6809    7                   GOTO NEXT_FROM_WSN;

   6809  5 000633   000760 710000 5                  TRA     NEXT_FROM_WSN
         5 000634   000662 710000 5                  TRA     s:6827

      415     6810    7                   END;
      416     6811    6                 END;
      417     6812    5               END;
      418     6813    5             WHENALTRETURN DO;

      419     6814    5               IF FO_OSYMBUF.FO_OSYMBDEV.RWSNL > 0

   6814  5 000635   000014 236000 xsym               LDQ     FO_OSYMBUF+12
         5 000636   000033 736000                    QLS     27
         5 000637   000033 732000                    QRS     27
         5 000640   000000 116003                    CMPQ    0,DU
         5 000641   000662 604400 5                  TMOZ    s:6827

      420     6815    6               THEN DO;

      421     6816    6                 IF FO_OSYMBUF.FO_OSYMBDEV.RWSN

   6816  5 000642   200005 236100                    LDQ     I,,AUTO
         5 000643   000011 402007                    MPY     9,DL
         5 000644   040006 106400                    CMPC    fill='040'O
         5 000645   000020 200010 xsym               ADSC9   FO_OSYMBUF+16            cn=1,n=8
         5 000646   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:60   
         5 000647   000662 601000 5                  TNZ     s:6827

      422     6817    6                 = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      423     6818    7                 THEN DO;

      424     6819    7                   OPMSG_ROUTE.SUBC = FORT_NOPE#;

   6819  5 000650   000020 236003                    LDQ     16,DU
         5 000651   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      425     6820    7                   OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   6820  5 000652   200005 236100                    LDQ     I,,AUTO
         5 000653   000011 402007                    MPY     9,DL
         5 000654   040000 100406                    MLR     fill='040'O
         5 000655   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 000656   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      426     6821    7                   CALL WRITE_OCMSG_ROUTE;

   6821  5 000657   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000660   000000 011000                    NOP     0

      427     6822    7                   GOTO NEXT_FROM_WSN;

   6822  5 000661   000760 710000 5                  TRA     NEXT_FROM_WSN

      428     6823    7                   END;
      429     6824    6                 END;
      430     6825    5               END;
      431     6826
      432     6827    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '0'B

   6827  5 000662   200005 236100                    LDQ     I,,AUTO
         5 000663   000121 402007                    MPY     81,DL
         5 000664   000000 066406                    CMPB    filb='0'B
         5 000665   000027 070001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=7,n=1
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:61   
         5 000666   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000667   000731 601000 5                  TNZ     s:6845
         5 000670   000000 066406                    CMPB    filb='0'B
         5 000671   000027 050001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=5,n=1
         5 000672   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000673   000731 600000 5                  TZE     s:6845

      433     6828    4             AND FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL (I) = '1'B
      434     6829    5             THEN DO;

      435     6830    5               FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '1'B;

   6830  5 000674   003006 060400                    CSL     bolr='003'O
         5 000675   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000676   000027 070001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=7,n=1

      436     6831    5               FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '0'B;

   6831  5 000677   003006 060400                    CSL     bolr='003'O
         5 000700   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 000701   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1

      437     6832    5               WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)

   6832  5 000702   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         5 000703   000012 402007                    MPY     10,DL
         5 000704   000133 036007                    ADLQ    91,DL
         5 000705   000020 736000                    QLS     16
         5 000706   000024 676000 1                  ERQ     WRITE_OSYMB+4
         5 000707   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000710   000024 656000 1                  ERSQ    WRITE_OSYMB+4

      438     6833    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      439     6834    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      440     6835    5               + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      441     6836    5               CALL M$WRITE (WRITE_OSYMB);

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:62   
   6836  5 000711   000020 630400 1                  EPPR0   WRITE_OSYMB
         5 000712   040001 713400                    CLIMB   write
         5 000713   401400 401760                    pmme    nvectors=4

      442     6837    5               CALL M$TRUNC (TRUNC_OSYMB);

   6837  5 000714   000032 630400 4                  EPPR0   TRUNC_OSYMB
         5 000715   050003 713400                    CLIMB   20483
         5 000716   400000 401760                    pmme    nvectors=1

      443     6838
      444     6839                         /* WSN X for lp01@tname routed to lp02@tname */
      445     6840    5               OPMSG_ROUTE.SUBC = FORT_ROK#;

   6840  5 000717   000005 236003                    LDQ     5,DU
         5 000720   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      446     6841    5               OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   6841  5 000721   200005 236100                    LDQ     I,,AUTO
         5 000722   000011 402007                    MPY     9,DL
         5 000723   040000 100406                    MLR     fill='040'O
         5 000724   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 000725   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      447     6842    5               CALL WRITE_OCMSG_ROUTE;

   6842  5 000726   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000727   000000 011000                    NOP     0

      448     6843    5               END;

   6843  5 000730   000760 710000 5                  TRA     NEXT_FROM_WSN

      449     6844    5             ELSE DO;

      450     6845    5               IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(I) = '0'B
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:63   

   6845  5 000731   000000 066406                    CMPB    filb='0'B
         5 000732   000027 050001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=5,n=1
         5 000733   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000734   000747 601000 5                  TNZ     s:6859

      451     6846    6               THEN DO;

      452     6847                       /* Cannot route to a routed wsn */
      453     6848                       /* WSN X not originally associated with lp01@local.
      454     6849                          No route done. */
      455     6850    6                 OPMSG_ROUTE.SUBC = FORT_NOTORIG#;

   6850  5 000735   000007 236003                    LDQ     7,DU
         5 000736   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      456     6851    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   6851  5 000737   200005 236100                    LDQ     I,,AUTO
         5 000740   000011 402007                    MPY     9,DL
         5 000741   040000 100406                    MLR     fill='040'O
         5 000742   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 000743   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      457     6852    6                 CALL WRITE_OCMSG_ROUTE;

   6852  5 000744   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000745   000000 011000                    NOP     0

      458     6853    6                 END;

   6853  5 000746   000760 710000 5                  TRA     NEXT_FROM_WSN

      459     6854    5               ELSE
      460     6855    6                 DO;

      461     6856                       /* Already routed */
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:64   
      462     6857                       /* WSN X FOR LP01@LOCAL is already routed to lp01@zzz.
      463     6858                          No route done. */
      464     6859    6                 OPMSG_ROUTE.SUBC = FORT_TOOLATE#;

   6859  5 000747   000010 236003                    LDQ     8,DU
         5 000750   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      465     6860    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   6860  5 000751   200005 236100                    LDQ     I,,AUTO
         5 000752   000011 402007                    MPY     9,DL
         5 000753   040000 100406                    MLR     fill='040'O
         5 000754   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 000755   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      466     6861    6                 CALL WRITE_OCMSG_ROUTE;

   6861  5 000756   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 000757   000000 011000                    NOP     0

      467     6862    6                 END;

      468     6863    5               END;

      469     6864    4             END;

   6860  5 000760                       NEXT_FROM_W* null
      470     6865    3   NEXT_FROM_WSN:;
      471     6866    3           END;

   6866  5 000760   200005 235100                    LDA     I,,AUTO
         5 000761   000001 035007                    ADLA    1,DL
         5 000762   200005 755100                    STA     I,,AUTO
         5 000763   200005 236100                    LDQ     I,,AUTO
         5 000764   000024 116000 xsym               CMPQ    FO_OSYMBUF+20
         5 000765   000544 602000 5                  TNC     s:6786

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:65   
      472     6867
      473     6868    2         IF ROUTE_TALLY ~= 0

   6868  5 000766   200010 235100                    LDA     ROUTE_TALLY,,AUTO
         5 000767   001005 600000 5                  TZE     s:6881

      474     6869    3         THEN DO;

      475     6870    3           CALL OSYMB_TO_DEV

   6870  5 000770   001437 701000 5                  TSX1    OSYMB_TO_DEV
         5 000771   000773 702000 5                  TSX2    s:6874
         5 000772   001004 710000 5                  TRA     s:6878

      476     6871    4           WHENALTRETURN DO;

      477     6872                       /* None of the specified devices were able to accept
      478     6873                          wsn x from dev$.  This wsn has not been routed. */
      479     6874    4             OPMSG_ROUTE.SUBC = FORT_NOROUTE#;

   6874  5 000773   000006 236003                    LDQ     6,DU
         5 000774   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      480     6875    4             OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   6875  5 000775   200005 236100                    LDQ     I,,AUTO
         5 000776   000011 402007                    MPY     9,DL
         5 000777   040000 100406                    MLR     fill='040'O
         5 001000   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001001   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      481     6876    4             CALL WRITE_OCMSG_ROUTE;

   6876  5 001002   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001003   000000 011000                    NOP     0

      482     6877    4             END;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:66   

      483     6878    3           END;

   6878  5 001004   001011 710000 5                  TRA     s:6884

      484     6879    2         ELSE
      485     6880    3           DO;

      486     6881    3           OPMSG_ROUTE.SUBC = FORT_NOWSN#;

   6881  5 001005   000012 236003                    LDQ     10,DU
         5 001006   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      487     6882    3           CALL WRITE_OCMSG_ROUTE;

   6882  5 001007   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001010   000000 011000                    NOP     0

      488     6883    3           END;

      489     6884    2         RETURN;

   6884  5 001011   200026 221300                    LDX1  ! SAV$+1,,AUTO
         5 001012   000001 702211                    TSX2  ! 1,X1

      490     6885
      491     6886    2   END ROUTE_FROM;
      492     6887
      493     6888        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:67   
      494     6889        /**************************************
      495     6890         **************************************
      496     6891                    ROUTE_ADD
      497     6892         **************************************
      498     6893         **************************************/
      499     6894
      500     6895    1   ROUTE_ADD: PROC;

   6895  5 001013   200026 741300       ROUTE_ADD    STX1  ! SAV$+1,,AUTO

      501     6896
      502     6897    2         K = -1;

   6897  5 001014   000001 335007                    LCA     1,DL
         5 001015   200007 755100                    STA     K,,AUTO

      503     6898    3           DO I = 0 TO (FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1);

   6898  5 001016   200005 450100                    STZ     I,,AUTO
         5 001017   001112 710000 5                  TRA     s:6927+3

      504     6899
      505     6900    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)

   6900  5 001020   200004 470500                    LDP0    @DINFO,,AUTO
         5 001021   000000 471500                    LDP1    0,,PR0
         5 001022   200005 236100                    LDQ     I,,AUTO
         5 001023   000011 402007                    MPY     9,DL
         5 001024   040100 106406                    CMPC    fill='040'O
         5 001025   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001026   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001027   001107 601000 5                  TNZ     s:6927

      506     6901    3           = KEYIN$ -> FO$RKEYIN.WSN
      507     6902    4           THEN DO;

      508     6903    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '1'B
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:68   

   6903  5 001030   200005 236100                    LDQ     I,,AUTO
         5 001031   000121 402007                    MPY     81,DL
         5 001032   000000 066406                    CMPB    filb='0'B
         5 001033   000027 070001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=7,n=1
         5 001034   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001035   001050 600000 5                  TZE     s:6910

      509     6904    5             THEN DO;

      510     6905    5               OPMSG_ROUTE.SUBC = FORT_OUT#;

   6905  5 001036   000002 236003                    LDQ     2,DU
         5 001037   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      511     6906    5               OPMSG_ROUTE.WSN = KEYIN$ -> FO$RKEYIN.WSN;

   6906  5 001040   000000 471500                    LDP1    0,,PR0
         5 001041   040000 100500                    MLR     fill='040'O
         5 001042   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001043   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      512     6907    5               CALL WRITE_OCMSG_ROUTE;

   6907  5 001044   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001045   000000 011000                    NOP     0

      513     6908    5               RETURN;

   6908  5 001046   200026 221300                    LDX1  ! SAV$+1,,AUTO
         5 001047   000001 702211                    TSX2  ! 1,X1

      514     6909    5               END;
      515     6910    4             IF (FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(I) = '1'B

   6910  5 001050   000000 066406                    CMPB    filb='0'B
         5 001051   000027 050001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=5,n=1
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:69   
         5 001052   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001053   001060 601000 5                  TNZ     s:6910+8
         5 001054   000000 066406                    CMPB    filb='0'B
         5 001055   000027 100001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=8,n=1
         5 001056   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001057   001076 600000 5                  TZE     s:6921
         5 001060   000000 066406                    CMPB    filb='0'B
         5 001061   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1
         5 001062   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001063   001076 601000 5                  TNZ     s:6921

      516     6911    4             OR FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '1'B)
      517     6912    4             AND
      518     6913    4             FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '0'B
      519     6914    5             THEN DO;

      520     6915    5               OPMSG_ROUTE.SUBC = FORT_HERE#;

   6915  5 001064   000003 236003                    LDQ     3,DU
         5 001065   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      521     6916    5               OPMSG_ROUTE.WSN = KEYIN$ -> FO$RKEYIN.WSN;

   6916  5 001066   000000 471500                    LDP1    0,,PR0
         5 001067   040000 100500                    MLR     fill='040'O
         5 001070   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001071   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      522     6917    5               CALL WRITE_OCMSG_ROUTE;

   6917  5 001072   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001073   000000 011000                    NOP     0

      523     6918    5               RETURN;

   6918  5 001074   200026 221300                    LDX1  ! SAV$+1,,AUTO
         5 001075   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:70   

      524     6919    5               END;
      525     6920
      526     6921    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B

   6921  5 001076   000000 066406                    CMPB    filb='0'B
         5 001077   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1
         5 001100   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001101   001107 600000 5                  TZE     s:6927
         5 001102   200007 235100                    LDA     K,,AUTO
         5 001103   000027 115000 xsym               CMPA    B_VECTNIL+23
         5 001104   001107 601000 5                  TNZ     s:6927

      527     6922    4             AND K = -1
      528     6923    5             THEN DO;

      529     6924    5               K = I;

   6924  5 001105   200005 235100                    LDA     I,,AUTO
         5 001106   200007 755100                    STA     K,,AUTO

      530     6925    5               END;

      531     6926    4             END;

      532     6927    3           END;

   6927  5 001107   200005 235100                    LDA     I,,AUTO
         5 001110   000001 035007                    ADLA    1,DL
         5 001111   200005 755100                    STA     I,,AUTO
         5 001112   200005 236100                    LDQ     I,,AUTO
         5 001113   000024 116000 xsym               CMPQ    FO_OSYMBUF+20
         5 001114   001020 602000 5                  TNC     s:6900

      533     6928    2         IF K = -1

   6928  5 001115   200007 235100                    LDA     K,,AUTO
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:71   
         5 001116   000027 115000 xsym               CMPA    B_VECTNIL+23
         5 001117   001124 601000 5                  TNZ     s:6934

      534     6929    3         THEN DO;

      535     6930    3           K = FO_OSYMBUF.FO_OSYMBWSN.NWSNS;

   6930  5 001120   000024 235000 xsym               LDA     FO_OSYMBUF+20
         5 001121   200007 755100                    STA     K,,AUTO

      536     6931    3           FO_OSYMBUF.FO_OSYMBWSN.NWSNS = FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1;

   6931  5 001122   000001 035007                    ADLA    1,DL
         5 001123   000024 755000 xsym               STA     FO_OSYMBUF+20

      537     6932    3           END;

      538     6933
      539     6934    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(K) = '0'B;

   6934  5 001124   200007 236100                    LDQ     K,,AUTO
         5 001125   000121 402007                    MPY     81,DL
         5 001126   000000 116003                    CMPQ    0,DU
         5 001127   001131 605000 5                  TPL     s:6934+5
         5 001130   000044 036003                    ADLQ    36,DU
         5 001131   003006 060400                    CSL     bolr='003'O
         5 001132   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 001133   000027 050001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=5,n=1

      540     6935    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(K) = '0'B;

   6935  5 001134   200007 236100                    LDQ     K,,AUTO
         5 001135   000121 402007                    MPY     81,DL
         5 001136   000000 116003                    CMPQ    0,DU
         5 001137   001141 605000 5                  TPL     s:6935+5
         5 001140   000044 036003                    ADLQ    36,DU
         5 001141   003006 060400                    CSL     bolr='003'O
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:72   
         5 001142   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 001143   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1

      541     6936    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(K) = '1'B;

   6936  5 001144   200007 236100                    LDQ     K,,AUTO
         5 001145   000121 402007                    MPY     81,DL
         5 001146   000000 116003                    CMPQ    0,DU
         5 001147   001151 605000 5                  TPL     s:6936+5
         5 001150   000044 036003                    ADLQ    36,DU
         5 001151   003006 060400                    CSL     bolr='003'O
         5 001152   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 001153   000027 100001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=8,n=1

      542     6937    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(K) = '0'B;

   6937  5 001154   200007 236100                    LDQ     K,,AUTO
         5 001155   000121 402007                    MPY     81,DL
         5 001156   000000 116003                    CMPQ    0,DU
         5 001157   001161 605000 5                  TPL     s:6937+5
         5 001160   000044 036003                    ADLQ    36,DU
         5 001161   003006 060400                    CSL     bolr='003'O
         5 001162   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 001163   000027 070001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=7,n=1

      543     6938    2         FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(K) =

   6938  5 001164   200004 470500                    LDP0    @DINFO,,AUTO
         5 001165   000000 471500                    LDP1    0,,PR0
         5 001166   200007 236100                    LDQ     K,,AUTO
         5 001167   000011 402007                    MPY     9,DL
         5 001170   040006 100500                    MLR     fill='040'O
         5 001171   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001172   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8

      544     6939    2         KEYIN$ -> FO$RKEYIN.WSN;
      545     6940    2         WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:73   

   6940  5 001173   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         5 001174   000012 402007                    MPY     10,DL
         5 001175   000133 036007                    ADLQ    91,DL
         5 001176   000020 736000                    QLS     16
         5 001177   000024 676000 1                  ERQ     WRITE_OSYMB+4
         5 001200   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001201   000024 656000 1                  ERSQ    WRITE_OSYMB+4

      546     6941    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      547     6942    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      548     6943    2         + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      549     6944    2         CALL M$WRITE (WRITE_OSYMB);

   6944  5 001202   000020 630400 1                  EPPR0   WRITE_OSYMB
         5 001203   040001 713400                    CLIMB   write
         5 001204   401400 401760                    pmme    nvectors=4

      550     6945    2         CALL M$TRUNC (TRUNC_OSYMB);

   6945  5 001205   000032 630400 4                  EPPR0   TRUNC_OSYMB
         5 001206   050003 713400                    CLIMB   20483
         5 001207   400000 401760                    pmme    nvectors=1

      551     6946
      552     6947
      553     6948    2         CALL OSYMB_TO_DEV

   6948  5 001210   001437 701000 5                  TSX1    OSYMB_TO_DEV
         5 001211   001224 702000 5                  TSX2    s:6956

      554     6949    3         WHENRETURN DO;

      555     6950
      556     6951    3           OPMSG_ROUTE.SUBC = FORT_ADDON#;

   6951  5 001212   000004 236003                    LDQ     4,DU
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:74   
         5 001213   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      557     6952    3           OPMSG_ROUTE.WSN = KEYIN$ -> FO$RKEYIN.WSN;

   6952  5 001214   200004 470500                    LDP0    @DINFO,,AUTO
         5 001215   000000 471500                    LDP1    0,,PR0
         5 001216   040000 100500                    MLR     fill='040'O
         5 001217   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001220   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      558     6953    3           CALL WRITE_OCMSG_ROUTE;

   6953  5 001221   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001222   000000 011000                    NOP     0

      559     6954    3           END;

   6954  5 001223   001230 710000 5                  TRA     s:6960

      560     6955    3         WHENALTRETURN DO;

      561     6956    3           OPMSG_ROUTE.SUBC = FORT_NOROUTE#;

   6956  5 001224   000006 236003                    LDQ     6,DU
         5 001225   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      562     6957    3           CALL WRITE_OCMSG_ROUTE;

   6957  5 001226   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001227   000000 011000                    NOP     0

      563     6958    3           END;

      564     6959
      565     6960    2   END ROUTE_ADD;

   6960  5 001230   200026 221300                    LDX1  ! SAV$+1,,AUTO
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:75   
         5 001231   000001 702211                    TSX2  ! 1,X1

      566     6961
      567     6962
      568     6963        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:76   
      569     6964
      570     6965        /***************************************
      571     6966         ***************************************
      572     6967                     UNROUTE_FROM
      573     6968         ***************************************
      574     6969         ***************************************/
      575     6970
      576     6971    1   UNROUTE_FROM: PROC;

   6971  5 001232   200026 741300       UNROUTE_FROM STX1  ! SAV$+1,,AUTO

      577     6972
      578     6973    2         ROUTE_TALLY = 0;

   6973  5 001233   200010 450100                    STZ     ROUTE_TALLY,,AUTO

      579     6974
      580     6975    3           DO I = 0 TO (FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1);

   6975  5 001234   200005 450100                    STZ     I,,AUTO
         5 001235   001421 710000 5                  TRA     NEXT_WSN_2+3

      581     6976
      582     6977    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B

   6977  5 001236   200005 236100                    LDQ     I,,AUTO
         5 001237   000121 402007                    MPY     81,DL
         5 001240   000000 066406                    CMPB    filb='0'B
         5 001241   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1
         5 001242   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001243   001416 601000 5                  TNZ     NEXT_WSN_2

      583     6978    3           THEN
      584     6979    3            GOTO NEXT_WSN_2;
      585     6980
      586     6981    3           IF ((KEYIN$ -> FO$RKEYIN.WSN = ' '

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:77   
   6981  5 001244   200004 470500                    LDP0    @DINFO,,AUTO
         5 001245   000000 471500                    LDP1    0,,PR0
         5 001246   040000 106500                    CMPC    fill='040'O
         5 001247   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001250   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001251   001260 600000 5                  TZE     s:6981+12
         5 001252   200005 236100                    LDQ     I,,AUTO
         5 001253   000011 402007                    MPY     9,DL
         5 001254   040006 106500                    CMPC    fill='040'O
         5 001255   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001256   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001257   001263 601000 5                  TNZ     s:6981+15
         5 001260   100001 236100                    LDQ     1,,PR1
         5 001261   777000 316003                    CANQ    -512,DU
         5 001262   001275 600000 5                  TZE     s:6988
         5 001263   200005 236100                    LDQ     I,,AUTO
         5 001264   000011 402007                    MPY     9,DL
         5 001265   040006 106500                    CMPC    fill='040'O
         5 001266   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8
         5 001267   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001270   001416 600000 5                  TZE     NEXT_WSN_2
         5 001271   100001 236100                    LDQ     1,,PR1
         5 001272   777000 376003                    ANQ     -512,DU
         5 001273   001000 116003                    CMPQ    512,DU
         5 001274   001416 601000 5                  TNZ     NEXT_WSN_2

      587     6982    3           OR KEYIN$ -> FO$RKEYIN.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
      588     6983    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 0)
      589     6984    3           OR
      590     6985    3           (KEYIN$ -> FO$RKEYIN.WSN ~= FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I)
      591     6986    3           AND KEYIN$ -> FO$RKEYIN.NOTWSN = 1)
      592     6987    4           THEN DO;

      593     6988    4             ROUTE_TALLY = ROUTE_TALLY + 1;

   6988  5 001275   200010 235100                    LDA     ROUTE_TALLY,,AUTO
         5 001276   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:78   
         5 001277   200010 755100                    STA     ROUTE_TALLY,,AUTO

      594     6989    4             IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL(I) = '1'B

   6989  5 001300   200005 236100                    LDQ     I,,AUTO
         5 001301   000121 402007                    MPY     81,DL
         5 001302   000000 066406                    CMPB    filb='0'B
         5 001303   000027 050001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=5,n=1
         5 001304   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001305   001344 600000 5                  TZE     s:7005
         5 001306   000000 066406                    CMPB    filb='0'B
         5 001307   000027 070001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=7,n=1
         5 001310   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001311   001344 600000 5                  TZE     s:7005

      595     6990    4             AND FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '1'B
      596     6991    5             THEN DO;

      597     6992    5               FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT(I) = '0'B;

   6992  5 001312   003006 060400                    CSL     bolr='003'O
         5 001313   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 001314   000027 070001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=7,n=1

      598     6993    5               WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)

   6993  5 001315   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         5 001316   000012 402007                    MPY     10,DL
         5 001317   000133 036007                    ADLQ    91,DL
         5 001320   000020 736000                    QLS     16
         5 001321   000024 676000 1                  ERQ     WRITE_OSYMB+4
         5 001322   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001323   000024 656000 1                  ERSQ    WRITE_OSYMB+4

      599     6994    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      600     6995    5               + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      601     6996    5               + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:79   
      602     6997    5               CALL M$WRITE (WRITE_OSYMB);

   6997  5 001324   000020 630400 1                  EPPR0   WRITE_OSYMB
         5 001325   040001 713400                    CLIMB   write
         5 001326   401400 401760                    pmme    nvectors=4

      603     6998    5               CALL M$TRUNC (TRUNC_OSYMB);

   6998  5 001327   000032 630400 4                  EPPR0   TRUNC_OSYMB
         5 001330   050003 713400                    CLIMB   20483
         5 001331   400000 401760                    pmme    nvectors=1

      604     6999    5               OPMSG_ROUTE.SUBC = FORT_UCMP#;

   6999  5 001332   000014 236003                    LDQ     12,DU
         5 001333   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      605     7000    5               OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   7000  5 001334   200005 236100                    LDQ     I,,AUTO
         5 001335   000011 402007                    MPY     9,DL
         5 001336   040000 100406                    MLR     fill='040'O
         5 001337   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001340   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      606     7001    5               CALL WRITE_OCMSG_ROUTE;

   7001  5 001341   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001342   000000 011000                    NOP     0

      607     7002    5               END;

   7002  5 001343   001416 710000 5                  TRA     NEXT_WSN_2

      608     7003    4             ELSE
      609     7004    5               DO;

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:80   
      610     7005    5               IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '1'B

   7005  5 001344   000000 066406                    CMPB    filb='0'B
         5 001345   000027 100001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=8,n=1
         5 001346   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 001347   001405 600000 5                  TZE     s:7023

      611     7006    6               THEN DO;

      612     7007                       /* WSN not asociated with this device */
      613     7008    6                 FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '0'B;

   7008  5 001350   003006 060400                    CSL     bolr='003'O
         5 001351   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 001352   000027 100001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=8,n=1

      614     7009    6                 FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B;

   7009  5 001353   003006 060400                    CSL     bolr='003'O
         5 001354   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 001355   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1

      615     7010    6                 WRITE_OSYMB.BUF_.BOUND = LENGTHC (FO_OSYMBUF.FO_OSYMBDEV)

   7010  5 001356   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         5 001357   000012 402007                    MPY     10,DL
         5 001360   000133 036007                    ADLQ    91,DL
         5 001361   000020 736000                    QLS     16
         5 001362   000024 676000 1                  ERQ     WRITE_OSYMB+4
         5 001363   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001364   000024 656000 1                  ERSQ    WRITE_OSYMB+4

      616     7011    6                 + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      617     7012    6                 + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      618     7013    6                 + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      619     7014    6                 CALL M$WRITE (WRITE_OSYMB);

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:81   
   7014  5 001365   000020 630400 1                  EPPR0   WRITE_OSYMB
         5 001366   040001 713400                    CLIMB   write
         5 001367   401400 401760                    pmme    nvectors=4

      620     7015    6                 CALL M$TRUNC (TRUNC_OSYMB);

   7015  5 001370   000032 630400 4                  EPPR0   TRUNC_OSYMB
         5 001371   050003 713400                    CLIMB   20483
         5 001372   400000 401760                    pmme    nvectors=1

      621     7016    6                 OPMSG_ROUTE.SUBC = FORT_UACMP#;

   7016  5 001373   000017 236003                    LDQ     15,DU
         5 001374   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      622     7017    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   7017  5 001375   200005 236100                    LDQ     I,,AUTO
         5 001376   000011 402007                    MPY     9,DL
         5 001377   040000 100406                    MLR     fill='040'O
         5 001400   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001401   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      623     7018    6                 CALL WRITE_OCMSG_ROUTE;

   7018  5 001402   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001403   000000 011000                    NOP     0

      624     7019    6                 END;

   7019  5 001404   001416 710000 5                  TRA     NEXT_WSN_2

      625     7020    5               ELSE
      626     7021    6                 DO;

      627     7022                       /* WSN not routed out */
      628     7023    6                 OPMSG_ROUTE.SUBC = FORT_NORTE#;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:82   

   7023  5 001405   000013 236003                    LDQ     11,DU
         5 001406   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      629     7024    6                 OPMSG_ROUTE.WSN = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I);

   7024  5 001407   200005 236100                    LDQ     I,,AUTO
         5 001410   000011 402007                    MPY     9,DL
         5 001411   040000 100406                    MLR     fill='040'O
         5 001412   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001413   000014 400010 1                  ADSC9   OPMSG_ROUTE+9            cn=2,n=8

      630     7025    6                 CALL WRITE_OCMSG_ROUTE;

   7025  5 001414   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001415   000000 011000                    NOP     0

      631     7026    6                 END;

      632     7027    5               END;

      633     7028    4             END;

   7028  5 001416                       NEXT_WSN_2   null
      634     7029    3   NEXT_WSN_2:;
      635     7030    3           END;

   7030  5 001416   200005 235100                    LDA     I,,AUTO
         5 001417   000001 035007                    ADLA    1,DL
         5 001420   200005 755100                    STA     I,,AUTO
         5 001421   200005 236100                    LDQ     I,,AUTO
         5 001422   000024 116000 xsym               CMPQ    FO_OSYMBUF+20
         5 001423   001236 602000 5                  TNC     s:6977

      636     7031
      637     7032    2         IF ROUTE_TALLY ~= 0

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:83   
   7032  5 001424   200010 235100                    LDA     ROUTE_TALLY,,AUTO
         5 001425   001431 600000 5                  TZE     s:7038

      638     7033    3         THEN DO;

      639     7034    3           CALL OSYMB_TO_DEV;

   7034  5 001426   001437 701000 5                  TSX1    OSYMB_TO_DEV
         5 001427   000000 011000                    NOP     0

      640     7035    3           END;

   7035  5 001430   001435 710000 5                  TRA     s:7042

      641     7036    2         ELSE
      642     7037    3           DO;

      643     7038    3           OPMSG_ROUTE.SUBC = FORT_NOWSN#;

   7038  5 001431   000012 236003                    LDQ     10,DU
         5 001432   000011 552020 1                  STBQ    OPMSG_ROUTE+6,'20'O

      644     7039    3           CALL WRITE_OCMSG_ROUTE;

   7039  5 001433   000526 701000 5                  TSX1    WRITE_OCMSG_ROUTE
         5 001434   000000 011000                    NOP     0

      645     7040    3           END;

      646     7041
      647     7042    2         RETURN;

   7042  5 001435   200026 221300                    LDX1  ! SAV$+1,,AUTO
         5 001436   000001 702211                    TSX2  ! 1,X1

      648     7043    2   END UNROUTE_FROM;
      649     7044        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:84   
      650     7045        /****************************************
      651     7046         ****************************************
      652     7047                   OSYMB_TO_DEV
      653     7048         ****************************************
      654     7049         ****************************************/
      655     7050    1   OSYMB_TO_DEV: PROC ALTRET;

   7050  5 001437   200030 741300       OSYMB_TO_DEV STX1  ! SAV$+3,,AUTO

      656     7051
      657     7052    2         CALL FIND_DEV

   7052  5 001440   001607 701000 5                  TSX1    FIND_DEV
         5 001441   001443 702000 5                  TSX2    s:7054
         5 001442   001445 710000 5                  TRA     s:7057

      658     7053    3         WHENALTRETURN DO;

      659     7054    3           RETURN;

   7054  5 001443   200030 221300                    LDX1  ! SAV$+3,,AUTO
         5 001444   000001 702211                    TSX2  ! 1,X1

      660     7055    3           END;
      661     7056
      662     7057    3           DO I = 0 TO (FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1);

   7057  5 001445   200005 450100                    STZ     I,,AUTO
         5 001446   001602 710000 5                  TRA     NEXT_WSN+3

      663     7058
      664     7059
      665     7060    3           WSN$ = DEV$ -> FO$DEV.WSN$;

   7060  5 001447   000000 470400 xsym               LDP0    FO_DEV$
         5 001450   000004 236100                    LDQ     4,,PR0
         5 001451   200013 756100                    STQ     WSN$,,AUTO
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:85   

      666     7061    4             DO WHILE (WSN$ ~= ADDR(NIL));

   7061  5 001452   001513 710000 5                  TRA     s:7073

      667     7062    5               DO J = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);

   7062  5 001453   200006 450100                    STZ     J,,AUTO
         5 001454   001503 710000 5                  TRA     s:7070+3

      668     7063    5               IF (WSN$ -> FO$WSN.WSN.WSN_NAME(J)

   7063  5 001455   200006 236100                    LDQ     J,,AUTO
         5 001456   000011 402007                    MPY     9,DL
         5 001457   200034 756100                    STQ     SAV$+7,,AUTO
         5 001460   200005 236100                    LDQ     I,,AUTO
         5 001461   000011 402007                    MPY     9,DL
         5 001462   200013 470500                    LDP0    WSN$,,AUTO
         5 001463   200034 235100                    LDA     SAV$+7,,AUTO
         5 001464   040006 106505                    CMPC    fill='040'O
         5 001465   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         5 001466   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         5 001467   001500 601000 5                  TNZ     s:7070

      669     7064    5               = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
      670     7065    6               THEN DO;

      671     7066    6                 WSN$ -> FO$WSN.WSN(J) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);

   7066  5 001470   200034 756100                    STQ     SAV$+7,,AUTO
         5 001471   200006 236100                    LDQ     J,,AUTO
         5 001472   000011 402007                    MPY     9,DL
         5 001473   200034 235100                    LDA     SAV$+7,,AUTO
         5 001474   000106 100405                    MLR     fill='000'O
         5 001475   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,A          cn=0,n=9
         5 001476   000002 000011                    ADSC9   2,Q,PR0                  cn=0,n=9

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:86   
      672     7067    6                 GOTO NEXT_WSN;

   7067  5 001477   001577 710000 5                  TRA     NEXT_WSN

      673     7068    6                 END;
      674     7069
      675     7070    5               END;

   7070  5 001500   200006 235100                    LDA     J,,AUTO
         5 001501   000001 035007                    ADLA    1,DL
         5 001502   200006 755100                    STA     J,,AUTO
         5 001503   200013 470500                    LDP0    WSN$,,AUTO
         5 001504   200006 236100                    LDQ     J,,AUTO
         5 001505   000001 116100                    CMPQ    1,,PR0
         5 001506   001455 602000 5                  TNC     s:7063

      676     7071    4             WSNLNK$ = WSN$;

   7071  5 001507   200013 236100                    LDQ     WSN$,,AUTO
         5 001510   200014 756100                    STQ     WSNLNK$,,AUTO

      677     7072    4             WSN$ = WSN$ -> FO$WSN.LNK$;

   7072  5 001511   000000 236100                    LDQ     0,,PR0
         5 001512   200013 756100                    STQ     WSN$,,AUTO

      678     7073    4             END;

   7073  5 001513   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 001514   001453 601000 5                  TNZ     s:7062

      679     7074
      680     7075    3           WSN$ = WSNLNK$;

   7075  5 001515   200014 236100                    LDQ     WSNLNK$,,AUTO
         5 001516   200013 756100                    STQ     WSN$,,AUTO

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:87   
      681     7076    3           IF WSN$ -> FO$WSN.NWSNS < 4

   7076  5 001517   200013 470500                    LDP0    WSN$,,AUTO
         5 001520   000001 235100                    LDA     1,,PR0
         5 001521   000004 115007                    CMPA    4,DL
         5 001522   001540 603000 5                  TRC     s:7083

      682     7077    4           THEN DO;

      683     7078    4             WSN$ -> FO$WSN.NWSNS = WSN$ -> FO$WSN.NWSNS + 1;

   7078  5 001523   000001 035007                    ADLA    1,DL
         5 001524   000001 755100                    STA     1,,PR0

      684     7079    4             WSN$ -> FO$WSN.WSN(J) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);

   7079  5 001525   200005 236100                    LDQ     I,,AUTO
         5 001526   000011 402007                    MPY     9,DL
         5 001527   200034 756100                    STQ     SAV$+7,,AUTO
         5 001530   200006 236100                    LDQ     J,,AUTO
         5 001531   000011 402007                    MPY     9,DL
         5 001532   200034 235100                    LDA     SAV$+7,,AUTO
         5 001533   200013 470500                    LDP0    WSN$,,AUTO
         5 001534   000106 100405                    MLR     fill='000'O
         5 001535   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,A          cn=0,n=9
         5 001536   000002 000011                    ADSC9   2,Q,PR0                  cn=0,n=9

      685     7080    4             END;

   7080  5 001537   001577 710000 5                  TRA     NEXT_WSN

      686     7081    3           ELSE
      687     7082    4             DO;

      688     7083    4             WSNLNK$ = WSN$;

   7083  5 001540   200014 756100                    STQ     WSNLNK$,,AUTO
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:88   

      689     7084    4             CALL FOI$GBUF (FO_DEVSCB, WSN$)

   7084  5 001541   200013 631500                    EPPR1   WSN$,,AUTO
         5 001542   200035 451500                    STP1    SAV$+8,,AUTO
         5 001543   000000 236000 6                  LDQ     0
         5 001544   200034 756100                    STQ     SAV$+7,,AUTO
         5 001545   200034 630500                    EPPR0   SAV$+7,,AUTO
         5 001546   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001547   000000 701000 xent               TSX1    FOI$GBUF
         5 001550   001552 702000 5                  TSX2    s:7086
         5 001551   001554 710000 5                  TRA     s:7088

      690     7085    5             WHENALTRETURN DO;

      691     7086    5               ALTRETURN;

   7086  5 001552   200030 221300                    LDX1  ! SAV$+3,,AUTO
         5 001553   000000 702211                    TSX2  ! 0,X1

      692     7087    5               END;
      693     7088    4             WSNLNK$ -> FO$WSN.LNK$ = WSN$;

   7088  5 001554   200013 236100                    LDQ     WSN$,,AUTO
         5 001555   200014 470500                    LDP0    WSNLNK$,,AUTO
         5 001556   000000 756100                    STQ     0,,PR0

      694     7089    4             WSN$ -> FO$WSN.LNK$ = ADDR(NIL);

   7089  5 001557   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 001560   200013 471500                    LDP1    WSN$,,AUTO
         5 001561   100000 756100                    STQ     0,,PR1

      695     7090    4             WSN$ -> FO$WSN.NWSNS = 1;

   7090  5 001562   000001 235007                    LDA     1,DL
         5 001563   200013 471500                    LDP1    WSN$,,AUTO
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:89   
         5 001564   100001 755100                    STA     1,,PR1

      696     7091    4             WSN$ -> FO$WSN.WSN(WSN$ -> FO$WSN.NWSNS - 1)

   7091  5 001565   200013 471500                    LDP1    WSN$,,AUTO
         5 001566   100001 236100                    LDQ     1,,PR1
         5 001567   000011 402007                    MPY     9,DL
         5 001570   200034 756100                    STQ     SAV$+7,,AUTO
         5 001571   200005 236100                    LDQ     I,,AUTO
         5 001572   000011 402007                    MPY     9,DL
         5 001573   200034 235100                    LDA     SAV$+7,,AUTO
         5 001574   000105 100406                    MLR     fill='000'O
         5 001575   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=9
         5 001576   177777 600011                    ADSC9   -1,A,PR1                 cn=3,n=9

      697     7092    4             = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);
      698     7093    4             END;

   7091  5 001577                       NEXT_WSN     null
      699     7094    3   NEXT_WSN:;
      700     7095    3           END;

   7095  5 001577   200005 235100                    LDA     I,,AUTO
         5 001600   000001 035007                    ADLA    1,DL
         5 001601   200005 755100                    STA     I,,AUTO
         5 001602   200005 236100                    LDQ     I,,AUTO
         5 001603   000024 116000 xsym               CMPQ    FO_OSYMBUF+20
         5 001604   001447 602000 5                  TNC     s:7060

      701     7096    2         RETURN;

   7096  5 001605   200030 221300                    LDX1  ! SAV$+3,,AUTO
         5 001606   000001 702211                    TSX2  ! 1,X1

      702     7097    2   END OSYMB_TO_DEV;
      703     7098
      704     7099        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:90   
      705     7100        /****************************************
      706     7101         ****************************************
      707     7102                        FIND_DEV
      708     7103         ****************************************
      709     7104         ****************************************/
      710     7105    1   FIND_DEV: PROC ALTRET;

   7105  5 001607   200032 741300       FIND_DEV     STX1  ! SAV$+5,,AUTO

      711     7106
      712     7107    2         DEV$ = FO_Q.DEVHD$;

   7107  5 001610   000002 236000 xsym               LDQ     FO_Q+2
         5 001611   000000 756000 xsym               STQ     FO_DEV$

      713     7108    3           DO WHILE (DEV$ ~= ADDR(NIL));

   7108  5 001612   001624 710000 5                  TRA     s:7113

      714     7109    3           IF FO_OSYMBKEY.NAME = DEV$ -> FO$DEV.NAME

   7109  5 001613   000000 470400 xsym               LDP0    FO_DEV$
         5 001614   040100 106400                    CMPC    fill='040'O
         5 001615   000000 200010 xsym               ADSC9   FO_OSYMBKEY              cn=1,n=8
         5 001616   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         5 001617   001622 601000 5                  TNZ     s:7112

      715     7110    3           THEN
      716     7111    3            RETURN;

   7111  5 001620   200032 221300                    LDX1  ! SAV$+5,,AUTO
         5 001621   000001 702211                    TSX2  ! 1,X1

      717     7112    3           DEV$ = DEV$ -> FO$DEV.LNK$;

   7112  5 001622   000000 236100                    LDQ     0,,PR0
         5 001623   000000 756000 xsym               STQ     FO_DEV$
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:91   

      718     7113    3           END;

   7113  5 001624   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 001625   001613 601000 5                  TNZ     s:7109

      719     7114    2         ALTRETURN;

   7114  5 001626   200032 221300                    LDX1  ! SAV$+5,,AUTO
         5 001627   000000 702211                    TSX2  ! 0,X1

      720     7115    2   END FIND_DEV;
      721     7116        %EJECT;
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:92   
      722     7117    1   END FOU$ROOSTER;

   7117  5 001630   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:93   
--  Include file information  --

   F_ERRORS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   FO_SCODE_C.:E05TOU  is referenced.
   FOO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FOU$ROOSTER.
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:94   

 **** Variables and constants ****

  ****  Section 001  Data  FOU$ROOSTER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 ERROR                      3-0-0/c STRC(414)   r     1 OPMSG_ROUTE
    20-0-0/d STRC(432)   r     1 WRITE_OSYMB

  ****  Section 004 RoData FOU$ROOSTER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/d STRC(144)   r     1 FIRST_RECORD               0-0-0/d STRC(432)   r     1 OCMSG_ROUTE
    14-0-0/d STRC(504)   r     1 READ_OSYMB                32-0-0/d STRC(144)   r     1 TRUNC_OSYMB

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DINFO                     3-0-0/w PTR         r     1 @EVENT
    *0-0-0/w UBIN        r     1 DINFO                     *0-0-0/w UBIN        r     1 EVENT
     5-0-0/w UBIN        r     1 I                          6-0-0/w UBIN        r     1 J
     7-0-0/w SBIN        r     1 K                         *0-0-0/w PTR         r     1 KEYIN$
    11-0-0/b BIT         r     1 ROUTE_COMPLETE            10-0-0/w UBIN        r     1 ROUTE_TALLY
    25-0-0/w PTR         r     1 SAV$                      13-0-0/w PTR         r     1 WSN$
    14-0-0/w PTR         r     1 WSNLNK$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 FO_DEV$
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:95   
     0-0-0/w STRC(288)   r     1 FO_DEVSCB                  0-0-0/w PTR         r     1 FO_FIL$
     0-0-0/w STRC(81)    r     1 FO_OSYMBKEY                0-0-0/w STRC(21600) r     1 FO_OSYMBUF
     0-0-0/d STRC(1512)  r     1 FO_Q

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(657)   r     1 FO$DEV                     0-0-0/w STRC(1332)  r     1 FO$FIL
     0-0-0/w ASTR(351)   r     1 FO$JOB                     0-0-0/w STRC(333)   r     1 FO$RKEYIN
     0-0-0/w STRC(396)   r     1 FO$WSN                     0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$OSYMB


   Procedure FOU$ROOSTER requires 921 words for executable code.
   Procedure FOU$ROOSTER requires 30 words of local(AUTO) storage.

    No errors detected in file FOU$ROOSTER.:E05TSI    .
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:96   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:97   
          MINI XREF LISTING

B$ALT.CODE
      6301**DCL      6301--REDEF    6302--REDEF    6302--REDEF
B$ALT.ERR
      6302**DCL      6679>>ASSIGN   6736>>ASSIGN
B$ALT.ERR.ERR#
      6303**DCL      6303--REDEF
B$ALT.EVID
      6302**DCL      6302--REDEF    6302--REDEF
B$TCB.ALT$
      6297**DCL      6679>>ASSIGN   6736>>ASSIGN
B$TCB$
      6310**DCL      6297--IMP-PTR  6679>>ASSIGN   6736>>ASSIGN
CHECK_WSN
      6752**PROC     6591--CALL
DINFO
        24**DCL        16--PROC       25--REDEF    6537--ENTRY
ERROR
      6331**DCL      6679<<ASSIGN   6736<<ASSIGN
ERROR.ERR#
      6334**DCL      6681>>IF       6738>>IF
EVENT
        23**DCL        16--PROC     6537--ENTRY    6766>>IF
FIND_DEV
      7105**PROC     6799--CALL     7052--CALL
FIRST_RECORD
      6518**DCL      6549<>CALL
FIRST_RECORD.V
      6518**DCL      6518--DCLINIT
FO$DEV.LNK$
      4918**DCL      7112>>ASSIGN
FO$DEV.NAME
      4926**DCL      4927--REDEF    7109>>IF
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:98   
FO$DEV.RACCT
      4994**DCL      4995--REDEF
FO$DEV.RWSN
      4995**DCL      6803>>IF       6807>>ASSIGN
FO$DEV.RWSNL
      4983**DCL      6801>>IF
FO$DEV.WSN$
      4925**DCL      7060>>ASSIGN
FO$DKEYIN.CHKP
      4833**DCL      4834--REDEF
FO$DKEYIN.DEVNM
      4826**DCL      4827--REDEF
FO$DKEYIN.TNAME
      4838**DCL      4839--REDEF    4840--REDEF
FO$FIL.DEST
      5062**DCL      5063--REDEF
FO$FIL.LNK$
      5052**DCL      6610>>ASSIGN   6673>>ASSIGN   6730>>ASSIGN
FO$FKEYIN.ACCT
      4867**DCL      4868--REDEF
FO$FKEYIN.NOTFORM
      4863**DCL      4864--REDEF
FO$JOB.JNL
      5174**DCL      5181--IMP-SIZ
FO$RKEYIN.CADDR
      4887**DCL      6547>>ASSIGN
FO$RKEYIN.CTNAME
      4896**DCL      6567>>ASSIGN   6569>>IF       6638>>ASSIGN   6640>>IF       6697>>ASSIGN   6700>>IF
FO$RKEYIN.DEVNM
      4890**DCL      4891--REDEF
FO$RKEYIN.DTW1.NUM
      4893**DCL      6586>>IF       6586>>IF       6615>>ASSIGN   6654>>IF       6654>>IF       6678>>ASSIGN
      6712>>IF       6712>>IF       6735>>ASSIGN
FO$RKEYIN.DTW1.TYP
      4892**DCL      6575>>ASSIGN   6586>>IF       6646>>ASSIGN   6654>>IF       6706>>ASSIGN   6712>>IF
FO$RKEYIN.FTNAME
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:99   
      4895**DCL      6565>>IF       6567<<ASSIGN   6569>>IF       6572<<ASSIGN   6576>>ASSIGN   6586>>IF
      6636>>IF       6638<<ASSIGN   6640>>IF       6643<<ASSIGN   6647>>ASSIGN   6654>>IF       6695>>IF
      6697<<ASSIGN   6700>>IF       6703<<ASSIGN   6707>>ASSIGN   6712>>IF
FO$RKEYIN.KIN#
      4886**DCL      6554>>DOCASE
FO$RKEYIN.NOTWSN
      4888**DCL      6791>>IF       6791>>IF       6981>>IF       6981>>IF
FO$RKEYIN.WSN
      4889**DCL      6791>>IF       6791>>IF       6791>>IF       6900>>IF       6906>>ASSIGN   6916>>ASSIGN
      6938>>ASSIGN   6952>>ASSIGN   6981>>IF       6981>>IF       6981>>IF
FO$WSN.LNK$
      5205**DCL      7072>>ASSIGN   7088<<ASSIGN   7089<<ASSIGN
FO$WSN.NWSNS
      5207**DCL      7062>>DOINDEX  7076>>IF       7078<<ASSIGN   7078>>ASSIGN   7090<<ASSIGN   7091>>ASSIGN
FO$WSN.WSN
      5209**DCL      7066<<ASSIGN   7079<<ASSIGN   7091<<ASSIGN
FO$WSN.WSN.WSN_NAME
      5211**DCL      7063>>IF
FOD$AVAIL
      6291**DCL-ENT  6609--CALL     6672--CALL     6729--CALL
FOI$GBUF
      6290**DCL-ENT  7084--CALL
FO_DEV$
      5245**DCL      6605>>ASSIGN   6613<<ASSIGN   6668>>ASSIGN   6676<<ASSIGN   6725>>ASSIGN   6733<<ASSIGN
      6801>>IF       6803>>IF       6807>>ASSIGN   7060>>ASSIGN   7107<<ASSIGN   7108>>DOWHILE  7109>>IF
      7112<<ASSIGN   7112>>ASSIGN
FO_DEVSCB
      5831**DCL      7084<>CALL
FO_DEV_INIT.NAME
      5592**DCL      5593--REDEF
FO_DEV_INIT.RACCT
      5660**DCL      5661--REDEF
FO_FIL$
      5244**DCL      6607<<ASSIGN   6608>>DOWHILE  6610<<ASSIGN   6610>>ASSIGN   6670<<ASSIGN   6671>>DOWHILE
      6673<<ASSIGN   6673>>ASSIGN   6727<<ASSIGN   6728>>DOWHILE  6730<<ASSIGN   6730>>ASSIGN
FO_FIL_INIT.DEST
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:100  
      5489**DCL      5490--REDEF
FO_OSYMBKEY
      5291**DCL      6428--DCLINIT  6466--DCLINIT  6467--DCLINIT
FO_OSYMBKEY.LEN
      5291**DCL      6603<<ASSIGN   6666<<ASSIGN   6723<<ASSIGN
FO_OSYMBKEY.NAME
      5291**DCL      7109>>IF
FO_OSYMBKEYIN.DEVNM
      5310**DCL      5311--REDEF
FO_OSYMBUF
      5323**DCL      6429--DCLINIT  6430--DCLINIT  6468--DCLINIT  6469--DCLINIT
FO_OSYMBUF.FO_OSYMBDEV
      5341**DCL      6832--ASSIGN   6940--ASSIGN   6993--ASSIGN   7010--ASSIGN
FO_OSYMBUF.FO_OSYMBDEV.NAME
      5352**DCL      5353--REDEF
FO_OSYMBUF.FO_OSYMBDEV.NAMER.NUM
      5355**DCL      6586>>IF       6592>>ASSIGN   6654>>IF       6659>>ASSIGN   6712>>IF       6717>>ASSIGN
FO_OSYMBUF.FO_OSYMBDEV.NAMER.TYP
      5354**DCL      6586>>IF       6654>>IF       6712>>IF
FO_OSYMBUF.FO_OSYMBDEV.RACCT
      5420**DCL      5421--REDEF
FO_OSYMBUF.FO_OSYMBDEV.RWSN
      5421**DCL      6816>>IF
FO_OSYMBUF.FO_OSYMBDEV.RWSNL
      5409**DCL      6814>>IF
FO_OSYMBUF.FO_OSYMBDEV.TNAME
      5358**DCL      6586>>IF       6654>>IF       6712>>IF
FO_OSYMBUF.FO_OSYMBWSN.LNK$
      5444**DCL      6832--ASSIGN   6940--ASSIGN   6993--ASSIGN   7010--ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.NWSNS
      5446**DCL      6784>>DOINDEX  6832--ASSIGN   6832>>ASSIGN   6898>>DOINDEX  6930>>ASSIGN   6931<<ASSIGN
      6931>>ASSIGN   6940--ASSIGN   6940>>ASSIGN   6975>>DOINDEX  6993--ASSIGN   6993>>ASSIGN   7010--ASSIGN
      7010>>ASSIGN   7057>>DOINDEX
FO_OSYMBUF.FO_OSYMBWSN.WSN
      5448**DCL      7066>>ASSIGN   7079>>ASSIGN   7091>>ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:101  
      5459**DCL      6910>>IF       6936<<ASSIGN   7005>>IF       7008<<ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED
      5455**DCL      6786>>IF       6831<<ASSIGN   6910>>IF       6921>>IF       6935<<ASSIGN   6977>>IF
      7009<<ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.WSN.ORIGINAL
      5453**DCL      6827>>IF       6845>>IF       6910>>IF       6934<<ASSIGN   6989>>IF
FO_OSYMBUF.FO_OSYMBWSN.WSN.ROUTED_OUT
      5457**DCL      6827>>IF       6830<<ASSIGN   6903>>IF       6937<<ASSIGN   6989>>IF       6992<<ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME
      5450**DCL      6791>>IF       6791>>IF       6803>>IF       6816>>IF       6820>>ASSIGN   6841>>ASSIGN
      6851>>ASSIGN   6860>>ASSIGN   6875>>ASSIGN   6900>>IF       6938<<ASSIGN   6981>>IF       6981>>IF
      7000>>ASSIGN   7017>>ASSIGN   7024>>ASSIGN   7063>>IF
FO_Q.DEVHD$
      5783**DCL      7107>>ASSIGN
FO_Q.FILHD$
      5785**DCL      6607>>ASSIGN   6670>>ASSIGN   6727>>ASSIGN
I
      6314**DCL      6606<<DOINDEX  6607>>ASSIGN   6669<<DOINDEX  6670>>ASSIGN   6726<<DOINDEX  6727>>ASSIGN
      6784<<DOINDEX  6786>>IF       6791>>IF       6791>>IF       6803>>IF       6816>>IF       6820>>ASSIGN
      6827>>IF       6827>>IF       6830>>ASSIGN   6831>>ASSIGN   6841>>ASSIGN   6845>>IF       6851>>ASSIGN
      6860>>ASSIGN   6875>>ASSIGN   6898<<DOINDEX  6900>>IF       6903>>IF       6910>>IF       6910>>IF
      6910>>IF       6921>>IF       6924>>ASSIGN   6975<<DOINDEX  6977>>IF       6981>>IF       6981>>IF
      6989>>IF       6989>>IF       6992>>ASSIGN   7000>>ASSIGN   7005>>IF       7008>>ASSIGN   7009>>ASSIGN
      7017>>ASSIGN   7024>>ASSIGN   7057<<DOINDEX  7063>>IF       7066>>ASSIGN   7079>>ASSIGN   7091>>ASSIGN
INCOMPAT
      6616**LABEL    6591--CALLALT
J
      6315**DCL      7062<<DOINDEX  7063>>IF       7066>>ASSIGN   7079>>ASSIGN
K
      6316**DCL      6897<<ASSIGN   6921>>IF       6924<<ASSIGN   6928>>IF       6930<<ASSIGN   6934>>ASSIGN
      6935>>ASSIGN   6936>>ASSIGN   6937>>ASSIGN   6938>>ASSIGN
KEYIN$
        25**DCL      6547>>ASSIGN   6554>>DOCASE   6565>>IF       6567>>ASSIGN   6567>>ASSIGN   6569>>IF
      6569>>IF       6572>>ASSIGN   6575>>ASSIGN   6576>>ASSIGN   6586>>IF       6586>>IF       6586>>IF
      6586>>IF       6615>>ASSIGN   6636>>IF       6638>>ASSIGN   6638>>ASSIGN   6640>>IF       6640>>IF
      6643>>ASSIGN   6646>>ASSIGN   6647>>ASSIGN   6654>>IF       6654>>IF       6654>>IF       6654>>IF
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:102  
      6678>>ASSIGN   6695>>IF       6697>>ASSIGN   6697>>ASSIGN   6700>>IF       6700>>IF       6703>>ASSIGN
      6706>>ASSIGN   6707>>ASSIGN   6712>>IF       6712>>IF       6712>>IF       6712>>IF       6735>>ASSIGN
      6791>>IF       6791>>IF       6791>>IF       6791>>IF       6791>>IF       6900>>IF       6906>>ASSIGN
      6916>>ASSIGN   6938>>ASSIGN   6952>>ASSIGN   6981>>IF       6981>>IF       6981>>IF       6981>>IF
      6981>>IF
M$PFIL
        40**DCL-ENT  6549--CALL
M$READ
        39**DCL-ENT  6583--CALL     6652--CALL     6710--CALL
M$TRUNC
        39**DCL-ENT  6837--CALL     6945--CALL     6998--CALL     7015--CALL
M$WRITE
        39**DCL-ENT  6768--CALL     6836--CALL     6944--CALL     6997--CALL     7014--CALL
NEXT_FROM_WSN IN PROCEDURE ROUTE_FROM
      6860**LABEL    6788--GOTO     6809--GOTO     6822--GOTO
NEXT_WSN IN PROCEDURE OSYMB_TO_DEV
      7091**LABEL    7067--GOTO
NEXT_WSN_2 IN PROCEDURE UNROUTE_FROM
      7028**LABEL    6979--GOTO
NO_MORE
      6598**LABEL    6583--CALLALT
NO_MORE_2
      6657**LABEL    6652--CALLALT
NO_MORE_3
      6715**LABEL    6710--CALLALT
OCMSG_ROUTE
      6392**DCL      6768<>CALL
OCMSG_ROUTE.STATION_
      6394**DCL      6394--REDEF
OCMSG_ROUTE.V
      6395**DCL      6392--DCLINIT
OCMSG_ROUTE.V.DVBYTE.VFC#
      6401**DCL      6401--REDEF
OPMSG_ROUTE
      6349**DCL      6393--DCLINIT  6394--DCLINIT
OPMSG_ROUTE.CADDR
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:103  
      6350**DCL      6547<<ASSIGN
OPMSG_ROUTE.FLAGS
      6356**DCL      6357--REDEF
OPMSG_ROUTE.MSGID
      6352**DCL      6353--REDEF
OPMSG_ROUTE.NUM1
      6368**DCL      6592<<ASSIGN   6615<<ASSIGN   6659<<ASSIGN   6678<<ASSIGN   6717<<ASSIGN   6735<<ASSIGN
OPMSG_ROUTE.SUBC
      6366**DCL      6621<<ASSIGN   6626<<ASSIGN   6683<<ASSIGN   6687<<ASSIGN   6740<<ASSIGN   6745<<ASSIGN
      6806<<ASSIGN   6819<<ASSIGN   6840<<ASSIGN   6850<<ASSIGN   6859<<ASSIGN   6874<<ASSIGN   6881<<ASSIGN
      6905<<ASSIGN   6915<<ASSIGN   6951<<ASSIGN   6956<<ASSIGN   6999<<ASSIGN   7016<<ASSIGN   7023<<ASSIGN
      7038<<ASSIGN
OPMSG_ROUTE.TNAME1
      6369**DCL      6576<<ASSIGN   6647<<ASSIGN   6707<<ASSIGN
OPMSG_ROUTE.TYP1
      6367**DCL      6575<<ASSIGN   6646<<ASSIGN   6706<<ASSIGN
OPMSG_ROUTE.WSN
      6370**DCL      6807<<ASSIGN   6820<<ASSIGN   6841<<ASSIGN   6851<<ASSIGN   6860<<ASSIGN   6875<<ASSIGN
      6906<<ASSIGN   6916<<ASSIGN   6952<<ASSIGN   7000<<ASSIGN   7017<<ASSIGN   7024<<ASSIGN
OSYMB_TO_DEV
      7050**PROC     6870--CALL     6948--CALL     7034--CALL
READ_OSYMB
      6466**DCL      6583<>CALL     6652<>CALL     6710<>CALL
READ_OSYMB.STATION_
      6469**DCL      6470--REDEF
READ_OSYMB.V
      6470**DCL      6466--DCLINIT
READ_OSYMB.V.DVBYTE.REREAD#
      6481**DCL      6481--REDEF
READ_OSYMB.V.INDX#
      6479**DCL      6479--REDEF
ROUTE_ADD
      6895**PROC     6718--CALL
ROUTE_COMPLETE
      6318**DCL      6578<<ASSIGN   6598<<ASSIGN   6616>>IF
ROUTE_FROM
PL6.E3A0      #001=FOU$ROOSTER File=FOU$ROOSTER.:E05TSI                          TUE 07/29/97 17:15 Page:104  
      6781**PROC     6593--CALL
ROUTE_TALLY
      6317**DCL      6783<<ASSIGN   6798<<ASSIGN   6798>>ASSIGN   6868>>IF       6973<<ASSIGN   6988<<ASSIGN
      6988>>ASSIGN   7032>>IF
SAV$
      6330**DCL      6605<<ASSIGN   6613>>ASSIGN   6668<<ASSIGN   6676>>ASSIGN   6725<<ASSIGN   6733>>ASSIGN
TRUNC_OSYMB
      6501**DCL      6837<>CALL     6945<>CALL     6998<>CALL     7015<>CALL
TRUNC_OSYMB.V
      6501**DCL      6501--DCLINIT
UNROUTE_FROM
      6971**PROC     6660--CALL
WRITE_OCMSG_ROUTE
      6765**PROC     6629--CALL     6684--CALL     6688--CALL     6741--CALL     6746--CALL     6808--CALL
      6821--CALL     6842--CALL     6852--CALL     6861--CALL     6876--CALL     6882--CALL     6907--CALL
      6917--CALL     6953--CALL     6957--CALL     7001--CALL     7018--CALL     7025--CALL     7039--CALL
WRITE_OSYMB
      6428**DCL      6836<>CALL     6944<>CALL     6997<>CALL     7014<>CALL
WRITE_OSYMB.BUF_.BOUND
      6428**DCL      6832<<ASSIGN   6940<<ASSIGN   6993<<ASSIGN   7010<<ASSIGN
WRITE_OSYMB.STATION_
      6430**DCL      6430--REDEF
WRITE_OSYMB.V
      6431**DCL      6428--DCLINIT
WRITE_OSYMB.V.DVBYTE.VFC#
      6437**DCL      6437--REDEF
WSN$
      6320**DCL      7060<<ASSIGN   7061>>DOWHILE  7062>>DOINDEX  7063>>IF       7066>>ASSIGN   7071>>ASSIGN
      7072<<ASSIGN   7072>>ASSIGN   7075<<ASSIGN   7076>>IF       7078>>ASSIGN   7078>>ASSIGN   7079>>ASSIGN
      7083>>ASSIGN   7084<>CALL     7088>>ASSIGN   7089>>ASSIGN   7090>>ASSIGN   7091>>ASSIGN   7091>>ASSIGN
WSNLNK$
      6321**DCL      7071<<ASSIGN   7075>>ASSIGN   7083<<ASSIGN   7088>>ASSIGN
