VERSION A06

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:1    
        1        1         /*M* Z8PA$SEMANTICS - EXECUTES SEMANTIC ACTIONS FOR THE PUEDO CODE ASSEMBLER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7         /*P*
        8        8              NAME: Z8PA$SEMANTICS
        9        9              PURPOSE:
       10       10                   This module is part of a PSEUDO CODE ASSEMBLER that was built
       11       11                   using the LALR1 parser generator.  This module executes the
       12       12                   semantic actions specified in the grammar that is input to LALR1.
       13       13              DESCRIPTION:
       14       14                   The main body of the module is a case statement that has
       15       15                   an entry for each semantic action.  The case statement is at the
       16       16                   end of the module.
       17       17              REFERENCES:
       18       18                   DN6, DN7, DN9, Z8PD_SI
       19       19         */
       20       20         Z8PA$SEMANTICS : PROC (A);
       21       21         /*D*
       22       22              NAME: Z8PA$SEMANTICS
       23       23              CALL:
       24       24                    CALL Z8PA$SEMANTICS(=SEMANTIC_ACTION);
       25       25              PARAMETERS:
       26       26                   A
       27       27                     An integer representing the semantic action to be performed.
       28       28                     These integers are defined by LALR1 and  communicated to
       29       29                     this module through the file SCPPDA_SUBS.
       30       30              ENVIRONMENT:
       31       31                   None.
       32       32              INPUT:
       33       33                   LEX_STK and DNT.
       34       34              OUTPUT:
       35       35                   The primary output is  a table in the form of a PL6 program that
       36       36                   contains the assembled pseudo code.  This module also  generates
       37       37                   a listing and a cross reference.
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:2    
       38       38              SCRATCH:
       39       39                   The files refered to by M$SO, M$OU, M$LS.
       40       40              DESCRIPTION:
       41       41                   Execute semantic actions specified by the parser.
       42       42         */
       43       43
       44       44
       45       45         %INCLUDE SCDPDA_SUBS;
       46      439         %INCLUDE Z8P_PARS_STK;
       47      482         %INCLUDE Z8P_P_STATE;
       48      545         %INCLUDE Z8P_PARS_DNT;
       49      566         %INCLUDE Z8P_SCAN_EXT;
       50      755         %INCLUDE Z8P_ORDR_DEF;
       51      826         %INCLUDE Z8P_OPS_TBL;
       52     1845         %INCLUDE Z8P_SEMAN_EX;
       53     1914
       54     1915         %INCLUDE Z9A_FLAGS;
       55     1929         %IF GCOS;
       57     1931         %ENDIF;
       58     1932         %IF CP6;
       59     1933         %EQU SPACER#=CHARTEXT(' ');
       60     1934         %ENDIF;
       61     1935
       62     1936         %DCBPTR;
       63     1946    1    DCL A SBIN WORD;
       64     1947    1    DCL CHAR_NUM CHAR(%OPERAND_LEN);
       65     1948    1    DCL NUM SBIN;
       66     1949    1    DCL 1 NUM_OUT REDEF NUM,
       67     1950    1        2 * UBIN(18) UNAL,
       68     1951    1        2 VAL UBIN(18) UNAL;
       69     1952    1    DCL TRACE_OPT_ON BIT(1) STATIC INIT(%FALSE);
       70     1953    1    DCL UNIQUE_NUM STATIC UBIN INIT(1);
              1953             /* Used in creating unique preprocesor variables */
       71     1954    1    DCL DEST_CHAR CHAR(8);
       72     1955    1    DCL OPERAND CHAR(%OPERAND_LEN);
       73     1956    1    DCL PROC_NAME CHAR (30) STATIC;
       74     1957    1    DCL SEGMENT_NUMBER UBIN WORD ALIGNED STATIC;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:3    
       75     1958    1    DCL SEGMENT_NAME CHAR(%LABEL_LENGTH) STATIC;
       76     1959    1    DCL LABEL_NAME CHAR(%LABEL_LENGTH) STATIC;
       77     1960    1    DCL LABEL_POS PTR STATIC;  /* Points to the last referencd label in LABEL_TABLE */
       78     1961    1    DCL PREVIOUS_LABEL_POS PTR STATIC; /* Points to the  last last record referenced */
       79     1962    1    DCL LABEL_TYPE CHAR(5);
       80     1963    1    DCL INPUT ENTRY(3);
       81     1964    1    DCL FORCE_LIST ENTRY;
       82     1965    1    DCL Z8PA$OUTPUT_XREF ENTRY(1);
       83     1966    1    DCL Z8PA$OUTPUT_JMP_DEST ENTRY(1);
       84     1967    1    DCL Z8PA$ERROR_PROC ENTRY(1);
       85     1968    1    DCL Z8PA$WRAPUP ENTRY;
       86     1969    1    DCL LOCAL_FLAG BIT(1) STATIC;
       87     1970    1    DCL TABLE_DEF_OUT BIT(1) STATIC INIT('0'B);
       88     1971
       89     1972           /* Global variables used in constructing the GENI directive */
       90     1973    1    DCL OPCODE STATIC CHAR(5); /*Stores the opcode of  a GENI operand */
       91     1974    1    DCL YFIELD STATIC UBIN(18); /* YFIELD of ass. inst. within GENI */
       92     1975    1    DCL MOD_TYPE STATIC CHAR(3); /* Second op of ass. inst. within GENI */
       93     1976    1    DCL TAG_TYPE STATIC CHAR(2); /* Indicate if IR or RI addressing is used */
       94     1977    1    DCL UPPER_HALF BIT(18) ALIGNED;
              1977             /*Upper half of the machine word generated from GENI */
       95     1978    1    DCL LOWER_HALF BIT(18) ALIGNED;
              1978             /* Lower half of the machine word generated from GENI */
       96     1979    1    DCL 1 MODFIELDS (0:2) STATIC,
       97     1980             /*B* MODFIELDS is used in constructing machine words for the first
       98     1981                  word of a multi-word EIS instructions. */
       99     1982    1        2 ARI BIT(3),
      100     1983    1        2 RNREG CHAR(3),
      101     1984    1        2 EXISTS BIT(1);
      102     1985    1    DCL MODFIELD_CNT SBIN WORD STATIC;
      103     1986    1    DCL OPTIONAL_FIELDS (0:2) UBIN WORD STATIC;
      104     1987    1    DCL SIGN_EXIST BIT(1) STATIC INIT('0'B);
              1987             /* Used in handling literals in the GENI dir */
      105     1988
      106     1989         /*  The following are used to generate pc utility directives */
      107     1990    1    DCL FWBOT CHAR(120);
      108     1991    1    DCL SWTOP CHAR(120);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:4    
      109     1992    1    DCL SWBOT CHAR(120);
      110     1993
      111     1994
      112     1995
      113     1996
      114     1997          /* The following are used in directives that require VFD like constructs */
      115     1998    1    DCL VFD_WORD UBIN WORD;
      116     1999    1    DCL 1 VFD_OUT REDEF VFD_WORD,
      117     2000    1      2 UPPER UBIN HALF UNAL,
      118     2001    1      2 LOWER UBIN HALF UNAL;
      119     2002    1    DCL NUM2 UBIN WORD;
      120     2003    1    DCL 1 NUM3 REDEF NUM2,
      121     2004    1       2 * UBIN(27) UNAL,
      122     2005    1       2 CODE UBIN(9) UNAL;
      123     2006    1     DCL 1 NUM4 REDEF NUM2,
      124     2007    1       2 * UBIN(18) UNAL,
      125     2008    1       2 CODE UBIN(18) UNAL;
      126     2009    1    DCL VFD_ACC BIT(36) STATIC;
      127     2010    1    DCL VFD_ACC_POS SBIN STATIC;
      128     2011    1    DCL VFD_BASE_SPECIFIER CHAR(1) STATIC;
      129     2012    1    DCL VFD_NUM UBIN WORD;
      130     2013    1    DCL VFD_LENGTH UBIN WORD;
      131     2014    1    DCL SHIFT_FACTOR UBIN WORD;
      132     2015
      133     2016    1    DCL 1 P_CODE  STATIC,
      134     2017             /*B*  P_CODE is a structure used to accumulate a pseudocode directive
      135     2018                   until it can be output to the file containing the object table */
      136     2019    1        2 SIMPLE_DIR CHAR(12) INIT(' '),
      137     2020    1        2 SYMBOL SBIN WORD,
      138     2021    1        2 TWO_WORDS BIT(1),
      139     2022    1        2 OPERAND(0:%MAX_OPS) CHAR(%OPERAND_LEN) INIT(' '*0);
      140     2023    1    DCL OPCNT UBIN STATIC INIT(0);
              2023             /* A count of the operands in the current directive */
      141     2024
      142     2025    1    DCL 1 PEPD BASED (CURRENT_PEPD_POS),
      143     2026               /*B* PEPD will contain ptrs into LABEL_TABLE, and will be used to
      144     2027                    generate a PEPD to be output to m$so for inclusion in
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:5    
      145     2028                    the object table module */
      146     2029    1        2 POS PTR,
      147     2030    1        2 NEXT PTR;
      148     2031
      149     2032    1    DCL 1 DEP BASED (CURRENT_DEP_POS),
      150     2033             /*B DEP accumulates information needed to output a DEP table to
      151     2034                 the object file */
      152     2035    1        2 LT_POS PTR,     /* Points into LABEL_TABLE */
      153     2036    1        2 NEXT PTR;
      154     2037
      155     2038    1    DCL 1 BURST_TABLE BASED (CURRENT_BT_POS),
      156     2039             /*B BURST_TABLE stores burst destinations, which will be used to define
      157     2040                 preprocessor varibles created when the BURST was encountered  */
      158     2041    1        2 LABEL_POS PTR,
      159     2042    1        2 DEST CHAR(8),
      160     2043    1        2 NEXT PTR;
      161     2044
      162     2045
      163     2046
      164     2047    1    DCL TOP_LABEL_TABLE PTR STATIC INIT(ADDR(NIL));
      165     2048    1    DCL CURRENT_OT_POS UBIN WORD ALIGNED EXT INIT(0);
      166     2049    1    DCL AHEAD_OT_POS UBIN WORD ALIGNED EXT INIT(0);
      167     2050    1    DCL REF_POS PTR STATIC INIT(ADDR(NIL));
      168     2051    1    DCL CURRENT_PEPD_POS PTR STATIC INIT(ADDR(NIL));
      169     2052    1    DCL CURRENT_DEP_POS PTR STATIC INIT(ADDR(NIL));
      170     2053    1    DCL CURRENT_BT_POS PTR STATIC INIT(ADDR(NIL));
      171     2054    1    DCL TOP_PEPD PTR STATIC INIT(ADDR(NIL));
      172     2055    1    DCL TOP_DEP PTR STATIC INIT(ADDR(NIL));
      173     2056    1    DCL TOP_BURST_TABLE PTR STATIC INIT(ADDR(NIL));
      174     2057    1    DCL TOP_LOCAL_LABEL_TABLE PTR STATIC INIT(ADDR(NIL));
      175     2058    1    DCL TOP_FREE_LT PTR STATIC INIT(ADDR(NIL));
      176     2059    1    DCL TOP_FREE_RL PTR STATIC INIT(ADDR(NIL));
      177     2060
      178     2061
      179     2062
      180     2063         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:6    
      181     2064
      182     2065
      183     2066
      184     2067
      185     2068
      186     2069         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:7    
      187     2070    1    SET_UP_PROG : PROC;
      188     2071         /*I*
      189     2072              NAME: SET_UP_PROG
      190     2073              PURPOSE:
      191     2074                   Set up the object table module so that it can be compiled by PL6.
      192     2075              CALL:
      193     2076                   CALL SET_UP_PROG;
      194     2077              DATA:
      195     2078                   None.
      196     2079              DESCRIPTION:
      197     2080                   This procedure outputs a procedure declaration for the
      198     2081                   module containing the object table.
      199     2082         */
      200     2083
      201     2084             %SELECT_OU;
      202     2087    2        CALL CONCAT(BUFFER,PROC_NAME,' : PROC;');
      203     2088             %OUTPUT_STR;
      204     2099             %SELECT_LO;
      205     2102
      206     2103    2    END SET_UP_PROG;
      207     2104         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:8    
      208     2105    1    SET_UP_TABLE : PROC;
      209     2106         /*I*
      210     2107              NAME: SET_UP_TABLE
      211     2108              PURPOSE:
      212     2109                   Output the declarations to the object file for the major
      213     2110                   table.
      214     2111              CALL:
      215     2112                   CALL SET_UP_TABLE;
      216     2113              DATA:
      217     2114                   None.
      218     2115              DESCRIPTION:
      219     2116                   Write the table declaration to the object file for the
      220     2117                   table named in the begin program line of the source
      221     2118                   program.
      222     2119         */
      223     2120             %SELECT_OU;
      224     2123             %IF CP6;
      225     2124    2        BUFFER = '%INCLUDE *LABEL_DEFS; ';
      226     2125             %ENDIF;
      227     2126             %IF GCOS;
      230     2129             %ENDIF;
      231     2130             %OUTPUT_STR;
      232     2141    2        CALL CONCAT(BUFFER,'DCL ',SEGMENT_NAME,'(0:%OT_LEN_',SEGMENT_NAME,
      233     2142    2               ') UBIN HALF HALIGNED CONSTANT SYMDEF INIT( ');
      234     2143             %OUTPUT_STR;
      235     2154             %SELECT_LO;
      236     2157    2        TABLE_DEF_OUT = '1'B;
      237     2158
      238     2159    2    END SET_UP_TABLE;
      239     2160         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:9    
      240     2161    1    INIT_P_CODE : PROC;
      241     2162         /*I*
      242     2163              NAME: INIT_P_CODE
      243     2164              PURPOSE:
      244     2165                   Inititalize the P_CODE structure to  the default values for operands.
      245     2166              CALL:
      246     2167                   CALL INIT_P_CODE;
      247     2168              DATA:
      248     2169                   P_CODE
      249     2170              DESCRIPTION:
      250     2171                   Set the P_CODE structure to its default values.
      251     2172         */
      252     2173    2           P_CODE.SIMPLE_DIR = ' ';
      253     2174    2           P_CODE.OPERAND(0) = ZILCH;
      254     2175    2           P_CODE.OPERAND(1) = ZILCH;
      255     2176    2           P_CODE.OPERAND(2) = ZILCH;
      256     2177    2           P_CODE.OPERAND(3) = ZILCH;
      257     2178    2           P_CODE.OPERAND(4) = ZILCH;
      258     2179    2           P_CODE.OPERAND(5) = ZILCH;
      259     2180    2           OPCNT = 0;
      260     2181
      261     2182    2    END INIT_P_CODE;
      262     2183         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:10   
      263     2184    1    INIT_ASSEMBLY_INST : PROC;
      264     2185
      265     2186         /*I*
      266     2187              NAME: INIT_ASSEMBLY_INST
      267     2188              PURPOSE:
      268     2189                   Initialize global variables used in generating assembly language
      269     2190                   instructions found in the GENI directive.
      270     2191              CALL:
      271     2192                   CALL INIT_ASSEMBLY_INST;
      272     2193              DATA:
      273     2194                   None.
      274     2195              DESCRIPTION:
      275     2196                   Set the various instruction fields to their default values.
      276     2197         */
      277     2198    2          DCL CNT SBIN;
      278     2199
      279     2200    3          DO CNT = 0 TO 2;
      280     2201    3            MODFIELDS.ARI(CNT) = '000'B;
      281     2202    3            MODFIELDS.RNREG(CNT) = 'N';
      282     2203    3            MODFIELDS.EXISTS(CNT) = %FALSE;
      283     2204    3            OPTIONAL_FIELDS(CNT) = 0;
      284     2205    3          END;
      285     2206
      286     2207    2          MODFIELD_CNT = 0;
      287     2208    2          VFD_ACC = '000000000000'O;
      288     2209    2          VFD_ACC_POS = 36;
      289     2210    2          VFD_BASE_SPECIFIER = 'D';
      290     2211
      291     2212    2          YFIELD = 0;
      292     2213    2          TAG_TYPE = '  ';
      293     2214    2          MOD_TYPE = '  ';
      294     2215
      295     2216    2    END INIT_ASSEMBLY_INST;
      296     2217
      297     2218         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:11   
      298     2219
      299     2220    1    GET_NEW_RL : PROC(POS,LEN);
      300     2221         /*I*
      301     2222              NAME: GET_NEW_RL
      302     2223              PURPOSE:
      303     2224                   Get a new record for a REF_LIST entry.
      304     2225              CALL:
      305     2226                   CALL GET_NEW_RL(POS,LEN);
      306     2227              PARAMETERS:
      307     2228                   POS
      308     2229                     Returns a pointer to the new entry.
      309     2230                   LEN
      310     2231                     An input parameter giving the length in words of the new record.
      311     2232                     It had better be less than or equal to a REF_LIST entry.
      312     2233              DATA:
      313     2234                   Free space list for REF_LIST entries.
      314     2235              DESCRIPTION:
      315     2236                   Check the free space list, if its empty call GETNEW.
      316     2237                   The free space list for REF_LIST entries is added to in
      317     2238                   Z8PA$OUTPUT_JMP_DEST.
      318     2239         */
      319     2240    2        DCL POS PTR;
      320     2241    2        DCL LEN UBIN;
      321     2242
      322     2243    2        IF TOP_FREE_RL ~= ADDR(NIL) THEN
      323     2244    3          DO;
      324     2245    3            POS = TOP_FREE_RL;
      325     2246    3            TOP_FREE_RL = TOP_FREE_RL->REF_LIST.NEXT;
      326     2247    3          END;
      327     2248    2        ELSE
      328     2249    2          CALL GETNEW(POS,LEN);
      329     2250
      330     2251    2    END GET_NEW_RL;
      331     2252         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:12   
      332     2253
      333     2254    1    PUT_LABEL_DEF : PROC(POS,TYPE);
      334     2255         /*I*
      335     2256              NAME: PUT_LABEL_DEF
      336     2257              PURPOSE:
      337     2258                   Put the label's value (definition point) into a LABEL_TABLE.
      338     2259              CALL:
      339     2260                   CALL PUT_LABEL_DEF(LABEL,POS,TYPE);
      340     2261              PARAMETERS:
      341     2262                   POS
      342     2263                     Passes in the actual position in the LABEL_TABLE of the
      343     2264                     label.
      344     2265                   TYPE
      345     2266                     The type of label being defined.  Currently types are ** for
      346     2267                     label defined by a StART directive.
      347     2268              DATA:
      348     2269                   LABEL_TABLE
      349     2270              DESCRIPTION:
      350     2271                   Set the location field of the label entry to CURRENT_OT_POS.
      351     2272         */
      352     2273    2        DCL POS PTR;
      353     2274    2        DCL TYPE CHAR(5);
      354     2275    2        DCL MESS CHAR(%MESS_LEN);
      355     2276    2        DCL OCTNUM CHAR (6);
      356     2277
      357     2278    2        IF POS->LABEL_TABLE.LOCATION ~= -1 THEN
      358     2279    3          DO;
      359     2280    3            CALL DEC_TO_OCT_SUP(OCTNUM,POS->LABEL_TABLE.LOCATION);
      360     2281    3            CALL CONCAT(MESS,%MESS10,OCTNUM);
      361     2282    3            CALL Z8PA$ERROR_PROC(MESS);
      362     2283    3          END;
      363     2284    2        ELSE
      364     2285    3          DO;
      365     2286    3            POS->LABEL_TABLE.LOCATION = CURRENT_OT_POS;
      366     2287
      367     2288    3            IF TYPE = 'START' THEN
      368     2289    3              POS->LABEL_TABLE.TYPE = '**';
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:13   
      369     2290    3            ELSE POS->LABEL_TABLE.TYPE = '  ';
      370     2291    3          END;
      371     2292
      372     2293    2    END PUT_LABEL_DEF;
      373     2294         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:14   
      374     2295
      375     2296    1    REFERENCE_LABEL_TABLE : PROC (LABEL,POS);
      376     2297         /*I*
      377     2298              NAME: REFERENCE_LABEL_TABLE
      378     2299              PURPOSE:
      379     2300                   Record a label reference in REF_LIST for use in cross reference
      380     2301                   generation.
      381     2302              CALL:
      382     2303                   CALL REFERENCE_LABEL_TABLE(LABEL);
      383     2304              PARAMETERS:
      384     2305                   LABEL
      385     2306                     The label that is being referenced.
      386     2307                   POS
      387     2308                     The position in LABEL_TABLE of the referenced label. An
      388     2309                     output parameter.
      389     2310              DATA:
      390     2311                   REF_LIST
      391     2312              DESCRIPTION:
      392     2313                   Add the label to the label table (call ADD_TO_LT) then
      393     2314                   add the reference to the label's reference list(call ADD_TO_RL).
      394     2315         */
      395     2316
      396     2317    2        DCL LABEL CHAR (%LABEL_LENGTH);
      397     2318    2        DCL POS PTR;                /* WILL POINT TO A POSITION IN THE LABEL_TABLE */
      398     2319
      399     2320    2           LOCAL_FLAG = %FALSE;
      400     2321    2           CALL ADD_TO_LT(LABEL,POS,TOP_LABEL_TABLE);
      401     2322
      402     2323    2           CALL ADD_TO_RL(POS);
      403     2324
      404     2325    2    END REFERENCE_LABEL_TABLE;
      405     2326
      406     2327         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:15   
      407     2328    1    ADD_TO_RL : PROC(POS);
      408     2329         /*I*
      409     2330              NAME: ADD_TO_RL
      410     2331              PURPOSE:
      411     2332                   Add a reference to to the REF_LIST.
      412     2333              CALL:
      413     2334                   CALL ADD_TO_RL(POS);
      414     2335              PARAMETERS:
      415     2336                   POS
      416     2337                     Position in the LABEL_TABLE that the referenced label occupies.
      417     2338                   CURRENT_POS
      418     2339                     Returns position in reference list of added reference.
      419     2340              DATA:
      420     2341                   REF_LIST
      421     2342                   LABEL_TABLE
      422     2343              DESCRIPTION:
      423     2344                   Given the label's position in the label table update the linked
      424     2345                   list of references to include the CURRENT_OT_POS.
      425     2346         */
      426     2347
      427     2348    2        DCL POS PTR;
      428     2349
      429     2350    2        CALL GET_NEW_RL(REF_POS,SIZEW(REF_LIST));
      430     2351
      431     2352    2        REF_POS->REF_LIST.DEST = 'EMPTY';
      432     2353    2        REF_POS->REF_LIST.NEXT = ADDR(NIL);
      433     2354
      434     2355    2        IF POS->LABEL_TABLE.FIRST_REF = ADDR(NIL) THEN
      435     2356    3          DO;
      436     2357    3            POS->LABEL_TABLE.FIRST_REF = REF_POS;
      437     2358    3            POS->LABEL_TABLE.LAST_REF = REF_POS;
      438     2359    3            REF_POS->REF_LIST.REF = CURRENT_OT_POS;
      439     2360    3          END;
      440     2361    2        ELSE
      441     2362    3          DO;
      442     2363    3            POS->LABEL_TABLE.LAST_REF->REF_LIST.NEXT = REF_POS;
      443     2364    3            REF_POS->REF_LIST.REF = CURRENT_OT_POS;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:16   
      444     2365    3            POS->LABEL_TABLE.LAST_REF = REF_POS;
      445     2366    3          END;
      446     2367
      447     2368    2    END ADD_TO_RL;
      448     2369         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:17   
      449     2370    1    SEARCH_LT : PROC(LABEL,POS,TABLE);
      450     2371         /*I*
      451     2372              NAME: SEARCH_LT
      452     2373              PURPOSE:
      453     2374                   Search the label table for the label given.
      454     2375              CALL:
      455     2376                   CALL SEARCH_LT(LABEL,POS);
      456     2377              PARAMETERS:
      457     2378                   LABEL
      458     2379                     The label to be searched for.
      459     2380                   POS
      460     2381                     The position of the label in the label table.  If the label is
      461     2382                     not found then this will be returned as -1.
      462     2383                   TABLE
      463     2384                     Points to the table to be searched.
      464     2385              DATA:
      465     2386                   LABEL_TABLE
      466     2387              DESCRIPTION:
      467     2388                   Walk through the label table to see if the given
      468     2389                   label is in there.  If not return addr(nil).
      469     2390         */
      470     2391    2        DCL POS PTR;
      471     2392    2        DCL TABLE PTR;
      472     2393    2        DCL LABEL CHAR(%LABEL_LENGTH);
      473     2394
      474     2395    2        POS = TABLE;
      475     2396
      476     2397    3        DO WHILE(POS ~= ADDR(NIL));
      477     2398    3          IF POS->LABEL_TABLE.NAME = LABEL THEN
      478     2399    3            RETURN;
      479     2400    3          ELSE
      480     2401    3            IF POS->LABEL_TABLE.NAME < LABEL THEN
      481     2402    3              POS = POS->LABEL_TABLE.RLINK;
      482     2403    3            ELSE POS = POS->LABEL_TABLE.LLINK;
      483     2404    3        END;
      484     2405
      485     2406    2    END SEARCH_LT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:18   
      486     2407         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:19   
      487     2408
      488     2409    1    ADD_TO_LT : PROC(LABEL,POS,TABLE);
      489     2410         /*I*
      490     2411              NAME: ADD_TO_LT
      491     2412              PURPOSE:
      492     2413                   Add a label to the LABEL_TABLE.
      493     2414              CALL:
      494     2415                   CALL ADD_TO_LT(LABEL,POS);
      495     2416              PARAMETERS:
      496     2417                   LABEL
      497     2418                     The label to be added to the table.
      498     2419                   POS
      499     2420                     The position in the table where the lable was placed or was found.
      500     2421                   TABLE
      501     2422                     Points to the table to be added to.
      502     2423              DATA:
      503     2424                   LABEL_TABLE 
      504     2425              DESCRIPTION:
      505     2426                   Search the label table.  If the label is not found then add it to
      506     2427                   the table.   Position of the label is returned in POS.
      507     2428         */
      508     2429    2        DCL LABEL CHAR(%LABEL_LENGTH);
      509     2430    2        DCL POS PTR;
      510     2431    2        DCL TABLE PTR;
      511     2432    2        DCL SUB_POS PTR;
      512     2433    2        DCL LLEFT BIT(1);
      513     2434
      514     2435    2        POS = TABLE;
      515     2436
      516     2437    2        IF POS = ADDR(NIL) THEN
      517     2438    3          DO;
      518     2439    3            CALL GETNEW(POS,SIZEW(LABEL_TABLE));
      519     2440    3            TABLE = POS;
      520     2441    3          END;
      521     2442    2        ELSE
      522     2443    3          DO;
      523     2444
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:20   
      524     2445    4            DO UNTIL(POS = ADDR(NIL));
      525     2446    4              SUB_POS = POS;
      526     2447    4              IF POS->LABEL_TABLE.NAME = LABEL THEN
      527     2448    4                RETURN;
      528     2449    4              ELSE
      529     2450    4                IF POS->LABEL_TABLE.NAME < LABEL THEN
      530     2451    5                  DO;
      531     2452    5                    POS = POS->LABEL_TABLE.RLINK;
      532     2453    5                    LLEFT = %FALSE;
      533     2454    5                  END;
      534     2455    4                ELSE
      535     2456    5                  DO;
      536     2457    5                    POS = POS->LABEL_TABLE.LLINK;
      537     2458    5                    LLEFT = %TRUE;
      538     2459    5                  END;
      539     2460    4            END;
      540     2461
      541     2462    3            CALL GETNEW(POS,SIZEW(LABEL_TABLE));
      542     2463
      543     2464    3            IF LLEFT THEN
      544     2465    3              SUB_POS->LABEL_TABLE.LLINK = POS;
      545     2466    3            ELSE
      546     2467    3              SUB_POS->LABEL_TABLE.RLINK = POS;
      547     2468    3          END;
      548     2469
      549     2470    2        POS->LABEL_TABLE.LOCATION = -1;
      550     2471    2        POS->LABEL_TABLE.FIRST_REF = ADDR(NIL);
      551     2472    2        POS->LABEL_TABLE.LAST_REF = ADDR(NIL);
      552     2473    2        POS->LABEL_TABLE.TYPE = 'UD';
      553     2474    2        POS->LABEL_TABLE.LLINK = ADDR(NIL);
      554     2475    2        POS->LABEL_TABLE.RLINK = ADDR(NIL);
      555     2476    2        POS->LABEL_TABLE.NAME = LABEL;
      556     2477
      557     2478    2    END ADD_TO_LT;
      558     2479         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:21   
      559     2480
      560     2481    1    REFERENCE_LOCAL_LABEL_TABLE : PROC (LABEL,POS);
      561     2482         /*I*
      562     2483              NAME: REFERENCE_LOCAL_LABEL_TABLE
      563     2484              PURPOSE:
      564     2485                   Record a label reference in LOCAL_REF_LIST for use in cross reference
      565     2486                   generation.
      566     2487              CALL:
      567     2488                   CALL REFERENCE_LOCAL_LABEL_TABLE(LABEL);
      568     2489              PARAMETERS:
      569     2490                   LABEL
      570     2491                     The label that is being referenced.
      571     2492                   POS
      572     2493                     The position in LOCAL_LABEL_TABLE of the referenced label. An
      573     2494                     output parameter.
      574     2495              DATA:
      575     2496                   LOCAL_REF_LIST
      576     2497              DESCRIPTION:
      577     2498                    Search the LOCAL_LABEL_TABLE for the label. If it is not in label table
      578     2499                   then add it to the table.  Update the labels reference now that we
      579     2500                   know its in the label table.  ADD_TO_LT does the
      580     2501                   searching for us.
      581     2502         */
      582     2503
      583     2504    2        DCL LABEL CHAR (%LABEL_LENGTH);
      584     2505    2        DCL POS PTR;
      585     2506
      586     2507    2        LOCAL_FLAG = %TRUE;
      587     2508
      588     2509
      589     2510    2        CALL ADD_TO_LT(LABEL,POS,TOP_LOCAL_LABEL_TABLE);
      590     2511
      591     2512    2        CALL ADD_TO_RL(POS);
      592     2513
      593     2514    2    END REFERENCE_LOCAL_LABEL_TABLE;
      594     2515
      595     2516         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:22   
      596     2517    1    PUT_LABEL_PEPD : PROC(POS_IN_LT);
      597     2518         /*I*
      598     2519              NAME: PUT_LABEL_PEPD
      599     2520              PURPOSE:
      600     2521                   Create an entry in the PEPD because a start directive was
      601     2522                   encountered.
      602     2523              CALL:
      603     2524                   CALL PUT_LABEL_PEPD(POS_IN_LT);
      604     2525              PARAMETERS:
      605     2526                   POS_IN_LT
      606     2527                     Position of label in the LABEL_TABLE.
      607     2528              DATA:
      608     2529                   PEPD
      609     2530              DESCRIPTION:
      610     2531                   Create an entry in the PEPD table.  The entry will point into
      611     2532                   the label table at the position specified by POS_IN_LT.
      612     2533                   This procedure is called when START directive is encountered.
      613     2534         */
      614     2535    2        DCL POS_IN_LT PTR;
      615     2536    2        DCL POS PTR;
      616     2537
      617     2538    2        CALL GETNEW(POS,SIZEW(PEPD));
      618     2539
      619     2540    2        IF TOP_PEPD ~= ADDR(NIL) THEN
      620     2541    2          PEPD.NEXT = POS;
      621     2542    2        ELSE
      622     2543    2          TOP_PEPD = POS;
      623     2544
      624     2545    2        CURRENT_PEPD_POS = POS;
      625     2546    2        PEPD.POS = POS_IN_LT;
      626     2547    2        PEPD.NEXT = ADDR(NIL);
      627     2548
      628     2549    2    END PUT_LABEL_PEPD;
      629     2550
      630     2551         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:23   
      631     2552    1    PUT_LABEL_DEP : PROC(POS_IN_LT);
      632     2553         /*I*
      633     2554              NAME: PUT_LABEL_DEP
      634     2555              PURPOSE:
      635     2556                   Enter a label's position in the lable table into the DEP table.
      636     2557              CALL:
      637     2558                   CALL PUT_LABEL_DEP(POS_IN_LT);
      638     2559              PARAMETERS:
      639     2560                   POS_IN_LT
      640     2561                     An input parameter giving the label's position in
      641     2562                     the label table.
      642     2563              DATA:
      643     2564                   DEP
      644     2565              DESCRIPTION:
      645     2566                   Create an entry in the DEP table which points into the label
      646     2567                   table at the position specified by POS_IN_LT.
      647     2568         */
      648     2569    2        DCL POS_IN_LT PTR;
      649     2570    2        DCL POS PTR;
      650     2571
      651     2572    2        CALL GETNEW(POS,SIZEW(DEP));
      652     2573
      653     2574    2        IF TOP_DEP ~= ADDR(NIL) THEN
      654     2575    2          DEP.NEXT = POS;
      655     2576    2        ELSE
      656     2577    2          TOP_DEP = POS;
      657     2578
      658     2579    2        CURRENT_DEP_POS = POS;
      659     2580    2        DEP.LT_POS = POS_IN_LT;
      660     2581    2        DEP.NEXT = ADDR(NIL);
      661     2582
      662     2583    2    END PUT_LABEL_DEP;
      663     2584         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:24   
      664     2585    1    PUT_BURST_DEST : PROC(DEST);
      665     2586         /*I*
      666     2587              NAME: PUT_BURST_DEST
      667     2588              PURPOSE:
      668     2589                   Put the destination of a BURST directive into the BURST_TABLE.
      669     2590              CALL:
      670     2591                   CALL PUT_BURST_DEST(DEST);
      671     2592              PARAMETERS:
      672     2593                   DEST
      673     2594                     The created label (minus the preceeding 'D') given to the
      674     2595                     BURST operand.
      675     2596              DATA:
      676     2597                   BURST_TABLE,LABEL_POS
      677     2598              DESCRIPTION:
      678     2599                   Put the created label and the position in the label_table of the
      679     2600                   operand of a BURST directive into BURST_TABLE.  The position
      680     2601                   of the label in LABEL_TABLE is obtained form the global variable
      681     2602                   LABEL_POS because the label was the last one referenced.
      682     2603         */
      683     2604    2        DCL DEST CHAR(8);
      684     2605    2        DCL POS PTR;
      685     2606
      686     2607    2        CALL GETNEW(POS,SIZEW(BURST_TABLE));
      687     2608
      688     2609    2        IF TOP_BURST_TABLE ~= ADDR(NIL) THEN
      689     2610    2          BURST_TABLE.NEXT = POS;
      690     2611    2        ELSE
      691     2612    2          TOP_BURST_TABLE = POS;
      692     2613
      693     2614    2        CURRENT_BT_POS = POS;
      694     2615    2        BURST_TABLE.LABEL_POS = LABEL_POS;
      695     2616    2        BURST_TABLE.DEST = DEST;
      696     2617    2        BURST_TABLE.NEXT = ADDR(NIL);
      697     2618
      698     2619    2    END PUT_BURST_DEST;
      699     2620         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:25   
      700     2621    1    EQU_INT : PROC(VAL,LABEL_POS);
      701     2622         /*I*
      702     2623              NAME: EQU_INT
      703     2624              PURPOSE:
      704     2625                   Set the value of the label at POS to VAL as in an EQU instruction.
      705     2626              CALL:
      706     2627                   CALL EQU_INT(VAL,LABEL_POS);
      707     2628              PARAMETERS:
      708     2629                   LABEL_POS
      709     2630                     Position of the label in LABEL_TABLE.
      710     2631                   VAL
      711     2632                     Integer value of label.
      712     2633              DATA:
      713     2634                   LABEL_TABLE
      714     2635              DESCRIPTION:
      715     2636                   Set the value of LABEL_TABLE.VALUE at LABEL_POS to VAL.
      716     2637         */
      717     2638    2        DCL VAL SBIN;
      718     2639    2        DCL LABEL_POS PTR;
      719     2640
      720     2641    2        LABEL_POS->LABEL_TABLE.LOCATION = VAL;
      721     2642
      722     2643    2    END EQU_INT;
      723     2644
      724     2645         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:26   
      725     2646    1    EQU_LABEL : PROC (SENDING_LABEL,RECIEVING_LABEL);
      726     2647         /*I*
      727     2648              NAME: EQU_LABEL
      728     2649              PURPOSE:
      729     2650                   Handle an equate when the sending field is a label.
      730     2651              CALL:
      731     2652                   CALL EQU_LABEL(SENDING_LABEL,RECIEVING_LABEL);
      732     2653              PARAMETERS:
      733     2654                   SENDING_LABEL
      734     2655                     Points to the sending label;
      735     2656                   RECIEVING_LABEL
      736     2657                     Points to the recieving label;
      737     2658              DATA:
      738     2659                   LABEL_TABLE
      739     2660              DESCRIPTION:
      740     2661                   Check to make sure the sending label has a value.
      741     2662                   If it does then assign its value to the recieving label.
      742     2663         */
      743     2664
      744     2665    2        DCL SENDING_LABEL PTR;
      745     2666    2        DCL RECIEVING_LABEL PTR;
      746     2667    2        DCL MESS CHAR(%MESS_LEN);
      747     2668
      748     2669    2        IF SENDING_LABEL->LABEL_TABLE.LOCATION = -1 THEN
      749     2670    3          DO;
      750     2671    3            CALL CONCAT(MESS,%MESS4,SENDING_LABEL->LABEL_TABLE.NAME);
      751     2672    3            CALL Z8PA$ERROR_PROC(MESS);
      752     2673    3          END;
      753     2674    2        ELSE
      754     2675    2          RECIEVING_LABEL->LABEL_TABLE.LOCATION = SENDING_LABEL->LABEL_TABLE.LOCATION;
      755     2676
      756     2677    2    END EQU_LABEL;
      757     2678
      758     2679         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:27   
      759     2680
      760     2681
      761     2682
      762     2683    1    OUTPUT_PEPD : PROC;
      763     2684         /*I*
      764     2685              NAME: OUTPUT_PEPD
      765     2686              PURPOSE:
      766     2687                   Output the PEPD table to the file containing the object table.
      767     2688                   Also output the DEP table to M$OU.
      768     2689              CALL:
      769     2690                   CALL OUTPUT_PEPD;
      770     2691              DATA:
      771     2692                   PEPD
      772     2693              DESCRIPTION:
      773     2694                   This module generates PL6 statements that are output to
      774     2695                   the module containing the object table.  These PL6 statements
      775     2696                   are created from information in the PEPD table and
      776     2697                   must be executed before the pseudocode interpretation in
      777     2698                   the code generator begins. These PL6 statements initialize the PEPD.
      778     2699                   Also output a DEP table using information in the DEP structure.
      779     2700         */
      780     2701    2        DCL CNT PTR;
      781     2702    2        DCL NUM UBIN WORD;
      782     2703    2        DCL CHAR_NUM2 CHAR(%OPERAND_LEN);
      783     2704    2        DCL SEG_NUM_CH CHAR(%OPERAND_LEN);
      784     2705
      785     2706             %SELECT_OU;
      786     2709    2        BUFFER = 'DCL 1 PEPD (0:600) EXT,';
      787     2710             %OUTPUT_STR;
      788     2721    2        BUFFER = '    2 POS UBIN(18) UNAL,';
      789     2722             %OUTPUT_STR;
      790     2733    2        BUFFER = '    2 SEGMENT UBIN(18) UNAL;';
      791     2734             %OUTPUT_STR;
      792     2745    2        BUFFER = 'DCL 1 DEP (0:47) EXT ,';
      793     2746             %OUTPUT_STR;
      794     2757    2        BUFFER = '    2 POS UBIN(18) UNAL,';
      795     2758             %OUTPUT_STR;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:28   
      796     2769    2        BUFFER = '    2 SEGMENT UBIN(18) UNAL;';
      797     2770             %OUTPUT_STR;
      798     2781
      799     2782    2        CALL BINCHAR(SEG_NUM_CH,SEGMENT_NUMBER);
      800     2783    2        CALL BLANK_ZERO(ADDR(SEG_NUM_CH),%OPERAND_LEN);
      801     2784
      802     2785    2        CNT = TOP_PEPD;
      803     2786
      804     2787    3        DO WHILE(CNT ~= ADDR(NIL));
      805     2788    3          CALL BINCHAR(CHAR_NUM,CNT->PEPD.POS->LABEL_TABLE.LOCATION);
      806     2789    3          CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);
      807     2790    3          CALL CONCAT(BUFFER,'PEPD.POS(%',CNT->PEPD.POS->LABEL_TABLE.NAME,
      808     2791    3                   ') = ',CHAR_NUM,';');
      809     2792               %OUTPUT_STR;
      810     2803    3          CALL CONCAT(BUFFER,'PEPD.SEGMENT(%',CNT->PEPD.POS->LABEL_TABLE.NAME,
      811     2804    3                ') = ',SEG_NUM_CH,';');
      812     2805               %OUTPUT_STR;
      813     2816    3          CNT = CNT->PEPD.NEXT;
      814     2817    3        END;
      815     2818
      816     2819    2        CNT = TOP_DEP;
      817     2820
      818     2821    3        DO WHILE(CNT ~=ADDR(NIL));
      819     2822    3          CALL BINCHAR(CHAR_NUM,CNT->DEP.LT_POS->LABEL_TABLE.LOCATION);
      820     2823    3          CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);
      821     2824    3          CALL CONCAT(BUFFER,'DEP.POS(%',CNT->DEP.LT_POS->LABEL_TABLE.NAME,
      822     2825    3                     ') = ',CHAR_NUM,';');
      823     2826               %OUTPUT_STR;
      824     2837    3          CALL CONCAT(BUFFER,'DEP.SEGMENT(%',CNT->DEP.LT_POS->LABEL_TABLE.NAME,
      825     2838    3                      ') = ',SEG_NUM_CH,';');
      826     2839               %OUTPUT_STR;
      827     2850    3          CNT = CNT->DEP.NEXT;
      828     2851    3        END;
      829     2852
      830     2853    2        CALL CONCAT(BUFFER,'END ',PROC_NAME,';');
      831     2854             %OUTPUT_STR;
      832     2865             %SELECT_LO;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:29   
      833     2868
      834     2869    2    END OUTPUT_PEPD;
      835     2870         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:30   
      836     2871
      837     2872
      838     2873
      839     2874    1    HANDLE_ARITH_EXP : PROC(RESULT,LEN);
      840     2875         /*I*
      841     2876              NAME: HANDLE_ARITH_EXP
      842     2877              PURPOSE:
      843     2878                   Determine the value of an expression from pseudo-code that
      844     2879                   may contain an asterisk.
      845     2880              CALL:
      846     2881                   CALL HANDLE_ARITH_EXP;
      847     2882              PARAMETERS:
      848     2883                   RESULT
      849     2884                     Character representation of the numeric result from the expression.
      850     2885                   LEN
      851     2886                     Length of the result in characters. An input parameter.
      852     2887              DATA:
      853     2888                   LX_STK
      854     2889              DESCRIPTION:
      855     2890                   This procedure gets it data from the LX_STK.  Since expressions have
      856     2891                   a rigid syntax, everything needed should always be in the same place
      857     2892                   on the stack.  It determines the value of the expression, with
      858     2893                   asterisk meaning the current value of the object table counter.
      859     2894         */
      860     2895    2        DCL LEN UBIN;
      861     2896    2        DCL RESULT CHAR(LEN);
      862     2897    2        DCL NUM1 SBIN;
      863     2898    2        DCL NUM2 SBIN;
      864     2899    2        DCL RES1 SBIN HALF;
      865     2900    2        DCL RES2 REDEF RES1 UBIN HALF;
      866     2901
      867     2902    2        IF LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME = '*' THEN
      868     2903    2          NUM1 = CURRENT_OT_POS;
      869     2904    2        ELSE CALL CHARBIN(NUM1,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
      870     2905
      871     2906    2        IF LX_STK.DNTPTR(LX_TOP + 2)->DNT.TEXT.NAME = '*' THEN
      872     2907    2          NUM2 = CURRENT_OT_POS;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:31   
      873     2908    2        ELSE CALL CHARBIN(NUM2,LX_STK.DNTPTR(LX_TOP + 2)->DNT.TEXT.NAME);
      874     2909
      875     2910    2        IF LX_STK.DNTPTR(LX_TOP+1)->DNT.TEXT.NAME = '-' THEN
      876     2911    2          RES1 = NUM1 - NUM2;
      877     2912    2        ELSE IF LX_STK.DNTPTR(LX_TOP+1)->DNT.TEXT.NAME = '+' THEN
      878     2913    2               RES1 = NUM1 + NUM2;
      879     2914    2             ELSE RES1 = NUM1 * NUM2;
      880     2915
      881     2916    2        CALL BINCHAR(RESULT,RES2);
      882     2917
      883     2918    2    END HANDLE_ARITH_EXP;
      884     2919         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:32   
      885     2920    1    PUT_OPERAND : PROC(OPER);
      886     2921         /*I*
      887     2922              NAME: PUT_OPERAND
      888     2923              PURPOSE:
      889     2924                   Place an operand from a directive into the P_CODE structure.
      890     2925              CALL:
      891     2926                   CALL PUT_OPERAND(OPER);
      892     2927              PARAMETERS:
      893     2928                   OPER
      894     2929                     The character representation of the operand.
      895     2930              DATA:
      896     2931                   P_CODE
      897     2932              DESCRIPTION:
      898     2933                   Put an operand into the P_CODE structure.  Make sure there
      899     2934                   are not too many operands.
      900     2935         */
      901     2936    2        DCL OPER CHAR(%OPERAND_LEN);
      902     2937
      903     2938    2        IF OPCNT > %MAX_OPS THEN
      904     2939    2          CALL Z8PA$ERROR_PROC(%MESS5);
      905     2940    2        ELSE
      906     2941    3          DO;
      907     2942    3            P_CODE.OPERAND(OPCNT) = OPER;
      908     2943    3            OPCNT = OPCNT + 1;
      909     2944    3          END;
      910     2945
      911     2946    2    END PUT_OPERAND;
      912     2947         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:33   
      913     2948    1    OCTBIN : PROC(OCTNUM,OCTCHAR);
      914     2949         /*I*
      915     2950              NAME: OCTBIN
      916     2951              PURPOSE:
      917     2952                   Input a character representation of an octal number and
      918     2953                   output the binary equivalent.
      919     2954              CALL:
      920     2955                   CALL OCTBIN(OCTNUM,OCTCHAR);
      921     2956              PARAMETERS:
      922     2957                   OCTNUM
      923     2958                     An output parameter that gives a ubin word value for the octal
      924     2959                     number.
      925     2960                   OCTCHAR
      926     2961                     The octal number in character code, right justified.
      927     2962              DATA:
      928     2963                   None.
      929     2964              DESCRIPTION:
      930     2965                   Use the redef facility to redefine the input and output parameters
      931     2966                   as arrays.  Step through the input array, doing the conversion one
      932     2967                   character at a time. Use only the rightmost 12
      933     2968                   characters because there are only 12 octal digits
      934     2969                   in a ubin word.
      935     2970         */
      936     2971
      937     2972    2        DCL OCTNUM UBIN WORD;
      938     2973    2        DCL OCTNUM_T (0:11) REDEF OCTNUM BIT(3);
      939     2974    2        DCL OCTCHAR CHAR(%OPERAND_LEN);
      940     2975    2        DCL OCTCHAR_T (0:%(OPERAND_LEN-1)) REDEF OCTCHAR CHAR(1);
      941     2976
      942     2977    2        DCL CNT SBIN;
      943     2978    2        DCL CNT2 SBIN;
      944     2979
      945     2980    2        DCL 1 OCTVALS (0:8) STATIC,
      946     2981    2          2 NAME CHAR(1) INIT('0','1','2','3','4','5','6','7',' '),
      947     2982    2          2 VALUE BIT(3) INIT('0'O,'1'O,'2'O,'3'O,'4'O,'5'O,'6'O,'7'O,'0'O);
      948     2983
      949     2984
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:34   
      950     2985    3        DO CNT = %(OPERAND_LEN-12) TO %(OPERAND_LEN-1);
      951     2986    3          CNT2 = 0;
      952     2987    4          DO WHILE(OCTVALS.NAME(CNT2) ~= OCTCHAR_T(CNT));
      953     2988    4            CNT2 = CNT2 + 1;
      954     2989    4          END;
      955     2990    3          OCTNUM_T(CNT-%(OPERAND_LEN-12)) = OCTVALS.VALUE(CNT2);
      956     2991    3        END;
      957     2992
      958     2993    2    END OCTBIN;
      959     2994
      960     2995         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:35   
      961     2996    1    HANDLE_PC_UTILITIES : PROC(FWBOT,SWTOP,SWBOT);
      962     2997         /*I*
      963     2998              NAME: HANDLE_PC_UTILITIES
      964     2999              PURPOSE:
      965     3000                   This procdure assembles the pseudo code for the pseudo-code
      966     3001                   utility directives.
      967     3002              CALL:
      968     3003                   CALL HANDLE_PC_UTILITIES(FWBOT,SWTOP,SWBOT);
      969     3004              PARAMETERS:
      970     3005                   All parameters are output parameters intended to be output directly
      971     3006                   to the object table without needing any modification.
      972     3007                   FWBOT
      973     3008                     The bottom half word of the first word of the directive.
      974     3009                   SWTOP
      975     3010                     The top half word of the second word generated for the directive.
      976     3011                   SWBOT
      977     3012                     The bottom half word of the second word generated for the directive.
      978     3013              DATA:
      979     3014                   P_CODE
      980     3015              DESCRIPTION:
      981     3016                   Generate the character representation of the assembled directive
      982     3017                   using the P_CODE structure and some convoluted logic.
      983     3018         */
      984     3019
      985     3020    2        DCL FWBOT CHAR(120);  /* Lower part of the first pc word generated */
      986     3021    2        DCL SWTOP CHAR(120);  /* Upper part of second pc word generated */
      987     3022    2        DCL SWBOT CHAR(120);  /* Lower part of second pc word generated */
      988     3023    2        DCL TSWBOT CHAR(10);
      989     3024    2        DCL TSWTOP CHAR(10);
      990     3025
      991     3026
      992     3027    2        DCL VFD_WORD  UBIN;
      993     3028    2        DCL 1 VFD_OUT REDEF VFD_WORD,
      994     3029    2          2 UPPER UBIN HALF UNAL,
      995     3030    2          2 LOWER UBIN HALF UNAL;
      996     3031
      997     3032    2        DCL P1 UBIN(6);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:36   
      998     3033    2        DCL P2 UBIN(6);
      999     3034    2        DCL CD UBIN(6);
     1000     3035    2        DCL OPNUM SBIN;
     1001     3036    2        DCL CODE CHAR (10);
     1002     3037
     1003     3038    2        DCL I SBIN;
     1004     3039
     1005     3040
     1006     3041
     1007     3042    2        GET_P : PROC(P,OPN);
     1008     3043               /* GET_P  determines the value of P (whatever that is) */
     1009     3044
     1010     3045    3          DCL P UBIN(6);
     1011     3046    3          DCL OPN SBIN;  /* Determines which operand P will be derived from */
     1012     3047    3          DCL POS SBIN;
     1013     3048
     1014     3049    3          IF (P_CODE.OPERAND(OPN) = 'DECIMAL') OR (P_CODE.OPERAND(OPN) = 'OCTAL') THEN
     1015     3050    3             P = 1;
     1016     3051    3          ELSE IF P_CODE.OPERAND(OPN) = 'COMCOM' THEN
     1017     3052    3             P = 2;
     1018     3053    3          ELSE IF P_CODE.OPERAND(OPN) = 'ILL' THEN
     1019     3054    3             P = 3;
     1020     3055    3          ELSE IF P_CODE.OPERAND(OPN) = 'SYSSM' THEN
     1021     3056    3             P = 4;
     1022     3057    3          ELSE IF P_CODE.OPERAND(OPN) = 'PCOM' THEN
     1023     3058    4             DO;
     1024     3059    4               P = 5;
     1025     3060    5               DO SELECT(P_CODE.OPERAND(OPN + 1));
     1026     3061    5                 SELECT('EOPND','FOPND','GOPND','HOPND','IOPND','JOPND','KOPND',
     1027     3062    5                        'LOPND','MOPND','NOPND','OOPND','POPND','QOPND','ROPND',
     1028     3063    5                        'SOPND','TOPND','UOPND','VOPND','WOPND','XOPND','YOPND','ZOPND'
              3063                                 );
     1029     3064    5                   P = 6;
     1030     3065    5               END;
     1031     3066    4             END;
     1032     3067    3        END GET_P;
     1033     3068
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:37   
     1034     3069
     1035     3070         %MACRO VFD1;
     1036     3071             DO;
     1037     3072               CALL BINCHAR(CODE,CD);
     1038     3073               CALL CONCAT(FWBOT,'%(BITBIN(BINBIT(',CODE,
     1039     3074                 '*4096,18) | BINBIT(',P_CODE.OPERAND(3),',18))),');
     1040     3075             END;
     1041     3076         %MEND;
     1042     3077
     1043     3078         %MACRO VFD2;
     1044     3079             DO;
     1045     3080               CALL OCTBIN(VFD_WORD,P_CODE.OPERAND(1));
     1046     3081               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1047     3082               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1048     3083             END;
     1049     3084         %MEND;
     1050     3085
     1051     3086         %MACRO VFD3;
     1052     3087             DO;
     1053     3088               CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(1));
     1054     3089               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1055     3090               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1056     3091             END;
     1057     3092         %MEND;
     1058     3093
     1059     3094         %MACRO VFD4;
     1060     3095             DO;
     1061     3096                 CALL BINCHAR(CODE,CD);
     1062     3097                 CALL CONCAT(FWBOT,'%(BITBIN((BINBIT(',CODE,
     1063     3098                     '*4096,18) | BINBIT(',P_CODE.OPERAND(1));
     1064     3099                 CALL INSERT(FWBOT,58,,'*32,18)) | BINBIT(',
     1065     3100                     P_CODE.OPERAND(3),',18))),');
     1066     3101             END;
     1067     3102         %MEND;
     1068     3103
     1069     3104         %MACRO VFD5;
     1070     3105             DO;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:38   
     1071     3106               CALL BINCHAR(CODE,CD);
     1072     3107               CALL CONCAT(FWBOT,'%(BITBIN(BINBIT(',CODE,
     1073     3108                 '*4096,18) | BINBIT(',P_CODE.OPERAND(1),'*32,18))),');
     1074     3109             END;
     1075     3110         %MEND;
     1076     3111
     1077     3112
     1078     3113         %MACRO VFD6;
     1079     3114             DO;
     1080     3115               CALL OCTBIN(VFD_WORD,P_CODE.OPERAND(3));
     1081     3116               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1082     3117               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1083     3118             END;
     1084     3119         %MEND;
     1085     3120
     1086     3121         %MACRO VFD7;
     1087     3122             DO;
     1088     3123               CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(3));
     1089     3124               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1090     3125               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1091     3126             END;
     1092     3127         %MEND;
     1093     3128
     1094     3129         %MACRO VFD8;
     1095     3130             DO;
     1096     3131               IF P_CODE.OPERAND(4) ~= ZILCH THEN
     1097     3132                 CALL CONCAT(SWTOP,'%',P_CODE.OPERAND(4),',');
     1098     3133               ELSE
     1099     3134                 SWTOP = '0,';
     1100     3135               SWBOT = '0,';
     1101     3136             END;
     1102     3137         %MEND;
     1103     3138
     1104     3139
     1105     3140    2        VFD_WORD = 0;
     1106     3141    2        OPNUM = 0;
     1107     3142    2        CALL GET_P(P1,OPNUM);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:39   
     1108     3143    2        OPNUM = 2;
     1109     3144    2        CALL GET_P(P2,OPNUM);
     1110     3145    2        CD = (P1 - 1) * 6 + (P2 - 1);
     1111     3146    2        IF P_CODE.OPERAND(0) = 'DECIMAL' OR P_CODE.OPERAND(0) = 'OCTAL' OR
     1112     3147    2           P_CODE.OPERAND(2) = 'DECIMAL' OR P_CODE.OPERAND(2) = 'OCTAL' THEN
     1113     3148    3          DO;
     1114     3149    3            IF P_CODE.OPERAND(0) = 'OCTAL' OR P_CODE.OPERAND(0) = 'DECIMAL' THEN
     1115     3150    4              DO;
     1116     3151                     %VFD1;
     1117     3158    4                IF P_CODE.OPERAND(0) = 'OCTAL' THEN
     1118     3159                       %VFD2;
     1119     3166    4                ELSE
     1120     3167                        %VFD3;
     1121     3174    4              END;
     1122     3175    4              ELSE DO;
     1123     3176                     %VFD5;
     1124     3183    4                IF P_CODE.OPERAND(2) = 'OCTAL' THEN
     1125     3184                        %VFD6;
     1126     3191    4                ELSE
     1127     3192                        %VFD7;
     1128     3199    4              END;
     1129     3200    3         CALL CONCAT(SWTOP,TSWTOP,',');
     1130     3201    3         CALL CONCAT(SWBOT,TSWBOT,',');
     1131     3202    3          END;
     1132     3203    3        ELSE DO;
     1133     3204               %VFD4;
     1134     3213               %VFD8;
     1135     3222
     1136     3223    3        END;
     1137     3224    2    END HANDLE_PC_UTILITIES;
     1138     3225         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:40   
     1139     3226
     1140     3227    1    GET_VALUE_OF_OPCODE : PROC(OPCODE,OPCODE_VALUE,POS);
     1141     3228         /*I*
     1142     3229              NAME:   GET_VALUE_OF_OPCODE
     1143     3230              PURPOSE:
     1144     3231                   Find the bit value of the opcode from an assembly instruction
     1145     3232                   in a GENI directive.
     1146     3233              CALL:
     1147     3234                   CALL GET_VALUE_OF_OPCODE(OPCODE,OPCODE_VALUE,POS);
     1148     3235              PARAMETERS:
     1149     3236                   OPCODE
     1150     3237                     The opcode as it appears in the source.
     1151     3238                   OPCODE_VALUE
     1152     3239                     The bit value of the opcode from the opcode table.
     1153     3240                   POS
     1154     3241                     The position of the opcode in the opcode table.
     1155     3242              DATA:
     1156     3243                   OCPODE_TABLE
     1157     3244              DESCRIPTION:
     1158     3245                   Search the opcode table for an occurrence of OPCODE.
     1159     3246                   Return the binary value of the opcode from the table.
     1160     3247                   If not found return a value of zero and call Z8PA$ERROR_PROC.
     1161     3248         */
     1162     3249
     1163     3250    2        DCL OPCODE CHAR(5);
     1164     3251    2        DCL OPCODE_VALUE BIT(9) ALIGNED;
     1165     3252    2        DCL OPCODE_WORD UBIN;
     1166     3253    2        DCL POS SBIN;
     1167     3254
     1168     3255
     1169     3256    2        POS = 0;
     1170     3257
     1171     3258    3        DO WHILE((OPCODE ~= OPCODE_TABLE.NAME(POS)) AND
     1172     3259    3                 (OPCODE_TABLE.NAME(POS) ~= %LAST_OP_IN_TABLE));
     1173     3260    3          POS = POS + 1;
     1174     3261    3        END;
     1175     3262
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:41   
     1176     3263    2        IF (OPCODE ~= %LAST_OP_IN_TABLE) AND
     1177     3264    2             (OPCODE_TABLE.NAME(POS) = %LAST_OP_IN_TABLE) THEN
     1178     3265    3          DO;
     1179     3266    3            CALL Z8PA$ERROR_PROC(%MESS1);
     1180     3267    3            OPCODE_VALUE = '000000000'B;
     1181     3268    3          END;
     1182     3269    2        ELSE
     1183     3270    2          OPCODE_VALUE = OPCODE_TABLE.VALUE(POS);
     1184     3271    2    END GET_VALUE_OF_OPCODE;
     1185     3272
     1186     3273         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:42   
     1187     3274    1    SEARCH_TAG_TABLE : PROC(GOAL,POSITION,TAG_VAL);
     1188     3275         /*I*
     1189     3276              NAME: SEARCH_TAG_TABLE.
     1190     3277              PURPOSE:
     1191     3278                   Determine the tag designator of the tag field and modification
     1192     3279                   field of a machine instruction being generated from a
     1193     3280                   GENI directive.
     1194     3281              CALL:
     1195     3282                   CALL SEARCH_TAG_TABLE(GOAL,POSITION,TAG_VAL);
     1196     3283              PARAMETERS:
     1197     3284                   GOAL
     1198     3285                     Address modification type from source.
     1199     3286                   POSITION
     1200     3287                     An output parameter giving the position of the GOAL in the
     1201     3288                     tag table.
     1202     3289                   TAG_VAL
     1203     3290                     Bit value of the tag designator that can be ORed with
     1204     3291                     the second half of the machine  word.
     1205     3292              DATA:
     1206     3293                   None.
     1207     3294              DESCRIPTION:
     1208     3295                   Search the TAG_MOD_TABLE for an occurrence of GOAL.  If found
     1209     3296                   return its value and position, else return a value of zero
     1210     3297                   and call Z8PA$ERROR_PROC.
     1211     3298         */
     1212     3299
     1213     3300             %EQU TAG_MOD_TABLE_LEN = 28;
     1214     3301    2        DCL 1 TAG_MOD_TABLE(0:%TAG_MOD_TABLE_LEN) STATIC,
     1215     3302    2         2 NAME CHAR(3) INIT(' ','N','AU','QU','DU','IC','AL',
     1216     3303    2                             'QL','DL','0','1','2','3','4','5','6','7',
     1217     3304    2                             'F','CI','I','SC','AD','DI','DIC','ID','IDC','SD','A','Q')
              3304                                      ,
     1218     3305    2         2 VALUE BIT(18) INIT('000000'O,'000000'O,'000001'O,'000002'O,'000003'O,
     1219     3306    2                              '000004'O,'000005'O,'000006'O,'000007'O,'000010'O,
     1220     3307    2                              '000011'O,'000012'O,'000013'O,'000014'O,'000015'O,
     1221     3308    2                              '000016'O,'000017'O,'000040'O,'000050'O,'000051'O,
     1222     3309    2                              '000052'O,'000053'O,'000054'O,'000055'O,'000056'O,
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:43   
     1223     3310    2                              '000057'O,'000044'O,'000005'O,'000006'O);
     1224     3311    2        DCL GOAL CHAR(3);
     1225     3312    2        DCL POSITION SBIN;
     1226     3313    2        DCL TAG_VAL BIT(18) ALIGNED;
     1227     3314
     1228     3315    2        POSITION = 0;
     1229     3316    3        DO WHILE((TAG_MOD_TABLE.NAME(POSITION) ~= GOAL) AND (POSITION <= %
              3316                 TAG_MOD_TABLE_LEN));
     1230     3317    3          POSITION = POSITION + 1;
     1231     3318    3        END;
     1232     3319
     1233     3320    2        IF POSITION > %TAG_MOD_TABLE_LEN THEN
     1234     3321    3          DO;
     1235     3322    3            CALL Z8PA$ERROR_PROC(%MESS2);
     1236     3323    3            POSITION = 0;
     1237     3324    3            TAG_VAL = '000000000000000000'B;
     1238     3325    3          END;
     1239     3326    2        ELSE
     1240     3327    2          TAG_VAL = TAG_MOD_TABLE.VALUE(POSITION);
     1241     3328
     1242     3329    2    END SEARCH_TAG_TABLE;
     1243     3330
     1244     3331         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:44   
     1245     3332
     1246     3333    1    BINBIN : PROC (NUM,BIN_CHAR);
     1247     3334         /*I*
     1248     3335              NAME: BINBIN
     1249     3336              PURPOSE:
     1250     3337                   Convert the character representation of a binary number to  UBIN word.
     1251     3338              CALL:
     1252     3339                   CALL BINBIN(NUM,BIN_CHAR);
     1253     3340              PARAMETERS:
     1254     3341                   NUM
     1255     3342                     An output parameter returning the UBIN value of the binary number.
     1256     3343                   BIN_CHAR
     1257     3344                     An input parameter giving the 12 character representation
     1258     3345                     of a binary number.
     1259     3346              DATA:
     1260     3347                   None.
     1261     3348              DESCRIPTION:
     1262     3349                   Use the redef facility to redefine the parameters as arrays.
     1263     3350                   Step through the input array, if a character is one then place
     1264     3351                   a one in the corresponding position in the output array.
     1265     3352         */
     1266     3353    2        DCL NUM UBIN WORD;
     1267     3354    2        DCL NUM_T (0:35) REDEF NUM BIT(1);
     1268     3355    2        DCL BIN_CHAR CHAR(%OPERAND_LEN);
     1269     3356    2        DCL BIN_CHAR_T (0:%(OPERAND_LEN - 1)) REDEF BIN_CHAR CHAR(1);
     1270     3357    2        DCL CNT SBIN;
     1271     3358
     1272     3359    2        NUM = 0;
     1273     3360    3        DO CNT = 0 TO 11;
     1274     3361    3          IF BIN_CHAR_T(CNT) ~= ' ' THEN
     1275     3362    3            IF BIN_CHAR_T(CNT) = '1' THEN
     1276     3363    3              NUM_T(35-CNT) = '1'B;
     1277     3364    3        END;
     1278     3365    2    END BINBIN;
     1279     3366
     1280     3367         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:45   
     1281     3368    1    GEN_SIMPLE_INST : PROC(OPCODE,OPND1,OPND2,TAG_TYPE,UPPER_HALF,LOWER_HALF);
     1282     3369         /*I*
     1283     3370              NAME: GEN_SIMPLE_INST
     1284     3371              PURPOSE:
     1285     3372                   Generate sinqle word machine instructions from the assembly
     1286     3373                   language found in a GENI directive.
     1287     3374              CALL:
     1288     3375                   CALL
     1289     3376                   GEN_SIMPLE_INST(OPCODE,OPND1,OPND2,TAG_TYPE,UPPER_HALF,LOWER_HALF);
     1290     3377              PARAMETERS:
     1291     3378                   OPCODE
     1292     3379                     Opcode mneumonic from the GENI.
     1293     3380                   OPND1
     1294     3381                     First operand of the assembly instruction.
     1295     3382                   OPND2
     1296     3383                     Second operand of the assembly instruction.
     1297     3384                   TAG_TYPE
     1298     3385                     Either 'RI' or 'IR' or blank to indicate type of addressing.
     1299     3386                   UPPER_HALF
     1300     3387                     An output parameter giving the bit value of the upper half of the
     1301     3388                     machine  word.
     1302     3389                   LOWER_HALF
     1303     3390                     The lower half of the machine word generated.
     1304     3391              DATA:
     1305     3392                   None.
     1306     3393              DESCRIPTION:
     1307     3394                   Generate single word instructions for GENI directives (including
     1308     3395                   single word eis instructions).
     1309     3396         */
     1310     3397
     1311     3398
     1312     3399    2        DCL OPCODE CHAR(5);   /* UNCHANGED FROM SOURCE */
     1313     3400    2        DCL OPND1 UBIN(18);       /* FIRST OPERAND ENCOUNTERED IN SOURCE */
     1314     3401    2        DCL OPND2 CHAR(3);    /* SECOND OPERAND WITH * ETC REMOVED */
     1315     3402    2        DCL TAG_TYPE CHAR(2); /* EITHER 'R', 'RI', 'IR' OR 'IT' */
     1316     3403    2        DCL UPPER_HALF BIT(18) ALIGNED; /* UPPER HALF OF OBJECT MACHINE WORD */
     1317     3404    2        DCL LOWER_HALF BIT(18) ALIGNED; /* LOWER HALF OF MACHINE WORD */
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:46   
     1318     3405    2        DCL 1 LH_OUT REDEF LOWER_HALF ALIGNED,
     1319     3406    2          2 OPCODE_FIELD BIT(9) UNAL,
     1320     3407    2          2 THE_REST BIT(9) UNAL;
     1321     3408    2        DCL OPCODE_VALUE BIT(9) ALIGNED;
              3408                 /*  BINARY VALUE OF OPCODE FROM OPCODE TABLE */
     1322     3409    2        DCL POS_IN_OPCODE_TABLE SBIN;
     1323     3410    2        DCL YFIELD  UBIN WORD;   /* USED TO CONVERT OPND1 TO Y FIELD OF MACHINE WORD */
     1324     3411
     1325     3412
     1326     3413
     1327     3414
     1328     3415
     1329     3416
     1330     3417             %MACRO PUT_IN_OPCODE;
     1331     3418             CALL GET_VALUE_OF_OPCODE(OPCODE,OPCODE_VALUE,POS_IN_OPCODE_TABLE);
     1332     3419             LH_OUT.OPCODE_FIELD = OPCODE_VALUE;
     1333     3420             %MEND;
     1334     3421
     1335     3422
     1336     3423             %MACRO PUT_IN_EIS_BIT;
     1337     3424             IF POS_IN_OPCODE_TABLE > %LAST_NON_EIS_INST THEN
     1338     3425               LOWER_HALF = LOWER_HALF | '000400'O;
     1339     3426             %MEND;
     1340     3427
     1341     3428
     1342     3429
     1343     3430             %MACRO PUT_IN_YFIELD;
     1344     3431             UPPER_HALF = BINBIT(OPND1,18);
     1345     3432             %MEND;
     1346     3433
     1347     3434
     1348     3435             %MACRO CLEAR_UPPER_AND_LOWER;
     1349     3436             UPPER_HALF = '000000'O;
     1350     3437             LOWER_HALF = '000000'O;
     1351     3438             %MEND;
     1352     3439
     1353     3440
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:47   
     1354     3441    2        SET_TAG_FIELD : PROC;
     1355     3442
     1356     3443               /* Determine and set the TAG FIELD using TAG_TYPE and OPND2 */
     1357     3444
     1358     3445    3          DCL OCTNUM CHAR(%OPERAND_LEN);
     1359     3446    3          DCL BINRES UBIN WORD;
     1360     3447    3          DCL CNT SBIN;
     1361     3448    3          DCL TAG_VAL BIT(18) ALIGNED;
     1362     3449
     1363     3450    3          IF TAG_TYPE = 'RI' THEN
     1364     3451    3           LOWER_HALF = LOWER_HALF |  '000020'O;
     1365     3452    3          IF TAG_TYPE = 'IR' THEN
     1366     3453    3           LOWER_HALF = LOWER_HALF | '000060'O;
     1367     3454    4          DO SELECT(OPCODE);
     1368     3455    4            SELECT('STCA','STCQ','STBA','STBQ');
     1369     3456    4              OCTNUM = '000000000000';
     1370     3457    4              CALL INSERT(OCTNUM,%(OPERAND_LEN-2),2,SUBSTR(OPND2,0,2));
     1371     3458    4              CALL OCTBIN(BINRES,OCTNUM);
     1372     3459    4              LOWER_HALF = LOWER_HALF | BINBIT(BINRES,18);
     1373     3460    4            SELECT(ELSE);
     1374     3461    4              CALL SEARCH_TAG_TABLE(OPND2,CNT,TAG_VAL);
     1375     3462    4              LOWER_HALF = LOWER_HALF | TAG_VAL;
     1376     3463    4          END;
     1377     3464    3        END SET_TAG_FIELD;
     1378     3465
     1379     3466
     1380     3467
     1381     3468               /* BUILD THE INSTRUCTION */
     1382     3469
     1383     3470             %CLEAR_UPPER_AND_LOWER;
     1384     3474    3        DO SELECT(OPCODE);
     1385     3475    3          SELECT('ADSC9','NDSC9','SDSC8');
     1386     3476
     1387     3477    3          SELECT('ADSC6');
     1388     3478    3            LOWER_HALF = '020000'O;
     1389     3479
     1390     3480    3          SELECT('ADSC4','NDSC4');
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:48   
     1391     3481    3            LOWER_HALF = '040000'O;
     1392     3482
     1393     3483    3          SELECT(ELSE);
     1394     3484                 %PUT_IN_OPCODE;
     1395     3488                 %PUT_IN_EIS_BIT;
     1396     3492                 %PUT_IN_YFIELD;
     1397     3495    3            CALL SET_TAG_FIELD;
     1398     3496    3        END;
     1399     3497
     1400     3498    2    END GEN_SIMPLE_INST;
     1401     3499         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:49   
     1402     3500
     1403     3501    1    GEN_EIS_INST : PROC(MODFIELDS,OPTIONAL_FIELDS,OPCODE,UPPER_HALF,LOWER_HALF);
     1404     3502         /*I*
     1405     3503              NAME: GEN_EIS_INST
     1406     3504              PURPOSE:
     1407     3505                   Generate the machine instruction for the first word of a multi-word
     1408     3506                   eis instruction.
     1409     3507              CALL:
     1410     3508                   CALL
     1411     3509                   GEN_EIS_ISNT(MODFIELDS,OPTIONAL_FIELDS,OPCODE,UPPER_HALF,LOWER_HALF);
     1412     3510              PARAMETERS:
     1413     3511                   MODFIELDS
     1414     3512                     An array of structures describing the three possible modification
     1415     3513                     fields.
     1416     3514                   OPTIONAL_FIELDS
     1417     3515                     An array that contains the three possible optional fields
     1418     3516                     which will directly follow the modfields in the source.
     1419     3517                   OPCODE
     1420     3518                     The instruction opcode as it appears in the GENI directive.
     1421     3519                   UPPER_HALF
     1422     3520                     The upper 18 bits of the machine instruction that was generated.
     1423     3521                   LOWER_HALF
     1424     3522                     The lower 18 bits of the machine instruction that was generated.
     1425     3523              DATA:
     1426     3524                   None.
     1427     3525              DESCRIPTION:
     1428     3526                   Generate  the first word of a multi-word eis instruction.
     1429     3527         */
     1430     3528    2        DCL 1 MODFIELDS (0:2),
     1431     3529    2          2 BITS BIT(3),
     1432     3530    2          2 RNREG CHAR(3),
     1433     3531    2          2 EXISTS BIT(1);
     1434     3532    2        DCL OPCODE CHAR(5);
     1435     3533    2        DCL UPPER_HALF BIT(18) ALIGNED;
     1436     3534    2        DCL 1 UH_OUT  REDEF UPPER_HALF ALIGNED,
     1437     3535    2          2 BITS BIT(2) UNAL,
     1438     3536    2          2 MF3 BIT(7) UNAL ,
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:50   
     1439     3537    2          2 BITS2 BIT(1) UNAL,
     1440     3538    2          2 RD_BIT BIT(1) UNAL,
     1441     3539    2          2 MF2 BIT(7) UNAL;
     1442     3540    2        DCL 1 UH_OUT2 REDEF UPPER_HALF ALIGNED,
     1443     3541    2          2 FILL BIT(9) UNAL,
     1444     3542    2          2 * BIT(9) UNAL;
     1445     3543    2        DCL 1 UH_OUT3 REDEF UPPER_HALF ALIGNED,
     1446     3544    2          2 * BIT(5) UNAL,
     1447     3545    2          2 BOLR BIT(4) UNAL,
     1448     3546    2          2 * BIT(9)  UNAL;
     1449     3547    2        DCL LOWER_HALF BIT(18) ALIGNED;
     1450     3548    2        DCL 1 LH_OUT REDEF LOWER_HALF ALIGNED,
     1451     3549    2          2 OPFIELD BIT(9) UNAL,
     1452     3550    2          2 EISBIT BIT(1) UNAL,
     1453     3551    2          2 INT BIT(1) UNAL,
     1454     3552    2          2 MF1 BIT(7) UNAL;
     1455     3553    2        DCL OPTIONAL_FIELDS (0:2) UBIN WORD;
     1456     3554    2        DCL OPCODE_VALUE BIT(9) ALIGNED;
     1457     3555    2        DCL POS SBIN;
     1458     3556    2        DCL 1 M_FIELD,
     1459     3557    2          2 BITS BIT(3) UNAL,
     1460     3558    2          2 REG BIT(4) UNAL;
     1461     3559    2        DCL M_OUT REDEF M_FIELD BIT(7);
     1462     3560    2        DCL TAG_VAL BIT(18) ALIGNED;
     1463     3561
     1464     3562
     1465     3563    2        UPPER_HALF = '000000'O;
     1466     3564    2        LOWER_HALF = UPPER_HALF;
     1467     3565
     1468     3566    3        DO SELECT(OPCODE);
     1469     3567    3          SELECT('MLR','MRL','MVT','CMPC','SCM','SCMR');
     1470     3568    3            UH_OUT2.FILL = BINBIT(OPTIONAL_FIELDS(0),9);
     1471     3569    3            IF OPTIONAL_FIELDS(1) = 1 THEN
     1472     3570    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;
     1473     3571
     1474     3572    3          SELECT('MVN','AD2D','SB2D','MP2D','AD3D','SB3D','MP3D','DV3D','DV2D');
     1475     3573    3            IF OPTIONAL_FIELDS(0) = 1 THEN
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:51   
     1476     3574    3              UPPER_HALF = UPPER_HALF | '000000000010000000'B;
     1477     3575    3            IF OPTIONAL_FIELDS(1) = 1 THEN
     1478     3576    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;
     1479     3577    3            IF OPTIONAL_FIELDS(2) = 1 THEN
     1480     3578    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;
     1481     3579
     1482     3580    3          SELECT('CSL','CSR','SZTL','SZTR');
     1483     3581    3            UH_OUT3.BOLR = BINBIT(OPTIONAL_FIELDS(0),4);
     1484     3582    3            IF  OPTIONAL_FIELDS(1) = 1 THEN
     1485     3583    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;
     1486     3584    3            IF OPTIONAL_FIELDS(2) = 1 THEN
     1487     3585    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;
     1488     3586
     1489     3587    3          SELECT('CMPB','BTD');
     1490     3588    3            IF OPTIONAL_FIELDS(0) = 1 THEN
     1491     3589    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;
     1492     3590
     1493     3591    3          SELECT('CMPNX','MVNEX','MVNX','MMF','MRF');
     1494     3592    3            IF OPTIONAL_FIELDS(0) = 1 THEN
     1495     3593    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;
     1496     3594    3            IF OPTIONAL_FIELDS(1) = 1 THEN
     1497     3595    3              UPPER_HALF = UPPER_HALF | '010000000000000000'B;
     1498     3596
     1499     3597    3          SELECT('AD2DX','SB2DX','MP2DX','DV2DX',
     1500     3598    3                 'AD3DX','SB3DX','MP3DX','DV3DX');
     1501     3599    3            IF OPTIONAL_FIELDS(0) = 1 THEN
     1502     3600    3              UPPER_HALF = UPPER_HALF | '000000000010000000'B;
     1503     3601    3            IF OPTIONAL_FIELDS(1) ~= 0 THEN
     1504     3602    3              UH_OUT.BITS = BINBIT(OPTIONAL_FIELDS(1),2);
     1505     3603    3            IF OPTIONAL_FIELDS(2) = 1 THEN
     1506     3604    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;
     1507     3605
     1508     3606    3          SELECT('MTM','MTR');
     1509     3607
     1510     3608    3        END; /* SELECT */
     1511     3609
     1512     3610    2        CALL GET_VALUE_OF_OPCODE(OPCODE,OPCODE_VALUE,POS);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:52   
     1513     3611    2        LH_OUT.OPFIELD = OPCODE_VALUE;
     1514     3612    2        LH_OUT.EISBIT = '1'B;
     1515     3613
     1516     3614    2        M_OUT = '0000000'B;
     1517     3615    2        CALL SEARCH_TAG_TABLE(MODFIELDS.RNREG(0),POS,TAG_VAL);
     1518     3616    2        M_OUT = BINBIT(BITBIN(TAG_VAL),7);
     1519     3617    2        M_FIELD.BITS = MODFIELDS.BITS(0);
     1520     3618    2        LH_OUT.MF1 = M_OUT;
     1521     3619
     1522     3620    2        M_OUT = '0000000'B;
     1523     3621    2        IF MODFIELDS.EXISTS(1) THEN
     1524     3622    3          DO;
     1525     3623    3            CALL SEARCH_TAG_TABLE(MODFIELDS.RNREG(1),POS,TAG_VAL);
     1526     3624    3            M_OUT = BINBIT(BITBIN(TAG_VAL),7);
     1527     3625    3            M_FIELD.BITS = MODFIELDS.BITS(1);
     1528     3626    3            UH_OUT.MF2 = M_OUT;
     1529     3627    3          END;
     1530     3628
     1531     3629    2        M_OUT = '0000000'B;
     1532     3630    2        IF MODFIELDS.EXISTS(2) THEN
     1533     3631    3          DO;
     1534     3632    3            CALL SEARCH_TAG_TABLE(MODFIELDS.RNREG(2),POS,TAG_VAL);
     1535     3633    3            M_OUT = BINBIT(BITBIN(TAG_VAL),7);
     1536     3634    3            M_FIELD.BITS = MODFIELDS.BITS(2);
     1537     3635    3            UH_OUT.MF3 = M_OUT;
     1538     3636    3          END;
     1539     3637
     1540     3638
     1541     3639    2    END GEN_EIS_INST;
     1542     3640         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:53   
     1543     3641    1    GEN_P_CODE : PROC;
     1544     3642
     1545     3643         /*I*
     1546     3644              NAME: GEN_P_CODE
     1547     3645              PURPOSE:
     1548     3646                   Generate the pseudo_code to be output ot the object table.
     1549     3647              CALL:
     1550     3648                   CALL GEN_P_CODE;
     1551     3649              DATA:
     1552     3650                   P_CODE
     1553     3651              DESCRIPTION:
     1554     3652                   Use the P_CODE structure to generate the object table.
     1555     3653                   This procedure is called  in the GENERATE_P_CODE
     1556     3654                   semantic action which occurs at the end of the operand list
     1557     3655                   for each directive encountered in the pseudo-code.
     1558     3656                   This procedure is composed of a case statement using
     1559     3657                   the SYMBOL element of the P_CODE structure, which
     1560     3658                   is the terminal number of the token used to represent
     1561     3659                   the directive name.   The preprocessor variables used
     1562     3660                   in the case statement that makes up the body of this
     1563     3661                   procedure come from the file Z8P_ORDER_DEF.  The value
     1564     3662                   of the preprocessor variable is the same as
     1565     3663                   the position of the corresponding directive in the order
     1566     3664                   list of the grammar.
     1567     3665         */
     1568     3666
     1569     3667    3        DO CASE(P_CODE.SYMBOL);
     1570     3668
     1571     3669    3          CASE(%DECCNT,%INCCNT);
     1572     3670    3            IF OPCNT < 2 THEN
     1573     3671    3              P_CODE.OPERAND(1) = '1';
     1574     3672
     1575     3673    3          CASE(%JMPDV);
     1576     3674    3            CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(1));
     1577     3675    3            CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);
     1578     3676    3            CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);
     1579     3677
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:54   
     1580     3678    3          CASE(%GENI);
     1581     3679    3            IF OPCNT < 1 THEN
     1582     3680    3              P_CODE.OPERAND(0) ='      262143';
     1583     3681    3            IF OPCODE = 'VFD' THEN
     1584     3682    4              DO;
     1585     3683    4                VFD_WORD = BITBIN(VFD_ACC);
     1586     3684    4                CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);
     1587     3685    4                CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);
     1588     3686    4              END;
     1589     3687    3            ELSE IF OPCODE = 'ZERO' THEN
     1590     3688    4              DO;
     1591     3689    4                VFD_WORD = 0;
     1592     3690    4                CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);
     1593     3691    4                CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);
     1594     3692    4              END;
     1595     3693    3            ELSE
     1596     3694    4              DO;
     1597     3695    4                IF MODFIELDS.EXISTS(0) THEN
     1598     3696    4                  CALL GEN_EIS_INST(MODFIELDS,OPTIONAL_FIELDS,OPCODE,UPPER_HALF,
              3696                           LOWER_HALF);
     1599     3697    4                ELSE CALL GEN_SIMPLE_INST(OPCODE,YFIELD,MOD_TYPE,TAG_TYPE,
     1600     3698    4                                  UPPER_HALF,LOWER_HALF);
     1601     3699    4                CALL BINCHAR(P_CODE.OPERAND(1),BITBIN(UPPER_HALF));
     1602     3700    4                CALL BINCHAR(P_CODE.OPERAND(2),BITBIN(LOWER_HALF));
     1603     3701    4              END;
     1604     3702
     1605     3703    3          CASE(%MAPT);
     1606     3704    3            IF OPCNT < 3 THEN
     1607     3705    3               P_CODE.OPERAND(2) = '1';
     1608     3706
     1609     3707    3          CASE(%QUIT,%DSTATE,%STORE,%JMP,%GOSUB,%ASSIGN,%WALK,
     1610     3708    3               %WALK2,%WALK3,%ALLOW,%ATTACH,%OFFSET,
     1611     3709    3               %DEFER,%DEFLAB,%ORGE,%REFLAB,%ORGS,%WRAPUP,%ADDRESS,%ALLOTD,%BCT,
     1612     3710    3               %HALT,%REF_,%RTN,%CONST,%DESCR,%NEWLAB,%TAG,%BURST,
     1613     3711    3               %FAVOR);
     1614     3712
     1615     3713    3          CASE(%AD,%AND,%MOVE,%MOVIND,%OR,%SHIFTL,%SHIFTR);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:55   
     1616     3714    3            CALL HANDLE_PC_UTILITIES(FWBOT,SWTOP,SWBOT);
     1617     3715                 %SELECT_OU;
     1618     3718    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',');
     1619     3719                 %OUTPUT_STR;
     1620     3730    3            CALL CONCAT(BUFFER,%SPACER# FWBOT);
     1621     3731                 %OUTPUT_STR;
     1622     3742    3            CALL CONCAT(BUFFER,%SPACER# SWTOP);
     1623     3743                 %OUTPUT_STR;
     1624     3754    3            CALL CONCAT(BUFFER,%SPACER# SWBOT);
     1625     3755                 %OUTPUT_STR;
     1626     3766                 %SELECT_LO;
     1627     3769    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;
     1628     3770    3            RETURN;
     1629     3771
     1630     3772    3          CASE(%ALLOT);
     1631     3773                 %SELECT_OU;
     1632     3776    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',');
     1633     3777                 %OUTPUT_STR;
     1634     3788    3            CALL CONCAT(BUFFER,'%(BITBIN((BINBIT(',P_CODE.OPERAND(0),
     1635     3789    3                '*4096,18) | BINBIT(',P_CODE.OPERAND(1));
     1636     3790                 %OUTPUT_STR;
     1637     3801    3            CALL CONCAT(BUFFER,'*32,18)) | BINBIT(',
     1638     3802    3                P_CODE.OPERAND(2),',18))),');
     1639     3803                 %OUTPUT_STR;
     1640     3814    3            CALL CONCAT(BUFFER,'%(BITBIN(BINBIT(',P_CODE.OPERAND(5),
     1641     3815    3                 ',18) | BINBIT(',P_CODE.OPERAND(3),' * 512,18))),');
     1642     3816                 %OUTPUT_STR;
     1643     3827    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(4),',');
     1644     3828                 %OUTPUT_STR;
     1645     3839                  %SELECT_LO;
     1646     3842    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;
     1647     3843    3            RETURN;
     1648     3844
     1649     3845
     1650     3846    3          CASE(%APPLY);
     1651     3847    3            CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(0));
     1652     3848    3            P_CODE.OPERAND(0) = P_CODE.OPERAND(1);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:56   
     1653     3849    3            CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);
     1654     3850    3            CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);
     1655     3851
     1656     3852    3          CASE(%CASE);
     1657     3853    3            P_CODE.OPERAND(0) = ZILCH;
     1658     3854
     1659     3855    3          CASE(%IFID);
     1660     3856                 %SELECT_OU;
     1661     3859    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',');
     1662     3860                 %OUTPUT_STR;
     1663     3871    3            CALL CONCAT(BUFFER,'%(BITBIN(BINBIT(',P_CODE.OPERAND(0),
     1664     3872    3                  '*4096,18) | BINBIT(',P_CODE.OPERAND(1),'*32,18))),');
     1665     3873                 %OUTPUT_STR;
     1666     3884
     1667     3885    3            IF P_CODE.OPERAND(2) = ZILCH THEN
     1668     3886    4              DO;
     1669     3887    4                CALL CONCAT(BUFFER,%SPACER# '2,',P_CODE.OPERAND(3),',');
     1670     3888                     %OUTPUT_STR;
     1671     3899    4              END;
     1672     3900    3            ELSE IF P_CODE.OPERAND(3) = ZILCH THEN
     1673     3901    4                   DO;
     1674     3902    4                      CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(2),',2,');
     1675     3903                           %OUTPUT_STR;
     1676     3914    4                   END;
     1677     3915    3                 ELSE
     1678     3916    4                   DO;
     1679     3917    4                     CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(2),',',P_CODE.OPERAND(3
              3917                              ),',');
     1680     3918                          %OUTPUT_STR;
     1681     3929    4                   END;
     1682     3930                 %SELECT_LO;
     1683     3933    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;
     1684     3934    3            RETURN;
     1685     3935
     1686     3936    3          CASE(%IFITIS);
     1687     3937    3            IF P_CODE.OPERAND(1) = ZILCH THEN
     1688     3938    3              P_CODE.OPERAND(1) = '2';
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:57   
     1689     3939    3            ELSE P_CODE.OPERAND(2) = '2';
     1690     3940
     1691     3941    3          CASE(%EQLR);
     1692     3942    3            IF P_CODE.OPERAND(0) = ZILCH THEN
     1693     3943    3              P_CODE.OPERAND(0) = '2';
     1694     3944    3            IF P_CODE.OPERAND(1) = ZILCH THEN
     1695     3945    3               P_CODE.OPERAND(1) = '2';
     1696     3946
     1697     3947    3          CASE(%EQUATE,%NULL,%ENTER_PL6,%PAGE,%START);
     1698     3948    3            RETURN;
     1699     3949
     1700     3950    3          CASE(%LIB);
     1701     3951    3            IF P_CODE.OPERAND(0) = 'PCOM' THEN
     1702     3952    4              DO;
     1703     3953    4                P_CODE.OPERAND(0) = P_CODE.OPERAND(1);
     1704     3954    4                P_CODE.OPERAND(1) = P_CODE.OPERAND(2);
     1705     3955    4                P_CODE.OPERAND(2) = '%PCOM';
     1706     3956    4              END;
     1707     3957
     1708     3958    3          CASE(ELSE);
     1709     3959    3            CALL Z8PA$ERROR_PROC(%MESS8);
     1710     3960    3        END; /* CASE */
     1711     3961
     1712     3962
     1713     3963            /* Output the P_CODE to the object table */
     1714     3964             %SELECT_OU;
     1715     3967    2        CALL BLANK_ZERO(ADDR(P_CODE.OPERAND(0)),%OPERAND_LEN);
     1716     3968    2        CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',',
     1717     3969    2                    P_CODE.OPERAND(0),',');
     1718     3970             %OUTPUT_STR;
     1719     3981    2        IF P_CODE.TWO_WORDS THEN
     1720     3982    3          DO;
     1721     3983    3            CALL BLANK_ZERO(ADDR(P_CODE.OPERAND(1)),%OPERAND_LEN);
     1722     3984    3            CALL BLANK_ZERO(ADDR(P_CODE.OPERAND(2)),%OPERAND_LEN);
     1723     3985    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(1),',',
     1724     3986    3                        P_CODE.OPERAND(2),',');
     1725     3987                 %OUTPUT_STR;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:58   
     1726     3998    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;
     1727     3999    3          END;
     1728     4000    2        ELSE CURRENT_OT_POS = CURRENT_OT_POS + 1;
     1729     4001             %SELECT_LO;
     1730     4004    2    END GEN_P_CODE;
     1731     4005
     1732     4006         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:59   
     1733     4007    1    GENERATE_XREF :PROC;
     1734     4008         /*I*
     1735     4009              NAME: GENERATE_XREF
     1736     4010              PURPOSE:
     1737     4011                   Generate the cross reference to be output to the end of the PCA
     1738     4012                   listing.
     1739     4013              CALL:
     1740     4014                   CALL GENERATE_XREF;
     1741     4015              DATA:
     1742     4016                   REF_LIST, LABEL_TABLE
     1743     4017              DESCRIPTION:
     1744     4018                   For each entry in the  LABEL_TABLE step through its
     1745     4019                   list of references in REF_LIST.  Output this list of
     1746     4020                   references along with the type of label it is.
     1747     4021         */
     1748     4022    2        DCL POS PTR;
     1749     4023
     1750     4024    2        HEADER_LINE2 = 'CROSS REFERENCE FOR LABEL DEFINITIONS AND REFERENCES';
     1751     4025    2        HEADER_LINE3 =
              4025                 'SYMBOL                        TYPE  DEFINED          REFERENCES';
     1752     4026    2        CALL EJECT_PAGE;
     1753     4027    2        CALL OUTPUT_HEADER;
     1754     4028
     1755     4029             /* Output a key to the type codes */
     1756     4030    2        BUFFER = ' ';
     1757     4031             %OUTPUT_STR;
     1758     4042    2        BUFFER = '    Types are: ** = PEPD entry, UD = undefined.';
     1759     4043             %OUTPUT_STR;
     1760     4054    2        BUFFER = ' ';
     1761     4055             %OUTPUT_STR;
     1762     4066
     1763     4067
     1764     4068               /* For each label in the label table list all references to it */
     1765     4069    2        IF TOP_LABEL_TABLE ~= ADDR(NIL) THEN
     1766     4070    2          CALL Z8PA$OUTPUT_XREF(TOP_LABEL_TABLE);
     1767     4071
     1768     4072    2    END GENERATE_XREF;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:60   
     1769     4073         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:61   
     1770     4074    1    GEN_JMP_DEST : PROC(TABLE);
     1771     4075
     1772     4076    2        DCL TABLE PTR;
     1773     4077
     1774     4078             %SELECT_SUBS;
     1775     4081
     1776     4082    2        IF TABLE ~= ADDR(NIL) THEN
     1777     4083    2          CALL Z8PA$OUTPUT_JMP_DEST(TABLE);
     1778     4084
     1779     4085             %SELECT_LO;
     1780     4088
     1781     4089    2    END GEN_JMP_DEST;
     1782     4090         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:62   
     1783     4091
     1784     4092    1    OUTPUT_BURST_DEST : PROC;
     1785     4093         /*I*
     1786     4094              NAME: OUTPUT_BURST_DEST
     1787     4095              PURPOSE:
     1788     4096                   Generate definitions for the labels created for BURST directives
     1789     4097                   when they were output to the object table.
     1790     4098              CALL:
     1791     4099                   CALL OUTPUT_BURST_DEST;
     1792     4100              DATA:
     1793     4101                   BURST_TABLE
     1794     4102                   DEP
     1795     4103              DESCRIPTION:
     1796     4104                   Step through the burst table.  For each entry search the DEP
     1797     4105                   table (where DEP entrys from START directives are stored) to
     1798     4106                   find the id (position in output DEP).  Output to M$SO  an
     1799     4107                   equ that sets the created label equal to the id.
     1800     4108         */
     1801     4109
     1802     4110    2        DCL CNT PTR;
     1803     4111    2        DCL CNT2 PTR;
     1804     4112    2        DCL TEXT CHAR(8);
     1805     4113    2        DCL MESS CHAR(%MESS_LEN);
     1806     4114
     1807     4115             %SELECT_SUBS;
     1808     4118
     1809     4119    2        CNT = TOP_BURST_TABLE;
     1810     4120    3        DO WHILE(CNT ~= ADDR(NIL));
     1811     4121    3          CNT2 = TOP_DEP;
     1812     4122
     1813     4123    4          DO WHILE ((CNT2 ~= ADDR(NIL)) AND
     1814     4124    4                    (CNT2->DEP.LT_POS ~= CNT->BURST_TABLE.LABEL_POS));
     1815     4125    4            CNT2 = CNT2->DEP.NEXT;
     1816     4126    4          END;
     1817     4127
     1818     4128    3          IF CNT2 = ADDR(NIL) THEN
     1819     4129    4            DO;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:63   
     1820     4130    4              CALL CONCAT(MESS,%MESS6,
     1821     4131    4                        CNT->BURST_TABLE.LABEL_POS->LABEL_TABLE.NAME);
     1822     4132    4              CALL Z8PA$ERROR_PROC(MESS);
     1823     4133    4            END;
     1824     4134    3          ELSE
     1825     4135    4            DO;
     1826     4136    4              CALL BINCHAR(TEXT,CNT2->DEP.LT_POS->LABEL_TABLE.LOCATION);
     1827     4137    4              CALL CONCAT(BUFFER,'%EQU D',CNT->BURST_TABLE.DEST,
     1828     4138    4                    ' = ',TEXT,';');
     1829     4139                   %OUTPUT_STR;
     1830     4150    4            END;
     1831     4151
     1832     4152    3          CNT = CNT->BURST_TABLE.NEXT;
     1833     4153    3        END; /* WHILE */
     1834     4154             %SELECT_LO;
     1835     4157    2    END OUTPUT_BURST_DEST;
     1836     4158         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:64   
     1837     4159
     1838     4160    1    TERMINATE_OT : PROC;
     1839     4161         /*I*
     1840     4162              NAME: TERMINATE_OT
     1841     4163              PURPOSE:
     1842     4164                   Complete the object table so that PL6 will be able to compile it.
     1843     4165              CALL:
     1844     4166                   CALL TERMINATE_OT;
     1845     4167              DATA:
     1846     4168                   CURRENT_OT_POS
     1847     4169              DESCRIPTION:
     1848     4170                   Output the closing parenthesis to the INIT  attribute of
     1849     4171                   the OBJECT TABLE which makes up the bulk of the table.
     1850     4172                   Also output to M$SO a definition of OT_LEN  which is
     1851     4173                   used to define the length of the table.
     1852     4174         */
     1853     4175             %SELECT_SUBS;
     1854     4178    2        CALL BINCHAR(CHAR_NUM,(CURRENT_OT_POS * 2));
     1855     4179    2        CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);
     1856     4180    2        CALL CONCAT(BUFFER,'%EQU OT_LEN_',SEGMENT_NAME,' = ',CHAR_NUM,';');
     1857     4181             %OUTPUT_STR;
     1858     4192             %SELECT_OU;
     1859     4195    2        BUFFER = ' 1);';
     1860     4196             %OUTPUT_STR;
     1861     4207    2        CALL BINCHAR(CHAR_NUM,(CURRENT_OT_POS - 1));
     1862     4208    2        CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);
     1863     4209    2        CALL CONCAT(BUFFER,'DCL OT_LEN UBIN EXT INIT(',CHAR_NUM,');');
     1864     4210             %OUTPUT_STR;
     1865     4221             %SELECT_LO;
     1866     4224    2    END TERMINATE_OT;
     1867     4225
     1868     4226
     1869     4227
     1870     4228         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:65   
     1871     4229    1    GET_SHIFT_FACTOR : PROC(SHIFT_FACTOR,DISTANCE);
     1872     4230         /*I*
     1873     4231              NAME: GET_SHIFT_FACTOR
     1874     4232              PURPOSE:
     1875     4233                   This procedure calculates powers of two which are used to shift
     1876     4234                   contents of variables.
     1877     4235              CALL:
     1878     4236                   CALL GET_SHIFT_FACTOR(SHIFT_FACTOR,DISTANCE);
     1879     4237              PARAMETERS:
     1880     4238                   SHIFT_FACTOR
     1881     4239                     The result of the exponentiation.
     1882     4240                   DISTANCE
     1883     4241                     The number of places to left needed in the shift, or
     1884     4242                     the power of two needed.
     1885     4243              DATA:
     1886     4244                   None.
     1887     4245              DESCRIPTION:
     1888     4246                   Use an indexed do loop to carry out repeated multiplication.
     1889     4247         */
     1890     4248    2        DCL SHIFT_FACTOR UBIN WORD;
     1891     4249    2        DCL DISTANCE SBIN WORD;
     1892     4250    2        DCL CNT SBIN WORD;
     1893     4251
     1894     4252    2        SHIFT_FACTOR = 1;
     1895     4253    2        CNT = 0;
     1896     4254    3        DO WHILE CNT < DISTANCE;
     1897     4255    3          SHIFT_FACTOR = SHIFT_FACTOR * 2;
     1898     4256    3          CNT = CNT + 1;
     1899     4257    3        END;
     1900     4258
     1901     4259    2    END GET_SHIFT_FACTOR;
     1902     4260         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:66   
     1903     4261
     1904     4262    1    HANDLE_PL6 : PROC;
     1905     4263         /*I*
     1906     4264              NAME: HANDLE_PL6
     1907     4265              PURPOSE:
     1908     4266                   This procedure is called when an ENTER_PL6 directive is encountered
     1909     4267                   to skip over the following PL6 code until ENTER_PCA is found.
     1910     4268                   If a line did not contain ENTER_PCA then it is echoed to the
     1911     4269                   object table.
     1912     4270              CALL:
     1913     4271                   CALL HANDLE_PL6;
     1914     4272              DATA:
     1915     4273                   None.
     1916     4274              DESCRIPTION:
     1917     4275                   This procedure acts like a second scanner and is necessary
     1918     4276                   in order to avoid including PL6 grammer rules in the grammar.
     1919     4277                   Each line following the line that contained the enter directive
     1920     4278                   is scanned for the words ENTER_PCA.  If the line does not contain
     1921     4279                   those words then it is echoed to the file containing the object
     1922     4280                   table.
     1923     4281         */
     1924     4282    2        DCL NUM SBIN WORD;
     1925     4283
     1926     4284    3        DO WHILE '1'B;
     1927     4285               /* GET NEXT LINE */
     1928     4286    3          INSTR_LEN = 0;
     1929     4287    3          INSTR_INDX = 0;
     1930     4288    3          CALL INPUT(INSTR,INSTR_LEN,KEY_REC);
     1931     4289    3          IF INSTR_LEN < 1 THEN
     1932     4290    4            DO;
     1933     4291    4              EOF_FLAG = '1'B;
     1934     4292    4              RETURN;
     1935     4293    4            END;
     1936     4294    3          INSTR_LISTED = '0'B;
     1937     4295    3          IF OPTIONS(LS_OPT) THEN
     1938     4296    3            CALL FORCE_LIST;
     1939     4297
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:67   
     1940     4298               /* SCAN THE LINE FOR 'ENTER_PCA' */
     1941     4299    4          DO NUM = 0 TO (INSTR_LEN - 9);
     1942     4300    4            IF SUBSTR(INSTRCHR,NUM,9) = 'ENTER_PCA' THEN
     1943     4301    5              DO;
     1944     4302    5                INSTR_LEN = 0;
     1945     4303    5                INSTR_INDX = 1;
     1946     4304    5                RETURN;
     1947     4305    5              END;
     1948     4306    4          END;
     1949     4307    3          BUFFER = SUBSTR(INSTRCHR,0,INSTR_LEN);
     1950     4308               %SELECT_OU;
     1951     4311               %OUTPUT_STR;
     1952     4322               %SELECT_LO;
     1953     4325    3        END;
     1954     4326    2    END HANDLE_PL6;
     1955     4327         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:68   
     1956     4328
     1957     4329    1    TRACE : PROC;
     1958     4330         /*I*
     1959     4331              NAME: TRACE
     1960     4332              PURPOSE:
     1961     4333                   Output an indication of whats going on if the trace option
     1962     4334                   has been specified in the source.
     1963     4335              CALL:
     1964     4336                   CALL TRACE;
     1965     4337              DATA:
     1966     4338                   None.
     1967     4339              DESCRIPTION:
     1968     4340                   If the trace option has been specified in the pca
     1969     4341                   program, then this procedure is called after each semantic
     1970     4342                   action is performed.  Trace outputs an indication of what
     1971     4343                   action was performed and in some case what the contents of
     1972     4344                   key variables are.
     1973     4345         */
     1974     4346    3      DO CASE (A);
     1975     4347    3           CASE(%SET_OPTIONS);
     1976     4348    3               CALL CONCAT(BUFFER,'SET OPTION ',LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     1977     4349
     1978     4350    3           CASE(%PUT_PROG_INFO);
     1979     4351    3               BUFFER = 'INITALIZE EVERYTHING';
     1980     4352
     1981     4353    3           CASE(%PUT_START_DEP);
     1982     4354    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP - 1) -> DNT.TEXT.NAME;
     1983     4355
     1984     4356
     1985     4357    3           CASE(%PUT_START_PEPD);
     1986     4358    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;
     1987     4359    3               CALL CONCAT(BUFFER,'PUT START (PEPD) ',LABEL_NAME);
     1988     4360    3               CALL CONCAT(BUFFER,'PUT START (DEP) ',LABEL_NAME);
     1989     4361
     1990     4362    3           CASE(%PUT_LABEL);
     1991     4363    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;
     1992     4364    3               CALL CONCAT(BUFFER,'PUT LABEL ',LABEL_NAME);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:69   
     1993     4365
     1994     4366    3           CASE(%PUT_OPERAND_MOD);
     1995     4367    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP));
     1996     4368    3               CALL CONCAT(BUFFER,' PUT OPERAND MODIFIIED ',LX_STK.DNTPTR(LX_TOP)->DNT.
              4368                        TEXT.NAME,
     1997     4369    3                           ' TERMINAL NUMBER = ',CHAR_NUM);
     1998     4370
     1999     4371    3           CASE(%PUT_OPERAND_UNMOD);
     2000     4372    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP));
     2001     4373    3               CALL CONCAT(BUFFER,' PUT OPERAND UNMODIFIED ',LX_STK.DNTPTR(LX_TOP)->DNT
              4373                        .TEXT.NAME,
     2002     4374    3                           ' TERMINAL NUMBER = ',CHAR_NUM);
     2003     4375
     2004     4376    3           CASE(%PUT_SIMPLE_DIR);
     2005     4377    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP));
     2006     4378    3               CALL CONCAT(BUFFER,'PUT DIR ',LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME,
     2007     4379    3                     ' TERMINAL NUMBER = ', CHAR_NUM);
     2008     4380
     2009     4381    3           CASE(%ADD_XREF);
     2010     4382    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;
     2011     4383    3               CALL CONCAT(BUFFER,'ADD TO XREF ',LABEL_NAME);
     2012     4384
     2013     4385    3           CASE(%PUT_JMP_DEST);
     2014     4386    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP - 1));
     2015     4387    3               CALL CONCAT (BUFFER,'PUT JMP DESTINATION INTO P CODE: ',
     2016     4388    3                       LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME);
     2017     4389
     2018     4390    3           CASE(%PUT_UNSPECIFIC_REG);
     2019     4391    3               CALL CONCAT(BUFFER,'PUT UNSPECIFIC REG : ','%',LX_STK.DNTPTR(LX_TOP)->
              4391                        DNT.TEXT.NAME);
     2020     4392
     2021     4393    3           CASE(%PUT_SPECIFIC_REG);
     2022     4394    3               CALL CONCAT(BUFFER,'PUT SPECIIFC REG: ','%',LX_STK.DNTPTR(LX_TOP - 1)->
              4394                        DNT.TEXT.NAME,
     2023     4395    3                           LX_STK.DNTPTR(LX_TOP + 1)->DNT.TEXT.NAME);
     2024     4396
     2025     4397    3           CASE(%GENERATE_P_CODE);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:70   
     2026     4398    3               BUFFER = 'GEN_P_CODE ';
     2027     4399
     2028     4400    3         CASE(%FINISH_PROGRAM);
     2029     4401    3               BUFFER = 'FINISH PROGRAM';
     2030     4402
     2031     4403    3           CASE(%PUT_OPCODE);
     2032     4404    3               CALL CONCAT(BUFFER,' PUT OPCODE: ',OPCODE);
     2033     4405
     2034     4406
     2035     4407    3           CASE(%PUT_IR);
     2036     4408    3               BUFFER = 'ADDRESSING MODE IS IR';
     2037     4409
     2038     4410    3           CASE(%PUT_RI);
     2039     4411    3               BUFFER = 'ADDRESSING MODE IS RI';
     2040     4412
     2041     4413    3           CASE(%PUT_MOD_TYPE);
     2042     4414    3               CALL CONCAT(BUFFER,' ADDRESSING MODIFICATION IS  ',MOD_TYPE);
     2043     4415
     2044     4416    3           CASE(%PUT_INTEGER_OPERAND);
     2045     4417    3               CALL CONCAT(BUFFER,'PUT INTEGER OPERAND ',
     2046     4418    3                    LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2047     4419
     2048     4420    3           CASE(%PUT_ZERO_OPERAND);
     2049     4421    3               BUFFER = 'PUT ZERO OPERAND';
     2050     4422
     2051     4423    3           CASE(%AHEAD_OT_POS1);
     2052     4424    3               BUFFER = 'INCREMENT AHEAD_OT_POS BY 1';
     2053     4425
     2054     4426    3           CASE(%AHEAD_OT_POS2);
     2055     4427    3               BUFFER = 'INCREMENT AHEAD_OT_POS BY 2';
     2056     4428
     2057     4429    3           CASE(%PUT_MODFIELD);
     2058     4430    3               CALL BINCHAR(CHAR_NUM,MODFIELD_CNT);
     2059     4431    3               CALL CONCAT(BUFFER,'PUT MODFIELD NUMBER ',CHAR_NUM);
     2060     4432
     2061     4433    3           CASE(%PUT_BASE_SPECIFIER);
     2062     4434    3               CALL CONCAT(BUFFER,'PUT BASE SPECIFIER ',VFD_BASE_SPECIFIER);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:71   
     2063     4435
     2064     4436    3           CASE(%LOAD_VFD_FIELD);
     2065     4437    3               BUFFER = 'LOAD VFD FIELD';
     2066     4438
     2067     4439    3           CASE(%PUT_YFIELD_ARITH);
     2068     4440    3               BUFFER = 'PUT ARITH EXP FROM YFIELD';
     2069     4441
     2070     4442    3           CASE(%HANDLE_EQU_INT);
     2071     4443    3               BUFFER = 'HANDLE AN EQU WITH INTEGER VALUE';
     2072     4444
     2073     4445    3           CASE(%HANDLE_EQU_LABEL);
     2074     4446    3               BUFFER = 'HANDLE AN EQU WITH LABEL VALUE';
     2075     4447
     2076     4448    3           CASE(%PUT_OCTAL_LITERAL);
     2077     4449    3               BUFFER = 'PUT OCTAL LITERAL INTO YFIELD';
     2078     4450
     2079     4451    3           CASE(%PUT_DECIMAL_LITERAL);
     2080     4452    3               BUFFER = 'PUT OCTAL LITERAL INTO YFIELD';
     2081     4453
     2082     4454    3           CASE(%PUT_NULL_MODFIELD);
     2083     4455    3               BUFFER = 'PUT NULL MODFIELD';
     2084     4456
     2085     4457    3           CASE(%CLEAR_SIGN_FLAG);
     2086     4458    3               BUFFER = 'CLEAR THE SIGN FLAG FOR A GENI LITERAL ';
     2087     4459
     2088     4460    3           CASE(%SET_EIS_OP1,%SET_EIS_OP2,%SET_EIS_OP3);
     2089     4461    3               BUFFER = 'SET EIS OPTIONAL FIELD (FOLLOWING MOD FIELDS)';
     2090     4462
     2091     4463    3           CASE(%EJECT_A_PAGE);
     2092     4464    3               BUFFER = 'EJECT A PAGE';
     2093     4465
     2094     4466    3           CASE(%PUT_UNSIGNED_DECIMAL_LITERAL);
     2095     4467    3               BUFFER = 'PUT AN UNSIGNED DECIMAL INTEGER INTO P_CODE';
     2096     4468
     2097     4469    3           CASE(%SKIP_PL6);
     2098     4470    3               BUFFER = 'SKIP CODE UNTIL ENTER_PCA IS FOUND';
     2099     4471
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:72   
     2100     4472    3           CASE(%PUT_BURST);
     2101     4473    3               BUFFER = 'PUT THE DESTINATION OF A BURST DIRECTIVE INTO BURST TABLE';
     2102     4474
     2103     4475    3           CASE(ELSE);
     2104     4476    3               CALL Z8PA$ERROR_PROC(%MESS9);
     2105     4477    3      END;  /* CASE */
     2106     4478           %OUTPUT_STR;
     2107     4489    2    END TRACE;
     2108     4490         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:73   
     2109     4491    2      DO CASE (A);
     2110     4492    2           CASE(%SET_OPTIONS);
     2111     4493    2               TRACE_OPT_ON = %TRUE;
     2112     4494
     2113     4495    2           CASE(%PUT_PROG_INFO);
     2114     4496    2               SEGMENT_NAME = LX_STK.DNTPTR(LX_TOP - 1)->DNT.TEXT.NAME;
     2115     4497    2               CHAR_NUM = ' ';
     2116     4498    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4498                        LENGTH),,
     2117     4499    2                       LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2118     4500    2               CALL CHARBIN(SEGMENT_NUMBER,CHAR_NUM);
     2119     4501    2               PROC_NAME = LX_STK.DNTPTR(LX_TOP-2)->DNT.TEXT.NAME;
     2120     4502    2               CALL SET_UP_PROG;
     2121     4503
     2122     4504    2           CASE(%PUT_START_DEP);
     2123     4505    2               LABEL_POS->LABEL_TABLE.TYPE = '**';
     2124     4506    2               CALL PUT_LABEL_DEP(LABEL_POS);
     2125     4507
     2126     4508    2           CASE(%PUT_START_PEPD);
     2127     4509    2                LABEL_POS->LABEL_TABLE.TYPE = '**';
     2128     4510    2               CALL PUT_LABEL_PEPD(LABEL_POS);
     2129     4511
     2130     4512    2           CASE(%PUT_LABEL);
     2131     4513    2               LABEL_TYPE = ' ';
     2132     4514    2               CALL PUT_LABEL_DEF(LABEL_POS,LABEL_TYPE);
     2133     4515    2               IF ~LOCAL_FLAG AND (TOP_LOCAL_LABEL_TABLE ~= ADDR(NIL)) THEN
     2134     4516    3                 DO;
     2135     4517    3                   CALL GEN_JMP_DEST(TOP_LOCAL_LABEL_TABLE);
     2136     4518    3                   TOP_LOCAL_LABEL_TABLE = ADDR(NIL);
     2137     4519    3                 END;
     2138     4520
     2139     4521
     2140     4522    2           CASE(%PUT_OPERAND_MOD);
     2141     4523    2               CALL CONCAT(OPERAND,'%',LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME);
     2142     4524    2               CALL PUT_OPERAND(OPERAND);
     2143     4525
     2144     4526    2           CASE(%PUT_OPERAND_UNMOD);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:74   
     2145     4527    2               OPERAND = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;
     2146     4528    2               CALL PUT_OPERAND(OPERAND);
     2147     4529
     2148     4530    2           CASE(%PUT_SIMPLE_DIR);
     2149     4531    2               P_CODE.SYMBOL = LX_STK.SYMBOL(LX_TOP);
     2150     4532    2               CALL CONCAT(P_CODE.SIMPLE_DIR,'%',LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME
              4532                        );
     2151     4533
     2152     4534    2           CASE(%ADD_XREF);
     2153     4535    2               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;
     2154     4536    2               PREVIOUS_LABEL_POS = LABEL_POS;
     2155     4537    2               CALL REFERENCE_LABEL_TABLE(LABEL_NAME,LABEL_POS);
     2156     4538
     2157     4539    2           CASE(%ADD_LOCAL_XREF);
     2158     4540    2               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;
     2159     4541    2               PREVIOUS_LABEL_POS = LABEL_POS;
     2160     4542    2               CALL REFERENCE_LOCAL_LABEL_TABLE(LABEL_NAME,LABEL_POS);
     2161     4543
     2162     4544    2           CASE(%PUT_JMP_DEST);
     2163     4545    2               CALL BINCHAR(DEST_CHAR,UNIQUE_NUM);
     2164     4546    2               CALL CONCAT(OPERAND,'%D',DEST_CHAR);
     2165     4547    2               CALL PUT_OPERAND(OPERAND);
     2166     4548    2               CALL BINCHAR(REF_POS->REF_LIST.DEST,UNIQUE_NUM);
     2167     4549    2               UNIQUE_NUM = UNIQUE_NUM + 1;
     2168     4550
     2169     4551
     2170     4552    2           CASE(%PUT_UNSPECIFIC_REG);
     2171     4553    2               CALL CONCAT(OPERAND,'%',LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2172     4554    2               CALL PUT_OPERAND(OPERAND);
     2173     4555
     2174     4556    2           CASE(%PUT_SPECIFIC_REG);
     2175     4557    2               CALL CONCAT(OPERAND,'%',LX_STK.DNTPTR(LX_TOP - 1)->DNT.TEXT.NAME,
     2176     4558    2                           LX_STK.DNTPTR(LX_TOP + 1)->DNT.TEXT.NAME);
     2177     4559    2               CALL PUT_OPERAND(OPERAND);
     2178     4560
     2179     4561    2           CASE(%GENERATE_P_CODE);
     2180     4562    2               CALL GEN_P_CODE;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:75   
     2181     4563    2               CALL INIT_P_CODE;
     2182     4564
     2183     4565    2           CASE(%FINISH_PROGRAM);
     2184     4566    2               CALL TERMINATE_OT;
     2185     4567    2               IF OPTIONS(XREF_OPT) THEN
     2186     4568    3                 DO;
     2187     4569    3                   PHASE = %GEN_XR;
     2188     4570    3                   CALL GENERATE_XREF;
     2189     4571    3                 END;
     2190     4572    2               PHASE = %OUT_LABEL;
     2191     4573    2               CALL GEN_JMP_DEST(TOP_LABEL_TABLE);
     2192     4574    2               CALL GEN_JMP_DEST(TOP_LOCAL_LABEL_TABLE);
     2193     4575    2               CALL OUTPUT_BURST_DEST;
     2194     4576    2               PHASE = %OUT_PEPD;
     2195     4577    2               CALL OUTPUT_PEPD;
     2196     4578    2               PHASE = %WRAP_UP;
     2197     4579    2               CALL Z8PA$WRAPUP;
     2198     4580
     2199     4581
     2200     4582    2           CASE(%PUT_OPCODE);
     2201     4583    2               OPCODE = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;
     2202     4584    2               CALL INIT_ASSEMBLY_INST;
     2203     4585
     2204     4586    2           CASE(%PUT_IR);
     2205     4587    2               TAG_TYPE = 'IR';
     2206     4588
     2207     4589    2           CASE(%PUT_RI);
     2208     4590    2               TAG_TYPE = 'RI';
     2209     4591
     2210     4592    2           CASE(%PUT_MOD_TYPE);
     2211     4593    2               MOD_TYPE = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;
     2212     4594
     2213     4595    2          CASE(%PUT_INTEGER_OPERAND);
     2214     4596    2                OPERAND = ' ';
     2215     4597    2                CALL INSERT(OPERAND,
     2216     4598    2                            (%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.LENGTH),,
     2217     4599    2                            LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:76   
     2218     4600    2                CALL PUT_OPERAND(OPERAND);
     2219     4601
     2220     4602    2          CASE(%PUT_SIGNED_INTEGER_OPERAND);
     2221     4603    2                OPERAND = ' ';
     2222     4604    2                CALL INSERT(OPERAND,
     2223     4605    2                            (%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.LENGTH),,
     2224     4606    2                            LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2225     4607    2                IF SIGN_EXIST AND (LX_STK.DNTPTR(LX_TOP-1)->DNT.TEXT.NAME = '-') THEN
     2226     4608    3                  DO;
     2227     4609    3                    CALL CHARBIN(NUM,OPERAND);
     2228     4610    3                    NUM = NUM * -1;
     2229     4611    3                    CALL BINCHAR(OPERAND,NUM_OUT.VAL);
     2230     4612    3                  END;
     2231     4613    2                SIGN_EXIST = %TRUE;
     2232     4614    2                CALL PUT_OPERAND(OPERAND);
     2233     4615
     2234     4616    2          CASE(%PUT_ZERO_OPERAND);
     2235     4617    2              OPERAND = ZILCH;
     2236     4618    2              CALL PUT_OPERAND(OPERAND);
     2237     4619
     2238     4620    2           CASE(%AHEAD_OT_POS1);
     2239     4621    2               IF NOT TABLE_DEF_OUT THEN
     2240     4622    2                 CALL SET_UP_TABLE;
     2241     4623    2               AHEAD_OT_POS = CURRENT_OT_POS + 1;
     2242     4624    2               P_CODE.TWO_WORDS = %FALSE;
     2243     4625
     2244     4626    2           CASE(%AHEAD_OT_POS2);
     2245     4627    2               IF NOT TABLE_DEF_OUT THEN
     2246     4628    2                 CALL SET_UP_TABLE;
     2247     4629    2               AHEAD_OT_POS = CURRENT_OT_POS + 2;
     2248     4630    2               P_CODE.TWO_WORDS = %TRUE;
     2249     4631
     2250     4632    2           CASE(%PUT_MODFIELD);
     2251     4633    2               IF LX_STK.DNTPTR(LX_TOP - 7)->DNT.TEXT.NAME = '1' THEN
     2252     4634    2                 MODFIELDS.ARI(MODFIELD_CNT) = '100'B;
     2253     4635    2               IF LX_STK.DNTPTR(LX_TOP - 5)->DNT.TEXT.NAME = '1' THEN
     2254     4636    2                 MODFIELDS.ARI(MODFIELD_CNT) = MODFIELDS.ARI(MODFIELD_CNT) | '010'B;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:77   
     2255     4637    2               IF LX_STK.DNTPTR(LX_TOP - 3)->DNT.TEXT.NAME = '1' THEN
     2256     4638    2                 MODFIELDS.ARI(MODFIELD_CNT) = MODFIELDS.ARI(MODFIELD_CNT) | '001'B;
     2257     4639    2               MODFIELDS.RNREG(MODFIELD_CNT) = LX_STK.DNTPTR(LX_TOP - 1)-> DNT.TEXT.
              4639                        NAME;
     2258     4640    2               MODFIELDS.EXISTS(MODFIELD_CNT) = %TRUE;
     2259     4641    2               MODFIELD_CNT = MODFIELD_CNT + 1;
     2260     4642
     2261     4643    2           CASE(%PUT_BASE_SPECIFIER);
     2262     4644    2               VFD_BASE_SPECIFIER = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;
     2263     4645
     2264     4646    2           CASE(%LOAD_VFD_FIELD);
     2265     4647    2               CHAR_NUM = ' ';
     2266     4648    2               IF VFD_BASE_SPECIFIER = 'D' THEN
     2267     4649    2                 CALL CHARBIN(VFD_NUM,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2268     4650    2               ELSE
     2269     4651    3                 DO;
     2270     4652    3                   CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT
              4652                            .LENGTH),,
     2271     4653    3                             LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2272     4654    3                   CALL OCTBIN(VFD_NUM,CHAR_NUM);
     2273     4655    3                 END;
     2274     4656    2               CALL CHARBIN(VFD_LENGTH,LX_STK.DNTPTR(LX_TOP - 2)->DNT.TEXT.NAME);
     2275     4657    2               VFD_ACC_POS = VFD_ACC_POS - VFD_LENGTH;
     2276     4658    2               CALL GET_SHIFT_FACTOR(SHIFT_FACTOR,VFD_ACC_POS);
     2277     4659    2               VFD_NUM = VFD_NUM * SHIFT_FACTOR;
     2278     4660    2               VFD_ACC = VFD_ACC | BINBIT(VFD_NUM,36);
     2279     4661    2               VFD_BASE_SPECIFIER = 'D';
     2280     4662
     2281     4663
     2282     4664    2           CASE(%PUT_YFIELD_ARITH);
     2283     4665    2                CALL HANDLE_ARITH_EXP(CHAR_NUM,%OPERAND_LEN);
     2284     4666    2                CALL CHARBIN(VFD_WORD,CHAR_NUM);
     2285     4667    2                YFIELD = VFD_OUT.LOWER;
     2286     4668
     2287     4669    2           CASE(%HANDLE_EQU_INT);
     2288     4670    2               CALL  CHARBIN(NUM,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2289     4671    2               CALL EQU_INT(NUM,LABEL_POS);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:78   
     2290     4672
     2291     4673    2           CASE(%HANDLE_EQU_LABEL);
     2292     4674    2               CALL EQU_LABEL(LABEL_POS,PREVIOUS_LABEL_POS);
     2293     4675
     2294     4676    2           CASE(%PUT_DECIMAL_LITERAL);
     2295     4677    2               CALL CHARBIN(NUM,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2296     4678    2               IF SIGN_EXIST THEN
     2297     4679    2                 IF LX_STK.DNTPTR(LX_TOP -1)->DNT.TEXT.NAME = '-' THEN
     2298     4680    2                   NUM = NUM * -1;
     2299     4681    2               SIGN_EXIST = %TRUE;
     2300     4682    2               VFD_WORD = NUM;
     2301     4683    2               YFIELD = VFD_OUT.LOWER;
     2302     4684
     2303     4685    2           CASE(%PUT_UNSIGNED_DECIMAL_LITERAL);
     2304     4686    2               CALL CHARBIN(NUM,LX_STK.DNTPTR(LX_TOP-1)->DNT.TEXT.NAME);
     2305     4687    2               SIGN_EXIST = %TRUE;
     2306     4688    2               VFD_WORD = NUM;
     2307     4689    2               YFIELD = VFD_OUT.LOWER;
     2308     4690
     2309     4691    2           CASE(%PUT_OCTAL_LITERAL);
     2310     4692    2               CHAR_NUM = ' ';
     2311     4693    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4693                        LENGTH)
     2312     4694    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2313     4695    2               CALL OCTBIN(NUM,CHAR_NUM);
     2314     4696    2               IF SIGN_EXIST THEN
     2315     4697    2                 IF LX_STK.DNTPTR(LX_TOP -1)->DNT.TEXT.NAME = '-' THEN
     2316     4698    2                   NUM = NUM * -1;
     2317     4699    2               SIGN_EXIST = %TRUE;
     2318     4700    2               VFD_WORD = NUM;
     2319     4701    2               YFIELD = VFD_OUT.LOWER;
     2320     4702
     2321     4703    2           CASE(%PUT_NULL_MODFIELD);
     2322     4704    2                MODFIELDS.EXISTS(MODFIELD_CNT) = %TRUE;
     2323     4705    2                MODFIELD_CNT = MODFIELD_CNT + 1;
     2324     4706
     2325     4707    2           CASE(%CLEAR_SIGN_FLAG);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:79   
     2326     4708    2               SIGN_EXIST = %FALSE;
     2327     4709
     2328     4710    2           CASE(%SET_EIS_OP1);
     2329     4711    2               CHAR_NUM = ' ';
     2330     4712    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4712                        LENGTH)
     2331     4713    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2332     4714    2               CALL OCTBIN(OPTIONAL_FIELDS(0),CHAR_NUM);
     2333     4715
     2334     4716    2           CASE(%SET_EIS_OP2);
     2335     4717    2               CHAR_NUM = ' ';
     2336     4718    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4718                        LENGTH)
     2337     4719    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2338     4720    2               CALL OCTBIN(OPTIONAL_FIELDS(1),CHAR_NUM);
     2339     4721
     2340     4722    2           CASE(%SET_EIS_OP3);
     2341     4723    2               CHAR_NUM = ' ';
     2342     4724    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4724                        LENGTH)
     2343     4725    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2344     4726    2               CALL OCTBIN(OPTIONAL_FIELDS(2),CHAR_NUM);
     2345     4727
     2346     4728    2           CASE(%EJECT_A_PAGE);
     2347     4729    2               IF OPTIONS(LS_OPT) THEN
     2348     4730    3                 DO;
     2349     4731    3                   CALL EJECT_PAGE;
     2350     4732    3                   CALL OUTPUT_HEADER;
     2351     4733    3                 END;
     2352     4734
     2353     4735    2           CASE(%SKIP_PL6);
     2354     4736    2              CALL HANDLE_PL6;
     2355     4737
     2356     4738    2           CASE(%PUT_BURST);
     2357     4739    2               CALL BINCHAR(DEST_CHAR,UNIQUE_NUM);
     2358     4740    2               UNIQUE_NUM = UNIQUE_NUM + 1;
     2359     4741    2               CALL PUT_BURST_DEST(DEST_CHAR);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:80   
     2360     4742    2               CALL CONCAT(P_CODE.OPERAND(OPCNT),'%D',DEST_CHAR);
     2361     4743    2               OPCNT = OPCNT + 1;
     2362     4744
     2363     4745    2           CASE(ELSE);
     2364     4746    2               CALL Z8PA$ERROR_PROC(%MESS3);
     2365     4747    2      END;  /* CASE */
     2366     4748
     2367     4749    1        IF TRACE_OPT_ON THEN
     2368     4750    1          CALL TRACE;
     2369     4751
     2370     4752    1    END Z8PA$SEMANTICS;
     2371     4753         %EOD;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:81   
--  Include file information  --

   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_OPS_TBL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_ORDR_DEF.:Z8A6TOU  is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_PARS_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_P_STATE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_PARS_STK.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8PA$SEMANTICS.

   Procedure Z8PA$SEMANTICS requires 4484 words for executable code.
   Procedure Z8PA$SEMANTICS requires 194 words of local(AUTO) storage.

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:82   

 Object Unit name= Z8PA$SEMANTICS                             File name= Z8PA.:Z8A6TOU
 UTS= AUG 09 '97 09:39:17.36 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none   306    462  LA_STK
    1  LblCom even  none     1      1  LX_TOP
    2  LblCom even  none   306    462  LX_STK
    3  LblCom even  none     1      1  STATE
    4  LblCom even  none     1      1  LA_CNT
    5  LblCom even  none     1      1  LA_PUT
    6  LblCom even  none     1      1  LA_GET
    7  LblCom even  none     1      1  REDUCTION
    8  LblCom even  none   501    765  PARSE_STACK
    9  LblCom even  none     1      1  PARSE_STACK_IDX
   10  LblCom even  none     1      1  ERRLINE
   11  LblCom even  none     1      1  ERRCOL
   12  LblCom even  none     1      1  ERR_LA_GET
   13  LblCom even  none     1      1  ERR_LA_PUT
   14  LblCom even  none     1      1  ERR_LA_CNT
   15  LblCom even  none     1      1  ERR_RECOVERY_IN_PROGRESS
   16  LblCom even  none     1      1  PARSE_ERROR_COUNT
   17  LblCom even  none   501    765  ALT_PARSE_STACK
   18  LblCom even  none     1      1  ALT_PARSE_STACK_IDX
   19  LblCom even  none   501    765  RED_STACK
   20  LblCom even  none     1      1  RED_STACK_TOP
   21  LblCom even  none     1      1  IED_FLAG
   22  LblCom even  none     1      1  ALT_LX_TOP
   23  LblCom even  none    53     65  CORRECTION
   24  LblCom even  none     1      1  OUT_DCBN
   25  LblCom even  none     1      1  SAVE_OUT_DCBN
   26  LblCom even  none     1      1  SAVE_DCBN2
   27   DCB   even  none     0      0  M$OU
   28   DCB   even  none     0      0  M$SO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:83   
   29   DCB   even  none     0      0  M$LO
   30   DCB   even  none     0      0  M$SI
   31   DCB   even  none     0      0  M$UI
   32   DCB   even  none     0      0  M$DO
   33  LblCom even  none     1      1  ERR_SEV
   34  LblCom even  none     1      1  OPTIONS
   35  LblCom even  none     1      1  DO_REQ
   36  LblCom even  none    26     32  OPTIONS_TEXT
   37  LblCom even  none   128    200  INSTR
   38  LblCom even  none     1      1  INSTR_LISTED
   39  LblCom even  none     1      1  INSTR_LEN
   40  LblCom even  none     1      1  INSTR_INDX
   41  LblCom even  none     1      1  EOF_FLAG
   42  LblCom even  none     5      5  KEY_REC
   43  LblCom even  none     1      1  LINES_OUT
   44  LblCom even  none    25     31  HEADER_LINE1
   45  LblCom even  none    25     31  HEADER_LINE3
   46  LblCom even  none    25     31  HEADER_LINE2
   47  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   48  LblCom even  none    28     34  LINE
   49  LblCom even  none     1      1  LINELEN
   50  LblCom even  none     1      1  PHASE
   51  LblCom even  none     1      1  ERROR_COUNT
   52   Data  even  none   904   1610  Z8PA$SEMANTICS
   53  LblCom even  none     1      1  CURRENT_OT_POS
   54  LblCom even  none     1      1  AHEAD_OT_POS
   55  RoData even  UTS    690   1262  Z8PA$SEMANTICS
   56   Proc  even  none  4484  10604  Z8PA$SEMANTICS
   57  RoData even  none    57     71  Z8PA$SEMANTICS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    56      0   yes            yes      Std        1  Z8PA$SEMANTICS
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:84   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8PA$WRAPUP
         yes           Std       0 OUTPUT_HEADER
         yes           Std       1 Z8PA$ERROR_PROC
         yes           Std       0 EJECT_PAGE
         yes           Std       2 OUTPUT
         yes           Std       2 GETNEW
         yes           Std       2 DEC_TO_OCT_SUP
         yes           Std       2 BLANK_ZERO
         yes           Std       1 Z8PA$OUTPUT_XREF
         yes           Std       1 Z8PA$OUTPUT_JMP_DEST
         yes           Std       3 INPUT
         yes           Std       0 FORCE_LIST
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$OU                                  M$SO                                  M$LO
     M$SI                                  M$UI                                  M$DO
     Z8PS$M$OU$                            Z8PS$M$LO$                            Z8PS$M$DO$
     Z8PS$M$SO$                            Z8PS$M$OU#                            Z8PS$M$LO#
     Z8PS$M$DO#                            Z8PS$M$SO#

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:85   


        1        1         /*M* Z8PA$SEMANTICS - EXECUTES SEMANTIC ACTIONS FOR THE PUEDO CODE ASSEMBLER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7         /*P*
        8        8              NAME: Z8PA$SEMANTICS
        9        9              PURPOSE:
       10       10                   This module is part of a PSEUDO CODE ASSEMBLER that was built
       11       11                   using the LALR1 parser generator.  This module executes the
       12       12                   semantic actions specified in the grammar that is input to LALR1.
       13       13              DESCRIPTION:
       14       14                   The main body of the module is a case statement that has
       15       15                   an entry for each semantic action.  The case statement is at the
       16       16                   end of the module.
       17       17              REFERENCES:
       18       18                   DN6, DN7, DN9, Z8PD_SI
       19       19         */
       20       20         Z8PA$SEMANTICS : PROC (A);

     20 56 000000   000000 700200 xent  Z8PA$SEMANT* TSX0  ! X66_AUTO_1
        56 000001   000302 000001                    ZERO    194,1
        56 000002   007144 710000 56                 TRA     s:4491

       21       21         /*D*
       22       22              NAME: Z8PA$SEMANTICS
       23       23              CALL:
       24       24                    CALL Z8PA$SEMANTICS(=SEMANTIC_ACTION);
       25       25              PARAMETERS:
       26       26                   A
       27       27                     An integer representing the semantic action to be performed.
       28       28                     These integers are defined by LALR1 and  communicated to
       29       29                     this module through the file SCPPDA_SUBS.
       30       30              ENVIRONMENT:
       31       31                   None.
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:86   
       32       32              INPUT:
       33       33                   LEX_STK and DNT.
       34       34              OUTPUT:
       35       35                   The primary output is  a table in the form of a PL6 program that
       36       36                   contains the assembled pseudo code.  This module also  generates
       37       37                   a listing and a cross reference.
       38       38              SCRATCH:
       39       39                   The files refered to by M$SO, M$OU, M$LS.
       40       40              DESCRIPTION:
       41       41                   Execute semantic actions specified by the parser.
       42       42         */
       43       43
       44       44
       45       45         %INCLUDE SCDPDA_SUBS;
       46      439         %INCLUDE Z8P_PARS_STK;
       47      482         %INCLUDE Z8P_P_STATE;
       48      545         %INCLUDE Z8P_PARS_DNT;
       49      566         %INCLUDE Z8P_SCAN_EXT;
       50      755         %INCLUDE Z8P_ORDR_DEF;
       51      826         %INCLUDE Z8P_OPS_TBL;
       52     1845         %INCLUDE Z8P_SEMAN_EX;
       53     1914
       54     1915         %INCLUDE Z9A_FLAGS;
       55     1929         %IF GCOS;
       57     1931         %ENDIF;
       58     1932         %IF CP6;
       59     1933         %EQU SPACER#=CHARTEXT(' ');
       60     1934         %ENDIF;
       61     1935
       62     1936         %DCBPTR;
       63     1946    1    DCL A SBIN WORD;
       64     1947    1    DCL CHAR_NUM CHAR(%OPERAND_LEN);
       65     1948    1    DCL NUM SBIN;
       66     1949    1    DCL 1 NUM_OUT REDEF NUM,
       67     1950    1        2 * UBIN(18) UNAL,
       68     1951    1        2 VAL UBIN(18) UNAL;
       69     1952    1    DCL TRACE_OPT_ON BIT(1) STATIC INIT(%FALSE);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:87   
       70     1953    1    DCL UNIQUE_NUM STATIC UBIN INIT(1);
              1953             /* Used in creating unique preprocesor variables */
       71     1954    1    DCL DEST_CHAR CHAR(8);
       72     1955    1    DCL OPERAND CHAR(%OPERAND_LEN);
       73     1956    1    DCL PROC_NAME CHAR (30) STATIC;
       74     1957    1    DCL SEGMENT_NUMBER UBIN WORD ALIGNED STATIC;
       75     1958    1    DCL SEGMENT_NAME CHAR(%LABEL_LENGTH) STATIC;
       76     1959    1    DCL LABEL_NAME CHAR(%LABEL_LENGTH) STATIC;
       77     1960    1    DCL LABEL_POS PTR STATIC;  /* Points to the last referencd label in LABEL_TABLE */
       78     1961    1    DCL PREVIOUS_LABEL_POS PTR STATIC; /* Points to the last last record referenced */
       79     1962    1    DCL LABEL_TYPE CHAR(5);
       80     1963    1    DCL INPUT ENTRY(3);
       81     1964    1    DCL FORCE_LIST ENTRY;
       82     1965    1    DCL Z8PA$OUTPUT_XREF ENTRY(1);
       83     1966    1    DCL Z8PA$OUTPUT_JMP_DEST ENTRY(1);
       84     1967    1    DCL Z8PA$ERROR_PROC ENTRY(1);
       85     1968    1    DCL Z8PA$WRAPUP ENTRY;
       86     1969    1    DCL LOCAL_FLAG BIT(1) STATIC;
       87     1970    1    DCL TABLE_DEF_OUT BIT(1) STATIC INIT('0'B);
       88     1971
       89     1972           /* Global variables used in constructing the GENI directive */
       90     1973    1    DCL OPCODE STATIC CHAR(5); /*Stores the opcode of  a GENI operand */
       91     1974    1    DCL YFIELD STATIC UBIN(18); /* YFIELD of ass. inst. within GENI */
       92     1975    1    DCL MOD_TYPE STATIC CHAR(3); /* Second op of ass. inst. within GENI */
       93     1976    1    DCL TAG_TYPE STATIC CHAR(2); /* Indicate if IR or RI addressing is used */
       94     1977    1    DCL UPPER_HALF BIT(18) ALIGNED;
              1977             /*Upper half of the machine word generated from GENI */
       95     1978    1    DCL LOWER_HALF BIT(18) ALIGNED;
              1978             /* Lower half of the machine word generated from GENI */
       96     1979    1    DCL 1 MODFIELDS (0:2) STATIC,
       97     1980             /*B* MODFIELDS is used in constructing machine words for the first
       98     1981                  word of a multi-word EIS instructions. */
       99     1982    1        2 ARI BIT(3),
      100     1983    1        2 RNREG CHAR(3),
      101     1984    1        2 EXISTS BIT(1);
      102     1985    1    DCL MODFIELD_CNT SBIN WORD STATIC;
      103     1986    1    DCL OPTIONAL_FIELDS (0:2) UBIN WORD STATIC;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:88   
      104     1987    1    DCL SIGN_EXIST BIT(1) STATIC INIT('0'B);
              1987             /* Used in handling literals in the GENI dir */
      105     1988
      106     1989         /*  The following are used to generate pc utility directives */
      107     1990    1    DCL FWBOT CHAR(120);
      108     1991    1    DCL SWTOP CHAR(120);
      109     1992    1    DCL SWBOT CHAR(120);
      110     1993
      111     1994
      112     1995
      113     1996
      114     1997          /* The following are used in directives that require VFD like constructs */
      115     1998    1    DCL VFD_WORD UBIN WORD;
      116     1999    1    DCL 1 VFD_OUT REDEF VFD_WORD,
      117     2000    1      2 UPPER UBIN HALF UNAL,
      118     2001    1      2 LOWER UBIN HALF UNAL;
      119     2002    1    DCL NUM2 UBIN WORD;
      120     2003    1    DCL 1 NUM3 REDEF NUM2,
      121     2004    1       2 * UBIN(27) UNAL,
      122     2005    1       2 CODE UBIN(9) UNAL;
      123     2006    1     DCL 1 NUM4 REDEF NUM2,
      124     2007    1       2 * UBIN(18) UNAL,
      125     2008    1       2 CODE UBIN(18) UNAL;
      126     2009    1    DCL VFD_ACC BIT(36) STATIC;
      127     2010    1    DCL VFD_ACC_POS SBIN STATIC;
      128     2011    1    DCL VFD_BASE_SPECIFIER CHAR(1) STATIC;
      129     2012    1    DCL VFD_NUM UBIN WORD;
      130     2013    1    DCL VFD_LENGTH UBIN WORD;
      131     2014    1    DCL SHIFT_FACTOR UBIN WORD;
      132     2015
      133     2016    1    DCL 1 P_CODE  STATIC,
      134     2017             /*B*  P_CODE is a structure used to accumulate a pseudocode directive
      135     2018                   until it can be output to the file containing the object table */
      136     2019    1        2 SIMPLE_DIR CHAR(12) INIT(' '),
      137     2020    1        2 SYMBOL SBIN WORD,
      138     2021    1        2 TWO_WORDS BIT(1),
      139     2022    1        2 OPERAND(0:%MAX_OPS) CHAR(%OPERAND_LEN) INIT(' '*0);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:89   
      140     2023    1    DCL OPCNT UBIN STATIC INIT(0);
              2023             /* A count of the operands in the current directive */
      141     2024
      142     2025    1    DCL 1 PEPD BASED (CURRENT_PEPD_POS),
      143     2026               /*B* PEPD will contain ptrs into LABEL_TABLE, and will be used to
      144     2027                    generate a PEPD to be output to m$so for inclusion in
      145     2028                    the object table module */
      146     2029    1        2 POS PTR,
      147     2030    1        2 NEXT PTR;
      148     2031
      149     2032    1    DCL 1 DEP BASED (CURRENT_DEP_POS),
      150     2033             /*B DEP accumulates information needed to output a DEP table to
      151     2034                 the object file */
      152     2035    1        2 LT_POS PTR,     /* Points into LABEL_TABLE */
      153     2036    1        2 NEXT PTR;
      154     2037
      155     2038    1    DCL 1 BURST_TABLE BASED (CURRENT_BT_POS),
      156     2039             /*B BURST_TABLE stores burst destinations, which will be used to define
      157     2040                 preprocessor varibles created when the BURST was encountered  */
      158     2041    1        2 LABEL_POS PTR,
      159     2042    1        2 DEST CHAR(8),
      160     2043    1        2 NEXT PTR;
      161     2044
      162     2045
      163     2046
      164     2047    1    DCL TOP_LABEL_TABLE PTR STATIC INIT(ADDR(NIL));
      165     2048    1    DCL CURRENT_OT_POS UBIN WORD ALIGNED EXT INIT(0);
      166     2049    1    DCL AHEAD_OT_POS UBIN WORD ALIGNED EXT INIT(0);
      167     2050    1    DCL REF_POS PTR STATIC INIT(ADDR(NIL));
      168     2051    1    DCL CURRENT_PEPD_POS PTR STATIC INIT(ADDR(NIL));
      169     2052    1    DCL CURRENT_DEP_POS PTR STATIC INIT(ADDR(NIL));
      170     2053    1    DCL CURRENT_BT_POS PTR STATIC INIT(ADDR(NIL));
      171     2054    1    DCL TOP_PEPD PTR STATIC INIT(ADDR(NIL));
      172     2055    1    DCL TOP_DEP PTR STATIC INIT(ADDR(NIL));
      173     2056    1    DCL TOP_BURST_TABLE PTR STATIC INIT(ADDR(NIL));
      174     2057    1    DCL TOP_LOCAL_LABEL_TABLE PTR STATIC INIT(ADDR(NIL));
      175     2058    1    DCL TOP_FREE_LT PTR STATIC INIT(ADDR(NIL));
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:90   
      176     2059    1    DCL TOP_FREE_RL PTR STATIC INIT(ADDR(NIL));
      177     2060
      178     2061
      179     2062
      180     2063         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:91   
      181     2064
      182     2065
      183     2066
      184     2067
      185     2068
      186     2069         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:92   
      187     2070    1    SET_UP_PROG : PROC;

   2070 56 000003   200240 741300       SET_UP_PROG  STX1  ! SHIFT_FACTOR+2,,AUTO

      188     2071         /*I*
      189     2072              NAME: SET_UP_PROG
      190     2073              PURPOSE:
      191     2074                   Set up the object table module so that it can be compiled by PL6.
      192     2075              CALL:
      193     2076                   CALL SET_UP_PROG;
      194     2077              DATA:
      195     2078                   None.
      196     2079              DESCRIPTION:
      197     2080                   This procedure outputs a procedure declaration for the
      198     2081                   module containing the object table.
      199     2082         */
      200     2083
      201     2084             %SELECT_OU;

   2085 56 000004   000000 235000 xsym               LDA     Z8PS$M$OU#
        56 000005   000000 755000 24                 STA     OUT_DCBN

      202     2087    2        CALL CONCAT(BUFFER,PROC_NAME,' : PROC;');

   2087 56 000006   040100 100400                    MLR     fill='040'O
        56 000007   001362 000036 52                 ADSC9   PROC_NAME                cn=0,n=30
        56 000010   200005 000036                    ADSC9   BUFFER,,AUTO             cn=0,n=30
        56 000011   040100 100400                    MLR     fill='040'O
        56 000012   000000 000010 55                 ADSC9   0                        cn=0,n=8
        56 000013   200014 400156                    ADSC9   BUFFER+7,,AUTO           cn=2,n=110

      203     2088             %OUTPUT_STR;

   2093 56 000014   000000 236000 24                 LDQ     OUT_DCBN
        56 000015   000025 604000 56                 TMI     s:2095
        56 000016   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 000017   000025 601000 56                 TNZ     s:2095
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:93   
        56 000020   000000 236000 34                 LDQ     OPTIONS
        56 000021   000002 736000                    QLS     2
        56 000022   400000 376003                    ANQ     -131072,DU
        56 000023   400000 676003                    ERQ     -131072,DU
        56 000024   000037 601000 56                 TNZ     s:2100

   2095 56 000025   000214 235007                    LDA     140,DL
        56 000026   200050 755100                    STA     LEN,,AUTO

   2096 56 000027   200050 630500                    EPPR0   LEN,,AUTO
        56 000030   200277 450500                    STP0    CNT2+3,,AUTO
        56 000031   200005 631500                    EPPR1   BUFFER,,AUTO
        56 000032   200276 451500                    STP1    CNT2+2,,AUTO
        56 000033   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000034   000000 631400 57                 EPPR1   0
        56 000035   000000 701000 xent               TSX1    OUTPUT
        56 000036   000000 011000                    NOP     0

      204     2099             %SELECT_LO;

   2100 56 000037   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 000040   000000 755000 24                 STA     OUT_DCBN

      205     2102
      206     2103    2    END SET_UP_PROG;

   2103 56 000041   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000042   000001 702211                    TSX2  ! 1,X1

      207     2104         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:94   
      208     2105    1    SET_UP_TABLE : PROC;

   2105 56 000043   200240 741300       SET_UP_TABLE STX1  ! SHIFT_FACTOR+2,,AUTO

      209     2106         /*I*
      210     2107              NAME: SET_UP_TABLE
      211     2108              PURPOSE:
      212     2109                   Output the declarations to the object file for the major
      213     2110                   table.
      214     2111              CALL:
      215     2112                   CALL SET_UP_TABLE;
      216     2113              DATA:
      217     2114                   None.
      218     2115              DESCRIPTION:
      219     2116                   Write the table declaration to the object file for the
      220     2117                   table named in the begin program line of the source
      221     2118                   program.
      222     2119         */
      223     2120             %SELECT_OU;

   2121 56 000044   000000 235000 xsym               LDA     Z8PS$M$OU#
        56 000045   000000 755000 24                 STA     OUT_DCBN

      224     2123             %IF CP6;
      225     2124    2        BUFFER = '%INCLUDE *LABEL_DEFS; ';

   2124 56 000046   040100 100400                    MLR     fill='040'O
        56 000047   000002 000026 55                 ADSC9   2                        cn=0,n=22
        56 000050   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

      226     2125             %ENDIF;
      227     2126             %IF GCOS;
      230     2129             %ENDIF;
      231     2130             %OUTPUT_STR;

   2135 56 000051   000000 236000 24                 LDQ     OUT_DCBN
        56 000052   000062 604000 56                 TMI     s:2137
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:95   
        56 000053   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 000054   000062 601000 56                 TNZ     s:2137
        56 000055   000000 236000 34                 LDQ     OPTIONS
        56 000056   000002 736000                    QLS     2
        56 000057   400000 376003                    ANQ     -131072,DU
        56 000060   400000 676003                    ERQ     -131072,DU
        56 000061   000074 601000 56                 TNZ     s:2141

   2137 56 000062   000214 236007                    LDQ     140,DL
        56 000063   200050 756100                    STQ     LEN,,AUTO

   2138 56 000064   200050 630500                    EPPR0   LEN,,AUTO
        56 000065   200277 450500                    STP0    CNT2+3,,AUTO
        56 000066   200005 631500                    EPPR1   BUFFER,,AUTO
        56 000067   200276 451500                    STP1    CNT2+2,,AUTO
        56 000070   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000071   000000 631400 57                 EPPR1   0
        56 000072   000000 701000 xent               TSX1    OUTPUT
        56 000073   000000 011000                    NOP     0

      232     2141    2        CALL CONCAT(BUFFER,'DCL ',SEGMENT_NAME,'(0:%OT_LEN_',SEGMENT_NAME,

   2141 56 000074   000010 236000 55                 LDQ     8
        56 000075   200005 756100                    STQ     BUFFER,,AUTO
        56 000076   040100 100400                    MLR     fill='040'O
        56 000077   001373 000036 52                 ADSC9   SEGMENT_NAME             cn=0,n=30
        56 000100   200006 000036                    ADSC9   BUFFER+1,,AUTO           cn=0,n=30
        56 000101   040100 100400                    MLR     fill='040'O
        56 000102   000011 000013 55                 ADSC9   9                        cn=0,n=11
        56 000103   200015 400013                    ADSC9   BUFFER+8,,AUTO           cn=2,n=11
        56 000104   040100 100400                    MLR     fill='040'O
        56 000105   001373 000036 52                 ADSC9   SEGMENT_NAME             cn=0,n=30
        56 000106   200020 200036                    ADSC9   BUFFER+11,,AUTO          cn=1,n=30
        56 000107   040100 100400                    MLR     fill='040'O
        56 000110   000014 000053 55                 ADSC9   12                       cn=0,n=43
        56 000111   200027 600101                    ADSC9   BUFFER+18,,AUTO          cn=3,n=65

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:96   
      233     2142    2               ') UBIN HALF HALIGNED CONSTANT SYMDEF INIT( ');
      234     2143             %OUTPUT_STR;

   2148 56 000112   000000 236000 24                 LDQ     OUT_DCBN
        56 000113   000123 604000 56                 TMI     s:2150
        56 000114   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 000115   000123 601000 56                 TNZ     s:2150
        56 000116   000000 236000 34                 LDQ     OPTIONS
        56 000117   000002 736000                    QLS     2
        56 000120   400000 376003                    ANQ     -131072,DU
        56 000121   400000 676003                    ERQ     -131072,DU
        56 000122   000135 601000 56                 TNZ     s:2155

   2150 56 000123   000214 235007                    LDA     140,DL
        56 000124   200050 755100                    STA     LEN,,AUTO

   2151 56 000125   200050 630500                    EPPR0   LEN,,AUTO
        56 000126   200277 450500                    STP0    CNT2+3,,AUTO
        56 000127   200005 631500                    EPPR1   BUFFER,,AUTO
        56 000130   200276 451500                    STP1    CNT2+2,,AUTO
        56 000131   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000132   000000 631400 57                 EPPR1   0
        56 000133   000000 701000 xent               TSX1    OUTPUT
        56 000134   000000 011000                    NOP     0

      235     2154             %SELECT_LO;

   2155 56 000135   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 000136   000000 755000 24                 STA     OUT_DCBN

      236     2157    2        TABLE_DEF_OUT = '1'B;

   2157 56 000137   400000 236003                    LDQ     -131072,DU
        56 000140   001416 756000 52                 STQ     TABLE_DEF_OUT

      237     2158
      238     2159    2    END SET_UP_TABLE;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:97   

   2159 56 000141   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000142   000001 702211                    TSX2  ! 1,X1

      239     2160         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:98   
      240     2161    1    INIT_P_CODE : PROC;

   2161 56 000143   200240 741300       INIT_P_CODE  STX1  ! SHIFT_FACTOR+2,,AUTO

      241     2162         /*I*
      242     2163              NAME: INIT_P_CODE
      243     2164              PURPOSE:
      244     2165                   Inititalize the P_CODE structure to  the default values for operands.
      245     2166              CALL:
      246     2167                   CALL INIT_P_CODE;
      247     2168              DATA:
      248     2169                   P_CODE
      249     2170              DESCRIPTION:
      250     2171                   Set the P_CODE structure to its default values.
      251     2172         */
      252     2173    2           P_CODE.SIMPLE_DIR = ' ';

   2173 56 000144   040000 100400                    MLR     fill='040'O
        56 000145   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 000146   001440 000014 52                 ADSC9   P_CODE                   cn=0,n=12

      253     2174    2           P_CODE.OPERAND(0) = ZILCH;

   2174 56 000147   040000 100400                    MLR     fill='040'O
        56 000150   000027 000036 55                 ADSC9   23                       cn=0,n=30
        56 000151   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30

      254     2175    2           P_CODE.OPERAND(1) = ZILCH;

   2175 56 000152   040000 100400                    MLR     fill='040'O
        56 000153   000027 000036 55                 ADSC9   23                       cn=0,n=30
        56 000154   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30

      255     2176    2           P_CODE.OPERAND(2) = ZILCH;

   2176 56 000155   040000 100400                    MLR     fill='040'O
        56 000156   000027 000036 55                 ADSC9   23                       cn=0,n=30
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:99   
        56 000157   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30

      256     2177    2           P_CODE.OPERAND(3) = ZILCH;

   2177 56 000160   040000 100400                    MLR     fill='040'O
        56 000161   000027 000036 55                 ADSC9   23                       cn=0,n=30
        56 000162   001472 600036 52                 ADSC9   P_CODE+26                cn=3,n=30

      257     2178    2           P_CODE.OPERAND(4) = ZILCH;

   2178 56 000163   040000 100400                    MLR     fill='040'O
        56 000164   000027 000036 55                 ADSC9   23                       cn=0,n=30
        56 000165   001502 200036 52                 ADSC9   P_CODE+34                cn=1,n=30

      258     2179    2           P_CODE.OPERAND(5) = ZILCH;

   2179 56 000166   040000 100400                    MLR     fill='040'O
        56 000167   000027 000036 55                 ADSC9   23                       cn=0,n=30
        56 000170   001511 600036 52                 ADSC9   P_CODE+41                cn=3,n=30

      259     2180    2           OPCNT = 0;

   2180 56 000171   001522 450000 52                 STZ     OPCNT

      260     2181
      261     2182    2    END INIT_P_CODE;

   2182 56 000172   000001 702211                    TSX2  ! 1,X1

      262     2183         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:100  
      263     2184    1    INIT_ASSEMBLY_INST : PROC;

   2184 56 000173   200240 741300       INIT_ASSEMB* STX1  ! SHIFT_FACTOR+2,,AUTO

      264     2185
      265     2186         /*I*
      266     2187              NAME: INIT_ASSEMBLY_INST
      267     2188              PURPOSE:
      268     2189                   Initialize global variables used in generating assembly language
      269     2190                   instructions found in the GENI directive.
      270     2191              CALL:
      271     2192                   CALL INIT_ASSEMBLY_INST;
      272     2193              DATA:
      273     2194                   None.
      274     2195              DESCRIPTION:
      275     2196                   Set the various instruction fields to their default values.
      276     2197         */
      277     2198    2          DCL CNT SBIN;
      278     2199
      279     2200    3          DO CNT = 0 TO 2;

   2200 56 000174   200241 450100                    STZ     CNT,,AUTO

      280     2201    3            MODFIELDS.ARI(CNT) = '000'B;

   2201 56 000175   200241 236100                    LDQ     CNT,,AUTO
        56 000176   000055 402007                    MPY     45,DL
        56 000177   000000 116003                    CMPQ    0,DU
        56 000200   000202 605000 56                 TPL     s:2201+5
        56 000201   000044 036003                    ADLQ    36,DU
        56 000202   003006 060400                    CSL     bolr='003'O
        56 000203   000002 000003 57                 BDSC    2                        by=0,bit=0,n=3
        56 000204   001424 000003 52                 BDSC    MODFIELDS,Q              by=0,bit=0,n=3

      281     2202    3            MODFIELDS.RNREG(CNT) = 'N';

   2202 56 000205   200241 236100                    LDQ     CNT,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:101  
        56 000206   000005 402007                    MPY     5,DL
        56 000207   040006 100400                    MLR     fill='040'O
        56 000210   000003 000001 57                 ADSC9   3                        cn=0,n=1
        56 000211   001424 200003 52                 ADSC9   MODFIELDS,Q              cn=1,n=3

      282     2203    3            MODFIELDS.EXISTS(CNT) = %FALSE;

   2203 56 000212   200241 236100                    LDQ     CNT,,AUTO
        56 000213   000055 402007                    MPY     45,DL
        56 000214   000000 116003                    CMPQ    0,DU
        56 000215   000217 605000 56                 TPL     s:2203+5
        56 000216   000044 036003                    ADLQ    36,DU
        56 000217   003006 060400                    CSL     bolr='003'O
        56 000220   000002 000001 57                 BDSC    2                        by=0,bit=0,n=1
        56 000221   001425 000001 52                 BDSC    MODFIELDS+1,Q            by=0,bit=0,n=1

      283     2204    3            OPTIONAL_FIELDS(CNT) = 0;

   2204 56 000222   200241 720100                    LXL0    CNT,,AUTO
        56 000223   001431 450010 52                 STZ     OPTIONAL_FIELDS,X0

      284     2205    3          END;

   2205 56 000224   200241 054100                    AOS     CNT,,AUTO
        56 000225   200241 235100                    LDA     CNT,,AUTO
        56 000226   000002 115007                    CMPA    2,DL
        56 000227   000175 604400 56                 TMOZ    s:2201

      285     2206
      286     2207    2          MODFIELD_CNT = 0;

   2207 56 000230   001430 450000 52                 STZ     MODFIELD_CNT

      287     2208    2          VFD_ACC = '000000000000'O;

   2208 56 000231   000037 236000 55                 LDQ     31
        56 000232   001435 756000 52                 STQ     VFD_ACC
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:102  

      288     2209    2          VFD_ACC_POS = 36;

   2209 56 000233   000044 235007                    LDA     36,DL
        56 000234   001436 755000 52                 STA     VFD_ACC_POS

      289     2210    2          VFD_BASE_SPECIFIER = 'D';

   2210 56 000235   104000 236003                    LDQ     34816,DU
        56 000236   001437 756000 52                 STQ     VFD_BASE_SPECIFIER

      290     2211
      291     2212    2          YFIELD = 0;

   2212 56 000237   000000 220003                    LDX0    0,DU
        56 000240   001421 740000 52                 STX0    YFIELD

      292     2213    2          TAG_TYPE = '  ';

   2213 56 000241   000027 221000 55                 LDX1    23
        56 000242   001423 741000 52                 STX1    TAG_TYPE

      293     2214    2          MOD_TYPE = '  ';

   2214 56 000243   000027 236000 55                 LDQ     23
        56 000244   777777 376003                    ANQ     -1,DU
        56 000245   040040 276007                    ORQ     16416,DL
        56 000246   001422 756000 52                 STQ     MOD_TYPE

      294     2215
      295     2216    2    END INIT_ASSEMBLY_INST;

   2216 56 000247   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000250   000001 702211                    TSX2  ! 1,X1

      296     2217
      297     2218         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:103  
      298     2219
      299     2220    1    GET_NEW_RL : PROC(POS,LEN);

   2220 56 000251   200246 741300       GET_NEW_RL   STX1  ! MESS+1,,AUTO

      300     2221         /*I*
      301     2222              NAME: GET_NEW_RL
      302     2223              PURPOSE:
      303     2224                   Get a new record for a REF_LIST entry.
      304     2225              CALL:
      305     2226                   CALL GET_NEW_RL(POS,LEN);
      306     2227              PARAMETERS:
      307     2228                   POS
      308     2229                     Returns a pointer to the new entry.
      309     2230                   LEN
      310     2231                     An input parameter giving the length in words of the new record.
      311     2232                     It had better be less than or equal to a REF_LIST entry.
      312     2233              DATA:
      313     2234                   Free space list for REF_LIST entries.
      314     2235              DESCRIPTION:
      315     2236                   Check the free space list, if its empty call GETNEW.
      316     2237                   The free space list for REF_LIST entries is added to in
      317     2238                   Z8PA$OUTPUT_JMP_DEST.
      318     2239         */
      319     2240    2        DCL POS PTR;
      320     2241    2        DCL LEN UBIN;
      321     2242
      322     2243    2        IF TOP_FREE_RL ~= ADDR(NIL) THEN

   2243 56 000252   001535 236000 52                 LDQ     TOP_FREE_RL
        56 000253   000004 116000 57                 CMPQ    4
        56 000254   000263 600000 56                 TZE     s:2249

      323     2244    3          DO;

      324     2245    3            POS = TOP_FREE_RL;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:104  
   2245 56 000255   200247 470500                    LDP0    @POS,,AUTO
        56 000256   000000 756100                    STQ     0,,PR0

      325     2246    3            TOP_FREE_RL = TOP_FREE_RL->REF_LIST.NEXT;

   2246 56 000257   001535 471400 52                 LDP1    TOP_FREE_RL
        56 000260   100001 236100                    LDQ     1,,PR1
        56 000261   001535 756000 52                 STQ     TOP_FREE_RL

      326     2247    3          END;

   2247 56 000262   000267 710000 56                 TRA     s:2251

      327     2248    2        ELSE
      328     2249    2          CALL GETNEW(POS,LEN);

   2249 56 000263   200247 630500                    EPPR0   @POS,,AUTO
        56 000264   000000 631400 57                 EPPR1   0
        56 000265   000000 701000 xent               TSX1    GETNEW
        56 000266   000000 011000                    NOP     0

      329     2250
      330     2251    2    END GET_NEW_RL;

   2251 56 000267   200246 221300                    LDX1  ! MESS+1,,AUTO
        56 000270   000001 702211                    TSX2  ! 1,X1

      331     2252         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:105  
      332     2253
      333     2254    1    PUT_LABEL_DEF : PROC(POS,TYPE);

   2254 56 000271   200240 741300       PUT_LABEL_D* STX1  ! SHIFT_FACTOR+2,,AUTO

      334     2255         /*I*
      335     2256              NAME: PUT_LABEL_DEF
      336     2257              PURPOSE:
      337     2258                   Put the label's value (definition point) into a LABEL_TABLE.
      338     2259              CALL:
      339     2260                   CALL PUT_LABEL_DEF(LABEL,POS,TYPE);
      340     2261              PARAMETERS:
      341     2262                   POS
      342     2263                     Passes in the actual position in the LABEL_TABLE of the
      343     2264                     label.
      344     2265                   TYPE
      345     2266                     The type of label being defined.  Currently types are ** for
      346     2267                     label defined by a StART directive.
      347     2268              DATA:
      348     2269                   LABEL_TABLE
      349     2270              DESCRIPTION:
      350     2271                   Set the location field of the label entry to CURRENT_OT_POS.
      351     2272         */
      352     2273    2        DCL POS PTR;
      353     2274    2        DCL TYPE CHAR(5);
      354     2275    2        DCL MESS CHAR(%MESS_LEN);
      355     2276    2        DCL OCTNUM CHAR (6);
      356     2277
      357     2278    2        IF POS->LABEL_TABLE.LOCATION ~= -1 THEN

   2278 56 000272   200241 470500                    LDP0    @POS,,AUTO
        56 000273   000000 471500                    LDP1    0,,PR0
        56 000274   100010 235100                    LDA     8,,PR1
        56 000275   000005 115000 57                 CMPA    5
        56 000276   000324 600000 56                 TZE     s:2286

      358     2279    3          DO;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:106  

      359     2280    3            CALL DEC_TO_OCT_SUP(OCTNUM,POS->LABEL_TABLE.LOCATION);

   2280 56 000277   100010 633500                    EPPR3   8,,PR1
        56 000300   200277 453500                    STP3    CNT2+3,,AUTO
        56 000301   200262 631500                    EPPR1   OCTNUM,,AUTO
        56 000302   200276 451500                    STP1    CNT2+2,,AUTO
        56 000303   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000304   000000 631400 57                 EPPR1   0
        56 000305   000000 701000 xent               TSX1    DEC_TO_OCT_SUP
        56 000306   000000 011000                    NOP     0

      360     2281    3            CALL CONCAT(MESS,%MESS10,OCTNUM);

   2281 56 000307   040100 100400                    MLR     fill='040'O
        56 000310   000040 000040 55                 ADSC9   32                       cn=0,n=32
        56 000311   200243 000040                    ADSC9   MESS,,AUTO               cn=0,n=32
        56 000312   040100 100500                    MLR     fill='040'O
        56 000313   200262 000006                    ADSC9   OCTNUM,,AUTO             cn=0,n=6
        56 000314   200253 000034                    ADSC9   M_FIELD+1,,AUTO          cn=0,n=28

      361     2282    3            CALL Z8PA$ERROR_PROC(MESS);

   2282 56 000315   200243 630500                    EPPR0   MESS,,AUTO
        56 000316   200276 450500                    STP0    CNT2+2,,AUTO
        56 000317   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000320   000006 631400 57                 EPPR1   6
        56 000321   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 000322   000000 011000                    NOP     0

      362     2283    3          END;

   2283 56 000323   000342 710000 56                 TRA     s:2293

      363     2284    2        ELSE
      364     2285    3          DO;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:107  
      365     2286    3            POS->LABEL_TABLE.LOCATION = CURRENT_OT_POS;

   2286 56 000324   000000 236000 53                 LDQ     CURRENT_OT_POS
        56 000325   100010 756100                    STQ     8,,PR1

      366     2287
      367     2288    3            IF TYPE = 'START' THEN

   2288 56 000326   200242 471500                    LDP1    @TYPE,,AUTO
        56 000327   040000 106500                    CMPC    fill='040'O
        56 000330   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5
        56 000331   000050 000005 55                 ADSC9   40                       cn=0,n=5
        56 000332   000337 601000 56                 TNZ     s:2290

      368     2289    3              POS->LABEL_TABLE.TYPE = '**';

   2289 56 000333   000000 473500                    LDP3    0,,PR0
        56 000334   000052 220000 55                 LDX0    42
        56 000335   300013 740100                    STX0    11,,PR3
        56 000336   000342 710000 56                 TRA     s:2293

      369     2290    3            ELSE POS->LABEL_TABLE.TYPE = '  ';

   2290 56 000337   000000 473500                    LDP3    0,,PR0
        56 000340   000027 220000 55                 LDX0    23
        56 000341   300013 740100                    STX0    11,,PR3

      370     2291    3          END;

      371     2292
      372     2293    2    END PUT_LABEL_DEF;

   2293 56 000342   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000343   000001 702211                    TSX2  ! 1,X1

      373     2294         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:108  
      374     2295
      375     2296    1    REFERENCE_LABEL_TABLE : PROC (LABEL,POS);

   2296 56 000344   200240 741300       REFERENCE_L* STX1  ! SHIFT_FACTOR+2,,AUTO

      376     2297         /*I*
      377     2298              NAME: REFERENCE_LABEL_TABLE
      378     2299              PURPOSE:
      379     2300                   Record a label reference in REF_LIST for use in cross reference
      380     2301                   generation.
      381     2302              CALL:
      382     2303                   CALL REFERENCE_LABEL_TABLE(LABEL);
      383     2304              PARAMETERS:
      384     2305                   LABEL
      385     2306                     The label that is being referenced.
      386     2307                   POS
      387     2308                     The position in LABEL_TABLE of the referenced label. An
      388     2309                     output parameter.
      389     2310              DATA:
      390     2311                   REF_LIST
      391     2312              DESCRIPTION:
      392     2313                   Add the label to the label table (call ADD_TO_LT) then
      393     2314                   add the reference to the label's reference list(call ADD_TO_RL).
      394     2315         */
      395     2316
      396     2317    2        DCL LABEL CHAR (%LABEL_LENGTH);
      397     2318    2        DCL POS PTR;                /* WILL POINT TO A POSITION IN THE LABEL_TABLE */
      398     2319
      399     2320    2           LOCAL_FLAG = %FALSE;

   2320 56 000345   001415 450000 52                 STZ     LOCAL_FLAG

      400     2321    2           CALL ADD_TO_LT(LABEL,POS,TOP_LABEL_TABLE);

   2321 56 000346   000007 236000 57                 LDQ     7
        56 000347   200242 235100                    LDA     @POS,,AUTO
        56 000350   200246 757100                    STAQ    MESS+1,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:109  
        56 000351   200241 236100                    LDQ     @LABEL,,AUTO
        56 000352   200245 756100                    STQ     @OPTIONAL_FIELDS+1,,AUTO
        56 000353   000465 701000 56                 TSX1    ADD_TO_LT
        56 000354   000000 011000                    NOP     0

      401     2322
      402     2323    2           CALL ADD_TO_RL(POS);

   2323 56 000355   200242 236100                    LDQ     @POS,,AUTO
        56 000356   200245 756100                    STQ     @OPTIONAL_FIELDS+1,,AUTO
        56 000357   000363 701000 56                 TSX1    ADD_TO_RL
        56 000360   000000 011000                    NOP     0

      403     2324
      404     2325    2    END REFERENCE_LABEL_TABLE;

   2325 56 000361   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000362   000001 702211                    TSX2  ! 1,X1

      405     2326
      406     2327         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:110  
      407     2328    1    ADD_TO_RL : PROC(POS);

   2328 56 000363   200244 741300       ADD_TO_RL    STX1  ! CNT+1,,AUTO

      408     2329         /*I*
      409     2330              NAME: ADD_TO_RL
      410     2331              PURPOSE:
      411     2332                   Add a reference to to the REF_LIST.
      412     2333              CALL:
      413     2334                   CALL ADD_TO_RL(POS);
      414     2335              PARAMETERS:
      415     2336                   POS
      416     2337                     Position in the LABEL_TABLE that the referenced label occupies.
      417     2338                   CURRENT_POS
      418     2339                     Returns position in reference list of added reference.
      419     2340              DATA:
      420     2341                   REF_LIST
      421     2342                   LABEL_TABLE
      422     2343              DESCRIPTION:
      423     2344                   Given the label's position in the label table update the linked
      424     2345                   list of references to include the CURRENT_OT_POS.
      425     2346         */
      426     2347
      427     2348    2        DCL POS PTR;
      428     2349
      429     2350    2        CALL GET_NEW_RL(REF_POS,SIZEW(REF_LIST));

   2350 56 000364   000011 236000 57                 LDQ     9
        56 000365   200250 756100                    STQ     @LEN,,AUTO
        56 000366   000012 236000 57                 LDQ     10
        56 000367   200247 756100                    STQ     @POS,,AUTO
        56 000370   000251 701000 56                 TSX1    GET_NEW_RL
        56 000371   000000 011000                    NOP     0

      430     2351
      431     2352    2        REF_POS->REF_LIST.DEST = 'EMPTY';

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:111  
   2352 56 000372   001524 470400 52                 LDP0    REF_POS
        56 000373   040100 100400                    MLR     fill='040'O
        56 000374   000053 000005 55                 ADSC9   43                       cn=0,n=5
        56 000375   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

      432     2353    2        REF_POS->REF_LIST.NEXT = ADDR(NIL);

   2353 56 000376   000004 236000 57                 LDQ     4
        56 000377   001524 470400 52                 LDP0    REF_POS
        56 000400   000001 756100                    STQ     1,,PR0

      433     2354
      434     2355    2        IF POS->LABEL_TABLE.FIRST_REF = ADDR(NIL) THEN

   2355 56 000401   200245 470500                    LDP0    @POS,,AUTO
        56 000402   000000 471500                    LDP1    0,,PR0
        56 000403   100011 236100                    LDQ     9,,PR1
        56 000404   000004 116000 57                 CMPQ    4
        56 000405   000417 601000 56                 TNZ     s:2363

      435     2356    3          DO;

      436     2357    3            POS->LABEL_TABLE.FIRST_REF = REF_POS;

   2357 56 000406   001524 236000 52                 LDQ     REF_POS
        56 000407   100011 756100                    STQ     9,,PR1

      437     2358    3            POS->LABEL_TABLE.LAST_REF = REF_POS;

   2358 56 000410   000000 471500                    LDP1    0,,PR0
        56 000411   001524 236000 52                 LDQ     REF_POS
        56 000412   100012 756100                    STQ     10,,PR1

      438     2359    3            REF_POS->REF_LIST.REF = CURRENT_OT_POS;

   2359 56 000413   001524 471400 52                 LDP1    REF_POS
        56 000414   000000 235000 53                 LDA     CURRENT_OT_POS
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:112  
        56 000415   100000 755100                    STA     0,,PR1

      439     2360    3          END;

   2360 56 000416   000430 710000 56                 TRA     s:2368

      440     2361    2        ELSE
      441     2362    3          DO;

      442     2363    3            POS->LABEL_TABLE.LAST_REF->REF_LIST.NEXT = REF_POS;

   2363 56 000417   100012 473500                    LDP3    10,,PR1
        56 000420   001524 236000 52                 LDQ     REF_POS
        56 000421   300001 756100                    STQ     1,,PR3

      443     2364    3            REF_POS->REF_LIST.REF = CURRENT_OT_POS;

   2364 56 000422   001524 471400 52                 LDP1    REF_POS
        56 000423   000000 235000 53                 LDA     CURRENT_OT_POS
        56 000424   100000 755100                    STA     0,,PR1

      444     2365    3            POS->LABEL_TABLE.LAST_REF = REF_POS;

   2365 56 000425   000000 471500                    LDP1    0,,PR0
        56 000426   001524 236000 52                 LDQ     REF_POS
        56 000427   100012 756100                    STQ     10,,PR1

      445     2366    3          END;

      446     2367
      447     2368    2    END ADD_TO_RL;

   2368 56 000430   200244 221300                    LDX1  ! CNT+1,,AUTO
        56 000431   000001 702211                    TSX2  ! 1,X1

      448     2369         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:113  
      449     2370    1    SEARCH_LT : PROC(LABEL,POS,TABLE);

   2370 56 000432   200240 741300       SEARCH_LT    STX1  ! SHIFT_FACTOR+2,,AUTO

      450     2371         /*I*
      451     2372              NAME: SEARCH_LT
      452     2373              PURPOSE:
      453     2374                   Search the label table for the label given.
      454     2375              CALL:
      455     2376                   CALL SEARCH_LT(LABEL,POS);
      456     2377              PARAMETERS:
      457     2378                   LABEL
      458     2379                     The label to be searched for.
      459     2380                   POS
      460     2381                     The position of the label in the label table.  If the label is
      461     2382                     not found then this will be returned as -1.
      462     2383                   TABLE
      463     2384                     Points to the table to be searched.
      464     2385              DATA:
      465     2386                   LABEL_TABLE
      466     2387              DESCRIPTION:
      467     2388                   Walk through the label table to see if the given
      468     2389                   label is in there.  If not return addr(nil).
      469     2390         */
      470     2391    2        DCL POS PTR;
      471     2392    2        DCL TABLE PTR;
      472     2393    2        DCL LABEL CHAR(%LABEL_LENGTH);
      473     2394
      474     2395    2        POS = TABLE;

   2395 56 000433   200243 470500                    LDP0    @TABLE,,AUTO
        56 000434   000000 236100                    LDQ     0,,PR0
        56 000435   200242 471500                    LDP1    @POS,,AUTO
        56 000436   100000 756100                    STQ     0,,PR1

      475     2396
      476     2397    3        DO WHILE(POS ~= ADDR(NIL));
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:114  

   2397 56 000437   000457 710000 56                 TRA     s:2404

      477     2398    3          IF POS->LABEL_TABLE.NAME = LABEL THEN

   2398 56 000440   200242 470500                    LDP0    @POS,,AUTO
        56 000441   000000 471500                    LDP1    0,,PR0
        56 000442   200241 473500                    LDP3    @LABEL,,AUTO
        56 000443   040100 106500                    CMPC    fill='040'O
        56 000444   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        56 000445   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        56 000446   000451 601000 56                 TNZ     s:2401

      478     2399    3            RETURN;

   2399 56 000447   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000450   000001 702211                    TSX2  ! 1,X1

      479     2400    3          ELSE
      480     2401    3            IF POS->LABEL_TABLE.NAME < LABEL THEN

   2401 56 000451   000455 603000 56                 TRC     s:2403

      481     2402    3              POS = POS->LABEL_TABLE.RLINK;

   2402 56 000452   100014 236100                    LDQ     12,,PR1
        56 000453   000000 756100                    STQ     0,,PR0
        56 000454   000457 710000 56                 TRA     s:2404

      482     2403    3            ELSE POS = POS->LABEL_TABLE.LLINK;

   2403 56 000455   100015 236100                    LDQ     13,,PR1
        56 000456   000000 756100                    STQ     0,,PR0

      483     2404    3        END;

   2404 56 000457   200242 470500                    LDP0    @POS,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:115  
        56 000460   000000 236100                    LDQ     0,,PR0
        56 000461   000004 116000 57                 CMPQ    4
        56 000462   000440 601000 56                 TNZ     s:2398

      484     2405
      485     2406    2    END SEARCH_LT;

   2406 56 000463   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000464   000001 702211                    TSX2  ! 1,X1

      486     2407         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:116  
      487     2408
      488     2409    1    ADD_TO_LT : PROC(LABEL,POS,TABLE);

   2409 56 000465   200244 741300       ADD_TO_LT    STX1  ! CNT+1,,AUTO

      489     2410         /*I*
      490     2411              NAME: ADD_TO_LT
      491     2412              PURPOSE:
      492     2413                   Add a label to the LABEL_TABLE.
      493     2414              CALL:
      494     2415                   CALL ADD_TO_LT(LABEL,POS);
      495     2416              PARAMETERS:
      496     2417                   LABEL
      497     2418                     The label to be added to the table.
      498     2419                   POS
      499     2420                     The position in the table where the lable was placed or was found.
      500     2421                   TABLE
      501     2422                     Points to the table to be added to.
      502     2423              DATA:
      503     2424                   LABEL_TABLE 
      504     2425              DESCRIPTION:
      505     2426                   Search the label table.  If the label is not found then add it to
      506     2427                   the table.   Position of the label is returned in POS.
      507     2428         */
      508     2429    2        DCL LABEL CHAR(%LABEL_LENGTH);
      509     2430    2        DCL POS PTR;
      510     2431    2        DCL TABLE PTR;
      511     2432    2        DCL SUB_POS PTR;
      512     2433    2        DCL LLEFT BIT(1);
      513     2434
      514     2435    2        POS = TABLE;

   2435 56 000466   200247 470500                    LDP0    @TABLE,,AUTO
        56 000467   000000 236100                    LDQ     0,,PR0
        56 000470   200246 471500                    LDP1    @POS,,AUTO
        56 000471   100000 756100                    STQ     0,,PR1

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:117  
      515     2436
      516     2437    2        IF POS = ADDR(NIL) THEN

   2437 56 000472   000004 116000 57                 CMPQ    4
        56 000473   000510 601000 56                 TNZ     s:2446

      517     2438    3          DO;

      518     2439    3            CALL GETNEW(POS,SIZEW(LABEL_TABLE));

   2439 56 000474   000014 236000 57                 LDQ     12
        56 000475   200246 235100                    LDA     @POS,,AUTO
        56 000476   200276 757100                    STAQ    CNT2+2,,AUTO
        56 000477   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000500   000000 631400 57                 EPPR1   0
        56 000501   000000 701000 xent               TSX1    GETNEW
        56 000502   000000 011000                    NOP     0

      519     2440    3            TABLE = POS;

   2440 56 000503   200246 470500                    LDP0    @POS,,AUTO
        56 000504   000000 236100                    LDQ     0,,PR0
        56 000505   200247 471500                    LDP1    @TABLE,,AUTO
        56 000506   100000 756100                    STQ     0,,PR1

      520     2441    3          END;

   2441 56 000507   000561 710000 56                 TRA     s:2470

      521     2442    2        ELSE
      522     2443    3          DO;

      523     2444
      524     2445    4            DO UNTIL(POS = ADDR(NIL));

      525     2446    4              SUB_POS = POS;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:118  
   2446 56 000510   200246 470500                    LDP0    @POS,,AUTO
        56 000511   000000 236100                    LDQ     0,,PR0
        56 000512   200250 756100                    STQ     SUB_POS,,AUTO

      526     2447    4              IF POS->LABEL_TABLE.NAME = LABEL THEN

   2447 56 000513   000000 471500                    LDP1    0,,PR0
        56 000514   200245 473500                    LDP3    @LABEL,,AUTO
        56 000515   040100 106500                    CMPC    fill='040'O
        56 000516   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        56 000517   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        56 000520   000523 601000 56                 TNZ     s:2450

      527     2448    4                RETURN;

   2448 56 000521   200244 221300                    LDX1  ! CNT+1,,AUTO
        56 000522   000001 702211                    TSX2  ! 1,X1

      528     2449    4              ELSE
      529     2450    4                IF POS->LABEL_TABLE.NAME < LABEL THEN

   2450 56 000523   000530 603000 56                 TRC     s:2457

      530     2451    5                  DO;

      531     2452    5                    POS = POS->LABEL_TABLE.RLINK;

   2452 56 000524   100014 236100                    LDQ     12,,PR1
        56 000525   000000 756100                    STQ     0,,PR0

      532     2453    5                    LLEFT = %FALSE;

   2453 56 000526   200251 450100                    STZ     LLEFT,,AUTO

      533     2454    5                  END;

   2454 56 000527   000534 710000 56                 TRA     s:2460
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:119  

      534     2455    4                ELSE
      535     2456    5                  DO;

      536     2457    5                    POS = POS->LABEL_TABLE.LLINK;

   2457 56 000530   100015 236100                    LDQ     13,,PR1
        56 000531   000000 756100                    STQ     0,,PR0

      537     2458    5                    LLEFT = %TRUE;

   2458 56 000532   400000 236003                    LDQ     -131072,DU
        56 000533   200251 756100                    STQ     LLEFT,,AUTO

      538     2459    5                  END;

      539     2460    4            END;

   2460 56 000534   000000 236100                    LDQ     0,,PR0
        56 000535   000004 116000 57                 CMPQ    4
        56 000536   000510 601000 56                 TNZ     s:2446

      540     2461
      541     2462    3            CALL GETNEW(POS,SIZEW(LABEL_TABLE));

   2462 56 000537   000014 236000 57                 LDQ     12
        56 000540   200246 235100                    LDA     @POS,,AUTO
        56 000541   200276 757100                    STAQ    CNT2+2,,AUTO
        56 000542   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000543   000000 631400 57                 EPPR1   0
        56 000544   000000 701000 xent               TSX1    GETNEW
        56 000545   000000 011000                    NOP     0

      542     2463
      543     2464    3            IF LLEFT THEN

   2464 56 000546   200251 234100                    SZN     LLEFT,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:120  
        56 000547   000555 605000 56                 TPL     s:2467

      544     2465    3              SUB_POS->LABEL_TABLE.LLINK = POS;

   2465 56 000550   200246 470500                    LDP0    @POS,,AUTO
        56 000551   000000 236100                    LDQ     0,,PR0
        56 000552   200250 471500                    LDP1    SUB_POS,,AUTO
        56 000553   100015 756100                    STQ     13,,PR1
        56 000554   000561 710000 56                 TRA     s:2470

      545     2466    3            ELSE
      546     2467    3              SUB_POS->LABEL_TABLE.RLINK = POS;

   2467 56 000555   200246 470500                    LDP0    @POS,,AUTO
        56 000556   000000 236100                    LDQ     0,,PR0
        56 000557   200250 471500                    LDP1    SUB_POS,,AUTO
        56 000560   100014 756100                    STQ     12,,PR1

      547     2468    3          END;

      548     2469
      549     2470    2        POS->LABEL_TABLE.LOCATION = -1;

   2470 56 000561   000000 471500                    LDP1    0,,PR0
        56 000562   000001 335007                    LCA     1,DL
        56 000563   100010 755100                    STA     8,,PR1

      550     2471    2        POS->LABEL_TABLE.FIRST_REF = ADDR(NIL);

   2471 56 000564   000000 471500                    LDP1    0,,PR0
        56 000565   000004 236000 57                 LDQ     4
        56 000566   100011 756100                    STQ     9,,PR1

      551     2472    2        POS->LABEL_TABLE.LAST_REF = ADDR(NIL);

   2472 56 000567   000000 471500                    LDP1    0,,PR0
        56 000570   100012 756100                    STQ     10,,PR1
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:121  

      552     2473    2        POS->LABEL_TABLE.TYPE = 'UD';

   2473 56 000571   000000 471500                    LDP1    0,,PR0
        56 000572   000055 220000 55                 LDX0    45
        56 000573   100013 740100                    STX0    11,,PR1

      553     2474    2        POS->LABEL_TABLE.LLINK = ADDR(NIL);

   2474 56 000574   000000 471500                    LDP1    0,,PR0
        56 000575   100015 756100                    STQ     13,,PR1

      554     2475    2        POS->LABEL_TABLE.RLINK = ADDR(NIL);

   2475 56 000576   000000 471500                    LDP1    0,,PR0
        56 000577   100014 756100                    STQ     12,,PR1

      555     2476    2        POS->LABEL_TABLE.NAME = LABEL;

   2476 56 000600   000000 471500                    LDP1    0,,PR0
        56 000601   200245 473500                    LDP3    @LABEL,,AUTO
        56 000602   040100 100500                    MLR     fill='040'O
        56 000603   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        56 000604   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30

      556     2477
      557     2478    2    END ADD_TO_LT;

   2478 56 000605   200244 221300                    LDX1  ! CNT+1,,AUTO
        56 000606   000001 702211                    TSX2  ! 1,X1

      558     2479         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:122  
      559     2480
      560     2481    1    REFERENCE_LOCAL_LABEL_TABLE : PROC (LABEL,POS);

   2481 56 000607   200240 741300       REFERENCE_L* STX1  ! SHIFT_FACTOR+2,,AUTO

      561     2482         /*I*
      562     2483              NAME: REFERENCE_LOCAL_LABEL_TABLE
      563     2484              PURPOSE:
      564     2485                   Record a label reference in LOCAL_REF_LIST for use in cross reference
      565     2486                   generation.
      566     2487              CALL:
      567     2488                   CALL REFERENCE_LOCAL_LABEL_TABLE(LABEL);
      568     2489              PARAMETERS:
      569     2490                   LABEL
      570     2491                     The label that is being referenced.
      571     2492                   POS
      572     2493                     The position in LOCAL_LABEL_TABLE of the referenced label. An
      573     2494                     output parameter.
      574     2495              DATA:
      575     2496                   LOCAL_REF_LIST
      576     2497              DESCRIPTION:
      577     2498                    Search the LOCAL_LABEL_TABLE for the label. If it is not in label table
      578     2499                   then add it to the table.  Update the labels reference now that we
      579     2500                   know its in the label table.  ADD_TO_LT does the
      580     2501                   searching for us.
      581     2502         */
      582     2503
      583     2504    2        DCL LABEL CHAR (%LABEL_LENGTH);
      584     2505    2        DCL POS PTR;
      585     2506
      586     2507    2        LOCAL_FLAG = %TRUE;

   2507 56 000610   400000 236003                    LDQ     -131072,DU
        56 000611   001415 756000 52                 STQ     LOCAL_FLAG

      587     2508
      588     2509
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:123  
      589     2510    2        CALL ADD_TO_LT(LABEL,POS,TOP_LOCAL_LABEL_TABLE);

   2510 56 000612   000015 236000 57                 LDQ     13
        56 000613   200242 235100                    LDA     @POS,,AUTO
        56 000614   200246 757100                    STAQ    @POS,,AUTO
        56 000615   200241 236100                    LDQ     @LABEL,,AUTO
        56 000616   200245 756100                    STQ     @LABEL,,AUTO
        56 000617   000465 701000 56                 TSX1    ADD_TO_LT
        56 000620   000000 011000                    NOP     0

      590     2511
      591     2512    2        CALL ADD_TO_RL(POS);

   2512 56 000621   200242 236100                    LDQ     @POS,,AUTO
        56 000622   200245 756100                    STQ     @LABEL,,AUTO
        56 000623   000363 701000 56                 TSX1    ADD_TO_RL
        56 000624   000000 011000                    NOP     0

      592     2513
      593     2514    2    END REFERENCE_LOCAL_LABEL_TABLE;

   2514 56 000625   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000626   000001 702211                    TSX2  ! 1,X1

      594     2515
      595     2516         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:124  
      596     2517    1    PUT_LABEL_PEPD : PROC(POS_IN_LT);

   2517 56 000627   200240 741300       PUT_LABEL_P* STX1  ! SHIFT_FACTOR+2,,AUTO

      597     2518         /*I*
      598     2519              NAME: PUT_LABEL_PEPD
      599     2520              PURPOSE:
      600     2521                   Create an entry in the PEPD because a start directive was
      601     2522                   encountered.
      602     2523              CALL:
      603     2524                   CALL PUT_LABEL_PEPD(POS_IN_LT);
      604     2525              PARAMETERS:
      605     2526                   POS_IN_LT
      606     2527                     Position of label in the LABEL_TABLE.
      607     2528              DATA:
      608     2529                   PEPD
      609     2530              DESCRIPTION:
      610     2531                   Create an entry in the PEPD table.  The entry will point into
      611     2532                   the label table at the position specified by POS_IN_LT.
      612     2533                   This procedure is called when START directive is encountered.
      613     2534         */
      614     2535    2        DCL POS_IN_LT PTR;
      615     2536    2        DCL POS PTR;
      616     2537
      617     2538    2        CALL GETNEW(POS,SIZEW(PEPD));

   2538 56 000630   000017 236000 57                 LDQ     15
        56 000631   200277 756100                    STQ     CNT2+3,,AUTO
        56 000632   200242 630500                    EPPR0   POS,,AUTO
        56 000633   200276 450500                    STP0    CNT2+2,,AUTO
        56 000634   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000635   000000 631400 57                 EPPR1   0
        56 000636   000000 701000 xent               TSX1    GETNEW
        56 000637   000000 011000                    NOP     0

      618     2539
      619     2540    2        IF TOP_PEPD ~= ADDR(NIL) THEN
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:125  

   2540 56 000640   001530 236000 52                 LDQ     TOP_PEPD
        56 000641   000004 116000 57                 CMPQ    4
        56 000642   000647 600000 56                 TZE     s:2543

      620     2541    2          PEPD.NEXT = POS;

   2541 56 000643   200242 236100                    LDQ     POS,,AUTO
        56 000644   001525 470400 52                 LDP0    CURRENT_PEPD_POS
        56 000645   000001 756100                    STQ     1,,PR0
        56 000646   000651 710000 56                 TRA     s:2545

      621     2542    2        ELSE
      622     2543    2          TOP_PEPD = POS;

   2543 56 000647   200242 236100                    LDQ     POS,,AUTO
        56 000650   001530 756000 52                 STQ     TOP_PEPD

      623     2544
      624     2545    2        CURRENT_PEPD_POS = POS;

   2545 56 000651   200242 236100                    LDQ     POS,,AUTO
        56 000652   001525 756000 52                 STQ     CURRENT_PEPD_POS

      625     2546    2        PEPD.POS = POS_IN_LT;

   2546 56 000653   200241 470500                    LDP0    @POS_IN_LT,,AUTO
        56 000654   000000 236100                    LDQ     0,,PR0
        56 000655   001525 471400 52                 LDP1    CURRENT_PEPD_POS
        56 000656   100000 756100                    STQ     0,,PR1

      626     2547    2        PEPD.NEXT = ADDR(NIL);

   2547 56 000657   000004 236000 57                 LDQ     4
        56 000660   100001 756100                    STQ     1,,PR1

      627     2548
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:126  
      628     2549    2    END PUT_LABEL_PEPD;

   2549 56 000661   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000662   000001 702211                    TSX2  ! 1,X1

      629     2550
      630     2551         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:127  
      631     2552    1    PUT_LABEL_DEP : PROC(POS_IN_LT);

   2552 56 000663   200240 741300       PUT_LABEL_D* STX1  ! SHIFT_FACTOR+2,,AUTO

      632     2553         /*I*
      633     2554              NAME: PUT_LABEL_DEP
      634     2555              PURPOSE:
      635     2556                   Enter a label's position in the lable table into the DEP table.
      636     2557              CALL:
      637     2558                   CALL PUT_LABEL_DEP(POS_IN_LT);
      638     2559              PARAMETERS:
      639     2560                   POS_IN_LT
      640     2561                     An input parameter giving the label's position in
      641     2562                     the label table.
      642     2563              DATA:
      643     2564                   DEP
      644     2565              DESCRIPTION:
      645     2566                   Create an entry in the DEP table which points into the label
      646     2567                   table at the position specified by POS_IN_LT.
      647     2568         */
      648     2569    2        DCL POS_IN_LT PTR;
      649     2570    2        DCL POS PTR;
      650     2571
      651     2572    2        CALL GETNEW(POS,SIZEW(DEP));

   2572 56 000664   000017 236000 57                 LDQ     15
        56 000665   200277 756100                    STQ     CNT2+3,,AUTO
        56 000666   200242 630500                    EPPR0   POS,,AUTO
        56 000667   200276 450500                    STP0    CNT2+2,,AUTO
        56 000670   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000671   000000 631400 57                 EPPR1   0
        56 000672   000000 701000 xent               TSX1    GETNEW
        56 000673   000000 011000                    NOP     0

      652     2573
      653     2574    2        IF TOP_DEP ~= ADDR(NIL) THEN

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:128  
   2574 56 000674   001531 236000 52                 LDQ     TOP_DEP
        56 000675   000004 116000 57                 CMPQ    4
        56 000676   000703 600000 56                 TZE     s:2577

      654     2575    2          DEP.NEXT = POS;

   2575 56 000677   200242 236100                    LDQ     POS,,AUTO
        56 000700   001526 470400 52                 LDP0    CURRENT_DEP_POS
        56 000701   000001 756100                    STQ     1,,PR0
        56 000702   000705 710000 56                 TRA     s:2579

      655     2576    2        ELSE
      656     2577    2          TOP_DEP = POS;

   2577 56 000703   200242 236100                    LDQ     POS,,AUTO
        56 000704   001531 756000 52                 STQ     TOP_DEP

      657     2578
      658     2579    2        CURRENT_DEP_POS = POS;

   2579 56 000705   200242 236100                    LDQ     POS,,AUTO
        56 000706   001526 756000 52                 STQ     CURRENT_DEP_POS

      659     2580    2        DEP.LT_POS = POS_IN_LT;

   2580 56 000707   200241 470500                    LDP0    @POS_IN_LT,,AUTO
        56 000710   000000 236100                    LDQ     0,,PR0
        56 000711   001526 471400 52                 LDP1    CURRENT_DEP_POS
        56 000712   100000 756100                    STQ     0,,PR1

      660     2581    2        DEP.NEXT = ADDR(NIL);

   2581 56 000713   000004 236000 57                 LDQ     4
        56 000714   100001 756100                    STQ     1,,PR1

      661     2582
      662     2583    2    END PUT_LABEL_DEP;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:129  

   2583 56 000715   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000716   000001 702211                    TSX2  ! 1,X1

      663     2584         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:130  
      664     2585    1    PUT_BURST_DEST : PROC(DEST);

   2585 56 000717   200240 741300       PUT_BURST_D* STX1  ! SHIFT_FACTOR+2,,AUTO

      665     2586         /*I*
      666     2587              NAME: PUT_BURST_DEST
      667     2588              PURPOSE:
      668     2589                   Put the destination of a BURST directive into the BURST_TABLE.
      669     2590              CALL:
      670     2591                   CALL PUT_BURST_DEST(DEST);
      671     2592              PARAMETERS:
      672     2593                   DEST
      673     2594                     The created label (minus the preceeding 'D') given to the
      674     2595                     BURST operand.
      675     2596              DATA:
      676     2597                   BURST_TABLE,LABEL_POS
      677     2598              DESCRIPTION:
      678     2599                   Put the created label and the position in the label_table of the
      679     2600                   operand of a BURST directive into BURST_TABLE.  The position
      680     2601                   of the label in LABEL_TABLE is obtained form the global variable
      681     2602                   LABEL_POS because the label was the last one referenced.
      682     2603         */
      683     2604    2        DCL DEST CHAR(8);
      684     2605    2        DCL POS PTR;
      685     2606
      686     2607    2        CALL GETNEW(POS,SIZEW(BURST_TABLE));

   2607 56 000720   000011 236000 57                 LDQ     9
        56 000721   200277 756100                    STQ     CNT2+3,,AUTO
        56 000722   200242 630500                    EPPR0   POS,,AUTO
        56 000723   200276 450500                    STP0    CNT2+2,,AUTO
        56 000724   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 000725   000000 631400 57                 EPPR1   0
        56 000726   000000 701000 xent               TSX1    GETNEW
        56 000727   000000 011000                    NOP     0

      687     2608
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:131  
      688     2609    2        IF TOP_BURST_TABLE ~= ADDR(NIL) THEN

   2609 56 000730   001532 236000 52                 LDQ     TOP_BURST_TABLE
        56 000731   000004 116000 57                 CMPQ    4
        56 000732   000737 600000 56                 TZE     s:2612

      689     2610    2          BURST_TABLE.NEXT = POS;

   2610 56 000733   200242 236100                    LDQ     POS,,AUTO
        56 000734   001527 470400 52                 LDP0    CURRENT_BT_POS
        56 000735   000003 756100                    STQ     3,,PR0
        56 000736   000741 710000 56                 TRA     s:2614

      690     2611    2        ELSE
      691     2612    2          TOP_BURST_TABLE = POS;

   2612 56 000737   200242 236100                    LDQ     POS,,AUTO
        56 000740   001532 756000 52                 STQ     TOP_BURST_TABLE

      692     2613
      693     2614    2        CURRENT_BT_POS = POS;

   2614 56 000741   200242 236100                    LDQ     POS,,AUTO
        56 000742   001527 756000 52                 STQ     CURRENT_BT_POS

      694     2615    2        BURST_TABLE.LABEL_POS = LABEL_POS;

   2615 56 000743   001413 236000 52                 LDQ     LABEL_POS
        56 000744   001527 470400 52                 LDP0    CURRENT_BT_POS
        56 000745   000000 756100                    STQ     0,,PR0

      695     2616    2        BURST_TABLE.DEST = DEST;

   2616 56 000746   200241 471500                    LDP1    @DEST,,AUTO
        56 000747   040100 100500                    MLR     fill='040'O
        56 000750   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
        56 000751   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:132  

      696     2617    2        BURST_TABLE.NEXT = ADDR(NIL);

   2617 56 000752   000004 236000 57                 LDQ     4
        56 000753   000003 756100                    STQ     3,,PR0

      697     2618
      698     2619    2    END PUT_BURST_DEST;

   2619 56 000754   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000755   000001 702211                    TSX2  ! 1,X1

      699     2620         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:133  
      700     2621    1    EQU_INT : PROC(VAL,LABEL_POS);

   2621 56 000756   200240 741300       EQU_INT      STX1  ! SHIFT_FACTOR+2,,AUTO

      701     2622         /*I*
      702     2623              NAME: EQU_INT
      703     2624              PURPOSE:
      704     2625                   Set the value of the label at POS to VAL as in an EQU instruction.
      705     2626              CALL:
      706     2627                   CALL EQU_INT(VAL,LABEL_POS);
      707     2628              PARAMETERS:
      708     2629                   LABEL_POS
      709     2630                     Position of the label in LABEL_TABLE.
      710     2631                   VAL
      711     2632                     Integer value of label.
      712     2633              DATA:
      713     2634                   LABEL_TABLE
      714     2635              DESCRIPTION:
      715     2636                   Set the value of LABEL_TABLE.VALUE at LABEL_POS to VAL.
      716     2637         */
      717     2638    2        DCL VAL SBIN;
      718     2639    2        DCL LABEL_POS PTR;
      719     2640
      720     2641    2        LABEL_POS->LABEL_TABLE.LOCATION = VAL;

   2641 56 000757   200242 470500                    LDP0    @LABEL_POS,,AUTO
        56 000760   000000 471500                    LDP1    0,,PR0
        56 000761   200241 473500                    LDP3    @VAL,,AUTO
        56 000762   300000 235100                    LDA     0,,PR3
        56 000763   100010 755100                    STA     8,,PR1

      721     2642
      722     2643    2    END EQU_INT;

   2643 56 000764   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 000765   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:134  
      723     2644
      724     2645         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:135  
      725     2646    1    EQU_LABEL : PROC (SENDING_LABEL,RECIEVING_LABEL);

   2646 56 000766   200240 741300       EQU_LABEL    STX1  ! SHIFT_FACTOR+2,,AUTO

      726     2647         /*I*
      727     2648              NAME: EQU_LABEL
      728     2649              PURPOSE:
      729     2650                   Handle an equate when the sending field is a label.
      730     2651              CALL:
      731     2652                   CALL EQU_LABEL(SENDING_LABEL,RECIEVING_LABEL);
      732     2653              PARAMETERS:
      733     2654                   SENDING_LABEL
      734     2655                     Points to the sending label;
      735     2656                   RECIEVING_LABEL
      736     2657                     Points to the recieving label;
      737     2658              DATA:
      738     2659                   LABEL_TABLE
      739     2660              DESCRIPTION:
      740     2661                   Check to make sure the sending label has a value.
      741     2662                   If it does then assign its value to the recieving label.
      742     2663         */
      743     2664
      744     2665    2        DCL SENDING_LABEL PTR;
      745     2666    2        DCL RECIEVING_LABEL PTR;
      746     2667    2        DCL MESS CHAR(%MESS_LEN);
      747     2668
      748     2669    2        IF SENDING_LABEL->LABEL_TABLE.LOCATION = -1 THEN

   2669 56 000767   200241 470500                    LDP0    @SENDING_LABEL,,AUTO
        56 000770   000000 471500                    LDP1    0,,PR0
        56 000771   100010 235100                    LDA     8,,PR1
        56 000772   000005 115000 57                 CMPA    5
        56 000773   001011 601000 56                 TNZ     s:2675

      749     2670    3          DO;

      750     2671    3            CALL CONCAT(MESS,%MESS4,SENDING_LABEL->LABEL_TABLE.NAME);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:136  

   2671 56 000774   040100 100400                    MLR     fill='040'O
        56 000775   000056 000043 55                 ADSC9   46                       cn=0,n=35
        56 000776   200243 000043                    ADSC9   MESS,,AUTO               cn=0,n=35
        56 000777   040100 100500                    MLR     fill='040'O
        56 001000   100000 000031                    ADSC9   0,,PR1                   cn=0,n=25
        56 001001   200253 600031                    ADSC9   M_FIELD+1,,AUTO          cn=3,n=25

      751     2672    3            CALL Z8PA$ERROR_PROC(MESS);

   2672 56 001002   200243 630500                    EPPR0   MESS,,AUTO
        56 001003   200276 450500                    STP0    CNT2+2,,AUTO
        56 001004   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001005   000006 631400 57                 EPPR1   6
        56 001006   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 001007   000000 011000                    NOP     0

      752     2673    3          END;

   2673 56 001010   001014 710000 56                 TRA     s:2677

      753     2674    2        ELSE
      754     2675    2          RECIEVING_LABEL->LABEL_TABLE.LOCATION = SENDING_LABEL->LABEL_TABLE.LOCATION;

   2675 56 001011   200242 473500                    LDP3    @RECIEVING_LABEL,,AUTO
        56 001012   300000 474500                    LDP4    0,,PR3
        56 001013   400010 755100                    STA     8,,PR4

      755     2676
      756     2677    2    END EQU_LABEL;

   2677 56 001014   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 001015   000001 702211                    TSX2  ! 1,X1

      757     2678
      758     2679         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:137  
      759     2680
      760     2681
      761     2682
      762     2683    1    OUTPUT_PEPD : PROC;

   2683 56 001016   200240 741300       OUTPUT_PEPD  STX1  ! SHIFT_FACTOR+2,,AUTO

      763     2684         /*I*
      764     2685              NAME: OUTPUT_PEPD
      765     2686              PURPOSE:
      766     2687                   Output the PEPD table to the file containing the object table.
      767     2688                   Also output the DEP table to M$OU.
      768     2689              CALL:
      769     2690                   CALL OUTPUT_PEPD;
      770     2691              DATA:
      771     2692                   PEPD
      772     2693              DESCRIPTION:
      773     2694                   This module generates PL6 statements that are output to
      774     2695                   the module containing the object table.  These PL6 statements
      775     2696                   are created from information in the PEPD table and
      776     2697                   must be executed before the pseudocode interpretation in
      777     2698                   the code generator begins. These PL6 statements initialize the PEPD.
      778     2699                   Also output a DEP table using information in the DEP structure.
      779     2700         */
      780     2701    2        DCL CNT PTR;
      781     2702    2        DCL NUM UBIN WORD;
      782     2703    2        DCL CHAR_NUM2 CHAR(%OPERAND_LEN);
      783     2704    2        DCL SEG_NUM_CH CHAR(%OPERAND_LEN);
      784     2705
      785     2706             %SELECT_OU;

   2707 56 001017   000000 235000 xsym               LDA     Z8PS$M$OU#
        56 001020   000000 755000 24                 STA     OUT_DCBN

      786     2709    2        BUFFER = 'DCL 1 PEPD (0:600) EXT,';

   2709 56 001021   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:138  
        56 001022   000067 000027 55                 ADSC9   55                       cn=0,n=23
        56 001023   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

      787     2710             %OUTPUT_STR;

   2715 56 001024   000000 236000 24                 LDQ     OUT_DCBN
        56 001025   001035 604000 56                 TMI     s:2717
        56 001026   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001027   001035 601000 56                 TNZ     s:2717
        56 001030   000000 236000 34                 LDQ     OPTIONS
        56 001031   000002 736000                    QLS     2
        56 001032   400000 376003                    ANQ     -131072,DU
        56 001033   400000 676003                    ERQ     -131072,DU
        56 001034   001047 601000 56                 TNZ     s:2721

   2717 56 001035   000214 236007                    LDQ     140,DL
        56 001036   200050 756100                    STQ     LEN,,AUTO

   2718 56 001037   200050 630500                    EPPR0   LEN,,AUTO
        56 001040   200277 450500                    STP0    CNT2+3,,AUTO
        56 001041   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001042   200276 451500                    STP1    CNT2+2,,AUTO
        56 001043   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001044   000000 631400 57                 EPPR1   0
        56 001045   000000 701000 xent               TSX1    OUTPUT
        56 001046   000000 011000                    NOP     0

      788     2721    2        BUFFER = '    2 POS UBIN(18) UNAL,';

   2721 56 001047   040100 100400                    MLR     fill='040'O
        56 001050   000075 000030 55                 ADSC9   61                       cn=0,n=24
        56 001051   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

      789     2722             %OUTPUT_STR;

   2727 56 001052   000000 236000 24                 LDQ     OUT_DCBN
        56 001053   001063 604000 56                 TMI     s:2729
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:139  
        56 001054   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001055   001063 601000 56                 TNZ     s:2729
        56 001056   000000 236000 34                 LDQ     OPTIONS
        56 001057   000002 736000                    QLS     2
        56 001060   400000 376003                    ANQ     -131072,DU
        56 001061   400000 676003                    ERQ     -131072,DU
        56 001062   001075 601000 56                 TNZ     s:2733

   2729 56 001063   000214 235007                    LDA     140,DL
        56 001064   200050 755100                    STA     LEN,,AUTO

   2730 56 001065   200050 630500                    EPPR0   LEN,,AUTO
        56 001066   200277 450500                    STP0    CNT2+3,,AUTO
        56 001067   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001070   200276 451500                    STP1    CNT2+2,,AUTO
        56 001071   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001072   000000 631400 57                 EPPR1   0
        56 001073   000000 701000 xent               TSX1    OUTPUT
        56 001074   000000 011000                    NOP     0

      790     2733    2        BUFFER = '    2 SEGMENT UBIN(18) UNAL;';

   2733 56 001075   040100 100400                    MLR     fill='040'O
        56 001076   000103 000034 55                 ADSC9   67                       cn=0,n=28
        56 001077   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

      791     2734             %OUTPUT_STR;

   2739 56 001100   000000 236000 24                 LDQ     OUT_DCBN
        56 001101   001111 604000 56                 TMI     s:2741
        56 001102   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001103   001111 601000 56                 TNZ     s:2741
        56 001104   000000 236000 34                 LDQ     OPTIONS
        56 001105   000002 736000                    QLS     2
        56 001106   400000 376003                    ANQ     -131072,DU
        56 001107   400000 676003                    ERQ     -131072,DU
        56 001110   001123 601000 56                 TNZ     s:2745
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:140  

   2741 56 001111   000214 235007                    LDA     140,DL
        56 001112   200050 755100                    STA     LEN,,AUTO

   2742 56 001113   200050 630500                    EPPR0   LEN,,AUTO
        56 001114   200277 450500                    STP0    CNT2+3,,AUTO
        56 001115   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001116   200276 451500                    STP1    CNT2+2,,AUTO
        56 001117   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001120   000000 631400 57                 EPPR1   0
        56 001121   000000 701000 xent               TSX1    OUTPUT
        56 001122   000000 011000                    NOP     0

      792     2745    2        BUFFER = 'DCL 1 DEP (0:47) EXT ,';

   2745 56 001123   040100 100400                    MLR     fill='040'O
        56 001124   000112 000026 55                 ADSC9   74                       cn=0,n=22
        56 001125   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

      793     2746             %OUTPUT_STR;

   2751 56 001126   000000 236000 24                 LDQ     OUT_DCBN
        56 001127   001137 604000 56                 TMI     s:2753
        56 001130   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001131   001137 601000 56                 TNZ     s:2753
        56 001132   000000 236000 34                 LDQ     OPTIONS
        56 001133   000002 736000                    QLS     2
        56 001134   400000 376003                    ANQ     -131072,DU
        56 001135   400000 676003                    ERQ     -131072,DU
        56 001136   001151 601000 56                 TNZ     s:2757

   2753 56 001137   000214 235007                    LDA     140,DL
        56 001140   200050 755100                    STA     LEN,,AUTO

   2754 56 001141   200050 630500                    EPPR0   LEN,,AUTO
        56 001142   200277 450500                    STP0    CNT2+3,,AUTO
        56 001143   200005 631500                    EPPR1   BUFFER,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:141  
        56 001144   200276 451500                    STP1    CNT2+2,,AUTO
        56 001145   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001146   000000 631400 57                 EPPR1   0
        56 001147   000000 701000 xent               TSX1    OUTPUT
        56 001150   000000 011000                    NOP     0

      794     2757    2        BUFFER = '    2 POS UBIN(18) UNAL,';

   2757 56 001151   040100 100400                    MLR     fill='040'O
        56 001152   000075 000030 55                 ADSC9   61                       cn=0,n=24
        56 001153   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

      795     2758             %OUTPUT_STR;

   2763 56 001154   000000 236000 24                 LDQ     OUT_DCBN
        56 001155   001165 604000 56                 TMI     s:2765
        56 001156   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001157   001165 601000 56                 TNZ     s:2765
        56 001160   000000 236000 34                 LDQ     OPTIONS
        56 001161   000002 736000                    QLS     2
        56 001162   400000 376003                    ANQ     -131072,DU
        56 001163   400000 676003                    ERQ     -131072,DU
        56 001164   001177 601000 56                 TNZ     s:2769

   2765 56 001165   000214 235007                    LDA     140,DL
        56 001166   200050 755100                    STA     LEN,,AUTO

   2766 56 001167   200050 630500                    EPPR0   LEN,,AUTO
        56 001170   200277 450500                    STP0    CNT2+3,,AUTO
        56 001171   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001172   200276 451500                    STP1    CNT2+2,,AUTO
        56 001173   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001174   000000 631400 57                 EPPR1   0
        56 001175   000000 701000 xent               TSX1    OUTPUT
        56 001176   000000 011000                    NOP     0

      796     2769    2        BUFFER = '    2 SEGMENT UBIN(18) UNAL;';
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:142  

   2769 56 001177   040100 100400                    MLR     fill='040'O
        56 001200   000103 000034 55                 ADSC9   67                       cn=0,n=28
        56 001201   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

      797     2770             %OUTPUT_STR;

   2775 56 001202   000000 236000 24                 LDQ     OUT_DCBN
        56 001203   001213 604000 56                 TMI     s:2777
        56 001204   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001205   001213 601000 56                 TNZ     s:2777
        56 001206   000000 236000 34                 LDQ     OPTIONS
        56 001207   000002 736000                    QLS     2
        56 001210   400000 376003                    ANQ     -131072,DU
        56 001211   400000 676003                    ERQ     -131072,DU
        56 001212   001225 601000 56                 TNZ     s:2782

   2777 56 001213   000214 235007                    LDA     140,DL
        56 001214   200050 755100                    STA     LEN,,AUTO

   2778 56 001215   200050 630500                    EPPR0   LEN,,AUTO
        56 001216   200277 450500                    STP0    CNT2+3,,AUTO
        56 001217   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001220   200276 451500                    STP1    CNT2+2,,AUTO
        56 001221   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001222   000000 631400 57                 EPPR1   0
        56 001223   000000 701000 xent               TSX1    OUTPUT
        56 001224   000000 011000                    NOP     0

      798     2781
      799     2782    2        CALL BINCHAR(SEG_NUM_CH,SEGMENT_NUMBER);

   2782 56 001225   001372 235000 52                 LDA     SEGMENT_NUMBER
        56 001226   000044 773000                    LRL     36
        56 001227   200276 757100                    STAQ    CNT2+2,,AUTO
        56 001230   000100 301500                    BTD
        56 001231   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:143  
        56 001232   200253 030036                    NDSC9   SEG_NUM_CH,,AUTO         cn=0,s=nosgn,sf=0,n=30

      800     2783    2        CALL BLANK_ZERO(ADDR(SEG_NUM_CH),%OPERAND_LEN);

   2783 56 001233   200253 630500                    EPPR0   SEG_NUM_CH,,AUTO
        56 001234   200276 450500                    STP0    CNT2+2,,AUTO
        56 001235   000021 236000 57                 LDQ     17
        56 001236   200301 756100                    STQ     CNT2+5,,AUTO
        56 001237   200276 631500                    EPPR1   CNT2+2,,AUTO
        56 001240   200300 451500                    STP1    CNT2+4,,AUTO
        56 001241   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 001242   000000 631400 57                 EPPR1   0
        56 001243   000000 701000 xent               TSX1    BLANK_ZERO
        56 001244   000000 011000                    NOP     0

      801     2784
      802     2785    2        CNT = TOP_PEPD;

   2785 56 001245   001530 236000 52                 LDQ     TOP_PEPD
        56 001246   200241 756100                    STQ     CNT,,AUTO

      803     2786
      804     2787    3        DO WHILE(CNT ~= ADDR(NIL));

   2787 56 001247   001400 710000 56                 TRA     s:2817

      805     2788    3          CALL BINCHAR(CHAR_NUM,CNT->PEPD.POS->LABEL_TABLE.LOCATION);

   2788 56 001250   200241 470500                    LDP0    CNT,,AUTO
        56 001251   000000 471500                    LDP1    0,,PR0
        56 001252   000100 301500                    BTD
        56 001253   100010 000004                    NDSC9   8,,PR1                   cn=0,s=lsgnf,sf=0,n=4
        56 001254   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

      806     2789    3          CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);

   2789 56 001255   200051 631500                    EPPR1   CHAR_NUM,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:144  
        56 001256   200276 451500                    STP1    CNT2+2,,AUTO
        56 001257   000021 236000 57                 LDQ     17
        56 001260   200301 756100                    STQ     CNT2+5,,AUTO
        56 001261   200276 633500                    EPPR3   CNT2+2,,AUTO
        56 001262   200300 453500                    STP3    CNT2+4,,AUTO
        56 001263   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 001264   000000 631400 57                 EPPR1   0
        56 001265   000000 701000 xent               TSX1    BLANK_ZERO
        56 001266   000000 011000                    NOP     0

      807     2790    3          CALL CONCAT(BUFFER,'PEPD.POS(%',CNT->PEPD.POS->LABEL_TABLE.NAME,

   2790 56 001267   200241 470500                    LDP0    CNT,,AUTO
        56 001270   000000 471500                    LDP1    0,,PR0
        56 001271   040100 100400                    MLR     fill='040'O
        56 001272   000120 000012 55                 ADSC9   80                       cn=0,n=10
        56 001273   200005 000012                    ADSC9   BUFFER,,AUTO             cn=0,n=10
        56 001274   040100 100500                    MLR     fill='040'O
        56 001275   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        56 001276   200007 400036                    ADSC9   BUFFER+2,,AUTO           cn=2,n=30
        56 001277   000123 236000 55                 LDQ     83
        56 001300   200017 756100                    STQ     BUFFER+10,,AUTO
        56 001301   040100 100500                    MLR     fill='040'O
        56 001302   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 001303   200020 000036                    ADSC9   BUFFER+11,,AUTO          cn=0,n=30
        56 001304   040100 100400                    MLR     fill='040'O
        56 001305   000022 000001 57                 ADSC9   18                       cn=0,n=1
        56 001306   200027 400102                    ADSC9   BUFFER+18,,AUTO          cn=2,n=66

      808     2791    3                   ') = ',CHAR_NUM,';');
      809     2792               %OUTPUT_STR;

   2797 56 001307   000000 236000 24                 LDQ     OUT_DCBN
        56 001310   001320 604000 56                 TMI     s:2799
        56 001311   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001312   001320 601000 56                 TNZ     s:2799
        56 001313   000000 236000 34                 LDQ     OPTIONS
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:145  
        56 001314   000002 736000                    QLS     2
        56 001315   400000 376003                    ANQ     -131072,DU
        56 001316   400000 676003                    ERQ     -131072,DU
        56 001317   001332 601000 56                 TNZ     s:2803

   2799 56 001320   000214 235007                    LDA     140,DL
        56 001321   200050 755100                    STA     LEN,,AUTO

   2800 56 001322   200050 630500                    EPPR0   LEN,,AUTO
        56 001323   200277 450500                    STP0    CNT2+3,,AUTO
        56 001324   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001325   200276 451500                    STP1    CNT2+2,,AUTO
        56 001326   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001327   000000 631400 57                 EPPR1   0
        56 001330   000000 701000 xent               TSX1    OUTPUT
        56 001331   000000 011000                    NOP     0

      810     2803    3          CALL CONCAT(BUFFER,'PEPD.SEGMENT(%',CNT->PEPD.POS->LABEL_TABLE.NAME,

   2803 56 001332   200241 470500                    LDP0    CNT,,AUTO
        56 001333   000000 471500                    LDP1    0,,PR0
        56 001334   040100 100400                    MLR     fill='040'O
        56 001335   000124 000016 55                 ADSC9   84                       cn=0,n=14
        56 001336   200005 000016                    ADSC9   BUFFER,,AUTO             cn=0,n=14
        56 001337   040100 100500                    MLR     fill='040'O
        56 001340   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        56 001341   200010 400036                    ADSC9   BUFFER+3,,AUTO           cn=2,n=30
        56 001342   000123 236000 55                 LDQ     83
        56 001343   200020 756100                    STQ     BUFFER+11,,AUTO
        56 001344   040100 100500                    MLR     fill='040'O
        56 001345   200253 000036                    ADSC9   SEG_NUM_CH,,AUTO         cn=0,n=30
        56 001346   200021 000036                    ADSC9   BUFFER+12,,AUTO          cn=0,n=30
        56 001347   040100 100400                    MLR     fill='040'O
        56 001350   000022 000001 57                 ADSC9   18                       cn=0,n=1
        56 001351   200030 400076                    ADSC9   BUFFER+19,,AUTO          cn=2,n=62

      811     2804    3                ') = ',SEG_NUM_CH,';');
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:146  
      812     2805               %OUTPUT_STR;

   2810 56 001352   000000 236000 24                 LDQ     OUT_DCBN
        56 001353   001363 604000 56                 TMI     s:2812
        56 001354   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001355   001363 601000 56                 TNZ     s:2812
        56 001356   000000 236000 34                 LDQ     OPTIONS
        56 001357   000002 736000                    QLS     2
        56 001360   400000 376003                    ANQ     -131072,DU
        56 001361   400000 676003                    ERQ     -131072,DU
        56 001362   001375 601000 56                 TNZ     s:2816

   2812 56 001363   000214 235007                    LDA     140,DL
        56 001364   200050 755100                    STA     LEN,,AUTO

   2813 56 001365   200050 630500                    EPPR0   LEN,,AUTO
        56 001366   200277 450500                    STP0    CNT2+3,,AUTO
        56 001367   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001370   200276 451500                    STP1    CNT2+2,,AUTO
        56 001371   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001372   000000 631400 57                 EPPR1   0
        56 001373   000000 701000 xent               TSX1    OUTPUT
        56 001374   000000 011000                    NOP     0

      813     2816    3          CNT = CNT->PEPD.NEXT;

   2816 56 001375   200241 470500                    LDP0    CNT,,AUTO
        56 001376   000001 236100                    LDQ     1,,PR0
        56 001377   200241 756100                    STQ     CNT,,AUTO

      814     2817    3        END;

   2817 56 001400   000004 116000 57                 CMPQ    4
        56 001401   001250 601000 56                 TNZ     s:2788

      815     2818
      816     2819    2        CNT = TOP_DEP;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:147  

   2819 56 001402   001531 236000 52                 LDQ     TOP_DEP
        56 001403   200241 756100                    STQ     CNT,,AUTO

      817     2820
      818     2821    3        DO WHILE(CNT ~=ADDR(NIL));

   2821 56 001404   001537 710000 56                 TRA     s:2851

      819     2822    3          CALL BINCHAR(CHAR_NUM,CNT->DEP.LT_POS->LABEL_TABLE.LOCATION);

   2822 56 001405   200241 470500                    LDP0    CNT,,AUTO
        56 001406   000000 471500                    LDP1    0,,PR0
        56 001407   000100 301500                    BTD
        56 001410   100010 000004                    NDSC9   8,,PR1                   cn=0,s=lsgnf,sf=0,n=4
        56 001411   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

      820     2823    3          CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);

   2823 56 001412   200051 631500                    EPPR1   CHAR_NUM,,AUTO
        56 001413   200276 451500                    STP1    CNT2+2,,AUTO
        56 001414   000021 236000 57                 LDQ     17
        56 001415   200301 756100                    STQ     CNT2+5,,AUTO
        56 001416   200276 633500                    EPPR3   CNT2+2,,AUTO
        56 001417   200300 453500                    STP3    CNT2+4,,AUTO
        56 001420   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 001421   000000 631400 57                 EPPR1   0
        56 001422   000000 701000 xent               TSX1    BLANK_ZERO
        56 001423   000000 011000                    NOP     0

      821     2824    3          CALL CONCAT(BUFFER,'DEP.POS(%',CNT->DEP.LT_POS->LABEL_TABLE.NAME,

   2824 56 001424   200241 470500                    LDP0    CNT,,AUTO
        56 001425   000000 471500                    LDP1    0,,PR0
        56 001426   040100 100400                    MLR     fill='040'O
        56 001427   000130 000011 55                 ADSC9   88                       cn=0,n=9
        56 001430   200005 000011                    ADSC9   BUFFER,,AUTO             cn=0,n=9
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:148  
        56 001431   040100 100500                    MLR     fill='040'O
        56 001432   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        56 001433   200007 200036                    ADSC9   BUFFER+2,,AUTO           cn=1,n=30
        56 001434   040100 100400                    MLR     fill='040'O
        56 001435   000123 000004 55                 ADSC9   83                       cn=0,n=4
        56 001436   200016 600004                    ADSC9   BUFFER+9,,AUTO           cn=3,n=4
        56 001437   040100 100500                    MLR     fill='040'O
        56 001440   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 001441   200017 600036                    ADSC9   BUFFER+10,,AUTO          cn=3,n=30
        56 001442   040100 100400                    MLR     fill='040'O
        56 001443   000022 000001 57                 ADSC9   18                       cn=0,n=1
        56 001444   200027 200103                    ADSC9   BUFFER+18,,AUTO          cn=1,n=67

      822     2825    3                     ') = ',CHAR_NUM,';');
      823     2826               %OUTPUT_STR;

   2831 56 001445   000000 236000 24                 LDQ     OUT_DCBN
        56 001446   001456 604000 56                 TMI     s:2833
        56 001447   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001450   001456 601000 56                 TNZ     s:2833
        56 001451   000000 236000 34                 LDQ     OPTIONS
        56 001452   000002 736000                    QLS     2
        56 001453   400000 376003                    ANQ     -131072,DU
        56 001454   400000 676003                    ERQ     -131072,DU
        56 001455   001470 601000 56                 TNZ     s:2837

   2833 56 001456   000214 235007                    LDA     140,DL
        56 001457   200050 755100                    STA     LEN,,AUTO

   2834 56 001460   200050 630500                    EPPR0   LEN,,AUTO
        56 001461   200277 450500                    STP0    CNT2+3,,AUTO
        56 001462   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001463   200276 451500                    STP1    CNT2+2,,AUTO
        56 001464   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001465   000000 631400 57                 EPPR1   0
        56 001466   000000 701000 xent               TSX1    OUTPUT
        56 001467   000000 011000                    NOP     0
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:149  

      824     2837    3          CALL CONCAT(BUFFER,'DEP.SEGMENT(%',CNT->DEP.LT_POS->LABEL_TABLE.NAME,

   2837 56 001470   200241 470500                    LDP0    CNT,,AUTO
        56 001471   000000 471500                    LDP1    0,,PR0
        56 001472   040100 100400                    MLR     fill='040'O
        56 001473   000133 000015 55                 ADSC9   91                       cn=0,n=13
        56 001474   200005 000015                    ADSC9   BUFFER,,AUTO             cn=0,n=13
        56 001475   040100 100500                    MLR     fill='040'O
        56 001476   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        56 001477   200010 200036                    ADSC9   BUFFER+3,,AUTO           cn=1,n=30
        56 001500   040100 100400                    MLR     fill='040'O
        56 001501   000123 000004 55                 ADSC9   83                       cn=0,n=4
        56 001502   200017 600004                    ADSC9   BUFFER+10,,AUTO          cn=3,n=4
        56 001503   040100 100500                    MLR     fill='040'O
        56 001504   200253 000036                    ADSC9   SEG_NUM_CH,,AUTO         cn=0,n=30
        56 001505   200020 600036                    ADSC9   BUFFER+11,,AUTO          cn=3,n=30
        56 001506   040100 100400                    MLR     fill='040'O
        56 001507   000022 000001 57                 ADSC9   18                       cn=0,n=1
        56 001510   200030 200077                    ADSC9   BUFFER+19,,AUTO          cn=1,n=63

      825     2838    3                      ') = ',SEG_NUM_CH,';');
      826     2839               %OUTPUT_STR;

   2844 56 001511   000000 236000 24                 LDQ     OUT_DCBN
        56 001512   001522 604000 56                 TMI     s:2846
        56 001513   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 001514   001522 601000 56                 TNZ     s:2846
        56 001515   000000 236000 34                 LDQ     OPTIONS
        56 001516   000002 736000                    QLS     2
        56 001517   400000 376003                    ANQ     -131072,DU
        56 001520   400000 676003                    ERQ     -131072,DU
        56 001521   001534 601000 56                 TNZ     s:2850

   2846 56 001522   000214 235007                    LDA     140,DL
        56 001523   200050 755100                    STA     LEN,,AUTO

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:150  
   2847 56 001524   200050 630500                    EPPR0   LEN,,AUTO
        56 001525   200277 450500                    STP0    CNT2+3,,AUTO
        56 001526   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001527   200276 451500                    STP1    CNT2+2,,AUTO
        56 001530   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001531   000000 631400 57                 EPPR1   0
        56 001532   000000 701000 xent               TSX1    OUTPUT
        56 001533   000000 011000                    NOP     0

      827     2850    3          CNT = CNT->DEP.NEXT;

   2850 56 001534   200241 470500                    LDP0    CNT,,AUTO
        56 001535   000001 236100                    LDQ     1,,PR0
        56 001536   200241 756100                    STQ     CNT,,AUTO

      828     2851    3        END;

   2851 56 001537   000004 116000 57                 CMPQ    4
        56 001540   001405 601000 56                 TNZ     s:2822

      829     2852
      830     2853    2        CALL CONCAT(BUFFER,'END ',PROC_NAME,';');

   2853 56 001541   000137 236000 55                 LDQ     95
        56 001542   200005 756100                    STQ     BUFFER,,AUTO
        56 001543   040100 100400                    MLR     fill='040'O
        56 001544   001362 000036 52                 ADSC9   PROC_NAME                cn=0,n=30
        56 001545   200006 000036                    ADSC9   BUFFER+1,,AUTO           cn=0,n=30
        56 001546   040100 100400                    MLR     fill='040'O
        56 001547   000022 000001 57                 ADSC9   18                       cn=0,n=1
        56 001550   200015 400152                    ADSC9   BUFFER+8,,AUTO           cn=2,n=106

      831     2854             %OUTPUT_STR;

   2859 56 001551   000000 236000 24                 LDQ     OUT_DCBN
        56 001552   001562 604000 56                 TMI     s:2861
        56 001553   000000 116000 xsym               CMPQ    Z8PS$M$OU#
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:151  
        56 001554   001562 601000 56                 TNZ     s:2861
        56 001555   000000 236000 34                 LDQ     OPTIONS
        56 001556   000002 736000                    QLS     2
        56 001557   400000 376003                    ANQ     -131072,DU
        56 001560   400000 676003                    ERQ     -131072,DU
        56 001561   001574 601000 56                 TNZ     s:2866

   2861 56 001562   000214 235007                    LDA     140,DL
        56 001563   200050 755100                    STA     LEN,,AUTO

   2862 56 001564   200050 630500                    EPPR0   LEN,,AUTO
        56 001565   200277 450500                    STP0    CNT2+3,,AUTO
        56 001566   200005 631500                    EPPR1   BUFFER,,AUTO
        56 001567   200276 451500                    STP1    CNT2+2,,AUTO
        56 001570   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 001571   000000 631400 57                 EPPR1   0
        56 001572   000000 701000 xent               TSX1    OUTPUT
        56 001573   000000 011000                    NOP     0

      832     2865             %SELECT_LO;

   2866 56 001574   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 001575   000000 755000 24                 STA     OUT_DCBN

      833     2868
      834     2869    2    END OUTPUT_PEPD;

   2869 56 001576   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 001577   000001 702211                    TSX2  ! 1,X1

      835     2870         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:152  
      836     2871
      837     2872
      838     2873
      839     2874    1    HANDLE_ARITH_EXP : PROC(RESULT,LEN);

   2874 56 001600   200240 741300       HANDLE_ARIT* STX1  ! SHIFT_FACTOR+2,,AUTO

      840     2875         /*I*
      841     2876              NAME: HANDLE_ARITH_EXP
      842     2877              PURPOSE:
      843     2878                   Determine the value of an expression from pseudo-code that
      844     2879                   may contain an asterisk.
      845     2880              CALL:
      846     2881                   CALL HANDLE_ARITH_EXP;
      847     2882              PARAMETERS:
      848     2883                   RESULT
      849     2884                     Character representation of the numeric result from the expression.
      850     2885                   LEN
      851     2886                     Length of the result in characters. An input parameter.
      852     2887              DATA:
      853     2888                   LX_STK
      854     2889              DESCRIPTION:
      855     2890                   This procedure gets it data from the LX_STK.  Since expressions have
      856     2891                   a rigid syntax, everything needed should always be in the same place
      857     2892                   on the stack.  It determines the value of the expression, with
      858     2893                   asterisk meaning the current value of the object table counter.
      859     2894         */
      860     2895    2        DCL LEN UBIN;
      861     2896    2        DCL RESULT CHAR(LEN);
      862     2897    2        DCL NUM1 SBIN;
      863     2898    2        DCL NUM2 SBIN;
      864     2899    2        DCL RES1 SBIN HALF;
      865     2900    2        DCL RES2 REDEF RES1 UBIN HALF;
      866     2901
      867     2902    2        IF LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME = '*' THEN

   2902 56 001601   000000 236000 1                  LDQ     LX_TOP
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:153  
        56 001602   000006 402007                    MPY     6,DL
        56 001603   000001 470406 2                  LDP0    LX_STK+1,QL
        56 001604   000000 720100                    LXL0    0,,PR0
        56 001605   040000 106540                    CMPC    fill='040'O
        56 001606   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        56 001607   000023 000001 57                 ADSC9   19                       cn=0,n=1
        56 001610   001614 601000 56                 TNZ     s:2904

      868     2903    2          NUM1 = CURRENT_OT_POS;

   2903 56 001611   000000 235000 53                 LDA     CURRENT_OT_POS
        56 001612   200243 755100                    STA     NUM1,,AUTO
        56 001613   001617 710000 56                 TRA     s:2906

      869     2904    2        ELSE CALL CHARBIN(NUM1,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);

   2904 56 001614   000100 305540                    DTB
        56 001615   000001 030010                    NDSC9   1,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
        56 001616   200243 000004                    NDSC9   NUM1,,AUTO               cn=0,s=lsgnf,sf=0,n=4

      870     2905
      871     2906    2        IF LX_STK.DNTPTR(LX_TOP + 2)->DNT.TEXT.NAME = '*' THEN

   2906 56 001617   000015 471406 2                  LDP1    LX_STK+13,QL
        56 001620   100000 722100                    LXL2    0,,PR1
        56 001621   040000 106540                    CMPC    fill='040'O
        56 001622   100001 000012                    ADSC9   1,,PR1                   cn=0,n=*X2
        56 001623   000023 000001 57                 ADSC9   19                       cn=0,n=1
        56 001624   001630 601000 56                 TNZ     s:2908

      872     2907    2          NUM2 = CURRENT_OT_POS;

   2907 56 001625   000000 235000 53                 LDA     CURRENT_OT_POS
        56 001626   200244 755100                    STA     NUM2,,AUTO
        56 001627   001633 710000 56                 TRA     s:2910

      873     2908    2        ELSE CALL CHARBIN(NUM2,LX_STK.DNTPTR(LX_TOP + 2)->DNT.TEXT.NAME);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:154  

   2908 56 001630   000100 305540                    DTB
        56 001631   100001 030012                    NDSC9   1,,PR1                   cn=0,s=nosgn,sf=0,n=*X2
        56 001632   200244 000004                    NDSC9   NUM2,,AUTO               cn=0,s=lsgnf,sf=0,n=4

      874     2909
      875     2910    2        IF LX_STK.DNTPTR(LX_TOP+1)->DNT.TEXT.NAME = '-' THEN

   2910 56 001633   000007 473406 2                  LDP3    LX_STK+7,QL
        56 001634   300000 723100                    LXL3    0,,PR3
        56 001635   040000 106540                    CMPC    fill='040'O
        56 001636   300001 000013                    ADSC9   1,,PR3                   cn=0,n=*X3
        56 001637   000024 000001 57                 ADSC9   20                       cn=0,n=1
        56 001640   001646 601000 56                 TNZ     s:2912

      876     2911    2          RES1 = NUM1 - NUM2;

   2911 56 001641   200243 236100                    LDQ     NUM1,,AUTO
        56 001642   200244 136100                    SBLQ    NUM2,,AUTO
        56 001643   000000 620006                    EAX0    0,QL
        56 001644   200245 740100                    STX0    RES1,,AUTO
        56 001645   001663 710000 56                 TRA     s:2916

      877     2912    2        ELSE IF LX_STK.DNTPTR(LX_TOP+1)->DNT.TEXT.NAME = '+' THEN

   2912 56 001646   040000 106540                    CMPC    fill='040'O
        56 001647   300001 000013                    ADSC9   1,,PR3                   cn=0,n=*X3
        56 001650   000025 000001 57                 ADSC9   21                       cn=0,n=1
        56 001651   001657 601000 56                 TNZ     s:2914

      878     2913    2               RES1 = NUM1 + NUM2;

   2913 56 001652   200243 236100                    LDQ     NUM1,,AUTO
        56 001653   200244 036100                    ADLQ    NUM2,,AUTO
        56 001654   000000 620006                    EAX0    0,QL
        56 001655   200245 740100                    STX0    RES1,,AUTO
        56 001656   001663 710000 56                 TRA     s:2916
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:155  

      879     2914    2             ELSE RES1 = NUM1 * NUM2;

   2914 56 001657   200243 236100                    LDQ     NUM1,,AUTO
        56 001660   200244 402100                    MPY     NUM2,,AUTO
        56 001661   000000 620006                    EAX0    0,QL
        56 001662   200245 740100                    STX0    RES1,,AUTO

      880     2915
      881     2916    2        CALL BINCHAR(RESULT,RES2);

   2916 56 001663   200242 470500                    LDP0    @LEN,,AUTO
        56 001664   000000 722100                    LXL2    0,,PR0
        56 001665   200245 235100                    LDA     RES1,,AUTO
        56 001666   000022 771000                    ARL     18
        56 001667   000044 773000                    LRL     36
        56 001670   200276 757100                    STAQ    CNT2+2,,AUTO
        56 001671   200241 471500                    LDP1    @RESULT,,AUTO
        56 001672   000140 301500                    BTD
        56 001673   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 001674   100000 030012                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=*X2

      882     2917
      883     2918    2    END HANDLE_ARITH_EXP;

   2918 56 001675   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 001676   000001 702211                    TSX2  ! 1,X1

      884     2919         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:156  
      885     2920    1    PUT_OPERAND : PROC(OPER);

   2920 56 001677   200240 741300       PUT_OPERAND  STX1  ! SHIFT_FACTOR+2,,AUTO

      886     2921         /*I*
      887     2922              NAME: PUT_OPERAND
      888     2923              PURPOSE:
      889     2924                   Place an operand from a directive into the P_CODE structure.
      890     2925              CALL:
      891     2926                   CALL PUT_OPERAND(OPER);
      892     2927              PARAMETERS:
      893     2928                   OPER
      894     2929                     The character representation of the operand.
      895     2930              DATA:
      896     2931                   P_CODE
      897     2932              DESCRIPTION:
      898     2933                   Put an operand into the P_CODE structure.  Make sure there
      899     2934                   are not too many operands.
      900     2935         */
      901     2936    2        DCL OPER CHAR(%OPERAND_LEN);
      902     2937
      903     2938    2        IF OPCNT > %MAX_OPS THEN

   2938 56 001700   001522 235000 52                 LDA     OPCNT
        56 001701   000006 115007                    CMPA    6,DL
        56 001702   001710 602000 56                 TNC     s:2942

      904     2939    2          CALL Z8PA$ERROR_PROC(%MESS5);

   2939 56 001703   000026 630400 57                 EPPR0   22
        56 001704   000006 631400 57                 EPPR1   6
        56 001705   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 001706   000000 011000                    NOP     0
        56 001707   001721 710000 56                 TRA     s:2946

      905     2940    2        ELSE
      906     2941    3          DO;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:157  

      907     2942    3            P_CODE.OPERAND(OPCNT) = OPER;

   2942 56 001710   001522 236000 52                 LDQ     OPCNT
        56 001711   000036 402007                    MPY     30,DL
        56 001712   200241 470500                    LDP0    @OPER,,AUTO
        56 001713   040006 100500                    MLR     fill='040'O
        56 001714   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        56 001715   001444 200036 52                 ADSC9   P_CODE+4,Q               cn=1,n=30

      908     2943    3            OPCNT = OPCNT + 1;

   2943 56 001716   001522 235000 52                 LDA     OPCNT
        56 001717   000001 035007                    ADLA    1,DL
        56 001720   001522 755000 52                 STA     OPCNT

      909     2944    3          END;

      910     2945
      911     2946    2    END PUT_OPERAND;

   2946 56 001721   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 001722   000001 702211                    TSX2  ! 1,X1

      912     2947         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:158  
      913     2948    1    OCTBIN : PROC(OCTNUM,OCTCHAR);

   2948 56 001723   200270 741300       OCTBIN       STX1  ! TAG_VAL+1,,AUTO

      914     2949         /*I*
      915     2950              NAME: OCTBIN
      916     2951              PURPOSE:
      917     2952                   Input a character representation of an octal number and
      918     2953                   output the binary equivalent.
      919     2954              CALL:
      920     2955                   CALL OCTBIN(OCTNUM,OCTCHAR);
      921     2956              PARAMETERS:
      922     2957                   OCTNUM
      923     2958                     An output parameter that gives a ubin word value for the octal
      924     2959                     number.
      925     2960                   OCTCHAR
      926     2961                     The octal number in character code, right justified.
      927     2962              DATA:
      928     2963                   None.
      929     2964              DESCRIPTION:
      930     2965                   Use the redef facility to redefine the input and output parameters
      931     2966                   as arrays.  Step through the input array, doing the conversion one
      932     2967                   character at a time. Use only the rightmost 12
      933     2968                   characters because there are only 12 octal digits
      934     2969                   in a ubin word.
      935     2970         */
      936     2971
      937     2972    2        DCL OCTNUM UBIN WORD;
      938     2973    2        DCL OCTNUM_T (0:11) REDEF OCTNUM BIT(3);
      939     2974    2        DCL OCTCHAR CHAR(%OPERAND_LEN);
      940     2975    2        DCL OCTCHAR_T (0:%(OPERAND_LEN-1)) REDEF OCTCHAR CHAR(1);
      941     2976
      942     2977    2        DCL CNT SBIN;
      943     2978    2        DCL CNT2 SBIN;
      944     2979
      945     2980    2        DCL 1 OCTVALS (0:8) STATIC,
      946     2981    2          2 NAME CHAR(1) INIT('0','1','2','3','4','5','6','7',' '),
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:159  
      947     2982    2          2 VALUE BIT(3) INIT('0'O,'1'O,'2'O,'3'O,'4'O,'5'O,'6'O,'7'O,'0'O);
      948     2983
      949     2984
      950     2985    3        DO CNT = %(OPERAND_LEN-12) TO %(OPERAND_LEN-1);

   2985 56 001724   000022 235007                    LDA     18,DL
        56 001725   200273 755100                    STA     CNT,,AUTO

      951     2986    3          CNT2 = 0;

   2986 56 001726   200274 450100                    STZ     CNT2,,AUTO

      952     2987    4          DO WHILE(OCTVALS.NAME(CNT2) ~= OCTCHAR_T(CNT));

   2987 56 001727   200274 235100                    LDA     CNT2,,AUTO
        56 001730   000001 735000                    ALS     1
        56 001731   200272 470500                    LDP0    @OCTCHAR,,AUTO
        56 001732   200273 236100                    LDQ     CNT,,AUTO
        56 001733   040106 106405                    CMPC    fill='040'O
        56 001734   001536 000001 52                 ADSC9   OCTVALS,A                cn=0,n=1
        56 001735   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
        56 001736   001750 600000 56                 TZE     s:2990

      953     2988    4            CNT2 = CNT2 + 1;

   2988 56 001737   200274 054100                    AOS     CNT2,,AUTO

      954     2989    4          END;

   2989 56 001740   200274 235100                    LDA     CNT2,,AUTO
        56 001741   000001 735000                    ALS     1
        56 001742   200272 470500                    LDP0    @OCTCHAR,,AUTO
        56 001743   200273 236100                    LDQ     CNT,,AUTO
        56 001744   040106 106405                    CMPC    fill='040'O
        56 001745   001536 000001 52                 ADSC9   OCTVALS,A                cn=0,n=1
        56 001746   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
        56 001747   001737 601000 56                 TNZ     s:2988
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:160  

      955     2990    3          OCTNUM_T(CNT-%(OPERAND_LEN-12)) = OCTVALS.VALUE(CNT2);

   2990 56 001750   200274 236100                    LDQ     CNT2,,AUTO
        56 001751   000022 402007                    MPY     18,DL
        56 001752   000000 116003                    CMPQ    0,DU
        56 001753   001755 605000 56                 TPL     s:2990+5
        56 001754   000044 036003                    ADLQ    36,DU
        56 001755   200276 756100                    STQ     CNT2+2,,AUTO
        56 001756   200273 236100                    LDQ     CNT,,AUTO
        56 001757   000003 402007                    MPY     3,DL
        56 001760   000000 116003                    CMPQ    0,DU
        56 001761   001763 605000 56                 TPL     s:2990+11
        56 001762   000044 036003                    ADLQ    36,DU
        56 001763   200276 235100                    LDA     CNT2+2,,AUTO
        56 001764   200271 471500                    LDP1    @OCTNUM,,AUTO
        56 001765   003106 060405                    CSL     bolr='003'O
        56 001766   001536 200003 52                 BDSC    OCTVALS,A                by=1,bit=0,n=3
        56 001767   177776 400003                    BDSC    -2,Q,PR1                 by=2,bit=0,n=3

      956     2991    3        END;

   2991 56 001770   200273 054100                    AOS     CNT,,AUTO
        56 001771   200273 235100                    LDA     CNT,,AUTO
        56 001772   000035 115007                    CMPA    29,DL
        56 001773   001726 604400 56                 TMOZ    s:2986

      957     2992
      958     2993    2    END OCTBIN;

   2993 56 001774   200270 221300                    LDX1  ! TAG_VAL+1,,AUTO
        56 001775   000001 702211                    TSX2  ! 1,X1

      959     2994
      960     2995         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:161  
      961     2996    1    HANDLE_PC_UTILITIES : PROC(FWBOT,SWTOP,SWBOT);

   2996 56 001776   200242 741300       HANDLE_PC_U* STX1  ! @LEN,,AUTO
        56 001777   002243 710000 56                 TRA     s:3140

      962     2997         /*I*
      963     2998              NAME: HANDLE_PC_UTILITIES
      964     2999              PURPOSE:
      965     3000                   This procdure assembles the pseudo code for the pseudo-code
      966     3001                   utility directives.
      967     3002              CALL:
      968     3003                   CALL HANDLE_PC_UTILITIES(FWBOT,SWTOP,SWBOT);
      969     3004              PARAMETERS:
      970     3005                   All parameters are output parameters intended to be output directly
      971     3006                   to the object table without needing any modification.
      972     3007                   FWBOT
      973     3008                     The bottom half word of the first word of the directive.
      974     3009                   SWTOP
      975     3010                     The top half word of the second word generated for the directive.
      976     3011                   SWBOT
      977     3012                     The bottom half word of the second word generated for the directive.
      978     3013              DATA:
      979     3014                   P_CODE
      980     3015              DESCRIPTION:
      981     3016                   Generate the character representation of the assembled directive
      982     3017                   using the P_CODE structure and some convoluted logic.
      983     3018         */
      984     3019
      985     3020    2        DCL FWBOT CHAR(120);  /* Lower part of the first pc word generated */
      986     3021    2        DCL SWTOP CHAR(120);  /* Upper part of second pc word generated */
      987     3022    2        DCL SWBOT CHAR(120);  /* Lower part of second pc word generated */
      988     3023    2        DCL TSWBOT CHAR(10);
      989     3024    2        DCL TSWTOP CHAR(10);
      990     3025
      991     3026
      992     3027    2        DCL VFD_WORD  UBIN;
      993     3028    2        DCL 1 VFD_OUT REDEF VFD_WORD,
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:162  
      994     3029    2          2 UPPER UBIN HALF UNAL,
      995     3030    2          2 LOWER UBIN HALF UNAL;
      996     3031
      997     3032    2        DCL P1 UBIN(6);
      998     3033    2        DCL P2 UBIN(6);
      999     3034    2        DCL CD UBIN(6);
     1000     3035    2        DCL OPNUM SBIN;
     1001     3036    2        DCL CODE CHAR (10);
     1002     3037
     1003     3038    2        DCL I SBIN;
     1004     3039
     1005     3040
     1006     3041
     1007     3042    2        GET_P : PROC(P,OPN);

   3042 56 002000   200266 741300       GET_P        STX1  ! BINRES+1,,AUTO

     1008     3043               /* GET_P  determines the value of P (whatever that is) */
     1009     3044
     1010     3045    3          DCL P UBIN(6);
     1011     3046    3          DCL OPN SBIN;  /* Determines which operand P will be derived from */
     1012     3047    3          DCL POS SBIN;
     1013     3048
     1014     3049    3          IF (P_CODE.OPERAND(OPN) = 'DECIMAL') OR (P_CODE.OPERAND(OPN) = 'OCTAL') THEN

   3049 56 002001   200270 470500                    LDP0    @OPN,,AUTO
        56 002002   000000 236100                    LDQ     0,,PR0
        56 002003   000036 402007                    MPY     30,DL
        56 002004   040000 106406                    CMPC    fill='040'O
        56 002005   001444 200036 52                 ADSC9   P_CODE+4,Q               cn=1,n=30
        56 002006   000157 000007 55                 ADSC9   111                      cn=0,n=7
        56 002007   002014 600000 56                 TZE     s:3050
        56 002010   040000 106406                    CMPC    fill='040'O
        56 002011   001444 200036 52                 ADSC9   P_CODE+4,Q               cn=1,n=30
        56 002012   000161 000005 55                 ADSC9   113                      cn=0,n=5
        56 002013   002020 601000 56                 TNZ     s:3051

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:163  
     1015     3050    3             P = 1;

   3050 56 002014   010000 236003                    LDQ     4096,DU
        56 002015   200267 471500                    LDP1    @P,,AUTO
        56 002016   100000 756100                    STQ     0,,PR1
        56 002017   002241 710000 56                 TRA     s:3067

     1016     3051    3          ELSE IF P_CODE.OPERAND(OPN) = 'COMCOM' THEN

   3051 56 002020   040000 106406                    CMPC    fill='040'O
        56 002021   001444 200036 52                 ADSC9   P_CODE+4,Q               cn=1,n=30
        56 002022   000163 000006 55                 ADSC9   115                      cn=0,n=6
        56 002023   002030 601000 56                 TNZ     s:3053

     1017     3052    3             P = 2;

   3052 56 002024   020000 236003                    LDQ     8192,DU
        56 002025   200267 471500                    LDP1    @P,,AUTO
        56 002026   100000 756100                    STQ     0,,PR1
        56 002027   002241 710000 56                 TRA     s:3067

     1018     3053    3          ELSE IF P_CODE.OPERAND(OPN) = 'ILL' THEN

   3053 56 002030   040000 106406                    CMPC    fill='040'O
        56 002031   001444 200036 52                 ADSC9   P_CODE+4,Q               cn=1,n=30
        56 002032   000165 000003 55                 ADSC9   117                      cn=0,n=3
        56 002033   002040 601000 56                 TNZ     s:3055

     1019     3054    3             P = 3;

   3054 56 002034   030000 236003                    LDQ     12288,DU
        56 002035   200267 471500                    LDP1    @P,,AUTO
        56 002036   100000 756100                    STQ     0,,PR1
        56 002037   002241 710000 56                 TRA     s:3067

     1020     3055    3          ELSE IF P_CODE.OPERAND(OPN) = 'SYSSM' THEN

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:164  
   3055 56 002040   040000 106406                    CMPC    fill='040'O
        56 002041   001444 200036 52                 ADSC9   P_CODE+4,Q               cn=1,n=30
        56 002042   000166 000005 55                 ADSC9   118                      cn=0,n=5
        56 002043   002050 601000 56                 TNZ     s:3057

     1021     3056    3             P = 4;

   3056 56 002044   040000 236003                    LDQ     16384,DU
        56 002045   200267 471500                    LDP1    @P,,AUTO
        56 002046   100000 756100                    STQ     0,,PR1
        56 002047   002241 710000 56                 TRA     s:3067

     1022     3057    3          ELSE IF P_CODE.OPERAND(OPN) = 'PCOM' THEN

   3057 56 002050   040000 106406                    CMPC    fill='040'O
        56 002051   001444 200036 52                 ADSC9   P_CODE+4,Q               cn=1,n=30
        56 002052   000170 000004 55                 ADSC9   120                      cn=0,n=4
        56 002053   002241 601000 56                 TNZ     s:3067

     1023     3058    4             DO;

     1024     3059    4               P = 5;

   3059 56 002054   050000 236003                    LDQ     20480,DU
        56 002055   200267 471500                    LDP1    @P,,AUTO
        56 002056   100000 756100                    STQ     0,,PR1

     1025     3060    5               DO SELECT(P_CODE.OPERAND(OPN + 1));

   3060 56 002057   000000 236100                    LDQ     0,,PR0
        56 002060   000036 402007                    MPY     30,DL
        56 002061   040000 106406                    CMPC    fill='040'O
        56 002062   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002063   000171 000005 55                 ADSC9   121                      cn=0,n=5
        56 002064   002174 602000 56                 TNC     s:3060+77
        56 002065   002237 600000 56                 TZE     s:3064
        56 002066   040000 106406                    CMPC    fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:165  
        56 002067   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002070   000173 000005 55                 ADSC9   123                      cn=0,n=5
        56 002071   002131 602000 56                 TNC     s:3060+42
        56 002072   002237 600000 56                 TZE     s:3064
        56 002073   040000 106406                    CMPC    fill='040'O
        56 002074   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002075   000175 000005 55                 ADSC9   125                      cn=0,n=5
        56 002076   002112 602000 56                 TNC     s:3060+27
        56 002077   002237 600000 56                 TZE     s:3064
        56 002100   040000 106406                    CMPC    fill='040'O
        56 002101   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002102   000177 000005 55                 ADSC9   127                      cn=0,n=5
        56 002103   002241 602000 56                 TNC     s:3067
        56 002104   002237 600000 56                 TZE     s:3064
        56 002105   040000 106406                    CMPC    fill='040'O
        56 002106   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002107   000201 000005 55                 ADSC9   129                      cn=0,n=5
        56 002110   002241 601000 56                 TNZ     s:3067
        56 002111   002237 710000 56                 TRA     s:3064
        56 002112   040000 106406                    CMPC    fill='040'O
        56 002113   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002114   000203 000005 55                 ADSC9   131                      cn=0,n=5
        56 002115   002124 602000 56                 TNC     s:3060+37
        56 002116   002237 600000 56                 TZE     s:3064
        56 002117   040000 106406                    CMPC    fill='040'O
        56 002120   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002121   000205 000005 55                 ADSC9   133                      cn=0,n=5
        56 002122   002241 601000 56                 TNZ     s:3067
        56 002123   002237 710000 56                 TRA     s:3064
        56 002124   040000 106406                    CMPC    fill='040'O
        56 002125   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002126   000207 000005 55                 ADSC9   135                      cn=0,n=5
        56 002127   002241 601000 56                 TNZ     s:3067
        56 002130   002237 710000 56                 TRA     s:3064
        56 002131   040000 106406                    CMPC    fill='040'O
        56 002132   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002133   000211 000005 55                 ADSC9   137                      cn=0,n=5
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:166  
        56 002134   002155 602000 56                 TNC     s:3060+62
        56 002135   002237 600000 56                 TZE     s:3064
        56 002136   040000 106406                    CMPC    fill='040'O
        56 002137   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002140   000213 000005 55                 ADSC9   139                      cn=0,n=5
        56 002141   002150 602000 56                 TNC     s:3060+57
        56 002142   002237 600000 56                 TZE     s:3064
        56 002143   040000 106406                    CMPC    fill='040'O
        56 002144   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002145   000215 000005 55                 ADSC9   141                      cn=0,n=5
        56 002146   002241 601000 56                 TNZ     s:3067
        56 002147   002237 710000 56                 TRA     s:3064
        56 002150   040000 106406                    CMPC    fill='040'O
        56 002151   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002152   000217 000005 55                 ADSC9   143                      cn=0,n=5
        56 002153   002241 601000 56                 TNZ     s:3067
        56 002154   002237 710000 56                 TRA     s:3064
        56 002155   040000 106406                    CMPC    fill='040'O
        56 002156   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002157   000221 000005 55                 ADSC9   145                      cn=0,n=5
        56 002160   002167 602000 56                 TNC     s:3060+72
        56 002161   002237 600000 56                 TZE     s:3064
        56 002162   040000 106406                    CMPC    fill='040'O
        56 002163   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002164   000223 000005 55                 ADSC9   147                      cn=0,n=5
        56 002165   002241 601000 56                 TNZ     s:3067
        56 002166   002237 710000 56                 TRA     s:3064
        56 002167   040000 106406                    CMPC    fill='040'O
        56 002170   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002171   000225 000005 55                 ADSC9   149                      cn=0,n=5
        56 002172   002241 601000 56                 TNZ     s:3067
        56 002173   002237 710000 56                 TRA     s:3064
        56 002174   040000 106406                    CMPC    fill='040'O
        56 002175   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002176   000227 000005 55                 ADSC9   151                      cn=0,n=5
        56 002177   002220 602000 56                 TNC     s:3060+97
        56 002200   002237 600000 56                 TZE     s:3064
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:167  
        56 002201   040000 106406                    CMPC    fill='040'O
        56 002202   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002203   000231 000005 55                 ADSC9   153                      cn=0,n=5
        56 002204   002213 602000 56                 TNC     s:3060+92
        56 002205   002237 600000 56                 TZE     s:3064
        56 002206   040000 106406                    CMPC    fill='040'O
        56 002207   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002210   000233 000005 55                 ADSC9   155                      cn=0,n=5
        56 002211   002241 601000 56                 TNZ     s:3067
        56 002212   002237 710000 56                 TRA     s:3064
        56 002213   040000 106406                    CMPC    fill='040'O
        56 002214   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002215   000235 000005 55                 ADSC9   157                      cn=0,n=5
        56 002216   002241 601000 56                 TNZ     s:3067
        56 002217   002237 710000 56                 TRA     s:3064
        56 002220   040000 106406                    CMPC    fill='040'O
        56 002221   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002222   000237 000005 55                 ADSC9   159                      cn=0,n=5
        56 002223   002232 602000 56                 TNC     s:3060+107
        56 002224   002237 600000 56                 TZE     s:3064
        56 002225   040000 106406                    CMPC    fill='040'O
        56 002226   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002227   000241 000005 55                 ADSC9   161                      cn=0,n=5
        56 002230   002241 601000 56                 TNZ     s:3067
        56 002231   002237 710000 56                 TRA     s:3064
        56 002232   040000 106406                    CMPC    fill='040'O
        56 002233   001453 600036 52                 ADSC9   P_CODE+11,Q              cn=3,n=30
        56 002234   000243 000005 55                 ADSC9   163                      cn=0,n=5
        56 002235   002241 601000 56                 TNZ     s:3067
        56 002236   002237 710000 56                 TRA     s:3064

     1026     3061    5                 SELECT('EOPND','FOPND','GOPND','HOPND','IOPND','JOPND','KOPND',

     1027     3062    5                        'LOPND','MOPND','NOPND','OOPND','POPND','QOPND','ROPND',
     1028     3063    5                       'SOPND','TOPND','UOPND','VOPND','WOPND','XOPND','YOPND','ZOPND'
              3063                                 );
     1029     3064    5                   P = 6;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:168  

   3064 56 002237   060000 236003                    LDQ     24576,DU
        56 002240   100000 756100                    STQ     0,,PR1

     1030     3065    5               END;

     1031     3066    4             END;

     1032     3067    3        END GET_P;

   3067 56 002241   200266 221300                    LDX1  ! BINRES+1,,AUTO
        56 002242   000001 702211                    TSX2  ! 1,X1

     1033     3068
     1034     3069
     1035     3070         %MACRO VFD1;
     1036     3071             DO;
     1037     3072               CALL BINCHAR(CODE,CD);
     1038     3073               CALL CONCAT(FWBOT,'%(BITBIN(BINBIT(',CODE,
     1039     3074                 '*4096,18) | BINBIT(',P_CODE.OPERAND(3),',18))),');
     1040     3075             END;
     1041     3076         %MEND;
     1042     3077
     1043     3078         %MACRO VFD2;
     1044     3079             DO;
     1045     3080               CALL OCTBIN(VFD_WORD,P_CODE.OPERAND(1));
     1046     3081               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1047     3082               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1048     3083             END;
     1049     3084         %MEND;
     1050     3085
     1051     3086         %MACRO VFD3;
     1052     3087             DO;
     1053     3088               CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(1));
     1054     3089               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1055     3090               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1056     3091             END;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:169  
     1057     3092         %MEND;
     1058     3093
     1059     3094         %MACRO VFD4;
     1060     3095             DO;
     1061     3096                 CALL BINCHAR(CODE,CD);
     1062     3097                 CALL CONCAT(FWBOT,'%(BITBIN((BINBIT(',CODE,
     1063     3098                     '*4096,18) | BINBIT(',P_CODE.OPERAND(1));
     1064     3099                 CALL INSERT(FWBOT,58,,'*32,18)) | BINBIT(',
     1065     3100                     P_CODE.OPERAND(3),',18))),');
     1066     3101             END;
     1067     3102         %MEND;
     1068     3103
     1069     3104         %MACRO VFD5;
     1070     3105             DO;
     1071     3106               CALL BINCHAR(CODE,CD);
     1072     3107               CALL CONCAT(FWBOT,'%(BITBIN(BINBIT(',CODE,
     1073     3108                 '*4096,18) | BINBIT(',P_CODE.OPERAND(1),'*32,18))),');
     1074     3109             END;
     1075     3110         %MEND;
     1076     3111
     1077     3112
     1078     3113         %MACRO VFD6;
     1079     3114             DO;
     1080     3115               CALL OCTBIN(VFD_WORD,P_CODE.OPERAND(3));
     1081     3116               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1082     3117               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1083     3118             END;
     1084     3119         %MEND;
     1085     3120
     1086     3121         %MACRO VFD7;
     1087     3122             DO;
     1088     3123               CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(3));
     1089     3124               CALL BINCHAR(TSWTOP,VFD_OUT.UPPER);
     1090     3125               CALL BINCHAR(TSWBOT,VFD_OUT.LOWER);
     1091     3126             END;
     1092     3127         %MEND;
     1093     3128
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:170  
     1094     3129         %MACRO VFD8;
     1095     3130             DO;
     1096     3131               IF P_CODE.OPERAND(4) ~= ZILCH THEN
     1097     3132                 CALL CONCAT(SWTOP,'%',P_CODE.OPERAND(4),',');
     1098     3133               ELSE
     1099     3134                 SWTOP = '0,';
     1100     3135               SWBOT = '0,';
     1101     3136             END;
     1102     3137         %MEND;
     1103     3138
     1104     3139
     1105     3140    2        VFD_WORD = 0;

   3140 56 002243   200254 450100                    STZ     VFD_WORD,,AUTO

     1106     3141    2        OPNUM = 0;

   3141 56 002244   200260 450100                    STZ     OPNUM,,AUTO

     1107     3142    2        CALL GET_P(P1,OPNUM);

   3142 56 002245   200260 630500                    EPPR0   OPNUM,,AUTO
        56 002246   200270 450500                    STP0    TAG_VAL+1,,AUTO
        56 002247   200255 631500                    EPPR1   P1,,AUTO
        56 002250   200267 451500                    STP1    CNT+1,,AUTO
        56 002251   002000 701000 56                 TSX1    GET_P
        56 002252   000000 011000                    NOP     0

     1108     3143    2        OPNUM = 2;

   3143 56 002253   000002 235007                    LDA     2,DL
        56 002254   200260 755100                    STA     OPNUM,,AUTO

     1109     3144    2        CALL GET_P(P2,OPNUM);

   3144 56 002255   200260 630500                    EPPR0   OPNUM,,AUTO
        56 002256   200270 450500                    STP0    TAG_VAL+1,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:171  
        56 002257   200256 631500                    EPPR1   P2,,AUTO
        56 002260   200267 451500                    STP1    CNT+1,,AUTO
        56 002261   002000 701000 56                 TSX1    GET_P
        56 002262   000000 011000                    NOP     0

     1110     3145    2        CD = (P1 - 1) * 6 + (P2 - 1);

   3145 56 002263   200256 236100                    LDQ     P2,,AUTO
        56 002264   000036 772000                    QRL     30
        56 002265   200276 756100                    STQ     CNT2+2,,AUTO
        56 002266   200255 236100                    LDQ     P1,,AUTO
        56 002267   000036 772000                    QRL     30
        56 002270   000006 402007                    MPY     6,DL
        56 002271   200276 036100                    ADLQ    CNT2+2,,AUTO
        56 002272   000007 136007                    SBLQ    7,DL
        56 002273   000036 736000                    QLS     30
        56 002274   200257 756100                    STQ     CD,,AUTO

     1111     3146    2        IF P_CODE.OPERAND(0) = 'DECIMAL' OR P_CODE.OPERAND(0) = 'OCTAL' OR

   3146 56 002275   040000 106400                    CMPC    fill='040'O
        56 002276   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 002277   000157 000007 55                 ADSC9   111                      cn=0,n=7
        56 002300   002315 600000 56                 TZE     s:3149
        56 002301   040000 106400                    CMPC    fill='040'O
        56 002302   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 002303   000161 000005 55                 ADSC9   113                      cn=0,n=5
        56 002304   002315 600000 56                 TZE     s:3149
        56 002305   040000 106400                    CMPC    fill='040'O
        56 002306   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 002307   000157 000007 55                 ADSC9   111                      cn=0,n=7
        56 002310   002315 600000 56                 TZE     s:3149
        56 002311   040000 106400                    CMPC    fill='040'O
        56 002312   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 002313   000161 000005 55                 ADSC9   113                      cn=0,n=5
        56 002314   002553 601000 56                 TNZ     s:3206

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:172  
     1112     3147    2           P_CODE.OPERAND(2) = 'DECIMAL' OR P_CODE.OPERAND(2) = 'OCTAL' THEN
     1113     3148    3          DO;

     1114     3149    3            IF P_CODE.OPERAND(0) = 'OCTAL' OR P_CODE.OPERAND(0) = 'DECIMAL' THEN

   3149 56 002315   040000 106400                    CMPC    fill='040'O
        56 002316   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 002317   000161 000005 55                 ADSC9   113                      cn=0,n=5
        56 002320   002325 600000 56                 TZE     s:3153
        56 002321   040000 106400                    CMPC    fill='040'O
        56 002322   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 002323   000157 000007 55                 ADSC9   111                      cn=0,n=7
        56 002324   002431 601000 56                 TNZ     s:3178

     1115     3150    4              DO;

     1116     3151                     %VFD1;

   3153 56 002325   200257 236100                    LDQ     CD,,AUTO
        56 002326   000036 772000                    QRL     30
        56 002327   000000 235003                    LDA     0,DU
        56 002330   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002331   000100 301500                    BTD
        56 002332   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002333   200261 030012                    NDSC9   CODE,,AUTO               cn=0,s=nosgn,sf=0,n=10

   3154 56 002334   200243 470500                    LDP0    @FWBOT,,AUTO
        56 002335   040100 100400                    MLR     fill='040'O
        56 002336   000245 000020 55                 ADSC9   165                      cn=0,n=16
        56 002337   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16
        56 002340   040100 100500                    MLR     fill='040'O
        56 002341   200261 000012                    ADSC9   CODE,,AUTO               cn=0,n=10
        56 002342   000004 000012                    ADSC9   4,,PR0                   cn=0,n=10
        56 002343   040100 100400                    MLR     fill='040'O
        56 002344   000251 000023 55                 ADSC9   169                      cn=0,n=19
        56 002345   000006 400023                    ADSC9   6,,PR0                   cn=2,n=19
        56 002346   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:173  
        56 002347   001472 600036 52                 ADSC9   P_CODE+26                cn=3,n=30
        56 002350   000013 200036                    ADSC9   11,,PR0                  cn=1,n=30
        56 002351   040100 100400                    MLR     fill='040'O
        56 002352   000256 000007 55                 ADSC9   174                      cn=0,n=7
        56 002353   000022 600055                    ADSC9   18,,PR0                  cn=3,n=45

     1117     3158    4                IF P_CODE.OPERAND(0) = 'OCTAL' THEN

   3158 56 002354   040000 106400                    CMPC    fill='040'O
        56 002355   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 002356   000161 000005 55                 ADSC9   113                      cn=0,n=5
        56 002357   002405 601000 56                 TNZ     s:3169

     1118     3159                       %VFD2;

   3161 56 002360   000027 236000 57                 LDQ     23
        56 002361   200272 756100                    STQ     @OCTCHAR,,AUTO
        56 002362   200254 630500                    EPPR0   VFD_WORD,,AUTO
        56 002363   200271 450500                    STP0    @OCTNUM,,AUTO
        56 002364   001723 701000 56                 TSX1    OCTBIN
        56 002365   000000 011000                    NOP     0

   3162 56 002366   200254 235100                    LDA     VFD_WORD,,AUTO
        56 002367   000022 771000                    ARL     18
        56 002370   000044 773000                    LRL     36
        56 002371   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002372   000100 301500                    BTD
        56 002373   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002374   200251 030012                    NDSC9   TSWTOP,,AUTO             cn=0,s=nosgn,sf=0,n=10

   3163 56 002375   200254 236100                    LDQ     VFD_WORD,,AUTO
        56 002376   777777 376007                    ANQ     -1,DL
        56 002377   000000 235003                    LDA     0,DU
        56 002400   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002401   000100 301500                    BTD
        56 002402   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002403   200246 030012                    NDSC9   TSWBOT,,AUTO             cn=0,s=nosgn,sf=0,n=10
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:174  

   3164 56 002404   002534 710000 56                 TRA     s:3200

     1119     3166    4                ELSE
     1120     3167                        %VFD3;

   3169 56 002405   000100 305400                    DTB
        56 002406   001453 630036 52                 NDSC9   P_CODE+11                cn=3,s=nosgn,sf=0,n=30
        56 002407   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002410   200277 235100                    LDA     CNT2+3,,AUTO
        56 002411   200254 755100                    STA     VFD_WORD,,AUTO

   3170 56 002412   200254 236100                    LDQ     VFD_WORD,,AUTO
        56 002413   000022 772000                    QRL     18
        56 002414   000000 235003                    LDA     0,DU
        56 002415   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002416   000100 301500                    BTD
        56 002417   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002420   200251 030012                    NDSC9   TSWTOP,,AUTO             cn=0,s=nosgn,sf=0,n=10

   3171 56 002421   200254 236100                    LDQ     VFD_WORD,,AUTO
        56 002422   777777 376007                    ANQ     -1,DL
        56 002423   000000 235003                    LDA     0,DU
        56 002424   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002425   000100 301500                    BTD
        56 002426   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002427   200246 030012                    NDSC9   TSWBOT,,AUTO             cn=0,s=nosgn,sf=0,n=10

     1121     3174    4              END;

   3174 56 002430   002534 710000 56                 TRA     s:3200

     1122     3175    4              ELSE DO;

     1123     3176                     %VFD5;

   3178 56 002431   200257 236100                    LDQ     CD,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:175  
        56 002432   000036 772000                    QRL     30
        56 002433   000000 235003                    LDA     0,DU
        56 002434   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002435   000100 301500                    BTD
        56 002436   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002437   200261 030012                    NDSC9   CODE,,AUTO               cn=0,s=nosgn,sf=0,n=10

   3179 56 002440   200243 470500                    LDP0    @FWBOT,,AUTO
        56 002441   040100 100400                    MLR     fill='040'O
        56 002442   000245 000020 55                 ADSC9   165                      cn=0,n=16
        56 002443   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16
        56 002444   040100 100500                    MLR     fill='040'O
        56 002445   200261 000012                    ADSC9   CODE,,AUTO               cn=0,n=10
        56 002446   000004 000012                    ADSC9   4,,PR0                   cn=0,n=10
        56 002447   040100 100400                    MLR     fill='040'O
        56 002450   000251 000023 55                 ADSC9   169                      cn=0,n=19
        56 002451   000006 400023                    ADSC9   6,,PR0                   cn=2,n=19
        56 002452   040100 100400                    MLR     fill='040'O
        56 002453   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 002454   000013 200036                    ADSC9   11,,PR0                  cn=1,n=30
        56 002455   040100 100400                    MLR     fill='040'O
        56 002456   000260 000012 55                 ADSC9   176                      cn=0,n=10
        56 002457   000022 600055                    ADSC9   18,,PR0                  cn=3,n=45

     1124     3183    4                IF P_CODE.OPERAND(2) = 'OCTAL' THEN

   3183 56 002460   040000 106400                    CMPC    fill='040'O
        56 002461   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 002462   000161 000005 55                 ADSC9   113                      cn=0,n=5
        56 002463   002511 601000 56                 TNZ     s:3194

     1125     3184                        %VFD6;

   3186 56 002464   000030 236000 57                 LDQ     24
        56 002465   200272 756100                    STQ     @OCTCHAR,,AUTO
        56 002466   200254 630500                    EPPR0   VFD_WORD,,AUTO
        56 002467   200271 450500                    STP0    @OCTNUM,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:176  
        56 002470   001723 701000 56                 TSX1    OCTBIN
        56 002471   000000 011000                    NOP     0

   3187 56 002472   200254 235100                    LDA     VFD_WORD,,AUTO
        56 002473   000022 771000                    ARL     18
        56 002474   000044 773000                    LRL     36
        56 002475   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002476   000100 301500                    BTD
        56 002477   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002500   200251 030012                    NDSC9   TSWTOP,,AUTO             cn=0,s=nosgn,sf=0,n=10

   3188 56 002501   200254 236100                    LDQ     VFD_WORD,,AUTO
        56 002502   777777 376007                    ANQ     -1,DL
        56 002503   000000 235003                    LDA     0,DU
        56 002504   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002505   000100 301500                    BTD
        56 002506   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002507   200246 030012                    NDSC9   TSWBOT,,AUTO             cn=0,s=nosgn,sf=0,n=10

   3189 56 002510   002534 710000 56                 TRA     s:3200

     1126     3191    4                ELSE
     1127     3192                        %VFD7;

   3194 56 002511   000100 305400                    DTB
        56 002512   001472 630036 52                 NDSC9   P_CODE+26                cn=3,s=nosgn,sf=0,n=30
        56 002513   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002514   200277 235100                    LDA     CNT2+3,,AUTO
        56 002515   200254 755100                    STA     VFD_WORD,,AUTO

   3195 56 002516   200254 236100                    LDQ     VFD_WORD,,AUTO
        56 002517   000022 772000                    QRL     18
        56 002520   000000 235003                    LDA     0,DU
        56 002521   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002522   000100 301500                    BTD
        56 002523   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002524   200251 030012                    NDSC9   TSWTOP,,AUTO             cn=0,s=nosgn,sf=0,n=10
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:177  

   3196 56 002525   200254 236100                    LDQ     VFD_WORD,,AUTO
        56 002526   777777 376007                    ANQ     -1,DL
        56 002527   000000 235003                    LDA     0,DU
        56 002530   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002531   000100 301500                    BTD
        56 002532   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002533   200246 030012                    NDSC9   TSWBOT,,AUTO             cn=0,s=nosgn,sf=0,n=10

     1128     3199    4              END;

     1129     3200    3         CALL CONCAT(SWTOP,TSWTOP,',');

   3200 56 002534   200244 470500                    LDP0    @SWTOP,,AUTO
        56 002535   040100 100500                    MLR     fill='040'O
        56 002536   200251 000012                    ADSC9   TSWTOP,,AUTO             cn=0,n=10
        56 002537   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10
        56 002540   040100 100400                    MLR     fill='040'O
        56 002541   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 002542   000002 400156                    ADSC9   2,,PR0                   cn=2,n=110

     1130     3201    3         CALL CONCAT(SWBOT,TSWBOT,',');

   3201 56 002543   200245 470500                    LDP0    @SWBOT,,AUTO
        56 002544   040100 100500                    MLR     fill='040'O
        56 002545   200246 000012                    ADSC9   TSWBOT,,AUTO             cn=0,n=10
        56 002546   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10
        56 002547   040100 100400                    MLR     fill='040'O
        56 002550   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 002551   000002 400156                    ADSC9   2,,PR0                   cn=2,n=110

     1131     3202    3          END;

   3202 56 002552   002640 710000 56                 TRA     s:3224

     1132     3203    3        ELSE DO;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:178  
     1133     3204               %VFD4;

   3206 56 002553   200257 236100                    LDQ     CD,,AUTO
        56 002554   000036 772000                    QRL     30
        56 002555   000000 235003                    LDA     0,DU
        56 002556   200276 757100                    STAQ    CNT2+2,,AUTO
        56 002557   000100 301500                    BTD
        56 002560   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 002561   200261 030012                    NDSC9   CODE,,AUTO               cn=0,s=nosgn,sf=0,n=10

   3207 56 002562   200243 470500                    LDP0    @FWBOT,,AUTO
        56 002563   040100 100400                    MLR     fill='040'O
        56 002564   000263 000021 55                 ADSC9   179                      cn=0,n=17
        56 002565   000000 000021                    ADSC9   0,,PR0                   cn=0,n=17
        56 002566   040100 100500                    MLR     fill='040'O
        56 002567   200261 000012                    ADSC9   CODE,,AUTO               cn=0,n=10
        56 002570   000004 200012                    ADSC9   4,,PR0                   cn=1,n=10
        56 002571   040100 100400                    MLR     fill='040'O
        56 002572   000251 000023 55                 ADSC9   169                      cn=0,n=19
        56 002573   000006 600023                    ADSC9   6,,PR0                   cn=3,n=19
        56 002574   040100 100400                    MLR     fill='040'O
        56 002575   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 002576   000013 400112                    ADSC9   11,,PR0                  cn=2,n=74

   3209 56 002577   200243 470500                    LDP0    @FWBOT,,AUTO
        56 002600   040100 100400                    MLR     fill='040'O
        56 002601   000270 000022 55                 ADSC9   184                      cn=0,n=18
        56 002602   000016 400022                    ADSC9   14,,PR0                  cn=2,n=18
        56 002603   040100 100400                    MLR     fill='040'O
        56 002604   001472 600036 52                 ADSC9   P_CODE+26                cn=3,n=30
        56 002605   000023 000036                    ADSC9   19,,PR0                  cn=0,n=30
        56 002606   040100 100400                    MLR     fill='040'O
        56 002607   000256 000007 55                 ADSC9   174                      cn=0,n=7
        56 002610   000032 400016                    ADSC9   26,,PR0                  cn=2,n=14

     1134     3213               %VFD8;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:179  
   3215 56 002611   040000 106400                    CMPC    fill='040'O
        56 002612   001502 200036 52                 ADSC9   P_CODE+34                cn=1,n=30
        56 002613   000027 000036 55                 ADSC9   23                       cn=0,n=30
        56 002614   002630 600000 56                 TZE     s:3218

   3216 56 002615   200244 470500                    LDP0    @SWTOP,,AUTO
        56 002616   040100 100400                    MLR     fill='040'O
        56 002617   000032 000001 57                 ADSC9   26                       cn=0,n=1
        56 002620   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        56 002621   040100 100400                    MLR     fill='040'O
        56 002622   001502 200036 52                 ADSC9   P_CODE+34                cn=1,n=30
        56 002623   000000 200036                    ADSC9   0,,PR0                   cn=1,n=30
        56 002624   040100 100400                    MLR     fill='040'O
        56 002625   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 002626   000007 600131                    ADSC9   7,,PR0                   cn=3,n=89
        56 002627   002634 710000 56                 TRA     s:3219

   3218 56 002630   200244 470500                    LDP0    @SWTOP,,AUTO
        56 002631   040100 100400                    MLR     fill='040'O
        56 002632   000275 000002 55                 ADSC9   189                      cn=0,n=2
        56 002633   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120

   3219 56 002634   200245 470500                    LDP0    @SWBOT,,AUTO
        56 002635   040100 100400                    MLR     fill='040'O
        56 002636   000275 000002 55                 ADSC9   189                      cn=0,n=2
        56 002637   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120

     1135     3222
     1136     3223    3        END;

     1137     3224    2    END HANDLE_PC_UTILITIES;

   3224 56 002640   200242 221300                    LDX1  ! @LEN,,AUTO
        56 002641   000001 702211                    TSX2  ! 1,X1

     1138     3225         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:180  
     1139     3226
     1140     3227    1    GET_VALUE_OF_OPCODE : PROC(OPCODE,OPCODE_VALUE,POS);

   3227 56 002642   200254 741300       GET_VALUE_O* STX1  ! VFD_WORD,,AUTO

     1141     3228         /*I*
     1142     3229              NAME:   GET_VALUE_OF_OPCODE
     1143     3230              PURPOSE:
     1144     3231                   Find the bit value of the opcode from an assembly instruction
     1145     3232                   in a GENI directive.
     1146     3233              CALL:
     1147     3234                   CALL GET_VALUE_OF_OPCODE(OPCODE,OPCODE_VALUE,POS);
     1148     3235              PARAMETERS:
     1149     3236                   OPCODE
     1150     3237                     The opcode as it appears in the source.
     1151     3238                   OPCODE_VALUE
     1152     3239                     The bit value of the opcode from the opcode table.
     1153     3240                   POS
     1154     3241                     The position of the opcode in the opcode table.
     1155     3242              DATA:
     1156     3243                   OCPODE_TABLE
     1157     3244              DESCRIPTION:
     1158     3245                   Search the opcode table for an occurrence of OPCODE.
     1159     3246                   Return the binary value of the opcode from the table.
     1160     3247                   If not found return a value of zero and call Z8PA$ERROR_PROC.
     1161     3248         */
     1162     3249
     1163     3250    2        DCL OPCODE CHAR(5);
     1164     3251    2        DCL OPCODE_VALUE BIT(9) ALIGNED;
     1165     3252    2        DCL OPCODE_WORD UBIN;
     1166     3253    2        DCL POS SBIN;
     1167     3254
     1168     3255
     1169     3256    2        POS = 0;

   3256 56 002643   200257 470500                    LDP0    @POS,,AUTO
        56 002644   000000 450100                    STZ     0,,PR0
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:181  

     1170     3257
     1171     3258    3        DO WHILE((OPCODE ~= OPCODE_TABLE.NAME(POS)) AND

   3258 56 002645   002650 710000 56                 TRA     s:3261

     1172     3259    3                 (OPCODE_TABLE.NAME(POS) ~= %LAST_OP_IN_TABLE));
     1173     3260    3          POS = POS + 1;

   3260 56 002646   200257 470500                    LDP0    @POS,,AUTO
        56 002647   000000 054100                    AOS     0,,PR0

     1174     3261    3        END;

   3261 56 002650   000000 236100                    LDQ     0,,PR0
        56 002651   000006 402007                    MPY     6,DL
        56 002652   200255 471500                    LDP1    @OPCODE,,AUTO
        56 002653   040006 106500                    CMPC    fill='040'O
        56 002654   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5
        56 002655   000000 000005 52                 ADSC9   OPCODE_TABLE,Q           cn=0,n=5
        56 002656   002663 600000 56                 TZE     s:3263
        56 002657   040000 106406                    CMPC    fill='040'O
        56 002660   000000 000005 52                 ADSC9   OPCODE_TABLE,Q           cn=0,n=5
        56 002661   000276 000003 55                 ADSC9   190                      cn=0,n=3
        56 002662   002646 601000 56                 TNZ     s:3260

     1175     3262
     1176     3263    2        IF (OPCODE ~= %LAST_OP_IN_TABLE) AND

   3263 56 002663   040000 106500                    CMPC    fill='040'O
        56 002664   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5
        56 002665   000276 000003 55                 ADSC9   190                      cn=0,n=3
        56 002666   002702 600000 56                 TZE     s:3270
        56 002667   040000 106406                    CMPC    fill='040'O
        56 002670   000000 000005 52                 ADSC9   OPCODE_TABLE,Q           cn=0,n=5
        56 002671   000276 000003 55                 ADSC9   190                      cn=0,n=3
        56 002672   002702 601000 56                 TNZ     s:3270
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:182  

     1177     3264    2             (OPCODE_TABLE.NAME(POS) = %LAST_OP_IN_TABLE) THEN
     1178     3265    3          DO;

     1179     3266    3            CALL Z8PA$ERROR_PROC(%MESS1);

   3266 56 002673   000033 630400 57                 EPPR0   27
        56 002674   000006 631400 57                 EPPR1   6
        56 002675   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 002676   000000 011000                    NOP     0

     1180     3267    3            OPCODE_VALUE = '000000000'B;

   3267 56 002677   200256 470500                    LDP0    @OPCODE_VALUE,,AUTO
        56 002700   000000 450100                    STZ     0,,PR0

     1181     3268    3          END;

   3268 56 002701   002706 710000 56                 TRA     s:3271

     1182     3269    2        ELSE
     1183     3270    2          OPCODE_VALUE = OPCODE_TABLE.VALUE(POS);

   3270 56 002702   200256 473500                    LDP3    @OPCODE_VALUE,,AUTO
        56 002703   000100 100406                    MLR     fill='000'O
        56 002704   000001 200001 52                 ADSC9   OPCODE_TABLE+1,Q         cn=1,n=1
        56 002705   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

     1184     3271    2    END GET_VALUE_OF_OPCODE;

   3271 56 002706   200254 221300                    LDX1  ! VFD_WORD,,AUTO
        56 002707   000001 702211                    TSX2  ! 1,X1

     1185     3272
     1186     3273         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:183  
     1187     3274    1    SEARCH_TAG_TABLE : PROC(GOAL,POSITION,TAG_VAL);

   3274 56 002710   200270 741300       SEARCH_TAG_* STX1  ! @OPN,,AUTO

     1188     3275         /*I*
     1189     3276              NAME: SEARCH_TAG_TABLE.
     1190     3277              PURPOSE:
     1191     3278                   Determine the tag designator of the tag field and modification
     1192     3279                   field of a machine instruction being generated from a
     1193     3280                   GENI directive.
     1194     3281              CALL:
     1195     3282                   CALL SEARCH_TAG_TABLE(GOAL,POSITION,TAG_VAL);
     1196     3283              PARAMETERS:
     1197     3284                   GOAL
     1198     3285                     Address modification type from source.
     1199     3286                   POSITION
     1200     3287                     An output parameter giving the position of the GOAL in the
     1201     3288                     tag table.
     1202     3289                   TAG_VAL
     1203     3290                     Bit value of the tag designator that can be ORed with
     1204     3291                     the second half of the machine  word.
     1205     3292              DATA:
     1206     3293                   None.
     1207     3294              DESCRIPTION:
     1208     3295                   Search the TAG_MOD_TABLE for an occurrence of GOAL.  If found
     1209     3296                   return its value and position, else return a value of zero
     1210     3297                   and call Z8PA$ERROR_PROC.
     1211     3298         */
     1212     3299
     1213     3300             %EQU TAG_MOD_TABLE_LEN = 28;
     1214     3301    2        DCL 1 TAG_MOD_TABLE(0:%TAG_MOD_TABLE_LEN) STATIC,
     1215     3302    2         2 NAME CHAR(3) INIT(' ','N','AU','QU','DU','IC','AL',
     1216     3303    2                             'QL','DL','0','1','2','3','4','5','6','7',
     1217     3304    2                            'F','CI','I','SC','AD','DI','DIC','ID','IDC','SD','A','Q')
              3304                                      ,
     1218     3305    2         2 VALUE BIT(18) INIT('000000'O,'000000'O,'000001'O,'000002'O,'000003'O,
     1219     3306    2                              '000004'O,'000005'O,'000006'O,'000007'O,'000010'O,
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:184  
     1220     3307    2                              '000011'O,'000012'O,'000013'O,'000014'O,'000015'O,
     1221     3308    2                              '000016'O,'000017'O,'000040'O,'000050'O,'000051'O,
     1222     3309    2                              '000052'O,'000053'O,'000054'O,'000055'O,'000056'O,
     1223     3310    2                              '000057'O,'000044'O,'000005'O,'000006'O);
     1224     3311    2        DCL GOAL CHAR(3);
     1225     3312    2        DCL POSITION SBIN;
     1226     3313    2        DCL TAG_VAL BIT(18) ALIGNED;
     1227     3314
     1228     3315    2        POSITION = 0;

   3315 56 002711   200272 470500                    LDP0    @POSITION,,AUTO
        56 002712   000000 450100                    STZ     0,,PR0

     1229     3316    3        DO WHILE((TAG_MOD_TABLE.NAME(POSITION) ~= GOAL) AND (POSITION <= %
              3316                 TAG_MOD_TABLE_LEN));

   3316 56 002713   002716 710000 56                 TRA     s:3318

     1230     3317    3          POSITION = POSITION + 1;

   3317 56 002714   200272 470500                    LDP0    @POSITION,,AUTO
        56 002715   000000 054100                    AOS     0,,PR0

     1231     3318    3        END;

   3318 56 002716   000000 236100                    LDQ     0,,PR0
        56 002717   000005 402007                    MPY     5,DL
        56 002720   200271 471500                    LDP1    @GOAL,,AUTO
        56 002721   040100 106406                    CMPC    fill='040'O
        56 002722   001543 000003 52                 ADSC9   TAG_MOD_TABLE,Q          cn=0,n=3
        56 002723   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3
        56 002724   002730 600000 56                 TZE     s:3320
        56 002725   000000 235100                    LDA     0,,PR0
        56 002726   000034 115007                    CMPA    28,DL
        56 002727   002714 604400 56                 TMOZ    s:3317

     1232     3319
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:185  
     1233     3320    2        IF POSITION > %TAG_MOD_TABLE_LEN THEN

   3320 56 002730   000000 235100                    LDA     0,,PR0
        56 002731   000034 115007                    CMPA    28,DL
        56 002732   002745 604400 56                 TMOZ    s:3327

     1234     3321    3          DO;

     1235     3322    3            CALL Z8PA$ERROR_PROC(%MESS2);

   3322 56 002733   000034 630400 57                 EPPR0   28
        56 002734   000006 631400 57                 EPPR1   6
        56 002735   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 002736   000000 011000                    NOP     0

     1236     3323    3            POSITION = 0;

   3323 56 002737   200272 470500                    LDP0    @POSITION,,AUTO
        56 002740   000000 450100                    STZ     0,,PR0

     1237     3324    3            TAG_VAL = '000000000000000000'B;

   3324 56 002741   000000 220003                    LDX0    0,DU
        56 002742   200273 471500                    LDP1    @TAG_VAL,,AUTO
        56 002743   100000 740100                    STX0    0,,PR1

     1238     3325    3          END;

   3325 56 002744   002751 710000 56                 TRA     s:3329

     1239     3326    2        ELSE
     1240     3327    2          TAG_VAL = TAG_MOD_TABLE.VALUE(POSITION);

   3327 56 002745   200273 473500                    LDP3    @TAG_VAL,,AUTO
        56 002746   000100 100406                    MLR     fill='000'O
        56 002747   001543 600002 52                 ADSC9   TAG_MOD_TABLE,Q          cn=3,n=2
        56 002750   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:186  

     1241     3328
     1242     3329    2    END SEARCH_TAG_TABLE;

   3329 56 002751   200270 221300                    LDX1  ! @OPN,,AUTO
        56 002752   000001 702211                    TSX2  ! 1,X1

     1243     3330
     1244     3331         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:187  
     1245     3332
     1246     3333    1    BINBIN : PROC (NUM,BIN_CHAR);

   3333 56 002753   200240 741300       BINBIN       STX1  ! SHIFT_FACTOR+2,,AUTO

     1247     3334         /*I*
     1248     3335              NAME: BINBIN
     1249     3336              PURPOSE:
     1250     3337                   Convert the character representation of a binary number to  UBIN word.
     1251     3338              CALL:
     1252     3339                   CALL BINBIN(NUM,BIN_CHAR);
     1253     3340              PARAMETERS:
     1254     3341                   NUM
     1255     3342                     An output parameter returning the UBIN value of the binary number.
     1256     3343                   BIN_CHAR
     1257     3344                     An input parameter giving the 12 character representation
     1258     3345                     of a binary number.
     1259     3346              DATA:
     1260     3347                   None.
     1261     3348              DESCRIPTION:
     1262     3349                   Use the redef facility to redefine the parameters as arrays.
     1263     3350                   Step through the input array, if a character is one then place
     1264     3351                   a one in the corresponding position in the output array.
     1265     3352         */
     1266     3353    2        DCL NUM UBIN WORD;
     1267     3354    2        DCL NUM_T (0:35) REDEF NUM BIT(1);
     1268     3355    2        DCL BIN_CHAR CHAR(%OPERAND_LEN);
     1269     3356    2        DCL BIN_CHAR_T (0:%(OPERAND_LEN - 1)) REDEF BIN_CHAR CHAR(1);
     1270     3357    2        DCL CNT SBIN;
     1271     3358
     1272     3359    2        NUM = 0;

   3359 56 002754   200241 470500                    LDP0    @NUM,,AUTO
        56 002755   000000 450100                    STZ     0,,PR0

     1273     3360    3        DO CNT = 0 TO 11;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:188  
   3360 56 002756   200243 450100                    STZ     CNT,,AUTO

     1274     3361    3          IF BIN_CHAR_T(CNT) ~= ' ' THEN

   3361 56 002757   200242 470500                    LDP0    @BIN_CHAR,,AUTO
        56 002760   200243 235100                    LDA     CNT,,AUTO
        56 002761   040000 106505                    CMPC    fill='040'O
        56 002762   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        56 002763   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 002764   003000 600000 56                 TZE     s:3364

     1275     3362    3            IF BIN_CHAR_T(CNT) = '1' THEN

   3362 56 002765   040000 106505                    CMPC    fill='040'O
        56 002766   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        56 002767   000035 000001 57                 ADSC9   29                       cn=0,n=1
        56 002770   003000 601000 56                 TNZ     s:3364

     1276     3363    3              NUM_T(35-CNT) = '1'B;

   3363 56 002771   000000 531000                    NEG     0
        56 002772   002774 605000 56                 TPL     s:3363+3
        56 002773   000044 035003                    ADLA    36,DU
        56 002774   200241 471500                    LDP1    @NUM,,AUTO
        56 002775   003105 060400                    CSL     bolr='003'O
        56 002776   000036 000001 57                 BDSC    30                       by=0,bit=0,n=1
        56 002777   100000 700001                    BDSC    0,A,PR1                  by=3,bit=8,n=1

     1277     3364    3        END;

   3364 56 003000   200243 054100                    AOS     CNT,,AUTO
        56 003001   200243 235100                    LDA     CNT,,AUTO
        56 003002   000013 115007                    CMPA    11,DL
        56 003003   002757 604400 56                 TMOZ    s:3361

     1278     3365    2    END BINBIN;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:189  
   3365 56 003004   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 003005   000001 702211                    TSX2  ! 1,X1

     1279     3366
     1280     3367         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:190  
     1281     3368    1    GEN_SIMPLE_INST : PROC(OPCODE,OPND1,OPND2,TAG_TYPE,UPPER_HALF,LOWER_HALF);

   3368 56 003006   200242 741300       GEN_SIMPLE_* STX1  ! @BIN_CHAR,,AUTO
        56 003007   003122 710000 56                 TRA     s:3471

     1282     3369         /*I*
     1283     3370              NAME: GEN_SIMPLE_INST
     1284     3371              PURPOSE:
     1285     3372                   Generate sinqle word machine instructions from the assembly
     1286     3373                   language found in a GENI directive.
     1287     3374              CALL:
     1288     3375                   CALL
     1289     3376                   GEN_SIMPLE_INST(OPCODE,OPND1,OPND2,TAG_TYPE,UPPER_HALF,LOWER_HALF);
     1290     3377              PARAMETERS:
     1291     3378                   OPCODE
     1292     3379                     Opcode mneumonic from the GENI.
     1293     3380                   OPND1
     1294     3381                     First operand of the assembly instruction.
     1295     3382                   OPND2
     1296     3383                     Second operand of the assembly instruction.
     1297     3384                   TAG_TYPE
     1298     3385                     Either 'RI' or 'IR' or blank to indicate type of addressing.
     1299     3386                   UPPER_HALF
     1300     3387                     An output parameter giving the bit value of the upper half of the
     1301     3388                     machine  word.
     1302     3389                   LOWER_HALF
     1303     3390                     The lower half of the machine word generated.
     1304     3391              DATA:
     1305     3392                   None.
     1306     3393              DESCRIPTION:
     1307     3394                   Generate single word instructions for GENI directives (including
     1308     3395                   single word eis instructions).
     1309     3396         */
     1310     3397
     1311     3398
     1312     3399    2        DCL OPCODE CHAR(5);   /* UNCHANGED FROM SOURCE */
     1313     3400    2        DCL OPND1 UBIN(18);       /* FIRST OPERAND ENCOUNTERED IN SOURCE */
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:191  
     1314     3401    2        DCL OPND2 CHAR(3);    /* SECOND OPERAND WITH * ETC REMOVED */
     1315     3402    2        DCL TAG_TYPE CHAR(2); /* EITHER 'R', 'RI', 'IR' OR 'IT' */
     1316     3403    2        DCL UPPER_HALF BIT(18) ALIGNED; /* UPPER HALF OF OBJECT MACHINE WORD */
     1317     3404    2        DCL LOWER_HALF BIT(18) ALIGNED; /* LOWER HALF OF MACHINE WORD */
     1318     3405    2        DCL 1 LH_OUT REDEF LOWER_HALF ALIGNED,
     1319     3406    2          2 OPCODE_FIELD BIT(9) UNAL,
     1320     3407    2          2 THE_REST BIT(9) UNAL;
     1321     3408    2        DCL OPCODE_VALUE BIT(9) ALIGNED;
              3408                 /*  BINARY VALUE OF OPCODE FROM OPCODE TABLE */
     1322     3409    2        DCL POS_IN_OPCODE_TABLE SBIN;
     1323     3410    2        DCL YFIELD  UBIN WORD;  /* USED TO CONVERT OPND1 TO Y FIELD OF MACHINE WORD */
     1324     3411
     1325     3412
     1326     3413
     1327     3414
     1328     3415
     1329     3416
     1330     3417             %MACRO PUT_IN_OPCODE;
     1331     3418             CALL GET_VALUE_OF_OPCODE(OPCODE,OPCODE_VALUE,POS_IN_OPCODE_TABLE);
     1332     3419             LH_OUT.OPCODE_FIELD = OPCODE_VALUE;
     1333     3420             %MEND;
     1334     3421
     1335     3422
     1336     3423             %MACRO PUT_IN_EIS_BIT;
     1337     3424             IF POS_IN_OPCODE_TABLE > %LAST_NON_EIS_INST THEN
     1338     3425               LOWER_HALF = LOWER_HALF | '000400'O;
     1339     3426             %MEND;
     1340     3427
     1341     3428
     1342     3429
     1343     3430             %MACRO PUT_IN_YFIELD;
     1344     3431             UPPER_HALF = BINBIT(OPND1,18);
     1345     3432             %MEND;
     1346     3433
     1347     3434
     1348     3435             %MACRO CLEAR_UPPER_AND_LOWER;
     1349     3436             UPPER_HALF = '000000'O;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:192  
     1350     3437             LOWER_HALF = '000000'O;
     1351     3438             %MEND;
     1352     3439
     1353     3440
     1354     3441    2        SET_TAG_FIELD : PROC;

   3441 56 003010   200254 741300       SET_TAG_FIE* STX1  ! VFD_WORD,,AUTO

     1355     3442
     1356     3443               /* Determine and set the TAG FIELD using TAG_TYPE and OPND2 */
     1357     3444
     1358     3445    3          DCL OCTNUM CHAR(%OPERAND_LEN);
     1359     3446    3          DCL BINRES UBIN WORD;
     1360     3447    3          DCL CNT SBIN;
     1361     3448    3          DCL TAG_VAL BIT(18) ALIGNED;
     1362     3449
     1363     3450    3          IF TAG_TYPE = 'RI' THEN

   3450 56 003011   200246 470500                    LDP0    @TAG_TYPE,,AUTO
        56 003012   040000 106500                    CMPC    fill='040'O
        56 003013   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
        56 003014   000335 000002 55                 ADSC9   221                      cn=0,n=2
        56 003015   003022 601000 56                 TNZ     s:3452

     1364     3451    3           LOWER_HALF = LOWER_HALF |  '000020'O;

   3451 56 003016   200250 471500                    LDP1    @LOWER_HALF,,AUTO
        56 003017   100000 220100                    LDX0    0,,PR1
        56 003020   000020 260003                    ORX0    16,DU
        56 003021   100000 740100                    STX0    0,,PR1

     1365     3452    3          IF TAG_TYPE = 'IR' THEN

   3452 56 003022   040000 106500                    CMPC    fill='040'O
        56 003023   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
        56 003024   000336 000002 55                 ADSC9   222                      cn=0,n=2
        56 003025   003032 601000 56                 TNZ     s:3454
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:193  

     1366     3453    3           LOWER_HALF = LOWER_HALF | '000060'O;

   3453 56 003026   200250 471500                    LDP1    @LOWER_HALF,,AUTO
        56 003027   100000 220100                    LDX0    0,,PR1
        56 003030   000060 260003                    ORX0    48,DU
        56 003031   100000 740100                    STX0    0,,PR1

     1367     3454    4          DO SELECT(OPCODE);

   3454 56 003032   200243 471500                    LDP1    @OPCODE,,AUTO
        56 003033   040000 106500                    CMPC    fill='040'O
        56 003034   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5
        56 003035   000337 000004 55                 ADSC9   223                      cn=0,n=4
        56 003036   003045 602000 56                 TNC     s:3454+11
        56 003037   003057 600000 56                 TZE     s:3456
        56 003040   040000 106500                    CMPC    fill='040'O
        56 003041   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5
        56 003042   000340 000004 55                 ADSC9   224                      cn=0,n=4
        56 003043   003104 601000 56                 TNZ     s:3461
        56 003044   003057 710000 56                 TRA     s:3456
        56 003045   040000 106500                    CMPC    fill='040'O
        56 003046   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5
        56 003047   000341 000004 55                 ADSC9   225                      cn=0,n=4
        56 003050   003104 602000 56                 TNC     s:3461
        56 003051   003057 600000 56                 TZE     s:3456
        56 003052   040000 106500                    CMPC    fill='040'O
        56 003053   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5
        56 003054   000342 000004 55                 ADSC9   226                      cn=0,n=4
        56 003055   003104 601000 56                 TNZ     s:3461
        56 003056   003057 710000 56                 TRA     s:3456

     1368     3455    4            SELECT('STCA','STCQ','STBA','STBQ');

     1369     3456    4              OCTNUM = '000000000000';

   3456 56 003057   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:194  
        56 003060   000343 000014 55                 ADSC9   227                      cn=0,n=12
        56 003061   200255 000036                    ADSC9   OCTNUM,,AUTO             cn=0,n=30

     1370     3457    4              CALL INSERT(OCTNUM,%(OPERAND_LEN-2),2,SUBSTR(OPND2,0,2));

   3457 56 003062   200245 473500                    LDP3    @OPND2,,AUTO
        56 003063   040100 100500                    MLR     fill='040'O
        56 003064   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
        56 003065   200264 000002                    ADSC9   I,,AUTO                  cn=0,n=2

     1371     3458    4              CALL OCTBIN(BINRES,OCTNUM);

   3458 56 003066   200255 634500                    EPPR4   OCTNUM,,AUTO
        56 003067   200272 454500                    STP4    @POSITION,,AUTO
        56 003070   200265 635500                    EPPR5   BINRES,,AUTO
        56 003071   200271 455500                    STP5    @GOAL,,AUTO
        56 003072   001723 701000 56                 TSX1    OCTBIN
        56 003073   000000 011000                    NOP     0

     1372     3459    4              LOWER_HALF = LOWER_HALF | BINBIT(BINRES,18);

   3459 56 003074   200265 236100                    LDQ     BINRES,,AUTO
        56 003075   000022 736000                    QLS     18
        56 003076   000022 772000                    QRL     18
        56 003077   000000 620006                    EAX0    0,QL
        56 003100   200250 470500                    LDP0    @LOWER_HALF,,AUTO
        56 003101   000000 260100                    ORX0    0,,PR0
        56 003102   000000 740100                    STX0    0,,PR0
        56 003103   003120 710000 56                 TRA     s:3464

     1373     3460    4            SELECT(ELSE);

     1374     3461    4              CALL SEARCH_TAG_TABLE(OPND2,CNT,TAG_VAL);

   3461 56 003104   200267 633500                    EPPR3   TAG_VAL,,AUTO
        56 003105   200273 453500                    STP3    @TAG_VAL,,AUTO
        56 003106   200266 634500                    EPPR4   CNT,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:195  
        56 003107   200272 454500                    STP4    @POSITION,,AUTO
        56 003110   200245 236100                    LDQ     @OPND2,,AUTO
        56 003111   200271 756100                    STQ     @GOAL,,AUTO
        56 003112   002710 701000 56                 TSX1    SEARCH_TAG_TABLE
        56 003113   000000 011000                    NOP     0

     1375     3462    4              LOWER_HALF = LOWER_HALF | TAG_VAL;

   3462 56 003114   200250 470500                    LDP0    @LOWER_HALF,,AUTO
        56 003115   000000 220100                    LDX0    0,,PR0
        56 003116   200267 260100                    ORX0    TAG_VAL,,AUTO
        56 003117   000000 740100                    STX0    0,,PR0

     1376     3463    4          END;

     1377     3464    3        END SET_TAG_FIELD;

   3464 56 003120   200254 221300                    LDX1  ! VFD_WORD,,AUTO
        56 003121   000001 702211                    TSX2  ! 1,X1

     1378     3465
     1379     3466
     1380     3467
     1381     3468               /* BUILD THE INSTRUCTION */
     1382     3469
     1383     3470             %CLEAR_UPPER_AND_LOWER;

   3471 56 003122   000000 220003                    LDX0    0,DU
        56 003123   200247 470500                    LDP0    @UPPER_HALF,,AUTO
        56 003124   000000 740100                    STX0    0,,PR0

   3472 56 003125   200250 471500                    LDP1    @LOWER_HALF,,AUTO
        56 003126   100000 740100                    STX0    0,,PR1

     1384     3474    3        DO SELECT(OPCODE);

   3474 56 003127   200243 473500                    LDP3    @OPCODE,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:196  
        56 003130   040000 106500                    CMPC    fill='040'O
        56 003131   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003132   000346 000005 55                 ADSC9   230                      cn=0,n=5
        56 003133   003154 602000 56                 TNC     s:3474+21
        56 003134   003167 600000 56                 TZE     s:3475
        56 003135   040000 106500                    CMPC    fill='040'O
        56 003136   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003137   000350 000005 55                 ADSC9   232                      cn=0,n=5
        56 003140   003147 602000 56                 TNC     s:3474+16
        56 003141   003167 600000 56                 TZE     s:3475
        56 003142   040000 106500                    CMPC    fill='040'O
        56 003143   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003144   000352 000005 55                 ADSC9   234                      cn=0,n=5
        56 003145   003176 601000 56                 TNZ     s:3485
        56 003146   003167 710000 56                 TRA     s:3475
        56 003147   040000 106500                    CMPC    fill='040'O
        56 003150   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003151   000354 000005 55                 ADSC9   236                      cn=0,n=5
        56 003152   003176 601000 56                 TNZ     s:3485
        56 003153   003173 710000 56                 TRA     s:3481
        56 003154   040000 106500                    CMPC    fill='040'O
        56 003155   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003156   000356 000005 55                 ADSC9   238                      cn=0,n=5
        56 003157   003162 602000 56                 TNC     s:3474+27
        56 003160   003170 600000 56                 TZE     s:3478
        56 003161   003176 710000 56                 TRA     s:3485
        56 003162   040000 106500                    CMPC    fill='040'O
        56 003163   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003164   000360 000005 55                 ADSC9   240                      cn=0,n=5
        56 003165   003176 601000 56                 TNZ     s:3485
        56 003166   003173 710000 56                 TRA     s:3481

     1385     3475    3          SELECT('ADSC9','NDSC9','SDSC8');

   3475 56 003167   003225 710000 56                 TRA     s:3498

     1386     3476
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:197  
     1387     3477    3          SELECT('ADSC6');

     1388     3478    3            LOWER_HALF = '020000'O;

   3478 56 003170   020000 221003                    LDX1    8192,DU
        56 003171   100000 741100                    STX1    0,,PR1
        56 003172   003225 710000 56                 TRA     s:3498

     1389     3479
     1390     3480    3          SELECT('ADSC4','NDSC4');

     1391     3481    3            LOWER_HALF = '040000'O;

   3481 56 003173   040000 221003                    LDX1    16384,DU
        56 003174   100000 741100                    STX1    0,,PR1
        56 003175   003225 710000 56                 TRA     s:3498

     1392     3482
     1393     3483    3          SELECT(ELSE);

     1394     3484                 %PUT_IN_OPCODE;

   3485 56 003176   200252 634500                    EPPR4   POS_IN_OPCODE_TABLE,,AUTO
        56 003177   200257 454500                    STP4    @POS,,AUTO
        56 003200   200251 635500                    EPPR5   OPCODE_VALUE,,AUTO
        56 003201   200256 455500                    STP5    @OPCODE_VALUE,,AUTO
        56 003202   200243 236100                    LDQ     @OPCODE,,AUTO
        56 003203   200255 756100                    STQ     @OPCODE,,AUTO
        56 003204   002642 701000 56                 TSX1    GET_VALUE_OF_OPCODE
        56 003205   000000 011000                    NOP     0

   3486 56 003206   200250 470500                    LDP0    @LOWER_HALF,,AUTO
        56 003207   200251 236100                    LDQ     OPCODE_VALUE,,AUTO
        56 003210   000000 552140                    STBQ    0,'40'O,PR0

     1395     3488                 %PUT_IN_EIS_BIT;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:198  
   3489 56 003211   200252 235100                    LDA     POS_IN_OPCODE_TABLE,,AUTO
        56 003212   000547 115007                    CMPA    359,DL
        56 003213   003217 604400 56                 TMOZ    s:3493

   3490 56 003214   000000 220100                    LDX0    0,,PR0
        56 003215   000400 260003                    ORX0    256,DU
        56 003216   000000 740100                    STX0    0,,PR0

     1396     3492                 %PUT_IN_YFIELD;

   3493 56 003217   200244 471500                    LDP1    @OPND1,,AUTO
        56 003220   100000 220100                    LDX0    0,,PR1
        56 003221   200247 473500                    LDP3    @UPPER_HALF,,AUTO
        56 003222   300000 740100                    STX0    0,,PR3

     1397     3495    3            CALL SET_TAG_FIELD;

   3495 56 003223   003010 701000 56                 TSX1    SET_TAG_FIELD
        56 003224   000000 011000                    NOP     0

     1398     3496    3        END;

     1399     3497
     1400     3498    2    END GEN_SIMPLE_INST;

   3498 56 003225   200242 221300                    LDX1  ! @BIN_CHAR,,AUTO
        56 003226   000001 702211                    TSX2  ! 1,X1

     1401     3499         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:199  
     1402     3500
     1403     3501    1    GEN_EIS_INST : PROC(MODFIELDS,OPTIONAL_FIELDS,OPCODE,UPPER_HALF,LOWER_HALF);

   3501 56 003227   200242 741300       GEN_EIS_INST STX1  ! @BIN_CHAR,,AUTO

     1404     3502         /*I*
     1405     3503              NAME: GEN_EIS_INST
     1406     3504              PURPOSE:
     1407     3505                   Generate the machine instruction for the first word of a multi-word
     1408     3506                   eis instruction.
     1409     3507              CALL:
     1410     3508                   CALL
     1411     3509                   GEN_EIS_ISNT(MODFIELDS,OPTIONAL_FIELDS,OPCODE,UPPER_HALF,LOWER_HALF);
     1412     3510              PARAMETERS:
     1413     3511                   MODFIELDS
     1414     3512                     An array of structures describing the three possible modification
     1415     3513                     fields.
     1416     3514                   OPTIONAL_FIELDS
     1417     3515                     An array that contains the three possible optional fields
     1418     3516                     which will directly follow the modfields in the source.
     1419     3517                   OPCODE
     1420     3518                     The instruction opcode as it appears in the GENI directive.
     1421     3519                   UPPER_HALF
     1422     3520                     The upper 18 bits of the machine instruction that was generated.
     1423     3521                   LOWER_HALF
     1424     3522                     The lower 18 bits of the machine instruction that was generated.
     1425     3523              DATA:
     1426     3524                   None.
     1427     3525              DESCRIPTION:
     1428     3526                   Generate  the first word of a multi-word eis instruction.
     1429     3527         */
     1430     3528    2        DCL 1 MODFIELDS (0:2),
     1431     3529    2          2 BITS BIT(3),
     1432     3530    2          2 RNREG CHAR(3),
     1433     3531    2          2 EXISTS BIT(1);
     1434     3532    2        DCL OPCODE CHAR(5);
     1435     3533    2        DCL UPPER_HALF BIT(18) ALIGNED;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:200  
     1436     3534    2        DCL 1 UH_OUT  REDEF UPPER_HALF ALIGNED,
     1437     3535    2          2 BITS BIT(2) UNAL,
     1438     3536    2          2 MF3 BIT(7) UNAL ,
     1439     3537    2          2 BITS2 BIT(1) UNAL,
     1440     3538    2          2 RD_BIT BIT(1) UNAL,
     1441     3539    2          2 MF2 BIT(7) UNAL;
     1442     3540    2        DCL 1 UH_OUT2 REDEF UPPER_HALF ALIGNED,
     1443     3541    2          2 FILL BIT(9) UNAL,
     1444     3542    2          2 * BIT(9) UNAL;
     1445     3543    2        DCL 1 UH_OUT3 REDEF UPPER_HALF ALIGNED,
     1446     3544    2          2 * BIT(5) UNAL,
     1447     3545    2          2 BOLR BIT(4) UNAL,
     1448     3546    2          2 * BIT(9)  UNAL;
     1449     3547    2        DCL LOWER_HALF BIT(18) ALIGNED;
     1450     3548    2        DCL 1 LH_OUT REDEF LOWER_HALF ALIGNED,
     1451     3549    2          2 OPFIELD BIT(9) UNAL,
     1452     3550    2          2 EISBIT BIT(1) UNAL,
     1453     3551    2          2 INT BIT(1) UNAL,
     1454     3552    2          2 MF1 BIT(7) UNAL;
     1455     3553    2        DCL OPTIONAL_FIELDS (0:2) UBIN WORD;
     1456     3554    2        DCL OPCODE_VALUE BIT(9) ALIGNED;
     1457     3555    2        DCL POS SBIN;
     1458     3556    2        DCL 1 M_FIELD,
     1459     3557    2          2 BITS BIT(3) UNAL,
     1460     3558    2          2 REG BIT(4) UNAL;
     1461     3559    2        DCL M_OUT REDEF M_FIELD BIT(7);
     1462     3560    2        DCL TAG_VAL BIT(18) ALIGNED;
     1463     3561
     1464     3562
     1465     3563    2        UPPER_HALF = '000000'O;

   3563 56 003230   000000 220003                    LDX0    0,DU
        56 003231   200246 470500                    LDP0    @UPPER_HALF,,AUTO
        56 003232   000000 740100                    STX0    0,,PR0

     1466     3564    2        LOWER_HALF = UPPER_HALF;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:201  
   3564 56 003233   200247 471500                    LDP1    @LOWER_HALF,,AUTO
        56 003234   100000 740100                    STX0    0,,PR1

     1467     3565
     1468     3566    3        DO SELECT(OPCODE);

   3566 56 003235   200245 473500                    LDP3    @OPCODE,,AUTO
        56 003236   040000 106500                    CMPC    fill='040'O
        56 003237   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003240   000362 000003 55                 ADSC9   242                      cn=0,n=3
        56 003241   003352 602000 56                 TNC     s:3566+77
        56 003242   003525 600000 56                 TZE     s:3568
        56 003243   040000 106500                    CMPC    fill='040'O
        56 003244   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003245   000363 000004 55                 ADSC9   243                      cn=0,n=4
        56 003246   003313 602000 56                 TNC     s:3566+46
        56 003247   003540 600000 56                 TZE     s:3573
        56 003250   040000 106500                    CMPC    fill='040'O
        56 003251   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003252   000364 000003 55                 ADSC9   244                      cn=0,n=3
        56 003253   003274 602000 56                 TNC     s:3566+31
        56 003254   003525 600000 56                 TZE     s:3568
        56 003255   040000 106500                    CMPC    fill='040'O
        56 003256   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003257   000365 000004 55                 ADSC9   245                      cn=0,n=4
        56 003260   003267 602000 56                 TNC     s:3566+26
        56 003261   003564 600000 56                 TZE     s:3581
        56 003262   040000 106500                    CMPC    fill='040'O
        56 003263   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003264   000366 000004 55                 ADSC9   246                      cn=0,n=4
        56 003265   003663 601000 56                 TNZ     s:3610
        56 003266   003564 710000 56                 TRA     s:3581
        56 003267   040000 106500                    CMPC    fill='040'O
        56 003270   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003271   000367 000004 55                 ADSC9   247                      cn=0,n=4
        56 003272   003663 601000 56                 TNZ     s:3610
        56 003273   003525 710000 56                 TRA     s:3568
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:202  
        56 003274   040000 106500                    CMPC    fill='040'O
        56 003275   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003276   000370 000004 55                 ADSC9   248                      cn=0,n=4
        56 003277   003306 602000 56                 TNC     s:3566+41
        56 003300   003540 600000 56                 TZE     s:3573
        56 003301   040000 106500                    CMPC    fill='040'O
        56 003302   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003303   000371 000005 55                 ADSC9   249                      cn=0,n=5
        56 003304   003663 601000 56                 TNZ     s:3610
        56 003305   003636 710000 56                 TRA     s:3599
        56 003306   040000 106500                    CMPC    fill='040'O
        56 003307   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003310   000373 000005 55                 ADSC9   251                      cn=0,n=5
        56 003311   003663 601000 56                 TNZ     s:3610
        56 003312   003636 710000 56                 TRA     s:3599
        56 003313   040000 106500                    CMPC    fill='040'O
        56 003314   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003315   000375 000005 55                 ADSC9   253                      cn=0,n=5
        56 003316   003333 602000 56                 TNC     s:3566+62
        56 003317   003620 600000 56                 TZE     s:3592
        56 003320   040000 106500                    CMPC    fill='040'O
        56 003321   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003322   000377 000003 55                 ADSC9   255                      cn=0,n=3
        56 003323   003326 602000 56                 TNC     s:3566+57
        56 003324   003525 600000 56                 TZE     s:3568
        56 003325   003663 710000 56                 TRA     s:3610
        56 003326   040000 106500                    CMPC    fill='040'O
        56 003327   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003330   000400 000004 55                 ADSC9   256                      cn=0,n=4
        56 003331   003663 601000 56                 TNZ     s:3610
        56 003332   003620 710000 56                 TRA     s:3592
        56 003333   040000 106500                    CMPC    fill='040'O
        56 003334   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003335   000401 000003 55                 ADSC9   257                      cn=0,n=3
        56 003336   003345 602000 56                 TNC     s:3566+72
        56 003337   003663 600000 56                 TZE     s:3610
        56 003340   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:203  
        56 003341   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003342   000375 000003 55                 ADSC9   253                      cn=0,n=3
        56 003343   003663 601000 56                 TNZ     s:3610
        56 003344   003540 710000 56                 TRA     s:3573
        56 003345   040000 106500                    CMPC    fill='040'O
        56 003346   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003347   000402 000003 55                 ADSC9   258                      cn=0,n=3
        56 003350   003663 601000 56                 TNZ     s:3610
        56 003351   003663 710000 56                 TRA     s:3610
        56 003352   040000 106500                    CMPC    fill='040'O
        56 003353   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003354   000403 000004 55                 ADSC9   259                      cn=0,n=4
        56 003355   003430 602000 56                 TNC     s:3566+123
        56 003356   003540 600000 56                 TZE     s:3573
        56 003357   040000 106500                    CMPC    fill='040'O
        56 003360   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003361   000404 000004 55                 ADSC9   260                      cn=0,n=4
        56 003362   003411 602000 56                 TNC     s:3566+108
        56 003363   003540 600000 56                 TZE     s:3573
        56 003364   040000 106500                    CMPC    fill='040'O
        56 003365   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003366   000405 000004 55                 ADSC9   261                      cn=0,n=4
        56 003367   003404 602000 56                 TNC     s:3566+103
        56 003370   003540 600000 56                 TZE     s:3573
        56 003371   040000 106500                    CMPC    fill='040'O
        56 003372   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003373   000406 000003 55                 ADSC9   262                      cn=0,n=3
        56 003374   003377 602000 56                 TNC     s:3566+98
        56 003375   003620 600000 56                 TZE     s:3592
        56 003376   003663 710000 56                 TRA     s:3610
        56 003377   040000 106500                    CMPC    fill='040'O
        56 003400   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003401   000407 000005 55                 ADSC9   263                      cn=0,n=5
        56 003402   003663 601000 56                 TNZ     s:3610
        56 003403   003636 710000 56                 TRA     s:3599
        56 003404   040000 106500                    CMPC    fill='040'O
        56 003405   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:204  
        56 003406   000411 000005 55                 ADSC9   265                      cn=0,n=5
        56 003407   003663 601000 56                 TNZ     s:3610
        56 003410   003636 710000 56                 TRA     s:3599
        56 003411   040000 106500                    CMPC    fill='040'O
        56 003412   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003413   000413 000003 55                 ADSC9   267                      cn=0,n=3
        56 003414   003423 602000 56                 TNC     s:3566+118
        56 003415   003525 600000 56                 TZE     s:3568
        56 003416   040000 106500                    CMPC    fill='040'O
        56 003417   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003420   000414 000003 55                 ADSC9   268                      cn=0,n=3
        56 003421   003663 601000 56                 TNZ     s:3610
        56 003422   003620 710000 56                 TRA     s:3592
        56 003423   040000 106500                    CMPC    fill='040'O
        56 003424   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003425   000415 000005 55                 ADSC9   269                      cn=0,n=5
        56 003426   003663 601000 56                 TNZ     s:3610
        56 003427   003636 710000 56                 TRA     s:3599
        56 003430   040000 106500                    CMPC    fill='040'O
        56 003431   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003432   000417 000004 55                 ADSC9   271                      cn=0,n=4
        56 003433   003467 602000 56                 TNC     s:3566+154
        56 003434   003525 600000 56                 TZE     s:3568
        56 003435   040000 106500                    CMPC    fill='040'O
        56 003436   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003437   000420 000003 55                 ADSC9   272                      cn=0,n=3
        56 003440   003454 602000 56                 TNC     s:3566+143
        56 003441   003564 600000 56                 TZE     s:3581
        56 003442   040000 106500                    CMPC    fill='040'O
        56 003443   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003444   000421 000004 55                 ADSC9   273                      cn=0,n=4
        56 003445   003663 602000 56                 TNC     s:3610
        56 003446   003540 600000 56                 TZE     s:3573
        56 003447   040000 106500                    CMPC    fill='040'O
        56 003450   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003451   000422 000005 55                 ADSC9   274                      cn=0,n=5
        56 003452   003663 601000 56                 TNZ     s:3610
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:205  
        56 003453   003636 710000 56                 TRA     s:3599
        56 003454   040000 106500                    CMPC    fill='040'O
        56 003455   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003456   000424 000003 55                 ADSC9   276                      cn=0,n=3
        56 003457   003462 602000 56                 TNC     s:3566+149
        56 003460   003564 600000 56                 TZE     s:3581
        56 003461   003663 710000 56                 TRA     s:3610
        56 003462   040000 106500                    CMPC    fill='040'O
        56 003463   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003464   000425 000005 55                 ADSC9   277                      cn=0,n=5
        56 003465   003663 601000 56                 TNZ     s:3610
        56 003466   003620 710000 56                 TRA     s:3592
        56 003467   040000 106500                    CMPC    fill='040'O
        56 003470   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003471   000427 000004 55                 ADSC9   279                      cn=0,n=4
        56 003472   003513 602000 56                 TNC     s:3566+174
        56 003473   003540 600000 56                 TZE     s:3573
        56 003474   040000 106500                    CMPC    fill='040'O
        56 003475   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003476   000430 000003 55                 ADSC9   280                      cn=0,n=3
        56 003477   003506 602000 56                 TNC     s:3566+169
        56 003500   003610 600000 56                 TZE     s:3588
        56 003501   040000 106500                    CMPC    fill='040'O
        56 003502   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003503   000431 000004 55                 ADSC9   281                      cn=0,n=4
        56 003504   003663 601000 56                 TNZ     s:3610
        56 003505   003610 710000 56                 TRA     s:3588
        56 003506   040000 106500                    CMPC    fill='040'O
        56 003507   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003510   000432 000005 55                 ADSC9   282                      cn=0,n=5
        56 003511   003663 601000 56                 TNZ     s:3610
        56 003512   003636 710000 56                 TRA     s:3599
        56 003513   040000 106500                    CMPC    fill='040'O
        56 003514   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003515   000434 000004 55                 ADSC9   284                      cn=0,n=4
        56 003516   003663 602000 56                 TNC     s:3610
        56 003517   003540 600000 56                 TZE     s:3573
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:206  
        56 003520   040000 106500                    CMPC    fill='040'O
        56 003521   300000 000005                    ADSC9   0,,PR3                   cn=0,n=5
        56 003522   000435 000005 55                 ADSC9   285                      cn=0,n=5
        56 003523   003663 601000 56                 TNZ     s:3610
        56 003524   003636 710000 56                 TRA     s:3599

     1469     3567    3          SELECT('MLR','MRL','MVT','CMPC','SCM','SCMR');

     1470     3568    3            UH_OUT2.FILL = BINBIT(OPTIONAL_FIELDS(0),9);

   3568 56 003525   200244 474500                    LDP4    @OPTIONAL_FIELDS,,AUTO
        56 003526   400000 236100                    LDQ     0,,PR4
        56 003527   000033 736000                    QLS     27
        56 003530   000000 552140                    STBQ    0,'40'O,PR0

     1471     3569    3            IF OPTIONAL_FIELDS(1) = 1 THEN

   3569 56 003531   400001 235100                    LDA     1,,PR4
        56 003532   000001 115007                    CMPA    1,DL
        56 003533   003663 601000 56                 TNZ     s:3610

     1472     3570    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;

   3570 56 003534   000000 221100                    LDX1    0,,PR0
        56 003535   000400 261003                    ORX1    256,DU
        56 003536   000000 741100                    STX1    0,,PR0
        56 003537   003663 710000 56                 TRA     s:3610

     1473     3571
     1474     3572    3          SELECT('MVN','AD2D','SB2D','MP2D','AD3D','SB3D','MP3D','DV3D','DV2D');

     1475     3573    3            IF OPTIONAL_FIELDS(0) = 1 THEN

   3573 56 003540   200244 474500                    LDP4    @OPTIONAL_FIELDS,,AUTO
        56 003541   400000 235100                    LDA     0,,PR4
        56 003542   000001 115007                    CMPA    1,DL
        56 003543   003547 601000 56                 TNZ     s:3575
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:207  

     1476     3574    3              UPPER_HALF = UPPER_HALF | '000000000010000000'B;

   3574 56 003544   000000 221100                    LDX1    0,,PR0
        56 003545   000200 261003                    ORX1    128,DU
        56 003546   000000 741100                    STX1    0,,PR0

     1477     3575    3            IF OPTIONAL_FIELDS(1) = 1 THEN

   3575 56 003547   400001 235100                    LDA     1,,PR4
        56 003550   000001 115007                    CMPA    1,DL
        56 003551   003555 601000 56                 TNZ     s:3577

     1478     3576    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;

   3576 56 003552   000000 221100                    LDX1    0,,PR0
        56 003553   400000 261003                    ORX1    -131072,DU
        56 003554   000000 741100                    STX1    0,,PR0

     1479     3577    3            IF OPTIONAL_FIELDS(2) = 1 THEN

   3577 56 003555   400002 235100                    LDA     2,,PR4
        56 003556   000001 115007                    CMPA    1,DL
        56 003557   003663 601000 56                 TNZ     s:3610

     1480     3578    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;

   3578 56 003560   000000 221100                    LDX1    0,,PR0
        56 003561   000400 261003                    ORX1    256,DU
        56 003562   000000 741100                    STX1    0,,PR0
        56 003563   003663 710000 56                 TRA     s:3610

     1481     3579
     1482     3580    3          SELECT('CSL','CSR','SZTL','SZTR');

     1483     3581    3            UH_OUT3.BOLR = BINBIT(OPTIONAL_FIELDS(0),4);

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:208  
   3581 56 003564   200244 474500                    LDP4    @OPTIONAL_FIELDS,,AUTO
        56 003565   400000 236100                    LDQ     0,,PR4
        56 003566   000040 736000                    QLS     32
        56 003567   000005 772000                    QRL     5
        56 003570   000000 676100                    ERQ     0,,PR0
        56 003571   017000 376003                    ANQ     7680,DU
        56 003572   000000 656100                    ERSQ    0,,PR0

     1484     3582    3            IF  OPTIONAL_FIELDS(1) = 1 THEN

   3582 56 003573   400001 235100                    LDA     1,,PR4
        56 003574   000001 115007                    CMPA    1,DL
        56 003575   003601 601000 56                 TNZ     s:3584

     1485     3583    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;

   3583 56 003576   000000 221100                    LDX1    0,,PR0
        56 003577   400000 261003                    ORX1    -131072,DU
        56 003600   000000 741100                    STX1    0,,PR0

     1486     3584    3            IF OPTIONAL_FIELDS(2) = 1 THEN

   3584 56 003601   400002 235100                    LDA     2,,PR4
        56 003602   000001 115007                    CMPA    1,DL
        56 003603   003663 601000 56                 TNZ     s:3610

     1487     3585    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;

   3585 56 003604   000000 221100                    LDX1    0,,PR0
        56 003605   000400 261003                    ORX1    256,DU
        56 003606   000000 741100                    STX1    0,,PR0
        56 003607   003663 710000 56                 TRA     s:3610

     1488     3586
     1489     3587    3          SELECT('CMPB','BTD');

     1490     3588    3            IF OPTIONAL_FIELDS(0) = 1 THEN
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:209  

   3588 56 003610   200244 474500                    LDP4    @OPTIONAL_FIELDS,,AUTO
        56 003611   400000 235100                    LDA     0,,PR4
        56 003612   000001 115007                    CMPA    1,DL
        56 003613   003663 601000 56                 TNZ     s:3610

     1491     3589    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;

   3589 56 003614   000000 221100                    LDX1    0,,PR0
        56 003615   400000 261003                    ORX1    -131072,DU
        56 003616   000000 741100                    STX1    0,,PR0
        56 003617   003663 710000 56                 TRA     s:3610

     1492     3590
     1493     3591    3          SELECT('CMPNX','MVNEX','MVNX','MMF','MRF');

     1494     3592    3            IF OPTIONAL_FIELDS(0) = 1 THEN

   3592 56 003620   200244 474500                    LDP4    @OPTIONAL_FIELDS,,AUTO
        56 003621   400000 235100                    LDA     0,,PR4
        56 003622   000001 115007                    CMPA    1,DL
        56 003623   003627 601000 56                 TNZ     s:3594

     1495     3593    3              UPPER_HALF = UPPER_HALF | '100000000000000000'B;

   3593 56 003624   000000 221100                    LDX1    0,,PR0
        56 003625   400000 261003                    ORX1    -131072,DU
        56 003626   000000 741100                    STX1    0,,PR0

     1496     3594    3            IF OPTIONAL_FIELDS(1) = 1 THEN

   3594 56 003627   400001 235100                    LDA     1,,PR4
        56 003630   000001 115007                    CMPA    1,DL
        56 003631   003663 601000 56                 TNZ     s:3610

     1497     3595    3              UPPER_HALF = UPPER_HALF | '010000000000000000'B;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:210  
   3595 56 003632   000000 221100                    LDX1    0,,PR0
        56 003633   200000 261003                    ORX1    65536,DU
        56 003634   000000 741100                    STX1    0,,PR0
        56 003635   003663 710000 56                 TRA     s:3610

     1498     3596
     1499     3597    3          SELECT('AD2DX','SB2DX','MP2DX','DV2DX',

     1500     3598    3                 'AD3DX','SB3DX','MP3DX','DV3DX');
     1501     3599    3            IF OPTIONAL_FIELDS(0) = 1 THEN

   3599 56 003636   200244 474500                    LDP4    @OPTIONAL_FIELDS,,AUTO
        56 003637   400000 235100                    LDA     0,,PR4
        56 003640   000001 115007                    CMPA    1,DL
        56 003641   003645 601000 56                 TNZ     s:3601

     1502     3600    3              UPPER_HALF = UPPER_HALF | '000000000010000000'B;

   3600 56 003642   000000 221100                    LDX1    0,,PR0
        56 003643   000200 261003                    ORX1    128,DU
        56 003644   000000 741100                    STX1    0,,PR0

     1503     3601    3            IF OPTIONAL_FIELDS(1) ~= 0 THEN

   3601 56 003645   400001 235100                    LDA     1,,PR4
        56 003646   003654 600000 56                 TZE     s:3603

     1504     3602    3              UH_OUT.BITS = BINBIT(OPTIONAL_FIELDS(1),2);

   3602 56 003647   400001 236100                    LDQ     1,,PR4
        56 003650   000042 736000                    QLS     34
        56 003651   000000 676100                    ERQ     0,,PR0
        56 003652   600000 376003                    ANQ     -65536,DU
        56 003653   000000 656100                    ERSQ    0,,PR0

     1505     3603    3            IF OPTIONAL_FIELDS(2) = 1 THEN

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:211  
   3603 56 003654   400002 235100                    LDA     2,,PR4
        56 003655   000001 115007                    CMPA    1,DL
        56 003656   003663 601000 56                 TNZ     s:3610

     1506     3604    3              UPPER_HALF = UPPER_HALF | '000000000100000000'B;

   3604 56 003657   000000 221100                    LDX1    0,,PR0
        56 003660   000400 261003                    ORX1    256,DU
        56 003661   000000 741100                    STX1    0,,PR0
        56 003662   003663 710000 56                 TRA     s:3610

     1507     3605
     1508     3606    3          SELECT('MTM','MTR');

     1509     3607
     1510     3608    3        END; /* SELECT */

     1511     3609
     1512     3610    2        CALL GET_VALUE_OF_OPCODE(OPCODE,OPCODE_VALUE,POS);

   3610 56 003663   200251 634500                    EPPR4   POS,,AUTO
        56 003664   200257 454500                    STP4    @POS,,AUTO
        56 003665   200250 635500                    EPPR5   OPCODE_VALUE,,AUTO
        56 003666   200256 455500                    STP5    @OPCODE_VALUE,,AUTO
        56 003667   200245 236100                    LDQ     @OPCODE,,AUTO
        56 003670   200255 756100                    STQ     OCTNUM,,AUTO
        56 003671   002642 701000 56                 TSX1    GET_VALUE_OF_OPCODE
        56 003672   000000 011000                    NOP     0

     1513     3611    2        LH_OUT.OPFIELD = OPCODE_VALUE;

   3611 56 003673   200247 470500                    LDP0    @LOWER_HALF,,AUTO
        56 003674   200250 236100                    LDQ     OPCODE_VALUE,,AUTO
        56 003675   000000 552140                    STBQ    0,'40'O,PR0

     1514     3612    2        LH_OUT.EISBIT = '1'B;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:212  
   3612 56 003676   000400 236003                    LDQ     256,DU
        56 003677   000000 256100                    ORSQ    0,,PR0

     1515     3613
     1516     3614    2        M_OUT = '0000000'B;

   3614 56 003700   000037 236000 57                 LDQ     31
        56 003701   200252 356100                    ANSQ    M_FIELD,,AUTO

     1517     3615    2        CALL SEARCH_TAG_TABLE(MODFIELDS.RNREG(0),POS,TAG_VAL);

   3615 56 003702   200253 631500                    EPPR1   TAG_VAL,,AUTO
        56 003703   200273 451500                    STP1    @TAG_VAL,,AUTO
        56 003704   200251 633500                    EPPR3   POS,,AUTO
        56 003705   200272 453500                    STP3    @POSITION,,AUTO
        56 003706   200243 236100                    LDQ     @MODFIELDS,,AUTO
        56 003707   200000 036007                    ADLQ    65536,DL
        56 003710   200271 756100                    STQ     @GOAL,,AUTO
        56 003711   002710 701000 56                 TSX1    SEARCH_TAG_TABLE
        56 003712   000000 011000                    NOP     0

     1518     3616    2        M_OUT = BINBIT(BITBIN(TAG_VAL),7);

   3616 56 003713   200253 236100                    LDQ     TAG_VAL,,AUTO
        56 003714   000022 772000                    QRL     18
        56 003715   000035 736000                    QLS     29
        56 003716   200252 676100                    ERQ     M_FIELD,,AUTO
        56 003717   774000 376003                    ANQ     -2048,DU
        56 003720   200252 656100                    ERSQ    M_FIELD,,AUTO

     1519     3617    2        M_FIELD.BITS = MODFIELDS.BITS(0);

   3617 56 003721   200243 470500                    LDP0    @MODFIELDS,,AUTO
        56 003722   003100 060500                    CSL     bolr='003'O
        56 003723   000000 000003                    BDSC    0,,PR0                   by=0,bit=0,n=3
        56 003724   200252 000003                    BDSC    M_FIELD,,AUTO            by=0,bit=0,n=3

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:213  
     1520     3618    2        LH_OUT.MF1 = M_OUT;

   3618 56 003725   200247 471500                    LDP1    @LOWER_HALF,,AUTO
        56 003726   200252 236100                    LDQ     M_FIELD,,AUTO
        56 003727   000013 772000                    QRL     11
        56 003730   100000 676100                    ERQ     0,,PR1
        56 003731   000177 376003                    ANQ     127,DU
        56 003732   100000 656100                    ERSQ    0,,PR1

     1521     3619
     1522     3620    2        M_OUT = '0000000'B;

   3620 56 003733   000037 236000 57                 LDQ     31
        56 003734   200252 356100                    ANSQ    M_FIELD,,AUTO

     1523     3621    2        IF MODFIELDS.EXISTS(1) THEN

   3621 56 003735   000000 066500                    CMPB    filb='0'B
        56 003736   000002 200001                    BDSC    2,,PR0                   by=1,bit=0,n=1
        56 003737   000002 000022 57                 BDSC    2                        by=0,bit=0,n=18
        56 003740   003772 600000 56                 TZE     s:3629

     1524     3622    3          DO;

     1525     3623    3            CALL SEARCH_TAG_TABLE(MODFIELDS.RNREG(1),POS,TAG_VAL);

   3623 56 003741   200253 633500                    EPPR3   TAG_VAL,,AUTO
        56 003742   200273 453500                    STP3    @TAG_VAL,,AUTO
        56 003743   200251 634500                    EPPR4   POS,,AUTO
        56 003744   200272 454500                    STP4    @POSITION,,AUTO
        56 003745   200243 236100                    LDQ     @MODFIELDS,,AUTO
        56 003746   000040 036000 57                 ADLQ    32
        56 003747   200271 756100                    STQ     @GOAL,,AUTO
        56 003750   002710 701000 56                 TSX1    SEARCH_TAG_TABLE
        56 003751   000000 011000                    NOP     0

     1526     3624    3            M_OUT = BINBIT(BITBIN(TAG_VAL),7);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:214  

   3624 56 003752   200253 236100                    LDQ     TAG_VAL,,AUTO
        56 003753   000022 772000                    QRL     18
        56 003754   000035 736000                    QLS     29
        56 003755   200252 676100                    ERQ     M_FIELD,,AUTO
        56 003756   774000 376003                    ANQ     -2048,DU
        56 003757   200252 656100                    ERSQ    M_FIELD,,AUTO

     1527     3625    3            M_FIELD.BITS = MODFIELDS.BITS(1);

   3625 56 003760   200243 470500                    LDP0    @MODFIELDS,,AUTO
        56 003761   003100 060500                    CSL     bolr='003'O
        56 003762   000001 200003                    BDSC    1,,PR0                   by=1,bit=0,n=3
        56 003763   200252 000003                    BDSC    M_FIELD,,AUTO            by=0,bit=0,n=3

     1528     3626    3            UH_OUT.MF2 = M_OUT;

   3626 56 003764   200246 471500                    LDP1    @UPPER_HALF,,AUTO
        56 003765   200252 236100                    LDQ     M_FIELD,,AUTO
        56 003766   000013 772000                    QRL     11
        56 003767   100000 676100                    ERQ     0,,PR1
        56 003770   000177 376003                    ANQ     127,DU
        56 003771   100000 656100                    ERSQ    0,,PR1

     1529     3627    3          END;

     1530     3628
     1531     3629    2        M_OUT = '0000000'B;

   3629 56 003772   000037 236000 57                 LDQ     31
        56 003773   200252 356100                    ANSQ    M_FIELD,,AUTO

     1532     3630    2        IF MODFIELDS.EXISTS(2) THEN

   3630 56 003774   000000 066500                    CMPB    filb='0'B
        56 003775   000003 400001                    BDSC    3,,PR0                   by=2,bit=0,n=1
        56 003776   000002 000022 57                 BDSC    2                        by=0,bit=0,n=18
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:215  
        56 003777   004031 600000 56                 TZE     s:3639

     1533     3631    3          DO;

     1534     3632    3            CALL SEARCH_TAG_TABLE(MODFIELDS.RNREG(2),POS,TAG_VAL);

   3632 56 004000   200253 631500                    EPPR1   TAG_VAL,,AUTO
        56 004001   200273 451500                    STP1    @TAG_VAL,,AUTO
        56 004002   200251 633500                    EPPR3   POS,,AUTO
        56 004003   200272 453500                    STP3    @POSITION,,AUTO
        56 004004   200243 236100                    LDQ     @MODFIELDS,,AUTO
        56 004005   000041 036000 57                 ADLQ    33
        56 004006   200271 756100                    STQ     @GOAL,,AUTO
        56 004007   002710 701000 56                 TSX1    SEARCH_TAG_TABLE
        56 004010   000000 011000                    NOP     0

     1535     3633    3            M_OUT = BINBIT(BITBIN(TAG_VAL),7);

   3633 56 004011   200253 236100                    LDQ     TAG_VAL,,AUTO
        56 004012   000022 772000                    QRL     18
        56 004013   000035 736000                    QLS     29
        56 004014   200252 676100                    ERQ     M_FIELD,,AUTO
        56 004015   774000 376003                    ANQ     -2048,DU
        56 004016   200252 656100                    ERSQ    M_FIELD,,AUTO

     1536     3634    3            M_FIELD.BITS = MODFIELDS.BITS(2);

   3634 56 004017   200243 470500                    LDP0    @MODFIELDS,,AUTO
        56 004020   003100 060500                    CSL     bolr='003'O
        56 004021   000002 400003                    BDSC    2,,PR0                   by=2,bit=0,n=3
        56 004022   200252 000003                    BDSC    M_FIELD,,AUTO            by=0,bit=0,n=3

     1537     3635    3            UH_OUT.MF3 = M_OUT;

   3635 56 004023   200246 471500                    LDP1    @UPPER_HALF,,AUTO
        56 004024   200252 236100                    LDQ     M_FIELD,,AUTO
        56 004025   000002 772000                    QRL     2
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:216  
        56 004026   100000 676100                    ERQ     0,,PR1
        56 004027   177000 376003                    ANQ     65024,DU
        56 004030   100000 656100                    ERSQ    0,,PR1

     1538     3636    3          END;

     1539     3637
     1540     3638
     1541     3639    2    END GEN_EIS_INST;

   3639 56 004031   200242 221300                    LDX1  ! @BIN_CHAR,,AUTO
        56 004032   000001 702211                    TSX2  ! 1,X1

     1542     3640         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:217  
     1543     3641    1    GEN_P_CODE : PROC;

   3641 56 004033   200240 741300       GEN_P_CODE   STX1  ! SHIFT_FACTOR+2,,AUTO

     1544     3642
     1545     3643         /*I*
     1546     3644              NAME: GEN_P_CODE
     1547     3645              PURPOSE:
     1548     3646                   Generate the pseudo_code to be output ot the object table.
     1549     3647              CALL:
     1550     3648                   CALL GEN_P_CODE;
     1551     3649              DATA:
     1552     3650                   P_CODE
     1553     3651              DESCRIPTION:
     1554     3652                   Use the P_CODE structure to generate the object table.
     1555     3653                   This procedure is called  in the GENERATE_P_CODE
     1556     3654                   semantic action which occurs at the end of the operand list
     1557     3655                   for each directive encountered in the pseudo-code.
     1558     3656                   This procedure is composed of a case statement using
     1559     3657                   the SYMBOL element of the P_CODE structure, which
     1560     3658                   is the terminal number of the token used to represent
     1561     3659                   the directive name.   The preprocessor variables used
     1562     3660                   in the case statement that makes up the body of this
     1563     3661                   procedure come from the file Z8P_ORDER_DEF.  The value
     1564     3662                   of the preprocessor variable is the same as
     1565     3663                   the position of the corresponding directive in the order
     1566     3664                   list of the grammar.
     1567     3665         */
     1568     3666
     1569     3667    3        DO CASE(P_CODE.SYMBOL);

   3667 56 004034   001443 235000 52                 LDA     P_CODE+3
        56 004035   000067 115007                    CMPA    55,DL
        56 004036   004040 602005 56                 TNC     s:3667+4,AL
        56 004037   005270 710000 56                 TRA     s:3959
        56 004040   005270 710000 56                 TRA     s:3959
        56 004041   005274 710000 56                 TRA     s:3965
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:218  
        56 004042   004127 710000 56                 TRA     s:3670
        56 004043   005274 710000 56                 TRA     s:3965
        56 004044   005274 710000 56                 TRA     s:3965
        56 004045   004136 710000 56                 TRA     s:3674
        56 004046   005274 710000 56                 TRA     s:3965
        56 004047   005274 710000 56                 TRA     s:3965
        56 004050   005274 710000 56                 TRA     s:3965
        56 004051   005274 710000 56                 TRA     s:3965
        56 004052   004162 710000 56                 TRA     s:3679
        56 004053   004310 710000 56                 TRA     s:3704
        56 004054   005274 710000 56                 TRA     s:3965
        56 004055   005274 710000 56                 TRA     s:3965
        56 004056   005274 710000 56                 TRA     s:3965
        56 004057   005274 710000 56                 TRA     s:3965
        56 004060   005274 710000 56                 TRA     s:3965
        56 004061   005274 710000 56                 TRA     s:3965
        56 004062   005274 710000 56                 TRA     s:3965
        56 004063   005274 710000 56                 TRA     s:3965
        56 004064   005274 710000 56                 TRA     s:3965
        56 004065   005274 710000 56                 TRA     s:3965
        56 004066   005274 710000 56                 TRA     s:3965
        56 004067   005274 710000 56                 TRA     s:3965
        56 004070   005274 710000 56                 TRA     s:3965
        56 004071   005274 710000 56                 TRA     s:3965
        56 004072   005274 710000 56                 TRA     s:3965
        56 004073   004317 710000 56                 TRA     s:3714
        56 004074   004317 710000 56                 TRA     s:3714
        56 004075   004317 710000 56                 TRA     s:3714
        56 004076   004317 710000 56                 TRA     s:3714
        56 004077   004317 710000 56                 TRA     s:3714
        56 004100   004317 710000 56                 TRA     s:3714
        56 004101   004317 710000 56                 TRA     s:3714
        56 004102   004473 710000 56                 TRA     s:3774
        56 004103   004723 710000 56                 TRA     s:3847
        56 004104   004752 710000 56                 TRA     s:3853
        56 004105   005274 710000 56                 TRA     s:3965
        56 004106   004756 710000 56                 TRA     s:3857
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:219  
        56 004107   005232 710000 56                 TRA     s:3942
        56 004110   005274 710000 56                 TRA     s:3965
        56 004111   005216 710000 56                 TRA     s:3937
        56 004112   004127 710000 56                 TRA     s:3670
        56 004113   005274 710000 56                 TRA     s:3965
        56 004114   005274 710000 56                 TRA     s:3965
        56 004115   005274 710000 56                 TRA     s:3965
        56 004116   005251 710000 56                 TRA     s:3948
        56 004117   005274 710000 56                 TRA     s:3965
        56 004120   005274 710000 56                 TRA     s:3965
        56 004121   005274 710000 56                 TRA     s:3965
        56 004122   005251 710000 56                 TRA     s:3948
        56 004123   005251 710000 56                 TRA     s:3948
        56 004124   005251 710000 56                 TRA     s:3948
        56 004125   005251 710000 56                 TRA     s:3948
        56 004126   005252 710000 56                 TRA     s:3951

     1570     3668
     1571     3669    3          CASE(%DECCNT,%INCCNT);

     1572     3670    3            IF OPCNT < 2 THEN

   3670 56 004127   001522 236000 52                 LDQ     OPCNT
        56 004130   000002 116007                    CMPQ    2,DL
        56 004131   005274 603000 56                 TRC     s:3965

     1573     3671    3              P_CODE.OPERAND(1) = '1';

   3671 56 004132   040000 100400                    MLR     fill='040'O
        56 004133   000035 000001 57                 ADSC9   29                       cn=0,n=1
        56 004134   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 004135   005274 710000 56                 TRA     s:3965

     1574     3672
     1575     3673    3          CASE(%JMPDV);

     1576     3674    3            CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(1));
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:220  

   3674 56 004136   000100 305400                    DTB
        56 004137   001453 630036 52                 NDSC9   P_CODE+11                cn=3,s=nosgn,sf=0,n=30
        56 004140   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004141   200277 236100                    LDQ     CNT2+3,,AUTO
        56 004142   200232 756100                    STQ     VFD_WORD,,AUTO

     1577     3675    3            CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);

   3675 56 004143   200232 235100                    LDA     VFD_WORD,,AUTO
        56 004144   000022 771000                    ARL     18
        56 004145   000044 773000                    LRL     36
        56 004146   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004147   000000 301500                    BTD
        56 004150   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004151   001453 630036 52                 NDSC9   P_CODE+11                cn=3,s=nosgn,sf=0,n=30

     1578     3676    3            CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);

   3676 56 004152   200232 236100                    LDQ     VFD_WORD,,AUTO
        56 004153   777777 376007                    ANQ     -1,DL
        56 004154   000000 235003                    LDA     0,DU
        56 004155   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004156   000000 301500                    BTD
        56 004157   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004160   001463 230036 52                 NDSC9   P_CODE+19                cn=1,s=nosgn,sf=0,n=30
        56 004161   005274 710000 56                 TRA     s:3965

     1579     3677
     1580     3678    3          CASE(%GENI);

     1581     3679    3            IF OPCNT < 1 THEN

   3679 56 004162   001522 236000 52                 LDQ     OPCNT
        56 004163   004167 601000 56                 TNZ     s:3681

     1582     3680    3              P_CODE.OPERAND(0) ='      262143';
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:221  

   3680 56 004164   040000 100400                    MLR     fill='040'O
        56 004165   000437 000014 55                 ADSC9   287                      cn=0,n=12
        56 004166   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30

     1583     3681    3            IF OPCODE = 'VFD' THEN

   3681 56 004167   040000 106400                    CMPC    fill='040'O
        56 004170   001417 000005 52                 ADSC9   OPCODE                   cn=0,n=5
        56 004171   000442 000003 55                 ADSC9   290                      cn=0,n=3
        56 004172   004214 601000 56                 TNZ     s:3687

     1584     3682    4              DO;

     1585     3683    4                VFD_WORD = BITBIN(VFD_ACC);

   3683 56 004173   001435 235000 52                 LDA     VFD_ACC
        56 004174   200232 755100                    STA     VFD_WORD,,AUTO

     1586     3684    4                CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);

   3684 56 004175   200232 235100                    LDA     VFD_WORD,,AUTO
        56 004176   000022 771000                    ARL     18
        56 004177   000044 773000                    LRL     36
        56 004200   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004201   000000 301500                    BTD
        56 004202   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004203   001453 630036 52                 NDSC9   P_CODE+11                cn=3,s=nosgn,sf=0,n=30

     1587     3685    4                CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);

   3685 56 004204   200232 236100                    LDQ     VFD_WORD,,AUTO
        56 004205   777777 376007                    ANQ     -1,DL
        56 004206   000000 235003                    LDA     0,DU
        56 004207   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004210   000000 301500                    BTD
        56 004211   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:222  
        56 004212   001463 230036 52                 NDSC9   P_CODE+19                cn=1,s=nosgn,sf=0,n=30

     1588     3686    4              END;

   3686 56 004213   005274 710000 56                 TRA     s:3965

     1589     3687    3            ELSE IF OPCODE = 'ZERO' THEN

   3687 56 004214   040000 106400                    CMPC    fill='040'O
        56 004215   001417 000005 52                 ADSC9   OPCODE                   cn=0,n=5
        56 004216   000443 000004 55                 ADSC9   291                      cn=0,n=4
        56 004217   004240 601000 56                 TNZ     s:3695

     1590     3688    4              DO;

     1591     3689    4                VFD_WORD = 0;

   3689 56 004220   200232 450100                    STZ     VFD_WORD,,AUTO

     1592     3690    4                CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);

   3690 56 004221   200232 235100                    LDA     VFD_WORD,,AUTO
        56 004222   000022 771000                    ARL     18
        56 004223   000044 773000                    LRL     36
        56 004224   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004225   000000 301500                    BTD
        56 004226   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004227   001453 630036 52                 NDSC9   P_CODE+11                cn=3,s=nosgn,sf=0,n=30

     1593     3691    4                CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);

   3691 56 004230   200232 236100                    LDQ     VFD_WORD,,AUTO
        56 004231   777777 376007                    ANQ     -1,DL
        56 004232   000000 235003                    LDA     0,DU
        56 004233   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004234   000000 301500                    BTD
        56 004235   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:223  
        56 004236   001463 230036 52                 NDSC9   P_CODE+19                cn=1,s=nosgn,sf=0,n=30

     1594     3692    4              END;

   3692 56 004237   005274 710000 56                 TRA     s:3965

     1595     3693    3            ELSE
     1596     3694    4              DO;

     1597     3695    4                IF MODFIELDS.EXISTS(0) THEN

   3695 56 004240   001425 234000 52                 SZN     MODFIELDS+1
        56 004241   004255 605000 56                 TPL     s:3697

     1598     3696    4                  CALL GEN_EIS_INST(MODFIELDS,OPTIONAL_FIELDS,OPCODE,UPPER_HALF,
              3696                           LOWER_HALF);

   3696 56 004242   200077 630500                    EPPR0   LOWER_HALF,,AUTO
        56 004243   200247 450500                    STP0    @LOWER_HALF,,AUTO
        56 004244   200076 631500                    EPPR1   UPPER_HALF,,AUTO
        56 004245   200246 451500                    STP1    @UPPER_HALF,,AUTO
        56 004246   000042 237000 57                 LDAQ    34
        56 004247   200244 757100                    STAQ    @OPTIONAL_FIELDS,,AUTO
        56 004250   000044 236000 57                 LDQ     36
        56 004251   200243 756100                    STQ     @MODFIELDS,,AUTO
        56 004252   003227 701000 56                 TSX1    GEN_EIS_INST
        56 004253   000000 011000                    NOP     0
        56 004254   004271 710000 56                 TRA     s:3699

     1599     3697    4                ELSE CALL GEN_SIMPLE_INST(OPCODE,YFIELD,MOD_TYPE,TAG_TYPE,

   3697 56 004255   200077 630500                    EPPR0   LOWER_HALF,,AUTO
        56 004256   200250 450500                    STP0    OPCODE_VALUE,,AUTO
        56 004257   200076 631500                    EPPR1   UPPER_HALF,,AUTO
        56 004260   200247 451500                    STP1    @LOWER_HALF,,AUTO
        56 004261   000045 236000 57                 LDQ     37
        56 004262   200246 756100                    STQ     @UPPER_HALF,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:224  
        56 004263   000046 237000 57                 LDAQ    38
        56 004264   200244 757100                    STAQ    @OPTIONAL_FIELDS,,AUTO
        56 004265   000043 236000 57                 LDQ     35
        56 004266   200243 756100                    STQ     @MODFIELDS,,AUTO
        56 004267   003006 701000 56                 TSX1    GEN_SIMPLE_INST
        56 004270   000000 011000                    NOP     0

     1600     3698    4                                  UPPER_HALF,LOWER_HALF);
     1601     3699    4                CALL BINCHAR(P_CODE.OPERAND(1),BITBIN(UPPER_HALF));

   3699 56 004271   200076 236100                    LDQ     UPPER_HALF,,AUTO
        56 004272   000022 772000                    QRL     18
        56 004273   000000 235003                    LDA     0,DU
        56 004274   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004275   000000 301500                    BTD
        56 004276   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004277   001453 630036 52                 NDSC9   P_CODE+11                cn=3,s=nosgn,sf=0,n=30

     1602     3700    4                CALL BINCHAR(P_CODE.OPERAND(2),BITBIN(LOWER_HALF));

   3700 56 004300   200077 236100                    LDQ     LOWER_HALF,,AUTO
        56 004301   000022 772000                    QRL     18
        56 004302   000000 235003                    LDA     0,DU
        56 004303   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004304   000000 301500                    BTD
        56 004305   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004306   001463 230036 52                 NDSC9   P_CODE+19                cn=1,s=nosgn,sf=0,n=30

     1603     3701    4              END;

   3701 56 004307   005274 710000 56                 TRA     s:3965

     1604     3702
     1605     3703    3          CASE(%MAPT);

     1606     3704    3            IF OPCNT < 3 THEN

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:225  
   3704 56 004310   001522 236000 52                 LDQ     OPCNT
        56 004311   000003 116007                    CMPQ    3,DL
        56 004312   005274 603000 56                 TRC     s:3965

     1607     3705    3               P_CODE.OPERAND(2) = '1';

   3705 56 004313   040000 100400                    MLR     fill='040'O
        56 004314   000035 000001 57                 ADSC9   29                       cn=0,n=1
        56 004315   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 004316   005274 710000 56                 TRA     s:3965

     1608     3706
     1609     3707    3          CASE(%QUIT,%DSTATE,%STORE,%JMP,%GOSUB,%ASSIGN,%WALK,

     1610     3708    3               %WALK2,%WALK3,%ALLOW,%ATTACH,%OFFSET,
     1611     3709    3               %DEFER,%DEFLAB,%ORGE,%REFLAB,%ORGS,%WRAPUP,%ADDRESS,%ALLOTD,%BCT,
     1612     3710    3               %HALT,%REF_,%RTN,%CONST,%DESCR,%NEWLAB,%TAG,%BURST,
     1613     3711    3               %FAVOR);
     1614     3712
     1615     3713    3          CASE(%AD,%AND,%MOVE,%MOVIND,%OR,%SHIFTL,%SHIFTR);

     1616     3714    3            CALL HANDLE_PC_UTILITIES(FWBOT,SWTOP,SWBOT);

   3714 56 004317   200174 630500                    EPPR0   SWBOT,,AUTO
        56 004320   200245 450500                    STP0    @OPCODE,,AUTO
        56 004321   200136 631500                    EPPR1   SWTOP,,AUTO
        56 004322   200244 451500                    STP1    @OPTIONAL_FIELDS,,AUTO
        56 004323   200100 633500                    EPPR3   FWBOT,,AUTO
        56 004324   200243 453500                    STP3    @MODFIELDS,,AUTO
        56 004325   001776 701000 56                 TSX1    HANDLE_PC_UTILITIES
        56 004326   000000 011000                    NOP     0

     1617     3715                 %SELECT_OU;

   3716 56 004327   000000 235000 xsym               LDA     Z8PS$M$OU#
        56 004330   000000 755000 24                 STA     OUT_DCBN

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:226  
     1618     3718    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',');

   3718 56 004331   040100 100400                    MLR     fill='040'O
        56 004332   001440 000014 52                 ADSC9   P_CODE                   cn=0,n=12
        56 004333   200005 000014                    ADSC9   BUFFER,,AUTO             cn=0,n=12
        56 004334   040100 100400                    MLR     fill='040'O
        56 004335   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 004336   200010 000200                    ADSC9   BUFFER+3,,AUTO           cn=0,n=128

     1619     3719                 %OUTPUT_STR;

   3724 56 004337   000000 236000 24                 LDQ     OUT_DCBN
        56 004340   004350 604000 56                 TMI     s:3726
        56 004341   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004342   004350 601000 56                 TNZ     s:3726
        56 004343   000000 236000 34                 LDQ     OPTIONS
        56 004344   000002 736000                    QLS     2
        56 004345   400000 376003                    ANQ     -131072,DU
        56 004346   400000 676003                    ERQ     -131072,DU
        56 004347   004362 601000 56                 TNZ     s:3730

   3726 56 004350   000214 235007                    LDA     140,DL
        56 004351   200050 755100                    STA     LEN,,AUTO

   3727 56 004352   200050 630500                    EPPR0   LEN,,AUTO
        56 004353   200277 450500                    STP0    CNT2+3,,AUTO
        56 004354   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004355   200276 451500                    STP1    CNT2+2,,AUTO
        56 004356   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004357   000000 631400 57                 EPPR1   0
        56 004360   000000 701000 xent               TSX1    OUTPUT
        56 004361   000000 011000                    NOP     0

     1620     3730    3            CALL CONCAT(BUFFER,%SPACER# FWBOT);

   3730 56 004362   040100 100500                    MLR     fill='040'O
        56 004363   200100 000170                    ADSC9   FWBOT,,AUTO              cn=0,n=120
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:227  
        56 004364   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1621     3731                 %OUTPUT_STR;

   3736 56 004365   000000 236000 24                 LDQ     OUT_DCBN
        56 004366   004376 604000 56                 TMI     s:3738
        56 004367   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004370   004376 601000 56                 TNZ     s:3738
        56 004371   000000 236000 34                 LDQ     OPTIONS
        56 004372   000002 736000                    QLS     2
        56 004373   400000 376003                    ANQ     -131072,DU
        56 004374   400000 676003                    ERQ     -131072,DU
        56 004375   004410 601000 56                 TNZ     s:3742

   3738 56 004376   000214 235007                    LDA     140,DL
        56 004377   200050 755100                    STA     LEN,,AUTO

   3739 56 004400   200050 630500                    EPPR0   LEN,,AUTO
        56 004401   200277 450500                    STP0    CNT2+3,,AUTO
        56 004402   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004403   200276 451500                    STP1    CNT2+2,,AUTO
        56 004404   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004405   000000 631400 57                 EPPR1   0
        56 004406   000000 701000 xent               TSX1    OUTPUT
        56 004407   000000 011000                    NOP     0

     1622     3742    3            CALL CONCAT(BUFFER,%SPACER# SWTOP);

   3742 56 004410   040100 100500                    MLR     fill='040'O
        56 004411   200136 000170                    ADSC9   SWTOP,,AUTO              cn=0,n=120
        56 004412   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1623     3743                 %OUTPUT_STR;

   3748 56 004413   000000 236000 24                 LDQ     OUT_DCBN
        56 004414   004424 604000 56                 TMI     s:3750
        56 004415   000000 116000 xsym               CMPQ    Z8PS$M$OU#
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:228  
        56 004416   004424 601000 56                 TNZ     s:3750
        56 004417   000000 236000 34                 LDQ     OPTIONS
        56 004420   000002 736000                    QLS     2
        56 004421   400000 376003                    ANQ     -131072,DU
        56 004422   400000 676003                    ERQ     -131072,DU
        56 004423   004436 601000 56                 TNZ     s:3754

   3750 56 004424   000214 235007                    LDA     140,DL
        56 004425   200050 755100                    STA     LEN,,AUTO

   3751 56 004426   200050 630500                    EPPR0   LEN,,AUTO
        56 004427   200277 450500                    STP0    CNT2+3,,AUTO
        56 004430   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004431   200276 451500                    STP1    CNT2+2,,AUTO
        56 004432   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004433   000000 631400 57                 EPPR1   0
        56 004434   000000 701000 xent               TSX1    OUTPUT
        56 004435   000000 011000                    NOP     0

     1624     3754    3            CALL CONCAT(BUFFER,%SPACER# SWBOT);

   3754 56 004436   040100 100500                    MLR     fill='040'O
        56 004437   200174 000170                    ADSC9   SWBOT,,AUTO              cn=0,n=120
        56 004440   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1625     3755                 %OUTPUT_STR;

   3760 56 004441   000000 236000 24                 LDQ     OUT_DCBN
        56 004442   004452 604000 56                 TMI     s:3762
        56 004443   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004444   004452 601000 56                 TNZ     s:3762
        56 004445   000000 236000 34                 LDQ     OPTIONS
        56 004446   000002 736000                    QLS     2
        56 004447   400000 376003                    ANQ     -131072,DU
        56 004450   400000 676003                    ERQ     -131072,DU
        56 004451   004464 601000 56                 TNZ     s:3767

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:229  
   3762 56 004452   000214 235007                    LDA     140,DL
        56 004453   200050 755100                    STA     LEN,,AUTO

   3763 56 004454   200050 630500                    EPPR0   LEN,,AUTO
        56 004455   200277 450500                    STP0    CNT2+3,,AUTO
        56 004456   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004457   200276 451500                    STP1    CNT2+2,,AUTO
        56 004460   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004461   000000 631400 57                 EPPR1   0
        56 004462   000000 701000 xent               TSX1    OUTPUT
        56 004463   000000 011000                    NOP     0

     1626     3766                 %SELECT_LO;

   3767 56 004464   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 004465   000000 755000 24                 STA     OUT_DCBN

     1627     3769    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;

   3769 56 004466   000000 236000 53                 LDQ     CURRENT_OT_POS
        56 004467   000002 036007                    ADLQ    2,DL
        56 004470   000000 756000 53                 STQ     CURRENT_OT_POS

     1628     3770    3            RETURN;

   3770 56 004471   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 004472   000001 702211                    TSX2  ! 1,X1

     1629     3771
     1630     3772    3          CASE(%ALLOT);

     1631     3773                 %SELECT_OU;

   3774 56 004473   000000 236000 xsym               LDQ     Z8PS$M$OU#
        56 004474   000000 756000 24                 STQ     OUT_DCBN

     1632     3776    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',');
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:230  

   3776 56 004475   040100 100400                    MLR     fill='040'O
        56 004476   001440 000014 52                 ADSC9   P_CODE                   cn=0,n=12
        56 004477   200005 000014                    ADSC9   BUFFER,,AUTO             cn=0,n=12
        56 004500   040100 100400                    MLR     fill='040'O
        56 004501   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 004502   200010 000200                    ADSC9   BUFFER+3,,AUTO           cn=0,n=128

     1633     3777                 %OUTPUT_STR;

   3782 56 004503   000000 236000 24                 LDQ     OUT_DCBN
        56 004504   004514 604000 56                 TMI     s:3784
        56 004505   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004506   004514 601000 56                 TNZ     s:3784
        56 004507   000000 236000 34                 LDQ     OPTIONS
        56 004510   000002 736000                    QLS     2
        56 004511   400000 376003                    ANQ     -131072,DU
        56 004512   400000 676003                    ERQ     -131072,DU
        56 004513   004526 601000 56                 TNZ     s:3788

   3784 56 004514   000214 235007                    LDA     140,DL
        56 004515   200050 755100                    STA     LEN,,AUTO

   3785 56 004516   200050 630500                    EPPR0   LEN,,AUTO
        56 004517   200277 450500                    STP0    CNT2+3,,AUTO
        56 004520   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004521   200276 451500                    STP1    CNT2+2,,AUTO
        56 004522   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004523   000000 631400 57                 EPPR1   0
        56 004524   000000 701000 xent               TSX1    OUTPUT
        56 004525   000000 011000                    NOP     0

     1634     3788    3            CALL CONCAT(BUFFER,'%(BITBIN((BINBIT(',P_CODE.OPERAND(0),

   3788 56 004526   040100 100400                    MLR     fill='040'O
        56 004527   000444 000021 55                 ADSC9   292                      cn=0,n=17
        56 004530   200005 000021                    ADSC9   BUFFER,,AUTO             cn=0,n=17
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:231  
        56 004531   040100 100400                    MLR     fill='040'O
        56 004532   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 004533   200011 200036                    ADSC9   BUFFER+4,,AUTO           cn=1,n=30
        56 004534   040100 100400                    MLR     fill='040'O
        56 004535   000451 000023 55                 ADSC9   297                      cn=0,n=19
        56 004536   200020 600023                    ADSC9   BUFFER+11,,AUTO          cn=3,n=19
        56 004537   040100 100400                    MLR     fill='040'O
        56 004540   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 004541   200025 400112                    ADSC9   BUFFER+16,,AUTO          cn=2,n=74

     1635     3789    3                '*4096,18) | BINBIT(',P_CODE.OPERAND(1));
     1636     3790                 %OUTPUT_STR;

   3795 56 004542   000000 236000 24                 LDQ     OUT_DCBN
        56 004543   004553 604000 56                 TMI     s:3797
        56 004544   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004545   004553 601000 56                 TNZ     s:3797
        56 004546   000000 236000 34                 LDQ     OPTIONS
        56 004547   000002 736000                    QLS     2
        56 004550   400000 376003                    ANQ     -131072,DU
        56 004551   400000 676003                    ERQ     -131072,DU
        56 004552   004565 601000 56                 TNZ     s:3801

   3797 56 004553   000214 235007                    LDA     140,DL
        56 004554   200050 755100                    STA     LEN,,AUTO

   3798 56 004555   200050 630500                    EPPR0   LEN,,AUTO
        56 004556   200277 450500                    STP0    CNT2+3,,AUTO
        56 004557   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004560   200276 451500                    STP1    CNT2+2,,AUTO
        56 004561   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004562   000000 631400 57                 EPPR1   0
        56 004563   000000 701000 xent               TSX1    OUTPUT
        56 004564   000000 011000                    NOP     0

     1637     3801    3            CALL CONCAT(BUFFER,'*32,18)) | BINBIT(',

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:232  
   3801 56 004565   040100 100400                    MLR     fill='040'O
        56 004566   000456 000022 55                 ADSC9   302                      cn=0,n=18
        56 004567   200005 000022                    ADSC9   BUFFER,,AUTO             cn=0,n=18
        56 004570   040100 100400                    MLR     fill='040'O
        56 004571   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 004572   200011 400036                    ADSC9   BUFFER+4,,AUTO           cn=2,n=30
        56 004573   040100 100400                    MLR     fill='040'O
        56 004574   000463 000007 55                 ADSC9   307                      cn=0,n=7
        56 004575   200021 000134                    ADSC9   BUFFER+12,,AUTO          cn=0,n=92

     1638     3802    3                P_CODE.OPERAND(2),',18))),');
     1639     3803                 %OUTPUT_STR;

   3808 56 004576   000000 236000 24                 LDQ     OUT_DCBN
        56 004577   004607 604000 56                 TMI     s:3810
        56 004600   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004601   004607 601000 56                 TNZ     s:3810
        56 004602   000000 236000 34                 LDQ     OPTIONS
        56 004603   000002 736000                    QLS     2
        56 004604   400000 376003                    ANQ     -131072,DU
        56 004605   400000 676003                    ERQ     -131072,DU
        56 004606   004621 601000 56                 TNZ     s:3814

   3810 56 004607   000214 235007                    LDA     140,DL
        56 004610   200050 755100                    STA     LEN,,AUTO

   3811 56 004611   200050 630500                    EPPR0   LEN,,AUTO
        56 004612   200277 450500                    STP0    CNT2+3,,AUTO
        56 004613   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004614   200276 451500                    STP1    CNT2+2,,AUTO
        56 004615   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004616   000000 631400 57                 EPPR1   0
        56 004617   000000 701000 xent               TSX1    OUTPUT
        56 004620   000000 011000                    NOP     0

     1640     3814    3            CALL CONCAT(BUFFER,'%(BITBIN(BINBIT(',P_CODE.OPERAND(5),

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:233  
   3814 56 004621   040100 100400                    MLR     fill='040'O
        56 004622   000465 000020 55                 ADSC9   309                      cn=0,n=16
        56 004623   200005 000020                    ADSC9   BUFFER,,AUTO             cn=0,n=16
        56 004624   040100 100400                    MLR     fill='040'O
        56 004625   001511 600036 52                 ADSC9   P_CODE+41                cn=3,n=30
        56 004626   200011 000036                    ADSC9   BUFFER+4,,AUTO           cn=0,n=30
        56 004627   040100 100400                    MLR     fill='040'O
        56 004630   000471 000016 55                 ADSC9   313                      cn=0,n=14
        56 004631   200020 400016                    ADSC9   BUFFER+11,,AUTO          cn=2,n=14
        56 004632   040100 100400                    MLR     fill='040'O
        56 004633   001472 600036 52                 ADSC9   P_CODE+26                cn=3,n=30
        56 004634   200024 000036                    ADSC9   BUFFER+15,,AUTO          cn=0,n=30
        56 004635   040100 100400                    MLR     fill='040'O
        56 004636   000475 000015 55                 ADSC9   317                      cn=0,n=13
        56 004637   200033 400062                    ADSC9   BUFFER+22,,AUTO          cn=2,n=50

     1641     3815    3                 ',18) | BINBIT(',P_CODE.OPERAND(3),' * 512,18))),');
     1642     3816                 %OUTPUT_STR;

   3821 56 004640   000000 236000 24                 LDQ     OUT_DCBN
        56 004641   004651 604000 56                 TMI     s:3823
        56 004642   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004643   004651 601000 56                 TNZ     s:3823
        56 004644   000000 236000 34                 LDQ     OPTIONS
        56 004645   000002 736000                    QLS     2
        56 004646   400000 376003                    ANQ     -131072,DU
        56 004647   400000 676003                    ERQ     -131072,DU
        56 004650   004663 601000 56                 TNZ     s:3827

   3823 56 004651   000214 235007                    LDA     140,DL
        56 004652   200050 755100                    STA     LEN,,AUTO

   3824 56 004653   200050 630500                    EPPR0   LEN,,AUTO
        56 004654   200277 450500                    STP0    CNT2+3,,AUTO
        56 004655   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004656   200276 451500                    STP1    CNT2+2,,AUTO
        56 004657   200276 630500                    EPPR0   CNT2+2,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:234  
        56 004660   000000 631400 57                 EPPR1   0
        56 004661   000000 701000 xent               TSX1    OUTPUT
        56 004662   000000 011000                    NOP     0

     1643     3827    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(4),',');

   3827 56 004663   040100 100400                    MLR     fill='040'O
        56 004664   001502 200036 52                 ADSC9   P_CODE+34                cn=1,n=30
        56 004665   200005 000036                    ADSC9   BUFFER,,AUTO             cn=0,n=30
        56 004666   040100 100400                    MLR     fill='040'O
        56 004667   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 004670   200014 400156                    ADSC9   BUFFER+7,,AUTO           cn=2,n=110

     1644     3828                 %OUTPUT_STR;

   3833 56 004671   000000 236000 24                 LDQ     OUT_DCBN
        56 004672   004702 604000 56                 TMI     s:3835
        56 004673   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004674   004702 601000 56                 TNZ     s:3835
        56 004675   000000 236000 34                 LDQ     OPTIONS
        56 004676   000002 736000                    QLS     2
        56 004677   400000 376003                    ANQ     -131072,DU
        56 004700   400000 676003                    ERQ     -131072,DU
        56 004701   004714 601000 56                 TNZ     s:3840

   3835 56 004702   000214 235007                    LDA     140,DL
        56 004703   200050 755100                    STA     LEN,,AUTO

   3836 56 004704   200050 630500                    EPPR0   LEN,,AUTO
        56 004705   200277 450500                    STP0    CNT2+3,,AUTO
        56 004706   200005 631500                    EPPR1   BUFFER,,AUTO
        56 004707   200276 451500                    STP1    CNT2+2,,AUTO
        56 004710   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 004711   000000 631400 57                 EPPR1   0
        56 004712   000000 701000 xent               TSX1    OUTPUT
        56 004713   000000 011000                    NOP     0

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:235  
     1645     3839                  %SELECT_LO;

   3840 56 004714   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 004715   000000 755000 24                 STA     OUT_DCBN

     1646     3842    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;

   3842 56 004716   000000 236000 53                 LDQ     CURRENT_OT_POS
        56 004717   000002 036007                    ADLQ    2,DL
        56 004720   000000 756000 53                 STQ     CURRENT_OT_POS

     1647     3843    3            RETURN;

   3843 56 004721   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 004722   000001 702211                    TSX2  ! 1,X1

     1648     3844
     1649     3845
     1650     3846    3          CASE(%APPLY);

     1651     3847    3            CALL CHARBIN(VFD_WORD,P_CODE.OPERAND(0));

   3847 56 004723   000100 305400                    DTB
        56 004724   001444 230036 52                 NDSC9   P_CODE+4                 cn=1,s=nosgn,sf=0,n=30
        56 004725   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004726   200277 236100                    LDQ     CNT2+3,,AUTO
        56 004727   200232 756100                    STQ     VFD_WORD,,AUTO

     1652     3848    3            P_CODE.OPERAND(0) = P_CODE.OPERAND(1);

   3848 56 004730   040000 100400                    MLR     fill='040'O
        56 004731   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 004732   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30

     1653     3849    3            CALL BINCHAR(P_CODE.OPERAND(1),VFD_OUT.UPPER);

   3849 56 004733   200232 235100                    LDA     VFD_WORD,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:236  
        56 004734   000022 771000                    ARL     18
        56 004735   000044 773000                    LRL     36
        56 004736   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004737   000000 301500                    BTD
        56 004740   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004741   001453 630036 52                 NDSC9   P_CODE+11                cn=3,s=nosgn,sf=0,n=30

     1654     3850    3            CALL BINCHAR(P_CODE.OPERAND(2),VFD_OUT.LOWER);

   3850 56 004742   200232 236100                    LDQ     VFD_WORD,,AUTO
        56 004743   777777 376007                    ANQ     -1,DL
        56 004744   000000 235003                    LDA     0,DU
        56 004745   200276 757100                    STAQ    CNT2+2,,AUTO
        56 004746   000000 301500                    BTD
        56 004747   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 004750   001463 230036 52                 NDSC9   P_CODE+19                cn=1,s=nosgn,sf=0,n=30
        56 004751   005274 710000 56                 TRA     s:3965

     1655     3851
     1656     3852    3          CASE(%CASE);

     1657     3853    3            P_CODE.OPERAND(0) = ZILCH;

   3853 56 004752   040000 100400                    MLR     fill='040'O
        56 004753   000501 000036 55                 ADSC9   321                      cn=0,n=30
        56 004754   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 004755   005274 710000 56                 TRA     s:3965

     1658     3854
     1659     3855    3          CASE(%IFID);

     1660     3856                 %SELECT_OU;

   3857 56 004756   000000 236000 xsym               LDQ     Z8PS$M$OU#
        56 004757   000000 756000 24                 STQ     OUT_DCBN

     1661     3859    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',');
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:237  

   3859 56 004760   040100 100400                    MLR     fill='040'O
        56 004761   001440 000014 52                 ADSC9   P_CODE                   cn=0,n=12
        56 004762   200005 000014                    ADSC9   BUFFER,,AUTO             cn=0,n=12
        56 004763   040100 100400                    MLR     fill='040'O
        56 004764   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 004765   200010 000200                    ADSC9   BUFFER+3,,AUTO           cn=0,n=128

     1662     3860                 %OUTPUT_STR;

   3865 56 004766   000000 236000 24                 LDQ     OUT_DCBN
        56 004767   004777 604000 56                 TMI     s:3867
        56 004770   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 004771   004777 601000 56                 TNZ     s:3867
        56 004772   000000 236000 34                 LDQ     OPTIONS
        56 004773   000002 736000                    QLS     2
        56 004774   400000 376003                    ANQ     -131072,DU
        56 004775   400000 676003                    ERQ     -131072,DU
        56 004776   005011 601000 56                 TNZ     s:3871

   3867 56 004777   000214 235007                    LDA     140,DL
        56 005000   200050 755100                    STA     LEN,,AUTO

   3868 56 005001   200050 630500                    EPPR0   LEN,,AUTO
        56 005002   200277 450500                    STP0    CNT2+3,,AUTO
        56 005003   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005004   200276 451500                    STP1    CNT2+2,,AUTO
        56 005005   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005006   000000 631400 57                 EPPR1   0
        56 005007   000000 701000 xent               TSX1    OUTPUT
        56 005010   000000 011000                    NOP     0

     1663     3871    3            CALL CONCAT(BUFFER,'%(BITBIN(BINBIT(',P_CODE.OPERAND(0),

   3871 56 005011   040100 100400                    MLR     fill='040'O
        56 005012   000465 000020 55                 ADSC9   309                      cn=0,n=16
        56 005013   200005 000020                    ADSC9   BUFFER,,AUTO             cn=0,n=16
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:238  
        56 005014   040100 100400                    MLR     fill='040'O
        56 005015   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 005016   200011 000036                    ADSC9   BUFFER+4,,AUTO           cn=0,n=30
        56 005017   040100 100400                    MLR     fill='040'O
        56 005020   000451 000023 55                 ADSC9   297                      cn=0,n=19
        56 005021   200020 400023                    ADSC9   BUFFER+11,,AUTO          cn=2,n=19
        56 005022   040100 100400                    MLR     fill='040'O
        56 005023   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 005024   200025 200036                    ADSC9   BUFFER+16,,AUTO          cn=1,n=30
        56 005025   040100 100400                    MLR     fill='040'O
        56 005026   000511 000012 55                 ADSC9   329                      cn=0,n=10
        56 005027   200034 600055                    ADSC9   BUFFER+23,,AUTO          cn=3,n=45

     1664     3872    3                  '*4096,18) | BINBIT(',P_CODE.OPERAND(1),'*32,18))),');
     1665     3873                 %OUTPUT_STR;

   3878 56 005030   000000 236000 24                 LDQ     OUT_DCBN
        56 005031   005041 604000 56                 TMI     s:3880
        56 005032   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005033   005041 601000 56                 TNZ     s:3880
        56 005034   000000 236000 34                 LDQ     OPTIONS
        56 005035   000002 736000                    QLS     2
        56 005036   400000 376003                    ANQ     -131072,DU
        56 005037   400000 676003                    ERQ     -131072,DU
        56 005040   005053 601000 56                 TNZ     s:3885

   3880 56 005041   000214 235007                    LDA     140,DL
        56 005042   200050 755100                    STA     LEN,,AUTO

   3881 56 005043   200050 630500                    EPPR0   LEN,,AUTO
        56 005044   200277 450500                    STP0    CNT2+3,,AUTO
        56 005045   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005046   200276 451500                    STP1    CNT2+2,,AUTO
        56 005047   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005050   000000 631400 57                 EPPR1   0
        56 005051   000000 701000 xent               TSX1    OUTPUT
        56 005052   000000 011000                    NOP     0
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:239  

     1666     3884
     1667     3885    3            IF P_CODE.OPERAND(2) = ZILCH THEN

   3885 56 005053   040000 106400                    CMPC    fill='040'O
        56 005054   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 005055   000501 000036 55                 ADSC9   321                      cn=0,n=30
        56 005056   005113 601000 56                 TNZ     s:3900

     1668     3886    4              DO;

     1669     3887    4                CALL CONCAT(BUFFER,%SPACER# '2,',P_CODE.OPERAND(3),',');

   3887 56 005057   000514 220000 55                 LDX0    332
        56 005060   200005 740100                    STX0    BUFFER,,AUTO
        56 005061   040100 100400                    MLR     fill='040'O
        56 005062   001472 600036 52                 ADSC9   P_CODE+26                cn=3,n=30
        56 005063   200005 400036                    ADSC9   BUFFER,,AUTO             cn=2,n=30
        56 005064   040100 100400                    MLR     fill='040'O
        56 005065   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 005066   200015 000154                    ADSC9   BUFFER+8,,AUTO           cn=0,n=108

     1670     3888                     %OUTPUT_STR;

   3893 56 005067   000000 236000 24                 LDQ     OUT_DCBN
        56 005070   005100 604000 56                 TMI     s:3895
        56 005071   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005072   005100 601000 56                 TNZ     s:3895
        56 005073   000000 236000 34                 LDQ     OPTIONS
        56 005074   000002 736000                    QLS     2
        56 005075   400000 376003                    ANQ     -131072,DU
        56 005076   400000 676003                    ERQ     -131072,DU
        56 005077   005207 601000 56                 TNZ     s:3931

   3895 56 005100   000214 235007                    LDA     140,DL
        56 005101   200050 755100                    STA     LEN,,AUTO

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:240  
   3896 56 005102   200050 630500                    EPPR0   LEN,,AUTO
        56 005103   200277 450500                    STP0    CNT2+3,,AUTO
        56 005104   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005105   200276 451500                    STP1    CNT2+2,,AUTO
        56 005106   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005107   000000 631400 57                 EPPR1   0
        56 005110   000000 701000 xent               TSX1    OUTPUT
        56 005111   000000 011000                    NOP     0

     1671     3899    4              END;

   3899 56 005112   005207 710000 56                 TRA     s:3931

     1672     3900    3            ELSE IF P_CODE.OPERAND(3) = ZILCH THEN

   3900 56 005113   040000 106400                    CMPC    fill='040'O
        56 005114   001472 600036 52                 ADSC9   P_CODE+26                cn=3,n=30
        56 005115   000501 000036 55                 ADSC9   321                      cn=0,n=30
        56 005116   005151 601000 56                 TNZ     s:3917

     1673     3901    4                   DO;

     1674     3902    4                      CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(2),',2,');

   3902 56 005117   040100 100400                    MLR     fill='040'O
        56 005120   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 005121   200005 000036                    ADSC9   BUFFER,,AUTO             cn=0,n=30
        56 005122   040100 100400                    MLR     fill='040'O
        56 005123   000515 000003 55                 ADSC9   333                      cn=0,n=3
        56 005124   200014 400156                    ADSC9   BUFFER+7,,AUTO           cn=2,n=110

     1675     3903                           %OUTPUT_STR;

   3908 56 005125   000000 236000 24                 LDQ     OUT_DCBN
        56 005126   005136 604000 56                 TMI     s:3910
        56 005127   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005130   005136 601000 56                 TNZ     s:3910
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:241  
        56 005131   000000 236000 34                 LDQ     OPTIONS
        56 005132   000002 736000                    QLS     2
        56 005133   400000 376003                    ANQ     -131072,DU
        56 005134   400000 676003                    ERQ     -131072,DU
        56 005135   005207 601000 56                 TNZ     s:3931

   3910 56 005136   000214 235007                    LDA     140,DL
        56 005137   200050 755100                    STA     LEN,,AUTO

   3911 56 005140   200050 630500                    EPPR0   LEN,,AUTO
        56 005141   200277 450500                    STP0    CNT2+3,,AUTO
        56 005142   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005143   200276 451500                    STP1    CNT2+2,,AUTO
        56 005144   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005145   000000 631400 57                 EPPR1   0
        56 005146   000000 701000 xent               TSX1    OUTPUT
        56 005147   000000 011000                    NOP     0

     1676     3914    4                   END;

   3914 56 005150   005207 710000 56                 TRA     s:3931

     1677     3915    3                 ELSE
     1678     3916    4                   DO;

     1679     3917    4                    CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(2),',',P_CODE.OPERAND(3
              3917                              ),',');

   3917 56 005151   040100 100400                    MLR     fill='040'O
        56 005152   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 005153   200005 000036                    ADSC9   BUFFER,,AUTO             cn=0,n=30
        56 005154   054000 236007                    LDQ     22528,DL
        56 005155   200014 552110                    STBQ    BUFFER+7,'10'O,AUTO
        56 005156   040100 100400                    MLR     fill='040'O
        56 005157   001472 600036 52                 ADSC9   P_CODE+26                cn=3,n=30
        56 005160   200014 600036                    ADSC9   BUFFER+7,,AUTO           cn=3,n=30
        56 005161   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:242  
        56 005162   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 005163   200024 200117                    ADSC9   BUFFER+15,,AUTO          cn=1,n=79

     1680     3918                          %OUTPUT_STR;

   3923 56 005164   000000 236000 24                 LDQ     OUT_DCBN
        56 005165   005175 604000 56                 TMI     s:3925
        56 005166   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005167   005175 601000 56                 TNZ     s:3925
        56 005170   000000 236000 34                 LDQ     OPTIONS
        56 005171   000002 736000                    QLS     2
        56 005172   400000 376003                    ANQ     -131072,DU
        56 005173   400000 676003                    ERQ     -131072,DU
        56 005174   005207 601000 56                 TNZ     s:3931

   3925 56 005175   000214 235007                    LDA     140,DL
        56 005176   200050 755100                    STA     LEN,,AUTO

   3926 56 005177   200050 630500                    EPPR0   LEN,,AUTO
        56 005200   200277 450500                    STP0    CNT2+3,,AUTO
        56 005201   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005202   200276 451500                    STP1    CNT2+2,,AUTO
        56 005203   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005204   000000 631400 57                 EPPR1   0
        56 005205   000000 701000 xent               TSX1    OUTPUT
        56 005206   000000 011000                    NOP     0

     1681     3929    4                   END;

     1682     3930                 %SELECT_LO;

   3931 56 005207   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 005210   000000 755000 24                 STA     OUT_DCBN

     1683     3933    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;

   3933 56 005211   000000 236000 53                 LDQ     CURRENT_OT_POS
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:243  
        56 005212   000002 036007                    ADLQ    2,DL
        56 005213   000000 756000 53                 STQ     CURRENT_OT_POS

     1684     3934    3            RETURN;

   3934 56 005214   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 005215   000001 702211                    TSX2  ! 1,X1

     1685     3935
     1686     3936    3          CASE(%IFITIS);

     1687     3937    3            IF P_CODE.OPERAND(1) = ZILCH THEN

   3937 56 005216   040000 106400                    CMPC    fill='040'O
        56 005217   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 005220   000501 000036 55                 ADSC9   321                      cn=0,n=30
        56 005221   005226 601000 56                 TNZ     s:3939

     1688     3938    3              P_CODE.OPERAND(1) = '2';

   3938 56 005222   040000 100400                    MLR     fill='040'O
        56 005223   000050 000001 57                 ADSC9   40                       cn=0,n=1
        56 005224   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 005225   005274 710000 56                 TRA     s:3965

     1689     3939    3            ELSE P_CODE.OPERAND(2) = '2';

   3939 56 005226   040000 100400                    MLR     fill='040'O
        56 005227   000050 000001 57                 ADSC9   40                       cn=0,n=1
        56 005230   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 005231   005274 710000 56                 TRA     s:3965

     1690     3940
     1691     3941    3          CASE(%EQLR);

     1692     3942    3            IF P_CODE.OPERAND(0) = ZILCH THEN

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:244  
   3942 56 005232   040000 106400                    CMPC    fill='040'O
        56 005233   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 005234   000501 000036 55                 ADSC9   321                      cn=0,n=30
        56 005235   005241 601000 56                 TNZ     s:3944

     1693     3943    3              P_CODE.OPERAND(0) = '2';

   3943 56 005236   040000 100400                    MLR     fill='040'O
        56 005237   000050 000001 57                 ADSC9   40                       cn=0,n=1
        56 005240   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30

     1694     3944    3            IF P_CODE.OPERAND(1) = ZILCH THEN

   3944 56 005241   040000 106400                    CMPC    fill='040'O
        56 005242   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 005243   000501 000036 55                 ADSC9   321                      cn=0,n=30
        56 005244   005274 601000 56                 TNZ     s:3965

     1695     3945    3               P_CODE.OPERAND(1) = '2';

   3945 56 005245   040000 100400                    MLR     fill='040'O
        56 005246   000050 000001 57                 ADSC9   40                       cn=0,n=1
        56 005247   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 005250   005274 710000 56                 TRA     s:3965

     1696     3946
     1697     3947    3          CASE(%EQUATE,%NULL,%ENTER_PL6,%PAGE,%START);

     1698     3948    3            RETURN;

   3948 56 005251   000001 702211                    TSX2  ! 1,X1

     1699     3949
     1700     3950    3          CASE(%LIB);

     1701     3951    3            IF P_CODE.OPERAND(0) = 'PCOM' THEN

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:245  
   3951 56 005252   040000 106400                    CMPC    fill='040'O
        56 005253   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 005254   000516 000004 55                 ADSC9   334                      cn=0,n=4
        56 005255   005274 601000 56                 TNZ     s:3965

     1702     3952    4              DO;

     1703     3953    4                P_CODE.OPERAND(0) = P_CODE.OPERAND(1);

   3953 56 005256   040000 100400                    MLR     fill='040'O
        56 005257   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 005260   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30

     1704     3954    4                P_CODE.OPERAND(1) = P_CODE.OPERAND(2);

   3954 56 005261   040000 100400                    MLR     fill='040'O
        56 005262   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 005263   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30

     1705     3955    4                P_CODE.OPERAND(2) = '%PCOM';

   3955 56 005264   040000 100400                    MLR     fill='040'O
        56 005265   000517 000005 55                 ADSC9   335                      cn=0,n=5
        56 005266   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30

     1706     3956    4              END;

   3956 56 005267   005274 710000 56                 TRA     s:3965

     1707     3957
     1708     3958    3          CASE(ELSE);

     1709     3959    3            CALL Z8PA$ERROR_PROC(%MESS8);

   3959 56 005270   000051 630400 57                 EPPR0   41
        56 005271   000006 631400 57                 EPPR1   6
        56 005272   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:246  
        56 005273   000000 011000                    NOP     0

     1710     3960    3        END; /* CASE */

     1711     3961
     1712     3962
     1713     3963            /* Output the P_CODE to the object table */
     1714     3964             %SELECT_OU;

   3965 56 005274   000000 235000 xsym               LDA     Z8PS$M$OU#
        56 005275   000000 755000 24                 STA     OUT_DCBN

     1715     3967    2        CALL BLANK_ZERO(ADDR(P_CODE.OPERAND(0)),%OPERAND_LEN);

   3967 56 005276   000052 236000 57                 LDQ     42
        56 005277   200276 756100                    STQ     CNT2+2,,AUTO
        56 005300   000021 236000 57                 LDQ     17
        56 005301   200301 756100                    STQ     CNT2+5,,AUTO
        56 005302   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005303   200300 450500                    STP0    CNT2+4,,AUTO
        56 005304   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 005305   000000 631400 57                 EPPR1   0
        56 005306   000000 701000 xent               TSX1    BLANK_ZERO
        56 005307   000000 011000                    NOP     0

     1716     3968    2        CALL CONCAT(BUFFER,%SPACER# P_CODE.SIMPLE_DIR,',',

   3968 56 005310   040100 100400                    MLR     fill='040'O
        56 005311   001440 000014 52                 ADSC9   P_CODE                   cn=0,n=12
        56 005312   200005 000014                    ADSC9   BUFFER,,AUTO             cn=0,n=12
        56 005313   054000 236003                    LDQ     22528,DU
        56 005314   200010 756100                    STQ     BUFFER+3,,AUTO
        56 005315   040100 100400                    MLR     fill='040'O
        56 005316   001444 200036 52                 ADSC9   P_CODE+4                 cn=1,n=30
        56 005317   200010 200036                    ADSC9   BUFFER+3,,AUTO           cn=1,n=30
        56 005320   040100 100400                    MLR     fill='040'O
        56 005321   000031 000001 57                 ADSC9   25                       cn=0,n=1
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:247  
        56 005322   200017 600141                    ADSC9   BUFFER+10,,AUTO          cn=3,n=97

     1717     3969    2                    P_CODE.OPERAND(0),',');
     1718     3970             %OUTPUT_STR;

   3975 56 005323   000000 236000 24                 LDQ     OUT_DCBN
        56 005324   005334 604000 56                 TMI     s:3977
        56 005325   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005326   005334 601000 56                 TNZ     s:3977
        56 005327   000000 236000 34                 LDQ     OPTIONS
        56 005330   000002 736000                    QLS     2
        56 005331   400000 376003                    ANQ     -131072,DU
        56 005332   400000 676003                    ERQ     -131072,DU
        56 005333   005346 601000 56                 TNZ     s:3981

   3977 56 005334   000214 235007                    LDA     140,DL
        56 005335   200050 755100                    STA     LEN,,AUTO

   3978 56 005336   200050 630500                    EPPR0   LEN,,AUTO
        56 005337   200277 450500                    STP0    CNT2+3,,AUTO
        56 005340   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005341   200276 451500                    STP1    CNT2+2,,AUTO
        56 005342   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005343   000000 631400 57                 EPPR1   0
        56 005344   000000 701000 xent               TSX1    OUTPUT
        56 005345   000000 011000                    NOP     0

     1719     3981    2        IF P_CODE.TWO_WORDS THEN

   3981 56 005346   001444 234000 52                 SZN     P_CODE+4
        56 005347   005436 605000 56                 TPL     s:4000

     1720     3982    3          DO;

     1721     3983    3            CALL BLANK_ZERO(ADDR(P_CODE.OPERAND(1)),%OPERAND_LEN);

   3983 56 005350   000027 236000 57                 LDQ     23
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:248  
        56 005351   200276 756100                    STQ     CNT2+2,,AUTO
        56 005352   000021 236000 57                 LDQ     17
        56 005353   200301 756100                    STQ     CNT2+5,,AUTO
        56 005354   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005355   200300 450500                    STP0    CNT2+4,,AUTO
        56 005356   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 005357   000000 631400 57                 EPPR1   0
        56 005360   000000 701000 xent               TSX1    BLANK_ZERO
        56 005361   000000 011000                    NOP     0

     1722     3984    3            CALL BLANK_ZERO(ADDR(P_CODE.OPERAND(2)),%OPERAND_LEN);

   3984 56 005362   000053 236000 57                 LDQ     43
        56 005363   200276 756100                    STQ     CNT2+2,,AUTO
        56 005364   000021 236000 57                 LDQ     17
        56 005365   200301 756100                    STQ     CNT2+5,,AUTO
        56 005366   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005367   200300 450500                    STP0    CNT2+4,,AUTO
        56 005370   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 005371   000000 631400 57                 EPPR1   0
        56 005372   000000 701000 xent               TSX1    BLANK_ZERO
        56 005373   000000 011000                    NOP     0

     1723     3985    3            CALL CONCAT(BUFFER,%SPACER# P_CODE.OPERAND(1),',',

   3985 56 005374   040100 100400                    MLR     fill='040'O
        56 005375   001453 600036 52                 ADSC9   P_CODE+11                cn=3,n=30
        56 005376   200005 000036                    ADSC9   BUFFER,,AUTO             cn=0,n=30
        56 005377   054000 236007                    LDQ     22528,DL
        56 005400   200014 552110                    STBQ    BUFFER+7,'10'O,AUTO
        56 005401   040100 100400                    MLR     fill='040'O
        56 005402   001463 200036 52                 ADSC9   P_CODE+19                cn=1,n=30
        56 005403   200014 600036                    ADSC9   BUFFER+7,,AUTO           cn=3,n=30
        56 005404   040100 100400                    MLR     fill='040'O
        56 005405   000031 000001 57                 ADSC9   25                       cn=0,n=1
        56 005406   200024 200117                    ADSC9   BUFFER+15,,AUTO          cn=1,n=79

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:249  
     1724     3986    3                        P_CODE.OPERAND(2),',');
     1725     3987                 %OUTPUT_STR;

   3992 56 005407   000000 236000 24                 LDQ     OUT_DCBN
        56 005410   005420 604000 56                 TMI     s:3994
        56 005411   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005412   005420 601000 56                 TNZ     s:3994
        56 005413   000000 236000 34                 LDQ     OPTIONS
        56 005414   000002 736000                    QLS     2
        56 005415   400000 376003                    ANQ     -131072,DU
        56 005416   400000 676003                    ERQ     -131072,DU
        56 005417   005432 601000 56                 TNZ     s:3998

   3994 56 005420   000214 235007                    LDA     140,DL
        56 005421   200050 755100                    STA     LEN,,AUTO

   3995 56 005422   200050 630500                    EPPR0   LEN,,AUTO
        56 005423   200277 450500                    STP0    CNT2+3,,AUTO
        56 005424   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005425   200276 451500                    STP1    CNT2+2,,AUTO
        56 005426   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005427   000000 631400 57                 EPPR1   0
        56 005430   000000 701000 xent               TSX1    OUTPUT
        56 005431   000000 011000                    NOP     0

     1726     3998    3            CURRENT_OT_POS = CURRENT_OT_POS + 2;

   3998 56 005432   000000 235000 53                 LDA     CURRENT_OT_POS
        56 005433   000002 035007                    ADLA    2,DL
        56 005434   000000 755000 53                 STA     CURRENT_OT_POS

     1727     3999    3          END;

   3999 56 005435   005441 710000 56                 TRA     s:4002

     1728     4000    2        ELSE CURRENT_OT_POS = CURRENT_OT_POS + 1;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:250  
   4000 56 005436   000000 235000 53                 LDA     CURRENT_OT_POS
        56 005437   000001 035007                    ADLA    1,DL
        56 005440   000000 755000 53                 STA     CURRENT_OT_POS

     1729     4001             %SELECT_LO;

   4002 56 005441   000000 236000 xsym               LDQ     Z8PS$M$LO#
        56 005442   000000 756000 24                 STQ     OUT_DCBN

     1730     4004    2    END GEN_P_CODE;

   4004 56 005443   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 005444   000001 702211                    TSX2  ! 1,X1

     1731     4005
     1732     4006         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:251  
     1733     4007    1    GENERATE_XREF :PROC;

   4007 56 005445   200240 741300       GENERATE_XR* STX1  ! SHIFT_FACTOR+2,,AUTO

     1734     4008         /*I*
     1735     4009              NAME: GENERATE_XREF
     1736     4010              PURPOSE:
     1737     4011                   Generate the cross reference to be output to the end of the PCA
     1738     4012                   listing.
     1739     4013              CALL:
     1740     4014                   CALL GENERATE_XREF;
     1741     4015              DATA:
     1742     4016                   REF_LIST, LABEL_TABLE
     1743     4017              DESCRIPTION:
     1744     4018                   For each entry in the  LABEL_TABLE step through its
     1745     4019                   list of references in REF_LIST.  Output this list of
     1746     4020                   references along with the type of label it is.
     1747     4021         */
     1748     4022    2        DCL POS PTR;
     1749     4023
     1750     4024    2        HEADER_LINE2 = 'CROSS REFERENCE FOR LABEL DEFINITIONS AND REFERENCES';

   4024 56 005446   040000 100400                    MLR     fill='040'O
        56 005447   000540 000064 55                 ADSC9   352                      cn=0,n=52
        56 005450   000000 000144 46                 ADSC9   HEADER_LINE2             cn=0,n=100

     1751     4025    2        HEADER_LINE3 =
              4025                 'SYMBOL                        TYPE  DEFINED          REFERENCES';

   4025 56 005451   040000 100400                    MLR     fill='040'O
        56 005452   000555 000077 55                 ADSC9   365                      cn=0,n=63
        56 005453   000000 000144 45                 ADSC9   HEADER_LINE3             cn=0,n=100

     1752     4026    2        CALL EJECT_PAGE;

   4026 56 005454   000002 631400 57                 EPPR1   2
        56 005455   000000 701000 xent               TSX1    EJECT_PAGE
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:252  
        56 005456   000000 011000                    NOP     0

     1753     4027    2        CALL OUTPUT_HEADER;

   4027 56 005457   000002 631400 57                 EPPR1   2
        56 005460   000000 701000 xent               TSX1    OUTPUT_HEADER
        56 005461   000000 011000                    NOP     0

     1754     4028
     1755     4029             /* Output a key to the type codes */
     1756     4030    2        BUFFER = ' ';

   4030 56 005462   040100 100400                    MLR     fill='040'O
        56 005463   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 005464   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1757     4031             %OUTPUT_STR;

   4036 56 005465   000000 236000 24                 LDQ     OUT_DCBN
        56 005466   005476 604000 56                 TMI     s:4038
        56 005467   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005470   005476 601000 56                 TNZ     s:4038
        56 005471   000000 236000 34                 LDQ     OPTIONS
        56 005472   000002 736000                    QLS     2
        56 005473   400000 376003                    ANQ     -131072,DU
        56 005474   400000 676003                    ERQ     -131072,DU
        56 005475   005510 601000 56                 TNZ     s:4042

   4038 56 005476   000214 235007                    LDA     140,DL
        56 005477   200050 755100                    STA     LEN,,AUTO

   4039 56 005500   200050 630500                    EPPR0   LEN,,AUTO
        56 005501   200277 450500                    STP0    CNT2+3,,AUTO
        56 005502   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005503   200276 451500                    STP1    CNT2+2,,AUTO
        56 005504   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005505   000000 631400 57                 EPPR1   0
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:253  
        56 005506   000000 701000 xent               TSX1    OUTPUT
        56 005507   000000 011000                    NOP     0

     1758     4042    2        BUFFER = '    Types are: ** = PEPD entry, UD = undefined.';

   4042 56 005510   040100 100400                    MLR     fill='040'O
        56 005511   000575 000057 55                 ADSC9   381                      cn=0,n=47
        56 005512   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1759     4043             %OUTPUT_STR;

   4048 56 005513   000000 236000 24                 LDQ     OUT_DCBN
        56 005514   005524 604000 56                 TMI     s:4050
        56 005515   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005516   005524 601000 56                 TNZ     s:4050
        56 005517   000000 236000 34                 LDQ     OPTIONS
        56 005520   000002 736000                    QLS     2
        56 005521   400000 376003                    ANQ     -131072,DU
        56 005522   400000 676003                    ERQ     -131072,DU
        56 005523   005536 601000 56                 TNZ     s:4054

   4050 56 005524   000214 235007                    LDA     140,DL
        56 005525   200050 755100                    STA     LEN,,AUTO

   4051 56 005526   200050 630500                    EPPR0   LEN,,AUTO
        56 005527   200277 450500                    STP0    CNT2+3,,AUTO
        56 005530   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005531   200276 451500                    STP1    CNT2+2,,AUTO
        56 005532   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005533   000000 631400 57                 EPPR1   0
        56 005534   000000 701000 xent               TSX1    OUTPUT
        56 005535   000000 011000                    NOP     0

     1760     4054    2        BUFFER = ' ';

   4054 56 005536   040100 100400                    MLR     fill='040'O
        56 005537   000001 000001 57                 ADSC9   1                        cn=0,n=1
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:254  
        56 005540   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1761     4055             %OUTPUT_STR;

   4060 56 005541   000000 236000 24                 LDQ     OUT_DCBN
        56 005542   005552 604000 56                 TMI     s:4062
        56 005543   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005544   005552 601000 56                 TNZ     s:4062
        56 005545   000000 236000 34                 LDQ     OPTIONS
        56 005546   000002 736000                    QLS     2
        56 005547   400000 376003                    ANQ     -131072,DU
        56 005550   400000 676003                    ERQ     -131072,DU
        56 005551   005564 601000 56                 TNZ     s:4069

   4062 56 005552   000214 235007                    LDA     140,DL
        56 005553   200050 755100                    STA     LEN,,AUTO

   4063 56 005554   200050 630500                    EPPR0   LEN,,AUTO
        56 005555   200277 450500                    STP0    CNT2+3,,AUTO
        56 005556   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005557   200276 451500                    STP1    CNT2+2,,AUTO
        56 005560   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005561   000000 631400 57                 EPPR1   0
        56 005562   000000 701000 xent               TSX1    OUTPUT
        56 005563   000000 011000                    NOP     0

     1762     4066
     1763     4067
     1764     4068               /* For each label in the label table list all references to it */
     1765     4069    2        IF TOP_LABEL_TABLE ~= ADDR(NIL) THEN

   4069 56 005564   001523 236000 52                 LDQ     TOP_LABEL_TABLE
        56 005565   000004 116000 57                 CMPQ    4
        56 005566   005573 600000 56                 TZE     s:4072

     1766     4070    2          CALL Z8PA$OUTPUT_XREF(TOP_LABEL_TABLE);

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:255  
   4070 56 005567   000007 630400 57                 EPPR0   7
        56 005570   000006 631400 57                 EPPR1   6
        56 005571   000000 701000 xent               TSX1    Z8PA$OUTPUT_XREF
        56 005572   000000 011000                    NOP     0

     1767     4071
     1768     4072    2    END GENERATE_XREF;

   4072 56 005573   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 005574   000001 702211                    TSX2  ! 1,X1

     1769     4073         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:256  
     1770     4074    1    GEN_JMP_DEST : PROC(TABLE);

   4074 56 005575   200240 741300       GEN_JMP_DEST STX1  ! SHIFT_FACTOR+2,,AUTO

     1771     4075
     1772     4076    2        DCL TABLE PTR;
     1773     4077
     1774     4078             %SELECT_SUBS;

   4079 56 005576   000000 235000 xsym               LDA     Z8PS$M$SO#
        56 005577   000000 755000 24                 STA     OUT_DCBN

     1775     4081
     1776     4082    2        IF TABLE ~= ADDR(NIL) THEN

   4082 56 005600   200241 470500                    LDP0    @TABLE,,AUTO
        56 005601   000000 236100                    LDQ     0,,PR0
        56 005602   000004 116000 57                 CMPQ    4
        56 005603   005610 600000 56                 TZE     s:4086

     1777     4083    2          CALL Z8PA$OUTPUT_JMP_DEST(TABLE);

   4083 56 005604   200241 630500                    EPPR0   @TABLE,,AUTO
        56 005605   000006 631400 57                 EPPR1   6
        56 005606   000000 701000 xent               TSX1    Z8PA$OUTPUT_JMP_DEST
        56 005607   000000 011000                    NOP     0

     1778     4084
     1779     4085             %SELECT_LO;

   4086 56 005610   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 005611   000000 755000 24                 STA     OUT_DCBN

     1780     4088
     1781     4089    2    END GEN_JMP_DEST;

   4089 56 005612   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:257  
        56 005613   000001 702211                    TSX2  ! 1,X1

     1782     4090         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:258  
     1783     4091
     1784     4092    1    OUTPUT_BURST_DEST : PROC;

   4092 56 005614   200240 741300       OUTPUT_BURS* STX1  ! SHIFT_FACTOR+2,,AUTO

     1785     4093         /*I*
     1786     4094              NAME: OUTPUT_BURST_DEST
     1787     4095              PURPOSE:
     1788     4096                   Generate definitions for the labels created for BURST directives
     1789     4097                   when they were output to the object table.
     1790     4098              CALL:
     1791     4099                   CALL OUTPUT_BURST_DEST;
     1792     4100              DATA:
     1793     4101                   BURST_TABLE
     1794     4102                   DEP
     1795     4103              DESCRIPTION:
     1796     4104                   Step through the burst table.  For each entry search the DEP
     1797     4105                   table (where DEP entrys from START directives are stored) to
     1798     4106                   find the id (position in output DEP).  Output to M$SO  an
     1799     4107                   equ that sets the created label equal to the id.
     1800     4108         */
     1801     4109
     1802     4110    2        DCL CNT PTR;
     1803     4111    2        DCL CNT2 PTR;
     1804     4112    2        DCL TEXT CHAR(8);
     1805     4113    2        DCL MESS CHAR(%MESS_LEN);
     1806     4114
     1807     4115             %SELECT_SUBS;

   4116 56 005615   000000 235000 xsym               LDA     Z8PS$M$SO#
        56 005616   000000 755000 24                 STA     OUT_DCBN

     1808     4118
     1809     4119    2        CNT = TOP_BURST_TABLE;

   4119 56 005617   001532 236000 52                 LDQ     TOP_BURST_TABLE
        56 005620   200241 756100                    STQ     CNT,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:259  

     1810     4120    3        DO WHILE(CNT ~= ADDR(NIL));

   4120 56 005621   005734 710000 56                 TRA     s:4153

     1811     4121    3          CNT2 = TOP_DEP;

   4121 56 005622   001531 236000 52                 LDQ     TOP_DEP
        56 005623   200242 756100                    STQ     CNT2,,AUTO

     1812     4122
     1813     4123    4          DO WHILE ((CNT2 ~= ADDR(NIL)) AND

   4123 56 005624   005630 710000 56                 TRA     s:4126

     1814     4124    4                    (CNT2->DEP.LT_POS ~= CNT->BURST_TABLE.LABEL_POS));
     1815     4125    4            CNT2 = CNT2->DEP.NEXT;

   4125 56 005625   200242 470500                    LDP0    CNT2,,AUTO
        56 005626   000001 236100                    LDQ     1,,PR0
        56 005627   200242 756100                    STQ     CNT2,,AUTO

     1816     4126    4          END;

   4126 56 005630   000004 116000 57                 CMPQ    4
        56 005631   005637 600000 56                 TZE     s:4128
        56 005632   200242 470500                    LDP0    CNT2,,AUTO
        56 005633   200241 471500                    LDP1    CNT,,AUTO
        56 005634   000000 236100                    LDQ     0,,PR0
        56 005635   100000 116100                    CMPQ    0,,PR1
        56 005636   005625 601000 56                 TNZ     s:4125

     1817     4127
     1818     4128    3          IF CNT2 = ADDR(NIL) THEN

   4128 56 005637   200242 236100                    LDQ     CNT2,,AUTO
        56 005640   000004 116000 57                 CMPQ    4
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:260  
        56 005641   005661 601000 56                 TNZ     s:4136

     1819     4129    4            DO;

     1820     4130    4              CALL CONCAT(MESS,%MESS6,

   4130 56 005642   200241 470500                    LDP0    CNT,,AUTO
        56 005643   000000 471500                    LDP1    0,,PR0
        56 005644   040100 100400                    MLR     fill='040'O
        56 005645   000611 000057 55                 ADSC9   393                      cn=0,n=47
        56 005646   200245 000057                    ADSC9   MESS,,AUTO               cn=0,n=47
        56 005647   040100 100500                    MLR     fill='040'O
        56 005650   100000 000015                    ADSC9   0,,PR1                   cn=0,n=13
        56 005651   200260 600015                    ADSC9   OPCODE_WORD,,AUTO        cn=3,n=13

     1821     4131    4                        CNT->BURST_TABLE.LABEL_POS->LABEL_TABLE.NAME);
     1822     4132    4              CALL Z8PA$ERROR_PROC(MESS);

   4132 56 005652   200245 630500                    EPPR0   MESS,,AUTO
        56 005653   200276 450500                    STP0    CNT2+2,,AUTO
        56 005654   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005655   000006 631400 57                 EPPR1   6
        56 005656   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 005657   000000 011000                    NOP     0

     1823     4133    4            END;

   4133 56 005660   005731 710000 56                 TRA     s:4152

     1824     4134    3          ELSE
     1825     4135    4            DO;

     1826     4136    4              CALL BINCHAR(TEXT,CNT2->DEP.LT_POS->LABEL_TABLE.LOCATION);

   4136 56 005661   200242 470500                    LDP0    CNT2,,AUTO
        56 005662   000000 471500                    LDP1    0,,PR0
        56 005663   000100 301500                    BTD
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:261  
        56 005664   100010 000004                    NDSC9   8,,PR1                   cn=0,s=lsgnf,sf=0,n=4
        56 005665   200243 030010                    NDSC9   TEXT,,AUTO               cn=0,s=nosgn,sf=0,n=8

     1827     4137    4              CALL CONCAT(BUFFER,'%EQU D',CNT->BURST_TABLE.DEST,

   4137 56 005666   040100 100400                    MLR     fill='040'O
        56 005667   000625 000006 55                 ADSC9   405                      cn=0,n=6
        56 005670   200005 000006                    ADSC9   BUFFER,,AUTO             cn=0,n=6
        56 005671   200241 471500                    LDP1    CNT,,AUTO
        56 005672   040100 100500                    MLR     fill='040'O
        56 005673   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
        56 005674   200006 400010                    ADSC9   BUFFER+1,,AUTO           cn=2,n=8
        56 005675   040100 100400                    MLR     fill='040'O
        56 005676   000627 000003 55                 ADSC9   407                      cn=0,n=3
        56 005677   200010 400003                    ADSC9   BUFFER+3,,AUTO           cn=2,n=3
        56 005700   040100 100500                    MLR     fill='040'O
        56 005701   200243 000010                    ADSC9   TEXT,,AUTO               cn=0,n=8
        56 005702   200011 200010                    ADSC9   BUFFER+4,,AUTO           cn=1,n=8
        56 005703   040100 100400                    MLR     fill='040'O
        56 005704   000022 000001 57                 ADSC9   18                       cn=0,n=1
        56 005705   200013 200163                    ADSC9   BUFFER+6,,AUTO           cn=1,n=115

     1828     4138    4                    ' = ',TEXT,';');
     1829     4139                   %OUTPUT_STR;

   4144 56 005706   000000 236000 24                 LDQ     OUT_DCBN
        56 005707   005717 604000 56                 TMI     s:4146
        56 005710   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 005711   005717 601000 56                 TNZ     s:4146
        56 005712   000000 236000 34                 LDQ     OPTIONS
        56 005713   000002 736000                    QLS     2
        56 005714   400000 376003                    ANQ     -131072,DU
        56 005715   400000 676003                    ERQ     -131072,DU
        56 005716   005731 601000 56                 TNZ     s:4152

   4146 56 005717   000214 235007                    LDA     140,DL
        56 005720   200050 755100                    STA     LEN,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:262  

   4147 56 005721   200050 630500                    EPPR0   LEN,,AUTO
        56 005722   200277 450500                    STP0    CNT2+3,,AUTO
        56 005723   200005 631500                    EPPR1   BUFFER,,AUTO
        56 005724   200276 451500                    STP1    CNT2+2,,AUTO
        56 005725   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 005726   000000 631400 57                 EPPR1   0
        56 005727   000000 701000 xent               TSX1    OUTPUT
        56 005730   000000 011000                    NOP     0

     1830     4150    4            END;

     1831     4151
     1832     4152    3          CNT = CNT->BURST_TABLE.NEXT;

   4152 56 005731   200241 470500                    LDP0    CNT,,AUTO
        56 005732   000003 236100                    LDQ     3,,PR0
        56 005733   200241 756100                    STQ     CNT,,AUTO

     1833     4153    3        END; /* WHILE */

   4153 56 005734   000004 116000 57                 CMPQ    4
        56 005735   005622 601000 56                 TNZ     s:4121

     1834     4154             %SELECT_LO;

   4155 56 005736   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 005737   000000 755000 24                 STA     OUT_DCBN

     1835     4157    2    END OUTPUT_BURST_DEST;

   4157 56 005740   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 005741   000001 702211                    TSX2  ! 1,X1

     1836     4158         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:263  
     1837     4159
     1838     4160    1    TERMINATE_OT : PROC;

   4160 56 005742   200240 741300       TERMINATE_OT STX1  ! SHIFT_FACTOR+2,,AUTO

     1839     4161         /*I*
     1840     4162              NAME: TERMINATE_OT
     1841     4163              PURPOSE:
     1842     4164                   Complete the object table so that PL6 will be able to compile it.
     1843     4165              CALL:
     1844     4166                   CALL TERMINATE_OT;
     1845     4167              DATA:
     1846     4168                   CURRENT_OT_POS
     1847     4169              DESCRIPTION:
     1848     4170                   Output the closing parenthesis to the INIT  attribute of
     1849     4171                   the OBJECT TABLE which makes up the bulk of the table.
     1850     4172                   Also output to M$SO a definition of OT_LEN  which is
     1851     4173                   used to define the length of the table.
     1852     4174         */
     1853     4175             %SELECT_SUBS;

   4176 56 005743   000000 235000 xsym               LDA     Z8PS$M$SO#
        56 005744   000000 755000 24                 STA     OUT_DCBN

     1854     4178    2        CALL BINCHAR(CHAR_NUM,(CURRENT_OT_POS * 2));

   4178 56 005745   000000 236000 53                 LDQ     CURRENT_OT_POS
        56 005746   000001 736000                    QLS     1
        56 005747   000000 235003                    LDA     0,DU
        56 005750   200276 757100                    STAQ    CNT2+2,,AUTO
        56 005751   000100 301500                    BTD
        56 005752   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 005753   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

     1855     4179    2        CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);

   4179 56 005754   200051 630500                    EPPR0   CHAR_NUM,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:264  
        56 005755   200276 450500                    STP0    CNT2+2,,AUTO
        56 005756   000021 236000 57                 LDQ     17
        56 005757   200301 756100                    STQ     CNT2+5,,AUTO
        56 005760   200276 631500                    EPPR1   CNT2+2,,AUTO
        56 005761   200300 451500                    STP1    CNT2+4,,AUTO
        56 005762   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 005763   000000 631400 57                 EPPR1   0
        56 005764   000000 701000 xent               TSX1    BLANK_ZERO
        56 005765   000000 011000                    NOP     0

     1856     4180    2        CALL CONCAT(BUFFER,'%EQU OT_LEN_',SEGMENT_NAME,' = ',CHAR_NUM,';');

   4180 56 005766   040100 100400                    MLR     fill='040'O
        56 005767   000630 000014 55                 ADSC9   408                      cn=0,n=12
        56 005770   200005 000014                    ADSC9   BUFFER,,AUTO             cn=0,n=12
        56 005771   040100 100400                    MLR     fill='040'O
        56 005772   001373 000036 52                 ADSC9   SEGMENT_NAME             cn=0,n=30
        56 005773   200010 000036                    ADSC9   BUFFER+3,,AUTO           cn=0,n=30
        56 005774   040100 100400                    MLR     fill='040'O
        56 005775   000627 000003 55                 ADSC9   407                      cn=0,n=3
        56 005776   200017 400003                    ADSC9   BUFFER+10,,AUTO          cn=2,n=3
        56 005777   040100 100500                    MLR     fill='040'O
        56 006000   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 006001   200020 200036                    ADSC9   BUFFER+11,,AUTO          cn=1,n=30
        56 006002   040100 100400                    MLR     fill='040'O
        56 006003   000022 000001 57                 ADSC9   18                       cn=0,n=1
        56 006004   200027 600101                    ADSC9   BUFFER+18,,AUTO          cn=3,n=65

     1857     4181             %OUTPUT_STR;

   4186 56 006005   000000 236000 24                 LDQ     OUT_DCBN
        56 006006   006016 604000 56                 TMI     s:4188
        56 006007   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 006010   006016 601000 56                 TNZ     s:4188
        56 006011   000000 236000 34                 LDQ     OPTIONS
        56 006012   000002 736000                    QLS     2
        56 006013   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:265  
        56 006014   400000 676003                    ERQ     -131072,DU
        56 006015   006030 601000 56                 TNZ     s:4193

   4188 56 006016   000214 235007                    LDA     140,DL
        56 006017   200050 755100                    STA     LEN,,AUTO

   4189 56 006020   200050 630500                    EPPR0   LEN,,AUTO
        56 006021   200277 450500                    STP0    CNT2+3,,AUTO
        56 006022   200005 631500                    EPPR1   BUFFER,,AUTO
        56 006023   200276 451500                    STP1    CNT2+2,,AUTO
        56 006024   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 006025   000000 631400 57                 EPPR1   0
        56 006026   000000 701000 xent               TSX1    OUTPUT
        56 006027   000000 011000                    NOP     0

     1858     4192             %SELECT_OU;

   4193 56 006030   000000 235000 xsym               LDA     Z8PS$M$OU#
        56 006031   000000 755000 24                 STA     OUT_DCBN

     1859     4195    2        BUFFER = ' 1);';

   4195 56 006032   040100 100400                    MLR     fill='040'O
        56 006033   000633 000004 55                 ADSC9   411                      cn=0,n=4
        56 006034   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1860     4196             %OUTPUT_STR;

   4201 56 006035   000000 236000 24                 LDQ     OUT_DCBN
        56 006036   006046 604000 56                 TMI     s:4203
        56 006037   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 006040   006046 601000 56                 TNZ     s:4203
        56 006041   000000 236000 34                 LDQ     OPTIONS
        56 006042   000002 736000                    QLS     2
        56 006043   400000 376003                    ANQ     -131072,DU
        56 006044   400000 676003                    ERQ     -131072,DU
        56 006045   006060 601000 56                 TNZ     s:4207
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:266  

   4203 56 006046   000214 236007                    LDQ     140,DL
        56 006047   200050 756100                    STQ     LEN,,AUTO

   4204 56 006050   200050 630500                    EPPR0   LEN,,AUTO
        56 006051   200277 450500                    STP0    CNT2+3,,AUTO
        56 006052   200005 631500                    EPPR1   BUFFER,,AUTO
        56 006053   200276 451500                    STP1    CNT2+2,,AUTO
        56 006054   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 006055   000000 631400 57                 EPPR1   0
        56 006056   000000 701000 xent               TSX1    OUTPUT
        56 006057   000000 011000                    NOP     0

     1861     4207    2        CALL BINCHAR(CHAR_NUM,(CURRENT_OT_POS - 1));

   4207 56 006060   000000 235000 53                 LDA     CURRENT_OT_POS
        56 006061   000001 135007                    SBLA    1,DL
        56 006062   200276 755100                    STA     CNT2+2,,AUTO
        56 006063   000100 301500                    BTD
        56 006064   200276 000004                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
        56 006065   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

     1862     4208    2        CALL BLANK_ZERO(ADDR(CHAR_NUM),%OPERAND_LEN);

   4208 56 006066   200051 630500                    EPPR0   CHAR_NUM,,AUTO
        56 006067   200276 450500                    STP0    CNT2+2,,AUTO
        56 006070   000021 236000 57                 LDQ     17
        56 006071   200301 756100                    STQ     CNT2+5,,AUTO
        56 006072   200276 631500                    EPPR1   CNT2+2,,AUTO
        56 006073   200300 451500                    STP1    CNT2+4,,AUTO
        56 006074   200300 630500                    EPPR0   CNT2+4,,AUTO
        56 006075   000000 631400 57                 EPPR1   0
        56 006076   000000 701000 xent               TSX1    BLANK_ZERO
        56 006077   000000 011000                    NOP     0

     1863     4209    2        CALL CONCAT(BUFFER,'DCL OT_LEN UBIN EXT INIT(',CHAR_NUM,');');

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:267  
   4209 56 006100   040100 100400                    MLR     fill='040'O
        56 006101   000634 000031 55                 ADSC9   412                      cn=0,n=25
        56 006102   200005 000031                    ADSC9   BUFFER,,AUTO             cn=0,n=25
        56 006103   040100 100500                    MLR     fill='040'O
        56 006104   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 006105   200013 200036                    ADSC9   BUFFER+6,,AUTO           cn=1,n=30
        56 006106   040100 100400                    MLR     fill='040'O
        56 006107   000643 000002 55                 ADSC9   419                      cn=0,n=2
        56 006110   200022 600125                    ADSC9   BUFFER+13,,AUTO          cn=3,n=85

     1864     4210             %OUTPUT_STR;

   4215 56 006111   000000 236000 24                 LDQ     OUT_DCBN
        56 006112   006122 604000 56                 TMI     s:4217
        56 006113   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 006114   006122 601000 56                 TNZ     s:4217
        56 006115   000000 236000 34                 LDQ     OPTIONS
        56 006116   000002 736000                    QLS     2
        56 006117   400000 376003                    ANQ     -131072,DU
        56 006120   400000 676003                    ERQ     -131072,DU
        56 006121   006134 601000 56                 TNZ     s:4222

   4217 56 006122   000214 235007                    LDA     140,DL
        56 006123   200050 755100                    STA     LEN,,AUTO

   4218 56 006124   200050 630500                    EPPR0   LEN,,AUTO
        56 006125   200277 450500                    STP0    CNT2+3,,AUTO
        56 006126   200005 631500                    EPPR1   BUFFER,,AUTO
        56 006127   200276 451500                    STP1    CNT2+2,,AUTO
        56 006130   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 006131   000000 631400 57                 EPPR1   0
        56 006132   000000 701000 xent               TSX1    OUTPUT
        56 006133   000000 011000                    NOP     0

     1865     4221             %SELECT_LO;

   4222 56 006134   000000 235000 xsym               LDA     Z8PS$M$LO#
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:268  
        56 006135   000000 755000 24                 STA     OUT_DCBN

     1866     4224    2    END TERMINATE_OT;

   4224 56 006136   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 006137   000001 702211                    TSX2  ! 1,X1

     1867     4225
     1868     4226
     1869     4227
     1870     4228         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:269  
     1871     4229    1    GET_SHIFT_FACTOR : PROC(SHIFT_FACTOR,DISTANCE);

   4229 56 006140   200240 741300       GET_SHIFT_F* STX1  ! SHIFT_FACTOR+2,,AUTO

     1872     4230         /*I*
     1873     4231              NAME: GET_SHIFT_FACTOR
     1874     4232              PURPOSE:
     1875     4233                   This procedure calculates powers of two which are used to shift
     1876     4234                   contents of variables.
     1877     4235              CALL:
     1878     4236                   CALL GET_SHIFT_FACTOR(SHIFT_FACTOR,DISTANCE);
     1879     4237              PARAMETERS:
     1880     4238                   SHIFT_FACTOR
     1881     4239                     The result of the exponentiation.
     1882     4240                   DISTANCE
     1883     4241                     The number of places to left needed in the shift, or
     1884     4242                     the power of two needed.
     1885     4243              DATA:
     1886     4244                   None.
     1887     4245              DESCRIPTION:
     1888     4246                   Use an indexed do loop to carry out repeated multiplication.
     1889     4247         */
     1890     4248    2        DCL SHIFT_FACTOR UBIN WORD;
     1891     4249    2        DCL DISTANCE SBIN WORD;
     1892     4250    2        DCL CNT SBIN WORD;
     1893     4251
     1894     4252    2        SHIFT_FACTOR = 1;

   4252 56 006141   000001 235007                    LDA     1,DL
        56 006142   200241 470500                    LDP0    @SHIFT_FACTOR,,AUTO
        56 006143   000000 755100                    STA     0,,PR0

     1895     4253    2        CNT = 0;

   4253 56 006144   200243 450100                    STZ     CNT,,AUTO

     1896     4254    3        DO WHILE CNT < DISTANCE;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:270  

   4254 56 006145   200242 471500                    LDP1    @DISTANCE,,AUTO
        56 006146   200243 236100                    LDQ     CNT,,AUTO
        56 006147   100000 116100                    CMPQ    0,,PR1
        56 006150   006162 605000 56                 TPL     s:4259

     1897     4255    3          SHIFT_FACTOR = SHIFT_FACTOR * 2;

   4255 56 006151   200241 470500                    LDP0    @SHIFT_FACTOR,,AUTO
        56 006152   000000 235100                    LDA     0,,PR0
        56 006153   000001 735000                    ALS     1
        56 006154   000000 755100                    STA     0,,PR0

     1898     4256    3          CNT = CNT + 1;

   4256 56 006155   200243 054100                    AOS     CNT,,AUTO

     1899     4257    3        END;

   4257 56 006156   200242 471500                    LDP1    @DISTANCE,,AUTO
        56 006157   200243 236100                    LDQ     CNT,,AUTO
        56 006160   100000 116100                    CMPQ    0,,PR1
        56 006161   006151 604000 56                 TMI     s:4255

     1900     4258
     1901     4259    2    END GET_SHIFT_FACTOR;

   4259 56 006162   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 006163   000001 702211                    TSX2  ! 1,X1

     1902     4260         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:271  
     1903     4261
     1904     4262    1    HANDLE_PL6 : PROC;

   4262 56 006164   200240 741300       HANDLE_PL6   STX1  ! SHIFT_FACTOR+2,,AUTO

     1905     4263         /*I*
     1906     4264              NAME: HANDLE_PL6
     1907     4265              PURPOSE:
     1908     4266                   This procedure is called when an ENTER_PL6 directive is encountered
     1909     4267                   to skip over the following PL6 code until ENTER_PCA is found.
     1910     4268                   If a line did not contain ENTER_PCA then it is echoed to the
     1911     4269                   object table.
     1912     4270              CALL:
     1913     4271                   CALL HANDLE_PL6;
     1914     4272              DATA:
     1915     4273                   None.
     1916     4274              DESCRIPTION:
     1917     4275                   This procedure acts like a second scanner and is necessary
     1918     4276                   in order to avoid including PL6 grammer rules in the grammar.
     1919     4277                   Each line following the line that contained the enter directive
     1920     4278                   is scanned for the words ENTER_PCA.  If the line does not contain
     1921     4279                   those words then it is echoed to the file containing the object
     1922     4280                   table.
     1923     4281         */
     1924     4282    2        DCL NUM SBIN WORD;
     1925     4283
     1926     4284    3        DO WHILE '1'B;

     1927     4285               /* GET NEXT LINE */
     1928     4286    3          INSTR_LEN = 0;

   4286 56 006165   000000 450000 39                 STZ     INSTR_LEN

     1929     4287    3          INSTR_INDX = 0;

   4287 56 006166   000000 450000 40                 STZ     INSTR_INDX

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:272  
     1930     4288    3          CALL INPUT(INSTR,INSTR_LEN,KEY_REC);

   4288 56 006167   000055 630400 57                 EPPR0   45
        56 006170   000054 631400 57                 EPPR1   44
        56 006171   000000 701000 xent               TSX1    INPUT
        56 006172   000000 011000                    NOP     0

     1931     4289    3          IF INSTR_LEN < 1 THEN

   4289 56 006173   000000 235000 39                 LDA     INSTR_LEN
        56 006174   006201 605400 56                 TPNZ    s:4294

     1932     4290    4            DO;

     1933     4291    4              EOF_FLAG = '1'B;

   4291 56 006175   400000 236003                    LDQ     -131072,DU
        56 006176   000000 756000 41                 STQ     EOF_FLAG

     1934     4292    4              RETURN;

   4292 56 006177   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 006200   000001 702211                    TSX2  ! 1,X1

     1935     4293    4            END;
     1936     4294    3          INSTR_LISTED = '0'B;

   4294 56 006201   000000 450000 38                 STZ     INSTR_LISTED

     1937     4295    3          IF OPTIONS(LS_OPT) THEN

   4295 56 006202   000000 234000 34                 SZN     OPTIONS
        56 006203   006207 605000 56                 TPL     s:4299

     1938     4296    3            CALL FORCE_LIST;

   4296 56 006204   000002 631400 57                 EPPR1   2
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:273  
        56 006205   000000 701000 xent               TSX1    FORCE_LIST
        56 006206   000000 011000                    NOP     0

     1939     4297
     1940     4298               /* SCAN THE LINE FOR 'ENTER_PCA' */
     1941     4299    4          DO NUM = 0 TO (INSTR_LEN - 9);

   4299 56 006207   200241 450100                    STZ     NUM,,AUTO
        56 006210   006224 710000 56                 TRA     s:4306+1

     1942     4300    4            IF SUBSTR(INSTRCHR,NUM,9) = 'ENTER_PCA' THEN

   4300 56 006211   200241 235100                    LDA     NUM,,AUTO
        56 006212   040000 106405                    CMPC    fill='040'O
        56 006213   000000 000011 37                 ADSC9   INSTR,A                  cn=0,n=9
        56 006214   000644 000011 55                 ADSC9   420                      cn=0,n=9
        56 006215   006223 601000 56                 TNZ     s:4306

     1943     4301    5              DO;

     1944     4302    5                INSTR_LEN = 0;

   4302 56 006216   000000 450000 39                 STZ     INSTR_LEN

     1945     4303    5                INSTR_INDX = 1;

   4303 56 006217   000001 236007                    LDQ     1,DL
        56 006220   000000 756000 40                 STQ     INSTR_INDX

     1946     4304    5                RETURN;

   4304 56 006221   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 006222   000001 702211                    TSX2  ! 1,X1

     1947     4305    5              END;
     1948     4306    4          END;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:274  
   4306 56 006223   200241 054100                    AOS     NUM,,AUTO
        56 006224   000000 236000 39                 LDQ     INSTR_LEN
        56 006225   000011 136007                    SBLQ    9,DL
        56 006226   200241 116100                    CMPQ    NUM,,AUTO
        56 006227   006211 605000 56                 TPL     s:4300

     1949     4307    3          BUFFER = SUBSTR(INSTRCHR,0,INSTR_LEN);

   4307 56 006230   000000 720000 39                 LXL0    INSTR_LEN
        56 006231   040100 100440                    MLR     fill='040'O
        56 006232   000000 000010 37                 ADSC9   INSTR                    cn=0,n=*X0
        56 006233   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     1950     4308               %SELECT_OU;

   4309 56 006234   000000 235000 xsym               LDA     Z8PS$M$OU#
        56 006235   000000 755000 24                 STA     OUT_DCBN

     1951     4311               %OUTPUT_STR;

   4316 56 006236   000000 236000 24                 LDQ     OUT_DCBN
        56 006237   006247 604000 56                 TMI     s:4318
        56 006240   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 006241   006247 601000 56                 TNZ     s:4318
        56 006242   000000 236000 34                 LDQ     OPTIONS
        56 006243   000002 736000                    QLS     2
        56 006244   400000 376003                    ANQ     -131072,DU
        56 006245   400000 676003                    ERQ     -131072,DU
        56 006246   006261 601000 56                 TNZ     s:4323

   4318 56 006247   000214 236007                    LDQ     140,DL
        56 006250   200050 756100                    STQ     LEN,,AUTO

   4319 56 006251   200050 630500                    EPPR0   LEN,,AUTO
        56 006252   200277 450500                    STP0    CNT2+3,,AUTO
        56 006253   200005 631500                    EPPR1   BUFFER,,AUTO
        56 006254   200276 451500                    STP1    CNT2+2,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:275  
        56 006255   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 006256   000000 631400 57                 EPPR1   0
        56 006257   000000 701000 xent               TSX1    OUTPUT
        56 006260   000000 011000                    NOP     0

     1952     4322               %SELECT_LO;

   4323 56 006261   000000 235000 xsym               LDA     Z8PS$M$LO#
        56 006262   000000 755000 24                 STA     OUT_DCBN

     1953     4325    3        END;

   4325 56 006263   006165 710000 56                 TRA     s:4286

     1954     4326    2    END HANDLE_PL6;
     1955     4327         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:276  
     1956     4328
     1957     4329    1    TRACE : PROC;

   4329 56 006264   200240 741300       TRACE        STX1  ! SHIFT_FACTOR+2,,AUTO

     1958     4330         /*I*
     1959     4331              NAME: TRACE
     1960     4332              PURPOSE:
     1961     4333                   Output an indication of whats going on if the trace option
     1962     4334                   has been specified in the source.
     1963     4335              CALL:
     1964     4336                   CALL TRACE;
     1965     4337              DATA:
     1966     4338                   None.
     1967     4339              DESCRIPTION:
     1968     4340                   If the trace option has been specified in the pca
     1969     4341                   program, then this procedure is called after each semantic
     1970     4342                   action is performed.  Trace outputs an indication of what
     1971     4343                   action was performed and in some case what the contents of
     1972     4344                   key variables are.
     1973     4345         */
     1974     4346    3      DO CASE (A);

   4346 56 006265   200003 470500                    LDP0    @A,,AUTO
        56 006266   000000 235100                    LDA     0,,PR0
        56 006267   000053 115007                    CMPA    43,DL
        56 006270   006272 602005 56                 TNC     s:4346+5,AL
        56 006271   007113 710000 56                 TRA     s:4476
        56 006272   007113 710000 56                 TRA     s:4476
        56 006273   006725 710000 56                 TRA     s:4401
        56 006274   006360 710000 56                 TRA     s:4351
        56 006275   006345 710000 56                 TRA     s:4348
        56 006276   006613 710000 56                 TRA     s:4382
        56 006277   007113 710000 56                 TRA     s:4476
        56 006300   006420 710000 56                 TRA     s:4363
        56 006301   006721 710000 56                 TRA     s:4398
        56 006302   006776 710000 56                 TRA     s:4424
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:277  
        56 006303   007002 710000 56                 TRA     s:4427
        56 006304   006550 710000 56                 TRA     s:4377
        56 006305   006436 710000 56                 TRA     s:4367
        56 006306   006772 710000 56                 TRA     s:4421
        56 006307   006631 710000 56                 TRA     s:4386
        56 006310   006651 710000 56                 TRA     s:4391
        56 006311   006666 710000 56                 TRA     s:4394
        56 006312   006731 710000 56                 TRA     s:4404
        56 006313   007057 710000 56                 TRA     s:4455
        56 006314   007067 710000 56                 TRA     s:4461
        56 006315   007067 710000 56                 TRA     s:4461
        56 006316   007067 710000 56                 TRA     s:4461
        56 006317   007006 710000 56                 TRA     s:4430
        56 006320   007053 710000 56                 TRA     s:4452
        56 006321   007063 710000 56                 TRA     s:4458
        56 006322   007077 710000 56                 TRA     s:4467
        56 006323   007033 710000 56                 TRA     s:4440
        56 006324   007047 710000 56                 TRA     s:4449
        56 006325   007113 710000 56                 TRA     s:4476
        56 006326   007113 710000 56                 TRA     s:4476
        56 006327   006740 710000 56                 TRA     s:4408
        56 006330   006744 710000 56                 TRA     s:4411
        56 006331   006750 710000 56                 TRA     s:4414
        56 006332   007027 710000 56                 TRA     s:4437
        56 006333   007020 710000 56                 TRA     s:4434
        56 006334   006757 710000 56                 TRA     s:4417
        56 006335   006503 710000 56                 TRA     s:4372
        56 006336   007043 710000 56                 TRA     s:4446
        56 006337   007037 710000 56                 TRA     s:4443
        56 006340   007073 710000 56                 TRA     s:4464
        56 006341   007103 710000 56                 TRA     s:4470
        56 006342   006374 710000 56                 TRA     s:4358
        56 006343   006364 710000 56                 TRA     s:4354
        56 006344   007107 710000 56                 TRA     s:4473

     1975     4347    3           CASE(%SET_OPTIONS);

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:278  
     1976     4348    3               CALL CONCAT(BUFFER,'SET OPTION ',LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);

   4348 56 006345   000000 236000 1                  LDQ     LX_TOP
        56 006346   000006 402007                    MPY     6,DL
        56 006347   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006350   100000 720100                    LXL0    0,,PR1
        56 006351   040100 100400                    MLR     fill='040'O
        56 006352   000647 000013 55                 ADSC9   423                      cn=0,n=11
        56 006353   200005 000013                    ADSC9   BUFFER,,AUTO             cn=0,n=11
        56 006354   040100 100540                    MLR     fill='040'O
        56 006355   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006356   200007 600201                    ADSC9   BUFFER+2,,AUTO           cn=3,n=129
        56 006357   007117 710000 56                 TRA     s:4483

     1977     4349
     1978     4350    3           CASE(%PUT_PROG_INFO);

     1979     4351    3               BUFFER = 'INITALIZE EVERYTHING';

   4351 56 006360   040100 100400                    MLR     fill='040'O
        56 006361   000652 000024 55                 ADSC9   426                      cn=0,n=20
        56 006362   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 006363   007117 710000 56                 TRA     s:4483

     1980     4352
     1981     4353    3           CASE(%PUT_START_DEP);

     1982     4354    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP - 1) -> DNT.TEXT.NAME;

   4354 56 006364   000000 236000 1                  LDQ     LX_TOP
        56 006365   000006 402007                    MPY     6,DL
        56 006366   777773 471406 2                  LDP1    LX_STK-5,QL
        56 006367   100000 720100                    LXL0    0,,PR1
        56 006370   040000 100540                    MLR     fill='040'O
        56 006371   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006372   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30
        56 006373   007117 710000 56                 TRA     s:4483
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:279  

     1983     4355
     1984     4356
     1985     4357    3           CASE(%PUT_START_PEPD);

     1986     4358    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;

   4358 56 006374   000000 236000 1                  LDQ     LX_TOP
        56 006375   000006 402007                    MPY     6,DL
        56 006376   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006377   100000 720100                    LXL0    0,,PR1
        56 006400   040000 100540                    MLR     fill='040'O
        56 006401   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006402   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30

     1987     4359    3               CALL CONCAT(BUFFER,'PUT START (PEPD) ',LABEL_NAME);

   4359 56 006403   040100 100400                    MLR     fill='040'O
        56 006404   000657 000021 55                 ADSC9   431                      cn=0,n=17
        56 006405   200005 000021                    ADSC9   BUFFER,,AUTO             cn=0,n=17
        56 006406   040100 100400                    MLR     fill='040'O
        56 006407   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30
        56 006410   200011 200173                    ADSC9   BUFFER+4,,AUTO           cn=1,n=123

     1988     4360    3               CALL CONCAT(BUFFER,'PUT START (DEP) ',LABEL_NAME);

   4360 56 006411   040100 100400                    MLR     fill='040'O
        56 006412   000664 000020 55                 ADSC9   436                      cn=0,n=16
        56 006413   200005 000020                    ADSC9   BUFFER,,AUTO             cn=0,n=16
        56 006414   040100 100400                    MLR     fill='040'O
        56 006415   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30
        56 006416   200011 000174                    ADSC9   BUFFER+4,,AUTO           cn=0,n=124
        56 006417   007117 710000 56                 TRA     s:4483

     1989     4361
     1990     4362    3           CASE(%PUT_LABEL);

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:280  
     1991     4363    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;

   4363 56 006420   000000 236000 1                  LDQ     LX_TOP
        56 006421   000006 402007                    MPY     6,DL
        56 006422   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006423   100000 720100                    LXL0    0,,PR1
        56 006424   040000 100540                    MLR     fill='040'O
        56 006425   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006426   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30

     1992     4364    3               CALL CONCAT(BUFFER,'PUT LABEL ',LABEL_NAME);

   4364 56 006427   040100 100400                    MLR     fill='040'O
        56 006430   000670 000012 55                 ADSC9   440                      cn=0,n=10
        56 006431   200005 000012                    ADSC9   BUFFER,,AUTO             cn=0,n=10
        56 006432   040100 100400                    MLR     fill='040'O
        56 006433   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30
        56 006434   200007 400202                    ADSC9   BUFFER+2,,AUTO           cn=2,n=130
        56 006435   007117 710000 56                 TRA     s:4483

     1993     4365
     1994     4366    3           CASE(%PUT_OPERAND_MOD);

     1995     4367    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP));

   4367 56 006436   000000 236000 1                  LDQ     LX_TOP
        56 006437   000030 402007                    MPY     24,DL
        56 006440   000100 301406                    BTD
        56 006441   000002 000004 2                  NDSC9   LX_STK+2,Q               cn=0,s=lsgnf,sf=0,n=4
        56 006442   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

     1996     4368    3              CALL CONCAT(BUFFER,' PUT OPERAND MODIFIIED ',LX_STK.DNTPTR(LX_TOP)->DNT.
              4368                        TEXT.NAME,

   4368 56 006443   000000 236000 1                  LDQ     LX_TOP
        56 006444   000006 402007                    MPY     6,DL
        56 006445   000001 471406 2                  LDP1    LX_STK+1,QL
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:281  
        56 006446   100000 720100                    LXL0    0,,PR1
        56 006447   040100 100400                    MLR     fill='040'O
        56 006450   000673 000027 55                 ADSC9   443                      cn=0,n=23
        56 006451   200005 000027                    ADSC9   BUFFER,,AUTO             cn=0,n=23
        56 006452   040100 100540                    MLR     fill='040'O
        56 006453   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006454   200012 600165                    ADSC9   BUFFER+5,,AUTO           cn=3,n=117
        56 006455   000000 636010                    EAQ     0,X0
        56 006456   000022 732000                    QRS     18
        56 006457   000165 116007                    CMPQ    117,DL
        56 006460   006502 605000 56                 TPL     s:4368+31
        56 006461   200276 740100                    STX0    CNT2+2,,AUTO
        56 006462   777612 620010                    EAX0    -118,X0
        56 006463   777777 660003                    ERX0    -1,DU
        56 006464   200276 235100                    LDA     CNT2+2,,AUTO
        56 006465   000022 731000                    ARS     18
        56 006466   040145 100400                    MLR     fill='040'O
        56 006467   000701 000023 55                 ADSC9   449                      cn=0,n=19
        56 006470   200012 600010                    ADSC9   BUFFER+5,A,AUTO          cn=3,n=*X0
        56 006471   200276 236100                    LDQ     CNT2+2,,AUTO
        56 006472   000022 732000                    QRS     18
        56 006473   000142 116007                    CMPQ    98,DL
        56 006474   006502 605000 56                 TPL     s:4368+31
        56 006475   777635 620006                    EAX0    -99,QL
        56 006476   777777 660003                    ERX0    -1,DU
        56 006477   040146 100500                    MLR     fill='040'O
        56 006500   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 006501   200017 400010                    ADSC9   BUFFER+10,Q,AUTO         cn=2,n=*X0
        56 006502   007117 710000 56                 TRA     s:4483

     1997     4369    3                           ' TERMINAL NUMBER = ',CHAR_NUM);
     1998     4370
     1999     4371    3           CASE(%PUT_OPERAND_UNMOD);

     2000     4372    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP));

   4372 56 006503   000000 236000 1                  LDQ     LX_TOP
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:282  
        56 006504   000030 402007                    MPY     24,DL
        56 006505   000100 301406                    BTD
        56 006506   000002 000004 2                  NDSC9   LX_STK+2,Q               cn=0,s=lsgnf,sf=0,n=4
        56 006507   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

     2001     4373    3              CALL CONCAT(BUFFER,' PUT OPERAND UNMODIFIED ',LX_STK.DNTPTR(LX_TOP)->DNT
              4373                        .TEXT.NAME,

   4373 56 006510   000000 236000 1                  LDQ     LX_TOP
        56 006511   000006 402007                    MPY     6,DL
        56 006512   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006513   100000 720100                    LXL0    0,,PR1
        56 006514   040100 100400                    MLR     fill='040'O
        56 006515   000706 000030 55                 ADSC9   454                      cn=0,n=24
        56 006516   200005 000030                    ADSC9   BUFFER,,AUTO             cn=0,n=24
        56 006517   040100 100540                    MLR     fill='040'O
        56 006520   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006521   200013 000164                    ADSC9   BUFFER+6,,AUTO           cn=0,n=116
        56 006522   000000 636010                    EAQ     0,X0
        56 006523   000022 732000                    QRS     18
        56 006524   000164 116007                    CMPQ    116,DL
        56 006525   006547 605000 56                 TPL     s:4373+31
        56 006526   200276 740100                    STX0    CNT2+2,,AUTO
        56 006527   777613 620010                    EAX0    -117,X0
        56 006530   777777 660003                    ERX0    -1,DU
        56 006531   200276 235100                    LDA     CNT2+2,,AUTO
        56 006532   000022 731000                    ARS     18
        56 006533   040145 100400                    MLR     fill='040'O
        56 006534   000701 000023 55                 ADSC9   449                      cn=0,n=19
        56 006535   200013 000010                    ADSC9   BUFFER+6,A,AUTO          cn=0,n=*X0
        56 006536   200276 236100                    LDQ     CNT2+2,,AUTO
        56 006537   000022 732000                    QRS     18
        56 006540   000141 116007                    CMPQ    97,DL
        56 006541   006547 605000 56                 TPL     s:4373+31
        56 006542   777636 620006                    EAX0    -98,QL
        56 006543   777777 660003                    ERX0    -1,DU
        56 006544   040146 100500                    MLR     fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:283  
        56 006545   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 006546   200017 600010                    ADSC9   BUFFER+10,Q,AUTO         cn=3,n=*X0
        56 006547   007117 710000 56                 TRA     s:4483

     2002     4374    3                           ' TERMINAL NUMBER = ',CHAR_NUM);
     2003     4375
     2004     4376    3           CASE(%PUT_SIMPLE_DIR);

     2005     4377    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP));

   4377 56 006550   000000 236000 1                  LDQ     LX_TOP
        56 006551   000030 402007                    MPY     24,DL
        56 006552   000100 301406                    BTD
        56 006553   000002 000004 2                  NDSC9   LX_STK+2,Q               cn=0,s=lsgnf,sf=0,n=4
        56 006554   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

     2006     4378    3               CALL CONCAT(BUFFER,'PUT DIR ',LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME,

   4378 56 006555   000000 236000 1                  LDQ     LX_TOP
        56 006556   000006 402007                    MPY     6,DL
        56 006557   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006560   100000 720100                    LXL0    0,,PR1
        56 006561   000714 237000 55                 LDAQ    460
        56 006562   200005 755100                    STA     BUFFER,,AUTO
        56 006563   200006 756100                    STQ     BUFFER+1,,AUTO
        56 006564   040100 100540                    MLR     fill='040'O
        56 006565   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006566   200007 000204                    ADSC9   BUFFER+2,,AUTO           cn=0,n=132
        56 006567   000000 636010                    EAQ     0,X0
        56 006570   000022 732000                    QRS     18
        56 006571   000204 116007                    CMPQ    132,DL
        56 006572   006612 605000 56                 TPL     s:4378+29
        56 006573   200276 740100                    STX0    CNT2+2,,AUTO
        56 006574   777573 620010                    EAX0    -133,X0
        56 006575   777777 660003                    ERX0    -1,DU
        56 006576   200276 236100                    LDQ     CNT2+2,,AUTO
        56 006577   000022 732000                    QRS     18
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:284  
        56 006600   040146 100400                    MLR     fill='040'O
        56 006601   000701 000023 55                 ADSC9   449                      cn=0,n=19
        56 006602   200007 000010                    ADSC9   BUFFER+2,Q,AUTO          cn=0,n=*X0
        56 006603   000161 116007                    CMPQ    113,DL
        56 006604   006612 605000 56                 TPL     s:4378+29
        56 006605   777616 620006                    EAX0    -114,QL
        56 006606   777777 660003                    ERX0    -1,DU
        56 006607   040146 100500                    MLR     fill='040'O
        56 006610   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 006611   200013 600010                    ADSC9   BUFFER+6,Q,AUTO          cn=3,n=*X0
        56 006612   007117 710000 56                 TRA     s:4483

     2007     4379    3                     ' TERMINAL NUMBER = ', CHAR_NUM);
     2008     4380
     2009     4381    3           CASE(%ADD_XREF);

     2010     4382    3               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;

   4382 56 006613   000000 236000 1                  LDQ     LX_TOP
        56 006614   000006 402007                    MPY     6,DL
        56 006615   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006616   100000 720100                    LXL0    0,,PR1
        56 006617   040000 100540                    MLR     fill='040'O
        56 006620   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006621   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30

     2011     4383    3               CALL CONCAT(BUFFER,'ADD TO XREF ',LABEL_NAME);

   4383 56 006622   040100 100400                    MLR     fill='040'O
        56 006623   000716 000014 55                 ADSC9   462                      cn=0,n=12
        56 006624   200005 000014                    ADSC9   BUFFER,,AUTO             cn=0,n=12
        56 006625   040100 100400                    MLR     fill='040'O
        56 006626   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30
        56 006627   200010 000200                    ADSC9   BUFFER+3,,AUTO           cn=0,n=128
        56 006630   007117 710000 56                 TRA     s:4483

     2012     4384
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:285  
     2013     4385    3           CASE(%PUT_JMP_DEST);

     2014     4386    3               CALL BINCHAR(CHAR_NUM,LX_STK.SYMBOL(LX_TOP - 1));

   4386 56 006631   000000 236000 1                  LDQ     LX_TOP
        56 006632   000030 402007                    MPY     24,DL
        56 006633   000100 301406                    BTD
        56 006634   777774 000004 2                  NDSC9   LX_STK-4,Q               cn=0,s=lsgnf,sf=0,n=4
        56 006635   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

     2015     4387    3               CALL CONCAT (BUFFER,'PUT JMP DESTINATION INTO P CODE: ',

   4387 56 006636   000000 236000 1                  LDQ     LX_TOP
        56 006637   000006 402007                    MPY     6,DL
        56 006640   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006641   100000 720100                    LXL0    0,,PR1
        56 006642   040100 100400                    MLR     fill='040'O
        56 006643   000721 000041 55                 ADSC9   465                      cn=0,n=33
        56 006644   200005 000041                    ADSC9   BUFFER,,AUTO             cn=0,n=33
        56 006645   040100 100540                    MLR     fill='040'O
        56 006646   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006647   200015 200153                    ADSC9   BUFFER+8,,AUTO           cn=1,n=107
        56 006650   007117 710000 56                 TRA     s:4483

     2016     4388    3                       LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME);
     2017     4389
     2018     4390    3           CASE(%PUT_UNSPECIFIC_REG);

     2019     4391    3               CALL CONCAT(BUFFER,'PUT UNSPECIFIC REG : ','%',LX_STK.DNTPTR(LX_TOP)->
              4391                        DNT.TEXT.NAME);

   4391 56 006651   000000 236000 1                  LDQ     LX_TOP
        56 006652   000006 402007                    MPY     6,DL
        56 006653   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006654   100000 720100                    LXL0    0,,PR1
        56 006655   040100 100400                    MLR     fill='040'O
        56 006656   000732 000025 55                 ADSC9   474                      cn=0,n=21
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:286  
        56 006657   200005 000025                    ADSC9   BUFFER,,AUTO             cn=0,n=21
        56 006660   000045 236003                    LDQ     37,DU
        56 006661   200012 552120                    STBQ    BUFFER+5,'20'O,AUTO
        56 006662   040100 100540                    MLR     fill='040'O
        56 006663   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006664   200012 400166                    ADSC9   BUFFER+5,,AUTO           cn=2,n=118
        56 006665   007117 710000 56                 TRA     s:4483

     2020     4392
     2021     4393    3           CASE(%PUT_SPECIFIC_REG);

     2022     4394    3               CALL CONCAT(BUFFER,'PUT SPECIIFC REG: ','%',LX_STK.DNTPTR(LX_TOP - 1)->
              4394                        DNT.TEXT.NAME,

   4394 56 006666   000000 236000 1                  LDQ     LX_TOP
        56 006667   000006 402007                    MPY     6,DL
        56 006670   777773 471406 2                  LDP1    LX_STK-5,QL
        56 006671   100000 720100                    LXL0    0,,PR1
        56 006672   000007 473406 2                  LDP3    LX_STK+7,QL
        56 006673   300000 722100                    LXL2    0,,PR3
        56 006674   040100 100400                    MLR     fill='040'O
        56 006675   000740 000022 55                 ADSC9   480                      cn=0,n=18
        56 006676   200005 000022                    ADSC9   BUFFER,,AUTO             cn=0,n=18
        56 006677   045000 236007                    LDQ     18944,DL
        56 006700   200011 552110                    STBQ    BUFFER+4,'10'O,AUTO
        56 006701   040100 100540                    MLR     fill='040'O
        56 006702   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006703   200011 600171                    ADSC9   BUFFER+4,,AUTO           cn=3,n=121
        56 006704   000000 636010                    EAQ     0,X0
        56 006705   000022 732000                    QRS     18
        56 006706   000171 116007                    CMPQ    121,DL
        56 006707   006720 605000 56                 TPL     s:4394+26
        56 006710   200276 740100                    STX0    CNT2+2,,AUTO
        56 006711   777606 620010                    EAX0    -122,X0
        56 006712   777777 660003                    ERX0    -1,DU
        56 006713   200276 235100                    LDA     CNT2+2,,AUTO
        56 006714   000022 731000                    ARS     18
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:287  
        56 006715   040145 100540                    MLR     fill='040'O
        56 006716   300001 000012                    ADSC9   1,,PR3                   cn=0,n=*X2
        56 006717   200011 600010                    ADSC9   BUFFER+4,A,AUTO          cn=3,n=*X0
        56 006720   007117 710000 56                 TRA     s:4483

     2023     4395    3                           LX_STK.DNTPTR(LX_TOP + 1)->DNT.TEXT.NAME);
     2024     4396
     2025     4397    3           CASE(%GENERATE_P_CODE);

     2026     4398    3               BUFFER = 'GEN_P_CODE ';

   4398 56 006721   040100 100400                    MLR     fill='040'O
        56 006722   000745 000013 55                 ADSC9   485                      cn=0,n=11
        56 006723   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 006724   007117 710000 56                 TRA     s:4483

     2027     4399
     2028     4400    3         CASE(%FINISH_PROGRAM);

     2029     4401    3               BUFFER = 'FINISH PROGRAM';

   4401 56 006725   040100 100400                    MLR     fill='040'O
        56 006726   000750 000016 55                 ADSC9   488                      cn=0,n=14
        56 006727   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 006730   007117 710000 56                 TRA     s:4483

     2030     4402
     2031     4403    3           CASE(%PUT_OPCODE);

     2032     4404    3               CALL CONCAT(BUFFER,' PUT OPCODE: ',OPCODE);

   4404 56 006731   040100 100400                    MLR     fill='040'O
        56 006732   000754 000015 55                 ADSC9   492                      cn=0,n=13
        56 006733   200005 000015                    ADSC9   BUFFER,,AUTO             cn=0,n=13
        56 006734   040100 100400                    MLR     fill='040'O
        56 006735   001417 000005 52                 ADSC9   OPCODE                   cn=0,n=5
        56 006736   200010 200177                    ADSC9   BUFFER+3,,AUTO           cn=1,n=127
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:288  
        56 006737   007117 710000 56                 TRA     s:4483

     2033     4405
     2034     4406
     2035     4407    3           CASE(%PUT_IR);

     2036     4408    3               BUFFER = 'ADDRESSING MODE IS IR';

   4408 56 006740   040100 100400                    MLR     fill='040'O
        56 006741   000760 000025 55                 ADSC9   496                      cn=0,n=21
        56 006742   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 006743   007117 710000 56                 TRA     s:4483

     2037     4409
     2038     4410    3           CASE(%PUT_RI);

     2039     4411    3               BUFFER = 'ADDRESSING MODE IS RI';

   4411 56 006744   040100 100400                    MLR     fill='040'O
        56 006745   000766 000025 55                 ADSC9   502                      cn=0,n=21
        56 006746   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 006747   007117 710000 56                 TRA     s:4483

     2040     4412
     2041     4413    3           CASE(%PUT_MOD_TYPE);

     2042     4414    3               CALL CONCAT(BUFFER,' ADDRESSING MODIFICATION IS  ',MOD_TYPE);

   4414 56 006750   040100 100400                    MLR     fill='040'O
        56 006751   000774 000035 55                 ADSC9   508                      cn=0,n=29
        56 006752   200005 000035                    ADSC9   BUFFER,,AUTO             cn=0,n=29
        56 006753   040100 100400                    MLR     fill='040'O
        56 006754   001422 000003 52                 ADSC9   MOD_TYPE                 cn=0,n=3
        56 006755   200014 200157                    ADSC9   BUFFER+7,,AUTO           cn=1,n=111
        56 006756   007117 710000 56                 TRA     s:4483

     2043     4415
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:289  
     2044     4416    3           CASE(%PUT_INTEGER_OPERAND);

     2045     4417    3               CALL CONCAT(BUFFER,'PUT INTEGER OPERAND ',

   4417 56 006757   000000 236000 1                  LDQ     LX_TOP
        56 006760   000006 402007                    MPY     6,DL
        56 006761   000001 471406 2                  LDP1    LX_STK+1,QL
        56 006762   100000 720100                    LXL0    0,,PR1
        56 006763   040100 100400                    MLR     fill='040'O
        56 006764   001004 000024 55                 ADSC9   516                      cn=0,n=20
        56 006765   200005 000024                    ADSC9   BUFFER,,AUTO             cn=0,n=20
        56 006766   040100 100540                    MLR     fill='040'O
        56 006767   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 006770   200012 000170                    ADSC9   BUFFER+5,,AUTO           cn=0,n=120
        56 006771   007117 710000 56                 TRA     s:4483

     2046     4418    3                    LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2047     4419
     2048     4420    3           CASE(%PUT_ZERO_OPERAND);

     2049     4421    3               BUFFER = 'PUT ZERO OPERAND';

   4421 56 006772   040100 100400                    MLR     fill='040'O
        56 006773   001011 000020 55                 ADSC9   521                      cn=0,n=16
        56 006774   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 006775   007117 710000 56                 TRA     s:4483

     2050     4422
     2051     4423    3           CASE(%AHEAD_OT_POS1);

     2052     4424    3               BUFFER = 'INCREMENT AHEAD_OT_POS BY 1';

   4424 56 006776   040100 100400                    MLR     fill='040'O
        56 006777   001015 000033 55                 ADSC9   525                      cn=0,n=27
        56 007000   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007001   007117 710000 56                 TRA     s:4483

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:290  
     2053     4425
     2054     4426    3           CASE(%AHEAD_OT_POS2);

     2055     4427    3               BUFFER = 'INCREMENT AHEAD_OT_POS BY 2';

   4427 56 007002   040100 100400                    MLR     fill='040'O
        56 007003   001024 000033 55                 ADSC9   532                      cn=0,n=27
        56 007004   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007005   007117 710000 56                 TRA     s:4483

     2056     4428
     2057     4429    3           CASE(%PUT_MODFIELD);

     2058     4430    3               CALL BINCHAR(CHAR_NUM,MODFIELD_CNT);

   4430 56 007006   000100 301400                    BTD
        56 007007   001430 000004 52                 NDSC9   MODFIELD_CNT             cn=0,s=lsgnf,sf=0,n=4
        56 007010   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30

     2059     4431    3               CALL CONCAT(BUFFER,'PUT MODFIELD NUMBER ',CHAR_NUM);

   4431 56 007011   040100 100400                    MLR     fill='040'O
        56 007012   001033 000024 55                 ADSC9   539                      cn=0,n=20
        56 007013   200005 000024                    ADSC9   BUFFER,,AUTO             cn=0,n=20
        56 007014   040100 100500                    MLR     fill='040'O
        56 007015   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30
        56 007016   200012 000170                    ADSC9   BUFFER+5,,AUTO           cn=0,n=120
        56 007017   007117 710000 56                 TRA     s:4483

     2060     4432
     2061     4433    3           CASE(%PUT_BASE_SPECIFIER);

     2062     4434    3               CALL CONCAT(BUFFER,'PUT BASE SPECIFIER ',VFD_BASE_SPECIFIER);

   4434 56 007020   040100 100400                    MLR     fill='040'O
        56 007021   001040 000023 55                 ADSC9   544                      cn=0,n=19
        56 007022   200005 000023                    ADSC9   BUFFER,,AUTO             cn=0,n=19
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:291  
        56 007023   040100 100400                    MLR     fill='040'O
        56 007024   001437 000001 52                 ADSC9   VFD_BASE_SPECIFIER       cn=0,n=1
        56 007025   200011 600171                    ADSC9   BUFFER+4,,AUTO           cn=3,n=121
        56 007026   007117 710000 56                 TRA     s:4483

     2063     4435
     2064     4436    3           CASE(%LOAD_VFD_FIELD);

     2065     4437    3               BUFFER = 'LOAD VFD FIELD';

   4437 56 007027   040100 100400                    MLR     fill='040'O
        56 007030   001045 000016 55                 ADSC9   549                      cn=0,n=14
        56 007031   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007032   007117 710000 56                 TRA     s:4483

     2066     4438
     2067     4439    3           CASE(%PUT_YFIELD_ARITH);

     2068     4440    3               BUFFER = 'PUT ARITH EXP FROM YFIELD';

   4440 56 007033   040100 100400                    MLR     fill='040'O
        56 007034   001051 000031 55                 ADSC9   553                      cn=0,n=25
        56 007035   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007036   007117 710000 56                 TRA     s:4483

     2069     4441
     2070     4442    3           CASE(%HANDLE_EQU_INT);

     2071     4443    3               BUFFER = 'HANDLE AN EQU WITH INTEGER VALUE';

   4443 56 007037   040100 100400                    MLR     fill='040'O
        56 007040   001060 000040 55                 ADSC9   560                      cn=0,n=32
        56 007041   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007042   007117 710000 56                 TRA     s:4483

     2072     4444
     2073     4445    3           CASE(%HANDLE_EQU_LABEL);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:292  

     2074     4446    3               BUFFER = 'HANDLE AN EQU WITH LABEL VALUE';

   4446 56 007043   040100 100400                    MLR     fill='040'O
        56 007044   001070 000036 55                 ADSC9   568                      cn=0,n=30
        56 007045   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007046   007117 710000 56                 TRA     s:4483

     2075     4447
     2076     4448    3           CASE(%PUT_OCTAL_LITERAL);

     2077     4449    3               BUFFER = 'PUT OCTAL LITERAL INTO YFIELD';

   4449 56 007047   040100 100400                    MLR     fill='040'O
        56 007050   001100 000035 55                 ADSC9   576                      cn=0,n=29
        56 007051   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007052   007117 710000 56                 TRA     s:4483

     2078     4450
     2079     4451    3           CASE(%PUT_DECIMAL_LITERAL);

     2080     4452    3               BUFFER = 'PUT OCTAL LITERAL INTO YFIELD';

   4452 56 007053   040100 100400                    MLR     fill='040'O
        56 007054   001100 000035 55                 ADSC9   576                      cn=0,n=29
        56 007055   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007056   007117 710000 56                 TRA     s:4483

     2081     4453
     2082     4454    3           CASE(%PUT_NULL_MODFIELD);

     2083     4455    3               BUFFER = 'PUT NULL MODFIELD';

   4455 56 007057   040100 100400                    MLR     fill='040'O
        56 007060   001110 000021 55                 ADSC9   584                      cn=0,n=17
        56 007061   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007062   007117 710000 56                 TRA     s:4483
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:293  

     2084     4456
     2085     4457    3           CASE(%CLEAR_SIGN_FLAG);

     2086     4458    3               BUFFER = 'CLEAR THE SIGN FLAG FOR A GENI LITERAL ';

   4458 56 007063   040100 100400                    MLR     fill='040'O
        56 007064   001115 000047 55                 ADSC9   589                      cn=0,n=39
        56 007065   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007066   007117 710000 56                 TRA     s:4483

     2087     4459
     2088     4460    3           CASE(%SET_EIS_OP1,%SET_EIS_OP2,%SET_EIS_OP3);

     2089     4461    3               BUFFER = 'SET EIS OPTIONAL FIELD (FOLLOWING MOD FIELDS)';

   4461 56 007067   040100 100400                    MLR     fill='040'O
        56 007070   001127 000055 55                 ADSC9   599                      cn=0,n=45
        56 007071   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007072   007117 710000 56                 TRA     s:4483

     2090     4462
     2091     4463    3           CASE(%EJECT_A_PAGE);

     2092     4464    3               BUFFER = 'EJECT A PAGE';

   4464 56 007073   040100 100400                    MLR     fill='040'O
        56 007074   001143 000014 55                 ADSC9   611                      cn=0,n=12
        56 007075   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007076   007117 710000 56                 TRA     s:4483

     2093     4465
     2094     4466    3           CASE(%PUT_UNSIGNED_DECIMAL_LITERAL);

     2095     4467    3               BUFFER = 'PUT AN UNSIGNED DECIMAL INTEGER INTO P_CODE';

   4467 56 007077   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:294  
        56 007100   001146 000053 55                 ADSC9   614                      cn=0,n=43
        56 007101   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007102   007117 710000 56                 TRA     s:4483

     2096     4468
     2097     4469    3           CASE(%SKIP_PL6);

     2098     4470    3               BUFFER = 'SKIP CODE UNTIL ENTER_PCA IS FOUND';

   4470 56 007103   040100 100400                    MLR     fill='040'O
        56 007104   001161 000042 55                 ADSC9   625                      cn=0,n=34
        56 007105   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007106   007117 710000 56                 TRA     s:4483

     2099     4471
     2100     4472    3           CASE(%PUT_BURST);

     2101     4473    3               BUFFER = 'PUT THE DESTINATION OF A BURST DIRECTIVE INTO BURST TABLE';

   4473 56 007107   040100 100400                    MLR     fill='040'O
        56 007110   001172 000071 55                 ADSC9   634                      cn=0,n=57
        56 007111   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        56 007112   007117 710000 56                 TRA     s:4483

     2102     4474
     2103     4475    3           CASE(ELSE);

     2104     4476    3               CALL Z8PA$ERROR_PROC(%MESS9);

   4476 56 007113   000060 630400 57                 EPPR0   48
        56 007114   000006 631400 57                 EPPR1   6
        56 007115   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 007116   000000 011000                    NOP     0

     2105     4477    3      END;  /* CASE */

     2106     4478           %OUTPUT_STR;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:295  

   4483 56 007117   000000 236000 24                 LDQ     OUT_DCBN
        56 007120   007130 604000 56                 TMI     s:4485
        56 007121   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        56 007122   007130 601000 56                 TNZ     s:4485
        56 007123   000000 236000 34                 LDQ     OPTIONS
        56 007124   000002 736000                    QLS     2
        56 007125   400000 376003                    ANQ     -131072,DU
        56 007126   400000 676003                    ERQ     -131072,DU
        56 007127   007142 601000 56                 TNZ     s:4489

   4485 56 007130   000214 235007                    LDA     140,DL
        56 007131   200050 755100                    STA     LEN,,AUTO

   4486 56 007132   200050 630500                    EPPR0   LEN,,AUTO
        56 007133   200277 450500                    STP0    CNT2+3,,AUTO
        56 007134   200005 631500                    EPPR1   BUFFER,,AUTO
        56 007135   200276 451500                    STP1    CNT2+2,,AUTO
        56 007136   200276 630500                    EPPR0   CNT2+2,,AUTO
        56 007137   000000 631400 57                 EPPR1   0
        56 007140   000000 701000 xent               TSX1    OUTPUT
        56 007141   000000 011000                    NOP     0

     2107     4489    2    END TRACE;

   4489 56 007142   200240 221300                    LDX1  ! SHIFT_FACTOR+2,,AUTO
        56 007143   000001 702211                    TSX2  ! 1,X1

     2108     4490         %EJECT;
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:296  
     2109     4491    2      DO CASE (A);

   4491 56 007144   200003 470500                    LDP0    @A,,AUTO
        56 007145   000000 235100                    LDA     0,,PR0
        56 007146   000054 115007                    CMPA    44,DL
        56 007147   007151 602005 56                 TNC     s:4491+5,AL
        56 007150   010573 710000 56                 TRA     s:4746
        56 007151   010573 710000 56                 TRA     s:4746
        56 007152   007556 710000 56                 TRA     s:4566
        56 007153   007230 710000 56                 TRA     s:4496
        56 007154   007225 710000 56                 TRA     s:4493
        56 007155   007405 710000 56                 TRA     s:4535
        56 007156   007425 710000 56                 TRA     s:4540
        56 007157   007310 710000 56                 TRA     s:4513
        56 007160   007551 710000 56                 TRA     s:4562
        56 007161   007751 710000 56                 TRA     s:4621
        56 007162   007763 710000 56                 TRA     s:4627
        56 007163   007371 710000 56                 TRA     s:4531
        56 007164   007337 710000 56                 TRA     s:4523
        56 007165   007741 710000 56                 TRA     s:4617
        56 007166   007445 710000 56                 TRA     s:4545
        56 007167   007477 710000 56                 TRA     s:4553
        56 007170   007515 710000 56                 TRA     s:4557
        56 007171   007615 710000 56                 TRA     s:4583
        56 007172   010413 710000 56                 TRA     s:4704
        56 007173   010427 710000 56                 TRA     s:4711
        56 007174   010454 710000 56                 TRA     s:4717
        56 007175   010501 710000 56                 TRA     s:4723
        56 007176   007775 710000 56                 TRA     s:4633
        56 007177   010276 710000 56                 TRA     s:4677
        56 007200   010425 710000 56                 TRA     s:4708
        56 007201   010326 710000 56                 TRA     s:4686
        56 007202   010233 710000 56                 TRA     s:4665
        56 007203   010344 710000 56                 TRA     s:4692
        56 007204   010573 710000 56                 TRA     s:4746
        56 007205   010573 710000 56                 TRA     s:4746
        56 007206   007627 710000 56                 TRA     s:4587
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:297  
        56 007207   007632 710000 56                 TRA     s:4590
        56 007210   007635 710000 56                 TRA     s:4593
        56 007211   010136 710000 56                 TRA     s:4647
        56 007212   010126 710000 56                 TRA     s:4644
        56 007213   007645 710000 56                 TRA     s:4596
        56 007214   007355 710000 56                 TRA     s:4527
        56 007215   010267 710000 56                 TRA     s:4674
        56 007216   010251 710000 56                 TRA     s:4670
        56 007217   010526 710000 56                 TRA     s:4729
        56 007220   010537 710000 56                 TRA     s:4736
        56 007221   007300 710000 56                 TRA     s:4509
        56 007222   007270 710000 56                 TRA     s:4505
        56 007223   010542 710000 56                 TRA     s:4739
        56 007224   007670 710000 56                 TRA     s:4603

     2110     4492    2           CASE(%SET_OPTIONS);

     2111     4493    2               TRACE_OPT_ON = %TRUE;

   4493 56 007225   400000 236003                    LDQ     -131072,DU
        56 007226   001360 756000 52                 STQ     TRACE_OPT_ON
        56 007227   010577 710000 56                 TRA     s:4749

     2112     4494
     2113     4495    2           CASE(%PUT_PROG_INFO);

     2114     4496    2               SEGMENT_NAME = LX_STK.DNTPTR(LX_TOP - 1)->DNT.TEXT.NAME;

   4496 56 007230   000000 236000 1                  LDQ     LX_TOP
        56 007231   000006 402007                    MPY     6,DL
        56 007232   777773 471406 2                  LDP1    LX_STK-5,QL
        56 007233   100000 720100                    LXL0    0,,PR1
        56 007234   040000 100540                    MLR     fill='040'O
        56 007235   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007236   001373 000036 52                 ADSC9   SEGMENT_NAME             cn=0,n=30

     2115     4497    2               CHAR_NUM = ' ';
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:298  

   4497 56 007237   040100 100400                    MLR     fill='040'O
        56 007240   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 007241   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30

     2116     4498    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4498                        LENGTH),,

   4498 56 007242   000001 473406 2                  LDP3    LX_STK+1,QL
        56 007243   300000 720100                    LXL0    0,,PR3
        56 007244   300000 235100                    LDA     0,,PR3
        56 007245   200276 740100                    STX0    CNT2+2,,AUTO
        56 007246   000000 531000                    NEG     0
        56 007247   200276 221100                    LDX1    CNT2+2,,AUTO
        56 007250   040145 100540                    MLR     fill='040'O
        56 007251   300001 000011                    ADSC9   1,,PR3                   cn=0,n=*X1
        56 007252   200060 400010                    ADSC9   CHAR_NUM+7,A,AUTO        cn=2,n=*X0

     2117     4499    2                       LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2118     4500    2               CALL CHARBIN(SEGMENT_NUMBER,CHAR_NUM);

   4500 56 007253   000100 305500                    DTB
        56 007254   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30
        56 007255   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 007256   200277 235100                    LDA     CNT2+3,,AUTO
        56 007257   001372 755000 52                 STA     SEGMENT_NUMBER

     2119     4501    2               PROC_NAME = LX_STK.DNTPTR(LX_TOP-2)->DNT.TEXT.NAME;

   4501 56 007260   777765 474406 2                  LDP4    LX_STK-11,QL
        56 007261   400000 720100                    LXL0    0,,PR4
        56 007262   040000 100540                    MLR     fill='040'O
        56 007263   400001 000010                    ADSC9   1,,PR4                   cn=0,n=*X0
        56 007264   001362 000036 52                 ADSC9   PROC_NAME                cn=0,n=30

     2120     4502    2               CALL SET_UP_PROG;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:299  
   4502 56 007265   000003 701000 56                 TSX1    SET_UP_PROG
        56 007266   000000 011000                    NOP     0
        56 007267   010577 710000 56                 TRA     s:4749

     2121     4503
     2122     4504    2           CASE(%PUT_START_DEP);

     2123     4505    2               LABEL_POS->LABEL_TABLE.TYPE = '**';

   4505 56 007270   001230 220000 55                 LDX0    664
        56 007271   001413 471400 52                 LDP1    LABEL_POS
        56 007272   100013 740100                    STX0    11,,PR1

     2124     4506    2               CALL PUT_LABEL_DEP(LABEL_POS);

   4506 56 007273   000061 236000 57                 LDQ     49
        56 007274   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007275   000663 701000 56                 TSX1    PUT_LABEL_DEP
        56 007276   000000 011000                    NOP     0
        56 007277   010577 710000 56                 TRA     s:4749

     2125     4507
     2126     4508    2           CASE(%PUT_START_PEPD);

     2127     4509    2                LABEL_POS->LABEL_TABLE.TYPE = '**';

   4509 56 007300   001230 220000 55                 LDX0    664
        56 007301   001413 471400 52                 LDP1    LABEL_POS
        56 007302   100013 740100                    STX0    11,,PR1

     2128     4510    2               CALL PUT_LABEL_PEPD(LABEL_POS);

   4510 56 007303   000061 236000 57                 LDQ     49
        56 007304   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007305   000627 701000 56                 TSX1    PUT_LABEL_PEPD
        56 007306   000000 011000                    NOP     0
        56 007307   010577 710000 56                 TRA     s:4749
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:300  

     2129     4511
     2130     4512    2           CASE(%PUT_LABEL);

     2131     4513    2               LABEL_TYPE = ' ';

   4513 56 007310   040100 100400                    MLR     fill='040'O
        56 007311   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 007312   200074 000005                    ADSC9   LABEL_TYPE,,AUTO         cn=0,n=5

     2132     4514    2               CALL PUT_LABEL_DEF(LABEL_POS,LABEL_TYPE);

   4514 56 007313   200074 631500                    EPPR1   LABEL_TYPE,,AUTO
        56 007314   200242 451500                    STP1    NUM+1,,AUTO
        56 007315   000061 236000 57                 LDQ     49
        56 007316   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007317   000271 701000 56                 TSX1    PUT_LABEL_DEF
        56 007320   000000 011000                    NOP     0

     2133     4515    2               IF ~LOCAL_FLAG AND (TOP_LOCAL_LABEL_TABLE ~= ADDR(NIL)) THEN

   4515 56 007321   001415 236000 52                 LDQ     LOCAL_FLAG
        56 007322   400000 376003                    ANQ     -131072,DU
        56 007323   400000 676003                    ERQ     -131072,DU
        56 007324   010577 600000 56                 TZE     s:4749
        56 007325   001533 236000 52                 LDQ     TOP_LOCAL_LABEL_TABLE
        56 007326   000004 116000 57                 CMPQ    4
        56 007327   010577 600000 56                 TZE     s:4749

     2134     4516    3                 DO;

     2135     4517    3                   CALL GEN_JMP_DEST(TOP_LOCAL_LABEL_TABLE);

   4517 56 007330   000015 236000 57                 LDQ     13
        56 007331   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007332   005575 701000 56                 TSX1    GEN_JMP_DEST
        56 007333   000000 011000                    NOP     0
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:301  

     2136     4518    3                   TOP_LOCAL_LABEL_TABLE = ADDR(NIL);

   4518 56 007334   000004 236000 57                 LDQ     4
        56 007335   001533 756000 52                 STQ     TOP_LOCAL_LABEL_TABLE

     2137     4519    3                 END;

   4519 56 007336   010577 710000 56                 TRA     s:4749

     2138     4520
     2139     4521
     2140     4522    2           CASE(%PUT_OPERAND_MOD);

     2141     4523    2               CALL CONCAT(OPERAND,'%',LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME);

   4523 56 007337   000000 236000 1                  LDQ     LX_TOP
        56 007340   000006 402007                    MPY     6,DL
        56 007341   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007342   100000 720100                    LXL0    0,,PR1
        56 007343   045000 236003                    LDQ     18944,DU
        56 007344   200064 756100                    STQ     OPERAND,,AUTO
        56 007345   040100 100540                    MLR     fill='040'O
        56 007346   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007347   200064 200035                    ADSC9   OPERAND,,AUTO            cn=1,n=29

     2142     4524    2               CALL PUT_OPERAND(OPERAND);

   4524 56 007350   200064 630500                    EPPR0   OPERAND,,AUTO
        56 007351   200241 450500                    STP0    SHIFT_FACTOR+3,,AUTO
        56 007352   001677 701000 56                 TSX1    PUT_OPERAND
        56 007353   000000 011000                    NOP     0
        56 007354   010577 710000 56                 TRA     s:4749

     2143     4525
     2144     4526    2           CASE(%PUT_OPERAND_UNMOD);

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:302  
     2145     4527    2               OPERAND = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;

   4527 56 007355   000000 236000 1                  LDQ     LX_TOP
        56 007356   000006 402007                    MPY     6,DL
        56 007357   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007360   100000 720100                    LXL0    0,,PR1
        56 007361   040100 100540                    MLR     fill='040'O
        56 007362   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007363   200064 000036                    ADSC9   OPERAND,,AUTO            cn=0,n=30

     2146     4528    2               CALL PUT_OPERAND(OPERAND);

   4528 56 007364   200064 633500                    EPPR3   OPERAND,,AUTO
        56 007365   200241 453500                    STP3    SHIFT_FACTOR+3,,AUTO
        56 007366   001677 701000 56                 TSX1    PUT_OPERAND
        56 007367   000000 011000                    NOP     0
        56 007370   010577 710000 56                 TRA     s:4749

     2147     4529
     2148     4530    2           CASE(%PUT_SIMPLE_DIR);

     2149     4531    2               P_CODE.SYMBOL = LX_STK.SYMBOL(LX_TOP);

   4531 56 007371   000000 236000 1                  LDQ     LX_TOP
        56 007372   000006 402007                    MPY     6,DL
        56 007373   000002 235006 2                  LDA     LX_STK+2,QL
        56 007374   001443 755000 52                 STA     P_CODE+3

     2150     4532    2              CALL CONCAT(P_CODE.SIMPLE_DIR,'%',LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME
              4532                        );

   4532 56 007375   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007376   100000 720100                    LXL0    0,,PR1
        56 007377   045000 236003                    LDQ     18944,DU
        56 007400   001440 756000 52                 STQ     P_CODE
        56 007401   040000 100540                    MLR     fill='040'O
        56 007402   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:303  
        56 007403   001440 200013 52                 ADSC9   P_CODE                   cn=1,n=11
        56 007404   010577 710000 56                 TRA     s:4749

     2151     4533
     2152     4534    2           CASE(%ADD_XREF);

     2153     4535    2               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;

   4535 56 007405   000000 236000 1                  LDQ     LX_TOP
        56 007406   000006 402007                    MPY     6,DL
        56 007407   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007410   100000 720100                    LXL0    0,,PR1
        56 007411   040000 100540                    MLR     fill='040'O
        56 007412   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007413   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30

     2154     4536    2               PREVIOUS_LABEL_POS = LABEL_POS;

   4536 56 007414   001413 236000 52                 LDQ     LABEL_POS
        56 007415   001414 756000 52                 STQ     PREVIOUS_LABEL_POS

     2155     4537    2               CALL REFERENCE_LABEL_TABLE(LABEL_NAME,LABEL_POS);

   4537 56 007416   000061 236000 57                 LDQ     49
        56 007417   200242 756100                    STQ     NUM+1,,AUTO
        56 007420   000062 236000 57                 LDQ     50
        56 007421   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007422   000344 701000 56                 TSX1    REFERENCE_LABEL_TABLE
        56 007423   000000 011000                    NOP     0
        56 007424   010577 710000 56                 TRA     s:4749

     2156     4538
     2157     4539    2           CASE(%ADD_LOCAL_XREF);

     2158     4540    2               LABEL_NAME = LX_STK.DNTPTR(LX_TOP) -> DNT.TEXT.NAME;

   4540 56 007425   000000 236000 1                  LDQ     LX_TOP
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:304  
        56 007426   000006 402007                    MPY     6,DL
        56 007427   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007430   100000 720100                    LXL0    0,,PR1
        56 007431   040000 100540                    MLR     fill='040'O
        56 007432   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007433   001403 000036 52                 ADSC9   LABEL_NAME               cn=0,n=30

     2159     4541    2               PREVIOUS_LABEL_POS = LABEL_POS;

   4541 56 007434   001413 236000 52                 LDQ     LABEL_POS
        56 007435   001414 756000 52                 STQ     PREVIOUS_LABEL_POS

     2160     4542    2               CALL REFERENCE_LOCAL_LABEL_TABLE(LABEL_NAME,LABEL_POS);

   4542 56 007436   000061 236000 57                 LDQ     49
        56 007437   200242 756100                    STQ     NUM+1,,AUTO
        56 007440   000062 236000 57                 LDQ     50
        56 007441   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007442   000607 701000 56                 TSX1    REFERENCE_LOCAL_LABEL_TABLE
        56 007443   000000 011000                    NOP     0
        56 007444   010577 710000 56                 TRA     s:4749

     2161     4543
     2162     4544    2           CASE(%PUT_JMP_DEST);

     2163     4545    2               CALL BINCHAR(DEST_CHAR,UNIQUE_NUM);

   4545 56 007445   001361 236000 52                 LDQ     UNIQUE_NUM
        56 007446   000000 235003                    LDA     0,DU
        56 007447   200276 757100                    STAQ    CNT2+2,,AUTO
        56 007450   000100 301500                    BTD
        56 007451   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 007452   200062 030010                    NDSC9   DEST_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=8

     2164     4546    2               CALL CONCAT(OPERAND,'%D',DEST_CHAR);

   4546 56 007453   001231 220000 55                 LDX0    665
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:305  
        56 007454   200064 740100                    STX0    OPERAND,,AUTO
        56 007455   040100 100500                    MLR     fill='040'O
        56 007456   200062 000010                    ADSC9   DEST_CHAR,,AUTO          cn=0,n=8
        56 007457   200064 400034                    ADSC9   OPERAND,,AUTO            cn=2,n=28

     2165     4547    2               CALL PUT_OPERAND(OPERAND);

   4547 56 007460   200064 630500                    EPPR0   OPERAND,,AUTO
        56 007461   200241 450500                    STP0    SHIFT_FACTOR+3,,AUTO
        56 007462   001677 701000 56                 TSX1    PUT_OPERAND
        56 007463   000000 011000                    NOP     0

     2166     4548    2               CALL BINCHAR(REF_POS->REF_LIST.DEST,UNIQUE_NUM);

   4548 56 007464   001361 235000 52                 LDA     UNIQUE_NUM
        56 007465   000044 773000                    LRL     36
        56 007466   200276 757100                    STAQ    CNT2+2,,AUTO
        56 007467   001524 470400 52                 LDP0    REF_POS
        56 007470   000100 301500                    BTD
        56 007471   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 007472   000002 030010                    NDSC9   2,,PR0                   cn=0,s=nosgn,sf=0,n=8

     2167     4549    2               UNIQUE_NUM = UNIQUE_NUM + 1;

   4549 56 007473   001361 235000 52                 LDA     UNIQUE_NUM
        56 007474   000001 035007                    ADLA    1,DL
        56 007475   001361 755000 52                 STA     UNIQUE_NUM
        56 007476   010577 710000 56                 TRA     s:4749

     2168     4550
     2169     4551
     2170     4552    2           CASE(%PUT_UNSPECIFIC_REG);

     2171     4553    2               CALL CONCAT(OPERAND,'%',LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);

   4553 56 007477   000000 236000 1                  LDQ     LX_TOP
        56 007500   000006 402007                    MPY     6,DL
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:306  
        56 007501   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007502   100000 720100                    LXL0    0,,PR1
        56 007503   045000 236003                    LDQ     18944,DU
        56 007504   200064 756100                    STQ     OPERAND,,AUTO
        56 007505   040100 100540                    MLR     fill='040'O
        56 007506   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007507   200064 200035                    ADSC9   OPERAND,,AUTO            cn=1,n=29

     2172     4554    2               CALL PUT_OPERAND(OPERAND);

   4554 56 007510   200064 630500                    EPPR0   OPERAND,,AUTO
        56 007511   200241 450500                    STP0    SHIFT_FACTOR+3,,AUTO
        56 007512   001677 701000 56                 TSX1    PUT_OPERAND
        56 007513   000000 011000                    NOP     0
        56 007514   010577 710000 56                 TRA     s:4749

     2173     4555
     2174     4556    2           CASE(%PUT_SPECIFIC_REG);

     2175     4557    2               CALL CONCAT(OPERAND,'%',LX_STK.DNTPTR(LX_TOP - 1)->DNT.TEXT.NAME,

   4557 56 007515   000000 236000 1                  LDQ     LX_TOP
        56 007516   000006 402007                    MPY     6,DL
        56 007517   777773 471406 2                  LDP1    LX_STK-5,QL
        56 007520   100000 720100                    LXL0    0,,PR1
        56 007521   000007 473406 2                  LDP3    LX_STK+7,QL
        56 007522   300000 721100                    LXL1    0,,PR3
        56 007523   045000 236003                    LDQ     18944,DU
        56 007524   200064 756100                    STQ     OPERAND,,AUTO
        56 007525   040100 100540                    MLR     fill='040'O
        56 007526   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007527   200064 200035                    ADSC9   OPERAND,,AUTO            cn=1,n=29
        56 007530   000000 636010                    EAQ     0,X0
        56 007531   000022 732000                    QRS     18
        56 007532   000035 116007                    CMPQ    29,DL
        56 007533   007544 605000 56                 TPL     s:4559
        56 007534   200276 740100                    STX0    CNT2+2,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:307  
        56 007535   777742 620010                    EAX0    -30,X0
        56 007536   777777 660003                    ERX0    -1,DU
        56 007537   200276 235100                    LDA     CNT2+2,,AUTO
        56 007540   000022 731000                    ARS     18
        56 007541   040145 100540                    MLR     fill='040'O
        56 007542   300001 000011                    ADSC9   1,,PR3                   cn=0,n=*X1
        56 007543   200064 200010                    ADSC9   OPERAND,A,AUTO           cn=1,n=*X0

     2176     4558    2                           LX_STK.DNTPTR(LX_TOP + 1)->DNT.TEXT.NAME);
     2177     4559    2               CALL PUT_OPERAND(OPERAND);

   4559 56 007544   200064 631500                    EPPR1   OPERAND,,AUTO
        56 007545   200241 451500                    STP1    SHIFT_FACTOR+3,,AUTO
        56 007546   001677 701000 56                 TSX1    PUT_OPERAND
        56 007547   000000 011000                    NOP     0
        56 007550   010577 710000 56                 TRA     s:4749

     2178     4560
     2179     4561    2           CASE(%GENERATE_P_CODE);

     2180     4562    2               CALL GEN_P_CODE;

   4562 56 007551   004033 701000 56                 TSX1    GEN_P_CODE
        56 007552   000000 011000                    NOP     0

     2181     4563    2               CALL INIT_P_CODE;

   4563 56 007553   000143 701000 56                 TSX1    INIT_P_CODE
        56 007554   000000 011000                    NOP     0
        56 007555   010577 710000 56                 TRA     s:4749

     2182     4564
     2183     4565    2           CASE(%FINISH_PROGRAM);

     2184     4566    2               CALL TERMINATE_OT;

   4566 56 007556   005742 701000 56                 TSX1    TERMINATE_OT
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:308  
        56 007557   000000 011000                    NOP     0

     2185     4567    2               IF OPTIONS(XREF_OPT) THEN

   4567 56 007560   000000 236000 34                 LDQ     OPTIONS
        56 007561   000200 316003                    CANQ    128,DU
        56 007562   007567 600000 56                 TZE     s:4572

     2186     4568    3                 DO;

     2187     4569    3                   PHASE = %GEN_XR;

   4569 56 007563   000003 235007                    LDA     3,DL
        56 007564   000000 755000 50                 STA     PHASE

     2188     4570    3                   CALL GENERATE_XREF;

   4570 56 007565   005445 701000 56                 TSX1    GENERATE_XREF
        56 007566   000000 011000                    NOP     0

     2189     4571    3                 END;

     2190     4572    2               PHASE = %OUT_LABEL;

   4572 56 007567   000002 235007                    LDA     2,DL
        56 007570   000000 755000 50                 STA     PHASE

     2191     4573    2               CALL GEN_JMP_DEST(TOP_LABEL_TABLE);

   4573 56 007571   000007 236000 57                 LDQ     7
        56 007572   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007573   005575 701000 56                 TSX1    GEN_JMP_DEST
        56 007574   000000 011000                    NOP     0

     2192     4574    2               CALL GEN_JMP_DEST(TOP_LOCAL_LABEL_TABLE);

   4574 56 007575   000015 236000 57                 LDQ     13
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:309  
        56 007576   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 007577   005575 701000 56                 TSX1    GEN_JMP_DEST
        56 007600   000000 011000                    NOP     0

     2193     4575    2               CALL OUTPUT_BURST_DEST;

   4575 56 007601   005614 701000 56                 TSX1    OUTPUT_BURST_DEST
        56 007602   000000 011000                    NOP     0

     2194     4576    2               PHASE = %OUT_PEPD;

   4576 56 007603   000004 235007                    LDA     4,DL
        56 007604   000000 755000 50                 STA     PHASE

     2195     4577    2               CALL OUTPUT_PEPD;

   4577 56 007605   001016 701000 56                 TSX1    OUTPUT_PEPD
        56 007606   000000 011000                    NOP     0

     2196     4578    2               PHASE = %WRAP_UP;

   4578 56 007607   000005 235007                    LDA     5,DL
        56 007610   000000 755000 50                 STA     PHASE

     2197     4579    2               CALL Z8PA$WRAPUP;

   4579 56 007611   000002 631400 57                 EPPR1   2
        56 007612   000000 701000 xent               TSX1    Z8PA$WRAPUP
        56 007613   000000 011000                    NOP     0
        56 007614   010577 710000 56                 TRA     s:4749

     2198     4580
     2199     4581
     2200     4582    2           CASE(%PUT_OPCODE);

     2201     4583    2               OPCODE = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:310  
   4583 56 007615   000000 236000 1                  LDQ     LX_TOP
        56 007616   000006 402007                    MPY     6,DL
        56 007617   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007620   100000 720100                    LXL0    0,,PR1
        56 007621   040000 100540                    MLR     fill='040'O
        56 007622   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007623   001417 000005 52                 ADSC9   OPCODE                   cn=0,n=5

     2202     4584    2               CALL INIT_ASSEMBLY_INST;

   4584 56 007624   000173 701000 56                 TSX1    INIT_ASSEMBLY_INST
        56 007625   000000 011000                    NOP     0
        56 007626   010577 710000 56                 TRA     s:4749

     2203     4585
     2204     4586    2           CASE(%PUT_IR);

     2205     4587    2               TAG_TYPE = 'IR';

   4587 56 007627   001202 220000 55                 LDX0    642
        56 007630   001423 740000 52                 STX0    TAG_TYPE
        56 007631   010577 710000 56                 TRA     s:4749

     2206     4588
     2207     4589    2           CASE(%PUT_RI);

     2208     4590    2               TAG_TYPE = 'RI';

   4590 56 007632   001232 220000 55                 LDX0    666
        56 007633   001423 740000 52                 STX0    TAG_TYPE
        56 007634   010577 710000 56                 TRA     s:4749

     2209     4591
     2210     4592    2           CASE(%PUT_MOD_TYPE);

     2211     4593    2               MOD_TYPE = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:311  
   4593 56 007635   000000 236000 1                  LDQ     LX_TOP
        56 007636   000006 402007                    MPY     6,DL
        56 007637   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007640   100000 720100                    LXL0    0,,PR1
        56 007641   040000 100540                    MLR     fill='040'O
        56 007642   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 007643   001422 000003 52                 ADSC9   MOD_TYPE                 cn=0,n=3
        56 007644   010577 710000 56                 TRA     s:4749

     2212     4594
     2213     4595    2          CASE(%PUT_INTEGER_OPERAND);

     2214     4596    2                OPERAND = ' ';

   4596 56 007645   040100 100400                    MLR     fill='040'O
        56 007646   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 007647   200064 000036                    ADSC9   OPERAND,,AUTO            cn=0,n=30

     2215     4597    2                CALL INSERT(OPERAND,

   4597 56 007650   000000 236000 1                  LDQ     LX_TOP
        56 007651   000006 402007                    MPY     6,DL
        56 007652   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007653   100000 720100                    LXL0    0,,PR1
        56 007654   100000 235100                    LDA     0,,PR1
        56 007655   200276 740100                    STX0    CNT2+2,,AUTO
        56 007656   000000 531000                    NEG     0
        56 007657   200276 221100                    LDX1    CNT2+2,,AUTO
        56 007660   040145 100540                    MLR     fill='040'O
        56 007661   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
        56 007662   200073 400010                    ADSC9   OPERAND+7,A,AUTO         cn=2,n=*X0

     2216     4598    2                            (%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.LENGTH),,
     2217     4599    2                            LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2218     4600    2                CALL PUT_OPERAND(OPERAND);

   4600 56 007663   200064 633500                    EPPR3   OPERAND,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:312  
        56 007664   200241 453500                    STP3    SHIFT_FACTOR+3,,AUTO
        56 007665   001677 701000 56                 TSX1    PUT_OPERAND
        56 007666   000000 011000                    NOP     0
        56 007667   010577 710000 56                 TRA     s:4749

     2219     4601
     2220     4602    2          CASE(%PUT_SIGNED_INTEGER_OPERAND);

     2221     4603    2                OPERAND = ' ';

   4603 56 007670   040100 100400                    MLR     fill='040'O
        56 007671   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 007672   200064 000036                    ADSC9   OPERAND,,AUTO            cn=0,n=30

     2222     4604    2                CALL INSERT(OPERAND,

   4604 56 007673   000000 236000 1                  LDQ     LX_TOP
        56 007674   000006 402007                    MPY     6,DL
        56 007675   000001 471406 2                  LDP1    LX_STK+1,QL
        56 007676   100000 720100                    LXL0    0,,PR1
        56 007677   100000 235100                    LDA     0,,PR1
        56 007700   200276 740100                    STX0    CNT2+2,,AUTO
        56 007701   000000 531000                    NEG     0
        56 007702   200276 221100                    LDX1    CNT2+2,,AUTO
        56 007703   040145 100540                    MLR     fill='040'O
        56 007704   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
        56 007705   200073 400010                    ADSC9   OPERAND+7,A,AUTO         cn=2,n=*X0

     2223     4605    2                            (%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.LENGTH),,
     2224     4606    2                            LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2225     4607    2                IF SIGN_EXIST AND (LX_STK.DNTPTR(LX_TOP-1)->DNT.TEXT.NAME = '-') THEN

   4607 56 007706   001434 234000 52                 SZN     SIGN_EXIST
        56 007707   007732 605000 56                 TPL     s:4613
        56 007710   777773 473406 2                  LDP3    LX_STK-5,QL
        56 007711   300000 720100                    LXL0    0,,PR3
        56 007712   040000 106540                    CMPC    fill='040'O
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:313  
        56 007713   300001 000010                    ADSC9   1,,PR3                   cn=0,n=*X0
        56 007714   000024 000001 57                 ADSC9   20                       cn=0,n=1
        56 007715   007732 601000 56                 TNZ     s:4613

     2226     4608    3                  DO;

     2227     4609    3                    CALL CHARBIN(NUM,OPERAND);

   4609 56 007716   000100 305500                    DTB
        56 007717   200064 030036                    NDSC9   OPERAND,,AUTO            cn=0,s=nosgn,sf=0,n=30
        56 007720   200061 000004                    NDSC9   NUM,,AUTO                cn=0,s=lsgnf,sf=0,n=4

     2228     4610    3                    NUM = NUM * -1;

   4610 56 007721   200061 335100                    LCA     NUM,,AUTO
        56 007722   200061 755100                    STA     NUM,,AUTO

     2229     4611    3                    CALL BINCHAR(OPERAND,NUM_OUT.VAL);

   4611 56 007723   200061 236100                    LDQ     NUM,,AUTO
        56 007724   777777 376007                    ANQ     -1,DL
        56 007725   000000 235003                    LDA     0,DU
        56 007726   200276 757100                    STAQ    CNT2+2,,AUTO
        56 007727   000100 301500                    BTD
        56 007730   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 007731   200064 030036                    NDSC9   OPERAND,,AUTO            cn=0,s=nosgn,sf=0,n=30

     2230     4612    3                  END;

     2231     4613    2                SIGN_EXIST = %TRUE;

   4613 56 007732   400000 236003                    LDQ     -131072,DU
        56 007733   001434 756000 52                 STQ     SIGN_EXIST

     2232     4614    2                CALL PUT_OPERAND(OPERAND);

   4614 56 007734   200064 631500                    EPPR1   OPERAND,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:314  
        56 007735   200241 451500                    STP1    SHIFT_FACTOR+3,,AUTO
        56 007736   001677 701000 56                 TSX1    PUT_OPERAND
        56 007737   000000 011000                    NOP     0
        56 007740   010577 710000 56                 TRA     s:4749

     2233     4615
     2234     4616    2          CASE(%PUT_ZERO_OPERAND);

     2235     4617    2              OPERAND = ZILCH;

   4617 56 007741   040100 100400                    MLR     fill='040'O
        56 007742   001233 000036 55                 ADSC9   667                      cn=0,n=30
        56 007743   200064 000036                    ADSC9   OPERAND,,AUTO            cn=0,n=30

     2236     4618    2              CALL PUT_OPERAND(OPERAND);

   4618 56 007744   200064 631500                    EPPR1   OPERAND,,AUTO
        56 007745   200241 451500                    STP1    SHIFT_FACTOR+3,,AUTO
        56 007746   001677 701000 56                 TSX1    PUT_OPERAND
        56 007747   000000 011000                    NOP     0
        56 007750   010577 710000 56                 TRA     s:4749

     2237     4619
     2238     4620    2           CASE(%AHEAD_OT_POS1);

     2239     4621    2               IF NOT TABLE_DEF_OUT THEN

   4621 56 007751   001416 234000 52                 SZN     TABLE_DEF_OUT
        56 007752   007755 604000 56                 TMI     s:4623

     2240     4622    2                 CALL SET_UP_TABLE;

   4622 56 007753   000043 701000 56                 TSX1    SET_UP_TABLE
        56 007754   000000 011000                    NOP     0

     2241     4623    2               AHEAD_OT_POS = CURRENT_OT_POS + 1;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:315  
   4623 56 007755   000000 235000 53                 LDA     CURRENT_OT_POS
        56 007756   000001 035007                    ADLA    1,DL
        56 007757   000000 755000 54                 STA     AHEAD_OT_POS

     2242     4624    2               P_CODE.TWO_WORDS = %FALSE;

   4624 56 007760   000063 236000 57                 LDQ     51
        56 007761   001444 356000 52                 ANSQ    P_CODE+4
        56 007762   010577 710000 56                 TRA     s:4749

     2243     4625
     2244     4626    2           CASE(%AHEAD_OT_POS2);

     2245     4627    2               IF NOT TABLE_DEF_OUT THEN

   4627 56 007763   001416 234000 52                 SZN     TABLE_DEF_OUT
        56 007764   007767 604000 56                 TMI     s:4629

     2246     4628    2                 CALL SET_UP_TABLE;

   4628 56 007765   000043 701000 56                 TSX1    SET_UP_TABLE
        56 007766   000000 011000                    NOP     0

     2247     4629    2               AHEAD_OT_POS = CURRENT_OT_POS + 2;

   4629 56 007767   000000 235000 53                 LDA     CURRENT_OT_POS
        56 007770   000002 035007                    ADLA    2,DL
        56 007771   000000 755000 54                 STA     AHEAD_OT_POS

     2248     4630    2               P_CODE.TWO_WORDS = %TRUE;

   4630 56 007772   400000 236003                    LDQ     -131072,DU
        56 007773   001444 256000 52                 ORSQ    P_CODE+4
        56 007774   010577 710000 56                 TRA     s:4749

     2249     4631
     2250     4632    2           CASE(%PUT_MODFIELD);
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:316  

     2251     4633    2               IF LX_STK.DNTPTR(LX_TOP - 7)->DNT.TEXT.NAME = '1' THEN

   4633 56 007775   000000 236000 1                  LDQ     LX_TOP
        56 007776   000006 402007                    MPY     6,DL
        56 007777   777727 471406 2                  LDP1    LX_STK-41,QL
        56 010000   100000 720100                    LXL0    0,,PR1
        56 010001   040000 106540                    CMPC    fill='040'O
        56 010002   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 010003   000035 000001 57                 ADSC9   29                       cn=0,n=1
        56 010004   010015 601000 56                 TNZ     s:4635

     2252     4634    2                 MODFIELDS.ARI(MODFIELD_CNT) = '100'B;

   4634 56 010005   001430 236000 52                 LDQ     MODFIELD_CNT
        56 010006   000055 402007                    MPY     45,DL
        56 010007   000000 116003                    CMPQ    0,DU
        56 010010   010012 605000 56                 TPL     s:4634+5
        56 010011   000044 036003                    ADLQ    36,DU
        56 010012   003006 060400                    CSL     bolr='003'O
        56 010013   000036 000003 57                 BDSC    30                       by=0,bit=0,n=3
        56 010014   001424 000003 52                 BDSC    MODFIELDS,Q              by=0,bit=0,n=3

     2253     4635    2               IF LX_STK.DNTPTR(LX_TOP - 5)->DNT.TEXT.NAME = '1' THEN

   4635 56 010015   000000 236000 1                  LDQ     LX_TOP
        56 010016   000006 402007                    MPY     6,DL
        56 010017   777743 471406 2                  LDP1    LX_STK-29,QL
        56 010020   100000 720100                    LXL0    0,,PR1
        56 010021   040000 106540                    CMPC    fill='040'O
        56 010022   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 010023   000035 000001 57                 ADSC9   29                       cn=0,n=1
        56 010024   010050 601000 56                 TNZ     s:4637

     2254     4636    2                 MODFIELDS.ARI(MODFIELD_CNT) = MODFIELDS.ARI(MODFIELD_CNT) | '010'B;

   4636 56 010025   001430 236000 52                 LDQ     MODFIELD_CNT
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:317  
        56 010026   000055 402007                    MPY     45,DL
        56 010027   000000 116003                    CMPQ    0,DU
        56 010030   010032 605000 56                 TPL     s:4636+5
        56 010031   000044 036003                    ADLQ    36,DU
        56 010032   003100 060406                    CSL     bolr='003'O
        56 010033   001424 000003 52                 BDSC    MODFIELDS,Q              by=0,bit=0,n=3
        56 010034   200276 000044                    BDSC    CNT2+2,,AUTO             by=0,bit=0,n=36
        56 010035   200276 236100                    LDQ     CNT2+2,,AUTO
        56 010036   200000 276003                    ORQ     65536,DU
        56 010037   200277 756100                    STQ     CNT2+3,,AUTO
        56 010040   001430 236000 52                 LDQ     MODFIELD_CNT
        56 010041   000055 402007                    MPY     45,DL
        56 010042   000000 116003                    CMPQ    0,DU
        56 010043   010045 605000 56                 TPL     s:4636+16
        56 010044   000044 036003                    ADLQ    36,DU
        56 010045   003006 060500                    CSL     bolr='003'O
        56 010046   200277 000044                    BDSC    CNT2+3,,AUTO             by=0,bit=0,n=36
        56 010047   001424 000003 52                 BDSC    MODFIELDS,Q              by=0,bit=0,n=3

     2255     4637    2               IF LX_STK.DNTPTR(LX_TOP - 3)->DNT.TEXT.NAME = '1' THEN

   4637 56 010050   000000 236000 1                  LDQ     LX_TOP
        56 010051   000006 402007                    MPY     6,DL
        56 010052   777757 471406 2                  LDP1    LX_STK-17,QL
        56 010053   100000 720100                    LXL0    0,,PR1
        56 010054   040000 106540                    CMPC    fill='040'O
        56 010055   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 010056   000035 000001 57                 ADSC9   29                       cn=0,n=1
        56 010057   010103 601000 56                 TNZ     s:4639

     2256     4638    2                 MODFIELDS.ARI(MODFIELD_CNT) = MODFIELDS.ARI(MODFIELD_CNT) | '001'B;

   4638 56 010060   001430 236000 52                 LDQ     MODFIELD_CNT
        56 010061   000055 402007                    MPY     45,DL
        56 010062   000000 116003                    CMPQ    0,DU
        56 010063   010065 605000 56                 TPL     s:4638+5
        56 010064   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:318  
        56 010065   003100 060406                    CSL     bolr='003'O
        56 010066   001424 000003 52                 BDSC    MODFIELDS,Q              by=0,bit=0,n=3
        56 010067   200276 000044                    BDSC    CNT2+2,,AUTO             by=0,bit=0,n=36
        56 010070   200276 236100                    LDQ     CNT2+2,,AUTO
        56 010071   100000 276003                    ORQ     32768,DU
        56 010072   200277 756100                    STQ     CNT2+3,,AUTO
        56 010073   001430 236000 52                 LDQ     MODFIELD_CNT
        56 010074   000055 402007                    MPY     45,DL
        56 010075   000000 116003                    CMPQ    0,DU
        56 010076   010100 605000 56                 TPL     s:4638+16
        56 010077   000044 036003                    ADLQ    36,DU
        56 010100   003006 060500                    CSL     bolr='003'O
        56 010101   200277 000044                    BDSC    CNT2+3,,AUTO             by=0,bit=0,n=36
        56 010102   001424 000003 52                 BDSC    MODFIELDS,Q              by=0,bit=0,n=3

     2257     4639    2               MODFIELDS.RNREG(MODFIELD_CNT) = LX_STK.DNTPTR(LX_TOP - 1)-> DNT.TEXT.
              4639                        NAME;

   4639 56 010103   000000 236000 1                  LDQ     LX_TOP
        56 010104   000006 402007                    MPY     6,DL
        56 010105   777773 471406 2                  LDP1    LX_STK-5,QL
        56 010106   100000 720100                    LXL0    0,,PR1
        56 010107   001430 236000 52                 LDQ     MODFIELD_CNT
        56 010110   000005 402007                    MPY     5,DL
        56 010111   040006 100540                    MLR     fill='040'O
        56 010112   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 010113   001424 200003 52                 ADSC9   MODFIELDS,Q              cn=1,n=3

     2258     4640    2               MODFIELDS.EXISTS(MODFIELD_CNT) = %TRUE;

   4640 56 010114   001430 236000 52                 LDQ     MODFIELD_CNT
        56 010115   000055 402007                    MPY     45,DL
        56 010116   000000 116003                    CMPQ    0,DU
        56 010117   010121 605000 56                 TPL     s:4640+5
        56 010120   000044 036003                    ADLQ    36,DU
        56 010121   003006 060400                    CSL     bolr='003'O
        56 010122   000036 000001 57                 BDSC    30                       by=0,bit=0,n=1
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:319  
        56 010123   001425 000001 52                 BDSC    MODFIELDS+1,Q            by=0,bit=0,n=1

     2259     4641    2               MODFIELD_CNT = MODFIELD_CNT + 1;

   4641 56 010124   001430 054000 52                 AOS     MODFIELD_CNT
        56 010125   010577 710000 56                 TRA     s:4749

     2260     4642
     2261     4643    2           CASE(%PUT_BASE_SPECIFIER);

     2262     4644    2               VFD_BASE_SPECIFIER = LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME;

   4644 56 010126   000000 236000 1                  LDQ     LX_TOP
        56 010127   000006 402007                    MPY     6,DL
        56 010130   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010131   100000 720100                    LXL0    0,,PR1
        56 010132   040000 100540                    MLR     fill='040'O
        56 010133   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
        56 010134   001437 000001 52                 ADSC9   VFD_BASE_SPECIFIER       cn=0,n=1
        56 010135   010577 710000 56                 TRA     s:4749

     2263     4645
     2264     4646    2           CASE(%LOAD_VFD_FIELD);

     2265     4647    2               CHAR_NUM = ' ';

   4647 56 010136   040100 100400                    MLR     fill='040'O
        56 010137   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 010140   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30

     2266     4648    2               IF VFD_BASE_SPECIFIER = 'D' THEN

   4648 56 010141   001437 236000 52                 LDQ     VFD_BASE_SPECIFIER
        56 010142   777000 376003                    ANQ     -512,DU
        56 010143   104000 116003                    CMPQ    34816,DU
        56 010144   010157 601000 56                 TNZ     s:4652

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:320  
     2267     4649    2                 CALL CHARBIN(VFD_NUM,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);

   4649 56 010145   000000 236000 1                  LDQ     LX_TOP
        56 010146   000006 402007                    MPY     6,DL
        56 010147   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010150   100000 720100                    LXL0    0,,PR1
        56 010151   000100 305540                    DTB
        56 010152   100001 030010                    NDSC9   1,,PR1                   cn=0,s=nosgn,sf=0,n=*X0
        56 010153   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 010154   200277 235100                    LDA     CNT2+3,,AUTO
        56 010155   200234 755100                    STA     VFD_NUM,,AUTO
        56 010156   010200 710000 56                 TRA     s:4656

     2268     4650    2               ELSE
     2269     4651    3                 DO;

     2270     4652    3                  CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT
              4652                            .LENGTH),,

   4652 56 010157   000000 236000 1                  LDQ     LX_TOP
        56 010160   000006 402007                    MPY     6,DL
        56 010161   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010162   100000 720100                    LXL0    0,,PR1
        56 010163   100000 235100                    LDA     0,,PR1
        56 010164   200276 740100                    STX0    CNT2+2,,AUTO
        56 010165   000000 531000                    NEG     0
        56 010166   200276 221100                    LDX1    CNT2+2,,AUTO
        56 010167   040145 100540                    MLR     fill='040'O
        56 010170   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
        56 010171   200060 400010                    ADSC9   CHAR_NUM+7,A,AUTO        cn=2,n=*X0

     2271     4653    3                             LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2272     4654    3                   CALL OCTBIN(VFD_NUM,CHAR_NUM);

   4654 56 010172   200051 633500                    EPPR3   CHAR_NUM,,AUTO
        56 010173   200272 453500                    STP3    @GOAL+1,,AUTO
        56 010174   200234 634500                    EPPR4   VFD_NUM,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:321  
        56 010175   200271 454500                    STP4    @OPN+1,,AUTO
        56 010176   001723 701000 56                 TSX1    OCTBIN
        56 010177   000000 011000                    NOP     0

     2273     4655    3                 END;

     2274     4656    2               CALL CHARBIN(VFD_LENGTH,LX_STK.DNTPTR(LX_TOP - 2)->DNT.TEXT.NAME);

   4656 56 010200   000000 236000 1                  LDQ     LX_TOP
        56 010201   000006 402007                    MPY     6,DL
        56 010202   777765 470406 2                  LDP0    LX_STK-11,QL
        56 010203   000000 720100                    LXL0    0,,PR0
        56 010204   000100 305540                    DTB
        56 010205   000001 030010                    NDSC9   1,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
        56 010206   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 010207   200277 235100                    LDA     CNT2+3,,AUTO
        56 010210   200235 755100                    STA     VFD_LENGTH,,AUTO

     2275     4657    2               VFD_ACC_POS = VFD_ACC_POS - VFD_LENGTH;

   4657 56 010211   001436 236000 52                 LDQ     VFD_ACC_POS
        56 010212   200235 136100                    SBLQ    VFD_LENGTH,,AUTO
        56 010213   001436 756000 52                 STQ     VFD_ACC_POS

     2276     4658    2               CALL GET_SHIFT_FACTOR(SHIFT_FACTOR,VFD_ACC_POS);

   4658 56 010214   000064 236000 57                 LDQ     52
        56 010215   200242 756100                    STQ     NUM+1,,AUTO
        56 010216   200236 630500                    EPPR0   SHIFT_FACTOR,,AUTO
        56 010217   200241 450500                    STP0    SHIFT_FACTOR+3,,AUTO
        56 010220   006140 701000 56                 TSX1    GET_SHIFT_FACTOR
        56 010221   000000 011000                    NOP     0

     2277     4659    2               VFD_NUM = VFD_NUM * SHIFT_FACTOR;

   4659 56 010222   200234 236100                    LDQ     VFD_NUM,,AUTO
        56 010223   200236 402100                    MPY     SHIFT_FACTOR,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:322  
        56 010224   200234 756100                    STQ     VFD_NUM,,AUTO

     2278     4660    2               VFD_ACC = VFD_ACC | BINBIT(VFD_NUM,36);

   4660 56 010225   200234 236100                    LDQ     VFD_NUM,,AUTO
        56 010226   001435 276000 52                 ORQ     VFD_ACC
        56 010227   001435 756000 52                 STQ     VFD_ACC

     2279     4661    2               VFD_BASE_SPECIFIER = 'D';

   4661 56 010230   104000 236003                    LDQ     34816,DU
        56 010231   001437 756000 52                 STQ     VFD_BASE_SPECIFIER
        56 010232   010577 710000 56                 TRA     s:4749

     2280     4662
     2281     4663
     2282     4664    2           CASE(%PUT_YFIELD_ARITH);

     2283     4665    2                CALL HANDLE_ARITH_EXP(CHAR_NUM,%OPERAND_LEN);

   4665 56 010233   000021 236000 57                 LDQ     17
        56 010234   200242 756100                    STQ     NUM+1,,AUTO
        56 010235   200051 631500                    EPPR1   CHAR_NUM,,AUTO
        56 010236   200241 451500                    STP1    SHIFT_FACTOR+3,,AUTO
        56 010237   001600 701000 56                 TSX1    HANDLE_ARITH_EXP
        56 010240   000000 011000                    NOP     0

     2284     4666    2                CALL CHARBIN(VFD_WORD,CHAR_NUM);

   4666 56 010241   000100 305500                    DTB
        56 010242   200051 030036                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=30
        56 010243   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 010244   200277 235100                    LDA     CNT2+3,,AUTO
        56 010245   200232 755100                    STA     VFD_WORD,,AUTO

     2285     4667    2                YFIELD = VFD_OUT.LOWER;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:323  
   4667 56 010246   200232 720100                    LXL0    VFD_WORD,,AUTO
        56 010247   001421 740000 52                 STX0    YFIELD
        56 010250   010577 710000 56                 TRA     s:4749

     2286     4668
     2287     4669    2           CASE(%HANDLE_EQU_INT);

     2288     4670    2               CALL  CHARBIN(NUM,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);

   4670 56 010251   000000 236000 1                  LDQ     LX_TOP
        56 010252   000006 402007                    MPY     6,DL
        56 010253   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010254   100000 720100                    LXL0    0,,PR1
        56 010255   000100 305540                    DTB
        56 010256   100001 030010                    NDSC9   1,,PR1                   cn=0,s=nosgn,sf=0,n=*X0
        56 010257   200061 000004                    NDSC9   NUM,,AUTO                cn=0,s=lsgnf,sf=0,n=4

     2289     4671    2               CALL EQU_INT(NUM,LABEL_POS);

   4671 56 010260   000061 236000 57                 LDQ     49
        56 010261   200242 756100                    STQ     NUM+1,,AUTO
        56 010262   200061 631500                    EPPR1   NUM,,AUTO
        56 010263   200241 451500                    STP1    SHIFT_FACTOR+3,,AUTO
        56 010264   000756 701000 56                 TSX1    EQU_INT
        56 010265   000000 011000                    NOP     0
        56 010266   010577 710000 56                 TRA     s:4749

     2290     4672
     2291     4673    2           CASE(%HANDLE_EQU_LABEL);

     2292     4674    2               CALL EQU_LABEL(LABEL_POS,PREVIOUS_LABEL_POS);

   4674 56 010267   000065 236000 57                 LDQ     53
        56 010270   200242 756100                    STQ     NUM+1,,AUTO
        56 010271   000061 236000 57                 LDQ     49
        56 010272   200241 756100                    STQ     SHIFT_FACTOR+3,,AUTO
        56 010273   000766 701000 56                 TSX1    EQU_LABEL
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:324  
        56 010274   000000 011000                    NOP     0
        56 010275   010577 710000 56                 TRA     s:4749

     2293     4675
     2294     4676    2           CASE(%PUT_DECIMAL_LITERAL);

     2295     4677    2               CALL CHARBIN(NUM,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);

   4677 56 010276   000000 236000 1                  LDQ     LX_TOP
        56 010277   000006 402007                    MPY     6,DL
        56 010300   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010301   100000 720100                    LXL0    0,,PR1
        56 010302   000100 305540                    DTB
        56 010303   100001 030010                    NDSC9   1,,PR1                   cn=0,s=nosgn,sf=0,n=*X0
        56 010304   200061 000004                    NDSC9   NUM,,AUTO                cn=0,s=lsgnf,sf=0,n=4

     2296     4678    2               IF SIGN_EXIST THEN

   4678 56 010305   001434 234000 52                 SZN     SIGN_EXIST
        56 010306   010317 605000 56                 TPL     s:4681

     2297     4679    2                 IF LX_STK.DNTPTR(LX_TOP -1)->DNT.TEXT.NAME = '-' THEN

   4679 56 010307   777773 473406 2                  LDP3    LX_STK-5,QL
        56 010310   300000 720100                    LXL0    0,,PR3
        56 010311   040000 106540                    CMPC    fill='040'O
        56 010312   300001 000010                    ADSC9   1,,PR3                   cn=0,n=*X0
        56 010313   000024 000001 57                 ADSC9   20                       cn=0,n=1
        56 010314   010317 601000 56                 TNZ     s:4681

     2298     4680    2                   NUM = NUM * -1;

   4680 56 010315   200061 335100                    LCA     NUM,,AUTO
        56 010316   200061 755100                    STA     NUM,,AUTO

     2299     4681    2               SIGN_EXIST = %TRUE;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:325  
   4681 56 010317   400000 236003                    LDQ     -131072,DU
        56 010320   001434 756000 52                 STQ     SIGN_EXIST

     2300     4682    2               VFD_WORD = NUM;

   4682 56 010321   200061 235100                    LDA     NUM,,AUTO
        56 010322   200232 755100                    STA     VFD_WORD,,AUTO

     2301     4683    2               YFIELD = VFD_OUT.LOWER;

   4683 56 010323   200232 720100                    LXL0    VFD_WORD,,AUTO
        56 010324   001421 740000 52                 STX0    YFIELD
        56 010325   010577 710000 56                 TRA     s:4749

     2302     4684
     2303     4685    2           CASE(%PUT_UNSIGNED_DECIMAL_LITERAL);

     2304     4686    2               CALL CHARBIN(NUM,LX_STK.DNTPTR(LX_TOP-1)->DNT.TEXT.NAME);

   4686 56 010326   000000 236000 1                  LDQ     LX_TOP
        56 010327   000006 402007                    MPY     6,DL
        56 010330   777773 471406 2                  LDP1    LX_STK-5,QL
        56 010331   100000 720100                    LXL0    0,,PR1
        56 010332   000100 305540                    DTB
        56 010333   100001 030010                    NDSC9   1,,PR1                   cn=0,s=nosgn,sf=0,n=*X0
        56 010334   200061 000004                    NDSC9   NUM,,AUTO                cn=0,s=lsgnf,sf=0,n=4

     2305     4687    2               SIGN_EXIST = %TRUE;

   4687 56 010335   400000 236003                    LDQ     -131072,DU
        56 010336   001434 756000 52                 STQ     SIGN_EXIST

     2306     4688    2               VFD_WORD = NUM;

   4688 56 010337   200061 235100                    LDA     NUM,,AUTO
        56 010340   200232 755100                    STA     VFD_WORD,,AUTO

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:326  
     2307     4689    2               YFIELD = VFD_OUT.LOWER;

   4689 56 010341   200232 720100                    LXL0    VFD_WORD,,AUTO
        56 010342   001421 740000 52                 STX0    YFIELD
        56 010343   010577 710000 56                 TRA     s:4749

     2308     4690
     2309     4691    2           CASE(%PUT_OCTAL_LITERAL);

     2310     4692    2               CHAR_NUM = ' ';

   4692 56 010344   040100 100400                    MLR     fill='040'O
        56 010345   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 010346   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30

     2311     4693    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4693                        LENGTH)

   4693 56 010347   000000 236000 1                  LDQ     LX_TOP
        56 010350   000006 402007                    MPY     6,DL
        56 010351   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010352   100000 720100                    LXL0    0,,PR1
        56 010353   100000 235100                    LDA     0,,PR1
        56 010354   200276 740100                    STX0    CNT2+2,,AUTO
        56 010355   000000 531000                    NEG     0
        56 010356   200276 221100                    LDX1    CNT2+2,,AUTO
        56 010357   040145 100540                    MLR     fill='040'O
        56 010360   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
        56 010361   200060 400010                    ADSC9   CHAR_NUM+7,A,AUTO        cn=2,n=*X0

     2312     4694    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2313     4695    2               CALL OCTBIN(NUM,CHAR_NUM);

   4695 56 010362   200051 633500                    EPPR3   CHAR_NUM,,AUTO
        56 010363   200272 453500                    STP3    @GOAL+1,,AUTO
        56 010364   200061 634500                    EPPR4   NUM,,AUTO
        56 010365   200271 454500                    STP4    @OPN+1,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:327  
        56 010366   001723 701000 56                 TSX1    OCTBIN
        56 010367   000000 011000                    NOP     0

     2314     4696    2               IF SIGN_EXIST THEN

   4696 56 010370   001434 234000 52                 SZN     SIGN_EXIST
        56 010371   010404 605000 56                 TPL     s:4699

     2315     4697    2                 IF LX_STK.DNTPTR(LX_TOP -1)->DNT.TEXT.NAME = '-' THEN

   4697 56 010372   000000 236000 1                  LDQ     LX_TOP
        56 010373   000006 402007                    MPY     6,DL
        56 010374   777773 470406 2                  LDP0    LX_STK-5,QL
        56 010375   000000 720100                    LXL0    0,,PR0
        56 010376   040000 106540                    CMPC    fill='040'O
        56 010377   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        56 010400   000024 000001 57                 ADSC9   20                       cn=0,n=1
        56 010401   010404 601000 56                 TNZ     s:4699

     2316     4698    2                   NUM = NUM * -1;

   4698 56 010402   200061 335100                    LCA     NUM,,AUTO
        56 010403   200061 755100                    STA     NUM,,AUTO

     2317     4699    2               SIGN_EXIST = %TRUE;

   4699 56 010404   400000 236003                    LDQ     -131072,DU
        56 010405   001434 756000 52                 STQ     SIGN_EXIST

     2318     4700    2               VFD_WORD = NUM;

   4700 56 010406   200061 235100                    LDA     NUM,,AUTO
        56 010407   200232 755100                    STA     VFD_WORD,,AUTO

     2319     4701    2               YFIELD = VFD_OUT.LOWER;

   4701 56 010410   200232 720100                    LXL0    VFD_WORD,,AUTO
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:328  
        56 010411   001421 740000 52                 STX0    YFIELD
        56 010412   010577 710000 56                 TRA     s:4749

     2320     4702
     2321     4703    2           CASE(%PUT_NULL_MODFIELD);

     2322     4704    2                MODFIELDS.EXISTS(MODFIELD_CNT) = %TRUE;

   4704 56 010413   001430 236000 52                 LDQ     MODFIELD_CNT
        56 010414   000055 402007                    MPY     45,DL
        56 010415   000000 116003                    CMPQ    0,DU
        56 010416   010420 605000 56                 TPL     s:4704+5
        56 010417   000044 036003                    ADLQ    36,DU
        56 010420   003006 060400                    CSL     bolr='003'O
        56 010421   000036 000001 57                 BDSC    30                       by=0,bit=0,n=1
        56 010422   001425 000001 52                 BDSC    MODFIELDS+1,Q            by=0,bit=0,n=1

     2323     4705    2                MODFIELD_CNT = MODFIELD_CNT + 1;

   4705 56 010423   001430 054000 52                 AOS     MODFIELD_CNT
        56 010424   010577 710000 56                 TRA     s:4749

     2324     4706
     2325     4707    2           CASE(%CLEAR_SIGN_FLAG);

     2326     4708    2               SIGN_EXIST = %FALSE;

   4708 56 010425   001434 450000 52                 STZ     SIGN_EXIST
        56 010426   010577 710000 56                 TRA     s:4749

     2327     4709
     2328     4710    2           CASE(%SET_EIS_OP1);

     2329     4711    2               CHAR_NUM = ' ';

   4711 56 010427   040100 100400                    MLR     fill='040'O
        56 010430   000001 000001 57                 ADSC9   1                        cn=0,n=1
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:329  
        56 010431   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30

     2330     4712    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4712                        LENGTH)

   4712 56 010432   000000 236000 1                  LDQ     LX_TOP
        56 010433   000006 402007                    MPY     6,DL
        56 010434   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010435   100000 720100                    LXL0    0,,PR1
        56 010436   100000 235100                    LDA     0,,PR1
        56 010437   200276 740100                    STX0    CNT2+2,,AUTO
        56 010440   000000 531000                    NEG     0
        56 010441   200276 221100                    LDX1    CNT2+2,,AUTO
        56 010442   040145 100540                    MLR     fill='040'O
        56 010443   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
        56 010444   200060 400010                    ADSC9   CHAR_NUM+7,A,AUTO        cn=2,n=*X0

     2331     4713    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2332     4714    2               CALL OCTBIN(OPTIONAL_FIELDS(0),CHAR_NUM);

   4714 56 010445   200051 633500                    EPPR3   CHAR_NUM,,AUTO
        56 010446   200272 453500                    STP3    @GOAL+1,,AUTO
        56 010447   000042 236000 57                 LDQ     34
        56 010450   200271 756100                    STQ     @OPN+1,,AUTO
        56 010451   001723 701000 56                 TSX1    OCTBIN
        56 010452   000000 011000                    NOP     0
        56 010453   010577 710000 56                 TRA     s:4749

     2333     4715
     2334     4716    2           CASE(%SET_EIS_OP2);

     2335     4717    2               CHAR_NUM = ' ';

   4717 56 010454   040100 100400                    MLR     fill='040'O
        56 010455   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 010456   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:330  
     2336     4718    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4718                        LENGTH)

   4718 56 010457   000000 236000 1                  LDQ     LX_TOP
        56 010460   000006 402007                    MPY     6,DL
        56 010461   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010462   100000 720100                    LXL0    0,,PR1
        56 010463   100000 235100                    LDA     0,,PR1
        56 010464   200276 740100                    STX0    CNT2+2,,AUTO
        56 010465   000000 531000                    NEG     0
        56 010466   200276 221100                    LDX1    CNT2+2,,AUTO
        56 010467   040145 100540                    MLR     fill='040'O
        56 010470   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
        56 010471   200060 400010                    ADSC9   CHAR_NUM+7,A,AUTO        cn=2,n=*X0

     2337     4719    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2338     4720    2               CALL OCTBIN(OPTIONAL_FIELDS(1),CHAR_NUM);

   4720 56 010472   200051 633500                    EPPR3   CHAR_NUM,,AUTO
        56 010473   200272 453500                    STP3    @GOAL+1,,AUTO
        56 010474   000066 236000 57                 LDQ     54
        56 010475   200271 756100                    STQ     @OPN+1,,AUTO
        56 010476   001723 701000 56                 TSX1    OCTBIN
        56 010477   000000 011000                    NOP     0
        56 010500   010577 710000 56                 TRA     s:4749

     2339     4721
     2340     4722    2           CASE(%SET_EIS_OP3);

     2341     4723    2               CHAR_NUM = ' ';

   4723 56 010501   040100 100400                    MLR     fill='040'O
        56 010502   000001 000001 57                 ADSC9   1                        cn=0,n=1
        56 010503   200051 000036                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=30

     2342     4724    2               CALL INSERT(CHAR_NUM,(%OPERAND_LEN - LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.
              4724                        LENGTH)
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:331  

   4724 56 010504   000000 236000 1                  LDQ     LX_TOP
        56 010505   000006 402007                    MPY     6,DL
        56 010506   000001 471406 2                  LDP1    LX_STK+1,QL
        56 010507   100000 720100                    LXL0    0,,PR1
        56 010510   100000 235100                    LDA     0,,PR1
        56 010511   200276 740100                    STX0    CNT2+2,,AUTO
        56 010512   000000 531000                    NEG     0
        56 010513   200276 221100                    LDX1    CNT2+2,,AUTO
        56 010514   040145 100540                    MLR     fill='040'O
        56 010515   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
        56 010516   200060 400010                    ADSC9   CHAR_NUM+7,A,AUTO        cn=2,n=*X0

     2343     4725    2                     ,,LX_STK.DNTPTR(LX_TOP)->DNT.TEXT.NAME);
     2344     4726    2               CALL OCTBIN(OPTIONAL_FIELDS(2),CHAR_NUM);

   4726 56 010517   200051 633500                    EPPR3   CHAR_NUM,,AUTO
        56 010520   200272 453500                    STP3    @GOAL+1,,AUTO
        56 010521   000067 236000 57                 LDQ     55
        56 010522   200271 756100                    STQ     @OPN+1,,AUTO
        56 010523   001723 701000 56                 TSX1    OCTBIN
        56 010524   000000 011000                    NOP     0
        56 010525   010577 710000 56                 TRA     s:4749

     2345     4727
     2346     4728    2           CASE(%EJECT_A_PAGE);

     2347     4729    2               IF OPTIONS(LS_OPT) THEN

   4729 56 010526   000000 234000 34                 SZN     OPTIONS
        56 010527   010577 605000 56                 TPL     s:4749

     2348     4730    3                 DO;

     2349     4731    3                   CALL EJECT_PAGE;

   4731 56 010530   000002 631400 57                 EPPR1   2
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:332  
        56 010531   000000 701000 xent               TSX1    EJECT_PAGE
        56 010532   000000 011000                    NOP     0

     2350     4732    3                   CALL OUTPUT_HEADER;

   4732 56 010533   000002 631400 57                 EPPR1   2
        56 010534   000000 701000 xent               TSX1    OUTPUT_HEADER
        56 010535   000000 011000                    NOP     0

     2351     4733    3                 END;

   4733 56 010536   010577 710000 56                 TRA     s:4749

     2352     4734
     2353     4735    2           CASE(%SKIP_PL6);

     2354     4736    2              CALL HANDLE_PL6;

   4736 56 010537   006164 701000 56                 TSX1    HANDLE_PL6
        56 010540   000000 011000                    NOP     0
        56 010541   010577 710000 56                 TRA     s:4749

     2355     4737
     2356     4738    2           CASE(%PUT_BURST);

     2357     4739    2               CALL BINCHAR(DEST_CHAR,UNIQUE_NUM);

   4739 56 010542   001361 236000 52                 LDQ     UNIQUE_NUM
        56 010543   000000 235003                    LDA     0,DU
        56 010544   200276 757100                    STAQ    CNT2+2,,AUTO
        56 010545   000100 301500                    BTD
        56 010546   200276 000010                    NDSC9   CNT2+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        56 010547   200062 030010                    NDSC9   DEST_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=8

     2358     4740    2               UNIQUE_NUM = UNIQUE_NUM + 1;

   4740 56 010550   001361 236000 52                 LDQ     UNIQUE_NUM
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:333  
        56 010551   000001 036007                    ADLQ    1,DL
        56 010552   001361 756000 52                 STQ     UNIQUE_NUM

     2359     4741    2               CALL PUT_BURST_DEST(DEST_CHAR);

   4741 56 010553   200062 631500                    EPPR1   DEST_CHAR,,AUTO
        56 010554   200241 451500                    STP1    SHIFT_FACTOR+3,,AUTO
        56 010555   000717 701000 56                 TSX1    PUT_BURST_DEST
        56 010556   000000 011000                    NOP     0

     2360     4742    2               CALL CONCAT(P_CODE.OPERAND(OPCNT),'%D',DEST_CHAR);

   4742 56 010557   001522 236000 52                 LDQ     OPCNT
        56 010560   000036 402007                    MPY     30,DL
        56 010561   040006 100400                    MLR     fill='040'O
        56 010562   001231 000002 55                 ADSC9   665                      cn=0,n=2
        56 010563   001444 200002 52                 ADSC9   P_CODE+4,Q               cn=1,n=2
        56 010564   040006 100500                    MLR     fill='040'O
        56 010565   200062 000010                    ADSC9   DEST_CHAR,,AUTO          cn=0,n=8
        56 010566   001444 600034 52                 ADSC9   P_CODE+4,Q               cn=3,n=28

     2361     4743    2               OPCNT = OPCNT + 1;

   4743 56 010567   001522 235000 52                 LDA     OPCNT
        56 010570   000001 035007                    ADLA    1,DL
        56 010571   001522 755000 52                 STA     OPCNT
        56 010572   010577 710000 56                 TRA     s:4749

     2362     4744
     2363     4745    2           CASE(ELSE);

     2364     4746    2               CALL Z8PA$ERROR_PROC(%MESS3);

   4746 56 010573   000070 630400 57                 EPPR0   56
        56 010574   000006 631400 57                 EPPR1   6
        56 010575   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        56 010576   000000 011000                    NOP     0
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:334  

     2365     4747    2      END;  /* CASE */

     2366     4748
     2367     4749    1        IF TRACE_OPT_ON THEN

   4749 56 010577   001360 234000 52                 SZN     TRACE_OPT_ON
        56 010600   010603 605000 56                 TPL     s:4752

     2368     4750    1          CALL TRACE;

   4750 56 010601   006264 701000 56                 TSX1    TRACE
        56 010602   000000 011000                    NOP     0

     2369     4751
     2370     4752    1    END Z8PA$SEMANTICS;

   4752 56 010603   000000 702200 xent               TSX2  ! X66_ARET
     2371     4753         %EOD;

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:335  
--  Include file information  --

   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_OPS_TBL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_ORDR_DEF.:Z8A6TOU  is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_PARS_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_P_STATE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_PARS_STK.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8PA$SEMANTICS.
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:336  

 **** Variables and constants ****

  ****  Section 000 LblCom LA_STK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(216)         1 LA_STK(0:50)

  ****  Section 001 LblCom LX_TOP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LX_TOP

  ****  Section 002 LblCom LX_STK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(216)   r     1 LX_STK(0:50)

  ****  Section 003 LblCom STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN(18)          1 STATE

  ****  Section 004 LblCom LA_CNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LA_CNT

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:337  
  ****  Section 005 LblCom LA_PUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LA_PUT

  ****  Section 006 LblCom LA_GET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LA_GET

  ****  Section 007 LblCom REDUCTION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 REDUCTION

  ****  Section 008 LblCom PARSE_STACK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PARSE_STACK(0:500)

  ****  Section 009 LblCom PARSE_STACK_IDX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN(18)          1 PARSE_STACK_IDX

  ****  Section 010 LblCom ERRLINE

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:338  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERRLINE

  ****  Section 011 LblCom ERRCOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERRCOL

  ****  Section 012 LblCom ERR_LA_GET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_LA_GET

  ****  Section 013 LblCom ERR_LA_PUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_LA_PUT

  ****  Section 014 LblCom ERR_LA_CNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_LA_CNT

  ****  Section 015 LblCom ERR_RECOVERY_IN_PROGRESS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:339  

     0-0-0/b BIT               1 ERR_RECOVERY_IN_PROGRESS

  ****  Section 016 LblCom PARSE_ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PARSE_ERROR_COUNT

  ****  Section 017 LblCom ALT_PARSE_STACK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ALT_PARSE_STACK(0:500)

  ****  Section 018 LblCom ALT_PARSE_STACK_IDX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ALT_PARSE_STACK_IDX

  ****  Section 019 LblCom RED_STACK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 RED_STACK(0:500)

  ****  Section 020 LblCom RED_STACK_TOP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 RED_STACK_TOP
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:340  

  ****  Section 021 LblCom IED_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IED_FLAG

  ****  Section 022 LblCom ALT_LX_TOP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ALT_LX_TOP

  ****  Section 023 LblCom CORRECTION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1890)        1 CORRECTION

  ****  Section 024 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OUT_DCBN

  ****  Section 025 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 026 LblCom SAVE_DCBN2
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:341  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_DCBN2

  ****  Section 033 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 034 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

  ****  Section 035 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 DO_REQ

  ****  Section 036 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 037 LblCom INSTR

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:342  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 INSTR(0:511)               0-0-0/c CHAR(512)   r     1 INSTRCHR

  ****  Section 038 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 INSTR_LISTED

  ****  Section 039 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_LEN

  ****  Section 040 LblCom INSTR_INDX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_INDX

  ****  Section 041 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 EOF_FLAG

  ****  Section 042 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:343  
     0-0-0/c CHAR(20)    r     1 KEY_REC

  ****  Section 043 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 044 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 045 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)   r     1 HEADER_LINE3

  ****  Section 046 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)   r     1 HEADER_LINE2

  ****  Section 047 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:344  
  ****  Section 048 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 049 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 050 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 PHASE

  ****  Section 051 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERROR_COUNT

  ****  Section 052  Data  Z8PA$SEMANTICS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1527-0-0/w PTR         r     1 CURRENT_BT_POS          1526-0-0/w PTR         r     1 CURRENT_DEP_POS
  1525-0-0/w PTR         r     1 CURRENT_PEPD_POS        1403-0-0/c CHAR(30)    r     1 LABEL_NAME
  1413-0-0/w PTR         r     1 LABEL_POS               1415-0-0/b BIT         r     1 LOCAL_FLAG
  1424-0-0/c STRC(37)    r     1 MODFIELDS(0:2)
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:345  
  1430-0-0/w SBIN        r     1 MODFIELD_CNT            1422-0-0/c CHAR(3)     r     1 MOD_TYPE
  1536-0-0/c STRC(12)    r     1 OCTVALS(0:8)
  1522-0-0/w UBIN        r     1 OPCNT                   1417-0-0/c CHAR(5)     r     1 OPCODE
     0-0-0/c STRC(54)    r     1 OPCODE_TABLE(0:500)
  1431-0-0/w UBIN        r     1 OPTIONAL_FIELDS(0:2)
  1414-0-0/w PTR         r     1 PREVIOUS_LABEL_POS      1362-0-0/c CHAR(30)    r     1 PROC_NAME
  1440-0-0/w STRC(1773)  r     1 P_CODE                  1524-0-0/w PTR         r     1 REF_POS
  1373-0-0/c CHAR(30)    r     1 SEGMENT_NAME            1372-0-0/w UBIN        r     1 SEGMENT_NUMBER
  1434-0-0/b BIT         r     1 SIGN_EXIST              1416-0-0/b BIT         r     1 TABLE_DEF_OUT
  1543-0-0/c STRC(45)    r     1 TAG_MOD_TABLE(0:28)
  1423-0-0/c CHAR(2)     r     1 TAG_TYPE                1532-0-0/w PTR         r     1 TOP_BURST_TABLE
  1531-0-0/w PTR         r     1 TOP_DEP                 1534-0-0/w PTR               1 TOP_FREE_LT
  1535-0-0/w PTR         r     1 TOP_FREE_RL             1523-0-0/w PTR         r     1 TOP_LABEL_TABLE
  1533-0-0/w PTR         r     1 TOP_LOCAL_LABEL_TABLE
  1530-0-0/w PTR         r     1 TOP_PEPD                1360-0-0/b BIT         r     1 TRACE_OPT_ON
  1361-0-0/w UBIN        r     1 UNIQUE_NUM              1435-0-0/b BIT         r     1 VFD_ACC
  1436-0-0/w SBIN        r     1 VFD_ACC_POS             1437-0-0/c CHAR        r     1 VFD_BASE_SPECIFIER
  1421-0-0/w UBIN(18)    r     1 YFIELD

  ****  Section 053 LblCom CURRENT_OT_POS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 CURRENT_OT_POS

  ****  Section 054 LblCom AHEAD_OT_POS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AHEAD_OT_POS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:346  

     3-0-0/w PTR         r     1 @A                       242-0-0/w PTR         r     1 @BIN_CHAR
   241-0-0/w PTR         r     1 @DEST                    242-0-0/w PTR         r     1 @DISTANCE
   243-0-0/w PTR         r     1 @FWBOT                   271-0-0/w PTR         r     1 @GOAL
   241-0-0/w PTR         r     1 @LABEL                   241-0-0/w PTR         r     1 @LABEL
   245-0-0/w PTR         r     1 @LABEL                   241-0-0/w PTR         r     1 @LABEL
   242-0-0/w PTR         r     1 @LABEL_POS               250-0-0/w PTR         r     1 @LEN
   242-0-0/w PTR         r     1 @LEN                     250-0-0/w PTR         r     1 @LOWER_HALF
   247-0-0/w PTR         r     1 @LOWER_HALF              243-0-0/w PTR         r     1 @MODFIELDS
   241-0-0/w PTR         r     1 @NUM                     272-0-0/w PTR         r     1 @OCTCHAR
   271-0-0/w PTR         r     1 @OCTNUM                  255-0-0/w PTR         r     1 @OPCODE
   243-0-0/w PTR         r     1 @OPCODE                  245-0-0/w PTR         r     1 @OPCODE
   256-0-0/w PTR         r     1 @OPCODE_VALUE            241-0-0/w PTR         r     1 @OPER
   270-0-0/w PTR         r     1 @OPN                     244-0-0/w PTR         r     1 @OPND1
   245-0-0/w PTR         r     1 @OPND2                   244-0-0/w PTR         r     1 @OPTIONAL_FIELDS
   267-0-0/w PTR         r     1 @P                       247-0-0/w PTR         r     1 @POS
   241-0-0/w PTR         r     1 @POS                     242-0-0/w PTR         r     1 @POS
   245-0-0/w PTR         r     1 @POS                     242-0-0/w PTR         r     1 @POS
   246-0-0/w PTR         r     1 @POS                     242-0-0/w PTR         r     1 @POS
   257-0-0/w PTR         r     1 @POS                     272-0-0/w PTR         r     1 @POSITION
   241-0-0/w PTR         r     1 @POS_IN_LT               241-0-0/w PTR         r     1 @POS_IN_LT
   242-0-0/w PTR         r     1 @RECIEVING_LABEL         241-0-0/w PTR         r     1 @RESULT
   241-0-0/w PTR         r     1 @SENDING_LABEL           241-0-0/w PTR         r     1 @SHIFT_FACTOR
   245-0-0/w PTR         r     1 @SWBOT                   244-0-0/w PTR         r     1 @SWTOP
   243-0-0/w PTR         r     1 @TABLE                   247-0-0/w PTR         r     1 @TABLE
   241-0-0/w PTR         r     1 @TABLE                   246-0-0/w PTR         r     1 @TAG_TYPE
   273-0-0/w PTR         r     1 @TAG_VAL                 242-0-0/w PTR         r     1 @TYPE
   247-0-0/w PTR         r     1 @UPPER_HALF              246-0-0/w PTR         r     1 @UPPER_HALF
   241-0-0/w PTR         r     1 @VAL                      *0-0-0/w SBIN        r     1 A
   265-0-0/w UBIN        r     1 BINRES                    *0-0-0/c CHAR(30)    r     1 BIN_CHAR
    *0-0-0/c CHAR        r     1 BIN_CHAR_T(0:29)
     5-0-0/c CHAR(140)   r     1 BUFFER                   257-0-0/w UBIN(6)     r     1 CD
    51-0-0/c CHAR(30)    r     1 CHAR_NUM                 243-0-0/c CHAR(30)          1 CHAR_NUM2
   241-0-0/w SBIN        r     1 CNT                      241-0-0/w PTR         r     1 CNT
   273-0-0/w SBIN        r     1 CNT                      243-0-0/w SBIN        r     1 CNT
   266-0-0/w SBIN        r     1 CNT                      241-0-0/w PTR         r     1 CNT
   243-0-0/w SBIN        r     1 CNT                      274-0-0/w SBIN        r     1 CNT2
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:347  
   242-0-0/w PTR         r     1 CNT2                     261-0-0/c CHAR(10)    r     1 CODE
    *0-0-0/c CHAR(8)     r     1 DEST                      62-0-0/c CHAR(8)     r     1 DEST_CHAR
    *0-0-0/w SBIN        r     1 DISTANCE                 100-0-0/c CHAR(120)   r     1 FWBOT
    *0-0-0/c CHAR(120)   r     1 FWBOT                     *0-0-0/c CHAR(3)     r     1 GOAL
   264-0-0/w SBIN              1 I                         *0-0-0/c CHAR(30)    r     1 LABEL
    *0-0-0/c CHAR(30)    r     1 LABEL                     *0-0-0/c CHAR(30)    r     1 LABEL
    *0-0-0/c CHAR(30)    r     1 LABEL                     *0-0-0/w PTR         r     1 LABEL_POS
    74-0-0/c CHAR(5)     r     1 LABEL_TYPE                50-0-0/w UBIN        r     1 LEN
    *0-0-0/w UBIN        r     1 LEN                       *0-0-0/w UBIN        r     1 LEN
    *0-0-0/w STRC(18)    r     1 LH_OUT                    *0-0-0/w STRC(18)    r     1 LH_OUT
   251-0-0/b BIT         r     1 LLEFT                     77-0-0/w BIT (18)    r     1 LOWER_HALF
    *0-0-0/w BIT (18)    r     1 LOWER_HALF                *0-0-0/w BIT (18)    r     1 LOWER_HALF
   243-0-0/c CHAR(60)    r     1 MESS                     243-0-0/c CHAR(60)    r     1 MESS
   245-0-0/c CHAR(60)    r     1 MESS
    *0-0-0/c STRC(37)    r     1 MODFIELDS(0:2)
   252-0-0/b STRC(7)     r     1 M_FIELD                  252-0-0/b BIT (7)     r     1 M_OUT
    61-0-0/w SBIN        r     1 NUM                      242-0-0/w UBIN              1 NUM
    *0-0-0/w UBIN        r     1 NUM                      241-0-0/w SBIN        r     1 NUM
   243-0-0/w SBIN        r     1 NUM1                     233-0-0/w UBIN              1 NUM2
   244-0-0/w SBIN        r     1 NUM2                     233-0-0/w STRC              1 NUM3
   233-0-0/w STRC              1 NUM4                      61-0-0/w STRC        r     1 NUM_OUT
    *0-0-0/w BIT         r     1 NUM_T(0:35)               *0-0-0/c CHAR(30)    r     1 OCTCHAR
    *0-0-0/c CHAR        r     1 OCTCHAR_T(0:29)
   262-0-0/c CHAR(6)     r     1 OCTNUM                    *0-0-0/w UBIN        r     1 OCTNUM
   255-0-0/c CHAR(30)    r     1 OCTNUM
    *0-0-0/w BIT (3)     r     1 OCTNUM_T(0:11)
    *0-0-0/c CHAR(5)     r     1 OPCODE                    *0-0-0/c CHAR(5)     r     1 OPCODE
    *0-0-0/c CHAR(5)     r     1 OPCODE                    *0-0-0/w BIT (9)     r     1 OPCODE_VALUE
   251-0-0/w BIT (9)     r     1 OPCODE_VALUE             250-0-0/w BIT (9)     r     1 OPCODE_VALUE
   260-0-0/w UBIN              1 OPCODE_WORD               *0-0-0/c CHAR(30)    r     1 OPER
    64-0-0/c CHAR(30)    r     1 OPERAND                   *0-0-0/w SBIN        r     1 OPN
    *0-0-0/w UBIN(18)    r     1 OPND1                     *0-0-0/c CHAR(3)     r     1 OPND2
   260-0-0/w SBIN        r     1 OPNUM
    *0-0-0/w UBIN        r     1 OPTIONAL_FIELDS(0:2)
    *0-0-0/w UBIN(6)     r     1 P                        255-0-0/w UBIN(6)     r     1 P1
   256-0-0/w UBIN(6)     r     1 P2
     4-0-0/w SBIN        r     1 PARSE_STACK_IDX_IN_CHARS
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:348  
    *0-0-0/w PTR         r     1 POS                       *0-0-0/w PTR         r     1 POS
    *0-0-0/w PTR         r     1 POS                       *0-0-0/w PTR         r     1 POS
    *0-0-0/w PTR         r     1 POS                       *0-0-0/w PTR         r     1 POS
    *0-0-0/w PTR         r     1 POS                      242-0-0/w PTR         r     1 POS
   242-0-0/w PTR         r     1 POS                      242-0-0/w PTR         r     1 POS
   271-0-0/w SBIN              1 POS                       *0-0-0/w SBIN        r     1 POS
   251-0-0/w SBIN        r     1 POS                      241-0-0/w PTR               1 POS
    *0-0-0/w SBIN        r     1 POSITION                  *0-0-0/w PTR         r     1 POS_IN_LT
    *0-0-0/w PTR         r     1 POS_IN_LT                252-0-0/w SBIN        r     1 POS_IN_OPCODE_TABLE
    *0-0-0/w PTR         r     1 RECIEVING_LABEL          245-0-0/w SBIN(18)    r     1 RES1
   245-0-0/w UBIN(18)    r     1 RES2                      *0-0-0/c ACHR        r     1 RESULT
   253-0-0/c CHAR(30)    r     1 SEG_NUM_CH                *0-0-0/w PTR         r     1 SENDING_LABEL
   236-0-0/w UBIN        r     1 SHIFT_FACTOR              *0-0-0/w UBIN        r     1 SHIFT_FACTOR
   250-0-0/w PTR         r     1 SUB_POS                  174-0-0/c CHAR(120)   r     1 SWBOT
    *0-0-0/c CHAR(120)   r     1 SWBOT                    136-0-0/c CHAR(120)   r     1 SWTOP
    *0-0-0/c CHAR(120)   r     1 SWTOP                     *0-0-0/w PTR         r     1 TABLE
    *0-0-0/w PTR         r     1 TABLE                     *0-0-0/w PTR         r     1 TABLE
    *0-0-0/c CHAR(2)     r     1 TAG_TYPE                  *0-0-0/w BIT (18)    r     1 TAG_VAL
   267-0-0/w BIT (18)    r     1 TAG_VAL                  253-0-0/w BIT (18)    r     1 TAG_VAL
   243-0-0/c CHAR(8)     r     1 TEXT                     246-0-0/c CHAR(10)    r     1 TSWBOT
   251-0-0/c CHAR(10)    r     1 TSWTOP                    *0-0-0/c CHAR(5)     r     1 TYPE
    *0-0-0/w STRC(18)    r     1 UH_OUT                    *0-0-0/w STRC(18)    r     1 UH_OUT2
    *0-0-0/w STRC(18)    r     1 UH_OUT3                   76-0-0/w BIT (18)    r     1 UPPER_HALF
    *0-0-0/w BIT (18)    r     1 UPPER_HALF                *0-0-0/w BIT (18)    r     1 UPPER_HALF
    *0-0-0/w SBIN        r     1 VAL                      235-0-0/w UBIN        r     1 VFD_LENGTH
   234-0-0/w UBIN        r     1 VFD_NUM                  232-0-0/w STRC        r     1 VFD_OUT
   254-0-0/w STRC        r     1 VFD_OUT                  232-0-0/w UBIN        r     1 VFD_WORD
   254-0-0/w UBIN        r     1 VFD_WORD                 253-0-0/w UBIN              1 YFIELD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 Z8PS$M$DO#                 0-0-0/w PTR               1 Z8PS$M$DO$
     0-0-0/w UBIN        r     1 Z8PS$M$LO#                 0-0-0/w PTR               1 Z8PS$M$LO$
     0-0-0/w UBIN        r     1 Z8PS$M$OU#                 0-0-0/w PTR               1 Z8PS$M$OU$
PL6.E3A0      #001=Z8PA$SEMANTICS File=Z8PA.:Z8A6TSI                             SAT 08/09/97 09:39 Page:349  
     0-0-0/w UBIN        r     1 Z8PS$M$SO#                 0-0-0/w PTR               1 Z8PS$M$SO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 BURST_TABLE                0-0-0/w STRC(72)    r     1 DEP
     0-0-0/w ASTR        r     1 DNT                        0-0-0/w STRC(504)   r     1 LABEL_TABLE
     0-0-0/w STRC(216)         1 LX_ITEM                    0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$OU
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$SO
     0-0-0N  NULL        r     1 M$UI                       0-0-0/c ACHR              1 PARSE_STACK_USED
     0-0-0/w STRC(72)    r     1 PEPD                       0-0-0/w STRC(144)   r     1 REF_LIST


   Procedure Z8PA$SEMANTICS requires 4484 words for executable code.
   Procedure Z8PA$SEMANTICS requires 194 words of local(AUTO) storage.

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:350  
     2372        1        /*T***********************************************************/
     2373        2        /*T*                                                         */
     2374        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2375        4        /*T*                                                         */
     2376        5        /*T***********************************************************/
     2377        6         Z8PA$OUTPUT_XREF : PROC(TOP_TREE);
     2378        7         /*D*
     2379        8              NAME: Z8PA$OUTPUT_XREF
     2380        9              CALL:
     2381       10                   CALL Z8PA$OUTPUT_XREF(TOP_TREE);
     2382       11              PARAMETERS:
     2383       12                   TOP_TREE
     2384       13                     Input parameter that gives the top of the subtree to be output.
     2385       14              ENVIRONMENT:
     2386       15                   None.
     2387       16              INPUT:
     2388       17                   LABEL_TABLE
     2389       18              OUTPUT:
     2390       19                   The cross reference to label references to M$LO;
     2391       20              SCRATCH:
     2392       21                   None.
     2393       22              DESCRIPTION:
     2394       23                   This is a recurisve procedure which outputs the cross reference
     2395       24                   to the listing file. The recursion is started in GENERATE_XREF,
     2396       25                   which also outputs the header and key.
     2397       26         */
     2398       27
     2399       28    1        DCL TOP_TREE PTR;
     2400       29    1        DCL POS PTR;
     2401       30
     2402       31             %INCLUDE Z8P_SCAN_EXT;
     2403      220             %INCLUDE Z8P_SEMAN_EX;
     2404      289             %DCBPTR;
     2405      299
     2406      300    1        POS = TOP_TREE;
     2407      301
     2408      302    1        IF POS->LABEL_TABLE.LLINK ~= ADDR(NIL) THEN
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:351  
     2409      303    1          CALL Z8PA$OUTPUT_XREF(POS->LABEL_TABLE.LLINK);
     2410      304
     2411      305    1        CALL OUTPUT_REFS(POS);
     2412      306
     2413      307    1        IF POS->LABEL_TABLE.RLINK ~= ADDR(NIL) THEN
     2414      308    1          CALL Z8PA$OUTPUT_XREF(POS->LABEL_TABLE.RLINK);
     2415      309
     2416      310    1        OUTPUT_REFS : PROC(POS);
     2417      311    2           DCL POS PTR;
     2418      312    2           DCL DEF_PNT CHAR(6);
     2419      313    2           DCL DEF_OUT CHAR(100);
     2420      314                %EQU REFS_OUT = 7;
     2421      315    2           DCL REF_LINE(0:%REFS_OUT) CHAR(6);
     2422      316    2           DCL REF_CNT UBIN;
     2423      317    2           DCL CNT PTR;
     2424      318
     2425      319    2           CALL DEC_TO_OCT_SUP(DEF_PNT,POS->LABEL_TABLE.LOCATION);
     2426      320    2           CALL CONCAT(DEF_OUT,POS->LABEL_TABLE.NAME,' ',POS->LABEL_TABLE.TYPE,'   ',
               320                    DEF_PNT);
     2427      321
     2428      322    2           CNT = POS->LABEL_TABLE.FIRST_REF;
     2429      323    2           CALL INIT_REF_LINE;
     2430      324
     2431      325    3           DO UNTIL (CNT = ADDR(NIL));
     2432      326    3              IF REF_CNT > %REFS_OUT THEN
     2433      327    4                 DO;
     2434      328    4                    CALL OUTPUT_REF_LINE;
     2435      329    4                    CALL INIT_REF_LINE;
     2436      330    4                 END;
     2437      331    3              CALL DEC_TO_OCT_SUP(REF_LINE(REF_CNT),CNT->REF_LIST.REF);
     2438      332    3              CNT = CNT->REF_LIST.NEXT;
     2439      333    3              REF_CNT = REF_CNT + 1;
     2440      334    3           END;
     2441      335    2           CALL OUTPUT_REF_LINE;
     2442      336
     2443      337    2        OUTPUT_REF_LINE : PROC;
     2444      338
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:352  
     2445      339    3           DCL CNT1 SBIN;
     2446      340    3           BUFFER = DEF_OUT;
     2447      341
     2448      342    4           DO CNT1 = 0 TO %REFS_OUT;
     2449      343    4              CALL INSERT(BUFFER,%LABEL_LENGTH + 13 + (CNT1 * 7),,REF_LINE(CNT1));
     2450      344    4           END;
     2451      345
     2452      346                %OUTPUT_STR;
     2453      357    3           DEF_OUT = ' ';
     2454      358    3        END OUTPUT_REF_LINE;
     2455      359
     2456      360
     2457      361    2        INIT_REF_LINE : PROC;
     2458      362    3           DCL CNT1 UBIN;
     2459      363
     2460      364    4           DO CNT1 = 0 TO %REFS_OUT;
     2461      365    4              REF_LINE(CNT1) = ' ';
     2462      366    4           END;
     2463      367
     2464      368    3           REF_CNT = 0;
     2465      369    3        END INIT_REF_LINE;
     2466      370    2      END OUTPUT_REFS;
     2467      371    1    END Z8PA$OUTPUT_XREF;
     2468      372         %EOD;

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:353  
--  Include file information  --

   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8PA$OUTPUT_XREF.

   Procedure Z8PA$OUTPUT_XREF requires 159 words for executable code.
   Procedure Z8PA$OUTPUT_XREF requires 92 words of local(AUTO) storage.

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:354  

 Object Unit name= Z8PA$OUTPUT_XREF                           File name= Z8PA.:Z8A6TOU
 UTS= AUG 09 '97 09:42:38.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  OUT_DCBN
    1  LblCom even  none     1      1  SAVE_OUT_DCBN
    2  LblCom even  none     1      1  SAVE_DCBN2
    3   DCB   even  none     0      0  M$OU
    4   DCB   even  none     0      0  M$SO
    5   DCB   even  none     0      0  M$LO
    6   DCB   even  none     0      0  M$SI
    7   DCB   even  none     0      0  M$UI
    8   DCB   even  none     0      0  M$DO
    9  LblCom even  none     1      1  ERR_SEV
   10  LblCom even  none     1      1  OPTIONS
   11  LblCom even  none     1      1  DO_REQ
   12  LblCom even  none    26     32  OPTIONS_TEXT
   13  LblCom even  none   128    200  INSTR
   14  LblCom even  none     1      1  INSTR_LISTED
   15  LblCom even  none     1      1  INSTR_LEN
   16  LblCom even  none     1      1  INSTR_INDX
   17  LblCom even  none     1      1  EOF_FLAG
   18  LblCom even  none     5      5  KEY_REC
   19  LblCom even  none     1      1  LINES_OUT
   20  LblCom even  none    25     31  HEADER_LINE1
   21  LblCom even  none    25     31  HEADER_LINE3
   22  LblCom even  none    25     31  HEADER_LINE2
   23  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   24  LblCom even  none    28     34  LINE
   25  LblCom even  none     1      1  LINELEN
   26  LblCom even  none     1      1  PHASE
   27  LblCom even  none     1      1  ERROR_COUNT
   28  RoData even  UTS      1      1  Z8PA$OUTPUT_XREF
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:355  
   29   Proc  even  none   159    237  Z8PA$OUTPUT_XREF
   30  RoData even  none     5      5  Z8PA$OUTPUT_XREF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    29      0   yes            yes      Std        1  Z8PA$OUTPUT_XREF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 DEC_TO_OCT_SUP
         yes           Std       2 OUTPUT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$OU                                  M$SO                                  M$LO
     M$SI                                  M$UI                                  M$DO
     Z8PS$M$OU$                            Z8PS$M$LO$                            Z8PS$M$DO$
     Z8PS$M$SO$                            Z8PS$M$OU#                            Z8PS$M$LO#
     Z8PS$M$DO#                            Z8PS$M$SO#

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:356  


     2372        1        /*T***********************************************************/
     2373        2        /*T*                                                         */
     2374        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2375        4        /*T*                                                         */
     2376        5        /*T***********************************************************/
     2377        6         Z8PA$OUTPUT_XREF : PROC(TOP_TREE);

      6 29 000000   000000 700200 xent  Z8PA$OUTPUT* TSX0  ! X66_AUTO_1
        29 000001   000134 000001                    ZERO    92,1

     2378        7         /*D*
     2379        8              NAME: Z8PA$OUTPUT_XREF
     2380        9              CALL:
     2381       10                   CALL Z8PA$OUTPUT_XREF(TOP_TREE);
     2382       11              PARAMETERS:
     2383       12                   TOP_TREE
     2384       13                     Input parameter that gives the top of the subtree to be output.
     2385       14              ENVIRONMENT:
     2386       15                   None.
     2387       16              INPUT:
     2388       17                   LABEL_TABLE
     2389       18              OUTPUT:
     2390       19                   The cross reference to label references to M$LO;
     2391       20              SCRATCH:
     2392       21                   None.
     2393       22              DESCRIPTION:
     2394       23                   This is a recurisve procedure which outputs the cross reference
     2395       24                   to the listing file. The recursion is started in GENERATE_XREF,
     2396       25                   which also outputs the header and key.
     2397       26         */
     2398       27
     2399       28    1        DCL TOP_TREE PTR;
     2400       29    1        DCL POS PTR;
     2401       30
     2402       31             %INCLUDE Z8P_SCAN_EXT;
     2403      220             %INCLUDE Z8P_SEMAN_EX;
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:357  
     2404      289             %DCBPTR;
     2405      299
     2406      300    1        POS = TOP_TREE;

    300 29 000002   200003 470500                    LDP0    @TOP_TREE,,AUTO
        29 000003   000000 236100                    LDQ     0,,PR0
        29 000004   200004 756100                    STQ     POS,,AUTO

     2407      301
     2408      302    1        IF POS->LABEL_TABLE.LLINK ~= ADDR(NIL) THEN

    302 29 000005   200004 471500                    LDP1    POS,,AUTO
        29 000006   100015 236100                    LDQ     13,,PR1
        29 000007   000000 116000 30                 CMPQ    0
        29 000010   000020 600000 29                 TZE     s:305

     2409      303    1          CALL Z8PA$OUTPUT_XREF(POS->LABEL_TABLE.LLINK);

    303 29 000011   200004 236100                    LDQ     POS,,AUTO
        29 000012   000015 036003                    ADLQ    13,DU
        29 000013   200130 756100                    STQ     CNT1+1,,AUTO
        29 000014   200130 630500                    EPPR0   CNT1+1,,AUTO
        29 000015   000001 631400 30                 EPPR1   1
        29 000016   000000 701000 29                 TSX1    s:6
        29 000017   000000 011000                    NOP     0

     2410      304
     2411      305    1        CALL OUTPUT_REFS(POS);

    305 29 000020   200004 630500                    EPPR0   POS,,AUTO
        29 000021   200053 450500                    STP0    LEN+3,,AUTO
        29 000022   000040 701000 29                 TSX1    OUTPUT_REFS
        29 000023   000000 011000                    NOP     0

     2412      306
     2413      307    1        IF POS->LABEL_TABLE.RLINK ~= ADDR(NIL) THEN

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:358  
    307 29 000024   200004 470500                    LDP0    POS,,AUTO
        29 000025   000014 236100                    LDQ     12,,PR0
        29 000026   000000 116000 30                 CMPQ    0
        29 000027   000037 600000 29                 TZE     s:308+7

     2414      308    1          CALL Z8PA$OUTPUT_XREF(POS->LABEL_TABLE.RLINK);

    308 29 000030   200004 236100                    LDQ     POS,,AUTO
        29 000031   000014 036003                    ADLQ    12,DU
        29 000032   200130 756100                    STQ     CNT1+1,,AUTO
        29 000033   200130 630500                    EPPR0   CNT1+1,,AUTO
        29 000034   000001 631400 30                 EPPR1   1
        29 000035   000000 701000 29                 TSX1    s:6
        29 000036   000000 011000                    NOP     0
        29 000037   000236 710000 29                 TRA     s:371

     2415      309
     2416      310    1        OUTPUT_REFS : PROC(POS);

    310 29 000040   200052 741300       OUTPUT_REFS  STX1  ! LEN+2,,AUTO

     2417      311    2           DCL POS PTR;
     2418      312    2           DCL DEF_PNT CHAR(6);
     2419      313    2           DCL DEF_OUT CHAR(100);
     2420      314                %EQU REFS_OUT = 7;
     2421      315    2           DCL REF_LINE(0:%REFS_OUT) CHAR(6);
     2422      316    2           DCL REF_CNT UBIN;
     2423      317    2           DCL CNT PTR;
     2424      318
     2425      319    2           CALL DEC_TO_OCT_SUP(DEF_PNT,POS->LABEL_TABLE.LOCATION);

    319 29 000041   200053 470500                    LDP0    @POS,,AUTO
        29 000042   000000 471500                    LDP1    0,,PR0
        29 000043   100010 633500                    EPPR3   8,,PR1
        29 000044   200131 453500                    STP3    CNT1+2,,AUTO
        29 000045   200054 631500                    EPPR1   DEF_PNT,,AUTO
        29 000046   200130 451500                    STP1    CNT1+1,,AUTO
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:359  
        29 000047   200130 630500                    EPPR0   CNT1+1,,AUTO
        29 000050   000002 631400 30                 EPPR1   2
        29 000051   000000 701000 xent               TSX1    DEC_TO_OCT_SUP
        29 000052   000000 011000                    NOP     0

     2426      320    2           CALL CONCAT(DEF_OUT,POS->LABEL_TABLE.NAME,' ',POS->LABEL_TABLE.TYPE,'   ',
               320                    DEF_PNT);

    320 29 000053   200053 470500                    LDP0    @POS,,AUTO
        29 000054   000000 471500                    LDP1    0,,PR0
        29 000055   040100 100500                    MLR     fill='040'O
        29 000056   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        29 000057   200056 000036                    ADSC9   DEF_OUT,,AUTO            cn=0,n=30
        29 000060   040000 236007                    LDQ     16384,DL
        29 000061   200065 552110                    STBQ    DEF_OUT+7,'10'O,AUTO
        29 000062   040100 100500                    MLR     fill='040'O
        29 000063   100013 000002                    ADSC9   11,,PR1                  cn=0,n=2
        29 000064   200065 600002                    ADSC9   DEF_OUT+7,,AUTO          cn=3,n=2
        29 000065   000000 236000 28                 LDQ     0
        29 000066   000011 772000                    QRL     9
        29 000067   200066 552134                    STBQ    DEF_OUT+8,'34'O,AUTO
        29 000070   040100 100500                    MLR     fill='040'O
        29 000071   200054 000006                    ADSC9   DEF_PNT,,AUTO            cn=0,n=6
        29 000072   200067 000100                    ADSC9   DEF_OUT+9,,AUTO          cn=0,n=64

     2427      321
     2428      322    2           CNT = POS->LABEL_TABLE.FIRST_REF;

    322 29 000073   200053 470500                    LDP0    @POS,,AUTO
        29 000074   000000 471500                    LDP1    0,,PR0
        29 000075   100011 236100                    LDQ     9,,PR1
        29 000076   200124 756100                    STQ     CNT,,AUTO

     2429      323    2           CALL INIT_REF_LINE;

    323 29 000077   000215 701000 29                 TSX1    INIT_REF_LINE
        29 000100   000000 011000                    NOP     0
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:360  

     2430      324
     2431      325    3           DO UNTIL (CNT = ADDR(NIL));

     2432      326    3              IF REF_CNT > %REFS_OUT THEN

    326 29 000101   200123 235100                    LDA     REF_CNT,,AUTO
        29 000102   000010 115007                    CMPA    8,DL
        29 000103   000110 602000 29                 TNC     s:331

     2433      327    4                 DO;

     2434      328    4                    CALL OUTPUT_REF_LINE;

    328 29 000104   000137 701000 29                 TSX1    OUTPUT_REF_LINE
        29 000105   000000 011000                    NOP     0

     2435      329    4                    CALL INIT_REF_LINE;

    329 29 000106   000215 701000 29                 TSX1    INIT_REF_LINE
        29 000107   000000 011000                    NOP     0

     2436      330    4                 END;

     2437      331    3              CALL DEC_TO_OCT_SUP(REF_LINE(REF_CNT),CNT->REF_LIST.REF);

    331 29 000110   200124 236100                    LDQ     CNT,,AUTO
        29 000111   200131 756100                    STQ     CNT1+2,,AUTO
        29 000112   200132 452500                    STP2    CNT1+3,,AUTO
        29 000113   200123 236100                    LDQ     REF_CNT,,AUTO
        29 000114   000003 402000 30                 MPY     3
        29 000115   000107 036003                    ADLQ    71,DU
        29 000116   200132 036100                    ADLQ    CNT1+3,,AUTO
        29 000117   200130 756100                    STQ     CNT1+1,,AUTO
        29 000120   200130 630500                    EPPR0   CNT1+1,,AUTO
        29 000121   000002 631400 30                 EPPR1   2
        29 000122   000000 701000 xent               TSX1    DEC_TO_OCT_SUP
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:361  
        29 000123   000000 011000                    NOP     0

     2438      332    3              CNT = CNT->REF_LIST.NEXT;

    332 29 000124   200124 470500                    LDP0    CNT,,AUTO
        29 000125   000001 236100                    LDQ     1,,PR0
        29 000126   200124 756100                    STQ     CNT,,AUTO

     2439      333    3              REF_CNT = REF_CNT + 1;

    333 29 000127   200123 235100                    LDA     REF_CNT,,AUTO
        29 000130   000001 035007                    ADLA    1,DL
        29 000131   200123 755100                    STA     REF_CNT,,AUTO

     2440      334    3           END;

    334 29 000132   000000 116000 30                 CMPQ    0
        29 000133   000101 601000 29                 TNZ     s:326

     2441      335    2           CALL OUTPUT_REF_LINE;

    335 29 000134   000137 701000 29                 TSX1    OUTPUT_REF_LINE
        29 000135   000000 011000                    NOP     0
        29 000136   000234 710000 29                 TRA     s:370

     2442      336
     2443      337    2        OUTPUT_REF_LINE : PROC;

    337 29 000137   200126 741300       OUTPUT_REF_* STX1  ! CNT+2,,AUTO

     2444      338
     2445      339    3           DCL CNT1 SBIN;
     2446      340    3           BUFFER = DEF_OUT;

    340 29 000140   040100 100500                    MLR     fill='040'O
        29 000141   200056 000144                    ADSC9   DEF_OUT,,AUTO            cn=0,n=100
        29 000142   200005 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:362  

     2447      341
     2448      342    4           DO CNT1 = 0 TO %REFS_OUT;

    342 29 000143   200127 450100                    STZ     CNT1,,AUTO

     2449      343    4              CALL INSERT(BUFFER,%LABEL_LENGTH + 13 + (CNT1 * 7),,REF_LINE(CNT1));

    343 29 000144   200127 236100                    LDQ     CNT1,,AUTO
        29 000145   000006 402007                    MPY     6,DL
        29 000146   200130 756100                    STQ     CNT1+1,,AUTO
        29 000147   000000 236003                    LDQ     0,DU
        29 000150   200127 136100                    SBLQ    CNT1,,AUTO
        29 000151   000007 402007                    MPY     7,DL
        29 000152   000141 620006                    EAX0    97,QL
        29 000153   200127 236100                    LDQ     CNT1,,AUTO
        29 000154   000007 402007                    MPY     7,DL
        29 000155   200130 235100                    LDA     CNT1+1,,AUTO
        29 000156   040146 100505                    MLR     fill='040'O
        29 000157   200107 000006                    ADSC9   REF_LINE,A,AUTO          cn=0,n=6
        29 000160   200017 600010                    ADSC9   BUFFER+10,Q,AUTO         cn=3,n=*X0

     2450      344    4           END;

    344 29 000161   200127 054100                    AOS     CNT1,,AUTO
        29 000162   200127 235100                    LDA     CNT1,,AUTO
        29 000163   000007 115007                    CMPA    7,DL
        29 000164   000144 604400 29                 TMOZ    s:343

     2451      345
     2452      346                %OUTPUT_STR;

    351 29 000165   000000 236000 0                  LDQ     OUT_DCBN
        29 000166   000176 604000 29                 TMI     s:353
        29 000167   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        29 000170   000176 601000 29                 TNZ     s:353
        29 000171   000000 236000 10                 LDQ     OPTIONS
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:363  
        29 000172   000002 736000                    QLS     2
        29 000173   400000 376003                    ANQ     -131072,DU
        29 000174   400000 676003                    ERQ     -131072,DU
        29 000175   000210 601000 29                 TNZ     s:357

    353 29 000176   000214 236007                    LDQ     140,DL
        29 000177   200050 756100                    STQ     LEN,,AUTO

    354 29 000200   200050 630500                    EPPR0   LEN,,AUTO
        29 000201   200131 450500                    STP0    CNT1+2,,AUTO
        29 000202   200005 631500                    EPPR1   BUFFER,,AUTO
        29 000203   200130 451500                    STP1    CNT1+1,,AUTO
        29 000204   200130 630500                    EPPR0   CNT1+1,,AUTO
        29 000205   000002 631400 30                 EPPR1   2
        29 000206   000000 701000 xent               TSX1    OUTPUT
        29 000207   000000 011000                    NOP     0

     2453      357    3           DEF_OUT = ' ';

    357 29 000210   040100 100400                    MLR     fill='040'O
        29 000211   000004 000001 30                 ADSC9   4                        cn=0,n=1
        29 000212   200056 000144                    ADSC9   DEF_OUT,,AUTO            cn=0,n=100

     2454      358    3        END OUTPUT_REF_LINE;

    358 29 000213   200126 221300                    LDX1  ! CNT+2,,AUTO
        29 000214   000001 702211                    TSX2  ! 1,X1

     2455      359
     2456      360
     2457      361    2        INIT_REF_LINE : PROC;

    361 29 000215   200126 741300       INIT_REF_LI* STX1  ! CNT+2,,AUTO

     2458      362    3           DCL CNT1 UBIN;
     2459      363
     2460      364    4           DO CNT1 = 0 TO %REFS_OUT;
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:364  

    364 29 000216   200127 450100                    STZ     CNT1,,AUTO

     2461      365    4              REF_LINE(CNT1) = ' ';

    365 29 000217   200127 236100                    LDQ     CNT1,,AUTO
        29 000220   000006 402007                    MPY     6,DL
        29 000221   040106 100400                    MLR     fill='040'O
        29 000222   000004 000001 30                 ADSC9   4                        cn=0,n=1
        29 000223   200107 000006                    ADSC9   REF_LINE,Q,AUTO          cn=0,n=6

     2462      366    4           END;

    366 29 000224   200127 235100                    LDA     CNT1,,AUTO
        29 000225   000001 035007                    ADLA    1,DL
        29 000226   200127 755100                    STA     CNT1,,AUTO
        29 000227   000010 115007                    CMPA    8,DL
        29 000230   000217 602000 29                 TNC     s:365

     2463      367
     2464      368    3           REF_CNT = 0;

    368 29 000231   200123 450100                    STZ     REF_CNT,,AUTO

     2465      369    3        END INIT_REF_LINE;

    369 29 000232   200126 221300                    LDX1  ! CNT+2,,AUTO
        29 000233   000001 702211                    TSX2  ! 1,X1

     2466      370    2      END OUTPUT_REFS;

    370 29 000234   200052 221300                    LDX1  ! LEN+2,,AUTO
        29 000235   000001 702211                    TSX2  ! 1,X1

     2467      371    1    END Z8PA$OUTPUT_XREF;

    371 29 000236   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:365  
     2468      372         %EOD;

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:366  
--  Include file information  --

   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8PA$OUTPUT_XREF.
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:367  

 **** Variables and constants ****

  ****  Section 000 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OUT_DCBN

  ****  Section 001 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 002 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_DCBN2

  ****  Section 009 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 010 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:368  
  ****  Section 011 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 DO_REQ

  ****  Section 012 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 013 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 INSTR(0:511)               0-0-0/c CHAR(512)         1 INSTRCHR

  ****  Section 014 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 INSTR_LISTED

  ****  Section 015 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_LEN

  ****  Section 016 LblCom INSTR_INDX

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:369  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_INDX

  ****  Section 017 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 EOF_FLAG

  ****  Section 018 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)          1 KEY_REC

  ****  Section 019 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 020 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 021 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:370  

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 022 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 023 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 024 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 025 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 026 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PHASE
PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:371  

  ****  Section 027 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERROR_COUNT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    53-0-0/w PTR         r     1 @POS                       3-0-0/w PTR         r     1 @TOP_TREE
     5-0-0/c CHAR(140)   r     1 BUFFER                   124-0-0/w PTR         r     1 CNT
   127-0-0/w SBIN        r     1 CNT1                     127-0-0/w UBIN        r     1 CNT1
    56-0-0/c CHAR(100)   r     1 DEF_OUT                   54-0-0/c CHAR(6)     r     1 DEF_PNT
    50-0-0/w UBIN        r     1 LEN                        4-0-0/w PTR         r     1 POS
    *0-0-0/w PTR         r     1 POS                      123-0-0/w UBIN        r     1 REF_CNT
   107-0-0/c CHAR(6)     r     1 REF_LINE(0:7)
    *0-0-0/w PTR         r     1 TOP_TREE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 Z8PS$M$DO#                 0-0-0/w PTR               1 Z8PS$M$DO$
     0-0-0/w UBIN              1 Z8PS$M$LO#                 0-0-0/w PTR               1 Z8PS$M$LO$
     0-0-0/w UBIN        r     1 Z8PS$M$OU#                 0-0-0/w PTR               1 Z8PS$M$OU$
     0-0-0/w UBIN              1 Z8PS$M$SO#                 0-0-0/w PTR               1 Z8PS$M$SO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=Z8PA$OUTPUT_XREF File=Z8PA.:Z8A6TSI                           SAT 08/09/97 09:42 Page:372  
     0-0-0/w STRC(504)   r     1 LABEL_TABLE                0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$OU
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$SO
     0-0-0N  NULL        r     1 M$UI                       0-0-0/w STRC(144)   r     1 REF_LIST


   Procedure Z8PA$OUTPUT_XREF requires 159 words for executable code.
   Procedure Z8PA$OUTPUT_XREF requires 92 words of local(AUTO) storage.

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:373  
     2469        1        /*T***********************************************************/
     2470        2        /*T*                                                         */
     2471        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2472        4        /*T*                                                         */
     2473        5        /*T***********************************************************/
     2474        6         Z8PA$OUTPUT_JMP_DEST : PROC(TABLE);
     2475        7         /*D*
     2476        8              NAME: Z8PA$OUTPUT_JMP_DEST
     2477        9              CALL:
     2478       10                   CALL Z8PA$OUTPUT_JMP_DEST(TABLE);
     2479       11              INPUT:
     2480       12                   REF_LIST, LABEL_TABLE
     2481       13              PARAMETERS:
     2482       14                   TABLE
     2483       15                     Points to the label table to use in getting the jmp destinations.
     2484       16              DESCRIPTION:
     2485       17                   Anytime a label is an operand of a pseudo-code directive
     2486       18                   (as in the JMP directive) a preprocessor variable is created
     2487       19                   and output to the object table in place of the label.  This procedure
     2488       20                   creates preprocessor directives that define the value of the created
     2489       21                   variables.  The directives are output to M$SO.  As this
     2490       22                   procedure steps throgh the label table it also returns
     2491       23                   each REF_list to the free space list for REF_LISTs. Called by
     2492       24                   GEN_JMP_DEST in Z8PA$SEMANTICS.
     2493       25         */
     2494       26             %INCLUDE Z8P_SCAN_EXT;
     2495      215             %INCLUDE Z8P_SEMAN_EX;
     2496      284             %DCBPTR;
     2497      294    1        DCL Z8PA$ERROR_PROC ENTRY(1);
     2498      295    1        DCL TABLE PTR;
     2499      296    1        DCL CNT PTR;
     2500      297    1        DCL POS PTR;
     2501      298    1        DCL TOP PTR;
     2502      299    1        DCL BOT PTR;
     2503      300    1        DCL MESS CHAR(%MESS_LEN);
     2504      301    1        DCL DEST_CHAR CHAR(8);
     2505      302    1        DCL ACTUAL_DEST SBIN HALF;
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:374  
     2506      303    1        DCL ACTUAL_DEST_OUT REDEF ACTUAL_DEST UBIN HALF;
     2507      304
     2508      305
     2509      306
     2510      307    1        POS = TABLE;
     2511      308
     2512      309    1        IF POS->LABEL_TABLE.RLINK ~= ADDR(NIL) THEN
     2513      310    1          CALL Z8PA$OUTPUT_JMP_DEST(POS->LABEL_TABLE.RLINK);
     2514      311
     2515      312    1        CALL OUT_DEST;
     2516      313
     2517      314    1        IF POS->LABEL_TABLE.LLINK ~= ADDR(NIL) THEN
     2518      315    1          CALL Z8PA$OUTPUT_JMP_DEST(POS->LABEL_TABLE.LLINK);
     2519      316
     2520      317    1        OUT_DEST : PROC;
     2521      318    2          IF POS->LABEL_TABLE.LOCATION = -1 THEN
     2522      319    3            DO;
     2523      320    3              CALL CONCAT(MESS,%MESS7,POS->LABEL_TABLE.NAME);
     2524      321    3              CALL Z8PA$ERROR_PROC(MESS);
     2525      322    3            END;
     2526      323    2          ELSE
     2527      324    3            DO;
     2528      325    3              CNT = POS->LABEL_TABLE.FIRST_REF;
     2529      326    3              IF CNT ~= ADDR(NIL) THEN
     2530      327    3                TOP = CNT;
     2531      328    3              ELSE
     2532      329    3                TOP = ADDR(NIL);
     2533      330    4              DO UNTIL(CNT = ADDR(NIL));
     2534      331    4                IF CNT->REF_LIST.DEST ~= 'EMPTY' THEN
     2535      332    5                  DO;
     2536      333    5                    ACTUAL_DEST = POS->LABEL_TABLE.LOCATION - CNT->REF_LIST.REF;
     2537      334    5                    CALL BINXCHAR(DEST_CHAR,ACTUAL_DEST_OUT);
     2538      335    5                    CALL CONCAT(BUFFER,'%EQU D',CNT->REF_LIST.DEST,' = ',DEST_CHAR,';')
               335                             ;
     2539      336                         %OUTPUT_STR;
     2540      347    5                  END;
     2541      348    4                  BOT = CNT;
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:375  
     2542      349    4                CNT = CNT->REF_LIST.NEXT;
     2543      350    4              END;
     2544      351         /*        IF TOP ~= ADDR(NIL) THEN
     2545      352                     DO;
     2546      353                       BOT->REF_LIST.NEXT = TOP_FREE_RL;
     2547      354                       TOP_FREE_RL = TOP;
     2548      355                     END; */
     2549      356    3            END;
     2550      357    2        END OUT_DEST;
     2551      358    1    END Z8PA$OUTPUT_JMP_DEST;
     2552      359         %EOD;

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:376  
--  Include file information  --

   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8PA$OUTPUT_JMP_DEST.

   Procedure Z8PA$OUTPUT_JMP_DEST requires 117 words for executable code.
   Procedure Z8PA$OUTPUT_JMP_DEST requires 66 words of local(AUTO) storage.

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:377  

 Object Unit name= Z8PA$OUTPUT_JMP_DEST                       File name= Z8PA.:Z8A6TOU
 UTS= AUG 09 '97 09:42:53.52 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  OUT_DCBN
    1  LblCom even  none     1      1  SAVE_OUT_DCBN
    2  LblCom even  none     1      1  SAVE_DCBN2
    3   DCB   even  none     0      0  M$OU
    4   DCB   even  none     0      0  M$SO
    5   DCB   even  none     0      0  M$LO
    6   DCB   even  none     0      0  M$SI
    7   DCB   even  none     0      0  M$UI
    8   DCB   even  none     0      0  M$DO
    9  LblCom even  none     1      1  ERR_SEV
   10  LblCom even  none     1      1  OPTIONS
   11  LblCom even  none     1      1  DO_REQ
   12  LblCom even  none    26     32  OPTIONS_TEXT
   13  LblCom even  none   128    200  INSTR
   14  LblCom even  none     1      1  INSTR_LISTED
   15  LblCom even  none     1      1  INSTR_LEN
   16  LblCom even  none     1      1  INSTR_INDX
   17  LblCom even  none     1      1  EOF_FLAG
   18  LblCom even  none     5      5  KEY_REC
   19  LblCom even  none     1      1  LINES_OUT
   20  LblCom even  none    25     31  HEADER_LINE1
   21  LblCom even  none    25     31  HEADER_LINE3
   22  LblCom even  none    25     31  HEADER_LINE2
   23  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   24  LblCom even  none    28     34  LINE
   25  LblCom even  none     1      1  LINELEN
   26  LblCom even  none     1      1  PHASE
   27  LblCom even  none     1      1  ERROR_COUNT
   28  RoData even  UTS     13     15  Z8PA$OUTPUT_JMP_DEST
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:378  
   29   Proc  even  none   117    165  Z8PA$OUTPUT_JMP_DEST
   30  RoData even  none     5      5  Z8PA$OUTPUT_JMP_DEST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    29      0   yes            yes      Std        1  Z8PA$OUTPUT_JMP_DEST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8PA$ERROR_PROC
         yes           Std       2 OUTPUT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$OU                                  M$SO                                  M$LO
     M$SI                                  M$UI                                  M$DO
     Z8PS$M$OU$                            Z8PS$M$LO$                            Z8PS$M$DO$
     Z8PS$M$SO$                            Z8PS$M$OU#                            Z8PS$M$LO#
     Z8PS$M$DO#                            Z8PS$M$SO#

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:379  


     2469        1        /*T***********************************************************/
     2470        2        /*T*                                                         */
     2471        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2472        4        /*T*                                                         */
     2473        5        /*T***********************************************************/
     2474        6         Z8PA$OUTPUT_JMP_DEST : PROC(TABLE);

      6 29 000000   000000 700200 xent  Z8PA$OUTPUT* TSX0  ! X66_AUTO_1
        29 000001   000102 000001                    ZERO    66,1

     2475        7         /*D*
     2476        8              NAME: Z8PA$OUTPUT_JMP_DEST
     2477        9              CALL:
     2478       10                   CALL Z8PA$OUTPUT_JMP_DEST(TABLE);
     2479       11              INPUT:
     2480       12                   REF_LIST, LABEL_TABLE
     2481       13              PARAMETERS:
     2482       14                   TABLE
     2483       15                     Points to the label table to use in getting the jmp destinations.
     2484       16              DESCRIPTION:
     2485       17                   Anytime a label is an operand of a pseudo-code directive
     2486       18                   (as in the JMP directive) a preprocessor variable is created
     2487       19                   and output to the object table in place of the label.  This procedure
     2488       20                   creates preprocessor directives that define the value of the created
     2489       21                   variables.  The directives are output to M$SO.  As this
     2490       22                   procedure steps throgh the label table it also returns
     2491       23                   each REF_list to the free space list for REF_LISTs. Called by
     2492       24                   GEN_JMP_DEST in Z8PA$SEMANTICS.
     2493       25         */
     2494       26             %INCLUDE Z8P_SCAN_EXT;
     2495      215             %INCLUDE Z8P_SEMAN_EX;
     2496      284             %DCBPTR;
     2497      294    1        DCL Z8PA$ERROR_PROC ENTRY(1);
     2498      295    1        DCL TABLE PTR;
     2499      296    1        DCL CNT PTR;
     2500      297    1        DCL POS PTR;
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:380  
     2501      298    1        DCL TOP PTR;
     2502      299    1        DCL BOT PTR;
     2503      300    1        DCL MESS CHAR(%MESS_LEN);
     2504      301    1        DCL DEST_CHAR CHAR(8);
     2505      302    1        DCL ACTUAL_DEST SBIN HALF;
     2506      303    1        DCL ACTUAL_DEST_OUT REDEF ACTUAL_DEST UBIN HALF;
     2507      304
     2508      305
     2509      306
     2510      307    1        POS = TABLE;

    307 29 000002   200003 470500                    LDP0    @TABLE,,AUTO
        29 000003   000000 236100                    LDQ     0,,PR0
        29 000004   200051 756100                    STQ     POS,,AUTO

     2511      308
     2512      309    1        IF POS->LABEL_TABLE.RLINK ~= ADDR(NIL) THEN

    309 29 000005   200051 471500                    LDP1    POS,,AUTO
        29 000006   100014 236100                    LDQ     12,,PR1
        29 000007   000000 116000 30                 CMPQ    0
        29 000010   000020 600000 29                 TZE     s:312

     2513      310    1          CALL Z8PA$OUTPUT_JMP_DEST(POS->LABEL_TABLE.RLINK);

    310 29 000011   200051 236100                    LDQ     POS,,AUTO
        29 000012   000014 036003                    ADLQ    12,DU
        29 000013   200100 756100                    STQ     ACTUAL_DEST+3,,AUTO
        29 000014   200100 630500                    EPPR0   ACTUAL_DEST+3,,AUTO
        29 000015   000001 631400 30                 EPPR1   1
        29 000016   000000 701000 29                 TSX1    s:6
        29 000017   000000 011000                    NOP     0

     2514      311
     2515      312    1        CALL OUT_DEST;

    312 29 000020   000036 701000 29                 TSX1    OUT_DEST
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:381  
        29 000021   000000 011000                    NOP     0

     2516      313
     2517      314    1        IF POS->LABEL_TABLE.LLINK ~= ADDR(NIL) THEN

    314 29 000022   200051 470500                    LDP0    POS,,AUTO
        29 000023   000015 236100                    LDQ     13,,PR0
        29 000024   000000 116000 30                 CMPQ    0
        29 000025   000035 600000 29                 TZE     s:315+7

     2518      315    1          CALL Z8PA$OUTPUT_JMP_DEST(POS->LABEL_TABLE.LLINK);

    315 29 000026   200051 236100                    LDQ     POS,,AUTO
        29 000027   000015 036003                    ADLQ    13,DU
        29 000030   200100 756100                    STQ     ACTUAL_DEST+3,,AUTO
        29 000031   200100 630500                    EPPR0   ACTUAL_DEST+3,,AUTO
        29 000032   000001 631400 30                 EPPR1   1
        29 000033   000000 701000 29                 TSX1    s:6
        29 000034   000000 011000                    NOP     0
        29 000035   000164 710000 29                 TRA     s:358

     2519      316
     2520      317    1        OUT_DEST : PROC;

    317 29 000036   200076 741300       OUT_DEST     STX1  ! ACTUAL_DEST+1,,AUTO

     2521      318    2          IF POS->LABEL_TABLE.LOCATION = -1 THEN

    318 29 000037   200051 470500                    LDP0    POS,,AUTO
        29 000040   000010 235100                    LDA     8,,PR0
        29 000041   000002 115000 30                 CMPA    2
        29 000042   000060 601000 29                 TNZ     s:325

     2522      319    3            DO;

     2523      320    3              CALL CONCAT(MESS,%MESS7,POS->LABEL_TABLE.NAME);

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:382  
    320 29 000043   040100 100400                    MLR     fill='040'O
        29 000044   000000 000040 28                 ADSC9   0                        cn=0,n=32
        29 000045   200054 000040                    ADSC9   MESS,,AUTO               cn=0,n=32
        29 000046   040100 100500                    MLR     fill='040'O
        29 000047   000000 000034                    ADSC9   0,,PR0                   cn=0,n=28
        29 000050   200064 000034                    ADSC9   MESS+8,,AUTO             cn=0,n=28

     2524      321    3              CALL Z8PA$ERROR_PROC(MESS);

    321 29 000051   200054 630500                    EPPR0   MESS,,AUTO
        29 000052   200100 450500                    STP0    ACTUAL_DEST+3,,AUTO
        29 000053   200100 630500                    EPPR0   ACTUAL_DEST+3,,AUTO
        29 000054   000001 631400 30                 EPPR1   1
        29 000055   000000 701000 xent               TSX1    Z8PA$ERROR_PROC
        29 000056   000000 011000                    NOP     0

     2525      322    3            END;

    322 29 000057   000162 710000 29                 TRA     s:357

     2526      323    2          ELSE
     2527      324    3            DO;

     2528      325    3              CNT = POS->LABEL_TABLE.FIRST_REF;

    325 29 000060   000011 236100                    LDQ     9,,PR0
        29 000061   200050 756100                    STQ     CNT,,AUTO

     2529      326    3              IF CNT ~= ADDR(NIL) THEN

    326 29 000062   000000 116000 30                 CMPQ    0
        29 000063   000066 600000 29                 TZE     s:329

     2530      327    3                TOP = CNT;

    327 29 000064   200052 756100                    STQ     TOP,,AUTO
        29 000065   000070 710000 29                 TRA     s:331
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:383  

     2531      328    3              ELSE
     2532      329    3                TOP = ADDR(NIL);

    329 29 000066   000000 236000 30                 LDQ     0
        29 000067   200052 756100                    STQ     TOP,,AUTO

     2533      330    4              DO UNTIL(CNT = ADDR(NIL));

     2534      331    4                IF CNT->REF_LIST.DEST ~= 'EMPTY' THEN

    331 29 000070   200050 470500                    LDP0    CNT,,AUTO
        29 000071   040000 106500                    CMPC    fill='040'O
        29 000072   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
        29 000073   000010 000005 28                 ADSC9   8                        cn=0,n=5
        29 000074   000153 600000 29                 TZE     s:348

     2535      332    5                  DO;

     2536      333    5                    ACTUAL_DEST = POS->LABEL_TABLE.LOCATION - CNT->REF_LIST.REF;

    333 29 000075   200051 471500                    LDP1    POS,,AUTO
        29 000076   100010 236100                    LDQ     8,,PR1
        29 000077   000000 136100                    SBLQ    0,,PR0
        29 000100   000000 620006                    EAX0    0,QL
        29 000101   200075 740100                    STX0    ACTUAL_DEST,,AUTO

     2537      334    5                    CALL BINXCHAR(DEST_CHAR,ACTUAL_DEST_OUT);

    334 29 000102   200075 235100                    LDA     ACTUAL_DEST,,AUTO
        29 000103   000022 771000                    ARL     18
        29 000104   000044 773000                    LRL     36
        29 000105   200100 757100                    STAQ    ACTUAL_DEST+3,,AUTO
        29 000106   000100 301500                    BTD
        29 000107   200100 000010                    NDSC9   ACTUAL_DEST+3,,AUTO      cn=0,s=lsgnf,sf=0,n=8
        29 000110   200073 010010                    NDSC9   DEST_CHAR,,AUTO          cn=0,s=lsgns,sf=0,n=8

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:384  
     2538      335    5                   CALL CONCAT(BUFFER,'%EQU D',CNT->REF_LIST.DEST,' = ',DEST_CHAR,';')
               335                             ;

    335 29 000111   040100 100400                    MLR     fill='040'O
        29 000112   000012 000006 28                 ADSC9   10                       cn=0,n=6
        29 000113   200004 000006                    ADSC9   BUFFER,,AUTO             cn=0,n=6
        29 000114   040100 100500                    MLR     fill='040'O
        29 000115   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
        29 000116   200005 400010                    ADSC9   BUFFER+1,,AUTO           cn=2,n=8
        29 000117   040100 100400                    MLR     fill='040'O
        29 000120   000014 000003 28                 ADSC9   12                       cn=0,n=3
        29 000121   200007 400003                    ADSC9   BUFFER+3,,AUTO           cn=2,n=3
        29 000122   040100 100500                    MLR     fill='040'O
        29 000123   200073 000010                    ADSC9   DEST_CHAR,,AUTO          cn=0,n=8
        29 000124   200010 200010                    ADSC9   BUFFER+4,,AUTO           cn=1,n=8
        29 000125   040100 100400                    MLR     fill='040'O
        29 000126   000003 000001 30                 ADSC9   3                        cn=0,n=1
        29 000127   200012 200163                    ADSC9   BUFFER+6,,AUTO           cn=1,n=115

     2539      336                         %OUTPUT_STR;

    341 29 000130   000000 236000 0                  LDQ     OUT_DCBN
        29 000131   000141 604000 29                 TMI     s:343
        29 000132   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        29 000133   000141 601000 29                 TNZ     s:343
        29 000134   000000 236000 10                 LDQ     OPTIONS
        29 000135   000002 736000                    QLS     2
        29 000136   400000 376003                    ANQ     -131072,DU
        29 000137   400000 676003                    ERQ     -131072,DU
        29 000140   000153 601000 29                 TNZ     s:348

    343 29 000141   000214 235007                    LDA     140,DL
        29 000142   200047 755100                    STA     LEN,,AUTO

    344 29 000143   200047 630500                    EPPR0   LEN,,AUTO
        29 000144   200101 450500                    STP0    ACTUAL_DEST+4,,AUTO
        29 000145   200004 631500                    EPPR1   BUFFER,,AUTO
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:385  
        29 000146   200100 451500                    STP1    ACTUAL_DEST+3,,AUTO
        29 000147   200100 630500                    EPPR0   ACTUAL_DEST+3,,AUTO
        29 000150   000004 631400 30                 EPPR1   4
        29 000151   000000 701000 xent               TSX1    OUTPUT
        29 000152   000000 011000                    NOP     0

     2540      347    5                  END;

     2541      348    4                  BOT = CNT;

    348 29 000153   200050 236100                    LDQ     CNT,,AUTO
        29 000154   200053 756100                    STQ     BOT,,AUTO

     2542      349    4                CNT = CNT->REF_LIST.NEXT;

    349 29 000155   200050 470500                    LDP0    CNT,,AUTO
        29 000156   000001 236100                    LDQ     1,,PR0
        29 000157   200050 756100                    STQ     CNT,,AUTO

     2543      350    4              END;

    350 29 000160   000000 116000 30                 CMPQ    0
        29 000161   000070 601000 29                 TNZ     s:331

     2544      351         /*        IF TOP ~= ADDR(NIL) THEN
     2545      352                     DO;
     2546      353                       BOT->REF_LIST.NEXT = TOP_FREE_RL;
     2547      354                       TOP_FREE_RL = TOP;
     2548      355                     END; */
     2549      356    3            END;

     2550      357    2        END OUT_DEST;

    357 29 000162   200076 221300                    LDX1  ! ACTUAL_DEST+1,,AUTO
        29 000163   000001 702211                    TSX2  ! 1,X1

     2551      358    1    END Z8PA$OUTPUT_JMP_DEST;
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:386  

    358 29 000164   000000 702200 xent               TSX2  ! X66_ARET
     2552      359         %EOD;

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:387  
--  Include file information  --

   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8PA$OUTPUT_JMP_DEST.
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:388  

 **** Variables and constants ****

  ****  Section 000 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OUT_DCBN

  ****  Section 001 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 002 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_DCBN2

  ****  Section 009 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 010 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:389  
  ****  Section 011 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 DO_REQ

  ****  Section 012 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 013 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 INSTR(0:511)               0-0-0/c CHAR(512)         1 INSTRCHR

  ****  Section 014 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 INSTR_LISTED

  ****  Section 015 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_LEN

  ****  Section 016 LblCom INSTR_INDX

PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:390  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_INDX

  ****  Section 017 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 EOF_FLAG

  ****  Section 018 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)          1 KEY_REC

  ****  Section 019 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 020 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 021 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:391  

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 022 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 023 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 024 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 025 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 026 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PHASE
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:392  

  ****  Section 027 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERROR_COUNT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TABLE                    75-0-0/w SBIN(18)    r     1 ACTUAL_DEST
    75-0-0/w UBIN(18)    r     1 ACTUAL_DEST_OUT           53-0-0/w PTR         r     1 BOT
     4-0-0/c CHAR(140)   r     1 BUFFER                    50-0-0/w PTR         r     1 CNT
    73-0-0/c CHAR(8)     r     1 DEST_CHAR                 47-0-0/w UBIN        r     1 LEN
    54-0-0/c CHAR(60)    r     1 MESS                      51-0-0/w PTR         r     1 POS
    *0-0-0/w PTR         r     1 TABLE                     52-0-0/w PTR         r     1 TOP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 Z8PS$M$DO#                 0-0-0/w PTR               1 Z8PS$M$DO$
     0-0-0/w UBIN              1 Z8PS$M$LO#                 0-0-0/w PTR               1 Z8PS$M$LO$
     0-0-0/w UBIN        r     1 Z8PS$M$OU#                 0-0-0/w PTR               1 Z8PS$M$OU$
     0-0-0/w UBIN              1 Z8PS$M$SO#                 0-0-0/w PTR               1 Z8PS$M$SO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(504)   r     1 LABEL_TABLE                0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$OU
PL6.E3A0      #003=Z8PA$OUTPUT_JMP_DEST File=Z8PA.:Z8A6TSI                       SAT 08/09/97 09:42 Page:393  
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$SO
     0-0-0N  NULL        r     1 M$UI                       0-0-0/w STRC(144)   r     1 REF_LIST


   Procedure Z8PA$OUTPUT_JMP_DEST requires 117 words for executable code.
   Procedure Z8PA$OUTPUT_JMP_DEST requires 66 words of local(AUTO) storage.

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:394  
     2553        1        /*T***********************************************************/
     2554        2        /*T*                                                         */
     2555        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2556        4        /*T*                                                         */
     2557        5        /*T***********************************************************/
     2558        6         Z8PA$ERROR_PROC : PROC(MESSAGE);
     2559        7         /*D*
     2560        8              NAME: Z8PA$ERROR_PROC
     2561        9              PURPOSE:
     2562       10                   Output an error message to M$LO when a semantic error is detected or
     2563       11                   when an internal assembler error occurs.
     2564       12              CALL:
     2565       13                   CALL Z8PA$ERROR_PROC(MESSAGE);
     2566       14              PARAMETERS:
     2567       15                   MESSAGE
     2568       16                     A 60 character string stating what error occured.
     2569       17                     Some messages have been predefined at the beginning of the module.
     2570       18              DESCRIPTION:
     2571       19                   Z8PA$ERROR_PROC will output the message and will tell what line we are
     2572       20                   currently processing along with what directive was being processed
     2573       21                   when the error occured.  The message will unfortunately usually
     2574       22                   appear a line or two after the line where the error occured.
     2575       23         */
     2576       24             %INCLUDE Z8P_SEMAN_EX;
     2577       93             %INCLUDE Z8P_SCAN_EXT;
     2578      282             %DCBPTR;
     2579      292    1        DCL MESSAGE CHAR(%MESS_LEN);
     2580      293    1        DCL OCTNUM CHAR(6);
     2581      294    1        DCL CURRENT_OT_POS UBIN WORD ALIGNED EXT;
     2582      295    1        DCL FORCE_LIST ENTRY;
     2583      296
     2584      297    1        ERROR_COUNT = ERROR_COUNT + 1;
     2585      298             %SAVE_DCB;
     2586      301             %SELECT_LO;
     2587      304    1        CALL FORCE_LIST;
     2588      305    1        BUFFER = ' ';
     2589      306             %OUTPUT_STR;
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:395  
     2590      317    1        CALL CONCAT(BUFFER,'Semantic error: ',MESSAGE);
     2591      318             %OUTPUT_STR;
     2592      329    1        IF PHASE = %PARSING THEN
     2593      330    1          CALL CONCAT(BUFFER,SUBSTR(KEY_REC,0,10),'  Semantic error: ',MESSAGE);
     2594      331    1        ELSE
     2595      332    1          CALL CONCAT(BUFFER,'          ','  Semantic error: ',MESSAGE);
     2596      333             %OUTSTR_DO;
     2597      350             %RESET_DCB;
     2598      353    1    END Z8PA$ERROR_PROC;
     2599      354
     2600      355         %EOD;

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:396  
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8PA$ERROR_PROC.

   Procedure Z8PA$ERROR_PROC requires 105 words for executable code.
   Procedure Z8PA$ERROR_PROC requires 44 words of local(AUTO) storage.

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:397  

 Object Unit name= Z8PA$ERROR_PROC                            File name= Z8PA.:Z8A6TOU
 UTS= AUG 09 '97 09:43:07.64 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  OUT_DCBN
    1  LblCom even  none     1      1  SAVE_OUT_DCBN
    2  LblCom even  none     1      1  SAVE_DCBN2
    3   DCB   even  none     0      0  M$OU
    4   DCB   even  none     0      0  M$SO
    5   DCB   even  none     0      0  M$LO
    6   DCB   even  none     0      0  M$SI
    7   DCB   even  none     0      0  M$UI
    8   DCB   even  none     0      0  M$DO
    9  LblCom even  none     1      1  ERR_SEV
   10  LblCom even  none     1      1  OPTIONS
   11  LblCom even  none     1      1  DO_REQ
   12  LblCom even  none    26     32  OPTIONS_TEXT
   13  LblCom even  none   128    200  INSTR
   14  LblCom even  none     1      1  INSTR_LISTED
   15  LblCom even  none     1      1  INSTR_LEN
   16  LblCom even  none     1      1  INSTR_INDX
   17  LblCom even  none     1      1  EOF_FLAG
   18  LblCom even  none     5      5  KEY_REC
   19  LblCom even  none     1      1  LINES_OUT
   20  LblCom even  none    25     31  HEADER_LINE1
   21  LblCom even  none    25     31  HEADER_LINE3
   22  LblCom even  none    25     31  HEADER_LINE2
   23  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   24  LblCom even  none    28     34  LINE
   25  LblCom even  none     1      1  LINELEN
   26  LblCom even  none     1      1  PHASE
   27  LblCom even  none     1      1  ERROR_COUNT
   28  LblCom even  none     1      1  CURRENT_OT_POS
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:398  
   29  RoData even  UTS     12     14  Z8PA$ERROR_PROC
   30   Proc  even  none   105    151  Z8PA$ERROR_PROC
   31  RoData even  none     3      3  Z8PA$ERROR_PROC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    30      0   yes            yes      Std        1  Z8PA$ERROR_PROC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 FORCE_LIST
         yes           Std       2 OUTPUT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$OU                                  M$SO                                  M$LO
     M$SI                                  M$UI                                  M$DO
     Z8PS$M$OU$                            Z8PS$M$LO$                            Z8PS$M$DO$
     Z8PS$M$SO$                            Z8PS$M$OU#                            Z8PS$M$LO#
     Z8PS$M$DO#                            Z8PS$M$SO#
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:399  


     2553        1        /*T***********************************************************/
     2554        2        /*T*                                                         */
     2555        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2556        4        /*T*                                                         */
     2557        5        /*T***********************************************************/
     2558        6         Z8PA$ERROR_PROC : PROC(MESSAGE);

      6 30 000000   000000 700200 xent  Z8PA$ERROR_* TSX0  ! X66_AUTO_1
        30 000001   000054 000001                    ZERO    44,1

     2559        7         /*D*
     2560        8              NAME: Z8PA$ERROR_PROC
     2561        9              PURPOSE:
     2562       10                   Output an error message to M$LO when a semantic error is detected or
     2563       11                   when an internal assembler error occurs.
     2564       12              CALL:
     2565       13                   CALL Z8PA$ERROR_PROC(MESSAGE);
     2566       14              PARAMETERS:
     2567       15                   MESSAGE
     2568       16                     A 60 character string stating what error occured.
     2569       17                     Some messages have been predefined at the beginning of the module.
     2570       18              DESCRIPTION:
     2571       19                   Z8PA$ERROR_PROC will output the message and will tell what line we are
     2572       20                   currently processing along with what directive was being processed
     2573       21                   when the error occured.  The message will unfortunately usually
     2574       22                   appear a line or two after the line where the error occured.
     2575       23         */
     2576       24             %INCLUDE Z8P_SEMAN_EX;
     2577       93             %INCLUDE Z8P_SCAN_EXT;
     2578      282             %DCBPTR;
     2579      292    1        DCL MESSAGE CHAR(%MESS_LEN);
     2580      293    1        DCL OCTNUM CHAR(6);
     2581      294    1        DCL CURRENT_OT_POS UBIN WORD ALIGNED EXT;
     2582      295    1        DCL FORCE_LIST ENTRY;
     2583      296
     2584      297    1        ERROR_COUNT = ERROR_COUNT + 1;
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:400  

    297 30 000002   000000 054000 27                 AOS     ERROR_COUNT

     2585      298             %SAVE_DCB;

    299 30 000003   000000 235000 0                  LDA     OUT_DCBN
        30 000004   000000 755000 1                  STA     SAVE_OUT_DCBN

     2586      301             %SELECT_LO;

    302 30 000005   000000 236000 xsym               LDQ     Z8PS$M$LO#
        30 000006   000000 756000 0                  STQ     OUT_DCBN

     2587      304    1        CALL FORCE_LIST;

    304 30 000007   000000 631400 31                 EPPR1   0
        30 000010   000000 701000 xent               TSX1    FORCE_LIST
        30 000011   000000 011000                    NOP     0

     2588      305    1        BUFFER = ' ';

    305 30 000012   040100 100400                    MLR     fill='040'O
        30 000013   000001 000001 31                 ADSC9   1                        cn=0,n=1
        30 000014   200004 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     2589      306             %OUTPUT_STR;

    311 30 000015   000000 236000 0                  LDQ     OUT_DCBN
        30 000016   000026 604000 30                 TMI     s:313
        30 000017   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        30 000020   000026 601000 30                 TNZ     s:313
        30 000021   000000 236000 10                 LDQ     OPTIONS
        30 000022   000002 736000                    QLS     2
        30 000023   400000 376003                    ANQ     -131072,DU
        30 000024   400000 676003                    ERQ     -131072,DU
        30 000025   000040 601000 30                 TNZ     s:317

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:401  
    313 30 000026   000214 235007                    LDA     140,DL
        30 000027   200047 755100                    STA     LEN,,AUTO

    314 30 000030   200047 630500                    EPPR0   LEN,,AUTO
        30 000031   200053 450500                    STP0    OCTNUM+3,,AUTO
        30 000032   200004 631500                    EPPR1   BUFFER,,AUTO
        30 000033   200052 451500                    STP1    OCTNUM+2,,AUTO
        30 000034   200052 630500                    EPPR0   OCTNUM+2,,AUTO
        30 000035   000002 631400 31                 EPPR1   2
        30 000036   000000 701000 xent               TSX1    OUTPUT
        30 000037   000000 011000                    NOP     0

     2590      317    1        CALL CONCAT(BUFFER,'Semantic error: ',MESSAGE);

    317 30 000040   040100 100400                    MLR     fill='040'O
        30 000041   000000 000020 29                 ADSC9   0                        cn=0,n=16
        30 000042   200004 000020                    ADSC9   BUFFER,,AUTO             cn=0,n=16
        30 000043   200003 470500                    LDP0    @MESSAGE,,AUTO
        30 000044   040100 100500                    MLR     fill='040'O
        30 000045   000000 000074                    ADSC9   0,,PR0                   cn=0,n=60
        30 000046   200010 000174                    ADSC9   BUFFER+4,,AUTO           cn=0,n=124

     2591      318             %OUTPUT_STR;

    323 30 000047   000000 236000 0                  LDQ     OUT_DCBN
        30 000050   000060 604000 30                 TMI     s:325
        30 000051   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        30 000052   000060 601000 30                 TNZ     s:325
        30 000053   000000 236000 10                 LDQ     OPTIONS
        30 000054   000002 736000                    QLS     2
        30 000055   400000 376003                    ANQ     -131072,DU
        30 000056   400000 676003                    ERQ     -131072,DU
        30 000057   000072 601000 30                 TNZ     s:329

    325 30 000060   000214 235007                    LDA     140,DL
        30 000061   200047 755100                    STA     LEN,,AUTO

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:402  
    326 30 000062   200047 630500                    EPPR0   LEN,,AUTO
        30 000063   200053 450500                    STP0    OCTNUM+3,,AUTO
        30 000064   200004 631500                    EPPR1   BUFFER,,AUTO
        30 000065   200052 451500                    STP1    OCTNUM+2,,AUTO
        30 000066   200052 630500                    EPPR0   OCTNUM+2,,AUTO
        30 000067   000002 631400 31                 EPPR1   2
        30 000070   000000 701000 xent               TSX1    OUTPUT
        30 000071   000000 011000                    NOP     0

     2592      329    1        IF PHASE = %PARSING THEN

    329 30 000072   000000 235000 26                 LDA     PHASE
        30 000073   000001 115007                    CMPA    1,DL
        30 000074   000110 601000 30                 TNZ     s:332

     2593      330    1          CALL CONCAT(BUFFER,SUBSTR(KEY_REC,0,10),'  Semantic error: ',MESSAGE);

    330 30 000075   040100 100400                    MLR     fill='040'O
        30 000076   000000 000012 18                 ADSC9   KEY_REC                  cn=0,n=10
        30 000077   200004 000012                    ADSC9   BUFFER,,AUTO             cn=0,n=10
        30 000100   040100 100400                    MLR     fill='040'O
        30 000101   000004 000022 29                 ADSC9   4                        cn=0,n=18
        30 000102   200006 400022                    ADSC9   BUFFER+2,,AUTO           cn=2,n=18
        30 000103   200003 470500                    LDP0    @MESSAGE,,AUTO
        30 000104   040100 100500                    MLR     fill='040'O
        30 000105   000000 000074                    ADSC9   0,,PR0                   cn=0,n=60
        30 000106   200013 000160                    ADSC9   BUFFER+7,,AUTO           cn=0,n=112
        30 000107   000122 710000 30                 TRA     s:334

     2594      331    1        ELSE
     2595      332    1          CALL CONCAT(BUFFER,'          ','  Semantic error: ',MESSAGE);

    332 30 000110   040100 100400                    MLR     fill='040'O
        30 000111   000011 000012 29                 ADSC9   9                        cn=0,n=10
        30 000112   200004 000012                    ADSC9   BUFFER,,AUTO             cn=0,n=10
        30 000113   040100 100400                    MLR     fill='040'O
        30 000114   000004 000022 29                 ADSC9   4                        cn=0,n=18
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:403  
        30 000115   200006 400022                    ADSC9   BUFFER+2,,AUTO           cn=2,n=18
        30 000116   200003 470500                    LDP0    @MESSAGE,,AUTO
        30 000117   040100 100500                    MLR     fill='040'O
        30 000120   000000 000074                    ADSC9   0,,PR0                   cn=0,n=60
        30 000121   200013 000160                    ADSC9   BUFFER+7,,AUTO           cn=0,n=112

     2596      333             %OUTSTR_DO;

    334 30 000122   000000 234000 11                 SZN     DO_REQ
        30 000123   000146 605000 30                 TPL     s:351

    337 30 000124   000000 235000 0                  LDA     OUT_DCBN
        30 000125   000000 755000 2                  STA     SAVE_DCBN2

    340 30 000126   000000 236000 xsym               LDQ     Z8PS$M$DO#
        30 000127   000000 756000 0                  STQ     OUT_DCBN

    342 30 000130   000214 235007                    LDA     140,DL
        30 000131   200047 755100                    STA     LEN,,AUTO

    343 30 000132   200047 630500                    EPPR0   LEN,,AUTO
        30 000133   200053 450500                    STP0    OCTNUM+3,,AUTO
        30 000134   200004 631500                    EPPR1   BUFFER,,AUTO
        30 000135   200052 451500                    STP1    OCTNUM+2,,AUTO
        30 000136   200052 630500                    EPPR0   OCTNUM+2,,AUTO
        30 000137   000002 631400 31                 EPPR1   2
        30 000140   000000 701000 xent               TSX1    OUTPUT
        30 000141   000000 011000                    NOP     0

    344 30 000142   000214 235007                    LDA     140,DL
        30 000143   200047 755100                    STA     LEN,,AUTO

    346 30 000144   000000 236000 2                  LDQ     SAVE_DCBN2
        30 000145   000000 756000 0                  STQ     OUT_DCBN

     2597      350             %RESET_DCB;

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:404  
    351 30 000146   000000 235000 1                  LDA     SAVE_OUT_DCBN
        30 000147   000000 755000 0                  STA     OUT_DCBN

     2598      353    1    END Z8PA$ERROR_PROC;

    353 30 000150   000000 702200 xent               TSX2  ! X66_ARET
     2599      354
     2600      355         %EOD;

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:405  
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8PA$ERROR_PROC.
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:406  

 **** Variables and constants ****

  ****  Section 000 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OUT_DCBN

  ****  Section 001 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 SAVE_OUT_DCBN

  ****  Section 002 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 SAVE_DCBN2

  ****  Section 009 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 010 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:407  
  ****  Section 011 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 DO_REQ

  ****  Section 012 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 013 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 INSTR(0:511)               0-0-0/c CHAR(512)         1 INSTRCHR

  ****  Section 014 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 INSTR_LISTED

  ****  Section 015 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_LEN

  ****  Section 016 LblCom INSTR_INDX

PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:408  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_INDX

  ****  Section 017 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 EOF_FLAG

  ****  Section 018 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)    r     1 KEY_REC

  ****  Section 019 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 020 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 021 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:409  

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 022 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 023 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 024 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 025 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 026 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 PHASE
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:410  

  ****  Section 027 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ERROR_COUNT

  ****  Section 028 LblCom CURRENT_OT_POS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 CURRENT_OT_POS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @MESSAGE                   4-0-0/c CHAR(140)   r     1 BUFFER
    47-0-0/w UBIN        r     1 LEN                       *0-0-0/c CHAR(60)    r     1 MESSAGE
    50-0-0/c CHAR(6)           1 OCTNUM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 Z8PS$M$DO#                 0-0-0/w PTR               1 Z8PS$M$DO$
     0-0-0/w UBIN        r     1 Z8PS$M$LO#                 0-0-0/w PTR               1 Z8PS$M$LO$
     0-0-0/w UBIN        r     1 Z8PS$M$OU#                 0-0-0/w PTR               1 Z8PS$M$OU$
     0-0-0/w UBIN              1 Z8PS$M$SO#                 0-0-0/w PTR               1 Z8PS$M$SO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #004=Z8PA$ERROR_PROC File=Z8PA.:Z8A6TSI                            SAT 08/09/97 09:43 Page:411  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(504)         1 LABEL_TABLE                0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$OU
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$SO
     0-0-0N  NULL        r     1 M$UI                       0-0-0/w STRC(144)         1 REF_LIST


   Procedure Z8PA$ERROR_PROC requires 105 words for executable code.
   Procedure Z8PA$ERROR_PROC requires 44 words of local(AUTO) storage.

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:412  
     2601        1        /*T***********************************************************/
     2602        2        /*T*                                                         */
     2603        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2604        4        /*T*                                                         */
     2605        5        /*T***********************************************************/
     2606        6         Z8PA$WRAPUP : PROC;
     2607        7         /*D*
     2608        8              NAME: Z8PA$WRAPUP
     2609        9              CALL:
     2610       10                   CALL Z8PA$WRAPUP;
     2611       11              DESCRIPTION:
     2612       12                   The main purpose of this routine is to output a statement of
     2613       13                   how many errors were found in the source program.  This statement
     2614       14                   is output to M$LO  and M$ME;
     2615       15         */
     2616       16
     2617       17             %INCLUDE Z8A_SYS_FILE;
     2618     6292             %INCLUDE Z8P_SCAN_EXT;
     2619     6481             %INCLUDE Z8P_SEMAN_EX;
     2620     6550             %DCBPTR;
     2621     6560
     2622     6561    1        DCL CHAR_NUM CHAR(4);
     2623     6562
     2624     6563             %IF GCOS;
     2625     6564 C           %FPT_CLOSE(FPTN=CLOSE_OU,DCB=%M$OU);
     2626     6565 C           %FPT_CLOSE(FPTN=CLOSE_SO,DCB=%M$SO);
     2627     6566 C
     2628     6567 C           CALL M$CLOSE(CLOSE_OU)
     2629     6568 C             WHENALTRETURN DO;
     2630     6569 C               BUFFER = 'Cannot close *S';
     2631     6570 C               %OUTPUT_STR;
     2632     6571 C               %OUTSTR_DO;
     2633     6572 C             END;
     2634     6573 C           CALL M$CLOSE(CLOSE_SO)
     2635     6574 C             WHENALTRETURN DO;
     2636     6575 C               BUFFER = 'Cannot close K*';
     2637     6576 C               %OUTPUT_STR;
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:413  
     2638     6577 C               %OUTSTR_DO;
     2639     6578 C             END;
     2640     6579             %ENDIF;
     2641     6580
     2642     6581             %SELECT_LO;
     2643     6584
     2644     6585    1        BUFFER = ' ';
     2645     6586
     2646     6587             %OUTPUT_STR;
     2647     6598
     2648     6599             %OUTSTR_DO;
     2649     6616
     2650     6617    1        IF ERROR_COUNT = 0 THEN
     2651     6618    1          BUFFER = 'No errors were found.';
     2652     6619    1        ELSE
     2653     6620    1          IF ERROR_COUNT = 1 THEN
     2654     6621    1            BUFFER = 'One error was found.';
     2655     6622    1          ELSE
     2656     6623    2            DO;
     2657     6624    2              CALL BINCHAR(CHAR_NUM,ERROR_COUNT);
     2658     6625    2              CALL BLANK_ZERO(ADDR(CHAR_NUM),4);
     2659     6626    2              CALL CONCAT(BUFFER,'There were ',CHAR_NUM,' errors found.');
     2660     6627    2            END;
     2661     6628
     2662     6629
     2663     6630             %OUTPUT_STR;
     2664     6641             %OUTSTR_DO;
     2665     6658
     2666     6659    1    END Z8PA$WRAPUP;

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:414  
--  Include file information  --

   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8PA$WRAPUP.

   Procedure Z8PA$WRAPUP requires 120 words for executable code.
   Procedure Z8PA$WRAPUP requires 44 words of local(AUTO) storage.

    No errors detected in file Z8PA.:Z8A6TSI    .

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:415  

 Object Unit name= Z8PA$WRAPUP                                File name= Z8PA.:Z8A6TOU
 UTS= AUG 09 '97 09:43:20.00 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none     1      1  OUT_DCBN
    2  LblCom even  none     1      1  SAVE_OUT_DCBN
    3  LblCom even  none     1      1  SAVE_DCBN2
    4   DCB   even  none     0      0  M$OU
    5   DCB   even  none     0      0  M$SO
    6   DCB   even  none     0      0  M$LO
    7   DCB   even  none     0      0  M$SI
    8   DCB   even  none     0      0  M$UI
    9   DCB   even  none     0      0  M$DO
   10  LblCom even  none     1      1  ERR_SEV
   11  LblCom even  none     1      1  OPTIONS
   12  LblCom even  none     1      1  DO_REQ
   13  LblCom even  none    26     32  OPTIONS_TEXT
   14  LblCom even  none   128    200  INSTR
   15  LblCom even  none     1      1  INSTR_LISTED
   16  LblCom even  none     1      1  INSTR_LEN
   17  LblCom even  none     1      1  INSTR_INDX
   18  LblCom even  none     1      1  EOF_FLAG
   19  LblCom even  none     5      5  KEY_REC
   20  LblCom even  none     1      1  LINES_OUT
   21  LblCom even  none    25     31  HEADER_LINE1
   22  LblCom even  none    25     31  HEADER_LINE3
   23  LblCom even  none    25     31  HEADER_LINE2
   24  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   25  LblCom even  none    28     34  LINE
   26  LblCom even  none     1      1  LINELEN
   27  LblCom even  none     1      1  PHASE
   28  LblCom even  none     1      1  ERROR_COUNT
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:416  
   29  RoData even  UTS     18     22  Z8PA$WRAPUP
   30   Proc  even  none   120    170  Z8PA$WRAPUP
   31  RoData even  none     4      4  Z8PA$WRAPUP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    30      0   yes            yes      Std        0  Z8PA$WRAPUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 OUTPUT
         yes           Std       2 BLANK_ZERO
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$OU                                  M$SO
     M$LO                                  M$SI                                  M$UI
     M$DO                                  Z8PS$M$OU$                            Z8PS$M$LO$
     Z8PS$M$DO$                            Z8PS$M$SO$                            Z8PS$M$OU#
     Z8PS$M$LO#                            Z8PS$M$DO#                            Z8PS$M$SO#

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:417  


     2601        1        /*T***********************************************************/
     2602        2        /*T*                                                         */
     2603        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2604        4        /*T*                                                         */
     2605        5        /*T***********************************************************/
     2606        6         Z8PA$WRAPUP : PROC;

      6 30 000000   000000 700200 xent  Z8PA$WRAPUP  TSX0  ! X66_AUTO_0
        30 000001   000054 000000                    ZERO    44,0

     2607        7         /*D*
     2608        8              NAME: Z8PA$WRAPUP
     2609        9              CALL:
     2610       10                   CALL Z8PA$WRAPUP;
     2611       11              DESCRIPTION:
     2612       12                   The main purpose of this routine is to output a statement of
     2613       13                   how many errors were found in the source program.  This statement
     2614       14                   is output to M$LO  and M$ME;
     2615       15         */
     2616       16
     2617       17             %INCLUDE Z8A_SYS_FILE;
     2618     6292             %INCLUDE Z8P_SCAN_EXT;
     2619     6481             %INCLUDE Z8P_SEMAN_EX;
     2620     6550             %DCBPTR;
     2621     6560
     2622     6561    1        DCL CHAR_NUM CHAR(4);
     2623     6562
     2624     6563             %IF GCOS;
     2625     6564 C           %FPT_CLOSE(FPTN=CLOSE_OU,DCB=%M$OU);
     2626     6565 C           %FPT_CLOSE(FPTN=CLOSE_SO,DCB=%M$SO);
     2627     6566 C
     2628     6567 C           CALL M$CLOSE(CLOSE_OU)
     2629     6568 C             WHENALTRETURN DO;
     2630     6569 C               BUFFER = 'Cannot close *S';
     2631     6570 C               %OUTPUT_STR;
     2632     6571 C               %OUTSTR_DO;
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:418  
     2633     6572 C             END;
     2634     6573 C           CALL M$CLOSE(CLOSE_SO)
     2635     6574 C             WHENALTRETURN DO;
     2636     6575 C               BUFFER = 'Cannot close K*';
     2637     6576 C               %OUTPUT_STR;
     2638     6577 C               %OUTSTR_DO;
     2639     6578 C             END;
     2640     6579             %ENDIF;
     2641     6580
     2642     6581             %SELECT_LO;

   6582 30 000002   000000 235000 xsym               LDA     Z8PS$M$LO#
        30 000003   000000 755000 1                  STA     OUT_DCBN

     2643     6584
     2644     6585    1        BUFFER = ' ';

   6585 30 000004   040100 100400                    MLR     fill='040'O
        30 000005   000000 000001 31                 ADSC9   0                        cn=0,n=1
        30 000006   200003 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

     2645     6586
     2646     6587             %OUTPUT_STR;

   6592 30 000007   000000 236000 1                  LDQ     OUT_DCBN
        30 000010   000020 604000 30                 TMI     s:6594
        30 000011   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        30 000012   000020 601000 30                 TNZ     s:6594
        30 000013   000000 236000 11                 LDQ     OPTIONS
        30 000014   000002 736000                    QLS     2
        30 000015   400000 376003                    ANQ     -131072,DU
        30 000016   400000 676003                    ERQ     -131072,DU
        30 000017   000032 601000 30                 TNZ     s:6600

   6594 30 000020   000214 236007                    LDQ     140,DL
        30 000021   200046 756100                    STQ     LEN,,AUTO

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:419  
   6595 30 000022   200046 630500                    EPPR0   LEN,,AUTO
        30 000023   200051 450500                    STP0    CHAR_NUM+2,,AUTO
        30 000024   200003 631500                    EPPR1   BUFFER,,AUTO
        30 000025   200050 451500                    STP1    CHAR_NUM+1,,AUTO
        30 000026   200050 630500                    EPPR0   CHAR_NUM+1,,AUTO
        30 000027   000001 631400 31                 EPPR1   1
        30 000030   000000 701000 xent               TSX1    OUTPUT
        30 000031   000000 011000                    NOP     0

     2647     6598
     2648     6599             %OUTSTR_DO;

   6600 30 000032   000000 234000 12                 SZN     DO_REQ
        30 000033   000056 605000 30                 TPL     s:6617

   6603 30 000034   000000 235000 1                  LDA     OUT_DCBN
        30 000035   000000 755000 3                  STA     SAVE_DCBN2

   6606 30 000036   000000 236000 xsym               LDQ     Z8PS$M$DO#
        30 000037   000000 756000 1                  STQ     OUT_DCBN

   6608 30 000040   000214 235007                    LDA     140,DL
        30 000041   200046 755100                    STA     LEN,,AUTO

   6609 30 000042   200046 630500                    EPPR0   LEN,,AUTO
        30 000043   200051 450500                    STP0    CHAR_NUM+2,,AUTO
        30 000044   200003 631500                    EPPR1   BUFFER,,AUTO
        30 000045   200050 451500                    STP1    CHAR_NUM+1,,AUTO
        30 000046   200050 630500                    EPPR0   CHAR_NUM+1,,AUTO
        30 000047   000001 631400 31                 EPPR1   1
        30 000050   000000 701000 xent               TSX1    OUTPUT
        30 000051   000000 011000                    NOP     0

   6610 30 000052   000214 235007                    LDA     140,DL
        30 000053   200046 755100                    STA     LEN,,AUTO

   6612 30 000054   000000 236000 3                  LDQ     SAVE_DCBN2
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:420  
        30 000055   000000 756000 1                  STQ     OUT_DCBN

     2649     6616
     2650     6617    1        IF ERROR_COUNT = 0 THEN

   6617 30 000056   000000 235000 28                 LDA     ERROR_COUNT
        30 000057   000064 601000 30                 TNZ     s:6620

     2651     6618    1          BUFFER = 'No errors were found.';

   6618 30 000060   040100 100400                    MLR     fill='040'O
        30 000061   000000 000025 29                 ADSC9   0                        cn=0,n=21
        30 000062   200003 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        30 000063   000120 710000 30                 TRA     s:6635

     2652     6619    1        ELSE
     2653     6620    1          IF ERROR_COUNT = 1 THEN

   6620 30 000064   000001 115007                    CMPA    1,DL
        30 000065   000072 601000 30                 TNZ     s:6624

     2654     6621    1            BUFFER = 'One error was found.';

   6621 30 000066   040100 100400                    MLR     fill='040'O
        30 000067   000006 000024 29                 ADSC9   6                        cn=0,n=20
        30 000070   200003 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140
        30 000071   000120 710000 30                 TRA     s:6635

     2655     6622    1          ELSE
     2656     6623    2            DO;

     2657     6624    2              CALL BINCHAR(CHAR_NUM,ERROR_COUNT);

   6624 30 000072   000100 301400                    BTD
        30 000073   000000 000004 28                 NDSC9   ERROR_COUNT              cn=0,s=lsgnf,sf=0,n=4
        30 000074   200047 030004                    NDSC9   CHAR_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=4

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:421  
     2658     6625    2              CALL BLANK_ZERO(ADDR(CHAR_NUM),4);

   6625 30 000075   200047 630500                    EPPR0   CHAR_NUM,,AUTO
        30 000076   200050 450500                    STP0    CHAR_NUM+1,,AUTO
        30 000077   000003 236000 31                 LDQ     3
        30 000100   200053 756100                    STQ     CHAR_NUM+4,,AUTO
        30 000101   200050 631500                    EPPR1   CHAR_NUM+1,,AUTO
        30 000102   200052 451500                    STP1    CHAR_NUM+3,,AUTO
        30 000103   200052 630500                    EPPR0   CHAR_NUM+3,,AUTO
        30 000104   000001 631400 31                 EPPR1   1
        30 000105   000000 701000 xent               TSX1    BLANK_ZERO
        30 000106   000000 011000                    NOP     0

     2659     6626    2              CALL CONCAT(BUFFER,'There were ',CHAR_NUM,' errors found.');

   6626 30 000107   040100 100400                    MLR     fill='040'O
        30 000110   000013 000013 29                 ADSC9   11                       cn=0,n=11
        30 000111   200003 000013                    ADSC9   BUFFER,,AUTO             cn=0,n=11
        30 000112   040100 100500                    MLR     fill='040'O
        30 000113   200047 000004                    ADSC9   CHAR_NUM,,AUTO           cn=0,n=4
        30 000114   200005 600004                    ADSC9   BUFFER+2,,AUTO           cn=3,n=4
        30 000115   040100 100400                    MLR     fill='040'O
        30 000116   000016 000016 29                 ADSC9   14                       cn=0,n=14
        30 000117   200006 600175                    ADSC9   BUFFER+3,,AUTO           cn=3,n=125

     2660     6627    2            END;

     2661     6628
     2662     6629
     2663     6630             %OUTPUT_STR;

   6635 30 000120   000000 236000 1                  LDQ     OUT_DCBN
        30 000121   000131 604000 30                 TMI     s:6637
        30 000122   000000 116000 xsym               CMPQ    Z8PS$M$OU#
        30 000123   000131 601000 30                 TNZ     s:6637
        30 000124   000000 236000 11                 LDQ     OPTIONS
        30 000125   000002 736000                    QLS     2
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:422  
        30 000126   400000 376003                    ANQ     -131072,DU
        30 000127   400000 676003                    ERQ     -131072,DU
        30 000130   000143 601000 30                 TNZ     s:6642

   6637 30 000131   000214 235007                    LDA     140,DL
        30 000132   200046 755100                    STA     LEN,,AUTO

   6638 30 000133   200046 630500                    EPPR0   LEN,,AUTO
        30 000134   200051 450500                    STP0    CHAR_NUM+2,,AUTO
        30 000135   200003 631500                    EPPR1   BUFFER,,AUTO
        30 000136   200050 451500                    STP1    CHAR_NUM+1,,AUTO
        30 000137   200050 630500                    EPPR0   CHAR_NUM+1,,AUTO
        30 000140   000001 631400 31                 EPPR1   1
        30 000141   000000 701000 xent               TSX1    OUTPUT
        30 000142   000000 011000                    NOP     0

     2664     6641             %OUTSTR_DO;

   6642 30 000143   000000 234000 12                 SZN     DO_REQ
        30 000144   000167 605000 30                 TPL     s:6659

   6645 30 000145   000000 235000 1                  LDA     OUT_DCBN
        30 000146   000000 755000 3                  STA     SAVE_DCBN2

   6648 30 000147   000000 236000 xsym               LDQ     Z8PS$M$DO#
        30 000150   000000 756000 1                  STQ     OUT_DCBN

   6650 30 000151   000214 235007                    LDA     140,DL
        30 000152   200046 755100                    STA     LEN,,AUTO

   6651 30 000153   200046 630500                    EPPR0   LEN,,AUTO
        30 000154   200051 450500                    STP0    CHAR_NUM+2,,AUTO
        30 000155   200003 631500                    EPPR1   BUFFER,,AUTO
        30 000156   200050 451500                    STP1    CHAR_NUM+1,,AUTO
        30 000157   200050 630500                    EPPR0   CHAR_NUM+1,,AUTO
        30 000160   000001 631400 31                 EPPR1   1
        30 000161   000000 701000 xent               TSX1    OUTPUT
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:423  
        30 000162   000000 011000                    NOP     0

   6652 30 000163   000214 235007                    LDA     140,DL
        30 000164   200046 755100                    STA     LEN,,AUTO

   6654 30 000165   000000 236000 3                  LDQ     SAVE_DCBN2
        30 000166   000000 756000 1                  STQ     OUT_DCBN

     2665     6658
     2666     6659    1    END Z8PA$WRAPUP;

   6659 30 000167   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:424  
--  Include file information  --

   Z8P_SEMAN_EX.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8PA$WRAPUP.
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:425  

 **** Variables and constants ****

  ****  Section 001 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OUT_DCBN

  ****  Section 002 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 003 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 SAVE_DCBN2

  ****  Section 010 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 011 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:426  
  ****  Section 012 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 DO_REQ

  ****  Section 013 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 014 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 INSTR(0:511)               0-0-0/c CHAR(512)         1 INSTRCHR

  ****  Section 015 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 INSTR_LISTED

  ****  Section 016 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_LEN

  ****  Section 017 LblCom INSTR_INDX

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:427  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_INDX

  ****  Section 018 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 EOF_FLAG

  ****  Section 019 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)          1 KEY_REC

  ****  Section 020 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 021 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 022 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:428  

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 023 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 024 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 025 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 026 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 027 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PHASE
PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:429  

  ****  Section 028 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ERROR_COUNT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/c CHAR(140)   r     1 BUFFER                    47-0-0/c CHAR(4)     r     1 CHAR_NUM
    46-0-0/w UBIN        r     1 LEN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 Z8PS$M$DO#                 0-0-0/w PTR               1 Z8PS$M$DO$
     0-0-0/w UBIN        r     1 Z8PS$M$LO#                 0-0-0/w PTR               1 Z8PS$M$LO$
     0-0-0/w UBIN        r     1 Z8PS$M$OU#                 0-0-0/w PTR               1 Z8PS$M$OU$
     0-0-0/w UBIN              1 Z8PS$M$SO#                 0-0-0/w PTR               1 Z8PS$M$SO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(504)         1 LABEL_TABLE                0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$OU
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$SO
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$UI
     0-0-0/w STRC(144)         1 REF_LIST

PL6.E3A0      #005=Z8PA$WRAPUP File=Z8PA.:Z8A6TSI                                SAT 08/09/97 09:43 Page:430  

   Procedure Z8PA$WRAPUP requires 120 words for executable code.
   Procedure Z8PA$WRAPUP requires 44 words of local(AUTO) storage.

    No errors detected in file Z8PA.:Z8A6TSI    .
